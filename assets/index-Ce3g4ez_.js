var V1=r=>{throw TypeError(r)};var $0=(r,e,t)=>e.has(r)||V1("Cannot "+t);var vr=(r,e,t)=>($0(r,e,"read from private field"),t?t.call(r):e.get(r)),yd=(r,e,t)=>e.has(r)?V1("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),Vl=(r,e,t,n)=>($0(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),xd=(r,e,t)=>($0(r,e,"access private method"),t);var W1=(r,e,t,n)=>({set _(s){Vl(r,e,s,t)},get _(){return vr(r,e,n)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const d of o.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();var i4=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function kw(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var G0={exports:{}},Zf={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $1;function Nw(){if($1)return Zf;$1=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,s,o){var d=null;if(o!==void 0&&(d=""+o),s.key!==void 0&&(d=""+s.key),"key"in s){o={};for(var c in s)c!=="key"&&(o[c]=s[c])}else o=s;return s=o.ref,{$$typeof:r,type:n,key:d,ref:s!==void 0?s:null,props:o}}return Zf.Fragment=e,Zf.jsx=t,Zf.jsxs=t,Zf}var G1;function jw(){return G1||(G1=1,G0.exports=Nw()),G0.exports}var l=jw(),Y0={exports:{}},ci={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y1;function Pw(){if(Y1)return ci;Y1=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),d=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),b=Symbol.for("react.activity"),S=Symbol.iterator;function v(J){return J===null||typeof J!="object"?null:(J=S&&J[S]||J["@@iterator"],typeof J=="function"?J:null)}var P={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,k={};function N(J,D,W){this.props=J,this.context=D,this.refs=k,this.updater=W||P}N.prototype.isReactComponent={},N.prototype.setState=function(J,D){if(typeof J!="object"&&typeof J!="function"&&J!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,J,D,"setState")},N.prototype.forceUpdate=function(J){this.updater.enqueueForceUpdate(this,J,"forceUpdate")};function $(){}$.prototype=N.prototype;function I(J,D,W){this.props=J,this.context=D,this.refs=k,this.updater=W||P}var z=I.prototype=new $;z.constructor=I,x(z,N.prototype),z.isPureReactComponent=!0;var B=Array.isArray;function G(){}var te={H:null,A:null,T:null,S:null},F=Object.prototype.hasOwnProperty;function H(J,D,W){var K=W.ref;return{$$typeof:r,type:J,key:D,ref:K!==void 0?K:null,props:W}}function Q(J,D){return H(J.type,D,J.props)}function M(J){return typeof J=="object"&&J!==null&&J.$$typeof===r}function T(J){var D={"=":"=0",":":"=2"};return"$"+J.replace(/[=:]/g,function(W){return D[W]})}var R=/\/+/g;function Z(J,D){return typeof J=="object"&&J!==null&&J.key!=null?T(""+J.key):D.toString(36)}function se(J){switch(J.status){case"fulfilled":return J.value;case"rejected":throw J.reason;default:switch(typeof J.status=="string"?J.then(G,G):(J.status="pending",J.then(function(D){J.status==="pending"&&(J.status="fulfilled",J.value=D)},function(D){J.status==="pending"&&(J.status="rejected",J.reason=D)})),J.status){case"fulfilled":return J.value;case"rejected":throw J.reason}}throw J}function V(J,D,W,K,ue){var Te=typeof J;(Te==="undefined"||Te==="boolean")&&(J=null);var Pe=!1;if(J===null)Pe=!0;else switch(Te){case"bigint":case"string":case"number":Pe=!0;break;case"object":switch(J.$$typeof){case r:case e:Pe=!0;break;case m:return Pe=J._init,V(Pe(J._payload),D,W,K,ue)}}if(Pe)return ue=ue(J),Pe=K===""?"."+Z(J,0):K,B(ue)?(W="",Pe!=null&&(W=Pe.replace(R,"$&/")+"/"),V(ue,D,W,"",function(et){return et})):ue!=null&&(M(ue)&&(ue=Q(ue,W+(ue.key==null||J&&J.key===ue.key?"":(""+ue.key).replace(R,"$&/")+"/")+Pe)),D.push(ue)),1;Pe=0;var Ve=K===""?".":K+":";if(B(J))for(var De=0;De<J.length;De++)K=J[De],Te=Ve+Z(K,De),Pe+=V(K,D,W,Te,ue);else if(De=v(J),typeof De=="function")for(J=De.call(J),De=0;!(K=J.next()).done;)K=K.value,Te=Ve+Z(K,De++),Pe+=V(K,D,W,Te,ue);else if(Te==="object"){if(typeof J.then=="function")return V(se(J),D,W,K,ue);throw D=String(J),Error("Objects are not valid as a React child (found: "+(D==="[object Object]"?"object with keys {"+Object.keys(J).join(", ")+"}":D)+"). If you meant to render a collection of children, use an array instead.")}return Pe}function ee(J,D,W){if(J==null)return J;var K=[],ue=0;return V(J,K,"","",function(Te){return D.call(W,Te,ue++)}),K}function ae(J){if(J._status===-1){var D=J._result;D=D(),D.then(function(W){(J._status===0||J._status===-1)&&(J._status=1,J._result=W)},function(W){(J._status===0||J._status===-1)&&(J._status=2,J._result=W)}),J._status===-1&&(J._status=0,J._result=D)}if(J._status===1)return J._result.default;throw J._result}var Ce=typeof reportError=="function"?reportError:function(J){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var D=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof J=="object"&&J!==null&&typeof J.message=="string"?String(J.message):String(J),error:J});if(!window.dispatchEvent(D))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",J);return}console.error(J)},xe={map:ee,forEach:function(J,D,W){ee(J,function(){D.apply(this,arguments)},W)},count:function(J){var D=0;return ee(J,function(){D++}),D},toArray:function(J){return ee(J,function(D){return D})||[]},only:function(J){if(!M(J))throw Error("React.Children.only expected to receive a single React element child.");return J}};return ci.Activity=b,ci.Children=xe,ci.Component=N,ci.Fragment=t,ci.Profiler=s,ci.PureComponent=I,ci.StrictMode=n,ci.Suspense=h,ci.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=te,ci.__COMPILER_RUNTIME={__proto__:null,c:function(J){return te.H.useMemoCache(J)}},ci.cache=function(J){return function(){return J.apply(null,arguments)}},ci.cacheSignal=function(){return null},ci.cloneElement=function(J,D,W){if(J==null)throw Error("The argument must be a React element, but you passed "+J+".");var K=x({},J.props),ue=J.key;if(D!=null)for(Te in D.key!==void 0&&(ue=""+D.key),D)!F.call(D,Te)||Te==="key"||Te==="__self"||Te==="__source"||Te==="ref"&&D.ref===void 0||(K[Te]=D[Te]);var Te=arguments.length-2;if(Te===1)K.children=W;else if(1<Te){for(var Pe=Array(Te),Ve=0;Ve<Te;Ve++)Pe[Ve]=arguments[Ve+2];K.children=Pe}return H(J.type,ue,K)},ci.createContext=function(J){return J={$$typeof:d,_currentValue:J,_currentValue2:J,_threadCount:0,Provider:null,Consumer:null},J.Provider=J,J.Consumer={$$typeof:o,_context:J},J},ci.createElement=function(J,D,W){var K,ue={},Te=null;if(D!=null)for(K in D.key!==void 0&&(Te=""+D.key),D)F.call(D,K)&&K!=="key"&&K!=="__self"&&K!=="__source"&&(ue[K]=D[K]);var Pe=arguments.length-2;if(Pe===1)ue.children=W;else if(1<Pe){for(var Ve=Array(Pe),De=0;De<Pe;De++)Ve[De]=arguments[De+2];ue.children=Ve}if(J&&J.defaultProps)for(K in Pe=J.defaultProps,Pe)ue[K]===void 0&&(ue[K]=Pe[K]);return H(J,Te,ue)},ci.createRef=function(){return{current:null}},ci.forwardRef=function(J){return{$$typeof:c,render:J}},ci.isValidElement=M,ci.lazy=function(J){return{$$typeof:m,_payload:{_status:-1,_result:J},_init:ae}},ci.memo=function(J,D){return{$$typeof:f,type:J,compare:D===void 0?null:D}},ci.startTransition=function(J){var D=te.T,W={};te.T=W;try{var K=J(),ue=te.S;ue!==null&&ue(W,K),typeof K=="object"&&K!==null&&typeof K.then=="function"&&K.then(G,Ce)}catch(Te){Ce(Te)}finally{D!==null&&W.types!==null&&(D.types=W.types),te.T=D}},ci.unstable_useCacheRefresh=function(){return te.H.useCacheRefresh()},ci.use=function(J){return te.H.use(J)},ci.useActionState=function(J,D,W){return te.H.useActionState(J,D,W)},ci.useCallback=function(J,D){return te.H.useCallback(J,D)},ci.useContext=function(J){return te.H.useContext(J)},ci.useDebugValue=function(){},ci.useDeferredValue=function(J,D){return te.H.useDeferredValue(J,D)},ci.useEffect=function(J,D){return te.H.useEffect(J,D)},ci.useEffectEvent=function(J){return te.H.useEffectEvent(J)},ci.useId=function(){return te.H.useId()},ci.useImperativeHandle=function(J,D,W){return te.H.useImperativeHandle(J,D,W)},ci.useInsertionEffect=function(J,D){return te.H.useInsertionEffect(J,D)},ci.useLayoutEffect=function(J,D){return te.H.useLayoutEffect(J,D)},ci.useMemo=function(J,D){return te.H.useMemo(J,D)},ci.useOptimistic=function(J,D){return te.H.useOptimistic(J,D)},ci.useReducer=function(J,D,W){return te.H.useReducer(J,D,W)},ci.useRef=function(J){return te.H.useRef(J)},ci.useState=function(J){return te.H.useState(J)},ci.useSyncExternalStore=function(J,D,W){return te.H.useSyncExternalStore(J,D,W)},ci.useTransition=function(){return te.H.useTransition()},ci.version="19.2.0",ci}var X1;function fy(){return X1||(X1=1,Y0.exports=Pw()),Y0.exports}var X=fy();const Tt=kw(X);var X0={exports:{}},Jf={},K0={exports:{}},Z0={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var K1;function Ew(){return K1||(K1=1,(function(r){function e(V,ee){var ae=V.length;V.push(ee);e:for(;0<ae;){var Ce=ae-1>>>1,xe=V[Ce];if(0<s(xe,ee))V[Ce]=ee,V[ae]=xe,ae=Ce;else break e}}function t(V){return V.length===0?null:V[0]}function n(V){if(V.length===0)return null;var ee=V[0],ae=V.pop();if(ae!==ee){V[0]=ae;e:for(var Ce=0,xe=V.length,J=xe>>>1;Ce<J;){var D=2*(Ce+1)-1,W=V[D],K=D+1,ue=V[K];if(0>s(W,ae))K<xe&&0>s(ue,W)?(V[Ce]=ue,V[K]=ae,Ce=K):(V[Ce]=W,V[D]=ae,Ce=D);else if(K<xe&&0>s(ue,ae))V[Ce]=ue,V[K]=ae,Ce=K;else break e}}return ee}function s(V,ee){var ae=V.sortIndex-ee.sortIndex;return ae!==0?ae:V.id-ee.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;r.unstable_now=function(){return o.now()}}else{var d=Date,c=d.now();r.unstable_now=function(){return d.now()-c}}var h=[],f=[],m=1,b=null,S=3,v=!1,P=!1,x=!1,k=!1,N=typeof setTimeout=="function"?setTimeout:null,$=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;function z(V){for(var ee=t(f);ee!==null;){if(ee.callback===null)n(f);else if(ee.startTime<=V)n(f),ee.sortIndex=ee.expirationTime,e(h,ee);else break;ee=t(f)}}function B(V){if(x=!1,z(V),!P)if(t(h)!==null)P=!0,G||(G=!0,T());else{var ee=t(f);ee!==null&&se(B,ee.startTime-V)}}var G=!1,te=-1,F=5,H=-1;function Q(){return k?!0:!(r.unstable_now()-H<F)}function M(){if(k=!1,G){var V=r.unstable_now();H=V;var ee=!0;try{e:{P=!1,x&&(x=!1,$(te),te=-1),v=!0;var ae=S;try{t:{for(z(V),b=t(h);b!==null&&!(b.expirationTime>V&&Q());){var Ce=b.callback;if(typeof Ce=="function"){b.callback=null,S=b.priorityLevel;var xe=Ce(b.expirationTime<=V);if(V=r.unstable_now(),typeof xe=="function"){b.callback=xe,z(V),ee=!0;break t}b===t(h)&&n(h),z(V)}else n(h);b=t(h)}if(b!==null)ee=!0;else{var J=t(f);J!==null&&se(B,J.startTime-V),ee=!1}}break e}finally{b=null,S=ae,v=!1}ee=void 0}}finally{ee?T():G=!1}}}var T;if(typeof I=="function")T=function(){I(M)};else if(typeof MessageChannel<"u"){var R=new MessageChannel,Z=R.port2;R.port1.onmessage=M,T=function(){Z.postMessage(null)}}else T=function(){N(M,0)};function se(V,ee){te=N(function(){V(r.unstable_now())},ee)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(V){V.callback=null},r.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<V?Math.floor(1e3/V):5},r.unstable_getCurrentPriorityLevel=function(){return S},r.unstable_next=function(V){switch(S){case 1:case 2:case 3:var ee=3;break;default:ee=S}var ae=S;S=ee;try{return V()}finally{S=ae}},r.unstable_requestPaint=function(){k=!0},r.unstable_runWithPriority=function(V,ee){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var ae=S;S=V;try{return ee()}finally{S=ae}},r.unstable_scheduleCallback=function(V,ee,ae){var Ce=r.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?Ce+ae:Ce):ae=Ce,V){case 1:var xe=-1;break;case 2:xe=250;break;case 5:xe=1073741823;break;case 4:xe=1e4;break;default:xe=5e3}return xe=ae+xe,V={id:m++,callback:ee,priorityLevel:V,startTime:ae,expirationTime:xe,sortIndex:-1},ae>Ce?(V.sortIndex=ae,e(f,V),t(h)===null&&V===t(f)&&(x?($(te),te=-1):x=!0,se(B,ae-Ce))):(V.sortIndex=xe,e(h,V),P||v||(P=!0,G||(G=!0,T()))),V},r.unstable_shouldYield=Q,r.unstable_wrapCallback=function(V){var ee=S;return function(){var ae=S;S=ee;try{return V.apply(this,arguments)}finally{S=ae}}}})(Z0)),Z0}var Z1;function Rw(){return Z1||(Z1=1,K0.exports=Ew()),K0.exports}var J0={exports:{}},Yo={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J1;function Dw(){if(J1)return Yo;J1=1;var r=fy();function e(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)f+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function o(h,f,m){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:b==null?null:""+b,children:h,containerInfo:f,implementation:m}}var d=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Yo.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Yo.createPortal=function(h,f){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return o(h,f,null,m)},Yo.flushSync=function(h){var f=d.T,m=n.p;try{if(d.T=null,n.p=2,h)return h()}finally{d.T=f,n.p=m,n.d.f()}},Yo.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(h,f))},Yo.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},Yo.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var m=f.as,b=c(m,f.crossOrigin),S=typeof f.integrity=="string"?f.integrity:void 0,v=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;m==="style"?n.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:b,integrity:S,fetchPriority:v}):m==="script"&&n.d.X(h,{crossOrigin:b,integrity:S,fetchPriority:v,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Yo.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var m=c(f.as,f.crossOrigin);n.d.M(h,{crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(h)},Yo.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var m=f.as,b=c(m,f.crossOrigin);n.d.L(h,m,{crossOrigin:b,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Yo.preloadModule=function(h,f){if(typeof h=="string")if(f){var m=c(f.as,f.crossOrigin);n.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(h)},Yo.requestFormReset=function(h){n.d.r(h)},Yo.unstable_batchedUpdates=function(h,f){return h(f)},Yo.useFormState=function(h,f,m){return d.H.useFormState(h,f,m)},Yo.useFormStatus=function(){return d.H.useHostTransitionStatus()},Yo.version="19.2.0",Yo}var Q1;function Lw(){if(Q1)return J0.exports;Q1=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),J0.exports=Dw(),J0.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ex;function Mw(){if(ex)return Jf;ex=1;var r=Rw(),e=fy(),t=Lw();function n(i){var a="https://react.dev/errors/"+i;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)a+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+i+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var a=i,u=i;if(i.alternate)for(;a.return;)a=a.return;else{i=a;do a=i,(a.flags&4098)!==0&&(u=a.return),i=a.return;while(i)}return a.tag===3?u:null}function d(i){if(i.tag===13){var a=i.memoizedState;if(a===null&&(i=i.alternate,i!==null&&(a=i.memoizedState)),a!==null)return a.dehydrated}return null}function c(i){if(i.tag===31){var a=i.memoizedState;if(a===null&&(i=i.alternate,i!==null&&(a=i.memoizedState)),a!==null)return a.dehydrated}return null}function h(i){if(o(i)!==i)throw Error(n(188))}function f(i){var a=i.alternate;if(!a){if(a=o(i),a===null)throw Error(n(188));return a!==i?null:i}for(var u=i,g=a;;){var w=u.return;if(w===null)break;var _=w.alternate;if(_===null){if(g=w.return,g!==null){u=g;continue}break}if(w.child===_.child){for(_=w.child;_;){if(_===u)return h(w),i;if(_===g)return h(w),a;_=_.sibling}throw Error(n(188))}if(u.return!==g.return)u=w,g=_;else{for(var q=!1,ce=w.child;ce;){if(ce===u){q=!0,u=w,g=_;break}if(ce===g){q=!0,g=w,u=_;break}ce=ce.sibling}if(!q){for(ce=_.child;ce;){if(ce===u){q=!0,u=_,g=w;break}if(ce===g){q=!0,g=_,u=w;break}ce=ce.sibling}if(!q)throw Error(n(189))}}if(u.alternate!==g)throw Error(n(190))}if(u.tag!==3)throw Error(n(188));return u.stateNode.current===u?i:a}function m(i){var a=i.tag;if(a===5||a===26||a===27||a===6)return i;for(i=i.child;i!==null;){if(a=m(i),a!==null)return a;i=i.sibling}return null}var b=Object.assign,S=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),P=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),$=Symbol.for("react.consumer"),I=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),G=Symbol.for("react.suspense_list"),te=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),H=Symbol.for("react.activity"),Q=Symbol.for("react.memo_cache_sentinel"),M=Symbol.iterator;function T(i){return i===null||typeof i!="object"?null:(i=M&&i[M]||i["@@iterator"],typeof i=="function"?i:null)}var R=Symbol.for("react.client.reference");function Z(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===R?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case x:return"Fragment";case N:return"Profiler";case k:return"StrictMode";case B:return"Suspense";case G:return"SuspenseList";case H:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case P:return"Portal";case I:return i.displayName||"Context";case $:return(i._context.displayName||"Context")+".Consumer";case z:var a=i.render;return i=i.displayName,i||(i=a.displayName||a.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case te:return a=i.displayName||null,a!==null?a:Z(i.type)||"Memo";case F:a=i._payload,i=i._init;try{return Z(i(a))}catch{}}return null}var se=Array.isArray,V=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae={pending:!1,data:null,method:null,action:null},Ce=[],xe=-1;function J(i){return{current:i}}function D(i){0>xe||(i.current=Ce[xe],Ce[xe]=null,xe--)}function W(i,a){xe++,Ce[xe]=i.current,i.current=a}var K=J(null),ue=J(null),Te=J(null),Pe=J(null);function Ve(i,a){switch(W(Te,a),W(ue,i),W(K,null),a.nodeType){case 9:case 11:i=(i=a.documentElement)&&(i=i.namespaceURI)?f1(i):0;break;default:if(i=a.tagName,a=a.namespaceURI)a=f1(a),i=p1(a,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}D(K),W(K,i)}function De(){D(K),D(ue),D(Te)}function et(i){i.memoizedState!==null&&W(Pe,i);var a=K.current,u=p1(a,i.type);a!==u&&(W(ue,i),W(K,u))}function ot(i){ue.current===i&&(D(K),D(ue)),Pe.current===i&&(D(Pe),Gf._currentValue=ae)}var at,ht;function xt(i){if(at===void 0)try{throw Error()}catch(u){var a=u.stack.trim().match(/\n( *(at )?)/);at=a&&a[1]||"",ht=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+at+i+ht}var fe=!1;function Nt(i,a){if(!i||fe)return"";fe=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(a){var St=function(){throw Error()};if(Object.defineProperty(St.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(St,[])}catch(rt){var tt=rt}Reflect.construct(i,[],St)}else{try{St.call()}catch(rt){tt=rt}i.call(St.prototype)}}else{try{throw Error()}catch(rt){tt=rt}(St=i())&&typeof St.catch=="function"&&St.catch(function(){})}}catch(rt){if(rt&&tt&&typeof rt.stack=="string")return[rt.stack,tt.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var w=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");w&&w.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=g.DetermineComponentFrameRoot(),q=_[0],ce=_[1];if(q&&ce){var Me=q.split(`
`),Qe=ce.split(`
`);for(w=g=0;g<Me.length&&!Me[g].includes("DetermineComponentFrameRoot");)g++;for(;w<Qe.length&&!Qe[w].includes("DetermineComponentFrameRoot");)w++;if(g===Me.length||w===Qe.length)for(g=Me.length-1,w=Qe.length-1;1<=g&&0<=w&&Me[g]!==Qe[w];)w--;for(;1<=g&&0<=w;g--,w--)if(Me[g]!==Qe[w]){if(g!==1||w!==1)do if(g--,w--,0>w||Me[g]!==Qe[w]){var gt=`
`+Me[g].replace(" at new "," at ");return i.displayName&&gt.includes("<anonymous>")&&(gt=gt.replace("<anonymous>",i.displayName)),gt}while(1<=g&&0<=w);break}}}finally{fe=!1,Error.prepareStackTrace=u}return(u=i?i.displayName||i.name:"")?xt(u):""}function zt(i,a){switch(i.tag){case 26:case 27:case 5:return xt(i.type);case 16:return xt("Lazy");case 13:return i.child!==a&&a!==null?xt("Suspense Fallback"):xt("Suspense");case 19:return xt("SuspenseList");case 0:case 15:return Nt(i.type,!1);case 11:return Nt(i.type.render,!1);case 1:return Nt(i.type,!0);case 31:return xt("Activity");default:return""}}function Bt(i){try{var a="",u=null;do a+=zt(i,u),u=i,i=i.return;while(i);return a}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var it=Object.prototype.hasOwnProperty,qt=r.unstable_scheduleCallback,vt=r.unstable_cancelCallback,Dt=r.unstable_shouldYield,Ot=r.unstable_requestPaint,sn=r.unstable_now,kt=r.unstable_getCurrentPriorityLevel,Lt=r.unstable_ImmediatePriority,Jn=r.unstable_UserBlockingPriority,pt=r.unstable_NormalPriority,jt=r.unstable_LowPriority,Fn=r.unstable_IdlePriority,tn=r.log,zn=r.unstable_setDisableYieldValue,Pn=null,dn=null;function An(i){if(typeof tn=="function"&&zn(i),dn&&typeof dn.setStrictMode=="function")try{dn.setStrictMode(Pn,i)}catch{}}var lt=Math.clz32?Math.clz32:Kt,nn=Math.log,Xt=Math.LN2;function Kt(i){return i>>>=0,i===0?32:31-(nn(i)/Xt|0)|0}var Cn=256,Vi=262144,Vn=4194304;function bn(i){var a=i&42;if(a!==0)return a;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Qt(i,a,u){var g=i.pendingLanes;if(g===0)return 0;var w=0,_=i.suspendedLanes,q=i.pingedLanes;i=i.warmLanes;var ce=g&134217727;return ce!==0?(g=ce&~_,g!==0?w=bn(g):(q&=ce,q!==0?w=bn(q):u||(u=ce&~i,u!==0&&(w=bn(u))))):(ce=g&~_,ce!==0?w=bn(ce):q!==0?w=bn(q):u||(u=g&~i,u!==0&&(w=bn(u)))),w===0?0:a!==0&&a!==w&&(a&_)===0&&(_=w&-w,u=a&-a,_>=u||_===32&&(u&4194048)!==0)?a:w}function Cr(i,a){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&a)===0}function Ks(i,a){switch(i){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zr(){var i=Vn;return Vn<<=1,(Vn&62914560)===0&&(Vn=4194304),i}function Br(i){for(var a=[],u=0;31>u;u++)a.push(i);return a}function en(i,a){i.pendingLanes|=a,a!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Or(i,a,u,g,w,_){var q=i.pendingLanes;i.pendingLanes=u,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=u,i.entangledLanes&=u,i.errorRecoveryDisabledLanes&=u,i.shellSuspendCounter=0;var ce=i.entanglements,Me=i.expirationTimes,Qe=i.hiddenUpdates;for(u=q&~u;0<u;){var gt=31-lt(u),St=1<<gt;ce[gt]=0,Me[gt]=-1;var tt=Qe[gt];if(tt!==null)for(Qe[gt]=null,gt=0;gt<tt.length;gt++){var rt=tt[gt];rt!==null&&(rt.lane&=-536870913)}u&=~St}g!==0&&ja(i,g,0),_!==0&&w===0&&i.tag!==0&&(i.suspendedLanes|=_&~(q&~a))}function ja(i,a,u){i.pendingLanes|=a,i.suspendedLanes&=~a;var g=31-lt(a);i.entangledLanes|=a,i.entanglements[g]=i.entanglements[g]|1073741824|u&261930}function fa(i,a){var u=i.entangledLanes|=a;for(i=i.entanglements;u;){var g=31-lt(u),w=1<<g;w&a|i[g]&a&&(i[g]|=a),u&=~w}}function Ct(i,a){var u=a&-a;return u=(u&42)!==0?1:pi(u),(u&(i.suspendedLanes|a))!==0?0:u}function pi(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function ti(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function vs(){var i=ee.p;return i!==0?i:(i=window.event,i===void 0?32:z1(i.type))}function Ji(i,a){var u=ee.p;try{return ee.p=i,a()}finally{ee.p=u}}var Ds=Math.random().toString(36).slice(2),Ti="__reactFiber$"+Ds,Si="__reactProps$"+Ds,Tr="__reactContainer$"+Ds,pa="__reactEvents$"+Ds,qa="__reactListeners$"+Ds,Yl="__reactHandles$"+Ds,Va="__reactResources$"+Ds,Wa="__reactMarker$"+Ds;function jo(i){delete i[Ti],delete i[Si],delete i[pa],delete i[qa],delete i[Yl]}function Gn(i){var a=i[Ti];if(a)return a;for(var u=i.parentNode;u;){if(a=u[Tr]||u[Ti]){if(u=a.alternate,a.child!==null||u!==null&&u.child!==null)for(i=w1(i);i!==null;){if(u=i[Ti])return u;i=w1(i)}return a}i=u,u=i.parentNode}return null}function Fr(i){if(i=i[Ti]||i[Tr]){var a=i.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return i}return null}function xi(i){var a=i.tag;if(a===5||a===26||a===27||a===6)return i.stateNode;throw Error(n(33))}function ga(i){var a=i[Va];return a||(a=i[Va]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Rn(i){i[Wa]=!0}var Qo=new Set,gi={};function ma(i,a){Pa(i,a),Pa(i+"Capture",a)}function Pa(i,a){for(gi[i]=a,i=0;i<a.length;i++)Qo.add(a[i])}var el=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),tl={},$a={};function td(i){return it.call($a,i)?!0:it.call(tl,i)?!1:el.test(i)?$a[i]=!0:(tl[i]=!0,!1)}function ss(i,a,u){if(td(a))if(u===null)i.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":i.removeAttribute(a);return;case"boolean":var g=a.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){i.removeAttribute(a);return}}i.setAttribute(a,""+u)}}function nl(i,a,u){if(u===null)i.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(a);return}i.setAttribute(a,""+u)}}function Hn(i,a,u,g){if(g===null)i.removeAttribute(u);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(u);return}i.setAttributeNS(a,u,""+g)}}function Un(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function il(i){var a=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Ga(i,a,u){var g=Object.getOwnPropertyDescriptor(i.constructor.prototype,a);if(!i.hasOwnProperty(a)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var w=g.get,_=g.set;return Object.defineProperty(i,a,{configurable:!0,get:function(){return w.call(this)},set:function(q){u=""+q,_.call(this,q)}}),Object.defineProperty(i,a,{enumerable:g.enumerable}),{getValue:function(){return u},setValue:function(q){u=""+q},stopTracking:function(){i._valueTracker=null,delete i[a]}}}}function Fs(i){if(!i._valueTracker){var a=il(i)?"checked":"value";i._valueTracker=Ga(i,a,""+i[a])}}function _r(i){if(!i)return!1;var a=i._valueTracker;if(!a)return!0;var u=a.getValue(),g="";return i&&(g=il(i)?i.checked?"true":"false":i.value),i=g,i!==u?(a.setValue(i),!0):!1}function us(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Wn=/[\n"\\]/g;function bi(i){return i.replace(Wn,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Xl(i,a,u,g,w,_,q,ce){i.name="",q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?i.type=q:i.removeAttribute("type"),a!=null?q==="number"?(a===0&&i.value===""||i.value!=a)&&(i.value=""+Un(a)):i.value!==""+Un(a)&&(i.value=""+Un(a)):q!=="submit"&&q!=="reset"||i.removeAttribute("value"),a!=null?ya(i,q,Un(a)):u!=null?ya(i,q,Un(u)):g!=null&&i.removeAttribute("value"),w==null&&_!=null&&(i.defaultChecked=!!_),w!=null&&(i.checked=w&&typeof w!="function"&&typeof w!="symbol"),ce!=null&&typeof ce!="function"&&typeof ce!="symbol"&&typeof ce!="boolean"?i.name=""+Un(ce):i.removeAttribute("name")}function bc(i,a,u,g,w,_,q,ce){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(i.type=_),a!=null||u!=null){if(!(_!=="submit"&&_!=="reset"||a!=null)){Fs(i);return}u=u!=null?""+Un(u):"",a=a!=null?""+Un(a):u,ce||a===i.value||(i.value=a),i.defaultValue=a}g=g??w,g=typeof g!="function"&&typeof g!="symbol"&&!!g,i.checked=ce?i.checked:!!g,i.defaultChecked=!!g,q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(i.name=q),Fs(i)}function ya(i,a,u){a==="number"&&us(i.ownerDocument)===i||i.defaultValue===""+u||(i.defaultValue=""+u)}function kr(i,a,u,g){if(i=i.options,a){a={};for(var w=0;w<u.length;w++)a["$"+u[w]]=!0;for(u=0;u<i.length;u++)w=a.hasOwnProperty("$"+i[u].value),i[u].selected!==w&&(i[u].selected=w),w&&g&&(i[u].defaultSelected=!0)}else{for(u=""+Un(u),a=null,w=0;w<i.length;w++){if(i[w].value===u){i[w].selected=!0,g&&(i[w].defaultSelected=!0);return}a!==null||i[w].disabled||(a=i[w])}a!==null&&(a.selected=!0)}}function sl(i,a,u){if(a!=null&&(a=""+Un(a),a!==i.value&&(i.value=a),u==null)){i.defaultValue!==a&&(i.defaultValue=a);return}i.defaultValue=u!=null?""+Un(u):""}function Ya(i,a,u,g){if(a==null){if(g!=null){if(u!=null)throw Error(n(92));if(se(g)){if(1<g.length)throw Error(n(93));g=g[0]}u=g}u==null&&(u=""),a=u}u=Un(a),i.defaultValue=u,g=i.textContent,g===u&&g!==""&&g!==null&&(i.value=g),Fs(i)}function Nr(i,a){if(a){var u=i.firstChild;if(u&&u===i.lastChild&&u.nodeType===3){u.nodeValue=a;return}}i.textContent=a}var na=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Rt(i,a,u){var g=a.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?g?i.setProperty(a,""):a==="float"?i.cssFloat="":i[a]="":g?i.setProperty(a,u):typeof u!="number"||u===0||na.has(a)?a==="float"?i.cssFloat=u:i[a]=(""+u).trim():i[a]=u+"px"}function Qi(i,a,u){if(a!=null&&typeof a!="object")throw Error(n(62));if(i=i.style,u!=null){for(var g in u)!u.hasOwnProperty(g)||a!=null&&a.hasOwnProperty(g)||(g.indexOf("--")===0?i.setProperty(g,""):g==="float"?i.cssFloat="":i[g]="");for(var w in a)g=a[w],a.hasOwnProperty(w)&&u[w]!==g&&Rt(i,w,g)}else for(var _ in a)a.hasOwnProperty(_)&&Rt(i,_,a[_])}function fr(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Al=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Xa=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ea(i){return Xa.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function co(){}var rs=null;function es(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Po=null,Bn=null;function ni(i){var a=Fr(i);if(a&&(i=a.stateNode)){var u=i[Si]||null;e:switch(i=a.stateNode,a.type){case"input":if(Xl(i,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),a=u.name,u.type==="radio"&&a!=null){for(u=i;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+bi(""+a)+'"][type="radio"]'),a=0;a<u.length;a++){var g=u[a];if(g!==i&&g.form===i.form){var w=g[Si]||null;if(!w)throw Error(n(90));Xl(g,w.value,w.defaultValue,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name)}}for(a=0;a<u.length;a++)g=u[a],g.form===i.form&&_r(g)}break e;case"textarea":sl(i,u.value,u.defaultValue);break e;case"select":a=u.value,a!=null&&kr(i,!!u.multiple,a,!1)}}}var Tn=!1;function Hc(i,a,u){if(Tn)return i(a,u);Tn=!0;try{var g=i(a);return g}finally{if(Tn=!1,(Po!==null||Bn!==null)&&(Kp(),Po&&(a=Po,i=Bn,Bn=Po=null,ni(a),i)))for(a=0;a<i.length;a++)ni(i[a])}}function xa(i,a){var u=i.stateNode;if(u===null)return null;var g=u[Si]||null;if(g===null)return null;u=g[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(i=i.type,g=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!g;break e;default:i=!1}if(i)return null;if(u&&typeof u!="function")throw Error(n(231,a,typeof u));return u}var an=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_n=!1;if(an)try{var ai={};Object.defineProperty(ai,"passive",{get:function(){_n=!0}}),window.addEventListener("test",ai,ai),window.removeEventListener("test",ai,ai)}catch{_n=!1}var rn=null,oi=null,mn=null;function Zd(){if(mn)return mn;var i,a=oi,u=a.length,g,w="value"in rn?rn.value:rn.textContent,_=w.length;for(i=0;i<u&&a[i]===w[i];i++);var q=u-i;for(g=1;g<=q&&a[u-g]===w[_-g];g++);return mn=w.slice(i,1<g?1-g:void 0)}function Ut(i){var a=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&a===13&&(i=13)):i=a,i===10&&(i=13),32<=i||i===13?i:0}function Pi(){return!0}function Zt(){return!1}function Yn(i){function a(u,g,w,_,q){this._reactName=u,this._targetInst=w,this.type=g,this.nativeEvent=_,this.target=q,this.currentTarget=null;for(var ce in i)i.hasOwnProperty(ce)&&(u=i[ce],this[ce]=u?u(_):_[ce]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?Pi:Zt,this.isPropagationStopped=Zt,this}return b(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Pi)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Pi)},persist:function(){},isPersistent:Pi}),a}var Ur={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ka=Yn(Ur),Zs=b({},Ur,{view:0,detail:0}),rl=Yn(Zs),Ra,Za,al,vc=b({},Zs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pn,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==al&&(al&&i.type==="mousemove"?(Ra=i.screenX-al.screenX,Za=i.screenY-al.screenY):Za=Ra=0,al=i),Ra)},movementY:function(i){return"movementY"in i?i.movementY:Za}}),Kl=Yn(vc),Cl=b({},vc,{dataTransfer:0}),Eo=Yn(Cl),Jd=b({},Zs,{relatedTarget:0}),yn=Yn(Jd),Ro=b({},Ur,{animationName:0,elapsedTime:0,pseudoElement:0}),j=Yn(Ro),ne=b({},Ur,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),we=Yn(ne),Re=b({},Ur,{data:0}),Fe=Yn(Re),st={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yt={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Gt={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xn(i){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(i):(i=Gt[i])?!!a[i]:!1}function pn(){return xn}var Qn=b({},Zs,{key:function(i){if(i.key){var a=st[i.key]||i.key;if(a!=="Unidentified")return a}return i.type==="keypress"?(i=Ut(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?yt[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pn,charCode:function(i){return i.type==="keypress"?Ut(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Ut(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),vi=Yn(Qn),Us=b({},vc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ji=Yn(Us),Wi=b({},Zs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pn}),Ei=Yn(Wi),ks=b({},Ur,{propertyName:0,elapsedTime:0,pseudoElement:0}),as=Yn(ks),uo=b({},vc,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),jr=Yn(uo),ol=b({},Ur,{newState:0,oldState:0}),pr=Yn(ol),ll=[9,13,27,32],Hs=an&&"CompositionEvent"in window,ba=null;an&&"documentMode"in document&&(ba=document.documentMode);var gr=an&&"TextEvent"in window&&!ba,Ja=an&&(!Hs||ba&&8<ba&&11>=ba),li=" ",ho=!1;function wc(i,a){switch(i){case"keyup":return ll.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nd(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Qa=!1;function Hr(i,a){switch(i){case"compositionend":return nd(a);case"keypress":return a.which!==32?null:(ho=!0,li);case"textInput":return i=a.data,i===li&&ho?null:i;default:return null}}function Do(i,a){if(Qa)return i==="compositionend"||!Hs&&wc(i,a)?(i=Zd(),mn=oi=rn=null,Qa=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Ja&&a.locale!=="ko"?null:a.data;default:return null}}var Sc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lo(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a==="input"?!!Sc[i.type]:a==="textarea"}function va(i,a,u,g){Po?Bn?Bn.push(g):Bn=[g]:Po=g,a=ig(a,"onChange"),0<a.length&&(u=new Ka("onChange","change",null,u,g),i.push({event:u,listeners:a}))}var nr=null,eo=null;function cl(i){o1(i,0)}function fo(i){var a=xi(i);if(_r(a))return i}function po(i,a){if(i==="change")return a}var wa=!1;if(an){var ir;if(an){var Mo="oninput"in document;if(!Mo){var Da=document.createElement("div");Da.setAttribute("oninput","return;"),Mo=typeof Da.oninput=="function"}ir=Mo}else ir=!1;wa=ir&&(!document.documentMode||9<document.documentMode)}function _i(){nr&&(nr.detachEvent("onpropertychange",Io),eo=nr=null)}function Io(i){if(i.propertyName==="value"&&fo(eo)){var a=[];va(a,eo,i,es(i)),Hc(cl,a)}}function os(i,a,u){i==="focusin"?(_i(),nr=a,eo=u,nr.attachEvent("onpropertychange",Io)):i==="focusout"&&_i()}function ws(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return fo(eo)}function id(i,a){if(i==="click")return fo(a)}function La(i,a){if(i==="input"||i==="change")return fo(a)}function Tl(i,a){return i===a&&(i!==0||1/i===1/a)||i!==i&&a!==a}var Pr=typeof Object.is=="function"?Object.is:Tl;function Zl(i,a){if(Pr(i,a))return!0;if(typeof i!="object"||i===null||typeof a!="object"||a===null)return!1;var u=Object.keys(i),g=Object.keys(a);if(u.length!==g.length)return!1;for(g=0;g<u.length;g++){var w=u[g];if(!it.call(a,w)||!Pr(i[w],a[w]))return!1}return!0}function sd(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function to(i,a){var u=sd(i);i=0;for(var g;u;){if(u.nodeType===3){if(g=i+u.textContent.length,i<=a&&g>=a)return{node:u,offset:a-i};i=g}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=sd(u)}}function dl(i,a){return i&&a?i===a?!0:i&&i.nodeType===3?!1:a&&a.nodeType===3?dl(i,a.parentNode):"contains"in i?i.contains(a):i.compareDocumentPosition?!!(i.compareDocumentPosition(a)&16):!1:!1}function zo(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var a=us(i.document);a instanceof i.HTMLIFrameElement;){try{var u=typeof a.contentWindow.location.href=="string"}catch{u=!1}if(u)i=a.contentWindow;else break;a=us(i.document)}return a}function Sa(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a&&(a==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||a==="textarea"||i.contentEditable==="true")}var qr=an&&"documentMode"in document&&11>=document.documentMode,Ma=null,Bo=null,Aa=null,go=!1;function $i(i,a,u){var g=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;go||Ma==null||Ma!==us(g)||(g=Ma,"selectionStart"in g&&Sa(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),Aa&&Zl(Aa,g)||(Aa=g,g=ig(Bo,"onSelect"),0<g.length&&(a=new Ka("onSelect","select",null,a,u),i.push({event:a,listeners:g}),a.target=Ma)))}function Ri(i,a){var u={};return u[i.toLowerCase()]=a.toLowerCase(),u["Webkit"+i]="webkit"+a,u["Moz"+i]="moz"+a,u}var Ss={animationend:Ri("Animation","AnimationEnd"),animationiteration:Ri("Animation","AnimationIteration"),animationstart:Ri("Animation","AnimationStart"),transitionrun:Ri("Transition","TransitionRun"),transitionstart:Ri("Transition","TransitionStart"),transitioncancel:Ri("Transition","TransitionCancel"),transitionend:Ri("Transition","TransitionEnd")},sr={},_l={};an&&(_l=document.createElement("div").style,"AnimationEvent"in window||(delete Ss.animationend.animation,delete Ss.animationiteration.animation,delete Ss.animationstart.animation),"TransitionEvent"in window||delete Ss.transitionend.transition);function ul(i){if(sr[i])return sr[i];if(!Ss[i])return i;var a=Ss[i],u;for(u in a)if(a.hasOwnProperty(u)&&u in _l)return sr[i]=a[u];return i}var rr=ul("animationend"),Ca=ul("animationiteration"),kl=ul("animationstart"),hl=ul("transitionrun"),Nl=ul("transitionstart"),Jl=ul("transitioncancel"),jl=ul("transitionend"),no=new Map,Pl="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Pl.push("scrollEnd");function hs(i,a){no.set(i,a),ma(a,[i])}var ki=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},qs=[],Vs=0,Ia=0;function jd(){for(var i=Vs,a=Ia=Vs=0;a<i;){var u=qs[a];qs[a++]=null;var g=qs[a];qs[a++]=null;var w=qs[a];qs[a++]=null;var _=qs[a];if(qs[a++]=null,g!==null&&w!==null){var q=g.pending;q===null?w.next=w:(w.next=q.next,q.next=w),g.pending=w}_!==0&&Fi(u,w,_)}}function fl(i,a,u,g){qs[Vs++]=i,qs[Vs++]=a,qs[Vs++]=u,qs[Vs++]=g,Ia|=g,i.lanes|=g,i=i.alternate,i!==null&&(i.lanes|=g)}function Pd(i,a,u,g){return fl(i,a,u,g),ls(i)}function Oo(i,a){return fl(i,null,null,a),ls(i)}function Fi(i,a,u){i.lanes|=u;var g=i.alternate;g!==null&&(g.lanes|=u);for(var w=!1,_=i.return;_!==null;)_.childLanes|=u,g=_.alternate,g!==null&&(g.childLanes|=u),_.tag===22&&(i=_.stateNode,i===null||i._visibility&1||(w=!0)),i=_,_=_.return;return i.tag===3?(_=i.stateNode,w&&a!==null&&(w=31-lt(u),i=_.hiddenUpdates,g=i[w],g===null?i[w]=[a]:g.push(a),a.lane=u|536870912),_):null}function ls(i){if(50<Ff)throw Ff=0,m0=null,Error(n(185));for(var a=i.return;a!==null;)i=a,a=i.return;return i.tag===3?i.stateNode:null}var Er={};function Ed(i,a,u,g){this.tag=i,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ia(i,a,u,g){return new Ed(i,a,u,g)}function rd(i){return i=i.prototype,!(!i||!i.isReactComponent)}function za(i,a){var u=i.alternate;return u===null?(u=ia(i.tag,a,i.key,i.mode),u.elementType=i.elementType,u.type=i.type,u.stateNode=i.stateNode,u.alternate=i,i.alternate=u):(u.pendingProps=a,u.type=i.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=i.flags&65011712,u.childLanes=i.childLanes,u.lanes=i.lanes,u.child=i.child,u.memoizedProps=i.memoizedProps,u.memoizedState=i.memoizedState,u.updateQueue=i.updateQueue,a=i.dependencies,u.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},u.sibling=i.sibling,u.index=i.index,u.ref=i.ref,u.refCleanup=i.refCleanup,u}function qc(i,a){i.flags&=65011714;var u=i.alternate;return u===null?(i.childLanes=0,i.lanes=a,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=u.childLanes,i.lanes=u.lanes,i.child=u.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=u.memoizedProps,i.memoizedState=u.memoizedState,i.updateQueue=u.updateQueue,i.type=u.type,a=u.dependencies,i.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),i}function El(i,a,u,g,w,_){var q=0;if(g=i,typeof i=="function")rd(i)&&(q=1);else if(typeof i=="string")q=gw(i,u,K.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case H:return i=ia(31,u,a,w),i.elementType=H,i.lanes=_,i;case x:return Ql(u.children,w,_,a);case k:q=8,w|=24;break;case N:return i=ia(12,u,a,w|2),i.elementType=N,i.lanes=_,i;case B:return i=ia(13,u,a,w),i.elementType=B,i.lanes=_,i;case G:return i=ia(19,u,a,w),i.elementType=G,i.lanes=_,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case I:q=10;break e;case $:q=9;break e;case z:q=11;break e;case te:q=14;break e;case F:q=16,g=null;break e}q=29,u=Error(n(130,i===null?"null":typeof i,"")),g=null}return a=ia(q,u,a,w),a.elementType=i,a.type=g,a.lanes=_,a}function Ql(i,a,u,g){return i=ia(7,i,g,a),i.lanes=u,i}function pl(i,a,u){return i=ia(6,i,null,a),i.lanes=u,i}function Ac(i){var a=ia(18,null,null,0);return a.stateNode=i,a}function Fo(i,a,u){return a=ia(4,i.children!==null?i.children:[],i.key,a),a.lanes=u,a.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},a}var ec=new WeakMap;function Ba(i,a){if(typeof i=="object"&&i!==null){var u=ec.get(i);return u!==void 0?u:(a={value:i,source:a,stack:Bt(a)},ec.set(i,a),a)}return{value:i,source:a,stack:Bt(a)}}var tc=[],mo=0,Rl=null,ad=0,ar=[],yo=0,Js=null,Oa=1,xo="";function Rr(i,a){tc[mo++]=ad,tc[mo++]=Rl,Rl=i,ad=a}function Cc(i,a,u){ar[yo++]=Oa,ar[yo++]=xo,ar[yo++]=Js,Js=i;var g=Oa;i=xo;var w=32-lt(g)-1;g&=~(1<<w),u+=1;var _=32-lt(a)+w;if(30<_){var q=w-w%5;_=(g&(1<<q)-1).toString(32),g>>=q,w-=q,Oa=1<<32-lt(a)+w|u<<w|g,xo=_+i}else Oa=1<<_|u<<w|g,xo=i}function od(i){i.return!==null&&(Rr(i,1),Cc(i,1,0))}function nc(i){for(;i===Rl;)Rl=tc[--mo],tc[mo]=null,ad=tc[--mo],tc[mo]=null;for(;i===Js;)Js=ar[--yo],ar[yo]=null,xo=ar[--yo],ar[yo]=null,Oa=ar[--yo],ar[yo]=null}function Dl(i,a){ar[yo++]=Oa,ar[yo++]=xo,ar[yo++]=Js,Oa=a.id,xo=a.overflow,Js=i}var sa=null,As=null,Ni=!1,Fa=null,Qs=!1,bo=Error(n(519));function ic(i){var a=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw mr(Ba(a,i)),bo}function Qd(i){var a=i.stateNode,u=i.type,g=i.memoizedProps;switch(a[Ti]=i,a[Si]=g,u){case"dialog":Oi("cancel",a),Oi("close",a);break;case"iframe":case"object":case"embed":Oi("load",a);break;case"video":case"audio":for(u=0;u<Hf.length;u++)Oi(Hf[u],a);break;case"source":Oi("error",a);break;case"img":case"image":case"link":Oi("error",a),Oi("load",a);break;case"details":Oi("toggle",a);break;case"input":Oi("invalid",a),bc(a,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":Oi("invalid",a);break;case"textarea":Oi("invalid",a),Ya(a,g.value,g.defaultValue,g.children)}u=g.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||a.textContent===""+u||g.suppressHydrationWarning===!0||u1(a.textContent,u)?(g.popover!=null&&(Oi("beforetoggle",a),Oi("toggle",a)),g.onScroll!=null&&Oi("scroll",a),g.onScrollEnd!=null&&Oi("scrollend",a),g.onClick!=null&&(a.onclick=co),a=!0):a=!1,a||ic(i,!0)}function Ll(i){for(sa=i.return;sa;)switch(sa.tag){case 5:case 31:case 13:Qs=!1;return;case 27:case 3:Qs=!0;return;default:sa=sa.return}}function Ls(i){if(i!==sa)return!1;if(!Ni)return Ll(i),Ni=!0,!1;var a=i.tag,u;if((u=a!==3&&a!==27)&&((u=a===5)&&(u=i.type,u=!(u!=="form"&&u!=="button")||E0(i.type,i.memoizedProps)),u=!u),u&&As&&ic(i),Ll(i),a===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));As=v1(i)}else if(a===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));As=v1(i)}else a===27?(a=As,Su(i.type)?(i=I0,I0=null,As=i):As=a):As=sa?Dc(i.stateNode.nextSibling):null;return!0}function or(){As=sa=null,Ni=!1}function Ml(){var i=Fa;return i!==null&&(Yi===null?Yi=i:Yi.push.apply(Yi,i),Fa=null),i}function mr(i){Fa===null?Fa=[i]:Fa.push(i)}var lr=J(null),Vr=null,Ns=null;function Wr(i,a,u){W(lr,a._currentValue),a._currentValue=u}function ys(i){i._currentValue=lr.current,D(lr)}function Ta(i,a,u){for(;i!==null;){var g=i.alternate;if((i.childLanes&a)!==a?(i.childLanes|=a,g!==null&&(g.childLanes|=a)):g!==null&&(g.childLanes&a)!==a&&(g.childLanes|=a),i===u)break;i=i.return}}function cr(i,a,u,g){var w=i.child;for(w!==null&&(w.return=i);w!==null;){var _=w.dependencies;if(_!==null){var q=w.child;_=_.firstContext;e:for(;_!==null;){var ce=_;_=w;for(var Me=0;Me<a.length;Me++)if(ce.context===a[Me]){_.lanes|=u,ce=_.alternate,ce!==null&&(ce.lanes|=u),Ta(_.return,u,i),g||(q=null);break e}_=ce.next}}else if(w.tag===18){if(q=w.return,q===null)throw Error(n(341));q.lanes|=u,_=q.alternate,_!==null&&(_.lanes|=u),Ta(q,u,i),q=null}else q=w.child;if(q!==null)q.return=w;else for(q=w;q!==null;){if(q===i){q=null;break}if(w=q.sibling,w!==null){w.return=q.return,q=w;break}q=q.return}w=q}}function $r(i,a,u,g){i=null;for(var w=a,_=!1;w!==null;){if(!_){if((w.flags&524288)!==0)_=!0;else if((w.flags&262144)!==0)break}if(w.tag===10){var q=w.alternate;if(q===null)throw Error(n(387));if(q=q.memoizedProps,q!==null){var ce=w.type;Pr(w.pendingProps.value,q.value)||(i!==null?i.push(ce):i=[ce])}}else if(w===Pe.current){if(q=w.alternate,q===null)throw Error(n(387));q.memoizedState.memoizedState!==w.memoizedState.memoizedState&&(i!==null?i.push(Gf):i=[Gf])}w=w.return}i!==null&&cr(a,i,u,g),a.flags|=262144}function Gr(i){for(i=i.firstContext;i!==null;){if(!Pr(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Yr(i){Vr=i,Ns=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function fs(i){return vo(Vr,i)}function Uo(i,a){return Vr===null&&Yr(i),vo(i,a)}function vo(i,a){var u=a._currentValue;if(a={context:a,memoizedValue:u,next:null},Ns===null){if(i===null)throw Error(n(308));Ns=a,i.dependencies={lanes:0,firstContext:a},i.flags|=524288}else Ns=Ns.next=a;return u}var sc=typeof AbortController<"u"?AbortController:function(){var i=[],a=this.signal={aborted:!1,addEventListener:function(u,g){i.push(g)}};this.abort=function(){a.aborted=!0,i.forEach(function(u){return u()})}},io=r.unstable_scheduleCallback,Ho=r.unstable_NormalPriority,Di={$$typeof:I,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ra(){return{controller:new sc,data:new Map,refCount:0}}function _a(i){i.refCount--,i.refCount===0&&io(Ho,function(){i.controller.abort()})}var Xr=null,Dn=0,y=0,A=null;function E(i,a){if(Xr===null){var u=Xr=[];Dn=0,y=S0(),A={status:"pending",value:void 0,then:function(g){u.push(g)}}}return Dn++,a.then(O,O),a}function O(){if(--Dn===0&&Xr!==null){A!==null&&(A.status="fulfilled");var i=Xr;Xr=null,y=0,A=null;for(var a=0;a<i.length;a++)(0,i[a])()}}function ie(i,a){var u=[],g={status:"pending",value:null,reason:null,then:function(w){u.push(w)}};return i.then(function(){g.status="fulfilled",g.value=a;for(var w=0;w<u.length;w++)(0,u[w])(a)},function(w){for(g.status="rejected",g.reason=w,w=0;w<u.length;w++)(0,u[w])(void 0)}),g}var re=V.S;V.S=function(i,a){yl=sn(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&E(i,a),re!==null&&re(i,a)};var oe=J(null);function de(){var i=oe.current;return i!==null?i:Xe.pooledCache}function me(i,a){a===null?W(oe,oe.current):W(oe,a.pool)}function _e(){var i=de();return i===null?null:{parent:Di._currentValue,pool:i}}var ze=Error(n(460)),Ke=Error(n(474)),ve=Error(n(542)),Be={then:function(){}};function $e(i){return i=i.status,i==="fulfilled"||i==="rejected"}function ut(i,a,u){switch(u=i[u],u===void 0?i.push(a):u!==a&&(a.then(co,co),a=u),a.status){case"fulfilled":return a.value;case"rejected":throw i=a.reason,_t(i),i;default:if(typeof a.status=="string")a.then(co,co);else{if(i=Xe,i!==null&&100<i.shellSuspendCounter)throw Error(n(482));i=a,i.status="pending",i.then(function(g){if(a.status==="pending"){var w=a;w.status="fulfilled",w.value=g}},function(g){if(a.status==="pending"){var w=a;w.status="rejected",w.reason=g}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw i=a.reason,_t(i),i}throw Je=a,ze}}function We(i){try{var a=i._init;return a(i._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(Je=u,ze):u}}var Je=null;function mt(){if(Je===null)throw Error(n(459));var i=Je;return Je=null,i}function _t(i){if(i===ze||i===ve)throw Error(n(483))}var wt=null,on=0;function $t(i){var a=on;return on+=1,wt===null&&(wt=[]),ut(wt,i,a)}function ln(i,a){a=a.props.ref,i.ref=a!==void 0?a:null}function Ht(i,a){throw a.$$typeof===S?Error(n(525)):(i=Object.prototype.toString.call(a),Error(n(31,i==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":i)))}function ii(i){function a(Ge,Oe){if(i){var Ze=Ge.deletions;Ze===null?(Ge.deletions=[Oe],Ge.flags|=16):Ze.push(Oe)}}function u(Ge,Oe){if(!i)return null;for(;Oe!==null;)a(Ge,Oe),Oe=Oe.sibling;return null}function g(Ge){for(var Oe=new Map;Ge!==null;)Ge.key!==null?Oe.set(Ge.key,Ge):Oe.set(Ge.index,Ge),Ge=Ge.sibling;return Oe}function w(Ge,Oe){return Ge=za(Ge,Oe),Ge.index=0,Ge.sibling=null,Ge}function _(Ge,Oe,Ze){return Ge.index=Ze,i?(Ze=Ge.alternate,Ze!==null?(Ze=Ze.index,Ze<Oe?(Ge.flags|=67108866,Oe):Ze):(Ge.flags|=67108866,Oe)):(Ge.flags|=1048576,Oe)}function q(Ge){return i&&Ge.alternate===null&&(Ge.flags|=67108866),Ge}function ce(Ge,Oe,Ze,bt){return Oe===null||Oe.tag!==6?(Oe=pl(Ze,Ge.mode,bt),Oe.return=Ge,Oe):(Oe=w(Oe,Ze),Oe.return=Ge,Oe)}function Me(Ge,Oe,Ze,bt){var Ln=Ze.type;return Ln===x?gt(Ge,Oe,Ze.props.children,bt,Ze.key):Oe!==null&&(Oe.elementType===Ln||typeof Ln=="object"&&Ln!==null&&Ln.$$typeof===F&&We(Ln)===Oe.type)?(Oe=w(Oe,Ze.props),ln(Oe,Ze),Oe.return=Ge,Oe):(Oe=El(Ze.type,Ze.key,Ze.props,null,Ge.mode,bt),ln(Oe,Ze),Oe.return=Ge,Oe)}function Qe(Ge,Oe,Ze,bt){return Oe===null||Oe.tag!==4||Oe.stateNode.containerInfo!==Ze.containerInfo||Oe.stateNode.implementation!==Ze.implementation?(Oe=Fo(Ze,Ge.mode,bt),Oe.return=Ge,Oe):(Oe=w(Oe,Ze.children||[]),Oe.return=Ge,Oe)}function gt(Ge,Oe,Ze,bt,Ln){return Oe===null||Oe.tag!==7?(Oe=Ql(Ze,Ge.mode,bt,Ln),Oe.return=Ge,Oe):(Oe=w(Oe,Ze),Oe.return=Ge,Oe)}function St(Ge,Oe,Ze){if(typeof Oe=="string"&&Oe!==""||typeof Oe=="number"||typeof Oe=="bigint")return Oe=pl(""+Oe,Ge.mode,Ze),Oe.return=Ge,Oe;if(typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case v:return Ze=El(Oe.type,Oe.key,Oe.props,null,Ge.mode,Ze),ln(Ze,Oe),Ze.return=Ge,Ze;case P:return Oe=Fo(Oe,Ge.mode,Ze),Oe.return=Ge,Oe;case F:return Oe=We(Oe),St(Ge,Oe,Ze)}if(se(Oe)||T(Oe))return Oe=Ql(Oe,Ge.mode,Ze,null),Oe.return=Ge,Oe;if(typeof Oe.then=="function")return St(Ge,$t(Oe),Ze);if(Oe.$$typeof===I)return St(Ge,Uo(Ge,Oe),Ze);Ht(Ge,Oe)}return null}function tt(Ge,Oe,Ze,bt){var Ln=Oe!==null?Oe.key:null;if(typeof Ze=="string"&&Ze!==""||typeof Ze=="number"||typeof Ze=="bigint")return Ln!==null?null:ce(Ge,Oe,""+Ze,bt);if(typeof Ze=="object"&&Ze!==null){switch(Ze.$$typeof){case v:return Ze.key===Ln?Me(Ge,Oe,Ze,bt):null;case P:return Ze.key===Ln?Qe(Ge,Oe,Ze,bt):null;case F:return Ze=We(Ze),tt(Ge,Oe,Ze,bt)}if(se(Ze)||T(Ze))return Ln!==null?null:gt(Ge,Oe,Ze,bt,null);if(typeof Ze.then=="function")return tt(Ge,Oe,$t(Ze),bt);if(Ze.$$typeof===I)return tt(Ge,Oe,Uo(Ge,Ze),bt);Ht(Ge,Ze)}return null}function rt(Ge,Oe,Ze,bt,Ln){if(typeof bt=="string"&&bt!==""||typeof bt=="number"||typeof bt=="bigint")return Ge=Ge.get(Ze)||null,ce(Oe,Ge,""+bt,Ln);if(typeof bt=="object"&&bt!==null){switch(bt.$$typeof){case v:return Ge=Ge.get(bt.key===null?Ze:bt.key)||null,Me(Oe,Ge,bt,Ln);case P:return Ge=Ge.get(bt.key===null?Ze:bt.key)||null,Qe(Oe,Ge,bt,Ln);case F:return bt=We(bt),rt(Ge,Oe,Ze,bt,Ln)}if(se(bt)||T(bt))return Ge=Ge.get(Ze)||null,gt(Oe,Ge,bt,Ln,null);if(typeof bt.then=="function")return rt(Ge,Oe,Ze,$t(bt),Ln);if(bt.$$typeof===I)return rt(Ge,Oe,Ze,Uo(Oe,bt),Ln);Ht(Oe,bt)}return null}function hn(Ge,Oe,Ze,bt){for(var Ln=null,gs=null,vn=Oe,Ci=Oe=0,qi=null;vn!==null&&Ci<Ze.length;Ci++){vn.index>Ci?(qi=vn,vn=null):qi=vn.sibling;var ms=tt(Ge,vn,Ze[Ci],bt);if(ms===null){vn===null&&(vn=qi);break}i&&vn&&ms.alternate===null&&a(Ge,vn),Oe=_(ms,Oe,Ci),gs===null?Ln=ms:gs.sibling=ms,gs=ms,vn=qi}if(Ci===Ze.length)return u(Ge,vn),Ni&&Rr(Ge,Ci),Ln;if(vn===null){for(;Ci<Ze.length;Ci++)vn=St(Ge,Ze[Ci],bt),vn!==null&&(Oe=_(vn,Oe,Ci),gs===null?Ln=vn:gs.sibling=vn,gs=vn);return Ni&&Rr(Ge,Ci),Ln}for(vn=g(vn);Ci<Ze.length;Ci++)qi=rt(vn,Ge,Ci,Ze[Ci],bt),qi!==null&&(i&&qi.alternate!==null&&vn.delete(qi.key===null?Ci:qi.key),Oe=_(qi,Oe,Ci),gs===null?Ln=qi:gs.sibling=qi,gs=qi);return i&&vn.forEach(function(ku){return a(Ge,ku)}),Ni&&Rr(Ge,Ci),Ln}function $n(Ge,Oe,Ze,bt){if(Ze==null)throw Error(n(151));for(var Ln=null,gs=null,vn=Oe,Ci=Oe=0,qi=null,ms=Ze.next();vn!==null&&!ms.done;Ci++,ms=Ze.next()){vn.index>Ci?(qi=vn,vn=null):qi=vn.sibling;var ku=tt(Ge,vn,ms.value,bt);if(ku===null){vn===null&&(vn=qi);break}i&&vn&&ku.alternate===null&&a(Ge,vn),Oe=_(ku,Oe,Ci),gs===null?Ln=ku:gs.sibling=ku,gs=ku,vn=qi}if(ms.done)return u(Ge,vn),Ni&&Rr(Ge,Ci),Ln;if(vn===null){for(;!ms.done;Ci++,ms=Ze.next())ms=St(Ge,ms.value,bt),ms!==null&&(Oe=_(ms,Oe,Ci),gs===null?Ln=ms:gs.sibling=ms,gs=ms);return Ni&&Rr(Ge,Ci),Ln}for(vn=g(vn);!ms.done;Ci++,ms=Ze.next())ms=rt(vn,Ge,Ci,ms.value,bt),ms!==null&&(i&&ms.alternate!==null&&vn.delete(ms.key===null?Ci:ms.key),Oe=_(ms,Oe,Ci),gs===null?Ln=ms:gs.sibling=ms,gs=ms);return i&&vn.forEach(function(_w){return a(Ge,_w)}),Ni&&Rr(Ge,Ci),Ln}function Bs(Ge,Oe,Ze,bt){if(typeof Ze=="object"&&Ze!==null&&Ze.type===x&&Ze.key===null&&(Ze=Ze.props.children),typeof Ze=="object"&&Ze!==null){switch(Ze.$$typeof){case v:e:{for(var Ln=Ze.key;Oe!==null;){if(Oe.key===Ln){if(Ln=Ze.type,Ln===x){if(Oe.tag===7){u(Ge,Oe.sibling),bt=w(Oe,Ze.props.children),bt.return=Ge,Ge=bt;break e}}else if(Oe.elementType===Ln||typeof Ln=="object"&&Ln!==null&&Ln.$$typeof===F&&We(Ln)===Oe.type){u(Ge,Oe.sibling),bt=w(Oe,Ze.props),ln(bt,Ze),bt.return=Ge,Ge=bt;break e}u(Ge,Oe);break}else a(Ge,Oe);Oe=Oe.sibling}Ze.type===x?(bt=Ql(Ze.props.children,Ge.mode,bt,Ze.key),bt.return=Ge,Ge=bt):(bt=El(Ze.type,Ze.key,Ze.props,null,Ge.mode,bt),ln(bt,Ze),bt.return=Ge,Ge=bt)}return q(Ge);case P:e:{for(Ln=Ze.key;Oe!==null;){if(Oe.key===Ln)if(Oe.tag===4&&Oe.stateNode.containerInfo===Ze.containerInfo&&Oe.stateNode.implementation===Ze.implementation){u(Ge,Oe.sibling),bt=w(Oe,Ze.children||[]),bt.return=Ge,Ge=bt;break e}else{u(Ge,Oe);break}else a(Ge,Oe);Oe=Oe.sibling}bt=Fo(Ze,Ge.mode,bt),bt.return=Ge,Ge=bt}return q(Ge);case F:return Ze=We(Ze),Bs(Ge,Oe,Ze,bt)}if(se(Ze))return hn(Ge,Oe,Ze,bt);if(T(Ze)){if(Ln=T(Ze),typeof Ln!="function")throw Error(n(150));return Ze=Ln.call(Ze),$n(Ge,Oe,Ze,bt)}if(typeof Ze.then=="function")return Bs(Ge,Oe,$t(Ze),bt);if(Ze.$$typeof===I)return Bs(Ge,Oe,Uo(Ge,Ze),bt);Ht(Ge,Ze)}return typeof Ze=="string"&&Ze!==""||typeof Ze=="number"||typeof Ze=="bigint"?(Ze=""+Ze,Oe!==null&&Oe.tag===6?(u(Ge,Oe.sibling),bt=w(Oe,Ze),bt.return=Ge,Ge=bt):(u(Ge,Oe),bt=pl(Ze,Ge.mode,bt),bt.return=Ge,Ge=bt),q(Ge)):u(Ge,Oe)}return function(Ge,Oe,Ze,bt){try{on=0;var Ln=Bs(Ge,Oe,Ze,bt);return wt=null,Ln}catch(vn){if(vn===ze||vn===ve)throw vn;var gs=ia(29,vn,null,Ge.mode);return gs.lanes=bt,gs.return=Ge,gs}finally{}}}var ts=ii(!0),Xn=ii(!1),Wt=!1;function Mt(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ws(i,a){i=i.updateQueue,a.updateQueue===i&&(a.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function En(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function qn(i,a,u){var g=i.updateQueue;if(g===null)return null;if(g=g.shared,(Ie&2)!==0){var w=g.pending;return w===null?a.next=a:(a.next=w.next,w.next=a),g.pending=a,a=ls(i),Fi(i,null,u),a}return fl(i,g,a,u),ls(i)}function ri(i,a,u){if(a=a.updateQueue,a!==null&&(a=a.shared,(u&4194048)!==0)){var g=a.lanes;g&=i.pendingLanes,u|=g,a.lanes=u,fa(i,u)}}function Ui(i,a){var u=i.updateQueue,g=i.alternate;if(g!==null&&(g=g.updateQueue,u===g)){var w=null,_=null;if(u=u.firstBaseUpdate,u!==null){do{var q={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};_===null?w=_=q:_=_.next=q,u=u.next}while(u!==null);_===null?w=_=a:_=_.next=a}else w=_=a;u={baseState:g.baseState,firstBaseUpdate:w,lastBaseUpdate:_,shared:g.shared,callbacks:g.callbacks},i.updateQueue=u;return}i=u.lastBaseUpdate,i===null?u.firstBaseUpdate=a:i.next=a,u.lastBaseUpdate=a}var Cs=!1;function Li(){if(Cs){var i=A;if(i!==null)throw i}}function Ms(i,a,u,g){Cs=!1;var w=i.updateQueue;Wt=!1;var _=w.firstBaseUpdate,q=w.lastBaseUpdate,ce=w.shared.pending;if(ce!==null){w.shared.pending=null;var Me=ce,Qe=Me.next;Me.next=null,q===null?_=Qe:q.next=Qe,q=Me;var gt=i.alternate;gt!==null&&(gt=gt.updateQueue,ce=gt.lastBaseUpdate,ce!==q&&(ce===null?gt.firstBaseUpdate=Qe:ce.next=Qe,gt.lastBaseUpdate=Me))}if(_!==null){var St=w.baseState;q=0,gt=Qe=Me=null,ce=_;do{var tt=ce.lane&-536870913,rt=tt!==ce.lane;if(rt?(dt&tt)===tt:(g&tt)===tt){tt!==0&&tt===y&&(Cs=!0),gt!==null&&(gt=gt.next={lane:0,tag:ce.tag,payload:ce.payload,callback:null,next:null});e:{var hn=i,$n=ce;tt=a;var Bs=u;switch($n.tag){case 1:if(hn=$n.payload,typeof hn=="function"){St=hn.call(Bs,St,tt);break e}St=hn;break e;case 3:hn.flags=hn.flags&-65537|128;case 0:if(hn=$n.payload,tt=typeof hn=="function"?hn.call(Bs,St,tt):hn,tt==null)break e;St=b({},St,tt);break e;case 2:Wt=!0}}tt=ce.callback,tt!==null&&(i.flags|=64,rt&&(i.flags|=8192),rt=w.callbacks,rt===null?w.callbacks=[tt]:rt.push(tt))}else rt={lane:tt,tag:ce.tag,payload:ce.payload,callback:ce.callback,next:null},gt===null?(Qe=gt=rt,Me=St):gt=gt.next=rt,q|=tt;if(ce=ce.next,ce===null){if(ce=w.shared.pending,ce===null)break;rt=ce,ce=rt.next,rt.next=null,w.lastBaseUpdate=rt,w.shared.pending=null}}while(!0);gt===null&&(Me=St),w.baseState=Me,w.firstBaseUpdate=Qe,w.lastBaseUpdate=gt,_===null&&(w.shared.lanes=0),Et|=q,i.lanes=q,i.memoizedState=St}}function Kr(i,a){if(typeof i!="function")throw Error(n(191,i));i.call(a)}function Gi(i,a){var u=i.callbacks;if(u!==null)for(i.callbacks=null,i=0;i<u.length;i++)Kr(u[i],a)}var si=J(null),Mi=J(0);function Is(i,a){i=Kn,W(Mi,i),W(si,a),Kn=i|a.baseLanes}function Ii(){W(Mi,Kn),W(si,si.current)}function yr(){Kn=Mi.current,D(si),D(Mi)}var js=J(null),mi=null;function Ts(i){var a=i.alternate;W(zi,zi.current&1),W(js,i),mi===null&&(a===null||si.current!==null||a.memoizedState!==null)&&(mi=i)}function Hi(i){W(zi,zi.current),W(js,i),mi===null&&(mi=i)}function er(i){i.tag===22?(W(zi,zi.current),W(js,i),mi===null&&(mi=i)):dr()}function dr(){W(zi,zi.current),W(js,js.current)}function ns(i){D(js),mi===i&&(mi=null),D(zi)}var zi=J(0);function xr(i){for(var a=i;a!==null;){if(a.tag===13){var u=a.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||L0(u)||M0(u)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var _s=0,wn=null,Sn=null,Ai=null,Zr=!1,so=!1,aa=!1,$s=0,Il=0,Tc=null,zl=0;function ps(){throw Error(n(321))}function Vc(i,a){if(a===null)return!1;for(var u=0;u<a.length&&u<i.length;u++)if(!Pr(i[u],a[u]))return!1;return!0}function eu(i,a,u,g,w,_){return _s=_,wn=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,V.H=i===null||i.memoizedState===null?Cf:hd,aa=!1,_=u(g,w),aa=!1,so&&(_=qo(a,u,g,w)),Rd(i),_}function Rd(i){V.H=Vo;var a=Sn!==null&&Sn.next!==null;if(_s=0,Ai=Sn=wn=null,Zr=!1,Il=0,Tc=null,a)throw Error(n(300));i===null||br||(i=i.dependencies,i!==null&&Gr(i)&&(br=!0))}function qo(i,a,u,g){wn=i;var w=0;do{if(so&&(Tc=null),Il=0,so=!1,25<=w)throw Error(n(301));if(w+=1,Ai=Sn=null,i.updateQueue!=null){var _=i.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}V.H=Tf,_=a(u,g)}while(so);return _}function xh(){var i=V.H,a=i.useState()[0];return a=typeof a.then=="function"?wo(a):a,i=i.useState()[0],(Sn!==null?Sn.memoizedState:null)!==i&&(wn.flags|=1024),a}function _c(){var i=$s!==0;return $s=0,i}function Dd(i,a,u){a.updateQueue=i.updateQueue,a.flags&=-2053,i.lanes&=~u}function Ld(i){if(Zr){for(i=i.memoizedState;i!==null;){var a=i.queue;a!==null&&(a.pending=null),i=i.next}Zr=!1}_s=0,Ai=Sn=wn=null,so=!1,Il=$s=0,Tc=null}function Dr(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ai===null?wn.memoizedState=Ai=i:Ai=Ai.next=i,Ai}function Ps(){if(Sn===null){var i=wn.alternate;i=i!==null?i.memoizedState:null}else i=Sn.next;var a=Ai===null?wn.memoizedState:Ai.next;if(a!==null)Ai=a,Sn=i;else{if(i===null)throw wn.alternate===null?Error(n(467)):Error(n(310));Sn=i,i={memoizedState:Sn.memoizedState,baseState:Sn.baseState,baseQueue:Sn.baseQueue,queue:Sn.queue,next:null},Ai===null?wn.memoizedState=Ai=i:Ai=Ai.next=i}return Ai}function kc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function wo(i){var a=Il;return Il+=1,Tc===null&&(Tc=[]),i=ut(Tc,i,a),a=wn,(Ai===null?a.memoizedState:Ai.next)===null&&(a=a.alternate,V.H=a===null||a.memoizedState===null?Cf:hd),i}function rc(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return wo(i);if(i.$$typeof===I)return fs(i)}throw Error(n(438,String(i)))}function gl(i){var a=null,u=wn.updateQueue;if(u!==null&&(a=u.memoCache),a==null){var g=wn.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(a={data:g.data.map(function(w){return w.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),u===null&&(u=kc(),wn.updateQueue=u),u.memoCache=a,u=a.data[a.index],u===void 0)for(u=a.data[a.index]=Array(i),g=0;g<i;g++)u[g]=Q;return a.index++,u}function Bl(i,a){return typeof a=="function"?a(i):a}function ld(i){var a=Ps();return cd(a,Sn,i)}function cd(i,a,u){var g=i.queue;if(g===null)throw Error(n(311));g.lastRenderedReducer=u;var w=i.baseQueue,_=g.pending;if(_!==null){if(w!==null){var q=w.next;w.next=_.next,_.next=q}a.baseQueue=w=_,g.pending=null}if(_=i.baseState,w===null)i.memoizedState=_;else{a=w.next;var ce=q=null,Me=null,Qe=a,gt=!1;do{var St=Qe.lane&-536870913;if(St!==Qe.lane?(dt&St)===St:(_s&St)===St){var tt=Qe.revertLane;if(tt===0)Me!==null&&(Me=Me.next={lane:0,revertLane:0,gesture:null,action:Qe.action,hasEagerState:Qe.hasEagerState,eagerState:Qe.eagerState,next:null}),St===y&&(gt=!0);else if((_s&tt)===tt){Qe=Qe.next,tt===y&&(gt=!0);continue}else St={lane:0,revertLane:Qe.revertLane,gesture:null,action:Qe.action,hasEagerState:Qe.hasEagerState,eagerState:Qe.eagerState,next:null},Me===null?(ce=Me=St,q=_):Me=Me.next=St,wn.lanes|=tt,Et|=tt;St=Qe.action,aa&&u(_,St),_=Qe.hasEagerState?Qe.eagerState:u(_,St)}else tt={lane:St,revertLane:Qe.revertLane,gesture:Qe.gesture,action:Qe.action,hasEagerState:Qe.hasEagerState,eagerState:Qe.eagerState,next:null},Me===null?(ce=Me=tt,q=_):Me=Me.next=tt,wn.lanes|=St,Et|=St;Qe=Qe.next}while(Qe!==null&&Qe!==a);if(Me===null?q=_:Me.next=ce,!Pr(_,i.memoizedState)&&(br=!0,gt&&(u=A,u!==null)))throw u;i.memoizedState=_,i.baseState=q,i.baseQueue=Me,g.lastRenderedState=_}return w===null&&(g.lanes=0),[i.memoizedState,g.dispatch]}function Wc(i){var a=Ps(),u=a.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=i;var g=u.dispatch,w=u.pending,_=a.memoizedState;if(w!==null){u.pending=null;var q=w=w.next;do _=i(_,q.action),q=q.next;while(q!==w);Pr(_,a.memoizedState)||(br=!0),a.memoizedState=_,a.baseQueue===null&&(a.baseState=_),u.lastRenderedState=_}return[_,g]}function So(i,a,u){var g=wn,w=Ps(),_=Ni;if(_){if(u===void 0)throw Error(n(407));u=u()}else u=a();var q=!Pr((Sn||w).memoizedState,u);if(q&&(w.memoizedState=u,br=!0),w=w.queue,ud(zu.bind(null,g,w,i),[i]),w.getSnapshot!==a||q||Ai!==null&&Ai.memoizedState.tag&1){if(g.flags|=2048,Gc(9,{destroy:void 0},ml.bind(null,g,w,u,a),null),Xe===null)throw Error(n(349));_||(_s&127)!==0||Jr(g,a,u)}return u}function Jr(i,a,u){i.flags|=16384,i={getSnapshot:a,value:u},a=wn.updateQueue,a===null?(a=kc(),wn.updateQueue=a,a.stores=[i]):(u=a.stores,u===null?a.stores=[i]:u.push(i))}function ml(i,a,u,g){a.value=u,a.getSnapshot=g,bh(a)&&Bu(i)}function zu(i,a,u){return u(function(){bh(a)&&Bu(i)})}function bh(i){var a=i.getSnapshot;i=i.value;try{var u=a();return!Pr(i,u)}catch{return!0}}function Bu(i){var a=Oo(i,2);a!==null&&ql(a,i,2)}function Nc(i){var a=Dr();if(typeof i=="function"){var u=i;if(i=u(),aa){An(!0);try{u()}finally{An(!1)}}}return a.memoizedState=a.baseState=i,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bl,lastRenderedState:i},a}function vh(i,a,u,g){return i.baseState=u,cd(i,Sn,typeof g=="function"?g:Bl)}function wh(i,a,u,g,w){if(du(i))throw Error(n(485));if(i=a.action,i!==null){var _={payload:w,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(q){_.listeners.push(q)}};V.T!==null?u(!0):_.isTransition=!1,g(_),u=a.pending,u===null?(_.next=a.pending=_,Ou(a,_)):(_.next=u.next,a.pending=u.next=_)}}function Ou(i,a){var u=a.action,g=a.payload,w=i.state;if(a.isTransition){var _=V.T,q={};V.T=q;try{var ce=u(w,g),Me=V.S;Me!==null&&Me(q,ce),tu(i,a,ce)}catch(Qe){$c(i,a,Qe)}finally{_!==null&&q.types!==null&&(_.types=q.types),V.T=_}}else try{_=u(w,g),tu(i,a,_)}catch(Qe){$c(i,a,Qe)}}function tu(i,a,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(g){ac(i,a,g)},function(g){return $c(i,a,g)}):ac(i,a,u)}function ac(i,a,u){a.status="fulfilled",a.value=u,nu(a),i.state=u,a=i.pending,a!==null&&(u=a.next,u===a?i.pending=null:(u=u.next,a.next=u,Ou(i,u)))}function $c(i,a,u){var g=i.pending;if(i.pending=null,g!==null){g=g.next;do a.status="rejected",a.reason=u,nu(a),a=a.next;while(a!==g)}i.action=null}function nu(i){i=i.listeners;for(var a=0;a<i.length;a++)(0,i[a])()}function Md(i,a){return a}function Ol(i,a){if(Ni){var u=Xe.formState;if(u!==null){e:{var g=wn;if(Ni){if(As){t:{for(var w=As,_=Qs;w.nodeType!==8;){if(!_){w=null;break t}if(w=Dc(w.nextSibling),w===null){w=null;break t}}_=w.data,w=_==="F!"||_==="F"?w:null}if(w){As=Dc(w.nextSibling),g=w.data==="F!";break e}}ic(g)}g=!1}g&&(a=u[0])}}return u=Dr(),u.memoizedState=u.baseState=a,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Md,lastRenderedState:a},u.queue=g,u=qu.bind(null,wn,g),g.dispatch=u,g=Nc(!1),_=Wu.bind(null,wn,!1,g.queue),g=Dr(),w={state:a,dispatch:null,action:i,pending:null},g.queue=w,u=wh.bind(null,wn,w,_,u),w.dispatch=u,g.memoizedState=i,[a,u,!1]}function oc(i){var a=Ps();return lc(a,Sn,i)}function lc(i,a,u){if(a=cd(i,a,Md)[0],i=ld(Bl)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var g=wo(a)}catch(q){throw q===ze?ve:q}else g=a;a=Ps();var w=a.queue,_=w.dispatch;return u!==a.memoizedState&&(wn.flags|=2048,Gc(9,{destroy:void 0},iu.bind(null,w,u),null)),[g,_,i]}function iu(i,a){i.action=a}function su(i){var a=Ps(),u=Sn;if(u!==null)return lc(a,u,i);Ps(),a=a.memoizedState,u=Ps();var g=u.queue.dispatch;return u.memoizedState=i,[a,g,!1]}function Gc(i,a,u,g){return i={tag:i,create:u,deps:g,inst:a,next:null},a=wn.updateQueue,a===null&&(a=kc(),wn.updateQueue=a),u=a.lastEffect,u===null?a.lastEffect=i.next=i:(g=u.next,u.next=i,i.next=g,a.lastEffect=i),i}function Sh(){return Ps().memoizedState}function dd(i,a,u,g){var w=Dr();wn.flags|=i,w.memoizedState=Gc(1|a,{destroy:void 0},u,g===void 0?null:g)}function Fl(i,a,u,g){var w=Ps();g=g===void 0?null:g;var _=w.memoizedState.inst;Sn!==null&&g!==null&&Vc(g,Sn.memoizedState.deps)?w.memoizedState=Gc(a,_,u,g):(wn.flags|=i,w.memoizedState=Gc(1|a,_,u,g))}function Id(i,a){dd(8390656,8,i,a)}function ud(i,a){Fl(2048,8,i,a)}function Ah(i){wn.flags|=4;var a=wn.updateQueue;if(a===null)a=kc(),wn.updateQueue=a,a.events=[i];else{var u=a.events;u===null?a.events=[i]:u.push(i)}}function ru(i){var a=Ps().memoizedState;return Ah({ref:a,nextImpl:i}),function(){if((Ie&2)!==0)throw Error(n(440));return a.impl.apply(void 0,arguments)}}function Ch(i,a){return Fl(4,2,i,a)}function au(i,a){return Fl(4,4,i,a)}function ou(i,a){if(typeof a=="function"){i=i();var u=a(i);return function(){typeof u=="function"?u():a(null)}}if(a!=null)return i=i(),a.current=i,function(){a.current=null}}function lu(i,a,u){u=u!=null?u.concat([i]):null,Fl(4,4,ou.bind(null,a,i),u)}function cu(){}function Fu(i,a){var u=Ps();a=a===void 0?null:a;var g=u.memoizedState;return a!==null&&Vc(a,g[1])?g[0]:(u.memoizedState=[i,a],i)}function Ep(i,a){var u=Ps();a=a===void 0?null:a;var g=u.memoizedState;if(a!==null&&Vc(a,g[1]))return g[0];if(g=i(),aa){An(!0);try{i()}finally{An(!1)}}return u.memoizedState=[g,a],g}function Uu(i,a,u){return u===void 0||(_s&1073741824)!==0&&(dt&261930)===0?i.memoizedState=a:(i.memoizedState=u,i=zy(),wn.lanes|=i,Et|=i,u)}function cc(i,a,u,g){return Pr(u,a)?u:si.current!==null?(i=Uu(i,u,g),Pr(i,a)||(br=!0),i):(_s&42)===0||(_s&1073741824)!==0&&(dt&261930)===0?(br=!0,i.memoizedState=u):(i=zy(),wn.lanes|=i,Et|=i,a)}function Th(i,a,u,g,w){var _=ee.p;ee.p=_!==0&&8>_?_:8;var q=V.T,ce={};V.T=ce,Wu(i,!1,a,u);try{var Me=w(),Qe=V.S;if(Qe!==null&&Qe(ce,Me),Me!==null&&typeof Me=="object"&&typeof Me.then=="function"){var gt=ie(Me,g);Vu(i,a,gt,fc(i))}else Vu(i,a,g,fc(i))}catch(St){Vu(i,a,{then:function(){},status:"rejected",reason:St},fc())}finally{ee.p=_,q!==null&&ce.types!==null&&(q.types=ce.types),V.T=q}}function f0(){}function Sf(i,a,u,g){if(i.tag!==5)throw Error(n(476));var w=Yc(i).queue;Th(i,w,a,ae,u===null?f0:function(){return Rp(i),u(g)})}function Yc(i){var a=i.memoizedState;if(a!==null)return a;a={memoizedState:ae,baseState:ae,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bl,lastRenderedState:ae},next:null};var u={};return a.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bl,lastRenderedState:u},next:null},i.memoizedState=a,i=i.alternate,i!==null&&(i.memoizedState=a),a}function Rp(i){var a=Yc(i);a.next===null&&(a=i.alternate.memoizedState),Vu(i,a.next.queue,{},fc())}function Hu(){return fs(Gf)}function Af(){return Ps().memoizedState}function _h(){return Ps().memoizedState}function kh(i){for(var a=i.return;a!==null;){switch(a.tag){case 24:case 3:var u=fc();i=En(u);var g=qn(a,i,u);g!==null&&(ql(g,a,u),ri(g,a,u)),a={cache:ra()},i.payload=a;return}a=a.return}}function Nh(i,a,u){var g=fc();u={lane:g,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},du(i)?Dp(a,u):(u=Pd(i,a,u,g),u!==null&&(ql(u,i,g),Lp(u,a,g)))}function qu(i,a,u){var g=fc();Vu(i,a,u,g)}function Vu(i,a,u,g){var w={lane:g,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(du(i))Dp(a,w);else{var _=i.alternate;if(i.lanes===0&&(_===null||_.lanes===0)&&(_=a.lastRenderedReducer,_!==null))try{var q=a.lastRenderedState,ce=_(q,u);if(w.hasEagerState=!0,w.eagerState=ce,Pr(ce,q))return fl(i,a,w,0),Xe===null&&jd(),!1}catch{}finally{}if(u=Pd(i,a,w,g),u!==null)return ql(u,i,g),Lp(u,a,g),!0}return!1}function Wu(i,a,u,g){if(g={lane:2,revertLane:S0(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},du(i)){if(a)throw Error(n(479))}else a=Pd(i,u,g,2),a!==null&&ql(a,i,2)}function du(i){var a=i.alternate;return i===wn||a!==null&&a===wn}function Dp(i,a){so=Zr=!0;var u=i.pending;u===null?a.next=a:(a.next=u.next,u.next=a),i.pending=a}function Lp(i,a,u){if((u&4194048)!==0){var g=a.lanes;g&=i.pendingLanes,u|=g,a.lanes=u,fa(i,u)}}var Vo={readContext:fs,use:rc,useCallback:ps,useContext:ps,useEffect:ps,useImperativeHandle:ps,useLayoutEffect:ps,useInsertionEffect:ps,useMemo:ps,useReducer:ps,useRef:ps,useState:ps,useDebugValue:ps,useDeferredValue:ps,useTransition:ps,useSyncExternalStore:ps,useId:ps,useHostTransitionStatus:ps,useFormState:ps,useActionState:ps,useOptimistic:ps,useMemoCache:ps,useCacheRefresh:ps};Vo.useEffectEvent=ps;var Cf={readContext:fs,use:rc,useCallback:function(i,a){return Dr().memoizedState=[i,a===void 0?null:a],i},useContext:fs,useEffect:Id,useImperativeHandle:function(i,a,u){u=u!=null?u.concat([i]):null,dd(4194308,4,ou.bind(null,a,i),u)},useLayoutEffect:function(i,a){return dd(4194308,4,i,a)},useInsertionEffect:function(i,a){dd(4,2,i,a)},useMemo:function(i,a){var u=Dr();a=a===void 0?null:a;var g=i();if(aa){An(!0);try{i()}finally{An(!1)}}return u.memoizedState=[g,a],g},useReducer:function(i,a,u){var g=Dr();if(u!==void 0){var w=u(a);if(aa){An(!0);try{u(a)}finally{An(!1)}}}else w=a;return g.memoizedState=g.baseState=w,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:w},g.queue=i,i=i.dispatch=Nh.bind(null,wn,i),[g.memoizedState,i]},useRef:function(i){var a=Dr();return i={current:i},a.memoizedState=i},useState:function(i){i=Nc(i);var a=i.queue,u=qu.bind(null,wn,a);return a.dispatch=u,[i.memoizedState,u]},useDebugValue:cu,useDeferredValue:function(i,a){var u=Dr();return Uu(u,i,a)},useTransition:function(){var i=Nc(!1);return i=Th.bind(null,wn,i.queue,!0,!1),Dr().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,a,u){var g=wn,w=Dr();if(Ni){if(u===void 0)throw Error(n(407));u=u()}else{if(u=a(),Xe===null)throw Error(n(349));(dt&127)!==0||Jr(g,a,u)}w.memoizedState=u;var _={value:u,getSnapshot:a};return w.queue=_,Id(zu.bind(null,g,_,i),[i]),g.flags|=2048,Gc(9,{destroy:void 0},ml.bind(null,g,_,u,a),null),u},useId:function(){var i=Dr(),a=Xe.identifierPrefix;if(Ni){var u=xo,g=Oa;u=(g&~(1<<32-lt(g)-1)).toString(32)+u,a="_"+a+"R_"+u,u=$s++,0<u&&(a+="H"+u.toString(32)),a+="_"}else u=zl++,a="_"+a+"r_"+u.toString(32)+"_";return i.memoizedState=a},useHostTransitionStatus:Hu,useFormState:Ol,useActionState:Ol,useOptimistic:function(i){var a=Dr();a.memoizedState=a.baseState=i;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=u,a=Wu.bind(null,wn,!0,u),u.dispatch=a,[i,a]},useMemoCache:gl,useCacheRefresh:function(){return Dr().memoizedState=kh.bind(null,wn)},useEffectEvent:function(i){var a=Dr(),u={impl:i};return a.memoizedState=u,function(){if((Ie&2)!==0)throw Error(n(440));return u.impl.apply(void 0,arguments)}}},hd={readContext:fs,use:rc,useCallback:Fu,useContext:fs,useEffect:ud,useImperativeHandle:lu,useInsertionEffect:Ch,useLayoutEffect:au,useMemo:Ep,useReducer:ld,useRef:Sh,useState:function(){return ld(Bl)},useDebugValue:cu,useDeferredValue:function(i,a){var u=Ps();return cc(u,Sn.memoizedState,i,a)},useTransition:function(){var i=ld(Bl)[0],a=Ps().memoizedState;return[typeof i=="boolean"?i:wo(i),a]},useSyncExternalStore:So,useId:Af,useHostTransitionStatus:Hu,useFormState:oc,useActionState:oc,useOptimistic:function(i,a){var u=Ps();return vh(u,Sn,i,a)},useMemoCache:gl,useCacheRefresh:_h};hd.useEffectEvent=ru;var Tf={readContext:fs,use:rc,useCallback:Fu,useContext:fs,useEffect:ud,useImperativeHandle:lu,useInsertionEffect:Ch,useLayoutEffect:au,useMemo:Ep,useReducer:Wc,useRef:Sh,useState:function(){return Wc(Bl)},useDebugValue:cu,useDeferredValue:function(i,a){var u=Ps();return Sn===null?Uu(u,i,a):cc(u,Sn.memoizedState,i,a)},useTransition:function(){var i=Wc(Bl)[0],a=Ps().memoizedState;return[typeof i=="boolean"?i:wo(i),a]},useSyncExternalStore:So,useId:Af,useHostTransitionStatus:Hu,useFormState:su,useActionState:su,useOptimistic:function(i,a){var u=Ps();return Sn!==null?vh(u,Sn,i,a):(u.baseState=i,[i,u.queue.dispatch])},useMemoCache:gl,useCacheRefresh:_h};Tf.useEffectEvent=ru;function jc(i,a,u,g){a=i.memoizedState,u=u(g,a),u=u==null?a:b({},a,u),i.memoizedState=u,i.lanes===0&&(i.updateQueue.baseState=u)}var $u={enqueueSetState:function(i,a,u){i=i._reactInternals;var g=fc(),w=En(g);w.payload=a,u!=null&&(w.callback=u),a=qn(i,w,g),a!==null&&(ql(a,i,g),ri(a,i,g))},enqueueReplaceState:function(i,a,u){i=i._reactInternals;var g=fc(),w=En(g);w.tag=1,w.payload=a,u!=null&&(w.callback=u),a=qn(i,w,g),a!==null&&(ql(a,i,g),ri(a,i,g))},enqueueForceUpdate:function(i,a){i=i._reactInternals;var u=fc(),g=En(u);g.tag=2,a!=null&&(g.callback=a),a=qn(i,g,u),a!==null&&(ql(a,i,u),ri(a,i,u))}};function _f(i,a,u,g,w,_,q){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(g,_,q):a.prototype&&a.prototype.isPureReactComponent?!Zl(u,g)||!Zl(w,_):!0}function kf(i,a,u,g){i=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(u,g),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(u,g),a.state!==i&&$u.enqueueReplaceState(a,a.state,null)}function zd(i,a){var u=a;if("ref"in a){u={};for(var g in a)g!=="ref"&&(u[g]=a[g])}if(i=i.defaultProps){u===a&&(u=b({},u));for(var w in i)u[w]===void 0&&(u[w]=i[w])}return u}function Mp(i){ki(i)}function Ip(i){console.error(i)}function Gu(i){ki(i)}function Yu(i,a){try{var u=i.onUncaughtError;u(a.value,{componentStack:a.stack})}catch(g){setTimeout(function(){throw g})}}function zp(i,a,u){try{var g=i.onCaughtError;g(u.value,{componentStack:u.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(w){setTimeout(function(){throw w})}}function jh(i,a,u){return u=En(u),u.tag=3,u.payload={element:null},u.callback=function(){Yu(i,a)},u}function uu(i){return i=En(i),i.tag=3,i}function Bp(i,a,u,g){var w=u.type.getDerivedStateFromError;if(typeof w=="function"){var _=g.value;i.payload=function(){return w(_)},i.callback=function(){zp(a,u,g)}}var q=u.stateNode;q!==null&&typeof q.componentDidCatch=="function"&&(i.callback=function(){zp(a,u,g),typeof w!="function"&&(xu===null?xu=new Set([this]):xu.add(this));var ce=g.stack;this.componentDidCatch(g.value,{componentStack:ce!==null?ce:""})})}function Nf(i,a,u,g,w){if(u.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(a=u.alternate,a!==null&&$r(a,u,w,!0),u=js.current,u!==null){switch(u.tag){case 31:case 13:return mi===null?Zp():u.alternate===null&&Vt===0&&(Vt=3),u.flags&=-257,u.flags|=65536,u.lanes=w,g===Be?u.flags|=16384:(a=u.updateQueue,a===null?u.updateQueue=new Set([g]):a.add(g),b0(i,g,w)),!1;case 22:return u.flags|=65536,g===Be?u.flags|=16384:(a=u.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([g])},u.updateQueue=a):(u=a.retryQueue,u===null?a.retryQueue=new Set([g]):u.add(g)),b0(i,g,w)),!1}throw Error(n(435,u.tag))}return b0(i,g,w),Zp(),!1}if(Ni)return a=js.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=w,g!==bo&&(i=Error(n(422),{cause:g}),mr(Ba(i,u)))):(g!==bo&&(a=Error(n(423),{cause:g}),mr(Ba(a,u))),i=i.current.alternate,i.flags|=65536,w&=-w,i.lanes|=w,g=Ba(g,u),w=jh(i.stateNode,g,w),Ui(i,w),Vt!==4&&(Vt=2)),!1;var _=Error(n(520),{cause:g});if(_=Ba(_,u),tr===null?tr=[_]:tr.push(_),Vt!==4&&(Vt=2),a===null)return!0;g=Ba(g,u),u=a;do{switch(u.tag){case 3:return u.flags|=65536,i=w&-w,u.lanes|=i,i=jh(u.stateNode,g,i),Ui(u,i),!1;case 1:if(a=u.type,_=u.stateNode,(u.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(xu===null||!xu.has(_))))return u.flags|=65536,w&=-w,u.lanes|=w,w=uu(w),Bp(w,i,u,g),Ui(u,w),!1}u=u.return}while(u!==null);return!1}var Ph=Error(n(461)),br=!1;function oa(i,a,u,g){a.child=i===null?Xn(a,null,u,g):ts(a,i.child,u,g)}function Op(i,a,u,g,w){u=u.render;var _=a.ref;if("ref"in g){var q={};for(var ce in g)ce!=="ref"&&(q[ce]=g[ce])}else q=g;return Yr(a),g=eu(i,a,u,q,_,w),ce=_c(),i!==null&&!br?(Dd(i,a,w),Ec(i,a,w)):(Ni&&ce&&od(a),a.flags|=1,oa(i,a,g,w),a.child)}function Fp(i,a,u,g,w){if(i===null){var _=u.type;return typeof _=="function"&&!rd(_)&&_.defaultProps===void 0&&u.compare===null?(a.tag=15,a.type=_,jf(i,a,_,g,w)):(i=El(u.type,null,g,a,a.mode,w),i.ref=a.ref,i.return=a,a.child=i)}if(_=i.child,!Lh(i,w)){var q=_.memoizedProps;if(u=u.compare,u=u!==null?u:Zl,u(q,g)&&i.ref===a.ref)return Ec(i,a,w)}return a.flags|=1,i=za(_,g),i.ref=a.ref,i.return=a,a.child=i}function jf(i,a,u,g,w){if(i!==null){var _=i.memoizedProps;if(Zl(_,g)&&i.ref===a.ref)if(br=!1,a.pendingProps=g=_,Lh(i,w))(i.flags&131072)!==0&&(br=!0);else return a.lanes=i.lanes,Ec(i,a,w)}return Ku(i,a,u,g,w)}function hu(i,a,u,g){var w=g.children,_=i!==null?i.memoizedState:null;if(i===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((a.flags&128)!==0){if(_=_!==null?_.baseLanes|u:u,i!==null){for(g=a.child=i.child,w=0;g!==null;)w=w|g.lanes|g.childLanes,g=g.sibling;g=w&~_}else g=0,a.child=null;return fd(i,a,_,u,g)}if((u&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},i!==null&&me(a,_!==null?_.cachePool:null),_!==null?Is(a,_):Ii(),er(a);else return g=a.lanes=536870912,fd(i,a,_!==null?_.baseLanes|u:u,u,g)}else _!==null?(me(a,_.cachePool),Is(a,_),dr(),a.memoizedState=null):(i!==null&&me(a,null),Ii(),dr());return oa(i,a,w,u),a.child}function Bd(i,a){return i!==null&&i.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function fd(i,a,u,g,w){var _=de();return _=_===null?null:{parent:Di._currentValue,pool:_},a.memoizedState={baseLanes:u,cachePool:_},i!==null&&me(a,null),Ii(),er(a),i!==null&&$r(i,a,g,!0),a.childLanes=w,null}function Od(i,a){return a=Fd({mode:a.mode,children:a.children},i.mode),a.ref=i.ref,i.child=a,a.return=i,a}function Pc(i,a,u){return ts(a,i.child,null,u),i=Od(a,a.pendingProps),i.flags|=2,ns(a),a.memoizedState=null,i}function Xu(i,a,u){var g=a.pendingProps,w=(a.flags&128)!==0;if(a.flags&=-129,i===null){if(Ni){if(g.mode==="hidden")return i=Od(a,g),a.lanes=536870912,Bd(null,i);if(Hi(a),(i=As)?(i=b1(i,Qs),i=i!==null&&i.data==="&"?i:null,i!==null&&(a.memoizedState={dehydrated:i,treeContext:Js!==null?{id:Oa,overflow:xo}:null,retryLane:536870912,hydrationErrors:null},u=Ac(i),u.return=a,a.child=u,sa=a,As=null)):i=null,i===null)throw ic(a);return a.lanes=536870912,null}return Od(a,g)}var _=i.memoizedState;if(_!==null){var q=_.dehydrated;if(Hi(a),w)if(a.flags&256)a.flags&=-257,a=Pc(i,a,u);else if(a.memoizedState!==null)a.child=i.child,a.flags|=128,a=null;else throw Error(n(558));else if(br||$r(i,a,u,!1),w=(u&i.childLanes)!==0,br||w){if(g=Xe,g!==null&&(q=Ct(g,u),q!==0&&q!==_.retryLane))throw _.retryLane=q,Oo(i,q),ql(g,i,q),Ph;Zp(),a=Pc(i,a,u)}else i=_.treeContext,As=Dc(q.nextSibling),sa=a,Ni=!0,Fa=null,Qs=!1,i!==null&&Dl(a,i),a=Od(a,g),a.flags|=4096;return a}return i=za(i.child,{mode:g.mode,children:g.children}),i.ref=a.ref,a.child=i,i.return=a,i}function fu(i,a){var u=a.ref;if(u===null)i!==null&&i.ref!==null&&(a.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(n(284));(i===null||i.ref!==u)&&(a.flags|=4194816)}}function Ku(i,a,u,g,w){return Yr(a),u=eu(i,a,u,g,void 0,w),g=_c(),i!==null&&!br?(Dd(i,a,w),Ec(i,a,w)):(Ni&&g&&od(a),a.flags|=1,oa(i,a,u,w),a.child)}function Eh(i,a,u,g,w,_){return Yr(a),a.updateQueue=null,u=qo(a,g,u,w),Rd(i),g=_c(),i!==null&&!br?(Dd(i,a,_),Ec(i,a,_)):(Ni&&g&&od(a),a.flags|=1,oa(i,a,u,_),a.child)}function ro(i,a,u,g,w){if(Yr(a),a.stateNode===null){var _=Er,q=u.contextType;typeof q=="object"&&q!==null&&(_=fs(q)),_=new u(g,_),a.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=$u,a.stateNode=_,_._reactInternals=a,_=a.stateNode,_.props=g,_.state=a.memoizedState,_.refs={},Mt(a),q=u.contextType,_.context=typeof q=="object"&&q!==null?fs(q):Er,_.state=a.memoizedState,q=u.getDerivedStateFromProps,typeof q=="function"&&(jc(a,u,q,g),_.state=a.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(q=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),q!==_.state&&$u.enqueueReplaceState(_,_.state,null),Ms(a,g,_,w),Li(),_.state=a.memoizedState),typeof _.componentDidMount=="function"&&(a.flags|=4194308),g=!0}else if(i===null){_=a.stateNode;var ce=a.memoizedProps,Me=zd(u,ce);_.props=Me;var Qe=_.context,gt=u.contextType;q=Er,typeof gt=="object"&&gt!==null&&(q=fs(gt));var St=u.getDerivedStateFromProps;gt=typeof St=="function"||typeof _.getSnapshotBeforeUpdate=="function",ce=a.pendingProps!==ce,gt||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(ce||Qe!==q)&&kf(a,_,g,q),Wt=!1;var tt=a.memoizedState;_.state=tt,Ms(a,g,_,w),Li(),Qe=a.memoizedState,ce||tt!==Qe||Wt?(typeof St=="function"&&(jc(a,u,St,g),Qe=a.memoizedState),(Me=Wt||_f(a,u,Me,g,tt,Qe,q))?(gt||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(a.flags|=4194308)):(typeof _.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=g,a.memoizedState=Qe),_.props=g,_.state=Qe,_.context=q,g=Me):(typeof _.componentDidMount=="function"&&(a.flags|=4194308),g=!1)}else{_=a.stateNode,Ws(i,a),q=a.memoizedProps,gt=zd(u,q),_.props=gt,St=a.pendingProps,tt=_.context,Qe=u.contextType,Me=Er,typeof Qe=="object"&&Qe!==null&&(Me=fs(Qe)),ce=u.getDerivedStateFromProps,(Qe=typeof ce=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(q!==St||tt!==Me)&&kf(a,_,g,Me),Wt=!1,tt=a.memoizedState,_.state=tt,Ms(a,g,_,w),Li();var rt=a.memoizedState;q!==St||tt!==rt||Wt||i!==null&&i.dependencies!==null&&Gr(i.dependencies)?(typeof ce=="function"&&(jc(a,u,ce,g),rt=a.memoizedState),(gt=Wt||_f(a,u,gt,g,tt,rt,Me)||i!==null&&i.dependencies!==null&&Gr(i.dependencies))?(Qe||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(g,rt,Me),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(g,rt,Me)),typeof _.componentDidUpdate=="function"&&(a.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof _.componentDidUpdate!="function"||q===i.memoizedProps&&tt===i.memoizedState||(a.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||q===i.memoizedProps&&tt===i.memoizedState||(a.flags|=1024),a.memoizedProps=g,a.memoizedState=rt),_.props=g,_.state=rt,_.context=Me,g=gt):(typeof _.componentDidUpdate!="function"||q===i.memoizedProps&&tt===i.memoizedState||(a.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||q===i.memoizedProps&&tt===i.memoizedState||(a.flags|=1024),g=!1)}return _=g,fu(i,a),g=(a.flags&128)!==0,_||g?(_=a.stateNode,u=g&&typeof u.getDerivedStateFromError!="function"?null:_.render(),a.flags|=1,i!==null&&g?(a.child=ts(a,i.child,null,w),a.child=ts(a,null,u,w)):oa(i,a,u,w),a.memoizedState=_.state,i=a.child):i=Ec(i,a,w),i}function Pf(i,a,u,g){return or(),a.flags|=256,oa(i,a,u,g),a.child}var Ef={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Rh(i){return{baseLanes:i,cachePool:_e()}}function Rf(i,a,u){return i=i!==null?i.childLanes&~u:0,a&&(i|=Bi),i}function Df(i,a,u){var g=a.pendingProps,w=!1,_=(a.flags&128)!==0,q;if((q=_)||(q=i!==null&&i.memoizedState===null?!1:(zi.current&2)!==0),q&&(w=!0,a.flags&=-129),q=(a.flags&32)!==0,a.flags&=-33,i===null){if(Ni){if(w?Ts(a):dr(),(i=As)?(i=b1(i,Qs),i=i!==null&&i.data!=="&"?i:null,i!==null&&(a.memoizedState={dehydrated:i,treeContext:Js!==null?{id:Oa,overflow:xo}:null,retryLane:536870912,hydrationErrors:null},u=Ac(i),u.return=a,a.child=u,sa=a,As=null)):i=null,i===null)throw ic(a);return M0(i)?a.lanes=32:a.lanes=536870912,null}var ce=g.children;return g=g.fallback,w?(dr(),w=a.mode,ce=Fd({mode:"hidden",children:ce},w),g=Ql(g,w,u,null),ce.return=a,g.return=a,ce.sibling=g,a.child=ce,g=a.child,g.memoizedState=Rh(u),g.childLanes=Rf(i,q,u),a.memoizedState=Ef,Bd(null,g)):(Ts(a),Dh(a,ce))}var Me=i.memoizedState;if(Me!==null&&(ce=Me.dehydrated,ce!==null)){if(_)a.flags&256?(Ts(a),a.flags&=-257,a=dc(i,a,u)):a.memoizedState!==null?(dr(),a.child=i.child,a.flags|=128,a=null):(dr(),ce=g.fallback,w=a.mode,g=Fd({mode:"visible",children:g.children},w),ce=Ql(ce,w,u,null),ce.flags|=2,g.return=a,ce.return=a,g.sibling=ce,a.child=g,ts(a,i.child,null,u),g=a.child,g.memoizedState=Rh(u),g.childLanes=Rf(i,q,u),a.memoizedState=Ef,a=Bd(null,g));else if(Ts(a),M0(ce)){if(q=ce.nextSibling&&ce.nextSibling.dataset,q)var Qe=q.dgst;q=Qe,g=Error(n(419)),g.stack="",g.digest=q,mr({value:g,source:null,stack:null}),a=dc(i,a,u)}else if(br||$r(i,a,u,!1),q=(u&i.childLanes)!==0,br||q){if(q=Xe,q!==null&&(g=Ct(q,u),g!==0&&g!==Me.retryLane))throw Me.retryLane=g,Oo(i,g),ql(q,i,g),Ph;L0(ce)||Zp(),a=dc(i,a,u)}else L0(ce)?(a.flags|=192,a.child=i.child,a=null):(i=Me.treeContext,As=Dc(ce.nextSibling),sa=a,Ni=!0,Fa=null,Qs=!1,i!==null&&Dl(a,i),a=Dh(a,g.children),a.flags|=4096);return a}return w?(dr(),ce=g.fallback,w=a.mode,Me=i.child,Qe=Me.sibling,g=za(Me,{mode:"hidden",children:g.children}),g.subtreeFlags=Me.subtreeFlags&65011712,Qe!==null?ce=za(Qe,ce):(ce=Ql(ce,w,u,null),ce.flags|=2),ce.return=a,g.return=a,g.sibling=ce,a.child=g,Bd(null,g),g=a.child,ce=i.child.memoizedState,ce===null?ce=Rh(u):(w=ce.cachePool,w!==null?(Me=Di._currentValue,w=w.parent!==Me?{parent:Me,pool:Me}:w):w=_e(),ce={baseLanes:ce.baseLanes|u,cachePool:w}),g.memoizedState=ce,g.childLanes=Rf(i,q,u),a.memoizedState=Ef,Bd(i.child,g)):(Ts(a),u=i.child,i=u.sibling,u=za(u,{mode:"visible",children:g.children}),u.return=a,u.sibling=null,i!==null&&(q=a.deletions,q===null?(a.deletions=[i],a.flags|=16):q.push(i)),a.child=u,a.memoizedState=null,u)}function Dh(i,a){return a=Fd({mode:"visible",children:a},i.mode),a.return=i,i.child=a}function Fd(i,a){return i=ia(22,i,null,a),i.lanes=0,i}function dc(i,a,u){return ts(a,i.child,null,u),i=Dh(a,a.pendingProps.children),i.flags|=2,a.memoizedState=null,i}function Lf(i,a,u){i.lanes|=a;var g=i.alternate;g!==null&&(g.lanes|=a),Ta(i.return,a,u)}function Ul(i,a,u,g,w,_){var q=i.memoizedState;q===null?i.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:g,tail:u,tailMode:w,treeForkCount:_}:(q.isBackwards=a,q.rendering=null,q.renderingStartTime=0,q.last=g,q.tail=u,q.tailMode=w,q.treeForkCount=_)}function uc(i,a,u){var g=a.pendingProps,w=g.revealOrder,_=g.tail;g=g.children;var q=zi.current,ce=(q&2)!==0;if(ce?(q=q&1|2,a.flags|=128):q&=1,W(zi,q),oa(i,a,g,u),g=Ni?ad:0,!ce&&i!==null&&(i.flags&128)!==0)e:for(i=a.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Lf(i,u,a);else if(i.tag===19)Lf(i,u,a);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break e;for(;i.sibling===null;){if(i.return===null||i.return===a)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(w){case"forwards":for(u=a.child,w=null;u!==null;)i=u.alternate,i!==null&&xr(i)===null&&(w=u),u=u.sibling;u=w,u===null?(w=a.child,a.child=null):(w=u.sibling,u.sibling=null),Ul(a,!1,w,u,_,g);break;case"backwards":case"unstable_legacy-backwards":for(u=null,w=a.child,a.child=null;w!==null;){if(i=w.alternate,i!==null&&xr(i)===null){a.child=w;break}i=w.sibling,w.sibling=u,u=w,w=i}Ul(a,!0,u,null,_,g);break;case"together":Ul(a,!1,null,null,void 0,g);break;default:a.memoizedState=null}return a.child}function Ec(i,a,u){if(i!==null&&(a.dependencies=i.dependencies),Et|=a.lanes,(u&a.childLanes)===0)if(i!==null){if($r(i,a,u,!1),(u&a.childLanes)===0)return null}else return null;if(i!==null&&a.child!==i.child)throw Error(n(153));if(a.child!==null){for(i=a.child,u=za(i,i.pendingProps),a.child=u,u.return=a;i.sibling!==null;)i=i.sibling,u=u.sibling=za(i,i.pendingProps),u.return=a;u.sibling=null}return a.child}function Lh(i,a){return(i.lanes&a)!==0?!0:(i=i.dependencies,!!(i!==null&&Gr(i)))}function Wo(i,a,u){switch(a.tag){case 3:Ve(a,a.stateNode.containerInfo),Wr(a,Di,i.memoizedState.cache),or();break;case 27:case 5:et(a);break;case 4:Ve(a,a.stateNode.containerInfo);break;case 10:Wr(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Hi(a),null;break;case 13:var g=a.memoizedState;if(g!==null)return g.dehydrated!==null?(Ts(a),a.flags|=128,null):(u&a.child.childLanes)!==0?Df(i,a,u):(Ts(a),i=Ec(i,a,u),i!==null?i.sibling:null);Ts(a);break;case 19:var w=(i.flags&128)!==0;if(g=(u&a.childLanes)!==0,g||($r(i,a,u,!1),g=(u&a.childLanes)!==0),w){if(g)return uc(i,a,u);a.flags|=128}if(w=a.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),W(zi,zi.current),g)break;return null;case 22:return a.lanes=0,hu(i,a,u,a.pendingProps);case 24:Wr(a,Di,i.memoizedState.cache)}return Ec(i,a,u)}function Ud(i,a,u){if(i!==null)if(i.memoizedProps!==a.pendingProps)br=!0;else{if(!Lh(i,u)&&(a.flags&128)===0)return br=!1,Wo(i,a,u);br=(i.flags&131072)!==0}else br=!1,Ni&&(a.flags&1048576)!==0&&Cc(a,ad,a.index);switch(a.lanes=0,a.tag){case 16:e:{var g=a.pendingProps;if(i=We(a.elementType),a.type=i,typeof i=="function")rd(i)?(g=zd(i,g),a.tag=1,a=ro(null,a,i,g,u)):(a.tag=0,a=Ku(null,a,i,g,u));else{if(i!=null){var w=i.$$typeof;if(w===z){a.tag=11,a=Op(null,a,i,g,u);break e}else if(w===te){a.tag=14,a=Fp(null,a,i,g,u);break e}}throw a=Z(i)||i,Error(n(306,a,""))}}return a;case 0:return Ku(i,a,a.type,a.pendingProps,u);case 1:return g=a.type,w=zd(g,a.pendingProps),ro(i,a,g,w,u);case 3:e:{if(Ve(a,a.stateNode.containerInfo),i===null)throw Error(n(387));g=a.pendingProps;var _=a.memoizedState;w=_.element,Ws(i,a),Ms(a,g,null,u);var q=a.memoizedState;if(g=q.cache,Wr(a,Di,g),g!==_.cache&&cr(a,[Di],u,!0),Li(),g=q.element,_.isDehydrated)if(_={element:g,isDehydrated:!1,cache:q.cache},a.updateQueue.baseState=_,a.memoizedState=_,a.flags&256){a=Pf(i,a,g,u);break e}else if(g!==w){w=Ba(Error(n(424)),a),mr(w),a=Pf(i,a,g,u);break e}else{switch(i=a.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(As=Dc(i.firstChild),sa=a,Ni=!0,Fa=null,Qs=!0,u=Xn(a,null,g,u),a.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(or(),g===w){a=Ec(i,a,u);break e}oa(i,a,g,u)}a=a.child}return a;case 26:return fu(i,a),i===null?(u=T1(a.type,null,a.pendingProps,null))?a.memoizedState=u:Ni||(u=a.type,i=a.pendingProps,g=sg(Te.current).createElement(u),g[Ti]=a,g[Si]=i,Co(g,u,i),Rn(g),a.stateNode=g):a.memoizedState=T1(a.type,i.memoizedProps,a.pendingProps,i.memoizedState),null;case 27:return et(a),i===null&&Ni&&(g=a.stateNode=S1(a.type,a.pendingProps,Te.current),sa=a,Qs=!0,w=As,Su(a.type)?(I0=w,As=Dc(g.firstChild)):As=w),oa(i,a,a.pendingProps.children,u),fu(i,a),i===null&&(a.flags|=4194304),a.child;case 5:return i===null&&Ni&&((w=g=As)&&(g=nw(g,a.type,a.pendingProps,Qs),g!==null?(a.stateNode=g,sa=a,As=Dc(g.firstChild),Qs=!1,w=!0):w=!1),w||ic(a)),et(a),w=a.type,_=a.pendingProps,q=i!==null?i.memoizedProps:null,g=_.children,E0(w,_)?g=null:q!==null&&E0(w,q)&&(a.flags|=32),a.memoizedState!==null&&(w=eu(i,a,xh,null,null,u),Gf._currentValue=w),fu(i,a),oa(i,a,g,u),a.child;case 6:return i===null&&Ni&&((i=u=As)&&(u=iw(u,a.pendingProps,Qs),u!==null?(a.stateNode=u,sa=a,As=null,i=!0):i=!1),i||ic(a)),null;case 13:return Df(i,a,u);case 4:return Ve(a,a.stateNode.containerInfo),g=a.pendingProps,i===null?a.child=ts(a,null,g,u):oa(i,a,g,u),a.child;case 11:return Op(i,a,a.type,a.pendingProps,u);case 7:return oa(i,a,a.pendingProps,u),a.child;case 8:return oa(i,a,a.pendingProps.children,u),a.child;case 12:return oa(i,a,a.pendingProps.children,u),a.child;case 10:return g=a.pendingProps,Wr(a,a.type,g.value),oa(i,a,g.children,u),a.child;case 9:return w=a.type._context,g=a.pendingProps.children,Yr(a),w=fs(w),g=g(w),a.flags|=1,oa(i,a,g,u),a.child;case 14:return Fp(i,a,a.type,a.pendingProps,u);case 15:return jf(i,a,a.type,a.pendingProps,u);case 19:return uc(i,a,u);case 31:return Xu(i,a,u);case 22:return hu(i,a,u,a.pendingProps);case 24:return Yr(a),g=fs(Di),i===null?(w=de(),w===null&&(w=Xe,_=ra(),w.pooledCache=_,_.refCount++,_!==null&&(w.pooledCacheLanes|=u),w=_),a.memoizedState={parent:g,cache:w},Mt(a),Wr(a,Di,w)):((i.lanes&u)!==0&&(Ws(i,a),Ms(a,null,null,u),Li()),w=i.memoizedState,_=a.memoizedState,w.parent!==g?(w={parent:g,cache:g},a.memoizedState=w,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=w),Wr(a,Di,g)):(g=_.cache,Wr(a,Di,g),g!==w.cache&&cr(a,[Di],u,!0))),oa(i,a,a.pendingProps.children,u),a.child;case 29:throw a.pendingProps}throw Error(n(156,a.tag))}function Ao(i){i.flags|=4}function pu(i,a,u,g,w){if((a=(i.mode&32)!==0)&&(a=!1),a){if(i.flags|=16777216,(w&335544128)===w)if(i.stateNode.complete)i.flags|=8192;else if(Uy())i.flags|=8192;else throw Je=Be,Ke}else i.flags&=-16777217}function Mh(i,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!P1(a))if(Uy())i.flags|=8192;else throw Je=Be,Ke}function pd(i,a){a!==null&&(i.flags|=4),i.flags&16384&&(a=i.tag!==22?zr():536870912,i.lanes|=a,ds|=a)}function gu(i,a){if(!Ni)switch(i.tailMode){case"hidden":a=i.tail;for(var u=null;a!==null;)a.alternate!==null&&(u=a),a=a.sibling;u===null?i.tail=null:u.sibling=null;break;case"collapsed":u=i.tail;for(var g=null;u!==null;)u.alternate!==null&&(g=u),u=u.sibling;g===null?a||i.tail===null?i.tail=null:i.tail.sibling=null:g.sibling=null}}function Gs(i){var a=i.alternate!==null&&i.alternate.child===i.child,u=0,g=0;if(a)for(var w=i.child;w!==null;)u|=w.lanes|w.childLanes,g|=w.subtreeFlags&65011712,g|=w.flags&65011712,w.return=i,w=w.sibling;else for(w=i.child;w!==null;)u|=w.lanes|w.childLanes,g|=w.subtreeFlags,g|=w.flags,w.return=i,w=w.sibling;return i.subtreeFlags|=g,i.childLanes=u,a}function Ih(i,a,u){var g=a.pendingProps;switch(nc(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gs(a),null;case 1:return Gs(a),null;case 3:return u=a.stateNode,g=null,i!==null&&(g=i.memoizedState.cache),a.memoizedState.cache!==g&&(a.flags|=2048),ys(Di),De(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(i===null||i.child===null)&&(Ls(a)?Ao(a):i===null||i.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Ml())),Gs(a),null;case 26:var w=a.type,_=a.memoizedState;return i===null?(Ao(a),_!==null?(Gs(a),Mh(a,_)):(Gs(a),pu(a,w,null,g,u))):_?_!==i.memoizedState?(Ao(a),Gs(a),Mh(a,_)):(Gs(a),a.flags&=-16777217):(i=i.memoizedProps,i!==g&&Ao(a),Gs(a),pu(a,w,i,g,u)),null;case 27:if(ot(a),u=Te.current,w=a.type,i!==null&&a.stateNode!=null)i.memoizedProps!==g&&Ao(a);else{if(!g){if(a.stateNode===null)throw Error(n(166));return Gs(a),null}i=K.current,Ls(a)?Qd(a):(i=S1(w,g,u),a.stateNode=i,Ao(a))}return Gs(a),null;case 5:if(ot(a),w=a.type,i!==null&&a.stateNode!=null)i.memoizedProps!==g&&Ao(a);else{if(!g){if(a.stateNode===null)throw Error(n(166));return Gs(a),null}if(_=K.current,Ls(a))Qd(a);else{var q=sg(Te.current);switch(_){case 1:_=q.createElementNS("http://www.w3.org/2000/svg",w);break;case 2:_=q.createElementNS("http://www.w3.org/1998/Math/MathML",w);break;default:switch(w){case"svg":_=q.createElementNS("http://www.w3.org/2000/svg",w);break;case"math":_=q.createElementNS("http://www.w3.org/1998/Math/MathML",w);break;case"script":_=q.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild);break;case"select":_=typeof g.is=="string"?q.createElement("select",{is:g.is}):q.createElement("select"),g.multiple?_.multiple=!0:g.size&&(_.size=g.size);break;default:_=typeof g.is=="string"?q.createElement(w,{is:g.is}):q.createElement(w)}}_[Ti]=a,_[Si]=g;e:for(q=a.child;q!==null;){if(q.tag===5||q.tag===6)_.appendChild(q.stateNode);else if(q.tag!==4&&q.tag!==27&&q.child!==null){q.child.return=q,q=q.child;continue}if(q===a)break e;for(;q.sibling===null;){if(q.return===null||q.return===a)break e;q=q.return}q.sibling.return=q.return,q=q.sibling}a.stateNode=_;e:switch(Co(_,w,g),w){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&Ao(a)}}return Gs(a),pu(a,a.type,i===null?null:i.memoizedProps,a.pendingProps,u),null;case 6:if(i&&a.stateNode!=null)i.memoizedProps!==g&&Ao(a);else{if(typeof g!="string"&&a.stateNode===null)throw Error(n(166));if(i=Te.current,Ls(a)){if(i=a.stateNode,u=a.memoizedProps,g=null,w=sa,w!==null)switch(w.tag){case 27:case 5:g=w.memoizedProps}i[Ti]=a,i=!!(i.nodeValue===u||g!==null&&g.suppressHydrationWarning===!0||u1(i.nodeValue,u)),i||ic(a,!0)}else i=sg(i).createTextNode(g),i[Ti]=a,a.stateNode=i}return Gs(a),null;case 31:if(u=a.memoizedState,i===null||i.memoizedState!==null){if(g=Ls(a),u!==null){if(i===null){if(!g)throw Error(n(318));if(i=a.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(557));i[Ti]=a}else or(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Gs(a),i=!1}else u=Ml(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=u),i=!0;if(!i)return a.flags&256?(ns(a),a):(ns(a),null);if((a.flags&128)!==0)throw Error(n(558))}return Gs(a),null;case 13:if(g=a.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(w=Ls(a),g!==null&&g.dehydrated!==null){if(i===null){if(!w)throw Error(n(318));if(w=a.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(n(317));w[Ti]=a}else or(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Gs(a),w=!1}else w=Ml(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=w),w=!0;if(!w)return a.flags&256?(ns(a),a):(ns(a),null)}return ns(a),(a.flags&128)!==0?(a.lanes=u,a):(u=g!==null,i=i!==null&&i.memoizedState!==null,u&&(g=a.child,w=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(w=g.alternate.memoizedState.cachePool.pool),_=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(_=g.memoizedState.cachePool.pool),_!==w&&(g.flags|=2048)),u!==i&&u&&(a.child.flags|=8192),pd(a,a.updateQueue),Gs(a),null);case 4:return De(),i===null&&_0(a.stateNode.containerInfo),Gs(a),null;case 10:return ys(a.type),Gs(a),null;case 19:if(D(zi),g=a.memoizedState,g===null)return Gs(a),null;if(w=(a.flags&128)!==0,_=g.rendering,_===null)if(w)gu(g,!1);else{if(Vt!==0||i!==null&&(i.flags&128)!==0)for(i=a.child;i!==null;){if(_=xr(i),_!==null){for(a.flags|=128,gu(g,!1),i=_.updateQueue,a.updateQueue=i,pd(a,i),a.subtreeFlags=0,i=u,u=a.child;u!==null;)qc(u,i),u=u.sibling;return W(zi,zi.current&1|2),Ni&&Rr(a,g.treeForkCount),a.child}i=i.sibling}g.tail!==null&&sn()>Yp&&(a.flags|=128,w=!0,gu(g,!1),a.lanes=4194304)}else{if(!w)if(i=xr(_),i!==null){if(a.flags|=128,w=!0,i=i.updateQueue,a.updateQueue=i,pd(a,i),gu(g,!0),g.tail===null&&g.tailMode==="hidden"&&!_.alternate&&!Ni)return Gs(a),null}else 2*sn()-g.renderingStartTime>Yp&&u!==536870912&&(a.flags|=128,w=!0,gu(g,!1),a.lanes=4194304);g.isBackwards?(_.sibling=a.child,a.child=_):(i=g.last,i!==null?i.sibling=_:a.child=_,g.last=_)}return g.tail!==null?(i=g.tail,g.rendering=i,g.tail=i.sibling,g.renderingStartTime=sn(),i.sibling=null,u=zi.current,W(zi,w?u&1|2:u&1),Ni&&Rr(a,g.treeForkCount),i):(Gs(a),null);case 22:case 23:return ns(a),yr(),g=a.memoizedState!==null,i!==null?i.memoizedState!==null!==g&&(a.flags|=8192):g&&(a.flags|=8192),g?(u&536870912)!==0&&(a.flags&128)===0&&(Gs(a),a.subtreeFlags&6&&(a.flags|=8192)):Gs(a),u=a.updateQueue,u!==null&&pd(a,u.retryQueue),u=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),g=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(g=a.memoizedState.cachePool.pool),g!==u&&(a.flags|=2048),i!==null&&D(oe),null;case 24:return u=null,i!==null&&(u=i.memoizedState.cache),a.memoizedState.cache!==u&&(a.flags|=2048),ys(Di),Gs(a),null;case 25:return null;case 30:return null}throw Error(n(156,a.tag))}function zh(i,a){switch(nc(a),a.tag){case 1:return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 3:return ys(Di),De(),i=a.flags,(i&65536)!==0&&(i&128)===0?(a.flags=i&-65537|128,a):null;case 26:case 27:case 5:return ot(a),null;case 31:if(a.memoizedState!==null){if(ns(a),a.alternate===null)throw Error(n(340));or()}return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 13:if(ns(a),i=a.memoizedState,i!==null&&i.dehydrated!==null){if(a.alternate===null)throw Error(n(340));or()}return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 19:return D(zi),null;case 4:return De(),null;case 10:return ys(a.type),null;case 22:case 23:return ns(a),yr(),i!==null&&D(oe),i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 24:return ys(Di),null;case 25:return null;default:return null}}function Up(i,a){switch(nc(a),a.tag){case 3:ys(Di),De();break;case 26:case 27:case 5:ot(a);break;case 4:De();break;case 31:a.memoizedState!==null&&ns(a);break;case 13:ns(a);break;case 19:D(zi);break;case 10:ys(a.type);break;case 22:case 23:ns(a),yr(),i!==null&&D(oe);break;case 24:ys(Di)}}function Zu(i,a){try{var u=a.updateQueue,g=u!==null?u.lastEffect:null;if(g!==null){var w=g.next;u=w;do{if((u.tag&i)===i){g=void 0;var _=u.create,q=u.inst;g=_(),q.destroy=g}u=u.next}while(u!==w)}}catch(ce){Es(a,a.return,ce)}}function Rc(i,a,u){try{var g=a.updateQueue,w=g!==null?g.lastEffect:null;if(w!==null){var _=w.next;g=_;do{if((g.tag&i)===i){var q=g.inst,ce=q.destroy;if(ce!==void 0){q.destroy=void 0,w=a;var Me=u,Qe=ce;try{Qe()}catch(gt){Es(w,Me,gt)}}}g=g.next}while(g!==_)}}catch(gt){Es(a,a.return,gt)}}function mu(i){var a=i.updateQueue;if(a!==null){var u=i.stateNode;try{Gi(a,u)}catch(g){Es(i,i.return,g)}}}function Hp(i,a,u){u.props=zd(i.type,i.memoizedProps),u.state=i.memoizedState;try{u.componentWillUnmount()}catch(g){Es(i,a,g)}}function yu(i,a){try{var u=i.ref;if(u!==null){switch(i.tag){case 26:case 27:case 5:var g=i.stateNode;break;case 30:g=i.stateNode;break;default:g=i.stateNode}typeof u=="function"?i.refCleanup=u(g):u.current=g}}catch(w){Es(i,a,w)}}function Hl(i,a){var u=i.ref,g=i.refCleanup;if(u!==null)if(typeof g=="function")try{g()}catch(w){Es(i,a,w)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(w){Es(i,a,w)}else u.current=null}function qp(i){var a=i.type,u=i.memoizedProps,g=i.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":u.autoFocus&&g.focus();break e;case"img":u.src?g.src=u.src:u.srcSet&&(g.srcset=u.srcSet)}}catch(w){Es(i,i.return,w)}}function Bh(i,a,u){try{var g=i.stateNode;Kv(g,i.type,u,a),g[Si]=a}catch(w){Es(i,i.return,w)}}function Oh(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Su(i.type)||i.tag===4}function Ju(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Oh(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Su(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Mf(i,a,u){var g=i.tag;if(g===5||g===6)i=i.stateNode,a?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(i,a):(a=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,a.appendChild(i),u=u._reactRootContainer,u!=null||a.onclick!==null||(a.onclick=co));else if(g!==4&&(g===27&&Su(i.type)&&(u=i.stateNode,a=null),i=i.child,i!==null))for(Mf(i,a,u),i=i.sibling;i!==null;)Mf(i,a,u),i=i.sibling}function Fh(i,a,u){var g=i.tag;if(g===5||g===6)i=i.stateNode,a?u.insertBefore(i,a):u.appendChild(i);else if(g!==4&&(g===27&&Su(i.type)&&(u=i.stateNode),i=i.child,i!==null))for(Fh(i,a,u),i=i.sibling;i!==null;)Fh(i,a,u),i=i.sibling}function gd(i){var a=i.stateNode,u=i.memoizedProps;try{for(var g=i.type,w=a.attributes;w.length;)a.removeAttributeNode(w[0]);Co(a,g,u),a[Ti]=i,a[Si]=u}catch(_){Es(i,i.return,_)}}var $o=!1,ur=!1,If=!1,Vp=typeof WeakSet=="function"?WeakSet:Set,Qr=null;function zf(i,a){if(i=i.containerInfo,j0=ug,i=zo(i),Sa(i)){if("selectionStart"in i)var u={start:i.selectionStart,end:i.selectionEnd};else e:{u=(u=i.ownerDocument)&&u.defaultView||window;var g=u.getSelection&&u.getSelection();if(g&&g.rangeCount!==0){u=g.anchorNode;var w=g.anchorOffset,_=g.focusNode;g=g.focusOffset;try{u.nodeType,_.nodeType}catch{u=null;break e}var q=0,ce=-1,Me=-1,Qe=0,gt=0,St=i,tt=null;t:for(;;){for(var rt;St!==u||w!==0&&St.nodeType!==3||(ce=q+w),St!==_||g!==0&&St.nodeType!==3||(Me=q+g),St.nodeType===3&&(q+=St.nodeValue.length),(rt=St.firstChild)!==null;)tt=St,St=rt;for(;;){if(St===i)break t;if(tt===u&&++Qe===w&&(ce=q),tt===_&&++gt===g&&(Me=q),(rt=St.nextSibling)!==null)break;St=tt,tt=St.parentNode}St=rt}u=ce===-1||Me===-1?null:{start:ce,end:Me}}else u=null}u=u||{start:0,end:0}}else u=null;for(P0={focusedElem:i,selectionRange:u},ug=!1,Qr=a;Qr!==null;)if(a=Qr,i=a.child,(a.subtreeFlags&1028)!==0&&i!==null)i.return=a,Qr=i;else for(;Qr!==null;){switch(a=Qr,_=a.alternate,i=a.flags,a.tag){case 0:if((i&4)!==0&&(i=a.updateQueue,i=i!==null?i.events:null,i!==null))for(u=0;u<i.length;u++)w=i[u],w.ref.impl=w.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&_!==null){i=void 0,u=a,w=_.memoizedProps,_=_.memoizedState,g=u.stateNode;try{var hn=zd(u.type,w);i=g.getSnapshotBeforeUpdate(hn,_),g.__reactInternalSnapshotBeforeUpdate=i}catch($n){Es(u,u.return,$n)}}break;case 3:if((i&1024)!==0){if(i=a.stateNode.containerInfo,u=i.nodeType,u===9)D0(i);else if(u===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":D0(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(n(163))}if(i=a.sibling,i!==null){i.return=a.return,Qr=i;break}Qr=a.return}}function Bf(i,a,u){var g=u.flags;switch(u.tag){case 0:case 11:case 15:Ae(i,u),g&4&&Zu(5,u);break;case 1:if(Ae(i,u),g&4)if(i=u.stateNode,a===null)try{i.componentDidMount()}catch(q){Es(u,u.return,q)}else{var w=zd(u.type,a.memoizedProps);a=a.memoizedState;try{i.componentDidUpdate(w,a,i.__reactInternalSnapshotBeforeUpdate)}catch(q){Es(u,u.return,q)}}g&64&&mu(u),g&512&&yu(u,u.return);break;case 3:if(Ae(i,u),g&64&&(i=u.updateQueue,i!==null)){if(a=null,u.child!==null)switch(u.child.tag){case 27:case 5:a=u.child.stateNode;break;case 1:a=u.child.stateNode}try{Gi(i,a)}catch(q){Es(u,u.return,q)}}break;case 27:a===null&&g&4&&gd(u);case 26:case 5:Ae(i,u),a===null&&g&4&&qp(u),g&512&&yu(u,u.return);break;case 12:Ae(i,u);break;case 31:Ae(i,u),g&4&&$p(i,u);break;case 13:Ae(i,u),g&4&&Gp(i,u),g&64&&(i=u.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(u=Bv.bind(null,u),sw(i,u))));break;case 22:if(g=u.memoizedState!==null||$o,!g){a=a!==null&&a.memoizedState!==null||ur,w=$o;var _=ur;$o=g,(ur=a)&&!_?je(i,u,(u.subtreeFlags&8772)!==0):Ae(i,u),$o=w,ur=_}break;case 30:break;default:Ae(i,u)}}function Of(i){var a=i.alternate;a!==null&&(i.alternate=null,Of(a)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(a=i.stateNode,a!==null&&jo(a)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var It=null,la=!1;function hc(i,a,u){for(u=u.child;u!==null;)Wp(i,a,u),u=u.sibling}function Wp(i,a,u){if(dn&&typeof dn.onCommitFiberUnmount=="function")try{dn.onCommitFiberUnmount(Pn,u)}catch{}switch(u.tag){case 26:ur||Hl(u,a),hc(i,a,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:ur||Hl(u,a);var g=It,w=la;Su(u.type)&&(It=u.stateNode,la=!1),hc(i,a,u),Vf(u.stateNode),It=g,la=w;break;case 5:ur||Hl(u,a);case 6:if(g=It,w=la,It=null,hc(i,a,u),It=g,la=w,It!==null)if(la)try{(It.nodeType===9?It.body:It.nodeName==="HTML"?It.ownerDocument.body:It).removeChild(u.stateNode)}catch(_){Es(u,a,_)}else try{It.removeChild(u.stateNode)}catch(_){Es(u,a,_)}break;case 18:It!==null&&(la?(i=It,y1(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,u.stateNode),Yh(i)):y1(It,u.stateNode));break;case 4:g=It,w=la,It=u.stateNode.containerInfo,la=!0,hc(i,a,u),It=g,la=w;break;case 0:case 11:case 14:case 15:Rc(2,u,a),ur||Rc(4,u,a),hc(i,a,u);break;case 1:ur||(Hl(u,a),g=u.stateNode,typeof g.componentWillUnmount=="function"&&Hp(u,a,g)),hc(i,a,u);break;case 21:hc(i,a,u);break;case 22:ur=(g=ur)||u.memoizedState!==null,hc(i,a,u),ur=g;break;default:hc(i,a,u)}}function $p(i,a){if(a.memoizedState===null&&(i=a.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Yh(i)}catch(u){Es(a,a.return,u)}}}function Gp(i,a){if(a.memoizedState===null&&(i=a.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Yh(i)}catch(u){Es(a,a.return,u)}}function p(i){switch(i.tag){case 31:case 13:case 19:var a=i.stateNode;return a===null&&(a=i.stateNode=new Vp),a;case 22:return i=i.stateNode,a=i._retryCache,a===null&&(a=i._retryCache=new Vp),a;default:throw Error(n(435,i.tag))}}function C(i,a){var u=p(i);a.forEach(function(g){if(!u.has(g)){u.add(g);var w=Ov.bind(null,i,g);g.then(w,w)}})}function L(i,a){var u=a.deletions;if(u!==null)for(var g=0;g<u.length;g++){var w=u[g],_=i,q=a,ce=q;e:for(;ce!==null;){switch(ce.tag){case 27:if(Su(ce.type)){It=ce.stateNode,la=!1;break e}break;case 5:It=ce.stateNode,la=!1;break e;case 3:case 4:It=ce.stateNode.containerInfo,la=!0;break e}ce=ce.return}if(It===null)throw Error(n(160));Wp(_,q,w),It=null,la=!1,_=w.alternate,_!==null&&(_.return=null),w.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)le(a,i),a=a.sibling}var Y=null;function le(i,a){var u=i.alternate,g=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:L(a,i),he(i),g&4&&(Rc(3,i,i.return),Zu(3,i),Rc(5,i,i.return));break;case 1:L(a,i),he(i),g&512&&(ur||u===null||Hl(u,u.return)),g&64&&$o&&(i=i.updateQueue,i!==null&&(g=i.callbacks,g!==null&&(u=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=u===null?g:u.concat(g))));break;case 26:var w=Y;if(L(a,i),he(i),g&512&&(ur||u===null||Hl(u,u.return)),g&4){var _=u!==null?u.memoizedState:null;if(g=i.memoizedState,u===null)if(g===null)if(i.stateNode===null){e:{g=i.type,u=i.memoizedProps,w=w.ownerDocument||w;t:switch(g){case"title":_=w.getElementsByTagName("title")[0],(!_||_[Wa]||_[Ti]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=w.createElement(g),w.head.insertBefore(_,w.querySelector("head > title"))),Co(_,g,u),_[Ti]=i,Rn(_),g=_;break e;case"link":var q=N1("link","href",w).get(g+(u.href||""));if(q){for(var ce=0;ce<q.length;ce++)if(_=q[ce],_.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&_.getAttribute("rel")===(u.rel==null?null:u.rel)&&_.getAttribute("title")===(u.title==null?null:u.title)&&_.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){q.splice(ce,1);break t}}_=w.createElement(g),Co(_,g,u),w.head.appendChild(_);break;case"meta":if(q=N1("meta","content",w).get(g+(u.content||""))){for(ce=0;ce<q.length;ce++)if(_=q[ce],_.getAttribute("content")===(u.content==null?null:""+u.content)&&_.getAttribute("name")===(u.name==null?null:u.name)&&_.getAttribute("property")===(u.property==null?null:u.property)&&_.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&_.getAttribute("charset")===(u.charSet==null?null:u.charSet)){q.splice(ce,1);break t}}_=w.createElement(g),Co(_,g,u),w.head.appendChild(_);break;default:throw Error(n(468,g))}_[Ti]=i,Rn(_),g=_}i.stateNode=g}else j1(w,i.type,i.stateNode);else i.stateNode=k1(w,g,i.memoizedProps);else _!==g?(_===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):_.count--,g===null?j1(w,i.type,i.stateNode):k1(w,g,i.memoizedProps)):g===null&&i.stateNode!==null&&Bh(i,i.memoizedProps,u.memoizedProps)}break;case 27:L(a,i),he(i),g&512&&(ur||u===null||Hl(u,u.return)),u!==null&&g&4&&Bh(i,i.memoizedProps,u.memoizedProps);break;case 5:if(L(a,i),he(i),g&512&&(ur||u===null||Hl(u,u.return)),i.flags&32){w=i.stateNode;try{Nr(w,"")}catch(hn){Es(i,i.return,hn)}}g&4&&i.stateNode!=null&&(w=i.memoizedProps,Bh(i,w,u!==null?u.memoizedProps:w)),g&1024&&(If=!0);break;case 6:if(L(a,i),he(i),g&4){if(i.stateNode===null)throw Error(n(162));g=i.memoizedProps,u=i.stateNode;try{u.nodeValue=g}catch(hn){Es(i,i.return,hn)}}break;case 3:if(og=null,w=Y,Y=rg(a.containerInfo),L(a,i),Y=w,he(i),g&4&&u!==null&&u.memoizedState.isDehydrated)try{Yh(a.containerInfo)}catch(hn){Es(i,i.return,hn)}If&&(If=!1,U(i));break;case 4:g=Y,Y=rg(i.stateNode.containerInfo),L(a,i),he(i),Y=g;break;case 12:L(a,i),he(i);break;case 31:L(a,i),he(i),g&4&&(g=i.updateQueue,g!==null&&(i.updateQueue=null,C(i,g)));break;case 13:L(a,i),he(i),i.child.flags&8192&&i.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(Go=sn()),g&4&&(g=i.updateQueue,g!==null&&(i.updateQueue=null,C(i,g)));break;case 22:w=i.memoizedState!==null;var Me=u!==null&&u.memoizedState!==null,Qe=$o,gt=ur;if($o=Qe||w,ur=gt||Me,L(a,i),ur=gt,$o=Qe,he(i),g&8192)e:for(a=i.stateNode,a._visibility=w?a._visibility&-2:a._visibility|1,w&&(u===null||Me||$o||ur||pe(i)),u=null,a=i;;){if(a.tag===5||a.tag===26){if(u===null){Me=u=a;try{if(_=Me.stateNode,w)q=_.style,typeof q.setProperty=="function"?q.setProperty("display","none","important"):q.display="none";else{ce=Me.stateNode;var St=Me.memoizedProps.style,tt=St!=null&&St.hasOwnProperty("display")?St.display:null;ce.style.display=tt==null||typeof tt=="boolean"?"":(""+tt).trim()}}catch(hn){Es(Me,Me.return,hn)}}}else if(a.tag===6){if(u===null){Me=a;try{Me.stateNode.nodeValue=w?"":Me.memoizedProps}catch(hn){Es(Me,Me.return,hn)}}}else if(a.tag===18){if(u===null){Me=a;try{var rt=Me.stateNode;w?x1(rt,!0):x1(Me.stateNode,!1)}catch(hn){Es(Me,Me.return,hn)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===i)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break e;for(;a.sibling===null;){if(a.return===null||a.return===i)break e;u===a&&(u=null),a=a.return}u===a&&(u=null),a.sibling.return=a.return,a=a.sibling}g&4&&(g=i.updateQueue,g!==null&&(u=g.retryQueue,u!==null&&(g.retryQueue=null,C(i,u))));break;case 19:L(a,i),he(i),g&4&&(g=i.updateQueue,g!==null&&(i.updateQueue=null,C(i,g)));break;case 30:break;case 21:break;default:L(a,i),he(i)}}function he(i){var a=i.flags;if(a&2){try{for(var u,g=i.return;g!==null;){if(Oh(g)){u=g;break}g=g.return}if(u==null)throw Error(n(160));switch(u.tag){case 27:var w=u.stateNode,_=Ju(i);Fh(i,_,w);break;case 5:var q=u.stateNode;u.flags&32&&(Nr(q,""),u.flags&=-33);var ce=Ju(i);Fh(i,ce,q);break;case 3:case 4:var Me=u.stateNode.containerInfo,Qe=Ju(i);Mf(i,Qe,Me);break;default:throw Error(n(161))}}catch(gt){Es(i,i.return,gt)}i.flags&=-3}a&4096&&(i.flags&=-4097)}function U(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var a=i;U(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),i=i.sibling}}function Ae(i,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)Bf(i,a.alternate,a),a=a.sibling}function pe(i){for(i=i.child;i!==null;){var a=i;switch(a.tag){case 0:case 11:case 14:case 15:Rc(4,a,a.return),pe(a);break;case 1:Hl(a,a.return);var u=a.stateNode;typeof u.componentWillUnmount=="function"&&Hp(a,a.return,u),pe(a);break;case 27:Vf(a.stateNode);case 26:case 5:Hl(a,a.return),pe(a);break;case 22:a.memoizedState===null&&pe(a);break;case 30:pe(a);break;default:pe(a)}i=i.sibling}}function je(i,a,u){for(u=u&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var g=a.alternate,w=i,_=a,q=_.flags;switch(_.tag){case 0:case 11:case 15:je(w,_,u),Zu(4,_);break;case 1:if(je(w,_,u),g=_,w=g.stateNode,typeof w.componentDidMount=="function")try{w.componentDidMount()}catch(Qe){Es(g,g.return,Qe)}if(g=_,w=g.updateQueue,w!==null){var ce=g.stateNode;try{var Me=w.shared.hiddenCallbacks;if(Me!==null)for(w.shared.hiddenCallbacks=null,w=0;w<Me.length;w++)Kr(Me[w],ce)}catch(Qe){Es(g,g.return,Qe)}}u&&q&64&&mu(_),yu(_,_.return);break;case 27:gd(_);case 26:case 5:je(w,_,u),u&&g===null&&q&4&&qp(_),yu(_,_.return);break;case 12:je(w,_,u);break;case 31:je(w,_,u),u&&q&4&&$p(w,_);break;case 13:je(w,_,u),u&&q&4&&Gp(w,_);break;case 22:_.memoizedState===null&&je(w,_,u),yu(_,_.return);break;case 30:break;default:je(w,_,u)}a=a.sibling}}function Ne(i,a){var u=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),i=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(i=a.memoizedState.cachePool.pool),i!==u&&(i!=null&&i.refCount++,u!=null&&_a(u))}function ke(i,a){i=null,a.alternate!==null&&(i=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==i&&(a.refCount++,i!=null&&_a(i))}function ge(i,a,u,g){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Se(i,a,u,g),a=a.sibling}function Se(i,a,u,g){var w=a.flags;switch(a.tag){case 0:case 11:case 15:ge(i,a,u,g),w&2048&&Zu(9,a);break;case 1:ge(i,a,u,g);break;case 3:ge(i,a,u,g),w&2048&&(i=null,a.alternate!==null&&(i=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==i&&(a.refCount++,i!=null&&_a(i)));break;case 12:if(w&2048){ge(i,a,u,g),i=a.stateNode;try{var _=a.memoizedProps,q=_.id,ce=_.onPostCommit;typeof ce=="function"&&ce(q,a.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(Me){Es(a,a.return,Me)}}else ge(i,a,u,g);break;case 31:ge(i,a,u,g);break;case 13:ge(i,a,u,g);break;case 23:break;case 22:_=a.stateNode,q=a.alternate,a.memoizedState!==null?_._visibility&2?ge(i,a,u,g):ye(i,a):_._visibility&2?ge(i,a,u,g):(_._visibility|=2,be(i,a,u,g,(a.subtreeFlags&10256)!==0||!1)),w&2048&&Ne(q,a);break;case 24:ge(i,a,u,g),w&2048&&ke(a.alternate,a);break;default:ge(i,a,u,g)}}function be(i,a,u,g,w){for(w=w&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var _=i,q=a,ce=u,Me=g,Qe=q.flags;switch(q.tag){case 0:case 11:case 15:be(_,q,ce,Me,w),Zu(8,q);break;case 23:break;case 22:var gt=q.stateNode;q.memoizedState!==null?gt._visibility&2?be(_,q,ce,Me,w):ye(_,q):(gt._visibility|=2,be(_,q,ce,Me,w)),w&&Qe&2048&&Ne(q.alternate,q);break;case 24:be(_,q,ce,Me,w),w&&Qe&2048&&ke(q.alternate,q);break;default:be(_,q,ce,Me,w)}a=a.sibling}}function ye(i,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var u=i,g=a,w=g.flags;switch(g.tag){case 22:ye(u,g),w&2048&&Ne(g.alternate,g);break;case 24:ye(u,g),w&2048&&ke(g.alternate,g);break;default:ye(u,g)}a=a.sibling}}var Le=8192;function Ee(i,a,u){if(i.subtreeFlags&Le)for(i=i.child;i!==null;)He(i,a,u),i=i.sibling}function He(i,a,u){switch(i.tag){case 26:Ee(i,a,u),i.flags&Le&&i.memoizedState!==null&&mw(u,Y,i.memoizedState,i.memoizedProps);break;case 5:Ee(i,a,u);break;case 3:case 4:var g=Y;Y=rg(i.stateNode.containerInfo),Ee(i,a,u),Y=g;break;case 22:i.memoizedState===null&&(g=i.alternate,g!==null&&g.memoizedState!==null?(g=Le,Le=16777216,Ee(i,a,u),Le=g):Ee(i,a,u));break;default:Ee(i,a,u)}}function ct(i){var a=i.alternate;if(a!==null&&(i=a.child,i!==null)){a.child=null;do a=i.sibling,i.sibling=null,i=a;while(i!==null)}}function ft(i){var a=i.deletions;if((i.flags&16)!==0){if(a!==null)for(var u=0;u<a.length;u++){var g=a[u];Qr=g,Ft(g,i)}ct(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)At(i),i=i.sibling}function At(i){switch(i.tag){case 0:case 11:case 15:ft(i),i.flags&2048&&Rc(9,i,i.return);break;case 3:ft(i);break;case 12:ft(i);break;case 22:var a=i.stateNode;i.memoizedState!==null&&a._visibility&2&&(i.return===null||i.return.tag!==13)?(a._visibility&=-3,nt(i)):ft(i);break;default:ft(i)}}function nt(i){var a=i.deletions;if((i.flags&16)!==0){if(a!==null)for(var u=0;u<a.length;u++){var g=a[u];Qr=g,Ft(g,i)}ct(i)}for(i=i.child;i!==null;){switch(a=i,a.tag){case 0:case 11:case 15:Rc(8,a,a.return),nt(a);break;case 22:u=a.stateNode,u._visibility&2&&(u._visibility&=-3,nt(a));break;default:nt(a)}i=i.sibling}}function Ft(i,a){for(;Qr!==null;){var u=Qr;switch(u.tag){case 0:case 11:case 15:Rc(8,u,a);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var g=u.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:_a(u.memoizedState.cache)}if(g=u.child,g!==null)g.return=u,Qr=g;else e:for(u=i;Qr!==null;){g=Qr;var w=g.sibling,_=g.return;if(Of(g),g===u){Qr=null;break e}if(w!==null){w.return=_,Qr=w;break e}Qr=_}}}var Ue={getCacheForType:function(i){var a=fs(Di),u=a.data.get(i);return u===void 0&&(u=i(),a.data.set(i,u)),u},cacheSignal:function(){return fs(Di).controller.signal}},qe=typeof WeakMap=="function"?WeakMap:Map,Ie=0,Xe=null,Ye=null,dt=0,Pt=0,Jt=null,Nn=!1,kn=!1,On=!1,Kn=0,Vt=0,Et=0,un=0,cs=0,Bi=0,ds=0,tr=null,Yi=null,Zn=!1,Go=0,yl=0,Yp=1/0,Xp=null,xu=null,Ua=0,bu=null,Uh=null,Hd=0,p0=0,g0=null,Iy=null,Ff=0,m0=null;function fc(){return(Ie&2)!==0&&dt!==0?dt&-dt:V.T!==null?S0():vs()}function zy(){if(Bi===0)if((dt&536870912)===0||Ni){var i=Vi;Vi<<=1,(Vi&3932160)===0&&(Vi=262144),Bi=i}else Bi=536870912;return i=js.current,i!==null&&(i.flags|=32),Bi}function ql(i,a,u){(i===Xe&&(Pt===2||Pt===9)||i.cancelPendingCommit!==null)&&(Hh(i,0),vu(i,dt,Bi,!1)),en(i,u),((Ie&2)===0||i!==Xe)&&(i===Xe&&((Ie&2)===0&&(un|=u),Vt===4&&vu(i,dt,Bi,!1)),md(i))}function By(i,a,u){if((Ie&6)!==0)throw Error(n(327));var g=!u&&(a&127)===0&&(a&i.expiredLanes)===0||Cr(i,a),w=g?Mv(i,a):x0(i,a,!0),_=g;do{if(w===0){kn&&!g&&vu(i,a,0,!1);break}else{if(u=i.current.alternate,_&&!Dv(u)){w=x0(i,a,!1),_=!1;continue}if(w===2){if(_=a,i.errorRecoveryDisabledLanes&_)var q=0;else q=i.pendingLanes&-536870913,q=q!==0?q:q&536870912?536870912:0;if(q!==0){a=q;e:{var ce=i;w=tr;var Me=ce.current.memoizedState.isDehydrated;if(Me&&(Hh(ce,q).flags|=256),q=x0(ce,q,!1),q!==2){if(On&&!Me){ce.errorRecoveryDisabledLanes|=_,un|=_,w=4;break e}_=Yi,Yi=w,_!==null&&(Yi===null?Yi=_:Yi.push.apply(Yi,_))}w=q}if(_=!1,w!==2)continue}}if(w===1){Hh(i,0),vu(i,a,0,!0);break}e:{switch(g=i,_=w,_){case 0:case 1:throw Error(n(345));case 4:if((a&4194048)!==a)break;case 6:vu(g,a,Bi,!Nn);break e;case 2:Yi=null;break;case 3:case 5:break;default:throw Error(n(329))}if((a&62914560)===a&&(w=Go+300-sn(),10<w)){if(vu(g,a,Bi,!Nn),Qt(g,0,!0)!==0)break e;Hd=a,g.timeoutHandle=g1(Oy.bind(null,g,u,Yi,Xp,Zn,a,Bi,un,ds,Nn,_,"Throttled",-0,0),w);break e}Oy(g,u,Yi,Xp,Zn,a,Bi,un,ds,Nn,_,null,-0,0)}}break}while(!0);md(i)}function Oy(i,a,u,g,w,_,q,ce,Me,Qe,gt,St,tt,rt){if(i.timeoutHandle=-1,St=a.subtreeFlags,St&8192||(St&16785408)===16785408){St={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:co},He(a,_,St);var hn=(_&62914560)===_?Go-sn():(_&4194048)===_?yl-sn():0;if(hn=yw(St,hn),hn!==null){Hd=_,i.cancelPendingCommit=hn(Gy.bind(null,i,a,_,u,g,w,q,ce,Me,gt,St,null,tt,rt)),vu(i,_,q,!Qe);return}}Gy(i,a,_,u,g,w,q,ce,Me)}function Dv(i){for(var a=i;;){var u=a.tag;if((u===0||u===11||u===15)&&a.flags&16384&&(u=a.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var g=0;g<u.length;g++){var w=u[g],_=w.getSnapshot;w=w.value;try{if(!Pr(_(),w))return!1}catch{return!1}}if(u=a.child,a.subtreeFlags&16384&&u!==null)u.return=a,a=u;else{if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function vu(i,a,u,g){a&=~cs,a&=~un,i.suspendedLanes|=a,i.pingedLanes&=~a,g&&(i.warmLanes|=a),g=i.expirationTimes;for(var w=a;0<w;){var _=31-lt(w),q=1<<_;g[_]=-1,w&=~q}u!==0&&ja(i,u,a)}function Kp(){return(Ie&6)===0?(Uf(0),!1):!0}function y0(){if(Ye!==null){if(Pt===0)var i=Ye.return;else i=Ye,Ns=Vr=null,Ld(i),wt=null,on=0,i=Ye;for(;i!==null;)Up(i.alternate,i),i=i.return;Ye=null}}function Hh(i,a){var u=i.timeoutHandle;u!==-1&&(i.timeoutHandle=-1,Qv(u)),u=i.cancelPendingCommit,u!==null&&(i.cancelPendingCommit=null,u()),Hd=0,y0(),Xe=i,Ye=u=za(i.current,null),dt=a,Pt=0,Jt=null,Nn=!1,kn=Cr(i,a),On=!1,ds=Bi=cs=un=Et=Vt=0,Yi=tr=null,Zn=!1,(a&8)!==0&&(a|=a&32);var g=i.entangledLanes;if(g!==0)for(i=i.entanglements,g&=a;0<g;){var w=31-lt(g),_=1<<w;a|=i[w],g&=~_}return Kn=a,jd(),u}function Fy(i,a){wn=null,V.H=Vo,a===ze||a===ve?(a=mt(),Pt=3):a===Ke?(a=mt(),Pt=4):Pt=a===Ph?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Jt=a,Ye===null&&(Vt=1,Yu(i,Ba(a,i.current)))}function Uy(){var i=js.current;return i===null?!0:(dt&4194048)===dt?mi===null:(dt&62914560)===dt||(dt&536870912)!==0?i===mi:!1}function Hy(){var i=V.H;return V.H=Vo,i===null?Vo:i}function qy(){var i=V.A;return V.A=Ue,i}function Zp(){Vt=4,Nn||(dt&4194048)!==dt&&js.current!==null||(kn=!0),(Et&134217727)===0&&(un&134217727)===0||Xe===null||vu(Xe,dt,Bi,!1)}function x0(i,a,u){var g=Ie;Ie|=2;var w=Hy(),_=qy();(Xe!==i||dt!==a)&&(Xp=null,Hh(i,a)),a=!1;var q=Vt;e:do try{if(Pt!==0&&Ye!==null){var ce=Ye,Me=Jt;switch(Pt){case 8:y0(),q=6;break e;case 3:case 2:case 9:case 6:js.current===null&&(a=!0);var Qe=Pt;if(Pt=0,Jt=null,qh(i,ce,Me,Qe),u&&kn){q=0;break e}break;default:Qe=Pt,Pt=0,Jt=null,qh(i,ce,Me,Qe)}}Lv(),q=Vt;break}catch(gt){Fy(i,gt)}while(!0);return a&&i.shellSuspendCounter++,Ns=Vr=null,Ie=g,V.H=w,V.A=_,Ye===null&&(Xe=null,dt=0,jd()),q}function Lv(){for(;Ye!==null;)Vy(Ye)}function Mv(i,a){var u=Ie;Ie|=2;var g=Hy(),w=qy();Xe!==i||dt!==a?(Xp=null,Yp=sn()+500,Hh(i,a)):kn=Cr(i,a);e:do try{if(Pt!==0&&Ye!==null){a=Ye;var _=Jt;t:switch(Pt){case 1:Pt=0,Jt=null,qh(i,a,_,1);break;case 2:case 9:if($e(_)){Pt=0,Jt=null,Wy(a);break}a=function(){Pt!==2&&Pt!==9||Xe!==i||(Pt=7),md(i)},_.then(a,a);break e;case 3:Pt=7;break e;case 4:Pt=5;break e;case 7:$e(_)?(Pt=0,Jt=null,Wy(a)):(Pt=0,Jt=null,qh(i,a,_,7));break;case 5:var q=null;switch(Ye.tag){case 26:q=Ye.memoizedState;case 5:case 27:var ce=Ye;if(q?P1(q):ce.stateNode.complete){Pt=0,Jt=null;var Me=ce.sibling;if(Me!==null)Ye=Me;else{var Qe=ce.return;Qe!==null?(Ye=Qe,Jp(Qe)):Ye=null}break t}}Pt=0,Jt=null,qh(i,a,_,5);break;case 6:Pt=0,Jt=null,qh(i,a,_,6);break;case 8:y0(),Vt=6;break e;default:throw Error(n(462))}}Iv();break}catch(gt){Fy(i,gt)}while(!0);return Ns=Vr=null,V.H=g,V.A=w,Ie=u,Ye!==null?0:(Xe=null,dt=0,jd(),Vt)}function Iv(){for(;Ye!==null&&!Dt();)Vy(Ye)}function Vy(i){var a=Ud(i.alternate,i,Kn);i.memoizedProps=i.pendingProps,a===null?Jp(i):Ye=a}function Wy(i){var a=i,u=a.alternate;switch(a.tag){case 15:case 0:a=Eh(u,a,a.pendingProps,a.type,void 0,dt);break;case 11:a=Eh(u,a,a.pendingProps,a.type.render,a.ref,dt);break;case 5:Ld(a);default:Up(u,a),a=Ye=qc(a,Kn),a=Ud(u,a,Kn)}i.memoizedProps=i.pendingProps,a===null?Jp(i):Ye=a}function qh(i,a,u,g){Ns=Vr=null,Ld(a),wt=null,on=0;var w=a.return;try{if(Nf(i,w,a,u,dt)){Vt=1,Yu(i,Ba(u,i.current)),Ye=null;return}}catch(_){if(w!==null)throw Ye=w,_;Vt=1,Yu(i,Ba(u,i.current)),Ye=null;return}a.flags&32768?(Ni||g===1?i=!0:kn||(dt&536870912)!==0?i=!1:(Nn=i=!0,(g===2||g===9||g===3||g===6)&&(g=js.current,g!==null&&g.tag===13&&(g.flags|=16384))),$y(a,i)):Jp(a)}function Jp(i){var a=i;do{if((a.flags&32768)!==0){$y(a,Nn);return}i=a.return;var u=Ih(a.alternate,a,Kn);if(u!==null){Ye=u;return}if(a=a.sibling,a!==null){Ye=a;return}Ye=a=i}while(a!==null);Vt===0&&(Vt=5)}function $y(i,a){do{var u=zh(i.alternate,i);if(u!==null){u.flags&=32767,Ye=u;return}if(u=i.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!a&&(i=i.sibling,i!==null)){Ye=i;return}Ye=i=u}while(i!==null);Vt=6,Ye=null}function Gy(i,a,u,g,w,_,q,ce,Me){i.cancelPendingCommit=null;do Qp();while(Ua!==0);if((Ie&6)!==0)throw Error(n(327));if(a!==null){if(a===i.current)throw Error(n(177));if(_=a.lanes|a.childLanes,_|=Ia,Or(i,u,_,q,ce,Me),i===Xe&&(Ye=Xe=null,dt=0),Uh=a,bu=i,Hd=u,p0=_,g0=w,Iy=g,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,Fv(pt,function(){return Jy(),null})):(i.callbackNode=null,i.callbackPriority=0),g=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||g){g=V.T,V.T=null,w=ee.p,ee.p=2,q=Ie,Ie|=4;try{zf(i,a,u)}finally{Ie=q,ee.p=w,V.T=g}}Ua=1,Yy(),Xy(),Ky()}}function Yy(){if(Ua===1){Ua=0;var i=bu,a=Uh,u=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||u){u=V.T,V.T=null;var g=ee.p;ee.p=2;var w=Ie;Ie|=4;try{le(a,i);var _=P0,q=zo(i.containerInfo),ce=_.focusedElem,Me=_.selectionRange;if(q!==ce&&ce&&ce.ownerDocument&&dl(ce.ownerDocument.documentElement,ce)){if(Me!==null&&Sa(ce)){var Qe=Me.start,gt=Me.end;if(gt===void 0&&(gt=Qe),"selectionStart"in ce)ce.selectionStart=Qe,ce.selectionEnd=Math.min(gt,ce.value.length);else{var St=ce.ownerDocument||document,tt=St&&St.defaultView||window;if(tt.getSelection){var rt=tt.getSelection(),hn=ce.textContent.length,$n=Math.min(Me.start,hn),Bs=Me.end===void 0?$n:Math.min(Me.end,hn);!rt.extend&&$n>Bs&&(q=Bs,Bs=$n,$n=q);var Ge=to(ce,$n),Oe=to(ce,Bs);if(Ge&&Oe&&(rt.rangeCount!==1||rt.anchorNode!==Ge.node||rt.anchorOffset!==Ge.offset||rt.focusNode!==Oe.node||rt.focusOffset!==Oe.offset)){var Ze=St.createRange();Ze.setStart(Ge.node,Ge.offset),rt.removeAllRanges(),$n>Bs?(rt.addRange(Ze),rt.extend(Oe.node,Oe.offset)):(Ze.setEnd(Oe.node,Oe.offset),rt.addRange(Ze))}}}}for(St=[],rt=ce;rt=rt.parentNode;)rt.nodeType===1&&St.push({element:rt,left:rt.scrollLeft,top:rt.scrollTop});for(typeof ce.focus=="function"&&ce.focus(),ce=0;ce<St.length;ce++){var bt=St[ce];bt.element.scrollLeft=bt.left,bt.element.scrollTop=bt.top}}ug=!!j0,P0=j0=null}finally{Ie=w,ee.p=g,V.T=u}}i.current=a,Ua=2}}function Xy(){if(Ua===2){Ua=0;var i=bu,a=Uh,u=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||u){u=V.T,V.T=null;var g=ee.p;ee.p=2;var w=Ie;Ie|=4;try{Bf(i,a.alternate,a)}finally{Ie=w,ee.p=g,V.T=u}}Ua=3}}function Ky(){if(Ua===4||Ua===3){Ua=0,Ot();var i=bu,a=Uh,u=Hd,g=Iy;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Ua=5:(Ua=0,Uh=bu=null,Zy(i,i.pendingLanes));var w=i.pendingLanes;if(w===0&&(xu=null),ti(u),a=a.stateNode,dn&&typeof dn.onCommitFiberRoot=="function")try{dn.onCommitFiberRoot(Pn,a,void 0,(a.current.flags&128)===128)}catch{}if(g!==null){a=V.T,w=ee.p,ee.p=2,V.T=null;try{for(var _=i.onRecoverableError,q=0;q<g.length;q++){var ce=g[q];_(ce.value,{componentStack:ce.stack})}}finally{V.T=a,ee.p=w}}(Hd&3)!==0&&Qp(),md(i),w=i.pendingLanes,(u&261930)!==0&&(w&42)!==0?i===m0?Ff++:(Ff=0,m0=i):Ff=0,Uf(0)}}function Zy(i,a){(i.pooledCacheLanes&=a)===0&&(a=i.pooledCache,a!=null&&(i.pooledCache=null,_a(a)))}function Qp(){return Yy(),Xy(),Ky(),Jy()}function Jy(){if(Ua!==5)return!1;var i=bu,a=p0;p0=0;var u=ti(Hd),g=V.T,w=ee.p;try{ee.p=32>u?32:u,V.T=null,u=g0,g0=null;var _=bu,q=Hd;if(Ua=0,Uh=bu=null,Hd=0,(Ie&6)!==0)throw Error(n(331));var ce=Ie;if(Ie|=4,At(_.current),Se(_,_.current,q,u),Ie=ce,Uf(0,!1),dn&&typeof dn.onPostCommitFiberRoot=="function")try{dn.onPostCommitFiberRoot(Pn,_)}catch{}return!0}finally{ee.p=w,V.T=g,Zy(i,a)}}function Qy(i,a,u){a=Ba(u,a),a=jh(i.stateNode,a,2),i=qn(i,a,2),i!==null&&(en(i,2),md(i))}function Es(i,a,u){if(i.tag===3)Qy(i,i,u);else for(;a!==null;){if(a.tag===3){Qy(a,i,u);break}else if(a.tag===1){var g=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(xu===null||!xu.has(g))){i=Ba(u,i),u=uu(2),g=qn(a,u,2),g!==null&&(Bp(u,g,a,i),en(g,2),md(g));break}}a=a.return}}function b0(i,a,u){var g=i.pingCache;if(g===null){g=i.pingCache=new qe;var w=new Set;g.set(a,w)}else w=g.get(a),w===void 0&&(w=new Set,g.set(a,w));w.has(u)||(On=!0,w.add(u),i=zv.bind(null,i,a,u),a.then(i,i))}function zv(i,a,u){var g=i.pingCache;g!==null&&g.delete(a),i.pingedLanes|=i.suspendedLanes&u,i.warmLanes&=~u,Xe===i&&(dt&u)===u&&(Vt===4||Vt===3&&(dt&62914560)===dt&&300>sn()-Go?(Ie&2)===0&&Hh(i,0):cs|=u,ds===dt&&(ds=0)),md(i)}function e1(i,a){a===0&&(a=zr()),i=Oo(i,a),i!==null&&(en(i,a),md(i))}function Bv(i){var a=i.memoizedState,u=0;a!==null&&(u=a.retryLane),e1(i,u)}function Ov(i,a){var u=0;switch(i.tag){case 31:case 13:var g=i.stateNode,w=i.memoizedState;w!==null&&(u=w.retryLane);break;case 19:g=i.stateNode;break;case 22:g=i.stateNode._retryCache;break;default:throw Error(n(314))}g!==null&&g.delete(a),e1(i,u)}function Fv(i,a){return qt(i,a)}var eg=null,Vh=null,v0=!1,tg=!1,w0=!1,wu=0;function md(i){i!==Vh&&i.next===null&&(Vh===null?eg=Vh=i:Vh=Vh.next=i),tg=!0,v0||(v0=!0,Hv())}function Uf(i,a){if(!w0&&tg){w0=!0;do for(var u=!1,g=eg;g!==null;){if(i!==0){var w=g.pendingLanes;if(w===0)var _=0;else{var q=g.suspendedLanes,ce=g.pingedLanes;_=(1<<31-lt(42|i)+1)-1,_&=w&~(q&~ce),_=_&201326741?_&201326741|1:_?_|2:0}_!==0&&(u=!0,s1(g,_))}else _=dt,_=Qt(g,g===Xe?_:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(_&3)===0||Cr(g,_)||(u=!0,s1(g,_));g=g.next}while(u);w0=!1}}function Uv(){t1()}function t1(){tg=v0=!1;var i=0;wu!==0&&Jv()&&(i=wu);for(var a=sn(),u=null,g=eg;g!==null;){var w=g.next,_=n1(g,a);_===0?(g.next=null,u===null?eg=w:u.next=w,w===null&&(Vh=u)):(u=g,(i!==0||(_&3)!==0)&&(tg=!0)),g=w}Ua!==0&&Ua!==5||Uf(i),wu!==0&&(wu=0)}function n1(i,a){for(var u=i.suspendedLanes,g=i.pingedLanes,w=i.expirationTimes,_=i.pendingLanes&-62914561;0<_;){var q=31-lt(_),ce=1<<q,Me=w[q];Me===-1?((ce&u)===0||(ce&g)!==0)&&(w[q]=Ks(ce,a)):Me<=a&&(i.expiredLanes|=ce),_&=~ce}if(a=Xe,u=dt,u=Qt(i,i===a?u:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),g=i.callbackNode,u===0||i===a&&(Pt===2||Pt===9)||i.cancelPendingCommit!==null)return g!==null&&g!==null&&vt(g),i.callbackNode=null,i.callbackPriority=0;if((u&3)===0||Cr(i,u)){if(a=u&-u,a===i.callbackPriority)return a;switch(g!==null&&vt(g),ti(u)){case 2:case 8:u=Jn;break;case 32:u=pt;break;case 268435456:u=Fn;break;default:u=pt}return g=i1.bind(null,i),u=qt(u,g),i.callbackPriority=a,i.callbackNode=u,a}return g!==null&&g!==null&&vt(g),i.callbackPriority=2,i.callbackNode=null,2}function i1(i,a){if(Ua!==0&&Ua!==5)return i.callbackNode=null,i.callbackPriority=0,null;var u=i.callbackNode;if(Qp()&&i.callbackNode!==u)return null;var g=dt;return g=Qt(i,i===Xe?g:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),g===0?null:(By(i,g,a),n1(i,sn()),i.callbackNode!=null&&i.callbackNode===u?i1.bind(null,i):null)}function s1(i,a){if(Qp())return null;By(i,a,!0)}function Hv(){ew(function(){(Ie&6)!==0?qt(Lt,Uv):t1()})}function S0(){if(wu===0){var i=y;i===0&&(i=Cn,Cn<<=1,(Cn&261888)===0&&(Cn=256)),wu=i}return wu}function r1(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Ea(""+i)}function a1(i,a){var u=a.ownerDocument.createElement("input");return u.name=a.name,u.value=a.value,i.id&&u.setAttribute("form",i.id),a.parentNode.insertBefore(u,a),i=new FormData(i),u.parentNode.removeChild(u),i}function qv(i,a,u,g,w){if(a==="submit"&&u&&u.stateNode===w){var _=r1((w[Si]||null).action),q=g.submitter;q&&(a=(a=q[Si]||null)?r1(a.formAction):q.getAttribute("formAction"),a!==null&&(_=a,q=null));var ce=new Ka("action","action",null,g,w);i.push({event:ce,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(wu!==0){var Me=q?a1(w,q):new FormData(w);Sf(u,{pending:!0,data:Me,method:w.method,action:_},null,Me)}}else typeof _=="function"&&(ce.preventDefault(),Me=q?a1(w,q):new FormData(w),Sf(u,{pending:!0,data:Me,method:w.method,action:_},_,Me))},currentTarget:w}]})}}for(var A0=0;A0<Pl.length;A0++){var C0=Pl[A0],Vv=C0.toLowerCase(),Wv=C0[0].toUpperCase()+C0.slice(1);hs(Vv,"on"+Wv)}hs(rr,"onAnimationEnd"),hs(Ca,"onAnimationIteration"),hs(kl,"onAnimationStart"),hs("dblclick","onDoubleClick"),hs("focusin","onFocus"),hs("focusout","onBlur"),hs(hl,"onTransitionRun"),hs(Nl,"onTransitionStart"),hs(Jl,"onTransitionCancel"),hs(jl,"onTransitionEnd"),Pa("onMouseEnter",["mouseout","mouseover"]),Pa("onMouseLeave",["mouseout","mouseover"]),Pa("onPointerEnter",["pointerout","pointerover"]),Pa("onPointerLeave",["pointerout","pointerover"]),ma("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ma("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ma("onBeforeInput",["compositionend","keypress","textInput","paste"]),ma("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ma("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ma("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$v=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Hf));function o1(i,a){a=(a&4)!==0;for(var u=0;u<i.length;u++){var g=i[u],w=g.event;g=g.listeners;e:{var _=void 0;if(a)for(var q=g.length-1;0<=q;q--){var ce=g[q],Me=ce.instance,Qe=ce.currentTarget;if(ce=ce.listener,Me!==_&&w.isPropagationStopped())break e;_=ce,w.currentTarget=Qe;try{_(w)}catch(gt){ki(gt)}w.currentTarget=null,_=Me}else for(q=0;q<g.length;q++){if(ce=g[q],Me=ce.instance,Qe=ce.currentTarget,ce=ce.listener,Me!==_&&w.isPropagationStopped())break e;_=ce,w.currentTarget=Qe;try{_(w)}catch(gt){ki(gt)}w.currentTarget=null,_=Me}}}}function Oi(i,a){var u=a[pa];u===void 0&&(u=a[pa]=new Set);var g=i+"__bubble";u.has(g)||(l1(a,i,2,!1),u.add(g))}function T0(i,a,u){var g=0;a&&(g|=4),l1(u,i,g,a)}var ng="_reactListening"+Math.random().toString(36).slice(2);function _0(i){if(!i[ng]){i[ng]=!0,Qo.forEach(function(u){u!=="selectionchange"&&($v.has(u)||T0(u,!1,i),T0(u,!0,i))});var a=i.nodeType===9?i:i.ownerDocument;a===null||a[ng]||(a[ng]=!0,T0("selectionchange",!1,a))}}function l1(i,a,u,g){switch(z1(a)){case 2:var w=vw;break;case 8:w=ww;break;default:w=U0}u=w.bind(null,a,u,i),w=void 0,!_n||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(w=!0),g?w!==void 0?i.addEventListener(a,u,{capture:!0,passive:w}):i.addEventListener(a,u,!0):w!==void 0?i.addEventListener(a,u,{passive:w}):i.addEventListener(a,u,!1)}function k0(i,a,u,g,w){var _=g;if((a&1)===0&&(a&2)===0&&g!==null)e:for(;;){if(g===null)return;var q=g.tag;if(q===3||q===4){var ce=g.stateNode.containerInfo;if(ce===w)break;if(q===4)for(q=g.return;q!==null;){var Me=q.tag;if((Me===3||Me===4)&&q.stateNode.containerInfo===w)return;q=q.return}for(;ce!==null;){if(q=Gn(ce),q===null)return;if(Me=q.tag,Me===5||Me===6||Me===26||Me===27){g=_=q;continue e}ce=ce.parentNode}}g=g.return}Hc(function(){var Qe=_,gt=es(u),St=[];e:{var tt=no.get(i);if(tt!==void 0){var rt=Ka,hn=i;switch(i){case"keypress":if(Ut(u)===0)break e;case"keydown":case"keyup":rt=vi;break;case"focusin":hn="focus",rt=yn;break;case"focusout":hn="blur",rt=yn;break;case"beforeblur":case"afterblur":rt=yn;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":rt=Kl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":rt=Eo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":rt=Ei;break;case rr:case Ca:case kl:rt=j;break;case jl:rt=as;break;case"scroll":case"scrollend":rt=rl;break;case"wheel":rt=jr;break;case"copy":case"cut":case"paste":rt=we;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":rt=ji;break;case"toggle":case"beforetoggle":rt=pr}var $n=(a&4)!==0,Bs=!$n&&(i==="scroll"||i==="scrollend"),Ge=$n?tt!==null?tt+"Capture":null:tt;$n=[];for(var Oe=Qe,Ze;Oe!==null;){var bt=Oe;if(Ze=bt.stateNode,bt=bt.tag,bt!==5&&bt!==26&&bt!==27||Ze===null||Ge===null||(bt=xa(Oe,Ge),bt!=null&&$n.push(qf(Oe,bt,Ze))),Bs)break;Oe=Oe.return}0<$n.length&&(tt=new rt(tt,hn,null,u,gt),St.push({event:tt,listeners:$n}))}}if((a&7)===0){e:{if(tt=i==="mouseover"||i==="pointerover",rt=i==="mouseout"||i==="pointerout",tt&&u!==rs&&(hn=u.relatedTarget||u.fromElement)&&(Gn(hn)||hn[Tr]))break e;if((rt||tt)&&(tt=gt.window===gt?gt:(tt=gt.ownerDocument)?tt.defaultView||tt.parentWindow:window,rt?(hn=u.relatedTarget||u.toElement,rt=Qe,hn=hn?Gn(hn):null,hn!==null&&(Bs=o(hn),$n=hn.tag,hn!==Bs||$n!==5&&$n!==27&&$n!==6)&&(hn=null)):(rt=null,hn=Qe),rt!==hn)){if($n=Kl,bt="onMouseLeave",Ge="onMouseEnter",Oe="mouse",(i==="pointerout"||i==="pointerover")&&($n=ji,bt="onPointerLeave",Ge="onPointerEnter",Oe="pointer"),Bs=rt==null?tt:xi(rt),Ze=hn==null?tt:xi(hn),tt=new $n(bt,Oe+"leave",rt,u,gt),tt.target=Bs,tt.relatedTarget=Ze,bt=null,Gn(gt)===Qe&&($n=new $n(Ge,Oe+"enter",hn,u,gt),$n.target=Ze,$n.relatedTarget=Bs,bt=$n),Bs=bt,rt&&hn)t:{for($n=Gv,Ge=rt,Oe=hn,Ze=0,bt=Ge;bt;bt=$n(bt))Ze++;bt=0;for(var Ln=Oe;Ln;Ln=$n(Ln))bt++;for(;0<Ze-bt;)Ge=$n(Ge),Ze--;for(;0<bt-Ze;)Oe=$n(Oe),bt--;for(;Ze--;){if(Ge===Oe||Oe!==null&&Ge===Oe.alternate){$n=Ge;break t}Ge=$n(Ge),Oe=$n(Oe)}$n=null}else $n=null;rt!==null&&c1(St,tt,rt,$n,!1),hn!==null&&Bs!==null&&c1(St,Bs,hn,$n,!0)}}e:{if(tt=Qe?xi(Qe):window,rt=tt.nodeName&&tt.nodeName.toLowerCase(),rt==="select"||rt==="input"&&tt.type==="file")var gs=po;else if(Lo(tt))if(wa)gs=La;else{gs=ws;var vn=os}else rt=tt.nodeName,!rt||rt.toLowerCase()!=="input"||tt.type!=="checkbox"&&tt.type!=="radio"?Qe&&fr(Qe.elementType)&&(gs=po):gs=id;if(gs&&(gs=gs(i,Qe))){va(St,gs,u,gt);break e}vn&&vn(i,tt,Qe),i==="focusout"&&Qe&&tt.type==="number"&&Qe.memoizedProps.value!=null&&ya(tt,"number",tt.value)}switch(vn=Qe?xi(Qe):window,i){case"focusin":(Lo(vn)||vn.contentEditable==="true")&&(Ma=vn,Bo=Qe,Aa=null);break;case"focusout":Aa=Bo=Ma=null;break;case"mousedown":go=!0;break;case"contextmenu":case"mouseup":case"dragend":go=!1,$i(St,u,gt);break;case"selectionchange":if(qr)break;case"keydown":case"keyup":$i(St,u,gt)}var Ci;if(Hs)e:{switch(i){case"compositionstart":var qi="onCompositionStart";break e;case"compositionend":qi="onCompositionEnd";break e;case"compositionupdate":qi="onCompositionUpdate";break e}qi=void 0}else Qa?wc(i,u)&&(qi="onCompositionEnd"):i==="keydown"&&u.keyCode===229&&(qi="onCompositionStart");qi&&(Ja&&u.locale!=="ko"&&(Qa||qi!=="onCompositionStart"?qi==="onCompositionEnd"&&Qa&&(Ci=Zd()):(rn=gt,oi="value"in rn?rn.value:rn.textContent,Qa=!0)),vn=ig(Qe,qi),0<vn.length&&(qi=new Fe(qi,i,null,u,gt),St.push({event:qi,listeners:vn}),Ci?qi.data=Ci:(Ci=nd(u),Ci!==null&&(qi.data=Ci)))),(Ci=gr?Hr(i,u):Do(i,u))&&(qi=ig(Qe,"onBeforeInput"),0<qi.length&&(vn=new Fe("onBeforeInput","beforeinput",null,u,gt),St.push({event:vn,listeners:qi}),vn.data=Ci)),qv(St,i,Qe,u,gt)}o1(St,a)})}function qf(i,a,u){return{instance:i,listener:a,currentTarget:u}}function ig(i,a){for(var u=a+"Capture",g=[];i!==null;){var w=i,_=w.stateNode;if(w=w.tag,w!==5&&w!==26&&w!==27||_===null||(w=xa(i,u),w!=null&&g.unshift(qf(i,w,_)),w=xa(i,a),w!=null&&g.push(qf(i,w,_))),i.tag===3)return g;i=i.return}return[]}function Gv(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function c1(i,a,u,g,w){for(var _=a._reactName,q=[];u!==null&&u!==g;){var ce=u,Me=ce.alternate,Qe=ce.stateNode;if(ce=ce.tag,Me!==null&&Me===g)break;ce!==5&&ce!==26&&ce!==27||Qe===null||(Me=Qe,w?(Qe=xa(u,_),Qe!=null&&q.unshift(qf(u,Qe,Me))):w||(Qe=xa(u,_),Qe!=null&&q.push(qf(u,Qe,Me)))),u=u.return}q.length!==0&&i.push({event:a,listeners:q})}var Yv=/\r\n?/g,Xv=/\u0000|\uFFFD/g;function d1(i){return(typeof i=="string"?i:""+i).replace(Yv,`
`).replace(Xv,"")}function u1(i,a){return a=d1(a),d1(i)===a}function zs(i,a,u,g,w,_){switch(u){case"children":typeof g=="string"?a==="body"||a==="textarea"&&g===""||Nr(i,g):(typeof g=="number"||typeof g=="bigint")&&a!=="body"&&Nr(i,""+g);break;case"className":nl(i,"class",g);break;case"tabIndex":nl(i,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":nl(i,u,g);break;case"style":Qi(i,g,_);break;case"data":if(a!=="object"){nl(i,"data",g);break}case"src":case"href":if(g===""&&(a!=="a"||u!=="href")){i.removeAttribute(u);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){i.removeAttribute(u);break}g=Ea(""+g),i.setAttribute(u,g);break;case"action":case"formAction":if(typeof g=="function"){i.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(u==="formAction"?(a!=="input"&&zs(i,a,"name",w.name,w,null),zs(i,a,"formEncType",w.formEncType,w,null),zs(i,a,"formMethod",w.formMethod,w,null),zs(i,a,"formTarget",w.formTarget,w,null)):(zs(i,a,"encType",w.encType,w,null),zs(i,a,"method",w.method,w,null),zs(i,a,"target",w.target,w,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){i.removeAttribute(u);break}g=Ea(""+g),i.setAttribute(u,g);break;case"onClick":g!=null&&(i.onclick=co);break;case"onScroll":g!=null&&Oi("scroll",i);break;case"onScrollEnd":g!=null&&Oi("scrollend",i);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(n(61));if(u=g.__html,u!=null){if(w.children!=null)throw Error(n(60));i.innerHTML=u}}break;case"multiple":i.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":i.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){i.removeAttribute("xlink:href");break}u=Ea(""+g),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?i.setAttribute(u,""+g):i.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?i.setAttribute(u,""):i.removeAttribute(u);break;case"capture":case"download":g===!0?i.setAttribute(u,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?i.setAttribute(u,g):i.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?i.setAttribute(u,g):i.removeAttribute(u);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?i.removeAttribute(u):i.setAttribute(u,g);break;case"popover":Oi("beforetoggle",i),Oi("toggle",i),ss(i,"popover",g);break;case"xlinkActuate":Hn(i,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":Hn(i,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":Hn(i,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":Hn(i,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":Hn(i,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":Hn(i,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":Hn(i,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":Hn(i,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":Hn(i,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":ss(i,"is",g);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=Al.get(u)||u,ss(i,u,g))}}function N0(i,a,u,g,w,_){switch(u){case"style":Qi(i,g,_);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(n(61));if(u=g.__html,u!=null){if(w.children!=null)throw Error(n(60));i.innerHTML=u}}break;case"children":typeof g=="string"?Nr(i,g):(typeof g=="number"||typeof g=="bigint")&&Nr(i,""+g);break;case"onScroll":g!=null&&Oi("scroll",i);break;case"onScrollEnd":g!=null&&Oi("scrollend",i);break;case"onClick":g!=null&&(i.onclick=co);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!gi.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(w=u.endsWith("Capture"),a=u.slice(2,w?u.length-7:void 0),_=i[Si]||null,_=_!=null?_[u]:null,typeof _=="function"&&i.removeEventListener(a,_,w),typeof g=="function")){typeof _!="function"&&_!==null&&(u in i?i[u]=null:i.hasAttribute(u)&&i.removeAttribute(u)),i.addEventListener(a,g,w);break e}u in i?i[u]=g:g===!0?i.setAttribute(u,""):ss(i,u,g)}}}function Co(i,a,u){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Oi("error",i),Oi("load",i);var g=!1,w=!1,_;for(_ in u)if(u.hasOwnProperty(_)){var q=u[_];if(q!=null)switch(_){case"src":g=!0;break;case"srcSet":w=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:zs(i,a,_,q,u,null)}}w&&zs(i,a,"srcSet",u.srcSet,u,null),g&&zs(i,a,"src",u.src,u,null);return;case"input":Oi("invalid",i);var ce=_=q=w=null,Me=null,Qe=null;for(g in u)if(u.hasOwnProperty(g)){var gt=u[g];if(gt!=null)switch(g){case"name":w=gt;break;case"type":q=gt;break;case"checked":Me=gt;break;case"defaultChecked":Qe=gt;break;case"value":_=gt;break;case"defaultValue":ce=gt;break;case"children":case"dangerouslySetInnerHTML":if(gt!=null)throw Error(n(137,a));break;default:zs(i,a,g,gt,u,null)}}bc(i,_,ce,Me,Qe,q,w,!1);return;case"select":Oi("invalid",i),g=q=_=null;for(w in u)if(u.hasOwnProperty(w)&&(ce=u[w],ce!=null))switch(w){case"value":_=ce;break;case"defaultValue":q=ce;break;case"multiple":g=ce;default:zs(i,a,w,ce,u,null)}a=_,u=q,i.multiple=!!g,a!=null?kr(i,!!g,a,!1):u!=null&&kr(i,!!g,u,!0);return;case"textarea":Oi("invalid",i),_=w=g=null;for(q in u)if(u.hasOwnProperty(q)&&(ce=u[q],ce!=null))switch(q){case"value":g=ce;break;case"defaultValue":w=ce;break;case"children":_=ce;break;case"dangerouslySetInnerHTML":if(ce!=null)throw Error(n(91));break;default:zs(i,a,q,ce,u,null)}Ya(i,g,w,_);return;case"option":for(Me in u)if(u.hasOwnProperty(Me)&&(g=u[Me],g!=null))switch(Me){case"selected":i.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:zs(i,a,Me,g,u,null)}return;case"dialog":Oi("beforetoggle",i),Oi("toggle",i),Oi("cancel",i),Oi("close",i);break;case"iframe":case"object":Oi("load",i);break;case"video":case"audio":for(g=0;g<Hf.length;g++)Oi(Hf[g],i);break;case"image":Oi("error",i),Oi("load",i);break;case"details":Oi("toggle",i);break;case"embed":case"source":case"link":Oi("error",i),Oi("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Qe in u)if(u.hasOwnProperty(Qe)&&(g=u[Qe],g!=null))switch(Qe){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:zs(i,a,Qe,g,u,null)}return;default:if(fr(a)){for(gt in u)u.hasOwnProperty(gt)&&(g=u[gt],g!==void 0&&N0(i,a,gt,g,u,void 0));return}}for(ce in u)u.hasOwnProperty(ce)&&(g=u[ce],g!=null&&zs(i,a,ce,g,u,null))}function Kv(i,a,u,g){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var w=null,_=null,q=null,ce=null,Me=null,Qe=null,gt=null;for(rt in u){var St=u[rt];if(u.hasOwnProperty(rt)&&St!=null)switch(rt){case"checked":break;case"value":break;case"defaultValue":Me=St;default:g.hasOwnProperty(rt)||zs(i,a,rt,null,g,St)}}for(var tt in g){var rt=g[tt];if(St=u[tt],g.hasOwnProperty(tt)&&(rt!=null||St!=null))switch(tt){case"type":_=rt;break;case"name":w=rt;break;case"checked":Qe=rt;break;case"defaultChecked":gt=rt;break;case"value":q=rt;break;case"defaultValue":ce=rt;break;case"children":case"dangerouslySetInnerHTML":if(rt!=null)throw Error(n(137,a));break;default:rt!==St&&zs(i,a,tt,rt,g,St)}}Xl(i,q,ce,Me,Qe,gt,_,w);return;case"select":rt=q=ce=tt=null;for(_ in u)if(Me=u[_],u.hasOwnProperty(_)&&Me!=null)switch(_){case"value":break;case"multiple":rt=Me;default:g.hasOwnProperty(_)||zs(i,a,_,null,g,Me)}for(w in g)if(_=g[w],Me=u[w],g.hasOwnProperty(w)&&(_!=null||Me!=null))switch(w){case"value":tt=_;break;case"defaultValue":ce=_;break;case"multiple":q=_;default:_!==Me&&zs(i,a,w,_,g,Me)}a=ce,u=q,g=rt,tt!=null?kr(i,!!u,tt,!1):!!g!=!!u&&(a!=null?kr(i,!!u,a,!0):kr(i,!!u,u?[]:"",!1));return;case"textarea":rt=tt=null;for(ce in u)if(w=u[ce],u.hasOwnProperty(ce)&&w!=null&&!g.hasOwnProperty(ce))switch(ce){case"value":break;case"children":break;default:zs(i,a,ce,null,g,w)}for(q in g)if(w=g[q],_=u[q],g.hasOwnProperty(q)&&(w!=null||_!=null))switch(q){case"value":tt=w;break;case"defaultValue":rt=w;break;case"children":break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(n(91));break;default:w!==_&&zs(i,a,q,w,g,_)}sl(i,tt,rt);return;case"option":for(var hn in u)if(tt=u[hn],u.hasOwnProperty(hn)&&tt!=null&&!g.hasOwnProperty(hn))switch(hn){case"selected":i.selected=!1;break;default:zs(i,a,hn,null,g,tt)}for(Me in g)if(tt=g[Me],rt=u[Me],g.hasOwnProperty(Me)&&tt!==rt&&(tt!=null||rt!=null))switch(Me){case"selected":i.selected=tt&&typeof tt!="function"&&typeof tt!="symbol";break;default:zs(i,a,Me,tt,g,rt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var $n in u)tt=u[$n],u.hasOwnProperty($n)&&tt!=null&&!g.hasOwnProperty($n)&&zs(i,a,$n,null,g,tt);for(Qe in g)if(tt=g[Qe],rt=u[Qe],g.hasOwnProperty(Qe)&&tt!==rt&&(tt!=null||rt!=null))switch(Qe){case"children":case"dangerouslySetInnerHTML":if(tt!=null)throw Error(n(137,a));break;default:zs(i,a,Qe,tt,g,rt)}return;default:if(fr(a)){for(var Bs in u)tt=u[Bs],u.hasOwnProperty(Bs)&&tt!==void 0&&!g.hasOwnProperty(Bs)&&N0(i,a,Bs,void 0,g,tt);for(gt in g)tt=g[gt],rt=u[gt],!g.hasOwnProperty(gt)||tt===rt||tt===void 0&&rt===void 0||N0(i,a,gt,tt,g,rt);return}}for(var Ge in u)tt=u[Ge],u.hasOwnProperty(Ge)&&tt!=null&&!g.hasOwnProperty(Ge)&&zs(i,a,Ge,null,g,tt);for(St in g)tt=g[St],rt=u[St],!g.hasOwnProperty(St)||tt===rt||tt==null&&rt==null||zs(i,a,St,tt,g,rt)}function h1(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Zv(){if(typeof performance.getEntriesByType=="function"){for(var i=0,a=0,u=performance.getEntriesByType("resource"),g=0;g<u.length;g++){var w=u[g],_=w.transferSize,q=w.initiatorType,ce=w.duration;if(_&&ce&&h1(q)){for(q=0,ce=w.responseEnd,g+=1;g<u.length;g++){var Me=u[g],Qe=Me.startTime;if(Qe>ce)break;var gt=Me.transferSize,St=Me.initiatorType;gt&&h1(St)&&(Me=Me.responseEnd,q+=gt*(Me<ce?1:(ce-Qe)/(Me-Qe)))}if(--g,a+=8*(_+q)/(w.duration/1e3),i++,10<i)break}}if(0<i)return a/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var j0=null,P0=null;function sg(i){return i.nodeType===9?i:i.ownerDocument}function f1(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function p1(i,a){if(i===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&a==="foreignObject"?0:i}function E0(i,a){return i==="textarea"||i==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var R0=null;function Jv(){var i=window.event;return i&&i.type==="popstate"?i===R0?!1:(R0=i,!0):(R0=null,!1)}var g1=typeof setTimeout=="function"?setTimeout:void 0,Qv=typeof clearTimeout=="function"?clearTimeout:void 0,m1=typeof Promise=="function"?Promise:void 0,ew=typeof queueMicrotask=="function"?queueMicrotask:typeof m1<"u"?function(i){return m1.resolve(null).then(i).catch(tw)}:g1;function tw(i){setTimeout(function(){throw i})}function Su(i){return i==="head"}function y1(i,a){var u=a,g=0;do{var w=u.nextSibling;if(i.removeChild(u),w&&w.nodeType===8)if(u=w.data,u==="/$"||u==="/&"){if(g===0){i.removeChild(w),Yh(a);return}g--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")g++;else if(u==="html")Vf(i.ownerDocument.documentElement);else if(u==="head"){u=i.ownerDocument.head,Vf(u);for(var _=u.firstChild;_;){var q=_.nextSibling,ce=_.nodeName;_[Wa]||ce==="SCRIPT"||ce==="STYLE"||ce==="LINK"&&_.rel.toLowerCase()==="stylesheet"||u.removeChild(_),_=q}}else u==="body"&&Vf(i.ownerDocument.body);u=w}while(u);Yh(a)}function x1(i,a){var u=i;i=0;do{var g=u.nextSibling;if(u.nodeType===1?a?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(a?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),g&&g.nodeType===8)if(u=g.data,u==="/$"){if(i===0)break;i--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||i++;u=g}while(u)}function D0(i){var a=i.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var u=a;switch(a=a.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":D0(u),jo(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}i.removeChild(u)}}function nw(i,a,u,g){for(;i.nodeType===1;){var w=u;if(i.nodeName.toLowerCase()!==a.toLowerCase()){if(!g&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(g){if(!i[Wa])switch(a){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(_=i.getAttribute("rel"),_==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(_!==w.rel||i.getAttribute("href")!==(w.href==null||w.href===""?null:w.href)||i.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin)||i.getAttribute("title")!==(w.title==null?null:w.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(_=i.getAttribute("src"),(_!==(w.src==null?null:w.src)||i.getAttribute("type")!==(w.type==null?null:w.type)||i.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin))&&_&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(a==="input"&&i.type==="hidden"){var _=w.name==null?null:""+w.name;if(w.type==="hidden"&&i.getAttribute("name")===_)return i}else return i;if(i=Dc(i.nextSibling),i===null)break}return null}function iw(i,a,u){if(a==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!u||(i=Dc(i.nextSibling),i===null))return null;return i}function b1(i,a){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!a||(i=Dc(i.nextSibling),i===null))return null;return i}function L0(i){return i.data==="$?"||i.data==="$~"}function M0(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function sw(i,a){var u=i.ownerDocument;if(i.data==="$~")i._reactRetry=a;else if(i.data!=="$?"||u.readyState!=="loading")a();else{var g=function(){a(),u.removeEventListener("DOMContentLoaded",g)};u.addEventListener("DOMContentLoaded",g),i._reactRetry=g}}function Dc(i){for(;i!=null;i=i.nextSibling){var a=i.nodeType;if(a===1||a===3)break;if(a===8){if(a=i.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return i}var I0=null;function v1(i){i=i.nextSibling;for(var a=0;i;){if(i.nodeType===8){var u=i.data;if(u==="/$"||u==="/&"){if(a===0)return Dc(i.nextSibling);a--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||a++}i=i.nextSibling}return null}function w1(i){i=i.previousSibling;for(var a=0;i;){if(i.nodeType===8){var u=i.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(a===0)return i;a--}else u!=="/$"&&u!=="/&"||a++}i=i.previousSibling}return null}function S1(i,a,u){switch(a=sg(u),i){case"html":if(i=a.documentElement,!i)throw Error(n(452));return i;case"head":if(i=a.head,!i)throw Error(n(453));return i;case"body":if(i=a.body,!i)throw Error(n(454));return i;default:throw Error(n(451))}}function Vf(i){for(var a=i.attributes;a.length;)i.removeAttributeNode(a[0]);jo(i)}var Lc=new Map,A1=new Set;function rg(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var qd=ee.d;ee.d={f:rw,r:aw,D:ow,C:lw,L:cw,m:dw,X:hw,S:uw,M:fw};function rw(){var i=qd.f(),a=Kp();return i||a}function aw(i){var a=Fr(i);a!==null&&a.tag===5&&a.type==="form"?Rp(a):qd.r(i)}var Wh=typeof document>"u"?null:document;function C1(i,a,u){var g=Wh;if(g&&typeof a=="string"&&a){var w=bi(a);w='link[rel="'+i+'"][href="'+w+'"]',typeof u=="string"&&(w+='[crossorigin="'+u+'"]'),A1.has(w)||(A1.add(w),i={rel:i,crossOrigin:u,href:a},g.querySelector(w)===null&&(a=g.createElement("link"),Co(a,"link",i),Rn(a),g.head.appendChild(a)))}}function ow(i){qd.D(i),C1("dns-prefetch",i,null)}function lw(i,a){qd.C(i,a),C1("preconnect",i,a)}function cw(i,a,u){qd.L(i,a,u);var g=Wh;if(g&&i&&a){var w='link[rel="preload"][as="'+bi(a)+'"]';a==="image"&&u&&u.imageSrcSet?(w+='[imagesrcset="'+bi(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(w+='[imagesizes="'+bi(u.imageSizes)+'"]')):w+='[href="'+bi(i)+'"]';var _=w;switch(a){case"style":_=$h(i);break;case"script":_=Gh(i)}Lc.has(_)||(i=b({rel:"preload",href:a==="image"&&u&&u.imageSrcSet?void 0:i,as:a},u),Lc.set(_,i),g.querySelector(w)!==null||a==="style"&&g.querySelector(Wf(_))||a==="script"&&g.querySelector($f(_))||(a=g.createElement("link"),Co(a,"link",i),Rn(a),g.head.appendChild(a)))}}function dw(i,a){qd.m(i,a);var u=Wh;if(u&&i){var g=a&&typeof a.as=="string"?a.as:"script",w='link[rel="modulepreload"][as="'+bi(g)+'"][href="'+bi(i)+'"]',_=w;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=Gh(i)}if(!Lc.has(_)&&(i=b({rel:"modulepreload",href:i},a),Lc.set(_,i),u.querySelector(w)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector($f(_)))return}g=u.createElement("link"),Co(g,"link",i),Rn(g),u.head.appendChild(g)}}}function uw(i,a,u){qd.S(i,a,u);var g=Wh;if(g&&i){var w=ga(g).hoistableStyles,_=$h(i);a=a||"default";var q=w.get(_);if(!q){var ce={loading:0,preload:null};if(q=g.querySelector(Wf(_)))ce.loading=5;else{i=b({rel:"stylesheet",href:i,"data-precedence":a},u),(u=Lc.get(_))&&z0(i,u);var Me=q=g.createElement("link");Rn(Me),Co(Me,"link",i),Me._p=new Promise(function(Qe,gt){Me.onload=Qe,Me.onerror=gt}),Me.addEventListener("load",function(){ce.loading|=1}),Me.addEventListener("error",function(){ce.loading|=2}),ce.loading|=4,ag(q,a,g)}q={type:"stylesheet",instance:q,count:1,state:ce},w.set(_,q)}}}function hw(i,a){qd.X(i,a);var u=Wh;if(u&&i){var g=ga(u).hoistableScripts,w=Gh(i),_=g.get(w);_||(_=u.querySelector($f(w)),_||(i=b({src:i,async:!0},a),(a=Lc.get(w))&&B0(i,a),_=u.createElement("script"),Rn(_),Co(_,"link",i),u.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},g.set(w,_))}}function fw(i,a){qd.M(i,a);var u=Wh;if(u&&i){var g=ga(u).hoistableScripts,w=Gh(i),_=g.get(w);_||(_=u.querySelector($f(w)),_||(i=b({src:i,async:!0,type:"module"},a),(a=Lc.get(w))&&B0(i,a),_=u.createElement("script"),Rn(_),Co(_,"link",i),u.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},g.set(w,_))}}function T1(i,a,u,g){var w=(w=Te.current)?rg(w):null;if(!w)throw Error(n(446));switch(i){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(a=$h(u.href),u=ga(w).hoistableStyles,g=u.get(a),g||(g={type:"style",instance:null,count:0,state:null},u.set(a,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){i=$h(u.href);var _=ga(w).hoistableStyles,q=_.get(i);if(q||(w=w.ownerDocument||w,q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(i,q),(_=w.querySelector(Wf(i)))&&!_._p&&(q.instance=_,q.state.loading=5),Lc.has(i)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Lc.set(i,u),_||pw(w,i,u,q.state))),a&&g===null)throw Error(n(528,""));return q}if(a&&g!==null)throw Error(n(529,""));return null;case"script":return a=u.async,u=u.src,typeof u=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Gh(u),u=ga(w).hoistableScripts,g=u.get(a),g||(g={type:"script",instance:null,count:0,state:null},u.set(a,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,i))}}function $h(i){return'href="'+bi(i)+'"'}function Wf(i){return'link[rel="stylesheet"]['+i+"]"}function _1(i){return b({},i,{"data-precedence":i.precedence,precedence:null})}function pw(i,a,u,g){i.querySelector('link[rel="preload"][as="style"]['+a+"]")?g.loading=1:(a=i.createElement("link"),g.preload=a,a.addEventListener("load",function(){return g.loading|=1}),a.addEventListener("error",function(){return g.loading|=2}),Co(a,"link",u),Rn(a),i.head.appendChild(a))}function Gh(i){return'[src="'+bi(i)+'"]'}function $f(i){return"script[async]"+i}function k1(i,a,u){if(a.count++,a.instance===null)switch(a.type){case"style":var g=i.querySelector('style[data-href~="'+bi(u.href)+'"]');if(g)return a.instance=g,Rn(g),g;var w=b({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return g=(i.ownerDocument||i).createElement("style"),Rn(g),Co(g,"style",w),ag(g,u.precedence,i),a.instance=g;case"stylesheet":w=$h(u.href);var _=i.querySelector(Wf(w));if(_)return a.state.loading|=4,a.instance=_,Rn(_),_;g=_1(u),(w=Lc.get(w))&&z0(g,w),_=(i.ownerDocument||i).createElement("link"),Rn(_);var q=_;return q._p=new Promise(function(ce,Me){q.onload=ce,q.onerror=Me}),Co(_,"link",g),a.state.loading|=4,ag(_,u.precedence,i),a.instance=_;case"script":return _=Gh(u.src),(w=i.querySelector($f(_)))?(a.instance=w,Rn(w),w):(g=u,(w=Lc.get(_))&&(g=b({},u),B0(g,w)),i=i.ownerDocument||i,w=i.createElement("script"),Rn(w),Co(w,"link",g),i.head.appendChild(w),a.instance=w);case"void":return null;default:throw Error(n(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(g=a.instance,a.state.loading|=4,ag(g,u.precedence,i));return a.instance}function ag(i,a,u){for(var g=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),w=g.length?g[g.length-1]:null,_=w,q=0;q<g.length;q++){var ce=g[q];if(ce.dataset.precedence===a)_=ce;else if(_!==w)break}_?_.parentNode.insertBefore(i,_.nextSibling):(a=u.nodeType===9?u.head:u,a.insertBefore(i,a.firstChild))}function z0(i,a){i.crossOrigin==null&&(i.crossOrigin=a.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=a.referrerPolicy),i.title==null&&(i.title=a.title)}function B0(i,a){i.crossOrigin==null&&(i.crossOrigin=a.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=a.referrerPolicy),i.integrity==null&&(i.integrity=a.integrity)}var og=null;function N1(i,a,u){if(og===null){var g=new Map,w=og=new Map;w.set(u,g)}else w=og,g=w.get(u),g||(g=new Map,w.set(u,g));if(g.has(i))return g;for(g.set(i,null),u=u.getElementsByTagName(i),w=0;w<u.length;w++){var _=u[w];if(!(_[Wa]||_[Ti]||i==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var q=_.getAttribute(a)||"";q=i+q;var ce=g.get(q);ce?ce.push(_):g.set(q,[_])}}return g}function j1(i,a,u){i=i.ownerDocument||i,i.head.insertBefore(u,a==="title"?i.querySelector("head > title"):null)}function gw(i,a,u){if(u===1||a.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return i=a.disabled,typeof a.precedence=="string"&&i==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function P1(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function mw(i,a,u,g){if(u.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var w=$h(g.href),_=a.querySelector(Wf(w));if(_){a=_._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(i.count++,i=lg.bind(i),a.then(i,i)),u.state.loading|=4,u.instance=_,Rn(_);return}_=a.ownerDocument||a,g=_1(g),(w=Lc.get(w))&&z0(g,w),_=_.createElement("link"),Rn(_);var q=_;q._p=new Promise(function(ce,Me){q.onload=ce,q.onerror=Me}),Co(_,"link",g),u.instance=_}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(u,a),(a=u.state.preload)&&(u.state.loading&3)===0&&(i.count++,u=lg.bind(i),a.addEventListener("load",u),a.addEventListener("error",u))}}var O0=0;function yw(i,a){return i.stylesheets&&i.count===0&&dg(i,i.stylesheets),0<i.count||0<i.imgCount?function(u){var g=setTimeout(function(){if(i.stylesheets&&dg(i,i.stylesheets),i.unsuspend){var _=i.unsuspend;i.unsuspend=null,_()}},6e4+a);0<i.imgBytes&&O0===0&&(O0=62500*Zv());var w=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&dg(i,i.stylesheets),i.unsuspend)){var _=i.unsuspend;i.unsuspend=null,_()}},(i.imgBytes>O0?50:800)+a);return i.unsuspend=u,function(){i.unsuspend=null,clearTimeout(g),clearTimeout(w)}}:null}function lg(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)dg(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var cg=null;function dg(i,a){i.stylesheets=null,i.unsuspend!==null&&(i.count++,cg=new Map,a.forEach(xw,i),cg=null,lg.call(i))}function xw(i,a){if(!(a.state.loading&4)){var u=cg.get(i);if(u)var g=u.get(null);else{u=new Map,cg.set(i,u);for(var w=i.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<w.length;_++){var q=w[_];(q.nodeName==="LINK"||q.getAttribute("media")!=="not all")&&(u.set(q.dataset.precedence,q),g=q)}g&&u.set(null,g)}w=a.instance,q=w.getAttribute("data-precedence"),_=u.get(q)||g,_===g&&u.set(null,w),u.set(q,w),this.count++,g=lg.bind(this),w.addEventListener("load",g),w.addEventListener("error",g),_?_.parentNode.insertBefore(w,_.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(w,i.firstChild)),a.state.loading|=4}}var Gf={$$typeof:I,Provider:null,Consumer:null,_currentValue:ae,_currentValue2:ae,_threadCount:0};function bw(i,a,u,g,w,_,q,ce,Me){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Br(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Br(0),this.hiddenUpdates=Br(null),this.identifierPrefix=g,this.onUncaughtError=w,this.onCaughtError=_,this.onRecoverableError=q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Me,this.incompleteTransitions=new Map}function E1(i,a,u,g,w,_,q,ce,Me,Qe,gt,St){return i=new bw(i,a,u,q,Me,Qe,gt,St,ce),a=1,_===!0&&(a|=24),_=ia(3,null,null,a),i.current=_,_.stateNode=i,a=ra(),a.refCount++,i.pooledCache=a,a.refCount++,_.memoizedState={element:g,isDehydrated:u,cache:a},Mt(_),i}function R1(i){return i?(i=Er,i):Er}function D1(i,a,u,g,w,_){w=R1(w),g.context===null?g.context=w:g.pendingContext=w,g=En(a),g.payload={element:u},_=_===void 0?null:_,_!==null&&(g.callback=_),u=qn(i,g,a),u!==null&&(ql(u,i,a),ri(u,i,a))}function L1(i,a){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var u=i.retryLane;i.retryLane=u!==0&&u<a?u:a}}function F0(i,a){L1(i,a),(i=i.alternate)&&L1(i,a)}function M1(i){if(i.tag===13||i.tag===31){var a=Oo(i,67108864);a!==null&&ql(a,i,67108864),F0(i,67108864)}}function I1(i){if(i.tag===13||i.tag===31){var a=fc();a=pi(a);var u=Oo(i,a);u!==null&&ql(u,i,a),F0(i,a)}}var ug=!0;function vw(i,a,u,g){var w=V.T;V.T=null;var _=ee.p;try{ee.p=2,U0(i,a,u,g)}finally{ee.p=_,V.T=w}}function ww(i,a,u,g){var w=V.T;V.T=null;var _=ee.p;try{ee.p=8,U0(i,a,u,g)}finally{ee.p=_,V.T=w}}function U0(i,a,u,g){if(ug){var w=H0(g);if(w===null)k0(i,a,g,hg,u),B1(i,g);else if(Aw(w,i,a,u,g))g.stopPropagation();else if(B1(i,g),a&4&&-1<Sw.indexOf(i)){for(;w!==null;){var _=Fr(w);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var q=bn(_.pendingLanes);if(q!==0){var ce=_;for(ce.pendingLanes|=2,ce.entangledLanes|=2;q;){var Me=1<<31-lt(q);ce.entanglements[1]|=Me,q&=~Me}md(_),(Ie&6)===0&&(Yp=sn()+500,Uf(0))}}break;case 31:case 13:ce=Oo(_,2),ce!==null&&ql(ce,_,2),Kp(),F0(_,2)}if(_=H0(g),_===null&&k0(i,a,g,hg,u),_===w)break;w=_}w!==null&&g.stopPropagation()}else k0(i,a,g,null,u)}}function H0(i){return i=es(i),q0(i)}var hg=null;function q0(i){if(hg=null,i=Gn(i),i!==null){var a=o(i);if(a===null)i=null;else{var u=a.tag;if(u===13){if(i=d(a),i!==null)return i;i=null}else if(u===31){if(i=c(a),i!==null)return i;i=null}else if(u===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;i=null}else a!==i&&(i=null)}}return hg=i,null}function z1(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(kt()){case Lt:return 2;case Jn:return 8;case pt:case jt:return 32;case Fn:return 268435456;default:return 32}default:return 32}}var V0=!1,Au=null,Cu=null,Tu=null,Yf=new Map,Xf=new Map,_u=[],Sw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function B1(i,a){switch(i){case"focusin":case"focusout":Au=null;break;case"dragenter":case"dragleave":Cu=null;break;case"mouseover":case"mouseout":Tu=null;break;case"pointerover":case"pointerout":Yf.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xf.delete(a.pointerId)}}function Kf(i,a,u,g,w,_){return i===null||i.nativeEvent!==_?(i={blockedOn:a,domEventName:u,eventSystemFlags:g,nativeEvent:_,targetContainers:[w]},a!==null&&(a=Fr(a),a!==null&&M1(a)),i):(i.eventSystemFlags|=g,a=i.targetContainers,w!==null&&a.indexOf(w)===-1&&a.push(w),i)}function Aw(i,a,u,g,w){switch(a){case"focusin":return Au=Kf(Au,i,a,u,g,w),!0;case"dragenter":return Cu=Kf(Cu,i,a,u,g,w),!0;case"mouseover":return Tu=Kf(Tu,i,a,u,g,w),!0;case"pointerover":var _=w.pointerId;return Yf.set(_,Kf(Yf.get(_)||null,i,a,u,g,w)),!0;case"gotpointercapture":return _=w.pointerId,Xf.set(_,Kf(Xf.get(_)||null,i,a,u,g,w)),!0}return!1}function O1(i){var a=Gn(i.target);if(a!==null){var u=o(a);if(u!==null){if(a=u.tag,a===13){if(a=d(u),a!==null){i.blockedOn=a,Ji(i.priority,function(){I1(u)});return}}else if(a===31){if(a=c(u),a!==null){i.blockedOn=a,Ji(i.priority,function(){I1(u)});return}}else if(a===3&&u.stateNode.current.memoizedState.isDehydrated){i.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}i.blockedOn=null}function fg(i){if(i.blockedOn!==null)return!1;for(var a=i.targetContainers;0<a.length;){var u=H0(i.nativeEvent);if(u===null){u=i.nativeEvent;var g=new u.constructor(u.type,u);rs=g,u.target.dispatchEvent(g),rs=null}else return a=Fr(u),a!==null&&M1(a),i.blockedOn=u,!1;a.shift()}return!0}function F1(i,a,u){fg(i)&&u.delete(a)}function Cw(){V0=!1,Au!==null&&fg(Au)&&(Au=null),Cu!==null&&fg(Cu)&&(Cu=null),Tu!==null&&fg(Tu)&&(Tu=null),Yf.forEach(F1),Xf.forEach(F1)}function pg(i,a){i.blockedOn===a&&(i.blockedOn=null,V0||(V0=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Cw)))}var gg=null;function U1(i){gg!==i&&(gg=i,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){gg===i&&(gg=null);for(var a=0;a<i.length;a+=3){var u=i[a],g=i[a+1],w=i[a+2];if(typeof g!="function"){if(q0(g||u)===null)continue;break}var _=Fr(u);_!==null&&(i.splice(a,3),a-=3,Sf(_,{pending:!0,data:w,method:u.method,action:g},g,w))}}))}function Yh(i){function a(Me){return pg(Me,i)}Au!==null&&pg(Au,i),Cu!==null&&pg(Cu,i),Tu!==null&&pg(Tu,i),Yf.forEach(a),Xf.forEach(a);for(var u=0;u<_u.length;u++){var g=_u[u];g.blockedOn===i&&(g.blockedOn=null)}for(;0<_u.length&&(u=_u[0],u.blockedOn===null);)O1(u),u.blockedOn===null&&_u.shift();if(u=(i.ownerDocument||i).$$reactFormReplay,u!=null)for(g=0;g<u.length;g+=3){var w=u[g],_=u[g+1],q=w[Si]||null;if(typeof _=="function")q||U1(u);else if(q){var ce=null;if(_&&_.hasAttribute("formAction")){if(w=_,q=_[Si]||null)ce=q.formAction;else if(q0(w)!==null)continue}else ce=q.action;typeof ce=="function"?u[g+1]=ce:(u.splice(g,3),g-=3),U1(u)}}}function H1(){function i(_){_.canIntercept&&_.info==="react-transition"&&_.intercept({handler:function(){return new Promise(function(q){return w=q})},focusReset:"manual",scroll:"manual"})}function a(){w!==null&&(w(),w=null),g||setTimeout(u,20)}function u(){if(!g&&!navigation.transition){var _=navigation.currentEntry;_&&_.url!=null&&navigation.navigate(_.url,{state:_.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,w=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(u,100),function(){g=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),w!==null&&(w(),w=null)}}}function W0(i){this._internalRoot=i}mg.prototype.render=W0.prototype.render=function(i){var a=this._internalRoot;if(a===null)throw Error(n(409));var u=a.current,g=fc();D1(u,g,i,a,null,null)},mg.prototype.unmount=W0.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var a=i.containerInfo;D1(i.current,2,null,i,null,null),Kp(),a[Tr]=null}};function mg(i){this._internalRoot=i}mg.prototype.unstable_scheduleHydration=function(i){if(i){var a=vs();i={blockedOn:null,target:i,priority:a};for(var u=0;u<_u.length&&a!==0&&a<_u[u].priority;u++);_u.splice(u,0,i),u===0&&O1(i)}};var q1=e.version;if(q1!=="19.2.0")throw Error(n(527,q1,"19.2.0"));ee.findDOMNode=function(i){var a=i._reactInternals;if(a===void 0)throw typeof i.render=="function"?Error(n(188)):(i=Object.keys(i).join(","),Error(n(268,i)));return i=f(a),i=i!==null?m(i):null,i=i===null?null:i.stateNode,i};var Tw={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:V,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yg.isDisabled&&yg.supportsFiber)try{Pn=yg.inject(Tw),dn=yg}catch{}}return Jf.createRoot=function(i,a){if(!s(i))throw Error(n(299));var u=!1,g="",w=Mp,_=Ip,q=Gu;return a!=null&&(a.unstable_strictMode===!0&&(u=!0),a.identifierPrefix!==void 0&&(g=a.identifierPrefix),a.onUncaughtError!==void 0&&(w=a.onUncaughtError),a.onCaughtError!==void 0&&(_=a.onCaughtError),a.onRecoverableError!==void 0&&(q=a.onRecoverableError)),a=E1(i,1,!1,null,null,u,g,null,w,_,q,H1),i[Tr]=a.current,_0(i),new W0(a)},Jf.hydrateRoot=function(i,a,u){if(!s(i))throw Error(n(299));var g=!1,w="",_=Mp,q=Ip,ce=Gu,Me=null;return u!=null&&(u.unstable_strictMode===!0&&(g=!0),u.identifierPrefix!==void 0&&(w=u.identifierPrefix),u.onUncaughtError!==void 0&&(_=u.onUncaughtError),u.onCaughtError!==void 0&&(q=u.onCaughtError),u.onRecoverableError!==void 0&&(ce=u.onRecoverableError),u.formState!==void 0&&(Me=u.formState)),a=E1(i,1,!0,a,u??null,g,w,Me,_,q,ce,H1),a.context=R1(null),u=a.current,g=fc(),g=pi(g),w=En(g),w.callback=null,qn(u,w,g),u=g,a.current.lanes=u,en(a,u),md(a),i[Tr]=a.current,_0(i),new mg(a)},Jf.version="19.2.0",Jf}var tx;function Iw(){if(tx)return X0.exports;tx=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),X0.exports=Mw(),X0.exports}var zw=Iw();/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bw=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ow=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),nx=r=>{const e=Ow(r);return e.charAt(0).toUpperCase()+e.slice(1)},Jb=(...r)=>r.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim(),Fw=r=>{for(const e in r)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Uw={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hw=X.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:s="",children:o,iconNode:d,...c},h)=>X.createElement("svg",{ref:h,...Uw,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:Jb("lucide",s),...!o&&!Fw(c)&&{"aria-hidden":"true"},...c},[...d.map(([f,m])=>X.createElement(f,m)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qb=(r,e)=>{const t=X.forwardRef(({className:n,...s},o)=>X.createElement(Hw,{ref:o,iconNode:e,className:Jb(`lucide-${Bw(nx(r))}`,`lucide-${r}`,n),...s}));return t.displayName=nx(r),t};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qw=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],Vw=Qb("mouse-pointer",qw);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ww=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],$w=Qb("pen-line",Ww),Gw=JSON.parse('[{"category":"Capacitors","subcategory":"General","type":"Capacitor","displayName":"Capacitor","description":"General purpose capacitor","searchText":"capacitor general","designator":"C","defaultPins":2,"properties":{"capacitorType":"General"},"fields":[{"name":"capacitance","label":"Capacitance","type":"number","units":["pF","nF","F","mF","F"],"defaultUnit":"F","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"tolerance","label":"Tolerance","type":"string","required":false},{"name":"dielectric","label":"Dielectric","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Capacitors","subcategory":"Electrolytic","type":"Capacitor","displayName":"Electrolytic","description":"Electrolytic capacitor","searchText":"electrolytic capacitor","designator":"CE","defaultPins":2,"properties":{"capacitorType":"Electrolytic","polarized":true},"fields":[{"name":"capacitance","label":"Capacitance","type":"number","units":["pF","nF","F","mF","F"],"defaultUnit":"F","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"tolerance","label":"Tolerance","type":"string","defaultValue":"20%","required":false},{"name":"esr","label":"ESR","type":"number","units":["m",""],"defaultUnit":"","required":false},{"name":"temperature","label":"Temperature Range","type":"string","required":false},{"name":"ripple","label":"Ripple Current","type":"number","units":["mA","A"],"defaultUnit":"mA","required":false},{"name":"leakageCurrent","label":"Leakage Current","type":"number","units":["A","mA"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Capacitors","subcategory":"Film","type":"Capacitor","displayName":"Film","description":"Film capacitor","searchText":"film capacitor","designator":"CF","defaultPins":2,"properties":{"capacitorType":"Film"},"fields":[{"name":"capacitance","label":"Capacitance","type":"number","units":["pF","nF","F","mF","F"],"defaultUnit":"nF","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"tolerance","label":"Tolerance","type":"string","defaultValue":"10%","required":false},{"name":"filmType","label":"Film Type","type":"enum","enumValues":["Polyester","Polypropylene","Polyethylene","Polystyrene","Teflon"],"defaultValue":"Polyester","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Capacitors","subcategory":"Tantalum","type":"Capacitor","displayName":"Tantalum","description":"Tantalum capacitor","searchText":"tantalum capacitor","designator":"C","defaultPins":2,"properties":{"capacitorType":"Tantalum","dielectric":"Tantalum","polarized":true},"fields":[{"name":"capacitance","label":"Capacitance","type":"number","units":["pF","nF","F","mF","F"],"defaultUnit":"F","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"tolerance","label":"Tolerance","type":"string","required":false},{"name":"esr","label":"ESR","type":"number","units":["m",""],"defaultUnit":"","required":false},{"name":"leakageCurrent","label":"Leakage Current","type":"number","units":["A","mA"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Diodes","subcategory":"Standard","type":"Diode","displayName":"Diode","description":"Standard diode","searchText":"diode standard","designator":"D","defaultPins":2,"subtype":"Standard","properties":{"diodeType":"Standard","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"Zener","type":"Diode","displayName":"Zener","description":"Zener diode","searchText":"zener diode","designator":"Z","defaultPins":2,"subtype":"Zener","properties":{"diodeType":"Zener","polarized":true},"fields":[{"name":"voltage","label":"Zener Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"mA","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"LED","type":"Diode","displayName":"LED","description":"LED diode","searchText":"led diode","designator":"LED","defaultPins":2,"subtype":"LED","properties":{"diodeType":"LED","polarized":true},"fields":[{"name":"voltage","label":"Forward Voltage","type":"number","units":["mV","V"],"defaultUnit":"V","required":false},{"name":"current","label":"Forward Current","type":"number","units":["mA","A"],"defaultUnit":"mA","required":false},{"name":"ledColor","label":"Color","type":"string","required":false},{"name":"wavelength","label":"Wavelength","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"Schottky","type":"Diode","displayName":"Schottky","description":"Schottky diode","searchText":"schottky diode","designator":"D","defaultPins":2,"subtype":"Schottky","properties":{"diodeType":"Schottky","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"Infrared","type":"Diode","displayName":"Infrared","description":"Infrared diode","searchText":"infrared diode","designator":"IR","defaultPins":2,"subtype":"Infrared","properties":{"diodeType":"Infrared","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["mA","A"],"defaultUnit":"mA","required":false},{"name":"wavelength","label":"Wavelength","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"Photodiode","type":"Diode","displayName":"Photodiode","description":"Photodiode","searchText":"photodiode diode","designator":"PD","defaultPins":2,"subtype":"Photodiode","properties":{"diodeType":"Photodiode","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"wavelength","label":"Wavelength","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Resistors","subcategory":"Standard","type":"Resistor","displayName":"Resistor","description":"Standard resistor","searchText":"resistor standard","designator":"R","defaultPins":2,"properties":{"resistorType":"Standard"},"fields":[{"name":"resistance","label":"Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"tolerance","label":"Tolerance","type":"string","defaultValue":"5%","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Resistors","subcategory":"Network","type":"Resistor","displayName":"Resistor Network","description":"Resistor network","searchText":"resistor network","designator":"RN","defaultPins":8,"properties":{"resistorType":"Network"},"fields":[{"name":"resistance","label":"Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"configuration","label":"Configuration","type":"enum","enumValues":["Isolated","Bussed","Dual Terminator"],"defaultValue":"Isolated","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Resistors","subcategory":"Thermistor","type":"Resistor","displayName":"Thermistor","description":"Thermistor resistor","searchText":"thermistor resistor","designator":"RT","defaultPins":2,"properties":{"resistorType":"Thermistor"},"fields":[{"name":"resistance","label":"Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"thermistorType","label":"Thermistor Type","type":"enum","enumValues":["NTC","PTC"],"defaultValue":"NTC","required":false},{"name":"beta","label":"Beta Value","type":"number","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Resistors","subcategory":"Variable","type":"Resistor","displayName":"Variable Resistor","description":"Variable resistor","searchText":"variable resistor","designator":"VR","defaultPins":3,"subtype":"Potentiometer","properties":{"resistorType":"Variable","vrType":"Potentiometer"},"fields":[{"name":"resistance","label":"Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"taper","label":"Taper","type":"enum","enumValues":["Linear","Logarithmic"],"defaultValue":"Linear","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Resistors","subcategory":"Varistor","type":"Resistor","displayName":"Varistor","description":"Varistor resistor","searchText":"varistor resistor","designator":"RV","defaultPins":3,"subtype":"Varistor","properties":{"resistorType":"Variable","vrType":"Varistor"},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"BJT","type":"Semiconductor","displayName":"BJT","description":"Bipolar Junction Transistor (Base, Emitter, Collector)","searchText":"bjt transistor bipolar junction base emitter collector npn pnp","designator":"Q","defaultPins":3,"properties":{"semiconductorType":"Transistor","transistorType":"BJT","pinNames":["Base","Emitter","Collector"]},"fields":[{"name":"polarity","label":"Polarity","type":"enum","enumValues":["NPN","PNP"],"defaultValue":"NPN","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"MOSFET","type":"Semiconductor","displayName":"MOSFET","description":"Metal-Oxide-Semiconductor Field-Effect Transistor (Source, Gate, Drain)","searchText":"mosfet transistor metal oxide semiconductor field effect source gate drain n-channel p-channel","designator":"Q","defaultPins":3,"properties":{"semiconductorType":"Transistor","transistorType":"MOSFET","pinNames":["Source","Gate","Drain"]},"fields":[{"name":"polarity","label":"Polarity","type":"enum","enumValues":["N-Channel","P-Channel"],"defaultValue":"N-Channel","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"JFET","type":"Semiconductor","displayName":"JFET","description":"Junction Field-Effect Transistor (Source, Gate, Drain)","searchText":"jfet transistor junction field effect source gate drain n-channel p-channel","designator":"Q","defaultPins":3,"properties":{"semiconductorType":"Transistor","transistorType":"JFET","pinNames":["Source","Gate","Drain"]},"fields":[{"name":"polarity","label":"Polarity","type":"enum","enumValues":["N-Channel","P-Channel"],"defaultValue":"N-Channel","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"Single Op Amp","type":"Semiconductor","displayName":"Single Op Amp","description":"Single operational amplifier","searchText":"single op amp operational amplifier opamp","designator":"U","defaultPins":5,"properties":{"semiconductorType":"OpAmp","pinNames":["V+","V-","input+","input-","output"]},"fields":[{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"packageType","label":"Package Type","type":"enum","enumValues":["SOT-23-5","SC70-5","Other"],"defaultValue":"SOT-23-5","required":false},{"name":"voltage","label":"Supply Voltage","type":"number","units":["V","mV"],"defaultUnit":"V","required":false},{"name":"description","label":"Description","type":"string","required":false},{"name":"datasheet","label":"Datasheet URL","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"Dual Op Amp","type":"Semiconductor","displayName":"Dual Op Amp","description":"Dual operational amplifier","searchText":"dual op amp operational amplifier opamp","designator":"U","defaultPins":8,"properties":{"semiconductorType":"OpAmp","pinNames":["A Output","A -Input","A +Input","V-","B +Input","B -Input","B Output","V+"]},"fields":[{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"packageType","label":"Package Type","type":"enum","enumValues":["DIP-8","SOIC-8","DIP-14","SOIC-14","SOT-23-5","Other"],"defaultValue":"DIP-8","required":false},{"name":"voltage","label":"Supply Voltage","type":"number","units":["V","mV"],"defaultUnit":"V","required":false},{"name":"description","label":"Description","type":"string","required":false},{"name":"datasheet","label":"Datasheet URL","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"Integrated Circuit","type":"Semiconductor","displayName":"Integrated Circuit","description":"Integrated circuit","searchText":"integrated circuit semiconductor ic","designator":"U","defaultPins":8,"properties":{"semiconductorType":"IntegratedCircuit","pinNames":["CHIP_DEPENDENT"]},"fields":[{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"icType","label":"IC Type","type":"string","required":false},{"name":"packageType","label":"Package Type","type":"enum","enumValues":["DIP","SOIC","QFP","BGA","TQFP","SSOP","TSOP"],"required":false},{"name":"description","label":"Description","type":"string","required":false},{"name":"datasheet","label":"Datasheet URL","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Passive Components","subcategory":"Inductor","type":"Inductor","displayName":"Inductor","description":"Inductor","searchText":"inductor","designator":"L","defaultPins":2,"properties":{"passiveType":"Inductor"},"fields":[{"name":"inductance","label":"Inductance","type":"number","units":["nH","H","mH","H"],"defaultUnit":"H","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"resistance","label":"DC Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Passive Components","subcategory":"Ferrite Bead","type":"FerriteBead","displayName":"Ferrite Bead","description":"Ferrite bead","searchText":"ferrite bead passive","designator":"FB","defaultPins":2,"properties":{"passiveType":"FerriteBead"},"fields":[{"name":"impedance","label":"Impedance","type":"number","units":["","m","k"],"defaultUnit":"","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Passive Components","subcategory":"Crystal","type":"Crystal","displayName":"Crystal","description":"Crystal oscillator","searchText":"crystal oscillator passive","designator":"X","defaultPins":2,"properties":{"passiveType":"Crystal"},"fields":[{"name":"frequency","label":"Frequency","type":"string","required":false},{"name":"loadCapacitance","label":"Load Capacitance","type":"string","required":false},{"name":"tolerance","label":"Tolerance","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Power & Energy","subcategory":"Battery","type":"PowerEnergy","displayName":"Battery","description":"Battery or battery holder","searchText":"battery power energy","designator":"B","defaultPins":2,"properties":{"powerType":"Battery","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"capacity","label":"Capacity","type":"number","units":["mAh","Ah"],"defaultUnit":"mAh","required":false},{"name":"chemistry","label":"Chemistry","type":"enum","enumValues":["Li-ion","Alkaline","NiMH","NiCd","Lead-acid"],"required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Power & Energy","subcategory":"Power Supply","type":"PowerEnergy","displayName":"Power Supply","description":"Power supply","searchText":"power supply energy","designator":"PS","defaultPins":4,"properties":{"powerType":"PowerSupply"},"fields":[{"name":"inputVoltage","label":"Input Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"outputVoltage","label":"Output Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"efficiency","label":"Efficiency","type":"number","required":false},{"name":"ripple","label":"Ripple","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Power & Energy","subcategory":"Fuse","type":"PowerEnergy","displayName":"Fuse","description":"Fuse","searchText":"fuse power energy","designator":"F","defaultPins":2,"properties":{"powerType":"Fuse"},"fields":[{"name":"current","label":"Current Rating","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"fuseType","label":"Fuse Type","type":"enum","enumValues":["Fast-blow","Slow-blow","Time-delay"],"defaultValue":"Fast-blow","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Connectors & Switches","subcategory":"Connector","type":"Connector","displayName":"Connector","description":"Connector","searchText":"connector","designator":"J","defaultPins":4,"properties":{"connectorType":"Connector"},"fields":[{"name":"connectorType","label":"Connector Type","type":"string","required":false},{"name":"gender","label":"Gender","type":"enum","enumValues":["Male","Female","N/A"],"defaultValue":"N/A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Connectors & Switches","subcategory":"Jumper","type":"Jumper","displayName":"Jumper","description":"Jumper link","searchText":"jumper link","designator":"JP","defaultPins":3,"properties":{"connectorType":"Jumper"},"fields":[{"name":"positions","label":"Positions","type":"number","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Connectors & Switches","subcategory":"Switch","type":"Switch","displayName":"Switch","description":"Switch","searchText":"switch","designator":"S","defaultPins":2,"properties":{"switchType":"Switch"},"fields":[{"name":"switchType","label":"Switch Type","type":"string","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Connectors & Switches","subcategory":"Relay","type":"Relay","displayName":"Relay","description":"Relay or contactor","searchText":"relay contactor","designator":"K","defaultPins":5,"properties":{"switchType":"Relay"},"fields":[{"name":"coilVoltage","label":"Coil Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"contactType","label":"Contact Type","type":"string","required":false},{"name":"current","label":"Contact Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Other","subcategory":"Transformer","type":"Transformer","displayName":"Transformer","description":"Transformer","searchText":"transformer","designator":"TR","defaultPins":4,"fields":[{"name":"primaryVoltage","label":"Primary Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"secondaryVoltage","label":"Secondary Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"turns","label":"Turns Ratio","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Speaker","type":"Speaker","displayName":"Speaker","description":"Loudspeaker or buzzer","searchText":"speaker loudspeaker buzzer","designator":"LS","defaultPins":2,"fields":[{"name":"impedance","label":"Impedance","type":"number","units":["","m","k"],"defaultUnit":"","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Motor","type":"Motor","displayName":"Motor","description":"Motor","searchText":"motor","designator":"M","defaultPins":2,"fields":[{"name":"motorType","label":"Motor Type","type":"string","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Test Point","type":"TestPoint","displayName":"Test Point","description":"Test point","searchText":"test point","designator":"TP","defaultPins":1,"fields":[{"name":"signal","label":"Signal","type":"string","required":false}]},{"category":"Other","subcategory":"Vacuum Tube","type":"VacuumTube","displayName":"Vacuum Tube","description":"Vacuum tube","searchText":"vacuum tube","designator":"V","defaultPins":5,"fields":[{"name":"tubeType","label":"Tube Type","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Attenuator","type":"GenericComponent","displayName":"Attenuator","description":"Attenuator or isolator","searchText":"attenuator isolator component","designator":"AT","defaultPins":2,"subtype":"Attenuator","fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Circuit Breaker","type":"GenericComponent","displayName":"Circuit Breaker","description":"Circuit breaker","searchText":"circuit breaker component","designator":"CB","defaultPins":2,"subtype":"CircuitBreaker","fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Thermocouple","type":"GenericComponent","displayName":"Thermocouple","description":"Thermocouple","searchText":"thermocouple component","designator":"TC","defaultPins":2,"subtype":"Thermocouple","fields":[{"name":"model","label":"Model","type":"string","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Tuner","type":"GenericComponent","displayName":"Tuner","description":"Tuner","searchText":"tuner component","designator":"TUN","defaultPins":2,"subtype":"Tuner","fields":[{"name":"frequency","label":"Frequency","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]}]'),i0={components:Gw},Yw=["#FFFFFF","#BFBFBF","#7F7F7F","#3C3C3C","#000000","#A6CEE3","#56B4E9","#17BECF","#00BFC4","#1F77B4","#0072B2","#332288","#B2DF8A","#B3DE69","#2CA02C","#009E73","#FFED6F","#F0E442","#BCBD22","#E69F00","#FF7F0E","#FB9A99","#F781BF","#E15759","#D62728","#CAB2D6","#CC79A7","#AA4499","#6A3D9A","#9467BD","#9C755F","#8C564B"],Q0="#2CA02C",Xw="#F0E442",Kw="#00BFC4",em="#000000",Zw="#00008b",tm="#FF0000",py={DEFAULT_SIZE:18},lp={};i0.components.forEach(r=>{const e=r.type,t=r.designator;if(!lp[e])lp[e]={prefix:[t],defaultPins:r.defaultPins};else{const n=lp[e],s=[...new Set([...n.prefix,t])];lp[e]={prefix:s,defaultPins:n.defaultPins}}});const gy=lp,Xh={};i0.components.forEach(r=>{if(Xh[r.category]||(Xh[r.category]={}),!Xh[r.category][r.subcategory])Xh[r.category][r.subcategory]=[r.type];else{const e=Xh[r.category][r.subcategory];e.includes(r.type)||(Xh[r.category][r.subcategory]=[...e,r.type])}});const nm={DEFAULT_SIZE:18},e2={resistance:{validUnits:["","m","k","M"],defaultUnit:""},capacitance:{validUnits:["pF","nF","F","mF","F"],defaultUnit:"F"},voltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},current:{validUnits:["A","mA","A"],defaultUnit:"A"},power:{validUnits:["W","mW","kW"],defaultUnit:"W"},inductance:{validUnits:["nH","H","mH","H"],defaultUnit:"H"},impedance:{validUnits:["","m","k"],defaultUnit:""},capacity:{validUnits:["mAh","Ah"],defaultUnit:"mAh"},inputVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},outputVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},coilVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},primaryVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},secondaryVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},esr:{validUnits:["m",""],defaultUnit:""}};function Xi(r){return e2[r]?.validUnits||[]}function Yt(r){return e2[r]?.defaultUnit||""}function yc(r){return r.includes(" ")?r:r.replace(/([a-z])([A-Z])/g,"$1 $2")}const Ha=Math.PI*2;function t2(r){return(r%360+360)%360}function Kd(r){return r*Math.PI/180}function Jw(r){return r*180/Math.PI}function Om(r,e){return t2(r+e)}function Yg(r){return Math.tan(r)}function Qw(r){return Math.cos(r)}function e5(r){return Math.sin(r)}function t5(r,e){return Math.atan2(r,e)}function n5(r,e){return Jw(t5(e,r))}function Fm(r,e){const{x:t,y:n,rotation:s=0,scale:o=1,flipX:d=!1,flipY:c=!1,skewX:h=0,skewY:f=0}=e;if(r.translate(t,n),s!==0&&r.rotate(Kd(s)),h!==0||f!==0){const S=Yg(h),v=Yg(f);r.transform(1,v,S,1,0,0)}const m=o*(d?-1:1),b=o*(c?-1:1);(m!==1||b!==1)&&r.scale(m,b)}function ix(r,e,t,n=0,s=!1,o=!1){Fm(r,{x:e,y:t,rotation:n,flipX:s,flipY:o})}function n2(r,e,t){const n=Kd(t),s=Qw(n),o=e5(n);return{x:r*s-e*o,y:r*o+e*s}}function i5(r,e=0,t=!1){t&&r.scale(-1,1),e!==0&&r.rotate(Kd(e))}function s5(r,e=0,t=!1){const n=t2(e),s=n===90||n===270;t&&r.scale(-1,1),e!==0&&r.rotate(Kd(-e)),t&&s&&r.rotate(Kd(180))}function sx(r,e,t,n=0,s=!1){let o=r/t,d=e/t;if(n!==0){const c=n2(o,d,-n);o=c.x,d=c.y}return s&&(o=-o),{x:o,y:d}}function Qf(r,e,t,n,s=0,o=!1){let d=r-t.x,c=e-t.y;if(d=d/n,c=c/n,o&&(d=-d),s!==0){const h=n2(d,c,-s);d=h.x,c=h.y}return{x:d,y:c}}function r5(r,e=.4){if(r.startsWith("#")){const n=r.slice(1),s=parseInt(n.slice(0,2),16),o=parseInt(n.slice(2,4),16),d=parseInt(n.slice(4,6),16),c=Math.max(0,Math.floor(s*(1-e))),h=Math.max(0,Math.floor(o*(1-e))),f=Math.max(0,Math.floor(d*(1-e)));return`#${c.toString(16).padStart(2,"0")}${h.toString(16).padStart(2,"0")}${f.toString(16).padStart(2,"0")}`}const t=r.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*[\d.]+)?\)/);if(t){const n=parseInt(t[1],10),s=parseInt(t[2],10),o=parseInt(t[3],10),d=t[4]?t[4].trim():"",c=Math.max(0,Math.floor(n*(1-e))),h=Math.max(0,Math.floor(s*(1-e))),f=Math.max(0,Math.floor(o*(1-e)));return r.includes("rgba")?`rgba(${c}, ${h}, ${f}${d?`, ${d}`:", 1"})`:`rgb(${c}, ${h}, ${f})`}return r}let wl=1;const Oc=new Set;function Xc(){const r=wl;if(wl++,Oc.has(r)){for(console.error(`CRITICAL ERROR: Duplicate Node ID ${r} would be allocated!`),console.error(`Current counter: ${wl}, Allocated IDs count: ${Oc.size}`);Oc.has(wl);)wl++;const e=wl;return wl++,Oc.add(e),console.error(`Recovered by allocating ID ${e} instead`),e}return Oc.add(r),r}function xg(r){r<1&&(console.warn(`setPointIdCounter called with invalid value ${r}, using 1`),r=1),wl=r,Oc.clear()}function im(){return wl}function rx(){wl=1,Oc.clear()}function sm(r){r>0&&(Oc.add(r),r>=wl&&(wl=r+1))}function bg(r){if(r>0&&Oc.has(r))if(Oc.delete(r),Oc.size>0){const e=Math.max(...Array.from(Oc));e<wl&&(wl=Math.max(1,e+1))}else wl=1}function a5(r="id"){return`${r}-${Date.now()}-${Math.random().toString(36).slice(2,11)}`}function ax(r){return Math.round(r*1e4)/1e4}function is(r){return{x:ax(r.x),y:ax(r.y)}}const Du=i0.components;Du.map(r=>({designator:r.designator,componentType:r.description}));function _d(r){if(!r)return;const e=r.componentDefinitionKey;if(e){const n=Du.find(s=>`${s.category}:${s.subcategory}:${s.type}`===e);if(n)return n}if(typeof r.designator=="string"&&r.designator.trim()!==""){const n=r.designator.trim().match(/^[A-Za-z]+/),s=n?n[0]:null;if(s){const o=Du.find(d=>Array.isArray(d.designators)&&d.designators.includes(s));if(o)return o}}const t=r.componentType==="Electrolytic Capacitor"||r.componentType==="Film Capacitor"?"Capacitor":r.componentType;return Du.find(n=>{if(n.type!==t)return!1;if(n.category==="Capacitors"){const s=r.capacitorType||r.dielectric;return!!(s&&n.properties?.capacitorType===s||!s)}if(n.category==="Diodes"){const s=r.diodeType;return!!(s&&n.properties?.diodeType===s||!n.properties?.diodeType)}if(n.category==="Resistors"){const s=r.resistorType,o=r.vrType;return!!(s&&n.properties?.resistorType===s||o&&n.properties?.vrType===o||!n.properties?.resistorType&&!n.properties?.vrType)}if(n.category==="Semiconductors"){const s=r.semiconductorType;return!!(s&&n.properties?.semiconductorType===s||!n.properties?.semiconductorType)}if(n.category==="Passive Components"){const s=r.passiveType;return!!(s&&n.properties?.passiveType===s||!n.properties?.passiveType)}if(n.category==="Power & Energy"){const s=r.powerType;return!!(s&&n.properties?.powerType===s||!n.properties?.powerType)}if(n.category==="Connectors & Switches"){const s=r.connectorType,o=r.switchType;return!!(s&&n.properties?.connectorType===s||o&&n.properties?.switchType===o||!n.properties?.connectorType&&!n.properties?.switchType)}if(r.componentType==="GenericComponent"){const s=r.genericType;return!!(s&&n.subtype===s)}return!0})}function o5(r){return(gy[r]?.prefix||["?"])[0]}function Sp(r){return _d(r)?.properties?.polarized===!0}function Um(r,e,t){if(!Sp(r)||r.pinCount!==2||!(e.length===2&&e[0]&&e[0].trim()!==""&&e[1]&&e[1].trim()!==""))return null;const s=m=>{const b=parseInt(m,10);if(isNaN(b))return null;for(const S of t)if((S.type==="via"||S.type==="pad")&&S.points.length>0){const v=S.points[0];if(v.id===b)return{x:v.x,y:v.y}}return null},o=s(e[0]),d=s(e[1]);if(!o||!d)return null;const c=Math.hypot(r.x-o.x,r.y-o.y),h=Math.hypot(r.x-d.x,r.y-d.y),f=["",""];return c<h?(f[0]="-",f[1]="+"):(f[0]="+",f[1]="-"),f}function rm(){return{}}function l5(r){}function c5(r,e,t){const n={...t};return n[r]=Math.max(n[r]||0,e),n}function d5(r){if(r.designator&&r.designator.trim()!=="")return r.designator.trim();switch(r.baseType){case"Capacitor":return"C";case"Diode":return"D";case"Resistor":return"R";case"Semiconductor":return"Q";case"Passive":return"L";case"PowerEnergy":return"PS";case"Connector":return"J";case"Switch":return"S";case"Transformer":return"T";case"Other":default:return"?"}}function u5(r,e,t){let n=0;for(const d of e){if(!d.designator||!d.designator.startsWith(r))continue;const c=parseInt(d.designator.slice(r.length),10);!isNaN(c)&&c>n&&(n=c)}const o=(t[r]??n)+1;return t[r]=o,o}function h5(r,e,t){const n=d5(r),s=u5(n,e,t);return`${n}${s}`}function f5(r){const{definition:e,layer:t,x:n,y:s,color:o,size:d,designator:c,existingComponents:h=[],counters:f={}}=r,m=d&&d>0?d:py.DEFAULT_SIZE,b=c||h5(e,h,f),S={id:a5("comp"),componentType:e.type,designator:b,layer:t,x:n,y:s,color:o,size:m,pinCount:e.defaultPins,pinConnections:new Array(e.defaultPins).fill(""),pinPolarities:void 0,notes:null,orientation:0,flipX:!1,flipY:!1,description:e.description};if(S.componentDefinitionKey=e.key,e.properties&&Object.assign(S,e.properties),e.properties?.pinNames&&Array.isArray(e.properties.pinNames)){const v=e.properties.pinNames;v.includes("CHIP_DEPENDENT")?S.pinNames=new Array(S.pinCount).fill(""):S.pinNames=new Array(S.pinCount).fill("").map((x,k)=>k<v.length?v[k]:"")}return e.fields&&e.fields.length>0&&e.fields.forEach(v=>{v.defaultValue!==void 0&&v.defaultValue!==""&&(S[v.name]=v.defaultValue),v.units&&v.defaultUnit&&(S[`${v.name}Unit`]=v.defaultUnit)}),S}function p5(){const r=document.createElement("canvas"),e=24;r.width=e,r.height=e;const t=r.getContext("2d");t.strokeStyle="#000",t.lineWidth=3,t.lineCap="round";const n=e/2,s=8;return t.beginPath(),t.moveTo(n,n-s),t.lineTo(n,n-2),t.moveTo(n,n+2),t.lineTo(n,n+s),t.moveTo(n-s,n),t.lineTo(n-2,n),t.moveTo(n+2,n),t.lineTo(n+s,n),t.stroke(),`url(${r.toDataURL()}) ${n} ${n}, crosshair`}function g5(r){const e=document.createElement("canvas"),t=Math.max(12,Math.min(r,32)),s=t+4*2;e.width=s,e.height=s;const o=e.getContext("2d"),d=s/2,c=s/2,h=t/2;return o.fillStyle="#FFFF00",o.strokeStyle="#000000",o.lineWidth=2,o.beginPath(),o.moveTo(d,c-h),o.lineTo(d+h,c),o.lineTo(d,c+h),o.lineTo(d-h,c),o.closePath(),o.fill(),o.stroke(),`url(${e.toDataURL()}) ${d} ${c}, crosshair`}function ox(){const r=new Date,e=r.getFullYear(),t=String(r.getMonth()+1).padStart(2,"0"),n=String(r.getDate()).padStart(2,"0"),s=String(r.getHours()).padStart(2,"0"),o=String(r.getMinutes()).padStart(2,"0"),d=String(r.getSeconds()).padStart(2,"0");return`${e}_${t}_${n}-${s}-${o}-${d}`}function Qu(r){let e=r.replace(/\.json$/i,""),t="";for(;t!==e;)t=e,e=e.replace(/_\d{4}_\d{2}_\d{2}-\d{2}-\d{2}-\d{2}$/,""),e=e.replace(/_\d{4}_\d{2}_\d{2}_\d{2}_\d{2}_\d{2}$/,"");return e}function di(r,e,t,n){if(e==="power"){const o=r[e]||"";return typeof o=="string"&&o.trim()!==""?{value:o.replace(/W$/i,"").trim(),unit:"W"}:{value:"",unit:"W"}}if(r[e]!==void 0||r[t]!==void 0)return{value:r[e]||"",unit:r[t]||n};const s=r[e]||"";return typeof s=="string"&&s.trim()!==""?i2(s):{value:"",unit:n}}function i2(r){if(!r||r.trim()==="")return{value:"",unit:""};const e=r.trim(),t=e.match(/^([\d]+\/[\d]+)\s*([a-zA-ZuW]+)?$/);if(t)return{value:t[1],unit:t[2]||""};const n=e.match(/^([\d.]+)\s*([a-zA-ZuW]+)?$/);return n?{value:n[1],unit:n[2]||""}:{value:e,unit:""}}function eh(r,e){return!r||r.trim()===""?"":!e||e.trim()===""?r.trim():`${r.trim()}${e.trim()}`}function m5(){const[r,e]=X.useState([]),[t,n]=X.useState([]),[s,o]=X.useState(null),[d,c]=X.useState(null),[h,f]=X.useState(null),[m,b]=X.useState(!1),[S,v]=X.useState(null),P=X.useCallback((I,z)=>{z==="top"?e(B=>[...B,I]):n(B=>[...B,I])},[]),x=X.useCallback((I,z,B)=>{B==="top"?e(G=>G.map(te=>te.id===I?{...te,...z}:te)):n(G=>G.map(te=>te.id===I?{...te,...z}:te))},[]),k=X.useCallback((I,z)=>{z==="top"?e(B=>B.filter(G=>G.id!==I)):n(B=>B.filter(G=>G.id!==I))},[]),N=X.useCallback((I,z)=>{if(!I){console.error("[openComponentEditor] Component is null or undefined");return}if(!I.id||typeof I.id!="string"){console.error("[openComponentEditor] Component missing valid id property:",{component:I});return}const B=I.id;if(!I.componentType||typeof I.componentType!="string"){console.error("[openComponentEditor] Component missing valid componentType property:",{componentId:B,component:I});return}const G=I.componentType;if(typeof I.pinCount!="number"||I.pinCount<0){console.error("[openComponentEditor] Component missing valid pinCount property:",{componentId:B,componentType:G,pinCount:I.pinCount,component:I});return}if(z!=="top"&&z!=="bottom"){console.error("[openComponentEditor] Invalid layer parameter:",{layer:z,componentId:I.id});return}const te=I.designator||"",F=I.abbreviation||(te.length>0?te.charAt(0).toUpperCase():""),H=I.componentType,Q={visible:!0,layer:z,id:I.id,designator:te,abbreviation:F,manufacturer:"manufacturer"in I&&I.manufacturer||"",partNumber:"partNumber"in I&&I.partNumber||"",pinCount:I.pinCount,x:I.x,y:I.y,orientation:I.orientation??0,description:I.description||"",datasheet:I.datasheet||"",componentDefinitionKey:I.componentDefinitionKey||""};if(H==="Resistor"){const T=I,R=di(T,"resistance","resistanceUnit",Yt("resistance"));Q.resistance=R.value,Q.resistanceUnit=R.unit;const Z=di(T,"power","powerUnit","W");Q.power=Z.value||"1/4",Q.tolerance=T.tolerance||"5%"}else if(H==="Capacitor"){const T=I,R=di(T,"capacitance","capacitanceUnit",Yt("capacitance"));Q.capacitance=R.value,Q.capacitanceUnit=R.unit;const Z=di(T,"voltage","voltageUnit",Yt("voltage"));Q.voltage=Z.value,Q.voltageUnit=Z.unit,Q.tolerance=T.tolerance||"10%",Q.dielectric=T.dielectric||"Ceramic"}else if(H==="Electrolytic Capacitor"){const T=I,R=di(T,"capacitance","capacitanceUnit",Yt("capacitance"));Q.capacitance=R.value,Q.capacitanceUnit=R.unit;const Z=di(T,"voltage","voltageUnit",Yt("voltage"));Q.voltage=Z.value,Q.voltageUnit=Z.unit,Q.tolerance=T.tolerance||"20%",Q.polarized=T.polarized!==void 0?T.polarized:!0;const se=di(T,"esr","esrUnit",Yt("esr"));Q.esr=se.value,Q.esrUnit=se.unit,Q.temperature=T.temperature||""}else if(H==="Film Capacitor"){const T=I,R=di(T,"capacitance","capacitanceUnit",Yt("capacitance"));Q.capacitance=R.value,Q.capacitanceUnit=R.unit;const Z=di(T,"voltage","voltageUnit",Yt("voltage"));Q.voltage=Z.value,Q.voltageUnit=Z.unit,Q.tolerance=T.tolerance||"10%",Q.filmType=T.filmType||"Polyester"}else if(H==="Diode"){const T=I;Q.diodeType=T.diodeType||"Standard";const R=di(T,"voltage","voltageUnit",Yt("voltage"));Q.voltage=R.value,Q.voltageUnit=R.unit;const Z=di(T,"current","currentUnit",Yt("current"));Q.current=Z.value,Q.currentUnit=Z.unit,Q.ledColor=T.ledColor||""}else if(H==="Battery"){const T=I,R=di(T,"voltage","voltageUnit",Yt("voltage"));Q.voltage=R.value,Q.voltageUnit=R.unit;const Z=di(T,"capacity","capacityUnit",Yt("capacity"));Q.capacity=Z.value,Q.capacityUnit=Z.unit,Q.chemistry=T.chemistry||"Li-ion"}else if(H==="Fuse"){const T=I,R=di(T,"current","currentUnit",Yt("current"));Q.current=R.value,Q.currentUnit=R.unit;const Z=di(T,"voltage","voltageUnit",Yt("voltage"));Q.voltage=Z.value,Q.voltageUnit=Z.unit,Q.fuseType=T.fuseType||"Fast-blow"}else if(H==="FerriteBead"){const T=I,R=di(T,"impedance","impedanceUnit",Yt("impedance"));Q.impedance=R.value,Q.impedanceUnit=R.unit;const Z=di(T,"current","currentUnit",Yt("current"));Q.current=Z.value,Q.currentUnit=Z.unit}else if(H==="Connector"){const T=I;Q.connectorType=T.connectorType||"",Q.gender=T.gender||"N/A"}else if(H==="Jumper"){const T=I;Q.positions=T.positions||3}else if(H==="Relay"){const T=I,R=di(T,"coilVoltage","coilVoltageUnit",Yt("coilVoltage"));Q.coilVoltage=R.value,Q.coilVoltageUnit=R.unit,Q.contactType=T.contactType||"SPST";const Z=di(T,"current","currentUnit",Yt("current"));Q.current=Z.value,Q.currentUnit=Z.unit}else if(H==="Inductor"){const T=I,R=di(T,"inductance","inductanceUnit",Yt("inductance"));Q.inductance=R.value,Q.inductanceUnit=R.unit;const Z=di(T,"current","currentUnit",Yt("current"));Q.current=Z.value,Q.currentUnit=Z.unit;const se=di(T,"resistance","resistanceUnit",Yt("resistance"));Q.resistance=se.value,Q.resistanceUnit=se.unit}else if(H==="Speaker"){const T=I,R=di(T,"impedance","impedanceUnit",Yt("impedance"));Q.impedance=R.value,Q.impedanceUnit=R.unit;const Z=di(T,"power","powerUnit","W");Q.power=Z.value||"1"}else if(H==="Motor"){const T=I;Q.motorType=T.motorType||"DC";const R=di(T,"voltage","voltageUnit",Yt("voltage"));Q.voltage=R.value,Q.voltageUnit=R.unit;const Z=di(T,"current","currentUnit",Yt("current"));Q.current=Z.value,Q.currentUnit=Z.unit}else if(H==="PowerSupply"){const T=I,R=di(T,"inputVoltage","inputVoltageUnit",Yt("inputVoltage"));Q.inputVoltage=R.value,Q.inputVoltageUnit=R.unit;const Z=di(T,"outputVoltage","outputVoltageUnit",Yt("outputVoltage"));Q.outputVoltage=Z.value,Q.outputVoltageUnit=Z.unit;const se=di(T,"current","currentUnit",Yt("current"));Q.current=se.value,Q.currentUnit=se.unit}else if(H==="Transistor"){const T=I;Q.transistorType=T.transistorType||"BJT",Q.polarity=T.polarity||"NPN";const R=di(T,"voltage","voltageUnit",Yt("voltage"));Q.voltage=R.value,Q.voltageUnit=R.unit;const Z=di(T,"current","currentUnit",Yt("current"));Q.current=Z.value,Q.currentUnit=Z.unit}else if(H==="ResistorNetwork"){const T=I,R=di(T,"resistance","resistanceUnit",Yt("resistance"));Q.resistance=R.value,Q.resistanceUnit=R.unit,Q.configuration=T.configuration||""}else if(H==="Thermistor"){const T=I,R=di(T,"resistance","resistanceUnit",Yt("resistance"));Q.resistance=R.value,Q.resistanceUnit=R.unit,Q.thermistorType=T.thermistorType||"NTC",Q.beta=T.beta||""}else if(H==="Switch"){const T=I;Q.switchType=T.switchType||"Toggle";const R=di(T,"current","currentUnit",Yt("current"));Q.current=R.value,Q.currentUnit=R.unit;const Z=di(T,"voltage","voltageUnit",Yt("voltage"));Q.voltage=Z.value,Q.voltageUnit=Z.unit}else if(H==="Transformer"){const T=I,R=di(T,"primaryVoltage","primaryVoltageUnit",Yt("primaryVoltage"));Q.primaryVoltage=R.value,Q.primaryVoltageUnit=R.unit;const Z=di(T,"secondaryVoltage","secondaryVoltageUnit",Yt("secondaryVoltage"));Q.secondaryVoltage=Z.value,Q.secondaryVoltageUnit=Z.unit;const se=di(T,"power","powerUnit",Yt("power"));Q.power=se.value||"1",Q.turns=T.turns||""}else if(H==="TestPoint"){const T=I;Q.signal=T.signal||""}else if(H==="IntegratedCircuit"||H==="Semiconductor"){const T=I;Q.description=T.description||I.designator||"",Q.datasheet=T.datasheet||"",console.log("[useComponents] Loading IC component - datasheet from component:",T.datasheet,"editor datasheet:",Q.datasheet),Q.icType=T.icType||"Op-Amp"}else if(H==="VacuumTube"){const T=I;Q.tubeType=T.tubeType||""}else if(H==="VariableResistor"){const T=I;Q.vrType=T.vrType||"Potentiometer";const R=di(T,"resistance","resistanceUnit",Yt("resistance"));Q.resistance=R.value,Q.resistanceUnit=R.unit;const Z=di(T,"power","powerUnit",Yt("power"));Q.power=Z.value||"1/4",Q.taper=T.taper||""}else if(H==="Crystal"){const T=I;Q.frequency=T.frequency||"",Q.loadCapacitance=T.loadCapacitance||"",Q.tolerance=T.tolerance||""}else if(H==="Diode"){const T=I;Q.diodeType=T.diodeType||"Standard";const R=di(T,"voltage","voltageUnit",Yt("voltage"));Q.voltage=R.value,Q.voltageUnit=R.unit;const Z=di(T,"current","currentUnit",Yt("current"));Q.current=Z.value,Q.currentUnit=Z.unit,Q.ledColor=T.ledColor||""}else if(H==="GenericComponent"){const T=I;Q.genericType=T.genericType||"Attenuator";const R=di(T,"voltage","voltageUnit",Yt("voltage"));Q.voltage=R.value,Q.voltageUnit=R.unit;const Z=di(T,"current","currentUnit",Yt("current"));Q.current=Z.value,Q.currentUnit=Z.unit,Q.power=T.power||"",Q.frequency=T.frequency||"",Q.model=T.model||""}const M=I.componentDefinitionKey;if(M){const T=Du.find(R=>`${R.category}:${R.subcategory}:${R.type}`===M);T&&(Q.componentDefinition=T,Q.componentDefinitionKey=M)}o(Q)},[]),$=X.useCallback(()=>{o(null),c(null)},[]);return{componentsTop:r,setComponentsTop:e,componentsBottom:t,setComponentsBottom:n,componentEditor:s,setComponentEditor:o,connectingPin:d,setConnectingPin:c,componentDialogPosition:h,setComponentDialogPosition:f,isDraggingDialog:m,setIsDraggingDialog:b,dialogDragOffset:S,setDialogDragOffset:v,addComponent:P,updateComponent:x,removeComponent:k,openComponentEditor:N,closeComponentEditor:$}}function th(r){return{resistance:"",capacitance:"F",inductance:"H",voltage:"V",current:"A",power:"W",impedance:"",capacity:"mAh",esr:"",coilVoltage:"V",inputVoltage:"V",outputVoltage:"V"}[r]||""}function nh(r,e,t,n){if(e==="power"){const o=r[e]||"";return typeof o=="string"&&o.trim()!==""?{value:o.replace(/W$/i,"").trim(),unit:"W"}:{value:"",unit:"W"}}if(r[e]!==void 0||r[t]!==void 0)return{value:r[e]||"",unit:r[t]||n};const s=r[e]||"";return typeof s=="string"&&s.trim()!==""?i2(s):{value:"",unit:n}}function y5(r){if((r.componentType==="Resistor"||r.componentType==="ResistorNetwork"||r.componentType==="Thermistor"||r.componentType==="VariableResistor")&&"resistance"in r){const{value:n,unit:s}=nh(r,"resistance","resistanceUnit",th("resistance"));if(n&&n.trim()!=="")return eh(n,s)}if((r.componentType==="Capacitor"||r.componentType==="Electrolytic Capacitor"||r.componentType==="Film Capacitor")&&"capacitance"in r){const{value:n,unit:s}=nh(r,"capacitance","capacitanceUnit",th("capacitance"));if(n&&n.trim()!=="")return eh(n,s)}if(r.componentType==="Inductor"&&"inductance"in r){const{value:n,unit:s}=nh(r,"inductance","inductanceUnit",th("inductance"));if(n&&n.trim()!=="")return eh(n,s)}if(r.componentType==="Fuse"&&"current"in r){const{value:n,unit:s}=nh(r,"current","currentUnit",th("current"));if(n&&n.trim()!=="")return eh(n,s)}if(r.componentType==="Battery"){const{value:n,unit:s}=nh(r,"capacity","capacityUnit",th("capacity"));if(n&&n.trim()!=="")return eh(n,s);const{value:o,unit:d}=nh(r,"voltage","voltageUnit",th("voltage"));if(o&&o.trim()!=="")return eh(o,d)}if(r.componentType==="PowerSupply"){const{value:n,unit:s}=nh(r,"outputVoltage","outputVoltageUnit",th("voltage"));if(n&&n.trim()!=="")return eh(n,s)}const e=r.partName?.trim();if(e&&e!=="")return e;const t=r.partNumber?.trim();return t&&t!==""?t:yc(r.componentType)}function x5(r,e,t){const n=[...r,...e],s=n.length,o=new Map;for(const c of n){const h=yc(c.componentType),f=y5(c),m=`${h}|${f}`;if(!o.has(m)){const S=r.some(x=>x.id===c.id),v=e.some(x=>x.id===c.id),P=S&&v?"both":S?"top":"bottom";o.set(m,{componentType:h,value:f,quantity:0,designators:[],packageType:c.packageType,manufacturer:c.manufacturer,partNumber:c.partNumber,description:c.description,notes:c.notes,datasheet:c.datasheet,layer:P})}const b=o.get(m);b.quantity++,c.designator&&c.designator.trim()!==""&&b.designators.push(c.designator.trim())}const d=Array.from(o.values()).sort((c,h)=>c.componentType!==h.componentType?c.componentType.localeCompare(h.componentType):c.value.localeCompare(h.value));return{version:"1.0",exportedAt:new Date().toISOString(),projectName:t,totalComponents:s,uniqueComponents:d.length,items:d}}const b5="modulepreload",v5=function(r){return"/PCB_Reverse_Engineering_Tool/"+r},lx={},am=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){let h=function(f){return Promise.all(f.map(m=>Promise.resolve(m).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),c=d?.nonce||d?.getAttribute("nonce");s=h(t.map(f=>{if(f=v5(f),f in lx)return;lx[f]=!0;const m=f.endsWith(".css"),b=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${b}`))return;const S=document.createElement("link");if(S.rel=m?"stylesheet":b5,m||(S.as="script"),S.crossOrigin="",S.href=f,c&&S.setAttribute("nonce",c),document.head.appendChild(S),m)return new Promise((v,P)=>{S.addEventListener("load",v),S.addEventListener("error",()=>P(new Error(`Unable to preload CSS for ${f}`)))})}))}function o(d){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=d,window.dispatchEvent(c),!c.defaultPrevented)throw d}return s.then(d=>{for(const c of d||[])c.status==="rejected"&&o(c.reason);return e().catch(o)})};function Rs(r){"@babel/helpers - typeof";return Rs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rs(r)}var Jc=Uint8Array,xc=Uint16Array,my=Int32Array,yy=new Jc([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),xy=new Jc([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),cx=new Jc([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s2=function(r,e){for(var t=new xc(31),n=0;n<31;++n)t[n]=e+=1<<r[n-1];for(var s=new my(t[30]),n=1;n<30;++n)for(var o=t[n];o<t[n+1];++o)s[o]=o-t[n]<<5|n;return{b:t,r:s}},r2=s2(yy,2),w5=r2.b,Hm=r2.r;w5[28]=258,Hm[258]=28;var S5=s2(xy,0),dx=S5.r,qm=new xc(32768);for(var hr=0;hr<32768;++hr){var Nu=(hr&43690)>>1|(hr&21845)<<1;Nu=(Nu&52428)>>2|(Nu&13107)<<2,Nu=(Nu&61680)>>4|(Nu&3855)<<4,qm[hr]=((Nu&65280)>>8|(Nu&255)<<8)>>1}var hp=(function(r,e,t){for(var n=r.length,s=0,o=new xc(e);s<n;++s)r[s]&&++o[r[s]-1];var d=new xc(e);for(s=1;s<e;++s)d[s]=d[s-1]+o[s-1]<<1;var c;if(t){c=new xc(1<<e);var h=15-e;for(s=0;s<n;++s)if(r[s])for(var f=s<<4|r[s],m=e-r[s],b=d[r[s]-1]++<<m,S=b|(1<<m)-1;b<=S;++b)c[qm[b]>>h]=f}else for(c=new xc(n),s=0;s<n;++s)r[s]&&(c[s]=qm[d[r[s]-1]++]>>15-r[s]);return c}),dh=new Jc(288);for(var hr=0;hr<144;++hr)dh[hr]=8;for(var hr=144;hr<256;++hr)dh[hr]=9;for(var hr=256;hr<280;++hr)dh[hr]=7;for(var hr=280;hr<288;++hr)dh[hr]=8;var Xg=new Jc(32);for(var hr=0;hr<32;++hr)Xg[hr]=5;var A5=hp(dh,9,0),C5=hp(Xg,5,0),a2=function(r){return(r+7)/8|0},T5=function(r,e,t){return(t==null||t>r.length)&&(t=r.length),new Jc(r.subarray(e,t))},Vd=function(r,e,t){t<<=e&7;var n=e/8|0;r[n]|=t,r[n+1]|=t>>8},ep=function(r,e,t){t<<=e&7;var n=e/8|0;r[n]|=t,r[n+1]|=t>>8,r[n+2]|=t>>16},om=function(r,e){for(var t=[],n=0;n<r.length;++n)r[n]&&t.push({s:n,f:r[n]});var s=t.length,o=t.slice();if(!s)return{t:l2,l:0};if(s==1){var d=new Jc(t[0].s+1);return d[t[0].s]=1,{t:d,l:1}}t.sort(function(B,G){return B.f-G.f}),t.push({s:-1,f:25001});var c=t[0],h=t[1],f=0,m=1,b=2;for(t[0]={s:-1,f:c.f+h.f,l:c,r:h};m!=s-1;)c=t[t[f].f<t[b].f?f++:b++],h=t[f!=m&&t[f].f<t[b].f?f++:b++],t[m++]={s:-1,f:c.f+h.f,l:c,r:h};for(var S=o[0].s,n=1;n<s;++n)o[n].s>S&&(S=o[n].s);var v=new xc(S+1),P=Vm(t[m-1],v,0);if(P>e){var n=0,x=0,k=P-e,N=1<<k;for(o.sort(function(G,te){return v[te.s]-v[G.s]||G.f-te.f});n<s;++n){var $=o[n].s;if(v[$]>e)x+=N-(1<<P-v[$]),v[$]=e;else break}for(x>>=k;x>0;){var I=o[n].s;v[I]<e?x-=1<<e-v[I]++-1:++n}for(;n>=0&&x;--n){var z=o[n].s;v[z]==e&&(--v[z],++x)}P=e}return{t:new Jc(v),l:P}},Vm=function(r,e,t){return r.s==-1?Math.max(Vm(r.l,e,t+1),Vm(r.r,e,t+1)):e[r.s]=t},ux=function(r){for(var e=r.length;e&&!r[--e];);for(var t=new xc(++e),n=0,s=r[0],o=1,d=function(h){t[n++]=h},c=1;c<=e;++c)if(r[c]==s&&c!=e)++o;else{if(!s&&o>2){for(;o>138;o-=138)d(32754);o>2&&(d(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(d(s),--o;o>6;o-=6)d(8304);o>2&&(d(o-3<<5|8208),o=0)}for(;o--;)d(s);o=1,s=r[c]}return{c:t.subarray(0,n),n:e}},tp=function(r,e){for(var t=0,n=0;n<e.length;++n)t+=r[n]*e[n];return t},o2=function(r,e,t){var n=t.length,s=a2(e+2);r[s]=n&255,r[s+1]=n>>8,r[s+2]=r[s]^255,r[s+3]=r[s+1]^255;for(var o=0;o<n;++o)r[s+o+4]=t[o];return(s+4+n)*8},hx=function(r,e,t,n,s,o,d,c,h,f,m){Vd(e,m++,t),++s[256];for(var b=om(s,15),S=b.t,v=b.l,P=om(o,15),x=P.t,k=P.l,N=ux(S),$=N.c,I=N.n,z=ux(x),B=z.c,G=z.n,te=new xc(19),F=0;F<$.length;++F)++te[$[F]&31];for(var F=0;F<B.length;++F)++te[B[F]&31];for(var H=om(te,7),Q=H.t,M=H.l,T=19;T>4&&!Q[cx[T-1]];--T);var R=f+5<<3,Z=tp(s,dh)+tp(o,Xg)+d,se=tp(s,S)+tp(o,x)+d+14+3*T+tp(te,Q)+2*te[16]+3*te[17]+7*te[18];if(h>=0&&R<=Z&&R<=se)return o2(e,m,r.subarray(h,h+f));var V,ee,ae,Ce;if(Vd(e,m,1+(se<Z)),m+=2,se<Z){V=hp(S,v,0),ee=S,ae=hp(x,k,0),Ce=x;var xe=hp(Q,M,0);Vd(e,m,I-257),Vd(e,m+5,G-1),Vd(e,m+10,T-4),m+=14;for(var F=0;F<T;++F)Vd(e,m+3*F,Q[cx[F]]);m+=3*T;for(var J=[$,B],D=0;D<2;++D)for(var W=J[D],F=0;F<W.length;++F){var K=W[F]&31;Vd(e,m,xe[K]),m+=Q[K],K>15&&(Vd(e,m,W[F]>>5&127),m+=W[F]>>12)}}else V=A5,ee=dh,ae=C5,Ce=Xg;for(var F=0;F<c;++F){var ue=n[F];if(ue>255){var K=ue>>18&31;ep(e,m,V[K+257]),m+=ee[K+257],K>7&&(Vd(e,m,ue>>23&31),m+=yy[K]);var Te=ue&31;ep(e,m,ae[Te]),m+=Ce[Te],Te>3&&(ep(e,m,ue>>5&8191),m+=xy[Te])}else ep(e,m,V[ue]),m+=ee[ue]}return ep(e,m,V[256]),m+ee[256]},_5=new my([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),l2=new Jc(0),k5=function(r,e,t,n,s,o){var d=o.z||r.length,c=new Jc(n+d+5*(1+Math.ceil(d/7e3))+s),h=c.subarray(n,c.length-s),f=o.l,m=(o.r||0)&7;if(e){m&&(h[0]=o.r>>3);for(var b=_5[e-1],S=b>>13,v=b&8191,P=(1<<t)-1,x=o.p||new xc(32768),k=o.h||new xc(P+1),N=Math.ceil(t/3),$=2*N,I=function(xt){return(r[xt]^r[xt+1]<<N^r[xt+2]<<$)&P},z=new my(25e3),B=new xc(288),G=new xc(32),te=0,F=0,H=o.i||0,Q=0,M=o.w||0,T=0;H+2<d;++H){var R=I(H),Z=H&32767,se=k[R];if(x[Z]=se,k[R]=Z,M<=H){var V=d-H;if((te>7e3||Q>24576)&&(V>423||!f)){m=hx(r,h,0,z,B,G,F,Q,T,H-T,m),Q=te=F=0,T=H;for(var ee=0;ee<286;++ee)B[ee]=0;for(var ee=0;ee<30;++ee)G[ee]=0}var ae=2,Ce=0,xe=v,J=Z-se&32767;if(V>2&&R==I(H-J))for(var D=Math.min(S,V)-1,W=Math.min(32767,H),K=Math.min(258,V);J<=W&&--xe&&Z!=se;){if(r[H+ae]==r[H+ae-J]){for(var ue=0;ue<K&&r[H+ue]==r[H+ue-J];++ue);if(ue>ae){if(ae=ue,Ce=J,ue>D)break;for(var Te=Math.min(J,ue-2),Pe=0,ee=0;ee<Te;++ee){var Ve=H-J+ee&32767,De=x[Ve],et=Ve-De&32767;et>Pe&&(Pe=et,se=Ve)}}}Z=se,se=x[Z],J+=Z-se&32767}if(Ce){z[Q++]=268435456|Hm[ae]<<18|dx[Ce];var ot=Hm[ae]&31,at=dx[Ce]&31;F+=yy[ot]+xy[at],++B[257+ot],++G[at],M=H+ae,++te}else z[Q++]=r[H],++B[r[H]]}}for(H=Math.max(H,M);H<d;++H)z[Q++]=r[H],++B[r[H]];m=hx(r,h,f,z,B,G,F,Q,T,H-T,m),f||(o.r=m&7|h[m/8|0]<<3,m-=7,o.h=k,o.p=x,o.i=H,o.w=M)}else{for(var H=o.w||0;H<d+f;H+=65535){var ht=H+65535;ht>=d&&(h[m/8|0]=f,ht=d),m=o2(h,m+1,r.subarray(H,ht))}o.i=d}return T5(c,0,n+a2(m)+s)},c2=function(){var r=1,e=0;return{p:function(t){for(var n=r,s=e,o=t.length|0,d=0;d!=o;){for(var c=Math.min(d+2655,o);d<c;++d)s+=n+=t[d];n=(n&65535)+15*(n>>16),s=(s&65535)+15*(s>>16)}r=n,e=s},d:function(){return r%=65521,e%=65521,(r&255)<<24|(r&65280)<<8|(e&255)<<8|e>>8}}},N5=function(r,e,t,n,s){if(!s&&(s={l:1},e.dictionary)){var o=e.dictionary.subarray(-32768),d=new Jc(o.length+r.length);d.set(o),d.set(r,o.length),r=d,s.w=o.length}return k5(r,e.level==null?6:e.level,e.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):20:12+e.mem,t,n,s)},d2=function(r,e,t){for(;t;++e)r[e]=t,t>>>=8},j5=function(r,e){var t=e.level,n=t==0?0:t<6?1:t==9?3:2;if(r[0]=120,r[1]=n<<6|(e.dictionary&&32),r[1]|=31-(r[0]<<8|r[1])%31,e.dictionary){var s=c2();s.p(e.dictionary),d2(r,2,s.d())}};function Wm(r,e){e||(e={});var t=c2();t.p(r);var n=N5(r,e,e.dictionary?6:2,4);return j5(n,e),d2(n,n.length-4,t.d()),n}var P5=typeof TextDecoder<"u"&&new TextDecoder,E5=0;try{P5.decode(l2,{stream:!0}),E5=1}catch{}function R5(r){if(Array.isArray(r))return r}function D5(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n,s,o,d,c=[],h=!0,f=!1;try{if(o=(t=t.call(r)).next,e!==0)for(;!(h=(n=o.call(t)).done)&&(c.push(n.value),c.length!==e);h=!0);}catch(m){f=!0,s=m}finally{try{if(!h&&t.return!=null&&(d=t.return(),Object(d)!==d))return}finally{if(f)throw s}}return c}}function fx(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function L5(r,e){if(r){if(typeof r=="string")return fx(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?fx(r,e):void 0}}function M5(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function px(r,e){return R5(r)||D5(r,e)||L5(r,e)||M5()}function gx(r,e="utf8"){return new TextDecoder(e).decode(r)}const I5=new TextEncoder;function z5(r){return I5.encode(r)}const B5=1024*8,O5=(()=>{const r=new Uint8Array(4),e=new Uint32Array(r.buffer);return!((e[0]=1)&r[0])})(),lm={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class by{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(e=B5,t={}){let n=!1;typeof e=="number"?e=new ArrayBuffer(e):(n=!0,this.lastWrittenByte=e.byteLength);const s=t.offset?t.offset>>>0:0,o=e.byteLength-s;let d=s;(ArrayBuffer.isView(e)||e instanceof by)&&(e.byteLength!==e.buffer.byteLength&&(d=e.byteOffset+s),e=e.buffer),n?this.lastWrittenByte=o:this.lastWrittenByte=0,this.buffer=e,this.length=o,this.byteLength=o,this.byteOffset=d,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,d,o),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const n=(this.offset+e)*2,s=new Uint8Array(n);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,t){const n=lm[t].BYTES_PER_ELEMENT*e,s=this.byteOffset+this.offset,o=this.buffer.slice(s,s+n);if(this.littleEndian===O5&&t!=="uint8"&&t!=="int8"){const c=new Uint8Array(this.buffer.slice(s,s+n));c.reverse();const h=new lm[t](c.buffer);return this.offset+=n,h.reverse(),h}const d=new lm[t](o);return this.offset+=n,d}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let t="";for(let n=0;n<e;n++)t+=this.readChar();return t}readUtf8(e=1){return gx(this.readBytes(e))}decodeText(e=1,t="utf8"){return gx(this.readBytes(e),t)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(e){return this.writeBytes(z5(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function wf(r){let e=r.length;for(;--e>=0;)r[e]=0}const F5=3,U5=258,u2=29,H5=256,q5=H5+1+u2,h2=30,V5=512,W5=new Array((q5+2)*2);wf(W5);const $5=new Array(h2*2);wf($5);const G5=new Array(V5);wf(G5);const Y5=new Array(U5-F5+1);wf(Y5);const X5=new Array(u2);wf(X5);const K5=new Array(h2);wf(K5);const Z5=(r,e,t,n)=>{let s=r&65535|0,o=r>>>16&65535|0,d=0;for(;t!==0;){d=t>2e3?2e3:t,t-=d;do s=s+e[n++]|0,o=o+s|0;while(--d);s%=65521,o%=65521}return s|o<<16|0};var $m=Z5;const J5=()=>{let r,e=[];for(var t=0;t<256;t++){r=t;for(var n=0;n<8;n++)r=r&1?3988292384^r>>>1:r>>>1;e[t]=r}return e},Q5=new Uint32Array(J5()),eS=(r,e,t,n)=>{const s=Q5,o=n+t;r^=-1;for(let d=n;d<o;d++)r=r>>>8^s[(r^e[d])&255];return r^-1};var bd=eS,Gm={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},f2={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const tS=(r,e)=>Object.prototype.hasOwnProperty.call(r,e);var nS=function(r){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const n in t)tS(t,n)&&(r[n]=t[n])}}return r},iS=r=>{let e=0;for(let n=0,s=r.length;n<s;n++)e+=r[n].length;const t=new Uint8Array(e);for(let n=0,s=0,o=r.length;n<o;n++){let d=r[n];t.set(d,s),s+=d.length}return t},p2={assign:nS,flattenChunks:iS};let g2=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{g2=!1}const gp=new Uint8Array(256);for(let r=0;r<256;r++)gp[r]=r>=252?6:r>=248?5:r>=240?4:r>=224?3:r>=192?2:1;gp[254]=gp[254]=1;var sS=r=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(r);let e,t,n,s,o,d=r.length,c=0;for(s=0;s<d;s++)t=r.charCodeAt(s),(t&64512)===55296&&s+1<d&&(n=r.charCodeAt(s+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),s++)),c+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(c),o=0,s=0;o<c;s++)t=r.charCodeAt(s),(t&64512)===55296&&s+1<d&&(n=r.charCodeAt(s+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),s++)),t<128?e[o++]=t:t<2048?(e[o++]=192|t>>>6,e[o++]=128|t&63):t<65536?(e[o++]=224|t>>>12,e[o++]=128|t>>>6&63,e[o++]=128|t&63):(e[o++]=240|t>>>18,e[o++]=128|t>>>12&63,e[o++]=128|t>>>6&63,e[o++]=128|t&63);return e};const rS=(r,e)=>{if(e<65534&&r.subarray&&g2)return String.fromCharCode.apply(null,r.length===e?r:r.subarray(0,e));let t="";for(let n=0;n<e;n++)t+=String.fromCharCode(r[n]);return t};var aS=(r,e)=>{const t=e||r.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(r.subarray(0,e));let n,s;const o=new Array(t*2);for(s=0,n=0;n<t;){let d=r[n++];if(d<128){o[s++]=d;continue}let c=gp[d];if(c>4){o[s++]=65533,n+=c-1;continue}for(d&=c===2?31:c===3?15:7;c>1&&n<t;)d=d<<6|r[n++]&63,c--;if(c>1){o[s++]=65533;continue}d<65536?o[s++]=d:(d-=65536,o[s++]=55296|d>>10&1023,o[s++]=56320|d&1023)}return rS(o,s)},oS=(r,e)=>{e=e||r.length,e>r.length&&(e=r.length);let t=e-1;for(;t>=0&&(r[t]&192)===128;)t--;return t<0||t===0?e:t+gp[r[t]]>e?t:e},Ym={string2buf:sS,buf2string:aS,utf8border:oS};function lS(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var cS=lS;const vg=16209,dS=16191;var uS=function(e,t){let n,s,o,d,c,h,f,m,b,S,v,P,x,k,N,$,I,z,B,G,te,F,H,Q;const M=e.state;n=e.next_in,H=e.input,s=n+(e.avail_in-5),o=e.next_out,Q=e.output,d=o-(t-e.avail_out),c=o+(e.avail_out-257),h=M.dmax,f=M.wsize,m=M.whave,b=M.wnext,S=M.window,v=M.hold,P=M.bits,x=M.lencode,k=M.distcode,N=(1<<M.lenbits)-1,$=(1<<M.distbits)-1;e:do{P<15&&(v+=H[n++]<<P,P+=8,v+=H[n++]<<P,P+=8),I=x[v&N];t:for(;;){if(z=I>>>24,v>>>=z,P-=z,z=I>>>16&255,z===0)Q[o++]=I&65535;else if(z&16){B=I&65535,z&=15,z&&(P<z&&(v+=H[n++]<<P,P+=8),B+=v&(1<<z)-1,v>>>=z,P-=z),P<15&&(v+=H[n++]<<P,P+=8,v+=H[n++]<<P,P+=8),I=k[v&$];n:for(;;){if(z=I>>>24,v>>>=z,P-=z,z=I>>>16&255,z&16){if(G=I&65535,z&=15,P<z&&(v+=H[n++]<<P,P+=8,P<z&&(v+=H[n++]<<P,P+=8)),G+=v&(1<<z)-1,G>h){e.msg="invalid distance too far back",M.mode=vg;break e}if(v>>>=z,P-=z,z=o-d,G>z){if(z=G-z,z>m&&M.sane){e.msg="invalid distance too far back",M.mode=vg;break e}if(te=0,F=S,b===0){if(te+=f-z,z<B){B-=z;do Q[o++]=S[te++];while(--z);te=o-G,F=Q}}else if(b<z){if(te+=f+b-z,z-=b,z<B){B-=z;do Q[o++]=S[te++];while(--z);if(te=0,b<B){z=b,B-=z;do Q[o++]=S[te++];while(--z);te=o-G,F=Q}}}else if(te+=b-z,z<B){B-=z;do Q[o++]=S[te++];while(--z);te=o-G,F=Q}for(;B>2;)Q[o++]=F[te++],Q[o++]=F[te++],Q[o++]=F[te++],B-=3;B&&(Q[o++]=F[te++],B>1&&(Q[o++]=F[te++]))}else{te=o-G;do Q[o++]=Q[te++],Q[o++]=Q[te++],Q[o++]=Q[te++],B-=3;while(B>2);B&&(Q[o++]=Q[te++],B>1&&(Q[o++]=Q[te++]))}}else if((z&64)===0){I=k[(I&65535)+(v&(1<<z)-1)];continue n}else{e.msg="invalid distance code",M.mode=vg;break e}break}}else if((z&64)===0){I=x[(I&65535)+(v&(1<<z)-1)];continue t}else if(z&32){M.mode=dS;break e}else{e.msg="invalid literal/length code",M.mode=vg;break e}break}}while(n<s&&o<c);B=P>>3,n-=B,P-=B<<3,v&=(1<<P)-1,e.next_in=n,e.next_out=o,e.avail_in=n<s?5+(s-n):5-(n-s),e.avail_out=o<c?257+(c-o):257-(o-c),M.hold=v,M.bits=P};const Kh=15,mx=852,yx=592,xx=0,cm=1,bx=2,hS=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),fS=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),pS=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),gS=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),mS=(r,e,t,n,s,o,d,c)=>{const h=c.bits;let f=0,m=0,b=0,S=0,v=0,P=0,x=0,k=0,N=0,$=0,I,z,B,G,te,F=null,H;const Q=new Uint16Array(Kh+1),M=new Uint16Array(Kh+1);let T=null,R,Z,se;for(f=0;f<=Kh;f++)Q[f]=0;for(m=0;m<n;m++)Q[e[t+m]]++;for(v=h,S=Kh;S>=1&&Q[S]===0;S--);if(v>S&&(v=S),S===0)return s[o++]=1<<24|64<<16|0,s[o++]=1<<24|64<<16|0,c.bits=1,0;for(b=1;b<S&&Q[b]===0;b++);for(v<b&&(v=b),k=1,f=1;f<=Kh;f++)if(k<<=1,k-=Q[f],k<0)return-1;if(k>0&&(r===xx||S!==1))return-1;for(M[1]=0,f=1;f<Kh;f++)M[f+1]=M[f]+Q[f];for(m=0;m<n;m++)e[t+m]!==0&&(d[M[e[t+m]]++]=m);if(r===xx?(F=T=d,H=20):r===cm?(F=hS,T=fS,H=257):(F=pS,T=gS,H=0),$=0,m=0,f=b,te=o,P=v,x=0,B=-1,N=1<<v,G=N-1,r===cm&&N>mx||r===bx&&N>yx)return 1;for(;;){R=f-x,d[m]+1<H?(Z=0,se=d[m]):d[m]>=H?(Z=T[d[m]-H],se=F[d[m]-H]):(Z=96,se=0),I=1<<f-x,z=1<<P,b=z;do z-=I,s[te+($>>x)+z]=R<<24|Z<<16|se|0;while(z!==0);for(I=1<<f-1;$&I;)I>>=1;if(I!==0?($&=I-1,$+=I):$=0,m++,--Q[f]===0){if(f===S)break;f=e[t+d[m]]}if(f>v&&($&G)!==B){for(x===0&&(x=v),te+=b,P=f-x,k=1<<P;P+x<S&&(k-=Q[P+x],!(k<=0));)P++,k<<=1;if(N+=1<<P,r===cm&&N>mx||r===bx&&N>yx)return 1;B=$&G,s[B]=v<<24|P<<16|te-o|0}}return $!==0&&(s[te+$]=f-x<<24|64<<16|0),c.bits=v,0};var fp=mS;const yS=0,m2=1,y2=2,{Z_FINISH:vx,Z_BLOCK:xS,Z_TREES:wg,Z_OK:uh,Z_STREAM_END:bS,Z_NEED_DICT:vS,Z_STREAM_ERROR:Fc,Z_DATA_ERROR:x2,Z_MEM_ERROR:b2,Z_BUF_ERROR:wS,Z_DEFLATED:wx}=f2,s0=16180,Sx=16181,Ax=16182,Cx=16183,Tx=16184,_x=16185,kx=16186,Nx=16187,jx=16188,Px=16189,Kg=16190,Wd=16191,dm=16192,Ex=16193,um=16194,Rx=16195,Dx=16196,Lx=16197,Mx=16198,Sg=16199,Ag=16200,Ix=16201,zx=16202,Bx=16203,Ox=16204,Fx=16205,hm=16206,Ux=16207,Hx=16208,wr=16209,v2=16210,w2=16211,SS=852,AS=592,CS=15,TS=CS,qx=r=>(r>>>24&255)+(r>>>8&65280)+((r&65280)<<8)+((r&255)<<24);function _S(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const ph=r=>{if(!r)return 1;const e=r.state;return!e||e.strm!==r||e.mode<s0||e.mode>w2?1:0},S2=r=>{if(ph(r))return Fc;const e=r.state;return r.total_in=r.total_out=e.total=0,r.msg="",e.wrap&&(r.adler=e.wrap&1),e.mode=s0,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(SS),e.distcode=e.distdyn=new Int32Array(AS),e.sane=1,e.back=-1,uh},A2=r=>{if(ph(r))return Fc;const e=r.state;return e.wsize=0,e.whave=0,e.wnext=0,S2(r)},C2=(r,e)=>{let t;if(ph(r))return Fc;const n=r.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Fc:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=t,n.wbits=e,A2(r))},T2=(r,e)=>{if(!r)return Fc;const t=new _S;r.state=t,t.strm=r,t.window=null,t.mode=s0;const n=C2(r,e);return n!==uh&&(r.state=null),n},kS=r=>T2(r,TS);let Vx=!0,fm,pm;const NS=r=>{if(Vx){fm=new Int32Array(512),pm=new Int32Array(32);let e=0;for(;e<144;)r.lens[e++]=8;for(;e<256;)r.lens[e++]=9;for(;e<280;)r.lens[e++]=7;for(;e<288;)r.lens[e++]=8;for(fp(m2,r.lens,0,288,fm,0,r.work,{bits:9}),e=0;e<32;)r.lens[e++]=5;fp(y2,r.lens,0,32,pm,0,r.work,{bits:5}),Vx=!1}r.lencode=fm,r.lenbits=9,r.distcode=pm,r.distbits=5},_2=(r,e,t,n)=>{let s;const o=r.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(e.subarray(t-o.wsize,t),0),o.wnext=0,o.whave=o.wsize):(s=o.wsize-o.wnext,s>n&&(s=n),o.window.set(e.subarray(t-n,t-n+s),o.wnext),n-=s,n?(o.window.set(e.subarray(t-n,t),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=s,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=s))),0},jS=(r,e)=>{let t,n,s,o,d,c,h,f,m,b,S,v,P,x,k=0,N,$,I,z,B,G,te,F;const H=new Uint8Array(4);let Q,M;const T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(ph(r)||!r.output||!r.input&&r.avail_in!==0)return Fc;t=r.state,t.mode===Wd&&(t.mode=dm),d=r.next_out,s=r.output,h=r.avail_out,o=r.next_in,n=r.input,c=r.avail_in,f=t.hold,m=t.bits,b=c,S=h,F=uh;e:for(;;)switch(t.mode){case s0:if(t.wrap===0){t.mode=dm;break}for(;m<16;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}if(t.wrap&2&&f===35615){t.wbits===0&&(t.wbits=15),t.check=0,H[0]=f&255,H[1]=f>>>8&255,t.check=bd(t.check,H,2,0),f=0,m=0,t.mode=Sx;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((f&255)<<8)+(f>>8))%31){r.msg="incorrect header check",t.mode=wr;break}if((f&15)!==wx){r.msg="unknown compression method",t.mode=wr;break}if(f>>>=4,m-=4,te=(f&15)+8,t.wbits===0&&(t.wbits=te),te>15||te>t.wbits){r.msg="invalid window size",t.mode=wr;break}t.dmax=1<<t.wbits,t.flags=0,r.adler=t.check=1,t.mode=f&512?Px:Wd,f=0,m=0;break;case Sx:for(;m<16;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}if(t.flags=f,(t.flags&255)!==wx){r.msg="unknown compression method",t.mode=wr;break}if(t.flags&57344){r.msg="unknown header flags set",t.mode=wr;break}t.head&&(t.head.text=f>>8&1),t.flags&512&&t.wrap&4&&(H[0]=f&255,H[1]=f>>>8&255,t.check=bd(t.check,H,2,0)),f=0,m=0,t.mode=Ax;case Ax:for(;m<32;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}t.head&&(t.head.time=f),t.flags&512&&t.wrap&4&&(H[0]=f&255,H[1]=f>>>8&255,H[2]=f>>>16&255,H[3]=f>>>24&255,t.check=bd(t.check,H,4,0)),f=0,m=0,t.mode=Cx;case Cx:for(;m<16;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}t.head&&(t.head.xflags=f&255,t.head.os=f>>8),t.flags&512&&t.wrap&4&&(H[0]=f&255,H[1]=f>>>8&255,t.check=bd(t.check,H,2,0)),f=0,m=0,t.mode=Tx;case Tx:if(t.flags&1024){for(;m<16;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}t.length=f,t.head&&(t.head.extra_len=f),t.flags&512&&t.wrap&4&&(H[0]=f&255,H[1]=f>>>8&255,t.check=bd(t.check,H,2,0)),f=0,m=0}else t.head&&(t.head.extra=null);t.mode=_x;case _x:if(t.flags&1024&&(v=t.length,v>c&&(v=c),v&&(t.head&&(te=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(n.subarray(o,o+v),te)),t.flags&512&&t.wrap&4&&(t.check=bd(t.check,n,v,o)),c-=v,o+=v,t.length-=v),t.length))break e;t.length=0,t.mode=kx;case kx:if(t.flags&2048){if(c===0)break e;v=0;do te=n[o+v++],t.head&&te&&t.length<65536&&(t.head.name+=String.fromCharCode(te));while(te&&v<c);if(t.flags&512&&t.wrap&4&&(t.check=bd(t.check,n,v,o)),c-=v,o+=v,te)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=Nx;case Nx:if(t.flags&4096){if(c===0)break e;v=0;do te=n[o+v++],t.head&&te&&t.length<65536&&(t.head.comment+=String.fromCharCode(te));while(te&&v<c);if(t.flags&512&&t.wrap&4&&(t.check=bd(t.check,n,v,o)),c-=v,o+=v,te)break e}else t.head&&(t.head.comment=null);t.mode=jx;case jx:if(t.flags&512){for(;m<16;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}if(t.wrap&4&&f!==(t.check&65535)){r.msg="header crc mismatch",t.mode=wr;break}f=0,m=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),r.adler=t.check=0,t.mode=Wd;break;case Px:for(;m<32;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}r.adler=t.check=qx(f),f=0,m=0,t.mode=Kg;case Kg:if(t.havedict===0)return r.next_out=d,r.avail_out=h,r.next_in=o,r.avail_in=c,t.hold=f,t.bits=m,vS;r.adler=t.check=1,t.mode=Wd;case Wd:if(e===xS||e===wg)break e;case dm:if(t.last){f>>>=m&7,m-=m&7,t.mode=hm;break}for(;m<3;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}switch(t.last=f&1,f>>>=1,m-=1,f&3){case 0:t.mode=Ex;break;case 1:if(NS(t),t.mode=Sg,e===wg){f>>>=2,m-=2;break e}break;case 2:t.mode=Dx;break;case 3:r.msg="invalid block type",t.mode=wr}f>>>=2,m-=2;break;case Ex:for(f>>>=m&7,m-=m&7;m<32;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}if((f&65535)!==(f>>>16^65535)){r.msg="invalid stored block lengths",t.mode=wr;break}if(t.length=f&65535,f=0,m=0,t.mode=um,e===wg)break e;case um:t.mode=Rx;case Rx:if(v=t.length,v){if(v>c&&(v=c),v>h&&(v=h),v===0)break e;s.set(n.subarray(o,o+v),d),c-=v,o+=v,h-=v,d+=v,t.length-=v;break}t.mode=Wd;break;case Dx:for(;m<14;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}if(t.nlen=(f&31)+257,f>>>=5,m-=5,t.ndist=(f&31)+1,f>>>=5,m-=5,t.ncode=(f&15)+4,f>>>=4,m-=4,t.nlen>286||t.ndist>30){r.msg="too many length or distance symbols",t.mode=wr;break}t.have=0,t.mode=Lx;case Lx:for(;t.have<t.ncode;){for(;m<3;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}t.lens[T[t.have++]]=f&7,f>>>=3,m-=3}for(;t.have<19;)t.lens[T[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,Q={bits:t.lenbits},F=fp(yS,t.lens,0,19,t.lencode,0,t.work,Q),t.lenbits=Q.bits,F){r.msg="invalid code lengths set",t.mode=wr;break}t.have=0,t.mode=Mx;case Mx:for(;t.have<t.nlen+t.ndist;){for(;k=t.lencode[f&(1<<t.lenbits)-1],N=k>>>24,$=k>>>16&255,I=k&65535,!(N<=m);){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}if(I<16)f>>>=N,m-=N,t.lens[t.have++]=I;else{if(I===16){for(M=N+2;m<M;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}if(f>>>=N,m-=N,t.have===0){r.msg="invalid bit length repeat",t.mode=wr;break}te=t.lens[t.have-1],v=3+(f&3),f>>>=2,m-=2}else if(I===17){for(M=N+3;m<M;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}f>>>=N,m-=N,te=0,v=3+(f&7),f>>>=3,m-=3}else{for(M=N+7;m<M;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}f>>>=N,m-=N,te=0,v=11+(f&127),f>>>=7,m-=7}if(t.have+v>t.nlen+t.ndist){r.msg="invalid bit length repeat",t.mode=wr;break}for(;v--;)t.lens[t.have++]=te}}if(t.mode===wr)break;if(t.lens[256]===0){r.msg="invalid code -- missing end-of-block",t.mode=wr;break}if(t.lenbits=9,Q={bits:t.lenbits},F=fp(m2,t.lens,0,t.nlen,t.lencode,0,t.work,Q),t.lenbits=Q.bits,F){r.msg="invalid literal/lengths set",t.mode=wr;break}if(t.distbits=6,t.distcode=t.distdyn,Q={bits:t.distbits},F=fp(y2,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,Q),t.distbits=Q.bits,F){r.msg="invalid distances set",t.mode=wr;break}if(t.mode=Sg,e===wg)break e;case Sg:t.mode=Ag;case Ag:if(c>=6&&h>=258){r.next_out=d,r.avail_out=h,r.next_in=o,r.avail_in=c,t.hold=f,t.bits=m,uS(r,S),d=r.next_out,s=r.output,h=r.avail_out,o=r.next_in,n=r.input,c=r.avail_in,f=t.hold,m=t.bits,t.mode===Wd&&(t.back=-1);break}for(t.back=0;k=t.lencode[f&(1<<t.lenbits)-1],N=k>>>24,$=k>>>16&255,I=k&65535,!(N<=m);){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}if($&&($&240)===0){for(z=N,B=$,G=I;k=t.lencode[G+((f&(1<<z+B)-1)>>z)],N=k>>>24,$=k>>>16&255,I=k&65535,!(z+N<=m);){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}f>>>=z,m-=z,t.back+=z}if(f>>>=N,m-=N,t.back+=N,t.length=I,$===0){t.mode=Fx;break}if($&32){t.back=-1,t.mode=Wd;break}if($&64){r.msg="invalid literal/length code",t.mode=wr;break}t.extra=$&15,t.mode=Ix;case Ix:if(t.extra){for(M=t.extra;m<M;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}t.length+=f&(1<<t.extra)-1,f>>>=t.extra,m-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=zx;case zx:for(;k=t.distcode[f&(1<<t.distbits)-1],N=k>>>24,$=k>>>16&255,I=k&65535,!(N<=m);){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}if(($&240)===0){for(z=N,B=$,G=I;k=t.distcode[G+((f&(1<<z+B)-1)>>z)],N=k>>>24,$=k>>>16&255,I=k&65535,!(z+N<=m);){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}f>>>=z,m-=z,t.back+=z}if(f>>>=N,m-=N,t.back+=N,$&64){r.msg="invalid distance code",t.mode=wr;break}t.offset=I,t.extra=$&15,t.mode=Bx;case Bx:if(t.extra){for(M=t.extra;m<M;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}t.offset+=f&(1<<t.extra)-1,f>>>=t.extra,m-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){r.msg="invalid distance too far back",t.mode=wr;break}t.mode=Ox;case Ox:if(h===0)break e;if(v=S-h,t.offset>v){if(v=t.offset-v,v>t.whave&&t.sane){r.msg="invalid distance too far back",t.mode=wr;break}v>t.wnext?(v-=t.wnext,P=t.wsize-v):P=t.wnext-v,v>t.length&&(v=t.length),x=t.window}else x=s,P=d-t.offset,v=t.length;v>h&&(v=h),h-=v,t.length-=v;do s[d++]=x[P++];while(--v);t.length===0&&(t.mode=Ag);break;case Fx:if(h===0)break e;s[d++]=t.length,h--,t.mode=Ag;break;case hm:if(t.wrap){for(;m<32;){if(c===0)break e;c--,f|=n[o++]<<m,m+=8}if(S-=h,r.total_out+=S,t.total+=S,t.wrap&4&&S&&(r.adler=t.check=t.flags?bd(t.check,s,S,d-S):$m(t.check,s,S,d-S)),S=h,t.wrap&4&&(t.flags?f:qx(f))!==t.check){r.msg="incorrect data check",t.mode=wr;break}f=0,m=0}t.mode=Ux;case Ux:if(t.wrap&&t.flags){for(;m<32;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}if(t.wrap&4&&f!==(t.total&4294967295)){r.msg="incorrect length check",t.mode=wr;break}f=0,m=0}t.mode=Hx;case Hx:F=bS;break e;case wr:F=x2;break e;case v2:return b2;case w2:default:return Fc}return r.next_out=d,r.avail_out=h,r.next_in=o,r.avail_in=c,t.hold=f,t.bits=m,(t.wsize||S!==r.avail_out&&t.mode<wr&&(t.mode<hm||e!==vx))&&_2(r,r.output,r.next_out,S-r.avail_out),b-=r.avail_in,S-=r.avail_out,r.total_in+=b,r.total_out+=S,t.total+=S,t.wrap&4&&S&&(r.adler=t.check=t.flags?bd(t.check,s,S,r.next_out-S):$m(t.check,s,S,r.next_out-S)),r.data_type=t.bits+(t.last?64:0)+(t.mode===Wd?128:0)+(t.mode===Sg||t.mode===um?256:0),(b===0&&S===0||e===vx)&&F===uh&&(F=wS),F},PS=r=>{if(ph(r))return Fc;let e=r.state;return e.window&&(e.window=null),r.state=null,uh},ES=(r,e)=>{if(ph(r))return Fc;const t=r.state;return(t.wrap&2)===0?Fc:(t.head=e,e.done=!1,uh)},RS=(r,e)=>{const t=e.length;let n,s,o;return ph(r)||(n=r.state,n.wrap!==0&&n.mode!==Kg)?Fc:n.mode===Kg&&(s=1,s=$m(s,e,t,0),s!==n.check)?x2:(o=_2(r,e,t,t),o?(n.mode=v2,b2):(n.havedict=1,uh))};var DS=A2,LS=C2,MS=S2,IS=kS,zS=T2,BS=jS,OS=PS,FS=ES,US=RS,HS="pako inflate (from Nodeca project)",Yd={inflateReset:DS,inflateReset2:LS,inflateResetKeep:MS,inflateInit:IS,inflateInit2:zS,inflate:BS,inflateEnd:OS,inflateGetHeader:FS,inflateSetDictionary:US,inflateInfo:HS};function qS(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var VS=qS;const k2=Object.prototype.toString,{Z_NO_FLUSH:WS,Z_FINISH:$S,Z_OK:mp,Z_STREAM_END:gm,Z_NEED_DICT:mm,Z_STREAM_ERROR:GS,Z_DATA_ERROR:Wx,Z_MEM_ERROR:YS}=f2;function Ap(r){this.options=p2.assign({chunkSize:1024*64,windowBits:15,to:""},r||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(r&&r.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new cS,this.strm.avail_out=0;let t=Yd.inflateInit2(this.strm,e.windowBits);if(t!==mp)throw new Error(Gm[t]);if(this.header=new VS,Yd.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Ym.string2buf(e.dictionary):k2.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=Yd.inflateSetDictionary(this.strm,e.dictionary),t!==mp)))throw new Error(Gm[t])}Ap.prototype.push=function(r,e){const t=this.strm,n=this.options.chunkSize,s=this.options.dictionary;let o,d,c;if(this.ended)return!1;for(e===~~e?d=e:d=e===!0?$S:WS,k2.call(r)==="[object ArrayBuffer]"?t.input=new Uint8Array(r):t.input=r,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(n),t.next_out=0,t.avail_out=n),o=Yd.inflate(t,d),o===mm&&s&&(o=Yd.inflateSetDictionary(t,s),o===mp?o=Yd.inflate(t,d):o===Wx&&(o=mm));t.avail_in>0&&o===gm&&t.state.wrap>0&&r[t.next_in]!==0;)Yd.inflateReset(t),o=Yd.inflate(t,d);switch(o){case GS:case Wx:case mm:case YS:return this.onEnd(o),this.ended=!0,!1}if(c=t.avail_out,t.next_out&&(t.avail_out===0||o===gm))if(this.options.to==="string"){let h=Ym.utf8border(t.output,t.next_out),f=t.next_out-h,m=Ym.buf2string(t.output,h);t.next_out=f,t.avail_out=n-f,f&&t.output.set(t.output.subarray(h,h+f),0),this.onData(m)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(o===mp&&c===0)){if(o===gm)return o=Yd.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};Ap.prototype.onData=function(r){this.chunks.push(r)};Ap.prototype.onEnd=function(r){r===mp&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=p2.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};function XS(r,e){const t=new Ap(e);if(t.push(r),t.err)throw t.msg||Gm[t.err];return t.result}var KS=Ap,ZS=XS,JS={Inflate:KS,inflate:ZS};const{Inflate:QS,inflate:eA}=JS;var $x=QS,tA=eA;const N2=[];for(let r=0;r<256;r++){let e=r;for(let t=0;t<8;t++)e&1?e=3988292384^e>>>1:e=e>>>1;N2[r]=e}const Gx=4294967295;function nA(r,e,t){let n=r;for(let s=0;s<t;s++)n=N2[(n^e[s])&255]^n>>>8;return n}function iA(r,e){return(nA(Gx,r,e)^Gx)>>>0}function Yx(r,e,t){const n=r.readUint32(),s=iA(new Uint8Array(r.buffer,r.byteOffset+r.offset-e-4,e),e);if(s!==n)throw new Error(`CRC mismatch for chunk ${t}. Expected ${n}, found ${s}`)}function j2(r,e,t){for(let n=0;n<t;n++)e[n]=r[n]}function P2(r,e,t,n){let s=0;for(;s<n;s++)e[s]=r[s];for(;s<t;s++)e[s]=r[s]+e[s-n]&255}function E2(r,e,t,n){let s=0;if(t.length===0)for(;s<n;s++)e[s]=r[s];else for(;s<n;s++)e[s]=r[s]+t[s]&255}function R2(r,e,t,n,s){let o=0;if(t.length===0){for(;o<s;o++)e[o]=r[o];for(;o<n;o++)e[o]=r[o]+(e[o-s]>>1)&255}else{for(;o<s;o++)e[o]=r[o]+(t[o]>>1)&255;for(;o<n;o++)e[o]=r[o]+(e[o-s]+t[o]>>1)&255}}function D2(r,e,t,n,s){let o=0;if(t.length===0){for(;o<s;o++)e[o]=r[o];for(;o<n;o++)e[o]=r[o]+e[o-s]&255}else{for(;o<s;o++)e[o]=r[o]+t[o]&255;for(;o<n;o++)e[o]=r[o]+sA(e[o-s],t[o],t[o-s])&255}}function sA(r,e,t){const n=r+e-t,s=Math.abs(n-r),o=Math.abs(n-e),d=Math.abs(n-t);return s<=o&&s<=d?r:o<=d?e:t}function rA(r,e,t,n,s,o){switch(r){case 0:j2(e,t,s);break;case 1:P2(e,t,s,o);break;case 2:E2(e,t,n,s);break;case 3:R2(e,t,n,s,o);break;case 4:D2(e,t,n,s,o);break;default:throw new Error(`Unsupported filter: ${r}`)}}const aA=new Uint16Array([255]),oA=new Uint8Array(aA.buffer),lA=oA[0]===255;function cA(r){const{data:e,width:t,height:n,channels:s,depth:o}=r,d=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],c=Math.ceil(o/8)*s,h=new Uint8Array(n*t*c);let f=0;for(let m=0;m<7;m++){const b=d[m],S=Math.ceil((t-b.x)/b.xStep),v=Math.ceil((n-b.y)/b.yStep);if(S<=0||v<=0)continue;const P=S*c,x=new Uint8Array(P);for(let k=0;k<v;k++){const N=e[f++],$=e.subarray(f,f+P);f+=P;const I=new Uint8Array(P);rA(N,$,I,x,P,c),x.set(I);for(let z=0;z<S;z++){const B=b.x+z*b.xStep,G=b.y+k*b.yStep;if(!(B>=t||G>=n))for(let te=0;te<c;te++)h[(G*t+B)*c+te]=I[z*c+te]}}}if(o===16){const m=new Uint16Array(h.buffer);if(lA)for(let b=0;b<m.length;b++)m[b]=dA(m[b]);return m}else return h}function dA(r){return(r&255)<<8|r>>8&255}const uA=new Uint16Array([255]),hA=new Uint8Array(uA.buffer),fA=hA[0]===255,pA=new Uint8Array(0);function Xx(r){const{data:e,width:t,height:n,channels:s,depth:o}=r,d=Math.ceil(o/8)*s,c=Math.ceil(o/8*s*t),h=new Uint8Array(n*c);let f=pA,m=0,b,S;for(let v=0;v<n;v++){switch(b=e.subarray(m+1,m+1+c),S=h.subarray(v*c,(v+1)*c),e[m]){case 0:j2(b,S,c);break;case 1:P2(b,S,c,d);break;case 2:E2(b,S,f,c);break;case 3:R2(b,S,f,c,d);break;case 4:D2(b,S,f,c,d);break;default:throw new Error(`Unsupported filter: ${e[m]}`)}f=S,m+=c+1}if(o===16){const v=new Uint16Array(h.buffer);if(fA)for(let P=0;P<v.length;P++)v[P]=gA(v[P]);return v}else return h}function gA(r){return(r&255)<<8|r>>8&255}const Og=Uint8Array.of(137,80,78,71,13,10,26,10);function Kx(r){if(!mA(r.readBytes(Og.length)))throw new Error("wrong PNG signature")}function mA(r){if(r.length<Og.length)return!1;for(let e=0;e<Og.length;e++)if(r[e]!==Og[e])return!1;return!0}const yA="tEXt",xA=0,L2=new TextDecoder("latin1");function bA(r){if(wA(r),r.length===0||r.length>79)throw new Error("keyword length must be between 1 and 79")}const vA=/^[\u0000-\u00FF]*$/;function wA(r){if(!vA.test(r))throw new Error("invalid latin1 text")}function SA(r,e,t){const n=M2(e);r[n]=AA(e,t-n.length-1)}function M2(r){for(r.mark();r.readByte()!==xA;);const e=r.offset;r.reset();const t=L2.decode(r.readBytes(e-r.offset-1));return r.skip(1),bA(t),t}function AA(r,e){return L2.decode(r.readBytes(e))}const pc={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},ym={UNKNOWN:-1,DEFLATE:0},Zx={UNKNOWN:-1,ADAPTIVE:0},xm={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Cg={NONE:0,BACKGROUND:1,PREVIOUS:2},bm={SOURCE:0,OVER:1};class CA extends by{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(e,t={}){super(e);const{checkCrc:n=!1}=t;this._checkCrc=n,this._inflator=new $x,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=ym.UNKNOWN,this._filterMethod=Zx.UNKNOWN,this._interlaceMethod=xm.UNKNOWN,this._colorType=pc.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(Kx(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeChunk(e,t)}return this.decodeImage(),this._png}decodeApng(){for(Kx(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeApngChunk(e,t)}return this.decodeApngImage(),this._apng}decodeChunk(e,t){const n=this.offset;switch(t){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case yA:SA(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-n!==e)throw new Error(`Length mismatch while decoding chunk ${t}`);this._checkCrc?Yx(this,e+4,t):this.skip(4)}decodeApngChunk(e,t){const n=this.offset;switch(t!=="fdAT"&&t!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),t){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,t),this.offset=n+e;break}if(this.offset-n!==e)throw new Error(`Length mismatch while decoding chunk ${t}`);this._checkCrc?Yx(this,e+4,t):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=TA(this.readUint8());const t=this.readUint8();this._colorType=t;let n;switch(t){case pc.GREYSCALE:n=1;break;case pc.TRUECOLOUR:n=3;break;case pc.INDEXED_COLOUR:n=1;break;case pc.GREYSCALE_ALPHA:n=2;break;case pc.TRUECOLOUR_ALPHA:n=4;break;case pc.UNKNOWN:default:throw new Error(`Unknown color type: ${t}`)}if(this._png.channels=n,this._compressionMethod=this.readUint8(),this._compressionMethod!==ym.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const t=e/3;this._hasPalette=!0;const n=[];this._palette=n;for(let s=0;s<t;s++)n.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const t=e,n=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,n,t)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let t=e,n=this.offset+this.byteOffset;if(n+=4,t-=4,this._inflator.push(new Uint8Array(this.buffer,n,t)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case pc.GREYSCALE:case pc.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let t=0;t<e/2;t++)this._transparency[t]=this.readUint16();break}case pc.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let t=0;for(;t<e;t++){const n=this.readByte();this._palette[t].push(n)}for(;t<this._palette.length;t++)this._palette[t].push(255);break}case pc.UNKNOWN:case pc.GREYSCALE_ALPHA:case pc.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const t=M2(this),n=this.readUint8();if(n!==ym.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${n}`);const s=this.readBytes(e-t.length-2);this._png.iccEmbeddedProfile={name:t,profile:tA(s)}}decodepHYs(){const e=this.readUint32(),t=this.readUint32(),n=this.readByte();this._png.resolution={x:e,y:t,unit:n}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const t={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},n=this._frames.at(e);if(n){if(n.data=Xx({data:n.data,width:n.width,height:n.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),e===0||n.xOffset===0&&n.yOffset===0&&n.width===this._png.width&&n.height===this._png.height)t.data=n.data;else{const s=this._apng.frames.at(e-1);this.disposeFrame(n,s,t),this.addFrameDataToCanvas(t,n)}this._apng.frames.push(t)}}return this._apng}disposeFrame(e,t,n){switch(e.disposeOp){case Cg.NONE:break;case Cg.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let o=0;o<this._png.width;o++){const d=(s*e.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)n.data[d+c]=0}break;case Cg.PREVIOUS:n.data.set(t.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,t){const n=1<<this._png.depth,s=(o,d)=>{const c=((o+t.yOffset)*this._png.width+t.xOffset+d)*this._png.channels,h=(o*t.width+d)*this._png.channels;return{index:c,frameIndex:h}};switch(t.blendOp){case bm.SOURCE:for(let o=0;o<t.height;o++)for(let d=0;d<t.width;d++){const{index:c,frameIndex:h}=s(o,d);for(let f=0;f<this._png.channels;f++)e.data[c+f]=t.data[h+f]}break;case bm.OVER:for(let o=0;o<t.height;o++)for(let d=0;d<t.width;d++){const{index:c,frameIndex:h}=s(o,d);for(let f=0;f<this._png.channels;f++){const m=t.data[h+this._png.channels-1]/n,b=f%(this._png.channels-1)===0?1:t.data[h+f],S=Math.floor(m*b+(1-m)*e.data[c+f]);e.data[c+f]+=S}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==Zx.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===xm.NO_INTERLACE)this._png.data=Xx({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===xm.ADAM7)this._png.data=cA({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,t=this._frames.at(-1);t?t.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Cg.NONE,blendOp:bm.SOURCE,data:e}),this._inflator=new $x,this._writingDataChunks=!1}}function TA(r){if(r!==1&&r!==2&&r!==4&&r!==8&&r!==16)throw new Error(`invalid bit depth: ${r}`);return r}var Jx;(function(r){r[r.UNKNOWN=0]="UNKNOWN",r[r.METRE=1]="METRE"})(Jx||(Jx={}));function _A(r,e){return new CA(r,e).decode()}var ei=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function vm(){ei.console&&typeof ei.console.log=="function"&&ei.console.log.apply(ei.console,arguments)}var Ys={log:vm,warn:function(r){ei.console&&(typeof ei.console.warn=="function"?ei.console.warn.apply(ei.console,arguments):vm.call(null,arguments))},error:function(r){ei.console&&(typeof ei.console.error=="function"?ei.console.error.apply(ei.console,arguments):vm(r))}};function wm(r,e,t){var n=new XMLHttpRequest;n.open("GET",r),n.responseType="blob",n.onload=function(){ih(n.response,e,t)},n.onerror=function(){Ys.error("could not download file")},n.send()}function Qx(r){var e=new XMLHttpRequest;e.open("HEAD",r,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Tg(r){try{r.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(e)}}var ih=ei.saveAs||((typeof window>"u"?"undefined":Rs(window))!=="object"||window!==ei?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(r,e,t){var n=ei.URL||ei.webkitURL,s=document.createElement("a");e=e||r.name||"download",s.download=e,s.rel="noopener",typeof r=="string"?(s.href=r,s.origin!==location.origin?Qx(s.href)?wm(r,e,t):Tg(s,s.target="_blank"):Tg(s)):(s.href=n.createObjectURL(r),setTimeout(function(){n.revokeObjectURL(s.href)},4e4),setTimeout(function(){Tg(s)},0))}:"msSaveOrOpenBlob"in navigator?function(r,e,t){if(e=e||r.name||"download",typeof r=="string")if(Qx(r))wm(r,e,t);else{var n=document.createElement("a");n.href=r,n.target="_blank",setTimeout(function(){Tg(n)})}else navigator.msSaveOrOpenBlob((function(s,o){return o===void 0?o={autoBom:!1}:Rs(o)!=="object"&&(Ys.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s})(r,t),e)}:function(r,e,t,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof r=="string")return wm(r,e,t);var s=r.type==="application/octet-stream",o=/constructor/i.test(ei.HTMLElement)||ei.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent);if((d||s&&o)&&(typeof FileReader>"u"?"undefined":Rs(FileReader))==="object"){var c=new FileReader;c.onloadend=function(){var m=c.result;m=d?m:m.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=m:location=m,n=null},c.readAsDataURL(r)}else{var h=ei.URL||ei.webkitURL,f=h.createObjectURL(r);n?n.location=f:location.href=f,n=null,setTimeout(function(){h.revokeObjectURL(f)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function I2(r){var e;r=r||"",this.ok=!1,r.charAt(0)=="#"&&(r=r.substr(1,6)),r={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[r=(r=r.replace(/ /g,"")).toLowerCase()]||r;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(c){return[parseInt(c[1]),parseInt(c[2]),parseInt(c[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(c){return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(c){return[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]}}],n=0;n<t.length;n++){var s=t[n].re,o=t[n].process,d=s.exec(r);d&&(e=o(d),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var c=this.r.toString(16),h=this.g.toString(16),f=this.b.toString(16);return c.length==1&&(c="0"+c),h.length==1&&(h="0"+h),f.length==1&&(f="0"+f),"#"+c+h+f}}var Fg=ei.atob.bind(ei),eb=ei.btoa.bind(ei);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Sm(r,e){var t=r[0],n=r[1],s=r[2],o=r[3];t=Xo(t,n,s,o,e[0],7,-680876936),o=Xo(o,t,n,s,e[1],12,-389564586),s=Xo(s,o,t,n,e[2],17,606105819),n=Xo(n,s,o,t,e[3],22,-1044525330),t=Xo(t,n,s,o,e[4],7,-176418897),o=Xo(o,t,n,s,e[5],12,1200080426),s=Xo(s,o,t,n,e[6],17,-1473231341),n=Xo(n,s,o,t,e[7],22,-45705983),t=Xo(t,n,s,o,e[8],7,1770035416),o=Xo(o,t,n,s,e[9],12,-1958414417),s=Xo(s,o,t,n,e[10],17,-42063),n=Xo(n,s,o,t,e[11],22,-1990404162),t=Xo(t,n,s,o,e[12],7,1804603682),o=Xo(o,t,n,s,e[13],12,-40341101),s=Xo(s,o,t,n,e[14],17,-1502002290),t=Ko(t,n=Xo(n,s,o,t,e[15],22,1236535329),s,o,e[1],5,-165796510),o=Ko(o,t,n,s,e[6],9,-1069501632),s=Ko(s,o,t,n,e[11],14,643717713),n=Ko(n,s,o,t,e[0],20,-373897302),t=Ko(t,n,s,o,e[5],5,-701558691),o=Ko(o,t,n,s,e[10],9,38016083),s=Ko(s,o,t,n,e[15],14,-660478335),n=Ko(n,s,o,t,e[4],20,-405537848),t=Ko(t,n,s,o,e[9],5,568446438),o=Ko(o,t,n,s,e[14],9,-1019803690),s=Ko(s,o,t,n,e[3],14,-187363961),n=Ko(n,s,o,t,e[8],20,1163531501),t=Ko(t,n,s,o,e[13],5,-1444681467),o=Ko(o,t,n,s,e[2],9,-51403784),s=Ko(s,o,t,n,e[7],14,1735328473),t=Zo(t,n=Ko(n,s,o,t,e[12],20,-1926607734),s,o,e[5],4,-378558),o=Zo(o,t,n,s,e[8],11,-2022574463),s=Zo(s,o,t,n,e[11],16,1839030562),n=Zo(n,s,o,t,e[14],23,-35309556),t=Zo(t,n,s,o,e[1],4,-1530992060),o=Zo(o,t,n,s,e[4],11,1272893353),s=Zo(s,o,t,n,e[7],16,-155497632),n=Zo(n,s,o,t,e[10],23,-1094730640),t=Zo(t,n,s,o,e[13],4,681279174),o=Zo(o,t,n,s,e[0],11,-358537222),s=Zo(s,o,t,n,e[3],16,-722521979),n=Zo(n,s,o,t,e[6],23,76029189),t=Zo(t,n,s,o,e[9],4,-640364487),o=Zo(o,t,n,s,e[12],11,-421815835),s=Zo(s,o,t,n,e[15],16,530742520),t=Jo(t,n=Zo(n,s,o,t,e[2],23,-995338651),s,o,e[0],6,-198630844),o=Jo(o,t,n,s,e[7],10,1126891415),s=Jo(s,o,t,n,e[14],15,-1416354905),n=Jo(n,s,o,t,e[5],21,-57434055),t=Jo(t,n,s,o,e[12],6,1700485571),o=Jo(o,t,n,s,e[3],10,-1894986606),s=Jo(s,o,t,n,e[10],15,-1051523),n=Jo(n,s,o,t,e[1],21,-2054922799),t=Jo(t,n,s,o,e[8],6,1873313359),o=Jo(o,t,n,s,e[15],10,-30611744),s=Jo(s,o,t,n,e[6],15,-1560198380),n=Jo(n,s,o,t,e[13],21,1309151649),t=Jo(t,n,s,o,e[4],6,-145523070),o=Jo(o,t,n,s,e[11],10,-1120210379),s=Jo(s,o,t,n,e[2],15,718787259),n=Jo(n,s,o,t,e[9],21,-343485551),r[0]=Ru(t,r[0]),r[1]=Ru(n,r[1]),r[2]=Ru(s,r[2]),r[3]=Ru(o,r[3])}function r0(r,e,t,n,s,o){return e=Ru(Ru(e,r),Ru(n,o)),Ru(e<<s|e>>>32-s,t)}function Xo(r,e,t,n,s,o,d){return r0(e&t|~e&n,r,e,s,o,d)}function Ko(r,e,t,n,s,o,d){return r0(e&n|t&~n,r,e,s,o,d)}function Zo(r,e,t,n,s,o,d){return r0(e^t^n,r,e,s,o,d)}function Jo(r,e,t,n,s,o,d){return r0(t^(e|~n),r,e,s,o,d)}function z2(r){var e,t=r.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=r.length;e+=64)Sm(n,kA(r.substring(e-64,e)));r=r.substring(e-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<r.length;e++)s[e>>2]|=r.charCodeAt(e)<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(Sm(n,s),e=0;e<16;e++)s[e]=0;return s[14]=8*t,Sm(n,s),n}function kA(r){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=r.charCodeAt(e)+(r.charCodeAt(e+1)<<8)+(r.charCodeAt(e+2)<<16)+(r.charCodeAt(e+3)<<24);return t}var tb="0123456789abcdef".split("");function NA(r){for(var e="",t=0;t<4;t++)e+=tb[r>>8*t+4&15]+tb[r>>8*t&15];return e}function jA(r){return String.fromCharCode(255&r,(65280&r)>>8,(16711680&r)>>16,(4278190080&r)>>24)}function Xm(r){return z2(r).map(jA).join("")}var PA=(function(r){for(var e=0;e<r.length;e++)r[e]=NA(r[e]);return r.join("")})(z2("hello"))!="5d41402abc4b2a76b9719d911017c592";function Ru(r,e){if(PA){var t=(65535&r)+(65535&e);return(r>>16)+(e>>16)+(t>>16)<<16|65535&t}return r+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Km(r,e){var t,n,s,o;if(r!==t){for(var d=(s=r,o=1+(256/r.length|0),new Array(o+1).join(s)),c=[],h=0;h<256;h++)c[h]=h;var f=0;for(h=0;h<256;h++){var m=c[h];f=(f+m+d.charCodeAt(h))%256,c[h]=c[f],c[f]=m}t=r,n=c}else c=n;var b=e.length,S=0,v=0,P="";for(h=0;h<b;h++)v=(v+(m=c[S=(S+1)%256]))%256,c[S]=c[v],c[v]=m,d=c[(c[S]+c[v])%256],P+=String.fromCharCode(e.charCodeAt(h)^d);return P}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var nb={print:4,modify:8,copy:16,"annot-forms":32};function tf(r,e,t,n){this.v=1,this.r=2;var s=192;r.forEach(function(c){if(nb.perm!==void 0)throw new Error("Invalid permission: "+c);s+=nb[c]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var o=(e+this.padding).substr(0,32),d=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(o,d),this.P=-(1+(255^s)),this.encryptionKey=Xm(o+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Km(this.encryptionKey,this.padding)}function nf(r){if(/[^\u0000-\u00ff]/.test(r))throw new Error("Invalid PDF Name Object: "+r+", Only accept ASCII characters.");for(var e="",t=r.length,n=0;n<t;n++){var s=r.charCodeAt(n);e+=s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?"#"+("0"+s.toString(16)).slice(-2):r[n]}return e}function ib(r){if(Rs(r)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,n,s){if(s=s||!1,typeof t!="string"||typeof n!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var o=Math.random().toString(35);return e[t][o]=[n,!!s],o},this.unsubscribe=function(t){for(var n in e)if(e[n][t])return delete e[n][t],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var o in e[t]){var d=e[t][o];try{d[0].apply(r,n)}catch(c){ei.console&&Ys.error("jsPDF PubSub Error",c.message,c)}d[1]&&s.push(o)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Zg(r){if(!(this instanceof Zg))return new Zg(r);var e="opacity,stroke-opacity".split(",");for(var t in r)r.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=r[t]);this.id="",this.objectNumber=-1}function B2(r,e){this.gState=r,this.matrix=e,this.id="",this.objectNumber=-1}function sh(r,e,t,n,s){if(!(this instanceof sh))return new sh(r,e,t,n,s);this.type=r==="axial"?2:3,this.coords=e,this.colors=t,B2.call(this,n,s)}function of(r,e,t,n,s){if(!(this instanceof of))return new of(r,e,t,n,s);this.boundingBox=r,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,B2.call(this,n,s)}function jn(r){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],s=arguments[2],o=arguments[3],d=[],c=1,h=16,f="S",m=null;Rs(r=r||{})==="object"&&(t=r.orientation,n=r.unit||n,s=r.format||s,o=r.compress||r.compressPdf||o,(m=r.encryption||null)!==null&&(m.userPassword=m.userPassword||"",m.ownerPassword=m.ownerPassword||"",m.userPermissions=m.userPermissions||[]),c=typeof r.userUnit=="number"?Math.abs(r.userUnit):1,r.precision!==void 0&&(e=r.precision),r.floatPrecision!==void 0&&(h=r.floatPrecision),f=r.defaultPathOperation||"S"),d=r.filters||(o===!0?["FlateEncode"]:d),n=n||"mm",t=(""+(t||"P")).toLowerCase();var b=r.putOnlyUsedFonts||!1,S={},v={internal:{},__private__:{}};v.__private__.PubSub=ib;var P="1.3",x=v.__private__.getPdfVersion=function(){return P};v.__private__.setPdfVersion=function(j){P=j};var k={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};v.__private__.getPageFormats=function(){return k};var N=v.__private__.getPageFormat=function(j){return k[j]};s=s||"a4";var $="compat",I="advanced",z=$;function B(){this.saveGraphicsState(),fe(new en(Fn,0,0,-Fn,0,yn()*Fn).toString()+" cm"),this.setFontSize(this.getFontSize()/Fn),f="n",z=I}function G(){this.restoreGraphicsState(),f="S",z=$}var te=v.__private__.combineFontStyleAndFontWeight=function(j,ne){if(j=="bold"&&ne=="normal"||j=="bold"&&ne==400||j=="normal"&&ne=="italic"||j=="bold"&&ne=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ne&&(j=ne==400||ne==="normal"?j==="italic"?"italic":"normal":ne!=700&&ne!=="bold"||j!=="normal"?(ne==700?"bold":ne)+""+j:"bold"),j};v.advancedAPI=function(j){var ne=z===$;return ne&&B.call(this),typeof j!="function"||(j(this),ne&&G.call(this)),this},v.compatAPI=function(j){var ne=z===I;return ne&&G.call(this),typeof j!="function"||(j(this),ne&&B.call(this)),this},v.isAdvancedAPI=function(){return z===I};var F,H=function(j){if(z!==I)throw new Error(j+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},Q=v.roundToPrecision=v.__private__.roundToPrecision=function(j,ne){var we=e||ne;if(isNaN(j)||isNaN(we))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return j.toFixed(we).replace(/0+$/,"")};F=v.hpf=v.__private__.hpf=typeof h=="number"?function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.hpf");return Q(j,h)}:h==="smart"?function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.hpf");return Q(j,j>-1&&j<1?16:5)}:function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.hpf");return Q(j,16)};var M=v.f2=v.__private__.f2=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.f2");return Q(j,2)},T=v.__private__.f3=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.f3");return Q(j,3)},R=v.scale=v.__private__.scale=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.scale");return z===$?j*Fn:z===I?j:void 0},Z=function(j){return R((function(ne){return z===$?yn()-ne:z===I?ne:void 0})(j))};v.__private__.setPrecision=v.setPrecision=function(j){typeof parseInt(j,10)=="number"&&(e=parseInt(j,10))};var se,V="00000000000000000000000000000000",ee=v.__private__.getFileId=function(){return V},ae=v.__private__.setFileId=function(j){return V=j!==void 0&&/^[a-fA-F0-9]{32}$/.test(j)?j.toUpperCase():V.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),m!==null&&(Wn=new tf(m.userPermissions,m.userPassword,m.ownerPassword,V)),V};v.setFileId=function(j){return ae(j),this},v.getFileId=function(){return ee()};var Ce=v.__private__.convertDateToPDFDate=function(j){var ne=j.getTimezoneOffset(),we=ne<0?"+":"-",Re=Math.floor(Math.abs(ne/60)),Fe=Math.abs(ne%60),st=[we,K(Re),"'",K(Fe),"'"].join("");return["D:",j.getFullYear(),K(j.getMonth()+1),K(j.getDate()),K(j.getHours()),K(j.getMinutes()),K(j.getSeconds()),st].join("")},xe=v.__private__.convertPDFDateToDate=function(j){var ne=parseInt(j.substr(2,4),10),we=parseInt(j.substr(6,2),10)-1,Re=parseInt(j.substr(8,2),10),Fe=parseInt(j.substr(10,2),10),st=parseInt(j.substr(12,2),10),yt=parseInt(j.substr(14,2),10);return new Date(ne,we,Re,Fe,st,yt,0)},J=v.__private__.setCreationDate=function(j){var ne;if(j===void 0&&(j=new Date),j instanceof Date)ne=Ce(j);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(j))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ne=j}return se=ne},D=v.__private__.getCreationDate=function(j){var ne=se;return j==="jsDate"&&(ne=xe(se)),ne};v.setCreationDate=function(j){return J(j),this},v.getCreationDate=function(j){return D(j)};var W,K=v.__private__.padd2=function(j){return("0"+parseInt(j)).slice(-2)},ue=v.__private__.padd2Hex=function(j){return("00"+(j=j.toString())).substr(j.length)},Te=0,Pe=[],Ve=[],De=0,et=[],ot=[],at=!1,ht=Ve;v.__private__.setCustomOutputDestination=function(j){at=!0,ht=j};var xt=function(j){at||(ht=j)};v.__private__.resetCustomOutputDestination=function(){at=!1,ht=Ve};var fe=v.__private__.out=function(j){return j=j.toString(),De+=j.length+1,ht.push(j),ht},Nt=v.__private__.write=function(j){return fe(arguments.length===1?j.toString():Array.prototype.join.call(arguments," "))},zt=v.__private__.getArrayBuffer=function(j){for(var ne=j.length,we=new ArrayBuffer(ne),Re=new Uint8Array(we);ne--;)Re[ne]=j.charCodeAt(ne);return we},Bt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];v.__private__.getStandardFonts=function(){return Bt};var it=r.fontSize||16;v.__private__.setFontSize=v.setFontSize=function(j){return it=z===I?j/Fn:j,this};var qt,vt=v.__private__.getFontSize=v.getFontSize=function(){return z===$?it:it*Fn},Dt=r.R2L||!1;v.__private__.setR2L=v.setR2L=function(j){return Dt=j,this},v.__private__.getR2L=v.getR2L=function(){return Dt};var Ot,sn=v.__private__.setZoomMode=function(j){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(j))qt=j;else if(isNaN(j)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(j)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+j+'" is not recognized.');qt=j}else qt=parseInt(j,10)};v.__private__.getZoomMode=function(){return qt};var kt,Lt=v.__private__.setPageMode=function(j){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(j)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+j+'" is not recognized.');Ot=j};v.__private__.getPageMode=function(){return Ot};var Jn=v.__private__.setLayoutMode=function(j){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(j)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+j+'" is not recognized.');kt=j};v.__private__.getLayoutMode=function(){return kt},v.__private__.setDisplayMode=v.setDisplayMode=function(j,ne,we){return sn(j),Jn(ne),Lt(we),this};var pt={title:"",subject:"",author:"",keywords:"",creator:""};v.__private__.getDocumentProperty=function(j){if(Object.keys(pt).indexOf(j)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return pt[j]},v.__private__.getDocumentProperties=function(){return pt},v.__private__.setDocumentProperties=v.setProperties=v.setDocumentProperties=function(j){for(var ne in pt)pt.hasOwnProperty(ne)&&j[ne]&&(pt[ne]=j[ne]);return this},v.__private__.setDocumentProperty=function(j,ne){if(Object.keys(pt).indexOf(j)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return pt[j]=ne};var jt,Fn,tn,zn,Pn,dn={},An={},lt=[],nn={},Xt={},Kt={},Cn={},Vi=null,Vn=0,bn=[],Qt=new ib(v),Cr=r.hotfixes||[],Ks={},zr={},Br=[],en=function j(ne,we,Re,Fe,st,yt){if(!(this instanceof j))return new j(ne,we,Re,Fe,st,yt);isNaN(ne)&&(ne=1),isNaN(we)&&(we=0),isNaN(Re)&&(Re=0),isNaN(Fe)&&(Fe=1),isNaN(st)&&(st=0),isNaN(yt)&&(yt=0),this._matrix=[ne,we,Re,Fe,st,yt]};Object.defineProperty(en.prototype,"sx",{get:function(){return this._matrix[0]},set:function(j){this._matrix[0]=j}}),Object.defineProperty(en.prototype,"shy",{get:function(){return this._matrix[1]},set:function(j){this._matrix[1]=j}}),Object.defineProperty(en.prototype,"shx",{get:function(){return this._matrix[2]},set:function(j){this._matrix[2]=j}}),Object.defineProperty(en.prototype,"sy",{get:function(){return this._matrix[3]},set:function(j){this._matrix[3]=j}}),Object.defineProperty(en.prototype,"tx",{get:function(){return this._matrix[4]},set:function(j){this._matrix[4]=j}}),Object.defineProperty(en.prototype,"ty",{get:function(){return this._matrix[5]},set:function(j){this._matrix[5]=j}}),Object.defineProperty(en.prototype,"a",{get:function(){return this._matrix[0]},set:function(j){this._matrix[0]=j}}),Object.defineProperty(en.prototype,"b",{get:function(){return this._matrix[1]},set:function(j){this._matrix[1]=j}}),Object.defineProperty(en.prototype,"c",{get:function(){return this._matrix[2]},set:function(j){this._matrix[2]=j}}),Object.defineProperty(en.prototype,"d",{get:function(){return this._matrix[3]},set:function(j){this._matrix[3]=j}}),Object.defineProperty(en.prototype,"e",{get:function(){return this._matrix[4]},set:function(j){this._matrix[4]=j}}),Object.defineProperty(en.prototype,"f",{get:function(){return this._matrix[5]},set:function(j){this._matrix[5]=j}}),Object.defineProperty(en.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(en.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(en.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(en.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),en.prototype.join=function(j){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(F).join(j)},en.prototype.multiply=function(j){var ne=j.sx*this.sx+j.shy*this.shx,we=j.sx*this.shy+j.shy*this.sy,Re=j.shx*this.sx+j.sy*this.shx,Fe=j.shx*this.shy+j.sy*this.sy,st=j.tx*this.sx+j.ty*this.shx+this.tx,yt=j.tx*this.shy+j.ty*this.sy+this.ty;return new en(ne,we,Re,Fe,st,yt)},en.prototype.decompose=function(){var j=this.sx,ne=this.shy,we=this.shx,Re=this.sy,Fe=this.tx,st=this.ty,yt=Math.sqrt(j*j+ne*ne),Gt=(j/=yt)*we+(ne/=yt)*Re;we-=j*Gt,Re-=ne*Gt;var xn=Math.sqrt(we*we+Re*Re);return Gt/=xn,j*(Re/=xn)<ne*(we/=xn)&&(j=-j,ne=-ne,Gt=-Gt,yt=-yt),{scale:new en(yt,0,0,xn,0,0),translate:new en(1,0,0,1,Fe,st),rotate:new en(j,ne,-ne,j,0,0),skew:new en(1,0,Gt,1,0,0)}},en.prototype.toString=function(j){return this.join(" ")},en.prototype.inversed=function(){var j=this.sx,ne=this.shy,we=this.shx,Re=this.sy,Fe=this.tx,st=this.ty,yt=1/(j*Re-ne*we),Gt=Re*yt,xn=-ne*yt,pn=-we*yt,Qn=j*yt;return new en(Gt,xn,pn,Qn,-Gt*Fe-pn*st,-xn*Fe-Qn*st)},en.prototype.applyToPoint=function(j){var ne=j.x*this.sx+j.y*this.shx+this.tx,we=j.x*this.shy+j.y*this.sy+this.ty;return new Ka(ne,we)},en.prototype.applyToRectangle=function(j){var ne=this.applyToPoint(j),we=this.applyToPoint(new Ka(j.x+j.w,j.y+j.h));return new Zs(ne.x,ne.y,we.x-ne.x,we.y-ne.y)},en.prototype.clone=function(){var j=this.sx,ne=this.shy,we=this.shx,Re=this.sy,Fe=this.tx,st=this.ty;return new en(j,ne,we,Re,Fe,st)},v.Matrix=en;var Or=v.matrixMult=function(j,ne){return ne.multiply(j)},ja=new en(1,0,0,1,0,0);v.unitMatrix=v.identityMatrix=ja;var fa=function(j,ne){if(!Xt[j]){var we=(ne instanceof sh?"Sh":"P")+(Object.keys(nn).length+1).toString(10);ne.id=we,Xt[j]=we,nn[we]=ne,Qt.publish("addPattern",ne)}};v.ShadingPattern=sh,v.TilingPattern=of,v.addShadingPattern=function(j,ne){return H("addShadingPattern()"),fa(j,ne),this},v.beginTilingPattern=function(j){H("beginTilingPattern()"),Ra(j.boundingBox[0],j.boundingBox[1],j.boundingBox[2]-j.boundingBox[0],j.boundingBox[3]-j.boundingBox[1],j.matrix)},v.endTilingPattern=function(j,ne){H("endTilingPattern()"),ne.stream=ot[W].join(`
`),fa(j,ne),Qt.publish("endTilingPattern",ne),Br.pop().restore()};var Ct,pi=v.__private__.newObject=function(){var j=ti();return vs(j,!0),j},ti=v.__private__.newObjectDeferred=function(){return Te++,Pe[Te]=function(){return De},Te},vs=function(j,ne){return ne=typeof ne=="boolean"&&ne,Pe[j]=De,ne&&fe(j+" 0 obj"),j},Ji=v.__private__.newAdditionalObject=function(){var j={objId:ti(),content:""};return et.push(j),j},Ds=ti(),Ti=ti(),Si=v.__private__.decodeColorString=function(j){var ne=j.split(" ");if(ne.length!==2||ne[1]!=="g"&&ne[1]!=="G")ne.length!==5||ne[4]!=="k"&&ne[4]!=="K"||(ne=[(1-ne[0])*(1-ne[3]),(1-ne[1])*(1-ne[3]),(1-ne[2])*(1-ne[3]),"r"]);else{var we=parseFloat(ne[0]);ne=[we,we,we,"r"]}for(var Re="#",Fe=0;Fe<3;Fe++)Re+=("0"+Math.floor(255*parseFloat(ne[Fe])).toString(16)).slice(-2);return Re},Tr=v.__private__.encodeColorString=function(j){var ne;typeof j=="string"&&(j={ch1:j});var we=j.ch1,Re=j.ch2,Fe=j.ch3,st=j.ch4,yt=j.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof we=="string"&&we.charAt(0)!=="#"){var Gt=new I2(we);if(Gt.ok)we=Gt.toHex();else if(!/^\d*\.?\d*$/.test(we))throw new Error('Invalid color "'+we+'" passed to jsPDF.encodeColorString.')}if(typeof we=="string"&&/^#[0-9A-Fa-f]{3}$/.test(we)&&(we="#"+we[1]+we[1]+we[2]+we[2]+we[3]+we[3]),typeof we=="string"&&/^#[0-9A-Fa-f]{6}$/.test(we)){var xn=parseInt(we.substr(1),16);we=xn>>16&255,Re=xn>>8&255,Fe=255&xn}if(Re===void 0||st===void 0&&we===Re&&Re===Fe)ne=typeof we=="string"?we+" "+yt[0]:j.precision===2?M(we/255)+" "+yt[0]:T(we/255)+" "+yt[0];else if(st===void 0||Rs(st)==="object"){if(st&&!isNaN(st.a)&&st.a===0)return["1.","1.","1.",yt[1]].join(" ");ne=typeof we=="string"?[we,Re,Fe,yt[1]].join(" "):j.precision===2?[M(we/255),M(Re/255),M(Fe/255),yt[1]].join(" "):[T(we/255),T(Re/255),T(Fe/255),yt[1]].join(" ")}else ne=typeof we=="string"?[we,Re,Fe,st,yt[2]].join(" "):j.precision===2?[M(we),M(Re),M(Fe),M(st),yt[2]].join(" "):[T(we),T(Re),T(Fe),T(st),yt[2]].join(" ");return ne},pa=v.__private__.getFilters=function(){return d},qa=v.__private__.putStream=function(j){var ne=(j=j||{}).data||"",we=j.filters||pa(),Re=j.alreadyAppliedFilters||[],Fe=j.addLength1||!1,st=ne.length,yt=j.objectId,Gt=function(Ei){return Ei};if(m!==null&&yt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");m!==null&&(Gt=Wn.encryptor(yt,0));var xn={};we===!0&&(we=["FlateEncode"]);var pn=j.additionalKeyValues||[],Qn=(xn=jn.API.processDataByFilters!==void 0?jn.API.processDataByFilters(ne,we):{data:ne,reverseChain:[]}).reverseChain+(Array.isArray(Re)?Re.join(" "):Re.toString());if(xn.data.length!==0&&(pn.push({key:"Length",value:xn.data.length}),Fe===!0&&pn.push({key:"Length1",value:st})),Qn.length!=0)if(Qn.split("/").length-1==1)pn.push({key:"Filter",value:Qn});else{pn.push({key:"Filter",value:"["+Qn+"]"});for(var vi=0;vi<pn.length;vi+=1)if(pn[vi].key==="DecodeParms"){for(var Us=[],ji=0;ji<xn.reverseChain.split("/").length-1;ji+=1)Us.push("null");Us.push(pn[vi].value),pn[vi].value="["+Us.join(" ")+"]"}}fe("<<");for(var Wi=0;Wi<pn.length;Wi++)fe("/"+pn[Wi].key+" "+pn[Wi].value);fe(">>"),xn.data.length!==0&&(fe("stream"),fe(Gt(xn.data)),fe("endstream"))},Yl=v.__private__.putPage=function(j){var ne=j.number,we=j.data,Re=j.objId,Fe=j.contentsObjId;vs(Re,!0),fe("<</Type /Page"),fe("/Parent "+j.rootDictionaryObjId+" 0 R"),fe("/Resources "+j.resourceDictionaryObjId+" 0 R"),fe("/MediaBox ["+parseFloat(F(j.mediaBox.bottomLeftX))+" "+parseFloat(F(j.mediaBox.bottomLeftY))+" "+F(j.mediaBox.topRightX)+" "+F(j.mediaBox.topRightY)+"]"),j.cropBox!==null&&fe("/CropBox ["+F(j.cropBox.bottomLeftX)+" "+F(j.cropBox.bottomLeftY)+" "+F(j.cropBox.topRightX)+" "+F(j.cropBox.topRightY)+"]"),j.bleedBox!==null&&fe("/BleedBox ["+F(j.bleedBox.bottomLeftX)+" "+F(j.bleedBox.bottomLeftY)+" "+F(j.bleedBox.topRightX)+" "+F(j.bleedBox.topRightY)+"]"),j.trimBox!==null&&fe("/TrimBox ["+F(j.trimBox.bottomLeftX)+" "+F(j.trimBox.bottomLeftY)+" "+F(j.trimBox.topRightX)+" "+F(j.trimBox.topRightY)+"]"),j.artBox!==null&&fe("/ArtBox ["+F(j.artBox.bottomLeftX)+" "+F(j.artBox.bottomLeftY)+" "+F(j.artBox.topRightX)+" "+F(j.artBox.topRightY)+"]"),typeof j.userUnit=="number"&&j.userUnit!==1&&fe("/UserUnit "+j.userUnit),Qt.publish("putPage",{objId:Re,pageContext:bn[ne],pageNumber:ne,page:we}),fe("/Contents "+Fe+" 0 R"),fe(">>"),fe("endobj");var st=we.join(`
`);return z===I&&(st+=`
Q`),vs(Fe,!0),qa({data:st,filters:pa(),objectId:Fe}),fe("endobj"),Re},Va=v.__private__.putPages=function(){var j,ne,we=[];for(j=1;j<=Vn;j++)bn[j].objId=ti(),bn[j].contentsObjId=ti();for(j=1;j<=Vn;j++)we.push(Yl({number:j,data:ot[j],objId:bn[j].objId,contentsObjId:bn[j].contentsObjId,mediaBox:bn[j].mediaBox,cropBox:bn[j].cropBox,bleedBox:bn[j].bleedBox,trimBox:bn[j].trimBox,artBox:bn[j].artBox,userUnit:bn[j].userUnit,rootDictionaryObjId:Ds,resourceDictionaryObjId:Ti}));vs(Ds,!0),fe("<</Type /Pages");var Re="/Kids [";for(ne=0;ne<Vn;ne++)Re+=we[ne]+" 0 R ";fe(Re+"]"),fe("/Count "+Vn),fe(">>"),fe("endobj"),Qt.publish("postPutPages")},Wa=function(j){Qt.publish("putFont",{font:j,out:fe,newObject:pi,putStream:qa}),j.isAlreadyPutted!==!0&&(j.objectNumber=pi(),fe("<<"),fe("/Type /Font"),fe("/BaseFont /"+nf(j.postScriptName)),fe("/Subtype /Type1"),typeof j.encoding=="string"&&fe("/Encoding /"+j.encoding),fe("/FirstChar 32"),fe("/LastChar 255"),fe(">>"),fe("endobj"))},jo=function(j){j.objectNumber=pi();var ne=[];ne.push({key:"Type",value:"/XObject"}),ne.push({key:"Subtype",value:"/Form"}),ne.push({key:"BBox",value:"["+[F(j.x),F(j.y),F(j.x+j.width),F(j.y+j.height)].join(" ")+"]"}),ne.push({key:"Matrix",value:"["+j.matrix.toString()+"]"});var we=j.pages[1].join(`
`);qa({data:we,additionalKeyValues:ne,objectId:j.objectNumber}),fe("endobj")},Gn=function(j,ne){ne||(ne=21);var we=pi(),Re=(function(yt,Gt){var xn,pn=[],Qn=1/(Gt-1);for(xn=0;xn<1;xn+=Qn)pn.push(xn);if(pn.push(1),yt[0].offset!=0){var vi={offset:0,color:yt[0].color};yt.unshift(vi)}if(yt[yt.length-1].offset!=1){var Us={offset:1,color:yt[yt.length-1].color};yt.push(Us)}for(var ji="",Wi=0,Ei=0;Ei<pn.length;Ei++){for(xn=pn[Ei];xn>yt[Wi+1].offset;)Wi++;var ks=yt[Wi].offset,as=(xn-ks)/(yt[Wi+1].offset-ks),uo=yt[Wi].color,jr=yt[Wi+1].color;ji+=ue(Math.round((1-as)*uo[0]+as*jr[0]).toString(16))+ue(Math.round((1-as)*uo[1]+as*jr[1]).toString(16))+ue(Math.round((1-as)*uo[2]+as*jr[2]).toString(16))}return ji.trim()})(j.colors,ne),Fe=[];Fe.push({key:"FunctionType",value:"0"}),Fe.push({key:"Domain",value:"[0.0 1.0]"}),Fe.push({key:"Size",value:"["+ne+"]"}),Fe.push({key:"BitsPerSample",value:"8"}),Fe.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Fe.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),qa({data:Re,additionalKeyValues:Fe,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:we}),fe("endobj"),j.objectNumber=pi(),fe("<< /ShadingType "+j.type),fe("/ColorSpace /DeviceRGB");var st="/Coords ["+F(parseFloat(j.coords[0]))+" "+F(parseFloat(j.coords[1]))+" ";j.type===2?st+=F(parseFloat(j.coords[2]))+" "+F(parseFloat(j.coords[3])):st+=F(parseFloat(j.coords[2]))+" "+F(parseFloat(j.coords[3]))+" "+F(parseFloat(j.coords[4]))+" "+F(parseFloat(j.coords[5])),fe(st+="]"),j.matrix&&fe("/Matrix ["+j.matrix.toString()+"]"),fe("/Function "+we+" 0 R"),fe("/Extend [true true]"),fe(">>"),fe("endobj")},Fr=function(j,ne){var we=ti(),Re=pi();ne.push({resourcesOid:we,objectOid:Re}),j.objectNumber=Re;var Fe=[];Fe.push({key:"Type",value:"/Pattern"}),Fe.push({key:"PatternType",value:"1"}),Fe.push({key:"PaintType",value:"1"}),Fe.push({key:"TilingType",value:"1"}),Fe.push({key:"BBox",value:"["+j.boundingBox.map(F).join(" ")+"]"}),Fe.push({key:"XStep",value:F(j.xStep)}),Fe.push({key:"YStep",value:F(j.yStep)}),Fe.push({key:"Resources",value:we+" 0 R"}),j.matrix&&Fe.push({key:"Matrix",value:"["+j.matrix.toString()+"]"}),qa({data:j.stream,additionalKeyValues:Fe,objectId:j.objectNumber}),fe("endobj")},xi=function(j){for(var ne in j.objectNumber=pi(),fe("<<"),j)switch(ne){case"opacity":fe("/ca "+M(j[ne]));break;case"stroke-opacity":fe("/CA "+M(j[ne]))}fe(">>"),fe("endobj")},ga=function(j){vs(j.resourcesOid,!0),fe("<<"),fe("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var ne in fe("/Font <<"),dn)dn.hasOwnProperty(ne)&&(b===!1||b===!0&&S.hasOwnProperty(ne))&&fe("/"+ne+" "+dn[ne].objectNumber+" 0 R");fe(">>")})(),(function(){if(Object.keys(nn).length>0){for(var ne in fe("/Shading <<"),nn)nn.hasOwnProperty(ne)&&nn[ne]instanceof sh&&nn[ne].objectNumber>=0&&fe("/"+ne+" "+nn[ne].objectNumber+" 0 R");Qt.publish("putShadingPatternDict"),fe(">>")}})(),(function(ne){if(Object.keys(nn).length>0){for(var we in fe("/Pattern <<"),nn)nn.hasOwnProperty(we)&&nn[we]instanceof v.TilingPattern&&nn[we].objectNumber>=0&&nn[we].objectNumber<ne&&fe("/"+we+" "+nn[we].objectNumber+" 0 R");Qt.publish("putTilingPatternDict"),fe(">>")}})(j.objectOid),(function(){if(Object.keys(Kt).length>0){var ne;for(ne in fe("/ExtGState <<"),Kt)Kt.hasOwnProperty(ne)&&Kt[ne].objectNumber>=0&&fe("/"+ne+" "+Kt[ne].objectNumber+" 0 R");Qt.publish("putGStateDict"),fe(">>")}})(),(function(){for(var ne in fe("/XObject <<"),Ks)Ks.hasOwnProperty(ne)&&Ks[ne].objectNumber>=0&&fe("/"+ne+" "+Ks[ne].objectNumber+" 0 R");Qt.publish("putXobjectDict"),fe(">>")})(),fe(">>"),fe("endobj")},Rn=function(j){An[j.fontName]=An[j.fontName]||{},An[j.fontName][j.fontStyle]=j.id},Qo=function(j,ne,we,Re,Fe){var st={id:"F"+(Object.keys(dn).length+1).toString(10),postScriptName:j,fontName:ne,fontStyle:we,encoding:Re,isStandardFont:Fe||!1,metadata:{}};return Qt.publish("addFont",{font:st,instance:this}),dn[st.id]=st,Rn(st),st.id},gi=v.__private__.pdfEscape=v.pdfEscape=function(j,ne){return(function(we,Re){var Fe,st,yt,Gt,xn,pn,Qn,vi,Us;if(yt=(Re=Re||{}).sourceEncoding||"Unicode",xn=Re.outputEncoding,(Re.autoencode||xn)&&dn[jt].metadata&&dn[jt].metadata[yt]&&dn[jt].metadata[yt].encoding&&(Gt=dn[jt].metadata[yt].encoding,!xn&&dn[jt].encoding&&(xn=dn[jt].encoding),!xn&&Gt.codePages&&(xn=Gt.codePages[0]),typeof xn=="string"&&(xn=Gt[xn]),xn)){for(Qn=!1,pn=[],Fe=0,st=we.length;Fe<st;Fe++)(vi=xn[we.charCodeAt(Fe)])?pn.push(String.fromCharCode(vi)):pn.push(we[Fe]),pn[Fe].charCodeAt(0)>>8&&(Qn=!0);we=pn.join("")}for(Fe=we.length;Qn===void 0&&Fe!==0;)we.charCodeAt(Fe-1)>>8&&(Qn=!0),Fe--;if(!Qn)return we;for(pn=Re.noBOM?[]:[254,255],Fe=0,st=we.length;Fe<st;Fe++){if((Us=(vi=we.charCodeAt(Fe))>>8)>>8)throw new Error("Character at position "+Fe+" of string '"+we+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");pn.push(Us),pn.push(vi-(Us<<8))}return String.fromCharCode.apply(void 0,pn)})(j,ne).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ma=v.__private__.beginPage=function(j){ot[++Vn]=[],bn[Vn]={objId:0,contentsObjId:0,userUnit:Number(c),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(j[0]),topRightY:Number(j[1])}},tl(Vn),xt(ot[W])},Pa=function(j,ne){var we,Re,Fe;switch(t=ne||t,typeof j=="string"&&(we=N(j.toLowerCase()),Array.isArray(we)&&(Re=we[0],Fe=we[1])),Array.isArray(j)&&(Re=j[0]*Fn,Fe=j[1]*Fn),isNaN(Re)&&(Re=s[0],Fe=s[1]),(Re>14400||Fe>14400)&&(Ys.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Re=Math.min(14400,Re),Fe=Math.min(14400,Fe)),s=[Re,Fe],t.substr(0,1)){case"l":Fe>Re&&(s=[Fe,Re]);break;case"p":Re>Fe&&(s=[Fe,Re])}ma(s),Bn(es),fe(rn),Zt!==0&&fe(Zt+" J"),Yn!==0&&fe(Yn+" j"),Qt.publish("addPage",{pageNumber:Vn})},el=function(j){j>0&&j<=Vn&&(ot.splice(j,1),bn.splice(j,1),Vn--,W>Vn&&(W=Vn),this.setPage(W))},tl=function(j){j>0&&j<=Vn&&(W=j)},$a=v.__private__.getNumberOfPages=v.getNumberOfPages=function(){return ot.length-1},td=function(j,ne,we){var Re,Fe=void 0;return we=we||{},j=j!==void 0?j:dn[jt].fontName,ne=ne!==void 0?ne:dn[jt].fontStyle,Re=j.toLowerCase(),An[Re]!==void 0&&An[Re][ne]!==void 0?Fe=An[Re][ne]:An[j]!==void 0&&An[j][ne]!==void 0?Fe=An[j][ne]:we.disableWarning===!1&&Ys.warn("Unable to look up font label for font '"+j+"', '"+ne+"'. Refer to getFontList() for available fonts."),Fe||we.noFallback||(Fe=An.times[ne])==null&&(Fe=An.times.normal),Fe},ss=v.__private__.putInfo=function(){var j=pi(),ne=function(Re){return Re};for(var we in m!==null&&(ne=Wn.encryptor(j,0)),fe("<<"),fe("/Producer ("+gi(ne("jsPDF "+jn.version))+")"),pt)pt.hasOwnProperty(we)&&pt[we]&&fe("/"+we.substr(0,1).toUpperCase()+we.substr(1)+" ("+gi(ne(pt[we]))+")");fe("/CreationDate ("+gi(ne(se))+")"),fe(">>"),fe("endobj")},nl=v.__private__.putCatalog=function(j){var ne=(j=j||{}).rootDictionaryObjId||Ds;switch(pi(),fe("<<"),fe("/Type /Catalog"),fe("/Pages "+ne+" 0 R"),qt||(qt="fullwidth"),qt){case"fullwidth":fe("/OpenAction [3 0 R /FitH null]");break;case"fullheight":fe("/OpenAction [3 0 R /FitV null]");break;case"fullpage":fe("/OpenAction [3 0 R /Fit]");break;case"original":fe("/OpenAction [3 0 R /XYZ null null 1]");break;default:var we=""+qt;we.substr(we.length-1)==="%"&&(qt=parseInt(qt)/100),typeof qt=="number"&&fe("/OpenAction [3 0 R /XYZ null null "+M(qt)+"]")}switch(kt||(kt="continuous"),kt){case"continuous":fe("/PageLayout /OneColumn");break;case"single":fe("/PageLayout /SinglePage");break;case"two":case"twoleft":fe("/PageLayout /TwoColumnLeft");break;case"tworight":fe("/PageLayout /TwoColumnRight")}Ot&&fe("/PageMode /"+Ot),Qt.publish("putCatalog"),fe(">>"),fe("endobj")},Hn=v.__private__.putTrailer=function(){fe("trailer"),fe("<<"),fe("/Size "+(Te+1)),fe("/Root "+Te+" 0 R"),fe("/Info "+(Te-1)+" 0 R"),m!==null&&fe("/Encrypt "+Wn.oid+" 0 R"),fe("/ID [ <"+V+"> <"+V+"> ]"),fe(">>")},Un=v.__private__.putHeader=function(){fe("%PDF-"+P),fe("%")},il=v.__private__.putXRef=function(){var j="0000000000";fe("xref"),fe("0 "+(Te+1)),fe("0000000000 65535 f ");for(var ne=1;ne<=Te;ne++)typeof Pe[ne]=="function"?fe((j+Pe[ne]()).slice(-10)+" 00000 n "):Pe[ne]!==void 0?fe((j+Pe[ne]).slice(-10)+" 00000 n "):fe("0000000000 00000 n ")},Ga=v.__private__.buildDocument=function(){var j;Te=0,De=0,Ve=[],Pe=[],et=[],Ds=ti(),Ti=ti(),xt(Ve),Qt.publish("buildDocument"),Un(),Va(),(function(){Qt.publish("putAdditionalObjects");for(var we=0;we<et.length;we++){var Re=et[we];vs(Re.objId,!0),fe(Re.content),fe("endobj")}Qt.publish("postPutAdditionalObjects")})(),j=[],(function(){for(var we in dn)dn.hasOwnProperty(we)&&(b===!1||b===!0&&S.hasOwnProperty(we))&&Wa(dn[we])})(),(function(){var we;for(we in Kt)Kt.hasOwnProperty(we)&&xi(Kt[we])})(),(function(){for(var we in Ks)Ks.hasOwnProperty(we)&&jo(Ks[we])})(),(function(we){var Re;for(Re in nn)nn.hasOwnProperty(Re)&&(nn[Re]instanceof sh?Gn(nn[Re]):nn[Re]instanceof of&&Fr(nn[Re],we))})(j),Qt.publish("putResources"),j.forEach(ga),ga({resourcesOid:Ti,objectOid:Number.MAX_SAFE_INTEGER}),Qt.publish("postPutResources"),m!==null&&(Wn.oid=pi(),fe("<<"),fe("/Filter /Standard"),fe("/V "+Wn.v),fe("/R "+Wn.r),fe("/U <"+Wn.toHexString(Wn.U)+">"),fe("/O <"+Wn.toHexString(Wn.O)+">"),fe("/P "+Wn.P),fe(">>"),fe("endobj")),ss(),nl();var ne=De;return il(),Hn(),fe("startxref"),fe(""+ne),fe("%%EOF"),xt(ot[W]),Ve.join(`
`)},Fs=v.__private__.getBlob=function(j){return new Blob([zt(j)],{type:"application/pdf"})},_r=v.output=v.__private__.output=(Ct=function(j,ne){switch(typeof(ne=ne||{})=="string"?ne={filename:ne}:ne.filename=ne.filename||"generated.pdf",j){case void 0:return Ga();case"save":v.save(ne.filename);break;case"arraybuffer":return zt(Ga());case"blob":return Fs(Ga());case"bloburi":case"bloburl":if(ei.URL!==void 0&&typeof ei.URL.createObjectURL=="function")return ei.URL&&ei.URL.createObjectURL(Fs(Ga()))||void 0;Ys.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var we="",Re=Ga();try{we=eb(Re)}catch{we=eb(unescape(encodeURIComponent(Re)))}return"data:application/pdf;filename="+ne.filename+";base64,"+we;case"pdfobjectnewwindow":if(Object.prototype.toString.call(ei)==="[object Window]"){var Fe="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",st=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ne.pdfObjectUrl&&(Fe=ne.pdfObjectUrl,st="");var yt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Fe+'"'+st+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ne)+");<\/script></body></html>",Gt=ei.open();return Gt!==null&&Gt.document.write(yt),Gt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(ei)==="[object Window]"){var xn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ne.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ne.filename+'" width="500px" height="400px" /></body></html>',pn=ei.open();if(pn!==null){pn.document.write(xn);var Qn=this;pn.document.documentElement.querySelector("#pdfViewer").onload=function(){pn.document.title=ne.filename,pn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Qn.output("bloburl"))}}return pn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(ei)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var vi='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ne)+'"></iframe></body></html>',Us=ei.open();if(Us!==null&&(Us.document.write(vi),Us.document.title=ne.filename),Us||typeof safari>"u")return Us;break;case"datauri":case"dataurl":return ei.document.location.href=this.output("datauristring",ne);default:return null}},Ct.foo=function(){try{return Ct.apply(this,arguments)}catch(we){var j=we.stack||"";~j.indexOf(" at ")&&(j=j.split(" at ")[1]);var ne="Error in function "+j.split(`
`)[0].split("<")[0]+": "+we.message;if(!ei.console)throw new Error(ne);ei.console.error(ne,we),ei.alert&&alert(ne)}},Ct.foo.bar=Ct,Ct.foo),us=function(j){return Array.isArray(Cr)===!0&&Cr.indexOf(j)>-1};switch(n){case"pt":Fn=1;break;case"mm":Fn=72/25.4;break;case"cm":Fn=72/2.54;break;case"in":Fn=72;break;case"px":Fn=us("px_scaling")==1?.75:96/72;break;case"pc":case"em":Fn=12;break;case"ex":Fn=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Fn=n}var Wn=null;J(),ae();var bi=v.__private__.getPageInfo=v.getPageInfo=function(j){if(isNaN(j)||j%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:bn[j].objId,pageNumber:j,pageContext:bn[j]}},Xl=v.__private__.getPageInfoByObjId=function(j){if(isNaN(j)||j%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ne in bn)if(bn[ne].objId===j)break;return bi(ne)},bc=v.__private__.getCurrentPageInfo=v.getCurrentPageInfo=function(){return{objId:bn[W].objId,pageNumber:W,pageContext:bn[W]}};v.addPage=function(){return Pa.apply(this,arguments),this},v.setPage=function(){return tl.apply(this,arguments),xt.call(this,ot[W]),this},v.insertPage=function(j){return this.addPage(),this.movePage(W,j),this},v.movePage=function(j,ne){var we,Re;if(j>ne){we=ot[j],Re=bn[j];for(var Fe=j;Fe>ne;Fe--)ot[Fe]=ot[Fe-1],bn[Fe]=bn[Fe-1];ot[ne]=we,bn[ne]=Re,this.setPage(ne)}else if(j<ne){we=ot[j],Re=bn[j];for(var st=j;st<ne;st++)ot[st]=ot[st+1],bn[st]=bn[st+1];ot[ne]=we,bn[ne]=Re,this.setPage(ne)}return this},v.deletePage=function(){return el.apply(this,arguments),this},v.__private__.text=v.text=function(j,ne,we,Re,Fe){var st,yt,Gt,xn,pn,Qn,vi,Us,ji,Wi=(Re=Re||{}).scope||this;if(typeof j=="number"&&typeof ne=="number"&&(typeof we=="string"||Array.isArray(we))){var Ei=we;we=ne,ne=j,j=Ei}if(arguments[3]instanceof en==0?(Gt=arguments[4],xn=arguments[5],Rs(vi=arguments[3])==="object"&&vi!==null||(typeof Gt=="string"&&(xn=Gt,Gt=null),typeof vi=="string"&&(xn=vi,vi=null),typeof vi=="number"&&(Gt=vi,vi=null),Re={flags:vi,angle:Gt,align:xn})):(H("The transform parameter of text() with a Matrix value"),ji=Fe),isNaN(ne)||isNaN(we)||j==null)throw new Error("Invalid arguments passed to jsPDF.text");if(j.length===0)return Wi;var ks,as="",uo=typeof Re.lineHeightFactor=="number"?Re.lineHeightFactor:rs,jr=Wi.internal.scaleFactor;function ol($i){return $i=$i.split("	").join(Array(Re.TabLen||9).join(" ")),gi($i,vi)}function pr($i){for(var Ri,Ss=$i.concat(),sr=[],_l=Ss.length;_l--;)typeof(Ri=Ss.shift())=="string"?sr.push(Ri):Array.isArray($i)&&(Ri.length===1||Ri[1]===void 0&&Ri[2]===void 0)?sr.push(Ri[0]):sr.push([Ri[0],Ri[1],Ri[2]]);return sr}function ll($i,Ri){var Ss;if(typeof $i=="string")Ss=Ri($i)[0];else if(Array.isArray($i)){for(var sr,_l,ul=$i.concat(),rr=[],Ca=ul.length;Ca--;)typeof(sr=ul.shift())=="string"?rr.push(Ri(sr)[0]):Array.isArray(sr)&&typeof sr[0]=="string"&&(_l=Ri(sr[0],sr[1],sr[2]),rr.push([_l[0],_l[1],_l[2]]));Ss=rr}return Ss}var Hs=!1,ba=!0;if(typeof j=="string")Hs=!0;else if(Array.isArray(j)){var gr=j.concat();yt=[];for(var Ja,li=gr.length;li--;)(typeof(Ja=gr.shift())!="string"||Array.isArray(Ja)&&typeof Ja[0]!="string")&&(ba=!1);Hs=ba}if(Hs===!1)throw new Error('Type of text must be string or Array. "'+j+'" is not recognized.');typeof j=="string"&&(j=j.match(/[\r?\n]/)?j.split(/\r\n|\r|\n/g):[j]);var ho=it/Wi.internal.scaleFactor,wc=ho*(uo-1);switch(Re.baseline){case"bottom":we-=wc;break;case"top":we+=ho-wc;break;case"hanging":we+=ho-2*wc;break;case"middle":we+=ho/2-wc}if((Qn=Re.maxWidth||0)>0&&(typeof j=="string"?j=Wi.splitTextToSize(j,Qn):Object.prototype.toString.call(j)==="[object Array]"&&(j=j.reduce(function($i,Ri){return $i.concat(Wi.splitTextToSize(Ri,Qn))},[]))),st={text:j,x:ne,y:we,options:Re,mutex:{pdfEscape:gi,activeFontKey:jt,fonts:dn,activeFontSize:it}},Qt.publish("preProcessText",st),j=st.text,Gt=(Re=st.options).angle,ji instanceof en==0&&Gt&&typeof Gt=="number"){Gt*=Math.PI/180,Re.rotationDirection===0&&(Gt=-Gt),z===I&&(Gt=-Gt);var nd=Math.cos(Gt),Qa=Math.sin(Gt);ji=new en(nd,Qa,-Qa,nd,0,0)}else Gt&&Gt instanceof en&&(ji=Gt);z!==I||ji||(ji=ja),(pn=Re.charSpace||Ut)!==void 0&&(as+=F(R(pn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Us=Re.horizontalScale)!==void 0&&(as+=F(100*Us)+` Tz
`),Re.lang;var Hr=-1,Do=Re.renderingMode!==void 0?Re.renderingMode:Re.stroke,Sc=Wi.internal.getCurrentPageInfo().pageContext;switch(Do){case 0:case!1:case"fill":Hr=0;break;case 1:case!0:case"stroke":Hr=1;break;case 2:case"fillThenStroke":Hr=2;break;case 3:case"invisible":Hr=3;break;case 4:case"fillAndAddForClipping":Hr=4;break;case 5:case"strokeAndAddPathForClipping":Hr=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Hr=6;break;case 7:case"addToPathForClipping":Hr=7}var Lo=Sc.usedRenderingMode!==void 0?Sc.usedRenderingMode:-1;Hr!==-1?as+=Hr+` Tr
`:Lo!==-1&&(as+=`0 Tr
`),Hr!==-1&&(Sc.usedRenderingMode=Hr),xn=Re.align||"left";var va,nr=it*uo,eo=Wi.internal.pageSize.getWidth(),cl=dn[jt];pn=Re.charSpace||Ut,Qn=Re.maxWidth||0,vi=Object.assign({autoencode:!0,noBOM:!0},Re.flags);var fo=[],po=function($i){return Wi.getStringUnitWidth($i,{font:cl,charSpace:pn,fontSize:it,doKerning:!1})*it/jr};if(Object.prototype.toString.call(j)==="[object Array]"){var wa;yt=pr(j),xn!=="left"&&(va=yt.map(po));var ir,Mo=0;if(xn==="right"){ne-=va[0],j=[],li=yt.length;for(var Da=0;Da<li;Da++)Da===0?(ir=xa(ne),wa=an(we)):(ir=R(Mo-va[Da]),wa=-nr),j.push([yt[Da],ir,wa]),Mo=va[Da]}else if(xn==="center"){ne-=va[0]/2,j=[],li=yt.length;for(var _i=0;_i<li;_i++)_i===0?(ir=xa(ne),wa=an(we)):(ir=R((Mo-va[_i])/2),wa=-nr),j.push([yt[_i],ir,wa]),Mo=va[_i]}else if(xn==="left"){j=[],li=yt.length;for(var Io=0;Io<li;Io++)j.push(yt[Io])}else if(xn==="justify"&&cl.encoding==="Identity-H"){j=[],li=yt.length,Qn=Qn!==0?Qn:eo;for(var os=0,ws=0;ws<li;ws++)if(wa=ws===0?an(we):-nr,ir=ws===0?xa(ne):os,ws<li-1){var id=R((Qn-va[ws])/(yt[ws].split(" ").length-1)),La=yt[ws].split(" ");j.push([La[0]+" ",ir,wa]),os=0;for(var Tl=1;Tl<La.length;Tl++){var Pr=(po(La[Tl-1]+" "+La[Tl])-po(La[Tl]))*jr+id;Tl==La.length-1?j.push([La[Tl],Pr,0]):j.push([La[Tl]+" ",Pr,0]),os-=Pr}}else j.push([yt[ws],ir,wa]);j.push(["",os,0])}else{if(xn!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(j=[],li=yt.length,Qn=Qn!==0?Qn:eo,ws=0;ws<li;ws++){wa=ws===0?an(we):-nr,ir=ws===0?xa(ne):0;var Zl=yt[ws].split(" ").length-1,sd=Zl>0?(Qn-va[ws])/Zl:0;ws<li-1?fo.push(F(R(sd))):fo.push(0),j.push([yt[ws],ir,wa])}}}(typeof Re.R2L=="boolean"?Re.R2L:Dt)===!0&&(j=ll(j,function($i,Ri,Ss){return[$i.split("").reverse().join(""),Ri,Ss]})),st={text:j,x:ne,y:we,options:Re,mutex:{pdfEscape:gi,activeFontKey:jt,fonts:dn,activeFontSize:it}},Qt.publish("postProcessText",st),j=st.text,ks=st.mutex.isHex||!1;var to=dn[jt].encoding;to!=="WinAnsiEncoding"&&to!=="StandardEncoding"||(j=ll(j,function($i,Ri,Ss){return[ol($i),Ri,Ss]})),yt=pr(j),j=[];for(var dl,zo,Sa,qr=Array.isArray(yt[0])?1:0,Ma="",Bo=function($i,Ri,Ss){var sr="";return Ss instanceof en?(Ss=typeof Re.angle=="number"?Or(Ss,new en(1,0,0,1,$i,Ri)):Or(new en(1,0,0,1,$i,Ri),Ss),z===I&&(Ss=Or(new en(1,0,0,-1,0,0),Ss)),sr=Ss.join(" ")+` Tm
`):sr=F($i)+" "+F(Ri)+` Td
`,sr},Aa=0;Aa<yt.length;Aa++){switch(Ma="",qr){case 1:Sa=(ks?"<":"(")+yt[Aa][0]+(ks?">":")"),dl=parseFloat(yt[Aa][1]),zo=parseFloat(yt[Aa][2]);break;case 0:Sa=(ks?"<":"(")+yt[Aa]+(ks?">":")"),dl=xa(ne),zo=an(we)}fo!==void 0&&fo[Aa]!==void 0&&(Ma=fo[Aa]+` Tw
`),Aa===0?j.push(Ma+Bo(dl,zo,ji)+Sa):qr===0?j.push(Ma+Sa):qr===1&&j.push(Ma+Bo(dl,zo,ji)+Sa)}j=qr===0?j.join(` Tj
T* `):j.join(` Tj
`),j+=` Tj
`;var go=`BT
/`;return go+=jt+" "+it+` Tf
`,go+=F(it*uo)+` TL
`,go+=mn+`
`,go+=as,go+=j,fe(go+="ET"),S[jt]=!0,Wi};var ya=v.__private__.clip=v.clip=function(j){return fe(j==="evenodd"?"W*":"W"),this};v.clipEvenOdd=function(){return ya("evenodd")},v.__private__.discardPath=v.discardPath=function(){return fe("n"),this};var kr=v.__private__.isValidStyle=function(j){var ne=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(j)!==-1&&(ne=!0),ne};v.__private__.setDefaultPathOperation=v.setDefaultPathOperation=function(j){return kr(j)&&(f=j),this};var sl=v.__private__.getStyle=v.getStyle=function(j){var ne=f;switch(j){case"D":case"S":ne="S";break;case"F":ne="f";break;case"FD":case"DF":ne="B";break;case"f":case"f*":case"B":case"B*":ne=j}return ne},Ya=v.close=function(){return fe("h"),this};v.stroke=function(){return fe("S"),this},v.fill=function(j){return Nr("f",j),this},v.fillEvenOdd=function(j){return Nr("f*",j),this},v.fillStroke=function(j){return Nr("B",j),this},v.fillStrokeEvenOdd=function(j){return Nr("B*",j),this};var Nr=function(j,ne){Rs(ne)==="object"?Qi(ne,j):fe(j)},na=function(j){j===null||z===I&&j===void 0||(j=sl(j),fe(j))};function Rt(j,ne,we,Re,Fe){var st=new of(ne||this.boundingBox,we||this.xStep,Re||this.yStep,this.gState,Fe||this.matrix);st.stream=this.stream;var yt=j+"$$"+this.cloneIndex+++"$$";return fa(yt,st),st}var Qi=function(j,ne){var we=Xt[j.key],Re=nn[we];if(Re instanceof sh)fe("q"),fe(fr(ne)),Re.gState&&v.setGState(Re.gState),fe(j.matrix.toString()+" cm"),fe("/"+we+" sh"),fe("Q");else if(Re instanceof of){var Fe=new en(1,0,0,-1,0,yn());j.matrix&&(Fe=Fe.multiply(j.matrix||ja),we=Rt.call(Re,j.key,j.boundingBox,j.xStep,j.yStep,Fe).id),fe("q"),fe("/Pattern cs"),fe("/"+we+" scn"),Re.gState&&v.setGState(Re.gState),fe(ne),fe("Q")}},fr=function(j){switch(j){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Al=v.moveTo=function(j,ne){return fe(F(R(j))+" "+F(Z(ne))+" m"),this},Xa=v.lineTo=function(j,ne){return fe(F(R(j))+" "+F(Z(ne))+" l"),this},Ea=v.curveTo=function(j,ne,we,Re,Fe,st){return fe([F(R(j)),F(Z(ne)),F(R(we)),F(Z(Re)),F(R(Fe)),F(Z(st)),"c"].join(" ")),this};v.__private__.line=v.line=function(j,ne,we,Re,Fe){if(isNaN(j)||isNaN(ne)||isNaN(we)||isNaN(Re)||!kr(Fe))throw new Error("Invalid arguments passed to jsPDF.line");return z===$?this.lines([[we-j,Re-ne]],j,ne,[1,1],Fe||"S"):this.lines([[we-j,Re-ne]],j,ne,[1,1]).stroke()},v.__private__.lines=v.lines=function(j,ne,we,Re,Fe,st){var yt,Gt,xn,pn,Qn,vi,Us,ji,Wi,Ei,ks,as;if(typeof j=="number"&&(as=we,we=ne,ne=j,j=as),Re=Re||[1,1],st=st||!1,isNaN(ne)||isNaN(we)||!Array.isArray(j)||!Array.isArray(Re)||!kr(Fe)||typeof st!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Al(ne,we),yt=Re[0],Gt=Re[1],pn=j.length,Ei=ne,ks=we,xn=0;xn<pn;xn++)(Qn=j[xn]).length===2?(Ei=Qn[0]*yt+Ei,ks=Qn[1]*Gt+ks,Xa(Ei,ks)):(vi=Qn[0]*yt+Ei,Us=Qn[1]*Gt+ks,ji=Qn[2]*yt+Ei,Wi=Qn[3]*Gt+ks,Ei=Qn[4]*yt+Ei,ks=Qn[5]*Gt+ks,Ea(vi,Us,ji,Wi,Ei,ks));return st&&Ya(),na(Fe),this},v.path=function(j){for(var ne=0;ne<j.length;ne++){var we=j[ne],Re=we.c;switch(we.op){case"m":Al(Re[0],Re[1]);break;case"l":Xa(Re[0],Re[1]);break;case"c":Ea.apply(this,Re);break;case"h":Ya()}}return this},v.__private__.rect=v.rect=function(j,ne,we,Re,Fe){if(isNaN(j)||isNaN(ne)||isNaN(we)||isNaN(Re)||!kr(Fe))throw new Error("Invalid arguments passed to jsPDF.rect");return z===$&&(Re=-Re),fe([F(R(j)),F(Z(ne)),F(R(we)),F(R(Re)),"re"].join(" ")),na(Fe),this},v.__private__.triangle=v.triangle=function(j,ne,we,Re,Fe,st,yt){if(isNaN(j)||isNaN(ne)||isNaN(we)||isNaN(Re)||isNaN(Fe)||isNaN(st)||!kr(yt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[we-j,Re-ne],[Fe-we,st-Re],[j-Fe,ne-st]],j,ne,[1,1],yt,!0),this},v.__private__.roundedRect=v.roundedRect=function(j,ne,we,Re,Fe,st,yt){if(isNaN(j)||isNaN(ne)||isNaN(we)||isNaN(Re)||isNaN(Fe)||isNaN(st)||!kr(yt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Gt=4/3*(Math.SQRT2-1);return Fe=Math.min(Fe,.5*we),st=Math.min(st,.5*Re),this.lines([[we-2*Fe,0],[Fe*Gt,0,Fe,st-st*Gt,Fe,st],[0,Re-2*st],[0,st*Gt,-Fe*Gt,st,-Fe,st],[2*Fe-we,0],[-Fe*Gt,0,-Fe,-st*Gt,-Fe,-st],[0,2*st-Re],[0,-st*Gt,Fe*Gt,-st,Fe,-st]],j+Fe,ne,[1,1],yt,!0),this},v.__private__.ellipse=v.ellipse=function(j,ne,we,Re,Fe){if(isNaN(j)||isNaN(ne)||isNaN(we)||isNaN(Re)||!kr(Fe))throw new Error("Invalid arguments passed to jsPDF.ellipse");var st=4/3*(Math.SQRT2-1)*we,yt=4/3*(Math.SQRT2-1)*Re;return Al(j+we,ne),Ea(j+we,ne-yt,j+st,ne-Re,j,ne-Re),Ea(j-st,ne-Re,j-we,ne-yt,j-we,ne),Ea(j-we,ne+yt,j-st,ne+Re,j,ne+Re),Ea(j+st,ne+Re,j+we,ne+yt,j+we,ne),na(Fe),this},v.__private__.circle=v.circle=function(j,ne,we,Re){if(isNaN(j)||isNaN(ne)||isNaN(we)||!kr(Re))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(j,ne,we,we,Re)},v.setFont=function(j,ne,we){return we&&(ne=te(ne,we)),jt=td(j,ne,{disableWarning:!1}),this};var co=v.__private__.getFont=v.getFont=function(){return dn[td.apply(v,arguments)]};v.__private__.getFontList=v.getFontList=function(){var j,ne,we={};for(j in An)if(An.hasOwnProperty(j))for(ne in we[j]=[],An[j])An[j].hasOwnProperty(ne)&&we[j].push(ne);return we},v.addFont=function(j,ne,we,Re,Fe){var st=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&st.indexOf(arguments[3])!==-1?Fe=arguments[3]:arguments[3]&&st.indexOf(arguments[3])==-1&&(we=te(we,Re)),Qo.call(this,j,ne,we,Fe=Fe||"Identity-H")};var rs,es=r.lineWidth||.200025,Po=v.__private__.getLineWidth=v.getLineWidth=function(){return es},Bn=v.__private__.setLineWidth=v.setLineWidth=function(j){return es=j,fe(F(R(j))+" w"),this};v.__private__.setLineDash=jn.API.setLineDash=jn.API.setLineDashPattern=function(j,ne){if(j=j||[],ne=ne||0,isNaN(ne)||!Array.isArray(j))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return j=j.map(function(we){return F(R(we))}).join(" "),ne=F(R(ne)),fe("["+j+"] "+ne+" d"),this};var ni=v.__private__.getLineHeight=v.getLineHeight=function(){return it*rs};v.__private__.getLineHeight=v.getLineHeight=function(){return it*rs};var Tn=v.__private__.setLineHeightFactor=v.setLineHeightFactor=function(j){return typeof(j=j||1.15)=="number"&&(rs=j),this},Hc=v.__private__.getLineHeightFactor=v.getLineHeightFactor=function(){return rs};Tn(r.lineHeight);var xa=v.__private__.getHorizontalCoordinate=function(j){return R(j)},an=v.__private__.getVerticalCoordinate=function(j){return z===I?j:bn[W].mediaBox.topRightY-bn[W].mediaBox.bottomLeftY-R(j)},_n=v.__private__.getHorizontalCoordinateString=v.getHorizontalCoordinateString=function(j){return F(xa(j))},ai=v.__private__.getVerticalCoordinateString=v.getVerticalCoordinateString=function(j){return F(an(j))},rn=r.strokeColor||"0 G";v.__private__.getStrokeColor=v.getDrawColor=function(){return Si(rn)},v.__private__.setStrokeColor=v.setDrawColor=function(j,ne,we,Re){return rn=Tr({ch1:j,ch2:ne,ch3:we,ch4:Re,pdfColorType:"draw",precision:2}),fe(rn),this};var oi=r.fillColor||"0 g";v.__private__.getFillColor=v.getFillColor=function(){return Si(oi)},v.__private__.setFillColor=v.setFillColor=function(j,ne,we,Re){return oi=Tr({ch1:j,ch2:ne,ch3:we,ch4:Re,pdfColorType:"fill",precision:2}),fe(oi),this};var mn=r.textColor||"0 g",Zd=v.__private__.getTextColor=v.getTextColor=function(){return Si(mn)};v.__private__.setTextColor=v.setTextColor=function(j,ne,we,Re){return mn=Tr({ch1:j,ch2:ne,ch3:we,ch4:Re,pdfColorType:"text",precision:3}),this};var Ut=r.charSpace,Pi=v.__private__.getCharSpace=v.getCharSpace=function(){return parseFloat(Ut||0)};v.__private__.setCharSpace=v.setCharSpace=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Ut=j,this};var Zt=0;v.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},v.__private__.setLineCap=v.setLineCap=function(j){var ne=v.CapJoinStyles[j];if(ne===void 0)throw new Error("Line cap style of '"+j+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Zt=ne,fe(ne+" J"),this};var Yn=0;v.__private__.setLineJoin=v.setLineJoin=function(j){var ne=v.CapJoinStyles[j];if(ne===void 0)throw new Error("Line join style of '"+j+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Yn=ne,fe(ne+" j"),this},v.__private__.setLineMiterLimit=v.__private__.setMiterLimit=v.setLineMiterLimit=v.setMiterLimit=function(j){if(j=j||0,isNaN(j))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return fe(F(R(j))+" M"),this},v.GState=Zg,v.setGState=function(j){(j=typeof j=="string"?Kt[Cn[j]]:Ur(null,j)).equals(Vi)||(fe("/"+j.id+" gs"),Vi=j)};var Ur=function(j,ne){if(!j||!Cn[j]){var we=!1;for(var Re in Kt)if(Kt.hasOwnProperty(Re)&&Kt[Re].equals(ne)){we=!0;break}if(we)ne=Kt[Re];else{var Fe="GS"+(Object.keys(Kt).length+1).toString(10);Kt[Fe]=ne,ne.id=Fe}return j&&(Cn[j]=ne.id),Qt.publish("addGState",ne),ne}};v.addGState=function(j,ne){return Ur(j,ne),this},v.saveGraphicsState=function(){return fe("q"),lt.push({key:jt,size:it,color:mn}),this},v.restoreGraphicsState=function(){fe("Q");var j=lt.pop();return jt=j.key,it=j.size,mn=j.color,Vi=null,this},v.setCurrentTransformationMatrix=function(j){return fe(j.toString()+" cm"),this},v.comment=function(j){return fe("#"+j),this};var Ka=function(j,ne){var we=j||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return we},set:function(st){isNaN(st)||(we=parseFloat(st))}});var Re=ne||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Re},set:function(st){isNaN(st)||(Re=parseFloat(st))}});var Fe="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Fe},set:function(st){Fe=st.toString()}}),this},Zs=function(j,ne,we,Re){Ka.call(this,j,ne),this.type="rect";var Fe=we||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Fe},set:function(yt){isNaN(yt)||(Fe=parseFloat(yt))}});var st=Re||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return st},set:function(yt){isNaN(yt)||(st=parseFloat(yt))}}),this},rl=function(){this.page=Vn,this.currentPage=W,this.pages=ot.slice(0),this.pagesContext=bn.slice(0),this.x=tn,this.y=zn,this.matrix=Pn,this.width=al(W),this.height=Kl(W),this.outputDestination=ht,this.id="",this.objectNumber=-1};rl.prototype.restore=function(){Vn=this.page,W=this.currentPage,bn=this.pagesContext,ot=this.pages,tn=this.x,zn=this.y,Pn=this.matrix,vc(W,this.width),Cl(W,this.height),ht=this.outputDestination};var Ra=function(j,ne,we,Re,Fe){Br.push(new rl),Vn=W=0,ot=[],tn=j,zn=ne,Pn=Fe,ma([we,Re])};for(var Za in v.beginFormObject=function(j,ne,we,Re,Fe){return Ra(j,ne,we,Re,Fe),this},v.endFormObject=function(j){return(function(ne){if(zr[ne])Br.pop().restore();else{var we=new rl,Re="Xo"+(Object.keys(Ks).length+1).toString(10);we.id=Re,zr[ne]=Re,Ks[Re]=we,Qt.publish("addFormObject",we),Br.pop().restore()}})(j),this},v.doFormObject=function(j,ne){var we=Ks[zr[j]];return fe("q"),fe(ne.toString()+" cm"),fe("/"+we.id+" Do"),fe("Q"),this},v.getFormObject=function(j){var ne=Ks[zr[j]];return{x:ne.x,y:ne.y,width:ne.width,height:ne.height,matrix:ne.matrix}},v.save=function(j,ne){return j=j||"generated.pdf",(ne=ne||{}).returnPromise=ne.returnPromise||!1,ne.returnPromise===!1?(ih(Fs(Ga()),j),typeof ih.unload=="function"&&ei.setTimeout&&setTimeout(ih.unload,911),this):new Promise(function(we,Re){try{var Fe=ih(Fs(Ga()),j);typeof ih.unload=="function"&&ei.setTimeout&&setTimeout(ih.unload,911),we(Fe)}catch(st){Re(st.message)}})},jn.API)jn.API.hasOwnProperty(Za)&&(Za==="events"&&jn.API.events.length?(function(j,ne){var we,Re,Fe;for(Fe=ne.length-1;Fe!==-1;Fe--)we=ne[Fe][0],Re=ne[Fe][1],j.subscribe.apply(j,[we].concat(typeof Re=="function"?[Re]:Re))})(Qt,jn.API.events):v[Za]=jn.API[Za]);function al(j){return bn[j].mediaBox.topRightX-bn[j].mediaBox.bottomLeftX}function vc(j,ne){bn[j].mediaBox.topRightX=ne+bn[j].mediaBox.bottomLeftX}function Kl(j){return bn[j].mediaBox.topRightY-bn[j].mediaBox.bottomLeftY}function Cl(j,ne){bn[j].mediaBox.topRightY=ne+bn[j].mediaBox.bottomLeftY}var Eo=v.getPageWidth=function(j){return al(j=j||W)/Fn},Jd=v.setPageWidth=function(j,ne){vc(j,ne*Fn)},yn=v.getPageHeight=function(j){return Kl(j=j||W)/Fn},Ro=v.setPageHeight=function(j,ne){Cl(j,ne*Fn)};return v.internal={pdfEscape:gi,getStyle:sl,getFont:co,getFontSize:vt,getCharSpace:Pi,getTextColor:Zd,getLineHeight:ni,getLineHeightFactor:Hc,getLineWidth:Po,write:Nt,getHorizontalCoordinate:xa,getVerticalCoordinate:an,getCoordinateString:_n,getVerticalCoordinateString:ai,collections:{},newObject:pi,newAdditionalObject:Ji,newObjectDeferred:ti,newObjectDeferredBegin:vs,getFilters:pa,putStream:qa,events:Qt,scaleFactor:Fn,pageSize:{getWidth:function(){return Eo(W)},setWidth:function(j){Jd(W,j)},getHeight:function(){return yn(W)},setHeight:function(j){Ro(W,j)}},encryptionOptions:m,encryption:Wn,getEncryptor:function(j){return m!==null?Wn.encryptor(j,0):function(ne){return ne}},output:_r,getNumberOfPages:$a,get pages(){return ot},out:fe,f2:M,f3:T,getPageInfo:bi,getPageInfoByObjId:Xl,getCurrentPageInfo:bc,getPDFVersion:x,Point:Ka,Rectangle:Zs,Matrix:en,hasHotfix:us},Object.defineProperty(v.internal.pageSize,"width",{get:function(){return Eo(W)},set:function(j){Jd(W,j)},enumerable:!0,configurable:!0}),Object.defineProperty(v.internal.pageSize,"height",{get:function(){return yn(W)},set:function(j){Ro(W,j)},enumerable:!0,configurable:!0}),(function(j){for(var ne=0,we=Bt.length;ne<we;ne++){var Re=Qo.call(this,j[ne][0],j[ne][1],j[ne][2],Bt[ne][3],!0);b===!1&&(S[Re]=!0);var Fe=j[ne][0].split("-");Rn({id:Re,fontName:Fe[0],fontStyle:Fe[1]||""})}Qt.publish("addFonts",{fonts:dn,dictionary:An})}).call(v,Bt),jt="F1",Pa(s,t),Qt.publish("initialized"),v}tf.prototype.lsbFirstWord=function(r){return String.fromCharCode(255&r,r>>8&255,r>>16&255,r>>24&255)},tf.prototype.toHexString=function(r){return r.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},tf.prototype.hexToBytes=function(r){for(var e=[],t=0;t<r.length;t+=2)e.push(String.fromCharCode(parseInt(r.substr(t,2),16)));return e.join("")},tf.prototype.processOwnerPassword=function(r,e){return Km(Xm(e).substr(0,5),r)},tf.prototype.encryptor=function(r,e){var t=Xm(this.encryptionKey+String.fromCharCode(255&r,r>>8&255,r>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return Km(t,n)}},Zg.prototype.equals=function(r){var e,t="id,objectNumber,equals";if(!r||Rs(r)!==Rs(this))return!1;var n=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!r.hasOwnProperty(e)||this[e]!==r[e])return!1;n++}for(e in r)r.hasOwnProperty(e)&&t.indexOf(e)<0&&n--;return n===0},jn.API={events:[]},jn.version="3.0.4";var ea=jn.API,vy=1,gh=function(r){return r.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Zh=function(r){return r.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},ui=function(r){return r.toFixed(2)},ju=function(r){return r.toFixed(5)};ea.__acroform__={};var Gl=function(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r},sb=function(r){return r*vy},Sd=function(r){var e=new F2,t=gn.internal.getHeight(r)||0,n=gn.internal.getWidth(r)||0;return e.BBox=[0,0,Number(ui(n)),Number(ui(t))],e},EA=ea.__acroform__.setBit=function(r,e){if(r=r||0,e=e||0,isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return r|1<<e},RA=ea.__acroform__.clearBit=function(r,e){if(r=r||0,e=e||0,isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return r&~(1<<e)},DA=ea.__acroform__.getBit=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return r&1<<e?1:0},da=ea.__acroform__.getBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return DA(r,e-1)},ua=ea.__acroform__.setBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return EA(r,e-1)},ha=ea.__acroform__.clearBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return RA(r,e-1)},LA=ea.__acroform__.calculateCoordinates=function(r,e){var t=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,s=r[0],o=r[1],d=r[2],c=r[3],h={};return h.lowerLeft_X=t(s)||0,h.lowerLeft_Y=n(o+c)||0,h.upperRight_X=t(s+d)||0,h.upperRight_Y=n(o)||0,[Number(ui(h.lowerLeft_X)),Number(ui(h.lowerLeft_Y)),Number(ui(h.upperRight_X)),Number(ui(h.upperRight_Y))]},MA=function(r){if(r.appearanceStreamContent)return r.appearanceStreamContent;if(r.V||r.DV){var e=[],t=r._V||r.DV,n=Zm(r,t),s=r.scope.internal.getFont(r.fontName,r.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(r.scope.__private__.encodeColorString(r.color)),e.push("/"+s+" "+ui(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var o=Sd(r);return o.scope=r.scope,o.stream=e.join(`
`),o}},Zm=function(r,e){var t=r.fontSize===0?r.maxFontSize:r.fontSize,n={text:"",fontSize:""},s=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");s=r.multiline?s.map(function(M){return M.split(`
`)}):s.map(function(M){return[M]});var o=t,d=gn.internal.getHeight(r)||0;d=d<0?-d:d;var c=gn.internal.getWidth(r)||0;c=c<0?-c:c;var h=function(M,T,R){if(M+1<s.length){var Z=T+" "+s[M+1][0];return _g(Z,r,R).width<=c-4}return!1};o++;e:for(;o>0;){e="",o--;var f,m,b=_g("3",r,o).height,S=r.multiline?d-o:(d-b)/2,v=S+=2,P=0,x=0,k=0;if(o<=0){e=`(...) Tj
`,e+="% Width of Text: "+_g(e,r,o=12).width+", FieldWidth:"+c+`
`;break}for(var N="",$=0,I=0;I<s.length;I++)if(s.hasOwnProperty(I)){var z=!1;if(s[I].length!==1&&k!==s[I].length-1){if((b+2)*($+2)+2>d)continue e;N+=s[I][k],z=!0,x=I,I--}else{N=(N+=s[I][k]+" ").substr(N.length-1)==" "?N.substr(0,N.length-1):N;var B=parseInt(I),G=h(B,N,o),te=I>=s.length-1;if(G&&!te){N+=" ",k=0;continue}if(G||te){if(te)x=B;else if(r.multiline&&(b+2)*($+2)+2>d)continue e}else{if(!r.multiline||(b+2)*($+2)+2>d)continue e;x=B}}for(var F="",H=P;H<=x;H++){var Q=s[H];if(r.multiline){if(H===x){F+=Q[k]+" ",k=(k+1)%Q.length;continue}if(H===P){F+=Q[Q.length-1]+" ";continue}}F+=Q[0]+" "}switch(F=F.substr(F.length-1)==" "?F.substr(0,F.length-1):F,m=_g(F,r,o).width,r.textAlign){case"right":f=c-m-2;break;case"center":f=(c-m)/2;break;default:f=2}e+=ui(f)+" "+ui(v)+` Td
`,e+="("+gh(F)+`) Tj
`,e+=-ui(f)+` 0 Td
`,v=-(o+2),m=0,P=z?x:x+1,$++,N=""}break}return n.text=e,n.fontSize=o,n},_g=function(r,e,t){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),s=e.scope.getStringUnitWidth(r,{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:s}},IA={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},zA=function(r,e){var t={type:"reference",object:r};e.internal.getPageInfo(r.page).pageContext.annotations.find(function(n){return n.type===t.type&&n.object===t.object})===void 0&&e.internal.getPageInfo(r.page).pageContext.annotations.push(t)},BA=function(r,e){if(e.scope=r,r.internal!==void 0&&(r.internal.acroformPlugin===void 0||r.internal.acroformPlugin.isInitialized===!1)){if(Qc.FieldNum=0,r.internal.acroformPlugin=JSON.parse(JSON.stringify(IA)),r.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");vy=r.internal.scaleFactor,r.internal.acroformPlugin.acroFormDictionaryRoot=new U2,r.internal.acroformPlugin.acroFormDictionaryRoot.scope=r,r.internal.acroformPlugin.acroFormDictionaryRoot._eventID=r.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(r)}),r.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in n)if(n.hasOwnProperty(s)){var o=n[s];o.objId=void 0,o.hasAnnotation&&zA(o,t)}})(r)}),r.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(r)}),r.internal.events.subscribe("postPutPages",function(t){(function(n,s){var o=!n;for(var d in n||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(d)){var c=n[d],h=[],f=c.Rect;if(c.Rect&&(c.Rect=LA(c.Rect,s)),s.internal.newObjectDeferredBegin(c.objId,!0),c.DA=gn.createDefaultAppearanceStream(c),Rs(c)==="object"&&typeof c.getKeyValueListForStream=="function"&&(h=c.getKeyValueListForStream()),c.Rect=f,c.hasAppearanceStream&&!c.appearanceStreamContent){var m=MA(c);h.push({key:"AP",value:"<</N "+m+">>"}),s.internal.acroformPlugin.xForms.push(m)}if(c.appearanceStreamContent){var b="";for(var S in c.appearanceStreamContent)if(c.appearanceStreamContent.hasOwnProperty(S)){var v=c.appearanceStreamContent[S];if(b+="/"+S+" ",b+="<<",Object.keys(v).length>=1||Array.isArray(v)){for(var d in v)if(v.hasOwnProperty(d)){var P=v[d];typeof P=="function"&&(P=P.call(s,c)),b+="/"+d+" "+P+" ",s.internal.acroformPlugin.xForms.indexOf(P)>=0||s.internal.acroformPlugin.xForms.push(P)}}else typeof(P=v)=="function"&&(P=P.call(s,c)),b+="/"+d+" "+P,s.internal.acroformPlugin.xForms.indexOf(P)>=0||s.internal.acroformPlugin.xForms.push(P);b+=">>"}h.push({key:"AP",value:`<<
`+b+">>"})}s.internal.putStream({additionalKeyValues:h,objectId:c.objId}),s.internal.out("endobj")}o&&(function(x,k){for(var N in x)if(x.hasOwnProperty(N)){var $=N,I=x[N];k.internal.newObjectDeferredBegin(I.objId,!0),Rs(I)==="object"&&typeof I.putStream=="function"&&I.putStream(),delete x[$]}})(s.internal.acroformPlugin.xForms,s)})(t,r)}),r.internal.acroformPlugin.isInitialized=!0}},O2=ea.__acroform__.arrayToPdfArray=function(r,e,t){var n=function(d){return d};if(Array.isArray(r)){for(var s="[",o=0;o<r.length;o++)switch(o!==0&&(s+=" "),Rs(r[o])){case"boolean":case"number":case"object":s+=r[o].toString();break;case"string":r[o].substr(0,1)!=="/"?(e!==void 0&&t&&(n=t.internal.getEncryptor(e)),s+="("+gh(n(r[o].toString()))+")"):s+=r[o].toString()}return s+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Am=function(r,e,t){var n=function(s){return s};return e!==void 0&&t&&(n=t.internal.getEncryptor(e)),(r=r||"").toString(),"("+gh(n(r))+")"},Td=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(r){this._objId=r}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Td.prototype.toString=function(){return this.objId+" 0 R"},Td.prototype.putStream=function(){var r=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:r,objectId:this.objId}),this.scope.internal.out("endobj")},Td.prototype.getKeyValueListForStream=function(){var r=[],e=Object.getOwnPropertyNames(this).filter(function(o){return o!="content"&&o!="appearanceStreamContent"&&o!="scope"&&o!="objId"&&o.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var n=e[t],s=this[n];s&&(Array.isArray(s)?r.push({key:n,value:O2(s,this.objId,this.scope)}):s instanceof Td?(s.scope=this.scope,r.push({key:n,value:s.objId+" 0 R"})):typeof s!="function"&&r.push({key:n,value:s}))}return r};var F2=function(){Td.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var r,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){r=t.trim()},get:function(){return r||null}})};Gl(F2,Td);var U2=function(){Td.call(this);var r,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(r){var t=function(n){return n};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+gh(t(r))+")"}},set:function(t){r=t}})};Gl(U2,Td);var Qc=function r(){Td.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(N){if(isNaN(N))throw new Error('Invalid value "'+N+'" for attribute F supplied.');e=N}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!da(e,3)},set:function(N){N?this.F=ua(e,3):this.F=ha(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(N){if(isNaN(N))throw new Error('Invalid value "'+N+'" for attribute Ff supplied.');t=N}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(N){n=N!==void 0?N:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(N){n[0]=N}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(N){n[1]=N}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(N){n[2]=N}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(N){n[3]=N}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(N){switch(N){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=N;break;default:throw new Error('Invalid value "'+N+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof Jg)return;o="FieldObject"+r.FieldNum++}var N=function($){return $};return this.scope&&(N=this.scope.internal.getEncryptor(this.objId)),"("+gh(N(o))+")"},set:function(N){o=N.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(N){o=N}});var d="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return d},set:function(N){d=N}});var c="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return c},set:function(N){c=N}});var h=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return h},set:function(N){h=N}});var f=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return f===void 0?50/vy:f},set:function(N){f=N}});var m="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return m},set:function(N){m=N}});var b="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!b||this instanceof Jg||this instanceof ch))return Am(b,this.objId,this.scope)},set:function(N){N=N.toString(),b=N}});var S=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(S)return this instanceof lo==0?Am(S,this.objId,this.scope):S},set:function(N){N=N.toString(),S=this instanceof lo==0?N.substr(0,1)==="("?Zh(N.substr(1,N.length-2)):Zh(N):N}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof lo==1?Zh(S.substr(1,S.length-1)):S},set:function(N){N=N.toString(),S=this instanceof lo==1?"/"+N:N}});var v=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(v)return v},set:function(N){this.V=N}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(v)return this instanceof lo==0?Am(v,this.objId,this.scope):v},set:function(N){N=N.toString(),v=this instanceof lo==0?N.substr(0,1)==="("?Zh(N.substr(1,N.length-2)):Zh(N):N}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof lo==1?Zh(v.substr(1,v.length-1)):v},set:function(N){N=N.toString(),v=this instanceof lo==1?"/"+N:N}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var P,x=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return x},set:function(N){N=!!N,x=N}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(P)return P},set:function(N){P=N}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,1)},set:function(N){N?this.Ff=ua(this.Ff,1):this.Ff=ha(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,2)},set:function(N){N?this.Ff=ua(this.Ff,2):this.Ff=ha(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,3)},set:function(N){N?this.Ff=ua(this.Ff,3):this.Ff=ha(this.Ff,3)}});var k=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(k!==null)return k},set:function(N){if([0,1,2].indexOf(N)===-1)throw new Error('Invalid value "'+N+'" for attribute Q supplied.');k=N}}),Object.defineProperty(this,"textAlign",{get:function(){var N;switch(k){case 0:default:N="left";break;case 1:N="center";break;case 2:N="right"}return N},configurable:!0,enumerable:!0,set:function(N){switch(N){case"right":case 2:k=2;break;case"center":case 1:k=1;break;default:k=0}}})};Gl(Qc,Td);var uf=function(){Qc.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var r=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return r},set:function(t){r=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return O2(e,this.objId,this.scope)},set:function(t){var n,s;s=[],typeof(n=t)=="string"&&(s=(function(o,d,c){c||(c=1);for(var h,f=[];h=d.exec(o);)f.push(h[c]);return f})(n,/\((.*?)\)/g)),e=s}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,n){for(n=n||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,18)},set:function(t){t?this.Ff=ua(this.Ff,18):this.Ff=ha(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=ua(this.Ff,19):this.Ff=ha(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,20)},set:function(t){t?(this.Ff=ua(this.Ff,20),e.sort()):this.Ff=ha(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,22)},set:function(t){t?this.Ff=ua(this.Ff,22):this.Ff=ha(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,23)},set:function(t){t?this.Ff=ua(this.Ff,23):this.Ff=ha(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,27)},set:function(t){t?this.Ff=ua(this.Ff,27):this.Ff=ha(this.Ff,27)}}),this.hasAppearanceStream=!1};Gl(uf,Qc);var hf=function(){uf.call(this),this.fontName="helvetica",this.combo=!1};Gl(hf,uf);var ff=function(){hf.call(this),this.combo=!0};Gl(ff,hf);var Ug=function(){ff.call(this),this.edit=!0};Gl(Ug,ff);var lo=function(){Qc.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,15)},set:function(t){t?this.Ff=ua(this.Ff,15):this.Ff=ha(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,16)},set:function(t){t?this.Ff=ua(this.Ff,16):this.Ff=ha(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,17)},set:function(t){t?this.Ff=ua(this.Ff,17):this.Ff=ha(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,26)},set:function(t){t?this.Ff=ua(this.Ff,26):this.Ff=ha(this.Ff,26)}});var r,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(o){return o};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,s=[];for(n in s.push("<<"),e)s.push("/"+n+" ("+gh(t(e[n]))+")");return s.push(">>"),s.join(`
`)}},set:function(t){Rs(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(t){r="/"+t}})};Gl(lo,Qc);var Hg=function(){lo.call(this),this.pushButton=!0};Gl(Hg,lo);var pf=function(){lo.call(this),this.radio=!0,this.pushButton=!1;var r=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e!==void 0?e:[]}})};Gl(pf,lo);var Jg=function(){var r,e;Qc.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return r},set:function(s){r=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(s){e=s}});var t,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(c){return c};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var o,d=[];for(o in d.push("<<"),n)d.push("/"+o+" ("+gh(s(n[o]))+")");return d.push(">>"),d.join(`
`)},set:function(s){Rs(s)==="object"&&(n=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(s){typeof s=="string"&&(n.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(s){t=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(s){t="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=gn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Gl(Jg,Qc),pf.prototype.setAppearance=function(r){if(!("createAppearanceStream"in r)||!("getCA"in r))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=r.createAppearanceStream(t.optionName),t.caption=r.getCA()}},pf.prototype.createOption=function(r){var e=new Jg;return e.Parent=this,e.optionName=r,this.Kids.push(e),OA.call(this.scope,e),e};var qg=function(){lo.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=gn.CheckBox.createAppearanceStream()};Gl(qg,lo);var ch=function(){Qc.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,13)},set:function(e){e?this.Ff=ua(this.Ff,13):this.Ff=ha(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,21)},set:function(e){e?this.Ff=ua(this.Ff,21):this.Ff=ha(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,23)},set:function(e){e?this.Ff=ua(this.Ff,23):this.Ff=ha(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,24)},set:function(e){e?this.Ff=ua(this.Ff,24):this.Ff=ha(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,25)},set:function(e){e?this.Ff=ua(this.Ff,25):this.Ff=ha(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,26)},set:function(e){e?this.Ff=ua(this.Ff,26):this.Ff=ha(this.Ff,26)}});var r=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return r},set:function(e){Number.isInteger(e)&&(r=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Gl(ch,Qc);var Vg=function(){ch.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,14)},set:function(r){r?this.Ff=ua(this.Ff,14):this.Ff=ha(this.Ff,14)}}),this.password=!0};Gl(Vg,ch);var gn={CheckBox:{createAppearanceStream:function(){return{N:{On:gn.CheckBox.YesNormal},D:{On:gn.CheckBox.YesPushDown,Off:gn.CheckBox.OffPushDown}}},YesPushDown:function(r){var e=Sd(r);e.scope=r.scope;var t=[],n=r.scope.internal.getFont(r.fontName,r.fontStyle).id,s=r.scope.__private__.encodeColorString(r.color),o=Zm(r,r.caption);return t.push("0.749023 g"),t.push("0 0 "+ui(gn.internal.getWidth(r))+" "+ui(gn.internal.getHeight(r))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+n+" "+ui(o.fontSize)+" Tf "+s),t.push("BT"),t.push(o.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(r){var e=Sd(r);e.scope=r.scope;var t=r.scope.internal.getFont(r.fontName,r.fontStyle).id,n=r.scope.__private__.encodeColorString(r.color),s=[],o=gn.internal.getHeight(r),d=gn.internal.getWidth(r),c=Zm(r,r.caption);return s.push("1 g"),s.push("0 0 "+ui(d)+" "+ui(o)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+ui(d-1)+" "+ui(o-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+t+" "+ui(c.fontSize)+" Tf "+n),s.push(c.text),s.push("ET"),s.push("Q"),e.stream=s.join(`
`),e},OffPushDown:function(r){var e=Sd(r);e.scope=r.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+ui(gn.internal.getWidth(r))+" "+ui(gn.internal.getHeight(r))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(r){var e={D:{Off:gn.RadioButton.Circle.OffPushDown},N:{}};return e.N[r]=gn.RadioButton.Circle.YesNormal,e.D[r]=gn.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(r){var e=Sd(r);e.scope=r.scope;var t=[],n=gn.internal.getWidth(r)<=gn.internal.getHeight(r)?gn.internal.getWidth(r)/4:gn.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var s=gn.internal.Bezier_C,o=Number((n*s).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+ju(gn.internal.getWidth(r)/2)+" "+ju(gn.internal.getHeight(r)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),t.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),t.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),t.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(r){var e=Sd(r);e.scope=r.scope;var t=[],n=gn.internal.getWidth(r)<=gn.internal.getHeight(r)?gn.internal.getWidth(r)/4:gn.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),o=Number((s*gn.internal.Bezier_C).toFixed(5)),d=Number((n*gn.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+ju(gn.internal.getWidth(r)/2)+" "+ju(gn.internal.getHeight(r)/2)+" cm"),t.push(s+" 0 m"),t.push(s+" "+o+" "+o+" "+s+" 0 "+s+" c"),t.push("-"+o+" "+s+" -"+s+" "+o+" -"+s+" 0 c"),t.push("-"+s+" -"+o+" -"+o+" -"+s+" 0 -"+s+" c"),t.push(o+" -"+s+" "+s+" -"+o+" "+s+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+ju(gn.internal.getWidth(r)/2)+" "+ju(gn.internal.getHeight(r)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+d+" "+d+" "+n+" 0 "+n+" c"),t.push("-"+d+" "+n+" -"+n+" "+d+" -"+n+" 0 c"),t.push("-"+n+" -"+d+" -"+d+" -"+n+" 0 -"+n+" c"),t.push(d+" -"+n+" "+n+" -"+d+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(r){var e=Sd(r);e.scope=r.scope;var t=[],n=gn.internal.getWidth(r)<=gn.internal.getHeight(r)?gn.internal.getWidth(r)/4:gn.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),o=Number((s*gn.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+ju(gn.internal.getWidth(r)/2)+" "+ju(gn.internal.getHeight(r)/2)+" cm"),t.push(s+" 0 m"),t.push(s+" "+o+" "+o+" "+s+" 0 "+s+" c"),t.push("-"+o+" "+s+" -"+s+" "+o+" -"+s+" 0 c"),t.push("-"+s+" -"+o+" -"+o+" -"+s+" 0 -"+s+" c"),t.push(o+" -"+s+" "+s+" -"+o+" "+s+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(r){var e={D:{Off:gn.RadioButton.Cross.OffPushDown},N:{}};return e.N[r]=gn.RadioButton.Cross.YesNormal,e.D[r]=gn.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(r){var e=Sd(r);e.scope=r.scope;var t=[],n=gn.internal.calculateCross(r);return t.push("q"),t.push("1 1 "+ui(gn.internal.getWidth(r)-2)+" "+ui(gn.internal.getHeight(r)-2)+" re"),t.push("W"),t.push("n"),t.push(ui(n.x1.x)+" "+ui(n.x1.y)+" m"),t.push(ui(n.x2.x)+" "+ui(n.x2.y)+" l"),t.push(ui(n.x4.x)+" "+ui(n.x4.y)+" m"),t.push(ui(n.x3.x)+" "+ui(n.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(r){var e=Sd(r);e.scope=r.scope;var t=gn.internal.calculateCross(r),n=[];return n.push("0.749023 g"),n.push("0 0 "+ui(gn.internal.getWidth(r))+" "+ui(gn.internal.getHeight(r))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+ui(gn.internal.getWidth(r)-2)+" "+ui(gn.internal.getHeight(r)-2)+" re"),n.push("W"),n.push("n"),n.push(ui(t.x1.x)+" "+ui(t.x1.y)+" m"),n.push(ui(t.x2.x)+" "+ui(t.x2.y)+" l"),n.push(ui(t.x4.x)+" "+ui(t.x4.y)+" m"),n.push(ui(t.x3.x)+" "+ui(t.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(r){var e=Sd(r);e.scope=r.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+ui(gn.internal.getWidth(r))+" "+ui(gn.internal.getHeight(r))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(r){var e=r.scope.internal.getFont(r.fontName,r.fontStyle).id,t=r.scope.__private__.encodeColorString(r.color);return"/"+e+" "+r.fontSize+" Tf "+t}};gn.internal={Bezier_C:.551915024494,calculateCross:function(r){var e=gn.internal.getWidth(r),t=gn.internal.getHeight(r),n=Math.min(e,t);return{x1:{x:(e-n)/2,y:(t-n)/2+n},x2:{x:(e-n)/2+n,y:(t-n)/2},x3:{x:(e-n)/2,y:(t-n)/2},x4:{x:(e-n)/2+n,y:(t-n)/2+n}}}},gn.internal.getWidth=function(r){var e=0;return Rs(r)==="object"&&(e=sb(r.Rect[2])),e},gn.internal.getHeight=function(r){var e=0;return Rs(r)==="object"&&(e=sb(r.Rect[3])),e};var OA=ea.addField=function(r){if(BA(this,r),!(r instanceof Qc))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=r).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),r.page=r.scope.internal.getCurrentPageInfo().pageNumber,this};ea.AcroFormChoiceField=uf,ea.AcroFormListBox=hf,ea.AcroFormComboBox=ff,ea.AcroFormEditBox=Ug,ea.AcroFormButton=lo,ea.AcroFormPushButton=Hg,ea.AcroFormRadioButton=pf,ea.AcroFormCheckBox=qg,ea.AcroFormTextField=ch,ea.AcroFormPasswordField=Vg,ea.AcroFormAppearance=gn,ea.AcroForm={ChoiceField:uf,ListBox:hf,ComboBox:ff,EditBox:Ug,Button:lo,PushButton:Hg,RadioButton:pf,CheckBox:qg,TextField:ch,PasswordField:Vg,Appearance:gn},jn.AcroForm={ChoiceField:uf,ListBox:hf,ComboBox:ff,EditBox:Ug,Button:lo,PushButton:Hg,RadioButton:pf,CheckBox:qg,TextField:ch,PasswordField:Vg,Appearance:gn};jn.AcroForm;function H2(r){return r.reduce(function(e,t,n){return e[t]=n,e},{})}(function(r){var e="addImage_";r.__addimage__={};var t="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=r.__addimage__.getImageFileTypeByImageData=function(M,T){var R,Z,se,V,ee,ae=t;if((T=T||t)==="RGBA"||M.data!==void 0&&M.data instanceof Uint8ClampedArray&&"height"in M&&"width"in M)return"RGBA";if(G(M))for(ee in n)for(se=n[ee],R=0;R<se.length;R+=1){for(V=!0,Z=0;Z<se[R].length;Z+=1)if(se[R][Z]!==void 0&&se[R][Z]!==M[Z]){V=!1;break}if(V===!0){ae=ee;break}}else for(ee in n)for(se=n[ee],R=0;R<se.length;R+=1){for(V=!0,Z=0;Z<se[R].length;Z+=1)if(se[R][Z]!==void 0&&se[R][Z]!==M.charCodeAt(Z)){V=!1;break}if(V===!0){ae=ee;break}}return ae===t&&T!==t&&(ae=T),ae},o=function M(T){for(var R=this.internal.write,Z=this.internal.putStream,se=(0,this.internal.getFilters)();se.indexOf("FlateEncode")!==-1;)se.splice(se.indexOf("FlateEncode"),1);T.objectId=this.internal.newObject();var V=[];if(V.push({key:"Type",value:"/XObject"}),V.push({key:"Subtype",value:"/Image"}),V.push({key:"Width",value:T.width}),V.push({key:"Height",value:T.height}),T.colorSpace===N.INDEXED?V.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(T.palette.length/3-1)+" "+("sMask"in T&&T.sMask!==void 0?T.objectId+2:T.objectId+1)+" 0 R]"}):(V.push({key:"ColorSpace",value:"/"+T.colorSpace}),T.colorSpace===N.DEVICE_CMYK&&V.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),V.push({key:"BitsPerComponent",value:T.bitsPerComponent}),"decodeParameters"in T&&T.decodeParameters!==void 0&&V.push({key:"DecodeParms",value:"<<"+T.decodeParameters+">>"}),"transparency"in T&&Array.isArray(T.transparency)&&T.transparency.length>0){for(var ee="",ae=0,Ce=T.transparency.length;ae<Ce;ae++)ee+=T.transparency[ae]+" "+T.transparency[ae]+" ";V.push({key:"Mask",value:"["+ee+"]"})}T.sMask!==void 0&&V.push({key:"SMask",value:T.objectId+1+" 0 R"});var xe=T.filter!==void 0?["/"+T.filter]:void 0;if(Z({data:T.data,additionalKeyValues:V,alreadyAppliedFilters:xe,objectId:T.objectId}),R("endobj"),"sMask"in T&&T.sMask!==void 0){var J,D=(J=T.sMaskBitsPerComponent)!==null&&J!==void 0?J:T.bitsPerComponent,W={width:T.width,height:T.height,colorSpace:"DeviceGray",bitsPerComponent:D,data:T.sMask};"filter"in T&&(W.decodeParameters="/Predictor ".concat(T.predictor," /Colors 1 /BitsPerComponent ").concat(D," /Columns ").concat(T.width),W.filter=T.filter),M.call(this,W)}if(T.colorSpace===N.INDEXED){var K=this.internal.newObject();Z({data:F(new Uint8Array(T.palette)),objectId:K}),R("endobj")}},d=function(){var M=this.internal.collections[e+"images"];for(var T in M)o.call(this,M[T])},c=function(){var M,T=this.internal.collections[e+"images"],R=this.internal.write;for(var Z in T)R("/I"+(M=T[Z]).index,M.objectId,"0","R")},h=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",d),this.internal.events.subscribe("putXobjectDict",c))},f=function(){var M=this.internal.collections[e+"images"];return h.call(this),M},m=function(){return Object.keys(this.internal.collections[e+"images"]).length},b=function(M){return typeof r["process"+M.toUpperCase()]=="function"},S=function(M){return Rs(M)==="object"&&M.nodeType===1},v=function(M,T){if(M.nodeName==="IMG"&&M.hasAttribute("src")){var R=""+M.getAttribute("src");if(R.indexOf("data:image/")===0)return Fg(unescape(R).split("base64,").pop());var Z=r.loadFile(R,!0);if(Z!==void 0)return Z}if(M.nodeName==="CANVAS"){if(M.width===0||M.height===0)throw new Error("Given canvas must have data. Canvas width: "+M.width+", height: "+M.height);var se;switch(T){case"PNG":se="image/png";break;case"WEBP":se="image/webp";break;default:se="image/jpeg"}return Fg(M.toDataURL(se,1).split("base64,").pop())}},P=function(M){var T=this.internal.collections[e+"images"];if(T){for(var R in T)if(M===T[R].alias)return T[R]}},x=function(M,T,R){return M||T||(M=-96,T=-96),M<0&&(M=-1*R.width*72/M/this.internal.scaleFactor),T<0&&(T=-1*R.height*72/T/this.internal.scaleFactor),M===0&&(M=T*R.width/R.height),T===0&&(T=M*R.height/R.width),[M,T]},k=function(M,T,R,Z,se,V){var ee=x.call(this,R,Z,se),ae=this.internal.getCoordinateString,Ce=this.internal.getVerticalCoordinateString,xe=f.call(this);if(R=ee[0],Z=ee[1],xe[se.index]=se,V){V*=Math.PI/180;var J=Math.cos(V),D=Math.sin(V),W=function(ue){return ue.toFixed(4)},K=[W(J),W(D),W(-1*D),W(J),0,0,"cm"]}this.internal.write("q"),V?(this.internal.write([1,"0","0",1,ae(M),Ce(T+Z),"cm"].join(" ")),this.internal.write(K.join(" ")),this.internal.write([ae(R),"0","0",ae(Z),"0","0","cm"].join(" "))):this.internal.write([ae(R),"0","0",ae(Z),ae(M),Ce(T+Z),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+se.index+" Do"),this.internal.write("Q")},N=r.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};r.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var $=r.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},I=r.__addimage__.sHashCode=function(M){var T,R,Z=0;if(typeof M=="string")for(R=M.length,T=0;T<R;T++)Z=(Z<<5)-Z+M.charCodeAt(T),Z|=0;else if(G(M))for(R=M.byteLength/2,T=0;T<R;T++)Z=(Z<<5)-Z+M[T],Z|=0;return Z},z=r.__addimage__.validateStringAsBase64=function(M){(M=M||"").toString().trim();var T=!0;return M.length===0&&(T=!1),M.length%4!=0&&(T=!1),/^[A-Za-z0-9+/]+$/.test(M.substr(0,M.length-2))===!1&&(T=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(M.substr(-2))===!1&&(T=!1),T},B=r.__addimage__.extractImageFromDataUrl=function(M){if(M==null||!(M=M.trim()).startsWith("data:"))return null;var T=M.indexOf(",");return T<0?null:M.substring(0,T).trim().endsWith("base64")?M.substring(T+1):null};r.__addimage__.isArrayBuffer=function(M){return M instanceof ArrayBuffer};var G=r.__addimage__.isArrayBufferView=function(M){return M instanceof Int8Array||M instanceof Uint8Array||M instanceof Uint8ClampedArray||M instanceof Int16Array||M instanceof Uint16Array||M instanceof Int32Array||M instanceof Uint32Array||M instanceof Float32Array||M instanceof Float64Array},te=r.__addimage__.binaryStringToUint8Array=function(M){for(var T=M.length,R=new Uint8Array(T),Z=0;Z<T;Z++)R[Z]=M.charCodeAt(Z);return R},F=r.__addimage__.arrayBufferToBinaryString=function(M){for(var T="",R=G(M)?M:new Uint8Array(M),Z=0;Z<R.length;Z+=8192)T+=String.fromCharCode.apply(null,R.subarray(Z,Z+8192));return T};r.addImage=function(){var M,T,R,Z,se,V,ee,ae,Ce;if(typeof arguments[1]=="number"?(T=t,R=arguments[1],Z=arguments[2],se=arguments[3],V=arguments[4],ee=arguments[5],ae=arguments[6],Ce=arguments[7]):(T=arguments[1],R=arguments[2],Z=arguments[3],se=arguments[4],V=arguments[5],ee=arguments[6],ae=arguments[7],Ce=arguments[8]),Rs(M=arguments[0])==="object"&&!S(M)&&"imageData"in M){var xe=M;M=xe.imageData,T=xe.format||T||t,R=xe.x||R||0,Z=xe.y||Z||0,se=xe.w||xe.width||se,V=xe.h||xe.height||V,ee=xe.alias||ee,ae=xe.compression||ae,Ce=xe.rotation||xe.angle||Ce}var J=this.internal.getFilters();if(ae===void 0&&J.indexOf("FlateEncode")!==-1&&(ae="SLOW"),isNaN(R)||isNaN(Z))throw new Error("Invalid coordinates passed to jsPDF.addImage");h.call(this);var D=H.call(this,M,T,ee,ae);return k.call(this,R,Z,se,V,D,Ce),this};var H=function(M,T,R,Z){var se,V,ee;if(typeof M=="string"&&s(M)===t){M=unescape(M);var ae=Q(M,!1);(ae!==""||(ae=r.loadFile(M,!0))!==void 0)&&(M=ae)}if(S(M)&&(M=v(M,T)),T=s(M,T),!b(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(((ee=R)==null||ee.length===0)&&(R=(function(Ce){return typeof Ce=="string"||G(Ce)?I(Ce):G(Ce.data)?I(Ce.data):null})(M)),(se=P.call(this,R))||(M instanceof Uint8Array||T==="RGBA"||(V=M,M=te(M)),se=this["process"+T.toUpperCase()](M,m.call(this),R,(function(Ce){return Ce&&typeof Ce=="string"&&(Ce=Ce.toUpperCase()),Ce in r.image_compression?Ce:$.NONE})(Z),V)),!se)throw new Error("An unknown error occurred whilst processing the image.");return se},Q=r.__addimage__.convertBase64ToBinaryString=function(M,T){T=typeof T!="boolean"||T;var R,Z="";if(typeof M=="string"){var se;R=(se=B(M))!==null&&se!==void 0?se:M;try{Z=Fg(R)}catch(V){if(T)throw z(R)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+V.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return Z};r.getImageProperties=function(M){var T,R,Z="";if(S(M)&&(M=v(M)),typeof M=="string"&&s(M)===t&&((Z=Q(M,!1))===""&&(Z=r.loadFile(M)||""),M=Z),R=s(M),!b(R))throw new Error("addImage does not support files of type '"+R+"', please ensure that a plugin for '"+R+"' support is added.");if(M instanceof Uint8Array||(M=te(M)),!(T=this["process"+R.toUpperCase()](M)))throw new Error("An unknown error occurred whilst processing the image");return T.fileType=R,T}})(jn.API),(function(r){var e=function(t){if(t!==void 0&&t!="")return!0};jn.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),r.events.push(["putPage",function(t){for(var n,s,o,d=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString,h=this.internal.getPageInfoByObjId(t.objId),f=t.pageContext.annotations,m=!1,b=0;b<f.length&&!m;b++)switch((n=f[b]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(m=!0);break;case"reference":case"text":case"freetext":m=!0}if(m!=0){this.internal.write("/Annots [");for(var S=0;S<f.length;S++){n=f[S];var v=this.internal.pdfEscape,P=this.internal.getEncryptor(t.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var x=this.internal.newAdditionalObject(),k=this.internal.newAdditionalObject(),N=this.internal.getEncryptor(x.objId),$=n.title||"Note";o="<</Type /Annot /Subtype /Text "+(s="/Rect ["+d(n.bounds.x)+" "+c(n.bounds.y+n.bounds.h)+" "+d(n.bounds.x+n.bounds.w)+" "+c(n.bounds.y)+"] ")+"/Contents ("+v(N(n.contents))+")",o+=" /Popup "+k.objId+" 0 R",o+=" /P "+h.objId+" 0 R",o+=" /T ("+v(N($))+") >>",x.content=o;var I=x.objId+" 0 R";o="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+d(n.bounds.x+30)+" "+c(n.bounds.y+n.bounds.h)+" "+d(n.bounds.x+n.bounds.w+30)+" "+c(n.bounds.y)+"] ")+" /Parent "+I,n.open&&(o+=" /Open true"),o+=" >>",k.content=o,this.internal.write(x.objId,"0 R",k.objId,"0 R");break;case"freetext":s="/Rect ["+d(n.bounds.x)+" "+c(n.bounds.y)+" "+d(n.bounds.x+n.bounds.w)+" "+c(n.bounds.y+n.bounds.h)+"] ";var z=n.color||"#000000";o="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+v(P(n.contents))+")",o+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+z+")",o+=" /Border [0 0 0]",o+=" >>",this.internal.write(o);break;case"link":if(n.options.name){var B=this.annotations._nameMap[n.options.name];n.options.pageNumber=B.page,n.options.top=B.y}else n.options.top||(n.options.top=0);if(s="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",o="",n.options.url)o="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+v(P(n.options.url))+") >>";else if(n.options.pageNumber)switch(o="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":o+=" /Fit]";break;case"FitH":o+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,o+=" /FitV "+n.options.left+"]";break;default:var G=c(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),o+=" /XYZ "+n.options.left+" "+G+" "+n.options.zoom+"]"}o!=""&&(o+=" >>",this.internal.write(o))}}this.internal.write("]")}}]),r.createAnnotation=function(t){var n=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":n.pageContext.annotations.push(t)}},r.link=function(t,n,s,o,d){var c=this.internal.getCurrentPageInfo(),h=this.internal.getCoordinateString,f=this.internal.getVerticalCoordinateString;c.pageContext.annotations.push({finalBounds:{x:h(t),y:f(n),w:h(t+s),h:f(n+o)},options:d,type:"link"})},r.textWithLink=function(t,n,s,o){var d,c,h=this.getTextWidth(t),f=this.internal.getLineHeight()/this.internal.scaleFactor;if(o.maxWidth!==void 0){c=o.maxWidth;var m=this.splitTextToSize(t,c).length;d=Math.ceil(f*m)}else c=h,d=f;return this.text(t,n,s,o),s+=.2*f,o.align==="center"&&(n-=h/2),o.align==="right"&&(n-=h),this.link(n,s-f,c,d,o),h},r.getTextWidth=function(t){var n=this.internal.getFontSize();return this.getStringUnitWidth(t)*n/this.internal.scaleFactor}})(jn.API),(function(r){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];r.__arabicParser__={};var o=r.__arabicParser__.isInArabicSubstitutionA=function(x){return e[x.charCodeAt(0)]!==void 0},d=r.__arabicParser__.isArabicLetter=function(x){return typeof x=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(x)},c=r.__arabicParser__.isArabicEndLetter=function(x){return d(x)&&o(x)&&e[x.charCodeAt(0)].length<=2},h=r.__arabicParser__.isArabicAlfLetter=function(x){return d(x)&&s.indexOf(x.charCodeAt(0))>=0};r.__arabicParser__.arabicLetterHasIsolatedForm=function(x){return d(x)&&o(x)&&e[x.charCodeAt(0)].length>=1};var f=r.__arabicParser__.arabicLetterHasFinalForm=function(x){return d(x)&&o(x)&&e[x.charCodeAt(0)].length>=2};r.__arabicParser__.arabicLetterHasInitialForm=function(x){return d(x)&&o(x)&&e[x.charCodeAt(0)].length>=3};var m=r.__arabicParser__.arabicLetterHasMedialForm=function(x){return d(x)&&o(x)&&e[x.charCodeAt(0)].length==4},b=r.__arabicParser__.resolveLigatures=function(x){var k=0,N=t,$="",I=0;for(k=0;k<x.length;k+=1)N[x.charCodeAt(k)]!==void 0?(I++,typeof(N=N[x.charCodeAt(k)])=="number"&&($+=String.fromCharCode(N),N=t,I=0),k===x.length-1&&(N=t,$+=x.charAt(k-(I-1)),k-=I-1,I=0)):(N=t,$+=x.charAt(k-I),k-=I,I=0);return $};r.__arabicParser__.isArabicDiacritic=function(x){return x!==void 0&&n[x.charCodeAt(0)]!==void 0};var S=r.__arabicParser__.getCorrectForm=function(x,k,N){return d(x)?o(x)===!1?-1:!f(x)||!d(k)&&!d(N)||!d(N)&&c(k)||c(x)&&!d(k)||c(x)&&h(k)||c(x)&&c(k)?0:m(x)&&d(k)&&!c(k)&&d(N)&&f(N)?3:c(x)||!d(N)?1:2:-1},v=function(x){var k=0,N=0,$=0,I="",z="",B="",G=(x=x||"").split("\\s+"),te=[];for(k=0;k<G.length;k+=1){for(te.push(""),N=0;N<G[k].length;N+=1)I=G[k][N],z=G[k][N-1],B=G[k][N+1],d(I)?($=S(I,z,B),te[k]+=$!==-1?String.fromCharCode(e[I.charCodeAt(0)][$]):I):te[k]+=I;te[k]=b(te[k])}return te.join(" ")},P=r.__arabicParser__.processArabic=r.processArabic=function(){var x,k=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,N=[];if(Array.isArray(k)){var $=0;for(N=[],$=0;$<k.length;$+=1)Array.isArray(k[$])?N.push([v(k[$][0]),k[$][1],k[$][2]]):N.push([v(k[$])]);x=N}else x=v(k);return typeof arguments[0]=="string"?x:(arguments[0].text=x,arguments[0])};r.events.push(["preProcessText",P])})(jn.API),jn.API.autoPrint=function(r){var e;return(r=r||{}).variant=r.variant||"non-conform",r.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(r){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(c){t=c}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(c){n=isNaN(c)||Number.isInteger(c)===!1||c<0?150:c,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(c){s=isNaN(c)||Number.isInteger(c)===!1||c<0?300:c,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var o=[];Object.defineProperty(this,"childNodes",{get:function(){return o},set:function(c){o=c}});var d={};Object.defineProperty(this,"style",{get:function(){return d},set:function(c){d=c}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,n){var s;if((t=t||"2d")!=="2d")return null;for(s in n)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=n[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},r.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(jn.API),(function(r){var e={left:0,top:0,bottom:0,right:0},t=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var h=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return h},set:function(x){h=x}});var f=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return f},set:function(x){f=x}});var m=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return m},set:function(x){m=x}});var b=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return b},set:function(x){b=x}});var S=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return S},set:function(x){S=x}});var v=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return v},set:function(x){v=x}});var P=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return P},set:function(x){P=x}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},r.setHeaderFunction=function(h){return n.call(this),this.internal.__cell__.headerFunction=typeof h=="function"?h:void 0,this},r.getTextDimensions=function(h,f){n.call(this);var m=(f=f||{}).fontSize||this.getFontSize(),b=f.font||this.getFont(),S=f.scaleFactor||this.internal.scaleFactor,v=0,P=0,x=0,k=this;if(!Array.isArray(h)&&typeof h!="string"){if(typeof h!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");h=String(h)}var N=f.maxWidth;N>0?typeof h=="string"?h=this.splitTextToSize(h,N):Object.prototype.toString.call(h)==="[object Array]"&&(h=h.reduce(function(I,z){return I.concat(k.splitTextToSize(z,N))},[])):h=Array.isArray(h)?h:[h];for(var $=0;$<h.length;$++)v<(x=this.getStringUnitWidth(h[$],{font:b})*m)&&(v=x);return v!==0&&(P=h.length),{w:v/=S,h:Math.max((P*m*this.getLineHeightFactor()-m*(this.getLineHeightFactor()-1))/S,0)}},r.cellAddPage=function(){n.call(this),this.addPage();var h=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new o(h.left,h.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var d=r.cell=function(){var h;h=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var f=this.internal.__cell__.lastCell,m=this.internal.__cell__.padding,b=this.internal.__cell__.margins||e,S=this.internal.__cell__.tableHeaderRow,v=this.internal.__cell__.printHeaders;return f.lineNumber!==void 0&&(f.lineNumber===h.lineNumber?(h.x=(f.x||0)+(f.width||0),h.y=f.y||0):f.y+f.height+h.height+b.bottom>this.getPageHeight()?(this.cellAddPage(),h.y=b.top,v&&S&&(this.printHeaderRow(h.lineNumber,!0),h.y+=S[0].height)):h.y=f.y+f.height||h.y),h.text[0]!==void 0&&(this.rect(h.x,h.y,h.width,h.height,t===!0?"FD":void 0),h.align==="right"?this.text(h.text,h.x+h.width-m,h.y+m,{align:"right",baseline:"top"}):h.align==="center"?this.text(h.text,h.x+h.width/2,h.y+m,{align:"center",baseline:"top",maxWidth:h.width-m-m}):this.text(h.text,h.x+m,h.y+m,{align:"left",baseline:"top",maxWidth:h.width-m-m})),this.internal.__cell__.lastCell=h,this};r.table=function(h,f,m,b,S){if(n.call(this),!m)throw new Error("No data for PDF table.");var v,P,x,k,N=[],$=[],I=[],z={},B={},G=[],te=[],F=(S=S||{}).autoSize||!1,H=S.printHeaders!==!1,Q=S.css&&S.css["font-size"]!==void 0?16*S.css["font-size"]:S.fontSize||12,M=S.margins||Object.assign({width:this.getPageWidth()},e),T=typeof S.padding=="number"?S.padding:3,R=S.headerBackgroundColor||"#c8c8c8",Z=S.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=H,this.internal.__cell__.margins=M,this.internal.__cell__.table_font_size=Q,this.internal.__cell__.padding=T,this.internal.__cell__.headerBackgroundColor=R,this.internal.__cell__.headerTextColor=Z,this.setFontSize(Q),b==null)$=N=Object.keys(m[0]),I=N.map(function(){return"left"});else if(Array.isArray(b)&&Rs(b[0])==="object")for(N=b.map(function(xe){return xe.name}),$=b.map(function(xe){return xe.prompt||xe.name||""}),I=b.map(function(xe){return xe.align||"left"}),v=0;v<b.length;v+=1)B[b[v].name]=.7499990551181103*b[v].width;else Array.isArray(b)&&typeof b[0]=="string"&&($=N=b,I=N.map(function(){return"left"}));if(F||Array.isArray(b)&&typeof b[0]=="string")for(v=0;v<N.length;v+=1){for(z[k=N[v]]=m.map(function(xe){return xe[k]}),this.setFont(void 0,"bold"),G.push(this.getTextDimensions($[v],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),P=z[k],this.setFont(void 0,"normal"),x=0;x<P.length;x+=1)G.push(this.getTextDimensions(P[x],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);B[k]=Math.max.apply(null,G)+T+T,G=[]}if(H){var se={};for(v=0;v<N.length;v+=1)se[N[v]]={},se[N[v]].text=$[v],se[N[v]].align=I[v];var V=c.call(this,se,B);te=N.map(function(xe){return new o(h,f,B[xe],V,se[xe].text,void 0,se[xe].align)}),this.setTableHeaderRow(te),this.printHeaderRow(1,!1)}var ee=b.reduce(function(xe,J){return xe[J.name]=J.align,xe},{});for(v=0;v<m.length;v+=1){"rowStart"in S&&S.rowStart instanceof Function&&S.rowStart({row:v,data:m[v]},this);var ae=c.call(this,m[v],B);for(x=0;x<N.length;x+=1){var Ce=m[v][N[x]];"cellStart"in S&&S.cellStart instanceof Function&&S.cellStart({row:v,col:x,data:Ce},this),d.call(this,new o(h,f,B[N[x]],ae,Ce,v+2,ee[N[x]]))}}return this.internal.__cell__.table_x=h,this.internal.__cell__.table_y=f,this};var c=function(h,f){var m=this.internal.__cell__.padding,b=this.internal.__cell__.table_font_size,S=this.internal.scaleFactor;return Object.keys(h).map(function(v){var P=h[v];return this.splitTextToSize(P.hasOwnProperty("text")?P.text:P,f[v]-m-m)},this).map(function(v){return this.getLineHeightFactor()*v.length*b/S+m+m},this).reduce(function(v,P){return Math.max(v,P)},0)};r.setTableHeaderRow=function(h){n.call(this),this.internal.__cell__.tableHeaderRow=h},r.printHeaderRow=function(h,f){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var m;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var b=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(b[0],b[1],b[2],b[3],void 0,-1)}this.setFont(void 0,"bold");for(var S=[],v=0;v<this.internal.__cell__.tableHeaderRow.length;v+=1){m=this.internal.__cell__.tableHeaderRow[v].clone(),f&&(m.y=this.internal.__cell__.margins.top||0,S.push(m)),m.lineNumber=h;var P=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),d.call(this,m),this.setTextColor(P)}S.length>0&&this.setTableHeaderRow(S),this.setFont(void 0,"normal"),t=!1}})(jn.API);var q2={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},V2=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Jm=H2(V2),W2=[100,200,300,400,500,600,700,800,900],FA=H2(W2);function Cm(r){var e=r.family.replace(/"|'/g,"").toLowerCase(),t=(function(o){return q2[o=o||"normal"]?o:"normal"})(r.style),n=(function(o){return o?typeof o=="number"?o>=100&&o<=900&&o%100==0?o:400:/^\d00$/.test(o)?parseInt(o):o==="bold"?700:400:400})(r.weight),s=(function(o){return typeof Jm[o=o||"normal"]=="number"?o:"normal"})(r.stretch);return{family:e,style:t,weight:n,stretch:s,src:r.src||[],ref:r.ref||{name:e,style:[s,t,n].join(" ")}}}function rb(r,e,t,n){var s;for(s=t;s>=0&&s<e.length;s+=n)if(r[e[s]])return r[e[s]];for(s=t;s>=0&&s<e.length;s-=n)if(r[e[s]])return r[e[s]]}var UA={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},ab={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function ob(r){return[r.stretch,r.style,r.weight,r.family].join(" ")}function lb(r){return r.trimLeft()}function HA(r,e){for(var t=0;t<r.length;){if(r.charAt(t)===e)return[r.substring(0,t),r.substring(t+1)];t+=1}return null}function qA(r){var e=r.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],r.substring(e[0].length)]}var kg,cb,db,Jh,Ng,ub,hb,fb,Tm=["times"];function pb(r,e,t,n,s){var o=4,d=mb;switch(s){case jn.API.image_compression.FAST:o=1,d=gb;break;case jn.API.image_compression.MEDIUM:o=6,d=yb;break;case jn.API.image_compression.SLOW:o=9,d=xb}r=(function(h,f,m,b){for(var S,v=h.length/f,P=new Uint8Array(h.length+v),x=[VA,gb,mb,yb,xb],k=0;k<v;k+=1){var N=k*f,$=h.subarray(N,N+f);if(b)P.set(b($,m,S),N+k);else{for(var I=x.length,z=[],B=0;B<I;B+=1)z[B]=x[B]($,m,S);var G=$A(z.concat());P.set(z[G],N+k)}S=$}return P})(r,e,Math.ceil(t*n/8),d);var c=Wm(r,{level:o});return jn.API.__addimage__.arrayBufferToBinaryString(c)}function VA(r){var e=Array.apply([],r);return e.unshift(0),e}function gb(r,e){var t=r.length,n=[];n[0]=1;for(var s=0;s<t;s+=1){var o=r[s-e]||0;n[s+1]=r[s]-o+256&255}return n}function mb(r,e,t){var n=r.length,s=[];s[0]=2;for(var o=0;o<n;o+=1){var d=t&&t[o]||0;s[o+1]=r[o]-d+256&255}return s}function yb(r,e,t){var n=r.length,s=[];s[0]=3;for(var o=0;o<n;o+=1){var d=r[o-e]||0,c=t&&t[o]||0;s[o+1]=r[o]+256-(d+c>>>1)&255}return s}function xb(r,e,t){var n=r.length,s=[];s[0]=4;for(var o=0;o<n;o+=1){var d=WA(r[o-e]||0,t&&t[o]||0,t&&t[o-e]||0);s[o+1]=r[o]-d+256&255}return s}function WA(r,e,t){if(r===e&&e===t)return r;var n=Math.abs(e-t),s=Math.abs(r-t),o=Math.abs(r+e-t-t);return n<=s&&n<=o?r:s<=o?e:t}function $A(r){var e=r.map(function(t){return t.reduce(function(n,s){return n+Math.abs(s)},0)});return e.indexOf(Math.min.apply(null,e))}function _m(r,e,t){var n=e*t,s=Math.floor(n/8),o=16-(n-8*s+t),d=(1<<t)-1;return $2(r,s)>>o&d}function bb(r,e,t,n){var s=t*n,o=Math.floor(s/8),d=16-(s-8*o+n),c=(1<<n)-1,h=(e&c)<<d;(function(f,m,b){if(m+1<f.byteLength)f.setUint16(m,b,!1);else{var S=b>>8&255;f.setUint8(m,S)}})(r,o,$2(r,o)&~(c<<d)&65535|h)}function $2(r,e){return e+1<r.byteLength?r.getUint16(e,!1):r.getUint8(e)<<8}function GA(r){var e=0;if(r[e++]!==71||r[e++]!==73||r[e++]!==70||r[e++]!==56||(r[e++]+1&253)!=56||r[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=r[e++]|r[e++]<<8,n=r[e++]|r[e++]<<8,s=r[e++],o=s>>7,d=1<<1+(7&s);r[e++],r[e++];var c=null,h=null;o&&(c=e,h=d,e+=3*d);var f=!0,m=[],b=0,S=null,v=0,P=null;for(this.width=t,this.height=n;f&&e<r.length;)switch(r[e++]){case 33:switch(r[e++]){case 255:if(r[e]!==11||r[e+1]==78&&r[e+2]==69&&r[e+3]==84&&r[e+4]==83&&r[e+5]==67&&r[e+6]==65&&r[e+7]==80&&r[e+8]==69&&r[e+9]==50&&r[e+10]==46&&r[e+11]==48&&r[e+12]==3&&r[e+13]==1&&r[e+16]==0)e+=14,P=r[e++]|r[e++]<<8,e++;else for(e+=12;;){if(!((M=r[e++])>=0))throw Error("Invalid block size");if(M===0)break;e+=M}break;case 249:if(r[e++]!==4||r[e+4]!==0)throw new Error("Invalid graphics extension block.");var x=r[e++];b=r[e++]|r[e++]<<8,S=r[e++],1&x||(S=null),v=x>>2&7,e++;break;case 254:for(;;){if(!((M=r[e++])>=0))throw Error("Invalid block size");if(M===0)break;e+=M}break;default:throw new Error("Unknown graphic control label: 0x"+r[e-1].toString(16))}break;case 44:var k=r[e++]|r[e++]<<8,N=r[e++]|r[e++]<<8,$=r[e++]|r[e++]<<8,I=r[e++]|r[e++]<<8,z=r[e++],B=z>>6&1,G=1<<1+(7&z),te=c,F=h,H=!1;z>>7&&(H=!0,te=e,F=G,e+=3*G);var Q=e;for(e++;;){var M;if(!((M=r[e++])>=0))throw Error("Invalid block size");if(M===0)break;e+=M}m.push({x:k,y:N,width:$,height:I,has_local_palette:H,palette_offset:te,palette_size:F,data_offset:Q,data_length:e-Q,transparent_index:S,interlaced:!!B,delay:b,disposal:v});break;case 59:f=!1;break;default:throw new Error("Unknown gif block: 0x"+r[e-1].toString(16))}this.numFrames=function(){return m.length},this.loopCount=function(){return P},this.frameInfo=function(T){if(T<0||T>=m.length)throw new Error("Frame index out of range.");return m[T]},this.decodeAndBlitFrameBGRA=function(T,R){var Z=this.frameInfo(T),se=Z.width*Z.height,V=new Uint8Array(se);vb(r,Z.data_offset,V,se);var ee=Z.palette_offset,ae=Z.transparent_index;ae===null&&(ae=256);var Ce=Z.width,xe=t-Ce,J=Ce,D=4*(Z.y*t+Z.x),W=4*((Z.y+Z.height)*t+Z.x),K=D,ue=4*xe;Z.interlaced===!0&&(ue+=4*t*7);for(var Te=8,Pe=0,Ve=V.length;Pe<Ve;++Pe){var De=V[Pe];if(J===0&&(J=Ce,(K+=ue)>=W&&(ue=4*xe+4*t*(Te-1),K=D+(Ce+xe)*(Te<<1),Te>>=1)),De===ae)K+=4;else{var et=r[ee+3*De],ot=r[ee+3*De+1],at=r[ee+3*De+2];R[K++]=at,R[K++]=ot,R[K++]=et,R[K++]=255}--J}},this.decodeAndBlitFrameRGBA=function(T,R){var Z=this.frameInfo(T),se=Z.width*Z.height,V=new Uint8Array(se);vb(r,Z.data_offset,V,se);var ee=Z.palette_offset,ae=Z.transparent_index;ae===null&&(ae=256);var Ce=Z.width,xe=t-Ce,J=Ce,D=4*(Z.y*t+Z.x),W=4*((Z.y+Z.height)*t+Z.x),K=D,ue=4*xe;Z.interlaced===!0&&(ue+=4*t*7);for(var Te=8,Pe=0,Ve=V.length;Pe<Ve;++Pe){var De=V[Pe];if(J===0&&(J=Ce,(K+=ue)>=W&&(ue=4*xe+4*t*(Te-1),K=D+(Ce+xe)*(Te<<1),Te>>=1)),De===ae)K+=4;else{var et=r[ee+3*De],ot=r[ee+3*De+1],at=r[ee+3*De+2];R[K++]=et,R[K++]=ot,R[K++]=at,R[K++]=255}--J}}}function vb(r,e,t,n){for(var s=r[e++],o=1<<s,d=o+1,c=d+1,h=s+1,f=(1<<h)-1,m=0,b=0,S=0,v=r[e++],P=new Int32Array(4096),x=null;;){for(;m<16&&v!==0;)b|=r[e++]<<m,m+=8,v===1?v=r[e++]:--v;if(m<h)break;var k=b&f;if(b>>=h,m-=h,k!==o){if(k===d)break;for(var N=k<c?k:x,$=0,I=N;I>o;)I=P[I]>>8,++$;var z=I;if(S+$+(N!==k?1:0)>n)return void Ys.log("Warning, gif stream longer than expected.");t[S++]=z;var B=S+=$;for(N!==k&&(t[S++]=z),I=N;$--;)I=P[I],t[--B]=255&I,I>>=8;x!==null&&c<4096&&(P[c++]=x<<8|z,c>=f+1&&h<12&&(++h,f=f<<1|1)),x=k}else c=d+1,f=(1<<(h=s+1))-1,x=null}return S!==n&&Ys.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function km(r){var e,t,n,s,o,d=Math.floor,c=new Array(64),h=new Array(64),f=new Array(64),m=new Array(64),b=new Array(65535),S=new Array(65535),v=new Array(64),P=new Array(64),x=[],k=0,N=7,$=new Array(64),I=new Array(64),z=new Array(64),B=new Array(256),G=new Array(2048),te=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],F=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],H=[0,1,2,3,4,5,6,7,8,9,10,11],Q=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],M=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],R=[0,1,2,3,4,5,6,7,8,9,10,11],Z=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],se=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function V(D,W){for(var K=0,ue=0,Te=new Array,Pe=1;Pe<=16;Pe++){for(var Ve=1;Ve<=D[Pe];Ve++)Te[W[ue]]=[],Te[W[ue]][0]=K,Te[W[ue]][1]=Pe,ue++,K++;K*=2}return Te}function ee(D){for(var W=D[0],K=D[1]-1;K>=0;)W&1<<K&&(k|=1<<N),K--,--N<0&&(k==255?(ae(255),ae(0)):ae(k),N=7,k=0)}function ae(D){x.push(D)}function Ce(D){ae(D>>8&255),ae(255&D)}function xe(D,W,K,ue,Te){for(var Pe,Ve=Te[0],De=Te[240],et=(function(it,qt){var vt,Dt,Ot,sn,kt,Lt,Jn,pt,jt,Fn,tn=0;for(jt=0;jt<8;++jt){vt=it[tn],Dt=it[tn+1],Ot=it[tn+2],sn=it[tn+3],kt=it[tn+4],Lt=it[tn+5],Jn=it[tn+6];var zn=vt+(pt=it[tn+7]),Pn=vt-pt,dn=Dt+Jn,An=Dt-Jn,lt=Ot+Lt,nn=Ot-Lt,Xt=sn+kt,Kt=sn-kt,Cn=zn+Xt,Vi=zn-Xt,Vn=dn+lt,bn=dn-lt;it[tn]=Cn+Vn,it[tn+4]=Cn-Vn;var Qt=.707106781*(bn+Vi);it[tn+2]=Vi+Qt,it[tn+6]=Vi-Qt;var Cr=.382683433*((Cn=Kt+nn)-(bn=An+Pn)),Ks=.5411961*Cn+Cr,zr=1.306562965*bn+Cr,Br=.707106781*(Vn=nn+An),en=Pn+Br,Or=Pn-Br;it[tn+5]=Or+Ks,it[tn+3]=Or-Ks,it[tn+1]=en+zr,it[tn+7]=en-zr,tn+=8}for(tn=0,jt=0;jt<8;++jt){vt=it[tn],Dt=it[tn+8],Ot=it[tn+16],sn=it[tn+24],kt=it[tn+32],Lt=it[tn+40],Jn=it[tn+48];var ja=vt+(pt=it[tn+56]),fa=vt-pt,Ct=Dt+Jn,pi=Dt-Jn,ti=Ot+Lt,vs=Ot-Lt,Ji=sn+kt,Ds=sn-kt,Ti=ja+Ji,Si=ja-Ji,Tr=Ct+ti,pa=Ct-ti;it[tn]=Ti+Tr,it[tn+32]=Ti-Tr;var qa=.707106781*(pa+Si);it[tn+16]=Si+qa,it[tn+48]=Si-qa;var Yl=.382683433*((Ti=Ds+vs)-(pa=pi+fa)),Va=.5411961*Ti+Yl,Wa=1.306562965*pa+Yl,jo=.707106781*(Tr=vs+pi),Gn=fa+jo,Fr=fa-jo;it[tn+40]=Fr+Va,it[tn+24]=Fr-Va,it[tn+8]=Gn+Wa,it[tn+56]=Gn-Wa,tn++}for(jt=0;jt<64;++jt)Fn=it[jt]*qt[jt],v[jt]=Fn>0?Fn+.5|0:Fn-.5|0;return v})(D,W),ot=0;ot<64;++ot)P[te[ot]]=et[ot];var at=P[0]-K;K=P[0],at==0?ee(ue[0]):(ee(ue[S[Pe=32767+at]]),ee(b[Pe]));for(var ht=63;ht>0&&P[ht]==0;)ht--;if(ht==0)return ee(Ve),K;for(var xt,fe=1;fe<=ht;){for(var Nt=fe;P[fe]==0&&fe<=ht;)++fe;var zt=fe-Nt;if(zt>=16){xt=zt>>4;for(var Bt=1;Bt<=xt;++Bt)ee(De);zt&=15}Pe=32767+P[fe],ee(Te[(zt<<4)+S[Pe]]),ee(b[Pe]),fe++}return ht!=63&&ee(Ve),K}function J(D){D=Math.min(Math.max(D,1),100),o!=D&&((function(W){for(var K=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],ue=0;ue<64;ue++){var Te=d((K[ue]*W+50)/100);Te=Math.min(Math.max(Te,1),255),c[te[ue]]=Te}for(var Pe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Ve=0;Ve<64;Ve++){var De=d((Pe[Ve]*W+50)/100);De=Math.min(Math.max(De,1),255),h[te[Ve]]=De}for(var et=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],ot=0,at=0;at<8;at++)for(var ht=0;ht<8;ht++)f[ot]=1/(c[te[ot]]*et[at]*et[ht]*8),m[ot]=1/(h[te[ot]]*et[at]*et[ht]*8),ot++})(D<50?Math.floor(5e3/D):Math.floor(200-2*D)),o=D)}this.encode=function(D,W){W&&J(W),x=new Array,k=0,N=7,Ce(65496),Ce(65504),Ce(16),ae(74),ae(70),ae(73),ae(70),ae(0),ae(1),ae(1),ae(0),Ce(1),Ce(1),ae(0),ae(0),(function(){Ce(65499),Ce(132),ae(0);for(var Dt=0;Dt<64;Dt++)ae(c[Dt]);ae(1);for(var Ot=0;Ot<64;Ot++)ae(h[Ot])})(),(function(Dt,Ot){Ce(65472),Ce(17),ae(8),Ce(Ot),Ce(Dt),ae(3),ae(1),ae(17),ae(0),ae(2),ae(17),ae(1),ae(3),ae(17),ae(1)})(D.width,D.height),(function(){Ce(65476),Ce(418),ae(0);for(var Dt=0;Dt<16;Dt++)ae(F[Dt+1]);for(var Ot=0;Ot<=11;Ot++)ae(H[Ot]);ae(16);for(var sn=0;sn<16;sn++)ae(Q[sn+1]);for(var kt=0;kt<=161;kt++)ae(M[kt]);ae(1);for(var Lt=0;Lt<16;Lt++)ae(T[Lt+1]);for(var Jn=0;Jn<=11;Jn++)ae(R[Jn]);ae(17);for(var pt=0;pt<16;pt++)ae(Z[pt+1]);for(var jt=0;jt<=161;jt++)ae(se[jt])})(),Ce(65498),Ce(12),ae(3),ae(1),ae(0),ae(2),ae(17),ae(3),ae(17),ae(0),ae(63),ae(0);var K=0,ue=0,Te=0;k=0,N=7,this.encode.displayName="_encode_";for(var Pe,Ve,De,et,ot,at,ht,xt,fe,Nt=D.data,zt=D.width,Bt=D.height,it=4*zt,qt=0;qt<Bt;){for(Pe=0;Pe<it;){for(ot=it*qt+Pe,ht=-1,xt=0,fe=0;fe<64;fe++)at=ot+(xt=fe>>3)*it+(ht=4*(7&fe)),qt+xt>=Bt&&(at-=it*(qt+1+xt-Bt)),Pe+ht>=it&&(at-=Pe+ht-it+4),Ve=Nt[at++],De=Nt[at++],et=Nt[at++],$[fe]=(G[Ve]+G[De+256|0]+G[et+512|0]>>16)-128,I[fe]=(G[Ve+768|0]+G[De+1024|0]+G[et+1280|0]>>16)-128,z[fe]=(G[Ve+1280|0]+G[De+1536|0]+G[et+1792|0]>>16)-128;K=xe($,f,K,e,n),ue=xe(I,m,ue,t,s),Te=xe(z,m,Te,t,s),Pe+=32}qt+=8}if(N>=0){var vt=[];vt[1]=N+1,vt[0]=(1<<N+1)-1,ee(vt)}return Ce(65497),new Uint8Array(x)},r=r||50,(function(){for(var D=String.fromCharCode,W=0;W<256;W++)B[W]=D(W)})(),e=V(F,H),t=V(T,R),n=V(Q,M),s=V(Z,se),(function(){for(var D=1,W=2,K=1;K<=15;K++){for(var ue=D;ue<W;ue++)S[32767+ue]=K,b[32767+ue]=[],b[32767+ue][1]=K,b[32767+ue][0]=ue;for(var Te=-(W-1);Te<=-D;Te++)S[32767+Te]=K,b[32767+Te]=[],b[32767+Te][1]=K,b[32767+Te][0]=W-1+Te;D<<=1,W<<=1}})(),(function(){for(var D=0;D<256;D++)G[D]=19595*D,G[D+256|0]=38470*D,G[D+512|0]=7471*D+32768,G[D+768|0]=-11059*D,G[D+1024|0]=-21709*D,G[D+1280|0]=32768*D+8421375,G[D+1536|0]=-27439*D,G[D+1792|0]=-5329*D})(),J(r)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Kc(r,e){if(this.pos=0,this.buffer=r,this.datav=new DataView(r.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function wb(r){function e(H){if(!H)throw Error("assert :P")}function t(H,Q,M){for(var T=0;4>T;T++)if(H[Q+T]!=M.charCodeAt(T))return!0;return!1}function n(H,Q,M,T,R){for(var Z=0;Z<R;Z++)H[Q+Z]=M[T+Z]}function s(H,Q,M,T){for(var R=0;R<T;R++)H[Q+R]=M}function o(H){return new Int32Array(H)}function d(H,Q){for(var M=[],T=0;T<H;T++)M.push(new Q);return M}function c(H,Q){var M=[];return(function T(R,Z,se){for(var V=se[Z],ee=0;ee<V&&(R.push(se.length>Z+1?[]:new Q),!(se.length<Z+1));ee++)T(R[ee],Z+1,se)})(M,0,H),M}var h=function(){var H=this;function Q(y,A){for(var E=1<<A-1>>>0;y&E;)E>>>=1;return E?(y&E-1)+E:y}function M(y,A,E,O,ie){e(!(O%E));do y[A+(O-=E)]=ie;while(0<O)}function T(y,A,E,O,ie){if(e(2328>=ie),512>=ie)var re=o(512);else if((re=o(ie))==null)return 0;return(function(oe,de,me,_e,ze,Ke){var ve,Be,$e=de,ut=1<<me,We=o(16),Je=o(16);for(e(ze!=0),e(_e!=null),e(oe!=null),e(0<me),Be=0;Be<ze;++Be){if(15<_e[Be])return 0;++We[_e[Be]]}if(We[0]==ze)return 0;for(Je[1]=0,ve=1;15>ve;++ve){if(We[ve]>1<<ve)return 0;Je[ve+1]=Je[ve]+We[ve]}for(Be=0;Be<ze;++Be)ve=_e[Be],0<_e[Be]&&(Ke[Je[ve]++]=Be);if(Je[15]==1)return(_e=new R).g=0,_e.value=Ke[0],M(oe,$e,1,ut,_e),ut;var mt,_t=-1,wt=ut-1,on=0,$t=1,ln=1,Ht=1<<me;for(Be=0,ve=1,ze=2;ve<=me;++ve,ze<<=1){if($t+=ln<<=1,0>(ln-=We[ve]))return 0;for(;0<We[ve];--We[ve])(_e=new R).g=ve,_e.value=Ke[Be++],M(oe,$e+on,ze,Ht,_e),on=Q(on,ve)}for(ve=me+1,ze=2;15>=ve;++ve,ze<<=1){if($t+=ln<<=1,0>(ln-=We[ve]))return 0;for(;0<We[ve];--We[ve]){if(_e=new R,(on&wt)!=_t){for($e+=Ht,mt=1<<(_t=ve)-me;15>_t&&!(0>=(mt-=We[_t]));)++_t,mt<<=1;ut+=Ht=1<<(mt=_t-me),oe[de+(_t=on&wt)].g=mt+me,oe[de+_t].value=$e-de-_t}_e.g=ve-me,_e.value=Ke[Be++],M(oe,$e+(on>>me),ze,Ht,_e),on=Q(on,ve)}}return $t!=2*Je[15]-1?0:ut})(y,A,E,O,ie,re)}function R(){this.value=this.g=0}function Z(){this.value=this.g=0}function se(){this.G=d(5,R),this.H=o(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=d(po,Z)}function V(y,A,E,O){e(y!=null),e(A!=null),e(2147483648>O),y.Ca=254,y.I=0,y.b=-8,y.Ka=0,y.oa=A,y.pa=E,y.Jd=A,y.Yc=E+O,y.Zc=4<=O?E+O-4+1:E,Ve(y)}function ee(y,A){for(var E=0;0<A--;)E|=et(y,128)<<A;return E}function ae(y,A){var E=ee(y,A);return De(y)?-E:E}function Ce(y,A,E,O){var ie,re=0;for(e(y!=null),e(A!=null),e(4294967288>O),y.Sb=O,y.Ra=0,y.u=0,y.h=0,4<O&&(O=4),ie=0;ie<O;++ie)re+=A[E+ie]<<8*ie;y.Ra=re,y.bb=O,y.oa=A,y.pa=E}function xe(y){for(;8<=y.u&&y.bb<y.Sb;)y.Ra>>>=8,y.Ra+=y.oa[y.pa+y.bb]<<Mo-8>>>0,++y.bb,y.u-=8;ue(y)&&(y.h=1,y.u=0)}function J(y,A){if(e(0<=A),!y.h&&A<=ir){var E=K(y)&wa[A];return y.u+=A,xe(y),E}return y.h=1,y.u=0}function D(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function W(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function K(y){return y.Ra>>>(y.u&Mo-1)>>>0}function ue(y){return e(y.bb<=y.Sb),y.h||y.bb==y.Sb&&y.u>Mo}function Te(y,A){y.u=A,y.h=ue(y)}function Pe(y){y.u>=Da&&(e(y.u>=Da),xe(y))}function Ve(y){e(y!=null&&y.oa!=null),y.pa<y.Zc?(y.I=(y.oa[y.pa++]|y.I<<8)>>>0,y.b+=8):(e(y!=null&&y.oa!=null),y.pa<y.Yc?(y.b+=8,y.I=y.oa[y.pa++]|y.I<<8):y.Ka?y.b=0:(y.I<<=8,y.b+=8,y.Ka=1))}function De(y){return ee(y,1)}function et(y,A){var E=y.Ca;0>y.b&&Ve(y);var O=y.b,ie=E*A>>>8,re=(y.I>>>O>ie)+0;for(re?(E-=ie,y.I-=ie+1<<O>>>0):E=ie+1,O=E,ie=0;256<=O;)ie+=8,O>>=8;return O=7^ie+_i[O],y.b-=O,y.Ca=(E<<O)-1,re}function ot(y,A,E){y[A+0]=E>>24&255,y[A+1]=E>>16&255,y[A+2]=E>>8&255,y[A+3]=255&E}function at(y,A){return y[A+0]|y[A+1]<<8}function ht(y,A){return at(y,A)|y[A+2]<<16}function xt(y,A){return at(y,A)|at(y,A+2)<<16}function fe(y,A){var E=1<<A;return e(y!=null),e(0<A),y.X=o(E),y.X==null?0:(y.Mb=32-A,y.Xa=A,1)}function Nt(y,A){e(y!=null),e(A!=null),e(y.Xa==A.Xa),n(A.X,0,y.X,0,1<<A.Xa)}function zt(){this.X=[],this.Xa=this.Mb=0}function Bt(y,A,E,O){e(E!=null),e(O!=null);var ie=E[0],re=O[0];return ie==0&&(ie=(y*re+A/2)/A),re==0&&(re=(A*ie+y/2)/y),0>=ie||0>=re?0:(E[0]=ie,O[0]=re,1)}function it(y,A){return y+(1<<A)-1>>>A}function qt(y,A){return((4278255360&y)+(4278255360&A)>>>0&4278255360)+((16711935&y)+(16711935&A)>>>0&16711935)>>>0}function vt(y,A){H[A]=function(E,O,ie,re,oe,de,me){var _e;for(_e=0;_e<oe;++_e){var ze=H[y](de[me+_e-1],ie,re+_e);de[me+_e]=qt(E[O+_e],ze)}}}function Dt(){this.ud=this.hd=this.jd=0}function Ot(y,A){return((4278124286&(y^A))>>>1)+(y&A)>>>0}function sn(y){return 0<=y&&256>y?y:0>y?0:255<y?255:void 0}function kt(y,A){return sn(y+(y-A+.5>>1))}function Lt(y,A,E){return Math.abs(A-E)-Math.abs(y-E)}function Jn(y,A,E,O,ie,re,oe){for(O=re[oe-1],E=0;E<ie;++E)re[oe+E]=O=qt(y[A+E],O)}function pt(y,A,E,O,ie){var re;for(re=0;re<E;++re){var oe=y[A+re],de=oe>>8&255,me=16711935&(me=(me=16711935&oe)+((de<<16)+de));O[ie+re]=(4278255360&oe)+me>>>0}}function jt(y,A){A.jd=255&y,A.hd=y>>8&255,A.ud=y>>16&255}function Fn(y,A,E,O,ie,re){var oe;for(oe=0;oe<O;++oe){var de=A[E+oe],me=de>>>8,_e=de,ze=255&(ze=(ze=de>>>16)+((y.jd<<24>>24)*(me<<24>>24)>>>5));_e=255&(_e=(_e+=(y.hd<<24>>24)*(me<<24>>24)>>>5)+((y.ud<<24>>24)*(ze<<24>>24)>>>5)),ie[re+oe]=(4278255360&de)+(ze<<16)+_e}}function tn(y,A,E,O,ie){H[A]=function(re,oe,de,me,_e,ze,Ke,ve,Be){for(me=Ke;me<ve;++me)for(Ke=0;Ke<Be;++Ke)_e[ze++]=ie(de[O(re[oe++])])},H[y]=function(re,oe,de,me,_e,ze,Ke){var ve=8>>re.b,Be=re.Ea,$e=re.K[0],ut=re.w;if(8>ve)for(re=(1<<re.b)-1,ut=(1<<ve)-1;oe<de;++oe){var We,Je=0;for(We=0;We<Be;++We)We&re||(Je=O(me[_e++])),ze[Ke++]=ie($e[Je&ut]),Je>>=ve}else H["VP8LMapColor"+E](me,_e,$e,ut,ze,Ke,oe,de,Be)}}function zn(y,A,E,O,ie){for(E=A+E;A<E;){var re=y[A++];O[ie++]=re>>16&255,O[ie++]=re>>8&255,O[ie++]=255&re}}function Pn(y,A,E,O,ie){for(E=A+E;A<E;){var re=y[A++];O[ie++]=re>>16&255,O[ie++]=re>>8&255,O[ie++]=255&re,O[ie++]=re>>24&255}}function dn(y,A,E,O,ie){for(E=A+E;A<E;){var re=(oe=y[A++])>>16&240|oe>>12&15,oe=240&oe|oe>>28&15;O[ie++]=re,O[ie++]=oe}}function An(y,A,E,O,ie){for(E=A+E;A<E;){var re=(oe=y[A++])>>16&248|oe>>13&7,oe=oe>>5&224|oe>>3&31;O[ie++]=re,O[ie++]=oe}}function lt(y,A,E,O,ie){for(E=A+E;A<E;){var re=y[A++];O[ie++]=255&re,O[ie++]=re>>8&255,O[ie++]=re>>16&255}}function nn(y,A,E,O,ie,re){if(re==0)for(E=A+E;A<E;)ot(O,((re=y[A++])[0]>>24|re[1]>>8&65280|re[2]<<8&16711680|re[3]<<24)>>>0),ie+=32;else n(O,ie,y,A,E)}function Xt(y,A){H[A][0]=H[y+"0"],H[A][1]=H[y+"1"],H[A][2]=H[y+"2"],H[A][3]=H[y+"3"],H[A][4]=H[y+"4"],H[A][5]=H[y+"5"],H[A][6]=H[y+"6"],H[A][7]=H[y+"7"],H[A][8]=H[y+"8"],H[A][9]=H[y+"9"],H[A][10]=H[y+"10"],H[A][11]=H[y+"11"],H[A][12]=H[y+"12"],H[A][13]=H[y+"13"],H[A][14]=H[y+"0"],H[A][15]=H[y+"0"]}function Kt(y){return y==pl||y==Ac||y==Fo||y==ec}function Cn(){this.eb=[],this.size=this.A=this.fb=0}function Vi(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Vn(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Cn,this.f.kb=new Vi,this.sd=null}function bn(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Qt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Cr(y){return alert("todo:WebPSamplerProcessPlane"),y.T}function Ks(y,A){var E=y.T,O=A.ba.f.RGBA,ie=O.eb,re=O.fb+y.ka*O.A,oe=Ls[A.ba.S],de=y.y,me=y.O,_e=y.f,ze=y.N,Ke=y.ea,ve=y.W,Be=A.cc,$e=A.dc,ut=A.Mc,We=A.Nc,Je=y.ka,mt=y.ka+y.T,_t=y.U,wt=_t+1>>1;for(Je==0?oe(de,me,null,null,_e,ze,Ke,ve,_e,ze,Ke,ve,ie,re,null,null,_t):(oe(A.ec,A.fc,de,me,Be,$e,ut,We,_e,ze,Ke,ve,ie,re-O.A,ie,re,_t),++E);Je+2<mt;Je+=2)Be=_e,$e=ze,ut=Ke,We=ve,ze+=y.Rc,ve+=y.Rc,re+=2*O.A,oe(de,(me+=2*y.fa)-y.fa,de,me,Be,$e,ut,We,_e,ze,Ke,ve,ie,re-O.A,ie,re,_t);return me+=y.fa,y.j+mt<y.o?(n(A.ec,A.fc,de,me,_t),n(A.cc,A.dc,_e,ze,wt),n(A.Mc,A.Nc,Ke,ve,wt),E--):1&mt||oe(de,me,null,null,_e,ze,Ke,ve,_e,ze,Ke,ve,ie,re+O.A,null,null,_t),E}function zr(y,A,E){var O=y.F,ie=[y.J];if(O!=null){var re=y.U,oe=A.ba.S,de=oe==qc||oe==Fo;A=A.ba.f.RGBA;var me=[0],_e=y.ka;me[0]=y.T,y.Kb&&(_e==0?--me[0]:(--_e,ie[0]-=y.width),y.j+y.ka+y.T==y.o&&(me[0]=y.o-y.j-_e));var ze=A.eb;_e=A.fb+_e*A.A,y=ki(O,ie[0],y.width,re,me,ze,_e+(de?0:3),A.A),e(E==me),y&&Kt(oe)&&Pl(ze,_e,de,re,me,A.A)}return 0}function Br(y){var A=y.ma,E=A.ba.S,O=11>E,ie=E==ia||E==za||E==qc||E==El||E==12||Kt(E);if(A.memory=null,A.Ib=null,A.Jb=null,A.Nd=null,!eo(A.Oa,y,ie?11:12))return 0;if(ie&&Kt(E)&&pr(),y.da)alert("todo:use_scaling");else{if(O){if(A.Ib=Cr,y.Kb){if(E=y.U+1>>1,A.memory=o(y.U+2*E),A.memory==null)return 0;A.ec=A.memory,A.fc=0,A.cc=A.ec,A.dc=A.fc+y.U,A.Mc=A.cc,A.Nc=A.dc+E,A.Ib=Ks,pr()}}else alert("todo:EmitYUV");ie&&(A.Jb=zr,O&&jr())}if(O&&!Yr){for(y=0;256>y;++y)fs[y]=89858*(y-128)+Ta>>ys,sc[y]=-22014*(y-128)+Ta,vo[y]=-45773*(y-128),Uo[y]=113618*(y-128)+Ta>>ys;for(y=cr;y<$r;++y)A=76283*(y-16)+Ta>>ys,io[y-cr]=ss(A,255),Ho[y-cr]=ss(A+8>>4,15);Yr=1}return 1}function en(y){var A=y.ma,E=y.U,O=y.T;return e(!(1&y.ka)),0>=E||0>=O?0:(E=A.Ib(y,A),A.Jb!=null&&A.Jb(y,A,E),A.Dc+=E,1)}function Or(y){y.ma.memory=null}function ja(y,A,E,O){return J(y,8)!=47?0:(A[0]=J(y,14)+1,E[0]=J(y,14)+1,O[0]=J(y,1),J(y,3)!=0?0:!y.h)}function fa(y,A){if(4>y)return y+1;var E=y-2>>1;return(2+(1&y)<<E)+J(A,E)+1}function Ct(y,A){return 120<A?A-120:1<=(E=((E=ar[A-1])>>4)*y+(8-(15&E)))?E:1;var E}function pi(y,A,E){var O=K(E),ie=y[A+=255&O].g-8;return 0<ie&&(Te(E,E.u+8),O=K(E),A+=y[A].value,A+=O&(1<<ie)-1),Te(E,E.u+y[A].g),y[A].value}function ti(y,A,E){return E.g+=y.g,E.value+=y.value<<A>>>0,e(8>=E.g),y.g}function vs(y,A,E){var O=y.xc;return e((A=O==0?0:y.vc[y.md*(E>>O)+(A>>O)])<y.Wb),y.Ya[A]}function Ji(y,A,E,O){var ie=y.ab,re=y.c*A,oe=y.C;A=oe+A;var de=E,me=O;for(O=y.Ta,E=y.Ua;0<ie--;){var _e=y.gc[ie],ze=oe,Ke=A,ve=de,Be=me,$e=(me=O,de=E,_e.Ea);switch(e(ze<Ke),e(Ke<=_e.nc),_e.hc){case 2:ws(ve,Be,(Ke-ze)*$e,me,de);break;case 0:var ut=ze,We=Ke,Je=me,mt=de,_t=(Ht=_e).Ea;ut==0&&(Io(ve,Be,null,null,1,Je,mt),Jn(ve,Be+1,0,0,_t-1,Je,mt+1),Be+=_t,mt+=_t,++ut);for(var wt=1<<Ht.b,on=wt-1,$t=it(_t,Ht.b),ln=Ht.K,Ht=Ht.w+(ut>>Ht.b)*$t;ut<We;){var ii=ln,ts=Ht,Xn=1;for(os(ve,Be,Je,mt-_t,1,Je,mt);Xn<_t;){var Wt=(Xn&~on)+wt;Wt>_t&&(Wt=_t),(0,Zl[ii[ts++]>>8&15])(ve,Be+ +Xn,Je,mt+Xn-_t,Wt-Xn,Je,mt+Xn),Xn=Wt}Be+=_t,mt+=_t,++ut&on||(Ht+=$t)}Ke!=_e.nc&&n(me,de-$e,me,de+(Ke-ze-1)*$e,$e);break;case 1:for($e=ve,We=Be,_t=(ve=_e.Ea)-(mt=ve&~(Je=(Be=1<<_e.b)-1)),ut=it(ve,_e.b),wt=_e.K,_e=_e.w+(ze>>_e.b)*ut;ze<Ke;){for(on=wt,$t=_e,ln=new Dt,Ht=We+mt,ii=We+ve;We<Ht;)jt(on[$t++],ln),sd(ln,$e,We,Be,me,de),We+=Be,de+=Be;We<ii&&(jt(on[$t++],ln),sd(ln,$e,We,_t,me,de),We+=_t,de+=_t),++ze&Je||(_e+=ut)}break;case 3:if(ve==me&&Be==de&&0<_e.b){for(We=me,ve=$e=de+(Ke-ze)*$e-(mt=(Ke-ze)*it(_e.Ea,_e.b)),Be=me,Je=de,ut=[],mt=(_t=mt)-1;0<=mt;--mt)ut[mt]=Be[Je+mt];for(mt=_t-1;0<=mt;--mt)We[ve+mt]=ut[mt];id(_e,ze,Ke,me,$e,me,de)}else id(_e,ze,Ke,ve,Be,me,de)}de=O,me=E}me!=E&&n(O,E,de,me,re)}function Ds(y,A){var E=y.V,O=y.Ba+y.c*y.C,ie=A-y.C;if(e(A<=y.l.o),e(16>=ie),0<ie){var re=y.l,oe=y.Ta,de=y.Ua,me=re.width;if(Ji(y,ie,E,O),ie=de=[de],e((E=y.C)<(O=A)),e(re.v<re.va),O>re.o&&(O=re.o),E<re.j){var _e=re.j-E;E=re.j,ie[0]+=_e*me}if(E>=O?E=0:(ie[0]+=4*re.v,re.ka=E-re.j,re.U=re.va-re.v,re.T=O-E,E=1),E){if(de=de[0],11>(E=y.ca).S){var ze=E.f.RGBA,Ke=(O=E.S,ie=re.U,re=re.T,_e=ze.eb,ze.A),ve=re;for(ze=ze.fb+y.Ma*ze.A;0<ve--;){var Be=oe,$e=de,ut=ie,We=_e,Je=ze;switch(O){case Ed:to(Be,$e,ut,We,Je);break;case ia:dl(Be,$e,ut,We,Je);break;case pl:dl(Be,$e,ut,We,Je),Pl(We,Je,0,ut,1,0);break;case rd:qr(Be,$e,ut,We,Je);break;case za:nn(Be,$e,ut,We,Je,1);break;case Ac:nn(Be,$e,ut,We,Je,1),Pl(We,Je,0,ut,1,0);break;case qc:nn(Be,$e,ut,We,Je,0);break;case Fo:nn(Be,$e,ut,We,Je,0),Pl(We,Je,1,ut,1,0);break;case El:zo(Be,$e,ut,We,Je);break;case ec:zo(Be,$e,ut,We,Je),hs(We,Je,ut,1,0);break;case Ql:Sa(Be,$e,ut,We,Je);break;default:e(0)}de+=me,ze+=Ke}y.Ma+=re}else alert("todo:EmitRescaledRowsYUVA");e(y.Ma<=E.height)}}y.C=A,e(y.C<=y.i)}function Ti(y){var A;if(0<y.ua)return 0;for(A=0;A<y.Wb;++A){var E=y.Ya[A].G,O=y.Ya[A].H;if(0<E[1][O[1]+0].g||0<E[2][O[2]+0].g||0<E[3][O[3]+0].g)return 0}return 1}function Si(y,A,E,O,ie,re){if(y.Z!=0){var oe=y.qd,de=y.rd;for(e(Ll[y.Z]!=null);A<E;++A)Ll[y.Z](oe,de,O,ie,O,ie,re),oe=O,de=ie,ie+=re;y.qd=oe,y.rd=de}}function Tr(y,A){var E=y.l.ma,O=E.Z==0||E.Z==1?y.l.j:y.C;if(O=y.C<O?O:y.C,e(A<=y.l.o),A>O){var ie=y.l.width,re=E.ca,oe=E.tb+ie*O,de=y.V,me=y.Ba+y.c*O,_e=y.gc;e(y.ab==1),e(_e[0].hc==3),Tl(_e[0],O,A,de,me,re,oe),Si(E,O,A,re,oe,ie)}y.C=y.Ma=A}function pa(y,A,E,O,ie,re,oe){var de=y.$/O,me=y.$%O,_e=y.m,ze=y.s,Ke=E+y.$,ve=Ke;ie=E+O*ie;var Be=E+O*re,$e=280+ze.ua,ut=y.Pb?de:16777216,We=0<ze.ua?ze.Wa:null,Je=ze.wc,mt=Ke<Be?vs(ze,me,de):null;e(y.C<re),e(Be<=ie);var _t=!1;e:for(;;){for(;_t||Ke<Be;){var wt=0;if(de>=ut){var on=Ke-E;e((ut=y).Pb),ut.wd=ut.m,ut.xd=on,0<ut.s.ua&&Nt(ut.s.Wa,ut.s.vb),ut=de+Js}if(me&Je||(mt=vs(ze,me,de)),e(mt!=null),mt.Qb&&(A[Ke]=mt.qb,_t=!0),!_t)if(Pe(_e),mt.jc){wt=_e,on=A;var $t=Ke,ln=mt.pd[K(wt)&po-1];e(mt.jc),256>ln.g?(Te(wt,wt.u+ln.g),on[$t]=ln.value,wt=0):(Te(wt,wt.u+ln.g-256),e(256<=ln.value),wt=ln.value),wt==0&&(_t=!0)}else wt=pi(mt.G[0],mt.H[0],_e);if(_e.h)break;if(_t||256>wt){if(!_t)if(mt.nd)A[Ke]=(mt.qb|wt<<8)>>>0;else{if(Pe(_e),_t=pi(mt.G[1],mt.H[1],_e),Pe(_e),on=pi(mt.G[2],mt.H[2],_e),$t=pi(mt.G[3],mt.H[3],_e),_e.h)break;A[Ke]=($t<<24|_t<<16|wt<<8|on)>>>0}if(_t=!1,++Ke,++me>=O&&(me=0,++de,oe!=null&&de<=re&&!(de%16)&&oe(y,de),We!=null))for(;ve<Ke;)wt=A[ve++],We.X[(506832829*wt&4294967295)>>>We.Mb]=wt}else if(280>wt){if(wt=fa(wt-256,_e),on=pi(mt.G[4],mt.H[4],_e),Pe(_e),on=Ct(O,on=fa(on,_e)),_e.h)break;if(Ke-E<on||ie-Ke<wt)break e;for($t=0;$t<wt;++$t)A[Ke+$t]=A[Ke+$t-on];for(Ke+=wt,me+=wt;me>=O;)me-=O,++de,oe!=null&&de<=re&&!(de%16)&&oe(y,de);if(e(Ke<=ie),me&Je&&(mt=vs(ze,me,de)),We!=null)for(;ve<Ke;)wt=A[ve++],We.X[(506832829*wt&4294967295)>>>We.Mb]=wt}else{if(!(wt<$e))break e;for(_t=wt-280,e(We!=null);ve<Ke;)wt=A[ve++],We.X[(506832829*wt&4294967295)>>>We.Mb]=wt;wt=Ke,e(!(_t>>>(on=We).Xa)),A[wt]=on.X[_t],_t=!0}_t||e(_e.h==ue(_e))}if(y.Pb&&_e.h&&Ke<ie)e(y.m.h),y.a=5,y.m=y.wd,y.$=y.xd,0<y.s.ua&&Nt(y.s.vb,y.s.Wa);else{if(_e.h)break e;oe?.(y,de>re?re:de),y.a=0,y.$=Ke-E}return 1}return y.a=3,0}function qa(y){e(y!=null),y.vc=null,y.yc=null,y.Ya=null;var A=y.Wa;A!=null&&(A.X=null),y.vb=null,e(y!=null)}function Yl(){var y=new pn;return y==null?null:(y.a=0,y.xb=Qd,Xt("Predictor","VP8LPredictors"),Xt("Predictor","VP8LPredictors_C"),Xt("PredictorAdd","VP8LPredictorsAdd"),Xt("PredictorAdd","VP8LPredictorsAdd_C"),ws=pt,sd=Fn,to=zn,dl=Pn,zo=dn,Sa=An,qr=lt,H.VP8LMapColor32b=La,H.VP8LMapColor8b=Pr,y)}function Va(y,A,E,O,ie){var re=1,oe=[y],de=[A],me=O.m,_e=O.s,ze=null,Ke=0;e:for(;;){if(E)for(;re&&J(me,1);){var ve=oe,Be=de,$e=O,ut=1,We=$e.m,Je=$e.gc[$e.ab],mt=J(We,2);if($e.Oc&1<<mt)re=0;else{switch($e.Oc|=1<<mt,Je.hc=mt,Je.Ea=ve[0],Je.nc=Be[0],Je.K=[null],++$e.ab,e(4>=$e.ab),mt){case 0:case 1:Je.b=J(We,3)+2,ut=Va(it(Je.Ea,Je.b),it(Je.nc,Je.b),0,$e,Je.K),Je.K=Je.K[0];break;case 3:var _t,wt=J(We,8)+1,on=16<wt?0:4<wt?1:2<wt?2:3;if(ve[0]=it(Je.Ea,on),Je.b=on,_t=ut=Va(wt,1,0,$e,Je.K)){var $t,ln=wt,Ht=Je,ii=1<<(8>>Ht.b),ts=o(ii);if(ts==null)_t=0;else{var Xn=Ht.K[0],Wt=Ht.w;for(ts[0]=Ht.K[0][0],$t=1;$t<1*ln;++$t)ts[$t]=qt(Xn[Wt+$t],ts[$t-1]);for(;$t<4*ii;++$t)ts[$t]=0;Ht.K[0]=null,Ht.K[0]=ts,_t=1}}ut=_t;break;case 2:break;default:e(0)}re=ut}}if(oe=oe[0],de=de[0],re&&J(me,1)&&!(re=1<=(Ke=J(me,4))&&11>=Ke)){O.a=3;break e}var Mt;if(Mt=re)t:{var Ws,En,qn,ri=O,Ui=oe,Cs=de,Li=Ke,Ms=E,Kr=ri.m,Gi=ri.s,si=[null],Mi=1,Is=0,Ii=yo[Li];n:for(;;){if(Ms&&J(Kr,1)){var yr=J(Kr,3)+2,js=it(Ui,yr),mi=it(Cs,yr),Ts=js*mi;if(!Va(js,mi,0,ri,si))break n;for(si=si[0],Gi.xc=yr,Ws=0;Ws<Ts;++Ws){var Hi=si[Ws]>>8&65535;si[Ws]=Hi,Hi>=Mi&&(Mi=Hi+1)}}if(Kr.h)break n;for(En=0;5>En;++En){var er=mo[En];!En&&0<Li&&(er+=1<<Li),Is<er&&(Is=er)}var dr=d(Mi*Ii,R),ns=Mi,zi=d(ns,se);if(zi==null)var xr=null;else e(65536>=ns),xr=zi;var _s=o(Is);if(xr==null||_s==null||dr==null){ri.a=1;break n}var wn=dr;for(Ws=qn=0;Ws<Mi;++Ws){var Sn=xr[Ws],Ai=Sn.G,Zr=Sn.H,so=0,aa=1,$s=0;for(En=0;5>En;++En){er=mo[En],Ai[En]=wn,Zr[En]=qn,!En&&0<Li&&(er+=1<<Li);s:{var Il,Tc=er,zl=ri,ps=_s,Vc=wn,eu=qn,Rd=0,qo=zl.m,xh=J(qo,1);if(s(ps,0,0,Tc),xh){var _c=J(qo,1)+1,Dd=J(qo,1),Ld=J(qo,Dd==0?1:8);ps[Ld]=1,_c==2&&(ps[Ld=J(qo,8)]=1);var Dr=1}else{var Ps=o(19),kc=J(qo,4)+4;if(19<kc){zl.a=3;var wo=0;break s}for(Il=0;Il<kc;++Il)Ps[ad[Il]]=J(qo,3);var rc=void 0,gl=void 0,Bl=zl,ld=Ps,cd=Tc,Wc=ps,So=0,Jr=Bl.m,ml=8,zu=d(128,R);i:for(;T(zu,0,7,ld,19);){if(J(Jr,1)){var bh=2+2*J(Jr,3);if((rc=2+J(Jr,bh))>cd)break i}else rc=cd;for(gl=0;gl<cd&&rc--;){Pe(Jr);var Bu=zu[0+(127&K(Jr))];Te(Jr,Jr.u+Bu.g);var Nc=Bu.value;if(16>Nc)Wc[gl++]=Nc,Nc!=0&&(ml=Nc);else{var vh=Nc==16,wh=Nc-16,Ou=tc[wh],tu=J(Jr,Ba[wh])+Ou;if(gl+tu>cd)break i;for(var ac=vh?ml:0;0<tu--;)Wc[gl++]=ac}}So=1;break i}So||(Bl.a=3),Dr=So}(Dr=Dr&&!qo.h)&&(Rd=T(Vc,eu,8,ps,Tc)),Dr&&Rd!=0?wo=Rd:(zl.a=3,wo=0)}if(wo==0)break n;if(aa&&Rl[En]==1&&(aa=wn[qn].g==0),so+=wn[qn].g,qn+=wo,3>=En){var $c,nu=_s[0];for($c=1;$c<er;++$c)_s[$c]>nu&&(nu=_s[$c]);$s+=nu}}if(Sn.nd=aa,Sn.Qb=0,aa&&(Sn.qb=(Ai[3][Zr[3]+0].value<<24|Ai[1][Zr[1]+0].value<<16|Ai[2][Zr[2]+0].value)>>>0,so==0&&256>Ai[0][Zr[0]+0].value&&(Sn.Qb=1,Sn.qb+=Ai[0][Zr[0]+0].value<<8)),Sn.jc=!Sn.Qb&&6>$s,Sn.jc){var Md,Ol=Sn;for(Md=0;Md<po;++Md){var oc=Md,lc=Ol.pd[oc],iu=Ol.G[0][Ol.H[0]+oc];256<=iu.value?(lc.g=iu.g+256,lc.value=iu.value):(lc.g=0,lc.value=0,oc>>=ti(iu,8,lc),oc>>=ti(Ol.G[1][Ol.H[1]+oc],16,lc),oc>>=ti(Ol.G[2][Ol.H[2]+oc],0,lc),ti(Ol.G[3][Ol.H[3]+oc],24,lc))}}}Gi.vc=si,Gi.Wb=Mi,Gi.Ya=xr,Gi.yc=dr,Mt=1;break t}Mt=0}if(!(re=Mt)){O.a=3;break e}if(0<Ke){if(_e.ua=1<<Ke,!fe(_e.Wa,Ke)){O.a=1,re=0;break e}}else _e.ua=0;var su=O,Gc=oe,Sh=de,dd=su.s,Fl=dd.xc;if(su.c=Gc,su.i=Sh,dd.md=it(Gc,Fl),dd.wc=Fl==0?-1:(1<<Fl)-1,E){O.xb=ic;break e}if((ze=o(oe*de))==null){O.a=1,re=0;break e}re=(re=pa(O,ze,0,oe,de,de,null))&&!me.h;break e}return re?(ie!=null?ie[0]=ze:(e(ze==null),e(E)),O.$=0,E||qa(_e)):qa(_e),re}function Wa(y,A){var E=y.c*y.i,O=E+A+16*A;return e(y.c<=A),y.V=o(O),y.V==null?(y.Ta=null,y.Ua=0,y.a=1,0):(y.Ta=y.V,y.Ua=y.Ba+E+A,1)}function jo(y,A){var E=y.C,O=A-E,ie=y.V,re=y.Ba+y.c*E;for(e(A<=y.l.o);0<O;){var oe=16<O?16:O,de=y.l.ma,me=y.l.width,_e=me*oe,ze=de.ca,Ke=de.tb+me*E,ve=y.Ta,Be=y.Ua;Ji(y,oe,ie,re),qs(ve,Be,ze,Ke,_e),Si(de,E,E+oe,ze,Ke,me),O-=oe,ie+=oe*y.c,E+=oe}e(E==A),y.C=y.Ma=A}function Gn(){this.ub=this.yd=this.td=this.Rb=0}function Fr(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function xi(){this.Fb=this.Bb=this.Cb=0,this.Zb=o(4),this.Lb=o(4)}function ga(){this.Yb=(function(){var y=[];return(function A(E,O,ie){for(var re=ie[O],oe=0;oe<re&&(E.push(ie.length>O+1?[]:0),!(ie.length<O+1));oe++)A(E[oe],O+1,ie)})(y,0,[3,11]),y})()}function Rn(){this.jb=o(3),this.Wc=c([4,8],ga),this.Xc=c([4,17],ga)}function Qo(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new o(4),this.od=new o(4)}function gi(){this.ld=this.La=this.dd=this.tc=0}function ma(){this.Na=this.la=0}function Pa(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function el(){this.ad=o(384),this.Za=0,this.Ob=o(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function tl(){this.uc=this.M=this.Nb=0,this.wa=Array(new gi),this.Y=0,this.ya=Array(new el),this.aa=0,this.l=new nl}function $a(){this.y=o(16),this.f=o(8),this.ea=o(8)}function td(){this.cb=this.a=0,this.sc="",this.m=new D,this.Od=new Gn,this.Kc=new Fr,this.ed=new Qo,this.Qa=new xi,this.Ic=this.$c=this.Aa=0,this.D=new tl,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=d(8,D),this.ia=0,this.pb=d(4,Pa),this.Pa=new Rn,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new $a),this.Hd=0,this.rb=Array(new ma),this.sb=0,this.wa=Array(new gi),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new el),this.L=this.aa=0,this.gd=c([4,2],gi),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ss(y,A){return 0>y?0:y>A?A:y}function nl(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Hn(){var y=new td;return y!=null&&(y.a=0,y.sc="OK",y.cb=0,y.Xb=0,Rr||(Rr=Fs)),y}function Un(y,A,E){return y.a==0&&(y.a=A,y.sc=E,y.cb=0),0}function il(y,A,E){return 3<=E&&y[A+0]==157&&y[A+1]==1&&y[A+2]==42}function Ga(y,A){if(y==null)return 0;if(y.a=0,y.sc="OK",A==null)return Un(y,2,"null VP8Io passed to VP8GetHeaders()");var E=A.data,O=A.w,ie=A.ha;if(4>ie)return Un(y,7,"Truncated header.");var re=E[O+0]|E[O+1]<<8|E[O+2]<<16,oe=y.Od;if(oe.Rb=!(1&re),oe.td=re>>1&7,oe.yd=re>>4&1,oe.ub=re>>5,3<oe.td)return Un(y,3,"Incorrect keyframe parameters.");if(!oe.yd)return Un(y,4,"Frame not displayable.");O+=3,ie-=3;var de=y.Kc;if(oe.Rb){if(7>ie)return Un(y,7,"cannot parse picture header");if(!il(E,O,ie))return Un(y,3,"Bad code word");de.c=16383&(E[O+4]<<8|E[O+3]),de.Td=E[O+4]>>6,de.i=16383&(E[O+6]<<8|E[O+5]),de.Ud=E[O+6]>>6,O+=7,ie-=7,y.za=de.c+15>>4,y.Ub=de.i+15>>4,A.width=de.c,A.height=de.i,A.Da=0,A.j=0,A.v=0,A.va=A.width,A.o=A.height,A.da=0,A.ib=A.width,A.hb=A.height,A.U=A.width,A.T=A.height,s((re=y.Pa).jb,0,255,re.jb.length),e((re=y.Qa)!=null),re.Cb=0,re.Bb=0,re.Fb=1,s(re.Zb,0,0,re.Zb.length),s(re.Lb,0,0,re.Lb)}if(oe.ub>ie)return Un(y,7,"bad partition length");V(re=y.m,E,O,oe.ub),O+=oe.ub,ie-=oe.ub,oe.Rb&&(de.Ld=De(re),de.Kd=De(re)),de=y.Qa;var me,_e=y.Pa;if(e(re!=null),e(de!=null),de.Cb=De(re),de.Cb){if(de.Bb=De(re),De(re)){for(de.Fb=De(re),me=0;4>me;++me)de.Zb[me]=De(re)?ae(re,7):0;for(me=0;4>me;++me)de.Lb[me]=De(re)?ae(re,6):0}if(de.Bb)for(me=0;3>me;++me)_e.jb[me]=De(re)?ee(re,8):255}else de.Bb=0;if(re.Ka)return Un(y,3,"cannot parse segment header");if((de=y.ed).zd=De(re),de.Tb=ee(re,6),de.wb=ee(re,3),de.Pc=De(re),de.Pc&&De(re)){for(_e=0;4>_e;++_e)De(re)&&(de.vd[_e]=ae(re,6));for(_e=0;4>_e;++_e)De(re)&&(de.od[_e]=ae(re,6))}if(y.L=de.Tb==0?0:de.zd?1:2,re.Ka)return Un(y,3,"cannot parse filter header");var ze=ie;if(ie=me=O,O=me+ze,de=ze,y.Xb=(1<<ee(y.m,2))-1,ze<3*(_e=y.Xb))E=7;else{for(me+=3*_e,de-=3*_e,ze=0;ze<_e;++ze){var Ke=E[ie+0]|E[ie+1]<<8|E[ie+2]<<16;Ke>de&&(Ke=de),V(y.Jc[+ze],E,me,Ke),me+=Ke,de-=Ke,ie+=3}V(y.Jc[+_e],E,me,de),E=me<O?0:5}if(E!=0)return Un(y,E,"cannot parse partitions");for(E=ee(me=y.m,7),ie=De(me)?ae(me,4):0,O=De(me)?ae(me,4):0,de=De(me)?ae(me,4):0,_e=De(me)?ae(me,4):0,me=De(me)?ae(me,4):0,ze=y.Qa,Ke=0;4>Ke;++Ke){if(ze.Cb){var ve=ze.Zb[Ke];ze.Fb||(ve+=E)}else{if(0<Ke){y.pb[Ke]=y.pb[0];continue}ve=E}var Be=y.pb[Ke];Be.Sc[0]=Oa[ss(ve+ie,127)],Be.Sc[1]=xo[ss(ve+0,127)],Be.Eb[0]=2*Oa[ss(ve+O,127)],Be.Eb[1]=101581*xo[ss(ve+de,127)]>>16,8>Be.Eb[1]&&(Be.Eb[1]=8),Be.Qc[0]=Oa[ss(ve+_e,117)],Be.Qc[1]=xo[ss(ve+me,127)],Be.lc=ve+me}if(!oe.Rb)return Un(y,4,"Not a key frame.");for(De(re),oe=y.Pa,E=0;4>E;++E){for(ie=0;8>ie;++ie)for(O=0;3>O;++O)for(de=0;11>de;++de)_e=et(re,As[E][ie][O][de])?ee(re,8):Dl[E][ie][O][de],oe.Wc[E][ie].Yb[O][de]=_e;for(ie=0;17>ie;++ie)oe.Xc[E][ie]=oe.Wc[E][Ni[ie]]}return y.kc=De(re),y.kc&&(y.Bd=ee(re,8)),y.cb=1}function Fs(y,A,E,O,ie,re,oe){var de=A[ie].Yb[E];for(E=0;16>ie;++ie){if(!et(y,de[E+0]))return ie;for(;!et(y,de[E+1]);)if(de=A[++ie].Yb[0],E=0,ie==16)return 16;var me=A[ie+1].Yb;if(et(y,de[E+2])){var _e=y,ze=0;if(et(_e,(ve=de)[(Ke=E)+3]))if(et(_e,ve[Ke+6])){for(de=0,Ke=2*(ze=et(_e,ve[Ke+8]))+(ve=et(_e,ve[Ke+9+ze])),ze=0,ve=Cc[Ke];ve[de];++de)ze+=ze+et(_e,ve[de]);ze+=3+(8<<Ke)}else et(_e,ve[Ke+7])?(ze=7+2*et(_e,165),ze+=et(_e,145)):ze=5+et(_e,159);else ze=et(_e,ve[Ke+4])?3+et(_e,ve[Ke+5]):2;de=me[2]}else ze=1,de=me[1];me=oe+od[ie],0>(_e=y).b&&Ve(_e);var Ke,ve=_e.b,Be=(Ke=_e.Ca>>1)-(_e.I>>ve)>>31;--_e.b,_e.Ca+=Be,_e.Ca|=1,_e.I-=(Ke+1&Be)<<ve,re[me]=((ze^Be)-Be)*O[(0<ie)+0]}return 16}function _r(y){var A=y.rb[y.sb-1];A.la=0,A.Na=0,s(y.zc,0,0,y.zc.length),y.ja=0}function us(y,A,E,O,ie){ie=y[A+E+32*O]+(ie>>3),y[A+E+32*O]=-256&ie?0>ie?0:255:ie}function Wn(y,A,E,O,ie,re){us(y,A,0,E,O+ie),us(y,A,1,E,O+re),us(y,A,2,E,O-re),us(y,A,3,E,O-ie)}function bi(y){return(20091*y>>16)+y}function Xl(y,A,E,O){var ie,re=0,oe=o(16);for(ie=0;4>ie;++ie){var de=y[A+0]+y[A+8],me=y[A+0]-y[A+8],_e=(35468*y[A+4]>>16)-bi(y[A+12]),ze=bi(y[A+4])+(35468*y[A+12]>>16);oe[re+0]=de+ze,oe[re+1]=me+_e,oe[re+2]=me-_e,oe[re+3]=de-ze,re+=4,A++}for(ie=re=0;4>ie;++ie)de=(y=oe[re+0]+4)+oe[re+8],me=y-oe[re+8],_e=(35468*oe[re+4]>>16)-bi(oe[re+12]),us(E,O,0,0,de+(ze=bi(oe[re+4])+(35468*oe[re+12]>>16))),us(E,O,1,0,me+_e),us(E,O,2,0,me-_e),us(E,O,3,0,de-ze),re++,O+=32}function bc(y,A,E,O){var ie=y[A+0]+4,re=35468*y[A+4]>>16,oe=bi(y[A+4]),de=35468*y[A+1]>>16;Wn(E,O,0,ie+oe,y=bi(y[A+1]),de),Wn(E,O,1,ie+re,y,de),Wn(E,O,2,ie-re,y,de),Wn(E,O,3,ie-oe,y,de)}function ya(y,A,E,O,ie){Xl(y,A,E,O),ie&&Xl(y,A+16,E,O+4)}function kr(y,A,E,O){Bo(y,A+0,E,O,1),Bo(y,A+32,E,O+128,1)}function sl(y,A,E,O){var ie;for(y=y[A+0]+4,ie=0;4>ie;++ie)for(A=0;4>A;++A)us(E,O,A,ie,y)}function Ya(y,A,E,O){y[A+0]&&$i(y,A+0,E,O),y[A+16]&&$i(y,A+16,E,O+4),y[A+32]&&$i(y,A+32,E,O+128),y[A+48]&&$i(y,A+48,E,O+128+4)}function Nr(y,A,E,O){var ie,re=o(16);for(ie=0;4>ie;++ie){var oe=y[A+0+ie]+y[A+12+ie],de=y[A+4+ie]+y[A+8+ie],me=y[A+4+ie]-y[A+8+ie],_e=y[A+0+ie]-y[A+12+ie];re[0+ie]=oe+de,re[8+ie]=oe-de,re[4+ie]=_e+me,re[12+ie]=_e-me}for(ie=0;4>ie;++ie)oe=(y=re[0+4*ie]+3)+re[3+4*ie],de=re[1+4*ie]+re[2+4*ie],me=re[1+4*ie]-re[2+4*ie],_e=y-re[3+4*ie],E[O+0]=oe+de>>3,E[O+16]=_e+me>>3,E[O+32]=oe-de>>3,E[O+48]=_e-me>>3,O+=64}function na(y,A,E){var O,ie=A-32,re=ls,oe=255-y[ie-1];for(O=0;O<E;++O){var de,me=re,_e=oe+y[A-1];for(de=0;de<E;++de)y[A+de]=me[_e+y[ie+de]];A+=32}}function Rt(y,A){na(y,A,4)}function Qi(y,A){na(y,A,8)}function fr(y,A){na(y,A,16)}function Al(y,A){var E;for(E=0;16>E;++E)n(y,A+32*E,y,A-32,16)}function Xa(y,A){var E;for(E=16;0<E;--E)s(y,A,y[A-1],16),A+=32}function Ea(y,A,E){var O;for(O=0;16>O;++O)s(A,E+32*O,y,16)}function co(y,A){var E,O=16;for(E=0;16>E;++E)O+=y[A-1+32*E]+y[A+E-32];Ea(O>>5,y,A)}function rs(y,A){var E,O=8;for(E=0;16>E;++E)O+=y[A-1+32*E];Ea(O>>4,y,A)}function es(y,A){var E,O=8;for(E=0;16>E;++E)O+=y[A+E-32];Ea(O>>4,y,A)}function Po(y,A){Ea(128,y,A)}function Bn(y,A,E){return y+2*A+E+2>>2}function ni(y,A){var E,O=A-32;for(O=new Uint8Array([Bn(y[O-1],y[O+0],y[O+1]),Bn(y[O+0],y[O+1],y[O+2]),Bn(y[O+1],y[O+2],y[O+3]),Bn(y[O+2],y[O+3],y[O+4])]),E=0;4>E;++E)n(y,A+32*E,O,0,O.length)}function Tn(y,A){var E=y[A-1],O=y[A-1+32],ie=y[A-1+64],re=y[A-1+96];ot(y,A+0,16843009*Bn(y[A-1-32],E,O)),ot(y,A+32,16843009*Bn(E,O,ie)),ot(y,A+64,16843009*Bn(O,ie,re)),ot(y,A+96,16843009*Bn(ie,re,re))}function Hc(y,A){var E,O=4;for(E=0;4>E;++E)O+=y[A+E-32]+y[A-1+32*E];for(O>>=3,E=0;4>E;++E)s(y,A+32*E,O,4)}function xa(y,A){var E=y[A-1+0],O=y[A-1+32],ie=y[A-1+64],re=y[A-1-32],oe=y[A+0-32],de=y[A+1-32],me=y[A+2-32],_e=y[A+3-32];y[A+0+96]=Bn(O,ie,y[A-1+96]),y[A+1+96]=y[A+0+64]=Bn(E,O,ie),y[A+2+96]=y[A+1+64]=y[A+0+32]=Bn(re,E,O),y[A+3+96]=y[A+2+64]=y[A+1+32]=y[A+0+0]=Bn(oe,re,E),y[A+3+64]=y[A+2+32]=y[A+1+0]=Bn(de,oe,re),y[A+3+32]=y[A+2+0]=Bn(me,de,oe),y[A+3+0]=Bn(_e,me,de)}function an(y,A){var E=y[A+1-32],O=y[A+2-32],ie=y[A+3-32],re=y[A+4-32],oe=y[A+5-32],de=y[A+6-32],me=y[A+7-32];y[A+0+0]=Bn(y[A+0-32],E,O),y[A+1+0]=y[A+0+32]=Bn(E,O,ie),y[A+2+0]=y[A+1+32]=y[A+0+64]=Bn(O,ie,re),y[A+3+0]=y[A+2+32]=y[A+1+64]=y[A+0+96]=Bn(ie,re,oe),y[A+3+32]=y[A+2+64]=y[A+1+96]=Bn(re,oe,de),y[A+3+64]=y[A+2+96]=Bn(oe,de,me),y[A+3+96]=Bn(de,me,me)}function _n(y,A){var E=y[A-1+0],O=y[A-1+32],ie=y[A-1+64],re=y[A-1-32],oe=y[A+0-32],de=y[A+1-32],me=y[A+2-32],_e=y[A+3-32];y[A+0+0]=y[A+1+64]=re+oe+1>>1,y[A+1+0]=y[A+2+64]=oe+de+1>>1,y[A+2+0]=y[A+3+64]=de+me+1>>1,y[A+3+0]=me+_e+1>>1,y[A+0+96]=Bn(ie,O,E),y[A+0+64]=Bn(O,E,re),y[A+0+32]=y[A+1+96]=Bn(E,re,oe),y[A+1+32]=y[A+2+96]=Bn(re,oe,de),y[A+2+32]=y[A+3+96]=Bn(oe,de,me),y[A+3+32]=Bn(de,me,_e)}function ai(y,A){var E=y[A+0-32],O=y[A+1-32],ie=y[A+2-32],re=y[A+3-32],oe=y[A+4-32],de=y[A+5-32],me=y[A+6-32],_e=y[A+7-32];y[A+0+0]=E+O+1>>1,y[A+1+0]=y[A+0+64]=O+ie+1>>1,y[A+2+0]=y[A+1+64]=ie+re+1>>1,y[A+3+0]=y[A+2+64]=re+oe+1>>1,y[A+0+32]=Bn(E,O,ie),y[A+1+32]=y[A+0+96]=Bn(O,ie,re),y[A+2+32]=y[A+1+96]=Bn(ie,re,oe),y[A+3+32]=y[A+2+96]=Bn(re,oe,de),y[A+3+64]=Bn(oe,de,me),y[A+3+96]=Bn(de,me,_e)}function rn(y,A){var E=y[A-1+0],O=y[A-1+32],ie=y[A-1+64],re=y[A-1+96];y[A+0+0]=E+O+1>>1,y[A+2+0]=y[A+0+32]=O+ie+1>>1,y[A+2+32]=y[A+0+64]=ie+re+1>>1,y[A+1+0]=Bn(E,O,ie),y[A+3+0]=y[A+1+32]=Bn(O,ie,re),y[A+3+32]=y[A+1+64]=Bn(ie,re,re),y[A+3+64]=y[A+2+64]=y[A+0+96]=y[A+1+96]=y[A+2+96]=y[A+3+96]=re}function oi(y,A){var E=y[A-1+0],O=y[A-1+32],ie=y[A-1+64],re=y[A-1+96],oe=y[A-1-32],de=y[A+0-32],me=y[A+1-32],_e=y[A+2-32];y[A+0+0]=y[A+2+32]=E+oe+1>>1,y[A+0+32]=y[A+2+64]=O+E+1>>1,y[A+0+64]=y[A+2+96]=ie+O+1>>1,y[A+0+96]=re+ie+1>>1,y[A+3+0]=Bn(de,me,_e),y[A+2+0]=Bn(oe,de,me),y[A+1+0]=y[A+3+32]=Bn(E,oe,de),y[A+1+32]=y[A+3+64]=Bn(O,E,oe),y[A+1+64]=y[A+3+96]=Bn(ie,O,E),y[A+1+96]=Bn(re,ie,O)}function mn(y,A){var E;for(E=0;8>E;++E)n(y,A+32*E,y,A-32,8)}function Zd(y,A){var E;for(E=0;8>E;++E)s(y,A,y[A-1],8),A+=32}function Ut(y,A,E){var O;for(O=0;8>O;++O)s(A,E+32*O,y,8)}function Pi(y,A){var E,O=8;for(E=0;8>E;++E)O+=y[A+E-32]+y[A-1+32*E];Ut(O>>4,y,A)}function Zt(y,A){var E,O=4;for(E=0;8>E;++E)O+=y[A+E-32];Ut(O>>3,y,A)}function Yn(y,A){var E,O=4;for(E=0;8>E;++E)O+=y[A-1+32*E];Ut(O>>3,y,A)}function Ur(y,A){Ut(128,y,A)}function Ka(y,A,E){var O=y[A-E],ie=y[A+0],re=3*(ie-O)+Oo[1020+y[A-2*E]-y[A+E]],oe=Fi[112+(re+4>>3)];y[A-E]=ls[255+O+Fi[112+(re+3>>3)]],y[A+0]=ls[255+ie-oe]}function Zs(y,A,E,O){var ie=y[A+0],re=y[A+E];return Er[255+y[A-2*E]-y[A-E]]>O||Er[255+re-ie]>O}function rl(y,A,E,O){return 4*Er[255+y[A-E]-y[A+0]]+Er[255+y[A-2*E]-y[A+E]]<=O}function Ra(y,A,E,O,ie){var re=y[A-3*E],oe=y[A-2*E],de=y[A-E],me=y[A+0],_e=y[A+E],ze=y[A+2*E],Ke=y[A+3*E];return 4*Er[255+de-me]+Er[255+oe-_e]>O?0:Er[255+y[A-4*E]-re]<=ie&&Er[255+re-oe]<=ie&&Er[255+oe-de]<=ie&&Er[255+Ke-ze]<=ie&&Er[255+ze-_e]<=ie&&Er[255+_e-me]<=ie}function Za(y,A,E,O){var ie=2*O+1;for(O=0;16>O;++O)rl(y,A+O,E,ie)&&Ka(y,A+O,E)}function al(y,A,E,O){var ie=2*O+1;for(O=0;16>O;++O)rl(y,A+O*E,1,ie)&&Ka(y,A+O*E,1)}function vc(y,A,E,O){var ie;for(ie=3;0<ie;--ie)Za(y,A+=4*E,E,O)}function Kl(y,A,E,O){var ie;for(ie=3;0<ie;--ie)al(y,A+=4,E,O)}function Cl(y,A,E,O,ie,re,oe,de){for(re=2*re+1;0<ie--;){if(Ra(y,A,E,re,oe))if(Zs(y,A,E,de))Ka(y,A,E);else{var me=y,_e=A,ze=E,Ke=me[_e-2*ze],ve=me[_e-ze],Be=me[_e+0],$e=me[_e+ze],ut=me[_e+2*ze],We=27*(mt=Oo[1020+3*(Be-ve)+Oo[1020+Ke-$e]])+63>>7,Je=18*mt+63>>7,mt=9*mt+63>>7;me[_e-3*ze]=ls[255+me[_e-3*ze]+mt],me[_e-2*ze]=ls[255+Ke+Je],me[_e-ze]=ls[255+ve+We],me[_e+0]=ls[255+Be-We],me[_e+ze]=ls[255+$e-Je],me[_e+2*ze]=ls[255+ut-mt]}A+=O}}function Eo(y,A,E,O,ie,re,oe,de){for(re=2*re+1;0<ie--;){if(Ra(y,A,E,re,oe))if(Zs(y,A,E,de))Ka(y,A,E);else{var me=y,_e=A,ze=E,Ke=me[_e-ze],ve=me[_e+0],Be=me[_e+ze],$e=Fi[112+(4+(ut=3*(ve-Ke))>>3)],ut=Fi[112+(ut+3>>3)],We=$e+1>>1;me[_e-2*ze]=ls[255+me[_e-2*ze]+We],me[_e-ze]=ls[255+Ke+ut],me[_e+0]=ls[255+ve-$e],me[_e+ze]=ls[255+Be-We]}A+=O}}function Jd(y,A,E,O,ie,re){Cl(y,A,E,1,16,O,ie,re)}function yn(y,A,E,O,ie,re){Cl(y,A,1,E,16,O,ie,re)}function Ro(y,A,E,O,ie,re){var oe;for(oe=3;0<oe;--oe)Eo(y,A+=4*E,E,1,16,O,ie,re)}function j(y,A,E,O,ie,re){var oe;for(oe=3;0<oe;--oe)Eo(y,A+=4,1,E,16,O,ie,re)}function ne(y,A,E,O,ie,re,oe,de){Cl(y,A,ie,1,8,re,oe,de),Cl(E,O,ie,1,8,re,oe,de)}function we(y,A,E,O,ie,re,oe,de){Cl(y,A,1,ie,8,re,oe,de),Cl(E,O,1,ie,8,re,oe,de)}function Re(y,A,E,O,ie,re,oe,de){Eo(y,A+4*ie,ie,1,8,re,oe,de),Eo(E,O+4*ie,ie,1,8,re,oe,de)}function Fe(y,A,E,O,ie,re,oe,de){Eo(y,A+4,1,ie,8,re,oe,de),Eo(E,O+4,1,ie,8,re,oe,de)}function st(){this.ba=new Vn,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Qt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function yt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Gt(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function xn(){this.ua=0,this.Wa=new zt,this.vb=new zt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new se,this.yc=new R}function pn(){this.xb=this.a=0,this.l=new nl,this.ca=new Vn,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new W,this.Pb=0,this.wd=new W,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new xn,this.ab=0,this.gc=d(4,Gt),this.Oc=0}function Qn(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new nl,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function vi(y,A,E,O,ie,re,oe){for(y=y==null?0:y[A+0],A=0;A<oe;++A)ie[re+A]=y+E[O+A]&255,y=ie[re+A]}function Us(y,A,E,O,ie,re,oe){var de;if(y==null)vi(null,null,E,O,ie,re,oe);else for(de=0;de<oe;++de)ie[re+de]=y[A+de]+E[O+de]&255}function ji(y,A,E,O,ie,re,oe){if(y==null)vi(null,null,E,O,ie,re,oe);else{var de,me=y[A+0],_e=me,ze=me;for(de=0;de<oe;++de)_e=ze+(me=y[A+de])-_e,ze=E[O+de]+(-256&_e?0>_e?0:255:_e)&255,_e=me,ie[re+de]=ze}}function Wi(y,A,E,O){var ie=A.width,re=A.o;if(e(y!=null&&A!=null),0>E||0>=O||E+O>re)return null;if(!y.Cc){if(y.ga==null){var oe;if(y.ga=new Qn,(oe=y.ga==null)||(oe=A.width*A.o,e(y.Gb.length==0),y.Gb=o(oe),y.Uc=0,y.Gb==null?oe=0:(y.mb=y.Gb,y.nb=y.Uc,y.rc=null,oe=1),oe=!oe),!oe){oe=y.ga;var de=y.Fa,me=y.P,_e=y.qc,ze=y.mb,Ke=y.nb,ve=me+1,Be=_e-1,$e=oe.l;if(e(de!=null&&ze!=null&&A!=null),Ll[0]=null,Ll[1]=vi,Ll[2]=Us,Ll[3]=ji,oe.ca=ze,oe.tb=Ke,oe.c=A.width,oe.i=A.height,e(0<oe.c&&0<oe.i),1>=_e)A=0;else if(oe.$a=3&de[me+0],oe.Z=de[me+0]>>2&3,oe.Lc=de[me+0]>>4&3,me=de[me+0]>>6&3,0>oe.$a||1<oe.$a||4<=oe.Z||1<oe.Lc||me)A=0;else if($e.put=en,$e.ac=Br,$e.bc=Or,$e.ma=oe,$e.width=A.width,$e.height=A.height,$e.Da=A.Da,$e.v=A.v,$e.va=A.va,$e.j=A.j,$e.o=A.o,oe.$a)e:{e(oe.$a==1),A=Yl();t:for(;;){if(A==null){A=0;break e}if(e(oe!=null),oe.mc=A,A.c=oe.c,A.i=oe.i,A.l=oe.l,A.l.ma=oe,A.l.width=oe.c,A.l.height=oe.i,A.a=0,Ce(A.m,de,ve,Be),!Va(oe.c,oe.i,1,A,null)||(A.ab==1&&A.gc[0].hc==3&&Ti(A.s)?(oe.ic=1,de=A.c*A.i,A.Ta=null,A.Ua=0,A.V=o(de),A.Ba=0,A.V==null?(A.a=1,A=0):A=1):(oe.ic=0,A=Wa(A,oe.c)),!A))break t;A=1;break e}oe.mc=null,A=0}else A=Be>=oe.c*oe.i;oe=!A}if(oe)return null;y.ga.Lc!=1?y.Ga=0:O=re-E}e(y.ga!=null),e(E+O<=re);e:{if(A=(de=y.ga).c,re=de.l.o,de.$a==0){if(ve=y.rc,Be=y.Vc,$e=y.Fa,me=y.P+1+E*A,_e=y.mb,ze=y.nb+E*A,e(me<=y.P+y.qc),de.Z!=0)for(e(Ll[de.Z]!=null),oe=0;oe<O;++oe)Ll[de.Z](ve,Be,$e,me,_e,ze,A),ve=_e,Be=ze,ze+=A,me+=A;else for(oe=0;oe<O;++oe)n(_e,ze,$e,me,A),ve=_e,Be=ze,ze+=A,me+=A;y.rc=ve,y.Vc=Be}else{if(e(de.mc!=null),A=E+O,e((oe=de.mc)!=null),e(A<=oe.i),oe.C>=A)A=1;else if(de.ic||jr(),de.ic){de=oe.V,ve=oe.Ba,Be=oe.c;var ut=oe.i,We=($e=1,me=oe.$/Be,_e=oe.$%Be,ze=oe.m,Ke=oe.s,oe.$),Je=Be*ut,mt=Be*A,_t=Ke.wc,wt=We<mt?vs(Ke,_e,me):null;e(We<=Je),e(A<=ut),e(Ti(Ke));t:for(;;){for(;!ze.h&&We<mt;){if(_e&_t||(wt=vs(Ke,_e,me)),e(wt!=null),Pe(ze),256>(ut=pi(wt.G[0],wt.H[0],ze)))de[ve+We]=ut,++We,++_e>=Be&&(_e=0,++me<=A&&!(me%16)&&Tr(oe,me));else{if(!(280>ut)){$e=0;break t}ut=fa(ut-256,ze);var on,$t=pi(wt.G[4],wt.H[4],ze);if(Pe(ze),!(We>=($t=Ct(Be,$t=fa($t,ze)))&&Je-We>=ut)){$e=0;break t}for(on=0;on<ut;++on)de[ve+We+on]=de[ve+We+on-$t];for(We+=ut,_e+=ut;_e>=Be;)_e-=Be,++me<=A&&!(me%16)&&Tr(oe,me);We<mt&&_e&_t&&(wt=vs(Ke,_e,me))}e(ze.h==ue(ze))}Tr(oe,me>A?A:me);break t}!$e||ze.h&&We<Je?($e=0,oe.a=ze.h?5:3):oe.$=We,A=$e}else A=pa(oe,oe.V,oe.Ba,oe.c,oe.i,A,jo);if(!A){O=0;break e}}E+O>=re&&(y.Cc=1),O=1}if(!O)return null;if(y.Cc&&((O=y.ga)!=null&&(O.mc=null),y.ga=null,0<y.Ga))return alert("todo:WebPDequantizeLevels"),null}return y.nb+E*ie}function Ei(y,A,E,O,ie,re){for(;0<ie--;){var oe,de=y,me=A+(E?1:0),_e=y,ze=A+(E?0:3);for(oe=0;oe<O;++oe){var Ke=_e[ze+4*oe];Ke!=255&&(Ke*=32897,de[me+4*oe+0]=de[me+4*oe+0]*Ke>>23,de[me+4*oe+1]=de[me+4*oe+1]*Ke>>23,de[me+4*oe+2]=de[me+4*oe+2]*Ke>>23)}A+=re}}function ks(y,A,E,O,ie){for(;0<O--;){var re;for(re=0;re<E;++re){var oe=y[A+2*re+0],de=15&(_e=y[A+2*re+1]),me=4369*de,_e=(240&_e|_e>>4)*me>>16;y[A+2*re+0]=(240&oe|oe>>4)*me>>16&240|(15&oe|oe<<4)*me>>16>>4&15,y[A+2*re+1]=240&_e|de}A+=ie}}function as(y,A,E,O,ie,re,oe,de){var me,_e,ze=255;for(_e=0;_e<ie;++_e){for(me=0;me<O;++me){var Ke=y[A+me];re[oe+4*me]=Ke,ze&=Ke}A+=E,oe+=de}return ze!=255}function uo(y,A,E,O,ie){var re;for(re=0;re<ie;++re)E[O+re]=y[A+re]>>8}function jr(){Pl=Ei,hs=ks,ki=as,qs=uo}function ol(y,A,E){H[y]=function(O,ie,re,oe,de,me,_e,ze,Ke,ve,Be,$e,ut,We,Je,mt,_t){var wt,on=_t-1>>1,$t=de[me+0]|_e[ze+0]<<16,ln=Ke[ve+0]|Be[$e+0]<<16;e(O!=null);var Ht=3*$t+ln+131074>>2;for(A(O[ie+0],255&Ht,Ht>>16,ut,We),re!=null&&(Ht=3*ln+$t+131074>>2,A(re[oe+0],255&Ht,Ht>>16,Je,mt)),wt=1;wt<=on;++wt){var ii=de[me+wt]|_e[ze+wt]<<16,ts=Ke[ve+wt]|Be[$e+wt]<<16,Xn=$t+ii+ln+ts+524296,Wt=Xn+2*(ii+ln)>>3;Ht=Wt+$t>>1,$t=(Xn=Xn+2*($t+ts)>>3)+ii>>1,A(O[ie+2*wt-1],255&Ht,Ht>>16,ut,We+(2*wt-1)*E),A(O[ie+2*wt-0],255&$t,$t>>16,ut,We+(2*wt-0)*E),re!=null&&(Ht=Xn+ln>>1,$t=Wt+ts>>1,A(re[oe+2*wt-1],255&Ht,Ht>>16,Je,mt+(2*wt-1)*E),A(re[oe+2*wt+0],255&$t,$t>>16,Je,mt+(2*wt+0)*E)),$t=ii,ln=ts}1&_t||(Ht=3*$t+ln+131074>>2,A(O[ie+_t-1],255&Ht,Ht>>16,ut,We+(_t-1)*E),re!=null&&(Ht=3*ln+$t+131074>>2,A(re[oe+_t-1],255&Ht,Ht>>16,Je,mt+(_t-1)*E)))}}function pr(){Ls[Ed]=or,Ls[ia]=mr,Ls[rd]=Ml,Ls[za]=lr,Ls[qc]=Vr,Ls[El]=Ns,Ls[Ql]=Wr,Ls[pl]=mr,Ls[Ac]=lr,Ls[Fo]=Vr,Ls[ec]=Ns}function ll(y){return y&-16384?0>y?0:255:y>>Gr}function Hs(y,A){return ll((19077*y>>8)+(26149*A>>8)-14234)}function ba(y,A,E){return ll((19077*y>>8)-(6419*A>>8)-(13320*E>>8)+8708)}function gr(y,A){return ll((19077*y>>8)+(33050*A>>8)-17685)}function Ja(y,A,E,O,ie){O[ie+0]=Hs(y,E),O[ie+1]=ba(y,A,E),O[ie+2]=gr(y,A)}function li(y,A,E,O,ie){O[ie+0]=gr(y,A),O[ie+1]=ba(y,A,E),O[ie+2]=Hs(y,E)}function ho(y,A,E,O,ie){var re=ba(y,A,E);A=re<<3&224|gr(y,A)>>3,O[ie+0]=248&Hs(y,E)|re>>5,O[ie+1]=A}function wc(y,A,E,O,ie){var re=240&gr(y,A)|15;O[ie+0]=240&Hs(y,E)|ba(y,A,E)>>4,O[ie+1]=re}function nd(y,A,E,O,ie){O[ie+0]=255,Ja(y,A,E,O,ie+1)}function Qa(y,A,E,O,ie){li(y,A,E,O,ie),O[ie+3]=255}function Hr(y,A,E,O,ie){Ja(y,A,E,O,ie),O[ie+3]=255}function Do(y,A,E){H[y]=function(O,ie,re,oe,de,me,_e,ze,Ke){for(var ve=ze+(-2&Ke)*E;ze!=ve;)A(O[ie+0],re[oe+0],de[me+0],_e,ze),A(O[ie+1],re[oe+0],de[me+0],_e,ze+E),ie+=2,++oe,++me,ze+=2*E;1&Ke&&A(O[ie+0],re[oe+0],de[me+0],_e,ze)}}function Sc(y,A,E){return E==0?y==0?A==0?6:5:A==0?4:0:E}function Lo(y,A,E,O,ie){switch(y>>>30){case 3:Bo(A,E,O,ie,0);break;case 2:Aa(A,E,O,ie);break;case 1:$i(A,E,O,ie)}}function va(y,A){var E,O,ie=A.M,re=A.Nb,oe=y.oc,de=y.pc+40,me=y.oc,_e=y.pc+584,ze=y.oc,Ke=y.pc+600;for(E=0;16>E;++E)oe[de+32*E-1]=129;for(E=0;8>E;++E)me[_e+32*E-1]=129,ze[Ke+32*E-1]=129;for(0<ie?oe[de-1-32]=me[_e-1-32]=ze[Ke-1-32]=129:(s(oe,de-32-1,127,21),s(me,_e-32-1,127,9),s(ze,Ke-32-1,127,9)),O=0;O<y.za;++O){var ve=A.ya[A.aa+O];if(0<O){for(E=-1;16>E;++E)n(oe,de+32*E-4,oe,de+32*E+12,4);for(E=-1;8>E;++E)n(me,_e+32*E-4,me,_e+32*E+4,4),n(ze,Ke+32*E-4,ze,Ke+32*E+4,4)}var Be=y.Gd,$e=y.Hd+O,ut=ve.ad,We=ve.Hc;if(0<ie&&(n(oe,de-32,Be[$e].y,0,16),n(me,_e-32,Be[$e].f,0,8),n(ze,Ke-32,Be[$e].ea,0,8)),ve.Za){var Je=oe,mt=de-32+16;for(0<ie&&(O>=y.za-1?s(Je,mt,Be[$e].y[15],4):n(Je,mt,Be[$e+1].y,0,4)),E=0;4>E;E++)Je[mt+128+E]=Je[mt+256+E]=Je[mt+384+E]=Je[mt+0+E];for(E=0;16>E;++E,We<<=2)Je=oe,mt=de+Di[E],Qs[ve.Ob[E]](Je,mt),Lo(We,ut,16*+E,Je,mt)}else if(Je=Sc(O,ie,ve.Ob[0]),Fa[Je](oe,de),We!=0)for(E=0;16>E;++E,We<<=2)Lo(We,ut,16*+E,oe,de+Di[E]);for(E=ve.Gc,Je=Sc(O,ie,ve.Dd),bo[Je](me,_e),bo[Je](ze,Ke),We=ut,Je=me,mt=_e,255&(ve=0|E)&&(170&ve?go(We,256,Je,mt):Ri(We,256,Je,mt)),ve=ze,We=Ke,255&(E>>=8)&&(170&E?go(ut,320,ve,We):Ri(ut,320,ve,We)),ie<y.Ub-1&&(n(Be[$e].y,0,oe,de+480,16),n(Be[$e].f,0,me,_e+224,8),n(Be[$e].ea,0,ze,Ke+224,8)),E=8*re*y.B,Be=y.sa,$e=y.ta+16*O+16*re*y.R,ut=y.qa,ve=y.ra+8*O+E,We=y.Ha,Je=y.Ia+8*O+E,E=0;16>E;++E)n(Be,$e+E*y.R,oe,de+32*E,16);for(E=0;8>E;++E)n(ut,ve+E*y.B,me,_e+32*E,8),n(We,Je+E*y.B,ze,Ke+32*E,8)}}function nr(y,A,E,O,ie,re,oe,de,me){var _e=[0],ze=[0],Ke=0,ve=me!=null?me.kd:0,Be=me??new yt;if(y==null||12>E)return 7;Be.data=y,Be.w=A,Be.ha=E,A=[A],E=[E],Be.gb=[Be.gb];e:{var $e=A,ut=E,We=Be.gb;if(e(y!=null),e(ut!=null),e(We!=null),We[0]=0,12<=ut[0]&&!t(y,$e[0],"RIFF")){if(t(y,$e[0]+8,"WEBP")){We=3;break e}var Je=xt(y,$e[0]+4);if(12>Je||4294967286<Je){We=3;break e}if(ve&&Je>ut[0]-8){We=7;break e}We[0]=Je,$e[0]+=12,ut[0]-=12}We=0}if(We!=0)return We;for(Je=0<Be.gb[0],E=E[0];;){e:{var mt=y;ut=A,We=E;var _t=_e,wt=ze,on=$e=[0];if((Ht=Ke=[Ke])[0]=0,8>We[0])We=7;else{if(!t(mt,ut[0],"VP8X")){if(xt(mt,ut[0]+4)!=10){We=3;break e}if(18>We[0]){We=7;break e}var $t=xt(mt,ut[0]+8),ln=1+ht(mt,ut[0]+12);if(2147483648<=ln*(mt=1+ht(mt,ut[0]+15))){We=3;break e}on!=null&&(on[0]=$t),_t!=null&&(_t[0]=ln),wt!=null&&(wt[0]=mt),ut[0]+=18,We[0]-=18,Ht[0]=1}We=0}}if(Ke=Ke[0],$e=$e[0],We!=0)return We;if(ut=!!(2&$e),!Je&&Ke)return 3;if(re!=null&&(re[0]=!!(16&$e)),oe!=null&&(oe[0]=ut),de!=null&&(de[0]=0),oe=_e[0],$e=ze[0],Ke&&ut&&me==null){We=0;break}if(4>E){We=7;break}if(Je&&Ke||!Je&&!Ke&&!t(y,A[0],"ALPH")){E=[E],Be.na=[Be.na],Be.P=[Be.P],Be.Sa=[Be.Sa];e:{$t=y,We=A,Je=E;var Ht=Be.gb;_t=Be.na,wt=Be.P,on=Be.Sa,ln=22,e($t!=null),e(Je!=null),mt=We[0];var ii=Je[0];for(e(_t!=null),e(on!=null),_t[0]=null,wt[0]=null,on[0]=0;;){if(We[0]=mt,Je[0]=ii,8>ii){We=7;break e}var ts=xt($t,mt+4);if(4294967286<ts){We=3;break e}var Xn=8+ts+1&-2;if(ln+=Xn,0<Ht&&ln>Ht){We=3;break e}if(!t($t,mt,"VP8 ")||!t($t,mt,"VP8L")){We=0;break e}if(ii[0]<Xn){We=7;break e}t($t,mt,"ALPH")||(_t[0]=$t,wt[0]=mt+8,on[0]=ts),mt+=Xn,ii-=Xn}}if(E=E[0],Be.na=Be.na[0],Be.P=Be.P[0],Be.Sa=Be.Sa[0],We!=0)break}E=[E],Be.Ja=[Be.Ja],Be.xa=[Be.xa];e:if(Ht=y,We=A,Je=E,_t=Be.gb[0],wt=Be.Ja,on=Be.xa,$t=We[0],mt=!t(Ht,$t,"VP8 "),ln=!t(Ht,$t,"VP8L"),e(Ht!=null),e(Je!=null),e(wt!=null),e(on!=null),8>Je[0])We=7;else{if(mt||ln){if(Ht=xt(Ht,$t+4),12<=_t&&Ht>_t-12){We=3;break e}if(ve&&Ht>Je[0]-8){We=7;break e}wt[0]=Ht,We[0]+=8,Je[0]-=8,on[0]=ln}else on[0]=5<=Je[0]&&Ht[$t+0]==47&&!(Ht[$t+4]>>5),wt[0]=Je[0];We=0}if(E=E[0],Be.Ja=Be.Ja[0],Be.xa=Be.xa[0],A=A[0],We!=0)break;if(4294967286<Be.Ja)return 3;if(de==null||ut||(de[0]=Be.xa?2:1),oe=[oe],$e=[$e],Be.xa){if(5>E){We=7;break}de=oe,ve=$e,ut=re,y==null||5>E?y=0:5<=E&&y[A+0]==47&&!(y[A+4]>>5)?(Je=[0],Ht=[0],_t=[0],Ce(wt=new W,y,A,E),ja(wt,Je,Ht,_t)?(de!=null&&(de[0]=Je[0]),ve!=null&&(ve[0]=Ht[0]),ut!=null&&(ut[0]=_t[0]),y=1):y=0):y=0}else{if(10>E){We=7;break}de=$e,y==null||10>E||!il(y,A+3,E-3)?y=0:(ve=y[A+0]|y[A+1]<<8|y[A+2]<<16,ut=16383&(y[A+7]<<8|y[A+6]),y=16383&(y[A+9]<<8|y[A+8]),1&ve||3<(ve>>1&7)||!(ve>>4&1)||ve>>5>=Be.Ja||!ut||!y?y=0:(oe&&(oe[0]=ut),de&&(de[0]=y),y=1))}if(!y||(oe=oe[0],$e=$e[0],Ke&&(_e[0]!=oe||ze[0]!=$e)))return 3;me!=null&&(me[0]=Be,me.offset=A-me.w,e(4294967286>A-me.w),e(me.offset==me.ha-E));break}return We==0||We==7&&Ke&&me==null?(re!=null&&(re[0]|=Be.na!=null&&0<Be.na.length),O!=null&&(O[0]=oe),ie!=null&&(ie[0]=$e),0):We}function eo(y,A,E){var O=A.width,ie=A.height,re=0,oe=0,de=O,me=ie;if(A.Da=y!=null&&0<y.Da,A.Da&&(de=y.cd,me=y.bd,re=y.v,oe=y.j,11>E||(re&=-2,oe&=-2),0>re||0>oe||0>=de||0>=me||re+de>O||oe+me>ie))return 0;if(A.v=re,A.j=oe,A.va=re+de,A.o=oe+me,A.U=de,A.T=me,A.da=y!=null&&0<y.da,A.da){if(!Bt(de,me,E=[y.ib],re=[y.hb]))return 0;A.ib=E[0],A.hb=re[0]}return A.ob=y!=null&&y.ob,A.Kb=y==null||!y.Sd,A.da&&(A.ob=A.ib<3*O/4&&A.hb<3*ie/4,A.Kb=0),1}function cl(y){if(y==null)return 2;if(11>y.S){var A=y.f.RGBA;A.fb+=(y.height-1)*A.A,A.A=-A.A}else A=y.f.kb,y=y.height,A.O+=(y-1)*A.fa,A.fa=-A.fa,A.N+=(y-1>>1)*A.Ab,A.Ab=-A.Ab,A.W+=(y-1>>1)*A.Db,A.Db=-A.Db,A.F!=null&&(A.J+=(y-1)*A.lb,A.lb=-A.lb);return 0}function fo(y,A,E,O){if(O==null||0>=y||0>=A)return 2;if(E!=null){if(E.Da){var ie=E.cd,re=E.bd,oe=-2&E.v,de=-2&E.j;if(0>oe||0>de||0>=ie||0>=re||oe+ie>y||de+re>A)return 2;y=ie,A=re}if(E.da){if(!Bt(y,A,ie=[E.ib],re=[E.hb]))return 2;y=ie[0],A=re[0]}}O.width=y,O.height=A;e:{var me=O.width,_e=O.height;if(y=O.S,0>=me||0>=_e||!(y>=Ed&&13>y))y=2;else{if(0>=O.Rd&&O.sd==null){oe=re=ie=A=0;var ze=(de=me*Dn[y])*_e;if(11>y||(re=(_e+1)/2*(A=(me+1)/2),y==12&&(oe=(ie=me)*_e)),(_e=o(ze+2*re+oe))==null){y=1;break e}O.sd=_e,11>y?((me=O.f.RGBA).eb=_e,me.fb=0,me.A=de,me.size=ze):((me=O.f.kb).y=_e,me.O=0,me.fa=de,me.Fd=ze,me.f=_e,me.N=0+ze,me.Ab=A,me.Cd=re,me.ea=_e,me.W=0+ze+re,me.Db=A,me.Ed=re,y==12&&(me.F=_e,me.J=0+ze+2*re),me.Tc=oe,me.lb=ie)}if(A=1,ie=O.S,re=O.width,oe=O.height,ie>=Ed&&13>ie)if(11>ie)y=O.f.RGBA,A&=(de=Math.abs(y.A))*(oe-1)+re<=y.size,A&=de>=re*Dn[ie],A&=y.eb!=null;else{y=O.f.kb,de=(re+1)/2,ze=(oe+1)/2,me=Math.abs(y.fa),_e=Math.abs(y.Ab);var Ke=Math.abs(y.Db),ve=Math.abs(y.lb),Be=ve*(oe-1)+re;A&=me*(oe-1)+re<=y.Fd,A&=_e*(ze-1)+de<=y.Cd,A=(A&=Ke*(ze-1)+de<=y.Ed)&me>=re&_e>=de&Ke>=de,A&=y.y!=null,A&=y.f!=null,A&=y.ea!=null,ie==12&&(A&=ve>=re,A&=Be<=y.Tc,A&=y.F!=null)}else A=0;y=A?0:2}}return y!=0||E!=null&&E.fd&&(y=cl(O)),y}var po=64,wa=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ir=24,Mo=32,Da=8,_i=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];vt("Predictor0","PredictorAdd0"),H.Predictor0=function(){return 4278190080},H.Predictor1=function(y){return y},H.Predictor2=function(y,A,E){return A[E+0]},H.Predictor3=function(y,A,E){return A[E+1]},H.Predictor4=function(y,A,E){return A[E-1]},H.Predictor5=function(y,A,E){return Ot(Ot(y,A[E+1]),A[E+0])},H.Predictor6=function(y,A,E){return Ot(y,A[E-1])},H.Predictor7=function(y,A,E){return Ot(y,A[E+0])},H.Predictor8=function(y,A,E){return Ot(A[E-1],A[E+0])},H.Predictor9=function(y,A,E){return Ot(A[E+0],A[E+1])},H.Predictor10=function(y,A,E){return Ot(Ot(y,A[E-1]),Ot(A[E+0],A[E+1]))},H.Predictor11=function(y,A,E){var O=A[E+0];return 0>=Lt(O>>24&255,y>>24&255,(A=A[E-1])>>24&255)+Lt(O>>16&255,y>>16&255,A>>16&255)+Lt(O>>8&255,y>>8&255,A>>8&255)+Lt(255&O,255&y,255&A)?O:y},H.Predictor12=function(y,A,E){var O=A[E+0];return(sn((y>>24&255)+(O>>24&255)-((A=A[E-1])>>24&255))<<24|sn((y>>16&255)+(O>>16&255)-(A>>16&255))<<16|sn((y>>8&255)+(O>>8&255)-(A>>8&255))<<8|sn((255&y)+(255&O)-(255&A)))>>>0},H.Predictor13=function(y,A,E){var O=A[E-1];return(kt((y=Ot(y,A[E+0]))>>24&255,O>>24&255)<<24|kt(y>>16&255,O>>16&255)<<16|kt(y>>8&255,O>>8&255)<<8|kt(255&y,255&O))>>>0};var Io=H.PredictorAdd0;H.PredictorAdd1=Jn,vt("Predictor2","PredictorAdd2"),vt("Predictor3","PredictorAdd3"),vt("Predictor4","PredictorAdd4"),vt("Predictor5","PredictorAdd5"),vt("Predictor6","PredictorAdd6"),vt("Predictor7","PredictorAdd7"),vt("Predictor8","PredictorAdd8"),vt("Predictor9","PredictorAdd9"),vt("Predictor10","PredictorAdd10"),vt("Predictor11","PredictorAdd11"),vt("Predictor12","PredictorAdd12"),vt("Predictor13","PredictorAdd13");var os=H.PredictorAdd2;tn("ColorIndexInverseTransform","MapARGB","32b",function(y){return y>>8&255},function(y){return y}),tn("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(y){return y},function(y){return y>>8&255});var ws,id=H.ColorIndexInverseTransform,La=H.MapARGB,Tl=H.VP8LColorIndexInverseTransformAlpha,Pr=H.MapAlpha,Zl=H.VP8LPredictorsAdd=[];Zl.length=16,(H.VP8LPredictors=[]).length=16,(H.VP8LPredictorsAdd_C=[]).length=16,(H.VP8LPredictors_C=[]).length=16;var sd,to,dl,zo,Sa,qr,Ma,Bo,Aa,go,$i,Ri,Ss,sr,_l,ul,rr,Ca,kl,hl,Nl,Jl,jl,no,Pl,hs,ki,qs,Vs=o(511),Ia=o(2041),jd=o(225),fl=o(767),Pd=0,Oo=Ia,Fi=jd,ls=fl,Er=Vs,Ed=0,ia=1,rd=2,za=3,qc=4,El=5,Ql=6,pl=7,Ac=8,Fo=9,ec=10,Ba=[2,3,7],tc=[3,3,11],mo=[280,256,256,256,40],Rl=[0,1,1,1,0],ad=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],ar=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],yo=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Js=8,Oa=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],xo=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Rr=null,Cc=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],od=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],nc=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Dl=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],sa=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],As=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Ni=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Fa=[],Qs=[],bo=[],ic=1,Qd=2,Ll=[],Ls=[];ol("UpsampleRgbLinePair",Ja,3),ol("UpsampleBgrLinePair",li,3),ol("UpsampleRgbaLinePair",Hr,4),ol("UpsampleBgraLinePair",Qa,4),ol("UpsampleArgbLinePair",nd,4),ol("UpsampleRgba4444LinePair",wc,2),ol("UpsampleRgb565LinePair",ho,2);var or=H.UpsampleRgbLinePair,Ml=H.UpsampleBgrLinePair,mr=H.UpsampleRgbaLinePair,lr=H.UpsampleBgraLinePair,Vr=H.UpsampleArgbLinePair,Ns=H.UpsampleRgba4444LinePair,Wr=H.UpsampleRgb565LinePair,ys=16,Ta=1<<ys-1,cr=-227,$r=482,Gr=6,Yr=0,fs=o(256),Uo=o(256),vo=o(256),sc=o(256),io=o($r-cr),Ho=o($r-cr);Do("YuvToRgbRow",Ja,3),Do("YuvToBgrRow",li,3),Do("YuvToRgbaRow",Hr,4),Do("YuvToBgraRow",Qa,4),Do("YuvToArgbRow",nd,4),Do("YuvToRgba4444Row",wc,2),Do("YuvToRgb565Row",ho,2);var Di=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],ra=[0,2,8],_a=[8,7,6,4,4,2,2,2,1,1,1,1],Xr=1;this.WebPDecodeRGBA=function(y,A,E,O,ie){var re=ia,oe=new st,de=new Vn;oe.ba=de,de.S=re,de.width=[de.width],de.height=[de.height];var me=de.width,_e=de.height,ze=new bn;if(ze==null||y==null)var Ke=2;else e(ze!=null),Ke=nr(y,A,E,ze.width,ze.height,ze.Pd,ze.Qd,ze.format,null);if(Ke!=0?me=0:(me!=null&&(me[0]=ze.width[0]),_e!=null&&(_e[0]=ze.height[0]),me=1),me){de.width=de.width[0],de.height=de.height[0],O!=null&&(O[0]=de.width),ie!=null&&(ie[0]=de.height);e:{if(O=new nl,(ie=new yt).data=y,ie.w=A,ie.ha=E,ie.kd=1,A=[0],e(ie!=null),((y=nr(ie.data,ie.w,ie.ha,null,null,null,A,null,ie))==0||y==7)&&A[0]&&(y=4),(A=y)==0){if(e(oe!=null),O.data=ie.data,O.w=ie.w+ie.offset,O.ha=ie.ha-ie.offset,O.put=en,O.ac=Br,O.bc=Or,O.ma=oe,ie.xa){if((y=Yl())==null){oe=1;break e}if((function(ve,Be){var $e=[0],ut=[0],We=[0];t:for(;;){if(ve==null)return 0;if(Be==null)return ve.a=2,0;if(ve.l=Be,ve.a=0,Ce(ve.m,Be.data,Be.w,Be.ha),!ja(ve.m,$e,ut,We)){ve.a=3;break t}if(ve.xb=Qd,Be.width=$e[0],Be.height=ut[0],!Va($e[0],ut[0],1,ve,null))break t;return 1}return e(ve.a!=0),0})(y,O)){if(O=(A=fo(O.width,O.height,oe.Oa,oe.ba))==0){t:{O=y;n:for(;;){if(O==null){O=0;break t}if(e(O.s.yc!=null),e(O.s.Ya!=null),e(0<O.s.Wb),e((E=O.l)!=null),e((ie=E.ma)!=null),O.xb!=0){if(O.ca=ie.ba,O.tb=ie.tb,e(O.ca!=null),!eo(ie.Oa,E,za)){O.a=2;break n}if(!Wa(O,E.width)||E.da)break n;if((E.da||Kt(O.ca.S))&&jr(),11>O.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),O.ca.f.kb.F!=null&&jr()),O.Pb&&0<O.s.ua&&O.s.vb.X==null&&!fe(O.s.vb,O.s.Wa.Xa)){O.a=1;break n}O.xb=0}if(!pa(O,O.V,O.Ba,O.c,O.i,E.o,Ds))break n;ie.Dc=O.Ma,O=1;break t}e(O.a!=0),O=0}O=!O}O&&(A=y.a)}else A=y.a}else{if((y=new Hn)==null){oe=1;break e}if(y.Fa=ie.na,y.P=ie.P,y.qc=ie.Sa,Ga(y,O)){if((A=fo(O.width,O.height,oe.Oa,oe.ba))==0){if(y.Aa=0,E=oe.Oa,e((ie=y)!=null),E!=null){if(0<(me=0>(me=E.Md)?0:100<me?255:255*me/100)){for(_e=ze=0;4>_e;++_e)12>(Ke=ie.pb[_e]).lc&&(Ke.ia=me*_a[0>Ke.lc?0:Ke.lc]>>3),ze|=Ke.ia;ze&&(alert("todo:VP8InitRandom"),ie.ia=1)}ie.Ga=E.Id,100<ie.Ga?ie.Ga=100:0>ie.Ga&&(ie.Ga=0)}(function(ve,Be){if(ve==null)return 0;if(Be==null)return Un(ve,2,"NULL VP8Io parameter in VP8Decode().");if(!ve.cb&&!Ga(ve,Be))return 0;if(e(ve.cb),Be.ac==null||Be.ac(Be)){Be.ob&&(ve.L=0);var $e=ra[ve.L];if(ve.L==2?(ve.yb=0,ve.zb=0):(ve.yb=Be.v-$e>>4,ve.zb=Be.j-$e>>4,0>ve.yb&&(ve.yb=0),0>ve.zb&&(ve.zb=0)),ve.Va=Be.o+15+$e>>4,ve.Hb=Be.va+15+$e>>4,ve.Hb>ve.za&&(ve.Hb=ve.za),ve.Va>ve.Ub&&(ve.Va=ve.Ub),0<ve.L){var ut=ve.ed;for($e=0;4>$e;++$e){var We;if(ve.Qa.Cb){var Je=ve.Qa.Lb[$e];ve.Qa.Fb||(Je+=ut.Tb)}else Je=ut.Tb;for(We=0;1>=We;++We){var mt=ve.gd[$e][We],_t=Je;if(ut.Pc&&(_t+=ut.vd[0],We&&(_t+=ut.od[0])),0<(_t=0>_t?0:63<_t?63:_t)){var wt=_t;0<ut.wb&&(wt=4<ut.wb?wt>>2:wt>>1)>9-ut.wb&&(wt=9-ut.wb),1>wt&&(wt=1),mt.dd=wt,mt.tc=2*_t+wt,mt.ld=40<=_t?2:15<=_t?1:0}else mt.tc=0;mt.La=We}}}$e=0}else Un(ve,6,"Frame setup failed"),$e=ve.a;if($e=$e==0){if($e){ve.$c=0,0<ve.Aa||(ve.Ic=Xr);t:{$e=ve.Ic,ut=4*(wt=ve.za);var on=32*wt,$t=wt+1,ln=0<ve.L?wt*(0<ve.Aa?2:1):0,Ht=(ve.Aa==2?2:1)*wt;if((mt=ut+832+(We=3*(16*$e+ra[ve.L])/2*on)+(Je=ve.Fa!=null&&0<ve.Fa.length?ve.Kc.c*ve.Kc.i:0))!=mt)$e=0;else{if(mt>ve.Vb){if(ve.Vb=0,ve.Ec=o(mt),ve.Fc=0,ve.Ec==null){$e=Un(ve,1,"no memory during frame initialization.");break t}ve.Vb=mt}mt=ve.Ec,_t=ve.Fc,ve.Ac=mt,ve.Bc=_t,_t+=ut,ve.Gd=d(on,$a),ve.Hd=0,ve.rb=d($t+1,ma),ve.sb=1,ve.wa=ln?d(ln,gi):null,ve.Y=0,ve.D.Nb=0,ve.D.wa=ve.wa,ve.D.Y=ve.Y,0<ve.Aa&&(ve.D.Y+=wt),e(!0),ve.oc=mt,ve.pc=_t,_t+=832,ve.ya=d(Ht,el),ve.aa=0,ve.D.ya=ve.ya,ve.D.aa=ve.aa,ve.Aa==2&&(ve.D.aa+=wt),ve.R=16*wt,ve.B=8*wt,wt=(on=ra[ve.L])*ve.R,on=on/2*ve.B,ve.sa=mt,ve.ta=_t+wt,ve.qa=ve.sa,ve.ra=ve.ta+16*$e*ve.R+on,ve.Ha=ve.qa,ve.Ia=ve.ra+8*$e*ve.B+on,ve.$c=0,_t+=We,ve.mb=Je?mt:null,ve.nb=Je?_t:null,e(_t+Je<=ve.Fc+ve.Vb),_r(ve),s(ve.Ac,ve.Bc,0,ut),$e=1}}if($e){if(Be.ka=0,Be.y=ve.sa,Be.O=ve.ta,Be.f=ve.qa,Be.N=ve.ra,Be.ea=ve.Ha,Be.Vd=ve.Ia,Be.fa=ve.R,Be.Rc=ve.B,Be.F=null,Be.J=0,!Pd){for($e=-255;255>=$e;++$e)Vs[255+$e]=0>$e?-$e:$e;for($e=-1020;1020>=$e;++$e)Ia[1020+$e]=-128>$e?-128:127<$e?127:$e;for($e=-112;112>=$e;++$e)jd[112+$e]=-16>$e?-16:15<$e?15:$e;for($e=-255;510>=$e;++$e)fl[255+$e]=0>$e?0:255<$e?255:$e;Pd=1}Ma=Nr,Bo=ya,go=kr,$i=sl,Ri=Ya,Aa=bc,Ss=Jd,sr=yn,_l=ne,ul=we,rr=Ro,Ca=j,kl=Re,hl=Fe,Nl=Za,Jl=al,jl=vc,no=Kl,Qs[0]=Hc,Qs[1]=Rt,Qs[2]=ni,Qs[3]=Tn,Qs[4]=xa,Qs[5]=_n,Qs[6]=an,Qs[7]=ai,Qs[8]=oi,Qs[9]=rn,Fa[0]=co,Fa[1]=fr,Fa[2]=Al,Fa[3]=Xa,Fa[4]=rs,Fa[5]=es,Fa[6]=Po,bo[0]=Pi,bo[1]=Qi,bo[2]=mn,bo[3]=Zd,bo[4]=Yn,bo[5]=Zt,bo[6]=Ur,$e=1}else $e=0}$e&&($e=(function(ii,ts){for(ii.M=0;ii.M<ii.Va;++ii.M){var Xn,Wt=ii.Jc[ii.M&ii.Xb],Mt=ii.m,Ws=ii;for(Xn=0;Xn<Ws.za;++Xn){var En=Mt,qn=Ws,ri=qn.Ac,Ui=qn.Bc+4*Xn,Cs=qn.zc,Li=qn.ya[qn.aa+Xn];if(qn.Qa.Bb?Li.$b=et(En,qn.Pa.jb[0])?2+et(En,qn.Pa.jb[2]):et(En,qn.Pa.jb[1]):Li.$b=0,qn.kc&&(Li.Ad=et(En,qn.Bd)),Li.Za=!et(En,145)+0,Li.Za){var Ms=Li.Ob,Kr=0;for(qn=0;4>qn;++qn){var Gi,si=Cs[0+qn];for(Gi=0;4>Gi;++Gi){si=sa[ri[Ui+Gi]][si];for(var Mi=nc[et(En,si[0])];0<Mi;)Mi=nc[2*Mi+et(En,si[Mi])];si=-Mi,ri[Ui+Gi]=si}n(Ms,Kr,ri,Ui,4),Kr+=4,Cs[0+qn]=si}}else si=et(En,156)?et(En,128)?1:3:et(En,163)?2:0,Li.Ob[0]=si,s(ri,Ui,si,4),s(Cs,0,si,4);Li.Dd=et(En,142)?et(En,114)?et(En,183)?1:3:2:0}if(Ws.m.Ka)return Un(ii,7,"Premature end-of-partition0 encountered.");for(;ii.ja<ii.za;++ii.ja){if(Ws=Wt,En=(Mt=ii).rb[Mt.sb-1],ri=Mt.rb[Mt.sb+Mt.ja],Xn=Mt.ya[Mt.aa+Mt.ja],Ui=Mt.kc?Xn.Ad:0)En.la=ri.la=0,Xn.Za||(En.Na=ri.Na=0),Xn.Hc=0,Xn.Gc=0,Xn.ia=0;else{var Is,Ii;if(En=ri,ri=Ws,Ui=Mt.Pa.Xc,Cs=Mt.ya[Mt.aa+Mt.ja],Li=Mt.pb[Cs.$b],qn=Cs.ad,Ms=0,Kr=Mt.rb[Mt.sb-1],si=Gi=0,s(qn,Ms,0,384),Cs.Za)var yr=0,js=Ui[3];else{Mi=o(16);var mi=En.Na+Kr.Na;if(mi=Rr(ri,Ui[1],mi,Li.Eb,0,Mi,0),En.Na=Kr.Na=(0<mi)+0,1<mi)Ma(Mi,0,qn,Ms);else{var Ts=Mi[0]+3>>3;for(Mi=0;256>Mi;Mi+=16)qn[Ms+Mi]=Ts}yr=1,js=Ui[0]}var Hi=15&En.la,er=15&Kr.la;for(Mi=0;4>Mi;++Mi){var dr=1&er;for(Ts=Ii=0;4>Ts;++Ts)Hi=Hi>>1|(dr=(mi=Rr(ri,js,mi=dr+(1&Hi),Li.Sc,yr,qn,Ms))>yr)<<7,Ii=Ii<<2|(3<mi?3:1<mi?2:qn[Ms+0]!=0),Ms+=16;Hi>>=4,er=er>>1|dr<<7,Gi=(Gi<<8|Ii)>>>0}for(js=Hi,yr=er>>4,Is=0;4>Is;Is+=2){for(Ii=0,Hi=En.la>>4+Is,er=Kr.la>>4+Is,Mi=0;2>Mi;++Mi){for(dr=1&er,Ts=0;2>Ts;++Ts)mi=dr+(1&Hi),Hi=Hi>>1|(dr=0<(mi=Rr(ri,Ui[2],mi,Li.Qc,0,qn,Ms)))<<3,Ii=Ii<<2|(3<mi?3:1<mi?2:qn[Ms+0]!=0),Ms+=16;Hi>>=2,er=er>>1|dr<<5}si|=Ii<<4*Is,js|=Hi<<4<<Is,yr|=(240&er)<<Is}En.la=js,Kr.la=yr,Cs.Hc=Gi,Cs.Gc=si,Cs.ia=43690&si?0:Li.ia,Ui=!(Gi|si)}if(0<Mt.L&&(Mt.wa[Mt.Y+Mt.ja]=Mt.gd[Xn.$b][Xn.Za],Mt.wa[Mt.Y+Mt.ja].La|=!Ui),Ws.Ka)return Un(ii,7,"Premature end-of-file encountered.")}if(_r(ii),Mt=ts,Ws=1,Xn=(Wt=ii).D,En=0<Wt.L&&Wt.M>=Wt.zb&&Wt.M<=Wt.Va,Wt.Aa==0)t:{if(Xn.M=Wt.M,Xn.uc=En,va(Wt,Xn),Ws=1,Xn=(Ii=Wt.D).Nb,En=(si=ra[Wt.L])*Wt.R,ri=si/2*Wt.B,Mi=16*Xn*Wt.R,Ts=8*Xn*Wt.B,Ui=Wt.sa,Cs=Wt.ta-En+Mi,Li=Wt.qa,qn=Wt.ra-ri+Ts,Ms=Wt.Ha,Kr=Wt.Ia-ri+Ts,er=(Hi=Ii.M)==0,Gi=Hi>=Wt.Va-1,Wt.Aa==2&&va(Wt,Ii),Ii.uc)for(dr=(mi=Wt).D.M,e(mi.D.uc),Ii=mi.yb;Ii<mi.Hb;++Ii){yr=Ii,js=dr;var ns=(zi=($s=mi).D).Nb;Is=$s.R;var zi=zi.wa[zi.Y+yr],xr=$s.sa,_s=$s.ta+16*ns*Is+16*yr,wn=zi.dd,Sn=zi.tc;if(Sn!=0)if(e(3<=Sn),$s.L==1)0<yr&&Jl(xr,_s,Is,Sn+4),zi.La&&no(xr,_s,Is,Sn),0<js&&Nl(xr,_s,Is,Sn+4),zi.La&&jl(xr,_s,Is,Sn);else{var Ai=$s.B,Zr=$s.qa,so=$s.ra+8*ns*Ai+8*yr,aa=$s.Ha,$s=$s.Ia+8*ns*Ai+8*yr;ns=zi.ld,0<yr&&(sr(xr,_s,Is,Sn+4,wn,ns),ul(Zr,so,aa,$s,Ai,Sn+4,wn,ns)),zi.La&&(Ca(xr,_s,Is,Sn,wn,ns),hl(Zr,so,aa,$s,Ai,Sn,wn,ns)),0<js&&(Ss(xr,_s,Is,Sn+4,wn,ns),_l(Zr,so,aa,$s,Ai,Sn+4,wn,ns)),zi.La&&(rr(xr,_s,Is,Sn,wn,ns),kl(Zr,so,aa,$s,Ai,Sn,wn,ns))}}if(Wt.ia&&alert("todo:DitherRow"),Mt.put!=null){if(Ii=16*Hi,Hi=16*(Hi+1),er?(Mt.y=Wt.sa,Mt.O=Wt.ta+Mi,Mt.f=Wt.qa,Mt.N=Wt.ra+Ts,Mt.ea=Wt.Ha,Mt.W=Wt.Ia+Ts):(Ii-=si,Mt.y=Ui,Mt.O=Cs,Mt.f=Li,Mt.N=qn,Mt.ea=Ms,Mt.W=Kr),Gi||(Hi-=si),Hi>Mt.o&&(Hi=Mt.o),Mt.F=null,Mt.J=null,Wt.Fa!=null&&0<Wt.Fa.length&&Ii<Hi&&(Mt.J=Wi(Wt,Mt,Ii,Hi-Ii),Mt.F=Wt.mb,Mt.F==null&&Mt.F.length==0)){Ws=Un(Wt,3,"Could not decode alpha data.");break t}Ii<Mt.j&&(si=Mt.j-Ii,Ii=Mt.j,e(!(1&si)),Mt.O+=Wt.R*si,Mt.N+=Wt.B*(si>>1),Mt.W+=Wt.B*(si>>1),Mt.F!=null&&(Mt.J+=Mt.width*si)),Ii<Hi&&(Mt.O+=Mt.v,Mt.N+=Mt.v>>1,Mt.W+=Mt.v>>1,Mt.F!=null&&(Mt.J+=Mt.v),Mt.ka=Ii-Mt.j,Mt.U=Mt.va-Mt.v,Mt.T=Hi-Ii,Ws=Mt.put(Mt))}Xn+1!=Wt.Ic||Gi||(n(Wt.sa,Wt.ta-En,Ui,Cs+16*Wt.R,En),n(Wt.qa,Wt.ra-ri,Li,qn+8*Wt.B,ri),n(Wt.Ha,Wt.Ia-ri,Ms,Kr+8*Wt.B,ri))}if(!Ws)return Un(ii,6,"Output aborted.")}return 1})(ve,Be)),Be.bc!=null&&Be.bc(Be),$e&=1}return $e?(ve.cb=0,$e):0})(y,O)||(A=y.a)}}else A=y.a}A==0&&oe.Oa!=null&&oe.Oa.fd&&(A=cl(oe.ba))}oe=A}re=oe!=0?null:11>re?de.f.RGBA.eb:de.f.kb.y}else re=null;return re};var Dn=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function f(H,Q){for(var M="",T=0;T<4;T++)M+=String.fromCharCode(H[Q++]);return M}function m(H,Q){return H[Q+0]|H[Q+1]<<8}function b(H,Q){return(H[Q+0]|H[Q+1]<<8|H[Q+2]<<16)>>>0}function S(H,Q){return(H[Q+0]|H[Q+1]<<8|H[Q+2]<<16|H[Q+3]<<24)>>>0}new h;var v=[0],P=[0],x=[],k=new h,N=r,$=(function(H,Q){var M={},T=0,R=!1,Z=0,se=0;if(M.frames=[],!(function(D,W){for(var K=0;K<4;K++)if(D[W+K]!="RIFF".charCodeAt(K))return!0;return!1})(H,Q)){for(S(H,Q+=4),Q+=8;Q<H.length;){var V=f(H,Q),ee=S(H,Q+=4);Q+=4;var ae=ee+(1&ee);switch(V){case"VP8 ":case"VP8L":M.frames[T]===void 0&&(M.frames[T]={}),(J=M.frames[T]).src_off=R?se:Q-8,J.src_size=Z+ee+8,T++,R&&(R=!1,Z=0,se=0);break;case"VP8X":(J=M.header={}).feature_flags=H[Q];var Ce=Q+4;J.canvas_width=1+b(H,Ce),Ce+=3,J.canvas_height=1+b(H,Ce),Ce+=3;break;case"ALPH":R=!0,Z=ae+8,se=Q-8;break;case"ANIM":(J=M.header).bgcolor=S(H,Q),Ce=Q+4,J.loop_count=m(H,Ce),Ce+=2;break;case"ANMF":var xe,J;(J=M.frames[T]={}).offset_x=2*b(H,Q),Q+=3,J.offset_y=2*b(H,Q),Q+=3,J.width=1+b(H,Q),Q+=3,J.height=1+b(H,Q),Q+=3,J.duration=b(H,Q),Q+=3,xe=H[Q++],J.dispose=1&xe,J.blend=xe>>1&1}V!="ANMF"&&(Q+=ae)}return M}})(N,0);$.response=N,$.rgbaoutput=!0,$.dataurl=!1;var I=$.header?$.header:null,z=$.frames?$.frames:null;if(I){I.loop_counter=I.loop_count,v=[I.canvas_height],P=[I.canvas_width];for(var B=0;B<z.length&&z[B].blend!=0;B++);}var G=z[0],te=k.WebPDecodeRGBA(N,G.src_off,G.src_size,P,v);G.rgba=te,G.imgwidth=P[0],G.imgheight=v[0];for(var F=0;F<P[0]*v[0]*4;F++)x[F]=te[F];return this.width=P,this.height=v,this.data=x,this}(function(r){var e,t,n,s,o,d,c,h,f,m=function(D){return D=D||{},this.isStrokeTransparent=D.isStrokeTransparent||!1,this.strokeOpacity=D.strokeOpacity||1,this.strokeStyle=D.strokeStyle||"#000000",this.fillStyle=D.fillStyle||"#000000",this.isFillTransparent=D.isFillTransparent||!1,this.fillOpacity=D.fillOpacity||1,this.font=D.font||"10px sans-serif",this.textBaseline=D.textBaseline||"alphabetic",this.textAlign=D.textAlign||"left",this.lineWidth=D.lineWidth||1,this.lineJoin=D.lineJoin||"miter",this.lineCap=D.lineCap||"butt",this.path=D.path||[],this.transform=D.transform!==void 0?D.transform.clone():new h,this.globalCompositeOperation=D.globalCompositeOperation||"normal",this.globalAlpha=D.globalAlpha||1,this.clip_path=D.clip_path||[],this.currentPoint=D.currentPoint||new d,this.miterLimit=D.miterLimit||10,this.lastPoint=D.lastPoint||new d,this.lineDashOffset=D.lineDashOffset||0,this.lineDash=D.lineDash||[],this.margin=D.margin||[0,0,0,0],this.prevPageLastElemOffset=D.prevPageLastElemOffset||0,this.ignoreClearRect=typeof D.ignoreClearRect!="boolean"||D.ignoreClearRect,this};r.events.push(["initialized",function(){this.context2d=new b(this),e=this.internal.f2,t=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,d=this.internal.Point,c=this.internal.Rectangle,h=this.internal.Matrix,f=new m}]);var b=function(D){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var W=D;Object.defineProperty(this,"pdf",{get:function(){return W}});var K=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return K},set:function(fe){K=!!fe}});var ue=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return ue},set:function(fe){ue=!!fe}});var Te=0;Object.defineProperty(this,"posX",{get:function(){return Te},set:function(fe){isNaN(fe)||(Te=fe)}});var Pe=0;Object.defineProperty(this,"posY",{get:function(){return Pe},set:function(fe){isNaN(fe)||(Pe=fe)}}),Object.defineProperty(this,"margin",{get:function(){return f.margin},set:function(fe){var Nt;typeof fe=="number"?Nt=[fe,fe,fe,fe]:((Nt=new Array(4))[0]=fe[0],Nt[1]=fe.length>=2?fe[1]:Nt[0],Nt[2]=fe.length>=3?fe[2]:Nt[0],Nt[3]=fe.length>=4?fe[3]:Nt[1]),f.margin=Nt}});var Ve=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Ve},set:function(fe){Ve=fe}});var De=0;Object.defineProperty(this,"lastBreak",{get:function(){return De},set:function(fe){De=fe}});var et=[];Object.defineProperty(this,"pageBreaks",{get:function(){return et},set:function(fe){et=fe}}),Object.defineProperty(this,"ctx",{get:function(){return f},set:function(fe){fe instanceof m&&(f=fe)}}),Object.defineProperty(this,"path",{get:function(){return f.path},set:function(fe){f.path=fe}});var ot=[];Object.defineProperty(this,"ctxStack",{get:function(){return ot},set:function(fe){ot=fe}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(fe){var Nt;Nt=S(fe),this.ctx.fillStyle=Nt.style,this.ctx.isFillTransparent=Nt.a===0,this.ctx.fillOpacity=Nt.a,this.pdf.setFillColor(Nt.r,Nt.g,Nt.b,{a:Nt.a}),this.pdf.setTextColor(Nt.r,Nt.g,Nt.b,{a:Nt.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(fe){var Nt=S(fe);this.ctx.strokeStyle=Nt.style,this.ctx.isStrokeTransparent=Nt.a===0,this.ctx.strokeOpacity=Nt.a,Nt.a===0?this.pdf.setDrawColor(255,255,255):(Nt.a,this.pdf.setDrawColor(Nt.r,Nt.g,Nt.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(fe){["butt","round","square"].indexOf(fe)!==-1&&(this.ctx.lineCap=fe,this.pdf.setLineCap(fe))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(fe){isNaN(fe)||(this.ctx.lineWidth=fe,this.pdf.setLineWidth(fe))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(fe){["bevel","round","miter"].indexOf(fe)!==-1&&(this.ctx.lineJoin=fe,this.pdf.setLineJoin(fe))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(fe){isNaN(fe)||(this.ctx.miterLimit=fe,this.pdf.setMiterLimit(fe))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(fe){this.ctx.textBaseline=fe}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(fe){["right","end","center","left","start"].indexOf(fe)!==-1&&(this.ctx.textAlign=fe)}});var at=null,ht=null,xt=null;Object.defineProperty(this,"fontFaces",{get:function(){return xt},set:function(fe){at=null,ht=null,xt=fe}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(fe){var Nt;if(this.ctx.font=fe,(Nt=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(fe))!==null){var zt=Nt[1];Nt[2];var Bt=Nt[3],it=Nt[4];Nt[5];var qt=Nt[6],vt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(it)[2];it=Math.floor(vt==="px"?parseFloat(it)*this.pdf.internal.scaleFactor:vt==="em"?parseFloat(it)*this.pdf.getFontSize():parseFloat(it)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(it);var Dt=(function(tn){var zn,Pn,dn=[],An=tn.trim();if(An==="")return Tm;if(An in ab)return[ab[An]];for(;An!=="";){switch(Pn=null,zn=(An=lb(An)).charAt(0)){case'"':case"'":Pn=HA(An.substring(1),zn);break;default:Pn=qA(An)}if(Pn===null||(dn.push(Pn[0]),(An=lb(Pn[1]))!==""&&An.charAt(0)!==","))return Tm;An=An.replace(/^,/,"")}return dn})(qt);if(this.fontFaces){var Ot=(function(tn,zn){var Pn=tn.getFontList(),dn=JSON.stringify(Pn);if(at===null||ht!==dn){var An=(function(lt){var nn=[];return Object.keys(lt).forEach(function(Xt){lt[Xt].forEach(function(Kt){var Cn=null;switch(Kt){case"bold":Cn={family:Xt,weight:"bold"};break;case"italic":Cn={family:Xt,style:"italic"};break;case"bolditalic":Cn={family:Xt,weight:"bold",style:"italic"};break;case"":case"normal":Cn={family:Xt}}Cn!==null&&(Cn.ref={name:Xt,style:Kt},nn.push(Cn))})}),nn})(Pn);at=(function(lt){for(var nn={},Xt=0;Xt<lt.length;++Xt){var Kt=Cm(lt[Xt]),Cn=Kt.family,Vi=Kt.stretch,Vn=Kt.style,bn=Kt.weight;nn[Cn]=nn[Cn]||{},nn[Cn][Vi]=nn[Cn][Vi]||{},nn[Cn][Vi][Vn]=nn[Cn][Vi][Vn]||{},nn[Cn][Vi][Vn][bn]=Kt}return nn})(An.concat(zn)),ht=dn}return at})(this.pdf,this.fontFaces),sn=Dt.map(function(tn){return{family:tn,stretch:"normal",weight:Bt,style:zt}}),kt=(function(tn,zn,Pn){for(var dn=(Pn=Pn||{}).defaultFontFamily||"times",An=Object.assign({},UA,Pn.genericFontFamilies||{}),lt=null,nn=null,Xt=0;Xt<zn.length;++Xt)if(An[(lt=Cm(zn[Xt])).family]&&(lt.family=An[lt.family]),tn.hasOwnProperty(lt.family)){nn=tn[lt.family];break}if(!(nn=nn||tn[dn]))throw new Error("Could not find a font-family for the rule '"+ob(lt)+"' and default family '"+dn+"'.");if(nn=(function(Kt,Cn){if(Cn[Kt])return Cn[Kt];var Vi=Jm[Kt],Vn=Vi<=Jm.normal?-1:1,bn=rb(Cn,V2,Vi,Vn);if(!bn)throw new Error("Could not find a matching font-stretch value for "+Kt);return bn})(lt.stretch,nn),nn=(function(Kt,Cn){if(Cn[Kt])return Cn[Kt];for(var Vi=q2[Kt],Vn=0;Vn<Vi.length;++Vn)if(Cn[Vi[Vn]])return Cn[Vi[Vn]];throw new Error("Could not find a matching font-style for "+Kt)})(lt.style,nn),!(nn=(function(Kt,Cn){if(Cn[Kt])return Cn[Kt];if(Kt===400&&Cn[500])return Cn[500];if(Kt===500&&Cn[400])return Cn[400];var Vi=FA[Kt],Vn=rb(Cn,W2,Vi,Kt<400?-1:1);if(!Vn)throw new Error("Could not find a matching font-weight for value "+Kt);return Vn})(lt.weight,nn)))throw new Error("Failed to resolve a font for the rule '"+ob(lt)+"'.");return nn})(Ot,sn);this.pdf.setFont(kt.ref.name,kt.ref.style)}else{var Lt="";(Bt==="bold"||parseInt(Bt,10)>=700||zt==="bold")&&(Lt="bold"),zt==="italic"&&(Lt+="italic"),Lt.length===0&&(Lt="normal");for(var Jn="",pt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},jt=0;jt<Dt.length;jt++){if(this.pdf.internal.getFont(Dt[jt],Lt,{noFallback:!0,disableWarning:!0})!==void 0){Jn=Dt[jt];break}if(Lt==="bolditalic"&&this.pdf.internal.getFont(Dt[jt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Jn=Dt[jt],Lt="bold";else if(this.pdf.internal.getFont(Dt[jt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Jn=Dt[jt],Lt="normal";break}}if(Jn===""){for(var Fn=0;Fn<Dt.length;Fn++)if(pt[Dt[Fn]]){Jn=pt[Dt[Fn]];break}}Jn=Jn===""?"Times":Jn,this.pdf.setFont(Jn,Lt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(fe){this.ctx.globalCompositeOperation=fe}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(fe){this.ctx.globalAlpha=fe}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(fe){this.ctx.lineDashOffset=fe,J.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(fe){this.ctx.lineDash=fe,J.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(fe){this.ctx.ignoreClearRect=!!fe}})};b.prototype.setLineDash=function(D){this.lineDash=D},b.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},b.prototype.fill=function(){z.call(this,"fill",!1)},b.prototype.stroke=function(){z.call(this,"stroke",!1)},b.prototype.beginPath=function(){this.path=[{type:"begin"}]},b.prototype.moveTo=function(D,W){if(isNaN(D)||isNaN(W))throw Ys.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var K=this.ctx.transform.applyToPoint(new d(D,W));this.path.push({type:"mt",x:K.x,y:K.y}),this.ctx.lastPoint=new d(D,W)},b.prototype.closePath=function(){var D=new d(0,0),W=0;for(W=this.path.length-1;W!==-1;W--)if(this.path[W].type==="begin"&&Rs(this.path[W+1])==="object"&&typeof this.path[W+1].x=="number"){D=new d(this.path[W+1].x,this.path[W+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new d(D.x,D.y)},b.prototype.lineTo=function(D,W){if(isNaN(D)||isNaN(W))throw Ys.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var K=this.ctx.transform.applyToPoint(new d(D,W));this.path.push({type:"lt",x:K.x,y:K.y}),this.ctx.lastPoint=new d(K.x,K.y)},b.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),z.call(this,null,!0)},b.prototype.quadraticCurveTo=function(D,W,K,ue){if(isNaN(K)||isNaN(ue)||isNaN(D)||isNaN(W))throw Ys.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Te=this.ctx.transform.applyToPoint(new d(K,ue)),Pe=this.ctx.transform.applyToPoint(new d(D,W));this.path.push({type:"qct",x1:Pe.x,y1:Pe.y,x:Te.x,y:Te.y}),this.ctx.lastPoint=new d(Te.x,Te.y)},b.prototype.bezierCurveTo=function(D,W,K,ue,Te,Pe){if(isNaN(Te)||isNaN(Pe)||isNaN(D)||isNaN(W)||isNaN(K)||isNaN(ue))throw Ys.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Ve=this.ctx.transform.applyToPoint(new d(Te,Pe)),De=this.ctx.transform.applyToPoint(new d(D,W)),et=this.ctx.transform.applyToPoint(new d(K,ue));this.path.push({type:"bct",x1:De.x,y1:De.y,x2:et.x,y2:et.y,x:Ve.x,y:Ve.y}),this.ctx.lastPoint=new d(Ve.x,Ve.y)},b.prototype.arc=function(D,W,K,ue,Te,Pe){if(isNaN(D)||isNaN(W)||isNaN(K)||isNaN(ue)||isNaN(Te))throw Ys.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Pe=!!Pe,!this.ctx.transform.isIdentity){var Ve=this.ctx.transform.applyToPoint(new d(D,W));D=Ve.x,W=Ve.y;var De=this.ctx.transform.applyToPoint(new d(0,K)),et=this.ctx.transform.applyToPoint(new d(0,0));K=Math.sqrt(Math.pow(De.x-et.x,2)+Math.pow(De.y-et.y,2))}Math.abs(Te-ue)>=2*Math.PI&&(ue=0,Te=2*Math.PI),this.path.push({type:"arc",x:D,y:W,radius:K,startAngle:ue,endAngle:Te,counterclockwise:Pe})},b.prototype.arcTo=function(D,W,K,ue,Te){throw new Error("arcTo not implemented.")},b.prototype.rect=function(D,W,K,ue){if(isNaN(D)||isNaN(W)||isNaN(K)||isNaN(ue))throw Ys.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(D,W),this.lineTo(D+K,W),this.lineTo(D+K,W+ue),this.lineTo(D,W+ue),this.lineTo(D,W),this.lineTo(D+K,W),this.lineTo(D,W)},b.prototype.fillRect=function(D,W,K,ue){if(isNaN(D)||isNaN(W)||isNaN(K)||isNaN(ue))throw Ys.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!v.call(this)){var Te={};this.lineCap!=="butt"&&(Te.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Te.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(D,W,K,ue),this.fill(),Te.hasOwnProperty("lineCap")&&(this.lineCap=Te.lineCap),Te.hasOwnProperty("lineJoin")&&(this.lineJoin=Te.lineJoin)}},b.prototype.strokeRect=function(D,W,K,ue){if(isNaN(D)||isNaN(W)||isNaN(K)||isNaN(ue))throw Ys.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");P.call(this)||(this.beginPath(),this.rect(D,W,K,ue),this.stroke())},b.prototype.clearRect=function(D,W,K,ue){if(isNaN(D)||isNaN(W)||isNaN(K)||isNaN(ue))throw Ys.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(D,W,K,ue))},b.prototype.save=function(D){D=typeof D!="boolean"||D;for(var W=this.pdf.internal.getCurrentPageInfo().pageNumber,K=0;K<this.pdf.internal.getNumberOfPages();K++)this.pdf.setPage(K+1),this.pdf.internal.out("q");if(this.pdf.setPage(W),D){this.ctx.fontSize=this.pdf.internal.getFontSize();var ue=new m(this.ctx);this.ctxStack.push(this.ctx),this.ctx=ue}},b.prototype.restore=function(D){D=typeof D!="boolean"||D;for(var W=this.pdf.internal.getCurrentPageInfo().pageNumber,K=0;K<this.pdf.internal.getNumberOfPages();K++)this.pdf.setPage(K+1),this.pdf.internal.out("Q");this.pdf.setPage(W),D&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},b.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var S=function(D){var W,K,ue,Te;if(D.isCanvasGradient===!0&&(D=D.getColor()),!D)return{r:0,g:0,b:0,a:0,style:D};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(D))W=0,K=0,ue=0,Te=0;else{var Pe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(D);if(Pe!==null)W=parseInt(Pe[1]),K=parseInt(Pe[2]),ue=parseInt(Pe[3]),Te=1;else if((Pe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(D))!==null)W=parseInt(Pe[1]),K=parseInt(Pe[2]),ue=parseInt(Pe[3]),Te=parseFloat(Pe[4]);else{if(Te=1,typeof D=="string"&&D.charAt(0)!=="#"){var Ve=new I2(D);D=Ve.ok?Ve.toHex():"#000000"}D.length===4?(W=D.substring(1,2),W+=W,K=D.substring(2,3),K+=K,ue=D.substring(3,4),ue+=ue):(W=D.substring(1,3),K=D.substring(3,5),ue=D.substring(5,7)),W=parseInt(W,16),K=parseInt(K,16),ue=parseInt(ue,16)}}return{r:W,g:K,b:ue,a:Te,style:D}},v=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},P=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};b.prototype.fillText=function(D,W,K,ue){if(isNaN(W)||isNaN(K)||typeof D!="string")throw Ys.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(ue=isNaN(ue)?void 0:ue,!v.call(this)){var Te=ae(this.ctx.transform.rotation),Pe=this.ctx.transform.scaleX;T.call(this,{text:D,x:W,y:K,scale:Pe,angle:Te,align:this.textAlign,maxWidth:ue})}},b.prototype.strokeText=function(D,W,K,ue){if(isNaN(W)||isNaN(K)||typeof D!="string")throw Ys.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!P.call(this)){ue=isNaN(ue)?void 0:ue;var Te=ae(this.ctx.transform.rotation),Pe=this.ctx.transform.scaleX;T.call(this,{text:D,x:W,y:K,scale:Pe,renderingMode:"stroke",angle:Te,align:this.textAlign,maxWidth:ue})}},b.prototype.measureText=function(D){if(typeof D!="string")throw Ys.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var W=this.pdf,K=this.pdf.internal.scaleFactor,ue=W.internal.getFontSize(),Te=W.getStringUnitWidth(D)*ue/W.internal.scaleFactor;return new function(Pe){var Ve=(Pe=Pe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Ve}}),this}({width:Te*=Math.round(96*K/72*1e4)/1e4})},b.prototype.scale=function(D,W){if(isNaN(D)||isNaN(W))throw Ys.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var K=new h(D,0,0,W,0,0);this.ctx.transform=this.ctx.transform.multiply(K)},b.prototype.rotate=function(D){if(isNaN(D))throw Ys.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var W=new h(Math.cos(D),Math.sin(D),-Math.sin(D),Math.cos(D),0,0);this.ctx.transform=this.ctx.transform.multiply(W)},b.prototype.translate=function(D,W){if(isNaN(D)||isNaN(W))throw Ys.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var K=new h(1,0,0,1,D,W);this.ctx.transform=this.ctx.transform.multiply(K)},b.prototype.transform=function(D,W,K,ue,Te,Pe){if(isNaN(D)||isNaN(W)||isNaN(K)||isNaN(ue)||isNaN(Te)||isNaN(Pe))throw Ys.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Ve=new h(D,W,K,ue,Te,Pe);this.ctx.transform=this.ctx.transform.multiply(Ve)},b.prototype.setTransform=function(D,W,K,ue,Te,Pe){D=isNaN(D)?1:D,W=isNaN(W)?0:W,K=isNaN(K)?0:K,ue=isNaN(ue)?1:ue,Te=isNaN(Te)?0:Te,Pe=isNaN(Pe)?0:Pe,this.ctx.transform=new h(D,W,K,ue,Te,Pe)};var x=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};b.prototype.drawImage=function(D,W,K,ue,Te,Pe,Ve,De,et){var ot=this.pdf.getImageProperties(D),at=1,ht=1,xt=1,fe=1;ue!==void 0&&De!==void 0&&(xt=De/ue,fe=et/Te,at=ot.width/ue*De/ue,ht=ot.height/Te*et/Te),Pe===void 0&&(Pe=W,Ve=K,W=0,K=0),ue!==void 0&&De===void 0&&(De=ue,et=Te),ue===void 0&&De===void 0&&(De=ot.width,et=ot.height);var Nt=this.ctx.transform.decompose(),zt=ae(Nt.rotate.shx),Bt=new h,it=(Bt=(Bt=(Bt=Bt.multiply(Nt.translate)).multiply(Nt.skew)).multiply(Nt.scale)).applyToRectangle(new c(Pe-W*xt,Ve-K*fe,ue*at,Te*ht));if(this.autoPaging){for(var qt,vt=k.call(this,it),Dt=[],Ot=0;Ot<vt.length;Ot+=1)Dt.indexOf(vt[Ot])===-1&&Dt.push(vt[Ot]);I(Dt);for(var sn=Dt[0],kt=Dt[Dt.length-1],Lt=sn;Lt<kt+1;Lt++){this.pdf.setPage(Lt);var Jn=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],pt=Lt===1?this.posY+this.margin[0]:this.margin[0],jt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Fn=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],tn=Lt===1?0:jt+(Lt-2)*Fn;if(this.ctx.clip_path.length!==0){var zn=this.path;qt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=$(qt,this.posX+this.margin[3],-tn+pt+this.ctx.prevPageLastElemOffset),B.call(this,"fill",!0),this.path=zn}var Pn=JSON.parse(JSON.stringify(it));Pn=$([Pn],this.posX+this.margin[3],-tn+pt+this.ctx.prevPageLastElemOffset)[0];var dn=(Lt>sn||Lt<kt)&&x.call(this);dn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Jn,Fn,null).clip().discardPath()),this.pdf.addImage(D,"JPEG",Pn.x,Pn.y,Pn.w,Pn.h,null,null,zt),dn&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(D,"JPEG",it.x,it.y,it.w,it.h,null,null,zt)};var k=function(D,W,K){var ue=[];W=W||this.pdf.internal.pageSize.width,K=K||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Te=this.posY+this.ctx.prevPageLastElemOffset;switch(D.type){default:case"mt":case"lt":ue.push(Math.floor((D.y+Te)/K)+1);break;case"arc":ue.push(Math.floor((D.y+Te-D.radius)/K)+1),ue.push(Math.floor((D.y+Te+D.radius)/K)+1);break;case"qct":var Pe=Ce(this.ctx.lastPoint.x,this.ctx.lastPoint.y,D.x1,D.y1,D.x,D.y);ue.push(Math.floor((Pe.y+Te)/K)+1),ue.push(Math.floor((Pe.y+Pe.h+Te)/K)+1);break;case"bct":var Ve=xe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,D.x1,D.y1,D.x2,D.y2,D.x,D.y);ue.push(Math.floor((Ve.y+Te)/K)+1),ue.push(Math.floor((Ve.y+Ve.h+Te)/K)+1);break;case"rect":ue.push(Math.floor((D.y+Te)/K)+1),ue.push(Math.floor((D.y+D.h+Te)/K)+1)}for(var De=0;De<ue.length;De+=1)for(;this.pdf.internal.getNumberOfPages()<ue[De];)N.call(this);return ue},N=function(){var D=this.fillStyle,W=this.strokeStyle,K=this.font,ue=this.lineCap,Te=this.lineWidth,Pe=this.lineJoin;this.pdf.addPage(),this.fillStyle=D,this.strokeStyle=W,this.font=K,this.lineCap=ue,this.lineWidth=Te,this.lineJoin=Pe},$=function(D,W,K){for(var ue=0;ue<D.length;ue++)switch(D[ue].type){case"bct":D[ue].x2+=W,D[ue].y2+=K;case"qct":D[ue].x1+=W,D[ue].y1+=K;default:D[ue].x+=W,D[ue].y+=K}return D},I=function(D){return D.sort(function(W,K){return W-K})},z=function(D,W){var K=this.fillStyle,ue=this.strokeStyle,Te=this.lineCap,Pe=this.lineWidth,Ve=Math.abs(Pe*this.ctx.transform.scaleX),De=this.lineJoin;if(this.autoPaging){for(var et,ot,at=JSON.parse(JSON.stringify(this.path)),ht=JSON.parse(JSON.stringify(this.path)),xt=[],fe=0;fe<ht.length;fe++)if(ht[fe].x!==void 0)for(var Nt=k.call(this,ht[fe]),zt=0;zt<Nt.length;zt+=1)xt.indexOf(Nt[zt])===-1&&xt.push(Nt[zt]);for(var Bt=0;Bt<xt.length;Bt++)for(;this.pdf.internal.getNumberOfPages()<xt[Bt];)N.call(this);I(xt);for(var it=xt[0],qt=xt[xt.length-1],vt=it;vt<qt+1;vt++){this.pdf.setPage(vt),this.fillStyle=K,this.strokeStyle=ue,this.lineCap=Te,this.lineWidth=Ve,this.lineJoin=De;var Dt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ot=vt===1?this.posY+this.margin[0]:this.margin[0],sn=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],kt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Lt=vt===1?0:sn+(vt-2)*kt;if(this.ctx.clip_path.length!==0){var Jn=this.path;et=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=$(et,this.posX+this.margin[3],-Lt+Ot+this.ctx.prevPageLastElemOffset),B.call(this,D,!0),this.path=Jn}if(ot=JSON.parse(JSON.stringify(at)),this.path=$(ot,this.posX+this.margin[3],-Lt+Ot+this.ctx.prevPageLastElemOffset),W===!1||vt===0){var pt=(vt>it||vt<qt)&&x.call(this);pt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Dt,kt,null).clip().discardPath()),B.call(this,D,W),pt&&this.pdf.restoreGraphicsState()}this.lineWidth=Pe}this.path=at}else this.lineWidth=Ve,B.call(this,D,W),this.lineWidth=Pe},B=function(D,W){if((D!=="stroke"||W||!P.call(this))&&(D==="stroke"||W||!v.call(this))){for(var K,ue,Te=[],Pe=this.path,Ve=0;Ve<Pe.length;Ve++){var De=Pe[Ve];switch(De.type){case"begin":Te.push({begin:!0});break;case"close":Te.push({close:!0});break;case"mt":Te.push({start:De,deltas:[],abs:[]});break;case"lt":var et=Te.length;if(Pe[Ve-1]&&!isNaN(Pe[Ve-1].x)&&(K=[De.x-Pe[Ve-1].x,De.y-Pe[Ve-1].y],et>0)){for(;et>=0;et--)if(Te[et-1].close!==!0&&Te[et-1].begin!==!0){Te[et-1].deltas.push(K),Te[et-1].abs.push(De);break}}break;case"bct":K=[De.x1-Pe[Ve-1].x,De.y1-Pe[Ve-1].y,De.x2-Pe[Ve-1].x,De.y2-Pe[Ve-1].y,De.x-Pe[Ve-1].x,De.y-Pe[Ve-1].y],Te[Te.length-1].deltas.push(K);break;case"qct":var ot=Pe[Ve-1].x+2/3*(De.x1-Pe[Ve-1].x),at=Pe[Ve-1].y+2/3*(De.y1-Pe[Ve-1].y),ht=De.x+2/3*(De.x1-De.x),xt=De.y+2/3*(De.y1-De.y),fe=De.x,Nt=De.y;K=[ot-Pe[Ve-1].x,at-Pe[Ve-1].y,ht-Pe[Ve-1].x,xt-Pe[Ve-1].y,fe-Pe[Ve-1].x,Nt-Pe[Ve-1].y],Te[Te.length-1].deltas.push(K);break;case"arc":Te.push({deltas:[],abs:[],arc:!0}),Array.isArray(Te[Te.length-1].abs)&&Te[Te.length-1].abs.push(De)}}ue=W?null:D==="stroke"?"stroke":"fill";for(var zt=!1,Bt=0;Bt<Te.length;Bt++)if(Te[Bt].arc)for(var it=Te[Bt].abs,qt=0;qt<it.length;qt++){var vt=it[qt];vt.type==="arc"?F.call(this,vt.x,vt.y,vt.radius,vt.startAngle,vt.endAngle,vt.counterclockwise,void 0,W,!zt):R.call(this,vt.x,vt.y),zt=!0}else if(Te[Bt].close===!0)this.pdf.internal.out("h"),zt=!1;else if(Te[Bt].begin!==!0){var Dt=Te[Bt].start.x,Ot=Te[Bt].start.y;Z.call(this,Te[Bt].deltas,Dt,Ot),zt=!0}ue&&H.call(this,ue),W&&Q.call(this)}},G=function(D){var W=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,K=W*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return D-K;case"top":return D+W-K;case"hanging":return D+W-2*K;case"middle":return D+W/2-K;default:return D}},te=function(D){return D+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};b.prototype.createLinearGradient=function(){var D=function(){};return D.colorStops=[],D.addColorStop=function(W,K){this.colorStops.push([W,K])},D.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},D.isCanvasGradient=!0,D},b.prototype.createPattern=function(){return this.createLinearGradient()},b.prototype.createRadialGradient=function(){return this.createLinearGradient()};var F=function(D,W,K,ue,Te,Pe,Ve,De,et){for(var ot=V.call(this,K,ue,Te,Pe),at=0;at<ot.length;at++){var ht=ot[at];at===0&&(et?M.call(this,ht.x1+D,ht.y1+W):R.call(this,ht.x1+D,ht.y1+W)),se.call(this,D,W,ht.x2,ht.y2,ht.x3,ht.y3,ht.x4,ht.y4)}De?Q.call(this):H.call(this,Ve)},H=function(D){switch(D){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},Q=function(){this.pdf.clip(),this.pdf.discardPath()},M=function(D,W){this.pdf.internal.out(t(D)+" "+n(W)+" m")},T=function(D){var W;switch(D.align){case"right":case"end":W="right";break;case"center":W="center";break;default:W="left"}var K,ue,Te,Pe=this.pdf.getTextDimensions(D.text),Ve=G.call(this,D.y),De=te.call(this,Ve)-Pe.h,et=this.ctx.transform.applyToPoint(new d(D.x,Ve));if(this.autoPaging){var ot=this.ctx.transform.decompose(),at=new h;at=(at=(at=at.multiply(ot.translate)).multiply(ot.skew)).multiply(ot.scale);for(var ht=this.ctx.transform.applyToRectangle(new c(D.x,Ve,Pe.w,Pe.h)),xt=at.applyToRectangle(new c(D.x,De,Pe.w,Pe.h)),fe=k.call(this,xt),Nt=[],zt=0;zt<fe.length;zt+=1)Nt.indexOf(fe[zt])===-1&&Nt.push(fe[zt]);I(Nt);for(var Bt=Nt[0],it=Nt[Nt.length-1],qt=Bt;qt<it+1;qt++){this.pdf.setPage(qt);var vt=qt===1?this.posY+this.margin[0]:this.margin[0],Dt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ot=this.pdf.internal.pageSize.height-this.margin[2],sn=Ot-this.margin[0],kt=this.pdf.internal.pageSize.width-this.margin[1],Lt=kt-this.margin[3],Jn=qt===1?0:Dt+(qt-2)*sn;if(this.ctx.clip_path.length!==0){var pt=this.path;K=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=$(K,this.posX+this.margin[3],-1*Jn+vt),B.call(this,"fill",!0),this.path=pt}var jt=$([JSON.parse(JSON.stringify(xt))],this.posX+this.margin[3],-Jn+vt+this.ctx.prevPageLastElemOffset)[0];D.scale>=.01&&(ue=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ue*D.scale),Te=this.lineWidth,this.lineWidth=Te*D.scale);var Fn=this.autoPaging!=="text";if(Fn||jt.y+jt.h<=Ot){if(Fn||jt.y>=vt&&jt.x<=kt){var tn=Fn?D.text:this.pdf.splitTextToSize(D.text,D.maxWidth||kt-jt.x)[0],zn=$([JSON.parse(JSON.stringify(ht))],this.posX+this.margin[3],-Jn+vt+this.ctx.prevPageLastElemOffset)[0],Pn=Fn&&(qt>Bt||qt<it)&&x.call(this);Pn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Lt,sn,null).clip().discardPath()),this.pdf.text(tn,zn.x,zn.y,{angle:D.angle,align:W,renderingMode:D.renderingMode}),Pn&&this.pdf.restoreGraphicsState()}}else jt.y<Ot&&(this.ctx.prevPageLastElemOffset+=Ot-jt.y);D.scale>=.01&&(this.pdf.setFontSize(ue),this.lineWidth=Te)}}else D.scale>=.01&&(ue=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ue*D.scale),Te=this.lineWidth,this.lineWidth=Te*D.scale),this.pdf.text(D.text,et.x+this.posX,et.y+this.posY,{angle:D.angle,align:W,renderingMode:D.renderingMode,maxWidth:D.maxWidth}),D.scale>=.01&&(this.pdf.setFontSize(ue),this.lineWidth=Te)},R=function(D,W,K,ue){K=K||0,ue=ue||0,this.pdf.internal.out(t(D+K)+" "+n(W+ue)+" l")},Z=function(D,W,K){return this.pdf.lines(D,W,K,null,null)},se=function(D,W,K,ue,Te,Pe,Ve,De){this.pdf.internal.out([e(s(K+D)),e(o(ue+W)),e(s(Te+D)),e(o(Pe+W)),e(s(Ve+D)),e(o(De+W)),"c"].join(" "))},V=function(D,W,K,ue){for(var Te=2*Math.PI,Pe=Math.PI/2;W>K;)W-=Te;var Ve=Math.abs(K-W);Ve<Te&&ue&&(Ve=Te-Ve);for(var De=[],et=ue?-1:1,ot=W;Ve>1e-5;){var at=ot+et*Math.min(Ve,Pe);De.push(ee.call(this,D,ot,at)),Ve-=Math.abs(at-ot),ot=at}return De},ee=function(D,W,K){var ue=(K-W)/2,Te=D*Math.cos(ue),Pe=D*Math.sin(ue),Ve=Te,De=-Pe,et=Ve*Ve+De*De,ot=et+Ve*Te+De*Pe,at=4/3*(Math.sqrt(2*et*ot)-ot)/(Ve*Pe-De*Te),ht=Ve-at*De,xt=De+at*Ve,fe=ht,Nt=-xt,zt=ue+W,Bt=Math.cos(zt),it=Math.sin(zt);return{x1:D*Math.cos(W),y1:D*Math.sin(W),x2:ht*Bt-xt*it,y2:ht*it+xt*Bt,x3:fe*Bt-Nt*it,y3:fe*it+Nt*Bt,x4:D*Math.cos(K),y4:D*Math.sin(K)}},ae=function(D){return 180*D/Math.PI},Ce=function(D,W,K,ue,Te,Pe){var Ve=D+.5*(K-D),De=W+.5*(ue-W),et=Te+.5*(K-Te),ot=Pe+.5*(ue-Pe),at=Math.min(D,Te,Ve,et),ht=Math.max(D,Te,Ve,et),xt=Math.min(W,Pe,De,ot),fe=Math.max(W,Pe,De,ot);return new c(at,xt,ht-at,fe-xt)},xe=function(D,W,K,ue,Te,Pe,Ve,De){var et,ot,at,ht,xt,fe,Nt,zt,Bt,it,qt,vt,Dt,Ot,sn=K-D,kt=ue-W,Lt=Te-K,Jn=Pe-ue,pt=Ve-Te,jt=De-Pe;for(ot=0;ot<41;ot++)Bt=(Nt=(at=D+(et=ot/40)*sn)+et*((xt=K+et*Lt)-at))+et*(xt+et*(Te+et*pt-xt)-Nt),it=(zt=(ht=W+et*kt)+et*((fe=ue+et*Jn)-ht))+et*(fe+et*(Pe+et*jt-fe)-zt),ot==0?(qt=Bt,vt=it,Dt=Bt,Ot=it):(qt=Math.min(qt,Bt),vt=Math.min(vt,it),Dt=Math.max(Dt,Bt),Ot=Math.max(Ot,it));return new c(Math.round(qt),Math.round(vt),Math.round(Dt-qt),Math.round(Ot-vt))},J=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var D,W,K=(D=this.ctx.lineDash,W=this.ctx.lineDashOffset,JSON.stringify({lineDash:D,lineDashOffset:W}));this.prevLineDash!==K&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=K)}}})(jn.API),(function(r){var e=function(d){var c,h,f,m,b,S,v,P,x,k;for(h=[],f=0,m=(d+=c="\0\0\0\0".slice(d.length%4||4)).length;m>f;f+=4)(b=(d.charCodeAt(f)<<24)+(d.charCodeAt(f+1)<<16)+(d.charCodeAt(f+2)<<8)+d.charCodeAt(f+3))!==0?(S=(b=((b=((b=((b=(b-(k=b%85))/85)-(x=b%85))/85)-(P=b%85))/85)-(v=b%85))/85)%85,h.push(S+33,v+33,P+33,x+33,k+33)):h.push(122);return(function(N,$){for(var I=$;I>0;I--)N.pop()})(h,c.length),String.fromCharCode.apply(String,h)+"~>"},t=function(d){var c,h,f,m,b,S=String,v="length",P=255,x="charCodeAt",k="slice",N="replace";for(d[k](-2),d=d[k](0,-2)[N](/\s/g,"")[N]("z","!!!!!"),f=[],m=0,b=(d+=c="uuuuu"[k](d[v]%5||5))[v];b>m;m+=5)h=52200625*(d[x](m)-33)+614125*(d[x](m+1)-33)+7225*(d[x](m+2)-33)+85*(d[x](m+3)-33)+(d[x](m+4)-33),f.push(P&h>>24,P&h>>16,P&h>>8,P&h);return(function($,I){for(var z=I;z>0;z--)$.pop()})(f,c[v]),S.fromCharCode.apply(S,f)},n=function(d){return d.split("").map(function(c){return("0"+c.charCodeAt().toString(16)).slice(-2)}).join("")+">"},s=function(d){var c=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((d=d.replace(/\s/g,"")).indexOf(">")!==-1&&(d=d.substr(0,d.indexOf(">"))),d.length%2&&(d+="0"),c.test(d)===!1)return"";for(var h="",f=0;f<d.length;f+=2)h+=String.fromCharCode("0x"+(d[f]+d[f+1]));return h},o=function(d){for(var c=new Uint8Array(d.length),h=d.length;h--;)c[h]=d.charCodeAt(h);return(c=Wm(c)).reduce(function(f,m){return f+String.fromCharCode(m)},"")};r.processDataByFilters=function(d,c){var h=0,f=d||"",m=[];for(typeof(c=c||[])=="string"&&(c=[c]),h=0;h<c.length;h+=1)switch(c[h]){case"ASCII85Decode":case"/ASCII85Decode":f=t(f),m.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":f=e(f),m.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":f=s(f),m.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":f=n(f),m.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":f=o(f),m.push("/FlateDecode");break;default:throw new Error('The filter: "'+c[h]+'" is not implemented')}return{data:f,reverseChain:m.reverse().join(" ")}}})(jn.API),(function(r){r.loadFile=function(e,t,n){return(function(s,o,d){o=o!==!1,d=typeof d=="function"?d:function(){};var c=void 0;try{c=(function(h,f,m){var b=new XMLHttpRequest,S=0,v=function(P){var x=P.length,k=[],N=String.fromCharCode;for(S=0;S<x;S+=1)k.push(N(255&P.charCodeAt(S)));return k.join("")};if(b.open("GET",h,!f),b.overrideMimeType("text/plain; charset=x-user-defined"),f===!1&&(b.onload=function(){b.status===200?m(v(this.responseText)):m(void 0)}),b.send(null),f&&b.status===200)return v(b.responseText)})(s,o,d)}catch{}return c})(e,t,n)},r.loadImageFile=r.loadFile})(jn.API),(function(r){function e(){return(ei.html2canvas?Promise.resolve(ei.html2canvas):am(()=>import("./html2canvas.esm-B0tyYwQk.js"),[])).catch(function(c){return Promise.reject(new Error("Could not load html2canvas: "+c))}).then(function(c){return c.default?c.default:c})}function t(){return(ei.DOMPurify?Promise.resolve(ei.DOMPurify):am(()=>import("./purify.es-B6FQ9oRL.js"),[])).catch(function(c){return Promise.reject(new Error("Could not load dompurify: "+c))}).then(function(c){return c.default?c.default:c})}var n=function(c){var h=Rs(c);return h==="undefined"?"undefined":h==="string"||c instanceof String?"string":h==="number"||c instanceof Number?"number":h==="function"||c instanceof Function?"function":c&&c.constructor===Array?"array":c&&c.nodeType===1?"element":h==="object"?"object":"unknown"},s=function(c,h){var f=document.createElement(c);for(var m in h.className&&(f.className=h.className),h.innerHTML&&h.dompurify&&(f.innerHTML=h.dompurify.sanitize(h.innerHTML)),h.style)f.style[m]=h.style[m];return f},o=function c(h,f){for(var m=h.nodeType===3?document.createTextNode(h.nodeValue):h.cloneNode(!1),b=h.firstChild;b;b=b.nextSibling)f!==!0&&b.nodeType===1&&b.nodeName==="SCRIPT"||m.appendChild(c(b,f));return h.nodeType===1&&(h.nodeName==="CANVAS"?(m.width=h.width,m.height=h.height,m.getContext("2d").drawImage(h,0,0)):h.nodeName!=="TEXTAREA"&&h.nodeName!=="SELECT"||(m.value=h.value),m.addEventListener("load",function(){m.scrollTop=h.scrollTop,m.scrollLeft=h.scrollLeft},!0)),m},d=function c(h){var f=Object.assign(c.convert(Promise.resolve()),JSON.parse(JSON.stringify(c.template))),m=c.convert(Promise.resolve(),f);return(m=m.setProgress(1,c,1,[c])).set(h)};(d.prototype=Object.create(Promise.prototype)).constructor=d,d.convert=function(c,h){return c.__proto__=h||d.prototype,c},d.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},d.prototype.from=function(c,h){return this.then(function(){switch(h=h||(function(f){switch(n(f)){case"string":return"string";case"element":return f.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(c),h){case"string":return this.then(t).then(function(f){return this.set({src:s("div",{innerHTML:c,dompurify:f})})});case"element":return this.set({src:c});case"canvas":return this.set({canvas:c});case"img":return this.set({img:c});default:return this.error("Unknown source type.")}})},d.prototype.to=function(c){switch(c){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},d.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var c={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},h=o(this.prop.src,this.opt.html2canvas.javascriptEnabled);h.tagName==="BODY"&&(c.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:c}),this.prop.container.appendChild(h),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},d.prototype.toCanvas=function(){var c=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(c).then(e).then(function(h){var f=Object.assign({},this.opt.html2canvas);return delete f.onrendered,h(this.prop.container,f)}).then(function(h){(this.opt.html2canvas.onrendered||function(){})(h),this.prop.canvas=h,document.body.removeChild(this.prop.overlay)})},d.prototype.toContext2d=function(){var c=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(c).then(e).then(function(h){var f=this.opt.jsPDF,m=this.opt.fontFaces,b=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,S=Object.assign({async:!0,allowTaint:!0,scale:b,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete S.onrendered,f.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,f.context2d.posX=this.opt.x,f.context2d.posY=this.opt.y,f.context2d.margin=this.opt.margin,f.context2d.fontFaces=m,m)for(var v=0;v<m.length;++v){var P=m[v],x=P.src.find(function(k){return k.format==="truetype"});x&&f.addFont(x.url,P.ref.name,P.ref.style)}return S.windowHeight=S.windowHeight||0,S.windowHeight=S.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):S.windowHeight,f.context2d.save(!0),h(this.prop.container,S)}).then(function(h){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(h),this.prop.canvas=h,document.body.removeChild(this.prop.overlay)})},d.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var c=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=c})},d.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},d.prototype.output=function(c,h,f){return(f=f||"pdf").toLowerCase()==="img"||f.toLowerCase()==="image"?this.outputImg(c,h):this.outputPdf(c,h)},d.prototype.outputPdf=function(c,h){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(c,h)})},d.prototype.outputImg=function(c){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(c){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+c+'" is not supported.'}})},d.prototype.save=function(c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(c?{filename:c}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},d.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},d.prototype.set=function(c){if(n(c)!=="object")return this;var h=Object.keys(c||{}).map(function(f){if(f in d.template.prop)return function(){this.prop[f]=c[f]};switch(f){case"margin":return this.setMargin.bind(this,c.margin);case"jsPDF":return function(){return this.opt.jsPDF=c.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,c.pageSize);default:return function(){this.opt[f]=c[f]}}},this);return this.then(function(){return this.thenList(h)})},d.prototype.get=function(c,h){return this.then(function(){var f=c in d.template.prop?this.prop[c]:this.opt[c];return h?h(f):f})},d.prototype.setMargin=function(c){return this.then(function(){switch(n(c)){case"number":c=[c,c,c,c];case"array":if(c.length===2&&(c=[c[0],c[1],c[0],c[1]]),c.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=c}).then(this.setPageSize)},d.prototype.setPageSize=function(c){function h(f,m){return Math.floor(f*m/72*96)}return this.then(function(){(c=c||jn.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(c.inner={width:c.width-this.opt.margin[1]-this.opt.margin[3],height:c.height-this.opt.margin[0]-this.opt.margin[2]},c.inner.px={width:h(c.inner.width,c.k),height:h(c.inner.height,c.k)},c.inner.ratio=c.inner.height/c.inner.width),this.prop.pageSize=c})},d.prototype.setProgress=function(c,h,f,m){return c!=null&&(this.progress.val=c),h!=null&&(this.progress.state=h),f!=null&&(this.progress.n=f),m!=null&&(this.progress.stack=m),this.progress.ratio=this.progress.val/this.progress.state,this},d.prototype.updateProgress=function(c,h,f,m){return this.setProgress(c?this.progress.val+c:null,h||null,f?this.progress.n+f:null,m?this.progress.stack.concat(m):null)},d.prototype.then=function(c,h){var f=this;return this.thenCore(c,h,function(m,b){return f.updateProgress(null,null,1,[m]),Promise.prototype.then.call(this,function(S){return f.updateProgress(null,m),S}).then(m,b).then(function(S){return f.updateProgress(1),S})})},d.prototype.thenCore=function(c,h,f){f=f||Promise.prototype.then;var m=this;c&&(c=c.bind(m)),h&&(h=h.bind(m));var b=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?m:d.convert(Object.assign({},m),Promise.prototype),S=f.call(b,c,h);return d.convert(S,m.__proto__)},d.prototype.thenExternal=function(c,h){return Promise.prototype.then.call(this,c,h)},d.prototype.thenList=function(c){var h=this;return c.forEach(function(f){h=h.thenCore(f)}),h},d.prototype.catch=function(c){c&&(c=c.bind(this));var h=Promise.prototype.catch.call(this,c);return d.convert(h,this)},d.prototype.catchExternal=function(c){return Promise.prototype.catch.call(this,c)},d.prototype.error=function(c){return this.then(function(){throw new Error(c)})},d.prototype.using=d.prototype.set,d.prototype.saveAs=d.prototype.save,d.prototype.export=d.prototype.output,d.prototype.run=d.prototype.then,jn.getPageSize=function(c,h,f){if(Rs(c)==="object"){var m=c;c=m.orientation,h=m.unit||h,f=m.format||f}h=h||"mm",f=f||"a4",c=(""+(c||"P")).toLowerCase();var b,S=(""+f).toLowerCase(),v={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(h){case"pt":b=1;break;case"mm":b=72/25.4;break;case"cm":b=72/2.54;break;case"in":b=72;break;case"px":b=.75;break;case"pc":case"em":b=12;break;case"ex":b=6;break;default:throw"Invalid unit: "+h}var P,x=0,k=0;if(v.hasOwnProperty(S))x=v[S][1]/b,k=v[S][0]/b;else try{x=f[1],k=f[0]}catch{throw new Error("Invalid format: "+f)}if(c==="p"||c==="portrait")c="p",k>x&&(P=k,k=x,x=P);else{if(c!=="l"&&c!=="landscape")throw"Invalid orientation: "+c;c="l",x>k&&(P=k,k=x,x=P)}return{width:k,height:x,unit:h,k:b,orientation:c}},r.html=function(c,h){(h=h||{}).callback=h.callback||function(){},h.html2canvas=h.html2canvas||{},h.html2canvas.canvas=h.html2canvas.canvas||this.canvas,h.jsPDF=h.jsPDF||this,h.fontFaces=h.fontFaces?h.fontFaces.map(Cm):null;var f=new d(h);return h.worker?f:f.from(c).doCallback()}})(jn.API),jn.API.addJS=function(r){return db=r,this.internal.events.subscribe("postPutResources",function(){kg=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(kg+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),cb=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+db+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){kg!==void 0&&cb!==void 0&&this.internal.out("/Names <</JavaScript "+kg+" 0 R>>")}),this},(function(r){var e;r.events.push(["postPutResources",function(){var t=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=t.outline.render().split(/\r\n/),o=0;o<s.length;o++){var d=s[o],c=n.exec(d);if(c!=null){var h=c[1];t.internal.newObjectDeferredBegin(h,!1)}t.internal.write(d)}if(this.outline.createNamedDestinations){var f=this.internal.pages.length,m=[];for(o=0;o<f;o++){var b=t.internal.newObject();m.push(b);var S=t.internal.getPageInfo(o+1);t.internal.write("<< /D["+S.objId+" 0 R /XYZ null null null]>> endobj")}var v=t.internal.newObject();for(t.internal.write("<< /Names [ "),o=0;o<m.length;o++)t.internal.write("(page_"+(o+1)+")"+m[o]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+v+" 0 R"),t.internal.write(">>","endobj")}}]),r.events.push(["putCatalog",function(){var t=this;t.outline.root.children.length>0&&(t.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&t.internal.write("/Names "+e+" 0 R"))}]),r.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(n,s,o){var d={title:s,options:o,children:[]};return n==null&&(n=this.root),n.children.push(d),d},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(n){n.id=t.internal.newObjectDeferred();for(var s=0;s<n.children.length;s++)this.genIds_r(n.children[s])},t.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},t.outline.renderItems=function(n){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,o=0;o<n.children.length;o++){var d=n.children[o];this.objStart(d),this.line("/Title "+this.makeString(d.title)),this.line("/Parent "+this.makeRef(n)),o>0&&this.line("/Prev "+this.makeRef(n.children[o-1])),o<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[o+1])),d.children.length>0&&(this.line("/First "+this.makeRef(d.children[0])),this.line("/Last "+this.makeRef(d.children[d.children.length-1])));var c=this.count=this.count_r({count:0},d);if(c>0&&this.line("/Count "+c),d.options&&d.options.pageNumber){var h=t.internal.getPageInfo(d.options.pageNumber);this.line("/Dest ["+h.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var f=0;f<n.children.length;f++)this.renderItems(n.children[f])},t.outline.line=function(n){this.ctx.val+=n+`\r
`},t.outline.makeRef=function(n){return n.id+" 0 R"},t.outline.makeString=function(n){return"("+t.internal.pdfEscape(n)+")"},t.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(n,s){for(var o=0;o<s.children.length;o++)n.count++,this.count_r(n,s.children[o]);return n.count}}])})(jn.API),(function(r){var e=[192,193,194,195,196,197,198,199];r.processJPEG=function(t,n,s,o,d,c){var h,f=this.decode.DCT_DECODE,m=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=d||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,h=(function(b){for(var S,v=256*b.charCodeAt(4)+b.charCodeAt(5),P=b.length,x={width:0,height:0,numcomponents:1},k=4;k<P;k+=2){if(k+=v,e.indexOf(b.charCodeAt(k+1))!==-1){S=256*b.charCodeAt(k+5)+b.charCodeAt(k+6),x={width:256*b.charCodeAt(k+7)+b.charCodeAt(k+8),height:S,numcomponents:b.charCodeAt(k+9)};break}v=256*b.charCodeAt(k+2)+b.charCodeAt(k+3)}return x})(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t),h.numcomponents){case 1:c=this.color_spaces.DEVICE_GRAY;break;case 4:c=this.color_spaces.DEVICE_CMYK;break;case 3:c=this.color_spaces.DEVICE_RGB}m={data:t,width:h.width,height:h.height,colorSpace:c,bitsPerComponent:8,filter:f,index:n,alias:s}}return m}})(jn.API),jn.API.processPNG=function(r,e,t,n){if(this.__addimage__.isArrayBuffer(r)&&(r=new Uint8Array(r)),this.__addimage__.isArrayBufferView(r)){var s,o=_A(r,{checkCrc:!0}),d=o.width,c=o.height,h=o.channels,f=o.palette,m=o.depth;s=f&&h===1?(function(F){for(var H=F.width,Q=F.height,M=F.data,T=F.palette,R=F.depth,Z=!1,se=[],V=[],ee=void 0,ae=!1,Ce=0,xe=0;xe<T.length;xe++){var J=px(T[xe],4),D=J[0],W=J[1],K=J[2],ue=J[3];se.push(D,W,K),ue!=null&&(ue===0?(Ce++,V.length<1&&V.push(xe)):ue<255&&(ae=!0))}if(ae||Ce>1){Z=!0,V=void 0;var Te=H*Q;ee=new Uint8Array(Te);for(var Pe=new DataView(M.buffer),Ve=0;Ve<Te;Ve++){var De=_m(Pe,Ve,R),et=px(T[De],4)[3];ee[Ve]=et}}else Ce===0&&(V=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:Z?8:void 0,colorBytes:M,alphaBytes:ee,needSMask:Z,palette:se,mask:V}})(o):h===2||h===4?(function(F){for(var H=F.data,Q=F.width,M=F.height,T=F.channels,R=F.depth,Z=T===2?"DeviceGray":"DeviceRGB",se=T-1,V=Q*M,ee=se,ae=V*ee,Ce=1*V,xe=Math.ceil(ae*R/8),J=Math.ceil(Ce*R/8),D=new Uint8Array(xe),W=new Uint8Array(J),K=new DataView(H.buffer),ue=new DataView(D.buffer),Te=new DataView(W.buffer),Pe=!1,Ve=0;Ve<V;Ve++){for(var De=Ve*T,et=0;et<ee;et++)bb(ue,_m(K,De+et,R),Ve*ee+et,R);var ot=_m(K,De+ee,R);ot<(1<<R)-1&&(Pe=!0),bb(Te,ot,1*Ve,R)}return{colorSpace:Z,colorsPerPixel:se,sMaskBitsPerComponent:Pe?R:void 0,colorBytes:D,alphaBytes:W,needSMask:Pe}})(o):(function(F){var H=F.data,Q=F.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:Q,colorsPerPixel:Q==="DeviceGray"?1:3,colorBytes:H instanceof Uint16Array?(function(M){for(var T=M.length,R=new Uint8Array(2*T),Z=new DataView(R.buffer,R.byteOffset,R.byteLength),se=0;se<T;se++)Z.setUint16(2*se,M[se],!1);return R})(H):H,needSMask:!1}})(o);var b,S,v,P=s,x=P.colorSpace,k=P.colorsPerPixel,N=P.sMaskBitsPerComponent,$=P.colorBytes,I=P.alphaBytes,z=P.needSMask,B=P.palette,G=P.mask,te=null;return n!==jn.API.image_compression.NONE&&typeof Wm=="function"?(te=(function(F){var H;switch(F){case jn.API.image_compression.FAST:H=11;break;case jn.API.image_compression.MEDIUM:H=13;break;case jn.API.image_compression.SLOW:H=14;break;default:H=12}return H})(n),b=this.decode.FLATE_DECODE,S="/Predictor ".concat(te," /Colors ").concat(k," /BitsPerComponent ").concat(m," /Columns ").concat(d),r=pb($,Math.ceil(d*k*m/8),k,m,n),z&&(v=pb(I,Math.ceil(d*N/8),1,N,n))):(b=void 0,S=void 0,r=$,z&&(v=I)),(this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r))&&(r=this.__addimage__.arrayBufferToBinaryString(r)),(v&&this.__addimage__.isArrayBuffer(v)||this.__addimage__.isArrayBufferView(v))&&(v=this.__addimage__.arrayBufferToBinaryString(v)),{alias:t,data:r,index:e,filter:b,decodeParameters:S,transparency:G,palette:B,sMask:v,predictor:te,width:d,height:c,bitsPerComponent:m,sMaskBitsPerComponent:N,colorSpace:x}}},(function(r){r.processGIF89A=function(e,t,n,s){var o=new GA(e),d=o.width,c=o.height,h=[];o.decodeAndBlitFrameRGBA(0,h);var f={data:h,width:d,height:c},m=new km(100).encode(f,100);return r.processJPEG.call(this,m,t,n,s)},r.processGIF87A=r.processGIF89A})(jn.API),Kc.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var r=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(r);for(var e=0;e<r;e++){var t=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:s,green:n,blue:t,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Kc.prototype.parseBGR=function(){this.pos=this.offset;try{var r="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[r]()}catch(t){Ys.log("bit decode error:"+t)}},Kc.prototype.bit1=function(){var r,e=Math.ceil(this.width/8),t=e%4;for(r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<e;s++)for(var o=this.datav.getUint8(this.pos++,!0),d=n*this.width*4+8*s*4,c=0;c<8&&8*s+c<this.width;c++){var h=this.palette[o>>7-c&1];this.data[d+4*c]=h.blue,this.data[d+4*c+1]=h.green,this.data[d+4*c+2]=h.red,this.data[d+4*c+3]=255}t!==0&&(this.pos+=4-t)}},Kc.prototype.bit4=function(){for(var r=Math.ceil(this.width/2),e=r%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,s=0;s<r;s++){var o=this.datav.getUint8(this.pos++,!0),d=n*this.width*4+2*s*4,c=o>>4,h=15&o,f=this.palette[c];if(this.data[d]=f.blue,this.data[d+1]=f.green,this.data[d+2]=f.red,this.data[d+3]=255,2*s+1>=this.width)break;f=this.palette[h],this.data[d+4]=f.blue,this.data[d+4+1]=f.green,this.data[d+4+2]=f.red,this.data[d+4+3]=255}e!==0&&(this.pos+=4-e)}},Kc.prototype.bit8=function(){for(var r=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*n;if(s<this.palette.length){var d=this.palette[s];this.data[o]=d.red,this.data[o+1]=d.green,this.data[o+2]=d.blue,this.data[o+3]=255}else this.data[o]=255,this.data[o+1]=255,this.data[o+2]=255,this.data[o+3]=255}r!==0&&(this.pos+=4-r)}},Kc.prototype.bit15=function(){for(var r=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var d=(o&e)/e*255|0,c=(o>>5&e)/e*255|0,h=(o>>10&e)/e*255|0,f=o>>15?255:0,m=n*this.width*4+4*s;this.data[m]=h,this.data[m+1]=c,this.data[m+2]=d,this.data[m+3]=f}this.pos+=r}},Kc.prototype.bit16=function(){for(var r=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,o=0;o<this.width;o++){var d=this.datav.getUint16(this.pos,!0);this.pos+=2;var c=(d&e)/e*255|0,h=(d>>5&t)/t*255|0,f=(d>>11)/e*255|0,m=s*this.width*4+4*o;this.data[m]=f,this.data[m+1]=h,this.data[m+2]=c,this.data[m+3]=255}this.pos+=r}},Kc.prototype.bit24=function(){for(var r=this.height-1;r>=0;r--){for(var e=this.bottom_up?r:this.height-1-r,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),d=e*this.width*4+4*t;this.data[d]=o,this.data[d+1]=s,this.data[d+2]=n,this.data[d+3]=255}this.pos+=this.width%4}},Kc.prototype.bit32=function(){for(var r=this.height-1;r>=0;r--)for(var e=this.bottom_up?r:this.height-1-r,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),d=this.datav.getUint8(this.pos++,!0),c=e*this.width*4+4*t;this.data[c]=o,this.data[c+1]=s,this.data[c+2]=n,this.data[c+3]=d}},Kc.prototype.getData=function(){return this.data},(function(r){r.processBMP=function(e,t,n,s){var o=new Kc(e,!1),d=o.width,c=o.height,h={data:o.getData(),width:d,height:c},f=new km(100).encode(h,100);return r.processJPEG.call(this,f,t,n,s)}})(jn.API),wb.prototype.getData=function(){return this.data},(function(r){r.processWEBP=function(e,t,n,s){var o=new wb(e),d=o.width,c=o.height,h={data:o.getData(),width:d,height:c},f=new km(100).encode(h,100);return r.processJPEG.call(this,f,t,n,s)}})(jn.API),jn.API.processRGBA=function(r,e,t){for(var n=r.data,s=n.length,o=new Uint8Array(s/4*3),d=new Uint8Array(s/4),c=0,h=0,f=0;f<s;f+=4){var m=n[f],b=n[f+1],S=n[f+2],v=n[f+3];o[c++]=m,o[c++]=b,o[c++]=S,d[h++]=v}var P=this.__addimage__.arrayBufferToBinaryString(o);return{alpha:this.__addimage__.arrayBufferToBinaryString(d),data:P,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:r.width,height:r.height}},jn.API.setLanguage=function(r){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[r]!==void 0&&(this.internal.languageSettings.languageCode=r,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Jh=jn.API,Ng=Jh.getCharWidthsArray=function(r,e){var t,n,s=(e=e||{}).font||this.internal.getFont(),o=e.fontSize||this.internal.getFontSize(),d=e.charSpace||this.internal.getCharSpace(),c=e.widths?e.widths:s.metadata.Unicode.widths,h=c.fof?c.fof:1,f=e.kerning?e.kerning:s.metadata.Unicode.kerning,m=f.fof?f.fof:1,b=e.doKerning!==!1,S=0,v=r.length,P=0,x=c[0]||h,k=[];for(t=0;t<v;t++)n=r.charCodeAt(t),typeof s.metadata.widthOfString=="function"?k.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(n))+d*(1e3/o)||0)/1e3):(S=b&&Rs(f[n])==="object"&&!isNaN(parseInt(f[n][P],10))?f[n][P]/m:0,k.push((c[n]||x)/h+S)),P=n;return k},ub=Jh.getStringUnitWidth=function(r,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),s=e.charSpace||this.internal.getCharSpace();return Jh.processArabic&&(r=Jh.processArabic(r)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(r,t,s)/t:Ng.apply(this,arguments).reduce(function(o,d){return o+d},0)},hb=function(r,e,t,n){for(var s=[],o=0,d=r.length,c=0;o!==d&&c+e[o]<t;)c+=e[o],o++;s.push(r.slice(0,o));var h=o;for(c=0;o!==d;)c+e[o]>n&&(s.push(r.slice(h,o)),c=0,h=o),c+=e[o],o++;return h!==o&&s.push(r.slice(h,o)),s},fb=function(r,e,t){t||(t={});var n,s,o,d,c,h,f,m=[],b=[m],S=t.textIndent||0,v=0,P=0,x=r.split(" "),k=Ng.apply(this,[" ",t])[0];if(h=t.lineIndent===-1?x[0].length+2:t.lineIndent||0){var N=Array(h).join(" "),$=[];x.map(function(z){(z=z.split(/\s*\n/)).length>1?$=$.concat(z.map(function(B,G){return(G&&B.length?`
`:"")+B})):$.push(z[0])}),x=$,h=ub.apply(this,[N,t])}for(o=0,d=x.length;o<d;o++){var I=0;if(n=x[o],h&&n[0]==`
`&&(n=n.substr(1),I=1),S+v+(P=(s=Ng.apply(this,[n,t])).reduce(function(z,B){return z+B},0))>e||I){if(P>e){for(c=hb.apply(this,[n,s,e-(S+v),e]),m.push(c.shift()),m=[c.pop()];c.length;)b.push([c.shift()]);P=s.slice(n.length-(m[0]?m[0].length:0)).reduce(function(z,B){return z+B},0)}else m=[n];b.push(m),S=P+h,v=k}else m.push(n),S+=v+P,v=k}return f=h?function(z,B){return(B?N:"")+z.join(" ")}:function(z){return z.join(" ")},b.map(f)},Jh.splitTextToSize=function(r,e,t){var n,s=(t=t||{}).fontSize||this.internal.getFontSize(),o=(function(m){if(m.widths&&m.kerning)return{widths:m.widths,kerning:m.kerning};var b=this.internal.getFont(m.fontName,m.fontStyle),S="Unicode";return b.metadata[S]?{widths:b.metadata[S].widths||{0:1},kerning:b.metadata[S].kerning||{}}:{font:b.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);n=Array.isArray(r)?r:String(r).split(/\r?\n/);var d=1*this.internal.scaleFactor*e/s;o.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/s:0,o.lineIndent=t.lineIndent;var c,h,f=[];for(c=0,h=n.length;c<h;c++)f=f.concat(fb.apply(this,[n[c],d,o]));return f},(function(r){r.__fontmetrics__=r.__fontmetrics__||{};for(var e="0123456789abcdef",t="klmnopqrstuvwxyz",n={},s={},o=0;o<16;o++)n[t[o]]=e[o],s[e[o]]=t[o];var d=function(S){return"0x"+parseInt(S,10).toString(16)},c=r.__fontmetrics__.compress=function(S){var v,P,x,k,N=["{"];for(var $ in S){if(v=S[$],isNaN(parseInt($,10))?P="'"+$+"'":($=parseInt($,10),P=(P=d($).slice(2)).slice(0,-1)+s[P.slice(-1)]),typeof v=="number")v<0?(x=d(v).slice(3),k="-"):(x=d(v).slice(2),k=""),x=k+x.slice(0,-1)+s[x.slice(-1)];else{if(Rs(v)!=="object")throw new Error("Don't know what to do with value type "+Rs(v)+".");x=c(v)}N.push(P+x)}return N.push("}"),N.join("")},h=r.__fontmetrics__.uncompress=function(S){if(typeof S!="string")throw new Error("Invalid argument passed to uncompress.");for(var v,P,x,k,N={},$=1,I=N,z=[],B="",G="",te=S.length-1,F=1;F<te;F+=1)(k=S[F])=="'"?v?(x=v.join(""),v=void 0):v=[]:v?v.push(k):k=="{"?(z.push([I,x]),I={},x=void 0):k=="}"?((P=z.pop())[0][P[1]]=I,x=void 0,I=P[0]):k=="-"?$=-1:x===void 0?n.hasOwnProperty(k)?(B+=n[k],x=parseInt(B,16)*$,$=1,B=""):B+=k:n.hasOwnProperty(k)?(G+=n[k],I[x]=parseInt(G,16)*$,$=1,x=void 0,G=""):G+=k;return N},f={codePages:["WinAnsiEncoding"],WinAnsiEncoding:h("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},m={Unicode:{Courier:f,"Courier-Bold":f,"Courier-BoldOblique":f,"Courier-Oblique":f,Helvetica:f,"Helvetica-Bold":f,"Helvetica-BoldOblique":f,"Helvetica-Oblique":f,"Times-Roman":f,"Times-Bold":f,"Times-BoldItalic":f,"Times-Italic":f}},b={Unicode:{"Courier-Oblique":h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":h("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":h("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":h("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:h("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:h("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":h("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:h("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":h("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":h("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":h("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};r.events.push(["addFont",function(S){var v=S.font,P=b.Unicode[v.postScriptName];P&&(v.metadata.Unicode={},v.metadata.Unicode.widths=P.widths,v.metadata.Unicode.kerning=P.kerning);var x=m.Unicode[v.postScriptName];x&&(v.metadata.Unicode.encoding=x,v.encoding=x.codePages[0])}])})(jn.API),(function(r){var e=function(t){for(var n=t.length,s=new Uint8Array(n),o=0;o<n;o++)s[o]=t.charCodeAt(o);return s};r.API.events.push(["addFont",function(t){var n=void 0,s=t.font,o=t.instance;if(!s.isStandardFont){if(o===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(n=o.existsFileInVFS(s.postScriptName)===!1?o.loadFile(s.postScriptName):o.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(d,c){c=/^\x00\x01\x00\x00/.test(c)?e(c):e(Fg(c)),d.metadata=r.API.TTFFont.open(c),d.metadata.Unicode=d.metadata.Unicode||{encoding:{},kerning:{},widths:[]},d.metadata.glyIdsUsed=[0]})(s,n)}}])})(jn),jn.API.addSvgAsImage=function(r,e,t,n,s,o,d,c){if(isNaN(e)||isNaN(t))throw Ys.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(s))throw Ys.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var h=document.createElement("canvas");h.width=n,h.height=s;var f=h.getContext("2d");f.fillStyle="#fff",f.fillRect(0,0,h.width,h.height);var m={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},b=this;return(ei.canvg?Promise.resolve(ei.canvg):am(()=>import("./index.es-GHmZYep8.js"),[])).catch(function(S){return Promise.reject(new Error("Could not load canvg: "+S))}).then(function(S){return S.default?S.default:S}).then(function(S){return S.fromString(f,r,m)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(S){return S.render(m)}).then(function(){b.addImage(h.toDataURL("image/jpeg",1),e,t,n,s,d,c)})},jn.API.putTotalPages=function(r){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(r,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(r,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(e,t);return this},jn.API.viewerPreferences=function(r,e){var t;r=r||{},e=e||!1;var n,s,o,d={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},c=Object.keys(d),h=[],f=0,m=0,b=0;function S(P,x){var k,N=!1;for(k=0;k<P.length;k+=1)P[k]===x&&(N=!0);return N}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(d)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,r==="reset"||e===!0){var v=c.length;for(b=0;b<v;b+=1)t[c[b]].value=t[c[b]].defaultValue,t[c[b]].explicitSet=!1}if(Rs(r)==="object"){for(s in r)if(o=r[s],S(c,s)&&o!==void 0){if(t[s].type==="boolean"&&typeof o=="boolean")t[s].value=o;else if(t[s].type==="name"&&S(t[s].valueSet,o))t[s].value=o;else if(t[s].type==="integer"&&Number.isInteger(o))t[s].value=o;else if(t[s].type==="array"){for(f=0;f<o.length;f+=1)if(n=!0,o[f].length===1&&typeof o[f][0]=="number")h.push(String(o[f]-1));else if(o[f].length>1){for(m=0;m<o[f].length;m+=1)typeof o[f][m]!="number"&&(n=!1);n===!0&&h.push([o[f][0]-1,o[f][1]-1].join(" "))}t[s].value="["+h.join(" ")+"]"}else t[s].value=t[s].defaultValue;t[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var P,x=[];for(P in t)t[P].explicitSet===!0&&(t[P].type==="name"?x.push("/"+P+" /"+t[P].value):x.push("/"+P+" "+t[P].value));x.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+x.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},(function(r){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),o=unescape(encodeURIComponent(n)),d=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),c=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),h=unescape(encodeURIComponent("</x:xmpmeta>")),f=o.length+d.length+c.length+s.length+h.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+f+" >>"),this.internal.write("stream"),this.internal.write(s+o+d+c+h),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};r.addMetadata=function(n,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}})(jn.API),(function(r){var e=r.API,t=e.pdfEscape16=function(o,d){for(var c,h=d.metadata.Unicode.widths,f=["","0","00","000","0000"],m=[""],b=0,S=o.length;b<S;++b){if(c=d.metadata.characterToGlyph(o.charCodeAt(b)),d.metadata.glyIdsUsed.push(c),d.metadata.toUnicode[c]=o.charCodeAt(b),h.indexOf(c)==-1&&(h.push(c),h.push([parseInt(d.metadata.widthOfGlyph(c),10)])),c=="0")return m.join("");c=c.toString(16),m.push(f[4-c.length],c)}return m.join("")},n=function(o){var d,c,h,f,m,b,S;for(m=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,h=[],b=0,S=(c=Object.keys(o).sort(function(v,P){return v-P})).length;b<S;b++)d=c[b],h.length>=100&&(m+=`
`+h.length+` beginbfchar
`+h.join(`
`)+`
endbfchar`,h=[]),o[d]!==void 0&&o[d]!==null&&typeof o[d].toString=="function"&&(f=("0000"+o[d].toString(16)).slice(-4),d=("0000"+(+d).toString(16)).slice(-4),h.push("<"+d+"><"+f+">"));return h.length&&(m+=`
`+h.length+` beginbfchar
`+h.join(`
`)+`
endbfchar
`),m+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(o){(function(d){var c=d.font,h=d.out,f=d.newObject,m=d.putStream;if(c.metadata instanceof r.API.TTFFont&&c.encoding==="Identity-H"){for(var b=c.metadata.Unicode.widths,S=c.metadata.subset.encode(c.metadata.glyIdsUsed,1),v="",P=0;P<S.length;P++)v+=String.fromCharCode(S[P]);var x=f();m({data:v,addLength1:!0,objectId:x}),h("endobj");var k=f();m({data:n(c.metadata.toUnicode),addLength1:!0,objectId:k}),h("endobj");var N=f();h("<<"),h("/Type /FontDescriptor"),h("/FontName /"+nf(c.fontName)),h("/FontFile2 "+x+" 0 R"),h("/FontBBox "+r.API.PDFObject.convert(c.metadata.bbox)),h("/Flags "+c.metadata.flags),h("/StemV "+c.metadata.stemV),h("/ItalicAngle "+c.metadata.italicAngle),h("/Ascent "+c.metadata.ascender),h("/Descent "+c.metadata.decender),h("/CapHeight "+c.metadata.capHeight),h(">>"),h("endobj");var $=f();h("<<"),h("/Type /Font"),h("/BaseFont /"+nf(c.fontName)),h("/FontDescriptor "+N+" 0 R"),h("/W "+r.API.PDFObject.convert(b)),h("/CIDToGIDMap /Identity"),h("/DW 1000"),h("/Subtype /CIDFontType2"),h("/CIDSystemInfo"),h("<<"),h("/Supplement 0"),h("/Registry (Adobe)"),h("/Ordering ("+c.encoding+")"),h(">>"),h(">>"),h("endobj"),c.objectNumber=f(),h("<<"),h("/Type /Font"),h("/Subtype /Type0"),h("/ToUnicode "+k+" 0 R"),h("/BaseFont /"+nf(c.fontName)),h("/Encoding /"+c.encoding),h("/DescendantFonts ["+$+" 0 R]"),h(">>"),h("endobj"),c.isAlreadyPutted=!0}})(o)}]),e.events.push(["putFont",function(o){(function(d){var c=d.font,h=d.out,f=d.newObject,m=d.putStream;if(c.metadata instanceof r.API.TTFFont&&c.encoding==="WinAnsiEncoding"){for(var b=c.metadata.rawData,S="",v=0;v<b.length;v++)S+=String.fromCharCode(b[v]);var P=f();m({data:S,addLength1:!0,objectId:P}),h("endobj");var x=f();m({data:n(c.metadata.toUnicode),addLength1:!0,objectId:x}),h("endobj");var k=f();h("<<"),h("/Descent "+c.metadata.decender),h("/CapHeight "+c.metadata.capHeight),h("/StemV "+c.metadata.stemV),h("/Type /FontDescriptor"),h("/FontFile2 "+P+" 0 R"),h("/Flags 96"),h("/FontBBox "+r.API.PDFObject.convert(c.metadata.bbox)),h("/FontName /"+nf(c.fontName)),h("/ItalicAngle "+c.metadata.italicAngle),h("/Ascent "+c.metadata.ascender),h(">>"),h("endobj"),c.objectNumber=f();for(var N=0;N<c.metadata.hmtx.widths.length;N++)c.metadata.hmtx.widths[N]=parseInt(c.metadata.hmtx.widths[N]*(1e3/c.metadata.head.unitsPerEm));h("<</Subtype/TrueType/Type/Font/ToUnicode "+x+" 0 R/BaseFont/"+nf(c.fontName)+"/FontDescriptor "+k+" 0 R/Encoding/"+c.encoding+" /FirstChar 29 /LastChar 255 /Widths "+r.API.PDFObject.convert(c.metadata.hmtx.widths)+">>"),h("endobj"),c.isAlreadyPutted=!0}})(o)}]);var s=function(o){var d,c=o.text||"",h=o.x,f=o.y,m=o.options||{},b=o.mutex||{},S=b.pdfEscape,v=b.activeFontKey,P=b.fonts,x=v,k="",N=0,$="",I=P[x].encoding;if(P[x].encoding!=="Identity-H")return{text:c,x:h,y:f,options:m,mutex:b};for($=c,x=v,Array.isArray(c)&&($=c[0]),N=0;N<$.length;N+=1)P[x].metadata.hasOwnProperty("cmap")&&(d=P[x].metadata.cmap.unicode.codeMap[$[N].charCodeAt(0)]),d||$[N].charCodeAt(0)<256&&P[x].metadata.hasOwnProperty("Unicode")?k+=$[N]:k+="";var z="";return parseInt(x.slice(1))<14||I==="WinAnsiEncoding"?z=S(k,x).split("").map(function(B){return B.charCodeAt(0).toString(16)}).join(""):I==="Identity-H"&&(z=t(k,P[x])),b.isHex=!0,{text:z,x:h,y:f,options:m,mutex:b}};e.events.push(["postProcessText",function(o){var d=o.text||"",c=[],h={text:d,x:o.x,y:o.y,options:o.options,mutex:o.mutex};if(Array.isArray(d)){var f=0;for(f=0;f<d.length;f+=1)Array.isArray(d[f])&&d[f].length===3?c.push([s(Object.assign({},h,{text:d[f][0]})).text,d[f][1],d[f][2]]):c.push(s(Object.assign({},h,{text:d[f]})).text);o.text=c}else o.text=s(Object.assign({},h,{text:d})).text}])})(jn),(function(r){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};r.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},r.addFileToVFS=function(t,n){return e.call(this),this.internal.vFS[t]=n,this},r.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}})(jn.API),(function(r){r.__bidiEngine__=r.prototype.__bidiEngine__=function(n){var s,o,d,c,h,f,m,b=e,S=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],v=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],P={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},x={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},k=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],N=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),$=!1,I=0;this.__bidiEngine__={};var z=function(M){var T=M.charCodeAt(),R=T>>8,Z=x[R];return Z!==void 0?b[256*Z+(255&T)]:R===252||R===253?"AL":N.test(R)?"L":R===8?"R":"N"},B=function(M){for(var T,R=0;R<M.length;R++){if((T=z(M.charAt(R)))==="L")return!1;if(T==="R")return!0}return!1},G=function(M,T,R,Z){var se,V,ee,ae,Ce=T[Z];switch(Ce){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":$=!1;break;case"N":case"AN":break;case"EN":$&&(Ce="AN");break;case"AL":$=!0,Ce="R";break;case"WS":case"BN":Ce="N";break;case"CS":Z<1||Z+1>=T.length||(se=R[Z-1])!=="EN"&&se!=="AN"||(V=T[Z+1])!=="EN"&&V!=="AN"?Ce="N":$&&(V="AN"),Ce=V===se?V:"N";break;case"ES":Ce=(se=Z>0?R[Z-1]:"B")==="EN"&&Z+1<T.length&&T[Z+1]==="EN"?"EN":"N";break;case"ET":if(Z>0&&R[Z-1]==="EN"){Ce="EN";break}if($){Ce="N";break}for(ee=Z+1,ae=T.length;ee<ae&&T[ee]==="ET";)ee++;Ce=ee<ae&&T[ee]==="EN"?"EN":"N";break;case"NSM":if(d&&!c){for(ae=T.length,ee=Z+1;ee<ae&&T[ee]==="NSM";)ee++;if(ee<ae){var xe=M[Z],J=xe>=1425&&xe<=2303||xe===64286;if(se=T[ee],J&&(se==="R"||se==="AL")){Ce="R";break}}}Ce=Z<1||(se=T[Z-1])==="B"?"N":R[Z-1];break;case"B":$=!1,s=!0,Ce=I;break;case"S":o=!0,Ce="N"}return Ce},te=function(M,T,R){var Z=M.split("");return R&&F(Z,R,{hiLevel:I}),Z.reverse(),T&&T.reverse(),Z.join("")},F=function(M,T,R){var Z,se,V,ee,ae,Ce=-1,xe=M.length,J=0,D=[],W=I?v:S,K=[];for($=!1,s=!1,o=!1,se=0;se<xe;se++)K[se]=z(M[se]);for(V=0;V<xe;V++){if(ae=J,D[V]=G(M,K,D,V),Z=240&(J=W[ae][P[D[V]]]),J&=15,T[V]=ee=W[J][5],Z>0)if(Z===16){for(se=Ce;se<V;se++)T[se]=1;Ce=-1}else Ce=-1;if(W[J][6])Ce===-1&&(Ce=V);else if(Ce>-1){for(se=Ce;se<V;se++)T[se]=ee;Ce=-1}K[V]==="B"&&(T[V]=0),R.hiLevel|=ee}o&&(function(ue,Te,Pe){for(var Ve=0;Ve<Pe;Ve++)if(ue[Ve]==="S"){Te[Ve]=I;for(var De=Ve-1;De>=0&&ue[De]==="WS";De--)Te[De]=I}})(K,T,xe)},H=function(M,T,R,Z,se){if(!(se.hiLevel<M)){if(M===1&&I===1&&!s)return T.reverse(),void(R&&R.reverse());for(var V,ee,ae,Ce,xe=T.length,J=0;J<xe;){if(Z[J]>=M){for(ae=J+1;ae<xe&&Z[ae]>=M;)ae++;for(Ce=J,ee=ae-1;Ce<ee;Ce++,ee--)V=T[Ce],T[Ce]=T[ee],T[ee]=V,R&&(V=R[Ce],R[Ce]=R[ee],R[ee]=V);J=ae}J++}}},Q=function(M,T,R){var Z=M.split(""),se={hiLevel:I};return R||(R=[]),F(Z,R,se),(function(V,ee,ae){if(ae.hiLevel!==0&&m)for(var Ce,xe=0;xe<V.length;xe++)ee[xe]===1&&(Ce=k.indexOf(V[xe]))>=0&&(V[xe]=k[Ce+1])})(Z,R,se),H(2,Z,T,R,se),H(1,Z,T,R,se),Z.join("")};return this.__bidiEngine__.doBidiReorder=function(M,T,R){if((function(se,V){if(V)for(var ee=0;ee<se.length;ee++)V[ee]=ee;c===void 0&&(c=B(se)),f===void 0&&(f=B(se))})(M,T),d||!h||f)if(d&&h&&c^f)I=c?1:0,M=te(M,T,R);else if(!d&&h&&f)I=c?1:0,M=Q(M,T,R),M=te(M,T);else if(!d||c||h||f){if(d&&!h&&c^f)M=te(M,T),c?(I=0,M=Q(M,T,R)):(I=1,M=Q(M,T,R),M=te(M,T));else if(d&&c&&!h&&f)I=1,M=Q(M,T,R),M=te(M,T);else if(!d&&!h&&c^f){var Z=m;c?(I=1,M=Q(M,T,R),I=0,m=!1,M=Q(M,T,R),m=Z):(I=0,M=Q(M,T,R),M=te(M,T),I=1,m=!1,M=Q(M,T,R),m=Z,M=te(M,T))}}else I=0,M=Q(M,T,R);else I=c?1:0,M=Q(M,T,R);return M},this.__bidiEngine__.setOptions=function(M){M&&(d=M.isInputVisual,h=M.isOutputVisual,c=M.isInputRtl,f=M.isOutputRtl,m=M.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new r.__bidiEngine__({isInputVisual:!0});r.API.events.push(["postProcessText",function(n){var s=n.text;n.x,n.y;var o=n.options||{};n.mutex,o.lang;var d=[];if(o.isInputVisual=typeof o.isInputVisual!="boolean"||o.isInputVisual,t.setOptions(o),Object.prototype.toString.call(s)==="[object Array]"){var c=0;for(d=[],c=0;c<s.length;c+=1)Object.prototype.toString.call(s[c])==="[object Array]"?d.push([t.doBidiReorder(s[c][0]),s[c][1],s[c][2]]):d.push([t.doBidiReorder(s[c])]);n.text=d}else n.text=t.doBidiReorder(s);t.setOptions({isInputVisual:!0})}])})(jn),jn.API.TTFFont=(function(){function r(e){var t;if(this.rawData=e,t=this.contents=new Lu(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new l3(this),this.registerTTF()}return r.open=function(e){return new r(e)},r.prototype.parse=function(){return this.directory=new YA(this.contents),this.head=new KA(this),this.name=new t3(this),this.cmap=new G2(this),this.toUnicode={},this.hhea=new ZA(this),this.maxp=new n3(this),this.hmtx=new i3(this),this.post=new QA(this),this.os2=new JA(this),this.loca=new o3(this),this.glyf=new s3(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},r.prototype.registerTTF=function(){var e,t,n,s,o;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var d,c,h,f;for(f=[],d=0,c=(h=this.bbox).length;d<c;d++)e=h[d],f.push(Math.round(e*this.scaleFactor));return f}).call(this),this.stemV=0,this.post.exists?(n=255&(s=this.post.italic_angle),32768&(t=s>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(o=this.familyClass)===1||o===2||o===3||o===4||o===5||o===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},r.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},r.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},r.prototype.widthOfString=function(e,t,n){var s,o,d,c;for(d=0,o=0,c=(e=""+e).length;0<=c?o<c:o>c;o=0<=c?++o:--o)s=e.charCodeAt(o),d+=this.widthOfGlyph(this.characterToGlyph(s))+n*(1e3/t)||0;return d*(t/1e3)},r.prototype.lineHeight=function(e,t){var n;return t==null&&(t=!1),n=t?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},r})();var ed,Lu=(function(){function r(e){this.data=e??[],this.pos=0,this.length=this.data.length}return r.prototype.readByte=function(){return this.data[this.pos++]},r.prototype.writeByte=function(e){return this.data[this.pos++]=e},r.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},r.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},r.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},r.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},r.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},r.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},r.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},r.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},r.prototype.readString=function(e){var t,n;for(n=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)n[t]=String.fromCharCode(this.readByte());return n.join("")},r.prototype.writeString=function(e){var t,n,s;for(s=[],t=0,n=e.length;0<=n?t<n:t>n;t=0<=n?++t:--t)s.push(this.writeByte(e.charCodeAt(t)));return s},r.prototype.readShort=function(){return this.readInt16()},r.prototype.writeShort=function(e){return this.writeInt16(e)},r.prototype.readLongLong=function(){var e,t,n,s,o,d,c,h;return e=this.readByte(),t=this.readByte(),n=this.readByte(),s=this.readByte(),o=this.readByte(),d=this.readByte(),c=this.readByte(),h=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^n)+4294967296*(255^s)+16777216*(255^o)+65536*(255^d)+256*(255^c)+(255^h)+1):72057594037927940*e+281474976710656*t+1099511627776*n+4294967296*s+16777216*o+65536*d+256*c+h},r.prototype.writeLongLong=function(e){var t,n;return t=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},r.prototype.readInt=function(){return this.readInt32()},r.prototype.writeInt=function(e){return this.writeInt32(e)},r.prototype.read=function(e){var t,n;for(t=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)t.push(this.readByte());return t},r.prototype.write=function(e){var t,n,s,o;for(o=[],n=0,s=e.length;n<s;n++)t=e[n],o.push(this.writeByte(t));return o},r})(),YA=(function(){var r;function e(t){var n,s,o;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},s=0,o=this.tableCount;0<=o?s<o:s>o;s=0<=o?++s:--s)n={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(t){var n,s,o,d,c,h,f,m,b,S,v,P,x;for(x in v=Object.keys(t).length,h=Math.log(2),b=16*Math.floor(Math.log(v)/h),d=Math.floor(b/h),m=16*v-b,(s=new Lu).writeInt(this.scalarType),s.writeShort(v),s.writeShort(b),s.writeShort(d),s.writeShort(m),o=16*v,f=s.pos+o,c=null,P=[],t)for(S=t[x],s.writeString(x),s.writeInt(r(S)),s.writeInt(f),s.writeInt(S.length),P=P.concat(S),x==="head"&&(c=f),f+=S.length;f%4;)P.push(0),f++;return s.write(P),n=2981146554-r(s.data),s.pos=c+8,s.writeUInt32(n),s.data},r=function(t){var n,s,o,d;for(t=Y2.call(t);t.length%4;)t.push(0);for(o=new Lu(t),s=0,n=0,d=t.length;n<d;n=n+=4)s+=o.readUInt32();return 4294967295&s},e})(),XA={}.hasOwnProperty,Nd=function(r,e){for(var t in e)XA.call(e,t)&&(r[t]=e[t]);function n(){this.constructor=r}return n.prototype=e.prototype,r.prototype=new n,r.__super__=e.prototype,r};ed=(function(){function r(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return r.prototype.parse=function(){},r.prototype.encode=function(){},r.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},r})();var KA=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return Nd(r,ed),r.prototype.tag="head",r.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},r.prototype.encode=function(e){var t;return(t=new Lu).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},r})(),Sb=(function(){function r(e,t){var n,s,o,d,c,h,f,m,b,S,v,P,x,k,N,$,I;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),b=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(h=0;h<256;++h)this.codeMap[h]=e.readByte();break;case 4:for(v=e.readUInt16(),S=v/2,e.pos+=6,o=(function(){var z,B;for(B=[],h=z=0;0<=S?z<S:z>S;h=0<=S?++z:--z)B.push(e.readUInt16());return B})(),e.pos+=2,x=(function(){var z,B;for(B=[],h=z=0;0<=S?z<S:z>S;h=0<=S?++z:--z)B.push(e.readUInt16());return B})(),f=(function(){var z,B;for(B=[],h=z=0;0<=S?z<S:z>S;h=0<=S?++z:--z)B.push(e.readUInt16());return B})(),m=(function(){var z,B;for(B=[],h=z=0;0<=S?z<S:z>S;h=0<=S?++z:--z)B.push(e.readUInt16());return B})(),s=(this.length-e.pos+this.offset)/2,c=(function(){var z,B;for(B=[],h=z=0;0<=s?z<s:z>s;h=0<=s?++z:--z)B.push(e.readUInt16());return B})(),h=N=0,I=o.length;N<I;h=++N)for(k=o[h],n=$=P=x[h];P<=k?$<=k:$>=k;n=P<=k?++$:--$)m[h]===0?d=n+f[h]:(d=c[m[h]/2+(n-P)-(S-h)]||0)!==0&&(d+=f[h]),this.codeMap[n]=65535&d}e.pos=b}return r.encode=function(e,t){var n,s,o,d,c,h,f,m,b,S,v,P,x,k,N,$,I,z,B,G,te,F,H,Q,M,T,R,Z,se,V,ee,ae,Ce,xe,J,D,W,K,ue,Te,Pe,Ve,De,et,ot,at;switch(Z=new Lu,d=Object.keys(e).sort(function(ht,xt){return ht-xt}),t){case"macroman":for(x=0,k=(function(){var ht=[];for(P=0;P<256;++P)ht.push(0);return ht})(),$={0:0},o={},se=0,Ce=d.length;se<Ce;se++)$[De=e[s=d[se]]]==null&&($[De]=++x),o[s]={old:e[s],new:$[e[s]]},k[s]=$[e[s]];return Z.writeUInt16(1),Z.writeUInt16(0),Z.writeUInt32(12),Z.writeUInt16(0),Z.writeUInt16(262),Z.writeUInt16(0),Z.write(k),{charMap:o,subtable:Z.data,maxGlyphID:x+1};case"unicode":for(T=[],b=[],I=0,$={},n={},N=f=null,V=0,xe=d.length;V<xe;V++)$[B=e[s=d[V]]]==null&&($[B]=++I),n[s]={old:B,new:$[B]},c=$[B]-s,N!=null&&c===f||(N&&b.push(N),T.push(s),f=c),N=s;for(N&&b.push(N),b.push(65535),T.push(65535),Q=2*(H=T.length),F=2*Math.pow(Math.log(H)/Math.LN2,2),S=Math.log(F/2)/Math.LN2,te=2*H-F,h=[],G=[],v=[],P=ee=0,J=T.length;ee<J;P=++ee){if(M=T[P],m=b[P],M===65535){h.push(0),G.push(0);break}if(M-(R=n[M].new)>=32768)for(h.push(0),G.push(2*(v.length+H-P)),s=ae=M;M<=m?ae<=m:ae>=m;s=M<=m?++ae:--ae)v.push(n[s].new);else h.push(R-M),G.push(0)}for(Z.writeUInt16(3),Z.writeUInt16(1),Z.writeUInt32(12),Z.writeUInt16(4),Z.writeUInt16(16+8*H+2*v.length),Z.writeUInt16(0),Z.writeUInt16(Q),Z.writeUInt16(F),Z.writeUInt16(S),Z.writeUInt16(te),Pe=0,D=b.length;Pe<D;Pe++)s=b[Pe],Z.writeUInt16(s);for(Z.writeUInt16(0),Ve=0,W=T.length;Ve<W;Ve++)s=T[Ve],Z.writeUInt16(s);for(et=0,K=h.length;et<K;et++)c=h[et],Z.writeUInt16(c);for(ot=0,ue=G.length;ot<ue;ot++)z=G[ot],Z.writeUInt16(z);for(at=0,Te=v.length;at<Te;at++)x=v[at],Z.writeUInt16(x);return{charMap:n,subtable:Z.data,maxGlyphID:I+1}}},r})(),G2=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return Nd(r,ed),r.prototype.tag="cmap",r.prototype.parse=function(e){var t,n,s;for(e.pos=this.offset,this.version=e.readUInt16(),s=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=s?n<s:n>s;n=0<=s?++n:--n)t=new Sb(e,this.offset),this.tables.push(t),t.isUnicode&&this.unicode==null&&(this.unicode=t);return!0},r.encode=function(e,t){var n,s;return t==null&&(t="macroman"),n=Sb.encode(e,t),(s=new Lu).writeUInt16(0),s.writeUInt16(1),n.table=s.data.concat(n.subtable),n},r})(),ZA=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return Nd(r,ed),r.prototype.tag="hhea",r.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},r})(),JA=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return Nd(r,ed),r.prototype.tag="OS/2",r.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var t,n;for(n=[],t=0;t<10;++t)n.push(e.readByte());return n})(),this.charRange=(function(){var t,n;for(n=[],t=0;t<4;++t)n.push(e.readInt());return n})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var t,n;for(n=[],t=0;t<2;t=++t)n.push(e.readInt());return n})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},r})(),QA=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return Nd(r,ed),r.prototype.tag="post",r.prototype.parse=function(e){var t,n,s;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var o;for(n=e.readUInt16(),this.glyphNameIndex=[],o=0;0<=n?o<n:o>n;o=0<=n?++o:--o)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],s=[];e.pos<this.offset+this.length;)t=e.readByte(),s.push(this.names.push(e.readString(t)));return s;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=(function(){var d,c,h;for(h=[],o=d=0,c=this.file.maxp.numGlyphs;0<=c?d<c:d>c;o=0<=c?++d:--d)h.push(e.readUInt32());return h}).call(this)}},r})(),e3=function(r,e){this.raw=r,this.length=r.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},t3=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return Nd(r,ed),r.prototype.tag="name",r.prototype.parse=function(e){var t,n,s,o,d,c,h,f,m,b,S;for(e.pos=this.offset,e.readShort(),t=e.readShort(),c=e.readShort(),n=[],o=0;0<=t?o<t:o>t;o=0<=t?++o:--o)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+c+e.readShort()});for(h={},o=m=0,b=n.length;m<b;o=++m)s=n[o],e.pos=s.offset,f=e.readString(s.length),d=new e3(f,s),h[S=s.nameID]==null&&(h[S]=[]),h[s.nameID].push(d);this.strings=h,this.copyright=h[0],this.fontFamily=h[1],this.fontSubfamily=h[2],this.uniqueSubfamily=h[3],this.fontName=h[4],this.version=h[5];try{this.postscriptName=h[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=h[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=h[7],this.manufacturer=h[8],this.designer=h[9],this.description=h[10],this.vendorUrl=h[11],this.designerUrl=h[12],this.license=h[13],this.licenseUrl=h[14],this.preferredFamily=h[15],this.preferredSubfamily=h[17],this.compatibleFull=h[18],this.sampleText=h[19]},r})(),n3=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return Nd(r,ed),r.prototype.tag="maxp",r.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},r})(),i3=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return Nd(r,ed),r.prototype.tag="hmtx",r.prototype.parse=function(e){var t,n,s,o,d,c,h;for(e.pos=this.offset,this.metrics=[],t=0,c=this.file.hhea.numberOfMetrics;0<=c?t<c:t>c;t=0<=c?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var f,m;for(m=[],t=f=0;0<=s?f<s:f>s;t=0<=s?++f:--f)m.push(e.readInt16());return m})(),this.widths=(function(){var f,m,b,S;for(S=[],f=0,m=(b=this.metrics).length;f<m;f++)o=b[f],S.push(o.advance);return S}).call(this),n=this.widths[this.widths.length-1],h=[],t=d=0;0<=s?d<s:d>s;t=0<=s?++d:--d)h.push(this.widths.push(n));return h},r.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},r})(),Y2=[].slice,s3=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return Nd(r,ed),r.prototype.tag="glyf",r.prototype.parse=function(){return this.cache={}},r.prototype.glyphFor=function(e){var t,n,s,o,d,c,h,f,m,b;return e in this.cache?this.cache[e]:(o=this.file.loca,t=this.file.contents,n=o.indexOf(e),(s=o.lengthOf(e))===0?this.cache[e]=null:(t.pos=this.offset+n,d=(c=new Lu(t.read(s))).readShort(),f=c.readShort(),b=c.readShort(),h=c.readShort(),m=c.readShort(),this.cache[e]=d===-1?new a3(c,f,b,h,m):new r3(c,d,f,b,h,m),this.cache[e]))},r.prototype.encode=function(e,t,n){var s,o,d,c,h;for(d=[],o=[],c=0,h=t.length;c<h;c++)s=e[t[c]],o.push(d.length),s&&(d=d.concat(s.encode(n)));return o.push(d.length),{table:d,offsets:o}},r})(),r3=(function(){function r(e,t,n,s,o,d){this.raw=e,this.numberOfContours=t,this.xMin=n,this.yMin=s,this.xMax=o,this.yMax=d,this.compound=!1}return r.prototype.encode=function(){return this.raw.data},r})(),a3=(function(){function r(e,t,n,s,o){var d,c;for(this.raw=e,this.xMin=t,this.yMin=n,this.xMax=s,this.yMax=o,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],d=this.raw;c=d.readShort(),this.glyphOffsets.push(d.pos),this.glyphIDs.push(d.readUInt16()),32&c;)d.pos+=1&c?4:2,128&c?d.pos+=8:64&c?d.pos+=4:8&c&&(d.pos+=2)}return r.prototype.encode=function(){var e,t,n;for(t=new Lu(Y2.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)t.pos=this.glyphOffsets[e];return t.data},r})(),o3=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return Nd(r,ed),r.prototype.tag="loca",r.prototype.parse=function(e){var t,n;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=t===0?(function(){var s,o;for(o=[],n=0,s=this.length;n<s;n+=2)o.push(2*e.readUInt16());return o}).call(this):(function(){var s,o;for(o=[],n=0,s=this.length;n<s;n+=4)o.push(e.readUInt32());return o}).call(this)},r.prototype.indexOf=function(e){return this.offsets[e]},r.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},r.prototype.encode=function(e,t){for(var n=new Uint32Array(this.offsets.length),s=0,o=0,d=0;d<n.length;++d)if(n[d]=s,o<t.length&&t[o]==d){++o,n[d]=s;var c=this.offsets[d],h=this.offsets[d+1]-c;h>0&&(s+=h)}for(var f=new Array(4*n.length),m=0;m<n.length;++m)f[4*m+3]=255&n[m],f[4*m+2]=(65280&n[m])>>8,f[4*m+1]=(16711680&n[m])>>16,f[4*m]=(4278190080&n[m])>>24;return f},r})(),l3=(function(){function r(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return r.prototype.generateCmap=function(){var e,t,n,s,o;for(t in s=this.font.cmap.tables[0].codeMap,e={},o=this.subset)n=o[t],e[t]=s[n];return e},r.prototype.glyphsFor=function(e){var t,n,s,o,d,c,h;for(s={},d=0,c=e.length;d<c;d++)s[o=e[d]]=this.font.glyf.glyphFor(o);for(o in t=[],s)(n=s[o])!=null&&n.compound&&t.push.apply(t,n.glyphIDs);if(t.length>0)for(o in h=this.glyphsFor(t))n=h[o],s[o]=n;return s},r.prototype.encode=function(e,t){var n,s,o,d,c,h,f,m,b,S,v,P,x,k,N;for(s in n=G2.encode(this.generateCmap(),"unicode"),d=this.glyphsFor(e),v={0:0},N=n.charMap)v[(h=N[s]).old]=h.new;for(P in S=n.maxGlyphID,d)P in v||(v[P]=S++);return m=(function($){var I,z;for(I in z={},$)z[$[I]]=I;return z})(v),b=Object.keys(m).sort(function($,I){return $-I}),x=(function(){var $,I,z;for(z=[],$=0,I=b.length;$<I;$++)c=b[$],z.push(m[c]);return z})(),o=this.font.glyf.encode(d,x,v),f=this.font.loca.encode(o.offsets,x),k={cmap:this.font.cmap.raw(),glyf:o.table,loca:f,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(k["OS/2"]=this.font.os2.raw()),this.font.directory.encode(k)},r})();jn.API.PDFObject=(function(){var r;function e(){}return r=function(t,n){return(Array(n+1).join("0")+t).slice(-n)},e.convert=function(t){var n,s,o,d;if(Array.isArray(t))return"["+(function(){var c,h,f;for(f=[],c=0,h=t.length;c<h;c++)n=t[c],f.push(e.convert(n));return f})().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t?.isString)return"("+t+")";if(t instanceof Date)return"(D:"+r(t.getUTCFullYear(),4)+r(t.getUTCMonth(),2)+r(t.getUTCDate(),2)+r(t.getUTCHours(),2)+r(t.getUTCMinutes(),2)+r(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(s in o=["<<"],t)d=t[s],o.push("/"+s+" "+e.convert(d));return o.push(">>"),o.join(`
`)}return""+t},e})();const Nm=r=>{const e=gy[r];return!e||!e.prefix||e.prefix.length<1?"?":e.prefix[0].substring(0,1).toUpperCase()},Mc=(r,e,t)=>({color:e,size:t}),Ab=(r,e,t)=>{},Sr=(r,e,t,n)=>({color:t,size:n}),Qh=(r,e,t,n)=>{},c3=()=>{const r=new Map,e={top:"#0072B2",bottom:"#56B4E9"},t={top:18,bottom:18},n={top:"#FFFF00",bottom:"#FFFF00"},s={top:18,bottom:18},o={top:"#AA4499",bottom:"#F781BF"},d={top:6,bottom:6},c={top:"#6A3D9A",bottom:"#9467BD"},h={top:18,bottom:18};return r.set("select",{id:"select",name:"Select",toolType:"select",icon:"",shortcut:"S",tooltip:"Select objects or groups",colorReflective:!1,settings:Mc("select","#ff0000",10),layerSettings:new Map([["top",Sr("select","top","#ff0000",10)],["bottom",Sr("select","bottom","#ff0000",10)]])}),r.set("via",{id:"via",name:"Via",toolType:"draw",drawingMode:"via",icon:"",shortcut:"V",tooltip:"Place via connection",colorReflective:!0,settings:Mc("via",Q0,nm.DEFAULT_SIZE),layerSettings:new Map([["top",Sr("via","top",Q0,nm.DEFAULT_SIZE)],["bottom",Sr("via","bottom",Q0,nm.DEFAULT_SIZE)]]),defaultLayer:"top"}),r.set("pad",{id:"pad",name:"Pad",toolType:"draw",drawingMode:"pad",icon:"",shortcut:"P",tooltip:"Place pad connection",colorReflective:!0,settings:Mc("pad",Zw,18),layerSettings:new Map([["top",Sr("pad","top",e.top,t.top)],["bottom",Sr("pad","bottom",e.bottom,t.bottom)]]),defaultLayer:"top"}),r.set("testPoint",{id:"testPoint",name:"Test Point",toolType:"draw",drawingMode:"testPoint",icon:"",shortcut:"Y",tooltip:"Place test point",colorReflective:!0,settings:Mc("testPoint","#FFFF00",18),layerSettings:new Map([["top",Sr("testPoint","top",n.top,s.top)],["bottom",Sr("testPoint","bottom",n.bottom,s.bottom)]]),defaultLayer:"top"}),r.set("trace",{id:"trace",name:"Trace",toolType:"draw",drawingMode:"trace",icon:"",shortcut:"T",tooltip:"Draw copper traces",colorReflective:!0,settings:Mc("trace",Xw,6),layerSettings:new Map([["top",Sr("trace","top",o.top,d.top)],["bottom",Sr("trace","bottom",o.bottom,d.bottom)]]),defaultLayer:"top"}),r.set("component",{id:"component",name:"Component",toolType:"component",icon:"",shortcut:"C",tooltip:"Place component",colorReflective:!0,settings:Mc("component",Kw,py.DEFAULT_SIZE),layerSettings:new Map([["top",Sr("component","top",c.top,h.top)],["bottom",Sr("component","bottom",c.bottom,h.bottom)]]),defaultLayer:"top"}),r.set("componentConnection",{id:"componentConnection",name:"Component Connections",toolType:"componentConnection",icon:"",shortcut:"",tooltip:"Component connection lines",colorReflective:!1,settings:Mc("componentConnection","#E69F00",3),layerSettings:new Map([["top",Sr("componentConnection","top","#E69F00",3)],["bottom",Sr("componentConnection","bottom","#E69F00",3)]])}),r.set("power",{id:"power",name:"Power",toolType:"power",icon:"",shortcut:"B",tooltip:"Place power node",colorReflective:!0,settings:Mc("power",tm,18),layerSettings:new Map([["top",Sr("power","top",tm,18)],["bottom",Sr("power","bottom",tm,18)]]),defaultLayer:"top"}),r.set("ground",{id:"ground",name:"Ground",toolType:"ground",icon:"",shortcut:"G",tooltip:"Place ground symbol",colorReflective:!0,settings:Mc("ground",em,18),layerSettings:new Map([["top",Sr("ground","top",em,18)],["bottom",Sr("ground","bottom",em,18)]]),defaultLayer:"top"}),r.set("erase",{id:"erase",name:"Erase",toolType:"erase",icon:"",shortcut:"E",tooltip:"Erase objects",colorReflective:!1,settings:Mc("erase","#f5a3b3",18),layerSettings:new Map([["top",Sr("erase","top","#f5a3b3",18)],["bottom",Sr("erase","bottom","#f5a3b3",18)]])}),r.set("pan",{id:"pan",name:"Move",toolType:"pan",icon:"",shortcut:"H",tooltip:"Pan the view",colorReflective:!1,settings:Mc("pan","#ff0000",10),layerSettings:new Map([["top",Sr("pan","top","#ff0000",10)],["bottom",Sr("pan","bottom","#ff0000",10)]])}),r.set("magnify",{id:"magnify",name:"Zoom",toolType:"magnify",icon:"+",shortcut:"M",tooltip:"Magnify",colorReflective:!1,settings:Mc("magnify","#ff0000",10),layerSettings:new Map([["top",Sr("magnify","top","#ff0000",10)],["bottom",Sr("magnify","bottom","#ff0000",10)]])}),r},Cb={via:{color:"#2CA02C",size:18},padTop:{color:"#0072B2",size:18},padBottom:{color:"#56B4E9",size:18},testPointTop:{color:"#FFFF00",size:18},testPointBottom:{color:"#FFFF00",size:18},traceTop:{color:"#AA4499",size:6},traceBottom:{color:"#F781BF",size:6},componentTop:{color:"#6A3D9A",size:18},componentBottom:{color:"#9467BD",size:18},power:{color:"#ff0000",size:18},ground:{color:"#000000",size:18}},np={via:"Via",padTop:"Pad (Top)",padBottom:"Pad (Bottom)",testPointTop:"Test Point (Top)",testPointBottom:"Test Point (Bottom)",traceTop:"Trace (Top)",traceBottom:"Trace (Bottom)",componentTop:"Component (Top)",componentBottom:"Component (Bottom)",power:"Power",ground:"Ground"};class d3{instances=new Map;listeners=new Map;initialize(){for(const e of Object.keys(Cb)){const t=Cb[e];this.instances.set(e,{id:e,name:np[e],color:t.color,size:t.size}),this.listeners.set(e,new Set)}}initializeFromProject(e){if(this.initialize(),e?.toolInstances)for(const[t,n]of Object.entries(e.toolInstances))this.instances.has(t)&&this.instances.set(t,n)}get(e){const t=this.instances.get(e);if(!t)throw new Error(`Tool instance ${e} not found`);return t}getColor(e){const t=this.instances.get(e);if(!t)throw new Error(`Tool instance ${e} not found`);const n=np[e];return console.log(`${n}, returning color value=${t.color}`),t.color}getSize(e){const t=this.instances.get(e);if(!t)throw new Error(`Tool instance ${e} not found`);const n=np[e];return console.log(`${n}, returning size value=${t.size}`),t.size}setColor(e,t){const n=this.instances.get(e);if(n){const s=np[e];console.log(`${s}, setting color value=${t}`),n.color=t,this.notifyListeners(e)}}setSize(e,t){const n=this.instances.get(e);if(n){const s=np[e];console.log(`${s}, setting size value=${t}`),n.size=t,this.notifyListeners(e)}}getAll(){const e={};for(const[t,n]of this.instances.entries())e[t]=n;return e}subscribe(e,t){const n=this.listeners.get(e);return n?(n.add(t),()=>{n.delete(t)}):()=>{}}notifyListeners(e){const t=this.listeners.get(e);t&&t.forEach(n=>n())}}const Mn=new d3;Mn.initialize();function jg(r,e){switch(r){case"via":return"via";case"pad":return e==="bottom"?"padBottom":"padTop";case"testPoint":return e==="bottom"?"testPointBottom":"testPointTop";case"trace":return e==="bottom"?"traceBottom":"traceTop";case"component":return e==="bottom"?"componentBottom":"componentTop";case"power":return"power";case"ground":return"ground";default:throw new Error(`Unknown tool: ${r}`)}}const u3=({visible:r,toolRegistry:e,currentTool:t,drawingMode:n,traceToolLayer:s,padToolLayer:o,testPointToolLayer:d,componentToolLayer:c,updateToolSettings:h,updateToolLayerSettings:f,setBrushSize:m,saveToolSettings:b,saveToolLayerSettings:S,setTopTraceSize:v,setBottomTraceSize:P,setTopPadSize:x,setBottomPadSize:k,setTopTestPointSize:N,setBottomTestPointSize:$,setTopComponentSize:I,setBottomComponentSize:z,setComponentConnectionSize:B,saveDefaultSize:G,onClose:te})=>{const[F,H]=X.useState({}),Q=[{id:"via",name:"Via",instanceId:"via"},{id:"pad",name:"Pad",layer:"top",instanceId:"padTop"},{id:"pad",name:"Pad",layer:"bottom",instanceId:"padBottom"},{id:"testPoint",name:"Test Point",layer:"top",instanceId:"testPointTop"},{id:"testPoint",name:"Test Point",layer:"bottom",instanceId:"testPointBottom"},{id:"trace",name:"Trace",layer:"top",instanceId:"traceTop"},{id:"trace",name:"Trace",layer:"bottom",instanceId:"traceBottom"},{id:"component",name:"Component",layer:"top",instanceId:"componentTop"},{id:"component",name:"Component",layer:"bottom",instanceId:"componentBottom"},{id:"componentConnection",name:"Component Connections"},{id:"power",name:"Power",instanceId:"power"},{id:"ground",name:"Ground",instanceId:"ground"},{id:"erase",name:"Erase"}];X.useEffect(()=>{if(r){const R={};for(const Z of Q){const se=Z.instanceId||Z.id;if(Z.instanceId)try{const V=Mn.get(Z.instanceId);R[se]=V.size}catch{const V=e.get(Z.id);V&&(R[se]=Z.layer?V.layerSettings.get(Z.layer)?.size??V.settings.size??10:V.settings.size??10)}else{const V=e.get(Z.id);V&&(R[se]=V.settings.size??10)}}H(R)}},[r]);const M=X.useCallback((R,Z,se,V)=>{if(!e.get(R)&&R!=="componentConnection")return;const ae=V||R;H(xe=>({...xe,[ae]:Z})),["trace","pad","testPoint","component"].includes(R)&&se&&V?(Mn.setSize(V,Z),(R==="trace"&&t==="draw"&&n==="trace"||R==="pad"&&t==="draw"&&n==="pad"||R==="testPoint"&&t==="draw"&&n==="testPoint"||R==="component"&&t==="component")&&((R==="trace"?s:R==="pad"?o:R==="testPoint"?d:c)||"top")===se&&m(Z)):V?(Mn.setSize(V,Z),(R==="via"&&t==="draw"&&n==="via"||R==="power"&&t==="power"||R==="ground"&&t==="ground")&&m(Z)):(R==="componentConnection"&&(B(Z),G("componentConnection",Z)),R==="erase"&&t==="erase"&&m(Z))},[e,t,n,s,o,d,c,m,B,G]);if(!r)return null;const T=Array.from({length:50},(R,Z)=>Z+1);return l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:R=>{R.target===R.currentTarget&&te()},children:l.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"16px",width:"fit-content",maxWidth:"400px",maxHeight:"85vh",overflowY:"auto",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:R=>R.stopPropagation(),children:[l.jsx("h3",{style:{margin:"0 0 12px 0",color:"#fff",fontSize:"16px",fontWeight:600},children:"Set Tool Size"}),l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:Q.map((R,Z)=>{if(!e.get(R.id)&&R.id!=="componentConnection")return null;const V=R.layer?`${R.name} (${R.layer==="top"?"Top":"Bottom"})`:R.name,ee=R.instanceId||R.id,ae=F[ee]??10;return l.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"6px 10px",background:"#1f1f24",borderRadius:4},children:[l.jsxs("label",{style:{color:"#f2f2f2",fontSize:"13px",width:"140px",flexShrink:0,marginRight:"8px"},children:[V,":"]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[l.jsx("select",{value:ae,onChange:Ce=>{const xe=parseInt(Ce.target.value,10);M(R.id,xe,R.layer,R.instanceId)},style:{width:"50px",padding:"4px 6px",background:"#2b2b31",border:"1px solid #3a3a44",borderRadius:4,color:"#f2f2f2",fontSize:"12px",cursor:"pointer"},children:T.map(Ce=>l.jsx("option",{value:Ce,style:{background:"#2b2b31",color:"#f2f2f2"},children:Ce},Ce))}),l.jsx("span",{style:{color:"#f2f2f2",fontSize:"12px"},children:"px"})]})]},`${R.id}-${R.layer||"default"}-${Z}`)})}),l.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:l.jsx("button",{onClick:te,style:{padding:"6px 12px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:600},children:"Close"})})]})})},h3=({visible:r,toolRegistry:e,currentTool:t,drawingMode:n,traceToolLayer:s,padToolLayer:o,testPointToolLayer:d,componentToolLayer:c,updateToolSettings:h,updateToolLayerSettings:f,saveToolSettings:m,saveToolLayerSettings:b,setBrushColor:S,setTopTraceColor:v,setBottomTraceColor:P,setTopPadColor:x,setBottomPadColor:k,setTopTestPointColor:N,setBottomTestPointColor:$,setTopComponentColor:I,setBottomComponentColor:z,setComponentConnectionColor:B,saveDefaultColor:G,colorPalette:te,onClose:F})=>{const[H,Q]=Tt.useState(null),[M,T]=Tt.useState(0);if(Tt.useEffect(()=>{const ee=[];return[{id:"via"},{id:"pad",layer:"top"},{id:"pad",layer:"bottom"},{id:"testPoint",layer:"top"},{id:"testPoint",layer:"bottom"},{id:"trace",layer:"top"},{id:"trace",layer:"bottom"},{id:"component",layer:"top"},{id:"component",layer:"bottom"},{id:"power"},{id:"ground"}].forEach(({id:Ce,layer:xe})=>{try{const J=jg(Ce,xe),D=Mn.subscribe(J,()=>{T(W=>W+1)});ee.push(D)}catch{}}),()=>{ee.forEach(Ce=>Ce())}},[]),!r)return null;const R=["pad","testPoint","trace","component"],Z=[{id:"via",name:"Via"},{id:"pad",name:"Pad",layer:"top"},{id:"pad",name:"Pad",layer:"bottom"},{id:"testPoint",name:"Test Point",layer:"top"},{id:"testPoint",name:"Test Point",layer:"bottom"},{id:"trace",name:"Trace",layer:"top"},{id:"trace",name:"Trace",layer:"bottom"},{id:"component",name:"Component",layer:"top"},{id:"component",name:"Component",layer:"bottom"},{id:"componentConnection",name:"Component Connections"},{id:"power",name:"Power"},{id:"ground",name:"Ground"},{id:"erase",name:"Erase"}],se=(ee,ae,Ce)=>{if(ee==="componentConnection"){B(ae),G("componentConnection",ae),Q(null);return}if(ee==="erase"){const xe=e.get(ee);xe&&(h(ee,{...xe.settings,color:ae}),m(ee,ae,xe.settings.size)),Q(null);return}try{let xe;Ce&&R.includes(ee)?xe=jg(ee,Ce):xe=jg(ee),Mn.setColor(xe,ae),(ee==="via"&&t==="draw"&&n==="via"||ee==="trace"&&t==="draw"&&n==="trace"||ee==="pad"&&t==="draw"&&n==="pad"||ee==="testPoint"&&t==="draw"&&n==="testPoint"||ee==="component"&&t==="component"||ee==="power"&&t==="power"||ee==="ground"&&t==="ground")&&(Ce&&R.includes(ee)?((ee==="trace"?s:ee==="pad"?o:ee==="testPoint"?d:c)||"top")===Ce&&S(ae):S(ae))}catch(xe){console.error(`Error updating color for tool ${ee}:`,xe);const J=e.get(ee);J&&(Ce&&R.includes(ee)?(f(ee,Ce,{...J.layerSettings.get(Ce),color:ae}),b(ee,Ce,ae,J.layerSettings.get(Ce)?.size||J.settings.size)):(h(ee,{...J.settings,color:ae}),m(ee,ae,J.settings.size)))}Q(null)},V=(ee,ae)=>{let Ce;try{const D=jg(ee,ae);Ce=Mn.get(D).color}catch{const D=e.get(ee);if(!D)return null;Ce=D.settings.color??"#000000"}const xe=ae?`${ee}-${ae}`:ee,J=H?.toolId===ee&&H?.layer===ae;return l.jsxs("div",{style:{position:"relative",display:"inline-block",zIndex:10005},children:[l.jsx("button",{className:"color-swatch-button",onClick:D=>{D.stopPropagation(),Q(J?null:{toolId:ee,layer:ae})},style:{width:"40px",height:"24px",background:Ce,backgroundColor:Ce,backgroundImage:"none",border:"1px solid #3a3a44",borderRadius:3,cursor:"pointer",padding:0,margin:0,display:"block","--swatch-color":Ce},title:Ce},`${xe}-button-${Ce}-${M}`),J&&l.jsx("div",{onClick:D=>{D.stopPropagation()},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",padding:8,background:"#fff",border:"1px solid #ddd",borderRadius:6,boxShadow:"0 8px 18px rgba(0,0,0,0.18)",zIndex:100},children:l.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(8, 22px)",gap:4},children:te.map(D=>l.jsx("div",{onClick:()=>se(ee,D,ae),title:D,style:{width:22,height:22,backgroundColor:D,border:D===Ce?"2px solid #333":"1px solid #ccc",cursor:"pointer"}},D))})})]},`${xe}-${Ce}-${M}`)};return l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:ee=>{ee.target===ee.currentTarget&&(F(),Q(null))},children:l.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"16px",width:"fit-content",minWidth:"450px",maxWidth:"600px",maxHeight:"85vh",overflowY:"auto",overflowX:"visible",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:ee=>ee.stopPropagation(),children:[l.jsx("h3",{style:{margin:"0 0 12px 0",color:"#fff",fontSize:"16px",fontWeight:600},children:"Set Tool Color"}),l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:Z.map((ee,ae)=>{if(!e.get(ee.id))return null;const xe=ee.layer?`${ee.name} (${ee.layer==="top"?"Top":"Bottom"})`:ee.name;return l.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"6px 10px",background:"#1f1f24",borderRadius:4},children:[l.jsxs("label",{style:{color:"#f2f2f2",fontSize:"13px",width:"140px",flexShrink:0,marginRight:"8px"},children:[xe,":"]}),V(ee.id,ee.layer)]},`${ee.id}-${ee.layer||"default"}-${ae}`)})}),l.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:l.jsx("button",{onClick:()=>{F(),Q(null)},style:{padding:"6px 12px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:600},children:"Close"})})]})})},f3=({openMenu:r,setOpenMenu:e,isReadOnlyMode:t,currentProjectFilePath:n,isProjectActive:s,autoSaveEnabled:o,autoSaveInterval:d,hasUnsavedChangesState:c,onNewProject:h,onOpenProject:f,onSaveProject:m,onPrint:b,onExportBOM:S,hasUnsavedChanges:v,bomExportFormat:P,setBomExportFormat:x,setNewProjectDialog:k,setAutoSaveDialog:N,topImage:$,bottomImage:I,setCurrentTool:z,resetImageTransform:B,areImagesLocked:G,setAreImagesLocked:te,onEnterBoardDimensions:F,fileInputTopRef:H,fileInputBottomRef:Q,openProjectRef:M,increaseSize:T,decreaseSize:R,brushSize:Z,drawingStrokes:se,selectedIds:V,selectedComponentIds:ee,selectedPowerIds:ae,selectedGroundIds:Ce,componentsTop:xe,componentsBottom:J,powers:D,grounds:W,powerNodeNames:K,groundNodeNames:ue,setSetSizeDialog:Te,areViasLocked:Pe,setAreViasLocked:Ve,arePadsLocked:De,setArePadsLocked:et,areTestPointsLocked:ot,setAreTestPointsLocked:at,areTracesLocked:ht,setAreTracesLocked:xt,areComponentsLocked:fe,setAreComponentsLocked:Nt,areGroundNodesLocked:zt,setAreGroundNodesLocked:Bt,arePowerNodesLocked:it,setArePowerNodesLocked:qt,showTraceCornerDots:vt,setShowTraceCornerDots:Dt,setSelectedIds:Ot,setSelectedComponentIds:sn,setSelectedPowerIds:kt,setSelectedGroundIds:Lt,selectAllVias:Jn,selectAllTraces:pt,selectAllPads:jt,selectAllComponents:Fn,selectDisconnectedComponents:tn,selectAllComponentConnections:zn,selectAllPowerNodes:Pn,selectAllGroundNodes:dn,selectPowerNodesByName:An,selectGroundNodesByName:lt,setShowPowerBusManager:nn,setShowGroundBusManager:Xt,setShowPastMachine:Kt,toolRegistry:Cn,updateToolSettings:Vi,updateToolLayerSettings:Vn,setBrushSize:bn,setBrushColor:Qt,saveToolSettings:Cr,saveToolLayerSettings:Ks,colorPalette:zr,currentTool:Br,drawingMode:en,traceToolLayer:Or,padToolLayer:ja,testPointToolLayer:fa,componentToolLayer:Ct,setTopTraceSize:pi,setBottomTraceSize:ti,setTopPadSize:vs,setBottomPadSize:Ji,setTopTestPointSize:Ds,setBottomTestPointSize:Ti,setTopComponentSize:Si,setBottomComponentSize:Tr,setComponentConnectionSize:pa,topTraceColor:qa,bottomTraceColor:Yl,topPadColor:Va,bottomPadColor:Wa,topTestPointColor:jo,bottomTestPointColor:Gn,topComponentColor:Fr,bottomComponentColor:xi,setTopTraceColor:ga,setBottomTraceColor:Rn,setTopPadColor:Qo,setBottomPadColor:gi,setTopTestPointColor:ma,setBottomTestPointColor:Pa,setTopComponentColor:el,setBottomComponentColor:tl,setComponentConnectionColor:$a,saveDefaultSize:td,saveDefaultColor:ss,menuBarRef:nl,onOpenProjectNotes:Hn,onOpenTransformImages:Un,onOpenTransformAll:il})=>{const[Ga,Fs]=Tt.useState(null),_r=Tt.useRef(null),[us,Wn]=Tt.useState(null),bi=Tt.useRef(null),[Xl,bc]=Tt.useState(!1),[ya,kr]=Tt.useState(!1),sl=Rt=>{if(!s){alert("Please create a new project (File  New Project) or open an existing project (File  Open Project) before using this feature."),e(null);return}const Qi=Rt();Qi instanceof Promise&&Qi.catch(fr=>{const Al=fr instanceof Error?fr.message:String(fr);console.error("Error in requireProject action:",fr),alert(`An error occurred:

${Al}

See console for details.`)})},Ya=Rt=>{const Qi=Rt==="power"?K:ue,fr=Qi.length>0,Al=Rt==="power"?"Select Power Nodes":"Select Ground Nodes";return l.jsxs("div",{onMouseEnter:()=>{_r.current&&(clearTimeout(_r.current),_r.current=null),Fs(Rt)},onMouseLeave:()=>{_r.current=window.setTimeout(()=>{Fs(Xa=>Xa===Rt?null:Xa)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[l.jsxs("div",{style:{padding:"4px 10px",fontSize:12,color:"#bbb"},children:[Al," by Name"]}),l.jsxs("button",{onClick:()=>{Rt==="power"?Pn():dn(),Fs(null),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:["All ",Rt==="power"?"Power Nodes":"Ground Nodes"]}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),fr?Qi.map(Xa=>l.jsx("button",{onClick:()=>{Rt==="power"?An(Xa):lt(Xa),Fs(null),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:Xa},Xa)):l.jsxs("div",{style:{padding:"4px 10px",fontSize:12,color:"#bbb"},children:["No ",Rt==="power"?"power":"ground"," nodes available."]})]})},Nr=()=>l.jsxs("div",{onMouseEnter:()=>{bi.current&&(clearTimeout(bi.current),bi.current=null),Wn("lock")},onMouseLeave:()=>{bi.current=window.setTimeout(()=>{Wn(Rt=>Rt==="lock"?null:Rt)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[l.jsxs("label",{onClick:Rt=>{Rt.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[l.jsx("input",{type:"checkbox",checked:Pe,onChange:()=>{Ve(Rt=>!Rt)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),l.jsx("span",{children:"Lock Vias"})]}),l.jsxs("label",{onClick:Rt=>{Rt.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[l.jsx("input",{type:"checkbox",checked:De,onChange:()=>{et(Rt=>!Rt)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),l.jsx("span",{children:"Lock Pads"})]}),l.jsxs("label",{onClick:Rt=>{Rt.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[l.jsx("input",{type:"checkbox",checked:ot,onChange:()=>{at(Rt=>!Rt)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),l.jsx("span",{children:"Lock Test Points"})]}),l.jsxs("label",{onClick:Rt=>{Rt.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[l.jsx("input",{type:"checkbox",checked:ht,onChange:()=>{xt(Rt=>!Rt)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),l.jsx("span",{children:"Lock Traces"})]}),l.jsxs("label",{onClick:Rt=>{Rt.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[l.jsx("input",{type:"checkbox",checked:fe,onChange:()=>{Nt(Rt=>!Rt)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),l.jsx("span",{children:"Lock Components"})]}),l.jsxs("label",{onClick:Rt=>{Rt.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[l.jsx("input",{type:"checkbox",checked:zt,onChange:()=>{Bt(Rt=>!Rt)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),l.jsx("span",{children:"Lock Ground Node"})]}),l.jsxs("label",{onClick:Rt=>{Rt.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[l.jsx("input",{type:"checkbox",checked:it,onChange:()=>{qt(Rt=>!Rt)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),l.jsx("span",{children:"Lock Power Nodes"})]})]}),na=()=>l.jsxs("div",{onMouseEnter:()=>{bi.current&&(clearTimeout(bi.current),bi.current=null),Wn("select")},onMouseLeave:()=>{bi.current=window.setTimeout(()=>{Wn(Rt=>Rt==="select"?null:Rt)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[l.jsx("button",{onClick:()=>{Jn(),Wn(null),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Vias"}),l.jsx("button",{onClick:()=>{pt(),Wn(null),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Traces"}),l.jsx("button",{onClick:()=>{jt(),Wn(null),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Pads"}),l.jsx("button",{onClick:()=>{const Rt=new Set(se.filter(Qi=>Qi.type==="testPoint").map(Qi=>Qi.id));Ot(Rt),sn(new Set),kt(new Set),Lt(new Set),Wn(null),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Test Points"}),l.jsx("button",{onClick:()=>{Fn(),Wn(null),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Components"}),l.jsx("button",{onClick:()=>{zn(),Wn(null),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Component Connections"}),l.jsxs("div",{style:{position:"relative"},children:[l.jsx("button",{onMouseEnter:()=>{_r.current&&(clearTimeout(_r.current),_r.current=null),Fs("power")},onMouseLeave:()=>{_r.current=window.setTimeout(()=>{Fs(Rt=>Rt==="power"?null:Rt)},200)},onClick:()=>{Fs(Rt=>Rt==="power"?null:"power")},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Power Nodes "}),Ga==="power"&&Ya("power")]}),l.jsxs("div",{style:{position:"relative"},children:[l.jsx("button",{onMouseEnter:()=>{_r.current&&(clearTimeout(_r.current),_r.current=null),Fs("ground")},onMouseLeave:()=>{_r.current=window.setTimeout(()=>{Fs(Rt=>Rt==="ground"?null:Rt)},200)},onClick:()=>{Fs(Rt=>Rt==="ground"?null:"ground")},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Ground Nodes "}),Ga==="ground"&&Ya("ground")]}),l.jsx("button",{onClick:()=>{tn(),Wn(null),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Disconnected Components"})]});return l.jsxs(l.Fragment,{children:[l.jsxs("div",{ref:nl,style:{position:"relative",background:"rgba(250,250,255,0.9)",borderBottom:"1px solid #e6e6ef",padding:"6px 12px",display:"flex",gap:16,alignItems:"center",zIndex:3},children:[l.jsxs("div",{style:{position:"relative"},children:[l.jsx("button",{onClick:Rt=>{Rt.stopPropagation(),e(Qi=>Qi==="file"?null:"file")},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:r==="file"?"#eef3ff":"#fff",fontWeight:600,color:"#222"},children:"File "}),r==="file"&&l.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:200,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[l.jsx("button",{onClick:()=>{t||(e(null),v()?k({visible:!0}):h())},disabled:t,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:t?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:t?"not-allowed":"pointer"},children:"New Project"}),l.jsx("button",{onClick:async()=>{await f(),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Open Project"}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),l.jsx("button",{onClick:()=>{t||sl(()=>{m(),e(null)})},disabled:t||!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:t||!s?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:t||!s?"not-allowed":"pointer"},children:"Save Project"}),l.jsx("button",{onClick:()=>{t||sl(()=>{N({visible:!0,interval:5}),e(null)})},disabled:t||!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:t||!s?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:t||!s?"not-allowed":"pointer"},children:"Auto Save"}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),l.jsx("button",{onClick:()=>{Kt(!0),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Restore from History"}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),l.jsx("button",{onClick:async()=>{if(!t){if(!s){alert("Please create a new project (File  New Project) or open an existing project (File  Open Project) before using this feature."),e(null);return}try{await S(),e(null)}catch(Rt){console.error("Error exporting BOM:",Rt)}}},disabled:t||!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:t||!s?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:t||!s?"not-allowed":"pointer"},children:"Export BOM"}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),l.jsx("button",{onClick:()=>{sl(()=>{b(),e(null)})},disabled:!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:s?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:s?"pointer":"not-allowed"},children:"Print"}),l.jsx("button",{onClick:()=>{sl(()=>{b(),e(null)})},disabled:!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:s?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:s?"pointer":"not-allowed"},children:"Printer Settings"})]})]}),l.jsxs("div",{style:{position:"relative"},children:[l.jsx("button",{onClick:Rt=>{t||(Rt.stopPropagation(),e(Qi=>Qi==="transform"?null:"transform"))},disabled:t,style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:r==="transform"?"#eef3ff":"#fff",fontWeight:600,color:t?"#999":"#222",cursor:t?"not-allowed":"pointer",opacity:t?.5:1},children:"Images "}),r==="transform"&&l.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:260,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[l.jsx("button",{onClick:()=>{!t&&!G&&s&&(H.current?.click(),e(null))},disabled:t||G||!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:t||G||!s?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:t||G||!s?"not-allowed":"pointer"},children:"Load Top PCB"}),l.jsx("button",{onClick:()=>{!t&&!G&&s&&(Q.current?.click(),e(null))},disabled:t||G||!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:t||G||!s?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:t||G||!s?"not-allowed":"pointer"},children:"Load Bottom PCB"}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),l.jsx("button",{onClick:()=>{!G&&s&&(F(),e(null))},disabled:G||!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:G||!s?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:G||!s?"not-allowed":"pointer"},children:"Enter PCB Dimensions"}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),l.jsx("button",{onClick:()=>{s&&(Un(),e(null))},disabled:!$&&!I||G||!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:!$&&!I||G||!s?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:!$&&!I||G||!s?"not-allowed":"pointer"},children:"Transform Images"}),l.jsx("button",{onClick:()=>{!G&&s&&(z("transform"),B(),e(null))},disabled:G||!$&&!I||!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:G||!$&&!I||!s?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:G||!$&&!I||!s?"not-allowed":"pointer"},children:"Reset Transform"}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),l.jsx("button",{onClick:()=>{s&&(te(Rt=>!Rt),e(null))},disabled:!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:s?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:s?"pointer":"not-allowed"},children:G?"Unlock Images ":"Lock Images"})]})]}),l.jsxs("div",{style:{position:"relative"},children:[l.jsx("button",{onClick:Rt=>{t||(Rt.stopPropagation(),e(Qi=>Qi==="tools"?null:"tools"))},disabled:t,style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:r==="tools"?"#eef3ff":"#fff",fontWeight:600,color:t?"#999":"#222",cursor:t?"not-allowed":"pointer",opacity:t?.5:1},children:"Tools "}),r==="tools"&&l.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[l.jsx("button",{onClick:()=>{s&&(il(),e(null))},disabled:!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:s?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:s?"pointer":"not-allowed"},children:"Change Perspective"}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),l.jsx("button",{onClick:Rt=>{s&&(T(Rt.shiftKey?5:1),e(null))},disabled:!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:s?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:s?"pointer":"not-allowed"},children:"Increase Size (+)"}),l.jsx("button",{onClick:Rt=>{s&&(R(Rt.shiftKey?5:1),e(null))},disabled:!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:s?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:s?"pointer":"not-allowed"},children:"Decrease Size (-)"}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),l.jsxs("div",{style:{position:"relative"},children:[l.jsx("button",{onMouseEnter:()=>{s&&bi.current&&(clearTimeout(bi.current),bi.current=null),s&&Wn("lock")},onMouseLeave:()=>{s&&(bi.current=window.setTimeout(()=>{Wn(Rt=>Rt==="lock"?null:Rt)},200))},onClick:()=>{s&&Wn(Rt=>Rt==="lock"?null:"lock")},disabled:!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:s?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:s?"pointer":"not-allowed"},children:"Lock "}),us==="lock"&&s&&Nr()]}),l.jsxs("div",{style:{position:"relative"},children:[l.jsx("button",{onMouseEnter:()=>{s&&bi.current&&(clearTimeout(bi.current),bi.current=null),s&&Wn("select")},onMouseLeave:()=>{s&&(bi.current=window.setTimeout(()=>{Wn(Rt=>Rt==="select"?null:Rt)},200))},onClick:()=>{s&&Wn(Rt=>Rt==="select"?null:"select")},disabled:!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:s?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:s?"pointer":"not-allowed"},children:"Select "}),us==="select"&&s&&na()]}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),l.jsx("button",{onClick:()=>{s&&(Hn(),e(null))},disabled:!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:s?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:s?"pointer":"not-allowed"},children:"Open Project Notes"}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),l.jsx("button",{onClick:()=>{s&&(bc(!0),e(null))},disabled:!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:s?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:s?"pointer":"not-allowed"},children:"Set Tool Sizes"}),l.jsx("button",{onClick:()=>{s&&(kr(!0),e(null))},disabled:!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:s?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:s?"pointer":"not-allowed"},children:"Set Tool Colors"}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),l.jsx("button",{onClick:()=>{s&&(nn(!0),e(null))},disabled:!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:s?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:s?"pointer":"not-allowed"},children:"Manage Power Buses"}),l.jsx("button",{onClick:()=>{s&&(Xt(!0),e(null))},disabled:!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:s?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:s?"pointer":"not-allowed"},children:"Manage Ground Buses"}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),l.jsxs("button",{onClick:()=>{s&&(Dt(!vt),e(null))},disabled:!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:s?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:s?"pointer":"not-allowed"},children:[vt?" ":"   ","Show Trace Corner Dots"]})]})]}),l.jsxs("div",{style:{position:"relative"},children:[l.jsx("button",{onClick:Rt=>{Rt.stopPropagation(),e(Qi=>Qi==="about"?null:"about")},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:r==="about"?"#eef3ff":"#fff",fontWeight:600,color:"#222"},children:"About "}),r==="about"&&l.jsx("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:500,maxWidth:700,maxHeight:"80vh",background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:20,overflowY:"auto",zIndex:100},children:l.jsxs("div",{style:{marginBottom:16},children:[l.jsx("h2",{style:{margin:"0 0 16px 0",color:"#f2f2f2",fontSize:"20px",fontWeight:700},children:"PCB Tracer"}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"About"}),l.jsx("p",{style:{margin:"0 0 12px 0",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:"A specialized tool useful for both reverse engineering and troubleshooting electronics by tracing and documenting circuit connections from PCB images. This application supports typical 2 to 4 layer PCBs and enables comprehensive PCB analysis and documentation."}),l.jsx("p",{style:{margin:"0 0 12px 0",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:"This tool can assist in troubleshooting by tracing circuits, holding contextual notes, comparing test results, and documenting findings during the debugging process."})]}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Technologies"}),l.jsxs("p",{style:{margin:"0 0 12px 0",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:["Built with ",l.jsx("strong",{children:"TypeScript"})," and ",l.jsx("strong",{children:"React"}),", with ",l.jsx("strong",{children:"Gemini AI"})," integration for intelligent pin name extraction from datasheets. The application runs entirely client-side in the browser, providing a responsive, interactive drawing experience with no backend server requirements."]})]}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Features"}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Via/Pad Placement"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[l.jsxs("li",{children:["Alt/Option+click the Via or Pad tool, or press ",l.jsx("code",{children:"Alt/Option+V"})," or ",l.jsx("code",{children:"Alt/Option+P"})," to open the placement dialog"]}),l.jsx("li",{children:"Place multiple vias or pads in Linear, 2-Sided, or 4-Sided arrangements"}),l.jsx("li",{children:"Automatic counter-clockwise numbering starting from Pin 1"}),l.jsx("li",{children:"Supports chip orientations of 0, 90, 180, or 270"}),l.jsx("li",{children:"Click and drag to define the placement area"}),l.jsx("li",{children:"Tool automatically returns to Select tool after placement"})]})]}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Tools & Shortcuts"}),l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px 16px",fontSize:"13px",color:"#f2f2f2"},children:[l.jsx("div",{children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Select"}),"  ",l.jsx("code",{children:"S"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Via"}),"  ",l.jsx("code",{children:"V"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Pad"}),"  ",l.jsx("code",{children:"P"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Test Point"}),"  ",l.jsx("code",{children:"Y"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Trace"}),"  ",l.jsx("code",{children:"T"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Component"}),"  ",l.jsx("code",{children:"C"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Component Properties"}),"  double-click component"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Resize Icons"}),"  ",l.jsx("code",{children:"+"})," / ",l.jsx("code",{children:"-"})," (",l.jsx("code",{children:"Shift"})," + ",l.jsx("code",{children:"+"})," / ",l.jsx("code",{children:"-"})," = 5x faster)"]})]})}),l.jsx("div",{children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Power"}),"  ",l.jsx("code",{children:"B"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Ground"}),"  ",l.jsx("code",{children:"G"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Move (Pan)"}),"  ",l.jsx("code",{children:"H"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Magnify"}),"  ",l.jsx("code",{children:"M"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Set View"}),"  ",l.jsx("code",{children:"X"})," then ",l.jsx("code",{children:"0-9"})," to save view"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Recall View"}),"  ",l.jsx("code",{children:"0-9"})," to recall saved view"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Default View 0"}),"  ",l.jsx("code",{children:"0"})," to recall default view (origin with all images contained)"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Information Dialog"}),"  ",l.jsx("code",{children:"I"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Notes Dialog"}),"  ",l.jsx("code",{children:"N"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Project Notes / TODO"}),"  ",l.jsx("code",{children:"L"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Undo"}),"  ",l.jsx("code",{children:"Ctrl"})," + ",l.jsx("code",{children:"Z"})]})]})})]}),l.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#f2f2f2"},children:[l.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#f2f2f2"},children:"Arrow Keys"}),l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Move Selected Components"}),"  Arrow keys to nudge selected components (1 unit per press, ",l.jsx("code",{children:"Shift"})," = 10 units)"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Switch Perspective"}),"  ",l.jsx("code",{children:"Shift"})," + ",l.jsx("code",{children:""})," / ",l.jsx("code",{children:""})," or ",l.jsx("code",{children:"Caps Lock"})," + ",l.jsx("code",{children:""})," / ",l.jsx("code",{children:""})," to switch between top/bottom view"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Rotate Perspective"}),"  ",l.jsx("code",{children:"Shift"})," + ",l.jsx("code",{children:""})," / ",l.jsx("code",{children:""})," or ",l.jsx("code",{children:"Caps Lock"})," + ",l.jsx("code",{children:""})," / ",l.jsx("code",{children:""})," to rotate in 90 increments (",l.jsx("code",{children:""})," = counter-clockwise, ",l.jsx("code",{children:""})," = clockwise)"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Image Transformations"}),"  Arrow keys for scaling, rotating, and adjusting image transformations (when image is selected for transform)"]}),l.jsx("li",{children:"Click a slider first, then use arrow keys for precise adjustment"})]})]})]}),l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px 20px"},children:[l.jsxs("div",{children:[l.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Image Management"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[l.jsx("li",{children:"Load top and bottom PCB images"}),l.jsx("li",{children:"Image alignment and transformation"}),l.jsx("li",{children:"Transform modes: nudge, scale, rotate, slant, keystone"}),l.jsx("li",{children:"Horizontal and vertical flip controls"}),l.jsx("li",{children:"Brightness and contrast controls"}),l.jsx("li",{children:"Grayscale mode"}),l.jsx("li",{children:"Automated transparency slider"}),l.jsx("li",{children:"Board dimensions configuration"})]})]}),l.jsxs("div",{children:[l.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Drawing Tools"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[l.jsx("li",{children:"Draw copper traces (top and bottom layers)"}),l.jsx("li",{children:"Place vias for layer connections"}),l.jsx("li",{children:"Place component pads (SMD and through-hole)"}),l.jsx("li",{children:"Place test points for circuit testing"}),l.jsx("li",{children:"Place and annotate components"}),l.jsx("li",{children:"Place power and ground nodes"}),l.jsx("li",{children:"Erase tool for removing elements"})]})]}),l.jsxs("div",{children:[l.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Layer Management"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[l.jsx("li",{children:"14 independent layers to manage PCB element types"}),l.jsx("li",{children:"Separate top and bottom layer support"}),l.jsx("li",{children:"Layer-specific color customization"}),l.jsx("li",{children:"Layer-specific size controls"}),l.jsx("li",{children:"Layer visibility toggles"}),l.jsx("li",{children:"Overlay view mode"})]})]}),l.jsxs("div",{children:[l.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Component Management"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[l.jsx("li",{children:"Component placement with pin counts"}),l.jsx("li",{children:"Pin connection tracking"}),l.jsx("li",{children:"Component type classification"}),l.jsx("li",{children:"Designator and value annotation"}),l.jsx("li",{children:"Component editor dialog"}),l.jsx("li",{children:"Find and center component"})]})]}),l.jsxs("div",{children:[l.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Selection & Locking"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[l.jsx("li",{children:"Select individual elements or groups"}),l.jsx("li",{children:"Select all vias, traces, pads, or components"}),l.jsx("li",{children:"Select power/ground nodes by name"}),l.jsx("li",{children:"Select disconnected components"}),l.jsx("li",{children:"Lock/unlock elements by type"}),l.jsx("li",{children:"Image locking for protection"})]})]}),l.jsxs("div",{children:[l.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Power & Ground"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[l.jsx("li",{children:"Multiple voltage power nodes"}),l.jsx("li",{children:"Power bus management"}),l.jsx("li",{children:"Ground node placement"}),l.jsx("li",{children:"Ground bus management"}),l.jsx("li",{children:"Node naming and organization"})]})]}),l.jsxs("div",{children:[l.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Customization"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[l.jsx("li",{children:"Customizable colors per layer"}),l.jsx("li",{children:"Adjustable brush/tool sizes"}),l.jsx("li",{children:"Size presets for common tools"}),l.jsx("li",{children:"Color palette management"}),l.jsx("li",{children:"Tool settings persistence"})]})]}),l.jsxs("div",{children:[l.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Project Management"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[l.jsx("li",{children:"Create, open, and save projects"}),l.jsx("li",{children:"Auto-save with configurable intervals"}),l.jsx("li",{children:"File history automatically saved in history subdirectory when Auto Save is enabled"}),l.jsx("li",{children:"Project Notes / TODO list with spreadsheet-like editing"}),l.jsx("li",{children:"Project file format (JSON)"}),l.jsx("li",{children:"Print functionality"}),l.jsx("li",{children:"Export to KiCad schematic format (future feature, not yet implemented)"})]})]}),l.jsxs("div",{children:[l.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"View Controls"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[l.jsx("li",{children:"Zoom in/out with mouse wheel"}),l.jsx("li",{children:"Pan view with hand tool"}),l.jsx("li",{children:"Zoom to fit"}),l.jsx("li",{children:"View mode switching (top/bottom/overlay)"}),l.jsx("li",{children:"Save up to 10 view locations (X + 0-9)"}),l.jsx("li",{children:"Recall saved views instantly (0-9 keys)"}),l.jsxs("li",{children:["Default View 0: Press ",l.jsx("code",{children:"0"})," to recall the default view showing the origin with all loaded images fully contained within the canvas"]}),l.jsx("li",{children:"Change Perspective (Tools menu) - switch between top/bottom view and rotate all elements"}),l.jsx("li",{children:"Detailed information dialog"})]})]})]})]}),l.jsx("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #444"},children:l.jsxs("p",{style:{margin:"0 0 8px 0",color:"#bbb",fontSize:"12px",lineHeight:"1.5"},children:["Use the ",l.jsx("strong",{children:"File"})," menu to manage projects, the ",l.jsx("strong",{children:"Images"})," menu for image loading and transformation, and the ",l.jsx("strong",{children:"Tools"})," menu for selection, locking, and customization options."]})}),l.jsxs("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #444"},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Future / TODO List"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[l.jsx("li",{children:"A searchable list of common components"}),l.jsx("li",{children:"Output schematics (perhaps as KiCad files)"}),l.jsx("li",{children:"Dynamic layers"}),l.jsx("li",{children:"Create a desktop version of this application using Electron"})]})]})]})})]}),l.jsxs("div",{style:{position:"relative"},children:[l.jsx("button",{onClick:Rt=>{Rt.stopPropagation(),e(Qi=>Qi==="help"?null:"help")},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:r==="help"?"#eef3ff":"#fff",fontWeight:600,color:"#222"},children:"Help "}),r==="help"&&l.jsx("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:500,maxWidth:700,maxHeight:"80vh",background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:20,overflowY:"auto",zIndex:100},children:l.jsxs("div",{style:{marginBottom:16},children:[l.jsx("h2",{style:{margin:"0 0 16px 0",color:"#f2f2f2",fontSize:"20px",fontWeight:700},children:"Help: Typical Usage Steps"}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 1: Create or Open a Project"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"New Project:"})," File  New Project. Choose a project name and location."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Open Project:"})," File  Open Project. Select an existing project file (.json)."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Auto-Save:"})," File  Auto Save  Enable to automatically save your work at regular intervals."]})]})]}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 2: Load PCB Images"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Load Top Image:"})," Images  Load Top Image. Select your top-side PCB photo (.png or .jpeg)."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Load Bottom Image:"})," Images  Load Bottom Image. Select your bottom-side PCB photo."]}),l.jsxs("li",{children:["Images are automatically copied to the ",l.jsx("code",{style:{background:"#1f1f24",padding:"2px 4px",borderRadius:3,color:"#fff"},children:"images/"})," subdirectory."]})]})]}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 3: Align and Transform Images"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Enter Transform Mode:"})," Images  Transform Images. Select which image (Top or Bottom) to transform."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Transform Operations:"})," Use Move, Nudge, Scale, Rotate, Slant, or Keystone to align images."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Image Adjustments:"})," Adjust brightness, contrast, sharpness, and grayscale as needed."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Flip Images:"})," Use horizontal or vertical flip if your images are mirrored."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Arrow Keys:"})," When transform tool is active, use arrow keys for precise image adjustments."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Move Components:"})," Select components, then use arrow keys to move them (1 unit per press, ",l.jsx("code",{children:"Shift"})," = 10 units for larger steps)."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Change Perspective:"})," Tools  Change Perspective (or press ",l.jsx("code",{children:"E"}),") to switch between top/bottom view or rotate all elements (images, components, traces) together by 90, 180, or 270."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Quick Perspective Switch:"})," Press ",l.jsx("code",{children:"Shift"})," + ",l.jsx("code",{children:""})," / ",l.jsx("code",{children:""})," or ",l.jsx("code",{children:"Caps Lock"})," + ",l.jsx("code",{children:""})," / ",l.jsx("code",{children:""})," to quickly switch between top/bottom view."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Quick Perspective Rotation:"})," Press ",l.jsx("code",{children:"Shift"})," + ",l.jsx("code",{children:""})," / ",l.jsx("code",{children:""})," or ",l.jsx("code",{children:"Caps Lock"})," + ",l.jsx("code",{children:""})," / ",l.jsx("code",{children:""})," to rotate perspective in 90 increments (",l.jsx("code",{children:""})," = counter-clockwise, ",l.jsx("code",{children:""})," = clockwise)."]})]})]}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 4: Set Board Dimensions"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Enter Dimensions:"})," Images  Enter Board Dimensions. Specify the actual physical dimensions of your PCB."]}),l.jsx("li",{children:"This helps ensure accurate measurements and scaling for your reverse engineering work."})]})]}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 5: Trace Connections"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Place Vias:"})," Click the Via tool (",l.jsx("code",{children:"V"}),") and click on the PCB where vias connect layers."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Place Pads:"})," Click the Pad tool (",l.jsx("code",{children:"P"}),") and mark component pad locations."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Place Multiple Vias/Pads:"})," Alt/Option+click the Via or Pad tool, or press ",l.jsx("code",{children:"Alt/Option+V"})," (vias) or ",l.jsx("code",{children:"Alt/Option+P"})," (pads) to open the placement dialog. Choose arrangement (Linear, 2-Sided, or 4-Sided), number of pins, orientation, and layer. Click and drag on the canvas to define the placement area. Vias/pads are automatically arranged in counter-clockwise order starting from Pin 1."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Place Test Points:"})," Click the Test Point tool (",l.jsx("code",{children:"Y"}),") to mark test points."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Draw Traces:"})," Click the Trace tool (",l.jsx("code",{children:"T"}),"), select Top or Bottom layer, then click to start a trace. Click again to add segments. Press ",l.jsx("code",{children:"Enter"})," or click outside to finish."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Snapping:"})," Traces automatically snap to nearby vias, pads, power nodes, and ground nodes."]})]})]}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 6: Place Components"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Place Component:"})," Click the Component tool (",l.jsx("code",{children:"C"}),"), select component type, then click on the PCB."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Edit Component:"})," Double-click a component or select a component and press ",l.jsx("code",{children:"A"})," to open the Component Properties dialog. If multiple components are selected, opens the most recently selected one."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Set Properties:"})," Enter designator (e.g., R1, C2), value, and other component details."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Connect Pins:"})," Click on pads or vias to connect component pins to the circuit."]})]})]}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 7: Add Power and Ground Nodes"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Manage Power Buses:"})," Tools  Manage Power Buses to create and configure voltage buses (e.g., +5V, +3.3V)."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Place Power Nodes:"})," Click the Power tool (",l.jsx("code",{children:"B"}),"), select a voltage bus, then click on the PCB."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Manage Ground Buses:"})," Tools  Manage Ground Buses to configure ground connections."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Place Ground Nodes:"})," Click the Ground tool (",l.jsx("code",{children:"G"}),"), select a ground bus, then click on the PCB."]})]})]}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 8: Add Notes and Documentation"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Element Notes:"})," Press ",l.jsx("code",{children:"N"})," to open the Notes dialog for selected elements (vias, pads, traces, etc.)."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Project Notes:"})," Press ",l.jsx("code",{children:"L"})," to open Project Notes / TODO list for general project documentation."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Information Dialog:"})," Press ",l.jsx("code",{children:"I"})," to see detailed information about selected elements."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Find Elements:"})," Use the Find button in the Information dialog to center and highlight specific elements."]})]})]}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 9: Save Your Work"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Manual Save:"})," File  Save Project to save your work manually."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Auto-Save:"})," If enabled, your project is automatically saved at regular intervals."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"History:"})," Auto-saved versions are stored in the ",l.jsx("code",{style:{background:"#1f1f24",padding:"2px 4px",borderRadius:3,color:"#fff"},children:"history/"})," subdirectory."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Restore from History:"})," File  Restore from History to access previous versions."]})]})]}),l.jsxs("div",{style:{marginBottom:20,paddingTop:16,borderTop:"1px solid #444"},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Keyboard Shortcuts"}),l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px 16px",fontSize:"13px",color:"#f2f2f2"},children:[l.jsxs("div",{children:[l.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#f2f2f2"},children:"Drawing Tools"}),l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Select"}),"  ",l.jsx("code",{children:"S"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Via"}),"  ",l.jsx("code",{children:"V"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Via Pattern"}),"  ",l.jsx("code",{children:"Alt/Option+V"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Pad"}),"  ",l.jsx("code",{children:"P"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Pad Pattern"}),"  ",l.jsx("code",{children:"Alt/Option+P"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Test Point"}),"  ",l.jsx("code",{children:"Y"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Trace"}),"  ",l.jsx("code",{children:"T"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Component"}),"  ",l.jsx("code",{children:"C"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Component Properties"}),"  ",l.jsx("code",{children:"A"})," (opens dialog for selected component)"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Power"}),"  ",l.jsx("code",{children:"B"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Ground"}),"  ",l.jsx("code",{children:"G"})]})]})]}),l.jsxs("div",{children:[l.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#f2f2f2"},children:"View & Navigation"}),l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Move (Pan)"}),"  ",l.jsx("code",{children:"H"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Magnify"}),"  ",l.jsx("code",{children:"M"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Set View"}),"  ",l.jsx("code",{children:"X"})," then ",l.jsx("code",{children:"0-9"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Recall View"}),"  ",l.jsx("code",{children:"0-9"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Default View 0"}),"  ",l.jsx("code",{children:"0"})," (origin with all images contained)"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Default View 0"}),"  ",l.jsx("code",{children:"0"})," (origin with all images contained)"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Information"}),"  ",l.jsx("code",{children:"I"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Notes"}),"  ",l.jsx("code",{children:"N"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Project Notes"}),"  ",l.jsx("code",{children:"L"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Undo"}),"  ",l.jsx("code",{children:"Ctrl+Z"})," / ",l.jsx("code",{children:"Cmd+Z"})]})]})]})]}),l.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#f2f2f2"},children:[l.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#f2f2f2"},children:"Arrow Keys"}),l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Move Selected Components"}),"  Arrow keys to nudge selected components (1 unit per press, ",l.jsx("code",{children:"Shift"})," = 10 units)"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Switch Perspective"}),"  ",l.jsx("code",{children:"Shift"})," + ",l.jsx("code",{children:""})," / ",l.jsx("code",{children:""})," or ",l.jsx("code",{children:"Caps Lock"})," + ",l.jsx("code",{children:""})," / ",l.jsx("code",{children:""})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Rotate Perspective"}),"  ",l.jsx("code",{children:"Shift"})," + ",l.jsx("code",{children:""})," / ",l.jsx("code",{children:""})," or ",l.jsx("code",{children:"Caps Lock"})," + ",l.jsx("code",{children:""})," / ",l.jsx("code",{children:""})," (",l.jsx("code",{children:""})," = counter-clockwise, ",l.jsx("code",{children:""})," = clockwise)"]}),l.jsx("li",{children:"Use arrow keys to adjust image transformations (when transform tool is active)"}),l.jsx("li",{children:"Click a slider first, then use arrow keys for precise adjustment"})]})]})]}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Tips & Tricks"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[l.jsx("li",{children:"Double-click any slider to reset it to the default value"}),l.jsx("li",{children:"Double-click a component to edit its properties"}),l.jsxs("li",{children:["Hold ",l.jsx("code",{children:"Shift"})," while clicking to add to selection"]}),l.jsxs("li",{children:["Use the Information dialog (",l.jsx("code",{children:"I"}),") to see details about selected elements"]}),l.jsx("li",{children:"Lock layers (Tools  Lock) to prevent accidental modifications"}),l.jsx("li",{children:"Use the Find button in the Information dialog to center elements in view"}),l.jsxs("li",{children:["Save views with ",l.jsx("code",{children:"X"})," + number key for quick navigation"]}),l.jsxs("li",{children:["Use ",l.jsx("code",{children:"+"})," and ",l.jsx("code",{children:"-"})," keys to resize tool icons (",l.jsx("code",{children:"Shift"})," + ",l.jsx("code",{children:"+"})," / ",l.jsx("code",{children:"-"})," changes size 5 times faster)"]})]})]}),l.jsx("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #444"},children:l.jsxs("p",{style:{margin:"0 0 8px 0",color:"#bbb",fontSize:"12px",lineHeight:"1.5"},children:["For more detailed feature information, see the ",l.jsx("strong",{children:"About"})," menu."]})})]})})]}),n&&l.jsxs("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:"8px",paddingLeft:"16px"},children:[l.jsx("div",{style:{fontSize:"12px",color:"#333",fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"40vw"},title:n,children:n}),l.jsx("div",{style:{width:"16px",height:"16px",borderRadius:"50%",border:"1px solid #666",backgroundColor:c?o?"#ffaa00":"#ff0000":"#00ff00",flexShrink:0},title:c?o?`Changes detected  Auto Save: ON  Will be saved automatically every ${d||1} minute${d===1?"":"s"}`:"Changes detected  Auto Save: OFF  You need to save manually (File  Save Project)":"Project saved  No unsaved changes  Auto Save: "+(o?"ON":"OFF")})]})]}),l.jsx(u3,{visible:Xl,toolRegistry:Cn,currentTool:Br,drawingMode:en,traceToolLayer:Or,padToolLayer:ja,testPointToolLayer:fa,componentToolLayer:Ct,updateToolSettings:Vi,updateToolLayerSettings:Vn,setBrushSize:bn,saveToolSettings:Cr,saveToolLayerSettings:Ks,setTopTraceSize:pi,setBottomTraceSize:ti,setTopPadSize:vs,setBottomPadSize:Ji,setTopTestPointSize:Ds,setBottomTestPointSize:Ti,setTopComponentSize:Si,setBottomComponentSize:Tr,setComponentConnectionSize:pa,saveDefaultSize:td,onClose:()=>bc(!1)}),l.jsx(h3,{visible:ya,toolRegistry:Cn,currentTool:Br,drawingMode:en,traceToolLayer:Or,padToolLayer:ja,testPointToolLayer:fa,componentToolLayer:Ct,updateToolSettings:Vi,updateToolLayerSettings:Vn,saveToolSettings:Cr,saveToolLayerSettings:Ks,setBrushColor:Qt,setTopTraceColor:ga,setBottomTraceColor:Rn,setTopPadColor:Qo,setBottomPadColor:gi,setTopTestPointColor:ma,setBottomTestPointColor:Pa,setTopComponentColor:el,setBottomComponentColor:tl,setComponentConnectionColor:$a,saveDefaultColor:ss,colorPalette:zr,onClose:()=>kr(!1)})]})},p3=({visible:r,canvasSize:e={width:960,height:600},canvasPosition:t={left:244,top:6},onDismiss:n})=>{const s=X.useRef(null),o=X.useRef(null),[d,c]=X.useState(!0),h=X.useCallback(()=>{s.current&&(s.current.pause(),s.current.src="",s.current.load()),c(!1),n&&n()},[n]);return X.useEffect(()=>{r&&c(!0)},[r]),X.useEffect(()=>{if(!r)return;const f=()=>{h()};return document.addEventListener("click",f,{once:!0}),document.addEventListener("mousedown",f,{once:!0}),()=>{document.removeEventListener("click",f),document.removeEventListener("mousedown",f)}},[r,h]),X.useEffect(()=>{r&&d&&s.current?s.current.play().catch(f=>{console.warn("Video autoplay failed:",f)}):(!r||!d)&&s.current&&s.current&&(s.current.pause(),s.current.src="",s.current.load())},[r,d]),r?l.jsxs("div",{ref:o,style:{position:"absolute",left:0,top:0,right:0,bottom:0,pointerEvents:"none",zIndex:10},children:[d&&l.jsx("video",{ref:s,src:"/PCB_Reverse_Engineering_Tool/SplashLoop.mp4",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,style:{position:"absolute",left:`${t.left}px`,top:`${t.top}px`,width:`${e.width}px`,height:`${e.height}px`,objectFit:"cover",pointerEvents:"none",zIndex:1}}),l.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",padding:"24px 32px",background:"rgba(255, 255, 255, 0.85)",borderRadius:8,border:"2px solid #4CAF50",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",maxWidth:"500px",pointerEvents:"auto",zIndex:2},children:[l.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"#000",marginBottom:"12px"},children:"PCB Tracer: An Electronics Tool"}),l.jsxs("div",{style:{fontSize:"16px",fontWeight:600,color:"#000",marginBottom:"16px",lineHeight:"1.5"},children:["Reverse Engineer, Troubleshoot, Repair, Signal Trace,",l.jsx("br",{}),"Document Test Results"]}),l.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"8px",lineHeight:"1.5",textAlign:"left"},children:"1) Use the File menu to start a new project."}),l.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"8px",lineHeight:"1.5",textAlign:"left"},children:"2) Use the Images menu to load images."}),l.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"12px",lineHeight:"1.5",textAlign:"left"},children:"3) Use the tools to draw vias, traces, components, etc."})]})]}):null},g3=({visible:r,title:e,message:t,onClose:n})=>r?l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:s=>{s.target===s.currentTarget&&n()},children:l.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"2px solid #ff4444"},onClick:s=>s.stopPropagation(),children:[l.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",gap:"12px"},children:[l.jsx("div",{style:{fontSize:"24px",color:"#ff4444"},children:""}),l.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:e})]}),l.jsx("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"14px",lineHeight:"1.5"},children:t}),l.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:l.jsx("button",{onClick:n,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"OK"})})]})}):null,m3=({visible:r,selectedIds:e,selectedComponentIds:t,selectedPowerIds:n,selectedGroundIds:s,drawingStrokes:o,componentsTop:d,componentsBottom:c,powers:h,grounds:f,powerBuses:m,onClose:b,setComponentsTop:S,setComponentsBottom:v,determineViaType:P,determinePadType:x,determineTestPointType:k,onFindComponent:N,onFindStroke:$,onFindPower:I,onFindGround:z,position:B,isDragging:G,onDragStart:te,onOpenNotesDialog:F})=>{if(!r)return null;const H=B?{position:"fixed",left:`${B.x}px`,top:`${B.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"150px",maxWidth:"400px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:G?"grabbing":"default"}:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"flex-start",justifyContent:"flex-end",paddingRight:"20px",paddingTop:"80px",zIndex:1e4,pointerEvents:"none"},Q={padding:"20px",overflow:"auto",flex:1};return l.jsxs("div",{style:H,children:[l.jsxs("div",{onMouseDown:M=>{const T=M.target;T.tagName==="BUTTON"||T.closest("button")||B&&te(M)},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:G?"grabbing":B?"grab":"default",userSelect:"none",flexShrink:0},children:[l.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Information (I)"}),l.jsx("button",{onClick:b,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),l.jsx("div",{style:Q,children:l.jsxs("div",{style:{margin:0,padding:0,backgroundColor:"#f5f5f5",borderRadius:4,fontSize:"12px",fontFamily:"monospace",maxHeight:"calc(80vh - 100px)",overflow:"auto",color:"#000"},children:[(()=>{const M=o.filter(V=>e.has(V.id)).length,T=[...d,...c].filter(V=>t.has(V.id)).length,R=h.filter(V=>n.has(V.id)).length,Z=f.filter(V=>s.has(V.id)).length,se=M+T+R+Z;return l.jsx("div",{style:{padding:"12px 16px",backgroundColor:se>0?"#e8e8e8":"#fff3cd",borderBottom:"2px solid #ccc",fontSize:"13px",fontWeight:600,color:se>0?"#333":"#856404",marginBottom:"8px"},children:se>0?`${se} Object${se!==1?"s":""} Selected`:"Zero Objects Selected"})})(),t.size>0&&(()=>{const M=o.some(T=>e.has(T.id)&&(T.type==="via"||T.type==="pad"));return[...d,...c].filter(T=>t.has(T.id)).map(T=>{const R=_d(T),Z=R?.fields,se=Z&&Z.length>0?l.jsx("div",{style:{marginTop:"6px",marginBottom:"6px",padding:"4px 0"},children:Z.map(V=>{const ee=T[V.name];if(ee==null||ee==="")return null;const ae=T[`${V.name}Unit`],Ce=typeof ee=="boolean"?ee?"Yes":"No":ee;return l.jsxs("div",{style:{fontSize:"11px",color:"#444",marginBottom:"2px"},children:[V.label,": ",Ce,ae?` ${ae}`:""]},V.name)})}):l.jsx("div",{style:{padding:"6px 0",fontSize:"11px",color:"#856404",background:"#fff3cd",border:"1px solid #ffeeba",borderRadius:4,marginTop:"6px",marginBottom:"6px"},children:"Component definition missing for this instance. Please ensure componentDefinitions.json entry and componentDefinitionKey are set."});return l.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",flexDirection:"column",gap:"4px",padding:"8px 12px",minHeight:"32px"},children:[l.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:l.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Category:"}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:R?.category||"N/A"})]})}),l.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:R?.displayName?T.componentType==="Capacitor"&&!R.displayName.toLowerCase().includes("capacitor")?`${R.displayName} Capacitor`:R.displayName:T.componentType==="GenericComponent"&&T.genericType?yc(T.genericType):T.componentType==="Diode"&&T.diodeType&&T.diodeType!=="Standard"?yc(T.diodeType):T.componentType==="VariableResistor"&&T.vrType&&T.vrType!=="Potentiometer"?yc(T.vrType):T.componentType==="Capacitor"&&T.dielectric==="Tantalum"?"Tantalum Capacitor":T.componentType==="Capacitor"&&T.capacitorType==="Electrolytic"?"Electrolytic Capacitor":T.componentType==="Capacitor"&&T.capacitorType==="Film"?"Film Capacitor":yc(T.componentType)})]}),N&&l.jsx("button",{onClick:()=>{N(T.id,T.x,T.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:V=>{V.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:V=>{V.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]})]}),l.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[se,l.jsxs("div",{children:["Layer: ",T.layer]}),T.componentType==="IntegratedCircuit"&&l.jsxs(l.Fragment,{children:[T.description&&l.jsxs("div",{children:["Description: ",T.description]}),T.icType&&l.jsxs("div",{children:["IC Type: ",T.icType]})]}),l.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),l.jsx("input",{type:"text",value:T.notes||"",readOnly:!0,onClick:F,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[l.jsxs("span",{children:["Designator: ",T.designator||"(empty)"]}),M&&l.jsx("button",{onClick:()=>{const V=[...d,...c].filter(K=>t.has(K.id)&&K.componentType===T.componentType),ee=V.length,ae=o.filter(K=>e.has(K.id)&&K.type==="pad"&&K.points.length>0&&K.points[0].id!==void 0).map(K=>{const ue=K.points[0].id;if(ue===void 0)throw new Error("Unexpected undefined id");return{stroke:K,nodeId:ue}}).sort((K,ue)=>K.nodeId-ue.nodeId),Ce=ae.length>0?ae:o.filter(K=>e.has(K.id)&&K.type==="via"&&K.points.length>0&&K.points[0].id!==void 0).map(K=>{const ue=K.points[0].id;if(ue===void 0)throw new Error("Unexpected undefined id");return{stroke:K,nodeId:ue}}).sort((K,ue)=>K.nodeId-ue.nodeId),xe=Ce.length;if(xe===0){console.warn("No vias or pads with Node IDs found in selection");return}const J=Math.floor(xe/ee);if(J===0){console.warn(`Not enough ${ae.length>0?"pads":"vias"} (${xe}) for ${ee} components`);return}[...V].sort((K,ue)=>K.id.localeCompare(ue.id)).forEach((K,ue)=>{const Te=ue*J,Pe=Te+J,De=Ce.slice(Te,Pe).map(ot=>ot.nodeId.toString()),et=Um(K,De,o);K.layer==="top"?S(ot=>ot.map(at=>{if(at.id===K.id){const ht={...at,pinCount:J,pinConnections:De};return et&&(ht.pinPolarities=et),ht}return at})):v(ot=>ot.map(at=>{if(at.id===K.id){const ht={...at,pinCount:J,pinConnections:De};return et&&(ht.pinPolarities=et),ht}return at}))});const W=ae.length>0?"pads":"vias";console.log(`Connected ${ee} components of type ${T.componentType} to ${xe} ${W} (${J} pins each)`)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap"},onMouseEnter:V=>{V.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:V=>{V.currentTarget.style.backgroundColor="#4CAF50"},children:"Connect"})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("span",{children:"Color:"}),l.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:T.color,border:"1px solid #ccc",borderRadius:2}}),l.jsx("span",{children:T.color})]}),l.jsxs("div",{children:["Size: ",T.size]}),l.jsxs("div",{children:["Pin Count: ",T.pinCount]}),T.componentType==="Resistor"&&l.jsxs(l.Fragment,{children:[T.resistance&&l.jsxs("div",{children:["Resistance: ",T.resistance]}),T.power&&l.jsxs("div",{children:["Power: ",T.power]}),T.tolerance&&l.jsxs("div",{children:["Tolerance: ",T.tolerance]})]}),T.componentType==="Capacitor"&&l.jsxs(l.Fragment,{children:[T.capacitance&&l.jsxs("div",{children:["Capacitance: ",T.capacitance]}),T.voltage&&l.jsxs("div",{children:["Voltage: ",T.voltage]}),T.dielectric&&l.jsxs("div",{children:["Dielectric: ",T.dielectric]}),T.tolerance&&l.jsxs("div",{children:["Tolerance: ",T.tolerance]})]}),T.componentType==="Electrolytic Capacitor"&&l.jsxs(l.Fragment,{children:[T.capacitance&&l.jsxs("div",{children:["Capacitance: ",T.capacitance]}),T.voltage&&l.jsxs("div",{children:["Voltage: ",T.voltage]}),T.tolerance&&l.jsxs("div",{children:["Tolerance: ",T.tolerance]}),T.polarized!==void 0&&l.jsxs("div",{children:["Polarized: ",T.polarized?"Yes":"No"]}),T.esr&&l.jsxs("div",{children:["ESR: ",T.esr]}),T.temperature&&l.jsxs("div",{children:["Temperature: ",T.temperature]})]}),T.pinConnections&&T.pinConnections.length>0&&(()=>{const V=Sp(T),ee=_d(T),ae=T?.pinNames,Ce=ee?.properties?.pinNames,J=Ce&&Ce.length>0;return l.jsxs("div",{style:{marginTop:"8px",marginBottom:"8px"},children:[l.jsx("div",{style:{marginBottom:"4px",fontWeight:600},children:"Pin Connections:"}),l.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px",border:"1px solid #ddd"},children:[l.jsx("thead",{children:l.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[l.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Pin #"}),J&&l.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Pin Name"}),V&&l.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Polarity"}),l.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Node ID"})]})}),l.jsx("tbody",{children:T.pinConnections.map((D,W)=>{const K=T.pinPolarities&&T.pinPolarities.length>W?T.pinPolarities[W]:"",ue=ae&&W<ae.length?ae[W]:"",Te=Ce&&W<Ce.length?Ce[W]:"",Pe=Te==="CHIP_DEPENDENT",Ve=ue&&ue.trim()!==""?ue:Pe?"":Te;return l.jsxs("tr",{style:{backgroundColor:W%2===0?"#fff":"#f9f9f9"},children:[l.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:W+1}),J&&l.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd",fontSize:"9px",fontStyle:"italic",color:"#555"},children:Ve||"-"}),V&&l.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd",textAlign:"center",fontFamily:"monospace",fontWeight:600,color:K==="+"?"#d32f2f":K==="-"?"#1976d2":"#999"},children:K||"-"}),l.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:D||"(not connected)"})]},W)})})]})]})})(),"manufacturer"in T&&T.manufacturer&&l.jsxs("div",{children:["Manufacturer: ",T.manufacturer]}),"partNumber"in T&&T.partNumber&&l.jsxs("div",{children:["Part Number: ",T.partNumber]}),T.componentType==="Diode"&&l.jsxs(l.Fragment,{children:[T.diodeType&&l.jsxs("div",{children:["Type: ",T.diodeType]}),T.voltage&&l.jsxs("div",{children:["Voltage: ",T.voltage]}),T.current&&l.jsxs("div",{children:["Current: ",T.current]}),T.ledColor&&l.jsxs("div",{children:["LED Color: ",T.ledColor]})]}),T.componentType==="Battery"&&l.jsxs(l.Fragment,{children:[T.voltage&&l.jsxs("div",{children:["Voltage: ",T.voltage]}),T.capacity&&l.jsxs("div",{children:["Capacity: ",T.capacity]}),T.chemistry&&l.jsxs("div",{children:["Chemistry: ",T.chemistry]})]}),T.componentType==="Fuse"&&l.jsxs(l.Fragment,{children:[T.current&&l.jsxs("div",{children:["Current: ",T.current]}),T.voltage&&l.jsxs("div",{children:["Voltage: ",T.voltage]}),T.fuseType&&l.jsxs("div",{children:["Type: ",T.fuseType]})]}),T.componentType==="FerriteBead"&&l.jsxs(l.Fragment,{children:[T.impedance&&l.jsxs("div",{children:["Impedance: ",T.impedance]}),T.current&&l.jsxs("div",{children:["Current: ",T.current]})]}),T.componentType==="Connector"&&l.jsxs(l.Fragment,{children:[T.connectorType&&l.jsxs("div",{children:["Type: ",T.connectorType]}),T.gender&&l.jsxs("div",{children:["Gender: ",T.gender]})]}),T.componentType==="Jumper"&&l.jsx(l.Fragment,{children:T.positions&&l.jsxs("div",{children:["Positions: ",T.positions]})}),T.componentType==="Relay"&&l.jsxs(l.Fragment,{children:[T.coilVoltage&&l.jsxs("div",{children:["Coil Voltage: ",T.coilVoltage]}),T.contactType&&l.jsxs("div",{children:["Contact Type: ",T.contactType]}),T.current&&l.jsxs("div",{children:["Current: ",T.current]})]}),T.componentType==="Inductor"&&l.jsxs(l.Fragment,{children:[T.inductance&&l.jsxs("div",{children:["Inductance: ",T.inductance]}),T.current&&l.jsxs("div",{children:["Current: ",T.current]}),T.resistance&&l.jsxs("div",{children:["DC Resistance: ",T.resistance]})]}),T.componentType==="Speaker"&&l.jsxs(l.Fragment,{children:[T.impedance&&l.jsxs("div",{children:["Impedance: ",T.impedance]}),T.power&&l.jsxs("div",{children:["Power: ",T.power]})]}),T.componentType==="Motor"&&l.jsxs(l.Fragment,{children:[T.motorType&&l.jsxs("div",{children:["Type: ",T.motorType]}),T.voltage&&l.jsxs("div",{children:["Voltage: ",T.voltage]}),T.current&&l.jsxs("div",{children:["Current: ",T.current]})]}),T.componentType==="PowerSupply"&&l.jsxs(l.Fragment,{children:[T.inputVoltage&&l.jsxs("div",{children:["Input Voltage: ",T.inputVoltage]}),T.outputVoltage&&l.jsxs("div",{children:["Output Voltage: ",T.outputVoltage]}),T.current&&l.jsxs("div",{children:["Current: ",T.current]})]}),T.componentType==="Transistor"&&l.jsxs(l.Fragment,{children:[T.transistorType&&l.jsxs("div",{children:["Type: ",T.transistorType]}),T.polarized!==void 0&&l.jsxs("div",{children:["Polarized: ",T.polarized?"Yes":"No"]}),T.voltage&&l.jsxs("div",{children:["Voltage: ",T.voltage]}),T.current&&l.jsxs("div",{children:["Current: ",T.current]})]}),T.componentType==="ResistorNetwork"&&l.jsxs(l.Fragment,{children:[T.resistance&&l.jsxs("div",{children:["Resistance: ",T.resistance]}),T.configuration&&l.jsxs("div",{children:["Configuration: ",T.configuration]})]}),T.componentType==="Thermistor"&&l.jsxs(l.Fragment,{children:[T.resistance&&l.jsxs("div",{children:["Resistance: ",T.resistance]}),T.thermistorType&&l.jsxs("div",{children:["Type: ",T.thermistorType]}),T.beta&&l.jsxs("div",{children:["Beta: ",T.beta]})]}),T.componentType==="Switch"&&l.jsxs(l.Fragment,{children:[T.switchType&&l.jsxs("div",{children:["Type: ",T.switchType]}),T.current&&l.jsxs("div",{children:["Current: ",T.current]}),T.voltage&&l.jsxs("div",{children:["Voltage: ",T.voltage]})]}),T.componentType==="Transformer"&&l.jsxs(l.Fragment,{children:[T.primaryVoltage&&l.jsxs("div",{children:["Primary Voltage: ",T.primaryVoltage]}),T.secondaryVoltage&&l.jsxs("div",{children:["Secondary Voltage: ",T.secondaryVoltage]}),T.power&&l.jsxs("div",{children:["Power: ",T.power]}),T.turns&&l.jsxs("div",{children:["Turns Ratio: ",T.turns]})]}),T.componentType==="TestPoint"&&l.jsx(l.Fragment,{children:T.signal&&l.jsxs("div",{children:["Signal: ",T.signal]})}),T.componentType==="IntegratedCircuit"&&l.jsx(l.Fragment,{children:T.datasheet&&(()=>{const V=T.datasheet.trim(),ee=V.match(/^https?:\/\//)?V:`https://${V}`;return l.jsxs("div",{children:["Datasheet:"," ",l.jsx("a",{href:ee,target:"_blank",rel:"noopener noreferrer",style:{color:"#0066cc",textDecoration:"underline"},children:V})]})})()}),T.componentType==="VacuumTube"&&l.jsx(l.Fragment,{children:T.tubeType&&l.jsxs("div",{children:["Type: ",T.tubeType]})}),T.componentType==="VariableResistor"&&l.jsxs(l.Fragment,{children:[T.vrType&&l.jsxs("div",{children:["Type: ",T.vrType]}),T.resistance&&l.jsxs("div",{children:["Resistance: ",T.resistance]}),T.power&&l.jsxs("div",{children:["Power: ",T.power]}),T.taper&&l.jsxs("div",{children:["Taper: ",T.taper]})]}),T.componentType==="Crystal"&&l.jsxs(l.Fragment,{children:[T.frequency&&l.jsxs("div",{children:["Frequency: ",T.frequency]}),T.loadCapacitance&&l.jsxs("div",{children:["Load Capacitance: ",T.loadCapacitance]}),T.tolerance&&l.jsxs("div",{children:["Tolerance: ",T.tolerance]})]}),T.componentType==="GenericComponent"&&l.jsxs(l.Fragment,{children:[T.genericType&&l.jsxs("div",{children:["Type: ",T.genericType]}),T.voltage&&l.jsxs("div",{children:["Voltage: ",T.voltage," ",T.voltageUnit||"V"]}),T.current&&l.jsxs("div",{children:["Current: ",T.current," ",T.currentUnit||"A"]}),T.power&&l.jsxs("div",{children:["Power: ",T.power]}),T.frequency&&l.jsxs("div",{children:["Frequency: ",T.frequency]}),T.model&&l.jsxs("div",{children:["Model: ",T.model]})]}),l.jsx("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid #eee",fontSize:"10px",color:"#999"},children:l.jsxs("div",{children:["Position: x=",T.x.toFixed(2),", y=",T.y.toFixed(2)]})})]})]},T.id)})})(),e.size>0&&o.filter(M=>e.has(M.id)&&M.type==="via"&&M.points.length>0).map(M=>{const T=M.points[0],R=M.viaType||(T.id!==void 0?P(T.id,m):"Via");return l.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:R})]}),$&&l.jsx("button",{onClick:()=>{$(M.id,T.x,T.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:Z=>{Z.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:Z=>{Z.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),l.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[T.id&&l.jsxs("div",{children:["Node ID: ",T.id]}),l.jsx("div",{children:"Layer: Top and Bottom"}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("span",{children:"Color:"}),l.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:M.color,border:"1px solid #ccc",borderRadius:2}}),l.jsx("span",{children:M.color})]}),l.jsxs("div",{children:["Size: ",M.size]}),l.jsxs("div",{children:["Position: x=",T.x.toFixed(2),", y=",T.y.toFixed(2)]}),l.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),l.jsx("input",{type:"text",value:M.notes||"",readOnly:!0,onClick:F,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},M.id)}),e.size>0&&o.filter(M=>e.has(M.id)&&M.type==="pad"&&M.points.length>0).map(M=>{const T=M.points[0],R=M.padType||(T.id!==void 0?x(T.id,m):"Pad");return l.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:R})]}),$&&l.jsx("button",{onClick:()=>{$(M.id,T.x,T.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:Z=>{Z.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:Z=>{Z.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),l.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[T.id&&l.jsxs("div",{children:["Node ID: ",T.id]}),l.jsxs("div",{children:["Layer: ",M.layer]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("span",{children:"Color:"}),l.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:M.color,border:"1px solid #ccc",borderRadius:2}}),l.jsx("span",{children:M.color})]}),l.jsxs("div",{children:["Size: ",M.size]}),l.jsxs("div",{children:["Position: x=",T.x.toFixed(2),", y=",T.y.toFixed(2)]}),l.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),l.jsx("input",{type:"text",value:M.notes||"",readOnly:!0,onClick:F,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},M.id)}),e.size>0&&o.filter(M=>e.has(M.id)&&M.type==="testPoint"&&M.points.length>0).map(M=>{const T=M.points[0],R=T.id!==void 0?k(T.id,m):"Test Point";return l.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:R})]}),$&&l.jsx("button",{onClick:()=>{$(M.id,T.x,T.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:Z=>{Z.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:Z=>{Z.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),l.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[T.id&&l.jsxs("div",{children:["Node ID: ",T.id]}),l.jsxs("div",{children:["Layer: ",M.layer]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("span",{children:"Color:"}),l.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:M.color,border:"1px solid #ccc",borderRadius:2}}),l.jsx("span",{children:M.color})]}),l.jsxs("div",{children:["Size: ",M.size]}),l.jsxs("div",{children:["Position: x=",T.x.toFixed(2),", y=",T.y.toFixed(2)]}),l.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),l.jsx("input",{type:"text",value:M.notes||"",readOnly:!0,onClick:F,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},M.id)}),e.size>0&&o.filter(M=>e.has(M.id)&&M.type==="trace").map(M=>{const T=M.points.length>0?M.points.reduce((Z,se)=>Z+se.x,0)/M.points.length:0,R=M.points.length>0?M.points.reduce((Z,se)=>Z+se.y,0)/M.points.length:0;return l.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:M.type||"unknown"})]}),$&&M.points.length>0&&l.jsx("button",{onClick:()=>{$(M.id,T,R)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:Z=>{Z.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:Z=>{Z.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),l.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[M.points.length>0&&l.jsxs("div",{style:{marginTop:"8px",marginBottom:"8px"},children:[l.jsxs("div",{style:{marginBottom:"4px",fontWeight:600},children:["Points: ",M.points.length]}),l.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px",border:"1px solid #ddd"},children:[l.jsx("thead",{children:l.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[l.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Point #"}),l.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"x"}),l.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"y"}),l.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Node ID"})]})}),l.jsx("tbody",{children:M.points.map((Z,se)=>l.jsxs("tr",{style:{backgroundColor:se%2===0?"#fff":"#f9f9f9"},children:[l.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:se}),l.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:Z.x.toFixed(2)}),l.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:Z.y.toFixed(2)}),l.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:Z.id||"(none)"})]},se))})]})]}),l.jsxs("div",{style:{marginTop:"4px"},children:["Layer: ",M.layer]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("span",{children:"Color:"}),l.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:M.color,border:"1px solid #ccc",borderRadius:2}}),l.jsx("span",{children:M.color})]}),l.jsxs("div",{children:["Size: ",M.size]}),l.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),l.jsx("input",{type:"text",value:M.notes||"",readOnly:!0,onClick:F,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},M.id)}),n.size>0&&h.filter(M=>n.has(M.id)).map(M=>{const T=m.find(R=>R.id===M.powerBusId);return l.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:M.type||(T?`${T.name} Power Node`:"Power Node")})]}),I&&l.jsx("button",{onClick:()=>{I(M.id,M.x,M.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:R=>{R.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:R=>{R.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),l.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[l.jsxs("div",{children:["Node ID: ",M.pointId||"(not assigned)"]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("span",{children:"Color:"}),l.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:M.color,border:"1px solid #ccc",borderRadius:2}}),l.jsx("span",{children:M.color})]}),l.jsxs("div",{children:["Size: ",M.size]}),l.jsxs("div",{children:["Layer: ",M.layer]}),l.jsxs("div",{children:["Power Bus: ",T?.name||M.powerBusId||"(unknown)"]}),l.jsxs("div",{children:["Position: x=",M.x.toFixed(2),", y=",M.y.toFixed(2)]}),l.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),l.jsx("input",{type:"text",value:M.notes||"",readOnly:!0,onClick:F,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},M.id)}),s.size>0&&f.filter(M=>s.has(M.id)).map(M=>l.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:M.type||"Ground Node"})]}),z&&l.jsx("button",{onClick:()=>{z(M.id,M.x,M.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:T=>{T.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:T=>{T.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),l.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[l.jsxs("div",{children:["Node ID: ",M.pointId||"(not assigned)"]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("span",{children:"Color:"}),l.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:M.color,border:"1px solid #ccc",borderRadius:2}}),l.jsx("span",{children:M.color})]}),l.jsxs("div",{children:["Size: ",M.size]}),l.jsxs("div",{children:["Position: x=",M.x.toFixed(2),", y=",M.y.toFixed(2)]}),l.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),l.jsx("input",{type:"text",value:M.notes||"",readOnly:!0,onClick:F,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},M.id))]})})]})},Lr=200,y3=({visible:r,selectedIds:e,selectedComponentIds:t,selectedPowerIds:n,selectedGroundIds:s,drawingStrokes:o,componentsTop:d,componentsBottom:c,powers:h,grounds:f,powerBuses:m,onClose:b,setComponentsTop:S,setComponentsBottom:v,setDrawingStrokes:P,setPowerSymbols:x,setGroundSymbols:k,determineViaType:N,determinePadType:$,determineTestPointType:I,position:z,isDragging:B,onDragStart:G})=>{const[te,F]=X.useState(new Map),H=X.useRef(""),Q=()=>[...Array.from(e).sort(),...Array.from(t).sort(),...Array.from(n).sort(),...Array.from(s).sort()].join(",");if(X.useEffect(()=>{if(!r)return;const xe=Q();xe!==H.current&&(H.current=xe,F(J=>{const D=new Map;return[...d,...c].filter(W=>t.has(W.id)).forEach(W=>{const K=J.get(W.id);D.set(W.id,K!==void 0?K:W.notes||"")}),o.filter(W=>e.has(W.id)).forEach(W=>{const K=J.get(W.id);D.set(W.id,K!==void 0?K:W.notes||"")}),h.filter(W=>n.has(W.id)).forEach(W=>{const K=J.get(W.id);D.set(W.id,K!==void 0?K:W.notes||"")}),f.filter(W=>s.has(W.id)).forEach(W=>{const K=J.get(W.id);D.set(W.id,K!==void 0?K:W.notes||"")}),D}))},[r,e,t,n,s,o,d,c,h,f]),!r)return null;const M=z?{position:"fixed",left:`${z.x}px`,top:`${z.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"150px",maxWidth:"400px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:B?"grabbing":"default"}:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"flex-start",justifyContent:"flex-end",paddingRight:"20px",paddingTop:"80px",zIndex:1e4,pointerEvents:"none"},T={padding:"20px",overflow:"auto",flex:1},R=o.filter(xe=>e.has(xe.id)).length,Z=[...d,...c].filter(xe=>t.has(xe.id)).length,se=h.filter(xe=>n.has(xe.id)).length,V=f.filter(xe=>s.has(xe.id)).length,ee=R+Z+se+V,ae=(xe,J)=>{const D=J.length>Lr?J.substring(0,Lr):J;F(W=>{const K=new Map(W);return K.set(xe,D),K})},Ce=()=>{S(xe=>xe.map(J=>{if(t.has(J.id)&&te.has(J.id)){const D=te.get(J.id)||"";return{...J,notes:D.trim()===""?void 0:D.trim()}}return J})),v(xe=>xe.map(J=>{if(t.has(J.id)&&te.has(J.id)){const D=te.get(J.id)||"";return{...J,notes:D.trim()===""?void 0:D.trim()}}return J})),P(xe=>xe.map(J=>{if(e.has(J.id)&&te.has(J.id)){const D=te.get(J.id)||"";return{...J,notes:D.trim()===""?null:D.trim()}}return J})),x(xe=>xe.map(J=>{if(n.has(J.id)&&te.has(J.id)){const D=te.get(J.id)||"";return{...J,notes:D.trim()===""?null:D.trim()}}return J})),k(xe=>xe.map(J=>{if(s.has(J.id)&&te.has(J.id)){const D=te.get(J.id)||"";return{...J,notes:D.trim()===""?null:D.trim()}}return J}))};return l.jsxs("div",{style:M,children:[l.jsxs("div",{onMouseDown:xe=>{const J=xe.target;J.tagName==="BUTTON"||J.closest("button")||z&&G(xe)},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:B?"grabbing":z?"grab":"default",userSelect:"none",flexShrink:0},children:[l.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Notes (N)"}),l.jsx("button",{onClick:b,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),l.jsx("div",{style:T,children:l.jsxs("div",{style:{margin:0,padding:0,backgroundColor:"#f5f5f5",borderRadius:4,fontSize:"12px",fontFamily:"monospace",maxHeight:"calc(80vh - 100px)",overflow:"auto",color:"#000"},children:[l.jsx("div",{style:{padding:"12px 16px",backgroundColor:ee>0?"#e8e8e8":"#fff3cd",borderBottom:"2px solid #ccc",fontSize:"13px",fontWeight:600,color:ee>0?"#333":"#856404",marginBottom:"8px"},children:ee>0?`${ee} Object${ee!==1?"s":""} Selected`:"Zero Objects Selected"}),ee===0?l.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"No objects selected. Select one or more objects to add or edit notes."}):l.jsxs(l.Fragment,{children:[[...d,...c].filter(xe=>t.has(xe.id)).map(xe=>{const J=te.get(xe.id)||"",D=J.length;return l.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),l.jsxs("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:[yc(xe.componentType),xe.designator&&xe.designator.trim()?` (${xe.designator.trim()})`:""]})]}),l.jsxs("div",{style:{padding:"8px"},children:[l.jsx("textarea",{value:J,onChange:W=>ae(xe.id,W.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Lr,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),l.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:D>=Lr?"#d32f2f":"#666",textAlign:"right"},children:[D," / ",Lr]})]})]},xe.id)}),o.filter(xe=>e.has(xe.id)&&xe.type==="via"&&xe.points.length>0).map(xe=>{const J=xe.points[0],D=xe.viaType||(J.id!==void 0?N(J.id,m):"Via"),W=te.get(xe.id)||"",K=W.length;return l.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:D})]}),l.jsxs("div",{style:{padding:"8px"},children:[l.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:J.id&&l.jsxs("div",{children:["Node ID: ",J.id]})}),l.jsx("textarea",{value:W,onChange:ue=>ae(xe.id,ue.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Lr,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),l.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:K>=Lr?"#d32f2f":"#666",textAlign:"right"},children:[K," / ",Lr]})]})]},xe.id)}),o.filter(xe=>e.has(xe.id)&&xe.type==="pad"&&xe.points.length>0).map(xe=>{const J=xe.points[0],D=xe.padType||(J.id!==void 0?$(J.id,m):"Pad"),W=te.get(xe.id)||"",K=W.length;return l.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:D})]}),l.jsxs("div",{style:{padding:"8px"},children:[l.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:J.id&&l.jsxs("div",{children:["Node ID: ",J.id]})}),l.jsx("textarea",{value:W,onChange:ue=>ae(xe.id,ue.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Lr,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),l.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:K>=Lr?"#d32f2f":"#666",textAlign:"right"},children:[K," / ",Lr]})]})]},xe.id)}),o.filter(xe=>e.has(xe.id)&&xe.type==="testPoint"&&xe.points.length>0).map(xe=>{const J=xe.points[0],D=J.id!==void 0?I(J.id,m):"Test Point",W=te.get(xe.id)||"",K=W.length;return l.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:D})]}),l.jsxs("div",{style:{padding:"8px"},children:[l.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:J.id&&l.jsxs("div",{children:["Node ID: ",J.id]})}),l.jsx("textarea",{value:W,onChange:ue=>ae(xe.id,ue.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Lr,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),l.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:K>=Lr?"#d32f2f":"#666",textAlign:"right"},children:[K," / ",Lr]})]})]},xe.id)}),o.filter(xe=>e.has(xe.id)&&xe.type==="trace").map(xe=>{const J=te.get(xe.id)||"",D=J.length;return l.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:xe.type||"unknown"})]}),l.jsxs("div",{style:{padding:"8px"},children:[l.jsx("textarea",{value:J,onChange:W=>ae(xe.id,W.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Lr,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),l.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:D>=Lr?"#d32f2f":"#666",textAlign:"right"},children:[D," / ",Lr]})]})]},xe.id)}),h.filter(xe=>n.has(xe.id)).map(xe=>{const J=m.find(ue=>ue.id===xe.powerBusId),D=xe.type||(J?`${J.name} Power Node`:"Power Node"),W=te.get(xe.id)||"",K=W.length;return l.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:D})]}),l.jsxs("div",{style:{padding:"8px"},children:[l.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:l.jsxs("div",{children:["Node ID: ",xe.pointId||"(not assigned)"]})}),l.jsx("textarea",{value:W,onChange:ue=>ae(xe.id,ue.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Lr,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),l.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:K>=Lr?"#d32f2f":"#666",textAlign:"right"},children:[K," / ",Lr]})]})]},xe.id)}),f.filter(xe=>s.has(xe.id)).map(xe=>{const J=xe.type||"Ground Node",D=te.get(xe.id)||"",W=D.length;return l.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:J})]}),l.jsxs("div",{style:{padding:"8px"},children:[l.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:l.jsxs("div",{children:["Node ID: ",xe.pointId||"(not assigned)"]})}),l.jsx("textarea",{value:D,onChange:K=>ae(xe.id,K.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Lr,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),l.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:W>=Lr?"#d32f2f":"#666",textAlign:"right"},children:[W," / ",Lr]})]})]},xe.id)}),l.jsxs("div",{style:{marginTop:"20px",padding:"12px",display:"flex",justifyContent:"flex-end",gap:"8px",borderTop:"1px solid #ddd"},children:[l.jsx("button",{onClick:b,style:{padding:"8px 16px",fontSize:"12px",backgroundColor:"#757575",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500},onMouseEnter:xe=>{xe.currentTarget.style.backgroundColor="#616161"},onMouseLeave:xe=>{xe.currentTarget.style.backgroundColor="#757575"},children:"Close"}),l.jsx("button",{onClick:Ce,style:{padding:"8px 16px",fontSize:"12px",backgroundColor:"#2196F3",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500},onMouseEnter:xe=>{xe.currentTarget.style.backgroundColor="#1976D2"},onMouseLeave:xe=>{xe.currentTarget.style.backgroundColor="#2196F3"},children:"Save"})]})]})]})})]})},x3=({visible:r,projectNotes:e,setProjectNotes:t,onClose:n,position:s,isDragging:o,onDragStart:d})=>{const[c,h]=X.useState([]),[f,m]=X.useState(null),[b,S]=X.useState(null),v=X.useRef(new Map),[P,x]=X.useState({width:Math.min(window.innerWidth*.85,1400),height:window.innerHeight*.7}),[k,N]=X.useState(!1),[$,I]=X.useState({x:0,y:0,width:0,height:0});X.useEffect(()=>{r&&(h([...e]),m(null),S(null))},[r,e]),X.useEffect(()=>{if(!k)return;const se=ee=>{const ae=ee.clientX-$.x,Ce=ee.clientY-$.y,xe=Math.max(400,Math.min(window.innerWidth-20,$.width+ae)),J=Math.max(300,Math.min(window.innerHeight-20,$.height+Ce));x({width:xe,height:J})},V=()=>{N(!1)};return document.addEventListener("mousemove",se),document.addEventListener("mouseup",V),()=>{document.removeEventListener("mousemove",se),document.removeEventListener("mouseup",V)}},[k,$]);const z=se=>{se.preventDefault(),se.stopPropagation(),N(!0),I({x:se.clientX,y:se.clientY,width:P.width,height:P.height})};if(!r)return null;const B=()=>{const se={name:"",value:"",checked:!1};h([...c,se]),m(c.length),S("name")},G=se=>{const V=c.filter((ee,ae)=>ae!==se);h(V),f===se?(m(null),S(null)):f!==null&&f>se&&m(f-1)},te=()=>{const se=c.filter(V=>V.name.trim()!==""||V.value.trim()!=="");t(se),n()},F=()=>{h([...e]),m(null),S(null),n()},H=(se,V,ee)=>{const ae=[...c];ae[se]={...ae[se],[V]:ee},h(ae)},Q=(se,V)=>{const ee=[...c];ee[se]={...ee[se],checked:V},h(ee)},M=(se,V,ee)=>{se.stopPropagation();const ae=se.currentTarget,Ce=ae.selectionStart,xe=ae.value.length,J=ae.selectionStart!==ae.selectionEnd;if(!(se.key==="Enter"&&se.altKey)){if(se.key==="ArrowRight"&&!se.ctrlKey&&!se.shiftKey&&!se.altKey){if(Ce===xe&&!J&&ee==="name"){se.preventDefault();const D=`${V}-value`,W=v.current.get(D);W&&(W.focus(),W.setSelectionRange(0,0))}return}if(se.key==="ArrowLeft"&&!se.ctrlKey&&!se.shiftKey&&!se.altKey){if(Ce===0&&!J&&ee==="value"){se.preventDefault();const D=`${V}-name`,W=v.current.get(D);W&&(W.focus(),W.setSelectionRange(W.value.length,W.value.length))}return}if(se.key==="ArrowDown"&&!se.ctrlKey&&!se.shiftKey&&!se.altKey){if(se.preventDefault(),V<c.length-1){const D=`${V+1}-${ee}`,W=v.current.get(D);if(W){W.focus();const K=Math.min(Ce,W.value.length);W.setSelectionRange(K,K)}}else{const D=c.length;B(),setTimeout(()=>{const W=`${D}-${ee}`,K=v.current.get(W);K&&(K.focus(),K.setSelectionRange(0,0))},0)}return}if(se.key==="ArrowUp"&&!se.ctrlKey&&!se.shiftKey&&!se.altKey){if(se.preventDefault(),V>0){const D=`${V-1}-${ee}`,W=v.current.get(D);if(W){W.focus();const K=Math.min(Ce,W.value.length);W.setSelectionRange(K,K)}}return}if(se.key==="Enter"&&!se.altKey&&!se.shiftKey){if(se.preventDefault(),ee==="name"){const D=`${V}-value`,W=v.current.get(D);W&&(W.focus(),W.setSelectionRange(0,0))}else if(ee==="value")if(V<c.length-1){const D=`${V+1}-name`,W=v.current.get(D);W&&(W.focus(),W.setSelectionRange(0,0))}else{const D=c.length;B(),setTimeout(()=>{const W=`${D}-name`,K=v.current.get(W);K&&(K.focus(),K.setSelectionRange(0,0))},0)}return}if(se.key==="Tab"&&!se.shiftKey){if(se.preventDefault(),ee==="name"){const D=`${V}-value`,W=v.current.get(D);W&&(W.focus(),W.select())}else if(ee==="value")if(V<c.length-1){const D=`${V+1}-name`,W=v.current.get(D);W&&(W.focus(),W.select())}else{const D=c.length;B(),setTimeout(()=>{const W=`${D}-name`,K=v.current.get(W);K&&K.focus()},0)}return}if(se.key==="Tab"&&se.shiftKey){if(se.preventDefault(),ee==="value"){const D=`${V}-name`,W=v.current.get(D);W&&(W.focus(),W.select())}else if(ee==="name"&&V>0){const D=`${V-1}-value`,W=v.current.get(D);W&&(W.focus(),W.select())}return}}},T=(se,V)=>{m(se),S(V)},R=()=>{},Z={position:"fixed",top:s?.y??100,left:s?.x??(window.innerWidth-P.width)/2,width:`${P.width}px`,height:`${P.height}px`,backgroundColor:"#fff",borderRadius:8,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:o?"grabbing":"default",overflow:"hidden"};return l.jsxs("div",{style:Z,children:[l.jsxs("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e0e0",background:"#888",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"move",userSelect:"none"},onMouseDown:d,children:[l.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Project Notes / TODO List (L)"}),l.jsx("button",{onClick:F,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:"0 4px",lineHeight:1},title:"Close",children:""})]}),l.jsxs("div",{className:"project-notes-content",style:{padding:0,flex:1,overflowY:"auto",overflowX:"hidden",display:"flex",flexDirection:"column",minHeight:0,scrollbarWidth:"thin",scrollbarColor:"#888 #f0f0f0"},children:[l.jsxs("div",{style:{border:"none",borderTop:"1px solid #ccc",borderRadius:0,overflow:"visible",marginBottom:"16px",backgroundColor:"#e0e0e0",flexShrink:0},children:[l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"40px 1fr 3fr auto",backgroundColor:"#e0e0e0",borderBottom:"1px solid #ccc",position:"sticky",top:0,zIndex:10},children:[l.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",display:"flex",alignItems:"center",justifyContent:"center",color:"#000"},children:l.jsx("label",{className:"radio-label",style:{margin:0,cursor:"default"},children:l.jsx("input",{type:"checkbox",disabled:!0,style:{opacity:.5}})})}),l.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",color:"#000"},children:"Item"}),l.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",color:"#000"},children:"Notes"}),l.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",color:"#000"}})]}),l.jsx("div",{children:c.length===0?l.jsx("div",{style:{padding:"24px",textAlign:"center",color:"#999",fontSize:"13px"},children:'No notes. Click "Add Note" to create one.'}):c.map((se,V)=>l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"40px 1fr 3fr auto",borderBottom:"1px solid #ccc",backgroundColor:"#fff"},children:[l.jsx("div",{style:{padding:"8px 12px",borderRight:"1px solid #ccc",display:"flex",alignItems:"center",justifyContent:"center"},children:l.jsx("label",{className:"radio-label",style:{margin:0,cursor:"pointer"},children:l.jsx("input",{type:"checkbox",checked:se.checked||!1,onChange:ee=>Q(V,ee.target.checked)})})}),l.jsx("div",{style:{padding:"4px",borderRight:"1px solid #ccc"},children:l.jsx("textarea",{ref:ee=>{ee?v.current.set(`${V}-name`,ee):v.current.delete(`${V}-name`)},value:se.name,onChange:ee=>H(V,"name",ee.target.value),onFocus:()=>T(V,"name"),onBlur:R,onKeyDown:ee=>M(ee,V,"name"),placeholder:"Item name...",rows:1,style:{width:"100%",padding:"4px 6px",border:f===V&&b==="name"?"2px solid #0b5fff":"1px solid transparent",borderRadius:3,fontSize:"12px",backgroundColor:"#fff",color:"#000",fontFamily:"inherit",resize:"none",minHeight:"24px",lineHeight:"1.4",overflow:"hidden",outline:"none",boxSizing:"border-box"},onInput:ee=>{const ae=ee.target;ae.style.height="auto",ae.style.height=`${ae.scrollHeight}px`}})}),l.jsx("div",{style:{padding:"4px",borderRight:"1px solid #ccc"},children:l.jsx("textarea",{ref:ee=>{ee?v.current.set(`${V}-value`,ee):v.current.delete(`${V}-value`)},value:se.value,onChange:ee=>H(V,"value",ee.target.value),onFocus:()=>T(V,"value"),onBlur:R,onKeyDown:ee=>M(ee,V,"value"),placeholder:"Notes...",rows:1,style:{width:"100%",padding:"4px 6px",border:f===V&&b==="value"?"2px solid #0b5fff":"1px solid transparent",borderRadius:3,fontSize:"12px",backgroundColor:"#fff",color:"#000",fontFamily:"inherit",resize:"none",minHeight:"24px",lineHeight:"1.4",overflow:"hidden",outline:"none",boxSizing:"border-box"},onInput:ee=>{const ae=ee.target;ae.style.height="auto",ae.style.height=`${ae.scrollHeight}px`}})}),l.jsx("div",{style:{padding:"8px 12px",display:"flex",alignItems:"center",justifyContent:"center"},children:l.jsx("button",{onClick:()=>G(V),style:{background:"#f44336",color:"#fff",border:"none",borderRadius:3,padding:"4px 8px",cursor:"pointer",fontSize:"11px"},title:"Delete note",children:"Delete"})})]},V))})]}),l.jsx("div",{style:{padding:"16px",flexShrink:0},children:l.jsx("button",{onClick:B,style:{background:"#888",color:"#fff",border:"none",borderRadius:4,padding:"8px 16px",cursor:"pointer",fontSize:"12px",fontWeight:500,alignSelf:"flex-start"},children:"+ Add Note"})})]}),l.jsxs("div",{style:{padding:"12px 16px",borderTop:"1px solid #ddd",display:"flex",justifyContent:"flex-end",gap:"8px",flexShrink:0},children:[l.jsx("button",{onClick:F,style:{background:"#f5f5f5",color:"#000",border:"1px solid #ddd",borderRadius:4,padding:"6px 16px",cursor:"pointer",fontSize:"12px"},children:"Cancel"}),l.jsx("button",{onClick:te,style:{background:"#0b5fff",color:"#fff",border:"none",borderRadius:4,padding:"6px 16px",cursor:"pointer",fontSize:"12px",fontWeight:500},children:"Save"})]}),l.jsx("div",{onMouseDown:z,style:{position:"absolute",bottom:0,right:0,width:"20px",height:"20px",cursor:"nwse-resize",background:"linear-gradient(135deg, transparent 0%, transparent 40%, #ccc 40%, #ccc 45%, transparent 45%, transparent 55%, #ccc 55%, #ccc 60%, transparent 60%)",zIndex:10001},title:"Drag to resize"})]})},b3=({visible:r,dimensions:e,onSave:t,onClose:n})=>{const[s,o]=X.useState(""),[d,c]=X.useState(""),[h,f]=X.useState("inches");X.useEffect(()=>{r&&e?(o(e.width.toString()),c(e.height.toString()),f(e.unit)):r&&(o(""),c(""),f("inches"))},[r,e]);const m=()=>{const S=parseFloat(s),v=parseFloat(d);if(isNaN(S)||S<=0){alert("Please enter a valid width greater than 0");return}if(isNaN(v)||v<=0){alert("Please enter a valid height greater than 0");return}t({width:S,height:v,unit:h}),n()},b=()=>{n()};return r?l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:S=>{S.target===S.currentTarget&&b()},children:l.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"320px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #444"},onClick:S=>S.stopPropagation(),children:[l.jsx("h3",{style:{margin:"0 0 20px 0",color:"#fff",fontSize:"18px",fontWeight:600},children:"Board Dimensions"}),l.jsxs("div",{style:{marginBottom:"16px"},children:[l.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#ddd",fontSize:"14px"},children:"Width"}),l.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[l.jsx("input",{type:"number",step:"0.001",min:"0.001",value:s,onChange:S=>o(S.target.value),style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px"},placeholder:"0.000"}),l.jsxs("select",{value:h,onChange:S=>f(S.target.value),style:{padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px",cursor:"pointer"},children:[l.jsx("option",{value:"inches",children:"inches"}),l.jsx("option",{value:"mm",children:"mm"})]})]})]}),l.jsxs("div",{style:{marginBottom:"20px"},children:[l.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#ddd",fontSize:"14px"},children:"Height"}),l.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[l.jsx("input",{type:"number",step:"0.001",min:"0.001",value:d,onChange:S=>c(S.target.value),style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px"},placeholder:"0.000"}),l.jsxs("select",{value:h,onChange:S=>f(S.target.value),style:{padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px",cursor:"pointer"},children:[l.jsx("option",{value:"inches",children:"inches"}),l.jsx("option",{value:"mm",children:"mm"})]})]})]}),l.jsx("div",{style:{marginBottom:"12px",padding:"10px",background:"#1f1f24",borderRadius:4,fontSize:"12px",color:"#bbb"},children:"This information will be used to convert pixel coordinates to real-world measurements."}),l.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[l.jsx("button",{onClick:b,style:{padding:"8px 16px",background:"#444",color:"#fff",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px"},children:"Cancel"}),l.jsx("button",{onClick:m,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Save"})]})]})}):null},v3=({visible:r,onClose:e,topImage:t,bottomImage:n,selectedImageForTransform:s,setSelectedImageForTransform:o,transformMode:d,setTransformMode:c,updateImageTransform:h,resetImageTransform:f,setCurrentTool:m,isGrayscale:b,setIsGrayscale:S,areImagesLocked:v})=>{const[P,x]=X.useState(null),[k,N]=X.useState(!1),$=X.useRef({x:0,y:0}),I=X.useRef(null);X.useEffect(()=>{r&&P===null&&x({x:window.innerWidth-320-20,y:80})},[r,P]),X.useEffect(()=>{r||x(null)},[r]);const z=X.useCallback(K=>{if(I.current){const ue=I.current.getBoundingClientRect();$.current={x:K.clientX-ue.left,y:K.clientY-ue.top},N(!0)}},[]);if(X.useEffect(()=>{if(!k)return;const K=Te=>{const Pe=Te.clientX-$.current.x,Ve=Te.clientY-$.current.y,De=I.current?.offsetWidth||320,et=I.current?.offsetHeight||600,ot=Math.max(0,Math.min(Pe,window.innerWidth-De)),at=Math.max(0,Math.min(Ve,window.innerHeight-et));x({x:ot,y:at})},ue=()=>{N(!1)};return document.addEventListener("mousemove",K),document.addEventListener("mouseup",ue),()=>{document.removeEventListener("mousemove",K),document.removeEventListener("mouseup",ue)}},[k]),!r)return null;const B=t!==null,G=n!==null,te=B||G,F=B&&G,H=s||(B?"top":G?"bottom":null),Q=()=>H==="top"&&t?t.brightness??100:H==="bottom"&&n?n.brightness??100:H==="both"&&t?t.brightness??100:100,M=()=>H==="top"&&t?t.contrast??100:H==="bottom"&&n?n.contrast??100:H==="both"&&t?t.contrast??100:100,T=Q(),R=M(),Z=!te||v,se=()=>{if(!(!H||Z))if(H==="both"){const K=!t?.flipX;h("both",{flipX:K})}else{const K=H==="top"?t?.flipX||!1:n?.flipX||!1;h(H,{flipX:!K})}},V=()=>{if(!(!H||Z))if(H==="both"){const K=!t?.flipY;h("both",{flipY:K})}else{const K=H==="top"?t?.flipY||!1:n?.flipY||!1;h(H,{flipY:!K})}},ee=K=>{Z||(H&&o(H),c(K),m("transform"))},ae=K=>{!H||Z||h(H,{brightness:K})},Ce=K=>{!H||Z||h(H,{contrast:K})},xe=()=>{Z||(H&&o(H),m("transform"),S(!b))},J=()=>{Z||(m("transform"),f())},D=(K,ue=!1)=>({display:"block",width:"100%",textAlign:"left",padding:"8px 12px",color:K?"#666":"#f2f2f2",background:ue?"#3a3a42":"transparent",border:"none",borderRadius:4,cursor:K?"not-allowed":"pointer",fontSize:"13px",transition:"background 0.15s"}),W=(K,ue)=>({display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",color:K?"#666":"#f2f2f2",cursor:K?"not-allowed":"pointer",fontSize:"13px",background:ue?"#3a3a42":"transparent",borderRadius:4,transition:"background 0.15s"});return l.jsxs("div",{ref:I,style:{position:"fixed",top:P?.y??80,left:P?.x??window.innerWidth-340,backgroundColor:"#2b2b31",borderRadius:8,minWidth:"320px",maxWidth:"400px",maxHeight:"calc(100vh - 100px)",overflowY:"auto",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24",zIndex:10001},children:[l.jsxs("div",{onMouseDown:z,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 16px",background:"linear-gradient(to bottom, #3a3a42, #2b2b31)",borderTopLeftRadius:8,borderTopRightRadius:8,borderBottom:"1px solid #1f1f24",cursor:k?"grabbing":"grab",userSelect:"none"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[l.jsx("span",{style:{color:"#888",fontSize:"14px"},children:""}),l.jsx("h2",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#f2f2f2"},children:"Transform Images"})]}),l.jsx("button",{onClick:e,style:{background:"transparent",border:"none",color:"#888",fontSize:"16px",cursor:"pointer",padding:"2px 6px",lineHeight:1,borderRadius:4},onMouseEnter:K=>{K.currentTarget.style.background="#444",K.currentTarget.style.color="#fff"},onMouseLeave:K=>{K.currentTarget.style.background="transparent",K.currentTarget.style.color="#888"},children:""})]}),l.jsxs("div",{style:{padding:"16px"},children:[l.jsxs("div",{style:{marginBottom:"16px"},children:[l.jsx("div",{style:{fontSize:"12px",color:"#888",marginBottom:"8px",fontWeight:500},children:"Apply to:"}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[l.jsxs("label",{style:W(!B,H==="top"),children:[l.jsx("input",{type:"radio",name:"imageSelection",checked:H==="top",onChange:()=>o("top"),disabled:!B,style:{accentColor:"#6b9fff"}}),"Top Image",!B&&l.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(not loaded)"})]}),l.jsxs("label",{style:W(!G,H==="bottom"),children:[l.jsx("input",{type:"radio",name:"imageSelection",checked:H==="bottom",onChange:()=>o("bottom"),disabled:!G,style:{accentColor:"#6b9fff"}}),"Bottom Image",!G&&l.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(not loaded)"})]}),l.jsxs("label",{style:W(!F,H==="both"),children:[l.jsx("input",{type:"radio",name:"imageSelection",checked:H==="both",onChange:()=>o("both"),disabled:!F,style:{accentColor:"#6b9fff"}}),"Both Images",!F&&l.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(need both)"})]})]})]}),l.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),l.jsxs("div",{style:{marginBottom:"12px"},children:[l.jsx("button",{onClick:se,disabled:Z,style:D(Z),onMouseEnter:K=>!Z&&(K.currentTarget.style.background="#3a3a42"),onMouseLeave:K=>K.currentTarget.style.background="transparent",children:"Horizontal Flip"}),l.jsx("button",{onClick:V,disabled:Z,style:D(Z),onMouseEnter:K=>!Z&&(K.currentTarget.style.background="#3a3a42"),onMouseLeave:K=>K.currentTarget.style.background="transparent",children:"Vertical Flip"})]}),l.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),l.jsx("div",{style:{marginBottom:"12px"},children:["nudge","scale","rotate","slant","keystone"].map(K=>l.jsxs("button",{onClick:()=>ee(K),disabled:Z,style:D(Z,d===K),onMouseEnter:ue=>!Z&&d!==K&&(ue.currentTarget.style.background="#3a3a42"),onMouseLeave:ue=>d!==K&&(ue.currentTarget.style.background="transparent"),children:[d===K?" ":"","Mode: ",K.charAt(0).toUpperCase()+K.slice(1)]},K))}),l.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),l.jsxs("div",{style:{marginBottom:"16px"},children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[l.jsx("label",{style:{color:"#f2f2f2",fontSize:"13px",fontWeight:500},children:"Brightness"}),l.jsxs("span",{style:{color:"#888",fontSize:"12px",minWidth:"45px",textAlign:"right"},children:[T,"%"]})]}),l.jsx("input",{type:"range",min:"0",max:"200",step:"1",value:T,onChange:K=>ae(parseInt(K.target.value,10)),disabled:Z,style:{width:"100%",cursor:Z?"not-allowed":"pointer",accentColor:"#6b9fff"}})]}),l.jsxs("div",{style:{marginBottom:"16px"},children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[l.jsx("label",{style:{color:"#f2f2f2",fontSize:"13px",fontWeight:500},children:"Contrast"}),l.jsxs("span",{style:{color:"#888",fontSize:"12px",minWidth:"45px",textAlign:"right"},children:[R,"%"]})]}),l.jsx("input",{type:"range",min:"0",max:"200",step:"1",value:R,onChange:K=>Ce(parseInt(K.target.value,10)),disabled:Z,style:{width:"100%",cursor:Z?"not-allowed":"pointer",accentColor:"#6b9fff"}})]}),l.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),l.jsx("div",{style:{marginBottom:"12px"},children:l.jsxs("button",{onClick:xe,disabled:Z,style:D(Z,b),onMouseEnter:K=>!Z&&!b&&(K.currentTarget.style.background="#3a3a42"),onMouseLeave:K=>!b&&(K.currentTarget.style.background="transparent"),children:[b?" ":"","Grayscale Mode"]})}),l.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),l.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[l.jsx("button",{onClick:J,disabled:Z,style:{padding:"8px 16px",background:Z?"#444":"#555",color:Z?"#777":"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:Z?"not-allowed":"pointer",fontSize:"13px",fontWeight:500},children:"Reset Transform"}),l.jsx("button",{onClick:e,style:{padding:"8px 16px",background:"#4a9eff",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:500},onMouseEnter:K=>K.currentTarget.style.background="#3a8ee6",onMouseLeave:K=>K.currentTarget.style.background="#4a9eff",children:"Close"})]}),v&&l.jsx("div",{style:{marginTop:"12px",padding:"8px 12px",background:"#3d2b2b",border:"1px solid #5a3a3a",borderRadius:4,fontSize:"12px",color:"#e88"},children:" Images are locked. Unlock via Images  Lock Images to make changes."})]})]})},w3=({visible:r,onClose:e,topImage:t,bottomImage:n,setTopImage:s,setBottomImage:o,componentsTop:d,componentsBottom:c,setComponentsTop:h,setComponentsBottom:f,drawingStrokes:m,setDrawingStrokes:b,powerSymbols:S,groundSymbols:v,setPowerSymbols:P,setGroundSymbols:x,canvasRef:k,isBottomView:N,setIsBottomView:$,originalTopFlipX:I,setOriginalTopFlipX:z,originalBottomFlipX:B,setOriginalBottomFlipX:G,originalTopFlipY:te,setOriginalTopFlipY:F,originalBottomFlipY:H,setOriginalBottomFlipY:Q,cameraWorldCenter:M,setCameraWorldCenter:T,viewScale:R,viewRotation:Z,setViewRotation:se,viewFlipX:V,setViewFlipX:ee,contentBorder:ae,setTransparency:Ce})=>{const[xe,J]=X.useState(null),[D,W]=X.useState(!1),K=X.useRef({x:0,y:0}),ue=X.useRef(null),Te=X.useCallback((at,ht,xt,fe)=>{const Nt=window.innerWidth,zt=window.innerHeight,Bt=10,it=Math.max(Bt,Math.min(at,Nt-xt-Bt)),qt=Math.max(Bt,Math.min(ht,zt-fe-Bt));return{x:it,y:qt}},[]);X.useEffect(()=>{if(r&&xe===null){const at=localStorage.getItem("transformAllDialogPosition"),ht=320,xt=400,fe=20,Nt=150;let zt;if(at)try{const Bt=JSON.parse(at);zt=Te(Bt.x,Bt.y,ht,xt)}catch{zt=Te(window.innerWidth-ht-fe,Nt,ht,xt)}else zt=Te(window.innerWidth-ht-fe,Nt,ht,xt);J(zt)}},[r,xe,Te]);const Pe=X.useCallback(at=>{if(ue.current){const ht=ue.current.getBoundingClientRect();K.current={x:at.clientX-ht.left,y:at.clientY-ht.top},W(!0)}},[]);X.useEffect(()=>{if(!D)return;const at=xt=>{const fe=xt.clientX-K.current.x,Nt=xt.clientY-K.current.y,zt=ue.current?.offsetWidth||320,Bt=ue.current?.offsetHeight||400,it=Te(fe,Nt,zt,Bt);J(it),localStorage.setItem("transformAllDialogPosition",JSON.stringify(it))},ht=()=>{W(!1)};return document.addEventListener("mousemove",at),document.addEventListener("mouseup",ht),()=>{document.removeEventListener("mousemove",at),document.removeEventListener("mouseup",ht)}},[D,Te]);const Ve=X.useCallback(()=>{N||(ee(!0),$(!0),Ce(100))},[N,ee,$,Ce]),De=X.useCallback(()=>{N&&(ee(!1),$(!1),Ce(0))},[N,ee,$,Ce]),et=X.useCallback(at=>{se(ht=>Om(ht,at))},[se,Om]);if(!r)return null;const ot=(at=!1)=>({display:"block",width:"100%",textAlign:"left",padding:"8px 12px",color:at?"#999":"#222",background:"transparent",border:"none",borderRadius:4,cursor:at?"not-allowed":"pointer",fontSize:"13px",transition:"background 0.15s"});return l.jsxs("div",{ref:ue,style:{position:"fixed",top:xe?.y??150,left:xe?.x??window.innerWidth-340,backgroundColor:"#fff",borderRadius:8,minWidth:"320px",maxWidth:"400px",maxHeight:"calc(100vh - 100px)",overflowY:"auto",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:10001,display:"flex",flexDirection:"column"},children:[l.jsxs("div",{onMouseDown:Pe,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:D?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[l.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Change Perspective"}),l.jsx("button",{onClick:e,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),l.jsxs("div",{style:{padding:"20px",overflow:"auto",flex:1},children:[l.jsxs("div",{style:{marginBottom:"16px"},children:[l.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"8px",fontWeight:500},children:"View:"}),l.jsx("button",{onClick:N?De:Ve,style:ot(!1),onMouseEnter:at=>at.currentTarget.style.background="#f0f0f0",onMouseLeave:at=>at.currentTarget.style.background="transparent",children:N?"Switch to Top View":"Switch to Bottom View"}),l.jsx("div",{style:{fontSize:"10px",color:"#999",marginTop:"6px",fontStyle:"italic"},children:"Shortcut: Shift-Left/Right Arrow Keys"})]}),l.jsx("div",{style:{height:1,background:"#e0e0e0",margin:"16px 0"}}),l.jsxs("div",{style:{marginBottom:"16px"},children:[l.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"8px",fontWeight:500},children:"Rotate (clockwise):"}),l.jsx("button",{onClick:()=>et(90),style:ot(),onMouseEnter:at=>at.currentTarget.style.background="#f0f0f0",onMouseLeave:at=>at.currentTarget.style.background="transparent",children:"Rotate 90"}),l.jsx("button",{onClick:()=>et(180),style:ot(),onMouseEnter:at=>at.currentTarget.style.background="#f0f0f0",onMouseLeave:at=>at.currentTarget.style.background="transparent",children:"Rotate 180"}),l.jsx("button",{onClick:()=>et(270),style:ot(),onMouseEnter:at=>at.currentTarget.style.background="#f0f0f0",onMouseLeave:at=>at.currentTarget.style.background="transparent",children:"Rotate 270"}),l.jsx("div",{style:{fontSize:"10px",color:"#999",marginTop:"6px",fontStyle:"italic"},children:"Shortcut: Shift-Up/Down Arrow Keys"})]}),l.jsx("div",{style:{height:1,background:"#e0e0e0",margin:"16px 0"}}),l.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:l.jsx("button",{onClick:e,style:{padding:"8px 16px",background:"#4a9eff",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:500},onMouseEnter:at=>at.currentTarget.style.background="#3a8ee6",onMouseLeave:at=>at.currentTarget.style.background="#4a9eff",children:"Close"})})]})]})},S3=({component:r,componentEditor:e,componentDefinition:t,setComponentEditor:n,areComponentsLocked:s,componentsTop:o,componentsBottom:d,setComponentsTop:c,setComponentsBottom:h,uploadedDatasheetFile:f,setUploadedDatasheetFile:m})=>{if(!r||!r.id||!r.componentType||typeof r.pinCount!="number")return console.error("[ComponentTypeFields] Component missing required properties:",{comp:r,hasId:!!r?.id,hasComponentType:!!r?.componentType,componentType:r?.componentType,pinCount:r?.pinCount,pinCountType:typeof r?.pinCount}),null;const S=(t||e?.componentDefinition||_d(r))?.fields,v=r.componentType,P=v==="IntegratedCircuit"||v==="Semiconductor";if(S&&S.length>0&&!P){const x=(N,$,I)=>I?N==="capacitance"||N==="resistance"||N==="voltage"||N==="current"?"80px":N==="power"||N==="inductance"||N==="impedance"||N==="esr"||N==="ripple"||N==="leakageCurrent"?"70px":"80px":N==="tolerance"||N==="pinCount"?"60px":N==="partNumber"||N==="manufacturer"?"150px":N==="description"||N==="operatingTemperature"?"180px":$==="string"&&!N.includes("Unit")?"150px":"120px",k=N=>{const $=r.componentType;if(($==="IntegratedCircuit"||$==="Semiconductor")&&N.name==="datasheet")return null;const z=N.name,B=`${N.name}Unit`,G=e[z]??r[z]??N.defaultValue??"",te=e[B]??r[B]??(N.units&&N.defaultUnit?N.defaultUnit:""),F=T=>{n({...e,[z]:T})},H=T=>{n({...e,[B]:T})},Q=!!(N.units&&N.units.length>0),M=x(N.name,N.type,Q);return l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[l.jsxs("label",{style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:[N.label,":"]}),N.type==="enum"?l.jsx("select",{value:G,onChange:T=>F(T.target.value),disabled:s,style:{width:M,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:(N.enumValues||[]).map(T=>l.jsx("option",{value:T,children:T},T))}):l.jsx("input",{type:"text",value:G,onChange:T=>F(T.target.value),disabled:s,style:{width:M,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:Q?"8px":"0"},placeholder:N.defaultValue!==void 0?String(N.defaultValue):""}),Q&&N.units&&l.jsx("select",{value:te||N.defaultUnit||N.units[0],onChange:T=>H(T.target.value),disabled:s,style:{width:"70px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,flexShrink:0},children:N.units.map(T=>l.jsx("option",{value:T,children:T},T))})]},N.name)};return l.jsx(l.Fragment,{children:S.map(k).filter(Boolean)})}return P?l.jsxs(l.Fragment,{children:[r.componentType==="Resistor"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-resistance-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),l.jsx("input",{id:`component-resistance-${r.id}`,type:"text",value:e.resistance||"",onChange:x=>n({...e,resistance:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 10"}),l.jsx("select",{value:e.resistanceUnit||Yt("resistance"),onChange:x=>n({...e,resistanceUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("resistance").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-power-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),l.jsxs("select",{id:`component-power-${r.id}`,value:e.power||"1/4",onChange:x=>n({...e,power:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"12px"},children:[l.jsx("option",{value:"1/20",children:"1/20 W"}),l.jsx("option",{value:"1/16",children:"1/16 W"}),l.jsx("option",{value:"1/10",children:"1/10 W"}),l.jsx("option",{value:"1/8",children:"1/8 W"}),l.jsx("option",{value:"1/4",children:"1/4 W"}),l.jsx("option",{value:"1/2",children:"1/2 W"}),l.jsx("option",{value:"1",children:"1 W"}),l.jsx("option",{value:"2",children:"2 W"}),l.jsx("option",{value:"3",children:"3 W"}),l.jsx("option",{value:"5",children:"5 W"}),l.jsx("option",{value:"10",children:"10 W"}),l.jsx("option",{value:"25",children:"25 W"}),l.jsx("option",{value:"50",children:"50 W"}),l.jsx("option",{value:"100",children:"100 W"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-tolerance-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),l.jsxs("select",{id:`component-tolerance-${r.id}`,value:e.tolerance||"5%",onChange:x=>n({...e,tolerance:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"0.05%",children:"0.05%"}),l.jsx("option",{value:"0.1%",children:"0.1%"}),l.jsx("option",{value:"0.25%",children:"0.25%"}),l.jsx("option",{value:"0.5%",children:"0.5%"}),l.jsx("option",{value:"1%",children:"1%"}),l.jsx("option",{value:"2%",children:"2%"}),l.jsx("option",{value:"5%",children:"5%"}),l.jsx("option",{value:"10%",children:"10%"}),l.jsx("option",{value:"20%",children:"20%"})]})]})]}),r.componentType==="Capacitor"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-capacitance-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),l.jsx("input",{id:`component-capacitance-${r.id}`,type:"text",value:e.capacitance||"",onChange:x=>n({...e,capacitance:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 100"}),l.jsx("select",{value:e.capacitanceUnit||Yt("capacitance"),onChange:x=>n({...e,capacitanceUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("capacitance").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-voltage-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),l.jsx("input",{id:`component-voltage-${r.id}`,type:"text",value:e.voltage||"",onChange:x=>n({...e,voltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 50"}),l.jsx("select",{value:e.voltageUnit||Yt("voltage"),onChange:x=>n({...e,voltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-dielectric-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Dielectric:"}),l.jsxs("select",{id:`component-dielectric-${r.id}`,value:e.dielectric||"Ceramic",onChange:x=>n({...e,dielectric:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"Ceramic",children:"Ceramic"}),l.jsx("option",{value:"Tantalum",children:"Tantalum"}),l.jsx("option",{value:"Film",children:"Film"}),l.jsx("option",{value:"Polyester",children:"Polyester"}),l.jsx("option",{value:"Polypropylene",children:"Polypropylene"}),l.jsx("option",{value:"Mica",children:"Mica"}),l.jsx("option",{value:"Paper",children:"Paper"}),l.jsx("option",{value:"Glass",children:"Glass"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-tolerance-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),l.jsxs("select",{id:`component-tolerance-${r.id}`,value:e.tolerance||"10%",onChange:x=>n({...e,tolerance:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"0.5%",children:"0.5%"}),l.jsx("option",{value:"1%",children:"1%"}),l.jsx("option",{value:"2%",children:"2%"}),l.jsx("option",{value:"5%",children:"5%"}),l.jsx("option",{value:"10%",children:"10%"}),l.jsx("option",{value:"20%",children:"20%"})]})]})]}),r.componentType==="Film Capacitor"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-capacitance-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),l.jsx("input",{id:`component-capacitance-${r.id}`,type:"text",value:e.capacitance||"",onChange:x=>n({...e,capacitance:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 100"}),l.jsx("select",{value:e.capacitanceUnit||Yt("capacitance"),onChange:x=>n({...e,capacitanceUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("capacitance").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-voltage-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),l.jsx("input",{id:`component-voltage-${r.id}`,type:"text",value:e.voltage||"",onChange:x=>n({...e,voltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 50"}),l.jsx("select",{value:e.voltageUnit||Yt("voltage"),onChange:x=>n({...e,voltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-filmtype-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Film Type:"}),l.jsxs("select",{id:`component-filmtype-${r.id}`,value:e.filmType||"Polyester",onChange:x=>n({...e,filmType:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"Polyester",children:"Polyester"}),l.jsx("option",{value:"Polypropylene",children:"Polypropylene"}),l.jsx("option",{value:"Polyethylene",children:"Polyethylene"}),l.jsx("option",{value:"Polystyrene",children:"Polystyrene"}),l.jsx("option",{value:"Polycarbonate",children:"Polycarbonate"}),l.jsx("option",{value:"PTFE",children:"PTFE (Teflon)"}),l.jsx("option",{value:"PPS",children:"PPS (Polyphenylene Sulfide)"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-tolerance-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),l.jsxs("select",{id:`component-tolerance-${r.id}`,value:e.tolerance||"10%",onChange:x=>n({...e,tolerance:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"0.5%",children:"0.5%"}),l.jsx("option",{value:"1%",children:"1%"}),l.jsx("option",{value:"2%",children:"2%"}),l.jsx("option",{value:"5%",children:"5%"}),l.jsx("option",{value:"10%",children:"10%"}),l.jsx("option",{value:"20%",children:"20%"})]})]})]}),r.componentType==="Electrolytic Capacitor"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-capacitance-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),l.jsx("input",{id:`component-capacitance-${r.id}`,type:"text",value:e.capacitance||"",onChange:x=>n({...e,capacitance:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 100"}),l.jsxs("select",{value:e.capacitanceUnit||"F",onChange:x=>n({...e,capacitanceUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:[l.jsx("option",{value:"pF",children:"pF"}),l.jsx("option",{value:"nF",children:"nF"}),l.jsx("option",{value:"F",children:"F"}),l.jsx("option",{value:"mF",children:"mF"}),l.jsx("option",{value:"F",children:"F"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-voltage-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),l.jsx("input",{id:`component-voltage-${r.id}`,type:"text",value:e.voltage||"",onChange:x=>n({...e,voltage:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 25"}),l.jsx("select",{value:e.voltageUnit||Yt("voltage"),onChange:x=>n({...e,voltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-tolerance-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),l.jsxs("select",{id:`component-tolerance-${r.id}`,value:e.tolerance||"20%",onChange:x=>n({...e,tolerance:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},children:[l.jsx("option",{value:"0.5%",children:"0.5%"}),l.jsx("option",{value:"1%",children:"1%"}),l.jsx("option",{value:"2%",children:"2%"}),l.jsx("option",{value:"5%",children:"5%"}),l.jsx("option",{value:"10%",children:"10%"}),l.jsx("option",{value:"20%",children:"20%"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-polarized-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Polarized:"}),l.jsx("input",{id:`component-polarized-${r.id}`,type:"checkbox",checked:Sp(r),disabled:!0,style:{opacity:.6,cursor:"not-allowed"},title:"Polarized is a fixed property determined by component type"})]})]}),r.componentType==="Inductor"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-inductance-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Inductance:"}),l.jsx("input",{id:`component-inductance-${r.id}`,type:"text",value:e.inductance||"",onChange:x=>n({...e,inductance:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 10"}),l.jsx("select",{value:e.inductanceUnit||Yt("inductance"),onChange:x=>n({...e,inductanceUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("inductance").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-current-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),l.jsx("input",{id:`component-current-${r.id}`,type:"text",value:e.current||"",onChange:x=>n({...e,current:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 1"}),l.jsx("select",{value:e.currentUnit||Yt("current"),onChange:x=>n({...e,currentUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("current").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-resistance-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"DC Resistance:"}),l.jsx("input",{id:`component-resistance-${r.id}`,type:"text",value:e.resistance||"",onChange:x=>n({...e,resistance:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 50"}),l.jsx("select",{value:e.resistanceUnit||"",onChange:x=>n({...e,resistanceUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("resistance").map(x=>l.jsx("option",{value:x,children:x},x))})]})]}),r.componentType==="Diode"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-diodetype-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Diode Type:"}),l.jsxs("select",{id:`component-diodetype-${r.id}`,value:e.diodeType||"Standard",onChange:x=>n({...e,diodeType:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"Standard",children:"Standard"}),l.jsx("option",{value:"Zener",children:"Zener"}),l.jsx("option",{value:"LED",children:"LED"}),l.jsx("option",{value:"Schottky",children:"Schottky"}),l.jsx("option",{value:"Infrared",children:"Infrared"}),l.jsx("option",{value:"Photodiode",children:"Photodiode"}),l.jsx("option",{value:"Other",children:"Other"})]})]}),e.diodeType==="LED"&&l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-ledcolor-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"LED Color:"}),l.jsxs("select",{id:`component-ledcolor-${r.id}`,value:e.ledColor||"",onChange:x=>n({...e,ledColor:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"",children:"Select..."}),l.jsx("option",{value:"Red",children:"Red"}),l.jsx("option",{value:"Green",children:"Green"}),l.jsx("option",{value:"Blue",children:"Blue"}),l.jsx("option",{value:"Yellow",children:"Yellow"}),l.jsx("option",{value:"Orange",children:"Orange"}),l.jsx("option",{value:"White",children:"White"}),l.jsx("option",{value:"RGB",children:"RGB"}),l.jsx("option",{value:"IR",children:"IR (Infrared)"}),l.jsx("option",{value:"UV",children:"UV (Ultraviolet)"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-voltage-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),l.jsx("input",{id:`component-voltage-${r.id}`,type:"text",value:e.voltage||"",onChange:x=>n({...e,voltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 50"}),l.jsx("select",{value:e.voltageUnit||Yt("voltage"),onChange:x=>n({...e,voltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-current-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),l.jsx("input",{id:`component-current-${r.id}`,type:"text",value:e.current||"",onChange:x=>n({...e,current:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 1"}),l.jsx("select",{value:e.currentUnit||Yt("current"),onChange:x=>n({...e,currentUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("current").map(x=>l.jsx("option",{value:x,children:x},x))})]})]}),r.componentType==="Battery"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-voltage-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),l.jsx("input",{id:`component-voltage-${r.id}`,type:"text",value:e.voltage||"",onChange:x=>n({...e,voltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 3.7"}),l.jsx("select",{value:e.voltageUnit||"V",onChange:x=>n({...e,voltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-capacity-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacity:"}),l.jsx("input",{id:`component-capacity-${r.id}`,type:"text",value:e.capacity||"",onChange:x=>n({...e,capacity:x.target.value}),disabled:s,style:{width:"120px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 2000mAh"})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-chemistry-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Chemistry:"}),l.jsxs("select",{id:`component-chemistry-${r.id}`,value:e.chemistry||"Li-ion",onChange:x=>n({...e,chemistry:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"Li-ion",children:"Li-ion"}),l.jsx("option",{value:"LiPo",children:"LiPo"}),l.jsx("option",{value:"NiMH",children:"NiMH"}),l.jsx("option",{value:"NiCd",children:"NiCd"}),l.jsx("option",{value:"Alkaline",children:"Alkaline"}),l.jsx("option",{value:"Lead-Acid",children:"Lead-Acid"}),l.jsx("option",{value:"Lithium",children:"Lithium"}),l.jsx("option",{value:"Zinc-Carbon",children:"Zinc-Carbon"})]})]})]}),r.componentType==="Fuse"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-current-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),l.jsx("input",{id:`component-current-${r.id}`,type:"text",value:e.current||"",onChange:x=>n({...e,current:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 5"}),l.jsx("select",{value:e.currentUnit||"A",onChange:x=>n({...e,currentUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("current").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-voltage-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),l.jsx("input",{id:`component-voltage-${r.id}`,type:"text",value:e.voltage||"",onChange:x=>n({...e,voltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 250"}),l.jsx("select",{value:e.voltageUnit||"V",onChange:x=>n({...e,voltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-fusetype-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Fuse Type:"}),l.jsxs("select",{id:`component-fusetype-${r.id}`,value:e.fuseType||"Fast-blow",onChange:x=>n({...e,fuseType:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"Fast-blow",children:"Fast-blow"}),l.jsx("option",{value:"Slow-blow",children:"Slow-blow"}),l.jsx("option",{value:"Time-delay",children:"Time-delay"}),l.jsx("option",{value:"Resettable",children:"Resettable"}),l.jsx("option",{value:"Cartridge",children:"Cartridge"}),l.jsx("option",{value:"Glass",children:"Glass"}),l.jsx("option",{value:"Ceramic",children:"Ceramic"})]})]})]}),r.componentType==="Relay"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-coilvoltage-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Coil Voltage:"}),l.jsx("input",{id:`component-coilvoltage-${r.id}`,type:"text",value:e.coilVoltage||"",onChange:x=>n({...e,coilVoltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 12"}),l.jsx("select",{value:e.coilVoltageUnit||Yt("voltage"),onChange:x=>n({...e,coilVoltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-contacttype-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Contact Type:"}),l.jsxs("select",{id:`component-contacttype-${r.id}`,value:e.contactType||"SPST",onChange:x=>n({...e,contactType:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"SPST",children:"SPST (Single Pole Single Throw)"}),l.jsx("option",{value:"SPDT",children:"SPDT (Single Pole Double Throw)"}),l.jsx("option",{value:"DPST",children:"DPST (Double Pole Single Throw)"}),l.jsx("option",{value:"DPDT",children:"DPDT (Double Pole Double Throw)"}),l.jsx("option",{value:"3PDT",children:"3PDT (3 Pole Double Throw)"}),l.jsx("option",{value:"4PDT",children:"4PDT (4 Pole Double Throw)"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-current-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),l.jsx("input",{id:`component-current-${r.id}`,type:"text",value:e.current||"",onChange:x=>n({...e,current:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 10"}),l.jsx("select",{value:e.currentUnit||Yt("current"),onChange:x=>n({...e,currentUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("current").map(x=>l.jsx("option",{value:x,children:x},x))})]})]}),r.componentType==="Motor"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-motortype-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Motor Type:"}),l.jsxs("select",{id:`component-motortype-${r.id}`,value:e.motorType||"DC",onChange:x=>n({...e,motorType:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"DC",children:"DC Motor"}),l.jsx("option",{value:"Stepper",children:"Stepper Motor"}),l.jsx("option",{value:"Servo",children:"Servo Motor"}),l.jsx("option",{value:"Brushless",children:"Brushless DC"}),l.jsx("option",{value:"AC",children:"AC Motor"}),l.jsx("option",{value:"Synchronous",children:"Synchronous"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-voltage-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),l.jsx("input",{id:`component-voltage-${r.id}`,type:"text",value:e.voltage||"",onChange:x=>n({...e,voltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 12"}),l.jsx("select",{value:e.voltageUnit||Yt("voltage"),onChange:x=>n({...e,voltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-current-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),l.jsx("input",{id:`component-current-${r.id}`,type:"text",value:e.current||"",onChange:x=>n({...e,current:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 1"}),l.jsx("select",{value:e.currentUnit||Yt("current"),onChange:x=>n({...e,currentUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("current").map(x=>l.jsx("option",{value:x,children:x},x))})]})]}),r.componentType==="Switch"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-switchtype-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Switch Type:"}),l.jsxs("select",{id:`component-switchtype-${r.id}`,value:e.switchType||"Toggle",onChange:x=>n({...e,switchType:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"Toggle",children:"Toggle"}),l.jsx("option",{value:"Push-button",children:"Push-button"}),l.jsx("option",{value:"Slide",children:"Slide"}),l.jsx("option",{value:"Rotary",children:"Rotary"}),l.jsx("option",{value:"DIP",children:"DIP Switch"}),l.jsx("option",{value:"Momentary",children:"Momentary"}),l.jsx("option",{value:"Latching",children:"Latching"}),l.jsx("option",{value:"Reed",children:"Reed Switch"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-current-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),l.jsx("input",{id:`component-current-${r.id}`,type:"text",value:e.current||"",onChange:x=>n({...e,current:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 5"}),l.jsx("select",{value:e.currentUnit||Yt("current"),onChange:x=>n({...e,currentUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("current").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-voltage-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),l.jsx("input",{id:`component-voltage-${r.id}`,type:"text",value:e.voltage||"",onChange:x=>n({...e,voltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 250"}),l.jsx("select",{value:e.voltageUnit||Yt("voltage"),onChange:x=>n({...e,voltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]})]}),r.componentType==="FerriteBead"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-impedance-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Impedance:"}),l.jsx("input",{id:`component-impedance-${r.id}`,type:"text",value:e.impedance||"",onChange:x=>n({...e,impedance:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 100"}),l.jsx("select",{value:e.impedanceUnit||Yt("impedance"),onChange:x=>n({...e,impedanceUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("impedance").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-current-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),l.jsx("input",{id:`component-current-${r.id}`,type:"text",value:e.current||"",onChange:x=>n({...e,current:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 1"}),l.jsx("select",{value:e.currentUnit||Yt("current"),onChange:x=>n({...e,currentUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("current").map(x=>l.jsx("option",{value:x,children:x},x))})]})]}),r.componentType==="Connector"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-connectortype-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Connector Type:"}),l.jsx("input",{id:`component-connectortype-${r.id}`,type:"text",value:e.connectorType||"",onChange:x=>n({...e,connectorType:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},placeholder:"e.g., USB-A, HDMI"})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-gender-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Gender:"}),l.jsxs("select",{id:`component-gender-${r.id}`,value:e.gender||"N/A",onChange:x=>n({...e,gender:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"Male",children:"Male"}),l.jsx("option",{value:"Female",children:"Female"}),l.jsx("option",{value:"N/A",children:"N/A"})]})]})]}),r.componentType==="Jumper"&&l.jsx(l.Fragment,{children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-positions-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Positions:"}),l.jsx("input",{id:`component-positions-${r.id}`,type:"number",min:"2",value:e.positions||3,onChange:x=>n({...e,positions:parseInt(x.target.value)||3}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"}})]})}),r.componentType==="Speaker"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-impedance-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Impedance:"}),l.jsx("input",{id:`component-impedance-${r.id}`,type:"text",value:e.impedance||"",onChange:x=>n({...e,impedance:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 8"}),l.jsx("select",{value:e.impedanceUnit||Yt("impedance"),onChange:x=>n({...e,impedanceUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("impedance").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-power-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),l.jsxs("select",{id:`component-power-${r.id}`,value:e.power||"1/4",onChange:x=>n({...e,power:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"12px"},children:[l.jsx("option",{value:"1/20",children:"1/20 W"}),l.jsx("option",{value:"1/16",children:"1/16 W"}),l.jsx("option",{value:"1/10",children:"1/10 W"}),l.jsx("option",{value:"1/8",children:"1/8 W"}),l.jsx("option",{value:"1/4",children:"1/4 W"}),l.jsx("option",{value:"1/2",children:"1/2 W"}),l.jsx("option",{value:"1",children:"1 W"}),l.jsx("option",{value:"2",children:"2 W"}),l.jsx("option",{value:"3",children:"3 W"}),l.jsx("option",{value:"5",children:"5 W"}),l.jsx("option",{value:"10",children:"10 W"}),l.jsx("option",{value:"25",children:"25 W"}),l.jsx("option",{value:"50",children:"50 W"}),l.jsx("option",{value:"100",children:"100 W"})]})]})]}),r.componentType==="PowerSupply"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-inputvoltage-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Input Voltage:"}),l.jsx("input",{id:`component-inputvoltage-${r.id}`,type:"text",value:e.inputVoltage||"",onChange:x=>n({...e,inputVoltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 120"}),l.jsx("select",{value:e.inputVoltageUnit||Yt("voltage"),onChange:x=>n({...e,inputVoltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-outputvoltage-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Output Voltage:"}),l.jsx("input",{id:`component-outputvoltage-${r.id}`,type:"text",value:e.outputVoltage||"",onChange:x=>n({...e,outputVoltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 12"}),l.jsx("select",{value:e.outputVoltageUnit||Yt("voltage"),onChange:x=>n({...e,outputVoltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-current-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),l.jsx("input",{id:`component-current-${r.id}`,type:"text",value:e.current||"",onChange:x=>n({...e,current:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 1"}),l.jsx("select",{value:e.currentUnit||Yt("current"),onChange:x=>n({...e,currentUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("current").map(x=>l.jsx("option",{value:x,children:x},x))})]})]}),r.componentType==="Transistor"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-transistortype-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Transistor Type:"}),l.jsxs("select",{id:`component-transistortype-${r.id}`,value:e.transistorType||"BJT",onChange:x=>n({...e,transistorType:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"BJT",children:"BJT (Bipolar Junction Transistor)"}),l.jsx("option",{value:"FET",children:"FET (Field Effect Transistor)"}),l.jsx("option",{value:"MOSFET",children:"MOSFET"}),l.jsx("option",{value:"IGBT",children:"IGBT"}),l.jsx("option",{value:"JFET",children:"JFET"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-polarity-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Polarity:"}),l.jsxs("select",{id:`component-polarity-${r.id}`,value:e.polarity||"NPN",onChange:x=>n({...e,polarity:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"NPN",children:"NPN"}),l.jsx("option",{value:"PNP",children:"PNP"}),l.jsx("option",{value:"N-Channel",children:"N-Channel"}),l.jsx("option",{value:"P-Channel",children:"P-Channel"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-voltage-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),l.jsx("input",{id:`component-voltage-${r.id}`,type:"text",value:e.voltage||"",onChange:x=>n({...e,voltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 50"}),l.jsx("select",{value:e.voltageUnit||Yt("voltage"),onChange:x=>n({...e,voltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-current-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),l.jsx("input",{id:`component-current-${r.id}`,type:"text",value:e.current||"",onChange:x=>n({...e,current:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 1"}),l.jsx("select",{value:e.currentUnit||Yt("current"),onChange:x=>n({...e,currentUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("current").map(x=>l.jsx("option",{value:x,children:x},x))})]})]}),r.componentType==="ResistorNetwork"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-resistance-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),l.jsx("input",{id:`component-resistance-${r.id}`,type:"text",value:e.resistance||"",onChange:x=>n({...e,resistance:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 10"}),l.jsx("select",{value:e.resistanceUnit||Yt("resistance"),onChange:x=>n({...e,resistanceUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("resistance").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-configuration-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Configuration:"}),l.jsx("input",{id:`component-configuration-${r.id}`,type:"text",value:e.configuration||"",onChange:x=>n({...e,configuration:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},placeholder:"e.g., Isolated, Bussed"})]})]}),r.componentType==="Thermistor"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-resistance-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),l.jsx("input",{id:`component-resistance-${r.id}`,type:"text",value:e.resistance||"",onChange:x=>n({...e,resistance:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 10"}),l.jsx("select",{value:e.resistanceUnit||Yt("resistance"),onChange:x=>n({...e,resistanceUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("resistance").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-thermistortype-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Thermistor Type:"}),l.jsxs("select",{id:`component-thermistortype-${r.id}`,value:e.thermistorType||"NTC",onChange:x=>n({...e,thermistorType:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"NTC",children:"NTC (Negative Temperature Coefficient)"}),l.jsx("option",{value:"PTC",children:"PTC (Positive Temperature Coefficient)"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-beta-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Beta ():"}),l.jsx("input",{id:`component-beta-${r.id}`,type:"text",value:e.beta||"",onChange:x=>n({...e,beta:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},placeholder:"e.g., 3950"})]})]}),r.componentType==="Transformer"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-primaryvoltage-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Primary Voltage:"}),l.jsx("input",{id:`component-primaryvoltage-${r.id}`,type:"text",value:e.primaryVoltage||"",onChange:x=>n({...e,primaryVoltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 120"}),l.jsx("select",{value:e.primaryVoltageUnit||Yt("voltage"),onChange:x=>n({...e,primaryVoltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-secondaryvoltage-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Secondary Voltage:"}),l.jsx("input",{id:`component-secondaryvoltage-${r.id}`,type:"text",value:e.secondaryVoltage||"",onChange:x=>n({...e,secondaryVoltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 12"}),l.jsx("select",{value:e.secondaryVoltageUnit||Yt("voltage"),onChange:x=>n({...e,secondaryVoltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-power-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),l.jsxs("select",{id:`component-power-${r.id}`,value:e.power||"1/4",onChange:x=>n({...e,power:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"12px"},children:[l.jsx("option",{value:"1/20",children:"1/20 W"}),l.jsx("option",{value:"1/16",children:"1/16 W"}),l.jsx("option",{value:"1/10",children:"1/10 W"}),l.jsx("option",{value:"1/8",children:"1/8 W"}),l.jsx("option",{value:"1/4",children:"1/4 W"}),l.jsx("option",{value:"1/2",children:"1/2 W"}),l.jsx("option",{value:"1",children:"1 W"}),l.jsx("option",{value:"2",children:"2 W"}),l.jsx("option",{value:"3",children:"3 W"}),l.jsx("option",{value:"5",children:"5 W"}),l.jsx("option",{value:"10",children:"10 W"}),l.jsx("option",{value:"25",children:"25 W"}),l.jsx("option",{value:"50",children:"50 W"}),l.jsx("option",{value:"100",children:"100 W"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-turns-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Turns Ratio:"}),l.jsx("input",{id:`component-turns-${r.id}`,type:"text",value:e.turns||"",onChange:x=>n({...e,turns:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},placeholder:"e.g., 10:1"})]})]}),r.componentType==="TestPoint"&&l.jsx(l.Fragment,{children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-signal-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Signal:"}),l.jsx("input",{id:`component-signal-${r.id}`,type:"text",value:e.signal||"",onChange:x=>n({...e,signal:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},placeholder:"e.g., VCC, GND, CLK"})]})}),(r.componentType==="IntegratedCircuit"||r.componentType==="Semiconductor")&&l.jsxs(l.Fragment,{children:[l.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid #e0e0e0",fontSize:"11px",fontWeight:600,color:"#000"},children:"IC Properties:"}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-ictype-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"IC Type:"}),l.jsxs("select",{id:`component-ictype-${r.id}`,value:e.icType||"Op-Amp",onChange:x=>n({...e,icType:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"Op-Amp",children:"Op-Amp"}),l.jsx("option",{value:"Microcontroller",children:"Microcontroller"}),l.jsx("option",{value:"Microprocessor",children:"Microprocessor"}),l.jsx("option",{value:"Logic",children:"Logic"}),l.jsx("option",{value:"Memory",children:"Memory"}),l.jsx("option",{value:"Voltage Regulator",children:"Voltage Regulator"}),l.jsx("option",{value:"Timer",children:"Timer"}),l.jsx("option",{value:"ADC",children:"ADC (Analog-to-Digital)"}),l.jsx("option",{value:"DAC",children:"DAC (Digital-to-Analog)"}),l.jsx("option",{value:"Comparator",children:"Comparator"}),l.jsx("option",{value:"Transceiver",children:"Transceiver"}),l.jsx("option",{value:"Driver",children:"Driver"}),l.jsx("option",{value:"Amplifier",children:"Amplifier"}),l.jsx("option",{value:"Other",children:"Other"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-datasheet-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Datasheet:"}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px",flex:1},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",flexWrap:"wrap",flex:1},children:[l.jsx("input",{id:`component-datasheet-file-${r.id}`,type:"file",accept:".pdf",onChange:x=>{const k=x.target.files?.[0]||null;m(k)},disabled:s,style:{position:"absolute",width:"0.1px",height:"0.1px",opacity:0,overflow:"hidden",zIndex:-1}}),l.jsx("label",{htmlFor:`component-datasheet-file-${r.id}`,style:{display:"inline-block",padding:"2px 6px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",cursor:s?"not-allowed":"pointer",opacity:s?.6:1,whiteSpace:"nowrap",flex:"0 0 auto"},children:"Choose File"}),f?l.jsx("a",{href:"#",onClick:async x=>{if(x.preventDefault(),x.stopPropagation(),f){const k=URL.createObjectURL(f);window.open(k,"_blank","noopener,noreferrer")&&setTimeout(()=>URL.revokeObjectURL(k),1e3)}},style:{fontSize:"11px",color:"#0066cc",whiteSpace:"nowrap",textDecoration:"underline",cursor:"pointer",flex:"0 0 auto"},title:"Click to open PDF in new window",children:f.name||"PDF file"}):r?.datasheetFileName?l.jsx("span",{style:{fontSize:"11px",color:"#666",flex:"0 0 auto"},title:"File name saved in project (file not available)",children:r.datasheetFileName}):l.jsx("span",{style:{fontSize:"11px",color:"#666",flex:"0 0 auto"},children:"No file chosen"})]}),l.jsx("div",{style:{display:"flex",alignItems:"center",gap:"4px",flexWrap:"wrap"},children:e.datasheet&&e.datasheet.trim()?l.jsx("a",{href:e.datasheet.trim().match(/^https?:\/\//)?e.datasheet.trim():`https://${e.datasheet.trim()}`,target:"_blank",rel:"noopener noreferrer",onClick:x=>{x.stopPropagation()},style:{flex:1,padding:"2px 3px",fontSize:"11px",color:"#0066cc",textDecoration:"underline",cursor:"pointer",wordBreak:"break-all"},title:"Click to open URL in new window",children:e.datasheet.trim()}):l.jsx("input",{id:`component-datasheet-${r.id}`,type:"text",value:e.datasheet||"",onChange:x=>n({...e,datasheet:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"URL (optional, for reference)"})})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-pincount-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Pin Count:"}),l.jsx("input",{id:`component-pincount-${r.id}`,name:`component-pincount-${r.id}`,type:"number",min:"1",value:e.pinCount,onChange:x=>{const k=Math.max(1,parseInt(x.target.value)||1);n({...e,pinCount:k})},onBlur:x=>{if(s){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const k=Math.max(1,parseInt(x.target.value)||1),$=(e.layer==="top"?o:d).find(I=>I.id===e.id);if($&&k!==$.pinCount){const I=$.pinConnections||[],z=new Array(k).fill("").map((F,H)=>H<I.length?I[H]:""),B=$.pinPolarities||[],G=$.pinPolarities?new Array(k).fill("").map((F,H)=>H<B.length?B[H]:""):void 0,te={...$,pinCount:k,pinConnections:z,...G!==void 0&&{pinPolarities:G}};e.layer==="top"?c(F=>F.map(H=>H.id===e.id?te:H)):h(F=>F.map(H=>H.id===e.id?te:H)),n({...e,pinCount:k})}},disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"}})]})]}),r.componentType==="VacuumTube"&&l.jsx(l.Fragment,{children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-tubetype-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tube Type:"}),l.jsx("input",{id:`component-tubetype-${r.id}`,type:"text",value:e.tubeType||"",onChange:x=>n({...e,tubeType:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},placeholder:"e.g., 12AX7, 6L6"})]})}),r.componentType==="VariableResistor"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-vrtype-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"VR Type:"}),l.jsxs("select",{id:`component-vrtype-${r.id}`,value:e.vrType||"Potentiometer",onChange:x=>n({...e,vrType:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"Potentiometer",children:"Potentiometer"}),l.jsx("option",{value:"Rheostat",children:"Rheostat"}),l.jsx("option",{value:"Trimmer",children:"Trimmer"}),l.jsx("option",{value:"Varistor",children:"Varistor"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-resistance-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),l.jsx("input",{id:`component-resistance-${r.id}`,type:"text",value:e.resistance||"",onChange:x=>n({...e,resistance:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 10"}),l.jsx("select",{value:e.resistanceUnit||Yt("resistance"),onChange:x=>n({...e,resistanceUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("resistance").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-power-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),l.jsxs("select",{id:`component-power-${r.id}`,value:e.power||"1/4",onChange:x=>n({...e,power:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"12px"},children:[l.jsx("option",{value:"1/20",children:"1/20 W"}),l.jsx("option",{value:"1/16",children:"1/16 W"}),l.jsx("option",{value:"1/10",children:"1/10 W"}),l.jsx("option",{value:"1/8",children:"1/8 W"}),l.jsx("option",{value:"1/4",children:"1/4 W"}),l.jsx("option",{value:"1/2",children:"1/2 W"}),l.jsx("option",{value:"1",children:"1 W"}),l.jsx("option",{value:"2",children:"2 W"}),l.jsx("option",{value:"3",children:"3 W"}),l.jsx("option",{value:"5",children:"5 W"}),l.jsx("option",{value:"10",children:"10 W"}),l.jsx("option",{value:"25",children:"25 W"}),l.jsx("option",{value:"50",children:"50 W"}),l.jsx("option",{value:"100",children:"100 W"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-taper-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Taper:"}),l.jsxs("select",{id:`component-taper-${r.id}`,value:e.taper||"Linear",onChange:x=>n({...e,taper:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"Linear",children:"Linear"}),l.jsx("option",{value:"Logarithmic",children:"Logarithmic"}),l.jsx("option",{value:"Audio",children:"Audio"})]})]})]}),r.componentType==="Crystal"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-frequency-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Frequency:"}),l.jsx("input",{id:`component-frequency-${r.id}`,type:"text",value:e.frequency||"",onChange:x=>n({...e,frequency:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},placeholder:"e.g., 16.000 MHz"})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-loadcapacitance-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Load Capacitance:"}),l.jsx("input",{id:`component-loadcapacitance-${r.id}`,type:"text",value:e.loadCapacitance||"",onChange:x=>n({...e,loadCapacitance:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},placeholder:"e.g., 18pF"})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-tolerance-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),l.jsxs("select",{id:`component-tolerance-${r.id}`,value:e.tolerance||"10ppm",onChange:x=>n({...e,tolerance:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"10ppm",children:"10ppm"}),l.jsx("option",{value:"20ppm",children:"20ppm"}),l.jsx("option",{value:"30ppm",children:"30ppm"}),l.jsx("option",{value:"50ppm",children:"50ppm"}),l.jsx("option",{value:"100ppm",children:"100ppm"})]})]})]}),r.componentType==="GenericComponent"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-generictype-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Type:"}),l.jsxs("select",{id:`component-generictype-${r.id}`,value:r.genericType||"Attenuator",onChange:x=>n({...e,genericType:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"Attenuator",children:"Attenuator"}),l.jsx("option",{value:"CircuitBreaker",children:"Circuit Breaker"}),l.jsx("option",{value:"Thermocouple",children:"Thermocouple"}),l.jsx("option",{value:"Tuner",children:"Tuner"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-voltage-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),l.jsx("input",{id:`component-voltage-${r.id}`,type:"text",value:e.voltage||"",onChange:x=>n({...e,voltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 50"}),l.jsx("select",{value:e.voltageUnit||Yt("voltage"),onChange:x=>n({...e,voltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-current-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),l.jsx("input",{id:`component-current-${r.id}`,type:"text",value:e.current||"",onChange:x=>n({...e,current:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 1"}),l.jsx("select",{value:e.currentUnit||Yt("current"),onChange:x=>n({...e,currentUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("current").map(x=>l.jsx("option",{value:x,children:x},x))})]}),r.genericType==="Tuner"&&l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-frequency-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Frequency:"}),l.jsx("input",{id:`component-frequency-${r.id}`,type:"text",value:e.frequency||"",onChange:x=>n({...e,frequency:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},placeholder:"e.g., 100MHz"})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-power-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),l.jsx("input",{id:`component-power-${r.id}`,type:"text",value:e.power||"",onChange:x=>n({...e,power:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},placeholder:"e.g., 1W"})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-model-${r.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Model:"}),l.jsx("input",{id:`component-model-${r.id}`,type:"text",value:e.model||"",onChange:x=>n({...e,model:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:s?.6:1,marginRight:"8px"},placeholder:"Part number or model"})]})]})]}):l.jsx("div",{style:{padding:"8px",background:"#fff3cd",border:"1px solid #ffeeba",borderRadius:4,color:"#856404",marginBottom:"8px",fontSize:"11px"},children:"Component definition missing for this instance. Using legacy fields. Please ensure the component has a definition in componentDefinitions.json and a valid componentDefinitionKey."})},bl=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Qm=[.001,0,0,.001,0,0],jm=1.35,gc={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Pu={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},yp="pdfjs_internal_editor_",yi={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Ki={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},A3={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},ey={TRIANGLES:1,LATTICE:2},To={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Wg={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Na={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},sf={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},a0={ERRORS:0,WARNINGS:1,INFOS:5},xp={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},ip={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},C3={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let o0=a0.WARNINGS;function T3(r){Number.isInteger(r)&&(o0=r)}function _3(){return o0}function l0(r){o0>=a0.INFOS&&console.info(`Info: ${r}`)}function hi(r){o0>=a0.WARNINGS&&console.warn(`Warning: ${r}`)}function Xs(r){throw new Error(r)}function Zi(r,e){r||Xs(e)}function k3(r){switch(r?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function X2(r,e=null,t=null){if(!r)return null;if(t&&typeof r=="string"&&(t.addDefaultProtocol&&r.startsWith("www.")&&r.match(/\./g)?.length>=2&&(r=`http://${r}`),t.tryConvertEncoding))try{r=R3(r)}catch{}const n=e?URL.parse(r,e):URL.parse(r);return k3(n)?n:null}function K2(r,e,t=!1){const n=URL.parse(r);return n?(n.hash=e,n.href):t&&X2(r,"http://example.com")?r.split("#",1)[0]+`${e?`#${e}`:""}`:""}function fi(r,e,t,n=!1){return Object.defineProperty(r,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}const mh=(function(){function e(t,n){this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e})();class Tb extends mh{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Pm extends mh{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class ty extends mh{constructor(e){super(e,"InvalidPDFException")}}class Qg extends mh{constructor(e,t,n){super(e,"ResponseException"),this.status=t,this.missing=n}}class N3 extends mh{constructor(e){super(e,"FormatError")}}class Mu extends mh{constructor(e){super(e,"AbortException")}}function Z2(r){(typeof r!="object"||r?.length===void 0)&&Xs("Invalid argument for bytesToString");const e=r.length,t=8192;if(e<t)return String.fromCharCode.apply(null,r);const n=[];for(let s=0;s<e;s+=t){const o=Math.min(s+t,e),d=r.subarray(s,o);n.push(String.fromCharCode.apply(null,d))}return n.join("")}function Cp(r){typeof r!="string"&&Xs("Invalid argument for stringToBytes");const e=r.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=r.charCodeAt(n)&255;return t}function j3(r){return String.fromCharCode(r>>24&255,r>>16&255,r>>8&255,r&255)}function P3(){const r=new Uint8Array(4);return r[0]=1,new Uint32Array(r.buffer,0,1)[0]===1}function E3(){try{return new Function(""),!0}catch{return!1}}class No{static get isLittleEndian(){return fi(this,"isLittleEndian",P3())}static get isEvalSupported(){return fi(this,"isEvalSupported",E3())}static get isOffscreenCanvasSupported(){return fi(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return fi(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return fi(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return fi(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return fi(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){return fi(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Em=Array.from(Array(256).keys(),r=>r.toString(16).padStart(2,"0"));class fn{static makeHexColor(e,t,n){return`#${Em[e]}${Em[t]}${Em[n]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,n=0){const s=e[n],o=e[n+1];e[n]=s*t[0]+o*t[2]+t[4],e[n+1]=s*t[1]+o*t[3]+t[5]}static applyTransformToBezier(e,t,n=0){const s=t[0],o=t[1],d=t[2],c=t[3],h=t[4],f=t[5];for(let m=0;m<6;m+=2){const b=e[n+m],S=e[n+m+1];e[n+m]=b*s+S*d+h,e[n+m+1]=b*o+S*c+f}}static applyInverseTransform(e,t){const n=e[0],s=e[1],o=t[0]*t[3]-t[1]*t[2];e[0]=(n*t[3]-s*t[2]+t[2]*t[5]-t[4]*t[3])/o,e[1]=(-n*t[1]+s*t[0]+t[4]*t[1]-t[5]*t[0])/o}static axialAlignedBoundingBox(e,t,n){const s=t[0],o=t[1],d=t[2],c=t[3],h=t[4],f=t[5],m=e[0],b=e[1],S=e[2],v=e[3];let P=s*m+h,x=P,k=s*S+h,N=k,$=c*b+f,I=$,z=c*v+f,B=z;if(o!==0||d!==0){const G=o*m,te=o*S,F=d*b,H=d*v;P+=F,N+=F,k+=H,x+=H,$+=G,B+=G,z+=te,I+=te}n[0]=Math.min(n[0],P,k,x,N),n[1]=Math.min(n[1],$,z,I,B),n[2]=Math.max(n[2],P,k,x,N),n[3]=Math.max(n[3],$,z,I,B)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const n=e[0],s=e[1],o=e[2],d=e[3],c=n**2+s**2,h=n*o+s*d,f=o**2+d**2,m=(c+f)/2,b=Math.sqrt(m**2-(c*f-h**2));t[0]=Math.sqrt(m+b||1),t[1]=Math.sqrt(m-b||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>s)return null;const o=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),d=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return o>d?null:[n,o,s,d]}static pointBoundingBox(e,t,n){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}static rectBoundingBox(e,t,n,s,o){o[0]=Math.min(o[0],e,n),o[1]=Math.min(o[1],t,s),o[2]=Math.max(o[2],e,n),o[3]=Math.max(o[3],t,s)}static#e(e,t,n,s,o,d,c,h,f,m){if(f<=0||f>=1)return;const b=1-f,S=f*f,v=S*f,P=b*(b*(b*e+3*f*t)+3*S*n)+v*s,x=b*(b*(b*o+3*f*d)+3*S*c)+v*h;m[0]=Math.min(m[0],P),m[1]=Math.min(m[1],x),m[2]=Math.max(m[2],P),m[3]=Math.max(m[3],x)}static#t(e,t,n,s,o,d,c,h,f,m,b,S){if(Math.abs(f)<1e-12){Math.abs(m)>=1e-12&&this.#e(e,t,n,s,o,d,c,h,-b/m,S);return}const v=m**2-4*b*f;if(v<0)return;const P=Math.sqrt(v),x=2*f;this.#e(e,t,n,s,o,d,c,h,(-m+P)/x,S),this.#e(e,t,n,s,o,d,c,h,(-m-P)/x,S)}static bezierBoundingBox(e,t,n,s,o,d,c,h,f){f[0]=Math.min(f[0],e,c),f[1]=Math.min(f[1],t,h),f[2]=Math.max(f[2],e,c),f[3]=Math.max(f[3],t,h),this.#t(e,n,o,c,t,s,d,h,3*(-e+3*(n-o)+c),6*(e-2*n+o),3*(n-e),f),this.#t(e,n,o,c,t,s,d,h,3*(-t+3*(s-d)+h),6*(t-2*s+d),3*(s-t),f)}}function R3(r){return decodeURIComponent(escape(r))}let Rm=null,_b=null;function D3(r){return Rm||(Rm=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,_b=new Map([["","t"]])),r.replaceAll(Rm,(e,t,n)=>t?t.normalize("NFKC"):_b.get(n))}function J2(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const r=new Uint8Array(32);return crypto.getRandomValues(r),Z2(r)}const lf="pdfjs_internal_id_";function L3(r,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[n,s,...o]=t;if(!r(n)&&!Number.isInteger(n)||!e(s))return!1;const d=o.length;let c=!0;switch(s.name){case"XYZ":if(d<2||d>3)return!1;break;case"Fit":case"FitB":return d===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(d>1)return!1;break;case"FitR":if(d!==4)return!1;c=!1;break;default:return!1}for(const h of o)if(!(typeof h=="number"||c&&h===null))return!1;return!0}function vl(r,e,t){return Math.min(Math.max(r,e),t)}function Q2(r){return Uint8Array.prototype.toBase64?r.toBase64():btoa(Z2(r))}function M3(r){return Uint8Array.fromBase64?Uint8Array.fromBase64(r):Cp(atob(r))}typeof Promise.try!="function"&&(Promise.try=function(r,...e){return new Promise(t=>{t(r(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(r){return r.reduce((e,t)=>e+t,0)});class bp{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};function s(o){if(!o)return;let d=null;const c=o.name;if(c==="#text")d=o.value;else if(bp.shouldBuildText(c))o?.attributes?.textContent?d=o.attributes.textContent:o.value&&(d=o.value);else return;if(d!==null&&t.push({str:d}),!!o.children)for(const h of o.children)s(h)}return s(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class ev{static setupStorage(e,t,n,s,o){const d=s.getValue(t,{value:null});switch(n.name){case"textarea":if(d.value!==null&&(e.textContent=d.value),o==="print")break;e.addEventListener("input",c=>{s.setValue(t,{value:c.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(d.value===n.attributes.xfaOn?e.setAttribute("checked",!0):d.value===n.attributes.xfaOff&&e.removeAttribute("checked"),o==="print")break;e.addEventListener("change",c=>{s.setValue(t,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(d.value!==null&&e.setAttribute("value",d.value),o==="print")break;e.addEventListener("input",c=>{s.setValue(t,{value:c.target.value})})}break;case"select":if(d.value!==null){e.setAttribute("value",d.value);for(const c of n.children)c.attributes.value===d.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}e.addEventListener("input",c=>{const h=c.target.options,f=h.selectedIndex===-1?"":h[h.selectedIndex].value;s.setValue(t,{value:f})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:s,linkService:o}){const{attributes:d}=t,c=e instanceof HTMLAnchorElement;d.type==="radio"&&(d.name=`${d.name}-${s}`);for(const[h,f]of Object.entries(d))if(f!=null)switch(h){case"class":f.length&&e.setAttribute(h,f.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",f);break;case"style":Object.assign(e.style,f);break;case"textContent":e.textContent=f;break;default:(!c||h!=="href"&&h!=="newWindow")&&e.setAttribute(h,f)}c&&o.addLinkAttributes(e,d.href,d.newWindow),n&&d.dataId&&this.setupStorage(e,d.dataId,t,n)}static render(e){const t=e.annotationStorage,n=e.linkService,s=e.xfaHtml,o=e.intent||"display",d=document.createElement(s.name);s.attributes&&this.setAttributes({html:d,element:s,intent:o,linkService:n});const c=o!=="richText",h=e.div;if(h.append(d),e.viewport){const b=`matrix(${e.viewport.transform.join(",")})`;h.style.transform=b}c&&h.setAttribute("class","xfaLayer xfaFont");const f=[];if(s.children.length===0){if(s.value){const b=document.createTextNode(s.value);d.append(b),c&&bp.shouldBuildText(s.name)&&f.push(b)}return{textDivs:f}}const m=[[s,-1,d]];for(;m.length>0;){const[b,S,v]=m.at(-1);if(S+1===b.children.length){m.pop();continue}const P=b.children[++m.at(-1)[1]];if(P===null)continue;const{name:x}=P;if(x==="#text"){const N=document.createTextNode(P.value);f.push(N),v.append(N);continue}const k=P?.attributes?.xmlns?document.createElementNS(P.attributes.xmlns,x):document.createElement(x);if(v.append(k),P.attributes&&this.setAttributes({html:k,element:P,storage:t,intent:o,linkService:n}),P.children?.length>0)m.push([P,-1,k]);else if(P.value){const N=document.createTextNode(P.value);c&&bp.shouldBuildText(x)&&f.push(N),k.append(N)}}for(const b of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))b.setAttribute("readOnly",!0);return{textDivs:f}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const $d="http://www.w3.org/2000/svg";class vf{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Tp(r,e="text"){if(cp(r,document.baseURI)){const t=await fetch(r);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{const s=new XMLHttpRequest;s.open("GET",r,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(s.response);return}t(s.responseText);return}n(new Error(s.statusText))}},s.send(null)})}class _p{constructor({viewBox:e,userUnit:t,scale:n,rotation:s,offsetX:o=0,offsetY:d=0,dontFlip:c=!1}){this.viewBox=e,this.userUnit=t,this.scale=n,this.rotation=s,this.offsetX=o,this.offsetY=d,n*=t;const h=(e[2]+e[0])/2,f=(e[3]+e[1])/2;let m,b,S,v;switch(s%=360,s<0&&(s+=360),s){case 180:m=-1,b=0,S=0,v=1;break;case 90:m=0,b=1,S=1,v=0;break;case 270:m=0,b=-1,S=-1,v=0;break;case 0:m=1,b=0,S=0,v=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(S=-S,v=-v);let P,x,k,N;m===0?(P=Math.abs(f-e[1])*n+o,x=Math.abs(h-e[0])*n+d,k=(e[3]-e[1])*n,N=(e[2]-e[0])*n):(P=Math.abs(h-e[0])*n+o,x=Math.abs(f-e[1])*n+d,k=(e[2]-e[0])*n,N=(e[3]-e[1])*n),this.transform=[m*n,b*n,S*n,v*n,P-m*n*h-S*n*f,x-b*n*h-v*n*f],this.width=k,this.height=N}get rawDims(){const e=this.viewBox;return fi(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:s=this.offsetY,dontFlip:o=!1}={}){return new _p({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:s,dontFlip:o})}convertToViewportPoint(e,t){const n=[e,t];return fn.applyTransform(n,this.transform),n}convertToViewportRectangle(e){const t=[e[0],e[1]];fn.applyTransform(t,this.transform);const n=[e[2],e[3]];return fn.applyTransform(n,this.transform),[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){const n=[e,t];return fn.applyInverseTransform(n,this.transform),n}}class wy extends mh{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function c0(r){const e=r.length;let t=0;for(;t<e&&r[t].trim()==="";)t++;return r.substring(t,t+5).toLowerCase()==="data:"}function Sy(r){return typeof r=="string"&&/\.pdf$/i.test(r)}function I3(r){return[r]=r.split(/[#?]/,1),r.substring(r.lastIndexOf("/")+1)}function z3(r,e="document.pdf"){if(typeof r!="string")return e;if(c0(r))return hi('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const n=(c=>{try{return new URL(c)}catch{try{return new URL(decodeURIComponent(c))}catch{try{return new URL(c,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(c),"https://foo.bar")}catch{return null}}}}})(r);if(!n)return e;const s=c=>{try{let h=decodeURIComponent(c);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:c):h}catch{return c}},o=/\.pdf$/i,d=n.pathname.split("/").at(-1);if(o.test(d))return s(d);if(n.searchParams.size>0){const c=Array.from(n.searchParams.values()).reverse();for(const f of c)if(o.test(f))return s(f);const h=Array.from(n.searchParams.keys()).reverse();for(const f of h)if(o.test(f))return s(f)}if(n.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(h)return s(h[0])}return e}class kb{started=Object.create(null);times=[];time(e){e in this.started&&hi(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||hi(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:s,end:o}of this.times)e.push(`${n.padEnd(t)} ${o-s}ms
`);return e.join("")}}function cp(r,e){const t=e?URL.parse(r,e):URL.parse(r);return t?.protocol==="http:"||t?.protocol==="https:"}function Uc(r){r.preventDefault()}function ta(r){r.preventDefault(),r.stopPropagation()}function B3(r){console.log("Deprecated API usage: "+r)}class ny{static#e;static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=this.#e.exec(e);if(!t)return null;const n=parseInt(t[1],10);let s=parseInt(t[2],10);s=s>=1&&s<=12?s-1:0;let o=parseInt(t[3],10);o=o>=1&&o<=31?o:1;let d=parseInt(t[4],10);d=d>=0&&d<=23?d:0;let c=parseInt(t[5],10);c=c>=0&&c<=59?c:0;let h=parseInt(t[6],10);h=h>=0&&h<=59?h:0;const f=t[7]||"Z";let m=parseInt(t[8],10);m=m>=0&&m<=23?m:0;let b=parseInt(t[9],10)||0;return b=b>=0&&b<=59?b:0,f==="-"?(d+=m,c+=b):f==="+"&&(d-=m,c-=b),new Date(Date.UTC(n,s,o,d,c,h))}}function O3(r,{scale:e=1,rotation:t=0}){const{width:n,height:s}=r.attributes.style,o=[0,0,parseInt(n),parseInt(s)];return new _p({viewBox:o,userUnit:1,scale:e,rotation:t})}function kp(r){if(r.startsWith("#")){const e=parseInt(r.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return r.startsWith("rgb(")?r.slice(4,-1).split(",").map(e=>parseInt(e)):r.startsWith("rgba(")?r.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(hi(`Not a valid color format: "${r}"`),[0,0,0])}function F3(r){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of r.keys()){e.style.color=t;const n=window.getComputedStyle(e).color;r.set(t,kp(n))}e.remove()}function Mr(r){const{a:e,b:t,c:n,d:s,e:o,f:d}=r.getTransform();return[e,t,n,s,o,d]}function vd(r){const{a:e,b:t,c:n,d:s,e:o,f:d}=r.getTransform().invertSelf();return[e,t,n,s,o,d]}function hh(r,e,t=!1,n=!0){if(e instanceof _p){const{pageWidth:s,pageHeight:o}=e.rawDims,{style:d}=r,c=No.isCSSRoundSupported,h=`var(--total-scale-factor) * ${s}px`,f=`var(--total-scale-factor) * ${o}px`,m=c?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,b=c?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!t||e.rotation%180===0?(d.width=m,d.height=b):(d.width=b,d.height=m)}n&&r.setAttribute("data-main-rotation",e.rotation)}class kd{constructor(){const{pixelRatio:e}=kd;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,n,s,o=-1){let d=1/0,c=1/0,h=1/0;n=kd.capPixels(n,o),n>0&&(d=Math.sqrt(n/(e*t))),s!==-1&&(c=s/e,h=s/t);const f=Math.min(d,c,h);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,n):n}return e}}const iy=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class U3{static get isDarkMode(){return fi(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class H3{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:n}=window.getComputedStyle(e);return e.remove(),fi(this,"commentForegroundColor",kp(n))}}function q3(r,e,t,n){n=Math.min(Math.max(n??1,0),1);const s=255*(1-n);return r=Math.round(r*n+s),e=Math.round(e*n+s),t=Math.round(t*n+s),[r,e,t]}function Nb(r,e){const t=r[0]/255,n=r[1]/255,s=r[2]/255,o=Math.max(t,n,s),d=Math.min(t,n,s),c=(o+d)/2;if(o===d)e[0]=e[1]=0;else{const h=o-d;switch(e[1]=c<.5?h/(o+d):h/(2-o-d),o){case t:e[0]=((n-s)/h+(n<s?6:0))*60;break;case n:e[0]=((s-t)/h+2)*60;break;case s:e[0]=((t-n)/h+4)*60;break}}e[2]=c}function sy(r,e){const t=r[0],n=r[1],s=r[2],o=(1-Math.abs(2*s-1))*n,d=o*(1-Math.abs(t/60%2-1)),c=s-o/2;switch(Math.floor(t/60)){case 0:e[0]=o+c,e[1]=d+c,e[2]=c;break;case 1:e[0]=d+c,e[1]=o+c,e[2]=c;break;case 2:e[0]=c,e[1]=o+c,e[2]=d+c;break;case 3:e[0]=c,e[1]=d+c,e[2]=o+c;break;case 4:e[0]=d+c,e[1]=c,e[2]=o+c;break;case 5:case 6:e[0]=o+c,e[1]=c,e[2]=d+c;break}}function jb(r){return r<=.03928?r/12.92:((r+.055)/1.055)**2.4}function Pb(r,e,t){sy(r,t),t.map(jb);const n=.2126*t[0]+.7152*t[1]+.0722*t[2];sy(e,t),t.map(jb);const s=.2126*t[0]+.7152*t[1]+.0722*t[2];return n>s?(n+.05)/(s+.05):(s+.05)/(n+.05)}const Eb=new Map;function V3(r,e){const t=r[0]+r[1]*256+r[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let n=Eb.get(t);if(n)return n;const s=new Float32Array(9),o=s.subarray(0,3),d=s.subarray(3,6);Nb(r,d);const c=s.subarray(6,9);Nb(e,c);const h=c[2]<.5,f=h?12:4.5;if(d[2]=h?Math.sqrt(d[2]):1-Math.sqrt(1-d[2]),Pb(d,c,o)<f){let m,b;h?(m=d[2],b=1):(m=0,b=d[2]);const S=.005;for(;b-m>S;){const v=d[2]=(m+b)/2;h===Pb(d,c,o)<f?m=v:b=v}d[2]=h?b:m}return sy(d,o),n=fn.makeHexColor(Math.round(o[0]*255),Math.round(o[1]*255),Math.round(o[2]*255)),Eb.set(t,n),n}function tv({html:r,dir:e,className:t},n){const s=document.createDocumentFragment();if(typeof r=="string"){const o=document.createElement("p");o.dir=e||"auto";const d=r.split(/(?:\r\n?|\n)/);for(let c=0,h=d.length;c<h;++c){const f=d[c];o.append(document.createTextNode(f)),c<h-1&&o.append(document.createElement("br"))}s.append(o)}else ev.render({xfaHtml:r,div:s,intent:"richText"});s.firstElementChild.classList.add("richText",t),n.append(s)}function nv(r){const e=new Path2D;if(!r)return e;for(let t=0,n=r.length;t<n;)switch(r[t++]){case ip.moveTo:e.moveTo(r[t++],r[t++]);break;case ip.lineTo:e.lineTo(r[t++],r[t++]);break;case ip.curveTo:e.bezierCurveTo(r[t++],r[t++],r[t++],r[t++],r[t++],r[t++]);break;case ip.quadraticCurveTo:e.quadraticCurveTo(r[t++],r[t++],r[t++],r[t++]);break;case ip.closePath:e.closePath();break;default:hi(`Unrecognized drawing path operator: ${r[t-1]}`);break}return e}class pp{#e=null;#t=null;#i;#n=null;#a=null;#r=null;#s=null;#o=null;static#c=null;constructor(e){this.#i=e,pp.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=this.#i._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",Uc,{signal:t}),e.addEventListener("pointerdown",pp.#l,{signal:t}));const n=this.#n=document.createElement("div");n.className="buttons",e.append(n);const s=this.#i.toolbarPosition;if(s){const{style:o}=e,d=this.#i._uiManager.direction==="ltr"?1-s[0]:s[0];o.insetInlineEnd=`${100*d}%`,o.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return this.#e}static#l(e){e.stopPropagation()}#h(e){this.#i._focusEventsAllowed=!1,ta(e)}#u(e){this.#i._focusEventsAllowed=!0,ta(e)}#f(e){const t=this.#i._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",this.#h.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#u.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Uc,{signal:t}),!0)}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#a?.shown(),this.#r?.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=this.#i,n=document.createElement("button");n.classList.add("basic","deleteButton"),n.tabIndex=0,n.setAttribute("data-l10n-id",pp.#c[e]),this.#f(n)&&n.addEventListener("click",s=>{t.delete()},{signal:t._signal}),this.#n.append(n)}get#m(){const e=document.createElement("div");return e.className="divider",e}async addAltText(e){const t=await e.render();this.#f(t),this.#n.append(t,this.#m),this.#a=e}addComment(e,t=null){if(this.#r)return;const n=e.renderForToolbar();if(!n)return;this.#f(n);const s=this.#s=this.#m;t?(this.#n.insertBefore(n,t),this.#n.insertBefore(s,t)):this.#n.append(n,s),this.#r=e,e.toolbar=this}addColorPicker(e){if(this.#t)return;this.#t=e;const t=e.renderButton();this.#f(t),this.#n.append(t,this.#m)}async addEditSignatureButton(e){const t=this.#o=await e.renderEditButton(this.#i);this.#f(t),this.#n.append(t,this.#m)}removeButton(e){switch(e){case"comment":this.#r?.removeToolbarCommentButton(),this.#r=null,this.#s?.remove(),this.#s=null;break}}async addButton(e,t){switch(e){case"colorPicker":t&&this.addColorPicker(t);break;case"altText":t&&await this.addAltText(t);break;case"editSignature":t&&await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":t&&this.addComment(t);break}}async addButtonBefore(e,t,n){if(!t&&e==="comment")return;const s=this.#n.querySelector(n);s&&e==="comment"&&this.addComment(t,s)}updateEditSignatureButton(e){this.#o&&(this.#o.title=e)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}}class W3{#e=null;#t=null;#i;constructor(e){this.#i=e}#n(){const e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar");const t=this.#i._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",Uc,{signal:t});const n=this.#e=document.createElement("div");return n.className="buttons",e.append(n),this.#i.hasCommentManager()&&this.#r("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#i.commentSelection("floating_button")}),this.#r("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#i.highlightSelection("floating_button")}),e}#a(e,t){let n=0,s=0;for(const o of e){const d=o.y+o.height;if(d<n)continue;const c=o.x+(t?o.width:0);if(d>n){s=c,n=d;continue}t?c>s&&(s=c):c<s&&(s=c)}return[t?1-s:s,n]}show(e,t,n){const[s,o]=this.#a(t,n),{style:d}=this.#t||=this.#n();e.append(this.#t),d.insetInlineEnd=`${100*s}%`,d.top=`calc(${100*o}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#r(e,t,n,s){const o=document.createElement("button");o.classList.add("basic",e),o.tabIndex=0,o.setAttribute("data-l10n-id",t);const d=document.createElement("span");o.append(d),d.className="visuallyHidden",d.setAttribute("data-l10n-id",n);const c=this.#i._signal;c instanceof AbortSignal&&!c.aborted&&(o.addEventListener("contextmenu",Uc,{signal:c}),o.addEventListener("click",s,{signal:c})),this.#e.append(o)}}function iv(r,e,t){for(const n of t)e.addEventListener(n,r[n].bind(r))}class bs{static#e=NaN;static#t=null;static#i=NaN;static#n=null;static initializeAndAddPointerId(e){(bs.#t||=new Set).add(e)}static setPointer(e,t){bs.#e||=t,bs.#n??=e}static setTimeStamp(e){bs.#i=e}static isSamePointerId(e){return bs.#e===e}static isSamePointerIdOrRemove(e){return bs.#e===e?!0:(bs.#t?.delete(e),!1)}static isSamePointerType(e){return bs.#n===e}static isInitializedAndDifferentPointerType(e){return bs.#n!==null&&!bs.isSamePointerType(e)}static isSameTimeStamp(e){return bs.#i===e}static isUsingMultiplePointers(){return bs.#t?.size>=1}static clearPointerType(){bs.#n=null}static clearPointerIds(){bs.#e=NaN,bs.#t=null}static clearTimeStamp(){bs.#i=NaN}}class $3{#e=0;get id(){return`${yp}${this.#e++}`}}class Ay{#e=J2();#t=0;#i=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=e;const o=s.decode().then(()=>(n.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return fi(this,"_isSVGFittingCanvas",o)}async#n(e,t){this.#i||=new Map;let n=this.#i.get(e);if(n===null)return null;if(n?.bitmap)return n.refCounter+=1,n;try{n||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let s;if(typeof t=="string"?(n.url=t,s=await Tp(t,"blob")):t instanceof File?s=n.file=t:t instanceof Blob&&(s=t),s.type==="image/svg+xml"){const o=Ay._isSVGFittingCanvas,d=new FileReader,c=new Image,h=new Promise((f,m)=>{c.onload=()=>{n.bitmap=c,n.isSvg=!0,f()},d.onload=async()=>{const b=n.svgUrl=d.result;c.src=await o?`${b}#svgView(preserveAspectRatio(none))`:b},c.onerror=d.onerror=m});d.readAsDataURL(s),await h}else n.bitmap=await createImageBitmap(s);n.refCounter=1}catch(s){hi(s),n=null}return this.#i.set(e,n),n&&this.#i.set(n.id,n),n}async getFromFile(e){const{lastModified:t,name:n,size:s,type:o}=e;return this.#n(`${t}_${n}_${s}_${o}`,e)}async getFromUrl(e){return this.#n(e,e)}async getFromBlob(e,t){const n=await t;return this.#n(e,n)}async getFromId(e){this.#i||=new Map;const t=this.#i.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:n}=t;return delete t.blobPromise,this.getFromBlob(t.id,n)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#i||=new Map;let n=this.#i.get(e);if(n?.bitmap)return n.refCounter+=1,n;const s=new OffscreenCanvas(t.width,t.height);return s.getContext("2d").drawImage(t,0,0),n={bitmap:s.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#i.set(e,n),this.#i.set(n.id,n),n}getSvgUrl(e){const t=this.#i.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#i||=new Map;const t=this.#i.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:n}=t;if(!t.url&&!t.file){const s=new OffscreenCanvas(n.width,n.height);s.getContext("bitmaprenderer").transferFromImageBitmap(n),t.blobPromise=s.convertToBlob()}n.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}}class G3{#e=[];#t=!1;#i;#n=-1;constructor(e=128){this.#i=e}add({cmd:e,undo:t,post:n,mustExec:s,type:o=NaN,overwriteIfSameType:d=!1,keepUndo:c=!1}){if(s&&e(),this.#t)return;const h={cmd:e,undo:t,post:n,type:o};if(this.#n===-1){this.#e.length>0&&(this.#e.length=0),this.#n=0,this.#e.push(h);return}if(d&&this.#e[this.#n].type===o){c&&(h.undo=this.#e[this.#n].undo),this.#e[this.#n]=h;return}const f=this.#n+1;f===this.#i?this.#e.splice(0,1):(this.#n=f,f<this.#e.length&&this.#e.splice(f)),this.#e.push(h)}undo(){if(this.#n===-1)return;this.#t=!0;const{undo:e,post:t}=this.#e[this.#n];e(),t?.(),this.#t=!1,this.#n-=1}redo(){if(this.#n<this.#e.length-1){this.#n+=1,this.#t=!0;const{cmd:e,post:t}=this.#e[this.#n];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#e.length-1}cleanType(e){if(this.#n!==-1){for(let t=this.#n;t>=0;t--)if(this.#e[t].type!==e){this.#e.splice(t+1,this.#n-t),this.#n=t;return}this.#e.length=0,this.#n=-1}}destroy(){this.#e=null}}class Np{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=No.platform;for(const[n,s,o={}]of e)for(const d of n){const c=d.startsWith("mac+");t&&c?(this.callbacks.set(d.slice(4),{callback:s,options:o}),this.allKeys.add(d.split("+").at(-1))):!t&&!c&&(this.callbacks.set(d,{callback:s,options:o}),this.allKeys.add(d.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(this.#e(t));if(!n)return;const{callback:s,options:{bubbles:o=!1,args:d=[],checker:c=null}}=n;c&&!c(e,t)||(s.bind(e,...d,t)(),o||ta(t))}}class Cy{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return F3(e),fi(this,"_colors",e)}convert(e){const t=kp(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,s]of this._colors)if(s.every((o,d)=>o===t[d]))return Cy._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?fn.makeHexColor(...t):e}}class Iu{#e=new AbortController;#t=null;#i=null;#n=new Map;#a=new Map;#r=null;#s=null;#o=null;#c=new G3;#l=null;#h=null;#u=null;#f=0;#m=new Set;#g=null;#d=null;#p=new Set;_editorUndoBar=null;#y=!1;#b=!1;#x=!1;#T=null;#A=null;#w=null;#k=null;#v=!1;#C=null;#P=new $3;#N=!1;#j=!1;#z=!1;#R=null;#L=null;#B=null;#M=null;#V=null;#_=yi.NONE;#S=new Set;#D=null;#O=null;#U=null;#G=null;#$=null;#Y={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#H=[0,0];#I=null;#W=null;#J=null;#Q=null;#F=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=Iu.prototype,t=d=>d.#W.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&d.hasSomethingToControl(),n=(d,{target:c})=>{if(c instanceof HTMLInputElement){const{type:h}=c;return h!=="text"&&h!=="number"}return!0},s=this.TRANSLATE_SMALL,o=this.TRANSLATE_BIG;return fi(this,"_keyboardManager",new Np([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(d,{target:c})=>!(c instanceof HTMLButtonElement)&&d.#W.contains(c)&&!d.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(d,{target:c})=>!(c instanceof HTMLButtonElement)&&d.#W.contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-o,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[o,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-o],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,o],checker:t}]]))}constructor(e,t,n,s,o,d,c,h,f,m,b,S,v,P,x,k){const N=this._signal=this.#e.signal;this.#W=e,this.#J=t,this.#Q=n,this.#r=s,this.#l=o,this.#O=d,this.#$=h,this._eventBus=c,c._on("editingaction",this.onEditingAction.bind(this),{signal:N}),c._on("pagechanging",this.onPageChanging.bind(this),{signal:N}),c._on("scalechanging",this.onScaleChanging.bind(this),{signal:N}),c._on("rotationchanging",this.onRotationChanging.bind(this),{signal:N}),c._on("setpreference",this.onSetPreference.bind(this),{signal:N}),c._on("switchannotationeditorparams",$=>this.updateParams($.type,$.value),{signal:N}),window.addEventListener("pointerdown",()=>{this.#j=!0},{capture:!0,signal:N}),window.addEventListener("pointerup",()=>{this.#j=!1},{capture:!0,signal:N}),this.#ae(),this.#he(),this.#te(),this.#s=h.annotationStorage,this.#T=h.filterFactory,this.#U=f,this.#k=m||null,this.#y=b,this.#b=S,this.#x=v,this.#V=P||null,this.viewParameters={realScale:vf.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=x||null,this._supportsPinchToZoom=k!==!1,o?.setSidebarUiManager(this)}destroy(){this.#F?.resolve(),this.#F=null,this.#e?.abort(),this.#e=null,this._signal=null;for(const e of this.#a.values())e.destroy();this.#a.clear(),this.#n.clear(),this.#p.clear(),this.#M?.clear(),this.#t=null,this.#S.clear(),this.#c.destroy(),this.#r?.destroy(),this.#l?.destroy(),this.#O?.destroy(),this.#C?.hide(),this.#C=null,this.#B?.destroy(),this.#B=null,this.#i=null,this.#A&&(clearTimeout(this.#A),this.#A=null),this.#I&&(clearTimeout(this.#I),this.#I=null),this._editorUndoBar?.destroy(),this.#$=null}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#V}get useNewAltTextFlow(){return this.#b}get useNewAltTextWhenAddingImage(){return this.#x}get hcmFilter(){return fi(this,"hcmFilter",this.#U?this.#T.addHCMFilter(this.#U.foreground,this.#U.background):"none")}get direction(){return fi(this,"direction",getComputedStyle(this.#W).direction)}get _highlightColors(){return fi(this,"_highlightColors",this.#k?new Map(this.#k.split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return fi(this,"highlightColors",null);const t=new Map,n=!!this.#U;for(const[s,o]of e){const d=s.endsWith("_HCM");if(n&&d){t.set(s.replace("_HCM",""),o);continue}!n&&!d&&t.set(s,o)}return fi(this,"highlightColors",t)}get highlightColorNames(){return fi(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#u=e}setMainHighlightColorPicker(e){this.#B=e}editAltText(e,t=!1){this.#r?.editAltText(this,e,t)}hasCommentManager(){return!!this.#l}editComment(e,t,n,s){this.#l?.showDialog(this,e,t,n,s)}selectComment(e,t){this.#a.get(e)?.getEditorByUID(t)?.toggleComment(!0,!0)}updateComment(e){this.#l?.updateComment(e.getData())}updatePopupColor(e){this.#l?.updatePopupColor(e)}removeComment(e){this.#l?.removeComments([e.uid])}toggleComment(e,t,n=void 0){this.#l?.toggleCommentPopup(e,t,n)}makeCommentColor(e,t){return e&&this.#l?.makeCommentColor(e,t)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(e){if(this.#a.has(e-1))return;const{resolve:t,promise:n}=Promise.withResolvers(),s=o=>{o.pageNumber===e&&(this._eventBus._off("editorsrendered",s),t())};this._eventBus.on("editorsrendered",s),await n}getSignature(e){this.#O?.getSignature({uiManager:this,editor:e})}get signatureManager(){return this.#O}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":this.#x=t;break}}onPageChanging({pageNumber:e}){this.#f=e-1}focusMainContainer(){this.#W.focus()}findParent(e,t){for(const n of this.#a.values()){const{x:s,y:o,width:d,height:c}=n.div.getBoundingClientRect();if(e>=s&&e<=s+d&&t>=o&&t<=o+c)return n}return null}disableUserSelect(e=!1){this.#J.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#p.add(e)}removeShouldRescale(e){this.#p.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*vf.PDF_TO_CSS_UNITS;for(const t of this.#p)t.onScaleChanging();this.#u?.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}#Z({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e}#ee(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of this.#a.values())if(n.hasTextLayer(e))return n;return null}highlightSelection(e="",t=!1){const n=document.getSelection();if(!n||n.isCollapsed)return;const{anchorNode:s,anchorOffset:o,focusNode:d,focusOffset:c}=n,h=n.toString(),m=this.#Z(n).closest(".textLayer"),b=this.getSelectionBoxes(m);if(!b)return;n.empty();const S=this.#ee(m),v=this.#_===yi.NONE,P=()=>{const x=S?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:b,anchorNode:s,anchorOffset:o,focusNode:d,focusOffset:c,text:h});v&&this.showAllEditors("highlight",!0,!0),t&&x?.editComment()};if(v){this.switchToMode(yi.HIGHLIGHT,P);return}P()}commentSelection(e=""){this.highlightSelection(e,!0)}#se(){const e=document.getSelection();if(!e||e.isCollapsed)return;const n=this.#Z(e).closest(".textLayer"),s=this.getSelectionBoxes(n);s&&(this.#C||=new W3(this),this.#C.show(n,s,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(e){if(!this.#s)return null;const t=`${yp}${e}`,n=this.#s.getRawValue(t);return n&&this.#s.remove(t),n}addToAnnotationStorage(e){!e.isEmpty()&&this.#s&&!this.#s.has(e.id)&&this.#s.setValue(e.id,e)}a11yAlert(e,t=null){const n=this.#Q;n&&(n.setAttribute("data-l10n-id",e),t?n.setAttribute("data-l10n-args",JSON.stringify(t)):n.removeAttribute("data-l10n-args"))}#re(){const e=document.getSelection();if(!e||e.isCollapsed){this.#D&&(this.#C?.hide(),this.#D=null,this.#E({hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===this.#D)return;const s=this.#Z(e).closest(".textLayer");if(!s){this.#D&&(this.#C?.hide(),this.#D=null,this.#E({hasSelectedText:!1}));return}if(this.#C?.hide(),this.#D=t,this.#E({hasSelectedText:!0}),!(this.#_!==yi.HIGHLIGHT&&this.#_!==yi.NONE)&&(this.#_===yi.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#v=this.isShiftKeyDown,!this.isShiftKeyDown)){const o=this.#_===yi.HIGHLIGHT?this.#ee(s):null;if(o?.toggleDrawing(),this.#j){const d=new AbortController,c=this.combinedSignal(d),h=f=>{f.type==="pointerup"&&f.button!==0||(d.abort(),o?.toggleDrawing(!0),f.type==="pointerup"&&this.#X("main_toolbar"))};window.addEventListener("pointerup",h,{signal:c}),window.addEventListener("blur",h,{signal:c})}else o?.toggleDrawing(!0),this.#X("main_toolbar")}}#X(e=""){this.#_===yi.HIGHLIGHT?this.highlightSelection(e):this.#y&&this.#se()}#ae(){document.addEventListener("selectionchange",this.#re.bind(this),{signal:this._signal})}#oe(){if(this.#w)return;this.#w=new AbortController;const e=this.combinedSignal(this.#w);window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}#le(){this.#w?.abort(),this.#w=null}blur(){if(this.isShiftKeyDown=!1,this.#v&&(this.#v=!1,this.#X("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#S)if(t.div.contains(e)){this.#L=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#L)return;const[e,t]=this.#L;this.#L=null,t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}#te(){if(this.#R)return;this.#R=new AbortController;const e=this.combinedSignal(this.#R);window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}#ce(){this.#R?.abort(),this.#R=null}#de(){if(this.#h)return;this.#h=new AbortController;const e=this.combinedSignal(this.#h);document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}#ue(){this.#h?.abort(),this.#h=null}#he(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#te(),this.setEditingState(!0)}removeEditListeners(){this.#ce(),this.setEditingState(!1)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of this.#d)if(n.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const n of this.#d)if(n.isHandlingMimeForPasting(t.type)){n.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const n of this.#S){const s=n.serialize(!0);s&&t.push(s)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const o of t.items)for(const d of this.#d)if(d.isHandlingMimeForPasting(o.type)){d.paste(o,this.currentLayer);return}let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(o){hi(`paste: "${o.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const s=this.currentLayer;try{const o=[];for(const h of n){const f=await s.deserialize(h);if(!f)return;o.push(f)}const d=()=>{for(const h of o)this.#ne(h);this.#ie(o)},c=()=>{for(const h of o)h.remove()};this.addCommands({cmd:d,undo:c,mustExec:!0})}catch(o){hi(`paste: "${o.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),this.#_!==yi.NONE&&!this.isEditorHandlingKeyboard&&Iu._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,this.#v&&(this.#v=!1,this.#X("main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#E(e){Object.entries(e).some(([n,s])=>this.#Y[n]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#Y,e)}),this.#_===yi.HIGHLIGHT&&e.hasSelectedEditor===!1&&this.#q([[Ki.HIGHLIGHT_FREE,!0]]))}#q(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#oe(),this.#de(),this.#E({isEditing:this.#_!==yi.NONE,isEmpty:this.#K(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#le(),this.#ue(),this.#E({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#d){this.#d=e;for(const t of this.#d)this.#q(t.defaultPropertiesToUpdate)}}getId(){return this.#P.id}get currentLayer(){return this.#a.get(this.#f)}getLayer(e){return this.#a.get(e)}get currentPageIndex(){return this.#f}addLayer(e){this.#a.set(e.pageIndex,e),this.#N?e.enable():e.disable()}removeLayer(e){this.#a.delete(e.pageIndex)}async updateMode(e,t=null,n=!1,s=!1,o=!1){if(this.#_!==e&&!(this.#F&&(await this.#F.promise,!this.#F))){if(this.#F=Promise.withResolvers(),this.#u?.commitOrRemove(),this.#_===yi.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#_=e,e===yi.NONE){this.setEditingState(!1),this.#pe();for(const d of this.#n.values())d.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#F.resolve();return}for(const d of this.#n.values())d.addStandaloneCommentButton();e===yi.SIGNATURE&&await this.#O?.loadSignatures(),this.setEditingState(!0),await this.#fe(),this.unselectAll();for(const d of this.#a.values())d.updateMode(e);if(e===yi.POPUP){this.#i||=await this.#$.getAnnotationsByType(new Set(this.#d.map(h=>h._editorType)));const d=new Set,c=[];for(const h of this.#n.values()){const{annotationElementId:f,hasComment:m,deleted:b}=h;f&&d.add(f),m&&!b&&c.push(h.getData())}for(const h of this.#i){const{id:f,popupRef:m,contentsObj:b}=h;m&&b?.str&&!d.has(f)&&!this.#m.has(f)&&c.push(h)}this.#l?.showSidebar(c)}if(!t){n&&this.addNewEditorFromKeyboard(),this.#F.resolve();return}for(const d of this.#n.values())d.uid===t?(this.setSelected(d),o?d.editComment():s?d.enterInEditMode():d.focus()):d.unselect();this.#F.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==this.#_&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(this.#d){switch(e){case Ki.CREATE:this.currentLayer.addNewEditor(t);return;case Ki.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#G||=new Map).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const n of this.#S)n.updateParams(e,t);else for(const n of this.#d)n.updateDefaultParams(e,t)}}showAllEditors(e,t,n=!1){for(const o of this.#n.values())o.editorType===e&&o.show(t);(this.#G?.get(Ki.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#q([[Ki.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(this.#z!==e){this.#z=e;for(const t of this.#a.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}async#fe(){if(!this.#N){this.#N=!0;const e=[];for(const t of this.#a.values())e.push(t.enable());await Promise.all(e);for(const t of this.#n.values())t.enable()}}#pe(){if(this.unselectAll(),this.#N){this.#N=!1;for(const e of this.#a.values())e.disable();for(const e of this.#n.values())e.disable()}}*getEditors(e){for(const t of this.#n.values())t.pageIndex===e&&(yield t)}getEditor(e){return this.#n.get(e)}addEditor(e){this.#n.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#A&&clearTimeout(this.#A),this.#A=setTimeout(()=>{this.focusMainContainer(),this.#A=null},0)),this.#n.delete(e.id),e.annotationElementId&&this.#M?.delete(e.annotationElementId),this.unselect(e),(!e.annotationElementId||!this.#m.has(e.annotationElementId))&&this.#s?.remove(e.id)}addDeletedAnnotationElement(e){this.#m.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#m.has(e)}removeDeletedAnnotationElement(e){this.#m.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#ne(e){const t=this.#a.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#q(e.propertiesToUpdate))}get#ge(){let e=null;for(e of this.#S);return e}updateUI(e){this.#ge===e&&this.#q(e.propertiesToUpdate)}updateUIForDefaultProperties(e){this.#q(e.defaultPropertiesToUpdate)}toggleSelected(e){if(this.#S.has(e)){this.#S.delete(e),e.unselect(),this.#E({hasSelectedEditor:this.hasSelection});return}this.#S.add(e),e.select(),this.#q(e.propertiesToUpdate),this.#E({hasSelectedEditor:!0})}setSelected(e){this.updateToolbar({mode:e.mode,editId:e.uid}),this.#u?.commitOrRemove();for(const t of this.#S)t!==e&&t.unselect();this.#S.clear(),this.#S.add(e),e.select(),this.#q(e.propertiesToUpdate),this.#E({hasSelectedEditor:!0})}isSelected(e){return this.#S.has(e)}get firstSelectedEditor(){return this.#S.values().next().value}unselect(e){e.unselect(),this.#S.delete(e),this.#E({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#S.size!==0}get isEnterHandled(){return this.#S.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#E({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#K()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#E({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#K()})}addCommands(e){this.#c.add(e),this.#E({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#K()})}cleanUndoStack(e){this.#c.cleanType(e)}#K(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const e of this.#n.values())return e.isEmpty();return!1}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...this.#S],n=()=>{this._editorUndoBar?.show(s,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},s=()=>{for(const o of t)this.#ne(o)};this.addCommands({cmd:n,undo:s,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#ie(e){for(const t of this.#S)t.unselect();this.#S.clear();for(const t of e)t.isEmpty()||(this.#S.add(t),t.select());this.#E({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#S)e.commit();this.#ie(this.#n.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#_!==yi.NONE))&&!this.#u?.commitOrRemove()&&this.hasSelection){for(const e of this.#S)e.unselect();this.#S.clear(),this.#E({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#H[0]+=e,this.#H[1]+=t;const[s,o]=this.#H,d=[...this.#S],c=1e3;this.#I&&clearTimeout(this.#I),this.#I=setTimeout(()=>{this.#I=null,this.#H[0]=this.#H[1]=0,this.addCommands({cmd:()=>{for(const h of d)this.#n.has(h.id)&&(h.translateInPage(s,o),h.translationDone())},undo:()=>{for(const h of d)this.#n.has(h.id)&&(h.translateInPage(-s,-o),h.translationDone())},mustExec:!1})},c);for(const h of d)h.translateInPage(e,t),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#g=new Map;for(const e of this.#S)this.#g.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#g)return!1;this.disableUserSelect(!1);const e=this.#g;this.#g=null;let t=!1;for(const[{x:s,y:o,pageIndex:d},c]of e)c.newX=s,c.newY=o,c.newPageIndex=d,t||=s!==c.savedX||o!==c.savedY||d!==c.savedPageIndex;if(!t)return!1;const n=(s,o,d,c)=>{if(this.#n.has(s.id)){const h=this.#a.get(c);h?s._setParentAndPosition(h,o,d):(s.pageIndex=c,s.x=o,s.y=d)}};return this.addCommands({cmd:()=>{for(const[s,{newX:o,newY:d,newPageIndex:c}]of e)n(s,o,d,c)},undo:()=>{for(const[s,{savedX:o,savedY:d,savedPageIndex:c}]of e)n(s,o,d,c)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#g)for(const n of this.#g.keys())n.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#S.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#_}isEditingMode(){return this.#_!==yi.NONE}get imageManager(){return fi(this,"imageManager",new Ay)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let f=0,m=t.rangeCount;f<m;f++)if(!e.contains(t.getRangeAt(f).commonAncestorContainer))return null;const{x:n,y:s,width:o,height:d}=e.getBoundingClientRect();let c;switch(e.getAttribute("data-main-rotation")){case"90":c=(f,m,b,S)=>({x:(m-s)/d,y:1-(f+b-n)/o,width:S/d,height:b/o});break;case"180":c=(f,m,b,S)=>({x:1-(f+b-n)/o,y:1-(m+S-s)/d,width:b/o,height:S/d});break;case"270":c=(f,m,b,S)=>({x:1-(m+S-s)/d,y:(f-n)/o,width:S/d,height:b/o});break;default:c=(f,m,b,S)=>({x:(f-n)/o,y:(m-s)/d,width:b/o,height:S/d});break}const h=[];for(let f=0,m=t.rangeCount;f<m;f++){const b=t.getRangeAt(f);if(!b.collapsed)for(const{x:S,y:v,width:P,height:x}of b.getClientRects())P===0||x===0||h.push(c(S,v,P,x))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:e,id:t}){(this.#o||=new Map).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){this.#o?.delete(e)}renderAnnotationElement(e){const t=this.#o?.get(e.data.id);if(!t)return;const n=this.#s.getRawValue(t);n&&(this.#_===yi.NONE&&!n.hasBeenModified||n.renderAnnotationElement(e))}setMissingCanvas(e,t,n){const s=this.#M?.get(e);s&&(s.setCanvas(t,n),this.#M.delete(e))}addMissingCanvas(e,t){(this.#M||=new Map).set(e,t)}}class Cd{#e=null;#t=!1;#i=null;#n=null;#a=null;#r=null;#s=!1;#o=null;#c=null;#l=null;#h=null;#u=!1;static#f=null;static _l10n=null;constructor(e){this.#c=e,this.#u=e._uiManager.useNewAltTextFlow,Cd.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(e){Cd._l10n??=e}async render(){const e=this.#i=document.createElement("button");e.className="altText",e.tabIndex="0";const t=this.#n=document.createElement("span");e.append(t),this.#u?(e.classList.add("new"),e.setAttribute("data-l10n-id",Cd.#f.missing),t.setAttribute("data-l10n-id",Cd.#f["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=this.#c._uiManager._signal;e.addEventListener("contextmenu",Uc,{signal:n}),e.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:n});const s=o=>{o.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#u&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#m}})};return e.addEventListener("click",s,{capture:!0,signal:n}),e.addEventListener("keydown",o=>{o.target===e&&o.key==="Enter"&&(this.#s=!0,s(o))},{signal:n}),await this.#g(),e}get#m(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#i&&(this.#i.focus({focusVisible:this.#s}),this.#s=!1)}isEmpty(){return this.#u?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#u?this.#e!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(e){this.#e===null&&(this.#l=e,this.#h=await Cd._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e}),this.#g())}toggleAltTextBadge(e=!1){if(!this.#u||this.#e){this.#o?.remove(),this.#o=null;return}if(!this.#o){const t=this.#o=document.createElement("div");t.className="noAltTextBadge",this.#c.div.append(t)}this.#o.classList.toggle("hidden",!e)}serialize(e){let t=this.#e;return!e&&this.#l===t&&(t=this.#h),{altText:t,decorative:this.#t,guessedText:this.#l,textWithDisclaimer:this.#h}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:e,decorative:t,guessedText:n,textWithDisclaimer:s,cancel:o=!1}){n&&(this.#l=n,this.#h=s),!(this.#e===e&&this.#t===t)&&(o||(this.#e=e,this.#t=t),this.#g())}toggle(e=!1){this.#i&&(!e&&this.#r&&(clearTimeout(this.#r),this.#r=null),this.#i.disabled=!e)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#m}})}destroy(){this.#i?.remove(),this.#i=null,this.#n=null,this.#a=null,this.#o?.remove(),this.#o=null}async#g(){const e=this.#i;if(!e)return;if(this.#u){if(e.classList.toggle("done",!!this.#e),e.setAttribute("data-l10n-id",Cd.#f[this.#m]),this.#n?.setAttribute("data-l10n-id",Cd.#f[`${this.#m}-label`]),!this.#e){this.#a?.remove();return}}else{if(!this.#e&&!this.#t){e.classList.remove("done"),this.#a?.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=this.#a;if(!t){this.#a=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${this.#c.id}`;const s=100,o=this.#c._uiManager._signal;o.addEventListener("abort",()=>{clearTimeout(this.#r),this.#r=null},{once:!0}),e.addEventListener("mouseenter",()=>{this.#r=setTimeout(()=>{this.#r=null,this.#a.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},s)},{signal:o}),e.addEventListener("mouseleave",()=>{this.#r&&(clearTimeout(this.#r),this.#r=null),this.#a?.classList.remove("show")},{signal:o})}this.#t?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=this.#e),t.parentNode||e.append(t),this.#c.getElementForAltText()?.setAttribute("aria-describedby",t.id)}}class Pg{#e=null;#t=null;#i=!1;#n=null;#a=null;#r=null;#s=null;#o=null;#c=!1;#l=null;constructor(e){this.#n=e}renderForToolbar(){const e=this.#t=document.createElement("button");return e.className="comment",this.#h(e,!1)}renderForStandalone(){const e=this.#e=document.createElement("button");e.className="annotationCommentButton";const t=this.#n.commentButtonPosition;if(t){const{style:n}=e;n.insetInlineEnd=`calc(${100*(this.#n._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,n.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const s=this.#n.commentButtonColor;s&&(n.backgroundColor=s)}return this.#h(e,!0)}focusButton(){setTimeout(()=>{(this.#e??this.#t)?.focus()},0)}onUpdatedColor(){if(!this.#e)return;const e=this.#n.commentButtonColor;e&&(this.#e.style.backgroundColor=e),this.#n._uiManager.updatePopupColor(this.#n)}get commentButtonWidth(){return(this.#e?.getBoundingClientRect().width??0)/this.#n.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#e)return null;const{x:e,y:t,height:n}=this.#e.getBoundingClientRect(),{x:s,y:o,width:d,height:c}=this.#n.parent.boundingClientRect;return[(e-s)/d,(t+n-o)/c]}set commentPopupPositionInLayer(e){this.#l=e}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#e?.remove(),this.#e=null}removeToolbarCommentButton(){this.#t?.remove(),this.#t=null}setCommentButtonStates({selected:e,hasPopup:t}){this.#e&&(this.#e.classList.toggle("selected",e),this.#e.ariaExpanded=t)}#h(e,t){if(!this.#n._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[this.#n._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const n=this.#n._uiManager._signal;if(!(n instanceof AbortSignal)||n.aborted)return e;e.addEventListener("contextmenu",Uc,{signal:n}),t&&(e.addEventListener("focusin",o=>{this.#n._focusEventsAllowed=!1,ta(o)},{capture:!0,signal:n}),e.addEventListener("focusout",o=>{this.#n._focusEventsAllowed=!0,ta(o)},{capture:!0,signal:n})),e.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:n});const s=o=>{o.preventDefault(),e===this.#t?this.edit():this.#n.toggleComment(!0)};return e.addEventListener("click",s,{capture:!0,signal:n}),e.addEventListener("keydown",o=>{o.target===e&&o.key==="Enter"&&(this.#i=!0,s(o))},{signal:n}),e.addEventListener("pointerenter",()=>{this.#n.toggleComment(!1,!0)},{signal:n}),e.addEventListener("pointerleave",()=>{this.#n.toggleComment(!1,!1)},{signal:n}),e}edit(e){const t=this.commentPopupPositionInLayer;let n,s;if(t)[n,s]=t;else{[n,s]=this.#n.commentButtonPosition;const{width:m,height:b,x:S,y:v}=this.#n;n=S+n*m,s=v+s*b}const o=this.#n.parent.boundingClientRect,{x:d,y:c,width:h,height:f}=o;this.#n._uiManager.editComment(this.#n,d+n*h,c+s*f,{...e,parentDimensions:o})}finish(){this.#t&&(this.#t.focus({focusVisible:this.#i}),this.#i=!1)}isDeleted(){return this.#c||this.#s===""}isEmpty(){return this.#s===null}hasBeenEdited(){return this.isDeleted()||this.#s!==this.#a}serialize(){return this.data}get data(){return{text:this.#s,richText:this.#r,date:this.#o,deleted:this.isDeleted()}}set data(e){if(e!==this.#s&&(this.#r=null),e===null){this.#s="",this.#c=!0;return}this.#s=e,this.#o=new Date,this.#c=!1}setInitialText(e,t=null){this.#a=e,this.data=e,this.#o=null,this.#r=t}shown(){}destroy(){this.#t?.remove(),this.#t=null,this.#e?.remove(),this.#e=null,this.#s="",this.#r=null,this.#o=null,this.#n=null,this.#i=!1,this.#c=!1}}class d0{#e;#t=!1;#i=null;#n;#a;#r;#s;#o=null;#c;#l=null;#h;#u=null;constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:n=null,onPinchStart:s=null,onPinching:o=null,onPinchEnd:d=null,signal:c}){this.#e=e,this.#i=n,this.#n=t,this.#a=s,this.#r=o,this.#s=d,this.#h=new AbortController,this.#c=AbortSignal.any([c,this.#h.signal]),e.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/kd.pixelRatio}#f(e){if(this.#n?.())return;if(e.touches.length===1){if(this.#o)return;const s=this.#o=new AbortController,o=AbortSignal.any([this.#c,s.signal]),d=this.#e,c={capture:!0,signal:o,passive:!1},h=f=>{f.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};d.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(ta(f),h(f))},c),d.addEventListener("pointerup",h,c),d.addEventListener("pointercancel",h,c);return}if(!this.#u){this.#u=new AbortController;const s=AbortSignal.any([this.#c,this.#u.signal]),o=this.#e,d={signal:s,capture:!1,passive:!1};o.addEventListener("touchmove",this.#m.bind(this),d);const c=this.#g.bind(this);o.addEventListener("touchend",c,d),o.addEventListener("touchcancel",c,d),d.capture=!0,o.addEventListener("pointerdown",ta,d),o.addEventListener("pointermove",ta,d),o.addEventListener("pointercancel",ta,d),o.addEventListener("pointerup",ta,d),this.#a?.()}if(ta(e),e.touches.length!==2||this.#i?.()){this.#l=null;return}let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]),this.#l={touch0X:t.screenX,touch0Y:t.screenY,touch1X:n.screenX,touch1Y:n.screenY}}#m(e){if(!this.#l||e.touches.length!==2)return;ta(e);let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]);const{screenX:s,screenY:o}=t,{screenX:d,screenY:c}=n,h=this.#l,{touch0X:f,touch0Y:m,touch1X:b,touch1Y:S}=h,v=b-f,P=S-m,x=d-s,k=c-o,N=Math.hypot(x,k)||1,$=Math.hypot(v,P)||1;if(!this.#t&&Math.abs($-N)<=d0.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=s,h.touch0Y=o,h.touch1X=d,h.touch1Y=c,!this.#t){this.#t=!0;return}const I=[(s+d)/2,(o+c)/2];this.#r?.(I,$,N)}#g(e){e.touches.length>=2||(this.#u&&(this.#u.abort(),this.#u=null,this.#s?.()),this.#l&&(ta(e),this.#l=null,this.#t=!1))}destroy(){this.#h?.abort(),this.#h=null,this.#o?.abort(),this.#o=null}}class In{#e=null;#t=null;#i=null;#n=null;#a=null;#r=!1;#s=null;#o="";#c=null;#l=null;#h=null;#u=null;#f=null;#m="";#g=!1;#d=null;#p=!1;#y=!1;#b=!1;#x=null;#T=0;#A=0;#w=null;#k=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#v=!1;#C=In._zIndex++;static _borderLineWidth=-1;static _colorManager=new Cy;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=In.prototype._resizeWithKeyboard,t=Iu.TRANSLATE_SMALL,n=Iu.TRANSLATE_BIG;return fi(this,"_resizerKeyboardManager",new Np([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],In.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null,this.canAddComment=!0;const{rotation:t,rawDims:{pageWidth:n,pageHeight:s,pageX:o,pageY:d}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,s],this.pageTranslation=[o,d];const[c,h]=this.parentDimensions;this.x=e.x/c,this.y=e.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return fi(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new Y3({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(In._l10n??=e,In._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),In._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);In._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Xs("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#v}set _isDraggable(e){this.#v=e,this.div?.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#C}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(this.#I(),this.#u?.remove(),this.#u=null),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#g?this.#g=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,s){const[o,d]=this.parentDimensions;[n,s]=this.screenToPageTranslation(n,s),this.x=(e+n)/o,this.y=(t+s)/d,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[n,s]=this.parentDimensions;this.setAt(e*n,t*s,this.width*n,this.height*s),this._onTranslated()}#P([e,t],n,s){[n,s]=this.screenToPageTranslation(n,s),this.x+=n/e,this.y+=s/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#P(this.parentDimensions,e,t)}translateInPage(e,t){this.#d||=[this.x,this.y,this.width,this.height],this.#P(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){this.#d||=[this.x,this.y,this.width,this.height];const{div:n,parentDimensions:[s,o]}=this;if(this.x+=e/s,this.y+=t/o,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:b,y:S}=this.div.getBoundingClientRect();this.parent.findNewParent(this,b,S)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:d,y:c}=this;const[h,f]=this.getBaseTranslation();d+=h,c+=f;const{style:m}=n;m.left=`${(100*d).toFixed(2)}%`,m.top=`${(100*c).toFixed(2)}%`,this._onTranslating(d,c),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#d&&(this.#d[0]!==this.x||this.#d[1]!==this.y)}get _hasBeenResized(){return!!this.#d&&(this.#d[2]!==this.width||this.#d[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=In,s=n/e,o=n/t;switch(this.rotation){case 90:return[-s,o];case 180:return[s,o];case 270:return[s,-o];default:return[-s,-o]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[n,s]}=this;let{x:o,y:d,width:c,height:h}=this;if(c*=n,h*=s,o*=n,d*=s,this._mustFixPosition)switch(e){case 0:o=vl(o,0,n-c),d=vl(d,0,s-h);break;case 90:o=vl(o,0,n-h),d=vl(d,c,s);break;case 180:o=vl(o,c,n),d=vl(d,h,s);break;case 270:o=vl(o,h,n),d=vl(d,0,s-c);break}this.x=o/=n,this.y=d/=s;const[f,m]=this.getBaseTranslation();o+=f,d+=m,t.left=`${(100*o).toFixed(2)}%`,t.top=`${(100*d).toFixed(2)}%`,this.moveInDOM()}static#N(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return In.#N(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return In.#N(e,t,360-this.parentRotation)}#j(e){switch(e){case 90:{const[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(){const{div:{style:e},width:t,height:n}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*n).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#z(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const s=document.createElement("div");this.#c.append(s),s.classList.add("resizer",n),s.setAttribute("data-resizer-name",n),s.addEventListener("pointerdown",this.#R.bind(this,n),{signal:t}),s.addEventListener("contextmenu",Uc,{signal:t}),s.tabIndex=-1}this.div.prepend(this.#c)}#R(e,t){t.preventDefault();const{isMac:n}=No.platform;if(t.button!==0||t.ctrlKey&&n)return;this.#i?.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,this.#l=[t.screenX,t.screenY];const o=new AbortController,d=this._uiManager.combinedSignal(o);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#M.bind(this,e),{passive:!0,capture:!0,signal:d}),window.addEventListener("touchmove",ta,{passive:!1,signal:d}),window.addEventListener("contextmenu",Uc,{signal:d}),this.#h={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const c=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const f=()=>{o.abort(),this.parent.togglePointerEvents(!0),this.#i?.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=c,this.div.style.cursor=h,this.#B()};window.addEventListener("pointerup",f,{signal:d}),window.addEventListener("blur",f,{signal:d})}#L(e,t,n,s){this.width=n,this.height=s,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#B(){if(!this.#h)return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:s}=this.#h;this.#h=null;const o=this.x,d=this.y,c=this.width,h=this.height;o===e&&d===t&&c===n&&h===s||this.addCommands({cmd:this.#L.bind(this,o,d,c,h),undo:this.#L.bind(this,e,t,n,s),mustExec:!0})}static _round(e){return Math.round(e*1e4)/1e4}#M(e,t){const[n,s]=this.parentDimensions,o=this.x,d=this.y,c=this.width,h=this.height,f=In.MIN_SIZE/n,m=In.MIN_SIZE/s,b=this.#j(this.rotation),S=(V,ee)=>[b[0]*V+b[2]*ee,b[1]*V+b[3]*ee],v=this.#j(360-this.rotation),P=(V,ee)=>[v[0]*V+v[2]*ee,v[1]*V+v[3]*ee];let x,k,N=!1,$=!1;switch(e){case"topLeft":N=!0,x=(V,ee)=>[0,0],k=(V,ee)=>[V,ee];break;case"topMiddle":x=(V,ee)=>[V/2,0],k=(V,ee)=>[V/2,ee];break;case"topRight":N=!0,x=(V,ee)=>[V,0],k=(V,ee)=>[0,ee];break;case"middleRight":$=!0,x=(V,ee)=>[V,ee/2],k=(V,ee)=>[0,ee/2];break;case"bottomRight":N=!0,x=(V,ee)=>[V,ee],k=(V,ee)=>[0,0];break;case"bottomMiddle":x=(V,ee)=>[V/2,ee],k=(V,ee)=>[V/2,0];break;case"bottomLeft":N=!0,x=(V,ee)=>[0,ee],k=(V,ee)=>[V,0];break;case"middleLeft":$=!0,x=(V,ee)=>[0,ee/2],k=(V,ee)=>[V,ee/2];break}const I=x(c,h),z=k(c,h);let B=S(...z);const G=In._round(o+B[0]),te=In._round(d+B[1]);let F=1,H=1,Q,M;if(t.fromKeyboard)({deltaX:Q,deltaY:M}=t);else{const{screenX:V,screenY:ee}=t,[ae,Ce]=this.#l;[Q,M]=this.screenToPageTranslation(V-ae,ee-Ce),this.#l[0]=V,this.#l[1]=ee}if([Q,M]=P(Q/n,M/s),N){const V=Math.hypot(c,h);F=H=Math.max(Math.min(Math.hypot(z[0]-I[0]-Q,z[1]-I[1]-M)/V,1/c,1/h),f/c,m/h)}else $?F=vl(Math.abs(z[0]-I[0]-Q),f,1)/c:H=vl(Math.abs(z[1]-I[1]-M),m,1)/h;const T=In._round(c*F),R=In._round(h*H);B=S(...k(T,R));const Z=G-B[0],se=te-B[1];this.#d||=[this.x,this.y,this.width,this.height],this.width=T,this.height=R,this.x=Z,this.y=se,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#i?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#y)return this._editToolbar;this._editToolbar=new pp(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,n]of e)await this._editToolbar.addButton(t,n);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#i?.destroy()}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#i||(Cd.initialize(In._l10n),this.#i=new Cd(this),this.#e&&(this.#i.data=this.#e,this.#e=null)),this.#i}get altTextData(){return this.#i?.data}set altTextData(e){this.#i&&(this.#i.data=e)}get guessedAltText(){return this.#i?.guessedText}async setGuessedAltText(e){await this.#i?.setGuessedText(e)}serializeAltText(e){return this.#i?.serialize(e)}hasAltText(){return!!this.#i&&!this.#i.isEmpty()}hasAltTextData(){return this.#i?.hasData()??!1}focusCommentButton(){this.#n?.focusButton()}addCommentButton(){return this.canAddComment?this.#n||=new Pg(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#a){this._uiManager.isEditingMode()&&this.#a.classList.remove("hidden");return}this.hasComment&&(this.#a=this.#n.renderForStandalone(),this.div.append(this.#a))}}removeStandaloneCommentButton(){this.#n.removeStandaloneCommentButton(),this.#a=null}hideStandaloneCommentButton(){this.#a?.classList.add("hidden")}get comment(){const{data:{richText:e,text:t,date:n,deleted:s}}=this.#n;return{text:t,richText:e,date:n,deleted:s,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){this.#n||=new Pg(this),this.#n.data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:n}){if(!t||(this.#n||=new Pg(this),this.#n.setInitialText(e,n),!this.annotationElementId))return;const s=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);s&&this.updateFromAnnotationLayer(s)}get hasEditedComment(){return this.#n?.hasBeenEdited()}get hasDeletedComment(){return this.#n?.isDeleted()}get hasComment(){return!!this.#n&&!this.#n.isEmpty()&&!this.#n.isDeleted()}async editComment(e){this.#n||=new Pg(this),this.#n.edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){this.#n.setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,s]=e.rect,[o]=this.pageDimensions,[d]=this.pageTranslation,c=d+o+1,h=s-100,f=c+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[c,h,f,s]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){this.#n.data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=this.#r?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),this.#U();const[t,n]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*n/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/n).toFixed(2)}%`);const[s,o]=this.getInitialTranslation();return this.translate(s,o),iv(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#k||=new d0({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#V.bind(this),onPinching:this.#_.bind(this),onPinchEnd:this.#S.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),e}#V(){this.#h={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#i?.toggle(!1),this.parent.togglePointerEvents(!1)}#_(e,t,n){let o=.7*(n/t)+1-.7;if(o===1)return;const d=this.#j(this.rotation),c=(G,te)=>[d[0]*G+d[2]*te,d[1]*G+d[3]*te],[h,f]=this.parentDimensions,m=this.x,b=this.y,S=this.width,v=this.height,P=In.MIN_SIZE/h,x=In.MIN_SIZE/f;o=Math.max(Math.min(o,1/S,1/v),P/S,x/v);const k=In._round(S*o),N=In._round(v*o);if(k===S&&N===v)return;this.#d||=[m,b,S,v];const $=c(S/2,v/2),I=In._round(m+$[0]),z=In._round(b+$[1]),B=c(k/2,N/2);this.x=I-B[0],this.y=z-B[1],this.width=k,this.height=N,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#S(){this.#i?.toggle(!0),this.parent.togglePointerEvents(!0),this.#B()}pointerdown(e){const{isMac:t}=No.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#g=!0,this._isDraggable){this.#O(e);return}this.#D(e)}#D(e){const{isMac:t}=No.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#O(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const s=new AbortController,o=this._uiManager.combinedSignal(s),d={capture:!0,passive:!1,signal:o},c=f=>{s.abort(),this.#s=null,this.#g=!1,this._uiManager.endDragSession()||this.#D(f),n&&this._onStopDragging()};t&&(this.#T=e.clientX,this.#A=e.clientY,this.#s=e.pointerId,this.#o=e.pointerType,window.addEventListener("pointermove",f=>{n||(n=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:m,clientY:b,pointerId:S}=f;if(S!==this.#s){ta(f);return}const[v,P]=this.screenToPageTranslation(m-this.#T,b-this.#A);this.#T=m,this.#A=b,this._uiManager.dragSelectedEditors(v,P)},d),window.addEventListener("touchmove",ta,d),window.addEventListener("pointerdown",f=>{f.pointerType===this.#o&&(this.#k||f.isPrimary)&&c(f),ta(f)},d));const h=f=>{if(!this.#s||this.#s===f.pointerId){c(f);return}ta(f)};window.addEventListener("pointerup",h,{signal:o}),window.addEventListener("blur",h,{signal:o})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#x&&clearTimeout(this.#x),this.#x=setTimeout(()=>{this.#x=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,n=this.rotation){const s=this.parentScale,[o,d]=this.pageDimensions,[c,h]=this.pageTranslation,f=e/s,m=t/s,b=this.x*o,S=this.y*d,v=this.width*o,P=this.height*d;switch(n){case 0:return[b+f+c,d-S-m-P+h,b+f+v+c,d-S-m+h];case 90:return[b+m+c,d-S+f+h,b+m+P+c,d-S+f+v+h];case 180:return[b-f-v+c,d-S+m+h,b-f+c,d-S+m+P+h];case 270:return[b-m-P+c,d-S-f-v+h,b-m+c,d-S-f+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,s,o,d]=e,c=o-n,h=d-s;switch(this.rotation){case 0:return[n,t-d,c,h];case 90:return[n,t-s,h,c];case 180:return[o,t-s,c,h];case 270:return[o,t-d,h,c];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&In._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#n?.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:n,opacity:s,deleted:o,richText:d},uid:c,pageIndex:h,creationDate:f,modificationDate:m}=this;return{id:c,pageIndex:h,rect:this.getPDFRect(),richText:d,contentsObj:{str:e},creationDate:f,modificationDate:n||m,popupRef:!o,color:t,opacity:s}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#y=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#y=!1,!0):!1}isInEditMode(){return this.#y}shouldGetKeyboardEvents(){return this.#b}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:s}=this.getClientDimensions(),{innerHeight:o,innerWidth:d}=window;return t<d&&s>0&&e<o&&n>0}#U(){if(this.#f||!this.div)return;this.#f=new AbortController;const e=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#U()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(e,t,n){const s=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});s.rotation=e.rotation,s.#e=e.accessibilityData,s._isCopy=e.isCopy||!1;const[o,d]=s.pageDimensions,[c,h,f,m]=s.getRectInCurrentCoords(e.rect,d);return s.x=c/o,s.y=h/d,s.width=f/o,s.height=m/d,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#x&&(clearTimeout(this.#x),this.#x=null),this.#I(),this.removeEditToolbar(),this.#w){for(const e of this.#w.values())clearTimeout(e);this.#w=null}this.parent=null,this.#k?.destroy(),this.#k=null,this.#u?.remove(),this.#u=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#z(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[n,s,o,d]=this.getPDFRect();return[In._round(n+(o-n)*e),In._round(s+(d-s)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#n.commentPopupPositionInLayer}set commentPopupPosition(e){this.#n.commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return this.#n.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#n.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){this.#n?.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#h={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#c.children;if(!this.#t){this.#t=Array.from(t);const d=this.#G.bind(this),c=this.#$.bind(this),h=this._uiManager._signal;for(const f of this.#t){const m=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",d,{signal:h}),f.addEventListener("blur",c,{signal:h}),f.addEventListener("focus",this.#Y.bind(this,m),{signal:h}),f.setAttribute("data-l10n-id",In._l10nResizer[m])}}const n=this.#t[0];let s=0;for(const d of t){if(d===n)break;s++}const o=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(o!==s){if(o<s)for(let c=0;c<s-o;c++)this.#c.append(this.#c.firstElementChild);else if(o>s)for(let c=0;c<o-s;c++)this.#c.firstElementChild.before(this.#c.lastElementChild);let d=0;for(const c of t){const f=this.#t[d++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",In._l10nResizer[f])}}this.#H(0),this.#b=!0,this.#c.firstElementChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#G(e){In._resizerKeyboardManager.exec(this,e)}#$(e){this.#b&&e.relatedTarget?.parentNode!==this.#c&&this.#I()}#Y(e){this.#m=this.#b?e:""}#H(e){if(this.#t)for(const t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#b&&this.#M(this.#m,{deltaX:e,deltaY:t,fromKeyboard:!0})}#I(){this.#b=!1,this.#H(-1),this.#B()}_stopResizingWithKeyboard(){this.#I(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#i?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#i?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(e){this.#p=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#w||=new Map;const{action:n}=e;let s=this.#w.get(n);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(e),this.#w.delete(n),this.#w.size===0&&(this.#w=null)},In._telemetryTimeout),this.#w.set(n,s);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#r=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#r=!0}updateFakeAnnotationElement(e){if(!this.#u&&!this.deleted){this.#u=e.addFakeAnnotation(this);return}if(this.deleted){this.#u.remove(),this.#u=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#u.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){const{firstElementChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}}class Y3 extends In{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Rb=3285377520,Ic=4294901760,wd=65535;class sv{constructor(e){this.h1=e?e&4294967295:Rb,this.h2=e?e&4294967295:Rb}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let x=0,k=e.length;x<k;x++){const N=e.charCodeAt(x);N<=255?t[n++]=N:(t[n++]=N>>>8,t[n++]=N&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=n>>2,o=n-s*4,d=new Uint32Array(t.buffer,0,s);let c=0,h=0,f=this.h1,m=this.h2;const b=3432918353,S=461845907,v=b&wd,P=S&wd;for(let x=0;x<s;x++)x&1?(c=d[x],c=c*b&Ic|c*v&wd,c=c<<15|c>>>17,c=c*S&Ic|c*P&wd,f^=c,f=f<<13|f>>>19,f=f*5+3864292196):(h=d[x],h=h*b&Ic|h*v&wd,h=h<<15|h>>>17,h=h*S&Ic|h*P&wd,m^=h,m=m<<13|m>>>19,m=m*5+3864292196);switch(c=0,o){case 3:c^=t[s*4+2]<<16;case 2:c^=t[s*4+1]<<8;case 1:c^=t[s*4],c=c*b&Ic|c*v&wd,c=c<<15|c>>>17,c=c*S&Ic|c*P&wd,s&1?f^=c:m^=c}this.h1=f,this.h2=m}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Ic|e*36045&wd,t=t*4283543511&Ic|((t<<16|e>>>16)*2950163797&Ic)>>>16,e^=t>>>1,e=e*444984403&Ic|e*60499&wd,t=t*3301882366&Ic|((t<<16|e>>>16)*3120437893&Ic)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const ry=Object.freeze({map:null,hash:"",transfer:void 0});class Ty{#e=!1;#t=null;#i=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=this.#n.get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return this.#n.get(e)}remove(e){const t=this.#n.get(e);if(t!==void 0&&(t instanceof In&&this.#i.delete(t.annotationElementId),this.#n.delete(e),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const n of this.#n.values())if(n instanceof In)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=this.#n.get(e);let s=!1;if(n!==void 0)for(const[o,d]of Object.entries(t))n[o]!==d&&(s=!0,n[o]=d);else s=!0,this.#n.set(e,t);s&&this.#a(),t instanceof In&&((this.#i||=new Map).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return this.#n.has(e)}get size(){return this.#n.size}#a(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new rv(this)}get serializable(){if(this.#n.size===0)return ry;const e=new Map,t=new sv,n=[],s=Object.create(null);let o=!1;for(const[d,c]of this.#n){const h=c instanceof In?c.serialize(!1,s):c;h&&(e.set(d,h),t.update(`${d}:${JSON.stringify(h)}`),o||=!!h.bitmap)}if(o)for(const d of e.values())d.bitmap&&n.push(d.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:ry}get editorStats(){let e=null;const t=new Map;let n=0,s=0;for(const o of this.#n.values()){if(!(o instanceof In)){o.popup&&(o.popup.deleted?s+=1:n+=1);continue}o.isCommentDeleted?s+=1:o.hasEditedComment&&(n+=1);const d=o.telemetryFinalData;if(!d)continue;const{type:c}=d;t.has(c)||t.set(c,Object.getPrototypeOf(o).constructor),e||=Object.create(null);const h=e[c]||=new Map;for(const[f,m]of Object.entries(d)){if(f==="type")continue;let b=h.get(f);b||(b=new Map,h.set(f,b));const S=b.get(m)??0;b.set(m,S+1)}}if((s>0||n>0)&&(e||=Object.create(null),e.comments={deleted:s,edited:n}),!e)return null;for(const[o,d]of t)e[o]=d.computeTelemetryFinalData(e[o]);return e}resetModifiedIds(){this.#t=null}updateEditor(e,t){const n=this.#i?.get(e);return n?(n.updateFromAnnotationLayer(t),!0):!1}getEditor(e){return this.#i?.get(e)||null}get modifiedIds(){if(this.#t)return this.#t;const e=[];if(this.#i)for(const t of this.#i.values())t.serialize()&&e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class rv extends Ty{#e;constructor(e){super();const{map:t,hash:n,transfer:s}=e.serializable,o=structuredClone(t,s?{transfer:s}:null);this.#e={map:o,hash:n,transfer:s}}get print(){Xs("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return fi(this,"modifiedIds",{ids:new Set,hash:""})}}class X3{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:n}){if(!(!e||this.#e.has(e.loadedName))){if(Zi(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:o,style:d}=e,c=new FontFace(s,o,d);this.addNativeFontFace(c);try{await c.load(),this.#e.add(s),n?.(e)}catch{hi(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(c)}return}Xs("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(s){throw hi(`Failed to load font '${n.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const s=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,s)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return fi(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return fi(this,"isSyncFontLoadingSupported",bl||No.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(Zi(!s.done,"completeRequest() cannot be called twice."),s.done=!0;n.length>0&&n[0].done;){const o=n.shift();setTimeout(o.callback,0)}}const{loadingRequests:n}=this,s={done:!1,complete:t,callback:e};return n.push(s),s}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return fi(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(z,B){return z.charCodeAt(B)<<24|z.charCodeAt(B+1)<<16|z.charCodeAt(B+2)<<8|z.charCodeAt(B+3)&255}function s(z,B,G,te){const F=z.substring(0,B),H=z.substring(B+G);return F+te+H}let o,d;const c=this._document.createElement("canvas");c.width=1,c.height=1;const h=c.getContext("2d");let f=0;function m(z,B){if(++f>30){hi("Load test font never loaded."),B();return}if(h.font="30px "+z,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){B();return}setTimeout(m.bind(null,z,B))}const b=`lt${Date.now()}${this.loadTestFontId++}`;let S=this._loadTestFont;S=s(S,976,b.length,b);const P=16,x=1482184792;let k=n(S,P);for(o=0,d=b.length-3;o<d;o+=4)k=k-x+n(b,o)|0;o<b.length&&(k=k-x+n(b+"XXX",o)|0),S=s(S,P,4,j3(k));const N=`url(data:font/opentype;base64,${btoa(S)});`,$=`@font-face {font-family:"${b}";src:${N}}`;this.insertRule($);const I=this._document.createElement("div");I.style.visibility="hidden",I.style.width=I.style.height="10px",I.style.position="absolute",I.style.top=I.style.left="0px";for(const z of[e.loadedName,b]){const B=this._document.createElement("span");B.textContent="Hi",B.style.fontFamily=z,I.append(B)}this._document.body.append(I),m(b,()=>{I.remove(),t.complete()})}}class K3{#e;constructor(e,t=null,n,s){this.compiledGlyphs=Object.create(null),this.#e=e,this._inspectFont=t,n&&Object.assign(this,n),s&&(this.charProcOperatorList=s)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${Q2(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const n=this.loadedName+"_path_"+t;let s;try{s=e.get(n)}catch(d){hi(`getPathGenerator - ignoring character: "${d}".`)}const o=nv(s);return this.fontExtraProperties||e.delete(n),this.compiledGlyphs[t]=o}get black(){return this.#e.black}get bold(){return this.#e.bold}get disableFontFace(){return this.#e.disableFontFace??!1}set disableFontFace(e){fi(this,"disableFontFace",!!e)}get fontExtraProperties(){return this.#e.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#e.isInvalidPDFjsFont}get isType3Font(){return this.#e.isType3Font}get italic(){return this.#e.italic}get missingFile(){return this.#e.missingFile}get remeasure(){return this.#e.remeasure}get vertical(){return this.#e.vertical}get ascent(){return this.#e.ascent}get defaultWidth(){return this.#e.defaultWidth}get descent(){return this.#e.descent}get bbox(){return this.#e.bbox}set bbox(e){fi(this,"bbox",e)}get fontMatrix(){return this.#e.fontMatrix}get fallbackName(){return this.#e.fallbackName}get loadedName(){return this.#e.loadedName}get mimetype(){return this.#e.mimetype}get name(){return this.#e.name}get data(){return this.#e.data}clearData(){this.#e.clearData()}get cssFontInfo(){return this.#e.cssFontInfo}get systemFontInfo(){return this.#e.systemFontInfo}get defaultVMetrics(){return this.#e.defaultVMetrics}}class gf{#e;#t;#i;static strings=["fontFamily","fontWeight","italicAngle"];static write(e){const t=new TextEncoder,n={};let s=0;for(const f of gf.strings){const m=t.encode(e[f]);n[f]=m,s+=4+m.length}const o=new ArrayBuffer(s),d=new Uint8Array(o),c=new DataView(o);let h=0;for(const f of gf.strings){const m=n[f],b=m.length;c.setUint32(h,b),d.set(m,h+4),h+=4+b}return Zi(h===o.byteLength,"CssFontInfo.write: Buffer overflow"),o}constructor(e){this.#e=e,this.#t=new DataView(this.#e),this.#i=new TextDecoder}#n(e){Zi(e<gf.strings.length,"Invalid string index");let t=0;for(let s=0;s<e;s++)t+=this.#t.getUint32(t)+4;const n=this.#t.getUint32(t);return this.#i.decode(new Uint8Array(this.#e,t+4,n))}get fontFamily(){return this.#n(0)}get fontWeight(){return this.#n(1)}get italicAngle(){return this.#n(2)}}class mf{#e;#t;#i;static strings=["css","loadedName","baseFontName","src"];static write(e){const t=new TextEncoder,n={};let s=0;for(const S of mf.strings){const v=t.encode(e[S]);n[S]=v,s+=4+v.length}s+=4;let o,d,c=1+s;e.style&&(o=t.encode(e.style.style),d=t.encode(e.style.weight),c+=4+o.length+4+d.length);const h=new ArrayBuffer(c),f=new Uint8Array(h),m=new DataView(h);let b=0;m.setUint8(b++,e.guessFallback?1:0),m.setUint32(b,0),b+=4,s=0;for(const S of mf.strings){const v=n[S],P=v.length;s+=4+P,m.setUint32(b,P),f.set(v,b+4),b+=4+P}return m.setUint32(b-s-4,s),e.style&&(m.setUint32(b,o.length),f.set(o,b+4),b+=4+o.length,m.setUint32(b,d.length),f.set(d,b+4),b+=4+d.length),Zi(b<=h.byteLength,"SubstitionInfo.write: Buffer overflow"),h.transferToFixedLength(b)}constructor(e){this.#e=e,this.#t=new DataView(this.#e),this.#i=new TextDecoder}get guessFallback(){return this.#t.getUint8(0)!==0}#n(e){Zi(e<mf.strings.length,"Invalid string index");let t=5;for(let s=0;s<e;s++)t+=this.#t.getUint32(t)+4;const n=this.#t.getUint32(t);return this.#i.decode(new Uint8Array(this.#e,t+4,n))}get css(){return this.#n(0)}get loadedName(){return this.#n(1)}get baseFontName(){return this.#n(2)}get src(){return this.#n(3)}get style(){let e=1;e+=4+this.#t.getUint32(e);const t=this.#t.getUint32(e),n=this.#i.decode(new Uint8Array(this.#e,e+4,t));e+=4+t;const s=this.#t.getUint32(e),o=this.#i.decode(new Uint8Array(this.#e,e+4,s));return{style:n,weight:o}}}class Os{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#e=Math.ceil(this.bools.length*2/8);static#t=this.#e+this.numbers.length*8;static#i=this.#t+1+8;static#n=this.#i+1+48;static#a=this.#n+1+6;#r;#s;#o;constructor({data:e,extra:t}){this.#r=e,this.#s=new TextDecoder,this.#o=new DataView(this.#r),t&&Object.assign(this,t)}#c(e){Zi(e<Os.bools.length,"Invalid boolean index");const t=Math.floor(e/4),n=e*2%8,s=this.#o.getUint8(t)>>n&3;return s===0?void 0:s===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(e){return Zi(e<Os.numbers.length,"Invalid number index"),this.#o.getFloat64(Os.#e+e*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let e=Os.#t;if(this.#o.getUint8(e)===0)return;e+=1;const n=[];for(let s=0;s<4;s++)n.push(this.#o.getInt16(e,!0)),e+=2;return n}get fontMatrix(){let e=Os.#i;if(this.#o.getUint8(e)===0)return;e+=1;const n=[];for(let s=0;s<6;s++)n.push(this.#o.getFloat64(e,!0)),e+=8;return n}get defaultVMetrics(){let e=Os.#n;if(this.#o.getUint8(e)===0)return;e+=1;const n=[];for(let s=0;s<3;s++)n.push(this.#o.getInt16(e,!0)),e+=2;return n}#h(e){Zi(e<Os.strings.length,"Invalid string index");let t=Os.#a+4;for(let o=0;o<e;o++)t+=this.#o.getUint32(t)+4;const n=this.#o.getUint32(t),s=new Uint8Array(n);return s.set(new Uint8Array(this.#r,t+4,n)),this.#s.decode(s)}get fallbackName(){return this.#h(0)}get loadedName(){return this.#h(1)}get mimetype(){return this.#h(2)}get name(){return this.#h(3)}get data(){let e=Os.#a;const t=this.#o.getUint32(e);e+=4+t;const n=this.#o.getUint32(e);e+=4+n;const s=this.#o.getUint32(e);e+=4+s;const o=this.#o.getUint32(e);if(o!==0)return new Uint8Array(this.#r,e+4,o)}clearData(){let e=Os.#a;const t=this.#o.getUint32(e);e+=4+t;const n=this.#o.getUint32(e);e+=4+n;const s=this.#o.getUint32(e);e+=4+s;const o=this.#o.getUint32(e);new Uint8Array(this.#r,e+4,o).fill(0),this.#o.setUint32(e,0)}get cssFontInfo(){let e=Os.#a;const t=this.#o.getUint32(e);e+=4+t;const n=this.#o.getUint32(e);e+=4+n;const s=this.#o.getUint32(e);if(s===0)return null;const o=new Uint8Array(s);return o.set(new Uint8Array(this.#r,e+4,s)),new gf(o.buffer)}get systemFontInfo(){let e=Os.#a;const t=this.#o.getUint32(e);e+=4+t;const n=this.#o.getUint32(e);if(n===0)return null;const s=new Uint8Array(n);return s.set(new Uint8Array(this.#r,e+4,n)),new mf(s.buffer)}static write(e){const t=e.systemFontInfo?mf.write(e.systemFontInfo):null,n=e.cssFontInfo?gf.write(e.cssFontInfo):null,s=new TextEncoder,o={};let d=0;for(const x of Os.strings)o[x]=s.encode(e[x]),d+=4+o[x].length;const c=Os.#a+4+d+4+(t?t.byteLength:0)+4+(n?n.byteLength:0)+4+(e.data?e.data.length:0),h=new ArrayBuffer(c),f=new Uint8Array(h),m=new DataView(h);let b=0;const S=Os.bools.length;let v=0,P=0;for(let x=0;x<S;x++){const k=e[Os.bools[x]];v|=(k===void 0?0:k?2:1)<<P,P+=2,(P===8||x===S-1)&&(m.setUint8(b++,v),v=0,P=0)}Zi(b===Os.#e,"FontInfo.write: Boolean properties offset mismatch");for(const x of Os.numbers)m.setFloat64(b,e[x]),b+=8;if(Zi(b===Os.#t,"FontInfo.write: Number properties offset mismatch"),e.bbox){m.setUint8(b++,4);for(const x of e.bbox)m.setInt16(b,x,!0),b+=2}else m.setUint8(b++,0),b+=8;if(Zi(b===Os.#i,"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){m.setUint8(b++,6);for(const x of e.fontMatrix)m.setFloat64(b,x,!0),b+=8}else m.setUint8(b++,0),b+=48;if(Zi(b===Os.#n,"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){m.setUint8(b++,1);for(const x of e.defaultVMetrics)m.setInt16(b,x,!0),b+=2}else m.setUint8(b++,0),b+=6;Zi(b===Os.#a,"FontInfo.write: DefaultVMetrics properties offset mismatch"),m.setUint32(Os.#a,0),b+=4;for(const x of Os.strings){const k=o[x],N=k.length;m.setUint32(b,N),f.set(k,b+4),b+=4+N}if(m.setUint32(Os.#a,b-Os.#a-4),!t)m.setUint32(b,0),b+=4;else{const x=t.byteLength;m.setUint32(b,x),Zi(b+4+x<=h.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(t),b+4),b+=4+x}if(!n)m.setUint32(b,0),b+=4;else{const x=n.byteLength;m.setUint32(b,x),Zi(b+4+x<=h.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(n),b+4),b+=4+x}return e.data===void 0?(m.setUint32(b,0),b+=4):(m.setUint32(b,e.data.length),f.set(e.data,b+4),b+=4+e.data.length),Zi(b<=h.byteLength,"FontInfo.write: Buffer overflow"),h.transferToFixedLength(b)}}class ao{static#e=0;static#t=1;static#i=2;static#n=3;static#a=4;static#r=8;static#s=12;static#o=16;constructor(e){this.buffer=e,this.view=new DataView(e),this.data=new Uint8Array(e)}static write(e){let t,n=null,s=[],o=[],d=[],c=[],h=null,f=null;switch(e[0]){case"RadialAxial":t=e[1]==="axial"?1:2,n=e[2],d=e[3],t===1?s.push(...e[4],...e[5]):s.push(e[4][0],e[4][1],e[6],e[5][0],e[5][1],e[7]);break;case"Mesh":t=3,h=e[1],s=e[2],o=e[3],c=e[4]||[],n=e[6],f=e[7];break;default:throw new Error(`Unsupported pattern type: ${e[0]}`)}const m=Math.floor(s.length/2),b=Math.floor(o.length/3),S=d.length,v=c.length;let P=0;for(const B of c)P+=1,P=Math.ceil(P/4)*4,P+=4+B.coords.length*4,P+=4+B.colors.length*4,B.verticesPerRow!==void 0&&(P+=4);const x=20+m*8+b*3+S*8+(n?16:0)+(f?3:0)+P,k=new ArrayBuffer(x),N=new DataView(k),$=new Uint8Array(k);N.setUint8(ao.#e,t),N.setUint8(ao.#t,n?1:0),N.setUint8(ao.#i,f?1:0),N.setUint8(ao.#n,h),N.setUint32(ao.#a,m,!0),N.setUint32(ao.#r,b,!0),N.setUint32(ao.#s,S,!0),N.setUint32(ao.#o,v,!0);let I=20;new Float32Array(k,I,m*2).set(s),I+=m*8,$.set(o,I),I+=b*3;for(const[B,G]of d)N.setFloat32(I,B,!0),I+=4,N.setUint32(I,parseInt(G.slice(1),16),!0),I+=4;if(n)for(const B of n)N.setFloat32(I,B,!0),I+=4;f&&($.set(f,I),I+=3);for(let B=0;B<c.length;B++){const G=c[B];N.setUint8(I,G.type),I+=1,I=Math.ceil(I/4)*4,N.setUint32(I,G.coords.length,!0),I+=4,new Int32Array(k,I,G.coords.length).set(G.coords),I+=G.coords.length*4,N.setUint32(I,G.colors.length,!0),I+=4,new Int32Array(k,I,G.colors.length).set(G.colors),I+=G.colors.length*4,G.verticesPerRow!==void 0&&(N.setUint32(I,G.verticesPerRow,!0),I+=4)}return k}getIR(){const e=this.view,t=this.data[ao.#e],n=!!this.data[ao.#t],s=!!this.data[ao.#i],o=e.getUint32(ao.#a,!0),d=e.getUint32(ao.#r,!0),c=e.getUint32(ao.#s,!0),h=e.getUint32(ao.#o,!0);let f=20;const m=new Float32Array(this.buffer,f,o*2);f+=o*8;const b=new Uint8Array(this.buffer,f,d*3);f+=d*3;const S=[];for(let k=0;k<c;++k){const N=e.getFloat32(f,!0);f+=4;const $=e.getUint32(f,!0);f+=4,S.push([N,`#${$.toString(16).padStart(6,"0")}`])}let v=null;if(n){v=[];for(let k=0;k<4;++k)v.push(e.getFloat32(f,!0)),f+=4}let P=null;s&&(P=new Uint8Array(this.buffer,f,3),f+=3);const x=[];for(let k=0;k<h;++k){const N=e.getUint8(f);f+=1,f=Math.ceil(f/4)*4;const $=e.getUint32(f,!0);f+=4;const I=new Int32Array(this.buffer,f,$);f+=$*4;const z=e.getUint32(f,!0);f+=4;const B=new Int32Array(this.buffer,f,z);f+=z*4;const G={type:N,coords:I,colors:B};N===ey.LATTICE&&(G.verticesPerRow=e.getUint32(f,!0),f+=4),x.push(G)}if(t===1)return["RadialAxial","axial",v,S,Array.from(m.slice(0,2)),Array.from(m.slice(2,4)),null,null];if(t===2)return["RadialAxial","radial",v,S,[m[0],m[1]],[m[3],m[4]],m[2],m[5]];if(t===3){const k=this.data[ao.#n];let N=null;if(m.length>0){let $=m[0],I=m[0],z=m[1],B=m[1];for(let G=0;G<m.length;G+=2){const te=m[G],F=m[G+1];$=$>te?te:$,z=z>F?F:z,I=I<te?te:I,B=B<F?F:B}N=[$,z,I,B]}return["Mesh",k,m,b,x,N,v,P]}throw new Error(`Unsupported pattern kind: ${t}`)}}function Z3(r){if(r instanceof URL)return r.href;if(typeof r=="string"){if(bl)return r;const e=URL.parse(r,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function J3(r){if(bl&&typeof Buffer<"u"&&r instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength)return r;if(typeof r=="string")return Cp(r);if(r instanceof ArrayBuffer||ArrayBuffer.isView(r)||typeof r=="object"&&!isNaN(r?.length))return new Uint8Array(r);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Eg(r){if(typeof r!="string")return null;if(r.endsWith("/"))return r;throw new Error(`Invalid factory url: "${r}" must include trailing slash.`)}const ay=r=>typeof r=="object"&&Number.isInteger(r?.num)&&r.num>=0&&Number.isInteger(r?.gen)&&r.gen>=0,Q3=r=>typeof r=="object"&&typeof r?.name=="string",eC=L3.bind(null,ay,Q3);class tC{#e=new Map;#t=Promise.resolve();postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(const[s]of this.#e)s.call(this,n)})}addEventListener(e,t,n=null){let s=null;if(n?.signal instanceof AbortSignal){const{signal:o}=n;if(o.aborted){hi("LoopbackPort - cannot use an `aborted` signal.");return}const d=()=>this.removeEventListener(e,t);s=()=>o.removeEventListener("abort",d),o.addEventListener("abort",d)}this.#e.set(t,s)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(const[,e]of this.#e)e?.();this.#e.clear()}}const Rg={DATA:1,ERROR:2},ka={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Db(){}function Wl(r){if(r instanceof Mu||r instanceof ty||r instanceof Tb||r instanceof Qg||r instanceof Pm)return r;switch(r instanceof Error||typeof r=="object"&&r!==null||Xs('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),r.name){case"AbortException":return new Mu(r.message);case"InvalidPDFException":return new ty(r.message);case"PasswordException":return new Tb(r.message,r.code);case"ResponseException":return new Qg(r.message,r.status,r.missing);case"UnknownErrorException":return new Pm(r.message,r.details)}return new Pm(r.message,r.toString())}class dp{#e=new AbortController;constructor(e,t,n){this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#n(e);return}if(e.callback){const n=e.callbackId,s=this.callbackCapabilities[n];if(!s)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],e.callback===Rg.DATA)s.resolve(e.data);else if(e.callback===Rg.ERROR)s.reject(Wl(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const n=this.sourceName,s=e.sourceName,o=this.comObj;Promise.try(t,e.data).then(function(d){o.postMessage({sourceName:n,targetName:s,callback:Rg.DATA,callbackId:e.callbackId,data:d})},function(d){o.postMessage({sourceName:n,targetName:s,callback:Rg.ERROR,callbackId:e.callbackId,reason:Wl(d)})});return}if(e.streamId){this.#i(e);return}t(e.data)}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const s=this.callbackId++,o=Promise.withResolvers();this.callbackCapabilities[s]=o;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},n)}catch(d){o.reject(d)}return o.promise}sendWithStream(e,t,n,s){const o=this.streamId++,d=this.sourceName,c=this.targetName,h=this.comObj;return new ReadableStream({start:f=>{const m=Promise.withResolvers();return this.streamControllers[o]={controller:f,startCall:m,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:d,targetName:c,action:e,streamId:o,data:t,desiredSize:f.desiredSize},s),m.promise},pull:f=>{const m=Promise.withResolvers();return this.streamControllers[o].pullCall=m,h.postMessage({sourceName:d,targetName:c,stream:ka.PULL,streamId:o,desiredSize:f.desiredSize}),m.promise},cancel:f=>{Zi(f instanceof Error,"cancel must have a valid reason");const m=Promise.withResolvers();return this.streamControllers[o].cancelCall=m,this.streamControllers[o].isClosed=!0,h.postMessage({sourceName:d,targetName:c,stream:ka.CANCEL,streamId:o,reason:Wl(f)}),m.promise}},n)}#i(e){const t=e.streamId,n=this.sourceName,s=e.sourceName,o=this.comObj,d=this,c=this.actionHandler[e.action],h={enqueue(f,m=1,b){if(this.isCancelled)return;const S=this.desiredSize;this.desiredSize-=m,S>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),o.postMessage({sourceName:n,targetName:s,stream:ka.ENQUEUE,streamId:t,chunk:f},b)},close(){this.isCancelled||(this.isCancelled=!0,o.postMessage({sourceName:n,targetName:s,stream:ka.CLOSE,streamId:t}),delete d.streamSinks[t])},error(f){Zi(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,o.postMessage({sourceName:n,targetName:s,stream:ka.ERROR,streamId:t,reason:Wl(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[t]=h,Promise.try(c,e.data,h).then(function(){o.postMessage({sourceName:n,targetName:s,stream:ka.START_COMPLETE,streamId:t,success:!0})},function(f){o.postMessage({sourceName:n,targetName:s,stream:ka.START_COMPLETE,streamId:t,reason:Wl(f)})})}#n(e){const t=e.streamId,n=this.sourceName,s=e.sourceName,o=this.comObj,d=this.streamControllers[t],c=this.streamSinks[t];switch(e.stream){case ka.START_COMPLETE:e.success?d.startCall.resolve():d.startCall.reject(Wl(e.reason));break;case ka.PULL_COMPLETE:e.success?d.pullCall.resolve():d.pullCall.reject(Wl(e.reason));break;case ka.PULL:if(!c){o.postMessage({sourceName:n,targetName:s,stream:ka.PULL_COMPLETE,streamId:t,success:!0});break}c.desiredSize<=0&&e.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=e.desiredSize,Promise.try(c.onPull||Db).then(function(){o.postMessage({sourceName:n,targetName:s,stream:ka.PULL_COMPLETE,streamId:t,success:!0})},function(f){o.postMessage({sourceName:n,targetName:s,stream:ka.PULL_COMPLETE,streamId:t,reason:Wl(f)})});break;case ka.ENQUEUE:if(Zi(d,"enqueue should have stream controller"),d.isClosed)break;d.controller.enqueue(e.chunk);break;case ka.CLOSE:if(Zi(d,"close should have stream controller"),d.isClosed)break;d.isClosed=!0,d.controller.close(),this.#a(d,t);break;case ka.ERROR:Zi(d,"error should have stream controller"),d.controller.error(Wl(e.reason)),this.#a(d,t);break;case ka.CANCEL_COMPLETE:e.success?d.cancelCall.resolve():d.cancelCall.reject(Wl(e.reason)),this.#a(d,t);break;case ka.CANCEL:if(!c)break;const h=Wl(e.reason);Promise.try(c.onCancel||Db,h).then(function(){o.postMessage({sourceName:n,targetName:s,stream:ka.CANCEL_COMPLETE,streamId:t,success:!0})},function(f){o.postMessage({sourceName:n,targetName:s,stream:ka.CANCEL_COMPLETE,streamId:t,reason:Wl(f)})}),c.sinkCapability.reject(h),c.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#a(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#e?.abort(),this.#e=null}}class av{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Xs("Abstract method `_createCanvas` called.")}}class nC extends av{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class ov{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Xs("Abstract method `_fetch` called.")}}class Lb extends ov{async _fetch(e){const t=await Tp(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Cp(t)}}class lv{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,s,o){return"none"}destroy(e=!1){}}class iC extends lv{#e;#t;#i;#n;#a;#r;#s=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#n=e,this.#a=t}get#o(){return this.#t||=new Map}get#c(){return this.#r||=new Map}get#l(){if(!this.#i){const e=this.#a.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const n=this.#a.createElementNS($d,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#i=this.#a.createElementNS($d,"defs"),e.append(n),n.append(this.#i),this.#a.body.append(e)}return this.#i}#h(e){if(e.length===1){const h=e[0],f=new Array(256);for(let b=0;b<256;b++)f[b]=h[b]/255;const m=f.join(",");return[m,m,m]}const[t,n,s]=e,o=new Array(256),d=new Array(256),c=new Array(256);for(let h=0;h<256;h++)o[h]=t[h]/255,d[h]=n[h]/255,c[h]=s[h]/255;return[o.join(","),d.join(","),c.join(",")]}#u(e){if(this.#e===void 0){this.#e="";const t=this.#a.URL;t!==this.#a.baseURI&&(c0(t)?hi('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=K2(t,""))}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#o.get(e);if(t)return t;const[n,s,o]=this.#h(e),d=e.length===1?n:`${n}${s}${o}`;if(t=this.#o.get(d),t)return this.#o.set(e,t),t;const c=`g_${this.#n}_transfer_map_${this.#s++}`,h=this.#u(c);this.#o.set(e,h),this.#o.set(d,h);const f=this.#g(c);return this.#p(n,s,o,f),h}addHCMFilter(e,t){const n=`${e}-${t}`,s="base";let o=this.#c.get(s);if(o?.key===n||(o?(o.filter?.remove(),o.key=n,o.url="none",o.filter=null):(o={key:n,url:"none",filter:null},this.#c.set(s,o)),!e||!t))return o.url;const d=this.#b(e);e=fn.makeHexColor(...d);const c=this.#b(t);if(t=fn.makeHexColor(...c),this.#l.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return o.url;const h=new Array(256);for(let v=0;v<=255;v++){const P=v/255;h[v]=P<=.03928?P/12.92:((P+.055)/1.055)**2.4}const f=h.join(","),m=`g_${this.#n}_hcm_filter`,b=o.filter=this.#g(m);this.#p(f,f,f,b),this.#m(b);const S=(v,P)=>{const x=d[v]/255,k=c[v]/255,N=new Array(P+1);for(let $=0;$<=P;$++)N[$]=x+$/P*(k-x);return N.join(",")};return this.#p(S(0,5),S(1,5),S(2,5),b),o.url=this.#u(m),o.url}addAlphaFilter(e){let t=this.#o.get(e);if(t)return t;const[n]=this.#h([e]),s=`alpha_${n}`;if(t=this.#o.get(s),t)return this.#o.set(e,t),t;const o=`g_${this.#n}_alpha_map_${this.#s++}`,d=this.#u(o);this.#o.set(e,d),this.#o.set(s,d);const c=this.#g(o);return this.#y(n,c),d}addLuminosityFilter(e){let t=this.#o.get(e||"luminosity");if(t)return t;let n,s;if(e?([n]=this.#h([e]),s=`luminosity_${n}`):s="luminosity",t=this.#o.get(s),t)return this.#o.set(e,t),t;const o=`g_${this.#n}_luminosity_map_${this.#s++}`,d=this.#u(o);this.#o.set(e,d),this.#o.set(s,d);const c=this.#g(o);return this.#f(c),e&&this.#y(n,c),d}addHighlightHCMFilter(e,t,n,s,o){const d=`${t}-${n}-${s}-${o}`;let c=this.#c.get(e);if(c?.key===d||(c?(c.filter?.remove(),c.key=d,c.url="none",c.filter=null):(c={key:d,url:"none",filter:null},this.#c.set(e,c)),!t||!n))return c.url;const[h,f]=[t,n].map(this.#b.bind(this));let m=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),b=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[S,v]=[s,o].map(this.#b.bind(this));b<m&&([m,b,S,v]=[b,m,v,S]),this.#l.style.color="";const P=(N,$,I)=>{const z=new Array(256),B=(b-m)/I,G=N/255,te=($-N)/(255*I);let F=0;for(let H=0;H<=I;H++){const Q=Math.round(m+H*B),M=G+H*te;for(let T=F;T<=Q;T++)z[T]=M;F=Q+1}for(let H=F;H<256;H++)z[H]=z[F-1];return z.join(",")},x=`g_${this.#n}_hcm_${e}_filter`,k=c.filter=this.#g(x);return this.#m(k),this.#p(P(S[0],v[0],5),P(S[1],v[1],5),P(S[2],v[2],5),k),c.url=this.#u(x),c.url}destroy(e=!1){e&&this.#r?.size||(this.#i?.parentNode.parentNode.remove(),this.#i=null,this.#t?.clear(),this.#t=null,this.#r?.clear(),this.#r=null,this.#s=0)}#f(e){const t=this.#a.createElementNS($d,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#m(e){const t=this.#a.createElementNS($d,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#g(e){const t=this.#a.createElementNS($d,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#l.append(t),t}#d(e,t,n){const s=this.#a.createElementNS($d,t);s.setAttribute("type","discrete"),s.setAttribute("tableValues",n),e.append(s)}#p(e,t,n,s){const o=this.#a.createElementNS($d,"feComponentTransfer");s.append(o),this.#d(o,"feFuncR",e),this.#d(o,"feFuncG",t),this.#d(o,"feFuncB",n)}#y(e,t){const n=this.#a.createElementNS($d,"feComponentTransfer");t.append(n),this.#d(n,"feFuncA",e)}#b(e){return this.#l.style.color=e,kp(getComputedStyle(this.#l).getPropertyValue("color"))}}class cv{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Xs("Abstract method `_fetch` called.")}}class Mb extends cv{async _fetch(e){const t=await Tp(e,"arraybuffer");return new Uint8Array(t)}}class dv{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){Xs("Abstract method `_fetch` called.")}}class Ib extends dv{async _fetch(e){const t=await Tp(e,"arraybuffer");return new Uint8Array(t)}}bl&&hi("Please use the `legacy` build in Node.js environments.");async function _y(r){const t=await process.getBuiltinModule("fs").promises.readFile(r);return new Uint8Array(t)}class sC extends lv{}class rC extends av{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class aC extends ov{async _fetch(e){return _y(e)}}class oC extends cv{async _fetch(e){return _y(e)}}class lC extends dv{async _fetch(e){return _y(e)}}const ef="__forcedDependency",{floor:zb,ceil:Bb}=Math;function Dg(r,e,t,n,s,o){r[e*4+0]=Math.min(r[e*4+0],t),r[e*4+1]=Math.min(r[e*4+1],n),r[e*4+2]=Math.max(r[e*4+2],s),r[e*4+3]=Math.max(r[e*4+3],o)}const oy=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class cC{#e;#t;constructor(e,t){this.#e=e,this.#t=t}get length(){return this.#e.length}isEmpty(e){return this.#e[e]===oy}minX(e){return this.#t[e*4+0]/256}minY(e){return this.#t[e*4+1]/256}maxX(e){return(this.#t[e*4+2]+1)/256}maxY(e){return(this.#t[e*4+3]+1)/256}}const Lg=(r,e)=>{if(!r)return;let t=r.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},r.set(e,t)),t};class dC{#e={__proto__:null};#t={__proto__:null,transform:[],moveText:[],sameLineText:[],[ef]:[]};#i=new Map;#n=[];#a=[];#r=[[1,0,0,1,0,0]];#s=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#h=new Map;#u=new Map;#f;#m;#g;#d;#p;constructor(e,t,n=!1){this.#f=e.width,this.#m=e.height,this.#y(t),n&&(this.#p=new Map)}growOperationsCount(e){e>=this.#d.length&&this.#y(e,this.#d)}#y(e,t){const n=new ArrayBuffer(e*4);this.#g=new Uint8ClampedArray(n),this.#d=new Uint32Array(n),t&&t.length>0?(this.#d.set(t),this.#d.fill(oy,t.length)):this.#d.fill(oy)}save(e){return this.#e={__proto__:this.#e},this.#t={__proto__:this.#t,transform:{__proto__:this.#t.transform},moveText:{__proto__:this.#t.moveText},sameLineText:{__proto__:this.#t.sameLineText},[ef]:{__proto__:this.#t[ef]}},this.#s={__proto__:this.#s},this.#n.push(e),this}restore(e){const t=Object.getPrototypeOf(this.#e);if(t===null)return this;this.#e=t,this.#t=Object.getPrototypeOf(this.#t),this.#s=Object.getPrototypeOf(this.#s);const n=this.#n.pop();return n!==void 0&&(Lg(this.#p,e)?.dependencies.add(n),this.#d[e]=this.#d[n]),this}recordOpenMarker(e){return this.#n.push(e),this}getOpenMarker(){return this.#n.length===0?null:this.#n.at(-1)}recordCloseMarker(e){const t=this.#n.pop();return t!==void 0&&(Lg(this.#p,e)?.dependencies.add(t),this.#d[e]=this.#d[t]),this}beginMarkedContent(e){return this.#a.push(e),this}endMarkedContent(e){const t=this.#a.pop();return t!==void 0&&(Lg(this.#p,e)?.dependencies.add(t),this.#d[e]=this.#d[t]),this}pushBaseTransform(e){return this.#r.push(fn.multiplyByDOMMatrix(this.#r.at(-1),e.getTransform())),this}popBaseTransform(){return this.#r.length>1&&this.#r.pop(),this}recordSimpleData(e,t){return this.#e[e]=t,this}recordIncrementalData(e,t){return this.#t[e].push(t),this}resetIncrementalData(e,t){return this.#t[e].length=0,this}recordNamedData(e,t){return this.#i.set(e,t),this}recordSimpleDataFromNamed(e,t,n){this.#e[e]=this.#i.get(t)??n}recordFutureForcedDependency(e,t){return this.recordIncrementalData(ef,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in this.#e&&this.recordFutureForcedDependency(t,this.#e[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of this.#l)this.recordFutureForcedDependency(ef,e);return this}resetBBox(e){return this.#c!==e&&(this.#c=e,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(e,t,n,s,o,d){const c=fn.multiplyByDOMMatrix(this.#r.at(-1),t.getTransform()),h=[1/0,1/0,-1/0,-1/0];fn.axialAlignedBoundingBox([n,o,s,d],c,h);const f=fn.intersect(this.#s,h);return f?(this.#s[0]=f[0],this.#s[1]=f[1],this.#s[2]=f[2],this.#s[3]=f[3]):(this.#s[0]=this.#s[1]=1/0,this.#s[2]=this.#s[3]=-1/0),this}recordBBox(e,t,n,s,o,d){const c=this.#s;if(c[0]===1/0)return this;const h=fn.multiplyByDOMMatrix(this.#r.at(-1),t.getTransform());if(c[0]===-1/0)return fn.axialAlignedBoundingBox([n,o,s,d],h,this.#o),this;const f=[1/0,1/0,-1/0,-1/0];return fn.axialAlignedBoundingBox([n,o,s,d],h,f),this.#o[0]=Math.min(this.#o[0],Math.max(f[0],c[0])),this.#o[1]=Math.min(this.#o[1],Math.max(f[1],c[1])),this.#o[2]=Math.max(this.#o[2],Math.min(f[2],c[2])),this.#o[3]=Math.max(this.#o[3],Math.min(f[3],c[3])),this}recordCharacterBBox(e,t,n,s=1,o=0,d=0,c){const h=n.bbox;let f,m;if(h&&(f=h[2]!==h[0]&&h[3]!==h[1]&&this.#u.get(n),f!==!1&&(m=[0,0,0,0],fn.axialAlignedBoundingBox(h,n.fontMatrix,m),(s!==1||o!==0||d!==0)&&fn.scaleMinMax([s,0,0,-s,o,d],m),f)))return this.recordBBox(e,t,m[0],m[2],m[1],m[3]);if(!c)return this.recordFullPageBBox(e);const b=c();return h&&m&&f===void 0&&(f=m[0]<=o-b.actualBoundingBoxLeft&&m[2]>=o+b.actualBoundingBoxRight&&m[1]<=d-b.actualBoundingBoxAscent&&m[3]>=d+b.actualBoundingBoxDescent,this.#u.set(n,f),f)?this.recordBBox(e,t,m[0],m[2],m[1],m[3]):this.recordBBox(e,t,o-b.actualBoundingBoxLeft,o+b.actualBoundingBoxRight,d-b.actualBoundingBoxAscent,d+b.actualBoundingBoxDescent)}recordFullPageBBox(e){return this.#o[0]=Math.max(0,this.#s[0]),this.#o[1]=Math.max(0,this.#s[1]),this.#o[2]=Math.min(this.#f,this.#s[2]),this.#o[3]=Math.min(this.#m,this.#s[3]),this}getSimpleIndex(e){return this.#e[e]}recordDependencies(e,t){const n=this.#l,s=this.#e,o=this.#t;for(const d of t)d in this.#e?n.add(s[d]):d in o&&o[d].forEach(n.add,n);return this}recordNamedDependency(e,t){return this.#i.has(t)&&this.#l.add(this.#i.get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[ef]),this.#p){const n=Lg(this.#p,e),{dependencies:s}=n;this.#l.forEach(s.add,s),this.#n.forEach(s.add,s),this.#a.forEach(s.add,s),s.delete(e),n.isRenderingOperation=!0}if(this.#c===e){const n=zb(this.#o[0]*256/this.#f),s=zb(this.#o[1]*256/this.#m),o=Bb(this.#o[2]*256/this.#f),d=Bb(this.#o[3]*256/this.#m);Dg(this.#g,e,n,s,o,d);for(const c of this.#l)c!==e&&Dg(this.#g,c,n,s,o,d);for(const c of this.#n)c!==e&&Dg(this.#g,c,n,s,o,d);for(const c of this.#a)c!==e&&Dg(this.#g,c,n,s,o,d);t||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(e,t=!1){const n=Array.from(this.#l);this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const s of n)this.recordIncrementalData("sameLineText",s);return this}bboxToClipBoxDropOperation(e,t=!1){return this.#c===e&&(this.#c=-1,this.#s[0]=Math.max(this.#s[0],this.#o[0]),this.#s[1]=Math.max(this.#s[1],this.#o[1]),this.#s[2]=Math.min(this.#s[2],this.#o[2]),this.#s[3]=Math.min(this.#s[3],this.#o[3]),t||this.#l.clear()),this}_takePendingDependencies(){const e=this.#l;return this.#l=new Set,e}_extractOperation(e){const t=this.#h.get(e);return this.#h.delete(e),t}_pushPendingDependencies(e){for(const t of e)this.#l.add(t)}take(){return this.#u.clear(),new cC(this.#d,this.#g)}takeDebugMetadata(){return this.#p}}class e0{#e;#t;#i;#n=0;#a=0;constructor(e,t,n){if(e instanceof e0&&e.#i===!!n)return e;this.#e=e,this.#t=t,this.#i=!!n}growOperationsCount(){throw new Error("Unreachable")}save(e){return this.#a++,this.#e.save(this.#t),this}restore(e){return this.#a>0&&(this.#e.restore(this.#t),this.#a--),this}recordOpenMarker(e){return this.#n++,this}getOpenMarker(){return this.#n>0?this.#t:this.#e.getOpenMarker()}recordCloseMarker(e){return this.#n--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return this.#e.pushBaseTransform(e),this}popBaseTransform(){return this.#e.popBaseTransform(),this}recordSimpleData(e,t){return this.#e.recordSimpleData(e,this.#t),this}recordIncrementalData(e,t){return this.#e.recordIncrementalData(e,this.#t),this}resetIncrementalData(e,t){return this.#e.resetIncrementalData(e,this.#t),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,n){return this.#e.recordSimpleDataFromNamed(e,t,this.#t),this}recordFutureForcedDependency(e,t){return this.#e.recordFutureForcedDependency(e,this.#t),this}inheritSimpleDataAsFutureForcedDependencies(e){return this.#e.inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#e.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return this.#i||this.#e.resetBBox(this.#t),this}recordClipBox(e,t,n,s,o,d){return this.#i||this.#e.recordClipBox(this.#t,t,n,s,o,d),this}recordBBox(e,t,n,s,o,d){return this.#i||this.#e.recordBBox(this.#t,t,n,s,o,d),this}recordCharacterBBox(e,t,n,s,o,d,c){return this.#i||this.#e.recordCharacterBBox(this.#t,t,n,s,o,d,c),this}recordFullPageBBox(e){return this.#i||this.#e.recordFullPageBBox(this.#t),this}getSimpleIndex(e){return this.#e.getSimpleIndex(e)}recordDependencies(e,t){return this.#e.recordDependencies(this.#t,t),this}recordNamedDependency(e,t){return this.#e.recordNamedDependency(this.#t,t),this}recordOperation(e){return this.#e.recordOperation(this.#t,!0),this}recordShowTextOperation(e){return this.#e.recordShowTextOperation(this.#t,!0),this}bboxToClipBoxDropOperation(e){return this.#i||this.#e.bboxToClipBoxDropOperation(this.#t,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const zc={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},ko={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function ly(r,e){if(!e)return;const t=e[2]-e[0],n=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],t,n),r.clip(s)}class ky{isModifyingCurrentTransform(){return!1}getPattern(){Xs("Abstract method `getPattern` called.")}}class uC extends ky{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)t.addColorStop(n[0],n[1]);return t}getPattern(e,t,n,s){let o;if(s===ko.STROKE||s===ko.FILL){const d=t.current.getClippedPathBoundingBox(s,Mr(e))||[0,0,0,0],c=Math.ceil(d[2]-d[0])||1,h=Math.ceil(d[3]-d[1])||1,f=t.cachedCanvases.getCanvas("pattern",c,h),m=f.context;m.clearRect(0,0,m.canvas.width,m.canvas.height),m.beginPath(),m.rect(0,0,m.canvas.width,m.canvas.height),m.translate(-d[0],-d[1]),n=fn.transform(n,[1,0,0,1,d[0],d[1]]),m.transform(...t.baseTransform),this.matrix&&m.transform(...this.matrix),ly(m,this._bbox),m.fillStyle=this._createGradient(m),m.fill(),o=e.createPattern(f.canvas,"no-repeat");const b=new DOMMatrix(n);o.setTransform(b)}else ly(e,this._bbox),o=this._createGradient(e);return o}}function Dm(r,e,t,n,s,o,d,c){const h=e.coords,f=e.colors,m=r.data,b=r.width*4;let S;h[t+1]>h[n+1]&&(S=t,t=n,n=S,S=o,o=d,d=S),h[n+1]>h[s+1]&&(S=n,n=s,s=S,S=d,d=c,c=S),h[t+1]>h[n+1]&&(S=t,t=n,n=S,S=o,o=d,d=S);const v=(h[t]+e.offsetX)*e.scaleX,P=(h[t+1]+e.offsetY)*e.scaleY,x=(h[n]+e.offsetX)*e.scaleX,k=(h[n+1]+e.offsetY)*e.scaleY,N=(h[s]+e.offsetX)*e.scaleX,$=(h[s+1]+e.offsetY)*e.scaleY;if(P>=$)return;const I=f[o],z=f[o+1],B=f[o+2],G=f[d],te=f[d+1],F=f[d+2],H=f[c],Q=f[c+1],M=f[c+2],T=Math.round(P),R=Math.round($);let Z,se,V,ee,ae,Ce,xe,J;for(let D=T;D<=R;D++){if(D<k){const Pe=D<P?0:(P-D)/(P-k);Z=v-(v-x)*Pe,se=I-(I-G)*Pe,V=z-(z-te)*Pe,ee=B-(B-F)*Pe}else{let Pe;D>$?Pe=1:k===$?Pe=0:Pe=(k-D)/(k-$),Z=x-(x-N)*Pe,se=G-(G-H)*Pe,V=te-(te-Q)*Pe,ee=F-(F-M)*Pe}let W;D<P?W=0:D>$?W=1:W=(P-D)/(P-$),ae=v-(v-N)*W,Ce=I-(I-H)*W,xe=z-(z-Q)*W,J=B-(B-M)*W;const K=Math.round(Math.min(Z,ae)),ue=Math.round(Math.max(Z,ae));let Te=b*D+K*4;for(let Pe=K;Pe<=ue;Pe++)W=(Z-Pe)/(Z-ae),W<0?W=0:W>1&&(W=1),m[Te++]=se-(se-Ce)*W|0,m[Te++]=V-(V-xe)*W|0,m[Te++]=ee-(ee-J)*W|0,m[Te++]=255}}function hC(r,e,t){const n=e.coords,s=e.colors;let o,d;switch(e.type){case ey.LATTICE:const c=e.verticesPerRow,h=Math.floor(n.length/c)-1,f=c-1;for(o=0;o<h;o++){let m=o*c;for(let b=0;b<f;b++,m++)Dm(r,t,n[m],n[m+1],n[m+c],s[m],s[m+1],s[m+c]),Dm(r,t,n[m+c+1],n[m+1],n[m+c],s[m+c+1],s[m+1],s[m+c])}break;case ey.TRIANGLES:for(o=0,d=n.length;o<d;o+=3)Dm(r,t,n[o],n[o+1],n[o+2],s[o],s[o+1],s[o+2]);break;default:throw new Error("illegal figure")}}class fC extends ky{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,n){const c=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-c,m=Math.ceil(this._bounds[3])-h,b=Math.min(Math.ceil(Math.abs(f*e[0]*1.1)),3e3),S=Math.min(Math.ceil(Math.abs(m*e[1]*1.1)),3e3),v=f/b,P=m/S,x={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-h,scaleX:1/v,scaleY:1/P},k=b+4,N=S+4,$=n.getCanvas("mesh",k,N),I=$.context,z=I.createImageData(b,S);if(t){const G=z.data;for(let te=0,F=G.length;te<F;te+=4)G[te]=t[0],G[te+1]=t[1],G[te+2]=t[2],G[te+3]=255}for(const G of this._figures)hC(z,G,x);return I.putImageData(z,2,2),{canvas:$.canvas,offsetX:c-2*v,offsetY:h-2*P,scaleX:v,scaleY:P}}isModifyingCurrentTransform(){return!0}getPattern(e,t,n,s){ly(e,this._bbox);const o=new Float32Array(2);if(s===ko.SHADING)fn.singularValueDecompose2dScale(Mr(e),o);else if(this.matrix){fn.singularValueDecompose2dScale(this.matrix,o);const[c,h]=o;fn.singularValueDecompose2dScale(t.baseTransform,o),o[0]*=c,o[1]*=h}else fn.singularValueDecompose2dScale(t.baseTransform,o);const d=this._createMeshCanvas(o,s===ko.SHADING?null:this._background,t.cachedCanvases);return s!==ko.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(d.offsetX,d.offsetY),e.scale(d.scaleX,d.scaleY),e.createPattern(d.canvas,"no-repeat")}}class pC extends ky{getPattern(){return"hotpink"}}function gC(r){switch(r[0]){case"RadialAxial":return new uC(r);case"Mesh":return new fC(r);case"Dummy":return new pC}throw new Error(`Unknown IR type: ${r[0]}`)}const Ob={COLORED:1,UNCOLORED:2};class Ny{static MAX_PATTERN_SIZE=3e3;constructor(e,t,n,s){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=n,this.baseTransform=s}createPatternCanvas(e,t){const{bbox:n,operatorList:s,paintType:o,tilingType:d,color:c,canvasGraphicsFactory:h}=this;let{xstep:f,ystep:m}=this;f=Math.abs(f),m=Math.abs(m),l0("TilingType: "+d);const b=n[0],S=n[1],v=n[2],P=n[3],x=v-b,k=P-S,N=new Float32Array(2);fn.singularValueDecompose2dScale(this.matrix,N);const[$,I]=N;fn.singularValueDecompose2dScale(this.baseTransform,N);const z=$*N[0],B=I*N[1];let G=x,te=k,F=!1,H=!1;const Q=Math.ceil(f*z),M=Math.ceil(m*B),T=Math.ceil(x*z),R=Math.ceil(k*B);Q>=T?G=f:F=!0,M>=R?te=m:H=!0;const Z=this.getSizeAndScale(G,this.ctx.canvas.width,z),se=this.getSizeAndScale(te,this.ctx.canvas.height,B),V=e.cachedCanvases.getCanvas("pattern",Z.size,se.size),ee=V.context,ae=h.createCanvasGraphics(ee,t);if(ae.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(ae,o,c),ee.translate(-Z.scale*b,-se.scale*S),ae.transform(0,Z.scale,0,0,se.scale,0,0),ee.save(),ae.dependencyTracker?.save(),this.clipBbox(ae,b,S,v,P),ae.baseTransform=Mr(ae.ctx),ae.executeOperatorList(s),ae.endDrawing(),ae.dependencyTracker?.restore(),ee.restore(),F||H){const Ce=V.canvas;F&&(G=f),H&&(te=m);const xe=this.getSizeAndScale(G,this.ctx.canvas.width,z),J=this.getSizeAndScale(te,this.ctx.canvas.height,B),D=xe.size,W=J.size,K=e.cachedCanvases.getCanvas("pattern-workaround",D,W),ue=K.context,Te=F?Math.floor(x/f):0,Pe=H?Math.floor(k/m):0;for(let Ve=0;Ve<=Te;Ve++)for(let De=0;De<=Pe;De++)ue.drawImage(Ce,D*Ve,W*De,D,W,0,0,D,W);return{canvas:K.canvas,scaleX:xe.scale,scaleY:J.scale,offsetX:b,offsetY:S}}return{canvas:V.canvas,scaleX:Z.scale,scaleY:se.scale,offsetX:b,offsetY:S}}getSizeAndScale(e,t,n){const s=Math.max(Ny.MAX_PATTERN_SIZE,t);let o=Math.ceil(e*n);return o>=s?o=s:n=o/e,{scale:n,size:o}}clipBbox(e,t,n,s,o){const d=s-t,c=o-n;e.ctx.rect(t,n,d,c),fn.axialAlignedBoundingBox([t,n,s,o],Mr(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const s=e.ctx,o=e.current;switch(t){case Ob.COLORED:const{fillStyle:d,strokeStyle:c}=this.ctx;s.fillStyle=o.fillColor=d,s.strokeStyle=o.strokeColor=c;break;case Ob.UNCOLORED:s.fillStyle=s.strokeStyle=n,o.fillColor=o.strokeColor=n;break;default:throw new N3(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,n,s,o){let d=n;s!==ko.SHADING&&(d=fn.transform(d,t.baseTransform),this.matrix&&(d=fn.transform(d,this.matrix)));const c=this.createPatternCanvas(t,o);let h=new DOMMatrix(d);h=h.translate(c.offsetX,c.offsetY),h=h.scale(1/c.scaleX,1/c.scaleY);const f=e.createPattern(c.canvas,"repeat");return f.setTransform(h),f}}function mC({src:r,srcPos:e=0,dest:t,width:n,height:s,nonBlackColor:o=4294967295,inverseDecode:d=!1}){const c=No.isLittleEndian?4278190080:255,[h,f]=d?[o,c]:[c,o],m=n>>3,b=n&7,S=r.length;t=new Uint32Array(t.buffer);let v=0;for(let P=0;P<s;P++){for(const k=e+m;e<k;e++){const N=e<S?r[e]:255;t[v++]=N&128?f:h,t[v++]=N&64?f:h,t[v++]=N&32?f:h,t[v++]=N&16?f:h,t[v++]=N&8?f:h,t[v++]=N&4?f:h,t[v++]=N&2?f:h,t[v++]=N&1?f:h}if(b===0)continue;const x=e<S?r[e++]:255;for(let k=0;k<b;k++)t[v++]=x&1<<7-k?f:h}return{srcPos:e,destPos:v}}const Fb=16,Ub=100,yC=15,Hb=10,$l=16,Lm=new DOMMatrix,mc=new Float32Array(2),cf=new Float32Array([1/0,1/0,-1/0,-1/0]);function xC(r,e){if(r._removeMirroring)throw new Error("Context is already forwarding operations.");r.__originalSave=r.save,r.__originalRestore=r.restore,r.__originalRotate=r.rotate,r.__originalScale=r.scale,r.__originalTranslate=r.translate,r.__originalTransform=r.transform,r.__originalSetTransform=r.setTransform,r.__originalResetTransform=r.resetTransform,r.__originalClip=r.clip,r.__originalMoveTo=r.moveTo,r.__originalLineTo=r.lineTo,r.__originalBezierCurveTo=r.bezierCurveTo,r.__originalRect=r.rect,r.__originalClosePath=r.closePath,r.__originalBeginPath=r.beginPath,r._removeMirroring=()=>{r.save=r.__originalSave,r.restore=r.__originalRestore,r.rotate=r.__originalRotate,r.scale=r.__originalScale,r.translate=r.__originalTranslate,r.transform=r.__originalTransform,r.setTransform=r.__originalSetTransform,r.resetTransform=r.__originalResetTransform,r.clip=r.__originalClip,r.moveTo=r.__originalMoveTo,r.lineTo=r.__originalLineTo,r.bezierCurveTo=r.__originalBezierCurveTo,r.rect=r.__originalRect,r.closePath=r.__originalClosePath,r.beginPath=r.__originalBeginPath,delete r._removeMirroring},r.save=function(){e.save(),this.__originalSave()},r.restore=function(){e.restore(),this.__originalRestore()},r.translate=function(t,n){e.translate(t,n),this.__originalTranslate(t,n)},r.scale=function(t,n){e.scale(t,n),this.__originalScale(t,n)},r.transform=function(t,n,s,o,d,c){e.transform(t,n,s,o,d,c),this.__originalTransform(t,n,s,o,d,c)},r.setTransform=function(t,n,s,o,d,c){e.setTransform(t,n,s,o,d,c),this.__originalSetTransform(t,n,s,o,d,c)},r.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},r.rotate=function(t){e.rotate(t),this.__originalRotate(t)},r.clip=function(t){e.clip(t),this.__originalClip(t)},r.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},r.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},r.bezierCurveTo=function(t,n,s,o,d,c){e.bezierCurveTo(t,n,s,o,d,c),this.__originalBezierCurveTo(t,n,s,o,d,c)},r.rect=function(t,n,s,o){e.rect(t,n,s,o),this.__originalRect(t,n,s,o)},r.closePath=function(){e.closePath(),this.__originalClosePath()},r.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class bC{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let s;return this.cache[e]!==void 0?(s=this.cache[e],this.canvasFactory.reset(s,t,n)):(s=this.canvasFactory.create(t,n),this.cache[e]=s),s}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Mg(r,e,t,n,s,o,d,c,h,f){const[m,b,S,v,P,x]=Mr(r);if(b===0&&S===0){const $=d*m+P,I=Math.round($),z=c*v+x,B=Math.round(z),G=(d+h)*m+P,te=Math.abs(Math.round(G)-I)||1,F=(c+f)*v+x,H=Math.abs(Math.round(F)-B)||1;return r.setTransform(Math.sign(m),0,0,Math.sign(v),I,B),r.drawImage(e,t,n,s,o,0,0,te,H),r.setTransform(m,b,S,v,P,x),[te,H]}if(m===0&&v===0){const $=c*S+P,I=Math.round($),z=d*b+x,B=Math.round(z),G=(c+f)*S+P,te=Math.abs(Math.round(G)-I)||1,F=(d+h)*b+x,H=Math.abs(Math.round(F)-B)||1;return r.setTransform(0,Math.sign(b),Math.sign(S),0,I,B),r.drawImage(e,t,n,s,o,0,0,H,te),r.setTransform(m,b,S,v,P,x),[H,te]}r.drawImage(e,t,n,s,o,d,c,h,f);const k=Math.hypot(m,b),N=Math.hypot(S,v);return[k*h,N*f]}class qb{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Qm;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=To.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(e,t,n){n?.(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=cf.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=ko.FILL,t=null){const n=this.minMax.slice();if(e===ko.STROKE){t||Xs("Stroke bounding box must include transform."),fn.singularValueDecompose2dScale(t,mc);const s=mc[0]*this.lineWidth/2,o=mc[1]*this.lineWidth/2;n[0]-=s,n[1]-=o,n[2]+=s,n[3]+=o}return n}updateClipFromPath(){const e=fn.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(cf,0)}getClippedPathBoundingBox(e=ko.FILL,t=null){return fn.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function Vb(r,e){if(e instanceof ImageData){r.putImageData(e,0,0);return}const t=e.height,n=e.width,s=t%$l,o=(t-s)/$l,d=s===0?o:o+1,c=r.createImageData(n,$l);let h=0,f;const m=e.data,b=c.data;let S,v,P,x;if(e.kind===Wg.GRAYSCALE_1BPP){const k=m.byteLength,N=new Uint32Array(b.buffer,0,b.byteLength>>2),$=N.length,I=n+7>>3,z=4294967295,B=No.isLittleEndian?4278190080:255;for(S=0;S<d;S++){for(P=S<o?$l:s,f=0,v=0;v<P;v++){const G=k-h;let te=0;const F=G>I?n:G*8-7,H=F&-8;let Q=0,M=0;for(;te<H;te+=8)M=m[h++],N[f++]=M&128?z:B,N[f++]=M&64?z:B,N[f++]=M&32?z:B,N[f++]=M&16?z:B,N[f++]=M&8?z:B,N[f++]=M&4?z:B,N[f++]=M&2?z:B,N[f++]=M&1?z:B;for(;te<F;te++)Q===0&&(M=m[h++],Q=128),N[f++]=M&Q?z:B,Q>>=1}for(;f<$;)N[f++]=0;r.putImageData(c,0,S*$l)}}else if(e.kind===Wg.RGBA_32BPP){for(v=0,x=n*$l*4,S=0;S<o;S++)b.set(m.subarray(h,h+x)),h+=x,r.putImageData(c,0,v),v+=$l;S<d&&(x=n*s*4,b.set(m.subarray(h,h+x)),r.putImageData(c,0,v))}else if(e.kind===Wg.RGB_24BPP)for(P=$l,x=n*P,S=0;S<d;S++){for(S>=o&&(P=s,x=n*P),f=0,v=x;v--;)b[f++]=m[h++],b[f++]=m[h++],b[f++]=m[h++],b[f++]=255;r.putImageData(c,0,S*$l)}else throw new Error(`bad image kind: ${e.kind}`)}function Wb(r,e){if(e.bitmap){r.drawImage(e.bitmap,0,0);return}const t=e.height,n=e.width,s=t%$l,o=(t-s)/$l,d=s===0?o:o+1,c=r.createImageData(n,$l);let h=0;const f=e.data,m=c.data;for(let b=0;b<d;b++){const S=b<o?$l:s;({srcPos:h}=mC({src:f,srcPos:h,dest:m,width:n,height:S,nonBlackColor:0})),r.putImageData(c,0,b*$l)}}function sp(r,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of t)r[n]!==void 0&&(e[n]=r[n]);r.setLineDash!==void 0&&(e.setLineDash(r.getLineDash()),e.lineDashOffset=r.lineDashOffset)}function Ig(r){r.strokeStyle=r.fillStyle="#000000",r.fillRule="nonzero",r.globalAlpha=1,r.lineWidth=1,r.lineCap="butt",r.lineJoin="miter",r.miterLimit=10,r.globalCompositeOperation="source-over",r.font="10px sans-serif",r.setLineDash!==void 0&&(r.setLineDash([]),r.lineDashOffset=0);const{filter:e}=r;e!=="none"&&e!==""&&(r.filter="none")}function $b(r,e){if(e)return!0;fn.singularValueDecompose2dScale(r,mc);const t=Math.fround(kd.pixelRatio*vf.PDF_TO_CSS_UNITS);return mc[0]<=t&&mc[1]<=t}const vC=["butt","round","square"],wC=["miter","round","bevel"],SC={},Gb={};class yf{constructor(e,t,n,s,o,{optionalContentConfig:d,markedContentStack:c=null},h,f,m){this.ctx=e,this.current=new qb(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=s,this.filterFactory=o,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=d,this.cachedCanvases=new bC(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=m??null}getObject(e,t,n=null){return typeof t=="string"?(this.dependencyTracker?.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):n}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:s=null}){const o=this.ctx.canvas.width,d=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,o,d),this.ctx.fillStyle=c,n){const h=this.cachedCanvases.getCanvas("transparent",o,d);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...Mr(this.compositeCtx))}this.ctx.save(),Ig(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Mr(this.ctx)}executeOperatorList(e,t,n,s,o){const d=e.argsArray,c=e.fnArray;let h=t||0;const f=d.length;if(f===h)return h;const m=f-h>Hb&&typeof n=="function",b=m?Date.now()+yC:0;let S=0;const v=this.commonObjs,P=this.objs;let x,k;for(;;){if(s!==void 0&&h===s.nextBreakPoint)return s.breakIt(h,n),h;if(!o||o(h))if(x=c[h],k=d[h]??null,x!==xp.dependency)k===null?this[x](h):this[x](h,...k);else for(const N of k){this.dependencyTracker?.recordNamedData(N,h);const $=N.startsWith("g_")?v:P;if(!$.has(N))return $.get(N,n),h}if(h++,h===f)return h;if(m&&++S>Hb){if(Date.now()>b)return n(),h;S=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const n=e.width??e.displayWidth,s=e.height??e.displayHeight;let o=Math.max(Math.hypot(t[0],t[1]),1),d=Math.max(Math.hypot(t[2],t[3]),1),c=n,h=s,f="prescale1",m,b;for(;o>2&&c>1||d>2&&h>1;){let S=c,v=h;o>2&&c>1&&(S=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),o/=c/S),d>2&&h>1&&(v=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,d/=h/v),m=this.cachedCanvases.getCanvas(f,S,v),b=m.context,b.clearRect(0,0,S,v),b.drawImage(e,0,0,c,h,0,0,S,v),e=m.canvas,c=S,h=v,f=f==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:c,paintHeight:h}}_createMaskCanvas(e,t){const n=this.ctx,{width:s,height:o}=t,d=this.current.fillColor,c=this.current.patternFill,h=Mr(n);let f,m,b,S;if((t.bitmap||t.data)&&t.count>1){const Q=t.bitmap||t.data.buffer;m=JSON.stringify(c?h:[h.slice(0,4),d]),f=this._cachedBitmapsMap.get(Q),f||(f=new Map,this._cachedBitmapsMap.set(Q,f));const M=f.get(m);if(M&&!c){const T=Math.round(Math.min(h[0],h[2])+h[4]),R=Math.round(Math.min(h[1],h[3])+h[5]);return this.dependencyTracker?.recordDependencies(e,zc.transformAndFill),{canvas:M,offsetX:T,offsetY:R}}b=M}b||(S=this.cachedCanvases.getCanvas("maskCanvas",s,o),Wb(S.context,t));let v=fn.transform(h,[1/s,0,0,-1/o,0,0]);v=fn.transform(v,[1,0,0,1,0,-o]);const P=cf.slice();fn.axialAlignedBoundingBox([0,0,s,o],v,P);const[x,k,N,$]=P,I=Math.round(N-x)||1,z=Math.round($-k)||1,B=this.cachedCanvases.getCanvas("fillCanvas",I,z),G=B.context,te=x,F=k;G.translate(-te,-F),G.transform(...v),b||(b=this._scaleImage(S.canvas,vd(G)),b=b.img,f&&c&&f.set(m,b)),G.imageSmoothingEnabled=$b(Mr(G),t.interpolate),Mg(G,b,0,0,b.width,b.height,0,0,s,o),G.globalCompositeOperation="source-in";const H=fn.transform(vd(G),[1,0,0,1,-te,-F]);return G.fillStyle=c?d.getPattern(n,this,H,ko.FILL,e):d,G.fillRect(0,0,s,o),f&&!c&&(this.cachedCanvases.delete("fillCanvas"),f.set(m,B.canvas)),this.dependencyTracker?.recordDependencies(e,zc.transformAndFill),{canvas:B.canvas,offsetX:Math.round(te),offsetY:Math.round(F)}}setLineWidth(e,t){this.dependencyTracker?.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){this.dependencyTracker?.recordSimpleData("lineCap",e),this.ctx.lineCap=vC[t]}setLineJoin(e,t){this.dependencyTracker?.recordSimpleData("lineJoin",e),this.ctx.lineJoin=wC[t]}setMiterLimit(e,t){this.dependencyTracker?.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,n){this.dependencyTracker?.recordSimpleData("dash",e);const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(t),s.lineDashOffset=n)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){for(const[n,s]of t)switch(n){case"LW":this.setLineWidth(e,s);break;case"LC":this.setLineCap(e,s);break;case"LJ":this.setLineJoin(e,s);break;case"ML":this.setMiterLimit(e,s);break;case"D":this.setDash(e,s[0],s[1]);break;case"RI":this.setRenderingIntent(e,s);break;case"FL":this.setFlatness(e,s);break;case"Font":this.setFont(e,s[0],s[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=s;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=s;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=s;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",e),this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,n=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,o=this.cachedCanvases.getCanvas(s,t,n);this.suspendedCtx=this.ctx;const d=this.ctx=o.context;d.setTransform(this.suspendedCtx.getTransform()),sp(this.suspendedCtx,d),xC(d,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),sp(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,s){const o=s[0],d=s[1],c=s[2]-o,h=s[3]-d;c===0||h===0||(this.genericComposeSMask(t.context,n,c,h,t.subtype,t.backdrop,t.transferMap,o,d,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,s,o,d,c,h,f,m,b){let S=e.canvas,v=h-m,P=f-b;if(d)if(v<0||P<0||v+n>S.width||P+s>S.height){const k=this.cachedCanvases.getCanvas("maskExtension",n,s),N=k.context;N.drawImage(S,-v,-P),N.globalCompositeOperation="destination-atop",N.fillStyle=d,N.fillRect(0,0,n,s),N.globalCompositeOperation="source-over",S=k.canvas,v=P=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const k=new Path2D;k.rect(v,P,n,s),e.clip(k),e.globalCompositeOperation="destination-atop",e.fillStyle=d,e.fillRect(v,P,n,s),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),o==="Alpha"&&c?t.filter=this.filterFactory.addAlphaFilter(c):o==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(c));const x=new Path2D;x.rect(h,f,n,s),t.clip(x),t.globalCompositeOperation="destination-in",t.drawImage(S,v,P,n,s,h,f,n,s),t.restore()}save(e){this.inSMaskMode&&sp(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),this.dependencyTracker?.save(e)}restore(e){if(this.dependencyTracker?.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&sp(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,n,s,o,d,c){this.dependencyTracker?.recordIncrementalData("transform",e),this.ctx.transform(t,n,s,o,d,c),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n,s){let[o]=n;if(!s){o||=n[0]=new Path2D,this[t](e,o);return}if(this.dependencyTracker!==null){const d=t===xp.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,s[0]-d,s[2]+d,s[1]-d,s[3]+d).recordDependencies(e,["transform"])}o instanceof Path2D||(o=n[0]=nv(o)),fn.axialAlignedBoundingBox(s,Mr(this.ctx),this.current.minMax),this[t](e,o),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,n=!0){const s=this.ctx,o=this.current.strokeColor;if(s.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof o=="object"&&o?.getPattern){const d=o.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.strokeStyle=o.getPattern(s,this,vd(s),ko.STROKE,e),d){const c=new Path2D;c.addPath(t,s.getTransform().invertSelf().multiplySelf(d)),t=c}this.rescaleAndStroke(t,!1),s.restore()}else this.rescaleAndStroke(t,!0);this.dependencyTracker?.recordDependencies(e,zc.stroke),n&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(ko.STROKE,Mr(this.ctx))),s.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,n=!0){const s=this.ctx,o=this.current.fillColor,d=this.current.patternFill;let c=!1;if(d){const f=o.isModifyingCurrentTransform()?s.getTransform():null;if(this.dependencyTracker?.save(e),s.save(),s.fillStyle=o.getPattern(s,this,vd(s),ko.FILL,e),f){const m=new Path2D;m.addPath(t,s.getTransform().invertSelf().multiplySelf(f)),t=m}c=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(s.fill(t,"evenodd"),this.pendingEOFill=!1):s.fill(t)),this.dependencyTracker?.recordDependencies(e,zc.fill),c&&(s.restore(),this.dependencyTracker?.restore(e)),n&&this.consumePath(e,t,h)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){this.ctx.fill(t),this.dependencyTracker?.recordDependencies(e,zc.rawFillPath).recordOperation(e)}clip(e){this.dependencyTracker?.recordFutureForcedDependency("clipMode",e),this.pendingClip=SC}eoClip(e){this.dependencyTracker?.recordFutureForcedDependency("clipMode",e),this.pendingClip=Gb}beginText(e){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,n=this.ctx;if(this.dependencyTracker){const{dependencyTracker:s}=this;t!==void 0&&s.recordFutureForcedDependency("textClip",s.getOpenMarker()).recordFutureForcedDependency("textClip",e),s.recordCloseMarker(e)}if(t!==void 0){const s=new Path2D,o=n.getTransform().invertSelf();for(const{transform:d,x:c,y:h,fontSize:f,path:m}of t)m&&s.addPath(m,new DOMMatrix(d).preMultiplySelf(o).translate(c,h).scale(f,-f));n.clip(s)}delete this.pendingTextPaths}setCharSpacing(e,t){this.dependencyTracker?.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){this.dependencyTracker?.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){this.dependencyTracker?.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){this.dependencyTracker?.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,n){this.dependencyTracker?.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const s=this.commonObjs.get(t),o=this.current;if(!s)throw new Error(`Can't find font for ${t}`);if(o.fontMatrix=s.fontMatrix||Qm,(o.fontMatrix[0]===0||o.fontMatrix[3]===0)&&hi("Invalid font matrix for font "+t),n<0?(n=-n,o.fontDirection=-1):o.fontDirection=1,this.current.font=s,this.current.fontSize=n,s.isType3Font)return;const d=s.loadedName||"sans-serif",c=s.systemFontInfo?.css||`"${d}", ${s.fallbackName}`;let h="normal";s.black?h="900":s.bold&&(h="bold");const f=s.italic?"italic":"normal";let m=n;n<Fb?m=Fb:n>Ub&&(m=Ub),this.current.fontSizeScale=n/m,this.ctx.font=`${f} ${h} ${m}px ${c}`}setTextRenderingMode(e,t){this.dependencyTracker?.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){this.dependencyTracker?.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,n){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=n}setLeadingMoveText(e,t,n){this.setLeading(e,-n),this.moveText(e,t,n)}setTextMatrix(e,t){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",e);const{current:n}=this;n.textMatrix=t,n.textMatrixScale=Math.hypot(t[0],t[1]),n.x=n.lineX=0,n.y=n.lineY=0}nextLine(e){this.moveText(e,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}#i(e,t,n){const s=new Path2D;return s.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),s}paintChar(e,t,n,s,o,d){const c=this.ctx,h=this.current,f=h.font,m=h.textRenderingMode,b=h.fontSize/h.fontSizeScale,S=m&To.FILL_STROKE_MASK,v=!!(m&To.ADD_TO_PATH_FLAG),P=h.patternFill&&!f.missingFile,x=h.patternStroke&&!f.missingFile;let k;if((f.disableFontFace||v||P||x)&&!f.missingFile&&(k=f.getPathGenerator(this.commonObjs,t)),k&&(f.disableFontFace||P||x)){c.save(),c.translate(n,s),c.scale(b,-b),this.dependencyTracker?.recordCharacterBBox(e,c,f);let N;if(S===To.FILL||S===To.FILL_STROKE)if(o){N=c.getTransform(),c.setTransform(...o);const $=this.#i(k,N,o);c.fill($)}else c.fill(k);if(S===To.STROKE||S===To.FILL_STROKE)if(d){N||=c.getTransform(),c.setTransform(...d);const{a:$,b:I,c:z,d:B}=N,G=fn.inverseTransform(d),te=fn.transform([$,I,z,B,0,0],G);fn.singularValueDecompose2dScale(te,mc),c.lineWidth*=Math.max(mc[0],mc[1])/b,c.stroke(this.#i(k,N,d))}else c.lineWidth/=b,c.stroke(k);c.restore()}else(S===To.FILL||S===To.FILL_STROKE)&&(c.fillText(t,n,s),this.dependencyTracker?.recordCharacterBBox(e,c,f,b,n,s,()=>c.measureText(t))),(S===To.STROKE||S===To.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(e,c,f,b,n,s,()=>c.measureText(t)).recordDependencies(e,zc.stroke),c.strokeText(t,n,s));v&&((this.pendingTextPaths||=[]).push({transform:Mr(c),x:n,y:s,fontSize:b,path:k}),this.dependencyTracker?.recordCharacterBBox(e,c,f,b,n,s))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let s=3;s<t.length;s+=4)if(t[s]>0&&t[s]<255){n=!0;break}return fi(this,"isFontSubpixelAAEnabled",n)}showText(e,t){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,zc.showText).resetBBox(e),this.current.textRenderingMode&To.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const n=this.current,s=n.font;if(s.isType3Font){this.showType3Text(e,t),this.dependencyTracker?.recordShowTextOperation(e);return}const o=n.fontSize;if(o===0){this.dependencyTracker?.recordOperation(e);return}const d=this.ctx,c=n.fontSizeScale,h=n.charSpacing,f=n.wordSpacing,m=n.fontDirection,b=n.textHScale*m,S=t.length,v=s.vertical,P=v?1:-1,x=s.defaultVMetrics,k=o*n.fontMatrix[0],N=n.textRenderingMode===To.FILL&&!s.disableFontFace&&!n.patternFill;d.save(),n.textMatrix&&d.transform(...n.textMatrix),d.translate(n.x,n.y+n.textRise),m>0?d.scale(b,-1):d.scale(b,1);let $,I;if(n.patternFill){d.save();const F=n.fillColor.getPattern(d,this,vd(d),ko.FILL,e);$=Mr(d),d.restore(),d.fillStyle=F}if(n.patternStroke){d.save();const F=n.strokeColor.getPattern(d,this,vd(d),ko.STROKE,e);I=Mr(d),d.restore(),d.strokeStyle=F}let z=n.lineWidth;const B=n.textMatrixScale;if(B===0||z===0){const F=n.textRenderingMode&To.FILL_STROKE_MASK;(F===To.STROKE||F===To.FILL_STROKE)&&(z=this.getSinglePixelWidth())}else z/=B;if(c!==1&&(d.scale(c,c),z/=c),d.lineWidth=z,s.isInvalidPDFjsFont){const F=[];let H=0;for(const M of t)F.push(M.unicode),H+=M.width;const Q=F.join("");if(d.fillText(Q,0,0),this.dependencyTracker!==null){const M=d.measureText(Q);this.dependencyTracker.recordBBox(e,this.ctx,-M.actualBoundingBoxLeft,M.actualBoundingBoxRight,-M.actualBoundingBoxAscent,M.actualBoundingBoxDescent).recordShowTextOperation(e)}n.x+=H*k*b,d.restore(),this.compose();return}let G=0,te;for(te=0;te<S;++te){const F=t[te];if(typeof F=="number"){G+=P*F*o/1e3;continue}let H=!1;const Q=(F.isSpace?f:0)+h,M=F.fontChar,T=F.accent;let R,Z,se=F.width;if(v){const ae=F.vmetric||x,Ce=-(F.vmetric?ae[1]:se*.5)*k,xe=ae[2]*k;se=ae?-ae[0]:se,R=Ce/c,Z=(G+xe)/c}else R=G/c,Z=0;let V;if(s.remeasure&&se>0){V=d.measureText(M);const ae=V.width*1e3/o*c;if(se<ae&&this.isFontSubpixelAAEnabled){const Ce=se/ae;H=!0,d.save(),d.scale(Ce,1),R/=Ce}else se!==ae&&(R+=(se-ae)/2e3*o/c)}if(this.contentVisible&&(F.isInFont||s.missingFile)){if(N&&!T)d.fillText(M,R,Z),this.dependencyTracker?.recordCharacterBBox(e,d,V?{bbox:null}:s,o/c,R,Z,()=>V??d.measureText(M));else if(this.paintChar(e,M,R,Z,$,I),T){const ae=R+o*T.offset.x/c,Ce=Z-o*T.offset.y/c;this.paintChar(e,T.fontChar,ae,Ce,$,I)}}const ee=v?se*k-Q*m:se*k+Q*m;G+=ee,H&&d.restore()}v?n.y-=G:n.x+=G*b,d.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(e)}showType3Text(e,t){const n=this.ctx,s=this.current,o=s.font,d=s.fontSize,c=s.fontDirection,h=o.vertical?1:-1,f=s.charSpacing,m=s.wordSpacing,b=s.textHScale*c,S=s.fontMatrix||Qm,v=t.length,P=s.textRenderingMode===To.INVISIBLE;let x,k,N,$;if(P||d===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),s.textMatrix&&n.transform(...s.textMatrix),n.translate(s.x,s.y+s.textRise),n.scale(b,c);const I=this.dependencyTracker;for(this.dependencyTracker=I?new e0(I,e):null,x=0;x<v;++x){if(k=t[x],typeof k=="number"){$=h*k*d/1e3,this.ctx.translate($,0),s.x+=$*b;continue}const z=(k.isSpace?m:0)+f,B=o.charProcOperatorList[k.operatorListId];B?this.contentVisible&&(this.save(),n.scale(d,d),n.transform(...S),this.executeOperatorList(B),this.restore()):hi(`Type3 character "${k.operatorListId}" is not available.`);const G=[k.width,0];fn.applyTransform(G,S),N=G[0]*d+z,n.translate(N,0),s.x+=N*b}n.restore(),I&&(this.dependencyTracker=I)}setCharWidth(e,t,n){}setCharWidthAndBounds(e,t,n,s,o,d,c){const h=new Path2D;h.rect(s,o,d-s,c-o),this.ctx.clip(h),this.dependencyTracker?.recordBBox(e,this.ctx,s,d,o,c).recordClipBox(e,this.ctx,s,d,o,c),this.endPath(e)}getColorN_Pattern(e,t){let n;if(t[0]==="TilingPattern"){const s=this.baseTransform||Mr(this.ctx),o={createCanvasGraphics:(d,c)=>new yf(d,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new e0(this.dependencyTracker,c,!0):null)};n=new Ny(t,this.ctx,o,s)}else n=this._getPattern(e,t[1],t[2]);return n}setStrokeColorN(e,...t){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){this.dependencyTracker?.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){this.dependencyTracker?.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){this.dependencyTracker?.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,n=null){let s;return this.cachedPatterns.has(t)?s=this.cachedPatterns.get(t):(s=gC(this.getObject(e,t)),this.cachedPatterns.set(t,s)),n&&(s.matrix=n),s}shadingFill(e,t){if(!this.contentVisible)return;const n=this.ctx;this.save(e);const s=this._getPattern(e,t);n.fillStyle=s.getPattern(n,this,vd(n),ko.SHADING,e);const o=vd(n);if(o){const{width:d,height:c}=n.canvas,h=cf.slice();fn.axialAlignedBoundingBox([0,0,d,c],o,h);const[f,m,b,S]=h;this.ctx.fillRect(f,m,b-f,S-m)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,zc.transform).recordDependencies(e,zc.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){Xs("Should not call beginInlineImage")}beginImageData(){Xs("Should not call beginImageData")}paintFormXObjectBegin(e,t,n){if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=Mr(this.ctx),n)){fn.axialAlignedBoundingBox(n,this.baseTransform,this.current.minMax);const[s,o,d,c]=n,h=new Path2D;h.rect(s,o,d-s,c-o),this.ctx.clip(h),this.dependencyTracker?.recordClipBox(e,this.ctx,s,d,o,c),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;t.isolated||l0("TODO: Support non-isolated groups."),t.knockout&&hi("Knockout groups not supported.");const s=Mr(n);if(t.matrix&&n.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let o=cf.slice();fn.axialAlignedBoundingBox(t.bbox,Mr(n),o);const d=[0,0,n.canvas.width,n.canvas.height];o=fn.intersect(o,d)||[0,0,0,0];const c=Math.floor(o[0]),h=Math.floor(o[1]),f=Math.max(Math.ceil(o[2])-c,1),m=Math.max(Math.ceil(o[3])-h,1);this.current.startNewPathAndClipBox([0,0,f,m]);let b="groupAt"+this.groupLevel;t.smask&&(b+="_smask_"+this.smaskCounter++%2);const S=this.cachedCanvases.getCanvas(b,f,m),v=S.context;v.translate(-c,-h),v.transform(...s);let P=new Path2D;const[x,k,N,$]=t.bbox;if(P.rect(x,k,N-x,$-k),t.matrix){const I=new Path2D;I.addPath(P,new DOMMatrix(t.matrix)),P=I}v.clip(P),t.smask&&this.smaskStack.push({canvas:S.canvas,context:v,offsetX:c,offsetY:h,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(n.setTransform(1,0,0,1,0,0),n.translate(c,h),n.save()),sp(n,v),this.ctx=v,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(n),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(e,t){if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const o=Mr(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...o);const d=cf.slice();fn.axialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],o,d),this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(d)}}beginAnnotation(e,t,n,s,o,d){if(this.#e(),Ig(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){const c=n[2]-n[0],h=n[3]-n[1];if(d&&this.annotationCanvasMap){s=s.slice(),s[4]-=n[0],s[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=c,n[3]=h,fn.singularValueDecompose2dScale(Mr(this.ctx),mc);const{viewportScale:f}=this,m=Math.ceil(c*this.outputScaleX*f),b=Math.ceil(h*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(m,b);const{canvas:S,context:v}=this.annotationCanvas;this.annotationCanvasMap.set(t,S),this.annotationCanvas.savedCtx=this.ctx,this.ctx=v,this.ctx.save(),this.ctx.setTransform(mc[0],0,0,-mc[1],0,h*mc[1]),Ig(this.ctx)}else{Ig(this.ctx),this.endPath(e);const f=new Path2D;f.rect(n[0],n[1],c,h),this.ctx.clip(f)}}this.current=new qb(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...s),this.transform(e,...o)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){if(!this.contentVisible)return;const n=t.count;t=this.getObject(e,t.data,t),t.count=n;const s=this.ctx,o=this._createMaskCanvas(e,t),d=o.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(d,o.offsetX,o.offsetY),this.dependencyTracker?.resetBBox(e).recordBBox(e,this.ctx,o.offsetX,o.offsetX+d.width,o.offsetY,o.offsetY+d.height).recordOperation(e),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n,s=0,o=0,d,c){if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const h=this.ctx;h.save();const f=Mr(h);h.transform(n,s,o,d,0,0);const m=this._createMaskCanvas(e,t);h.setTransform(1,0,0,1,m.offsetX-f[4],m.offsetY-f[5]),this.dependencyTracker?.resetBBox(e);for(let b=0,S=c.length;b<S;b+=2){const v=fn.transform(f,[n,s,o,d,c[b],c[b+1]]);h.drawImage(m.canvas,v[4],v[5]),this.dependencyTracker?.recordBBox(e,this.ctx,v[4],v[4]+m.canvas.width,v[5],v[5]+m.canvas.height)}h.restore(),this.compose(),this.dependencyTracker?.recordOperation(e)}paintImageMaskXObjectGroup(e,t){if(!this.contentVisible)return;const n=this.ctx,s=this.current.fillColor,o=this.current.patternFill;this.dependencyTracker?.resetBBox(e).recordDependencies(e,zc.transformAndFill);for(const d of t){const{data:c,width:h,height:f,transform:m}=d,b=this.cachedCanvases.getCanvas("maskCanvas",h,f),S=b.context;S.save();const v=this.getObject(e,c,d);Wb(S,v),S.globalCompositeOperation="source-in",S.fillStyle=o?s.getPattern(S,this,vd(n),ko.FILL,e):s,S.fillRect(0,0,h,f),S.restore(),n.save(),n.transform(...m),n.scale(1,-1),Mg(n,b.canvas,0,0,h,f,0,-1,1,1),this.dependencyTracker?.recordBBox(e,n,0,h,0,f),n.restore()}this.compose(),this.dependencyTracker?.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const n=this.getObject(e,t);if(!n){hi("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,n)}paintImageXObjectRepeat(e,t,n,s,o){if(!this.contentVisible)return;const d=this.getObject(e,t);if(!d){hi("Dependent image isn't ready yet");return}const c=d.width,h=d.height,f=[];for(let m=0,b=o.length;m<b;m+=2)f.push({transform:[n,0,0,s,o[m],o[m+1]],x:0,y:0,w:c,h});this.paintInlineImageXObjectGroup(e,d,f)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:n,height:s}=e,o=this.cachedCanvases.getCanvas("inlineImage",n,s),d=o.context;return d.filter=this.current.transferMaps,d.drawImage(t,0,0),d.filter="none",o.canvas}paintInlineImageXObject(e,t){if(!this.contentVisible)return;const n=t.width,s=t.height,o=this.ctx;this.save(e);const{filter:d}=o;d!=="none"&&d!==""&&(o.filter="none"),o.scale(1/n,-1/s);let c;if(t.bitmap)c=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)c=t;else{const m=this.cachedCanvases.getCanvas("inlineImage",n,s).context;Vb(m,t),c=this.applyTransferMapsToCanvas(m)}const h=this._scaleImage(c,vd(o));o.imageSmoothingEnabled=$b(Mr(o),t.interpolate),this.dependencyTracker?.resetBBox(e).recordBBox(e,o,0,n,-s,0).recordDependencies(e,zc.imageXObject).recordOperation(e),Mg(o,h.img,0,0,h.paintWidth,h.paintHeight,0,-s,n,s),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,n){if(!this.contentVisible)return;const s=this.ctx;let o;if(t.bitmap)o=t.bitmap;else{const d=t.width,c=t.height,f=this.cachedCanvases.getCanvas("inlineImage",d,c).context;Vb(f,t),o=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(e);for(const d of n)s.save(),s.transform(...d.transform),s.scale(1,-1),Mg(s,o,d.x,d.y,d.w,d.h,0,-1,1,1),this.dependencyTracker?.recordBBox(e,s,0,1,-1,0),s.restore();this.dependencyTracker?.recordOperation(e),this.compose()}paintSolidColorImageMask(e){this.contentVisible&&(this.dependencyTracker?.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,zc.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,n){}beginMarkedContent(e,t){this.dependencyTracker?.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,n){this.dependencyTracker?.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){this.dependencyTracker?.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,n){const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const o=this.ctx;this.pendingClip?(s||(this.pendingClip===Gb?o.clip(t,"evenodd"):o.clip(t)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):this.dependencyTracker?.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Mr(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),s=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,s)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:n,c:s,d:o}=this.ctx.getTransform();let d,c;if(n===0&&s===0){const h=Math.abs(t),f=Math.abs(o);if(h===f)if(e===0)d=c=1/h;else{const m=h*e;d=c=m<1?1/m:1}else if(e===0)d=1/h,c=1/f;else{const m=h*e,b=f*e;d=m<1?1/m:1,c=b<1?1/b:1}}else{const h=Math.abs(t*o-n*s),f=Math.hypot(t,n),m=Math.hypot(s,o);if(e===0)d=m/h,c=f/h;else{const b=e*h;d=m>b?m/b:1,c=f>b?f/b:1}}this._cachedScaleForStroking[0]=d,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:n,current:{lineWidth:s}}=this,[o,d]=this.getScaleForStroking();if(o===d){n.lineWidth=(s||1)*o,n.stroke(e);return}const c=n.getLineDash();t&&n.save(),n.scale(o,d),Lm.a=1/o,Lm.d=1/d;const h=new Path2D;if(h.addPath(e,Lm),c.length>0){const f=Math.max(o,d);n.setLineDash(c.map(m=>m/f)),n.lineDashOffset/=f}n.lineWidth=s||1,n.stroke(h),t&&n.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const r in xp)yf.prototype[r]!==void 0&&(yf.prototype[xp[r]]=yf.prototype[r]);class xf{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}}class AC{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}[Symbol.iterator](){return this.#e.entries()}}const rf=Symbol("INTERNAL");class CC{#e=!1;#t=!1;#i=!1;#n=!0;constructor(e,{name:t,intent:n,usage:s,rbGroups:o}){this.#e=!!(e&gc.DISPLAY),this.#t=!!(e&gc.PRINT),this.name=t,this.intent=n,this.usage=s,this.rbGroups=o}get visible(){if(this.#i)return this.#n;if(!this.#n)return!1;const{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,n=!1){e!==rf&&Xs("Internal method `_setVisible` called."),this.#i=n,this.#n=t}}class TC{#e=null;#t=new Map;#i=null;#n=null;constructor(e,t=gc.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#n=e.order;for(const n of e.groups)this.#t.set(n.id,new CC(t,n));if(e.baseState==="OFF")for(const n of this.#t.values())n._setVisible(rf,!1);for(const n of e.on)this.#t.get(n)._setVisible(rf,!0);for(const n of e.off)this.#t.get(n)._setVisible(rf,!1);this.#i=this.getHash()}}#a(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let s=1;s<t;s++){const o=e[s];let d;if(Array.isArray(o))d=this.#a(o);else if(this.#t.has(o))d=this.#t.get(o).visible;else return hi(`Optional content group not found: ${o}`),!0;switch(n){case"And":if(!d)return!1;break;case"Or":if(d)return!0;break;case"Not":return!d;default:return!0}}return n==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return l0("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(hi(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#a(e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!this.#t.has(t))return hi(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!this.#t.has(t))return hi(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!this.#t.has(t))return hi(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!this.#t.has(t))return hi(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return hi(`Unknown optional content policy ${e.policy}.`),!0}return hi(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,n=!0){const s=this.#t.get(e);if(!s){hi(`Optional content group not found: ${e}`);return}if(n&&t&&s.rbGroups.length)for(const o of s.rbGroups)for(const d of o)d!==e&&this.#t.get(d)?._setVisible(rf,!1,!0);s._setVisible(rf,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let n;for(const s of e){switch(s){case"ON":case"OFF":case"Toggle":n=s;continue}const o=this.#t.get(s);if(o)switch(n){case"ON":this.setVisibility(s,!0,t);break;case"OFF":this.setVisibility(s,!1,t);break;case"Toggle":this.setVisibility(s,!o.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#i===null||this.getHash()===this.#i}getOrder(){return this.#t.size?this.#n?this.#n.slice():[...this.#t.keys()]:null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;const e=new sv;for(const[t,n]of this.#t)e.update(`${t}:${n.visible}`);return this.#e=e.hexdigest()}[Symbol.iterator](){return this.#t.entries()}}class _C{constructor(e,{disableRange:t=!1,disableStream:n=!1}){Zi(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:o,progressiveDone:d,contentDispositionFilename:c}=e;if(this._queuedChunks=[],this._progressiveDone=d,this._contentDispositionFilename=c,o?.length>0){const h=o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength?o.buffer:new Uint8Array(o).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!t,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((h,f)=>{this._onReceiveData({begin:h,chunk:f})}),e.addProgressListener((h,f)=>{this._onProgress({loaded:h,total:f})}),e.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const s=this._rangeReaders.some(function(o){return o._begin!==e?!1:(o._enqueue(n),!0)});Zi(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Zi(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new kC(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new NC(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class kC{constructor(e,t,n=!1,s=null){this._stream=e,this._done=n||!1,this._filename=Sy(s)?s:null,this._queuedChunks=t||[],this._loaded=0;for(const o of this._queuedChunks)this._loaded+=o.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class NC{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function jC(r){let e=!0,t=n("filename\\*","i").exec(r);if(t){t=t[1];let m=c(t);return m=unescape(m),m=h(m),m=f(m),o(m)}if(t=d(r),t){const m=f(t);return o(m)}if(t=n("filename","i").exec(r),t){t=t[1];let m=c(t);return m=f(m),o(m)}function n(m,b){return new RegExp("(?:^|;)\\s*"+m+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',b)}function s(m,b){if(m){if(!/^[\x00-\xFF]+$/.test(b))return b;try{const S=new TextDecoder(m,{fatal:!0}),v=Cp(b);b=S.decode(v),e=!1}catch{}}return b}function o(m){return e&&/[\x80-\xff]/.test(m)&&(m=s("utf-8",m),e&&(m=s("iso-8859-1",m))),m}function d(m){const b=[];let S;const v=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(S=v.exec(m))!==null;){let[,x,k,N]=S;if(x=parseInt(x,10),x in b){if(x===0)break;continue}b[x]=[k,N]}const P=[];for(let x=0;x<b.length&&x in b;++x){let[k,N]=b[x];N=c(N),k&&(N=unescape(N),x===0&&(N=h(N))),P.push(N)}return P.join("")}function c(m){if(m.startsWith('"')){const b=m.slice(1).split('\\"');for(let S=0;S<b.length;++S){const v=b[S].indexOf('"');v!==-1&&(b[S]=b[S].slice(0,v),b.length=S+1),b[S]=b[S].replaceAll(/\\(.)/g,"$1")}m=b.join('"')}return m}function h(m){const b=m.indexOf("'");if(b===-1)return m;const S=m.slice(0,b),P=m.slice(b+1).replace(/^[^']*'/,"");return s(S,P)}function f(m){return!m.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(m)?m:m.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(b,S,v,P){if(v==="q"||v==="Q")return P=P.replaceAll("_"," "),P=P.replaceAll(/=([0-9a-fA-F]{2})/g,function(x,k){return String.fromCharCode(parseInt(k,16))}),s(S,P);try{P=atob(P)}catch{}return s(S,P)})}return""}function uv(r,e){const t=new Headers;if(!r||!e||typeof e!="object")return t;for(const n in e){const s=e[n];s!==void 0&&t.append(n,s)}return t}function u0(r){return URL.parse(r)?.origin??null}function hv({responseHeaders:r,isHttp:e,rangeChunkSize:t,disableRange:n}){const s={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(r.get("Content-Length"),10);return!Number.isInteger(o)||(s.suggestedLength=o,o<=2*t)||n||!e||r.get("Accept-Ranges")!=="bytes"||(r.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function fv(r){const e=r.get("Content-Disposition");if(e){let t=jC(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Sy(t))return t}return null}function jp(r,e){return new Qg(`Unexpected server response (${r}) while retrieving PDF "${e}".`,r,r===404||r===0&&e.startsWith("file:"))}function pv(r){return r===200||r===206}function gv(r,e,t){return{method:"GET",headers:r,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function mv(r){return r instanceof Uint8Array?r.buffer:r instanceof ArrayBuffer?r:(hi(`getArrayBuffer - unexpected data format: ${r}`),new Uint8Array(r).buffer)}class PC{_responseOrigin=null;constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=uv(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Zi(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new EC(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new RC(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class EC{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const n=new Headers(e.headers),s=t.url;fetch(s,gv(n,this._withCredentials,this._abortController)).then(o=>{if(e._responseOrigin=u0(o.url),!pv(o.status))throw jp(o.status,s);this._reader=o.body.getReader(),this._headersCapability.resolve();const d=o.headers,{allowRangeRequests:c,suggestedLength:h}=hv({responseHeaders:d,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=h||this._contentLength,this._filename=fv(d),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Mu("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:mv(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class RC{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const s=e.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const o=new Headers(e.headers);o.append("Range",`bytes=${t}-${n-1}`);const d=s.url;fetch(d,gv(o,this._withCredentials,this._abortController)).then(c=>{const h=u0(c.url);if(h!==e._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${e._responseOrigin}".`);if(!pv(c.status))throw jp(c.status,d);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:mv(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const Mm=200,Im=206;function DC(r){const e=r.response;return typeof e!="string"?e:Cp(e).buffer}class LC{_responseOrigin=null;constructor({url:e,httpHeaders:t,withCredentials:n}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=uv(this.isHttp,t),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,s=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[o,d]of this.headers)t.setRequestHeader(o,d);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),s.expectedStatus=Im):s.expectedStatus=Mm,t.responseType="arraybuffer",Zi(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),s.onHeadersReceived=e.onHeadersReceived,s.onDone=e.onDone,s.onError=e.onError,s.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){const n=this.pendingRequests[e];n&&n.onProgress?.(t)}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const s=n.xhr;if(s.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),s.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],s.status===0&&this.isHttp){n.onError(s.status);return}const o=s.status||Mm;if(!(o===Mm&&n.expectedStatus===Im)&&o!==n.expectedStatus){n.onError(s.status);return}const c=DC(s);if(o===Im){const h=s.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);f?n.onDone({begin:parseInt(f[1],10),chunk:c}):(hi('Missing or invalid "Content-Range" header.'),n.onError(0))}else c?n.onDone({begin:0,chunk:c}):n.onError(s.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class MC{constructor(e){this._source=e,this._manager=new LC(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Zi(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new IC(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new zC(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class IC{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=u0(t.responseURL);const n=t.getAllResponseHeaders(),s=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(c=>{const[h,...f]=c.split(": ");return[h,f.join(": ")]}):[]),{allowRangeRequests:o,suggestedLength:d}=hv({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});o&&(this._isRangeSupported=!0),this._contentLength=d||this._contentLength,this._filename=fv(s),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=jp(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class zC{constructor(e,t,n){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const e=u0(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??=jp(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const BC=/^[a-z][a-z0-9\-+.]+:/i;function OC(r){if(BC.test(r))return new URL(r);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(r))}class FC{constructor(e){this.source=e,this.url=OC(e.url),Zi(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Zi(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new UC(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new HC(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class UC{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=jp(0,this._url.href)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Mu("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class HC{constructor(e,t,n){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=e.source;this._isStreamingSupported=!s.disableStream;const o=process.getBuiltinModule("fs");this._setReadableStream(o.createReadStream(this._url,{start:t,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const rp=Symbol("INITIAL_DATA");class yv{#e=Object.create(null);#t(e){return this.#e[e]||={...Promise.withResolvers(),data:rp}}get(e,t=null){if(t){const s=this.#t(e);return s.promise.then(()=>t(s.data)),null}const n=this.#e[e];if(!n||n.data===rp)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=this.#e[e];return!!t&&t.data!==rp}delete(e){const t=this.#e[e];return!t||t.data===rp?!1:(delete this.#e[e],!0)}resolve(e,t=null){const n=this.#t(e);n.data=t,n.resolve()}clear(){for(const e in this.#e){const{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(const e in this.#e){const{data:t}=this.#e[e];t!==rp&&(yield[e,t])}}}const qC=1e5,Yb=30;class xl{#e=Promise.withResolvers();#t=null;#i=!1;#n=!!globalThis.FontInspector?.enabled;#a=null;#r=null;#s=0;#o=0;#c=null;#l=null;#h=0;#u=0;#f=Object.create(null);#m=[];#g=null;#d=[];#p=new WeakMap;#y=null;static#b=new Map;static#x=new Map;static#T=new WeakMap;static#A=null;static#w=new Set;constructor({textContentSource:e,container:t,viewport:n}){if(e instanceof ReadableStream)this.#g=e;else if(typeof e=="object")this.#g=new ReadableStream({start(h){h.enqueue(e),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#l=t,this.#u=n.scale*kd.pixelRatio,this.#h=n.rotation,this.#r={div:null,properties:null,ctx:null};const{pageWidth:s,pageHeight:o,pageX:d,pageY:c}=n.rawDims;this.#y=[1,0,0,-1,-d,c+o],this.#o=s,this.#s=o,xl.#j(),hh(t,n),this.#e.promise.finally(()=>{xl.#w.delete(this),this.#r=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=No.platform;return fi(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{this.#c.read().then(({value:t,done:n})=>{if(n){this.#e.resolve();return}this.#a??=t.lang,Object.assign(this.#f,t.styles),this.#k(t.items),e()},this.#e.reject)};return this.#c=this.#g.getReader(),xl.#w.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){const n=e.scale*kd.pixelRatio,s=e.rotation;if(s!==this.#h&&(t?.(),this.#h=s,hh(this.#l,{rotation:s})),n!==this.#u){t?.(),this.#u=n;const o={div:null,properties:null,ctx:xl.#P(this.#a)};for(const d of this.#d)o.properties=this.#p.get(d),o.div=d,this.#C(o)}}cancel(){const e=new Mu("TextLayer task cancelled.");this.#c?.cancel(e).catch(()=>{}),this.#c=null,this.#e.reject(e)}get textDivs(){return this.#d}get textContentItemsStr(){return this.#m}#k(e){if(this.#i)return;this.#r.ctx??=xl.#P(this.#a);const t=this.#d,n=this.#m;for(const s of e){if(t.length>qC){hi("Ignoring additional textDivs for performance reasons."),this.#i=!0;return}if(s.str===void 0){if(s.type==="beginMarkedContentProps"||s.type==="beginMarkedContent"){const o=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),s.id&&this.#t.setAttribute("id",`${s.id}`),o.append(this.#t)}else s.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}n.push(s.str),this.#v(s)}}#v(e){const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#d.push(t);const s=fn.transform(this.#y,e.transform);let o=Math.atan2(s[1],s[0]);const d=this.#f[e.fontName];d.vertical&&(o+=Math.PI/2);let c=this.#n&&d.fontSubstitution||d.fontFamily;c=xl.fontFamilyMap.get(c)||c;const h=Math.hypot(s[2],s[3]),f=h*xl.#z(c,d,this.#a);let m,b;o===0?(m=s[4],b=s[5]-f):(m=s[4]+f*Math.sin(o),b=s[5]-f*Math.cos(o));const S="calc(var(--total-scale-factor) *",v=t.style;this.#t===this.#l?(v.left=`${(100*m/this.#o).toFixed(2)}%`,v.top=`${(100*b/this.#s).toFixed(2)}%`):(v.left=`${S}${m.toFixed(2)}px)`,v.top=`${S}${b.toFixed(2)}px)`),v.fontSize=`${S}${(xl.#A*h).toFixed(2)}px)`,v.fontFamily=c,n.fontSize=h,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#n&&(t.dataset.fontName=d.fontSubstitutionLoadedName||e.fontName),o!==0&&(n.angle=o*(180/Math.PI));let P=!1;if(e.str.length>1)P=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const x=Math.abs(e.transform[0]),k=Math.abs(e.transform[3]);x!==k&&Math.max(x,k)/Math.min(x,k)>1.5&&(P=!0)}if(P&&(n.canvasWidth=d.vertical?e.height:e.width),this.#p.set(t,n),this.#r.div=t,this.#r.properties=n,this.#C(this.#r),n.hasText&&this.#t.append(t),n.hasEOL){const x=document.createElement("br");x.setAttribute("role","presentation"),this.#t.append(x)}}#C(e){const{div:t,properties:n,ctx:s}=e,{style:o}=t;let d="";if(xl.#A>1&&(d=`scale(${1/xl.#A})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:c}=o,{canvasWidth:h,fontSize:f}=n;xl.#N(s,f*this.#u,c);const{width:m}=s.measureText(t.textContent);m>0&&(d=`scaleX(${h*this.#u/m}) ${d}`)}n.angle!==0&&(d=`rotate(${n.angle}deg) ${d}`),d.length>0&&(o.transform=d)}static cleanup(){if(!(this.#w.size>0)){this.#b.clear();for(const{canvas:e}of this.#x.values())e.remove();this.#x.clear()}}static#P(e=null){let t=this.#x.get(e||="");if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#x.set(e,t),this.#T.set(t,{size:0,family:""})}return t}static#N(e,t,n){const s=this.#T.get(e);t===s.size&&n===s.family||(e.font=`${t}px ${n}`,s.size=t,s.family=n)}static#j(){if(this.#A!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#A=e.getBoundingClientRect().height,e.remove()}static#z(e,t,n){const s=this.#b.get(e);if(s)return s;const o=this.#P(n);o.canvas.width=o.canvas.height=Yb,this.#N(o,Yb,e);const d=o.measureText(""),c=d.fontBoundingBoxAscent,h=Math.abs(d.fontBoundingBoxDescent);o.canvas.width=o.canvas.height=0;let f=.8;return c?f=c/(c+h):(No.platform.isFirefox&&hi("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?f=t.ascent:t.descent&&(f=1+t.descent)),this.#b.set(e,f),f}}const VC=100;function xv(r={}){typeof r=="string"||r instanceof URL?r={url:r}:(r instanceof ArrayBuffer||ArrayBuffer.isView(r))&&(r={data:r});const e=new jy,{docId:t}=e,n=r.url?Z3(r.url):null,s=r.data?J3(r.data):null,o=r.httpHeaders||null,d=r.withCredentials===!0,c=r.password??null,h=r.range instanceof bv?r.range:null,f=Number.isInteger(r.rangeChunkSize)&&r.rangeChunkSize>0?r.rangeChunkSize:2**16;let m=r.worker instanceof vp?r.worker:null;const b=r.verbosity,S=typeof r.docBaseUrl=="string"&&!c0(r.docBaseUrl)?r.docBaseUrl:null,v=Eg(r.cMapUrl),P=r.cMapPacked!==!1,x=r.CMapReaderFactory||(bl?aC:Lb),k=Eg(r.iccUrl),N=Eg(r.standardFontDataUrl),$=r.StandardFontDataFactory||(bl?oC:Mb),I=Eg(r.wasmUrl),z=r.WasmFactory||(bl?lC:Ib),B=r.stopAtErrors!==!0,G=Number.isInteger(r.maxImageSize)&&r.maxImageSize>-1?r.maxImageSize:-1,te=r.isEvalSupported!==!1,F=typeof r.isOffscreenCanvasSupported=="boolean"?r.isOffscreenCanvasSupported:!bl,H=typeof r.isImageDecoderSupported=="boolean"?r.isImageDecoderSupported:!bl&&(No.platform.isFirefox||!globalThis.chrome),Q=Number.isInteger(r.canvasMaxAreaInBytes)?r.canvasMaxAreaInBytes:-1,M=typeof r.disableFontFace=="boolean"?r.disableFontFace:bl,T=r.fontExtraProperties===!0,R=r.enableXfa===!0,Z=r.ownerDocument||globalThis.document,se=r.disableRange===!0,V=r.disableStream===!0,ee=r.disableAutoFetch===!0,ae=r.pdfBug===!0,Ce=r.CanvasFactory||(bl?rC:nC),xe=r.FilterFactory||(bl?sC:iC),J=r.enableHWA===!0,D=r.useWasm!==!1,W=h?h.length:r.length??NaN,K=typeof r.useSystemFonts=="boolean"?r.useSystemFonts:!bl&&!M,ue=typeof r.useWorkerFetch=="boolean"?r.useWorkerFetch:!!(x===Lb&&$===Mb&&z===Ib&&v&&N&&I&&cp(v,document.baseURI)&&cp(N,document.baseURI)&&cp(I,document.baseURI)),Te=null;T3(b);const Pe={canvasFactory:new Ce({ownerDocument:Z,enableHWA:J}),filterFactory:new xe({docId:t,ownerDocument:Z}),cMapReaderFactory:ue?null:new x({baseUrl:v,isCompressed:P}),standardFontDataFactory:ue?null:new $({baseUrl:N}),wasmFactory:ue?null:new z({baseUrl:I})};m||(m=vp.create({verbosity:b,port:xf.workerPort}),e._worker=m);const Ve={docId:t,apiVersion:"5.4.449",data:s,password:c,disableAutoFetch:ee,rangeChunkSize:f,length:W,docBaseUrl:S,enableXfa:R,evaluatorOptions:{maxImageSize:G,disableFontFace:M,ignoreErrors:B,isEvalSupported:te,isOffscreenCanvasSupported:F,isImageDecoderSupported:H,canvasMaxAreaInBytes:Q,fontExtraProperties:T,useSystemFonts:K,useWasm:D,useWorkerFetch:ue,cMapUrl:v,iccUrl:k,standardFontDataUrl:N,wasmUrl:I}},De={ownerDocument:Z,pdfBug:ae,styleElement:Te,loadingParams:{disableAutoFetch:ee,enableXfa:R}};return m.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(m.destroyed)throw new Error("Worker was destroyed");const et=m.messageHandler.sendWithPromise("GetDocRequest",Ve,s?[s.buffer]:null);let ot;if(h)ot=new _C(h,{disableRange:se,disableStream:V});else if(!s){if(!n)throw new Error("getDocument - no `url` parameter provided.");const at=cp(n)?PC:bl?FC:MC;ot=new at({url:n,length:W,httpHeaders:o,withCredentials:d,rangeChunkSize:f,disableRange:se,disableStream:V})}return et.then(at=>{if(e.destroyed)throw new Error("Loading aborted");if(m.destroyed)throw new Error("Worker was destroyed");const ht=new dp(t,at,m.port),xt=new GC(ht,e,ot,De,Pe,J);e._transport=xt,ht.send("Ready",null)})}).catch(e._capability.reject),e}class jy{static#e=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${jy.#e++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class bv{#e=Promise.withResolvers();#t=[];#i=[];#n=[];#a=[];constructor(e,t,n=!1,s=null){this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=s}addRangeListener(e){this.#a.push(e)}addProgressListener(e){this.#n.push(e)}addProgressiveReadListener(e){this.#i.push(e)}addProgressiveDoneListener(e){this.#t.push(e)}onDataRange(e,t){for(const n of this.#a)n(e,t)}onDataProgress(e,t){this.#e.promise.then(()=>{for(const n of this.#n)n(e,t)})}onDataProgressiveRead(e){this.#e.promise.then(()=>{for(const t of this.#i)t(e)})}onDataProgressiveDone(){this.#e.promise.then(()=>{for(const e of this.#t)e()})}transportReady(){this.#e.resolve()}requestDataRange(e,t){Xs("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class WC{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return fi(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(e){return this._transport.extractPages(e)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class $C{#e=!1;constructor(e,t,n,s=!1){this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=s?new kb:null,this._pdfBug=s,this.commonObjs=n.commonObjs,this.objs=new yv,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:s=0,dontFlip:o=!1}={}){return new _p({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:s,dontFlip:o})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return fi(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,canvas:t=e.canvas,viewport:n,intent:s="display",annotationMode:o=Pu.ENABLE,transform:d=null,background:c=null,optionalContentConfigPromise:h=null,annotationCanvasMap:f=null,pageColors:m=null,printAnnotationStorage:b=null,isEditing:S=!1,recordOperations:v=!1,operationsFilter:P=null}){this._stats?.time("Overall");const x=this._transport.getRenderingIntent(s,o,b,S),{renderingIntent:k,cacheKey:N}=x;this.#e=!1,h||=this._transport.getOptionalContentConfig(k);let $=this._intentStates.get(N);$||($=Object.create(null),this._intentStates.set(N,$)),$.streamReaderCancelTimeout&&(clearTimeout($.streamReaderCancelTimeout),$.streamReaderCancelTimeout=null);const I=!!(k&gc.PRINT);$.displayReadyCapability||($.displayReadyCapability=Promise.withResolvers(),$.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(x));const z=!!(this._pdfBug&&globalThis.StepperManager?.enabled),B=!this.recordedBBoxes&&(v||z),G=H=>{if($.renderTasks.delete(te),B){const Q=te.gfx?.dependencyTracker.take();Q&&(te.stepper&&te.stepper.setOperatorBBoxes(Q,te.gfx.dependencyTracker.takeDebugMetadata()),v&&(this.recordedBBoxes=Q))}I&&(this.#e=!0),this.#t(),H?(te.capability.reject(H),this._abortOperatorList({intentState:$,reason:H instanceof Error?H:new Error(H)})):te.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},te=new df({callback:G,params:{canvas:t,canvasContext:e,dependencyTracker:B?new dC(t,$.operatorList.length,z):null,viewport:n,transform:d,background:c},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:$.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!I,pdfBug:this._pdfBug,pageColors:m,enableHWA:this._transport.enableHWA,operationsFilter:P});($.renderTasks||=new Set).add(te);const F=te.task;return Promise.all([$.displayReadyCapability.promise,h]).then(([H,Q])=>{if(this.destroyed){G();return}if(this._stats?.time("Rendering"),!(Q.renderingIntent&k))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");te.initializeGraphics({transparency:H,optionalContentConfig:Q}),te.operatorListChanged()}).catch(G),F}getOperatorList({intent:e="display",annotationMode:t=Pu.ENABLE,printAnnotationStorage:n=null,isEditing:s=!1}={}){function o(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(h))}const d=this._transport.getRenderingIntent(e,t,n,s,!0);let c=this._intentStates.get(d.cacheKey);c||(c=Object.create(null),this._intentStates.set(d.cacheKey,c));let h;return c.opListReadCapability||(h=Object.create(null),h.operatorListChanged=o,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||=new Set).add(h),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(d)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>bp.textContent(n));const t=this.streamTextContent(e);return new Promise(function(n,s){function o(){d.read().then(function({value:h,done:f}){if(f){n(c);return}c.lang??=h.lang,Object.assign(c.styles,h.styles),c.items.push(...h.items),o()},s)}const d=t.getReader(),c={items:[],styles:Object.create(null),lang:null};o()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),this.#e=!1,Promise.all(e)}cleanup(e=!1){this.#e=!0;const t=this.#t();return e&&t&&(this._stats&&=new kb),t}#t(){if(!this.#e||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}_startRenderPage(e,t){const n=this._intentStates.get(t);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let n=0,s=e.length;n<s;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&this.#t()}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:s}){const{map:o,transfer:d}=n,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:o,modifiedIds:s},d).getReader(),f=this._intentStates.get(t);f.streamReader=h;const m=()=>{h.read().then(({value:b,done:S})=>{if(S){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(b,f),m())},b=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const S of f.renderTasks)S.operatorListChanged();this.#t()}if(f.displayReadyCapability)f.displayReadyCapability.reject(b);else if(f.opListReadCapability)f.opListReadCapability.reject(b);else throw b}})};m()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof wy){let s=VC;t.extraDelay>0&&t.extraDelay<1e3&&(s+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},s);return}}if(e.streamReader.cancel(new Mu(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[s,o]of this._intentStates)if(o===e){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}var Eu,Zc,Xd,ah,n0,oh,lh,Sl,$g,vv,wv,up,bf,Gg;const Ar=class Ar{constructor({name:e=null,port:t=null,verbosity:n=_3()}={}){yd(this,Sl);yd(this,Eu,Promise.withResolvers());yd(this,Zc,null);yd(this,Xd,null);yd(this,ah,null);if(this.name=e,this.destroyed=!1,this.verbosity=n,t){if(vr(Ar,lh).has(t))throw new Error("Cannot use more than one PDFWorker per port.");vr(Ar,lh).set(t,this),xd(this,Sl,vv).call(this,t)}else xd(this,Sl,wv).call(this)}get promise(){return vr(this,Eu).promise}get port(){return vr(this,Xd)}get messageHandler(){return vr(this,Zc)}destroy(){this.destroyed=!0,vr(this,ah)?.terminate(),Vl(this,ah,null),vr(Ar,lh).delete(vr(this,Xd)),Vl(this,Xd,null),vr(this,Zc)?.destroy(),Vl(this,Zc,null)}static create(e){const t=vr(this,lh).get(e?.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Ar(e)}static get workerSrc(){if(xf.workerSrc)return xf.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return fi(this,"_setupFakeWorkerGlobal",(async()=>vr(this,bf,Gg)?vr(this,bf,Gg):(await import(this.workerSrc)).WorkerMessageHandler)())}};Eu=new WeakMap,Zc=new WeakMap,Xd=new WeakMap,ah=new WeakMap,n0=new WeakMap,oh=new WeakMap,lh=new WeakMap,Sl=new WeakSet,$g=function(){vr(this,Eu).resolve(),vr(this,Zc).send("configure",{verbosity:this.verbosity})},vv=function(e){Vl(this,Xd,e),Vl(this,Zc,new dp("main","worker",e)),vr(this,Zc).on("ready",()=>{}),xd(this,Sl,$g).call(this)},wv=function(){if(vr(Ar,oh)||vr(Ar,bf,Gg)){xd(this,Sl,up).call(this);return}let{workerSrc:e}=Ar;try{Ar._isSameOrigin(window.location,e)||(e=Ar._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new dp("main","worker",t),s=()=>{o.abort(),n.destroy(),t.terminate(),this.destroyed?vr(this,Eu).reject(new Error("Worker was destroyed")):xd(this,Sl,up).call(this)},o=new AbortController;t.addEventListener("error",()=>{vr(this,ah)||s()},{signal:o.signal}),n.on("test",c=>{if(o.abort(),this.destroyed||!c){s();return}Vl(this,Zc,n),Vl(this,Xd,t),Vl(this,ah,t),xd(this,Sl,$g).call(this)}),n.on("ready",c=>{if(o.abort(),this.destroyed){s();return}try{d()}catch{xd(this,Sl,up).call(this)}});const d=()=>{const c=new Uint8Array;n.send("test",c,[c.buffer])};d();return}catch{l0("The worker has been disabled.")}xd(this,Sl,up).call(this)},up=function(){vr(Ar,oh)||(hi("Setting up fake worker."),Vl(Ar,oh,!0)),Ar._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){vr(this,Eu).reject(new Error("Worker was destroyed"));return}const t=new tC;Vl(this,Xd,t);const n=`fake${W1(Ar,n0)._++}`,s=new dp(n+"_worker",n,t);e.setup(s,t),Vl(this,Zc,new dp(n,n+"_worker",t)),xd(this,Sl,$g).call(this)}).catch(e=>{vr(this,Eu).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},bf=new WeakSet,Gg=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},yd(Ar,bf),yd(Ar,n0,0),yd(Ar,oh,!1),yd(Ar,lh,new WeakMap),bl&&(Vl(Ar,oh,!0),xf.workerSrc||="./pdf.worker.mjs"),Ar._isSameOrigin=(e,t)=>{const n=URL.parse(e);if(!n?.origin||n.origin==="null")return!1;const s=new URL(t,n);return n.origin===s.origin},Ar._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},Ar.fromPort=e=>{if(B3("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Ar.create(e)};let vp=Ar;class GC{#e=new Map;#t=new Map;#i=new Map;#n=new Map;#a=null;constructor(e,t,n,s,o,d){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new yv,this.fontLoader=new X3({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=o.canvasFactory,this.filterFactory=o.filterFactory,this.cMapReaderFactory=o.cMapReaderFactory,this.standardFontDataFactory=o.standardFontDataFactory,this.wasmFactory=o.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=d,this.setupMessageHandler()}#r(e,t=null){const n=this.#e.get(e);if(n)return n;const s=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,s),s}get annotationStorage(){return fi(this,"annotationStorage",new Ty)}getRenderingIntent(e,t=Pu.ENABLE,n=null,s=!1,o=!1){let d=gc.DISPLAY,c=ry;switch(e){case"any":d=gc.ANY;break;case"display":break;case"print":d=gc.PRINT;break;default:hi(`getRenderingIntent - invalid intent: ${e}`)}const h=d&gc.PRINT&&n instanceof rv?n:this.annotationStorage;switch(t){case Pu.DISABLE:d+=gc.ANNOTATIONS_DISABLE;break;case Pu.ENABLE:break;case Pu.ENABLE_FORMS:d+=gc.ANNOTATIONS_FORMS;break;case Pu.ENABLE_STORAGE:d+=gc.ANNOTATIONS_STORAGE,c=h.serializable;break;default:hi(`getRenderingIntent - invalid annotationMode: ${t}`)}s&&(d+=gc.IS_EDITING),o&&(d+=gc.OPLIST);const{ids:f,hash:m}=h.modifiedIds,b=[d,c.hash,m];return{renderingIntent:d,cacheKey:b.join("_"),annotationStorageSerializable:c,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#a?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const n of this.#t.values())e.push(n._destroy());this.#t.clear(),this.#i.clear(),this.#n.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),xl.cleanup(),this._networkStream?.cancelAllRequests(new Mu("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,s)=>{Zi(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=o=>{this._lastProgress={loaded:o.loaded,total:o.total}},s.onPull=()=>{this._fullReader.read().then(function({value:o,done:d}){if(d){s.close();return}Zi(o instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{s.error(o)})},s.onCancel=o=>{this._fullReader.cancel(o),s.ready.catch(d=>{if(!this.destroyed)throw d})}}),e.on("ReaderHeadersReady",async n=>{await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:o,contentLength:d}=this._fullReader;return(!s||!o)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=c=>{t.onProgress?.({loaded:c.loaded,total:c.total})}),{isStreamingSupported:s,isRangeSupported:o,contentLength:d}}),e.on("GetRangeReader",(n,s)=>{Zi(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const o=this._networkStream.getRangeReader(n.begin,n.end);if(!o){s.close();return}s.onPull=()=>{o.read().then(function({value:d,done:c}){if(c){s.close();return}Zi(d instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(d),1,[d])}).catch(d=>{s.error(d)})},s.onCancel=d=>{o.cancel(d),s.ready.catch(c=>{if(!this.destroyed)throw c})}}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new WC(n,this))}),e.on("DocException",n=>{t._capability.reject(Wl(n))}),e.on("PasswordRequest",n=>{this.#a=Promise.withResolvers();try{if(!t.onPassword)throw Wl(n);const s=o=>{o instanceof Error?this.#a.reject(o):this.#a.resolve({password:o})};t.onPassword(s,n.code)}catch(s){this.#a.reject(s)}return this.#a.promise}),e.on("DataLoaded",n=>{t.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;this.#t.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,s,o])=>{if(this.destroyed||this.commonObjs.has(n))return null;switch(s){case"Font":if("error"in o){const b=o.error;hi(`Error during font loading: ${b}`),this.commonObjs.resolve(n,b);break}const d=new Os(o),c=this._params.pdfBug&&globalThis.FontInspector?.enabled?(b,S)=>globalThis.FontInspector.fontAdded(b,S):null,h=new K3(d,c,o.extra,o.charProcOperatorList);this.fontLoader.bind(h).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!h.fontExtraProperties&&h.data&&h.clearData(),this.commonObjs.resolve(n,h)});break;case"CopyLocalImage":const{imageRef:f}=o;Zi(f,"The imageRef must be defined.");for(const b of this.#t.values())for(const[,S]of b.objs)if(S?.ref===f)return S.dataLen?(this.commonObjs.resolve(n,structuredClone(S)),S.dataLen):null;break;case"FontPath":case"Image":this.commonObjs.resolve(n,o);break;case"Pattern":const m=new ao(o);this.commonObjs.resolve(n,m.getIR());break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),e.on("obj",([n,s,o,d])=>{if(this.destroyed)return;const c=this.#t.get(s);if(!c.objs.has(n)){if(c._intentStates.size===0){d?.bitmap?.close();return}switch(o){case"Image":case"Pattern":c.objs.resolve(n,d);break;default:throw new Error(`Got unknown object type ${o}`)}}}),e.on("DocProgress",n=>{this.destroyed||t.onProgress?.({loaded:n.loaded,total:n.total})}),e.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const s=this[n.type];if(!s)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return s.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&hi("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}extractPages(e){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:e})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=this.#i.get(t);if(n)return n;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(o=>{if(this.destroyed)throw new Error("Transport destroyed");o.refStr&&this.#n.set(o.refStr,e);const d=new $C(t,o,this,this._params.pdfBug);return this.#t.set(t,d),d});return this.#i.set(t,s),s}getPageIndex(e){return ay(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#r("GetFieldObjects")}hasJSActions(){return this.#r("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return this.#r("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#r("GetOptionalContentConfig").then(t=>new TC(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#e.get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(s=>({info:s[0],metadata:s[1]?new AC(s[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null,hasStructTree:s[2]}));return this.#e.set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),xl.cleanup()}}cachedPageNumber(e){if(!ay(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#n.get(t)??null}}class YC{#e=null;onContinue=null;onError=null;constructor(e){this.#e=e}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}}class df{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:n,commonObjs:s,annotationCanvasMap:o,operatorList:d,pageIndex:c,canvasFactory:h,filterFactory:f,useRequestAnimationFrame:m=!1,pdfBug:b=!1,pageColors:S=null,enableHWA:v=!1,operationsFilter:P=null}){this.callback=e,this.params=t,this.objs=n,this.commonObjs=s,this.annotationCanvasMap=o,this.operatorListIdx=null,this.operatorList=d,this._pageIndex=c,this.canvasFactory=h,this.filterFactory=f,this._pdfBug=b,this.pageColors=S,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=m===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new YC(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=v,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=P}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(df.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");df.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:s,background:o,dependencyTracker:d}=this.params,c=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new yf(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,d),this.gfx.beginDrawing({transform:s,viewport:n,transparency:e,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),df.#t.delete(this._canvas),e||=new wy(`Rendering cancelled, page ${this._pageIndex+1}`,t),this.callback(e),this.task.onError?.(e)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),df.#t.delete(this._canvas),this.callback())))}}const Sv="5.4.449",XC="f44e5f0e6";class Bc{#e=null;#t=null;#i;#n=null;#a=!1;#r=!1;#s=null;#o;#c=null;#l=null;static#h=null;static get _keyboardManager(){return fi(this,"_keyboardManager",new Np([[["Escape","mac+Escape"],Bc.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Bc.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Bc.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Bc.prototype._moveToPrevious],[["Home","mac+Home"],Bc.prototype._moveToBeginning],[["End","mac+End"],Bc.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#r=!1,this.#s=e):this.#r=!0,this.#l=e?._uiManager||t,this.#o=this.#l._eventBus,this.#i=e?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",Bc.#h||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",this.#s&&(e.ariaControls=`${this.#s.id}_colorpicker_dropdown`);const t=this.#l._signal;e.addEventListener("click",this.#g.bind(this),{signal:t}),e.addEventListener("keydown",this.#m.bind(this),{signal:t});const n=this.#t=document.createElement("span");return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=this.#i,e.append(n),e}renderMainDropdown(){const e=this.#n=this.#u();return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}#u(){const e=document.createElement("div"),t=this.#l._signal;e.addEventListener("contextmenu",Uc,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#s&&(e.id=`${this.#s.id}_colorpicker_dropdown`);for(const[n,s]of this.#l.highlightColors){const o=document.createElement("button");o.tabIndex="0",o.role="option",o.setAttribute("data-color",s),o.title=n,o.setAttribute("data-l10n-id",Bc.#h[n]);const d=document.createElement("span");o.append(d),d.className="swatch",d.style.backgroundColor=s,o.ariaSelected=s===this.#i,o.addEventListener("click",this.#f.bind(this,s),{signal:t}),e.append(o)}return e.addEventListener("keydown",this.#m.bind(this),{signal:t}),e}#f(e,t){t.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:Ki.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#g(e);return}const t=e.target.getAttribute("data-color");t&&this.#f(t,e)}_moveToNext(e){if(!this.#p){this.#g(e);return}if(e.target===this.#e){this.#n.firstElementChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#n?.firstElementChild||e.target===this.#e){this.#p&&this._hideDropdownFromKeyboard();return}this.#p||this.#g(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#p){this.#g(e);return}this.#n.firstElementChild?.focus()}_moveToEnd(e){if(!this.#p){this.#g(e);return}this.#n.lastElementChild?.focus()}#m(e){Bc._keyboardManager.exec(this,e)}#g(e){if(this.#p){this.hideDropdown();return}if(this.#a=e.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#d.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#e.ariaExpanded="true",this.#n){this.#n.classList.remove("hidden");return}const t=this.#n=this.#u();this.#e.append(t)}#d(e){this.#n?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),this.#e.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#p(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#r){if(!this.#p){this.#s?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#a})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#n)return;const t=this.#l.highlightColors.values();for(const n of this.#n.children)n.ariaSelected=t.next().value===e.toUpperCase()}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#n?.remove(),this.#n=null}}class wp{#e=null;#t=null;#i=null;static#n=null;constructor(e){this.#t=e,this.#i=e._uiManager,wp.#n||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#e)return this.#e;const{editorType:e,colorType:t,color:n}=this.#t,s=this.#e=document.createElement("input");return s.type="color",s.value=n||"#000000",s.className="basicColorPicker",s.tabIndex=0,s.setAttribute("data-l10n-id",wp.#n[e]),s.addEventListener("input",()=>{this.#i.updateParams(t,s.value)},{signal:this.#i._signal}),s}update(e){this.#e&&(this.#e.value=e)}destroy(){this.#e?.remove(),this.#e=null}hideDropdown(){}}function Xb(r){return Math.floor(Math.max(0,Math.min(1,r))*255).toString(16).padStart(2,"0")}function ap(r){return Math.max(0,Math.min(255,255*r))}class Kb{static CMYK_G([e,t,n,s]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+s)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=ap(e),[e,e,e]}static G_HTML([e]){const t=Xb(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(ap)}static RGB_HTML(e){return`#${e.map(Xb).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,s]){return["RGB",1-Math.min(1,e+s),1-Math.min(1,n+s),1-Math.min(1,t+s)]}static CMYK_rgb([e,t,n,s]){return[ap(1-Math.min(1,e+s)),ap(1-Math.min(1,n+s)),ap(1-Math.min(1,t+s))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const s=1-e,o=1-t,d=1-n,c=Math.min(s,o,d);return["CMYK",s,o,d,c]}}class KC{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),n||(s.setAttribute("width",`${e}px`),s.setAttribute("height",`${t}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${e} ${t}`),s}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Xs("Abstract method `_createSVG` called.")}}class t0 extends KC{_createSVG(e){return document.createElementNS($d,e)}}const ZC=9,fh=new WeakSet,JC=new Date().getTimezoneOffset()*60*1e3;class zm{static create(e){switch(e.data.annotationType){case Na.LINK:return new Py(e);case Na.TEXT:return new eT(e);case Na.WIDGET:switch(e.data.fieldType){case"Tx":return new tT(e);case"Btn":return e.data.radioButton?new Av(e):e.data.checkBox?new iT(e):new sT(e);case"Ch":return new rT(e);case"Sig":return new nT(e)}return new yh(e);case Na.POPUP:return new cy(e);case Na.FREETEXT:return new Cv(e);case Na.LINE:return new oT(e);case Na.SQUARE:return new lT(e);case Na.CIRCLE:return new cT(e);case Na.POLYLINE:return new Tv(e);case Na.CARET:return new uT(e);case Na.INK:return new Ey(e);case Na.POLYGON:return new dT(e);case Na.HIGHLIGHT:return new _v(e);case Na.UNDERLINE:return new hT(e);case Na.SQUIGGLY:return new fT(e);case Na.STRIKEOUT:return new pT(e);case Na.STAMP:return new kv(e);case Na.FILEATTACHMENT:return new gT(e);default:return new Ir(e)}}}class Ir{#e=null;#t=!1;#i=null;constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:s=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,this.hasOwnCommentButton=!1,t&&(this.contentElement=this.container=this._createContainer(n)),s&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e?.str||t?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Ir._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:e}=this,t=this.annotationStorage?.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const e=this.annotationStorage?.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:n,rect:s}=this.data;let o=-1/0,d=-1/0;if(t?.length>=8){for(let c=0;c<t.length;c+=8)t[c+1]>d?(d=t[c+1],o=t[c+2]):t[c+1]===d&&(o=Math.max(o,t[c+2]));return[o,d]}if(n?.length>=1){for(const c of n)for(let h=0,f=c.length;h<f;h+=2)c[h+1]>d?(d=c[h+1],o=c[h]):c[h+1]===d&&(o=Math.max(o,c[h]));if(o!==1/0)return[o,d]}return s?[s[2],s[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:n,pageHeight:s,pageX:o,pageY:d}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-o)/n,e[1]=100*(e[1]-d)/s,e}get commentText(){const{data:e}=this;return this.annotationStorage.getRawValue(`${yp}${e.id}`)?.popup?.contents||e.contentsObj?.str||""}set commentText(e){const{data:t}=this,n={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:n})||this.annotationStorage.setValue(`${yp}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:n,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){(this.#i?.popup||this.popup)?.remove(),this.#i=this.popup=null}updateEdited(e){if(!this.container)return;e.rect&&(this.#e||={rect:this.data.rect.slice(0)});const{rect:t,popup:n}=e;t&&this.#n(t);let s=this.#i?.popup||this.popup;!s&&n?.text&&(this._createPopup(n),s=this.#i.popup),s&&(s.updateEdited(e),n?.deleted&&(s.remove(),this.#i=null,this.popup=null))}resetEdited(){this.#e&&(this.#n(this.#e.rect),this.#i?.popup.resetEdited(),this.#e=null)}#n(e){const{container:{style:t},data:{rect:n,rotation:s},parent:{viewport:{rawDims:{pageWidth:o,pageHeight:d,pageX:c,pageY:h}}}}=this;n?.splice(0,4,...e),t.left=`${100*(e[0]-c)/o}%`,t.top=`${100*(d-e[3]+h)/d}%`,s===0?(t.width=`${100*(e[2]-e[0])/o}%`,t.height=`${100*(e[3]-e[1])/d}%`):this.setRotation(s)}_createContainer(e){const{data:t,parent:{page:n,viewport:s}}=this,o=document.createElement("section");o.setAttribute("data-annotation-id",t.id),!(this instanceof yh)&&!(this instanceof Py)&&(o.tabIndex=0);const{style:d}=o;if(d.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(o.title=t.alternativeText),t.noRotate&&o.classList.add("norotate"),!t.rect||this instanceof cy){const{rotation:x}=t;return!t.hasOwnCanvas&&x!==0&&this.setRotation(x,o),o}const{width:c,height:h}=this;if(!e&&t.borderStyle.width>0){d.borderWidth=`${t.borderStyle.width}px`;const x=t.borderStyle.horizontalCornerRadius,k=t.borderStyle.verticalCornerRadius;if(x>0||k>0){const $=`calc(${x}px * var(--total-scale-factor)) / calc(${k}px * var(--total-scale-factor))`;d.borderRadius=$}else if(this instanceof Av){const $=`calc(${c}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;d.borderRadius=$}switch(t.borderStyle.style){case sf.SOLID:d.borderStyle="solid";break;case sf.DASHED:d.borderStyle="dashed";break;case sf.BEVELED:hi("Unimplemented border style: beveled");break;case sf.INSET:hi("Unimplemented border style: inset");break;case sf.UNDERLINE:d.borderBottomStyle="solid";break}const N=t.borderColor||null;N?(this.#t=!0,d.borderColor=fn.makeHexColor(N[0]|0,N[1]|0,N[2]|0)):d.borderWidth=0}const f=fn.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:m,pageHeight:b,pageX:S,pageY:v}=s.rawDims;d.left=`${100*(f[0]-S)/m}%`,d.top=`${100*(f[1]-v)/b}%`;const{rotation:P}=t;return t.hasOwnCanvas||P===0?(d.width=`${100*c/m}%`,d.height=`${100*h/b}%`):this.setRotation(P,o),o}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:s}=this.parent.viewport.rawDims;let{width:o,height:d}=this;e%180!==0&&([o,d]=[d,o]),t.style.width=`${100*o/n}%`,t.style.height=`${100*d/s}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,n,s)=>{const o=s.detail[t],d=o[0],c=o.slice(1);s.target.style[n]=Kb[`${d}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[n]:Kb[`${d}_rgb`](c)})};return fi(this,"_commonActions",{display:t=>{const{display:n}=t.detail,s=n%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const s of Object.keys(t.detail))(e[s]||n[s])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[s,o]of Object.entries(t)){const d=n[s];if(d){const c={detail:{[s]:o},target:e};d(c),delete t[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,s,o]=this.data.rect.map(x=>Math.fround(x));if(e.length===8){const[x,k,N,$]=e.subarray(2,6);if(s===x&&o===k&&t===N&&n===$)return}const{style:d}=this.container;let c;if(this.#t){const{borderColor:x,borderWidth:k}=d;d.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${x}" stroke-width="${k}">`],this.container.classList.add("hasBorder")}const h=s-t,f=o-n,{svgFactory:m}=this,b=m.createElement("svg");b.classList.add("quadrilateralsContainer"),b.setAttribute("width",0),b.setAttribute("height",0),b.role="none";const S=m.createElement("defs");b.append(S);const v=m.createElement("clipPath"),P=`clippath_${this.data.id}`;v.setAttribute("id",P),v.setAttribute("clipPathUnits","objectBoundingBox"),S.append(v);for(let x=2,k=e.length;x<k;x+=8){const N=e[x],$=e[x+1],I=e[x+2],z=e[x+3],B=m.createElement("rect"),G=(I-t)/h,te=(o-$)/f,F=(N-I)/h,H=($-z)/f;B.setAttribute("x",G),B.setAttribute("y",te),B.setAttribute("width",F),B.setAttribute("height",H),v.append(B),c?.push(`<rect vector-effect="non-scaling-stroke" x="${G}" y="${te}" width="${F}" height="${H}"/>`)}this.#t&&(c.push("</g></svg>')"),d.backgroundImage=c.join("")),this.container.append(b),this.container.style.clipPath=`url(#${P})`}_createPopup(e=null){const{data:t}=this;let n,s;e?(n={str:e.text},s=e.date):(n=t.contentsObj,s=t.modificationDate),this.#i=new cy({data:{color:t.color,titleObj:t.titleObj,modificationDate:s,contentsObj:n,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#i||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#i}render(){Xs("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const s=this._fieldObjects[e];if(s)for(const{page:o,id:d,exportValues:c}of s){if(o===-1||d===t)continue;const h=typeof c=="string"?c:null,f=document.querySelector(`[data-element-id="${d}"]`);if(f&&!fh.has(f)){hi(`_getElementsByName - element not allowed: ${d}`);continue}n.push({id:d,exportValue:h,domElement:f})}return n}for(const s of document.getElementsByName(e)){const{exportValue:o}=s,d=s.getAttribute("data-element-id");d!==t&&fh.has(s)&&n.push({id:d,exportValue:o,domElement:s})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class QC extends Ir{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&this._createPopup(e.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class Py extends Ir{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let s=!1;return e.url?(t.addLinkAttributes(n,e.url,e.newWindow),s=!0):e.action?(this._bindNamedAction(n,e.action,e.overlaidText),s=!0):e.attachment?(this.#t(n,e.attachment,e.overlaidText,e.attachmentDest),s=!0):e.setOCGState?(this.#i(n,e.setOCGState,e.overlaidText),s=!0):e.dest?(this._bindLink(n,e.dest,e.overlaidText),s=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),s=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(n,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&(this.contentElement=n,this.container.append(n)),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t,n=""){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e(),n&&(e.title=n)}_bindNamedAction(e,t,n=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),n&&(e.title=n),this.#e()}#t(e,t,n="",s=null){e.href=this.linkService.getAnchorUrl(""),t.description?e.title=t.description:n&&(e.title=n),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,s),!1),this.#e()}#i(e,t,n=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),n&&(e.title=n),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(t.actions)){const o=n.get(s);o&&(e[o]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:s}}),!1))}t.overlaidText&&(e.title=t.overlaidText),e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){const n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){hi('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(e.onclick=()=>!1);return}e.onclick=()=>{n?.();const{fields:s,refs:o,include:d}=t,c=[];if(s.length!==0||o.length!==0){const m=new Set(o);for(const b of s){const S=this._fieldObjects[b]||[];for(const{id:v}of S)m.add(v)}for(const b of Object.values(this._fieldObjects))for(const S of b)m.has(S.id)===d&&c.push(S)}else for(const m of Object.values(this._fieldObjects))c.push(...m);const h=this.annotationStorage,f=[];for(const m of c){const{id:b}=m;switch(f.push(b),m.type){case"text":{const v=m.defaultValue||"";h.setValue(b,{value:v});break}case"checkbox":case"radiobutton":{const v=m.defaultValue===m.exportValues;h.setValue(b,{value:v});break}case"combobox":case"listbox":{const v=m.defaultValue||"";h.setValue(b,{value:v});break}default:continue}const S=document.querySelector(`[data-element-id="${b}"]`);if(S){if(!fh.has(S)){hi(`_bindResetFormAction - element not allowed: ${b}`);continue}}else continue;S.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class eT extends Ir{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(e),this.container}}class yh extends Ir{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return No.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,s,o){n.includes("mouse")?e.addEventListener(n,d=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:o(d),shift:d.shiftKey,modifier:this._getKeyModifier(d)}})}):e.addEventListener(n,d=>{if(n==="blur"){if(!t.focused||!d.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}o&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:o(d)}})})}_setEventListeners(e,t,n,s){for(const[o,d]of n)(d==="Action"||this.data.actions?.[d])&&((d==="Focus"||d==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,o,d,s),d==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):d==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":fn.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||ZC,o=e.style;let d;const c=2,h=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-c),m=Math.round(f/(jm*s))||1,b=f/m;d=Math.min(s,h(b/jm))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-c);d=Math.min(s,h(f/jm))}o.fontSize=`calc(${d}px * var(--total-scale-factor))`,o.color=fn.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(o.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class tT extends yh{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,s){const o=this.annotationStorage;for(const d of this._getElementsByName(e.name,e.id))d.domElement&&(d.domElement[t]=n),o.setValue(d.id,{[s]:n})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const s=e.getValue(t,{value:this.data.fieldValue});let o=s.value||"";const d=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;d&&o.length>d&&(o=o.slice(0,d));let c=s.formattedValue||this.data.textContent?.join(`
`)||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=c??o,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",c??o),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),fh.add(n),this.contentElement=n,n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:f,datetimeType:m,timeStep:b}=this.data,S=!!m&&this.enableScripting;f&&(n.title=f),this._setRequired(n,this.data.required),d&&(n.maxLength=d),n.addEventListener("input",P=>{e.setValue(t,{value:P.target.value}),this.setPropertyOnSiblings(n,"value",P.target.value,"value"),h.formattedValue=null}),n.addEventListener("resetform",P=>{const x=this.data.defaultFieldValue??"";n.value=h.userValue=x,h.formattedValue=null});let v=P=>{const{formattedValue:x}=h;x!=null&&(P.target.value=x),P.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",x=>{if(h.focused)return;const{target:k}=x;if(S&&(k.type=m,b&&(k.step=b)),h.userValue){const N=h.userValue;if(S)if(m==="time"){const $=new Date(N),I=[$.getHours(),$.getMinutes(),$.getSeconds()];k.value=I.map(z=>z.toString().padStart(2,"0")).join(":")}else k.value=new Date(N-JC).toISOString().split(m==="date"?"T":".",1)[0];else k.value=N}h.lastCommittedValue=k.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),n.addEventListener("updatefromsandbox",x=>{this.showElementAndHideCanvas(x.target);const k={value(N){h.userValue=N.detail.value??"",S||e.setValue(t,{value:h.userValue.toString()}),N.target.value=h.userValue},formattedValue(N){const{formattedValue:$}=N.detail;h.formattedValue=$,$!=null&&N.target!==document.activeElement&&(N.target.value=$);const I={formattedValue:$};S&&(I.value=$),e.setValue(t,I)},selRange(N){N.target.setSelectionRange(...N.detail.selRange)},charLimit:N=>{const{charLimit:$}=N.detail,{target:I}=N;if($===0){I.removeAttribute("maxLength");return}I.setAttribute("maxLength",$);let z=h.userValue;!z||z.length<=$||(z=z.slice(0,$),I.value=h.userValue=z,e.setValue(t,{value:z}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:z,willCommit:!0,commitKey:1,selStart:I.selectionStart,selEnd:I.selectionEnd}}))}};this._dispatchEventFromSandbox(k,x)}),n.addEventListener("keydown",x=>{h.commitKey=1;let k=-1;if(x.key==="Escape"?k=0:x.key==="Enter"&&!this.data.multiLine?k=2:x.key==="Tab"&&(h.commitKey=3),k===-1)return;const{value:N}=x.target;h.lastCommittedValue!==N&&(h.lastCommittedValue=N,h.userValue=N,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:N,willCommit:!0,commitKey:k,selStart:x.target.selectionStart,selEnd:x.target.selectionEnd}}))});const P=v;v=null,n.addEventListener("blur",x=>{if(!h.focused||!x.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{target:k}=x;let{value:N}=k;if(S){if(N&&m==="time"){const $=N.split(":").map(I=>parseInt(I,10));N=new Date(2e3,0,1,$[0],$[1],$[2]||0).valueOf(),k.step=""}else N.includes("T")||(N=`${N}T00:00`),N=new Date(N).valueOf();k.type="text"}h.userValue=N,h.lastCommittedValue!==N&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:N,willCommit:!0,commitKey:h.commitKey,selStart:x.target.selectionStart,selEnd:x.target.selectionEnd}}),P(x)}),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",x=>{h.lastCommittedValue=null;const{data:k,target:N}=x,{value:$,selectionStart:I,selectionEnd:z}=N;let B=I,G=z;switch(x.inputType){case"deleteWordBackward":{const te=$.substring(0,I).match(/\w*[^\w]*$/);te&&(B-=te[0].length);break}case"deleteWordForward":{const te=$.substring(I).match(/^[^\w]*\w*/);te&&(G+=te[0].length);break}case"deleteContentBackward":I===z&&(B-=1);break;case"deleteContentForward":I===z&&(G+=1);break}x.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:$,change:k||"",willCommit:!1,selStart:B,selEnd:G}})}),this._setEventListeners(n,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],x=>x.target.value)}if(v&&n.addEventListener("blur",v),this.data.comb){const x=(this.data.rect[2]-this.data.rect[0])/d;n.classList.add("comb"),n.style.letterSpacing=`calc(${x}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class nT extends yh{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class iT extends yh{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let s=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",e.setValue(n,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const o=document.createElement("input");return fh.add(o),o.setAttribute("data-element-id",n),o.disabled=t.readOnly,this._setRequired(o,this.data.required),o.type="checkbox",o.name=t.fieldName,s&&o.setAttribute("checked",!0),o.setAttribute("exportValue",t.exportValue),o.tabIndex=0,o.addEventListener("change",d=>{const{name:c,checked:h}=d.target;for(const f of this._getElementsByName(c,n)){const m=h&&f.exportValue===t.exportValue;f.domElement&&(f.domElement.checked=m),e.setValue(f.id,{value:m})}e.setValue(n,{value:h})}),o.addEventListener("resetform",d=>{const c=t.defaultFieldValue||"Off";d.target.checked=c===t.exportValue}),this.enableScripting&&this.hasJSActions&&(o.addEventListener("updatefromsandbox",d=>{const c={value(h){h.target.checked=h.detail.value!=="Off",e.setValue(n,{value:h.target.checked})}};this._dispatchEventFromSandbox(c,d)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],d=>d.target.checked)),this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class Av extends yh{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let s=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof s=="string"&&(s=s!==t.buttonValue,e.setValue(n,{value:s})),s)for(const d of this._getElementsByName(t.fieldName,n))e.setValue(d.id,{value:!1});const o=document.createElement("input");if(fh.add(o),o.setAttribute("data-element-id",n),o.disabled=t.readOnly,this._setRequired(o,this.data.required),o.type="radio",o.name=t.fieldName,s&&o.setAttribute("checked",!0),o.tabIndex=0,o.addEventListener("change",d=>{const{name:c,checked:h}=d.target;for(const f of this._getElementsByName(c,n))e.setValue(f.id,{value:!1});e.setValue(n,{value:h})}),o.addEventListener("resetform",d=>{const c=t.defaultFieldValue;d.target.checked=c!=null&&c===t.buttonValue}),this.enableScripting&&this.hasJSActions){const d=t.buttonValue;o.addEventListener("updatefromsandbox",c=>{const h={value:f=>{const m=d===f.detail.value;for(const b of this._getElementsByName(f.target.name)){const S=m&&b.id===n;b.domElement&&(b.domElement.checked=S),e.setValue(b.id,{value:S})}}};this._dispatchEventFromSandbox(h,c)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class sT extends Py{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}}class rT extends yh{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),s=document.createElement("select");fh.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=0;let o=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",m=>{const b=this.data.defaultFieldValue;for(const S of s.options)S.selected=S.value===b});for(const m of this.data.options){const b=document.createElement("option");b.textContent=m.displayValue,b.value=m.exportValue,n.value.includes(m.exportValue)&&(b.setAttribute("selected",!0),o=!1),s.append(b)}let d=null;if(o){const m=document.createElement("option");m.value=" ",m.setAttribute("hidden",!0),m.setAttribute("selected",!0),s.prepend(m),d=()=>{m.remove(),s.removeEventListener("input",d),d=null},s.addEventListener("input",d)}const c=m=>{const b=m?"value":"textContent",{options:S,multiple:v}=s;return v?Array.prototype.filter.call(S,P=>P.selected).map(P=>P[b]):S.selectedIndex===-1?null:S[S.selectedIndex][b]};let h=c(!1);const f=m=>{const b=m.target.options;return Array.prototype.map.call(b,S=>({displayValue:S.textContent,exportValue:S.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",m=>{const b={value(S){d?.();const v=S.detail.value,P=new Set(Array.isArray(v)?v:[v]);for(const x of s.options)x.selected=P.has(x.value);e.setValue(t,{value:c(!0)}),h=c(!1)},multipleSelection(S){s.multiple=!0},remove(S){const v=s.options,P=S.detail.remove;v[P].selected=!1,s.remove(P),v.length>0&&Array.prototype.findIndex.call(v,k=>k.selected)===-1&&(v[0].selected=!0),e.setValue(t,{value:c(!0),items:f(S)}),h=c(!1)},clear(S){for(;s.length!==0;)s.remove(0);e.setValue(t,{value:null,items:[]}),h=c(!1)},insert(S){const{index:v,displayValue:P,exportValue:x}=S.detail.insert,k=s.children[v],N=document.createElement("option");N.textContent=P,N.value=x,k?k.before(N):s.append(N),e.setValue(t,{value:c(!0),items:f(S)}),h=c(!1)},items(S){const{items:v}=S.detail;for(;s.length!==0;)s.remove(0);for(const P of v){const{displayValue:x,exportValue:k}=P,N=document.createElement("option");N.textContent=x,N.value=k,s.append(N)}s.options.length>0&&(s.options[0].selected=!0),e.setValue(t,{value:c(!0),items:f(S)}),h=c(!1)},indices(S){const v=new Set(S.detail.indices);for(const P of S.target.options)P.selected=v.has(P.index);e.setValue(t,{value:c(!0)}),h=c(!1)},editable(S){S.target.disabled=!S.detail.editable}};this._dispatchEventFromSandbox(b,m)}),s.addEventListener("input",m=>{const b=c(!0),S=c(!1);e.setValue(t,{value:b}),m.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:h,change:S,changeEx:b,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],m=>m.target.value)):s.addEventListener("input",function(m){e.setValue(t,{value:c(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class cy extends Ir{constructor(e){const{data:t,elements:n,parent:s}=e,o=!!s._commentManager;if(super(e,{isRenderable:!o&&Ir._hasPopupData(t)}),this.elements=n,o&&Ir._hasPopupData(t)){const d=this.popup=this.#e();for(const c of n)c.popup=d}else this.popup=null}#e(){return new aT({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=this.#e(),n=[];for(const s of this.elements)s.popup=t,s.container.ariaHasPopup="dialog",n.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(s=>`${lf}${s}`).join(",")),this.container}}class aT{#e=null;#t=this.#V.bind(this);#i=this.#O.bind(this);#n=this.#D.bind(this);#a=this.#S.bind(this);#r=null;#s=null;#o=null;#c=null;#l=null;#h=null;#u=null;#f=!1;#m=null;#g=null;#d=null;#p=null;#y=null;#b=null;#x=null;#T=null;#A=null;#w=null;#k=!1;#v=null;#C=null;constructor({container:e,color:t,elements:n,titleObj:s,modificationDate:o,contentsObj:d,richText:c,parent:h,rect:f,parentRect:m,open:b,commentManager:S=null}){this.#s=e,this.#A=s,this.#o=d,this.#T=c,this.#h=h,this.#r=t,this.#x=f,this.#u=m,this.#l=n,this.#e=S,this.#v=n[0],this.#c=ny.toDateObject(o),this.trigger=n.flatMap(v=>v.getElementsToTriggerPopup()),S||(this.#P(),this.#s.hidden=!0,b&&this.#S())}#P(){if(this.#g)return;this.#g=new AbortController;const{signal:e}=this.#g;for(const t of this.trigger)t.addEventListener("click",this.#a,{signal:e}),t.addEventListener("pointerenter",this.#n,{signal:e}),t.addEventListener("pointerleave",this.#i,{signal:e}),t.classList.add("popupTriggerArea");for(const t of this.#l)t.container?.addEventListener("keydown",this.#t,{signal:e})}#N(){const e=this.#l.find(t=>t.hasCommentButton);e&&(this.#y=e._normalizePoint(e.commentButtonPosition))}renderCommentButton(){if(this.#p){this.#p.parentNode||this.#v.container.after(this.#p);return}if(this.#y||this.#N(),!this.#y)return;const{signal:e}=this.#g=new AbortController,t=this.#v.hasOwnCommentButton,n=()=>{this.#e.toggleCommentPopup(this,!0,void 0,!t)},s=()=>{this.#e.toggleCommentPopup(this,!1,!0,!t)},o=()=>{this.#e.toggleCommentPopup(this,!1,!1)};if(t){this.#p=this.#v.container;for(const d of this.trigger)d.ariaHasPopup="dialog",d.ariaControls="commentPopup",d.addEventListener("keydown",this.#t,{signal:e}),d.addEventListener("click",n,{signal:e}),d.addEventListener("pointerenter",s,{signal:e}),d.addEventListener("pointerleave",o,{signal:e}),d.classList.add("popupTriggerArea")}else{const d=this.#p=document.createElement("button");d.className="annotationCommentButton";const c=this.#v.container;d.style.zIndex=c.style.zIndex+1,d.tabIndex=0,d.ariaHasPopup="dialog",d.ariaControls="commentPopup",d.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#z(),this.#j(),d.addEventListener("keydown",this.#t,{signal:e}),d.addEventListener("click",n,{signal:e}),d.addEventListener("pointerenter",s,{signal:e}),d.addEventListener("pointerleave",o,{signal:e}),c.after(d)}}#j(){if(this.#v.extraPopupElement&&!this.#v.editor)return;this.#p||this.renderCommentButton();const[e,t]=this.#y,{style:n}=this.#p;n.left=`calc(${e}%)`,n.top=`calc(${t}% - var(--comment-button-dim))`}#z(){this.#v.extraPopupElement||(this.#p||this.renderCommentButton(),this.#p.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:e,opacity:t}=this.#v.commentData;return e?this.#h._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{this.#p?.focus()},0)}getData(){const{richText:e,color:t,opacity:n,creationDate:s,modificationDate:o}=this.#v.commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:n,creationDate:s,modificationDate:o}}get elementBeforePopup(){return this.#p}get comment(){return this.#C||=this.#v.commentText,this.#C}set comment(e){e!==this.comment&&(this.#v.commentText=this.#C=e)}focus(){this.#v.container?.focus()}get parentBoundingClientRect(){return this.#v.layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){this.#p&&(this.#p.classList.toggle("selected",e),this.#p.ariaExpanded=t)}setSelectedCommentButton(e){this.#p.classList.toggle("selected",e)}get commentPopupPosition(){if(this.#b)return this.#b;const{x:e,y:t,height:n}=this.#p.getBoundingClientRect(),{x:s,y:o,width:d,height:c}=this.#v.layer.getBoundingClientRect();return[(e-s)/d,(t+n-o)/c]}set commentPopupPosition(e){this.#b=e}hasDefaultPopupPosition(){return this.#b===null}get commentButtonPosition(){return this.#y}get commentButtonWidth(){return this.#p.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,n]=this.#b||this.commentButtonPosition.map(f=>f/100),s=this.parentBoundingClientRect,{x:o,y:d,width:c,height:h}=s;this.#e.showDialog(null,this,o+t*c,d+n*h,{...e,parentDimensions:s})}render(){if(this.#m)return;const e=this.#m=document.createElement("div");if(e.className="popup",this.#r){const n=e.style.outlineColor=fn.makeHexColor(...this.#r);e.style.backgroundColor=`color-mix(in srgb, ${n} 30%, white)`}const t=document.createElement("span");if(t.className="header",this.#A?.str){const n=document.createElement("span");n.className="title",t.append(n),{dir:n.dir,str:n.textContent}=this.#A}if(e.append(t),this.#c){const n=document.createElement("time");n.className="popupDate",n.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),n.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),n.dateTime=this.#c.toISOString(),t.append(n)}tv({html:this.#R||this.#o.str,dir:this.#o?.dir,className:"popupContent"},e),this.#s.append(e)}get#R(){const e=this.#T,t=this.#o;return e?.str&&(!t?.str||t.str===e.str)&&this.#T.html||null}get#L(){return this.#R?.attributes?.style?.fontSize||0}get#B(){return this.#R?.attributes?.style?.color||null}#M(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},s={style:{color:this.#B,fontSize:this.#L?`calc(${this.#L}px * var(--total-scale-factor))`:""}};for(const o of e.split(`
`))t.push({name:"span",value:o,attributes:s});return n}#V(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#f)&&this.#S()}updateEdited({rect:e,popup:t,deleted:n}){if(this.#e){n?(this.remove(),this.#C=null):t&&(t.deleted?this.remove():(this.#z(),this.#C=t.text)),e&&(this.#y=null,this.#N(),this.#j());return}if(n||t?.deleted){this.remove();return}this.#P(),this.#w||={contentsObj:this.#o,richText:this.#T},e&&(this.#d=null),t&&t.text&&(this.#T=this.#M(t.text),this.#c=ny.toDateObject(t.date),this.#o=null),this.#m?.remove(),this.#m=null}resetEdited(){this.#w&&({contentsObj:this.#o,richText:this.#T}=this.#w,this.#w=null,this.#m?.remove(),this.#m=null,this.#d=null)}remove(){if(this.#g?.abort(),this.#g=null,this.#m?.remove(),this.#m=null,this.#k=!1,this.#f=!1,this.#p?.remove(),this.#p=null,this.trigger)for(const e of this.trigger)e.classList.remove("popupTriggerArea")}#_(){if(this.#d!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:s,pageY:o}}}=this.#h;let d=!!this.#u,c=d?this.#u:this.#x;for(const P of this.#l)if(!c||fn.intersect(P.data.rect,c)!==null){c=P.data.rect,d=!0;break}const h=fn.normalizeRect([c[0],e[3]-c[1]+e[1],c[2],e[3]-c[3]+e[1]]),m=d?c[2]-c[0]+5:0,b=h[0]+m,S=h[1];this.#d=[100*(b-s)/t,100*(S-o)/n];const{style:v}=this.#s;v.left=`${this.#d[0]}%`,v.top=`${this.#d[1]}%`}#S(){if(this.#e){this.#e.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#D(),this.#s.addEventListener("click",this.#a),this.#s.addEventListener("keydown",this.#t)):(this.#O(),this.#s.removeEventListener("click",this.#a),this.#s.removeEventListener("keydown",this.#t))}#D(){this.#m||this.render(),this.isVisible?this.#f&&this.#s.classList.add("focused"):(this.#_(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#O(){this.#s.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#k=this.isVisible,this.#k&&(this.#s.hidden=!0)}maybeShow(){this.#e||(this.#P(),this.#k&&(this.#m||this.#D(),this.#k=!1,this.#s.hidden=!1))}get isVisible(){return this.#e?!1:this.#s.hidden===!1}}class Cv extends Ir{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=yi.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=this.contentElement=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class oT extends Ir{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:e,width:t,height:n}=this,s=this.svgFactory.create(t,n,!0),o=this.#e=this.svgFactory.createElement("svg:line");return o.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),o.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),o.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),o.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),o.setAttribute("stroke-width",e.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class lT extends Ir{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:e,width:t,height:n}=this,s=this.svgFactory.create(t,n,!0),o=e.borderStyle.width,d=this.#e=this.svgFactory.createElement("svg:rect");return d.setAttribute("x",o/2),d.setAttribute("y",o/2),d.setAttribute("width",t-o),d.setAttribute("height",n-o),d.setAttribute("stroke-width",o||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),s.append(d),this.container.append(s),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class cT extends Ir{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:e,width:t,height:n}=this,s=this.svgFactory.create(t,n,!0),o=e.borderStyle.width,d=this.#e=this.svgFactory.createElement("svg:ellipse");return d.setAttribute("cx",t/2),d.setAttribute("cy",n/2),d.setAttribute("rx",t/2-o/2),d.setAttribute("ry",n/2-o/2),d.setAttribute("stroke-width",o||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),s.append(d),this.container.append(s),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Tv extends Ir{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:n,popupRef:s},width:o,height:d}=this;if(!t)return this.container;const c=this.svgFactory.create(o,d,!0);let h=[];for(let m=0,b=t.length;m<b;m+=2){const S=t[m]-e[0],v=e[3]-t[m+1];h.push(`${S},${v}`)}h=h.join(" ");const f=this.#e=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",h),f.setAttribute("stroke-width",n.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),c.append(f),this.container.append(c),!s&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class dT extends Tv{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class uT extends Ir{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class Ey extends Ir{#e=null;#t=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?yi.HIGHLIGHT:yi.INK}#i(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:n,borderStyle:s,popupRef:o}}=this,{transform:d,width:c,height:h}=this.#i(t,e),f=this.svgFactory.create(c,h,!0),m=this.#e=this.svgFactory.createElement("svg:g");f.append(m),m.setAttribute("stroke-width",s.width||1),m.setAttribute("stroke-linecap","round"),m.setAttribute("stroke-linejoin","round"),m.setAttribute("stroke-miterlimit",10),m.setAttribute("stroke","transparent"),m.setAttribute("fill","transparent"),m.setAttribute("transform",d);for(let b=0,S=n.length;b<S;b++){const v=this.svgFactory.createElement(this.svgElementName);this.#t.push(v),v.setAttribute("points",n[b].join(",")),m.append(v)}return!o&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:n,rect:s}=e,o=this.#e;if(t>=0&&o.setAttribute("stroke-width",t||1),n)for(let d=0,c=this.#t.length;d<c;d++)this.#t[d].setAttribute("points",n[d].join(","));if(s){const{transform:d,width:c,height:h}=this.#i(this.data.rotation,s);o.parentElement.setAttribute("viewBox",`0 0 ${c} ${h}`),o.setAttribute("transform",d)}}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class _v extends Ir{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=yi.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class hT extends Ir{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class fT extends Ir{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class pT extends Ir{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),e){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class kv extends Ir{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=yi.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class gT extends Ir{#e=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let n;t.hasAppearance||t.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),n.addEventListener("dblclick",this.#t.bind(this)),this.#e=n;const{isMac:s}=No.platform;return e.addEventListener("keydown",o=>{o.key==="Enter"&&(s?o.metaKey:o.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class Ry{#e=null;#t=null;#i=null;#n=new Map;#a=null;#r=null;#s=[];#o=!1;constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:s,page:o,viewport:d,structTreeLayer:c,commentManager:h,linkService:f,annotationStorage:m}){this.div=e,this.#e=t,this.#t=n,this.#a=c||null,this.#r=f||null,this.#i=m||new Ty,this.page=o,this.viewport=d,this.zIndex=0,this._annotationEditorUIManager=s,this._commentManager=h||null}hasEditableAnnotations(){return this.#n.size>0}async render(e){const{annotations:t}=e,n=this.div;hh(n,this.viewport);const s=new Map,o=[],d={data:null,layer:n,linkService:this.#r,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new t0,annotationStorage:this.#i,enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const c of t){if(c.noHTML)continue;const h=c.annotationType===Na.POPUP;if(h){const b=s.get(c.id);if(!b)continue;if(!this._commentManager){o.push(c);continue}d.elements=b}else if(c.rect[2]===c.rect[0]||c.rect[3]===c.rect[1])continue;d.data=c;const f=zm.create(d);if(!f.isRenderable)continue;if(!h&&(this.#s.push(f),c.popupRef)){const b=s.get(c.popupRef);b?b.push(f):s.set(c.popupRef,[f])}const m=f.render();c.hidden&&(m.style.visibility="hidden"),f._isEditable&&(this.#n.set(f.data.id,f),this._annotationEditorUIManager?.renderAnnotationElement(f))}await this.#c();for(const c of o){const h=d.elements=s.get(c.id);d.data=c;const f=zm.create(d);if(!f.isRenderable)continue;const m=f.render();f.contentElement.id=`${lf}${c.id}`,c.hidden&&(m.style.visibility="hidden"),h.at(-1).container.after(m)}this.#l()}async#c(){if(this.#s.length===0)return;this.div.replaceChildren();const e=[];if(!this.#o){this.#o=!0;for(const{contentElement:n,data:{id:s}}of this.#s){const o=n.id=`${lf}${s}`;e.push(this.#a?.getAriaAttributes(o).then(d=>{if(d)for(const[c,h]of d)n.setAttribute(c,h)}))}}this.#s.sort(({data:{rect:[n,s,o,d]}},{data:{rect:[c,h,f,m]}})=>{if(n===o&&s===d)return 1;if(c===f&&h===m)return-1;const b=d,S=s,v=(s+d)/2,P=m,x=h,k=(h+m)/2;if(v>=P&&k<=S)return-1;if(k>=b&&v<=x)return 1;const N=(n+o)/2,$=(c+f)/2;return N-$});const t=document.createDocumentFragment();for(const n of this.#s)t.append(n.container),this._commentManager?(n.extraPopupElement?.popup||n.popup)?.renderCommentButton():n.extraPopupElement&&t.append(n.extraPopupElement.render());if(this.div.append(t),await Promise.all(e),this.#e)for(const n of this.#s)this.#e.addPointerInTextLayer(n.contentElement,!1)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:this.#r,svgFactory:new t0,parent:this};for(const n of e){n.borderStyle||=Ry._defaultBorderStyle,t.data=n;const s=zm.create(t);s.isRenderable&&(s.render(),s.contentElement.id=`${lf}${n.id}`,this.#s.push(s))}await this.#c()}update({viewport:e}){const t=this.div;this.viewport=e,hh(t,{rotation:e.rotation}),this.#l(),t.hidden=!1}#l(){if(!this.#t)return;const e=this.div;for(const[t,n]of this.#t){const s=e.querySelector(`[data-annotation-id="${t}"]`);if(!s)continue;n.className="annotationContent";const{firstChild:o}=s;o?o.nodeName==="CANVAS"?o.replaceWith(n):o.classList.contains("annotationContent")?o.after(n):o.before(n):s.append(n);const d=this.#n.get(t);d&&(d._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(t,s.id,n),d._hasNoCanvas=!1):d.canvas=n)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(e){return this.#n.get(e)}addFakeAnnotation(e){const{div:t}=this,{id:n,rotation:s}=e,o=new QC({data:{id:n,rect:e.getPDFRect(),rotation:s},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:this.#r,annotationStorage:this.#i});return o.render(),o.contentElement.id=`${lf}${n}`,o.createOrUpdatePopup(),this.#s.push(o),o}removeAnnotation(e){const t=this.#s.findIndex(s=>s.data.id===e);if(t<0)return;const[n]=this.#s.splice(t,1);this.#e?.removePointerInTextLayer(n.contentElement)}updateFakeAnnotations(e){if(e.length!==0){for(const t of e)t.updateFakeAnnotationElement(this);this.#c()}}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}static get _defaultBorderStyle(){return fi(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:sf.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const zg=/\r\n?|\n/g;class oo extends In{#e="";#t=`${this.id}-editor`;#i=null;#n;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=oo.prototype,t=o=>o.isEmpty(),n=Iu.TRANSLATE_SMALL,s=Iu.TRANSLATE_BIG;return fi(this,"_keyboardManager",new Np([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[s,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,s],checker:t}]]))}static _type="freetext";static _editorType=yi.FREETEXT;constructor(e){super({...e,name:"freeTextEditor"}),this.color=e.color||oo._defaultColor||In._defaultLineColor,this.#n=e.fontSize||oo._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(e,t){In.initialize(e,t);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case Ki.FREETEXT_SIZE:oo._defaultFontSize=t;break;case Ki.FREETEXT_COLOR:oo._defaultColor=t;break}}updateParams(e,t){switch(e){case Ki.FREETEXT_SIZE:this.#a(t);break;case Ki.FREETEXT_COLOR:this.#r(t);break}}static get defaultPropertiesToUpdate(){return[[Ki.FREETEXT_SIZE,oo._defaultFontSize],[Ki.FREETEXT_COLOR,oo._defaultColor||In._defaultLineColor]]}get propertiesToUpdate(){return[[Ki.FREETEXT_SIZE,this.#n],[Ki.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new wp(this),[["colorPicker",this._colorPicker]]}get colorType(){return Ki.FREETEXT_COLOR}#a(e){const t=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--total-scale-factor))`,this.translate(0,-(s-this.#n)*this.parentScale),this.#n=s,this.#o()},n=this.#n;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ki.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#r(e){const t=s=>{this.color=s,this.onUpdatedColor()},n=this.color;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ki.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-oo._internalPadding*e,-(oo._internalPadding+this.#n)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const e=this._uiManager.combinedSignal(this.#i);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#t),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#s(){const e=[];this.editorDiv.normalize();let t=null;for(const n of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&n.nodeName==="BR"||(e.push(oo.#c(n)),t=n);return e.join(`
`)}#o(){const[e,t]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:s,div:o}=this,d=o.style.display,c=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",s.div.append(this.div),n=o.getBoundingClientRect(),o.remove(),o.style.display=d,o.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=n.width/e,this.height=n.height/t):(this.width=n.height/e,this.height=n.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#e,t=this.#e=this.#s().trimEnd();if(e===t)return;const n=s=>{if(this.#e=s,!s){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{n(t)},undo:()=>{n(e)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){oo._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,t;(this._isCopy||this.annotationElementId)&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#t),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,n.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[s,o]=this.parentDimensions;if(this.annotationElementId){const{position:d}=this._initialData;let[c,h]=this.getInitialTranslation();[c,h]=this.pageTranslationToScreen(c,h);const[f,m]=this.pageDimensions,[b,S]=this.pageTranslation;let v,P;switch(this.rotation){case 0:v=e+(d[0]-b)/f,P=t+this.height-(d[1]-S)/m;break;case 90:v=e+(d[0]-b)/f,P=t-(d[1]-S)/m,[c,h]=[h,-c];break;case 180:v=e-this.width+(d[0]-b)/f,P=t-(d[1]-S)/m,[c,h]=[-c,-h];break;case 270:v=e+(d[0]-b-this.height*m)/f,P=t+(d[1]-S-this.width*f)/m,[c,h]=[-h,c];break}this.setAt(v*s,P*o,c,h)}else this._moveAfterPaste(e,t);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(zg,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:n}=t;if(n.length===1&&n[0]==="text/plain")return;e.preventDefault();const s=oo.#u(t.getData("text")||"").replaceAll(zg,`
`);if(!s)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const d=o.getRangeAt(0);if(!s.includes(`
`)){d.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:c,startOffset:h}=d,f=[],m=[];if(c.nodeType===Node.TEXT_NODE){const v=c.parentElement;if(m.push(c.nodeValue.slice(h).replaceAll(zg,"")),v!==this.editorDiv){let P=f;for(const x of this.editorDiv.childNodes){if(x===v){P=m;continue}P.push(oo.#c(x))}}f.push(c.nodeValue.slice(0,h).replaceAll(zg,""))}else if(c===this.editorDiv){let v=f,P=0;for(const x of this.editorDiv.childNodes)P++===h&&(v=m),v.push(oo.#c(x))}this.#e=`${f.join(`
`)}${s}${m.join(`
`)}`,this.#l();const b=new Range;let S=Math.sumPrecise(f.map(v=>v.length));for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const P=v.nodeValue.length;if(S<=P){b.setStart(v,S),b.setEnd(v,S);break}S-=P}o.removeAllRanges(),o.addRange(b)}#l(){if(this.editorDiv.replaceChildren(),!!this.#e)for(const e of this.#e.split(`
`)){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#h(){return this.#e.replaceAll(""," ")}static#u(e){return e.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const e=oo._internalPadding*this.parentScale;return this.getRect(e,e)}static async deserialize(e,t,n){let s=null;if(e instanceof Cv){const{data:{defaultAppearanceData:{fontSize:d,fontColor:c},rect:h,rotation:f,id:m,popupRef:b,richText:S,contentsObj:v,creationDate:P,modificationDate:x},textContent:k,textPosition:N,parent:{page:{pageNumber:$}}}=e;if(!k||k.length===0)return null;s=e={annotationType:yi.FREETEXT,color:Array.from(c),fontSize:d,value:k.join(`
`),position:N,pageIndex:$-1,rect:h.slice(0),rotation:f,annotationElementId:m,id:m,deleted:!1,popupRef:b,comment:v?.str||null,richText:S,creationDate:P,modificationDate:x}}const o=await super.deserialize(e,t,n);return o.#n=e.fontSize,o.color=fn.makeHexColor(...e.color),o.#e=oo.#u(e.value),o._initialData=s,e.comment&&o.setCommentData(e),o}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=In._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),n=Object.assign(super.serialize(e),{color:t,fontSize:this.#n,value:this.#h()});return this.addComment(n),e?(n.isCopy=!0,n):this.annotationElementId&&!this.#f(n)?null:(n.id=this.annotationElementId,n)}#f(e){const{value:t,fontSize:n,color:s,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||e.value!==t||e.fontSize!==n||e.color.some((d,c)=>d!==s[c])||e.pageIndex!==o}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(!t)return null;const{style:n}=t;n.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,n.color=this.color,t.replaceChildren();for(const s of this.#e.split(`
`)){const o=document.createElement("div");o.append(s?document.createTextNode(s):document.createElement("br")),t.append(o)}return e.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#e}}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class cn{static PRECISION=1e-4;toSVGPath(){Xs("Abstract method `toSVGPath` must be implemented.")}get box(){Xs("Abstract getter `box` must be implemented.")}serialize(e,t){Xs("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,s,o,d){d||=new Float32Array(e.length);for(let c=0,h=e.length;c<h;c+=2)d[c]=t+e[c]*s,d[c+1]=n+e[c+1]*o;return d}static _rescaleAndSwap(e,t,n,s,o,d){d||=new Float32Array(e.length);for(let c=0,h=e.length;c<h;c+=2)d[c]=t+e[c+1]*s,d[c+1]=n+e[c]*o;return d}static _translate(e,t,n,s){s||=new Float32Array(e.length);for(let o=0,d=e.length;o<d;o+=2)s[o]=t+e[o],s[o+1]=n+e[o+1];return s}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,n,s,o){switch(o){case 90:return[1-t/n,e/s];case 180:return[1-e/n,1-t/s];case 270:return[t/n,1-e/s];default:return[e/n,t/s]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,s,o,d){return[(e+5*n)/6,(t+5*s)/6,(5*n+o)/6,(5*s+d)/6,(n+o)/2,(s+d)/2]}}class rh{#e;#t=[];#i;#n;#a=[];#r=new Float32Array(18);#s;#o;#c;#l;#h;#u;#f=[];static#m=8;static#g=2;static#d=rh.#m+rh.#g;constructor({x:e,y:t},n,s,o,d,c=0){this.#e=n,this.#u=o*s,this.#n=d,this.#r.set([NaN,NaN,NaN,NaN,e,t],6),this.#i=c,this.#l=rh.#m*s,this.#c=rh.#d*s,this.#h=s,this.#f.push(e,t)}isEmpty(){return isNaN(this.#r[8])}#p(){const e=this.#r.subarray(4,6),t=this.#r.subarray(16,18),[n,s,o,d]=this.#e;return[(this.#s+(e[0]-t[0])/2-n)/o,(this.#o+(e[1]-t[1])/2-s)/d,(this.#s+(t[0]-e[0])/2-n)/o,(this.#o+(t[1]-e[1])/2-s)/d]}add({x:e,y:t}){this.#s=e,this.#o=t;const[n,s,o,d]=this.#e;let[c,h,f,m]=this.#r.subarray(8,12);const b=e-f,S=t-m,v=Math.hypot(b,S);if(v<this.#c)return!1;const P=v-this.#l,x=P/v,k=x*b,N=x*S;let $=c,I=h;c=f,h=m,f+=k,m+=N,this.#f?.push(e,t);const z=-N/P,B=k/P,G=z*this.#u,te=B*this.#u;return this.#r.set(this.#r.subarray(2,8),0),this.#r.set([f+G,m+te],4),this.#r.set(this.#r.subarray(14,18),12),this.#r.set([f-G,m-te],16),isNaN(this.#r[6])?(this.#a.length===0&&(this.#r.set([c+G,h+te],2),this.#a.push(NaN,NaN,NaN,NaN,(c+G-n)/o,(h+te-s)/d),this.#r.set([c-G,h-te],14),this.#t.push(NaN,NaN,NaN,NaN,(c-G-n)/o,(h-te-s)/d)),this.#r.set([$,I,c,h,f,m],6),!this.isEmpty()):(this.#r.set([$,I,c,h,f,m],6),Math.abs(Math.atan2(I-h,$-c)-Math.atan2(N,k))<Math.PI/2?([c,h,f,m]=this.#r.subarray(2,6),this.#a.push(NaN,NaN,NaN,NaN,((c+f)/2-n)/o,((h+m)/2-s)/d),[c,h,$,I]=this.#r.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,(($+c)/2-n)/o,((I+h)/2-s)/d),!0):([$,I,c,h,f,m]=this.#r.subarray(0,6),this.#a.push((($+5*c)/6-n)/o,((I+5*h)/6-s)/d,((5*c+f)/6-n)/o,((5*h+m)/6-s)/d,((c+f)/2-n)/o,((h+m)/2-s)/d),[f,m,c,h,$,I]=this.#r.subarray(12,18),this.#t.push((($+5*c)/6-n)/o,((I+5*h)/6-s)/d,((5*c+f)/6-n)/o,((5*h+m)/6-s)/d,((c+f)/2-n)/o,((h+m)/2-s)/d),!0))}toSVGPath(){if(this.isEmpty())return"";const e=this.#a,t=this.#t;if(isNaN(this.#r[6])&&!this.isEmpty())return this.#y();const n=[];n.push(`M${e[4]} ${e[5]}`);for(let s=6;s<e.length;s+=6)isNaN(e[s])?n.push(`L${e[s+4]} ${e[s+5]}`):n.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);this.#x(n);for(let s=t.length-6;s>=6;s-=6)isNaN(t[s])?n.push(`L${t[s+4]} ${t[s+5]}`):n.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);return this.#b(n),n.join(" ")}#y(){const[e,t,n,s]=this.#e,[o,d,c,h]=this.#p();return`M${(this.#r[2]-e)/n} ${(this.#r[3]-t)/s} L${(this.#r[4]-e)/n} ${(this.#r[5]-t)/s} L${o} ${d} L${c} ${h} L${(this.#r[16]-e)/n} ${(this.#r[17]-t)/s} L${(this.#r[14]-e)/n} ${(this.#r[15]-t)/s} Z`}#b(e){const t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#x(e){const[t,n,s,o]=this.#e,d=this.#r.subarray(4,6),c=this.#r.subarray(16,18),[h,f,m,b]=this.#p();e.push(`L${(d[0]-t)/s} ${(d[1]-n)/o} L${h} ${f} L${m} ${b} L${(c[0]-t)/s} ${(c[1]-n)/o}`)}newFreeDrawOutline(e,t,n,s,o,d){return new Nv(e,t,n,s,o,d)}getOutlines(){const e=this.#a,t=this.#t,n=this.#r,[s,o,d,c]=this.#e,h=new Float32Array((this.#f?.length??0)+2);for(let b=0,S=h.length-2;b<S;b+=2)h[b]=(this.#f[b]-s)/d,h[b+1]=(this.#f[b+1]-o)/c;if(h[h.length-2]=(this.#s-s)/d,h[h.length-1]=(this.#o-o)/c,isNaN(n[6])&&!this.isEmpty())return this.#T(h);const f=new Float32Array(this.#a.length+24+this.#t.length);let m=e.length;for(let b=0;b<m;b+=2){if(isNaN(e[b])){f[b]=f[b+1]=NaN;continue}f[b]=e[b],f[b+1]=e[b+1]}m=this.#w(f,m);for(let b=t.length-6;b>=6;b-=6)for(let S=0;S<6;S+=2){if(isNaN(t[b+S])){f[m]=f[m+1]=NaN,m+=2;continue}f[m]=t[b+S],f[m+1]=t[b+S+1],m+=2}return this.#A(f,m),this.newFreeDrawOutline(f,h,this.#e,this.#h,this.#i,this.#n)}#T(e){const t=this.#r,[n,s,o,d]=this.#e,[c,h,f,m]=this.#p(),b=new Float32Array(36);return b.set([NaN,NaN,NaN,NaN,(t[2]-n)/o,(t[3]-s)/d,NaN,NaN,NaN,NaN,(t[4]-n)/o,(t[5]-s)/d,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,f,m,NaN,NaN,NaN,NaN,(t[16]-n)/o,(t[17]-s)/d,NaN,NaN,NaN,NaN,(t[14]-n)/o,(t[15]-s)/d],0),this.newFreeDrawOutline(b,e,this.#e,this.#h,this.#i,this.#n)}#A(e,t){const n=this.#t;return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+=6}#w(e,t){const n=this.#r.subarray(4,6),s=this.#r.subarray(16,18),[o,d,c,h]=this.#e,[f,m,b,S]=this.#p();return e.set([NaN,NaN,NaN,NaN,(n[0]-o)/c,(n[1]-d)/h,NaN,NaN,NaN,NaN,f,m,NaN,NaN,NaN,NaN,b,S,NaN,NaN,NaN,NaN,(s[0]-o)/c,(s[1]-d)/h],t),t+=24}}class Nv extends cn{#e;#t=new Float32Array(4);#i;#n;#a;#r;#s;constructor(e,t,n,s,o,d){super(),this.#s=e,this.#a=t,this.#e=n,this.#r=s,this.#i=o,this.#n=d,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(d);const[c,h,f,m]=this.#t;for(let b=0,S=e.length;b<S;b+=2)e[b]=(e[b]-c)/f,e[b+1]=(e[b+1]-h)/m;for(let b=0,S=t.length;b<S;b+=2)t[b]=(t[b]-c)/f,t[b+1]=(t[b+1]-h)/m}toSVGPath(){const e=[`M${this.#s[4]} ${this.#s[5]}`];for(let t=6,n=this.#s.length;t<n;t+=6){if(isNaN(this.#s[t])){e.push(`L${this.#s[t+4]} ${this.#s[t+5]}`);continue}e.push(`C${this.#s[t]} ${this.#s[t+1]} ${this.#s[t+2]} ${this.#s[t+3]} ${this.#s[t+4]} ${this.#s[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,n,s],o){const d=n-e,c=s-t;let h,f;switch(o){case 0:h=cn._rescale(this.#s,e,s,d,-c),f=cn._rescale(this.#a,e,s,d,-c);break;case 90:h=cn._rescaleAndSwap(this.#s,e,t,d,c),f=cn._rescaleAndSwap(this.#a,e,t,d,c);break;case 180:h=cn._rescale(this.#s,n,t,-d,c),f=cn._rescale(this.#a,n,t,-d,c);break;case 270:h=cn._rescaleAndSwap(this.#s,n,s,-d,-c),f=cn._rescaleAndSwap(this.#a,n,s,-d,-c);break}return{outline:Array.from(h),points:[Array.from(f)]}}#o(e){const t=this.#s;let n=t[4],s=t[5];const o=[n,s,n,s];let d=n,c=s,h=n,f=s;const m=e?Math.max:Math.min,b=new Float32Array(4);for(let v=6,P=t.length;v<P;v+=6){const x=t[v+4],k=t[v+5];isNaN(t[v])?(fn.pointBoundingBox(x,k,o),c>k?(d=x,c=k):c===k&&(d=m(d,x)),f<k?(h=x,f=k):f===k&&(h=m(h,x))):(b[0]=b[1]=1/0,b[2]=b[3]=-1/0,fn.bezierBoundingBox(n,s,...t.slice(v,v+6),b),fn.rectBoundingBox(b[0],b[1],b[2],b[3],o),c>b[1]?(d=b[0],c=b[1]):c===b[1]&&(d=m(d,b[0])),f<b[3]?(h=b[2],f=b[3]):f===b[3]&&(h=m(h,b[2]))),n=x,s=k}const S=this.#t;S[0]=o[0]-this.#i,S[1]=o[1]-this.#i,S[2]=o[2]-o[0]+2*this.#i,S[3]=o[3]-o[1]+2*this.#i,this.firstPoint=[d,c],this.lastPoint=[h,f]}get box(){return this.#t}newOutliner(e,t,n,s,o,d=0){return new rh(e,t,n,s,o,d)}getNewOutline(e,t){const[n,s,o,d]=this.#t,[c,h,f,m]=this.#e,b=o*f,S=d*m,v=n*f+c,P=s*m+h,x=this.newOutliner({x:this.#a[0]*b+v,y:this.#a[1]*S+P},this.#e,this.#r,e,this.#n,t??this.#i);for(let k=2;k<this.#a.length;k+=2)x.add({x:this.#a[k]*b+v,y:this.#a[k+1]*S+P});return x.getOutlines()}}class dy{#e;#t;#i;#n=[];#a=[];constructor(e,t=0,n=0,s=!0){const o=[1/0,1/0,-1/0,-1/0],d=10**-4;for(const{x,y:k,width:N,height:$}of e){const I=Math.floor((x-t)/d)*d,z=Math.ceil((x+N+t)/d)*d,B=Math.floor((k-t)/d)*d,G=Math.ceil((k+$+t)/d)*d,te=[I,B,G,!0],F=[z,B,G,!1];this.#n.push(te,F),fn.rectBoundingBox(I,B,z,G,o)}const c=o[2]-o[0]+2*n,h=o[3]-o[1]+2*n,f=o[0]-n,m=o[1]-n;let b=s?-1/0:1/0,S=1/0;const v=this.#n.at(s?-1:-2),P=[v[0],v[2]];for(const x of this.#n){const[k,N,$,I]=x;!I&&s?N<S?(S=N,b=k):N===S&&(b=Math.max(b,k)):I&&!s&&(N<S?(S=N,b=k):N===S&&(b=Math.min(b,k))),x[0]=(k-f)/c,x[1]=(N-m)/h,x[2]=($-m)/h}this.#e=new Float32Array([f,m,c,h]),this.#t=[b,S],this.#i=P}getOutlines(){this.#n.sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);const e=[];for(const t of this.#n)t[3]?(e.push(...this.#l(t)),this.#o(t)):(this.#c(t),e.push(...this.#l(t)));return this.#r(e)}#r(e){const t=[],n=new Set;for(const d of e){const[c,h,f]=d;t.push([c,h,d],[c,f,d])}t.sort((d,c)=>d[1]-c[1]||d[0]-c[0]);for(let d=0,c=t.length;d<c;d+=2){const h=t[d][2],f=t[d+1][2];h.push(f),f.push(h),n.add(h),n.add(f)}const s=[];let o;for(;n.size>0;){const d=n.values().next().value;let[c,h,f,m,b]=d;n.delete(d);let S=c,v=h;for(o=[c,f],s.push(o);;){let P;if(n.has(m))P=m;else if(n.has(b))P=b;else break;n.delete(P),[c,h,f,m,b]=P,S!==c&&(o.push(S,v,c,v===h?h:f),S=c),v=v===h?f:h}o.push(S,v)}return new mT(s,this.#e,this.#t,this.#i)}#s(e){const t=this.#a;let n=0,s=t.length-1;for(;n<=s;){const o=n+s>>1,d=t[o][0];if(d===e)return o;d<e?n=o+1:s=o-1}return s+1}#o([,e,t]){const n=this.#s(e);this.#a.splice(n,0,[e,t])}#c([,e,t]){const n=this.#s(e);for(let s=n;s<this.#a.length;s++){const[o,d]=this.#a[s];if(o!==e)break;if(o===e&&d===t){this.#a.splice(s,1);return}}for(let s=n-1;s>=0;s--){const[o,d]=this.#a[s];if(o!==e)break;if(o===e&&d===t){this.#a.splice(s,1);return}}}#l(e){const[t,n,s]=e,o=[[t,n,s]],d=this.#s(s);for(let c=0;c<d;c++){const[h,f]=this.#a[c];for(let m=0,b=o.length;m<b;m++){const[,S,v]=o[m];if(!(f<=S||v<=h)){if(S>=h){if(v>f)o[m][1]=f;else{if(b===1)return[];o.splice(m,1),m--,b--}continue}o[m][2]=h,v>f&&o.push([t,f,v])}}}return o}}class mT extends cn{#e;#t;constructor(e,t,n,s){super(),this.#t=e,this.#e=t,this.firstPoint=n,this.lastPoint=s}toSVGPath(){const e=[];for(const t of this.#t){let[n,s]=t;e.push(`M${n} ${s}`);for(let o=2;o<t.length;o+=2){const d=t[o],c=t[o+1];d===n?(e.push(`V${c}`),s=c):c===s&&(e.push(`H${d}`),n=d)}e.push("Z")}return e.join(" ")}serialize([e,t,n,s],o){const d=[],c=n-e,h=s-t;for(const f of this.#t){const m=new Array(f.length);for(let b=0;b<f.length;b+=2)m[b]=e+f[b]*c,m[b+1]=s-f[b+1]*h;d.push(m)}return d}get box(){return this.#e}get classNamesForOutlining(){return["highlightOutline"]}}class uy extends rh{newFreeDrawOutline(e,t,n,s,o,d){return new yT(e,t,n,s,o,d)}}class yT extends Nv{newOutliner(e,t,n,s,o,d=0){return new uy(e,t,n,s,o,d)}}class ca extends In{#e=null;#t=0;#i;#n=null;#a=null;#r=null;#s=null;#o=0;#c=null;#l=null;#h=null;#u=!1;#f=null;#m=null;#g=null;#d="";#p;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=yi.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=ca.prototype;return fi(this,"_keyboardManager",new Np([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||ca._defaultColor,this.#p=e.thickness||ca._defaultThickness,this.opacity=e.opacity||ca._defaultOpacity,this.#i=e.boxes||null,this.#y=e.methodOfCreation||"",this.#d=e.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(this.#u=!0,this.#x(e),this.#v()):this.#i&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#s=e.focusNode,this.#o=e.focusOffset,this.#b(),this.#v(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#u?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#p,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#b(){const e=new dy(this.#i,.001);this.#l=e.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const t=new dy(this.#i,.0025,.001,this._uiManager.direction==="ltr");this.#r=t.getOutlines();const{firstPoint:n}=this.#l;this.#f=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height];const{lastPoint:s}=this.#r;this.#m=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height]}#x({highlightOutlines:e,highlightId:t,clipPathId:n}){this.#l=e;const s=1.5;if(this.#r=e.getNewOutline(this.#p/2+s,.0025),t>=0)this.#h=t,this.#n=n,this.parent.drawLayer.finalizeDraw(t,{bbox:e.box,path:{d:e.toSVGPath()}}),this.#g=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},!0);else if(this.parent){const b=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#h,{bbox:ca.#C(this.#l.box,(b-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#g,{bbox:ca.#C(this.#r.box,b),path:{d:this.#r.toSVGPath()}})}const[o,d,c,h]=e.box;switch(this.rotation){case 0:this.x=o,this.y=d,this.width=c,this.height=h;break;case 90:{const[b,S]=this.parentDimensions;this.x=d,this.y=1-o,this.width=c*S/b,this.height=h*b/S;break}case 180:this.x=1-o,this.y=1-d,this.width=c,this.height=h;break;case 270:{const[b,S]=this.parentDimensions;this.x=1-d,this.y=o,this.width=c*S/b,this.height=h*b/S;break}}const{firstPoint:f}=e;this.#f=[(f[0]-o)/c,(f[1]-d)/h];const{lastPoint:m}=this.#r;this.#m=[(m[0]-o)/c,(m[1]-d)/h]}static initialize(e,t){In.initialize(e,t),ca._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case Ki.HIGHLIGHT_COLOR:ca._defaultColor=t;break;case Ki.HIGHLIGHT_THICKNESS:ca._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#m}get commentButtonPosition(){return this.#f}updateParams(e,t){switch(e){case Ki.HIGHLIGHT_COLOR:this.#T(t);break;case Ki.HIGHLIGHT_THICKNESS:this.#A(t);break}}static get defaultPropertiesToUpdate(){return[[Ki.HIGHLIGHT_COLOR,ca._defaultColor],[Ki.HIGHLIGHT_THICKNESS,ca._defaultThickness]]}get propertiesToUpdate(){return[[Ki.HIGHLIGHT_COLOR,this.color||ca._defaultColor],[Ki.HIGHLIGHT_THICKNESS,this.#p||ca._defaultThickness],[Ki.HIGHLIGHT_FREE,this.#u]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#h,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#a?.updateColor(this.color),super.onUpdatedColor()}#T(e){const t=(o,d)=>{this.color=o,this.opacity=d,this.onUpdatedColor()},n=this.color,s=this.opacity;this.addCommands({cmd:t.bind(this,e,ca._defaultOpacity),undo:t.bind(this,n,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ki.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(e)},!0)}#A(e){const t=this.#p,n=s=>{this.#p=s,this.#w(s)};this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ki.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#a=new Bc({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#j())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#j())}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){this.#k(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#v(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#k():e&&(this.#v(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#w(e){this.#u&&(this.#x({highlightOutlines:this.#l.getNewOutline(e/2)}),this.fixAndSetPosition(),this.setDims())}#k(){this.#h===null||!this.parent||(this.parent.drawLayer.remove(this.#h),this.#h=null,this.parent.drawLayer.remove(this.#g),this.#g=null)}#v(e=this.parent){this.#h===null&&({id:this.#h,clipPathId:this.#n}=e.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#u},path:{d:this.#l.toSVGPath()}},!1,!0),this.#g=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#u},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},this.#u),this.#c&&(this.#c.style.clipPath=this.#n))}static#C([e,t,n,s],o){switch(o){case 90:return[1-t-s,e,s,n];case 180:return[1-e-n,1-t-s,n,s];case 270:return[t,1-e-n,s,n]}return[e,t,n,s]}rotate(e){const{drawLayer:t}=this.parent;let n;this.#u?(e=(e-this.rotation+360)%360,n=ca.#C(this.#l.box,e)):n=ca.#C([this.x,this.y,this.width,this.height],e),t.updateProperties(this.#h,{bbox:n,root:{"data-main-rotation":e}}),t.updateProperties(this.#g,{bbox:ca.#C(this.#r.box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();this.#d&&(e.setAttribute("aria-label",this.#d),e.setAttribute("role","mark")),this.#u?e.classList.add("free"):this.div.addEventListener("keydown",this.#P.bind(this),{signal:this._uiManager._signal});const t=this.#c=document.createElement("div");return e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#n,this.setDims(),iv(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1}})}#P(e){ca._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#N(!0);break;case 1:case 3:this.#N(!1);break}}#N(e){if(!this.#e)return;const t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#s,this.#o)}select(){super.select(),this.#g&&this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#g&&(this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{selected:!1}}),this.#u||this.#N(!1))}get _mustFixPosition(){return!this.#u}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#h,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#g,{rootClass:{hidden:!e}}))}#j(){return this.#u?this.rotation:0}#z(){if(this.#u)return null;const[e,t]=this.pageDimensions,[n,s]=this.pageTranslation,o=this.#i,d=new Float32Array(o.length*8);let c=0;for(const{x:h,y:f,width:m,height:b}of o){const S=h*e+n,v=(1-f)*t+s;d[c]=d[c+4]=S,d[c+1]=d[c+3]=v,d[c+2]=d[c+6]=S+m*e,d[c+5]=d[c+7]=v-b*t,c+=8}return d}#R(e){return this.#l.serialize(e,this.#j())}static startHighlighting(e,t,{target:n,x:s,y:o}){const{x:d,y:c,width:h,height:f}=n.getBoundingClientRect(),m=new AbortController,b=e.combinedSignal(m),S=v=>{m.abort(),this.#B(e,v)};window.addEventListener("blur",S,{signal:b}),window.addEventListener("pointerup",S,{signal:b}),window.addEventListener("pointerdown",ta,{capture:!0,passive:!1,signal:b}),window.addEventListener("contextmenu",Uc,{signal:b}),n.addEventListener("pointermove",this.#L.bind(this,e),{signal:b}),this._freeHighlight=new uy({x:s,y:o},[d,c,h,f],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#L(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#B(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,n){let s=null;if(e instanceof _v){const{data:{quadPoints:P,rect:x,rotation:k,id:N,color:$,opacity:I,popupRef:z,richText:B,contentsObj:G,creationDate:te,modificationDate:F},parent:{page:{pageNumber:H}}}=e;s=e={annotationType:yi.HIGHLIGHT,color:Array.from($),opacity:I,quadPoints:P,boxes:null,pageIndex:H-1,rect:x.slice(0),rotation:k,annotationElementId:N,id:N,deleted:!1,popupRef:z,richText:B,comment:G?.str||null,creationDate:te,modificationDate:F}}else if(e instanceof Ey){const{data:{inkLists:P,rect:x,rotation:k,id:N,color:$,borderStyle:{rawWidth:I},popupRef:z,richText:B,contentsObj:G,creationDate:te,modificationDate:F},parent:{page:{pageNumber:H}}}=e;s=e={annotationType:yi.HIGHLIGHT,color:Array.from($),thickness:I,inkLists:P,boxes:null,pageIndex:H-1,rect:x.slice(0),rotation:k,annotationElementId:N,id:N,deleted:!1,popupRef:z,richText:B,comment:G?.str||null,creationDate:te,modificationDate:F}}const{color:o,quadPoints:d,inkLists:c,opacity:h}=e,f=await super.deserialize(e,t,n);f.color=fn.makeHexColor(...o),f.opacity=h||1,c&&(f.#p=e.thickness),f._initialData=s,e.comment&&f.setCommentData(e);const[m,b]=f.pageDimensions,[S,v]=f.pageTranslation;if(d){const P=f.#i=[];for(let x=0;x<d.length;x+=8)P.push({x:(d[x]-S)/m,y:1-(d[x+1]-v)/b,width:(d[x+2]-d[x])/m,height:(d[x+1]-d[x+5])/b});f.#b(),f.#v(),f.rotate(f.rotation)}else if(c){f.#u=!0;const P=c[0],x={x:P[0]-S,y:b-(P[1]-v)},k=new uy(x,[0,0,m,b],1,f.#p/2,!0,.001);for(let I=0,z=P.length;I<z;I+=2)x.x=P[I]-S,x.y=b-(P[I+1]-v),k.add(x);const{id:N,clipPathId:$}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:k.toSVGPath()}},!0,!0);f.#x({highlightOutlines:k.getOutlines(),highlightId:N,clipPathId:$}),f.#v(),f.rotate(f.parentRotation)}return f}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=In._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),n=super.serialize(e);return Object.assign(n,{color:t,opacity:this.opacity,thickness:this.#p,quadPoints:this.#z(),outlines:this.#R(n.rect)}),this.addComment(n),this.annotationElementId&&!this.#M(n)?null:(n.id=this.annotationElementId,n)}#M(e){const{color:t}=this._initialData;return this.hasEditedComment||e.color.some((n,s)=>n!==t[s])}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class jv{#e=Object.create(null);updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,n)}updateSVGProperty(e,t){this.#e[e]=t}toSVGProperties(){const e=this.#e;return this.#e=Object.create(null),{root:e}}reset(){this.#e=Object.create(null)}updateAll(e=this){this.updateProperties(e)}clone(){Xs("Not implemented")}}class xs extends In{#e=null;#t;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#i=null;static#n=null;static#a=null;static _INNER_MARGIN=3;constructor(e){super(e),this.#t=e.mustBeCommitted||!1,this._addOutlines(e)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(e){e.drawOutlines&&(this.#r(e),this.#c())}#r({drawOutlines:e,drawId:t,drawingOptions:n}){this.#e=e,this._drawingOptions||=n,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),t>=0?(this._drawId=t,this.parent.drawLayer.finalizeDraw(t,e.defaultProperties)):this._drawId=this.#s(e,this.parent),this.#u(e.box)}#s(e,t){const{id:n}=t.drawLayer.draw(xs._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return n}static _mergeSVGProperties(e,t){const n=new Set(Object.keys(e));for(const[s,o]of Object.entries(t))n.has(s)?Object.assign(e[s],o):e[s]=o;return e}static getDefaultDrawingOptions(e){Xs("Not implemented")}static get typesMap(){Xs("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const n=this.typesMap.get(e);n&&this._defaultDrawingOptions.updateProperty(n,t),this._currentParent&&(xs.#i.updateProperty(n,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const n=this.constructor.typesMap.get(e);n&&this._updateProperty(e,n,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[n,s]of this.typesMap)e.push([n,t[s]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[n,s]of this.constructor.typesMap)e.push([n,t[s]]);return e}_updateProperty(e,t,n){const s=this._drawingOptions,o=s[t],d=c=>{s.updateProperty(t,c);const h=this.#e.updateProperty(t,c);h&&this.#u(h),this.parent?.drawLayer.updateProperties(this._drawId,s.toSVGProperties()),e===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:d.bind(this,n),undo:d.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,xs._mergeSVGProperties(this.#e.getPathResizingSVGProperties(this.#h()),{bbox:this.#f()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,xs._mergeSVGProperties(this.#e.getPathResizedSVGProperties(this.#h()),{bbox:this.#f()}))}_onTranslating(e,t){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#f()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,xs._mergeSVGProperties(this.#e.getPathTranslatedSVGProperties(this.#h(),this.parentDimensions),{bbox:this.#f()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#t&&(this.#t=!1,this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){this.#o(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#c(),this.#u(this.#e.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),this.#o()):e&&(this._uiManager.addShouldRescale(this),this.#c(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),t&&this.select()}#o(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#c(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#s(this.#e,e)}}#l([e,t,n,s]){const{parentDimensions:[o,d],rotation:c}=this;switch(c){case 90:return[t,1-e,n*(d/o),s*(o/d)];case 180:return[1-e,1-t,n,s];case 270:return[1-t,e,n*(d/o),s*(o/d)];default:return[e,t,n,s]}}#h(){const{x:e,y:t,width:n,height:s,parentDimensions:[o,d],rotation:c}=this;switch(c){case 90:return[1-t,e,n*(o/d),s*(d/o)];case 180:return[1-e,1-t,n,s];case 270:return[t,1-e,n*(o/d),s*(d/o)];default:return[e,t,n,s]}}#u(e){[this.x,this.y,this.width,this.height]=this.#l(e),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#f(){const{x:e,y:t,width:n,height:s,rotation:o,parentRotation:d,parentDimensions:[c,h]}=this;switch((o*4+d)/90){case 1:return[1-t-s,e,s,n];case 2:return[1-e-n,1-t-s,n,s];case 3:return[t,1-e-n,s,n];case 4:return[e,t-n*(c/h),s*(h/c),n*(c/h)];case 5:return[1-t,e,n*(c/h),s*(h/c)];case 6:return[1-e-s*(h/c),1-t,s*(h/c),n*(c/h)];case 7:return[t-n*(c/h),1-e-s*(h/c),n*(c/h),s*(h/c)];case 8:return[e-n,t-s,n,s];case 9:return[1-t,e-n,s,n];case 10:return[1-e,1-t,n,s];case 11:return[t-s,1-e,s,n];case 12:return[e-s*(h/c),t,s*(h/c),n*(c/h)];case 13:return[1-t-n*(c/h),e-s*(h/c),n*(c/h),s*(h/c)];case 14:return[1-e,1-t-n*(c/h),s*(h/c),n*(c/h)];case 15:return[t,1-e,n*(c/h),s*(h/c)];default:return[e,t,n,s]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,xs._mergeSVGProperties({bbox:this.#f()},this.#e.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#u(this.#e.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,t;this._isCopy&&(e=this.x,t=this.y);const n=super.render();n.classList.add("draw");const s=document.createElement("div");return n.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,t),n}static createDrawerInstance(e,t,n,s,o){Xs("Not implemented")}static startDrawing(e,t,n,s){const{target:o,offsetX:d,offsetY:c,pointerId:h,pointerType:f}=s;if(bs.isInitializedAndDifferentPointerType(f))return;const{viewport:{rotation:m}}=e,{width:b,height:S}=o.getBoundingClientRect(),v=xs.#n=new AbortController,P=e.combinedSignal(v);if(bs.setPointer(f,h),window.addEventListener("pointerup",x=>{bs.isSamePointerIdOrRemove(x.pointerId)&&this._endDraw(x)},{signal:P}),window.addEventListener("pointercancel",x=>{bs.isSamePointerIdOrRemove(x.pointerId)&&this._currentParent.endDrawingSession()},{signal:P}),window.addEventListener("pointerdown",x=>{bs.isSamePointerType(x.pointerType)&&(bs.initializeAndAddPointerId(x.pointerId),xs.#i.isCancellable()&&(xs.#i.removeLastElement(),xs.#i.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:P}),window.addEventListener("contextmenu",Uc,{signal:P}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:P}),o.addEventListener("touchmove",x=>{bs.isSameTimeStamp(x.timeStamp)&&ta(x)},{signal:P}),e.toggleDrawing(),t._editorUndoBar?.hide(),xs.#i){e.drawLayer.updateProperties(this._currentDrawId,xs.#i.startNew(d,c,b,S,m));return}t.updateUIForDefaultProperties(this),xs.#i=this.createDrawerInstance(d,c,b,S,m),xs.#a=this.getDefaultDrawingOptions(),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(xs.#a.toSVGProperties(),xs.#i.defaultSVGProperties),!0,!1)}static _drawMove(e){if(bs.isSameTimeStamp(e.timeStamp),!xs.#i)return;const{offsetX:t,offsetY:n,pointerId:s}=e;if(bs.isSamePointerId(s)){if(bs.isUsingMultiplePointers()){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,xs.#i.add(t,n)),bs.setTimeStamp(e.timeStamp),ta(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,xs.#i=null,xs.#a=null,bs.clearPointerType(),bs.clearTimeStamp()),xs.#n&&(xs.#n.abort(),xs.#n=null,bs.clearPointerIds())}static _endDraw(e){const t=this._currentParent;if(t){if(t.toggleDrawing(!0),this._cleanup(!1),e?.target===t.div&&t.drawLayer.updateProperties(this._currentDrawId,xs.#i.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const n=xs.#i,s=this._currentDrawId,o=n.getLastElement();t.addCommands({cmd:()=>{t.drawLayer.updateProperties(s,n.setLastElement(o))},undo:()=>{t.drawLayer.updateProperties(s,n.removeLastElement())},mustExec:!1,type:Ki.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(Ki.DRAW_STEP),!xs.#i.isEmpty()){const{pageDimensions:[n,s],scale:o}=t,d=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:xs.#i.getOutlines(n*o,s*o,o,this._INNER_MARGIN),drawingOptions:xs.#a,mustBeCommitted:!e});return this._cleanup(!0),d}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,n,s,o,d){Xs("Not implemented")}static async deserialize(e,t,n){const{rawDims:{pageWidth:s,pageHeight:o,pageX:d,pageY:c}}=t.viewport,h=this.deserializeDraw(d,c,s,o,this._INNER_MARGIN,e),f=await super.deserialize(e,t,n);return f.createDrawingOptions(e),f.#r({drawOutlines:h}),f.#c(),f.onScaleChanging(),f.rotate(),f}serializeDraw(e){const[t,n]=this.pageTranslation,[s,o]=this.pageDimensions;return this.#e.serialize([t,n,s,o],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class xT{#e=new Float64Array(6);#t;#i;#n;#a;#r;#s="";#o=0;#c=new Pp;#l;#h;constructor(e,t,n,s,o,d){this.#l=n,this.#h=s,this.#n=o,this.#a=d,[e,t]=this.#u(e,t);const c=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#r=[e,t],this.#i=[{line:c,points:this.#r}],this.#e.set(c,0)}updateProperty(e,t){e==="stroke-width"&&(this.#a=t)}#u(e,t){return cn._normalizePoint(e,t,this.#l,this.#h,this.#n)}isEmpty(){return!this.#i||this.#i.length===0}isCancellable(){return this.#r.length<=10}add(e,t){[e,t]=this.#u(e,t);const[n,s,o,d]=this.#e.subarray(2,6),c=e-o,h=t-d;return Math.hypot(this.#l*c,this.#h*h)<=2?null:(this.#r.push(e,t),isNaN(n)?(this.#e.set([o,d,e,t],2),this.#t.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#e[0])&&this.#t.splice(6,6),this.#e.set([n,s,o,d,e,t],0),this.#t.push(...cn.createBezierPoints(n,s,o,d,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(this.#r.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,s,o){this.#l=n,this.#h=s,this.#n=o,[e,t]=this.#u(e,t);const d=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#r=[e,t];const c=this.#i.at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),this.#i.push({line:d,points:this.#r}),this.#e.set(d,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#i.at(-1)}setLastElement(e){return this.#i?(this.#i.push(e),this.#t=e.line,this.#r=e.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(e)}removeLastElement(){if(!this.#i)return this.#c.removeLastElement();this.#i.pop(),this.#s="";for(let e=0,t=this.#i.length;e<t;e++){const{line:n,points:s}=this.#i[e];this.#t=n,this.#r=s,this.#o=0,this.toSVGPath()}return{path:{d:this.#s}}}toSVGPath(){const e=cn.svgRound(this.#t[4]),t=cn.svgRound(this.#t[5]);if(this.#r.length===2)return this.#s=`${this.#s} M ${e} ${t} Z`,this.#s;if(this.#r.length<=6){const s=this.#s.lastIndexOf("M");this.#s=`${this.#s.slice(0,s)} M ${e} ${t}`,this.#o=6}if(this.#r.length===4){const s=cn.svgRound(this.#t[10]),o=cn.svgRound(this.#t[11]);return this.#s=`${this.#s} L ${s} ${o}`,this.#o=12,this.#s}const n=[];this.#o===0&&(n.push(`M ${e} ${t}`),this.#o=6);for(let s=this.#o,o=this.#t.length;s<o;s+=6){const[d,c,h,f,m,b]=this.#t.slice(s,s+6).map(cn.svgRound);n.push(`C${d} ${c} ${h} ${f} ${m} ${b}`)}return this.#s+=n.join(" "),this.#o=this.#t.length,this.#s}getOutlines(e,t,n,s){const o=this.#i.at(-1);return o.line=new Float32Array(o.line),o.points=new Float32Array(o.points),this.#c.build(this.#i,e,t,n,this.#n,this.#a,s),this.#e=null,this.#t=null,this.#i=null,this.#s=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Pp extends cn{#e;#t=0;#i;#n;#a;#r;#s;#o;#c;build(e,t,n,s,o,d,c){this.#a=t,this.#r=n,this.#s=s,this.#o=o,this.#c=d,this.#i=c??0,this.#n=e,this.#u()}get thickness(){return this.#c}setLastElement(e){return this.#n.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#n.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of this.#n){if(e.push(`M${cn.svgRound(t[4])} ${cn.svgRound(t[5])}`),t.length===6){e.push("Z");continue}if(t.length===12&&isNaN(t[6])){e.push(`L${cn.svgRound(t[10])} ${cn.svgRound(t[11])}`);continue}for(let n=6,s=t.length;n<s;n+=6){const[o,d,c,h,f,m]=t.subarray(n,n+6).map(cn.svgRound);e.push(`C${o} ${d} ${c} ${h} ${f} ${m}`)}}return e.join("")}serialize([e,t,n,s],o){const d=[],c=[],[h,f,m,b]=this.#h();let S,v,P,x,k,N,$,I,z;switch(this.#o){case 0:z=cn._rescale,S=e,v=t+s,P=n,x=-s,k=e+h*n,N=t+(1-f-b)*s,$=e+(h+m)*n,I=t+(1-f)*s;break;case 90:z=cn._rescaleAndSwap,S=e,v=t,P=n,x=s,k=e+f*n,N=t+h*s,$=e+(f+b)*n,I=t+(h+m)*s;break;case 180:z=cn._rescale,S=e+n,v=t,P=-n,x=s,k=e+(1-h-m)*n,N=t+f*s,$=e+(1-h)*n,I=t+(f+b)*s;break;case 270:z=cn._rescaleAndSwap,S=e+n,v=t+s,P=-n,x=-s,k=e+(1-f-b)*n,N=t+(1-h-m)*s,$=e+(1-f)*n,I=t+(1-h)*s;break}for(const{line:B,points:G}of this.#n)d.push(z(B,S,v,P,x,o?new Array(B.length):null)),c.push(z(G,S,v,P,x,o?new Array(G.length):null));return{lines:d,points:c,rect:[k,N,$,I]}}static deserialize(e,t,n,s,o,{paths:{lines:d,points:c},rotation:h,thickness:f}){const m=[];let b,S,v,P,x;switch(h){case 0:x=cn._rescale,b=-e/n,S=t/s+1,v=1/n,P=-1/s;break;case 90:x=cn._rescaleAndSwap,b=-t/s,S=-e/n,v=1/s,P=1/n;break;case 180:x=cn._rescale,b=e/n+1,S=-t/s,v=-1/n,P=1/s;break;case 270:x=cn._rescaleAndSwap,b=t/s+1,S=e/n+1,v=-1/s,P=-1/n;break}if(!d){d=[];for(const N of c){const $=N.length;if($===2){d.push(new Float32Array([NaN,NaN,NaN,NaN,N[0],N[1]]));continue}if($===4){d.push(new Float32Array([NaN,NaN,NaN,NaN,N[0],N[1],NaN,NaN,NaN,NaN,N[2],N[3]]));continue}const I=new Float32Array(3*($-2));d.push(I);let[z,B,G,te]=N.subarray(0,4);I.set([NaN,NaN,NaN,NaN,z,B],0);for(let F=4;F<$;F+=2){const H=N[F],Q=N[F+1];I.set(cn.createBezierPoints(z,B,G,te,H,Q),(F-2)*3),[z,B,G,te]=[G,te,H,Q]}}}for(let N=0,$=d.length;N<$;N++)m.push({line:x(d[N].map(I=>I??NaN),b,S,v,P),points:x(c[N].map(I=>I??NaN),b,S,v,P)});const k=new this.prototype.constructor;return k.build(m,n,s,1,h,f,o),k}#l(e=this.#c){const t=this.#i+e/2*this.#s;return this.#o%180===0?[t/this.#a,t/this.#r]:[t/this.#r,t/this.#a]}#h(){const[e,t,n,s]=this.#e,[o,d]=this.#l(0);return[e+o,t+d,n-2*o,s-2*d]}#u(){const e=this.#e=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:s}of this.#n){if(s.length<=12){for(let c=4,h=s.length;c<h;c+=6)fn.pointBoundingBox(s[c],s[c+1],e);continue}let o=s[4],d=s[5];for(let c=6,h=s.length;c<h;c+=6){const[f,m,b,S,v,P]=s.subarray(c,c+6);fn.bezierBoundingBox(o,d,f,m,b,S,v,P,e),o=v,d=P}}const[t,n]=this.#l();e[0]=vl(e[0]-t,0,1),e[1]=vl(e[1]-n,0,1),e[2]=vl(e[2]+t,0,1),e[3]=vl(e[3]+n,0,1),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#e}updateProperty(e,t){return e==="stroke-width"?this.#f(t):null}#f(e){const[t,n]=this.#l();this.#c=e;const[s,o]=this.#l(),[d,c]=[s-t,o-n],h=this.#e;return h[0]-=d,h[1]-=c,h[2]+=2*d,h[3]+=2*c,h}updateParentDimensions([e,t],n){const[s,o]=this.#l();this.#a=e,this.#r=t,this.#s=n;const[d,c]=this.#l(),h=d-s,f=c-o,m=this.#e;return m[0]-=h,m[1]-=f,m[2]+=2*h,m[3]+=2*f,m}updateRotation(e){return this.#t=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#e.map(cn.svgRound).join(" ")}get defaultProperties(){const[e,t]=this.#e;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${cn.svgRound(e)} ${cn.svgRound(t)}`}}}get rotationTransform(){const[,,e,t]=this.#e;let n=0,s=0,o=0,d=0,c=0,h=0;switch(this.#t){case 90:s=t/e,o=-e/t,c=e;break;case 180:n=-1,d=-1,c=e,h=t;break;case 270:s=-t/e,o=e/t,h=t;break;default:return""}return`matrix(${n} ${s} ${o} ${d} ${cn.svgRound(c)} ${cn.svgRound(h)})`}getPathResizingSVGProperties([e,t,n,s]){const[o,d]=this.#l(),[c,h,f,m]=this.#e;if(Math.abs(f-o)<=cn.PRECISION||Math.abs(m-d)<=cn.PRECISION){const x=e+n/2-(c+f/2),k=t+s/2-(h+m/2);return{path:{"transform-origin":`${cn.svgRound(e)} ${cn.svgRound(t)}`,transform:`${this.rotationTransform} translate(${x} ${k})`}}}const b=(n-2*o)/(f-2*o),S=(s-2*d)/(m-2*d),v=f/n,P=m/s;return{path:{"transform-origin":`${cn.svgRound(c)} ${cn.svgRound(h)}`,transform:`${this.rotationTransform} scale(${v} ${P}) translate(${cn.svgRound(o)} ${cn.svgRound(d)}) scale(${b} ${S}) translate(${cn.svgRound(-o)} ${cn.svgRound(-d)})`}}}getPathResizedSVGProperties([e,t,n,s]){const[o,d]=this.#l(),c=this.#e,[h,f,m,b]=c;if(c[0]=e,c[1]=t,c[2]=n,c[3]=s,Math.abs(m-o)<=cn.PRECISION||Math.abs(b-d)<=cn.PRECISION){const k=e+n/2-(h+m/2),N=t+s/2-(f+b/2);for(const{line:$,points:I}of this.#n)cn._translate($,k,N,$),cn._translate(I,k,N,I);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${cn.svgRound(e)} ${cn.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const S=(n-2*o)/(m-2*o),v=(s-2*d)/(b-2*d),P=-S*(h+o)+e+o,x=-v*(f+d)+t+d;if(S!==1||v!==1||P!==0||x!==0)for(const{line:k,points:N}of this.#n)cn._rescale(k,P,x,S,v,k),cn._rescale(N,P,x,S,v,N);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${cn.svgRound(e)} ${cn.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,t],n){const[s,o]=n,d=this.#e,c=e-d[0],h=t-d[1];if(this.#a===s&&this.#r===o)for(const{line:f,points:m}of this.#n)cn._translate(f,c,h,f),cn._translate(m,c,h,m);else{const f=this.#a/s,m=this.#r/o;this.#a=s,this.#r=o;for(const{line:b,points:S}of this.#n)cn._rescale(b,c,h,f,m,b),cn._rescale(S,c,h,f,m,S);d[2]*=f,d[3]*=m}return d[0]=e,d[1]=t,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${cn.svgRound(e)} ${cn.svgRound(t)}`}}}get defaultSVGProperties(){const e=this.#e;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${cn.svgRound(e[0])} ${cn.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}class h0 extends jv{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:In._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??=this["stroke-width"],t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new h0(this._viewParameters);return e.updateAll(this),e}}class Dy extends xs{static _type="ink";static _editorType=yi.INK;static _defaultDrawingOptions=null;constructor(e){super({...e,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,t){In.initialize(e,t),this._defaultDrawingOptions=new h0(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return fi(this,"typesMap",new Map([[Ki.INK_THICKNESS,"stroke-width"],[Ki.INK_COLOR,"stroke"],[Ki.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,n,s,o){return new xT(e,t,n,s,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,n,s,o,d){return Pp.deserialize(e,t,n,s,o,d)}static async deserialize(e,t,n){let s=null;if(e instanceof Ey){const{data:{inkLists:d,rect:c,rotation:h,id:f,color:m,opacity:b,borderStyle:{rawWidth:S},popupRef:v,richText:P,contentsObj:x,creationDate:k,modificationDate:N},parent:{page:{pageNumber:$}}}=e;s=e={annotationType:yi.INK,color:Array.from(m),thickness:S,opacity:b,paths:{points:d},boxes:null,pageIndex:$-1,rect:c.slice(0),rotation:h,annotationElementId:f,id:f,deleted:!1,popupRef:v,richText:P,comment:x?.str||null,creationDate:k,modificationDate:N}}const o=await super.deserialize(e,t,n);return o._initialData=s,e.comment&&o.setCommentData(e),o}get toolbarButtons(){return this._colorPicker||=new wp(this),[["colorPicker",this._colorPicker]]}get colorType(){return Ki.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:n}=this;t.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:t,opacity:n}){this._drawingOptions=Dy.getDefaultDrawingOptions({stroke:fn.makeHexColor(...e),"stroke-width":t,"stroke-opacity":n})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:n}=this.serializeDraw(e),{_drawingOptions:{stroke:s,"stroke-opacity":o,"stroke-width":d}}=this,c=Object.assign(super.serialize(e),{color:In._colorManager.convert(s),opacity:o,thickness:d,paths:{lines:t,points:n}});return this.addComment(c),e?(c.isCopy=!0,c):this.annotationElementId&&!this.#e(c)?null:(c.id=this.annotationElementId,c)}#e(e){const{color:t,thickness:n,opacity:s,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||e.color.some((d,c)=>d!==t[c])||e.thickness!==n||e.opacity!==s||e.pageIndex!==o}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;const{points:t,rect:n}=this.serializeDraw(!1);return e.updateEdited({rect:n,thickness:this._drawingOptions["stroke-width"],points:t,popup:this.comment}),null}}class hy extends Pp{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const Bg=8,op=3;class af{static#e={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#t(e,t,n,s){return n-=e,s-=t,n===0?s>0?0:4:n===1?s+6:2-s}static#i=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#n(e,t,n,s,o,d,c){const h=this.#t(n,s,o,d);for(let f=0;f<8;f++){const m=(-f+h-c+16)%8,b=this.#i[2*m],S=this.#i[2*m+1];if(e[(n+b)*t+(s+S)]!==0)return m}return-1}static#a(e,t,n,s,o,d,c){const h=this.#t(n,s,o,d);for(let f=0;f<8;f++){const m=(f+h+c+16)%8,b=this.#i[2*m],S=this.#i[2*m+1];if(e[(n+b)*t+(s+S)]!==0)return m}return-1}static#r(e,t,n,s){const o=e.length,d=new Int32Array(o);for(let m=0;m<o;m++)d[m]=e[m]<=s?1:0;for(let m=1;m<n-1;m++)d[m*t]=d[m*t+t-1]=0;for(let m=0;m<t;m++)d[m]=d[t*n-1-m]=0;let c=1,h;const f=[];for(let m=1;m<n-1;m++){h=1;for(let b=1;b<t-1;b++){const S=m*t+b,v=d[S];if(v===0)continue;let P=m,x=b;if(v===1&&d[S-1]===0)c+=1,x-=1;else if(v>=1&&d[S+1]===0)c+=1,x+=1,v>1&&(h=v);else{v!==1&&(h=Math.abs(v));continue}const k=[b,m],N=x===b+1,$={isHole:N,points:k,id:c,parent:0};f.push($);let I;for(const M of f)if(M.id===h){I=M;break}I?I.isHole?$.parent=N?I.parent:h:$.parent=N?h:I.parent:$.parent=N?h:0;const z=this.#n(d,t,m,b,P,x,0);if(z===-1){d[S]=-c,d[S]!==1&&(h=Math.abs(d[S]));continue}let B=this.#i[2*z],G=this.#i[2*z+1];const te=m+B,F=b+G;P=te,x=F;let H=m,Q=b;for(;;){const M=this.#a(d,t,H,Q,P,x,1);B=this.#i[2*M],G=this.#i[2*M+1];const T=H+B,R=Q+G;k.push(R,T);const Z=H*t+Q;if(d[Z+1]===0?d[Z]=-c:d[Z]===1&&(d[Z]=c),T===m&&R===b&&H===te&&Q===F){d[S]!==1&&(h=Math.abs(d[S]));break}else P=H,x=Q,H=T,Q=R}}}return f}static#s(e,t,n,s){if(n-t<=4){for(let te=t;te<n-2;te+=2)s.push(e[te],e[te+1]);return}const o=e[t],d=e[t+1],c=e[n-4]-o,h=e[n-3]-d,f=Math.hypot(c,h),m=c/f,b=h/f,S=m*d-b*o,v=h/c,P=1/f,x=Math.atan(v),k=Math.cos(x),N=Math.sin(x),$=P*(Math.abs(k)+Math.abs(N)),I=P*(1-$+$**2),z=Math.max(Math.atan(Math.abs(N+k)*I),Math.atan(Math.abs(N-k)*I));let B=0,G=t;for(let te=t+2;te<n-2;te+=2){const F=Math.abs(S-m*e[te+1]+b*e[te]);F>B&&(G=te,B=F)}B>(f*z)**2?(this.#s(e,t,G+2,s),this.#s(e,G,n,s)):s.push(o,d)}static#o(e){const t=[],n=e.length;return this.#s(e,0,n,t),t.push(e[n-2],e[n-1]),t.length<=4?null:t}static#c(e,t,n,s,o,d){const c=new Float32Array(d**2),h=-2*s**2,f=d>>1;for(let x=0;x<d;x++){const k=(x-f)**2;for(let N=0;N<d;N++)c[x*d+N]=Math.exp((k+(N-f)**2)/h)}const m=new Float32Array(256),b=-2*o**2;for(let x=0;x<256;x++)m[x]=Math.exp(x**2/b);const S=e.length,v=new Uint8Array(S),P=new Uint32Array(256);for(let x=0;x<n;x++)for(let k=0;k<t;k++){const N=x*t+k,$=e[N];let I=0,z=0;for(let G=0;G<d;G++){const te=x+G-f;if(!(te<0||te>=n))for(let F=0;F<d;F++){const H=k+F-f;if(H<0||H>=t)continue;const Q=e[te*t+H],M=c[G*d+F]*m[Math.abs(Q-$)];I+=Q*M,z+=M}}const B=v[N]=Math.round(I/z);P[B]++}return[v,P]}static#l(e){const t=new Uint32Array(256);for(const n of e)t[n]++;return t}static#h(e){const t=e.length,n=new Uint8ClampedArray(t>>2);let s=-1/0,o=1/0;for(let c=0,h=n.length;c<h;c++){const f=n[c]=e[c<<2];s=Math.max(s,f),o=Math.min(o,f)}const d=255/(s-o);for(let c=0,h=n.length;c<h;c++)n[c]=(n[c]-o)*d;return n}static#u(e){let t,n=-1/0,s=-1/0;const o=e.findIndex(h=>h!==0);let d=o,c=o;for(t=o;t<256;t++){const h=e[t];h>n&&(t-d>s&&(s=t-d,c=t-1),n=h,d=t)}for(t=c-1;t>=0&&!(e[t]>e[t+1]);t--);return t}static#f(e){const t=e,{width:n,height:s}=e,{maxDim:o}=this.#e;let d=n,c=s;if(n>o||s>o){let S=n,v=s,P=Math.log2(Math.max(n,s)/o);const x=Math.floor(P);P=P===x?x-1:x;for(let N=0;N<P;N++){d=Math.ceil(S/2),c=Math.ceil(v/2);const $=new OffscreenCanvas(d,c);$.getContext("2d").drawImage(e,0,0,S,v,0,0,d,c),S=d,v=c,e!==t&&e.close(),e=$.transferToImageBitmap()}const k=Math.min(o/d,o/c);d=Math.round(d*k),c=Math.round(c*k)}const f=new OffscreenCanvas(d,c).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,d,c),f.filter="grayscale(1)",f.drawImage(e,0,0,e.width,e.height,0,0,d,c);const m=f.getImageData(0,0,d,c).data;return[this.#h(m),d,c]}static extractContoursFromText(e,{fontFamily:t,fontStyle:n,fontWeight:s},o,d,c,h){let f=new OffscreenCanvas(1,1),m=f.getContext("2d",{alpha:!1});const b=200,S=m.font=`${n} ${s} ${b}px ${t}`,{actualBoundingBoxLeft:v,actualBoundingBoxRight:P,actualBoundingBoxAscent:x,actualBoundingBoxDescent:k,fontBoundingBoxAscent:N,fontBoundingBoxDescent:$,width:I}=m.measureText(e),z=1.5,B=Math.ceil(Math.max(Math.abs(v)+Math.abs(P)||0,I)*z),G=Math.ceil(Math.max(Math.abs(x)+Math.abs(k)||b,Math.abs(N)+Math.abs($)||b)*z);f=new OffscreenCanvas(B,G),m=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),m.font=S,m.filter="grayscale(1)",m.fillStyle="white",m.fillRect(0,0,B,G),m.fillStyle="black",m.fillText(e,B*(z-1)/2,G*(3-z)/2);const te=this.#h(m.getImageData(0,0,B,G).data),F=this.#l(te),H=this.#u(F),Q=this.#r(te,B,G,H);return this.processDrawnLines({lines:{curves:Q,width:B,height:G},pageWidth:o,pageHeight:d,rotation:c,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(e,t,n,s,o){const[d,c,h]=this.#f(e),[f,m]=this.#c(d,c,h,Math.hypot(c,h)*this.#e.sigmaSFactor,this.#e.sigmaR,this.#e.kernelSize),b=this.#u(m),S=this.#r(f,c,h,b);return this.processDrawnLines({lines:{curves:S,width:c,height:h},pageWidth:t,pageHeight:n,rotation:s,innerMargin:o,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:s,innerMargin:o,mustSmooth:d,areContours:c}){s%180!==0&&([t,n]=[n,t]);const{curves:h,width:f,height:m}=e,b=e.thickness??0,S=[],v=Math.min(t/f,n/m),P=v/t,x=v/n,k=[];for(const{points:$}of h){const I=d?this.#o($):$;if(!I)continue;k.push(I);const z=I.length,B=new Float32Array(z),G=new Float32Array(3*(z===2?2:z-2));if(S.push({line:G,points:B}),z===2){B[0]=I[0]*P,B[1]=I[1]*x,G.set([NaN,NaN,NaN,NaN,B[0],B[1]],0);continue}let[te,F,H,Q]=I;te*=P,F*=x,H*=P,Q*=x,B.set([te,F,H,Q],0),G.set([NaN,NaN,NaN,NaN,te,F],0);for(let M=4;M<z;M+=2){const T=B[M]=I[M]*P,R=B[M+1]=I[M+1]*x;G.set(cn.createBezierPoints(te,F,H,Q,T,R),(M-2)*3),[te,F,H,Q]=[H,Q,T,R]}}if(S.length===0)return null;const N=c?new hy:new Pp;return N.build(S,t,n,1,s,c?0:b,o),{outline:N,newCurves:k,areContours:c,thickness:b,width:f,height:m}}static async compressSignature({outlines:e,areContours:t,thickness:n,width:s,height:o}){let d=1/0,c=-1/0,h=0;for(const I of e){h+=I.length;for(let z=2,B=I.length;z<B;z++){const G=I[z]-I[z-2];d=Math.min(d,G),c=Math.max(c,G)}}let f;d>=-128&&c<=127?f=Int8Array:d>=-32768&&c<=32767?f=Int16Array:f=Int32Array;const m=e.length,b=Bg+op*m,S=new Uint32Array(b);let v=0;S[v++]=b*Uint32Array.BYTES_PER_ELEMENT+(h-2*m)*f.BYTES_PER_ELEMENT,S[v++]=0,S[v++]=s,S[v++]=o,S[v++]=t?0:1,S[v++]=Math.max(0,Math.floor(n??0)),S[v++]=m,S[v++]=f.BYTES_PER_ELEMENT;for(const I of e)S[v++]=I.length-2,S[v++]=I[0],S[v++]=I[1];const P=new CompressionStream("deflate-raw"),x=P.writable.getWriter();await x.ready,x.write(S);const k=f.prototype.constructor;for(const I of e){const z=new k(I.length-2);for(let B=2,G=I.length;B<G;B++)z[B-2]=I[B]-I[B-2];x.write(z)}x.close();const N=await new Response(P.readable).arrayBuffer(),$=new Uint8Array(N);return Q2($)}static async decompressSignature(e){try{const t=M3(e),{readable:n,writable:s}=new DecompressionStream("deflate-raw"),o=s.getWriter();await o.ready,o.write(t).then(async()=>{await o.ready,await o.close()}).catch(()=>{});let d=null,c=0;for await(const I of n)d||=new Uint8Array(new Uint32Array(I.buffer,0,4)[0]),d.set(I,c),c+=I.length;const h=new Uint32Array(d.buffer,0,d.length>>2),f=h[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const m=h[2],b=h[3],S=h[4]===0,v=h[5],P=h[6],x=h[7],k=[],N=(Bg+op*P)*Uint32Array.BYTES_PER_ELEMENT;let $;switch(x){case Int8Array.BYTES_PER_ELEMENT:$=new Int8Array(d.buffer,N);break;case Int16Array.BYTES_PER_ELEMENT:$=new Int16Array(d.buffer,N);break;case Int32Array.BYTES_PER_ELEMENT:$=new Int32Array(d.buffer,N);break}c=0;for(let I=0;I<P;I++){const z=h[op*I+Bg],B=new Float32Array(z+2);k.push(B);for(let G=0;G<op-1;G++)B[G]=h[op*I+Bg+G+1];for(let G=0;G<z;G++)B[G+2]=B[G]+$[c++]}return{areContours:S,thickness:v,outlines:k,width:m,height:b}}catch(t){return hi(`decompressSignature: ${t}`),null}}}class Ly extends jv{constructor(){super(),super.updateProperties({fill:In._defaultLineColor,"stroke-width":0})}clone(){const e=new Ly;return e.updateAll(this),e}}class My extends h0{constructor(e){super(e),super.updateProperties({stroke:In._defaultLineColor,"stroke-width":1})}clone(){const e=new My(this._viewParameters);return e.updateAll(this),e}}class Ad extends xs{#e=!1;#t=null;#i=null;#n=null;static _type="signature";static _editorType=yi.SIGNATURE;static _defaultDrawingOptions=null;constructor(e){super({...e,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#i=e.signatureData||null,this.#t=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,t){In.initialize(e,t),this._defaultDrawingOptions=new Ly,this._defaultDrawnSignatureOptions=new My(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!1}static get typesMap(){return fi(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#t}}static computeTelemetryFinalData(e){const t=e.get("hasDescription");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,t;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,e=this.x,t=this.y),super.render(),this._drawId===null)if(this.#i){const{lines:s,mustSmooth:o,areContours:d,description:c,uuid:h,heightInPage:f}=this.#i,{rawDims:{pageWidth:m,pageHeight:b},rotation:S}=this.parent.viewport,v=af.processDrawnLines({lines:s,pageWidth:m,pageHeight:b,rotation:S,innerMargin:Ad._INNER_MARGIN,mustSmooth:o,areContours:d});this.addSignature(v,f,c,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#t||""}));return n&&(this._isCopy=!0,this._moveAfterPaste(e,t)),this.div}setUuid(e){this.#n=e,this.addEditToolbar()}getUuid(){return this.#n}get description(){return this.#t}set description(e){this.#t=e,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:e})),super.addEditToolbar().then(t=>{t?.updateEditSignatureButton(e)}))}getSignaturePreview(){const{newCurves:e,areContours:t,thickness:n,width:s,height:o}=this.#i,d=Math.max(s,o),c=af.processDrawnLines({lines:{curves:e.map(h=>({points:h})),thickness:n,width:s,height:o},pageWidth:d,pageHeight:d,rotation:0,innerMargin:0,mustSmooth:!1,areContours:t});return{areContours:t,outline:c.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,t,n,s){const{x:o,y:d}=this,{outline:c}=this.#i=e;this.#e=c instanceof hy,this.description=n;let h;this.#e?h=Ad.getDefaultDrawingOptions():(h=Ad._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:h});const[,f]=this.pageDimensions;let m=t/f;m=m>=1?.5:m,this.width*=m/this.height,this.width>=1&&(m*=.9/this.width,this.width=.9),this.height=m,this.setDims(),this.x=o,this.y=d,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:s}=this.parent.viewport;return af.process(e,t,n,s,Ad._INNER_MARGIN)}getFromText(e,t){const{rawDims:{pageWidth:n,pageHeight:s},rotation:o}=this.parent.viewport;return af.extractContoursFromText(e,t,n,s,o,Ad._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:s}=this.parent.viewport;return af.processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:s,innerMargin:Ad._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:e,thickness:t}){e?this._drawingOptions=Ad.getDefaultDrawingOptions():(this._drawingOptions=Ad._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":t}))}serialize(e=!1){if(this.isEmpty())return null;const{lines:t,points:n}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":s}}=this,o=Object.assign(super.serialize(e),{isSignature:!0,areContours:this.#e,color:[0,0,0],thickness:this.#e?0:s});return this.addComment(o),e?(o.paths={lines:t,points:n},o.uuid=this.#n,o.isCopy=!0):o.lines=t,this.#t&&(o.accessibilityData={type:"Figure",alt:this.#t}),o}static deserializeDraw(e,t,n,s,o,d){return d.areContours?hy.deserialize(e,t,n,s,o,d):Pp.deserialize(e,t,n,s,o,d)}static async deserialize(e,t,n){const s=await super.deserialize(e,t,n);return s.#e=e.areContours,s.description=e.accessibilityData?.alt||"",s.#n=e.uuid,s}}class bT extends In{#e=null;#t=null;#i=null;#n=null;#a=null;#r="";#s=null;#o=!1;#c=null;#l=!1;#h=!1;static _type="stamp";static _editorType=yi.STAMP;constructor(e){super({...e,name:"stampEditor"}),this.#n=e.bitmapUrl,this.#a=e.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,t){In.initialize(e,t)}static isHandlingMimeForPasting(e){return iy.includes(e)}static paste(e,t){t.pasteEditor({mode:yi.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#u(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#l=e.isSvg),e.file&&(this.#r=e.file.name),this.#g()}#f(){if(this.#i=null,this._uiManager.enableWaiting(!1),!!this.#s){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:o,height:d}=e||this.copyCanvas(null,null,!0).imageData,c=await n.guess({name:"altText",request:{data:s,width:o,height:d,channels:s.length/(o*d)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const h=c.output;return await this.setGuessedAltText(h),t&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#m(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(n=>this.#u(n,!0)).finally(()=>this.#f());return}if(this.#n){const n=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromUrl(n).then(s=>this.#u(s)).finally(()=>this.#f());return}if(this.#a){const n=this.#a;this.#a=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromFile(n).then(s=>this.#u(s)).finally(()=>this.#f());return}const e=document.createElement("input");e.type="file",e.accept=iy.join(",");const t=this._uiManager._signal;this.#i=new Promise(n=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#u(s)}n()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),n()},{signal:t})}).finally(()=>this.#f()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#s?.remove(),this.#s=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#m();return}super.rebuild(),this.div!==null&&(this.#t&&this.#s===null&&this.#m(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(this.#i||this.#e||this.#n||this.#a||this.#t||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;return this._isCopy&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#e?this.#g():this.#m()),this._isCopy&&this._moveAfterPaste(e,t),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,t){const{id:n,bitmap:s}=this._uiManager.imageManager.getFromCanvas(e,t);t.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(this.#t=n,s&&(this.#e=s),this.#o=!1,this.#g())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const e=200;this.#c=setTimeout(()=>{this.#c=null,this.#p()},e)}#g(){const{div:e}=this;let{width:t,height:n}=this.#e;const[s,o]=this.pageDimensions,d=.75;if(this.width)t=this.width*s,n=this.height*o;else if(t>d*s||n>d*o){const h=Math.min(d*s/t,d*o/n);t*=h,n*=h}this._uiManager.enableWaiting(!1);const c=this.#s=document.createElement("canvas");c.setAttribute("role","img"),this.addContainer(c),this.width=t/s,this.height=n/o,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#p(),this.#h||(this.parent.addUndoableEditor(this),this.#h=!0),this._reportTelemetry({action:"inserted_image"}),this.#r&&this.div.setAttribute("aria-description",this.#r),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(e,t,n=!1){e||(e=224);const{width:s,height:o}=this.#e,d=new kd;let c=this.#e,h=s,f=o,m=null;if(t){if(s>t||o>t){const G=Math.min(t/s,t/o);h=Math.floor(s*G),f=Math.floor(o*G)}m=document.createElement("canvas");const S=m.width=Math.ceil(h*d.sx),v=m.height=Math.ceil(f*d.sy);this.#l||(c=this.#d(S,v));const P=m.getContext("2d");P.filter=this._uiManager.hcmFilter;let x="white",k="#cfcfd8";this._uiManager.hcmFilter!=="none"?k="black":U3.isDarkMode&&(x="#8f8f9d",k="#42414d");const N=15,$=N*d.sx,I=N*d.sy,z=new OffscreenCanvas($*2,I*2),B=z.getContext("2d");B.fillStyle=x,B.fillRect(0,0,$*2,I*2),B.fillStyle=k,B.fillRect(0,0,$,I),B.fillRect($,I,$,I),P.fillStyle=P.createPattern(z,"repeat"),P.fillRect(0,0,S,v),P.drawImage(c,0,0,c.width,c.height,0,0,S,v)}let b=null;if(n){let S,v;if(d.symmetric&&c.width<e&&c.height<e)S=c.width,v=c.height;else if(c=this.#e,s>e||o>e){const k=Math.min(e/s,e/o);S=Math.floor(s*k),v=Math.floor(o*k),this.#l||(c=this.#d(S,v))}const x=new OffscreenCanvas(S,v).getContext("2d",{willReadFrequently:!0});x.drawImage(c,0,0,c.width,c.height,0,0,S,v),b={width:S,height:v,data:x.getImageData(0,0,S,v).data}}return{canvas:m,width:h,height:f,imageData:b}}#d(e,t){const{width:n,height:s}=this.#e;let o=n,d=s,c=this.#e;for(;o>2*e||d>2*t;){const h=o,f=d;o>2*e&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),d>2*t&&(d=d>=16384?Math.floor(d/2)-1:Math.ceil(d/2));const m=new OffscreenCanvas(o,d);m.getContext("2d").drawImage(c,0,0,h,f,0,0,o,d),c=m.transferToImageBitmap()}return c}#p(){const[e,t]=this.parentDimensions,{width:n,height:s}=this,o=new kd,d=Math.ceil(n*e*o.sx),c=Math.ceil(s*t*o.sy),h=this.#s;if(!h||h.width===d&&h.height===c)return;h.width=d,h.height=c;const f=this.#l?this.#e:this.#d(d,c),m=h.getContext("2d");m.filter=this._uiManager.hcmFilter,m.drawImage(f,0,0,f.width,f.height,0,0,d,c)}#y(e){if(e){if(this.#l){const s=this._uiManager.imageManager.getSvgUrl(this.#t);if(s)return s}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#l){const[t,n]=this.pageDimensions,s=Math.round(this.width*t*vf.PDF_TO_CSS_UNITS),o=Math.round(this.height*n*vf.PDF_TO_CSS_UNITS),d=new OffscreenCanvas(s,o);return d.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,s,o),d.transferToImageBitmap()}return structuredClone(this.#e)}static async deserialize(e,t,n){let s=null,o=!1;if(e instanceof kv){const{data:{rect:x,rotation:k,id:N,structParent:$,popupRef:I,richText:z,contentsObj:B,creationDate:G,modificationDate:te},container:F,parent:{page:{pageNumber:H}},canvas:Q}=e;let M,T;Q?(delete e.canvas,{id:M,bitmap:T}=n.imageManager.getFromCanvas(F.id,Q),Q.remove()):(o=!0,e._hasNoCanvas=!0);const R=(await t._structTree.getAriaAttributes(`${lf}${N}`))?.get("aria-label")||"";s=e={annotationType:yi.STAMP,bitmapId:M,bitmap:T,pageIndex:H-1,rect:x.slice(0),rotation:k,annotationElementId:N,id:N,deleted:!1,accessibilityData:{decorative:!1,altText:R},isSvg:!1,structParent:$,popupRef:I,richText:z,comment:B?.str||null,creationDate:G,modificationDate:te}}const d=await super.deserialize(e,t,n),{rect:c,bitmap:h,bitmapUrl:f,bitmapId:m,isSvg:b,accessibilityData:S}=e;o?(n.addMissingCanvas(e.id,d),d.#o=!0):m&&n.imageManager.isValidId(m)?(d.#t=m,h&&(d.#e=h)):d.#n=f,d.#l=b;const[v,P]=d.pageDimensions;return d.width=(c[2]-c[0])/v,d.height=(c[3]-c[1])/P,S&&(d.altTextData=S),d._initialData=s,e.comment&&d.setCommentData(e),d.#h=!!s,d}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Object.assign(super.serialize(e),{bitmapId:this.#t,isSvg:this.#l});if(this.addComment(n),e)return n.bitmapUrl=this.#y(!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:s,altText:o}=this.serializeAltText(!1);if(!s&&o&&(n.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const c=this.#b(n);return c.isSame?null:(c.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1,n.id=this.annotationElementId,delete n.bitmapId,n)}if(t===null)return n;t.stamps||=new Map;const d=this.#l?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:d,serialized:n}),n.bitmap=this.#y(!1);else if(this.#l){const c=t.stamps.get(this.#t);d>c.area&&(c.area=d,c.serialized.bitmap.close(),c.serialized.bitmap=this.#y(!1))}return n}#b(e){const{pageIndex:t,accessibilityData:{altText:n}}=this._initialData,s=e.pageIndex===t,o=(e.accessibilityData?.alt||"")===n;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&s&&o,isSameAltText:o}}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class Gd{#e;#t=!1;#i=null;#n=null;#a=null;#r=new Map;#s=!1;#o=!1;#c=!1;#l=null;#h=null;#u=null;#f=null;#m=null;#g=-1;#d;static _initialized=!1;static#p=new Map([oo,Dy,bT,ca,Ad].map(e=>[e._editorType,e]));constructor({uiManager:e,pageIndex:t,div:n,structTreeLayer:s,accessibilityManager:o,annotationLayer:d,drawLayer:c,textLayer:h,viewport:f,l10n:m}){const b=[...Gd.#p.values()];if(!Gd._initialized){Gd._initialized=!0;for(const S of b)S.initialize(m,e)}e.registerEditorTypes(b),this.#d=e,this.pageIndex=t,this.div=n,this.#e=o,this.#i=d,this.viewport=f,this.#u=h,this.drawLayer=c,this._structTree=s,this.#d.addLayer(this)}get isEmpty(){return this.#r.size===0}get isInvisible(){return this.isEmpty&&this.#d.getMode()===yi.NONE}updateToolbar(e){this.#d.updateToolbar(e)}updateMode(e=this.#d.getMode()){switch(this.#w(),e){case yi.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case yi.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case yi.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===yi.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const n of Gd.#p.values())t.toggle(`${n._type}Editing`,e===n._editorType)}this.div.hidden=!1}hasTextLayer(e){return e===this.#u?.div}setEditingState(e){this.#d.setEditingState(e)}addCommands(e){this.#d.addCommands(e)}cleanUndoStack(e){this.#d.cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){this.#i?.togglePointerEvents(e)}get#y(){return this.#r.size!==0?this.#r.values():this.#d.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#m?.abort(),this.#m=null;const e=new Set;for(const n of this.#y)n.enableEditing(),n.show(!0),n.annotationElementId&&(this.#d.removeChangedExistingAnnotation(n),e.add(n.annotationElementId));const t=this.#i;if(t)for(const n of t.getEditableAnnotations()){if(n.hide(),this.#d.isDeletedAnnotationElement(n.data.id)||e.has(n.data.id))continue;const s=await this.deserialize(n);s&&(this.addOrRebuild(s),s.enableEditing())}this.#c=!1,this.#d._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#u&&!this.#m){this.#m=new AbortController;const s=this.#d.combinedSignal(this.#m);this.#u.div.addEventListener("pointerdown",o=>{const{clientX:c,clientY:h,timeStamp:f}=o,m=this.#g;if(f-m>500){this.#g=f;return}this.#g=-1;const{classList:b}=this.div;b.toggle("getElements",!0);const S=document.elementsFromPoint(c,h);if(b.toggle("getElements",!1),!this.div.contains(S[0]))return;let v;const P=new RegExp(`^${yp}[0-9]+$`);for(const k of S)if(P.test(k.id)){v=k.id;break}if(!v)return;const x=this.#r.get(v);x?.annotationElementId===null&&(o.stopPropagation(),o.preventDefault(),x.dblclick(o))},{signal:s,capture:!0})}const e=this.#i,t=[];if(e){const s=new Map,o=new Map;for(const c of this.#y){if(c.disableEditing(),!c.annotationElementId){t.push(c);continue}if(c.serialize()!==null){s.set(c.annotationElementId,c);continue}else o.set(c.annotationElementId,c);this.getEditableAnnotation(c.annotationElementId)?.show(),c.remove()}const d=e.getEditableAnnotations();for(const c of d){const{id:h}=c.data;if(this.#d.isDeletedAnnotationElement(h)){c.updateEdited({deleted:!0});continue}let f=o.get(h);if(f){f.resetAnnotationElement(c),f.show(!1),c.show();continue}f=s.get(h),f&&(this.#d.addChangedExistingAnnotation(f),f.renderAnnotationElement(c)&&f.show(!1)),c.show()}}this.#w(),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const s of Gd.#p.values())n.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),e?.updateFakeAnnotations(t),this.#o=!1}getEditableAnnotation(e){return this.#i?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#d.getActive()!==e&&this.#d.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#u?.div&&!this.#f){this.#f=new AbortController;const e=this.#d.combinedSignal(this.#f);this.#u.div.addEventListener("pointerdown",this.#b.bind(this),{signal:e}),this.#u.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#u?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#u.div.classList.remove("highlighting"))}#b(e){this.#d.unselectAll();const{target:t}=e;if(t===this.#u.div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&this.#u.div.contains(t)){const{isMac:n}=No.platform;if(e.button!==0||e.ctrlKey&&n)return;this.#d.showAllEditors("highlight",!0,!0),this.#u.div.classList.add("free"),this.toggleDrawing(),ca.startHighlighting(this,this.#d.direction==="ltr",{target:this.#u.div,x:e.x,y:e.y}),this.#u.div.addEventListener("pointerup",()=>{this.#u.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#d._signal}),e.preventDefault()}}enableClick(){if(this.#n)return;this.#n=new AbortController;const e=this.#d.combinedSignal(this.#n);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){this.#n?.abort(),this.#n=null}attach(e){this.#r.set(e.id,e);const{annotationElementId:t}=e;t&&this.#d.isDeletedAnnotationElement(t)&&this.#d.removeDeletedAnnotationElement(e)}detach(e){this.#r.delete(e.id),this.#e?.removePointerInTextLayer(e.contentDiv),!this.#o&&e.annotationElementId&&this.#d.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#d.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#d.addDeletedAnnotationElement(e),In.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),this.#d.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!this.#c),this.#d.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#a&&(e._focusEventsAllowed=!1,this.#a=setTimeout(()=>{this.#a=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this.#d._signal}),t.focus())},0)),e._structTreeParentId=this.#e?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),n=()=>{e.remove()};this.addCommands({cmd:t,undo:n,mustExec:!1})}getEditorByUID(e){for(const t of this.#r.values())if(t.uid===e)return t;return null}getNextId(){return this.#d.getId()}get#x(){return Gd.#p.get(this.#d.getMode())}combinedSignal(e){return this.#d.combinedSignal(e)}#T(e){const t=this.#x;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#x?.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await this.#d.updateMode(e.mode);const{offsetX:n,offsetY:s}=this.#A(),o=this.getNextId(),d=this.#T({parent:this,id:o,x:n,y:s,uiManager:this.#d,isCentered:!0,...t});d&&this.add(d)}async deserialize(e){return await Gd.#p.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#d)||null}createAndAddNewEditor(e,t,n={}){const s=this.getNextId(),o=this.#T({parent:this,id:s,x:e.offsetX,y:e.offsetY,uiManager:this.#d,isCentered:t,...n});return o&&this.add(o),o}get boundingClientRect(){return this.div.getBoundingClientRect()}#A(){const{x:e,y:t,width:n,height:s}=this.boundingClientRect,o=Math.max(0,e),d=Math.max(0,t),c=Math.min(window.innerWidth,e+n),h=Math.min(window.innerHeight,t+s),f=(o+c)/2-e,m=(d+h)/2-t,[b,S]=this.viewport.rotation%180===0?[f,m]:[m,f];return{offsetX:b,offsetY:S}}addNewEditor(e={}){this.createAndAddNewEditor(this.#A(),!0,e)}setSelected(e){this.#d.setSelected(e)}toggleSelected(e){this.#d.toggleSelected(e)}unselect(e){this.#d.unselect(e)}pointerup(e){const{isMac:t}=No.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!this.#s||(this.#s=!1,this.#x?.isDrawer&&this.#x.supportMultipleDrawings))return;if(!this.#t){this.#t=!0;return}const n=this.#d.getMode();if(n===yi.STAMP||n===yi.SIGNATURE){this.#d.unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){if(this.#d.getMode()===yi.HIGHLIGHT&&this.enableTextSelection(),this.#s){this.#s=!1;return}const{isMac:t}=No.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(this.#s=!0,this.#x?.isDrawer){this.startDrawingSession(e);return}const n=this.#d.getActive();this.#t=!n||n.isEmpty()}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),this.#l){this.#x.startDrawing(this,this.#d,!1,e);return}this.#d.setCurrentDrawingSession(this),this.#l=new AbortController;const t=this.#d.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(this.#h=null,this.commitOrRemove())},{signal:t}),this.#x.startDrawing(this,this.#d,!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&(this.#h=t);return}this.#h&&setTimeout(()=>{this.#h?.focus(),this.#h=null},0)}endDrawingSession(e=!1){return this.#l?(this.#d.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#h=null,this.#x.endDrawing(e)):null}findNewParent(e,t,n){const s=this.#d.findParent(t,n);return s===null||s===this?!1:(s.changeParent(e),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#x.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#d.getActive()?.parent===this&&(this.#d.commitOrRemove(),this.#d.setActiveEditor(null)),this.#a&&(clearTimeout(this.#a),this.#a=null);for(const e of this.#r.values())this.#e?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#r.clear(),this.#d.removeLayer(this)}#w(){for(const e of this.#r.values())e.isEmpty()&&e.remove()}render({viewport:e}){this.viewport=e,hh(this.div,e);for(const t of this.#d.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){this.#d.commitOrRemove(),this.#w();const t=this.viewport.rotation,n=e.rotation;if(this.viewport=e,hh(this.div,{rotation:n}),t!==n)for(const s of this.#r.values())s.rotate(n)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#d.viewParameters.realScale}}class _o{#e=null;#t=new Map;#i=new Map;static#n=0;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#t.size>0)for(const t of this.#t.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return fi(this,"_svgFactory",new t0)}static#a(e,[t,n,s,o]){const{style:d}=e;d.top=`${100*n}%`,d.left=`${100*t}%`,d.width=`${100*s}%`,d.height=`${100*o}%`}#r(){const e=_o._svgFactory.create(1,1,!0);return this.#e.append(e),e.setAttribute("aria-hidden",!0),e}#s(e,t){const n=_o._svgFactory.createElement("clipPath");e.append(n);const s=`clip_${t}`;n.setAttribute("id",s),n.setAttribute("clipPathUnits","objectBoundingBox");const o=_o._svgFactory.createElement("use");return n.append(o),o.setAttribute("href",`#${t}`),o.classList.add("clip"),s}#o(e,t){for(const[n,s]of Object.entries(t))s===null?e.removeAttribute(n):e.setAttribute(n,s)}draw(e,t=!1,n=!1){const s=_o.#n++,o=this.#r(),d=_o._svgFactory.createElement("defs");o.append(d);const c=_o._svgFactory.createElement("path");d.append(c);const h=`path_p${this.pageIndex}_${s}`;c.setAttribute("id",h),c.setAttribute("vector-effect","non-scaling-stroke"),t&&this.#i.set(s,c);const f=n?this.#s(d,h):null,m=_o._svgFactory.createElement("use");return o.append(m),m.setAttribute("href",`#${h}`),this.updateProperties(o,e),this.#t.set(s,o),{id:s,clipPathId:`url(#${f})`}}drawOutline(e,t){const n=_o.#n++,s=this.#r(),o=_o._svgFactory.createElement("defs");s.append(o);const d=_o._svgFactory.createElement("path");o.append(d);const c=`path_p${this.pageIndex}_${n}`;d.setAttribute("id",c),d.setAttribute("vector-effect","non-scaling-stroke");let h;if(t){const b=_o._svgFactory.createElement("mask");o.append(b),h=`mask_p${this.pageIndex}_${n}`,b.setAttribute("id",h),b.setAttribute("maskUnits","objectBoundingBox");const S=_o._svgFactory.createElement("rect");b.append(S),S.setAttribute("width","1"),S.setAttribute("height","1"),S.setAttribute("fill","white");const v=_o._svgFactory.createElement("use");b.append(v),v.setAttribute("href",`#${c}`),v.setAttribute("stroke","none"),v.setAttribute("fill","black"),v.setAttribute("fill-rule","nonzero"),v.classList.add("mask")}const f=_o._svgFactory.createElement("use");s.append(f),f.setAttribute("href",`#${c}`),h&&f.setAttribute("mask",`url(#${h})`);const m=f.cloneNode();return s.append(m),f.classList.add("mainOutline"),m.classList.add("secondaryOutline"),this.updateProperties(s,e),this.#t.set(n,s),n}finalizeDraw(e,t){this.#i.delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:n,bbox:s,rootClass:o,path:d}=t,c=typeof e=="number"?this.#t.get(e):e;if(c){if(n&&this.#o(c,n),s&&_o.#a(c,s),o){const{classList:h}=c;for(const[f,m]of Object.entries(o))h.toggle(f,m)}if(d){const f=c.firstElementChild.firstElementChild;this.#o(f,d)}}}updateParent(e,t){if(t===this)return;const n=this.#t.get(e);n&&(t.#e.append(n),this.#t.delete(e),t.#t.set(e,n))}remove(e){this.#i.delete(e),this.#e!==null&&(this.#t.get(e).remove(),this.#t.delete(e))}destroy(){this.#e=null;for(const e of this.#t.values())e.remove();this.#t.clear(),this.#i.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:dy};globalThis.pdfjsLib={AbortException:Mu,AnnotationEditorLayer:Gd,AnnotationEditorParamsType:Ki,AnnotationEditorType:yi,AnnotationEditorUIManager:Iu,AnnotationLayer:Ry,AnnotationMode:Pu,AnnotationType:Na,applyOpacity:q3,build:XC,ColorPicker:Bc,createValidAbsoluteUrl:X2,CSSConstants:H3,DOMSVGFactory:t0,DrawLayer:_o,FeatureTest:No,fetchData:Tp,findContrastColor:V3,getDocument:xv,getFilenameFromUrl:I3,getPdfFilenameFromUrl:z3,getRGB:kp,getUuid:J2,getXfaPageViewport:O3,GlobalWorkerOptions:xf,ImageKind:Wg,InvalidPDFException:ty,isDataScheme:c0,isPdfFile:Sy,isValidExplicitDest:eC,MathClamp:vl,noContextMenu:Uc,normalizeUnicode:D3,OPS:xp,OutputScale:kd,PasswordResponses:C3,PDFDataRangeTransport:bv,PDFDateString:ny,PDFWorker:vp,PermissionFlag:A3,PixelsPerInch:vf,RenderingCancelledException:wy,renderRichText:tv,ResponseException:Qg,setLayerDimensions:hh,shadow:fi,SignatureExtractor:af,stopEvent:ta,SupportedImageMimeTypes:iy,TextLayer:xl,TouchManager:d0,updateUrlHash:K2,Util:fn,VerbosityLevel:a0,version:Sv,XfaLayer:ev};typeof window<"u"&&(xf.workerSrc=`https://cdn.jsdelivr.net/npm/pdfjs-dist@${Sv}/build/pdf.worker.min.mjs`);const Pv=()=>{if(typeof window<"u"){const r=localStorage.getItem("geminiApiKey");if(r&&r.trim())return r.trim()}return"AIzaSyC4Kk580u4pLq7fGW9kgkjc7WsAb0iIdQg"},vT="gemini-2.5-flash",wT=()=>{const r=Pv();return r?`https://generativelanguage.googleapis.com/v1/models/${vT}:generateContent?key=${r}`:null},ST=r=>{const e=gy[r];return!e||!e.prefix||e.prefix.length<1?"?":e.prefix[0].substring(0,1).toUpperCase()},AT=({componentEditor:r,componentDefinition:e,setComponentEditor:t,componentsTop:n,componentsBottom:s,setComponentsTop:o,setComponentsBottom:d,connectingPin:c,setConnectingPin:h,componentDialogPosition:f,setComponentDialogPosition:m,isDraggingDialog:b,setIsDraggingDialog:S,dialogDragOffset:v,setDialogDragOffset:P,areComponentsLocked:x,setSelectedComponentIds:k,setNotesDialogVisible:N})=>{const[$,I]=X.useState(!1),[z,B]=X.useState(null),[G,te]=X.useState(()=>typeof window<"u"&&localStorage.getItem("geminiApiKey")||""),F=Tt.useMemo(()=>{if(!r||!r.visible)return null;let T=n.find(R=>R.id===r.id);return T||(T=s.find(R=>R.id===r.id)),T||null},[r,n,s]);if(Tt.useEffect(()=>{if(!F){B(null);return}const T=F.id,R=F.componentType,Z=F.componentType;if(!R){console.error("[ComponentEditor useEffect] Component missing componentType:",{comp:F,componentId:T}),B(null);return}(R==="IntegratedCircuit"||Z==="Semiconductor")&&F.datasheetFileName,B(null)},[F?.id,F?.componentType,F?.datasheetFileName]),!r||!r.visible)return null;if(!F)return console.error("[ComponentEditor] Component not found:",{componentId:r.id,componentsTopCount:n.length,componentsBottomCount:s.length}),null;if(!F.id||!F.componentType||typeof F.pinCount!="number")return console.error("[ComponentEditor] Component missing required properties:",{componentId:F.id,hasComponentType:!!F.componentType,componentType:F.componentType,pinCount:F.pinCount,pinCountType:typeof F.pinCount,component:F}),null;let H="top";n.find(T=>T.id===r.id)||(H="bottom"),r.layer!==H&&t({...r,layer:H});const Q=T=>{const R={...T};console.log("[ComponentEditor] updateComponent - Entry:",{componentId:T.id,componentType:T.componentType,editorDatasheet:r.datasheet,editorDatasheetType:typeof r.datasheet,originalComponentDatasheet:T.datasheet});const Z=r.designator?.trim()||"";R.designator=Z,R.x=r.x,R.y=r.y,R.layer=r.layer,R.orientation=r.orientation??0;const se=Z.length>0?Z.charAt(0).toUpperCase():ST(T.componentType);if(R.abbreviation=se,"manufacturer"in R&&(R.manufacturer=r.manufacturer?.trim()||void 0),"partNumber"in R&&(R.partNumber=r.partNumber?.trim()||void 0),r.pinCount!==T.pinCount){R.pinCount=r.pinCount;const V=T.pinConnections||[];if(R.pinConnections=new Array(r.pinCount).fill("").map((ee,ae)=>ae<V.length?V[ae]:""),T.pinPolarities){const ee=T.pinPolarities||[];R.pinPolarities=new Array(r.pinCount).fill("").map((ae,Ce)=>Ce<ee.length?ee[Ce]:"")}if(T.pinNames){const ee=T.pinNames||[];R.pinNames=new Array(r.pinCount).fill("").map((ae,Ce)=>Ce<ee.length?ee[Ce]:"")}}else R.pinConnections=T.pinConnections||[],T.pinPolarities&&(R.pinPolarities=T.pinPolarities),T.pinNames&&(R.pinNames=T.pinNames);if(T.componentType==="Resistor")R.resistance=r.resistance||void 0,R.resistanceUnit=r.resistanceUnit||void 0,R.power=r.power?`${r.power}W`:void 0,R.tolerance=r.tolerance||void 0;else if(T.componentType==="Capacitor")R.capacitance=r.capacitance||void 0,R.capacitanceUnit=r.capacitanceUnit||void 0,R.voltage=r.voltage||void 0,R.voltageUnit=r.voltageUnit||void 0,R.tolerance=r.tolerance||void 0,R.dielectric=r.dielectric||void 0;else if(T.componentType==="Electrolytic Capacitor")R.capacitance=r.capacitance||void 0,R.capacitanceUnit=r.capacitanceUnit||void 0,R.voltage=r.voltage||void 0,R.voltageUnit=r.voltageUnit||void 0,R.tolerance=r.tolerance||void 0,R.esr=r.esr||void 0,R.esrUnit=r.esrUnit||void 0,R.temperature=r.temperature||void 0;else if(T.componentType==="Film Capacitor")R.capacitance=r.capacitance||void 0,R.capacitanceUnit=r.capacitanceUnit||void 0,R.voltage=r.voltage||void 0,R.voltageUnit=r.voltageUnit||void 0,R.tolerance=r.tolerance||void 0,R.filmType=r.filmType||void 0;else if(T.componentType==="Diode")R.diodeType=r.diodeType||T.diodeType||"Standard",R.voltage=r.voltage||void 0,R.voltageUnit=r.voltageUnit||void 0,R.current=r.current||void 0,R.currentUnit=r.currentUnit||void 0,R.ledColor=r.ledColor||void 0;else if(T.componentType==="Battery")R.voltage=r.voltage||void 0,R.voltageUnit=r.voltageUnit||void 0,R.capacity=r.capacity||void 0,R.capacityUnit=r.capacityUnit||void 0,R.chemistry=r.chemistry||void 0;else if(T.componentType==="Fuse")R.current=r.current||void 0,R.currentUnit=r.currentUnit||void 0,R.voltage=r.voltage||void 0,R.voltageUnit=r.voltageUnit||void 0,R.fuseType=r.fuseType||void 0;else if(T.componentType==="FerriteBead")R.impedance=r.impedance||void 0,R.impedanceUnit=r.impedanceUnit||void 0,R.current=r.current||void 0,R.currentUnit=r.currentUnit||void 0;else if(T.componentType==="Connector")R.connectorType=r.connectorType||void 0,R.gender=r.gender||void 0;else if(T.componentType==="Jumper")R.positions=r.positions||void 0;else if(T.componentType==="Relay")R.coilVoltage=r.coilVoltage||void 0,R.coilVoltageUnit=r.coilVoltageUnit||void 0,R.contactType=r.contactType||void 0,R.current=r.current||void 0,R.currentUnit=r.currentUnit||void 0;else if(T.componentType==="Inductor")R.inductance=r.inductance||void 0,R.inductanceUnit=r.inductanceUnit||void 0,R.current=r.current||void 0,R.currentUnit=r.currentUnit||void 0,R.resistance=r.resistance||void 0,R.resistanceUnit=r.resistanceUnit||void 0;else if(T.componentType==="Speaker")R.impedance=r.impedance||void 0,R.impedanceUnit=r.impedanceUnit||void 0,R.power=r.power?`${r.power}W`:void 0;else if(T.componentType==="Motor")R.motorType=r.motorType||void 0,R.voltage=r.voltage||void 0,R.voltageUnit=r.voltageUnit||void 0,R.current=r.current||void 0,R.currentUnit=r.currentUnit||void 0;else if(T.componentType==="PowerSupply")R.inputVoltage=r.inputVoltage||void 0,R.inputVoltageUnit=r.inputVoltageUnit||void 0,R.outputVoltage=r.outputVoltage||void 0,R.outputVoltageUnit=r.outputVoltageUnit||void 0,R.current=r.current||void 0,R.currentUnit=r.currentUnit||void 0;else if(T.componentType==="Transistor")R.transistorType=r.transistorType||void 0,R.polarity=r.polarity||void 0,R.voltage=r.voltage||void 0,R.voltageUnit=r.voltageUnit||void 0,R.current=r.current||void 0,R.currentUnit=r.currentUnit||void 0;else if(T.componentType==="ResistorNetwork")R.resistance=r.resistance||void 0,R.resistanceUnit=r.resistanceUnit||void 0,R.configuration=r.configuration||void 0;else if(T.componentType==="Thermistor")R.resistance=r.resistance||void 0,R.resistanceUnit=r.resistanceUnit||void 0,R.thermistorType=r.thermistorType||void 0,R.beta=r.beta||void 0;else if(T.componentType==="Switch")R.switchType=r.switchType||void 0,R.current=r.current||void 0,R.currentUnit=r.currentUnit||void 0,R.voltage=r.voltage||void 0,R.voltageUnit=r.voltageUnit||void 0;else if(T.componentType==="Transformer")R.primaryVoltage=r.primaryVoltage||void 0,R.primaryVoltageUnit=r.primaryVoltageUnit||void 0,R.secondaryVoltage=r.secondaryVoltage||void 0,R.secondaryVoltageUnit=r.secondaryVoltageUnit||void 0,R.power=r.power?`${r.power}W`:void 0,R.turns=r.turns||void 0;else if(T.componentType==="TestPoint")R.signal=r.signal||void 0;else if(T.componentType==="Film Capacitor")R.capacitance=r.capacitance||void 0,R.capacitanceUnit=r.capacitanceUnit||void 0,R.voltage=r.voltage||void 0,R.voltageUnit=r.voltageUnit||void 0,R.tolerance=r.tolerance||void 0,R.filmType=r.filmType||void 0;else if(T.componentType==="IntegratedCircuit"||T.componentType==="Semiconductor"){R.description=r.description?.trim()||void 0;const V=r.datasheet;if(console.log("[ComponentEditor] updateComponent - IntegratedCircuit/Semiconductor block:",{componentType:T.componentType,editorDatasheet:r.datasheet,editorDatasheetType:typeof r.datasheet,editorDatasheetLength:r.datasheet?.length,originalComponentDatasheet:T.datasheet,datasheetValue:V}),V!=null){const ee=V.trim();R.datasheet=ee.length>0?ee:""}else R.datasheet=T.datasheet||void 0;T.componentType==="Semiconductor"&&(R.componentType="IntegratedCircuit"),console.log("[ComponentEditor] updateComponent - Final datasheet value:",R.datasheet),R.icType=r.icType||void 0,z?R.datasheetFileName=z.name:R.datasheetFileName=void 0}else R.description=r.description?.trim()||void 0;return T.componentType==="VacuumTube"?R.tubeType=r.tubeType||void 0:T.componentType==="VariableResistor"?(R.vrType=r.vrType||void 0,R.resistance=r.resistance||void 0,R.resistanceUnit=r.resistanceUnit||void 0,R.power=r.power?`${r.power}W`:void 0,R.taper=r.taper||void 0):T.componentType==="Crystal"?(R.frequency=r.frequency||void 0,R.loadCapacitance=r.loadCapacitance||void 0,R.tolerance=r.tolerance||void 0):T.componentType==="GenericComponent"&&(R.genericType=r.genericType||"Attenuator",R.voltage=r.voltage||void 0,R.voltageUnit=r.voltageUnit||void 0,R.current=r.current||void 0,R.currentUnit=r.currentUnit||void 0,R.power=r.power||void 0,R.frequency=r.frequency||void 0,R.model=r.model||void 0),R},M=()=>{if(x){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const T=n.find(se=>se.id===r.id),R=s.find(se=>se.id===r.id),Z=T||R;if(Z){Z.componentType==="IntegratedCircuit"&&console.log("[ComponentEditor] handleSave - Before updateComponent call:",{componentDatasheet:Z.datasheet,editorDatasheet:r.datasheet,editorDatasheetType:typeof r.datasheet,editorDatasheetLength:r.datasheet?.length,fullEditor:r});const se=Q(Z);Z.componentType==="IntegratedCircuit"&&console.log("[ComponentEditor] handleSave - After updateComponent call:",{updatedComponentDatasheet:se.datasheet,updatedComponentDatasheetType:typeof se.datasheet});const V=Z.layer,ee=r.layer;V!==ee?V==="top"?(o(ae=>ae.filter(Ce=>Ce.id!==r.id)),d(ae=>[...ae,se])):(d(ae=>ae.filter(Ce=>Ce.id!==r.id)),o(ae=>[...ae,se])):ee==="top"?o(ae=>{const Ce=ae.map(J=>J.id===r.id?(console.log("[ComponentEditor] Updating component in top array - datasheet:",se.datasheet),se):J),xe=Ce.find(J=>J.id===r.id);return xe&&xe.componentType==="IntegratedCircuit"&&console.log("[ComponentEditor] After state update - component datasheet in array:",xe.datasheet),Ce}):d(ae=>{const Ce=ae.map(J=>J.id===r.id?(console.log("[ComponentEditor] Updating component in bottom array - datasheet:",se.datasheet),se):J),xe=Ce.find(J=>J.id===r.id);return xe&&xe.componentType==="IntegratedCircuit"&&console.log("[ComponentEditor] After state update - component datasheet in array:",xe.datasheet),Ce})}else if(console.warn(`Component ${r.id} not found in either layer array`),r.layer==="top"){const se=s.find(V=>V.id===r.id);if(se){const V=Q(se);d(ee=>ee.filter(ae=>ae.id!==r.id)),o(ee=>[...ee,V])}}else{const se=n.find(V=>V.id===r.id);if(se){const V=Q(se);o(ee=>ee.filter(ae=>ae.id!==r.id)),d(ee=>[...ee,V])}}t(null),h(null)};return l.jsxs("div",{"data-component-editor-dialog":!0,onClick:T=>{if(c&&c.componentId===F.id){const R=T.target;(R.tagName==="BUTTON"||R.tagName==="INPUT"||R.closest("button")||R.closest("input"))&&T.stopPropagation()}},style:{position:"fixed",top:f?`${f.y}px`:"90px",left:f?`${f.x}px`:`${window.innerWidth-280}px`,transform:"none",background:c&&c.componentId===F.id?"rgba(255, 255, 255, 0.95)":"#fff",border:"1px solid #0b5fff",borderRadius:4,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"350px",width:"350px",maxHeight:"40vh",display:"flex",flexDirection:"column",pointerEvents:"auto",cursor:b?"grabbing":"default"},children:[l.jsxs("div",{onMouseDown:T=>{const R=T.target;R.tagName==="BUTTON"||R.tagName==="INPUT"||R.closest("button")||R.closest("input")||f&&(P({x:T.clientX-f.x,y:T.clientY-f.y}),S(!0),T.preventDefault())},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:b?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[l.jsx("h3",{style:{margin:0,fontSize:"13px",color:"#fff",fontWeight:600},children:"Component Properties"}),l.jsx("button",{onClick:()=>{t(null),h(null)},style:{background:"transparent",border:"none",fontSize:"15px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"6px 20px 6px 6px",overflowY:"auto",flex:1,minHeight:0},children:[(()=>{const T=e||_d(F);return l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Category:"}),l.jsx("div",{style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"11px",color:"#000"},children:T?.category||"N/A"})]})})(),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Type:"}),l.jsx("div",{style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"11px",color:"#000"},children:(()=>{const T=e||_d(F);return T?.displayName?F.componentType==="Capacitor"&&!T.displayName.toLowerCase().includes("capacitor")?`${T.displayName} Capacitor`:T.displayName:F.componentType==="GenericComponent"&&F.genericType?yc(F.genericType):F.componentType==="Diode"&&F.diodeType&&F.diodeType!=="Standard"?yc(F.diodeType):F.componentType==="VariableResistor"&&F.vrType&&F.vrType!=="Potentiometer"?yc(F.vrType):F.componentType==="Capacitor"&&F.dielectric==="Tantalum"?"Tantalum Capacitor":F.componentType==="Capacitor"&&F.capacitorType==="Electrolytic"?"Electrolytic Capacitor":F.componentType==="Capacitor"&&F.capacitorType==="Film"?"Film Capacitor":yc(F.componentType)})()})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-layer-${F.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Layer:"}),l.jsxs("select",{id:`component-layer-${F.id}`,name:`component-layer-${F.id}`,value:r.layer,onChange:T=>t({...r,layer:T.target.value}),disabled:x,style:{width:"80px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:x?.6:1},children:[l.jsx("option",{value:"top",children:"Top"}),l.jsx("option",{value:"bottom",children:"Bottom"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-orientation-${F.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Orientation:"}),l.jsxs("select",{id:`component-orientation-${F.id}`,name:`component-orientation-${F.id}`,value:r.orientation??0,onChange:T=>{const R=parseInt(T.target.value)||0;if(t({...r,orientation:R}),!x){const se=(r.layer==="top"?n:s).find(V=>V.id===r.id);if(se){const V={...se,orientation:R};r.layer==="top"?o(ee=>ee.map(ae=>ae.id===r.id?V:ae)):d(ee=>ee.map(ae=>ae.id===r.id?V:ae))}}},disabled:x,style:{width:"70px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:x?.6:1},children:[l.jsx("option",{value:"0",children:"0"}),l.jsx("option",{value:"90",children:"90"}),l.jsx("option",{value:"180",children:"180"}),l.jsx("option",{value:"270",children:"270"})]})]}),l.jsx(S3,{component:F,componentEditor:r,componentDefinition:e,setComponentEditor:t,areComponentsLocked:x,componentsTop:n,componentsBottom:s,uploadedDatasheetFile:z,setUploadedDatasheetFile:B,setComponentsTop:o,setComponentsBottom:d}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginTop:"4px",paddingTop:"4px",borderTop:"1px solid #e0e0e0"},children:[l.jsx("label",{htmlFor:`component-designator-${F.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Designator:"}),l.jsx("input",{id:`component-designator-${F.id}`,name:`component-designator-${F.id}`,type:"text",value:r.designator||"",onChange:T=>{const R=T.target.value,Z=R.length>0?R.charAt(0).toUpperCase():r.abbreviation;t({...r,designator:R,abbreviation:Z})},disabled:x,style:{width:"80px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",fontFamily:"monospace",textTransform:"uppercase",opacity:x?.6:1},placeholder:"e.g., U2, R7, C1"})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-description-${F.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Description:"}),l.jsx("input",{id:`component-description-${F.id}`,name:`component-description-${F.id}`,type:"text",value:r.description||"",onChange:T=>{t({...r,description:T.target.value})},disabled:x,style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:x?.6:1},placeholder:""})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-notes-${F.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Notes:"}),l.jsx("input",{id:`component-notes-${F.id}`,name:`component-notes-${F.id}`,type:"text",readOnly:!0,value:F.notes||"",onClick:()=>{x||(k(new Set([F.id])),N(!0))},disabled:x,style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:x?.6:1,cursor:x?"not-allowed":"pointer",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},placeholder:"Click to edit notes...",title:F.notes||"Click to edit notes..."})]}),F.componentType!=="IntegratedCircuit"&&l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-pincount-${F.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Pin Count:"}),l.jsx("input",{id:`component-pincount-${F.id}`,name:`component-pincount-${F.id}`,type:"number",min:"1",value:r.pinCount,onChange:T=>{const R=Math.max(1,parseInt(T.target.value)||1);t({...r,pinCount:R})},onBlur:T=>{if(x){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const R=Math.max(1,parseInt(T.target.value)||1),se=(r.layer==="top"?n:s).find(V=>V.id===r.id);if(se&&R!==se.pinCount){const V=se.pinConnections||[],ee=new Array(R).fill("").map((J,D)=>D<V.length?V[D]:""),ae=se.pinPolarities||[],Ce=se.pinPolarities?new Array(R).fill("").map((J,D)=>D<ae.length?ae[D]:""):void 0,xe={...se,pinCount:R,pinConnections:ee,...Ce!==void 0&&{pinPolarities:Ce}};r.layer==="top"?o(J=>J.map(D=>D.id===r.id?xe:D)):d(J=>J.map(D=>D.id===r.id?xe:D)),t({...r,pinCount:R})}},disabled:x,style:{width:"60px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:x?.6:1}})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-x-${F.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"X:"}),l.jsx("input",{id:`component-x-${F.id}`,name:`component-x-${F.id}`,type:"number",value:r.x.toFixed(2),onChange:T=>{const R=parseFloat(T.target.value)||0;t({...r,x:R})},disabled:x,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:x?.6:1}})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-y-${F.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Y:"}),l.jsx("input",{id:`component-y-${F.id}`,name:`component-y-${F.id}`,type:"number",value:r.y.toFixed(2),onChange:T=>{const R=parseFloat(T.target.value)||0;t({...r,y:R})},disabled:x,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:x?.6:1}})]}),l.jsxs("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid #e0e0e0"},children:[l.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:600,color:"#333",marginBottom:"2px"},children:"Pin Connections:"}),c&&c.componentId===F.id&&l.jsxs("div",{style:{padding:"2px 3px",background:"#fff3cd",border:"1px solid #ffc107",borderRadius:2,marginBottom:"2px",fontSize:"11px",color:"#856404"},children:["Pin ",c.pinIndex+1," selected. Click on a via or pad to connect."]}),(()=>{const T=Sp(F),Z=(r.layer==="top"?n:s).find(ue=>ue.id===r.id),se=Z?.pinNames,ee=(e||_d(F))?.properties?.pinNames,ae=ee&&ee.length>0,Ce=ae&&ee.includes("CHIP_DEPENDENT"),xe=ae&&!Ce,J=Ce,D=ae,W=async()=>{const ue=Pv(),Te=wT();if(!ue||!Te){alert(`Gemini API key is not configured.

For production/GitHub Pages: Enter your API key in the field below.
For development: Create a .env file with VITE_GEMINI_API_KEY=your_api_key_here

Get your free API key from: https://aistudio.google.com/apikey`);return}if(!z&&!r?.datasheet?.trim()){alert("Please upload a datasheet PDF file or enter a datasheet URL above before fetching pin names.");return}I(!0);try{let Pe;if(z)Pe=await z.arrayBuffer();else{const vt=r?.datasheet?.trim();try{const Dt=await fetch(vt);if(!Dt.ok)throw new Error(`Failed to fetch datasheet: ${Dt.statusText}`);Pe=await Dt.arrayBuffer()}catch(Dt){console.log("Direct fetch failed, trying CORS proxy...",Dt);const Ot=`https://api.allorigins.win/raw?url=${encodeURIComponent(vt)}`;try{const sn=await fetch(Ot);if(!sn.ok)throw new Error(`CORS proxy failed: ${sn.statusText}`);Pe=await sn.arrayBuffer()}catch{throw new Error(`Unable to fetch datasheet due to CORS restrictions. Please download the PDF and upload it using the file input above. Original error: ${Dt instanceof Error?Dt.message:"Unknown error"}`)}}}const Ve=await xv({data:Pe}).promise;let De="";for(let vt=1;vt<=Ve.numPages;vt++){const sn=(await(await Ve.getPage(vt)).getTextContent()).items.map(kt=>kt.str).join(" ");De+=sn+`
`}const et=2e4,ot=De.length>et?De.substring(0,et)+`
[... text truncated ...]`:De,at=`You are analyzing an electronic component datasheet. Extract the pin information and return it as a CSV table.

Requirements:
1. Return ONLY a CSV table with three columns: Pin #, Pin Name, Pin Description
2. Include a header row: "Pin #,Pin Name,Pin Description"
3. Extract information for pins 1 through ${r.pinCount} (inclusive)
4. For each pin, provide:
   - Pin #: The pin number (1, 2, 3, etc.)
   - Pin Name: The signal name (e.g., VCC, GND, IN+, OUT, etc.). Use the exact name from the datasheet.
   - Pin Description: A brief description of the pin's function (optional, can be empty)
5. If a pin description is not available, leave that field empty but keep the comma
6. Return ONLY the CSV data, no additional text, explanations, or markdown formatting
7. If you cannot find pin information for all ${r.pinCount} pins, still return what you find

Example format:
Pin #,Pin Name,Pin Description
1,VCC,Power supply positive
2,GND,Ground
3,IN+,Non-inverting input

Datasheet text:
${ot}`,ht=await fetch(Te,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:at}]}]})});if(!ht.ok){const vt=await ht.text();let Dt=`Gemini API error: ${ht.status} ${ht.statusText}`;try{const Ot=JSON.parse(vt);Ot.error&&Ot.error.message&&(Dt+=`. ${Ot.error.message}`)}catch{Dt+=`. ${vt.substring(0,200)}`}throw new Error(Dt)}const xt=await ht.json();let fe="";if(xt.candidates&&xt.candidates[0]){if(xt.candidates[0].finishReason&&xt.candidates[0].finishReason!=="STOP")throw new Error(`Gemini API response blocked: ${xt.candidates[0].finishReason}`);if(xt.candidates[0].content&&xt.candidates[0].content.parts){const vt=xt.candidates[0].content.parts;vt&&vt[0]&&vt[0].text&&(fe=vt[0].text.trim())}}if(!fe)throw new Error("No response text from Gemini API. The API may have returned an empty response.");fe=fe.replace(/^```[\w]*\n?/gm,"").replace(/\n?```$/gm,"");const Nt=new Array(r.pinCount).fill(""),zt=fe.split(`
`).filter(vt=>vt.trim().length>0);if(zt.length===0)throw new Error("No CSV data found in Gemini API response");let Bt=0;const it=zt[0].toLowerCase();(it.includes("pin #")||it.includes("pin,")||it.includes("pin number")||it.startsWith("pin"))&&(Bt=1);let qt=0;for(let vt=Bt;vt<zt.length;vt++){const Dt=zt[vt].trim();if(!Dt)continue;const Ot=[];let sn="",kt=!1;for(let Lt=0;Lt<Dt.length;Lt++){const Jn=Dt[Lt];Jn==='"'?kt=!kt:Jn===","&&!kt?(Ot.push(sn.trim()),sn=""):sn+=Jn}if(Ot.push(sn.trim()),Ot.length>=2){const Lt=parseInt(Ot[0],10);if(!isNaN(Lt)&&Lt>=1&&Lt<=r.pinCount){const Jn=Ot[1].replace(/^"|"$/g,"").trim();Nt[Lt-1]=Jn,qt++}}}if(qt===0)throw new Error("Could not parse any pin information from the CSV response. The format may be incorrect.");if(Z){const vt={...Z,pinNames:Nt};r.layer==="top"?o(Ot=>Ot.map(sn=>sn.id===r.id?vt:sn)):d(Ot=>Ot.map(sn=>sn.id===r.id?vt:sn));const Dt=Nt.filter(Ot=>Ot.length>0).length;Dt>0?alert(`Successfully fetched ${Dt} pin name(s) from datasheet. Please review and edit as needed.`):alert("Could not automatically extract pin names from the datasheet. Please enter them manually.")}}catch(Pe){console.error("Error fetching pin names:",Pe),alert(`Failed to fetch pin names: ${Pe instanceof Error?Pe.message:"Unknown error"}. Please enter pin names manually.`)}finally{I(!1)}},K=()=>{G.trim()?(localStorage.setItem("geminiApiKey",G.trim()),alert('API key saved! You can now use the "Fetch Pin Names" feature.')):(localStorage.removeItem("geminiApiKey"),alert("API key removed."))};return l.jsxs("div",{children:[D&&l.jsx("div",{style:{marginBottom:"8px",padding:"4px",background:"#f9f9f9",border:"1px solid #ddd",borderRadius:"3px"},children:l.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[l.jsx("label",{style:{fontSize:"11px",fontWeight:600,color:"#333",marginBottom:"2px"},children:"Google Gemini API Key (for AI pin name extraction from the Datasheet):"}),l.jsxs("div",{style:{display:"flex",gap:"4px",alignItems:"center",flexWrap:"wrap"},children:[l.jsx("input",{type:"password",value:G,onChange:ue=>te(ue.target.value),placeholder:"Enter your Gemini API key",style:{flex:1,minWidth:"200px",padding:"3px 6px",fontSize:"11px",border:"1px solid #ddd",borderRadius:"2px",background:"#fff",color:"#000"},title:"Enter your Google Gemini API key. Get one free at https://aistudio.google.com/apikey"}),l.jsx("button",{onClick:K,style:{padding:"3px 8px",fontSize:"11px",background:"#2196F3",color:"#fff",border:"none",borderRadius:"3px",cursor:"pointer",fontWeight:600,whiteSpace:"nowrap"},children:"Save API Key"}),l.jsx("button",{onClick:W,disabled:$||x,style:{padding:"3px 8px",fontSize:"11px",background:$||x?"#ccc":"#4CAF50",color:"#fff",border:"none",borderRadius:"3px",cursor:$||x?"not-allowed":"pointer",opacity:x?.6:1,fontWeight:600,whiteSpace:"nowrap"},children:$?"Fetching...":"Fetch Pin Names"})]})]})}),l.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px",marginTop:"2px"},children:[l.jsx("thead",{children:l.jsxs("tr",{style:{borderBottom:"1px solid #ddd",background:"#f5f5f5"},children:[l.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333",width:"20px"}}),l.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333",width:"40px"},children:"Pin"}),D&&l.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333",width:"70px"},children:"Pin Name"}),T&&l.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333",width:"50px"},children:"Polarity"}),l.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333"},children:"Node ID"})]})}),l.jsx("tbody",{children:Array.from({length:r.pinCount},(ue,Te)=>{const Pe=Z?.pinConnections&&Z.pinConnections.length>Te?Z.pinConnections[Te]:"",Ve=Z?.pinPolarities&&Z.pinPolarities.length>Te&&Z.pinPolarities[Te]||"",De=se&&Te<se.length?se[Te]:"",et=ee&&Te<ee.length?ee[Te]:"",ot=et==="CHIP_DEPENDENT",at=De&&De.trim()!==""?De:ot?"":et,ht=c&&c.componentId===F.id&&c.pinIndex===Te;return l.jsxs("tr",{style:{cursor:x?"not-allowed":"pointer",background:ht?"#e6f0ff":Pe?"#d4edda":"#fff",borderBottom:"1px solid #eee"},onClick:xt=>{if(xt.target.tagName!=="SELECT"){if(x){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}h(ht?null:{componentId:F.id,pinIndex:Te})}},title:Pe?`Connected to: ${Pe}`:"Select this pin, then click on a via or pad to connect",children:[l.jsx("td",{style:{padding:"2px 4px",textAlign:"center"},children:l.jsx("input",{id:`pin-radio-${F.id}-${Te}`,name:`pin-radio-${F.id}`,type:"radio",checked:!!ht,onChange:()=>{if(x){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}h(ht?null:{componentId:F.id,pinIndex:Te})},disabled:x,style:{margin:0,cursor:x?"not-allowed":"pointer",opacity:x?.6:1,width:"10px",height:"10px"}})}),l.jsx("td",{style:{padding:"2px 4px",color:"#333",fontWeight:ht?600:400,fontFamily:"monospace"},children:Te+1}),(xe||J)&&l.jsx("td",{style:{padding:"2px 4px",textAlign:"left"},children:xe?l.jsx("select",{value:at||"",onChange:xt=>{if(x){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const fe=xt.target.value,zt=(r.layer==="top"?n:s).find(Bt=>Bt.id===r.id);if(zt){const it=[...zt.pinNames||(ee?[...ee]:[])];for(;it.length<r.pinCount;)it.push("");it[Te]=fe;const qt={...zt,pinNames:it};r.layer==="top"?o(vt=>vt.map(Dt=>Dt.id===r.id?qt:Dt)):d(vt=>vt.map(Dt=>Dt.id===r.id?qt:Dt))}},disabled:x,onClick:xt=>xt.stopPropagation(),onFocus:xt=>xt.stopPropagation(),style:{padding:"2px 4px",fontSize:"11px",border:"1px solid #ddd",borderRadius:2,background:"#fff",color:"#333",cursor:x?"not-allowed":"pointer",opacity:x?.6:1,width:"100%",fontStyle:"italic",minHeight:"18px"},children:ee&&ee.length>0?ee.filter(xt=>xt!=="CHIP_DEPENDENT").map((xt,fe)=>l.jsx("option",{value:xt,children:xt},fe)):l.jsx("option",{value:"",children:"-"})}):l.jsx("input",{type:"text",value:at||"",onChange:xt=>{if(x){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const fe=xt.target.value,zt=(r.layer==="top"?n:s).find(Bt=>Bt.id===r.id);if(zt){const it=[...zt.pinNames||[]];for(;it.length<r.pinCount;)it.push("");it[Te]=fe;const qt={...zt,pinNames:it};r.layer==="top"?o(vt=>vt.map(Dt=>Dt.id===r.id?qt:Dt)):d(vt=>vt.map(Dt=>Dt.id===r.id?qt:Dt))}},disabled:x,onClick:xt=>xt.stopPropagation(),onFocus:xt=>xt.stopPropagation(),placeholder:"Pin name",style:{padding:"1px 2px",fontSize:"11px",border:"1px solid #ddd",borderRadius:2,background:"#fff",color:"#333",width:"100%",opacity:x?.6:1,cursor:x?"not-allowed":"text"}})}),T&&l.jsx("td",{style:{padding:"2px 4px",textAlign:"center"},children:Pe?l.jsx("span",{style:{fontFamily:"monospace",fontWeight:600,color:Ve==="+"?"#d32f2f":Ve==="-"?"#1976d2":"#999"},children:Ve||"-"}):l.jsxs("select",{value:Ve??"",onChange:xt=>{if(x){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const fe=xt.target.value,zt=(r.layer==="top"?n:s).find(Bt=>Bt.id===r.id);if(zt){const it=[...zt.pinPolarities||new Array(zt.pinCount).fill("")];for(;it.length<zt.pinCount;)it.push("");it[Te]=fe;const qt={...zt,pinPolarities:it};r.layer==="top"?o(vt=>vt.map(Dt=>Dt.id===r.id?qt:Dt)):d(vt=>vt.map(Dt=>Dt.id===r.id?qt:Dt))}},disabled:x,onClick:xt=>xt.stopPropagation(),onFocus:xt=>xt.stopPropagation(),style:{padding:"1px 2px",fontSize:"11px",border:"1px solid #ddd",borderRadius:2,background:"#fff",cursor:x?"not-allowed":"pointer",opacity:x?.6:1,width:"100%",fontFamily:"monospace",fontWeight:600},children:[l.jsx("option",{value:"",children:"-"}),l.jsx("option",{value:"+",children:"+"}),l.jsx("option",{value:"-",children:"-"})]},`polarity-${F.id}-${Te}-${Ve}`)}),l.jsx("td",{style:{padding:"2px 4px",color:Pe?"#28a745":"#999",fontWeight:Pe?600:400,fontFamily:"monospace"},children:Pe||"-"})]},Te)})})]})]})})()]})]}),l.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"6px",padding:"6px",borderTop:"1px solid #e0e0e0",flexShrink:0},children:[l.jsx("button",{onClick:()=>{t(null),h(null)},disabled:x,style:{padding:"2px 5px",background:x?"#f5f5f5":"#fff",color:x?"#999":"#333",border:"1px solid #ddd",borderRadius:2,cursor:x?"not-allowed":"pointer",fontSize:"11px",opacity:x?.6:1},children:"Cancel"}),l.jsx("button",{onClick:M,disabled:x,style:{padding:"2px 5px",background:x?"#f5f5f5":"#0b5fff",color:x?"#999":"#fff",border:"1px solid #ddd",borderRadius:2,cursor:x?"not-allowed":"pointer",fontSize:"11px",opacity:x?.6:1},children:"Save"})]})]})};function CT(r){if(r.baseType)return r.baseType;switch(r.category){case"Capacitors":return"Capacitor";case"Diodes":return"Diode";case"Resistors":return"Resistor";case"Semiconductors":return"Semiconductor";case"Passive Components":return"Passive";case"Power & Energy":return"PowerEnergy";case"Connectors & Switches":return r.type==="Switch"||r.subcategory==="Switch"?"Switch":"Connector";case"Other":return r.type==="Transformer"?"Transformer":"Other";default:return"Other"}}const TT=i0.components,_T=TT.map(r=>{const e=`${r.category}:${r.subcategory}:${r.type}`,t=CT(r);return{...r,key:e,baseType:t}}),Ev=new Map;_T.forEach(r=>{Ev.set(r.key,r)});function kT(r){if(r)return Ev.get(r)}const Bm=r=>{const{category:e,subcategory:t,type:n,designator:s}=r;let o,d;switch(e){case"Capacitors":t==="Electrolytic"?o="Electrolytic Capacitor":t==="Film"?o="Film Capacitor":(o="Capacitor",t==="Tantalum"&&(d="Tantalum"));break;case"Diodes":o="Diode",t==="LED"?d="LED":t==="Infrared"?d="Infrared":t==="Photodiode"?d="Photodiode":t==="Schottky"?d="Schottky":t==="Zener"?d="Zener":d="Standard";break;case"Resistors":t==="Network"?(o="ResistorNetwork",d="Network"):t==="Thermistor"?(o="Thermistor",d="Thermistor"):t==="Variable"?(o="VariableResistor",d="Potentiometer"):t==="Varistor"?(o="VariableResistor",d="Varistor"):o="Resistor";break;case"Semiconductors":t==="BJT"||t==="MOSFET"||t==="JFET"?o="Transistor":o="IntegratedCircuit";break;case"Passive Components":n==="Inductor"?o="Inductor":n==="FerriteBead"?o="FerriteBead":o="Crystal";break;case"Power & Energy":t==="Battery"?o="Battery":t==="Power Supply"?o="PowerSupply":o="Fuse";break;case"Connectors & Switches":t==="Connector"?o="Connector":t==="Jumper"?o="Jumper":t==="Switch"?o="Switch":o="Relay";break;case"Other":t==="Transformer"?o="Transformer":t==="Speaker"?o="Speaker":t==="Motor"?o="Motor":t==="Test Point"?o="TestPoint":t==="Vacuum Tube"?o="VacuumTube":(o="GenericComponent",t==="Attenuator"?d="Attenuator":t==="Circuit Breaker"?d="CircuitBreaker":t==="Thermocouple"?d="Thermocouple":t==="Tuner"&&(d="Tuner"));break;default:o="GenericComponent";break}const c=`${e}:${t}:${n}:${s}`,h=`${e}:${t}:${n}`,f=kT(h);return{componentType:o,designator:s,subtype:d,uniqueKey:c,componentDefinition:r,dataDrivenDefinition:f}},Rv=Du.reduce((r,e)=>(r[e.category]||(r[e.category]=[]),r[e.category].push(e),r),{});Object.values(Rv).forEach(r=>{r.sort((e,t)=>e.displayName.localeCompare(t.displayName))});const NT=({visible:r,selectedLayer:e,selectedComponentType:t,selectedComponentKey:n,onLayerChange:s,onComponentTypeChange:o,onClose:d})=>{const[c,h]=X.useState(""),[f,m]=X.useState(null),[b,S]=X.useState(!1),v=X.useRef({x:0,y:0}),P=X.useRef(null),x=X.useRef(null);X.useEffect(()=>{r&&f===null&&m({x:window.innerWidth-400-8,y:130})},[r,f]),X.useEffect(()=>{if(r&&x.current){const B=setTimeout(()=>{x.current?.focus(),x.current?.select()},100);return()=>clearTimeout(B)}},[r]);const k=X.useCallback(B=>{const G=B.target;if(!(G.tagName==="BUTTON"||G.tagName==="INPUT"||G.closest("button")||G.closest("input"))&&P.current){const te=P.current.getBoundingClientRect();v.current={x:B.clientX-te.left,y:B.clientY-te.top},S(!0),B.preventDefault()}},[]);X.useEffect(()=>{if(!b)return;const B=te=>{const F=te.clientX-v.current.x,H=te.clientY-v.current.y,Q=P.current?.offsetWidth||400,M=P.current?.offsetHeight||600,T=Math.max(0,Math.min(F,window.innerWidth-Q)),R=Math.max(0,Math.min(H,window.innerHeight-M));m({x:T,y:R})},G=()=>{S(!1)};return document.addEventListener("mousemove",B),document.addEventListener("mouseup",G),()=>{document.removeEventListener("mousemove",B),document.removeEventListener("mouseup",G)}},[b]);const N=X.useMemo(()=>{if(!c.trim())return()=>!0;const B=c.toLowerCase();return G=>!!(G.searchText&&G.searchText.toLowerCase().includes(B)||G.displayName&&G.displayName.toLowerCase().includes(B)||G.description&&G.description.toLowerCase().includes(B)||G.category&&G.category.toLowerCase().includes(B)||G.subcategory&&G.subcategory.toLowerCase().includes(B)||G.designator&&G.designator.toLowerCase().includes(B)||G.type&&G.type.toLowerCase().includes(B)||G.resolvedTypeName&&G.resolvedTypeName.toLowerCase().includes(B))},[c]),$=X.useMemo(()=>c.trim()?Du.filter(B=>{const G=Bm(B);return N({category:B.category,type:G.componentType,subcategory:B.subcategory,designator:B.designator,displayName:B.displayName,description:B.description,resolvedTypeName:yc(G.componentType),searchText:B.searchText})}):Du,[c,N]);if(!r)return null;const I={position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"flex-start",justifyContent:"flex-end",zIndex:10005,pointerEvents:"none"},z={padding:"20px",overflow:"auto",flex:1};return l.jsx("div",{style:I,onClick:B=>B.stopPropagation(),children:l.jsxs("div",{ref:P,onClick:B=>B.stopPropagation(),style:{position:"fixed",top:f?`${f.y}px`:void 0,left:f?`${f.x}px`:void 0,backgroundColor:"#fff",borderRadius:8,minWidth:"300px",maxWidth:"400px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:10005,display:"flex",flexDirection:"column",pointerEvents:"auto",transform:"none"},children:[l.jsxs("div",{onMouseDown:k,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:b?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[l.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Select Component"}),l.jsx("button",{type:"button",onMouseDown:B=>{B.stopPropagation()},onClick:B=>{B.stopPropagation(),d()},style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),l.jsxs("div",{style:z,children:[l.jsx("div",{style:{marginBottom:"16px"},onClick:B=>B.stopPropagation(),children:l.jsx("input",{ref:x,type:"text",placeholder:"Search by Component Type...",value:c,onChange:B=>h(B.target.value),onClick:B=>B.stopPropagation(),onMouseDown:B=>B.stopPropagation(),style:{width:"100%",padding:"8px 12px",fontSize:"13px",border:"1px solid #ddd",borderRadius:4,color:"#333",backgroundColor:"#fff",boxSizing:"border-box"}})}),l.jsxs("div",{style:{marginBottom:"20px",paddingBottom:"16px",borderBottom:"2px solid #eee"},onClick:B=>B.stopPropagation(),children:[l.jsx("div",{style:{marginBottom:"8px",fontSize:"14px",fontWeight:600,color:"#333"},children:"Layer:"}),l.jsxs("div",{style:{display:"flex",gap:"16px"},children:[l.jsxs("label",{onClick:B=>B.stopPropagation(),onMouseDown:B=>B.stopPropagation(),style:{display:"flex",alignItems:"center",cursor:"pointer",fontSize:"14px",color:"#333"},children:[l.jsx("input",{type:"radio",name:"componentLayer",checked:e==="top",onChange:()=>s("top"),onClick:B=>B.stopPropagation(),onMouseDown:B=>B.stopPropagation(),style:{marginRight:"8px",width:"20px",height:"20px",cursor:"pointer",accentColor:"#0066cc",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",border:e==="top"?"2px solid #0066cc":"2px solid #999",borderRadius:"50%",backgroundColor:e==="top"?"#0066cc":"transparent",position:"relative"}}),"Top"]}),l.jsxs("label",{onClick:B=>B.stopPropagation(),onMouseDown:B=>B.stopPropagation(),style:{display:"flex",alignItems:"center",cursor:"pointer",fontSize:"14px",color:"#333"},children:[l.jsx("input",{type:"radio",name:"componentLayer",checked:e==="bottom",onChange:()=>s("bottom"),onClick:B=>B.stopPropagation(),onMouseDown:B=>B.stopPropagation(),style:{marginRight:"8px",width:"20px",height:"20px",cursor:"pointer",accentColor:"#0066cc",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",border:e==="bottom"?"2px solid #0066cc":"2px solid #999",borderRadius:"50%",backgroundColor:e==="bottom"?"#0066cc":"transparent",position:"relative"}}),"Bottom"]})]})]}),l.jsxs("div",{children:[l.jsx("div",{style:{marginBottom:"12px",fontSize:"14px",fontWeight:600,color:"#333"},children:"Component Type:"}),l.jsx("div",{style:{maxHeight:"calc(80vh - 280px)",overflowY:"auto"},children:c.trim()?$.length>0?$.map(B=>{const G=Bm(B),te=G.uniqueKey||`${B.category}:${B.subcategory}:${B.type}:${B.designator}`,F=n===te,H=`${B.designator} - ${B.displayName}`;return l.jsxs("label",{onClick:Q=>{Q.stopPropagation(),o(G.componentType,te,G)},onMouseDown:Q=>Q.stopPropagation(),style:{display:"block",width:"100%",textAlign:"left",padding:"8px 12px",marginBottom:"4px",background:F?"#e6f0ff":"#fff",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",fontSize:"12px",color:"#333"},children:[l.jsx("input",{type:"radio",name:"componentType-search",checked:F,onChange:()=>o(G.componentType,te,G),onClick:Q=>Q.stopPropagation(),onMouseDown:Q=>Q.stopPropagation(),style:{marginRight:"10px",width:"20px",height:"20px",cursor:"pointer",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",border:F?"2px solid #0066cc":"2px solid #999",borderRadius:"50%",backgroundColor:F?"#0066cc":"transparent",position:"relative",flexShrink:0}}),l.jsx("strong",{children:H})]},te)}):l.jsxs("div",{style:{padding:"12px",color:"#666",fontSize:"12px",textAlign:"center"},children:['No matches found for "',c,'"']}):Object.entries(Rv).map(([B,G])=>G.length===0?null:l.jsxs("div",{style:{marginBottom:"12px"},children:[l.jsx("div",{style:{fontSize:"13px",fontWeight:600,color:"#333",padding:"6px 8px",marginBottom:"4px",backgroundColor:"#f5f5f5",borderRadius:4},children:B}),l.jsx("div",{style:{marginLeft:"8px"},children:G.map(te=>{const F=Bm(te),H=F.uniqueKey||`${te.category}:${te.subcategory}:${te.type}:${te.designator}`,Q=n===H,M=`${te.designator} - ${te.displayName}`;return l.jsxs("label",{onClick:T=>{T.stopPropagation(),o(F.componentType,H,F)},onMouseDown:T=>T.stopPropagation(),style:{display:"block",width:"100%",textAlign:"left",padding:"6px 12px",marginBottom:"2px",background:Q?"#e6f0ff":"#fff",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",fontSize:"12px",color:"#333"},children:[l.jsx("input",{type:"radio",name:`componentType-${B}`,checked:Q,onChange:()=>o(F.componentType,H,F),onMouseDown:T=>T.stopPropagation(),style:{marginRight:"10px",width:"20px",height:"20px",cursor:"pointer",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",border:Q?"2px solid #0066cc":"2px solid #999",borderRadius:"50%",backgroundColor:Q?"#0066cc":"transparent",position:"relative",flexShrink:0}}),M]},H)})})]},B))})]})]})]})})},jT=({visible:r,onClose:e,powerBuses:t,setPowerBuses:n,editingPowerBusId:s,setEditingPowerBusId:o,powers:d})=>{const[c,h]=X.useState(null),[f,m]=X.useState(!1),[b,S]=X.useState(null),v=X.useRef(null);X.useEffect(()=>{r&&!c&&h({x:window.innerWidth/2-140,y:window.innerHeight/2-200})},[r,c]),X.useEffect(()=>{if(!f)return;const z=G=>{c&&b&&h({x:G.clientX-b.x,y:G.clientY-b.y})},B=()=>{m(!1),S(null)};return window.addEventListener("mousemove",z),window.addEventListener("mouseup",B),()=>{window.removeEventListener("mousemove",z),window.removeEventListener("mouseup",B)}},[f,c,b]);const P=t.filter(z=>z.id!==s),x=t.find(z=>z.id===s);if(!r)return null;const k=[...P].sort((z,B)=>{const G=H=>{const Q=H.match(/([+-]?)(\d+\.?\d*)/);if(Q){const M=Q[1]||"+",T=parseFloat(Q[2]);return{absValue:Math.abs(T),isNegative:M==="-"}}return{absValue:1/0,isNegative:!1}},te=G(z.voltage),F=G(B.voltage);return te.absValue!==F.absValue?te.absValue-F.absValue:te.isNegative!==F.isNegative?te.isNegative?-1:1:0}),N=x?[...k,x]:k,$=()=>{const z={id:`powerbus-${Date.now()}-${Math.random()}`,name:"New Power Bus",voltage:"+0.0",color:"#ff0000"};n(B=>[...B,z]),o(z.id)},I=z=>{const B=z.target;B.tagName==="BUTTON"||B.tagName==="INPUT"||B.closest("button")||B.closest("input")||c&&(S({x:z.clientX-c.x,y:z.clientY-c.y}),m(!0),z.preventDefault())};return l.jsxs("div",{ref:v,style:{position:"fixed",top:c?`${c.y}px`:"50%",left:c?`${c.x}px`:"50%",transform:c?"none":"translate(-50%, -50%)",background:"#fff",border:"1px solid #0b5fff",borderRadius:4,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"280px",maxWidth:"320px",maxHeight:"80vh",display:"flex",flexDirection:"column",cursor:f?"grabbing":"default"},children:[l.jsxs("div",{onMouseDown:I,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:f?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[l.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Manage Power Buses"}),l.jsx("button",{onClick:e,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"6px 20px 6px 6px",overflowY:"auto",flex:1,minHeight:0},children:N.map(z=>{const B=t.find(H=>H.id===z.id)||z,G=t.findIndex(H=>H.id===z.id),te=t.some(H=>H.name===B.name&&H.id!==z.id),F=t.some(H=>H.voltage===B.voltage&&H.id!==z.id);return l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"4px",marginBottom:"4px",background:"#f9f9f9",borderRadius:4,border:"1px solid #e0e0e0"},children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsxs("div",{style:{flex:1,minWidth:0,display:"flex",flexDirection:"column",gap:"4px"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"50px",flexShrink:0},children:"Name:"}),l.jsx("input",{type:"text",value:B.name,onChange:H=>{const Q=H.target.value;if(!t.some(T=>T.name===Q&&T.id!==z.id)){const T=[...t];G>=0&&(T[G]={...B,name:Q},n(T))}},placeholder:"e.g., +5VDC",style:{flex:1,padding:"2px 3px",border:te?"1px solid #ff0000":"1px solid #ddd",borderRadius:2,fontSize:"10px",background:"#f5f5f5",color:"#000"}})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"50px",flexShrink:0},children:"Value:"}),l.jsx("input",{type:"text",inputMode:"decimal",value:B.voltage,onChange:H=>{const Q=H.target.value;if(Q===""||/^[+-]?\d*\.?\d*$/.test(Q)){const M=[...t];G>=0&&(M[G]={...B,voltage:Q},n(M))}},onBlur:H=>{const Q=H.target.value.trim();if(Q==="")return;const M=parseFloat(Q);if(!isNaN(M)){const T=M>=0?"+":"-",R=Math.abs(M),Z=`${T}${R.toFixed(1).replace(/\.?0+$/,"")}`,se=[...t];G>=0&&(se[G]={...B,voltage:Z},n(se))}},placeholder:"e.g., +5.0",style:{flex:1,padding:"2px 3px",border:F?"1px solid #ff0000":"1px solid #ddd",borderRadius:2,fontSize:"10px",background:"#f5f5f5",color:"#000"}})]})]}),l.jsx("input",{type:"color",value:B.color,onChange:H=>{const Q=[...t];G>=0&&(Q[G]={...B,color:H.target.value},n(Q))},style:{width:"24px",height:"24px",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",flexShrink:0},title:"Color"}),l.jsx("button",{onClick:()=>{const H=d.filter(Q=>Q.powerBusId===z.id);if(H.length>0){alert(`Cannot delete: ${H.length} power node(s) are using this bus. Remove or reassign them first.`);return}n(Q=>Q.filter(M=>M.id!==z.id))},style:{padding:"2px 6px",background:"#f5f5f5",color:"#333",border:"1px solid #ddd",borderRadius:2,cursor:"pointer",fontSize:"9px",flexShrink:0},children:"Delete"})]})},z.id)})}),l.jsxs("div",{style:{padding:"6px",borderTop:"1px solid #e0e0e0",display:"flex",gap:"4px",flexShrink:0},children:[l.jsx("button",{onClick:$,style:{flex:1,padding:"4px 8px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",fontSize:"10px"},children:"+ Add Power Bus"}),l.jsx("button",{onClick:e,style:{flex:1,padding:"4px 8px",background:"#0b5fff",color:"#fff",border:"none",borderRadius:2,cursor:"pointer",fontSize:"10px",fontWeight:500},children:"Close"})]})]})},PT=({visible:r,onClose:e,groundBuses:t,setGroundBuses:n,editingGroundBusId:s,setEditingGroundBusId:o,grounds:d})=>{const[c,h]=X.useState(null),[f,m]=X.useState(!1),[b,S]=X.useState(null),v=X.useRef(null);X.useEffect(()=>{r&&!c&&h({x:window.innerWidth/2-140,y:window.innerHeight/2-200})},[r,c]),X.useEffect(()=>{if(!f)return;const z=G=>{c&&b&&h({x:G.clientX-b.x,y:G.clientY-b.y})},B=()=>{m(!1),S(null)};return window.addEventListener("mousemove",z),window.addEventListener("mouseup",B),()=>{window.removeEventListener("mousemove",z),window.removeEventListener("mouseup",B)}},[f,c,b]);const P=t.filter(z=>z.id!==s),x=t.find(z=>z.id===s);if(!r)return null;const k=[...P].sort((z,B)=>z.name.localeCompare(B.name)),N=x?[...k,x]:k,$=()=>{const z={id:`groundbus-${Date.now()}-${Math.random()}`,name:"New Ground Bus",color:"#000000"};n(B=>[...B,z]),o(z.id)},I=z=>{const B=z.target;B.tagName==="BUTTON"||B.tagName==="INPUT"||B.closest("button")||B.closest("input")||c&&(S({x:z.clientX-c.x,y:z.clientY-c.y}),m(!0),z.preventDefault())};return l.jsxs("div",{ref:v,style:{position:"fixed",top:c?`${c.y}px`:"50%",left:c?`${c.x}px`:"50%",transform:c?"none":"translate(-50%, -50%)",background:"#fff",border:"1px solid #0b5fff",borderRadius:4,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"280px",maxWidth:"320px",maxHeight:"80vh",display:"flex",flexDirection:"column",cursor:f?"grabbing":"default"},children:[l.jsxs("div",{onMouseDown:I,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:f?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[l.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Manage Ground Buses"}),l.jsx("button",{onClick:e,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"6px 20px 6px 6px",overflowY:"auto",flex:1,minHeight:0},children:N.map(z=>{const B=t.find(F=>F.id===z.id)||z,G=t.findIndex(F=>F.id===z.id),te=t.some(F=>F.name===B.name&&F.id!==z.id);return l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",padding:"4px",marginBottom:"4px",background:"#f9f9f9",borderRadius:4,border:"1px solid #e0e0e0"},children:[l.jsx("div",{style:{flex:1,minWidth:0},children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"50px",flexShrink:0},children:"Name:"}),l.jsx("input",{type:"text",value:B.name,onChange:F=>{const H=F.target.value;if(!t.some(M=>M.name===H&&M.id!==z.id)){const M=[...t];G>=0&&(M[G]={...B,name:H},n(M))}},placeholder:"e.g., GND, Earth",style:{flex:1,padding:"2px 3px",border:te?"1px solid #ff0000":"1px solid #ddd",borderRadius:2,fontSize:"10px",background:"#f5f5f5",color:"#000"}})]})}),l.jsx("input",{type:"color",value:B.color,onChange:F=>{const H=[...t];G>=0&&(H[G]={...B,color:F.target.value},n(H))},style:{width:"24px",height:"24px",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",flexShrink:0},title:"Color"}),l.jsx("button",{onClick:()=>{const F=d.filter(H=>H.groundBusId===z.id);if(F.length>0){alert(`Cannot delete: ${F.length} ground node(s) are using this bus. Remove or reassign them first.`);return}n(H=>H.filter(Q=>Q.id!==z.id))},style:{padding:"2px 6px",background:"#f5f5f5",color:"#333",border:"1px solid #ddd",borderRadius:2,cursor:"pointer",fontSize:"9px",flexShrink:0},children:"Delete"})]},z.id)})}),l.jsxs("div",{style:{padding:"6px",borderTop:"1px solid #e0e0e0",display:"flex",gap:"4px",flexShrink:0},children:[l.jsx("button",{onClick:$,style:{flex:1,padding:"4px 8px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",fontSize:"10px"},children:"+ Add Ground Bus"}),l.jsx("button",{onClick:e,style:{flex:1,padding:"4px 8px",background:"#0b5fff",color:"#fff",border:"none",borderRadius:2,cursor:"pointer",fontSize:"10px",fontWeight:500},children:"Close"})]})]})},ET=({visible:r,onClose:e,autoAssignDesignators:t,setAutoAssignDesignators:n,useGlobalDesignatorCounters:s,setUseGlobalDesignatorCounters:o})=>r?l.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#fff",border:"1px solid #ddd",borderRadius:6,padding:"16px",zIndex:1e3,minWidth:"300px",maxWidth:"400px",boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[l.jsx("h2",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#222"},children:"Manage Designators"}),l.jsx("button",{onClick:e,style:{background:"transparent",border:"none",fontSize:"18px",cursor:"pointer",color:"#666",padding:0,width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),l.jsxs("div",{style:{marginBottom:"16px"},children:[l.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:"13px",color:"#333",marginBottom:"12px"},children:[l.jsx("input",{type:"checkbox",checked:t,onChange:d=>{n(d.target.checked)},style:{width:"16px",height:"16px",cursor:"pointer"}}),l.jsx("span",{children:"Automatically assign designators"})]}),l.jsx("div",{style:{marginTop:"8px",padding:"8px",background:"#f5f5f5",borderRadius:4,fontSize:"11px",color:"#666",lineHeight:"1.4",marginBottom:"12px"},children:t?l.jsx("div",{children:"When enabled, new components automatically receive sequential designators (e.g., C1, C2, C3 for Capacitors; R1, R2, R3 for Resistors)."}):l.jsx("div",{children:"When disabled, you must manually assign designators to each component. The designator field will be empty when components are created."})}),l.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:"13px",color:"#333"},children:[l.jsx("input",{type:"checkbox",checked:s,onChange:d=>{o(d.target.checked)},style:{width:"16px",height:"16px",cursor:"pointer"}}),l.jsx("span",{children:"Use global designator counters"})]}),l.jsx("div",{style:{marginTop:"8px",padding:"8px",background:"#f5f5f5",borderRadius:4,fontSize:"11px",color:"#666",lineHeight:"1.4"},children:s?l.jsx("div",{children:"When ON, designators continue from global counters across all projects. New components start with the next value from the global counter (e.g., if global counter is C10, new capacitor will be C11)."}):l.jsx("div",{children:"When OFF (default), designators start at 1 for each project. Each project maintains its own independent designator sequence (e.g., C1, C2, C3...)."})})]}),l.jsx("button",{onClick:e,style:{width:"100%",padding:"6px 12px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:4,cursor:"pointer",fontSize:"12px"},children:"Close"})]}):null,Zb=({visible:r,title:e,message:t,onYes:n,onNo:s,onCancel:o,yesButtonRef:d})=>r?l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001},onClick:c=>{c.target===c.currentTarget&&o()},children:l.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:c=>c.stopPropagation(),children:[l.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:e}),l.jsx("p",{style:{margin:"0 0 24px 0",fontSize:"14px",color:"#e0e0e0",lineHeight:"1.5"},children:t}),l.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[l.jsx("button",{onClick:o,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),l.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"No"}),l.jsx("button",{ref:d,onClick:n,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},autoFocus:!0,children:"Yes"})]})]})}):null,RT=({visible:r,size:e,onSizeChange:t,onApply:n,onCancel:s})=>{const o=X.useRef(null);if(X.useEffect(()=>{r&&o.current&&(o.current.focus(),o.current.select())},[r]),!r)return null;const d=[2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32];return l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10003},onClick:c=>{c.target===c.currentTarget&&s()},children:l.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:c=>c.stopPropagation(),children:[l.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Set Size"}),l.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Size (pixels):"}),l.jsx("input",{ref:o,type:"number",min:"1",max:"99",value:e,onChange:c=>{const h=parseInt(c.target.value)||1,f=Math.max(1,Math.min(99,h));t(f)},onKeyDown:c=>{if(c.key==="Enter"?n():c.key==="Escape"&&s(),c.key.length===1&&/[0-9]/.test(c.key)){const h=e.toString();h.length>=2&&o.current?.selectionStart===o.current?.selectionEnd&&o.current?.selectionStart===h.length&&c.preventDefault()}},onInput:c=>{const h=c.target,f=h.value;if(f.length>2){h.value=f.slice(0,2);const m=parseInt(h.value)||1;t(Math.max(1,Math.min(99,m)))}},style:{width:"100%",padding:"8px 12px",marginBottom:"16px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0}),l.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Or select from list:"}),l.jsxs("select",{value:d.includes(e)?e:"",onChange:c=>{const h=parseInt(c.target.value);!isNaN(h)&&h>0&&t(h)},style:{width:"100%",padding:"8px 12px",marginBottom:"20px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},children:[l.jsx("option",{value:"",style:{background:"#1f1f24",color:"#f2f2f2"},children:"-- Select --"}),d.map(c=>l.jsxs("option",{value:c,style:{background:"#1f1f24",color:"#f2f2f2"},children:[c," pixels"]},c))]}),l.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[l.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),l.jsx("button",{onClick:n,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Apply"})]})]})})},DT=({visible:r,interval:e,onIntervalChange:t,onApply:n,onCancel:s})=>r?l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10003},onClick:o=>{o.target===o.currentTarget&&s()},children:l.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:o=>o.stopPropagation(),children:[l.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Auto Save"}),l.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Select time interval:"}),l.jsxs("select",{value:e===null?"disable":(e||5).toString(),onChange:o=>{const d=o.target.value;if(d==="disable")t(null);else{const c=parseFloat(d);!isNaN(c)&&c>0&&t(c)}},style:{width:"100%",padding:"8px 12px",marginBottom:"20px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0,children:[l.jsx("option",{value:"1",style:{background:"#1f1f24",color:"#f2f2f2"},children:"1 minute"}),l.jsx("option",{value:"5",style:{background:"#1f1f24",color:"#f2f2f2"},children:"5 minutes"}),l.jsx("option",{value:"10",style:{background:"#1f1f24",color:"#f2f2f2"},children:"10 minutes"}),l.jsx("option",{value:"20",style:{background:"#1f1f24",color:"#f2f2f2"},children:"20 minutes"}),l.jsx("option",{value:"30",style:{background:"#1f1f24",color:"#f2f2f2"},children:"30 minutes"}),l.jsx("option",{value:"disable",style:{background:"#1f1f24",color:"#f2f2f2"},children:"Disable"})]}),l.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[l.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),l.jsx("button",{onClick:n,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Apply"})]})]})}):null,LT=({visible:r,interval:e,onIntervalChange:t,onEnable:n,onSkip:s})=>r?l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:o=>{o.target===o.currentTarget&&s()},children:l.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:o=>o.stopPropagation(),children:[l.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Enable Auto Save?"}),l.jsx("p",{style:{margin:"0 0 20px 0",fontSize:"14px",color:"#e0e0e0",lineHeight:"1.5"},children:"We recommend enabling Auto Save to automatically save your project at regular intervals. This helps protect your work from accidental loss."}),l.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Select time interval:"}),l.jsxs("select",{value:e===null?"disable":(e||5).toString(),onChange:o=>{const d=o.target.value;if(d==="disable")t(null);else{const c=parseFloat(d);!isNaN(c)&&c>0&&t(c)}},style:{width:"100%",padding:"8px 12px",marginBottom:"24px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0,children:[l.jsx("option",{value:"1",style:{background:"#1f1f24",color:"#f2f2f2"},children:"1 minute"}),l.jsx("option",{value:"5",style:{background:"#1f1f24",color:"#f2f2f2"},children:"5 minutes"}),l.jsx("option",{value:"10",style:{background:"#1f1f24",color:"#f2f2f2"},children:"10 minutes"}),l.jsx("option",{value:"20",style:{background:"#1f1f24",color:"#f2f2f2"},children:"20 minutes"}),l.jsx("option",{value:"30",style:{background:"#1f1f24",color:"#f2f2f2"},children:"30 minutes"})]}),l.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[l.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Skip"}),l.jsx("button",{onClick:n,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Enable Auto Save"})]})]})}):null,MT=({visible:r,projectDirHandle:e,onClose:t,onRestore:n,position:s,isDragging:o=!1,onDragStart:d})=>{const[c,h]=X.useState([]),[f,m]=X.useState(!1),[b,S]=X.useState(null),[v,P]=X.useState(null),x=X.useRef(null);X.useEffect(()=>{if(!r||!e){h([]),S(null),P(null);return}(async()=>{m(!0),P(null);try{let B;try{B=await e.getDirectoryHandle("history")}catch{h([]),m(!1);return}const G=F=>{const H=F.match(/_(\d{4})_(\d{2})_(\d{2})-(\d{2})-(\d{2})-(\d{2})\.json$/);if(H){const[,M,T,R,Z,se,V]=H;return new Date(parseInt(M),parseInt(T)-1,parseInt(R),parseInt(Z),parseInt(se),parseInt(V))}const Q=F.match(/_(\d{4})_(\d{2})_(\d{2})_(\d{2})_(\d{2})_(\d{2})\.json$/);if(Q){const[,M,T,R,Z,se,V]=Q;return new Date(parseInt(M),parseInt(T)-1,parseInt(R),parseInt(Z),parseInt(se),parseInt(V))}return null},te=[];for await(const F of B.keys())if(F.endsWith(".json"))try{const Q=await(await B.getFileHandle(F)).getFile(),M=G(F);te.push({name:F,lastModified:new Date(Q.lastModified),size:Q.size,timestamp:M||new Date(Q.lastModified)})}catch(H){console.warn(`Failed to read file ${F}:`,H)}te.sort((F,H)=>H.timestamp.getTime()-F.timestamp.getTime()),h(te)}catch(B){console.error("Failed to load history files:",B),P("Failed to load history files. Please try again.")}finally{m(!1)}})()},[r,e]);const k=async()=>{if(b)try{await n(b),t()}catch(z){console.error("Failed to restore file:",z),P("Failed to restore file. Please try again.")}},N=z=>z.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),$=z=>z<1024?`${z} B`:z<1024*1024?`${(z/1024).toFixed(1)} KB`:`${(z/(1024*1024)).toFixed(1)} MB`;if(!r)return null;const I=s?{position:"fixed",left:`${s.x}px`,top:`${s.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"500px",maxWidth:"700px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:o?"grabbing":"default"}:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"#fff",borderRadius:8,minWidth:"500px",maxWidth:"700px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column"};return l.jsxs("div",{style:I,children:[l.jsxs("div",{onMouseDown:d,style:{backgroundColor:"#f5f5f5",padding:"12px 16px",borderBottom:"1px solid #ddd",borderRadius:"8px 8px 0 0",cursor:o?"grabbing":"move",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[l.jsx("h2",{style:{margin:0,fontSize:"16px",fontWeight:600,color:"#000"},children:"PastTime"}),l.jsx("button",{onClick:t,style:{background:"transparent",border:"none",fontSize:"20px",cursor:"pointer",color:"#666",padding:"0 4px",lineHeight:1},title:"Close",children:""})]}),l.jsxs("div",{style:{padding:"16px",display:"flex",flexDirection:"column",flex:1,minHeight:0},children:[v&&l.jsx("div",{style:{padding:"12px",backgroundColor:"#fee",color:"#c00",borderRadius:4,marginBottom:"12px"},children:v}),f?l.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"Loading history files..."}):c.length===0?l.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"No history files found."}):l.jsxs(l.Fragment,{children:[l.jsx("div",{style:{marginBottom:"12px",color:"#333",fontSize:"14px"},children:"Select a file to restore:"}),l.jsx("div",{ref:x,style:{border:"1px solid #ddd",borderRadius:4,overflowY:"auto",maxHeight:"400px",backgroundColor:"#fafafa"},children:c.map((z,B)=>l.jsxs("div",{onClick:()=>S(z.name),style:{padding:"12px 16px",borderBottom:B<c.length-1?"1px solid #eee":"none",backgroundColor:b===z.name?"#e6f0ff":"transparent",cursor:"pointer",transition:"background-color 0.1s"},onMouseEnter:G=>{b!==z.name&&(G.currentTarget.style.backgroundColor="#f5f5f5")},onMouseLeave:G=>{b!==z.name&&(G.currentTarget.style.backgroundColor="transparent")},children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"4px"},children:[l.jsx("div",{style:{fontWeight:600,color:"#000",fontSize:"13px",wordBreak:"break-word",flex:1},children:z.name}),l.jsx("div",{style:{color:"#666",fontSize:"12px",marginLeft:"12px",whiteSpace:"nowrap"},children:$(z.size)})]}),l.jsx("div",{style:{color:"#666",fontSize:"12px"},children:N(z.lastModified)})]},z.name))})]})]}),l.jsxs("div",{style:{padding:"12px 16px",borderTop:"1px solid #ddd",display:"flex",justifyContent:"flex-end",gap:"8px"},children:[l.jsx("button",{onClick:t,style:{padding:"6px 16px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"13px"},children:"Cancel"}),l.jsx("button",{onClick:k,disabled:!b||f,style:{padding:"6px 16px",background:b&&!f?"#0066cc":"#ccc",border:"none",borderRadius:4,cursor:b&&!f?"pointer":"not-allowed",color:"#fff",fontSize:"13px",fontWeight:500},children:"Restore"})]})]})},IT=({visible:r,isPad:e,onConfirm:t,onClose:n})=>{const[s,o]=X.useState("linear"),[d,c]=X.useState("vertical-edges"),[h,f]=X.useState(8),[m,b]=X.useState("");X.useEffect(()=>{r&&(o("linear"),c("vertical-edges"),f(8),b(""))},[r]);const S=()=>{let v="";if(h<1?v="Number of pins must be >= 1.":s==="twoSided"&&h%2!==0?v="2-sided components must have an even number of pins.":s==="fourSided"&&h%4!==0&&(v="4-sided components must have N divisible by 4."),v){b(v);return}b(""),t({numPins:h,type:s,...s==="twoSided"?{twoSidedOrientation:d}:{}})};return r?l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},onClick:v=>{v.target===v.currentTarget&&n()},children:l.jsxs("div",{style:{backgroundColor:"#fff",padding:"20px",borderRadius:"8px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},onClick:v=>v.stopPropagation(),children:[l.jsxs("h2",{style:{marginTop:0,marginBottom:"20px",color:"#222"},children:[e?"Pad Pattern":"Via Pattern"," Placement"]}),l.jsxs("div",{style:{marginBottom:"15px"},children:[l.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#222",fontWeight:500},children:"Arrangement:"}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[l.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[l.jsx("input",{type:"radio",value:"linear",checked:s==="linear",onChange:v=>o(v.target.value),style:{marginRight:"8px"}}),l.jsx("span",{style:{color:"#222"},children:"Linear (1 side)"})]}),l.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[l.jsx("input",{type:"radio",value:"twoSided",checked:s==="twoSided",onChange:v=>o(v.target.value),style:{marginRight:"8px"}}),l.jsx("span",{style:{color:"#222"},children:"2-Sided"})]}),l.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[l.jsx("input",{type:"radio",value:"fourSided",checked:s==="fourSided",onChange:v=>o(v.target.value),style:{marginRight:"8px"}}),l.jsx("span",{style:{color:"#222"},children:"4-Sided"})]})]})]}),s==="twoSided"&&l.jsxs("div",{style:{marginBottom:"15px"},children:[l.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#222",fontWeight:500},children:"Orientation:"}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[l.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[l.jsx("input",{type:"radio",value:"vertical-edges",checked:d==="vertical-edges",onChange:v=>c(v.target.value),style:{marginRight:"8px"}}),l.jsxs("span",{style:{color:"#222"},children:["Vertical ",e?"Pads":"Vias"," (left & right)"]})]}),l.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[l.jsx("input",{type:"radio",value:"horizontal-edges",checked:d==="horizontal-edges",onChange:v=>c(v.target.value),style:{marginRight:"8px"}}),l.jsxs("span",{style:{color:"#222"},children:["Horizontal ",e?"Pads":"Vias"," (top & bottom)"]})]})]})]}),l.jsxs("div",{style:{marginBottom:"15px"},children:[l.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#222",fontWeight:500},children:"Number of Pins:"}),l.jsx("input",{type:"number",min:"1",value:h,onChange:v=>{const P=parseInt(v.target.value,10);isNaN(P)||(f(P),b(""))},style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px",color:"#000",background:"#fff"}}),m&&l.jsx("div",{style:{color:"#d32f2f",fontSize:"12px",marginTop:"4px"},children:m})]}),l.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",marginTop:"20px"},children:[l.jsx("button",{onClick:n,style:{padding:"8px 16px",background:"#f5f5f5",color:"#222",border:"1px solid #ddd",borderRadius:"4px",cursor:"pointer",fontSize:"14px"},children:"Cancel"}),l.jsx("button",{onClick:S,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px",fontWeight:500},children:"OK"})]})]})}):null};function zT(r,e){const t={x:r.x,y:r.y},n={x:e.x,y:e.y},s={x:n.x,y:t.y},o={x:t.x,y:n.y};return{corner1:t,corner2:s,corner3:n,corner4:o}}function BT(r){if(r.numPins<1)throw new Error("Number of pins must be >= 1.");if(r.type==="twoSided"){if(r.numPins%2!==0)throw new Error("2-sided components must have an even number of pins.");if(!r.twoSidedOrientation)throw new Error("Orientation required for 2-sided components.")}if(r.type==="fourSided"&&r.numPins%4!==0)throw new Error("4-sided components must have N divisible by 4.");if(Math.abs(r.point1.x-r.point2.x)<.001||Math.abs(r.point1.y-r.point2.y)<.001)throw new Error("Area must have non-zero width and height.")}function OT(r,e){const t=[],{corner1:n,corner2:s,corner3:o,corner4:d}=e,c=Math.abs(s.x-n.x),h=Math.abs(o.y-s.y);if(c>h){const f=(n.y+d.y)/2,m=Math.min(n.x,s.x),b=Math.max(n.x,s.x),S=b-m,v=r.numPins>1?S/(r.numPins-1):0,P=Math.hypot(n.x-m,n.y-f),x=Math.hypot(n.x-b,n.y-f),k=P<x;if(r.numPins===1)t.push({pinNumber:1,x:(m+b)/2,y:f});else for(let N=1;N<=r.numPins;N++){const $=k?m+(N-1)*v:b-(N-1)*v;t.push({pinNumber:N,x:$,y:f})}}else{const f=(n.x+s.x)/2,m=Math.min(n.y,s.y),b=Math.max(o.y,d.y),S=b-m,v=r.numPins>1?S/(r.numPins-1):0,P=Math.hypot(n.x-f,n.y-m),x=Math.hypot(n.x-f,n.y-b),k=P<x;if(r.numPins===1)t.push({pinNumber:1,x:f,y:(m+b)/2});else for(let N=1;N<=r.numPins;N++){const $=k?m+(N-1)*v:b-(N-1)*v;t.push({pinNumber:N,x:f,y:$})}}return t}function FT(r,e){const t=[],{corner1:n,corner2:s,corner3:o,corner4:d}=e,c=r.type==="fourSided"?r.numPins/4:r.numPins/2,h=Math.min(n.x,s.x,o.x,d.x),f=Math.min(n.y,s.y,o.y,d.y),m=Math.abs(n.y-f)<.001,b=Math.abs(n.x-h)<.001,S=m?b?"TopLeft":"TopRight":b?"BottomLeft":"BottomRight",v=Math.max(n.x,s.x,o.x,d.x),P=Math.max(n.y,s.y,o.y,d.y),x=(T,R,Z=.001)=>{const se=[n,s,o,d];for(const V of se)if(Math.abs(V.x-T)<Z&&Math.abs(V.y-R)<Z)return V;return null},k=x(h,f)||n,N=x(v,f)||s,$=x(v,P)||o,I=x(h,P)||d,z={start:k,end:I,name:"Left",direction:"Down"},B={start:I,end:$,name:"Bottom",direction:"Right"},G={start:$,end:N,name:"Right",direction:"Up"},te={start:N,end:k,name:"Top",direction:"Left"};let F;const H=[];if(S==="TopLeft"?(F=z,H.push(z,B,G,te)):S==="BottomLeft"?(F=B,H.push(B,G,te,z)):S==="BottomRight"?(F=G,H.push(G,te,z,B)):(F=te,H.push(te,z,B,G)),r.type==="twoSided"){if(r.twoSidedOrientation==="vertical-edges"){if(S!=="TopLeft"&&S!=="BottomRight")throw new Error(`Invalid Pin 1 location for Left/Right orientation. Pin 1 is at ${S}, but must be at Top-Left or Bottom-Right.`)}else if(S!=="TopRight"&&S!=="BottomLeft")throw new Error(`Invalid Pin 1 location for Top/Bottom orientation. Pin 1 is at ${S}, but must be at Top-Right or Bottom-Left.`)}const Q=[];r.type==="fourSided"?Q.push(...H):r.twoSidedOrientation==="vertical-edges"?F===z?Q.push(z,G):Q.push(G,z):F===te?Q.push(te,B):Q.push(B,te);let M=1;for(const T of Q){const R=Math.hypot(T.end.x-T.start.x,T.end.y-T.start.y),Z=r.type==="fourSided"?R/(c+1):c>1?R/(c-1):0,se=[];if(r.type==="fourSided")if(T.direction==="Down")for(let V=1;V<=c;V++)se.push({x:T.start.x,y:T.start.y+V*Z});else if(T.direction==="Right")for(let V=1;V<=c;V++)se.push({x:T.start.x+V*Z,y:T.start.y});else if(T.direction==="Up")for(let V=1;V<=c;V++)se.push({x:T.start.x,y:T.start.y-V*Z});else for(let V=1;V<=c;V++)se.push({x:T.start.x-V*Z,y:T.start.y});else if(c===1){const V=(T.start.x+T.end.x)/2,ee=(T.start.y+T.end.y)/2;se.push({x:V,y:ee})}else if(T.direction==="Down")for(let V=0;V<c;V++)se.push({x:T.start.x,y:T.start.y+V*Z});else if(T.direction==="Right")for(let V=0;V<c;V++)se.push({x:T.start.x+V*Z,y:T.start.y});else if(T.direction==="Up")for(let V=0;V<c;V++)se.push({x:T.start.x,y:T.start.y-V*Z});else for(let V=0;V<c;V++)se.push({x:T.start.x-V*Z,y:T.start.y});if(T===F){let V=0,ee=1/0;for(let Ce=0;Ce<se.length;Ce++){const xe=Math.hypot(se[Ce].x-n.x,se[Ce].y-n.y);xe<ee&&(ee=xe,V=Ce)}const ae=Math.hypot(T.start.x-n.x,T.start.y-n.y);if(ee<ae&&V>0){const Ce=se.slice(0,V),xe=se.slice(V);se.length=0,se.push(...xe,...Ce)}}for(const V of se)t.push({pinNumber:M++,x:V.x,y:V.y})}return t}function UT(r){BT(r);const e=zT(r.point1,r.point2);return r.type==="linear"?OT(r,e):FT(r,e)}function HT(){const[r,e]=X.useState([]),[t,n]=X.useState(!1),[s,o]=X.useState([]),[d,c]=X.useState(null),[h,f]=X.useState("trace"),[m,b]=X.useState("top"),S=X.useRef([]),v=X.useRef(0),P=X.useRef(!1),x=X.useCallback(()=>{n(!0),o([]),S.current=[]},[]),k=X.useCallback(()=>{n(!1),o([]),S.current=[]},[]),N=X.useCallback(I=>{o(z=>[...z,I]),S.current=[...S.current,I]},[]),$=X.useCallback(I=>{e(z=>[...z,I]),o([]),S.current=[]},[]);return{drawingStrokes:r,setDrawingStrokes:e,isDrawing:t,setIsDrawing:n,currentStroke:s,setCurrentStroke:o,tracePreviewMousePos:d,setTracePreviewMousePos:c,drawingMode:h,setDrawingMode:f,selectedDrawingLayer:m,setSelectedDrawingLayer:b,currentStrokeRef:S,lastTraceClickTimeRef:v,isDoubleClickingTraceRef:P,startDrawing:x,stopDrawing:k,addPointToStroke:N,finishStroke:$}}function qT(){const[r,e]=X.useState(new Set),[t,n]=X.useState(!1),[s,o]=X.useState(new Set),[d,c]=X.useState(new Set),[h,f]=X.useState(new Set),m=X.useCallback(()=>{e(new Set),o(new Set),c(new Set),f(new Set)},[]),b=X.useCallback((P,x="stroke")=>{x==="stroke"?e(k=>new Set([...k,P])):x==="component"?o(k=>new Set([...k,P])):x==="power"?c(k=>new Set([...k,P])):x==="ground"&&f(k=>new Set([...k,P]))},[]),S=X.useCallback((P,x="stroke")=>{x==="stroke"?e(k=>{const N=new Set(k);return N.delete(P),N}):x==="component"?o(k=>{const N=new Set(k);return N.delete(P),N}):x==="power"?c(k=>{const N=new Set(k);return N.delete(P),N}):x==="ground"&&f(k=>{const N=new Set(k);return N.delete(P),N})},[]),v=X.useCallback((P,x="stroke")=>{x==="stroke"?e(P):x==="component"?o(P):x==="power"?c(P):x==="ground"&&f(P)},[]);return{selectedIds:r,setSelectedIds:e,isSelecting:t,setIsSelecting:n,selectedComponentIds:s,setSelectedComponentIds:o,selectedPowerIds:d,setSelectedPowerIds:c,selectedGroundIds:h,setSelectedGroundIds:f,clearSelection:m,addToSelection:b,removeFromSelection:S,setSelection:v}}function VT(){const[r,e]=X.useState(null),[t,n]=X.useState(!1),[s,o]=X.useState(null),[d,c]=X.useState("nudge"),h=X.useCallback((m,b)=>{e(m),n(!0),o(b)},[]),f=X.useCallback(()=>{n(!1),e(null),o(null)},[]);return{selectedImageForTransform:r,setSelectedImageForTransform:e,isTransforming:t,setIsTransforming:n,transformStartPos:s,setTransformStartPos:o,transformMode:d,setTransformMode:c,startTransform:h,stopTransform:f}}function WT(){const[r,e]=X.useState(null),[t,n]=X.useState(null),[s,o]=X.useState("overlay"),[d,c]=X.useState(50),[h,f]=X.useState(!1),[m,b]=X.useState(2e3),[S,v]=X.useState(!1),P=X.useCallback(N=>{e(N)},[]),x=X.useCallback(N=>{n(N)},[]),k=X.useCallback(()=>{e(null),n(null)},[]);return{topImage:r,setTopImage:e,bottomImage:t,setBottomImage:n,currentView:s,setCurrentView:o,transparency:d,setTransparency:c,isTransparencyCycling:h,setIsTransparencyCycling:f,transparencyCycleSpeed:m,setTransparencyCycleSpeed:b,isGrayscale:S,setIsGrayscale:v,loadTopImage:P,loadBottomImage:x,clearImages:k}}function $T(){const[r,e]=X.useState(1),[t,n]=X.useState({x:0,y:0}),[s,o]=X.useState(0),[d,c]=X.useState(!1),[h,f]=X.useState(!1),[m,b]=X.useState(!1),S=X.useCallback(()=>{e(1),n({x:0,y:0}),o(0),c(!1)},[]),v=X.useCallback((I=1.2)=>{e(z=>z*I)},[]),P=X.useCallback((I=1.2)=>{e(z=>z/I)},[]),x=X.useCallback(I=>{e(I)},[]),k=X.useCallback((I,z,B)=>{const G=I/B,te=z/B;n(F=>({x:F.x-G,y:F.y-te}))},[]),N=X.useCallback((I,z)=>{n({x:I,y:z})},[]),$=X.useCallback((I,z)=>({x:I-t.x*r,y:z-t.y*r}),[t,r]);return{viewScale:r,setViewScale:e,cameraWorldCenter:t,setCameraWorldCenter:n,viewRotation:s,setViewRotation:o,viewFlipX:d,setViewFlipX:c,isShiftConstrained:h,setIsShiftConstrained:f,showBothLayers:m,setShowBothLayers:b,resetView:S,zoomIn:v,zoomOut:P,setZoom:x,pan:k,setCameraCenter:N,getViewPan:$}}function GT(){const[r,e]=X.useState(()=>[{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),[t,n]=X.useState(()=>[{id:"groundbus-circuit",name:"GND",color:"#000000"}]),[s,o]=X.useState([]),[d,c]=X.useState([]),[h,f]=X.useState(null),[m,b]=X.useState(null),S=X.useCallback(G=>{e(te=>[...te,G])},[]),v=X.useCallback((G,te)=>{e(F=>F.map(H=>H.id===G?{...H,...te}:H))},[]),P=X.useCallback(G=>{e(te=>te.filter(F=>F.id!==G)),o(te=>te.filter(F=>F.powerBusId!==G))},[]),x=X.useCallback(G=>{o(te=>[...te,G])},[]),k=X.useCallback(G=>{o(te=>te.filter(F=>F.id!==G))},[]),N=X.useCallback(G=>{c(te=>[...te,G])},[]),$=X.useCallback(G=>{c(te=>te.filter(F=>F.id!==G))},[]),I=X.useCallback(G=>{n(te=>[...te,G])},[]),z=X.useCallback((G,te)=>{n(F=>F.map(H=>H.id===G?{...H,...te}:H))},[]),B=X.useCallback(G=>{n(te=>te.filter(F=>F.id!==G)),c(te=>te.filter(F=>F.groundBusId===G))},[]);return{powerBuses:r,setPowerBuses:e,groundBuses:t,setGroundBuses:n,powerSymbols:s,setPowerSymbols:o,groundSymbols:d,setGroundSymbols:c,powerEditor:h,setPowerEditor:f,groundEditor:m,setGroundEditor:b,addPowerBus:S,updatePowerBus:v,removePowerBus:P,addPowerSymbol:x,removePowerSymbol:k,addGroundSymbol:N,removeGroundSymbol:$,addGroundBus:I,updateGroundBus:z,removeGroundBus:B}}const wi={brushColor:"#008080",brushSize:6,topTraceColor:"#AA4499",bottomTraceColor:"#F781BF",topTraceSize:6,bottomTraceSize:6,viaSize:18,viaColor:"#ff0000",topPadColor:"#0072B2",bottomPadColor:"#56B4E9",topPadSize:18,bottomPadSize:18,topTestPointColor:"#FFFF00",bottomTestPointColor:"#FFFF00",topTestPointSize:18,bottomTestPointSize:18,topComponentColor:"#8C564B",bottomComponentColor:"#9C755F",topComponentSize:18,bottomComponentSize:18,componentConnectionColor:"#E69F00",componentConnectionSize:3};function YT(){const[r,e]=X.useState(wi.brushColor),[t,n]=X.useState(wi.brushSize),[s,o]=X.useState(wi.topTraceColor),[d,c]=X.useState(wi.bottomTraceColor),[h,f]=X.useState(wi.topTraceSize),[m,b]=X.useState(wi.bottomTraceSize),[S,v]=X.useState(wi.topPadColor),[P,x]=X.useState(wi.bottomPadColor),[k,N]=X.useState(wi.topPadSize),[$,I]=X.useState(wi.bottomPadSize),[z,B]=X.useState(wi.topTestPointColor),[G,te]=X.useState(wi.bottomTestPointColor),[F,H]=X.useState(wi.topTestPointSize),[Q,M]=X.useState(wi.bottomTestPointSize),[T,R]=X.useState(wi.topComponentColor),[Z,se]=X.useState(wi.bottomComponentColor),[V,ee]=X.useState(wi.topComponentSize),[ae,Ce]=X.useState(wi.bottomComponentSize),[xe,J]=X.useState(wi.componentConnectionColor),[D,W]=X.useState(wi.componentConnectionSize),K=X.useCallback(()=>{e(wi.brushColor),n(wi.brushSize),o(wi.topTraceColor),c(wi.bottomTraceColor),f(wi.topTraceSize),b(wi.bottomTraceSize),v(wi.topPadColor),x(wi.bottomPadColor),N(wi.topPadSize),I(wi.bottomPadSize),B(wi.topTestPointColor),te(wi.bottomTestPointColor),H(wi.topTestPointSize),M(wi.bottomTestPointSize),R(wi.topComponentColor),se(wi.bottomComponentColor),ee(wi.topComponentSize),Ce(wi.bottomComponentSize),J(wi.componentConnectionColor),W(wi.componentConnectionSize)},[]),ue=X.useCallback(De=>{De.brushColor!==void 0&&e(De.brushColor),De.brushSize!==void 0&&n(De.brushSize),De.topTraceColor!==void 0&&o(De.topTraceColor),De.bottomTraceColor!==void 0&&c(De.bottomTraceColor),De.topTraceSize!==void 0&&f(De.topTraceSize),De.bottomTraceSize!==void 0&&b(De.bottomTraceSize),De.topPadColor!==void 0&&v(De.topPadColor),De.bottomPadColor!==void 0&&x(De.bottomPadColor),De.topPadSize!==void 0&&N(De.topPadSize),De.bottomPadSize!==void 0&&I(De.bottomPadSize),De.topTestPointColor!==void 0&&B(De.topTestPointColor),De.bottomTestPointColor!==void 0&&te(De.bottomTestPointColor),De.topTestPointSize!==void 0&&H(De.topTestPointSize),De.bottomTestPointSize!==void 0&&M(De.bottomTestPointSize),De.topComponentColor!==void 0&&R(De.topComponentColor),De.bottomComponentColor!==void 0&&se(De.bottomComponentColor),De.topComponentSize!==void 0&&ee(De.topComponentSize),De.bottomComponentSize!==void 0&&Ce(De.bottomComponentSize),De.componentConnectionColor!==void 0&&J(De.componentConnectionColor),De.componentConnectionSize!==void 0&&W(De.componentConnectionSize)},[]),Te=X.useCallback((De,et,ot)=>{},[]),Pe=X.useCallback((De,et,ot)=>{},[]),Ve=X.useCallback(()=>({brushColor:r,brushSize:t,topTraceColor:s,bottomTraceColor:d,topTraceSize:h,bottomTraceSize:m,viaSize:wi.viaSize,viaColor:wi.viaColor,topPadColor:S,bottomPadColor:P,topPadSize:k,bottomPadSize:$,topTestPointColor:z,bottomTestPointColor:G,topTestPointSize:F,bottomTestPointSize:Q,topComponentColor:T,bottomComponentColor:Z,topComponentSize:V,bottomComponentSize:ae,componentConnectionColor:xe,componentConnectionSize:D}),[r,t,s,d,h,m,S,P,k,$,z,G,F,Q,T,Z,V,ae,xe,D]);return{brushColor:r,setBrushColor:e,brushSize:t,setBrushSize:n,topTraceColor:s,setTopTraceColor:o,bottomTraceColor:d,setBottomTraceColor:c,topTraceSize:h,setTopTraceSize:f,bottomTraceSize:m,setBottomTraceSize:b,topPadColor:S,setTopPadColor:v,bottomPadColor:P,setBottomPadColor:x,topPadSize:k,setTopPadSize:N,bottomPadSize:$,setBottomPadSize:I,topTestPointColor:z,setTopTestPointColor:B,bottomTestPointColor:G,setBottomTestPointColor:te,topTestPointSize:F,setTopTestPointSize:H,bottomTestPointSize:Q,setBottomTestPointSize:M,topComponentColor:T,setTopComponentColor:R,bottomComponentColor:Z,setBottomComponentColor:se,topComponentSize:V,setTopComponentSize:ee,bottomComponentSize:ae,setBottomComponentSize:Ce,componentConnectionColor:xe,setComponentConnectionColor:J,componentConnectionSize:D,setComponentConnectionSize:W,resetToDefaults:K,loadFromProject:ue,getCurrentSettings:Ve,saveDefaultSize:Te,saveDefaultColor:Pe}}function XT(r,e,t,n,s,o,d,c,h,f,m,b,S,v,P,x,k,N,$,I,z,B,G,te,F){const[H,Q]=X.useState(()=>r()),M=X.useRef(null),T=X.useRef(n),R=X.useRef(s),Z=X.useCallback(ee=>e==="draw"&&t==="trace"?ee.get("trace"):e==="draw"&&t==="via"?ee.get("via"):e==="draw"&&t==="pad"?ee.get("pad"):e==="component"?ee.get("component"):e==="power"?ee.get("power"):e==="ground"?ee.get("ground"):null,[e,t]);X.useEffect(()=>{Q(ee=>{const ae=Z(ee),Ce=ae?.id||null,xe=M.current,J=new Map(ee);if(xe&&xe!==Ce){const D=ee.get(xe);D&&J.set(xe,{...D,settings:{color:T.current,size:R.current}})}if(ae&&Ce!==xe)if(e==="draw"&&t==="trace"){const D=B||"top",W=D==="top"?o:d,K=D==="top"?c:h;T.current=W,R.current=K,J.set("trace",{...ae,settings:{color:W,size:K}})}else if(e==="draw"&&t==="pad"){const D=G||"top",W=D==="top"?f:m,K=D==="top"?b:S;T.current=W,R.current=K,J.set("pad",{...ae,settings:{color:W,size:K}})}else if(e==="component"){const D=F||"top",W=D==="top"?N:$,K=D==="top"?I:z;T.current=W,R.current=K,J.set("component",{...ae,settings:{color:W,size:K}})}else T.current=ae.settings.color,R.current=ae.settings.size;return M.current=Ce,J})},[e,t,o,d,c,h,f,m,b,S,N,$,I,z,B,G,F,Z]);const se=X.useCallback((ee,ae)=>{Q(Ce=>{const xe=new Map(Ce),J=xe.get(ee);return J&&xe.set(ee,{...J,settings:ae}),xe})},[]),V=X.useCallback((ee,ae,Ce)=>{Q(xe=>{const J=new Map(xe),D=J.get(ee);if(D){const W=new Map(D.layerSettings);W.set(ae,Ce),J.set(ee,{...D,layerSettings:W})}return J})},[]);return{toolRegistry:H,setToolRegistry:Q,updateToolSettings:se,updateToolLayerSettings:V,getCurrentToolDef:Z}}function KT(r){const{currentTool:e,drawingMode:t,traceToolLayer:n,padToolLayer:s,testPointToolLayer:o,componentToolLayer:d}=r,[c,h]=X.useState(0),f=X.useCallback(()=>e==="draw"&&t==="via"?"via":e==="draw"&&t==="pad"?s==="bottom"?"padBottom":"padTop":e==="draw"&&t==="testPoint"?o==="bottom"?"testPointBottom":"testPointTop":e==="draw"&&t==="trace"?n==="bottom"?"traceBottom":"traceTop":e==="component"?d==="bottom"?"componentBottom":"componentTop":e==="power"?"power":e==="ground"?"ground":null,[e,t,s,o,n,d]),m=X.useCallback(()=>{const P=f();if(P){const x=Mn.get(P);return{currentTool:e,drawingMode:t,layer:e==="draw"&&t==="pad"?s||"top":e==="draw"&&t==="testPoint"?o||"top":e==="draw"&&t==="trace"?n||"top":e==="component"?d||"top":void 0,toolInstanceId:P,color:x.color,size:x.size}}return{currentTool:e,drawingMode:t,layer:void 0,toolInstanceId:null,color:"#000000",size:10}},[e,t,s,o,n,d,f]);X.useEffect(()=>{const P=f();return P?Mn.subscribe(P,()=>{h(k=>k+1)}):void 0},[f]);const b=m(),S=X.useCallback(P=>{const x=f();x&&Mn.setColor(x,P)},[f]),v=X.useCallback(P=>{const x=f();x&&Mn.setSize(x,P)},[f]);return{toolState:b,setColor:S,setSize:v,getCurrentToolInstanceId:f}}function ZT(){const[r,e]=X.useState(!1),[t,n]=X.useState(!1),[s,o]=X.useState(!1),[d,c]=X.useState(!1),[h,f]=X.useState(!1),[m,b]=X.useState(!1),[S,v]=X.useState(!1),[P,x]=X.useState(!1),k=X.useCallback(()=>{e(!0),n(!0),o(!0),c(!0),f(!0),b(!0),v(!0),x(!0)},[]),N=X.useCallback(()=>{e(!1),n(!1),o(!1),c(!1),f(!1),b(!1),v(!1),x(!1)},[]);return{areImagesLocked:r,setAreImagesLocked:e,areViasLocked:t,setAreViasLocked:n,arePadsLocked:s,setArePadsLocked:o,areTestPointsLocked:d,setAreTestPointsLocked:c,areTracesLocked:h,setAreTracesLocked:f,areComponentsLocked:m,setAreComponentsLocked:b,areGroundNodesLocked:S,setAreGroundNodesLocked:v,arePowerNodesLocked:P,setArePowerNodesLocked:x,lockAll:k,unlockAll:N}}function JT(){const[r,e]=X.useState(null),[t,n]=X.useState({visible:!1,size:6}),[s,o]=X.useState({visible:!1,interval:5}),[d,c]=X.useState({visible:!1,source:null,interval:5}),[h,f]=X.useState({visible:!1,text:""}),[m,b]=X.useState({visible:!1,title:"",message:""}),[S,v]=X.useState({visible:!1}),[P,x]=X.useState({visible:!1}),[k,N]=X.useState({visible:!1,projectName:"",locationPath:"",locationHandle:null}),[$,I]=X.useState({visible:!1,filename:"",locationPath:"",locationHandle:null}),[z,B]=X.useState(!1),[G,te]=X.useState(!0),[F,H]=X.useState(!1);return{openMenu:r,setOpenMenu:e,setSizeDialog:t,setSetSizeDialog:n,autoSaveDialog:s,setAutoSaveDialog:o,autoSavePromptDialog:d,setAutoSavePromptDialog:c,debugDialog:h,setDebugDialog:f,errorDialog:m,setErrorDialog:b,newProjectDialog:S,setNewProjectDialog:v,openProjectDialog:P,setOpenProjectDialog:x,newProjectSetupDialog:k,setNewProjectSetupDialog:N,saveAsDialog:$,setSaveAsDialog:I,showColorPicker:z,setShowColorPicker:B,showWelcomeDialog:G,setShowWelcomeDialog:te,transformImagesDialogVisible:F,setTransformImagesDialogVisible:H}}function QT(){const[r,e]=X.useState(!1),[t,n]=X.useState(1),[s,o]=X.useState(null),[d,c]=X.useState(""),[h,f]=X.useState(""),[m,b]=X.useState(null),[S,v]=X.useState("pcb_project"),[P,x]=X.useState([]),[k,N]=X.useState(-1),$=X.useRef(null),I=X.useRef(!1),z=X.useRef(!1);return{autoSaveEnabled:r,setAutoSaveEnabled:e,autoSaveInterval:t,setAutoSaveInterval:n,autoSaveDirHandle:s,setAutoSaveDirHandle:o,autoSaveBaseName:d,setAutoSaveBaseName:c,currentProjectFilePath:h,setCurrentProjectFilePath:f,projectDirHandle:m,setProjectDirHandle:b,projectName:S,setProjectName:v,autoSaveFileHistory:P,setAutoSaveFileHistory:x,currentFileIndex:k,setCurrentFileIndex:N,autoSaveIntervalRef:$,hasChangesSinceLastAutoSaveRef:I,prevAutoSaveEnabledRef:z}}function e4(){const[r,e]=X.useState(null),t=X.useRef(!1),n=X.useCallback((c,h,f,m,b)=>{if(t.current)return;const S={drawingStrokes:JSON.parse(JSON.stringify(c)),componentsTop:JSON.parse(JSON.stringify(h)),componentsBottom:JSON.parse(JSON.stringify(f)),powerSymbols:JSON.parse(JSON.stringify(m)),groundSymbols:JSON.parse(JSON.stringify(b))};e(S)},[]),s=X.useCallback(()=>{if(!r)return null;t.current=!0;const c=r;return e(null),setTimeout(()=>{t.current=!1},100),c},[r]),o=r!==null,d=X.useCallback(()=>{e(null)},[]);return{saveSnapshot:n,undo:s,canUndo:o,clearSnapshot:d}}function t4(){const e=WT(),{topImage:t,setTopImage:n,bottomImage:s,setBottomImage:o,currentView:d,setCurrentView:c,transparency:h,setTransparency:f,isTransparencyCycling:m,setIsTransparencyCycling:b,transparencyCycleSpeed:S,setTransparencyCycleSpeed:v,isGrayscale:P,setIsGrayscale:x}=e,[k,N]=X.useState("none"),[$,I]=X.useState(()=>{const p=localStorage.getItem("bomExportFormat");return p==="json"||p==="pdf"?p:"pdf"});Tt.useEffect(()=>{localStorage.setItem("bomExportFormat",$)},[$]);const z=YT(),{brushColor:B,setBrushColor:G,brushSize:te,setBrushSize:F,topTraceColor:H,setTopTraceColor:Q,bottomTraceColor:M,setBottomTraceColor:T,topTraceSize:R,setTopTraceSize:Z,bottomTraceSize:se,setBottomTraceSize:V,topPadColor:ee,setTopPadColor:ae,bottomPadColor:Ce,setBottomPadColor:xe,topPadSize:J,setTopPadSize:D,bottomPadSize:W,setBottomPadSize:K,topTestPointColor:ue,setTopTestPointColor:Te,bottomTestPointColor:Pe,setBottomTestPointColor:Ve,topTestPointSize:De,setTopTestPointSize:et,bottomTestPointSize:ot,setBottomTestPointSize:at,topComponentColor:ht,setTopComponentColor:xt,bottomComponentColor:fe,setBottomComponentColor:Nt,topComponentSize:zt,setTopComponentSize:Bt,bottomComponentSize:it,setBottomComponentSize:qt,componentConnectionColor:vt,setComponentConnectionColor:Dt,componentConnectionSize:Ot,setComponentConnectionSize:sn,saveDefaultSize:kt,saveDefaultColor:Lt}=z,Jn=HT(),{drawingStrokes:pt,setDrawingStrokes:jt,isDrawing:Fn,setIsDrawing:tn,currentStroke:zn,setCurrentStroke:Pn,tracePreviewMousePos:dn,setTracePreviewMousePos:An,drawingMode:lt,setDrawingMode:nn,selectedDrawingLayer:Xt,setSelectedDrawingLayer:Kt,currentStrokeRef:Cn,lastTraceClickTimeRef:Vi,isDoubleClickingTraceRef:Vn}=Jn,bn=VT(),{selectedImageForTransform:Qt,setSelectedImageForTransform:Cr,isTransforming:Ks,setIsTransforming:zr,transformStartPos:Br,setTransformStartPos:en,transformMode:Or,setTransformMode:ja}=bn,fa=$T(),{viewScale:Ct,setViewScale:pi,viewRotation:ti,setViewRotation:vs,viewFlipX:Ji,setViewFlipX:Ds,cameraWorldCenter:Ti,setCameraWorldCenter:Si,resetView:Tr,isShiftConstrained:pa,setIsShiftConstrained:qa,showBothLayers:Yl,setShowBothLayers:Va,setCameraCenter:Wa,getViewPan:jo}=fa,[Gn,Fr]=X.useState("top"),[xi,ga]=X.useState("top"),[Rn,Qo]=X.useState("top"),[gi,ma]=X.useState("top"),Pa=Tt.useRef("top"),el=Tt.useRef("top"),tl=Tt.useRef("top"),$a=Tt.useRef("top");Tt.useEffect(()=>{Pa.current=Gn},[Gn]),Tt.useEffect(()=>{el.current=xi},[xi]),Tt.useEffect(()=>{tl.current=Rn},[Rn]),Tt.useEffect(()=>{$a.current=gi},[gi]);const td=KT({currentTool:k,drawingMode:lt,traceToolLayer:Gn,padToolLayer:xi,testPointToolLayer:Rn,componentToolLayer:gi}),{toolState:ss}=td,nl=XT(c3,k,lt,B,te,H,M,R,se,ee,Ce,J,W,ue,Pe,De,ot,ht,fe,zt,it,Gn,xi,Rn,gi),{toolRegistry:Hn,setToolRegistry:Un,getCurrentToolDef:il,updateToolSettings:Ga,updateToolLayerSettings:Fs}=nl,_r=Tt.useRef(null),us=Tt.useRef(B),Wn=Tt.useRef(te);Tt.useEffect(()=>{Un(p=>{const C=il(p),L=C?.id||null,Y=_r.current,le=new Map(p);if(Y&&Y!==L){const he=p.get(Y);he&&le.set(Y,{...he,settings:{color:us.current,size:Wn.current}})}if(C&&L!==Y)if(k==="draw"&&lt==="trace"){const he=Gn||"top",U=he==="top"?H:M,Ae=he==="top"?R:se;G(U),F(Ae),us.current=U,Wn.current=Ae;const pe=new Map(C.layerSettings);pe.set("top",{color:H,size:R}),pe.set("bottom",{color:M,size:se}),le.set("trace",{...C,settings:{color:U,size:Ae},layerSettings:pe})}else if(k==="draw"&&lt==="pad"){const he=xi||"top",U=he==="top"?ee:Ce,Ae=he==="top"?J:W;G(U),F(Ae),us.current=U,Wn.current=Ae;const pe=new Map(C.layerSettings);pe.set("top",{color:ee,size:J}),pe.set("bottom",{color:Ce,size:W}),le.set("pad",{...C,settings:{color:U,size:Ae},layerSettings:pe})}else if(k==="draw"&&lt==="testPoint"){const he=Rn||"top",U=he==="top"?ue:Pe,Ae=he==="top"?De:ot;G(U),F(Ae),us.current=U,Wn.current=Ae;const pe=new Map(C.layerSettings);pe.set("top",{color:ue,size:De}),pe.set("bottom",{color:Pe,size:ot}),le.set("testPoint",{...C,settings:{color:U,size:Ae},layerSettings:pe})}else if(k==="component"){const he=gi||"top",U=he==="top"?ht:fe,Ae=he==="top"?zt:it;G(U),F(Ae),us.current=U,Wn.current=Ae;const pe=new Map(C.layerSettings);pe.set("top",{color:ht,size:zt}),pe.set("bottom",{color:fe,size:it}),le.set("component",{...C,settings:{color:U,size:Ae},layerSettings:pe})}else{const he=C.settings;G(he.color),F(he.size),us.current=he.color,Wn.current=he.size}return _r.current=L,le})},[k,lt,il,H,M,R,se,ee,Ce,J,W,ue,Pe,De,ot,Rn,ht,fe,zt,it]),Tt.useEffect(()=>{const p=Hn.get("trace");if(p){const le=p.layerSettings.get("top"),he=p.layerSettings.get("bottom");le&&(Q(le.color),Z(le.size)),he&&(T(he.color),V(he.size))}const C=Hn.get("pad");if(C){const le=C.layerSettings.get("top"),he=C.layerSettings.get("bottom");le&&(ae(le.color),D(le.size)),he&&(xe(he.color),K(he.size))}const L=Hn.get("testPoint");if(L){const le=L.layerSettings.get("top"),he=L.layerSettings.get("bottom");le&&(Te(le.color),et(le.size)),he&&(Ve(he.color),at(he.size))}const Y=Hn.get("component");if(Y){const le=Y.layerSettings.get("top"),he=Y.layerSettings.get("bottom");le&&(xt(le.color),Bt(le.size)),he&&(Nt(he.color),qt(he.size))}},[]),Tt.useEffect(()=>{Un(p=>{const C=new Map(p),L=p.get("trace");if(L){const Ae=new Map(L.layerSettings);Ae.set("top",{color:H,size:R}),Ae.set("bottom",{color:M,size:se}),C.set("trace",{...L,layerSettings:Ae})}const Y=p.get("pad");if(Y){const Ae=new Map(Y.layerSettings);Ae.set("top",{color:ee,size:J}),Ae.set("bottom",{color:Ce,size:W}),C.set("pad",{...Y,layerSettings:Ae})}const le=p.get("testPoint");if(le){const Ae=new Map(le.layerSettings);Ae.set("top",{color:ue,size:De}),Ae.set("bottom",{color:Pe,size:ot}),C.set("testPoint",{...le,layerSettings:Ae})}const he=p.get("component");if(he){const Ae=new Map(he.layerSettings);Ae.set("top",{color:ht,size:zt}),Ae.set("bottom",{color:fe,size:it}),C.set("component",{...he,layerSettings:Ae})}const U=p.get("componentConnection");return U&&C.set("componentConnection",{...U,settings:{color:vt,size:Ot}}),C})},[H,M,R,se,ee,Ce,J,W,ue,Pe,De,ot,ht,fe,zt,it,vt,Ot,Un]),Tt.useEffect(()=>{Un(p=>{const C=il(p);if(C)if(k==="draw"&&lt==="trace"){const L=Gn||"top",Y=L==="top"?"traceTop":"traceBottom",le=Mn.get(Y),he=le.color,U=le.size;L==="top"?(Q(he),Z(U),Lt("trace",he,"top"),kt("trace",U,"top")):(T(he),V(U),Lt("trace",he,"bottom"),kt("trace",U,"bottom"));const Ae=new Map(p),pe=new Map(C.layerSettings);return pe.set(L,{color:he,size:U}),Ae.set(C.id,{...C,layerSettings:pe,settings:{color:he,size:U}}),us.current=he,Wn.current=U,Ae}else if(k==="draw"&&lt==="pad"){const L=xi||"top",Y=L==="top"?"padTop":"padBottom",le=Mn.get(Y),he=le.color,U=le.size;L==="top"?(ae(he),D(U),Lt("pad",he,"top"),kt("pad",U,"top")):(xe(he),K(U),Lt("pad",he,"bottom"),kt("pad",U,"bottom"));const Ae=new Map(p),pe=new Map(C.layerSettings);return pe.set(L,{color:he,size:U}),Ae.set(C.id,{...C,layerSettings:pe,settings:{color:he,size:U}}),us.current=he,Wn.current=U,Ae}else if(k==="draw"&&lt==="testPoint"){const L=Rn||"top",Y=L==="top"?"testPointTop":"testPointBottom",le=Mn.get(Y),he=le.color,U=le.size;L==="top"?(Te(he),et(U),Lt("testPoint",he,"top"),kt("testPoint",U,"top")):(Ve(he),at(U),Lt("testPoint",he,"bottom"),kt("testPoint",U,"bottom"));const Ae=new Map(p),pe=new Map(C.layerSettings);return pe.set(L,{color:he,size:U}),Ae.set(C.id,{...C,layerSettings:pe,settings:{color:he,size:U}}),us.current=he,Wn.current=U,Ae}else if(k==="component"){const L=gi||"top",Y=L==="top"?"componentTop":"componentBottom",le=Mn.get(Y),he=le.color,U=le.size;L==="top"?(xt(he),Bt(U),Lt("component",he,"top"),kt("component",U,"top")):(Nt(he),qt(U),Lt("component",he,"bottom"),kt("component",U,"bottom"));const Ae=new Map(p),pe=new Map(C.layerSettings);return pe.set(L,{color:he,size:U}),Ae.set(C.id,{...C,layerSettings:pe,settings:{color:he,size:U}}),us.current=he,Wn.current=U,Ae}else{const L=new Map(p);return L.set(C.id,{...C,settings:{color:B,size:te}}),us.current=B,Wn.current=te,L}return p})},[B,te,k,lt,Gn,xi,Rn,gi,il,Lt,kt,Qh,Q,T,Z,V,ae,xe,D,K,Te,Ve,et,at,xt,Nt,Bt,qt]),Tt.useEffect(()=>{if(k==="draw"&&lt==="trace"){const p=Gn;Kt(p),G(p==="top"?H:M),F(p==="top"?R:se),p==="top"?(or(!0),Wr(!0)):(mr(!0),Ta(!0)),Id(!0)}else Id(!1)},[k,lt,Gn,H,M,R,se]),Tt.useEffect(()=>{if(k==="draw"&&lt==="pad"){const p=xi;Kt(p);const C=Mn.get(p==="top"?"padTop":"padBottom");G(C.color),F(C.size),p==="top"?(or(!0),$r(!0)):(mr(!0),Yr(!0)),ru(!0)}else ru(!1)},[k,lt,xi]),Tt.useEffect(()=>{if(k==="draw"&&lt==="testPoint"){const p=Rn;Kt(p),G(p==="top"?ue:Pe),F(p==="top"?De:ot),p==="top"?(or(!0),Uo(!0)):(mr(!0),sc(!0)),au(!0)}else au(!1)},[k,lt,Rn,ue,Pe,De,ot]);const[bi,Xl]=X.useState(!1);Tt.useEffect(()=>{if(k==="component"){const p=gi;Kt(p),G(p==="top"?ht:fe),F(p==="top"?zt:it),p==="top"?(or(!0),Ho(!0)):(mr(!0),ra(!0)),bi||Uu(!0)}else Uu(!1),Xl(!1)},[k,gi,ht,fe,zt,it,bi]),Tt.useEffect(()=>{if(k==="component"){const p=gi;Kt(p),G(p==="top"?ht:fe),F(p==="top"?zt:it)}},[gi,k,ht,fe,zt,it]),Tt.useEffect(()=>{ss.toolInstanceId&&(G(ss.color),F(ss.size))},[ss.toolInstanceId,ss.color,ss.size,G,F,k,lt]);const[bc,ya]=X.useState(void 0),[,kr]=X.useState([]),[,sl]=X.useState([]),[,Ya]=X.useState([]),[,Nr]=X.useState([]),[na,Rt]=X.useState([]),[Qi,fr]=X.useState([]),[Al,Xa]=X.useState([]),[Ea,co]=X.useState([]),rs=X.useRef(null),es=Tt.useMemo(()=>{const p=rs.current;if(!p)return{x:0,y:0};const C=(p.width-10)/2,L=(p.height-10)/2;return jo(C,L)},[rs.current?.width,rs.current?.height,Ti,Ct,jo]),Po=Tt.useCallback(p=>{const C=rs.current;if(!C)return;const L=(C.width-10)/2,Y=(C.height-10)/2,le=jo(L,Y),he=typeof p=="function"?p(le):p,U=(L-he.x)/Ct,Ae=(Y-he.y)/Ct;Si({x:U,y:Ae})},[jo,Ct,Si]),Bn=qT(),{selectedIds:ni,setSelectedIds:Tn,isSelecting:Hc,setIsSelecting:xa,selectedComponentIds:an,setSelectedComponentIds:_n,selectedPowerIds:ai,setSelectedPowerIds:rn,selectedGroundIds:oi,setSelectedGroundIds:mn}=Bn,Zd=m5(),{componentsTop:Ut,setComponentsTop:Pi,componentsBottom:Zt,setComponentsBottom:Yn,componentEditor:Ur,setComponentEditor:Ka,connectingPin:Zs,setConnectingPin:rl,componentDialogPosition:Ra,setComponentDialogPosition:Za,isDraggingDialog:al,setIsDraggingDialog:vc,dialogDragOffset:Kl,setDialogDragOffset:Cl,openComponentEditor:Eo}=Zd,Jd=GT(),{powerBuses:yn,setPowerBuses:Ro,groundBuses:j,setGroundBuses:ne,powerSymbols:we,setPowerSymbols:Re,groundSymbols:Fe,setGroundSymbols:st,powerEditor:yt,setPowerEditor:Gt}=Jd,xn=e4(),{saveSnapshot:pn,undo:Qn,clearSnapshot:vi}=xn;Tt.useEffect(()=>{k==="power"?(ln(!1),yn.length>1?Be&&yn.some(C=>C.id===Be)?ve(!1):(ve(!0),Be!==null&&$e(null)):yn.length===1?($e(yn[0].id),ve(!1)):(ve(!0),$e(null))):ve(!1)},[k,yn]),Tt.useEffect(()=>{k==="ground"?(ve(!1),j.length>1?Ht&&j.some(C=>C.id===Ht)?ln(!1):(ln(!0),Ht!==null&&ii(null)):j.length===1?(ii(j[0].id),ln(!1)):(ln(!0),ii(null))):ln(!1)},[k,j]),Tt.useEffect(()=>{k!=="power"&&k!=="ground"&&(ve(!1),ln(!1))},[k]);const Us=ZT(),{areImagesLocked:ji,setAreImagesLocked:Wi,areViasLocked:Ei,setAreViasLocked:ks,arePadsLocked:as,setArePadsLocked:uo,areTestPointsLocked:jr,setAreTestPointsLocked:ol,areTracesLocked:pr,setAreTracesLocked:ll,areComponentsLocked:Hs,setAreComponentsLocked:ba,areGroundNodesLocked:gr,setAreGroundNodesLocked:Ja,arePowerNodesLocked:li,setArePowerNodesLocked:ho}=Us,wc=JT(),{openMenu:nd,setOpenMenu:Qa,setSizeDialog:Hr,setSetSizeDialog:Do,autoSaveDialog:Sc,setAutoSaveDialog:Lo,autoSavePromptDialog:va,setAutoSavePromptDialog:nr,debugDialog:eo,setDebugDialog:cl,errorDialog:fo,setErrorDialog:po,newProjectDialog:wa,setNewProjectDialog:ir,openProjectDialog:Mo,setOpenProjectDialog:Da,newProjectSetupDialog:_i,setNewProjectSetupDialog:Io,saveAsDialog:os,setSaveAsDialog:ws,showColorPicker:id,setShowColorPicker:La,transformImagesDialogVisible:Tl,setTransformImagesDialogVisible:Pr}=wc,Zl=QT(),[sd,to]=X.useState(!1),[dl,zo]=X.useState(!1),[Sa,qr]=X.useState(!1),[Ma,Bo]=X.useState(null),[Aa,go]=X.useState(null),[$i,Ri]=X.useState(null),[Ss,sr]=X.useState(null),[_l,ul]=X.useState(null),{autoSaveEnabled:rr,setAutoSaveEnabled:Ca,autoSaveInterval:kl,setAutoSaveInterval:hl,autoSaveDirHandle:Nl,setAutoSaveDirHandle:Jl,autoSaveBaseName:jl,setAutoSaveBaseName:no,currentProjectFilePath:Pl,setCurrentProjectFilePath:hs,projectDirHandle:ki,setProjectDirHandle:qs,projectName:Vs,setProjectName:Ia,autoSaveFileHistory:jd,setAutoSaveFileHistory:fl,currentFileIndex:Pd,setCurrentFileIndex:Oo,autoSaveIntervalRef:Fi,hasChangesSinceLastAutoSaveRef:ls,prevAutoSaveEnabledRef:Er}=Zl,Ed=X.useRef(null),ia=X.useRef(null),rd=X.useRef(null),za=X.useRef(null),qc=X.useRef(null),El=X.useRef(null),Ql=X.useRef(null),[pl,Ac]=X.useState(!1),Fo=X.useRef(null),ec=X.useRef(null),[Ba,tc]=X.useState(!1),[mo,Rl]=X.useState({}),[ad,ar]=X.useState(!1),yo=X.useCallback(()=>{const p=rs.current;if(!p)return null;const C=p.width-10,L=p.height-10;let Y=1/0,le=1/0,he=-1/0,U=-1/0,Ae=!1;if(t){const Le=t,Ee=(Le.width||0)/2,He=(Le.height||0)/2;Y=Math.min(Y,Le.x-Ee),le=Math.min(le,Le.y-He),he=Math.max(he,Le.x+Ee),U=Math.max(U,Le.y+He),Ae=!0}if(s){const Le=s,Ee=(Le.width||0)/2,He=(Le.height||0)/2;Y=Math.min(Y,Le.x-Ee),le=Math.min(le,Le.y-He),he=Math.max(he,Le.x+Ee),U=Math.max(U,Le.y+He),Ae=!0}if(!Ae)return{pcbReferenceX:0,pcbReferenceY:0,x:0,y:0,zoom:1,viewRotation:0,viewFlipX:!1,isBottomView:!1,transparency:0,showTopImage:!0,showBottomImage:!0,showViasLayer:!0,showTopTracesLayer:!0,showBottomTracesLayer:!0,showTopPadsLayer:!0,showBottomPadsLayer:!0,showTopTestPointsLayer:!0,showBottomTestPointsLayer:!0,showTopComponents:!0,showBottomComponents:!0,showPowerLayer:!0,showGroundLayer:!0,showConnectionsLayer:!0};const pe=he-Y,je=U-le,Ne=.1,ke=pe*(1+2*Ne),ge=je*(1+2*Ne),Se=ke>0?C/ke:1,be=ge>0?L/ge:1;return{pcbReferenceX:0,pcbReferenceY:0,x:0,y:0,zoom:Math.min(Se,be,1),viewRotation:0,viewFlipX:!1,isBottomView:!1,transparency:0,showTopImage:!0,showBottomImage:!0,showViasLayer:!0,showTopTracesLayer:!0,showBottomTracesLayer:!0,showTopPadsLayer:!0,showBottomPadsLayer:!0,showTopTestPointsLayer:!0,showBottomTestPointsLayer:!0,showTopComponents:!0,showBottomComponents:!0,showPowerLayer:!0,showGroundLayer:!0,showConnectionsLayer:!0}},[t,s]);Tt.useEffect(()=>{const p=yo();p&&Rl(C=>C[0]?C:{...C,0:p})},[t,s,yo]);const Js=X.useRef(null),[Oa,xo]=X.useState(!1),[Rr,Cc]=X.useState(null),[od,nc]=X.useState(null),[Dl,sa]=X.useState({width:960,height:600}),As=X.useRef(null),Ni=X.useRef(null),Fa=X.useRef(null),Qs=X.useRef(null),bo=X.useRef(null),ic=X.useRef(null),Qd=X.useRef(null),Ll=X.useRef(null),[Ls,or]=X.useState(!0),[Ml,mr]=X.useState(!0),[lr,Vr]=X.useState(!0),[Ns,Wr]=X.useState(!0),[ys,Ta]=X.useState(!0),[cr,$r]=X.useState(!0),[Gr,Yr]=X.useState(!0),[fs,Uo]=X.useState(!0),[vo,sc]=X.useState(!0),[io,Ho]=X.useState(!0),[Di,ra]=X.useState(!0),[_a,Xr]=X.useState(!0),Dn=we,y=Fe,[A,E]=X.useState(!1),[O,ie]=X.useState(null),[re,oe]=X.useState(!1),[de,me]=X.useState(void 0),[_e,ze]=X.useState(!1),[Ke,ve]=X.useState(!1),[Be,$e]=X.useState(null),[ut,We]=X.useState(new Set),Je=X.useCallback(()=>{Tn(new Set),_n(new Set),rn(new Set),mn(new Set),We(new Set)},[Tn,_n,rn,mn,We]),[mt,_t]=X.useState(!1),[wt,on]=X.useState(null),[$t,ln]=X.useState(!1),[Ht,ii]=X.useState(null),[ts,Xn]=X.useState(!0),[Wt,Mt]=X.useState(!1),[Ws,En]=X.useState(!1),qn=X.useRef({}),[ri,Ui]=X.useState(!0),[Cs,Li]=X.useState(!0),[Ms,Kr]=X.useState(!0),[Gi,si]=X.useState(null),[Mi,Is]=X.useState(!1),[Ii,yr]=X.useState(null),[js,mi]=X.useState(!1),[Ts,Hi]=X.useState(null),[er,dr]=X.useState(!1),[ns,zi]=X.useState(null),[xr,_s]=X.useState([]),[wn,Sn]=X.useState(!1),[Ai,Zr]=X.useState(null),[so,aa]=X.useState(!1),[$s,Il]=X.useState(null),[Tc,zl]=X.useState(!1),[ps,Vc]=X.useState(!1),[eu,Rd]=X.useState(null),[qo,xh]=X.useState(!1),[_c,Dd]=X.useState(null),[Ld,Dr]=X.useState(!1),Ps=X.useRef(null),kc=X.useRef(!1),wo=X.useRef(null),rc=X.useRef(!1),gl=X.useRef(!1);Tt.useEffect(()=>{Ps.current=eu},[eu]),Tt.useEffect(()=>{kc.current=qo},[qo]),Tt.useEffect(()=>{wo.current=_c},[_c]),Tt.useEffect(()=>{rc.current=Ld},[Ld]),Tt.useEffect(()=>{gl.current=ps},[ps]);const[Bl,ld]=X.useState(null),[cd,Wc]=X.useState(!1);Tt.useEffect(()=>{yn.length===0&&Ro([{id:"default-3v3",name:"+3.3V",voltage:"+3.3VDC",color:"#ff6600"},{id:"default-5v",name:"+5V",voltage:"+5VDC",color:"#ff0000"}])},[yn.length,Ro]);const So=X.useCallback((p,C)=>{const L=Dn.find(le=>le.pointId===p);if(L){const le=C.find(U=>U.id===L.powerBusId);return`Via (${le?le.voltage:L.type||"Power Node"})`}const Y=y.find(le=>le.pointId===p);return Y?`Via (${Y.type||"Ground"})`:"Via"},[Dn,y]),Jr=X.useCallback((p,C)=>{const L=Dn.find(le=>le.pointId===p);if(L){const le=C.find(U=>U.id===L.powerBusId);return`Pad (${le?le.voltage:L.type||"Power Node"})`}const Y=y.find(le=>le.pointId===p);return Y?`Pad (${Y.type||"Ground"})`:"Pad"},[Dn,y]),ml=X.useCallback((p,C)=>{const L=Dn.find(le=>le.pointId===p);if(L){const le=C.find(U=>U.id===L.powerBusId);return`Test Point (${le?le.voltage:L.type||"Power Node"})`}const Y=y.find(le=>le.pointId===p);return Y?`Test Point (${Y.type||"Ground"})`:"Test Point"},[Dn,y]),zu=X.useCallback(()=>{const p=pt.filter(C=>C.type==="via").map(C=>C.id);Tn(new Set(p)),_n(new Set),rn(new Set),mn(new Set),We(new Set)},[pt,Tn,_n,rn,mn]),bh=X.useCallback(()=>{const p=pt.filter(C=>C.type==="trace").map(C=>C.id);Tn(new Set(p)),_n(new Set),rn(new Set),mn(new Set),We(new Set)},[pt,Tn,_n,rn,mn]),Bu=X.useCallback(()=>{const p=pt.filter(C=>C.type==="pad").map(C=>C.id);Tn(new Set(p)),_n(new Set),rn(new Set),mn(new Set),We(new Set)},[pt,Tn,_n,rn,mn]),Nc=X.useCallback(()=>{const p=[...Ut,...Zt].map(C=>C.id);_n(new Set(p)),Tn(new Set),rn(new Set),mn(new Set),We(new Set)},[Ut,Zt,_n,Tn,rn,mn]),vh=X.useCallback(()=>{const p=[...Ut,...Zt].filter(C=>{const L=C.pinConnections||[];return!(L.length>0&&L.length===C.pinCount&&L.every(le=>le&&le.trim()!==""))}).map(C=>C.id);_n(new Set(p)),Tn(new Set),rn(new Set),mn(new Set),We(new Set),cl({visible:!0,text:""})},[Ut,Zt,_n,Tn,rn,mn,cl]),wh=X.useCallback(()=>{const p=new Set;let C=0;for(const L of[...Ut,...Zt]){const Y=L.pinConnections||[];for(const le of Y)if(le&&le.trim()!==""){const he=parseInt(le.trim(),10);if(!isNaN(he)&&he>0){const U=`${L.id}:${he}`;p.add(U),C++}}}if(console.log(`Component connections: ${C} connection lines found`),p.size===0){console.log("No component connections found - components may not have pins connected"),alert("No component connections found. Please connect component pins to vias or pads first.");return}We(p),Tn(new Set),_n(new Set),rn(new Set),mn(new Set),console.log(`Selected ${p.size} component connection lines`)},[Ut,Zt,Tn,_n,rn,mn]),Ou=X.useCallback(()=>{Sa?(Ds(!1),qr(!1),f(0)):(Ds(!0),qr(!0),f(100))},[Sa,Ds,qr,f]),tu=X.useCallback(p=>{vs(C=>Om(C,p))},[vs]),ac=X.useCallback((p,C)=>{const L=rs.current;if(!L)return;const Y=L.width-10,le=L.height-10,he=Y/2,U=le/2,Ae=he-p*Ct,pe=U-C*Ct;Po({x:Ae,y:pe})},[Ct,Po]),$c=X.useCallback((p,C,L)=>{ac(C,L),_n(new Set([p])),Tn(new Set),rn(new Set),mn(new Set),We(new Set)},[ac,_n,Tn,rn,mn]),nu=X.useCallback((p,C,L)=>{ac(C,L),Tn(new Set([p])),_n(new Set),rn(new Set),mn(new Set),We(new Set)},[ac,Tn,_n,rn,mn]),Md=X.useCallback((p,C,L)=>{ac(C,L),rn(new Set([p])),Tn(new Set),_n(new Set),mn(new Set),We(new Set)},[ac,rn,Tn,_n,mn]),Ol=X.useCallback((p,C,L)=>{ac(C,L),mn(new Set([p])),Tn(new Set),_n(new Set),rn(new Set),We(new Set)},[ac,mn,Tn,_n,rn]),oc=Tt.useMemo(()=>{const p=new Set(Dn.map(L=>L.powerBusId).filter(L=>typeof L=="string"&&L.length>0)),C=yn.filter(L=>p.has(L.id)).map(L=>L.name);return Array.from(new Set(C)).sort()},[Dn,yn]),lc=Tt.useMemo(()=>{const p=new Set(y.map(L=>L.groundBusId).filter(L=>typeof L=="string"&&L.length>0)),C=j.filter(L=>p.has(L.id)).map(L=>L.name);return Array.from(new Set(C)).sort()},[y,j]),iu=X.useCallback(()=>{const p=Dn.map(C=>C.id);rn(new Set(p)),Tn(new Set),_n(new Set),mn(new Set),We(new Set)},[Dn,rn,Tn,_n,mn]),su=X.useCallback(()=>{const p=y.map(C=>C.id);mn(new Set(p)),Tn(new Set),_n(new Set),rn(new Set),We(new Set)},[y,mn,Tn,_n,rn]),Gc=X.useCallback(p=>{const C=yn.filter(Y=>Y.name===p).map(Y=>Y.id);if(C.length===0)return;const L=Dn.filter(Y=>Y.powerBusId&&C.includes(Y.powerBusId)).map(Y=>Y.id);rn(new Set(L)),Tn(new Set),_n(new Set),mn(new Set)},[yn,Dn,rn,Tn,_n,mn]),Sh=X.useCallback(p=>{const C=j.filter(Y=>Y.name===p).map(Y=>Y.id);if(C.length===0)return;const L=y.filter(Y=>Y.groundBusId&&C.includes(Y.groundBusId)).map(Y=>Y.id);mn(new Set(L)),Tn(new Set),_n(new Set),rn(new Set)},[j,y,mn,Tn,_n,rn]);X.useCallback(p=>{switch(p.componentType){case"Resistor":case"ResistorNetwork":case"Thermistor":case"VariableResistor":if("resistance"in p&&p.resistance&&"resistanceUnit"in p&&p.resistanceUnit)return`${p.resistance} ${p.resistanceUnit}`;break;case"Capacitor":case"Electrolytic Capacitor":case"Film Capacitor":if("capacitance"in p&&p.capacitance&&"capacitanceUnit"in p&&p.capacitanceUnit)return`${p.capacitance} ${p.capacitanceUnit}`;break;case"Inductor":if("inductance"in p&&p.inductance&&"inductanceUnit"in p&&p.inductanceUnit)return`${p.inductance} ${p.inductanceUnit}`;break;case"Battery":if("voltage"in p&&p.voltage&&"voltageUnit"in p&&p.voltageUnit)return`${p.voltage} ${p.voltageUnit}`;break;case"Diode":if("voltage"in p&&p.voltage&&"voltageUnit"in p&&p.voltageUnit)return`${p.voltage} ${p.voltageUnit}`;break;case"Fuse":if("current"in p&&p.current&&"currentUnit"in p&&p.currentUnit)return`${p.current} ${p.currentUnit}`;break;case"FerriteBead":if("impedance"in p&&p.impedance&&"impedanceUnit"in p&&p.impedanceUnit)return`${p.impedance} ${p.impedanceUnit}`;break;case"Relay":if("coilVoltage"in p&&p.coilVoltage&&"coilVoltageUnit"in p&&p.coilVoltageUnit)return`${p.coilVoltage} ${p.coilVoltageUnit}`;break;case"Speaker":if("impedance"in p&&p.impedance&&"impedanceUnit"in p&&p.impedanceUnit)return`${p.impedance} ${p.impedanceUnit}`;break;case"Motor":if("voltage"in p&&p.voltage&&"voltageUnit"in p&&p.voltageUnit)return`${p.voltage} ${p.voltageUnit}`;break;case"PowerSupply":if("outputVoltage"in p&&p.outputVoltage&&"outputVoltageUnit"in p&&p.outputVoltageUnit)return`${p.outputVoltage} ${p.outputVoltageUnit}`;break;case"Transistor":if("partNumber"in p&&p.partNumber)return p.partNumber;break;case"IntegratedCircuit":if("partNumber"in p&&p.partNumber)return p.partNumber;break}return null},[]);const dd=X.useCallback(p=>{const C=[];switch(p.componentType){case"Capacitor":case"Electrolytic Capacitor":case"Film Capacitor":"capacitance"in p&&p.capacitance&&"capacitanceUnit"in p&&p.capacitanceUnit&&C.push(`Capacitance: ${p.capacitance} ${p.capacitanceUnit}`),"voltage"in p&&p.voltage&&"voltageUnit"in p&&p.voltageUnit&&C.push(`Voltage: ${p.voltage} ${p.voltageUnit}`),"dielectric"in p&&p.dielectric&&C.push(`Dielectric: ${p.dielectric}`);break;case"Resistor":case"ResistorNetwork":case"Thermistor":"resistance"in p&&p.resistance&&"resistanceUnit"in p&&p.resistanceUnit&&C.push(`Resistance: ${p.resistance} ${p.resistanceUnit}`),"power"in p&&p.power&&C.push(`Power: ${p.power}`),"tolerance"in p&&p.tolerance&&C.push(`Tolerance: ${p.tolerance}`);break;case"VariableResistor":"resistance"in p&&p.resistance&&"resistanceUnit"in p&&p.resistanceUnit&&C.push(`Resistance: ${p.resistance} ${p.resistanceUnit}`),"vrType"in p&&p.vrType&&C.push(`Type: ${p.vrType}`),"power"in p&&p.power&&C.push(`Power: ${p.power}`),"taper"in p&&p.taper&&C.push(`Taper: ${p.taper}`);break;case"Inductor":"inductance"in p&&p.inductance&&"inductanceUnit"in p&&p.inductanceUnit&&C.push(`Inductance: ${p.inductance} ${p.inductanceUnit}`),"current"in p&&p.current&&"currentUnit"in p&&p.currentUnit&&C.push(`Current: ${p.current} ${p.currentUnit}`),"tolerance"in p&&p.tolerance&&C.push(`Tolerance: ${p.tolerance}`);break;case"Battery":"voltage"in p&&p.voltage&&"voltageUnit"in p&&p.voltageUnit&&C.push(`Voltage: ${p.voltage} ${p.voltageUnit}`),"capacity"in p&&p.capacity&&"capacityUnit"in p&&p.capacityUnit&&C.push(`Capacity: ${p.capacity} ${p.capacityUnit}`);break;case"Diode":"voltage"in p&&p.voltage&&"voltageUnit"in p&&p.voltageUnit&&C.push(`Voltage: ${p.voltage} ${p.voltageUnit}`),"current"in p&&p.current&&"currentUnit"in p&&p.currentUnit&&C.push(`Current: ${p.current} ${p.currentUnit}`);break;case"Fuse":"current"in p&&p.current&&"currentUnit"in p&&p.currentUnit&&C.push(`Current: ${p.current} ${p.currentUnit}`),"voltage"in p&&p.voltage&&"voltageUnit"in p&&p.voltageUnit&&C.push(`Voltage: ${p.voltage} ${p.voltageUnit}`);break;case"FerriteBead":"impedance"in p&&p.impedance&&"impedanceUnit"in p&&p.impedanceUnit&&C.push(`Impedance: ${p.impedance} ${p.impedanceUnit}`),"current"in p&&p.current&&"currentUnit"in p&&p.currentUnit&&C.push(`Current: ${p.current} ${p.currentUnit}`);break;case"Relay":"coilVoltage"in p&&p.coilVoltage&&"coilVoltageUnit"in p&&p.coilVoltageUnit&&C.push(`Coil Voltage: ${p.coilVoltage} ${p.coilVoltageUnit}`),"contactRating"in p&&p.contactRating&&C.push(`Contact Rating: ${p.contactRating}`);break;case"Speaker":"impedance"in p&&p.impedance&&"impedanceUnit"in p&&p.impedanceUnit&&C.push(`Impedance: ${p.impedance} ${p.impedanceUnit}`),"power"in p&&p.power&&C.push(`Power: ${p.power}`);break;case"Motor":"voltage"in p&&p.voltage&&"voltageUnit"in p&&p.voltageUnit&&C.push(`Voltage: ${p.voltage} ${p.voltageUnit}`),"speed"in p&&p.speed&&"speedUnit"in p&&p.speedUnit&&C.push(`Speed: ${p.speed} ${p.speedUnit}`);break;case"PowerSupply":"outputVoltage"in p&&p.outputVoltage&&"outputVoltageUnit"in p&&p.outputVoltageUnit&&C.push(`Output Voltage: ${p.outputVoltage} ${p.outputVoltageUnit}`),"outputCurrent"in p&&p.outputCurrent&&"outputCurrentUnit"in p&&p.outputCurrentUnit&&C.push(`Output Current: ${p.outputCurrent} ${p.outputCurrentUnit}`);break;case"Transistor":"partNumber"in p&&p.partNumber&&C.push(`Part Number: ${p.partNumber}`),"transistorType"in p&&p.transistorType&&C.push(`Type: ${p.transistorType}`);break;case"Crystal":"frequency"in p&&p.frequency&&C.push(`Frequency: ${p.frequency}`),"loadCapacitance"in p&&p.loadCapacitance&&C.push(`Load Capacitance: ${p.loadCapacitance}`),"tolerance"in p&&p.tolerance&&C.push(`Tolerance: ${p.tolerance}`);break;case"VacuumTube":"tubeType"in p&&p.tubeType&&C.push(`Tube Type: ${p.tubeType}`),"partNumber"in p&&p.partNumber&&C.push(`Part Number: ${p.partNumber}`);break}return C},[]),[Fl,Id]=X.useState(!1),ud=X.useRef(null),[Ah,ru]=X.useState(!1),[Ch,au]=X.useState(!1),ou=X.useRef(null),lu=X.useRef(null),cu=X.useRef(null),Fu=X.useRef(null),[Ep,Uu]=X.useState(!1),[cc,Th]=X.useState(null),[f0,Sf]=X.useState(null),[Yc,Rp]=X.useState(null),Hu=Tt.useRef(null),Af=Tt.useRef(null),_h=Tt.useRef(null),kh=X.useRef(null),Nh=X.useRef(null),qu=X.useRef(null),Vu=X.useRef(null),Wu=X.useRef(null),du=X.useRef(null),[Dp,Lp]=X.useState(null),[Vo,Cf]=X.useState(!1),[hd,Tf]=X.useState(null),[jc,$u]=X.useState(null);Tt.useEffect(()=>{Af.current=Yc},[Yc]),Tt.useEffect(()=>{_h.current=cc},[cc]);const _f=X.useCallback(async(p,C)=>{if(!C)throw new Error("No project directory available. Please create or open a project before loading images. The project directory is needed to store image files.");try{let L;try{L=await C.getDirectoryHandle("images",{create:!0})}catch(he){throw new Error(`Failed to create images directory in project folder. This may be due to insufficient permissions. Please ensure you have write access to the project directory. Error details: ${he.message}`)}const Y=p.name,le=`images/${Y}`;try{const U=await(await L.getFileHandle(Y,{create:!0})).createWritable();return await U.write(p),await U.close(),console.log(`Image copied to project directory: ${le}`),le}catch(he){throw new Error(`Failed to copy image file "${Y}" to project images directory. The file may be locked by another application, or there may be insufficient disk space. Please try again or check your disk space. Error details: ${he.message}`)}}catch(L){throw L instanceof Error&&L.message.includes("No project directory")||L instanceof Error&&L.message.includes("Failed to")?L:new Error(`An unexpected error occurred while copying the image to the project directory. This may be due to file system permissions or disk space issues. Please try again. Technical details: ${L.message}`)}},[]),kf=X.useCallback(async(p,C)=>{try{const L=p.name.toLowerCase(),le=[".png",".jpg",".jpeg"].some(be=>L.endsWith(be)),U=["image/png","image/jpeg","image/jpg"].includes(p.type);if(!le&&!U){alert(`Error: Unsupported image format.

The software only accepts PNG and JPEG image files.

File selected: ${p.name}
File type: ${p.type||"unknown"}

Please select a .png, .jpg, or .jpeg image file.`);return}let Ae;if(ki)try{Ae=await _f(p,ki)}catch(be){const ye=be instanceof Error?be.message:"Unknown error occurred while copying image to project directory.";alert(`Error: ${ye}

The image could not be loaded. Please ensure you have a project open and have write permissions to the project directory.`);return}else{if(!confirm(`Warning: No project directory is currently open. The image will be loaded, but you must create or open a project and save it before the image will be stored in the project directory.

Do you want to continue loading the ${C==="top"?"top":"bottom"} image?`))return;Ae=p.name}const pe=await createImageBitmap(p),je=URL.createObjectURL(p),Ne=rs.current;let ke=0,ge=0;Ne&&(ke=Ti.x,ge=Ti.y);const Se={url:je,name:p.name,width:pe.width,height:pe.height,filePath:Ae,x:ke,y:ge,scale:1,rotation:0,flipX:!1,flipY:!1,skewX:0,skewY:0,keystoneV:0,keystoneH:0,bitmap:pe};C==="top"?n(Se):o(Se)}catch(L){const Y=L instanceof Error?L.message:"Unknown error occurred while loading the image.";alert(`Error: Failed to load image file "${p.name}".

${Y}

Please ensure the file is a valid image format (PNG, JPEG, etc.) and is not corrupted.`),console.error("Failed to load image",L)}},[Ti,Ct,ki,_f]),zd=X.useCallback(p=>{p.stopPropagation(),p.preventDefault();const C=rs.current;if(!C)return;document.activeElement!==C&&C.focus();const L=C.getBoundingClientRect(),Y=C.width/L.width,le=C.height/L.height,he=p.nativeEvent.offsetX,U=p.nativeEvent.offsetY,Ae=typeof he=="number"?he:p.clientX-L.left,pe=typeof U=="number"?U:p.clientY-L.top,je=Ae*Y,Ne=pe*le,ke=je-5,ge=Ne-5,Se=Qf(ke,ge,es,Ct,ti,Ji),be=Se.x,ye=Se.y;if(kc.current&&k==="select"){Dr(!0),Dd({start:{x:be,y:ye},end:{x:be,y:ye}});return}if(k==="center"){ar(!0),Js.current&&clearTimeout(Js.current),Js.current=setTimeout(()=>{ar(!1),N("select"),ya(void 0)},2e3);return}if(k==="select"){if(Zs){let Ie=1/0,Xe=null,Ye=null;const dt=Math.max(6/Ct,4),Jt=[...Ut,...Zt].find(Nn=>Nn.id===Zs.componentId)?.layer||"top";for(const Nn of pt)if((Nn.type==="via"||Nn.type==="pad")&&Nn.points.length>0){if(Nn.type==="pad"&&(Nn.layer||"top")!==Jt)continue;const kn=Nn.points[0],On=Math.max(1,Nn.size/2),Kn=Math.hypot(kn.x-be,kn.y-ye),Vt=Math.max(On,dt);Kn<=Vt&&Kn<Ie&&(Ie=Kn,Xe=kn.id??null,Ye=Nn)}if(Ye?(console.log(`
[PIN CONNECTION] Found via!`),console.log(`  Stroke ID: ${Ye.id}`),console.log(`  Point ID: ${Xe}`),console.log(`  Point coordinates: x=${Ye.points[0].x.toFixed(2)}, y=${Ye.points[0].y.toFixed(2)}`),console.log(`  Click coordinates: x=${be.toFixed(2)}, y=${ye.toFixed(2)}`),console.log(`  Distance: ${Ie.toFixed(2)}`),console.log(`  Via size: ${Ye.size}, radius: ${Math.max(1,Ye.size/2)}`)):(console.log(`
[PIN CONNECTION] No via found!`),console.log(`  Click coordinates: x=${be.toFixed(2)}, y=${ye.toFixed(2)}`),console.log(`  Hit tolerance: ${dt.toFixed(2)}`),console.log(`  Total vias in drawingStrokes: ${pt.filter(Nn=>Nn.type==="via").length}`)),Xe!=null){console.log(`
[PIN CONNECTION] Proceeding with connection...`),console.log(`  bestPointId is valid: ${Xe} (type: ${typeof Xe})`);const Nn=String(Xe),kn=Zs.pinIndex,On=Zs.componentId;console.log(`
=== PIN CONNECTION START ===`),console.log(`Connecting pin ${kn} (Pin ${kn+1}) of component ${On} to point ID ${Nn}`);const Kn=Ut.find(Et=>Et.id===On),Vt=Zt.find(Et=>Et.id===On);Kn?(console.log("Component found in TOP layer"),Pi(Et=>{const un=Et.find(Zn=>Zn.id===On);if(!un)return console.error(`Component ${On} not found in TOP layer during update!`),Et;console.log("BEFORE update: pinConnections =",un.pinConnections);const cs=un.pinConnections||[],Bi=cs.length>0?[...cs]:new Array(un.pinCount).fill("");let ds;if(Bi.length!==un.pinCount){ds=new Array(un.pinCount).fill("");for(let Zn=0;Zn<Math.min(Bi.length,un.pinCount);Zn++)ds[Zn]=Bi[Zn]||""}else ds=[...Bi];ds[kn]=Nn,console.log(`Updating pin ${kn} with value: ${Nn}`),console.log("New pinConnections array:",ds);const tr=Et.map(Zn=>Zn.id===On?{...Zn,pinConnections:ds}:Zn),Yi=tr.find(Zn=>Zn.id===On);return console.log("AFTER update: pinConnections =",Yi?.pinConnections),console.log(`Pin ${kn} value: ${Yi?.pinConnections[kn]}`),console.log(`=== PIN CONNECTION COMPLETE (TOP) ===
`),tr})):Vt?(console.log("Component found in BOTTOM layer"),Yn(Et=>{const un=Et.find(Zn=>Zn.id===On);if(!un)return console.error(`Component ${On} not found in BOTTOM layer during update!`),Et;console.log("BEFORE update: pinConnections =",un.pinConnections);const cs=un.pinConnections||[],Bi=cs.length>0?[...cs]:new Array(un.pinCount).fill("");let ds;if(Bi.length!==un.pinCount){ds=new Array(un.pinCount).fill("");for(let Zn=0;Zn<Math.min(Bi.length,un.pinCount);Zn++)ds[Zn]=Bi[Zn]||""}else ds=[...Bi];ds[kn]=Nn,console.log(`Updating pin ${kn} with value: ${Nn}`),console.log("New pinConnections array:",ds);const tr=Et.map(Zn=>Zn.id===On?{...Zn,pinConnections:ds}:Zn),Yi=tr.find(Zn=>Zn.id===On);return console.log("AFTER update: pinConnections =",Yi?.pinConnections),console.log(`Pin ${kn} value: ${Yi?.pinConnections[kn]}`),console.log(`=== PIN CONNECTION COMPLETE (BOTTOM) ===
`),tr})):(console.error(`Component ${On} not found in either TOP or BOTTOM layer!`),console.log("Available TOP components:",Ut.map(Et=>Et.id)),console.log("Available BOTTOM components:",Zt.map(Et=>Et.id))),setTimeout(()=>{rl(null)},0);return}else rl(null)}const Le=10,Ee=(()=>{for(const Ie of Ut)if(be>=Ie.x-Le&&be<=Ie.x+Le&&ye>=Ie.y-Le&&ye<=Ie.y+Le)return{layer:"top",comp:Ie};for(const Ie of Zt)if(be>=Ie.x-Le&&be<=Ie.x+Le&&ye>=Ie.y-Le&&ye<=Ie.y+Le)return{layer:"bottom",comp:Ie};return null})();if(Ee){const{comp:Ie}=Ee;p.shiftKey?_n(Xe=>{const Ye=new Set(Xe);return Ye.has(Ie.id)?Ye.delete(Ie.id):Ye.add(Ie.id),Ye}):(_n(new Set([Ie.id])),Tn(new Set),rn(new Set),mn(new Set));return}const He=Math.max(6/Ct,4);let ct=null;for(const Ie of Dn){const Xe=Math.max(6,Ie.size/2),Ye=Xe*.8,dt=Xe+Ye,Pt=Math.hypot(Ie.x-be,Ie.y-ye),Jt=Math.abs(be-Ie.x)<=He&&Math.abs(ye-Ie.y)<=dt,Nn=Math.abs(ye-Ie.y)<=He&&Math.abs(be-Ie.x)<=dt;if(Pt<=Math.max(Xe,He)||Jt||Nn){ct=Ie;break}}if(ct){p.shiftKey?rn(Ie=>{const Xe=new Set(Ie);return Xe.has(ct.id)?Xe.delete(ct.id):Xe.add(ct.id),Xe}):(rn(new Set([ct.id])),Tn(new Set),_n(new Set),mn(new Set));return}let ft=null;for(const Ie of y){const Xe=Math.max(6,(Ie.size||18)/2),Ye=Xe*.8,dt=Xe+Ye,Pt=Math.hypot(Ie.x-be,Ie.y-ye),Jt=Math.abs(be-Ie.x)<=He&&Math.abs(ye-Ie.y)<=dt,Nn=Math.abs(ye-Ie.y)<=He&&Math.abs(be-Ie.x)<=dt;if(Pt<=Math.max(Xe,He)||Jt||Nn){ft=Ie;break}}if(ft){p.shiftKey?mn(Ie=>{const Xe=new Set(Ie);return Xe.has(ft.id)?Xe.delete(ft.id):Xe.add(ft.id),Xe}):(mn(new Set([ft.id])),Tn(new Set),_n(new Set),rn(new Set));return}const nt=Math.max(6/Ct,4/Ct),Ue=Math.max(nt,.5);let qe=null;for(const Ie of pt)if((Ie.type==="via"||Ie.type==="pad"||Ie.type==="testPoint")&&Ie.points.length>0){let Xe=!1;if(Ie.type==="via"?Xe=lr:Ie.type==="pad"?Xe=(Ie.layer||"top")==="top"?cr:Gr:Ie.type==="testPoint"&&(Xe=(Ie.layer||"top")==="top"?fs:vo),!Xe)continue;const Ye=Ie.points[0],dt=Math.max(1,Ie.size/2);if(Math.hypot(Ye.x-be,Ye.y-ye)<=Math.max(dt,Ue)){qe=Ie;break}}if(qe){p.shiftKey?Tn(Ie=>{const Xe=new Set(Ie);return Xe.has(qe.id)?Xe.delete(qe.id):Xe.add(qe.id),Xe}):(Tn(new Set([qe.id])),_n(new Set),rn(new Set),mn(new Set),We(new Set));return}p.shiftKey||(Tn(new Set),_n(new Set),rn(new Set),mn(new Set),We(new Set)),xa(!0),Tf({x:be,y:ye,shiftKey:p.shiftKey}),$u({x:be,y:ye,width:0,height:0});return}else if(k==="magnify"){const Le=p.shiftKey?.5:2,Ee=Math.max(.25,Math.min(8,Ct*Le));Wa(be,ye),pi(Ee);return}else if(k==="pan"){const Le={topImageX:t?.x??0,topImageY:t?.y??0,bottomImageX:s?.x??0,bottomImageY:s?.y??0,componentsTop:Object.fromEntries(Ut.map(Ee=>[Ee.id,{x:Ee.x,y:Ee.y}])),componentsBottom:Object.fromEntries(Zt.map(Ee=>[Ee.id,{x:Ee.x,y:Ee.y}])),powerSymbols:Object.fromEntries(we.map(Ee=>[Ee.id,{x:Ee.x,y:Ee.y}])),groundSymbols:Object.fromEntries(Fe.map(Ee=>[Ee.id,{x:Ee.x,y:Ee.y}])),drawingStrokes:pt.map(Ee=>({points:Ee.points.map(He=>({x:He.x,y:He.y}))})),vias:na.map(Ee=>({x:Ee.x,y:Ee.y})),pads:Qi.map(Ee=>({x:Ee.x,y:Ee.y}))};Fo.current={startCX:ke,startCY:ge,panX:es.x,panY:es.y,objectStartPositions:Le},ec.current={startClientX:p.clientX,startClientY:p.clientY,panX:es.x,panY:es.y,objectStartPositions:Le},Ac(!0);return}else if(k==="draw"){const Le=(ct,ft)=>{let At=1/0,nt=null;const Ue=10/Ct,qe=Ct>20?Math.max(Ue,1e-4):Ct>10?Math.max(Ue,.001):Math.max(Ue,.01);for(const Ye of pt)if(Ye.type==="via"){const dt=Ye.points[0],Pt=Math.hypot(dt.x-ct,dt.y-ft);Pt<=qe&&Pt<At&&(At=Pt,nt=dt)}else if(Ye.type==="pad"){const dt=Ye.points[0],Pt=Math.hypot(dt.x-ct,dt.y-ft);Pt<=qe&&Pt<At&&(At=Pt,nt=dt)}for(const Ye of Dn)if(Ye.pointId!==void 0){const dt=Math.hypot(Ye.x-ct,Ye.y-ft);dt<=qe&&dt<At&&(At=dt,nt={x:Ye.x,y:Ye.y,id:Ye.pointId})}for(const Ye of y)if(Ye.pointId!==void 0){const dt=Math.hypot(Ye.x-ct,Ye.y-ft);dt<=qe&&dt<At&&(At=dt,nt={x:Ye.x,y:Ye.y,id:Ye.pointId})}const Xe=is(nt??{x:ct,y:ft});return{x:Xe.x,y:Xe.y,nodeId:nt?.id}};if(lt==="via"){const ct=Mn.get("via"),ft=ct.color,At=ct.size,Ft=Vo?{x:is({x:be,y:ye}).x,y:is({x:be,y:ye}).y}:((Ye,dt)=>{let Pt=1/0,Jt=null;const kn=10/Ct,On=Ct>10?Math.max(kn,.001):Math.max(kn,.01);for(const Et of pt)if(Et.type==="via"||Et.type==="pad"){const un=Et.points[0],cs=Math.hypot(un.x-Ye,un.y-dt);cs<=On&&cs<Pt&&(Pt=cs,Jt=un)}for(const Et of Dn)if(Et.pointId!==void 0){const un=Math.hypot(Et.x-Ye,Et.y-dt);un<=On&&un<Pt&&(Pt=un,Jt={x:Et.x,y:Et.y,id:Et.pointId})}for(const Et of y)if(Et.pointId!==void 0){const un=Math.hypot(Et.x-Ye,Et.y-dt);un<=On&&un<Pt&&(Pt=un,Jt={x:Et.x,y:Et.y,id:Et.pointId})}const Vt=is(Jt??{x:Ye,y:dt});return{x:Vt.x,y:Vt.y,nodeId:Jt?.id}})(be,ye),Ue=Ft.nodeId??Xc(),qe=So(Ue,yn),Ie={id:Ue,x:Ft.x,y:Ft.y};pn(pt,Ut,Zt,we,Fe);const Xe={id:`${Date.now()}-via`,points:[Ie],color:ft,size:At,layer:Xt,type:"via",viaType:qe};jt(Ye=>[...Ye,Xe]),Xt==="top"?kr(Ye=>[...Ye,Xe.id]):sl(Ye=>[...Ye,Xe.id]);return}if(lt==="pad"){if(!xi)return;const ft=Vo?{x:is({x:be,y:ye}).x,y:is({x:be,y:ye}).y}:((Xe,Ye)=>{let dt=1/0,Pt=null;const Nn=10/Ct,kn=Ct>10?Math.max(Nn,.001):Math.max(Nn,.01);for(const Vt of pt)if(Vt.type==="via"||Vt.type==="pad"||Vt.type==="testPoint"){const Et=Vt.points[0],un=Math.hypot(Et.x-Xe,Et.y-Ye);un<=kn&&un<dt&&(dt=un,Pt=Et)}for(const Vt of Dn)if(Vt.pointId!==void 0){const Et=Math.hypot(Vt.x-Xe,Vt.y-Ye);Et<=kn&&Et<dt&&(dt=Et,Pt={x:Vt.x,y:Vt.y,id:Vt.pointId})}for(const Vt of y)if(Vt.pointId!==void 0){const Et=Math.hypot(Vt.x-Xe,Vt.y-Ye);Et<=kn&&Et<dt&&(dt=Et,Pt={x:Vt.x,y:Vt.y,id:Vt.pointId})}const Kn=is(Pt??{x:Xe,y:Ye});return{x:Kn.x,y:Kn.y,nodeId:Pt?.id}})(be,ye),At=ft.nodeId??Xc(),nt=Jr(At,yn),Ft=B||(xi==="top"?ee:Ce),Ue=te||(xi==="top"?J:W),qe={id:At,x:ft.x,y:ft.y};pn(pt,Ut,Zt,we,Fe);const Ie={id:`${Date.now()}-pad`,points:[qe],color:Ft,size:Ue,layer:xi,type:"pad",padType:nt};jt(Xe=>[...Xe,Ie]);return}if(lt==="testPoint"){if(!Rn)return;const ft=Vo?{x:is({x:be,y:ye}).x,y:is({x:be,y:ye}).y}:((Ye,dt)=>{let Pt=1/0,Jt=null;const Nn=15;for(const Kn of pt)if(Kn.type==="via"||Kn.type==="pad"||Kn.type==="testPoint"){const Vt=Kn.points[0],Et=Math.hypot(Vt.x-Ye,Vt.y-dt);Et<=Nn&&Et<Pt&&(Pt=Et,Jt=Vt)}for(const Kn of Dn)if(Kn.pointId!==void 0){const Vt=Math.hypot(Kn.x-Ye,Kn.y-dt);Vt<=Nn&&Vt<Pt&&(Pt=Vt,Jt={x:Kn.x,y:Kn.y,id:Kn.pointId})}for(const Kn of y)if(Kn.pointId!==void 0){const Vt=Math.hypot(Kn.x-Ye,Kn.y-dt);Vt<=Nn&&Vt<Pt&&(Pt=Vt,Jt={x:Kn.x,y:Kn.y,id:Kn.pointId})}const On=is(Jt??{x:Ye,y:dt});return{x:On.x,y:On.y,nodeId:Jt?.id}})(be,ye),At=ft.nodeId??Xc(),nt=ml(At,yn),Ft=nt.includes("Power")?"power":nt.includes("Ground")?"ground":nt.includes("Signal")?"signal":"unknown",Ue=is({x:ft.x,y:ft.y}),qe=B||(Rn==="top"?ue:Pe),Ie=te||(Rn==="top"?De:ot);pn(pt,Ut,Zt,we,Fe);const Xe={id:`${Date.now()}-testPoint`,points:[{id:At,x:Ue.x,y:Ue.y}],color:qe,size:Ie,layer:Rn,type:"testPoint",testPointType:Ft};jt(Ye=>[...Ye,Xe]);return}if(Vn.current)return;const Ee=lt==="trace"&&!Vo?Le(be,ye):{x:is({x:be,y:ye}).x,y:is({x:be,y:ye}).y},He=Ee.nodeId!==void 0?{id:Ee.nodeId,x:Ee.x,y:Ee.y}:{x:Ee.x,y:Ee.y};Pn(ct=>ct.length===0?[He]:[...ct,He]),Vi.current=Date.now(),An(null),tn(!1),qa(!1)}else if(k==="erase"){if(pt.some(Ee=>Ee.layer===Xt&&(Ee.type==="via"&&Ei||Ee.type==="pad"&&as||Ee.type==="testPoint"&&jr||Ee.type==="trace"&&pr))){const Ee=[];Ei&&pt.some(He=>He.layer===Xt&&He.type==="via")&&Ee.push("vias"),as&&pt.some(He=>He.layer===Xt&&He.type==="pad")&&Ee.push("pads"),jr&&pt.some(He=>He.layer===Xt&&He.type==="testPoint")&&Ee.push("test points"),pr&&pt.some(He=>He.layer===Xt&&He.type==="trace")&&Ee.push("traces"),Ee.length>0&&alert(`Cannot erase: ${Ee.join(", ")} are locked on the ${Xt} layer. Unlock them to erase.`)}tn(!0),Pn([{id:Xc(),x:be,y:ye}]),console.log("Starting erase at:",be,ye,"selectedDrawingLayer:",Xt,"total strokes:",pt.length)}else if(k==="transform"&&Qt){if(ji){alert("Cannot transform: Images are locked. Unlock images to transform them.");return}zr(!0),en({x:be,y:ye})}else if(k==="component"){if(!_h.current)return;const Le=is({x:be,y:ye}),He=($a.current||"top")==="top"?"componentTop":"componentBottom",ct=Mn.get(He),ft=ct.color,At=ct.size,nt=[...Ut,...Zt];let Ft;if(Wt?Ft=rm():Ft={...qn.current},!$a.current)return;const Ue=Af.current?.dataDrivenDefinition;if(!Ue){console.error("[Component Creation] Missing dataDrivenDefinition metadata for selected component.");return}let qe;try{qe=f5({definition:Ue,layer:$a.current,x:Le.x,y:Le.y,color:ft,size:At,existingComponents:nt,counters:ts?Ft:{}})}catch(Ie){console.error("[Component Creation] Error creating component with v2 runtime:",Ie);return}if(qe.abbreviation=Nm(_h.current),ts&&qe.designator){const Ie=qe.designator.match(/^([A-Za-z]+)(\d+)$/);if(Ie){const Xe=Ie[1],Ye=parseInt(Ie[2],10);if(Wt){const dt=rm();c5(Xe,Ye,dt)}else qn.current[Xe]=Math.max(qn.current[Xe]||0,Ye)}}pn(pt,Ut,Zt,we,Fe),$a.current==="top"?(Ho(!0),Pi(Ie=>[...Ie,qe])):(ra(!0),Yn(Ie=>[...Ie,qe]));return}else if(k==="power"){if(!Be)return;const Ee=Vo?{x:is({x:be,y:ye}).x,y:is({x:be,y:ye}).y}:((ct,ft)=>{let At=1/0,nt=null;const Ue=10/Ct,qe=Ct>20?Math.max(Ue,1e-4):Ct>10?Math.max(Ue,.001):Math.max(Ue,.01);for(const Ye of pt)if(Ye.type==="via"||Ye.type==="pad"){const dt=Ye.points[0],Pt=Math.hypot(dt.x-ct,dt.y-ft);Pt<=qe&&Pt<At&&(At=Pt,nt=dt)}else if(Ye.type==="trace")for(const dt of Ye.points){const Pt=Math.hypot(dt.x-ct,dt.y-ft);Pt<=qe&&Pt<At&&(At=Pt,nt=dt)}const Xe=is(nt??{x:ct,y:ft});return{x:Xe.x,y:Xe.y,nodeId:nt?.id}})(be,ye),He=yn.find(ct=>ct.id===Be);if(He){const ct=Ee.nodeId??Xc(),ft=`${He.voltage} Power Node`;if(y.find(Ft=>Ft.pointId===ct)){po({visible:!0,title:"Node ID Conflict",message:`Cannot place power node: A ground node already exists at this Node ID (${ct}). Power and ground nodes cannot share the same Node ID.`});return}pn(pt,Ut,Zt,we,Fe);const nt={id:`power-${Date.now()}-${Math.random()}`,x:Ee.x,y:Ee.y,color:"#ff0000",size:te,powerBusId:He.id,layer:Xt,type:ft,pointId:ct};if(Re(Ft=>[...Ft,nt]),Ee.nodeId!==void 0){const Ft=So(Ee.nodeId,yn),Ue=Jr(Ee.nodeId,yn),qe=ml(Ee.nodeId,yn),Ie=qe.includes("Power")?"power":qe.includes("Ground")?"ground":qe.includes("Signal")?"signal":"unknown";jt(Xe=>Xe.map(Ye=>Ye.type==="via"&&Ye.points.length>0&&Ye.points[0].id===Ee.nodeId?{...Ye,viaType:Ft}:Ye.type==="pad"&&Ye.points.length>0&&Ye.points[0].id===Ee.nodeId?{...Ye,padType:Ue}:Ye.type==="testPoint"&&Ye.points.length>0&&Ye.points[0].id===Ee.nodeId?{...Ye,testPointType:Ie}:Ye))}}return}else if(k==="ground"){if(Ht===null){if(j.length===0){po({visible:!0,title:"No Ground Bus",message:"No ground buses are defined. Please create a ground bus first using Tools  Manage Ground Buses."});return}ln(!0);return}const Le=j.find(Ee=>Ee.id===Ht);if(Le){const He=Vo?{x:is({x:be,y:ye}).x,y:is({x:be,y:ye}).y}:((Ft,Ue)=>{let qe=1/0,Ie=null;const Ye=10/Ct,dt=Ct>20?Math.max(Ye,1e-4):Ct>10?Math.max(Ye,.001):Math.max(Ye,.01);for(const Nn of pt)if(Nn.type==="via"||Nn.type==="pad"){const kn=Nn.points[0],On=Math.hypot(kn.x-Ft,kn.y-Ue);On<=dt&&On<qe&&(qe=On,Ie=kn)}else if(Nn.type==="trace")for(const kn of Nn.points){const On=Math.hypot(kn.x-Ft,kn.y-Ue);On<=dt&&On<qe&&(qe=On,Ie=kn)}const Jt=is(Ie??{x:Ft,y:Ue});return{x:Jt.x,y:Jt.y,nodeId:Ie?.id}})(be,ye),ct=He.nodeId??Xc(),ft=`${Le.name} Ground Node`,At=Dn.find(Ft=>Ft.pointId===ct);if(At){po({visible:!0,title:"Node ID Conflict",message:`Cannot place ground node: A power node (${At.type||"Power Node"}) already exists at this Node ID (${ct}). Power and ground nodes cannot share the same Node ID.`});return}pn(pt,Ut,Zt,we,Fe);const nt={id:`gnd-${Date.now()}-${Math.random().toString(36).slice(2,6)}`,x:He.x,y:He.y,color:Le.color,size:te||Hn.get("ground")?.settings.size||18,groundBusId:Le.id,layer:Xt,type:ft,pointId:ct};if(st(Ft=>[...Ft,nt]),He.nodeId!==void 0){const Ft=So(He.nodeId,yn),Ue=Jr(He.nodeId,yn);jt(qe=>qe.map(Ie=>Ie.type==="via"&&Ie.points.length>0&&Ie.points[0].id===He.nodeId?{...Ie,viaType:Ft}:Ie.type==="pad"&&Ie.points.length>0&&Ie.points[0].id===He.nodeId?{...Ie,padType:Ue}:Ie))}}return}},[k,Qt,te,B,lt,Xt,pt,Ct,es.x,es.y,ti,Ji,Vo,Be,Ht,yn,j,cc,Hn,xi,Gn,Rn,Dn,y,So,Jr,ml,lr,cr,Gr]),Mp=X.useCallback(p=>{if(k!=="magnify")return;p.preventDefault();const C=rs.current;if(!C)return;const L=C.getBoundingClientRect(),Y=C.width/L.width,le=C.height/L.height,he=p.nativeEvent.offsetX,U=p.nativeEvent.offsetY,Ae=typeof he=="number"?he:p.clientX-L.left,pe=typeof U=="number"?U:p.clientY-L.top,je=Ae*Y,Ne=pe*le,ke=je-5,ge=Ne-5,Se=Qf(ke,ge,es,Ct,ti,Ji),be=Se.x,ye=Se.y,Le=1.2,Ee=1/Le,He=p.deltaY<0?Le:Ee,ct=Math.max(.25,Math.min(8,Ct*He));Wa(be,ye),pi(ct)},[k,Ct,es.x,es.y,ti,Ji]),Ip=X.useCallback(p=>{if(k==="draw"&&lt==="trace"){Vn.current=!0;let He=zn;if(He.length>1){const ct=[He[0]];for(let ft=1;ft<He.length;ft++){const At=ct[ct.length-1],nt=He[ft];(Math.abs(At.x-nt.x)>.001||Math.abs(At.y-nt.y)>.001)&&ct.push(nt)}He=ct}if(He.length>=1){pn(pt,Ut,Zt,we,Fe);const ct=Gn||"top",ft=ct==="top"?"traceTop":"traceBottom",At=Mn.get(ft),nt={id:`${Date.now()}-trace`,points:He,color:At.color,size:At.size,layer:ct,type:"trace"};jt(Ft=>[...Ft,nt]),ct==="top"?Ya(Ft=>[...Ft,nt.id]):Nr(Ft=>[...Ft,nt.id]),Pn([]),An(null),setTimeout(()=>{Vn.current=!1},300);return}}const C=rs.current;if(!C)return;const L=C.getBoundingClientRect(),Y=C.width/L.width,le=C.height/L.height,he=p.nativeEvent.offsetX,U=p.nativeEvent.offsetY,Ae=typeof he=="number"?he:p.clientX-L.left,pe=typeof U=="number"?U:p.clientY-L.top,je=Ae*Y,Ne=pe*le,ke=je-5,ge=Ne-5,Se=Qf(ke,ge,es,Ct,ti,Ji),be=Se.x,ye=Se.y,Le=Math.max(8/Ct,4),Ee=(()=>{for(const He of pt)if(He.type==="testPoint"&&He.points.length>0){const ct=He.points[0],ft=Math.hypot(ct.x-be,ct.y-ye),At=(He.size||18)/2;if(ft<=At+Le)return He}return null})();if(Ee){Tn(new Set([Ee.id])),_n(new Set),rn(new Set),mn(new Set),mi(!0);return}if(k==="select"||k==="component"){const ct=(()=>{for(const nt of Ut)if(be>=nt.x-10&&be<=nt.x+10&&ye>=nt.y-10&&ye<=nt.y+10)return{layer:"top",comp:nt};for(const nt of Zt)if(be>=nt.x-10&&be<=nt.x+10&&ye>=nt.y-10&&ye<=nt.y+10)return{layer:"bottom",comp:nt};return null})(),ft=Math.max(6/Ct,4);let At=null;for(const nt of Dn){const Ft=Math.max(6,nt.size/2),Ue=Ft*.8,qe=Ft+Ue,Ie=Math.hypot(nt.x-be,nt.y-ye),Xe=Math.abs(be-nt.x)<=ft&&Math.abs(ye-nt.y)<=qe,Ye=Math.abs(ye-nt.y)<=ft&&Math.abs(be-nt.x)<=qe;if(Ie<=Math.max(Ft,ft)||Xe||Ye){At=nt;break}}if(At){rn(new Set([At.id])),Gt({visible:!0,id:At.id,layer:At.layer,x:At.x,y:At.y,size:At.size,color:At.color,powerBusId:At.powerBusId});return}if(ct){const{layer:nt,comp:Ft}=ct;Eo(Ft,nt)}}},[k,lt,B,te,Xt,Ut,Zt,Dn,Ct,es.x,es.y,ti,Ji,cc,Vo,pt,Qt,pl,Dp,Zs,Hn,zn,Gn,H,M,R,se,mi,Tn,_n,rn,mn,Eo]),Gu=X.useCallback(()=>{const p=Cn.current;if(k==="draw"&&lt==="trace"&&p.length>=2){let C=[p[0]];for(let U=1;U<p.length;U++){const Ae=C[C.length-1],pe=p[U];(Math.abs(Ae.x-pe.x)>.001||Math.abs(Ae.y-pe.y)>.001)&&C.push(pe)}const L=Gn||"top",Y=L==="top"?"traceTop":"traceBottom",le=Mn.get(Y),he={id:`${Date.now()}-trace`,points:C,color:le.color,size:le.size,layer:L,type:"trace"};pn(pt,Ut,Zt,we,Fe),jt(U=>[...U,he]),L==="top"?Ya(U=>[...U,he.id]):Nr(U=>[...U,he.id]),Pn([]),An(null)}else if(k==="draw"&&lt==="trace"&&p.length===1){const C=Gn||"top",L=C==="top"?"traceTop":"traceBottom",Y=Mn.get(L),le={id:`${Date.now()}-trace-dot`,points:p,color:Y.color,size:Y.size,layer:C,type:"trace"};jt(he=>[...he,le]),C==="top"?Ya(he=>[...he,le.id]):Nr(he=>[...he,le.id]),Pn([])}},[k,lt,Gn,H,M,R,se,jt]),Yu=X.useCallback((p,C,L)=>{const Y=C-p.x,le=L-p.y;if(Y===0&&le===0)return{x:C,y:L};const U=(n5(Y,le)%180+180)%180,Ae=[0,45,90];let pe=0,je=1e9;for(const Ne of Ae){const ke=Math.abs(U-Ne);ke<je&&(je=ke,pe=Ne)}if(pe===0)return{x:C,y:p.y};if(pe===90)return{x:p.x,y:L};{const Ne=Math.min(Math.abs(Y),Math.abs(le)),ke=Y>=0?1:-1,ge=le>=0?1:-1;return{x:p.x+ke*Ne,y:p.y+ge*Ne}}},[]),zp=X.useCallback(p=>{const C=rs.current?.getBoundingClientRect();if(!C)return;const L=p.clientX-C.left,Y=p.clientY-C.top,le=rs.current,he=le.width/C.width,U=le.height/C.height,Ae=L*he,pe=Y*U,je=Ae-5,Ne=pe-5,ke=Qf(je,Ne,es,Ct,ti,Ji),ge=ke.x,Se=ke.y;if(Bo({x:ge,y:Se}),rc.current&&wo.current&&Dd({start:wo.current.start,end:{x:ge,y:Se}}),k==="draw"&&lt==="trace"&&zn.length>0){const ye=Vo?{x:is({x:ge,y:Se}).x,y:is({x:ge,y:Se}).y}:((Le,Ee)=>{let He=1/0,ct=null;const At=10/Ct,nt=Ct>20?Math.max(At,1e-4):Ct>10?Math.max(At,.001):Math.max(At,.01);for(const qe of pt)if(qe.type==="via"){const Ie=qe.points[0],Xe=Math.hypot(Ie.x-Le,Ie.y-Ee);Xe<=nt&&Xe<He&&(He=Xe,ct=Ie)}else if(qe.type==="pad"){const Ie=qe.points[0],Xe=Math.hypot(Ie.x-Le,Ie.y-Ee);Xe<=nt&&Xe<He&&(He=Xe,ct=Ie)}for(const qe of Dn)if(qe.pointId!==void 0){const Ie=Math.hypot(qe.x-Le,qe.y-Ee);Ie<=nt&&Ie<He&&(He=Ie,ct={x:qe.x,y:qe.y,id:qe.pointId})}for(const qe of y)if(qe.pointId!==void 0){const Ie=Math.hypot(qe.x-Le,qe.y-Ee);Ie<=nt&&Ie<He&&(He=Ie,ct={x:qe.x,y:qe.y,id:qe.pointId})}const Ue=is(ct??{x:Le,y:Ee});return{x:Ue.x,y:Ue.y,nodeId:ct?.id}})(ge,Se);An({x:ye.x,y:ye.y})}else An(null);if(Oa){const ye=(()=>{for(const Le of Ut)if(ge>=Le.x-10&&ge<=Le.x+10&&Se>=Le.y-10&&Se<=Le.y+10)return{layer:"top",comp:Le};for(const Le of Zt)if(ge>=Le.x-10&&ge<=Le.x+10&&Se>=Le.y-10&&Se<=Le.y+10)return{layer:"bottom",comp:Le};return null})();if(ye)Cc({component:ye.comp,layer:ye.layer,x:p.clientX,y:p.clientY}),nc(null);else{Cc(null);const Le=Math.max(8/Ct,4),Ee=(()=>{for(const He of pt)if(He.type==="testPoint"&&He.points.length>0){const ct=He.points[0],ft=Math.hypot(ct.x-ge,ct.y-Se),At=(He.size||18)/2;if(ft<=At+Le)return He}return null})();nc(Ee?{stroke:Ee,x:p.clientX,y:p.clientY}:null)}}else Cc(null),nc(null);if(k==="select"&&Hc&&hd){const be=hd.x,ye=hd.y;$u({x:Math.min(be,ge),y:Math.min(ye,Se),width:Math.abs(ge-be),height:Math.abs(Se-ye)})}else if(k==="pan"&&pl&&Fo.current){const{startCX:be,startCY:ye,objectStartPositions:Le}=Fo.current,Ee=je-be,He=Ne-ye,ct=sx(Ee,He,Ct,ti,Ji),ft=ct.x,At=ct.y;Le&&(t&&n({...t,x:Le.topImageX+ft,y:Le.topImageY+At}),s&&o({...s,x:Le.bottomImageX+ft,y:Le.bottomImageY+At}),Pi(Ut.map(nt=>({...nt,x:(Le.componentsTop?.[nt.id]?.x??nt.x)+ft,y:(Le.componentsTop?.[nt.id]?.y??nt.y)+At}))),Yn(Zt.map(nt=>({...nt,x:(Le.componentsBottom?.[nt.id]?.x??nt.x)+ft,y:(Le.componentsBottom?.[nt.id]?.y??nt.y)+At}))),Re(we.map(nt=>({...nt,x:(Le.powerSymbols?.[nt.id]?.x??nt.x)+ft,y:(Le.powerSymbols?.[nt.id]?.y??nt.y)+At}))),st(Fe.map(nt=>({...nt,x:(Le.groundSymbols?.[nt.id]?.x??nt.x)+ft,y:(Le.groundSymbols?.[nt.id]?.y??nt.y)+At}))),jt(pt.map((nt,Ft)=>({...nt,points:nt.points.map((Ue,qe)=>{const Ie=Le.drawingStrokes?.[Ft]?.points?.[qe];return{...Ue,x:(Ie?.x??Ue.x)+ft,y:(Ie?.y??Ue.y)+At}})}))),Rt(na.map((nt,Ft)=>{const Ue=Le.vias?.[Ft];return{...nt,x:(Ue?.x??nt.x)+ft,y:(Ue?.y??nt.y)+At}})),fr(Qi.map((nt,Ft)=>{const Ue=Le.pads?.[Ft];return{...nt,x:(Ue?.x??nt.x)+ft,y:(Ue?.y??nt.y)+At}})))}else if(Fn&&zn.length>0){if(k==="draw")if(pa){const be=zn[0],ye=Yu(be,ge,Se),Le=is(ye),Ee={id:Xc(),x:Le.x,y:Le.y};Pn([be,Ee])}else{const be=is({x:ge,y:Se});Pn(ye=>[...ye,{id:Xc(),x:be.x,y:be.y}])}else if(k==="erase"&&(Pn(be=>[...be,{id:Xc(),x:ge,y:Se}]),jt(be=>{const ye=be.filter(Ee=>{if(Ee.type==="via"&&Ei||Ee.type==="pad"&&as||Ee.type==="testPoint"&&jr||Ee.type==="trace"&&pr||Ee.layer!==Xt)return!0;const He=te/2,ct=ge-He,ft=ge+He,At=Se-He,nt=Se+He,Ft=(Ie,Xe)=>Ie>=ct&&Ie<=ft&&Xe>=At&&Xe<=nt,Ue=(Ie,Xe,Ye,dt)=>{const Kn=(tr,Yi)=>{let Zn=0;return tr<ct?Zn|=1:tr>ft&&(Zn|=2),Yi<At?Zn|=4:Yi>nt&&(Zn|=8),Zn};let Vt=Ie,Et=Xe,un=Ye,cs=dt,Bi=Kn(Vt,Et),ds=Kn(un,cs);for(;;){if((Bi|ds)===0)return!0;if((Bi&ds)!==0)return!1;const tr=Bi!==0?Bi:ds;let Yi=0,Zn=0;tr&8?(Yi=Vt+(un-Vt)*(nt-Et)/(cs-Et),Zn=nt):tr&4?(Yi=Vt+(un-Vt)*(At-Et)/(cs-Et),Zn=At):tr&2?(Zn=Et+(cs-Et)*(ft-Vt)/(un-Vt),Yi=ft):(Zn=Et+(cs-Et)*(ct-Vt)/(un-Vt),Yi=ct),tr===Bi?(Vt=Yi,Et=Zn,Bi=Kn(Vt,Et)):(un=Yi,cs=Zn,ds=Kn(un,cs))}};let qe=!1;if(Ee.points.length===1){const Ie=Ee.points[0];qe=Ft(Ie.x,Ie.y)}else for(let Ie=0;Ie<Ee.points.length-1;Ie++){const Xe=Ee.points[Ie],Ye=Ee.points[Ie+1];if(Ue(Xe.x,Xe.y,Ye.x,Ye.y)){qe=!0;break}}return qe&&console.log("Erasing stroke at position:",ge,Se,"brushSize:",te,"selectedLayer:",Xt),!qe});console.log("Strokes before:",be.length,"after:",ye.length);const Le=new Set(ye.map(Ee=>Ee.id));return kr(Ee=>Ee.filter(He=>Le.has(He))),sl(Ee=>Ee.filter(He=>Le.has(He))),Ya(Ee=>Ee.filter(He=>Le.has(He))),Nr(Ee=>Ee.filter(He=>Le.has(He))),ye}),li||Re(be=>{const ye=te/2,Le=ge-ye,Ee=ge+ye,He=Se-ye,ct=Se+ye,ft=At=>{const nt=At.size/2,Ft=At.x-nt,Ue=At.x+nt,qe=At.y-nt,Ie=At.y+nt;return!(Ee<Ft||Le>Ue||ct<qe||He>Ie)};return be.filter(At=>!ft(At))}),gr||st(be=>{const ye=te/2,Le=ge-ye,Ee=ge+ye,He=Se-ye,ct=Se+ye,ft=nt=>{const Ft=Math.max(6,(nt.size||18)/2),Ue=Ft*.8,qe=Ft+Ue,Ie=nt.x-qe,Xe=nt.x+qe,Ye=nt.y-qe,dt=nt.y+qe;return!(Ee<Ie||Le>Xe||ct<Ye||He>dt)};return be.filter(nt=>!ft(nt))}),!Hs)){const be=te/2,ye=ge-be,Le=ge+be,Ee=Se-be,He=Se+be,ct=ft=>{const nt=(ft.size||18)/2,Ft=ft.x-nt,Ue=ft.x+nt,qe=ft.y-nt,Ie=ft.y+nt;return!(Le<Ft||ye>Ue||He<qe||Ee>Ie)};pn(pt,Ut,Zt,we,Fe),Pi(ft=>ft.filter(At=>!ct(At))),Yn(ft=>ft.filter(At=>!ct(At)))}}else if(Ks&&Br&&Qt){if(ji){zr(!1),en(null);return}const be=ge-Br.x,ye=Se-Br.y;if(Qt==="top"){t&&n(Le=>Le?{...Le,x:Le.x+be,y:Le.y+ye}:null),en({x:ge,y:Se});return}if(Qt==="bottom"){s&&o(Le=>Le?{...Le,x:Le.x+be,y:Le.y+ye}:null),en({x:ge,y:Se});return}if(Qt==="both"){t&&n(Le=>Le?{...Le,x:Le.x+be,y:Le.y+ye}:null),s&&o(Le=>Le?{...Le,x:Le.x+be,y:Le.y+ye}:null),en({x:ge,y:Se});return}}},[Fn,zn,k,te,Ks,Br,Qt,t,s,pa,Yu,Xt,jt,Ct,es.x,es.y,ti,Ji,Hc,hd,ji,Ei,as,pr,li,gr,Ut,Zt,Pi,Yn,Oa,Cc,Vo,pt,Dn,y,zn,lt,dn,An,pl,Fo,Po,5,es,Xc,is,N,ar,pn,we,Fe,Bo]),jh=X.useCallback(()=>{if(Bo(null),kc.current&&wo.current&&Ps.current&&rc.current){const p=wo.current,C=Ps.current,L=Math.abs(p.end.x-p.start.x),Y=Math.abs(p.end.y-p.start.y);if(L>=1&&Y>=1)try{const le=UT({numPins:C.numPins,type:C.type,twoSidedOrientation:C.twoSidedOrientation,point1:p.start,point2:p.end}),he=new Set(pt.flatMap(pe=>pe.points.map(je=>je.id||0).filter(je=>je>0))),U=he.size>0?Math.max(...Array.from(he))+1:1,Ae=le.map((pe,je)=>{const Ne=gl.current?(xi||"top")==="top"?"padTop":"padBottom":"via",ke=Mn.get(Ne),ge=U+je,Se=gl.current&&xi||"top";return{id:ge.toString(),type:gl.current?"pad":"via",points:[{x:pe.x,y:pe.y,id:ge}],size:ke.size,color:ke.color,layer:Se}});jt(pe=>{const je=[...pe,...Ae];return pn(je,Ut,Zt,we,Fe),je})}catch(le){console.error("IC Placement error:",le),alert(`Error placing ${gl.current?"pads":"vias"}: ${le instanceof Error?le.message:String(le)}`)}xh(!1),Dd(null),Rd(null),Dr(!1),kc.current=!1,wo.current=null,Ps.current=null,rc.current=!1,ya(void 0),N("select");return}if(k==="select"&&Hc){const p=jc,C=hd;if(xa(!1),Tf(null),$u(null),p&&C){const le=Math.max(3,5/Ct),he=p.width<le&&p.height<le,U=(Ue,qe)=>{const Ie=p.x,Xe=p.y,Ye=p.x+p.width,dt=p.y+p.height;return Ue>=Ie&&Ue<=Ye&&qe>=Xe&&qe<=dt},Ae=(Ue,qe,Ie,Xe,Ye,dt,Pt,Jt)=>{const Et=(Zn,Go)=>{let yl=0;return Zn<Ye?yl|=1:Zn>Pt&&(yl|=2),Go<dt?yl|=4:Go>Jt&&(yl|=8),yl};let un=Ue,cs=qe,Bi=Ie,ds=Xe,tr=Et(un,cs),Yi=Et(Bi,ds);for(;;){if((tr|Yi)===0)return!0;if((tr&Yi)!==0)return!1;const Zn=tr!==0?tr:Yi;let Go=0,yl=0;Zn&8?(Go=un+(Bi-un)*(Jt-cs)/(ds-cs),yl=Jt):Zn&4?(Go=un+(Bi-un)*(dt-cs)/(ds-cs),yl=dt):Zn&2?(yl=cs+(ds-cs)*(Pt-un)/(Bi-un),Go=Pt):(yl=cs+(ds-cs)*(Ye-un)/(Bi-un),Go=Ye),Zn===tr?(un=Go,cs=yl,tr=Et(un,cs)):(Bi=Go,ds=yl,Yi=Et(Bi,ds))}},pe=p.x,je=p.y,Ne=p.x+p.width,ke=p.y+p.height,Se=Math.max(6/Ct,4/Ct,.5),be=(Ue,qe,Ie,Xe,Ye,dt)=>{const Pt=Ye-Ie,Jt=dt-Xe;if(Pt===0&&Jt===0)return Math.hypot(Ue-Ie,qe-Xe);const Nn=Math.max(0,Math.min(1,((Ue-Ie)*Pt+(qe-Xe)*Jt)/(Pt*Pt+Jt*Jt))),kn=Ie+Nn*Pt,On=Xe+Nn*Jt;return Math.hypot(Ue-kn,qe-On)},ye=C?.shiftKey===!0,Le=new Set(ye?Array.from(ni):[]),Ee=new Set(ye?Array.from(an):[]),He=new Set(ye?Array.from(ai):[]),ct=new Set(ye?Array.from(oi):[]),ft=C?.hitStrokeId;if(ft){const Ue=pt.find(qe=>qe.id===ft);if(Ue){let qe=!1;if(Ue.type==="via"||Ue.type==="pad"?qe=lr:qe=Ue.layer==="top"?Ns:ys,qe){ye?Tn(Ie=>{const Xe=new Set(Ie);return Xe.has(ft)?Xe.delete(ft):Xe.add(ft),Xe}):(Tn(new Set([ft])),_n(new Set),rn(new Set),mn(new Set));return}}}if(he){let Ue=null;for(const qe of pt){let Ie=!1;if(qe.type==="via"?Ie=lr:qe.type==="pad"?Ie=(qe.layer||"top")==="top"?cr:Gr:qe.type==="testPoint"?Ie=(qe.layer||"top")==="top"?fs:vo:qe.type==="trace"?Ie=qe.layer==="top"?Ns:ys:Ie=!1,!Ie)continue;let Xe=1/0;if(qe.type==="via"||qe.type==="pad"||qe.type==="testPoint"){const Ye=qe.points[0],dt=Math.max(1,qe.size/2);Xe=Math.hypot(Ye.x-C.x,Ye.y-C.y);const Jt=Math.max(6/Ct,4/Ct,.5);Xe<=Math.max(dt,Jt)&&(!Ue||Xe<Ue.dist)&&(Ue={id:qe.id,dist:Xe})}else for(let Ye=0;Ye<qe.points.length-1;Ye++){const dt=qe.points[Ye],Pt=qe.points[Ye+1],Jt=be(C.x,C.y,dt.x,dt.y,Pt.x,Pt.y);if(Jt<=Math.max(Se,qe.size/2)){(!Ue||Jt<Ue.dist)&&(Ue={id:qe.id,dist:Jt});break}}}Ue&&(ye&&Le.has(Ue.id)?Le.delete(Ue.id):Le.add(Ue.id))}else for(const Ue of pt){let qe=!1;if(Ue.type==="via"?qe=lr:Ue.type==="pad"?qe=(Ue.layer||"top")==="top"?cr:Gr:Ue.type==="testPoint"?qe=(Ue.layer||"top")==="top"?fs:vo:Ue.type==="trace"?qe=Ue.layer==="top"?Ns:ys:qe=!1,!qe)continue;let Ie=!1;if(Ue.type==="via"||Ue.type==="pad"||Ue.type==="testPoint"){const Xe=Ue.points[0];Ie=U(Xe.x,Xe.y)}else for(let Xe=0;Xe<Ue.points.length-1;Xe++){const Ye=Ue.points[Xe],dt=Ue.points[Xe+1];if(Ae(Ye.x,Ye.y,dt.x,dt.y,pe,je,Ne,ke)||U(Ye.x,Ye.y)&&U(dt.x,dt.y)){Ie=!0;break}}Ie&&(ye&&Le.has(Ue.id)?Le.delete(Ue.id):Le.add(Ue.id))}const At=Ue=>{const Ie=Math.max(10,Ue.size||18)/2;return Ue.x-Ie<=Ne&&Ue.x+Ie>=pe&&Ue.y-Ie<=ke&&Ue.y+Ie>=je};if(he){const Ue=qe=>{const Xe=Math.max(10,qe.size||18)/2;return C.x>=qe.x-Xe&&C.x<=qe.x+Xe&&C.y>=qe.y-Xe&&C.y<=qe.y+Xe};io&&Ut.forEach(qe=>{Ue(qe)&&(ye&&Ee.has(qe.id)?Ee.delete(qe.id):Ee.add(qe.id))}),Di&&Zt.forEach(qe=>{Ue(qe)&&(ye&&Ee.has(qe.id)?Ee.delete(qe.id):Ee.add(qe.id))})}else io&&Ut.forEach(Ue=>{At(Ue)&&(ye&&Ee.has(Ue.id)?Ee.delete(Ue.id):Ee.add(Ue.id))}),Di&&Zt.forEach(Ue=>{At(Ue)&&(ye&&Ee.has(Ue.id)?Ee.delete(Ue.id):Ee.add(Ue.id))});const nt=Ue=>{const qe=Math.max(6,Ue.size/2),Ie=qe*.8,Xe=qe+Ie;return Ue.x-Xe<=Ne&&Ue.x+Xe>=pe&&Ue.y-Xe<=ke&&Ue.y+Xe>=je};if(_a)if(he){let Ue=null;for(const qe of Dn){const Ie=Math.max(6,qe.size/2),Xe=Ie*.8,Ye=Ie+Xe,dt=Math.hypot(qe.x-C.x,qe.y-C.y),Pt=Math.abs(C.x-qe.x)<=Se&&Math.abs(C.y-qe.y)<=Ye,Jt=Math.abs(C.y-qe.y)<=Se&&Math.abs(C.x-qe.x)<=Ye;if(dt<=Math.max(Ie,Se)||Pt||Jt){const kn=Math.min(dt,Math.abs(C.x-qe.x)+Math.abs(C.y-qe.y));(!Ue||kn<Ue.dist)&&(Ue={id:qe.id,dist:kn})}}Ue&&(ye&&He.has(Ue.id)?He.delete(Ue.id):He.add(Ue.id))}else Dn.forEach(Ue=>{nt(Ue)&&(ye&&He.has(Ue.id)?He.delete(Ue.id):He.add(Ue.id))});const Ft=Ue=>{const qe=Math.max(6,(Ue.size||18)/2),Ie=qe*.8,Xe=qe+Ie;return Ue.x-Xe<=Ne&&Ue.x+Xe>=pe&&Ue.y-Xe<=ke&&Ue.y+Xe>=je};if(ri)if(he){let Ue=null;for(const qe of y){const Ie=Math.max(6,(qe.size||18)/2),Xe=Ie*.8,Ye=Ie+Xe,dt=Math.hypot(qe.x-C.x,qe.y-C.y),Pt=Math.abs(C.x-qe.x)<=Se&&Math.abs(C.y-qe.y)<=Ye,Jt=Math.abs(C.y-qe.y)<=Se&&Math.abs(C.x-qe.x)<=Ye;if(dt<=Math.max(Ie,Se)||Pt||Jt){const kn=Math.min(dt,Math.abs(C.x-qe.x)+Math.abs(C.y-qe.y));(!Ue||kn<Ue.dist)&&(Ue={id:qe.id,dist:kn})}}Ue&&(ye&&ct.has(Ue.id)?ct.delete(Ue.id):ct.add(Ue.id))}else y.forEach(Ue=>{Ft(Ue)&&(ye&&ct.has(Ue.id)?ct.delete(Ue.id):ct.add(Ue.id))});Tn(Le),_n(Ee),rn(He),mn(ct)}}if(Fn&&zn.length>0){if(k==="draw"&&lt!=="trace"){const p={id:Date.now().toString(),points:zn,color:B,size:te,layer:Xt,type:"trace"};jt(C=>[...C,p]),Xt==="top"?Ya(C=>[...C,p.id]):Nr(C=>[...C,p.id])}Pn([])}pl&&(Ac(!1),Fo.current=null,ec.current=null),tn(!1),zr(!1),en(null),qa(!1)},[Fn,zn,k,B,te,Xt,jc,hd,Hc,pt,Ct,Ba,ni,Dn,y,Ut,Zt,an,ai,oi,lr,Ns,ys,io,Di,_a,ri,Bo]);Tt.useEffect(()=>{if(!(k==="pan"&&pl&&ec.current))return;const p=L=>{const Y=rs.current;if(!Y)return;const le=Y.getBoundingClientRect(),he=Y.width/le.width,U=Y.height/le.height,{startClientX:Ae,startClientY:pe,objectStartPositions:je}=ec.current,Ne=(L.clientX-Ae)*he,ke=(L.clientY-pe)*U,ge=sx(Ne,ke,Ct,ti,Ji),Se=ge.x,be=ge.y;je&&(t&&n({...t,x:je.topImageX+Se,y:je.topImageY+be}),s&&o({...s,x:je.bottomImageX+Se,y:je.bottomImageY+be}),Pi(Ut.map(ye=>({...ye,x:(je.componentsTop?.[ye.id]?.x??ye.x)+Se,y:(je.componentsTop?.[ye.id]?.y??ye.y)+be}))),Yn(Zt.map(ye=>({...ye,x:(je.componentsBottom?.[ye.id]?.x??ye.x)+Se,y:(je.componentsBottom?.[ye.id]?.y??ye.y)+be}))),Re(we.map(ye=>({...ye,x:(je.powerSymbols?.[ye.id]?.x??ye.x)+Se,y:(je.powerSymbols?.[ye.id]?.y??ye.y)+be}))),st(Fe.map(ye=>({...ye,x:(je.groundSymbols?.[ye.id]?.x??ye.x)+Se,y:(je.groundSymbols?.[ye.id]?.y??ye.y)+be}))),jt(pt.map((ye,Le)=>({...ye,points:ye.points.map((Ee,He)=>{const ct=je.drawingStrokes?.[Le]?.points?.[He];return{...Ee,x:(ct?.x??Ee.x)+Se,y:(ct?.y??Ee.y)+be}})}))),Rt(na.map((ye,Le)=>{const Ee=je.vias?.[Le];return{...ye,x:(Ee?.x??ye.x)+Se,y:(Ee?.y??ye.y)+be}})),fr(Qi.map((ye,Le)=>{const Ee=je.pads?.[Le];return{...ye,x:(Ee?.x??ye.x)+Se,y:(Ee?.y??ye.y)+be}})))},C=()=>{Ac(!1),Fo.current=null,ec.current=null,window.removeEventListener("mousemove",p,!0),window.removeEventListener("mouseup",C,!0)};return window.addEventListener("mousemove",p,!0),window.addEventListener("mouseup",C,!0),()=>{window.removeEventListener("mousemove",p,!0),window.removeEventListener("mouseup",C,!0)}},[k,pl,Ct,ti,Ji,t,s,Ut,Zt,we,Fe,pt,na,Qi,n,o,Pi,Yn,Re,st,jt,Rt,fr]);const uu=X.useCallback(()=>{const p=rs.current;if(!p)return;const C=p.getContext("2d");if(!C)return;C.clearRect(0,0,p.width,p.height),C.fillStyle="#000000",C.fillRect(0,0,p.width,p.height),C.fillStyle="#ffffff",C.fillRect(5,5,p.width-10,p.height-10),C.save(),C.beginPath(),C.rect(5,5,p.width-10,p.height-10),C.clip(),C.translate(5,5);const L=(Ae,pe,je,Ne,ke,ge,Se,be)=>{const ye=document.createElement("canvas");ye.width=je,ye.height=Ne;const Le=ye.getContext("2d",{willReadFrequently:!0});Le.clearRect(0,0,je,Ne),Le.drawImage(pe,0,0,je,Ne);let Ee=ye;if(Math.abs(ke)>1e-6){const He=Yg(ke),ct=Math.max(.2,1-He),ft=Math.max(.2,1+He),At=Math.max(ct,ft),nt=Math.max(1,Math.ceil(je*At)),Ft=document.createElement("canvas");Ft.width=nt,Ft.height=Ne;const Ue=Ft.getContext("2d",{willReadFrequently:!0});Ue.clearRect(0,0,nt,Ne);for(let qe=0;qe<Ne;qe++){const Ie=Ne<=1?0:qe/(Ne-1),Xe=ct*(1-Ie)+ft*Ie,Ye=Math.max(1,je*Xe),dt=(nt-Ye)/2;Ue.drawImage(Ee,0,qe,je,1,dt,qe,Ye,1)}Ee=Ft}if(Math.abs(ge)>1e-6){const He=Yg(ge),ct=Math.max(.2,1-He),ft=Math.max(.2,1+He),At=Math.max(ct,ft),nt=Math.max(1,Math.ceil(Ne*At)),Ft=document.createElement("canvas");Ft.width=Ee.width,Ft.height=nt;const Ue=Ft.getContext("2d",{willReadFrequently:!0});Ue.clearRect(0,0,Ft.width,nt);for(let qe=0;qe<Ee.width;qe++){const Ie=Ee.width<=1?0:qe/(Ee.width-1),Xe=ct*(1-Ie)+ft*Ie,Ye=Math.max(1,Ne*Xe),dt=(nt-Ye)/2;Ue.drawImage(Ee,qe,0,1,Ee.height,qe,dt,1,Ye)}Ee=Ft}Ae.drawImage(Ee,-Se/2,-be/2,Se,be)};C.translate(es.x,es.y),C.scale(Ct,Ct),i5(C,ti,Ji);{const Ae=Ls&&Ml;if(t&&t.bitmap&&Ls){const pe=t.bitmap;C.save(),C.globalAlpha=1;const je=[];t.brightness!==void 0&&t.brightness!==100&&je.push(`brightness(${t.brightness}%)`),t.contrast!==void 0&&t.contrast!==100&&je.push(`contrast(${t.contrast}%)`),P&&je.push("grayscale(100%)"),C.filter=je.length>0?je.join(" "):"none",Fm(C,{x:t.x,y:t.y,rotation:t.rotation||0,scale:t.scale||1,flipX:t.flipX||!1,flipY:t.flipY||!1,skewX:t.skewX||0,skewY:t.skewY||0});const Ne=pe.width*1,ke=pe.height*1,ge=pe;t.keystoneV&&Math.abs(t.keystoneV)>1e-6||t.keystoneH&&Math.abs(t.keystoneH)>1e-6?L(C,ge,pe.width,pe.height,t.keystoneV||0,t.keystoneH||0,Ne,ke):C.drawImage(ge,-Ne/2,-ke/2,Ne,ke),C.restore()}if(s&&s.bitmap&&Ml){const pe=s.bitmap;C.save(),C.globalAlpha=Ae?h/100:1;const je=[];s.brightness!==void 0&&s.brightness!==100&&je.push(`brightness(${s.brightness}%)`),s.contrast!==void 0&&s.contrast!==100&&je.push(`contrast(${s.contrast}%)`),P&&je.push("grayscale(100%)"),C.filter=je.length>0?je.join(" "):"none",Fm(C,{x:s.x,y:s.y,rotation:s.rotation||0,scale:s.scale||1,flipX:s.flipX||!1,flipY:s.flipY||!1,skewX:s.skewX||0,skewY:s.skewY||0});const Ne=pe.width*1,ke=pe.height*1,ge=pe;s.keystoneV&&Math.abs(s.keystoneV)>1e-6||s.keystoneH&&Math.abs(s.keystoneH)>1e-6?L(C,ge,pe.width,pe.height,s.keystoneV||0,s.keystoneH||0,Ne,ke):C.drawImage(ge,-Ne/2,-ke/2,Ne,ke),C.restore()}}if(Bp(C),_a&&Dn.length>0){const Ae=pe=>{C.save(),ix(C,pe.x,pe.y,pe.rotation??0,pe.flipX??!1,!1);const je=yn.find(be=>be.id===pe.powerBusId),Ne=ai.has(pe.id),ke=je?.color||"#ff0000";C.strokeStyle=ke,C.lineWidth=Math.max(1,(Ne?3:2)/Math.max(Ct,.001)),C.lineCap="round";const ge=Math.max(6,pe.size/2),Se=ge*.8;if(Ne&&(C.strokeStyle="#0066ff",C.lineWidth=Math.max(1,4/Math.max(Ct,.001)),C.beginPath(),C.arc(0,0,ge+Se+3,0,Ha),C.stroke()),C.strokeStyle=ke,C.lineWidth=Math.max(1,(Ne?3:2)/Math.max(Ct,.001)),C.beginPath(),C.arc(0,0,ge,0,Ha),C.stroke(),C.beginPath(),C.moveTo(0,-ge-Se),C.lineTo(0,ge+Se),C.stroke(),C.beginPath(),C.moveTo(-ge-Se,0),C.lineTo(ge+Se,0),C.stroke(),je){C.fillStyle=ke;const be=Math.max(10,ge*.8);C.font=`${be}px sans-serif`,C.textAlign="center",C.textBaseline="top",C.fillText(je.name,0,ge+Se+8)}C.restore()};Dn.forEach(Ae)}if(ri&&y.length>0){const Ae=pe=>{C.save(),ix(C,pe.x,pe.y,pe.rotation??0,pe.flipX??!1,!1);const je=oi.has(pe.id),Ne=j.find(be=>be.id===pe.groundBusId),ke=Ne?.color||pe.color||"#000000",ge=pe.groundBusId==="groundbus-earth";let Se;if(ge){const be=Math.max(6,pe.size||18),ye=be*.9,Le=be*.24,Ee=be*1.6;C.strokeStyle=ke,C.lineWidth=Math.max(1,(je?3:2)/Math.max(Ct,.001)),C.lineCap="round",je&&(C.strokeStyle="#0066ff",C.lineWidth=Math.max(1,4/Math.max(Ct,.001)),C.setLineDash([5,5]),C.strokeRect(-Ee/2-3,-3,Ee+6,ye+Le*2+6),C.setLineDash([])),C.strokeStyle=ke,C.lineWidth=Math.max(1,(je?3:2)/Math.max(Ct,.001)),C.beginPath(),C.moveTo(0,0),C.lineTo(0,ye),C.stroke();for(let He=0;He<3;He++){const ct=ye+He*Le,ft=Ee*(1-He*.25);C.beginPath(),C.moveTo(-ft/2,ct),C.lineTo(ft/2,ct),C.stroke()}Se=ye+Le*2}else{const be=Math.max(6,(pe.size||18)/2),ye=be*.8;je&&(C.strokeStyle="#0066ff",C.lineWidth=Math.max(1,4/Math.max(Ct,.001)),C.beginPath(),C.arc(0,0,be+ye+3,0,Ha),C.stroke()),C.strokeStyle=ke,C.lineWidth=Math.max(1,(je?3:2)/Math.max(Ct,.001)),C.beginPath(),C.arc(0,0,be,0,Ha),C.stroke(),C.beginPath(),C.moveTo(0,-be-ye),C.lineTo(0,be+ye),C.stroke(),C.beginPath(),C.moveTo(-be-ye,0),C.lineTo(be+ye,0),C.stroke(),Se=be+ye}if(Ne){C.fillStyle=ke;const be=Math.max(10,(pe.size||18)*.5);C.font=`${be}px sans-serif`,C.textAlign="center",C.textBaseline="top",C.fillText(Ne.name,0,Se+8)}C.restore()};y.forEach(Ae)}const Y=Ae=>{const pe=Math.max(10,Ae.size||18),je=pe/2;C.save(),C.translate(Ae.x,Ae.y),s5(C,ti,Ji),Ae.orientation!==void 0&&Ae.orientation!==0&&C.rotate(Kd(Ae.orientation)),Ae.flipX&&C.scale(-1,1),Ae.flipY&&C.scale(1,-1),C.strokeStyle=Ae.color||"#111",C.lineWidth=Math.max(1,2/Math.max(Ct,.001));const Ne=Ae.pinConnections||[],ke=Ne.length>0&&Ne.length===Ae.pinCount&&Ne.every(be=>be&&be.trim()!=="");C.fillStyle=ke?"rgba(178, 223, 138, 0.85)":"rgba(255,255,255,0.85)",C.beginPath(),C.rect(-je,-je,pe,pe),C.fill(),C.stroke();const ge=Ae.designator?.trim()||"";if(ge){C.fillStyle=Ae.color||"#111";const be=Math.max(6,pe*.35),ye=pe*.9;let Le=be;C.font=`bold ${Le}px sans-serif`;const Ee=C.measureText(ge);Ee.width>ye&&(Le=ye/Ee.width*Le,Le=Math.max(6,Le),C.font=`bold ${Le}px sans-serif`),C.textAlign="center",C.textBaseline="middle",C.fillText(ge,0,0)}an.has(Ae.id)&&(C.setLineDash([4,3]),C.strokeStyle="#00bfff",C.lineWidth=1.5,C.strokeRect(-je-3,-je-3,pe+6,pe+6),C.setLineDash([])),C.restore()};if(Cs){const Ae=je=>{const Ne=parseInt(je,10);if(isNaN(Ne))return null;for(const ke of pt)if((ke.type==="via"||ke.type==="pad"||ke.type==="testPoint")&&ke.points.length>0){const ge=ke.points[0];if(ge.id===Ne)return{x:ge.x,y:ge.y}}for(const ke of pt)if(ke.type==="trace"){for(const ge of ke.points)if(ge.id===Ne)return{x:ge.x,y:ge.y}}for(const ke of Dn)if(ke.pointId===Ne)return{x:ke.x,y:ke.y};for(const ke of y)if(ke.pointId===Ne)return{x:ke.x,y:ke.y};return null},pe=je=>{const Ne=je.pinConnections||[],ke=Sp(je)&&je.pinPolarities,Se=_d(je)?.category==="Semiconductors",be=new Map;for(let ye=0;ye<Ne.length;ye++){const Le=Ne[ye];if(Le&&Le.trim()!==""){const Ee=Le.trim(),He=Se&&ye===0,ct=!!(ke&&je.pinPolarities&&ye<je.pinPolarities.length&&je.pinPolarities[ye]==="-"),ft=be.get(Ee);ft!==void 0?be.set(Ee,{isNegative:ft.isNegative||ct,hasPin1:ft.hasPin1||He}):be.set(Ee,{isNegative:ct,hasPin1:He})}}for(const[ye,Le]of be){const{isNegative:Ee,hasPin1:He}=Le,ct=Ae(ye);if(ct){const ft={x:je.x,y:je.y},At=parseInt(ye,10),nt=`${je.id}:${At}`,Ft=ut.has(nt);C.save(),Ft?(C.strokeStyle="#00bfff",C.lineWidth=Math.max(2,Ot*1.5/Math.max(Ct,.001)),C.setLineDash([4,3])):(Ee?C.strokeStyle="rgba(0, 0, 0, 0.8)":He?C.strokeStyle=r5(vt,.4):C.strokeStyle=vt,C.lineWidth=Math.max(1,Ot/Math.max(Ct,.001))),C.beginPath(),C.moveTo(ft.x,ft.y),C.lineTo(ct.x,ct.y),C.stroke(),C.setLineDash([]),C.restore()}}};io&&Ut.forEach(pe),Di&&Zt.forEach(pe)}if(io&&Ut.forEach(Y),Di&&Zt.forEach(Y),qo&&_c){C.save();const Ae=_c.start,pe=_c.end,je=Math.min(Ae.x,pe.x),Ne=Math.min(Ae.y,pe.y),ke=Math.max(Ae.x,pe.x),ge=Math.max(Ae.y,pe.y),Se=ke-je,be=ge-Ne,ye=Math.max(2,6/Math.max(1e-4,Ct));C.strokeStyle="#ff8800",C.fillStyle="rgba(255, 136, 0, 0.2)",C.lineWidth=Math.max(1,2/Math.max(1e-4,Ct)),C.setLineDash([ye,ye]),C.beginPath(),C.rect(je,Ne,Se,be),C.fill(),C.stroke(),C.fillStyle="#ff8800",C.beginPath(),C.arc(Ae.x,Ae.y,Math.max(3,6/Math.max(1e-4,Ct)),0,Math.PI*2),C.fill(),C.setLineDash([]),C.restore()}if(k==="select"&&jc){C.save();const Ae=Math.max(2,6/Math.max(1e-4,Ct));C.strokeStyle="#00bfff",C.fillStyle="rgba(0, 191, 255, 0.15)",C.lineWidth=Math.max(1,1.5/Math.max(1e-4,Ct)),C.setLineDash([Ae,Ae]),C.beginPath(),C.rect(jc.x,jc.y,jc.width,jc.height),C.fill(),C.stroke(),C.setLineDash([]),C.restore()}C.save();const le=50,U=2/Ct;C.strokeStyle="#FF0000",C.lineWidth=U,C.lineCap="round",C.lineJoin="round",C.beginPath(),C.moveTo(-le,0),C.lineTo(le,0),C.stroke(),C.fillStyle="#FF0000",C.font=`${12/Ct}px sans-serif`,C.textAlign="left",C.textBaseline="top",C.fillText("+X",le+2/Ct,2/Ct),C.textAlign="right",C.fillText("-X",-le-2/Ct,2/Ct),C.strokeStyle="#0000FF",C.lineWidth=U,C.lineCap="round",C.lineJoin="round",C.beginPath(),C.moveTo(0,-le),C.lineTo(0,le),C.stroke(),C.fillStyle="#0000FF",C.font=`${12/Ct}px sans-serif`,C.textAlign="left",C.textBaseline="top",C.fillText("+Y",2/Ct,le+2/Ct),C.textBaseline="bottom",C.fillText("-Y",2/Ct,-le-2/Ct),C.restore(),C.restore()},[t,s,h,pt,zn,Fn,k,B,te,P,Qt,Xt,Ct,es.x,es.y,ti,Ji,Ls,Ml,lr,Ns,ys,cr,Gr,fs,vo,io,Di,Ut,Zt,_a,Dn,ri,y,Cs,jc,ni,an,ai,oi,ut,Gn,H,M,R,se,lt,dn,ji,vt,Ot,Ms,Ti,qo,_c]);Tt.useEffect(()=>{const p=()=>{const C=qc.current;if(!C)return;const L=1.6,Y=244,le=12,he=6,U=12,Ae=C.clientWidth-Y-le,pe=C.getBoundingClientRect(),je=window.innerHeight,Ne=pe.top,ge=je-Ne-he-10,Se=Math.min(C.clientHeight-U,ge),be=Math.floor(Se*L),ye=Math.floor(Ae/L);let Le,Ee;be<=Ae?(Le=be,Ee=Se):(Le=Ae,Ee=ye),Le=Math.max(600,Le),Ee=Math.max(375,Ee),Ee=Math.max(355,Ee-20),sa(He=>{const ct=He.width===0&&He.height===0,ft=He.width!==Le||He.height!==Ee;return ct&&ft&&setTimeout(()=>{Si({x:0,y:0})},0),He.width===Le&&He.height===Ee?He:{width:Le,height:Ee}})};return p(),window.addEventListener("resize",p),()=>window.removeEventListener("resize",p)},[Po,Si]),Tt.useEffect(()=>{ji&&(Ks&&(zr(!1),en(null)),Cr(null))},[ji,Ks,zr,en,Cr]);const Bp=X.useCallback(p=>{if(pt.forEach(C=>{if(C.type==="via"||C.type==="pad"||C.type==="testPoint"||C.testPointType!==void 0||C.type!=="trace")return;let L=!1;if(C.layer==="top"?L=Ns:C.layer==="bottom"&&(L=ys),!!L){if(C.points.length===1){const Y=C.points[0],le=Math.max(.5,C.size/2);ni.has(C.id)&&(p.strokeStyle="#00bfff",p.lineWidth=2,p.setLineDash([4,3]),p.beginPath(),p.arc(Y.x,Y.y,le+3,0,Ha),p.stroke(),p.setLineDash([])),p.fillStyle=C.color,p.beginPath(),p.arc(Y.x,Y.y,le,0,Ha),p.fill()}else if(ni.has(C.id)&&(p.strokeStyle="#00bfff",p.lineWidth=C.size+4,p.lineCap="round",p.lineJoin="round",p.globalAlpha=.6,p.beginPath(),C.points.forEach((Y,le)=>{le===0?p.moveTo(Y.x,Y.y):p.lineTo(Y.x,Y.y)}),p.stroke(),p.globalAlpha=1),p.strokeStyle=C.color,p.lineWidth=C.size,p.lineCap="round",p.lineJoin="round",p.globalAlpha=1,p.beginPath(),C.points.forEach((Y,le)=>{le===0?p.moveTo(Y.x,Y.y):p.lineTo(Y.x,Y.y)}),p.stroke(),Ms){p.fillStyle="#000000";for(const Y of C.points)p.beginPath(),p.arc(Y.x,Y.y,C.size/2,0,Ha),p.fill()}}}),pt.forEach(C=>{if(C.type==="via"){if(!lr)return}else if(C.type==="pad"){const Y=C.layer||"top";if(Y==="top"&&!cr||Y==="bottom"&&!Gr)return}else if(C.type==="testPoint"){const Y=C.layer||"top";if(Y==="top"&&!fs||Y==="bottom"&&!vo)return}else return;const L=C.points[0];if(ni.has(C.id)){if(C.type==="via"){const Y=Math.max(.5,C.size/2)+3;p.strokeStyle="#00bfff",p.lineWidth=2,p.setLineDash([4,3]),p.beginPath(),p.arc(L.x,L.y,Y,0,Ha),p.stroke(),p.setLineDash([])}else if(C.type==="pad"){const Y=Math.max(.5,C.size/2)+3;p.strokeStyle="#00bfff",p.lineWidth=2,p.setLineDash([4,3]),p.strokeRect(L.x-Y,L.y-Y,C.size+6,C.size+6),p.setLineDash([])}else if(C.type==="testPoint"){const Y=Math.max(.5,C.size/2)+3;p.strokeStyle="#00bfff",p.lineWidth=2,p.setLineDash([4,3]),p.beginPath(),p.moveTo(L.x,L.y-Y),p.lineTo(L.x+Y,L.y),p.lineTo(L.x,L.y+Y),p.lineTo(L.x-Y,L.y),p.closePath(),p.stroke(),p.setLineDash([])}}if(C.type==="via"){const Y=Math.max(.5,C.size/2),le=Y*.5,he=Y*.7;p.fillStyle=C.color,p.beginPath(),p.arc(L.x,L.y,Y,0,Ha),p.arc(L.x,L.y,le,0,Ha),p.fill("evenodd"),p.strokeStyle="#808080",p.lineWidth=1,p.beginPath(),p.moveTo(L.x-he,L.y),p.lineTo(L.x+he,L.y),p.stroke(),p.beginPath(),p.moveTo(L.x,L.y-he),p.lineTo(L.x,L.y+he),p.stroke()}else if(C.type==="pad"){const Y=Math.max(.5,C.size/2),le=C.size,he=le*.5,U=Y*.7;p.fillStyle=C.color,p.beginPath(),p.rect(L.x-Y,L.y-Y,le,le),p.rect(L.x-he/2,L.y-he/2,he,he),p.fill("evenodd"),p.strokeStyle="#808080",p.lineWidth=1,p.beginPath(),p.moveTo(L.x-U,L.y),p.lineTo(L.x+U,L.y),p.stroke(),p.beginPath(),p.moveTo(L.x,L.y-U),p.lineTo(L.x,L.y+U),p.stroke()}else if(C.type==="testPoint"){const Y=Math.max(.5,C.size/2),le=Y*.7;p.fillStyle=C.color||"#FFFF00",p.strokeStyle="#000000",p.lineWidth=2,p.beginPath(),p.moveTo(L.x,L.y-Y),p.lineTo(L.x+Y,L.y),p.lineTo(L.x,L.y+Y),p.lineTo(L.x-Y,L.y),p.closePath(),p.fill(),p.stroke(),p.strokeStyle="#808080",p.lineWidth=1,p.beginPath(),p.moveTo(L.x-le,L.y),p.lineTo(L.x+le,L.y),p.stroke(),p.beginPath(),p.moveTo(L.x,L.y-le),p.lineTo(L.x,L.y+le),p.stroke()}}),zn.length>0){const C=Xt;let L=!0;if(k==="draw"&&(lt==="via"?L=lr:L=C==="top"?Ns:ys),L)if(k==="draw")if(lt==="via"){const Y=zn[zn.length-1],le=Math.max(.5,te/2),he=le*.5,U=le*.7;p.fillStyle=B,p.beginPath(),p.arc(Y.x,Y.y,le,0,Ha),p.arc(Y.x,Y.y,he,0,Ha),p.fill("evenodd"),p.strokeStyle="#808080",p.lineWidth=1,p.beginPath(),p.moveTo(Y.x-U,Y.y),p.lineTo(Y.x+U,Y.y),p.stroke(),p.beginPath(),p.moveTo(Y.x,Y.y-U),p.lineTo(Y.x,Y.y+U),p.stroke()}else if(lt==="pad"){const Y=zn[zn.length-1],le=Math.max(.5,te/2),he=te,U=he*.5,Ae=le*.7;p.fillStyle=B,p.beginPath(),p.rect(Y.x-le,Y.y-le,he,he),p.rect(Y.x-U/2,Y.y-U/2,U,U),p.fill("evenodd"),p.strokeStyle="#808080",p.lineWidth=1,p.beginPath(),p.moveTo(Y.x-Ae,Y.y),p.lineTo(Y.x+Ae,Y.y),p.stroke(),p.beginPath(),p.moveTo(Y.x,Y.y-Ae),p.lineTo(Y.x,Y.y+Ae),p.stroke()}else if(lt==="testPoint"){const Y=zn[zn.length-1],le=Math.max(.5,te/2),he=le*.7;p.fillStyle=B,p.beginPath(),p.moveTo(Y.x,Y.y-le),p.lineTo(Y.x+le,Y.y),p.lineTo(Y.x,Y.y+le),p.lineTo(Y.x-le,Y.y),p.closePath(),p.fill(),p.strokeStyle="#808080",p.lineWidth=1,p.beginPath(),p.moveTo(Y.x-he,Y.y),p.lineTo(Y.x+he,Y.y),p.stroke(),p.beginPath(),p.moveTo(Y.x,Y.y-he),p.lineTo(Y.x,Y.y+he),p.stroke()}else{const Y=Gn||"top",le=Y==="top"?H:M,he=Y==="top"?R:se;if(zn.length===1){const U=zn[0],Ae=Math.max(.5,he/2);p.fillStyle=le,p.beginPath(),p.arc(U.x,U.y,Ae,0,Ha),p.fill(),dn&&(p.strokeStyle=le,p.lineWidth=he,p.lineCap="round",p.lineJoin="round",p.globalAlpha=.6,p.beginPath(),p.moveTo(U.x,U.y),p.lineTo(dn.x,dn.y),p.stroke(),p.globalAlpha=1)}else if(p.strokeStyle=le,p.lineWidth=he,p.lineCap="round",p.lineJoin="round",p.globalAlpha=1,p.beginPath(),zn.forEach((U,Ae)=>{Ae===0?p.moveTo(U.x,U.y):p.lineTo(U.x,U.y)}),p.stroke(),dn&&zn.length>0){const U=zn[zn.length-1];p.globalAlpha=.6,p.beginPath(),p.moveTo(U.x,U.y),p.lineTo(dn.x,dn.y),p.stroke(),p.globalAlpha=1}}else k==="erase"&&(p.strokeStyle="rgba(255, 0, 0, 0.5)",p.lineWidth=te,p.lineCap="round",p.lineJoin="round",p.globalAlpha=.5,p.beginPath(),zn.forEach((Y,le)=>{le===0?p.moveTo(Y.x,Y.y):p.lineTo(Y.x,Y.y)}),p.stroke())}},[pt,ni,Ns,ys,lr,cr,Gr,fs,vo,zn,k,lt,B,te,Xt,Gn,H,M,R,se,dn,Ms]),Nf=X.useCallback((p,C)=>{if(ji){alert("Cannot transform: Images are locked. Unlock images to transform them.");return}p==="top"&&t?n(L=>L?{...L,...C}:null):p==="bottom"&&s?o(L=>L?{...L,...C}:null):p==="both"&&(t&&n(L=>L?{...L,...C}:null),s&&o(L=>L?{...L,...C}:null))},[t,s,ji]),Ph=X.useCallback(()=>{Qt&&(Nf(Qt,{x:0,y:0,scale:1,rotation:0,flipX:!1,flipY:!1,skewX:0,skewY:0,keystoneV:0,keystoneH:0,brightness:100,contrast:100}),x(!1))},[Nf,Qt]),br=X.useCallback((p=1)=>{if(ni.size>0||an.size>0||ai.size>0||oi.size>0){if(ni.size>0){const C=pt.filter(he=>ni.has(he.id)),L=Ei&&C.some(he=>he.type==="via"),Y=pr&&C.some(he=>he.type==="trace"),le=as&&C.some(he=>he.type==="pad");if(L){alert("Cannot change size: Vias are locked. Unlock vias to change their size.");return}if(Y){alert("Cannot change size: Traces are locked. Unlock traces to change their size.");return}if(le){alert("Cannot change size: Pads are locked. Unlock pads to change their size.");return}}if(an.size>0&&Hs){alert("Cannot change size: Components are locked. Unlock components to change their size.");return}if(ai.size>0&&li){alert("Cannot change size: Power nodes are locked. Unlock power nodes to change their size.");return}if(oi.size>0&&gr){alert("Cannot change size: Ground nodes are locked. Unlock ground nodes to change their size.");return}if(jt(C=>C.map(L=>{if(ni.has(L.id)){const Y=L.size+p;return L.type==="via"?kt("via",Y):L.type==="pad"?kt("pad",Y):L.type==="trace"&&kt("trace",Y,L.layer),{...L,size:Y}}return L})),an.size>0){const C=(an.size>0&&Ut.find(L=>an.has(L.id))?.size||18)+p;kt("component",C),Pi(L=>L.map(Y=>an.has(Y.id)?{...Y,size:(Y.size||18)+p}:Y)),Yn(L=>L.map(Y=>an.has(Y.id)?{...Y,size:(Y.size||18)+p}:Y))}if(ai.size>0){const C=(Dn.find(L=>ai.has(L.id))?.size||18)+p;kt("power",C),Re(L=>L.map(Y=>ai.has(Y.id)?{...Y,size:Y.size+p}:Y))}if(oi.size>0){const C=(y.find(L=>oi.has(L.id))?.size||18)+p;kt("ground",C),st(L=>L.map(Y=>oi.has(Y.id)?{...Y,size:(Y.size||18)+p}:Y))}}else{let C=null;if(k==="draw"&&lt==="via"?C="via":k==="draw"&&lt==="pad"?C=el.current==="bottom"?"padBottom":"padTop":k==="draw"&&lt==="testPoint"?C=tl.current==="bottom"?"testPointBottom":"testPointTop":k==="draw"&&lt==="trace"?C=Pa.current==="bottom"?"traceBottom":"traceTop":k==="component"?C=$a.current==="bottom"?"componentBottom":"componentTop":k==="power"?C="power":k==="ground"&&(C="ground"),C){const L=Mn.get(C),Y=Math.min(40,L.size+p);Mn.setSize(C,Y)}}},[ni,an,ai,oi,pt,Ei,pr,as,jr,Hs,li,gr,k,lt,kt]),oa=X.useCallback((p=1)=>{if(ni.size>0||an.size>0||ai.size>0||oi.size>0){if(ni.size>0){const C=pt.filter(U=>ni.has(U.id)),L=Ei&&C.some(U=>U.type==="via"),Y=pr&&C.some(U=>U.type==="trace"),le=as&&C.some(U=>U.type==="pad"),he=jr&&C.some(U=>U.type==="testPoint");if(L){alert("Cannot change size: Vias are locked. Unlock vias to change their size.");return}if(Y){alert("Cannot change size: Traces are locked. Unlock traces to change their size.");return}if(le){alert("Cannot change size: Pads are locked. Unlock pads to change their size.");return}if(he){alert("Cannot change size: Test Points are locked. Unlock test points to change their size.");return}}if(an.size>0&&Hs){alert("Cannot change size: Components are locked. Unlock components to change their size.");return}if(ai.size>0&&li){alert("Cannot change size: Power nodes are locked. Unlock power nodes to change their size.");return}if(oi.size>0&&gr){alert("Cannot change size: Ground nodes are locked. Unlock ground nodes to change their size.");return}if(jt(C=>C.map(L=>{if(ni.has(L.id)){const Y=Math.max(1,L.size-p);return L.type==="via"?kt("via",Y):L.type==="pad"?kt("pad",Y,L.layer):L.type==="testPoint"?kt("testPoint",Y,L.layer):L.type==="trace"&&kt("trace",Y,L.layer),{...L,size:Y}}return L})),an.size>0){const C=Math.max(12,(an.size>0&&Ut.find(L=>an.has(L.id))?.size||18)-p);kt("component",C),Pi(L=>L.map(Y=>an.has(Y.id)?{...Y,size:Math.max(12,(Y.size||18)-p)}:Y)),Yn(L=>L.map(Y=>an.has(Y.id)?{...Y,size:Math.max(12,(Y.size||18)-p)}:Y))}if(ai.size>0){const C=Math.max(12,(Dn.find(L=>ai.has(L.id))?.size||18)-p);kt("power",C),Re(L=>L.map(Y=>ai.has(Y.id)?{...Y,size:Math.max(12,Y.size-p)}:Y))}if(oi.size>0){const C=Math.max(12,(y.find(L=>oi.has(L.id))?.size||18)-p);kt("ground",C),st(L=>L.map(Y=>oi.has(Y.id)?{...Y,size:Math.max(12,(Y.size||18)-p)}:Y))}}else{let C=null;if(k==="draw"&&lt==="via"?C="via":k==="draw"&&lt==="pad"?C=(Xt||xi||"top")==="bottom"?"padBottom":"padTop":k==="draw"&&lt==="testPoint"?C=(Xt||Rn||"top")==="bottom"?"testPointBottom":"testPointTop":k==="draw"&&lt==="trace"?C=(Xt||Gn||"top")==="bottom"?"traceBottom":"traceTop":k==="component"?C=(Xt||gi||"top")==="bottom"?"componentBottom":"componentTop":k==="power"?C="power":k==="ground"&&(C="ground"),C){const L=Mn.get(C),Y=Math.max(1,L.size-p);Mn.setSize(C,Y)}}},[ni,an,ai,oi,pt,Ei,pr,as,jr,Hs,li,gr,k,lt,Xt,xi,Rn,Gn,gi,kt]),Op=X.useCallback(()=>{const p=Hr.size;if(ni.size>0||an.size>0||ai.size>0||oi.size>0){if(ni.size>0){const C=pt.filter(U=>ni.has(U.id)),L=Ei&&C.some(U=>U.type==="via"),Y=as&&C.some(U=>U.type==="pad"),le=pr&&C.some(U=>U.type==="trace"),he=jr&&C.some(U=>U.type==="testPoint");if(L||Y||le||he){alert("Cannot change size: selected items are locked.");return}}if(an.size>0&&Hs){alert("Cannot change size: selected components are locked.");return}if(ai.size>0&&li){alert("Cannot change size: selected power nodes are locked.");return}if(oi.size>0&&gr){alert("Cannot change size: selected ground nodes are locked.");return}jt(C=>C.map(L=>ni.has(L.id)?(L.type==="via"?(kt("via",p),Un(Y=>{const le=new Map(Y),he=le.get("via");return he&&le.set("via",{...he,settings:{...he.settings,size:p}}),le})):L.type==="pad"?(kt("pad",p,L.layer),Un(Y=>{const le=new Map(Y),he=le.get("pad");if(he){const U=new Map(he.layerSettings);U.set(L.layer,{...U.get(L.layer)||{color:he.settings.color,size:p},size:p}),le.set("pad",{...he,layerSettings:U})}return le})):L.type==="testPoint"?(kt("testPoint",p,L.layer),Un(Y=>{const le=new Map(Y),he=le.get("testPoint");if(he){const U=new Map(he.layerSettings);U.set(L.layer,{...U.get(L.layer)||{color:he.settings.color,size:p},size:p}),le.set("testPoint",{...he,layerSettings:U})}return le})):L.type==="trace"&&kt("trace",p,L.layer),{...L,size:p}):L)),an.size>0&&(kt("component",p),Pi(C=>C.map(L=>an.has(L.id)?{...L,size:p}:L)),Yn(C=>C.map(L=>an.has(L.id)?{...L,size:p}:L))),ai.size>0&&(kt("power",p),Re(C=>C.map(L=>ai.has(L.id)?{...L,size:p}:L))),oi.size>0&&(kt("ground",p),st(C=>C.map(L=>oi.has(L.id)?{...L,size:p}:L)))}else F(p),k==="draw"&&lt==="trace"?Xt==="top"?(Z(p),kt("trace",p,"top")):(V(p),kt("trace",p,"bottom")):k==="draw"&&lt==="via"?kt("via",p):k==="draw"&&lt==="pad"?kt("pad",p,Xt):k==="draw"&&lt==="testPoint"?kt("testPoint",p,Xt):kt(k==="component"?"component":k==="power"?"power":k==="ground"?"ground":"brush",p);Do({visible:!1,size:6})},[Hr.size,ni,an,ai,oi,pt,Ei,pr,Hs,li,gr,k,lt,Xt,kt,Hn,Un]),Fp=X.useCallback(()=>{nr({visible:!1,source:null,interval:5})},[]),jf=X.useCallback(async(p,C=!1)=>{if(p===null){Ca(!1),hl(null),Fi.current&&(clearInterval(Fi.current),Fi.current=null),Lo({visible:!1,interval:5}),C&&nr({visible:!1,source:null,interval:5}),console.log("Auto save: Disabled");return}if(!Vs){alert("Please create a new project (File -> New Project) or open an existing project (File -> Open Project) first.");return}let L=ki;if(!L){const U=window;if(typeof U.showDirectoryPicker=="function")try{L=await U.showDirectoryPicker(),qs(L)}catch(Ae){Ae?.name!=="AbortError"&&(console.error("Failed to get directory:",Ae),alert("Failed to select project directory."));return}else{alert("Directory picker is not supported in this browser. Auto-save requires a directory handle.");return}}Jl(L);const Y=Vs.replace(/\.json$/i,""),he=Qu(Y).replace(/[^a-zA-Z0-9_-]/g,"_");no(he),Ul.current=L,uc.current=he,hl(p),Ca(!0),ls.current=!0,Lo({visible:!1,interval:5}),C&&nr({visible:!1,source:null,interval:5}),setTimeout(()=>{console.log(`Auto save: Enabled with interval ${p} minutes`),rd.current&&rd.current()},200)},[Vs,ki,Ca,hl,Jl,no,Lo,nr,qs]),hu=X.useCallback(()=>{Je(),N("select")},[Je]),Bd=X.useCallback(p=>{if(p.key==="Escape"){const U=document.activeElement;if(U&&(U.tagName==="INPUT"&&U.type==="checkbox"||U.tagName==="INPUT"&&U.type==="radio")){U.blur(),p.preventDefault(),p.stopPropagation();return}}const C=document.activeElement;if(C&&(C.tagName==="INPUT"&&C.type!=="checkbox"&&C.type!=="radio"||C.tagName==="TEXTAREA"||C.isContentEditable))return;const L=Ud.current>0;if(L&&p.key!=="m"&&p.key!=="M")return;const Y=parseInt(p.key);if(!isNaN(Y)&&Y>=0&&Y<=9){if(p.preventDefault(),p.stopPropagation(),k==="center"&&ad){if(Js.current&&(clearTimeout(Js.current),Js.current=null),rs.current){let pe=0,je=0;t?(pe=t.x,je=t.y):s&&(pe=s.x,je=s.y),Rl(Ne=>({...Ne,[Y]:{pcbReferenceX:pe,pcbReferenceY:je,x:0,y:0,zoom:Ct,viewRotation:ti,viewFlipX:Ji,isBottomView:Sa,transparency:h,showTopImage:Ls,showBottomImage:Ml,showViasLayer:lr,showTopTracesLayer:Ns,showBottomTracesLayer:ys,showTopPadsLayer:cr,showBottomPadsLayer:Gr,showTopTestPointsLayer:fs,showBottomTestPointsLayer:vo,showTopComponents:io,showBottomComponents:Di,showPowerLayer:_a,showGroundLayer:ri,showConnectionsLayer:Cs}}))}ar(!1),N("select"),ya(void 0);return}const U=mo[Y];if(U){pi(U.zoom),vs(U.viewRotation??0),Ds(U.viewFlipX??!1),qr(U.isBottomView??!1),f(U.transparency??50);const Ae=U.pcbReferenceX??U.x??0,pe=U.pcbReferenceY??U.y??0;let je=0,Ne=0;t?(je=t.x,Ne=t.y):s&&(je=s.x,Ne=s.y);const ke=Ae-je,ge=pe-Ne;(Math.abs(ke)>.001||Math.abs(ge)>.001)&&(t&&n({...t,x:t.x+ke,y:t.y+ge}),s&&o({...s,x:s.x+ke,y:s.y+ge}),Pi(Ut.map(Se=>({...Se,x:Se.x+ke,y:Se.y+ge}))),Yn(Zt.map(Se=>({...Se,x:Se.x+ke,y:Se.y+ge}))),Re(we.map(Se=>({...Se,x:Se.x+ke,y:Se.y+ge}))),st(Fe.map(Se=>({...Se,x:Se.x+ke,y:Se.y+ge}))),jt(pt.map(Se=>({...Se,points:Se.points.map(be=>({...be,x:be.x+ke,y:be.y+ge}))}))),Rt(na.map(Se=>({...Se,x:Se.x+ke,y:Se.y+ge}))),fr(Qi.map(Se=>({...Se,x:Se.x+ke,y:Se.y+ge})))),Si({x:0,y:0}),or(U.showTopImage),mr(U.showBottomImage),Vr(U.showViasLayer),Wr(U.showTopTracesLayer),Ta(U.showBottomTracesLayer),$r(U.showTopPadsLayer),Yr(U.showBottomPadsLayer),Uo(U.showTopTestPointsLayer),sc(U.showBottomTestPointsLayer),Ho(U.showTopComponents),ra(U.showBottomComponents),Xr(U.showPowerLayer),Ui(U.showGroundLayer),Li(U.showConnectionsLayer)}return}if(p.key==="+"||p.key==="="){p.preventDefault(),p.stopPropagation(),br(p.shiftKey?5:1);return}if(p.key==="-"||p.key==="_"){p.preventDefault(),p.stopPropagation(),oa(p.shiftKey?5:1);return}const le=p.shiftKey||p.getModifierState("CapsLock"),he=k==="transform"&&Qt;if(p.key==="ArrowUp"||p.key==="ArrowDown"||p.key==="ArrowLeft"||p.key==="ArrowRight"){if(an.size>0){p.preventDefault(),p.stopPropagation();const U=p.shiftKey?10:1;let Ae=0,pe=0;p.key==="ArrowUp"?pe=-U:p.key==="ArrowDown"?pe=U:p.key==="ArrowLeft"?Ae=-U:p.key==="ArrowRight"&&(Ae=U);for(const je of an){const Ne=Ut.find(ke=>ke.id===je);if(Ne){const ke=Ne.x+Ae,ge=Ne.y+pe,Se=is({x:ke,y:ge});Pi(be=>be.map(ye=>ye.id===je?{...ye,x:Se.x,y:Se.y}:ye))}else{const ke=Zt.find(ge=>ge.id===je);if(ke){const ge=ke.x+Ae,Se=ke.y+pe,be=is({x:ge,y:Se});Yn(ye=>ye.map(Le=>Le.id===je?{...Le,x:be.x,y:be.y}:Le))}}}return}if(le&&!he&&an.size===0){if(p.key==="ArrowUp"||p.key==="ArrowDown"){p.preventDefault(),p.stopPropagation();const U=p.key==="ArrowUp"?-90:90;tu(U);return}else if(p.key==="ArrowLeft"||p.key==="ArrowRight"){p.preventDefault(),p.stopPropagation(),Ou();return}}}if((p.key==="I"||p.key==="i")&&!p.ctrlKey&&!p.shiftKey&&!p.altKey){const U=document.activeElement;if(!!U&&(U.tagName==="INPUT"&&U.type!=="range"&&U.type!=="checkbox"&&U.type!=="radio"||U.tagName==="TEXTAREA"||U.isContentEditable))return;p.preventDefault(),p.stopPropagation();const pe=[];ni.size>0,ni.size===0&&an.size===0&&ai.size===0&&oi.size===0&&pe.push(`
No objects selected.`);const je=pe.join(`
`);console.log(je),cl({visible:!0,text:je});return}if((p.key==="N"||p.key==="n")&&!p.ctrlKey&&!p.shiftKey&&!p.altKey){const U=document.activeElement;if(!!U&&(U.tagName==="INPUT"&&U.type!=="range"&&U.type!=="checkbox"&&U.type!=="radio"||U.tagName==="TEXTAREA"||U.isContentEditable))return;p.preventDefault(),p.stopPropagation(),mi(!0);return}if((p.key==="L"||p.key==="l")&&!p.ctrlKey&&!p.shiftKey&&!p.altKey){const U=document.activeElement;if(!!U&&(U.tagName==="INPUT"&&U.type!=="range"&&U.type!=="checkbox"&&U.type!=="radio"||U.tagName==="TEXTAREA"||U.isContentEditable))return;p.preventDefault(),p.stopPropagation(),Pf();return}if((p.key==="E"||p.key==="e")&&!p.ctrlKey&&!p.shiftKey&&!p.altKey){const U=document.activeElement;if(!!U&&(U.tagName==="INPUT"&&U.type!=="range"&&U.type!=="checkbox"&&U.type!=="radio"||U.tagName==="TEXTAREA"||U.isContentEditable))return;p.preventDefault(),p.stopPropagation(),It||zo(!0);return}if(p.key==="O"||p.key==="o"){const U=document.activeElement;if(!!U&&(U.tagName==="INPUT"&&U.type!=="range"&&U.type!=="checkbox"&&U.type!=="radio"||U.tagName==="TEXTAREA"||U.isContentEditable))return;p.preventDefault(),p.stopPropagation();const pe=mo[0];if(pe){pi(pe.zoom),vs(pe.viewRotation??0),Ds(pe.viewFlipX??!1),qr(pe.isBottomView??!1),f(pe.transparency??50);const je=pe.pcbReferenceX??pe.x??0,Ne=pe.pcbReferenceY??pe.y??0;let ke=0,ge=0;t?(ke=t.x,ge=t.y):s&&(ke=s.x,ge=s.y);const Se=je-ke,be=Ne-ge;(Math.abs(Se)>.001||Math.abs(be)>.001)&&(t&&n({...t,x:t.x+Se,y:t.y+be}),s&&o({...s,x:s.x+Se,y:s.y+be}),Pi(Ut.map(ye=>({...ye,x:ye.x+Se,y:ye.y+be}))),Yn(Zt.map(ye=>({...ye,x:ye.x+Se,y:ye.y+be}))),Re(we.map(ye=>({...ye,x:ye.x+Se,y:ye.y+be}))),st(Fe.map(ye=>({...ye,x:ye.x+Se,y:ye.y+be}))),jt(pt.map(ye=>({...ye,points:ye.points.map(Le=>({...Le,x:Le.x+Se,y:Le.y+be}))}))),Rt(na.map(ye=>({...ye,x:ye.x+Se,y:ye.y+be}))),fr(Qi.map(ye=>({...ye,x:ye.x+Se,y:ye.y+be})))),or(pe.showTopImage),mr(pe.showBottomImage),Vr(pe.showViasLayer),Wr(pe.showTopTracesLayer),Ta(pe.showBottomTracesLayer),$r(pe.showTopPadsLayer),Yr(pe.showBottomPadsLayer),Uo(pe.showTopTestPointsLayer),sc(pe.showBottomTestPointsLayer),Ho(pe.showTopComponents),ra(pe.showBottomComponents),Xr(pe.showPowerLayer),Ui(pe.showGroundLayer),Li(pe.showConnectionsLayer)}else pi(1),vs(0),Ds(!1),qr(!1),f(0);Si({x:0,y:0}),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),c("overlay"),Tn(new Set),_n(new Set),rn(new Set),mn(new Set),N("select");return}if((p.key==="Alt"||p.altKey)&&(Cf(!0),xo(!0)),p.key==="Escape"){p.preventDefault(),p.stopPropagation(),hu(),Id(!1),ru(!1),au(!1),ve(!1),La(!1),Lp(null);return}if(p.key==="Enter"&&k==="draw"&&lt==="trace"){Gu();return}if((p.key==="Delete"||p.key==="Backspace")&&(ni.size>0||an.size>0||ai.size>0||oi.size>0)){if(p.preventDefault(),p.stopPropagation(),pn(pt,Ut,Zt,we,Fe),ni.size>0){const U=pt.filter(ke=>ni.has(ke.id)),Ae=Ei&&U.some(ke=>ke.type==="via"),pe=pr&&U.some(ke=>ke.type==="trace"),je=as&&U.some(ke=>ke.type==="pad"),Ne=jr&&U.some(ke=>ke.type==="testPoint");Ae?alert("Cannot delete: Vias are locked. Unlock vias to delete them."):pe?alert("Cannot delete: Traces are locked. Unlock traces to delete them."):je?alert("Cannot delete: Pads are locked. Unlock pads to delete them."):Ne?alert("Cannot delete: Test points are locked. Unlock test points to delete them."):(jt(ke=>ke.filter(ge=>!ni.has(ge.id))),Tn(new Set))}an.size>0&&(Hs?alert("Cannot delete: Components are locked. Unlock components to delete them."):(Pi(U=>U.filter(Ae=>!an.has(Ae.id))),Yn(U=>U.filter(Ae=>!an.has(Ae.id))),_n(new Set))),ai.size>0&&(li?alert("Cannot delete: Power nodes are locked. Unlock power nodes to delete them."):(Re(U=>U.filter(Ae=>!ai.has(Ae.id))),rn(new Set))),oi.size>0&&(gr?alert("Cannot delete: Ground nodes are locked. Unlock ground nodes to delete them."):(st(U=>U.filter(Ae=>!oi.has(Ae.id))),mn(new Set)));return}if((p.key==="z"||p.key==="Z")&&(p.ctrlKey||p.metaKey)&&!p.shiftKey&&!p.altKey){const U=document.activeElement;if(!!U&&(U.tagName==="INPUT"&&U.type!=="range"&&U.type!=="checkbox"&&U.type!=="radio"||U.tagName==="TEXTAREA"||U.isContentEditable))return;p.preventDefault(),p.stopPropagation();const pe=Qn();if(pe){const je=new Set(pe.drawingStrokes.map(Se=>Se.id));for(const Se of pt)if(!je.has(Se.id))for(const be of Se.points)be.id&&typeof be.id=="number"&&bg(be.id);const Ne=new Set([...pe.componentsTop.map(Se=>Se.id),...pe.componentsBottom.map(Se=>Se.id)]);for(const Se of[...Ut,...Zt])if(!Ne.has(Se.id)){for(const be of Se.pinConnections)if(be&&be.trim()!==""){const ye=parseInt(be,10);!isNaN(ye)&&ye>0&&bg(ye)}}const ke=new Set(pe.powerSymbols.map(Se=>Se.id));for(const Se of we)!ke.has(Se.id)&&Se.pointId&&typeof Se.pointId=="number"&&bg(Se.pointId);const ge=new Set(pe.groundSymbols.map(Se=>Se.id));for(const Se of Fe)!ge.has(Se.id)&&Se.pointId&&typeof Se.pointId=="number"&&bg(Se.pointId);jt(pe.drawingStrokes),Pi(pe.componentsTop),Yn(pe.componentsBottom),Re(pe.powerSymbols),st(pe.groundSymbols),Pn([])}return}if(p.code==="KeyV"&&p.altKey&&!p.ctrlKey&&!p.shiftKey&&!L){const U=document.activeElement;if(!!U&&(U.tagName==="INPUT"&&U.type!=="range"&&U.type!=="checkbox"&&U.type!=="radio"||U.tagName==="TEXTAREA"||U.isContentEditable))return;p.preventDefault(),p.stopPropagation(),Vc(!1),zl(!0);return}if(p.code==="KeyP"&&p.altKey&&!p.ctrlKey&&!p.shiftKey&&!L){const U=document.activeElement;if(!!U&&(U.tagName==="INPUT"&&U.type!=="range"&&U.type!=="checkbox"&&U.type!=="radio"||U.tagName==="TEXTAREA"||U.isContentEditable))return;p.preventDefault(),p.stopPropagation(),Vc(!0),zl(!0);return}if((p.key==="a"||p.key==="A")&&!p.ctrlKey&&!p.altKey&&!p.shiftKey&&!L){const U=document.activeElement;if(!!U&&(U.tagName==="INPUT"&&U.type!=="range"&&U.type!=="checkbox"&&U.type!=="radio"||U.tagName==="TEXTAREA"||U.isContentEditable))return;if(an.size>0){p.preventDefault(),p.stopPropagation();const pe=Array.from(an),je=pe[pe.length-1];let Ne=null,ke=null;Ne=Ut.find(ge=>ge.id===je)||null,Ne?ke="top":(Ne=Zt.find(ge=>ge.id===je)||null,Ne&&(ke="bottom")),Ne&&ke&&Eo(Ne,ke)}return}if(!p.ctrlKey&&!p.altKey){const U=document.activeElement;if(!(!!U&&(U.tagName==="INPUT"&&U.type!=="range"&&U.type!=="checkbox"&&U.type!=="radio"||U.tagName==="TEXTAREA"||U.isContentEditable)))switch(p.key){case"s":case"S":p.preventDefault(),Je(),hu();return;case"b":case"B":p.preventDefault(),Je(),yn.length===1?($e(yn[0].id),N("power"),ve(!1),Xr(!0)):yn.length>1?ve(!0):(ve(!0),N("power"),Xr(!0));return;case"g":case"G":p.preventDefault(),Je(),j.length===1?(ii(j[0].id),N("ground"),ln(!1),Ui(!0)):j.length>1?ln(!0):(ln(!0),N("ground"),Ui(!0));return;case"v":case"V":p.preventDefault(),Je(),nn("via"),N("draw"),Vr(!0);return;case"p":case"P":p.preventDefault(),Je(),nn("pad"),N("draw");return;case"y":case"Y":p.preventDefault(),Je(),nn("testPoint"),N("draw");return;case"t":case"T":p.preventDefault(),Je(),nn("trace"),N("draw");return;case"c":case"C":p.preventDefault(),Je(),N("component"),Hu.current?Th(Hu.current):Th(null);return;case"e":case"E":p.preventDefault(),Je(),N("erase");return;case"h":case"H":p.preventDefault(),Je(),N("pan");return;case"x":case"X":p.preventDefault(),Je(),N("center"),ar(!0),Js.current&&clearTimeout(Js.current),Js.current=setTimeout(()=>{ar(!1),N("select"),ya(void 0)},2e3);return;case"m":case"M":if(!p.ctrlKey){p.preventDefault(),Je(),tc(!1),N("magnify");return}break}}if(k==="transform"&&Qt){if(!(p.key==="ArrowLeft"||p.key==="ArrowRight"||p.key==="ArrowUp"||p.key==="ArrowDown"))return;p.preventDefault(),p.stopPropagation();const Ae=document.activeElement;if(Ae&&Ae.tagName==="INPUT"){const pe=Ae;pe.type==="radio"&&pe.blur()}if(ji)return;if(Or==="nudge"){let pe=0,je=0;switch(p.key){case"ArrowLeft":pe=-1;break;case"ArrowRight":pe=1;break;case"ArrowUp":je=-1;break;case"ArrowDown":je=1;break;default:return}Qt==="top"&&t?n(Ne=>Ne?{...Ne,x:Ne.x+pe,y:Ne.y+je}:null):Qt==="bottom"&&s?o(Ne=>Ne?{...Ne,x:Ne.x+pe,y:Ne.y+je}:null):Qt==="both"&&(t&&n(Ne=>Ne?{...Ne,x:Ne.x+pe,y:Ne.y+je}:null),s&&o(Ne=>Ne?{...Ne,x:Ne.x+pe,y:Ne.y+je}:null))}else if(Or==="scale"){let pe=0;switch(p.key){case"ArrowUp":pe=.01;break;case"ArrowDown":pe=-.01;break;case"ArrowRight":pe=.001;break;case"ArrowLeft":pe=-.001;break;default:return}if(Qt==="top"){t&&n(je=>je?{...je,scale:Math.max(.1,Math.min(3,je.scale+pe))}:null);return}if(Qt==="bottom"){s&&o(je=>je?{...je,scale:Math.max(.1,Math.min(3,je.scale+pe))}:null);return}if(Qt==="both"){t&&n(je=>je?{...je,scale:Math.max(.1,Math.min(3,je.scale+pe))}:null),s&&o(je=>je?{...je,scale:Math.max(.1,Math.min(3,je.scale+pe))}:null);return}}else if(Or==="rotate"){let pe=0;switch(p.key){case"ArrowUp":pe=1;break;case"ArrowDown":pe=-1;break;case"ArrowRight":pe=.1;break;case"ArrowLeft":pe=-.1;break;default:return}if(Qt==="top"){t&&n(je=>je?{...je,rotation:je.rotation+pe}:null);return}if(Qt==="bottom"){s&&o(je=>je?{...je,rotation:je.rotation+pe}:null);return}if(Qt==="both"){t&&n(je=>je?{...je,rotation:je.rotation+pe}:null),s&&o(je=>je?{...je,rotation:je.rotation+pe}:null);return}}else if(Or==="slant"){let pe=0,je=0;switch(p.key){case"ArrowUp":je=-.5;break;case"ArrowDown":je=.5;break;case"ArrowLeft":pe=-.5;break;case"ArrowRight":pe=.5;break}if(pe!==0||je!==0){const Ne=Kd,ke=ge=>Math.max(-.7,Math.min(.7,ge));if(Qt==="top"){t&&n(ge=>ge?{...ge,skewX:ke((ge.skewX||0)+Ne(pe)),skewY:ke((ge.skewY||0)+Ne(je))}:null);return}if(Qt==="bottom"){s&&o(ge=>ge?{...ge,skewX:ke((ge.skewX||0)+Ne(pe)),skewY:ke((ge.skewY||0)+Ne(je))}:null);return}if(Qt==="both"){t&&n(ge=>ge?{...ge,skewX:ke((ge.skewX||0)+Ne(pe)),skewY:ke((ge.skewY||0)+Ne(je))}:null),s&&o(ge=>ge?{...ge,skewX:ke((ge.skewX||0)+Ne(pe)),skewY:ke((ge.skewY||0)+Ne(je))}:null);return}}}else if(Or==="keystone"){let pe=0,je=0;switch(p.key){case"ArrowUp":je=-.5;break;case"ArrowDown":je=.5;break;case"ArrowLeft":pe=-.5;break;case"ArrowRight":pe=.5;break}if(pe!==0||je!==0){const Ne=Kd,ke=ge=>Math.max(-.35,Math.min(.35,ge));if(Qt==="top"){t&&n(ge=>ge?{...ge,keystoneH:ke((ge.keystoneH||0)+Ne(pe)),keystoneV:ke((ge.keystoneV||0)+Ne(je))}:null);return}if(Qt==="bottom"){s&&o(ge=>ge?{...ge,keystoneH:ke((ge.keystoneH||0)+Ne(pe)),keystoneV:ke((ge.keystoneV||0)+Ne(je))}:null);return}if(Qt==="both"){t&&n(ge=>ge?{...ge,keystoneH:ke((ge.keystoneH||0)+Ne(pe)),keystoneV:ke((ge.keystoneV||0)+Ne(je))}:null),s&&o(ge=>ge?{...ge,keystoneH:ke((ge.keystoneH||0)+Ne(pe)),keystoneV:ke((ge.keystoneV||0)+Ne(je))}:null);return}}}}else{const U=p.target;if(U.tagName==="INPUT"&&U.type==="range"){const Ae=U,pe=Number(Ae.value),je=Number(Ae.min),Ne=Number(Ae.max),ke=Number(Ae.step)||1;switch(p.key){case"ArrowLeft":p.preventDefault();const ge=Math.max(je,pe-ke);Ae.value=ge.toString(),Ae.dispatchEvent(new Event("input",{bubbles:!0}));break;case"ArrowRight":p.preventDefault();const Se=Math.min(Ne,pe+ke);Ae.value=Se.toString(),Ae.dispatchEvent(new Event("input",{bubbles:!0}));break}}}},[k,Qt,Or,t,s,ni,an,ai,oi,pt,Ut,Zt,Dn,y,yn,lt,Gu,Gn,H,M,R,se,hu,Pi,Yn,Qn,jt,Re,st,we,Fe,Ou,tu,mo,Ct,ti,Ji,Sa,h,pi,vs,Ds,qr,f,n,o,Rt,fr,Si,c,Tn,_n,rn,mn,N,na,Qi,Ls,Ml,lr,Ns,ys,cr,Gr,fs,vo,io,Di,_a,ri,Cs,or,mr,Vr,Wr,Ta,$r,Yr,Uo,sc,Ho,ra,Xr,Ui,Li,Vc,zl,Eo]);Tt.useEffect(()=>{k!=="transform"&&Cr(null)},[k]),Tt.useEffect(()=>{window.addEventListener("keydown",Bd,!0);const p=C=>{C.key==="Alt"&&(Cf(!1),xo(!1),Cc(null))};return window.addEventListener("keyup",p,!0),()=>{window.removeEventListener("keydown",Bd,!0),window.removeEventListener("keyup",p,!0)}},[Bd,ai,oi,li,li,Dn,y,br,oa,hu,an,Ut,Zt,Pi,Yn,mo,ad,k]);const fd=X.useCallback(()=>{qn.current={},Q("#AA4499"),T("#F781BF"),Z(6),V(6),Lt("trace","#AA4499","top"),Lt("trace","#F781BF","bottom"),kt("trace",6,"top"),kt("trace",6,"bottom"),ae("#0072B2"),xe("#56B4E9"),D(18),K(18),Lt("pad","#0072B2","top"),Lt("pad","#56B4E9","bottom"),kt("pad",18,"top"),kt("pad",18,"bottom"),xt("#6A3D9A"),Nt("#9467BD"),Bt(18),qt(18),Lt("component","#6A3D9A","top"),Lt("component","#9467BD","bottom"),kt("component",18,"top"),kt("component",18,"bottom"),Fr("top"),G("#AA4499"),F(6),Ro([{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),ne([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),kt("power",18),kt("ground",18),Wi(!1),ks(!1),ll(!1),ba(!1),Ja(!1),ho(!1),Kt("top"),N("select"),f(50),b(!1),c("overlay"),rx(),vi()},[Lt,kt,vi]),Od=X.useCallback(()=>{qs(null),Jl(null),Ao&&(Ao.current=null),Ul&&(Ul.current=null),hs(""),Ia("pcb_project"),Ca(!1),hl(null),no(""),fl([]),Oo(-1),uc&&(uc.current=""),ls.current=!1,to(!1),qr(!1),go(null),Ri(null),Fi.current&&(clearInterval(Fi.current),Fi.current=null),n(null),o(null),vi(),jt([]),Rt([]),fr([]),Xa([]),co([]),Pn([]),Cn.current=[],Pi([]),Yn([]),Ka(null),rl(null),Re([]),st([]),Gt(null),Ro([{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),ne([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),Tn(new Set),_n(new Set),rn(new Set),mn(new Set),xa(!1),_s([]),c("overlay"),pi(1),Wa(0,0),Va(!0),Kt("top"),Rl({}),ar(!1),Js.current&&(clearTimeout(Js.current),Js.current=null),Cr(null),zr(!1),en(null),ja("nudge"),x(!1),f(50),b(!1),v(2e3),Wi(!1),ks(!1),uo(!1),ol(!1),ll(!1),ba(!1),Ja(!1),ho(!1),or(!0),mr(!0),Vr(!0),Wr(!0),Ta(!0),$r(!0),Yr(!0),Uo(!0),sc(!0),Ho(!0),ra(!0),Xr(!0),Ui(!0),Li(!0),Kr(!0),N("select"),nn("trace"),Fr("top"),ga("top"),Qo("top"),ma("top"),Pa.current="top",el.current="top",tl.current="top",$a.current="top",qn.current={},Xn(!0),Mt(!1),rx(),Qa(null),cl({visible:!1,text:""}),po({visible:!1,title:"",message:""}),ir({visible:!1}),Da({visible:!1}),Io({visible:!1,projectName:"",locationPath:"",locationHandle:null}),ws({visible:!1,filename:"",locationPath:"",locationHandle:null}),Lo({visible:!1,interval:null}),nr({visible:!1,source:"new",interval:5}),La(!1),E(!1),_t(!1),En(!1),Wc(!1),mi(!1),Sn(!1),Pr(!1),ld(null),Cc(null),nc(null),Ac(!1),Fo.current=null,ec.current=null,tn(!1),An(null),Vi.current=0,Vn.current=!1,console.log("Project closed: All state cleared and browser permissions released")},[qs,Jl,hs,Ia,Ca,hl,no,fl,Oo,n,o,jt,Pn,Rt,fr,Xa,co,Pi,Yn,Ka,rl,Re,st,Gt,Ro,ne,Tn,_n,rn,mn,xa,_s,c,pi,Po,Va,Kt,Rl,ar,Cr,zr,en,ja,x,f,b,v,Wi,ks,uo,ol,ll,ba,Ja,ho,or,mr,Vr,Wr,Ta,$r,Yr,Uo,sc,Ho,ra,Xr,Ui,Li,N,nn,Fr,ga,Qo,ma,Xn,Mt,Qa,cl,po,ir,Io,ws,Lo,nr,vi,La,E,_t,En,Wc,mi,Sn,ld,Cc,nc,Ac,tn,An]),Pc=X.useCallback(()=>{fd(),setTimeout(()=>{pi(1),Si({x:0,y:0}),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),Tn(new Set),_n(new Set),rn(new Set),mn(new Set)},200)},[fd,pi,Si]);Tt.useEffect(()=>{Pc()},[]),Tt.useEffect(()=>{if(!eo.visible)return;const p=[];ni.size>0,ni.size===0&&an.size===0&&ai.size===0&&oi.size===0&&p.push(`
No objects selected.`);const C=p.join(`
`);cl(L=>({...L,text:C}))},[eo.visible,ni,an,ai,oi,pt,Ut,Zt,Dn,y,yn]),Tt.useEffect(()=>{const p=C=>{const L=rs.current;if(L&&!(C.target instanceof Node&&L.contains(C.target))){if(Gu(),Fl){const Y=ud.current;(!Y||!(C.target instanceof Node)||!Y.contains(C.target))&&Id(!1)}if(id){const Y=Ll.current;!C.target?.closest('button[title="Color Picker"]')&&(!Y||!(C.target instanceof Node)||!Y.contains(C.target))&&La(!1)}}};return document.addEventListener("mousedown",p,!0),()=>document.removeEventListener("mousedown",p,!0)},[Gu,Fl,Ah,id]);const Xu=p=>{if(!p.current)return{top:0,left:0};const C=p.current.getBoundingClientRect(),L=qc.current?.getBoundingClientRect();return L?{top:C.top-L.top,left:C.left-L.left+C.width+4}:{top:0,left:0}},fu=X.useCallback(()=>{ud.current&&kh.current&&requestAnimationFrame(()=>{if(ud.current&&kh.current){const p=Xu(kh);ud.current.style.top=`${p.top}px`,ud.current.style.left=`${p.left}px`}})},[]),Ku=X.useCallback(()=>{ou.current&&Nh.current&&requestAnimationFrame(()=>{if(ou.current&&Nh.current){const p=Xu(Nh);ou.current.style.top=`${p.top}px`,ou.current.style.left=`${p.left}px`}})},[]),Eh=X.useCallback(()=>{lu.current&&qu.current&&requestAnimationFrame(()=>{if(lu.current&&qu.current){const p=Xu(qu);lu.current.style.top=`${p.top}px`,lu.current.style.left=`${p.left}px`}})},[]);Tt.useEffect(()=>{Fl&&fu()},[Fl,fu]),Tt.useEffect(()=>{Ah&&Ku()},[Ah,Ku]),Tt.useEffect(()=>{Ch&&Eh()},[Ch,Eh]),Tt.useEffect(()=>{if(Ke&&cu.current&&Wu.current){const p=Xu(Wu);cu.current.style.top=`${p.top}px`,cu.current.style.left=`${p.left}px`}},[Ke]),Tt.useEffect(()=>{if($t&&Fu.current&&du.current){const p=Xu(du);Fu.current.style.top=`${p.top}px`,Fu.current.style.left=`${p.left}px`}},[$t]),Tt.useEffect(()=>{const p=C=>{if(!Zs)return;const L=document.querySelector("[data-component-editor-dialog]");if(L&&C.target instanceof Node&&L.contains(C.target)){const Ue=C.target;if(Ue.tagName==="BUTTON"||Ue.tagName==="INPUT"||Ue.closest("button")||Ue.closest("input"))return}const Y=rs.current;if(!Y)return;const le=Y.getBoundingClientRect(),he=C.clientX,U=C.clientY;if(he<le.left||he>le.right||U<le.top||U>le.bottom)return;const Ae=Y.width/le.width,pe=Y.height/le.height,je=he-le.left,Ne=U-le.top,ke=je*Ae,ge=Ne*pe,Se=ke-5,be=ge-5,ye=Qf(Se,be,es,Ct,ti,Ji),Le=ye.x,Ee=ye.y;let He=1/0,ct=null,ft=null;const At=Math.max(6/Ct,4),Ft=[...Ut,...Zt].find(Ue=>Ue.id===Zs.componentId)?.layer||"top";for(const Ue of pt)if((Ue.type==="via"||Ue.type==="pad")&&Ue.points.length>0){if(Ue.type==="pad"&&(Ue.layer||"top")!==Ft)continue;const qe=Ue.points[0],Ie=Math.max(1,Ue.size/2),Xe=Math.hypot(qe.x-Le,qe.y-Ee),Ye=Math.max(Ie,At);Xe<=Ye&&Xe<He&&(He=Xe,ct=qe.id??null,ft=Ue)}if(ct!=null&&ft){console.log(`
[PIN CONNECTION - DOCUMENT HANDLER] Found via!`),console.log(`  Point ID: ${ct}`),console.log(`  Connecting pin ${Zs.pinIndex+1} of component ${Zs.componentId}`);const Ue=String(ct),qe=Zs.pinIndex,Ie=Zs.componentId,Xe=Ut.find(dt=>dt.id===Ie),Ye=Zt.find(dt=>dt.id===Ie);if(Xe){const dt=pt;Pi(Pt=>{const Jt=Pt.find(Et=>Et.id===Ie);if(!Jt)return Pt;const Nn=Jt.pinConnections||[],kn=Nn.length>0?[...Nn]:new Array(Jt.pinCount).fill("");let On;if(kn.length!==Jt.pinCount){On=new Array(Jt.pinCount).fill("");for(let Et=0;Et<Math.min(kn.length,Jt.pinCount);Et++)On[Et]=kn[Et]||""}else On=[...kn];On[qe]=Ue,console.log(`Updated pin ${qe} with value: ${Ue}`),console.log("New pinConnections:",On);const Kn=Pt.find(Et=>Et.id===Ie),Vt=Kn?Um(Kn,On,dt):null;return Pt.map(Et=>{if(Et.id===Ie){const un={...Et,pinConnections:On};return Vt&&(un.pinPolarities=Vt),un}return Et})})}else if(Ye){const dt=pt;Yn(Pt=>{const Jt=Pt.find(Et=>Et.id===Ie);if(!Jt)return Pt;const Nn=Jt.pinConnections||[],kn=Nn.length>0?[...Nn]:new Array(Jt.pinCount).fill("");let On;if(kn.length!==Jt.pinCount){On=new Array(Jt.pinCount).fill("");for(let Et=0;Et<Math.min(kn.length,Jt.pinCount);Et++)On[Et]=kn[Et]||""}else On=[...kn];On[qe]=Ue,console.log(`Updated pin ${qe} with value: ${Ue}`),console.log("New pinConnections:",On);const Kn=Pt.find(Et=>Et.id===Ie),Vt=Kn?Um(Kn,On,dt):null;return Pt.map(Et=>{if(Et.id===Ie){const un={...Et,pinConnections:On};return Vt&&(un.pinPolarities=Vt),un}return Et})})}setTimeout(()=>{rl(null)},0)}else console.log("[PIN CONNECTION - DOCUMENT HANDLER] No via found at click location")};if(Zs)return document.addEventListener("mousedown",p,!0),()=>document.removeEventListener("mousedown",p,!0)},[Zs,Ut,Zt,pt,Ct,es.x,es.y,ti,Ji]);const ro=X.useCallback((p,C,L,Y)=>{const le=window.innerWidth,he=window.innerHeight,U=10;let Ae=Math.max(U,Math.min(p,le-L-U)),pe=Math.max(U,Math.min(C,he-Y-U));return{x:Ae,y:pe}},[]);Tt.useEffect(()=>{if(!al)return;const p=L=>{if(!Kl)return;const Y={x:L.clientX-Kl.x,y:L.clientY-Kl.y},le=ro(Y.x,Y.y,250,window.innerHeight*.4);Za(le),localStorage.setItem("componentDialogPosition",JSON.stringify(le))},C=()=>{vc(!1),Cl(null)};return document.addEventListener("mousemove",p),document.addEventListener("mouseup",C),()=>{document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",C)}},[al,Kl,ro]),Tt.useEffect(()=>{if(!Mi)return;const p=L=>{if(!Ii)return;const Y={x:L.clientX-Ii.x,y:L.clientY-Ii.y},le=ro(Y.x,Y.y,250,window.innerHeight*.4);si(le),localStorage.setItem("detailedInfoDialogPosition",JSON.stringify(le))},C=()=>{Is(!1),yr(null)};return document.addEventListener("mousemove",p),document.addEventListener("mouseup",C),()=>{document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",C)}},[Mi,Ii,ro]),Tt.useEffect(()=>{if(!er)return;const p=L=>{if(!ns)return;const Y={x:L.clientX-ns.x,y:L.clientY-ns.y};Hi(Y),localStorage.setItem("notesDialogPosition",JSON.stringify(Y))},C=()=>{dr(!1),zi(null)};return document.addEventListener("mousemove",p),document.addEventListener("mouseup",C),()=>{document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",C)}},[er,ns]),Tt.useEffect(()=>{if(js&&Ts===null){const p=localStorage.getItem("notesDialogPosition");if(p)try{const C=JSON.parse(p);Hi(C)}catch{Hi({x:window.innerWidth-550,y:100})}else Hi({x:window.innerWidth-550,y:100})}},[js,Ts]),Tt.useEffect(()=>{if(!so)return;const p=L=>{if(!$s)return;const Y={x:L.clientX-$s.x,y:L.clientY-$s.y};Zr(Y),localStorage.setItem("projectNotesDialogPosition",JSON.stringify(Y))},C=()=>{aa(!1),Il(null)};return document.addEventListener("mousemove",p),document.addEventListener("mouseup",C),()=>{document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",C)}},[so,$s]),Tt.useEffect(()=>{if(wn&&Ai===null){const p=localStorage.getItem("projectNotesDialogPosition");if(p)try{const C=JSON.parse(p);Zr(C)}catch{Zr({x:100,y:100})}else Zr({x:100,y:100})}},[wn,Ai]);const Pf=X.useCallback(()=>{Sn(!0)},[]);Tt.useEffect(()=>{if(Ur&&Ur.visible&&Ra===null){const p=localStorage.getItem("componentDialogPosition");let C;if(p)try{const L=JSON.parse(p);C=ro(L.x,L.y,250,window.innerHeight*.4),Za(C)}catch{C=ro(window.innerWidth-280,90,250,window.innerHeight*.4),Za(C)}else C=ro(window.innerWidth-280,90,250,window.innerHeight*.4),Za(C)}else!Ur||Ur.visible},[Ur,Ra,ro]),Tt.useEffect(()=>{if(eo.visible&&Gi===null){const p=localStorage.getItem("detailedInfoDialogPosition");let C;if(p)try{const L=JSON.parse(p);C=ro(L.x,L.y,400,window.innerHeight*.8),si(C)}catch{C=ro(window.innerWidth-450,90,400,window.innerHeight*.8),si(C)}else C=ro(window.innerWidth-450,90,400,window.innerHeight*.8),si(C)}else eo.visible},[eo.visible,Gi,ro]),Tt.useEffect(()=>{const p=()=>{if(Ra){const C=ro(Ra.x,Ra.y,250,window.innerHeight*.4);(C.x!==Ra.x||C.y!==Ra.y)&&(Za(C),localStorage.setItem("componentDialogPosition",JSON.stringify(C)))}if(Gi){const C=ro(Gi.x,Gi.y,400,window.innerHeight*.8);(C.x!==Gi.x||C.y!==Gi.y)&&(si(C),localStorage.setItem("detailedInfoDialogPosition",JSON.stringify(C)))}};return window.addEventListener("resize",p),()=>window.removeEventListener("resize",p)},[Ra,Gi,ro]);const Ef=X.useCallback(p=>{switch(p){case"transparency":f(50);break;case"brushSize":F(3);break}},[]),Rh=Tt.useRef(S);Tt.useEffect(()=>{Rh.current=S},[S]),Tt.useEffect(()=>{if(m){Ql.current=performance.now(),f(0);const p=C=>{const L=Ql.current||C,Y=Rh.current,le=(C-L)%Y/Y,he=1-Math.abs(1-2*le);f(Math.round(he*100)),El.current=requestAnimationFrame(p)};El.current=requestAnimationFrame(p)}return()=>{El.current&&(cancelAnimationFrame(El.current),El.current=null)}},[m]),Tt.useEffect(()=>{if(k==="center"){ya(p5());return}const p=k==="erase"?"erase":k==="magnify"?"magnify":k==="ground"?"ground":k==="power"?"power":k==="component"?"component":k==="draw"?lt==="via"?"via":lt==="pad"?"pad":lt==="testPoint"?"testPoint":"trace":"default";if(p==="default"){ya(void 0);return}const C=Ct;let L;if(p==="magnify")L=18;else if(p==="component"){const ge=(gi||"top")==="top"?"componentTop":"componentBottom",be=Mn.get(ge).size||py.DEFAULT_SIZE;L=Math.max(16,Math.round(be*C))}else if(p==="trace"){const ge=(Gn||"top")==="top"?"traceTop":"traceBottom",be=Mn.get(ge).size||6;L=Math.max(6,Math.round(be*C))}else if(p==="via"){const ge=Mn.get("via").size||6;L=Math.max(6,Math.round(ge*C))}else if(p==="pad"){const ge=(xi||"top")==="top"?"padTop":"padBottom",be=Mn.get(ge).size||6;L=Math.max(6,Math.round(be*C))}else if(p==="testPoint"){const ge=(Rn||"top")==="top"?"testPointTop":"testPointBottom",be=Mn.get(ge).size||18;L=Math.max(12,Math.round(be*C))}else p==="power"||p==="ground"?L=Math.max(12,Math.round(te*C)):L=Math.max(6,Math.round(te*C));const le=L+4*2+(p==="magnify"?8:0),he=document.createElement("canvas");he.width=le,he.height=le;const U=he.getContext("2d");if(!U){ya(void 0);return}const Ae=le/2,pe=le/2,je=L/2;if(U.clearRect(0,0,le,le),p==="via"){const ke=je,ge=je*.5,Se=je*.7,ye=Mn.get("via").color;U.fillStyle=ye,U.beginPath(),U.arc(Ae,pe,ke,0,Ha),U.arc(Ae,pe,ge,0,Ha),U.fill("evenodd"),U.strokeStyle="#808080",U.lineWidth=1,U.beginPath(),U.moveTo(Ae-Se,pe),U.lineTo(Ae+Se,pe),U.stroke(),U.beginPath(),U.moveTo(Ae,pe-Se),U.lineTo(Ae,pe+Se),U.stroke()}else if(p==="pad"){const ke=xi==="top"?"padTop":"padBottom",Se=Mn.get(ke).color,ye=L/2,Le=ye*2,Ee=Le*.5,He=ye*.7;U.fillStyle=Se,U.beginPath(),U.rect(Ae-ye,pe-ye,Le,Le),U.rect(Ae-Ee/2,pe-Ee/2,Ee,Ee),U.fill("evenodd"),U.strokeStyle="#808080",U.lineWidth=1,U.beginPath(),U.moveTo(Ae-He,pe),U.lineTo(Ae+He,pe),U.stroke(),U.beginPath(),U.moveTo(Ae,pe-He),U.lineTo(Ae,pe+He),U.stroke()}else if(p==="trace"){const ke=Gn==="top"?"traceTop":"traceBottom",Se=Mn.get(ke).color;U.fillStyle=Se,U.beginPath(),U.arc(Ae,pe,je,0,Ha),U.fill()}else if(p==="testPoint"){ya(g5(L));return}else if(p==="erase"){const ke=te*C,ge=Math.max(ke*.75,8),Se=Math.max(ke*.5,6),be=Math.max(ke*.2,2);U.save(),U.translate(Ae,pe),U.rotate(Kd(-35)),U.fillStyle="#f5a3b3",U.strokeStyle="#111",U.lineWidth=1.5;const ye=1.5,Le=-ge/2,Ee=-Se/2;U.beginPath(),U.moveTo(Le+ye,Ee),U.lineTo(Le+ge-ye,Ee),U.quadraticCurveTo(Le+ge,Ee,Le+ge,Ee+ye),U.lineTo(Le+ge,Ee+Se-ye),U.quadraticCurveTo(Le+ge,Ee+Se,Le+ge-ye,Ee+Se),U.lineTo(Le+ye,Ee+Se),U.quadraticCurveTo(Le,Ee+Se,Le,Ee+Se-ye),U.lineTo(Le,Ee+ye),U.quadraticCurveTo(Le,Ee,Le+ye,Ee),U.closePath(),U.fill(),U.stroke(),U.fillStyle="#f18ea4",U.beginPath(),U.rect(-ge/2,Se/2-be,ge,be),U.fill(),U.restore()}else if(p==="magnify"){const ke=je;U.strokeStyle="#111",U.lineWidth=2,U.beginPath(),U.arc(Ae-2,pe-2,ke,0,Ha),U.stroke();const ge=Ae+ke*.6,Se=pe+ke*.6,be=ge+6,ye=Se+6;U.beginPath(),U.moveTo(ge,Se),U.lineTo(be,ye),U.stroke(),U.beginPath(),U.moveTo(Ae-6,pe-2),U.lineTo(Ae+2,pe-2),U.stroke(),Ba||(U.beginPath(),U.moveTo(Ae-2,pe-6),U.lineTo(Ae-2,pe+2),U.stroke())}else if(p==="ground"){const ge=(Ht?j.find(be=>be.id===Ht):null)?.color||"#000000";if(U.strokeStyle=ge,U.lineWidth=2,U.lineCap="round",Ht==="groundbus-earth"){const be=je*1.5,ye=be*.9,Le=be*.24,Ee=be*1.6;U.beginPath(),U.moveTo(Ae,pe-ye/2),U.lineTo(Ae,pe+ye/2),U.stroke();for(let He=0;He<3;He++){const ct=pe+ye/2+He*Le,ft=Ee*(1-He*.25);U.beginPath(),U.moveTo(Ae-ft/2,ct),U.lineTo(Ae+ft/2,ct),U.stroke()}}else{const be=je*.8;U.beginPath(),U.arc(Ae,pe,je,0,Ha),U.stroke(),U.beginPath(),U.moveTo(Ae,pe-je-be),U.lineTo(Ae,pe+je+be),U.stroke(),U.beginPath(),U.moveTo(Ae-je-be,pe),U.lineTo(Ae+je+be,pe),U.stroke()}}else if(p==="power"){const ge=(Be?yn.find(be=>be.id===Be):null)?.color||"#ff0000";U.strokeStyle=ge,U.lineWidth=2,U.lineCap="round";const Se=je*.8;U.beginPath(),U.arc(Ae,pe,je,0,Ha),U.stroke(),U.beginPath(),U.moveTo(Ae,pe-je-Se),U.lineTo(Ae,pe+je+Se),U.stroke(),U.beginPath(),U.moveTo(Ae-je-Se,pe),U.lineTo(Ae+je+Se,pe),U.stroke()}else if(p==="component"){const ge=(gi||"top")==="top"?"componentTop":"componentBottom",be=Mn.get(ge).color,ye=L,Le=ye/2;U.strokeStyle=be,U.lineWidth=2,U.fillStyle="rgba(255,255,255,0.9)",U.beginPath(),U.rect(Ae-Le,pe-Le,ye,ye),U.fill(),U.stroke();const Ee=(()=>{const He=Yc?.dataDrivenDefinition?.designator??Yc?.componentDefinition?.designator??Yc?.designator;return He?He.length<=3?He:He.substring(0,3):cc?Nm(cc):"?"})();U.fillStyle=be,U.font=`bold ${Math.max(8,ye*.35)}px sans-serif`,U.textAlign="center",U.textBaseline="middle",U.fillText(Ee,Ae,pe)}const Ne=`url(${he.toDataURL()}) ${Math.round(Ae)} ${Math.round(pe)}, crosshair`;ya(Ne)},[k,lt,B,te,Ct,Ba,cc,Yc,Be,Ht,yn,j,Hn,Gn,xi,Rn,gi,ss.toolInstanceId]),Tt.useEffect(()=>{uu()},[uu]),Tt.useEffect(()=>{uu()},[Dl.width,Dl.height]),Tt.useEffect(()=>{ni.size===0&&k==="draw"&&lt==="trace"&&te>=1&&(Xt==="top"?Z(te):V(te))},[te,k,lt,Xt,ni]),Tt.useEffect(()=>{jt(p=>p.map(C=>{if(C.type==="via"&&C.points.length>0&&C.points[0].id!==void 0){const L=C.points[0].id,Y=So(L,yn);if(C.viaType!==Y)return{...C,viaType:Y}}else if(C.type==="pad"&&C.points.length>0&&C.points[0].id!==void 0){const L=C.points[0].id,Y=Jr(L,yn);if(C.padType!==Y)return{...C,padType:Y}}else if(C.type==="testPoint"&&C.points.length>0&&C.points[0].id!==void 0){const L=C.points[0].id,Y=ml(L,yn),le=Y.includes("Power")?"power":Y.includes("Ground")?"ground":Y.includes("Signal")?"signal":"unknown";if(C.testPointType!==le)return{...C,testPointType:le}}return C}))},[Dn,y,yn,So,Jr,ml]);const Rf=X.useCallback(()=>{const p=rs.current;if(!p)return;const C=p.toDataURL("image/png"),L=window.open("","_blank");if(!L){alert("Please allow popups to print the canvas.");return}L.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>PCB Drawing</title>
          <style>
            @media print {
              @page {
                margin: 0;
                size: auto;
              }
              body {
                margin: 0;
                padding: 0;
              }
            }
            body {
              margin: 0;
              padding: 20px;
              display: flex;
              justify-content: center;
              align-items: center;
              background: white;
            }
            img {
              max-width: 100%;
              height: auto;
              display: block;
            }
          </style>
        </head>
        <body>
          <img src="${C}" alt="PCB Drawing" onload="window.setTimeout(function() { window.print(); }, 250);" />
        </body>
      </html>
    `),L.document.close()},[]);Tt.useEffect(()=>{const p=L=>{L.key==="Shift"&&tc(!0)},C=L=>{L.key==="Shift"&&tc(!1)};return window.addEventListener("keydown",p),window.addEventListener("keyup",C),()=>{window.removeEventListener("keydown",p),window.removeEventListener("keyup",C)}},[]);const Df=X.useCallback(p=>{if(p.size===0)return;const C=Array.from(p).map(L=>String(L));jt(L=>L.map(Y=>{if(Y.type==="trace"){const le=Y.points.filter(he=>he.id===void 0?!0:!p.has(he.id));return le.length<2?null:{...Y,points:le}}return Y}).filter(Y=>Y!==null)),Pi(L=>L.map(Y=>{const le=Y.pinConnections||[];if(le.some(U=>U&&C.includes(U))){const U=le.map(Ae=>Ae&&C.includes(Ae)?"":Ae);return{...Y,pinConnections:U}}return Y})),Yn(L=>L.map(Y=>{const le=Y.pinConnections||[];if(le.some(U=>U&&C.includes(U))){const U=le.map(Ae=>Ae&&C.includes(Ae)?"":Ae);return{...Y,pinConnections:U}}return Y}))},[jt,Pi,Yn]),Dh=X.useRef(new Set);Tt.useEffect(()=>{const p=new Set;for(const L of pt)if((L.type==="via"||L.type==="pad")&&L.points.length>0){const Y=L.points[0].id;Y!==void 0&&p.add(Y)}const C=new Set;for(const L of Dh.current)p.has(L)||C.add(L);C.size>0&&Df(C),Dh.current=p},[pt,Df]),Tt.useEffect(()=>{jt(p=>p.map(C=>{if(C.type==="via"&&C.points.length>0&&C.points[0].id!==void 0){const L=C.points[0].id,Y=So(L,yn);if(C.viaType!==Y)return{...C,viaType:Y}}else if(C.type==="pad"&&C.points.length>0&&C.points[0].id!==void 0){const L=C.points[0].id,Y=Jr(L,yn);if(C.padType!==Y)return{...C,padType:Y}}else if(C.type==="testPoint"&&C.points.length>0&&C.points[0].id!==void 0){const L=C.points[0].id,Y=ml(L,yn),le=Y.includes("Power")?"power":Y.includes("Ground")?"ground":Y.includes("Signal")?"signal":"unknown";if(C.testPointType!==le)return{...C,testPointType:le}}return C}))},[Dn,y,yn,So,Jr,ml]),Tt.useEffect(()=>{const p=C=>{bo.current&&(bo.current.contains(C.target)||Qa(null))};return document.addEventListener("click",p),()=>document.removeEventListener("click",p)},[]),Tt.useEffect(()=>{const p=(C,L)=>{const Y=C.current;if(!Y)return;const le=Y.getContext("2d");if(!le)return;const he=Y.width,U=Y.height;if(le.clearRect(0,0,he,U),le.fillStyle="#fff",le.fillRect(0,0,he,U),L?.bitmap){const Ae=L.bitmap,pe=Math.min(he/Ae.width,U/Ae.height),je=Math.max(1,Math.floor(Ae.width*pe)),Ne=Math.max(1,Math.floor(Ae.height*pe)),ke=Math.floor((he-je)/2),ge=Math.floor((U-Ne)/2);le.drawImage(Ae,ke,ge,je,Ne)}le.strokeStyle="#ddd",le.lineWidth=1,le.strokeRect(.5,.5,he-1,U-1)};p(ic,t),p(Qd,s)},[t,s]),Tt.useEffect(()=>{const p=[],C=[],L=[],Y=[];for(const le of pt)if(le.type==="via"&&le.points.length>=1){const he=le.points[0],U={id:le.id,pointId:he.id,x:he.x,y:he.y,size:le.size,color:le.color};p.push(U)}else if(le.type==="pad"&&le.points.length>=1){const he=le.points[0],U={id:le.id,pointId:he.id,x:he.x,y:he.y,size:le.size,color:le.color,layer:le.layer||"top"};C.push(U)}else if(le.type==="trace"&&le.points.length>=2)for(let he=0;he<le.points.length-1;he++){const U=le.points[he],Ae=le.points[he+1],pe={id:le.id,startPointId:U.id,endPointId:Ae.id,x1:U.x,y1:U.y,x2:Ae.x,y2:Ae.y,size:le.size,color:le.color};le.layer==="top"?L.push(pe):Y.push(pe)}Rt(p),fr(C),Xa(L),co(Y)},[pt]);const Fd=X.useRef(pt);Fd.current=pt;const dc=X.useCallback(()=>{const C=new Date().toISOString(),L=ox();return{project:{version:1,fileType:"PCB_REVERSE_ENGINEERING_AUTOSAVE",savedAt:C,view:{currentView:d,viewScale:Ct,cameraWorldCenter:Ti,showBothLayers:Yl,selectedDrawingLayer:Xt},images:{top:t?{name:t.name,width:t.width,height:t.height,filePath:t.filePath||t.name,x:t.x,y:t.y,scale:t.scale,rotation:t.rotation,flipX:t.flipX,flipY:t.flipY,skewX:t.skewX,skewY:t.skewY,keystoneV:t.keystoneV,keystoneH:t.keystoneH,brightness:t.brightness??100,contrast:t.contrast??100}:null,bottom:s?{name:s.name,width:s.width,height:s.height,filePath:s.filePath||s.name,x:s.x,y:s.y,scale:s.scale,rotation:s.rotation,flipX:s.flipX,flipY:s.flipY,skewX:s.skewX,skewY:s.skewY,keystoneV:s.keystoneV,keystoneH:s.keystoneH,brightness:s.brightness??100,contrast:s.contrast??100}:null},projectDirectoryName:Ao.current?Ao.current.name||null:ki&&ki.name||null,drawing:{drawingStrokes:Fd.current.filter(le=>!(le.type==="trace"&&le.points.length<2)),vias:na,tracesTop:Al,tracesBottom:Ea,componentsTop:Ut,componentsBottom:Zt,grounds:y,powers:Dn},powerBuses:yn,groundBuses:j,pointIdCounter:im(),designatorCounters:{...qn.current},autoAssignDesignators:ts,useGlobalDesignatorCounters:Wt,traceColors:{top:Hn.get("trace")?.layerSettings.get("top")?.color||H,bottom:Hn.get("trace")?.layerSettings.get("bottom")?.color||M},traceSizes:{top:Hn.get("trace")?.layerSettings.get("top")?.size||R,bottom:Hn.get("trace")?.layerSettings.get("bottom")?.size||se},padColors:{top:Hn.get("pad")?.layerSettings.get("top")?.color||ee,bottom:Hn.get("pad")?.layerSettings.get("bottom")?.color||Ce},padSizes:{top:Hn.get("pad")?.layerSettings.get("top")?.size||J,bottom:Hn.get("pad")?.layerSettings.get("bottom")?.size||W},componentColors:{top:Hn.get("component")?.layerSettings.get("top")?.color||ht,bottom:Hn.get("component")?.layerSettings.get("bottom")?.color||fe},componentSizes:{top:Hn.get("component")?.layerSettings.get("top")?.size||zt,bottom:Hn.get("component")?.layerSettings.get("bottom")?.size||it},testPointColors:{top:Hn.get("testPoint")?.layerSettings.get("top")?.color||ue,bottom:Hn.get("testPoint")?.layerSettings.get("bottom")?.color||Pe},testPointSizes:{top:Hn.get("testPoint")?.layerSettings.get("top")?.size||De,bottom:Hn.get("testPoint")?.layerSettings.get("bottom")?.size||ot},componentConnectionColor:vt,componentConnectionSize:Ot,toolLayerDefaults:{trace:Gn,pad:xi,testPoint:Rn,component:gi},toolSettings:{trace:Hn.get("trace")?.settings||{color:"#ff0000",size:6},via:Hn.get("via")?.settings||{color:"#ff0000",size:18},pad:Hn.get("pad")?.settings||{color:"#ff0000",size:18},component:Hn.get("component")?.settings||{color:"#ff0000",size:18},ground:Hn.get("ground")?.settings||{color:"#000000",size:18},power:Hn.get("power")?.settings||{color:"#ff0000",size:18},erase:Hn.get("erase")?.settings||{color:"#f5a3b3",size:18}},locks:{areImagesLocked:ji,areViasLocked:Ei,arePadsLocked:as,areTracesLocked:pr,areComponentsLocked:Hs,areGroundNodesLocked:gr,arePowerNodesLocked:li},visibility:{showViasLayer:lr,showTopPadsLayer:cr,showBottomPadsLayer:Gr,showTopTracesLayer:Ns,showBottomTracesLayer:ys,showTopComponents:io,showBottomComponents:Di,showPowerLayer:_a,showGroundLayer:ri,showConnectionsLayer:Cs,showTraceCornerDots:Ms},autoSave:{enabled:rr,interval:kl,baseName:jl},projectInfo:{name:Vs},projectNotes:xr,homeViews:mo,toolInstances:Mn.getAll()},timestamp:L}},[d,Ct,Ti,Yl,Xt,t,s,pt,na,Al,Ea,Ut,Zt,y,Hn,ji,Ei,as,pr,Hs,gr,li,yn,j,im,H,M,R,se,ee,Ce,J,W,ht,fe,zt,it,Gn,xi,Rn,gi,rr,kl,jl,Vs,lr,cr,Gr,Ns,ys,io,Di,_a,ri,Cs,ts,Wt,xr,mo]),Lf=X.useRef(dc);Lf.current=dc;const Ul=X.useRef(Nl);Ul.current=Nl;const uc=X.useRef(jl);uc.current=jl;const Ec=X.useRef(hs);Ec.current=hs;const Lh=X.useRef(Pl);Lh.current=Pl;const Wo=X.useRef([]);Wo.current=jd;const Ud=X.useRef(-1);Ud.current=Pd;const Ao=X.useRef(null),pu=X.useRef(!1);Tt.useEffect(()=>{pu.current||(Ao.current=ki)},[ki]);const Mh=X.useCallback(async()=>{console.log("Auto save: performAutoSave called");let p=Ul.current||Ao.current,C=uc.current;if(console.log(`Auto save: dirHandle=${p?`set (using ${Ul.current?"autoSaveDirHandle":"projectDirHandle"})`:"missing"}, baseName=${C||"missing"}`),!p||!C){console.warn(`Auto save: Missing project directory handle (${!p}) or base name (${!C}). Please create a new project or open an existing project first.`),Ca(!1),Fi.current&&(clearInterval(Fi.current),Fi.current=null);return}if(!ls.current){console.log("Auto save: Skipping - no changes since last save");return}const L=Fd.current,Y=L.filter(Ne=>Ne.type==="trace"&&Ne.points.length<2);if(Y.length>0){console.log(`Auto save: Cleaning up ${Y.length} single-point trace(s) before save`),Y.forEach(ke=>console.log(`  - Removing single-point trace ${ke.id}`));const Ne=L.filter(ke=>!(ke.type==="trace"&&ke.points.length<2));jt(Ne),Fd.current=Ne}console.log("Auto save: Starting save...");const{project:le,timestamp:he}=Lf.current(),Ae=`${Qu(C)}_${he}.json`,pe=JSON.stringify(le,null,2),je=new Blob([pe],{type:"application/json"});try{let Ne;try{Ne=await p.getDirectoryHandle("history",{create:!0})}catch(ye){console.error("Failed to get/create history directory:",ye);return}try{const ye=[],Le=Lh.current;for await(const Ee of p.keys())try{if(Ee==="history"||Ee===Ae)continue;const ct=await(await p.getFileHandle(Ee)).getFile();if(!Ee.endsWith(".json"))continue;const ft=await ct.text();try{const At=JSON.parse(ft);if(At.version&&(At.fileType==="PCB_REVERSE_ENGINEERING_AUTOSAVE"||!At.fileType)){ye.push(Ee);const nt=At.fileType?"auto-saved":"manually saved/opened";console.log(`Auto save: Found PCB project file in root: ${Ee} (${nt}${Ee===Le?" - this is the opened file":""})`)}}catch{continue}}catch{continue}for(const Ee of ye)try{const ft=await(await(await p.getFileHandle(Ee)).getFile()).text(),nt=await(await Ne.getFileHandle(Ee,{create:!0})).createWritable();await nt.write(new Blob([ft],{type:"application/json"})),await nt.close(),await p.removeEntry(Ee),console.log(`Auto save: Moved ${Ee} from root to history/`)}catch(He){console.warn(`Auto save: Failed to move ${Ee} to history:`,He)}}catch(ye){console.warn("Auto save: Error checking for old files in root:",ye)}const ge=await(await p.getFileHandle(Ae,{create:!0})).createWritable();await ge.write(je),await ge.close(),console.log(`Auto save: Successfully saved ${Ae} to root directory`),Ec.current(Ae);const Se=Wo.current,be=[Ae,...Se.filter(ye=>ye!==Ae)].sort((ye,Le)=>Le.localeCompare(ye));fl(be),Wo.current=be,Oo(0),Ud.current=0,ls.current=!1,to(!1)}catch(Ne){console.error("Auto save failed:",Ne)}},[]);rd.current=Mh;const pd=X.useCallback(async()=>{const{project:p}=dc(),C=JSON.stringify(p,null,2),L=new Blob([C],{type:"application/json"});if(ki&&Vs)try{let je=null;try{je=await ki.getDirectoryHandle("history",{create:!0})}catch(Le){console.error("Failed to get/create history directory:",Le),je=null}const Ne=Vs.replace(/\.json$/i,""),ke=Qu(Ne),{timestamp:ge}=dc(),Se=`${ke}_${ge}.json`;if(je)try{const Le=[];for await(const Ee of ki.keys())try{if(Ee==="history"||Ee===Se)continue;const ct=await(await ki.getFileHandle(Ee)).getFile();if(!Ee.endsWith(".json"))continue;const ft=await ct.text();try{JSON.parse(ft).version&&(Le.push(Ee),console.log(`Save: Found PCB project file in root: ${Ee}`))}catch{continue}}catch{continue}for(const Ee of Le)try{const ft=await(await(await ki.getFileHandle(Ee)).getFile()).text(),nt=await(await je.getFileHandle(Ee,{create:!0})).createWritable();await nt.write(new Blob([ft],{type:"application/json"})),await nt.close(),await ki.removeEntry(Ee),console.log(`Save: Moved ${Ee} from root to history/`)}catch(He){console.warn(`Save: Failed to move ${Ee} to history:`,He)}}catch(Le){console.warn("Save: Error checking for old files in root:",Le)}const ye=await(await ki.getFileHandle(Se,{create:!0})).createWritable();await ye.write(L),await ye.close(),hs(Se),to(!1),ls.current=!1,console.log(`Project saved successfully: ${Vs}/${Se}`),alert(`Project saved successfully!

File: ${Se}
Location: ${Vs}`);return}catch(je){const Ne=je instanceof Error?je.message:String(je);console.error("Failed to save to project directory:",je),alert(`Failed to save project to directory.

Error: ${Ne}

Please try saving again or use Save As...`),qs(null)}if(Vs&&!ki){const je=window;if(typeof je.showDirectoryPicker=="function")try{const Ne=await je.showDirectoryPicker();qs(Ne);const ke=`${Vs}.json`,Se=await(await Ne.getFileHandle(ke,{create:!0})).createWritable();await Se.write(L),await Se.close(),hs(ke),to(!1),ls.current=!1,console.log(`Project saved successfully: ${ke} in selected directory`),alert(`Project saved successfully!

File: ${ke}`);return}catch(Ne){if(Ne?.name!=="AbortError"){const ke=Ne instanceof Error?Ne.message:String(Ne);console.error("Failed to get directory:",Ne),alert(`Failed to select directory.

Error: ${ke}

Falling back to file picker...`)}}}const Y=je=>String(je).padStart(2,"0"),le=new Date,U=`pcb_project_${`${le.getFullYear()}_${Y(le.getMonth()+1)}_${Y(le.getDate())}_${Y(le.getHours())}_${Y(le.getMinutes())}_${Y(le.getSeconds())}`}.json`,Ae=window;if(typeof Ae.showSaveFilePicker=="function")try{const je=await Ae.showSaveFilePicker({suggestedName:U,types:[{description:"PCB Project",accept:{"application/json":[".json"]}}]}),Ne=await je.createWritable();await Ne.write(L),await Ne.close();const ke=je.name;try{const be=await je.getFile();hs(be.name)}catch{hs(ke)}const Se=ke.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_");Se&&Ia(Se);try{const be=je.name.replace(/\.json$/i,""),Le=Qu(be).replace(/[^a-zA-Z0-9_-]/g,"_");no(Le),Nl||console.log("Auto save: Directory handle not set. Will prompt on first auto save.")}catch(be){console.warn("Could not set up auto save for new file:",be)}console.log(`Project saved successfully: ${ke}`),alert(`Project saved successfully!

File: ${ke}`);return}catch(je){if(je?.name==="AbortError")return;const Ne=je instanceof Error?je.message:String(je);console.warn("showSaveFilePicker failed, falling back to download",je),alert(`File picker unavailable.

Error: ${Ne}

Falling back to browser download...`)}const pe=document.createElement("a");pe.href=URL.createObjectURL(L),pe.download=U,document.body.appendChild(pe),pe.click(),setTimeout(()=>{URL.revokeObjectURL(pe.href),document.body.removeChild(pe)},0),console.log(`Project downloaded: ${U}`),alert(`Project downloaded successfully!

File: ${U}

Note: For better project management, use File  New Project or File  Open Project.`)},[dc,ki,Vs,hs,qs,to,Ia,no,Nl,Qu]),gu=X.useCallback(p=>{const C=new jn,L=C.internal.pageSize.getWidth(),Y=C.internal.pageSize.getHeight(),le=20;let he=le;const U=7,Ae=60;C.setFontSize(18),C.setFont("helvetica","bold"),C.text("Bill of Materials",L/2,he,{align:"center"}),he+=U*2,C.setFontSize(10),C.setFont("helvetica","normal"),p.projectName&&(C.text(`Project: ${p.projectName}`,le,he),he+=U),C.text(`Exported: ${new Date(p.exportedAt).toLocaleString()}`,le,he),he+=U,C.text(`Total Components: ${p.totalComponents} | Unique Components: ${p.uniqueComponents}`,le,he),he=Ae,C.setFontSize(9),C.setFont("helvetica","bold");const pe=[15,50,30,20,25,30,20],je=["Qty","Component Type","Value","Package","Manufacturer","Part Number","Layer"];let Ne=le;return je.forEach((ge,Se)=>{C.text(ge,Ne,he),Ne+=pe[Se]}),he+=U,C.setLineWidth(.5),C.line(le,he,L-le,he),he+=U*.5,C.setFont("helvetica","normal"),C.setFontSize(8),p.items.forEach(ge=>{const Se=He=>{he>Y-le-U*He&&(C.addPage(),he=le+U)};Se(3),Ne=le,[ge.quantity.toString(),ge.componentType,ge.value||"-",ge.packageType||"-",ge.manufacturer||"-",ge.partNumber||"-",ge.layer].forEach((He,ct)=>{const ft=pe[ct]-2,At=C.splitTextToSize(He,ft);C.text(At[0]||"-",Ne,he),Ne+=pe[ct]}),he+=U*1.2;const ye=(ge.notes||"").toString().trim(),Le=ge.datasheet?ge.datasheet.toString().trim():"",Ee=[];if(ye&&Ee.push(`Notes: ${ye}`),Le&&Ee.push(`Spec Sheet URL: ${Le}`),Ee.length>0){const He=le+pe[0]+2,ct=L-le-He;Ee.forEach(ft=>{C.splitTextToSize(ft,ct).forEach(nt=>{Se(2),C.text(nt,He,he),he+=U*.9})})}Se(1),C.setLineWidth(.2),C.line(le,he,L-le,he),he+=U*.5}),C.output("blob")},[]),Gs=X.useCallback(async()=>{if(console.log("handleExportBOM called, format:",$),!ki){alert("Please create or open a project before exporting BOM.");return}try{console.log("Generating BOM data...");const p=x5(Ut,Zt,Vs);console.log("BOM data generated:",p),console.log("Creating/getting BOM directory...");let C;try{C=await ki.getDirectoryHandle("BOM",{create:!0}),console.log("BOM directory obtained")}catch(Ae){console.error("Failed to get/create BOM directory:",Ae),alert("Failed to create BOM directory. See console for details.");return}const L=ox();let Y,le;if($==="pdf")console.log("Generating PDF..."),Y=gu(p),le=`BOM_${L}.pdf`;else{console.log("Generating JSON...");const Ae=JSON.stringify(p,null,2);Y=new Blob([Ae],{type:"application/json"}),le=`BOM_${L}.json`}console.log("Saving file:",le);const U=await(await C.getFileHandle(le,{create:!0})).createWritable();await U.write(Y),await U.close(),console.log("BOM file saved successfully"),alert(`BOM exported successfully to ${le} in BOM directory!`)}catch(p){console.error("Failed to export BOM:",p),alert(`Failed to export BOM: ${p instanceof Error?p.message:String(p)}. See console for details.`)}},[ki,Ut,Zt,Vs,$,gu]);Tt.useEffect(()=>{Fi.current&&(clearInterval(Fi.current),Fi.current=null);const p=Er.current;if(Er.current=rr,rr&&kl){const C=kl*60*1e3;(Nl||ki)&&jl?(console.log(`Auto save: Setting up interval for ${kl} minute(s) (${C}ms)`),p||(ls.current=!0,setTimeout(()=>{Mh()},100)),Fi.current&&(clearInterval(Fi.current),Fi.current=null),Fi.current=window.setInterval(()=>{console.log("Auto save: Interval triggered, calling performAutoSave..."),console.log(`  - hasChangesSinceLastAutoSave: ${ls.current}`),console.log(`  - dirHandle: ${Ul.current?"set":"missing"}`),console.log(`  - baseName: ${uc.current||"missing"}`),Mh()},C),console.log(`Auto save: Interval set up for ${C}ms (${kl} minutes)`),console.log(`  - Auto save directory handle: ${Nl?"set":"missing"}`),console.log(`  - Project directory handle: ${ki?"set":"missing"}`),console.log(`  - Base name: ${jl||"missing"}`)):(console.warn(`Auto save: Cannot set up interval - missing directory handle (autoSaveDirHandle: ${!!Nl}, projectDirHandle: ${!!ki}) or base name (${!jl}). Disabling auto save.`),Ca(!1),Fi.current&&(clearInterval(Fi.current),Fi.current=null))}else rr||(Er.current=!1);return()=>{Fi.current&&(clearInterval(Fi.current),Fi.current=null)}},[rr,kl,Nl,jl,ki]);const Ih=X.useRef(!1),zh=X.useRef(!1),[Up,Zu]=Tt.useState(0);Tt.useEffect(()=>{const C=Object.keys(Mn.getAll()).map(L=>Mn.subscribe(L,()=>{Zu(Y=>Y+1)}));return()=>C.forEach(L=>L())},[]),Tt.useEffect(()=>{if(zh.current){console.log("Change tracking: Skipping - project is being loaded");return}if(rr&&Ih.current){Ih.current=!1,console.log("Auto save: Skipping change tracking on first run after enable (initial save handled separately)");return}ls.current=!0,to(!0),console.log("Change detected, marking as unsaved",{autoSaveEnabled:rr,topImage:!!t,bottomImage:!!s,drawingStrokesCount:pt.length,componentsTopCount:Ut.length,componentsBottomCount:Zt.length,powersCount:Dn.length,groundsCount:y.length,powerBusesCount:yn.length,projectNotesCount:xr.length,areImagesLocked:ji,areViasLocked:Ei,areTracesLocked:pr,areComponentsLocked:Hs,areGroundNodesLocked:gr,arePowerNodesLocked:li})},[t,s,pt,Ut,Zt,Dn,y,yn,xr,H,M,R,se,ji,Ei,pr,Hs,gr,li,j,rr,ee,Ce,J,W,ht,fe,zt,it,ue,Pe,De,ot,vt,Ot,Gn,ts,Wt,mo,Hn,Up]),Tt.useEffect(()=>{rr?(Ih.current=!0,console.log("Auto save: Enabled, marking first run")):Ih.current=!1},[rr]),Tt.useEffect(()=>{rr||(ls.current=!1)},[rr]);const Rc=X.useCallback(()=>!!(t||s||pt.length>0||Ut.length>0||Zt.length>0||Dn.length>0||y.length>0),[t,s,pt,Ut,Zt,Dn,y]),mu=X.useCallback(()=>{Io({visible:!0,projectName:"",locationPath:"",locationHandle:null})},[]),Hp=X.useCallback(async()=>{const p=window;if(typeof p.showDirectoryPicker=="function")try{const C=await p.showDirectoryPicker({mode:"readwrite"});Io(L=>({...L,locationHandle:C,locationPath:C.name||"Selected folder"}))}catch(C){C?.name!=="AbortError"&&(console.error("Failed to get directory:",C),alert("Failed to select location directory."))}else alert("Directory picker is not supported in this browser. Please use a modern browser like Chrome or Edge.")},[]),yu=X.useCallback(async()=>{const p=_i.projectName.trim();if(!p){alert("Please enter a project name.");return}const C=p.replace(/[^a-zA-Z0-9_-]/g,"_")||"pcb_project";if(!_i.locationHandle){alert("Please select a location for the project.");return}const L=_i.locationHandle;let Y,le;if(L.name===C)Y=L,le=L;else{le=L;try{Y=await le.getDirectoryHandle(C,{create:!0})}catch(he){console.error("Failed to create project folder:",he),alert(`Failed to create project folder "${C}". See console for details.`);return}}Od(),Io({visible:!1,projectName:"",locationPath:"",locationHandle:null}),Ia(C),qs(Y),fd(),Tr(),qr(!1),f(0);try{const{project:he,timestamp:U}=dc(),pe=`${Qu(C)}_${U}.json`,je=JSON.stringify(he,null,2),Ne=new Blob([je],{type:"application/json"}),ge=await(await Y.getFileHandle(pe,{create:!0})).createWritable();await ge.write(Ne),await ge.close(),hs(pe),console.log(`New project created: ${C}/${pe}`),nr({visible:!0,source:"new",interval:5})}catch(he){console.error("Failed to save new project:",he),alert("Failed to save new project file. See console for details.")}},[fd,dc,_i,Od,Tr,qr,f]),Hl=X.useCallback(()=>{Io({visible:!1,projectName:"",locationPath:"",locationHandle:null})},[]),qp=X.useCallback(async()=>{const p=window;if(typeof p.showDirectoryPicker=="function")try{const C=await p.showDirectoryPicker();ws(L=>({...L,locationHandle:C,locationPath:C.name||"Selected folder"}))}catch(C){C?.name!=="AbortError"&&(console.error("Failed to get directory:",C),alert("Failed to select location directory."))}else alert("Directory picker is not supported in this browser. Please use a modern browser that supports the File System Access API.")},[]),Bh=X.useCallback(async()=>{const p=os.filename.trim();if(!p){alert("Please enter a file name.");return}const L=(p.endsWith(".json")?p:`${p}.json`).replace(/[^a-zA-Z0-9_.-]/g,"_");if(!os.locationHandle){alert("Please select a location for the file.");return}const Y=os.locationHandle;try{const{project:le}=dc(),he=JSON.stringify(le,null,2),U=new Blob([he],{type:"application/json"}),pe=await(await Y.getFileHandle(L,{create:!0})).createWritable();await pe.write(U),await pe.close(),hs(L);const je=L.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_");je&&Ia(je),qs(Y),to(!1),ls.current=!1,ws({visible:!1,filename:"",locationPath:"",locationHandle:null}),Qa(null),console.log(`Project saved as: ${L} in selected directory`)}catch(le){console.error("Failed to save project:",le),alert(`Failed to save project file "${L}". See console for details.`)}},[os,dc]),Oh=X.useCallback(()=>{ws({visible:!1,filename:"",locationPath:"",locationHandle:null})},[]),Ju=X.useCallback(async()=>{ir({visible:!1}),await pd(),mu(),Pc()},[pd,mu,Pc]),Mf=X.useCallback(()=>{ir({visible:!1}),mu(),Pc()},[mu,Pc]),Fh=X.useCallback(()=>{ir({visible:!1})},[]);Tt.useEffect(()=>{if(wa.visible){setTimeout(()=>{As.current?.focus()},0);const p=C=>{C.key==="Enter"?(C.preventDefault(),Ju()):C.key==="Escape"&&(C.preventDefault(),ir({visible:!1}))};return window.addEventListener("keydown",p),()=>{window.removeEventListener("keydown",p)}}},[wa.visible,Ju]);const gd=X.useCallback(async(p,C)=>{zh.current=!0;try{if(vi(),p.toolInstances?Mn.initializeFromProject(p):Mn.initialize(),p.projectInfo&&p.projectInfo.name&&Ia(p.projectInfo.name),p.view){if(p.view.currentView&&c(p.view.currentView),p.view.viewScale!=null&&pi(p.view.viewScale),p.view.cameraWorldCenter)Si(p.view.cameraWorldCenter);else if(p.view.viewPan){const Ne=rs.current;if(Ne){const ke=(Ne.width-10)/2,ge=(Ne.height-10)/2,Se=p.view.viewScale??1,be=(ke-p.view.viewPan.x)/Se,ye=(ge-p.view.viewPan.y)/Se;Si({x:be,y:ye})}else Si({x:0,y:0})}p.view.showBothLayers!=null&&Va(p.view.showBothLayers),p.view.selectedDrawingLayer&&Kt(p.view.selectedDrawingLayer)}if(p.homeViews){const Ne={};for(const[ke,ge]of Object.entries(p.homeViews)){const Se=parseInt(ke,10),be=ge;let ye=be.pcbReferenceX,Le=be.pcbReferenceY;(ye===void 0||Le===void 0)&&(ye=be.x??0,Le=be.y??0),be.showTopImage===void 0?Ne[Se]={pcbReferenceX:ye,pcbReferenceY:Le,x:0,y:0,zoom:be.zoom,viewRotation:ti,viewFlipX:Ji,isBottomView:Sa,transparency:h,showTopImage:Ls,showBottomImage:Ml,showViasLayer:lr,showTopTracesLayer:Ns,showBottomTracesLayer:ys,showTopPadsLayer:cr,showBottomPadsLayer:Gr,showTopTestPointsLayer:fs,showBottomTestPointsLayer:vo,showTopComponents:io,showBottomComponents:Di,showPowerLayer:_a,showGroundLayer:ri,showConnectionsLayer:Cs}:Ne[Se]={...be,pcbReferenceX:ye,pcbReferenceY:Le,x:0,y:0,viewRotation:be.viewRotation??0,viewFlipX:be.viewFlipX??!1,isBottomView:be.isBottomView??!1,transparency:be.transparency??50}}Rl(Ne)}else Rl({});if(p.projectNotes&&Array.isArray(p.projectNotes)?_s(p.projectNotes):_s([]),p.traceColors&&(p.traceColors.top&&(Q(p.traceColors.top),Lt("trace",p.traceColors.top,"top")),p.traceColors.bottom&&(T(p.traceColors.bottom),Lt("trace",p.traceColors.bottom,"bottom"))),p.traceSizes){const Ne=p.traceSizes.top!=null&&p.traceSizes.top>0?p.traceSizes.top:6;let ke=p.traceSizes.bottom!=null&&p.traceSizes.bottom>0?p.traceSizes.bottom:6;ke<6&&(ke=6),Z(Ne),V(ke),kt("trace",Ne,"top"),kt("trace",ke,"bottom")}else Z(6),V(6);if(p.padColors&&(p.padColors.top&&(ae(p.padColors.top),Lt("pad",p.padColors.top,"top")),p.padColors.bottom&&(xe(p.padColors.bottom),Lt("pad",p.padColors.bottom,"bottom"))),p.padSizes){const Ne=p.padSizes.top!=null&&p.padSizes.top>0?p.padSizes.top:18,ke=p.padSizes.bottom!=null&&p.padSizes.bottom>0?p.padSizes.bottom:18;D(Ne),K(ke),kt("pad",Ne,"top"),kt("pad",ke,"bottom")}if(p.componentColors&&(p.componentColors.top&&(xt(p.componentColors.top),Lt("component",p.componentColors.top,"top")),p.componentColors.bottom&&(Nt(p.componentColors.bottom),Lt("component",p.componentColors.bottom,"bottom"))),p.componentSizes){const Ne=p.componentSizes.top!=null&&p.componentSizes.top>0?p.componentSizes.top:18,ke=p.componentSizes.bottom!=null&&p.componentSizes.bottom>0?p.componentSizes.bottom:18;Bt(Ne),qt(ke),kt("component",Ne,"top"),kt("component",ke,"bottom")}p.toolLayerDefaults?(p.toolLayerDefaults.trace&&Fr(p.toolLayerDefaults.trace),p.toolLayerDefaults.pad&&ga(p.toolLayerDefaults.pad),p.toolLayerDefaults.testPoint&&Qo(p.toolLayerDefaults.testPoint),p.toolLayerDefaults.component&&ma(p.toolLayerDefaults.component)):p.traceToolLayer&&Fr(p.traceToolLayer),p.toolSettings&&Un(Ne=>{const ke=new Map(Ne);if(p.toolSettings.trace){const Se=ke.get("trace");if(Se){const be={...Se,settings:p.toolSettings.trace},ye=new Map(Se.layerSettings);p.traceSizes&&p.traceColors&&(ye.set("top",{color:p.traceColors.top||Se.layerSettings.get("top")?.color||"#AA4499",size:p.traceSizes.top||Se.layerSettings.get("top")?.size||6}),ye.set("bottom",{color:p.traceColors.bottom||Se.layerSettings.get("bottom")?.color||"#F781BF",size:p.traceSizes.bottom||Se.layerSettings.get("bottom")?.size||6})),ke.set("trace",{...be,layerSettings:ye})}}if(p.toolSettings.via){const Se=ke.get("via");Se&&ke.set("via",{...Se,settings:p.toolSettings.via})}if(p.toolSettings.pad){const Se=ke.get("pad");if(Se){const be={...Se,settings:p.toolSettings.pad},ye=new Map(Se.layerSettings);p.padSizes&&p.padColors&&(ye.set("top",{color:p.padColors.top||Se.layerSettings.get("top")?.color||"#0072B2",size:p.padSizes.top||Se.layerSettings.get("top")?.size||18}),ye.set("bottom",{color:p.padColors.bottom||Se.layerSettings.get("bottom")?.color||"#56B4E9",size:p.padSizes.bottom||Se.layerSettings.get("bottom")?.size||18})),ke.set("pad",{...be,layerSettings:ye})}}if(p.toolSettings.component){const Se=ke.get("component");if(Se){const be={...Se,settings:p.toolSettings.component},ye=new Map(Se.layerSettings);p.componentSizes&&p.componentColors&&(ye.set("top",{color:p.componentColors.top||Se.layerSettings.get("top")?.color||"#6A3D9A",size:p.componentSizes.top||Se.layerSettings.get("top")?.size||18}),ye.set("bottom",{color:p.componentColors.bottom||Se.layerSettings.get("bottom")?.color||"#9467BD",size:p.componentSizes.bottom||Se.layerSettings.get("bottom")?.size||18})),ke.set("component",{...be,layerSettings:ye})}}if(p.testPointSizes&&p.testPointColors){Te(p.testPointColors.top||ue),Ve(p.testPointColors.bottom||Pe),et(p.testPointSizes.top||De),at(p.testPointSizes.bottom||ot);const Se=ke.get("testPoint");if(Se){const be=new Map(Se.layerSettings);be.set("top",{color:p.testPointColors.top||Se.layerSettings.get("top")?.color||"#E69F00",size:p.testPointSizes.top||Se.layerSettings.get("top")?.size||6}),be.set("bottom",{color:p.testPointColors.bottom||Se.layerSettings.get("bottom")?.color||"#F0E442",size:p.testPointSizes.bottom||Se.layerSettings.get("bottom")?.size||6}),ke.set("testPoint",{...Se,layerSettings:be})}}if(p.componentConnectionColor!==void 0&&Dt(p.componentConnectionColor),p.componentConnectionSize!==void 0&&sn(p.componentConnectionSize),p.toolSettings.ground){const Se=ke.get("ground");Se&&ke.set("ground",{...Se,settings:p.toolSettings.ground})}if(p.toolSettings.power){const Se=ke.get("power");Se&&ke.set("power",{...Se,settings:p.toolSettings.power})}if(p.toolSettings.erase){const Se=ke.get("erase");Se&&ke.set("erase",{...Se,settings:p.toolSettings.erase})}const ge=k==="draw"&&lt==="trace"?ke.get("trace"):k==="draw"&&lt==="via"?ke.get("via"):k==="draw"&&lt==="pad"?ke.get("pad"):k==="draw"&&lt==="testPoint"?ke.get("testPoint"):k==="component"?ke.get("component"):k==="power"?ke.get("power"):k==="ground"?ke.get("ground"):null;if(ge)if(k==="draw"&&lt==="trace"){const Se=Gn||"top",be=ge.layerSettings.get(Se);be?(G(be.color),F(be.size),Se==="top"?(Q(be.color),Z(be.size)):(T(be.color),V(be.size))):(G(ge.settings.color),F(ge.settings.size))}else if(k==="draw"&&lt==="pad"){const Se=xi||"top",be=ge.layerSettings.get(Se);be?(G(be.color),F(be.size),Se==="top"?(ae(be.color),D(be.size)):(xe(be.color),K(be.size))):(G(ge.settings.color),F(ge.settings.size))}else if(k==="component"){const Se=gi||"top",be=ge.layerSettings.get(Se);be?(G(be.color),F(be.size),Se==="top"?(xt(be.color),Bt(be.size)):(Nt(be.color),qt(be.size))):(G(ge.settings.color),F(ge.settings.size))}else if(k==="draw"&&lt==="testPoint"){const Se=Rn||"top",be=ge.layerSettings.get(Se);be?(G(be.color),F(be.size),Se==="top"?(Te(be.color),et(be.size)):(Ve(be.color),at(be.size))):(G(ge.settings.color),F(ge.settings.size))}else G(ge.settings.color),F(ge.settings.size);return ke});const L=async(Ne,ke)=>{if(!Ne)return null;let ge=null,Se="",be=Ne.filePath||Ne.name;if(!ke){const ye=Ne.name||"image";return alert(`Error: Cannot load image "${ye}" because no project directory is available.

Please ensure you opened the project file from its project directory. The project directory is required to access the image files stored in the images/ subdirectory.`),null}if(be)try{let ye=be;!be.startsWith("images/")&&!be.startsWith("Images/")?ye=be:be.startsWith("Images/")?ye=be.replace("Images/",""):be.startsWith("images/")&&(ye=be.replace("images/",""));let Le;try{Le=await ke.getDirectoryHandle("images")}catch{try{Le=await ke.getDirectoryHandle("Images")}catch{throw new Error("Neither 'images' nor 'Images' directory found in project folder.")}}const He=await(await Le.getFileHandle(ye)).getFile();ge=await createImageBitmap(He),Se=URL.createObjectURL(He),console.log(`Loaded image from file path: images/${ye}`),be.startsWith("images/")||(be=`images/${be.replace("Images/","")}`)}catch(ye){const Le=ye instanceof Error?ye.message:"Unknown error",Ee=Ne.name||"image",He=be.startsWith("images/")||be.startsWith("Images/")?be.replace("Images/","images/"):`images/${be}`;return alert(`Error: Failed to load image "${Ee}" from project directory.

Expected location: ${He}

This may occur if:
- The image file was moved or deleted
- The project directory structure was modified
- File permissions are insufficient

Please ensure the image file exists in the images/ subdirectory of your project folder.

Technical details: ${Le}`),null}else{const ye=Ne.name||"image";return alert(`Error: Image "${ye}" has no file path specified in the project file.

The project file is missing the image file path information. This may indicate the project file is corrupted or was created with an older version of the software.`),null}if(!ge){const ye=Ne.name||"image";return alert(`Error: Could not create image bitmap for "${ye}".

The image file may be corrupted or in an unsupported format. Please ensure the image is a valid PNG, JPEG, or other supported image format.`),null}return{url:Se,name:Ne.name??"image",width:Ne.width??ge.width,height:Ne.height??ge.height,filePath:be,x:Ne.x??0,y:Ne.y??0,scale:Ne.scale??1,rotation:Ne.rotation??0,flipX:!!Ne.flipX,flipY:!!Ne.flipY,skewX:Ne.skewX??0,skewY:Ne.skewY??0,keystoneV:Ne.keystoneV??0,keystoneH:Ne.keystoneH??0,brightness:Ne.brightness??100,contrast:Ne.contrast??100,bitmap:ge}},Y=C!==void 0?C:ki,le=await L(p.images?.top,Y),he=await L(p.images?.bottom,Y);if(n(le),o(he),p.pointIdCounter&&typeof p.pointIdCounter=="number"?xg(p.pointIdCounter):(console.warn("Project file missing pointIdCounter. Starting from 1."),xg(1)),p.locks&&(typeof p.locks.areImagesLocked=="boolean"&&Wi(p.locks.areImagesLocked),typeof p.locks.areViasLocked=="boolean"&&ks(p.locks.areViasLocked),typeof p.locks.arePadsLocked=="boolean"&&uo(p.locks.arePadsLocked),typeof p.locks.areTracesLocked=="boolean"&&ll(p.locks.areTracesLocked),typeof p.locks.areComponentsLocked=="boolean"&&ba(p.locks.areComponentsLocked),typeof p.locks.areGroundNodesLocked=="boolean"&&Ja(p.locks.areGroundNodesLocked),typeof p.locks.arePowerNodesLocked=="boolean"&&ho(p.locks.arePowerNodesLocked)),p.visibility&&(typeof p.visibility.showViasLayer=="boolean"&&Vr(p.visibility.showViasLayer),typeof p.visibility.showTopPadsLayer=="boolean"&&$r(p.visibility.showTopPadsLayer),typeof p.visibility.showBottomPadsLayer=="boolean"&&Yr(p.visibility.showBottomPadsLayer),typeof p.visibility.showTopTracesLayer=="boolean"&&Wr(p.visibility.showTopTracesLayer),typeof p.visibility.showBottomTracesLayer=="boolean"&&Ta(p.visibility.showBottomTracesLayer),typeof p.visibility.showTopComponents=="boolean"&&Ho(p.visibility.showTopComponents),typeof p.visibility.showBottomComponents=="boolean"&&ra(p.visibility.showBottomComponents),typeof p.visibility.showPowerLayer=="boolean"&&Xr(p.visibility.showPowerLayer),typeof p.visibility.showGroundLayer=="boolean"&&Ui(p.visibility.showGroundLayer),typeof p.visibility.showConnectionsLayer=="boolean"&&Li(p.visibility.showConnectionsLayer),typeof p.visibility.showTraceCornerDots=="boolean"&&Kr(p.visibility.showTraceCornerDots)),p.autoSave?(typeof p.autoSave.enabled=="boolean"&&Ca(p.autoSave.enabled),typeof p.autoSave.interval=="number"&&hl(p.autoSave.interval),typeof p.autoSave.baseName=="string"&&p.autoSave.baseName?(no(p.autoSave.baseName),uc.current=p.autoSave.baseName,p.autoSave.enabled&&!Nl&&(console.log("Auto save: Directory handle not available after page reload (expected). Auto save disabled. Use File -> Auto Save -> Enable to re-enable."),Ca(!1),hl(null))):p.autoSave.enabled&&(console.warn("Auto save was enabled in project file but base name is missing. Disabling auto save."),Ca(!1),hl(null),no(""),uc.current="")):(Ca(!1),hl(null),Jl(null),no(""),Ul.current=null,uc.current="",Fi.current&&(clearInterval(Fi.current),Fi.current=null)),p.drawing?.drawingStrokes&&Array.isArray(p.drawing.drawingStrokes)){const Ne=p.drawing.drawingStrokes.map(ke=>({...ke,points:ke.points.map(ge=>({...ge,...is(ge)}))})).filter(ke=>!(ke.type==="trace"&&ke.points.length<2));jt(Ne);for(const ke of Ne)for(const ge of ke.points)ge.id&&typeof ge.id=="number"&&sm(ge.id)}else console.warn("Project file missing drawingStrokes. Starting with empty strokes."),jt([]);if(p.drawing?.componentsTop){const Ne=p.drawing.componentsTop.map(ke=>{const ge=is({x:ke.x,y:ke.y});return{...ke,x:ge.x,y:ge.y,layer:ke.layer||"top",pinConnections:ke.pinConnections||new Array(ke.pinCount||0).fill("")}});Pi(Ne)}if(p.drawing?.componentsBottom){const Ne=p.drawing.componentsBottom.map(ke=>{const ge=is({x:ke.x,y:ke.y});return{...ke,x:ge.x,y:ge.y,layer:ke.layer||"bottom",pinConnections:ke.pinConnections||new Array(ke.pinCount||0).fill("")}});Yn(Ne)}if(p.designatorCounters&&typeof p.designatorCounters=="object"){const Ne=p.designatorCounters;qn.current={...Ne}}else qn.current={};if(typeof p.autoAssignDesignators=="boolean"&&Xn(p.autoAssignDesignators),typeof p.useGlobalDesignatorCounters=="boolean"?Mt(p.useGlobalDesignatorCounters):Mt(!1),p.drawing?.grounds){const ke=p.drawing.grounds.map(ge=>{ge.pointId||console.warn("Ground symbol missing pointId - this may cause issues");const Se=is({x:ge.x,y:ge.y});return{...ge,x:Se.x,y:Se.y}}).filter(ge=>{const Se=typeof ge.x=="number"&&typeof ge.y=="number"&&!isNaN(ge.x)&&!isNaN(ge.y)&&isFinite(ge.x)&&isFinite(ge.y);return Se||console.warn(`Filtered out invalid ground symbol at (${ge.x}, ${ge.y})`),Se});st(ke);for(const ge of ke)ge.pointId&&typeof ge.pointId=="number"&&sm(ge.pointId)}else st([]);let U;if(p.powerBuses&&Array.isArray(p.powerBuses)&&p.powerBuses.length>0?(U=p.powerBuses,Ro(U)):(U=[{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}],Ro(U)),p.groundBuses&&Array.isArray(p.groundBuses)&&p.groundBuses.length>0?ne(p.groundBuses):ne([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),p.drawing?.powers){const ke=p.drawing.powers.map(ge=>{ge.pointId||console.warn("Power symbol missing pointId - this may cause issues");const Se=is({x:ge.x,y:ge.y});return{...ge,x:Se.x,y:Se.y}}).filter(ge=>{const Se=typeof ge.x=="number"&&typeof ge.y=="number"&&!isNaN(ge.x)&&!isNaN(ge.y)&&isFinite(ge.x)&&isFinite(ge.y);return Se||console.warn(`Filtered out invalid power node at (${ge.x}, ${ge.y})`),Se});Re(ke);for(const ge of ke)ge.pointId&&typeof ge.pointId=="number"&&sm(ge.pointId)}else Re([]);let Ae=0;if(p.drawing?.drawingStrokes&&Array.isArray(p.drawing.drawingStrokes))for(const Ne of p.drawing.drawingStrokes)for(const ke of Ne.points)ke.id&&typeof ke.id=="number"&&ke.id>Ae&&(Ae=ke.id);if(p.drawing?.componentsTop&&Array.isArray(p.drawing.componentsTop)){for(const Ne of p.drawing.componentsTop)if(Ne.pinConnections&&Array.isArray(Ne.pinConnections)){for(const ke of Ne.pinConnections)if(ke&&typeof ke=="string"){const ge=parseInt(ke,10);!isNaN(ge)&&ge>Ae&&(Ae=ge)}}}if(p.drawing?.componentsBottom&&Array.isArray(p.drawing.componentsBottom)){for(const Ne of p.drawing.componentsBottom)if(Ne.pinConnections&&Array.isArray(Ne.pinConnections)){for(const ke of Ne.pinConnections)if(ke&&typeof ke=="string"){const ge=parseInt(ke,10);!isNaN(ge)&&ge>Ae&&(Ae=ge)}}}if(p.drawing?.grounds&&Array.isArray(p.drawing.grounds))for(const Ne of p.drawing.grounds)Ne.pointId&&typeof Ne.pointId=="number"&&Ne.pointId>Ae&&(Ae=Ne.pointId);if(p.drawing?.powers&&Array.isArray(p.drawing.powers))for(const Ne of p.drawing.powers)Ne.pointId&&typeof Ne.pointId=="number"&&Ne.pointId>Ae&&(Ae=Ne.pointId);const pe=Ae+1,je=im();je<pe&&(console.warn(`pointIdCounter was ${je} but max existing ID is ${Ae}. Correcting to ${pe}.`),xg(pe)),ls.current=!1,to(!1),qr(!1),setTimeout(()=>{zh.current=!1},100)}catch(L){console.error("Failed to open project",L),alert("Failed to open project file. See console for details."),zh.current=!1}},[k,lt,ki,n,o,xg,Wi,ks,uo,ll,ba,Ja,ho,Vr,$r,Yr,Wr,Ta,Ho,ra,Xr,Ui,Li,Ca,hl,Jl,no,jt,Pi,Yn,st,Ro,ne,Re,Xc,is,o5,l5,rm,Xn,Mt,vi]),$o=X.useCallback(async()=>{},[Pl]),ur=X.useCallback(async p=>{const C=Ul.current;if(!C){console.warn("Cannot load file: no directory handle");return}try{const Y=await(await C.getFileHandle(p)).getFile();if(Y.size===0){console.warn(`File ${p} is empty, skipping`);const je=Wo.current.filter(Ne=>Ne!==p);fl(je),Wo.current=je;return}const le=await Y.text();if(!le||le.trim().length===0){console.warn(`File ${p} contains no data, skipping`);const je=Wo.current.filter(Ne=>Ne!==p);fl(je),Wo.current=je;return}let he;try{he=JSON.parse(le)}catch(pe){console.error(`Failed to parse JSON from file ${p}:`,pe);const Ne=Wo.current.filter(ke=>ke!==p);fl(Ne),Wo.current=Ne,await $o();return}fd(),pi(1),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),Tn(new Set),_n(new Set),rn(new Set),mn(new Set),Pc(),await gd(he),hs(p);const Ae=Wo.current.indexOf(p);Ae>=0?(Oo(Ae),Ud.current=Ae):await $o(),ls.current=!1,to(!1)}catch(L){console.error("Failed to load file from history:",L);const Y=Wo.current;if(Y.includes(p)){const le=Y.filter(he=>he!==p);fl(le),Wo.current=le,await $o()}}},[gd,$o,Pc]),If=X.useCallback(async p=>{if(!ki){console.warn("Cannot restore file: no project directory handle"),alert("No project directory available. Please open or create a project first.");return}try{let C;try{C=await ki.getDirectoryHandle("history")}catch(U){console.error("History directory not found:",U),alert("History directory not found.");return}const Y=await(await C.getFileHandle(p)).getFile();if(Y.size===0){alert(`File ${p} is empty.`);return}const le=await Y.text();if(!le||le.trim().length===0){alert(`File ${p} contains no data.`);return}let he;try{he=JSON.parse(le)}catch(U){console.error(`Failed to parse JSON from file ${p}:`,U),alert(`Failed to parse file ${p}. It may be corrupted.`);return}fd(),pi(1),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),Tn(new Set),_n(new Set),rn(new Set),mn(new Set),Pc(),await gd(he),hs(p),ls.current=!1,console.log(`Successfully restored file: ${p}`)}catch(C){console.error("Failed to restore file from history:",C),alert(`Failed to restore file ${p}. Please try again.`)}},[ki,gd,Tn,_n,rn,mn,hs,pi,fd,Pc]);Tt.useEffect(()=>{re&&!de&&me({x:window.innerWidth/2-300,y:window.innerHeight/2-250})},[re,de]);const Vp=X.useCallback(p=>{if(!de)return;ze(!0);const C=p.clientX-de.x,L=p.clientY-de.y,Y=he=>{me({x:he.clientX-C,y:he.clientY-L})},le=()=>{ze(!1),document.removeEventListener("mousemove",Y),document.removeEventListener("mouseup",le)};document.addEventListener("mousemove",Y),document.addEventListener("mouseup",le)},[de]);X.useCallback(async()=>{const p=Ud.current,C=Wo.current;if(p>=0&&p<C.length-1){const L=p+1,Y=C[L];Y&&await ur(Y)}},[ur]),X.useCallback(async()=>{const p=Ud.current,C=Wo.current;if(p<=0||p>=C.length||C.length===0){console.warn("Cannot navigate to newer file: index is",p,"history length is",C.length);return}if(p>0&&p<C.length&&C.length>0){const L=p-1;if(L>=0&&L<C.length){const Y=C[L];Y?await ur(Y):(console.warn("No newer file found at index",L),await $o())}else console.warn("Cannot navigate to newer file: prevIndex",L,"is out of bounds")}},[ur,$o]),Tt.useEffect(()=>{Cn.current=zn},[zn]);const Qr=Tt.useRef(lt),zf=Tt.useRef(Xt);Tt.useEffect(()=>{const p=lt!==Qr.current;if(k==="draw"&&Qr.current==="trace"&&p){if(Cn.current.length>=2){pn(pt,Ut,Zt,we,Fe);const C={id:`${Date.now()}-trace-autofinalize`,points:Cn.current,color:B,size:te,layer:zf.current,type:"trace"};jt(L=>[...L,C]),zf.current==="top"?Ya(L=>[...L,C.id]):Nr(L=>[...L,C.id])}Pn([]),tn(!1)}Qr.current=lt,zf.current=Xt},[lt,Xt,k,B,te]);const Bf=Tt.useRef(k);Tt.useEffect(()=>{if(Bf.current==="draw"&&k!=="draw"&&lt==="trace"&&Cn.current.length>=2){const p={id:`${Date.now()}-trace-autofinalize`,points:Cn.current,color:B,size:te,layer:Xt,type:"trace"};jt(C=>[...C,p]),Xt==="top"?Ya(C=>[...C,p.id]):Nr(C=>[...C,p.id]),Pn([]),tn(!1)}Bf.current=k},[k,lt,B,te,Xt]);const Of=Tt.useMemo(()=>Yw,[]);Tt.useEffect(()=>{uu()},[pt]),Tt.useEffect(()=>{uu()},[Ut,Zt,y,ri]);const It=Pd>0,la=X.useCallback(async()=>{const p=window;if(typeof p.showOpenFilePicker=="function")try{const[C]=await p.showOpenFilePicker({multiple:!1}),L=await C.getFile();if(!L.name.toLowerCase().endsWith(".json")){alert("Please select a .json project file.");return}pu.current=!0,Od(),await new Promise(pe=>setTimeout(pe,0)),hs(L.name);const Y=await L.text(),le=JSON.parse(Y);pu.current=!0;let he=null;try{if(typeof C.getParent=="function")he=await C.getParent();else{console.warn("getParent() not available. Prompting user for directory access...");const pe=window;if(typeof pe.showDirectoryPicker=="function")he=await pe.showDirectoryPicker({startIn:C});else throw new Error("Directory picker not available in this browser")}if(he)try{if((await(await he.getFileHandle(L.name)).getFile()).name!==L.name)throw new Error("Directory verification failed: file name mismatch")}catch(pe){throw console.error("Directory verification failed:",pe),console.error("The selected directory might not contain the opened file"),new Error("Directory verification failed - selected directory does not contain the opened file")}qs(he),Ao.current=he}catch(pe){console.error("Failed to get directory handle from file handle:",pe)}finally{setTimeout(()=>{pu.current=!1},1e3)}const U=le.autoSave?.enabled===!0;await gd(le,he);let Ae;if(le.projectInfo?.name?Ae=le.projectInfo.name:(Ae=L.name.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_")||"pcb_project",Ia(Ae)),Vs||Ia(Ae),U&&he){const pe=Ae.replace(/\.json$/i,""),Ne=Qu(pe).replace(/[^a-zA-Z0-9_-]/g,"_");Jl(he),no(Ne),Ul.current=he,uc.current=Ne,Fi.current&&(clearInterval(Fi.current),Fi.current=null)}setTimeout(()=>{nr({visible:!0,source:"open",interval:5})},100)}catch(C){if(C?.name==="AbortError")return;console.warn("showOpenFilePicker failed, falling back to input",C),za.current?.click()}else za.current?.click()},[gd,Vs,hs,Ia,qs,nr,rr,Jl,no,Od]),hc=X.useCallback(async()=>{Da({visible:!1}),await pd(),await la()},[pd,la]),Wp=X.useCallback(async()=>{Da({visible:!1}),await la()},[la]),$p=X.useCallback(()=>{Da({visible:!1})},[]);Tt.useEffect(()=>{if(Mo.visible){setTimeout(()=>{Ni.current?.focus()},0);const p=C=>{C.key==="Enter"?(C.preventDefault(),hc()):C.key==="Escape"&&(C.preventDefault(),Da({visible:!1}))};return window.addEventListener("keydown",p),()=>{window.removeEventListener("keydown",p)}}},[Mo.visible,hc]);const Gp=X.useCallback(async()=>{Rc()?Da({visible:!0}):await la()},[Rc,la]);return l.jsxs("div",{className:"app",children:[l.jsx("header",{className:"app-header",children:l.jsx("h1",{children:" PCB Tracer (v2.8)"})}),l.jsx(f3,{openMenu:nd,setOpenMenu:Qa,isReadOnlyMode:It,currentProjectFilePath:Pl,isProjectActive:!!ki,autoSaveEnabled:rr,autoSaveInterval:kl,hasUnsavedChangesState:sd,onNewProject:mu,onOpenProject:Gp,onSaveProject:pd,onPrint:Rf,onExportBOM:Gs,bomExportFormat:$,setBomExportFormat:I,hasUnsavedChanges:Rc,setNewProjectDialog:ir,setAutoSaveDialog:Lo,topImage:t,bottomImage:s,setCurrentTool:N,resetImageTransform:Ph,areImagesLocked:ji,setAreImagesLocked:Wi,onEnterBoardDimensions:()=>Wc(!0),fileInputTopRef:Ed,fileInputBottomRef:ia,openProjectRef:za,increaseSize:br,decreaseSize:oa,brushSize:te,drawingStrokes:pt,selectedIds:ni,selectedComponentIds:an,selectedPowerIds:ai,selectedGroundIds:oi,componentsTop:Ut,componentsBottom:Zt,powers:Dn,grounds:y,powerNodeNames:oc,groundNodeNames:lc,setSetSizeDialog:Do,areViasLocked:Ei,setAreViasLocked:ks,arePadsLocked:as,setArePadsLocked:uo,areTestPointsLocked:jr,setAreTestPointsLocked:ol,areTracesLocked:pr,setAreTracesLocked:ll,areComponentsLocked:Hs,setAreComponentsLocked:ba,areGroundNodesLocked:gr,setAreGroundNodesLocked:Ja,arePowerNodesLocked:li,setArePowerNodesLocked:ho,showTraceCornerDots:Ms,setShowTraceCornerDots:Kr,setSelectedIds:Tn,setSelectedComponentIds:_n,setSelectedPowerIds:rn,setSelectedGroundIds:mn,selectAllVias:zu,selectAllTraces:bh,selectAllPads:Bu,selectAllComponents:Nc,selectDisconnectedComponents:vh,selectAllComponentConnections:wh,selectAllPowerNodes:iu,selectAllGroundNodes:su,selectPowerNodesByName:Gc,selectGroundNodesByName:Sh,setShowPowerBusManager:E,setShowGroundBusManager:_t,setShowPastMachine:oe,toolRegistry:Hn,updateToolSettings:Ga,updateToolLayerSettings:Fs,setBrushSize:F,setBrushColor:G,saveToolSettings:Ab,saveToolLayerSettings:Qh,colorPalette:Of,currentTool:k,drawingMode:lt,traceToolLayer:Gn,padToolLayer:xi,testPointToolLayer:Rn,componentToolLayer:gi,setTopTraceSize:Z,setBottomTraceSize:V,setTopPadSize:D,setBottomPadSize:K,setTopTestPointSize:et,setBottomTestPointSize:at,setTopComponentSize:Bt,setBottomComponentSize:qt,setComponentConnectionSize:sn,topTraceColor:H,bottomTraceColor:M,topPadColor:ee,bottomPadColor:Ce,topTestPointColor:ue,bottomTestPointColor:Pe,topComponentColor:ht,bottomComponentColor:fe,setTopTraceColor:Q,setBottomTraceColor:T,setTopPadColor:ae,setBottomPadColor:xe,setTopTestPointColor:Te,setBottomTestPointColor:Ve,setTopComponentColor:xt,setBottomComponentColor:Nt,setComponentConnectionColor:Dt,saveDefaultSize:kt,saveDefaultColor:Lt,menuBarRef:bo,onOpenProjectNotes:Pf,onOpenTransformImages:()=>Pr(!0),onOpenTransformAll:()=>zo(!0)}),l.jsx("div",{style:{display:"block",padding:0,margin:0,width:"100vw",height:"calc(100vh - 70px)",boxSizing:"border-box",position:"relative"},children:l.jsxs("div",{ref:qc,style:{position:"relative",width:"100%",height:"100%",margin:0,padding:0,boxSizing:"border-box",background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",borderRadius:"16px",overflow:"hidden"},children:[l.jsxs("div",{style:{position:"absolute",top:6,left:6,bottom:6,width:46,display:"flex",flexDirection:"column",gap:8,padding:"6px 3px",background:"rgba(250,250,255,0.95)",borderRadius:8,border:"1px solid #ddd",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:20},children:[l.jsxs("button",{onClick:()=>{It||hu()},onMouseDown:p=>p.currentTarget.blur(),disabled:It,title:"Select (S)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="select"?"2px solid #000":"1px solid #ddd",background:k==="select"?"#e6f0ff":"#fff",color:It?"#999":"#222",outline:"none",cursor:It?"not-allowed":"pointer",opacity:It?.5:1},children:[l.jsx(Vw,{size:14}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[l.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"S"}),l.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),l.jsxs("button",{onMouseDown:p=>{if(p.altKey&&!It){p.preventDefault(),p.stopPropagation(),Vc(!1),zl(!0);return}},onClick:p=>{!It&&!p.altKey&&(console.log("Via tool clicked"),Je(),nn("via"),N("draw"),Vr(!0))},disabled:It,title:"Draw Vias (V), Option+click for Pattern Placement",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="draw"&&lt==="via"?"2px solid #000":"1px solid #ddd",background:k==="draw"&&lt==="via"?"#e6f0ff":"#fff",color:It?"#999":"#222",cursor:It?"not-allowed":"pointer",opacity:It?.5:1},children:[l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const p=Mn.get("via").color;return l.jsxs(l.Fragment,{children:[l.jsx("circle",{cx:"12",cy:"12",r:"8",fill:"none",stroke:p,strokeWidth:"3"}),l.jsx("circle",{cx:"12",cy:"12",r:"4",fill:p})]})})()}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[l.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"V"}),l.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:Mn.get("via").size})]})]}),l.jsxs("button",{ref:Nh,onMouseDown:p=>{if(p.altKey&&!It){p.preventDefault(),p.stopPropagation(),Vc(!0),zl(!0);return}},onClick:p=>{!It&&!p.altKey&&(console.log("Pad tool clicked"),Je(),nn("pad"),N("draw"),setTimeout(()=>Ku(),0))},disabled:It,title:"Draw Pads (P), Option+click for Pattern Placement",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="draw"&&lt==="pad"?"2px solid #000":"1px solid #ddd",background:k==="draw"&&lt==="pad"?"#e6f0ff":"#fff",color:It?"#999":"#222",cursor:It?"not-allowed":"pointer",opacity:It?.5:1},children:[l.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const C=xi==="top"?"padTop":"padBottom",L=Mn.get(C).color,Y=14,le=(24-Y)/2,he=(24-Y)/2;return l.jsx("rect",{x:le,y:he,width:Y,height:Y,fill:L})})()}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[l.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"P"}),l.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{if(k==="draw"&&lt==="pad"&&ss.toolInstanceId&&(ss.toolInstanceId==="padTop"||ss.toolInstanceId==="padBottom"))return ss.size;const p=xi==="top"?"padTop":"padBottom";return Mn.get(p).size})()})]})]}),l.jsxs("button",{ref:qu,onClick:()=>{It||(console.log("Test Point tool clicked"),Je(),nn("testPoint"),N("draw"),setTimeout(()=>Eh(),0))},disabled:It,title:"Draw Test Points (Y)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="draw"&&lt==="testPoint"?"2px solid #000":"1px solid #ddd",background:k==="draw"&&lt==="testPoint"?"#e6f0ff":"#fff",color:It?"#999":"#222",cursor:It?"not-allowed":"pointer",opacity:It?.5:1},children:[l.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const C=Rn==="top"?"testPointTop":"testPointBottom",L=Mn.get(C).color,Y=14,le=12,he=12;return l.jsx("path",{d:`M ${le} ${he-Y/2} L ${le+Y/2} ${he} L ${le} ${he+Y/2} L ${le-Y/2} ${he} Z`,fill:L,stroke:"#000",strokeWidth:"1.5"})})()}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[l.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"Y"}),l.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{if(k==="draw"&&lt==="testPoint"&&ss.toolInstanceId&&(ss.toolInstanceId==="testPointTop"||ss.toolInstanceId==="testPointBottom"))return ss.size;const p=Rn==="top"?"testPointTop":"testPointBottom";return Mn.get(p).size})()})]})]}),l.jsxs("button",{ref:kh,onClick:()=>{It||(console.log("Trace tool clicked"),Je(),nn("trace"),N("draw"),setTimeout(()=>fu(),0))},disabled:It,title:"Draw Traces (T)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="draw"&&lt==="trace"?"2px solid #000":"1px solid #ddd",background:k==="draw"&&lt==="trace"?"#e6f0ff":"#fff",color:It?"#999":"#222",cursor:It?"not-allowed":"pointer",opacity:It?.5:1},children:[l.jsx($w,{size:14,color:(()=>{const C=Gn==="top"?"traceTop":"traceBottom";return Mn.get(C).color})()}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[l.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"T"}),l.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{const p=Gn==="top"?"traceTop":"traceBottom";return Mn.get(p).size})()})]})]}),l.jsxs("button",{ref:Vu,onClick:()=>{It||(console.log("Component tool clicked"),Je(),N("component"))},disabled:It,title:"Draw Component (C)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="component"?"2px solid #000":"1px solid #ddd",background:k==="component"?"#e6f0ff":"#fff",color:It?"#999":"#222",cursor:It?"not-allowed":"pointer",opacity:It?.5:1},children:[(()=>{const C=(gi||"top")==="top"?"componentTop":"componentBottom",L=Mn.get(C).color;return cc?l.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[l.jsx("rect",{x:"4",y:"4",width:"16",height:"16",fill:"rgba(255,255,255,0.9)",stroke:L,strokeWidth:"1.5"}),l.jsx("text",{x:"12",y:"14",textAnchor:"middle",fontSize:"7",fill:L,fontWeight:"bold",fontFamily:"monospace",children:(()=>{const Y=Yc?.componentDefinition?.designator??Yc?.designator;return Y?Y.length<=3?Y:Y.substring(0,3):Nm(cc)})()})]}):l.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[l.jsx("rect",{x:"5",y:"3",width:"14",height:"7",fill:L,stroke:L,strokeWidth:"0.5"}),l.jsxs("g",{stroke:L,fill:"none",strokeWidth:"1.5",children:[l.jsx("rect",{x:"5",y:"10",width:"14",height:"4",rx:"1.2"}),l.jsx("path",{d:"M7 14 v4 M10 14 v4 M13 14 v4 M16 14 v4",stroke:L})]})]})})(),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[l.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"C"}),l.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{const p=gi==="top"?"componentTop":"componentBottom";return Mn.get(p).size})()})]})]}),l.jsxs("button",{ref:Wu,onClick:()=>{It||(console.log("Power tool clicked"),Je(),ln(!1),yn.length===1?($e(yn[0].id),N("power"),ve(!1),Xr(!0)):yn.length>1?ve(!0):(ve(!0),N("power"),Xr(!0)))},disabled:It,title:"Draw Power (B)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="power"?"2px solid #000":"1px solid #ddd",background:k==="power"?"#e6f0ff":"#fff",color:It?"#999":"#222",cursor:It?"not-allowed":"pointer",opacity:It?.5:1},children:[l.jsx("span",{style:{color:(Be?yn.find(p=>p.id===Be)?.color:null)||"#ff0000",fontSize:"18px",fontWeight:"bold",lineHeight:1,flexShrink:0},children:"V"}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[l.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"B"}),l.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:Mn.get("power").size})]})]}),l.jsxs("button",{ref:du,onClick:()=>{It||(console.log("Ground tool clicked"),ve(!1),j.length===1?(ii(j[0].id),N("ground"),ln(!1),Ui(!0)):j.length>1?ln(!0):(ln(!0),N("ground"),Ui(!0)))},disabled:It,title:"Draw Ground (G)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="ground"?"2px solid #000":"1px solid #ddd",background:k==="ground"?"#e6f0ff":"#fff",color:It?"#999":"#222",cursor:It?"not-allowed":"pointer",opacity:It?.5:1},children:[l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 20","aria-hidden":"true",style:{overflow:"visible",flexShrink:0},children:l.jsxs("g",{stroke:(Ht?j.find(p=>p.id===Ht)?.color:null)||"#000000",strokeWidth:"2",strokeLinecap:"round",children:[l.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"10"}),l.jsx("line",{x1:"5",y1:"10",x2:"19",y2:"10"}),l.jsx("line",{x1:"7",y1:"13",x2:"17",y2:"13"}),l.jsx("line",{x1:"9.5",y1:"16",x2:"14.5",y2:"16"})]})}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[l.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"G"}),l.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:Mn.get("ground").size})]})]}),l.jsx("div",{style:{height:72}}),l.jsxs("button",{onClick:()=>{It||(Je(),N(p=>p==="pan"?"draw":"pan"))},disabled:It,title:"Move (H)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:6,padding:"4px 6px",borderRadius:6,border:k==="pan"?"2px solid #000":"1px solid #ddd",background:k==="pan"?"#e6f0ff":"#fff",color:It?"#999":"#222",cursor:It?"not-allowed":"pointer",opacity:It?.5:1},children:[l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:l.jsxs("g",{stroke:"#111",fill:"none",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round",children:[l.jsx("path",{d:"M8 11v-4c0-.8.6-1.3 1.3-1.3S11 6.2 11 7v4"}),l.jsx("path",{d:"M11 11V6.5c0-.8.6-1.3 1.3-1.3S14 5.7 14 6.5V11"}),l.jsx("path",{d:"M14 11V7.2c0-.8.6-1.3 1.3-1.3.7 0 1.3.5 1.3 1.3V12c1 .6 1.6 1.5 1.6 2.7A4.3 4.3 0 0 1 14 19H9.2A4.2 4.2 0 0 1 5 14.8V11c0-.6.4-1 .9-1 .6 0 1 .4 1 1v2"})]})}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[l.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"H"}),l.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),l.jsxs("button",{onClick:()=>{Je(),tc(!1),N(p=>p==="magnify"?"draw":"magnify")},title:"Magnify (M)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="magnify"?"2px solid #000":"1px solid #ddd",background:k==="magnify"?"#e6f0ff":"#fff",color:"#222",cursor:"pointer"},children:[l.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[l.jsx("circle",{cx:"10",cy:"10",r:"7.5",fill:"none",stroke:"#111",strokeWidth:"2"}),l.jsx("line",{x1:"15.5",y1:"15.5",x2:"21",y2:"21",stroke:"#111",strokeWidth:"2",strokeLinecap:"round"}),Ba?l.jsx("line",{x1:"6.5",y1:"10",x2:"13.5",y2:"10",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"}):l.jsxs(l.Fragment,{children:[l.jsx("line",{x1:"6.5",y1:"10",x2:"13.5",y2:"10",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"}),l.jsx("line",{x1:"10",y1:"6.5",x2:"10",y2:"13.5",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"})]})]}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[l.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"M"}),l.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),l.jsxs("button",{onClick:()=>{It||zo(!0)},disabled:It,title:"Change Perspective (E) - Open Change Perspective Dialog",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:dl?"2px solid #000":"1px solid #ddd",background:dl?"#e6f0ff":"#fff",color:It?"#999":"#222",cursor:It?"not-allowed":"pointer",opacity:It?.5:1},children:[l.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[l.jsx("ellipse",{cx:"12",cy:"12",rx:"9",ry:"6",fill:"none",stroke:"#111",strokeWidth:"2"}),l.jsx("circle",{cx:"12",cy:"12",r:"4",fill:"none",stroke:"#111",strokeWidth:"2"}),l.jsx("circle",{cx:"11",cy:"11",r:"1.5",fill:"#111",stroke:"none"})]}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[l.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"E"}),l.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),l.jsxs("button",{onClick:()=>{It||(Je(),N("center"),ar(!0),Js.current&&clearTimeout(Js.current),Js.current=setTimeout(()=>{ar(!1),N("select"),ya(void 0)},2e3))},disabled:It,title:"Set View (X) - Press 0-9 to Set View",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="center"?"2px solid #000":"1px solid #ddd",background:k==="center"?"#e6f0ff":"#fff",color:It?"#999":"#222",cursor:It?"not-allowed":"pointer",opacity:It?.5:1},children:[l.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[l.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"10",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),l.jsx("line",{x1:"12",y1:"14",x2:"12",y2:"22",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),l.jsx("line",{x1:"2",y1:"12",x2:"10",y2:"12",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),l.jsx("line",{x1:"14",y1:"12",x2:"22",y2:"12",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"})]}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[l.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"X"}),l.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),l.jsxs("div",{style:{position:"relative"},children:[l.jsx("button",{onClick:()=>{It||La(p=>!p)},disabled:It,title:"Color Picker",style:{width:32,height:32,display:"grid",placeItems:"center",borderRadius:6,border:"1px solid #ddd",background:"#fff",cursor:It?"not-allowed":"pointer",opacity:It?.5:1},children:l.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 16 16","aria-hidden":"true",children:[l.jsx("rect",{x:"0",y:"0",width:"3.5",height:"3.5",fill:"#9E9E9E",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"4",y:"0",width:"3.5",height:"3.5",fill:"#0072B2",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"8",y:"0",width:"3.5",height:"3.5",fill:"#56B4E9",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"12",y:"0",width:"3.5",height:"3.5",fill:"#00BFC4",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"0",y:"4",width:"3.5",height:"3.5",fill:"#6A3D9A",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"4",y:"4",width:"3.5",height:"3.5",fill:"#2CA02C",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"8",y:"4",width:"3.5",height:"3.5",fill:"#7FC97F",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"12",y:"4",width:"3.5",height:"3.5",fill:"#FF7F0E",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"0",y:"8",width:"3.5",height:"3.5",fill:"#FFD700",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"4",y:"8",width:"3.5",height:"3.5",fill:"#FF6B6B",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"8",y:"8",width:"3.5",height:"3.5",fill:"#E74C3C",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"12",y:"8",width:"3.5",height:"3.5",fill:"#FFB6C1",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"0",y:"12",width:"3.5",height:"3.5",fill:"#DDA0DD",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"4",y:"12",width:"3.5",height:"3.5",fill:"#8B4513",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"8",y:"12",width:"3.5",height:"3.5",fill:"#A0522D",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"12",y:"12",width:"3.5",height:"3.5",fill:"#FF4500",stroke:"#ccc",strokeWidth:"0.3"})]})}),id&&l.jsx("div",{ref:Ll,style:{position:"absolute",left:42,top:0,padding:8,background:"#fff",border:"1px solid #ddd",borderRadius:6,boxShadow:"0 8px 18px rgba(0,0,0,0.18)",zIndex:50},children:l.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(8, 22px)",gap:4},children:Of.map(p=>l.jsx("div",{onClick:()=>{G(p),La(!1);try{let L=null;k==="draw"&&lt==="via"?L="via":k==="draw"&&lt==="pad"?L=(xi||"top")==="bottom"?"padBottom":"padTop":k==="draw"&&lt==="testPoint"?L=(Rn||"top")==="bottom"?"testPointBottom":"testPointTop":k==="draw"&&lt==="trace"?L=(Gn||"top")==="bottom"?"traceBottom":"traceTop":k==="component"?L=(gi||"top")==="bottom"?"componentBottom":"componentTop":k==="power"?L="power":k==="ground"&&(L="ground"),L&&Mn.setColor(L,p)}catch(L){console.error("Error updating tool instance color:",L)}const C=il(Hn);if(C)if(k==="draw"&&lt==="trace"){const L=Gn||"top",le=C.layerSettings.get(L)?.size||C.settings.size,he={color:p,size:le};Fs(C.id,L,he),Qh(C.id),L==="top"?(Q(p),Lt("trace",p,"top")):(T(p),Lt("trace",p,"bottom"))}else if(k==="draw"&&lt==="pad"){const L=xi||"top",le=C.layerSettings.get(L)?.size||C.settings.size,he={color:p,size:le};Fs(C.id,L,he),Qh(C.id),L==="top"?(ae(p),Lt("pad",p,"top")):(xe(p),Lt("pad",p,"bottom"))}else if(k==="draw"&&lt==="testPoint"){const L=Rn||"top",le=C.layerSettings.get(L)?.size||C.settings.size,he={color:p,size:le};Fs(C.id,L,he),Qh(C.id),L==="top"?(Te(p),Lt("testPoint",p,"top")):(Ve(p),Lt("testPoint",p,"bottom"))}else if(k==="component"){const L=gi||"top",le=C.layerSettings.get(L)?.size||C.settings.size,he={color:p,size:le};Fs(C.id,L,he),Qh(C.id),L==="top"?(xt(p),Lt("component",p,"top")):(Nt(p),Lt("component",p,"bottom"))}else{const L={...C.settings,color:p};Ga(C.id,L),Ab(C.id,p,C.settings.size),k==="draw"&&lt==="via"&&Lt("via",p)}Lt("brush",p),ni.size>0&&jt(L=>L.map(Y=>ni.has(Y.id)?(Y.type==="via"?(Lt("via",p),Un(le=>{const he=new Map(le),U=he.get("via");return U&&he.set("via",{...U,settings:{...U.settings,color:p}}),he})):Y.type==="pad"?(Lt("pad",p),Un(le=>{const he=new Map(le),U=he.get("pad");return U&&he.set("pad",{...U,settings:{...U.settings,color:p}}),he})):Y.type==="trace"&&Lt("trace",p,Y.layer),{...Y,color:p}):Y)),an.size>0&&(Lt("component",p),Pi(L=>L.map(Y=>an.has(Y.id)?{...Y,color:p}:Y)),Yn(L=>L.map(Y=>an.has(Y.id)?{...Y,color:p}:Y))),ai.size>0&&Re(L=>L.map(Y=>ai.has(Y.id)?{...Y,color:p}:Y)),oi.size>0&&st(L=>L.map(Y=>oi.has(Y.id)?{...Y,color:p}:Y))},title:p,style:{width:22,height:22,backgroundColor:p,border:p===B?"2px solid #333":"1px solid #ccc",cursor:"pointer"}},p))})})]})]}),k==="draw"&&lt==="trace"&&Fl&&l.jsxs("div",{ref:ud,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[l.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[l.jsx("input",{type:"radio",name:"traceToolLayer",checked:Gn==="top",onChange:()=>{console.log("Trace tool Top clicked"),Pa.current="top",Fr("top"),Kt("top"),G(H),F(R),Un(p=>{const C=new Map(p),L=C.get("trace");return L&&C.set("trace",{...L,settings:{color:H,size:R}}),C}),Id(!1),or(!0),Wr(!0)}}),l.jsx("span",{children:"Top"})]}),l.jsxs("label",{className:"radio-label",children:[l.jsx("input",{type:"radio",name:"traceToolLayer",checked:Gn==="bottom",onChange:()=>{console.log("Trace tool Bottom clicked"),Pa.current="bottom",Fr("bottom"),Kt("bottom"),G(M),F(se),Un(p=>{const C=new Map(p),L=C.get("trace");return L&&C.set("trace",{...L,settings:{color:M,size:se}}),C}),Id(!1),mr(!0),Ta(!0)}}),l.jsx("span",{children:"Bottom"})]})]}),k==="draw"&&lt==="pad"&&Ah&&l.jsxs("div",{ref:ou,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[l.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[l.jsx("input",{type:"radio",name:"padToolLayer",checked:xi==="top",onChange:()=>{console.log("Pad tool Top clicked"),el.current="top",ga("top"),Kt("top");const p=Mn.get("padTop");G(p.color),F(p.size),Un(C=>{const L=new Map(C),Y=L.get("pad");return Y&&L.set("pad",{...Y,settings:{color:p.color,size:p.size}}),L}),ru(!1),or(!0),$r(!0)}}),l.jsx("span",{children:"Top"})]}),l.jsxs("label",{className:"radio-label",children:[l.jsx("input",{type:"radio",name:"padToolLayer",checked:xi==="bottom",onChange:()=>{console.log("Pad tool Bottom clicked"),el.current="bottom",ga("bottom"),Kt("bottom");const p=Mn.get("padBottom");G(p.color),F(p.size),Un(C=>{const L=new Map(C),Y=L.get("pad");return Y&&L.set("pad",{...Y,settings:{color:p.color,size:p.size}}),L}),ru(!1),mr(!0),Yr(!0)}}),l.jsx("span",{children:"Bottom"})]})]}),k==="draw"&&lt==="testPoint"&&Ch&&l.jsxs("div",{ref:lu,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[l.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[l.jsx("input",{type:"radio",name:"testPointToolLayer",checked:Rn==="top",onChange:()=>{console.log("Test Point tool Top clicked"),tl.current="top",Qo("top"),Kt("top"),G(ue),F(De),Un(p=>{const C=new Map(p),L=C.get("testPoint");return L&&C.set("testPoint",{...L,settings:{color:ue,size:De}}),C}),au(!1),or(!0),Uo(!0)}}),l.jsx("span",{children:"Top"})]}),l.jsxs("label",{className:"radio-label",children:[l.jsx("input",{type:"radio",name:"testPointToolLayer",checked:Rn==="bottom",onChange:()=>{console.log("Test Point tool Bottom clicked"),tl.current="bottom",Qo("bottom"),Kt("bottom"),G(Pe),F(ot),Un(p=>{const C=new Map(p),L=C.get("testPoint");return L&&C.set("testPoint",{...L,settings:{color:Pe,size:ot}}),C}),au(!1),mr(!0),sc(!0)}}),l.jsx("span",{children:"Bottom"})]})]}),Ke&&l.jsxs("div",{ref:cu,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25,minWidth:"200px"},children:[l.jsx("div",{style:{marginBottom:"4px",fontWeight:600,fontSize:"12px",color:"#333"},children:"Select Power Bus:"}),yn.length===0?l.jsx("div",{style:{padding:"8px",color:"#666",fontSize:"12px"},children:"No power buses defined. Use Tools  Manage Power Buses to add one."}):[...yn].sort((p,C)=>{const L=he=>{const U=he.match(/([+-]?)(\d+\.?\d*)/);if(U){const Ae=U[1]||"+",pe=parseFloat(U[2]);return{absValue:Math.abs(pe),isNegative:Ae==="-",original:he}}return{absValue:1/0,isNegative:!1,original:he}},Y=L(p.voltage),le=L(C.voltage);return Y.absValue!==le.absValue?Y.absValue-le.absValue:Y.isNegative!==le.isNegative?Y.isNegative?-1:1:0}).map(p=>l.jsx("button",{onClick:C=>{C.preventDefault(),C.stopPropagation(),$e(p.id),k!=="power"&&(Je(),N("power"),Xr(!0)),ve(!1)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#222"},children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[l.jsx("div",{style:{width:16,height:16,borderRadius:"50%",background:p.color,border:"1px solid #ccc"}}),l.jsxs("div",{children:[l.jsx("div",{style:{fontWeight:600,fontSize:"13px"},children:p.name}),l.jsx("div",{style:{fontSize:"11px",color:"#666"},children:p.voltage})]})]})},p.id)),l.jsx("div",{style:{height:1,background:"#ddd",margin:"4px 0"}}),l.jsx("button",{onClick:p=>{p.preventDefault(),p.stopPropagation(),ve(!1),E(!0)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"11px"},children:"Manage Power Buses"}),l.jsx("button",{onClick:p=>{p.preventDefault(),p.stopPropagation(),ve(!1),$e(null),N("select")},style:{display:"block",width:"100%",textAlign:"center",padding:"4px 6px",marginTop:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#666",fontSize:"11px"},children:"Cancel"})]}),$t&&l.jsxs("div",{ref:Fu,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25,minWidth:"200px"},children:[l.jsx("div",{style:{marginBottom:"4px",fontWeight:600,fontSize:"12px",color:"#333"},children:"Select Ground Bus:"}),j.length===0?l.jsx("div",{style:{padding:"8px",color:"#666",fontSize:"12px"},children:"No ground buses defined. Use Tools  Manage Ground Buses to add one."}):[...j].sort((p,C)=>p.name.localeCompare(C.name)).map(p=>{const C=p.id==="groundbus-earth",L=Ht===p.id;return l.jsx("button",{onClick:Y=>{Y.preventDefault(),Y.stopPropagation(),ii(p.id),k!=="ground"&&(Je(),N("ground"),Ui(!0)),ln(!1)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:L?"#e0e0e0":"#f5f5f5",border:L?"2px solid #000":"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#222"},children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[l.jsx("div",{style:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:C?l.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",style:{display:"block"},children:[l.jsx("line",{x1:"10",y1:"2",x2:"10",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),l.jsx("line",{x1:"4",y1:"10",x2:"16",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),l.jsx("line",{x1:"5",y1:"12.5",x2:"15",y2:"12.5",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),l.jsx("line",{x1:"6",y1:"15",x2:"14",y2:"15",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"})]}):l.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",style:{display:"block"},children:[l.jsx("circle",{cx:"10",cy:"10",r:"6",fill:"none",stroke:"#000",strokeWidth:"2"}),l.jsx("line",{x1:"10",y1:"2",x2:"10",y2:"18",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),l.jsx("line",{x1:"2",y1:"10",x2:"18",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"})]})}),l.jsx("div",{children:l.jsx("div",{style:{fontWeight:600,fontSize:"13px"},children:p.name})})]})},p.id)}),l.jsx("div",{style:{height:1,background:"#ddd",margin:"4px 0"}}),l.jsx("button",{onClick:p=>{p.preventDefault(),p.stopPropagation(),ln(!1),_t(!0)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"11px"},children:"Manage Ground Buses"}),l.jsx("button",{onClick:p=>{p.preventDefault(),p.stopPropagation(),ln(!1),ii(null),N("select")},style:{display:"block",width:"100%",textAlign:"center",padding:"4px 6px",marginTop:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#666",fontSize:"11px"},children:"Cancel"})]}),l.jsxs("div",{style:{position:"absolute",top:6,left:60,bottom:6,width:168,padding:6,display:"flex",flexDirection:"column",gap:2,background:"rgba(250,250,255,0.95)",borderRadius:8,border:"1px solid #ddd",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:3},children:[l.jsx("div",{style:{fontSize:11,fontWeight:700,color:"#333",marginBottom:2},children:"Layers"}),l.jsxs("div",{onClick:()=>Kt("top"),title:"Top layer",style:{cursor:"pointer",padding:2,borderRadius:4,border:Qt==="top"?"2px solid #0b5fff":"1px solid #ddd",background:"#fff"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:2},children:[l.jsx("div",{style:{fontSize:10,color:"#444",fontWeight:600},children:"Top Image"}),l.jsx("label",{className:"radio-label",style:{margin:0},children:l.jsx("input",{type:"checkbox",checked:Ls,onChange:p=>or(p.target.checked)})})]}),l.jsx("canvas",{ref:ic,width:60,height:40,style:{width:"60px",height:"40px"}})]}),l.jsxs("div",{onClick:()=>Kt("bottom"),title:"Bottom layer",style:{cursor:"pointer",padding:2,borderRadius:4,border:Qt==="bottom"?"2px solid #0b5fff":"1px solid #ddd",background:"#fff"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:2},children:[l.jsx("div",{style:{fontSize:10,color:"#444",fontWeight:600},children:"Bottom Image"}),l.jsx("label",{className:"radio-label",style:{margin:0},children:l.jsx("input",{type:"checkbox",checked:Ml,onChange:p=>mr(p.target.checked)})})]}),l.jsx("canvas",{ref:Qd,width:60,height:40,style:{width:"60px",height:"40px"}})]}),l.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),l.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",checked:lr,onChange:p=>Vr(p.target.checked)}),l.jsx("span",{children:"Vias"})]}),l.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),l.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",checked:Ns,onChange:p=>Wr(p.target.checked)}),l.jsx("span",{children:"Traces (Top)"})]}),l.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",checked:io,onChange:p=>Ho(p.target.checked)}),l.jsx("span",{children:"Components (Top)"})]}),l.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",checked:cr,onChange:p=>$r(p.target.checked)}),l.jsx("span",{children:"Pads (Top)"})]}),l.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",checked:fs,onChange:p=>Uo(p.target.checked)}),l.jsx("span",{children:"Test Points (Top)"})]}),l.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),l.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",checked:ys,onChange:p=>Ta(p.target.checked)}),l.jsx("span",{children:"Traces (Bottom)"})]}),l.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",checked:Di,onChange:p=>ra(p.target.checked)}),l.jsx("span",{children:"Components (Bottom)"})]}),l.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",checked:Gr,onChange:p=>Yr(p.target.checked)}),l.jsx("span",{children:"Pads (Bottom)"})]}),l.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",checked:vo,onChange:p=>sc(p.target.checked)}),l.jsx("span",{children:"Test Points (Bottom)"})]}),l.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),l.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",checked:_a,onChange:p=>Xr(p.target.checked)}),l.jsx("span",{children:"Power"})]}),l.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",checked:ri,onChange:p=>Ui(p.target.checked)}),l.jsx("span",{children:"Ground"})]}),l.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",checked:Cs,onChange:p=>Li(p.target.checked)}),l.jsx("span",{children:"Connections"})]}),l.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),l.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",checked:lr&&cr&&Gr&&fs&&vo&&Ns&&ys&&io&&Di&&_a&&ri&&Cs,onChange:p=>{const C=p.target.checked;Vr(C),$r(C),Yr(C),Uo(C),sc(C),Wr(C),Ta(C),Ho(C),ra(C),Xr(C),Ui(C),Li(C)}}),l.jsx("span",{style:{fontWeight:600,fontSize:11},children:"Select All Layers"})]}),l.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),l.jsxs("div",{style:{marginTop:6},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[l.jsxs("label",{style:{fontSize:10,color:"#333"},children:["Transparency: ",h,"%"]}),l.jsxs("label",{className:"radio-label",style:{margin:0},children:[l.jsx("input",{type:"checkbox",checked:m,onChange:p=>{const C=p.target.checked;C?(or(!0),mr(!0)):(f(50),N("select")),b(C)}}),l.jsx("span",{style:{marginLeft:6,fontSize:10},children:"Cycle"})]})]}),l.jsx("input",{type:"range",min:"0",max:"100",value:h,onChange:p=>f(Number(p.target.value)),onDoubleClick:()=>Ef("transparency"),className:"slider",style:{width:"100%",marginTop:3}}),m&&l.jsxs("div",{style:{marginTop:6},children:[l.jsxs("label",{style:{fontSize:10,color:"#333"},children:["Cycle Speed: ",(S/1e3).toFixed(1),"s"]}),l.jsx("input",{type:"range",min:"500",max:"8000",step:"100",value:8500-S,onChange:p=>v(8500-Number(p.target.value)),onDoubleClick:()=>v(2e3),className:"slider",style:{width:"100%",marginTop:3}})]})]})]}),l.jsx(p3,{visible:!t&&!s,canvasSize:Dl,canvasPosition:{left:244,top:6}}),l.jsx("canvas",{ref:rs,width:Dl.width,height:Dl.height,tabIndex:0,onMouseDown:zd,onMouseMove:zp,onMouseUp:jh,onMouseLeave:jh,onWheel:Mp,onDoubleClick:Ip,className:`pcb-canvas ${k==="transform"?"transform-cursor":k==="draw"?"draw-cursor":k==="erase"?"erase-cursor":"default-cursor"}`,style:{position:"absolute",left:"244px",top:"6px",...bc?{cursor:bc}:k==="pan"?{cursor:pl?"grabbing":"grab"}:{},width:`${Dl.width}px`,height:`${Dl.height}px`,maxHeight:"none",aspectRatio:"auto",border:"none"}}),Ma&&l.jsxs("div",{style:{position:"absolute",left:`${244+Dl.width-120}px`,top:`${6+Dl.height+4}px`,fontSize:"11px",fontFamily:"monospace",color:"#333",backgroundColor:"rgba(255, 255, 255, 0.9)",padding:"2px 6px",borderRadius:"3px",border:"1px solid #ccc",pointerEvents:"none",zIndex:1e3},children:["(",Ma.x.toFixed(1),"mm, ",Ma.y.toFixed(1),"mm)"]}),l.jsx(AT,{componentEditor:Ur,setComponentEditor:Ka,componentsTop:Ut,componentsBottom:Zt,setComponentsTop:Pi,setComponentsBottom:Yn,connectingPin:Zs,setConnectingPin:rl,componentDialogPosition:Ra,setComponentDialogPosition:Za,isDraggingDialog:al,setIsDraggingDialog:vc,dialogDragOffset:Kl,setDialogDragOffset:Cl,areComponentsLocked:Hs,setSelectedComponentIds:_n,setNotesDialogVisible:mi,componentDefinition:Ur?(()=>{const p=Ut.find(C=>C.id===Ur.id)||Zt.find(C=>C.id===Ur.id);return p?_d(p):void 0})():void 0}),Rr&&Oa&&(()=>{const p=Rr.component,C=Rr.layer;if(!p)return null;const L=p.componentType||"Component",Y=p.componentType==="IntegratedCircuit"&&"icType"in p?p.icType:null,le=dd(p),he=_d(p),U=he?.category==="Semiconductors",Ae=p?.pinNames,pe=he?.properties?.pinNames,je=8,Ne=8,ke=200,ge=150,Se=10;let be=Rr.x+je,ye=Rr.y+Ne;return be+ke+Se>window.innerWidth&&(be=Rr.x-ke-je),ye+ge+Se>window.innerHeight&&(ye=Rr.y-ge-Ne),be=Math.max(Se,Math.min(be,window.innerWidth-ke-Se)),ye=Math.max(Se,Math.min(ye,window.innerHeight-ge-Se)),l.jsxs("div",{style:{position:"fixed",left:`${be}px`,top:`${ye}px`,background:"rgba(0, 0, 0, 0.85)",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:"12px",lineHeight:"1.4",zIndex:1e4,pointerEvents:"none",width:"max-content",maxWidth:"400px",minWidth:"150px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)",wordWrap:"break-word",overflowWrap:"break-word"},children:[l.jsx("div",{style:{fontWeight:600,marginBottom:"4px"},children:yc(L)}),l.jsxs("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:["Layer: ",C==="top"?"Top":"Bottom"]}),Y&&l.jsxs("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:["IC Type: ",Y]}),le.length>0&&l.jsx("div",{style:{marginBottom:"4px"},children:le.map((Le,Ee)=>l.jsx("div",{style:{color:"#e0e0e0",fontSize:"11px",marginBottom:"2px"},children:Le},Ee))}),p.description&&l.jsx("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:p.description}),p.notes&&l.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid rgba(255,255,255,0.2)",fontSize:"11px",color:"#d0d0d0",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:p.notes}),U&&p.pinCount>0&&(()=>{const Le=Array.from({length:p.pinCount},(Ee,He)=>{const ct=p.pinConnections&&p.pinConnections.length>He?p.pinConnections[He]:"",ft=Ae&&He<Ae.length?Ae[He]:"",At=pe&&He<pe.length?pe[He]:"",nt=At==="CHIP_DEPENDENT",Ft=ft&&ft.trim()!==""?ft:nt?"":At;return{pin:He+1,name:Ft||"-",nodeId:ct||"-"}});return l.jsxs("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid rgba(255,255,255,0.2)"},children:[l.jsx("div",{style:{fontSize:"11px",fontWeight:600,marginBottom:"4px",color:"#fff"},children:"Pin Connections:"}),l.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px"},children:[l.jsx("thead",{children:l.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.3)"},children:[l.jsx("th",{style:{textAlign:"left",padding:"2px 6px",fontWeight:600,color:"#fff"},children:"Pin"}),l.jsx("th",{style:{textAlign:"left",padding:"2px 6px",fontWeight:600,color:"#fff"},children:"Name"}),l.jsx("th",{style:{textAlign:"left",padding:"2px 6px",fontWeight:600,color:"#fff"},children:"Node ID"})]})}),l.jsx("tbody",{children:Le.map((Ee,He)=>l.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[l.jsx("td",{style:{padding:"2px 6px",color:"#e0e0e0",fontFamily:"monospace"},children:Ee.pin}),l.jsx("td",{style:{padding:"2px 6px",color:"#e0e0e0",fontStyle:Ee.name!=="-"?"italic":"normal"},children:Ee.name}),l.jsx("td",{style:{padding:"2px 6px",color:"#e0e0e0",fontFamily:"monospace"},children:Ee.nodeId})]},He))})]})]})})()]})})(),od&&Oa&&(()=>{const p=od.stroke;return p.notes?l.jsxs("div",{style:{position:"fixed",left:`${od.x+10}px`,top:`${od.y+10}px`,background:"rgba(0, 0, 0, 0.85)",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:"12px",lineHeight:"1.4",zIndex:1e4,pointerEvents:"none",width:"max-content",maxWidth:"400px",minWidth:"150px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)",wordWrap:"break-word",overflowWrap:"break-word"},children:[l.jsx("div",{style:{fontWeight:600,marginBottom:"4px"},children:"Test Point"}),l.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid rgba(255,255,255,0.2)",fontSize:"11px",color:"#d0d0d0",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:p.notes})]}):null})(),yt&&yt.visible&&(()=>{if(!Dn.find(L=>L.id===yt.id))return null;const C=yn.find(L=>L.id===yt.powerBusId);return l.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#fff",border:"1px solid #0b5fff",borderRadius:4,padding:"6px",boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"175px",maxWidth:"250px",maxHeight:"40vh",overflowY:"auto",pointerEvents:"auto"},children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"5px"},children:[l.jsx("h3",{style:{margin:0,fontSize:"12px",color:"#333",fontWeight:600},children:"Power Properties"}),l.jsx("button",{onClick:()=>Gt(null),style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#666",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[l.jsxs("div",{children:[l.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Power Bus:"}),l.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:C?`${C.name} (${C.voltage})`:"Unknown"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:`power-layer-${yt.id}`,style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Layer:"}),l.jsxs("select",{id:`power-layer-${yt.id}`,name:`power-layer-${yt.id}`,value:yt.layer,onChange:L=>Gt({...yt,layer:L.target.value}),disabled:li,style:{width:"100%",padding:"2px 3px",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",opacity:li?.6:1},children:[l.jsx("option",{value:"top",children:"Top"}),l.jsx("option",{value:"bottom",children:"Bottom"})]})]}),l.jsxs("div",{children:[l.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"X:"}),l.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:yt.x.toFixed(2)})]}),l.jsxs("div",{children:[l.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Y:"}),l.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:yt.y.toFixed(2)})]})]}),l.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"3px",marginTop:"6px"},children:[l.jsx("button",{onClick:()=>Gt(null),style:{padding:"2px 5px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,cursor:"pointer",fontSize:"10px",color:"#333"},children:"Cancel"}),l.jsx("button",{onClick:()=>{li||(Re(L=>L.map(Y=>Y.id===yt.id?{...Y,layer:yt.layer}:Y)),Gt(null))},disabled:li,style:{padding:"2px 5px",background:li?"#f5f5f5":"#0b5fff",color:li?"#999":"#fff",border:"1px solid #ddd",borderRadius:2,cursor:li?"not-allowed":"pointer",fontSize:"10px"},children:"Save"})]})]})})(),!t&&!s&&l.jsx("div",{className:"placeholder"})]})}),l.jsx(jT,{visible:A,onClose:()=>E(!1),powerBuses:yn,setPowerBuses:Ro,editingPowerBusId:O,setEditingPowerBusId:ie,powers:Dn}),l.jsx(PT,{visible:mt,onClose:()=>_t(!1),groundBuses:j,setGroundBuses:ne,editingGroundBusId:wt,setEditingGroundBusId:on,grounds:y}),l.jsx(MT,{visible:re,projectDirHandle:ki,onClose:()=>{oe(!1),me(void 0)},onRestore:If,position:de,isDragging:_e,onDragStart:Vp}),l.jsx(ET,{visible:Ws,onClose:()=>En(!1),autoAssignDesignators:ts,setAutoAssignDesignators:Xn,useGlobalDesignatorCounters:Wt,setUseGlobalDesignatorCounters:Mt}),l.jsx("input",{ref:Ed,type:"file",accept:".png,.jpg,.jpeg,image/png,image/jpeg",style:{display:"none"},onChange:p=>{const C=p.target.files?.[0];C&&kf(C,"top"),p.target.value=""}}),l.jsx("input",{ref:ia,type:"file",accept:".png,.jpg,.jpeg,image/png,image/jpeg",style:{display:"none"},onChange:p=>{const C=p.target.files?.[0];C&&kf(C,"bottom"),p.target.value=""}}),l.jsx("input",{ref:za,type:"file",accept:".json,application/json",style:{display:"none"},onChange:async p=>{const C=p.target.files?.[0];if(C)try{hs(C.name);const L=await C.text(),Y=JSON.parse(L);await gd(Y);let le;Y.projectInfo?.name?le=Y.projectInfo.name:(le=C.name.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_")||"pcb_project",Ia(le)),Vs||Ia(le),setTimeout(()=>{nr({visible:!0,source:"open",interval:5})},100)}catch(L){console.error("Failed to open project",L),alert("Failed to open project file. See console for details.")}p.target.value=""}}),l.jsx(m3,{visible:eo.visible,selectedIds:ni,selectedComponentIds:an,selectedPowerIds:ai,selectedGroundIds:oi,drawingStrokes:pt,componentsTop:Ut,componentsBottom:Zt,powers:Dn,grounds:y,powerBuses:yn,onClose:()=>{cl({visible:!1,text:""})},setComponentsTop:Pi,setComponentsBottom:Yn,determineViaType:So,determinePadType:Jr,determineTestPointType:ml,onFindComponent:$c,onFindStroke:nu,onFindPower:Md,onFindGround:Ol,onOpenNotesDialog:()=>mi(!0),position:Gi,isDragging:Mi,onDragStart:p=>{Gi&&(yr({x:p.clientX-Gi.x,y:p.clientY-Gi.y}),Is(!0),p.preventDefault())}}),l.jsx(y3,{visible:js,selectedIds:ni,selectedComponentIds:an,selectedPowerIds:ai,selectedGroundIds:oi,drawingStrokes:pt,componentsTop:Ut,componentsBottom:Zt,powers:Dn,grounds:y,powerBuses:yn,onClose:()=>{mi(!1)},setComponentsTop:Pi,setComponentsBottom:Yn,setDrawingStrokes:jt,setPowerSymbols:Re,setGroundSymbols:st,determineViaType:So,determinePadType:Jr,determineTestPointType:ml,position:Ts,isDragging:er,onDragStart:p=>{Ts&&(zi({x:p.clientX-Ts.x,y:p.clientY-Ts.y}),dr(!0),p.preventDefault())}}),l.jsx(x3,{visible:wn,projectNotes:xr,setProjectNotes:_s,onClose:()=>{Sn(!1)},position:Ai,isDragging:so,onDragStart:p=>{Ai?(Il({x:p.clientX-Ai.x,y:p.clientY-Ai.y}),aa(!0),p.preventDefault()):(Zr({x:p.clientX-300,y:p.clientY-200}),Il({x:300,y:200}),aa(!0),p.preventDefault())}}),l.jsx(Zb,{visible:wa.visible,title:"New Project",message:"You have unsaved changes. Do you want to save your project before creating a new one?",onYes:Ju,onNo:Mf,onCancel:Fh,yesButtonRef:As}),l.jsx(Zb,{visible:Mo.visible,title:"Open Project",message:"You have unsaved changes. Do you want to save your project before opening another one?",onYes:hc,onNo:Wp,onCancel:$p,yesButtonRef:Ni}),_i.visible&&l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10002},onClick:p=>{p.target===p.currentTarget&&Hl()},children:l.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:p=>p.stopPropagation(),children:[l.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"New Project"}),l.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Project Name:"}),l.jsx("input",{ref:Fa,type:"text",value:_i.projectName,onChange:p=>{Io(C=>({...C,projectName:p.target.value}))},onKeyDown:p=>{p.key==="Enter"?(p.preventDefault(),yu()):p.key==="Escape"&&(p.preventDefault(),Hl())},style:{width:"100%",padding:"8px 12px",marginBottom:"8px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},placeholder:"e.g., my_pcb_project",autoFocus:!0}),_i.projectName&&(()=>{const p=_i.projectName.match(/[^a-zA-Z0-9_-]/g);if(p){const C=[...new Set(p)];return l.jsxs("div",{style:{marginBottom:"12px",padding:"6px 10px",background:"#3a1f1f",border:"1px solid #a44",borderRadius:4,fontSize:"12px",color:"#ffaaaa"},children:["Invalid characters: ",C.map(L=>`"${L}"`).join(", "),". Only letters, numbers, underscore (_), and hyphen (-) are allowed."]})}return null})(),l.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Location:"}),l.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[l.jsx("input",{type:"text",value:_i.locationPath||"Not selected",readOnly:!0,style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:_i.locationPath?"#f2f2f2":"#888",fontSize:"14px",cursor:"not-allowed"},placeholder:"Select a location..."}),l.jsx("button",{onClick:Hp,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500,whiteSpace:"nowrap"},children:"Browse..."})]}),_i.projectName&&_i.locationPath&&l.jsxs("div",{style:{marginBottom:"20px",padding:"8px 12px",background:"#1a1a1f",border:"1px solid #333",borderRadius:6,fontSize:"12px",color:"#aaa",fontFamily:"monospace"},children:[l.jsx("div",{style:{marginBottom:"4px",color:"#888"},children:"Project will be created at:"}),l.jsx("div",{style:{color:"#4CAF50"},children:(()=>{if(!_i.projectName||!_i.locationPath)return"";const C=_i.projectName.trim().replace(/[^a-zA-Z0-9_-]/g,"_")||"pcb_project",L=`${C}.json`;return _i.locationPath===C?`${_i.locationPath}/${L}`:`${_i.locationPath}/${C}/${L}`})()})]}),l.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[l.jsx("button",{onClick:Hl,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),l.jsx("button",{onClick:yu,disabled:!_i.projectName.trim()||!_i.locationHandle,style:{padding:"8px 16px",background:!_i.projectName.trim()||!_i.locationHandle?"#555":"#4CAF50",color:"#fff",border:"1px solid "+(!_i.projectName.trim()||!_i.locationHandle?"#666":"#45a049"),borderRadius:6,cursor:!_i.projectName.trim()||!_i.locationHandle?"not-allowed":"pointer",fontSize:"14px",fontWeight:600,opacity:!_i.projectName.trim()||!_i.locationHandle?.6:1},children:"Create"})]})]})}),os.visible&&l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10002},onClick:p=>{p.target===p.currentTarget&&Oh()},children:l.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:p=>p.stopPropagation(),children:[l.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Save As"}),l.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"File Name:"}),l.jsx("input",{ref:Qs,type:"text",value:os.filename,onChange:p=>{ws(C=>({...C,filename:p.target.value}))},onKeyDown:p=>{p.key==="Enter"?(p.preventDefault(),Bh()):p.key==="Escape"&&(p.preventDefault(),Oh())},style:{width:"100%",padding:"8px 12px",marginBottom:"8px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},placeholder:"e.g., my_project.json",autoFocus:!0}),l.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Location:"}),l.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[l.jsx("input",{type:"text",value:os.locationPath||"Not selected",readOnly:!0,style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:os.locationPath?"#f2f2f2":"#888",fontSize:"14px",cursor:"not-allowed"},placeholder:"Select a location..."}),l.jsx("button",{onClick:qp,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500,whiteSpace:"nowrap"},children:"Browse..."})]}),os.filename&&os.locationPath&&l.jsxs("div",{style:{marginBottom:"20px",padding:"8px 12px",background:"#1a1a1f",border:"1px solid #333",borderRadius:6,fontSize:"12px",color:"#aaa",fontFamily:"monospace"},children:[l.jsx("div",{style:{marginBottom:"4px",color:"#888"},children:"File will be saved at:"}),l.jsxs("div",{style:{color:"#4CAF50"},children:[os.locationPath,"/",os.filename.endsWith(".json")?os.filename:`${os.filename}.json`]})]}),l.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[l.jsx("button",{onClick:Oh,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),l.jsx("button",{onClick:Bh,disabled:!os.filename.trim()||!os.locationHandle,style:{padding:"8px 16px",background:!os.filename.trim()||!os.locationHandle?"#555":"#4CAF50",color:"#fff",border:"1px solid "+(!os.filename.trim()||!os.locationHandle?"#666":"#45a049"),borderRadius:6,cursor:!os.filename.trim()||!os.locationHandle?"not-allowed":"pointer",fontSize:"14px",fontWeight:600,opacity:!os.filename.trim()||!os.locationHandle?.6:1},children:"Save"})]})]})}),l.jsx(g3,{visible:fo.visible,title:fo.title,message:fo.message,onClose:()=>po({visible:!1,title:"",message:""})}),l.jsx(b3,{visible:cd,dimensions:Bl,onSave:p=>{ld(p)},onClose:()=>Wc(!1)}),l.jsx(v3,{visible:Tl,onClose:()=>{let p=0,C=0;t?(p=t.x,C=t.y):s&&(p=s.x,C=s.y),Rl(L=>({...L,0:{pcbReferenceX:p,pcbReferenceY:C,x:0,y:0,zoom:Ct,viewRotation:ti,viewFlipX:Ji,isBottomView:Sa,transparency:h,showTopImage:Ls,showBottomImage:Ml,showViasLayer:lr,showTopTracesLayer:Ns,showBottomTracesLayer:ys,showTopPadsLayer:cr,showBottomPadsLayer:Gr,showTopTestPointsLayer:fs,showBottomTestPointsLayer:vo,showTopComponents:io,showBottomComponents:Di,showPowerLayer:_a,showGroundLayer:ri,showConnectionsLayer:Cs}})),Pr(!1)},topImage:t,bottomImage:s,selectedImageForTransform:Qt,setSelectedImageForTransform:Cr,transformMode:Or,setTransformMode:ja,updateImageTransform:Nf,resetImageTransform:Ph,setCurrentTool:N,isGrayscale:P,setIsGrayscale:x,areImagesLocked:ji}),l.jsx(w3,{visible:dl,onClose:()=>zo(!1),topImage:t,bottomImage:s,setTopImage:n,setBottomImage:o,componentsTop:Ut,componentsBottom:Zt,setComponentsTop:Pi,setComponentsBottom:Yn,drawingStrokes:pt,setDrawingStrokes:jt,powerSymbols:Dn,groundSymbols:y,setPowerSymbols:Re,setGroundSymbols:st,canvasRef:rs,isBottomView:Sa,setIsBottomView:qr,originalTopFlipX:Aa,setOriginalTopFlipX:go,originalBottomFlipX:$i,setOriginalBottomFlipX:Ri,originalTopFlipY:Ss,setOriginalTopFlipY:sr,originalBottomFlipY:_l,setOriginalBottomFlipY:ul,cameraWorldCenter:Ti,setCameraWorldCenter:Si,viewScale:Ct,viewRotation:ti,setViewRotation:vs,viewFlipX:Ji,setViewFlipX:Ds,contentBorder:5,setTransparency:f}),l.jsx(NT,{visible:Ep,selectedLayer:gi,selectedComponentType:cc,selectedComponentKey:f0,onLayerChange:p=>{ma(p),$a.current=p,Kt(p),G(p==="top"?ht:fe),F(p==="top"?zt:it),p==="top"?(or(!0),Ho(!0)):(mr(!0),ra(!0))},onComponentTypeChange:(p,C,L)=>{Th(p),Sf(C),Rp(L||null),Hu.current=p},onClose:()=>{Uu(!1),Xl(!0),N("select")}}),l.jsx(RT,{visible:Hr.visible,size:Hr.size,onSizeChange:p=>Do(C=>({...C,size:p})),onApply:Op,onCancel:()=>Do({visible:!1,size:6})}),l.jsx(DT,{visible:Sc.visible,interval:Sc.interval,onIntervalChange:p=>Lo({visible:!0,interval:p}),onApply:()=>jf(Sc.interval,!1),onCancel:()=>Lo({visible:!1,interval:5})}),l.jsx(LT,{visible:va.visible,interval:va.interval,onIntervalChange:p=>nr({...va,interval:p}),onEnable:()=>jf(va.interval,!0),onSkip:Fp}),l.jsx(IT,{visible:Tc,isPad:ps,onConfirm:p=>{Rd({numPins:p.numPins,type:p.type,twoSidedOrientation:p.twoSidedOrientation,point1:{x:0,y:0},point2:{x:0,y:0}}),xh(!0),N("select"),zl(!1)},onClose:()=>{zl(!1)}}),l.jsx("div",{style:{position:"fixed",bottom:8,right:8,zIndex:100},children:l.jsxs("button",{onClick:()=>{window.open("https://github.com/sponsors/pgiacalo","_blank","noopener,noreferrer")},style:{display:"flex",alignItems:"center",gap:6,padding:"6px 12px",background:"linear-gradient(180deg, #f6f8fa 0%, #ebecef 100%)",border:"1px solid rgba(27, 31, 36, 0.15)",borderRadius:6,cursor:"pointer",fontSize:12,fontWeight:500,color:"#24292f",boxShadow:"0 1px 0 rgba(27, 31, 36, 0.04)",transition:"background 0.2s"},onMouseEnter:p=>{p.currentTarget.style.background="linear-gradient(180deg, #f3f4f6 0%, #e5e6e9 100%)"},onMouseLeave:p=>{p.currentTarget.style.background="linear-gradient(180deg, #f6f8fa 0%, #ebecef 100%)"},title:"Donate to support this project",children:[l.jsx("svg",{height:"16",width:"16",viewBox:"0 0 16 16",fill:"#bf3989","aria-hidden":"true",children:l.jsx("path",{d:"M4.25 2.5c-1.336 0-2.75 1.164-2.75 3 0 2.15 1.58 4.144 3.365 5.682A20.565 20.565 0 008 13.393a20.561 20.561 0 003.135-2.211C12.92 9.644 14.5 7.65 14.5 5.5c0-1.836-1.414-3-2.75-3-1.373 0-2.609.986-3.029 2.456a.749.749 0 01-1.442 0C6.859 3.486 5.623 2.5 4.25 2.5z"})}),"Donate"]})})]})}zw.createRoot(document.getElementById("root")).render(l.jsx(X.StrictMode,{children:l.jsx(t4,{})}));export{Rs as _,i4 as c,kw as g};

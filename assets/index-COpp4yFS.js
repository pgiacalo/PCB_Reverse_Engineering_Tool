var V1=r=>{throw TypeError(r)};var $0=(r,e,t)=>e.has(r)||V1("Cannot "+t);var vr=(r,e,t)=>($0(r,e,"read from private field"),t?t.call(r):e.get(r)),yd=(r,e,t)=>e.has(r)?V1("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),Vl=(r,e,t,n)=>($0(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),xd=(r,e,t)=>($0(r,e,"access private method"),t);var W1=(r,e,t,n)=>({set _(s){Vl(r,e,s,t)},get _(){return vr(r,e,n)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const d of o.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();var e4=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _w(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var G0={exports:{}},Zf={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $1;function kw(){if($1)return Zf;$1=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,s,o){var d=null;if(o!==void 0&&(d=""+o),s.key!==void 0&&(d=""+s.key),"key"in s){o={};for(var c in s)c!=="key"&&(o[c]=s[c])}else o=s;return s=o.ref,{$$typeof:r,type:n,key:d,ref:s!==void 0?s:null,props:o}}return Zf.Fragment=e,Zf.jsx=t,Zf.jsxs=t,Zf}var G1;function jw(){return G1||(G1=1,G0.exports=kw()),G0.exports}var l=jw(),Y0={exports:{}},li={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y1;function Nw(){if(Y1)return li;Y1=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),d=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),b=Symbol.for("react.activity"),A=Symbol.iterator;function v(Z){return Z===null||typeof Z!="object"?null:(Z=A&&Z[A]||Z["@@iterator"],typeof Z=="function"?Z:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,k={};function j(Z,D,H){this.props=Z,this.context=D,this.refs=k,this.updater=H||E}j.prototype.isReactComponent={},j.prototype.setState=function(Z,D){if(typeof Z!="object"&&typeof Z!="function"&&Z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Z,D,"setState")},j.prototype.forceUpdate=function(Z){this.updater.enqueueForceUpdate(this,Z,"forceUpdate")};function $(){}$.prototype=j.prototype;function z(Z,D,H){this.props=Z,this.context=D,this.refs=k,this.updater=H||E}var B=z.prototype=new $;B.constructor=z,x(B,j.prototype),B.isPureReactComponent=!0;var F=Array.isArray;function I(){}var X={H:null,A:null,T:null,S:null},M=Object.prototype.hasOwnProperty;function G(Z,D,H){var Y=H.ref;return{$$typeof:r,type:Z,key:D,ref:Y!==void 0?Y:null,props:H}}function U(Z,D){return G(Z.type,D,Z.props)}function _(Z){return typeof Z=="object"&&Z!==null&&Z.$$typeof===r}function N(Z){var D={"=":"=0",":":"=2"};return"$"+Z.replace(/[=:]/g,function(H){return D[H]})}var te=/\/+/g;function ie(Z,D){return typeof Z=="object"&&Z!==null&&Z.key!=null?N(""+Z.key):D.toString(36)}function re(Z){switch(Z.status){case"fulfilled":return Z.value;case"rejected":throw Z.reason;default:switch(typeof Z.status=="string"?Z.then(I,I):(Z.status="pending",Z.then(function(D){Z.status==="pending"&&(Z.status="fulfilled",Z.value=D)},function(D){Z.status==="pending"&&(Z.status="rejected",Z.reason=D)})),Z.status){case"fulfilled":return Z.value;case"rejected":throw Z.reason}}throw Z}function q(Z,D,H,Y,ue){var Ne=typeof Z;(Ne==="undefined"||Ne==="boolean")&&(Z=null);var Pe=!1;if(Z===null)Pe=!0;else switch(Ne){case"bigint":case"string":case"number":Pe=!0;break;case"object":switch(Z.$$typeof){case r:case e:Pe=!0;break;case m:return Pe=Z._init,q(Pe(Z._payload),D,H,Y,ue)}}if(Pe)return ue=ue(Z),Pe=Y===""?"."+ie(Z,0):Y,F(ue)?(H="",Pe!=null&&(H=Pe.replace(te,"$&/")+"/"),q(ue,D,H,"",function(Ke){return Ke})):ue!=null&&(_(ue)&&(ue=U(ue,H+(ue.key==null||Z&&Z.key===ue.key?"":(""+ue.key).replace(te,"$&/")+"/")+Pe)),D.push(ue)),1;Pe=0;var Ue=Y===""?".":Y+":";if(F(Z))for(var Re=0;Re<Z.length;Re++)Y=Z[Re],Ne=Ue+ie(Y,Re),Pe+=q(Y,D,H,Ne,ue);else if(Re=v(Z),typeof Re=="function")for(Z=Re.call(Z),Re=0;!(Y=Z.next()).done;)Y=Y.value,Ne=Ue+ie(Y,Re++),Pe+=q(Y,D,H,Ne,ue);else if(Ne==="object"){if(typeof Z.then=="function")return q(re(Z),D,H,Y,ue);throw D=String(Z),Error("Objects are not valid as a React child (found: "+(D==="[object Object]"?"object with keys {"+Object.keys(Z).join(", ")+"}":D)+"). If you meant to render a collection of children, use an array instead.")}return Pe}function J(Z,D,H){if(Z==null)return Z;var Y=[],ue=0;return q(Z,Y,"","",function(Ne){return D.call(H,Ne,ue++)}),Y}function ce(Z){if(Z._status===-1){var D=Z._result;D=D(),D.then(function(H){(Z._status===0||Z._status===-1)&&(Z._status=1,Z._result=H)},function(H){(Z._status===0||Z._status===-1)&&(Z._status=2,Z._result=H)}),Z._status===-1&&(Z._status=0,Z._result=D)}if(Z._status===1)return Z._result.default;throw Z._result}var _e=typeof reportError=="function"?reportError:function(Z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var D=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Z=="object"&&Z!==null&&typeof Z.message=="string"?String(Z.message):String(Z),error:Z});if(!window.dispatchEvent(D))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Z);return}console.error(Z)},xe={map:J,forEach:function(Z,D,H){J(Z,function(){D.apply(this,arguments)},H)},count:function(Z){var D=0;return J(Z,function(){D++}),D},toArray:function(Z){return J(Z,function(D){return D})||[]},only:function(Z){if(!_(Z))throw Error("React.Children.only expected to receive a single React element child.");return Z}};return li.Activity=b,li.Children=xe,li.Component=j,li.Fragment=t,li.Profiler=s,li.PureComponent=z,li.StrictMode=n,li.Suspense=h,li.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=X,li.__COMPILER_RUNTIME={__proto__:null,c:function(Z){return X.H.useMemoCache(Z)}},li.cache=function(Z){return function(){return Z.apply(null,arguments)}},li.cacheSignal=function(){return null},li.cloneElement=function(Z,D,H){if(Z==null)throw Error("The argument must be a React element, but you passed "+Z+".");var Y=x({},Z.props),ue=Z.key;if(D!=null)for(Ne in D.key!==void 0&&(ue=""+D.key),D)!M.call(D,Ne)||Ne==="key"||Ne==="__self"||Ne==="__source"||Ne==="ref"&&D.ref===void 0||(Y[Ne]=D[Ne]);var Ne=arguments.length-2;if(Ne===1)Y.children=H;else if(1<Ne){for(var Pe=Array(Ne),Ue=0;Ue<Ne;Ue++)Pe[Ue]=arguments[Ue+2];Y.children=Pe}return G(Z.type,ue,Y)},li.createContext=function(Z){return Z={$$typeof:d,_currentValue:Z,_currentValue2:Z,_threadCount:0,Provider:null,Consumer:null},Z.Provider=Z,Z.Consumer={$$typeof:o,_context:Z},Z},li.createElement=function(Z,D,H){var Y,ue={},Ne=null;if(D!=null)for(Y in D.key!==void 0&&(Ne=""+D.key),D)M.call(D,Y)&&Y!=="key"&&Y!=="__self"&&Y!=="__source"&&(ue[Y]=D[Y]);var Pe=arguments.length-2;if(Pe===1)ue.children=H;else if(1<Pe){for(var Ue=Array(Pe),Re=0;Re<Pe;Re++)Ue[Re]=arguments[Re+2];ue.children=Ue}if(Z&&Z.defaultProps)for(Y in Pe=Z.defaultProps,Pe)ue[Y]===void 0&&(ue[Y]=Pe[Y]);return G(Z,Ne,ue)},li.createRef=function(){return{current:null}},li.forwardRef=function(Z){return{$$typeof:c,render:Z}},li.isValidElement=_,li.lazy=function(Z){return{$$typeof:m,_payload:{_status:-1,_result:Z},_init:ce}},li.memo=function(Z,D){return{$$typeof:f,type:Z,compare:D===void 0?null:D}},li.startTransition=function(Z){var D=X.T,H={};X.T=H;try{var Y=Z(),ue=X.S;ue!==null&&ue(H,Y),typeof Y=="object"&&Y!==null&&typeof Y.then=="function"&&Y.then(I,_e)}catch(Ne){_e(Ne)}finally{D!==null&&H.types!==null&&(D.types=H.types),X.T=D}},li.unstable_useCacheRefresh=function(){return X.H.useCacheRefresh()},li.use=function(Z){return X.H.use(Z)},li.useActionState=function(Z,D,H){return X.H.useActionState(Z,D,H)},li.useCallback=function(Z,D){return X.H.useCallback(Z,D)},li.useContext=function(Z){return X.H.useContext(Z)},li.useDebugValue=function(){},li.useDeferredValue=function(Z,D){return X.H.useDeferredValue(Z,D)},li.useEffect=function(Z,D){return X.H.useEffect(Z,D)},li.useEffectEvent=function(Z){return X.H.useEffectEvent(Z)},li.useId=function(){return X.H.useId()},li.useImperativeHandle=function(Z,D,H){return X.H.useImperativeHandle(Z,D,H)},li.useInsertionEffect=function(Z,D){return X.H.useInsertionEffect(Z,D)},li.useLayoutEffect=function(Z,D){return X.H.useLayoutEffect(Z,D)},li.useMemo=function(Z,D){return X.H.useMemo(Z,D)},li.useOptimistic=function(Z,D){return X.H.useOptimistic(Z,D)},li.useReducer=function(Z,D,H){return X.H.useReducer(Z,D,H)},li.useRef=function(Z){return X.H.useRef(Z)},li.useState=function(Z){return X.H.useState(Z)},li.useSyncExternalStore=function(Z,D,H){return X.H.useSyncExternalStore(Z,D,H)},li.useTransition=function(){return X.H.useTransition()},li.version="19.2.0",li}var X1;function fy(){return X1||(X1=1,Y0.exports=Nw()),Y0.exports}var K=fy();const Ct=_w(K);var X0={exports:{}},Jf={},K0={exports:{}},Z0={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var K1;function Pw(){return K1||(K1=1,(function(r){function e(q,J){var ce=q.length;q.push(J);e:for(;0<ce;){var _e=ce-1>>>1,xe=q[_e];if(0<s(xe,J))q[_e]=J,q[ce]=xe,ce=_e;else break e}}function t(q){return q.length===0?null:q[0]}function n(q){if(q.length===0)return null;var J=q[0],ce=q.pop();if(ce!==J){q[0]=ce;e:for(var _e=0,xe=q.length,Z=xe>>>1;_e<Z;){var D=2*(_e+1)-1,H=q[D],Y=D+1,ue=q[Y];if(0>s(H,ce))Y<xe&&0>s(ue,H)?(q[_e]=ue,q[Y]=ce,_e=Y):(q[_e]=H,q[D]=ce,_e=D);else if(Y<xe&&0>s(ue,ce))q[_e]=ue,q[Y]=ce,_e=Y;else break e}}return J}function s(q,J){var ce=q.sortIndex-J.sortIndex;return ce!==0?ce:q.id-J.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;r.unstable_now=function(){return o.now()}}else{var d=Date,c=d.now();r.unstable_now=function(){return d.now()-c}}var h=[],f=[],m=1,b=null,A=3,v=!1,E=!1,x=!1,k=!1,j=typeof setTimeout=="function"?setTimeout:null,$=typeof clearTimeout=="function"?clearTimeout:null,z=typeof setImmediate<"u"?setImmediate:null;function B(q){for(var J=t(f);J!==null;){if(J.callback===null)n(f);else if(J.startTime<=q)n(f),J.sortIndex=J.expirationTime,e(h,J);else break;J=t(f)}}function F(q){if(x=!1,B(q),!E)if(t(h)!==null)E=!0,I||(I=!0,N());else{var J=t(f);J!==null&&re(F,J.startTime-q)}}var I=!1,X=-1,M=5,G=-1;function U(){return k?!0:!(r.unstable_now()-G<M)}function _(){if(k=!1,I){var q=r.unstable_now();G=q;var J=!0;try{e:{E=!1,x&&(x=!1,$(X),X=-1),v=!0;var ce=A;try{t:{for(B(q),b=t(h);b!==null&&!(b.expirationTime>q&&U());){var _e=b.callback;if(typeof _e=="function"){b.callback=null,A=b.priorityLevel;var xe=_e(b.expirationTime<=q);if(q=r.unstable_now(),typeof xe=="function"){b.callback=xe,B(q),J=!0;break t}b===t(h)&&n(h),B(q)}else n(h);b=t(h)}if(b!==null)J=!0;else{var Z=t(f);Z!==null&&re(F,Z.startTime-q),J=!1}}break e}finally{b=null,A=ce,v=!1}J=void 0}}finally{J?N():I=!1}}}var N;if(typeof z=="function")N=function(){z(_)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,ie=te.port2;te.port1.onmessage=_,N=function(){ie.postMessage(null)}}else N=function(){j(_,0)};function re(q,J){X=j(function(){q(r.unstable_now())},J)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(q){q.callback=null},r.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<q?Math.floor(1e3/q):5},r.unstable_getCurrentPriorityLevel=function(){return A},r.unstable_next=function(q){switch(A){case 1:case 2:case 3:var J=3;break;default:J=A}var ce=A;A=J;try{return q()}finally{A=ce}},r.unstable_requestPaint=function(){k=!0},r.unstable_runWithPriority=function(q,J){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var ce=A;A=q;try{return J()}finally{A=ce}},r.unstable_scheduleCallback=function(q,J,ce){var _e=r.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?_e+ce:_e):ce=_e,q){case 1:var xe=-1;break;case 2:xe=250;break;case 5:xe=1073741823;break;case 4:xe=1e4;break;default:xe=5e3}return xe=ce+xe,q={id:m++,callback:J,priorityLevel:q,startTime:ce,expirationTime:xe,sortIndex:-1},ce>_e?(q.sortIndex=ce,e(f,q),t(h)===null&&q===t(f)&&(x?($(X),X=-1):x=!0,re(F,ce-_e))):(q.sortIndex=xe,e(h,q),E||v||(E=!0,I||(I=!0,N()))),q},r.unstable_shouldYield=U,r.unstable_wrapCallback=function(q){var J=A;return function(){var ce=A;A=J;try{return q.apply(this,arguments)}finally{A=ce}}}})(Z0)),Z0}var Z1;function Ew(){return Z1||(Z1=1,K0.exports=Pw()),K0.exports}var J0={exports:{}},Yo={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J1;function Rw(){if(J1)return Yo;J1=1;var r=fy();function e(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)f+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function o(h,f,m){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:b==null?null:""+b,children:h,containerInfo:f,implementation:m}}var d=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Yo.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Yo.createPortal=function(h,f){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return o(h,f,null,m)},Yo.flushSync=function(h){var f=d.T,m=n.p;try{if(d.T=null,n.p=2,h)return h()}finally{d.T=f,n.p=m,n.d.f()}},Yo.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(h,f))},Yo.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},Yo.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var m=f.as,b=c(m,f.crossOrigin),A=typeof f.integrity=="string"?f.integrity:void 0,v=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;m==="style"?n.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:b,integrity:A,fetchPriority:v}):m==="script"&&n.d.X(h,{crossOrigin:b,integrity:A,fetchPriority:v,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Yo.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var m=c(f.as,f.crossOrigin);n.d.M(h,{crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(h)},Yo.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var m=f.as,b=c(m,f.crossOrigin);n.d.L(h,m,{crossOrigin:b,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Yo.preloadModule=function(h,f){if(typeof h=="string")if(f){var m=c(f.as,f.crossOrigin);n.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(h)},Yo.requestFormReset=function(h){n.d.r(h)},Yo.unstable_batchedUpdates=function(h,f){return h(f)},Yo.useFormState=function(h,f,m){return d.H.useFormState(h,f,m)},Yo.useFormStatus=function(){return d.H.useHostTransitionStatus()},Yo.version="19.2.0",Yo}var Q1;function Dw(){if(Q1)return J0.exports;Q1=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),J0.exports=Rw(),J0.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ex;function Lw(){if(ex)return Jf;ex=1;var r=Ew(),e=fy(),t=Dw();function n(i){var a="https://react.dev/errors/"+i;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)a+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+i+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var a=i,u=i;if(i.alternate)for(;a.return;)a=a.return;else{i=a;do a=i,(a.flags&4098)!==0&&(u=a.return),i=a.return;while(i)}return a.tag===3?u:null}function d(i){if(i.tag===13){var a=i.memoizedState;if(a===null&&(i=i.alternate,i!==null&&(a=i.memoizedState)),a!==null)return a.dehydrated}return null}function c(i){if(i.tag===31){var a=i.memoizedState;if(a===null&&(i=i.alternate,i!==null&&(a=i.memoizedState)),a!==null)return a.dehydrated}return null}function h(i){if(o(i)!==i)throw Error(n(188))}function f(i){var a=i.alternate;if(!a){if(a=o(i),a===null)throw Error(n(188));return a!==i?null:i}for(var u=i,g=a;;){var w=u.return;if(w===null)break;var C=w.alternate;if(C===null){if(g=w.return,g!==null){u=g;continue}break}if(w.child===C.child){for(C=w.child;C;){if(C===u)return h(w),i;if(C===g)return h(w),a;C=C.sibling}throw Error(n(188))}if(u.return!==g.return)u=w,g=C;else{for(var W=!1,le=w.child;le;){if(le===u){W=!0,u=w,g=C;break}if(le===g){W=!0,g=w,u=C;break}le=le.sibling}if(!W){for(le=C.child;le;){if(le===u){W=!0,u=C,g=w;break}if(le===g){W=!0,g=C,u=w;break}le=le.sibling}if(!W)throw Error(n(189))}}if(u.alternate!==g)throw Error(n(190))}if(u.tag!==3)throw Error(n(188));return u.stateNode.current===u?i:a}function m(i){var a=i.tag;if(a===5||a===26||a===27||a===6)return i;for(i=i.child;i!==null;){if(a=m(i),a!==null)return a;i=i.sibling}return null}var b=Object.assign,A=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),$=Symbol.for("react.consumer"),z=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),X=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),G=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),_=Symbol.iterator;function N(i){return i===null||typeof i!="object"?null:(i=_&&i[_]||i["@@iterator"],typeof i=="function"?i:null)}var te=Symbol.for("react.client.reference");function ie(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===te?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case x:return"Fragment";case j:return"Profiler";case k:return"StrictMode";case F:return"Suspense";case I:return"SuspenseList";case G:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case E:return"Portal";case z:return i.displayName||"Context";case $:return(i._context.displayName||"Context")+".Consumer";case B:var a=i.render;return i=i.displayName,i||(i=a.displayName||a.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case X:return a=i.displayName||null,a!==null?a:ie(i.type)||"Memo";case M:a=i._payload,i=i._init;try{return ie(i(a))}catch{}}return null}var re=Array.isArray,q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ce={pending:!1,data:null,method:null,action:null},_e=[],xe=-1;function Z(i){return{current:i}}function D(i){0>xe||(i.current=_e[xe],_e[xe]=null,xe--)}function H(i,a){xe++,_e[xe]=i.current,i.current=a}var Y=Z(null),ue=Z(null),Ne=Z(null),Pe=Z(null);function Ue(i,a){switch(H(Ne,a),H(ue,i),H(Y,null),a.nodeType){case 9:case 11:i=(i=a.documentElement)&&(i=i.namespaceURI)?f1(i):0;break;default:if(i=a.tagName,a=a.namespaceURI)a=f1(a),i=p1(a,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}D(Y),H(Y,i)}function Re(){D(Y),D(ue),D(Ne)}function Ke(i){i.memoizedState!==null&&H(Pe,i);var a=Y.current,u=p1(a,i.type);a!==u&&(H(ue,i),H(Y,u))}function Je(i){ue.current===i&&(D(Y),D(ue)),Pe.current===i&&(D(Pe),Gf._currentValue=ce)}var st,yt;function Nt(i){if(st===void 0)try{throw Error()}catch(u){var a=u.stack.trim().match(/\n( *(at )?)/);st=a&&a[1]||"",yt=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+st+i+yt}var pe=!1;function St(i,a){if(!i||pe)return"";pe=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(a){var vt=function(){throw Error()};if(Object.defineProperty(vt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(vt,[])}catch(ot){var nt=ot}Reflect.construct(i,[],vt)}else{try{vt.call()}catch(ot){nt=ot}i.call(vt.prototype)}}else{try{throw Error()}catch(ot){nt=ot}(vt=i())&&typeof vt.catch=="function"&&vt.catch(function(){})}}catch(ot){if(ot&&nt&&typeof ot.stack=="string")return[ot.stack,nt.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var w=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");w&&w.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var C=g.DetermineComponentFrameRoot(),W=C[0],le=C[1];if(W&&le){var Me=W.split(`
`),tt=le.split(`
`);for(w=g=0;g<Me.length&&!Me[g].includes("DetermineComponentFrameRoot");)g++;for(;w<tt.length&&!tt[w].includes("DetermineComponentFrameRoot");)w++;if(g===Me.length||w===tt.length)for(g=Me.length-1,w=tt.length-1;1<=g&&0<=w&&Me[g]!==tt[w];)w--;for(;1<=g&&0<=w;g--,w--)if(Me[g]!==tt[w]){if(g!==1||w!==1)do if(g--,w--,0>w||Me[g]!==tt[w]){var pt=`
`+Me[g].replace(" at new "," at ");return i.displayName&&pt.includes("<anonymous>")&&(pt=pt.replace("<anonymous>",i.displayName)),pt}while(1<=g&&0<=w);break}}}finally{pe=!1,Error.prepareStackTrace=u}return(u=i?i.displayName||i.name:"")?Nt(u):""}function Ut(i,a){switch(i.tag){case 26:case 27:case 5:return Nt(i.type);case 16:return Nt("Lazy");case 13:return i.child!==a&&a!==null?Nt("Suspense Fallback"):Nt("Suspense");case 19:return Nt("SuspenseList");case 0:case 15:return St(i.type,!1);case 11:return St(i.type.render,!1);case 1:return St(i.type,!0);case 31:return Nt("Activity");default:return""}}function Lt(i){try{var a="",u=null;do a+=Ut(i,u),u=i,i=i.return;while(i);return a}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var at=Object.prototype.hasOwnProperty,en=r.unstable_scheduleCallback,Ot=r.unstable_cancelCallback,wn=r.unstable_shouldYield,nn=r.unstable_requestPaint,Zn=r.unstable_now,Pt=r.unstable_getCurrentPriorityLevel,Mt=r.unstable_ImmediatePriority,yi=r.unstable_UserBlockingPriority,ft=r.unstable_NormalPriority,_t=r.unstable_LowPriority,On=r.unstable_IdlePriority,Jt=r.log,zn=r.unstable_setDisableYieldValue,Nn=null,on=null;function Sn(i){if(typeof Jt=="function"&&zn(i),on&&typeof on.setStrictMode=="function")try{on.setStrictMode(Nn,i)}catch{}}var lt=Math.clz32?Math.clz32:Gt,Qt=Math.log,$t=Math.LN2;function Gt(i){return i>>>=0,i===0?32:31-(Qt(i)/$t|0)|0}var An=256,Vi=262144,qn=4194304;function yn(i){var a=i&42;if(a!==0)return a;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Kt(i,a,u){var g=i.pendingLanes;if(g===0)return 0;var w=0,C=i.suspendedLanes,W=i.pingedLanes;i=i.warmLanes;var le=g&134217727;return le!==0?(g=le&~C,g!==0?w=yn(g):(W&=le,W!==0?w=yn(W):u||(u=le&~i,u!==0&&(w=yn(u))))):(le=g&~C,le!==0?w=yn(le):W!==0?w=yn(W):u||(u=g&~i,u!==0&&(w=yn(u)))),w===0?0:a!==0&&a!==w&&(a&C)===0&&(C=w&-w,u=a&-a,C>=u||C===32&&(u&4194048)!==0)?a:w}function Tr(i,a){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&a)===0}function Ks(i,a){switch(i){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ir(){var i=qn;return qn<<=1,(qn&62914560)===0&&(qn=4194304),i}function Br(i){for(var a=[],u=0;31>u;u++)a.push(i);return a}function Zt(i,a){i.pendingLanes|=a,a!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Or(i,a,u,g,w,C){var W=i.pendingLanes;i.pendingLanes=u,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=u,i.entangledLanes&=u,i.errorRecoveryDisabledLanes&=u,i.shellSuspendCounter=0;var le=i.entanglements,Me=i.expirationTimes,tt=i.hiddenUpdates;for(u=W&~u;0<u;){var pt=31-lt(u),vt=1<<pt;le[pt]=0,Me[pt]=-1;var nt=tt[pt];if(nt!==null)for(tt[pt]=null,pt=0;pt<nt.length;pt++){var ot=nt[pt];ot!==null&&(ot.lane&=-536870913)}u&=~vt}g!==0&&Na(i,g,0),C!==0&&w===0&&i.tag!==0&&(i.suspendedLanes|=C&~(W&~a))}function Na(i,a,u){i.pendingLanes|=a,i.suspendedLanes&=~a;var g=31-lt(a);i.entangledLanes|=a,i.entanglements[g]=i.entanglements[g]|1073741824|u&261930}function fa(i,a){var u=i.entangledLanes|=a;for(i=i.entanglements;u;){var g=31-lt(u),w=1<<g;w&a|i[g]&a&&(i[g]|=a),u&=~w}}function At(i,a){var u=a&-a;return u=(u&42)!==0?1:fi(u),(u&(i.suspendedLanes|a))!==0?0:u}function fi(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function ei(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function vs(){var i=J.p;return i!==0?i:(i=window.event,i===void 0?32:I1(i.type))}function Ji(i,a){var u=J.p;try{return J.p=i,a()}finally{J.p=u}}var Ds=Math.random().toString(36).slice(2),Ci="__reactFiber$"+Ds,Si="__reactProps$"+Ds,Cr="__reactContainer$"+Ds,pa="__reactEvents$"+Ds,qa="__reactListeners$"+Ds,Yl="__reactHandles$"+Ds,Va="__reactResources$"+Ds,Wa="__reactMarker$"+Ds;function No(i){delete i[Ci],delete i[Si],delete i[pa],delete i[qa],delete i[Yl]}function $n(i){var a=i[Ci];if(a)return a;for(var u=i.parentNode;u;){if(a=u[Cr]||u[Ci]){if(u=a.alternate,a.child!==null||u!==null&&u.child!==null)for(i=w1(i);i!==null;){if(u=i[Ci])return u;i=w1(i)}return a}i=u,u=i.parentNode}return null}function Fr(i){if(i=i[Ci]||i[Cr]){var a=i.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return i}return null}function xi(i){var a=i.tag;if(a===5||a===26||a===27||a===6)return i.stateNode;throw Error(n(33))}function ga(i){var a=i[Va];return a||(a=i[Va]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function En(i){i[Wa]=!0}var Qo=new Set,pi={};function ma(i,a){Pa(i,a),Pa(i+"Capture",a)}function Pa(i,a){for(pi[i]=a,i=0;i<a.length;i++)Qo.add(a[i])}var el=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),tl={},$a={};function td(i){return at.call($a,i)?!0:at.call(tl,i)?!1:el.test(i)?$a[i]=!0:(tl[i]=!0,!1)}function ss(i,a,u){if(td(a))if(u===null)i.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":i.removeAttribute(a);return;case"boolean":var g=a.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){i.removeAttribute(a);return}}i.setAttribute(a,""+u)}}function nl(i,a,u){if(u===null)i.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(a);return}i.setAttribute(a,""+u)}}function Un(i,a,u,g){if(g===null)i.removeAttribute(u);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(u);return}i.setAttributeNS(a,u,""+g)}}function Fn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function il(i){var a=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Ga(i,a,u){var g=Object.getOwnPropertyDescriptor(i.constructor.prototype,a);if(!i.hasOwnProperty(a)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var w=g.get,C=g.set;return Object.defineProperty(i,a,{configurable:!0,get:function(){return w.call(this)},set:function(W){u=""+W,C.call(this,W)}}),Object.defineProperty(i,a,{enumerable:g.enumerable}),{getValue:function(){return u},setValue:function(W){u=""+W},stopTracking:function(){i._valueTracker=null,delete i[a]}}}}function Fs(i){if(!i._valueTracker){var a=il(i)?"checked":"value";i._valueTracker=Ga(i,a,""+i[a])}}function _r(i){if(!i)return!1;var a=i._valueTracker;if(!a)return!0;var u=a.getValue(),g="";return i&&(g=il(i)?i.checked?"true":"false":i.value),i=g,i!==u?(a.setValue(i),!0):!1}function us(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Vn=/[\n"\\]/g;function bi(i){return i.replace(Vn,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Xl(i,a,u,g,w,C,W,le){i.name="",W!=null&&typeof W!="function"&&typeof W!="symbol"&&typeof W!="boolean"?i.type=W:i.removeAttribute("type"),a!=null?W==="number"?(a===0&&i.value===""||i.value!=a)&&(i.value=""+Fn(a)):i.value!==""+Fn(a)&&(i.value=""+Fn(a)):W!=="submit"&&W!=="reset"||i.removeAttribute("value"),a!=null?ya(i,W,Fn(a)):u!=null?ya(i,W,Fn(u)):g!=null&&i.removeAttribute("value"),w==null&&C!=null&&(i.defaultChecked=!!C),w!=null&&(i.checked=w&&typeof w!="function"&&typeof w!="symbol"),le!=null&&typeof le!="function"&&typeof le!="symbol"&&typeof le!="boolean"?i.name=""+Fn(le):i.removeAttribute("name")}function bc(i,a,u,g,w,C,W,le){if(C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(i.type=C),a!=null||u!=null){if(!(C!=="submit"&&C!=="reset"||a!=null)){Fs(i);return}u=u!=null?""+Fn(u):"",a=a!=null?""+Fn(a):u,le||a===i.value||(i.value=a),i.defaultValue=a}g=g??w,g=typeof g!="function"&&typeof g!="symbol"&&!!g,i.checked=le?i.checked:!!g,i.defaultChecked=!!g,W!=null&&typeof W!="function"&&typeof W!="symbol"&&typeof W!="boolean"&&(i.name=W),Fs(i)}function ya(i,a,u){a==="number"&&us(i.ownerDocument)===i||i.defaultValue===""+u||(i.defaultValue=""+u)}function kr(i,a,u,g){if(i=i.options,a){a={};for(var w=0;w<u.length;w++)a["$"+u[w]]=!0;for(u=0;u<i.length;u++)w=a.hasOwnProperty("$"+i[u].value),i[u].selected!==w&&(i[u].selected=w),w&&g&&(i[u].defaultSelected=!0)}else{for(u=""+Fn(u),a=null,w=0;w<i.length;w++){if(i[w].value===u){i[w].selected=!0,g&&(i[w].defaultSelected=!0);return}a!==null||i[w].disabled||(a=i[w])}a!==null&&(a.selected=!0)}}function sl(i,a,u){if(a!=null&&(a=""+Fn(a),a!==i.value&&(i.value=a),u==null)){i.defaultValue!==a&&(i.defaultValue=a);return}i.defaultValue=u!=null?""+Fn(u):""}function Ya(i,a,u,g){if(a==null){if(g!=null){if(u!=null)throw Error(n(92));if(re(g)){if(1<g.length)throw Error(n(93));g=g[0]}u=g}u==null&&(u=""),a=u}u=Fn(a),i.defaultValue=u,g=i.textContent,g===u&&g!==""&&g!==null&&(i.value=g),Fs(i)}function jr(i,a){if(a){var u=i.firstChild;if(u&&u===i.lastChild&&u.nodeType===3){u.nodeValue=a;return}}i.textContent=a}var na=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Et(i,a,u){var g=a.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?g?i.setProperty(a,""):a==="float"?i.cssFloat="":i[a]="":g?i.setProperty(a,u):typeof u!="number"||u===0||na.has(a)?a==="float"?i.cssFloat=u:i[a]=(""+u).trim():i[a]=u+"px"}function Qi(i,a,u){if(a!=null&&typeof a!="object")throw Error(n(62));if(i=i.style,u!=null){for(var g in u)!u.hasOwnProperty(g)||a!=null&&a.hasOwnProperty(g)||(g.indexOf("--")===0?i.setProperty(g,""):g==="float"?i.cssFloat="":i[g]="");for(var w in a)g=a[w],a.hasOwnProperty(w)&&u[w]!==g&&Et(i,w,g)}else for(var C in a)a.hasOwnProperty(C)&&Et(i,C,a[C])}function fr(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Al=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Xa=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ea(i){return Xa.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function co(){}var rs=null;function es(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Po=null,In=null;function ti(i){var a=Fr(i);if(a&&(i=a.stateNode)){var u=i[Si]||null;e:switch(i=a.stateNode,a.type){case"input":if(Xl(i,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),a=u.name,u.type==="radio"&&a!=null){for(u=i;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+bi(""+a)+'"][type="radio"]'),a=0;a<u.length;a++){var g=u[a];if(g!==i&&g.form===i.form){var w=g[Si]||null;if(!w)throw Error(n(90));Xl(g,w.value,w.defaultValue,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name)}}for(a=0;a<u.length;a++)g=u[a],g.form===i.form&&_r(g)}break e;case"textarea":sl(i,u.value,u.defaultValue);break e;case"select":a=u.value,a!=null&&kr(i,!!u.multiple,a,!1)}}}var Tn=!1;function Hc(i,a,u){if(Tn)return i(a,u);Tn=!0;try{var g=i(a);return g}finally{if(Tn=!1,(Po!==null||In!==null)&&(Kp(),Po&&(a=Po,i=In,In=Po=null,ti(a),i)))for(a=0;a<i.length;a++)ti(i[a])}}function xa(i,a){var u=i.stateNode;if(u===null)return null;var g=u[Si]||null;if(g===null)return null;u=g[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(i=i.type,g=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!g;break e;default:i=!1}if(i)return null;if(u&&typeof u!="function")throw Error(n(231,a,typeof u));return u}var ln=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Cn=!1;if(ln)try{var ri={};Object.defineProperty(ri,"passive",{get:function(){Cn=!0}}),window.addEventListener("test",ri,ri),window.removeEventListener("test",ri,ri)}catch{Cn=!1}var tn=null,ai=null,pn=null;function Zd(){if(pn)return pn;var i,a=ai,u=a.length,g,w="value"in tn?tn.value:tn.textContent,C=w.length;for(i=0;i<u&&a[i]===w[i];i++);var W=u-i;for(g=1;g<=W&&a[u-g]===w[C-g];g++);return pn=w.slice(i,1<g?1-g:void 0)}function It(i){var a=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&a===13&&(i=13)):i=a,i===10&&(i=13),32<=i||i===13?i:0}function Pi(){return!0}function Yt(){return!1}function Gn(i){function a(u,g,w,C,W){this._reactName=u,this._targetInst=w,this.type=g,this.nativeEvent=C,this.target=W,this.currentTarget=null;for(var le in i)i.hasOwnProperty(le)&&(u=i[le],this[le]=u?u(C):C[le]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?Pi:Yt,this.isPropagationStopped=Yt,this}return b(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Pi)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Pi)},persist:function(){},isPersistent:Pi}),a}var Ur={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ka=Gn(Ur),Zs=b({},Ur,{view:0,detail:0}),rl=Gn(Zs),Ra,Za,al,vc=b({},Zs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hn,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==al&&(al&&i.type==="mousemove"?(Ra=i.screenX-al.screenX,Za=i.screenY-al.screenY):Za=Ra=0,al=i),Ra)},movementY:function(i){return"movementY"in i?i.movementY:Za}}),Kl=Gn(vc),Tl=b({},vc,{dataTransfer:0}),Eo=Gn(Tl),Jd=b({},Zs,{relatedTarget:0}),gn=Gn(Jd),Ro=b({},Ur,{animationName:0,elapsedTime:0,pseudoElement:0}),P=Gn(Ro),ee=b({},Ur,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),we=Gn(ee),De=b({},Ur,{data:0}),Fe=Gn(De),rt={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},mt={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Vt={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mn(i){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(i):(i=Vt[i])?!!a[i]:!1}function hn(){return mn}var Jn=b({},Zs,{key:function(i){if(i.key){var a=rt[i.key]||i.key;if(a!=="Unidentified")return a}return i.type==="keypress"?(i=It(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?mt[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hn,charCode:function(i){return i.type==="keypress"?It(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?It(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),vi=Gn(Jn),Us=b({},vc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ni=Gn(Us),Wi=b({},Zs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hn}),Ei=Gn(Wi),ks=b({},Ur,{propertyName:0,elapsedTime:0,pseudoElement:0}),as=Gn(ks),uo=b({},vc,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Nr=Gn(uo),ol=b({},Ur,{newState:0,oldState:0}),pr=Gn(ol),ll=[9,13,27,32],Hs=ln&&"CompositionEvent"in window,ba=null;ln&&"documentMode"in document&&(ba=document.documentMode);var gr=ln&&"TextEvent"in window&&!ba,Ja=ln&&(!Hs||ba&&8<ba&&11>=ba),oi=" ",ho=!1;function wc(i,a){switch(i){case"keyup":return ll.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nd(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Qa=!1;function Hr(i,a){switch(i){case"compositionend":return nd(a);case"keypress":return a.which!==32?null:(ho=!0,oi);case"textInput":return i=a.data,i===oi&&ho?null:i;default:return null}}function Do(i,a){if(Qa)return i==="compositionend"||!Hs&&wc(i,a)?(i=Zd(),pn=ai=tn=null,Qa=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Ja&&a.locale!=="ko"?null:a.data;default:return null}}var Sc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lo(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a==="input"?!!Sc[i.type]:a==="textarea"}function va(i,a,u,g){Po?In?In.push(g):In=[g]:Po=g,a=ig(a,"onChange"),0<a.length&&(u=new Ka("onChange","change",null,u,g),i.push({event:u,listeners:a}))}var nr=null,eo=null;function cl(i){o1(i,0)}function fo(i){var a=xi(i);if(_r(a))return i}function po(i,a){if(i==="change")return a}var wa=!1;if(ln){var ir;if(ln){var Mo="oninput"in document;if(!Mo){var Da=document.createElement("div");Da.setAttribute("oninput","return;"),Mo=typeof Da.oninput=="function"}ir=Mo}else ir=!1;wa=ir&&(!document.documentMode||9<document.documentMode)}function _i(){nr&&(nr.detachEvent("onpropertychange",zo),eo=nr=null)}function zo(i){if(i.propertyName==="value"&&fo(eo)){var a=[];va(a,eo,i,es(i)),Hc(cl,a)}}function os(i,a,u){i==="focusin"?(_i(),nr=a,eo=u,nr.attachEvent("onpropertychange",zo)):i==="focusout"&&_i()}function ws(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return fo(eo)}function id(i,a){if(i==="click")return fo(a)}function La(i,a){if(i==="input"||i==="change")return fo(a)}function Cl(i,a){return i===a&&(i!==0||1/i===1/a)||i!==i&&a!==a}var Pr=typeof Object.is=="function"?Object.is:Cl;function Zl(i,a){if(Pr(i,a))return!0;if(typeof i!="object"||i===null||typeof a!="object"||a===null)return!1;var u=Object.keys(i),g=Object.keys(a);if(u.length!==g.length)return!1;for(g=0;g<u.length;g++){var w=u[g];if(!at.call(a,w)||!Pr(i[w],a[w]))return!1}return!0}function sd(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function to(i,a){var u=sd(i);i=0;for(var g;u;){if(u.nodeType===3){if(g=i+u.textContent.length,i<=a&&g>=a)return{node:u,offset:a-i};i=g}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=sd(u)}}function dl(i,a){return i&&a?i===a?!0:i&&i.nodeType===3?!1:a&&a.nodeType===3?dl(i,a.parentNode):"contains"in i?i.contains(a):i.compareDocumentPosition?!!(i.compareDocumentPosition(a)&16):!1:!1}function Io(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var a=us(i.document);a instanceof i.HTMLIFrameElement;){try{var u=typeof a.contentWindow.location.href=="string"}catch{u=!1}if(u)i=a.contentWindow;else break;a=us(i.document)}return a}function Sa(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a&&(a==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||a==="textarea"||i.contentEditable==="true")}var qr=ln&&"documentMode"in document&&11>=document.documentMode,Ma=null,Bo=null,Aa=null,go=!1;function $i(i,a,u){var g=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;go||Ma==null||Ma!==us(g)||(g=Ma,"selectionStart"in g&&Sa(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),Aa&&Zl(Aa,g)||(Aa=g,g=ig(Bo,"onSelect"),0<g.length&&(a=new Ka("onSelect","select",null,a,u),i.push({event:a,listeners:g}),a.target=Ma)))}function Ri(i,a){var u={};return u[i.toLowerCase()]=a.toLowerCase(),u["Webkit"+i]="webkit"+a,u["Moz"+i]="moz"+a,u}var Ss={animationend:Ri("Animation","AnimationEnd"),animationiteration:Ri("Animation","AnimationIteration"),animationstart:Ri("Animation","AnimationStart"),transitionrun:Ri("Transition","TransitionRun"),transitionstart:Ri("Transition","TransitionStart"),transitioncancel:Ri("Transition","TransitionCancel"),transitionend:Ri("Transition","TransitionEnd")},sr={},_l={};ln&&(_l=document.createElement("div").style,"AnimationEvent"in window||(delete Ss.animationend.animation,delete Ss.animationiteration.animation,delete Ss.animationstart.animation),"TransitionEvent"in window||delete Ss.transitionend.transition);function ul(i){if(sr[i])return sr[i];if(!Ss[i])return i;var a=Ss[i],u;for(u in a)if(a.hasOwnProperty(u)&&u in _l)return sr[i]=a[u];return i}var rr=ul("animationend"),Ta=ul("animationiteration"),kl=ul("animationstart"),hl=ul("transitionrun"),jl=ul("transitionstart"),Jl=ul("transitioncancel"),Nl=ul("transitionend"),no=new Map,Pl="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Pl.push("scrollEnd");function hs(i,a){no.set(i,a),ma(a,[i])}var ki=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},qs=[],Vs=0,za=0;function Nd(){for(var i=Vs,a=za=Vs=0;a<i;){var u=qs[a];qs[a++]=null;var g=qs[a];qs[a++]=null;var w=qs[a];qs[a++]=null;var C=qs[a];if(qs[a++]=null,g!==null&&w!==null){var W=g.pending;W===null?w.next=w:(w.next=W.next,W.next=w),g.pending=w}C!==0&&Fi(u,w,C)}}function fl(i,a,u,g){qs[Vs++]=i,qs[Vs++]=a,qs[Vs++]=u,qs[Vs++]=g,za|=g,i.lanes|=g,i=i.alternate,i!==null&&(i.lanes|=g)}function Pd(i,a,u,g){return fl(i,a,u,g),ls(i)}function Oo(i,a){return fl(i,null,null,a),ls(i)}function Fi(i,a,u){i.lanes|=u;var g=i.alternate;g!==null&&(g.lanes|=u);for(var w=!1,C=i.return;C!==null;)C.childLanes|=u,g=C.alternate,g!==null&&(g.childLanes|=u),C.tag===22&&(i=C.stateNode,i===null||i._visibility&1||(w=!0)),i=C,C=C.return;return i.tag===3?(C=i.stateNode,w&&a!==null&&(w=31-lt(u),i=C.hiddenUpdates,g=i[w],g===null?i[w]=[a]:g.push(a),a.lane=u|536870912),C):null}function ls(i){if(50<Ff)throw Ff=0,m0=null,Error(n(185));for(var a=i.return;a!==null;)i=a,a=i.return;return i.tag===3?i.stateNode:null}var Er={};function Ed(i,a,u,g){this.tag=i,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ia(i,a,u,g){return new Ed(i,a,u,g)}function rd(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Ia(i,a){var u=i.alternate;return u===null?(u=ia(i.tag,a,i.key,i.mode),u.elementType=i.elementType,u.type=i.type,u.stateNode=i.stateNode,u.alternate=i,i.alternate=u):(u.pendingProps=a,u.type=i.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=i.flags&65011712,u.childLanes=i.childLanes,u.lanes=i.lanes,u.child=i.child,u.memoizedProps=i.memoizedProps,u.memoizedState=i.memoizedState,u.updateQueue=i.updateQueue,a=i.dependencies,u.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},u.sibling=i.sibling,u.index=i.index,u.ref=i.ref,u.refCleanup=i.refCleanup,u}function qc(i,a){i.flags&=65011714;var u=i.alternate;return u===null?(i.childLanes=0,i.lanes=a,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=u.childLanes,i.lanes=u.lanes,i.child=u.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=u.memoizedProps,i.memoizedState=u.memoizedState,i.updateQueue=u.updateQueue,i.type=u.type,a=u.dependencies,i.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),i}function El(i,a,u,g,w,C){var W=0;if(g=i,typeof i=="function")rd(i)&&(W=1);else if(typeof i=="string")W=pw(i,u,Y.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case G:return i=ia(31,u,a,w),i.elementType=G,i.lanes=C,i;case x:return Ql(u.children,w,C,a);case k:W=8,w|=24;break;case j:return i=ia(12,u,a,w|2),i.elementType=j,i.lanes=C,i;case F:return i=ia(13,u,a,w),i.elementType=F,i.lanes=C,i;case I:return i=ia(19,u,a,w),i.elementType=I,i.lanes=C,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case z:W=10;break e;case $:W=9;break e;case B:W=11;break e;case X:W=14;break e;case M:W=16,g=null;break e}W=29,u=Error(n(130,i===null?"null":typeof i,"")),g=null}return a=ia(W,u,a,w),a.elementType=i,a.type=g,a.lanes=C,a}function Ql(i,a,u,g){return i=ia(7,i,g,a),i.lanes=u,i}function pl(i,a,u){return i=ia(6,i,null,a),i.lanes=u,i}function Ac(i){var a=ia(18,null,null,0);return a.stateNode=i,a}function Fo(i,a,u){return a=ia(4,i.children!==null?i.children:[],i.key,a),a.lanes=u,a.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},a}var ec=new WeakMap;function Ba(i,a){if(typeof i=="object"&&i!==null){var u=ec.get(i);return u!==void 0?u:(a={value:i,source:a,stack:Lt(a)},ec.set(i,a),a)}return{value:i,source:a,stack:Lt(a)}}var tc=[],mo=0,Rl=null,ad=0,ar=[],yo=0,Js=null,Oa=1,xo="";function Rr(i,a){tc[mo++]=ad,tc[mo++]=Rl,Rl=i,ad=a}function Tc(i,a,u){ar[yo++]=Oa,ar[yo++]=xo,ar[yo++]=Js,Js=i;var g=Oa;i=xo;var w=32-lt(g)-1;g&=~(1<<w),u+=1;var C=32-lt(a)+w;if(30<C){var W=w-w%5;C=(g&(1<<W)-1).toString(32),g>>=W,w-=W,Oa=1<<32-lt(a)+w|u<<w|g,xo=C+i}else Oa=1<<C|u<<w|g,xo=i}function od(i){i.return!==null&&(Rr(i,1),Tc(i,1,0))}function nc(i){for(;i===Rl;)Rl=tc[--mo],tc[mo]=null,ad=tc[--mo],tc[mo]=null;for(;i===Js;)Js=ar[--yo],ar[yo]=null,xo=ar[--yo],ar[yo]=null,Oa=ar[--yo],ar[yo]=null}function Dl(i,a){ar[yo++]=Oa,ar[yo++]=xo,ar[yo++]=Js,Oa=a.id,xo=a.overflow,Js=i}var sa=null,As=null,ji=!1,Fa=null,Qs=!1,bo=Error(n(519));function ic(i){var a=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw mr(Ba(a,i)),bo}function Qd(i){var a=i.stateNode,u=i.type,g=i.memoizedProps;switch(a[Ci]=i,a[Si]=g,u){case"dialog":Oi("cancel",a),Oi("close",a);break;case"iframe":case"object":case"embed":Oi("load",a);break;case"video":case"audio":for(u=0;u<Hf.length;u++)Oi(Hf[u],a);break;case"source":Oi("error",a);break;case"img":case"image":case"link":Oi("error",a),Oi("load",a);break;case"details":Oi("toggle",a);break;case"input":Oi("invalid",a),bc(a,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":Oi("invalid",a);break;case"textarea":Oi("invalid",a),Ya(a,g.value,g.defaultValue,g.children)}u=g.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||a.textContent===""+u||g.suppressHydrationWarning===!0||u1(a.textContent,u)?(g.popover!=null&&(Oi("beforetoggle",a),Oi("toggle",a)),g.onScroll!=null&&Oi("scroll",a),g.onScrollEnd!=null&&Oi("scrollend",a),g.onClick!=null&&(a.onclick=co),a=!0):a=!1,a||ic(i,!0)}function Ll(i){for(sa=i.return;sa;)switch(sa.tag){case 5:case 31:case 13:Qs=!1;return;case 27:case 3:Qs=!0;return;default:sa=sa.return}}function Ls(i){if(i!==sa)return!1;if(!ji)return Ll(i),ji=!0,!1;var a=i.tag,u;if((u=a!==3&&a!==27)&&((u=a===5)&&(u=i.type,u=!(u!=="form"&&u!=="button")||E0(i.type,i.memoizedProps)),u=!u),u&&As&&ic(i),Ll(i),a===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));As=v1(i)}else if(a===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));As=v1(i)}else a===27?(a=As,Su(i.type)?(i=z0,z0=null,As=i):As=a):As=sa?Dc(i.stateNode.nextSibling):null;return!0}function or(){As=sa=null,ji=!1}function Ml(){var i=Fa;return i!==null&&(Yi===null?Yi=i:Yi.push.apply(Yi,i),Fa=null),i}function mr(i){Fa===null?Fa=[i]:Fa.push(i)}var lr=Z(null),Vr=null,js=null;function Wr(i,a,u){H(lr,a._currentValue),a._currentValue=u}function ys(i){i._currentValue=lr.current,D(lr)}function Ca(i,a,u){for(;i!==null;){var g=i.alternate;if((i.childLanes&a)!==a?(i.childLanes|=a,g!==null&&(g.childLanes|=a)):g!==null&&(g.childLanes&a)!==a&&(g.childLanes|=a),i===u)break;i=i.return}}function cr(i,a,u,g){var w=i.child;for(w!==null&&(w.return=i);w!==null;){var C=w.dependencies;if(C!==null){var W=w.child;C=C.firstContext;e:for(;C!==null;){var le=C;C=w;for(var Me=0;Me<a.length;Me++)if(le.context===a[Me]){C.lanes|=u,le=C.alternate,le!==null&&(le.lanes|=u),Ca(C.return,u,i),g||(W=null);break e}C=le.next}}else if(w.tag===18){if(W=w.return,W===null)throw Error(n(341));W.lanes|=u,C=W.alternate,C!==null&&(C.lanes|=u),Ca(W,u,i),W=null}else W=w.child;if(W!==null)W.return=w;else for(W=w;W!==null;){if(W===i){W=null;break}if(w=W.sibling,w!==null){w.return=W.return,W=w;break}W=W.return}w=W}}function $r(i,a,u,g){i=null;for(var w=a,C=!1;w!==null;){if(!C){if((w.flags&524288)!==0)C=!0;else if((w.flags&262144)!==0)break}if(w.tag===10){var W=w.alternate;if(W===null)throw Error(n(387));if(W=W.memoizedProps,W!==null){var le=w.type;Pr(w.pendingProps.value,W.value)||(i!==null?i.push(le):i=[le])}}else if(w===Pe.current){if(W=w.alternate,W===null)throw Error(n(387));W.memoizedState.memoizedState!==w.memoizedState.memoizedState&&(i!==null?i.push(Gf):i=[Gf])}w=w.return}i!==null&&cr(a,i,u,g),a.flags|=262144}function Gr(i){for(i=i.firstContext;i!==null;){if(!Pr(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Yr(i){Vr=i,js=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function fs(i){return vo(Vr,i)}function Uo(i,a){return Vr===null&&Yr(i),vo(i,a)}function vo(i,a){var u=a._currentValue;if(a={context:a,memoizedValue:u,next:null},js===null){if(i===null)throw Error(n(308));js=a,i.dependencies={lanes:0,firstContext:a},i.flags|=524288}else js=js.next=a;return u}var sc=typeof AbortController<"u"?AbortController:function(){var i=[],a=this.signal={aborted:!1,addEventListener:function(u,g){i.push(g)}};this.abort=function(){a.aborted=!0,i.forEach(function(u){return u()})}},io=r.unstable_scheduleCallback,Ho=r.unstable_NormalPriority,Di={$$typeof:z,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ra(){return{controller:new sc,data:new Map,refCount:0}}function _a(i){i.refCount--,i.refCount===0&&io(Ho,function(){i.controller.abort()})}var Xr=null,Rn=0,y=0,T=null;function R(i,a){if(Xr===null){var u=Xr=[];Rn=0,y=S0(),T={status:"pending",value:void 0,then:function(g){u.push(g)}}}return Rn++,a.then(O,O),a}function O(){if(--Rn===0&&Xr!==null){T!==null&&(T.status="fulfilled");var i=Xr;Xr=null,y=0,T=null;for(var a=0;a<i.length;a++)(0,i[a])()}}function ne(i,a){var u=[],g={status:"pending",value:null,reason:null,then:function(w){u.push(w)}};return i.then(function(){g.status="fulfilled",g.value=a;for(var w=0;w<u.length;w++)(0,u[w])(a)},function(w){for(g.status="rejected",g.reason=w,w=0;w<u.length;w++)(0,u[w])(void 0)}),g}var se=q.S;q.S=function(i,a){yl=Zn(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&R(i,a),se!==null&&se(i,a)};var ae=Z(null);function de(){var i=ae.current;return i!==null?i:Xe.pooledCache}function me(i,a){a===null?H(ae,ae.current):H(ae,a.pool)}function Te(){var i=de();return i===null?null:{parent:Di._currentValue,pool:i}}var Ie=Error(n(460)),Ze=Error(n(474)),ve=Error(n(542)),Be={then:function(){}};function $e(i){return i=i.status,i==="fulfilled"||i==="rejected"}function ut(i,a,u){switch(u=i[u],u===void 0?i.push(a):u!==a&&(a.then(co,co),a=u),a.status){case"fulfilled":return a.value;case"rejected":throw i=a.reason,Tt(i),i;default:if(typeof a.status=="string")a.then(co,co);else{if(i=Xe,i!==null&&100<i.shellSuspendCounter)throw Error(n(482));i=a,i.status="pending",i.then(function(g){if(a.status==="pending"){var w=a;w.status="fulfilled",w.value=g}},function(g){if(a.status==="pending"){var w=a;w.status="rejected",w.reason=g}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw i=a.reason,Tt(i),i}throw et=a,Ie}}function We(i){try{var a=i._init;return a(i._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(et=u,Ie):u}}var et=null;function gt(){if(et===null)throw Error(n(459));var i=et;return et=null,i}function Tt(i){if(i===Ie||i===ve)throw Error(n(483))}var bt=null,sn=0;function qt(i){var a=sn;return sn+=1,bt===null&&(bt=[]),ut(bt,i,a)}function rn(i,a){a=a.props.ref,i.ref=a!==void 0?a:null}function Bt(i,a){throw a.$$typeof===A?Error(n(525)):(i=Object.prototype.toString.call(a),Error(n(31,i==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":i)))}function ni(i){function a(Ge,Oe){if(i){var Qe=Ge.deletions;Qe===null?(Ge.deletions=[Oe],Ge.flags|=16):Qe.push(Oe)}}function u(Ge,Oe){if(!i)return null;for(;Oe!==null;)a(Ge,Oe),Oe=Oe.sibling;return null}function g(Ge){for(var Oe=new Map;Ge!==null;)Ge.key!==null?Oe.set(Ge.key,Ge):Oe.set(Ge.index,Ge),Ge=Ge.sibling;return Oe}function w(Ge,Oe){return Ge=Ia(Ge,Oe),Ge.index=0,Ge.sibling=null,Ge}function C(Ge,Oe,Qe){return Ge.index=Qe,i?(Qe=Ge.alternate,Qe!==null?(Qe=Qe.index,Qe<Oe?(Ge.flags|=67108866,Oe):Qe):(Ge.flags|=67108866,Oe)):(Ge.flags|=1048576,Oe)}function W(Ge){return i&&Ge.alternate===null&&(Ge.flags|=67108866),Ge}function le(Ge,Oe,Qe,xt){return Oe===null||Oe.tag!==6?(Oe=pl(Qe,Ge.mode,xt),Oe.return=Ge,Oe):(Oe=w(Oe,Qe),Oe.return=Ge,Oe)}function Me(Ge,Oe,Qe,xt){var Dn=Qe.type;return Dn===x?pt(Ge,Oe,Qe.props.children,xt,Qe.key):Oe!==null&&(Oe.elementType===Dn||typeof Dn=="object"&&Dn!==null&&Dn.$$typeof===M&&We(Dn)===Oe.type)?(Oe=w(Oe,Qe.props),rn(Oe,Qe),Oe.return=Ge,Oe):(Oe=El(Qe.type,Qe.key,Qe.props,null,Ge.mode,xt),rn(Oe,Qe),Oe.return=Ge,Oe)}function tt(Ge,Oe,Qe,xt){return Oe===null||Oe.tag!==4||Oe.stateNode.containerInfo!==Qe.containerInfo||Oe.stateNode.implementation!==Qe.implementation?(Oe=Fo(Qe,Ge.mode,xt),Oe.return=Ge,Oe):(Oe=w(Oe,Qe.children||[]),Oe.return=Ge,Oe)}function pt(Ge,Oe,Qe,xt,Dn){return Oe===null||Oe.tag!==7?(Oe=Ql(Qe,Ge.mode,xt,Dn),Oe.return=Ge,Oe):(Oe=w(Oe,Qe),Oe.return=Ge,Oe)}function vt(Ge,Oe,Qe){if(typeof Oe=="string"&&Oe!==""||typeof Oe=="number"||typeof Oe=="bigint")return Oe=pl(""+Oe,Ge.mode,Qe),Oe.return=Ge,Oe;if(typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case v:return Qe=El(Oe.type,Oe.key,Oe.props,null,Ge.mode,Qe),rn(Qe,Oe),Qe.return=Ge,Qe;case E:return Oe=Fo(Oe,Ge.mode,Qe),Oe.return=Ge,Oe;case M:return Oe=We(Oe),vt(Ge,Oe,Qe)}if(re(Oe)||N(Oe))return Oe=Ql(Oe,Ge.mode,Qe,null),Oe.return=Ge,Oe;if(typeof Oe.then=="function")return vt(Ge,qt(Oe),Qe);if(Oe.$$typeof===z)return vt(Ge,Uo(Ge,Oe),Qe);Bt(Ge,Oe)}return null}function nt(Ge,Oe,Qe,xt){var Dn=Oe!==null?Oe.key:null;if(typeof Qe=="string"&&Qe!==""||typeof Qe=="number"||typeof Qe=="bigint")return Dn!==null?null:le(Ge,Oe,""+Qe,xt);if(typeof Qe=="object"&&Qe!==null){switch(Qe.$$typeof){case v:return Qe.key===Dn?Me(Ge,Oe,Qe,xt):null;case E:return Qe.key===Dn?tt(Ge,Oe,Qe,xt):null;case M:return Qe=We(Qe),nt(Ge,Oe,Qe,xt)}if(re(Qe)||N(Qe))return Dn!==null?null:pt(Ge,Oe,Qe,xt,null);if(typeof Qe.then=="function")return nt(Ge,Oe,qt(Qe),xt);if(Qe.$$typeof===z)return nt(Ge,Oe,Uo(Ge,Qe),xt);Bt(Ge,Qe)}return null}function ot(Ge,Oe,Qe,xt,Dn){if(typeof xt=="string"&&xt!==""||typeof xt=="number"||typeof xt=="bigint")return Ge=Ge.get(Qe)||null,le(Oe,Ge,""+xt,Dn);if(typeof xt=="object"&&xt!==null){switch(xt.$$typeof){case v:return Ge=Ge.get(xt.key===null?Qe:xt.key)||null,Me(Oe,Ge,xt,Dn);case E:return Ge=Ge.get(xt.key===null?Qe:xt.key)||null,tt(Oe,Ge,xt,Dn);case M:return xt=We(xt),ot(Ge,Oe,Qe,xt,Dn)}if(re(xt)||N(xt))return Ge=Ge.get(Qe)||null,pt(Oe,Ge,xt,Dn,null);if(typeof xt.then=="function")return ot(Ge,Oe,Qe,qt(xt),Dn);if(xt.$$typeof===z)return ot(Ge,Oe,Qe,Uo(Oe,xt),Dn);Bt(Oe,xt)}return null}function dn(Ge,Oe,Qe,xt){for(var Dn=null,gs=null,xn=Oe,Ti=Oe=0,qi=null;xn!==null&&Ti<Qe.length;Ti++){xn.index>Ti?(qi=xn,xn=null):qi=xn.sibling;var ms=nt(Ge,xn,Qe[Ti],xt);if(ms===null){xn===null&&(xn=qi);break}i&&xn&&ms.alternate===null&&a(Ge,xn),Oe=C(ms,Oe,Ti),gs===null?Dn=ms:gs.sibling=ms,gs=ms,xn=qi}if(Ti===Qe.length)return u(Ge,xn),ji&&Rr(Ge,Ti),Dn;if(xn===null){for(;Ti<Qe.length;Ti++)xn=vt(Ge,Qe[Ti],xt),xn!==null&&(Oe=C(xn,Oe,Ti),gs===null?Dn=xn:gs.sibling=xn,gs=xn);return ji&&Rr(Ge,Ti),Dn}for(xn=g(xn);Ti<Qe.length;Ti++)qi=ot(xn,Ge,Ti,Qe[Ti],xt),qi!==null&&(i&&qi.alternate!==null&&xn.delete(qi.key===null?Ti:qi.key),Oe=C(qi,Oe,Ti),gs===null?Dn=qi:gs.sibling=qi,gs=qi);return i&&xn.forEach(function(ku){return a(Ge,ku)}),ji&&Rr(Ge,Ti),Dn}function Wn(Ge,Oe,Qe,xt){if(Qe==null)throw Error(n(151));for(var Dn=null,gs=null,xn=Oe,Ti=Oe=0,qi=null,ms=Qe.next();xn!==null&&!ms.done;Ti++,ms=Qe.next()){xn.index>Ti?(qi=xn,xn=null):qi=xn.sibling;var ku=nt(Ge,xn,ms.value,xt);if(ku===null){xn===null&&(xn=qi);break}i&&xn&&ku.alternate===null&&a(Ge,xn),Oe=C(ku,Oe,Ti),gs===null?Dn=ku:gs.sibling=ku,gs=ku,xn=qi}if(ms.done)return u(Ge,xn),ji&&Rr(Ge,Ti),Dn;if(xn===null){for(;!ms.done;Ti++,ms=Qe.next())ms=vt(Ge,ms.value,xt),ms!==null&&(Oe=C(ms,Oe,Ti),gs===null?Dn=ms:gs.sibling=ms,gs=ms);return ji&&Rr(Ge,Ti),Dn}for(xn=g(xn);!ms.done;Ti++,ms=Qe.next())ms=ot(xn,Ge,Ti,ms.value,xt),ms!==null&&(i&&ms.alternate!==null&&xn.delete(ms.key===null?Ti:ms.key),Oe=C(ms,Oe,Ti),gs===null?Dn=ms:gs.sibling=ms,gs=ms);return i&&xn.forEach(function(Cw){return a(Ge,Cw)}),ji&&Rr(Ge,Ti),Dn}function Bs(Ge,Oe,Qe,xt){if(typeof Qe=="object"&&Qe!==null&&Qe.type===x&&Qe.key===null&&(Qe=Qe.props.children),typeof Qe=="object"&&Qe!==null){switch(Qe.$$typeof){case v:e:{for(var Dn=Qe.key;Oe!==null;){if(Oe.key===Dn){if(Dn=Qe.type,Dn===x){if(Oe.tag===7){u(Ge,Oe.sibling),xt=w(Oe,Qe.props.children),xt.return=Ge,Ge=xt;break e}}else if(Oe.elementType===Dn||typeof Dn=="object"&&Dn!==null&&Dn.$$typeof===M&&We(Dn)===Oe.type){u(Ge,Oe.sibling),xt=w(Oe,Qe.props),rn(xt,Qe),xt.return=Ge,Ge=xt;break e}u(Ge,Oe);break}else a(Ge,Oe);Oe=Oe.sibling}Qe.type===x?(xt=Ql(Qe.props.children,Ge.mode,xt,Qe.key),xt.return=Ge,Ge=xt):(xt=El(Qe.type,Qe.key,Qe.props,null,Ge.mode,xt),rn(xt,Qe),xt.return=Ge,Ge=xt)}return W(Ge);case E:e:{for(Dn=Qe.key;Oe!==null;){if(Oe.key===Dn)if(Oe.tag===4&&Oe.stateNode.containerInfo===Qe.containerInfo&&Oe.stateNode.implementation===Qe.implementation){u(Ge,Oe.sibling),xt=w(Oe,Qe.children||[]),xt.return=Ge,Ge=xt;break e}else{u(Ge,Oe);break}else a(Ge,Oe);Oe=Oe.sibling}xt=Fo(Qe,Ge.mode,xt),xt.return=Ge,Ge=xt}return W(Ge);case M:return Qe=We(Qe),Bs(Ge,Oe,Qe,xt)}if(re(Qe))return dn(Ge,Oe,Qe,xt);if(N(Qe)){if(Dn=N(Qe),typeof Dn!="function")throw Error(n(150));return Qe=Dn.call(Qe),Wn(Ge,Oe,Qe,xt)}if(typeof Qe.then=="function")return Bs(Ge,Oe,qt(Qe),xt);if(Qe.$$typeof===z)return Bs(Ge,Oe,Uo(Ge,Qe),xt);Bt(Ge,Qe)}return typeof Qe=="string"&&Qe!==""||typeof Qe=="number"||typeof Qe=="bigint"?(Qe=""+Qe,Oe!==null&&Oe.tag===6?(u(Ge,Oe.sibling),xt=w(Oe,Qe),xt.return=Ge,Ge=xt):(u(Ge,Oe),xt=pl(Qe,Ge.mode,xt),xt.return=Ge,Ge=xt),W(Ge)):u(Ge,Oe)}return function(Ge,Oe,Qe,xt){try{sn=0;var Dn=Bs(Ge,Oe,Qe,xt);return bt=null,Dn}catch(xn){if(xn===Ie||xn===ve)throw xn;var gs=ia(29,xn,null,Ge.mode);return gs.lanes=xt,gs.return=Ge,gs}finally{}}}var ts=ni(!0),Yn=ni(!1),Ht=!1;function Rt(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ws(i,a){i=i.updateQueue,a.updateQueue===i&&(a.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Pn(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Hn(i,a,u){var g=i.updateQueue;if(g===null)return null;if(g=g.shared,(ze&2)!==0){var w=g.pending;return w===null?a.next=a:(a.next=w.next,w.next=a),g.pending=a,a=ls(i),Fi(i,null,u),a}return fl(i,g,a,u),ls(i)}function si(i,a,u){if(a=a.updateQueue,a!==null&&(a=a.shared,(u&4194048)!==0)){var g=a.lanes;g&=i.pendingLanes,u|=g,a.lanes=u,fa(i,u)}}function Ui(i,a){var u=i.updateQueue,g=i.alternate;if(g!==null&&(g=g.updateQueue,u===g)){var w=null,C=null;if(u=u.firstBaseUpdate,u!==null){do{var W={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};C===null?w=C=W:C=C.next=W,u=u.next}while(u!==null);C===null?w=C=a:C=C.next=a}else w=C=a;u={baseState:g.baseState,firstBaseUpdate:w,lastBaseUpdate:C,shared:g.shared,callbacks:g.callbacks},i.updateQueue=u;return}i=u.lastBaseUpdate,i===null?u.firstBaseUpdate=a:i.next=a,u.lastBaseUpdate=a}var Ts=!1;function Li(){if(Ts){var i=T;if(i!==null)throw i}}function Ms(i,a,u,g){Ts=!1;var w=i.updateQueue;Ht=!1;var C=w.firstBaseUpdate,W=w.lastBaseUpdate,le=w.shared.pending;if(le!==null){w.shared.pending=null;var Me=le,tt=Me.next;Me.next=null,W===null?C=tt:W.next=tt,W=Me;var pt=i.alternate;pt!==null&&(pt=pt.updateQueue,le=pt.lastBaseUpdate,le!==W&&(le===null?pt.firstBaseUpdate=tt:le.next=tt,pt.lastBaseUpdate=Me))}if(C!==null){var vt=w.baseState;W=0,pt=tt=Me=null,le=C;do{var nt=le.lane&-536870913,ot=nt!==le.lane;if(ot?(dt&nt)===nt:(g&nt)===nt){nt!==0&&nt===y&&(Ts=!0),pt!==null&&(pt=pt.next={lane:0,tag:le.tag,payload:le.payload,callback:null,next:null});e:{var dn=i,Wn=le;nt=a;var Bs=u;switch(Wn.tag){case 1:if(dn=Wn.payload,typeof dn=="function"){vt=dn.call(Bs,vt,nt);break e}vt=dn;break e;case 3:dn.flags=dn.flags&-65537|128;case 0:if(dn=Wn.payload,nt=typeof dn=="function"?dn.call(Bs,vt,nt):dn,nt==null)break e;vt=b({},vt,nt);break e;case 2:Ht=!0}}nt=le.callback,nt!==null&&(i.flags|=64,ot&&(i.flags|=8192),ot=w.callbacks,ot===null?w.callbacks=[nt]:ot.push(nt))}else ot={lane:nt,tag:le.tag,payload:le.payload,callback:le.callback,next:null},pt===null?(tt=pt=ot,Me=vt):pt=pt.next=ot,W|=nt;if(le=le.next,le===null){if(le=w.shared.pending,le===null)break;ot=le,le=ot.next,ot.next=null,w.lastBaseUpdate=ot,w.shared.pending=null}}while(!0);pt===null&&(Me=vt),w.baseState=Me,w.firstBaseUpdate=tt,w.lastBaseUpdate=pt,C===null&&(w.shared.lanes=0),jt|=W,i.lanes=W,i.memoizedState=vt}}function Kr(i,a){if(typeof i!="function")throw Error(n(191,i));i.call(a)}function Gi(i,a){var u=i.callbacks;if(u!==null)for(i.callbacks=null,i=0;i<u.length;i++)Kr(u[i],a)}var ii=Z(null),Mi=Z(0);function zs(i,a){i=Xn,H(Mi,i),H(ii,a),Xn=i|a.baseLanes}function zi(){H(Mi,Xn),H(ii,ii.current)}function yr(){Xn=Mi.current,D(ii),D(Mi)}var Ns=Z(null),gi=null;function Cs(i){var a=i.alternate;H(Ii,Ii.current&1),H(Ns,i),gi===null&&(a===null||ii.current!==null||a.memoizedState!==null)&&(gi=i)}function Hi(i){H(Ii,Ii.current),H(Ns,i),gi===null&&(gi=i)}function er(i){i.tag===22?(H(Ii,Ii.current),H(Ns,i),gi===null&&(gi=i)):dr()}function dr(){H(Ii,Ii.current),H(Ns,Ns.current)}function ns(i){D(Ns),gi===i&&(gi=null),D(Ii)}var Ii=Z(0);function xr(i){for(var a=i;a!==null;){if(a.tag===13){var u=a.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||L0(u)||M0(u)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var _s=0,bn=null,vn=null,Ai=null,Zr=!1,so=!1,aa=!1,$s=0,zl=0,Cc=null,Il=0;function ps(){throw Error(n(321))}function Vc(i,a){if(a===null)return!1;for(var u=0;u<a.length&&u<i.length;u++)if(!Pr(i[u],a[u]))return!1;return!0}function eu(i,a,u,g,w,C){return _s=C,bn=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,q.H=i===null||i.memoizedState===null?Tf:hd,aa=!1,C=u(g,w),aa=!1,so&&(C=qo(a,u,g,w)),Rd(i),C}function Rd(i){q.H=Vo;var a=vn!==null&&vn.next!==null;if(_s=0,Ai=vn=bn=null,Zr=!1,zl=0,Cc=null,a)throw Error(n(300));i===null||br||(i=i.dependencies,i!==null&&Gr(i)&&(br=!0))}function qo(i,a,u,g){bn=i;var w=0;do{if(so&&(Cc=null),zl=0,so=!1,25<=w)throw Error(n(301));if(w+=1,Ai=vn=null,i.updateQueue!=null){var C=i.updateQueue;C.lastEffect=null,C.events=null,C.stores=null,C.memoCache!=null&&(C.memoCache.index=0)}q.H=Cf,C=a(u,g)}while(so);return C}function xh(){var i=q.H,a=i.useState()[0];return a=typeof a.then=="function"?wo(a):a,i=i.useState()[0],(vn!==null?vn.memoizedState:null)!==i&&(bn.flags|=1024),a}function _c(){var i=$s!==0;return $s=0,i}function Dd(i,a,u){a.updateQueue=i.updateQueue,a.flags&=-2053,i.lanes&=~u}function Ld(i){if(Zr){for(i=i.memoizedState;i!==null;){var a=i.queue;a!==null&&(a.pending=null),i=i.next}Zr=!1}_s=0,Ai=vn=bn=null,so=!1,zl=$s=0,Cc=null}function Dr(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ai===null?bn.memoizedState=Ai=i:Ai=Ai.next=i,Ai}function Ps(){if(vn===null){var i=bn.alternate;i=i!==null?i.memoizedState:null}else i=vn.next;var a=Ai===null?bn.memoizedState:Ai.next;if(a!==null)Ai=a,vn=i;else{if(i===null)throw bn.alternate===null?Error(n(467)):Error(n(310));vn=i,i={memoizedState:vn.memoizedState,baseState:vn.baseState,baseQueue:vn.baseQueue,queue:vn.queue,next:null},Ai===null?bn.memoizedState=Ai=i:Ai=Ai.next=i}return Ai}function kc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function wo(i){var a=zl;return zl+=1,Cc===null&&(Cc=[]),i=ut(Cc,i,a),a=bn,(Ai===null?a.memoizedState:Ai.next)===null&&(a=a.alternate,q.H=a===null||a.memoizedState===null?Tf:hd),i}function rc(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return wo(i);if(i.$$typeof===z)return fs(i)}throw Error(n(438,String(i)))}function gl(i){var a=null,u=bn.updateQueue;if(u!==null&&(a=u.memoCache),a==null){var g=bn.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(a={data:g.data.map(function(w){return w.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),u===null&&(u=kc(),bn.updateQueue=u),u.memoCache=a,u=a.data[a.index],u===void 0)for(u=a.data[a.index]=Array(i),g=0;g<i;g++)u[g]=U;return a.index++,u}function Bl(i,a){return typeof a=="function"?a(i):a}function ld(i){var a=Ps();return cd(a,vn,i)}function cd(i,a,u){var g=i.queue;if(g===null)throw Error(n(311));g.lastRenderedReducer=u;var w=i.baseQueue,C=g.pending;if(C!==null){if(w!==null){var W=w.next;w.next=C.next,C.next=W}a.baseQueue=w=C,g.pending=null}if(C=i.baseState,w===null)i.memoizedState=C;else{a=w.next;var le=W=null,Me=null,tt=a,pt=!1;do{var vt=tt.lane&-536870913;if(vt!==tt.lane?(dt&vt)===vt:(_s&vt)===vt){var nt=tt.revertLane;if(nt===0)Me!==null&&(Me=Me.next={lane:0,revertLane:0,gesture:null,action:tt.action,hasEagerState:tt.hasEagerState,eagerState:tt.eagerState,next:null}),vt===y&&(pt=!0);else if((_s&nt)===nt){tt=tt.next,nt===y&&(pt=!0);continue}else vt={lane:0,revertLane:tt.revertLane,gesture:null,action:tt.action,hasEagerState:tt.hasEagerState,eagerState:tt.eagerState,next:null},Me===null?(le=Me=vt,W=C):Me=Me.next=vt,bn.lanes|=nt,jt|=nt;vt=tt.action,aa&&u(C,vt),C=tt.hasEagerState?tt.eagerState:u(C,vt)}else nt={lane:vt,revertLane:tt.revertLane,gesture:tt.gesture,action:tt.action,hasEagerState:tt.hasEagerState,eagerState:tt.eagerState,next:null},Me===null?(le=Me=nt,W=C):Me=Me.next=nt,bn.lanes|=vt,jt|=vt;tt=tt.next}while(tt!==null&&tt!==a);if(Me===null?W=C:Me.next=le,!Pr(C,i.memoizedState)&&(br=!0,pt&&(u=T,u!==null)))throw u;i.memoizedState=C,i.baseState=W,i.baseQueue=Me,g.lastRenderedState=C}return w===null&&(g.lanes=0),[i.memoizedState,g.dispatch]}function Wc(i){var a=Ps(),u=a.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=i;var g=u.dispatch,w=u.pending,C=a.memoizedState;if(w!==null){u.pending=null;var W=w=w.next;do C=i(C,W.action),W=W.next;while(W!==w);Pr(C,a.memoizedState)||(br=!0),a.memoizedState=C,a.baseQueue===null&&(a.baseState=C),u.lastRenderedState=C}return[C,g]}function So(i,a,u){var g=bn,w=Ps(),C=ji;if(C){if(u===void 0)throw Error(n(407));u=u()}else u=a();var W=!Pr((vn||w).memoizedState,u);if(W&&(w.memoizedState=u,br=!0),w=w.queue,ud(Iu.bind(null,g,w,i),[i]),w.getSnapshot!==a||W||Ai!==null&&Ai.memoizedState.tag&1){if(g.flags|=2048,Gc(9,{destroy:void 0},ml.bind(null,g,w,u,a),null),Xe===null)throw Error(n(349));C||(_s&127)!==0||Jr(g,a,u)}return u}function Jr(i,a,u){i.flags|=16384,i={getSnapshot:a,value:u},a=bn.updateQueue,a===null?(a=kc(),bn.updateQueue=a,a.stores=[i]):(u=a.stores,u===null?a.stores=[i]:u.push(i))}function ml(i,a,u,g){a.value=u,a.getSnapshot=g,bh(a)&&Bu(i)}function Iu(i,a,u){return u(function(){bh(a)&&Bu(i)})}function bh(i){var a=i.getSnapshot;i=i.value;try{var u=a();return!Pr(i,u)}catch{return!0}}function Bu(i){var a=Oo(i,2);a!==null&&ql(a,i,2)}function jc(i){var a=Dr();if(typeof i=="function"){var u=i;if(i=u(),aa){Sn(!0);try{u()}finally{Sn(!1)}}}return a.memoizedState=a.baseState=i,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bl,lastRenderedState:i},a}function vh(i,a,u,g){return i.baseState=u,cd(i,vn,typeof g=="function"?g:Bl)}function wh(i,a,u,g,w){if(du(i))throw Error(n(485));if(i=a.action,i!==null){var C={payload:w,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(W){C.listeners.push(W)}};q.T!==null?u(!0):C.isTransition=!1,g(C),u=a.pending,u===null?(C.next=a.pending=C,Ou(a,C)):(C.next=u.next,a.pending=u.next=C)}}function Ou(i,a){var u=a.action,g=a.payload,w=i.state;if(a.isTransition){var C=q.T,W={};q.T=W;try{var le=u(w,g),Me=q.S;Me!==null&&Me(W,le),tu(i,a,le)}catch(tt){$c(i,a,tt)}finally{C!==null&&W.types!==null&&(C.types=W.types),q.T=C}}else try{C=u(w,g),tu(i,a,C)}catch(tt){$c(i,a,tt)}}function tu(i,a,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(g){ac(i,a,g)},function(g){return $c(i,a,g)}):ac(i,a,u)}function ac(i,a,u){a.status="fulfilled",a.value=u,nu(a),i.state=u,a=i.pending,a!==null&&(u=a.next,u===a?i.pending=null:(u=u.next,a.next=u,Ou(i,u)))}function $c(i,a,u){var g=i.pending;if(i.pending=null,g!==null){g=g.next;do a.status="rejected",a.reason=u,nu(a),a=a.next;while(a!==g)}i.action=null}function nu(i){i=i.listeners;for(var a=0;a<i.length;a++)(0,i[a])()}function Md(i,a){return a}function Ol(i,a){if(ji){var u=Xe.formState;if(u!==null){e:{var g=bn;if(ji){if(As){t:{for(var w=As,C=Qs;w.nodeType!==8;){if(!C){w=null;break t}if(w=Dc(w.nextSibling),w===null){w=null;break t}}C=w.data,w=C==="F!"||C==="F"?w:null}if(w){As=Dc(w.nextSibling),g=w.data==="F!";break e}}ic(g)}g=!1}g&&(a=u[0])}}return u=Dr(),u.memoizedState=u.baseState=a,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Md,lastRenderedState:a},u.queue=g,u=qu.bind(null,bn,g),g.dispatch=u,g=jc(!1),C=Wu.bind(null,bn,!1,g.queue),g=Dr(),w={state:a,dispatch:null,action:i,pending:null},g.queue=w,u=wh.bind(null,bn,w,C,u),w.dispatch=u,g.memoizedState=i,[a,u,!1]}function oc(i){var a=Ps();return lc(a,vn,i)}function lc(i,a,u){if(a=cd(i,a,Md)[0],i=ld(Bl)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var g=wo(a)}catch(W){throw W===Ie?ve:W}else g=a;a=Ps();var w=a.queue,C=w.dispatch;return u!==a.memoizedState&&(bn.flags|=2048,Gc(9,{destroy:void 0},iu.bind(null,w,u),null)),[g,C,i]}function iu(i,a){i.action=a}function su(i){var a=Ps(),u=vn;if(u!==null)return lc(a,u,i);Ps(),a=a.memoizedState,u=Ps();var g=u.queue.dispatch;return u.memoizedState=i,[a,g,!1]}function Gc(i,a,u,g){return i={tag:i,create:u,deps:g,inst:a,next:null},a=bn.updateQueue,a===null&&(a=kc(),bn.updateQueue=a),u=a.lastEffect,u===null?a.lastEffect=i.next=i:(g=u.next,u.next=i,i.next=g,a.lastEffect=i),i}function Sh(){return Ps().memoizedState}function dd(i,a,u,g){var w=Dr();bn.flags|=i,w.memoizedState=Gc(1|a,{destroy:void 0},u,g===void 0?null:g)}function Fl(i,a,u,g){var w=Ps();g=g===void 0?null:g;var C=w.memoizedState.inst;vn!==null&&g!==null&&Vc(g,vn.memoizedState.deps)?w.memoizedState=Gc(a,C,u,g):(bn.flags|=i,w.memoizedState=Gc(1|a,C,u,g))}function zd(i,a){dd(8390656,8,i,a)}function ud(i,a){Fl(2048,8,i,a)}function Ah(i){bn.flags|=4;var a=bn.updateQueue;if(a===null)a=kc(),bn.updateQueue=a,a.events=[i];else{var u=a.events;u===null?a.events=[i]:u.push(i)}}function ru(i){var a=Ps().memoizedState;return Ah({ref:a,nextImpl:i}),function(){if((ze&2)!==0)throw Error(n(440));return a.impl.apply(void 0,arguments)}}function Th(i,a){return Fl(4,2,i,a)}function au(i,a){return Fl(4,4,i,a)}function ou(i,a){if(typeof a=="function"){i=i();var u=a(i);return function(){typeof u=="function"?u():a(null)}}if(a!=null)return i=i(),a.current=i,function(){a.current=null}}function lu(i,a,u){u=u!=null?u.concat([i]):null,Fl(4,4,ou.bind(null,a,i),u)}function cu(){}function Fu(i,a){var u=Ps();a=a===void 0?null:a;var g=u.memoizedState;return a!==null&&Vc(a,g[1])?g[0]:(u.memoizedState=[i,a],i)}function Ep(i,a){var u=Ps();a=a===void 0?null:a;var g=u.memoizedState;if(a!==null&&Vc(a,g[1]))return g[0];if(g=i(),aa){Sn(!0);try{i()}finally{Sn(!1)}}return u.memoizedState=[g,a],g}function Uu(i,a,u){return u===void 0||(_s&1073741824)!==0&&(dt&261930)===0?i.memoizedState=a:(i.memoizedState=u,i=Iy(),bn.lanes|=i,jt|=i,u)}function cc(i,a,u,g){return Pr(u,a)?u:ii.current!==null?(i=Uu(i,u,g),Pr(i,a)||(br=!0),i):(_s&42)===0||(_s&1073741824)!==0&&(dt&261930)===0?(br=!0,i.memoizedState=u):(i=Iy(),bn.lanes|=i,jt|=i,a)}function Ch(i,a,u,g,w){var C=J.p;J.p=C!==0&&8>C?C:8;var W=q.T,le={};q.T=le,Wu(i,!1,a,u);try{var Me=w(),tt=q.S;if(tt!==null&&tt(le,Me),Me!==null&&typeof Me=="object"&&typeof Me.then=="function"){var pt=ne(Me,g);Vu(i,a,pt,fc(i))}else Vu(i,a,g,fc(i))}catch(vt){Vu(i,a,{then:function(){},status:"rejected",reason:vt},fc())}finally{J.p=C,W!==null&&le.types!==null&&(W.types=le.types),q.T=W}}function f0(){}function Sf(i,a,u,g){if(i.tag!==5)throw Error(n(476));var w=Yc(i).queue;Ch(i,w,a,ce,u===null?f0:function(){return Rp(i),u(g)})}function Yc(i){var a=i.memoizedState;if(a!==null)return a;a={memoizedState:ce,baseState:ce,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bl,lastRenderedState:ce},next:null};var u={};return a.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bl,lastRenderedState:u},next:null},i.memoizedState=a,i=i.alternate,i!==null&&(i.memoizedState=a),a}function Rp(i){var a=Yc(i);a.next===null&&(a=i.alternate.memoizedState),Vu(i,a.next.queue,{},fc())}function Hu(){return fs(Gf)}function Af(){return Ps().memoizedState}function _h(){return Ps().memoizedState}function kh(i){for(var a=i.return;a!==null;){switch(a.tag){case 24:case 3:var u=fc();i=Pn(u);var g=Hn(a,i,u);g!==null&&(ql(g,a,u),si(g,a,u)),a={cache:ra()},i.payload=a;return}a=a.return}}function jh(i,a,u){var g=fc();u={lane:g,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},du(i)?Dp(a,u):(u=Pd(i,a,u,g),u!==null&&(ql(u,i,g),Lp(u,a,g)))}function qu(i,a,u){var g=fc();Vu(i,a,u,g)}function Vu(i,a,u,g){var w={lane:g,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(du(i))Dp(a,w);else{var C=i.alternate;if(i.lanes===0&&(C===null||C.lanes===0)&&(C=a.lastRenderedReducer,C!==null))try{var W=a.lastRenderedState,le=C(W,u);if(w.hasEagerState=!0,w.eagerState=le,Pr(le,W))return fl(i,a,w,0),Xe===null&&Nd(),!1}catch{}finally{}if(u=Pd(i,a,w,g),u!==null)return ql(u,i,g),Lp(u,a,g),!0}return!1}function Wu(i,a,u,g){if(g={lane:2,revertLane:S0(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},du(i)){if(a)throw Error(n(479))}else a=Pd(i,u,g,2),a!==null&&ql(a,i,2)}function du(i){var a=i.alternate;return i===bn||a!==null&&a===bn}function Dp(i,a){so=Zr=!0;var u=i.pending;u===null?a.next=a:(a.next=u.next,u.next=a),i.pending=a}function Lp(i,a,u){if((u&4194048)!==0){var g=a.lanes;g&=i.pendingLanes,u|=g,a.lanes=u,fa(i,u)}}var Vo={readContext:fs,use:rc,useCallback:ps,useContext:ps,useEffect:ps,useImperativeHandle:ps,useLayoutEffect:ps,useInsertionEffect:ps,useMemo:ps,useReducer:ps,useRef:ps,useState:ps,useDebugValue:ps,useDeferredValue:ps,useTransition:ps,useSyncExternalStore:ps,useId:ps,useHostTransitionStatus:ps,useFormState:ps,useActionState:ps,useOptimistic:ps,useMemoCache:ps,useCacheRefresh:ps};Vo.useEffectEvent=ps;var Tf={readContext:fs,use:rc,useCallback:function(i,a){return Dr().memoizedState=[i,a===void 0?null:a],i},useContext:fs,useEffect:zd,useImperativeHandle:function(i,a,u){u=u!=null?u.concat([i]):null,dd(4194308,4,ou.bind(null,a,i),u)},useLayoutEffect:function(i,a){return dd(4194308,4,i,a)},useInsertionEffect:function(i,a){dd(4,2,i,a)},useMemo:function(i,a){var u=Dr();a=a===void 0?null:a;var g=i();if(aa){Sn(!0);try{i()}finally{Sn(!1)}}return u.memoizedState=[g,a],g},useReducer:function(i,a,u){var g=Dr();if(u!==void 0){var w=u(a);if(aa){Sn(!0);try{u(a)}finally{Sn(!1)}}}else w=a;return g.memoizedState=g.baseState=w,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:w},g.queue=i,i=i.dispatch=jh.bind(null,bn,i),[g.memoizedState,i]},useRef:function(i){var a=Dr();return i={current:i},a.memoizedState=i},useState:function(i){i=jc(i);var a=i.queue,u=qu.bind(null,bn,a);return a.dispatch=u,[i.memoizedState,u]},useDebugValue:cu,useDeferredValue:function(i,a){var u=Dr();return Uu(u,i,a)},useTransition:function(){var i=jc(!1);return i=Ch.bind(null,bn,i.queue,!0,!1),Dr().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,a,u){var g=bn,w=Dr();if(ji){if(u===void 0)throw Error(n(407));u=u()}else{if(u=a(),Xe===null)throw Error(n(349));(dt&127)!==0||Jr(g,a,u)}w.memoizedState=u;var C={value:u,getSnapshot:a};return w.queue=C,zd(Iu.bind(null,g,C,i),[i]),g.flags|=2048,Gc(9,{destroy:void 0},ml.bind(null,g,C,u,a),null),u},useId:function(){var i=Dr(),a=Xe.identifierPrefix;if(ji){var u=xo,g=Oa;u=(g&~(1<<32-lt(g)-1)).toString(32)+u,a="_"+a+"R_"+u,u=$s++,0<u&&(a+="H"+u.toString(32)),a+="_"}else u=Il++,a="_"+a+"r_"+u.toString(32)+"_";return i.memoizedState=a},useHostTransitionStatus:Hu,useFormState:Ol,useActionState:Ol,useOptimistic:function(i){var a=Dr();a.memoizedState=a.baseState=i;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=u,a=Wu.bind(null,bn,!0,u),u.dispatch=a,[i,a]},useMemoCache:gl,useCacheRefresh:function(){return Dr().memoizedState=kh.bind(null,bn)},useEffectEvent:function(i){var a=Dr(),u={impl:i};return a.memoizedState=u,function(){if((ze&2)!==0)throw Error(n(440));return u.impl.apply(void 0,arguments)}}},hd={readContext:fs,use:rc,useCallback:Fu,useContext:fs,useEffect:ud,useImperativeHandle:lu,useInsertionEffect:Th,useLayoutEffect:au,useMemo:Ep,useReducer:ld,useRef:Sh,useState:function(){return ld(Bl)},useDebugValue:cu,useDeferredValue:function(i,a){var u=Ps();return cc(u,vn.memoizedState,i,a)},useTransition:function(){var i=ld(Bl)[0],a=Ps().memoizedState;return[typeof i=="boolean"?i:wo(i),a]},useSyncExternalStore:So,useId:Af,useHostTransitionStatus:Hu,useFormState:oc,useActionState:oc,useOptimistic:function(i,a){var u=Ps();return vh(u,vn,i,a)},useMemoCache:gl,useCacheRefresh:_h};hd.useEffectEvent=ru;var Cf={readContext:fs,use:rc,useCallback:Fu,useContext:fs,useEffect:ud,useImperativeHandle:lu,useInsertionEffect:Th,useLayoutEffect:au,useMemo:Ep,useReducer:Wc,useRef:Sh,useState:function(){return Wc(Bl)},useDebugValue:cu,useDeferredValue:function(i,a){var u=Ps();return vn===null?Uu(u,i,a):cc(u,vn.memoizedState,i,a)},useTransition:function(){var i=Wc(Bl)[0],a=Ps().memoizedState;return[typeof i=="boolean"?i:wo(i),a]},useSyncExternalStore:So,useId:Af,useHostTransitionStatus:Hu,useFormState:su,useActionState:su,useOptimistic:function(i,a){var u=Ps();return vn!==null?vh(u,vn,i,a):(u.baseState=i,[i,u.queue.dispatch])},useMemoCache:gl,useCacheRefresh:_h};Cf.useEffectEvent=ru;function Nc(i,a,u,g){a=i.memoizedState,u=u(g,a),u=u==null?a:b({},a,u),i.memoizedState=u,i.lanes===0&&(i.updateQueue.baseState=u)}var $u={enqueueSetState:function(i,a,u){i=i._reactInternals;var g=fc(),w=Pn(g);w.payload=a,u!=null&&(w.callback=u),a=Hn(i,w,g),a!==null&&(ql(a,i,g),si(a,i,g))},enqueueReplaceState:function(i,a,u){i=i._reactInternals;var g=fc(),w=Pn(g);w.tag=1,w.payload=a,u!=null&&(w.callback=u),a=Hn(i,w,g),a!==null&&(ql(a,i,g),si(a,i,g))},enqueueForceUpdate:function(i,a){i=i._reactInternals;var u=fc(),g=Pn(u);g.tag=2,a!=null&&(g.callback=a),a=Hn(i,g,u),a!==null&&(ql(a,i,u),si(a,i,u))}};function _f(i,a,u,g,w,C,W){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(g,C,W):a.prototype&&a.prototype.isPureReactComponent?!Zl(u,g)||!Zl(w,C):!0}function kf(i,a,u,g){i=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(u,g),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(u,g),a.state!==i&&$u.enqueueReplaceState(a,a.state,null)}function Id(i,a){var u=a;if("ref"in a){u={};for(var g in a)g!=="ref"&&(u[g]=a[g])}if(i=i.defaultProps){u===a&&(u=b({},u));for(var w in i)u[w]===void 0&&(u[w]=i[w])}return u}function Mp(i){ki(i)}function zp(i){console.error(i)}function Gu(i){ki(i)}function Yu(i,a){try{var u=i.onUncaughtError;u(a.value,{componentStack:a.stack})}catch(g){setTimeout(function(){throw g})}}function Ip(i,a,u){try{var g=i.onCaughtError;g(u.value,{componentStack:u.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(w){setTimeout(function(){throw w})}}function Nh(i,a,u){return u=Pn(u),u.tag=3,u.payload={element:null},u.callback=function(){Yu(i,a)},u}function uu(i){return i=Pn(i),i.tag=3,i}function Bp(i,a,u,g){var w=u.type.getDerivedStateFromError;if(typeof w=="function"){var C=g.value;i.payload=function(){return w(C)},i.callback=function(){Ip(a,u,g)}}var W=u.stateNode;W!==null&&typeof W.componentDidCatch=="function"&&(i.callback=function(){Ip(a,u,g),typeof w!="function"&&(xu===null?xu=new Set([this]):xu.add(this));var le=g.stack;this.componentDidCatch(g.value,{componentStack:le!==null?le:""})})}function jf(i,a,u,g,w){if(u.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(a=u.alternate,a!==null&&$r(a,u,w,!0),u=Ns.current,u!==null){switch(u.tag){case 31:case 13:return gi===null?Zp():u.alternate===null&&Ft===0&&(Ft=3),u.flags&=-257,u.flags|=65536,u.lanes=w,g===Be?u.flags|=16384:(a=u.updateQueue,a===null?u.updateQueue=new Set([g]):a.add(g),b0(i,g,w)),!1;case 22:return u.flags|=65536,g===Be?u.flags|=16384:(a=u.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([g])},u.updateQueue=a):(u=a.retryQueue,u===null?a.retryQueue=new Set([g]):u.add(g)),b0(i,g,w)),!1}throw Error(n(435,u.tag))}return b0(i,g,w),Zp(),!1}if(ji)return a=Ns.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=w,g!==bo&&(i=Error(n(422),{cause:g}),mr(Ba(i,u)))):(g!==bo&&(a=Error(n(423),{cause:g}),mr(Ba(a,u))),i=i.current.alternate,i.flags|=65536,w&=-w,i.lanes|=w,g=Ba(g,u),w=Nh(i.stateNode,g,w),Ui(i,w),Ft!==4&&(Ft=2)),!1;var C=Error(n(520),{cause:g});if(C=Ba(C,u),tr===null?tr=[C]:tr.push(C),Ft!==4&&(Ft=2),a===null)return!0;g=Ba(g,u),u=a;do{switch(u.tag){case 3:return u.flags|=65536,i=w&-w,u.lanes|=i,i=Nh(u.stateNode,g,i),Ui(u,i),!1;case 1:if(a=u.type,C=u.stateNode,(u.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(xu===null||!xu.has(C))))return u.flags|=65536,w&=-w,u.lanes|=w,w=uu(w),Bp(w,i,u,g),Ui(u,w),!1}u=u.return}while(u!==null);return!1}var Ph=Error(n(461)),br=!1;function oa(i,a,u,g){a.child=i===null?Yn(a,null,u,g):ts(a,i.child,u,g)}function Op(i,a,u,g,w){u=u.render;var C=a.ref;if("ref"in g){var W={};for(var le in g)le!=="ref"&&(W[le]=g[le])}else W=g;return Yr(a),g=eu(i,a,u,W,C,w),le=_c(),i!==null&&!br?(Dd(i,a,w),Ec(i,a,w)):(ji&&le&&od(a),a.flags|=1,oa(i,a,g,w),a.child)}function Fp(i,a,u,g,w){if(i===null){var C=u.type;return typeof C=="function"&&!rd(C)&&C.defaultProps===void 0&&u.compare===null?(a.tag=15,a.type=C,Nf(i,a,C,g,w)):(i=El(u.type,null,g,a,a.mode,w),i.ref=a.ref,i.return=a,a.child=i)}if(C=i.child,!Lh(i,w)){var W=C.memoizedProps;if(u=u.compare,u=u!==null?u:Zl,u(W,g)&&i.ref===a.ref)return Ec(i,a,w)}return a.flags|=1,i=Ia(C,g),i.ref=a.ref,i.return=a,a.child=i}function Nf(i,a,u,g,w){if(i!==null){var C=i.memoizedProps;if(Zl(C,g)&&i.ref===a.ref)if(br=!1,a.pendingProps=g=C,Lh(i,w))(i.flags&131072)!==0&&(br=!0);else return a.lanes=i.lanes,Ec(i,a,w)}return Ku(i,a,u,g,w)}function hu(i,a,u,g){var w=g.children,C=i!==null?i.memoizedState:null;if(i===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((a.flags&128)!==0){if(C=C!==null?C.baseLanes|u:u,i!==null){for(g=a.child=i.child,w=0;g!==null;)w=w|g.lanes|g.childLanes,g=g.sibling;g=w&~C}else g=0,a.child=null;return fd(i,a,C,u,g)}if((u&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},i!==null&&me(a,C!==null?C.cachePool:null),C!==null?zs(a,C):zi(),er(a);else return g=a.lanes=536870912,fd(i,a,C!==null?C.baseLanes|u:u,u,g)}else C!==null?(me(a,C.cachePool),zs(a,C),dr(),a.memoizedState=null):(i!==null&&me(a,null),zi(),dr());return oa(i,a,w,u),a.child}function Bd(i,a){return i!==null&&i.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function fd(i,a,u,g,w){var C=de();return C=C===null?null:{parent:Di._currentValue,pool:C},a.memoizedState={baseLanes:u,cachePool:C},i!==null&&me(a,null),zi(),er(a),i!==null&&$r(i,a,g,!0),a.childLanes=w,null}function Od(i,a){return a=Fd({mode:a.mode,children:a.children},i.mode),a.ref=i.ref,i.child=a,a.return=i,a}function Pc(i,a,u){return ts(a,i.child,null,u),i=Od(a,a.pendingProps),i.flags|=2,ns(a),a.memoizedState=null,i}function Xu(i,a,u){var g=a.pendingProps,w=(a.flags&128)!==0;if(a.flags&=-129,i===null){if(ji){if(g.mode==="hidden")return i=Od(a,g),a.lanes=536870912,Bd(null,i);if(Hi(a),(i=As)?(i=b1(i,Qs),i=i!==null&&i.data==="&"?i:null,i!==null&&(a.memoizedState={dehydrated:i,treeContext:Js!==null?{id:Oa,overflow:xo}:null,retryLane:536870912,hydrationErrors:null},u=Ac(i),u.return=a,a.child=u,sa=a,As=null)):i=null,i===null)throw ic(a);return a.lanes=536870912,null}return Od(a,g)}var C=i.memoizedState;if(C!==null){var W=C.dehydrated;if(Hi(a),w)if(a.flags&256)a.flags&=-257,a=Pc(i,a,u);else if(a.memoizedState!==null)a.child=i.child,a.flags|=128,a=null;else throw Error(n(558));else if(br||$r(i,a,u,!1),w=(u&i.childLanes)!==0,br||w){if(g=Xe,g!==null&&(W=At(g,u),W!==0&&W!==C.retryLane))throw C.retryLane=W,Oo(i,W),ql(g,i,W),Ph;Zp(),a=Pc(i,a,u)}else i=C.treeContext,As=Dc(W.nextSibling),sa=a,ji=!0,Fa=null,Qs=!1,i!==null&&Dl(a,i),a=Od(a,g),a.flags|=4096;return a}return i=Ia(i.child,{mode:g.mode,children:g.children}),i.ref=a.ref,a.child=i,i.return=a,i}function fu(i,a){var u=a.ref;if(u===null)i!==null&&i.ref!==null&&(a.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(n(284));(i===null||i.ref!==u)&&(a.flags|=4194816)}}function Ku(i,a,u,g,w){return Yr(a),u=eu(i,a,u,g,void 0,w),g=_c(),i!==null&&!br?(Dd(i,a,w),Ec(i,a,w)):(ji&&g&&od(a),a.flags|=1,oa(i,a,u,w),a.child)}function Eh(i,a,u,g,w,C){return Yr(a),a.updateQueue=null,u=qo(a,g,u,w),Rd(i),g=_c(),i!==null&&!br?(Dd(i,a,C),Ec(i,a,C)):(ji&&g&&od(a),a.flags|=1,oa(i,a,u,C),a.child)}function ro(i,a,u,g,w){if(Yr(a),a.stateNode===null){var C=Er,W=u.contextType;typeof W=="object"&&W!==null&&(C=fs(W)),C=new u(g,C),a.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,C.updater=$u,a.stateNode=C,C._reactInternals=a,C=a.stateNode,C.props=g,C.state=a.memoizedState,C.refs={},Rt(a),W=u.contextType,C.context=typeof W=="object"&&W!==null?fs(W):Er,C.state=a.memoizedState,W=u.getDerivedStateFromProps,typeof W=="function"&&(Nc(a,u,W,g),C.state=a.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(W=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),W!==C.state&&$u.enqueueReplaceState(C,C.state,null),Ms(a,g,C,w),Li(),C.state=a.memoizedState),typeof C.componentDidMount=="function"&&(a.flags|=4194308),g=!0}else if(i===null){C=a.stateNode;var le=a.memoizedProps,Me=Id(u,le);C.props=Me;var tt=C.context,pt=u.contextType;W=Er,typeof pt=="object"&&pt!==null&&(W=fs(pt));var vt=u.getDerivedStateFromProps;pt=typeof vt=="function"||typeof C.getSnapshotBeforeUpdate=="function",le=a.pendingProps!==le,pt||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(le||tt!==W)&&kf(a,C,g,W),Ht=!1;var nt=a.memoizedState;C.state=nt,Ms(a,g,C,w),Li(),tt=a.memoizedState,le||nt!==tt||Ht?(typeof vt=="function"&&(Nc(a,u,vt,g),tt=a.memoizedState),(Me=Ht||_f(a,u,Me,g,nt,tt,W))?(pt||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(a.flags|=4194308)):(typeof C.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=g,a.memoizedState=tt),C.props=g,C.state=tt,C.context=W,g=Me):(typeof C.componentDidMount=="function"&&(a.flags|=4194308),g=!1)}else{C=a.stateNode,Ws(i,a),W=a.memoizedProps,pt=Id(u,W),C.props=pt,vt=a.pendingProps,nt=C.context,tt=u.contextType,Me=Er,typeof tt=="object"&&tt!==null&&(Me=fs(tt)),le=u.getDerivedStateFromProps,(tt=typeof le=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(W!==vt||nt!==Me)&&kf(a,C,g,Me),Ht=!1,nt=a.memoizedState,C.state=nt,Ms(a,g,C,w),Li();var ot=a.memoizedState;W!==vt||nt!==ot||Ht||i!==null&&i.dependencies!==null&&Gr(i.dependencies)?(typeof le=="function"&&(Nc(a,u,le,g),ot=a.memoizedState),(pt=Ht||_f(a,u,pt,g,nt,ot,Me)||i!==null&&i.dependencies!==null&&Gr(i.dependencies))?(tt||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(g,ot,Me),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(g,ot,Me)),typeof C.componentDidUpdate=="function"&&(a.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof C.componentDidUpdate!="function"||W===i.memoizedProps&&nt===i.memoizedState||(a.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||W===i.memoizedProps&&nt===i.memoizedState||(a.flags|=1024),a.memoizedProps=g,a.memoizedState=ot),C.props=g,C.state=ot,C.context=Me,g=pt):(typeof C.componentDidUpdate!="function"||W===i.memoizedProps&&nt===i.memoizedState||(a.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||W===i.memoizedProps&&nt===i.memoizedState||(a.flags|=1024),g=!1)}return C=g,fu(i,a),g=(a.flags&128)!==0,C||g?(C=a.stateNode,u=g&&typeof u.getDerivedStateFromError!="function"?null:C.render(),a.flags|=1,i!==null&&g?(a.child=ts(a,i.child,null,w),a.child=ts(a,null,u,w)):oa(i,a,u,w),a.memoizedState=C.state,i=a.child):i=Ec(i,a,w),i}function Pf(i,a,u,g){return or(),a.flags|=256,oa(i,a,u,g),a.child}var Ef={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Rh(i){return{baseLanes:i,cachePool:Te()}}function Rf(i,a,u){return i=i!==null?i.childLanes&~u:0,a&&(i|=Bi),i}function Df(i,a,u){var g=a.pendingProps,w=!1,C=(a.flags&128)!==0,W;if((W=C)||(W=i!==null&&i.memoizedState===null?!1:(Ii.current&2)!==0),W&&(w=!0,a.flags&=-129),W=(a.flags&32)!==0,a.flags&=-33,i===null){if(ji){if(w?Cs(a):dr(),(i=As)?(i=b1(i,Qs),i=i!==null&&i.data!=="&"?i:null,i!==null&&(a.memoizedState={dehydrated:i,treeContext:Js!==null?{id:Oa,overflow:xo}:null,retryLane:536870912,hydrationErrors:null},u=Ac(i),u.return=a,a.child=u,sa=a,As=null)):i=null,i===null)throw ic(a);return M0(i)?a.lanes=32:a.lanes=536870912,null}var le=g.children;return g=g.fallback,w?(dr(),w=a.mode,le=Fd({mode:"hidden",children:le},w),g=Ql(g,w,u,null),le.return=a,g.return=a,le.sibling=g,a.child=le,g=a.child,g.memoizedState=Rh(u),g.childLanes=Rf(i,W,u),a.memoizedState=Ef,Bd(null,g)):(Cs(a),Dh(a,le))}var Me=i.memoizedState;if(Me!==null&&(le=Me.dehydrated,le!==null)){if(C)a.flags&256?(Cs(a),a.flags&=-257,a=dc(i,a,u)):a.memoizedState!==null?(dr(),a.child=i.child,a.flags|=128,a=null):(dr(),le=g.fallback,w=a.mode,g=Fd({mode:"visible",children:g.children},w),le=Ql(le,w,u,null),le.flags|=2,g.return=a,le.return=a,g.sibling=le,a.child=g,ts(a,i.child,null,u),g=a.child,g.memoizedState=Rh(u),g.childLanes=Rf(i,W,u),a.memoizedState=Ef,a=Bd(null,g));else if(Cs(a),M0(le)){if(W=le.nextSibling&&le.nextSibling.dataset,W)var tt=W.dgst;W=tt,g=Error(n(419)),g.stack="",g.digest=W,mr({value:g,source:null,stack:null}),a=dc(i,a,u)}else if(br||$r(i,a,u,!1),W=(u&i.childLanes)!==0,br||W){if(W=Xe,W!==null&&(g=At(W,u),g!==0&&g!==Me.retryLane))throw Me.retryLane=g,Oo(i,g),ql(W,i,g),Ph;L0(le)||Zp(),a=dc(i,a,u)}else L0(le)?(a.flags|=192,a.child=i.child,a=null):(i=Me.treeContext,As=Dc(le.nextSibling),sa=a,ji=!0,Fa=null,Qs=!1,i!==null&&Dl(a,i),a=Dh(a,g.children),a.flags|=4096);return a}return w?(dr(),le=g.fallback,w=a.mode,Me=i.child,tt=Me.sibling,g=Ia(Me,{mode:"hidden",children:g.children}),g.subtreeFlags=Me.subtreeFlags&65011712,tt!==null?le=Ia(tt,le):(le=Ql(le,w,u,null),le.flags|=2),le.return=a,g.return=a,g.sibling=le,a.child=g,Bd(null,g),g=a.child,le=i.child.memoizedState,le===null?le=Rh(u):(w=le.cachePool,w!==null?(Me=Di._currentValue,w=w.parent!==Me?{parent:Me,pool:Me}:w):w=Te(),le={baseLanes:le.baseLanes|u,cachePool:w}),g.memoizedState=le,g.childLanes=Rf(i,W,u),a.memoizedState=Ef,Bd(i.child,g)):(Cs(a),u=i.child,i=u.sibling,u=Ia(u,{mode:"visible",children:g.children}),u.return=a,u.sibling=null,i!==null&&(W=a.deletions,W===null?(a.deletions=[i],a.flags|=16):W.push(i)),a.child=u,a.memoizedState=null,u)}function Dh(i,a){return a=Fd({mode:"visible",children:a},i.mode),a.return=i,i.child=a}function Fd(i,a){return i=ia(22,i,null,a),i.lanes=0,i}function dc(i,a,u){return ts(a,i.child,null,u),i=Dh(a,a.pendingProps.children),i.flags|=2,a.memoizedState=null,i}function Lf(i,a,u){i.lanes|=a;var g=i.alternate;g!==null&&(g.lanes|=a),Ca(i.return,a,u)}function Ul(i,a,u,g,w,C){var W=i.memoizedState;W===null?i.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:g,tail:u,tailMode:w,treeForkCount:C}:(W.isBackwards=a,W.rendering=null,W.renderingStartTime=0,W.last=g,W.tail=u,W.tailMode=w,W.treeForkCount=C)}function uc(i,a,u){var g=a.pendingProps,w=g.revealOrder,C=g.tail;g=g.children;var W=Ii.current,le=(W&2)!==0;if(le?(W=W&1|2,a.flags|=128):W&=1,H(Ii,W),oa(i,a,g,u),g=ji?ad:0,!le&&i!==null&&(i.flags&128)!==0)e:for(i=a.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Lf(i,u,a);else if(i.tag===19)Lf(i,u,a);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break e;for(;i.sibling===null;){if(i.return===null||i.return===a)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(w){case"forwards":for(u=a.child,w=null;u!==null;)i=u.alternate,i!==null&&xr(i)===null&&(w=u),u=u.sibling;u=w,u===null?(w=a.child,a.child=null):(w=u.sibling,u.sibling=null),Ul(a,!1,w,u,C,g);break;case"backwards":case"unstable_legacy-backwards":for(u=null,w=a.child,a.child=null;w!==null;){if(i=w.alternate,i!==null&&xr(i)===null){a.child=w;break}i=w.sibling,w.sibling=u,u=w,w=i}Ul(a,!0,u,null,C,g);break;case"together":Ul(a,!1,null,null,void 0,g);break;default:a.memoizedState=null}return a.child}function Ec(i,a,u){if(i!==null&&(a.dependencies=i.dependencies),jt|=a.lanes,(u&a.childLanes)===0)if(i!==null){if($r(i,a,u,!1),(u&a.childLanes)===0)return null}else return null;if(i!==null&&a.child!==i.child)throw Error(n(153));if(a.child!==null){for(i=a.child,u=Ia(i,i.pendingProps),a.child=u,u.return=a;i.sibling!==null;)i=i.sibling,u=u.sibling=Ia(i,i.pendingProps),u.return=a;u.sibling=null}return a.child}function Lh(i,a){return(i.lanes&a)!==0?!0:(i=i.dependencies,!!(i!==null&&Gr(i)))}function Wo(i,a,u){switch(a.tag){case 3:Ue(a,a.stateNode.containerInfo),Wr(a,Di,i.memoizedState.cache),or();break;case 27:case 5:Ke(a);break;case 4:Ue(a,a.stateNode.containerInfo);break;case 10:Wr(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Hi(a),null;break;case 13:var g=a.memoizedState;if(g!==null)return g.dehydrated!==null?(Cs(a),a.flags|=128,null):(u&a.child.childLanes)!==0?Df(i,a,u):(Cs(a),i=Ec(i,a,u),i!==null?i.sibling:null);Cs(a);break;case 19:var w=(i.flags&128)!==0;if(g=(u&a.childLanes)!==0,g||($r(i,a,u,!1),g=(u&a.childLanes)!==0),w){if(g)return uc(i,a,u);a.flags|=128}if(w=a.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),H(Ii,Ii.current),g)break;return null;case 22:return a.lanes=0,hu(i,a,u,a.pendingProps);case 24:Wr(a,Di,i.memoizedState.cache)}return Ec(i,a,u)}function Ud(i,a,u){if(i!==null)if(i.memoizedProps!==a.pendingProps)br=!0;else{if(!Lh(i,u)&&(a.flags&128)===0)return br=!1,Wo(i,a,u);br=(i.flags&131072)!==0}else br=!1,ji&&(a.flags&1048576)!==0&&Tc(a,ad,a.index);switch(a.lanes=0,a.tag){case 16:e:{var g=a.pendingProps;if(i=We(a.elementType),a.type=i,typeof i=="function")rd(i)?(g=Id(i,g),a.tag=1,a=ro(null,a,i,g,u)):(a.tag=0,a=Ku(null,a,i,g,u));else{if(i!=null){var w=i.$$typeof;if(w===B){a.tag=11,a=Op(null,a,i,g,u);break e}else if(w===X){a.tag=14,a=Fp(null,a,i,g,u);break e}}throw a=ie(i)||i,Error(n(306,a,""))}}return a;case 0:return Ku(i,a,a.type,a.pendingProps,u);case 1:return g=a.type,w=Id(g,a.pendingProps),ro(i,a,g,w,u);case 3:e:{if(Ue(a,a.stateNode.containerInfo),i===null)throw Error(n(387));g=a.pendingProps;var C=a.memoizedState;w=C.element,Ws(i,a),Ms(a,g,null,u);var W=a.memoizedState;if(g=W.cache,Wr(a,Di,g),g!==C.cache&&cr(a,[Di],u,!0),Li(),g=W.element,C.isDehydrated)if(C={element:g,isDehydrated:!1,cache:W.cache},a.updateQueue.baseState=C,a.memoizedState=C,a.flags&256){a=Pf(i,a,g,u);break e}else if(g!==w){w=Ba(Error(n(424)),a),mr(w),a=Pf(i,a,g,u);break e}else{switch(i=a.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(As=Dc(i.firstChild),sa=a,ji=!0,Fa=null,Qs=!0,u=Yn(a,null,g,u),a.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(or(),g===w){a=Ec(i,a,u);break e}oa(i,a,g,u)}a=a.child}return a;case 26:return fu(i,a),i===null?(u=C1(a.type,null,a.pendingProps,null))?a.memoizedState=u:ji||(u=a.type,i=a.pendingProps,g=sg(Ne.current).createElement(u),g[Ci]=a,g[Si]=i,To(g,u,i),En(g),a.stateNode=g):a.memoizedState=C1(a.type,i.memoizedProps,a.pendingProps,i.memoizedState),null;case 27:return Ke(a),i===null&&ji&&(g=a.stateNode=S1(a.type,a.pendingProps,Ne.current),sa=a,Qs=!0,w=As,Su(a.type)?(z0=w,As=Dc(g.firstChild)):As=w),oa(i,a,a.pendingProps.children,u),fu(i,a),i===null&&(a.flags|=4194304),a.child;case 5:return i===null&&ji&&((w=g=As)&&(g=tw(g,a.type,a.pendingProps,Qs),g!==null?(a.stateNode=g,sa=a,As=Dc(g.firstChild),Qs=!1,w=!0):w=!1),w||ic(a)),Ke(a),w=a.type,C=a.pendingProps,W=i!==null?i.memoizedProps:null,g=C.children,E0(w,C)?g=null:W!==null&&E0(w,W)&&(a.flags|=32),a.memoizedState!==null&&(w=eu(i,a,xh,null,null,u),Gf._currentValue=w),fu(i,a),oa(i,a,g,u),a.child;case 6:return i===null&&ji&&((i=u=As)&&(u=nw(u,a.pendingProps,Qs),u!==null?(a.stateNode=u,sa=a,As=null,i=!0):i=!1),i||ic(a)),null;case 13:return Df(i,a,u);case 4:return Ue(a,a.stateNode.containerInfo),g=a.pendingProps,i===null?a.child=ts(a,null,g,u):oa(i,a,g,u),a.child;case 11:return Op(i,a,a.type,a.pendingProps,u);case 7:return oa(i,a,a.pendingProps,u),a.child;case 8:return oa(i,a,a.pendingProps.children,u),a.child;case 12:return oa(i,a,a.pendingProps.children,u),a.child;case 10:return g=a.pendingProps,Wr(a,a.type,g.value),oa(i,a,g.children,u),a.child;case 9:return w=a.type._context,g=a.pendingProps.children,Yr(a),w=fs(w),g=g(w),a.flags|=1,oa(i,a,g,u),a.child;case 14:return Fp(i,a,a.type,a.pendingProps,u);case 15:return Nf(i,a,a.type,a.pendingProps,u);case 19:return uc(i,a,u);case 31:return Xu(i,a,u);case 22:return hu(i,a,u,a.pendingProps);case 24:return Yr(a),g=fs(Di),i===null?(w=de(),w===null&&(w=Xe,C=ra(),w.pooledCache=C,C.refCount++,C!==null&&(w.pooledCacheLanes|=u),w=C),a.memoizedState={parent:g,cache:w},Rt(a),Wr(a,Di,w)):((i.lanes&u)!==0&&(Ws(i,a),Ms(a,null,null,u),Li()),w=i.memoizedState,C=a.memoizedState,w.parent!==g?(w={parent:g,cache:g},a.memoizedState=w,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=w),Wr(a,Di,g)):(g=C.cache,Wr(a,Di,g),g!==w.cache&&cr(a,[Di],u,!0))),oa(i,a,a.pendingProps.children,u),a.child;case 29:throw a.pendingProps}throw Error(n(156,a.tag))}function Ao(i){i.flags|=4}function pu(i,a,u,g,w){if((a=(i.mode&32)!==0)&&(a=!1),a){if(i.flags|=16777216,(w&335544128)===w)if(i.stateNode.complete)i.flags|=8192;else if(Uy())i.flags|=8192;else throw et=Be,Ze}else i.flags&=-16777217}function Mh(i,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!P1(a))if(Uy())i.flags|=8192;else throw et=Be,Ze}function pd(i,a){a!==null&&(i.flags|=4),i.flags&16384&&(a=i.tag!==22?Ir():536870912,i.lanes|=a,ds|=a)}function gu(i,a){if(!ji)switch(i.tailMode){case"hidden":a=i.tail;for(var u=null;a!==null;)a.alternate!==null&&(u=a),a=a.sibling;u===null?i.tail=null:u.sibling=null;break;case"collapsed":u=i.tail;for(var g=null;u!==null;)u.alternate!==null&&(g=u),u=u.sibling;g===null?a||i.tail===null?i.tail=null:i.tail.sibling=null:g.sibling=null}}function Gs(i){var a=i.alternate!==null&&i.alternate.child===i.child,u=0,g=0;if(a)for(var w=i.child;w!==null;)u|=w.lanes|w.childLanes,g|=w.subtreeFlags&65011712,g|=w.flags&65011712,w.return=i,w=w.sibling;else for(w=i.child;w!==null;)u|=w.lanes|w.childLanes,g|=w.subtreeFlags,g|=w.flags,w.return=i,w=w.sibling;return i.subtreeFlags|=g,i.childLanes=u,a}function zh(i,a,u){var g=a.pendingProps;switch(nc(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gs(a),null;case 1:return Gs(a),null;case 3:return u=a.stateNode,g=null,i!==null&&(g=i.memoizedState.cache),a.memoizedState.cache!==g&&(a.flags|=2048),ys(Di),Re(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(i===null||i.child===null)&&(Ls(a)?Ao(a):i===null||i.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Ml())),Gs(a),null;case 26:var w=a.type,C=a.memoizedState;return i===null?(Ao(a),C!==null?(Gs(a),Mh(a,C)):(Gs(a),pu(a,w,null,g,u))):C?C!==i.memoizedState?(Ao(a),Gs(a),Mh(a,C)):(Gs(a),a.flags&=-16777217):(i=i.memoizedProps,i!==g&&Ao(a),Gs(a),pu(a,w,i,g,u)),null;case 27:if(Je(a),u=Ne.current,w=a.type,i!==null&&a.stateNode!=null)i.memoizedProps!==g&&Ao(a);else{if(!g){if(a.stateNode===null)throw Error(n(166));return Gs(a),null}i=Y.current,Ls(a)?Qd(a):(i=S1(w,g,u),a.stateNode=i,Ao(a))}return Gs(a),null;case 5:if(Je(a),w=a.type,i!==null&&a.stateNode!=null)i.memoizedProps!==g&&Ao(a);else{if(!g){if(a.stateNode===null)throw Error(n(166));return Gs(a),null}if(C=Y.current,Ls(a))Qd(a);else{var W=sg(Ne.current);switch(C){case 1:C=W.createElementNS("http://www.w3.org/2000/svg",w);break;case 2:C=W.createElementNS("http://www.w3.org/1998/Math/MathML",w);break;default:switch(w){case"svg":C=W.createElementNS("http://www.w3.org/2000/svg",w);break;case"math":C=W.createElementNS("http://www.w3.org/1998/Math/MathML",w);break;case"script":C=W.createElement("div"),C.innerHTML="<script><\/script>",C=C.removeChild(C.firstChild);break;case"select":C=typeof g.is=="string"?W.createElement("select",{is:g.is}):W.createElement("select"),g.multiple?C.multiple=!0:g.size&&(C.size=g.size);break;default:C=typeof g.is=="string"?W.createElement(w,{is:g.is}):W.createElement(w)}}C[Ci]=a,C[Si]=g;e:for(W=a.child;W!==null;){if(W.tag===5||W.tag===6)C.appendChild(W.stateNode);else if(W.tag!==4&&W.tag!==27&&W.child!==null){W.child.return=W,W=W.child;continue}if(W===a)break e;for(;W.sibling===null;){if(W.return===null||W.return===a)break e;W=W.return}W.sibling.return=W.return,W=W.sibling}a.stateNode=C;e:switch(To(C,w,g),w){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&Ao(a)}}return Gs(a),pu(a,a.type,i===null?null:i.memoizedProps,a.pendingProps,u),null;case 6:if(i&&a.stateNode!=null)i.memoizedProps!==g&&Ao(a);else{if(typeof g!="string"&&a.stateNode===null)throw Error(n(166));if(i=Ne.current,Ls(a)){if(i=a.stateNode,u=a.memoizedProps,g=null,w=sa,w!==null)switch(w.tag){case 27:case 5:g=w.memoizedProps}i[Ci]=a,i=!!(i.nodeValue===u||g!==null&&g.suppressHydrationWarning===!0||u1(i.nodeValue,u)),i||ic(a,!0)}else i=sg(i).createTextNode(g),i[Ci]=a,a.stateNode=i}return Gs(a),null;case 31:if(u=a.memoizedState,i===null||i.memoizedState!==null){if(g=Ls(a),u!==null){if(i===null){if(!g)throw Error(n(318));if(i=a.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(557));i[Ci]=a}else or(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Gs(a),i=!1}else u=Ml(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=u),i=!0;if(!i)return a.flags&256?(ns(a),a):(ns(a),null);if((a.flags&128)!==0)throw Error(n(558))}return Gs(a),null;case 13:if(g=a.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(w=Ls(a),g!==null&&g.dehydrated!==null){if(i===null){if(!w)throw Error(n(318));if(w=a.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(n(317));w[Ci]=a}else or(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Gs(a),w=!1}else w=Ml(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=w),w=!0;if(!w)return a.flags&256?(ns(a),a):(ns(a),null)}return ns(a),(a.flags&128)!==0?(a.lanes=u,a):(u=g!==null,i=i!==null&&i.memoizedState!==null,u&&(g=a.child,w=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(w=g.alternate.memoizedState.cachePool.pool),C=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(C=g.memoizedState.cachePool.pool),C!==w&&(g.flags|=2048)),u!==i&&u&&(a.child.flags|=8192),pd(a,a.updateQueue),Gs(a),null);case 4:return Re(),i===null&&_0(a.stateNode.containerInfo),Gs(a),null;case 10:return ys(a.type),Gs(a),null;case 19:if(D(Ii),g=a.memoizedState,g===null)return Gs(a),null;if(w=(a.flags&128)!==0,C=g.rendering,C===null)if(w)gu(g,!1);else{if(Ft!==0||i!==null&&(i.flags&128)!==0)for(i=a.child;i!==null;){if(C=xr(i),C!==null){for(a.flags|=128,gu(g,!1),i=C.updateQueue,a.updateQueue=i,pd(a,i),a.subtreeFlags=0,i=u,u=a.child;u!==null;)qc(u,i),u=u.sibling;return H(Ii,Ii.current&1|2),ji&&Rr(a,g.treeForkCount),a.child}i=i.sibling}g.tail!==null&&Zn()>Yp&&(a.flags|=128,w=!0,gu(g,!1),a.lanes=4194304)}else{if(!w)if(i=xr(C),i!==null){if(a.flags|=128,w=!0,i=i.updateQueue,a.updateQueue=i,pd(a,i),gu(g,!0),g.tail===null&&g.tailMode==="hidden"&&!C.alternate&&!ji)return Gs(a),null}else 2*Zn()-g.renderingStartTime>Yp&&u!==536870912&&(a.flags|=128,w=!0,gu(g,!1),a.lanes=4194304);g.isBackwards?(C.sibling=a.child,a.child=C):(i=g.last,i!==null?i.sibling=C:a.child=C,g.last=C)}return g.tail!==null?(i=g.tail,g.rendering=i,g.tail=i.sibling,g.renderingStartTime=Zn(),i.sibling=null,u=Ii.current,H(Ii,w?u&1|2:u&1),ji&&Rr(a,g.treeForkCount),i):(Gs(a),null);case 22:case 23:return ns(a),yr(),g=a.memoizedState!==null,i!==null?i.memoizedState!==null!==g&&(a.flags|=8192):g&&(a.flags|=8192),g?(u&536870912)!==0&&(a.flags&128)===0&&(Gs(a),a.subtreeFlags&6&&(a.flags|=8192)):Gs(a),u=a.updateQueue,u!==null&&pd(a,u.retryQueue),u=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),g=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(g=a.memoizedState.cachePool.pool),g!==u&&(a.flags|=2048),i!==null&&D(ae),null;case 24:return u=null,i!==null&&(u=i.memoizedState.cache),a.memoizedState.cache!==u&&(a.flags|=2048),ys(Di),Gs(a),null;case 25:return null;case 30:return null}throw Error(n(156,a.tag))}function Ih(i,a){switch(nc(a),a.tag){case 1:return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 3:return ys(Di),Re(),i=a.flags,(i&65536)!==0&&(i&128)===0?(a.flags=i&-65537|128,a):null;case 26:case 27:case 5:return Je(a),null;case 31:if(a.memoizedState!==null){if(ns(a),a.alternate===null)throw Error(n(340));or()}return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 13:if(ns(a),i=a.memoizedState,i!==null&&i.dehydrated!==null){if(a.alternate===null)throw Error(n(340));or()}return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 19:return D(Ii),null;case 4:return Re(),null;case 10:return ys(a.type),null;case 22:case 23:return ns(a),yr(),i!==null&&D(ae),i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 24:return ys(Di),null;case 25:return null;default:return null}}function Up(i,a){switch(nc(a),a.tag){case 3:ys(Di),Re();break;case 26:case 27:case 5:Je(a);break;case 4:Re();break;case 31:a.memoizedState!==null&&ns(a);break;case 13:ns(a);break;case 19:D(Ii);break;case 10:ys(a.type);break;case 22:case 23:ns(a),yr(),i!==null&&D(ae);break;case 24:ys(Di)}}function Zu(i,a){try{var u=a.updateQueue,g=u!==null?u.lastEffect:null;if(g!==null){var w=g.next;u=w;do{if((u.tag&i)===i){g=void 0;var C=u.create,W=u.inst;g=C(),W.destroy=g}u=u.next}while(u!==w)}}catch(le){Es(a,a.return,le)}}function Rc(i,a,u){try{var g=a.updateQueue,w=g!==null?g.lastEffect:null;if(w!==null){var C=w.next;g=C;do{if((g.tag&i)===i){var W=g.inst,le=W.destroy;if(le!==void 0){W.destroy=void 0,w=a;var Me=u,tt=le;try{tt()}catch(pt){Es(w,Me,pt)}}}g=g.next}while(g!==C)}}catch(pt){Es(a,a.return,pt)}}function mu(i){var a=i.updateQueue;if(a!==null){var u=i.stateNode;try{Gi(a,u)}catch(g){Es(i,i.return,g)}}}function Hp(i,a,u){u.props=Id(i.type,i.memoizedProps),u.state=i.memoizedState;try{u.componentWillUnmount()}catch(g){Es(i,a,g)}}function yu(i,a){try{var u=i.ref;if(u!==null){switch(i.tag){case 26:case 27:case 5:var g=i.stateNode;break;case 30:g=i.stateNode;break;default:g=i.stateNode}typeof u=="function"?i.refCleanup=u(g):u.current=g}}catch(w){Es(i,a,w)}}function Hl(i,a){var u=i.ref,g=i.refCleanup;if(u!==null)if(typeof g=="function")try{g()}catch(w){Es(i,a,w)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(w){Es(i,a,w)}else u.current=null}function qp(i){var a=i.type,u=i.memoizedProps,g=i.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":u.autoFocus&&g.focus();break e;case"img":u.src?g.src=u.src:u.srcSet&&(g.srcset=u.srcSet)}}catch(w){Es(i,i.return,w)}}function Bh(i,a,u){try{var g=i.stateNode;Xv(g,i.type,u,a),g[Si]=a}catch(w){Es(i,i.return,w)}}function Oh(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Su(i.type)||i.tag===4}function Ju(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Oh(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Su(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Mf(i,a,u){var g=i.tag;if(g===5||g===6)i=i.stateNode,a?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(i,a):(a=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,a.appendChild(i),u=u._reactRootContainer,u!=null||a.onclick!==null||(a.onclick=co));else if(g!==4&&(g===27&&Su(i.type)&&(u=i.stateNode,a=null),i=i.child,i!==null))for(Mf(i,a,u),i=i.sibling;i!==null;)Mf(i,a,u),i=i.sibling}function Fh(i,a,u){var g=i.tag;if(g===5||g===6)i=i.stateNode,a?u.insertBefore(i,a):u.appendChild(i);else if(g!==4&&(g===27&&Su(i.type)&&(u=i.stateNode),i=i.child,i!==null))for(Fh(i,a,u),i=i.sibling;i!==null;)Fh(i,a,u),i=i.sibling}function gd(i){var a=i.stateNode,u=i.memoizedProps;try{for(var g=i.type,w=a.attributes;w.length;)a.removeAttributeNode(w[0]);To(a,g,u),a[Ci]=i,a[Si]=u}catch(C){Es(i,i.return,C)}}var $o=!1,ur=!1,zf=!1,Vp=typeof WeakSet=="function"?WeakSet:Set,Qr=null;function If(i,a){if(i=i.containerInfo,N0=ug,i=Io(i),Sa(i)){if("selectionStart"in i)var u={start:i.selectionStart,end:i.selectionEnd};else e:{u=(u=i.ownerDocument)&&u.defaultView||window;var g=u.getSelection&&u.getSelection();if(g&&g.rangeCount!==0){u=g.anchorNode;var w=g.anchorOffset,C=g.focusNode;g=g.focusOffset;try{u.nodeType,C.nodeType}catch{u=null;break e}var W=0,le=-1,Me=-1,tt=0,pt=0,vt=i,nt=null;t:for(;;){for(var ot;vt!==u||w!==0&&vt.nodeType!==3||(le=W+w),vt!==C||g!==0&&vt.nodeType!==3||(Me=W+g),vt.nodeType===3&&(W+=vt.nodeValue.length),(ot=vt.firstChild)!==null;)nt=vt,vt=ot;for(;;){if(vt===i)break t;if(nt===u&&++tt===w&&(le=W),nt===C&&++pt===g&&(Me=W),(ot=vt.nextSibling)!==null)break;vt=nt,nt=vt.parentNode}vt=ot}u=le===-1||Me===-1?null:{start:le,end:Me}}else u=null}u=u||{start:0,end:0}}else u=null;for(P0={focusedElem:i,selectionRange:u},ug=!1,Qr=a;Qr!==null;)if(a=Qr,i=a.child,(a.subtreeFlags&1028)!==0&&i!==null)i.return=a,Qr=i;else for(;Qr!==null;){switch(a=Qr,C=a.alternate,i=a.flags,a.tag){case 0:if((i&4)!==0&&(i=a.updateQueue,i=i!==null?i.events:null,i!==null))for(u=0;u<i.length;u++)w=i[u],w.ref.impl=w.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&C!==null){i=void 0,u=a,w=C.memoizedProps,C=C.memoizedState,g=u.stateNode;try{var dn=Id(u.type,w);i=g.getSnapshotBeforeUpdate(dn,C),g.__reactInternalSnapshotBeforeUpdate=i}catch(Wn){Es(u,u.return,Wn)}}break;case 3:if((i&1024)!==0){if(i=a.stateNode.containerInfo,u=i.nodeType,u===9)D0(i);else if(u===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":D0(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(n(163))}if(i=a.sibling,i!==null){i.return=a.return,Qr=i;break}Qr=a.return}}function Bf(i,a,u){var g=u.flags;switch(u.tag){case 0:case 11:case 15:Ae(i,u),g&4&&Zu(5,u);break;case 1:if(Ae(i,u),g&4)if(i=u.stateNode,a===null)try{i.componentDidMount()}catch(W){Es(u,u.return,W)}else{var w=Id(u.type,a.memoizedProps);a=a.memoizedState;try{i.componentDidUpdate(w,a,i.__reactInternalSnapshotBeforeUpdate)}catch(W){Es(u,u.return,W)}}g&64&&mu(u),g&512&&yu(u,u.return);break;case 3:if(Ae(i,u),g&64&&(i=u.updateQueue,i!==null)){if(a=null,u.child!==null)switch(u.child.tag){case 27:case 5:a=u.child.stateNode;break;case 1:a=u.child.stateNode}try{Gi(i,a)}catch(W){Es(u,u.return,W)}}break;case 27:a===null&&g&4&&gd(u);case 26:case 5:Ae(i,u),a===null&&g&4&&qp(u),g&512&&yu(u,u.return);break;case 12:Ae(i,u);break;case 31:Ae(i,u),g&4&&$p(i,u);break;case 13:Ae(i,u),g&4&&Gp(i,u),g&64&&(i=u.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(u=Iv.bind(null,u),iw(i,u))));break;case 22:if(g=u.memoizedState!==null||$o,!g){a=a!==null&&a.memoizedState!==null||ur,w=$o;var C=ur;$o=g,(ur=a)&&!C?je(i,u,(u.subtreeFlags&8772)!==0):Ae(i,u),$o=w,ur=C}break;case 30:break;default:Ae(i,u)}}function Of(i){var a=i.alternate;a!==null&&(i.alternate=null,Of(a)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(a=i.stateNode,a!==null&&No(a)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Dt=null,la=!1;function hc(i,a,u){for(u=u.child;u!==null;)Wp(i,a,u),u=u.sibling}function Wp(i,a,u){if(on&&typeof on.onCommitFiberUnmount=="function")try{on.onCommitFiberUnmount(Nn,u)}catch{}switch(u.tag){case 26:ur||Hl(u,a),hc(i,a,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:ur||Hl(u,a);var g=Dt,w=la;Su(u.type)&&(Dt=u.stateNode,la=!1),hc(i,a,u),Vf(u.stateNode),Dt=g,la=w;break;case 5:ur||Hl(u,a);case 6:if(g=Dt,w=la,Dt=null,hc(i,a,u),Dt=g,la=w,Dt!==null)if(la)try{(Dt.nodeType===9?Dt.body:Dt.nodeName==="HTML"?Dt.ownerDocument.body:Dt).removeChild(u.stateNode)}catch(C){Es(u,a,C)}else try{Dt.removeChild(u.stateNode)}catch(C){Es(u,a,C)}break;case 18:Dt!==null&&(la?(i=Dt,y1(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,u.stateNode),Yh(i)):y1(Dt,u.stateNode));break;case 4:g=Dt,w=la,Dt=u.stateNode.containerInfo,la=!0,hc(i,a,u),Dt=g,la=w;break;case 0:case 11:case 14:case 15:Rc(2,u,a),ur||Rc(4,u,a),hc(i,a,u);break;case 1:ur||(Hl(u,a),g=u.stateNode,typeof g.componentWillUnmount=="function"&&Hp(u,a,g)),hc(i,a,u);break;case 21:hc(i,a,u);break;case 22:ur=(g=ur)||u.memoizedState!==null,hc(i,a,u),ur=g;break;default:hc(i,a,u)}}function $p(i,a){if(a.memoizedState===null&&(i=a.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Yh(i)}catch(u){Es(a,a.return,u)}}}function Gp(i,a){if(a.memoizedState===null&&(i=a.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Yh(i)}catch(u){Es(a,a.return,u)}}function p(i){switch(i.tag){case 31:case 13:case 19:var a=i.stateNode;return a===null&&(a=i.stateNode=new Vp),a;case 22:return i=i.stateNode,a=i._retryCache,a===null&&(a=i._retryCache=new Vp),a;default:throw Error(n(435,i.tag))}}function S(i,a){var u=p(i);a.forEach(function(g){if(!u.has(g)){u.add(g);var w=Bv.bind(null,i,g);g.then(w,w)}})}function L(i,a){var u=a.deletions;if(u!==null)for(var g=0;g<u.length;g++){var w=u[g],C=i,W=a,le=W;e:for(;le!==null;){switch(le.tag){case 27:if(Su(le.type)){Dt=le.stateNode,la=!1;break e}break;case 5:Dt=le.stateNode,la=!1;break e;case 3:case 4:Dt=le.stateNode.containerInfo,la=!0;break e}le=le.return}if(Dt===null)throw Error(n(160));Wp(C,W,w),Dt=null,la=!1,C=w.alternate,C!==null&&(C.return=null),w.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)oe(a,i),a=a.sibling}var Q=null;function oe(i,a){var u=i.alternate,g=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:L(a,i),he(i),g&4&&(Rc(3,i,i.return),Zu(3,i),Rc(5,i,i.return));break;case 1:L(a,i),he(i),g&512&&(ur||u===null||Hl(u,u.return)),g&64&&$o&&(i=i.updateQueue,i!==null&&(g=i.callbacks,g!==null&&(u=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=u===null?g:u.concat(g))));break;case 26:var w=Q;if(L(a,i),he(i),g&512&&(ur||u===null||Hl(u,u.return)),g&4){var C=u!==null?u.memoizedState:null;if(g=i.memoizedState,u===null)if(g===null)if(i.stateNode===null){e:{g=i.type,u=i.memoizedProps,w=w.ownerDocument||w;t:switch(g){case"title":C=w.getElementsByTagName("title")[0],(!C||C[Wa]||C[Ci]||C.namespaceURI==="http://www.w3.org/2000/svg"||C.hasAttribute("itemprop"))&&(C=w.createElement(g),w.head.insertBefore(C,w.querySelector("head > title"))),To(C,g,u),C[Ci]=i,En(C),g=C;break e;case"link":var W=j1("link","href",w).get(g+(u.href||""));if(W){for(var le=0;le<W.length;le++)if(C=W[le],C.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&C.getAttribute("rel")===(u.rel==null?null:u.rel)&&C.getAttribute("title")===(u.title==null?null:u.title)&&C.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){W.splice(le,1);break t}}C=w.createElement(g),To(C,g,u),w.head.appendChild(C);break;case"meta":if(W=j1("meta","content",w).get(g+(u.content||""))){for(le=0;le<W.length;le++)if(C=W[le],C.getAttribute("content")===(u.content==null?null:""+u.content)&&C.getAttribute("name")===(u.name==null?null:u.name)&&C.getAttribute("property")===(u.property==null?null:u.property)&&C.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&C.getAttribute("charset")===(u.charSet==null?null:u.charSet)){W.splice(le,1);break t}}C=w.createElement(g),To(C,g,u),w.head.appendChild(C);break;default:throw Error(n(468,g))}C[Ci]=i,En(C),g=C}i.stateNode=g}else N1(w,i.type,i.stateNode);else i.stateNode=k1(w,g,i.memoizedProps);else C!==g?(C===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):C.count--,g===null?N1(w,i.type,i.stateNode):k1(w,g,i.memoizedProps)):g===null&&i.stateNode!==null&&Bh(i,i.memoizedProps,u.memoizedProps)}break;case 27:L(a,i),he(i),g&512&&(ur||u===null||Hl(u,u.return)),u!==null&&g&4&&Bh(i,i.memoizedProps,u.memoizedProps);break;case 5:if(L(a,i),he(i),g&512&&(ur||u===null||Hl(u,u.return)),i.flags&32){w=i.stateNode;try{jr(w,"")}catch(dn){Es(i,i.return,dn)}}g&4&&i.stateNode!=null&&(w=i.memoizedProps,Bh(i,w,u!==null?u.memoizedProps:w)),g&1024&&(zf=!0);break;case 6:if(L(a,i),he(i),g&4){if(i.stateNode===null)throw Error(n(162));g=i.memoizedProps,u=i.stateNode;try{u.nodeValue=g}catch(dn){Es(i,i.return,dn)}}break;case 3:if(og=null,w=Q,Q=rg(a.containerInfo),L(a,i),Q=w,he(i),g&4&&u!==null&&u.memoizedState.isDehydrated)try{Yh(a.containerInfo)}catch(dn){Es(i,i.return,dn)}zf&&(zf=!1,V(i));break;case 4:g=Q,Q=rg(i.stateNode.containerInfo),L(a,i),he(i),Q=g;break;case 12:L(a,i),he(i);break;case 31:L(a,i),he(i),g&4&&(g=i.updateQueue,g!==null&&(i.updateQueue=null,S(i,g)));break;case 13:L(a,i),he(i),i.child.flags&8192&&i.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(Go=Zn()),g&4&&(g=i.updateQueue,g!==null&&(i.updateQueue=null,S(i,g)));break;case 22:w=i.memoizedState!==null;var Me=u!==null&&u.memoizedState!==null,tt=$o,pt=ur;if($o=tt||w,ur=pt||Me,L(a,i),ur=pt,$o=tt,he(i),g&8192)e:for(a=i.stateNode,a._visibility=w?a._visibility&-2:a._visibility|1,w&&(u===null||Me||$o||ur||fe(i)),u=null,a=i;;){if(a.tag===5||a.tag===26){if(u===null){Me=u=a;try{if(C=Me.stateNode,w)W=C.style,typeof W.setProperty=="function"?W.setProperty("display","none","important"):W.display="none";else{le=Me.stateNode;var vt=Me.memoizedProps.style,nt=vt!=null&&vt.hasOwnProperty("display")?vt.display:null;le.style.display=nt==null||typeof nt=="boolean"?"":(""+nt).trim()}}catch(dn){Es(Me,Me.return,dn)}}}else if(a.tag===6){if(u===null){Me=a;try{Me.stateNode.nodeValue=w?"":Me.memoizedProps}catch(dn){Es(Me,Me.return,dn)}}}else if(a.tag===18){if(u===null){Me=a;try{var ot=Me.stateNode;w?x1(ot,!0):x1(Me.stateNode,!1)}catch(dn){Es(Me,Me.return,dn)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===i)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break e;for(;a.sibling===null;){if(a.return===null||a.return===i)break e;u===a&&(u=null),a=a.return}u===a&&(u=null),a.sibling.return=a.return,a=a.sibling}g&4&&(g=i.updateQueue,g!==null&&(u=g.retryQueue,u!==null&&(g.retryQueue=null,S(i,u))));break;case 19:L(a,i),he(i),g&4&&(g=i.updateQueue,g!==null&&(i.updateQueue=null,S(i,g)));break;case 30:break;case 21:break;default:L(a,i),he(i)}}function he(i){var a=i.flags;if(a&2){try{for(var u,g=i.return;g!==null;){if(Oh(g)){u=g;break}g=g.return}if(u==null)throw Error(n(160));switch(u.tag){case 27:var w=u.stateNode,C=Ju(i);Fh(i,C,w);break;case 5:var W=u.stateNode;u.flags&32&&(jr(W,""),u.flags&=-33);var le=Ju(i);Fh(i,le,W);break;case 3:case 4:var Me=u.stateNode.containerInfo,tt=Ju(i);Mf(i,tt,Me);break;default:throw Error(n(161))}}catch(pt){Es(i,i.return,pt)}i.flags&=-3}a&4096&&(i.flags&=-4097)}function V(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var a=i;V(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),i=i.sibling}}function Ae(i,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)Bf(i,a.alternate,a),a=a.sibling}function fe(i){for(i=i.child;i!==null;){var a=i;switch(a.tag){case 0:case 11:case 14:case 15:Rc(4,a,a.return),fe(a);break;case 1:Hl(a,a.return);var u=a.stateNode;typeof u.componentWillUnmount=="function"&&Hp(a,a.return,u),fe(a);break;case 27:Vf(a.stateNode);case 26:case 5:Hl(a,a.return),fe(a);break;case 22:a.memoizedState===null&&fe(a);break;case 30:fe(a);break;default:fe(a)}i=i.sibling}}function je(i,a,u){for(u=u&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var g=a.alternate,w=i,C=a,W=C.flags;switch(C.tag){case 0:case 11:case 15:je(w,C,u),Zu(4,C);break;case 1:if(je(w,C,u),g=C,w=g.stateNode,typeof w.componentDidMount=="function")try{w.componentDidMount()}catch(tt){Es(g,g.return,tt)}if(g=C,w=g.updateQueue,w!==null){var le=g.stateNode;try{var Me=w.shared.hiddenCallbacks;if(Me!==null)for(w.shared.hiddenCallbacks=null,w=0;w<Me.length;w++)Kr(Me[w],le)}catch(tt){Es(g,g.return,tt)}}u&&W&64&&mu(C),yu(C,C.return);break;case 27:gd(C);case 26:case 5:je(w,C,u),u&&g===null&&W&4&&qp(C),yu(C,C.return);break;case 12:je(w,C,u);break;case 31:je(w,C,u),u&&W&4&&$p(w,C);break;case 13:je(w,C,u),u&&W&4&&Gp(w,C);break;case 22:C.memoizedState===null&&je(w,C,u),yu(C,C.return);break;case 30:break;default:je(w,C,u)}a=a.sibling}}function ke(i,a){var u=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),i=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(i=a.memoizedState.cachePool.pool),i!==u&&(i!=null&&i.refCount++,u!=null&&_a(u))}function Ce(i,a){i=null,a.alternate!==null&&(i=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==i&&(a.refCount++,i!=null&&_a(i))}function ge(i,a,u,g){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Se(i,a,u,g),a=a.sibling}function Se(i,a,u,g){var w=a.flags;switch(a.tag){case 0:case 11:case 15:ge(i,a,u,g),w&2048&&Zu(9,a);break;case 1:ge(i,a,u,g);break;case 3:ge(i,a,u,g),w&2048&&(i=null,a.alternate!==null&&(i=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==i&&(a.refCount++,i!=null&&_a(i)));break;case 12:if(w&2048){ge(i,a,u,g),i=a.stateNode;try{var C=a.memoizedProps,W=C.id,le=C.onPostCommit;typeof le=="function"&&le(W,a.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(Me){Es(a,a.return,Me)}}else ge(i,a,u,g);break;case 31:ge(i,a,u,g);break;case 13:ge(i,a,u,g);break;case 23:break;case 22:C=a.stateNode,W=a.alternate,a.memoizedState!==null?C._visibility&2?ge(i,a,u,g):ye(i,a):C._visibility&2?ge(i,a,u,g):(C._visibility|=2,be(i,a,u,g,(a.subtreeFlags&10256)!==0||!1)),w&2048&&ke(W,a);break;case 24:ge(i,a,u,g),w&2048&&Ce(a.alternate,a);break;default:ge(i,a,u,g)}}function be(i,a,u,g,w){for(w=w&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var C=i,W=a,le=u,Me=g,tt=W.flags;switch(W.tag){case 0:case 11:case 15:be(C,W,le,Me,w),Zu(8,W);break;case 23:break;case 22:var pt=W.stateNode;W.memoizedState!==null?pt._visibility&2?be(C,W,le,Me,w):ye(C,W):(pt._visibility|=2,be(C,W,le,Me,w)),w&&tt&2048&&ke(W.alternate,W);break;case 24:be(C,W,le,Me,w),w&&tt&2048&&Ce(W.alternate,W);break;default:be(C,W,le,Me,w)}a=a.sibling}}function ye(i,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var u=i,g=a,w=g.flags;switch(g.tag){case 22:ye(u,g),w&2048&&ke(g.alternate,g);break;case 24:ye(u,g),w&2048&&Ce(g.alternate,g);break;default:ye(u,g)}a=a.sibling}}var Le=8192;function Ee(i,a,u){if(i.subtreeFlags&Le)for(i=i.child;i!==null;)qe(i,a,u),i=i.sibling}function qe(i,a,u){switch(i.tag){case 26:Ee(i,a,u),i.flags&Le&&i.memoizedState!==null&&gw(u,Q,i.memoizedState,i.memoizedProps);break;case 5:Ee(i,a,u);break;case 3:case 4:var g=Q;Q=rg(i.stateNode.containerInfo),Ee(i,a,u),Q=g;break;case 22:i.memoizedState===null&&(g=i.alternate,g!==null&&g.memoizedState!==null?(g=Le,Le=16777216,Ee(i,a,u),Le=g):Ee(i,a,u));break;default:Ee(i,a,u)}}function ct(i){var a=i.alternate;if(a!==null&&(i=a.child,i!==null)){a.child=null;do a=i.sibling,i.sibling=null,i=a;while(i!==null)}}function ht(i){var a=i.deletions;if((i.flags&16)!==0){if(a!==null)for(var u=0;u<a.length;u++){var g=a[u];Qr=g,zt(g,i)}ct(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)wt(i),i=i.sibling}function wt(i){switch(i.tag){case 0:case 11:case 15:ht(i),i.flags&2048&&Rc(9,i,i.return);break;case 3:ht(i);break;case 12:ht(i);break;case 22:var a=i.stateNode;i.memoizedState!==null&&a._visibility&2&&(i.return===null||i.return.tag!==13)?(a._visibility&=-3,it(i)):ht(i);break;default:ht(i)}}function it(i){var a=i.deletions;if((i.flags&16)!==0){if(a!==null)for(var u=0;u<a.length;u++){var g=a[u];Qr=g,zt(g,i)}ct(i)}for(i=i.child;i!==null;){switch(a=i,a.tag){case 0:case 11:case 15:Rc(8,a,a.return),it(a);break;case 22:u=a.stateNode,u._visibility&2&&(u._visibility&=-3,it(a));break;default:it(a)}i=i.sibling}}function zt(i,a){for(;Qr!==null;){var u=Qr;switch(u.tag){case 0:case 11:case 15:Rc(8,u,a);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var g=u.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:_a(u.memoizedState.cache)}if(g=u.child,g!==null)g.return=u,Qr=g;else e:for(u=i;Qr!==null;){g=Qr;var w=g.sibling,C=g.return;if(Of(g),g===u){Qr=null;break e}if(w!==null){w.return=C,Qr=w;break e}Qr=C}}}var He={getCacheForType:function(i){var a=fs(Di),u=a.data.get(i);return u===void 0&&(u=i(),a.data.set(i,u)),u},cacheSignal:function(){return fs(Di).controller.signal}},Ve=typeof WeakMap=="function"?WeakMap:Map,ze=0,Xe=null,Ye=null,dt=0,kt=0,Xt=null,kn=!1,_n=!1,Bn=!1,Xn=0,Ft=0,jt=0,cn=0,cs=0,Bi=0,ds=0,tr=null,Yi=null,Kn=!1,Go=0,yl=0,Yp=1/0,Xp=null,xu=null,Ua=0,bu=null,Uh=null,Hd=0,p0=0,g0=null,zy=null,Ff=0,m0=null;function fc(){return(ze&2)!==0&&dt!==0?dt&-dt:q.T!==null?S0():vs()}function Iy(){if(Bi===0)if((dt&536870912)===0||ji){var i=Vi;Vi<<=1,(Vi&3932160)===0&&(Vi=262144),Bi=i}else Bi=536870912;return i=Ns.current,i!==null&&(i.flags|=32),Bi}function ql(i,a,u){(i===Xe&&(kt===2||kt===9)||i.cancelPendingCommit!==null)&&(Hh(i,0),vu(i,dt,Bi,!1)),Zt(i,u),((ze&2)===0||i!==Xe)&&(i===Xe&&((ze&2)===0&&(cn|=u),Ft===4&&vu(i,dt,Bi,!1)),md(i))}function By(i,a,u){if((ze&6)!==0)throw Error(n(327));var g=!u&&(a&127)===0&&(a&i.expiredLanes)===0||Tr(i,a),w=g?Lv(i,a):x0(i,a,!0),C=g;do{if(w===0){_n&&!g&&vu(i,a,0,!1);break}else{if(u=i.current.alternate,C&&!Rv(u)){w=x0(i,a,!1),C=!1;continue}if(w===2){if(C=a,i.errorRecoveryDisabledLanes&C)var W=0;else W=i.pendingLanes&-536870913,W=W!==0?W:W&536870912?536870912:0;if(W!==0){a=W;e:{var le=i;w=tr;var Me=le.current.memoizedState.isDehydrated;if(Me&&(Hh(le,W).flags|=256),W=x0(le,W,!1),W!==2){if(Bn&&!Me){le.errorRecoveryDisabledLanes|=C,cn|=C,w=4;break e}C=Yi,Yi=w,C!==null&&(Yi===null?Yi=C:Yi.push.apply(Yi,C))}w=W}if(C=!1,w!==2)continue}}if(w===1){Hh(i,0),vu(i,a,0,!0);break}e:{switch(g=i,C=w,C){case 0:case 1:throw Error(n(345));case 4:if((a&4194048)!==a)break;case 6:vu(g,a,Bi,!kn);break e;case 2:Yi=null;break;case 3:case 5:break;default:throw Error(n(329))}if((a&62914560)===a&&(w=Go+300-Zn(),10<w)){if(vu(g,a,Bi,!kn),Kt(g,0,!0)!==0)break e;Hd=a,g.timeoutHandle=g1(Oy.bind(null,g,u,Yi,Xp,Kn,a,Bi,cn,ds,kn,C,"Throttled",-0,0),w);break e}Oy(g,u,Yi,Xp,Kn,a,Bi,cn,ds,kn,C,null,-0,0)}}break}while(!0);md(i)}function Oy(i,a,u,g,w,C,W,le,Me,tt,pt,vt,nt,ot){if(i.timeoutHandle=-1,vt=a.subtreeFlags,vt&8192||(vt&16785408)===16785408){vt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:co},qe(a,C,vt);var dn=(C&62914560)===C?Go-Zn():(C&4194048)===C?yl-Zn():0;if(dn=mw(vt,dn),dn!==null){Hd=C,i.cancelPendingCommit=dn(Gy.bind(null,i,a,C,u,g,w,W,le,Me,pt,vt,null,nt,ot)),vu(i,C,W,!tt);return}}Gy(i,a,C,u,g,w,W,le,Me)}function Rv(i){for(var a=i;;){var u=a.tag;if((u===0||u===11||u===15)&&a.flags&16384&&(u=a.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var g=0;g<u.length;g++){var w=u[g],C=w.getSnapshot;w=w.value;try{if(!Pr(C(),w))return!1}catch{return!1}}if(u=a.child,a.subtreeFlags&16384&&u!==null)u.return=a,a=u;else{if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function vu(i,a,u,g){a&=~cs,a&=~cn,i.suspendedLanes|=a,i.pingedLanes&=~a,g&&(i.warmLanes|=a),g=i.expirationTimes;for(var w=a;0<w;){var C=31-lt(w),W=1<<C;g[C]=-1,w&=~W}u!==0&&Na(i,u,a)}function Kp(){return(ze&6)===0?(Uf(0),!1):!0}function y0(){if(Ye!==null){if(kt===0)var i=Ye.return;else i=Ye,js=Vr=null,Ld(i),bt=null,sn=0,i=Ye;for(;i!==null;)Up(i.alternate,i),i=i.return;Ye=null}}function Hh(i,a){var u=i.timeoutHandle;u!==-1&&(i.timeoutHandle=-1,Jv(u)),u=i.cancelPendingCommit,u!==null&&(i.cancelPendingCommit=null,u()),Hd=0,y0(),Xe=i,Ye=u=Ia(i.current,null),dt=a,kt=0,Xt=null,kn=!1,_n=Tr(i,a),Bn=!1,ds=Bi=cs=cn=jt=Ft=0,Yi=tr=null,Kn=!1,(a&8)!==0&&(a|=a&32);var g=i.entangledLanes;if(g!==0)for(i=i.entanglements,g&=a;0<g;){var w=31-lt(g),C=1<<w;a|=i[w],g&=~C}return Xn=a,Nd(),u}function Fy(i,a){bn=null,q.H=Vo,a===Ie||a===ve?(a=gt(),kt=3):a===Ze?(a=gt(),kt=4):kt=a===Ph?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Xt=a,Ye===null&&(Ft=1,Yu(i,Ba(a,i.current)))}function Uy(){var i=Ns.current;return i===null?!0:(dt&4194048)===dt?gi===null:(dt&62914560)===dt||(dt&536870912)!==0?i===gi:!1}function Hy(){var i=q.H;return q.H=Vo,i===null?Vo:i}function qy(){var i=q.A;return q.A=He,i}function Zp(){Ft=4,kn||(dt&4194048)!==dt&&Ns.current!==null||(_n=!0),(jt&134217727)===0&&(cn&134217727)===0||Xe===null||vu(Xe,dt,Bi,!1)}function x0(i,a,u){var g=ze;ze|=2;var w=Hy(),C=qy();(Xe!==i||dt!==a)&&(Xp=null,Hh(i,a)),a=!1;var W=Ft;e:do try{if(kt!==0&&Ye!==null){var le=Ye,Me=Xt;switch(kt){case 8:y0(),W=6;break e;case 3:case 2:case 9:case 6:Ns.current===null&&(a=!0);var tt=kt;if(kt=0,Xt=null,qh(i,le,Me,tt),u&&_n){W=0;break e}break;default:tt=kt,kt=0,Xt=null,qh(i,le,Me,tt)}}Dv(),W=Ft;break}catch(pt){Fy(i,pt)}while(!0);return a&&i.shellSuspendCounter++,js=Vr=null,ze=g,q.H=w,q.A=C,Ye===null&&(Xe=null,dt=0,Nd()),W}function Dv(){for(;Ye!==null;)Vy(Ye)}function Lv(i,a){var u=ze;ze|=2;var g=Hy(),w=qy();Xe!==i||dt!==a?(Xp=null,Yp=Zn()+500,Hh(i,a)):_n=Tr(i,a);e:do try{if(kt!==0&&Ye!==null){a=Ye;var C=Xt;t:switch(kt){case 1:kt=0,Xt=null,qh(i,a,C,1);break;case 2:case 9:if($e(C)){kt=0,Xt=null,Wy(a);break}a=function(){kt!==2&&kt!==9||Xe!==i||(kt=7),md(i)},C.then(a,a);break e;case 3:kt=7;break e;case 4:kt=5;break e;case 7:$e(C)?(kt=0,Xt=null,Wy(a)):(kt=0,Xt=null,qh(i,a,C,7));break;case 5:var W=null;switch(Ye.tag){case 26:W=Ye.memoizedState;case 5:case 27:var le=Ye;if(W?P1(W):le.stateNode.complete){kt=0,Xt=null;var Me=le.sibling;if(Me!==null)Ye=Me;else{var tt=le.return;tt!==null?(Ye=tt,Jp(tt)):Ye=null}break t}}kt=0,Xt=null,qh(i,a,C,5);break;case 6:kt=0,Xt=null,qh(i,a,C,6);break;case 8:y0(),Ft=6;break e;default:throw Error(n(462))}}Mv();break}catch(pt){Fy(i,pt)}while(!0);return js=Vr=null,q.H=g,q.A=w,ze=u,Ye!==null?0:(Xe=null,dt=0,Nd(),Ft)}function Mv(){for(;Ye!==null&&!wn();)Vy(Ye)}function Vy(i){var a=Ud(i.alternate,i,Xn);i.memoizedProps=i.pendingProps,a===null?Jp(i):Ye=a}function Wy(i){var a=i,u=a.alternate;switch(a.tag){case 15:case 0:a=Eh(u,a,a.pendingProps,a.type,void 0,dt);break;case 11:a=Eh(u,a,a.pendingProps,a.type.render,a.ref,dt);break;case 5:Ld(a);default:Up(u,a),a=Ye=qc(a,Xn),a=Ud(u,a,Xn)}i.memoizedProps=i.pendingProps,a===null?Jp(i):Ye=a}function qh(i,a,u,g){js=Vr=null,Ld(a),bt=null,sn=0;var w=a.return;try{if(jf(i,w,a,u,dt)){Ft=1,Yu(i,Ba(u,i.current)),Ye=null;return}}catch(C){if(w!==null)throw Ye=w,C;Ft=1,Yu(i,Ba(u,i.current)),Ye=null;return}a.flags&32768?(ji||g===1?i=!0:_n||(dt&536870912)!==0?i=!1:(kn=i=!0,(g===2||g===9||g===3||g===6)&&(g=Ns.current,g!==null&&g.tag===13&&(g.flags|=16384))),$y(a,i)):Jp(a)}function Jp(i){var a=i;do{if((a.flags&32768)!==0){$y(a,kn);return}i=a.return;var u=zh(a.alternate,a,Xn);if(u!==null){Ye=u;return}if(a=a.sibling,a!==null){Ye=a;return}Ye=a=i}while(a!==null);Ft===0&&(Ft=5)}function $y(i,a){do{var u=Ih(i.alternate,i);if(u!==null){u.flags&=32767,Ye=u;return}if(u=i.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!a&&(i=i.sibling,i!==null)){Ye=i;return}Ye=i=u}while(i!==null);Ft=6,Ye=null}function Gy(i,a,u,g,w,C,W,le,Me){i.cancelPendingCommit=null;do Qp();while(Ua!==0);if((ze&6)!==0)throw Error(n(327));if(a!==null){if(a===i.current)throw Error(n(177));if(C=a.lanes|a.childLanes,C|=za,Or(i,u,C,W,le,Me),i===Xe&&(Ye=Xe=null,dt=0),Uh=a,bu=i,Hd=u,p0=C,g0=w,zy=g,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,Ov(ft,function(){return Jy(),null})):(i.callbackNode=null,i.callbackPriority=0),g=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||g){g=q.T,q.T=null,w=J.p,J.p=2,W=ze,ze|=4;try{If(i,a,u)}finally{ze=W,J.p=w,q.T=g}}Ua=1,Yy(),Xy(),Ky()}}function Yy(){if(Ua===1){Ua=0;var i=bu,a=Uh,u=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||u){u=q.T,q.T=null;var g=J.p;J.p=2;var w=ze;ze|=4;try{oe(a,i);var C=P0,W=Io(i.containerInfo),le=C.focusedElem,Me=C.selectionRange;if(W!==le&&le&&le.ownerDocument&&dl(le.ownerDocument.documentElement,le)){if(Me!==null&&Sa(le)){var tt=Me.start,pt=Me.end;if(pt===void 0&&(pt=tt),"selectionStart"in le)le.selectionStart=tt,le.selectionEnd=Math.min(pt,le.value.length);else{var vt=le.ownerDocument||document,nt=vt&&vt.defaultView||window;if(nt.getSelection){var ot=nt.getSelection(),dn=le.textContent.length,Wn=Math.min(Me.start,dn),Bs=Me.end===void 0?Wn:Math.min(Me.end,dn);!ot.extend&&Wn>Bs&&(W=Bs,Bs=Wn,Wn=W);var Ge=to(le,Wn),Oe=to(le,Bs);if(Ge&&Oe&&(ot.rangeCount!==1||ot.anchorNode!==Ge.node||ot.anchorOffset!==Ge.offset||ot.focusNode!==Oe.node||ot.focusOffset!==Oe.offset)){var Qe=vt.createRange();Qe.setStart(Ge.node,Ge.offset),ot.removeAllRanges(),Wn>Bs?(ot.addRange(Qe),ot.extend(Oe.node,Oe.offset)):(Qe.setEnd(Oe.node,Oe.offset),ot.addRange(Qe))}}}}for(vt=[],ot=le;ot=ot.parentNode;)ot.nodeType===1&&vt.push({element:ot,left:ot.scrollLeft,top:ot.scrollTop});for(typeof le.focus=="function"&&le.focus(),le=0;le<vt.length;le++){var xt=vt[le];xt.element.scrollLeft=xt.left,xt.element.scrollTop=xt.top}}ug=!!N0,P0=N0=null}finally{ze=w,J.p=g,q.T=u}}i.current=a,Ua=2}}function Xy(){if(Ua===2){Ua=0;var i=bu,a=Uh,u=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||u){u=q.T,q.T=null;var g=J.p;J.p=2;var w=ze;ze|=4;try{Bf(i,a.alternate,a)}finally{ze=w,J.p=g,q.T=u}}Ua=3}}function Ky(){if(Ua===4||Ua===3){Ua=0,nn();var i=bu,a=Uh,u=Hd,g=zy;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Ua=5:(Ua=0,Uh=bu=null,Zy(i,i.pendingLanes));var w=i.pendingLanes;if(w===0&&(xu=null),ei(u),a=a.stateNode,on&&typeof on.onCommitFiberRoot=="function")try{on.onCommitFiberRoot(Nn,a,void 0,(a.current.flags&128)===128)}catch{}if(g!==null){a=q.T,w=J.p,J.p=2,q.T=null;try{for(var C=i.onRecoverableError,W=0;W<g.length;W++){var le=g[W];C(le.value,{componentStack:le.stack})}}finally{q.T=a,J.p=w}}(Hd&3)!==0&&Qp(),md(i),w=i.pendingLanes,(u&261930)!==0&&(w&42)!==0?i===m0?Ff++:(Ff=0,m0=i):Ff=0,Uf(0)}}function Zy(i,a){(i.pooledCacheLanes&=a)===0&&(a=i.pooledCache,a!=null&&(i.pooledCache=null,_a(a)))}function Qp(){return Yy(),Xy(),Ky(),Jy()}function Jy(){if(Ua!==5)return!1;var i=bu,a=p0;p0=0;var u=ei(Hd),g=q.T,w=J.p;try{J.p=32>u?32:u,q.T=null,u=g0,g0=null;var C=bu,W=Hd;if(Ua=0,Uh=bu=null,Hd=0,(ze&6)!==0)throw Error(n(331));var le=ze;if(ze|=4,wt(C.current),Se(C,C.current,W,u),ze=le,Uf(0,!1),on&&typeof on.onPostCommitFiberRoot=="function")try{on.onPostCommitFiberRoot(Nn,C)}catch{}return!0}finally{J.p=w,q.T=g,Zy(i,a)}}function Qy(i,a,u){a=Ba(u,a),a=Nh(i.stateNode,a,2),i=Hn(i,a,2),i!==null&&(Zt(i,2),md(i))}function Es(i,a,u){if(i.tag===3)Qy(i,i,u);else for(;a!==null;){if(a.tag===3){Qy(a,i,u);break}else if(a.tag===1){var g=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(xu===null||!xu.has(g))){i=Ba(u,i),u=uu(2),g=Hn(a,u,2),g!==null&&(Bp(u,g,a,i),Zt(g,2),md(g));break}}a=a.return}}function b0(i,a,u){var g=i.pingCache;if(g===null){g=i.pingCache=new Ve;var w=new Set;g.set(a,w)}else w=g.get(a),w===void 0&&(w=new Set,g.set(a,w));w.has(u)||(Bn=!0,w.add(u),i=zv.bind(null,i,a,u),a.then(i,i))}function zv(i,a,u){var g=i.pingCache;g!==null&&g.delete(a),i.pingedLanes|=i.suspendedLanes&u,i.warmLanes&=~u,Xe===i&&(dt&u)===u&&(Ft===4||Ft===3&&(dt&62914560)===dt&&300>Zn()-Go?(ze&2)===0&&Hh(i,0):cs|=u,ds===dt&&(ds=0)),md(i)}function e1(i,a){a===0&&(a=Ir()),i=Oo(i,a),i!==null&&(Zt(i,a),md(i))}function Iv(i){var a=i.memoizedState,u=0;a!==null&&(u=a.retryLane),e1(i,u)}function Bv(i,a){var u=0;switch(i.tag){case 31:case 13:var g=i.stateNode,w=i.memoizedState;w!==null&&(u=w.retryLane);break;case 19:g=i.stateNode;break;case 22:g=i.stateNode._retryCache;break;default:throw Error(n(314))}g!==null&&g.delete(a),e1(i,u)}function Ov(i,a){return en(i,a)}var eg=null,Vh=null,v0=!1,tg=!1,w0=!1,wu=0;function md(i){i!==Vh&&i.next===null&&(Vh===null?eg=Vh=i:Vh=Vh.next=i),tg=!0,v0||(v0=!0,Uv())}function Uf(i,a){if(!w0&&tg){w0=!0;do for(var u=!1,g=eg;g!==null;){if(i!==0){var w=g.pendingLanes;if(w===0)var C=0;else{var W=g.suspendedLanes,le=g.pingedLanes;C=(1<<31-lt(42|i)+1)-1,C&=w&~(W&~le),C=C&201326741?C&201326741|1:C?C|2:0}C!==0&&(u=!0,s1(g,C))}else C=dt,C=Kt(g,g===Xe?C:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(C&3)===0||Tr(g,C)||(u=!0,s1(g,C));g=g.next}while(u);w0=!1}}function Fv(){t1()}function t1(){tg=v0=!1;var i=0;wu!==0&&Zv()&&(i=wu);for(var a=Zn(),u=null,g=eg;g!==null;){var w=g.next,C=n1(g,a);C===0?(g.next=null,u===null?eg=w:u.next=w,w===null&&(Vh=u)):(u=g,(i!==0||(C&3)!==0)&&(tg=!0)),g=w}Ua!==0&&Ua!==5||Uf(i),wu!==0&&(wu=0)}function n1(i,a){for(var u=i.suspendedLanes,g=i.pingedLanes,w=i.expirationTimes,C=i.pendingLanes&-62914561;0<C;){var W=31-lt(C),le=1<<W,Me=w[W];Me===-1?((le&u)===0||(le&g)!==0)&&(w[W]=Ks(le,a)):Me<=a&&(i.expiredLanes|=le),C&=~le}if(a=Xe,u=dt,u=Kt(i,i===a?u:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),g=i.callbackNode,u===0||i===a&&(kt===2||kt===9)||i.cancelPendingCommit!==null)return g!==null&&g!==null&&Ot(g),i.callbackNode=null,i.callbackPriority=0;if((u&3)===0||Tr(i,u)){if(a=u&-u,a===i.callbackPriority)return a;switch(g!==null&&Ot(g),ei(u)){case 2:case 8:u=yi;break;case 32:u=ft;break;case 268435456:u=On;break;default:u=ft}return g=i1.bind(null,i),u=en(u,g),i.callbackPriority=a,i.callbackNode=u,a}return g!==null&&g!==null&&Ot(g),i.callbackPriority=2,i.callbackNode=null,2}function i1(i,a){if(Ua!==0&&Ua!==5)return i.callbackNode=null,i.callbackPriority=0,null;var u=i.callbackNode;if(Qp()&&i.callbackNode!==u)return null;var g=dt;return g=Kt(i,i===Xe?g:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),g===0?null:(By(i,g,a),n1(i,Zn()),i.callbackNode!=null&&i.callbackNode===u?i1.bind(null,i):null)}function s1(i,a){if(Qp())return null;By(i,a,!0)}function Uv(){Qv(function(){(ze&6)!==0?en(Mt,Fv):t1()})}function S0(){if(wu===0){var i=y;i===0&&(i=An,An<<=1,(An&261888)===0&&(An=256)),wu=i}return wu}function r1(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Ea(""+i)}function a1(i,a){var u=a.ownerDocument.createElement("input");return u.name=a.name,u.value=a.value,i.id&&u.setAttribute("form",i.id),a.parentNode.insertBefore(u,a),i=new FormData(i),u.parentNode.removeChild(u),i}function Hv(i,a,u,g,w){if(a==="submit"&&u&&u.stateNode===w){var C=r1((w[Si]||null).action),W=g.submitter;W&&(a=(a=W[Si]||null)?r1(a.formAction):W.getAttribute("formAction"),a!==null&&(C=a,W=null));var le=new Ka("action","action",null,g,w);i.push({event:le,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(wu!==0){var Me=W?a1(w,W):new FormData(w);Sf(u,{pending:!0,data:Me,method:w.method,action:C},null,Me)}}else typeof C=="function"&&(le.preventDefault(),Me=W?a1(w,W):new FormData(w),Sf(u,{pending:!0,data:Me,method:w.method,action:C},C,Me))},currentTarget:w}]})}}for(var A0=0;A0<Pl.length;A0++){var T0=Pl[A0],qv=T0.toLowerCase(),Vv=T0[0].toUpperCase()+T0.slice(1);hs(qv,"on"+Vv)}hs(rr,"onAnimationEnd"),hs(Ta,"onAnimationIteration"),hs(kl,"onAnimationStart"),hs("dblclick","onDoubleClick"),hs("focusin","onFocus"),hs("focusout","onBlur"),hs(hl,"onTransitionRun"),hs(jl,"onTransitionStart"),hs(Jl,"onTransitionCancel"),hs(Nl,"onTransitionEnd"),Pa("onMouseEnter",["mouseout","mouseover"]),Pa("onMouseLeave",["mouseout","mouseover"]),Pa("onPointerEnter",["pointerout","pointerover"]),Pa("onPointerLeave",["pointerout","pointerover"]),ma("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ma("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ma("onBeforeInput",["compositionend","keypress","textInput","paste"]),ma("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ma("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ma("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Wv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Hf));function o1(i,a){a=(a&4)!==0;for(var u=0;u<i.length;u++){var g=i[u],w=g.event;g=g.listeners;e:{var C=void 0;if(a)for(var W=g.length-1;0<=W;W--){var le=g[W],Me=le.instance,tt=le.currentTarget;if(le=le.listener,Me!==C&&w.isPropagationStopped())break e;C=le,w.currentTarget=tt;try{C(w)}catch(pt){ki(pt)}w.currentTarget=null,C=Me}else for(W=0;W<g.length;W++){if(le=g[W],Me=le.instance,tt=le.currentTarget,le=le.listener,Me!==C&&w.isPropagationStopped())break e;C=le,w.currentTarget=tt;try{C(w)}catch(pt){ki(pt)}w.currentTarget=null,C=Me}}}}function Oi(i,a){var u=a[pa];u===void 0&&(u=a[pa]=new Set);var g=i+"__bubble";u.has(g)||(l1(a,i,2,!1),u.add(g))}function C0(i,a,u){var g=0;a&&(g|=4),l1(u,i,g,a)}var ng="_reactListening"+Math.random().toString(36).slice(2);function _0(i){if(!i[ng]){i[ng]=!0,Qo.forEach(function(u){u!=="selectionchange"&&(Wv.has(u)||C0(u,!1,i),C0(u,!0,i))});var a=i.nodeType===9?i:i.ownerDocument;a===null||a[ng]||(a[ng]=!0,C0("selectionchange",!1,a))}}function l1(i,a,u,g){switch(I1(a)){case 2:var w=bw;break;case 8:w=vw;break;default:w=U0}u=w.bind(null,a,u,i),w=void 0,!Cn||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(w=!0),g?w!==void 0?i.addEventListener(a,u,{capture:!0,passive:w}):i.addEventListener(a,u,!0):w!==void 0?i.addEventListener(a,u,{passive:w}):i.addEventListener(a,u,!1)}function k0(i,a,u,g,w){var C=g;if((a&1)===0&&(a&2)===0&&g!==null)e:for(;;){if(g===null)return;var W=g.tag;if(W===3||W===4){var le=g.stateNode.containerInfo;if(le===w)break;if(W===4)for(W=g.return;W!==null;){var Me=W.tag;if((Me===3||Me===4)&&W.stateNode.containerInfo===w)return;W=W.return}for(;le!==null;){if(W=$n(le),W===null)return;if(Me=W.tag,Me===5||Me===6||Me===26||Me===27){g=C=W;continue e}le=le.parentNode}}g=g.return}Hc(function(){var tt=C,pt=es(u),vt=[];e:{var nt=no.get(i);if(nt!==void 0){var ot=Ka,dn=i;switch(i){case"keypress":if(It(u)===0)break e;case"keydown":case"keyup":ot=vi;break;case"focusin":dn="focus",ot=gn;break;case"focusout":dn="blur",ot=gn;break;case"beforeblur":case"afterblur":ot=gn;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ot=Kl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ot=Eo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ot=Ei;break;case rr:case Ta:case kl:ot=P;break;case Nl:ot=as;break;case"scroll":case"scrollend":ot=rl;break;case"wheel":ot=Nr;break;case"copy":case"cut":case"paste":ot=we;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ot=Ni;break;case"toggle":case"beforetoggle":ot=pr}var Wn=(a&4)!==0,Bs=!Wn&&(i==="scroll"||i==="scrollend"),Ge=Wn?nt!==null?nt+"Capture":null:nt;Wn=[];for(var Oe=tt,Qe;Oe!==null;){var xt=Oe;if(Qe=xt.stateNode,xt=xt.tag,xt!==5&&xt!==26&&xt!==27||Qe===null||Ge===null||(xt=xa(Oe,Ge),xt!=null&&Wn.push(qf(Oe,xt,Qe))),Bs)break;Oe=Oe.return}0<Wn.length&&(nt=new ot(nt,dn,null,u,pt),vt.push({event:nt,listeners:Wn}))}}if((a&7)===0){e:{if(nt=i==="mouseover"||i==="pointerover",ot=i==="mouseout"||i==="pointerout",nt&&u!==rs&&(dn=u.relatedTarget||u.fromElement)&&($n(dn)||dn[Cr]))break e;if((ot||nt)&&(nt=pt.window===pt?pt:(nt=pt.ownerDocument)?nt.defaultView||nt.parentWindow:window,ot?(dn=u.relatedTarget||u.toElement,ot=tt,dn=dn?$n(dn):null,dn!==null&&(Bs=o(dn),Wn=dn.tag,dn!==Bs||Wn!==5&&Wn!==27&&Wn!==6)&&(dn=null)):(ot=null,dn=tt),ot!==dn)){if(Wn=Kl,xt="onMouseLeave",Ge="onMouseEnter",Oe="mouse",(i==="pointerout"||i==="pointerover")&&(Wn=Ni,xt="onPointerLeave",Ge="onPointerEnter",Oe="pointer"),Bs=ot==null?nt:xi(ot),Qe=dn==null?nt:xi(dn),nt=new Wn(xt,Oe+"leave",ot,u,pt),nt.target=Bs,nt.relatedTarget=Qe,xt=null,$n(pt)===tt&&(Wn=new Wn(Ge,Oe+"enter",dn,u,pt),Wn.target=Qe,Wn.relatedTarget=Bs,xt=Wn),Bs=xt,ot&&dn)t:{for(Wn=$v,Ge=ot,Oe=dn,Qe=0,xt=Ge;xt;xt=Wn(xt))Qe++;xt=0;for(var Dn=Oe;Dn;Dn=Wn(Dn))xt++;for(;0<Qe-xt;)Ge=Wn(Ge),Qe--;for(;0<xt-Qe;)Oe=Wn(Oe),xt--;for(;Qe--;){if(Ge===Oe||Oe!==null&&Ge===Oe.alternate){Wn=Ge;break t}Ge=Wn(Ge),Oe=Wn(Oe)}Wn=null}else Wn=null;ot!==null&&c1(vt,nt,ot,Wn,!1),dn!==null&&Bs!==null&&c1(vt,Bs,dn,Wn,!0)}}e:{if(nt=tt?xi(tt):window,ot=nt.nodeName&&nt.nodeName.toLowerCase(),ot==="select"||ot==="input"&&nt.type==="file")var gs=po;else if(Lo(nt))if(wa)gs=La;else{gs=ws;var xn=os}else ot=nt.nodeName,!ot||ot.toLowerCase()!=="input"||nt.type!=="checkbox"&&nt.type!=="radio"?tt&&fr(tt.elementType)&&(gs=po):gs=id;if(gs&&(gs=gs(i,tt))){va(vt,gs,u,pt);break e}xn&&xn(i,nt,tt),i==="focusout"&&tt&&nt.type==="number"&&tt.memoizedProps.value!=null&&ya(nt,"number",nt.value)}switch(xn=tt?xi(tt):window,i){case"focusin":(Lo(xn)||xn.contentEditable==="true")&&(Ma=xn,Bo=tt,Aa=null);break;case"focusout":Aa=Bo=Ma=null;break;case"mousedown":go=!0;break;case"contextmenu":case"mouseup":case"dragend":go=!1,$i(vt,u,pt);break;case"selectionchange":if(qr)break;case"keydown":case"keyup":$i(vt,u,pt)}var Ti;if(Hs)e:{switch(i){case"compositionstart":var qi="onCompositionStart";break e;case"compositionend":qi="onCompositionEnd";break e;case"compositionupdate":qi="onCompositionUpdate";break e}qi=void 0}else Qa?wc(i,u)&&(qi="onCompositionEnd"):i==="keydown"&&u.keyCode===229&&(qi="onCompositionStart");qi&&(Ja&&u.locale!=="ko"&&(Qa||qi!=="onCompositionStart"?qi==="onCompositionEnd"&&Qa&&(Ti=Zd()):(tn=pt,ai="value"in tn?tn.value:tn.textContent,Qa=!0)),xn=ig(tt,qi),0<xn.length&&(qi=new Fe(qi,i,null,u,pt),vt.push({event:qi,listeners:xn}),Ti?qi.data=Ti:(Ti=nd(u),Ti!==null&&(qi.data=Ti)))),(Ti=gr?Hr(i,u):Do(i,u))&&(qi=ig(tt,"onBeforeInput"),0<qi.length&&(xn=new Fe("onBeforeInput","beforeinput",null,u,pt),vt.push({event:xn,listeners:qi}),xn.data=Ti)),Hv(vt,i,tt,u,pt)}o1(vt,a)})}function qf(i,a,u){return{instance:i,listener:a,currentTarget:u}}function ig(i,a){for(var u=a+"Capture",g=[];i!==null;){var w=i,C=w.stateNode;if(w=w.tag,w!==5&&w!==26&&w!==27||C===null||(w=xa(i,u),w!=null&&g.unshift(qf(i,w,C)),w=xa(i,a),w!=null&&g.push(qf(i,w,C))),i.tag===3)return g;i=i.return}return[]}function $v(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function c1(i,a,u,g,w){for(var C=a._reactName,W=[];u!==null&&u!==g;){var le=u,Me=le.alternate,tt=le.stateNode;if(le=le.tag,Me!==null&&Me===g)break;le!==5&&le!==26&&le!==27||tt===null||(Me=tt,w?(tt=xa(u,C),tt!=null&&W.unshift(qf(u,tt,Me))):w||(tt=xa(u,C),tt!=null&&W.push(qf(u,tt,Me)))),u=u.return}W.length!==0&&i.push({event:a,listeners:W})}var Gv=/\r\n?/g,Yv=/\u0000|\uFFFD/g;function d1(i){return(typeof i=="string"?i:""+i).replace(Gv,`
`).replace(Yv,"")}function u1(i,a){return a=d1(a),d1(i)===a}function Is(i,a,u,g,w,C){switch(u){case"children":typeof g=="string"?a==="body"||a==="textarea"&&g===""||jr(i,g):(typeof g=="number"||typeof g=="bigint")&&a!=="body"&&jr(i,""+g);break;case"className":nl(i,"class",g);break;case"tabIndex":nl(i,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":nl(i,u,g);break;case"style":Qi(i,g,C);break;case"data":if(a!=="object"){nl(i,"data",g);break}case"src":case"href":if(g===""&&(a!=="a"||u!=="href")){i.removeAttribute(u);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){i.removeAttribute(u);break}g=Ea(""+g),i.setAttribute(u,g);break;case"action":case"formAction":if(typeof g=="function"){i.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof C=="function"&&(u==="formAction"?(a!=="input"&&Is(i,a,"name",w.name,w,null),Is(i,a,"formEncType",w.formEncType,w,null),Is(i,a,"formMethod",w.formMethod,w,null),Is(i,a,"formTarget",w.formTarget,w,null)):(Is(i,a,"encType",w.encType,w,null),Is(i,a,"method",w.method,w,null),Is(i,a,"target",w.target,w,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){i.removeAttribute(u);break}g=Ea(""+g),i.setAttribute(u,g);break;case"onClick":g!=null&&(i.onclick=co);break;case"onScroll":g!=null&&Oi("scroll",i);break;case"onScrollEnd":g!=null&&Oi("scrollend",i);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(n(61));if(u=g.__html,u!=null){if(w.children!=null)throw Error(n(60));i.innerHTML=u}}break;case"multiple":i.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":i.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){i.removeAttribute("xlink:href");break}u=Ea(""+g),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?i.setAttribute(u,""+g):i.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?i.setAttribute(u,""):i.removeAttribute(u);break;case"capture":case"download":g===!0?i.setAttribute(u,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?i.setAttribute(u,g):i.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?i.setAttribute(u,g):i.removeAttribute(u);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?i.removeAttribute(u):i.setAttribute(u,g);break;case"popover":Oi("beforetoggle",i),Oi("toggle",i),ss(i,"popover",g);break;case"xlinkActuate":Un(i,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":Un(i,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":Un(i,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":Un(i,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":Un(i,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":Un(i,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":Un(i,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":Un(i,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":Un(i,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":ss(i,"is",g);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=Al.get(u)||u,ss(i,u,g))}}function j0(i,a,u,g,w,C){switch(u){case"style":Qi(i,g,C);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(n(61));if(u=g.__html,u!=null){if(w.children!=null)throw Error(n(60));i.innerHTML=u}}break;case"children":typeof g=="string"?jr(i,g):(typeof g=="number"||typeof g=="bigint")&&jr(i,""+g);break;case"onScroll":g!=null&&Oi("scroll",i);break;case"onScrollEnd":g!=null&&Oi("scrollend",i);break;case"onClick":g!=null&&(i.onclick=co);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!pi.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(w=u.endsWith("Capture"),a=u.slice(2,w?u.length-7:void 0),C=i[Si]||null,C=C!=null?C[u]:null,typeof C=="function"&&i.removeEventListener(a,C,w),typeof g=="function")){typeof C!="function"&&C!==null&&(u in i?i[u]=null:i.hasAttribute(u)&&i.removeAttribute(u)),i.addEventListener(a,g,w);break e}u in i?i[u]=g:g===!0?i.setAttribute(u,""):ss(i,u,g)}}}function To(i,a,u){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Oi("error",i),Oi("load",i);var g=!1,w=!1,C;for(C in u)if(u.hasOwnProperty(C)){var W=u[C];if(W!=null)switch(C){case"src":g=!0;break;case"srcSet":w=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:Is(i,a,C,W,u,null)}}w&&Is(i,a,"srcSet",u.srcSet,u,null),g&&Is(i,a,"src",u.src,u,null);return;case"input":Oi("invalid",i);var le=C=W=w=null,Me=null,tt=null;for(g in u)if(u.hasOwnProperty(g)){var pt=u[g];if(pt!=null)switch(g){case"name":w=pt;break;case"type":W=pt;break;case"checked":Me=pt;break;case"defaultChecked":tt=pt;break;case"value":C=pt;break;case"defaultValue":le=pt;break;case"children":case"dangerouslySetInnerHTML":if(pt!=null)throw Error(n(137,a));break;default:Is(i,a,g,pt,u,null)}}bc(i,C,le,Me,tt,W,w,!1);return;case"select":Oi("invalid",i),g=W=C=null;for(w in u)if(u.hasOwnProperty(w)&&(le=u[w],le!=null))switch(w){case"value":C=le;break;case"defaultValue":W=le;break;case"multiple":g=le;default:Is(i,a,w,le,u,null)}a=C,u=W,i.multiple=!!g,a!=null?kr(i,!!g,a,!1):u!=null&&kr(i,!!g,u,!0);return;case"textarea":Oi("invalid",i),C=w=g=null;for(W in u)if(u.hasOwnProperty(W)&&(le=u[W],le!=null))switch(W){case"value":g=le;break;case"defaultValue":w=le;break;case"children":C=le;break;case"dangerouslySetInnerHTML":if(le!=null)throw Error(n(91));break;default:Is(i,a,W,le,u,null)}Ya(i,g,w,C);return;case"option":for(Me in u)if(u.hasOwnProperty(Me)&&(g=u[Me],g!=null))switch(Me){case"selected":i.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:Is(i,a,Me,g,u,null)}return;case"dialog":Oi("beforetoggle",i),Oi("toggle",i),Oi("cancel",i),Oi("close",i);break;case"iframe":case"object":Oi("load",i);break;case"video":case"audio":for(g=0;g<Hf.length;g++)Oi(Hf[g],i);break;case"image":Oi("error",i),Oi("load",i);break;case"details":Oi("toggle",i);break;case"embed":case"source":case"link":Oi("error",i),Oi("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(tt in u)if(u.hasOwnProperty(tt)&&(g=u[tt],g!=null))switch(tt){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:Is(i,a,tt,g,u,null)}return;default:if(fr(a)){for(pt in u)u.hasOwnProperty(pt)&&(g=u[pt],g!==void 0&&j0(i,a,pt,g,u,void 0));return}}for(le in u)u.hasOwnProperty(le)&&(g=u[le],g!=null&&Is(i,a,le,g,u,null))}function Xv(i,a,u,g){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var w=null,C=null,W=null,le=null,Me=null,tt=null,pt=null;for(ot in u){var vt=u[ot];if(u.hasOwnProperty(ot)&&vt!=null)switch(ot){case"checked":break;case"value":break;case"defaultValue":Me=vt;default:g.hasOwnProperty(ot)||Is(i,a,ot,null,g,vt)}}for(var nt in g){var ot=g[nt];if(vt=u[nt],g.hasOwnProperty(nt)&&(ot!=null||vt!=null))switch(nt){case"type":C=ot;break;case"name":w=ot;break;case"checked":tt=ot;break;case"defaultChecked":pt=ot;break;case"value":W=ot;break;case"defaultValue":le=ot;break;case"children":case"dangerouslySetInnerHTML":if(ot!=null)throw Error(n(137,a));break;default:ot!==vt&&Is(i,a,nt,ot,g,vt)}}Xl(i,W,le,Me,tt,pt,C,w);return;case"select":ot=W=le=nt=null;for(C in u)if(Me=u[C],u.hasOwnProperty(C)&&Me!=null)switch(C){case"value":break;case"multiple":ot=Me;default:g.hasOwnProperty(C)||Is(i,a,C,null,g,Me)}for(w in g)if(C=g[w],Me=u[w],g.hasOwnProperty(w)&&(C!=null||Me!=null))switch(w){case"value":nt=C;break;case"defaultValue":le=C;break;case"multiple":W=C;default:C!==Me&&Is(i,a,w,C,g,Me)}a=le,u=W,g=ot,nt!=null?kr(i,!!u,nt,!1):!!g!=!!u&&(a!=null?kr(i,!!u,a,!0):kr(i,!!u,u?[]:"",!1));return;case"textarea":ot=nt=null;for(le in u)if(w=u[le],u.hasOwnProperty(le)&&w!=null&&!g.hasOwnProperty(le))switch(le){case"value":break;case"children":break;default:Is(i,a,le,null,g,w)}for(W in g)if(w=g[W],C=u[W],g.hasOwnProperty(W)&&(w!=null||C!=null))switch(W){case"value":nt=w;break;case"defaultValue":ot=w;break;case"children":break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(n(91));break;default:w!==C&&Is(i,a,W,w,g,C)}sl(i,nt,ot);return;case"option":for(var dn in u)if(nt=u[dn],u.hasOwnProperty(dn)&&nt!=null&&!g.hasOwnProperty(dn))switch(dn){case"selected":i.selected=!1;break;default:Is(i,a,dn,null,g,nt)}for(Me in g)if(nt=g[Me],ot=u[Me],g.hasOwnProperty(Me)&&nt!==ot&&(nt!=null||ot!=null))switch(Me){case"selected":i.selected=nt&&typeof nt!="function"&&typeof nt!="symbol";break;default:Is(i,a,Me,nt,g,ot)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Wn in u)nt=u[Wn],u.hasOwnProperty(Wn)&&nt!=null&&!g.hasOwnProperty(Wn)&&Is(i,a,Wn,null,g,nt);for(tt in g)if(nt=g[tt],ot=u[tt],g.hasOwnProperty(tt)&&nt!==ot&&(nt!=null||ot!=null))switch(tt){case"children":case"dangerouslySetInnerHTML":if(nt!=null)throw Error(n(137,a));break;default:Is(i,a,tt,nt,g,ot)}return;default:if(fr(a)){for(var Bs in u)nt=u[Bs],u.hasOwnProperty(Bs)&&nt!==void 0&&!g.hasOwnProperty(Bs)&&j0(i,a,Bs,void 0,g,nt);for(pt in g)nt=g[pt],ot=u[pt],!g.hasOwnProperty(pt)||nt===ot||nt===void 0&&ot===void 0||j0(i,a,pt,nt,g,ot);return}}for(var Ge in u)nt=u[Ge],u.hasOwnProperty(Ge)&&nt!=null&&!g.hasOwnProperty(Ge)&&Is(i,a,Ge,null,g,nt);for(vt in g)nt=g[vt],ot=u[vt],!g.hasOwnProperty(vt)||nt===ot||nt==null&&ot==null||Is(i,a,vt,nt,g,ot)}function h1(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Kv(){if(typeof performance.getEntriesByType=="function"){for(var i=0,a=0,u=performance.getEntriesByType("resource"),g=0;g<u.length;g++){var w=u[g],C=w.transferSize,W=w.initiatorType,le=w.duration;if(C&&le&&h1(W)){for(W=0,le=w.responseEnd,g+=1;g<u.length;g++){var Me=u[g],tt=Me.startTime;if(tt>le)break;var pt=Me.transferSize,vt=Me.initiatorType;pt&&h1(vt)&&(Me=Me.responseEnd,W+=pt*(Me<le?1:(le-tt)/(Me-tt)))}if(--g,a+=8*(C+W)/(w.duration/1e3),i++,10<i)break}}if(0<i)return a/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var N0=null,P0=null;function sg(i){return i.nodeType===9?i:i.ownerDocument}function f1(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function p1(i,a){if(i===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&a==="foreignObject"?0:i}function E0(i,a){return i==="textarea"||i==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var R0=null;function Zv(){var i=window.event;return i&&i.type==="popstate"?i===R0?!1:(R0=i,!0):(R0=null,!1)}var g1=typeof setTimeout=="function"?setTimeout:void 0,Jv=typeof clearTimeout=="function"?clearTimeout:void 0,m1=typeof Promise=="function"?Promise:void 0,Qv=typeof queueMicrotask=="function"?queueMicrotask:typeof m1<"u"?function(i){return m1.resolve(null).then(i).catch(ew)}:g1;function ew(i){setTimeout(function(){throw i})}function Su(i){return i==="head"}function y1(i,a){var u=a,g=0;do{var w=u.nextSibling;if(i.removeChild(u),w&&w.nodeType===8)if(u=w.data,u==="/$"||u==="/&"){if(g===0){i.removeChild(w),Yh(a);return}g--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")g++;else if(u==="html")Vf(i.ownerDocument.documentElement);else if(u==="head"){u=i.ownerDocument.head,Vf(u);for(var C=u.firstChild;C;){var W=C.nextSibling,le=C.nodeName;C[Wa]||le==="SCRIPT"||le==="STYLE"||le==="LINK"&&C.rel.toLowerCase()==="stylesheet"||u.removeChild(C),C=W}}else u==="body"&&Vf(i.ownerDocument.body);u=w}while(u);Yh(a)}function x1(i,a){var u=i;i=0;do{var g=u.nextSibling;if(u.nodeType===1?a?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(a?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),g&&g.nodeType===8)if(u=g.data,u==="/$"){if(i===0)break;i--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||i++;u=g}while(u)}function D0(i){var a=i.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var u=a;switch(a=a.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":D0(u),No(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}i.removeChild(u)}}function tw(i,a,u,g){for(;i.nodeType===1;){var w=u;if(i.nodeName.toLowerCase()!==a.toLowerCase()){if(!g&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(g){if(!i[Wa])switch(a){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(C=i.getAttribute("rel"),C==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(C!==w.rel||i.getAttribute("href")!==(w.href==null||w.href===""?null:w.href)||i.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin)||i.getAttribute("title")!==(w.title==null?null:w.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(C=i.getAttribute("src"),(C!==(w.src==null?null:w.src)||i.getAttribute("type")!==(w.type==null?null:w.type)||i.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin))&&C&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(a==="input"&&i.type==="hidden"){var C=w.name==null?null:""+w.name;if(w.type==="hidden"&&i.getAttribute("name")===C)return i}else return i;if(i=Dc(i.nextSibling),i===null)break}return null}function nw(i,a,u){if(a==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!u||(i=Dc(i.nextSibling),i===null))return null;return i}function b1(i,a){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!a||(i=Dc(i.nextSibling),i===null))return null;return i}function L0(i){return i.data==="$?"||i.data==="$~"}function M0(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function iw(i,a){var u=i.ownerDocument;if(i.data==="$~")i._reactRetry=a;else if(i.data!=="$?"||u.readyState!=="loading")a();else{var g=function(){a(),u.removeEventListener("DOMContentLoaded",g)};u.addEventListener("DOMContentLoaded",g),i._reactRetry=g}}function Dc(i){for(;i!=null;i=i.nextSibling){var a=i.nodeType;if(a===1||a===3)break;if(a===8){if(a=i.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return i}var z0=null;function v1(i){i=i.nextSibling;for(var a=0;i;){if(i.nodeType===8){var u=i.data;if(u==="/$"||u==="/&"){if(a===0)return Dc(i.nextSibling);a--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||a++}i=i.nextSibling}return null}function w1(i){i=i.previousSibling;for(var a=0;i;){if(i.nodeType===8){var u=i.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(a===0)return i;a--}else u!=="/$"&&u!=="/&"||a++}i=i.previousSibling}return null}function S1(i,a,u){switch(a=sg(u),i){case"html":if(i=a.documentElement,!i)throw Error(n(452));return i;case"head":if(i=a.head,!i)throw Error(n(453));return i;case"body":if(i=a.body,!i)throw Error(n(454));return i;default:throw Error(n(451))}}function Vf(i){for(var a=i.attributes;a.length;)i.removeAttributeNode(a[0]);No(i)}var Lc=new Map,A1=new Set;function rg(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var qd=J.d;J.d={f:sw,r:rw,D:aw,C:ow,L:lw,m:cw,X:uw,S:dw,M:hw};function sw(){var i=qd.f(),a=Kp();return i||a}function rw(i){var a=Fr(i);a!==null&&a.tag===5&&a.type==="form"?Rp(a):qd.r(i)}var Wh=typeof document>"u"?null:document;function T1(i,a,u){var g=Wh;if(g&&typeof a=="string"&&a){var w=bi(a);w='link[rel="'+i+'"][href="'+w+'"]',typeof u=="string"&&(w+='[crossorigin="'+u+'"]'),A1.has(w)||(A1.add(w),i={rel:i,crossOrigin:u,href:a},g.querySelector(w)===null&&(a=g.createElement("link"),To(a,"link",i),En(a),g.head.appendChild(a)))}}function aw(i){qd.D(i),T1("dns-prefetch",i,null)}function ow(i,a){qd.C(i,a),T1("preconnect",i,a)}function lw(i,a,u){qd.L(i,a,u);var g=Wh;if(g&&i&&a){var w='link[rel="preload"][as="'+bi(a)+'"]';a==="image"&&u&&u.imageSrcSet?(w+='[imagesrcset="'+bi(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(w+='[imagesizes="'+bi(u.imageSizes)+'"]')):w+='[href="'+bi(i)+'"]';var C=w;switch(a){case"style":C=$h(i);break;case"script":C=Gh(i)}Lc.has(C)||(i=b({rel:"preload",href:a==="image"&&u&&u.imageSrcSet?void 0:i,as:a},u),Lc.set(C,i),g.querySelector(w)!==null||a==="style"&&g.querySelector(Wf(C))||a==="script"&&g.querySelector($f(C))||(a=g.createElement("link"),To(a,"link",i),En(a),g.head.appendChild(a)))}}function cw(i,a){qd.m(i,a);var u=Wh;if(u&&i){var g=a&&typeof a.as=="string"?a.as:"script",w='link[rel="modulepreload"][as="'+bi(g)+'"][href="'+bi(i)+'"]',C=w;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":C=Gh(i)}if(!Lc.has(C)&&(i=b({rel:"modulepreload",href:i},a),Lc.set(C,i),u.querySelector(w)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector($f(C)))return}g=u.createElement("link"),To(g,"link",i),En(g),u.head.appendChild(g)}}}function dw(i,a,u){qd.S(i,a,u);var g=Wh;if(g&&i){var w=ga(g).hoistableStyles,C=$h(i);a=a||"default";var W=w.get(C);if(!W){var le={loading:0,preload:null};if(W=g.querySelector(Wf(C)))le.loading=5;else{i=b({rel:"stylesheet",href:i,"data-precedence":a},u),(u=Lc.get(C))&&I0(i,u);var Me=W=g.createElement("link");En(Me),To(Me,"link",i),Me._p=new Promise(function(tt,pt){Me.onload=tt,Me.onerror=pt}),Me.addEventListener("load",function(){le.loading|=1}),Me.addEventListener("error",function(){le.loading|=2}),le.loading|=4,ag(W,a,g)}W={type:"stylesheet",instance:W,count:1,state:le},w.set(C,W)}}}function uw(i,a){qd.X(i,a);var u=Wh;if(u&&i){var g=ga(u).hoistableScripts,w=Gh(i),C=g.get(w);C||(C=u.querySelector($f(w)),C||(i=b({src:i,async:!0},a),(a=Lc.get(w))&&B0(i,a),C=u.createElement("script"),En(C),To(C,"link",i),u.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},g.set(w,C))}}function hw(i,a){qd.M(i,a);var u=Wh;if(u&&i){var g=ga(u).hoistableScripts,w=Gh(i),C=g.get(w);C||(C=u.querySelector($f(w)),C||(i=b({src:i,async:!0,type:"module"},a),(a=Lc.get(w))&&B0(i,a),C=u.createElement("script"),En(C),To(C,"link",i),u.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},g.set(w,C))}}function C1(i,a,u,g){var w=(w=Ne.current)?rg(w):null;if(!w)throw Error(n(446));switch(i){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(a=$h(u.href),u=ga(w).hoistableStyles,g=u.get(a),g||(g={type:"style",instance:null,count:0,state:null},u.set(a,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){i=$h(u.href);var C=ga(w).hoistableStyles,W=C.get(i);if(W||(w=w.ownerDocument||w,W={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},C.set(i,W),(C=w.querySelector(Wf(i)))&&!C._p&&(W.instance=C,W.state.loading=5),Lc.has(i)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Lc.set(i,u),C||fw(w,i,u,W.state))),a&&g===null)throw Error(n(528,""));return W}if(a&&g!==null)throw Error(n(529,""));return null;case"script":return a=u.async,u=u.src,typeof u=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Gh(u),u=ga(w).hoistableScripts,g=u.get(a),g||(g={type:"script",instance:null,count:0,state:null},u.set(a,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,i))}}function $h(i){return'href="'+bi(i)+'"'}function Wf(i){return'link[rel="stylesheet"]['+i+"]"}function _1(i){return b({},i,{"data-precedence":i.precedence,precedence:null})}function fw(i,a,u,g){i.querySelector('link[rel="preload"][as="style"]['+a+"]")?g.loading=1:(a=i.createElement("link"),g.preload=a,a.addEventListener("load",function(){return g.loading|=1}),a.addEventListener("error",function(){return g.loading|=2}),To(a,"link",u),En(a),i.head.appendChild(a))}function Gh(i){return'[src="'+bi(i)+'"]'}function $f(i){return"script[async]"+i}function k1(i,a,u){if(a.count++,a.instance===null)switch(a.type){case"style":var g=i.querySelector('style[data-href~="'+bi(u.href)+'"]');if(g)return a.instance=g,En(g),g;var w=b({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return g=(i.ownerDocument||i).createElement("style"),En(g),To(g,"style",w),ag(g,u.precedence,i),a.instance=g;case"stylesheet":w=$h(u.href);var C=i.querySelector(Wf(w));if(C)return a.state.loading|=4,a.instance=C,En(C),C;g=_1(u),(w=Lc.get(w))&&I0(g,w),C=(i.ownerDocument||i).createElement("link"),En(C);var W=C;return W._p=new Promise(function(le,Me){W.onload=le,W.onerror=Me}),To(C,"link",g),a.state.loading|=4,ag(C,u.precedence,i),a.instance=C;case"script":return C=Gh(u.src),(w=i.querySelector($f(C)))?(a.instance=w,En(w),w):(g=u,(w=Lc.get(C))&&(g=b({},u),B0(g,w)),i=i.ownerDocument||i,w=i.createElement("script"),En(w),To(w,"link",g),i.head.appendChild(w),a.instance=w);case"void":return null;default:throw Error(n(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(g=a.instance,a.state.loading|=4,ag(g,u.precedence,i));return a.instance}function ag(i,a,u){for(var g=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),w=g.length?g[g.length-1]:null,C=w,W=0;W<g.length;W++){var le=g[W];if(le.dataset.precedence===a)C=le;else if(C!==w)break}C?C.parentNode.insertBefore(i,C.nextSibling):(a=u.nodeType===9?u.head:u,a.insertBefore(i,a.firstChild))}function I0(i,a){i.crossOrigin==null&&(i.crossOrigin=a.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=a.referrerPolicy),i.title==null&&(i.title=a.title)}function B0(i,a){i.crossOrigin==null&&(i.crossOrigin=a.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=a.referrerPolicy),i.integrity==null&&(i.integrity=a.integrity)}var og=null;function j1(i,a,u){if(og===null){var g=new Map,w=og=new Map;w.set(u,g)}else w=og,g=w.get(u),g||(g=new Map,w.set(u,g));if(g.has(i))return g;for(g.set(i,null),u=u.getElementsByTagName(i),w=0;w<u.length;w++){var C=u[w];if(!(C[Wa]||C[Ci]||i==="link"&&C.getAttribute("rel")==="stylesheet")&&C.namespaceURI!=="http://www.w3.org/2000/svg"){var W=C.getAttribute(a)||"";W=i+W;var le=g.get(W);le?le.push(C):g.set(W,[C])}}return g}function N1(i,a,u){i=i.ownerDocument||i,i.head.insertBefore(u,a==="title"?i.querySelector("head > title"):null)}function pw(i,a,u){if(u===1||a.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return i=a.disabled,typeof a.precedence=="string"&&i==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function P1(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function gw(i,a,u,g){if(u.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var w=$h(g.href),C=a.querySelector(Wf(w));if(C){a=C._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(i.count++,i=lg.bind(i),a.then(i,i)),u.state.loading|=4,u.instance=C,En(C);return}C=a.ownerDocument||a,g=_1(g),(w=Lc.get(w))&&I0(g,w),C=C.createElement("link"),En(C);var W=C;W._p=new Promise(function(le,Me){W.onload=le,W.onerror=Me}),To(C,"link",g),u.instance=C}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(u,a),(a=u.state.preload)&&(u.state.loading&3)===0&&(i.count++,u=lg.bind(i),a.addEventListener("load",u),a.addEventListener("error",u))}}var O0=0;function mw(i,a){return i.stylesheets&&i.count===0&&dg(i,i.stylesheets),0<i.count||0<i.imgCount?function(u){var g=setTimeout(function(){if(i.stylesheets&&dg(i,i.stylesheets),i.unsuspend){var C=i.unsuspend;i.unsuspend=null,C()}},6e4+a);0<i.imgBytes&&O0===0&&(O0=62500*Kv());var w=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&dg(i,i.stylesheets),i.unsuspend)){var C=i.unsuspend;i.unsuspend=null,C()}},(i.imgBytes>O0?50:800)+a);return i.unsuspend=u,function(){i.unsuspend=null,clearTimeout(g),clearTimeout(w)}}:null}function lg(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)dg(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var cg=null;function dg(i,a){i.stylesheets=null,i.unsuspend!==null&&(i.count++,cg=new Map,a.forEach(yw,i),cg=null,lg.call(i))}function yw(i,a){if(!(a.state.loading&4)){var u=cg.get(i);if(u)var g=u.get(null);else{u=new Map,cg.set(i,u);for(var w=i.querySelectorAll("link[data-precedence],style[data-precedence]"),C=0;C<w.length;C++){var W=w[C];(W.nodeName==="LINK"||W.getAttribute("media")!=="not all")&&(u.set(W.dataset.precedence,W),g=W)}g&&u.set(null,g)}w=a.instance,W=w.getAttribute("data-precedence"),C=u.get(W)||g,C===g&&u.set(null,w),u.set(W,w),this.count++,g=lg.bind(this),w.addEventListener("load",g),w.addEventListener("error",g),C?C.parentNode.insertBefore(w,C.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(w,i.firstChild)),a.state.loading|=4}}var Gf={$$typeof:z,Provider:null,Consumer:null,_currentValue:ce,_currentValue2:ce,_threadCount:0};function xw(i,a,u,g,w,C,W,le,Me){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Br(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Br(0),this.hiddenUpdates=Br(null),this.identifierPrefix=g,this.onUncaughtError=w,this.onCaughtError=C,this.onRecoverableError=W,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Me,this.incompleteTransitions=new Map}function E1(i,a,u,g,w,C,W,le,Me,tt,pt,vt){return i=new xw(i,a,u,W,Me,tt,pt,vt,le),a=1,C===!0&&(a|=24),C=ia(3,null,null,a),i.current=C,C.stateNode=i,a=ra(),a.refCount++,i.pooledCache=a,a.refCount++,C.memoizedState={element:g,isDehydrated:u,cache:a},Rt(C),i}function R1(i){return i?(i=Er,i):Er}function D1(i,a,u,g,w,C){w=R1(w),g.context===null?g.context=w:g.pendingContext=w,g=Pn(a),g.payload={element:u},C=C===void 0?null:C,C!==null&&(g.callback=C),u=Hn(i,g,a),u!==null&&(ql(u,i,a),si(u,i,a))}function L1(i,a){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var u=i.retryLane;i.retryLane=u!==0&&u<a?u:a}}function F0(i,a){L1(i,a),(i=i.alternate)&&L1(i,a)}function M1(i){if(i.tag===13||i.tag===31){var a=Oo(i,67108864);a!==null&&ql(a,i,67108864),F0(i,67108864)}}function z1(i){if(i.tag===13||i.tag===31){var a=fc();a=fi(a);var u=Oo(i,a);u!==null&&ql(u,i,a),F0(i,a)}}var ug=!0;function bw(i,a,u,g){var w=q.T;q.T=null;var C=J.p;try{J.p=2,U0(i,a,u,g)}finally{J.p=C,q.T=w}}function vw(i,a,u,g){var w=q.T;q.T=null;var C=J.p;try{J.p=8,U0(i,a,u,g)}finally{J.p=C,q.T=w}}function U0(i,a,u,g){if(ug){var w=H0(g);if(w===null)k0(i,a,g,hg,u),B1(i,g);else if(Sw(w,i,a,u,g))g.stopPropagation();else if(B1(i,g),a&4&&-1<ww.indexOf(i)){for(;w!==null;){var C=Fr(w);if(C!==null)switch(C.tag){case 3:if(C=C.stateNode,C.current.memoizedState.isDehydrated){var W=yn(C.pendingLanes);if(W!==0){var le=C;for(le.pendingLanes|=2,le.entangledLanes|=2;W;){var Me=1<<31-lt(W);le.entanglements[1]|=Me,W&=~Me}md(C),(ze&6)===0&&(Yp=Zn()+500,Uf(0))}}break;case 31:case 13:le=Oo(C,2),le!==null&&ql(le,C,2),Kp(),F0(C,2)}if(C=H0(g),C===null&&k0(i,a,g,hg,u),C===w)break;w=C}w!==null&&g.stopPropagation()}else k0(i,a,g,null,u)}}function H0(i){return i=es(i),q0(i)}var hg=null;function q0(i){if(hg=null,i=$n(i),i!==null){var a=o(i);if(a===null)i=null;else{var u=a.tag;if(u===13){if(i=d(a),i!==null)return i;i=null}else if(u===31){if(i=c(a),i!==null)return i;i=null}else if(u===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;i=null}else a!==i&&(i=null)}}return hg=i,null}function I1(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Pt()){case Mt:return 2;case yi:return 8;case ft:case _t:return 32;case On:return 268435456;default:return 32}default:return 32}}var V0=!1,Au=null,Tu=null,Cu=null,Yf=new Map,Xf=new Map,_u=[],ww="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function B1(i,a){switch(i){case"focusin":case"focusout":Au=null;break;case"dragenter":case"dragleave":Tu=null;break;case"mouseover":case"mouseout":Cu=null;break;case"pointerover":case"pointerout":Yf.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xf.delete(a.pointerId)}}function Kf(i,a,u,g,w,C){return i===null||i.nativeEvent!==C?(i={blockedOn:a,domEventName:u,eventSystemFlags:g,nativeEvent:C,targetContainers:[w]},a!==null&&(a=Fr(a),a!==null&&M1(a)),i):(i.eventSystemFlags|=g,a=i.targetContainers,w!==null&&a.indexOf(w)===-1&&a.push(w),i)}function Sw(i,a,u,g,w){switch(a){case"focusin":return Au=Kf(Au,i,a,u,g,w),!0;case"dragenter":return Tu=Kf(Tu,i,a,u,g,w),!0;case"mouseover":return Cu=Kf(Cu,i,a,u,g,w),!0;case"pointerover":var C=w.pointerId;return Yf.set(C,Kf(Yf.get(C)||null,i,a,u,g,w)),!0;case"gotpointercapture":return C=w.pointerId,Xf.set(C,Kf(Xf.get(C)||null,i,a,u,g,w)),!0}return!1}function O1(i){var a=$n(i.target);if(a!==null){var u=o(a);if(u!==null){if(a=u.tag,a===13){if(a=d(u),a!==null){i.blockedOn=a,Ji(i.priority,function(){z1(u)});return}}else if(a===31){if(a=c(u),a!==null){i.blockedOn=a,Ji(i.priority,function(){z1(u)});return}}else if(a===3&&u.stateNode.current.memoizedState.isDehydrated){i.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}i.blockedOn=null}function fg(i){if(i.blockedOn!==null)return!1;for(var a=i.targetContainers;0<a.length;){var u=H0(i.nativeEvent);if(u===null){u=i.nativeEvent;var g=new u.constructor(u.type,u);rs=g,u.target.dispatchEvent(g),rs=null}else return a=Fr(u),a!==null&&M1(a),i.blockedOn=u,!1;a.shift()}return!0}function F1(i,a,u){fg(i)&&u.delete(a)}function Aw(){V0=!1,Au!==null&&fg(Au)&&(Au=null),Tu!==null&&fg(Tu)&&(Tu=null),Cu!==null&&fg(Cu)&&(Cu=null),Yf.forEach(F1),Xf.forEach(F1)}function pg(i,a){i.blockedOn===a&&(i.blockedOn=null,V0||(V0=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Aw)))}var gg=null;function U1(i){gg!==i&&(gg=i,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){gg===i&&(gg=null);for(var a=0;a<i.length;a+=3){var u=i[a],g=i[a+1],w=i[a+2];if(typeof g!="function"){if(q0(g||u)===null)continue;break}var C=Fr(u);C!==null&&(i.splice(a,3),a-=3,Sf(C,{pending:!0,data:w,method:u.method,action:g},g,w))}}))}function Yh(i){function a(Me){return pg(Me,i)}Au!==null&&pg(Au,i),Tu!==null&&pg(Tu,i),Cu!==null&&pg(Cu,i),Yf.forEach(a),Xf.forEach(a);for(var u=0;u<_u.length;u++){var g=_u[u];g.blockedOn===i&&(g.blockedOn=null)}for(;0<_u.length&&(u=_u[0],u.blockedOn===null);)O1(u),u.blockedOn===null&&_u.shift();if(u=(i.ownerDocument||i).$$reactFormReplay,u!=null)for(g=0;g<u.length;g+=3){var w=u[g],C=u[g+1],W=w[Si]||null;if(typeof C=="function")W||U1(u);else if(W){var le=null;if(C&&C.hasAttribute("formAction")){if(w=C,W=C[Si]||null)le=W.formAction;else if(q0(w)!==null)continue}else le=W.action;typeof le=="function"?u[g+1]=le:(u.splice(g,3),g-=3),U1(u)}}}function H1(){function i(C){C.canIntercept&&C.info==="react-transition"&&C.intercept({handler:function(){return new Promise(function(W){return w=W})},focusReset:"manual",scroll:"manual"})}function a(){w!==null&&(w(),w=null),g||setTimeout(u,20)}function u(){if(!g&&!navigation.transition){var C=navigation.currentEntry;C&&C.url!=null&&navigation.navigate(C.url,{state:C.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,w=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(u,100),function(){g=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),w!==null&&(w(),w=null)}}}function W0(i){this._internalRoot=i}mg.prototype.render=W0.prototype.render=function(i){var a=this._internalRoot;if(a===null)throw Error(n(409));var u=a.current,g=fc();D1(u,g,i,a,null,null)},mg.prototype.unmount=W0.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var a=i.containerInfo;D1(i.current,2,null,i,null,null),Kp(),a[Cr]=null}};function mg(i){this._internalRoot=i}mg.prototype.unstable_scheduleHydration=function(i){if(i){var a=vs();i={blockedOn:null,target:i,priority:a};for(var u=0;u<_u.length&&a!==0&&a<_u[u].priority;u++);_u.splice(u,0,i),u===0&&O1(i)}};var q1=e.version;if(q1!=="19.2.0")throw Error(n(527,q1,"19.2.0"));J.findDOMNode=function(i){var a=i._reactInternals;if(a===void 0)throw typeof i.render=="function"?Error(n(188)):(i=Object.keys(i).join(","),Error(n(268,i)));return i=f(a),i=i!==null?m(i):null,i=i===null?null:i.stateNode,i};var Tw={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yg.isDisabled&&yg.supportsFiber)try{Nn=yg.inject(Tw),on=yg}catch{}}return Jf.createRoot=function(i,a){if(!s(i))throw Error(n(299));var u=!1,g="",w=Mp,C=zp,W=Gu;return a!=null&&(a.unstable_strictMode===!0&&(u=!0),a.identifierPrefix!==void 0&&(g=a.identifierPrefix),a.onUncaughtError!==void 0&&(w=a.onUncaughtError),a.onCaughtError!==void 0&&(C=a.onCaughtError),a.onRecoverableError!==void 0&&(W=a.onRecoverableError)),a=E1(i,1,!1,null,null,u,g,null,w,C,W,H1),i[Cr]=a.current,_0(i),new W0(a)},Jf.hydrateRoot=function(i,a,u){if(!s(i))throw Error(n(299));var g=!1,w="",C=Mp,W=zp,le=Gu,Me=null;return u!=null&&(u.unstable_strictMode===!0&&(g=!0),u.identifierPrefix!==void 0&&(w=u.identifierPrefix),u.onUncaughtError!==void 0&&(C=u.onUncaughtError),u.onCaughtError!==void 0&&(W=u.onCaughtError),u.onRecoverableError!==void 0&&(le=u.onRecoverableError),u.formState!==void 0&&(Me=u.formState)),a=E1(i,1,!0,a,u??null,g,w,Me,C,W,le,H1),a.context=R1(null),u=a.current,g=fc(),g=fi(g),w=Pn(g),w.callback=null,Hn(u,w,g),u=g,a.current.lanes=u,Zt(a,u),md(a),i[Cr]=a.current,_0(i),new mg(a)},Jf.version="19.2.0",Jf}var tx;function Mw(){if(tx)return X0.exports;tx=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),X0.exports=Lw(),X0.exports}var zw=Mw();/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iw=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Bw=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),nx=r=>{const e=Bw(r);return e.charAt(0).toUpperCase()+e.slice(1)},Jb=(...r)=>r.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim(),Ow=r=>{for(const e in r)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Fw={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uw=K.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:s="",children:o,iconNode:d,...c},h)=>K.createElement("svg",{ref:h,...Fw,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:Jb("lucide",s),...!o&&!Ow(c)&&{"aria-hidden":"true"},...c},[...d.map(([f,m])=>K.createElement(f,m)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qb=(r,e)=>{const t=K.forwardRef(({className:n,...s},o)=>K.createElement(Uw,{ref:o,iconNode:e,className:Jb(`lucide-${Iw(nx(r))}`,`lucide-${r}`,n),...s}));return t.displayName=nx(r),t};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hw=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],qw=Qb("mouse-pointer",Hw);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vw=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Ww=Qb("pen-line",Vw),$w=JSON.parse('[{"category":"Capacitors","subcategory":"General","type":"Capacitor","displayName":"Capacitor","description":"General purpose capacitor","searchText":"capacitor general","designator":"C","defaultPins":2,"properties":{"capacitorType":"General"},"fields":[{"name":"capacitance","label":"Capacitance","type":"number","units":["pF","nF","F","mF","F"],"defaultUnit":"F","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"tolerance","label":"Tolerance","type":"string","required":false},{"name":"dielectric","label":"Dielectric","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Capacitors","subcategory":"Electrolytic","type":"Capacitor","displayName":"Electrolytic","description":"Electrolytic capacitor","searchText":"electrolytic capacitor","designator":"CE","defaultPins":2,"properties":{"capacitorType":"Electrolytic","polarized":true},"fields":[{"name":"capacitance","label":"Capacitance","type":"number","units":["pF","nF","F","mF","F"],"defaultUnit":"F","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"tolerance","label":"Tolerance","type":"string","defaultValue":"20%","required":false},{"name":"esr","label":"ESR","type":"number","units":["m",""],"defaultUnit":"","required":false},{"name":"temperature","label":"Temperature Range","type":"string","required":false},{"name":"ripple","label":"Ripple Current","type":"number","units":["mA","A"],"defaultUnit":"mA","required":false},{"name":"leakageCurrent","label":"Leakage Current","type":"number","units":["A","mA"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Capacitors","subcategory":"Film","type":"Capacitor","displayName":"Film","description":"Film capacitor","searchText":"film capacitor","designator":"CF","defaultPins":2,"properties":{"capacitorType":"Film"},"fields":[{"name":"capacitance","label":"Capacitance","type":"number","units":["pF","nF","F","mF","F"],"defaultUnit":"nF","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"tolerance","label":"Tolerance","type":"string","defaultValue":"10%","required":false},{"name":"filmType","label":"Film Type","type":"enum","enumValues":["Polyester","Polypropylene","Polyethylene","Polystyrene","Teflon"],"defaultValue":"Polyester","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Capacitors","subcategory":"Tantalum","type":"Capacitor","displayName":"Tantalum","description":"Tantalum capacitor","searchText":"tantalum capacitor","designator":"C","defaultPins":2,"properties":{"capacitorType":"Tantalum","dielectric":"Tantalum","polarized":true},"fields":[{"name":"capacitance","label":"Capacitance","type":"number","units":["pF","nF","F","mF","F"],"defaultUnit":"F","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"tolerance","label":"Tolerance","type":"string","required":false},{"name":"esr","label":"ESR","type":"number","units":["m",""],"defaultUnit":"","required":false},{"name":"leakageCurrent","label":"Leakage Current","type":"number","units":["A","mA"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Diodes","subcategory":"Standard","type":"Diode","displayName":"Diode","description":"Standard diode","searchText":"diode standard","designator":"D","defaultPins":2,"subtype":"Standard","properties":{"diodeType":"Standard","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"Zener","type":"Diode","displayName":"Zener","description":"Zener diode","searchText":"zener diode","designator":"Z","defaultPins":2,"subtype":"Zener","properties":{"diodeType":"Zener","polarized":true},"fields":[{"name":"voltage","label":"Zener Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"mA","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"LED","type":"Diode","displayName":"LED","description":"LED diode","searchText":"led diode","designator":"LED","defaultPins":2,"subtype":"LED","properties":{"diodeType":"LED","polarized":true},"fields":[{"name":"voltage","label":"Forward Voltage","type":"number","units":["mV","V"],"defaultUnit":"V","required":false},{"name":"current","label":"Forward Current","type":"number","units":["mA","A"],"defaultUnit":"mA","required":false},{"name":"ledColor","label":"Color","type":"string","required":false},{"name":"wavelength","label":"Wavelength","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"Schottky","type":"Diode","displayName":"Schottky","description":"Schottky diode","searchText":"schottky diode","designator":"D","defaultPins":2,"subtype":"Schottky","properties":{"diodeType":"Schottky","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"Infrared","type":"Diode","displayName":"Infrared","description":"Infrared diode","searchText":"infrared diode","designator":"IR","defaultPins":2,"subtype":"Infrared","properties":{"diodeType":"Infrared","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["mA","A"],"defaultUnit":"mA","required":false},{"name":"wavelength","label":"Wavelength","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"Photodiode","type":"Diode","displayName":"Photodiode","description":"Photodiode","searchText":"photodiode diode","designator":"PD","defaultPins":2,"subtype":"Photodiode","properties":{"diodeType":"Photodiode","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"wavelength","label":"Wavelength","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Resistors","subcategory":"Standard","type":"Resistor","displayName":"Resistor","description":"Standard resistor","searchText":"resistor standard","designator":"R","defaultPins":2,"properties":{"resistorType":"Standard"},"fields":[{"name":"resistance","label":"Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"tolerance","label":"Tolerance","type":"string","defaultValue":"5%","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Resistors","subcategory":"Network","type":"Resistor","displayName":"Resistor Network","description":"Resistor network","searchText":"resistor network","designator":"RN","defaultPins":8,"properties":{"resistorType":"Network"},"fields":[{"name":"resistance","label":"Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"configuration","label":"Configuration","type":"enum","enumValues":["Isolated","Bussed","Dual Terminator"],"defaultValue":"Isolated","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Resistors","subcategory":"Thermistor","type":"Resistor","displayName":"Thermistor","description":"Thermistor resistor","searchText":"thermistor resistor","designator":"RT","defaultPins":2,"properties":{"resistorType":"Thermistor"},"fields":[{"name":"resistance","label":"Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"thermistorType","label":"Thermistor Type","type":"enum","enumValues":["NTC","PTC"],"defaultValue":"NTC","required":false},{"name":"beta","label":"Beta Value","type":"number","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Resistors","subcategory":"Variable","type":"Resistor","displayName":"Variable Resistor","description":"Variable resistor","searchText":"variable resistor","designator":"VR","defaultPins":3,"subtype":"Potentiometer","properties":{"resistorType":"Variable","vrType":"Potentiometer"},"fields":[{"name":"resistance","label":"Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"taper","label":"Taper","type":"enum","enumValues":["Linear","Logarithmic"],"defaultValue":"Linear","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Resistors","subcategory":"Varistor","type":"Resistor","displayName":"Varistor","description":"Varistor resistor","searchText":"varistor resistor","designator":"RV","defaultPins":3,"subtype":"Varistor","properties":{"resistorType":"Variable","vrType":"Varistor"},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"BJT","type":"Semiconductor","displayName":"BJT","description":"Bipolar Junction Transistor (Base, Emitter, Collector)","searchText":"bjt transistor bipolar junction base emitter collector npn pnp","designator":"Q","defaultPins":3,"properties":{"semiconductorType":"Transistor","transistorType":"BJT","pinNames":["Base","Emitter","Collector"]},"fields":[{"name":"polarity","label":"Polarity","type":"enum","enumValues":["NPN","PNP"],"defaultValue":"NPN","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"MOSFET","type":"Semiconductor","displayName":"MOSFET","description":"Metal-Oxide-Semiconductor Field-Effect Transistor (Source, Gate, Drain)","searchText":"mosfet transistor metal oxide semiconductor field effect source gate drain n-channel p-channel","designator":"Q","defaultPins":3,"properties":{"semiconductorType":"Transistor","transistorType":"MOSFET","pinNames":["Source","Gate","Drain"]},"fields":[{"name":"polarity","label":"Polarity","type":"enum","enumValues":["N-Channel","P-Channel"],"defaultValue":"N-Channel","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"JFET","type":"Semiconductor","displayName":"JFET","description":"Junction Field-Effect Transistor (Source, Gate, Drain)","searchText":"jfet transistor junction field effect source gate drain n-channel p-channel","designator":"Q","defaultPins":3,"properties":{"semiconductorType":"Transistor","transistorType":"JFET","pinNames":["Source","Gate","Drain"]},"fields":[{"name":"polarity","label":"Polarity","type":"enum","enumValues":["N-Channel","P-Channel"],"defaultValue":"N-Channel","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"Single Op Amp","type":"Semiconductor","displayName":"Single Op Amp","description":"Single operational amplifier","searchText":"single op amp operational amplifier opamp","designator":"U","defaultPins":5,"properties":{"semiconductorType":"OpAmp","pinNames":["V+","V-","input+","input-","output"]},"fields":[{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"packageType","label":"Package Type","type":"enum","enumValues":["SOT-23-5","SC70-5","Other"],"defaultValue":"SOT-23-5","required":false},{"name":"voltage","label":"Supply Voltage","type":"number","units":["V","mV"],"defaultUnit":"V","required":false},{"name":"description","label":"Description","type":"string","required":false},{"name":"datasheet","label":"Datasheet URL","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"Dual Op Amp","type":"Semiconductor","displayName":"Dual Op Amp","description":"Dual operational amplifier","searchText":"dual op amp operational amplifier opamp","designator":"U","defaultPins":8,"properties":{"semiconductorType":"OpAmp","pinNames":["A Output","A -Input","A +Input","V-","B +Input","B -Input","B Output","V+"]},"fields":[{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"packageType","label":"Package Type","type":"enum","enumValues":["DIP-8","SOIC-8","DIP-14","SOIC-14","SOT-23-5","Other"],"defaultValue":"DIP-8","required":false},{"name":"voltage","label":"Supply Voltage","type":"number","units":["V","mV"],"defaultUnit":"V","required":false},{"name":"description","label":"Description","type":"string","required":false},{"name":"datasheet","label":"Datasheet URL","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"Integrated Circuit","type":"Semiconductor","displayName":"Integrated Circuit","description":"Integrated circuit","searchText":"integrated circuit semiconductor ic","designator":"U","defaultPins":8,"properties":{"semiconductorType":"IntegratedCircuit","pinNames":["CHIP_DEPENDENT"]},"fields":[{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"icType","label":"IC Type","type":"string","required":false},{"name":"packageType","label":"Package Type","type":"enum","enumValues":["DIP","SOIC","QFP","BGA","TQFP","SSOP","TSOP"],"required":false},{"name":"description","label":"Description","type":"string","required":false},{"name":"datasheet","label":"Datasheet URL","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Passive Components","subcategory":"Inductor","type":"Inductor","displayName":"Inductor","description":"Inductor","searchText":"inductor","designator":"L","defaultPins":2,"properties":{"passiveType":"Inductor"},"fields":[{"name":"inductance","label":"Inductance","type":"number","units":["nH","H","mH","H"],"defaultUnit":"H","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"resistance","label":"DC Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Passive Components","subcategory":"Ferrite Bead","type":"FerriteBead","displayName":"Ferrite Bead","description":"Ferrite bead","searchText":"ferrite bead passive","designator":"FB","defaultPins":2,"properties":{"passiveType":"FerriteBead"},"fields":[{"name":"impedance","label":"Impedance","type":"number","units":["","m","k"],"defaultUnit":"","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Passive Components","subcategory":"Crystal","type":"Crystal","displayName":"Crystal","description":"Crystal oscillator","searchText":"crystal oscillator passive","designator":"X","defaultPins":2,"properties":{"passiveType":"Crystal"},"fields":[{"name":"frequency","label":"Frequency","type":"string","required":false},{"name":"loadCapacitance","label":"Load Capacitance","type":"string","required":false},{"name":"tolerance","label":"Tolerance","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Power & Energy","subcategory":"Battery","type":"PowerEnergy","displayName":"Battery","description":"Battery or battery holder","searchText":"battery power energy","designator":"B","defaultPins":2,"properties":{"powerType":"Battery","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"capacity","label":"Capacity","type":"number","units":["mAh","Ah"],"defaultUnit":"mAh","required":false},{"name":"chemistry","label":"Chemistry","type":"enum","enumValues":["Li-ion","Alkaline","NiMH","NiCd","Lead-acid"],"required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Power & Energy","subcategory":"Power Supply","type":"PowerEnergy","displayName":"Power Supply","description":"Power supply","searchText":"power supply energy","designator":"PS","defaultPins":4,"properties":{"powerType":"PowerSupply"},"fields":[{"name":"inputVoltage","label":"Input Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"outputVoltage","label":"Output Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"efficiency","label":"Efficiency","type":"number","required":false},{"name":"ripple","label":"Ripple","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Power & Energy","subcategory":"Fuse","type":"PowerEnergy","displayName":"Fuse","description":"Fuse","searchText":"fuse power energy","designator":"F","defaultPins":2,"properties":{"powerType":"Fuse"},"fields":[{"name":"current","label":"Current Rating","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"fuseType","label":"Fuse Type","type":"enum","enumValues":["Fast-blow","Slow-blow","Time-delay"],"defaultValue":"Fast-blow","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Connectors & Switches","subcategory":"Connector","type":"Connector","displayName":"Connector","description":"Connector","searchText":"connector","designator":"J","defaultPins":4,"properties":{"connectorType":"Connector"},"fields":[{"name":"connectorType","label":"Connector Type","type":"string","required":false},{"name":"gender","label":"Gender","type":"enum","enumValues":["Male","Female","N/A"],"defaultValue":"N/A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Connectors & Switches","subcategory":"Jumper","type":"Jumper","displayName":"Jumper","description":"Jumper link","searchText":"jumper link","designator":"JP","defaultPins":3,"properties":{"connectorType":"Jumper"},"fields":[{"name":"positions","label":"Positions","type":"number","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Connectors & Switches","subcategory":"Switch","type":"Switch","displayName":"Switch","description":"Switch","searchText":"switch","designator":"S","defaultPins":2,"properties":{"switchType":"Switch"},"fields":[{"name":"switchType","label":"Switch Type","type":"string","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Connectors & Switches","subcategory":"Relay","type":"Relay","displayName":"Relay","description":"Relay or contactor","searchText":"relay contactor","designator":"K","defaultPins":5,"properties":{"switchType":"Relay"},"fields":[{"name":"coilVoltage","label":"Coil Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"contactType","label":"Contact Type","type":"string","required":false},{"name":"current","label":"Contact Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Other","subcategory":"Transformer","type":"Transformer","displayName":"Transformer","description":"Transformer","searchText":"transformer","designator":"TR","defaultPins":4,"fields":[{"name":"primaryVoltage","label":"Primary Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"secondaryVoltage","label":"Secondary Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"turns","label":"Turns Ratio","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Speaker","type":"Speaker","displayName":"Speaker","description":"Loudspeaker or buzzer","searchText":"speaker loudspeaker buzzer","designator":"LS","defaultPins":2,"fields":[{"name":"impedance","label":"Impedance","type":"number","units":["","m","k"],"defaultUnit":"","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Motor","type":"Motor","displayName":"Motor","description":"Motor","searchText":"motor","designator":"M","defaultPins":2,"fields":[{"name":"motorType","label":"Motor Type","type":"string","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Test Point","type":"TestPoint","displayName":"Test Point","description":"Test point","searchText":"test point","designator":"TP","defaultPins":1,"fields":[{"name":"signal","label":"Signal","type":"string","required":false}]},{"category":"Other","subcategory":"Vacuum Tube","type":"VacuumTube","displayName":"Vacuum Tube","description":"Vacuum tube","searchText":"vacuum tube","designator":"V","defaultPins":5,"fields":[{"name":"tubeType","label":"Tube Type","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Attenuator","type":"GenericComponent","displayName":"Attenuator","description":"Attenuator or isolator","searchText":"attenuator isolator component","designator":"AT","defaultPins":2,"subtype":"Attenuator","fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Circuit Breaker","type":"GenericComponent","displayName":"Circuit Breaker","description":"Circuit breaker","searchText":"circuit breaker component","designator":"CB","defaultPins":2,"subtype":"CircuitBreaker","fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Thermocouple","type":"GenericComponent","displayName":"Thermocouple","description":"Thermocouple","searchText":"thermocouple component","designator":"TC","defaultPins":2,"subtype":"Thermocouple","fields":[{"name":"model","label":"Model","type":"string","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Tuner","type":"GenericComponent","displayName":"Tuner","description":"Tuner","searchText":"tuner component","designator":"TUN","defaultPins":2,"subtype":"Tuner","fields":[{"name":"frequency","label":"Frequency","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]}]'),i0={components:$w},Gw=["#FFFFFF","#BFBFBF","#7F7F7F","#3C3C3C","#000000","#A6CEE3","#56B4E9","#17BECF","#00BFC4","#1F77B4","#0072B2","#332288","#B2DF8A","#B3DE69","#2CA02C","#009E73","#FFED6F","#F0E442","#BCBD22","#E69F00","#FF7F0E","#FB9A99","#F781BF","#E15759","#D62728","#CAB2D6","#CC79A7","#AA4499","#6A3D9A","#9467BD","#9C755F","#8C564B"],Q0="#2CA02C",Yw="#F0E442",Xw="#00BFC4",em="#000000",Kw="#00008b",tm="#FF0000",py={DEFAULT_SIZE:18},lp={};i0.components.forEach(r=>{const e=r.type,t=r.designator;if(!lp[e])lp[e]={prefix:[t],defaultPins:r.defaultPins};else{const n=lp[e],s=[...new Set([...n.prefix,t])];lp[e]={prefix:s,defaultPins:n.defaultPins}}});const gy=lp,Xh={};i0.components.forEach(r=>{if(Xh[r.category]||(Xh[r.category]={}),!Xh[r.category][r.subcategory])Xh[r.category][r.subcategory]=[r.type];else{const e=Xh[r.category][r.subcategory];e.includes(r.type)||(Xh[r.category][r.subcategory]=[...e,r.type])}});const nm={DEFAULT_SIZE:18},e2={resistance:{validUnits:["","m","k","M"],defaultUnit:""},capacitance:{validUnits:["pF","nF","F","mF","F"],defaultUnit:"F"},voltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},current:{validUnits:["A","mA","A"],defaultUnit:"A"},power:{validUnits:["W","mW","kW"],defaultUnit:"W"},inductance:{validUnits:["nH","H","mH","H"],defaultUnit:"H"},impedance:{validUnits:["","m","k"],defaultUnit:""},capacity:{validUnits:["mAh","Ah"],defaultUnit:"mAh"},inputVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},outputVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},coilVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},primaryVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},secondaryVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},esr:{validUnits:["m",""],defaultUnit:""}};function Xi(r){return e2[r]?.validUnits||[]}function Wt(r){return e2[r]?.defaultUnit||""}function yc(r){return r.includes(" ")?r:r.replace(/([a-z])([A-Z])/g,"$1 $2")}const Ha=Math.PI*2;function t2(r){return(r%360+360)%360}function Kd(r){return r*Math.PI/180}function Zw(r){return r*180/Math.PI}function Om(r,e){return t2(r+e)}function Yg(r){return Math.tan(r)}function Jw(r){return Math.cos(r)}function Qw(r){return Math.sin(r)}function e5(r,e){return Math.atan2(r,e)}function t5(r,e){return Zw(e5(e,r))}function Fm(r,e){const{x:t,y:n,rotation:s=0,scale:o=1,flipX:d=!1,flipY:c=!1,skewX:h=0,skewY:f=0}=e;if(r.translate(t,n),s!==0&&r.rotate(Kd(s)),h!==0||f!==0){const A=Yg(h),v=Yg(f);r.transform(1,v,A,1,0,0)}const m=o*(d?-1:1),b=o*(c?-1:1);(m!==1||b!==1)&&r.scale(m,b)}function ix(r,e,t,n=0,s=!1,o=!1){Fm(r,{x:e,y:t,rotation:n,flipX:s,flipY:o})}function n2(r,e,t){const n=Kd(t),s=Jw(n),o=Qw(n);return{x:r*s-e*o,y:r*o+e*s}}function n5(r,e=0,t=!1){t&&r.scale(-1,1),e!==0&&r.rotate(Kd(e))}function i5(r,e=0,t=!1){const n=t2(e),s=n===90||n===270;t&&r.scale(-1,1),e!==0&&r.rotate(Kd(-e)),t&&s&&r.rotate(Kd(180))}function sx(r,e,t,n=0,s=!1){let o=r/t,d=e/t;if(n!==0){const c=n2(o,d,-n);o=c.x,d=c.y}return s&&(o=-o),{x:o,y:d}}function Qf(r,e,t,n,s=0,o=!1){let d=r-t.x,c=e-t.y;if(d=d/n,c=c/n,o&&(d=-d),s!==0){const h=n2(d,c,-s);d=h.x,c=h.y}return{x:d,y:c}}function s5(r,e=.4){if(r.startsWith("#")){const n=r.slice(1),s=parseInt(n.slice(0,2),16),o=parseInt(n.slice(2,4),16),d=parseInt(n.slice(4,6),16),c=Math.max(0,Math.floor(s*(1-e))),h=Math.max(0,Math.floor(o*(1-e))),f=Math.max(0,Math.floor(d*(1-e)));return`#${c.toString(16).padStart(2,"0")}${h.toString(16).padStart(2,"0")}${f.toString(16).padStart(2,"0")}`}const t=r.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*[\d.]+)?\)/);if(t){const n=parseInt(t[1],10),s=parseInt(t[2],10),o=parseInt(t[3],10),d=t[4]?t[4].trim():"",c=Math.max(0,Math.floor(n*(1-e))),h=Math.max(0,Math.floor(s*(1-e))),f=Math.max(0,Math.floor(o*(1-e)));return r.includes("rgba")?`rgba(${c}, ${h}, ${f}${d?`, ${d}`:", 1"})`:`rgb(${c}, ${h}, ${f})`}return r}let wl=1;const Oc=new Set;function Xc(){const r=wl;if(wl++,Oc.has(r)){for(console.error(`CRITICAL ERROR: Duplicate Node ID ${r} would be allocated!`),console.error(`Current counter: ${wl}, Allocated IDs count: ${Oc.size}`);Oc.has(wl);)wl++;const e=wl;return wl++,Oc.add(e),console.error(`Recovered by allocating ID ${e} instead`),e}return Oc.add(r),r}function xg(r){r<1&&(console.warn(`setPointIdCounter called with invalid value ${r}, using 1`),r=1),wl=r,Oc.clear()}function im(){return wl}function rx(){wl=1,Oc.clear()}function sm(r){r>0&&(Oc.add(r),r>=wl&&(wl=r+1))}function bg(r){if(r>0&&Oc.has(r))if(Oc.delete(r),Oc.size>0){const e=Math.max(...Array.from(Oc));e<wl&&(wl=Math.max(1,e+1))}else wl=1}function r5(r="id"){return`${r}-${Date.now()}-${Math.random().toString(36).slice(2,11)}`}function ax(r){return Math.round(r*1e4)/1e4}function is(r){return{x:ax(r.x),y:ax(r.y)}}const Du=i0.components;Du.map(r=>({designator:r.designator,componentType:r.description}));function _d(r){if(!r)return;const e=r.componentDefinitionKey;if(e){const n=Du.find(s=>`${s.category}:${s.subcategory}:${s.type}`===e);if(n)return n}if(typeof r.designator=="string"&&r.designator.trim()!==""){const n=r.designator.trim().match(/^[A-Za-z]+/),s=n?n[0]:null;if(s){const o=Du.find(d=>Array.isArray(d.designators)&&d.designators.includes(s));if(o)return o}}const t=r.componentType==="Electrolytic Capacitor"||r.componentType==="Film Capacitor"?"Capacitor":r.componentType;return Du.find(n=>{if(n.type!==t)return!1;if(n.category==="Capacitors"){const s=r.capacitorType||r.dielectric;return!!(s&&n.properties?.capacitorType===s||!s)}if(n.category==="Diodes"){const s=r.diodeType;return!!(s&&n.properties?.diodeType===s||!n.properties?.diodeType)}if(n.category==="Resistors"){const s=r.resistorType,o=r.vrType;return!!(s&&n.properties?.resistorType===s||o&&n.properties?.vrType===o||!n.properties?.resistorType&&!n.properties?.vrType)}if(n.category==="Semiconductors"){const s=r.semiconductorType;return!!(s&&n.properties?.semiconductorType===s||!n.properties?.semiconductorType)}if(n.category==="Passive Components"){const s=r.passiveType;return!!(s&&n.properties?.passiveType===s||!n.properties?.passiveType)}if(n.category==="Power & Energy"){const s=r.powerType;return!!(s&&n.properties?.powerType===s||!n.properties?.powerType)}if(n.category==="Connectors & Switches"){const s=r.connectorType,o=r.switchType;return!!(s&&n.properties?.connectorType===s||o&&n.properties?.switchType===o||!n.properties?.connectorType&&!n.properties?.switchType)}if(r.componentType==="GenericComponent"){const s=r.genericType;return!!(s&&n.subtype===s)}return!0})}function a5(r){return(gy[r]?.prefix||["?"])[0]}function Sp(r){return _d(r)?.properties?.polarized===!0}function Um(r,e,t){if(!Sp(r)||r.pinCount!==2||!(e.length===2&&e[0]&&e[0].trim()!==""&&e[1]&&e[1].trim()!==""))return null;const s=m=>{const b=parseInt(m,10);if(isNaN(b))return null;for(const A of t)if((A.type==="via"||A.type==="pad")&&A.points.length>0){const v=A.points[0];if(v.id===b)return{x:v.x,y:v.y}}return null},o=s(e[0]),d=s(e[1]);if(!o||!d)return null;const c=Math.hypot(r.x-o.x,r.y-o.y),h=Math.hypot(r.x-d.x,r.y-d.y),f=["",""];return c<h?(f[0]="-",f[1]="+"):(f[0]="+",f[1]="-"),f}function rm(){return{}}function o5(r){}function l5(r,e,t){const n={...t};return n[r]=Math.max(n[r]||0,e),n}function c5(r){if(r.designator&&r.designator.trim()!=="")return r.designator.trim();switch(r.baseType){case"Capacitor":return"C";case"Diode":return"D";case"Resistor":return"R";case"Semiconductor":return"Q";case"Passive":return"L";case"PowerEnergy":return"PS";case"Connector":return"J";case"Switch":return"S";case"Transformer":return"T";case"Other":default:return"?"}}function d5(r,e,t){let n=0;for(const d of e){if(!d.designator||!d.designator.startsWith(r))continue;const c=parseInt(d.designator.slice(r.length),10);!isNaN(c)&&c>n&&(n=c)}const o=(t[r]??n)+1;return t[r]=o,o}function u5(r,e,t){const n=c5(r),s=d5(n,e,t);return`${n}${s}`}function h5(r){const{definition:e,layer:t,x:n,y:s,color:o,size:d,designator:c,existingComponents:h=[],counters:f={}}=r,m=d&&d>0?d:py.DEFAULT_SIZE,b=c||u5(e,h,f),A={id:r5("comp"),componentType:e.type,designator:b,layer:t,x:n,y:s,color:o,size:m,pinCount:e.defaultPins,pinConnections:new Array(e.defaultPins).fill(""),pinPolarities:void 0,notes:null,orientation:0,flipX:!1,flipY:!1,description:e.description};if(A.componentDefinitionKey=e.key,e.properties&&Object.assign(A,e.properties),e.properties?.pinNames&&Array.isArray(e.properties.pinNames)){const v=e.properties.pinNames;v.includes("CHIP_DEPENDENT")?A.pinNames=new Array(A.pinCount).fill(""):A.pinNames=new Array(A.pinCount).fill("").map((x,k)=>k<v.length?v[k]:"")}return e.fields&&e.fields.length>0&&e.fields.forEach(v=>{v.defaultValue!==void 0&&v.defaultValue!==""&&(A[v.name]=v.defaultValue),v.units&&v.defaultUnit&&(A[`${v.name}Unit`]=v.defaultUnit)}),A}function f5(){const r=document.createElement("canvas"),e=24;r.width=e,r.height=e;const t=r.getContext("2d");t.strokeStyle="#000",t.lineWidth=3,t.lineCap="round";const n=e/2,s=8;return t.beginPath(),t.moveTo(n,n-s),t.lineTo(n,n-2),t.moveTo(n,n+2),t.lineTo(n,n+s),t.moveTo(n-s,n),t.lineTo(n-2,n),t.moveTo(n+2,n),t.lineTo(n+s,n),t.stroke(),`url(${r.toDataURL()}) ${n} ${n}, crosshair`}function p5(r){const e=document.createElement("canvas"),t=Math.max(12,Math.min(r,32)),s=t+4*2;e.width=s,e.height=s;const o=e.getContext("2d"),d=s/2,c=s/2,h=t/2;return o.fillStyle="#FFFF00",o.strokeStyle="#000000",o.lineWidth=2,o.beginPath(),o.moveTo(d,c-h),o.lineTo(d+h,c),o.lineTo(d,c+h),o.lineTo(d-h,c),o.closePath(),o.fill(),o.stroke(),`url(${e.toDataURL()}) ${d} ${c}, crosshair`}function ox(){const r=new Date,e=r.getFullYear(),t=String(r.getMonth()+1).padStart(2,"0"),n=String(r.getDate()).padStart(2,"0"),s=String(r.getHours()).padStart(2,"0"),o=String(r.getMinutes()).padStart(2,"0"),d=String(r.getSeconds()).padStart(2,"0");return`${e}_${t}_${n}-${s}-${o}-${d}`}function Qu(r){let e=r.replace(/\.json$/i,""),t="";for(;t!==e;)t=e,e=e.replace(/_\d{4}_\d{2}_\d{2}-\d{2}-\d{2}-\d{2}$/,""),e=e.replace(/_\d{4}_\d{2}_\d{2}_\d{2}_\d{2}_\d{2}$/,"");return e}function ci(r,e,t,n){if(e==="power"){const o=r[e]||"";return typeof o=="string"&&o.trim()!==""?{value:o.replace(/W$/i,"").trim(),unit:"W"}:{value:"",unit:"W"}}if(r[e]!==void 0||r[t]!==void 0)return{value:r[e]||"",unit:r[t]||n};const s=r[e]||"";return typeof s=="string"&&s.trim()!==""?i2(s):{value:"",unit:n}}function i2(r){if(!r||r.trim()==="")return{value:"",unit:""};const e=r.trim(),t=e.match(/^([\d]+\/[\d]+)\s*([a-zA-ZuW]+)?$/);if(t)return{value:t[1],unit:t[2]||""};const n=e.match(/^([\d.]+)\s*([a-zA-ZuW]+)?$/);return n?{value:n[1],unit:n[2]||""}:{value:e,unit:""}}function eh(r,e){return!r||r.trim()===""?"":!e||e.trim()===""?r.trim():`${r.trim()}${e.trim()}`}function g5(){const[r,e]=K.useState([]),[t,n]=K.useState([]),[s,o]=K.useState(null),[d,c]=K.useState(null),[h,f]=K.useState(null),[m,b]=K.useState(!1),[A,v]=K.useState(null),E=K.useCallback((z,B)=>{B==="top"?e(F=>[...F,z]):n(F=>[...F,z])},[]),x=K.useCallback((z,B,F)=>{F==="top"?e(I=>I.map(X=>X.id===z?{...X,...B}:X)):n(I=>I.map(X=>X.id===z?{...X,...B}:X))},[]),k=K.useCallback((z,B)=>{B==="top"?e(F=>F.filter(I=>I.id!==z)):n(F=>F.filter(I=>I.id!==z))},[]),j=K.useCallback((z,B)=>{const F=z.designator||"",I=z.abbreviation||(F.length>0?F.charAt(0).toUpperCase():""),X=z.componentType,M={visible:!0,layer:B,id:z.id,designator:F,abbreviation:I,manufacturer:"manufacturer"in z&&z.manufacturer||"",partNumber:"partNumber"in z&&z.partNumber||"",pinCount:z.pinCount,x:z.x,y:z.y,orientation:z.orientation??0,description:z.description||"",datasheet:z.datasheet||"",componentDefinitionKey:z.componentDefinitionKey||""};if(X==="Resistor"){const U=z,_=ci(U,"resistance","resistanceUnit",Wt("resistance"));M.resistance=_.value,M.resistanceUnit=_.unit;const N=ci(U,"power","powerUnit","W");M.power=N.value||"1/4",M.tolerance=U.tolerance||"5%"}else if(X==="Capacitor"){const U=z,_=ci(U,"capacitance","capacitanceUnit",Wt("capacitance"));M.capacitance=_.value,M.capacitanceUnit=_.unit;const N=ci(U,"voltage","voltageUnit",Wt("voltage"));M.voltage=N.value,M.voltageUnit=N.unit,M.tolerance=U.tolerance||"10%",M.dielectric=U.dielectric||"Ceramic"}else if(X==="Electrolytic Capacitor"){const U=z,_=ci(U,"capacitance","capacitanceUnit",Wt("capacitance"));M.capacitance=_.value,M.capacitanceUnit=_.unit;const N=ci(U,"voltage","voltageUnit",Wt("voltage"));M.voltage=N.value,M.voltageUnit=N.unit,M.tolerance=U.tolerance||"20%",M.polarized=U.polarized!==void 0?U.polarized:!0;const te=ci(U,"esr","esrUnit",Wt("esr"));M.esr=te.value,M.esrUnit=te.unit,M.temperature=U.temperature||""}else if(X==="Film Capacitor"){const U=z,_=ci(U,"capacitance","capacitanceUnit",Wt("capacitance"));M.capacitance=_.value,M.capacitanceUnit=_.unit;const N=ci(U,"voltage","voltageUnit",Wt("voltage"));M.voltage=N.value,M.voltageUnit=N.unit,M.tolerance=U.tolerance||"10%",M.filmType=U.filmType||"Polyester"}else if(X==="Diode"){const U=z;M.diodeType=U.diodeType||"Standard";const _=ci(U,"voltage","voltageUnit",Wt("voltage"));M.voltage=_.value,M.voltageUnit=_.unit;const N=ci(U,"current","currentUnit",Wt("current"));M.current=N.value,M.currentUnit=N.unit,M.ledColor=U.ledColor||""}else if(X==="Battery"){const U=z,_=ci(U,"voltage","voltageUnit",Wt("voltage"));M.voltage=_.value,M.voltageUnit=_.unit;const N=ci(U,"capacity","capacityUnit",Wt("capacity"));M.capacity=N.value,M.capacityUnit=N.unit,M.chemistry=U.chemistry||"Li-ion"}else if(X==="Fuse"){const U=z,_=ci(U,"current","currentUnit",Wt("current"));M.current=_.value,M.currentUnit=_.unit;const N=ci(U,"voltage","voltageUnit",Wt("voltage"));M.voltage=N.value,M.voltageUnit=N.unit,M.fuseType=U.fuseType||"Fast-blow"}else if(X==="FerriteBead"){const U=z,_=ci(U,"impedance","impedanceUnit",Wt("impedance"));M.impedance=_.value,M.impedanceUnit=_.unit;const N=ci(U,"current","currentUnit",Wt("current"));M.current=N.value,M.currentUnit=N.unit}else if(X==="Connector"){const U=z;M.connectorType=U.connectorType||"",M.gender=U.gender||"N/A"}else if(X==="Jumper"){const U=z;M.positions=U.positions||3}else if(X==="Relay"){const U=z,_=ci(U,"coilVoltage","coilVoltageUnit",Wt("coilVoltage"));M.coilVoltage=_.value,M.coilVoltageUnit=_.unit,M.contactType=U.contactType||"SPST";const N=ci(U,"current","currentUnit",Wt("current"));M.current=N.value,M.currentUnit=N.unit}else if(X==="Inductor"){const U=z,_=ci(U,"inductance","inductanceUnit",Wt("inductance"));M.inductance=_.value,M.inductanceUnit=_.unit;const N=ci(U,"current","currentUnit",Wt("current"));M.current=N.value,M.currentUnit=N.unit;const te=ci(U,"resistance","resistanceUnit",Wt("resistance"));M.resistance=te.value,M.resistanceUnit=te.unit}else if(X==="Speaker"){const U=z,_=ci(U,"impedance","impedanceUnit",Wt("impedance"));M.impedance=_.value,M.impedanceUnit=_.unit;const N=ci(U,"power","powerUnit","W");M.power=N.value||"1"}else if(X==="Motor"){const U=z;M.motorType=U.motorType||"DC";const _=ci(U,"voltage","voltageUnit",Wt("voltage"));M.voltage=_.value,M.voltageUnit=_.unit;const N=ci(U,"current","currentUnit",Wt("current"));M.current=N.value,M.currentUnit=N.unit}else if(X==="PowerSupply"){const U=z,_=ci(U,"inputVoltage","inputVoltageUnit",Wt("inputVoltage"));M.inputVoltage=_.value,M.inputVoltageUnit=_.unit;const N=ci(U,"outputVoltage","outputVoltageUnit",Wt("outputVoltage"));M.outputVoltage=N.value,M.outputVoltageUnit=N.unit;const te=ci(U,"current","currentUnit",Wt("current"));M.current=te.value,M.currentUnit=te.unit}else if(X==="Transistor"){const U=z;M.transistorType=U.transistorType||"BJT",M.polarity=U.polarity||"NPN";const _=ci(U,"voltage","voltageUnit",Wt("voltage"));M.voltage=_.value,M.voltageUnit=_.unit;const N=ci(U,"current","currentUnit",Wt("current"));M.current=N.value,M.currentUnit=N.unit}else if(X==="ResistorNetwork"){const U=z,_=ci(U,"resistance","resistanceUnit",Wt("resistance"));M.resistance=_.value,M.resistanceUnit=_.unit,M.configuration=U.configuration||""}else if(X==="Thermistor"){const U=z,_=ci(U,"resistance","resistanceUnit",Wt("resistance"));M.resistance=_.value,M.resistanceUnit=_.unit,M.thermistorType=U.thermistorType||"NTC",M.beta=U.beta||""}else if(X==="Switch"){const U=z;M.switchType=U.switchType||"Toggle";const _=ci(U,"current","currentUnit",Wt("current"));M.current=_.value,M.currentUnit=_.unit;const N=ci(U,"voltage","voltageUnit",Wt("voltage"));M.voltage=N.value,M.voltageUnit=N.unit}else if(X==="Transformer"){const U=z,_=ci(U,"primaryVoltage","primaryVoltageUnit",Wt("primaryVoltage"));M.primaryVoltage=_.value,M.primaryVoltageUnit=_.unit;const N=ci(U,"secondaryVoltage","secondaryVoltageUnit",Wt("secondaryVoltage"));M.secondaryVoltage=N.value,M.secondaryVoltageUnit=N.unit;const te=ci(U,"power","powerUnit",Wt("power"));M.power=te.value||"1",M.turns=U.turns||""}else if(X==="TestPoint"){const U=z;M.signal=U.signal||""}else if(X==="IntegratedCircuit"||X==="Semiconductor"){const U=z;M.description=U.description||z.designator||"",M.datasheet=U.datasheet||"",console.log("[useComponents] Loading IC component - datasheet from component:",U.datasheet,"editor datasheet:",M.datasheet),M.icType=U.icType||"Op-Amp"}else if(X==="VacuumTube"){const U=z;M.tubeType=U.tubeType||""}else if(X==="VariableResistor"){const U=z;M.vrType=U.vrType||"Potentiometer";const _=ci(U,"resistance","resistanceUnit",Wt("resistance"));M.resistance=_.value,M.resistanceUnit=_.unit;const N=ci(U,"power","powerUnit",Wt("power"));M.power=N.value||"1/4",M.taper=U.taper||""}else if(X==="Crystal"){const U=z;M.frequency=U.frequency||"",M.loadCapacitance=U.loadCapacitance||"",M.tolerance=U.tolerance||""}else if(X==="Diode"){const U=z;M.diodeType=U.diodeType||"Standard";const _=ci(U,"voltage","voltageUnit",Wt("voltage"));M.voltage=_.value,M.voltageUnit=_.unit;const N=ci(U,"current","currentUnit",Wt("current"));M.current=N.value,M.currentUnit=N.unit,M.ledColor=U.ledColor||""}else if(X==="GenericComponent"){const U=z;M.genericType=U.genericType||"Attenuator";const _=ci(U,"voltage","voltageUnit",Wt("voltage"));M.voltage=_.value,M.voltageUnit=_.unit;const N=ci(U,"current","currentUnit",Wt("current"));M.current=N.value,M.currentUnit=N.unit,M.power=U.power||"",M.frequency=U.frequency||"",M.model=U.model||""}const G=z.componentDefinitionKey;if(G){const U=Du.find(_=>`${_.category}:${_.subcategory}:${_.type}`===G);U&&(M.componentDefinition=U,M.componentDefinitionKey=G)}o(M)},[]),$=K.useCallback(()=>{o(null),c(null)},[]);return{componentsTop:r,setComponentsTop:e,componentsBottom:t,setComponentsBottom:n,componentEditor:s,setComponentEditor:o,connectingPin:d,setConnectingPin:c,componentDialogPosition:h,setComponentDialogPosition:f,isDraggingDialog:m,setIsDraggingDialog:b,dialogDragOffset:A,setDialogDragOffset:v,addComponent:E,updateComponent:x,removeComponent:k,openComponentEditor:j,closeComponentEditor:$}}function th(r){return{resistance:"",capacitance:"F",inductance:"H",voltage:"V",current:"A",power:"W",impedance:"",capacity:"mAh",esr:"",coilVoltage:"V",inputVoltage:"V",outputVoltage:"V"}[r]||""}function nh(r,e,t,n){if(e==="power"){const o=r[e]||"";return typeof o=="string"&&o.trim()!==""?{value:o.replace(/W$/i,"").trim(),unit:"W"}:{value:"",unit:"W"}}if(r[e]!==void 0||r[t]!==void 0)return{value:r[e]||"",unit:r[t]||n};const s=r[e]||"";return typeof s=="string"&&s.trim()!==""?i2(s):{value:"",unit:n}}function m5(r){if((r.componentType==="Resistor"||r.componentType==="ResistorNetwork"||r.componentType==="Thermistor"||r.componentType==="VariableResistor")&&"resistance"in r){const{value:n,unit:s}=nh(r,"resistance","resistanceUnit",th("resistance"));if(n&&n.trim()!=="")return eh(n,s)}if((r.componentType==="Capacitor"||r.componentType==="Electrolytic Capacitor"||r.componentType==="Film Capacitor")&&"capacitance"in r){const{value:n,unit:s}=nh(r,"capacitance","capacitanceUnit",th("capacitance"));if(n&&n.trim()!=="")return eh(n,s)}if(r.componentType==="Inductor"&&"inductance"in r){const{value:n,unit:s}=nh(r,"inductance","inductanceUnit",th("inductance"));if(n&&n.trim()!=="")return eh(n,s)}if(r.componentType==="Fuse"&&"current"in r){const{value:n,unit:s}=nh(r,"current","currentUnit",th("current"));if(n&&n.trim()!=="")return eh(n,s)}if(r.componentType==="Battery"){const{value:n,unit:s}=nh(r,"capacity","capacityUnit",th("capacity"));if(n&&n.trim()!=="")return eh(n,s);const{value:o,unit:d}=nh(r,"voltage","voltageUnit",th("voltage"));if(o&&o.trim()!=="")return eh(o,d)}if(r.componentType==="PowerSupply"){const{value:n,unit:s}=nh(r,"outputVoltage","outputVoltageUnit",th("voltage"));if(n&&n.trim()!=="")return eh(n,s)}const e=r.partName?.trim();if(e&&e!=="")return e;const t=r.partNumber?.trim();return t&&t!==""?t:yc(r.componentType)}function y5(r,e,t){const n=[...r,...e],s=n.length,o=new Map;for(const c of n){const h=yc(c.componentType),f=m5(c),m=`${h}|${f}`;if(!o.has(m)){const A=r.some(x=>x.id===c.id),v=e.some(x=>x.id===c.id),E=A&&v?"both":A?"top":"bottom";o.set(m,{componentType:h,value:f,quantity:0,designators:[],packageType:c.packageType,manufacturer:c.manufacturer,partNumber:c.partNumber,description:c.description,notes:c.notes,datasheet:c.datasheet,layer:E})}const b=o.get(m);b.quantity++,c.designator&&c.designator.trim()!==""&&b.designators.push(c.designator.trim())}const d=Array.from(o.values()).sort((c,h)=>c.componentType!==h.componentType?c.componentType.localeCompare(h.componentType):c.value.localeCompare(h.value));return{version:"1.0",exportedAt:new Date().toISOString(),projectName:t,totalComponents:s,uniqueComponents:d.length,items:d}}const x5="modulepreload",b5=function(r){return"/PCB_Reverse_Engineering_Tool/"+r},lx={},am=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){let h=function(f){return Promise.all(f.map(m=>Promise.resolve(m).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),c=d?.nonce||d?.getAttribute("nonce");s=h(t.map(f=>{if(f=b5(f),f in lx)return;lx[f]=!0;const m=f.endsWith(".css"),b=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${b}`))return;const A=document.createElement("link");if(A.rel=m?"stylesheet":x5,m||(A.as="script"),A.crossOrigin="",A.href=f,c&&A.setAttribute("nonce",c),document.head.appendChild(A),m)return new Promise((v,E)=>{A.addEventListener("load",v),A.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${f}`)))})}))}function o(d){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=d,window.dispatchEvent(c),!c.defaultPrevented)throw d}return s.then(d=>{for(const c of d||[])c.status==="rejected"&&o(c.reason);return e().catch(o)})};function Rs(r){"@babel/helpers - typeof";return Rs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rs(r)}var Jc=Uint8Array,xc=Uint16Array,my=Int32Array,yy=new Jc([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),xy=new Jc([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),cx=new Jc([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s2=function(r,e){for(var t=new xc(31),n=0;n<31;++n)t[n]=e+=1<<r[n-1];for(var s=new my(t[30]),n=1;n<30;++n)for(var o=t[n];o<t[n+1];++o)s[o]=o-t[n]<<5|n;return{b:t,r:s}},r2=s2(yy,2),v5=r2.b,Hm=r2.r;v5[28]=258,Hm[258]=28;var w5=s2(xy,0),dx=w5.r,qm=new xc(32768);for(var hr=0;hr<32768;++hr){var ju=(hr&43690)>>1|(hr&21845)<<1;ju=(ju&52428)>>2|(ju&13107)<<2,ju=(ju&61680)>>4|(ju&3855)<<4,qm[hr]=((ju&65280)>>8|(ju&255)<<8)>>1}var hp=(function(r,e,t){for(var n=r.length,s=0,o=new xc(e);s<n;++s)r[s]&&++o[r[s]-1];var d=new xc(e);for(s=1;s<e;++s)d[s]=d[s-1]+o[s-1]<<1;var c;if(t){c=new xc(1<<e);var h=15-e;for(s=0;s<n;++s)if(r[s])for(var f=s<<4|r[s],m=e-r[s],b=d[r[s]-1]++<<m,A=b|(1<<m)-1;b<=A;++b)c[qm[b]>>h]=f}else for(c=new xc(n),s=0;s<n;++s)r[s]&&(c[s]=qm[d[r[s]-1]++]>>15-r[s]);return c}),dh=new Jc(288);for(var hr=0;hr<144;++hr)dh[hr]=8;for(var hr=144;hr<256;++hr)dh[hr]=9;for(var hr=256;hr<280;++hr)dh[hr]=7;for(var hr=280;hr<288;++hr)dh[hr]=8;var Xg=new Jc(32);for(var hr=0;hr<32;++hr)Xg[hr]=5;var S5=hp(dh,9,0),A5=hp(Xg,5,0),a2=function(r){return(r+7)/8|0},T5=function(r,e,t){return(t==null||t>r.length)&&(t=r.length),new Jc(r.subarray(e,t))},Vd=function(r,e,t){t<<=e&7;var n=e/8|0;r[n]|=t,r[n+1]|=t>>8},ep=function(r,e,t){t<<=e&7;var n=e/8|0;r[n]|=t,r[n+1]|=t>>8,r[n+2]|=t>>16},om=function(r,e){for(var t=[],n=0;n<r.length;++n)r[n]&&t.push({s:n,f:r[n]});var s=t.length,o=t.slice();if(!s)return{t:l2,l:0};if(s==1){var d=new Jc(t[0].s+1);return d[t[0].s]=1,{t:d,l:1}}t.sort(function(F,I){return F.f-I.f}),t.push({s:-1,f:25001});var c=t[0],h=t[1],f=0,m=1,b=2;for(t[0]={s:-1,f:c.f+h.f,l:c,r:h};m!=s-1;)c=t[t[f].f<t[b].f?f++:b++],h=t[f!=m&&t[f].f<t[b].f?f++:b++],t[m++]={s:-1,f:c.f+h.f,l:c,r:h};for(var A=o[0].s,n=1;n<s;++n)o[n].s>A&&(A=o[n].s);var v=new xc(A+1),E=Vm(t[m-1],v,0);if(E>e){var n=0,x=0,k=E-e,j=1<<k;for(o.sort(function(I,X){return v[X.s]-v[I.s]||I.f-X.f});n<s;++n){var $=o[n].s;if(v[$]>e)x+=j-(1<<E-v[$]),v[$]=e;else break}for(x>>=k;x>0;){var z=o[n].s;v[z]<e?x-=1<<e-v[z]++-1:++n}for(;n>=0&&x;--n){var B=o[n].s;v[B]==e&&(--v[B],++x)}E=e}return{t:new Jc(v),l:E}},Vm=function(r,e,t){return r.s==-1?Math.max(Vm(r.l,e,t+1),Vm(r.r,e,t+1)):e[r.s]=t},ux=function(r){for(var e=r.length;e&&!r[--e];);for(var t=new xc(++e),n=0,s=r[0],o=1,d=function(h){t[n++]=h},c=1;c<=e;++c)if(r[c]==s&&c!=e)++o;else{if(!s&&o>2){for(;o>138;o-=138)d(32754);o>2&&(d(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(d(s),--o;o>6;o-=6)d(8304);o>2&&(d(o-3<<5|8208),o=0)}for(;o--;)d(s);o=1,s=r[c]}return{c:t.subarray(0,n),n:e}},tp=function(r,e){for(var t=0,n=0;n<e.length;++n)t+=r[n]*e[n];return t},o2=function(r,e,t){var n=t.length,s=a2(e+2);r[s]=n&255,r[s+1]=n>>8,r[s+2]=r[s]^255,r[s+3]=r[s+1]^255;for(var o=0;o<n;++o)r[s+o+4]=t[o];return(s+4+n)*8},hx=function(r,e,t,n,s,o,d,c,h,f,m){Vd(e,m++,t),++s[256];for(var b=om(s,15),A=b.t,v=b.l,E=om(o,15),x=E.t,k=E.l,j=ux(A),$=j.c,z=j.n,B=ux(x),F=B.c,I=B.n,X=new xc(19),M=0;M<$.length;++M)++X[$[M]&31];for(var M=0;M<F.length;++M)++X[F[M]&31];for(var G=om(X,7),U=G.t,_=G.l,N=19;N>4&&!U[cx[N-1]];--N);var te=f+5<<3,ie=tp(s,dh)+tp(o,Xg)+d,re=tp(s,A)+tp(o,x)+d+14+3*N+tp(X,U)+2*X[16]+3*X[17]+7*X[18];if(h>=0&&te<=ie&&te<=re)return o2(e,m,r.subarray(h,h+f));var q,J,ce,_e;if(Vd(e,m,1+(re<ie)),m+=2,re<ie){q=hp(A,v,0),J=A,ce=hp(x,k,0),_e=x;var xe=hp(U,_,0);Vd(e,m,z-257),Vd(e,m+5,I-1),Vd(e,m+10,N-4),m+=14;for(var M=0;M<N;++M)Vd(e,m+3*M,U[cx[M]]);m+=3*N;for(var Z=[$,F],D=0;D<2;++D)for(var H=Z[D],M=0;M<H.length;++M){var Y=H[M]&31;Vd(e,m,xe[Y]),m+=U[Y],Y>15&&(Vd(e,m,H[M]>>5&127),m+=H[M]>>12)}}else q=S5,J=dh,ce=A5,_e=Xg;for(var M=0;M<c;++M){var ue=n[M];if(ue>255){var Y=ue>>18&31;ep(e,m,q[Y+257]),m+=J[Y+257],Y>7&&(Vd(e,m,ue>>23&31),m+=yy[Y]);var Ne=ue&31;ep(e,m,ce[Ne]),m+=_e[Ne],Ne>3&&(ep(e,m,ue>>5&8191),m+=xy[Ne])}else ep(e,m,q[ue]),m+=J[ue]}return ep(e,m,q[256]),m+J[256]},C5=new my([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),l2=new Jc(0),_5=function(r,e,t,n,s,o){var d=o.z||r.length,c=new Jc(n+d+5*(1+Math.ceil(d/7e3))+s),h=c.subarray(n,c.length-s),f=o.l,m=(o.r||0)&7;if(e){m&&(h[0]=o.r>>3);for(var b=C5[e-1],A=b>>13,v=b&8191,E=(1<<t)-1,x=o.p||new xc(32768),k=o.h||new xc(E+1),j=Math.ceil(t/3),$=2*j,z=function(Nt){return(r[Nt]^r[Nt+1]<<j^r[Nt+2]<<$)&E},B=new my(25e3),F=new xc(288),I=new xc(32),X=0,M=0,G=o.i||0,U=0,_=o.w||0,N=0;G+2<d;++G){var te=z(G),ie=G&32767,re=k[te];if(x[ie]=re,k[te]=ie,_<=G){var q=d-G;if((X>7e3||U>24576)&&(q>423||!f)){m=hx(r,h,0,B,F,I,M,U,N,G-N,m),U=X=M=0,N=G;for(var J=0;J<286;++J)F[J]=0;for(var J=0;J<30;++J)I[J]=0}var ce=2,_e=0,xe=v,Z=ie-re&32767;if(q>2&&te==z(G-Z))for(var D=Math.min(A,q)-1,H=Math.min(32767,G),Y=Math.min(258,q);Z<=H&&--xe&&ie!=re;){if(r[G+ce]==r[G+ce-Z]){for(var ue=0;ue<Y&&r[G+ue]==r[G+ue-Z];++ue);if(ue>ce){if(ce=ue,_e=Z,ue>D)break;for(var Ne=Math.min(Z,ue-2),Pe=0,J=0;J<Ne;++J){var Ue=G-Z+J&32767,Re=x[Ue],Ke=Ue-Re&32767;Ke>Pe&&(Pe=Ke,re=Ue)}}}ie=re,re=x[ie],Z+=ie-re&32767}if(_e){B[U++]=268435456|Hm[ce]<<18|dx[_e];var Je=Hm[ce]&31,st=dx[_e]&31;M+=yy[Je]+xy[st],++F[257+Je],++I[st],_=G+ce,++X}else B[U++]=r[G],++F[r[G]]}}for(G=Math.max(G,_);G<d;++G)B[U++]=r[G],++F[r[G]];m=hx(r,h,f,B,F,I,M,U,N,G-N,m),f||(o.r=m&7|h[m/8|0]<<3,m-=7,o.h=k,o.p=x,o.i=G,o.w=_)}else{for(var G=o.w||0;G<d+f;G+=65535){var yt=G+65535;yt>=d&&(h[m/8|0]=f,yt=d),m=o2(h,m+1,r.subarray(G,yt))}o.i=d}return T5(c,0,n+a2(m)+s)},c2=function(){var r=1,e=0;return{p:function(t){for(var n=r,s=e,o=t.length|0,d=0;d!=o;){for(var c=Math.min(d+2655,o);d<c;++d)s+=n+=t[d];n=(n&65535)+15*(n>>16),s=(s&65535)+15*(s>>16)}r=n,e=s},d:function(){return r%=65521,e%=65521,(r&255)<<24|(r&65280)<<8|(e&255)<<8|e>>8}}},k5=function(r,e,t,n,s){if(!s&&(s={l:1},e.dictionary)){var o=e.dictionary.subarray(-32768),d=new Jc(o.length+r.length);d.set(o),d.set(r,o.length),r=d,s.w=o.length}return _5(r,e.level==null?6:e.level,e.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):20:12+e.mem,t,n,s)},d2=function(r,e,t){for(;t;++e)r[e]=t,t>>>=8},j5=function(r,e){var t=e.level,n=t==0?0:t<6?1:t==9?3:2;if(r[0]=120,r[1]=n<<6|(e.dictionary&&32),r[1]|=31-(r[0]<<8|r[1])%31,e.dictionary){var s=c2();s.p(e.dictionary),d2(r,2,s.d())}};function Wm(r,e){e||(e={});var t=c2();t.p(r);var n=k5(r,e,e.dictionary?6:2,4);return j5(n,e),d2(n,n.length-4,t.d()),n}var N5=typeof TextDecoder<"u"&&new TextDecoder,P5=0;try{N5.decode(l2,{stream:!0}),P5=1}catch{}function E5(r){if(Array.isArray(r))return r}function R5(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n,s,o,d,c=[],h=!0,f=!1;try{if(o=(t=t.call(r)).next,e!==0)for(;!(h=(n=o.call(t)).done)&&(c.push(n.value),c.length!==e);h=!0);}catch(m){f=!0,s=m}finally{try{if(!h&&t.return!=null&&(d=t.return(),Object(d)!==d))return}finally{if(f)throw s}}return c}}function fx(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function D5(r,e){if(r){if(typeof r=="string")return fx(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?fx(r,e):void 0}}function L5(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function px(r,e){return E5(r)||R5(r,e)||D5(r,e)||L5()}function gx(r,e="utf8"){return new TextDecoder(e).decode(r)}const M5=new TextEncoder;function z5(r){return M5.encode(r)}const I5=1024*8,B5=(()=>{const r=new Uint8Array(4),e=new Uint32Array(r.buffer);return!((e[0]=1)&r[0])})(),lm={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class by{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(e=I5,t={}){let n=!1;typeof e=="number"?e=new ArrayBuffer(e):(n=!0,this.lastWrittenByte=e.byteLength);const s=t.offset?t.offset>>>0:0,o=e.byteLength-s;let d=s;(ArrayBuffer.isView(e)||e instanceof by)&&(e.byteLength!==e.buffer.byteLength&&(d=e.byteOffset+s),e=e.buffer),n?this.lastWrittenByte=o:this.lastWrittenByte=0,this.buffer=e,this.length=o,this.byteLength=o,this.byteOffset=d,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,d,o),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const n=(this.offset+e)*2,s=new Uint8Array(n);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,t){const n=lm[t].BYTES_PER_ELEMENT*e,s=this.byteOffset+this.offset,o=this.buffer.slice(s,s+n);if(this.littleEndian===B5&&t!=="uint8"&&t!=="int8"){const c=new Uint8Array(this.buffer.slice(s,s+n));c.reverse();const h=new lm[t](c.buffer);return this.offset+=n,h.reverse(),h}const d=new lm[t](o);return this.offset+=n,d}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let t="";for(let n=0;n<e;n++)t+=this.readChar();return t}readUtf8(e=1){return gx(this.readBytes(e))}decodeText(e=1,t="utf8"){return gx(this.readBytes(e),t)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(e){return this.writeBytes(z5(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function wf(r){let e=r.length;for(;--e>=0;)r[e]=0}const O5=3,F5=258,u2=29,U5=256,H5=U5+1+u2,h2=30,q5=512,V5=new Array((H5+2)*2);wf(V5);const W5=new Array(h2*2);wf(W5);const $5=new Array(q5);wf($5);const G5=new Array(F5-O5+1);wf(G5);const Y5=new Array(u2);wf(Y5);const X5=new Array(h2);wf(X5);const K5=(r,e,t,n)=>{let s=r&65535|0,o=r>>>16&65535|0,d=0;for(;t!==0;){d=t>2e3?2e3:t,t-=d;do s=s+e[n++]|0,o=o+s|0;while(--d);s%=65521,o%=65521}return s|o<<16|0};var $m=K5;const Z5=()=>{let r,e=[];for(var t=0;t<256;t++){r=t;for(var n=0;n<8;n++)r=r&1?3988292384^r>>>1:r>>>1;e[t]=r}return e},J5=new Uint32Array(Z5()),Q5=(r,e,t,n)=>{const s=J5,o=n+t;r^=-1;for(let d=n;d<o;d++)r=r>>>8^s[(r^e[d])&255];return r^-1};var bd=Q5,Gm={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},f2={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const eS=(r,e)=>Object.prototype.hasOwnProperty.call(r,e);var tS=function(r){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const n in t)eS(t,n)&&(r[n]=t[n])}}return r},nS=r=>{let e=0;for(let n=0,s=r.length;n<s;n++)e+=r[n].length;const t=new Uint8Array(e);for(let n=0,s=0,o=r.length;n<o;n++){let d=r[n];t.set(d,s),s+=d.length}return t},p2={assign:tS,flattenChunks:nS};let g2=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{g2=!1}const gp=new Uint8Array(256);for(let r=0;r<256;r++)gp[r]=r>=252?6:r>=248?5:r>=240?4:r>=224?3:r>=192?2:1;gp[254]=gp[254]=1;var iS=r=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(r);let e,t,n,s,o,d=r.length,c=0;for(s=0;s<d;s++)t=r.charCodeAt(s),(t&64512)===55296&&s+1<d&&(n=r.charCodeAt(s+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),s++)),c+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(c),o=0,s=0;o<c;s++)t=r.charCodeAt(s),(t&64512)===55296&&s+1<d&&(n=r.charCodeAt(s+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),s++)),t<128?e[o++]=t:t<2048?(e[o++]=192|t>>>6,e[o++]=128|t&63):t<65536?(e[o++]=224|t>>>12,e[o++]=128|t>>>6&63,e[o++]=128|t&63):(e[o++]=240|t>>>18,e[o++]=128|t>>>12&63,e[o++]=128|t>>>6&63,e[o++]=128|t&63);return e};const sS=(r,e)=>{if(e<65534&&r.subarray&&g2)return String.fromCharCode.apply(null,r.length===e?r:r.subarray(0,e));let t="";for(let n=0;n<e;n++)t+=String.fromCharCode(r[n]);return t};var rS=(r,e)=>{const t=e||r.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(r.subarray(0,e));let n,s;const o=new Array(t*2);for(s=0,n=0;n<t;){let d=r[n++];if(d<128){o[s++]=d;continue}let c=gp[d];if(c>4){o[s++]=65533,n+=c-1;continue}for(d&=c===2?31:c===3?15:7;c>1&&n<t;)d=d<<6|r[n++]&63,c--;if(c>1){o[s++]=65533;continue}d<65536?o[s++]=d:(d-=65536,o[s++]=55296|d>>10&1023,o[s++]=56320|d&1023)}return sS(o,s)},aS=(r,e)=>{e=e||r.length,e>r.length&&(e=r.length);let t=e-1;for(;t>=0&&(r[t]&192)===128;)t--;return t<0||t===0?e:t+gp[r[t]]>e?t:e},Ym={string2buf:iS,buf2string:rS,utf8border:aS};function oS(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var lS=oS;const vg=16209,cS=16191;var dS=function(e,t){let n,s,o,d,c,h,f,m,b,A,v,E,x,k,j,$,z,B,F,I,X,M,G,U;const _=e.state;n=e.next_in,G=e.input,s=n+(e.avail_in-5),o=e.next_out,U=e.output,d=o-(t-e.avail_out),c=o+(e.avail_out-257),h=_.dmax,f=_.wsize,m=_.whave,b=_.wnext,A=_.window,v=_.hold,E=_.bits,x=_.lencode,k=_.distcode,j=(1<<_.lenbits)-1,$=(1<<_.distbits)-1;e:do{E<15&&(v+=G[n++]<<E,E+=8,v+=G[n++]<<E,E+=8),z=x[v&j];t:for(;;){if(B=z>>>24,v>>>=B,E-=B,B=z>>>16&255,B===0)U[o++]=z&65535;else if(B&16){F=z&65535,B&=15,B&&(E<B&&(v+=G[n++]<<E,E+=8),F+=v&(1<<B)-1,v>>>=B,E-=B),E<15&&(v+=G[n++]<<E,E+=8,v+=G[n++]<<E,E+=8),z=k[v&$];n:for(;;){if(B=z>>>24,v>>>=B,E-=B,B=z>>>16&255,B&16){if(I=z&65535,B&=15,E<B&&(v+=G[n++]<<E,E+=8,E<B&&(v+=G[n++]<<E,E+=8)),I+=v&(1<<B)-1,I>h){e.msg="invalid distance too far back",_.mode=vg;break e}if(v>>>=B,E-=B,B=o-d,I>B){if(B=I-B,B>m&&_.sane){e.msg="invalid distance too far back",_.mode=vg;break e}if(X=0,M=A,b===0){if(X+=f-B,B<F){F-=B;do U[o++]=A[X++];while(--B);X=o-I,M=U}}else if(b<B){if(X+=f+b-B,B-=b,B<F){F-=B;do U[o++]=A[X++];while(--B);if(X=0,b<F){B=b,F-=B;do U[o++]=A[X++];while(--B);X=o-I,M=U}}}else if(X+=b-B,B<F){F-=B;do U[o++]=A[X++];while(--B);X=o-I,M=U}for(;F>2;)U[o++]=M[X++],U[o++]=M[X++],U[o++]=M[X++],F-=3;F&&(U[o++]=M[X++],F>1&&(U[o++]=M[X++]))}else{X=o-I;do U[o++]=U[X++],U[o++]=U[X++],U[o++]=U[X++],F-=3;while(F>2);F&&(U[o++]=U[X++],F>1&&(U[o++]=U[X++]))}}else if((B&64)===0){z=k[(z&65535)+(v&(1<<B)-1)];continue n}else{e.msg="invalid distance code",_.mode=vg;break e}break}}else if((B&64)===0){z=x[(z&65535)+(v&(1<<B)-1)];continue t}else if(B&32){_.mode=cS;break e}else{e.msg="invalid literal/length code",_.mode=vg;break e}break}}while(n<s&&o<c);F=E>>3,n-=F,E-=F<<3,v&=(1<<E)-1,e.next_in=n,e.next_out=o,e.avail_in=n<s?5+(s-n):5-(n-s),e.avail_out=o<c?257+(c-o):257-(o-c),_.hold=v,_.bits=E};const Kh=15,mx=852,yx=592,xx=0,cm=1,bx=2,uS=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),hS=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),fS=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),pS=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),gS=(r,e,t,n,s,o,d,c)=>{const h=c.bits;let f=0,m=0,b=0,A=0,v=0,E=0,x=0,k=0,j=0,$=0,z,B,F,I,X,M=null,G;const U=new Uint16Array(Kh+1),_=new Uint16Array(Kh+1);let N=null,te,ie,re;for(f=0;f<=Kh;f++)U[f]=0;for(m=0;m<n;m++)U[e[t+m]]++;for(v=h,A=Kh;A>=1&&U[A]===0;A--);if(v>A&&(v=A),A===0)return s[o++]=1<<24|64<<16|0,s[o++]=1<<24|64<<16|0,c.bits=1,0;for(b=1;b<A&&U[b]===0;b++);for(v<b&&(v=b),k=1,f=1;f<=Kh;f++)if(k<<=1,k-=U[f],k<0)return-1;if(k>0&&(r===xx||A!==1))return-1;for(_[1]=0,f=1;f<Kh;f++)_[f+1]=_[f]+U[f];for(m=0;m<n;m++)e[t+m]!==0&&(d[_[e[t+m]]++]=m);if(r===xx?(M=N=d,G=20):r===cm?(M=uS,N=hS,G=257):(M=fS,N=pS,G=0),$=0,m=0,f=b,X=o,E=v,x=0,F=-1,j=1<<v,I=j-1,r===cm&&j>mx||r===bx&&j>yx)return 1;for(;;){te=f-x,d[m]+1<G?(ie=0,re=d[m]):d[m]>=G?(ie=N[d[m]-G],re=M[d[m]-G]):(ie=96,re=0),z=1<<f-x,B=1<<E,b=B;do B-=z,s[X+($>>x)+B]=te<<24|ie<<16|re|0;while(B!==0);for(z=1<<f-1;$&z;)z>>=1;if(z!==0?($&=z-1,$+=z):$=0,m++,--U[f]===0){if(f===A)break;f=e[t+d[m]]}if(f>v&&($&I)!==F){for(x===0&&(x=v),X+=b,E=f-x,k=1<<E;E+x<A&&(k-=U[E+x],!(k<=0));)E++,k<<=1;if(j+=1<<E,r===cm&&j>mx||r===bx&&j>yx)return 1;F=$&I,s[F]=v<<24|E<<16|X-o|0}}return $!==0&&(s[X+$]=f-x<<24|64<<16|0),c.bits=v,0};var fp=gS;const mS=0,m2=1,y2=2,{Z_FINISH:vx,Z_BLOCK:yS,Z_TREES:wg,Z_OK:uh,Z_STREAM_END:xS,Z_NEED_DICT:bS,Z_STREAM_ERROR:Fc,Z_DATA_ERROR:x2,Z_MEM_ERROR:b2,Z_BUF_ERROR:vS,Z_DEFLATED:wx}=f2,s0=16180,Sx=16181,Ax=16182,Tx=16183,Cx=16184,_x=16185,kx=16186,jx=16187,Nx=16188,Px=16189,Kg=16190,Wd=16191,dm=16192,Ex=16193,um=16194,Rx=16195,Dx=16196,Lx=16197,Mx=16198,Sg=16199,Ag=16200,zx=16201,Ix=16202,Bx=16203,Ox=16204,Fx=16205,hm=16206,Ux=16207,Hx=16208,wr=16209,v2=16210,w2=16211,wS=852,SS=592,AS=15,TS=AS,qx=r=>(r>>>24&255)+(r>>>8&65280)+((r&65280)<<8)+((r&255)<<24);function CS(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const ph=r=>{if(!r)return 1;const e=r.state;return!e||e.strm!==r||e.mode<s0||e.mode>w2?1:0},S2=r=>{if(ph(r))return Fc;const e=r.state;return r.total_in=r.total_out=e.total=0,r.msg="",e.wrap&&(r.adler=e.wrap&1),e.mode=s0,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(wS),e.distcode=e.distdyn=new Int32Array(SS),e.sane=1,e.back=-1,uh},A2=r=>{if(ph(r))return Fc;const e=r.state;return e.wsize=0,e.whave=0,e.wnext=0,S2(r)},T2=(r,e)=>{let t;if(ph(r))return Fc;const n=r.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Fc:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=t,n.wbits=e,A2(r))},C2=(r,e)=>{if(!r)return Fc;const t=new CS;r.state=t,t.strm=r,t.window=null,t.mode=s0;const n=T2(r,e);return n!==uh&&(r.state=null),n},_S=r=>C2(r,TS);let Vx=!0,fm,pm;const kS=r=>{if(Vx){fm=new Int32Array(512),pm=new Int32Array(32);let e=0;for(;e<144;)r.lens[e++]=8;for(;e<256;)r.lens[e++]=9;for(;e<280;)r.lens[e++]=7;for(;e<288;)r.lens[e++]=8;for(fp(m2,r.lens,0,288,fm,0,r.work,{bits:9}),e=0;e<32;)r.lens[e++]=5;fp(y2,r.lens,0,32,pm,0,r.work,{bits:5}),Vx=!1}r.lencode=fm,r.lenbits=9,r.distcode=pm,r.distbits=5},_2=(r,e,t,n)=>{let s;const o=r.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(e.subarray(t-o.wsize,t),0),o.wnext=0,o.whave=o.wsize):(s=o.wsize-o.wnext,s>n&&(s=n),o.window.set(e.subarray(t-n,t-n+s),o.wnext),n-=s,n?(o.window.set(e.subarray(t-n,t),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=s,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=s))),0},jS=(r,e)=>{let t,n,s,o,d,c,h,f,m,b,A,v,E,x,k=0,j,$,z,B,F,I,X,M;const G=new Uint8Array(4);let U,_;const N=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(ph(r)||!r.output||!r.input&&r.avail_in!==0)return Fc;t=r.state,t.mode===Wd&&(t.mode=dm),d=r.next_out,s=r.output,h=r.avail_out,o=r.next_in,n=r.input,c=r.avail_in,f=t.hold,m=t.bits,b=c,A=h,M=uh;e:for(;;)switch(t.mode){case s0:if(t.wrap===0){t.mode=dm;break}for(;m<16;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}if(t.wrap&2&&f===35615){t.wbits===0&&(t.wbits=15),t.check=0,G[0]=f&255,G[1]=f>>>8&255,t.check=bd(t.check,G,2,0),f=0,m=0,t.mode=Sx;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((f&255)<<8)+(f>>8))%31){r.msg="incorrect header check",t.mode=wr;break}if((f&15)!==wx){r.msg="unknown compression method",t.mode=wr;break}if(f>>>=4,m-=4,X=(f&15)+8,t.wbits===0&&(t.wbits=X),X>15||X>t.wbits){r.msg="invalid window size",t.mode=wr;break}t.dmax=1<<t.wbits,t.flags=0,r.adler=t.check=1,t.mode=f&512?Px:Wd,f=0,m=0;break;case Sx:for(;m<16;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}if(t.flags=f,(t.flags&255)!==wx){r.msg="unknown compression method",t.mode=wr;break}if(t.flags&57344){r.msg="unknown header flags set",t.mode=wr;break}t.head&&(t.head.text=f>>8&1),t.flags&512&&t.wrap&4&&(G[0]=f&255,G[1]=f>>>8&255,t.check=bd(t.check,G,2,0)),f=0,m=0,t.mode=Ax;case Ax:for(;m<32;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}t.head&&(t.head.time=f),t.flags&512&&t.wrap&4&&(G[0]=f&255,G[1]=f>>>8&255,G[2]=f>>>16&255,G[3]=f>>>24&255,t.check=bd(t.check,G,4,0)),f=0,m=0,t.mode=Tx;case Tx:for(;m<16;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}t.head&&(t.head.xflags=f&255,t.head.os=f>>8),t.flags&512&&t.wrap&4&&(G[0]=f&255,G[1]=f>>>8&255,t.check=bd(t.check,G,2,0)),f=0,m=0,t.mode=Cx;case Cx:if(t.flags&1024){for(;m<16;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}t.length=f,t.head&&(t.head.extra_len=f),t.flags&512&&t.wrap&4&&(G[0]=f&255,G[1]=f>>>8&255,t.check=bd(t.check,G,2,0)),f=0,m=0}else t.head&&(t.head.extra=null);t.mode=_x;case _x:if(t.flags&1024&&(v=t.length,v>c&&(v=c),v&&(t.head&&(X=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(n.subarray(o,o+v),X)),t.flags&512&&t.wrap&4&&(t.check=bd(t.check,n,v,o)),c-=v,o+=v,t.length-=v),t.length))break e;t.length=0,t.mode=kx;case kx:if(t.flags&2048){if(c===0)break e;v=0;do X=n[o+v++],t.head&&X&&t.length<65536&&(t.head.name+=String.fromCharCode(X));while(X&&v<c);if(t.flags&512&&t.wrap&4&&(t.check=bd(t.check,n,v,o)),c-=v,o+=v,X)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=jx;case jx:if(t.flags&4096){if(c===0)break e;v=0;do X=n[o+v++],t.head&&X&&t.length<65536&&(t.head.comment+=String.fromCharCode(X));while(X&&v<c);if(t.flags&512&&t.wrap&4&&(t.check=bd(t.check,n,v,o)),c-=v,o+=v,X)break e}else t.head&&(t.head.comment=null);t.mode=Nx;case Nx:if(t.flags&512){for(;m<16;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}if(t.wrap&4&&f!==(t.check&65535)){r.msg="header crc mismatch",t.mode=wr;break}f=0,m=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),r.adler=t.check=0,t.mode=Wd;break;case Px:for(;m<32;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}r.adler=t.check=qx(f),f=0,m=0,t.mode=Kg;case Kg:if(t.havedict===0)return r.next_out=d,r.avail_out=h,r.next_in=o,r.avail_in=c,t.hold=f,t.bits=m,bS;r.adler=t.check=1,t.mode=Wd;case Wd:if(e===yS||e===wg)break e;case dm:if(t.last){f>>>=m&7,m-=m&7,t.mode=hm;break}for(;m<3;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}switch(t.last=f&1,f>>>=1,m-=1,f&3){case 0:t.mode=Ex;break;case 1:if(kS(t),t.mode=Sg,e===wg){f>>>=2,m-=2;break e}break;case 2:t.mode=Dx;break;case 3:r.msg="invalid block type",t.mode=wr}f>>>=2,m-=2;break;case Ex:for(f>>>=m&7,m-=m&7;m<32;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}if((f&65535)!==(f>>>16^65535)){r.msg="invalid stored block lengths",t.mode=wr;break}if(t.length=f&65535,f=0,m=0,t.mode=um,e===wg)break e;case um:t.mode=Rx;case Rx:if(v=t.length,v){if(v>c&&(v=c),v>h&&(v=h),v===0)break e;s.set(n.subarray(o,o+v),d),c-=v,o+=v,h-=v,d+=v,t.length-=v;break}t.mode=Wd;break;case Dx:for(;m<14;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}if(t.nlen=(f&31)+257,f>>>=5,m-=5,t.ndist=(f&31)+1,f>>>=5,m-=5,t.ncode=(f&15)+4,f>>>=4,m-=4,t.nlen>286||t.ndist>30){r.msg="too many length or distance symbols",t.mode=wr;break}t.have=0,t.mode=Lx;case Lx:for(;t.have<t.ncode;){for(;m<3;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}t.lens[N[t.have++]]=f&7,f>>>=3,m-=3}for(;t.have<19;)t.lens[N[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,U={bits:t.lenbits},M=fp(mS,t.lens,0,19,t.lencode,0,t.work,U),t.lenbits=U.bits,M){r.msg="invalid code lengths set",t.mode=wr;break}t.have=0,t.mode=Mx;case Mx:for(;t.have<t.nlen+t.ndist;){for(;k=t.lencode[f&(1<<t.lenbits)-1],j=k>>>24,$=k>>>16&255,z=k&65535,!(j<=m);){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}if(z<16)f>>>=j,m-=j,t.lens[t.have++]=z;else{if(z===16){for(_=j+2;m<_;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}if(f>>>=j,m-=j,t.have===0){r.msg="invalid bit length repeat",t.mode=wr;break}X=t.lens[t.have-1],v=3+(f&3),f>>>=2,m-=2}else if(z===17){for(_=j+3;m<_;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}f>>>=j,m-=j,X=0,v=3+(f&7),f>>>=3,m-=3}else{for(_=j+7;m<_;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}f>>>=j,m-=j,X=0,v=11+(f&127),f>>>=7,m-=7}if(t.have+v>t.nlen+t.ndist){r.msg="invalid bit length repeat",t.mode=wr;break}for(;v--;)t.lens[t.have++]=X}}if(t.mode===wr)break;if(t.lens[256]===0){r.msg="invalid code -- missing end-of-block",t.mode=wr;break}if(t.lenbits=9,U={bits:t.lenbits},M=fp(m2,t.lens,0,t.nlen,t.lencode,0,t.work,U),t.lenbits=U.bits,M){r.msg="invalid literal/lengths set",t.mode=wr;break}if(t.distbits=6,t.distcode=t.distdyn,U={bits:t.distbits},M=fp(y2,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,U),t.distbits=U.bits,M){r.msg="invalid distances set",t.mode=wr;break}if(t.mode=Sg,e===wg)break e;case Sg:t.mode=Ag;case Ag:if(c>=6&&h>=258){r.next_out=d,r.avail_out=h,r.next_in=o,r.avail_in=c,t.hold=f,t.bits=m,dS(r,A),d=r.next_out,s=r.output,h=r.avail_out,o=r.next_in,n=r.input,c=r.avail_in,f=t.hold,m=t.bits,t.mode===Wd&&(t.back=-1);break}for(t.back=0;k=t.lencode[f&(1<<t.lenbits)-1],j=k>>>24,$=k>>>16&255,z=k&65535,!(j<=m);){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}if($&&($&240)===0){for(B=j,F=$,I=z;k=t.lencode[I+((f&(1<<B+F)-1)>>B)],j=k>>>24,$=k>>>16&255,z=k&65535,!(B+j<=m);){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}f>>>=B,m-=B,t.back+=B}if(f>>>=j,m-=j,t.back+=j,t.length=z,$===0){t.mode=Fx;break}if($&32){t.back=-1,t.mode=Wd;break}if($&64){r.msg="invalid literal/length code",t.mode=wr;break}t.extra=$&15,t.mode=zx;case zx:if(t.extra){for(_=t.extra;m<_;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}t.length+=f&(1<<t.extra)-1,f>>>=t.extra,m-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=Ix;case Ix:for(;k=t.distcode[f&(1<<t.distbits)-1],j=k>>>24,$=k>>>16&255,z=k&65535,!(j<=m);){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}if(($&240)===0){for(B=j,F=$,I=z;k=t.distcode[I+((f&(1<<B+F)-1)>>B)],j=k>>>24,$=k>>>16&255,z=k&65535,!(B+j<=m);){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}f>>>=B,m-=B,t.back+=B}if(f>>>=j,m-=j,t.back+=j,$&64){r.msg="invalid distance code",t.mode=wr;break}t.offset=z,t.extra=$&15,t.mode=Bx;case Bx:if(t.extra){for(_=t.extra;m<_;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}t.offset+=f&(1<<t.extra)-1,f>>>=t.extra,m-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){r.msg="invalid distance too far back",t.mode=wr;break}t.mode=Ox;case Ox:if(h===0)break e;if(v=A-h,t.offset>v){if(v=t.offset-v,v>t.whave&&t.sane){r.msg="invalid distance too far back",t.mode=wr;break}v>t.wnext?(v-=t.wnext,E=t.wsize-v):E=t.wnext-v,v>t.length&&(v=t.length),x=t.window}else x=s,E=d-t.offset,v=t.length;v>h&&(v=h),h-=v,t.length-=v;do s[d++]=x[E++];while(--v);t.length===0&&(t.mode=Ag);break;case Fx:if(h===0)break e;s[d++]=t.length,h--,t.mode=Ag;break;case hm:if(t.wrap){for(;m<32;){if(c===0)break e;c--,f|=n[o++]<<m,m+=8}if(A-=h,r.total_out+=A,t.total+=A,t.wrap&4&&A&&(r.adler=t.check=t.flags?bd(t.check,s,A,d-A):$m(t.check,s,A,d-A)),A=h,t.wrap&4&&(t.flags?f:qx(f))!==t.check){r.msg="incorrect data check",t.mode=wr;break}f=0,m=0}t.mode=Ux;case Ux:if(t.wrap&&t.flags){for(;m<32;){if(c===0)break e;c--,f+=n[o++]<<m,m+=8}if(t.wrap&4&&f!==(t.total&4294967295)){r.msg="incorrect length check",t.mode=wr;break}f=0,m=0}t.mode=Hx;case Hx:M=xS;break e;case wr:M=x2;break e;case v2:return b2;case w2:default:return Fc}return r.next_out=d,r.avail_out=h,r.next_in=o,r.avail_in=c,t.hold=f,t.bits=m,(t.wsize||A!==r.avail_out&&t.mode<wr&&(t.mode<hm||e!==vx))&&_2(r,r.output,r.next_out,A-r.avail_out),b-=r.avail_in,A-=r.avail_out,r.total_in+=b,r.total_out+=A,t.total+=A,t.wrap&4&&A&&(r.adler=t.check=t.flags?bd(t.check,s,A,r.next_out-A):$m(t.check,s,A,r.next_out-A)),r.data_type=t.bits+(t.last?64:0)+(t.mode===Wd?128:0)+(t.mode===Sg||t.mode===um?256:0),(b===0&&A===0||e===vx)&&M===uh&&(M=vS),M},NS=r=>{if(ph(r))return Fc;let e=r.state;return e.window&&(e.window=null),r.state=null,uh},PS=(r,e)=>{if(ph(r))return Fc;const t=r.state;return(t.wrap&2)===0?Fc:(t.head=e,e.done=!1,uh)},ES=(r,e)=>{const t=e.length;let n,s,o;return ph(r)||(n=r.state,n.wrap!==0&&n.mode!==Kg)?Fc:n.mode===Kg&&(s=1,s=$m(s,e,t,0),s!==n.check)?x2:(o=_2(r,e,t,t),o?(n.mode=v2,b2):(n.havedict=1,uh))};var RS=A2,DS=T2,LS=S2,MS=_S,zS=C2,IS=jS,BS=NS,OS=PS,FS=ES,US="pako inflate (from Nodeca project)",Yd={inflateReset:RS,inflateReset2:DS,inflateResetKeep:LS,inflateInit:MS,inflateInit2:zS,inflate:IS,inflateEnd:BS,inflateGetHeader:OS,inflateSetDictionary:FS,inflateInfo:US};function HS(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var qS=HS;const k2=Object.prototype.toString,{Z_NO_FLUSH:VS,Z_FINISH:WS,Z_OK:mp,Z_STREAM_END:gm,Z_NEED_DICT:mm,Z_STREAM_ERROR:$S,Z_DATA_ERROR:Wx,Z_MEM_ERROR:GS}=f2;function Ap(r){this.options=p2.assign({chunkSize:1024*64,windowBits:15,to:""},r||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(r&&r.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new lS,this.strm.avail_out=0;let t=Yd.inflateInit2(this.strm,e.windowBits);if(t!==mp)throw new Error(Gm[t]);if(this.header=new qS,Yd.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Ym.string2buf(e.dictionary):k2.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=Yd.inflateSetDictionary(this.strm,e.dictionary),t!==mp)))throw new Error(Gm[t])}Ap.prototype.push=function(r,e){const t=this.strm,n=this.options.chunkSize,s=this.options.dictionary;let o,d,c;if(this.ended)return!1;for(e===~~e?d=e:d=e===!0?WS:VS,k2.call(r)==="[object ArrayBuffer]"?t.input=new Uint8Array(r):t.input=r,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(n),t.next_out=0,t.avail_out=n),o=Yd.inflate(t,d),o===mm&&s&&(o=Yd.inflateSetDictionary(t,s),o===mp?o=Yd.inflate(t,d):o===Wx&&(o=mm));t.avail_in>0&&o===gm&&t.state.wrap>0&&r[t.next_in]!==0;)Yd.inflateReset(t),o=Yd.inflate(t,d);switch(o){case $S:case Wx:case mm:case GS:return this.onEnd(o),this.ended=!0,!1}if(c=t.avail_out,t.next_out&&(t.avail_out===0||o===gm))if(this.options.to==="string"){let h=Ym.utf8border(t.output,t.next_out),f=t.next_out-h,m=Ym.buf2string(t.output,h);t.next_out=f,t.avail_out=n-f,f&&t.output.set(t.output.subarray(h,h+f),0),this.onData(m)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(o===mp&&c===0)){if(o===gm)return o=Yd.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};Ap.prototype.onData=function(r){this.chunks.push(r)};Ap.prototype.onEnd=function(r){r===mp&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=p2.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};function YS(r,e){const t=new Ap(e);if(t.push(r),t.err)throw t.msg||Gm[t.err];return t.result}var XS=Ap,KS=YS,ZS={Inflate:XS,inflate:KS};const{Inflate:JS,inflate:QS}=ZS;var $x=JS,eA=QS;const j2=[];for(let r=0;r<256;r++){let e=r;for(let t=0;t<8;t++)e&1?e=3988292384^e>>>1:e=e>>>1;j2[r]=e}const Gx=4294967295;function tA(r,e,t){let n=r;for(let s=0;s<t;s++)n=j2[(n^e[s])&255]^n>>>8;return n}function nA(r,e){return(tA(Gx,r,e)^Gx)>>>0}function Yx(r,e,t){const n=r.readUint32(),s=nA(new Uint8Array(r.buffer,r.byteOffset+r.offset-e-4,e),e);if(s!==n)throw new Error(`CRC mismatch for chunk ${t}. Expected ${n}, found ${s}`)}function N2(r,e,t){for(let n=0;n<t;n++)e[n]=r[n]}function P2(r,e,t,n){let s=0;for(;s<n;s++)e[s]=r[s];for(;s<t;s++)e[s]=r[s]+e[s-n]&255}function E2(r,e,t,n){let s=0;if(t.length===0)for(;s<n;s++)e[s]=r[s];else for(;s<n;s++)e[s]=r[s]+t[s]&255}function R2(r,e,t,n,s){let o=0;if(t.length===0){for(;o<s;o++)e[o]=r[o];for(;o<n;o++)e[o]=r[o]+(e[o-s]>>1)&255}else{for(;o<s;o++)e[o]=r[o]+(t[o]>>1)&255;for(;o<n;o++)e[o]=r[o]+(e[o-s]+t[o]>>1)&255}}function D2(r,e,t,n,s){let o=0;if(t.length===0){for(;o<s;o++)e[o]=r[o];for(;o<n;o++)e[o]=r[o]+e[o-s]&255}else{for(;o<s;o++)e[o]=r[o]+t[o]&255;for(;o<n;o++)e[o]=r[o]+iA(e[o-s],t[o],t[o-s])&255}}function iA(r,e,t){const n=r+e-t,s=Math.abs(n-r),o=Math.abs(n-e),d=Math.abs(n-t);return s<=o&&s<=d?r:o<=d?e:t}function sA(r,e,t,n,s,o){switch(r){case 0:N2(e,t,s);break;case 1:P2(e,t,s,o);break;case 2:E2(e,t,n,s);break;case 3:R2(e,t,n,s,o);break;case 4:D2(e,t,n,s,o);break;default:throw new Error(`Unsupported filter: ${r}`)}}const rA=new Uint16Array([255]),aA=new Uint8Array(rA.buffer),oA=aA[0]===255;function lA(r){const{data:e,width:t,height:n,channels:s,depth:o}=r,d=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],c=Math.ceil(o/8)*s,h=new Uint8Array(n*t*c);let f=0;for(let m=0;m<7;m++){const b=d[m],A=Math.ceil((t-b.x)/b.xStep),v=Math.ceil((n-b.y)/b.yStep);if(A<=0||v<=0)continue;const E=A*c,x=new Uint8Array(E);for(let k=0;k<v;k++){const j=e[f++],$=e.subarray(f,f+E);f+=E;const z=new Uint8Array(E);sA(j,$,z,x,E,c),x.set(z);for(let B=0;B<A;B++){const F=b.x+B*b.xStep,I=b.y+k*b.yStep;if(!(F>=t||I>=n))for(let X=0;X<c;X++)h[(I*t+F)*c+X]=z[B*c+X]}}}if(o===16){const m=new Uint16Array(h.buffer);if(oA)for(let b=0;b<m.length;b++)m[b]=cA(m[b]);return m}else return h}function cA(r){return(r&255)<<8|r>>8&255}const dA=new Uint16Array([255]),uA=new Uint8Array(dA.buffer),hA=uA[0]===255,fA=new Uint8Array(0);function Xx(r){const{data:e,width:t,height:n,channels:s,depth:o}=r,d=Math.ceil(o/8)*s,c=Math.ceil(o/8*s*t),h=new Uint8Array(n*c);let f=fA,m=0,b,A;for(let v=0;v<n;v++){switch(b=e.subarray(m+1,m+1+c),A=h.subarray(v*c,(v+1)*c),e[m]){case 0:N2(b,A,c);break;case 1:P2(b,A,c,d);break;case 2:E2(b,A,f,c);break;case 3:R2(b,A,f,c,d);break;case 4:D2(b,A,f,c,d);break;default:throw new Error(`Unsupported filter: ${e[m]}`)}f=A,m+=c+1}if(o===16){const v=new Uint16Array(h.buffer);if(hA)for(let E=0;E<v.length;E++)v[E]=pA(v[E]);return v}else return h}function pA(r){return(r&255)<<8|r>>8&255}const Og=Uint8Array.of(137,80,78,71,13,10,26,10);function Kx(r){if(!gA(r.readBytes(Og.length)))throw new Error("wrong PNG signature")}function gA(r){if(r.length<Og.length)return!1;for(let e=0;e<Og.length;e++)if(r[e]!==Og[e])return!1;return!0}const mA="tEXt",yA=0,L2=new TextDecoder("latin1");function xA(r){if(vA(r),r.length===0||r.length>79)throw new Error("keyword length must be between 1 and 79")}const bA=/^[\u0000-\u00FF]*$/;function vA(r){if(!bA.test(r))throw new Error("invalid latin1 text")}function wA(r,e,t){const n=M2(e);r[n]=SA(e,t-n.length-1)}function M2(r){for(r.mark();r.readByte()!==yA;);const e=r.offset;r.reset();const t=L2.decode(r.readBytes(e-r.offset-1));return r.skip(1),xA(t),t}function SA(r,e){return L2.decode(r.readBytes(e))}const pc={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},ym={UNKNOWN:-1,DEFLATE:0},Zx={UNKNOWN:-1,ADAPTIVE:0},xm={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Tg={NONE:0,BACKGROUND:1,PREVIOUS:2},bm={SOURCE:0,OVER:1};class AA extends by{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(e,t={}){super(e);const{checkCrc:n=!1}=t;this._checkCrc=n,this._inflator=new $x,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=ym.UNKNOWN,this._filterMethod=Zx.UNKNOWN,this._interlaceMethod=xm.UNKNOWN,this._colorType=pc.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(Kx(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeChunk(e,t)}return this.decodeImage(),this._png}decodeApng(){for(Kx(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeApngChunk(e,t)}return this.decodeApngImage(),this._apng}decodeChunk(e,t){const n=this.offset;switch(t){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case mA:wA(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-n!==e)throw new Error(`Length mismatch while decoding chunk ${t}`);this._checkCrc?Yx(this,e+4,t):this.skip(4)}decodeApngChunk(e,t){const n=this.offset;switch(t!=="fdAT"&&t!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),t){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,t),this.offset=n+e;break}if(this.offset-n!==e)throw new Error(`Length mismatch while decoding chunk ${t}`);this._checkCrc?Yx(this,e+4,t):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=TA(this.readUint8());const t=this.readUint8();this._colorType=t;let n;switch(t){case pc.GREYSCALE:n=1;break;case pc.TRUECOLOUR:n=3;break;case pc.INDEXED_COLOUR:n=1;break;case pc.GREYSCALE_ALPHA:n=2;break;case pc.TRUECOLOUR_ALPHA:n=4;break;case pc.UNKNOWN:default:throw new Error(`Unknown color type: ${t}`)}if(this._png.channels=n,this._compressionMethod=this.readUint8(),this._compressionMethod!==ym.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const t=e/3;this._hasPalette=!0;const n=[];this._palette=n;for(let s=0;s<t;s++)n.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const t=e,n=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,n,t)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let t=e,n=this.offset+this.byteOffset;if(n+=4,t-=4,this._inflator.push(new Uint8Array(this.buffer,n,t)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case pc.GREYSCALE:case pc.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let t=0;t<e/2;t++)this._transparency[t]=this.readUint16();break}case pc.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let t=0;for(;t<e;t++){const n=this.readByte();this._palette[t].push(n)}for(;t<this._palette.length;t++)this._palette[t].push(255);break}case pc.UNKNOWN:case pc.GREYSCALE_ALPHA:case pc.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const t=M2(this),n=this.readUint8();if(n!==ym.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${n}`);const s=this.readBytes(e-t.length-2);this._png.iccEmbeddedProfile={name:t,profile:eA(s)}}decodepHYs(){const e=this.readUint32(),t=this.readUint32(),n=this.readByte();this._png.resolution={x:e,y:t,unit:n}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const t={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},n=this._frames.at(e);if(n){if(n.data=Xx({data:n.data,width:n.width,height:n.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),e===0||n.xOffset===0&&n.yOffset===0&&n.width===this._png.width&&n.height===this._png.height)t.data=n.data;else{const s=this._apng.frames.at(e-1);this.disposeFrame(n,s,t),this.addFrameDataToCanvas(t,n)}this._apng.frames.push(t)}}return this._apng}disposeFrame(e,t,n){switch(e.disposeOp){case Tg.NONE:break;case Tg.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let o=0;o<this._png.width;o++){const d=(s*e.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)n.data[d+c]=0}break;case Tg.PREVIOUS:n.data.set(t.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,t){const n=1<<this._png.depth,s=(o,d)=>{const c=((o+t.yOffset)*this._png.width+t.xOffset+d)*this._png.channels,h=(o*t.width+d)*this._png.channels;return{index:c,frameIndex:h}};switch(t.blendOp){case bm.SOURCE:for(let o=0;o<t.height;o++)for(let d=0;d<t.width;d++){const{index:c,frameIndex:h}=s(o,d);for(let f=0;f<this._png.channels;f++)e.data[c+f]=t.data[h+f]}break;case bm.OVER:for(let o=0;o<t.height;o++)for(let d=0;d<t.width;d++){const{index:c,frameIndex:h}=s(o,d);for(let f=0;f<this._png.channels;f++){const m=t.data[h+this._png.channels-1]/n,b=f%(this._png.channels-1)===0?1:t.data[h+f],A=Math.floor(m*b+(1-m)*e.data[c+f]);e.data[c+f]+=A}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==Zx.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===xm.NO_INTERLACE)this._png.data=Xx({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===xm.ADAM7)this._png.data=lA({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,t=this._frames.at(-1);t?t.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Tg.NONE,blendOp:bm.SOURCE,data:e}),this._inflator=new $x,this._writingDataChunks=!1}}function TA(r){if(r!==1&&r!==2&&r!==4&&r!==8&&r!==16)throw new Error(`invalid bit depth: ${r}`);return r}var Jx;(function(r){r[r.UNKNOWN=0]="UNKNOWN",r[r.METRE=1]="METRE"})(Jx||(Jx={}));function CA(r,e){return new AA(r,e).decode()}var Qn=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function vm(){Qn.console&&typeof Qn.console.log=="function"&&Qn.console.log.apply(Qn.console,arguments)}var Ys={log:vm,warn:function(r){Qn.console&&(typeof Qn.console.warn=="function"?Qn.console.warn.apply(Qn.console,arguments):vm.call(null,arguments))},error:function(r){Qn.console&&(typeof Qn.console.error=="function"?Qn.console.error.apply(Qn.console,arguments):vm(r))}};function wm(r,e,t){var n=new XMLHttpRequest;n.open("GET",r),n.responseType="blob",n.onload=function(){ih(n.response,e,t)},n.onerror=function(){Ys.error("could not download file")},n.send()}function Qx(r){var e=new XMLHttpRequest;e.open("HEAD",r,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Cg(r){try{r.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(e)}}var ih=Qn.saveAs||((typeof window>"u"?"undefined":Rs(window))!=="object"||window!==Qn?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(r,e,t){var n=Qn.URL||Qn.webkitURL,s=document.createElement("a");e=e||r.name||"download",s.download=e,s.rel="noopener",typeof r=="string"?(s.href=r,s.origin!==location.origin?Qx(s.href)?wm(r,e,t):Cg(s,s.target="_blank"):Cg(s)):(s.href=n.createObjectURL(r),setTimeout(function(){n.revokeObjectURL(s.href)},4e4),setTimeout(function(){Cg(s)},0))}:"msSaveOrOpenBlob"in navigator?function(r,e,t){if(e=e||r.name||"download",typeof r=="string")if(Qx(r))wm(r,e,t);else{var n=document.createElement("a");n.href=r,n.target="_blank",setTimeout(function(){Cg(n)})}else navigator.msSaveOrOpenBlob((function(s,o){return o===void 0?o={autoBom:!1}:Rs(o)!=="object"&&(Ys.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s})(r,t),e)}:function(r,e,t,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof r=="string")return wm(r,e,t);var s=r.type==="application/octet-stream",o=/constructor/i.test(Qn.HTMLElement)||Qn.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent);if((d||s&&o)&&(typeof FileReader>"u"?"undefined":Rs(FileReader))==="object"){var c=new FileReader;c.onloadend=function(){var m=c.result;m=d?m:m.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=m:location=m,n=null},c.readAsDataURL(r)}else{var h=Qn.URL||Qn.webkitURL,f=h.createObjectURL(r);n?n.location=f:location.href=f,n=null,setTimeout(function(){h.revokeObjectURL(f)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function z2(r){var e;r=r||"",this.ok=!1,r.charAt(0)=="#"&&(r=r.substr(1,6)),r={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[r=(r=r.replace(/ /g,"")).toLowerCase()]||r;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(c){return[parseInt(c[1]),parseInt(c[2]),parseInt(c[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(c){return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(c){return[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]}}],n=0;n<t.length;n++){var s=t[n].re,o=t[n].process,d=s.exec(r);d&&(e=o(d),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var c=this.r.toString(16),h=this.g.toString(16),f=this.b.toString(16);return c.length==1&&(c="0"+c),h.length==1&&(h="0"+h),f.length==1&&(f="0"+f),"#"+c+h+f}}var Fg=Qn.atob.bind(Qn),eb=Qn.btoa.bind(Qn);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Sm(r,e){var t=r[0],n=r[1],s=r[2],o=r[3];t=Xo(t,n,s,o,e[0],7,-680876936),o=Xo(o,t,n,s,e[1],12,-389564586),s=Xo(s,o,t,n,e[2],17,606105819),n=Xo(n,s,o,t,e[3],22,-1044525330),t=Xo(t,n,s,o,e[4],7,-176418897),o=Xo(o,t,n,s,e[5],12,1200080426),s=Xo(s,o,t,n,e[6],17,-1473231341),n=Xo(n,s,o,t,e[7],22,-45705983),t=Xo(t,n,s,o,e[8],7,1770035416),o=Xo(o,t,n,s,e[9],12,-1958414417),s=Xo(s,o,t,n,e[10],17,-42063),n=Xo(n,s,o,t,e[11],22,-1990404162),t=Xo(t,n,s,o,e[12],7,1804603682),o=Xo(o,t,n,s,e[13],12,-40341101),s=Xo(s,o,t,n,e[14],17,-1502002290),t=Ko(t,n=Xo(n,s,o,t,e[15],22,1236535329),s,o,e[1],5,-165796510),o=Ko(o,t,n,s,e[6],9,-1069501632),s=Ko(s,o,t,n,e[11],14,643717713),n=Ko(n,s,o,t,e[0],20,-373897302),t=Ko(t,n,s,o,e[5],5,-701558691),o=Ko(o,t,n,s,e[10],9,38016083),s=Ko(s,o,t,n,e[15],14,-660478335),n=Ko(n,s,o,t,e[4],20,-405537848),t=Ko(t,n,s,o,e[9],5,568446438),o=Ko(o,t,n,s,e[14],9,-1019803690),s=Ko(s,o,t,n,e[3],14,-187363961),n=Ko(n,s,o,t,e[8],20,1163531501),t=Ko(t,n,s,o,e[13],5,-1444681467),o=Ko(o,t,n,s,e[2],9,-51403784),s=Ko(s,o,t,n,e[7],14,1735328473),t=Zo(t,n=Ko(n,s,o,t,e[12],20,-1926607734),s,o,e[5],4,-378558),o=Zo(o,t,n,s,e[8],11,-2022574463),s=Zo(s,o,t,n,e[11],16,1839030562),n=Zo(n,s,o,t,e[14],23,-35309556),t=Zo(t,n,s,o,e[1],4,-1530992060),o=Zo(o,t,n,s,e[4],11,1272893353),s=Zo(s,o,t,n,e[7],16,-155497632),n=Zo(n,s,o,t,e[10],23,-1094730640),t=Zo(t,n,s,o,e[13],4,681279174),o=Zo(o,t,n,s,e[0],11,-358537222),s=Zo(s,o,t,n,e[3],16,-722521979),n=Zo(n,s,o,t,e[6],23,76029189),t=Zo(t,n,s,o,e[9],4,-640364487),o=Zo(o,t,n,s,e[12],11,-421815835),s=Zo(s,o,t,n,e[15],16,530742520),t=Jo(t,n=Zo(n,s,o,t,e[2],23,-995338651),s,o,e[0],6,-198630844),o=Jo(o,t,n,s,e[7],10,1126891415),s=Jo(s,o,t,n,e[14],15,-1416354905),n=Jo(n,s,o,t,e[5],21,-57434055),t=Jo(t,n,s,o,e[12],6,1700485571),o=Jo(o,t,n,s,e[3],10,-1894986606),s=Jo(s,o,t,n,e[10],15,-1051523),n=Jo(n,s,o,t,e[1],21,-2054922799),t=Jo(t,n,s,o,e[8],6,1873313359),o=Jo(o,t,n,s,e[15],10,-30611744),s=Jo(s,o,t,n,e[6],15,-1560198380),n=Jo(n,s,o,t,e[13],21,1309151649),t=Jo(t,n,s,o,e[4],6,-145523070),o=Jo(o,t,n,s,e[11],10,-1120210379),s=Jo(s,o,t,n,e[2],15,718787259),n=Jo(n,s,o,t,e[9],21,-343485551),r[0]=Ru(t,r[0]),r[1]=Ru(n,r[1]),r[2]=Ru(s,r[2]),r[3]=Ru(o,r[3])}function r0(r,e,t,n,s,o){return e=Ru(Ru(e,r),Ru(n,o)),Ru(e<<s|e>>>32-s,t)}function Xo(r,e,t,n,s,o,d){return r0(e&t|~e&n,r,e,s,o,d)}function Ko(r,e,t,n,s,o,d){return r0(e&n|t&~n,r,e,s,o,d)}function Zo(r,e,t,n,s,o,d){return r0(e^t^n,r,e,s,o,d)}function Jo(r,e,t,n,s,o,d){return r0(t^(e|~n),r,e,s,o,d)}function I2(r){var e,t=r.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=r.length;e+=64)Sm(n,_A(r.substring(e-64,e)));r=r.substring(e-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<r.length;e++)s[e>>2]|=r.charCodeAt(e)<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(Sm(n,s),e=0;e<16;e++)s[e]=0;return s[14]=8*t,Sm(n,s),n}function _A(r){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=r.charCodeAt(e)+(r.charCodeAt(e+1)<<8)+(r.charCodeAt(e+2)<<16)+(r.charCodeAt(e+3)<<24);return t}var tb="0123456789abcdef".split("");function kA(r){for(var e="",t=0;t<4;t++)e+=tb[r>>8*t+4&15]+tb[r>>8*t&15];return e}function jA(r){return String.fromCharCode(255&r,(65280&r)>>8,(16711680&r)>>16,(4278190080&r)>>24)}function Xm(r){return I2(r).map(jA).join("")}var NA=(function(r){for(var e=0;e<r.length;e++)r[e]=kA(r[e]);return r.join("")})(I2("hello"))!="5d41402abc4b2a76b9719d911017c592";function Ru(r,e){if(NA){var t=(65535&r)+(65535&e);return(r>>16)+(e>>16)+(t>>16)<<16|65535&t}return r+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Km(r,e){var t,n,s,o;if(r!==t){for(var d=(s=r,o=1+(256/r.length|0),new Array(o+1).join(s)),c=[],h=0;h<256;h++)c[h]=h;var f=0;for(h=0;h<256;h++){var m=c[h];f=(f+m+d.charCodeAt(h))%256,c[h]=c[f],c[f]=m}t=r,n=c}else c=n;var b=e.length,A=0,v=0,E="";for(h=0;h<b;h++)v=(v+(m=c[A=(A+1)%256]))%256,c[A]=c[v],c[v]=m,d=c[(c[A]+c[v])%256],E+=String.fromCharCode(e.charCodeAt(h)^d);return E}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var nb={print:4,modify:8,copy:16,"annot-forms":32};function tf(r,e,t,n){this.v=1,this.r=2;var s=192;r.forEach(function(c){if(nb.perm!==void 0)throw new Error("Invalid permission: "+c);s+=nb[c]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var o=(e+this.padding).substr(0,32),d=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(o,d),this.P=-(1+(255^s)),this.encryptionKey=Xm(o+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Km(this.encryptionKey,this.padding)}function nf(r){if(/[^\u0000-\u00ff]/.test(r))throw new Error("Invalid PDF Name Object: "+r+", Only accept ASCII characters.");for(var e="",t=r.length,n=0;n<t;n++){var s=r.charCodeAt(n);e+=s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?"#"+("0"+s.toString(16)).slice(-2):r[n]}return e}function ib(r){if(Rs(r)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,n,s){if(s=s||!1,typeof t!="string"||typeof n!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var o=Math.random().toString(35);return e[t][o]=[n,!!s],o},this.unsubscribe=function(t){for(var n in e)if(e[n][t])return delete e[n][t],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var o in e[t]){var d=e[t][o];try{d[0].apply(r,n)}catch(c){Qn.console&&Ys.error("jsPDF PubSub Error",c.message,c)}d[1]&&s.push(o)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Zg(r){if(!(this instanceof Zg))return new Zg(r);var e="opacity,stroke-opacity".split(",");for(var t in r)r.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=r[t]);this.id="",this.objectNumber=-1}function B2(r,e){this.gState=r,this.matrix=e,this.id="",this.objectNumber=-1}function sh(r,e,t,n,s){if(!(this instanceof sh))return new sh(r,e,t,n,s);this.type=r==="axial"?2:3,this.coords=e,this.colors=t,B2.call(this,n,s)}function of(r,e,t,n,s){if(!(this instanceof of))return new of(r,e,t,n,s);this.boundingBox=r,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,B2.call(this,n,s)}function jn(r){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],s=arguments[2],o=arguments[3],d=[],c=1,h=16,f="S",m=null;Rs(r=r||{})==="object"&&(t=r.orientation,n=r.unit||n,s=r.format||s,o=r.compress||r.compressPdf||o,(m=r.encryption||null)!==null&&(m.userPassword=m.userPassword||"",m.ownerPassword=m.ownerPassword||"",m.userPermissions=m.userPermissions||[]),c=typeof r.userUnit=="number"?Math.abs(r.userUnit):1,r.precision!==void 0&&(e=r.precision),r.floatPrecision!==void 0&&(h=r.floatPrecision),f=r.defaultPathOperation||"S"),d=r.filters||(o===!0?["FlateEncode"]:d),n=n||"mm",t=(""+(t||"P")).toLowerCase();var b=r.putOnlyUsedFonts||!1,A={},v={internal:{},__private__:{}};v.__private__.PubSub=ib;var E="1.3",x=v.__private__.getPdfVersion=function(){return E};v.__private__.setPdfVersion=function(P){E=P};var k={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};v.__private__.getPageFormats=function(){return k};var j=v.__private__.getPageFormat=function(P){return k[P]};s=s||"a4";var $="compat",z="advanced",B=$;function F(){this.saveGraphicsState(),pe(new Zt(On,0,0,-On,0,gn()*On).toString()+" cm"),this.setFontSize(this.getFontSize()/On),f="n",B=z}function I(){this.restoreGraphicsState(),f="S",B=$}var X=v.__private__.combineFontStyleAndFontWeight=function(P,ee){if(P=="bold"&&ee=="normal"||P=="bold"&&ee==400||P=="normal"&&ee=="italic"||P=="bold"&&ee=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ee&&(P=ee==400||ee==="normal"?P==="italic"?"italic":"normal":ee!=700&&ee!=="bold"||P!=="normal"?(ee==700?"bold":ee)+""+P:"bold"),P};v.advancedAPI=function(P){var ee=B===$;return ee&&F.call(this),typeof P!="function"||(P(this),ee&&I.call(this)),this},v.compatAPI=function(P){var ee=B===z;return ee&&I.call(this),typeof P!="function"||(P(this),ee&&F.call(this)),this},v.isAdvancedAPI=function(){return B===z};var M,G=function(P){if(B!==z)throw new Error(P+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},U=v.roundToPrecision=v.__private__.roundToPrecision=function(P,ee){var we=e||ee;if(isNaN(P)||isNaN(we))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return P.toFixed(we).replace(/0+$/,"")};M=v.hpf=v.__private__.hpf=typeof h=="number"?function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.hpf");return U(P,h)}:h==="smart"?function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.hpf");return U(P,P>-1&&P<1?16:5)}:function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.hpf");return U(P,16)};var _=v.f2=v.__private__.f2=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.f2");return U(P,2)},N=v.__private__.f3=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.f3");return U(P,3)},te=v.scale=v.__private__.scale=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.scale");return B===$?P*On:B===z?P:void 0},ie=function(P){return te((function(ee){return B===$?gn()-ee:B===z?ee:void 0})(P))};v.__private__.setPrecision=v.setPrecision=function(P){typeof parseInt(P,10)=="number"&&(e=parseInt(P,10))};var re,q="00000000000000000000000000000000",J=v.__private__.getFileId=function(){return q},ce=v.__private__.setFileId=function(P){return q=P!==void 0&&/^[a-fA-F0-9]{32}$/.test(P)?P.toUpperCase():q.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),m!==null&&(Vn=new tf(m.userPermissions,m.userPassword,m.ownerPassword,q)),q};v.setFileId=function(P){return ce(P),this},v.getFileId=function(){return J()};var _e=v.__private__.convertDateToPDFDate=function(P){var ee=P.getTimezoneOffset(),we=ee<0?"+":"-",De=Math.floor(Math.abs(ee/60)),Fe=Math.abs(ee%60),rt=[we,Y(De),"'",Y(Fe),"'"].join("");return["D:",P.getFullYear(),Y(P.getMonth()+1),Y(P.getDate()),Y(P.getHours()),Y(P.getMinutes()),Y(P.getSeconds()),rt].join("")},xe=v.__private__.convertPDFDateToDate=function(P){var ee=parseInt(P.substr(2,4),10),we=parseInt(P.substr(6,2),10)-1,De=parseInt(P.substr(8,2),10),Fe=parseInt(P.substr(10,2),10),rt=parseInt(P.substr(12,2),10),mt=parseInt(P.substr(14,2),10);return new Date(ee,we,De,Fe,rt,mt,0)},Z=v.__private__.setCreationDate=function(P){var ee;if(P===void 0&&(P=new Date),P instanceof Date)ee=_e(P);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(P))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ee=P}return re=ee},D=v.__private__.getCreationDate=function(P){var ee=re;return P==="jsDate"&&(ee=xe(re)),ee};v.setCreationDate=function(P){return Z(P),this},v.getCreationDate=function(P){return D(P)};var H,Y=v.__private__.padd2=function(P){return("0"+parseInt(P)).slice(-2)},ue=v.__private__.padd2Hex=function(P){return("00"+(P=P.toString())).substr(P.length)},Ne=0,Pe=[],Ue=[],Re=0,Ke=[],Je=[],st=!1,yt=Ue;v.__private__.setCustomOutputDestination=function(P){st=!0,yt=P};var Nt=function(P){st||(yt=P)};v.__private__.resetCustomOutputDestination=function(){st=!1,yt=Ue};var pe=v.__private__.out=function(P){return P=P.toString(),Re+=P.length+1,yt.push(P),yt},St=v.__private__.write=function(P){return pe(arguments.length===1?P.toString():Array.prototype.join.call(arguments," "))},Ut=v.__private__.getArrayBuffer=function(P){for(var ee=P.length,we=new ArrayBuffer(ee),De=new Uint8Array(we);ee--;)De[ee]=P.charCodeAt(ee);return we},Lt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];v.__private__.getStandardFonts=function(){return Lt};var at=r.fontSize||16;v.__private__.setFontSize=v.setFontSize=function(P){return at=B===z?P/On:P,this};var en,Ot=v.__private__.getFontSize=v.getFontSize=function(){return B===$?at:at*On},wn=r.R2L||!1;v.__private__.setR2L=v.setR2L=function(P){return wn=P,this},v.__private__.getR2L=v.getR2L=function(){return wn};var nn,Zn=v.__private__.setZoomMode=function(P){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(P))en=P;else if(isNaN(P)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(P)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+P+'" is not recognized.');en=P}else en=parseInt(P,10)};v.__private__.getZoomMode=function(){return en};var Pt,Mt=v.__private__.setPageMode=function(P){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(P)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+P+'" is not recognized.');nn=P};v.__private__.getPageMode=function(){return nn};var yi=v.__private__.setLayoutMode=function(P){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(P)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+P+'" is not recognized.');Pt=P};v.__private__.getLayoutMode=function(){return Pt},v.__private__.setDisplayMode=v.setDisplayMode=function(P,ee,we){return Zn(P),yi(ee),Mt(we),this};var ft={title:"",subject:"",author:"",keywords:"",creator:""};v.__private__.getDocumentProperty=function(P){if(Object.keys(ft).indexOf(P)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ft[P]},v.__private__.getDocumentProperties=function(){return ft},v.__private__.setDocumentProperties=v.setProperties=v.setDocumentProperties=function(P){for(var ee in ft)ft.hasOwnProperty(ee)&&P[ee]&&(ft[ee]=P[ee]);return this},v.__private__.setDocumentProperty=function(P,ee){if(Object.keys(ft).indexOf(P)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ft[P]=ee};var _t,On,Jt,zn,Nn,on={},Sn={},lt=[],Qt={},$t={},Gt={},An={},Vi=null,qn=0,yn=[],Kt=new ib(v),Tr=r.hotfixes||[],Ks={},Ir={},Br=[],Zt=function P(ee,we,De,Fe,rt,mt){if(!(this instanceof P))return new P(ee,we,De,Fe,rt,mt);isNaN(ee)&&(ee=1),isNaN(we)&&(we=0),isNaN(De)&&(De=0),isNaN(Fe)&&(Fe=1),isNaN(rt)&&(rt=0),isNaN(mt)&&(mt=0),this._matrix=[ee,we,De,Fe,rt,mt]};Object.defineProperty(Zt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(P){this._matrix[0]=P}}),Object.defineProperty(Zt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(P){this._matrix[1]=P}}),Object.defineProperty(Zt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(P){this._matrix[2]=P}}),Object.defineProperty(Zt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(P){this._matrix[3]=P}}),Object.defineProperty(Zt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(P){this._matrix[4]=P}}),Object.defineProperty(Zt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(P){this._matrix[5]=P}}),Object.defineProperty(Zt.prototype,"a",{get:function(){return this._matrix[0]},set:function(P){this._matrix[0]=P}}),Object.defineProperty(Zt.prototype,"b",{get:function(){return this._matrix[1]},set:function(P){this._matrix[1]=P}}),Object.defineProperty(Zt.prototype,"c",{get:function(){return this._matrix[2]},set:function(P){this._matrix[2]=P}}),Object.defineProperty(Zt.prototype,"d",{get:function(){return this._matrix[3]},set:function(P){this._matrix[3]=P}}),Object.defineProperty(Zt.prototype,"e",{get:function(){return this._matrix[4]},set:function(P){this._matrix[4]=P}}),Object.defineProperty(Zt.prototype,"f",{get:function(){return this._matrix[5]},set:function(P){this._matrix[5]=P}}),Object.defineProperty(Zt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Zt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Zt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Zt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Zt.prototype.join=function(P){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(M).join(P)},Zt.prototype.multiply=function(P){var ee=P.sx*this.sx+P.shy*this.shx,we=P.sx*this.shy+P.shy*this.sy,De=P.shx*this.sx+P.sy*this.shx,Fe=P.shx*this.shy+P.sy*this.sy,rt=P.tx*this.sx+P.ty*this.shx+this.tx,mt=P.tx*this.shy+P.ty*this.sy+this.ty;return new Zt(ee,we,De,Fe,rt,mt)},Zt.prototype.decompose=function(){var P=this.sx,ee=this.shy,we=this.shx,De=this.sy,Fe=this.tx,rt=this.ty,mt=Math.sqrt(P*P+ee*ee),Vt=(P/=mt)*we+(ee/=mt)*De;we-=P*Vt,De-=ee*Vt;var mn=Math.sqrt(we*we+De*De);return Vt/=mn,P*(De/=mn)<ee*(we/=mn)&&(P=-P,ee=-ee,Vt=-Vt,mt=-mt),{scale:new Zt(mt,0,0,mn,0,0),translate:new Zt(1,0,0,1,Fe,rt),rotate:new Zt(P,ee,-ee,P,0,0),skew:new Zt(1,0,Vt,1,0,0)}},Zt.prototype.toString=function(P){return this.join(" ")},Zt.prototype.inversed=function(){var P=this.sx,ee=this.shy,we=this.shx,De=this.sy,Fe=this.tx,rt=this.ty,mt=1/(P*De-ee*we),Vt=De*mt,mn=-ee*mt,hn=-we*mt,Jn=P*mt;return new Zt(Vt,mn,hn,Jn,-Vt*Fe-hn*rt,-mn*Fe-Jn*rt)},Zt.prototype.applyToPoint=function(P){var ee=P.x*this.sx+P.y*this.shx+this.tx,we=P.x*this.shy+P.y*this.sy+this.ty;return new Ka(ee,we)},Zt.prototype.applyToRectangle=function(P){var ee=this.applyToPoint(P),we=this.applyToPoint(new Ka(P.x+P.w,P.y+P.h));return new Zs(ee.x,ee.y,we.x-ee.x,we.y-ee.y)},Zt.prototype.clone=function(){var P=this.sx,ee=this.shy,we=this.shx,De=this.sy,Fe=this.tx,rt=this.ty;return new Zt(P,ee,we,De,Fe,rt)},v.Matrix=Zt;var Or=v.matrixMult=function(P,ee){return ee.multiply(P)},Na=new Zt(1,0,0,1,0,0);v.unitMatrix=v.identityMatrix=Na;var fa=function(P,ee){if(!$t[P]){var we=(ee instanceof sh?"Sh":"P")+(Object.keys(Qt).length+1).toString(10);ee.id=we,$t[P]=we,Qt[we]=ee,Kt.publish("addPattern",ee)}};v.ShadingPattern=sh,v.TilingPattern=of,v.addShadingPattern=function(P,ee){return G("addShadingPattern()"),fa(P,ee),this},v.beginTilingPattern=function(P){G("beginTilingPattern()"),Ra(P.boundingBox[0],P.boundingBox[1],P.boundingBox[2]-P.boundingBox[0],P.boundingBox[3]-P.boundingBox[1],P.matrix)},v.endTilingPattern=function(P,ee){G("endTilingPattern()"),ee.stream=Je[H].join(`
`),fa(P,ee),Kt.publish("endTilingPattern",ee),Br.pop().restore()};var At,fi=v.__private__.newObject=function(){var P=ei();return vs(P,!0),P},ei=v.__private__.newObjectDeferred=function(){return Ne++,Pe[Ne]=function(){return Re},Ne},vs=function(P,ee){return ee=typeof ee=="boolean"&&ee,Pe[P]=Re,ee&&pe(P+" 0 obj"),P},Ji=v.__private__.newAdditionalObject=function(){var P={objId:ei(),content:""};return Ke.push(P),P},Ds=ei(),Ci=ei(),Si=v.__private__.decodeColorString=function(P){var ee=P.split(" ");if(ee.length!==2||ee[1]!=="g"&&ee[1]!=="G")ee.length!==5||ee[4]!=="k"&&ee[4]!=="K"||(ee=[(1-ee[0])*(1-ee[3]),(1-ee[1])*(1-ee[3]),(1-ee[2])*(1-ee[3]),"r"]);else{var we=parseFloat(ee[0]);ee=[we,we,we,"r"]}for(var De="#",Fe=0;Fe<3;Fe++)De+=("0"+Math.floor(255*parseFloat(ee[Fe])).toString(16)).slice(-2);return De},Cr=v.__private__.encodeColorString=function(P){var ee;typeof P=="string"&&(P={ch1:P});var we=P.ch1,De=P.ch2,Fe=P.ch3,rt=P.ch4,mt=P.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof we=="string"&&we.charAt(0)!=="#"){var Vt=new z2(we);if(Vt.ok)we=Vt.toHex();else if(!/^\d*\.?\d*$/.test(we))throw new Error('Invalid color "'+we+'" passed to jsPDF.encodeColorString.')}if(typeof we=="string"&&/^#[0-9A-Fa-f]{3}$/.test(we)&&(we="#"+we[1]+we[1]+we[2]+we[2]+we[3]+we[3]),typeof we=="string"&&/^#[0-9A-Fa-f]{6}$/.test(we)){var mn=parseInt(we.substr(1),16);we=mn>>16&255,De=mn>>8&255,Fe=255&mn}if(De===void 0||rt===void 0&&we===De&&De===Fe)ee=typeof we=="string"?we+" "+mt[0]:P.precision===2?_(we/255)+" "+mt[0]:N(we/255)+" "+mt[0];else if(rt===void 0||Rs(rt)==="object"){if(rt&&!isNaN(rt.a)&&rt.a===0)return["1.","1.","1.",mt[1]].join(" ");ee=typeof we=="string"?[we,De,Fe,mt[1]].join(" "):P.precision===2?[_(we/255),_(De/255),_(Fe/255),mt[1]].join(" "):[N(we/255),N(De/255),N(Fe/255),mt[1]].join(" ")}else ee=typeof we=="string"?[we,De,Fe,rt,mt[2]].join(" "):P.precision===2?[_(we),_(De),_(Fe),_(rt),mt[2]].join(" "):[N(we),N(De),N(Fe),N(rt),mt[2]].join(" ");return ee},pa=v.__private__.getFilters=function(){return d},qa=v.__private__.putStream=function(P){var ee=(P=P||{}).data||"",we=P.filters||pa(),De=P.alreadyAppliedFilters||[],Fe=P.addLength1||!1,rt=ee.length,mt=P.objectId,Vt=function(Ei){return Ei};if(m!==null&&mt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");m!==null&&(Vt=Vn.encryptor(mt,0));var mn={};we===!0&&(we=["FlateEncode"]);var hn=P.additionalKeyValues||[],Jn=(mn=jn.API.processDataByFilters!==void 0?jn.API.processDataByFilters(ee,we):{data:ee,reverseChain:[]}).reverseChain+(Array.isArray(De)?De.join(" "):De.toString());if(mn.data.length!==0&&(hn.push({key:"Length",value:mn.data.length}),Fe===!0&&hn.push({key:"Length1",value:rt})),Jn.length!=0)if(Jn.split("/").length-1==1)hn.push({key:"Filter",value:Jn});else{hn.push({key:"Filter",value:"["+Jn+"]"});for(var vi=0;vi<hn.length;vi+=1)if(hn[vi].key==="DecodeParms"){for(var Us=[],Ni=0;Ni<mn.reverseChain.split("/").length-1;Ni+=1)Us.push("null");Us.push(hn[vi].value),hn[vi].value="["+Us.join(" ")+"]"}}pe("<<");for(var Wi=0;Wi<hn.length;Wi++)pe("/"+hn[Wi].key+" "+hn[Wi].value);pe(">>"),mn.data.length!==0&&(pe("stream"),pe(Vt(mn.data)),pe("endstream"))},Yl=v.__private__.putPage=function(P){var ee=P.number,we=P.data,De=P.objId,Fe=P.contentsObjId;vs(De,!0),pe("<</Type /Page"),pe("/Parent "+P.rootDictionaryObjId+" 0 R"),pe("/Resources "+P.resourceDictionaryObjId+" 0 R"),pe("/MediaBox ["+parseFloat(M(P.mediaBox.bottomLeftX))+" "+parseFloat(M(P.mediaBox.bottomLeftY))+" "+M(P.mediaBox.topRightX)+" "+M(P.mediaBox.topRightY)+"]"),P.cropBox!==null&&pe("/CropBox ["+M(P.cropBox.bottomLeftX)+" "+M(P.cropBox.bottomLeftY)+" "+M(P.cropBox.topRightX)+" "+M(P.cropBox.topRightY)+"]"),P.bleedBox!==null&&pe("/BleedBox ["+M(P.bleedBox.bottomLeftX)+" "+M(P.bleedBox.bottomLeftY)+" "+M(P.bleedBox.topRightX)+" "+M(P.bleedBox.topRightY)+"]"),P.trimBox!==null&&pe("/TrimBox ["+M(P.trimBox.bottomLeftX)+" "+M(P.trimBox.bottomLeftY)+" "+M(P.trimBox.topRightX)+" "+M(P.trimBox.topRightY)+"]"),P.artBox!==null&&pe("/ArtBox ["+M(P.artBox.bottomLeftX)+" "+M(P.artBox.bottomLeftY)+" "+M(P.artBox.topRightX)+" "+M(P.artBox.topRightY)+"]"),typeof P.userUnit=="number"&&P.userUnit!==1&&pe("/UserUnit "+P.userUnit),Kt.publish("putPage",{objId:De,pageContext:yn[ee],pageNumber:ee,page:we}),pe("/Contents "+Fe+" 0 R"),pe(">>"),pe("endobj");var rt=we.join(`
`);return B===z&&(rt+=`
Q`),vs(Fe,!0),qa({data:rt,filters:pa(),objectId:Fe}),pe("endobj"),De},Va=v.__private__.putPages=function(){var P,ee,we=[];for(P=1;P<=qn;P++)yn[P].objId=ei(),yn[P].contentsObjId=ei();for(P=1;P<=qn;P++)we.push(Yl({number:P,data:Je[P],objId:yn[P].objId,contentsObjId:yn[P].contentsObjId,mediaBox:yn[P].mediaBox,cropBox:yn[P].cropBox,bleedBox:yn[P].bleedBox,trimBox:yn[P].trimBox,artBox:yn[P].artBox,userUnit:yn[P].userUnit,rootDictionaryObjId:Ds,resourceDictionaryObjId:Ci}));vs(Ds,!0),pe("<</Type /Pages");var De="/Kids [";for(ee=0;ee<qn;ee++)De+=we[ee]+" 0 R ";pe(De+"]"),pe("/Count "+qn),pe(">>"),pe("endobj"),Kt.publish("postPutPages")},Wa=function(P){Kt.publish("putFont",{font:P,out:pe,newObject:fi,putStream:qa}),P.isAlreadyPutted!==!0&&(P.objectNumber=fi(),pe("<<"),pe("/Type /Font"),pe("/BaseFont /"+nf(P.postScriptName)),pe("/Subtype /Type1"),typeof P.encoding=="string"&&pe("/Encoding /"+P.encoding),pe("/FirstChar 32"),pe("/LastChar 255"),pe(">>"),pe("endobj"))},No=function(P){P.objectNumber=fi();var ee=[];ee.push({key:"Type",value:"/XObject"}),ee.push({key:"Subtype",value:"/Form"}),ee.push({key:"BBox",value:"["+[M(P.x),M(P.y),M(P.x+P.width),M(P.y+P.height)].join(" ")+"]"}),ee.push({key:"Matrix",value:"["+P.matrix.toString()+"]"});var we=P.pages[1].join(`
`);qa({data:we,additionalKeyValues:ee,objectId:P.objectNumber}),pe("endobj")},$n=function(P,ee){ee||(ee=21);var we=fi(),De=(function(mt,Vt){var mn,hn=[],Jn=1/(Vt-1);for(mn=0;mn<1;mn+=Jn)hn.push(mn);if(hn.push(1),mt[0].offset!=0){var vi={offset:0,color:mt[0].color};mt.unshift(vi)}if(mt[mt.length-1].offset!=1){var Us={offset:1,color:mt[mt.length-1].color};mt.push(Us)}for(var Ni="",Wi=0,Ei=0;Ei<hn.length;Ei++){for(mn=hn[Ei];mn>mt[Wi+1].offset;)Wi++;var ks=mt[Wi].offset,as=(mn-ks)/(mt[Wi+1].offset-ks),uo=mt[Wi].color,Nr=mt[Wi+1].color;Ni+=ue(Math.round((1-as)*uo[0]+as*Nr[0]).toString(16))+ue(Math.round((1-as)*uo[1]+as*Nr[1]).toString(16))+ue(Math.round((1-as)*uo[2]+as*Nr[2]).toString(16))}return Ni.trim()})(P.colors,ee),Fe=[];Fe.push({key:"FunctionType",value:"0"}),Fe.push({key:"Domain",value:"[0.0 1.0]"}),Fe.push({key:"Size",value:"["+ee+"]"}),Fe.push({key:"BitsPerSample",value:"8"}),Fe.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Fe.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),qa({data:De,additionalKeyValues:Fe,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:we}),pe("endobj"),P.objectNumber=fi(),pe("<< /ShadingType "+P.type),pe("/ColorSpace /DeviceRGB");var rt="/Coords ["+M(parseFloat(P.coords[0]))+" "+M(parseFloat(P.coords[1]))+" ";P.type===2?rt+=M(parseFloat(P.coords[2]))+" "+M(parseFloat(P.coords[3])):rt+=M(parseFloat(P.coords[2]))+" "+M(parseFloat(P.coords[3]))+" "+M(parseFloat(P.coords[4]))+" "+M(parseFloat(P.coords[5])),pe(rt+="]"),P.matrix&&pe("/Matrix ["+P.matrix.toString()+"]"),pe("/Function "+we+" 0 R"),pe("/Extend [true true]"),pe(">>"),pe("endobj")},Fr=function(P,ee){var we=ei(),De=fi();ee.push({resourcesOid:we,objectOid:De}),P.objectNumber=De;var Fe=[];Fe.push({key:"Type",value:"/Pattern"}),Fe.push({key:"PatternType",value:"1"}),Fe.push({key:"PaintType",value:"1"}),Fe.push({key:"TilingType",value:"1"}),Fe.push({key:"BBox",value:"["+P.boundingBox.map(M).join(" ")+"]"}),Fe.push({key:"XStep",value:M(P.xStep)}),Fe.push({key:"YStep",value:M(P.yStep)}),Fe.push({key:"Resources",value:we+" 0 R"}),P.matrix&&Fe.push({key:"Matrix",value:"["+P.matrix.toString()+"]"}),qa({data:P.stream,additionalKeyValues:Fe,objectId:P.objectNumber}),pe("endobj")},xi=function(P){for(var ee in P.objectNumber=fi(),pe("<<"),P)switch(ee){case"opacity":pe("/ca "+_(P[ee]));break;case"stroke-opacity":pe("/CA "+_(P[ee]))}pe(">>"),pe("endobj")},ga=function(P){vs(P.resourcesOid,!0),pe("<<"),pe("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var ee in pe("/Font <<"),on)on.hasOwnProperty(ee)&&(b===!1||b===!0&&A.hasOwnProperty(ee))&&pe("/"+ee+" "+on[ee].objectNumber+" 0 R");pe(">>")})(),(function(){if(Object.keys(Qt).length>0){for(var ee in pe("/Shading <<"),Qt)Qt.hasOwnProperty(ee)&&Qt[ee]instanceof sh&&Qt[ee].objectNumber>=0&&pe("/"+ee+" "+Qt[ee].objectNumber+" 0 R");Kt.publish("putShadingPatternDict"),pe(">>")}})(),(function(ee){if(Object.keys(Qt).length>0){for(var we in pe("/Pattern <<"),Qt)Qt.hasOwnProperty(we)&&Qt[we]instanceof v.TilingPattern&&Qt[we].objectNumber>=0&&Qt[we].objectNumber<ee&&pe("/"+we+" "+Qt[we].objectNumber+" 0 R");Kt.publish("putTilingPatternDict"),pe(">>")}})(P.objectOid),(function(){if(Object.keys(Gt).length>0){var ee;for(ee in pe("/ExtGState <<"),Gt)Gt.hasOwnProperty(ee)&&Gt[ee].objectNumber>=0&&pe("/"+ee+" "+Gt[ee].objectNumber+" 0 R");Kt.publish("putGStateDict"),pe(">>")}})(),(function(){for(var ee in pe("/XObject <<"),Ks)Ks.hasOwnProperty(ee)&&Ks[ee].objectNumber>=0&&pe("/"+ee+" "+Ks[ee].objectNumber+" 0 R");Kt.publish("putXobjectDict"),pe(">>")})(),pe(">>"),pe("endobj")},En=function(P){Sn[P.fontName]=Sn[P.fontName]||{},Sn[P.fontName][P.fontStyle]=P.id},Qo=function(P,ee,we,De,Fe){var rt={id:"F"+(Object.keys(on).length+1).toString(10),postScriptName:P,fontName:ee,fontStyle:we,encoding:De,isStandardFont:Fe||!1,metadata:{}};return Kt.publish("addFont",{font:rt,instance:this}),on[rt.id]=rt,En(rt),rt.id},pi=v.__private__.pdfEscape=v.pdfEscape=function(P,ee){return(function(we,De){var Fe,rt,mt,Vt,mn,hn,Jn,vi,Us;if(mt=(De=De||{}).sourceEncoding||"Unicode",mn=De.outputEncoding,(De.autoencode||mn)&&on[_t].metadata&&on[_t].metadata[mt]&&on[_t].metadata[mt].encoding&&(Vt=on[_t].metadata[mt].encoding,!mn&&on[_t].encoding&&(mn=on[_t].encoding),!mn&&Vt.codePages&&(mn=Vt.codePages[0]),typeof mn=="string"&&(mn=Vt[mn]),mn)){for(Jn=!1,hn=[],Fe=0,rt=we.length;Fe<rt;Fe++)(vi=mn[we.charCodeAt(Fe)])?hn.push(String.fromCharCode(vi)):hn.push(we[Fe]),hn[Fe].charCodeAt(0)>>8&&(Jn=!0);we=hn.join("")}for(Fe=we.length;Jn===void 0&&Fe!==0;)we.charCodeAt(Fe-1)>>8&&(Jn=!0),Fe--;if(!Jn)return we;for(hn=De.noBOM?[]:[254,255],Fe=0,rt=we.length;Fe<rt;Fe++){if((Us=(vi=we.charCodeAt(Fe))>>8)>>8)throw new Error("Character at position "+Fe+" of string '"+we+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");hn.push(Us),hn.push(vi-(Us<<8))}return String.fromCharCode.apply(void 0,hn)})(P,ee).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ma=v.__private__.beginPage=function(P){Je[++qn]=[],yn[qn]={objId:0,contentsObjId:0,userUnit:Number(c),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(P[0]),topRightY:Number(P[1])}},tl(qn),Nt(Je[H])},Pa=function(P,ee){var we,De,Fe;switch(t=ee||t,typeof P=="string"&&(we=j(P.toLowerCase()),Array.isArray(we)&&(De=we[0],Fe=we[1])),Array.isArray(P)&&(De=P[0]*On,Fe=P[1]*On),isNaN(De)&&(De=s[0],Fe=s[1]),(De>14400||Fe>14400)&&(Ys.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),De=Math.min(14400,De),Fe=Math.min(14400,Fe)),s=[De,Fe],t.substr(0,1)){case"l":Fe>De&&(s=[Fe,De]);break;case"p":De>Fe&&(s=[Fe,De])}ma(s),In(es),pe(tn),Yt!==0&&pe(Yt+" J"),Gn!==0&&pe(Gn+" j"),Kt.publish("addPage",{pageNumber:qn})},el=function(P){P>0&&P<=qn&&(Je.splice(P,1),yn.splice(P,1),qn--,H>qn&&(H=qn),this.setPage(H))},tl=function(P){P>0&&P<=qn&&(H=P)},$a=v.__private__.getNumberOfPages=v.getNumberOfPages=function(){return Je.length-1},td=function(P,ee,we){var De,Fe=void 0;return we=we||{},P=P!==void 0?P:on[_t].fontName,ee=ee!==void 0?ee:on[_t].fontStyle,De=P.toLowerCase(),Sn[De]!==void 0&&Sn[De][ee]!==void 0?Fe=Sn[De][ee]:Sn[P]!==void 0&&Sn[P][ee]!==void 0?Fe=Sn[P][ee]:we.disableWarning===!1&&Ys.warn("Unable to look up font label for font '"+P+"', '"+ee+"'. Refer to getFontList() for available fonts."),Fe||we.noFallback||(Fe=Sn.times[ee])==null&&(Fe=Sn.times.normal),Fe},ss=v.__private__.putInfo=function(){var P=fi(),ee=function(De){return De};for(var we in m!==null&&(ee=Vn.encryptor(P,0)),pe("<<"),pe("/Producer ("+pi(ee("jsPDF "+jn.version))+")"),ft)ft.hasOwnProperty(we)&&ft[we]&&pe("/"+we.substr(0,1).toUpperCase()+we.substr(1)+" ("+pi(ee(ft[we]))+")");pe("/CreationDate ("+pi(ee(re))+")"),pe(">>"),pe("endobj")},nl=v.__private__.putCatalog=function(P){var ee=(P=P||{}).rootDictionaryObjId||Ds;switch(fi(),pe("<<"),pe("/Type /Catalog"),pe("/Pages "+ee+" 0 R"),en||(en="fullwidth"),en){case"fullwidth":pe("/OpenAction [3 0 R /FitH null]");break;case"fullheight":pe("/OpenAction [3 0 R /FitV null]");break;case"fullpage":pe("/OpenAction [3 0 R /Fit]");break;case"original":pe("/OpenAction [3 0 R /XYZ null null 1]");break;default:var we=""+en;we.substr(we.length-1)==="%"&&(en=parseInt(en)/100),typeof en=="number"&&pe("/OpenAction [3 0 R /XYZ null null "+_(en)+"]")}switch(Pt||(Pt="continuous"),Pt){case"continuous":pe("/PageLayout /OneColumn");break;case"single":pe("/PageLayout /SinglePage");break;case"two":case"twoleft":pe("/PageLayout /TwoColumnLeft");break;case"tworight":pe("/PageLayout /TwoColumnRight")}nn&&pe("/PageMode /"+nn),Kt.publish("putCatalog"),pe(">>"),pe("endobj")},Un=v.__private__.putTrailer=function(){pe("trailer"),pe("<<"),pe("/Size "+(Ne+1)),pe("/Root "+Ne+" 0 R"),pe("/Info "+(Ne-1)+" 0 R"),m!==null&&pe("/Encrypt "+Vn.oid+" 0 R"),pe("/ID [ <"+q+"> <"+q+"> ]"),pe(">>")},Fn=v.__private__.putHeader=function(){pe("%PDF-"+E),pe("%")},il=v.__private__.putXRef=function(){var P="0000000000";pe("xref"),pe("0 "+(Ne+1)),pe("0000000000 65535 f ");for(var ee=1;ee<=Ne;ee++)typeof Pe[ee]=="function"?pe((P+Pe[ee]()).slice(-10)+" 00000 n "):Pe[ee]!==void 0?pe((P+Pe[ee]).slice(-10)+" 00000 n "):pe("0000000000 00000 n ")},Ga=v.__private__.buildDocument=function(){var P;Ne=0,Re=0,Ue=[],Pe=[],Ke=[],Ds=ei(),Ci=ei(),Nt(Ue),Kt.publish("buildDocument"),Fn(),Va(),(function(){Kt.publish("putAdditionalObjects");for(var we=0;we<Ke.length;we++){var De=Ke[we];vs(De.objId,!0),pe(De.content),pe("endobj")}Kt.publish("postPutAdditionalObjects")})(),P=[],(function(){for(var we in on)on.hasOwnProperty(we)&&(b===!1||b===!0&&A.hasOwnProperty(we))&&Wa(on[we])})(),(function(){var we;for(we in Gt)Gt.hasOwnProperty(we)&&xi(Gt[we])})(),(function(){for(var we in Ks)Ks.hasOwnProperty(we)&&No(Ks[we])})(),(function(we){var De;for(De in Qt)Qt.hasOwnProperty(De)&&(Qt[De]instanceof sh?$n(Qt[De]):Qt[De]instanceof of&&Fr(Qt[De],we))})(P),Kt.publish("putResources"),P.forEach(ga),ga({resourcesOid:Ci,objectOid:Number.MAX_SAFE_INTEGER}),Kt.publish("postPutResources"),m!==null&&(Vn.oid=fi(),pe("<<"),pe("/Filter /Standard"),pe("/V "+Vn.v),pe("/R "+Vn.r),pe("/U <"+Vn.toHexString(Vn.U)+">"),pe("/O <"+Vn.toHexString(Vn.O)+">"),pe("/P "+Vn.P),pe(">>"),pe("endobj")),ss(),nl();var ee=Re;return il(),Un(),pe("startxref"),pe(""+ee),pe("%%EOF"),Nt(Je[H]),Ue.join(`
`)},Fs=v.__private__.getBlob=function(P){return new Blob([Ut(P)],{type:"application/pdf"})},_r=v.output=v.__private__.output=(At=function(P,ee){switch(typeof(ee=ee||{})=="string"?ee={filename:ee}:ee.filename=ee.filename||"generated.pdf",P){case void 0:return Ga();case"save":v.save(ee.filename);break;case"arraybuffer":return Ut(Ga());case"blob":return Fs(Ga());case"bloburi":case"bloburl":if(Qn.URL!==void 0&&typeof Qn.URL.createObjectURL=="function")return Qn.URL&&Qn.URL.createObjectURL(Fs(Ga()))||void 0;Ys.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var we="",De=Ga();try{we=eb(De)}catch{we=eb(unescape(encodeURIComponent(De)))}return"data:application/pdf;filename="+ee.filename+";base64,"+we;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Qn)==="[object Window]"){var Fe="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",rt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ee.pdfObjectUrl&&(Fe=ee.pdfObjectUrl,rt="");var mt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Fe+'"'+rt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ee)+");<\/script></body></html>",Vt=Qn.open();return Vt!==null&&Vt.document.write(mt),Vt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Qn)==="[object Window]"){var mn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ee.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ee.filename+'" width="500px" height="400px" /></body></html>',hn=Qn.open();if(hn!==null){hn.document.write(mn);var Jn=this;hn.document.documentElement.querySelector("#pdfViewer").onload=function(){hn.document.title=ee.filename,hn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Jn.output("bloburl"))}}return hn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Qn)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var vi='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ee)+'"></iframe></body></html>',Us=Qn.open();if(Us!==null&&(Us.document.write(vi),Us.document.title=ee.filename),Us||typeof safari>"u")return Us;break;case"datauri":case"dataurl":return Qn.document.location.href=this.output("datauristring",ee);default:return null}},At.foo=function(){try{return At.apply(this,arguments)}catch(we){var P=we.stack||"";~P.indexOf(" at ")&&(P=P.split(" at ")[1]);var ee="Error in function "+P.split(`
`)[0].split("<")[0]+": "+we.message;if(!Qn.console)throw new Error(ee);Qn.console.error(ee,we),Qn.alert&&alert(ee)}},At.foo.bar=At,At.foo),us=function(P){return Array.isArray(Tr)===!0&&Tr.indexOf(P)>-1};switch(n){case"pt":On=1;break;case"mm":On=72/25.4;break;case"cm":On=72/2.54;break;case"in":On=72;break;case"px":On=us("px_scaling")==1?.75:96/72;break;case"pc":case"em":On=12;break;case"ex":On=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);On=n}var Vn=null;Z(),ce();var bi=v.__private__.getPageInfo=v.getPageInfo=function(P){if(isNaN(P)||P%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:yn[P].objId,pageNumber:P,pageContext:yn[P]}},Xl=v.__private__.getPageInfoByObjId=function(P){if(isNaN(P)||P%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ee in yn)if(yn[ee].objId===P)break;return bi(ee)},bc=v.__private__.getCurrentPageInfo=v.getCurrentPageInfo=function(){return{objId:yn[H].objId,pageNumber:H,pageContext:yn[H]}};v.addPage=function(){return Pa.apply(this,arguments),this},v.setPage=function(){return tl.apply(this,arguments),Nt.call(this,Je[H]),this},v.insertPage=function(P){return this.addPage(),this.movePage(H,P),this},v.movePage=function(P,ee){var we,De;if(P>ee){we=Je[P],De=yn[P];for(var Fe=P;Fe>ee;Fe--)Je[Fe]=Je[Fe-1],yn[Fe]=yn[Fe-1];Je[ee]=we,yn[ee]=De,this.setPage(ee)}else if(P<ee){we=Je[P],De=yn[P];for(var rt=P;rt<ee;rt++)Je[rt]=Je[rt+1],yn[rt]=yn[rt+1];Je[ee]=we,yn[ee]=De,this.setPage(ee)}return this},v.deletePage=function(){return el.apply(this,arguments),this},v.__private__.text=v.text=function(P,ee,we,De,Fe){var rt,mt,Vt,mn,hn,Jn,vi,Us,Ni,Wi=(De=De||{}).scope||this;if(typeof P=="number"&&typeof ee=="number"&&(typeof we=="string"||Array.isArray(we))){var Ei=we;we=ee,ee=P,P=Ei}if(arguments[3]instanceof Zt==0?(Vt=arguments[4],mn=arguments[5],Rs(vi=arguments[3])==="object"&&vi!==null||(typeof Vt=="string"&&(mn=Vt,Vt=null),typeof vi=="string"&&(mn=vi,vi=null),typeof vi=="number"&&(Vt=vi,vi=null),De={flags:vi,angle:Vt,align:mn})):(G("The transform parameter of text() with a Matrix value"),Ni=Fe),isNaN(ee)||isNaN(we)||P==null)throw new Error("Invalid arguments passed to jsPDF.text");if(P.length===0)return Wi;var ks,as="",uo=typeof De.lineHeightFactor=="number"?De.lineHeightFactor:rs,Nr=Wi.internal.scaleFactor;function ol($i){return $i=$i.split("	").join(Array(De.TabLen||9).join(" ")),pi($i,vi)}function pr($i){for(var Ri,Ss=$i.concat(),sr=[],_l=Ss.length;_l--;)typeof(Ri=Ss.shift())=="string"?sr.push(Ri):Array.isArray($i)&&(Ri.length===1||Ri[1]===void 0&&Ri[2]===void 0)?sr.push(Ri[0]):sr.push([Ri[0],Ri[1],Ri[2]]);return sr}function ll($i,Ri){var Ss;if(typeof $i=="string")Ss=Ri($i)[0];else if(Array.isArray($i)){for(var sr,_l,ul=$i.concat(),rr=[],Ta=ul.length;Ta--;)typeof(sr=ul.shift())=="string"?rr.push(Ri(sr)[0]):Array.isArray(sr)&&typeof sr[0]=="string"&&(_l=Ri(sr[0],sr[1],sr[2]),rr.push([_l[0],_l[1],_l[2]]));Ss=rr}return Ss}var Hs=!1,ba=!0;if(typeof P=="string")Hs=!0;else if(Array.isArray(P)){var gr=P.concat();mt=[];for(var Ja,oi=gr.length;oi--;)(typeof(Ja=gr.shift())!="string"||Array.isArray(Ja)&&typeof Ja[0]!="string")&&(ba=!1);Hs=ba}if(Hs===!1)throw new Error('Type of text must be string or Array. "'+P+'" is not recognized.');typeof P=="string"&&(P=P.match(/[\r?\n]/)?P.split(/\r\n|\r|\n/g):[P]);var ho=at/Wi.internal.scaleFactor,wc=ho*(uo-1);switch(De.baseline){case"bottom":we-=wc;break;case"top":we+=ho-wc;break;case"hanging":we+=ho-2*wc;break;case"middle":we+=ho/2-wc}if((Jn=De.maxWidth||0)>0&&(typeof P=="string"?P=Wi.splitTextToSize(P,Jn):Object.prototype.toString.call(P)==="[object Array]"&&(P=P.reduce(function($i,Ri){return $i.concat(Wi.splitTextToSize(Ri,Jn))},[]))),rt={text:P,x:ee,y:we,options:De,mutex:{pdfEscape:pi,activeFontKey:_t,fonts:on,activeFontSize:at}},Kt.publish("preProcessText",rt),P=rt.text,Vt=(De=rt.options).angle,Ni instanceof Zt==0&&Vt&&typeof Vt=="number"){Vt*=Math.PI/180,De.rotationDirection===0&&(Vt=-Vt),B===z&&(Vt=-Vt);var nd=Math.cos(Vt),Qa=Math.sin(Vt);Ni=new Zt(nd,Qa,-Qa,nd,0,0)}else Vt&&Vt instanceof Zt&&(Ni=Vt);B!==z||Ni||(Ni=Na),(hn=De.charSpace||It)!==void 0&&(as+=M(te(hn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Us=De.horizontalScale)!==void 0&&(as+=M(100*Us)+` Tz
`),De.lang;var Hr=-1,Do=De.renderingMode!==void 0?De.renderingMode:De.stroke,Sc=Wi.internal.getCurrentPageInfo().pageContext;switch(Do){case 0:case!1:case"fill":Hr=0;break;case 1:case!0:case"stroke":Hr=1;break;case 2:case"fillThenStroke":Hr=2;break;case 3:case"invisible":Hr=3;break;case 4:case"fillAndAddForClipping":Hr=4;break;case 5:case"strokeAndAddPathForClipping":Hr=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Hr=6;break;case 7:case"addToPathForClipping":Hr=7}var Lo=Sc.usedRenderingMode!==void 0?Sc.usedRenderingMode:-1;Hr!==-1?as+=Hr+` Tr
`:Lo!==-1&&(as+=`0 Tr
`),Hr!==-1&&(Sc.usedRenderingMode=Hr),mn=De.align||"left";var va,nr=at*uo,eo=Wi.internal.pageSize.getWidth(),cl=on[_t];hn=De.charSpace||It,Jn=De.maxWidth||0,vi=Object.assign({autoencode:!0,noBOM:!0},De.flags);var fo=[],po=function($i){return Wi.getStringUnitWidth($i,{font:cl,charSpace:hn,fontSize:at,doKerning:!1})*at/Nr};if(Object.prototype.toString.call(P)==="[object Array]"){var wa;mt=pr(P),mn!=="left"&&(va=mt.map(po));var ir,Mo=0;if(mn==="right"){ee-=va[0],P=[],oi=mt.length;for(var Da=0;Da<oi;Da++)Da===0?(ir=xa(ee),wa=ln(we)):(ir=te(Mo-va[Da]),wa=-nr),P.push([mt[Da],ir,wa]),Mo=va[Da]}else if(mn==="center"){ee-=va[0]/2,P=[],oi=mt.length;for(var _i=0;_i<oi;_i++)_i===0?(ir=xa(ee),wa=ln(we)):(ir=te((Mo-va[_i])/2),wa=-nr),P.push([mt[_i],ir,wa]),Mo=va[_i]}else if(mn==="left"){P=[],oi=mt.length;for(var zo=0;zo<oi;zo++)P.push(mt[zo])}else if(mn==="justify"&&cl.encoding==="Identity-H"){P=[],oi=mt.length,Jn=Jn!==0?Jn:eo;for(var os=0,ws=0;ws<oi;ws++)if(wa=ws===0?ln(we):-nr,ir=ws===0?xa(ee):os,ws<oi-1){var id=te((Jn-va[ws])/(mt[ws].split(" ").length-1)),La=mt[ws].split(" ");P.push([La[0]+" ",ir,wa]),os=0;for(var Cl=1;Cl<La.length;Cl++){var Pr=(po(La[Cl-1]+" "+La[Cl])-po(La[Cl]))*Nr+id;Cl==La.length-1?P.push([La[Cl],Pr,0]):P.push([La[Cl]+" ",Pr,0]),os-=Pr}}else P.push([mt[ws],ir,wa]);P.push(["",os,0])}else{if(mn!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(P=[],oi=mt.length,Jn=Jn!==0?Jn:eo,ws=0;ws<oi;ws++){wa=ws===0?ln(we):-nr,ir=ws===0?xa(ee):0;var Zl=mt[ws].split(" ").length-1,sd=Zl>0?(Jn-va[ws])/Zl:0;ws<oi-1?fo.push(M(te(sd))):fo.push(0),P.push([mt[ws],ir,wa])}}}(typeof De.R2L=="boolean"?De.R2L:wn)===!0&&(P=ll(P,function($i,Ri,Ss){return[$i.split("").reverse().join(""),Ri,Ss]})),rt={text:P,x:ee,y:we,options:De,mutex:{pdfEscape:pi,activeFontKey:_t,fonts:on,activeFontSize:at}},Kt.publish("postProcessText",rt),P=rt.text,ks=rt.mutex.isHex||!1;var to=on[_t].encoding;to!=="WinAnsiEncoding"&&to!=="StandardEncoding"||(P=ll(P,function($i,Ri,Ss){return[ol($i),Ri,Ss]})),mt=pr(P),P=[];for(var dl,Io,Sa,qr=Array.isArray(mt[0])?1:0,Ma="",Bo=function($i,Ri,Ss){var sr="";return Ss instanceof Zt?(Ss=typeof De.angle=="number"?Or(Ss,new Zt(1,0,0,1,$i,Ri)):Or(new Zt(1,0,0,1,$i,Ri),Ss),B===z&&(Ss=Or(new Zt(1,0,0,-1,0,0),Ss)),sr=Ss.join(" ")+` Tm
`):sr=M($i)+" "+M(Ri)+` Td
`,sr},Aa=0;Aa<mt.length;Aa++){switch(Ma="",qr){case 1:Sa=(ks?"<":"(")+mt[Aa][0]+(ks?">":")"),dl=parseFloat(mt[Aa][1]),Io=parseFloat(mt[Aa][2]);break;case 0:Sa=(ks?"<":"(")+mt[Aa]+(ks?">":")"),dl=xa(ee),Io=ln(we)}fo!==void 0&&fo[Aa]!==void 0&&(Ma=fo[Aa]+` Tw
`),Aa===0?P.push(Ma+Bo(dl,Io,Ni)+Sa):qr===0?P.push(Ma+Sa):qr===1&&P.push(Ma+Bo(dl,Io,Ni)+Sa)}P=qr===0?P.join(` Tj
T* `):P.join(` Tj
`),P+=` Tj
`;var go=`BT
/`;return go+=_t+" "+at+` Tf
`,go+=M(at*uo)+` TL
`,go+=pn+`
`,go+=as,go+=P,pe(go+="ET"),A[_t]=!0,Wi};var ya=v.__private__.clip=v.clip=function(P){return pe(P==="evenodd"?"W*":"W"),this};v.clipEvenOdd=function(){return ya("evenodd")},v.__private__.discardPath=v.discardPath=function(){return pe("n"),this};var kr=v.__private__.isValidStyle=function(P){var ee=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(P)!==-1&&(ee=!0),ee};v.__private__.setDefaultPathOperation=v.setDefaultPathOperation=function(P){return kr(P)&&(f=P),this};var sl=v.__private__.getStyle=v.getStyle=function(P){var ee=f;switch(P){case"D":case"S":ee="S";break;case"F":ee="f";break;case"FD":case"DF":ee="B";break;case"f":case"f*":case"B":case"B*":ee=P}return ee},Ya=v.close=function(){return pe("h"),this};v.stroke=function(){return pe("S"),this},v.fill=function(P){return jr("f",P),this},v.fillEvenOdd=function(P){return jr("f*",P),this},v.fillStroke=function(P){return jr("B",P),this},v.fillStrokeEvenOdd=function(P){return jr("B*",P),this};var jr=function(P,ee){Rs(ee)==="object"?Qi(ee,P):pe(P)},na=function(P){P===null||B===z&&P===void 0||(P=sl(P),pe(P))};function Et(P,ee,we,De,Fe){var rt=new of(ee||this.boundingBox,we||this.xStep,De||this.yStep,this.gState,Fe||this.matrix);rt.stream=this.stream;var mt=P+"$$"+this.cloneIndex+++"$$";return fa(mt,rt),rt}var Qi=function(P,ee){var we=$t[P.key],De=Qt[we];if(De instanceof sh)pe("q"),pe(fr(ee)),De.gState&&v.setGState(De.gState),pe(P.matrix.toString()+" cm"),pe("/"+we+" sh"),pe("Q");else if(De instanceof of){var Fe=new Zt(1,0,0,-1,0,gn());P.matrix&&(Fe=Fe.multiply(P.matrix||Na),we=Et.call(De,P.key,P.boundingBox,P.xStep,P.yStep,Fe).id),pe("q"),pe("/Pattern cs"),pe("/"+we+" scn"),De.gState&&v.setGState(De.gState),pe(ee),pe("Q")}},fr=function(P){switch(P){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Al=v.moveTo=function(P,ee){return pe(M(te(P))+" "+M(ie(ee))+" m"),this},Xa=v.lineTo=function(P,ee){return pe(M(te(P))+" "+M(ie(ee))+" l"),this},Ea=v.curveTo=function(P,ee,we,De,Fe,rt){return pe([M(te(P)),M(ie(ee)),M(te(we)),M(ie(De)),M(te(Fe)),M(ie(rt)),"c"].join(" ")),this};v.__private__.line=v.line=function(P,ee,we,De,Fe){if(isNaN(P)||isNaN(ee)||isNaN(we)||isNaN(De)||!kr(Fe))throw new Error("Invalid arguments passed to jsPDF.line");return B===$?this.lines([[we-P,De-ee]],P,ee,[1,1],Fe||"S"):this.lines([[we-P,De-ee]],P,ee,[1,1]).stroke()},v.__private__.lines=v.lines=function(P,ee,we,De,Fe,rt){var mt,Vt,mn,hn,Jn,vi,Us,Ni,Wi,Ei,ks,as;if(typeof P=="number"&&(as=we,we=ee,ee=P,P=as),De=De||[1,1],rt=rt||!1,isNaN(ee)||isNaN(we)||!Array.isArray(P)||!Array.isArray(De)||!kr(Fe)||typeof rt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Al(ee,we),mt=De[0],Vt=De[1],hn=P.length,Ei=ee,ks=we,mn=0;mn<hn;mn++)(Jn=P[mn]).length===2?(Ei=Jn[0]*mt+Ei,ks=Jn[1]*Vt+ks,Xa(Ei,ks)):(vi=Jn[0]*mt+Ei,Us=Jn[1]*Vt+ks,Ni=Jn[2]*mt+Ei,Wi=Jn[3]*Vt+ks,Ei=Jn[4]*mt+Ei,ks=Jn[5]*Vt+ks,Ea(vi,Us,Ni,Wi,Ei,ks));return rt&&Ya(),na(Fe),this},v.path=function(P){for(var ee=0;ee<P.length;ee++){var we=P[ee],De=we.c;switch(we.op){case"m":Al(De[0],De[1]);break;case"l":Xa(De[0],De[1]);break;case"c":Ea.apply(this,De);break;case"h":Ya()}}return this},v.__private__.rect=v.rect=function(P,ee,we,De,Fe){if(isNaN(P)||isNaN(ee)||isNaN(we)||isNaN(De)||!kr(Fe))throw new Error("Invalid arguments passed to jsPDF.rect");return B===$&&(De=-De),pe([M(te(P)),M(ie(ee)),M(te(we)),M(te(De)),"re"].join(" ")),na(Fe),this},v.__private__.triangle=v.triangle=function(P,ee,we,De,Fe,rt,mt){if(isNaN(P)||isNaN(ee)||isNaN(we)||isNaN(De)||isNaN(Fe)||isNaN(rt)||!kr(mt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[we-P,De-ee],[Fe-we,rt-De],[P-Fe,ee-rt]],P,ee,[1,1],mt,!0),this},v.__private__.roundedRect=v.roundedRect=function(P,ee,we,De,Fe,rt,mt){if(isNaN(P)||isNaN(ee)||isNaN(we)||isNaN(De)||isNaN(Fe)||isNaN(rt)||!kr(mt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Vt=4/3*(Math.SQRT2-1);return Fe=Math.min(Fe,.5*we),rt=Math.min(rt,.5*De),this.lines([[we-2*Fe,0],[Fe*Vt,0,Fe,rt-rt*Vt,Fe,rt],[0,De-2*rt],[0,rt*Vt,-Fe*Vt,rt,-Fe,rt],[2*Fe-we,0],[-Fe*Vt,0,-Fe,-rt*Vt,-Fe,-rt],[0,2*rt-De],[0,-rt*Vt,Fe*Vt,-rt,Fe,-rt]],P+Fe,ee,[1,1],mt,!0),this},v.__private__.ellipse=v.ellipse=function(P,ee,we,De,Fe){if(isNaN(P)||isNaN(ee)||isNaN(we)||isNaN(De)||!kr(Fe))throw new Error("Invalid arguments passed to jsPDF.ellipse");var rt=4/3*(Math.SQRT2-1)*we,mt=4/3*(Math.SQRT2-1)*De;return Al(P+we,ee),Ea(P+we,ee-mt,P+rt,ee-De,P,ee-De),Ea(P-rt,ee-De,P-we,ee-mt,P-we,ee),Ea(P-we,ee+mt,P-rt,ee+De,P,ee+De),Ea(P+rt,ee+De,P+we,ee+mt,P+we,ee),na(Fe),this},v.__private__.circle=v.circle=function(P,ee,we,De){if(isNaN(P)||isNaN(ee)||isNaN(we)||!kr(De))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(P,ee,we,we,De)},v.setFont=function(P,ee,we){return we&&(ee=X(ee,we)),_t=td(P,ee,{disableWarning:!1}),this};var co=v.__private__.getFont=v.getFont=function(){return on[td.apply(v,arguments)]};v.__private__.getFontList=v.getFontList=function(){var P,ee,we={};for(P in Sn)if(Sn.hasOwnProperty(P))for(ee in we[P]=[],Sn[P])Sn[P].hasOwnProperty(ee)&&we[P].push(ee);return we},v.addFont=function(P,ee,we,De,Fe){var rt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&rt.indexOf(arguments[3])!==-1?Fe=arguments[3]:arguments[3]&&rt.indexOf(arguments[3])==-1&&(we=X(we,De)),Qo.call(this,P,ee,we,Fe=Fe||"Identity-H")};var rs,es=r.lineWidth||.200025,Po=v.__private__.getLineWidth=v.getLineWidth=function(){return es},In=v.__private__.setLineWidth=v.setLineWidth=function(P){return es=P,pe(M(te(P))+" w"),this};v.__private__.setLineDash=jn.API.setLineDash=jn.API.setLineDashPattern=function(P,ee){if(P=P||[],ee=ee||0,isNaN(ee)||!Array.isArray(P))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return P=P.map(function(we){return M(te(we))}).join(" "),ee=M(te(ee)),pe("["+P+"] "+ee+" d"),this};var ti=v.__private__.getLineHeight=v.getLineHeight=function(){return at*rs};v.__private__.getLineHeight=v.getLineHeight=function(){return at*rs};var Tn=v.__private__.setLineHeightFactor=v.setLineHeightFactor=function(P){return typeof(P=P||1.15)=="number"&&(rs=P),this},Hc=v.__private__.getLineHeightFactor=v.getLineHeightFactor=function(){return rs};Tn(r.lineHeight);var xa=v.__private__.getHorizontalCoordinate=function(P){return te(P)},ln=v.__private__.getVerticalCoordinate=function(P){return B===z?P:yn[H].mediaBox.topRightY-yn[H].mediaBox.bottomLeftY-te(P)},Cn=v.__private__.getHorizontalCoordinateString=v.getHorizontalCoordinateString=function(P){return M(xa(P))},ri=v.__private__.getVerticalCoordinateString=v.getVerticalCoordinateString=function(P){return M(ln(P))},tn=r.strokeColor||"0 G";v.__private__.getStrokeColor=v.getDrawColor=function(){return Si(tn)},v.__private__.setStrokeColor=v.setDrawColor=function(P,ee,we,De){return tn=Cr({ch1:P,ch2:ee,ch3:we,ch4:De,pdfColorType:"draw",precision:2}),pe(tn),this};var ai=r.fillColor||"0 g";v.__private__.getFillColor=v.getFillColor=function(){return Si(ai)},v.__private__.setFillColor=v.setFillColor=function(P,ee,we,De){return ai=Cr({ch1:P,ch2:ee,ch3:we,ch4:De,pdfColorType:"fill",precision:2}),pe(ai),this};var pn=r.textColor||"0 g",Zd=v.__private__.getTextColor=v.getTextColor=function(){return Si(pn)};v.__private__.setTextColor=v.setTextColor=function(P,ee,we,De){return pn=Cr({ch1:P,ch2:ee,ch3:we,ch4:De,pdfColorType:"text",precision:3}),this};var It=r.charSpace,Pi=v.__private__.getCharSpace=v.getCharSpace=function(){return parseFloat(It||0)};v.__private__.setCharSpace=v.setCharSpace=function(P){if(isNaN(P))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return It=P,this};var Yt=0;v.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},v.__private__.setLineCap=v.setLineCap=function(P){var ee=v.CapJoinStyles[P];if(ee===void 0)throw new Error("Line cap style of '"+P+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Yt=ee,pe(ee+" J"),this};var Gn=0;v.__private__.setLineJoin=v.setLineJoin=function(P){var ee=v.CapJoinStyles[P];if(ee===void 0)throw new Error("Line join style of '"+P+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Gn=ee,pe(ee+" j"),this},v.__private__.setLineMiterLimit=v.__private__.setMiterLimit=v.setLineMiterLimit=v.setMiterLimit=function(P){if(P=P||0,isNaN(P))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return pe(M(te(P))+" M"),this},v.GState=Zg,v.setGState=function(P){(P=typeof P=="string"?Gt[An[P]]:Ur(null,P)).equals(Vi)||(pe("/"+P.id+" gs"),Vi=P)};var Ur=function(P,ee){if(!P||!An[P]){var we=!1;for(var De in Gt)if(Gt.hasOwnProperty(De)&&Gt[De].equals(ee)){we=!0;break}if(we)ee=Gt[De];else{var Fe="GS"+(Object.keys(Gt).length+1).toString(10);Gt[Fe]=ee,ee.id=Fe}return P&&(An[P]=ee.id),Kt.publish("addGState",ee),ee}};v.addGState=function(P,ee){return Ur(P,ee),this},v.saveGraphicsState=function(){return pe("q"),lt.push({key:_t,size:at,color:pn}),this},v.restoreGraphicsState=function(){pe("Q");var P=lt.pop();return _t=P.key,at=P.size,pn=P.color,Vi=null,this},v.setCurrentTransformationMatrix=function(P){return pe(P.toString()+" cm"),this},v.comment=function(P){return pe("#"+P),this};var Ka=function(P,ee){var we=P||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return we},set:function(rt){isNaN(rt)||(we=parseFloat(rt))}});var De=ee||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return De},set:function(rt){isNaN(rt)||(De=parseFloat(rt))}});var Fe="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Fe},set:function(rt){Fe=rt.toString()}}),this},Zs=function(P,ee,we,De){Ka.call(this,P,ee),this.type="rect";var Fe=we||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Fe},set:function(mt){isNaN(mt)||(Fe=parseFloat(mt))}});var rt=De||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return rt},set:function(mt){isNaN(mt)||(rt=parseFloat(mt))}}),this},rl=function(){this.page=qn,this.currentPage=H,this.pages=Je.slice(0),this.pagesContext=yn.slice(0),this.x=Jt,this.y=zn,this.matrix=Nn,this.width=al(H),this.height=Kl(H),this.outputDestination=yt,this.id="",this.objectNumber=-1};rl.prototype.restore=function(){qn=this.page,H=this.currentPage,yn=this.pagesContext,Je=this.pages,Jt=this.x,zn=this.y,Nn=this.matrix,vc(H,this.width),Tl(H,this.height),yt=this.outputDestination};var Ra=function(P,ee,we,De,Fe){Br.push(new rl),qn=H=0,Je=[],Jt=P,zn=ee,Nn=Fe,ma([we,De])};for(var Za in v.beginFormObject=function(P,ee,we,De,Fe){return Ra(P,ee,we,De,Fe),this},v.endFormObject=function(P){return(function(ee){if(Ir[ee])Br.pop().restore();else{var we=new rl,De="Xo"+(Object.keys(Ks).length+1).toString(10);we.id=De,Ir[ee]=De,Ks[De]=we,Kt.publish("addFormObject",we),Br.pop().restore()}})(P),this},v.doFormObject=function(P,ee){var we=Ks[Ir[P]];return pe("q"),pe(ee.toString()+" cm"),pe("/"+we.id+" Do"),pe("Q"),this},v.getFormObject=function(P){var ee=Ks[Ir[P]];return{x:ee.x,y:ee.y,width:ee.width,height:ee.height,matrix:ee.matrix}},v.save=function(P,ee){return P=P||"generated.pdf",(ee=ee||{}).returnPromise=ee.returnPromise||!1,ee.returnPromise===!1?(ih(Fs(Ga()),P),typeof ih.unload=="function"&&Qn.setTimeout&&setTimeout(ih.unload,911),this):new Promise(function(we,De){try{var Fe=ih(Fs(Ga()),P);typeof ih.unload=="function"&&Qn.setTimeout&&setTimeout(ih.unload,911),we(Fe)}catch(rt){De(rt.message)}})},jn.API)jn.API.hasOwnProperty(Za)&&(Za==="events"&&jn.API.events.length?(function(P,ee){var we,De,Fe;for(Fe=ee.length-1;Fe!==-1;Fe--)we=ee[Fe][0],De=ee[Fe][1],P.subscribe.apply(P,[we].concat(typeof De=="function"?[De]:De))})(Kt,jn.API.events):v[Za]=jn.API[Za]);function al(P){return yn[P].mediaBox.topRightX-yn[P].mediaBox.bottomLeftX}function vc(P,ee){yn[P].mediaBox.topRightX=ee+yn[P].mediaBox.bottomLeftX}function Kl(P){return yn[P].mediaBox.topRightY-yn[P].mediaBox.bottomLeftY}function Tl(P,ee){yn[P].mediaBox.topRightY=ee+yn[P].mediaBox.bottomLeftY}var Eo=v.getPageWidth=function(P){return al(P=P||H)/On},Jd=v.setPageWidth=function(P,ee){vc(P,ee*On)},gn=v.getPageHeight=function(P){return Kl(P=P||H)/On},Ro=v.setPageHeight=function(P,ee){Tl(P,ee*On)};return v.internal={pdfEscape:pi,getStyle:sl,getFont:co,getFontSize:Ot,getCharSpace:Pi,getTextColor:Zd,getLineHeight:ti,getLineHeightFactor:Hc,getLineWidth:Po,write:St,getHorizontalCoordinate:xa,getVerticalCoordinate:ln,getCoordinateString:Cn,getVerticalCoordinateString:ri,collections:{},newObject:fi,newAdditionalObject:Ji,newObjectDeferred:ei,newObjectDeferredBegin:vs,getFilters:pa,putStream:qa,events:Kt,scaleFactor:On,pageSize:{getWidth:function(){return Eo(H)},setWidth:function(P){Jd(H,P)},getHeight:function(){return gn(H)},setHeight:function(P){Ro(H,P)}},encryptionOptions:m,encryption:Vn,getEncryptor:function(P){return m!==null?Vn.encryptor(P,0):function(ee){return ee}},output:_r,getNumberOfPages:$a,get pages(){return Je},out:pe,f2:_,f3:N,getPageInfo:bi,getPageInfoByObjId:Xl,getCurrentPageInfo:bc,getPDFVersion:x,Point:Ka,Rectangle:Zs,Matrix:Zt,hasHotfix:us},Object.defineProperty(v.internal.pageSize,"width",{get:function(){return Eo(H)},set:function(P){Jd(H,P)},enumerable:!0,configurable:!0}),Object.defineProperty(v.internal.pageSize,"height",{get:function(){return gn(H)},set:function(P){Ro(H,P)},enumerable:!0,configurable:!0}),(function(P){for(var ee=0,we=Lt.length;ee<we;ee++){var De=Qo.call(this,P[ee][0],P[ee][1],P[ee][2],Lt[ee][3],!0);b===!1&&(A[De]=!0);var Fe=P[ee][0].split("-");En({id:De,fontName:Fe[0],fontStyle:Fe[1]||""})}Kt.publish("addFonts",{fonts:on,dictionary:Sn})}).call(v,Lt),_t="F1",Pa(s,t),Kt.publish("initialized"),v}tf.prototype.lsbFirstWord=function(r){return String.fromCharCode(255&r,r>>8&255,r>>16&255,r>>24&255)},tf.prototype.toHexString=function(r){return r.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},tf.prototype.hexToBytes=function(r){for(var e=[],t=0;t<r.length;t+=2)e.push(String.fromCharCode(parseInt(r.substr(t,2),16)));return e.join("")},tf.prototype.processOwnerPassword=function(r,e){return Km(Xm(e).substr(0,5),r)},tf.prototype.encryptor=function(r,e){var t=Xm(this.encryptionKey+String.fromCharCode(255&r,r>>8&255,r>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return Km(t,n)}},Zg.prototype.equals=function(r){var e,t="id,objectNumber,equals";if(!r||Rs(r)!==Rs(this))return!1;var n=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!r.hasOwnProperty(e)||this[e]!==r[e])return!1;n++}for(e in r)r.hasOwnProperty(e)&&t.indexOf(e)<0&&n--;return n===0},jn.API={events:[]},jn.version="3.0.4";var ea=jn.API,vy=1,gh=function(r){return r.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Zh=function(r){return r.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},di=function(r){return r.toFixed(2)},Nu=function(r){return r.toFixed(5)};ea.__acroform__={};var Gl=function(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r},sb=function(r){return r*vy},Sd=function(r){var e=new F2,t=fn.internal.getHeight(r)||0,n=fn.internal.getWidth(r)||0;return e.BBox=[0,0,Number(di(n)),Number(di(t))],e},PA=ea.__acroform__.setBit=function(r,e){if(r=r||0,e=e||0,isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return r|1<<e},EA=ea.__acroform__.clearBit=function(r,e){if(r=r||0,e=e||0,isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return r&~(1<<e)},RA=ea.__acroform__.getBit=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return r&1<<e?1:0},da=ea.__acroform__.getBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return RA(r,e-1)},ua=ea.__acroform__.setBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return PA(r,e-1)},ha=ea.__acroform__.clearBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return EA(r,e-1)},DA=ea.__acroform__.calculateCoordinates=function(r,e){var t=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,s=r[0],o=r[1],d=r[2],c=r[3],h={};return h.lowerLeft_X=t(s)||0,h.lowerLeft_Y=n(o+c)||0,h.upperRight_X=t(s+d)||0,h.upperRight_Y=n(o)||0,[Number(di(h.lowerLeft_X)),Number(di(h.lowerLeft_Y)),Number(di(h.upperRight_X)),Number(di(h.upperRight_Y))]},LA=function(r){if(r.appearanceStreamContent)return r.appearanceStreamContent;if(r.V||r.DV){var e=[],t=r._V||r.DV,n=Zm(r,t),s=r.scope.internal.getFont(r.fontName,r.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(r.scope.__private__.encodeColorString(r.color)),e.push("/"+s+" "+di(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var o=Sd(r);return o.scope=r.scope,o.stream=e.join(`
`),o}},Zm=function(r,e){var t=r.fontSize===0?r.maxFontSize:r.fontSize,n={text:"",fontSize:""},s=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");s=r.multiline?s.map(function(_){return _.split(`
`)}):s.map(function(_){return[_]});var o=t,d=fn.internal.getHeight(r)||0;d=d<0?-d:d;var c=fn.internal.getWidth(r)||0;c=c<0?-c:c;var h=function(_,N,te){if(_+1<s.length){var ie=N+" "+s[_+1][0];return _g(ie,r,te).width<=c-4}return!1};o++;e:for(;o>0;){e="",o--;var f,m,b=_g("3",r,o).height,A=r.multiline?d-o:(d-b)/2,v=A+=2,E=0,x=0,k=0;if(o<=0){e=`(...) Tj
`,e+="% Width of Text: "+_g(e,r,o=12).width+", FieldWidth:"+c+`
`;break}for(var j="",$=0,z=0;z<s.length;z++)if(s.hasOwnProperty(z)){var B=!1;if(s[z].length!==1&&k!==s[z].length-1){if((b+2)*($+2)+2>d)continue e;j+=s[z][k],B=!0,x=z,z--}else{j=(j+=s[z][k]+" ").substr(j.length-1)==" "?j.substr(0,j.length-1):j;var F=parseInt(z),I=h(F,j,o),X=z>=s.length-1;if(I&&!X){j+=" ",k=0;continue}if(I||X){if(X)x=F;else if(r.multiline&&(b+2)*($+2)+2>d)continue e}else{if(!r.multiline||(b+2)*($+2)+2>d)continue e;x=F}}for(var M="",G=E;G<=x;G++){var U=s[G];if(r.multiline){if(G===x){M+=U[k]+" ",k=(k+1)%U.length;continue}if(G===E){M+=U[U.length-1]+" ";continue}}M+=U[0]+" "}switch(M=M.substr(M.length-1)==" "?M.substr(0,M.length-1):M,m=_g(M,r,o).width,r.textAlign){case"right":f=c-m-2;break;case"center":f=(c-m)/2;break;default:f=2}e+=di(f)+" "+di(v)+` Td
`,e+="("+gh(M)+`) Tj
`,e+=-di(f)+` 0 Td
`,v=-(o+2),m=0,E=B?x:x+1,$++,j=""}break}return n.text=e,n.fontSize=o,n},_g=function(r,e,t){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),s=e.scope.getStringUnitWidth(r,{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:s}},MA={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},zA=function(r,e){var t={type:"reference",object:r};e.internal.getPageInfo(r.page).pageContext.annotations.find(function(n){return n.type===t.type&&n.object===t.object})===void 0&&e.internal.getPageInfo(r.page).pageContext.annotations.push(t)},IA=function(r,e){if(e.scope=r,r.internal!==void 0&&(r.internal.acroformPlugin===void 0||r.internal.acroformPlugin.isInitialized===!1)){if(Qc.FieldNum=0,r.internal.acroformPlugin=JSON.parse(JSON.stringify(MA)),r.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");vy=r.internal.scaleFactor,r.internal.acroformPlugin.acroFormDictionaryRoot=new U2,r.internal.acroformPlugin.acroFormDictionaryRoot.scope=r,r.internal.acroformPlugin.acroFormDictionaryRoot._eventID=r.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(r)}),r.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in n)if(n.hasOwnProperty(s)){var o=n[s];o.objId=void 0,o.hasAnnotation&&zA(o,t)}})(r)}),r.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(r)}),r.internal.events.subscribe("postPutPages",function(t){(function(n,s){var o=!n;for(var d in n||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(d)){var c=n[d],h=[],f=c.Rect;if(c.Rect&&(c.Rect=DA(c.Rect,s)),s.internal.newObjectDeferredBegin(c.objId,!0),c.DA=fn.createDefaultAppearanceStream(c),Rs(c)==="object"&&typeof c.getKeyValueListForStream=="function"&&(h=c.getKeyValueListForStream()),c.Rect=f,c.hasAppearanceStream&&!c.appearanceStreamContent){var m=LA(c);h.push({key:"AP",value:"<</N "+m+">>"}),s.internal.acroformPlugin.xForms.push(m)}if(c.appearanceStreamContent){var b="";for(var A in c.appearanceStreamContent)if(c.appearanceStreamContent.hasOwnProperty(A)){var v=c.appearanceStreamContent[A];if(b+="/"+A+" ",b+="<<",Object.keys(v).length>=1||Array.isArray(v)){for(var d in v)if(v.hasOwnProperty(d)){var E=v[d];typeof E=="function"&&(E=E.call(s,c)),b+="/"+d+" "+E+" ",s.internal.acroformPlugin.xForms.indexOf(E)>=0||s.internal.acroformPlugin.xForms.push(E)}}else typeof(E=v)=="function"&&(E=E.call(s,c)),b+="/"+d+" "+E,s.internal.acroformPlugin.xForms.indexOf(E)>=0||s.internal.acroformPlugin.xForms.push(E);b+=">>"}h.push({key:"AP",value:`<<
`+b+">>"})}s.internal.putStream({additionalKeyValues:h,objectId:c.objId}),s.internal.out("endobj")}o&&(function(x,k){for(var j in x)if(x.hasOwnProperty(j)){var $=j,z=x[j];k.internal.newObjectDeferredBegin(z.objId,!0),Rs(z)==="object"&&typeof z.putStream=="function"&&z.putStream(),delete x[$]}})(s.internal.acroformPlugin.xForms,s)})(t,r)}),r.internal.acroformPlugin.isInitialized=!0}},O2=ea.__acroform__.arrayToPdfArray=function(r,e,t){var n=function(d){return d};if(Array.isArray(r)){for(var s="[",o=0;o<r.length;o++)switch(o!==0&&(s+=" "),Rs(r[o])){case"boolean":case"number":case"object":s+=r[o].toString();break;case"string":r[o].substr(0,1)!=="/"?(e!==void 0&&t&&(n=t.internal.getEncryptor(e)),s+="("+gh(n(r[o].toString()))+")"):s+=r[o].toString()}return s+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Am=function(r,e,t){var n=function(s){return s};return e!==void 0&&t&&(n=t.internal.getEncryptor(e)),(r=r||"").toString(),"("+gh(n(r))+")"},Cd=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(r){this._objId=r}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Cd.prototype.toString=function(){return this.objId+" 0 R"},Cd.prototype.putStream=function(){var r=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:r,objectId:this.objId}),this.scope.internal.out("endobj")},Cd.prototype.getKeyValueListForStream=function(){var r=[],e=Object.getOwnPropertyNames(this).filter(function(o){return o!="content"&&o!="appearanceStreamContent"&&o!="scope"&&o!="objId"&&o.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var n=e[t],s=this[n];s&&(Array.isArray(s)?r.push({key:n,value:O2(s,this.objId,this.scope)}):s instanceof Cd?(s.scope=this.scope,r.push({key:n,value:s.objId+" 0 R"})):typeof s!="function"&&r.push({key:n,value:s}))}return r};var F2=function(){Cd.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var r,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){r=t.trim()},get:function(){return r||null}})};Gl(F2,Cd);var U2=function(){Cd.call(this);var r,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(r){var t=function(n){return n};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+gh(t(r))+")"}},set:function(t){r=t}})};Gl(U2,Cd);var Qc=function r(){Cd.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(j){if(isNaN(j))throw new Error('Invalid value "'+j+'" for attribute F supplied.');e=j}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!da(e,3)},set:function(j){j?this.F=ua(e,3):this.F=ha(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(j){if(isNaN(j))throw new Error('Invalid value "'+j+'" for attribute Ff supplied.');t=j}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(j){n=j!==void 0?j:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(j){n[0]=j}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(j){n[1]=j}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(j){n[2]=j}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(j){n[3]=j}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(j){switch(j){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=j;break;default:throw new Error('Invalid value "'+j+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof Jg)return;o="FieldObject"+r.FieldNum++}var j=function($){return $};return this.scope&&(j=this.scope.internal.getEncryptor(this.objId)),"("+gh(j(o))+")"},set:function(j){o=j.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(j){o=j}});var d="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return d},set:function(j){d=j}});var c="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return c},set:function(j){c=j}});var h=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return h},set:function(j){h=j}});var f=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return f===void 0?50/vy:f},set:function(j){f=j}});var m="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return m},set:function(j){m=j}});var b="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!b||this instanceof Jg||this instanceof ch))return Am(b,this.objId,this.scope)},set:function(j){j=j.toString(),b=j}});var A=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(A)return this instanceof lo==0?Am(A,this.objId,this.scope):A},set:function(j){j=j.toString(),A=this instanceof lo==0?j.substr(0,1)==="("?Zh(j.substr(1,j.length-2)):Zh(j):j}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof lo==1?Zh(A.substr(1,A.length-1)):A},set:function(j){j=j.toString(),A=this instanceof lo==1?"/"+j:j}});var v=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(v)return v},set:function(j){this.V=j}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(v)return this instanceof lo==0?Am(v,this.objId,this.scope):v},set:function(j){j=j.toString(),v=this instanceof lo==0?j.substr(0,1)==="("?Zh(j.substr(1,j.length-2)):Zh(j):j}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof lo==1?Zh(v.substr(1,v.length-1)):v},set:function(j){j=j.toString(),v=this instanceof lo==1?"/"+j:j}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var E,x=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return x},set:function(j){j=!!j,x=j}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(E)return E},set:function(j){E=j}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,1)},set:function(j){j?this.Ff=ua(this.Ff,1):this.Ff=ha(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,2)},set:function(j){j?this.Ff=ua(this.Ff,2):this.Ff=ha(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,3)},set:function(j){j?this.Ff=ua(this.Ff,3):this.Ff=ha(this.Ff,3)}});var k=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(k!==null)return k},set:function(j){if([0,1,2].indexOf(j)===-1)throw new Error('Invalid value "'+j+'" for attribute Q supplied.');k=j}}),Object.defineProperty(this,"textAlign",{get:function(){var j;switch(k){case 0:default:j="left";break;case 1:j="center";break;case 2:j="right"}return j},configurable:!0,enumerable:!0,set:function(j){switch(j){case"right":case 2:k=2;break;case"center":case 1:k=1;break;default:k=0}}})};Gl(Qc,Cd);var uf=function(){Qc.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var r=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return r},set:function(t){r=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return O2(e,this.objId,this.scope)},set:function(t){var n,s;s=[],typeof(n=t)=="string"&&(s=(function(o,d,c){c||(c=1);for(var h,f=[];h=d.exec(o);)f.push(h[c]);return f})(n,/\((.*?)\)/g)),e=s}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,n){for(n=n||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,18)},set:function(t){t?this.Ff=ua(this.Ff,18):this.Ff=ha(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=ua(this.Ff,19):this.Ff=ha(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,20)},set:function(t){t?(this.Ff=ua(this.Ff,20),e.sort()):this.Ff=ha(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,22)},set:function(t){t?this.Ff=ua(this.Ff,22):this.Ff=ha(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,23)},set:function(t){t?this.Ff=ua(this.Ff,23):this.Ff=ha(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,27)},set:function(t){t?this.Ff=ua(this.Ff,27):this.Ff=ha(this.Ff,27)}}),this.hasAppearanceStream=!1};Gl(uf,Qc);var hf=function(){uf.call(this),this.fontName="helvetica",this.combo=!1};Gl(hf,uf);var ff=function(){hf.call(this),this.combo=!0};Gl(ff,hf);var Ug=function(){ff.call(this),this.edit=!0};Gl(Ug,ff);var lo=function(){Qc.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,15)},set:function(t){t?this.Ff=ua(this.Ff,15):this.Ff=ha(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,16)},set:function(t){t?this.Ff=ua(this.Ff,16):this.Ff=ha(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,17)},set:function(t){t?this.Ff=ua(this.Ff,17):this.Ff=ha(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,26)},set:function(t){t?this.Ff=ua(this.Ff,26):this.Ff=ha(this.Ff,26)}});var r,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(o){return o};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,s=[];for(n in s.push("<<"),e)s.push("/"+n+" ("+gh(t(e[n]))+")");return s.push(">>"),s.join(`
`)}},set:function(t){Rs(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(t){r="/"+t}})};Gl(lo,Qc);var Hg=function(){lo.call(this),this.pushButton=!0};Gl(Hg,lo);var pf=function(){lo.call(this),this.radio=!0,this.pushButton=!1;var r=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e!==void 0?e:[]}})};Gl(pf,lo);var Jg=function(){var r,e;Qc.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return r},set:function(s){r=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(s){e=s}});var t,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(c){return c};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var o,d=[];for(o in d.push("<<"),n)d.push("/"+o+" ("+gh(s(n[o]))+")");return d.push(">>"),d.join(`
`)},set:function(s){Rs(s)==="object"&&(n=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(s){typeof s=="string"&&(n.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(s){t=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(s){t="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=fn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Gl(Jg,Qc),pf.prototype.setAppearance=function(r){if(!("createAppearanceStream"in r)||!("getCA"in r))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=r.createAppearanceStream(t.optionName),t.caption=r.getCA()}},pf.prototype.createOption=function(r){var e=new Jg;return e.Parent=this,e.optionName=r,this.Kids.push(e),BA.call(this.scope,e),e};var qg=function(){lo.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=fn.CheckBox.createAppearanceStream()};Gl(qg,lo);var ch=function(){Qc.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,13)},set:function(e){e?this.Ff=ua(this.Ff,13):this.Ff=ha(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,21)},set:function(e){e?this.Ff=ua(this.Ff,21):this.Ff=ha(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,23)},set:function(e){e?this.Ff=ua(this.Ff,23):this.Ff=ha(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,24)},set:function(e){e?this.Ff=ua(this.Ff,24):this.Ff=ha(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,25)},set:function(e){e?this.Ff=ua(this.Ff,25):this.Ff=ha(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,26)},set:function(e){e?this.Ff=ua(this.Ff,26):this.Ff=ha(this.Ff,26)}});var r=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return r},set:function(e){Number.isInteger(e)&&(r=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Gl(ch,Qc);var Vg=function(){ch.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!da(this.Ff,14)},set:function(r){r?this.Ff=ua(this.Ff,14):this.Ff=ha(this.Ff,14)}}),this.password=!0};Gl(Vg,ch);var fn={CheckBox:{createAppearanceStream:function(){return{N:{On:fn.CheckBox.YesNormal},D:{On:fn.CheckBox.YesPushDown,Off:fn.CheckBox.OffPushDown}}},YesPushDown:function(r){var e=Sd(r);e.scope=r.scope;var t=[],n=r.scope.internal.getFont(r.fontName,r.fontStyle).id,s=r.scope.__private__.encodeColorString(r.color),o=Zm(r,r.caption);return t.push("0.749023 g"),t.push("0 0 "+di(fn.internal.getWidth(r))+" "+di(fn.internal.getHeight(r))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+n+" "+di(o.fontSize)+" Tf "+s),t.push("BT"),t.push(o.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(r){var e=Sd(r);e.scope=r.scope;var t=r.scope.internal.getFont(r.fontName,r.fontStyle).id,n=r.scope.__private__.encodeColorString(r.color),s=[],o=fn.internal.getHeight(r),d=fn.internal.getWidth(r),c=Zm(r,r.caption);return s.push("1 g"),s.push("0 0 "+di(d)+" "+di(o)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+di(d-1)+" "+di(o-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+t+" "+di(c.fontSize)+" Tf "+n),s.push(c.text),s.push("ET"),s.push("Q"),e.stream=s.join(`
`),e},OffPushDown:function(r){var e=Sd(r);e.scope=r.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+di(fn.internal.getWidth(r))+" "+di(fn.internal.getHeight(r))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(r){var e={D:{Off:fn.RadioButton.Circle.OffPushDown},N:{}};return e.N[r]=fn.RadioButton.Circle.YesNormal,e.D[r]=fn.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(r){var e=Sd(r);e.scope=r.scope;var t=[],n=fn.internal.getWidth(r)<=fn.internal.getHeight(r)?fn.internal.getWidth(r)/4:fn.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var s=fn.internal.Bezier_C,o=Number((n*s).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+Nu(fn.internal.getWidth(r)/2)+" "+Nu(fn.internal.getHeight(r)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),t.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),t.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),t.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(r){var e=Sd(r);e.scope=r.scope;var t=[],n=fn.internal.getWidth(r)<=fn.internal.getHeight(r)?fn.internal.getWidth(r)/4:fn.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),o=Number((s*fn.internal.Bezier_C).toFixed(5)),d=Number((n*fn.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Nu(fn.internal.getWidth(r)/2)+" "+Nu(fn.internal.getHeight(r)/2)+" cm"),t.push(s+" 0 m"),t.push(s+" "+o+" "+o+" "+s+" 0 "+s+" c"),t.push("-"+o+" "+s+" -"+s+" "+o+" -"+s+" 0 c"),t.push("-"+s+" -"+o+" -"+o+" -"+s+" 0 -"+s+" c"),t.push(o+" -"+s+" "+s+" -"+o+" "+s+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+Nu(fn.internal.getWidth(r)/2)+" "+Nu(fn.internal.getHeight(r)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+d+" "+d+" "+n+" 0 "+n+" c"),t.push("-"+d+" "+n+" -"+n+" "+d+" -"+n+" 0 c"),t.push("-"+n+" -"+d+" -"+d+" -"+n+" 0 -"+n+" c"),t.push(d+" -"+n+" "+n+" -"+d+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(r){var e=Sd(r);e.scope=r.scope;var t=[],n=fn.internal.getWidth(r)<=fn.internal.getHeight(r)?fn.internal.getWidth(r)/4:fn.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),o=Number((s*fn.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Nu(fn.internal.getWidth(r)/2)+" "+Nu(fn.internal.getHeight(r)/2)+" cm"),t.push(s+" 0 m"),t.push(s+" "+o+" "+o+" "+s+" 0 "+s+" c"),t.push("-"+o+" "+s+" -"+s+" "+o+" -"+s+" 0 c"),t.push("-"+s+" -"+o+" -"+o+" -"+s+" 0 -"+s+" c"),t.push(o+" -"+s+" "+s+" -"+o+" "+s+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(r){var e={D:{Off:fn.RadioButton.Cross.OffPushDown},N:{}};return e.N[r]=fn.RadioButton.Cross.YesNormal,e.D[r]=fn.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(r){var e=Sd(r);e.scope=r.scope;var t=[],n=fn.internal.calculateCross(r);return t.push("q"),t.push("1 1 "+di(fn.internal.getWidth(r)-2)+" "+di(fn.internal.getHeight(r)-2)+" re"),t.push("W"),t.push("n"),t.push(di(n.x1.x)+" "+di(n.x1.y)+" m"),t.push(di(n.x2.x)+" "+di(n.x2.y)+" l"),t.push(di(n.x4.x)+" "+di(n.x4.y)+" m"),t.push(di(n.x3.x)+" "+di(n.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(r){var e=Sd(r);e.scope=r.scope;var t=fn.internal.calculateCross(r),n=[];return n.push("0.749023 g"),n.push("0 0 "+di(fn.internal.getWidth(r))+" "+di(fn.internal.getHeight(r))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+di(fn.internal.getWidth(r)-2)+" "+di(fn.internal.getHeight(r)-2)+" re"),n.push("W"),n.push("n"),n.push(di(t.x1.x)+" "+di(t.x1.y)+" m"),n.push(di(t.x2.x)+" "+di(t.x2.y)+" l"),n.push(di(t.x4.x)+" "+di(t.x4.y)+" m"),n.push(di(t.x3.x)+" "+di(t.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(r){var e=Sd(r);e.scope=r.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+di(fn.internal.getWidth(r))+" "+di(fn.internal.getHeight(r))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(r){var e=r.scope.internal.getFont(r.fontName,r.fontStyle).id,t=r.scope.__private__.encodeColorString(r.color);return"/"+e+" "+r.fontSize+" Tf "+t}};fn.internal={Bezier_C:.551915024494,calculateCross:function(r){var e=fn.internal.getWidth(r),t=fn.internal.getHeight(r),n=Math.min(e,t);return{x1:{x:(e-n)/2,y:(t-n)/2+n},x2:{x:(e-n)/2+n,y:(t-n)/2},x3:{x:(e-n)/2,y:(t-n)/2},x4:{x:(e-n)/2+n,y:(t-n)/2+n}}}},fn.internal.getWidth=function(r){var e=0;return Rs(r)==="object"&&(e=sb(r.Rect[2])),e},fn.internal.getHeight=function(r){var e=0;return Rs(r)==="object"&&(e=sb(r.Rect[3])),e};var BA=ea.addField=function(r){if(IA(this,r),!(r instanceof Qc))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=r).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),r.page=r.scope.internal.getCurrentPageInfo().pageNumber,this};ea.AcroFormChoiceField=uf,ea.AcroFormListBox=hf,ea.AcroFormComboBox=ff,ea.AcroFormEditBox=Ug,ea.AcroFormButton=lo,ea.AcroFormPushButton=Hg,ea.AcroFormRadioButton=pf,ea.AcroFormCheckBox=qg,ea.AcroFormTextField=ch,ea.AcroFormPasswordField=Vg,ea.AcroFormAppearance=fn,ea.AcroForm={ChoiceField:uf,ListBox:hf,ComboBox:ff,EditBox:Ug,Button:lo,PushButton:Hg,RadioButton:pf,CheckBox:qg,TextField:ch,PasswordField:Vg,Appearance:fn},jn.AcroForm={ChoiceField:uf,ListBox:hf,ComboBox:ff,EditBox:Ug,Button:lo,PushButton:Hg,RadioButton:pf,CheckBox:qg,TextField:ch,PasswordField:Vg,Appearance:fn};jn.AcroForm;function H2(r){return r.reduce(function(e,t,n){return e[t]=n,e},{})}(function(r){var e="addImage_";r.__addimage__={};var t="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=r.__addimage__.getImageFileTypeByImageData=function(_,N){var te,ie,re,q,J,ce=t;if((N=N||t)==="RGBA"||_.data!==void 0&&_.data instanceof Uint8ClampedArray&&"height"in _&&"width"in _)return"RGBA";if(I(_))for(J in n)for(re=n[J],te=0;te<re.length;te+=1){for(q=!0,ie=0;ie<re[te].length;ie+=1)if(re[te][ie]!==void 0&&re[te][ie]!==_[ie]){q=!1;break}if(q===!0){ce=J;break}}else for(J in n)for(re=n[J],te=0;te<re.length;te+=1){for(q=!0,ie=0;ie<re[te].length;ie+=1)if(re[te][ie]!==void 0&&re[te][ie]!==_.charCodeAt(ie)){q=!1;break}if(q===!0){ce=J;break}}return ce===t&&N!==t&&(ce=N),ce},o=function _(N){for(var te=this.internal.write,ie=this.internal.putStream,re=(0,this.internal.getFilters)();re.indexOf("FlateEncode")!==-1;)re.splice(re.indexOf("FlateEncode"),1);N.objectId=this.internal.newObject();var q=[];if(q.push({key:"Type",value:"/XObject"}),q.push({key:"Subtype",value:"/Image"}),q.push({key:"Width",value:N.width}),q.push({key:"Height",value:N.height}),N.colorSpace===j.INDEXED?q.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(N.palette.length/3-1)+" "+("sMask"in N&&N.sMask!==void 0?N.objectId+2:N.objectId+1)+" 0 R]"}):(q.push({key:"ColorSpace",value:"/"+N.colorSpace}),N.colorSpace===j.DEVICE_CMYK&&q.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),q.push({key:"BitsPerComponent",value:N.bitsPerComponent}),"decodeParameters"in N&&N.decodeParameters!==void 0&&q.push({key:"DecodeParms",value:"<<"+N.decodeParameters+">>"}),"transparency"in N&&Array.isArray(N.transparency)&&N.transparency.length>0){for(var J="",ce=0,_e=N.transparency.length;ce<_e;ce++)J+=N.transparency[ce]+" "+N.transparency[ce]+" ";q.push({key:"Mask",value:"["+J+"]"})}N.sMask!==void 0&&q.push({key:"SMask",value:N.objectId+1+" 0 R"});var xe=N.filter!==void 0?["/"+N.filter]:void 0;if(ie({data:N.data,additionalKeyValues:q,alreadyAppliedFilters:xe,objectId:N.objectId}),te("endobj"),"sMask"in N&&N.sMask!==void 0){var Z,D=(Z=N.sMaskBitsPerComponent)!==null&&Z!==void 0?Z:N.bitsPerComponent,H={width:N.width,height:N.height,colorSpace:"DeviceGray",bitsPerComponent:D,data:N.sMask};"filter"in N&&(H.decodeParameters="/Predictor ".concat(N.predictor," /Colors 1 /BitsPerComponent ").concat(D," /Columns ").concat(N.width),H.filter=N.filter),_.call(this,H)}if(N.colorSpace===j.INDEXED){var Y=this.internal.newObject();ie({data:M(new Uint8Array(N.palette)),objectId:Y}),te("endobj")}},d=function(){var _=this.internal.collections[e+"images"];for(var N in _)o.call(this,_[N])},c=function(){var _,N=this.internal.collections[e+"images"],te=this.internal.write;for(var ie in N)te("/I"+(_=N[ie]).index,_.objectId,"0","R")},h=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",d),this.internal.events.subscribe("putXobjectDict",c))},f=function(){var _=this.internal.collections[e+"images"];return h.call(this),_},m=function(){return Object.keys(this.internal.collections[e+"images"]).length},b=function(_){return typeof r["process"+_.toUpperCase()]=="function"},A=function(_){return Rs(_)==="object"&&_.nodeType===1},v=function(_,N){if(_.nodeName==="IMG"&&_.hasAttribute("src")){var te=""+_.getAttribute("src");if(te.indexOf("data:image/")===0)return Fg(unescape(te).split("base64,").pop());var ie=r.loadFile(te,!0);if(ie!==void 0)return ie}if(_.nodeName==="CANVAS"){if(_.width===0||_.height===0)throw new Error("Given canvas must have data. Canvas width: "+_.width+", height: "+_.height);var re;switch(N){case"PNG":re="image/png";break;case"WEBP":re="image/webp";break;default:re="image/jpeg"}return Fg(_.toDataURL(re,1).split("base64,").pop())}},E=function(_){var N=this.internal.collections[e+"images"];if(N){for(var te in N)if(_===N[te].alias)return N[te]}},x=function(_,N,te){return _||N||(_=-96,N=-96),_<0&&(_=-1*te.width*72/_/this.internal.scaleFactor),N<0&&(N=-1*te.height*72/N/this.internal.scaleFactor),_===0&&(_=N*te.width/te.height),N===0&&(N=_*te.height/te.width),[_,N]},k=function(_,N,te,ie,re,q){var J=x.call(this,te,ie,re),ce=this.internal.getCoordinateString,_e=this.internal.getVerticalCoordinateString,xe=f.call(this);if(te=J[0],ie=J[1],xe[re.index]=re,q){q*=Math.PI/180;var Z=Math.cos(q),D=Math.sin(q),H=function(ue){return ue.toFixed(4)},Y=[H(Z),H(D),H(-1*D),H(Z),0,0,"cm"]}this.internal.write("q"),q?(this.internal.write([1,"0","0",1,ce(_),_e(N+ie),"cm"].join(" ")),this.internal.write(Y.join(" ")),this.internal.write([ce(te),"0","0",ce(ie),"0","0","cm"].join(" "))):this.internal.write([ce(te),"0","0",ce(ie),ce(_),_e(N+ie),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+re.index+" Do"),this.internal.write("Q")},j=r.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};r.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var $=r.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},z=r.__addimage__.sHashCode=function(_){var N,te,ie=0;if(typeof _=="string")for(te=_.length,N=0;N<te;N++)ie=(ie<<5)-ie+_.charCodeAt(N),ie|=0;else if(I(_))for(te=_.byteLength/2,N=0;N<te;N++)ie=(ie<<5)-ie+_[N],ie|=0;return ie},B=r.__addimage__.validateStringAsBase64=function(_){(_=_||"").toString().trim();var N=!0;return _.length===0&&(N=!1),_.length%4!=0&&(N=!1),/^[A-Za-z0-9+/]+$/.test(_.substr(0,_.length-2))===!1&&(N=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(_.substr(-2))===!1&&(N=!1),N},F=r.__addimage__.extractImageFromDataUrl=function(_){if(_==null||!(_=_.trim()).startsWith("data:"))return null;var N=_.indexOf(",");return N<0?null:_.substring(0,N).trim().endsWith("base64")?_.substring(N+1):null};r.__addimage__.isArrayBuffer=function(_){return _ instanceof ArrayBuffer};var I=r.__addimage__.isArrayBufferView=function(_){return _ instanceof Int8Array||_ instanceof Uint8Array||_ instanceof Uint8ClampedArray||_ instanceof Int16Array||_ instanceof Uint16Array||_ instanceof Int32Array||_ instanceof Uint32Array||_ instanceof Float32Array||_ instanceof Float64Array},X=r.__addimage__.binaryStringToUint8Array=function(_){for(var N=_.length,te=new Uint8Array(N),ie=0;ie<N;ie++)te[ie]=_.charCodeAt(ie);return te},M=r.__addimage__.arrayBufferToBinaryString=function(_){for(var N="",te=I(_)?_:new Uint8Array(_),ie=0;ie<te.length;ie+=8192)N+=String.fromCharCode.apply(null,te.subarray(ie,ie+8192));return N};r.addImage=function(){var _,N,te,ie,re,q,J,ce,_e;if(typeof arguments[1]=="number"?(N=t,te=arguments[1],ie=arguments[2],re=arguments[3],q=arguments[4],J=arguments[5],ce=arguments[6],_e=arguments[7]):(N=arguments[1],te=arguments[2],ie=arguments[3],re=arguments[4],q=arguments[5],J=arguments[6],ce=arguments[7],_e=arguments[8]),Rs(_=arguments[0])==="object"&&!A(_)&&"imageData"in _){var xe=_;_=xe.imageData,N=xe.format||N||t,te=xe.x||te||0,ie=xe.y||ie||0,re=xe.w||xe.width||re,q=xe.h||xe.height||q,J=xe.alias||J,ce=xe.compression||ce,_e=xe.rotation||xe.angle||_e}var Z=this.internal.getFilters();if(ce===void 0&&Z.indexOf("FlateEncode")!==-1&&(ce="SLOW"),isNaN(te)||isNaN(ie))throw new Error("Invalid coordinates passed to jsPDF.addImage");h.call(this);var D=G.call(this,_,N,J,ce);return k.call(this,te,ie,re,q,D,_e),this};var G=function(_,N,te,ie){var re,q,J;if(typeof _=="string"&&s(_)===t){_=unescape(_);var ce=U(_,!1);(ce!==""||(ce=r.loadFile(_,!0))!==void 0)&&(_=ce)}if(A(_)&&(_=v(_,N)),N=s(_,N),!b(N))throw new Error("addImage does not support files of type '"+N+"', please ensure that a plugin for '"+N+"' support is added.");if(((J=te)==null||J.length===0)&&(te=(function(_e){return typeof _e=="string"||I(_e)?z(_e):I(_e.data)?z(_e.data):null})(_)),(re=E.call(this,te))||(_ instanceof Uint8Array||N==="RGBA"||(q=_,_=X(_)),re=this["process"+N.toUpperCase()](_,m.call(this),te,(function(_e){return _e&&typeof _e=="string"&&(_e=_e.toUpperCase()),_e in r.image_compression?_e:$.NONE})(ie),q)),!re)throw new Error("An unknown error occurred whilst processing the image.");return re},U=r.__addimage__.convertBase64ToBinaryString=function(_,N){N=typeof N!="boolean"||N;var te,ie="";if(typeof _=="string"){var re;te=(re=F(_))!==null&&re!==void 0?re:_;try{ie=Fg(te)}catch(q){if(N)throw B(te)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+q.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return ie};r.getImageProperties=function(_){var N,te,ie="";if(A(_)&&(_=v(_)),typeof _=="string"&&s(_)===t&&((ie=U(_,!1))===""&&(ie=r.loadFile(_)||""),_=ie),te=s(_),!b(te))throw new Error("addImage does not support files of type '"+te+"', please ensure that a plugin for '"+te+"' support is added.");if(_ instanceof Uint8Array||(_=X(_)),!(N=this["process"+te.toUpperCase()](_)))throw new Error("An unknown error occurred whilst processing the image");return N.fileType=te,N}})(jn.API),(function(r){var e=function(t){if(t!==void 0&&t!="")return!0};jn.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),r.events.push(["putPage",function(t){for(var n,s,o,d=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString,h=this.internal.getPageInfoByObjId(t.objId),f=t.pageContext.annotations,m=!1,b=0;b<f.length&&!m;b++)switch((n=f[b]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(m=!0);break;case"reference":case"text":case"freetext":m=!0}if(m!=0){this.internal.write("/Annots [");for(var A=0;A<f.length;A++){n=f[A];var v=this.internal.pdfEscape,E=this.internal.getEncryptor(t.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var x=this.internal.newAdditionalObject(),k=this.internal.newAdditionalObject(),j=this.internal.getEncryptor(x.objId),$=n.title||"Note";o="<</Type /Annot /Subtype /Text "+(s="/Rect ["+d(n.bounds.x)+" "+c(n.bounds.y+n.bounds.h)+" "+d(n.bounds.x+n.bounds.w)+" "+c(n.bounds.y)+"] ")+"/Contents ("+v(j(n.contents))+")",o+=" /Popup "+k.objId+" 0 R",o+=" /P "+h.objId+" 0 R",o+=" /T ("+v(j($))+") >>",x.content=o;var z=x.objId+" 0 R";o="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+d(n.bounds.x+30)+" "+c(n.bounds.y+n.bounds.h)+" "+d(n.bounds.x+n.bounds.w+30)+" "+c(n.bounds.y)+"] ")+" /Parent "+z,n.open&&(o+=" /Open true"),o+=" >>",k.content=o,this.internal.write(x.objId,"0 R",k.objId,"0 R");break;case"freetext":s="/Rect ["+d(n.bounds.x)+" "+c(n.bounds.y)+" "+d(n.bounds.x+n.bounds.w)+" "+c(n.bounds.y+n.bounds.h)+"] ";var B=n.color||"#000000";o="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+v(E(n.contents))+")",o+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+B+")",o+=" /Border [0 0 0]",o+=" >>",this.internal.write(o);break;case"link":if(n.options.name){var F=this.annotations._nameMap[n.options.name];n.options.pageNumber=F.page,n.options.top=F.y}else n.options.top||(n.options.top=0);if(s="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",o="",n.options.url)o="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+v(E(n.options.url))+") >>";else if(n.options.pageNumber)switch(o="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":o+=" /Fit]";break;case"FitH":o+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,o+=" /FitV "+n.options.left+"]";break;default:var I=c(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),o+=" /XYZ "+n.options.left+" "+I+" "+n.options.zoom+"]"}o!=""&&(o+=" >>",this.internal.write(o))}}this.internal.write("]")}}]),r.createAnnotation=function(t){var n=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":n.pageContext.annotations.push(t)}},r.link=function(t,n,s,o,d){var c=this.internal.getCurrentPageInfo(),h=this.internal.getCoordinateString,f=this.internal.getVerticalCoordinateString;c.pageContext.annotations.push({finalBounds:{x:h(t),y:f(n),w:h(t+s),h:f(n+o)},options:d,type:"link"})},r.textWithLink=function(t,n,s,o){var d,c,h=this.getTextWidth(t),f=this.internal.getLineHeight()/this.internal.scaleFactor;if(o.maxWidth!==void 0){c=o.maxWidth;var m=this.splitTextToSize(t,c).length;d=Math.ceil(f*m)}else c=h,d=f;return this.text(t,n,s,o),s+=.2*f,o.align==="center"&&(n-=h/2),o.align==="right"&&(n-=h),this.link(n,s-f,c,d,o),h},r.getTextWidth=function(t){var n=this.internal.getFontSize();return this.getStringUnitWidth(t)*n/this.internal.scaleFactor}})(jn.API),(function(r){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];r.__arabicParser__={};var o=r.__arabicParser__.isInArabicSubstitutionA=function(x){return e[x.charCodeAt(0)]!==void 0},d=r.__arabicParser__.isArabicLetter=function(x){return typeof x=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(x)},c=r.__arabicParser__.isArabicEndLetter=function(x){return d(x)&&o(x)&&e[x.charCodeAt(0)].length<=2},h=r.__arabicParser__.isArabicAlfLetter=function(x){return d(x)&&s.indexOf(x.charCodeAt(0))>=0};r.__arabicParser__.arabicLetterHasIsolatedForm=function(x){return d(x)&&o(x)&&e[x.charCodeAt(0)].length>=1};var f=r.__arabicParser__.arabicLetterHasFinalForm=function(x){return d(x)&&o(x)&&e[x.charCodeAt(0)].length>=2};r.__arabicParser__.arabicLetterHasInitialForm=function(x){return d(x)&&o(x)&&e[x.charCodeAt(0)].length>=3};var m=r.__arabicParser__.arabicLetterHasMedialForm=function(x){return d(x)&&o(x)&&e[x.charCodeAt(0)].length==4},b=r.__arabicParser__.resolveLigatures=function(x){var k=0,j=t,$="",z=0;for(k=0;k<x.length;k+=1)j[x.charCodeAt(k)]!==void 0?(z++,typeof(j=j[x.charCodeAt(k)])=="number"&&($+=String.fromCharCode(j),j=t,z=0),k===x.length-1&&(j=t,$+=x.charAt(k-(z-1)),k-=z-1,z=0)):(j=t,$+=x.charAt(k-z),k-=z,z=0);return $};r.__arabicParser__.isArabicDiacritic=function(x){return x!==void 0&&n[x.charCodeAt(0)]!==void 0};var A=r.__arabicParser__.getCorrectForm=function(x,k,j){return d(x)?o(x)===!1?-1:!f(x)||!d(k)&&!d(j)||!d(j)&&c(k)||c(x)&&!d(k)||c(x)&&h(k)||c(x)&&c(k)?0:m(x)&&d(k)&&!c(k)&&d(j)&&f(j)?3:c(x)||!d(j)?1:2:-1},v=function(x){var k=0,j=0,$=0,z="",B="",F="",I=(x=x||"").split("\\s+"),X=[];for(k=0;k<I.length;k+=1){for(X.push(""),j=0;j<I[k].length;j+=1)z=I[k][j],B=I[k][j-1],F=I[k][j+1],d(z)?($=A(z,B,F),X[k]+=$!==-1?String.fromCharCode(e[z.charCodeAt(0)][$]):z):X[k]+=z;X[k]=b(X[k])}return X.join(" ")},E=r.__arabicParser__.processArabic=r.processArabic=function(){var x,k=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,j=[];if(Array.isArray(k)){var $=0;for(j=[],$=0;$<k.length;$+=1)Array.isArray(k[$])?j.push([v(k[$][0]),k[$][1],k[$][2]]):j.push([v(k[$])]);x=j}else x=v(k);return typeof arguments[0]=="string"?x:(arguments[0].text=x,arguments[0])};r.events.push(["preProcessText",E])})(jn.API),jn.API.autoPrint=function(r){var e;return(r=r||{}).variant=r.variant||"non-conform",r.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(r){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(c){t=c}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(c){n=isNaN(c)||Number.isInteger(c)===!1||c<0?150:c,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(c){s=isNaN(c)||Number.isInteger(c)===!1||c<0?300:c,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var o=[];Object.defineProperty(this,"childNodes",{get:function(){return o},set:function(c){o=c}});var d={};Object.defineProperty(this,"style",{get:function(){return d},set:function(c){d=c}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,n){var s;if((t=t||"2d")!=="2d")return null;for(s in n)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=n[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},r.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(jn.API),(function(r){var e={left:0,top:0,bottom:0,right:0},t=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var h=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return h},set:function(x){h=x}});var f=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return f},set:function(x){f=x}});var m=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return m},set:function(x){m=x}});var b=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return b},set:function(x){b=x}});var A=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return A},set:function(x){A=x}});var v=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return v},set:function(x){v=x}});var E=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return E},set:function(x){E=x}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},r.setHeaderFunction=function(h){return n.call(this),this.internal.__cell__.headerFunction=typeof h=="function"?h:void 0,this},r.getTextDimensions=function(h,f){n.call(this);var m=(f=f||{}).fontSize||this.getFontSize(),b=f.font||this.getFont(),A=f.scaleFactor||this.internal.scaleFactor,v=0,E=0,x=0,k=this;if(!Array.isArray(h)&&typeof h!="string"){if(typeof h!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");h=String(h)}var j=f.maxWidth;j>0?typeof h=="string"?h=this.splitTextToSize(h,j):Object.prototype.toString.call(h)==="[object Array]"&&(h=h.reduce(function(z,B){return z.concat(k.splitTextToSize(B,j))},[])):h=Array.isArray(h)?h:[h];for(var $=0;$<h.length;$++)v<(x=this.getStringUnitWidth(h[$],{font:b})*m)&&(v=x);return v!==0&&(E=h.length),{w:v/=A,h:Math.max((E*m*this.getLineHeightFactor()-m*(this.getLineHeightFactor()-1))/A,0)}},r.cellAddPage=function(){n.call(this),this.addPage();var h=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new o(h.left,h.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var d=r.cell=function(){var h;h=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var f=this.internal.__cell__.lastCell,m=this.internal.__cell__.padding,b=this.internal.__cell__.margins||e,A=this.internal.__cell__.tableHeaderRow,v=this.internal.__cell__.printHeaders;return f.lineNumber!==void 0&&(f.lineNumber===h.lineNumber?(h.x=(f.x||0)+(f.width||0),h.y=f.y||0):f.y+f.height+h.height+b.bottom>this.getPageHeight()?(this.cellAddPage(),h.y=b.top,v&&A&&(this.printHeaderRow(h.lineNumber,!0),h.y+=A[0].height)):h.y=f.y+f.height||h.y),h.text[0]!==void 0&&(this.rect(h.x,h.y,h.width,h.height,t===!0?"FD":void 0),h.align==="right"?this.text(h.text,h.x+h.width-m,h.y+m,{align:"right",baseline:"top"}):h.align==="center"?this.text(h.text,h.x+h.width/2,h.y+m,{align:"center",baseline:"top",maxWidth:h.width-m-m}):this.text(h.text,h.x+m,h.y+m,{align:"left",baseline:"top",maxWidth:h.width-m-m})),this.internal.__cell__.lastCell=h,this};r.table=function(h,f,m,b,A){if(n.call(this),!m)throw new Error("No data for PDF table.");var v,E,x,k,j=[],$=[],z=[],B={},F={},I=[],X=[],M=(A=A||{}).autoSize||!1,G=A.printHeaders!==!1,U=A.css&&A.css["font-size"]!==void 0?16*A.css["font-size"]:A.fontSize||12,_=A.margins||Object.assign({width:this.getPageWidth()},e),N=typeof A.padding=="number"?A.padding:3,te=A.headerBackgroundColor||"#c8c8c8",ie=A.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=G,this.internal.__cell__.margins=_,this.internal.__cell__.table_font_size=U,this.internal.__cell__.padding=N,this.internal.__cell__.headerBackgroundColor=te,this.internal.__cell__.headerTextColor=ie,this.setFontSize(U),b==null)$=j=Object.keys(m[0]),z=j.map(function(){return"left"});else if(Array.isArray(b)&&Rs(b[0])==="object")for(j=b.map(function(xe){return xe.name}),$=b.map(function(xe){return xe.prompt||xe.name||""}),z=b.map(function(xe){return xe.align||"left"}),v=0;v<b.length;v+=1)F[b[v].name]=.7499990551181103*b[v].width;else Array.isArray(b)&&typeof b[0]=="string"&&($=j=b,z=j.map(function(){return"left"}));if(M||Array.isArray(b)&&typeof b[0]=="string")for(v=0;v<j.length;v+=1){for(B[k=j[v]]=m.map(function(xe){return xe[k]}),this.setFont(void 0,"bold"),I.push(this.getTextDimensions($[v],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),E=B[k],this.setFont(void 0,"normal"),x=0;x<E.length;x+=1)I.push(this.getTextDimensions(E[x],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);F[k]=Math.max.apply(null,I)+N+N,I=[]}if(G){var re={};for(v=0;v<j.length;v+=1)re[j[v]]={},re[j[v]].text=$[v],re[j[v]].align=z[v];var q=c.call(this,re,F);X=j.map(function(xe){return new o(h,f,F[xe],q,re[xe].text,void 0,re[xe].align)}),this.setTableHeaderRow(X),this.printHeaderRow(1,!1)}var J=b.reduce(function(xe,Z){return xe[Z.name]=Z.align,xe},{});for(v=0;v<m.length;v+=1){"rowStart"in A&&A.rowStart instanceof Function&&A.rowStart({row:v,data:m[v]},this);var ce=c.call(this,m[v],F);for(x=0;x<j.length;x+=1){var _e=m[v][j[x]];"cellStart"in A&&A.cellStart instanceof Function&&A.cellStart({row:v,col:x,data:_e},this),d.call(this,new o(h,f,F[j[x]],ce,_e,v+2,J[j[x]]))}}return this.internal.__cell__.table_x=h,this.internal.__cell__.table_y=f,this};var c=function(h,f){var m=this.internal.__cell__.padding,b=this.internal.__cell__.table_font_size,A=this.internal.scaleFactor;return Object.keys(h).map(function(v){var E=h[v];return this.splitTextToSize(E.hasOwnProperty("text")?E.text:E,f[v]-m-m)},this).map(function(v){return this.getLineHeightFactor()*v.length*b/A+m+m},this).reduce(function(v,E){return Math.max(v,E)},0)};r.setTableHeaderRow=function(h){n.call(this),this.internal.__cell__.tableHeaderRow=h},r.printHeaderRow=function(h,f){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var m;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var b=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(b[0],b[1],b[2],b[3],void 0,-1)}this.setFont(void 0,"bold");for(var A=[],v=0;v<this.internal.__cell__.tableHeaderRow.length;v+=1){m=this.internal.__cell__.tableHeaderRow[v].clone(),f&&(m.y=this.internal.__cell__.margins.top||0,A.push(m)),m.lineNumber=h;var E=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),d.call(this,m),this.setTextColor(E)}A.length>0&&this.setTableHeaderRow(A),this.setFont(void 0,"normal"),t=!1}})(jn.API);var q2={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},V2=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Jm=H2(V2),W2=[100,200,300,400,500,600,700,800,900],OA=H2(W2);function Tm(r){var e=r.family.replace(/"|'/g,"").toLowerCase(),t=(function(o){return q2[o=o||"normal"]?o:"normal"})(r.style),n=(function(o){return o?typeof o=="number"?o>=100&&o<=900&&o%100==0?o:400:/^\d00$/.test(o)?parseInt(o):o==="bold"?700:400:400})(r.weight),s=(function(o){return typeof Jm[o=o||"normal"]=="number"?o:"normal"})(r.stretch);return{family:e,style:t,weight:n,stretch:s,src:r.src||[],ref:r.ref||{name:e,style:[s,t,n].join(" ")}}}function rb(r,e,t,n){var s;for(s=t;s>=0&&s<e.length;s+=n)if(r[e[s]])return r[e[s]];for(s=t;s>=0&&s<e.length;s-=n)if(r[e[s]])return r[e[s]]}var FA={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},ab={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function ob(r){return[r.stretch,r.style,r.weight,r.family].join(" ")}function lb(r){return r.trimLeft()}function UA(r,e){for(var t=0;t<r.length;){if(r.charAt(t)===e)return[r.substring(0,t),r.substring(t+1)];t+=1}return null}function HA(r){var e=r.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],r.substring(e[0].length)]}var kg,cb,db,Jh,jg,ub,hb,fb,Cm=["times"];function pb(r,e,t,n,s){var o=4,d=mb;switch(s){case jn.API.image_compression.FAST:o=1,d=gb;break;case jn.API.image_compression.MEDIUM:o=6,d=yb;break;case jn.API.image_compression.SLOW:o=9,d=xb}r=(function(h,f,m,b){for(var A,v=h.length/f,E=new Uint8Array(h.length+v),x=[qA,gb,mb,yb,xb],k=0;k<v;k+=1){var j=k*f,$=h.subarray(j,j+f);if(b)E.set(b($,m,A),j+k);else{for(var z=x.length,B=[],F=0;F<z;F+=1)B[F]=x[F]($,m,A);var I=WA(B.concat());E.set(B[I],j+k)}A=$}return E})(r,e,Math.ceil(t*n/8),d);var c=Wm(r,{level:o});return jn.API.__addimage__.arrayBufferToBinaryString(c)}function qA(r){var e=Array.apply([],r);return e.unshift(0),e}function gb(r,e){var t=r.length,n=[];n[0]=1;for(var s=0;s<t;s+=1){var o=r[s-e]||0;n[s+1]=r[s]-o+256&255}return n}function mb(r,e,t){var n=r.length,s=[];s[0]=2;for(var o=0;o<n;o+=1){var d=t&&t[o]||0;s[o+1]=r[o]-d+256&255}return s}function yb(r,e,t){var n=r.length,s=[];s[0]=3;for(var o=0;o<n;o+=1){var d=r[o-e]||0,c=t&&t[o]||0;s[o+1]=r[o]+256-(d+c>>>1)&255}return s}function xb(r,e,t){var n=r.length,s=[];s[0]=4;for(var o=0;o<n;o+=1){var d=VA(r[o-e]||0,t&&t[o]||0,t&&t[o-e]||0);s[o+1]=r[o]-d+256&255}return s}function VA(r,e,t){if(r===e&&e===t)return r;var n=Math.abs(e-t),s=Math.abs(r-t),o=Math.abs(r+e-t-t);return n<=s&&n<=o?r:s<=o?e:t}function WA(r){var e=r.map(function(t){return t.reduce(function(n,s){return n+Math.abs(s)},0)});return e.indexOf(Math.min.apply(null,e))}function _m(r,e,t){var n=e*t,s=Math.floor(n/8),o=16-(n-8*s+t),d=(1<<t)-1;return $2(r,s)>>o&d}function bb(r,e,t,n){var s=t*n,o=Math.floor(s/8),d=16-(s-8*o+n),c=(1<<n)-1,h=(e&c)<<d;(function(f,m,b){if(m+1<f.byteLength)f.setUint16(m,b,!1);else{var A=b>>8&255;f.setUint8(m,A)}})(r,o,$2(r,o)&~(c<<d)&65535|h)}function $2(r,e){return e+1<r.byteLength?r.getUint16(e,!1):r.getUint8(e)<<8}function $A(r){var e=0;if(r[e++]!==71||r[e++]!==73||r[e++]!==70||r[e++]!==56||(r[e++]+1&253)!=56||r[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=r[e++]|r[e++]<<8,n=r[e++]|r[e++]<<8,s=r[e++],o=s>>7,d=1<<1+(7&s);r[e++],r[e++];var c=null,h=null;o&&(c=e,h=d,e+=3*d);var f=!0,m=[],b=0,A=null,v=0,E=null;for(this.width=t,this.height=n;f&&e<r.length;)switch(r[e++]){case 33:switch(r[e++]){case 255:if(r[e]!==11||r[e+1]==78&&r[e+2]==69&&r[e+3]==84&&r[e+4]==83&&r[e+5]==67&&r[e+6]==65&&r[e+7]==80&&r[e+8]==69&&r[e+9]==50&&r[e+10]==46&&r[e+11]==48&&r[e+12]==3&&r[e+13]==1&&r[e+16]==0)e+=14,E=r[e++]|r[e++]<<8,e++;else for(e+=12;;){if(!((_=r[e++])>=0))throw Error("Invalid block size");if(_===0)break;e+=_}break;case 249:if(r[e++]!==4||r[e+4]!==0)throw new Error("Invalid graphics extension block.");var x=r[e++];b=r[e++]|r[e++]<<8,A=r[e++],1&x||(A=null),v=x>>2&7,e++;break;case 254:for(;;){if(!((_=r[e++])>=0))throw Error("Invalid block size");if(_===0)break;e+=_}break;default:throw new Error("Unknown graphic control label: 0x"+r[e-1].toString(16))}break;case 44:var k=r[e++]|r[e++]<<8,j=r[e++]|r[e++]<<8,$=r[e++]|r[e++]<<8,z=r[e++]|r[e++]<<8,B=r[e++],F=B>>6&1,I=1<<1+(7&B),X=c,M=h,G=!1;B>>7&&(G=!0,X=e,M=I,e+=3*I);var U=e;for(e++;;){var _;if(!((_=r[e++])>=0))throw Error("Invalid block size");if(_===0)break;e+=_}m.push({x:k,y:j,width:$,height:z,has_local_palette:G,palette_offset:X,palette_size:M,data_offset:U,data_length:e-U,transparent_index:A,interlaced:!!F,delay:b,disposal:v});break;case 59:f=!1;break;default:throw new Error("Unknown gif block: 0x"+r[e-1].toString(16))}this.numFrames=function(){return m.length},this.loopCount=function(){return E},this.frameInfo=function(N){if(N<0||N>=m.length)throw new Error("Frame index out of range.");return m[N]},this.decodeAndBlitFrameBGRA=function(N,te){var ie=this.frameInfo(N),re=ie.width*ie.height,q=new Uint8Array(re);vb(r,ie.data_offset,q,re);var J=ie.palette_offset,ce=ie.transparent_index;ce===null&&(ce=256);var _e=ie.width,xe=t-_e,Z=_e,D=4*(ie.y*t+ie.x),H=4*((ie.y+ie.height)*t+ie.x),Y=D,ue=4*xe;ie.interlaced===!0&&(ue+=4*t*7);for(var Ne=8,Pe=0,Ue=q.length;Pe<Ue;++Pe){var Re=q[Pe];if(Z===0&&(Z=_e,(Y+=ue)>=H&&(ue=4*xe+4*t*(Ne-1),Y=D+(_e+xe)*(Ne<<1),Ne>>=1)),Re===ce)Y+=4;else{var Ke=r[J+3*Re],Je=r[J+3*Re+1],st=r[J+3*Re+2];te[Y++]=st,te[Y++]=Je,te[Y++]=Ke,te[Y++]=255}--Z}},this.decodeAndBlitFrameRGBA=function(N,te){var ie=this.frameInfo(N),re=ie.width*ie.height,q=new Uint8Array(re);vb(r,ie.data_offset,q,re);var J=ie.palette_offset,ce=ie.transparent_index;ce===null&&(ce=256);var _e=ie.width,xe=t-_e,Z=_e,D=4*(ie.y*t+ie.x),H=4*((ie.y+ie.height)*t+ie.x),Y=D,ue=4*xe;ie.interlaced===!0&&(ue+=4*t*7);for(var Ne=8,Pe=0,Ue=q.length;Pe<Ue;++Pe){var Re=q[Pe];if(Z===0&&(Z=_e,(Y+=ue)>=H&&(ue=4*xe+4*t*(Ne-1),Y=D+(_e+xe)*(Ne<<1),Ne>>=1)),Re===ce)Y+=4;else{var Ke=r[J+3*Re],Je=r[J+3*Re+1],st=r[J+3*Re+2];te[Y++]=Ke,te[Y++]=Je,te[Y++]=st,te[Y++]=255}--Z}}}function vb(r,e,t,n){for(var s=r[e++],o=1<<s,d=o+1,c=d+1,h=s+1,f=(1<<h)-1,m=0,b=0,A=0,v=r[e++],E=new Int32Array(4096),x=null;;){for(;m<16&&v!==0;)b|=r[e++]<<m,m+=8,v===1?v=r[e++]:--v;if(m<h)break;var k=b&f;if(b>>=h,m-=h,k!==o){if(k===d)break;for(var j=k<c?k:x,$=0,z=j;z>o;)z=E[z]>>8,++$;var B=z;if(A+$+(j!==k?1:0)>n)return void Ys.log("Warning, gif stream longer than expected.");t[A++]=B;var F=A+=$;for(j!==k&&(t[A++]=B),z=j;$--;)z=E[z],t[--F]=255&z,z>>=8;x!==null&&c<4096&&(E[c++]=x<<8|B,c>=f+1&&h<12&&(++h,f=f<<1|1)),x=k}else c=d+1,f=(1<<(h=s+1))-1,x=null}return A!==n&&Ys.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function km(r){var e,t,n,s,o,d=Math.floor,c=new Array(64),h=new Array(64),f=new Array(64),m=new Array(64),b=new Array(65535),A=new Array(65535),v=new Array(64),E=new Array(64),x=[],k=0,j=7,$=new Array(64),z=new Array(64),B=new Array(64),F=new Array(256),I=new Array(2048),X=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],M=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],G=[0,1,2,3,4,5,6,7,8,9,10,11],U=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],_=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],N=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],te=[0,1,2,3,4,5,6,7,8,9,10,11],ie=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],re=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function q(D,H){for(var Y=0,ue=0,Ne=new Array,Pe=1;Pe<=16;Pe++){for(var Ue=1;Ue<=D[Pe];Ue++)Ne[H[ue]]=[],Ne[H[ue]][0]=Y,Ne[H[ue]][1]=Pe,ue++,Y++;Y*=2}return Ne}function J(D){for(var H=D[0],Y=D[1]-1;Y>=0;)H&1<<Y&&(k|=1<<j),Y--,--j<0&&(k==255?(ce(255),ce(0)):ce(k),j=7,k=0)}function ce(D){x.push(D)}function _e(D){ce(D>>8&255),ce(255&D)}function xe(D,H,Y,ue,Ne){for(var Pe,Ue=Ne[0],Re=Ne[240],Ke=(function(at,en){var Ot,wn,nn,Zn,Pt,Mt,yi,ft,_t,On,Jt=0;for(_t=0;_t<8;++_t){Ot=at[Jt],wn=at[Jt+1],nn=at[Jt+2],Zn=at[Jt+3],Pt=at[Jt+4],Mt=at[Jt+5],yi=at[Jt+6];var zn=Ot+(ft=at[Jt+7]),Nn=Ot-ft,on=wn+yi,Sn=wn-yi,lt=nn+Mt,Qt=nn-Mt,$t=Zn+Pt,Gt=Zn-Pt,An=zn+$t,Vi=zn-$t,qn=on+lt,yn=on-lt;at[Jt]=An+qn,at[Jt+4]=An-qn;var Kt=.707106781*(yn+Vi);at[Jt+2]=Vi+Kt,at[Jt+6]=Vi-Kt;var Tr=.382683433*((An=Gt+Qt)-(yn=Sn+Nn)),Ks=.5411961*An+Tr,Ir=1.306562965*yn+Tr,Br=.707106781*(qn=Qt+Sn),Zt=Nn+Br,Or=Nn-Br;at[Jt+5]=Or+Ks,at[Jt+3]=Or-Ks,at[Jt+1]=Zt+Ir,at[Jt+7]=Zt-Ir,Jt+=8}for(Jt=0,_t=0;_t<8;++_t){Ot=at[Jt],wn=at[Jt+8],nn=at[Jt+16],Zn=at[Jt+24],Pt=at[Jt+32],Mt=at[Jt+40],yi=at[Jt+48];var Na=Ot+(ft=at[Jt+56]),fa=Ot-ft,At=wn+yi,fi=wn-yi,ei=nn+Mt,vs=nn-Mt,Ji=Zn+Pt,Ds=Zn-Pt,Ci=Na+Ji,Si=Na-Ji,Cr=At+ei,pa=At-ei;at[Jt]=Ci+Cr,at[Jt+32]=Ci-Cr;var qa=.707106781*(pa+Si);at[Jt+16]=Si+qa,at[Jt+48]=Si-qa;var Yl=.382683433*((Ci=Ds+vs)-(pa=fi+fa)),Va=.5411961*Ci+Yl,Wa=1.306562965*pa+Yl,No=.707106781*(Cr=vs+fi),$n=fa+No,Fr=fa-No;at[Jt+40]=Fr+Va,at[Jt+24]=Fr-Va,at[Jt+8]=$n+Wa,at[Jt+56]=$n-Wa,Jt++}for(_t=0;_t<64;++_t)On=at[_t]*en[_t],v[_t]=On>0?On+.5|0:On-.5|0;return v})(D,H),Je=0;Je<64;++Je)E[X[Je]]=Ke[Je];var st=E[0]-Y;Y=E[0],st==0?J(ue[0]):(J(ue[A[Pe=32767+st]]),J(b[Pe]));for(var yt=63;yt>0&&E[yt]==0;)yt--;if(yt==0)return J(Ue),Y;for(var Nt,pe=1;pe<=yt;){for(var St=pe;E[pe]==0&&pe<=yt;)++pe;var Ut=pe-St;if(Ut>=16){Nt=Ut>>4;for(var Lt=1;Lt<=Nt;++Lt)J(Re);Ut&=15}Pe=32767+E[pe],J(Ne[(Ut<<4)+A[Pe]]),J(b[Pe]),pe++}return yt!=63&&J(Ue),Y}function Z(D){D=Math.min(Math.max(D,1),100),o!=D&&((function(H){for(var Y=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],ue=0;ue<64;ue++){var Ne=d((Y[ue]*H+50)/100);Ne=Math.min(Math.max(Ne,1),255),c[X[ue]]=Ne}for(var Pe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Ue=0;Ue<64;Ue++){var Re=d((Pe[Ue]*H+50)/100);Re=Math.min(Math.max(Re,1),255),h[X[Ue]]=Re}for(var Ke=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Je=0,st=0;st<8;st++)for(var yt=0;yt<8;yt++)f[Je]=1/(c[X[Je]]*Ke[st]*Ke[yt]*8),m[Je]=1/(h[X[Je]]*Ke[st]*Ke[yt]*8),Je++})(D<50?Math.floor(5e3/D):Math.floor(200-2*D)),o=D)}this.encode=function(D,H){H&&Z(H),x=new Array,k=0,j=7,_e(65496),_e(65504),_e(16),ce(74),ce(70),ce(73),ce(70),ce(0),ce(1),ce(1),ce(0),_e(1),_e(1),ce(0),ce(0),(function(){_e(65499),_e(132),ce(0);for(var wn=0;wn<64;wn++)ce(c[wn]);ce(1);for(var nn=0;nn<64;nn++)ce(h[nn])})(),(function(wn,nn){_e(65472),_e(17),ce(8),_e(nn),_e(wn),ce(3),ce(1),ce(17),ce(0),ce(2),ce(17),ce(1),ce(3),ce(17),ce(1)})(D.width,D.height),(function(){_e(65476),_e(418),ce(0);for(var wn=0;wn<16;wn++)ce(M[wn+1]);for(var nn=0;nn<=11;nn++)ce(G[nn]);ce(16);for(var Zn=0;Zn<16;Zn++)ce(U[Zn+1]);for(var Pt=0;Pt<=161;Pt++)ce(_[Pt]);ce(1);for(var Mt=0;Mt<16;Mt++)ce(N[Mt+1]);for(var yi=0;yi<=11;yi++)ce(te[yi]);ce(17);for(var ft=0;ft<16;ft++)ce(ie[ft+1]);for(var _t=0;_t<=161;_t++)ce(re[_t])})(),_e(65498),_e(12),ce(3),ce(1),ce(0),ce(2),ce(17),ce(3),ce(17),ce(0),ce(63),ce(0);var Y=0,ue=0,Ne=0;k=0,j=7,this.encode.displayName="_encode_";for(var Pe,Ue,Re,Ke,Je,st,yt,Nt,pe,St=D.data,Ut=D.width,Lt=D.height,at=4*Ut,en=0;en<Lt;){for(Pe=0;Pe<at;){for(Je=at*en+Pe,yt=-1,Nt=0,pe=0;pe<64;pe++)st=Je+(Nt=pe>>3)*at+(yt=4*(7&pe)),en+Nt>=Lt&&(st-=at*(en+1+Nt-Lt)),Pe+yt>=at&&(st-=Pe+yt-at+4),Ue=St[st++],Re=St[st++],Ke=St[st++],$[pe]=(I[Ue]+I[Re+256|0]+I[Ke+512|0]>>16)-128,z[pe]=(I[Ue+768|0]+I[Re+1024|0]+I[Ke+1280|0]>>16)-128,B[pe]=(I[Ue+1280|0]+I[Re+1536|0]+I[Ke+1792|0]>>16)-128;Y=xe($,f,Y,e,n),ue=xe(z,m,ue,t,s),Ne=xe(B,m,Ne,t,s),Pe+=32}en+=8}if(j>=0){var Ot=[];Ot[1]=j+1,Ot[0]=(1<<j+1)-1,J(Ot)}return _e(65497),new Uint8Array(x)},r=r||50,(function(){for(var D=String.fromCharCode,H=0;H<256;H++)F[H]=D(H)})(),e=q(M,G),t=q(N,te),n=q(U,_),s=q(ie,re),(function(){for(var D=1,H=2,Y=1;Y<=15;Y++){for(var ue=D;ue<H;ue++)A[32767+ue]=Y,b[32767+ue]=[],b[32767+ue][1]=Y,b[32767+ue][0]=ue;for(var Ne=-(H-1);Ne<=-D;Ne++)A[32767+Ne]=Y,b[32767+Ne]=[],b[32767+Ne][1]=Y,b[32767+Ne][0]=H-1+Ne;D<<=1,H<<=1}})(),(function(){for(var D=0;D<256;D++)I[D]=19595*D,I[D+256|0]=38470*D,I[D+512|0]=7471*D+32768,I[D+768|0]=-11059*D,I[D+1024|0]=-21709*D,I[D+1280|0]=32768*D+8421375,I[D+1536|0]=-27439*D,I[D+1792|0]=-5329*D})(),Z(r)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Kc(r,e){if(this.pos=0,this.buffer=r,this.datav=new DataView(r.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function wb(r){function e(G){if(!G)throw Error("assert :P")}function t(G,U,_){for(var N=0;4>N;N++)if(G[U+N]!=_.charCodeAt(N))return!0;return!1}function n(G,U,_,N,te){for(var ie=0;ie<te;ie++)G[U+ie]=_[N+ie]}function s(G,U,_,N){for(var te=0;te<N;te++)G[U+te]=_}function o(G){return new Int32Array(G)}function d(G,U){for(var _=[],N=0;N<G;N++)_.push(new U);return _}function c(G,U){var _=[];return(function N(te,ie,re){for(var q=re[ie],J=0;J<q&&(te.push(re.length>ie+1?[]:new U),!(re.length<ie+1));J++)N(te[J],ie+1,re)})(_,0,G),_}var h=function(){var G=this;function U(y,T){for(var R=1<<T-1>>>0;y&R;)R>>>=1;return R?(y&R-1)+R:y}function _(y,T,R,O,ne){e(!(O%R));do y[T+(O-=R)]=ne;while(0<O)}function N(y,T,R,O,ne){if(e(2328>=ne),512>=ne)var se=o(512);else if((se=o(ne))==null)return 0;return(function(ae,de,me,Te,Ie,Ze){var ve,Be,$e=de,ut=1<<me,We=o(16),et=o(16);for(e(Ie!=0),e(Te!=null),e(ae!=null),e(0<me),Be=0;Be<Ie;++Be){if(15<Te[Be])return 0;++We[Te[Be]]}if(We[0]==Ie)return 0;for(et[1]=0,ve=1;15>ve;++ve){if(We[ve]>1<<ve)return 0;et[ve+1]=et[ve]+We[ve]}for(Be=0;Be<Ie;++Be)ve=Te[Be],0<Te[Be]&&(Ze[et[ve]++]=Be);if(et[15]==1)return(Te=new te).g=0,Te.value=Ze[0],_(ae,$e,1,ut,Te),ut;var gt,Tt=-1,bt=ut-1,sn=0,qt=1,rn=1,Bt=1<<me;for(Be=0,ve=1,Ie=2;ve<=me;++ve,Ie<<=1){if(qt+=rn<<=1,0>(rn-=We[ve]))return 0;for(;0<We[ve];--We[ve])(Te=new te).g=ve,Te.value=Ze[Be++],_(ae,$e+sn,Ie,Bt,Te),sn=U(sn,ve)}for(ve=me+1,Ie=2;15>=ve;++ve,Ie<<=1){if(qt+=rn<<=1,0>(rn-=We[ve]))return 0;for(;0<We[ve];--We[ve]){if(Te=new te,(sn&bt)!=Tt){for($e+=Bt,gt=1<<(Tt=ve)-me;15>Tt&&!(0>=(gt-=We[Tt]));)++Tt,gt<<=1;ut+=Bt=1<<(gt=Tt-me),ae[de+(Tt=sn&bt)].g=gt+me,ae[de+Tt].value=$e-de-Tt}Te.g=ve-me,Te.value=Ze[Be++],_(ae,$e+(sn>>me),Ie,Bt,Te),sn=U(sn,ve)}}return qt!=2*et[15]-1?0:ut})(y,T,R,O,ne,se)}function te(){this.value=this.g=0}function ie(){this.value=this.g=0}function re(){this.G=d(5,te),this.H=o(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=d(po,ie)}function q(y,T,R,O){e(y!=null),e(T!=null),e(2147483648>O),y.Ca=254,y.I=0,y.b=-8,y.Ka=0,y.oa=T,y.pa=R,y.Jd=T,y.Yc=R+O,y.Zc=4<=O?R+O-4+1:R,Ue(y)}function J(y,T){for(var R=0;0<T--;)R|=Ke(y,128)<<T;return R}function ce(y,T){var R=J(y,T);return Re(y)?-R:R}function _e(y,T,R,O){var ne,se=0;for(e(y!=null),e(T!=null),e(4294967288>O),y.Sb=O,y.Ra=0,y.u=0,y.h=0,4<O&&(O=4),ne=0;ne<O;++ne)se+=T[R+ne]<<8*ne;y.Ra=se,y.bb=O,y.oa=T,y.pa=R}function xe(y){for(;8<=y.u&&y.bb<y.Sb;)y.Ra>>>=8,y.Ra+=y.oa[y.pa+y.bb]<<Mo-8>>>0,++y.bb,y.u-=8;ue(y)&&(y.h=1,y.u=0)}function Z(y,T){if(e(0<=T),!y.h&&T<=ir){var R=Y(y)&wa[T];return y.u+=T,xe(y),R}return y.h=1,y.u=0}function D(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function H(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function Y(y){return y.Ra>>>(y.u&Mo-1)>>>0}function ue(y){return e(y.bb<=y.Sb),y.h||y.bb==y.Sb&&y.u>Mo}function Ne(y,T){y.u=T,y.h=ue(y)}function Pe(y){y.u>=Da&&(e(y.u>=Da),xe(y))}function Ue(y){e(y!=null&&y.oa!=null),y.pa<y.Zc?(y.I=(y.oa[y.pa++]|y.I<<8)>>>0,y.b+=8):(e(y!=null&&y.oa!=null),y.pa<y.Yc?(y.b+=8,y.I=y.oa[y.pa++]|y.I<<8):y.Ka?y.b=0:(y.I<<=8,y.b+=8,y.Ka=1))}function Re(y){return J(y,1)}function Ke(y,T){var R=y.Ca;0>y.b&&Ue(y);var O=y.b,ne=R*T>>>8,se=(y.I>>>O>ne)+0;for(se?(R-=ne,y.I-=ne+1<<O>>>0):R=ne+1,O=R,ne=0;256<=O;)ne+=8,O>>=8;return O=7^ne+_i[O],y.b-=O,y.Ca=(R<<O)-1,se}function Je(y,T,R){y[T+0]=R>>24&255,y[T+1]=R>>16&255,y[T+2]=R>>8&255,y[T+3]=255&R}function st(y,T){return y[T+0]|y[T+1]<<8}function yt(y,T){return st(y,T)|y[T+2]<<16}function Nt(y,T){return st(y,T)|st(y,T+2)<<16}function pe(y,T){var R=1<<T;return e(y!=null),e(0<T),y.X=o(R),y.X==null?0:(y.Mb=32-T,y.Xa=T,1)}function St(y,T){e(y!=null),e(T!=null),e(y.Xa==T.Xa),n(T.X,0,y.X,0,1<<T.Xa)}function Ut(){this.X=[],this.Xa=this.Mb=0}function Lt(y,T,R,O){e(R!=null),e(O!=null);var ne=R[0],se=O[0];return ne==0&&(ne=(y*se+T/2)/T),se==0&&(se=(T*ne+y/2)/y),0>=ne||0>=se?0:(R[0]=ne,O[0]=se,1)}function at(y,T){return y+(1<<T)-1>>>T}function en(y,T){return((4278255360&y)+(4278255360&T)>>>0&4278255360)+((16711935&y)+(16711935&T)>>>0&16711935)>>>0}function Ot(y,T){G[T]=function(R,O,ne,se,ae,de,me){var Te;for(Te=0;Te<ae;++Te){var Ie=G[y](de[me+Te-1],ne,se+Te);de[me+Te]=en(R[O+Te],Ie)}}}function wn(){this.ud=this.hd=this.jd=0}function nn(y,T){return((4278124286&(y^T))>>>1)+(y&T)>>>0}function Zn(y){return 0<=y&&256>y?y:0>y?0:255<y?255:void 0}function Pt(y,T){return Zn(y+(y-T+.5>>1))}function Mt(y,T,R){return Math.abs(T-R)-Math.abs(y-R)}function yi(y,T,R,O,ne,se,ae){for(O=se[ae-1],R=0;R<ne;++R)se[ae+R]=O=en(y[T+R],O)}function ft(y,T,R,O,ne){var se;for(se=0;se<R;++se){var ae=y[T+se],de=ae>>8&255,me=16711935&(me=(me=16711935&ae)+((de<<16)+de));O[ne+se]=(4278255360&ae)+me>>>0}}function _t(y,T){T.jd=255&y,T.hd=y>>8&255,T.ud=y>>16&255}function On(y,T,R,O,ne,se){var ae;for(ae=0;ae<O;++ae){var de=T[R+ae],me=de>>>8,Te=de,Ie=255&(Ie=(Ie=de>>>16)+((y.jd<<24>>24)*(me<<24>>24)>>>5));Te=255&(Te=(Te+=(y.hd<<24>>24)*(me<<24>>24)>>>5)+((y.ud<<24>>24)*(Ie<<24>>24)>>>5)),ne[se+ae]=(4278255360&de)+(Ie<<16)+Te}}function Jt(y,T,R,O,ne){G[T]=function(se,ae,de,me,Te,Ie,Ze,ve,Be){for(me=Ze;me<ve;++me)for(Ze=0;Ze<Be;++Ze)Te[Ie++]=ne(de[O(se[ae++])])},G[y]=function(se,ae,de,me,Te,Ie,Ze){var ve=8>>se.b,Be=se.Ea,$e=se.K[0],ut=se.w;if(8>ve)for(se=(1<<se.b)-1,ut=(1<<ve)-1;ae<de;++ae){var We,et=0;for(We=0;We<Be;++We)We&se||(et=O(me[Te++])),Ie[Ze++]=ne($e[et&ut]),et>>=ve}else G["VP8LMapColor"+R](me,Te,$e,ut,Ie,Ze,ae,de,Be)}}function zn(y,T,R,O,ne){for(R=T+R;T<R;){var se=y[T++];O[ne++]=se>>16&255,O[ne++]=se>>8&255,O[ne++]=255&se}}function Nn(y,T,R,O,ne){for(R=T+R;T<R;){var se=y[T++];O[ne++]=se>>16&255,O[ne++]=se>>8&255,O[ne++]=255&se,O[ne++]=se>>24&255}}function on(y,T,R,O,ne){for(R=T+R;T<R;){var se=(ae=y[T++])>>16&240|ae>>12&15,ae=240&ae|ae>>28&15;O[ne++]=se,O[ne++]=ae}}function Sn(y,T,R,O,ne){for(R=T+R;T<R;){var se=(ae=y[T++])>>16&248|ae>>13&7,ae=ae>>5&224|ae>>3&31;O[ne++]=se,O[ne++]=ae}}function lt(y,T,R,O,ne){for(R=T+R;T<R;){var se=y[T++];O[ne++]=255&se,O[ne++]=se>>8&255,O[ne++]=se>>16&255}}function Qt(y,T,R,O,ne,se){if(se==0)for(R=T+R;T<R;)Je(O,((se=y[T++])[0]>>24|se[1]>>8&65280|se[2]<<8&16711680|se[3]<<24)>>>0),ne+=32;else n(O,ne,y,T,R)}function $t(y,T){G[T][0]=G[y+"0"],G[T][1]=G[y+"1"],G[T][2]=G[y+"2"],G[T][3]=G[y+"3"],G[T][4]=G[y+"4"],G[T][5]=G[y+"5"],G[T][6]=G[y+"6"],G[T][7]=G[y+"7"],G[T][8]=G[y+"8"],G[T][9]=G[y+"9"],G[T][10]=G[y+"10"],G[T][11]=G[y+"11"],G[T][12]=G[y+"12"],G[T][13]=G[y+"13"],G[T][14]=G[y+"0"],G[T][15]=G[y+"0"]}function Gt(y){return y==pl||y==Ac||y==Fo||y==ec}function An(){this.eb=[],this.size=this.A=this.fb=0}function Vi(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function qn(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new An,this.f.kb=new Vi,this.sd=null}function yn(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Kt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Tr(y){return alert("todo:WebPSamplerProcessPlane"),y.T}function Ks(y,T){var R=y.T,O=T.ba.f.RGBA,ne=O.eb,se=O.fb+y.ka*O.A,ae=Ls[T.ba.S],de=y.y,me=y.O,Te=y.f,Ie=y.N,Ze=y.ea,ve=y.W,Be=T.cc,$e=T.dc,ut=T.Mc,We=T.Nc,et=y.ka,gt=y.ka+y.T,Tt=y.U,bt=Tt+1>>1;for(et==0?ae(de,me,null,null,Te,Ie,Ze,ve,Te,Ie,Ze,ve,ne,se,null,null,Tt):(ae(T.ec,T.fc,de,me,Be,$e,ut,We,Te,Ie,Ze,ve,ne,se-O.A,ne,se,Tt),++R);et+2<gt;et+=2)Be=Te,$e=Ie,ut=Ze,We=ve,Ie+=y.Rc,ve+=y.Rc,se+=2*O.A,ae(de,(me+=2*y.fa)-y.fa,de,me,Be,$e,ut,We,Te,Ie,Ze,ve,ne,se-O.A,ne,se,Tt);return me+=y.fa,y.j+gt<y.o?(n(T.ec,T.fc,de,me,Tt),n(T.cc,T.dc,Te,Ie,bt),n(T.Mc,T.Nc,Ze,ve,bt),R--):1&gt||ae(de,me,null,null,Te,Ie,Ze,ve,Te,Ie,Ze,ve,ne,se+O.A,null,null,Tt),R}function Ir(y,T,R){var O=y.F,ne=[y.J];if(O!=null){var se=y.U,ae=T.ba.S,de=ae==qc||ae==Fo;T=T.ba.f.RGBA;var me=[0],Te=y.ka;me[0]=y.T,y.Kb&&(Te==0?--me[0]:(--Te,ne[0]-=y.width),y.j+y.ka+y.T==y.o&&(me[0]=y.o-y.j-Te));var Ie=T.eb;Te=T.fb+Te*T.A,y=ki(O,ne[0],y.width,se,me,Ie,Te+(de?0:3),T.A),e(R==me),y&&Gt(ae)&&Pl(Ie,Te,de,se,me,T.A)}return 0}function Br(y){var T=y.ma,R=T.ba.S,O=11>R,ne=R==ia||R==Ia||R==qc||R==El||R==12||Gt(R);if(T.memory=null,T.Ib=null,T.Jb=null,T.Nd=null,!eo(T.Oa,y,ne?11:12))return 0;if(ne&&Gt(R)&&pr(),y.da)alert("todo:use_scaling");else{if(O){if(T.Ib=Tr,y.Kb){if(R=y.U+1>>1,T.memory=o(y.U+2*R),T.memory==null)return 0;T.ec=T.memory,T.fc=0,T.cc=T.ec,T.dc=T.fc+y.U,T.Mc=T.cc,T.Nc=T.dc+R,T.Ib=Ks,pr()}}else alert("todo:EmitYUV");ne&&(T.Jb=Ir,O&&Nr())}if(O&&!Yr){for(y=0;256>y;++y)fs[y]=89858*(y-128)+Ca>>ys,sc[y]=-22014*(y-128)+Ca,vo[y]=-45773*(y-128),Uo[y]=113618*(y-128)+Ca>>ys;for(y=cr;y<$r;++y)T=76283*(y-16)+Ca>>ys,io[y-cr]=ss(T,255),Ho[y-cr]=ss(T+8>>4,15);Yr=1}return 1}function Zt(y){var T=y.ma,R=y.U,O=y.T;return e(!(1&y.ka)),0>=R||0>=O?0:(R=T.Ib(y,T),T.Jb!=null&&T.Jb(y,T,R),T.Dc+=R,1)}function Or(y){y.ma.memory=null}function Na(y,T,R,O){return Z(y,8)!=47?0:(T[0]=Z(y,14)+1,R[0]=Z(y,14)+1,O[0]=Z(y,1),Z(y,3)!=0?0:!y.h)}function fa(y,T){if(4>y)return y+1;var R=y-2>>1;return(2+(1&y)<<R)+Z(T,R)+1}function At(y,T){return 120<T?T-120:1<=(R=((R=ar[T-1])>>4)*y+(8-(15&R)))?R:1;var R}function fi(y,T,R){var O=Y(R),ne=y[T+=255&O].g-8;return 0<ne&&(Ne(R,R.u+8),O=Y(R),T+=y[T].value,T+=O&(1<<ne)-1),Ne(R,R.u+y[T].g),y[T].value}function ei(y,T,R){return R.g+=y.g,R.value+=y.value<<T>>>0,e(8>=R.g),y.g}function vs(y,T,R){var O=y.xc;return e((T=O==0?0:y.vc[y.md*(R>>O)+(T>>O)])<y.Wb),y.Ya[T]}function Ji(y,T,R,O){var ne=y.ab,se=y.c*T,ae=y.C;T=ae+T;var de=R,me=O;for(O=y.Ta,R=y.Ua;0<ne--;){var Te=y.gc[ne],Ie=ae,Ze=T,ve=de,Be=me,$e=(me=O,de=R,Te.Ea);switch(e(Ie<Ze),e(Ze<=Te.nc),Te.hc){case 2:ws(ve,Be,(Ze-Ie)*$e,me,de);break;case 0:var ut=Ie,We=Ze,et=me,gt=de,Tt=(Bt=Te).Ea;ut==0&&(zo(ve,Be,null,null,1,et,gt),yi(ve,Be+1,0,0,Tt-1,et,gt+1),Be+=Tt,gt+=Tt,++ut);for(var bt=1<<Bt.b,sn=bt-1,qt=at(Tt,Bt.b),rn=Bt.K,Bt=Bt.w+(ut>>Bt.b)*qt;ut<We;){var ni=rn,ts=Bt,Yn=1;for(os(ve,Be,et,gt-Tt,1,et,gt);Yn<Tt;){var Ht=(Yn&~sn)+bt;Ht>Tt&&(Ht=Tt),(0,Zl[ni[ts++]>>8&15])(ve,Be+ +Yn,et,gt+Yn-Tt,Ht-Yn,et,gt+Yn),Yn=Ht}Be+=Tt,gt+=Tt,++ut&sn||(Bt+=qt)}Ze!=Te.nc&&n(me,de-$e,me,de+(Ze-Ie-1)*$e,$e);break;case 1:for($e=ve,We=Be,Tt=(ve=Te.Ea)-(gt=ve&~(et=(Be=1<<Te.b)-1)),ut=at(ve,Te.b),bt=Te.K,Te=Te.w+(Ie>>Te.b)*ut;Ie<Ze;){for(sn=bt,qt=Te,rn=new wn,Bt=We+gt,ni=We+ve;We<Bt;)_t(sn[qt++],rn),sd(rn,$e,We,Be,me,de),We+=Be,de+=Be;We<ni&&(_t(sn[qt++],rn),sd(rn,$e,We,Tt,me,de),We+=Tt,de+=Tt),++Ie&et||(Te+=ut)}break;case 3:if(ve==me&&Be==de&&0<Te.b){for(We=me,ve=$e=de+(Ze-Ie)*$e-(gt=(Ze-Ie)*at(Te.Ea,Te.b)),Be=me,et=de,ut=[],gt=(Tt=gt)-1;0<=gt;--gt)ut[gt]=Be[et+gt];for(gt=Tt-1;0<=gt;--gt)We[ve+gt]=ut[gt];id(Te,Ie,Ze,me,$e,me,de)}else id(Te,Ie,Ze,ve,Be,me,de)}de=O,me=R}me!=R&&n(O,R,de,me,se)}function Ds(y,T){var R=y.V,O=y.Ba+y.c*y.C,ne=T-y.C;if(e(T<=y.l.o),e(16>=ne),0<ne){var se=y.l,ae=y.Ta,de=y.Ua,me=se.width;if(Ji(y,ne,R,O),ne=de=[de],e((R=y.C)<(O=T)),e(se.v<se.va),O>se.o&&(O=se.o),R<se.j){var Te=se.j-R;R=se.j,ne[0]+=Te*me}if(R>=O?R=0:(ne[0]+=4*se.v,se.ka=R-se.j,se.U=se.va-se.v,se.T=O-R,R=1),R){if(de=de[0],11>(R=y.ca).S){var Ie=R.f.RGBA,Ze=(O=R.S,ne=se.U,se=se.T,Te=Ie.eb,Ie.A),ve=se;for(Ie=Ie.fb+y.Ma*Ie.A;0<ve--;){var Be=ae,$e=de,ut=ne,We=Te,et=Ie;switch(O){case Ed:to(Be,$e,ut,We,et);break;case ia:dl(Be,$e,ut,We,et);break;case pl:dl(Be,$e,ut,We,et),Pl(We,et,0,ut,1,0);break;case rd:qr(Be,$e,ut,We,et);break;case Ia:Qt(Be,$e,ut,We,et,1);break;case Ac:Qt(Be,$e,ut,We,et,1),Pl(We,et,0,ut,1,0);break;case qc:Qt(Be,$e,ut,We,et,0);break;case Fo:Qt(Be,$e,ut,We,et,0),Pl(We,et,1,ut,1,0);break;case El:Io(Be,$e,ut,We,et);break;case ec:Io(Be,$e,ut,We,et),hs(We,et,ut,1,0);break;case Ql:Sa(Be,$e,ut,We,et);break;default:e(0)}de+=me,Ie+=Ze}y.Ma+=se}else alert("todo:EmitRescaledRowsYUVA");e(y.Ma<=R.height)}}y.C=T,e(y.C<=y.i)}function Ci(y){var T;if(0<y.ua)return 0;for(T=0;T<y.Wb;++T){var R=y.Ya[T].G,O=y.Ya[T].H;if(0<R[1][O[1]+0].g||0<R[2][O[2]+0].g||0<R[3][O[3]+0].g)return 0}return 1}function Si(y,T,R,O,ne,se){if(y.Z!=0){var ae=y.qd,de=y.rd;for(e(Ll[y.Z]!=null);T<R;++T)Ll[y.Z](ae,de,O,ne,O,ne,se),ae=O,de=ne,ne+=se;y.qd=ae,y.rd=de}}function Cr(y,T){var R=y.l.ma,O=R.Z==0||R.Z==1?y.l.j:y.C;if(O=y.C<O?O:y.C,e(T<=y.l.o),T>O){var ne=y.l.width,se=R.ca,ae=R.tb+ne*O,de=y.V,me=y.Ba+y.c*O,Te=y.gc;e(y.ab==1),e(Te[0].hc==3),Cl(Te[0],O,T,de,me,se,ae),Si(R,O,T,se,ae,ne)}y.C=y.Ma=T}function pa(y,T,R,O,ne,se,ae){var de=y.$/O,me=y.$%O,Te=y.m,Ie=y.s,Ze=R+y.$,ve=Ze;ne=R+O*ne;var Be=R+O*se,$e=280+Ie.ua,ut=y.Pb?de:16777216,We=0<Ie.ua?Ie.Wa:null,et=Ie.wc,gt=Ze<Be?vs(Ie,me,de):null;e(y.C<se),e(Be<=ne);var Tt=!1;e:for(;;){for(;Tt||Ze<Be;){var bt=0;if(de>=ut){var sn=Ze-R;e((ut=y).Pb),ut.wd=ut.m,ut.xd=sn,0<ut.s.ua&&St(ut.s.Wa,ut.s.vb),ut=de+Js}if(me&et||(gt=vs(Ie,me,de)),e(gt!=null),gt.Qb&&(T[Ze]=gt.qb,Tt=!0),!Tt)if(Pe(Te),gt.jc){bt=Te,sn=T;var qt=Ze,rn=gt.pd[Y(bt)&po-1];e(gt.jc),256>rn.g?(Ne(bt,bt.u+rn.g),sn[qt]=rn.value,bt=0):(Ne(bt,bt.u+rn.g-256),e(256<=rn.value),bt=rn.value),bt==0&&(Tt=!0)}else bt=fi(gt.G[0],gt.H[0],Te);if(Te.h)break;if(Tt||256>bt){if(!Tt)if(gt.nd)T[Ze]=(gt.qb|bt<<8)>>>0;else{if(Pe(Te),Tt=fi(gt.G[1],gt.H[1],Te),Pe(Te),sn=fi(gt.G[2],gt.H[2],Te),qt=fi(gt.G[3],gt.H[3],Te),Te.h)break;T[Ze]=(qt<<24|Tt<<16|bt<<8|sn)>>>0}if(Tt=!1,++Ze,++me>=O&&(me=0,++de,ae!=null&&de<=se&&!(de%16)&&ae(y,de),We!=null))for(;ve<Ze;)bt=T[ve++],We.X[(506832829*bt&4294967295)>>>We.Mb]=bt}else if(280>bt){if(bt=fa(bt-256,Te),sn=fi(gt.G[4],gt.H[4],Te),Pe(Te),sn=At(O,sn=fa(sn,Te)),Te.h)break;if(Ze-R<sn||ne-Ze<bt)break e;for(qt=0;qt<bt;++qt)T[Ze+qt]=T[Ze+qt-sn];for(Ze+=bt,me+=bt;me>=O;)me-=O,++de,ae!=null&&de<=se&&!(de%16)&&ae(y,de);if(e(Ze<=ne),me&et&&(gt=vs(Ie,me,de)),We!=null)for(;ve<Ze;)bt=T[ve++],We.X[(506832829*bt&4294967295)>>>We.Mb]=bt}else{if(!(bt<$e))break e;for(Tt=bt-280,e(We!=null);ve<Ze;)bt=T[ve++],We.X[(506832829*bt&4294967295)>>>We.Mb]=bt;bt=Ze,e(!(Tt>>>(sn=We).Xa)),T[bt]=sn.X[Tt],Tt=!0}Tt||e(Te.h==ue(Te))}if(y.Pb&&Te.h&&Ze<ne)e(y.m.h),y.a=5,y.m=y.wd,y.$=y.xd,0<y.s.ua&&St(y.s.vb,y.s.Wa);else{if(Te.h)break e;ae?.(y,de>se?se:de),y.a=0,y.$=Ze-R}return 1}return y.a=3,0}function qa(y){e(y!=null),y.vc=null,y.yc=null,y.Ya=null;var T=y.Wa;T!=null&&(T.X=null),y.vb=null,e(y!=null)}function Yl(){var y=new hn;return y==null?null:(y.a=0,y.xb=Qd,$t("Predictor","VP8LPredictors"),$t("Predictor","VP8LPredictors_C"),$t("PredictorAdd","VP8LPredictorsAdd"),$t("PredictorAdd","VP8LPredictorsAdd_C"),ws=ft,sd=On,to=zn,dl=Nn,Io=on,Sa=Sn,qr=lt,G.VP8LMapColor32b=La,G.VP8LMapColor8b=Pr,y)}function Va(y,T,R,O,ne){var se=1,ae=[y],de=[T],me=O.m,Te=O.s,Ie=null,Ze=0;e:for(;;){if(R)for(;se&&Z(me,1);){var ve=ae,Be=de,$e=O,ut=1,We=$e.m,et=$e.gc[$e.ab],gt=Z(We,2);if($e.Oc&1<<gt)se=0;else{switch($e.Oc|=1<<gt,et.hc=gt,et.Ea=ve[0],et.nc=Be[0],et.K=[null],++$e.ab,e(4>=$e.ab),gt){case 0:case 1:et.b=Z(We,3)+2,ut=Va(at(et.Ea,et.b),at(et.nc,et.b),0,$e,et.K),et.K=et.K[0];break;case 3:var Tt,bt=Z(We,8)+1,sn=16<bt?0:4<bt?1:2<bt?2:3;if(ve[0]=at(et.Ea,sn),et.b=sn,Tt=ut=Va(bt,1,0,$e,et.K)){var qt,rn=bt,Bt=et,ni=1<<(8>>Bt.b),ts=o(ni);if(ts==null)Tt=0;else{var Yn=Bt.K[0],Ht=Bt.w;for(ts[0]=Bt.K[0][0],qt=1;qt<1*rn;++qt)ts[qt]=en(Yn[Ht+qt],ts[qt-1]);for(;qt<4*ni;++qt)ts[qt]=0;Bt.K[0]=null,Bt.K[0]=ts,Tt=1}}ut=Tt;break;case 2:break;default:e(0)}se=ut}}if(ae=ae[0],de=de[0],se&&Z(me,1)&&!(se=1<=(Ze=Z(me,4))&&11>=Ze)){O.a=3;break e}var Rt;if(Rt=se)t:{var Ws,Pn,Hn,si=O,Ui=ae,Ts=de,Li=Ze,Ms=R,Kr=si.m,Gi=si.s,ii=[null],Mi=1,zs=0,zi=yo[Li];n:for(;;){if(Ms&&Z(Kr,1)){var yr=Z(Kr,3)+2,Ns=at(Ui,yr),gi=at(Ts,yr),Cs=Ns*gi;if(!Va(Ns,gi,0,si,ii))break n;for(ii=ii[0],Gi.xc=yr,Ws=0;Ws<Cs;++Ws){var Hi=ii[Ws]>>8&65535;ii[Ws]=Hi,Hi>=Mi&&(Mi=Hi+1)}}if(Kr.h)break n;for(Pn=0;5>Pn;++Pn){var er=mo[Pn];!Pn&&0<Li&&(er+=1<<Li),zs<er&&(zs=er)}var dr=d(Mi*zi,te),ns=Mi,Ii=d(ns,re);if(Ii==null)var xr=null;else e(65536>=ns),xr=Ii;var _s=o(zs);if(xr==null||_s==null||dr==null){si.a=1;break n}var bn=dr;for(Ws=Hn=0;Ws<Mi;++Ws){var vn=xr[Ws],Ai=vn.G,Zr=vn.H,so=0,aa=1,$s=0;for(Pn=0;5>Pn;++Pn){er=mo[Pn],Ai[Pn]=bn,Zr[Pn]=Hn,!Pn&&0<Li&&(er+=1<<Li);s:{var zl,Cc=er,Il=si,ps=_s,Vc=bn,eu=Hn,Rd=0,qo=Il.m,xh=Z(qo,1);if(s(ps,0,0,Cc),xh){var _c=Z(qo,1)+1,Dd=Z(qo,1),Ld=Z(qo,Dd==0?1:8);ps[Ld]=1,_c==2&&(ps[Ld=Z(qo,8)]=1);var Dr=1}else{var Ps=o(19),kc=Z(qo,4)+4;if(19<kc){Il.a=3;var wo=0;break s}for(zl=0;zl<kc;++zl)Ps[ad[zl]]=Z(qo,3);var rc=void 0,gl=void 0,Bl=Il,ld=Ps,cd=Cc,Wc=ps,So=0,Jr=Bl.m,ml=8,Iu=d(128,te);i:for(;N(Iu,0,7,ld,19);){if(Z(Jr,1)){var bh=2+2*Z(Jr,3);if((rc=2+Z(Jr,bh))>cd)break i}else rc=cd;for(gl=0;gl<cd&&rc--;){Pe(Jr);var Bu=Iu[0+(127&Y(Jr))];Ne(Jr,Jr.u+Bu.g);var jc=Bu.value;if(16>jc)Wc[gl++]=jc,jc!=0&&(ml=jc);else{var vh=jc==16,wh=jc-16,Ou=tc[wh],tu=Z(Jr,Ba[wh])+Ou;if(gl+tu>cd)break i;for(var ac=vh?ml:0;0<tu--;)Wc[gl++]=ac}}So=1;break i}So||(Bl.a=3),Dr=So}(Dr=Dr&&!qo.h)&&(Rd=N(Vc,eu,8,ps,Cc)),Dr&&Rd!=0?wo=Rd:(Il.a=3,wo=0)}if(wo==0)break n;if(aa&&Rl[Pn]==1&&(aa=bn[Hn].g==0),so+=bn[Hn].g,Hn+=wo,3>=Pn){var $c,nu=_s[0];for($c=1;$c<er;++$c)_s[$c]>nu&&(nu=_s[$c]);$s+=nu}}if(vn.nd=aa,vn.Qb=0,aa&&(vn.qb=(Ai[3][Zr[3]+0].value<<24|Ai[1][Zr[1]+0].value<<16|Ai[2][Zr[2]+0].value)>>>0,so==0&&256>Ai[0][Zr[0]+0].value&&(vn.Qb=1,vn.qb+=Ai[0][Zr[0]+0].value<<8)),vn.jc=!vn.Qb&&6>$s,vn.jc){var Md,Ol=vn;for(Md=0;Md<po;++Md){var oc=Md,lc=Ol.pd[oc],iu=Ol.G[0][Ol.H[0]+oc];256<=iu.value?(lc.g=iu.g+256,lc.value=iu.value):(lc.g=0,lc.value=0,oc>>=ei(iu,8,lc),oc>>=ei(Ol.G[1][Ol.H[1]+oc],16,lc),oc>>=ei(Ol.G[2][Ol.H[2]+oc],0,lc),ei(Ol.G[3][Ol.H[3]+oc],24,lc))}}}Gi.vc=ii,Gi.Wb=Mi,Gi.Ya=xr,Gi.yc=dr,Rt=1;break t}Rt=0}if(!(se=Rt)){O.a=3;break e}if(0<Ze){if(Te.ua=1<<Ze,!pe(Te.Wa,Ze)){O.a=1,se=0;break e}}else Te.ua=0;var su=O,Gc=ae,Sh=de,dd=su.s,Fl=dd.xc;if(su.c=Gc,su.i=Sh,dd.md=at(Gc,Fl),dd.wc=Fl==0?-1:(1<<Fl)-1,R){O.xb=ic;break e}if((Ie=o(ae*de))==null){O.a=1,se=0;break e}se=(se=pa(O,Ie,0,ae,de,de,null))&&!me.h;break e}return se?(ne!=null?ne[0]=Ie:(e(Ie==null),e(R)),O.$=0,R||qa(Te)):qa(Te),se}function Wa(y,T){var R=y.c*y.i,O=R+T+16*T;return e(y.c<=T),y.V=o(O),y.V==null?(y.Ta=null,y.Ua=0,y.a=1,0):(y.Ta=y.V,y.Ua=y.Ba+R+T,1)}function No(y,T){var R=y.C,O=T-R,ne=y.V,se=y.Ba+y.c*R;for(e(T<=y.l.o);0<O;){var ae=16<O?16:O,de=y.l.ma,me=y.l.width,Te=me*ae,Ie=de.ca,Ze=de.tb+me*R,ve=y.Ta,Be=y.Ua;Ji(y,ae,ne,se),qs(ve,Be,Ie,Ze,Te),Si(de,R,R+ae,Ie,Ze,me),O-=ae,ne+=ae*y.c,R+=ae}e(R==T),y.C=y.Ma=T}function $n(){this.ub=this.yd=this.td=this.Rb=0}function Fr(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function xi(){this.Fb=this.Bb=this.Cb=0,this.Zb=o(4),this.Lb=o(4)}function ga(){this.Yb=(function(){var y=[];return(function T(R,O,ne){for(var se=ne[O],ae=0;ae<se&&(R.push(ne.length>O+1?[]:0),!(ne.length<O+1));ae++)T(R[ae],O+1,ne)})(y,0,[3,11]),y})()}function En(){this.jb=o(3),this.Wc=c([4,8],ga),this.Xc=c([4,17],ga)}function Qo(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new o(4),this.od=new o(4)}function pi(){this.ld=this.La=this.dd=this.tc=0}function ma(){this.Na=this.la=0}function Pa(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function el(){this.ad=o(384),this.Za=0,this.Ob=o(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function tl(){this.uc=this.M=this.Nb=0,this.wa=Array(new pi),this.Y=0,this.ya=Array(new el),this.aa=0,this.l=new nl}function $a(){this.y=o(16),this.f=o(8),this.ea=o(8)}function td(){this.cb=this.a=0,this.sc="",this.m=new D,this.Od=new $n,this.Kc=new Fr,this.ed=new Qo,this.Qa=new xi,this.Ic=this.$c=this.Aa=0,this.D=new tl,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=d(8,D),this.ia=0,this.pb=d(4,Pa),this.Pa=new En,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new $a),this.Hd=0,this.rb=Array(new ma),this.sb=0,this.wa=Array(new pi),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new el),this.L=this.aa=0,this.gd=c([4,2],pi),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ss(y,T){return 0>y?0:y>T?T:y}function nl(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Un(){var y=new td;return y!=null&&(y.a=0,y.sc="OK",y.cb=0,y.Xb=0,Rr||(Rr=Fs)),y}function Fn(y,T,R){return y.a==0&&(y.a=T,y.sc=R,y.cb=0),0}function il(y,T,R){return 3<=R&&y[T+0]==157&&y[T+1]==1&&y[T+2]==42}function Ga(y,T){if(y==null)return 0;if(y.a=0,y.sc="OK",T==null)return Fn(y,2,"null VP8Io passed to VP8GetHeaders()");var R=T.data,O=T.w,ne=T.ha;if(4>ne)return Fn(y,7,"Truncated header.");var se=R[O+0]|R[O+1]<<8|R[O+2]<<16,ae=y.Od;if(ae.Rb=!(1&se),ae.td=se>>1&7,ae.yd=se>>4&1,ae.ub=se>>5,3<ae.td)return Fn(y,3,"Incorrect keyframe parameters.");if(!ae.yd)return Fn(y,4,"Frame not displayable.");O+=3,ne-=3;var de=y.Kc;if(ae.Rb){if(7>ne)return Fn(y,7,"cannot parse picture header");if(!il(R,O,ne))return Fn(y,3,"Bad code word");de.c=16383&(R[O+4]<<8|R[O+3]),de.Td=R[O+4]>>6,de.i=16383&(R[O+6]<<8|R[O+5]),de.Ud=R[O+6]>>6,O+=7,ne-=7,y.za=de.c+15>>4,y.Ub=de.i+15>>4,T.width=de.c,T.height=de.i,T.Da=0,T.j=0,T.v=0,T.va=T.width,T.o=T.height,T.da=0,T.ib=T.width,T.hb=T.height,T.U=T.width,T.T=T.height,s((se=y.Pa).jb,0,255,se.jb.length),e((se=y.Qa)!=null),se.Cb=0,se.Bb=0,se.Fb=1,s(se.Zb,0,0,se.Zb.length),s(se.Lb,0,0,se.Lb)}if(ae.ub>ne)return Fn(y,7,"bad partition length");q(se=y.m,R,O,ae.ub),O+=ae.ub,ne-=ae.ub,ae.Rb&&(de.Ld=Re(se),de.Kd=Re(se)),de=y.Qa;var me,Te=y.Pa;if(e(se!=null),e(de!=null),de.Cb=Re(se),de.Cb){if(de.Bb=Re(se),Re(se)){for(de.Fb=Re(se),me=0;4>me;++me)de.Zb[me]=Re(se)?ce(se,7):0;for(me=0;4>me;++me)de.Lb[me]=Re(se)?ce(se,6):0}if(de.Bb)for(me=0;3>me;++me)Te.jb[me]=Re(se)?J(se,8):255}else de.Bb=0;if(se.Ka)return Fn(y,3,"cannot parse segment header");if((de=y.ed).zd=Re(se),de.Tb=J(se,6),de.wb=J(se,3),de.Pc=Re(se),de.Pc&&Re(se)){for(Te=0;4>Te;++Te)Re(se)&&(de.vd[Te]=ce(se,6));for(Te=0;4>Te;++Te)Re(se)&&(de.od[Te]=ce(se,6))}if(y.L=de.Tb==0?0:de.zd?1:2,se.Ka)return Fn(y,3,"cannot parse filter header");var Ie=ne;if(ne=me=O,O=me+Ie,de=Ie,y.Xb=(1<<J(y.m,2))-1,Ie<3*(Te=y.Xb))R=7;else{for(me+=3*Te,de-=3*Te,Ie=0;Ie<Te;++Ie){var Ze=R[ne+0]|R[ne+1]<<8|R[ne+2]<<16;Ze>de&&(Ze=de),q(y.Jc[+Ie],R,me,Ze),me+=Ze,de-=Ze,ne+=3}q(y.Jc[+Te],R,me,de),R=me<O?0:5}if(R!=0)return Fn(y,R,"cannot parse partitions");for(R=J(me=y.m,7),ne=Re(me)?ce(me,4):0,O=Re(me)?ce(me,4):0,de=Re(me)?ce(me,4):0,Te=Re(me)?ce(me,4):0,me=Re(me)?ce(me,4):0,Ie=y.Qa,Ze=0;4>Ze;++Ze){if(Ie.Cb){var ve=Ie.Zb[Ze];Ie.Fb||(ve+=R)}else{if(0<Ze){y.pb[Ze]=y.pb[0];continue}ve=R}var Be=y.pb[Ze];Be.Sc[0]=Oa[ss(ve+ne,127)],Be.Sc[1]=xo[ss(ve+0,127)],Be.Eb[0]=2*Oa[ss(ve+O,127)],Be.Eb[1]=101581*xo[ss(ve+de,127)]>>16,8>Be.Eb[1]&&(Be.Eb[1]=8),Be.Qc[0]=Oa[ss(ve+Te,117)],Be.Qc[1]=xo[ss(ve+me,127)],Be.lc=ve+me}if(!ae.Rb)return Fn(y,4,"Not a key frame.");for(Re(se),ae=y.Pa,R=0;4>R;++R){for(ne=0;8>ne;++ne)for(O=0;3>O;++O)for(de=0;11>de;++de)Te=Ke(se,As[R][ne][O][de])?J(se,8):Dl[R][ne][O][de],ae.Wc[R][ne].Yb[O][de]=Te;for(ne=0;17>ne;++ne)ae.Xc[R][ne]=ae.Wc[R][ji[ne]]}return y.kc=Re(se),y.kc&&(y.Bd=J(se,8)),y.cb=1}function Fs(y,T,R,O,ne,se,ae){var de=T[ne].Yb[R];for(R=0;16>ne;++ne){if(!Ke(y,de[R+0]))return ne;for(;!Ke(y,de[R+1]);)if(de=T[++ne].Yb[0],R=0,ne==16)return 16;var me=T[ne+1].Yb;if(Ke(y,de[R+2])){var Te=y,Ie=0;if(Ke(Te,(ve=de)[(Ze=R)+3]))if(Ke(Te,ve[Ze+6])){for(de=0,Ze=2*(Ie=Ke(Te,ve[Ze+8]))+(ve=Ke(Te,ve[Ze+9+Ie])),Ie=0,ve=Tc[Ze];ve[de];++de)Ie+=Ie+Ke(Te,ve[de]);Ie+=3+(8<<Ze)}else Ke(Te,ve[Ze+7])?(Ie=7+2*Ke(Te,165),Ie+=Ke(Te,145)):Ie=5+Ke(Te,159);else Ie=Ke(Te,ve[Ze+4])?3+Ke(Te,ve[Ze+5]):2;de=me[2]}else Ie=1,de=me[1];me=ae+od[ne],0>(Te=y).b&&Ue(Te);var Ze,ve=Te.b,Be=(Ze=Te.Ca>>1)-(Te.I>>ve)>>31;--Te.b,Te.Ca+=Be,Te.Ca|=1,Te.I-=(Ze+1&Be)<<ve,se[me]=((Ie^Be)-Be)*O[(0<ne)+0]}return 16}function _r(y){var T=y.rb[y.sb-1];T.la=0,T.Na=0,s(y.zc,0,0,y.zc.length),y.ja=0}function us(y,T,R,O,ne){ne=y[T+R+32*O]+(ne>>3),y[T+R+32*O]=-256&ne?0>ne?0:255:ne}function Vn(y,T,R,O,ne,se){us(y,T,0,R,O+ne),us(y,T,1,R,O+se),us(y,T,2,R,O-se),us(y,T,3,R,O-ne)}function bi(y){return(20091*y>>16)+y}function Xl(y,T,R,O){var ne,se=0,ae=o(16);for(ne=0;4>ne;++ne){var de=y[T+0]+y[T+8],me=y[T+0]-y[T+8],Te=(35468*y[T+4]>>16)-bi(y[T+12]),Ie=bi(y[T+4])+(35468*y[T+12]>>16);ae[se+0]=de+Ie,ae[se+1]=me+Te,ae[se+2]=me-Te,ae[se+3]=de-Ie,se+=4,T++}for(ne=se=0;4>ne;++ne)de=(y=ae[se+0]+4)+ae[se+8],me=y-ae[se+8],Te=(35468*ae[se+4]>>16)-bi(ae[se+12]),us(R,O,0,0,de+(Ie=bi(ae[se+4])+(35468*ae[se+12]>>16))),us(R,O,1,0,me+Te),us(R,O,2,0,me-Te),us(R,O,3,0,de-Ie),se++,O+=32}function bc(y,T,R,O){var ne=y[T+0]+4,se=35468*y[T+4]>>16,ae=bi(y[T+4]),de=35468*y[T+1]>>16;Vn(R,O,0,ne+ae,y=bi(y[T+1]),de),Vn(R,O,1,ne+se,y,de),Vn(R,O,2,ne-se,y,de),Vn(R,O,3,ne-ae,y,de)}function ya(y,T,R,O,ne){Xl(y,T,R,O),ne&&Xl(y,T+16,R,O+4)}function kr(y,T,R,O){Bo(y,T+0,R,O,1),Bo(y,T+32,R,O+128,1)}function sl(y,T,R,O){var ne;for(y=y[T+0]+4,ne=0;4>ne;++ne)for(T=0;4>T;++T)us(R,O,T,ne,y)}function Ya(y,T,R,O){y[T+0]&&$i(y,T+0,R,O),y[T+16]&&$i(y,T+16,R,O+4),y[T+32]&&$i(y,T+32,R,O+128),y[T+48]&&$i(y,T+48,R,O+128+4)}function jr(y,T,R,O){var ne,se=o(16);for(ne=0;4>ne;++ne){var ae=y[T+0+ne]+y[T+12+ne],de=y[T+4+ne]+y[T+8+ne],me=y[T+4+ne]-y[T+8+ne],Te=y[T+0+ne]-y[T+12+ne];se[0+ne]=ae+de,se[8+ne]=ae-de,se[4+ne]=Te+me,se[12+ne]=Te-me}for(ne=0;4>ne;++ne)ae=(y=se[0+4*ne]+3)+se[3+4*ne],de=se[1+4*ne]+se[2+4*ne],me=se[1+4*ne]-se[2+4*ne],Te=y-se[3+4*ne],R[O+0]=ae+de>>3,R[O+16]=Te+me>>3,R[O+32]=ae-de>>3,R[O+48]=Te-me>>3,O+=64}function na(y,T,R){var O,ne=T-32,se=ls,ae=255-y[ne-1];for(O=0;O<R;++O){var de,me=se,Te=ae+y[T-1];for(de=0;de<R;++de)y[T+de]=me[Te+y[ne+de]];T+=32}}function Et(y,T){na(y,T,4)}function Qi(y,T){na(y,T,8)}function fr(y,T){na(y,T,16)}function Al(y,T){var R;for(R=0;16>R;++R)n(y,T+32*R,y,T-32,16)}function Xa(y,T){var R;for(R=16;0<R;--R)s(y,T,y[T-1],16),T+=32}function Ea(y,T,R){var O;for(O=0;16>O;++O)s(T,R+32*O,y,16)}function co(y,T){var R,O=16;for(R=0;16>R;++R)O+=y[T-1+32*R]+y[T+R-32];Ea(O>>5,y,T)}function rs(y,T){var R,O=8;for(R=0;16>R;++R)O+=y[T-1+32*R];Ea(O>>4,y,T)}function es(y,T){var R,O=8;for(R=0;16>R;++R)O+=y[T+R-32];Ea(O>>4,y,T)}function Po(y,T){Ea(128,y,T)}function In(y,T,R){return y+2*T+R+2>>2}function ti(y,T){var R,O=T-32;for(O=new Uint8Array([In(y[O-1],y[O+0],y[O+1]),In(y[O+0],y[O+1],y[O+2]),In(y[O+1],y[O+2],y[O+3]),In(y[O+2],y[O+3],y[O+4])]),R=0;4>R;++R)n(y,T+32*R,O,0,O.length)}function Tn(y,T){var R=y[T-1],O=y[T-1+32],ne=y[T-1+64],se=y[T-1+96];Je(y,T+0,16843009*In(y[T-1-32],R,O)),Je(y,T+32,16843009*In(R,O,ne)),Je(y,T+64,16843009*In(O,ne,se)),Je(y,T+96,16843009*In(ne,se,se))}function Hc(y,T){var R,O=4;for(R=0;4>R;++R)O+=y[T+R-32]+y[T-1+32*R];for(O>>=3,R=0;4>R;++R)s(y,T+32*R,O,4)}function xa(y,T){var R=y[T-1+0],O=y[T-1+32],ne=y[T-1+64],se=y[T-1-32],ae=y[T+0-32],de=y[T+1-32],me=y[T+2-32],Te=y[T+3-32];y[T+0+96]=In(O,ne,y[T-1+96]),y[T+1+96]=y[T+0+64]=In(R,O,ne),y[T+2+96]=y[T+1+64]=y[T+0+32]=In(se,R,O),y[T+3+96]=y[T+2+64]=y[T+1+32]=y[T+0+0]=In(ae,se,R),y[T+3+64]=y[T+2+32]=y[T+1+0]=In(de,ae,se),y[T+3+32]=y[T+2+0]=In(me,de,ae),y[T+3+0]=In(Te,me,de)}function ln(y,T){var R=y[T+1-32],O=y[T+2-32],ne=y[T+3-32],se=y[T+4-32],ae=y[T+5-32],de=y[T+6-32],me=y[T+7-32];y[T+0+0]=In(y[T+0-32],R,O),y[T+1+0]=y[T+0+32]=In(R,O,ne),y[T+2+0]=y[T+1+32]=y[T+0+64]=In(O,ne,se),y[T+3+0]=y[T+2+32]=y[T+1+64]=y[T+0+96]=In(ne,se,ae),y[T+3+32]=y[T+2+64]=y[T+1+96]=In(se,ae,de),y[T+3+64]=y[T+2+96]=In(ae,de,me),y[T+3+96]=In(de,me,me)}function Cn(y,T){var R=y[T-1+0],O=y[T-1+32],ne=y[T-1+64],se=y[T-1-32],ae=y[T+0-32],de=y[T+1-32],me=y[T+2-32],Te=y[T+3-32];y[T+0+0]=y[T+1+64]=se+ae+1>>1,y[T+1+0]=y[T+2+64]=ae+de+1>>1,y[T+2+0]=y[T+3+64]=de+me+1>>1,y[T+3+0]=me+Te+1>>1,y[T+0+96]=In(ne,O,R),y[T+0+64]=In(O,R,se),y[T+0+32]=y[T+1+96]=In(R,se,ae),y[T+1+32]=y[T+2+96]=In(se,ae,de),y[T+2+32]=y[T+3+96]=In(ae,de,me),y[T+3+32]=In(de,me,Te)}function ri(y,T){var R=y[T+0-32],O=y[T+1-32],ne=y[T+2-32],se=y[T+3-32],ae=y[T+4-32],de=y[T+5-32],me=y[T+6-32],Te=y[T+7-32];y[T+0+0]=R+O+1>>1,y[T+1+0]=y[T+0+64]=O+ne+1>>1,y[T+2+0]=y[T+1+64]=ne+se+1>>1,y[T+3+0]=y[T+2+64]=se+ae+1>>1,y[T+0+32]=In(R,O,ne),y[T+1+32]=y[T+0+96]=In(O,ne,se),y[T+2+32]=y[T+1+96]=In(ne,se,ae),y[T+3+32]=y[T+2+96]=In(se,ae,de),y[T+3+64]=In(ae,de,me),y[T+3+96]=In(de,me,Te)}function tn(y,T){var R=y[T-1+0],O=y[T-1+32],ne=y[T-1+64],se=y[T-1+96];y[T+0+0]=R+O+1>>1,y[T+2+0]=y[T+0+32]=O+ne+1>>1,y[T+2+32]=y[T+0+64]=ne+se+1>>1,y[T+1+0]=In(R,O,ne),y[T+3+0]=y[T+1+32]=In(O,ne,se),y[T+3+32]=y[T+1+64]=In(ne,se,se),y[T+3+64]=y[T+2+64]=y[T+0+96]=y[T+1+96]=y[T+2+96]=y[T+3+96]=se}function ai(y,T){var R=y[T-1+0],O=y[T-1+32],ne=y[T-1+64],se=y[T-1+96],ae=y[T-1-32],de=y[T+0-32],me=y[T+1-32],Te=y[T+2-32];y[T+0+0]=y[T+2+32]=R+ae+1>>1,y[T+0+32]=y[T+2+64]=O+R+1>>1,y[T+0+64]=y[T+2+96]=ne+O+1>>1,y[T+0+96]=se+ne+1>>1,y[T+3+0]=In(de,me,Te),y[T+2+0]=In(ae,de,me),y[T+1+0]=y[T+3+32]=In(R,ae,de),y[T+1+32]=y[T+3+64]=In(O,R,ae),y[T+1+64]=y[T+3+96]=In(ne,O,R),y[T+1+96]=In(se,ne,O)}function pn(y,T){var R;for(R=0;8>R;++R)n(y,T+32*R,y,T-32,8)}function Zd(y,T){var R;for(R=0;8>R;++R)s(y,T,y[T-1],8),T+=32}function It(y,T,R){var O;for(O=0;8>O;++O)s(T,R+32*O,y,8)}function Pi(y,T){var R,O=8;for(R=0;8>R;++R)O+=y[T+R-32]+y[T-1+32*R];It(O>>4,y,T)}function Yt(y,T){var R,O=4;for(R=0;8>R;++R)O+=y[T+R-32];It(O>>3,y,T)}function Gn(y,T){var R,O=4;for(R=0;8>R;++R)O+=y[T-1+32*R];It(O>>3,y,T)}function Ur(y,T){It(128,y,T)}function Ka(y,T,R){var O=y[T-R],ne=y[T+0],se=3*(ne-O)+Oo[1020+y[T-2*R]-y[T+R]],ae=Fi[112+(se+4>>3)];y[T-R]=ls[255+O+Fi[112+(se+3>>3)]],y[T+0]=ls[255+ne-ae]}function Zs(y,T,R,O){var ne=y[T+0],se=y[T+R];return Er[255+y[T-2*R]-y[T-R]]>O||Er[255+se-ne]>O}function rl(y,T,R,O){return 4*Er[255+y[T-R]-y[T+0]]+Er[255+y[T-2*R]-y[T+R]]<=O}function Ra(y,T,R,O,ne){var se=y[T-3*R],ae=y[T-2*R],de=y[T-R],me=y[T+0],Te=y[T+R],Ie=y[T+2*R],Ze=y[T+3*R];return 4*Er[255+de-me]+Er[255+ae-Te]>O?0:Er[255+y[T-4*R]-se]<=ne&&Er[255+se-ae]<=ne&&Er[255+ae-de]<=ne&&Er[255+Ze-Ie]<=ne&&Er[255+Ie-Te]<=ne&&Er[255+Te-me]<=ne}function Za(y,T,R,O){var ne=2*O+1;for(O=0;16>O;++O)rl(y,T+O,R,ne)&&Ka(y,T+O,R)}function al(y,T,R,O){var ne=2*O+1;for(O=0;16>O;++O)rl(y,T+O*R,1,ne)&&Ka(y,T+O*R,1)}function vc(y,T,R,O){var ne;for(ne=3;0<ne;--ne)Za(y,T+=4*R,R,O)}function Kl(y,T,R,O){var ne;for(ne=3;0<ne;--ne)al(y,T+=4,R,O)}function Tl(y,T,R,O,ne,se,ae,de){for(se=2*se+1;0<ne--;){if(Ra(y,T,R,se,ae))if(Zs(y,T,R,de))Ka(y,T,R);else{var me=y,Te=T,Ie=R,Ze=me[Te-2*Ie],ve=me[Te-Ie],Be=me[Te+0],$e=me[Te+Ie],ut=me[Te+2*Ie],We=27*(gt=Oo[1020+3*(Be-ve)+Oo[1020+Ze-$e]])+63>>7,et=18*gt+63>>7,gt=9*gt+63>>7;me[Te-3*Ie]=ls[255+me[Te-3*Ie]+gt],me[Te-2*Ie]=ls[255+Ze+et],me[Te-Ie]=ls[255+ve+We],me[Te+0]=ls[255+Be-We],me[Te+Ie]=ls[255+$e-et],me[Te+2*Ie]=ls[255+ut-gt]}T+=O}}function Eo(y,T,R,O,ne,se,ae,de){for(se=2*se+1;0<ne--;){if(Ra(y,T,R,se,ae))if(Zs(y,T,R,de))Ka(y,T,R);else{var me=y,Te=T,Ie=R,Ze=me[Te-Ie],ve=me[Te+0],Be=me[Te+Ie],$e=Fi[112+(4+(ut=3*(ve-Ze))>>3)],ut=Fi[112+(ut+3>>3)],We=$e+1>>1;me[Te-2*Ie]=ls[255+me[Te-2*Ie]+We],me[Te-Ie]=ls[255+Ze+ut],me[Te+0]=ls[255+ve-$e],me[Te+Ie]=ls[255+Be-We]}T+=O}}function Jd(y,T,R,O,ne,se){Tl(y,T,R,1,16,O,ne,se)}function gn(y,T,R,O,ne,se){Tl(y,T,1,R,16,O,ne,se)}function Ro(y,T,R,O,ne,se){var ae;for(ae=3;0<ae;--ae)Eo(y,T+=4*R,R,1,16,O,ne,se)}function P(y,T,R,O,ne,se){var ae;for(ae=3;0<ae;--ae)Eo(y,T+=4,1,R,16,O,ne,se)}function ee(y,T,R,O,ne,se,ae,de){Tl(y,T,ne,1,8,se,ae,de),Tl(R,O,ne,1,8,se,ae,de)}function we(y,T,R,O,ne,se,ae,de){Tl(y,T,1,ne,8,se,ae,de),Tl(R,O,1,ne,8,se,ae,de)}function De(y,T,R,O,ne,se,ae,de){Eo(y,T+4*ne,ne,1,8,se,ae,de),Eo(R,O+4*ne,ne,1,8,se,ae,de)}function Fe(y,T,R,O,ne,se,ae,de){Eo(y,T+4,1,ne,8,se,ae,de),Eo(R,O+4,1,ne,8,se,ae,de)}function rt(){this.ba=new qn,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Kt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function mt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Vt(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function mn(){this.ua=0,this.Wa=new Ut,this.vb=new Ut,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new re,this.yc=new te}function hn(){this.xb=this.a=0,this.l=new nl,this.ca=new qn,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new H,this.Pb=0,this.wd=new H,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new mn,this.ab=0,this.gc=d(4,Vt),this.Oc=0}function Jn(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new nl,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function vi(y,T,R,O,ne,se,ae){for(y=y==null?0:y[T+0],T=0;T<ae;++T)ne[se+T]=y+R[O+T]&255,y=ne[se+T]}function Us(y,T,R,O,ne,se,ae){var de;if(y==null)vi(null,null,R,O,ne,se,ae);else for(de=0;de<ae;++de)ne[se+de]=y[T+de]+R[O+de]&255}function Ni(y,T,R,O,ne,se,ae){if(y==null)vi(null,null,R,O,ne,se,ae);else{var de,me=y[T+0],Te=me,Ie=me;for(de=0;de<ae;++de)Te=Ie+(me=y[T+de])-Te,Ie=R[O+de]+(-256&Te?0>Te?0:255:Te)&255,Te=me,ne[se+de]=Ie}}function Wi(y,T,R,O){var ne=T.width,se=T.o;if(e(y!=null&&T!=null),0>R||0>=O||R+O>se)return null;if(!y.Cc){if(y.ga==null){var ae;if(y.ga=new Jn,(ae=y.ga==null)||(ae=T.width*T.o,e(y.Gb.length==0),y.Gb=o(ae),y.Uc=0,y.Gb==null?ae=0:(y.mb=y.Gb,y.nb=y.Uc,y.rc=null,ae=1),ae=!ae),!ae){ae=y.ga;var de=y.Fa,me=y.P,Te=y.qc,Ie=y.mb,Ze=y.nb,ve=me+1,Be=Te-1,$e=ae.l;if(e(de!=null&&Ie!=null&&T!=null),Ll[0]=null,Ll[1]=vi,Ll[2]=Us,Ll[3]=Ni,ae.ca=Ie,ae.tb=Ze,ae.c=T.width,ae.i=T.height,e(0<ae.c&&0<ae.i),1>=Te)T=0;else if(ae.$a=3&de[me+0],ae.Z=de[me+0]>>2&3,ae.Lc=de[me+0]>>4&3,me=de[me+0]>>6&3,0>ae.$a||1<ae.$a||4<=ae.Z||1<ae.Lc||me)T=0;else if($e.put=Zt,$e.ac=Br,$e.bc=Or,$e.ma=ae,$e.width=T.width,$e.height=T.height,$e.Da=T.Da,$e.v=T.v,$e.va=T.va,$e.j=T.j,$e.o=T.o,ae.$a)e:{e(ae.$a==1),T=Yl();t:for(;;){if(T==null){T=0;break e}if(e(ae!=null),ae.mc=T,T.c=ae.c,T.i=ae.i,T.l=ae.l,T.l.ma=ae,T.l.width=ae.c,T.l.height=ae.i,T.a=0,_e(T.m,de,ve,Be),!Va(ae.c,ae.i,1,T,null)||(T.ab==1&&T.gc[0].hc==3&&Ci(T.s)?(ae.ic=1,de=T.c*T.i,T.Ta=null,T.Ua=0,T.V=o(de),T.Ba=0,T.V==null?(T.a=1,T=0):T=1):(ae.ic=0,T=Wa(T,ae.c)),!T))break t;T=1;break e}ae.mc=null,T=0}else T=Be>=ae.c*ae.i;ae=!T}if(ae)return null;y.ga.Lc!=1?y.Ga=0:O=se-R}e(y.ga!=null),e(R+O<=se);e:{if(T=(de=y.ga).c,se=de.l.o,de.$a==0){if(ve=y.rc,Be=y.Vc,$e=y.Fa,me=y.P+1+R*T,Te=y.mb,Ie=y.nb+R*T,e(me<=y.P+y.qc),de.Z!=0)for(e(Ll[de.Z]!=null),ae=0;ae<O;++ae)Ll[de.Z](ve,Be,$e,me,Te,Ie,T),ve=Te,Be=Ie,Ie+=T,me+=T;else for(ae=0;ae<O;++ae)n(Te,Ie,$e,me,T),ve=Te,Be=Ie,Ie+=T,me+=T;y.rc=ve,y.Vc=Be}else{if(e(de.mc!=null),T=R+O,e((ae=de.mc)!=null),e(T<=ae.i),ae.C>=T)T=1;else if(de.ic||Nr(),de.ic){de=ae.V,ve=ae.Ba,Be=ae.c;var ut=ae.i,We=($e=1,me=ae.$/Be,Te=ae.$%Be,Ie=ae.m,Ze=ae.s,ae.$),et=Be*ut,gt=Be*T,Tt=Ze.wc,bt=We<gt?vs(Ze,Te,me):null;e(We<=et),e(T<=ut),e(Ci(Ze));t:for(;;){for(;!Ie.h&&We<gt;){if(Te&Tt||(bt=vs(Ze,Te,me)),e(bt!=null),Pe(Ie),256>(ut=fi(bt.G[0],bt.H[0],Ie)))de[ve+We]=ut,++We,++Te>=Be&&(Te=0,++me<=T&&!(me%16)&&Cr(ae,me));else{if(!(280>ut)){$e=0;break t}ut=fa(ut-256,Ie);var sn,qt=fi(bt.G[4],bt.H[4],Ie);if(Pe(Ie),!(We>=(qt=At(Be,qt=fa(qt,Ie)))&&et-We>=ut)){$e=0;break t}for(sn=0;sn<ut;++sn)de[ve+We+sn]=de[ve+We+sn-qt];for(We+=ut,Te+=ut;Te>=Be;)Te-=Be,++me<=T&&!(me%16)&&Cr(ae,me);We<gt&&Te&Tt&&(bt=vs(Ze,Te,me))}e(Ie.h==ue(Ie))}Cr(ae,me>T?T:me);break t}!$e||Ie.h&&We<et?($e=0,ae.a=Ie.h?5:3):ae.$=We,T=$e}else T=pa(ae,ae.V,ae.Ba,ae.c,ae.i,T,No);if(!T){O=0;break e}}R+O>=se&&(y.Cc=1),O=1}if(!O)return null;if(y.Cc&&((O=y.ga)!=null&&(O.mc=null),y.ga=null,0<y.Ga))return alert("todo:WebPDequantizeLevels"),null}return y.nb+R*ne}function Ei(y,T,R,O,ne,se){for(;0<ne--;){var ae,de=y,me=T+(R?1:0),Te=y,Ie=T+(R?0:3);for(ae=0;ae<O;++ae){var Ze=Te[Ie+4*ae];Ze!=255&&(Ze*=32897,de[me+4*ae+0]=de[me+4*ae+0]*Ze>>23,de[me+4*ae+1]=de[me+4*ae+1]*Ze>>23,de[me+4*ae+2]=de[me+4*ae+2]*Ze>>23)}T+=se}}function ks(y,T,R,O,ne){for(;0<O--;){var se;for(se=0;se<R;++se){var ae=y[T+2*se+0],de=15&(Te=y[T+2*se+1]),me=4369*de,Te=(240&Te|Te>>4)*me>>16;y[T+2*se+0]=(240&ae|ae>>4)*me>>16&240|(15&ae|ae<<4)*me>>16>>4&15,y[T+2*se+1]=240&Te|de}T+=ne}}function as(y,T,R,O,ne,se,ae,de){var me,Te,Ie=255;for(Te=0;Te<ne;++Te){for(me=0;me<O;++me){var Ze=y[T+me];se[ae+4*me]=Ze,Ie&=Ze}T+=R,ae+=de}return Ie!=255}function uo(y,T,R,O,ne){var se;for(se=0;se<ne;++se)R[O+se]=y[T+se]>>8}function Nr(){Pl=Ei,hs=ks,ki=as,qs=uo}function ol(y,T,R){G[y]=function(O,ne,se,ae,de,me,Te,Ie,Ze,ve,Be,$e,ut,We,et,gt,Tt){var bt,sn=Tt-1>>1,qt=de[me+0]|Te[Ie+0]<<16,rn=Ze[ve+0]|Be[$e+0]<<16;e(O!=null);var Bt=3*qt+rn+131074>>2;for(T(O[ne+0],255&Bt,Bt>>16,ut,We),se!=null&&(Bt=3*rn+qt+131074>>2,T(se[ae+0],255&Bt,Bt>>16,et,gt)),bt=1;bt<=sn;++bt){var ni=de[me+bt]|Te[Ie+bt]<<16,ts=Ze[ve+bt]|Be[$e+bt]<<16,Yn=qt+ni+rn+ts+524296,Ht=Yn+2*(ni+rn)>>3;Bt=Ht+qt>>1,qt=(Yn=Yn+2*(qt+ts)>>3)+ni>>1,T(O[ne+2*bt-1],255&Bt,Bt>>16,ut,We+(2*bt-1)*R),T(O[ne+2*bt-0],255&qt,qt>>16,ut,We+(2*bt-0)*R),se!=null&&(Bt=Yn+rn>>1,qt=Ht+ts>>1,T(se[ae+2*bt-1],255&Bt,Bt>>16,et,gt+(2*bt-1)*R),T(se[ae+2*bt+0],255&qt,qt>>16,et,gt+(2*bt+0)*R)),qt=ni,rn=ts}1&Tt||(Bt=3*qt+rn+131074>>2,T(O[ne+Tt-1],255&Bt,Bt>>16,ut,We+(Tt-1)*R),se!=null&&(Bt=3*rn+qt+131074>>2,T(se[ae+Tt-1],255&Bt,Bt>>16,et,gt+(Tt-1)*R)))}}function pr(){Ls[Ed]=or,Ls[ia]=mr,Ls[rd]=Ml,Ls[Ia]=lr,Ls[qc]=Vr,Ls[El]=js,Ls[Ql]=Wr,Ls[pl]=mr,Ls[Ac]=lr,Ls[Fo]=Vr,Ls[ec]=js}function ll(y){return y&-16384?0>y?0:255:y>>Gr}function Hs(y,T){return ll((19077*y>>8)+(26149*T>>8)-14234)}function ba(y,T,R){return ll((19077*y>>8)-(6419*T>>8)-(13320*R>>8)+8708)}function gr(y,T){return ll((19077*y>>8)+(33050*T>>8)-17685)}function Ja(y,T,R,O,ne){O[ne+0]=Hs(y,R),O[ne+1]=ba(y,T,R),O[ne+2]=gr(y,T)}function oi(y,T,R,O,ne){O[ne+0]=gr(y,T),O[ne+1]=ba(y,T,R),O[ne+2]=Hs(y,R)}function ho(y,T,R,O,ne){var se=ba(y,T,R);T=se<<3&224|gr(y,T)>>3,O[ne+0]=248&Hs(y,R)|se>>5,O[ne+1]=T}function wc(y,T,R,O,ne){var se=240&gr(y,T)|15;O[ne+0]=240&Hs(y,R)|ba(y,T,R)>>4,O[ne+1]=se}function nd(y,T,R,O,ne){O[ne+0]=255,Ja(y,T,R,O,ne+1)}function Qa(y,T,R,O,ne){oi(y,T,R,O,ne),O[ne+3]=255}function Hr(y,T,R,O,ne){Ja(y,T,R,O,ne),O[ne+3]=255}function Do(y,T,R){G[y]=function(O,ne,se,ae,de,me,Te,Ie,Ze){for(var ve=Ie+(-2&Ze)*R;Ie!=ve;)T(O[ne+0],se[ae+0],de[me+0],Te,Ie),T(O[ne+1],se[ae+0],de[me+0],Te,Ie+R),ne+=2,++ae,++me,Ie+=2*R;1&Ze&&T(O[ne+0],se[ae+0],de[me+0],Te,Ie)}}function Sc(y,T,R){return R==0?y==0?T==0?6:5:T==0?4:0:R}function Lo(y,T,R,O,ne){switch(y>>>30){case 3:Bo(T,R,O,ne,0);break;case 2:Aa(T,R,O,ne);break;case 1:$i(T,R,O,ne)}}function va(y,T){var R,O,ne=T.M,se=T.Nb,ae=y.oc,de=y.pc+40,me=y.oc,Te=y.pc+584,Ie=y.oc,Ze=y.pc+600;for(R=0;16>R;++R)ae[de+32*R-1]=129;for(R=0;8>R;++R)me[Te+32*R-1]=129,Ie[Ze+32*R-1]=129;for(0<ne?ae[de-1-32]=me[Te-1-32]=Ie[Ze-1-32]=129:(s(ae,de-32-1,127,21),s(me,Te-32-1,127,9),s(Ie,Ze-32-1,127,9)),O=0;O<y.za;++O){var ve=T.ya[T.aa+O];if(0<O){for(R=-1;16>R;++R)n(ae,de+32*R-4,ae,de+32*R+12,4);for(R=-1;8>R;++R)n(me,Te+32*R-4,me,Te+32*R+4,4),n(Ie,Ze+32*R-4,Ie,Ze+32*R+4,4)}var Be=y.Gd,$e=y.Hd+O,ut=ve.ad,We=ve.Hc;if(0<ne&&(n(ae,de-32,Be[$e].y,0,16),n(me,Te-32,Be[$e].f,0,8),n(Ie,Ze-32,Be[$e].ea,0,8)),ve.Za){var et=ae,gt=de-32+16;for(0<ne&&(O>=y.za-1?s(et,gt,Be[$e].y[15],4):n(et,gt,Be[$e+1].y,0,4)),R=0;4>R;R++)et[gt+128+R]=et[gt+256+R]=et[gt+384+R]=et[gt+0+R];for(R=0;16>R;++R,We<<=2)et=ae,gt=de+Di[R],Qs[ve.Ob[R]](et,gt),Lo(We,ut,16*+R,et,gt)}else if(et=Sc(O,ne,ve.Ob[0]),Fa[et](ae,de),We!=0)for(R=0;16>R;++R,We<<=2)Lo(We,ut,16*+R,ae,de+Di[R]);for(R=ve.Gc,et=Sc(O,ne,ve.Dd),bo[et](me,Te),bo[et](Ie,Ze),We=ut,et=me,gt=Te,255&(ve=0|R)&&(170&ve?go(We,256,et,gt):Ri(We,256,et,gt)),ve=Ie,We=Ze,255&(R>>=8)&&(170&R?go(ut,320,ve,We):Ri(ut,320,ve,We)),ne<y.Ub-1&&(n(Be[$e].y,0,ae,de+480,16),n(Be[$e].f,0,me,Te+224,8),n(Be[$e].ea,0,Ie,Ze+224,8)),R=8*se*y.B,Be=y.sa,$e=y.ta+16*O+16*se*y.R,ut=y.qa,ve=y.ra+8*O+R,We=y.Ha,et=y.Ia+8*O+R,R=0;16>R;++R)n(Be,$e+R*y.R,ae,de+32*R,16);for(R=0;8>R;++R)n(ut,ve+R*y.B,me,Te+32*R,8),n(We,et+R*y.B,Ie,Ze+32*R,8)}}function nr(y,T,R,O,ne,se,ae,de,me){var Te=[0],Ie=[0],Ze=0,ve=me!=null?me.kd:0,Be=me??new mt;if(y==null||12>R)return 7;Be.data=y,Be.w=T,Be.ha=R,T=[T],R=[R],Be.gb=[Be.gb];e:{var $e=T,ut=R,We=Be.gb;if(e(y!=null),e(ut!=null),e(We!=null),We[0]=0,12<=ut[0]&&!t(y,$e[0],"RIFF")){if(t(y,$e[0]+8,"WEBP")){We=3;break e}var et=Nt(y,$e[0]+4);if(12>et||4294967286<et){We=3;break e}if(ve&&et>ut[0]-8){We=7;break e}We[0]=et,$e[0]+=12,ut[0]-=12}We=0}if(We!=0)return We;for(et=0<Be.gb[0],R=R[0];;){e:{var gt=y;ut=T,We=R;var Tt=Te,bt=Ie,sn=$e=[0];if((Bt=Ze=[Ze])[0]=0,8>We[0])We=7;else{if(!t(gt,ut[0],"VP8X")){if(Nt(gt,ut[0]+4)!=10){We=3;break e}if(18>We[0]){We=7;break e}var qt=Nt(gt,ut[0]+8),rn=1+yt(gt,ut[0]+12);if(2147483648<=rn*(gt=1+yt(gt,ut[0]+15))){We=3;break e}sn!=null&&(sn[0]=qt),Tt!=null&&(Tt[0]=rn),bt!=null&&(bt[0]=gt),ut[0]+=18,We[0]-=18,Bt[0]=1}We=0}}if(Ze=Ze[0],$e=$e[0],We!=0)return We;if(ut=!!(2&$e),!et&&Ze)return 3;if(se!=null&&(se[0]=!!(16&$e)),ae!=null&&(ae[0]=ut),de!=null&&(de[0]=0),ae=Te[0],$e=Ie[0],Ze&&ut&&me==null){We=0;break}if(4>R){We=7;break}if(et&&Ze||!et&&!Ze&&!t(y,T[0],"ALPH")){R=[R],Be.na=[Be.na],Be.P=[Be.P],Be.Sa=[Be.Sa];e:{qt=y,We=T,et=R;var Bt=Be.gb;Tt=Be.na,bt=Be.P,sn=Be.Sa,rn=22,e(qt!=null),e(et!=null),gt=We[0];var ni=et[0];for(e(Tt!=null),e(sn!=null),Tt[0]=null,bt[0]=null,sn[0]=0;;){if(We[0]=gt,et[0]=ni,8>ni){We=7;break e}var ts=Nt(qt,gt+4);if(4294967286<ts){We=3;break e}var Yn=8+ts+1&-2;if(rn+=Yn,0<Bt&&rn>Bt){We=3;break e}if(!t(qt,gt,"VP8 ")||!t(qt,gt,"VP8L")){We=0;break e}if(ni[0]<Yn){We=7;break e}t(qt,gt,"ALPH")||(Tt[0]=qt,bt[0]=gt+8,sn[0]=ts),gt+=Yn,ni-=Yn}}if(R=R[0],Be.na=Be.na[0],Be.P=Be.P[0],Be.Sa=Be.Sa[0],We!=0)break}R=[R],Be.Ja=[Be.Ja],Be.xa=[Be.xa];e:if(Bt=y,We=T,et=R,Tt=Be.gb[0],bt=Be.Ja,sn=Be.xa,qt=We[0],gt=!t(Bt,qt,"VP8 "),rn=!t(Bt,qt,"VP8L"),e(Bt!=null),e(et!=null),e(bt!=null),e(sn!=null),8>et[0])We=7;else{if(gt||rn){if(Bt=Nt(Bt,qt+4),12<=Tt&&Bt>Tt-12){We=3;break e}if(ve&&Bt>et[0]-8){We=7;break e}bt[0]=Bt,We[0]+=8,et[0]-=8,sn[0]=rn}else sn[0]=5<=et[0]&&Bt[qt+0]==47&&!(Bt[qt+4]>>5),bt[0]=et[0];We=0}if(R=R[0],Be.Ja=Be.Ja[0],Be.xa=Be.xa[0],T=T[0],We!=0)break;if(4294967286<Be.Ja)return 3;if(de==null||ut||(de[0]=Be.xa?2:1),ae=[ae],$e=[$e],Be.xa){if(5>R){We=7;break}de=ae,ve=$e,ut=se,y==null||5>R?y=0:5<=R&&y[T+0]==47&&!(y[T+4]>>5)?(et=[0],Bt=[0],Tt=[0],_e(bt=new H,y,T,R),Na(bt,et,Bt,Tt)?(de!=null&&(de[0]=et[0]),ve!=null&&(ve[0]=Bt[0]),ut!=null&&(ut[0]=Tt[0]),y=1):y=0):y=0}else{if(10>R){We=7;break}de=$e,y==null||10>R||!il(y,T+3,R-3)?y=0:(ve=y[T+0]|y[T+1]<<8|y[T+2]<<16,ut=16383&(y[T+7]<<8|y[T+6]),y=16383&(y[T+9]<<8|y[T+8]),1&ve||3<(ve>>1&7)||!(ve>>4&1)||ve>>5>=Be.Ja||!ut||!y?y=0:(ae&&(ae[0]=ut),de&&(de[0]=y),y=1))}if(!y||(ae=ae[0],$e=$e[0],Ze&&(Te[0]!=ae||Ie[0]!=$e)))return 3;me!=null&&(me[0]=Be,me.offset=T-me.w,e(4294967286>T-me.w),e(me.offset==me.ha-R));break}return We==0||We==7&&Ze&&me==null?(se!=null&&(se[0]|=Be.na!=null&&0<Be.na.length),O!=null&&(O[0]=ae),ne!=null&&(ne[0]=$e),0):We}function eo(y,T,R){var O=T.width,ne=T.height,se=0,ae=0,de=O,me=ne;if(T.Da=y!=null&&0<y.Da,T.Da&&(de=y.cd,me=y.bd,se=y.v,ae=y.j,11>R||(se&=-2,ae&=-2),0>se||0>ae||0>=de||0>=me||se+de>O||ae+me>ne))return 0;if(T.v=se,T.j=ae,T.va=se+de,T.o=ae+me,T.U=de,T.T=me,T.da=y!=null&&0<y.da,T.da){if(!Lt(de,me,R=[y.ib],se=[y.hb]))return 0;T.ib=R[0],T.hb=se[0]}return T.ob=y!=null&&y.ob,T.Kb=y==null||!y.Sd,T.da&&(T.ob=T.ib<3*O/4&&T.hb<3*ne/4,T.Kb=0),1}function cl(y){if(y==null)return 2;if(11>y.S){var T=y.f.RGBA;T.fb+=(y.height-1)*T.A,T.A=-T.A}else T=y.f.kb,y=y.height,T.O+=(y-1)*T.fa,T.fa=-T.fa,T.N+=(y-1>>1)*T.Ab,T.Ab=-T.Ab,T.W+=(y-1>>1)*T.Db,T.Db=-T.Db,T.F!=null&&(T.J+=(y-1)*T.lb,T.lb=-T.lb);return 0}function fo(y,T,R,O){if(O==null||0>=y||0>=T)return 2;if(R!=null){if(R.Da){var ne=R.cd,se=R.bd,ae=-2&R.v,de=-2&R.j;if(0>ae||0>de||0>=ne||0>=se||ae+ne>y||de+se>T)return 2;y=ne,T=se}if(R.da){if(!Lt(y,T,ne=[R.ib],se=[R.hb]))return 2;y=ne[0],T=se[0]}}O.width=y,O.height=T;e:{var me=O.width,Te=O.height;if(y=O.S,0>=me||0>=Te||!(y>=Ed&&13>y))y=2;else{if(0>=O.Rd&&O.sd==null){ae=se=ne=T=0;var Ie=(de=me*Rn[y])*Te;if(11>y||(se=(Te+1)/2*(T=(me+1)/2),y==12&&(ae=(ne=me)*Te)),(Te=o(Ie+2*se+ae))==null){y=1;break e}O.sd=Te,11>y?((me=O.f.RGBA).eb=Te,me.fb=0,me.A=de,me.size=Ie):((me=O.f.kb).y=Te,me.O=0,me.fa=de,me.Fd=Ie,me.f=Te,me.N=0+Ie,me.Ab=T,me.Cd=se,me.ea=Te,me.W=0+Ie+se,me.Db=T,me.Ed=se,y==12&&(me.F=Te,me.J=0+Ie+2*se),me.Tc=ae,me.lb=ne)}if(T=1,ne=O.S,se=O.width,ae=O.height,ne>=Ed&&13>ne)if(11>ne)y=O.f.RGBA,T&=(de=Math.abs(y.A))*(ae-1)+se<=y.size,T&=de>=se*Rn[ne],T&=y.eb!=null;else{y=O.f.kb,de=(se+1)/2,Ie=(ae+1)/2,me=Math.abs(y.fa),Te=Math.abs(y.Ab);var Ze=Math.abs(y.Db),ve=Math.abs(y.lb),Be=ve*(ae-1)+se;T&=me*(ae-1)+se<=y.Fd,T&=Te*(Ie-1)+de<=y.Cd,T=(T&=Ze*(Ie-1)+de<=y.Ed)&me>=se&Te>=de&Ze>=de,T&=y.y!=null,T&=y.f!=null,T&=y.ea!=null,ne==12&&(T&=ve>=se,T&=Be<=y.Tc,T&=y.F!=null)}else T=0;y=T?0:2}}return y!=0||R!=null&&R.fd&&(y=cl(O)),y}var po=64,wa=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ir=24,Mo=32,Da=8,_i=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ot("Predictor0","PredictorAdd0"),G.Predictor0=function(){return 4278190080},G.Predictor1=function(y){return y},G.Predictor2=function(y,T,R){return T[R+0]},G.Predictor3=function(y,T,R){return T[R+1]},G.Predictor4=function(y,T,R){return T[R-1]},G.Predictor5=function(y,T,R){return nn(nn(y,T[R+1]),T[R+0])},G.Predictor6=function(y,T,R){return nn(y,T[R-1])},G.Predictor7=function(y,T,R){return nn(y,T[R+0])},G.Predictor8=function(y,T,R){return nn(T[R-1],T[R+0])},G.Predictor9=function(y,T,R){return nn(T[R+0],T[R+1])},G.Predictor10=function(y,T,R){return nn(nn(y,T[R-1]),nn(T[R+0],T[R+1]))},G.Predictor11=function(y,T,R){var O=T[R+0];return 0>=Mt(O>>24&255,y>>24&255,(T=T[R-1])>>24&255)+Mt(O>>16&255,y>>16&255,T>>16&255)+Mt(O>>8&255,y>>8&255,T>>8&255)+Mt(255&O,255&y,255&T)?O:y},G.Predictor12=function(y,T,R){var O=T[R+0];return(Zn((y>>24&255)+(O>>24&255)-((T=T[R-1])>>24&255))<<24|Zn((y>>16&255)+(O>>16&255)-(T>>16&255))<<16|Zn((y>>8&255)+(O>>8&255)-(T>>8&255))<<8|Zn((255&y)+(255&O)-(255&T)))>>>0},G.Predictor13=function(y,T,R){var O=T[R-1];return(Pt((y=nn(y,T[R+0]))>>24&255,O>>24&255)<<24|Pt(y>>16&255,O>>16&255)<<16|Pt(y>>8&255,O>>8&255)<<8|Pt(255&y,255&O))>>>0};var zo=G.PredictorAdd0;G.PredictorAdd1=yi,Ot("Predictor2","PredictorAdd2"),Ot("Predictor3","PredictorAdd3"),Ot("Predictor4","PredictorAdd4"),Ot("Predictor5","PredictorAdd5"),Ot("Predictor6","PredictorAdd6"),Ot("Predictor7","PredictorAdd7"),Ot("Predictor8","PredictorAdd8"),Ot("Predictor9","PredictorAdd9"),Ot("Predictor10","PredictorAdd10"),Ot("Predictor11","PredictorAdd11"),Ot("Predictor12","PredictorAdd12"),Ot("Predictor13","PredictorAdd13");var os=G.PredictorAdd2;Jt("ColorIndexInverseTransform","MapARGB","32b",function(y){return y>>8&255},function(y){return y}),Jt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(y){return y},function(y){return y>>8&255});var ws,id=G.ColorIndexInverseTransform,La=G.MapARGB,Cl=G.VP8LColorIndexInverseTransformAlpha,Pr=G.MapAlpha,Zl=G.VP8LPredictorsAdd=[];Zl.length=16,(G.VP8LPredictors=[]).length=16,(G.VP8LPredictorsAdd_C=[]).length=16,(G.VP8LPredictors_C=[]).length=16;var sd,to,dl,Io,Sa,qr,Ma,Bo,Aa,go,$i,Ri,Ss,sr,_l,ul,rr,Ta,kl,hl,jl,Jl,Nl,no,Pl,hs,ki,qs,Vs=o(511),za=o(2041),Nd=o(225),fl=o(767),Pd=0,Oo=za,Fi=Nd,ls=fl,Er=Vs,Ed=0,ia=1,rd=2,Ia=3,qc=4,El=5,Ql=6,pl=7,Ac=8,Fo=9,ec=10,Ba=[2,3,7],tc=[3,3,11],mo=[280,256,256,256,40],Rl=[0,1,1,1,0],ad=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],ar=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],yo=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Js=8,Oa=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],xo=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Rr=null,Tc=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],od=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],nc=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Dl=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],sa=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],As=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],ji=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Fa=[],Qs=[],bo=[],ic=1,Qd=2,Ll=[],Ls=[];ol("UpsampleRgbLinePair",Ja,3),ol("UpsampleBgrLinePair",oi,3),ol("UpsampleRgbaLinePair",Hr,4),ol("UpsampleBgraLinePair",Qa,4),ol("UpsampleArgbLinePair",nd,4),ol("UpsampleRgba4444LinePair",wc,2),ol("UpsampleRgb565LinePair",ho,2);var or=G.UpsampleRgbLinePair,Ml=G.UpsampleBgrLinePair,mr=G.UpsampleRgbaLinePair,lr=G.UpsampleBgraLinePair,Vr=G.UpsampleArgbLinePair,js=G.UpsampleRgba4444LinePair,Wr=G.UpsampleRgb565LinePair,ys=16,Ca=1<<ys-1,cr=-227,$r=482,Gr=6,Yr=0,fs=o(256),Uo=o(256),vo=o(256),sc=o(256),io=o($r-cr),Ho=o($r-cr);Do("YuvToRgbRow",Ja,3),Do("YuvToBgrRow",oi,3),Do("YuvToRgbaRow",Hr,4),Do("YuvToBgraRow",Qa,4),Do("YuvToArgbRow",nd,4),Do("YuvToRgba4444Row",wc,2),Do("YuvToRgb565Row",ho,2);var Di=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],ra=[0,2,8],_a=[8,7,6,4,4,2,2,2,1,1,1,1],Xr=1;this.WebPDecodeRGBA=function(y,T,R,O,ne){var se=ia,ae=new rt,de=new qn;ae.ba=de,de.S=se,de.width=[de.width],de.height=[de.height];var me=de.width,Te=de.height,Ie=new yn;if(Ie==null||y==null)var Ze=2;else e(Ie!=null),Ze=nr(y,T,R,Ie.width,Ie.height,Ie.Pd,Ie.Qd,Ie.format,null);if(Ze!=0?me=0:(me!=null&&(me[0]=Ie.width[0]),Te!=null&&(Te[0]=Ie.height[0]),me=1),me){de.width=de.width[0],de.height=de.height[0],O!=null&&(O[0]=de.width),ne!=null&&(ne[0]=de.height);e:{if(O=new nl,(ne=new mt).data=y,ne.w=T,ne.ha=R,ne.kd=1,T=[0],e(ne!=null),((y=nr(ne.data,ne.w,ne.ha,null,null,null,T,null,ne))==0||y==7)&&T[0]&&(y=4),(T=y)==0){if(e(ae!=null),O.data=ne.data,O.w=ne.w+ne.offset,O.ha=ne.ha-ne.offset,O.put=Zt,O.ac=Br,O.bc=Or,O.ma=ae,ne.xa){if((y=Yl())==null){ae=1;break e}if((function(ve,Be){var $e=[0],ut=[0],We=[0];t:for(;;){if(ve==null)return 0;if(Be==null)return ve.a=2,0;if(ve.l=Be,ve.a=0,_e(ve.m,Be.data,Be.w,Be.ha),!Na(ve.m,$e,ut,We)){ve.a=3;break t}if(ve.xb=Qd,Be.width=$e[0],Be.height=ut[0],!Va($e[0],ut[0],1,ve,null))break t;return 1}return e(ve.a!=0),0})(y,O)){if(O=(T=fo(O.width,O.height,ae.Oa,ae.ba))==0){t:{O=y;n:for(;;){if(O==null){O=0;break t}if(e(O.s.yc!=null),e(O.s.Ya!=null),e(0<O.s.Wb),e((R=O.l)!=null),e((ne=R.ma)!=null),O.xb!=0){if(O.ca=ne.ba,O.tb=ne.tb,e(O.ca!=null),!eo(ne.Oa,R,Ia)){O.a=2;break n}if(!Wa(O,R.width)||R.da)break n;if((R.da||Gt(O.ca.S))&&Nr(),11>O.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),O.ca.f.kb.F!=null&&Nr()),O.Pb&&0<O.s.ua&&O.s.vb.X==null&&!pe(O.s.vb,O.s.Wa.Xa)){O.a=1;break n}O.xb=0}if(!pa(O,O.V,O.Ba,O.c,O.i,R.o,Ds))break n;ne.Dc=O.Ma,O=1;break t}e(O.a!=0),O=0}O=!O}O&&(T=y.a)}else T=y.a}else{if((y=new Un)==null){ae=1;break e}if(y.Fa=ne.na,y.P=ne.P,y.qc=ne.Sa,Ga(y,O)){if((T=fo(O.width,O.height,ae.Oa,ae.ba))==0){if(y.Aa=0,R=ae.Oa,e((ne=y)!=null),R!=null){if(0<(me=0>(me=R.Md)?0:100<me?255:255*me/100)){for(Te=Ie=0;4>Te;++Te)12>(Ze=ne.pb[Te]).lc&&(Ze.ia=me*_a[0>Ze.lc?0:Ze.lc]>>3),Ie|=Ze.ia;Ie&&(alert("todo:VP8InitRandom"),ne.ia=1)}ne.Ga=R.Id,100<ne.Ga?ne.Ga=100:0>ne.Ga&&(ne.Ga=0)}(function(ve,Be){if(ve==null)return 0;if(Be==null)return Fn(ve,2,"NULL VP8Io parameter in VP8Decode().");if(!ve.cb&&!Ga(ve,Be))return 0;if(e(ve.cb),Be.ac==null||Be.ac(Be)){Be.ob&&(ve.L=0);var $e=ra[ve.L];if(ve.L==2?(ve.yb=0,ve.zb=0):(ve.yb=Be.v-$e>>4,ve.zb=Be.j-$e>>4,0>ve.yb&&(ve.yb=0),0>ve.zb&&(ve.zb=0)),ve.Va=Be.o+15+$e>>4,ve.Hb=Be.va+15+$e>>4,ve.Hb>ve.za&&(ve.Hb=ve.za),ve.Va>ve.Ub&&(ve.Va=ve.Ub),0<ve.L){var ut=ve.ed;for($e=0;4>$e;++$e){var We;if(ve.Qa.Cb){var et=ve.Qa.Lb[$e];ve.Qa.Fb||(et+=ut.Tb)}else et=ut.Tb;for(We=0;1>=We;++We){var gt=ve.gd[$e][We],Tt=et;if(ut.Pc&&(Tt+=ut.vd[0],We&&(Tt+=ut.od[0])),0<(Tt=0>Tt?0:63<Tt?63:Tt)){var bt=Tt;0<ut.wb&&(bt=4<ut.wb?bt>>2:bt>>1)>9-ut.wb&&(bt=9-ut.wb),1>bt&&(bt=1),gt.dd=bt,gt.tc=2*Tt+bt,gt.ld=40<=Tt?2:15<=Tt?1:0}else gt.tc=0;gt.La=We}}}$e=0}else Fn(ve,6,"Frame setup failed"),$e=ve.a;if($e=$e==0){if($e){ve.$c=0,0<ve.Aa||(ve.Ic=Xr);t:{$e=ve.Ic,ut=4*(bt=ve.za);var sn=32*bt,qt=bt+1,rn=0<ve.L?bt*(0<ve.Aa?2:1):0,Bt=(ve.Aa==2?2:1)*bt;if((gt=ut+832+(We=3*(16*$e+ra[ve.L])/2*sn)+(et=ve.Fa!=null&&0<ve.Fa.length?ve.Kc.c*ve.Kc.i:0))!=gt)$e=0;else{if(gt>ve.Vb){if(ve.Vb=0,ve.Ec=o(gt),ve.Fc=0,ve.Ec==null){$e=Fn(ve,1,"no memory during frame initialization.");break t}ve.Vb=gt}gt=ve.Ec,Tt=ve.Fc,ve.Ac=gt,ve.Bc=Tt,Tt+=ut,ve.Gd=d(sn,$a),ve.Hd=0,ve.rb=d(qt+1,ma),ve.sb=1,ve.wa=rn?d(rn,pi):null,ve.Y=0,ve.D.Nb=0,ve.D.wa=ve.wa,ve.D.Y=ve.Y,0<ve.Aa&&(ve.D.Y+=bt),e(!0),ve.oc=gt,ve.pc=Tt,Tt+=832,ve.ya=d(Bt,el),ve.aa=0,ve.D.ya=ve.ya,ve.D.aa=ve.aa,ve.Aa==2&&(ve.D.aa+=bt),ve.R=16*bt,ve.B=8*bt,bt=(sn=ra[ve.L])*ve.R,sn=sn/2*ve.B,ve.sa=gt,ve.ta=Tt+bt,ve.qa=ve.sa,ve.ra=ve.ta+16*$e*ve.R+sn,ve.Ha=ve.qa,ve.Ia=ve.ra+8*$e*ve.B+sn,ve.$c=0,Tt+=We,ve.mb=et?gt:null,ve.nb=et?Tt:null,e(Tt+et<=ve.Fc+ve.Vb),_r(ve),s(ve.Ac,ve.Bc,0,ut),$e=1}}if($e){if(Be.ka=0,Be.y=ve.sa,Be.O=ve.ta,Be.f=ve.qa,Be.N=ve.ra,Be.ea=ve.Ha,Be.Vd=ve.Ia,Be.fa=ve.R,Be.Rc=ve.B,Be.F=null,Be.J=0,!Pd){for($e=-255;255>=$e;++$e)Vs[255+$e]=0>$e?-$e:$e;for($e=-1020;1020>=$e;++$e)za[1020+$e]=-128>$e?-128:127<$e?127:$e;for($e=-112;112>=$e;++$e)Nd[112+$e]=-16>$e?-16:15<$e?15:$e;for($e=-255;510>=$e;++$e)fl[255+$e]=0>$e?0:255<$e?255:$e;Pd=1}Ma=jr,Bo=ya,go=kr,$i=sl,Ri=Ya,Aa=bc,Ss=Jd,sr=gn,_l=ee,ul=we,rr=Ro,Ta=P,kl=De,hl=Fe,jl=Za,Jl=al,Nl=vc,no=Kl,Qs[0]=Hc,Qs[1]=Et,Qs[2]=ti,Qs[3]=Tn,Qs[4]=xa,Qs[5]=Cn,Qs[6]=ln,Qs[7]=ri,Qs[8]=ai,Qs[9]=tn,Fa[0]=co,Fa[1]=fr,Fa[2]=Al,Fa[3]=Xa,Fa[4]=rs,Fa[5]=es,Fa[6]=Po,bo[0]=Pi,bo[1]=Qi,bo[2]=pn,bo[3]=Zd,bo[4]=Gn,bo[5]=Yt,bo[6]=Ur,$e=1}else $e=0}$e&&($e=(function(ni,ts){for(ni.M=0;ni.M<ni.Va;++ni.M){var Yn,Ht=ni.Jc[ni.M&ni.Xb],Rt=ni.m,Ws=ni;for(Yn=0;Yn<Ws.za;++Yn){var Pn=Rt,Hn=Ws,si=Hn.Ac,Ui=Hn.Bc+4*Yn,Ts=Hn.zc,Li=Hn.ya[Hn.aa+Yn];if(Hn.Qa.Bb?Li.$b=Ke(Pn,Hn.Pa.jb[0])?2+Ke(Pn,Hn.Pa.jb[2]):Ke(Pn,Hn.Pa.jb[1]):Li.$b=0,Hn.kc&&(Li.Ad=Ke(Pn,Hn.Bd)),Li.Za=!Ke(Pn,145)+0,Li.Za){var Ms=Li.Ob,Kr=0;for(Hn=0;4>Hn;++Hn){var Gi,ii=Ts[0+Hn];for(Gi=0;4>Gi;++Gi){ii=sa[si[Ui+Gi]][ii];for(var Mi=nc[Ke(Pn,ii[0])];0<Mi;)Mi=nc[2*Mi+Ke(Pn,ii[Mi])];ii=-Mi,si[Ui+Gi]=ii}n(Ms,Kr,si,Ui,4),Kr+=4,Ts[0+Hn]=ii}}else ii=Ke(Pn,156)?Ke(Pn,128)?1:3:Ke(Pn,163)?2:0,Li.Ob[0]=ii,s(si,Ui,ii,4),s(Ts,0,ii,4);Li.Dd=Ke(Pn,142)?Ke(Pn,114)?Ke(Pn,183)?1:3:2:0}if(Ws.m.Ka)return Fn(ni,7,"Premature end-of-partition0 encountered.");for(;ni.ja<ni.za;++ni.ja){if(Ws=Ht,Pn=(Rt=ni).rb[Rt.sb-1],si=Rt.rb[Rt.sb+Rt.ja],Yn=Rt.ya[Rt.aa+Rt.ja],Ui=Rt.kc?Yn.Ad:0)Pn.la=si.la=0,Yn.Za||(Pn.Na=si.Na=0),Yn.Hc=0,Yn.Gc=0,Yn.ia=0;else{var zs,zi;if(Pn=si,si=Ws,Ui=Rt.Pa.Xc,Ts=Rt.ya[Rt.aa+Rt.ja],Li=Rt.pb[Ts.$b],Hn=Ts.ad,Ms=0,Kr=Rt.rb[Rt.sb-1],ii=Gi=0,s(Hn,Ms,0,384),Ts.Za)var yr=0,Ns=Ui[3];else{Mi=o(16);var gi=Pn.Na+Kr.Na;if(gi=Rr(si,Ui[1],gi,Li.Eb,0,Mi,0),Pn.Na=Kr.Na=(0<gi)+0,1<gi)Ma(Mi,0,Hn,Ms);else{var Cs=Mi[0]+3>>3;for(Mi=0;256>Mi;Mi+=16)Hn[Ms+Mi]=Cs}yr=1,Ns=Ui[0]}var Hi=15&Pn.la,er=15&Kr.la;for(Mi=0;4>Mi;++Mi){var dr=1&er;for(Cs=zi=0;4>Cs;++Cs)Hi=Hi>>1|(dr=(gi=Rr(si,Ns,gi=dr+(1&Hi),Li.Sc,yr,Hn,Ms))>yr)<<7,zi=zi<<2|(3<gi?3:1<gi?2:Hn[Ms+0]!=0),Ms+=16;Hi>>=4,er=er>>1|dr<<7,Gi=(Gi<<8|zi)>>>0}for(Ns=Hi,yr=er>>4,zs=0;4>zs;zs+=2){for(zi=0,Hi=Pn.la>>4+zs,er=Kr.la>>4+zs,Mi=0;2>Mi;++Mi){for(dr=1&er,Cs=0;2>Cs;++Cs)gi=dr+(1&Hi),Hi=Hi>>1|(dr=0<(gi=Rr(si,Ui[2],gi,Li.Qc,0,Hn,Ms)))<<3,zi=zi<<2|(3<gi?3:1<gi?2:Hn[Ms+0]!=0),Ms+=16;Hi>>=2,er=er>>1|dr<<5}ii|=zi<<4*zs,Ns|=Hi<<4<<zs,yr|=(240&er)<<zs}Pn.la=Ns,Kr.la=yr,Ts.Hc=Gi,Ts.Gc=ii,Ts.ia=43690&ii?0:Li.ia,Ui=!(Gi|ii)}if(0<Rt.L&&(Rt.wa[Rt.Y+Rt.ja]=Rt.gd[Yn.$b][Yn.Za],Rt.wa[Rt.Y+Rt.ja].La|=!Ui),Ws.Ka)return Fn(ni,7,"Premature end-of-file encountered.")}if(_r(ni),Rt=ts,Ws=1,Yn=(Ht=ni).D,Pn=0<Ht.L&&Ht.M>=Ht.zb&&Ht.M<=Ht.Va,Ht.Aa==0)t:{if(Yn.M=Ht.M,Yn.uc=Pn,va(Ht,Yn),Ws=1,Yn=(zi=Ht.D).Nb,Pn=(ii=ra[Ht.L])*Ht.R,si=ii/2*Ht.B,Mi=16*Yn*Ht.R,Cs=8*Yn*Ht.B,Ui=Ht.sa,Ts=Ht.ta-Pn+Mi,Li=Ht.qa,Hn=Ht.ra-si+Cs,Ms=Ht.Ha,Kr=Ht.Ia-si+Cs,er=(Hi=zi.M)==0,Gi=Hi>=Ht.Va-1,Ht.Aa==2&&va(Ht,zi),zi.uc)for(dr=(gi=Ht).D.M,e(gi.D.uc),zi=gi.yb;zi<gi.Hb;++zi){yr=zi,Ns=dr;var ns=(Ii=($s=gi).D).Nb;zs=$s.R;var Ii=Ii.wa[Ii.Y+yr],xr=$s.sa,_s=$s.ta+16*ns*zs+16*yr,bn=Ii.dd,vn=Ii.tc;if(vn!=0)if(e(3<=vn),$s.L==1)0<yr&&Jl(xr,_s,zs,vn+4),Ii.La&&no(xr,_s,zs,vn),0<Ns&&jl(xr,_s,zs,vn+4),Ii.La&&Nl(xr,_s,zs,vn);else{var Ai=$s.B,Zr=$s.qa,so=$s.ra+8*ns*Ai+8*yr,aa=$s.Ha,$s=$s.Ia+8*ns*Ai+8*yr;ns=Ii.ld,0<yr&&(sr(xr,_s,zs,vn+4,bn,ns),ul(Zr,so,aa,$s,Ai,vn+4,bn,ns)),Ii.La&&(Ta(xr,_s,zs,vn,bn,ns),hl(Zr,so,aa,$s,Ai,vn,bn,ns)),0<Ns&&(Ss(xr,_s,zs,vn+4,bn,ns),_l(Zr,so,aa,$s,Ai,vn+4,bn,ns)),Ii.La&&(rr(xr,_s,zs,vn,bn,ns),kl(Zr,so,aa,$s,Ai,vn,bn,ns))}}if(Ht.ia&&alert("todo:DitherRow"),Rt.put!=null){if(zi=16*Hi,Hi=16*(Hi+1),er?(Rt.y=Ht.sa,Rt.O=Ht.ta+Mi,Rt.f=Ht.qa,Rt.N=Ht.ra+Cs,Rt.ea=Ht.Ha,Rt.W=Ht.Ia+Cs):(zi-=ii,Rt.y=Ui,Rt.O=Ts,Rt.f=Li,Rt.N=Hn,Rt.ea=Ms,Rt.W=Kr),Gi||(Hi-=ii),Hi>Rt.o&&(Hi=Rt.o),Rt.F=null,Rt.J=null,Ht.Fa!=null&&0<Ht.Fa.length&&zi<Hi&&(Rt.J=Wi(Ht,Rt,zi,Hi-zi),Rt.F=Ht.mb,Rt.F==null&&Rt.F.length==0)){Ws=Fn(Ht,3,"Could not decode alpha data.");break t}zi<Rt.j&&(ii=Rt.j-zi,zi=Rt.j,e(!(1&ii)),Rt.O+=Ht.R*ii,Rt.N+=Ht.B*(ii>>1),Rt.W+=Ht.B*(ii>>1),Rt.F!=null&&(Rt.J+=Rt.width*ii)),zi<Hi&&(Rt.O+=Rt.v,Rt.N+=Rt.v>>1,Rt.W+=Rt.v>>1,Rt.F!=null&&(Rt.J+=Rt.v),Rt.ka=zi-Rt.j,Rt.U=Rt.va-Rt.v,Rt.T=Hi-zi,Ws=Rt.put(Rt))}Yn+1!=Ht.Ic||Gi||(n(Ht.sa,Ht.ta-Pn,Ui,Ts+16*Ht.R,Pn),n(Ht.qa,Ht.ra-si,Li,Hn+8*Ht.B,si),n(Ht.Ha,Ht.Ia-si,Ms,Kr+8*Ht.B,si))}if(!Ws)return Fn(ni,6,"Output aborted.")}return 1})(ve,Be)),Be.bc!=null&&Be.bc(Be),$e&=1}return $e?(ve.cb=0,$e):0})(y,O)||(T=y.a)}}else T=y.a}T==0&&ae.Oa!=null&&ae.Oa.fd&&(T=cl(ae.ba))}ae=T}se=ae!=0?null:11>se?de.f.RGBA.eb:de.f.kb.y}else se=null;return se};var Rn=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function f(G,U){for(var _="",N=0;N<4;N++)_+=String.fromCharCode(G[U++]);return _}function m(G,U){return G[U+0]|G[U+1]<<8}function b(G,U){return(G[U+0]|G[U+1]<<8|G[U+2]<<16)>>>0}function A(G,U){return(G[U+0]|G[U+1]<<8|G[U+2]<<16|G[U+3]<<24)>>>0}new h;var v=[0],E=[0],x=[],k=new h,j=r,$=(function(G,U){var _={},N=0,te=!1,ie=0,re=0;if(_.frames=[],!(function(D,H){for(var Y=0;Y<4;Y++)if(D[H+Y]!="RIFF".charCodeAt(Y))return!0;return!1})(G,U)){for(A(G,U+=4),U+=8;U<G.length;){var q=f(G,U),J=A(G,U+=4);U+=4;var ce=J+(1&J);switch(q){case"VP8 ":case"VP8L":_.frames[N]===void 0&&(_.frames[N]={}),(Z=_.frames[N]).src_off=te?re:U-8,Z.src_size=ie+J+8,N++,te&&(te=!1,ie=0,re=0);break;case"VP8X":(Z=_.header={}).feature_flags=G[U];var _e=U+4;Z.canvas_width=1+b(G,_e),_e+=3,Z.canvas_height=1+b(G,_e),_e+=3;break;case"ALPH":te=!0,ie=ce+8,re=U-8;break;case"ANIM":(Z=_.header).bgcolor=A(G,U),_e=U+4,Z.loop_count=m(G,_e),_e+=2;break;case"ANMF":var xe,Z;(Z=_.frames[N]={}).offset_x=2*b(G,U),U+=3,Z.offset_y=2*b(G,U),U+=3,Z.width=1+b(G,U),U+=3,Z.height=1+b(G,U),U+=3,Z.duration=b(G,U),U+=3,xe=G[U++],Z.dispose=1&xe,Z.blend=xe>>1&1}q!="ANMF"&&(U+=ce)}return _}})(j,0);$.response=j,$.rgbaoutput=!0,$.dataurl=!1;var z=$.header?$.header:null,B=$.frames?$.frames:null;if(z){z.loop_counter=z.loop_count,v=[z.canvas_height],E=[z.canvas_width];for(var F=0;F<B.length&&B[F].blend!=0;F++);}var I=B[0],X=k.WebPDecodeRGBA(j,I.src_off,I.src_size,E,v);I.rgba=X,I.imgwidth=E[0],I.imgheight=v[0];for(var M=0;M<E[0]*v[0]*4;M++)x[M]=X[M];return this.width=E,this.height=v,this.data=x,this}(function(r){var e,t,n,s,o,d,c,h,f,m=function(D){return D=D||{},this.isStrokeTransparent=D.isStrokeTransparent||!1,this.strokeOpacity=D.strokeOpacity||1,this.strokeStyle=D.strokeStyle||"#000000",this.fillStyle=D.fillStyle||"#000000",this.isFillTransparent=D.isFillTransparent||!1,this.fillOpacity=D.fillOpacity||1,this.font=D.font||"10px sans-serif",this.textBaseline=D.textBaseline||"alphabetic",this.textAlign=D.textAlign||"left",this.lineWidth=D.lineWidth||1,this.lineJoin=D.lineJoin||"miter",this.lineCap=D.lineCap||"butt",this.path=D.path||[],this.transform=D.transform!==void 0?D.transform.clone():new h,this.globalCompositeOperation=D.globalCompositeOperation||"normal",this.globalAlpha=D.globalAlpha||1,this.clip_path=D.clip_path||[],this.currentPoint=D.currentPoint||new d,this.miterLimit=D.miterLimit||10,this.lastPoint=D.lastPoint||new d,this.lineDashOffset=D.lineDashOffset||0,this.lineDash=D.lineDash||[],this.margin=D.margin||[0,0,0,0],this.prevPageLastElemOffset=D.prevPageLastElemOffset||0,this.ignoreClearRect=typeof D.ignoreClearRect!="boolean"||D.ignoreClearRect,this};r.events.push(["initialized",function(){this.context2d=new b(this),e=this.internal.f2,t=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,d=this.internal.Point,c=this.internal.Rectangle,h=this.internal.Matrix,f=new m}]);var b=function(D){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var H=D;Object.defineProperty(this,"pdf",{get:function(){return H}});var Y=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return Y},set:function(pe){Y=!!pe}});var ue=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return ue},set:function(pe){ue=!!pe}});var Ne=0;Object.defineProperty(this,"posX",{get:function(){return Ne},set:function(pe){isNaN(pe)||(Ne=pe)}});var Pe=0;Object.defineProperty(this,"posY",{get:function(){return Pe},set:function(pe){isNaN(pe)||(Pe=pe)}}),Object.defineProperty(this,"margin",{get:function(){return f.margin},set:function(pe){var St;typeof pe=="number"?St=[pe,pe,pe,pe]:((St=new Array(4))[0]=pe[0],St[1]=pe.length>=2?pe[1]:St[0],St[2]=pe.length>=3?pe[2]:St[0],St[3]=pe.length>=4?pe[3]:St[1]),f.margin=St}});var Ue=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Ue},set:function(pe){Ue=pe}});var Re=0;Object.defineProperty(this,"lastBreak",{get:function(){return Re},set:function(pe){Re=pe}});var Ke=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Ke},set:function(pe){Ke=pe}}),Object.defineProperty(this,"ctx",{get:function(){return f},set:function(pe){pe instanceof m&&(f=pe)}}),Object.defineProperty(this,"path",{get:function(){return f.path},set:function(pe){f.path=pe}});var Je=[];Object.defineProperty(this,"ctxStack",{get:function(){return Je},set:function(pe){Je=pe}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(pe){var St;St=A(pe),this.ctx.fillStyle=St.style,this.ctx.isFillTransparent=St.a===0,this.ctx.fillOpacity=St.a,this.pdf.setFillColor(St.r,St.g,St.b,{a:St.a}),this.pdf.setTextColor(St.r,St.g,St.b,{a:St.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(pe){var St=A(pe);this.ctx.strokeStyle=St.style,this.ctx.isStrokeTransparent=St.a===0,this.ctx.strokeOpacity=St.a,St.a===0?this.pdf.setDrawColor(255,255,255):(St.a,this.pdf.setDrawColor(St.r,St.g,St.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(pe){["butt","round","square"].indexOf(pe)!==-1&&(this.ctx.lineCap=pe,this.pdf.setLineCap(pe))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(pe){isNaN(pe)||(this.ctx.lineWidth=pe,this.pdf.setLineWidth(pe))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(pe){["bevel","round","miter"].indexOf(pe)!==-1&&(this.ctx.lineJoin=pe,this.pdf.setLineJoin(pe))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(pe){isNaN(pe)||(this.ctx.miterLimit=pe,this.pdf.setMiterLimit(pe))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(pe){this.ctx.textBaseline=pe}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(pe){["right","end","center","left","start"].indexOf(pe)!==-1&&(this.ctx.textAlign=pe)}});var st=null,yt=null,Nt=null;Object.defineProperty(this,"fontFaces",{get:function(){return Nt},set:function(pe){st=null,yt=null,Nt=pe}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(pe){var St;if(this.ctx.font=pe,(St=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(pe))!==null){var Ut=St[1];St[2];var Lt=St[3],at=St[4];St[5];var en=St[6],Ot=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(at)[2];at=Math.floor(Ot==="px"?parseFloat(at)*this.pdf.internal.scaleFactor:Ot==="em"?parseFloat(at)*this.pdf.getFontSize():parseFloat(at)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(at);var wn=(function(Jt){var zn,Nn,on=[],Sn=Jt.trim();if(Sn==="")return Cm;if(Sn in ab)return[ab[Sn]];for(;Sn!=="";){switch(Nn=null,zn=(Sn=lb(Sn)).charAt(0)){case'"':case"'":Nn=UA(Sn.substring(1),zn);break;default:Nn=HA(Sn)}if(Nn===null||(on.push(Nn[0]),(Sn=lb(Nn[1]))!==""&&Sn.charAt(0)!==","))return Cm;Sn=Sn.replace(/^,/,"")}return on})(en);if(this.fontFaces){var nn=(function(Jt,zn){var Nn=Jt.getFontList(),on=JSON.stringify(Nn);if(st===null||yt!==on){var Sn=(function(lt){var Qt=[];return Object.keys(lt).forEach(function($t){lt[$t].forEach(function(Gt){var An=null;switch(Gt){case"bold":An={family:$t,weight:"bold"};break;case"italic":An={family:$t,style:"italic"};break;case"bolditalic":An={family:$t,weight:"bold",style:"italic"};break;case"":case"normal":An={family:$t}}An!==null&&(An.ref={name:$t,style:Gt},Qt.push(An))})}),Qt})(Nn);st=(function(lt){for(var Qt={},$t=0;$t<lt.length;++$t){var Gt=Tm(lt[$t]),An=Gt.family,Vi=Gt.stretch,qn=Gt.style,yn=Gt.weight;Qt[An]=Qt[An]||{},Qt[An][Vi]=Qt[An][Vi]||{},Qt[An][Vi][qn]=Qt[An][Vi][qn]||{},Qt[An][Vi][qn][yn]=Gt}return Qt})(Sn.concat(zn)),yt=on}return st})(this.pdf,this.fontFaces),Zn=wn.map(function(Jt){return{family:Jt,stretch:"normal",weight:Lt,style:Ut}}),Pt=(function(Jt,zn,Nn){for(var on=(Nn=Nn||{}).defaultFontFamily||"times",Sn=Object.assign({},FA,Nn.genericFontFamilies||{}),lt=null,Qt=null,$t=0;$t<zn.length;++$t)if(Sn[(lt=Tm(zn[$t])).family]&&(lt.family=Sn[lt.family]),Jt.hasOwnProperty(lt.family)){Qt=Jt[lt.family];break}if(!(Qt=Qt||Jt[on]))throw new Error("Could not find a font-family for the rule '"+ob(lt)+"' and default family '"+on+"'.");if(Qt=(function(Gt,An){if(An[Gt])return An[Gt];var Vi=Jm[Gt],qn=Vi<=Jm.normal?-1:1,yn=rb(An,V2,Vi,qn);if(!yn)throw new Error("Could not find a matching font-stretch value for "+Gt);return yn})(lt.stretch,Qt),Qt=(function(Gt,An){if(An[Gt])return An[Gt];for(var Vi=q2[Gt],qn=0;qn<Vi.length;++qn)if(An[Vi[qn]])return An[Vi[qn]];throw new Error("Could not find a matching font-style for "+Gt)})(lt.style,Qt),!(Qt=(function(Gt,An){if(An[Gt])return An[Gt];if(Gt===400&&An[500])return An[500];if(Gt===500&&An[400])return An[400];var Vi=OA[Gt],qn=rb(An,W2,Vi,Gt<400?-1:1);if(!qn)throw new Error("Could not find a matching font-weight for value "+Gt);return qn})(lt.weight,Qt)))throw new Error("Failed to resolve a font for the rule '"+ob(lt)+"'.");return Qt})(nn,Zn);this.pdf.setFont(Pt.ref.name,Pt.ref.style)}else{var Mt="";(Lt==="bold"||parseInt(Lt,10)>=700||Ut==="bold")&&(Mt="bold"),Ut==="italic"&&(Mt+="italic"),Mt.length===0&&(Mt="normal");for(var yi="",ft={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},_t=0;_t<wn.length;_t++){if(this.pdf.internal.getFont(wn[_t],Mt,{noFallback:!0,disableWarning:!0})!==void 0){yi=wn[_t];break}if(Mt==="bolditalic"&&this.pdf.internal.getFont(wn[_t],"bold",{noFallback:!0,disableWarning:!0})!==void 0)yi=wn[_t],Mt="bold";else if(this.pdf.internal.getFont(wn[_t],"normal",{noFallback:!0,disableWarning:!0})!==void 0){yi=wn[_t],Mt="normal";break}}if(yi===""){for(var On=0;On<wn.length;On++)if(ft[wn[On]]){yi=ft[wn[On]];break}}yi=yi===""?"Times":yi,this.pdf.setFont(yi,Mt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(pe){this.ctx.globalCompositeOperation=pe}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(pe){this.ctx.globalAlpha=pe}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(pe){this.ctx.lineDashOffset=pe,Z.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(pe){this.ctx.lineDash=pe,Z.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(pe){this.ctx.ignoreClearRect=!!pe}})};b.prototype.setLineDash=function(D){this.lineDash=D},b.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},b.prototype.fill=function(){B.call(this,"fill",!1)},b.prototype.stroke=function(){B.call(this,"stroke",!1)},b.prototype.beginPath=function(){this.path=[{type:"begin"}]},b.prototype.moveTo=function(D,H){if(isNaN(D)||isNaN(H))throw Ys.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var Y=this.ctx.transform.applyToPoint(new d(D,H));this.path.push({type:"mt",x:Y.x,y:Y.y}),this.ctx.lastPoint=new d(D,H)},b.prototype.closePath=function(){var D=new d(0,0),H=0;for(H=this.path.length-1;H!==-1;H--)if(this.path[H].type==="begin"&&Rs(this.path[H+1])==="object"&&typeof this.path[H+1].x=="number"){D=new d(this.path[H+1].x,this.path[H+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new d(D.x,D.y)},b.prototype.lineTo=function(D,H){if(isNaN(D)||isNaN(H))throw Ys.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var Y=this.ctx.transform.applyToPoint(new d(D,H));this.path.push({type:"lt",x:Y.x,y:Y.y}),this.ctx.lastPoint=new d(Y.x,Y.y)},b.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),B.call(this,null,!0)},b.prototype.quadraticCurveTo=function(D,H,Y,ue){if(isNaN(Y)||isNaN(ue)||isNaN(D)||isNaN(H))throw Ys.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Ne=this.ctx.transform.applyToPoint(new d(Y,ue)),Pe=this.ctx.transform.applyToPoint(new d(D,H));this.path.push({type:"qct",x1:Pe.x,y1:Pe.y,x:Ne.x,y:Ne.y}),this.ctx.lastPoint=new d(Ne.x,Ne.y)},b.prototype.bezierCurveTo=function(D,H,Y,ue,Ne,Pe){if(isNaN(Ne)||isNaN(Pe)||isNaN(D)||isNaN(H)||isNaN(Y)||isNaN(ue))throw Ys.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Ue=this.ctx.transform.applyToPoint(new d(Ne,Pe)),Re=this.ctx.transform.applyToPoint(new d(D,H)),Ke=this.ctx.transform.applyToPoint(new d(Y,ue));this.path.push({type:"bct",x1:Re.x,y1:Re.y,x2:Ke.x,y2:Ke.y,x:Ue.x,y:Ue.y}),this.ctx.lastPoint=new d(Ue.x,Ue.y)},b.prototype.arc=function(D,H,Y,ue,Ne,Pe){if(isNaN(D)||isNaN(H)||isNaN(Y)||isNaN(ue)||isNaN(Ne))throw Ys.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Pe=!!Pe,!this.ctx.transform.isIdentity){var Ue=this.ctx.transform.applyToPoint(new d(D,H));D=Ue.x,H=Ue.y;var Re=this.ctx.transform.applyToPoint(new d(0,Y)),Ke=this.ctx.transform.applyToPoint(new d(0,0));Y=Math.sqrt(Math.pow(Re.x-Ke.x,2)+Math.pow(Re.y-Ke.y,2))}Math.abs(Ne-ue)>=2*Math.PI&&(ue=0,Ne=2*Math.PI),this.path.push({type:"arc",x:D,y:H,radius:Y,startAngle:ue,endAngle:Ne,counterclockwise:Pe})},b.prototype.arcTo=function(D,H,Y,ue,Ne){throw new Error("arcTo not implemented.")},b.prototype.rect=function(D,H,Y,ue){if(isNaN(D)||isNaN(H)||isNaN(Y)||isNaN(ue))throw Ys.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(D,H),this.lineTo(D+Y,H),this.lineTo(D+Y,H+ue),this.lineTo(D,H+ue),this.lineTo(D,H),this.lineTo(D+Y,H),this.lineTo(D,H)},b.prototype.fillRect=function(D,H,Y,ue){if(isNaN(D)||isNaN(H)||isNaN(Y)||isNaN(ue))throw Ys.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!v.call(this)){var Ne={};this.lineCap!=="butt"&&(Ne.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Ne.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(D,H,Y,ue),this.fill(),Ne.hasOwnProperty("lineCap")&&(this.lineCap=Ne.lineCap),Ne.hasOwnProperty("lineJoin")&&(this.lineJoin=Ne.lineJoin)}},b.prototype.strokeRect=function(D,H,Y,ue){if(isNaN(D)||isNaN(H)||isNaN(Y)||isNaN(ue))throw Ys.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");E.call(this)||(this.beginPath(),this.rect(D,H,Y,ue),this.stroke())},b.prototype.clearRect=function(D,H,Y,ue){if(isNaN(D)||isNaN(H)||isNaN(Y)||isNaN(ue))throw Ys.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(D,H,Y,ue))},b.prototype.save=function(D){D=typeof D!="boolean"||D;for(var H=this.pdf.internal.getCurrentPageInfo().pageNumber,Y=0;Y<this.pdf.internal.getNumberOfPages();Y++)this.pdf.setPage(Y+1),this.pdf.internal.out("q");if(this.pdf.setPage(H),D){this.ctx.fontSize=this.pdf.internal.getFontSize();var ue=new m(this.ctx);this.ctxStack.push(this.ctx),this.ctx=ue}},b.prototype.restore=function(D){D=typeof D!="boolean"||D;for(var H=this.pdf.internal.getCurrentPageInfo().pageNumber,Y=0;Y<this.pdf.internal.getNumberOfPages();Y++)this.pdf.setPage(Y+1),this.pdf.internal.out("Q");this.pdf.setPage(H),D&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},b.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var A=function(D){var H,Y,ue,Ne;if(D.isCanvasGradient===!0&&(D=D.getColor()),!D)return{r:0,g:0,b:0,a:0,style:D};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(D))H=0,Y=0,ue=0,Ne=0;else{var Pe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(D);if(Pe!==null)H=parseInt(Pe[1]),Y=parseInt(Pe[2]),ue=parseInt(Pe[3]),Ne=1;else if((Pe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(D))!==null)H=parseInt(Pe[1]),Y=parseInt(Pe[2]),ue=parseInt(Pe[3]),Ne=parseFloat(Pe[4]);else{if(Ne=1,typeof D=="string"&&D.charAt(0)!=="#"){var Ue=new z2(D);D=Ue.ok?Ue.toHex():"#000000"}D.length===4?(H=D.substring(1,2),H+=H,Y=D.substring(2,3),Y+=Y,ue=D.substring(3,4),ue+=ue):(H=D.substring(1,3),Y=D.substring(3,5),ue=D.substring(5,7)),H=parseInt(H,16),Y=parseInt(Y,16),ue=parseInt(ue,16)}}return{r:H,g:Y,b:ue,a:Ne,style:D}},v=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},E=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};b.prototype.fillText=function(D,H,Y,ue){if(isNaN(H)||isNaN(Y)||typeof D!="string")throw Ys.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(ue=isNaN(ue)?void 0:ue,!v.call(this)){var Ne=ce(this.ctx.transform.rotation),Pe=this.ctx.transform.scaleX;N.call(this,{text:D,x:H,y:Y,scale:Pe,angle:Ne,align:this.textAlign,maxWidth:ue})}},b.prototype.strokeText=function(D,H,Y,ue){if(isNaN(H)||isNaN(Y)||typeof D!="string")throw Ys.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!E.call(this)){ue=isNaN(ue)?void 0:ue;var Ne=ce(this.ctx.transform.rotation),Pe=this.ctx.transform.scaleX;N.call(this,{text:D,x:H,y:Y,scale:Pe,renderingMode:"stroke",angle:Ne,align:this.textAlign,maxWidth:ue})}},b.prototype.measureText=function(D){if(typeof D!="string")throw Ys.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var H=this.pdf,Y=this.pdf.internal.scaleFactor,ue=H.internal.getFontSize(),Ne=H.getStringUnitWidth(D)*ue/H.internal.scaleFactor;return new function(Pe){var Ue=(Pe=Pe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Ue}}),this}({width:Ne*=Math.round(96*Y/72*1e4)/1e4})},b.prototype.scale=function(D,H){if(isNaN(D)||isNaN(H))throw Ys.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var Y=new h(D,0,0,H,0,0);this.ctx.transform=this.ctx.transform.multiply(Y)},b.prototype.rotate=function(D){if(isNaN(D))throw Ys.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var H=new h(Math.cos(D),Math.sin(D),-Math.sin(D),Math.cos(D),0,0);this.ctx.transform=this.ctx.transform.multiply(H)},b.prototype.translate=function(D,H){if(isNaN(D)||isNaN(H))throw Ys.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var Y=new h(1,0,0,1,D,H);this.ctx.transform=this.ctx.transform.multiply(Y)},b.prototype.transform=function(D,H,Y,ue,Ne,Pe){if(isNaN(D)||isNaN(H)||isNaN(Y)||isNaN(ue)||isNaN(Ne)||isNaN(Pe))throw Ys.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Ue=new h(D,H,Y,ue,Ne,Pe);this.ctx.transform=this.ctx.transform.multiply(Ue)},b.prototype.setTransform=function(D,H,Y,ue,Ne,Pe){D=isNaN(D)?1:D,H=isNaN(H)?0:H,Y=isNaN(Y)?0:Y,ue=isNaN(ue)?1:ue,Ne=isNaN(Ne)?0:Ne,Pe=isNaN(Pe)?0:Pe,this.ctx.transform=new h(D,H,Y,ue,Ne,Pe)};var x=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};b.prototype.drawImage=function(D,H,Y,ue,Ne,Pe,Ue,Re,Ke){var Je=this.pdf.getImageProperties(D),st=1,yt=1,Nt=1,pe=1;ue!==void 0&&Re!==void 0&&(Nt=Re/ue,pe=Ke/Ne,st=Je.width/ue*Re/ue,yt=Je.height/Ne*Ke/Ne),Pe===void 0&&(Pe=H,Ue=Y,H=0,Y=0),ue!==void 0&&Re===void 0&&(Re=ue,Ke=Ne),ue===void 0&&Re===void 0&&(Re=Je.width,Ke=Je.height);var St=this.ctx.transform.decompose(),Ut=ce(St.rotate.shx),Lt=new h,at=(Lt=(Lt=(Lt=Lt.multiply(St.translate)).multiply(St.skew)).multiply(St.scale)).applyToRectangle(new c(Pe-H*Nt,Ue-Y*pe,ue*st,Ne*yt));if(this.autoPaging){for(var en,Ot=k.call(this,at),wn=[],nn=0;nn<Ot.length;nn+=1)wn.indexOf(Ot[nn])===-1&&wn.push(Ot[nn]);z(wn);for(var Zn=wn[0],Pt=wn[wn.length-1],Mt=Zn;Mt<Pt+1;Mt++){this.pdf.setPage(Mt);var yi=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ft=Mt===1?this.posY+this.margin[0]:this.margin[0],_t=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],On=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Jt=Mt===1?0:_t+(Mt-2)*On;if(this.ctx.clip_path.length!==0){var zn=this.path;en=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=$(en,this.posX+this.margin[3],-Jt+ft+this.ctx.prevPageLastElemOffset),F.call(this,"fill",!0),this.path=zn}var Nn=JSON.parse(JSON.stringify(at));Nn=$([Nn],this.posX+this.margin[3],-Jt+ft+this.ctx.prevPageLastElemOffset)[0];var on=(Mt>Zn||Mt<Pt)&&x.call(this);on&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],yi,On,null).clip().discardPath()),this.pdf.addImage(D,"JPEG",Nn.x,Nn.y,Nn.w,Nn.h,null,null,Ut),on&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(D,"JPEG",at.x,at.y,at.w,at.h,null,null,Ut)};var k=function(D,H,Y){var ue=[];H=H||this.pdf.internal.pageSize.width,Y=Y||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Ne=this.posY+this.ctx.prevPageLastElemOffset;switch(D.type){default:case"mt":case"lt":ue.push(Math.floor((D.y+Ne)/Y)+1);break;case"arc":ue.push(Math.floor((D.y+Ne-D.radius)/Y)+1),ue.push(Math.floor((D.y+Ne+D.radius)/Y)+1);break;case"qct":var Pe=_e(this.ctx.lastPoint.x,this.ctx.lastPoint.y,D.x1,D.y1,D.x,D.y);ue.push(Math.floor((Pe.y+Ne)/Y)+1),ue.push(Math.floor((Pe.y+Pe.h+Ne)/Y)+1);break;case"bct":var Ue=xe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,D.x1,D.y1,D.x2,D.y2,D.x,D.y);ue.push(Math.floor((Ue.y+Ne)/Y)+1),ue.push(Math.floor((Ue.y+Ue.h+Ne)/Y)+1);break;case"rect":ue.push(Math.floor((D.y+Ne)/Y)+1),ue.push(Math.floor((D.y+D.h+Ne)/Y)+1)}for(var Re=0;Re<ue.length;Re+=1)for(;this.pdf.internal.getNumberOfPages()<ue[Re];)j.call(this);return ue},j=function(){var D=this.fillStyle,H=this.strokeStyle,Y=this.font,ue=this.lineCap,Ne=this.lineWidth,Pe=this.lineJoin;this.pdf.addPage(),this.fillStyle=D,this.strokeStyle=H,this.font=Y,this.lineCap=ue,this.lineWidth=Ne,this.lineJoin=Pe},$=function(D,H,Y){for(var ue=0;ue<D.length;ue++)switch(D[ue].type){case"bct":D[ue].x2+=H,D[ue].y2+=Y;case"qct":D[ue].x1+=H,D[ue].y1+=Y;default:D[ue].x+=H,D[ue].y+=Y}return D},z=function(D){return D.sort(function(H,Y){return H-Y})},B=function(D,H){var Y=this.fillStyle,ue=this.strokeStyle,Ne=this.lineCap,Pe=this.lineWidth,Ue=Math.abs(Pe*this.ctx.transform.scaleX),Re=this.lineJoin;if(this.autoPaging){for(var Ke,Je,st=JSON.parse(JSON.stringify(this.path)),yt=JSON.parse(JSON.stringify(this.path)),Nt=[],pe=0;pe<yt.length;pe++)if(yt[pe].x!==void 0)for(var St=k.call(this,yt[pe]),Ut=0;Ut<St.length;Ut+=1)Nt.indexOf(St[Ut])===-1&&Nt.push(St[Ut]);for(var Lt=0;Lt<Nt.length;Lt++)for(;this.pdf.internal.getNumberOfPages()<Nt[Lt];)j.call(this);z(Nt);for(var at=Nt[0],en=Nt[Nt.length-1],Ot=at;Ot<en+1;Ot++){this.pdf.setPage(Ot),this.fillStyle=Y,this.strokeStyle=ue,this.lineCap=Ne,this.lineWidth=Ue,this.lineJoin=Re;var wn=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],nn=Ot===1?this.posY+this.margin[0]:this.margin[0],Zn=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Pt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Mt=Ot===1?0:Zn+(Ot-2)*Pt;if(this.ctx.clip_path.length!==0){var yi=this.path;Ke=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=$(Ke,this.posX+this.margin[3],-Mt+nn+this.ctx.prevPageLastElemOffset),F.call(this,D,!0),this.path=yi}if(Je=JSON.parse(JSON.stringify(st)),this.path=$(Je,this.posX+this.margin[3],-Mt+nn+this.ctx.prevPageLastElemOffset),H===!1||Ot===0){var ft=(Ot>at||Ot<en)&&x.call(this);ft&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],wn,Pt,null).clip().discardPath()),F.call(this,D,H),ft&&this.pdf.restoreGraphicsState()}this.lineWidth=Pe}this.path=st}else this.lineWidth=Ue,F.call(this,D,H),this.lineWidth=Pe},F=function(D,H){if((D!=="stroke"||H||!E.call(this))&&(D==="stroke"||H||!v.call(this))){for(var Y,ue,Ne=[],Pe=this.path,Ue=0;Ue<Pe.length;Ue++){var Re=Pe[Ue];switch(Re.type){case"begin":Ne.push({begin:!0});break;case"close":Ne.push({close:!0});break;case"mt":Ne.push({start:Re,deltas:[],abs:[]});break;case"lt":var Ke=Ne.length;if(Pe[Ue-1]&&!isNaN(Pe[Ue-1].x)&&(Y=[Re.x-Pe[Ue-1].x,Re.y-Pe[Ue-1].y],Ke>0)){for(;Ke>=0;Ke--)if(Ne[Ke-1].close!==!0&&Ne[Ke-1].begin!==!0){Ne[Ke-1].deltas.push(Y),Ne[Ke-1].abs.push(Re);break}}break;case"bct":Y=[Re.x1-Pe[Ue-1].x,Re.y1-Pe[Ue-1].y,Re.x2-Pe[Ue-1].x,Re.y2-Pe[Ue-1].y,Re.x-Pe[Ue-1].x,Re.y-Pe[Ue-1].y],Ne[Ne.length-1].deltas.push(Y);break;case"qct":var Je=Pe[Ue-1].x+2/3*(Re.x1-Pe[Ue-1].x),st=Pe[Ue-1].y+2/3*(Re.y1-Pe[Ue-1].y),yt=Re.x+2/3*(Re.x1-Re.x),Nt=Re.y+2/3*(Re.y1-Re.y),pe=Re.x,St=Re.y;Y=[Je-Pe[Ue-1].x,st-Pe[Ue-1].y,yt-Pe[Ue-1].x,Nt-Pe[Ue-1].y,pe-Pe[Ue-1].x,St-Pe[Ue-1].y],Ne[Ne.length-1].deltas.push(Y);break;case"arc":Ne.push({deltas:[],abs:[],arc:!0}),Array.isArray(Ne[Ne.length-1].abs)&&Ne[Ne.length-1].abs.push(Re)}}ue=H?null:D==="stroke"?"stroke":"fill";for(var Ut=!1,Lt=0;Lt<Ne.length;Lt++)if(Ne[Lt].arc)for(var at=Ne[Lt].abs,en=0;en<at.length;en++){var Ot=at[en];Ot.type==="arc"?M.call(this,Ot.x,Ot.y,Ot.radius,Ot.startAngle,Ot.endAngle,Ot.counterclockwise,void 0,H,!Ut):te.call(this,Ot.x,Ot.y),Ut=!0}else if(Ne[Lt].close===!0)this.pdf.internal.out("h"),Ut=!1;else if(Ne[Lt].begin!==!0){var wn=Ne[Lt].start.x,nn=Ne[Lt].start.y;ie.call(this,Ne[Lt].deltas,wn,nn),Ut=!0}ue&&G.call(this,ue),H&&U.call(this)}},I=function(D){var H=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,Y=H*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return D-Y;case"top":return D+H-Y;case"hanging":return D+H-2*Y;case"middle":return D+H/2-Y;default:return D}},X=function(D){return D+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};b.prototype.createLinearGradient=function(){var D=function(){};return D.colorStops=[],D.addColorStop=function(H,Y){this.colorStops.push([H,Y])},D.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},D.isCanvasGradient=!0,D},b.prototype.createPattern=function(){return this.createLinearGradient()},b.prototype.createRadialGradient=function(){return this.createLinearGradient()};var M=function(D,H,Y,ue,Ne,Pe,Ue,Re,Ke){for(var Je=q.call(this,Y,ue,Ne,Pe),st=0;st<Je.length;st++){var yt=Je[st];st===0&&(Ke?_.call(this,yt.x1+D,yt.y1+H):te.call(this,yt.x1+D,yt.y1+H)),re.call(this,D,H,yt.x2,yt.y2,yt.x3,yt.y3,yt.x4,yt.y4)}Re?U.call(this):G.call(this,Ue)},G=function(D){switch(D){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},U=function(){this.pdf.clip(),this.pdf.discardPath()},_=function(D,H){this.pdf.internal.out(t(D)+" "+n(H)+" m")},N=function(D){var H;switch(D.align){case"right":case"end":H="right";break;case"center":H="center";break;default:H="left"}var Y,ue,Ne,Pe=this.pdf.getTextDimensions(D.text),Ue=I.call(this,D.y),Re=X.call(this,Ue)-Pe.h,Ke=this.ctx.transform.applyToPoint(new d(D.x,Ue));if(this.autoPaging){var Je=this.ctx.transform.decompose(),st=new h;st=(st=(st=st.multiply(Je.translate)).multiply(Je.skew)).multiply(Je.scale);for(var yt=this.ctx.transform.applyToRectangle(new c(D.x,Ue,Pe.w,Pe.h)),Nt=st.applyToRectangle(new c(D.x,Re,Pe.w,Pe.h)),pe=k.call(this,Nt),St=[],Ut=0;Ut<pe.length;Ut+=1)St.indexOf(pe[Ut])===-1&&St.push(pe[Ut]);z(St);for(var Lt=St[0],at=St[St.length-1],en=Lt;en<at+1;en++){this.pdf.setPage(en);var Ot=en===1?this.posY+this.margin[0]:this.margin[0],wn=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],nn=this.pdf.internal.pageSize.height-this.margin[2],Zn=nn-this.margin[0],Pt=this.pdf.internal.pageSize.width-this.margin[1],Mt=Pt-this.margin[3],yi=en===1?0:wn+(en-2)*Zn;if(this.ctx.clip_path.length!==0){var ft=this.path;Y=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=$(Y,this.posX+this.margin[3],-1*yi+Ot),F.call(this,"fill",!0),this.path=ft}var _t=$([JSON.parse(JSON.stringify(Nt))],this.posX+this.margin[3],-yi+Ot+this.ctx.prevPageLastElemOffset)[0];D.scale>=.01&&(ue=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ue*D.scale),Ne=this.lineWidth,this.lineWidth=Ne*D.scale);var On=this.autoPaging!=="text";if(On||_t.y+_t.h<=nn){if(On||_t.y>=Ot&&_t.x<=Pt){var Jt=On?D.text:this.pdf.splitTextToSize(D.text,D.maxWidth||Pt-_t.x)[0],zn=$([JSON.parse(JSON.stringify(yt))],this.posX+this.margin[3],-yi+Ot+this.ctx.prevPageLastElemOffset)[0],Nn=On&&(en>Lt||en<at)&&x.call(this);Nn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Mt,Zn,null).clip().discardPath()),this.pdf.text(Jt,zn.x,zn.y,{angle:D.angle,align:H,renderingMode:D.renderingMode}),Nn&&this.pdf.restoreGraphicsState()}}else _t.y<nn&&(this.ctx.prevPageLastElemOffset+=nn-_t.y);D.scale>=.01&&(this.pdf.setFontSize(ue),this.lineWidth=Ne)}}else D.scale>=.01&&(ue=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ue*D.scale),Ne=this.lineWidth,this.lineWidth=Ne*D.scale),this.pdf.text(D.text,Ke.x+this.posX,Ke.y+this.posY,{angle:D.angle,align:H,renderingMode:D.renderingMode,maxWidth:D.maxWidth}),D.scale>=.01&&(this.pdf.setFontSize(ue),this.lineWidth=Ne)},te=function(D,H,Y,ue){Y=Y||0,ue=ue||0,this.pdf.internal.out(t(D+Y)+" "+n(H+ue)+" l")},ie=function(D,H,Y){return this.pdf.lines(D,H,Y,null,null)},re=function(D,H,Y,ue,Ne,Pe,Ue,Re){this.pdf.internal.out([e(s(Y+D)),e(o(ue+H)),e(s(Ne+D)),e(o(Pe+H)),e(s(Ue+D)),e(o(Re+H)),"c"].join(" "))},q=function(D,H,Y,ue){for(var Ne=2*Math.PI,Pe=Math.PI/2;H>Y;)H-=Ne;var Ue=Math.abs(Y-H);Ue<Ne&&ue&&(Ue=Ne-Ue);for(var Re=[],Ke=ue?-1:1,Je=H;Ue>1e-5;){var st=Je+Ke*Math.min(Ue,Pe);Re.push(J.call(this,D,Je,st)),Ue-=Math.abs(st-Je),Je=st}return Re},J=function(D,H,Y){var ue=(Y-H)/2,Ne=D*Math.cos(ue),Pe=D*Math.sin(ue),Ue=Ne,Re=-Pe,Ke=Ue*Ue+Re*Re,Je=Ke+Ue*Ne+Re*Pe,st=4/3*(Math.sqrt(2*Ke*Je)-Je)/(Ue*Pe-Re*Ne),yt=Ue-st*Re,Nt=Re+st*Ue,pe=yt,St=-Nt,Ut=ue+H,Lt=Math.cos(Ut),at=Math.sin(Ut);return{x1:D*Math.cos(H),y1:D*Math.sin(H),x2:yt*Lt-Nt*at,y2:yt*at+Nt*Lt,x3:pe*Lt-St*at,y3:pe*at+St*Lt,x4:D*Math.cos(Y),y4:D*Math.sin(Y)}},ce=function(D){return 180*D/Math.PI},_e=function(D,H,Y,ue,Ne,Pe){var Ue=D+.5*(Y-D),Re=H+.5*(ue-H),Ke=Ne+.5*(Y-Ne),Je=Pe+.5*(ue-Pe),st=Math.min(D,Ne,Ue,Ke),yt=Math.max(D,Ne,Ue,Ke),Nt=Math.min(H,Pe,Re,Je),pe=Math.max(H,Pe,Re,Je);return new c(st,Nt,yt-st,pe-Nt)},xe=function(D,H,Y,ue,Ne,Pe,Ue,Re){var Ke,Je,st,yt,Nt,pe,St,Ut,Lt,at,en,Ot,wn,nn,Zn=Y-D,Pt=ue-H,Mt=Ne-Y,yi=Pe-ue,ft=Ue-Ne,_t=Re-Pe;for(Je=0;Je<41;Je++)Lt=(St=(st=D+(Ke=Je/40)*Zn)+Ke*((Nt=Y+Ke*Mt)-st))+Ke*(Nt+Ke*(Ne+Ke*ft-Nt)-St),at=(Ut=(yt=H+Ke*Pt)+Ke*((pe=ue+Ke*yi)-yt))+Ke*(pe+Ke*(Pe+Ke*_t-pe)-Ut),Je==0?(en=Lt,Ot=at,wn=Lt,nn=at):(en=Math.min(en,Lt),Ot=Math.min(Ot,at),wn=Math.max(wn,Lt),nn=Math.max(nn,at));return new c(Math.round(en),Math.round(Ot),Math.round(wn-en),Math.round(nn-Ot))},Z=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var D,H,Y=(D=this.ctx.lineDash,H=this.ctx.lineDashOffset,JSON.stringify({lineDash:D,lineDashOffset:H}));this.prevLineDash!==Y&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=Y)}}})(jn.API),(function(r){var e=function(d){var c,h,f,m,b,A,v,E,x,k;for(h=[],f=0,m=(d+=c="\0\0\0\0".slice(d.length%4||4)).length;m>f;f+=4)(b=(d.charCodeAt(f)<<24)+(d.charCodeAt(f+1)<<16)+(d.charCodeAt(f+2)<<8)+d.charCodeAt(f+3))!==0?(A=(b=((b=((b=((b=(b-(k=b%85))/85)-(x=b%85))/85)-(E=b%85))/85)-(v=b%85))/85)%85,h.push(A+33,v+33,E+33,x+33,k+33)):h.push(122);return(function(j,$){for(var z=$;z>0;z--)j.pop()})(h,c.length),String.fromCharCode.apply(String,h)+"~>"},t=function(d){var c,h,f,m,b,A=String,v="length",E=255,x="charCodeAt",k="slice",j="replace";for(d[k](-2),d=d[k](0,-2)[j](/\s/g,"")[j]("z","!!!!!"),f=[],m=0,b=(d+=c="uuuuu"[k](d[v]%5||5))[v];b>m;m+=5)h=52200625*(d[x](m)-33)+614125*(d[x](m+1)-33)+7225*(d[x](m+2)-33)+85*(d[x](m+3)-33)+(d[x](m+4)-33),f.push(E&h>>24,E&h>>16,E&h>>8,E&h);return(function($,z){for(var B=z;B>0;B--)$.pop()})(f,c[v]),A.fromCharCode.apply(A,f)},n=function(d){return d.split("").map(function(c){return("0"+c.charCodeAt().toString(16)).slice(-2)}).join("")+">"},s=function(d){var c=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((d=d.replace(/\s/g,"")).indexOf(">")!==-1&&(d=d.substr(0,d.indexOf(">"))),d.length%2&&(d+="0"),c.test(d)===!1)return"";for(var h="",f=0;f<d.length;f+=2)h+=String.fromCharCode("0x"+(d[f]+d[f+1]));return h},o=function(d){for(var c=new Uint8Array(d.length),h=d.length;h--;)c[h]=d.charCodeAt(h);return(c=Wm(c)).reduce(function(f,m){return f+String.fromCharCode(m)},"")};r.processDataByFilters=function(d,c){var h=0,f=d||"",m=[];for(typeof(c=c||[])=="string"&&(c=[c]),h=0;h<c.length;h+=1)switch(c[h]){case"ASCII85Decode":case"/ASCII85Decode":f=t(f),m.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":f=e(f),m.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":f=s(f),m.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":f=n(f),m.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":f=o(f),m.push("/FlateDecode");break;default:throw new Error('The filter: "'+c[h]+'" is not implemented')}return{data:f,reverseChain:m.reverse().join(" ")}}})(jn.API),(function(r){r.loadFile=function(e,t,n){return(function(s,o,d){o=o!==!1,d=typeof d=="function"?d:function(){};var c=void 0;try{c=(function(h,f,m){var b=new XMLHttpRequest,A=0,v=function(E){var x=E.length,k=[],j=String.fromCharCode;for(A=0;A<x;A+=1)k.push(j(255&E.charCodeAt(A)));return k.join("")};if(b.open("GET",h,!f),b.overrideMimeType("text/plain; charset=x-user-defined"),f===!1&&(b.onload=function(){b.status===200?m(v(this.responseText)):m(void 0)}),b.send(null),f&&b.status===200)return v(b.responseText)})(s,o,d)}catch{}return c})(e,t,n)},r.loadImageFile=r.loadFile})(jn.API),(function(r){function e(){return(Qn.html2canvas?Promise.resolve(Qn.html2canvas):am(()=>import("./html2canvas.esm-B0tyYwQk.js"),[])).catch(function(c){return Promise.reject(new Error("Could not load html2canvas: "+c))}).then(function(c){return c.default?c.default:c})}function t(){return(Qn.DOMPurify?Promise.resolve(Qn.DOMPurify):am(()=>import("./purify.es-B6FQ9oRL.js"),[])).catch(function(c){return Promise.reject(new Error("Could not load dompurify: "+c))}).then(function(c){return c.default?c.default:c})}var n=function(c){var h=Rs(c);return h==="undefined"?"undefined":h==="string"||c instanceof String?"string":h==="number"||c instanceof Number?"number":h==="function"||c instanceof Function?"function":c&&c.constructor===Array?"array":c&&c.nodeType===1?"element":h==="object"?"object":"unknown"},s=function(c,h){var f=document.createElement(c);for(var m in h.className&&(f.className=h.className),h.innerHTML&&h.dompurify&&(f.innerHTML=h.dompurify.sanitize(h.innerHTML)),h.style)f.style[m]=h.style[m];return f},o=function c(h,f){for(var m=h.nodeType===3?document.createTextNode(h.nodeValue):h.cloneNode(!1),b=h.firstChild;b;b=b.nextSibling)f!==!0&&b.nodeType===1&&b.nodeName==="SCRIPT"||m.appendChild(c(b,f));return h.nodeType===1&&(h.nodeName==="CANVAS"?(m.width=h.width,m.height=h.height,m.getContext("2d").drawImage(h,0,0)):h.nodeName!=="TEXTAREA"&&h.nodeName!=="SELECT"||(m.value=h.value),m.addEventListener("load",function(){m.scrollTop=h.scrollTop,m.scrollLeft=h.scrollLeft},!0)),m},d=function c(h){var f=Object.assign(c.convert(Promise.resolve()),JSON.parse(JSON.stringify(c.template))),m=c.convert(Promise.resolve(),f);return(m=m.setProgress(1,c,1,[c])).set(h)};(d.prototype=Object.create(Promise.prototype)).constructor=d,d.convert=function(c,h){return c.__proto__=h||d.prototype,c},d.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},d.prototype.from=function(c,h){return this.then(function(){switch(h=h||(function(f){switch(n(f)){case"string":return"string";case"element":return f.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(c),h){case"string":return this.then(t).then(function(f){return this.set({src:s("div",{innerHTML:c,dompurify:f})})});case"element":return this.set({src:c});case"canvas":return this.set({canvas:c});case"img":return this.set({img:c});default:return this.error("Unknown source type.")}})},d.prototype.to=function(c){switch(c){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},d.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var c={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},h=o(this.prop.src,this.opt.html2canvas.javascriptEnabled);h.tagName==="BODY"&&(c.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:c}),this.prop.container.appendChild(h),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},d.prototype.toCanvas=function(){var c=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(c).then(e).then(function(h){var f=Object.assign({},this.opt.html2canvas);return delete f.onrendered,h(this.prop.container,f)}).then(function(h){(this.opt.html2canvas.onrendered||function(){})(h),this.prop.canvas=h,document.body.removeChild(this.prop.overlay)})},d.prototype.toContext2d=function(){var c=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(c).then(e).then(function(h){var f=this.opt.jsPDF,m=this.opt.fontFaces,b=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,A=Object.assign({async:!0,allowTaint:!0,scale:b,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete A.onrendered,f.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,f.context2d.posX=this.opt.x,f.context2d.posY=this.opt.y,f.context2d.margin=this.opt.margin,f.context2d.fontFaces=m,m)for(var v=0;v<m.length;++v){var E=m[v],x=E.src.find(function(k){return k.format==="truetype"});x&&f.addFont(x.url,E.ref.name,E.ref.style)}return A.windowHeight=A.windowHeight||0,A.windowHeight=A.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):A.windowHeight,f.context2d.save(!0),h(this.prop.container,A)}).then(function(h){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(h),this.prop.canvas=h,document.body.removeChild(this.prop.overlay)})},d.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var c=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=c})},d.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},d.prototype.output=function(c,h,f){return(f=f||"pdf").toLowerCase()==="img"||f.toLowerCase()==="image"?this.outputImg(c,h):this.outputPdf(c,h)},d.prototype.outputPdf=function(c,h){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(c,h)})},d.prototype.outputImg=function(c){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(c){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+c+'" is not supported.'}})},d.prototype.save=function(c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(c?{filename:c}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},d.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},d.prototype.set=function(c){if(n(c)!=="object")return this;var h=Object.keys(c||{}).map(function(f){if(f in d.template.prop)return function(){this.prop[f]=c[f]};switch(f){case"margin":return this.setMargin.bind(this,c.margin);case"jsPDF":return function(){return this.opt.jsPDF=c.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,c.pageSize);default:return function(){this.opt[f]=c[f]}}},this);return this.then(function(){return this.thenList(h)})},d.prototype.get=function(c,h){return this.then(function(){var f=c in d.template.prop?this.prop[c]:this.opt[c];return h?h(f):f})},d.prototype.setMargin=function(c){return this.then(function(){switch(n(c)){case"number":c=[c,c,c,c];case"array":if(c.length===2&&(c=[c[0],c[1],c[0],c[1]]),c.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=c}).then(this.setPageSize)},d.prototype.setPageSize=function(c){function h(f,m){return Math.floor(f*m/72*96)}return this.then(function(){(c=c||jn.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(c.inner={width:c.width-this.opt.margin[1]-this.opt.margin[3],height:c.height-this.opt.margin[0]-this.opt.margin[2]},c.inner.px={width:h(c.inner.width,c.k),height:h(c.inner.height,c.k)},c.inner.ratio=c.inner.height/c.inner.width),this.prop.pageSize=c})},d.prototype.setProgress=function(c,h,f,m){return c!=null&&(this.progress.val=c),h!=null&&(this.progress.state=h),f!=null&&(this.progress.n=f),m!=null&&(this.progress.stack=m),this.progress.ratio=this.progress.val/this.progress.state,this},d.prototype.updateProgress=function(c,h,f,m){return this.setProgress(c?this.progress.val+c:null,h||null,f?this.progress.n+f:null,m?this.progress.stack.concat(m):null)},d.prototype.then=function(c,h){var f=this;return this.thenCore(c,h,function(m,b){return f.updateProgress(null,null,1,[m]),Promise.prototype.then.call(this,function(A){return f.updateProgress(null,m),A}).then(m,b).then(function(A){return f.updateProgress(1),A})})},d.prototype.thenCore=function(c,h,f){f=f||Promise.prototype.then;var m=this;c&&(c=c.bind(m)),h&&(h=h.bind(m));var b=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?m:d.convert(Object.assign({},m),Promise.prototype),A=f.call(b,c,h);return d.convert(A,m.__proto__)},d.prototype.thenExternal=function(c,h){return Promise.prototype.then.call(this,c,h)},d.prototype.thenList=function(c){var h=this;return c.forEach(function(f){h=h.thenCore(f)}),h},d.prototype.catch=function(c){c&&(c=c.bind(this));var h=Promise.prototype.catch.call(this,c);return d.convert(h,this)},d.prototype.catchExternal=function(c){return Promise.prototype.catch.call(this,c)},d.prototype.error=function(c){return this.then(function(){throw new Error(c)})},d.prototype.using=d.prototype.set,d.prototype.saveAs=d.prototype.save,d.prototype.export=d.prototype.output,d.prototype.run=d.prototype.then,jn.getPageSize=function(c,h,f){if(Rs(c)==="object"){var m=c;c=m.orientation,h=m.unit||h,f=m.format||f}h=h||"mm",f=f||"a4",c=(""+(c||"P")).toLowerCase();var b,A=(""+f).toLowerCase(),v={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(h){case"pt":b=1;break;case"mm":b=72/25.4;break;case"cm":b=72/2.54;break;case"in":b=72;break;case"px":b=.75;break;case"pc":case"em":b=12;break;case"ex":b=6;break;default:throw"Invalid unit: "+h}var E,x=0,k=0;if(v.hasOwnProperty(A))x=v[A][1]/b,k=v[A][0]/b;else try{x=f[1],k=f[0]}catch{throw new Error("Invalid format: "+f)}if(c==="p"||c==="portrait")c="p",k>x&&(E=k,k=x,x=E);else{if(c!=="l"&&c!=="landscape")throw"Invalid orientation: "+c;c="l",x>k&&(E=k,k=x,x=E)}return{width:k,height:x,unit:h,k:b,orientation:c}},r.html=function(c,h){(h=h||{}).callback=h.callback||function(){},h.html2canvas=h.html2canvas||{},h.html2canvas.canvas=h.html2canvas.canvas||this.canvas,h.jsPDF=h.jsPDF||this,h.fontFaces=h.fontFaces?h.fontFaces.map(Tm):null;var f=new d(h);return h.worker?f:f.from(c).doCallback()}})(jn.API),jn.API.addJS=function(r){return db=r,this.internal.events.subscribe("postPutResources",function(){kg=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(kg+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),cb=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+db+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){kg!==void 0&&cb!==void 0&&this.internal.out("/Names <</JavaScript "+kg+" 0 R>>")}),this},(function(r){var e;r.events.push(["postPutResources",function(){var t=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=t.outline.render().split(/\r\n/),o=0;o<s.length;o++){var d=s[o],c=n.exec(d);if(c!=null){var h=c[1];t.internal.newObjectDeferredBegin(h,!1)}t.internal.write(d)}if(this.outline.createNamedDestinations){var f=this.internal.pages.length,m=[];for(o=0;o<f;o++){var b=t.internal.newObject();m.push(b);var A=t.internal.getPageInfo(o+1);t.internal.write("<< /D["+A.objId+" 0 R /XYZ null null null]>> endobj")}var v=t.internal.newObject();for(t.internal.write("<< /Names [ "),o=0;o<m.length;o++)t.internal.write("(page_"+(o+1)+")"+m[o]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+v+" 0 R"),t.internal.write(">>","endobj")}}]),r.events.push(["putCatalog",function(){var t=this;t.outline.root.children.length>0&&(t.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&t.internal.write("/Names "+e+" 0 R"))}]),r.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(n,s,o){var d={title:s,options:o,children:[]};return n==null&&(n=this.root),n.children.push(d),d},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(n){n.id=t.internal.newObjectDeferred();for(var s=0;s<n.children.length;s++)this.genIds_r(n.children[s])},t.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},t.outline.renderItems=function(n){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,o=0;o<n.children.length;o++){var d=n.children[o];this.objStart(d),this.line("/Title "+this.makeString(d.title)),this.line("/Parent "+this.makeRef(n)),o>0&&this.line("/Prev "+this.makeRef(n.children[o-1])),o<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[o+1])),d.children.length>0&&(this.line("/First "+this.makeRef(d.children[0])),this.line("/Last "+this.makeRef(d.children[d.children.length-1])));var c=this.count=this.count_r({count:0},d);if(c>0&&this.line("/Count "+c),d.options&&d.options.pageNumber){var h=t.internal.getPageInfo(d.options.pageNumber);this.line("/Dest ["+h.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var f=0;f<n.children.length;f++)this.renderItems(n.children[f])},t.outline.line=function(n){this.ctx.val+=n+`\r
`},t.outline.makeRef=function(n){return n.id+" 0 R"},t.outline.makeString=function(n){return"("+t.internal.pdfEscape(n)+")"},t.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(n,s){for(var o=0;o<s.children.length;o++)n.count++,this.count_r(n,s.children[o]);return n.count}}])})(jn.API),(function(r){var e=[192,193,194,195,196,197,198,199];r.processJPEG=function(t,n,s,o,d,c){var h,f=this.decode.DCT_DECODE,m=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=d||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,h=(function(b){for(var A,v=256*b.charCodeAt(4)+b.charCodeAt(5),E=b.length,x={width:0,height:0,numcomponents:1},k=4;k<E;k+=2){if(k+=v,e.indexOf(b.charCodeAt(k+1))!==-1){A=256*b.charCodeAt(k+5)+b.charCodeAt(k+6),x={width:256*b.charCodeAt(k+7)+b.charCodeAt(k+8),height:A,numcomponents:b.charCodeAt(k+9)};break}v=256*b.charCodeAt(k+2)+b.charCodeAt(k+3)}return x})(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t),h.numcomponents){case 1:c=this.color_spaces.DEVICE_GRAY;break;case 4:c=this.color_spaces.DEVICE_CMYK;break;case 3:c=this.color_spaces.DEVICE_RGB}m={data:t,width:h.width,height:h.height,colorSpace:c,bitsPerComponent:8,filter:f,index:n,alias:s}}return m}})(jn.API),jn.API.processPNG=function(r,e,t,n){if(this.__addimage__.isArrayBuffer(r)&&(r=new Uint8Array(r)),this.__addimage__.isArrayBufferView(r)){var s,o=CA(r,{checkCrc:!0}),d=o.width,c=o.height,h=o.channels,f=o.palette,m=o.depth;s=f&&h===1?(function(M){for(var G=M.width,U=M.height,_=M.data,N=M.palette,te=M.depth,ie=!1,re=[],q=[],J=void 0,ce=!1,_e=0,xe=0;xe<N.length;xe++){var Z=px(N[xe],4),D=Z[0],H=Z[1],Y=Z[2],ue=Z[3];re.push(D,H,Y),ue!=null&&(ue===0?(_e++,q.length<1&&q.push(xe)):ue<255&&(ce=!0))}if(ce||_e>1){ie=!0,q=void 0;var Ne=G*U;J=new Uint8Array(Ne);for(var Pe=new DataView(_.buffer),Ue=0;Ue<Ne;Ue++){var Re=_m(Pe,Ue,te),Ke=px(N[Re],4)[3];J[Ue]=Ke}}else _e===0&&(q=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:ie?8:void 0,colorBytes:_,alphaBytes:J,needSMask:ie,palette:re,mask:q}})(o):h===2||h===4?(function(M){for(var G=M.data,U=M.width,_=M.height,N=M.channels,te=M.depth,ie=N===2?"DeviceGray":"DeviceRGB",re=N-1,q=U*_,J=re,ce=q*J,_e=1*q,xe=Math.ceil(ce*te/8),Z=Math.ceil(_e*te/8),D=new Uint8Array(xe),H=new Uint8Array(Z),Y=new DataView(G.buffer),ue=new DataView(D.buffer),Ne=new DataView(H.buffer),Pe=!1,Ue=0;Ue<q;Ue++){for(var Re=Ue*N,Ke=0;Ke<J;Ke++)bb(ue,_m(Y,Re+Ke,te),Ue*J+Ke,te);var Je=_m(Y,Re+J,te);Je<(1<<te)-1&&(Pe=!0),bb(Ne,Je,1*Ue,te)}return{colorSpace:ie,colorsPerPixel:re,sMaskBitsPerComponent:Pe?te:void 0,colorBytes:D,alphaBytes:H,needSMask:Pe}})(o):(function(M){var G=M.data,U=M.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:U,colorsPerPixel:U==="DeviceGray"?1:3,colorBytes:G instanceof Uint16Array?(function(_){for(var N=_.length,te=new Uint8Array(2*N),ie=new DataView(te.buffer,te.byteOffset,te.byteLength),re=0;re<N;re++)ie.setUint16(2*re,_[re],!1);return te})(G):G,needSMask:!1}})(o);var b,A,v,E=s,x=E.colorSpace,k=E.colorsPerPixel,j=E.sMaskBitsPerComponent,$=E.colorBytes,z=E.alphaBytes,B=E.needSMask,F=E.palette,I=E.mask,X=null;return n!==jn.API.image_compression.NONE&&typeof Wm=="function"?(X=(function(M){var G;switch(M){case jn.API.image_compression.FAST:G=11;break;case jn.API.image_compression.MEDIUM:G=13;break;case jn.API.image_compression.SLOW:G=14;break;default:G=12}return G})(n),b=this.decode.FLATE_DECODE,A="/Predictor ".concat(X," /Colors ").concat(k," /BitsPerComponent ").concat(m," /Columns ").concat(d),r=pb($,Math.ceil(d*k*m/8),k,m,n),B&&(v=pb(z,Math.ceil(d*j/8),1,j,n))):(b=void 0,A=void 0,r=$,B&&(v=z)),(this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r))&&(r=this.__addimage__.arrayBufferToBinaryString(r)),(v&&this.__addimage__.isArrayBuffer(v)||this.__addimage__.isArrayBufferView(v))&&(v=this.__addimage__.arrayBufferToBinaryString(v)),{alias:t,data:r,index:e,filter:b,decodeParameters:A,transparency:I,palette:F,sMask:v,predictor:X,width:d,height:c,bitsPerComponent:m,sMaskBitsPerComponent:j,colorSpace:x}}},(function(r){r.processGIF89A=function(e,t,n,s){var o=new $A(e),d=o.width,c=o.height,h=[];o.decodeAndBlitFrameRGBA(0,h);var f={data:h,width:d,height:c},m=new km(100).encode(f,100);return r.processJPEG.call(this,m,t,n,s)},r.processGIF87A=r.processGIF89A})(jn.API),Kc.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var r=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(r);for(var e=0;e<r;e++){var t=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:s,green:n,blue:t,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Kc.prototype.parseBGR=function(){this.pos=this.offset;try{var r="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[r]()}catch(t){Ys.log("bit decode error:"+t)}},Kc.prototype.bit1=function(){var r,e=Math.ceil(this.width/8),t=e%4;for(r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<e;s++)for(var o=this.datav.getUint8(this.pos++,!0),d=n*this.width*4+8*s*4,c=0;c<8&&8*s+c<this.width;c++){var h=this.palette[o>>7-c&1];this.data[d+4*c]=h.blue,this.data[d+4*c+1]=h.green,this.data[d+4*c+2]=h.red,this.data[d+4*c+3]=255}t!==0&&(this.pos+=4-t)}},Kc.prototype.bit4=function(){for(var r=Math.ceil(this.width/2),e=r%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,s=0;s<r;s++){var o=this.datav.getUint8(this.pos++,!0),d=n*this.width*4+2*s*4,c=o>>4,h=15&o,f=this.palette[c];if(this.data[d]=f.blue,this.data[d+1]=f.green,this.data[d+2]=f.red,this.data[d+3]=255,2*s+1>=this.width)break;f=this.palette[h],this.data[d+4]=f.blue,this.data[d+4+1]=f.green,this.data[d+4+2]=f.red,this.data[d+4+3]=255}e!==0&&(this.pos+=4-e)}},Kc.prototype.bit8=function(){for(var r=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*n;if(s<this.palette.length){var d=this.palette[s];this.data[o]=d.red,this.data[o+1]=d.green,this.data[o+2]=d.blue,this.data[o+3]=255}else this.data[o]=255,this.data[o+1]=255,this.data[o+2]=255,this.data[o+3]=255}r!==0&&(this.pos+=4-r)}},Kc.prototype.bit15=function(){for(var r=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var d=(o&e)/e*255|0,c=(o>>5&e)/e*255|0,h=(o>>10&e)/e*255|0,f=o>>15?255:0,m=n*this.width*4+4*s;this.data[m]=h,this.data[m+1]=c,this.data[m+2]=d,this.data[m+3]=f}this.pos+=r}},Kc.prototype.bit16=function(){for(var r=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,o=0;o<this.width;o++){var d=this.datav.getUint16(this.pos,!0);this.pos+=2;var c=(d&e)/e*255|0,h=(d>>5&t)/t*255|0,f=(d>>11)/e*255|0,m=s*this.width*4+4*o;this.data[m]=f,this.data[m+1]=h,this.data[m+2]=c,this.data[m+3]=255}this.pos+=r}},Kc.prototype.bit24=function(){for(var r=this.height-1;r>=0;r--){for(var e=this.bottom_up?r:this.height-1-r,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),d=e*this.width*4+4*t;this.data[d]=o,this.data[d+1]=s,this.data[d+2]=n,this.data[d+3]=255}this.pos+=this.width%4}},Kc.prototype.bit32=function(){for(var r=this.height-1;r>=0;r--)for(var e=this.bottom_up?r:this.height-1-r,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),d=this.datav.getUint8(this.pos++,!0),c=e*this.width*4+4*t;this.data[c]=o,this.data[c+1]=s,this.data[c+2]=n,this.data[c+3]=d}},Kc.prototype.getData=function(){return this.data},(function(r){r.processBMP=function(e,t,n,s){var o=new Kc(e,!1),d=o.width,c=o.height,h={data:o.getData(),width:d,height:c},f=new km(100).encode(h,100);return r.processJPEG.call(this,f,t,n,s)}})(jn.API),wb.prototype.getData=function(){return this.data},(function(r){r.processWEBP=function(e,t,n,s){var o=new wb(e),d=o.width,c=o.height,h={data:o.getData(),width:d,height:c},f=new km(100).encode(h,100);return r.processJPEG.call(this,f,t,n,s)}})(jn.API),jn.API.processRGBA=function(r,e,t){for(var n=r.data,s=n.length,o=new Uint8Array(s/4*3),d=new Uint8Array(s/4),c=0,h=0,f=0;f<s;f+=4){var m=n[f],b=n[f+1],A=n[f+2],v=n[f+3];o[c++]=m,o[c++]=b,o[c++]=A,d[h++]=v}var E=this.__addimage__.arrayBufferToBinaryString(o);return{alpha:this.__addimage__.arrayBufferToBinaryString(d),data:E,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:r.width,height:r.height}},jn.API.setLanguage=function(r){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[r]!==void 0&&(this.internal.languageSettings.languageCode=r,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Jh=jn.API,jg=Jh.getCharWidthsArray=function(r,e){var t,n,s=(e=e||{}).font||this.internal.getFont(),o=e.fontSize||this.internal.getFontSize(),d=e.charSpace||this.internal.getCharSpace(),c=e.widths?e.widths:s.metadata.Unicode.widths,h=c.fof?c.fof:1,f=e.kerning?e.kerning:s.metadata.Unicode.kerning,m=f.fof?f.fof:1,b=e.doKerning!==!1,A=0,v=r.length,E=0,x=c[0]||h,k=[];for(t=0;t<v;t++)n=r.charCodeAt(t),typeof s.metadata.widthOfString=="function"?k.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(n))+d*(1e3/o)||0)/1e3):(A=b&&Rs(f[n])==="object"&&!isNaN(parseInt(f[n][E],10))?f[n][E]/m:0,k.push((c[n]||x)/h+A)),E=n;return k},ub=Jh.getStringUnitWidth=function(r,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),s=e.charSpace||this.internal.getCharSpace();return Jh.processArabic&&(r=Jh.processArabic(r)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(r,t,s)/t:jg.apply(this,arguments).reduce(function(o,d){return o+d},0)},hb=function(r,e,t,n){for(var s=[],o=0,d=r.length,c=0;o!==d&&c+e[o]<t;)c+=e[o],o++;s.push(r.slice(0,o));var h=o;for(c=0;o!==d;)c+e[o]>n&&(s.push(r.slice(h,o)),c=0,h=o),c+=e[o],o++;return h!==o&&s.push(r.slice(h,o)),s},fb=function(r,e,t){t||(t={});var n,s,o,d,c,h,f,m=[],b=[m],A=t.textIndent||0,v=0,E=0,x=r.split(" "),k=jg.apply(this,[" ",t])[0];if(h=t.lineIndent===-1?x[0].length+2:t.lineIndent||0){var j=Array(h).join(" "),$=[];x.map(function(B){(B=B.split(/\s*\n/)).length>1?$=$.concat(B.map(function(F,I){return(I&&F.length?`
`:"")+F})):$.push(B[0])}),x=$,h=ub.apply(this,[j,t])}for(o=0,d=x.length;o<d;o++){var z=0;if(n=x[o],h&&n[0]==`
`&&(n=n.substr(1),z=1),A+v+(E=(s=jg.apply(this,[n,t])).reduce(function(B,F){return B+F},0))>e||z){if(E>e){for(c=hb.apply(this,[n,s,e-(A+v),e]),m.push(c.shift()),m=[c.pop()];c.length;)b.push([c.shift()]);E=s.slice(n.length-(m[0]?m[0].length:0)).reduce(function(B,F){return B+F},0)}else m=[n];b.push(m),A=E+h,v=k}else m.push(n),A+=v+E,v=k}return f=h?function(B,F){return(F?j:"")+B.join(" ")}:function(B){return B.join(" ")},b.map(f)},Jh.splitTextToSize=function(r,e,t){var n,s=(t=t||{}).fontSize||this.internal.getFontSize(),o=(function(m){if(m.widths&&m.kerning)return{widths:m.widths,kerning:m.kerning};var b=this.internal.getFont(m.fontName,m.fontStyle),A="Unicode";return b.metadata[A]?{widths:b.metadata[A].widths||{0:1},kerning:b.metadata[A].kerning||{}}:{font:b.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);n=Array.isArray(r)?r:String(r).split(/\r?\n/);var d=1*this.internal.scaleFactor*e/s;o.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/s:0,o.lineIndent=t.lineIndent;var c,h,f=[];for(c=0,h=n.length;c<h;c++)f=f.concat(fb.apply(this,[n[c],d,o]));return f},(function(r){r.__fontmetrics__=r.__fontmetrics__||{};for(var e="0123456789abcdef",t="klmnopqrstuvwxyz",n={},s={},o=0;o<16;o++)n[t[o]]=e[o],s[e[o]]=t[o];var d=function(A){return"0x"+parseInt(A,10).toString(16)},c=r.__fontmetrics__.compress=function(A){var v,E,x,k,j=["{"];for(var $ in A){if(v=A[$],isNaN(parseInt($,10))?E="'"+$+"'":($=parseInt($,10),E=(E=d($).slice(2)).slice(0,-1)+s[E.slice(-1)]),typeof v=="number")v<0?(x=d(v).slice(3),k="-"):(x=d(v).slice(2),k=""),x=k+x.slice(0,-1)+s[x.slice(-1)];else{if(Rs(v)!=="object")throw new Error("Don't know what to do with value type "+Rs(v)+".");x=c(v)}j.push(E+x)}return j.push("}"),j.join("")},h=r.__fontmetrics__.uncompress=function(A){if(typeof A!="string")throw new Error("Invalid argument passed to uncompress.");for(var v,E,x,k,j={},$=1,z=j,B=[],F="",I="",X=A.length-1,M=1;M<X;M+=1)(k=A[M])=="'"?v?(x=v.join(""),v=void 0):v=[]:v?v.push(k):k=="{"?(B.push([z,x]),z={},x=void 0):k=="}"?((E=B.pop())[0][E[1]]=z,x=void 0,z=E[0]):k=="-"?$=-1:x===void 0?n.hasOwnProperty(k)?(F+=n[k],x=parseInt(F,16)*$,$=1,F=""):F+=k:n.hasOwnProperty(k)?(I+=n[k],z[x]=parseInt(I,16)*$,$=1,x=void 0,I=""):I+=k;return j},f={codePages:["WinAnsiEncoding"],WinAnsiEncoding:h("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},m={Unicode:{Courier:f,"Courier-Bold":f,"Courier-BoldOblique":f,"Courier-Oblique":f,Helvetica:f,"Helvetica-Bold":f,"Helvetica-BoldOblique":f,"Helvetica-Oblique":f,"Times-Roman":f,"Times-Bold":f,"Times-BoldItalic":f,"Times-Italic":f}},b={Unicode:{"Courier-Oblique":h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":h("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":h("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":h("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:h("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:h("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":h("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:h("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":h("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":h("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":h("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};r.events.push(["addFont",function(A){var v=A.font,E=b.Unicode[v.postScriptName];E&&(v.metadata.Unicode={},v.metadata.Unicode.widths=E.widths,v.metadata.Unicode.kerning=E.kerning);var x=m.Unicode[v.postScriptName];x&&(v.metadata.Unicode.encoding=x,v.encoding=x.codePages[0])}])})(jn.API),(function(r){var e=function(t){for(var n=t.length,s=new Uint8Array(n),o=0;o<n;o++)s[o]=t.charCodeAt(o);return s};r.API.events.push(["addFont",function(t){var n=void 0,s=t.font,o=t.instance;if(!s.isStandardFont){if(o===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(n=o.existsFileInVFS(s.postScriptName)===!1?o.loadFile(s.postScriptName):o.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(d,c){c=/^\x00\x01\x00\x00/.test(c)?e(c):e(Fg(c)),d.metadata=r.API.TTFFont.open(c),d.metadata.Unicode=d.metadata.Unicode||{encoding:{},kerning:{},widths:[]},d.metadata.glyIdsUsed=[0]})(s,n)}}])})(jn),jn.API.addSvgAsImage=function(r,e,t,n,s,o,d,c){if(isNaN(e)||isNaN(t))throw Ys.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(s))throw Ys.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var h=document.createElement("canvas");h.width=n,h.height=s;var f=h.getContext("2d");f.fillStyle="#fff",f.fillRect(0,0,h.width,h.height);var m={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},b=this;return(Qn.canvg?Promise.resolve(Qn.canvg):am(()=>import("./index.es-D7M5FcR6.js"),[])).catch(function(A){return Promise.reject(new Error("Could not load canvg: "+A))}).then(function(A){return A.default?A.default:A}).then(function(A){return A.fromString(f,r,m)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(A){return A.render(m)}).then(function(){b.addImage(h.toDataURL("image/jpeg",1),e,t,n,s,d,c)})},jn.API.putTotalPages=function(r){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(r,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(r,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(e,t);return this},jn.API.viewerPreferences=function(r,e){var t;r=r||{},e=e||!1;var n,s,o,d={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},c=Object.keys(d),h=[],f=0,m=0,b=0;function A(E,x){var k,j=!1;for(k=0;k<E.length;k+=1)E[k]===x&&(j=!0);return j}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(d)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,r==="reset"||e===!0){var v=c.length;for(b=0;b<v;b+=1)t[c[b]].value=t[c[b]].defaultValue,t[c[b]].explicitSet=!1}if(Rs(r)==="object"){for(s in r)if(o=r[s],A(c,s)&&o!==void 0){if(t[s].type==="boolean"&&typeof o=="boolean")t[s].value=o;else if(t[s].type==="name"&&A(t[s].valueSet,o))t[s].value=o;else if(t[s].type==="integer"&&Number.isInteger(o))t[s].value=o;else if(t[s].type==="array"){for(f=0;f<o.length;f+=1)if(n=!0,o[f].length===1&&typeof o[f][0]=="number")h.push(String(o[f]-1));else if(o[f].length>1){for(m=0;m<o[f].length;m+=1)typeof o[f][m]!="number"&&(n=!1);n===!0&&h.push([o[f][0]-1,o[f][1]-1].join(" "))}t[s].value="["+h.join(" ")+"]"}else t[s].value=t[s].defaultValue;t[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var E,x=[];for(E in t)t[E].explicitSet===!0&&(t[E].type==="name"?x.push("/"+E+" /"+t[E].value):x.push("/"+E+" "+t[E].value));x.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+x.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},(function(r){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),o=unescape(encodeURIComponent(n)),d=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),c=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),h=unescape(encodeURIComponent("</x:xmpmeta>")),f=o.length+d.length+c.length+s.length+h.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+f+" >>"),this.internal.write("stream"),this.internal.write(s+o+d+c+h),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};r.addMetadata=function(n,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}})(jn.API),(function(r){var e=r.API,t=e.pdfEscape16=function(o,d){for(var c,h=d.metadata.Unicode.widths,f=["","0","00","000","0000"],m=[""],b=0,A=o.length;b<A;++b){if(c=d.metadata.characterToGlyph(o.charCodeAt(b)),d.metadata.glyIdsUsed.push(c),d.metadata.toUnicode[c]=o.charCodeAt(b),h.indexOf(c)==-1&&(h.push(c),h.push([parseInt(d.metadata.widthOfGlyph(c),10)])),c=="0")return m.join("");c=c.toString(16),m.push(f[4-c.length],c)}return m.join("")},n=function(o){var d,c,h,f,m,b,A;for(m=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,h=[],b=0,A=(c=Object.keys(o).sort(function(v,E){return v-E})).length;b<A;b++)d=c[b],h.length>=100&&(m+=`
`+h.length+` beginbfchar
`+h.join(`
`)+`
endbfchar`,h=[]),o[d]!==void 0&&o[d]!==null&&typeof o[d].toString=="function"&&(f=("0000"+o[d].toString(16)).slice(-4),d=("0000"+(+d).toString(16)).slice(-4),h.push("<"+d+"><"+f+">"));return h.length&&(m+=`
`+h.length+` beginbfchar
`+h.join(`
`)+`
endbfchar
`),m+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(o){(function(d){var c=d.font,h=d.out,f=d.newObject,m=d.putStream;if(c.metadata instanceof r.API.TTFFont&&c.encoding==="Identity-H"){for(var b=c.metadata.Unicode.widths,A=c.metadata.subset.encode(c.metadata.glyIdsUsed,1),v="",E=0;E<A.length;E++)v+=String.fromCharCode(A[E]);var x=f();m({data:v,addLength1:!0,objectId:x}),h("endobj");var k=f();m({data:n(c.metadata.toUnicode),addLength1:!0,objectId:k}),h("endobj");var j=f();h("<<"),h("/Type /FontDescriptor"),h("/FontName /"+nf(c.fontName)),h("/FontFile2 "+x+" 0 R"),h("/FontBBox "+r.API.PDFObject.convert(c.metadata.bbox)),h("/Flags "+c.metadata.flags),h("/StemV "+c.metadata.stemV),h("/ItalicAngle "+c.metadata.italicAngle),h("/Ascent "+c.metadata.ascender),h("/Descent "+c.metadata.decender),h("/CapHeight "+c.metadata.capHeight),h(">>"),h("endobj");var $=f();h("<<"),h("/Type /Font"),h("/BaseFont /"+nf(c.fontName)),h("/FontDescriptor "+j+" 0 R"),h("/W "+r.API.PDFObject.convert(b)),h("/CIDToGIDMap /Identity"),h("/DW 1000"),h("/Subtype /CIDFontType2"),h("/CIDSystemInfo"),h("<<"),h("/Supplement 0"),h("/Registry (Adobe)"),h("/Ordering ("+c.encoding+")"),h(">>"),h(">>"),h("endobj"),c.objectNumber=f(),h("<<"),h("/Type /Font"),h("/Subtype /Type0"),h("/ToUnicode "+k+" 0 R"),h("/BaseFont /"+nf(c.fontName)),h("/Encoding /"+c.encoding),h("/DescendantFonts ["+$+" 0 R]"),h(">>"),h("endobj"),c.isAlreadyPutted=!0}})(o)}]),e.events.push(["putFont",function(o){(function(d){var c=d.font,h=d.out,f=d.newObject,m=d.putStream;if(c.metadata instanceof r.API.TTFFont&&c.encoding==="WinAnsiEncoding"){for(var b=c.metadata.rawData,A="",v=0;v<b.length;v++)A+=String.fromCharCode(b[v]);var E=f();m({data:A,addLength1:!0,objectId:E}),h("endobj");var x=f();m({data:n(c.metadata.toUnicode),addLength1:!0,objectId:x}),h("endobj");var k=f();h("<<"),h("/Descent "+c.metadata.decender),h("/CapHeight "+c.metadata.capHeight),h("/StemV "+c.metadata.stemV),h("/Type /FontDescriptor"),h("/FontFile2 "+E+" 0 R"),h("/Flags 96"),h("/FontBBox "+r.API.PDFObject.convert(c.metadata.bbox)),h("/FontName /"+nf(c.fontName)),h("/ItalicAngle "+c.metadata.italicAngle),h("/Ascent "+c.metadata.ascender),h(">>"),h("endobj"),c.objectNumber=f();for(var j=0;j<c.metadata.hmtx.widths.length;j++)c.metadata.hmtx.widths[j]=parseInt(c.metadata.hmtx.widths[j]*(1e3/c.metadata.head.unitsPerEm));h("<</Subtype/TrueType/Type/Font/ToUnicode "+x+" 0 R/BaseFont/"+nf(c.fontName)+"/FontDescriptor "+k+" 0 R/Encoding/"+c.encoding+" /FirstChar 29 /LastChar 255 /Widths "+r.API.PDFObject.convert(c.metadata.hmtx.widths)+">>"),h("endobj"),c.isAlreadyPutted=!0}})(o)}]);var s=function(o){var d,c=o.text||"",h=o.x,f=o.y,m=o.options||{},b=o.mutex||{},A=b.pdfEscape,v=b.activeFontKey,E=b.fonts,x=v,k="",j=0,$="",z=E[x].encoding;if(E[x].encoding!=="Identity-H")return{text:c,x:h,y:f,options:m,mutex:b};for($=c,x=v,Array.isArray(c)&&($=c[0]),j=0;j<$.length;j+=1)E[x].metadata.hasOwnProperty("cmap")&&(d=E[x].metadata.cmap.unicode.codeMap[$[j].charCodeAt(0)]),d||$[j].charCodeAt(0)<256&&E[x].metadata.hasOwnProperty("Unicode")?k+=$[j]:k+="";var B="";return parseInt(x.slice(1))<14||z==="WinAnsiEncoding"?B=A(k,x).split("").map(function(F){return F.charCodeAt(0).toString(16)}).join(""):z==="Identity-H"&&(B=t(k,E[x])),b.isHex=!0,{text:B,x:h,y:f,options:m,mutex:b}};e.events.push(["postProcessText",function(o){var d=o.text||"",c=[],h={text:d,x:o.x,y:o.y,options:o.options,mutex:o.mutex};if(Array.isArray(d)){var f=0;for(f=0;f<d.length;f+=1)Array.isArray(d[f])&&d[f].length===3?c.push([s(Object.assign({},h,{text:d[f][0]})).text,d[f][1],d[f][2]]):c.push(s(Object.assign({},h,{text:d[f]})).text);o.text=c}else o.text=s(Object.assign({},h,{text:d})).text}])})(jn),(function(r){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};r.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},r.addFileToVFS=function(t,n){return e.call(this),this.internal.vFS[t]=n,this},r.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}})(jn.API),(function(r){r.__bidiEngine__=r.prototype.__bidiEngine__=function(n){var s,o,d,c,h,f,m,b=e,A=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],v=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],E={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},x={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},k=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],j=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),$=!1,z=0;this.__bidiEngine__={};var B=function(_){var N=_.charCodeAt(),te=N>>8,ie=x[te];return ie!==void 0?b[256*ie+(255&N)]:te===252||te===253?"AL":j.test(te)?"L":te===8?"R":"N"},F=function(_){for(var N,te=0;te<_.length;te++){if((N=B(_.charAt(te)))==="L")return!1;if(N==="R")return!0}return!1},I=function(_,N,te,ie){var re,q,J,ce,_e=N[ie];switch(_e){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":$=!1;break;case"N":case"AN":break;case"EN":$&&(_e="AN");break;case"AL":$=!0,_e="R";break;case"WS":case"BN":_e="N";break;case"CS":ie<1||ie+1>=N.length||(re=te[ie-1])!=="EN"&&re!=="AN"||(q=N[ie+1])!=="EN"&&q!=="AN"?_e="N":$&&(q="AN"),_e=q===re?q:"N";break;case"ES":_e=(re=ie>0?te[ie-1]:"B")==="EN"&&ie+1<N.length&&N[ie+1]==="EN"?"EN":"N";break;case"ET":if(ie>0&&te[ie-1]==="EN"){_e="EN";break}if($){_e="N";break}for(J=ie+1,ce=N.length;J<ce&&N[J]==="ET";)J++;_e=J<ce&&N[J]==="EN"?"EN":"N";break;case"NSM":if(d&&!c){for(ce=N.length,J=ie+1;J<ce&&N[J]==="NSM";)J++;if(J<ce){var xe=_[ie],Z=xe>=1425&&xe<=2303||xe===64286;if(re=N[J],Z&&(re==="R"||re==="AL")){_e="R";break}}}_e=ie<1||(re=N[ie-1])==="B"?"N":te[ie-1];break;case"B":$=!1,s=!0,_e=z;break;case"S":o=!0,_e="N"}return _e},X=function(_,N,te){var ie=_.split("");return te&&M(ie,te,{hiLevel:z}),ie.reverse(),N&&N.reverse(),ie.join("")},M=function(_,N,te){var ie,re,q,J,ce,_e=-1,xe=_.length,Z=0,D=[],H=z?v:A,Y=[];for($=!1,s=!1,o=!1,re=0;re<xe;re++)Y[re]=B(_[re]);for(q=0;q<xe;q++){if(ce=Z,D[q]=I(_,Y,D,q),ie=240&(Z=H[ce][E[D[q]]]),Z&=15,N[q]=J=H[Z][5],ie>0)if(ie===16){for(re=_e;re<q;re++)N[re]=1;_e=-1}else _e=-1;if(H[Z][6])_e===-1&&(_e=q);else if(_e>-1){for(re=_e;re<q;re++)N[re]=J;_e=-1}Y[q]==="B"&&(N[q]=0),te.hiLevel|=J}o&&(function(ue,Ne,Pe){for(var Ue=0;Ue<Pe;Ue++)if(ue[Ue]==="S"){Ne[Ue]=z;for(var Re=Ue-1;Re>=0&&ue[Re]==="WS";Re--)Ne[Re]=z}})(Y,N,xe)},G=function(_,N,te,ie,re){if(!(re.hiLevel<_)){if(_===1&&z===1&&!s)return N.reverse(),void(te&&te.reverse());for(var q,J,ce,_e,xe=N.length,Z=0;Z<xe;){if(ie[Z]>=_){for(ce=Z+1;ce<xe&&ie[ce]>=_;)ce++;for(_e=Z,J=ce-1;_e<J;_e++,J--)q=N[_e],N[_e]=N[J],N[J]=q,te&&(q=te[_e],te[_e]=te[J],te[J]=q);Z=ce}Z++}}},U=function(_,N,te){var ie=_.split(""),re={hiLevel:z};return te||(te=[]),M(ie,te,re),(function(q,J,ce){if(ce.hiLevel!==0&&m)for(var _e,xe=0;xe<q.length;xe++)J[xe]===1&&(_e=k.indexOf(q[xe]))>=0&&(q[xe]=k[_e+1])})(ie,te,re),G(2,ie,N,te,re),G(1,ie,N,te,re),ie.join("")};return this.__bidiEngine__.doBidiReorder=function(_,N,te){if((function(re,q){if(q)for(var J=0;J<re.length;J++)q[J]=J;c===void 0&&(c=F(re)),f===void 0&&(f=F(re))})(_,N),d||!h||f)if(d&&h&&c^f)z=c?1:0,_=X(_,N,te);else if(!d&&h&&f)z=c?1:0,_=U(_,N,te),_=X(_,N);else if(!d||c||h||f){if(d&&!h&&c^f)_=X(_,N),c?(z=0,_=U(_,N,te)):(z=1,_=U(_,N,te),_=X(_,N));else if(d&&c&&!h&&f)z=1,_=U(_,N,te),_=X(_,N);else if(!d&&!h&&c^f){var ie=m;c?(z=1,_=U(_,N,te),z=0,m=!1,_=U(_,N,te),m=ie):(z=0,_=U(_,N,te),_=X(_,N),z=1,m=!1,_=U(_,N,te),m=ie,_=X(_,N))}}else z=0,_=U(_,N,te);else z=c?1:0,_=U(_,N,te);return _},this.__bidiEngine__.setOptions=function(_){_&&(d=_.isInputVisual,h=_.isOutputVisual,c=_.isInputRtl,f=_.isOutputRtl,m=_.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new r.__bidiEngine__({isInputVisual:!0});r.API.events.push(["postProcessText",function(n){var s=n.text;n.x,n.y;var o=n.options||{};n.mutex,o.lang;var d=[];if(o.isInputVisual=typeof o.isInputVisual!="boolean"||o.isInputVisual,t.setOptions(o),Object.prototype.toString.call(s)==="[object Array]"){var c=0;for(d=[],c=0;c<s.length;c+=1)Object.prototype.toString.call(s[c])==="[object Array]"?d.push([t.doBidiReorder(s[c][0]),s[c][1],s[c][2]]):d.push([t.doBidiReorder(s[c])]);n.text=d}else n.text=t.doBidiReorder(s);t.setOptions({isInputVisual:!0})}])})(jn),jn.API.TTFFont=(function(){function r(e){var t;if(this.rawData=e,t=this.contents=new Lu(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new o3(this),this.registerTTF()}return r.open=function(e){return new r(e)},r.prototype.parse=function(){return this.directory=new GA(this.contents),this.head=new XA(this),this.name=new e3(this),this.cmap=new G2(this),this.toUnicode={},this.hhea=new KA(this),this.maxp=new t3(this),this.hmtx=new n3(this),this.post=new JA(this),this.os2=new ZA(this),this.loca=new a3(this),this.glyf=new i3(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},r.prototype.registerTTF=function(){var e,t,n,s,o;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var d,c,h,f;for(f=[],d=0,c=(h=this.bbox).length;d<c;d++)e=h[d],f.push(Math.round(e*this.scaleFactor));return f}).call(this),this.stemV=0,this.post.exists?(n=255&(s=this.post.italic_angle),32768&(t=s>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(o=this.familyClass)===1||o===2||o===3||o===4||o===5||o===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},r.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},r.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},r.prototype.widthOfString=function(e,t,n){var s,o,d,c;for(d=0,o=0,c=(e=""+e).length;0<=c?o<c:o>c;o=0<=c?++o:--o)s=e.charCodeAt(o),d+=this.widthOfGlyph(this.characterToGlyph(s))+n*(1e3/t)||0;return d*(t/1e3)},r.prototype.lineHeight=function(e,t){var n;return t==null&&(t=!1),n=t?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},r})();var ed,Lu=(function(){function r(e){this.data=e??[],this.pos=0,this.length=this.data.length}return r.prototype.readByte=function(){return this.data[this.pos++]},r.prototype.writeByte=function(e){return this.data[this.pos++]=e},r.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},r.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},r.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},r.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},r.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},r.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},r.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},r.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},r.prototype.readString=function(e){var t,n;for(n=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)n[t]=String.fromCharCode(this.readByte());return n.join("")},r.prototype.writeString=function(e){var t,n,s;for(s=[],t=0,n=e.length;0<=n?t<n:t>n;t=0<=n?++t:--t)s.push(this.writeByte(e.charCodeAt(t)));return s},r.prototype.readShort=function(){return this.readInt16()},r.prototype.writeShort=function(e){return this.writeInt16(e)},r.prototype.readLongLong=function(){var e,t,n,s,o,d,c,h;return e=this.readByte(),t=this.readByte(),n=this.readByte(),s=this.readByte(),o=this.readByte(),d=this.readByte(),c=this.readByte(),h=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^n)+4294967296*(255^s)+16777216*(255^o)+65536*(255^d)+256*(255^c)+(255^h)+1):72057594037927940*e+281474976710656*t+1099511627776*n+4294967296*s+16777216*o+65536*d+256*c+h},r.prototype.writeLongLong=function(e){var t,n;return t=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},r.prototype.readInt=function(){return this.readInt32()},r.prototype.writeInt=function(e){return this.writeInt32(e)},r.prototype.read=function(e){var t,n;for(t=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)t.push(this.readByte());return t},r.prototype.write=function(e){var t,n,s,o;for(o=[],n=0,s=e.length;n<s;n++)t=e[n],o.push(this.writeByte(t));return o},r})(),GA=(function(){var r;function e(t){var n,s,o;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},s=0,o=this.tableCount;0<=o?s<o:s>o;s=0<=o?++s:--s)n={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(t){var n,s,o,d,c,h,f,m,b,A,v,E,x;for(x in v=Object.keys(t).length,h=Math.log(2),b=16*Math.floor(Math.log(v)/h),d=Math.floor(b/h),m=16*v-b,(s=new Lu).writeInt(this.scalarType),s.writeShort(v),s.writeShort(b),s.writeShort(d),s.writeShort(m),o=16*v,f=s.pos+o,c=null,E=[],t)for(A=t[x],s.writeString(x),s.writeInt(r(A)),s.writeInt(f),s.writeInt(A.length),E=E.concat(A),x==="head"&&(c=f),f+=A.length;f%4;)E.push(0),f++;return s.write(E),n=2981146554-r(s.data),s.pos=c+8,s.writeUInt32(n),s.data},r=function(t){var n,s,o,d;for(t=Y2.call(t);t.length%4;)t.push(0);for(o=new Lu(t),s=0,n=0,d=t.length;n<d;n=n+=4)s+=o.readUInt32();return 4294967295&s},e})(),YA={}.hasOwnProperty,jd=function(r,e){for(var t in e)YA.call(e,t)&&(r[t]=e[t]);function n(){this.constructor=r}return n.prototype=e.prototype,r.prototype=new n,r.__super__=e.prototype,r};ed=(function(){function r(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return r.prototype.parse=function(){},r.prototype.encode=function(){},r.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},r})();var XA=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return jd(r,ed),r.prototype.tag="head",r.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},r.prototype.encode=function(e){var t;return(t=new Lu).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},r})(),Sb=(function(){function r(e,t){var n,s,o,d,c,h,f,m,b,A,v,E,x,k,j,$,z;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),b=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(h=0;h<256;++h)this.codeMap[h]=e.readByte();break;case 4:for(v=e.readUInt16(),A=v/2,e.pos+=6,o=(function(){var B,F;for(F=[],h=B=0;0<=A?B<A:B>A;h=0<=A?++B:--B)F.push(e.readUInt16());return F})(),e.pos+=2,x=(function(){var B,F;for(F=[],h=B=0;0<=A?B<A:B>A;h=0<=A?++B:--B)F.push(e.readUInt16());return F})(),f=(function(){var B,F;for(F=[],h=B=0;0<=A?B<A:B>A;h=0<=A?++B:--B)F.push(e.readUInt16());return F})(),m=(function(){var B,F;for(F=[],h=B=0;0<=A?B<A:B>A;h=0<=A?++B:--B)F.push(e.readUInt16());return F})(),s=(this.length-e.pos+this.offset)/2,c=(function(){var B,F;for(F=[],h=B=0;0<=s?B<s:B>s;h=0<=s?++B:--B)F.push(e.readUInt16());return F})(),h=j=0,z=o.length;j<z;h=++j)for(k=o[h],n=$=E=x[h];E<=k?$<=k:$>=k;n=E<=k?++$:--$)m[h]===0?d=n+f[h]:(d=c[m[h]/2+(n-E)-(A-h)]||0)!==0&&(d+=f[h]),this.codeMap[n]=65535&d}e.pos=b}return r.encode=function(e,t){var n,s,o,d,c,h,f,m,b,A,v,E,x,k,j,$,z,B,F,I,X,M,G,U,_,N,te,ie,re,q,J,ce,_e,xe,Z,D,H,Y,ue,Ne,Pe,Ue,Re,Ke,Je,st;switch(ie=new Lu,d=Object.keys(e).sort(function(yt,Nt){return yt-Nt}),t){case"macroman":for(x=0,k=(function(){var yt=[];for(E=0;E<256;++E)yt.push(0);return yt})(),$={0:0},o={},re=0,_e=d.length;re<_e;re++)$[Re=e[s=d[re]]]==null&&($[Re]=++x),o[s]={old:e[s],new:$[e[s]]},k[s]=$[e[s]];return ie.writeUInt16(1),ie.writeUInt16(0),ie.writeUInt32(12),ie.writeUInt16(0),ie.writeUInt16(262),ie.writeUInt16(0),ie.write(k),{charMap:o,subtable:ie.data,maxGlyphID:x+1};case"unicode":for(N=[],b=[],z=0,$={},n={},j=f=null,q=0,xe=d.length;q<xe;q++)$[F=e[s=d[q]]]==null&&($[F]=++z),n[s]={old:F,new:$[F]},c=$[F]-s,j!=null&&c===f||(j&&b.push(j),N.push(s),f=c),j=s;for(j&&b.push(j),b.push(65535),N.push(65535),U=2*(G=N.length),M=2*Math.pow(Math.log(G)/Math.LN2,2),A=Math.log(M/2)/Math.LN2,X=2*G-M,h=[],I=[],v=[],E=J=0,Z=N.length;J<Z;E=++J){if(_=N[E],m=b[E],_===65535){h.push(0),I.push(0);break}if(_-(te=n[_].new)>=32768)for(h.push(0),I.push(2*(v.length+G-E)),s=ce=_;_<=m?ce<=m:ce>=m;s=_<=m?++ce:--ce)v.push(n[s].new);else h.push(te-_),I.push(0)}for(ie.writeUInt16(3),ie.writeUInt16(1),ie.writeUInt32(12),ie.writeUInt16(4),ie.writeUInt16(16+8*G+2*v.length),ie.writeUInt16(0),ie.writeUInt16(U),ie.writeUInt16(M),ie.writeUInt16(A),ie.writeUInt16(X),Pe=0,D=b.length;Pe<D;Pe++)s=b[Pe],ie.writeUInt16(s);for(ie.writeUInt16(0),Ue=0,H=N.length;Ue<H;Ue++)s=N[Ue],ie.writeUInt16(s);for(Ke=0,Y=h.length;Ke<Y;Ke++)c=h[Ke],ie.writeUInt16(c);for(Je=0,ue=I.length;Je<ue;Je++)B=I[Je],ie.writeUInt16(B);for(st=0,Ne=v.length;st<Ne;st++)x=v[st],ie.writeUInt16(x);return{charMap:n,subtable:ie.data,maxGlyphID:z+1}}},r})(),G2=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return jd(r,ed),r.prototype.tag="cmap",r.prototype.parse=function(e){var t,n,s;for(e.pos=this.offset,this.version=e.readUInt16(),s=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=s?n<s:n>s;n=0<=s?++n:--n)t=new Sb(e,this.offset),this.tables.push(t),t.isUnicode&&this.unicode==null&&(this.unicode=t);return!0},r.encode=function(e,t){var n,s;return t==null&&(t="macroman"),n=Sb.encode(e,t),(s=new Lu).writeUInt16(0),s.writeUInt16(1),n.table=s.data.concat(n.subtable),n},r})(),KA=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return jd(r,ed),r.prototype.tag="hhea",r.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},r})(),ZA=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return jd(r,ed),r.prototype.tag="OS/2",r.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var t,n;for(n=[],t=0;t<10;++t)n.push(e.readByte());return n})(),this.charRange=(function(){var t,n;for(n=[],t=0;t<4;++t)n.push(e.readInt());return n})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var t,n;for(n=[],t=0;t<2;t=++t)n.push(e.readInt());return n})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},r})(),JA=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return jd(r,ed),r.prototype.tag="post",r.prototype.parse=function(e){var t,n,s;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var o;for(n=e.readUInt16(),this.glyphNameIndex=[],o=0;0<=n?o<n:o>n;o=0<=n?++o:--o)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],s=[];e.pos<this.offset+this.length;)t=e.readByte(),s.push(this.names.push(e.readString(t)));return s;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=(function(){var d,c,h;for(h=[],o=d=0,c=this.file.maxp.numGlyphs;0<=c?d<c:d>c;o=0<=c?++d:--d)h.push(e.readUInt32());return h}).call(this)}},r})(),QA=function(r,e){this.raw=r,this.length=r.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},e3=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return jd(r,ed),r.prototype.tag="name",r.prototype.parse=function(e){var t,n,s,o,d,c,h,f,m,b,A;for(e.pos=this.offset,e.readShort(),t=e.readShort(),c=e.readShort(),n=[],o=0;0<=t?o<t:o>t;o=0<=t?++o:--o)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+c+e.readShort()});for(h={},o=m=0,b=n.length;m<b;o=++m)s=n[o],e.pos=s.offset,f=e.readString(s.length),d=new QA(f,s),h[A=s.nameID]==null&&(h[A]=[]),h[s.nameID].push(d);this.strings=h,this.copyright=h[0],this.fontFamily=h[1],this.fontSubfamily=h[2],this.uniqueSubfamily=h[3],this.fontName=h[4],this.version=h[5];try{this.postscriptName=h[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=h[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=h[7],this.manufacturer=h[8],this.designer=h[9],this.description=h[10],this.vendorUrl=h[11],this.designerUrl=h[12],this.license=h[13],this.licenseUrl=h[14],this.preferredFamily=h[15],this.preferredSubfamily=h[17],this.compatibleFull=h[18],this.sampleText=h[19]},r})(),t3=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return jd(r,ed),r.prototype.tag="maxp",r.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},r})(),n3=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return jd(r,ed),r.prototype.tag="hmtx",r.prototype.parse=function(e){var t,n,s,o,d,c,h;for(e.pos=this.offset,this.metrics=[],t=0,c=this.file.hhea.numberOfMetrics;0<=c?t<c:t>c;t=0<=c?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var f,m;for(m=[],t=f=0;0<=s?f<s:f>s;t=0<=s?++f:--f)m.push(e.readInt16());return m})(),this.widths=(function(){var f,m,b,A;for(A=[],f=0,m=(b=this.metrics).length;f<m;f++)o=b[f],A.push(o.advance);return A}).call(this),n=this.widths[this.widths.length-1],h=[],t=d=0;0<=s?d<s:d>s;t=0<=s?++d:--d)h.push(this.widths.push(n));return h},r.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},r})(),Y2=[].slice,i3=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return jd(r,ed),r.prototype.tag="glyf",r.prototype.parse=function(){return this.cache={}},r.prototype.glyphFor=function(e){var t,n,s,o,d,c,h,f,m,b;return e in this.cache?this.cache[e]:(o=this.file.loca,t=this.file.contents,n=o.indexOf(e),(s=o.lengthOf(e))===0?this.cache[e]=null:(t.pos=this.offset+n,d=(c=new Lu(t.read(s))).readShort(),f=c.readShort(),b=c.readShort(),h=c.readShort(),m=c.readShort(),this.cache[e]=d===-1?new r3(c,f,b,h,m):new s3(c,d,f,b,h,m),this.cache[e]))},r.prototype.encode=function(e,t,n){var s,o,d,c,h;for(d=[],o=[],c=0,h=t.length;c<h;c++)s=e[t[c]],o.push(d.length),s&&(d=d.concat(s.encode(n)));return o.push(d.length),{table:d,offsets:o}},r})(),s3=(function(){function r(e,t,n,s,o,d){this.raw=e,this.numberOfContours=t,this.xMin=n,this.yMin=s,this.xMax=o,this.yMax=d,this.compound=!1}return r.prototype.encode=function(){return this.raw.data},r})(),r3=(function(){function r(e,t,n,s,o){var d,c;for(this.raw=e,this.xMin=t,this.yMin=n,this.xMax=s,this.yMax=o,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],d=this.raw;c=d.readShort(),this.glyphOffsets.push(d.pos),this.glyphIDs.push(d.readUInt16()),32&c;)d.pos+=1&c?4:2,128&c?d.pos+=8:64&c?d.pos+=4:8&c&&(d.pos+=2)}return r.prototype.encode=function(){var e,t,n;for(t=new Lu(Y2.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)t.pos=this.glyphOffsets[e];return t.data},r})(),a3=(function(){function r(){return r.__super__.constructor.apply(this,arguments)}return jd(r,ed),r.prototype.tag="loca",r.prototype.parse=function(e){var t,n;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=t===0?(function(){var s,o;for(o=[],n=0,s=this.length;n<s;n+=2)o.push(2*e.readUInt16());return o}).call(this):(function(){var s,o;for(o=[],n=0,s=this.length;n<s;n+=4)o.push(e.readUInt32());return o}).call(this)},r.prototype.indexOf=function(e){return this.offsets[e]},r.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},r.prototype.encode=function(e,t){for(var n=new Uint32Array(this.offsets.length),s=0,o=0,d=0;d<n.length;++d)if(n[d]=s,o<t.length&&t[o]==d){++o,n[d]=s;var c=this.offsets[d],h=this.offsets[d+1]-c;h>0&&(s+=h)}for(var f=new Array(4*n.length),m=0;m<n.length;++m)f[4*m+3]=255&n[m],f[4*m+2]=(65280&n[m])>>8,f[4*m+1]=(16711680&n[m])>>16,f[4*m]=(4278190080&n[m])>>24;return f},r})(),o3=(function(){function r(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return r.prototype.generateCmap=function(){var e,t,n,s,o;for(t in s=this.font.cmap.tables[0].codeMap,e={},o=this.subset)n=o[t],e[t]=s[n];return e},r.prototype.glyphsFor=function(e){var t,n,s,o,d,c,h;for(s={},d=0,c=e.length;d<c;d++)s[o=e[d]]=this.font.glyf.glyphFor(o);for(o in t=[],s)(n=s[o])!=null&&n.compound&&t.push.apply(t,n.glyphIDs);if(t.length>0)for(o in h=this.glyphsFor(t))n=h[o],s[o]=n;return s},r.prototype.encode=function(e,t){var n,s,o,d,c,h,f,m,b,A,v,E,x,k,j;for(s in n=G2.encode(this.generateCmap(),"unicode"),d=this.glyphsFor(e),v={0:0},j=n.charMap)v[(h=j[s]).old]=h.new;for(E in A=n.maxGlyphID,d)E in v||(v[E]=A++);return m=(function($){var z,B;for(z in B={},$)B[$[z]]=z;return B})(v),b=Object.keys(m).sort(function($,z){return $-z}),x=(function(){var $,z,B;for(B=[],$=0,z=b.length;$<z;$++)c=b[$],B.push(m[c]);return B})(),o=this.font.glyf.encode(d,x,v),f=this.font.loca.encode(o.offsets,x),k={cmap:this.font.cmap.raw(),glyf:o.table,loca:f,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(k["OS/2"]=this.font.os2.raw()),this.font.directory.encode(k)},r})();jn.API.PDFObject=(function(){var r;function e(){}return r=function(t,n){return(Array(n+1).join("0")+t).slice(-n)},e.convert=function(t){var n,s,o,d;if(Array.isArray(t))return"["+(function(){var c,h,f;for(f=[],c=0,h=t.length;c<h;c++)n=t[c],f.push(e.convert(n));return f})().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t?.isString)return"("+t+")";if(t instanceof Date)return"(D:"+r(t.getUTCFullYear(),4)+r(t.getUTCMonth(),2)+r(t.getUTCDate(),2)+r(t.getUTCHours(),2)+r(t.getUTCMinutes(),2)+r(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(s in o=["<<"],t)d=t[s],o.push("/"+s+" "+e.convert(d));return o.push(">>"),o.join(`
`)}return""+t},e})();const jm=r=>{const e=gy[r];return!e||!e.prefix||e.prefix.length<1?"?":e.prefix[0].substring(0,1).toUpperCase()},Mc=(r,e,t)=>({color:e,size:t}),Ab=(r,e,t)=>{},Sr=(r,e,t,n)=>({color:t,size:n}),Qh=(r,e,t,n)=>{},l3=()=>{const r=new Map,e={top:"#0072B2",bottom:"#56B4E9"},t={top:18,bottom:18},n={top:"#FFFF00",bottom:"#FFFF00"},s={top:18,bottom:18},o={top:"#AA4499",bottom:"#F781BF"},d={top:6,bottom:6},c={top:"#6A3D9A",bottom:"#9467BD"},h={top:18,bottom:18};return r.set("select",{id:"select",name:"Select",toolType:"select",icon:"",shortcut:"S",tooltip:"Select objects or groups",colorReflective:!1,settings:Mc("select","#ff0000",10),layerSettings:new Map([["top",Sr("select","top","#ff0000",10)],["bottom",Sr("select","bottom","#ff0000",10)]])}),r.set("via",{id:"via",name:"Via",toolType:"draw",drawingMode:"via",icon:"",shortcut:"V",tooltip:"Place via connection",colorReflective:!0,settings:Mc("via",Q0,nm.DEFAULT_SIZE),layerSettings:new Map([["top",Sr("via","top",Q0,nm.DEFAULT_SIZE)],["bottom",Sr("via","bottom",Q0,nm.DEFAULT_SIZE)]]),defaultLayer:"top"}),r.set("pad",{id:"pad",name:"Pad",toolType:"draw",drawingMode:"pad",icon:"",shortcut:"P",tooltip:"Place pad connection",colorReflective:!0,settings:Mc("pad",Kw,18),layerSettings:new Map([["top",Sr("pad","top",e.top,t.top)],["bottom",Sr("pad","bottom",e.bottom,t.bottom)]]),defaultLayer:"top"}),r.set("testPoint",{id:"testPoint",name:"Test Point",toolType:"draw",drawingMode:"testPoint",icon:"",shortcut:"Y",tooltip:"Place test point",colorReflective:!0,settings:Mc("testPoint","#FFFF00",18),layerSettings:new Map([["top",Sr("testPoint","top",n.top,s.top)],["bottom",Sr("testPoint","bottom",n.bottom,s.bottom)]]),defaultLayer:"top"}),r.set("trace",{id:"trace",name:"Trace",toolType:"draw",drawingMode:"trace",icon:"",shortcut:"T",tooltip:"Draw copper traces",colorReflective:!0,settings:Mc("trace",Yw,6),layerSettings:new Map([["top",Sr("trace","top",o.top,d.top)],["bottom",Sr("trace","bottom",o.bottom,d.bottom)]]),defaultLayer:"top"}),r.set("component",{id:"component",name:"Component",toolType:"component",icon:"",shortcut:"C",tooltip:"Place component",colorReflective:!0,settings:Mc("component",Xw,py.DEFAULT_SIZE),layerSettings:new Map([["top",Sr("component","top",c.top,h.top)],["bottom",Sr("component","bottom",c.bottom,h.bottom)]]),defaultLayer:"top"}),r.set("componentConnection",{id:"componentConnection",name:"Component Connections",toolType:"componentConnection",icon:"",shortcut:"",tooltip:"Component connection lines",colorReflective:!1,settings:Mc("componentConnection","#E69F00",3),layerSettings:new Map([["top",Sr("componentConnection","top","#E69F00",3)],["bottom",Sr("componentConnection","bottom","#E69F00",3)]])}),r.set("power",{id:"power",name:"Power",toolType:"power",icon:"",shortcut:"B",tooltip:"Place power node",colorReflective:!0,settings:Mc("power",tm,18),layerSettings:new Map([["top",Sr("power","top",tm,18)],["bottom",Sr("power","bottom",tm,18)]]),defaultLayer:"top"}),r.set("ground",{id:"ground",name:"Ground",toolType:"ground",icon:"",shortcut:"G",tooltip:"Place ground symbol",colorReflective:!0,settings:Mc("ground",em,18),layerSettings:new Map([["top",Sr("ground","top",em,18)],["bottom",Sr("ground","bottom",em,18)]]),defaultLayer:"top"}),r.set("erase",{id:"erase",name:"Erase",toolType:"erase",icon:"",shortcut:"E",tooltip:"Erase objects",colorReflective:!1,settings:Mc("erase","#f5a3b3",18),layerSettings:new Map([["top",Sr("erase","top","#f5a3b3",18)],["bottom",Sr("erase","bottom","#f5a3b3",18)]])}),r.set("pan",{id:"pan",name:"Move",toolType:"pan",icon:"",shortcut:"H",tooltip:"Pan the view",colorReflective:!1,settings:Mc("pan","#ff0000",10),layerSettings:new Map([["top",Sr("pan","top","#ff0000",10)],["bottom",Sr("pan","bottom","#ff0000",10)]])}),r.set("magnify",{id:"magnify",name:"Zoom",toolType:"magnify",icon:"+",shortcut:"M",tooltip:"Magnify",colorReflective:!1,settings:Mc("magnify","#ff0000",10),layerSettings:new Map([["top",Sr("magnify","top","#ff0000",10)],["bottom",Sr("magnify","bottom","#ff0000",10)]])}),r},Tb={via:{color:"#2CA02C",size:18},padTop:{color:"#0072B2",size:18},padBottom:{color:"#56B4E9",size:18},testPointTop:{color:"#FFFF00",size:18},testPointBottom:{color:"#FFFF00",size:18},traceTop:{color:"#AA4499",size:6},traceBottom:{color:"#F781BF",size:6},componentTop:{color:"#6A3D9A",size:18},componentBottom:{color:"#9467BD",size:18},power:{color:"#ff0000",size:18},ground:{color:"#000000",size:18}},np={via:"Via",padTop:"Pad (Top)",padBottom:"Pad (Bottom)",testPointTop:"Test Point (Top)",testPointBottom:"Test Point (Bottom)",traceTop:"Trace (Top)",traceBottom:"Trace (Bottom)",componentTop:"Component (Top)",componentBottom:"Component (Bottom)",power:"Power",ground:"Ground"};class c3{instances=new Map;listeners=new Map;initialize(){for(const e of Object.keys(Tb)){const t=Tb[e];this.instances.set(e,{id:e,name:np[e],color:t.color,size:t.size}),this.listeners.set(e,new Set)}}initializeFromProject(e){if(this.initialize(),e?.toolInstances)for(const[t,n]of Object.entries(e.toolInstances))this.instances.has(t)&&this.instances.set(t,n)}get(e){const t=this.instances.get(e);if(!t)throw new Error(`Tool instance ${e} not found`);return t}getColor(e){const t=this.instances.get(e);if(!t)throw new Error(`Tool instance ${e} not found`);const n=np[e];return console.log(`${n}, returning color value=${t.color}`),t.color}getSize(e){const t=this.instances.get(e);if(!t)throw new Error(`Tool instance ${e} not found`);const n=np[e];return console.log(`${n}, returning size value=${t.size}`),t.size}setColor(e,t){const n=this.instances.get(e);if(n){const s=np[e];console.log(`${s}, setting color value=${t}`),n.color=t,this.notifyListeners(e)}}setSize(e,t){const n=this.instances.get(e);if(n){const s=np[e];console.log(`${s}, setting size value=${t}`),n.size=t,this.notifyListeners(e)}}getAll(){const e={};for(const[t,n]of this.instances.entries())e[t]=n;return e}subscribe(e,t){const n=this.listeners.get(e);return n?(n.add(t),()=>{n.delete(t)}):()=>{}}notifyListeners(e){const t=this.listeners.get(e);t&&t.forEach(n=>n())}}const Ln=new c3;Ln.initialize();function Ng(r,e){switch(r){case"via":return"via";case"pad":return e==="bottom"?"padBottom":"padTop";case"testPoint":return e==="bottom"?"testPointBottom":"testPointTop";case"trace":return e==="bottom"?"traceBottom":"traceTop";case"component":return e==="bottom"?"componentBottom":"componentTop";case"power":return"power";case"ground":return"ground";default:throw new Error(`Unknown tool: ${r}`)}}const d3=({visible:r,toolRegistry:e,currentTool:t,drawingMode:n,traceToolLayer:s,padToolLayer:o,testPointToolLayer:d,componentToolLayer:c,updateToolSettings:h,updateToolLayerSettings:f,setBrushSize:m,saveToolSettings:b,saveToolLayerSettings:A,setTopTraceSize:v,setBottomTraceSize:E,setTopPadSize:x,setBottomPadSize:k,setTopTestPointSize:j,setBottomTestPointSize:$,setTopComponentSize:z,setBottomComponentSize:B,setComponentConnectionSize:F,saveDefaultSize:I,onClose:X})=>{const[M,G]=K.useState({}),U=[{id:"via",name:"Via",instanceId:"via"},{id:"pad",name:"Pad",layer:"top",instanceId:"padTop"},{id:"pad",name:"Pad",layer:"bottom",instanceId:"padBottom"},{id:"testPoint",name:"Test Point",layer:"top",instanceId:"testPointTop"},{id:"testPoint",name:"Test Point",layer:"bottom",instanceId:"testPointBottom"},{id:"trace",name:"Trace",layer:"top",instanceId:"traceTop"},{id:"trace",name:"Trace",layer:"bottom",instanceId:"traceBottom"},{id:"component",name:"Component",layer:"top",instanceId:"componentTop"},{id:"component",name:"Component",layer:"bottom",instanceId:"componentBottom"},{id:"componentConnection",name:"Component Connections"},{id:"power",name:"Power",instanceId:"power"},{id:"ground",name:"Ground",instanceId:"ground"},{id:"erase",name:"Erase"}];K.useEffect(()=>{if(r){const te={};for(const ie of U){const re=ie.instanceId||ie.id;if(ie.instanceId)try{const q=Ln.get(ie.instanceId);te[re]=q.size}catch{const q=e.get(ie.id);q&&(te[re]=ie.layer?q.layerSettings.get(ie.layer)?.size??q.settings.size??10:q.settings.size??10)}else{const q=e.get(ie.id);q&&(te[re]=q.settings.size??10)}}G(te)}},[r]);const _=K.useCallback((te,ie,re,q)=>{if(!e.get(te)&&te!=="componentConnection")return;const ce=q||te;G(xe=>({...xe,[ce]:ie})),["trace","pad","testPoint","component"].includes(te)&&re&&q?(Ln.setSize(q,ie),(te==="trace"&&t==="draw"&&n==="trace"||te==="pad"&&t==="draw"&&n==="pad"||te==="testPoint"&&t==="draw"&&n==="testPoint"||te==="component"&&t==="component")&&((te==="trace"?s:te==="pad"?o:te==="testPoint"?d:c)||"top")===re&&m(ie)):q?(Ln.setSize(q,ie),(te==="via"&&t==="draw"&&n==="via"||te==="power"&&t==="power"||te==="ground"&&t==="ground")&&m(ie)):(te==="componentConnection"&&(F(ie),I("componentConnection",ie)),te==="erase"&&t==="erase"&&m(ie))},[e,t,n,s,o,d,c,m,F,I]);if(!r)return null;const N=Array.from({length:50},(te,ie)=>ie+1);return l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:te=>{te.target===te.currentTarget&&X()},children:l.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"16px",width:"fit-content",maxWidth:"400px",maxHeight:"85vh",overflowY:"auto",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:te=>te.stopPropagation(),children:[l.jsx("h3",{style:{margin:"0 0 12px 0",color:"#fff",fontSize:"16px",fontWeight:600},children:"Set Tool Size"}),l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:U.map((te,ie)=>{if(!e.get(te.id)&&te.id!=="componentConnection")return null;const q=te.layer?`${te.name} (${te.layer==="top"?"Top":"Bottom"})`:te.name,J=te.instanceId||te.id,ce=M[J]??10;return l.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"6px 10px",background:"#1f1f24",borderRadius:4},children:[l.jsxs("label",{style:{color:"#f2f2f2",fontSize:"13px",width:"140px",flexShrink:0,marginRight:"8px"},children:[q,":"]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[l.jsx("select",{value:ce,onChange:_e=>{const xe=parseInt(_e.target.value,10);_(te.id,xe,te.layer,te.instanceId)},style:{width:"50px",padding:"4px 6px",background:"#2b2b31",border:"1px solid #3a3a44",borderRadius:4,color:"#f2f2f2",fontSize:"12px",cursor:"pointer"},children:N.map(_e=>l.jsx("option",{value:_e,style:{background:"#2b2b31",color:"#f2f2f2"},children:_e},_e))}),l.jsx("span",{style:{color:"#f2f2f2",fontSize:"12px"},children:"px"})]})]},`${te.id}-${te.layer||"default"}-${ie}`)})}),l.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:l.jsx("button",{onClick:X,style:{padding:"6px 12px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:600},children:"Close"})})]})})},u3=({visible:r,toolRegistry:e,currentTool:t,drawingMode:n,traceToolLayer:s,padToolLayer:o,testPointToolLayer:d,componentToolLayer:c,updateToolSettings:h,updateToolLayerSettings:f,saveToolSettings:m,saveToolLayerSettings:b,setBrushColor:A,setTopTraceColor:v,setBottomTraceColor:E,setTopPadColor:x,setBottomPadColor:k,setTopTestPointColor:j,setBottomTestPointColor:$,setTopComponentColor:z,setBottomComponentColor:B,setComponentConnectionColor:F,saveDefaultColor:I,colorPalette:X,onClose:M})=>{const[G,U]=Ct.useState(null),[_,N]=Ct.useState(0);if(Ct.useEffect(()=>{const J=[];return[{id:"via"},{id:"pad",layer:"top"},{id:"pad",layer:"bottom"},{id:"testPoint",layer:"top"},{id:"testPoint",layer:"bottom"},{id:"trace",layer:"top"},{id:"trace",layer:"bottom"},{id:"component",layer:"top"},{id:"component",layer:"bottom"},{id:"power"},{id:"ground"}].forEach(({id:_e,layer:xe})=>{try{const Z=Ng(_e,xe),D=Ln.subscribe(Z,()=>{N(H=>H+1)});J.push(D)}catch{}}),()=>{J.forEach(_e=>_e())}},[]),!r)return null;const te=["pad","testPoint","trace","component"],ie=[{id:"via",name:"Via"},{id:"pad",name:"Pad",layer:"top"},{id:"pad",name:"Pad",layer:"bottom"},{id:"testPoint",name:"Test Point",layer:"top"},{id:"testPoint",name:"Test Point",layer:"bottom"},{id:"trace",name:"Trace",layer:"top"},{id:"trace",name:"Trace",layer:"bottom"},{id:"component",name:"Component",layer:"top"},{id:"component",name:"Component",layer:"bottom"},{id:"componentConnection",name:"Component Connections"},{id:"power",name:"Power"},{id:"ground",name:"Ground"},{id:"erase",name:"Erase"}],re=(J,ce,_e)=>{if(J==="componentConnection"){F(ce),I("componentConnection",ce),U(null);return}if(J==="erase"){const xe=e.get(J);xe&&(h(J,{...xe.settings,color:ce}),m(J,ce,xe.settings.size)),U(null);return}try{let xe;_e&&te.includes(J)?xe=Ng(J,_e):xe=Ng(J),Ln.setColor(xe,ce),(J==="via"&&t==="draw"&&n==="via"||J==="trace"&&t==="draw"&&n==="trace"||J==="pad"&&t==="draw"&&n==="pad"||J==="testPoint"&&t==="draw"&&n==="testPoint"||J==="component"&&t==="component"||J==="power"&&t==="power"||J==="ground"&&t==="ground")&&(_e&&te.includes(J)?((J==="trace"?s:J==="pad"?o:J==="testPoint"?d:c)||"top")===_e&&A(ce):A(ce))}catch(xe){console.error(`Error updating color for tool ${J}:`,xe);const Z=e.get(J);Z&&(_e&&te.includes(J)?(f(J,_e,{...Z.layerSettings.get(_e),color:ce}),b(J,_e,ce,Z.layerSettings.get(_e)?.size||Z.settings.size)):(h(J,{...Z.settings,color:ce}),m(J,ce,Z.settings.size)))}U(null)},q=(J,ce)=>{let _e;try{const D=Ng(J,ce);_e=Ln.get(D).color}catch{const D=e.get(J);if(!D)return null;_e=D.settings.color??"#000000"}const xe=ce?`${J}-${ce}`:J,Z=G?.toolId===J&&G?.layer===ce;return l.jsxs("div",{style:{position:"relative",display:"inline-block",zIndex:10005},children:[l.jsx("button",{className:"color-swatch-button",onClick:D=>{D.stopPropagation(),U(Z?null:{toolId:J,layer:ce})},style:{width:"40px",height:"24px",background:_e,backgroundColor:_e,backgroundImage:"none",border:"1px solid #3a3a44",borderRadius:3,cursor:"pointer",padding:0,margin:0,display:"block","--swatch-color":_e},title:_e},`${xe}-button-${_e}-${_}`),Z&&l.jsx("div",{onClick:D=>{D.stopPropagation()},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",padding:8,background:"#fff",border:"1px solid #ddd",borderRadius:6,boxShadow:"0 8px 18px rgba(0,0,0,0.18)",zIndex:100},children:l.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(8, 22px)",gap:4},children:X.map(D=>l.jsx("div",{onClick:()=>re(J,D,ce),title:D,style:{width:22,height:22,backgroundColor:D,border:D===_e?"2px solid #333":"1px solid #ccc",cursor:"pointer"}},D))})})]},`${xe}-${_e}-${_}`)};return l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:J=>{J.target===J.currentTarget&&(M(),U(null))},children:l.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"16px",width:"fit-content",minWidth:"450px",maxWidth:"600px",maxHeight:"85vh",overflowY:"auto",overflowX:"visible",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:J=>J.stopPropagation(),children:[l.jsx("h3",{style:{margin:"0 0 12px 0",color:"#fff",fontSize:"16px",fontWeight:600},children:"Set Tool Color"}),l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:ie.map((J,ce)=>{if(!e.get(J.id))return null;const xe=J.layer?`${J.name} (${J.layer==="top"?"Top":"Bottom"})`:J.name;return l.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"6px 10px",background:"#1f1f24",borderRadius:4},children:[l.jsxs("label",{style:{color:"#f2f2f2",fontSize:"13px",width:"140px",flexShrink:0,marginRight:"8px"},children:[xe,":"]}),q(J.id,J.layer)]},`${J.id}-${J.layer||"default"}-${ce}`)})}),l.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:l.jsx("button",{onClick:()=>{M(),U(null)},style:{padding:"6px 12px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:600},children:"Close"})})]})})},h3=({openMenu:r,setOpenMenu:e,isReadOnlyMode:t,currentProjectFilePath:n,isProjectActive:s,autoSaveEnabled:o,autoSaveInterval:d,hasUnsavedChangesState:c,onNewProject:h,onOpenProject:f,onSaveProject:m,onPrint:b,onExportBOM:A,hasUnsavedChanges:v,bomExportFormat:E,setBomExportFormat:x,setNewProjectDialog:k,setAutoSaveDialog:j,topImage:$,bottomImage:z,setCurrentTool:B,resetImageTransform:F,areImagesLocked:I,setAreImagesLocked:X,onEnterBoardDimensions:M,fileInputTopRef:G,fileInputBottomRef:U,openProjectRef:_,increaseSize:N,decreaseSize:te,brushSize:ie,drawingStrokes:re,selectedIds:q,selectedComponentIds:J,selectedPowerIds:ce,selectedGroundIds:_e,componentsTop:xe,componentsBottom:Z,powers:D,grounds:H,powerNodeNames:Y,groundNodeNames:ue,setSetSizeDialog:Ne,areViasLocked:Pe,setAreViasLocked:Ue,arePadsLocked:Re,setArePadsLocked:Ke,areTestPointsLocked:Je,setAreTestPointsLocked:st,areTracesLocked:yt,setAreTracesLocked:Nt,areComponentsLocked:pe,setAreComponentsLocked:St,areGroundNodesLocked:Ut,setAreGroundNodesLocked:Lt,arePowerNodesLocked:at,setArePowerNodesLocked:en,showTraceCornerDots:Ot,setShowTraceCornerDots:wn,setSelectedIds:nn,setSelectedComponentIds:Zn,setSelectedPowerIds:Pt,setSelectedGroundIds:Mt,selectAllVias:yi,selectAllTraces:ft,selectAllPads:_t,selectAllComponents:On,selectDisconnectedComponents:Jt,selectAllComponentConnections:zn,selectAllPowerNodes:Nn,selectAllGroundNodes:on,selectPowerNodesByName:Sn,selectGroundNodesByName:lt,setShowPowerBusManager:Qt,setShowGroundBusManager:$t,setShowPastMachine:Gt,toolRegistry:An,updateToolSettings:Vi,updateToolLayerSettings:qn,setBrushSize:yn,setBrushColor:Kt,saveToolSettings:Tr,saveToolLayerSettings:Ks,colorPalette:Ir,currentTool:Br,drawingMode:Zt,traceToolLayer:Or,padToolLayer:Na,testPointToolLayer:fa,componentToolLayer:At,setTopTraceSize:fi,setBottomTraceSize:ei,setTopPadSize:vs,setBottomPadSize:Ji,setTopTestPointSize:Ds,setBottomTestPointSize:Ci,setTopComponentSize:Si,setBottomComponentSize:Cr,setComponentConnectionSize:pa,topTraceColor:qa,bottomTraceColor:Yl,topPadColor:Va,bottomPadColor:Wa,topTestPointColor:No,bottomTestPointColor:$n,topComponentColor:Fr,bottomComponentColor:xi,setTopTraceColor:ga,setBottomTraceColor:En,setTopPadColor:Qo,setBottomPadColor:pi,setTopTestPointColor:ma,setBottomTestPointColor:Pa,setTopComponentColor:el,setBottomComponentColor:tl,setComponentConnectionColor:$a,saveDefaultSize:td,saveDefaultColor:ss,menuBarRef:nl,onOpenProjectNotes:Un,onOpenTransformImages:Fn,onOpenTransformAll:il})=>{const[Ga,Fs]=Ct.useState(null),_r=Ct.useRef(null),[us,Vn]=Ct.useState(null),bi=Ct.useRef(null),[Xl,bc]=Ct.useState(!1),[ya,kr]=Ct.useState(!1),sl=Et=>{if(!s){alert("Please create a new project (File  New Project) or open an existing project (File  Open Project) before using this feature."),e(null);return}const Qi=Et();Qi instanceof Promise&&Qi.catch(fr=>{const Al=fr instanceof Error?fr.message:String(fr);console.error("Error in requireProject action:",fr),alert(`An error occurred:

${Al}

See console for details.`)})},Ya=Et=>{const Qi=Et==="power"?Y:ue,fr=Qi.length>0,Al=Et==="power"?"Select Power Nodes":"Select Ground Nodes";return l.jsxs("div",{onMouseEnter:()=>{_r.current&&(clearTimeout(_r.current),_r.current=null),Fs(Et)},onMouseLeave:()=>{_r.current=window.setTimeout(()=>{Fs(Xa=>Xa===Et?null:Xa)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[l.jsxs("div",{style:{padding:"4px 10px",fontSize:12,color:"#bbb"},children:[Al," by Name"]}),l.jsxs("button",{onClick:()=>{Et==="power"?Nn():on(),Fs(null),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:["All ",Et==="power"?"Power Nodes":"Ground Nodes"]}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),fr?Qi.map(Xa=>l.jsx("button",{onClick:()=>{Et==="power"?Sn(Xa):lt(Xa),Fs(null),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:Xa},Xa)):l.jsxs("div",{style:{padding:"4px 10px",fontSize:12,color:"#bbb"},children:["No ",Et==="power"?"power":"ground"," nodes available."]})]})},jr=()=>l.jsxs("div",{onMouseEnter:()=>{bi.current&&(clearTimeout(bi.current),bi.current=null),Vn("lock")},onMouseLeave:()=>{bi.current=window.setTimeout(()=>{Vn(Et=>Et==="lock"?null:Et)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[l.jsxs("label",{onClick:Et=>{Et.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[l.jsx("input",{type:"checkbox",checked:Pe,onChange:()=>{Ue(Et=>!Et)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),l.jsx("span",{children:"Lock Vias"})]}),l.jsxs("label",{onClick:Et=>{Et.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[l.jsx("input",{type:"checkbox",checked:Re,onChange:()=>{Ke(Et=>!Et)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),l.jsx("span",{children:"Lock Pads"})]}),l.jsxs("label",{onClick:Et=>{Et.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[l.jsx("input",{type:"checkbox",checked:Je,onChange:()=>{st(Et=>!Et)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),l.jsx("span",{children:"Lock Test Points"})]}),l.jsxs("label",{onClick:Et=>{Et.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[l.jsx("input",{type:"checkbox",checked:yt,onChange:()=>{Nt(Et=>!Et)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),l.jsx("span",{children:"Lock Traces"})]}),l.jsxs("label",{onClick:Et=>{Et.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[l.jsx("input",{type:"checkbox",checked:pe,onChange:()=>{St(Et=>!Et)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),l.jsx("span",{children:"Lock Components"})]}),l.jsxs("label",{onClick:Et=>{Et.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[l.jsx("input",{type:"checkbox",checked:Ut,onChange:()=>{Lt(Et=>!Et)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),l.jsx("span",{children:"Lock Ground Node"})]}),l.jsxs("label",{onClick:Et=>{Et.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[l.jsx("input",{type:"checkbox",checked:at,onChange:()=>{en(Et=>!Et)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),l.jsx("span",{children:"Lock Power Nodes"})]})]}),na=()=>l.jsxs("div",{onMouseEnter:()=>{bi.current&&(clearTimeout(bi.current),bi.current=null),Vn("select")},onMouseLeave:()=>{bi.current=window.setTimeout(()=>{Vn(Et=>Et==="select"?null:Et)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[l.jsx("button",{onClick:()=>{yi(),Vn(null),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Vias"}),l.jsx("button",{onClick:()=>{ft(),Vn(null),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Traces"}),l.jsx("button",{onClick:()=>{_t(),Vn(null),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Pads"}),l.jsx("button",{onClick:()=>{const Et=new Set(re.filter(Qi=>Qi.type==="testPoint").map(Qi=>Qi.id));nn(Et),Zn(new Set),Pt(new Set),Mt(new Set),Vn(null),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Test Points"}),l.jsx("button",{onClick:()=>{On(),Vn(null),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Components"}),l.jsx("button",{onClick:()=>{zn(),Vn(null),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Component Connections"}),l.jsxs("div",{style:{position:"relative"},children:[l.jsx("button",{onMouseEnter:()=>{_r.current&&(clearTimeout(_r.current),_r.current=null),Fs("power")},onMouseLeave:()=>{_r.current=window.setTimeout(()=>{Fs(Et=>Et==="power"?null:Et)},200)},onClick:()=>{Fs(Et=>Et==="power"?null:"power")},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Power Nodes "}),Ga==="power"&&Ya("power")]}),l.jsxs("div",{style:{position:"relative"},children:[l.jsx("button",{onMouseEnter:()=>{_r.current&&(clearTimeout(_r.current),_r.current=null),Fs("ground")},onMouseLeave:()=>{_r.current=window.setTimeout(()=>{Fs(Et=>Et==="ground"?null:Et)},200)},onClick:()=>{Fs(Et=>Et==="ground"?null:"ground")},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Ground Nodes "}),Ga==="ground"&&Ya("ground")]}),l.jsx("button",{onClick:()=>{Jt(),Vn(null),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Disconnected Components"})]});return l.jsxs(l.Fragment,{children:[l.jsxs("div",{ref:nl,style:{position:"relative",background:"rgba(250,250,255,0.9)",borderBottom:"1px solid #e6e6ef",padding:"6px 12px",display:"flex",gap:16,alignItems:"center",zIndex:3},children:[l.jsxs("div",{style:{position:"relative"},children:[l.jsx("button",{onClick:Et=>{Et.stopPropagation(),e(Qi=>Qi==="file"?null:"file")},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:r==="file"?"#eef3ff":"#fff",fontWeight:600,color:"#222"},children:"File "}),r==="file"&&l.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:200,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[l.jsx("button",{onClick:()=>{t||(e(null),v()?k({visible:!0}):h())},disabled:t,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:t?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:t?"not-allowed":"pointer"},children:"New Project"}),l.jsx("button",{onClick:async()=>{await f(),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Open Project"}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),l.jsx("button",{onClick:()=>{t||sl(()=>{m(),e(null)})},disabled:t||!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:t||!s?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:t||!s?"not-allowed":"pointer"},children:"Save Project"}),l.jsx("button",{onClick:()=>{t||sl(()=>{j({visible:!0,interval:5}),e(null)})},disabled:t||!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:t||!s?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:t||!s?"not-allowed":"pointer"},children:"Auto Save"}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),l.jsx("button",{onClick:()=>{Gt(!0),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Restore from History"}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),l.jsx("button",{onClick:async()=>{if(!t){if(!s){alert("Please create a new project (File  New Project) or open an existing project (File  Open Project) before using this feature."),e(null);return}try{await A(),e(null)}catch(Et){console.error("Error exporting BOM:",Et)}}},disabled:t||!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:t||!s?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:t||!s?"not-allowed":"pointer"},children:"Export BOM"}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),l.jsx("button",{onClick:()=>{sl(()=>{b(),e(null)})},disabled:!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:s?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:s?"pointer":"not-allowed"},children:"Print"}),l.jsx("button",{onClick:()=>{sl(()=>{b(),e(null)})},disabled:!s,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:s?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:s?"pointer":"not-allowed"},children:"Printer Settings"})]})]}),l.jsxs("div",{style:{position:"relative"},children:[l.jsx("button",{onClick:Et=>{if(!t){if(!s){alert("Please create a new project (File  New Project) or open an existing project (File  Open Project) before using this feature.");return}Et.stopPropagation(),e(Qi=>Qi==="transform"?null:"transform")}},disabled:t||!s,style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:r==="transform"?"#eef3ff":"#fff",fontWeight:600,color:t||!s?"#999":"#222",cursor:t||!s?"not-allowed":"pointer",opacity:t||!s?.5:1},children:"Images "}),r==="transform"&&l.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:260,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[l.jsx("button",{onClick:()=>{!t&&!I&&(G.current?.click(),e(null))},disabled:t||I,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:t||I?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:t||I?"not-allowed":"pointer"},children:"Load Top PCB"}),l.jsx("button",{onClick:()=>{!t&&!I&&(U.current?.click(),e(null))},disabled:t||I,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:t||I?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:t||I?"not-allowed":"pointer"},children:"Load Bottom PCB"}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),l.jsx("button",{onClick:()=>{I||(M(),e(null))},disabled:I,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:I?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:I?"not-allowed":"pointer"},children:"Enter PCB Dimensions"}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),l.jsx("button",{onClick:()=>{Fn(),e(null)},disabled:!$&&!z||I,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:!$&&!z||I?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:!$&&!z||I?"not-allowed":"pointer"},children:"Transform Images"}),l.jsx("button",{onClick:()=>{I||(B("transform"),F(),e(null))},disabled:I||!$&&!z,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:I||!$&&!z?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:I||!$&&!z?"not-allowed":"pointer"},children:"Reset Transform"}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),l.jsx("button",{onClick:()=>{X(Et=>!Et),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:I?"Unlock Images ":"Lock Images"})]})]}),l.jsxs("div",{style:{position:"relative"},children:[l.jsx("button",{onClick:Et=>{if(!t){if(!s){alert("Please create a new project (File  New Project) or open an existing project (File  Open Project) before using this feature.");return}Et.stopPropagation(),e(Qi=>Qi==="tools"?null:"tools")}},disabled:t||!s,style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:r==="tools"?"#eef3ff":"#fff",fontWeight:600,color:t||!s?"#999":"#222",cursor:t||!s?"not-allowed":"pointer",opacity:t||!s?.5:1},children:"Tools "}),r==="tools"&&l.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[l.jsx("button",{onClick:()=>{il(),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Change Perspective"}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),l.jsx("button",{onClick:()=>{N(),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Increase Size (+)"}),l.jsx("button",{onClick:()=>{te(),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Decrease Size (-)"}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),l.jsxs("div",{style:{position:"relative"},children:[l.jsx("button",{onMouseEnter:()=>{bi.current&&(clearTimeout(bi.current),bi.current=null),Vn("lock")},onMouseLeave:()=>{bi.current=window.setTimeout(()=>{Vn(Et=>Et==="lock"?null:Et)},200)},onClick:()=>{Vn(Et=>Et==="lock"?null:"lock")},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Lock "}),us==="lock"&&jr()]}),l.jsxs("div",{style:{position:"relative"},children:[l.jsx("button",{onMouseEnter:()=>{bi.current&&(clearTimeout(bi.current),bi.current=null),Vn("select")},onMouseLeave:()=>{bi.current=window.setTimeout(()=>{Vn(Et=>Et==="select"?null:Et)},200)},onClick:()=>{Vn(Et=>Et==="select"?null:"select")},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Select "}),us==="select"&&na()]}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),l.jsx("button",{onClick:()=>{Un(),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Open Project Notes"}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),l.jsx("button",{onClick:()=>{bc(!0),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Set Tool Sizes"}),l.jsx("button",{onClick:()=>{kr(!0),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Set Tool Colors"}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),l.jsx("button",{onClick:()=>{Qt(!0),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Manage Power Buses"}),l.jsx("button",{onClick:()=>{$t(!0),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Manage Ground Buses"}),l.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),l.jsxs("button",{onClick:()=>{wn(!Ot),e(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:[Ot?" ":"   ","Show Trace Corner Dots"]})]})]}),l.jsxs("div",{style:{position:"relative"},children:[l.jsx("button",{onClick:Et=>{Et.stopPropagation(),e(Qi=>Qi==="about"?null:"about")},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:r==="about"?"#eef3ff":"#fff",fontWeight:600,color:"#222"},children:"About "}),r==="about"&&l.jsx("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:500,maxWidth:700,maxHeight:"80vh",background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:20,overflowY:"auto",zIndex:100},children:l.jsxs("div",{style:{marginBottom:16},children:[l.jsx("h2",{style:{margin:"0 0 16px 0",color:"#f2f2f2",fontSize:"20px",fontWeight:700},children:"PCB Tracer"}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"About"}),l.jsx("p",{style:{margin:"0 0 12px 0",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:"A specialized tool useful for both reverse engineering and troubleshooting electronics by tracing and documenting circuit connections from PCB images. This application supports typical 2 to 4 layer PCBs and enables comprehensive PCB analysis and documentation."}),l.jsx("p",{style:{margin:"0 0 12px 0",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:"This tool can assist in troubleshooting by tracing circuits, holding contextual notes, comparing test results, and documenting findings during the debugging process."})]}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Technology"}),l.jsx("p",{style:{margin:"0 0 12px 0",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:"The application runs entirely client-side in the browser, to provide a responsive, interactive drawing experience with no backend server requirements."})]}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Features"}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Via/Pad Placement"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[l.jsxs("li",{children:["Alt/Option+click the Via or Pad tool, or press ",l.jsx("code",{children:"Alt/Option+V"})," or ",l.jsx("code",{children:"Alt/Option+P"})," to open the placement dialog"]}),l.jsx("li",{children:"Place multiple vias or pads in Linear, 2-Sided, or 4-Sided arrangements"}),l.jsx("li",{children:"Automatic counter-clockwise numbering starting from Pin 1"}),l.jsx("li",{children:"Supports chip orientations of 0, 90, 180, or 270"}),l.jsx("li",{children:"Click and drag to define the placement area"}),l.jsx("li",{children:"Tool automatically returns to Select tool after placement"})]})]}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Tools & Shortcuts"}),l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px 16px",fontSize:"13px",color:"#f2f2f2"},children:[l.jsx("div",{children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Select"}),"  ",l.jsx("code",{children:"S"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Via"}),"  ",l.jsx("code",{children:"V"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Pad"}),"  ",l.jsx("code",{children:"P"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Test Point"}),"  ",l.jsx("code",{children:"Y"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Trace"}),"  ",l.jsx("code",{children:"T"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Component"}),"  ",l.jsx("code",{children:"C"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Component Properties"}),"  double-click component"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Resize Icons"}),"  ",l.jsx("code",{children:"+"})," / ",l.jsx("code",{children:"-"})]})]})}),l.jsx("div",{children:l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Power"}),"  ",l.jsx("code",{children:"B"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Ground"}),"  ",l.jsx("code",{children:"G"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Move (Pan)"}),"  ",l.jsx("code",{children:"H"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Magnify"}),"  ",l.jsx("code",{children:"M"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Set View"}),"  ",l.jsx("code",{children:"X"})," then ",l.jsx("code",{children:"0-9"})," to save view"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Recall View"}),"  ",l.jsx("code",{children:"0-9"})," to recall saved view"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Default View 0"}),"  ",l.jsx("code",{children:"0"})," to recall default view (origin with all images contained)"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Information Dialog"}),"  ",l.jsx("code",{children:"I"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Notes Dialog"}),"  ",l.jsx("code",{children:"N"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Project Notes / TODO"}),"  ",l.jsx("code",{children:"L"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Undo"}),"  ",l.jsx("code",{children:"Ctrl"})," + ",l.jsx("code",{children:"Z"})]})]})})]}),l.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#f2f2f2"},children:[l.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#f2f2f2"},children:"Arrow Keys"}),l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Move Selected Components"}),"  Arrow keys to nudge selected components (1 unit per press, ",l.jsx("code",{children:"Shift"})," = 10 units)"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Switch Perspective"}),"  ",l.jsx("code",{children:"Shift"})," + ",l.jsx("code",{children:""})," / ",l.jsx("code",{children:""})," or ",l.jsx("code",{children:"Caps Lock"})," + ",l.jsx("code",{children:""})," / ",l.jsx("code",{children:""})," to switch between top/bottom view"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Rotate Perspective"}),"  ",l.jsx("code",{children:"Shift"})," + ",l.jsx("code",{children:""})," / ",l.jsx("code",{children:""})," or ",l.jsx("code",{children:"Caps Lock"})," + ",l.jsx("code",{children:""})," / ",l.jsx("code",{children:""})," to rotate in 90 increments (",l.jsx("code",{children:""})," = counter-clockwise, ",l.jsx("code",{children:""})," = clockwise)"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Image Transformations"}),"  Arrow keys for scaling, rotating, and adjusting image transformations (when image is selected for transform)"]}),l.jsx("li",{children:"Click a slider first, then use arrow keys for precise adjustment"})]})]})]}),l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px 20px"},children:[l.jsxs("div",{children:[l.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Image Management"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[l.jsx("li",{children:"Load top and bottom PCB images"}),l.jsx("li",{children:"Image alignment and transformation"}),l.jsx("li",{children:"Transform modes: nudge, scale, rotate, slant, keystone"}),l.jsx("li",{children:"Horizontal and vertical flip controls"}),l.jsx("li",{children:"Brightness and contrast controls"}),l.jsx("li",{children:"Grayscale mode"}),l.jsx("li",{children:"Automated transparency slider"}),l.jsx("li",{children:"Board dimensions configuration"})]})]}),l.jsxs("div",{children:[l.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Drawing Tools"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[l.jsx("li",{children:"Draw copper traces (top and bottom layers)"}),l.jsx("li",{children:"Place vias for layer connections"}),l.jsx("li",{children:"Place component pads (SMD and through-hole)"}),l.jsx("li",{children:"Place test points for circuit testing"}),l.jsx("li",{children:"Place and annotate components"}),l.jsx("li",{children:"Place power and ground nodes"}),l.jsx("li",{children:"Erase tool for removing elements"})]})]}),l.jsxs("div",{children:[l.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Layer Management"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[l.jsx("li",{children:"14 independent layers to manage PCB element types"}),l.jsx("li",{children:"Separate top and bottom layer support"}),l.jsx("li",{children:"Layer-specific color customization"}),l.jsx("li",{children:"Layer-specific size controls"}),l.jsx("li",{children:"Layer visibility toggles"}),l.jsx("li",{children:"Overlay view mode"})]})]}),l.jsxs("div",{children:[l.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Component Management"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[l.jsx("li",{children:"Component placement with pin counts"}),l.jsx("li",{children:"Pin connection tracking"}),l.jsx("li",{children:"Component type classification"}),l.jsx("li",{children:"Designator and value annotation"}),l.jsx("li",{children:"Component editor dialog"}),l.jsx("li",{children:"Find and center component"})]})]}),l.jsxs("div",{children:[l.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Selection & Locking"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[l.jsx("li",{children:"Select individual elements or groups"}),l.jsx("li",{children:"Select all vias, traces, pads, or components"}),l.jsx("li",{children:"Select power/ground nodes by name"}),l.jsx("li",{children:"Select disconnected components"}),l.jsx("li",{children:"Lock/unlock elements by type"}),l.jsx("li",{children:"Image locking for protection"})]})]}),l.jsxs("div",{children:[l.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Power & Ground"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[l.jsx("li",{children:"Multiple voltage power nodes"}),l.jsx("li",{children:"Power bus management"}),l.jsx("li",{children:"Ground node placement"}),l.jsx("li",{children:"Ground bus management"}),l.jsx("li",{children:"Node naming and organization"})]})]}),l.jsxs("div",{children:[l.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Customization"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[l.jsx("li",{children:"Customizable colors per layer"}),l.jsx("li",{children:"Adjustable brush/tool sizes"}),l.jsx("li",{children:"Size presets for common tools"}),l.jsx("li",{children:"Color palette management"}),l.jsx("li",{children:"Tool settings persistence"})]})]}),l.jsxs("div",{children:[l.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Project Management"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[l.jsx("li",{children:"Create, open, and save projects"}),l.jsx("li",{children:"Auto-save with configurable intervals"}),l.jsx("li",{children:"File history automatically saved in history subdirectory when Auto Save is enabled"}),l.jsx("li",{children:"Project Notes / TODO list with spreadsheet-like editing"}),l.jsx("li",{children:"Project file format (JSON)"}),l.jsx("li",{children:"Print functionality"}),l.jsx("li",{children:"Export to KiCad schematic format (future feature, not yet implemented)"})]})]}),l.jsxs("div",{children:[l.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"View Controls"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[l.jsx("li",{children:"Zoom in/out with mouse wheel"}),l.jsx("li",{children:"Pan view with hand tool"}),l.jsx("li",{children:"Zoom to fit"}),l.jsx("li",{children:"View mode switching (top/bottom/overlay)"}),l.jsx("li",{children:"Save up to 10 view locations (X + 0-9)"}),l.jsx("li",{children:"Recall saved views instantly (0-9 keys)"}),l.jsxs("li",{children:["Default View 0: Press ",l.jsx("code",{children:"0"})," to recall the default view showing the origin with all loaded images fully contained within the canvas"]}),l.jsx("li",{children:"Change Perspective (Tools menu) - switch between top/bottom view and rotate all elements"}),l.jsx("li",{children:"Detailed information dialog"})]})]})]})]}),l.jsx("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #444"},children:l.jsxs("p",{style:{margin:"0 0 8px 0",color:"#bbb",fontSize:"12px",lineHeight:"1.5"},children:["Use the ",l.jsx("strong",{children:"File"})," menu to manage projects, the ",l.jsx("strong",{children:"Images"})," menu for image loading and transformation, and the ",l.jsx("strong",{children:"Tools"})," menu for selection, locking, and customization options."]})}),l.jsxs("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #444"},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Future / TODO List"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[l.jsx("li",{children:"A searchable list of common components"}),l.jsx("li",{children:"Output schematics (perhaps as KiCad files)"}),l.jsx("li",{children:"Dynamic layers"}),l.jsx("li",{children:"Create a desktop version of this application using Electron"})]})]})]})})]}),l.jsxs("div",{style:{position:"relative"},children:[l.jsx("button",{onClick:Et=>{Et.stopPropagation(),e(Qi=>Qi==="help"?null:"help")},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:r==="help"?"#eef3ff":"#fff",fontWeight:600,color:"#222"},children:"Help "}),r==="help"&&l.jsx("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:500,maxWidth:700,maxHeight:"80vh",background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:20,overflowY:"auto",zIndex:100},children:l.jsxs("div",{style:{marginBottom:16},children:[l.jsx("h2",{style:{margin:"0 0 16px 0",color:"#f2f2f2",fontSize:"20px",fontWeight:700},children:"Help: Typical Usage Steps"}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 1: Create or Open a Project"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"New Project:"})," File  New Project. Choose a project name and location."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Open Project:"})," File  Open Project. Select an existing project file (.json)."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Auto-Save:"})," File  Auto Save  Enable to automatically save your work at regular intervals."]})]})]}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 2: Load PCB Images"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Load Top Image:"})," Images  Load Top Image. Select your top-side PCB photo (.png or .jpeg)."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Load Bottom Image:"})," Images  Load Bottom Image. Select your bottom-side PCB photo."]}),l.jsxs("li",{children:["Images are automatically copied to the ",l.jsx("code",{style:{background:"#1f1f24",padding:"2px 4px",borderRadius:3,color:"#fff"},children:"images/"})," subdirectory."]})]})]}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 3: Align and Transform Images"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Enter Transform Mode:"})," Images  Transform Images. Select which image (Top or Bottom) to transform."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Transform Operations:"})," Use Move, Nudge, Scale, Rotate, Slant, or Keystone to align images."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Image Adjustments:"})," Adjust brightness, contrast, sharpness, and grayscale as needed."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Flip Images:"})," Use horizontal or vertical flip if your images are mirrored."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Arrow Keys:"})," When transform tool is active, use arrow keys for precise image adjustments."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Move Components:"})," Select components, then use arrow keys to move them (1 unit per press, ",l.jsx("code",{children:"Shift"})," = 10 units for larger steps)."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Change Perspective:"})," Tools  Change Perspective (or press ",l.jsx("code",{children:"E"}),") to switch between top/bottom view or rotate all elements (images, components, traces) together by 90, 180, or 270."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Quick Perspective Switch:"})," Press ",l.jsx("code",{children:"Shift"})," + ",l.jsx("code",{children:""})," / ",l.jsx("code",{children:""})," or ",l.jsx("code",{children:"Caps Lock"})," + ",l.jsx("code",{children:""})," / ",l.jsx("code",{children:""})," to quickly switch between top/bottom view."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Quick Perspective Rotation:"})," Press ",l.jsx("code",{children:"Shift"})," + ",l.jsx("code",{children:""})," / ",l.jsx("code",{children:""})," or ",l.jsx("code",{children:"Caps Lock"})," + ",l.jsx("code",{children:""})," / ",l.jsx("code",{children:""})," to rotate perspective in 90 increments (",l.jsx("code",{children:""})," = counter-clockwise, ",l.jsx("code",{children:""})," = clockwise)."]})]})]}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 4: Set Board Dimensions"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Enter Dimensions:"})," Images  Enter Board Dimensions. Specify the actual physical dimensions of your PCB."]}),l.jsx("li",{children:"This helps ensure accurate measurements and scaling for your reverse engineering work."})]})]}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 5: Trace Connections"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Place Vias:"})," Click the Via tool (",l.jsx("code",{children:"V"}),") and click on the PCB where vias connect layers."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Place Pads:"})," Click the Pad tool (",l.jsx("code",{children:"P"}),") and mark component pad locations."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Place Multiple Vias/Pads:"})," Alt/Option+click the Via or Pad tool, or press ",l.jsx("code",{children:"Alt/Option+V"})," (vias) or ",l.jsx("code",{children:"Alt/Option+P"})," (pads) to open the placement dialog. Choose arrangement (Linear, 2-Sided, or 4-Sided), number of pins, orientation, and layer. Click and drag on the canvas to define the placement area. Vias/pads are automatically arranged in counter-clockwise order starting from Pin 1."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Place Test Points:"})," Click the Test Point tool (",l.jsx("code",{children:"Y"}),") to mark test points."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Draw Traces:"})," Click the Trace tool (",l.jsx("code",{children:"T"}),"), select Top or Bottom layer, then click to start a trace. Click again to add segments. Press ",l.jsx("code",{children:"Enter"})," or click outside to finish."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Snapping:"})," Traces automatically snap to nearby vias, pads, power nodes, and ground nodes."]})]})]}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 6: Place Components"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Place Component:"})," Click the Component tool (",l.jsx("code",{children:"C"}),"), select component type, then click on the PCB."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Edit Component:"})," Double-click a component or select a component and press ",l.jsx("code",{children:"A"})," to open the Component Properties dialog. If multiple components are selected, opens the most recently selected one."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Set Properties:"})," Enter designator (e.g., R1, C2), value, and other component details."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Connect Pins:"})," Click on pads or vias to connect component pins to the circuit."]})]})]}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 7: Add Power and Ground Nodes"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Manage Power Buses:"})," Tools  Manage Power Buses to create and configure voltage buses (e.g., +5V, +3.3V)."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Place Power Nodes:"})," Click the Power tool (",l.jsx("code",{children:"B"}),"), select a voltage bus, then click on the PCB."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Manage Ground Buses:"})," Tools  Manage Ground Buses to configure ground connections."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Place Ground Nodes:"})," Click the Ground tool (",l.jsx("code",{children:"G"}),"), select a ground bus, then click on the PCB."]})]})]}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 8: Add Notes and Documentation"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Element Notes:"})," Press ",l.jsx("code",{children:"N"})," to open the Notes dialog for selected elements (vias, pads, traces, etc.)."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Project Notes:"})," Press ",l.jsx("code",{children:"L"})," to open Project Notes / TODO list for general project documentation."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Information Dialog:"})," Press ",l.jsx("code",{children:"I"})," to see detailed information about selected elements."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Find Elements:"})," Use the Find button in the Information dialog to center and highlight specific elements."]})]})]}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 9: Save Your Work"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Manual Save:"})," File  Save Project to save your work manually."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Auto-Save:"})," If enabled, your project is automatically saved at regular intervals."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"History:"})," Auto-saved versions are stored in the ",l.jsx("code",{style:{background:"#1f1f24",padding:"2px 4px",borderRadius:3,color:"#fff"},children:"history/"})," subdirectory."]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Restore from History:"})," File  Restore from History to access previous versions."]})]})]}),l.jsxs("div",{style:{marginBottom:20,paddingTop:16,borderTop:"1px solid #444"},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Keyboard Shortcuts"}),l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px 16px",fontSize:"13px",color:"#f2f2f2"},children:[l.jsxs("div",{children:[l.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#f2f2f2"},children:"Drawing Tools"}),l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Select"}),"  ",l.jsx("code",{children:"S"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Via"}),"  ",l.jsx("code",{children:"V"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Via Pattern"}),"  ",l.jsx("code",{children:"Alt/Option+V"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Pad"}),"  ",l.jsx("code",{children:"P"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Pad Pattern"}),"  ",l.jsx("code",{children:"Alt/Option+P"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Test Point"}),"  ",l.jsx("code",{children:"Y"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Trace"}),"  ",l.jsx("code",{children:"T"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Component"}),"  ",l.jsx("code",{children:"C"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Component Properties"}),"  ",l.jsx("code",{children:"A"})," (opens dialog for selected component)"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Power"}),"  ",l.jsx("code",{children:"B"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Ground"}),"  ",l.jsx("code",{children:"G"})]})]})]}),l.jsxs("div",{children:[l.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#f2f2f2"},children:"View & Navigation"}),l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Move (Pan)"}),"  ",l.jsx("code",{children:"H"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Magnify"}),"  ",l.jsx("code",{children:"M"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Set View"}),"  ",l.jsx("code",{children:"X"})," then ",l.jsx("code",{children:"0-9"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Recall View"}),"  ",l.jsx("code",{children:"0-9"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Default View 0"}),"  ",l.jsx("code",{children:"0"})," (origin with all images contained)"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Default View 0"}),"  ",l.jsx("code",{children:"0"})," (origin with all images contained)"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Information"}),"  ",l.jsx("code",{children:"I"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Notes"}),"  ",l.jsx("code",{children:"N"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Project Notes"}),"  ",l.jsx("code",{children:"L"})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Undo"}),"  ",l.jsx("code",{children:"Ctrl+Z"})," / ",l.jsx("code",{children:"Cmd+Z"})]})]})]})]}),l.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#f2f2f2"},children:[l.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#f2f2f2"},children:"Arrow Keys"}),l.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Move Selected Components"}),"  Arrow keys to nudge selected components (1 unit per press, ",l.jsx("code",{children:"Shift"})," = 10 units)"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Switch Perspective"}),"  ",l.jsx("code",{children:"Shift"})," + ",l.jsx("code",{children:""})," / ",l.jsx("code",{children:""})," or ",l.jsx("code",{children:"Caps Lock"})," + ",l.jsx("code",{children:""})," / ",l.jsx("code",{children:""})]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Rotate Perspective"}),"  ",l.jsx("code",{children:"Shift"})," + ",l.jsx("code",{children:""})," / ",l.jsx("code",{children:""})," or ",l.jsx("code",{children:"Caps Lock"})," + ",l.jsx("code",{children:""})," / ",l.jsx("code",{children:""})," (",l.jsx("code",{children:""})," = counter-clockwise, ",l.jsx("code",{children:""})," = clockwise)"]}),l.jsx("li",{children:"Use arrow keys to adjust image transformations (when transform tool is active)"}),l.jsx("li",{children:"Click a slider first, then use arrow keys for precise adjustment"})]})]})]}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Tips & Tricks"}),l.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[l.jsx("li",{children:"Double-click any slider to reset it to the default value"}),l.jsx("li",{children:"Double-click a component to edit its properties"}),l.jsxs("li",{children:["Hold ",l.jsx("code",{children:"Shift"})," while clicking to add to selection"]}),l.jsxs("li",{children:["Use the Information dialog (",l.jsx("code",{children:"I"}),") to see details about selected elements"]}),l.jsx("li",{children:"Lock layers (Tools  Lock) to prevent accidental modifications"}),l.jsx("li",{children:"Use the Find button in the Information dialog to center elements in view"}),l.jsxs("li",{children:["Save views with ",l.jsx("code",{children:"X"})," + number key for quick navigation"]}),l.jsxs("li",{children:["Use ",l.jsx("code",{children:"+"})," and ",l.jsx("code",{children:"-"})," keys to resize tool icons"]})]})]}),l.jsx("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #444"},children:l.jsxs("p",{style:{margin:"0 0 8px 0",color:"#bbb",fontSize:"12px",lineHeight:"1.5"},children:["For more detailed feature information, see the ",l.jsx("strong",{children:"About"})," menu."]})})]})})]}),n&&l.jsxs("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:"8px",paddingLeft:"16px"},children:[l.jsx("div",{style:{fontSize:"12px",color:"#333",fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"40vw"},title:n,children:n}),l.jsx("div",{style:{width:"16px",height:"16px",borderRadius:"50%",border:"1px solid #666",backgroundColor:c?o?"#ffaa00":"#ff0000":"#00ff00",flexShrink:0},title:c?o?`Changes detected  Auto Save: ON  Will be saved automatically every ${d||1} minute${d===1?"":"s"}`:"Changes detected  Auto Save: OFF  You need to save manually (File  Save Project)":"Project saved  No unsaved changes  Auto Save: "+(o?"ON":"OFF")})]})]}),l.jsx(d3,{visible:Xl,toolRegistry:An,currentTool:Br,drawingMode:Zt,traceToolLayer:Or,padToolLayer:Na,testPointToolLayer:fa,componentToolLayer:At,updateToolSettings:Vi,updateToolLayerSettings:qn,setBrushSize:yn,saveToolSettings:Tr,saveToolLayerSettings:Ks,setTopTraceSize:fi,setBottomTraceSize:ei,setTopPadSize:vs,setBottomPadSize:Ji,setTopTestPointSize:Ds,setBottomTestPointSize:Ci,setTopComponentSize:Si,setBottomComponentSize:Cr,setComponentConnectionSize:pa,saveDefaultSize:td,onClose:()=>bc(!1)}),l.jsx(u3,{visible:ya,toolRegistry:An,currentTool:Br,drawingMode:Zt,traceToolLayer:Or,padToolLayer:Na,testPointToolLayer:fa,componentToolLayer:At,updateToolSettings:Vi,updateToolLayerSettings:qn,saveToolSettings:Tr,saveToolLayerSettings:Ks,setBrushColor:Kt,setTopTraceColor:ga,setBottomTraceColor:En,setTopPadColor:Qo,setBottomPadColor:pi,setTopTestPointColor:ma,setBottomTestPointColor:Pa,setTopComponentColor:el,setBottomComponentColor:tl,setComponentConnectionColor:$a,saveDefaultColor:ss,colorPalette:Ir,onClose:()=>kr(!1)})]})},f3=({visible:r,canvasSize:e={width:960,height:600},canvasPosition:t={left:244,top:6},onDismiss:n})=>{const s=K.useRef(null),o=K.useRef(null),[d,c]=K.useState(!0),h=K.useCallback(()=>{s.current&&(s.current.pause(),s.current.src="",s.current.load()),c(!1),n&&n()},[n]);return K.useEffect(()=>{r&&c(!0)},[r]),K.useEffect(()=>{if(!r)return;const f=()=>{h()};return document.addEventListener("click",f,{once:!0}),document.addEventListener("mousedown",f,{once:!0}),()=>{document.removeEventListener("click",f),document.removeEventListener("mousedown",f)}},[r,h]),K.useEffect(()=>{r&&d&&s.current?s.current.play().catch(f=>{console.warn("Video autoplay failed:",f)}):(!r||!d)&&s.current&&s.current&&(s.current.pause(),s.current.src="",s.current.load())},[r,d]),r?l.jsxs("div",{ref:o,style:{position:"absolute",left:0,top:0,right:0,bottom:0,pointerEvents:"none",zIndex:10},children:[d&&l.jsx("video",{ref:s,src:"/PCB_Reverse_Engineering_Tool/SplashLoop.mp4",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,style:{position:"absolute",left:`${t.left}px`,top:`${t.top}px`,width:`${e.width}px`,height:`${e.height}px`,objectFit:"cover",pointerEvents:"none",zIndex:1}}),l.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",padding:"24px 32px",background:"rgba(255, 255, 255, 0.85)",borderRadius:8,border:"2px solid #4CAF50",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",maxWidth:"500px",pointerEvents:"auto",zIndex:2},children:[l.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"#000",marginBottom:"12px"},children:"PCB Tracer: An Electronics Tool"}),l.jsxs("div",{style:{fontSize:"16px",fontWeight:600,color:"#000",marginBottom:"16px",lineHeight:"1.5"},children:["Reverse Engineer, Troubleshoot, Repair, Signal Trace,",l.jsx("br",{}),"Generate Schematic, Document Test Results"]}),l.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"8px",lineHeight:"1.5",textAlign:"left"},children:"1) Use the File menu to start a new project."}),l.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"8px",lineHeight:"1.5",textAlign:"left"},children:"2) Use the Images menu to load images."}),l.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"12px",lineHeight:"1.5",textAlign:"left"},children:"3) Use the tools to draw vias, traces, components, etc."})]})]}):null},p3=({visible:r,title:e,message:t,onClose:n})=>r?l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:s=>{s.target===s.currentTarget&&n()},children:l.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"2px solid #ff4444"},onClick:s=>s.stopPropagation(),children:[l.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",gap:"12px"},children:[l.jsx("div",{style:{fontSize:"24px",color:"#ff4444"},children:""}),l.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:e})]}),l.jsx("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"14px",lineHeight:"1.5"},children:t}),l.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:l.jsx("button",{onClick:n,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"OK"})})]})}):null,g3=({visible:r,selectedIds:e,selectedComponentIds:t,selectedPowerIds:n,selectedGroundIds:s,drawingStrokes:o,componentsTop:d,componentsBottom:c,powers:h,grounds:f,powerBuses:m,onClose:b,setComponentsTop:A,setComponentsBottom:v,determineViaType:E,determinePadType:x,determineTestPointType:k,onFindComponent:j,onFindStroke:$,onFindPower:z,onFindGround:B,position:F,isDragging:I,onDragStart:X,onOpenNotesDialog:M})=>{if(!r)return null;const G=F?{position:"fixed",left:`${F.x}px`,top:`${F.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"150px",maxWidth:"400px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:I?"grabbing":"default"}:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"flex-start",justifyContent:"flex-end",paddingRight:"20px",paddingTop:"80px",zIndex:1e4,pointerEvents:"none"},U={padding:"20px",overflow:"auto",flex:1};return l.jsxs("div",{style:G,children:[l.jsxs("div",{onMouseDown:_=>{const N=_.target;N.tagName==="BUTTON"||N.closest("button")||F&&X(_)},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:I?"grabbing":F?"grab":"default",userSelect:"none",flexShrink:0},children:[l.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Information (I)"}),l.jsx("button",{onClick:b,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),l.jsx("div",{style:U,children:l.jsxs("div",{style:{margin:0,padding:0,backgroundColor:"#f5f5f5",borderRadius:4,fontSize:"12px",fontFamily:"monospace",maxHeight:"calc(80vh - 100px)",overflow:"auto",color:"#000"},children:[(()=>{const _=o.filter(q=>e.has(q.id)).length,N=[...d,...c].filter(q=>t.has(q.id)).length,te=h.filter(q=>n.has(q.id)).length,ie=f.filter(q=>s.has(q.id)).length,re=_+N+te+ie;return l.jsx("div",{style:{padding:"12px 16px",backgroundColor:re>0?"#e8e8e8":"#fff3cd",borderBottom:"2px solid #ccc",fontSize:"13px",fontWeight:600,color:re>0?"#333":"#856404",marginBottom:"8px"},children:re>0?`${re} Object${re!==1?"s":""} Selected`:"Zero Objects Selected"})})(),t.size>0&&(()=>{const _=o.some(N=>e.has(N.id)&&(N.type==="via"||N.type==="pad"));return[...d,...c].filter(N=>t.has(N.id)).map(N=>{const te=_d(N),ie=te?.fields,re=ie&&ie.length>0?l.jsx("div",{style:{marginTop:"6px",marginBottom:"6px",padding:"4px 0"},children:ie.map(q=>{const J=N[q.name];if(J==null||J==="")return null;const ce=N[`${q.name}Unit`],_e=typeof J=="boolean"?J?"Yes":"No":J;return l.jsxs("div",{style:{fontSize:"11px",color:"#444",marginBottom:"2px"},children:[q.label,": ",_e,ce?` ${ce}`:""]},q.name)})}):l.jsx("div",{style:{padding:"6px 0",fontSize:"11px",color:"#856404",background:"#fff3cd",border:"1px solid #ffeeba",borderRadius:4,marginTop:"6px",marginBottom:"6px"},children:"Component definition missing for this instance. Please ensure componentDefinitions.json entry and componentDefinitionKey are set."});return l.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",flexDirection:"column",gap:"4px",padding:"8px 12px",minHeight:"32px"},children:[l.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:l.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Category:"}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:te?.category||"N/A"})]})}),l.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:te?.displayName?N.componentType==="Capacitor"&&!te.displayName.toLowerCase().includes("capacitor")?`${te.displayName} Capacitor`:te.displayName:N.componentType==="GenericComponent"&&N.genericType?yc(N.genericType):N.componentType==="Diode"&&N.diodeType&&N.diodeType!=="Standard"?yc(N.diodeType):N.componentType==="VariableResistor"&&N.vrType&&N.vrType!=="Potentiometer"?yc(N.vrType):N.componentType==="Capacitor"&&N.dielectric==="Tantalum"?"Tantalum Capacitor":N.componentType==="Capacitor"&&N.capacitorType==="Electrolytic"?"Electrolytic Capacitor":N.componentType==="Capacitor"&&N.capacitorType==="Film"?"Film Capacitor":yc(N.componentType)})]}),j&&l.jsx("button",{onClick:()=>{j(N.id,N.x,N.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:q=>{q.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:q=>{q.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]})]}),l.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[re,l.jsxs("div",{children:["Layer: ",N.layer]}),N.componentType==="IntegratedCircuit"&&l.jsxs(l.Fragment,{children:[N.description&&l.jsxs("div",{children:["Description: ",N.description]}),N.icType&&l.jsxs("div",{children:["IC Type: ",N.icType]})]}),l.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),l.jsx("input",{type:"text",value:N.notes||"",readOnly:!0,onClick:M,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[l.jsxs("span",{children:["Designator: ",N.designator||"(empty)"]}),_&&l.jsx("button",{onClick:()=>{const q=[...d,...c].filter(Y=>t.has(Y.id)&&Y.componentType===N.componentType),J=q.length,ce=o.filter(Y=>e.has(Y.id)&&Y.type==="pad"&&Y.points.length>0&&Y.points[0].id!==void 0).map(Y=>{const ue=Y.points[0].id;if(ue===void 0)throw new Error("Unexpected undefined id");return{stroke:Y,nodeId:ue}}).sort((Y,ue)=>Y.nodeId-ue.nodeId),_e=ce.length>0?ce:o.filter(Y=>e.has(Y.id)&&Y.type==="via"&&Y.points.length>0&&Y.points[0].id!==void 0).map(Y=>{const ue=Y.points[0].id;if(ue===void 0)throw new Error("Unexpected undefined id");return{stroke:Y,nodeId:ue}}).sort((Y,ue)=>Y.nodeId-ue.nodeId),xe=_e.length;if(xe===0){console.warn("No vias or pads with Node IDs found in selection");return}const Z=Math.floor(xe/J);if(Z===0){console.warn(`Not enough ${ce.length>0?"pads":"vias"} (${xe}) for ${J} components`);return}[...q].sort((Y,ue)=>Y.id.localeCompare(ue.id)).forEach((Y,ue)=>{const Ne=ue*Z,Pe=Ne+Z,Re=_e.slice(Ne,Pe).map(Je=>Je.nodeId.toString()),Ke=Um(Y,Re,o);Y.layer==="top"?A(Je=>Je.map(st=>{if(st.id===Y.id){const yt={...st,pinCount:Z,pinConnections:Re};return Ke&&(yt.pinPolarities=Ke),yt}return st})):v(Je=>Je.map(st=>{if(st.id===Y.id){const yt={...st,pinCount:Z,pinConnections:Re};return Ke&&(yt.pinPolarities=Ke),yt}return st}))});const H=ce.length>0?"pads":"vias";console.log(`Connected ${J} components of type ${N.componentType} to ${xe} ${H} (${Z} pins each)`)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap"},onMouseEnter:q=>{q.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:q=>{q.currentTarget.style.backgroundColor="#4CAF50"},children:"Connect"})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("span",{children:"Color:"}),l.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:N.color,border:"1px solid #ccc",borderRadius:2}}),l.jsx("span",{children:N.color})]}),l.jsxs("div",{children:["Size: ",N.size]}),l.jsxs("div",{children:["Pin Count: ",N.pinCount]}),N.componentType==="Resistor"&&l.jsxs(l.Fragment,{children:[N.resistance&&l.jsxs("div",{children:["Resistance: ",N.resistance]}),N.power&&l.jsxs("div",{children:["Power: ",N.power]}),N.tolerance&&l.jsxs("div",{children:["Tolerance: ",N.tolerance]})]}),N.componentType==="Capacitor"&&l.jsxs(l.Fragment,{children:[N.capacitance&&l.jsxs("div",{children:["Capacitance: ",N.capacitance]}),N.voltage&&l.jsxs("div",{children:["Voltage: ",N.voltage]}),N.dielectric&&l.jsxs("div",{children:["Dielectric: ",N.dielectric]}),N.tolerance&&l.jsxs("div",{children:["Tolerance: ",N.tolerance]})]}),N.componentType==="Electrolytic Capacitor"&&l.jsxs(l.Fragment,{children:[N.capacitance&&l.jsxs("div",{children:["Capacitance: ",N.capacitance]}),N.voltage&&l.jsxs("div",{children:["Voltage: ",N.voltage]}),N.tolerance&&l.jsxs("div",{children:["Tolerance: ",N.tolerance]}),N.polarized!==void 0&&l.jsxs("div",{children:["Polarized: ",N.polarized?"Yes":"No"]}),N.esr&&l.jsxs("div",{children:["ESR: ",N.esr]}),N.temperature&&l.jsxs("div",{children:["Temperature: ",N.temperature]})]}),N.pinConnections&&N.pinConnections.length>0&&(()=>{const q=Sp(N),J=_d(N),ce=N?.pinNames,_e=J?.properties?.pinNames,Z=_e&&_e.length>0;return l.jsxs("div",{style:{marginTop:"8px",marginBottom:"8px"},children:[l.jsx("div",{style:{marginBottom:"4px",fontWeight:600},children:"Pin Connections:"}),l.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px",border:"1px solid #ddd"},children:[l.jsx("thead",{children:l.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[l.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Pin #"}),Z&&l.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Pin Name"}),q&&l.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Polarity"}),l.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Node ID"})]})}),l.jsx("tbody",{children:N.pinConnections.map((D,H)=>{const Y=N.pinPolarities&&N.pinPolarities.length>H?N.pinPolarities[H]:"",ue=ce&&H<ce.length?ce[H]:"",Ne=_e&&H<_e.length?_e[H]:"",Pe=Ne==="CHIP_DEPENDENT",Ue=ue&&ue.trim()!==""?ue:Pe?"":Ne;return l.jsxs("tr",{style:{backgroundColor:H%2===0?"#fff":"#f9f9f9"},children:[l.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:H+1}),Z&&l.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd",fontSize:"9px",fontStyle:"italic",color:"#555"},children:Ue||"-"}),q&&l.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd",textAlign:"center",fontFamily:"monospace",fontWeight:600,color:Y==="+"?"#d32f2f":Y==="-"?"#1976d2":"#999"},children:Y||"-"}),l.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:D||"(not connected)"})]},H)})})]})]})})(),"manufacturer"in N&&N.manufacturer&&l.jsxs("div",{children:["Manufacturer: ",N.manufacturer]}),"partNumber"in N&&N.partNumber&&l.jsxs("div",{children:["Part Number: ",N.partNumber]}),N.componentType==="Diode"&&l.jsxs(l.Fragment,{children:[N.diodeType&&l.jsxs("div",{children:["Type: ",N.diodeType]}),N.voltage&&l.jsxs("div",{children:["Voltage: ",N.voltage]}),N.current&&l.jsxs("div",{children:["Current: ",N.current]}),N.ledColor&&l.jsxs("div",{children:["LED Color: ",N.ledColor]})]}),N.componentType==="Battery"&&l.jsxs(l.Fragment,{children:[N.voltage&&l.jsxs("div",{children:["Voltage: ",N.voltage]}),N.capacity&&l.jsxs("div",{children:["Capacity: ",N.capacity]}),N.chemistry&&l.jsxs("div",{children:["Chemistry: ",N.chemistry]})]}),N.componentType==="Fuse"&&l.jsxs(l.Fragment,{children:[N.current&&l.jsxs("div",{children:["Current: ",N.current]}),N.voltage&&l.jsxs("div",{children:["Voltage: ",N.voltage]}),N.fuseType&&l.jsxs("div",{children:["Type: ",N.fuseType]})]}),N.componentType==="FerriteBead"&&l.jsxs(l.Fragment,{children:[N.impedance&&l.jsxs("div",{children:["Impedance: ",N.impedance]}),N.current&&l.jsxs("div",{children:["Current: ",N.current]})]}),N.componentType==="Connector"&&l.jsxs(l.Fragment,{children:[N.connectorType&&l.jsxs("div",{children:["Type: ",N.connectorType]}),N.gender&&l.jsxs("div",{children:["Gender: ",N.gender]})]}),N.componentType==="Jumper"&&l.jsx(l.Fragment,{children:N.positions&&l.jsxs("div",{children:["Positions: ",N.positions]})}),N.componentType==="Relay"&&l.jsxs(l.Fragment,{children:[N.coilVoltage&&l.jsxs("div",{children:["Coil Voltage: ",N.coilVoltage]}),N.contactType&&l.jsxs("div",{children:["Contact Type: ",N.contactType]}),N.current&&l.jsxs("div",{children:["Current: ",N.current]})]}),N.componentType==="Inductor"&&l.jsxs(l.Fragment,{children:[N.inductance&&l.jsxs("div",{children:["Inductance: ",N.inductance]}),N.current&&l.jsxs("div",{children:["Current: ",N.current]}),N.resistance&&l.jsxs("div",{children:["DC Resistance: ",N.resistance]})]}),N.componentType==="Speaker"&&l.jsxs(l.Fragment,{children:[N.impedance&&l.jsxs("div",{children:["Impedance: ",N.impedance]}),N.power&&l.jsxs("div",{children:["Power: ",N.power]})]}),N.componentType==="Motor"&&l.jsxs(l.Fragment,{children:[N.motorType&&l.jsxs("div",{children:["Type: ",N.motorType]}),N.voltage&&l.jsxs("div",{children:["Voltage: ",N.voltage]}),N.current&&l.jsxs("div",{children:["Current: ",N.current]})]}),N.componentType==="PowerSupply"&&l.jsxs(l.Fragment,{children:[N.inputVoltage&&l.jsxs("div",{children:["Input Voltage: ",N.inputVoltage]}),N.outputVoltage&&l.jsxs("div",{children:["Output Voltage: ",N.outputVoltage]}),N.current&&l.jsxs("div",{children:["Current: ",N.current]})]}),N.componentType==="Transistor"&&l.jsxs(l.Fragment,{children:[N.transistorType&&l.jsxs("div",{children:["Type: ",N.transistorType]}),N.polarized!==void 0&&l.jsxs("div",{children:["Polarized: ",N.polarized?"Yes":"No"]}),N.voltage&&l.jsxs("div",{children:["Voltage: ",N.voltage]}),N.current&&l.jsxs("div",{children:["Current: ",N.current]})]}),N.componentType==="ResistorNetwork"&&l.jsxs(l.Fragment,{children:[N.resistance&&l.jsxs("div",{children:["Resistance: ",N.resistance]}),N.configuration&&l.jsxs("div",{children:["Configuration: ",N.configuration]})]}),N.componentType==="Thermistor"&&l.jsxs(l.Fragment,{children:[N.resistance&&l.jsxs("div",{children:["Resistance: ",N.resistance]}),N.thermistorType&&l.jsxs("div",{children:["Type: ",N.thermistorType]}),N.beta&&l.jsxs("div",{children:["Beta: ",N.beta]})]}),N.componentType==="Switch"&&l.jsxs(l.Fragment,{children:[N.switchType&&l.jsxs("div",{children:["Type: ",N.switchType]}),N.current&&l.jsxs("div",{children:["Current: ",N.current]}),N.voltage&&l.jsxs("div",{children:["Voltage: ",N.voltage]})]}),N.componentType==="Transformer"&&l.jsxs(l.Fragment,{children:[N.primaryVoltage&&l.jsxs("div",{children:["Primary Voltage: ",N.primaryVoltage]}),N.secondaryVoltage&&l.jsxs("div",{children:["Secondary Voltage: ",N.secondaryVoltage]}),N.power&&l.jsxs("div",{children:["Power: ",N.power]}),N.turns&&l.jsxs("div",{children:["Turns Ratio: ",N.turns]})]}),N.componentType==="TestPoint"&&l.jsx(l.Fragment,{children:N.signal&&l.jsxs("div",{children:["Signal: ",N.signal]})}),N.componentType==="IntegratedCircuit"&&l.jsx(l.Fragment,{children:N.datasheet&&(()=>{const q=N.datasheet.trim(),J=q.match(/^https?:\/\//)?q:`https://${q}`;return l.jsxs("div",{children:["Datasheet:"," ",l.jsx("a",{href:J,target:"_blank",rel:"noopener noreferrer",style:{color:"#0066cc",textDecoration:"underline"},children:q})]})})()}),N.componentType==="VacuumTube"&&l.jsx(l.Fragment,{children:N.tubeType&&l.jsxs("div",{children:["Type: ",N.tubeType]})}),N.componentType==="VariableResistor"&&l.jsxs(l.Fragment,{children:[N.vrType&&l.jsxs("div",{children:["Type: ",N.vrType]}),N.resistance&&l.jsxs("div",{children:["Resistance: ",N.resistance]}),N.power&&l.jsxs("div",{children:["Power: ",N.power]}),N.taper&&l.jsxs("div",{children:["Taper: ",N.taper]})]}),N.componentType==="Crystal"&&l.jsxs(l.Fragment,{children:[N.frequency&&l.jsxs("div",{children:["Frequency: ",N.frequency]}),N.loadCapacitance&&l.jsxs("div",{children:["Load Capacitance: ",N.loadCapacitance]}),N.tolerance&&l.jsxs("div",{children:["Tolerance: ",N.tolerance]})]}),N.componentType==="GenericComponent"&&l.jsxs(l.Fragment,{children:[N.genericType&&l.jsxs("div",{children:["Type: ",N.genericType]}),N.voltage&&l.jsxs("div",{children:["Voltage: ",N.voltage," ",N.voltageUnit||"V"]}),N.current&&l.jsxs("div",{children:["Current: ",N.current," ",N.currentUnit||"A"]}),N.power&&l.jsxs("div",{children:["Power: ",N.power]}),N.frequency&&l.jsxs("div",{children:["Frequency: ",N.frequency]}),N.model&&l.jsxs("div",{children:["Model: ",N.model]})]}),l.jsx("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid #eee",fontSize:"10px",color:"#999"},children:l.jsxs("div",{children:["Position: x=",N.x.toFixed(2),", y=",N.y.toFixed(2)]})})]})]},N.id)})})(),e.size>0&&o.filter(_=>e.has(_.id)&&_.type==="via"&&_.points.length>0).map(_=>{const N=_.points[0],te=_.viaType||(N.id!==void 0?E(N.id,m):"Via");return l.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:te})]}),$&&l.jsx("button",{onClick:()=>{$(_.id,N.x,N.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:ie=>{ie.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:ie=>{ie.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),l.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[N.id&&l.jsxs("div",{children:["Node ID: ",N.id]}),l.jsx("div",{children:"Layer: Top and Bottom"}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("span",{children:"Color:"}),l.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:_.color,border:"1px solid #ccc",borderRadius:2}}),l.jsx("span",{children:_.color})]}),l.jsxs("div",{children:["Size: ",_.size]}),l.jsxs("div",{children:["Position: x=",N.x.toFixed(2),", y=",N.y.toFixed(2)]}),l.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),l.jsx("input",{type:"text",value:_.notes||"",readOnly:!0,onClick:M,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},_.id)}),e.size>0&&o.filter(_=>e.has(_.id)&&_.type==="pad"&&_.points.length>0).map(_=>{const N=_.points[0],te=_.padType||(N.id!==void 0?x(N.id,m):"Pad");return l.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:te})]}),$&&l.jsx("button",{onClick:()=>{$(_.id,N.x,N.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:ie=>{ie.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:ie=>{ie.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),l.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[N.id&&l.jsxs("div",{children:["Node ID: ",N.id]}),l.jsxs("div",{children:["Layer: ",_.layer]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("span",{children:"Color:"}),l.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:_.color,border:"1px solid #ccc",borderRadius:2}}),l.jsx("span",{children:_.color})]}),l.jsxs("div",{children:["Size: ",_.size]}),l.jsxs("div",{children:["Position: x=",N.x.toFixed(2),", y=",N.y.toFixed(2)]}),l.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),l.jsx("input",{type:"text",value:_.notes||"",readOnly:!0,onClick:M,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},_.id)}),e.size>0&&o.filter(_=>e.has(_.id)&&_.type==="testPoint"&&_.points.length>0).map(_=>{const N=_.points[0],te=N.id!==void 0?k(N.id,m):"Test Point";return l.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:te})]}),$&&l.jsx("button",{onClick:()=>{$(_.id,N.x,N.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:ie=>{ie.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:ie=>{ie.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),l.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[N.id&&l.jsxs("div",{children:["Node ID: ",N.id]}),l.jsxs("div",{children:["Layer: ",_.layer]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("span",{children:"Color:"}),l.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:_.color,border:"1px solid #ccc",borderRadius:2}}),l.jsx("span",{children:_.color})]}),l.jsxs("div",{children:["Size: ",_.size]}),l.jsxs("div",{children:["Position: x=",N.x.toFixed(2),", y=",N.y.toFixed(2)]}),l.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),l.jsx("input",{type:"text",value:_.notes||"",readOnly:!0,onClick:M,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},_.id)}),e.size>0&&o.filter(_=>e.has(_.id)&&_.type==="trace").map(_=>{const N=_.points.length>0?_.points.reduce((ie,re)=>ie+re.x,0)/_.points.length:0,te=_.points.length>0?_.points.reduce((ie,re)=>ie+re.y,0)/_.points.length:0;return l.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:_.type||"unknown"})]}),$&&_.points.length>0&&l.jsx("button",{onClick:()=>{$(_.id,N,te)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:ie=>{ie.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:ie=>{ie.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),l.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[_.points.length>0&&l.jsxs("div",{style:{marginTop:"8px",marginBottom:"8px"},children:[l.jsxs("div",{style:{marginBottom:"4px",fontWeight:600},children:["Points: ",_.points.length]}),l.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px",border:"1px solid #ddd"},children:[l.jsx("thead",{children:l.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[l.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Point #"}),l.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"x"}),l.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"y"}),l.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Node ID"})]})}),l.jsx("tbody",{children:_.points.map((ie,re)=>l.jsxs("tr",{style:{backgroundColor:re%2===0?"#fff":"#f9f9f9"},children:[l.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:re}),l.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:ie.x.toFixed(2)}),l.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:ie.y.toFixed(2)}),l.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:ie.id||"(none)"})]},re))})]})]}),l.jsxs("div",{style:{marginTop:"4px"},children:["Layer: ",_.layer]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("span",{children:"Color:"}),l.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:_.color,border:"1px solid #ccc",borderRadius:2}}),l.jsx("span",{children:_.color})]}),l.jsxs("div",{children:["Size: ",_.size]}),l.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),l.jsx("input",{type:"text",value:_.notes||"",readOnly:!0,onClick:M,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},_.id)}),n.size>0&&h.filter(_=>n.has(_.id)).map(_=>{const N=m.find(te=>te.id===_.powerBusId);return l.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:_.type||(N?`${N.name} Power Node`:"Power Node")})]}),z&&l.jsx("button",{onClick:()=>{z(_.id,_.x,_.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:te=>{te.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:te=>{te.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),l.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[l.jsxs("div",{children:["Node ID: ",_.pointId||"(not assigned)"]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("span",{children:"Color:"}),l.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:_.color,border:"1px solid #ccc",borderRadius:2}}),l.jsx("span",{children:_.color})]}),l.jsxs("div",{children:["Size: ",_.size]}),l.jsxs("div",{children:["Layer: ",_.layer]}),l.jsxs("div",{children:["Power Bus: ",N?.name||_.powerBusId||"(unknown)"]}),l.jsxs("div",{children:["Position: x=",_.x.toFixed(2),", y=",_.y.toFixed(2)]}),l.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),l.jsx("input",{type:"text",value:_.notes||"",readOnly:!0,onClick:M,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},_.id)}),s.size>0&&f.filter(_=>s.has(_.id)).map(_=>l.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:_.type||"Ground Node"})]}),B&&l.jsx("button",{onClick:()=>{B(_.id,_.x,_.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:N=>{N.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:N=>{N.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),l.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[l.jsxs("div",{children:["Node ID: ",_.pointId||"(not assigned)"]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("span",{children:"Color:"}),l.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:_.color,border:"1px solid #ccc",borderRadius:2}}),l.jsx("span",{children:_.color})]}),l.jsxs("div",{children:["Size: ",_.size]}),l.jsxs("div",{children:["Position: x=",_.x.toFixed(2),", y=",_.y.toFixed(2)]}),l.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),l.jsx("input",{type:"text",value:_.notes||"",readOnly:!0,onClick:M,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},_.id))]})})]})},Lr=200,m3=({visible:r,selectedIds:e,selectedComponentIds:t,selectedPowerIds:n,selectedGroundIds:s,drawingStrokes:o,componentsTop:d,componentsBottom:c,powers:h,grounds:f,powerBuses:m,onClose:b,setComponentsTop:A,setComponentsBottom:v,setDrawingStrokes:E,setPowerSymbols:x,setGroundSymbols:k,determineViaType:j,determinePadType:$,determineTestPointType:z,position:B,isDragging:F,onDragStart:I})=>{const[X,M]=K.useState(new Map),G=K.useRef(""),U=()=>[...Array.from(e).sort(),...Array.from(t).sort(),...Array.from(n).sort(),...Array.from(s).sort()].join(",");if(K.useEffect(()=>{if(!r)return;const xe=U();xe!==G.current&&(G.current=xe,M(Z=>{const D=new Map;return[...d,...c].filter(H=>t.has(H.id)).forEach(H=>{const Y=Z.get(H.id);D.set(H.id,Y!==void 0?Y:H.notes||"")}),o.filter(H=>e.has(H.id)).forEach(H=>{const Y=Z.get(H.id);D.set(H.id,Y!==void 0?Y:H.notes||"")}),h.filter(H=>n.has(H.id)).forEach(H=>{const Y=Z.get(H.id);D.set(H.id,Y!==void 0?Y:H.notes||"")}),f.filter(H=>s.has(H.id)).forEach(H=>{const Y=Z.get(H.id);D.set(H.id,Y!==void 0?Y:H.notes||"")}),D}))},[r,e,t,n,s,o,d,c,h,f]),!r)return null;const _=B?{position:"fixed",left:`${B.x}px`,top:`${B.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"150px",maxWidth:"400px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:F?"grabbing":"default"}:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"flex-start",justifyContent:"flex-end",paddingRight:"20px",paddingTop:"80px",zIndex:1e4,pointerEvents:"none"},N={padding:"20px",overflow:"auto",flex:1},te=o.filter(xe=>e.has(xe.id)).length,ie=[...d,...c].filter(xe=>t.has(xe.id)).length,re=h.filter(xe=>n.has(xe.id)).length,q=f.filter(xe=>s.has(xe.id)).length,J=te+ie+re+q,ce=(xe,Z)=>{const D=Z.length>Lr?Z.substring(0,Lr):Z;M(H=>{const Y=new Map(H);return Y.set(xe,D),Y})},_e=()=>{A(xe=>xe.map(Z=>{if(t.has(Z.id)&&X.has(Z.id)){const D=X.get(Z.id)||"";return{...Z,notes:D.trim()===""?void 0:D.trim()}}return Z})),v(xe=>xe.map(Z=>{if(t.has(Z.id)&&X.has(Z.id)){const D=X.get(Z.id)||"";return{...Z,notes:D.trim()===""?void 0:D.trim()}}return Z})),E(xe=>xe.map(Z=>{if(e.has(Z.id)&&X.has(Z.id)){const D=X.get(Z.id)||"";return{...Z,notes:D.trim()===""?null:D.trim()}}return Z})),x(xe=>xe.map(Z=>{if(n.has(Z.id)&&X.has(Z.id)){const D=X.get(Z.id)||"";return{...Z,notes:D.trim()===""?null:D.trim()}}return Z})),k(xe=>xe.map(Z=>{if(s.has(Z.id)&&X.has(Z.id)){const D=X.get(Z.id)||"";return{...Z,notes:D.trim()===""?null:D.trim()}}return Z}))};return l.jsxs("div",{style:_,children:[l.jsxs("div",{onMouseDown:xe=>{const Z=xe.target;Z.tagName==="BUTTON"||Z.closest("button")||B&&I(xe)},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:F?"grabbing":B?"grab":"default",userSelect:"none",flexShrink:0},children:[l.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Notes (N)"}),l.jsx("button",{onClick:b,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),l.jsx("div",{style:N,children:l.jsxs("div",{style:{margin:0,padding:0,backgroundColor:"#f5f5f5",borderRadius:4,fontSize:"12px",fontFamily:"monospace",maxHeight:"calc(80vh - 100px)",overflow:"auto",color:"#000"},children:[l.jsx("div",{style:{padding:"12px 16px",backgroundColor:J>0?"#e8e8e8":"#fff3cd",borderBottom:"2px solid #ccc",fontSize:"13px",fontWeight:600,color:J>0?"#333":"#856404",marginBottom:"8px"},children:J>0?`${J} Object${J!==1?"s":""} Selected`:"Zero Objects Selected"}),J===0?l.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"No objects selected. Select one or more objects to add or edit notes."}):l.jsxs(l.Fragment,{children:[[...d,...c].filter(xe=>t.has(xe.id)).map(xe=>{const Z=X.get(xe.id)||"",D=Z.length;return l.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),l.jsxs("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:[yc(xe.componentType),xe.designator&&xe.designator.trim()?` (${xe.designator.trim()})`:""]})]}),l.jsxs("div",{style:{padding:"8px"},children:[l.jsx("textarea",{value:Z,onChange:H=>ce(xe.id,H.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Lr,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),l.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:D>=Lr?"#d32f2f":"#666",textAlign:"right"},children:[D," / ",Lr]})]})]},xe.id)}),o.filter(xe=>e.has(xe.id)&&xe.type==="via"&&xe.points.length>0).map(xe=>{const Z=xe.points[0],D=xe.viaType||(Z.id!==void 0?j(Z.id,m):"Via"),H=X.get(xe.id)||"",Y=H.length;return l.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:D})]}),l.jsxs("div",{style:{padding:"8px"},children:[l.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:Z.id&&l.jsxs("div",{children:["Node ID: ",Z.id]})}),l.jsx("textarea",{value:H,onChange:ue=>ce(xe.id,ue.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Lr,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),l.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Y>=Lr?"#d32f2f":"#666",textAlign:"right"},children:[Y," / ",Lr]})]})]},xe.id)}),o.filter(xe=>e.has(xe.id)&&xe.type==="pad"&&xe.points.length>0).map(xe=>{const Z=xe.points[0],D=xe.padType||(Z.id!==void 0?$(Z.id,m):"Pad"),H=X.get(xe.id)||"",Y=H.length;return l.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:D})]}),l.jsxs("div",{style:{padding:"8px"},children:[l.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:Z.id&&l.jsxs("div",{children:["Node ID: ",Z.id]})}),l.jsx("textarea",{value:H,onChange:ue=>ce(xe.id,ue.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Lr,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),l.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Y>=Lr?"#d32f2f":"#666",textAlign:"right"},children:[Y," / ",Lr]})]})]},xe.id)}),o.filter(xe=>e.has(xe.id)&&xe.type==="testPoint"&&xe.points.length>0).map(xe=>{const Z=xe.points[0],D=Z.id!==void 0?z(Z.id,m):"Test Point",H=X.get(xe.id)||"",Y=H.length;return l.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:D})]}),l.jsxs("div",{style:{padding:"8px"},children:[l.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:Z.id&&l.jsxs("div",{children:["Node ID: ",Z.id]})}),l.jsx("textarea",{value:H,onChange:ue=>ce(xe.id,ue.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Lr,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),l.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Y>=Lr?"#d32f2f":"#666",textAlign:"right"},children:[Y," / ",Lr]})]})]},xe.id)}),o.filter(xe=>e.has(xe.id)&&xe.type==="trace").map(xe=>{const Z=X.get(xe.id)||"",D=Z.length;return l.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:xe.type||"unknown"})]}),l.jsxs("div",{style:{padding:"8px"},children:[l.jsx("textarea",{value:Z,onChange:H=>ce(xe.id,H.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Lr,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),l.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:D>=Lr?"#d32f2f":"#666",textAlign:"right"},children:[D," / ",Lr]})]})]},xe.id)}),h.filter(xe=>n.has(xe.id)).map(xe=>{const Z=m.find(ue=>ue.id===xe.powerBusId),D=xe.type||(Z?`${Z.name} Power Node`:"Power Node"),H=X.get(xe.id)||"",Y=H.length;return l.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:D})]}),l.jsxs("div",{style:{padding:"8px"},children:[l.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:l.jsxs("div",{children:["Node ID: ",xe.pointId||"(not assigned)"]})}),l.jsx("textarea",{value:H,onChange:ue=>ce(xe.id,ue.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Lr,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),l.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Y>=Lr?"#d32f2f":"#666",textAlign:"right"},children:[Y," / ",Lr]})]})]},xe.id)}),f.filter(xe=>s.has(xe.id)).map(xe=>{const Z=xe.type||"Ground Node",D=X.get(xe.id)||"",H=D.length;return l.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[l.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[l.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),l.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:Z})]}),l.jsxs("div",{style:{padding:"8px"},children:[l.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:l.jsxs("div",{children:["Node ID: ",xe.pointId||"(not assigned)"]})}),l.jsx("textarea",{value:D,onChange:Y=>ce(xe.id,Y.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Lr,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),l.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:H>=Lr?"#d32f2f":"#666",textAlign:"right"},children:[H," / ",Lr]})]})]},xe.id)}),l.jsxs("div",{style:{marginTop:"20px",padding:"12px",display:"flex",justifyContent:"flex-end",gap:"8px",borderTop:"1px solid #ddd"},children:[l.jsx("button",{onClick:b,style:{padding:"8px 16px",fontSize:"12px",backgroundColor:"#757575",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500},onMouseEnter:xe=>{xe.currentTarget.style.backgroundColor="#616161"},onMouseLeave:xe=>{xe.currentTarget.style.backgroundColor="#757575"},children:"Close"}),l.jsx("button",{onClick:_e,style:{padding:"8px 16px",fontSize:"12px",backgroundColor:"#2196F3",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500},onMouseEnter:xe=>{xe.currentTarget.style.backgroundColor="#1976D2"},onMouseLeave:xe=>{xe.currentTarget.style.backgroundColor="#2196F3"},children:"Save"})]})]})]})})]})},y3=({visible:r,projectNotes:e,setProjectNotes:t,onClose:n,position:s,isDragging:o,onDragStart:d})=>{const[c,h]=K.useState([]),[f,m]=K.useState(null),[b,A]=K.useState(null),v=K.useRef(new Map),[E,x]=K.useState({width:Math.min(window.innerWidth*.85,1400),height:window.innerHeight*.7}),[k,j]=K.useState(!1),[$,z]=K.useState({x:0,y:0,width:0,height:0});K.useEffect(()=>{r&&(h([...e]),m(null),A(null))},[r,e]),K.useEffect(()=>{if(!k)return;const re=J=>{const ce=J.clientX-$.x,_e=J.clientY-$.y,xe=Math.max(400,Math.min(window.innerWidth-20,$.width+ce)),Z=Math.max(300,Math.min(window.innerHeight-20,$.height+_e));x({width:xe,height:Z})},q=()=>{j(!1)};return document.addEventListener("mousemove",re),document.addEventListener("mouseup",q),()=>{document.removeEventListener("mousemove",re),document.removeEventListener("mouseup",q)}},[k,$]);const B=re=>{re.preventDefault(),re.stopPropagation(),j(!0),z({x:re.clientX,y:re.clientY,width:E.width,height:E.height})};if(!r)return null;const F=()=>{const re={name:"",value:"",checked:!1};h([...c,re]),m(c.length),A("name")},I=re=>{const q=c.filter((J,ce)=>ce!==re);h(q),f===re?(m(null),A(null)):f!==null&&f>re&&m(f-1)},X=()=>{const re=c.filter(q=>q.name.trim()!==""||q.value.trim()!=="");t(re),n()},M=()=>{h([...e]),m(null),A(null),n()},G=(re,q,J)=>{const ce=[...c];ce[re]={...ce[re],[q]:J},h(ce)},U=(re,q)=>{const J=[...c];J[re]={...J[re],checked:q},h(J)},_=(re,q,J)=>{re.stopPropagation();const ce=re.currentTarget,_e=ce.selectionStart,xe=ce.value.length,Z=ce.selectionStart!==ce.selectionEnd;if(!(re.key==="Enter"&&re.altKey)){if(re.key==="ArrowRight"&&!re.ctrlKey&&!re.shiftKey&&!re.altKey){if(_e===xe&&!Z&&J==="name"){re.preventDefault();const D=`${q}-value`,H=v.current.get(D);H&&(H.focus(),H.setSelectionRange(0,0))}return}if(re.key==="ArrowLeft"&&!re.ctrlKey&&!re.shiftKey&&!re.altKey){if(_e===0&&!Z&&J==="value"){re.preventDefault();const D=`${q}-name`,H=v.current.get(D);H&&(H.focus(),H.setSelectionRange(H.value.length,H.value.length))}return}if(re.key==="ArrowDown"&&!re.ctrlKey&&!re.shiftKey&&!re.altKey){if(re.preventDefault(),q<c.length-1){const D=`${q+1}-${J}`,H=v.current.get(D);if(H){H.focus();const Y=Math.min(_e,H.value.length);H.setSelectionRange(Y,Y)}}else{const D=c.length;F(),setTimeout(()=>{const H=`${D}-${J}`,Y=v.current.get(H);Y&&(Y.focus(),Y.setSelectionRange(0,0))},0)}return}if(re.key==="ArrowUp"&&!re.ctrlKey&&!re.shiftKey&&!re.altKey){if(re.preventDefault(),q>0){const D=`${q-1}-${J}`,H=v.current.get(D);if(H){H.focus();const Y=Math.min(_e,H.value.length);H.setSelectionRange(Y,Y)}}return}if(re.key==="Enter"&&!re.altKey&&!re.shiftKey){if(re.preventDefault(),J==="name"){const D=`${q}-value`,H=v.current.get(D);H&&(H.focus(),H.setSelectionRange(0,0))}else if(J==="value")if(q<c.length-1){const D=`${q+1}-name`,H=v.current.get(D);H&&(H.focus(),H.setSelectionRange(0,0))}else{const D=c.length;F(),setTimeout(()=>{const H=`${D}-name`,Y=v.current.get(H);Y&&(Y.focus(),Y.setSelectionRange(0,0))},0)}return}if(re.key==="Tab"&&!re.shiftKey){if(re.preventDefault(),J==="name"){const D=`${q}-value`,H=v.current.get(D);H&&(H.focus(),H.select())}else if(J==="value")if(q<c.length-1){const D=`${q+1}-name`,H=v.current.get(D);H&&(H.focus(),H.select())}else{const D=c.length;F(),setTimeout(()=>{const H=`${D}-name`,Y=v.current.get(H);Y&&Y.focus()},0)}return}if(re.key==="Tab"&&re.shiftKey){if(re.preventDefault(),J==="value"){const D=`${q}-name`,H=v.current.get(D);H&&(H.focus(),H.select())}else if(J==="name"&&q>0){const D=`${q-1}-value`,H=v.current.get(D);H&&(H.focus(),H.select())}return}}},N=(re,q)=>{m(re),A(q)},te=()=>{},ie={position:"fixed",top:s?.y??100,left:s?.x??(window.innerWidth-E.width)/2,width:`${E.width}px`,height:`${E.height}px`,backgroundColor:"#fff",borderRadius:8,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:o?"grabbing":"default",overflow:"hidden"};return l.jsxs("div",{style:ie,children:[l.jsxs("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e0e0",background:"#888",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"move",userSelect:"none"},onMouseDown:d,children:[l.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Project Notes / TODO List (L)"}),l.jsx("button",{onClick:M,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:"0 4px",lineHeight:1},title:"Close",children:""})]}),l.jsxs("div",{className:"project-notes-content",style:{padding:0,flex:1,overflowY:"auto",overflowX:"hidden",display:"flex",flexDirection:"column",minHeight:0,scrollbarWidth:"thin",scrollbarColor:"#888 #f0f0f0"},children:[l.jsxs("div",{style:{border:"none",borderTop:"1px solid #ccc",borderRadius:0,overflow:"visible",marginBottom:"16px",backgroundColor:"#e0e0e0",flexShrink:0},children:[l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"40px 1fr 3fr auto",backgroundColor:"#e0e0e0",borderBottom:"1px solid #ccc",position:"sticky",top:0,zIndex:10},children:[l.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",display:"flex",alignItems:"center",justifyContent:"center",color:"#000"},children:l.jsx("label",{className:"radio-label",style:{margin:0,cursor:"default"},children:l.jsx("input",{type:"checkbox",disabled:!0,style:{opacity:.5}})})}),l.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",color:"#000"},children:"Item"}),l.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",color:"#000"},children:"Notes"}),l.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",color:"#000"}})]}),l.jsx("div",{children:c.length===0?l.jsx("div",{style:{padding:"24px",textAlign:"center",color:"#999",fontSize:"13px"},children:'No notes. Click "Add Note" to create one.'}):c.map((re,q)=>l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"40px 1fr 3fr auto",borderBottom:"1px solid #ccc",backgroundColor:"#fff"},children:[l.jsx("div",{style:{padding:"8px 12px",borderRight:"1px solid #ccc",display:"flex",alignItems:"center",justifyContent:"center"},children:l.jsx("label",{className:"radio-label",style:{margin:0,cursor:"pointer"},children:l.jsx("input",{type:"checkbox",checked:re.checked||!1,onChange:J=>U(q,J.target.checked)})})}),l.jsx("div",{style:{padding:"4px",borderRight:"1px solid #ccc"},children:l.jsx("textarea",{ref:J=>{J?v.current.set(`${q}-name`,J):v.current.delete(`${q}-name`)},value:re.name,onChange:J=>G(q,"name",J.target.value),onFocus:()=>N(q,"name"),onBlur:te,onKeyDown:J=>_(J,q,"name"),placeholder:"Item name...",rows:1,style:{width:"100%",padding:"4px 6px",border:f===q&&b==="name"?"2px solid #0b5fff":"1px solid transparent",borderRadius:3,fontSize:"12px",backgroundColor:"#fff",color:"#000",fontFamily:"inherit",resize:"none",minHeight:"24px",lineHeight:"1.4",overflow:"hidden",outline:"none",boxSizing:"border-box"},onInput:J=>{const ce=J.target;ce.style.height="auto",ce.style.height=`${ce.scrollHeight}px`}})}),l.jsx("div",{style:{padding:"4px",borderRight:"1px solid #ccc"},children:l.jsx("textarea",{ref:J=>{J?v.current.set(`${q}-value`,J):v.current.delete(`${q}-value`)},value:re.value,onChange:J=>G(q,"value",J.target.value),onFocus:()=>N(q,"value"),onBlur:te,onKeyDown:J=>_(J,q,"value"),placeholder:"Notes...",rows:1,style:{width:"100%",padding:"4px 6px",border:f===q&&b==="value"?"2px solid #0b5fff":"1px solid transparent",borderRadius:3,fontSize:"12px",backgroundColor:"#fff",color:"#000",fontFamily:"inherit",resize:"none",minHeight:"24px",lineHeight:"1.4",overflow:"hidden",outline:"none",boxSizing:"border-box"},onInput:J=>{const ce=J.target;ce.style.height="auto",ce.style.height=`${ce.scrollHeight}px`}})}),l.jsx("div",{style:{padding:"8px 12px",display:"flex",alignItems:"center",justifyContent:"center"},children:l.jsx("button",{onClick:()=>I(q),style:{background:"#f44336",color:"#fff",border:"none",borderRadius:3,padding:"4px 8px",cursor:"pointer",fontSize:"11px"},title:"Delete note",children:"Delete"})})]},q))})]}),l.jsx("div",{style:{padding:"16px",flexShrink:0},children:l.jsx("button",{onClick:F,style:{background:"#888",color:"#fff",border:"none",borderRadius:4,padding:"8px 16px",cursor:"pointer",fontSize:"12px",fontWeight:500,alignSelf:"flex-start"},children:"+ Add Note"})})]}),l.jsxs("div",{style:{padding:"12px 16px",borderTop:"1px solid #ddd",display:"flex",justifyContent:"flex-end",gap:"8px",flexShrink:0},children:[l.jsx("button",{onClick:M,style:{background:"#f5f5f5",color:"#000",border:"1px solid #ddd",borderRadius:4,padding:"6px 16px",cursor:"pointer",fontSize:"12px"},children:"Cancel"}),l.jsx("button",{onClick:X,style:{background:"#0b5fff",color:"#fff",border:"none",borderRadius:4,padding:"6px 16px",cursor:"pointer",fontSize:"12px",fontWeight:500},children:"Save"})]}),l.jsx("div",{onMouseDown:B,style:{position:"absolute",bottom:0,right:0,width:"20px",height:"20px",cursor:"nwse-resize",background:"linear-gradient(135deg, transparent 0%, transparent 40%, #ccc 40%, #ccc 45%, transparent 45%, transparent 55%, #ccc 55%, #ccc 60%, transparent 60%)",zIndex:10001},title:"Drag to resize"})]})},x3=({visible:r,dimensions:e,onSave:t,onClose:n})=>{const[s,o]=K.useState(""),[d,c]=K.useState(""),[h,f]=K.useState("inches");K.useEffect(()=>{r&&e?(o(e.width.toString()),c(e.height.toString()),f(e.unit)):r&&(o(""),c(""),f("inches"))},[r,e]);const m=()=>{const A=parseFloat(s),v=parseFloat(d);if(isNaN(A)||A<=0){alert("Please enter a valid width greater than 0");return}if(isNaN(v)||v<=0){alert("Please enter a valid height greater than 0");return}t({width:A,height:v,unit:h}),n()},b=()=>{n()};return r?l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:A=>{A.target===A.currentTarget&&b()},children:l.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"320px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #444"},onClick:A=>A.stopPropagation(),children:[l.jsx("h3",{style:{margin:"0 0 20px 0",color:"#fff",fontSize:"18px",fontWeight:600},children:"Board Dimensions"}),l.jsxs("div",{style:{marginBottom:"16px"},children:[l.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#ddd",fontSize:"14px"},children:"Width"}),l.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[l.jsx("input",{type:"number",step:"0.001",min:"0.001",value:s,onChange:A=>o(A.target.value),style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px"},placeholder:"0.000"}),l.jsxs("select",{value:h,onChange:A=>f(A.target.value),style:{padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px",cursor:"pointer"},children:[l.jsx("option",{value:"inches",children:"inches"}),l.jsx("option",{value:"mm",children:"mm"})]})]})]}),l.jsxs("div",{style:{marginBottom:"20px"},children:[l.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#ddd",fontSize:"14px"},children:"Height"}),l.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[l.jsx("input",{type:"number",step:"0.001",min:"0.001",value:d,onChange:A=>c(A.target.value),style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px"},placeholder:"0.000"}),l.jsxs("select",{value:h,onChange:A=>f(A.target.value),style:{padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px",cursor:"pointer"},children:[l.jsx("option",{value:"inches",children:"inches"}),l.jsx("option",{value:"mm",children:"mm"})]})]})]}),l.jsx("div",{style:{marginBottom:"12px",padding:"10px",background:"#1f1f24",borderRadius:4,fontSize:"12px",color:"#bbb"},children:"This information will be used to convert pixel coordinates to real-world measurements."}),l.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[l.jsx("button",{onClick:b,style:{padding:"8px 16px",background:"#444",color:"#fff",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px"},children:"Cancel"}),l.jsx("button",{onClick:m,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Save"})]})]})}):null},b3=({visible:r,onClose:e,topImage:t,bottomImage:n,selectedImageForTransform:s,setSelectedImageForTransform:o,transformMode:d,setTransformMode:c,updateImageTransform:h,resetImageTransform:f,setCurrentTool:m,isGrayscale:b,setIsGrayscale:A,areImagesLocked:v})=>{const[E,x]=K.useState(null),[k,j]=K.useState(!1),$=K.useRef({x:0,y:0}),z=K.useRef(null);K.useEffect(()=>{r&&E===null&&x({x:window.innerWidth-320-20,y:80})},[r,E]),K.useEffect(()=>{r||x(null)},[r]);const B=K.useCallback(Y=>{if(z.current){const ue=z.current.getBoundingClientRect();$.current={x:Y.clientX-ue.left,y:Y.clientY-ue.top},j(!0)}},[]);if(K.useEffect(()=>{if(!k)return;const Y=Ne=>{const Pe=Ne.clientX-$.current.x,Ue=Ne.clientY-$.current.y,Re=z.current?.offsetWidth||320,Ke=z.current?.offsetHeight||600,Je=Math.max(0,Math.min(Pe,window.innerWidth-Re)),st=Math.max(0,Math.min(Ue,window.innerHeight-Ke));x({x:Je,y:st})},ue=()=>{j(!1)};return document.addEventListener("mousemove",Y),document.addEventListener("mouseup",ue),()=>{document.removeEventListener("mousemove",Y),document.removeEventListener("mouseup",ue)}},[k]),!r)return null;const F=t!==null,I=n!==null,X=F||I,M=F&&I,G=s||(F?"top":I?"bottom":null),U=()=>G==="top"&&t?t.brightness??100:G==="bottom"&&n?n.brightness??100:G==="both"&&t?t.brightness??100:100,_=()=>G==="top"&&t?t.contrast??100:G==="bottom"&&n?n.contrast??100:G==="both"&&t?t.contrast??100:100,N=U(),te=_(),ie=!X||v,re=()=>{if(!(!G||ie))if(G==="both"){const Y=!t?.flipX;h("both",{flipX:Y})}else{const Y=G==="top"?t?.flipX||!1:n?.flipX||!1;h(G,{flipX:!Y})}},q=()=>{if(!(!G||ie))if(G==="both"){const Y=!t?.flipY;h("both",{flipY:Y})}else{const Y=G==="top"?t?.flipY||!1:n?.flipY||!1;h(G,{flipY:!Y})}},J=Y=>{ie||(G&&o(G),c(Y),m("transform"))},ce=Y=>{!G||ie||h(G,{brightness:Y})},_e=Y=>{!G||ie||h(G,{contrast:Y})},xe=()=>{ie||(G&&o(G),m("transform"),A(!b))},Z=()=>{ie||(m("transform"),f())},D=(Y,ue=!1)=>({display:"block",width:"100%",textAlign:"left",padding:"8px 12px",color:Y?"#666":"#f2f2f2",background:ue?"#3a3a42":"transparent",border:"none",borderRadius:4,cursor:Y?"not-allowed":"pointer",fontSize:"13px",transition:"background 0.15s"}),H=(Y,ue)=>({display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",color:Y?"#666":"#f2f2f2",cursor:Y?"not-allowed":"pointer",fontSize:"13px",background:ue?"#3a3a42":"transparent",borderRadius:4,transition:"background 0.15s"});return l.jsxs("div",{ref:z,style:{position:"fixed",top:E?.y??80,left:E?.x??window.innerWidth-340,backgroundColor:"#2b2b31",borderRadius:8,minWidth:"320px",maxWidth:"400px",maxHeight:"calc(100vh - 100px)",overflowY:"auto",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24",zIndex:10001},children:[l.jsxs("div",{onMouseDown:B,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 16px",background:"linear-gradient(to bottom, #3a3a42, #2b2b31)",borderTopLeftRadius:8,borderTopRightRadius:8,borderBottom:"1px solid #1f1f24",cursor:k?"grabbing":"grab",userSelect:"none"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[l.jsx("span",{style:{color:"#888",fontSize:"14px"},children:""}),l.jsx("h2",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#f2f2f2"},children:"Transform Images"})]}),l.jsx("button",{onClick:e,style:{background:"transparent",border:"none",color:"#888",fontSize:"16px",cursor:"pointer",padding:"2px 6px",lineHeight:1,borderRadius:4},onMouseEnter:Y=>{Y.currentTarget.style.background="#444",Y.currentTarget.style.color="#fff"},onMouseLeave:Y=>{Y.currentTarget.style.background="transparent",Y.currentTarget.style.color="#888"},children:""})]}),l.jsxs("div",{style:{padding:"16px"},children:[l.jsxs("div",{style:{marginBottom:"16px"},children:[l.jsx("div",{style:{fontSize:"12px",color:"#888",marginBottom:"8px",fontWeight:500},children:"Apply to:"}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[l.jsxs("label",{style:H(!F,G==="top"),children:[l.jsx("input",{type:"radio",name:"imageSelection",checked:G==="top",onChange:()=>o("top"),disabled:!F,style:{accentColor:"#6b9fff"}}),"Top Image",!F&&l.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(not loaded)"})]}),l.jsxs("label",{style:H(!I,G==="bottom"),children:[l.jsx("input",{type:"radio",name:"imageSelection",checked:G==="bottom",onChange:()=>o("bottom"),disabled:!I,style:{accentColor:"#6b9fff"}}),"Bottom Image",!I&&l.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(not loaded)"})]}),l.jsxs("label",{style:H(!M,G==="both"),children:[l.jsx("input",{type:"radio",name:"imageSelection",checked:G==="both",onChange:()=>o("both"),disabled:!M,style:{accentColor:"#6b9fff"}}),"Both Images",!M&&l.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(need both)"})]})]})]}),l.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),l.jsxs("div",{style:{marginBottom:"12px"},children:[l.jsx("button",{onClick:re,disabled:ie,style:D(ie),onMouseEnter:Y=>!ie&&(Y.currentTarget.style.background="#3a3a42"),onMouseLeave:Y=>Y.currentTarget.style.background="transparent",children:"Horizontal Flip"}),l.jsx("button",{onClick:q,disabled:ie,style:D(ie),onMouseEnter:Y=>!ie&&(Y.currentTarget.style.background="#3a3a42"),onMouseLeave:Y=>Y.currentTarget.style.background="transparent",children:"Vertical Flip"})]}),l.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),l.jsx("div",{style:{marginBottom:"12px"},children:["nudge","scale","rotate","slant","keystone"].map(Y=>l.jsxs("button",{onClick:()=>J(Y),disabled:ie,style:D(ie,d===Y),onMouseEnter:ue=>!ie&&d!==Y&&(ue.currentTarget.style.background="#3a3a42"),onMouseLeave:ue=>d!==Y&&(ue.currentTarget.style.background="transparent"),children:[d===Y?" ":"","Mode: ",Y.charAt(0).toUpperCase()+Y.slice(1)]},Y))}),l.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),l.jsxs("div",{style:{marginBottom:"16px"},children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[l.jsx("label",{style:{color:"#f2f2f2",fontSize:"13px",fontWeight:500},children:"Brightness"}),l.jsxs("span",{style:{color:"#888",fontSize:"12px",minWidth:"45px",textAlign:"right"},children:[N,"%"]})]}),l.jsx("input",{type:"range",min:"0",max:"200",step:"1",value:N,onChange:Y=>ce(parseInt(Y.target.value,10)),disabled:ie,style:{width:"100%",cursor:ie?"not-allowed":"pointer",accentColor:"#6b9fff"}})]}),l.jsxs("div",{style:{marginBottom:"16px"},children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[l.jsx("label",{style:{color:"#f2f2f2",fontSize:"13px",fontWeight:500},children:"Contrast"}),l.jsxs("span",{style:{color:"#888",fontSize:"12px",minWidth:"45px",textAlign:"right"},children:[te,"%"]})]}),l.jsx("input",{type:"range",min:"0",max:"200",step:"1",value:te,onChange:Y=>_e(parseInt(Y.target.value,10)),disabled:ie,style:{width:"100%",cursor:ie?"not-allowed":"pointer",accentColor:"#6b9fff"}})]}),l.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),l.jsx("div",{style:{marginBottom:"12px"},children:l.jsxs("button",{onClick:xe,disabled:ie,style:D(ie,b),onMouseEnter:Y=>!ie&&!b&&(Y.currentTarget.style.background="#3a3a42"),onMouseLeave:Y=>!b&&(Y.currentTarget.style.background="transparent"),children:[b?" ":"","Grayscale Mode"]})}),l.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),l.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[l.jsx("button",{onClick:Z,disabled:ie,style:{padding:"8px 16px",background:ie?"#444":"#555",color:ie?"#777":"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:ie?"not-allowed":"pointer",fontSize:"13px",fontWeight:500},children:"Reset Transform"}),l.jsx("button",{onClick:e,style:{padding:"8px 16px",background:"#4a9eff",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:500},onMouseEnter:Y=>Y.currentTarget.style.background="#3a8ee6",onMouseLeave:Y=>Y.currentTarget.style.background="#4a9eff",children:"Close"})]}),v&&l.jsx("div",{style:{marginTop:"12px",padding:"8px 12px",background:"#3d2b2b",border:"1px solid #5a3a3a",borderRadius:4,fontSize:"12px",color:"#e88"},children:" Images are locked. Unlock via Images  Lock Images to make changes."})]})]})},v3=({visible:r,onClose:e,topImage:t,bottomImage:n,setTopImage:s,setBottomImage:o,componentsTop:d,componentsBottom:c,setComponentsTop:h,setComponentsBottom:f,drawingStrokes:m,setDrawingStrokes:b,powerSymbols:A,groundSymbols:v,setPowerSymbols:E,setGroundSymbols:x,canvasRef:k,isBottomView:j,setIsBottomView:$,originalTopFlipX:z,setOriginalTopFlipX:B,originalBottomFlipX:F,setOriginalBottomFlipX:I,originalTopFlipY:X,setOriginalTopFlipY:M,originalBottomFlipY:G,setOriginalBottomFlipY:U,cameraWorldCenter:_,setCameraWorldCenter:N,viewScale:te,viewRotation:ie,setViewRotation:re,viewFlipX:q,setViewFlipX:J,contentBorder:ce,setTransparency:_e})=>{const[xe,Z]=K.useState(null),[D,H]=K.useState(!1),Y=K.useRef({x:0,y:0}),ue=K.useRef(null),Ne=K.useCallback((st,yt,Nt,pe)=>{const St=window.innerWidth,Ut=window.innerHeight,Lt=10,at=Math.max(Lt,Math.min(st,St-Nt-Lt)),en=Math.max(Lt,Math.min(yt,Ut-pe-Lt));return{x:at,y:en}},[]);K.useEffect(()=>{if(r&&xe===null){const st=localStorage.getItem("transformAllDialogPosition"),yt=320,Nt=400,pe=20,St=150;let Ut;if(st)try{const Lt=JSON.parse(st);Ut=Ne(Lt.x,Lt.y,yt,Nt)}catch{Ut=Ne(window.innerWidth-yt-pe,St,yt,Nt)}else Ut=Ne(window.innerWidth-yt-pe,St,yt,Nt);Z(Ut)}},[r,xe,Ne]);const Pe=K.useCallback(st=>{if(ue.current){const yt=ue.current.getBoundingClientRect();Y.current={x:st.clientX-yt.left,y:st.clientY-yt.top},H(!0)}},[]);K.useEffect(()=>{if(!D)return;const st=Nt=>{const pe=Nt.clientX-Y.current.x,St=Nt.clientY-Y.current.y,Ut=ue.current?.offsetWidth||320,Lt=ue.current?.offsetHeight||400,at=Ne(pe,St,Ut,Lt);Z(at),localStorage.setItem("transformAllDialogPosition",JSON.stringify(at))},yt=()=>{H(!1)};return document.addEventListener("mousemove",st),document.addEventListener("mouseup",yt),()=>{document.removeEventListener("mousemove",st),document.removeEventListener("mouseup",yt)}},[D,Ne]);const Ue=K.useCallback(()=>{j||(J(!0),$(!0),_e(100))},[j,J,$,_e]),Re=K.useCallback(()=>{j&&(J(!1),$(!1),_e(0))},[j,J,$,_e]),Ke=K.useCallback(st=>{re(yt=>Om(yt,st))},[re,Om]);if(!r)return null;const Je=(st=!1)=>({display:"block",width:"100%",textAlign:"left",padding:"8px 12px",color:st?"#999":"#222",background:"transparent",border:"none",borderRadius:4,cursor:st?"not-allowed":"pointer",fontSize:"13px",transition:"background 0.15s"});return l.jsxs("div",{ref:ue,style:{position:"fixed",top:xe?.y??150,left:xe?.x??window.innerWidth-340,backgroundColor:"#fff",borderRadius:8,minWidth:"320px",maxWidth:"400px",maxHeight:"calc(100vh - 100px)",overflowY:"auto",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:10001,display:"flex",flexDirection:"column"},children:[l.jsxs("div",{onMouseDown:Pe,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:D?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[l.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Change Perspective"}),l.jsx("button",{onClick:e,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),l.jsxs("div",{style:{padding:"20px",overflow:"auto",flex:1},children:[l.jsxs("div",{style:{marginBottom:"16px"},children:[l.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"8px",fontWeight:500},children:"View:"}),l.jsx("button",{onClick:j?Re:Ue,style:Je(!1),onMouseEnter:st=>st.currentTarget.style.background="#f0f0f0",onMouseLeave:st=>st.currentTarget.style.background="transparent",children:j?"Switch to Top View":"Switch to Bottom View"}),l.jsx("div",{style:{fontSize:"10px",color:"#999",marginTop:"6px",fontStyle:"italic"},children:"Shortcut: Shift-Left/Right Arrow Keys"})]}),l.jsx("div",{style:{height:1,background:"#e0e0e0",margin:"16px 0"}}),l.jsxs("div",{style:{marginBottom:"16px"},children:[l.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"8px",fontWeight:500},children:"Rotate (clockwise):"}),l.jsx("button",{onClick:()=>Ke(90),style:Je(),onMouseEnter:st=>st.currentTarget.style.background="#f0f0f0",onMouseLeave:st=>st.currentTarget.style.background="transparent",children:"Rotate 90"}),l.jsx("button",{onClick:()=>Ke(180),style:Je(),onMouseEnter:st=>st.currentTarget.style.background="#f0f0f0",onMouseLeave:st=>st.currentTarget.style.background="transparent",children:"Rotate 180"}),l.jsx("button",{onClick:()=>Ke(270),style:Je(),onMouseEnter:st=>st.currentTarget.style.background="#f0f0f0",onMouseLeave:st=>st.currentTarget.style.background="transparent",children:"Rotate 270"}),l.jsx("div",{style:{fontSize:"10px",color:"#999",marginTop:"6px",fontStyle:"italic"},children:"Shortcut: Shift-Up/Down Arrow Keys"})]}),l.jsx("div",{style:{height:1,background:"#e0e0e0",margin:"16px 0"}}),l.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:l.jsx("button",{onClick:e,style:{padding:"8px 16px",background:"#4a9eff",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:500},onMouseEnter:st=>st.currentTarget.style.background="#3a8ee6",onMouseLeave:st=>st.currentTarget.style.background="#4a9eff",children:"Close"})})]})]})},w3=({component:r,componentEditor:e,componentDefinition:t,setComponentEditor:n,areComponentsLocked:s,componentsTop:o,componentsBottom:d,setComponentsTop:c,setComponentsBottom:h,uploadedDatasheetFile:f,setUploadedDatasheetFile:m})=>{const A=(t||e?.componentDefinition||_d(r))?.fields,v=r.componentType,E=v==="IntegratedCircuit"||v==="Semiconductor";if(A&&A.length>0&&!E){const x=(j,$,z)=>z?j==="capacitance"||j==="resistance"||j==="voltage"||j==="current"?"80px":j==="power"||j==="inductance"||j==="impedance"||j==="esr"||j==="ripple"||j==="leakageCurrent"?"70px":"80px":j==="tolerance"||j==="pinCount"?"60px":j==="partNumber"||j==="manufacturer"?"150px":j==="description"||j==="operatingTemperature"?"180px":$==="string"&&!j.includes("Unit")?"150px":"120px",k=j=>{const $=r.componentType;if(($==="IntegratedCircuit"||$==="Semiconductor")&&j.name==="datasheet")return null;const B=j.name,F=`${j.name}Unit`,I=e[B]??r[B]??j.defaultValue??"",X=e[F]??r[F]??(j.units&&j.defaultUnit?j.defaultUnit:""),M=N=>{n({...e,[B]:N})},G=N=>{n({...e,[F]:N})},U=!!(j.units&&j.units.length>0),_=x(j.name,j.type,U);return l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[l.jsxs("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:[j.label,":"]}),j.type==="enum"?l.jsx("select",{value:I,onChange:N=>M(N.target.value),disabled:s,style:{width:_,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:(j.enumValues||[]).map(N=>l.jsx("option",{value:N,children:N},N))}):l.jsx("input",{type:"text",value:I,onChange:N=>M(N.target.value),disabled:s,style:{width:_,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:U?"8px":"0"},placeholder:j.defaultValue!==void 0?String(j.defaultValue):""}),U&&j.units&&l.jsx("select",{value:X||j.defaultUnit||j.units[0],onChange:N=>G(N.target.value),disabled:s,style:{width:"70px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,flexShrink:0},children:j.units.map(N=>l.jsx("option",{value:N,children:N},N))})]},j.name)};return l.jsx(l.Fragment,{children:A.map(k).filter(Boolean)})}return E?l.jsxs(l.Fragment,{children:[r.componentType==="Resistor"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-resistance-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),l.jsx("input",{id:`component-resistance-${r.id}`,type:"text",value:e.resistance||"",onChange:x=>n({...e,resistance:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 10"}),l.jsx("select",{value:e.resistanceUnit||Wt("resistance"),onChange:x=>n({...e,resistanceUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("resistance").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-power-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),l.jsxs("select",{id:`component-power-${r.id}`,value:e.power||"1/4",onChange:x=>n({...e,power:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"12px"},children:[l.jsx("option",{value:"1/20",children:"1/20 W"}),l.jsx("option",{value:"1/16",children:"1/16 W"}),l.jsx("option",{value:"1/10",children:"1/10 W"}),l.jsx("option",{value:"1/8",children:"1/8 W"}),l.jsx("option",{value:"1/4",children:"1/4 W"}),l.jsx("option",{value:"1/2",children:"1/2 W"}),l.jsx("option",{value:"1",children:"1 W"}),l.jsx("option",{value:"2",children:"2 W"}),l.jsx("option",{value:"3",children:"3 W"}),l.jsx("option",{value:"5",children:"5 W"}),l.jsx("option",{value:"10",children:"10 W"}),l.jsx("option",{value:"25",children:"25 W"}),l.jsx("option",{value:"50",children:"50 W"}),l.jsx("option",{value:"100",children:"100 W"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-tolerance-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),l.jsxs("select",{id:`component-tolerance-${r.id}`,value:e.tolerance||"5%",onChange:x=>n({...e,tolerance:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"0.05%",children:"0.05%"}),l.jsx("option",{value:"0.1%",children:"0.1%"}),l.jsx("option",{value:"0.25%",children:"0.25%"}),l.jsx("option",{value:"0.5%",children:"0.5%"}),l.jsx("option",{value:"1%",children:"1%"}),l.jsx("option",{value:"2%",children:"2%"}),l.jsx("option",{value:"5%",children:"5%"}),l.jsx("option",{value:"10%",children:"10%"}),l.jsx("option",{value:"20%",children:"20%"})]})]})]}),r.componentType==="Capacitor"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-capacitance-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),l.jsx("input",{id:`component-capacitance-${r.id}`,type:"text",value:e.capacitance||"",onChange:x=>n({...e,capacitance:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 100"}),l.jsx("select",{value:e.capacitanceUnit||Wt("capacitance"),onChange:x=>n({...e,capacitanceUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("capacitance").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-voltage-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),l.jsx("input",{id:`component-voltage-${r.id}`,type:"text",value:e.voltage||"",onChange:x=>n({...e,voltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 50"}),l.jsx("select",{value:e.voltageUnit||Wt("voltage"),onChange:x=>n({...e,voltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-dielectric-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Dielectric:"}),l.jsxs("select",{id:`component-dielectric-${r.id}`,value:e.dielectric||"Ceramic",onChange:x=>n({...e,dielectric:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"Ceramic",children:"Ceramic"}),l.jsx("option",{value:"Tantalum",children:"Tantalum"}),l.jsx("option",{value:"Film",children:"Film"}),l.jsx("option",{value:"Polyester",children:"Polyester"}),l.jsx("option",{value:"Polypropylene",children:"Polypropylene"}),l.jsx("option",{value:"Mica",children:"Mica"}),l.jsx("option",{value:"Paper",children:"Paper"}),l.jsx("option",{value:"Glass",children:"Glass"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-tolerance-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),l.jsxs("select",{id:`component-tolerance-${r.id}`,value:e.tolerance||"10%",onChange:x=>n({...e,tolerance:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"0.5%",children:"0.5%"}),l.jsx("option",{value:"1%",children:"1%"}),l.jsx("option",{value:"2%",children:"2%"}),l.jsx("option",{value:"5%",children:"5%"}),l.jsx("option",{value:"10%",children:"10%"}),l.jsx("option",{value:"20%",children:"20%"})]})]})]}),r.componentType==="Film Capacitor"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-capacitance-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),l.jsx("input",{id:`component-capacitance-${r.id}`,type:"text",value:e.capacitance||"",onChange:x=>n({...e,capacitance:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 100"}),l.jsx("select",{value:e.capacitanceUnit||Wt("capacitance"),onChange:x=>n({...e,capacitanceUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("capacitance").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-voltage-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),l.jsx("input",{id:`component-voltage-${r.id}`,type:"text",value:e.voltage||"",onChange:x=>n({...e,voltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 50"}),l.jsx("select",{value:e.voltageUnit||Wt("voltage"),onChange:x=>n({...e,voltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-filmtype-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Film Type:"}),l.jsxs("select",{id:`component-filmtype-${r.id}`,value:e.filmType||"Polyester",onChange:x=>n({...e,filmType:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"Polyester",children:"Polyester"}),l.jsx("option",{value:"Polypropylene",children:"Polypropylene"}),l.jsx("option",{value:"Polyethylene",children:"Polyethylene"}),l.jsx("option",{value:"Polystyrene",children:"Polystyrene"}),l.jsx("option",{value:"Polycarbonate",children:"Polycarbonate"}),l.jsx("option",{value:"PTFE",children:"PTFE (Teflon)"}),l.jsx("option",{value:"PPS",children:"PPS (Polyphenylene Sulfide)"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-tolerance-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),l.jsxs("select",{id:`component-tolerance-${r.id}`,value:e.tolerance||"10%",onChange:x=>n({...e,tolerance:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"0.5%",children:"0.5%"}),l.jsx("option",{value:"1%",children:"1%"}),l.jsx("option",{value:"2%",children:"2%"}),l.jsx("option",{value:"5%",children:"5%"}),l.jsx("option",{value:"10%",children:"10%"}),l.jsx("option",{value:"20%",children:"20%"})]})]})]}),r.componentType==="Electrolytic Capacitor"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-capacitance-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),l.jsx("input",{id:`component-capacitance-${r.id}`,type:"text",value:e.capacitance||"",onChange:x=>n({...e,capacitance:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 100"}),l.jsxs("select",{value:e.capacitanceUnit||"F",onChange:x=>n({...e,capacitanceUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:[l.jsx("option",{value:"pF",children:"pF"}),l.jsx("option",{value:"nF",children:"nF"}),l.jsx("option",{value:"F",children:"F"}),l.jsx("option",{value:"mF",children:"mF"}),l.jsx("option",{value:"F",children:"F"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-voltage-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),l.jsx("input",{id:`component-voltage-${r.id}`,type:"text",value:e.voltage||"",onChange:x=>n({...e,voltage:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 25"}),l.jsx("select",{value:e.voltageUnit||Wt("voltage"),onChange:x=>n({...e,voltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-tolerance-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),l.jsxs("select",{id:`component-tolerance-${r.id}`,value:e.tolerance||"20%",onChange:x=>n({...e,tolerance:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},children:[l.jsx("option",{value:"0.5%",children:"0.5%"}),l.jsx("option",{value:"1%",children:"1%"}),l.jsx("option",{value:"2%",children:"2%"}),l.jsx("option",{value:"5%",children:"5%"}),l.jsx("option",{value:"10%",children:"10%"}),l.jsx("option",{value:"20%",children:"20%"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-polarized-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Polarized:"}),l.jsx("input",{id:`component-polarized-${r.id}`,type:"checkbox",checked:Sp(r),disabled:!0,style:{opacity:.6,cursor:"not-allowed"},title:"Polarized is a fixed property determined by component type"})]})]}),r.componentType==="Inductor"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-inductance-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Inductance:"}),l.jsx("input",{id:`component-inductance-${r.id}`,type:"text",value:e.inductance||"",onChange:x=>n({...e,inductance:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 10"}),l.jsx("select",{value:e.inductanceUnit||Wt("inductance"),onChange:x=>n({...e,inductanceUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("inductance").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-current-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),l.jsx("input",{id:`component-current-${r.id}`,type:"text",value:e.current||"",onChange:x=>n({...e,current:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 1"}),l.jsx("select",{value:e.currentUnit||Wt("current"),onChange:x=>n({...e,currentUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("current").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-resistance-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"DC Resistance:"}),l.jsx("input",{id:`component-resistance-${r.id}`,type:"text",value:e.resistance||"",onChange:x=>n({...e,resistance:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 50"}),l.jsx("select",{value:e.resistanceUnit||"",onChange:x=>n({...e,resistanceUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("resistance").map(x=>l.jsx("option",{value:x,children:x},x))})]})]}),r.componentType==="Diode"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-diodetype-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Diode Type:"}),l.jsxs("select",{id:`component-diodetype-${r.id}`,value:e.diodeType||"Standard",onChange:x=>n({...e,diodeType:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"Standard",children:"Standard"}),l.jsx("option",{value:"Zener",children:"Zener"}),l.jsx("option",{value:"LED",children:"LED"}),l.jsx("option",{value:"Schottky",children:"Schottky"}),l.jsx("option",{value:"Infrared",children:"Infrared"}),l.jsx("option",{value:"Photodiode",children:"Photodiode"}),l.jsx("option",{value:"Other",children:"Other"})]})]}),e.diodeType==="LED"&&l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-ledcolor-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"LED Color:"}),l.jsxs("select",{id:`component-ledcolor-${r.id}`,value:e.ledColor||"",onChange:x=>n({...e,ledColor:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"",children:"Select..."}),l.jsx("option",{value:"Red",children:"Red"}),l.jsx("option",{value:"Green",children:"Green"}),l.jsx("option",{value:"Blue",children:"Blue"}),l.jsx("option",{value:"Yellow",children:"Yellow"}),l.jsx("option",{value:"Orange",children:"Orange"}),l.jsx("option",{value:"White",children:"White"}),l.jsx("option",{value:"RGB",children:"RGB"}),l.jsx("option",{value:"IR",children:"IR (Infrared)"}),l.jsx("option",{value:"UV",children:"UV (Ultraviolet)"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-voltage-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),l.jsx("input",{id:`component-voltage-${r.id}`,type:"text",value:e.voltage||"",onChange:x=>n({...e,voltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 50"}),l.jsx("select",{value:e.voltageUnit||Wt("voltage"),onChange:x=>n({...e,voltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-current-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),l.jsx("input",{id:`component-current-${r.id}`,type:"text",value:e.current||"",onChange:x=>n({...e,current:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 1"}),l.jsx("select",{value:e.currentUnit||Wt("current"),onChange:x=>n({...e,currentUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("current").map(x=>l.jsx("option",{value:x,children:x},x))})]})]}),r.componentType==="Battery"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-voltage-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),l.jsx("input",{id:`component-voltage-${r.id}`,type:"text",value:e.voltage||"",onChange:x=>n({...e,voltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 3.7"}),l.jsx("select",{value:e.voltageUnit||"V",onChange:x=>n({...e,voltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-capacity-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacity:"}),l.jsx("input",{id:`component-capacity-${r.id}`,type:"text",value:e.capacity||"",onChange:x=>n({...e,capacity:x.target.value}),disabled:s,style:{width:"120px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 2000mAh"})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-chemistry-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Chemistry:"}),l.jsxs("select",{id:`component-chemistry-${r.id}`,value:e.chemistry||"Li-ion",onChange:x=>n({...e,chemistry:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"Li-ion",children:"Li-ion"}),l.jsx("option",{value:"LiPo",children:"LiPo"}),l.jsx("option",{value:"NiMH",children:"NiMH"}),l.jsx("option",{value:"NiCd",children:"NiCd"}),l.jsx("option",{value:"Alkaline",children:"Alkaline"}),l.jsx("option",{value:"Lead-Acid",children:"Lead-Acid"}),l.jsx("option",{value:"Lithium",children:"Lithium"}),l.jsx("option",{value:"Zinc-Carbon",children:"Zinc-Carbon"})]})]})]}),r.componentType==="Fuse"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-current-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),l.jsx("input",{id:`component-current-${r.id}`,type:"text",value:e.current||"",onChange:x=>n({...e,current:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 5"}),l.jsx("select",{value:e.currentUnit||"A",onChange:x=>n({...e,currentUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("current").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-voltage-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),l.jsx("input",{id:`component-voltage-${r.id}`,type:"text",value:e.voltage||"",onChange:x=>n({...e,voltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 250"}),l.jsx("select",{value:e.voltageUnit||"V",onChange:x=>n({...e,voltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-fusetype-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Fuse Type:"}),l.jsxs("select",{id:`component-fusetype-${r.id}`,value:e.fuseType||"Fast-blow",onChange:x=>n({...e,fuseType:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"Fast-blow",children:"Fast-blow"}),l.jsx("option",{value:"Slow-blow",children:"Slow-blow"}),l.jsx("option",{value:"Time-delay",children:"Time-delay"}),l.jsx("option",{value:"Resettable",children:"Resettable"}),l.jsx("option",{value:"Cartridge",children:"Cartridge"}),l.jsx("option",{value:"Glass",children:"Glass"}),l.jsx("option",{value:"Ceramic",children:"Ceramic"})]})]})]}),r.componentType==="Relay"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-coilvoltage-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Coil Voltage:"}),l.jsx("input",{id:`component-coilvoltage-${r.id}`,type:"text",value:e.coilVoltage||"",onChange:x=>n({...e,coilVoltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 12"}),l.jsx("select",{value:e.coilVoltageUnit||Wt("voltage"),onChange:x=>n({...e,coilVoltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-contacttype-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Contact Type:"}),l.jsxs("select",{id:`component-contacttype-${r.id}`,value:e.contactType||"SPST",onChange:x=>n({...e,contactType:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"SPST",children:"SPST (Single Pole Single Throw)"}),l.jsx("option",{value:"SPDT",children:"SPDT (Single Pole Double Throw)"}),l.jsx("option",{value:"DPST",children:"DPST (Double Pole Single Throw)"}),l.jsx("option",{value:"DPDT",children:"DPDT (Double Pole Double Throw)"}),l.jsx("option",{value:"3PDT",children:"3PDT (3 Pole Double Throw)"}),l.jsx("option",{value:"4PDT",children:"4PDT (4 Pole Double Throw)"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-current-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),l.jsx("input",{id:`component-current-${r.id}`,type:"text",value:e.current||"",onChange:x=>n({...e,current:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 10"}),l.jsx("select",{value:e.currentUnit||Wt("current"),onChange:x=>n({...e,currentUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("current").map(x=>l.jsx("option",{value:x,children:x},x))})]})]}),r.componentType==="Motor"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-motortype-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Motor Type:"}),l.jsxs("select",{id:`component-motortype-${r.id}`,value:e.motorType||"DC",onChange:x=>n({...e,motorType:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"DC",children:"DC Motor"}),l.jsx("option",{value:"Stepper",children:"Stepper Motor"}),l.jsx("option",{value:"Servo",children:"Servo Motor"}),l.jsx("option",{value:"Brushless",children:"Brushless DC"}),l.jsx("option",{value:"AC",children:"AC Motor"}),l.jsx("option",{value:"Synchronous",children:"Synchronous"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-voltage-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),l.jsx("input",{id:`component-voltage-${r.id}`,type:"text",value:e.voltage||"",onChange:x=>n({...e,voltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 12"}),l.jsx("select",{value:e.voltageUnit||Wt("voltage"),onChange:x=>n({...e,voltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-current-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),l.jsx("input",{id:`component-current-${r.id}`,type:"text",value:e.current||"",onChange:x=>n({...e,current:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 1"}),l.jsx("select",{value:e.currentUnit||Wt("current"),onChange:x=>n({...e,currentUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("current").map(x=>l.jsx("option",{value:x,children:x},x))})]})]}),r.componentType==="Switch"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-switchtype-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Switch Type:"}),l.jsxs("select",{id:`component-switchtype-${r.id}`,value:e.switchType||"Toggle",onChange:x=>n({...e,switchType:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"Toggle",children:"Toggle"}),l.jsx("option",{value:"Push-button",children:"Push-button"}),l.jsx("option",{value:"Slide",children:"Slide"}),l.jsx("option",{value:"Rotary",children:"Rotary"}),l.jsx("option",{value:"DIP",children:"DIP Switch"}),l.jsx("option",{value:"Momentary",children:"Momentary"}),l.jsx("option",{value:"Latching",children:"Latching"}),l.jsx("option",{value:"Reed",children:"Reed Switch"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-current-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),l.jsx("input",{id:`component-current-${r.id}`,type:"text",value:e.current||"",onChange:x=>n({...e,current:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 5"}),l.jsx("select",{value:e.currentUnit||Wt("current"),onChange:x=>n({...e,currentUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("current").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-voltage-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),l.jsx("input",{id:`component-voltage-${r.id}`,type:"text",value:e.voltage||"",onChange:x=>n({...e,voltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 250"}),l.jsx("select",{value:e.voltageUnit||Wt("voltage"),onChange:x=>n({...e,voltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]})]}),r.componentType==="FerriteBead"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-impedance-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Impedance:"}),l.jsx("input",{id:`component-impedance-${r.id}`,type:"text",value:e.impedance||"",onChange:x=>n({...e,impedance:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 100"}),l.jsx("select",{value:e.impedanceUnit||Wt("impedance"),onChange:x=>n({...e,impedanceUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("impedance").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-current-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),l.jsx("input",{id:`component-current-${r.id}`,type:"text",value:e.current||"",onChange:x=>n({...e,current:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 1"}),l.jsx("select",{value:e.currentUnit||Wt("current"),onChange:x=>n({...e,currentUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("current").map(x=>l.jsx("option",{value:x,children:x},x))})]})]}),r.componentType==="Connector"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-connectortype-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Connector Type:"}),l.jsx("input",{id:`component-connectortype-${r.id}`,type:"text",value:e.connectorType||"",onChange:x=>n({...e,connectorType:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},placeholder:"e.g., USB-A, HDMI"})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-gender-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Gender:"}),l.jsxs("select",{id:`component-gender-${r.id}`,value:e.gender||"N/A",onChange:x=>n({...e,gender:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"Male",children:"Male"}),l.jsx("option",{value:"Female",children:"Female"}),l.jsx("option",{value:"N/A",children:"N/A"})]})]})]}),r.componentType==="Jumper"&&l.jsx(l.Fragment,{children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-positions-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Positions:"}),l.jsx("input",{id:`component-positions-${r.id}`,type:"number",min:"2",value:e.positions||3,onChange:x=>n({...e,positions:parseInt(x.target.value)||3}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"}})]})}),r.componentType==="Speaker"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-impedance-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Impedance:"}),l.jsx("input",{id:`component-impedance-${r.id}`,type:"text",value:e.impedance||"",onChange:x=>n({...e,impedance:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 8"}),l.jsx("select",{value:e.impedanceUnit||Wt("impedance"),onChange:x=>n({...e,impedanceUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("impedance").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-power-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),l.jsxs("select",{id:`component-power-${r.id}`,value:e.power||"1/4",onChange:x=>n({...e,power:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"12px"},children:[l.jsx("option",{value:"1/20",children:"1/20 W"}),l.jsx("option",{value:"1/16",children:"1/16 W"}),l.jsx("option",{value:"1/10",children:"1/10 W"}),l.jsx("option",{value:"1/8",children:"1/8 W"}),l.jsx("option",{value:"1/4",children:"1/4 W"}),l.jsx("option",{value:"1/2",children:"1/2 W"}),l.jsx("option",{value:"1",children:"1 W"}),l.jsx("option",{value:"2",children:"2 W"}),l.jsx("option",{value:"3",children:"3 W"}),l.jsx("option",{value:"5",children:"5 W"}),l.jsx("option",{value:"10",children:"10 W"}),l.jsx("option",{value:"25",children:"25 W"}),l.jsx("option",{value:"50",children:"50 W"}),l.jsx("option",{value:"100",children:"100 W"})]})]})]}),r.componentType==="PowerSupply"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-inputvoltage-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Input Voltage:"}),l.jsx("input",{id:`component-inputvoltage-${r.id}`,type:"text",value:e.inputVoltage||"",onChange:x=>n({...e,inputVoltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 120"}),l.jsx("select",{value:e.inputVoltageUnit||Wt("voltage"),onChange:x=>n({...e,inputVoltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-outputvoltage-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Output Voltage:"}),l.jsx("input",{id:`component-outputvoltage-${r.id}`,type:"text",value:e.outputVoltage||"",onChange:x=>n({...e,outputVoltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 12"}),l.jsx("select",{value:e.outputVoltageUnit||Wt("voltage"),onChange:x=>n({...e,outputVoltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-current-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),l.jsx("input",{id:`component-current-${r.id}`,type:"text",value:e.current||"",onChange:x=>n({...e,current:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 1"}),l.jsx("select",{value:e.currentUnit||Wt("current"),onChange:x=>n({...e,currentUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("current").map(x=>l.jsx("option",{value:x,children:x},x))})]})]}),r.componentType==="Transistor"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-transistortype-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Transistor Type:"}),l.jsxs("select",{id:`component-transistortype-${r.id}`,value:e.transistorType||"BJT",onChange:x=>n({...e,transistorType:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"BJT",children:"BJT (Bipolar Junction Transistor)"}),l.jsx("option",{value:"FET",children:"FET (Field Effect Transistor)"}),l.jsx("option",{value:"MOSFET",children:"MOSFET"}),l.jsx("option",{value:"IGBT",children:"IGBT"}),l.jsx("option",{value:"JFET",children:"JFET"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-polarity-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Polarity:"}),l.jsxs("select",{id:`component-polarity-${r.id}`,value:e.polarity||"NPN",onChange:x=>n({...e,polarity:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"NPN",children:"NPN"}),l.jsx("option",{value:"PNP",children:"PNP"}),l.jsx("option",{value:"N-Channel",children:"N-Channel"}),l.jsx("option",{value:"P-Channel",children:"P-Channel"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-voltage-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),l.jsx("input",{id:`component-voltage-${r.id}`,type:"text",value:e.voltage||"",onChange:x=>n({...e,voltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 50"}),l.jsx("select",{value:e.voltageUnit||Wt("voltage"),onChange:x=>n({...e,voltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-current-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),l.jsx("input",{id:`component-current-${r.id}`,type:"text",value:e.current||"",onChange:x=>n({...e,current:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 1"}),l.jsx("select",{value:e.currentUnit||Wt("current"),onChange:x=>n({...e,currentUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("current").map(x=>l.jsx("option",{value:x,children:x},x))})]})]}),r.componentType==="ResistorNetwork"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-resistance-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),l.jsx("input",{id:`component-resistance-${r.id}`,type:"text",value:e.resistance||"",onChange:x=>n({...e,resistance:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 10"}),l.jsx("select",{value:e.resistanceUnit||Wt("resistance"),onChange:x=>n({...e,resistanceUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("resistance").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-configuration-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Configuration:"}),l.jsx("input",{id:`component-configuration-${r.id}`,type:"text",value:e.configuration||"",onChange:x=>n({...e,configuration:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},placeholder:"e.g., Isolated, Bussed"})]})]}),r.componentType==="Thermistor"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-resistance-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),l.jsx("input",{id:`component-resistance-${r.id}`,type:"text",value:e.resistance||"",onChange:x=>n({...e,resistance:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 10"}),l.jsx("select",{value:e.resistanceUnit||Wt("resistance"),onChange:x=>n({...e,resistanceUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("resistance").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-thermistortype-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Thermistor Type:"}),l.jsxs("select",{id:`component-thermistortype-${r.id}`,value:e.thermistorType||"NTC",onChange:x=>n({...e,thermistorType:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"NTC",children:"NTC (Negative Temperature Coefficient)"}),l.jsx("option",{value:"PTC",children:"PTC (Positive Temperature Coefficient)"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-beta-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Beta ():"}),l.jsx("input",{id:`component-beta-${r.id}`,type:"text",value:e.beta||"",onChange:x=>n({...e,beta:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},placeholder:"e.g., 3950"})]})]}),r.componentType==="Transformer"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-primaryvoltage-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Primary Voltage:"}),l.jsx("input",{id:`component-primaryvoltage-${r.id}`,type:"text",value:e.primaryVoltage||"",onChange:x=>n({...e,primaryVoltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 120"}),l.jsx("select",{value:e.primaryVoltageUnit||Wt("voltage"),onChange:x=>n({...e,primaryVoltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-secondaryvoltage-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Secondary Voltage:"}),l.jsx("input",{id:`component-secondaryvoltage-${r.id}`,type:"text",value:e.secondaryVoltage||"",onChange:x=>n({...e,secondaryVoltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 12"}),l.jsx("select",{value:e.secondaryVoltageUnit||Wt("voltage"),onChange:x=>n({...e,secondaryVoltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-power-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),l.jsxs("select",{id:`component-power-${r.id}`,value:e.power||"1/4",onChange:x=>n({...e,power:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"12px"},children:[l.jsx("option",{value:"1/20",children:"1/20 W"}),l.jsx("option",{value:"1/16",children:"1/16 W"}),l.jsx("option",{value:"1/10",children:"1/10 W"}),l.jsx("option",{value:"1/8",children:"1/8 W"}),l.jsx("option",{value:"1/4",children:"1/4 W"}),l.jsx("option",{value:"1/2",children:"1/2 W"}),l.jsx("option",{value:"1",children:"1 W"}),l.jsx("option",{value:"2",children:"2 W"}),l.jsx("option",{value:"3",children:"3 W"}),l.jsx("option",{value:"5",children:"5 W"}),l.jsx("option",{value:"10",children:"10 W"}),l.jsx("option",{value:"25",children:"25 W"}),l.jsx("option",{value:"50",children:"50 W"}),l.jsx("option",{value:"100",children:"100 W"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-turns-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Turns Ratio:"}),l.jsx("input",{id:`component-turns-${r.id}`,type:"text",value:e.turns||"",onChange:x=>n({...e,turns:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},placeholder:"e.g., 10:1"})]})]}),r.componentType==="TestPoint"&&l.jsx(l.Fragment,{children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-signal-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Signal:"}),l.jsx("input",{id:`component-signal-${r.id}`,type:"text",value:e.signal||"",onChange:x=>n({...e,signal:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},placeholder:"e.g., VCC, GND, CLK"})]})}),(r.componentType==="IntegratedCircuit"||r.componentType==="Semiconductor")&&l.jsxs(l.Fragment,{children:[l.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid #e0e0e0",fontSize:"9px",fontWeight:600,color:"#000"},children:"IC Properties:"}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-ictype-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"IC Type:"}),l.jsxs("select",{id:`component-ictype-${r.id}`,value:e.icType||"Op-Amp",onChange:x=>n({...e,icType:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"Op-Amp",children:"Op-Amp"}),l.jsx("option",{value:"Microcontroller",children:"Microcontroller"}),l.jsx("option",{value:"Microprocessor",children:"Microprocessor"}),l.jsx("option",{value:"Logic",children:"Logic"}),l.jsx("option",{value:"Memory",children:"Memory"}),l.jsx("option",{value:"Voltage Regulator",children:"Voltage Regulator"}),l.jsx("option",{value:"Timer",children:"Timer"}),l.jsx("option",{value:"ADC",children:"ADC (Analog-to-Digital)"}),l.jsx("option",{value:"DAC",children:"DAC (Digital-to-Analog)"}),l.jsx("option",{value:"Comparator",children:"Comparator"}),l.jsx("option",{value:"Transceiver",children:"Transceiver"}),l.jsx("option",{value:"Driver",children:"Driver"}),l.jsx("option",{value:"Amplifier",children:"Amplifier"}),l.jsx("option",{value:"Other",children:"Other"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-datasheet-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Datasheet:"}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px",flex:1},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",flexWrap:"wrap",flex:1},children:[l.jsx("input",{id:`component-datasheet-file-${r.id}`,type:"file",accept:".pdf",onChange:x=>{const k=x.target.files?.[0]||null;m(k)},disabled:s,style:{position:"absolute",width:"0.1px",height:"0.1px",opacity:0,overflow:"hidden",zIndex:-1}}),l.jsx("label",{htmlFor:`component-datasheet-file-${r.id}`,style:{display:"inline-block",padding:"2px 6px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"9px",color:"#000",cursor:s?"not-allowed":"pointer",opacity:s?.6:1,whiteSpace:"nowrap",flex:"0 0 auto"},children:"Choose File"}),f?l.jsx("a",{href:"#",onClick:async x=>{if(x.preventDefault(),x.stopPropagation(),f){const k=URL.createObjectURL(f);window.open(k,"_blank","noopener,noreferrer")&&setTimeout(()=>URL.revokeObjectURL(k),1e3)}},style:{fontSize:"9px",color:"#0066cc",whiteSpace:"nowrap",textDecoration:"underline",cursor:"pointer",flex:"0 0 auto"},title:"Click to open PDF in new window",children:f.name||"PDF file"}):l.jsx("span",{style:{fontSize:"9px",color:"#666",flex:"0 0 auto"},children:"No file chosen"})]}),l.jsx("div",{style:{display:"flex",alignItems:"center",gap:"4px",flexWrap:"wrap"},children:e.datasheet&&e.datasheet.trim()?l.jsx("a",{href:e.datasheet.trim().match(/^https?:\/\//)?e.datasheet.trim():`https://${e.datasheet.trim()}`,target:"_blank",rel:"noopener noreferrer",onClick:x=>{x.stopPropagation()},style:{flex:1,padding:"2px 3px",fontSize:"10px",color:"#0066cc",textDecoration:"underline",cursor:"pointer",wordBreak:"break-all"},title:"Click to open URL in new window",children:e.datasheet.trim()}):l.jsx("input",{id:`component-datasheet-${r.id}`,type:"text",value:e.datasheet||"",onChange:x=>n({...e,datasheet:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"URL (optional, for reference)"})})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-pincount-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Pin Count:"}),l.jsx("input",{id:`component-pincount-${r.id}`,name:`component-pincount-${r.id}`,type:"number",min:"1",value:e.pinCount,onChange:x=>{const k=Math.max(1,parseInt(x.target.value)||1);n({...e,pinCount:k})},onBlur:x=>{if(s){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const k=Math.max(1,parseInt(x.target.value)||1),$=(e.layer==="top"?o:d).find(z=>z.id===e.id);if($&&k!==$.pinCount){const z=$.pinConnections||[],B=new Array(k).fill("").map((M,G)=>G<z.length?z[G]:""),F=$.pinPolarities||[],I=$.pinPolarities?new Array(k).fill("").map((M,G)=>G<F.length?F[G]:""):void 0,X={...$,pinCount:k,pinConnections:B,...I!==void 0&&{pinPolarities:I}};e.layer==="top"?c(M=>M.map(G=>G.id===e.id?X:G)):h(M=>M.map(G=>G.id===e.id?X:G)),n({...e,pinCount:k})}},disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"}})]})]}),r.componentType==="VacuumTube"&&l.jsx(l.Fragment,{children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-tubetype-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tube Type:"}),l.jsx("input",{id:`component-tubetype-${r.id}`,type:"text",value:e.tubeType||"",onChange:x=>n({...e,tubeType:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},placeholder:"e.g., 12AX7, 6L6"})]})}),r.componentType==="VariableResistor"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-vrtype-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"VR Type:"}),l.jsxs("select",{id:`component-vrtype-${r.id}`,value:e.vrType||"Potentiometer",onChange:x=>n({...e,vrType:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"Potentiometer",children:"Potentiometer"}),l.jsx("option",{value:"Rheostat",children:"Rheostat"}),l.jsx("option",{value:"Trimmer",children:"Trimmer"}),l.jsx("option",{value:"Varistor",children:"Varistor"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-resistance-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),l.jsx("input",{id:`component-resistance-${r.id}`,type:"text",value:e.resistance||"",onChange:x=>n({...e,resistance:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 10"}),l.jsx("select",{value:e.resistanceUnit||Wt("resistance"),onChange:x=>n({...e,resistanceUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("resistance").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-power-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),l.jsxs("select",{id:`component-power-${r.id}`,value:e.power||"1/4",onChange:x=>n({...e,power:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"12px"},children:[l.jsx("option",{value:"1/20",children:"1/20 W"}),l.jsx("option",{value:"1/16",children:"1/16 W"}),l.jsx("option",{value:"1/10",children:"1/10 W"}),l.jsx("option",{value:"1/8",children:"1/8 W"}),l.jsx("option",{value:"1/4",children:"1/4 W"}),l.jsx("option",{value:"1/2",children:"1/2 W"}),l.jsx("option",{value:"1",children:"1 W"}),l.jsx("option",{value:"2",children:"2 W"}),l.jsx("option",{value:"3",children:"3 W"}),l.jsx("option",{value:"5",children:"5 W"}),l.jsx("option",{value:"10",children:"10 W"}),l.jsx("option",{value:"25",children:"25 W"}),l.jsx("option",{value:"50",children:"50 W"}),l.jsx("option",{value:"100",children:"100 W"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-taper-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Taper:"}),l.jsxs("select",{id:`component-taper-${r.id}`,value:e.taper||"Linear",onChange:x=>n({...e,taper:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"Linear",children:"Linear"}),l.jsx("option",{value:"Logarithmic",children:"Logarithmic"}),l.jsx("option",{value:"Audio",children:"Audio"})]})]})]}),r.componentType==="Crystal"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-frequency-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Frequency:"}),l.jsx("input",{id:`component-frequency-${r.id}`,type:"text",value:e.frequency||"",onChange:x=>n({...e,frequency:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},placeholder:"e.g., 16.000 MHz"})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-loadcapacitance-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Load Capacitance:"}),l.jsx("input",{id:`component-loadcapacitance-${r.id}`,type:"text",value:e.loadCapacitance||"",onChange:x=>n({...e,loadCapacitance:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},placeholder:"e.g., 18pF"})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-tolerance-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),l.jsxs("select",{id:`component-tolerance-${r.id}`,value:e.tolerance||"10ppm",onChange:x=>n({...e,tolerance:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"10ppm",children:"10ppm"}),l.jsx("option",{value:"20ppm",children:"20ppm"}),l.jsx("option",{value:"30ppm",children:"30ppm"}),l.jsx("option",{value:"50ppm",children:"50ppm"}),l.jsx("option",{value:"100ppm",children:"100ppm"})]})]})]}),r.componentType==="GenericComponent"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-generictype-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Type:"}),l.jsxs("select",{id:`component-generictype-${r.id}`,value:r.genericType||"Attenuator",onChange:x=>n({...e,genericType:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},children:[l.jsx("option",{value:"Attenuator",children:"Attenuator"}),l.jsx("option",{value:"CircuitBreaker",children:"Circuit Breaker"}),l.jsx("option",{value:"Thermocouple",children:"Thermocouple"}),l.jsx("option",{value:"Tuner",children:"Tuner"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-voltage-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),l.jsx("input",{id:`component-voltage-${r.id}`,type:"text",value:e.voltage||"",onChange:x=>n({...e,voltage:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 50"}),l.jsx("select",{value:e.voltageUnit||Wt("voltage"),onChange:x=>n({...e,voltageUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("voltage").map(x=>l.jsx("option",{value:x,children:x},x))})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-current-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),l.jsx("input",{id:`component-current-${r.id}`,type:"text",value:e.current||"",onChange:x=>n({...e,current:x.target.value}),disabled:s,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1},placeholder:"e.g., 1"}),l.jsx("select",{value:e.currentUnit||Wt("current"),onChange:x=>n({...e,currentUnit:x.target.value}),disabled:s,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,width:"60px",marginRight:"12px"},children:Xi("current").map(x=>l.jsx("option",{value:x,children:x},x))})]}),r.genericType==="Tuner"&&l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-frequency-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Frequency:"}),l.jsx("input",{id:`component-frequency-${r.id}`,type:"text",value:e.frequency||"",onChange:x=>n({...e,frequency:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},placeholder:"e.g., 100MHz"})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-power-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),l.jsx("input",{id:`component-power-${r.id}`,type:"text",value:e.power||"",onChange:x=>n({...e,power:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},placeholder:"e.g., 1W"})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-model-${r.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Model:"}),l.jsx("input",{id:`component-model-${r.id}`,type:"text",value:e.model||"",onChange:x=>n({...e,model:x.target.value}),disabled:s,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:s?.6:1,marginRight:"8px"},placeholder:"Part number or model"})]})]})]}):l.jsx("div",{style:{padding:"8px",background:"#fff3cd",border:"1px solid #ffeeba",borderRadius:4,color:"#856404",marginBottom:"8px",fontSize:"9px"},children:"Component definition missing for this instance. Using legacy fields. Please ensure the component has a definition in componentDefinitions.json and a valid componentDefinitionKey."})},bl=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Qm=[.001,0,0,.001,0,0],Nm=1.35,gc={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Pu={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},yp="pdfjs_internal_editor_",mi={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Ki={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},S3={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},ey={TRIANGLES:1,LATTICE:2},Co={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Wg={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},ja={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},sf={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},a0={ERRORS:0,WARNINGS:1,INFOS:5},xp={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},ip={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},A3={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let o0=a0.WARNINGS;function T3(r){Number.isInteger(r)&&(o0=r)}function C3(){return o0}function l0(r){o0>=a0.INFOS&&console.info(`Info: ${r}`)}function ui(r){o0>=a0.WARNINGS&&console.warn(`Warning: ${r}`)}function Xs(r){throw new Error(r)}function Zi(r,e){r||Xs(e)}function _3(r){switch(r?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function X2(r,e=null,t=null){if(!r)return null;if(t&&typeof r=="string"&&(t.addDefaultProtocol&&r.startsWith("www.")&&r.match(/\./g)?.length>=2&&(r=`http://${r}`),t.tryConvertEncoding))try{r=E3(r)}catch{}const n=e?URL.parse(r,e):URL.parse(r);return _3(n)?n:null}function K2(r,e,t=!1){const n=URL.parse(r);return n?(n.hash=e,n.href):t&&X2(r,"http://example.com")?r.split("#",1)[0]+`${e?`#${e}`:""}`:""}function hi(r,e,t,n=!1){return Object.defineProperty(r,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}const mh=(function(){function e(t,n){this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e})();class Cb extends mh{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Pm extends mh{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class ty extends mh{constructor(e){super(e,"InvalidPDFException")}}class Qg extends mh{constructor(e,t,n){super(e,"ResponseException"),this.status=t,this.missing=n}}class k3 extends mh{constructor(e){super(e,"FormatError")}}class Mu extends mh{constructor(e){super(e,"AbortException")}}function Z2(r){(typeof r!="object"||r?.length===void 0)&&Xs("Invalid argument for bytesToString");const e=r.length,t=8192;if(e<t)return String.fromCharCode.apply(null,r);const n=[];for(let s=0;s<e;s+=t){const o=Math.min(s+t,e),d=r.subarray(s,o);n.push(String.fromCharCode.apply(null,d))}return n.join("")}function Tp(r){typeof r!="string"&&Xs("Invalid argument for stringToBytes");const e=r.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=r.charCodeAt(n)&255;return t}function j3(r){return String.fromCharCode(r>>24&255,r>>16&255,r>>8&255,r&255)}function N3(){const r=new Uint8Array(4);return r[0]=1,new Uint32Array(r.buffer,0,1)[0]===1}function P3(){try{return new Function(""),!0}catch{return!1}}class jo{static get isLittleEndian(){return hi(this,"isLittleEndian",N3())}static get isEvalSupported(){return hi(this,"isEvalSupported",P3())}static get isOffscreenCanvasSupported(){return hi(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return hi(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return hi(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return hi(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return hi(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){return hi(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Em=Array.from(Array(256).keys(),r=>r.toString(16).padStart(2,"0"));class un{static makeHexColor(e,t,n){return`#${Em[e]}${Em[t]}${Em[n]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,n=0){const s=e[n],o=e[n+1];e[n]=s*t[0]+o*t[2]+t[4],e[n+1]=s*t[1]+o*t[3]+t[5]}static applyTransformToBezier(e,t,n=0){const s=t[0],o=t[1],d=t[2],c=t[3],h=t[4],f=t[5];for(let m=0;m<6;m+=2){const b=e[n+m],A=e[n+m+1];e[n+m]=b*s+A*d+h,e[n+m+1]=b*o+A*c+f}}static applyInverseTransform(e,t){const n=e[0],s=e[1],o=t[0]*t[3]-t[1]*t[2];e[0]=(n*t[3]-s*t[2]+t[2]*t[5]-t[4]*t[3])/o,e[1]=(-n*t[1]+s*t[0]+t[4]*t[1]-t[5]*t[0])/o}static axialAlignedBoundingBox(e,t,n){const s=t[0],o=t[1],d=t[2],c=t[3],h=t[4],f=t[5],m=e[0],b=e[1],A=e[2],v=e[3];let E=s*m+h,x=E,k=s*A+h,j=k,$=c*b+f,z=$,B=c*v+f,F=B;if(o!==0||d!==0){const I=o*m,X=o*A,M=d*b,G=d*v;E+=M,j+=M,k+=G,x+=G,$+=I,F+=I,B+=X,z+=X}n[0]=Math.min(n[0],E,k,x,j),n[1]=Math.min(n[1],$,B,z,F),n[2]=Math.max(n[2],E,k,x,j),n[3]=Math.max(n[3],$,B,z,F)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const n=e[0],s=e[1],o=e[2],d=e[3],c=n**2+s**2,h=n*o+s*d,f=o**2+d**2,m=(c+f)/2,b=Math.sqrt(m**2-(c*f-h**2));t[0]=Math.sqrt(m+b||1),t[1]=Math.sqrt(m-b||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>s)return null;const o=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),d=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return o>d?null:[n,o,s,d]}static pointBoundingBox(e,t,n){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}static rectBoundingBox(e,t,n,s,o){o[0]=Math.min(o[0],e,n),o[1]=Math.min(o[1],t,s),o[2]=Math.max(o[2],e,n),o[3]=Math.max(o[3],t,s)}static#e(e,t,n,s,o,d,c,h,f,m){if(f<=0||f>=1)return;const b=1-f,A=f*f,v=A*f,E=b*(b*(b*e+3*f*t)+3*A*n)+v*s,x=b*(b*(b*o+3*f*d)+3*A*c)+v*h;m[0]=Math.min(m[0],E),m[1]=Math.min(m[1],x),m[2]=Math.max(m[2],E),m[3]=Math.max(m[3],x)}static#t(e,t,n,s,o,d,c,h,f,m,b,A){if(Math.abs(f)<1e-12){Math.abs(m)>=1e-12&&this.#e(e,t,n,s,o,d,c,h,-b/m,A);return}const v=m**2-4*b*f;if(v<0)return;const E=Math.sqrt(v),x=2*f;this.#e(e,t,n,s,o,d,c,h,(-m+E)/x,A),this.#e(e,t,n,s,o,d,c,h,(-m-E)/x,A)}static bezierBoundingBox(e,t,n,s,o,d,c,h,f){f[0]=Math.min(f[0],e,c),f[1]=Math.min(f[1],t,h),f[2]=Math.max(f[2],e,c),f[3]=Math.max(f[3],t,h),this.#t(e,n,o,c,t,s,d,h,3*(-e+3*(n-o)+c),6*(e-2*n+o),3*(n-e),f),this.#t(e,n,o,c,t,s,d,h,3*(-t+3*(s-d)+h),6*(t-2*s+d),3*(s-t),f)}}function E3(r){return decodeURIComponent(escape(r))}let Rm=null,_b=null;function R3(r){return Rm||(Rm=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,_b=new Map([["","t"]])),r.replaceAll(Rm,(e,t,n)=>t?t.normalize("NFKC"):_b.get(n))}function J2(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const r=new Uint8Array(32);return crypto.getRandomValues(r),Z2(r)}const lf="pdfjs_internal_id_";function D3(r,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[n,s,...o]=t;if(!r(n)&&!Number.isInteger(n)||!e(s))return!1;const d=o.length;let c=!0;switch(s.name){case"XYZ":if(d<2||d>3)return!1;break;case"Fit":case"FitB":return d===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(d>1)return!1;break;case"FitR":if(d!==4)return!1;c=!1;break;default:return!1}for(const h of o)if(!(typeof h=="number"||c&&h===null))return!1;return!0}function vl(r,e,t){return Math.min(Math.max(r,e),t)}function Q2(r){return Uint8Array.prototype.toBase64?r.toBase64():btoa(Z2(r))}function L3(r){return Uint8Array.fromBase64?Uint8Array.fromBase64(r):Tp(atob(r))}typeof Promise.try!="function"&&(Promise.try=function(r,...e){return new Promise(t=>{t(r(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(r){return r.reduce((e,t)=>e+t,0)});class bp{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};function s(o){if(!o)return;let d=null;const c=o.name;if(c==="#text")d=o.value;else if(bp.shouldBuildText(c))o?.attributes?.textContent?d=o.attributes.textContent:o.value&&(d=o.value);else return;if(d!==null&&t.push({str:d}),!!o.children)for(const h of o.children)s(h)}return s(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class ev{static setupStorage(e,t,n,s,o){const d=s.getValue(t,{value:null});switch(n.name){case"textarea":if(d.value!==null&&(e.textContent=d.value),o==="print")break;e.addEventListener("input",c=>{s.setValue(t,{value:c.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(d.value===n.attributes.xfaOn?e.setAttribute("checked",!0):d.value===n.attributes.xfaOff&&e.removeAttribute("checked"),o==="print")break;e.addEventListener("change",c=>{s.setValue(t,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(d.value!==null&&e.setAttribute("value",d.value),o==="print")break;e.addEventListener("input",c=>{s.setValue(t,{value:c.target.value})})}break;case"select":if(d.value!==null){e.setAttribute("value",d.value);for(const c of n.children)c.attributes.value===d.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}e.addEventListener("input",c=>{const h=c.target.options,f=h.selectedIndex===-1?"":h[h.selectedIndex].value;s.setValue(t,{value:f})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:s,linkService:o}){const{attributes:d}=t,c=e instanceof HTMLAnchorElement;d.type==="radio"&&(d.name=`${d.name}-${s}`);for(const[h,f]of Object.entries(d))if(f!=null)switch(h){case"class":f.length&&e.setAttribute(h,f.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",f);break;case"style":Object.assign(e.style,f);break;case"textContent":e.textContent=f;break;default:(!c||h!=="href"&&h!=="newWindow")&&e.setAttribute(h,f)}c&&o.addLinkAttributes(e,d.href,d.newWindow),n&&d.dataId&&this.setupStorage(e,d.dataId,t,n)}static render(e){const t=e.annotationStorage,n=e.linkService,s=e.xfaHtml,o=e.intent||"display",d=document.createElement(s.name);s.attributes&&this.setAttributes({html:d,element:s,intent:o,linkService:n});const c=o!=="richText",h=e.div;if(h.append(d),e.viewport){const b=`matrix(${e.viewport.transform.join(",")})`;h.style.transform=b}c&&h.setAttribute("class","xfaLayer xfaFont");const f=[];if(s.children.length===0){if(s.value){const b=document.createTextNode(s.value);d.append(b),c&&bp.shouldBuildText(s.name)&&f.push(b)}return{textDivs:f}}const m=[[s,-1,d]];for(;m.length>0;){const[b,A,v]=m.at(-1);if(A+1===b.children.length){m.pop();continue}const E=b.children[++m.at(-1)[1]];if(E===null)continue;const{name:x}=E;if(x==="#text"){const j=document.createTextNode(E.value);f.push(j),v.append(j);continue}const k=E?.attributes?.xmlns?document.createElementNS(E.attributes.xmlns,x):document.createElement(x);if(v.append(k),E.attributes&&this.setAttributes({html:k,element:E,storage:t,intent:o,linkService:n}),E.children?.length>0)m.push([E,-1,k]);else if(E.value){const j=document.createTextNode(E.value);c&&bp.shouldBuildText(x)&&f.push(j),k.append(j)}}for(const b of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))b.setAttribute("readOnly",!0);return{textDivs:f}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const $d="http://www.w3.org/2000/svg";class vf{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Cp(r,e="text"){if(cp(r,document.baseURI)){const t=await fetch(r);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{const s=new XMLHttpRequest;s.open("GET",r,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(s.response);return}t(s.responseText);return}n(new Error(s.statusText))}},s.send(null)})}class _p{constructor({viewBox:e,userUnit:t,scale:n,rotation:s,offsetX:o=0,offsetY:d=0,dontFlip:c=!1}){this.viewBox=e,this.userUnit=t,this.scale=n,this.rotation=s,this.offsetX=o,this.offsetY=d,n*=t;const h=(e[2]+e[0])/2,f=(e[3]+e[1])/2;let m,b,A,v;switch(s%=360,s<0&&(s+=360),s){case 180:m=-1,b=0,A=0,v=1;break;case 90:m=0,b=1,A=1,v=0;break;case 270:m=0,b=-1,A=-1,v=0;break;case 0:m=1,b=0,A=0,v=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(A=-A,v=-v);let E,x,k,j;m===0?(E=Math.abs(f-e[1])*n+o,x=Math.abs(h-e[0])*n+d,k=(e[3]-e[1])*n,j=(e[2]-e[0])*n):(E=Math.abs(h-e[0])*n+o,x=Math.abs(f-e[1])*n+d,k=(e[2]-e[0])*n,j=(e[3]-e[1])*n),this.transform=[m*n,b*n,A*n,v*n,E-m*n*h-A*n*f,x-b*n*h-v*n*f],this.width=k,this.height=j}get rawDims(){const e=this.viewBox;return hi(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:s=this.offsetY,dontFlip:o=!1}={}){return new _p({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:s,dontFlip:o})}convertToViewportPoint(e,t){const n=[e,t];return un.applyTransform(n,this.transform),n}convertToViewportRectangle(e){const t=[e[0],e[1]];un.applyTransform(t,this.transform);const n=[e[2],e[3]];return un.applyTransform(n,this.transform),[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){const n=[e,t];return un.applyInverseTransform(n,this.transform),n}}class wy extends mh{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function c0(r){const e=r.length;let t=0;for(;t<e&&r[t].trim()==="";)t++;return r.substring(t,t+5).toLowerCase()==="data:"}function Sy(r){return typeof r=="string"&&/\.pdf$/i.test(r)}function M3(r){return[r]=r.split(/[#?]/,1),r.substring(r.lastIndexOf("/")+1)}function z3(r,e="document.pdf"){if(typeof r!="string")return e;if(c0(r))return ui('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const n=(c=>{try{return new URL(c)}catch{try{return new URL(decodeURIComponent(c))}catch{try{return new URL(c,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(c),"https://foo.bar")}catch{return null}}}}})(r);if(!n)return e;const s=c=>{try{let h=decodeURIComponent(c);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:c):h}catch{return c}},o=/\.pdf$/i,d=n.pathname.split("/").at(-1);if(o.test(d))return s(d);if(n.searchParams.size>0){const c=Array.from(n.searchParams.values()).reverse();for(const f of c)if(o.test(f))return s(f);const h=Array.from(n.searchParams.keys()).reverse();for(const f of h)if(o.test(f))return s(f)}if(n.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(h)return s(h[0])}return e}class kb{started=Object.create(null);times=[];time(e){e in this.started&&ui(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||ui(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:s,end:o}of this.times)e.push(`${n.padEnd(t)} ${o-s}ms
`);return e.join("")}}function cp(r,e){const t=e?URL.parse(r,e):URL.parse(r);return t?.protocol==="http:"||t?.protocol==="https:"}function Uc(r){r.preventDefault()}function ta(r){r.preventDefault(),r.stopPropagation()}function I3(r){console.log("Deprecated API usage: "+r)}class ny{static#e;static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=this.#e.exec(e);if(!t)return null;const n=parseInt(t[1],10);let s=parseInt(t[2],10);s=s>=1&&s<=12?s-1:0;let o=parseInt(t[3],10);o=o>=1&&o<=31?o:1;let d=parseInt(t[4],10);d=d>=0&&d<=23?d:0;let c=parseInt(t[5],10);c=c>=0&&c<=59?c:0;let h=parseInt(t[6],10);h=h>=0&&h<=59?h:0;const f=t[7]||"Z";let m=parseInt(t[8],10);m=m>=0&&m<=23?m:0;let b=parseInt(t[9],10)||0;return b=b>=0&&b<=59?b:0,f==="-"?(d+=m,c+=b):f==="+"&&(d-=m,c-=b),new Date(Date.UTC(n,s,o,d,c,h))}}function B3(r,{scale:e=1,rotation:t=0}){const{width:n,height:s}=r.attributes.style,o=[0,0,parseInt(n),parseInt(s)];return new _p({viewBox:o,userUnit:1,scale:e,rotation:t})}function kp(r){if(r.startsWith("#")){const e=parseInt(r.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return r.startsWith("rgb(")?r.slice(4,-1).split(",").map(e=>parseInt(e)):r.startsWith("rgba(")?r.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(ui(`Not a valid color format: "${r}"`),[0,0,0])}function O3(r){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of r.keys()){e.style.color=t;const n=window.getComputedStyle(e).color;r.set(t,kp(n))}e.remove()}function Mr(r){const{a:e,b:t,c:n,d:s,e:o,f:d}=r.getTransform();return[e,t,n,s,o,d]}function vd(r){const{a:e,b:t,c:n,d:s,e:o,f:d}=r.getTransform().invertSelf();return[e,t,n,s,o,d]}function hh(r,e,t=!1,n=!0){if(e instanceof _p){const{pageWidth:s,pageHeight:o}=e.rawDims,{style:d}=r,c=jo.isCSSRoundSupported,h=`var(--total-scale-factor) * ${s}px`,f=`var(--total-scale-factor) * ${o}px`,m=c?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,b=c?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!t||e.rotation%180===0?(d.width=m,d.height=b):(d.width=b,d.height=m)}n&&r.setAttribute("data-main-rotation",e.rotation)}class kd{constructor(){const{pixelRatio:e}=kd;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,n,s,o=-1){let d=1/0,c=1/0,h=1/0;n=kd.capPixels(n,o),n>0&&(d=Math.sqrt(n/(e*t))),s!==-1&&(c=s/e,h=s/t);const f=Math.min(d,c,h);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,n):n}return e}}const iy=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class F3{static get isDarkMode(){return hi(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class U3{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:n}=window.getComputedStyle(e);return e.remove(),hi(this,"commentForegroundColor",kp(n))}}function H3(r,e,t,n){n=Math.min(Math.max(n??1,0),1);const s=255*(1-n);return r=Math.round(r*n+s),e=Math.round(e*n+s),t=Math.round(t*n+s),[r,e,t]}function jb(r,e){const t=r[0]/255,n=r[1]/255,s=r[2]/255,o=Math.max(t,n,s),d=Math.min(t,n,s),c=(o+d)/2;if(o===d)e[0]=e[1]=0;else{const h=o-d;switch(e[1]=c<.5?h/(o+d):h/(2-o-d),o){case t:e[0]=((n-s)/h+(n<s?6:0))*60;break;case n:e[0]=((s-t)/h+2)*60;break;case s:e[0]=((t-n)/h+4)*60;break}}e[2]=c}function sy(r,e){const t=r[0],n=r[1],s=r[2],o=(1-Math.abs(2*s-1))*n,d=o*(1-Math.abs(t/60%2-1)),c=s-o/2;switch(Math.floor(t/60)){case 0:e[0]=o+c,e[1]=d+c,e[2]=c;break;case 1:e[0]=d+c,e[1]=o+c,e[2]=c;break;case 2:e[0]=c,e[1]=o+c,e[2]=d+c;break;case 3:e[0]=c,e[1]=d+c,e[2]=o+c;break;case 4:e[0]=d+c,e[1]=c,e[2]=o+c;break;case 5:case 6:e[0]=o+c,e[1]=c,e[2]=d+c;break}}function Nb(r){return r<=.03928?r/12.92:((r+.055)/1.055)**2.4}function Pb(r,e,t){sy(r,t),t.map(Nb);const n=.2126*t[0]+.7152*t[1]+.0722*t[2];sy(e,t),t.map(Nb);const s=.2126*t[0]+.7152*t[1]+.0722*t[2];return n>s?(n+.05)/(s+.05):(s+.05)/(n+.05)}const Eb=new Map;function q3(r,e){const t=r[0]+r[1]*256+r[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let n=Eb.get(t);if(n)return n;const s=new Float32Array(9),o=s.subarray(0,3),d=s.subarray(3,6);jb(r,d);const c=s.subarray(6,9);jb(e,c);const h=c[2]<.5,f=h?12:4.5;if(d[2]=h?Math.sqrt(d[2]):1-Math.sqrt(1-d[2]),Pb(d,c,o)<f){let m,b;h?(m=d[2],b=1):(m=0,b=d[2]);const A=.005;for(;b-m>A;){const v=d[2]=(m+b)/2;h===Pb(d,c,o)<f?m=v:b=v}d[2]=h?b:m}return sy(d,o),n=un.makeHexColor(Math.round(o[0]*255),Math.round(o[1]*255),Math.round(o[2]*255)),Eb.set(t,n),n}function tv({html:r,dir:e,className:t},n){const s=document.createDocumentFragment();if(typeof r=="string"){const o=document.createElement("p");o.dir=e||"auto";const d=r.split(/(?:\r\n?|\n)/);for(let c=0,h=d.length;c<h;++c){const f=d[c];o.append(document.createTextNode(f)),c<h-1&&o.append(document.createElement("br"))}s.append(o)}else ev.render({xfaHtml:r,div:s,intent:"richText"});s.firstElementChild.classList.add("richText",t),n.append(s)}function nv(r){const e=new Path2D;if(!r)return e;for(let t=0,n=r.length;t<n;)switch(r[t++]){case ip.moveTo:e.moveTo(r[t++],r[t++]);break;case ip.lineTo:e.lineTo(r[t++],r[t++]);break;case ip.curveTo:e.bezierCurveTo(r[t++],r[t++],r[t++],r[t++],r[t++],r[t++]);break;case ip.quadraticCurveTo:e.quadraticCurveTo(r[t++],r[t++],r[t++],r[t++]);break;case ip.closePath:e.closePath();break;default:ui(`Unrecognized drawing path operator: ${r[t-1]}`);break}return e}class pp{#e=null;#t=null;#i;#n=null;#a=null;#r=null;#s=null;#o=null;static#c=null;constructor(e){this.#i=e,pp.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=this.#i._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",Uc,{signal:t}),e.addEventListener("pointerdown",pp.#l,{signal:t}));const n=this.#n=document.createElement("div");n.className="buttons",e.append(n);const s=this.#i.toolbarPosition;if(s){const{style:o}=e,d=this.#i._uiManager.direction==="ltr"?1-s[0]:s[0];o.insetInlineEnd=`${100*d}%`,o.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return this.#e}static#l(e){e.stopPropagation()}#h(e){this.#i._focusEventsAllowed=!1,ta(e)}#u(e){this.#i._focusEventsAllowed=!0,ta(e)}#f(e){const t=this.#i._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",this.#h.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#u.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Uc,{signal:t}),!0)}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#a?.shown(),this.#r?.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=this.#i,n=document.createElement("button");n.classList.add("basic","deleteButton"),n.tabIndex=0,n.setAttribute("data-l10n-id",pp.#c[e]),this.#f(n)&&n.addEventListener("click",s=>{t.delete()},{signal:t._signal}),this.#n.append(n)}get#m(){const e=document.createElement("div");return e.className="divider",e}async addAltText(e){const t=await e.render();this.#f(t),this.#n.append(t,this.#m),this.#a=e}addComment(e,t=null){if(this.#r)return;const n=e.renderForToolbar();if(!n)return;this.#f(n);const s=this.#s=this.#m;t?(this.#n.insertBefore(n,t),this.#n.insertBefore(s,t)):this.#n.append(n,s),this.#r=e,e.toolbar=this}addColorPicker(e){if(this.#t)return;this.#t=e;const t=e.renderButton();this.#f(t),this.#n.append(t,this.#m)}async addEditSignatureButton(e){const t=this.#o=await e.renderEditButton(this.#i);this.#f(t),this.#n.append(t,this.#m)}removeButton(e){switch(e){case"comment":this.#r?.removeToolbarCommentButton(),this.#r=null,this.#s?.remove(),this.#s=null;break}}async addButton(e,t){switch(e){case"colorPicker":t&&this.addColorPicker(t);break;case"altText":t&&await this.addAltText(t);break;case"editSignature":t&&await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":t&&this.addComment(t);break}}async addButtonBefore(e,t,n){if(!t&&e==="comment")return;const s=this.#n.querySelector(n);s&&e==="comment"&&this.addComment(t,s)}updateEditSignatureButton(e){this.#o&&(this.#o.title=e)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}}class V3{#e=null;#t=null;#i;constructor(e){this.#i=e}#n(){const e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar");const t=this.#i._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",Uc,{signal:t});const n=this.#e=document.createElement("div");return n.className="buttons",e.append(n),this.#i.hasCommentManager()&&this.#r("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#i.commentSelection("floating_button")}),this.#r("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#i.highlightSelection("floating_button")}),e}#a(e,t){let n=0,s=0;for(const o of e){const d=o.y+o.height;if(d<n)continue;const c=o.x+(t?o.width:0);if(d>n){s=c,n=d;continue}t?c>s&&(s=c):c<s&&(s=c)}return[t?1-s:s,n]}show(e,t,n){const[s,o]=this.#a(t,n),{style:d}=this.#t||=this.#n();e.append(this.#t),d.insetInlineEnd=`${100*s}%`,d.top=`calc(${100*o}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#r(e,t,n,s){const o=document.createElement("button");o.classList.add("basic",e),o.tabIndex=0,o.setAttribute("data-l10n-id",t);const d=document.createElement("span");o.append(d),d.className="visuallyHidden",d.setAttribute("data-l10n-id",n);const c=this.#i._signal;c instanceof AbortSignal&&!c.aborted&&(o.addEventListener("contextmenu",Uc,{signal:c}),o.addEventListener("click",s,{signal:c})),this.#e.append(o)}}function iv(r,e,t){for(const n of t)e.addEventListener(n,r[n].bind(r))}class bs{static#e=NaN;static#t=null;static#i=NaN;static#n=null;static initializeAndAddPointerId(e){(bs.#t||=new Set).add(e)}static setPointer(e,t){bs.#e||=t,bs.#n??=e}static setTimeStamp(e){bs.#i=e}static isSamePointerId(e){return bs.#e===e}static isSamePointerIdOrRemove(e){return bs.#e===e?!0:(bs.#t?.delete(e),!1)}static isSamePointerType(e){return bs.#n===e}static isInitializedAndDifferentPointerType(e){return bs.#n!==null&&!bs.isSamePointerType(e)}static isSameTimeStamp(e){return bs.#i===e}static isUsingMultiplePointers(){return bs.#t?.size>=1}static clearPointerType(){bs.#n=null}static clearPointerIds(){bs.#e=NaN,bs.#t=null}static clearTimeStamp(){bs.#i=NaN}}class W3{#e=0;get id(){return`${yp}${this.#e++}`}}class Ay{#e=J2();#t=0;#i=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=e;const o=s.decode().then(()=>(n.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return hi(this,"_isSVGFittingCanvas",o)}async#n(e,t){this.#i||=new Map;let n=this.#i.get(e);if(n===null)return null;if(n?.bitmap)return n.refCounter+=1,n;try{n||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let s;if(typeof t=="string"?(n.url=t,s=await Cp(t,"blob")):t instanceof File?s=n.file=t:t instanceof Blob&&(s=t),s.type==="image/svg+xml"){const o=Ay._isSVGFittingCanvas,d=new FileReader,c=new Image,h=new Promise((f,m)=>{c.onload=()=>{n.bitmap=c,n.isSvg=!0,f()},d.onload=async()=>{const b=n.svgUrl=d.result;c.src=await o?`${b}#svgView(preserveAspectRatio(none))`:b},c.onerror=d.onerror=m});d.readAsDataURL(s),await h}else n.bitmap=await createImageBitmap(s);n.refCounter=1}catch(s){ui(s),n=null}return this.#i.set(e,n),n&&this.#i.set(n.id,n),n}async getFromFile(e){const{lastModified:t,name:n,size:s,type:o}=e;return this.#n(`${t}_${n}_${s}_${o}`,e)}async getFromUrl(e){return this.#n(e,e)}async getFromBlob(e,t){const n=await t;return this.#n(e,n)}async getFromId(e){this.#i||=new Map;const t=this.#i.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:n}=t;return delete t.blobPromise,this.getFromBlob(t.id,n)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#i||=new Map;let n=this.#i.get(e);if(n?.bitmap)return n.refCounter+=1,n;const s=new OffscreenCanvas(t.width,t.height);return s.getContext("2d").drawImage(t,0,0),n={bitmap:s.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#i.set(e,n),this.#i.set(n.id,n),n}getSvgUrl(e){const t=this.#i.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#i||=new Map;const t=this.#i.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:n}=t;if(!t.url&&!t.file){const s=new OffscreenCanvas(n.width,n.height);s.getContext("bitmaprenderer").transferFromImageBitmap(n),t.blobPromise=s.convertToBlob()}n.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}}class $3{#e=[];#t=!1;#i;#n=-1;constructor(e=128){this.#i=e}add({cmd:e,undo:t,post:n,mustExec:s,type:o=NaN,overwriteIfSameType:d=!1,keepUndo:c=!1}){if(s&&e(),this.#t)return;const h={cmd:e,undo:t,post:n,type:o};if(this.#n===-1){this.#e.length>0&&(this.#e.length=0),this.#n=0,this.#e.push(h);return}if(d&&this.#e[this.#n].type===o){c&&(h.undo=this.#e[this.#n].undo),this.#e[this.#n]=h;return}const f=this.#n+1;f===this.#i?this.#e.splice(0,1):(this.#n=f,f<this.#e.length&&this.#e.splice(f)),this.#e.push(h)}undo(){if(this.#n===-1)return;this.#t=!0;const{undo:e,post:t}=this.#e[this.#n];e(),t?.(),this.#t=!1,this.#n-=1}redo(){if(this.#n<this.#e.length-1){this.#n+=1,this.#t=!0;const{cmd:e,post:t}=this.#e[this.#n];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#e.length-1}cleanType(e){if(this.#n!==-1){for(let t=this.#n;t>=0;t--)if(this.#e[t].type!==e){this.#e.splice(t+1,this.#n-t),this.#n=t;return}this.#e.length=0,this.#n=-1}}destroy(){this.#e=null}}class jp{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=jo.platform;for(const[n,s,o={}]of e)for(const d of n){const c=d.startsWith("mac+");t&&c?(this.callbacks.set(d.slice(4),{callback:s,options:o}),this.allKeys.add(d.split("+").at(-1))):!t&&!c&&(this.callbacks.set(d,{callback:s,options:o}),this.allKeys.add(d.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(this.#e(t));if(!n)return;const{callback:s,options:{bubbles:o=!1,args:d=[],checker:c=null}}=n;c&&!c(e,t)||(s.bind(e,...d,t)(),o||ta(t))}}class Ty{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return O3(e),hi(this,"_colors",e)}convert(e){const t=kp(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,s]of this._colors)if(s.every((o,d)=>o===t[d]))return Ty._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?un.makeHexColor(...t):e}}class zu{#e=new AbortController;#t=null;#i=null;#n=new Map;#a=new Map;#r=null;#s=null;#o=null;#c=new $3;#l=null;#h=null;#u=null;#f=0;#m=new Set;#g=null;#d=null;#p=new Set;_editorUndoBar=null;#y=!1;#b=!1;#x=!1;#C=null;#A=null;#w=null;#k=null;#v=!1;#T=null;#P=new W3;#j=!1;#N=!1;#I=!1;#R=null;#L=null;#B=null;#M=null;#V=null;#_=mi.NONE;#S=new Set;#D=null;#O=null;#U=null;#G=null;#$=null;#Y={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#H=[0,0];#z=null;#W=null;#J=null;#Q=null;#F=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=zu.prototype,t=d=>d.#W.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&d.hasSomethingToControl(),n=(d,{target:c})=>{if(c instanceof HTMLInputElement){const{type:h}=c;return h!=="text"&&h!=="number"}return!0},s=this.TRANSLATE_SMALL,o=this.TRANSLATE_BIG;return hi(this,"_keyboardManager",new jp([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(d,{target:c})=>!(c instanceof HTMLButtonElement)&&d.#W.contains(c)&&!d.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(d,{target:c})=>!(c instanceof HTMLButtonElement)&&d.#W.contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-o,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[o,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-o],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,o],checker:t}]]))}constructor(e,t,n,s,o,d,c,h,f,m,b,A,v,E,x,k){const j=this._signal=this.#e.signal;this.#W=e,this.#J=t,this.#Q=n,this.#r=s,this.#l=o,this.#O=d,this.#$=h,this._eventBus=c,c._on("editingaction",this.onEditingAction.bind(this),{signal:j}),c._on("pagechanging",this.onPageChanging.bind(this),{signal:j}),c._on("scalechanging",this.onScaleChanging.bind(this),{signal:j}),c._on("rotationchanging",this.onRotationChanging.bind(this),{signal:j}),c._on("setpreference",this.onSetPreference.bind(this),{signal:j}),c._on("switchannotationeditorparams",$=>this.updateParams($.type,$.value),{signal:j}),window.addEventListener("pointerdown",()=>{this.#N=!0},{capture:!0,signal:j}),window.addEventListener("pointerup",()=>{this.#N=!1},{capture:!0,signal:j}),this.#ae(),this.#he(),this.#te(),this.#s=h.annotationStorage,this.#C=h.filterFactory,this.#U=f,this.#k=m||null,this.#y=b,this.#b=A,this.#x=v,this.#V=E||null,this.viewParameters={realScale:vf.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=x||null,this._supportsPinchToZoom=k!==!1,o?.setSidebarUiManager(this)}destroy(){this.#F?.resolve(),this.#F=null,this.#e?.abort(),this.#e=null,this._signal=null;for(const e of this.#a.values())e.destroy();this.#a.clear(),this.#n.clear(),this.#p.clear(),this.#M?.clear(),this.#t=null,this.#S.clear(),this.#c.destroy(),this.#r?.destroy(),this.#l?.destroy(),this.#O?.destroy(),this.#T?.hide(),this.#T=null,this.#B?.destroy(),this.#B=null,this.#i=null,this.#A&&(clearTimeout(this.#A),this.#A=null),this.#z&&(clearTimeout(this.#z),this.#z=null),this._editorUndoBar?.destroy(),this.#$=null}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#V}get useNewAltTextFlow(){return this.#b}get useNewAltTextWhenAddingImage(){return this.#x}get hcmFilter(){return hi(this,"hcmFilter",this.#U?this.#C.addHCMFilter(this.#U.foreground,this.#U.background):"none")}get direction(){return hi(this,"direction",getComputedStyle(this.#W).direction)}get _highlightColors(){return hi(this,"_highlightColors",this.#k?new Map(this.#k.split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return hi(this,"highlightColors",null);const t=new Map,n=!!this.#U;for(const[s,o]of e){const d=s.endsWith("_HCM");if(n&&d){t.set(s.replace("_HCM",""),o);continue}!n&&!d&&t.set(s,o)}return hi(this,"highlightColors",t)}get highlightColorNames(){return hi(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#u=e}setMainHighlightColorPicker(e){this.#B=e}editAltText(e,t=!1){this.#r?.editAltText(this,e,t)}hasCommentManager(){return!!this.#l}editComment(e,t,n,s){this.#l?.showDialog(this,e,t,n,s)}selectComment(e,t){this.#a.get(e)?.getEditorByUID(t)?.toggleComment(!0,!0)}updateComment(e){this.#l?.updateComment(e.getData())}updatePopupColor(e){this.#l?.updatePopupColor(e)}removeComment(e){this.#l?.removeComments([e.uid])}toggleComment(e,t,n=void 0){this.#l?.toggleCommentPopup(e,t,n)}makeCommentColor(e,t){return e&&this.#l?.makeCommentColor(e,t)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(e){if(this.#a.has(e-1))return;const{resolve:t,promise:n}=Promise.withResolvers(),s=o=>{o.pageNumber===e&&(this._eventBus._off("editorsrendered",s),t())};this._eventBus.on("editorsrendered",s),await n}getSignature(e){this.#O?.getSignature({uiManager:this,editor:e})}get signatureManager(){return this.#O}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":this.#x=t;break}}onPageChanging({pageNumber:e}){this.#f=e-1}focusMainContainer(){this.#W.focus()}findParent(e,t){for(const n of this.#a.values()){const{x:s,y:o,width:d,height:c}=n.div.getBoundingClientRect();if(e>=s&&e<=s+d&&t>=o&&t<=o+c)return n}return null}disableUserSelect(e=!1){this.#J.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#p.add(e)}removeShouldRescale(e){this.#p.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*vf.PDF_TO_CSS_UNITS;for(const t of this.#p)t.onScaleChanging();this.#u?.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}#Z({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e}#ee(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of this.#a.values())if(n.hasTextLayer(e))return n;return null}highlightSelection(e="",t=!1){const n=document.getSelection();if(!n||n.isCollapsed)return;const{anchorNode:s,anchorOffset:o,focusNode:d,focusOffset:c}=n,h=n.toString(),m=this.#Z(n).closest(".textLayer"),b=this.getSelectionBoxes(m);if(!b)return;n.empty();const A=this.#ee(m),v=this.#_===mi.NONE,E=()=>{const x=A?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:b,anchorNode:s,anchorOffset:o,focusNode:d,focusOffset:c,text:h});v&&this.showAllEditors("highlight",!0,!0),t&&x?.editComment()};if(v){this.switchToMode(mi.HIGHLIGHT,E);return}E()}commentSelection(e=""){this.highlightSelection(e,!0)}#se(){const e=document.getSelection();if(!e||e.isCollapsed)return;const n=this.#Z(e).closest(".textLayer"),s=this.getSelectionBoxes(n);s&&(this.#T||=new V3(this),this.#T.show(n,s,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(e){if(!this.#s)return null;const t=`${yp}${e}`,n=this.#s.getRawValue(t);return n&&this.#s.remove(t),n}addToAnnotationStorage(e){!e.isEmpty()&&this.#s&&!this.#s.has(e.id)&&this.#s.setValue(e.id,e)}a11yAlert(e,t=null){const n=this.#Q;n&&(n.setAttribute("data-l10n-id",e),t?n.setAttribute("data-l10n-args",JSON.stringify(t)):n.removeAttribute("data-l10n-args"))}#re(){const e=document.getSelection();if(!e||e.isCollapsed){this.#D&&(this.#T?.hide(),this.#D=null,this.#E({hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===this.#D)return;const s=this.#Z(e).closest(".textLayer");if(!s){this.#D&&(this.#T?.hide(),this.#D=null,this.#E({hasSelectedText:!1}));return}if(this.#T?.hide(),this.#D=t,this.#E({hasSelectedText:!0}),!(this.#_!==mi.HIGHLIGHT&&this.#_!==mi.NONE)&&(this.#_===mi.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#v=this.isShiftKeyDown,!this.isShiftKeyDown)){const o=this.#_===mi.HIGHLIGHT?this.#ee(s):null;if(o?.toggleDrawing(),this.#N){const d=new AbortController,c=this.combinedSignal(d),h=f=>{f.type==="pointerup"&&f.button!==0||(d.abort(),o?.toggleDrawing(!0),f.type==="pointerup"&&this.#X("main_toolbar"))};window.addEventListener("pointerup",h,{signal:c}),window.addEventListener("blur",h,{signal:c})}else o?.toggleDrawing(!0),this.#X("main_toolbar")}}#X(e=""){this.#_===mi.HIGHLIGHT?this.highlightSelection(e):this.#y&&this.#se()}#ae(){document.addEventListener("selectionchange",this.#re.bind(this),{signal:this._signal})}#oe(){if(this.#w)return;this.#w=new AbortController;const e=this.combinedSignal(this.#w);window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}#le(){this.#w?.abort(),this.#w=null}blur(){if(this.isShiftKeyDown=!1,this.#v&&(this.#v=!1,this.#X("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#S)if(t.div.contains(e)){this.#L=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#L)return;const[e,t]=this.#L;this.#L=null,t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}#te(){if(this.#R)return;this.#R=new AbortController;const e=this.combinedSignal(this.#R);window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}#ce(){this.#R?.abort(),this.#R=null}#de(){if(this.#h)return;this.#h=new AbortController;const e=this.combinedSignal(this.#h);document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}#ue(){this.#h?.abort(),this.#h=null}#he(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#te(),this.setEditingState(!0)}removeEditListeners(){this.#ce(),this.setEditingState(!1)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of this.#d)if(n.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const n of this.#d)if(n.isHandlingMimeForPasting(t.type)){n.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const n of this.#S){const s=n.serialize(!0);s&&t.push(s)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const o of t.items)for(const d of this.#d)if(d.isHandlingMimeForPasting(o.type)){d.paste(o,this.currentLayer);return}let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(o){ui(`paste: "${o.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const s=this.currentLayer;try{const o=[];for(const h of n){const f=await s.deserialize(h);if(!f)return;o.push(f)}const d=()=>{for(const h of o)this.#ne(h);this.#ie(o)},c=()=>{for(const h of o)h.remove()};this.addCommands({cmd:d,undo:c,mustExec:!0})}catch(o){ui(`paste: "${o.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),this.#_!==mi.NONE&&!this.isEditorHandlingKeyboard&&zu._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,this.#v&&(this.#v=!1,this.#X("main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#E(e){Object.entries(e).some(([n,s])=>this.#Y[n]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#Y,e)}),this.#_===mi.HIGHLIGHT&&e.hasSelectedEditor===!1&&this.#q([[Ki.HIGHLIGHT_FREE,!0]]))}#q(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#oe(),this.#de(),this.#E({isEditing:this.#_!==mi.NONE,isEmpty:this.#K(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#le(),this.#ue(),this.#E({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#d){this.#d=e;for(const t of this.#d)this.#q(t.defaultPropertiesToUpdate)}}getId(){return this.#P.id}get currentLayer(){return this.#a.get(this.#f)}getLayer(e){return this.#a.get(e)}get currentPageIndex(){return this.#f}addLayer(e){this.#a.set(e.pageIndex,e),this.#j?e.enable():e.disable()}removeLayer(e){this.#a.delete(e.pageIndex)}async updateMode(e,t=null,n=!1,s=!1,o=!1){if(this.#_!==e&&!(this.#F&&(await this.#F.promise,!this.#F))){if(this.#F=Promise.withResolvers(),this.#u?.commitOrRemove(),this.#_===mi.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#_=e,e===mi.NONE){this.setEditingState(!1),this.#pe();for(const d of this.#n.values())d.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#F.resolve();return}for(const d of this.#n.values())d.addStandaloneCommentButton();e===mi.SIGNATURE&&await this.#O?.loadSignatures(),this.setEditingState(!0),await this.#fe(),this.unselectAll();for(const d of this.#a.values())d.updateMode(e);if(e===mi.POPUP){this.#i||=await this.#$.getAnnotationsByType(new Set(this.#d.map(h=>h._editorType)));const d=new Set,c=[];for(const h of this.#n.values()){const{annotationElementId:f,hasComment:m,deleted:b}=h;f&&d.add(f),m&&!b&&c.push(h.getData())}for(const h of this.#i){const{id:f,popupRef:m,contentsObj:b}=h;m&&b?.str&&!d.has(f)&&!this.#m.has(f)&&c.push(h)}this.#l?.showSidebar(c)}if(!t){n&&this.addNewEditorFromKeyboard(),this.#F.resolve();return}for(const d of this.#n.values())d.uid===t?(this.setSelected(d),o?d.editComment():s?d.enterInEditMode():d.focus()):d.unselect();this.#F.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==this.#_&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(this.#d){switch(e){case Ki.CREATE:this.currentLayer.addNewEditor(t);return;case Ki.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#G||=new Map).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const n of this.#S)n.updateParams(e,t);else for(const n of this.#d)n.updateDefaultParams(e,t)}}showAllEditors(e,t,n=!1){for(const o of this.#n.values())o.editorType===e&&o.show(t);(this.#G?.get(Ki.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#q([[Ki.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(this.#I!==e){this.#I=e;for(const t of this.#a.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}async#fe(){if(!this.#j){this.#j=!0;const e=[];for(const t of this.#a.values())e.push(t.enable());await Promise.all(e);for(const t of this.#n.values())t.enable()}}#pe(){if(this.unselectAll(),this.#j){this.#j=!1;for(const e of this.#a.values())e.disable();for(const e of this.#n.values())e.disable()}}*getEditors(e){for(const t of this.#n.values())t.pageIndex===e&&(yield t)}getEditor(e){return this.#n.get(e)}addEditor(e){this.#n.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#A&&clearTimeout(this.#A),this.#A=setTimeout(()=>{this.focusMainContainer(),this.#A=null},0)),this.#n.delete(e.id),e.annotationElementId&&this.#M?.delete(e.annotationElementId),this.unselect(e),(!e.annotationElementId||!this.#m.has(e.annotationElementId))&&this.#s?.remove(e.id)}addDeletedAnnotationElement(e){this.#m.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#m.has(e)}removeDeletedAnnotationElement(e){this.#m.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#ne(e){const t=this.#a.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#q(e.propertiesToUpdate))}get#ge(){let e=null;for(e of this.#S);return e}updateUI(e){this.#ge===e&&this.#q(e.propertiesToUpdate)}updateUIForDefaultProperties(e){this.#q(e.defaultPropertiesToUpdate)}toggleSelected(e){if(this.#S.has(e)){this.#S.delete(e),e.unselect(),this.#E({hasSelectedEditor:this.hasSelection});return}this.#S.add(e),e.select(),this.#q(e.propertiesToUpdate),this.#E({hasSelectedEditor:!0})}setSelected(e){this.updateToolbar({mode:e.mode,editId:e.uid}),this.#u?.commitOrRemove();for(const t of this.#S)t!==e&&t.unselect();this.#S.clear(),this.#S.add(e),e.select(),this.#q(e.propertiesToUpdate),this.#E({hasSelectedEditor:!0})}isSelected(e){return this.#S.has(e)}get firstSelectedEditor(){return this.#S.values().next().value}unselect(e){e.unselect(),this.#S.delete(e),this.#E({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#S.size!==0}get isEnterHandled(){return this.#S.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#E({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#K()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#E({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#K()})}addCommands(e){this.#c.add(e),this.#E({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#K()})}cleanUndoStack(e){this.#c.cleanType(e)}#K(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const e of this.#n.values())return e.isEmpty();return!1}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...this.#S],n=()=>{this._editorUndoBar?.show(s,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},s=()=>{for(const o of t)this.#ne(o)};this.addCommands({cmd:n,undo:s,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#ie(e){for(const t of this.#S)t.unselect();this.#S.clear();for(const t of e)t.isEmpty()||(this.#S.add(t),t.select());this.#E({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#S)e.commit();this.#ie(this.#n.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#_!==mi.NONE))&&!this.#u?.commitOrRemove()&&this.hasSelection){for(const e of this.#S)e.unselect();this.#S.clear(),this.#E({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#H[0]+=e,this.#H[1]+=t;const[s,o]=this.#H,d=[...this.#S],c=1e3;this.#z&&clearTimeout(this.#z),this.#z=setTimeout(()=>{this.#z=null,this.#H[0]=this.#H[1]=0,this.addCommands({cmd:()=>{for(const h of d)this.#n.has(h.id)&&(h.translateInPage(s,o),h.translationDone())},undo:()=>{for(const h of d)this.#n.has(h.id)&&(h.translateInPage(-s,-o),h.translationDone())},mustExec:!1})},c);for(const h of d)h.translateInPage(e,t),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#g=new Map;for(const e of this.#S)this.#g.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#g)return!1;this.disableUserSelect(!1);const e=this.#g;this.#g=null;let t=!1;for(const[{x:s,y:o,pageIndex:d},c]of e)c.newX=s,c.newY=o,c.newPageIndex=d,t||=s!==c.savedX||o!==c.savedY||d!==c.savedPageIndex;if(!t)return!1;const n=(s,o,d,c)=>{if(this.#n.has(s.id)){const h=this.#a.get(c);h?s._setParentAndPosition(h,o,d):(s.pageIndex=c,s.x=o,s.y=d)}};return this.addCommands({cmd:()=>{for(const[s,{newX:o,newY:d,newPageIndex:c}]of e)n(s,o,d,c)},undo:()=>{for(const[s,{savedX:o,savedY:d,savedPageIndex:c}]of e)n(s,o,d,c)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#g)for(const n of this.#g.keys())n.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#S.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#_}isEditingMode(){return this.#_!==mi.NONE}get imageManager(){return hi(this,"imageManager",new Ay)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let f=0,m=t.rangeCount;f<m;f++)if(!e.contains(t.getRangeAt(f).commonAncestorContainer))return null;const{x:n,y:s,width:o,height:d}=e.getBoundingClientRect();let c;switch(e.getAttribute("data-main-rotation")){case"90":c=(f,m,b,A)=>({x:(m-s)/d,y:1-(f+b-n)/o,width:A/d,height:b/o});break;case"180":c=(f,m,b,A)=>({x:1-(f+b-n)/o,y:1-(m+A-s)/d,width:b/o,height:A/d});break;case"270":c=(f,m,b,A)=>({x:1-(m+A-s)/d,y:(f-n)/o,width:A/d,height:b/o});break;default:c=(f,m,b,A)=>({x:(f-n)/o,y:(m-s)/d,width:b/o,height:A/d});break}const h=[];for(let f=0,m=t.rangeCount;f<m;f++){const b=t.getRangeAt(f);if(!b.collapsed)for(const{x:A,y:v,width:E,height:x}of b.getClientRects())E===0||x===0||h.push(c(A,v,E,x))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:e,id:t}){(this.#o||=new Map).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){this.#o?.delete(e)}renderAnnotationElement(e){const t=this.#o?.get(e.data.id);if(!t)return;const n=this.#s.getRawValue(t);n&&(this.#_===mi.NONE&&!n.hasBeenModified||n.renderAnnotationElement(e))}setMissingCanvas(e,t,n){const s=this.#M?.get(e);s&&(s.setCanvas(t,n),this.#M.delete(e))}addMissingCanvas(e,t){(this.#M||=new Map).set(e,t)}}class Td{#e=null;#t=!1;#i=null;#n=null;#a=null;#r=null;#s=!1;#o=null;#c=null;#l=null;#h=null;#u=!1;static#f=null;static _l10n=null;constructor(e){this.#c=e,this.#u=e._uiManager.useNewAltTextFlow,Td.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(e){Td._l10n??=e}async render(){const e=this.#i=document.createElement("button");e.className="altText",e.tabIndex="0";const t=this.#n=document.createElement("span");e.append(t),this.#u?(e.classList.add("new"),e.setAttribute("data-l10n-id",Td.#f.missing),t.setAttribute("data-l10n-id",Td.#f["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=this.#c._uiManager._signal;e.addEventListener("contextmenu",Uc,{signal:n}),e.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:n});const s=o=>{o.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#u&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#m}})};return e.addEventListener("click",s,{capture:!0,signal:n}),e.addEventListener("keydown",o=>{o.target===e&&o.key==="Enter"&&(this.#s=!0,s(o))},{signal:n}),await this.#g(),e}get#m(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#i&&(this.#i.focus({focusVisible:this.#s}),this.#s=!1)}isEmpty(){return this.#u?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#u?this.#e!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(e){this.#e===null&&(this.#l=e,this.#h=await Td._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e}),this.#g())}toggleAltTextBadge(e=!1){if(!this.#u||this.#e){this.#o?.remove(),this.#o=null;return}if(!this.#o){const t=this.#o=document.createElement("div");t.className="noAltTextBadge",this.#c.div.append(t)}this.#o.classList.toggle("hidden",!e)}serialize(e){let t=this.#e;return!e&&this.#l===t&&(t=this.#h),{altText:t,decorative:this.#t,guessedText:this.#l,textWithDisclaimer:this.#h}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:e,decorative:t,guessedText:n,textWithDisclaimer:s,cancel:o=!1}){n&&(this.#l=n,this.#h=s),!(this.#e===e&&this.#t===t)&&(o||(this.#e=e,this.#t=t),this.#g())}toggle(e=!1){this.#i&&(!e&&this.#r&&(clearTimeout(this.#r),this.#r=null),this.#i.disabled=!e)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#m}})}destroy(){this.#i?.remove(),this.#i=null,this.#n=null,this.#a=null,this.#o?.remove(),this.#o=null}async#g(){const e=this.#i;if(!e)return;if(this.#u){if(e.classList.toggle("done",!!this.#e),e.setAttribute("data-l10n-id",Td.#f[this.#m]),this.#n?.setAttribute("data-l10n-id",Td.#f[`${this.#m}-label`]),!this.#e){this.#a?.remove();return}}else{if(!this.#e&&!this.#t){e.classList.remove("done"),this.#a?.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=this.#a;if(!t){this.#a=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${this.#c.id}`;const s=100,o=this.#c._uiManager._signal;o.addEventListener("abort",()=>{clearTimeout(this.#r),this.#r=null},{once:!0}),e.addEventListener("mouseenter",()=>{this.#r=setTimeout(()=>{this.#r=null,this.#a.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},s)},{signal:o}),e.addEventListener("mouseleave",()=>{this.#r&&(clearTimeout(this.#r),this.#r=null),this.#a?.classList.remove("show")},{signal:o})}this.#t?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=this.#e),t.parentNode||e.append(t),this.#c.getElementForAltText()?.setAttribute("aria-describedby",t.id)}}class Pg{#e=null;#t=null;#i=!1;#n=null;#a=null;#r=null;#s=null;#o=null;#c=!1;#l=null;constructor(e){this.#n=e}renderForToolbar(){const e=this.#t=document.createElement("button");return e.className="comment",this.#h(e,!1)}renderForStandalone(){const e=this.#e=document.createElement("button");e.className="annotationCommentButton";const t=this.#n.commentButtonPosition;if(t){const{style:n}=e;n.insetInlineEnd=`calc(${100*(this.#n._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,n.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const s=this.#n.commentButtonColor;s&&(n.backgroundColor=s)}return this.#h(e,!0)}focusButton(){setTimeout(()=>{(this.#e??this.#t)?.focus()},0)}onUpdatedColor(){if(!this.#e)return;const e=this.#n.commentButtonColor;e&&(this.#e.style.backgroundColor=e),this.#n._uiManager.updatePopupColor(this.#n)}get commentButtonWidth(){return(this.#e?.getBoundingClientRect().width??0)/this.#n.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#e)return null;const{x:e,y:t,height:n}=this.#e.getBoundingClientRect(),{x:s,y:o,width:d,height:c}=this.#n.parent.boundingClientRect;return[(e-s)/d,(t+n-o)/c]}set commentPopupPositionInLayer(e){this.#l=e}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#e?.remove(),this.#e=null}removeToolbarCommentButton(){this.#t?.remove(),this.#t=null}setCommentButtonStates({selected:e,hasPopup:t}){this.#e&&(this.#e.classList.toggle("selected",e),this.#e.ariaExpanded=t)}#h(e,t){if(!this.#n._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[this.#n._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const n=this.#n._uiManager._signal;if(!(n instanceof AbortSignal)||n.aborted)return e;e.addEventListener("contextmenu",Uc,{signal:n}),t&&(e.addEventListener("focusin",o=>{this.#n._focusEventsAllowed=!1,ta(o)},{capture:!0,signal:n}),e.addEventListener("focusout",o=>{this.#n._focusEventsAllowed=!0,ta(o)},{capture:!0,signal:n})),e.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:n});const s=o=>{o.preventDefault(),e===this.#t?this.edit():this.#n.toggleComment(!0)};return e.addEventListener("click",s,{capture:!0,signal:n}),e.addEventListener("keydown",o=>{o.target===e&&o.key==="Enter"&&(this.#i=!0,s(o))},{signal:n}),e.addEventListener("pointerenter",()=>{this.#n.toggleComment(!1,!0)},{signal:n}),e.addEventListener("pointerleave",()=>{this.#n.toggleComment(!1,!1)},{signal:n}),e}edit(e){const t=this.commentPopupPositionInLayer;let n,s;if(t)[n,s]=t;else{[n,s]=this.#n.commentButtonPosition;const{width:m,height:b,x:A,y:v}=this.#n;n=A+n*m,s=v+s*b}const o=this.#n.parent.boundingClientRect,{x:d,y:c,width:h,height:f}=o;this.#n._uiManager.editComment(this.#n,d+n*h,c+s*f,{...e,parentDimensions:o})}finish(){this.#t&&(this.#t.focus({focusVisible:this.#i}),this.#i=!1)}isDeleted(){return this.#c||this.#s===""}isEmpty(){return this.#s===null}hasBeenEdited(){return this.isDeleted()||this.#s!==this.#a}serialize(){return this.data}get data(){return{text:this.#s,richText:this.#r,date:this.#o,deleted:this.isDeleted()}}set data(e){if(e!==this.#s&&(this.#r=null),e===null){this.#s="",this.#c=!0;return}this.#s=e,this.#o=new Date,this.#c=!1}setInitialText(e,t=null){this.#a=e,this.data=e,this.#o=null,this.#r=t}shown(){}destroy(){this.#t?.remove(),this.#t=null,this.#e?.remove(),this.#e=null,this.#s="",this.#r=null,this.#o=null,this.#n=null,this.#i=!1,this.#c=!1}}class d0{#e;#t=!1;#i=null;#n;#a;#r;#s;#o=null;#c;#l=null;#h;#u=null;constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:n=null,onPinchStart:s=null,onPinching:o=null,onPinchEnd:d=null,signal:c}){this.#e=e,this.#i=n,this.#n=t,this.#a=s,this.#r=o,this.#s=d,this.#h=new AbortController,this.#c=AbortSignal.any([c,this.#h.signal]),e.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/kd.pixelRatio}#f(e){if(this.#n?.())return;if(e.touches.length===1){if(this.#o)return;const s=this.#o=new AbortController,o=AbortSignal.any([this.#c,s.signal]),d=this.#e,c={capture:!0,signal:o,passive:!1},h=f=>{f.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};d.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(ta(f),h(f))},c),d.addEventListener("pointerup",h,c),d.addEventListener("pointercancel",h,c);return}if(!this.#u){this.#u=new AbortController;const s=AbortSignal.any([this.#c,this.#u.signal]),o=this.#e,d={signal:s,capture:!1,passive:!1};o.addEventListener("touchmove",this.#m.bind(this),d);const c=this.#g.bind(this);o.addEventListener("touchend",c,d),o.addEventListener("touchcancel",c,d),d.capture=!0,o.addEventListener("pointerdown",ta,d),o.addEventListener("pointermove",ta,d),o.addEventListener("pointercancel",ta,d),o.addEventListener("pointerup",ta,d),this.#a?.()}if(ta(e),e.touches.length!==2||this.#i?.()){this.#l=null;return}let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]),this.#l={touch0X:t.screenX,touch0Y:t.screenY,touch1X:n.screenX,touch1Y:n.screenY}}#m(e){if(!this.#l||e.touches.length!==2)return;ta(e);let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]);const{screenX:s,screenY:o}=t,{screenX:d,screenY:c}=n,h=this.#l,{touch0X:f,touch0Y:m,touch1X:b,touch1Y:A}=h,v=b-f,E=A-m,x=d-s,k=c-o,j=Math.hypot(x,k)||1,$=Math.hypot(v,E)||1;if(!this.#t&&Math.abs($-j)<=d0.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=s,h.touch0Y=o,h.touch1X=d,h.touch1Y=c,!this.#t){this.#t=!0;return}const z=[(s+d)/2,(o+c)/2];this.#r?.(z,$,j)}#g(e){e.touches.length>=2||(this.#u&&(this.#u.abort(),this.#u=null,this.#s?.()),this.#l&&(ta(e),this.#l=null,this.#t=!1))}destroy(){this.#h?.abort(),this.#h=null,this.#o?.abort(),this.#o=null}}class Mn{#e=null;#t=null;#i=null;#n=null;#a=null;#r=!1;#s=null;#o="";#c=null;#l=null;#h=null;#u=null;#f=null;#m="";#g=!1;#d=null;#p=!1;#y=!1;#b=!1;#x=null;#C=0;#A=0;#w=null;#k=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#v=!1;#T=Mn._zIndex++;static _borderLineWidth=-1;static _colorManager=new Ty;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=Mn.prototype._resizeWithKeyboard,t=zu.TRANSLATE_SMALL,n=zu.TRANSLATE_BIG;return hi(this,"_resizerKeyboardManager",new jp([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],Mn.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null,this.canAddComment=!0;const{rotation:t,rawDims:{pageWidth:n,pageHeight:s,pageX:o,pageY:d}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,s],this.pageTranslation=[o,d];const[c,h]=this.parentDimensions;this.x=e.x/c,this.y=e.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return hi(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new G3({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Mn._l10n??=e,Mn._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Mn._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);Mn._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Xs("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#v}set _isDraggable(e){this.#v=e,this.div?.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#T}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(this.#z(),this.#u?.remove(),this.#u=null),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#g?this.#g=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,s){const[o,d]=this.parentDimensions;[n,s]=this.screenToPageTranslation(n,s),this.x=(e+n)/o,this.y=(t+s)/d,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[n,s]=this.parentDimensions;this.setAt(e*n,t*s,this.width*n,this.height*s),this._onTranslated()}#P([e,t],n,s){[n,s]=this.screenToPageTranslation(n,s),this.x+=n/e,this.y+=s/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#P(this.parentDimensions,e,t)}translateInPage(e,t){this.#d||=[this.x,this.y,this.width,this.height],this.#P(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){this.#d||=[this.x,this.y,this.width,this.height];const{div:n,parentDimensions:[s,o]}=this;if(this.x+=e/s,this.y+=t/o,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:b,y:A}=this.div.getBoundingClientRect();this.parent.findNewParent(this,b,A)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:d,y:c}=this;const[h,f]=this.getBaseTranslation();d+=h,c+=f;const{style:m}=n;m.left=`${(100*d).toFixed(2)}%`,m.top=`${(100*c).toFixed(2)}%`,this._onTranslating(d,c),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#d&&(this.#d[0]!==this.x||this.#d[1]!==this.y)}get _hasBeenResized(){return!!this.#d&&(this.#d[2]!==this.width||this.#d[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=Mn,s=n/e,o=n/t;switch(this.rotation){case 90:return[-s,o];case 180:return[s,o];case 270:return[s,-o];default:return[-s,-o]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[n,s]}=this;let{x:o,y:d,width:c,height:h}=this;if(c*=n,h*=s,o*=n,d*=s,this._mustFixPosition)switch(e){case 0:o=vl(o,0,n-c),d=vl(d,0,s-h);break;case 90:o=vl(o,0,n-h),d=vl(d,c,s);break;case 180:o=vl(o,c,n),d=vl(d,h,s);break;case 270:o=vl(o,h,n),d=vl(d,0,s-c);break}this.x=o/=n,this.y=d/=s;const[f,m]=this.getBaseTranslation();o+=f,d+=m,t.left=`${(100*o).toFixed(2)}%`,t.top=`${(100*d).toFixed(2)}%`,this.moveInDOM()}static#j(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return Mn.#j(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return Mn.#j(e,t,360-this.parentRotation)}#N(e){switch(e){case 90:{const[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(){const{div:{style:e},width:t,height:n}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*n).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#I(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const s=document.createElement("div");this.#c.append(s),s.classList.add("resizer",n),s.setAttribute("data-resizer-name",n),s.addEventListener("pointerdown",this.#R.bind(this,n),{signal:t}),s.addEventListener("contextmenu",Uc,{signal:t}),s.tabIndex=-1}this.div.prepend(this.#c)}#R(e,t){t.preventDefault();const{isMac:n}=jo.platform;if(t.button!==0||t.ctrlKey&&n)return;this.#i?.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,this.#l=[t.screenX,t.screenY];const o=new AbortController,d=this._uiManager.combinedSignal(o);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#M.bind(this,e),{passive:!0,capture:!0,signal:d}),window.addEventListener("touchmove",ta,{passive:!1,signal:d}),window.addEventListener("contextmenu",Uc,{signal:d}),this.#h={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const c=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const f=()=>{o.abort(),this.parent.togglePointerEvents(!0),this.#i?.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=c,this.div.style.cursor=h,this.#B()};window.addEventListener("pointerup",f,{signal:d}),window.addEventListener("blur",f,{signal:d})}#L(e,t,n,s){this.width=n,this.height=s,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#B(){if(!this.#h)return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:s}=this.#h;this.#h=null;const o=this.x,d=this.y,c=this.width,h=this.height;o===e&&d===t&&c===n&&h===s||this.addCommands({cmd:this.#L.bind(this,o,d,c,h),undo:this.#L.bind(this,e,t,n,s),mustExec:!0})}static _round(e){return Math.round(e*1e4)/1e4}#M(e,t){const[n,s]=this.parentDimensions,o=this.x,d=this.y,c=this.width,h=this.height,f=Mn.MIN_SIZE/n,m=Mn.MIN_SIZE/s,b=this.#N(this.rotation),A=(q,J)=>[b[0]*q+b[2]*J,b[1]*q+b[3]*J],v=this.#N(360-this.rotation),E=(q,J)=>[v[0]*q+v[2]*J,v[1]*q+v[3]*J];let x,k,j=!1,$=!1;switch(e){case"topLeft":j=!0,x=(q,J)=>[0,0],k=(q,J)=>[q,J];break;case"topMiddle":x=(q,J)=>[q/2,0],k=(q,J)=>[q/2,J];break;case"topRight":j=!0,x=(q,J)=>[q,0],k=(q,J)=>[0,J];break;case"middleRight":$=!0,x=(q,J)=>[q,J/2],k=(q,J)=>[0,J/2];break;case"bottomRight":j=!0,x=(q,J)=>[q,J],k=(q,J)=>[0,0];break;case"bottomMiddle":x=(q,J)=>[q/2,J],k=(q,J)=>[q/2,0];break;case"bottomLeft":j=!0,x=(q,J)=>[0,J],k=(q,J)=>[q,0];break;case"middleLeft":$=!0,x=(q,J)=>[0,J/2],k=(q,J)=>[q,J/2];break}const z=x(c,h),B=k(c,h);let F=A(...B);const I=Mn._round(o+F[0]),X=Mn._round(d+F[1]);let M=1,G=1,U,_;if(t.fromKeyboard)({deltaX:U,deltaY:_}=t);else{const{screenX:q,screenY:J}=t,[ce,_e]=this.#l;[U,_]=this.screenToPageTranslation(q-ce,J-_e),this.#l[0]=q,this.#l[1]=J}if([U,_]=E(U/n,_/s),j){const q=Math.hypot(c,h);M=G=Math.max(Math.min(Math.hypot(B[0]-z[0]-U,B[1]-z[1]-_)/q,1/c,1/h),f/c,m/h)}else $?M=vl(Math.abs(B[0]-z[0]-U),f,1)/c:G=vl(Math.abs(B[1]-z[1]-_),m,1)/h;const N=Mn._round(c*M),te=Mn._round(h*G);F=A(...k(N,te));const ie=I-F[0],re=X-F[1];this.#d||=[this.x,this.y,this.width,this.height],this.width=N,this.height=te,this.x=ie,this.y=re,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#i?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#y)return this._editToolbar;this._editToolbar=new pp(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,n]of e)await this._editToolbar.addButton(t,n);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#i?.destroy()}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#i||(Td.initialize(Mn._l10n),this.#i=new Td(this),this.#e&&(this.#i.data=this.#e,this.#e=null)),this.#i}get altTextData(){return this.#i?.data}set altTextData(e){this.#i&&(this.#i.data=e)}get guessedAltText(){return this.#i?.guessedText}async setGuessedAltText(e){await this.#i?.setGuessedText(e)}serializeAltText(e){return this.#i?.serialize(e)}hasAltText(){return!!this.#i&&!this.#i.isEmpty()}hasAltTextData(){return this.#i?.hasData()??!1}focusCommentButton(){this.#n?.focusButton()}addCommentButton(){return this.canAddComment?this.#n||=new Pg(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#a){this._uiManager.isEditingMode()&&this.#a.classList.remove("hidden");return}this.hasComment&&(this.#a=this.#n.renderForStandalone(),this.div.append(this.#a))}}removeStandaloneCommentButton(){this.#n.removeStandaloneCommentButton(),this.#a=null}hideStandaloneCommentButton(){this.#a?.classList.add("hidden")}get comment(){const{data:{richText:e,text:t,date:n,deleted:s}}=this.#n;return{text:t,richText:e,date:n,deleted:s,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){this.#n||=new Pg(this),this.#n.data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:n}){if(!t||(this.#n||=new Pg(this),this.#n.setInitialText(e,n),!this.annotationElementId))return;const s=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);s&&this.updateFromAnnotationLayer(s)}get hasEditedComment(){return this.#n?.hasBeenEdited()}get hasDeletedComment(){return this.#n?.isDeleted()}get hasComment(){return!!this.#n&&!this.#n.isEmpty()&&!this.#n.isDeleted()}async editComment(e){this.#n||=new Pg(this),this.#n.edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){this.#n.setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,s]=e.rect,[o]=this.pageDimensions,[d]=this.pageTranslation,c=d+o+1,h=s-100,f=c+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[c,h,f,s]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){this.#n.data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=this.#r?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),this.#U();const[t,n]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*n/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/n).toFixed(2)}%`);const[s,o]=this.getInitialTranslation();return this.translate(s,o),iv(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#k||=new d0({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#V.bind(this),onPinching:this.#_.bind(this),onPinchEnd:this.#S.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),e}#V(){this.#h={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#i?.toggle(!1),this.parent.togglePointerEvents(!1)}#_(e,t,n){let o=.7*(n/t)+1-.7;if(o===1)return;const d=this.#N(this.rotation),c=(I,X)=>[d[0]*I+d[2]*X,d[1]*I+d[3]*X],[h,f]=this.parentDimensions,m=this.x,b=this.y,A=this.width,v=this.height,E=Mn.MIN_SIZE/h,x=Mn.MIN_SIZE/f;o=Math.max(Math.min(o,1/A,1/v),E/A,x/v);const k=Mn._round(A*o),j=Mn._round(v*o);if(k===A&&j===v)return;this.#d||=[m,b,A,v];const $=c(A/2,v/2),z=Mn._round(m+$[0]),B=Mn._round(b+$[1]),F=c(k/2,j/2);this.x=z-F[0],this.y=B-F[1],this.width=k,this.height=j,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#S(){this.#i?.toggle(!0),this.parent.togglePointerEvents(!0),this.#B()}pointerdown(e){const{isMac:t}=jo.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#g=!0,this._isDraggable){this.#O(e);return}this.#D(e)}#D(e){const{isMac:t}=jo.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#O(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const s=new AbortController,o=this._uiManager.combinedSignal(s),d={capture:!0,passive:!1,signal:o},c=f=>{s.abort(),this.#s=null,this.#g=!1,this._uiManager.endDragSession()||this.#D(f),n&&this._onStopDragging()};t&&(this.#C=e.clientX,this.#A=e.clientY,this.#s=e.pointerId,this.#o=e.pointerType,window.addEventListener("pointermove",f=>{n||(n=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:m,clientY:b,pointerId:A}=f;if(A!==this.#s){ta(f);return}const[v,E]=this.screenToPageTranslation(m-this.#C,b-this.#A);this.#C=m,this.#A=b,this._uiManager.dragSelectedEditors(v,E)},d),window.addEventListener("touchmove",ta,d),window.addEventListener("pointerdown",f=>{f.pointerType===this.#o&&(this.#k||f.isPrimary)&&c(f),ta(f)},d));const h=f=>{if(!this.#s||this.#s===f.pointerId){c(f);return}ta(f)};window.addEventListener("pointerup",h,{signal:o}),window.addEventListener("blur",h,{signal:o})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#x&&clearTimeout(this.#x),this.#x=setTimeout(()=>{this.#x=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,n=this.rotation){const s=this.parentScale,[o,d]=this.pageDimensions,[c,h]=this.pageTranslation,f=e/s,m=t/s,b=this.x*o,A=this.y*d,v=this.width*o,E=this.height*d;switch(n){case 0:return[b+f+c,d-A-m-E+h,b+f+v+c,d-A-m+h];case 90:return[b+m+c,d-A+f+h,b+m+E+c,d-A+f+v+h];case 180:return[b-f-v+c,d-A+m+h,b-f+c,d-A+m+E+h];case 270:return[b-m-E+c,d-A-f-v+h,b-m+c,d-A-f+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,s,o,d]=e,c=o-n,h=d-s;switch(this.rotation){case 0:return[n,t-d,c,h];case 90:return[n,t-s,h,c];case 180:return[o,t-s,c,h];case 270:return[o,t-d,h,c];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&Mn._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#n?.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:n,opacity:s,deleted:o,richText:d},uid:c,pageIndex:h,creationDate:f,modificationDate:m}=this;return{id:c,pageIndex:h,rect:this.getPDFRect(),richText:d,contentsObj:{str:e},creationDate:f,modificationDate:n||m,popupRef:!o,color:t,opacity:s}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#y=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#y=!1,!0):!1}isInEditMode(){return this.#y}shouldGetKeyboardEvents(){return this.#b}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:s}=this.getClientDimensions(),{innerHeight:o,innerWidth:d}=window;return t<d&&s>0&&e<o&&n>0}#U(){if(this.#f||!this.div)return;this.#f=new AbortController;const e=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#U()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(e,t,n){const s=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});s.rotation=e.rotation,s.#e=e.accessibilityData,s._isCopy=e.isCopy||!1;const[o,d]=s.pageDimensions,[c,h,f,m]=s.getRectInCurrentCoords(e.rect,d);return s.x=c/o,s.y=h/d,s.width=f/o,s.height=m/d,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#x&&(clearTimeout(this.#x),this.#x=null),this.#z(),this.removeEditToolbar(),this.#w){for(const e of this.#w.values())clearTimeout(e);this.#w=null}this.parent=null,this.#k?.destroy(),this.#k=null,this.#u?.remove(),this.#u=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#I(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[n,s,o,d]=this.getPDFRect();return[Mn._round(n+(o-n)*e),Mn._round(s+(d-s)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#n.commentPopupPositionInLayer}set commentPopupPosition(e){this.#n.commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return this.#n.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#n.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){this.#n?.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#h={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#c.children;if(!this.#t){this.#t=Array.from(t);const d=this.#G.bind(this),c=this.#$.bind(this),h=this._uiManager._signal;for(const f of this.#t){const m=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",d,{signal:h}),f.addEventListener("blur",c,{signal:h}),f.addEventListener("focus",this.#Y.bind(this,m),{signal:h}),f.setAttribute("data-l10n-id",Mn._l10nResizer[m])}}const n=this.#t[0];let s=0;for(const d of t){if(d===n)break;s++}const o=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(o!==s){if(o<s)for(let c=0;c<s-o;c++)this.#c.append(this.#c.firstElementChild);else if(o>s)for(let c=0;c<o-s;c++)this.#c.firstElementChild.before(this.#c.lastElementChild);let d=0;for(const c of t){const f=this.#t[d++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",Mn._l10nResizer[f])}}this.#H(0),this.#b=!0,this.#c.firstElementChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#G(e){Mn._resizerKeyboardManager.exec(this,e)}#$(e){this.#b&&e.relatedTarget?.parentNode!==this.#c&&this.#z()}#Y(e){this.#m=this.#b?e:""}#H(e){if(this.#t)for(const t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#b&&this.#M(this.#m,{deltaX:e,deltaY:t,fromKeyboard:!0})}#z(){this.#b=!1,this.#H(-1),this.#B()}_stopResizingWithKeyboard(){this.#z(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#i?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#i?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(e){this.#p=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#w||=new Map;const{action:n}=e;let s=this.#w.get(n);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(e),this.#w.delete(n),this.#w.size===0&&(this.#w=null)},Mn._telemetryTimeout),this.#w.set(n,s);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#r=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#r=!0}updateFakeAnnotationElement(e){if(!this.#u&&!this.deleted){this.#u=e.addFakeAnnotation(this);return}if(this.deleted){this.#u.remove(),this.#u=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#u.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){const{firstElementChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}}class G3 extends Mn{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Rb=3285377520,zc=4294901760,wd=65535;class sv{constructor(e){this.h1=e?e&4294967295:Rb,this.h2=e?e&4294967295:Rb}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let x=0,k=e.length;x<k;x++){const j=e.charCodeAt(x);j<=255?t[n++]=j:(t[n++]=j>>>8,t[n++]=j&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=n>>2,o=n-s*4,d=new Uint32Array(t.buffer,0,s);let c=0,h=0,f=this.h1,m=this.h2;const b=3432918353,A=461845907,v=b&wd,E=A&wd;for(let x=0;x<s;x++)x&1?(c=d[x],c=c*b&zc|c*v&wd,c=c<<15|c>>>17,c=c*A&zc|c*E&wd,f^=c,f=f<<13|f>>>19,f=f*5+3864292196):(h=d[x],h=h*b&zc|h*v&wd,h=h<<15|h>>>17,h=h*A&zc|h*E&wd,m^=h,m=m<<13|m>>>19,m=m*5+3864292196);switch(c=0,o){case 3:c^=t[s*4+2]<<16;case 2:c^=t[s*4+1]<<8;case 1:c^=t[s*4],c=c*b&zc|c*v&wd,c=c<<15|c>>>17,c=c*A&zc|c*E&wd,s&1?f^=c:m^=c}this.h1=f,this.h2=m}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&zc|e*36045&wd,t=t*4283543511&zc|((t<<16|e>>>16)*2950163797&zc)>>>16,e^=t>>>1,e=e*444984403&zc|e*60499&wd,t=t*3301882366&zc|((t<<16|e>>>16)*3120437893&zc)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const ry=Object.freeze({map:null,hash:"",transfer:void 0});class Cy{#e=!1;#t=null;#i=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=this.#n.get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return this.#n.get(e)}remove(e){const t=this.#n.get(e);if(t!==void 0&&(t instanceof Mn&&this.#i.delete(t.annotationElementId),this.#n.delete(e),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const n of this.#n.values())if(n instanceof Mn)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=this.#n.get(e);let s=!1;if(n!==void 0)for(const[o,d]of Object.entries(t))n[o]!==d&&(s=!0,n[o]=d);else s=!0,this.#n.set(e,t);s&&this.#a(),t instanceof Mn&&((this.#i||=new Map).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return this.#n.has(e)}get size(){return this.#n.size}#a(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new rv(this)}get serializable(){if(this.#n.size===0)return ry;const e=new Map,t=new sv,n=[],s=Object.create(null);let o=!1;for(const[d,c]of this.#n){const h=c instanceof Mn?c.serialize(!1,s):c;h&&(e.set(d,h),t.update(`${d}:${JSON.stringify(h)}`),o||=!!h.bitmap)}if(o)for(const d of e.values())d.bitmap&&n.push(d.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:ry}get editorStats(){let e=null;const t=new Map;let n=0,s=0;for(const o of this.#n.values()){if(!(o instanceof Mn)){o.popup&&(o.popup.deleted?s+=1:n+=1);continue}o.isCommentDeleted?s+=1:o.hasEditedComment&&(n+=1);const d=o.telemetryFinalData;if(!d)continue;const{type:c}=d;t.has(c)||t.set(c,Object.getPrototypeOf(o).constructor),e||=Object.create(null);const h=e[c]||=new Map;for(const[f,m]of Object.entries(d)){if(f==="type")continue;let b=h.get(f);b||(b=new Map,h.set(f,b));const A=b.get(m)??0;b.set(m,A+1)}}if((s>0||n>0)&&(e||=Object.create(null),e.comments={deleted:s,edited:n}),!e)return null;for(const[o,d]of t)e[o]=d.computeTelemetryFinalData(e[o]);return e}resetModifiedIds(){this.#t=null}updateEditor(e,t){const n=this.#i?.get(e);return n?(n.updateFromAnnotationLayer(t),!0):!1}getEditor(e){return this.#i?.get(e)||null}get modifiedIds(){if(this.#t)return this.#t;const e=[];if(this.#i)for(const t of this.#i.values())t.serialize()&&e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class rv extends Cy{#e;constructor(e){super();const{map:t,hash:n,transfer:s}=e.serializable,o=structuredClone(t,s?{transfer:s}:null);this.#e={map:o,hash:n,transfer:s}}get print(){Xs("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return hi(this,"modifiedIds",{ids:new Set,hash:""})}}class Y3{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:n}){if(!(!e||this.#e.has(e.loadedName))){if(Zi(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:o,style:d}=e,c=new FontFace(s,o,d);this.addNativeFontFace(c);try{await c.load(),this.#e.add(s),n?.(e)}catch{ui(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(c)}return}Xs("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(s){throw ui(`Failed to load font '${n.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const s=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,s)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return hi(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return hi(this,"isSyncFontLoadingSupported",bl||jo.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(Zi(!s.done,"completeRequest() cannot be called twice."),s.done=!0;n.length>0&&n[0].done;){const o=n.shift();setTimeout(o.callback,0)}}const{loadingRequests:n}=this,s={done:!1,complete:t,callback:e};return n.push(s),s}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return hi(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(B,F){return B.charCodeAt(F)<<24|B.charCodeAt(F+1)<<16|B.charCodeAt(F+2)<<8|B.charCodeAt(F+3)&255}function s(B,F,I,X){const M=B.substring(0,F),G=B.substring(F+I);return M+X+G}let o,d;const c=this._document.createElement("canvas");c.width=1,c.height=1;const h=c.getContext("2d");let f=0;function m(B,F){if(++f>30){ui("Load test font never loaded."),F();return}if(h.font="30px "+B,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){F();return}setTimeout(m.bind(null,B,F))}const b=`lt${Date.now()}${this.loadTestFontId++}`;let A=this._loadTestFont;A=s(A,976,b.length,b);const E=16,x=1482184792;let k=n(A,E);for(o=0,d=b.length-3;o<d;o+=4)k=k-x+n(b,o)|0;o<b.length&&(k=k-x+n(b+"XXX",o)|0),A=s(A,E,4,j3(k));const j=`url(data:font/opentype;base64,${btoa(A)});`,$=`@font-face {font-family:"${b}";src:${j}}`;this.insertRule($);const z=this._document.createElement("div");z.style.visibility="hidden",z.style.width=z.style.height="10px",z.style.position="absolute",z.style.top=z.style.left="0px";for(const B of[e.loadedName,b]){const F=this._document.createElement("span");F.textContent="Hi",F.style.fontFamily=B,z.append(F)}this._document.body.append(z),m(b,()=>{z.remove(),t.complete()})}}class X3{#e;constructor(e,t=null,n,s){this.compiledGlyphs=Object.create(null),this.#e=e,this._inspectFont=t,n&&Object.assign(this,n),s&&(this.charProcOperatorList=s)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${Q2(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const n=this.loadedName+"_path_"+t;let s;try{s=e.get(n)}catch(d){ui(`getPathGenerator - ignoring character: "${d}".`)}const o=nv(s);return this.fontExtraProperties||e.delete(n),this.compiledGlyphs[t]=o}get black(){return this.#e.black}get bold(){return this.#e.bold}get disableFontFace(){return this.#e.disableFontFace??!1}set disableFontFace(e){hi(this,"disableFontFace",!!e)}get fontExtraProperties(){return this.#e.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#e.isInvalidPDFjsFont}get isType3Font(){return this.#e.isType3Font}get italic(){return this.#e.italic}get missingFile(){return this.#e.missingFile}get remeasure(){return this.#e.remeasure}get vertical(){return this.#e.vertical}get ascent(){return this.#e.ascent}get defaultWidth(){return this.#e.defaultWidth}get descent(){return this.#e.descent}get bbox(){return this.#e.bbox}set bbox(e){hi(this,"bbox",e)}get fontMatrix(){return this.#e.fontMatrix}get fallbackName(){return this.#e.fallbackName}get loadedName(){return this.#e.loadedName}get mimetype(){return this.#e.mimetype}get name(){return this.#e.name}get data(){return this.#e.data}clearData(){this.#e.clearData()}get cssFontInfo(){return this.#e.cssFontInfo}get systemFontInfo(){return this.#e.systemFontInfo}get defaultVMetrics(){return this.#e.defaultVMetrics}}class gf{#e;#t;#i;static strings=["fontFamily","fontWeight","italicAngle"];static write(e){const t=new TextEncoder,n={};let s=0;for(const f of gf.strings){const m=t.encode(e[f]);n[f]=m,s+=4+m.length}const o=new ArrayBuffer(s),d=new Uint8Array(o),c=new DataView(o);let h=0;for(const f of gf.strings){const m=n[f],b=m.length;c.setUint32(h,b),d.set(m,h+4),h+=4+b}return Zi(h===o.byteLength,"CssFontInfo.write: Buffer overflow"),o}constructor(e){this.#e=e,this.#t=new DataView(this.#e),this.#i=new TextDecoder}#n(e){Zi(e<gf.strings.length,"Invalid string index");let t=0;for(let s=0;s<e;s++)t+=this.#t.getUint32(t)+4;const n=this.#t.getUint32(t);return this.#i.decode(new Uint8Array(this.#e,t+4,n))}get fontFamily(){return this.#n(0)}get fontWeight(){return this.#n(1)}get italicAngle(){return this.#n(2)}}class mf{#e;#t;#i;static strings=["css","loadedName","baseFontName","src"];static write(e){const t=new TextEncoder,n={};let s=0;for(const A of mf.strings){const v=t.encode(e[A]);n[A]=v,s+=4+v.length}s+=4;let o,d,c=1+s;e.style&&(o=t.encode(e.style.style),d=t.encode(e.style.weight),c+=4+o.length+4+d.length);const h=new ArrayBuffer(c),f=new Uint8Array(h),m=new DataView(h);let b=0;m.setUint8(b++,e.guessFallback?1:0),m.setUint32(b,0),b+=4,s=0;for(const A of mf.strings){const v=n[A],E=v.length;s+=4+E,m.setUint32(b,E),f.set(v,b+4),b+=4+E}return m.setUint32(b-s-4,s),e.style&&(m.setUint32(b,o.length),f.set(o,b+4),b+=4+o.length,m.setUint32(b,d.length),f.set(d,b+4),b+=4+d.length),Zi(b<=h.byteLength,"SubstitionInfo.write: Buffer overflow"),h.transferToFixedLength(b)}constructor(e){this.#e=e,this.#t=new DataView(this.#e),this.#i=new TextDecoder}get guessFallback(){return this.#t.getUint8(0)!==0}#n(e){Zi(e<mf.strings.length,"Invalid string index");let t=5;for(let s=0;s<e;s++)t+=this.#t.getUint32(t)+4;const n=this.#t.getUint32(t);return this.#i.decode(new Uint8Array(this.#e,t+4,n))}get css(){return this.#n(0)}get loadedName(){return this.#n(1)}get baseFontName(){return this.#n(2)}get src(){return this.#n(3)}get style(){let e=1;e+=4+this.#t.getUint32(e);const t=this.#t.getUint32(e),n=this.#i.decode(new Uint8Array(this.#e,e+4,t));e+=4+t;const s=this.#t.getUint32(e),o=this.#i.decode(new Uint8Array(this.#e,e+4,s));return{style:n,weight:o}}}class Os{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#e=Math.ceil(this.bools.length*2/8);static#t=this.#e+this.numbers.length*8;static#i=this.#t+1+8;static#n=this.#i+1+48;static#a=this.#n+1+6;#r;#s;#o;constructor({data:e,extra:t}){this.#r=e,this.#s=new TextDecoder,this.#o=new DataView(this.#r),t&&Object.assign(this,t)}#c(e){Zi(e<Os.bools.length,"Invalid boolean index");const t=Math.floor(e/4),n=e*2%8,s=this.#o.getUint8(t)>>n&3;return s===0?void 0:s===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(e){return Zi(e<Os.numbers.length,"Invalid number index"),this.#o.getFloat64(Os.#e+e*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let e=Os.#t;if(this.#o.getUint8(e)===0)return;e+=1;const n=[];for(let s=0;s<4;s++)n.push(this.#o.getInt16(e,!0)),e+=2;return n}get fontMatrix(){let e=Os.#i;if(this.#o.getUint8(e)===0)return;e+=1;const n=[];for(let s=0;s<6;s++)n.push(this.#o.getFloat64(e,!0)),e+=8;return n}get defaultVMetrics(){let e=Os.#n;if(this.#o.getUint8(e)===0)return;e+=1;const n=[];for(let s=0;s<3;s++)n.push(this.#o.getInt16(e,!0)),e+=2;return n}#h(e){Zi(e<Os.strings.length,"Invalid string index");let t=Os.#a+4;for(let o=0;o<e;o++)t+=this.#o.getUint32(t)+4;const n=this.#o.getUint32(t),s=new Uint8Array(n);return s.set(new Uint8Array(this.#r,t+4,n)),this.#s.decode(s)}get fallbackName(){return this.#h(0)}get loadedName(){return this.#h(1)}get mimetype(){return this.#h(2)}get name(){return this.#h(3)}get data(){let e=Os.#a;const t=this.#o.getUint32(e);e+=4+t;const n=this.#o.getUint32(e);e+=4+n;const s=this.#o.getUint32(e);e+=4+s;const o=this.#o.getUint32(e);if(o!==0)return new Uint8Array(this.#r,e+4,o)}clearData(){let e=Os.#a;const t=this.#o.getUint32(e);e+=4+t;const n=this.#o.getUint32(e);e+=4+n;const s=this.#o.getUint32(e);e+=4+s;const o=this.#o.getUint32(e);new Uint8Array(this.#r,e+4,o).fill(0),this.#o.setUint32(e,0)}get cssFontInfo(){let e=Os.#a;const t=this.#o.getUint32(e);e+=4+t;const n=this.#o.getUint32(e);e+=4+n;const s=this.#o.getUint32(e);if(s===0)return null;const o=new Uint8Array(s);return o.set(new Uint8Array(this.#r,e+4,s)),new gf(o.buffer)}get systemFontInfo(){let e=Os.#a;const t=this.#o.getUint32(e);e+=4+t;const n=this.#o.getUint32(e);if(n===0)return null;const s=new Uint8Array(n);return s.set(new Uint8Array(this.#r,e+4,n)),new mf(s.buffer)}static write(e){const t=e.systemFontInfo?mf.write(e.systemFontInfo):null,n=e.cssFontInfo?gf.write(e.cssFontInfo):null,s=new TextEncoder,o={};let d=0;for(const x of Os.strings)o[x]=s.encode(e[x]),d+=4+o[x].length;const c=Os.#a+4+d+4+(t?t.byteLength:0)+4+(n?n.byteLength:0)+4+(e.data?e.data.length:0),h=new ArrayBuffer(c),f=new Uint8Array(h),m=new DataView(h);let b=0;const A=Os.bools.length;let v=0,E=0;for(let x=0;x<A;x++){const k=e[Os.bools[x]];v|=(k===void 0?0:k?2:1)<<E,E+=2,(E===8||x===A-1)&&(m.setUint8(b++,v),v=0,E=0)}Zi(b===Os.#e,"FontInfo.write: Boolean properties offset mismatch");for(const x of Os.numbers)m.setFloat64(b,e[x]),b+=8;if(Zi(b===Os.#t,"FontInfo.write: Number properties offset mismatch"),e.bbox){m.setUint8(b++,4);for(const x of e.bbox)m.setInt16(b,x,!0),b+=2}else m.setUint8(b++,0),b+=8;if(Zi(b===Os.#i,"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){m.setUint8(b++,6);for(const x of e.fontMatrix)m.setFloat64(b,x,!0),b+=8}else m.setUint8(b++,0),b+=48;if(Zi(b===Os.#n,"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){m.setUint8(b++,1);for(const x of e.defaultVMetrics)m.setInt16(b,x,!0),b+=2}else m.setUint8(b++,0),b+=6;Zi(b===Os.#a,"FontInfo.write: DefaultVMetrics properties offset mismatch"),m.setUint32(Os.#a,0),b+=4;for(const x of Os.strings){const k=o[x],j=k.length;m.setUint32(b,j),f.set(k,b+4),b+=4+j}if(m.setUint32(Os.#a,b-Os.#a-4),!t)m.setUint32(b,0),b+=4;else{const x=t.byteLength;m.setUint32(b,x),Zi(b+4+x<=h.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(t),b+4),b+=4+x}if(!n)m.setUint32(b,0),b+=4;else{const x=n.byteLength;m.setUint32(b,x),Zi(b+4+x<=h.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(n),b+4),b+=4+x}return e.data===void 0?(m.setUint32(b,0),b+=4):(m.setUint32(b,e.data.length),f.set(e.data,b+4),b+=4+e.data.length),Zi(b<=h.byteLength,"FontInfo.write: Buffer overflow"),h.transferToFixedLength(b)}}class ao{static#e=0;static#t=1;static#i=2;static#n=3;static#a=4;static#r=8;static#s=12;static#o=16;constructor(e){this.buffer=e,this.view=new DataView(e),this.data=new Uint8Array(e)}static write(e){let t,n=null,s=[],o=[],d=[],c=[],h=null,f=null;switch(e[0]){case"RadialAxial":t=e[1]==="axial"?1:2,n=e[2],d=e[3],t===1?s.push(...e[4],...e[5]):s.push(e[4][0],e[4][1],e[6],e[5][0],e[5][1],e[7]);break;case"Mesh":t=3,h=e[1],s=e[2],o=e[3],c=e[4]||[],n=e[6],f=e[7];break;default:throw new Error(`Unsupported pattern type: ${e[0]}`)}const m=Math.floor(s.length/2),b=Math.floor(o.length/3),A=d.length,v=c.length;let E=0;for(const F of c)E+=1,E=Math.ceil(E/4)*4,E+=4+F.coords.length*4,E+=4+F.colors.length*4,F.verticesPerRow!==void 0&&(E+=4);const x=20+m*8+b*3+A*8+(n?16:0)+(f?3:0)+E,k=new ArrayBuffer(x),j=new DataView(k),$=new Uint8Array(k);j.setUint8(ao.#e,t),j.setUint8(ao.#t,n?1:0),j.setUint8(ao.#i,f?1:0),j.setUint8(ao.#n,h),j.setUint32(ao.#a,m,!0),j.setUint32(ao.#r,b,!0),j.setUint32(ao.#s,A,!0),j.setUint32(ao.#o,v,!0);let z=20;new Float32Array(k,z,m*2).set(s),z+=m*8,$.set(o,z),z+=b*3;for(const[F,I]of d)j.setFloat32(z,F,!0),z+=4,j.setUint32(z,parseInt(I.slice(1),16),!0),z+=4;if(n)for(const F of n)j.setFloat32(z,F,!0),z+=4;f&&($.set(f,z),z+=3);for(let F=0;F<c.length;F++){const I=c[F];j.setUint8(z,I.type),z+=1,z=Math.ceil(z/4)*4,j.setUint32(z,I.coords.length,!0),z+=4,new Int32Array(k,z,I.coords.length).set(I.coords),z+=I.coords.length*4,j.setUint32(z,I.colors.length,!0),z+=4,new Int32Array(k,z,I.colors.length).set(I.colors),z+=I.colors.length*4,I.verticesPerRow!==void 0&&(j.setUint32(z,I.verticesPerRow,!0),z+=4)}return k}getIR(){const e=this.view,t=this.data[ao.#e],n=!!this.data[ao.#t],s=!!this.data[ao.#i],o=e.getUint32(ao.#a,!0),d=e.getUint32(ao.#r,!0),c=e.getUint32(ao.#s,!0),h=e.getUint32(ao.#o,!0);let f=20;const m=new Float32Array(this.buffer,f,o*2);f+=o*8;const b=new Uint8Array(this.buffer,f,d*3);f+=d*3;const A=[];for(let k=0;k<c;++k){const j=e.getFloat32(f,!0);f+=4;const $=e.getUint32(f,!0);f+=4,A.push([j,`#${$.toString(16).padStart(6,"0")}`])}let v=null;if(n){v=[];for(let k=0;k<4;++k)v.push(e.getFloat32(f,!0)),f+=4}let E=null;s&&(E=new Uint8Array(this.buffer,f,3),f+=3);const x=[];for(let k=0;k<h;++k){const j=e.getUint8(f);f+=1,f=Math.ceil(f/4)*4;const $=e.getUint32(f,!0);f+=4;const z=new Int32Array(this.buffer,f,$);f+=$*4;const B=e.getUint32(f,!0);f+=4;const F=new Int32Array(this.buffer,f,B);f+=B*4;const I={type:j,coords:z,colors:F};j===ey.LATTICE&&(I.verticesPerRow=e.getUint32(f,!0),f+=4),x.push(I)}if(t===1)return["RadialAxial","axial",v,A,Array.from(m.slice(0,2)),Array.from(m.slice(2,4)),null,null];if(t===2)return["RadialAxial","radial",v,A,[m[0],m[1]],[m[3],m[4]],m[2],m[5]];if(t===3){const k=this.data[ao.#n];let j=null;if(m.length>0){let $=m[0],z=m[0],B=m[1],F=m[1];for(let I=0;I<m.length;I+=2){const X=m[I],M=m[I+1];$=$>X?X:$,B=B>M?M:B,z=z<X?X:z,F=F<M?M:F}j=[$,B,z,F]}return["Mesh",k,m,b,x,j,v,E]}throw new Error(`Unsupported pattern kind: ${t}`)}}function K3(r){if(r instanceof URL)return r.href;if(typeof r=="string"){if(bl)return r;const e=URL.parse(r,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function Z3(r){if(bl&&typeof Buffer<"u"&&r instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength)return r;if(typeof r=="string")return Tp(r);if(r instanceof ArrayBuffer||ArrayBuffer.isView(r)||typeof r=="object"&&!isNaN(r?.length))return new Uint8Array(r);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Eg(r){if(typeof r!="string")return null;if(r.endsWith("/"))return r;throw new Error(`Invalid factory url: "${r}" must include trailing slash.`)}const ay=r=>typeof r=="object"&&Number.isInteger(r?.num)&&r.num>=0&&Number.isInteger(r?.gen)&&r.gen>=0,J3=r=>typeof r=="object"&&typeof r?.name=="string",Q3=D3.bind(null,ay,J3);class eT{#e=new Map;#t=Promise.resolve();postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(const[s]of this.#e)s.call(this,n)})}addEventListener(e,t,n=null){let s=null;if(n?.signal instanceof AbortSignal){const{signal:o}=n;if(o.aborted){ui("LoopbackPort - cannot use an `aborted` signal.");return}const d=()=>this.removeEventListener(e,t);s=()=>o.removeEventListener("abort",d),o.addEventListener("abort",d)}this.#e.set(t,s)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(const[,e]of this.#e)e?.();this.#e.clear()}}const Rg={DATA:1,ERROR:2},ka={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Db(){}function Wl(r){if(r instanceof Mu||r instanceof ty||r instanceof Cb||r instanceof Qg||r instanceof Pm)return r;switch(r instanceof Error||typeof r=="object"&&r!==null||Xs('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),r.name){case"AbortException":return new Mu(r.message);case"InvalidPDFException":return new ty(r.message);case"PasswordException":return new Cb(r.message,r.code);case"ResponseException":return new Qg(r.message,r.status,r.missing);case"UnknownErrorException":return new Pm(r.message,r.details)}return new Pm(r.message,r.toString())}class dp{#e=new AbortController;constructor(e,t,n){this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#n(e);return}if(e.callback){const n=e.callbackId,s=this.callbackCapabilities[n];if(!s)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],e.callback===Rg.DATA)s.resolve(e.data);else if(e.callback===Rg.ERROR)s.reject(Wl(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const n=this.sourceName,s=e.sourceName,o=this.comObj;Promise.try(t,e.data).then(function(d){o.postMessage({sourceName:n,targetName:s,callback:Rg.DATA,callbackId:e.callbackId,data:d})},function(d){o.postMessage({sourceName:n,targetName:s,callback:Rg.ERROR,callbackId:e.callbackId,reason:Wl(d)})});return}if(e.streamId){this.#i(e);return}t(e.data)}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const s=this.callbackId++,o=Promise.withResolvers();this.callbackCapabilities[s]=o;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},n)}catch(d){o.reject(d)}return o.promise}sendWithStream(e,t,n,s){const o=this.streamId++,d=this.sourceName,c=this.targetName,h=this.comObj;return new ReadableStream({start:f=>{const m=Promise.withResolvers();return this.streamControllers[o]={controller:f,startCall:m,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:d,targetName:c,action:e,streamId:o,data:t,desiredSize:f.desiredSize},s),m.promise},pull:f=>{const m=Promise.withResolvers();return this.streamControllers[o].pullCall=m,h.postMessage({sourceName:d,targetName:c,stream:ka.PULL,streamId:o,desiredSize:f.desiredSize}),m.promise},cancel:f=>{Zi(f instanceof Error,"cancel must have a valid reason");const m=Promise.withResolvers();return this.streamControllers[o].cancelCall=m,this.streamControllers[o].isClosed=!0,h.postMessage({sourceName:d,targetName:c,stream:ka.CANCEL,streamId:o,reason:Wl(f)}),m.promise}},n)}#i(e){const t=e.streamId,n=this.sourceName,s=e.sourceName,o=this.comObj,d=this,c=this.actionHandler[e.action],h={enqueue(f,m=1,b){if(this.isCancelled)return;const A=this.desiredSize;this.desiredSize-=m,A>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),o.postMessage({sourceName:n,targetName:s,stream:ka.ENQUEUE,streamId:t,chunk:f},b)},close(){this.isCancelled||(this.isCancelled=!0,o.postMessage({sourceName:n,targetName:s,stream:ka.CLOSE,streamId:t}),delete d.streamSinks[t])},error(f){Zi(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,o.postMessage({sourceName:n,targetName:s,stream:ka.ERROR,streamId:t,reason:Wl(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[t]=h,Promise.try(c,e.data,h).then(function(){o.postMessage({sourceName:n,targetName:s,stream:ka.START_COMPLETE,streamId:t,success:!0})},function(f){o.postMessage({sourceName:n,targetName:s,stream:ka.START_COMPLETE,streamId:t,reason:Wl(f)})})}#n(e){const t=e.streamId,n=this.sourceName,s=e.sourceName,o=this.comObj,d=this.streamControllers[t],c=this.streamSinks[t];switch(e.stream){case ka.START_COMPLETE:e.success?d.startCall.resolve():d.startCall.reject(Wl(e.reason));break;case ka.PULL_COMPLETE:e.success?d.pullCall.resolve():d.pullCall.reject(Wl(e.reason));break;case ka.PULL:if(!c){o.postMessage({sourceName:n,targetName:s,stream:ka.PULL_COMPLETE,streamId:t,success:!0});break}c.desiredSize<=0&&e.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=e.desiredSize,Promise.try(c.onPull||Db).then(function(){o.postMessage({sourceName:n,targetName:s,stream:ka.PULL_COMPLETE,streamId:t,success:!0})},function(f){o.postMessage({sourceName:n,targetName:s,stream:ka.PULL_COMPLETE,streamId:t,reason:Wl(f)})});break;case ka.ENQUEUE:if(Zi(d,"enqueue should have stream controller"),d.isClosed)break;d.controller.enqueue(e.chunk);break;case ka.CLOSE:if(Zi(d,"close should have stream controller"),d.isClosed)break;d.isClosed=!0,d.controller.close(),this.#a(d,t);break;case ka.ERROR:Zi(d,"error should have stream controller"),d.controller.error(Wl(e.reason)),this.#a(d,t);break;case ka.CANCEL_COMPLETE:e.success?d.cancelCall.resolve():d.cancelCall.reject(Wl(e.reason)),this.#a(d,t);break;case ka.CANCEL:if(!c)break;const h=Wl(e.reason);Promise.try(c.onCancel||Db,h).then(function(){o.postMessage({sourceName:n,targetName:s,stream:ka.CANCEL_COMPLETE,streamId:t,success:!0})},function(f){o.postMessage({sourceName:n,targetName:s,stream:ka.CANCEL_COMPLETE,streamId:t,reason:Wl(f)})}),c.sinkCapability.reject(h),c.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#a(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#e?.abort(),this.#e=null}}class av{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Xs("Abstract method `_createCanvas` called.")}}class tT extends av{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class ov{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Xs("Abstract method `_fetch` called.")}}class Lb extends ov{async _fetch(e){const t=await Cp(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Tp(t)}}class lv{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,s,o){return"none"}destroy(e=!1){}}class nT extends lv{#e;#t;#i;#n;#a;#r;#s=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#n=e,this.#a=t}get#o(){return this.#t||=new Map}get#c(){return this.#r||=new Map}get#l(){if(!this.#i){const e=this.#a.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const n=this.#a.createElementNS($d,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#i=this.#a.createElementNS($d,"defs"),e.append(n),n.append(this.#i),this.#a.body.append(e)}return this.#i}#h(e){if(e.length===1){const h=e[0],f=new Array(256);for(let b=0;b<256;b++)f[b]=h[b]/255;const m=f.join(",");return[m,m,m]}const[t,n,s]=e,o=new Array(256),d=new Array(256),c=new Array(256);for(let h=0;h<256;h++)o[h]=t[h]/255,d[h]=n[h]/255,c[h]=s[h]/255;return[o.join(","),d.join(","),c.join(",")]}#u(e){if(this.#e===void 0){this.#e="";const t=this.#a.URL;t!==this.#a.baseURI&&(c0(t)?ui('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=K2(t,""))}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#o.get(e);if(t)return t;const[n,s,o]=this.#h(e),d=e.length===1?n:`${n}${s}${o}`;if(t=this.#o.get(d),t)return this.#o.set(e,t),t;const c=`g_${this.#n}_transfer_map_${this.#s++}`,h=this.#u(c);this.#o.set(e,h),this.#o.set(d,h);const f=this.#g(c);return this.#p(n,s,o,f),h}addHCMFilter(e,t){const n=`${e}-${t}`,s="base";let o=this.#c.get(s);if(o?.key===n||(o?(o.filter?.remove(),o.key=n,o.url="none",o.filter=null):(o={key:n,url:"none",filter:null},this.#c.set(s,o)),!e||!t))return o.url;const d=this.#b(e);e=un.makeHexColor(...d);const c=this.#b(t);if(t=un.makeHexColor(...c),this.#l.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return o.url;const h=new Array(256);for(let v=0;v<=255;v++){const E=v/255;h[v]=E<=.03928?E/12.92:((E+.055)/1.055)**2.4}const f=h.join(","),m=`g_${this.#n}_hcm_filter`,b=o.filter=this.#g(m);this.#p(f,f,f,b),this.#m(b);const A=(v,E)=>{const x=d[v]/255,k=c[v]/255,j=new Array(E+1);for(let $=0;$<=E;$++)j[$]=x+$/E*(k-x);return j.join(",")};return this.#p(A(0,5),A(1,5),A(2,5),b),o.url=this.#u(m),o.url}addAlphaFilter(e){let t=this.#o.get(e);if(t)return t;const[n]=this.#h([e]),s=`alpha_${n}`;if(t=this.#o.get(s),t)return this.#o.set(e,t),t;const o=`g_${this.#n}_alpha_map_${this.#s++}`,d=this.#u(o);this.#o.set(e,d),this.#o.set(s,d);const c=this.#g(o);return this.#y(n,c),d}addLuminosityFilter(e){let t=this.#o.get(e||"luminosity");if(t)return t;let n,s;if(e?([n]=this.#h([e]),s=`luminosity_${n}`):s="luminosity",t=this.#o.get(s),t)return this.#o.set(e,t),t;const o=`g_${this.#n}_luminosity_map_${this.#s++}`,d=this.#u(o);this.#o.set(e,d),this.#o.set(s,d);const c=this.#g(o);return this.#f(c),e&&this.#y(n,c),d}addHighlightHCMFilter(e,t,n,s,o){const d=`${t}-${n}-${s}-${o}`;let c=this.#c.get(e);if(c?.key===d||(c?(c.filter?.remove(),c.key=d,c.url="none",c.filter=null):(c={key:d,url:"none",filter:null},this.#c.set(e,c)),!t||!n))return c.url;const[h,f]=[t,n].map(this.#b.bind(this));let m=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),b=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[A,v]=[s,o].map(this.#b.bind(this));b<m&&([m,b,A,v]=[b,m,v,A]),this.#l.style.color="";const E=(j,$,z)=>{const B=new Array(256),F=(b-m)/z,I=j/255,X=($-j)/(255*z);let M=0;for(let G=0;G<=z;G++){const U=Math.round(m+G*F),_=I+G*X;for(let N=M;N<=U;N++)B[N]=_;M=U+1}for(let G=M;G<256;G++)B[G]=B[M-1];return B.join(",")},x=`g_${this.#n}_hcm_${e}_filter`,k=c.filter=this.#g(x);return this.#m(k),this.#p(E(A[0],v[0],5),E(A[1],v[1],5),E(A[2],v[2],5),k),c.url=this.#u(x),c.url}destroy(e=!1){e&&this.#r?.size||(this.#i?.parentNode.parentNode.remove(),this.#i=null,this.#t?.clear(),this.#t=null,this.#r?.clear(),this.#r=null,this.#s=0)}#f(e){const t=this.#a.createElementNS($d,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#m(e){const t=this.#a.createElementNS($d,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#g(e){const t=this.#a.createElementNS($d,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#l.append(t),t}#d(e,t,n){const s=this.#a.createElementNS($d,t);s.setAttribute("type","discrete"),s.setAttribute("tableValues",n),e.append(s)}#p(e,t,n,s){const o=this.#a.createElementNS($d,"feComponentTransfer");s.append(o),this.#d(o,"feFuncR",e),this.#d(o,"feFuncG",t),this.#d(o,"feFuncB",n)}#y(e,t){const n=this.#a.createElementNS($d,"feComponentTransfer");t.append(n),this.#d(n,"feFuncA",e)}#b(e){return this.#l.style.color=e,kp(getComputedStyle(this.#l).getPropertyValue("color"))}}class cv{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Xs("Abstract method `_fetch` called.")}}class Mb extends cv{async _fetch(e){const t=await Cp(e,"arraybuffer");return new Uint8Array(t)}}class dv{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){Xs("Abstract method `_fetch` called.")}}class zb extends dv{async _fetch(e){const t=await Cp(e,"arraybuffer");return new Uint8Array(t)}}bl&&ui("Please use the `legacy` build in Node.js environments.");async function _y(r){const t=await process.getBuiltinModule("fs").promises.readFile(r);return new Uint8Array(t)}class iT extends lv{}class sT extends av{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class rT extends ov{async _fetch(e){return _y(e)}}class aT extends cv{async _fetch(e){return _y(e)}}class oT extends dv{async _fetch(e){return _y(e)}}const ef="__forcedDependency",{floor:Ib,ceil:Bb}=Math;function Dg(r,e,t,n,s,o){r[e*4+0]=Math.min(r[e*4+0],t),r[e*4+1]=Math.min(r[e*4+1],n),r[e*4+2]=Math.max(r[e*4+2],s),r[e*4+3]=Math.max(r[e*4+3],o)}const oy=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class lT{#e;#t;constructor(e,t){this.#e=e,this.#t=t}get length(){return this.#e.length}isEmpty(e){return this.#e[e]===oy}minX(e){return this.#t[e*4+0]/256}minY(e){return this.#t[e*4+1]/256}maxX(e){return(this.#t[e*4+2]+1)/256}maxY(e){return(this.#t[e*4+3]+1)/256}}const Lg=(r,e)=>{if(!r)return;let t=r.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},r.set(e,t)),t};class cT{#e={__proto__:null};#t={__proto__:null,transform:[],moveText:[],sameLineText:[],[ef]:[]};#i=new Map;#n=[];#a=[];#r=[[1,0,0,1,0,0]];#s=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#h=new Map;#u=new Map;#f;#m;#g;#d;#p;constructor(e,t,n=!1){this.#f=e.width,this.#m=e.height,this.#y(t),n&&(this.#p=new Map)}growOperationsCount(e){e>=this.#d.length&&this.#y(e,this.#d)}#y(e,t){const n=new ArrayBuffer(e*4);this.#g=new Uint8ClampedArray(n),this.#d=new Uint32Array(n),t&&t.length>0?(this.#d.set(t),this.#d.fill(oy,t.length)):this.#d.fill(oy)}save(e){return this.#e={__proto__:this.#e},this.#t={__proto__:this.#t,transform:{__proto__:this.#t.transform},moveText:{__proto__:this.#t.moveText},sameLineText:{__proto__:this.#t.sameLineText},[ef]:{__proto__:this.#t[ef]}},this.#s={__proto__:this.#s},this.#n.push(e),this}restore(e){const t=Object.getPrototypeOf(this.#e);if(t===null)return this;this.#e=t,this.#t=Object.getPrototypeOf(this.#t),this.#s=Object.getPrototypeOf(this.#s);const n=this.#n.pop();return n!==void 0&&(Lg(this.#p,e)?.dependencies.add(n),this.#d[e]=this.#d[n]),this}recordOpenMarker(e){return this.#n.push(e),this}getOpenMarker(){return this.#n.length===0?null:this.#n.at(-1)}recordCloseMarker(e){const t=this.#n.pop();return t!==void 0&&(Lg(this.#p,e)?.dependencies.add(t),this.#d[e]=this.#d[t]),this}beginMarkedContent(e){return this.#a.push(e),this}endMarkedContent(e){const t=this.#a.pop();return t!==void 0&&(Lg(this.#p,e)?.dependencies.add(t),this.#d[e]=this.#d[t]),this}pushBaseTransform(e){return this.#r.push(un.multiplyByDOMMatrix(this.#r.at(-1),e.getTransform())),this}popBaseTransform(){return this.#r.length>1&&this.#r.pop(),this}recordSimpleData(e,t){return this.#e[e]=t,this}recordIncrementalData(e,t){return this.#t[e].push(t),this}resetIncrementalData(e,t){return this.#t[e].length=0,this}recordNamedData(e,t){return this.#i.set(e,t),this}recordSimpleDataFromNamed(e,t,n){this.#e[e]=this.#i.get(t)??n}recordFutureForcedDependency(e,t){return this.recordIncrementalData(ef,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in this.#e&&this.recordFutureForcedDependency(t,this.#e[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of this.#l)this.recordFutureForcedDependency(ef,e);return this}resetBBox(e){return this.#c!==e&&(this.#c=e,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(e,t,n,s,o,d){const c=un.multiplyByDOMMatrix(this.#r.at(-1),t.getTransform()),h=[1/0,1/0,-1/0,-1/0];un.axialAlignedBoundingBox([n,o,s,d],c,h);const f=un.intersect(this.#s,h);return f?(this.#s[0]=f[0],this.#s[1]=f[1],this.#s[2]=f[2],this.#s[3]=f[3]):(this.#s[0]=this.#s[1]=1/0,this.#s[2]=this.#s[3]=-1/0),this}recordBBox(e,t,n,s,o,d){const c=this.#s;if(c[0]===1/0)return this;const h=un.multiplyByDOMMatrix(this.#r.at(-1),t.getTransform());if(c[0]===-1/0)return un.axialAlignedBoundingBox([n,o,s,d],h,this.#o),this;const f=[1/0,1/0,-1/0,-1/0];return un.axialAlignedBoundingBox([n,o,s,d],h,f),this.#o[0]=Math.min(this.#o[0],Math.max(f[0],c[0])),this.#o[1]=Math.min(this.#o[1],Math.max(f[1],c[1])),this.#o[2]=Math.max(this.#o[2],Math.min(f[2],c[2])),this.#o[3]=Math.max(this.#o[3],Math.min(f[3],c[3])),this}recordCharacterBBox(e,t,n,s=1,o=0,d=0,c){const h=n.bbox;let f,m;if(h&&(f=h[2]!==h[0]&&h[3]!==h[1]&&this.#u.get(n),f!==!1&&(m=[0,0,0,0],un.axialAlignedBoundingBox(h,n.fontMatrix,m),(s!==1||o!==0||d!==0)&&un.scaleMinMax([s,0,0,-s,o,d],m),f)))return this.recordBBox(e,t,m[0],m[2],m[1],m[3]);if(!c)return this.recordFullPageBBox(e);const b=c();return h&&m&&f===void 0&&(f=m[0]<=o-b.actualBoundingBoxLeft&&m[2]>=o+b.actualBoundingBoxRight&&m[1]<=d-b.actualBoundingBoxAscent&&m[3]>=d+b.actualBoundingBoxDescent,this.#u.set(n,f),f)?this.recordBBox(e,t,m[0],m[2],m[1],m[3]):this.recordBBox(e,t,o-b.actualBoundingBoxLeft,o+b.actualBoundingBoxRight,d-b.actualBoundingBoxAscent,d+b.actualBoundingBoxDescent)}recordFullPageBBox(e){return this.#o[0]=Math.max(0,this.#s[0]),this.#o[1]=Math.max(0,this.#s[1]),this.#o[2]=Math.min(this.#f,this.#s[2]),this.#o[3]=Math.min(this.#m,this.#s[3]),this}getSimpleIndex(e){return this.#e[e]}recordDependencies(e,t){const n=this.#l,s=this.#e,o=this.#t;for(const d of t)d in this.#e?n.add(s[d]):d in o&&o[d].forEach(n.add,n);return this}recordNamedDependency(e,t){return this.#i.has(t)&&this.#l.add(this.#i.get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[ef]),this.#p){const n=Lg(this.#p,e),{dependencies:s}=n;this.#l.forEach(s.add,s),this.#n.forEach(s.add,s),this.#a.forEach(s.add,s),s.delete(e),n.isRenderingOperation=!0}if(this.#c===e){const n=Ib(this.#o[0]*256/this.#f),s=Ib(this.#o[1]*256/this.#m),o=Bb(this.#o[2]*256/this.#f),d=Bb(this.#o[3]*256/this.#m);Dg(this.#g,e,n,s,o,d);for(const c of this.#l)c!==e&&Dg(this.#g,c,n,s,o,d);for(const c of this.#n)c!==e&&Dg(this.#g,c,n,s,o,d);for(const c of this.#a)c!==e&&Dg(this.#g,c,n,s,o,d);t||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(e,t=!1){const n=Array.from(this.#l);this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const s of n)this.recordIncrementalData("sameLineText",s);return this}bboxToClipBoxDropOperation(e,t=!1){return this.#c===e&&(this.#c=-1,this.#s[0]=Math.max(this.#s[0],this.#o[0]),this.#s[1]=Math.max(this.#s[1],this.#o[1]),this.#s[2]=Math.min(this.#s[2],this.#o[2]),this.#s[3]=Math.min(this.#s[3],this.#o[3]),t||this.#l.clear()),this}_takePendingDependencies(){const e=this.#l;return this.#l=new Set,e}_extractOperation(e){const t=this.#h.get(e);return this.#h.delete(e),t}_pushPendingDependencies(e){for(const t of e)this.#l.add(t)}take(){return this.#u.clear(),new lT(this.#d,this.#g)}takeDebugMetadata(){return this.#p}}class e0{#e;#t;#i;#n=0;#a=0;constructor(e,t,n){if(e instanceof e0&&e.#i===!!n)return e;this.#e=e,this.#t=t,this.#i=!!n}growOperationsCount(){throw new Error("Unreachable")}save(e){return this.#a++,this.#e.save(this.#t),this}restore(e){return this.#a>0&&(this.#e.restore(this.#t),this.#a--),this}recordOpenMarker(e){return this.#n++,this}getOpenMarker(){return this.#n>0?this.#t:this.#e.getOpenMarker()}recordCloseMarker(e){return this.#n--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return this.#e.pushBaseTransform(e),this}popBaseTransform(){return this.#e.popBaseTransform(),this}recordSimpleData(e,t){return this.#e.recordSimpleData(e,this.#t),this}recordIncrementalData(e,t){return this.#e.recordIncrementalData(e,this.#t),this}resetIncrementalData(e,t){return this.#e.resetIncrementalData(e,this.#t),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,n){return this.#e.recordSimpleDataFromNamed(e,t,this.#t),this}recordFutureForcedDependency(e,t){return this.#e.recordFutureForcedDependency(e,this.#t),this}inheritSimpleDataAsFutureForcedDependencies(e){return this.#e.inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#e.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return this.#i||this.#e.resetBBox(this.#t),this}recordClipBox(e,t,n,s,o,d){return this.#i||this.#e.recordClipBox(this.#t,t,n,s,o,d),this}recordBBox(e,t,n,s,o,d){return this.#i||this.#e.recordBBox(this.#t,t,n,s,o,d),this}recordCharacterBBox(e,t,n,s,o,d,c){return this.#i||this.#e.recordCharacterBBox(this.#t,t,n,s,o,d,c),this}recordFullPageBBox(e){return this.#i||this.#e.recordFullPageBBox(this.#t),this}getSimpleIndex(e){return this.#e.getSimpleIndex(e)}recordDependencies(e,t){return this.#e.recordDependencies(this.#t,t),this}recordNamedDependency(e,t){return this.#e.recordNamedDependency(this.#t,t),this}recordOperation(e){return this.#e.recordOperation(this.#t,!0),this}recordShowTextOperation(e){return this.#e.recordShowTextOperation(this.#t,!0),this}bboxToClipBoxDropOperation(e){return this.#i||this.#e.bboxToClipBoxDropOperation(this.#t,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const Ic={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},ko={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function ly(r,e){if(!e)return;const t=e[2]-e[0],n=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],t,n),r.clip(s)}class ky{isModifyingCurrentTransform(){return!1}getPattern(){Xs("Abstract method `getPattern` called.")}}class dT extends ky{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)t.addColorStop(n[0],n[1]);return t}getPattern(e,t,n,s){let o;if(s===ko.STROKE||s===ko.FILL){const d=t.current.getClippedPathBoundingBox(s,Mr(e))||[0,0,0,0],c=Math.ceil(d[2]-d[0])||1,h=Math.ceil(d[3]-d[1])||1,f=t.cachedCanvases.getCanvas("pattern",c,h),m=f.context;m.clearRect(0,0,m.canvas.width,m.canvas.height),m.beginPath(),m.rect(0,0,m.canvas.width,m.canvas.height),m.translate(-d[0],-d[1]),n=un.transform(n,[1,0,0,1,d[0],d[1]]),m.transform(...t.baseTransform),this.matrix&&m.transform(...this.matrix),ly(m,this._bbox),m.fillStyle=this._createGradient(m),m.fill(),o=e.createPattern(f.canvas,"no-repeat");const b=new DOMMatrix(n);o.setTransform(b)}else ly(e,this._bbox),o=this._createGradient(e);return o}}function Dm(r,e,t,n,s,o,d,c){const h=e.coords,f=e.colors,m=r.data,b=r.width*4;let A;h[t+1]>h[n+1]&&(A=t,t=n,n=A,A=o,o=d,d=A),h[n+1]>h[s+1]&&(A=n,n=s,s=A,A=d,d=c,c=A),h[t+1]>h[n+1]&&(A=t,t=n,n=A,A=o,o=d,d=A);const v=(h[t]+e.offsetX)*e.scaleX,E=(h[t+1]+e.offsetY)*e.scaleY,x=(h[n]+e.offsetX)*e.scaleX,k=(h[n+1]+e.offsetY)*e.scaleY,j=(h[s]+e.offsetX)*e.scaleX,$=(h[s+1]+e.offsetY)*e.scaleY;if(E>=$)return;const z=f[o],B=f[o+1],F=f[o+2],I=f[d],X=f[d+1],M=f[d+2],G=f[c],U=f[c+1],_=f[c+2],N=Math.round(E),te=Math.round($);let ie,re,q,J,ce,_e,xe,Z;for(let D=N;D<=te;D++){if(D<k){const Pe=D<E?0:(E-D)/(E-k);ie=v-(v-x)*Pe,re=z-(z-I)*Pe,q=B-(B-X)*Pe,J=F-(F-M)*Pe}else{let Pe;D>$?Pe=1:k===$?Pe=0:Pe=(k-D)/(k-$),ie=x-(x-j)*Pe,re=I-(I-G)*Pe,q=X-(X-U)*Pe,J=M-(M-_)*Pe}let H;D<E?H=0:D>$?H=1:H=(E-D)/(E-$),ce=v-(v-j)*H,_e=z-(z-G)*H,xe=B-(B-U)*H,Z=F-(F-_)*H;const Y=Math.round(Math.min(ie,ce)),ue=Math.round(Math.max(ie,ce));let Ne=b*D+Y*4;for(let Pe=Y;Pe<=ue;Pe++)H=(ie-Pe)/(ie-ce),H<0?H=0:H>1&&(H=1),m[Ne++]=re-(re-_e)*H|0,m[Ne++]=q-(q-xe)*H|0,m[Ne++]=J-(J-Z)*H|0,m[Ne++]=255}}function uT(r,e,t){const n=e.coords,s=e.colors;let o,d;switch(e.type){case ey.LATTICE:const c=e.verticesPerRow,h=Math.floor(n.length/c)-1,f=c-1;for(o=0;o<h;o++){let m=o*c;for(let b=0;b<f;b++,m++)Dm(r,t,n[m],n[m+1],n[m+c],s[m],s[m+1],s[m+c]),Dm(r,t,n[m+c+1],n[m+1],n[m+c],s[m+c+1],s[m+1],s[m+c])}break;case ey.TRIANGLES:for(o=0,d=n.length;o<d;o+=3)Dm(r,t,n[o],n[o+1],n[o+2],s[o],s[o+1],s[o+2]);break;default:throw new Error("illegal figure")}}class hT extends ky{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,n){const c=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-c,m=Math.ceil(this._bounds[3])-h,b=Math.min(Math.ceil(Math.abs(f*e[0]*1.1)),3e3),A=Math.min(Math.ceil(Math.abs(m*e[1]*1.1)),3e3),v=f/b,E=m/A,x={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-h,scaleX:1/v,scaleY:1/E},k=b+4,j=A+4,$=n.getCanvas("mesh",k,j),z=$.context,B=z.createImageData(b,A);if(t){const I=B.data;for(let X=0,M=I.length;X<M;X+=4)I[X]=t[0],I[X+1]=t[1],I[X+2]=t[2],I[X+3]=255}for(const I of this._figures)uT(B,I,x);return z.putImageData(B,2,2),{canvas:$.canvas,offsetX:c-2*v,offsetY:h-2*E,scaleX:v,scaleY:E}}isModifyingCurrentTransform(){return!0}getPattern(e,t,n,s){ly(e,this._bbox);const o=new Float32Array(2);if(s===ko.SHADING)un.singularValueDecompose2dScale(Mr(e),o);else if(this.matrix){un.singularValueDecompose2dScale(this.matrix,o);const[c,h]=o;un.singularValueDecompose2dScale(t.baseTransform,o),o[0]*=c,o[1]*=h}else un.singularValueDecompose2dScale(t.baseTransform,o);const d=this._createMeshCanvas(o,s===ko.SHADING?null:this._background,t.cachedCanvases);return s!==ko.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(d.offsetX,d.offsetY),e.scale(d.scaleX,d.scaleY),e.createPattern(d.canvas,"no-repeat")}}class fT extends ky{getPattern(){return"hotpink"}}function pT(r){switch(r[0]){case"RadialAxial":return new dT(r);case"Mesh":return new hT(r);case"Dummy":return new fT}throw new Error(`Unknown IR type: ${r[0]}`)}const Ob={COLORED:1,UNCOLORED:2};class jy{static MAX_PATTERN_SIZE=3e3;constructor(e,t,n,s){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=n,this.baseTransform=s}createPatternCanvas(e,t){const{bbox:n,operatorList:s,paintType:o,tilingType:d,color:c,canvasGraphicsFactory:h}=this;let{xstep:f,ystep:m}=this;f=Math.abs(f),m=Math.abs(m),l0("TilingType: "+d);const b=n[0],A=n[1],v=n[2],E=n[3],x=v-b,k=E-A,j=new Float32Array(2);un.singularValueDecompose2dScale(this.matrix,j);const[$,z]=j;un.singularValueDecompose2dScale(this.baseTransform,j);const B=$*j[0],F=z*j[1];let I=x,X=k,M=!1,G=!1;const U=Math.ceil(f*B),_=Math.ceil(m*F),N=Math.ceil(x*B),te=Math.ceil(k*F);U>=N?I=f:M=!0,_>=te?X=m:G=!0;const ie=this.getSizeAndScale(I,this.ctx.canvas.width,B),re=this.getSizeAndScale(X,this.ctx.canvas.height,F),q=e.cachedCanvases.getCanvas("pattern",ie.size,re.size),J=q.context,ce=h.createCanvasGraphics(J,t);if(ce.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(ce,o,c),J.translate(-ie.scale*b,-re.scale*A),ce.transform(0,ie.scale,0,0,re.scale,0,0),J.save(),ce.dependencyTracker?.save(),this.clipBbox(ce,b,A,v,E),ce.baseTransform=Mr(ce.ctx),ce.executeOperatorList(s),ce.endDrawing(),ce.dependencyTracker?.restore(),J.restore(),M||G){const _e=q.canvas;M&&(I=f),G&&(X=m);const xe=this.getSizeAndScale(I,this.ctx.canvas.width,B),Z=this.getSizeAndScale(X,this.ctx.canvas.height,F),D=xe.size,H=Z.size,Y=e.cachedCanvases.getCanvas("pattern-workaround",D,H),ue=Y.context,Ne=M?Math.floor(x/f):0,Pe=G?Math.floor(k/m):0;for(let Ue=0;Ue<=Ne;Ue++)for(let Re=0;Re<=Pe;Re++)ue.drawImage(_e,D*Ue,H*Re,D,H,0,0,D,H);return{canvas:Y.canvas,scaleX:xe.scale,scaleY:Z.scale,offsetX:b,offsetY:A}}return{canvas:q.canvas,scaleX:ie.scale,scaleY:re.scale,offsetX:b,offsetY:A}}getSizeAndScale(e,t,n){const s=Math.max(jy.MAX_PATTERN_SIZE,t);let o=Math.ceil(e*n);return o>=s?o=s:n=o/e,{scale:n,size:o}}clipBbox(e,t,n,s,o){const d=s-t,c=o-n;e.ctx.rect(t,n,d,c),un.axialAlignedBoundingBox([t,n,s,o],Mr(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const s=e.ctx,o=e.current;switch(t){case Ob.COLORED:const{fillStyle:d,strokeStyle:c}=this.ctx;s.fillStyle=o.fillColor=d,s.strokeStyle=o.strokeColor=c;break;case Ob.UNCOLORED:s.fillStyle=s.strokeStyle=n,o.fillColor=o.strokeColor=n;break;default:throw new k3(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,n,s,o){let d=n;s!==ko.SHADING&&(d=un.transform(d,t.baseTransform),this.matrix&&(d=un.transform(d,this.matrix)));const c=this.createPatternCanvas(t,o);let h=new DOMMatrix(d);h=h.translate(c.offsetX,c.offsetY),h=h.scale(1/c.scaleX,1/c.scaleY);const f=e.createPattern(c.canvas,"repeat");return f.setTransform(h),f}}function gT({src:r,srcPos:e=0,dest:t,width:n,height:s,nonBlackColor:o=4294967295,inverseDecode:d=!1}){const c=jo.isLittleEndian?4278190080:255,[h,f]=d?[o,c]:[c,o],m=n>>3,b=n&7,A=r.length;t=new Uint32Array(t.buffer);let v=0;for(let E=0;E<s;E++){for(const k=e+m;e<k;e++){const j=e<A?r[e]:255;t[v++]=j&128?f:h,t[v++]=j&64?f:h,t[v++]=j&32?f:h,t[v++]=j&16?f:h,t[v++]=j&8?f:h,t[v++]=j&4?f:h,t[v++]=j&2?f:h,t[v++]=j&1?f:h}if(b===0)continue;const x=e<A?r[e++]:255;for(let k=0;k<b;k++)t[v++]=x&1<<7-k?f:h}return{srcPos:e,destPos:v}}const Fb=16,Ub=100,mT=15,Hb=10,$l=16,Lm=new DOMMatrix,mc=new Float32Array(2),cf=new Float32Array([1/0,1/0,-1/0,-1/0]);function yT(r,e){if(r._removeMirroring)throw new Error("Context is already forwarding operations.");r.__originalSave=r.save,r.__originalRestore=r.restore,r.__originalRotate=r.rotate,r.__originalScale=r.scale,r.__originalTranslate=r.translate,r.__originalTransform=r.transform,r.__originalSetTransform=r.setTransform,r.__originalResetTransform=r.resetTransform,r.__originalClip=r.clip,r.__originalMoveTo=r.moveTo,r.__originalLineTo=r.lineTo,r.__originalBezierCurveTo=r.bezierCurveTo,r.__originalRect=r.rect,r.__originalClosePath=r.closePath,r.__originalBeginPath=r.beginPath,r._removeMirroring=()=>{r.save=r.__originalSave,r.restore=r.__originalRestore,r.rotate=r.__originalRotate,r.scale=r.__originalScale,r.translate=r.__originalTranslate,r.transform=r.__originalTransform,r.setTransform=r.__originalSetTransform,r.resetTransform=r.__originalResetTransform,r.clip=r.__originalClip,r.moveTo=r.__originalMoveTo,r.lineTo=r.__originalLineTo,r.bezierCurveTo=r.__originalBezierCurveTo,r.rect=r.__originalRect,r.closePath=r.__originalClosePath,r.beginPath=r.__originalBeginPath,delete r._removeMirroring},r.save=function(){e.save(),this.__originalSave()},r.restore=function(){e.restore(),this.__originalRestore()},r.translate=function(t,n){e.translate(t,n),this.__originalTranslate(t,n)},r.scale=function(t,n){e.scale(t,n),this.__originalScale(t,n)},r.transform=function(t,n,s,o,d,c){e.transform(t,n,s,o,d,c),this.__originalTransform(t,n,s,o,d,c)},r.setTransform=function(t,n,s,o,d,c){e.setTransform(t,n,s,o,d,c),this.__originalSetTransform(t,n,s,o,d,c)},r.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},r.rotate=function(t){e.rotate(t),this.__originalRotate(t)},r.clip=function(t){e.clip(t),this.__originalClip(t)},r.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},r.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},r.bezierCurveTo=function(t,n,s,o,d,c){e.bezierCurveTo(t,n,s,o,d,c),this.__originalBezierCurveTo(t,n,s,o,d,c)},r.rect=function(t,n,s,o){e.rect(t,n,s,o),this.__originalRect(t,n,s,o)},r.closePath=function(){e.closePath(),this.__originalClosePath()},r.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class xT{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let s;return this.cache[e]!==void 0?(s=this.cache[e],this.canvasFactory.reset(s,t,n)):(s=this.canvasFactory.create(t,n),this.cache[e]=s),s}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Mg(r,e,t,n,s,o,d,c,h,f){const[m,b,A,v,E,x]=Mr(r);if(b===0&&A===0){const $=d*m+E,z=Math.round($),B=c*v+x,F=Math.round(B),I=(d+h)*m+E,X=Math.abs(Math.round(I)-z)||1,M=(c+f)*v+x,G=Math.abs(Math.round(M)-F)||1;return r.setTransform(Math.sign(m),0,0,Math.sign(v),z,F),r.drawImage(e,t,n,s,o,0,0,X,G),r.setTransform(m,b,A,v,E,x),[X,G]}if(m===0&&v===0){const $=c*A+E,z=Math.round($),B=d*b+x,F=Math.round(B),I=(c+f)*A+E,X=Math.abs(Math.round(I)-z)||1,M=(d+h)*b+x,G=Math.abs(Math.round(M)-F)||1;return r.setTransform(0,Math.sign(b),Math.sign(A),0,z,F),r.drawImage(e,t,n,s,o,0,0,G,X),r.setTransform(m,b,A,v,E,x),[G,X]}r.drawImage(e,t,n,s,o,d,c,h,f);const k=Math.hypot(m,b),j=Math.hypot(A,v);return[k*h,j*f]}class qb{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Qm;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=Co.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(e,t,n){n?.(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=cf.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=ko.FILL,t=null){const n=this.minMax.slice();if(e===ko.STROKE){t||Xs("Stroke bounding box must include transform."),un.singularValueDecompose2dScale(t,mc);const s=mc[0]*this.lineWidth/2,o=mc[1]*this.lineWidth/2;n[0]-=s,n[1]-=o,n[2]+=s,n[3]+=o}return n}updateClipFromPath(){const e=un.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(cf,0)}getClippedPathBoundingBox(e=ko.FILL,t=null){return un.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function Vb(r,e){if(e instanceof ImageData){r.putImageData(e,0,0);return}const t=e.height,n=e.width,s=t%$l,o=(t-s)/$l,d=s===0?o:o+1,c=r.createImageData(n,$l);let h=0,f;const m=e.data,b=c.data;let A,v,E,x;if(e.kind===Wg.GRAYSCALE_1BPP){const k=m.byteLength,j=new Uint32Array(b.buffer,0,b.byteLength>>2),$=j.length,z=n+7>>3,B=4294967295,F=jo.isLittleEndian?4278190080:255;for(A=0;A<d;A++){for(E=A<o?$l:s,f=0,v=0;v<E;v++){const I=k-h;let X=0;const M=I>z?n:I*8-7,G=M&-8;let U=0,_=0;for(;X<G;X+=8)_=m[h++],j[f++]=_&128?B:F,j[f++]=_&64?B:F,j[f++]=_&32?B:F,j[f++]=_&16?B:F,j[f++]=_&8?B:F,j[f++]=_&4?B:F,j[f++]=_&2?B:F,j[f++]=_&1?B:F;for(;X<M;X++)U===0&&(_=m[h++],U=128),j[f++]=_&U?B:F,U>>=1}for(;f<$;)j[f++]=0;r.putImageData(c,0,A*$l)}}else if(e.kind===Wg.RGBA_32BPP){for(v=0,x=n*$l*4,A=0;A<o;A++)b.set(m.subarray(h,h+x)),h+=x,r.putImageData(c,0,v),v+=$l;A<d&&(x=n*s*4,b.set(m.subarray(h,h+x)),r.putImageData(c,0,v))}else if(e.kind===Wg.RGB_24BPP)for(E=$l,x=n*E,A=0;A<d;A++){for(A>=o&&(E=s,x=n*E),f=0,v=x;v--;)b[f++]=m[h++],b[f++]=m[h++],b[f++]=m[h++],b[f++]=255;r.putImageData(c,0,A*$l)}else throw new Error(`bad image kind: ${e.kind}`)}function Wb(r,e){if(e.bitmap){r.drawImage(e.bitmap,0,0);return}const t=e.height,n=e.width,s=t%$l,o=(t-s)/$l,d=s===0?o:o+1,c=r.createImageData(n,$l);let h=0;const f=e.data,m=c.data;for(let b=0;b<d;b++){const A=b<o?$l:s;({srcPos:h}=gT({src:f,srcPos:h,dest:m,width:n,height:A,nonBlackColor:0})),r.putImageData(c,0,b*$l)}}function sp(r,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of t)r[n]!==void 0&&(e[n]=r[n]);r.setLineDash!==void 0&&(e.setLineDash(r.getLineDash()),e.lineDashOffset=r.lineDashOffset)}function zg(r){r.strokeStyle=r.fillStyle="#000000",r.fillRule="nonzero",r.globalAlpha=1,r.lineWidth=1,r.lineCap="butt",r.lineJoin="miter",r.miterLimit=10,r.globalCompositeOperation="source-over",r.font="10px sans-serif",r.setLineDash!==void 0&&(r.setLineDash([]),r.lineDashOffset=0);const{filter:e}=r;e!=="none"&&e!==""&&(r.filter="none")}function $b(r,e){if(e)return!0;un.singularValueDecompose2dScale(r,mc);const t=Math.fround(kd.pixelRatio*vf.PDF_TO_CSS_UNITS);return mc[0]<=t&&mc[1]<=t}const bT=["butt","round","square"],vT=["miter","round","bevel"],wT={},Gb={};class yf{constructor(e,t,n,s,o,{optionalContentConfig:d,markedContentStack:c=null},h,f,m){this.ctx=e,this.current=new qb(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=s,this.filterFactory=o,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=d,this.cachedCanvases=new xT(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=m??null}getObject(e,t,n=null){return typeof t=="string"?(this.dependencyTracker?.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):n}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:s=null}){const o=this.ctx.canvas.width,d=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,o,d),this.ctx.fillStyle=c,n){const h=this.cachedCanvases.getCanvas("transparent",o,d);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...Mr(this.compositeCtx))}this.ctx.save(),zg(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Mr(this.ctx)}executeOperatorList(e,t,n,s,o){const d=e.argsArray,c=e.fnArray;let h=t||0;const f=d.length;if(f===h)return h;const m=f-h>Hb&&typeof n=="function",b=m?Date.now()+mT:0;let A=0;const v=this.commonObjs,E=this.objs;let x,k;for(;;){if(s!==void 0&&h===s.nextBreakPoint)return s.breakIt(h,n),h;if(!o||o(h))if(x=c[h],k=d[h]??null,x!==xp.dependency)k===null?this[x](h):this[x](h,...k);else for(const j of k){this.dependencyTracker?.recordNamedData(j,h);const $=j.startsWith("g_")?v:E;if(!$.has(j))return $.get(j,n),h}if(h++,h===f)return h;if(m&&++A>Hb){if(Date.now()>b)return n(),h;A=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const n=e.width??e.displayWidth,s=e.height??e.displayHeight;let o=Math.max(Math.hypot(t[0],t[1]),1),d=Math.max(Math.hypot(t[2],t[3]),1),c=n,h=s,f="prescale1",m,b;for(;o>2&&c>1||d>2&&h>1;){let A=c,v=h;o>2&&c>1&&(A=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),o/=c/A),d>2&&h>1&&(v=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,d/=h/v),m=this.cachedCanvases.getCanvas(f,A,v),b=m.context,b.clearRect(0,0,A,v),b.drawImage(e,0,0,c,h,0,0,A,v),e=m.canvas,c=A,h=v,f=f==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:c,paintHeight:h}}_createMaskCanvas(e,t){const n=this.ctx,{width:s,height:o}=t,d=this.current.fillColor,c=this.current.patternFill,h=Mr(n);let f,m,b,A;if((t.bitmap||t.data)&&t.count>1){const U=t.bitmap||t.data.buffer;m=JSON.stringify(c?h:[h.slice(0,4),d]),f=this._cachedBitmapsMap.get(U),f||(f=new Map,this._cachedBitmapsMap.set(U,f));const _=f.get(m);if(_&&!c){const N=Math.round(Math.min(h[0],h[2])+h[4]),te=Math.round(Math.min(h[1],h[3])+h[5]);return this.dependencyTracker?.recordDependencies(e,Ic.transformAndFill),{canvas:_,offsetX:N,offsetY:te}}b=_}b||(A=this.cachedCanvases.getCanvas("maskCanvas",s,o),Wb(A.context,t));let v=un.transform(h,[1/s,0,0,-1/o,0,0]);v=un.transform(v,[1,0,0,1,0,-o]);const E=cf.slice();un.axialAlignedBoundingBox([0,0,s,o],v,E);const[x,k,j,$]=E,z=Math.round(j-x)||1,B=Math.round($-k)||1,F=this.cachedCanvases.getCanvas("fillCanvas",z,B),I=F.context,X=x,M=k;I.translate(-X,-M),I.transform(...v),b||(b=this._scaleImage(A.canvas,vd(I)),b=b.img,f&&c&&f.set(m,b)),I.imageSmoothingEnabled=$b(Mr(I),t.interpolate),Mg(I,b,0,0,b.width,b.height,0,0,s,o),I.globalCompositeOperation="source-in";const G=un.transform(vd(I),[1,0,0,1,-X,-M]);return I.fillStyle=c?d.getPattern(n,this,G,ko.FILL,e):d,I.fillRect(0,0,s,o),f&&!c&&(this.cachedCanvases.delete("fillCanvas"),f.set(m,F.canvas)),this.dependencyTracker?.recordDependencies(e,Ic.transformAndFill),{canvas:F.canvas,offsetX:Math.round(X),offsetY:Math.round(M)}}setLineWidth(e,t){this.dependencyTracker?.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){this.dependencyTracker?.recordSimpleData("lineCap",e),this.ctx.lineCap=bT[t]}setLineJoin(e,t){this.dependencyTracker?.recordSimpleData("lineJoin",e),this.ctx.lineJoin=vT[t]}setMiterLimit(e,t){this.dependencyTracker?.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,n){this.dependencyTracker?.recordSimpleData("dash",e);const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(t),s.lineDashOffset=n)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){for(const[n,s]of t)switch(n){case"LW":this.setLineWidth(e,s);break;case"LC":this.setLineCap(e,s);break;case"LJ":this.setLineJoin(e,s);break;case"ML":this.setMiterLimit(e,s);break;case"D":this.setDash(e,s[0],s[1]);break;case"RI":this.setRenderingIntent(e,s);break;case"FL":this.setFlatness(e,s);break;case"Font":this.setFont(e,s[0],s[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=s;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=s;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=s;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",e),this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,n=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,o=this.cachedCanvases.getCanvas(s,t,n);this.suspendedCtx=this.ctx;const d=this.ctx=o.context;d.setTransform(this.suspendedCtx.getTransform()),sp(this.suspendedCtx,d),yT(d,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),sp(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,s){const o=s[0],d=s[1],c=s[2]-o,h=s[3]-d;c===0||h===0||(this.genericComposeSMask(t.context,n,c,h,t.subtype,t.backdrop,t.transferMap,o,d,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,s,o,d,c,h,f,m,b){let A=e.canvas,v=h-m,E=f-b;if(d)if(v<0||E<0||v+n>A.width||E+s>A.height){const k=this.cachedCanvases.getCanvas("maskExtension",n,s),j=k.context;j.drawImage(A,-v,-E),j.globalCompositeOperation="destination-atop",j.fillStyle=d,j.fillRect(0,0,n,s),j.globalCompositeOperation="source-over",A=k.canvas,v=E=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const k=new Path2D;k.rect(v,E,n,s),e.clip(k),e.globalCompositeOperation="destination-atop",e.fillStyle=d,e.fillRect(v,E,n,s),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),o==="Alpha"&&c?t.filter=this.filterFactory.addAlphaFilter(c):o==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(c));const x=new Path2D;x.rect(h,f,n,s),t.clip(x),t.globalCompositeOperation="destination-in",t.drawImage(A,v,E,n,s,h,f,n,s),t.restore()}save(e){this.inSMaskMode&&sp(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),this.dependencyTracker?.save(e)}restore(e){if(this.dependencyTracker?.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&sp(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,n,s,o,d,c){this.dependencyTracker?.recordIncrementalData("transform",e),this.ctx.transform(t,n,s,o,d,c),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n,s){let[o]=n;if(!s){o||=n[0]=new Path2D,this[t](e,o);return}if(this.dependencyTracker!==null){const d=t===xp.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,s[0]-d,s[2]+d,s[1]-d,s[3]+d).recordDependencies(e,["transform"])}o instanceof Path2D||(o=n[0]=nv(o)),un.axialAlignedBoundingBox(s,Mr(this.ctx),this.current.minMax),this[t](e,o),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,n=!0){const s=this.ctx,o=this.current.strokeColor;if(s.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof o=="object"&&o?.getPattern){const d=o.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.strokeStyle=o.getPattern(s,this,vd(s),ko.STROKE,e),d){const c=new Path2D;c.addPath(t,s.getTransform().invertSelf().multiplySelf(d)),t=c}this.rescaleAndStroke(t,!1),s.restore()}else this.rescaleAndStroke(t,!0);this.dependencyTracker?.recordDependencies(e,Ic.stroke),n&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(ko.STROKE,Mr(this.ctx))),s.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,n=!0){const s=this.ctx,o=this.current.fillColor,d=this.current.patternFill;let c=!1;if(d){const f=o.isModifyingCurrentTransform()?s.getTransform():null;if(this.dependencyTracker?.save(e),s.save(),s.fillStyle=o.getPattern(s,this,vd(s),ko.FILL,e),f){const m=new Path2D;m.addPath(t,s.getTransform().invertSelf().multiplySelf(f)),t=m}c=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(s.fill(t,"evenodd"),this.pendingEOFill=!1):s.fill(t)),this.dependencyTracker?.recordDependencies(e,Ic.fill),c&&(s.restore(),this.dependencyTracker?.restore(e)),n&&this.consumePath(e,t,h)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){this.ctx.fill(t),this.dependencyTracker?.recordDependencies(e,Ic.rawFillPath).recordOperation(e)}clip(e){this.dependencyTracker?.recordFutureForcedDependency("clipMode",e),this.pendingClip=wT}eoClip(e){this.dependencyTracker?.recordFutureForcedDependency("clipMode",e),this.pendingClip=Gb}beginText(e){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,n=this.ctx;if(this.dependencyTracker){const{dependencyTracker:s}=this;t!==void 0&&s.recordFutureForcedDependency("textClip",s.getOpenMarker()).recordFutureForcedDependency("textClip",e),s.recordCloseMarker(e)}if(t!==void 0){const s=new Path2D,o=n.getTransform().invertSelf();for(const{transform:d,x:c,y:h,fontSize:f,path:m}of t)m&&s.addPath(m,new DOMMatrix(d).preMultiplySelf(o).translate(c,h).scale(f,-f));n.clip(s)}delete this.pendingTextPaths}setCharSpacing(e,t){this.dependencyTracker?.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){this.dependencyTracker?.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){this.dependencyTracker?.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){this.dependencyTracker?.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,n){this.dependencyTracker?.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const s=this.commonObjs.get(t),o=this.current;if(!s)throw new Error(`Can't find font for ${t}`);if(o.fontMatrix=s.fontMatrix||Qm,(o.fontMatrix[0]===0||o.fontMatrix[3]===0)&&ui("Invalid font matrix for font "+t),n<0?(n=-n,o.fontDirection=-1):o.fontDirection=1,this.current.font=s,this.current.fontSize=n,s.isType3Font)return;const d=s.loadedName||"sans-serif",c=s.systemFontInfo?.css||`"${d}", ${s.fallbackName}`;let h="normal";s.black?h="900":s.bold&&(h="bold");const f=s.italic?"italic":"normal";let m=n;n<Fb?m=Fb:n>Ub&&(m=Ub),this.current.fontSizeScale=n/m,this.ctx.font=`${f} ${h} ${m}px ${c}`}setTextRenderingMode(e,t){this.dependencyTracker?.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){this.dependencyTracker?.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,n){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=n}setLeadingMoveText(e,t,n){this.setLeading(e,-n),this.moveText(e,t,n)}setTextMatrix(e,t){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",e);const{current:n}=this;n.textMatrix=t,n.textMatrixScale=Math.hypot(t[0],t[1]),n.x=n.lineX=0,n.y=n.lineY=0}nextLine(e){this.moveText(e,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}#i(e,t,n){const s=new Path2D;return s.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),s}paintChar(e,t,n,s,o,d){const c=this.ctx,h=this.current,f=h.font,m=h.textRenderingMode,b=h.fontSize/h.fontSizeScale,A=m&Co.FILL_STROKE_MASK,v=!!(m&Co.ADD_TO_PATH_FLAG),E=h.patternFill&&!f.missingFile,x=h.patternStroke&&!f.missingFile;let k;if((f.disableFontFace||v||E||x)&&!f.missingFile&&(k=f.getPathGenerator(this.commonObjs,t)),k&&(f.disableFontFace||E||x)){c.save(),c.translate(n,s),c.scale(b,-b),this.dependencyTracker?.recordCharacterBBox(e,c,f);let j;if(A===Co.FILL||A===Co.FILL_STROKE)if(o){j=c.getTransform(),c.setTransform(...o);const $=this.#i(k,j,o);c.fill($)}else c.fill(k);if(A===Co.STROKE||A===Co.FILL_STROKE)if(d){j||=c.getTransform(),c.setTransform(...d);const{a:$,b:z,c:B,d:F}=j,I=un.inverseTransform(d),X=un.transform([$,z,B,F,0,0],I);un.singularValueDecompose2dScale(X,mc),c.lineWidth*=Math.max(mc[0],mc[1])/b,c.stroke(this.#i(k,j,d))}else c.lineWidth/=b,c.stroke(k);c.restore()}else(A===Co.FILL||A===Co.FILL_STROKE)&&(c.fillText(t,n,s),this.dependencyTracker?.recordCharacterBBox(e,c,f,b,n,s,()=>c.measureText(t))),(A===Co.STROKE||A===Co.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(e,c,f,b,n,s,()=>c.measureText(t)).recordDependencies(e,Ic.stroke),c.strokeText(t,n,s));v&&((this.pendingTextPaths||=[]).push({transform:Mr(c),x:n,y:s,fontSize:b,path:k}),this.dependencyTracker?.recordCharacterBBox(e,c,f,b,n,s))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let s=3;s<t.length;s+=4)if(t[s]>0&&t[s]<255){n=!0;break}return hi(this,"isFontSubpixelAAEnabled",n)}showText(e,t){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,Ic.showText).resetBBox(e),this.current.textRenderingMode&Co.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const n=this.current,s=n.font;if(s.isType3Font){this.showType3Text(e,t),this.dependencyTracker?.recordShowTextOperation(e);return}const o=n.fontSize;if(o===0){this.dependencyTracker?.recordOperation(e);return}const d=this.ctx,c=n.fontSizeScale,h=n.charSpacing,f=n.wordSpacing,m=n.fontDirection,b=n.textHScale*m,A=t.length,v=s.vertical,E=v?1:-1,x=s.defaultVMetrics,k=o*n.fontMatrix[0],j=n.textRenderingMode===Co.FILL&&!s.disableFontFace&&!n.patternFill;d.save(),n.textMatrix&&d.transform(...n.textMatrix),d.translate(n.x,n.y+n.textRise),m>0?d.scale(b,-1):d.scale(b,1);let $,z;if(n.patternFill){d.save();const M=n.fillColor.getPattern(d,this,vd(d),ko.FILL,e);$=Mr(d),d.restore(),d.fillStyle=M}if(n.patternStroke){d.save();const M=n.strokeColor.getPattern(d,this,vd(d),ko.STROKE,e);z=Mr(d),d.restore(),d.strokeStyle=M}let B=n.lineWidth;const F=n.textMatrixScale;if(F===0||B===0){const M=n.textRenderingMode&Co.FILL_STROKE_MASK;(M===Co.STROKE||M===Co.FILL_STROKE)&&(B=this.getSinglePixelWidth())}else B/=F;if(c!==1&&(d.scale(c,c),B/=c),d.lineWidth=B,s.isInvalidPDFjsFont){const M=[];let G=0;for(const _ of t)M.push(_.unicode),G+=_.width;const U=M.join("");if(d.fillText(U,0,0),this.dependencyTracker!==null){const _=d.measureText(U);this.dependencyTracker.recordBBox(e,this.ctx,-_.actualBoundingBoxLeft,_.actualBoundingBoxRight,-_.actualBoundingBoxAscent,_.actualBoundingBoxDescent).recordShowTextOperation(e)}n.x+=G*k*b,d.restore(),this.compose();return}let I=0,X;for(X=0;X<A;++X){const M=t[X];if(typeof M=="number"){I+=E*M*o/1e3;continue}let G=!1;const U=(M.isSpace?f:0)+h,_=M.fontChar,N=M.accent;let te,ie,re=M.width;if(v){const ce=M.vmetric||x,_e=-(M.vmetric?ce[1]:re*.5)*k,xe=ce[2]*k;re=ce?-ce[0]:re,te=_e/c,ie=(I+xe)/c}else te=I/c,ie=0;let q;if(s.remeasure&&re>0){q=d.measureText(_);const ce=q.width*1e3/o*c;if(re<ce&&this.isFontSubpixelAAEnabled){const _e=re/ce;G=!0,d.save(),d.scale(_e,1),te/=_e}else re!==ce&&(te+=(re-ce)/2e3*o/c)}if(this.contentVisible&&(M.isInFont||s.missingFile)){if(j&&!N)d.fillText(_,te,ie),this.dependencyTracker?.recordCharacterBBox(e,d,q?{bbox:null}:s,o/c,te,ie,()=>q??d.measureText(_));else if(this.paintChar(e,_,te,ie,$,z),N){const ce=te+o*N.offset.x/c,_e=ie-o*N.offset.y/c;this.paintChar(e,N.fontChar,ce,_e,$,z)}}const J=v?re*k-U*m:re*k+U*m;I+=J,G&&d.restore()}v?n.y-=I:n.x+=I*b,d.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(e)}showType3Text(e,t){const n=this.ctx,s=this.current,o=s.font,d=s.fontSize,c=s.fontDirection,h=o.vertical?1:-1,f=s.charSpacing,m=s.wordSpacing,b=s.textHScale*c,A=s.fontMatrix||Qm,v=t.length,E=s.textRenderingMode===Co.INVISIBLE;let x,k,j,$;if(E||d===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),s.textMatrix&&n.transform(...s.textMatrix),n.translate(s.x,s.y+s.textRise),n.scale(b,c);const z=this.dependencyTracker;for(this.dependencyTracker=z?new e0(z,e):null,x=0;x<v;++x){if(k=t[x],typeof k=="number"){$=h*k*d/1e3,this.ctx.translate($,0),s.x+=$*b;continue}const B=(k.isSpace?m:0)+f,F=o.charProcOperatorList[k.operatorListId];F?this.contentVisible&&(this.save(),n.scale(d,d),n.transform(...A),this.executeOperatorList(F),this.restore()):ui(`Type3 character "${k.operatorListId}" is not available.`);const I=[k.width,0];un.applyTransform(I,A),j=I[0]*d+B,n.translate(j,0),s.x+=j*b}n.restore(),z&&(this.dependencyTracker=z)}setCharWidth(e,t,n){}setCharWidthAndBounds(e,t,n,s,o,d,c){const h=new Path2D;h.rect(s,o,d-s,c-o),this.ctx.clip(h),this.dependencyTracker?.recordBBox(e,this.ctx,s,d,o,c).recordClipBox(e,this.ctx,s,d,o,c),this.endPath(e)}getColorN_Pattern(e,t){let n;if(t[0]==="TilingPattern"){const s=this.baseTransform||Mr(this.ctx),o={createCanvasGraphics:(d,c)=>new yf(d,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new e0(this.dependencyTracker,c,!0):null)};n=new jy(t,this.ctx,o,s)}else n=this._getPattern(e,t[1],t[2]);return n}setStrokeColorN(e,...t){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){this.dependencyTracker?.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){this.dependencyTracker?.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){this.dependencyTracker?.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,n=null){let s;return this.cachedPatterns.has(t)?s=this.cachedPatterns.get(t):(s=pT(this.getObject(e,t)),this.cachedPatterns.set(t,s)),n&&(s.matrix=n),s}shadingFill(e,t){if(!this.contentVisible)return;const n=this.ctx;this.save(e);const s=this._getPattern(e,t);n.fillStyle=s.getPattern(n,this,vd(n),ko.SHADING,e);const o=vd(n);if(o){const{width:d,height:c}=n.canvas,h=cf.slice();un.axialAlignedBoundingBox([0,0,d,c],o,h);const[f,m,b,A]=h;this.ctx.fillRect(f,m,b-f,A-m)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,Ic.transform).recordDependencies(e,Ic.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){Xs("Should not call beginInlineImage")}beginImageData(){Xs("Should not call beginImageData")}paintFormXObjectBegin(e,t,n){if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=Mr(this.ctx),n)){un.axialAlignedBoundingBox(n,this.baseTransform,this.current.minMax);const[s,o,d,c]=n,h=new Path2D;h.rect(s,o,d-s,c-o),this.ctx.clip(h),this.dependencyTracker?.recordClipBox(e,this.ctx,s,d,o,c),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;t.isolated||l0("TODO: Support non-isolated groups."),t.knockout&&ui("Knockout groups not supported.");const s=Mr(n);if(t.matrix&&n.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let o=cf.slice();un.axialAlignedBoundingBox(t.bbox,Mr(n),o);const d=[0,0,n.canvas.width,n.canvas.height];o=un.intersect(o,d)||[0,0,0,0];const c=Math.floor(o[0]),h=Math.floor(o[1]),f=Math.max(Math.ceil(o[2])-c,1),m=Math.max(Math.ceil(o[3])-h,1);this.current.startNewPathAndClipBox([0,0,f,m]);let b="groupAt"+this.groupLevel;t.smask&&(b+="_smask_"+this.smaskCounter++%2);const A=this.cachedCanvases.getCanvas(b,f,m),v=A.context;v.translate(-c,-h),v.transform(...s);let E=new Path2D;const[x,k,j,$]=t.bbox;if(E.rect(x,k,j-x,$-k),t.matrix){const z=new Path2D;z.addPath(E,new DOMMatrix(t.matrix)),E=z}v.clip(E),t.smask&&this.smaskStack.push({canvas:A.canvas,context:v,offsetX:c,offsetY:h,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(n.setTransform(1,0,0,1,0,0),n.translate(c,h),n.save()),sp(n,v),this.ctx=v,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(n),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(e,t){if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const o=Mr(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...o);const d=cf.slice();un.axialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],o,d),this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(d)}}beginAnnotation(e,t,n,s,o,d){if(this.#e(),zg(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){const c=n[2]-n[0],h=n[3]-n[1];if(d&&this.annotationCanvasMap){s=s.slice(),s[4]-=n[0],s[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=c,n[3]=h,un.singularValueDecompose2dScale(Mr(this.ctx),mc);const{viewportScale:f}=this,m=Math.ceil(c*this.outputScaleX*f),b=Math.ceil(h*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(m,b);const{canvas:A,context:v}=this.annotationCanvas;this.annotationCanvasMap.set(t,A),this.annotationCanvas.savedCtx=this.ctx,this.ctx=v,this.ctx.save(),this.ctx.setTransform(mc[0],0,0,-mc[1],0,h*mc[1]),zg(this.ctx)}else{zg(this.ctx),this.endPath(e);const f=new Path2D;f.rect(n[0],n[1],c,h),this.ctx.clip(f)}}this.current=new qb(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...s),this.transform(e,...o)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){if(!this.contentVisible)return;const n=t.count;t=this.getObject(e,t.data,t),t.count=n;const s=this.ctx,o=this._createMaskCanvas(e,t),d=o.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(d,o.offsetX,o.offsetY),this.dependencyTracker?.resetBBox(e).recordBBox(e,this.ctx,o.offsetX,o.offsetX+d.width,o.offsetY,o.offsetY+d.height).recordOperation(e),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n,s=0,o=0,d,c){if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const h=this.ctx;h.save();const f=Mr(h);h.transform(n,s,o,d,0,0);const m=this._createMaskCanvas(e,t);h.setTransform(1,0,0,1,m.offsetX-f[4],m.offsetY-f[5]),this.dependencyTracker?.resetBBox(e);for(let b=0,A=c.length;b<A;b+=2){const v=un.transform(f,[n,s,o,d,c[b],c[b+1]]);h.drawImage(m.canvas,v[4],v[5]),this.dependencyTracker?.recordBBox(e,this.ctx,v[4],v[4]+m.canvas.width,v[5],v[5]+m.canvas.height)}h.restore(),this.compose(),this.dependencyTracker?.recordOperation(e)}paintImageMaskXObjectGroup(e,t){if(!this.contentVisible)return;const n=this.ctx,s=this.current.fillColor,o=this.current.patternFill;this.dependencyTracker?.resetBBox(e).recordDependencies(e,Ic.transformAndFill);for(const d of t){const{data:c,width:h,height:f,transform:m}=d,b=this.cachedCanvases.getCanvas("maskCanvas",h,f),A=b.context;A.save();const v=this.getObject(e,c,d);Wb(A,v),A.globalCompositeOperation="source-in",A.fillStyle=o?s.getPattern(A,this,vd(n),ko.FILL,e):s,A.fillRect(0,0,h,f),A.restore(),n.save(),n.transform(...m),n.scale(1,-1),Mg(n,b.canvas,0,0,h,f,0,-1,1,1),this.dependencyTracker?.recordBBox(e,n,0,h,0,f),n.restore()}this.compose(),this.dependencyTracker?.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const n=this.getObject(e,t);if(!n){ui("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,n)}paintImageXObjectRepeat(e,t,n,s,o){if(!this.contentVisible)return;const d=this.getObject(e,t);if(!d){ui("Dependent image isn't ready yet");return}const c=d.width,h=d.height,f=[];for(let m=0,b=o.length;m<b;m+=2)f.push({transform:[n,0,0,s,o[m],o[m+1]],x:0,y:0,w:c,h});this.paintInlineImageXObjectGroup(e,d,f)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:n,height:s}=e,o=this.cachedCanvases.getCanvas("inlineImage",n,s),d=o.context;return d.filter=this.current.transferMaps,d.drawImage(t,0,0),d.filter="none",o.canvas}paintInlineImageXObject(e,t){if(!this.contentVisible)return;const n=t.width,s=t.height,o=this.ctx;this.save(e);const{filter:d}=o;d!=="none"&&d!==""&&(o.filter="none"),o.scale(1/n,-1/s);let c;if(t.bitmap)c=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)c=t;else{const m=this.cachedCanvases.getCanvas("inlineImage",n,s).context;Vb(m,t),c=this.applyTransferMapsToCanvas(m)}const h=this._scaleImage(c,vd(o));o.imageSmoothingEnabled=$b(Mr(o),t.interpolate),this.dependencyTracker?.resetBBox(e).recordBBox(e,o,0,n,-s,0).recordDependencies(e,Ic.imageXObject).recordOperation(e),Mg(o,h.img,0,0,h.paintWidth,h.paintHeight,0,-s,n,s),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,n){if(!this.contentVisible)return;const s=this.ctx;let o;if(t.bitmap)o=t.bitmap;else{const d=t.width,c=t.height,f=this.cachedCanvases.getCanvas("inlineImage",d,c).context;Vb(f,t),o=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(e);for(const d of n)s.save(),s.transform(...d.transform),s.scale(1,-1),Mg(s,o,d.x,d.y,d.w,d.h,0,-1,1,1),this.dependencyTracker?.recordBBox(e,s,0,1,-1,0),s.restore();this.dependencyTracker?.recordOperation(e),this.compose()}paintSolidColorImageMask(e){this.contentVisible&&(this.dependencyTracker?.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,Ic.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,n){}beginMarkedContent(e,t){this.dependencyTracker?.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,n){this.dependencyTracker?.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){this.dependencyTracker?.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,n){const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const o=this.ctx;this.pendingClip?(s||(this.pendingClip===Gb?o.clip(t,"evenodd"):o.clip(t)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):this.dependencyTracker?.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Mr(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),s=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,s)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:n,c:s,d:o}=this.ctx.getTransform();let d,c;if(n===0&&s===0){const h=Math.abs(t),f=Math.abs(o);if(h===f)if(e===0)d=c=1/h;else{const m=h*e;d=c=m<1?1/m:1}else if(e===0)d=1/h,c=1/f;else{const m=h*e,b=f*e;d=m<1?1/m:1,c=b<1?1/b:1}}else{const h=Math.abs(t*o-n*s),f=Math.hypot(t,n),m=Math.hypot(s,o);if(e===0)d=m/h,c=f/h;else{const b=e*h;d=m>b?m/b:1,c=f>b?f/b:1}}this._cachedScaleForStroking[0]=d,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:n,current:{lineWidth:s}}=this,[o,d]=this.getScaleForStroking();if(o===d){n.lineWidth=(s||1)*o,n.stroke(e);return}const c=n.getLineDash();t&&n.save(),n.scale(o,d),Lm.a=1/o,Lm.d=1/d;const h=new Path2D;if(h.addPath(e,Lm),c.length>0){const f=Math.max(o,d);n.setLineDash(c.map(m=>m/f)),n.lineDashOffset/=f}n.lineWidth=s||1,n.stroke(h),t&&n.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const r in xp)yf.prototype[r]!==void 0&&(yf.prototype[xp[r]]=yf.prototype[r]);class xf{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}}class ST{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}[Symbol.iterator](){return this.#e.entries()}}const rf=Symbol("INTERNAL");class AT{#e=!1;#t=!1;#i=!1;#n=!0;constructor(e,{name:t,intent:n,usage:s,rbGroups:o}){this.#e=!!(e&gc.DISPLAY),this.#t=!!(e&gc.PRINT),this.name=t,this.intent=n,this.usage=s,this.rbGroups=o}get visible(){if(this.#i)return this.#n;if(!this.#n)return!1;const{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,n=!1){e!==rf&&Xs("Internal method `_setVisible` called."),this.#i=n,this.#n=t}}class TT{#e=null;#t=new Map;#i=null;#n=null;constructor(e,t=gc.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#n=e.order;for(const n of e.groups)this.#t.set(n.id,new AT(t,n));if(e.baseState==="OFF")for(const n of this.#t.values())n._setVisible(rf,!1);for(const n of e.on)this.#t.get(n)._setVisible(rf,!0);for(const n of e.off)this.#t.get(n)._setVisible(rf,!1);this.#i=this.getHash()}}#a(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let s=1;s<t;s++){const o=e[s];let d;if(Array.isArray(o))d=this.#a(o);else if(this.#t.has(o))d=this.#t.get(o).visible;else return ui(`Optional content group not found: ${o}`),!0;switch(n){case"And":if(!d)return!1;break;case"Or":if(d)return!0;break;case"Not":return!d;default:return!0}}return n==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return l0("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(ui(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#a(e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!this.#t.has(t))return ui(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!this.#t.has(t))return ui(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!this.#t.has(t))return ui(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!this.#t.has(t))return ui(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return ui(`Unknown optional content policy ${e.policy}.`),!0}return ui(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,n=!0){const s=this.#t.get(e);if(!s){ui(`Optional content group not found: ${e}`);return}if(n&&t&&s.rbGroups.length)for(const o of s.rbGroups)for(const d of o)d!==e&&this.#t.get(d)?._setVisible(rf,!1,!0);s._setVisible(rf,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let n;for(const s of e){switch(s){case"ON":case"OFF":case"Toggle":n=s;continue}const o=this.#t.get(s);if(o)switch(n){case"ON":this.setVisibility(s,!0,t);break;case"OFF":this.setVisibility(s,!1,t);break;case"Toggle":this.setVisibility(s,!o.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#i===null||this.getHash()===this.#i}getOrder(){return this.#t.size?this.#n?this.#n.slice():[...this.#t.keys()]:null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;const e=new sv;for(const[t,n]of this.#t)e.update(`${t}:${n.visible}`);return this.#e=e.hexdigest()}[Symbol.iterator](){return this.#t.entries()}}class CT{constructor(e,{disableRange:t=!1,disableStream:n=!1}){Zi(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:o,progressiveDone:d,contentDispositionFilename:c}=e;if(this._queuedChunks=[],this._progressiveDone=d,this._contentDispositionFilename=c,o?.length>0){const h=o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength?o.buffer:new Uint8Array(o).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!t,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((h,f)=>{this._onReceiveData({begin:h,chunk:f})}),e.addProgressListener((h,f)=>{this._onProgress({loaded:h,total:f})}),e.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const s=this._rangeReaders.some(function(o){return o._begin!==e?!1:(o._enqueue(n),!0)});Zi(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Zi(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new _T(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new kT(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class _T{constructor(e,t,n=!1,s=null){this._stream=e,this._done=n||!1,this._filename=Sy(s)?s:null,this._queuedChunks=t||[],this._loaded=0;for(const o of this._queuedChunks)this._loaded+=o.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class kT{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function jT(r){let e=!0,t=n("filename\\*","i").exec(r);if(t){t=t[1];let m=c(t);return m=unescape(m),m=h(m),m=f(m),o(m)}if(t=d(r),t){const m=f(t);return o(m)}if(t=n("filename","i").exec(r),t){t=t[1];let m=c(t);return m=f(m),o(m)}function n(m,b){return new RegExp("(?:^|;)\\s*"+m+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',b)}function s(m,b){if(m){if(!/^[\x00-\xFF]+$/.test(b))return b;try{const A=new TextDecoder(m,{fatal:!0}),v=Tp(b);b=A.decode(v),e=!1}catch{}}return b}function o(m){return e&&/[\x80-\xff]/.test(m)&&(m=s("utf-8",m),e&&(m=s("iso-8859-1",m))),m}function d(m){const b=[];let A;const v=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(A=v.exec(m))!==null;){let[,x,k,j]=A;if(x=parseInt(x,10),x in b){if(x===0)break;continue}b[x]=[k,j]}const E=[];for(let x=0;x<b.length&&x in b;++x){let[k,j]=b[x];j=c(j),k&&(j=unescape(j),x===0&&(j=h(j))),E.push(j)}return E.join("")}function c(m){if(m.startsWith('"')){const b=m.slice(1).split('\\"');for(let A=0;A<b.length;++A){const v=b[A].indexOf('"');v!==-1&&(b[A]=b[A].slice(0,v),b.length=A+1),b[A]=b[A].replaceAll(/\\(.)/g,"$1")}m=b.join('"')}return m}function h(m){const b=m.indexOf("'");if(b===-1)return m;const A=m.slice(0,b),E=m.slice(b+1).replace(/^[^']*'/,"");return s(A,E)}function f(m){return!m.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(m)?m:m.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(b,A,v,E){if(v==="q"||v==="Q")return E=E.replaceAll("_"," "),E=E.replaceAll(/=([0-9a-fA-F]{2})/g,function(x,k){return String.fromCharCode(parseInt(k,16))}),s(A,E);try{E=atob(E)}catch{}return s(A,E)})}return""}function uv(r,e){const t=new Headers;if(!r||!e||typeof e!="object")return t;for(const n in e){const s=e[n];s!==void 0&&t.append(n,s)}return t}function u0(r){return URL.parse(r)?.origin??null}function hv({responseHeaders:r,isHttp:e,rangeChunkSize:t,disableRange:n}){const s={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(r.get("Content-Length"),10);return!Number.isInteger(o)||(s.suggestedLength=o,o<=2*t)||n||!e||r.get("Accept-Ranges")!=="bytes"||(r.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function fv(r){const e=r.get("Content-Disposition");if(e){let t=jT(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Sy(t))return t}return null}function Np(r,e){return new Qg(`Unexpected server response (${r}) while retrieving PDF "${e}".`,r,r===404||r===0&&e.startsWith("file:"))}function pv(r){return r===200||r===206}function gv(r,e,t){return{method:"GET",headers:r,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function mv(r){return r instanceof Uint8Array?r.buffer:r instanceof ArrayBuffer?r:(ui(`getArrayBuffer - unexpected data format: ${r}`),new Uint8Array(r).buffer)}class NT{_responseOrigin=null;constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=uv(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Zi(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new PT(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new ET(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class PT{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const n=new Headers(e.headers),s=t.url;fetch(s,gv(n,this._withCredentials,this._abortController)).then(o=>{if(e._responseOrigin=u0(o.url),!pv(o.status))throw Np(o.status,s);this._reader=o.body.getReader(),this._headersCapability.resolve();const d=o.headers,{allowRangeRequests:c,suggestedLength:h}=hv({responseHeaders:d,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=h||this._contentLength,this._filename=fv(d),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Mu("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:mv(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class ET{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const s=e.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const o=new Headers(e.headers);o.append("Range",`bytes=${t}-${n-1}`);const d=s.url;fetch(d,gv(o,this._withCredentials,this._abortController)).then(c=>{const h=u0(c.url);if(h!==e._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${e._responseOrigin}".`);if(!pv(c.status))throw Np(c.status,d);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:mv(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const Mm=200,zm=206;function RT(r){const e=r.response;return typeof e!="string"?e:Tp(e).buffer}class DT{_responseOrigin=null;constructor({url:e,httpHeaders:t,withCredentials:n}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=uv(this.isHttp,t),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,s=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[o,d]of this.headers)t.setRequestHeader(o,d);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),s.expectedStatus=zm):s.expectedStatus=Mm,t.responseType="arraybuffer",Zi(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),s.onHeadersReceived=e.onHeadersReceived,s.onDone=e.onDone,s.onError=e.onError,s.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){const n=this.pendingRequests[e];n&&n.onProgress?.(t)}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const s=n.xhr;if(s.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),s.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],s.status===0&&this.isHttp){n.onError(s.status);return}const o=s.status||Mm;if(!(o===Mm&&n.expectedStatus===zm)&&o!==n.expectedStatus){n.onError(s.status);return}const c=RT(s);if(o===zm){const h=s.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);f?n.onDone({begin:parseInt(f[1],10),chunk:c}):(ui('Missing or invalid "Content-Range" header.'),n.onError(0))}else c?n.onDone({begin:0,chunk:c}):n.onError(s.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class LT{constructor(e){this._source=e,this._manager=new DT(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Zi(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new MT(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new zT(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class MT{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=u0(t.responseURL);const n=t.getAllResponseHeaders(),s=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(c=>{const[h,...f]=c.split(": ");return[h,f.join(": ")]}):[]),{allowRangeRequests:o,suggestedLength:d}=hv({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});o&&(this._isRangeSupported=!0),this._contentLength=d||this._contentLength,this._filename=fv(s),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Np(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class zT{constructor(e,t,n){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const e=u0(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??=Np(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const IT=/^[a-z][a-z0-9\-+.]+:/i;function BT(r){if(IT.test(r))return new URL(r);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(r))}class OT{constructor(e){this.source=e,this.url=BT(e.url),Zi(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Zi(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new FT(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new UT(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class FT{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=Np(0,this._url.href)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Mu("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class UT{constructor(e,t,n){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=e.source;this._isStreamingSupported=!s.disableStream;const o=process.getBuiltinModule("fs");this._setReadableStream(o.createReadStream(this._url,{start:t,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const rp=Symbol("INITIAL_DATA");class yv{#e=Object.create(null);#t(e){return this.#e[e]||={...Promise.withResolvers(),data:rp}}get(e,t=null){if(t){const s=this.#t(e);return s.promise.then(()=>t(s.data)),null}const n=this.#e[e];if(!n||n.data===rp)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=this.#e[e];return!!t&&t.data!==rp}delete(e){const t=this.#e[e];return!t||t.data===rp?!1:(delete this.#e[e],!0)}resolve(e,t=null){const n=this.#t(e);n.data=t,n.resolve()}clear(){for(const e in this.#e){const{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(const e in this.#e){const{data:t}=this.#e[e];t!==rp&&(yield[e,t])}}}const HT=1e5,Yb=30;class xl{#e=Promise.withResolvers();#t=null;#i=!1;#n=!!globalThis.FontInspector?.enabled;#a=null;#r=null;#s=0;#o=0;#c=null;#l=null;#h=0;#u=0;#f=Object.create(null);#m=[];#g=null;#d=[];#p=new WeakMap;#y=null;static#b=new Map;static#x=new Map;static#C=new WeakMap;static#A=null;static#w=new Set;constructor({textContentSource:e,container:t,viewport:n}){if(e instanceof ReadableStream)this.#g=e;else if(typeof e=="object")this.#g=new ReadableStream({start(h){h.enqueue(e),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#l=t,this.#u=n.scale*kd.pixelRatio,this.#h=n.rotation,this.#r={div:null,properties:null,ctx:null};const{pageWidth:s,pageHeight:o,pageX:d,pageY:c}=n.rawDims;this.#y=[1,0,0,-1,-d,c+o],this.#o=s,this.#s=o,xl.#N(),hh(t,n),this.#e.promise.finally(()=>{xl.#w.delete(this),this.#r=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=jo.platform;return hi(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{this.#c.read().then(({value:t,done:n})=>{if(n){this.#e.resolve();return}this.#a??=t.lang,Object.assign(this.#f,t.styles),this.#k(t.items),e()},this.#e.reject)};return this.#c=this.#g.getReader(),xl.#w.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){const n=e.scale*kd.pixelRatio,s=e.rotation;if(s!==this.#h&&(t?.(),this.#h=s,hh(this.#l,{rotation:s})),n!==this.#u){t?.(),this.#u=n;const o={div:null,properties:null,ctx:xl.#P(this.#a)};for(const d of this.#d)o.properties=this.#p.get(d),o.div=d,this.#T(o)}}cancel(){const e=new Mu("TextLayer task cancelled.");this.#c?.cancel(e).catch(()=>{}),this.#c=null,this.#e.reject(e)}get textDivs(){return this.#d}get textContentItemsStr(){return this.#m}#k(e){if(this.#i)return;this.#r.ctx??=xl.#P(this.#a);const t=this.#d,n=this.#m;for(const s of e){if(t.length>HT){ui("Ignoring additional textDivs for performance reasons."),this.#i=!0;return}if(s.str===void 0){if(s.type==="beginMarkedContentProps"||s.type==="beginMarkedContent"){const o=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),s.id&&this.#t.setAttribute("id",`${s.id}`),o.append(this.#t)}else s.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}n.push(s.str),this.#v(s)}}#v(e){const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#d.push(t);const s=un.transform(this.#y,e.transform);let o=Math.atan2(s[1],s[0]);const d=this.#f[e.fontName];d.vertical&&(o+=Math.PI/2);let c=this.#n&&d.fontSubstitution||d.fontFamily;c=xl.fontFamilyMap.get(c)||c;const h=Math.hypot(s[2],s[3]),f=h*xl.#I(c,d,this.#a);let m,b;o===0?(m=s[4],b=s[5]-f):(m=s[4]+f*Math.sin(o),b=s[5]-f*Math.cos(o));const A="calc(var(--total-scale-factor) *",v=t.style;this.#t===this.#l?(v.left=`${(100*m/this.#o).toFixed(2)}%`,v.top=`${(100*b/this.#s).toFixed(2)}%`):(v.left=`${A}${m.toFixed(2)}px)`,v.top=`${A}${b.toFixed(2)}px)`),v.fontSize=`${A}${(xl.#A*h).toFixed(2)}px)`,v.fontFamily=c,n.fontSize=h,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#n&&(t.dataset.fontName=d.fontSubstitutionLoadedName||e.fontName),o!==0&&(n.angle=o*(180/Math.PI));let E=!1;if(e.str.length>1)E=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const x=Math.abs(e.transform[0]),k=Math.abs(e.transform[3]);x!==k&&Math.max(x,k)/Math.min(x,k)>1.5&&(E=!0)}if(E&&(n.canvasWidth=d.vertical?e.height:e.width),this.#p.set(t,n),this.#r.div=t,this.#r.properties=n,this.#T(this.#r),n.hasText&&this.#t.append(t),n.hasEOL){const x=document.createElement("br");x.setAttribute("role","presentation"),this.#t.append(x)}}#T(e){const{div:t,properties:n,ctx:s}=e,{style:o}=t;let d="";if(xl.#A>1&&(d=`scale(${1/xl.#A})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:c}=o,{canvasWidth:h,fontSize:f}=n;xl.#j(s,f*this.#u,c);const{width:m}=s.measureText(t.textContent);m>0&&(d=`scaleX(${h*this.#u/m}) ${d}`)}n.angle!==0&&(d=`rotate(${n.angle}deg) ${d}`),d.length>0&&(o.transform=d)}static cleanup(){if(!(this.#w.size>0)){this.#b.clear();for(const{canvas:e}of this.#x.values())e.remove();this.#x.clear()}}static#P(e=null){let t=this.#x.get(e||="");if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#x.set(e,t),this.#C.set(t,{size:0,family:""})}return t}static#j(e,t,n){const s=this.#C.get(e);t===s.size&&n===s.family||(e.font=`${t}px ${n}`,s.size=t,s.family=n)}static#N(){if(this.#A!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#A=e.getBoundingClientRect().height,e.remove()}static#I(e,t,n){const s=this.#b.get(e);if(s)return s;const o=this.#P(n);o.canvas.width=o.canvas.height=Yb,this.#j(o,Yb,e);const d=o.measureText(""),c=d.fontBoundingBoxAscent,h=Math.abs(d.fontBoundingBoxDescent);o.canvas.width=o.canvas.height=0;let f=.8;return c?f=c/(c+h):(jo.platform.isFirefox&&ui("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?f=t.ascent:t.descent&&(f=1+t.descent)),this.#b.set(e,f),f}}const qT=100;function xv(r={}){typeof r=="string"||r instanceof URL?r={url:r}:(r instanceof ArrayBuffer||ArrayBuffer.isView(r))&&(r={data:r});const e=new Ny,{docId:t}=e,n=r.url?K3(r.url):null,s=r.data?Z3(r.data):null,o=r.httpHeaders||null,d=r.withCredentials===!0,c=r.password??null,h=r.range instanceof bv?r.range:null,f=Number.isInteger(r.rangeChunkSize)&&r.rangeChunkSize>0?r.rangeChunkSize:2**16;let m=r.worker instanceof vp?r.worker:null;const b=r.verbosity,A=typeof r.docBaseUrl=="string"&&!c0(r.docBaseUrl)?r.docBaseUrl:null,v=Eg(r.cMapUrl),E=r.cMapPacked!==!1,x=r.CMapReaderFactory||(bl?rT:Lb),k=Eg(r.iccUrl),j=Eg(r.standardFontDataUrl),$=r.StandardFontDataFactory||(bl?aT:Mb),z=Eg(r.wasmUrl),B=r.WasmFactory||(bl?oT:zb),F=r.stopAtErrors!==!0,I=Number.isInteger(r.maxImageSize)&&r.maxImageSize>-1?r.maxImageSize:-1,X=r.isEvalSupported!==!1,M=typeof r.isOffscreenCanvasSupported=="boolean"?r.isOffscreenCanvasSupported:!bl,G=typeof r.isImageDecoderSupported=="boolean"?r.isImageDecoderSupported:!bl&&(jo.platform.isFirefox||!globalThis.chrome),U=Number.isInteger(r.canvasMaxAreaInBytes)?r.canvasMaxAreaInBytes:-1,_=typeof r.disableFontFace=="boolean"?r.disableFontFace:bl,N=r.fontExtraProperties===!0,te=r.enableXfa===!0,ie=r.ownerDocument||globalThis.document,re=r.disableRange===!0,q=r.disableStream===!0,J=r.disableAutoFetch===!0,ce=r.pdfBug===!0,_e=r.CanvasFactory||(bl?sT:tT),xe=r.FilterFactory||(bl?iT:nT),Z=r.enableHWA===!0,D=r.useWasm!==!1,H=h?h.length:r.length??NaN,Y=typeof r.useSystemFonts=="boolean"?r.useSystemFonts:!bl&&!_,ue=typeof r.useWorkerFetch=="boolean"?r.useWorkerFetch:!!(x===Lb&&$===Mb&&B===zb&&v&&j&&z&&cp(v,document.baseURI)&&cp(j,document.baseURI)&&cp(z,document.baseURI)),Ne=null;T3(b);const Pe={canvasFactory:new _e({ownerDocument:ie,enableHWA:Z}),filterFactory:new xe({docId:t,ownerDocument:ie}),cMapReaderFactory:ue?null:new x({baseUrl:v,isCompressed:E}),standardFontDataFactory:ue?null:new $({baseUrl:j}),wasmFactory:ue?null:new B({baseUrl:z})};m||(m=vp.create({verbosity:b,port:xf.workerPort}),e._worker=m);const Ue={docId:t,apiVersion:"5.4.449",data:s,password:c,disableAutoFetch:J,rangeChunkSize:f,length:H,docBaseUrl:A,enableXfa:te,evaluatorOptions:{maxImageSize:I,disableFontFace:_,ignoreErrors:F,isEvalSupported:X,isOffscreenCanvasSupported:M,isImageDecoderSupported:G,canvasMaxAreaInBytes:U,fontExtraProperties:N,useSystemFonts:Y,useWasm:D,useWorkerFetch:ue,cMapUrl:v,iccUrl:k,standardFontDataUrl:j,wasmUrl:z}},Re={ownerDocument:ie,pdfBug:ce,styleElement:Ne,loadingParams:{disableAutoFetch:J,enableXfa:te}};return m.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(m.destroyed)throw new Error("Worker was destroyed");const Ke=m.messageHandler.sendWithPromise("GetDocRequest",Ue,s?[s.buffer]:null);let Je;if(h)Je=new CT(h,{disableRange:re,disableStream:q});else if(!s){if(!n)throw new Error("getDocument - no `url` parameter provided.");const st=cp(n)?NT:bl?OT:LT;Je=new st({url:n,length:H,httpHeaders:o,withCredentials:d,rangeChunkSize:f,disableRange:re,disableStream:q})}return Ke.then(st=>{if(e.destroyed)throw new Error("Loading aborted");if(m.destroyed)throw new Error("Worker was destroyed");const yt=new dp(t,st,m.port),Nt=new $T(yt,e,Je,Re,Pe,Z);e._transport=Nt,yt.send("Ready",null)})}).catch(e._capability.reject),e}class Ny{static#e=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${Ny.#e++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class bv{#e=Promise.withResolvers();#t=[];#i=[];#n=[];#a=[];constructor(e,t,n=!1,s=null){this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=s}addRangeListener(e){this.#a.push(e)}addProgressListener(e){this.#n.push(e)}addProgressiveReadListener(e){this.#i.push(e)}addProgressiveDoneListener(e){this.#t.push(e)}onDataRange(e,t){for(const n of this.#a)n(e,t)}onDataProgress(e,t){this.#e.promise.then(()=>{for(const n of this.#n)n(e,t)})}onDataProgressiveRead(e){this.#e.promise.then(()=>{for(const t of this.#i)t(e)})}onDataProgressiveDone(){this.#e.promise.then(()=>{for(const e of this.#t)e()})}transportReady(){this.#e.resolve()}requestDataRange(e,t){Xs("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class VT{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return hi(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(e){return this._transport.extractPages(e)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class WT{#e=!1;constructor(e,t,n,s=!1){this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=s?new kb:null,this._pdfBug=s,this.commonObjs=n.commonObjs,this.objs=new yv,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:s=0,dontFlip:o=!1}={}){return new _p({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:s,dontFlip:o})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return hi(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,canvas:t=e.canvas,viewport:n,intent:s="display",annotationMode:o=Pu.ENABLE,transform:d=null,background:c=null,optionalContentConfigPromise:h=null,annotationCanvasMap:f=null,pageColors:m=null,printAnnotationStorage:b=null,isEditing:A=!1,recordOperations:v=!1,operationsFilter:E=null}){this._stats?.time("Overall");const x=this._transport.getRenderingIntent(s,o,b,A),{renderingIntent:k,cacheKey:j}=x;this.#e=!1,h||=this._transport.getOptionalContentConfig(k);let $=this._intentStates.get(j);$||($=Object.create(null),this._intentStates.set(j,$)),$.streamReaderCancelTimeout&&(clearTimeout($.streamReaderCancelTimeout),$.streamReaderCancelTimeout=null);const z=!!(k&gc.PRINT);$.displayReadyCapability||($.displayReadyCapability=Promise.withResolvers(),$.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(x));const B=!!(this._pdfBug&&globalThis.StepperManager?.enabled),F=!this.recordedBBoxes&&(v||B),I=G=>{if($.renderTasks.delete(X),F){const U=X.gfx?.dependencyTracker.take();U&&(X.stepper&&X.stepper.setOperatorBBoxes(U,X.gfx.dependencyTracker.takeDebugMetadata()),v&&(this.recordedBBoxes=U))}z&&(this.#e=!0),this.#t(),G?(X.capability.reject(G),this._abortOperatorList({intentState:$,reason:G instanceof Error?G:new Error(G)})):X.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},X=new df({callback:I,params:{canvas:t,canvasContext:e,dependencyTracker:F?new cT(t,$.operatorList.length,B):null,viewport:n,transform:d,background:c},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:$.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!z,pdfBug:this._pdfBug,pageColors:m,enableHWA:this._transport.enableHWA,operationsFilter:E});($.renderTasks||=new Set).add(X);const M=X.task;return Promise.all([$.displayReadyCapability.promise,h]).then(([G,U])=>{if(this.destroyed){I();return}if(this._stats?.time("Rendering"),!(U.renderingIntent&k))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");X.initializeGraphics({transparency:G,optionalContentConfig:U}),X.operatorListChanged()}).catch(I),M}getOperatorList({intent:e="display",annotationMode:t=Pu.ENABLE,printAnnotationStorage:n=null,isEditing:s=!1}={}){function o(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(h))}const d=this._transport.getRenderingIntent(e,t,n,s,!0);let c=this._intentStates.get(d.cacheKey);c||(c=Object.create(null),this._intentStates.set(d.cacheKey,c));let h;return c.opListReadCapability||(h=Object.create(null),h.operatorListChanged=o,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||=new Set).add(h),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(d)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>bp.textContent(n));const t=this.streamTextContent(e);return new Promise(function(n,s){function o(){d.read().then(function({value:h,done:f}){if(f){n(c);return}c.lang??=h.lang,Object.assign(c.styles,h.styles),c.items.push(...h.items),o()},s)}const d=t.getReader(),c={items:[],styles:Object.create(null),lang:null};o()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),this.#e=!1,Promise.all(e)}cleanup(e=!1){this.#e=!0;const t=this.#t();return e&&t&&(this._stats&&=new kb),t}#t(){if(!this.#e||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}_startRenderPage(e,t){const n=this._intentStates.get(t);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let n=0,s=e.length;n<s;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&this.#t()}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:s}){const{map:o,transfer:d}=n,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:o,modifiedIds:s},d).getReader(),f=this._intentStates.get(t);f.streamReader=h;const m=()=>{h.read().then(({value:b,done:A})=>{if(A){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(b,f),m())},b=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const A of f.renderTasks)A.operatorListChanged();this.#t()}if(f.displayReadyCapability)f.displayReadyCapability.reject(b);else if(f.opListReadCapability)f.opListReadCapability.reject(b);else throw b}})};m()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof wy){let s=qT;t.extraDelay>0&&t.extraDelay<1e3&&(s+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},s);return}}if(e.streamReader.cancel(new Mu(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[s,o]of this._intentStates)if(o===e){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}var Eu,Zc,Xd,ah,n0,oh,lh,Sl,$g,vv,wv,up,bf,Gg;const Ar=class Ar{constructor({name:e=null,port:t=null,verbosity:n=C3()}={}){yd(this,Sl);yd(this,Eu,Promise.withResolvers());yd(this,Zc,null);yd(this,Xd,null);yd(this,ah,null);if(this.name=e,this.destroyed=!1,this.verbosity=n,t){if(vr(Ar,lh).has(t))throw new Error("Cannot use more than one PDFWorker per port.");vr(Ar,lh).set(t,this),xd(this,Sl,vv).call(this,t)}else xd(this,Sl,wv).call(this)}get promise(){return vr(this,Eu).promise}get port(){return vr(this,Xd)}get messageHandler(){return vr(this,Zc)}destroy(){this.destroyed=!0,vr(this,ah)?.terminate(),Vl(this,ah,null),vr(Ar,lh).delete(vr(this,Xd)),Vl(this,Xd,null),vr(this,Zc)?.destroy(),Vl(this,Zc,null)}static create(e){const t=vr(this,lh).get(e?.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Ar(e)}static get workerSrc(){if(xf.workerSrc)return xf.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return hi(this,"_setupFakeWorkerGlobal",(async()=>vr(this,bf,Gg)?vr(this,bf,Gg):(await import(this.workerSrc)).WorkerMessageHandler)())}};Eu=new WeakMap,Zc=new WeakMap,Xd=new WeakMap,ah=new WeakMap,n0=new WeakMap,oh=new WeakMap,lh=new WeakMap,Sl=new WeakSet,$g=function(){vr(this,Eu).resolve(),vr(this,Zc).send("configure",{verbosity:this.verbosity})},vv=function(e){Vl(this,Xd,e),Vl(this,Zc,new dp("main","worker",e)),vr(this,Zc).on("ready",()=>{}),xd(this,Sl,$g).call(this)},wv=function(){if(vr(Ar,oh)||vr(Ar,bf,Gg)){xd(this,Sl,up).call(this);return}let{workerSrc:e}=Ar;try{Ar._isSameOrigin(window.location,e)||(e=Ar._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new dp("main","worker",t),s=()=>{o.abort(),n.destroy(),t.terminate(),this.destroyed?vr(this,Eu).reject(new Error("Worker was destroyed")):xd(this,Sl,up).call(this)},o=new AbortController;t.addEventListener("error",()=>{vr(this,ah)||s()},{signal:o.signal}),n.on("test",c=>{if(o.abort(),this.destroyed||!c){s();return}Vl(this,Zc,n),Vl(this,Xd,t),Vl(this,ah,t),xd(this,Sl,$g).call(this)}),n.on("ready",c=>{if(o.abort(),this.destroyed){s();return}try{d()}catch{xd(this,Sl,up).call(this)}});const d=()=>{const c=new Uint8Array;n.send("test",c,[c.buffer])};d();return}catch{l0("The worker has been disabled.")}xd(this,Sl,up).call(this)},up=function(){vr(Ar,oh)||(ui("Setting up fake worker."),Vl(Ar,oh,!0)),Ar._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){vr(this,Eu).reject(new Error("Worker was destroyed"));return}const t=new eT;Vl(this,Xd,t);const n=`fake${W1(Ar,n0)._++}`,s=new dp(n+"_worker",n,t);e.setup(s,t),Vl(this,Zc,new dp(n,n+"_worker",t)),xd(this,Sl,$g).call(this)}).catch(e=>{vr(this,Eu).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},bf=new WeakSet,Gg=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},yd(Ar,bf),yd(Ar,n0,0),yd(Ar,oh,!1),yd(Ar,lh,new WeakMap),bl&&(Vl(Ar,oh,!0),xf.workerSrc||="./pdf.worker.mjs"),Ar._isSameOrigin=(e,t)=>{const n=URL.parse(e);if(!n?.origin||n.origin==="null")return!1;const s=new URL(t,n);return n.origin===s.origin},Ar._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},Ar.fromPort=e=>{if(I3("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Ar.create(e)};let vp=Ar;class $T{#e=new Map;#t=new Map;#i=new Map;#n=new Map;#a=null;constructor(e,t,n,s,o,d){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new yv,this.fontLoader=new Y3({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=o.canvasFactory,this.filterFactory=o.filterFactory,this.cMapReaderFactory=o.cMapReaderFactory,this.standardFontDataFactory=o.standardFontDataFactory,this.wasmFactory=o.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=d,this.setupMessageHandler()}#r(e,t=null){const n=this.#e.get(e);if(n)return n;const s=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,s),s}get annotationStorage(){return hi(this,"annotationStorage",new Cy)}getRenderingIntent(e,t=Pu.ENABLE,n=null,s=!1,o=!1){let d=gc.DISPLAY,c=ry;switch(e){case"any":d=gc.ANY;break;case"display":break;case"print":d=gc.PRINT;break;default:ui(`getRenderingIntent - invalid intent: ${e}`)}const h=d&gc.PRINT&&n instanceof rv?n:this.annotationStorage;switch(t){case Pu.DISABLE:d+=gc.ANNOTATIONS_DISABLE;break;case Pu.ENABLE:break;case Pu.ENABLE_FORMS:d+=gc.ANNOTATIONS_FORMS;break;case Pu.ENABLE_STORAGE:d+=gc.ANNOTATIONS_STORAGE,c=h.serializable;break;default:ui(`getRenderingIntent - invalid annotationMode: ${t}`)}s&&(d+=gc.IS_EDITING),o&&(d+=gc.OPLIST);const{ids:f,hash:m}=h.modifiedIds,b=[d,c.hash,m];return{renderingIntent:d,cacheKey:b.join("_"),annotationStorageSerializable:c,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#a?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const n of this.#t.values())e.push(n._destroy());this.#t.clear(),this.#i.clear(),this.#n.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),xl.cleanup(),this._networkStream?.cancelAllRequests(new Mu("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,s)=>{Zi(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=o=>{this._lastProgress={loaded:o.loaded,total:o.total}},s.onPull=()=>{this._fullReader.read().then(function({value:o,done:d}){if(d){s.close();return}Zi(o instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{s.error(o)})},s.onCancel=o=>{this._fullReader.cancel(o),s.ready.catch(d=>{if(!this.destroyed)throw d})}}),e.on("ReaderHeadersReady",async n=>{await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:o,contentLength:d}=this._fullReader;return(!s||!o)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=c=>{t.onProgress?.({loaded:c.loaded,total:c.total})}),{isStreamingSupported:s,isRangeSupported:o,contentLength:d}}),e.on("GetRangeReader",(n,s)=>{Zi(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const o=this._networkStream.getRangeReader(n.begin,n.end);if(!o){s.close();return}s.onPull=()=>{o.read().then(function({value:d,done:c}){if(c){s.close();return}Zi(d instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(d),1,[d])}).catch(d=>{s.error(d)})},s.onCancel=d=>{o.cancel(d),s.ready.catch(c=>{if(!this.destroyed)throw c})}}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new VT(n,this))}),e.on("DocException",n=>{t._capability.reject(Wl(n))}),e.on("PasswordRequest",n=>{this.#a=Promise.withResolvers();try{if(!t.onPassword)throw Wl(n);const s=o=>{o instanceof Error?this.#a.reject(o):this.#a.resolve({password:o})};t.onPassword(s,n.code)}catch(s){this.#a.reject(s)}return this.#a.promise}),e.on("DataLoaded",n=>{t.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;this.#t.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,s,o])=>{if(this.destroyed||this.commonObjs.has(n))return null;switch(s){case"Font":if("error"in o){const b=o.error;ui(`Error during font loading: ${b}`),this.commonObjs.resolve(n,b);break}const d=new Os(o),c=this._params.pdfBug&&globalThis.FontInspector?.enabled?(b,A)=>globalThis.FontInspector.fontAdded(b,A):null,h=new X3(d,c,o.extra,o.charProcOperatorList);this.fontLoader.bind(h).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!h.fontExtraProperties&&h.data&&h.clearData(),this.commonObjs.resolve(n,h)});break;case"CopyLocalImage":const{imageRef:f}=o;Zi(f,"The imageRef must be defined.");for(const b of this.#t.values())for(const[,A]of b.objs)if(A?.ref===f)return A.dataLen?(this.commonObjs.resolve(n,structuredClone(A)),A.dataLen):null;break;case"FontPath":case"Image":this.commonObjs.resolve(n,o);break;case"Pattern":const m=new ao(o);this.commonObjs.resolve(n,m.getIR());break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),e.on("obj",([n,s,o,d])=>{if(this.destroyed)return;const c=this.#t.get(s);if(!c.objs.has(n)){if(c._intentStates.size===0){d?.bitmap?.close();return}switch(o){case"Image":case"Pattern":c.objs.resolve(n,d);break;default:throw new Error(`Got unknown object type ${o}`)}}}),e.on("DocProgress",n=>{this.destroyed||t.onProgress?.({loaded:n.loaded,total:n.total})}),e.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const s=this[n.type];if(!s)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return s.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&ui("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}extractPages(e){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:e})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=this.#i.get(t);if(n)return n;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(o=>{if(this.destroyed)throw new Error("Transport destroyed");o.refStr&&this.#n.set(o.refStr,e);const d=new WT(t,o,this,this._params.pdfBug);return this.#t.set(t,d),d});return this.#i.set(t,s),s}getPageIndex(e){return ay(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#r("GetFieldObjects")}hasJSActions(){return this.#r("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return this.#r("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#r("GetOptionalContentConfig").then(t=>new TT(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#e.get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(s=>({info:s[0],metadata:s[1]?new ST(s[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null,hasStructTree:s[2]}));return this.#e.set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),xl.cleanup()}}cachedPageNumber(e){if(!ay(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#n.get(t)??null}}class GT{#e=null;onContinue=null;onError=null;constructor(e){this.#e=e}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}}class df{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:n,commonObjs:s,annotationCanvasMap:o,operatorList:d,pageIndex:c,canvasFactory:h,filterFactory:f,useRequestAnimationFrame:m=!1,pdfBug:b=!1,pageColors:A=null,enableHWA:v=!1,operationsFilter:E=null}){this.callback=e,this.params=t,this.objs=n,this.commonObjs=s,this.annotationCanvasMap=o,this.operatorListIdx=null,this.operatorList=d,this._pageIndex=c,this.canvasFactory=h,this.filterFactory=f,this._pdfBug=b,this.pageColors=A,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=m===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new GT(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=v,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=E}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(df.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");df.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:s,background:o,dependencyTracker:d}=this.params,c=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new yf(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,d),this.gfx.beginDrawing({transform:s,viewport:n,transparency:e,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),df.#t.delete(this._canvas),e||=new wy(`Rendering cancelled, page ${this._pageIndex+1}`,t),this.callback(e),this.task.onError?.(e)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),df.#t.delete(this._canvas),this.callback())))}}const Sv="5.4.449",YT="f44e5f0e6";class Bc{#e=null;#t=null;#i;#n=null;#a=!1;#r=!1;#s=null;#o;#c=null;#l=null;static#h=null;static get _keyboardManager(){return hi(this,"_keyboardManager",new jp([[["Escape","mac+Escape"],Bc.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Bc.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Bc.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Bc.prototype._moveToPrevious],[["Home","mac+Home"],Bc.prototype._moveToBeginning],[["End","mac+End"],Bc.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#r=!1,this.#s=e):this.#r=!0,this.#l=e?._uiManager||t,this.#o=this.#l._eventBus,this.#i=e?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",Bc.#h||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",this.#s&&(e.ariaControls=`${this.#s.id}_colorpicker_dropdown`);const t=this.#l._signal;e.addEventListener("click",this.#g.bind(this),{signal:t}),e.addEventListener("keydown",this.#m.bind(this),{signal:t});const n=this.#t=document.createElement("span");return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=this.#i,e.append(n),e}renderMainDropdown(){const e=this.#n=this.#u();return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}#u(){const e=document.createElement("div"),t=this.#l._signal;e.addEventListener("contextmenu",Uc,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#s&&(e.id=`${this.#s.id}_colorpicker_dropdown`);for(const[n,s]of this.#l.highlightColors){const o=document.createElement("button");o.tabIndex="0",o.role="option",o.setAttribute("data-color",s),o.title=n,o.setAttribute("data-l10n-id",Bc.#h[n]);const d=document.createElement("span");o.append(d),d.className="swatch",d.style.backgroundColor=s,o.ariaSelected=s===this.#i,o.addEventListener("click",this.#f.bind(this,s),{signal:t}),e.append(o)}return e.addEventListener("keydown",this.#m.bind(this),{signal:t}),e}#f(e,t){t.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:Ki.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#g(e);return}const t=e.target.getAttribute("data-color");t&&this.#f(t,e)}_moveToNext(e){if(!this.#p){this.#g(e);return}if(e.target===this.#e){this.#n.firstElementChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#n?.firstElementChild||e.target===this.#e){this.#p&&this._hideDropdownFromKeyboard();return}this.#p||this.#g(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#p){this.#g(e);return}this.#n.firstElementChild?.focus()}_moveToEnd(e){if(!this.#p){this.#g(e);return}this.#n.lastElementChild?.focus()}#m(e){Bc._keyboardManager.exec(this,e)}#g(e){if(this.#p){this.hideDropdown();return}if(this.#a=e.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#d.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#e.ariaExpanded="true",this.#n){this.#n.classList.remove("hidden");return}const t=this.#n=this.#u();this.#e.append(t)}#d(e){this.#n?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),this.#e.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#p(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#r){if(!this.#p){this.#s?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#a})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#n)return;const t=this.#l.highlightColors.values();for(const n of this.#n.children)n.ariaSelected=t.next().value===e.toUpperCase()}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#n?.remove(),this.#n=null}}class wp{#e=null;#t=null;#i=null;static#n=null;constructor(e){this.#t=e,this.#i=e._uiManager,wp.#n||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#e)return this.#e;const{editorType:e,colorType:t,color:n}=this.#t,s=this.#e=document.createElement("input");return s.type="color",s.value=n||"#000000",s.className="basicColorPicker",s.tabIndex=0,s.setAttribute("data-l10n-id",wp.#n[e]),s.addEventListener("input",()=>{this.#i.updateParams(t,s.value)},{signal:this.#i._signal}),s}update(e){this.#e&&(this.#e.value=e)}destroy(){this.#e?.remove(),this.#e=null}hideDropdown(){}}function Xb(r){return Math.floor(Math.max(0,Math.min(1,r))*255).toString(16).padStart(2,"0")}function ap(r){return Math.max(0,Math.min(255,255*r))}class Kb{static CMYK_G([e,t,n,s]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+s)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=ap(e),[e,e,e]}static G_HTML([e]){const t=Xb(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(ap)}static RGB_HTML(e){return`#${e.map(Xb).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,s]){return["RGB",1-Math.min(1,e+s),1-Math.min(1,n+s),1-Math.min(1,t+s)]}static CMYK_rgb([e,t,n,s]){return[ap(1-Math.min(1,e+s)),ap(1-Math.min(1,n+s)),ap(1-Math.min(1,t+s))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const s=1-e,o=1-t,d=1-n,c=Math.min(s,o,d);return["CMYK",s,o,d,c]}}class XT{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),n||(s.setAttribute("width",`${e}px`),s.setAttribute("height",`${t}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${e} ${t}`),s}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Xs("Abstract method `_createSVG` called.")}}class t0 extends XT{_createSVG(e){return document.createElementNS($d,e)}}const KT=9,fh=new WeakSet,ZT=new Date().getTimezoneOffset()*60*1e3;class Im{static create(e){switch(e.data.annotationType){case ja.LINK:return new Py(e);case ja.TEXT:return new QT(e);case ja.WIDGET:switch(e.data.fieldType){case"Tx":return new eC(e);case"Btn":return e.data.radioButton?new Av(e):e.data.checkBox?new nC(e):new iC(e);case"Ch":return new sC(e);case"Sig":return new tC(e)}return new yh(e);case ja.POPUP:return new cy(e);case ja.FREETEXT:return new Tv(e);case ja.LINE:return new aC(e);case ja.SQUARE:return new oC(e);case ja.CIRCLE:return new lC(e);case ja.POLYLINE:return new Cv(e);case ja.CARET:return new dC(e);case ja.INK:return new Ey(e);case ja.POLYGON:return new cC(e);case ja.HIGHLIGHT:return new _v(e);case ja.UNDERLINE:return new uC(e);case ja.SQUIGGLY:return new hC(e);case ja.STRIKEOUT:return new fC(e);case ja.STAMP:return new kv(e);case ja.FILEATTACHMENT:return new pC(e);default:return new zr(e)}}}class zr{#e=null;#t=!1;#i=null;constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:s=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,this.hasOwnCommentButton=!1,t&&(this.contentElement=this.container=this._createContainer(n)),s&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e?.str||t?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return zr._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:e}=this,t=this.annotationStorage?.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const e=this.annotationStorage?.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:n,rect:s}=this.data;let o=-1/0,d=-1/0;if(t?.length>=8){for(let c=0;c<t.length;c+=8)t[c+1]>d?(d=t[c+1],o=t[c+2]):t[c+1]===d&&(o=Math.max(o,t[c+2]));return[o,d]}if(n?.length>=1){for(const c of n)for(let h=0,f=c.length;h<f;h+=2)c[h+1]>d?(d=c[h+1],o=c[h]):c[h+1]===d&&(o=Math.max(o,c[h]));if(o!==1/0)return[o,d]}return s?[s[2],s[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:n,pageHeight:s,pageX:o,pageY:d}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-o)/n,e[1]=100*(e[1]-d)/s,e}get commentText(){const{data:e}=this;return this.annotationStorage.getRawValue(`${yp}${e.id}`)?.popup?.contents||e.contentsObj?.str||""}set commentText(e){const{data:t}=this,n={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:n})||this.annotationStorage.setValue(`${yp}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:n,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){(this.#i?.popup||this.popup)?.remove(),this.#i=this.popup=null}updateEdited(e){if(!this.container)return;e.rect&&(this.#e||={rect:this.data.rect.slice(0)});const{rect:t,popup:n}=e;t&&this.#n(t);let s=this.#i?.popup||this.popup;!s&&n?.text&&(this._createPopup(n),s=this.#i.popup),s&&(s.updateEdited(e),n?.deleted&&(s.remove(),this.#i=null,this.popup=null))}resetEdited(){this.#e&&(this.#n(this.#e.rect),this.#i?.popup.resetEdited(),this.#e=null)}#n(e){const{container:{style:t},data:{rect:n,rotation:s},parent:{viewport:{rawDims:{pageWidth:o,pageHeight:d,pageX:c,pageY:h}}}}=this;n?.splice(0,4,...e),t.left=`${100*(e[0]-c)/o}%`,t.top=`${100*(d-e[3]+h)/d}%`,s===0?(t.width=`${100*(e[2]-e[0])/o}%`,t.height=`${100*(e[3]-e[1])/d}%`):this.setRotation(s)}_createContainer(e){const{data:t,parent:{page:n,viewport:s}}=this,o=document.createElement("section");o.setAttribute("data-annotation-id",t.id),!(this instanceof yh)&&!(this instanceof Py)&&(o.tabIndex=0);const{style:d}=o;if(d.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(o.title=t.alternativeText),t.noRotate&&o.classList.add("norotate"),!t.rect||this instanceof cy){const{rotation:x}=t;return!t.hasOwnCanvas&&x!==0&&this.setRotation(x,o),o}const{width:c,height:h}=this;if(!e&&t.borderStyle.width>0){d.borderWidth=`${t.borderStyle.width}px`;const x=t.borderStyle.horizontalCornerRadius,k=t.borderStyle.verticalCornerRadius;if(x>0||k>0){const $=`calc(${x}px * var(--total-scale-factor)) / calc(${k}px * var(--total-scale-factor))`;d.borderRadius=$}else if(this instanceof Av){const $=`calc(${c}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;d.borderRadius=$}switch(t.borderStyle.style){case sf.SOLID:d.borderStyle="solid";break;case sf.DASHED:d.borderStyle="dashed";break;case sf.BEVELED:ui("Unimplemented border style: beveled");break;case sf.INSET:ui("Unimplemented border style: inset");break;case sf.UNDERLINE:d.borderBottomStyle="solid";break}const j=t.borderColor||null;j?(this.#t=!0,d.borderColor=un.makeHexColor(j[0]|0,j[1]|0,j[2]|0)):d.borderWidth=0}const f=un.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:m,pageHeight:b,pageX:A,pageY:v}=s.rawDims;d.left=`${100*(f[0]-A)/m}%`,d.top=`${100*(f[1]-v)/b}%`;const{rotation:E}=t;return t.hasOwnCanvas||E===0?(d.width=`${100*c/m}%`,d.height=`${100*h/b}%`):this.setRotation(E,o),o}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:s}=this.parent.viewport.rawDims;let{width:o,height:d}=this;e%180!==0&&([o,d]=[d,o]),t.style.width=`${100*o/n}%`,t.style.height=`${100*d/s}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,n,s)=>{const o=s.detail[t],d=o[0],c=o.slice(1);s.target.style[n]=Kb[`${d}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[n]:Kb[`${d}_rgb`](c)})};return hi(this,"_commonActions",{display:t=>{const{display:n}=t.detail,s=n%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const s of Object.keys(t.detail))(e[s]||n[s])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[s,o]of Object.entries(t)){const d=n[s];if(d){const c={detail:{[s]:o},target:e};d(c),delete t[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,s,o]=this.data.rect.map(x=>Math.fround(x));if(e.length===8){const[x,k,j,$]=e.subarray(2,6);if(s===x&&o===k&&t===j&&n===$)return}const{style:d}=this.container;let c;if(this.#t){const{borderColor:x,borderWidth:k}=d;d.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${x}" stroke-width="${k}">`],this.container.classList.add("hasBorder")}const h=s-t,f=o-n,{svgFactory:m}=this,b=m.createElement("svg");b.classList.add("quadrilateralsContainer"),b.setAttribute("width",0),b.setAttribute("height",0),b.role="none";const A=m.createElement("defs");b.append(A);const v=m.createElement("clipPath"),E=`clippath_${this.data.id}`;v.setAttribute("id",E),v.setAttribute("clipPathUnits","objectBoundingBox"),A.append(v);for(let x=2,k=e.length;x<k;x+=8){const j=e[x],$=e[x+1],z=e[x+2],B=e[x+3],F=m.createElement("rect"),I=(z-t)/h,X=(o-$)/f,M=(j-z)/h,G=($-B)/f;F.setAttribute("x",I),F.setAttribute("y",X),F.setAttribute("width",M),F.setAttribute("height",G),v.append(F),c?.push(`<rect vector-effect="non-scaling-stroke" x="${I}" y="${X}" width="${M}" height="${G}"/>`)}this.#t&&(c.push("</g></svg>')"),d.backgroundImage=c.join("")),this.container.append(b),this.container.style.clipPath=`url(#${E})`}_createPopup(e=null){const{data:t}=this;let n,s;e?(n={str:e.text},s=e.date):(n=t.contentsObj,s=t.modificationDate),this.#i=new cy({data:{color:t.color,titleObj:t.titleObj,modificationDate:s,contentsObj:n,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#i||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#i}render(){Xs("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const s=this._fieldObjects[e];if(s)for(const{page:o,id:d,exportValues:c}of s){if(o===-1||d===t)continue;const h=typeof c=="string"?c:null,f=document.querySelector(`[data-element-id="${d}"]`);if(f&&!fh.has(f)){ui(`_getElementsByName - element not allowed: ${d}`);continue}n.push({id:d,exportValue:h,domElement:f})}return n}for(const s of document.getElementsByName(e)){const{exportValue:o}=s,d=s.getAttribute("data-element-id");d!==t&&fh.has(s)&&n.push({id:d,exportValue:o,domElement:s})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class JT extends zr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&this._createPopup(e.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class Py extends zr{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let s=!1;return e.url?(t.addLinkAttributes(n,e.url,e.newWindow),s=!0):e.action?(this._bindNamedAction(n,e.action,e.overlaidText),s=!0):e.attachment?(this.#t(n,e.attachment,e.overlaidText,e.attachmentDest),s=!0):e.setOCGState?(this.#i(n,e.setOCGState,e.overlaidText),s=!0):e.dest?(this._bindLink(n,e.dest,e.overlaidText),s=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),s=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(n,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&(this.contentElement=n,this.container.append(n)),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t,n=""){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e(),n&&(e.title=n)}_bindNamedAction(e,t,n=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),n&&(e.title=n),this.#e()}#t(e,t,n="",s=null){e.href=this.linkService.getAnchorUrl(""),t.description?e.title=t.description:n&&(e.title=n),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,s),!1),this.#e()}#i(e,t,n=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),n&&(e.title=n),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(t.actions)){const o=n.get(s);o&&(e[o]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:s}}),!1))}t.overlaidText&&(e.title=t.overlaidText),e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){const n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){ui('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(e.onclick=()=>!1);return}e.onclick=()=>{n?.();const{fields:s,refs:o,include:d}=t,c=[];if(s.length!==0||o.length!==0){const m=new Set(o);for(const b of s){const A=this._fieldObjects[b]||[];for(const{id:v}of A)m.add(v)}for(const b of Object.values(this._fieldObjects))for(const A of b)m.has(A.id)===d&&c.push(A)}else for(const m of Object.values(this._fieldObjects))c.push(...m);const h=this.annotationStorage,f=[];for(const m of c){const{id:b}=m;switch(f.push(b),m.type){case"text":{const v=m.defaultValue||"";h.setValue(b,{value:v});break}case"checkbox":case"radiobutton":{const v=m.defaultValue===m.exportValues;h.setValue(b,{value:v});break}case"combobox":case"listbox":{const v=m.defaultValue||"";h.setValue(b,{value:v});break}default:continue}const A=document.querySelector(`[data-element-id="${b}"]`);if(A){if(!fh.has(A)){ui(`_bindResetFormAction - element not allowed: ${b}`);continue}}else continue;A.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class QT extends zr{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(e),this.container}}class yh extends zr{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return jo.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,s,o){n.includes("mouse")?e.addEventListener(n,d=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:o(d),shift:d.shiftKey,modifier:this._getKeyModifier(d)}})}):e.addEventListener(n,d=>{if(n==="blur"){if(!t.focused||!d.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}o&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:o(d)}})})}_setEventListeners(e,t,n,s){for(const[o,d]of n)(d==="Action"||this.data.actions?.[d])&&((d==="Focus"||d==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,o,d,s),d==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):d==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":un.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||KT,o=e.style;let d;const c=2,h=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-c),m=Math.round(f/(Nm*s))||1,b=f/m;d=Math.min(s,h(b/Nm))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-c);d=Math.min(s,h(f/Nm))}o.fontSize=`calc(${d}px * var(--total-scale-factor))`,o.color=un.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(o.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class eC extends yh{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,s){const o=this.annotationStorage;for(const d of this._getElementsByName(e.name,e.id))d.domElement&&(d.domElement[t]=n),o.setValue(d.id,{[s]:n})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const s=e.getValue(t,{value:this.data.fieldValue});let o=s.value||"";const d=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;d&&o.length>d&&(o=o.slice(0,d));let c=s.formattedValue||this.data.textContent?.join(`
`)||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=c??o,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",c??o),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),fh.add(n),this.contentElement=n,n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:f,datetimeType:m,timeStep:b}=this.data,A=!!m&&this.enableScripting;f&&(n.title=f),this._setRequired(n,this.data.required),d&&(n.maxLength=d),n.addEventListener("input",E=>{e.setValue(t,{value:E.target.value}),this.setPropertyOnSiblings(n,"value",E.target.value,"value"),h.formattedValue=null}),n.addEventListener("resetform",E=>{const x=this.data.defaultFieldValue??"";n.value=h.userValue=x,h.formattedValue=null});let v=E=>{const{formattedValue:x}=h;x!=null&&(E.target.value=x),E.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",x=>{if(h.focused)return;const{target:k}=x;if(A&&(k.type=m,b&&(k.step=b)),h.userValue){const j=h.userValue;if(A)if(m==="time"){const $=new Date(j),z=[$.getHours(),$.getMinutes(),$.getSeconds()];k.value=z.map(B=>B.toString().padStart(2,"0")).join(":")}else k.value=new Date(j-ZT).toISOString().split(m==="date"?"T":".",1)[0];else k.value=j}h.lastCommittedValue=k.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),n.addEventListener("updatefromsandbox",x=>{this.showElementAndHideCanvas(x.target);const k={value(j){h.userValue=j.detail.value??"",A||e.setValue(t,{value:h.userValue.toString()}),j.target.value=h.userValue},formattedValue(j){const{formattedValue:$}=j.detail;h.formattedValue=$,$!=null&&j.target!==document.activeElement&&(j.target.value=$);const z={formattedValue:$};A&&(z.value=$),e.setValue(t,z)},selRange(j){j.target.setSelectionRange(...j.detail.selRange)},charLimit:j=>{const{charLimit:$}=j.detail,{target:z}=j;if($===0){z.removeAttribute("maxLength");return}z.setAttribute("maxLength",$);let B=h.userValue;!B||B.length<=$||(B=B.slice(0,$),z.value=h.userValue=B,e.setValue(t,{value:B}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:B,willCommit:!0,commitKey:1,selStart:z.selectionStart,selEnd:z.selectionEnd}}))}};this._dispatchEventFromSandbox(k,x)}),n.addEventListener("keydown",x=>{h.commitKey=1;let k=-1;if(x.key==="Escape"?k=0:x.key==="Enter"&&!this.data.multiLine?k=2:x.key==="Tab"&&(h.commitKey=3),k===-1)return;const{value:j}=x.target;h.lastCommittedValue!==j&&(h.lastCommittedValue=j,h.userValue=j,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:j,willCommit:!0,commitKey:k,selStart:x.target.selectionStart,selEnd:x.target.selectionEnd}}))});const E=v;v=null,n.addEventListener("blur",x=>{if(!h.focused||!x.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{target:k}=x;let{value:j}=k;if(A){if(j&&m==="time"){const $=j.split(":").map(z=>parseInt(z,10));j=new Date(2e3,0,1,$[0],$[1],$[2]||0).valueOf(),k.step=""}else j.includes("T")||(j=`${j}T00:00`),j=new Date(j).valueOf();k.type="text"}h.userValue=j,h.lastCommittedValue!==j&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:j,willCommit:!0,commitKey:h.commitKey,selStart:x.target.selectionStart,selEnd:x.target.selectionEnd}}),E(x)}),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",x=>{h.lastCommittedValue=null;const{data:k,target:j}=x,{value:$,selectionStart:z,selectionEnd:B}=j;let F=z,I=B;switch(x.inputType){case"deleteWordBackward":{const X=$.substring(0,z).match(/\w*[^\w]*$/);X&&(F-=X[0].length);break}case"deleteWordForward":{const X=$.substring(z).match(/^[^\w]*\w*/);X&&(I+=X[0].length);break}case"deleteContentBackward":z===B&&(F-=1);break;case"deleteContentForward":z===B&&(I+=1);break}x.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:$,change:k||"",willCommit:!1,selStart:F,selEnd:I}})}),this._setEventListeners(n,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],x=>x.target.value)}if(v&&n.addEventListener("blur",v),this.data.comb){const x=(this.data.rect[2]-this.data.rect[0])/d;n.classList.add("comb"),n.style.letterSpacing=`calc(${x}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class tC extends yh{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class nC extends yh{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let s=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",e.setValue(n,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const o=document.createElement("input");return fh.add(o),o.setAttribute("data-element-id",n),o.disabled=t.readOnly,this._setRequired(o,this.data.required),o.type="checkbox",o.name=t.fieldName,s&&o.setAttribute("checked",!0),o.setAttribute("exportValue",t.exportValue),o.tabIndex=0,o.addEventListener("change",d=>{const{name:c,checked:h}=d.target;for(const f of this._getElementsByName(c,n)){const m=h&&f.exportValue===t.exportValue;f.domElement&&(f.domElement.checked=m),e.setValue(f.id,{value:m})}e.setValue(n,{value:h})}),o.addEventListener("resetform",d=>{const c=t.defaultFieldValue||"Off";d.target.checked=c===t.exportValue}),this.enableScripting&&this.hasJSActions&&(o.addEventListener("updatefromsandbox",d=>{const c={value(h){h.target.checked=h.detail.value!=="Off",e.setValue(n,{value:h.target.checked})}};this._dispatchEventFromSandbox(c,d)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],d=>d.target.checked)),this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class Av extends yh{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let s=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof s=="string"&&(s=s!==t.buttonValue,e.setValue(n,{value:s})),s)for(const d of this._getElementsByName(t.fieldName,n))e.setValue(d.id,{value:!1});const o=document.createElement("input");if(fh.add(o),o.setAttribute("data-element-id",n),o.disabled=t.readOnly,this._setRequired(o,this.data.required),o.type="radio",o.name=t.fieldName,s&&o.setAttribute("checked",!0),o.tabIndex=0,o.addEventListener("change",d=>{const{name:c,checked:h}=d.target;for(const f of this._getElementsByName(c,n))e.setValue(f.id,{value:!1});e.setValue(n,{value:h})}),o.addEventListener("resetform",d=>{const c=t.defaultFieldValue;d.target.checked=c!=null&&c===t.buttonValue}),this.enableScripting&&this.hasJSActions){const d=t.buttonValue;o.addEventListener("updatefromsandbox",c=>{const h={value:f=>{const m=d===f.detail.value;for(const b of this._getElementsByName(f.target.name)){const A=m&&b.id===n;b.domElement&&(b.domElement.checked=A),e.setValue(b.id,{value:A})}}};this._dispatchEventFromSandbox(h,c)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class iC extends Py{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}}class sC extends yh{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),s=document.createElement("select");fh.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=0;let o=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",m=>{const b=this.data.defaultFieldValue;for(const A of s.options)A.selected=A.value===b});for(const m of this.data.options){const b=document.createElement("option");b.textContent=m.displayValue,b.value=m.exportValue,n.value.includes(m.exportValue)&&(b.setAttribute("selected",!0),o=!1),s.append(b)}let d=null;if(o){const m=document.createElement("option");m.value=" ",m.setAttribute("hidden",!0),m.setAttribute("selected",!0),s.prepend(m),d=()=>{m.remove(),s.removeEventListener("input",d),d=null},s.addEventListener("input",d)}const c=m=>{const b=m?"value":"textContent",{options:A,multiple:v}=s;return v?Array.prototype.filter.call(A,E=>E.selected).map(E=>E[b]):A.selectedIndex===-1?null:A[A.selectedIndex][b]};let h=c(!1);const f=m=>{const b=m.target.options;return Array.prototype.map.call(b,A=>({displayValue:A.textContent,exportValue:A.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",m=>{const b={value(A){d?.();const v=A.detail.value,E=new Set(Array.isArray(v)?v:[v]);for(const x of s.options)x.selected=E.has(x.value);e.setValue(t,{value:c(!0)}),h=c(!1)},multipleSelection(A){s.multiple=!0},remove(A){const v=s.options,E=A.detail.remove;v[E].selected=!1,s.remove(E),v.length>0&&Array.prototype.findIndex.call(v,k=>k.selected)===-1&&(v[0].selected=!0),e.setValue(t,{value:c(!0),items:f(A)}),h=c(!1)},clear(A){for(;s.length!==0;)s.remove(0);e.setValue(t,{value:null,items:[]}),h=c(!1)},insert(A){const{index:v,displayValue:E,exportValue:x}=A.detail.insert,k=s.children[v],j=document.createElement("option");j.textContent=E,j.value=x,k?k.before(j):s.append(j),e.setValue(t,{value:c(!0),items:f(A)}),h=c(!1)},items(A){const{items:v}=A.detail;for(;s.length!==0;)s.remove(0);for(const E of v){const{displayValue:x,exportValue:k}=E,j=document.createElement("option");j.textContent=x,j.value=k,s.append(j)}s.options.length>0&&(s.options[0].selected=!0),e.setValue(t,{value:c(!0),items:f(A)}),h=c(!1)},indices(A){const v=new Set(A.detail.indices);for(const E of A.target.options)E.selected=v.has(E.index);e.setValue(t,{value:c(!0)}),h=c(!1)},editable(A){A.target.disabled=!A.detail.editable}};this._dispatchEventFromSandbox(b,m)}),s.addEventListener("input",m=>{const b=c(!0),A=c(!1);e.setValue(t,{value:b}),m.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:h,change:A,changeEx:b,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],m=>m.target.value)):s.addEventListener("input",function(m){e.setValue(t,{value:c(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class cy extends zr{constructor(e){const{data:t,elements:n,parent:s}=e,o=!!s._commentManager;if(super(e,{isRenderable:!o&&zr._hasPopupData(t)}),this.elements=n,o&&zr._hasPopupData(t)){const d=this.popup=this.#e();for(const c of n)c.popup=d}else this.popup=null}#e(){return new rC({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=this.#e(),n=[];for(const s of this.elements)s.popup=t,s.container.ariaHasPopup="dialog",n.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(s=>`${lf}${s}`).join(",")),this.container}}class rC{#e=null;#t=this.#V.bind(this);#i=this.#O.bind(this);#n=this.#D.bind(this);#a=this.#S.bind(this);#r=null;#s=null;#o=null;#c=null;#l=null;#h=null;#u=null;#f=!1;#m=null;#g=null;#d=null;#p=null;#y=null;#b=null;#x=null;#C=null;#A=null;#w=null;#k=!1;#v=null;#T=null;constructor({container:e,color:t,elements:n,titleObj:s,modificationDate:o,contentsObj:d,richText:c,parent:h,rect:f,parentRect:m,open:b,commentManager:A=null}){this.#s=e,this.#A=s,this.#o=d,this.#C=c,this.#h=h,this.#r=t,this.#x=f,this.#u=m,this.#l=n,this.#e=A,this.#v=n[0],this.#c=ny.toDateObject(o),this.trigger=n.flatMap(v=>v.getElementsToTriggerPopup()),A||(this.#P(),this.#s.hidden=!0,b&&this.#S())}#P(){if(this.#g)return;this.#g=new AbortController;const{signal:e}=this.#g;for(const t of this.trigger)t.addEventListener("click",this.#a,{signal:e}),t.addEventListener("pointerenter",this.#n,{signal:e}),t.addEventListener("pointerleave",this.#i,{signal:e}),t.classList.add("popupTriggerArea");for(const t of this.#l)t.container?.addEventListener("keydown",this.#t,{signal:e})}#j(){const e=this.#l.find(t=>t.hasCommentButton);e&&(this.#y=e._normalizePoint(e.commentButtonPosition))}renderCommentButton(){if(this.#p){this.#p.parentNode||this.#v.container.after(this.#p);return}if(this.#y||this.#j(),!this.#y)return;const{signal:e}=this.#g=new AbortController,t=this.#v.hasOwnCommentButton,n=()=>{this.#e.toggleCommentPopup(this,!0,void 0,!t)},s=()=>{this.#e.toggleCommentPopup(this,!1,!0,!t)},o=()=>{this.#e.toggleCommentPopup(this,!1,!1)};if(t){this.#p=this.#v.container;for(const d of this.trigger)d.ariaHasPopup="dialog",d.ariaControls="commentPopup",d.addEventListener("keydown",this.#t,{signal:e}),d.addEventListener("click",n,{signal:e}),d.addEventListener("pointerenter",s,{signal:e}),d.addEventListener("pointerleave",o,{signal:e}),d.classList.add("popupTriggerArea")}else{const d=this.#p=document.createElement("button");d.className="annotationCommentButton";const c=this.#v.container;d.style.zIndex=c.style.zIndex+1,d.tabIndex=0,d.ariaHasPopup="dialog",d.ariaControls="commentPopup",d.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#I(),this.#N(),d.addEventListener("keydown",this.#t,{signal:e}),d.addEventListener("click",n,{signal:e}),d.addEventListener("pointerenter",s,{signal:e}),d.addEventListener("pointerleave",o,{signal:e}),c.after(d)}}#N(){if(this.#v.extraPopupElement&&!this.#v.editor)return;this.#p||this.renderCommentButton();const[e,t]=this.#y,{style:n}=this.#p;n.left=`calc(${e}%)`,n.top=`calc(${t}% - var(--comment-button-dim))`}#I(){this.#v.extraPopupElement||(this.#p||this.renderCommentButton(),this.#p.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:e,opacity:t}=this.#v.commentData;return e?this.#h._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{this.#p?.focus()},0)}getData(){const{richText:e,color:t,opacity:n,creationDate:s,modificationDate:o}=this.#v.commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:n,creationDate:s,modificationDate:o}}get elementBeforePopup(){return this.#p}get comment(){return this.#T||=this.#v.commentText,this.#T}set comment(e){e!==this.comment&&(this.#v.commentText=this.#T=e)}focus(){this.#v.container?.focus()}get parentBoundingClientRect(){return this.#v.layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){this.#p&&(this.#p.classList.toggle("selected",e),this.#p.ariaExpanded=t)}setSelectedCommentButton(e){this.#p.classList.toggle("selected",e)}get commentPopupPosition(){if(this.#b)return this.#b;const{x:e,y:t,height:n}=this.#p.getBoundingClientRect(),{x:s,y:o,width:d,height:c}=this.#v.layer.getBoundingClientRect();return[(e-s)/d,(t+n-o)/c]}set commentPopupPosition(e){this.#b=e}hasDefaultPopupPosition(){return this.#b===null}get commentButtonPosition(){return this.#y}get commentButtonWidth(){return this.#p.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,n]=this.#b||this.commentButtonPosition.map(f=>f/100),s=this.parentBoundingClientRect,{x:o,y:d,width:c,height:h}=s;this.#e.showDialog(null,this,o+t*c,d+n*h,{...e,parentDimensions:s})}render(){if(this.#m)return;const e=this.#m=document.createElement("div");if(e.className="popup",this.#r){const n=e.style.outlineColor=un.makeHexColor(...this.#r);e.style.backgroundColor=`color-mix(in srgb, ${n} 30%, white)`}const t=document.createElement("span");if(t.className="header",this.#A?.str){const n=document.createElement("span");n.className="title",t.append(n),{dir:n.dir,str:n.textContent}=this.#A}if(e.append(t),this.#c){const n=document.createElement("time");n.className="popupDate",n.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),n.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),n.dateTime=this.#c.toISOString(),t.append(n)}tv({html:this.#R||this.#o.str,dir:this.#o?.dir,className:"popupContent"},e),this.#s.append(e)}get#R(){const e=this.#C,t=this.#o;return e?.str&&(!t?.str||t.str===e.str)&&this.#C.html||null}get#L(){return this.#R?.attributes?.style?.fontSize||0}get#B(){return this.#R?.attributes?.style?.color||null}#M(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},s={style:{color:this.#B,fontSize:this.#L?`calc(${this.#L}px * var(--total-scale-factor))`:""}};for(const o of e.split(`
`))t.push({name:"span",value:o,attributes:s});return n}#V(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#f)&&this.#S()}updateEdited({rect:e,popup:t,deleted:n}){if(this.#e){n?(this.remove(),this.#T=null):t&&(t.deleted?this.remove():(this.#I(),this.#T=t.text)),e&&(this.#y=null,this.#j(),this.#N());return}if(n||t?.deleted){this.remove();return}this.#P(),this.#w||={contentsObj:this.#o,richText:this.#C},e&&(this.#d=null),t&&t.text&&(this.#C=this.#M(t.text),this.#c=ny.toDateObject(t.date),this.#o=null),this.#m?.remove(),this.#m=null}resetEdited(){this.#w&&({contentsObj:this.#o,richText:this.#C}=this.#w,this.#w=null,this.#m?.remove(),this.#m=null,this.#d=null)}remove(){if(this.#g?.abort(),this.#g=null,this.#m?.remove(),this.#m=null,this.#k=!1,this.#f=!1,this.#p?.remove(),this.#p=null,this.trigger)for(const e of this.trigger)e.classList.remove("popupTriggerArea")}#_(){if(this.#d!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:s,pageY:o}}}=this.#h;let d=!!this.#u,c=d?this.#u:this.#x;for(const E of this.#l)if(!c||un.intersect(E.data.rect,c)!==null){c=E.data.rect,d=!0;break}const h=un.normalizeRect([c[0],e[3]-c[1]+e[1],c[2],e[3]-c[3]+e[1]]),m=d?c[2]-c[0]+5:0,b=h[0]+m,A=h[1];this.#d=[100*(b-s)/t,100*(A-o)/n];const{style:v}=this.#s;v.left=`${this.#d[0]}%`,v.top=`${this.#d[1]}%`}#S(){if(this.#e){this.#e.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#D(),this.#s.addEventListener("click",this.#a),this.#s.addEventListener("keydown",this.#t)):(this.#O(),this.#s.removeEventListener("click",this.#a),this.#s.removeEventListener("keydown",this.#t))}#D(){this.#m||this.render(),this.isVisible?this.#f&&this.#s.classList.add("focused"):(this.#_(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#O(){this.#s.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#k=this.isVisible,this.#k&&(this.#s.hidden=!0)}maybeShow(){this.#e||(this.#P(),this.#k&&(this.#m||this.#D(),this.#k=!1,this.#s.hidden=!1))}get isVisible(){return this.#e?!1:this.#s.hidden===!1}}class Tv extends zr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=mi.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=this.contentElement=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class aC extends zr{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:e,width:t,height:n}=this,s=this.svgFactory.create(t,n,!0),o=this.#e=this.svgFactory.createElement("svg:line");return o.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),o.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),o.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),o.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),o.setAttribute("stroke-width",e.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class oC extends zr{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:e,width:t,height:n}=this,s=this.svgFactory.create(t,n,!0),o=e.borderStyle.width,d=this.#e=this.svgFactory.createElement("svg:rect");return d.setAttribute("x",o/2),d.setAttribute("y",o/2),d.setAttribute("width",t-o),d.setAttribute("height",n-o),d.setAttribute("stroke-width",o||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),s.append(d),this.container.append(s),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class lC extends zr{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:e,width:t,height:n}=this,s=this.svgFactory.create(t,n,!0),o=e.borderStyle.width,d=this.#e=this.svgFactory.createElement("svg:ellipse");return d.setAttribute("cx",t/2),d.setAttribute("cy",n/2),d.setAttribute("rx",t/2-o/2),d.setAttribute("ry",n/2-o/2),d.setAttribute("stroke-width",o||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),s.append(d),this.container.append(s),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Cv extends zr{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:n,popupRef:s},width:o,height:d}=this;if(!t)return this.container;const c=this.svgFactory.create(o,d,!0);let h=[];for(let m=0,b=t.length;m<b;m+=2){const A=t[m]-e[0],v=e[3]-t[m+1];h.push(`${A},${v}`)}h=h.join(" ");const f=this.#e=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",h),f.setAttribute("stroke-width",n.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),c.append(f),this.container.append(c),!s&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class cC extends Cv{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class dC extends zr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class Ey extends zr{#e=null;#t=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?mi.HIGHLIGHT:mi.INK}#i(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:n,borderStyle:s,popupRef:o}}=this,{transform:d,width:c,height:h}=this.#i(t,e),f=this.svgFactory.create(c,h,!0),m=this.#e=this.svgFactory.createElement("svg:g");f.append(m),m.setAttribute("stroke-width",s.width||1),m.setAttribute("stroke-linecap","round"),m.setAttribute("stroke-linejoin","round"),m.setAttribute("stroke-miterlimit",10),m.setAttribute("stroke","transparent"),m.setAttribute("fill","transparent"),m.setAttribute("transform",d);for(let b=0,A=n.length;b<A;b++){const v=this.svgFactory.createElement(this.svgElementName);this.#t.push(v),v.setAttribute("points",n[b].join(",")),m.append(v)}return!o&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:n,rect:s}=e,o=this.#e;if(t>=0&&o.setAttribute("stroke-width",t||1),n)for(let d=0,c=this.#t.length;d<c;d++)this.#t[d].setAttribute("points",n[d].join(","));if(s){const{transform:d,width:c,height:h}=this.#i(this.data.rotation,s);o.parentElement.setAttribute("viewBox",`0 0 ${c} ${h}`),o.setAttribute("transform",d)}}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class _v extends zr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=mi.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class uC extends zr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class hC extends zr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class fC extends zr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),e){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class kv extends zr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=mi.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class pC extends zr{#e=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let n;t.hasAppearance||t.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),n.addEventListener("dblclick",this.#t.bind(this)),this.#e=n;const{isMac:s}=jo.platform;return e.addEventListener("keydown",o=>{o.key==="Enter"&&(s?o.metaKey:o.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class Ry{#e=null;#t=null;#i=null;#n=new Map;#a=null;#r=null;#s=[];#o=!1;constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:s,page:o,viewport:d,structTreeLayer:c,commentManager:h,linkService:f,annotationStorage:m}){this.div=e,this.#e=t,this.#t=n,this.#a=c||null,this.#r=f||null,this.#i=m||new Cy,this.page=o,this.viewport=d,this.zIndex=0,this._annotationEditorUIManager=s,this._commentManager=h||null}hasEditableAnnotations(){return this.#n.size>0}async render(e){const{annotations:t}=e,n=this.div;hh(n,this.viewport);const s=new Map,o=[],d={data:null,layer:n,linkService:this.#r,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new t0,annotationStorage:this.#i,enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const c of t){if(c.noHTML)continue;const h=c.annotationType===ja.POPUP;if(h){const b=s.get(c.id);if(!b)continue;if(!this._commentManager){o.push(c);continue}d.elements=b}else if(c.rect[2]===c.rect[0]||c.rect[3]===c.rect[1])continue;d.data=c;const f=Im.create(d);if(!f.isRenderable)continue;if(!h&&(this.#s.push(f),c.popupRef)){const b=s.get(c.popupRef);b?b.push(f):s.set(c.popupRef,[f])}const m=f.render();c.hidden&&(m.style.visibility="hidden"),f._isEditable&&(this.#n.set(f.data.id,f),this._annotationEditorUIManager?.renderAnnotationElement(f))}await this.#c();for(const c of o){const h=d.elements=s.get(c.id);d.data=c;const f=Im.create(d);if(!f.isRenderable)continue;const m=f.render();f.contentElement.id=`${lf}${c.id}`,c.hidden&&(m.style.visibility="hidden"),h.at(-1).container.after(m)}this.#l()}async#c(){if(this.#s.length===0)return;this.div.replaceChildren();const e=[];if(!this.#o){this.#o=!0;for(const{contentElement:n,data:{id:s}}of this.#s){const o=n.id=`${lf}${s}`;e.push(this.#a?.getAriaAttributes(o).then(d=>{if(d)for(const[c,h]of d)n.setAttribute(c,h)}))}}this.#s.sort(({data:{rect:[n,s,o,d]}},{data:{rect:[c,h,f,m]}})=>{if(n===o&&s===d)return 1;if(c===f&&h===m)return-1;const b=d,A=s,v=(s+d)/2,E=m,x=h,k=(h+m)/2;if(v>=E&&k<=A)return-1;if(k>=b&&v<=x)return 1;const j=(n+o)/2,$=(c+f)/2;return j-$});const t=document.createDocumentFragment();for(const n of this.#s)t.append(n.container),this._commentManager?(n.extraPopupElement?.popup||n.popup)?.renderCommentButton():n.extraPopupElement&&t.append(n.extraPopupElement.render());if(this.div.append(t),await Promise.all(e),this.#e)for(const n of this.#s)this.#e.addPointerInTextLayer(n.contentElement,!1)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:this.#r,svgFactory:new t0,parent:this};for(const n of e){n.borderStyle||=Ry._defaultBorderStyle,t.data=n;const s=Im.create(t);s.isRenderable&&(s.render(),s.contentElement.id=`${lf}${n.id}`,this.#s.push(s))}await this.#c()}update({viewport:e}){const t=this.div;this.viewport=e,hh(t,{rotation:e.rotation}),this.#l(),t.hidden=!1}#l(){if(!this.#t)return;const e=this.div;for(const[t,n]of this.#t){const s=e.querySelector(`[data-annotation-id="${t}"]`);if(!s)continue;n.className="annotationContent";const{firstChild:o}=s;o?o.nodeName==="CANVAS"?o.replaceWith(n):o.classList.contains("annotationContent")?o.after(n):o.before(n):s.append(n);const d=this.#n.get(t);d&&(d._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(t,s.id,n),d._hasNoCanvas=!1):d.canvas=n)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(e){return this.#n.get(e)}addFakeAnnotation(e){const{div:t}=this,{id:n,rotation:s}=e,o=new JT({data:{id:n,rect:e.getPDFRect(),rotation:s},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:this.#r,annotationStorage:this.#i});return o.render(),o.contentElement.id=`${lf}${n}`,o.createOrUpdatePopup(),this.#s.push(o),o}removeAnnotation(e){const t=this.#s.findIndex(s=>s.data.id===e);if(t<0)return;const[n]=this.#s.splice(t,1);this.#e?.removePointerInTextLayer(n.contentElement)}updateFakeAnnotations(e){if(e.length!==0){for(const t of e)t.updateFakeAnnotationElement(this);this.#c()}}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}static get _defaultBorderStyle(){return hi(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:sf.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const Ig=/\r\n?|\n/g;class oo extends Mn{#e="";#t=`${this.id}-editor`;#i=null;#n;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=oo.prototype,t=o=>o.isEmpty(),n=zu.TRANSLATE_SMALL,s=zu.TRANSLATE_BIG;return hi(this,"_keyboardManager",new jp([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[s,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,s],checker:t}]]))}static _type="freetext";static _editorType=mi.FREETEXT;constructor(e){super({...e,name:"freeTextEditor"}),this.color=e.color||oo._defaultColor||Mn._defaultLineColor,this.#n=e.fontSize||oo._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(e,t){Mn.initialize(e,t);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case Ki.FREETEXT_SIZE:oo._defaultFontSize=t;break;case Ki.FREETEXT_COLOR:oo._defaultColor=t;break}}updateParams(e,t){switch(e){case Ki.FREETEXT_SIZE:this.#a(t);break;case Ki.FREETEXT_COLOR:this.#r(t);break}}static get defaultPropertiesToUpdate(){return[[Ki.FREETEXT_SIZE,oo._defaultFontSize],[Ki.FREETEXT_COLOR,oo._defaultColor||Mn._defaultLineColor]]}get propertiesToUpdate(){return[[Ki.FREETEXT_SIZE,this.#n],[Ki.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new wp(this),[["colorPicker",this._colorPicker]]}get colorType(){return Ki.FREETEXT_COLOR}#a(e){const t=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--total-scale-factor))`,this.translate(0,-(s-this.#n)*this.parentScale),this.#n=s,this.#o()},n=this.#n;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ki.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#r(e){const t=s=>{this.color=s,this.onUpdatedColor()},n=this.color;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ki.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-oo._internalPadding*e,-(oo._internalPadding+this.#n)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const e=this._uiManager.combinedSignal(this.#i);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#t),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#s(){const e=[];this.editorDiv.normalize();let t=null;for(const n of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&n.nodeName==="BR"||(e.push(oo.#c(n)),t=n);return e.join(`
`)}#o(){const[e,t]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:s,div:o}=this,d=o.style.display,c=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",s.div.append(this.div),n=o.getBoundingClientRect(),o.remove(),o.style.display=d,o.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=n.width/e,this.height=n.height/t):(this.width=n.height/e,this.height=n.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#e,t=this.#e=this.#s().trimEnd();if(e===t)return;const n=s=>{if(this.#e=s,!s){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{n(t)},undo:()=>{n(e)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){oo._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,t;(this._isCopy||this.annotationElementId)&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#t),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,n.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[s,o]=this.parentDimensions;if(this.annotationElementId){const{position:d}=this._initialData;let[c,h]=this.getInitialTranslation();[c,h]=this.pageTranslationToScreen(c,h);const[f,m]=this.pageDimensions,[b,A]=this.pageTranslation;let v,E;switch(this.rotation){case 0:v=e+(d[0]-b)/f,E=t+this.height-(d[1]-A)/m;break;case 90:v=e+(d[0]-b)/f,E=t-(d[1]-A)/m,[c,h]=[h,-c];break;case 180:v=e-this.width+(d[0]-b)/f,E=t-(d[1]-A)/m,[c,h]=[-c,-h];break;case 270:v=e+(d[0]-b-this.height*m)/f,E=t+(d[1]-A-this.width*f)/m,[c,h]=[-h,c];break}this.setAt(v*s,E*o,c,h)}else this._moveAfterPaste(e,t);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Ig,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:n}=t;if(n.length===1&&n[0]==="text/plain")return;e.preventDefault();const s=oo.#u(t.getData("text")||"").replaceAll(Ig,`
`);if(!s)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const d=o.getRangeAt(0);if(!s.includes(`
`)){d.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:c,startOffset:h}=d,f=[],m=[];if(c.nodeType===Node.TEXT_NODE){const v=c.parentElement;if(m.push(c.nodeValue.slice(h).replaceAll(Ig,"")),v!==this.editorDiv){let E=f;for(const x of this.editorDiv.childNodes){if(x===v){E=m;continue}E.push(oo.#c(x))}}f.push(c.nodeValue.slice(0,h).replaceAll(Ig,""))}else if(c===this.editorDiv){let v=f,E=0;for(const x of this.editorDiv.childNodes)E++===h&&(v=m),v.push(oo.#c(x))}this.#e=`${f.join(`
`)}${s}${m.join(`
`)}`,this.#l();const b=new Range;let A=Math.sumPrecise(f.map(v=>v.length));for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const E=v.nodeValue.length;if(A<=E){b.setStart(v,A),b.setEnd(v,A);break}A-=E}o.removeAllRanges(),o.addRange(b)}#l(){if(this.editorDiv.replaceChildren(),!!this.#e)for(const e of this.#e.split(`
`)){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#h(){return this.#e.replaceAll(""," ")}static#u(e){return e.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const e=oo._internalPadding*this.parentScale;return this.getRect(e,e)}static async deserialize(e,t,n){let s=null;if(e instanceof Tv){const{data:{defaultAppearanceData:{fontSize:d,fontColor:c},rect:h,rotation:f,id:m,popupRef:b,richText:A,contentsObj:v,creationDate:E,modificationDate:x},textContent:k,textPosition:j,parent:{page:{pageNumber:$}}}=e;if(!k||k.length===0)return null;s=e={annotationType:mi.FREETEXT,color:Array.from(c),fontSize:d,value:k.join(`
`),position:j,pageIndex:$-1,rect:h.slice(0),rotation:f,annotationElementId:m,id:m,deleted:!1,popupRef:b,comment:v?.str||null,richText:A,creationDate:E,modificationDate:x}}const o=await super.deserialize(e,t,n);return o.#n=e.fontSize,o.color=un.makeHexColor(...e.color),o.#e=oo.#u(e.value),o._initialData=s,e.comment&&o.setCommentData(e),o}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=Mn._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),n=Object.assign(super.serialize(e),{color:t,fontSize:this.#n,value:this.#h()});return this.addComment(n),e?(n.isCopy=!0,n):this.annotationElementId&&!this.#f(n)?null:(n.id=this.annotationElementId,n)}#f(e){const{value:t,fontSize:n,color:s,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||e.value!==t||e.fontSize!==n||e.color.some((d,c)=>d!==s[c])||e.pageIndex!==o}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(!t)return null;const{style:n}=t;n.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,n.color=this.color,t.replaceChildren();for(const s of this.#e.split(`
`)){const o=document.createElement("div");o.append(s?document.createTextNode(s):document.createElement("br")),t.append(o)}return e.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#e}}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class an{static PRECISION=1e-4;toSVGPath(){Xs("Abstract method `toSVGPath` must be implemented.")}get box(){Xs("Abstract getter `box` must be implemented.")}serialize(e,t){Xs("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,s,o,d){d||=new Float32Array(e.length);for(let c=0,h=e.length;c<h;c+=2)d[c]=t+e[c]*s,d[c+1]=n+e[c+1]*o;return d}static _rescaleAndSwap(e,t,n,s,o,d){d||=new Float32Array(e.length);for(let c=0,h=e.length;c<h;c+=2)d[c]=t+e[c+1]*s,d[c+1]=n+e[c]*o;return d}static _translate(e,t,n,s){s||=new Float32Array(e.length);for(let o=0,d=e.length;o<d;o+=2)s[o]=t+e[o],s[o+1]=n+e[o+1];return s}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,n,s,o){switch(o){case 90:return[1-t/n,e/s];case 180:return[1-e/n,1-t/s];case 270:return[t/n,1-e/s];default:return[e/n,t/s]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,s,o,d){return[(e+5*n)/6,(t+5*s)/6,(5*n+o)/6,(5*s+d)/6,(n+o)/2,(s+d)/2]}}class rh{#e;#t=[];#i;#n;#a=[];#r=new Float32Array(18);#s;#o;#c;#l;#h;#u;#f=[];static#m=8;static#g=2;static#d=rh.#m+rh.#g;constructor({x:e,y:t},n,s,o,d,c=0){this.#e=n,this.#u=o*s,this.#n=d,this.#r.set([NaN,NaN,NaN,NaN,e,t],6),this.#i=c,this.#l=rh.#m*s,this.#c=rh.#d*s,this.#h=s,this.#f.push(e,t)}isEmpty(){return isNaN(this.#r[8])}#p(){const e=this.#r.subarray(4,6),t=this.#r.subarray(16,18),[n,s,o,d]=this.#e;return[(this.#s+(e[0]-t[0])/2-n)/o,(this.#o+(e[1]-t[1])/2-s)/d,(this.#s+(t[0]-e[0])/2-n)/o,(this.#o+(t[1]-e[1])/2-s)/d]}add({x:e,y:t}){this.#s=e,this.#o=t;const[n,s,o,d]=this.#e;let[c,h,f,m]=this.#r.subarray(8,12);const b=e-f,A=t-m,v=Math.hypot(b,A);if(v<this.#c)return!1;const E=v-this.#l,x=E/v,k=x*b,j=x*A;let $=c,z=h;c=f,h=m,f+=k,m+=j,this.#f?.push(e,t);const B=-j/E,F=k/E,I=B*this.#u,X=F*this.#u;return this.#r.set(this.#r.subarray(2,8),0),this.#r.set([f+I,m+X],4),this.#r.set(this.#r.subarray(14,18),12),this.#r.set([f-I,m-X],16),isNaN(this.#r[6])?(this.#a.length===0&&(this.#r.set([c+I,h+X],2),this.#a.push(NaN,NaN,NaN,NaN,(c+I-n)/o,(h+X-s)/d),this.#r.set([c-I,h-X],14),this.#t.push(NaN,NaN,NaN,NaN,(c-I-n)/o,(h-X-s)/d)),this.#r.set([$,z,c,h,f,m],6),!this.isEmpty()):(this.#r.set([$,z,c,h,f,m],6),Math.abs(Math.atan2(z-h,$-c)-Math.atan2(j,k))<Math.PI/2?([c,h,f,m]=this.#r.subarray(2,6),this.#a.push(NaN,NaN,NaN,NaN,((c+f)/2-n)/o,((h+m)/2-s)/d),[c,h,$,z]=this.#r.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,(($+c)/2-n)/o,((z+h)/2-s)/d),!0):([$,z,c,h,f,m]=this.#r.subarray(0,6),this.#a.push((($+5*c)/6-n)/o,((z+5*h)/6-s)/d,((5*c+f)/6-n)/o,((5*h+m)/6-s)/d,((c+f)/2-n)/o,((h+m)/2-s)/d),[f,m,c,h,$,z]=this.#r.subarray(12,18),this.#t.push((($+5*c)/6-n)/o,((z+5*h)/6-s)/d,((5*c+f)/6-n)/o,((5*h+m)/6-s)/d,((c+f)/2-n)/o,((h+m)/2-s)/d),!0))}toSVGPath(){if(this.isEmpty())return"";const e=this.#a,t=this.#t;if(isNaN(this.#r[6])&&!this.isEmpty())return this.#y();const n=[];n.push(`M${e[4]} ${e[5]}`);for(let s=6;s<e.length;s+=6)isNaN(e[s])?n.push(`L${e[s+4]} ${e[s+5]}`):n.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);this.#x(n);for(let s=t.length-6;s>=6;s-=6)isNaN(t[s])?n.push(`L${t[s+4]} ${t[s+5]}`):n.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);return this.#b(n),n.join(" ")}#y(){const[e,t,n,s]=this.#e,[o,d,c,h]=this.#p();return`M${(this.#r[2]-e)/n} ${(this.#r[3]-t)/s} L${(this.#r[4]-e)/n} ${(this.#r[5]-t)/s} L${o} ${d} L${c} ${h} L${(this.#r[16]-e)/n} ${(this.#r[17]-t)/s} L${(this.#r[14]-e)/n} ${(this.#r[15]-t)/s} Z`}#b(e){const t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#x(e){const[t,n,s,o]=this.#e,d=this.#r.subarray(4,6),c=this.#r.subarray(16,18),[h,f,m,b]=this.#p();e.push(`L${(d[0]-t)/s} ${(d[1]-n)/o} L${h} ${f} L${m} ${b} L${(c[0]-t)/s} ${(c[1]-n)/o}`)}newFreeDrawOutline(e,t,n,s,o,d){return new jv(e,t,n,s,o,d)}getOutlines(){const e=this.#a,t=this.#t,n=this.#r,[s,o,d,c]=this.#e,h=new Float32Array((this.#f?.length??0)+2);for(let b=0,A=h.length-2;b<A;b+=2)h[b]=(this.#f[b]-s)/d,h[b+1]=(this.#f[b+1]-o)/c;if(h[h.length-2]=(this.#s-s)/d,h[h.length-1]=(this.#o-o)/c,isNaN(n[6])&&!this.isEmpty())return this.#C(h);const f=new Float32Array(this.#a.length+24+this.#t.length);let m=e.length;for(let b=0;b<m;b+=2){if(isNaN(e[b])){f[b]=f[b+1]=NaN;continue}f[b]=e[b],f[b+1]=e[b+1]}m=this.#w(f,m);for(let b=t.length-6;b>=6;b-=6)for(let A=0;A<6;A+=2){if(isNaN(t[b+A])){f[m]=f[m+1]=NaN,m+=2;continue}f[m]=t[b+A],f[m+1]=t[b+A+1],m+=2}return this.#A(f,m),this.newFreeDrawOutline(f,h,this.#e,this.#h,this.#i,this.#n)}#C(e){const t=this.#r,[n,s,o,d]=this.#e,[c,h,f,m]=this.#p(),b=new Float32Array(36);return b.set([NaN,NaN,NaN,NaN,(t[2]-n)/o,(t[3]-s)/d,NaN,NaN,NaN,NaN,(t[4]-n)/o,(t[5]-s)/d,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,f,m,NaN,NaN,NaN,NaN,(t[16]-n)/o,(t[17]-s)/d,NaN,NaN,NaN,NaN,(t[14]-n)/o,(t[15]-s)/d],0),this.newFreeDrawOutline(b,e,this.#e,this.#h,this.#i,this.#n)}#A(e,t){const n=this.#t;return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+=6}#w(e,t){const n=this.#r.subarray(4,6),s=this.#r.subarray(16,18),[o,d,c,h]=this.#e,[f,m,b,A]=this.#p();return e.set([NaN,NaN,NaN,NaN,(n[0]-o)/c,(n[1]-d)/h,NaN,NaN,NaN,NaN,f,m,NaN,NaN,NaN,NaN,b,A,NaN,NaN,NaN,NaN,(s[0]-o)/c,(s[1]-d)/h],t),t+=24}}class jv extends an{#e;#t=new Float32Array(4);#i;#n;#a;#r;#s;constructor(e,t,n,s,o,d){super(),this.#s=e,this.#a=t,this.#e=n,this.#r=s,this.#i=o,this.#n=d,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(d);const[c,h,f,m]=this.#t;for(let b=0,A=e.length;b<A;b+=2)e[b]=(e[b]-c)/f,e[b+1]=(e[b+1]-h)/m;for(let b=0,A=t.length;b<A;b+=2)t[b]=(t[b]-c)/f,t[b+1]=(t[b+1]-h)/m}toSVGPath(){const e=[`M${this.#s[4]} ${this.#s[5]}`];for(let t=6,n=this.#s.length;t<n;t+=6){if(isNaN(this.#s[t])){e.push(`L${this.#s[t+4]} ${this.#s[t+5]}`);continue}e.push(`C${this.#s[t]} ${this.#s[t+1]} ${this.#s[t+2]} ${this.#s[t+3]} ${this.#s[t+4]} ${this.#s[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,n,s],o){const d=n-e,c=s-t;let h,f;switch(o){case 0:h=an._rescale(this.#s,e,s,d,-c),f=an._rescale(this.#a,e,s,d,-c);break;case 90:h=an._rescaleAndSwap(this.#s,e,t,d,c),f=an._rescaleAndSwap(this.#a,e,t,d,c);break;case 180:h=an._rescale(this.#s,n,t,-d,c),f=an._rescale(this.#a,n,t,-d,c);break;case 270:h=an._rescaleAndSwap(this.#s,n,s,-d,-c),f=an._rescaleAndSwap(this.#a,n,s,-d,-c);break}return{outline:Array.from(h),points:[Array.from(f)]}}#o(e){const t=this.#s;let n=t[4],s=t[5];const o=[n,s,n,s];let d=n,c=s,h=n,f=s;const m=e?Math.max:Math.min,b=new Float32Array(4);for(let v=6,E=t.length;v<E;v+=6){const x=t[v+4],k=t[v+5];isNaN(t[v])?(un.pointBoundingBox(x,k,o),c>k?(d=x,c=k):c===k&&(d=m(d,x)),f<k?(h=x,f=k):f===k&&(h=m(h,x))):(b[0]=b[1]=1/0,b[2]=b[3]=-1/0,un.bezierBoundingBox(n,s,...t.slice(v,v+6),b),un.rectBoundingBox(b[0],b[1],b[2],b[3],o),c>b[1]?(d=b[0],c=b[1]):c===b[1]&&(d=m(d,b[0])),f<b[3]?(h=b[2],f=b[3]):f===b[3]&&(h=m(h,b[2]))),n=x,s=k}const A=this.#t;A[0]=o[0]-this.#i,A[1]=o[1]-this.#i,A[2]=o[2]-o[0]+2*this.#i,A[3]=o[3]-o[1]+2*this.#i,this.firstPoint=[d,c],this.lastPoint=[h,f]}get box(){return this.#t}newOutliner(e,t,n,s,o,d=0){return new rh(e,t,n,s,o,d)}getNewOutline(e,t){const[n,s,o,d]=this.#t,[c,h,f,m]=this.#e,b=o*f,A=d*m,v=n*f+c,E=s*m+h,x=this.newOutliner({x:this.#a[0]*b+v,y:this.#a[1]*A+E},this.#e,this.#r,e,this.#n,t??this.#i);for(let k=2;k<this.#a.length;k+=2)x.add({x:this.#a[k]*b+v,y:this.#a[k+1]*A+E});return x.getOutlines()}}class dy{#e;#t;#i;#n=[];#a=[];constructor(e,t=0,n=0,s=!0){const o=[1/0,1/0,-1/0,-1/0],d=10**-4;for(const{x,y:k,width:j,height:$}of e){const z=Math.floor((x-t)/d)*d,B=Math.ceil((x+j+t)/d)*d,F=Math.floor((k-t)/d)*d,I=Math.ceil((k+$+t)/d)*d,X=[z,F,I,!0],M=[B,F,I,!1];this.#n.push(X,M),un.rectBoundingBox(z,F,B,I,o)}const c=o[2]-o[0]+2*n,h=o[3]-o[1]+2*n,f=o[0]-n,m=o[1]-n;let b=s?-1/0:1/0,A=1/0;const v=this.#n.at(s?-1:-2),E=[v[0],v[2]];for(const x of this.#n){const[k,j,$,z]=x;!z&&s?j<A?(A=j,b=k):j===A&&(b=Math.max(b,k)):z&&!s&&(j<A?(A=j,b=k):j===A&&(b=Math.min(b,k))),x[0]=(k-f)/c,x[1]=(j-m)/h,x[2]=($-m)/h}this.#e=new Float32Array([f,m,c,h]),this.#t=[b,A],this.#i=E}getOutlines(){this.#n.sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);const e=[];for(const t of this.#n)t[3]?(e.push(...this.#l(t)),this.#o(t)):(this.#c(t),e.push(...this.#l(t)));return this.#r(e)}#r(e){const t=[],n=new Set;for(const d of e){const[c,h,f]=d;t.push([c,h,d],[c,f,d])}t.sort((d,c)=>d[1]-c[1]||d[0]-c[0]);for(let d=0,c=t.length;d<c;d+=2){const h=t[d][2],f=t[d+1][2];h.push(f),f.push(h),n.add(h),n.add(f)}const s=[];let o;for(;n.size>0;){const d=n.values().next().value;let[c,h,f,m,b]=d;n.delete(d);let A=c,v=h;for(o=[c,f],s.push(o);;){let E;if(n.has(m))E=m;else if(n.has(b))E=b;else break;n.delete(E),[c,h,f,m,b]=E,A!==c&&(o.push(A,v,c,v===h?h:f),A=c),v=v===h?f:h}o.push(A,v)}return new gC(s,this.#e,this.#t,this.#i)}#s(e){const t=this.#a;let n=0,s=t.length-1;for(;n<=s;){const o=n+s>>1,d=t[o][0];if(d===e)return o;d<e?n=o+1:s=o-1}return s+1}#o([,e,t]){const n=this.#s(e);this.#a.splice(n,0,[e,t])}#c([,e,t]){const n=this.#s(e);for(let s=n;s<this.#a.length;s++){const[o,d]=this.#a[s];if(o!==e)break;if(o===e&&d===t){this.#a.splice(s,1);return}}for(let s=n-1;s>=0;s--){const[o,d]=this.#a[s];if(o!==e)break;if(o===e&&d===t){this.#a.splice(s,1);return}}}#l(e){const[t,n,s]=e,o=[[t,n,s]],d=this.#s(s);for(let c=0;c<d;c++){const[h,f]=this.#a[c];for(let m=0,b=o.length;m<b;m++){const[,A,v]=o[m];if(!(f<=A||v<=h)){if(A>=h){if(v>f)o[m][1]=f;else{if(b===1)return[];o.splice(m,1),m--,b--}continue}o[m][2]=h,v>f&&o.push([t,f,v])}}}return o}}class gC extends an{#e;#t;constructor(e,t,n,s){super(),this.#t=e,this.#e=t,this.firstPoint=n,this.lastPoint=s}toSVGPath(){const e=[];for(const t of this.#t){let[n,s]=t;e.push(`M${n} ${s}`);for(let o=2;o<t.length;o+=2){const d=t[o],c=t[o+1];d===n?(e.push(`V${c}`),s=c):c===s&&(e.push(`H${d}`),n=d)}e.push("Z")}return e.join(" ")}serialize([e,t,n,s],o){const d=[],c=n-e,h=s-t;for(const f of this.#t){const m=new Array(f.length);for(let b=0;b<f.length;b+=2)m[b]=e+f[b]*c,m[b+1]=s-f[b+1]*h;d.push(m)}return d}get box(){return this.#e}get classNamesForOutlining(){return["highlightOutline"]}}class uy extends rh{newFreeDrawOutline(e,t,n,s,o,d){return new mC(e,t,n,s,o,d)}}class mC extends jv{newOutliner(e,t,n,s,o,d=0){return new uy(e,t,n,s,o,d)}}class ca extends Mn{#e=null;#t=0;#i;#n=null;#a=null;#r=null;#s=null;#o=0;#c=null;#l=null;#h=null;#u=!1;#f=null;#m=null;#g=null;#d="";#p;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=mi.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=ca.prototype;return hi(this,"_keyboardManager",new jp([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||ca._defaultColor,this.#p=e.thickness||ca._defaultThickness,this.opacity=e.opacity||ca._defaultOpacity,this.#i=e.boxes||null,this.#y=e.methodOfCreation||"",this.#d=e.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(this.#u=!0,this.#x(e),this.#v()):this.#i&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#s=e.focusNode,this.#o=e.focusOffset,this.#b(),this.#v(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#u?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#p,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#b(){const e=new dy(this.#i,.001);this.#l=e.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const t=new dy(this.#i,.0025,.001,this._uiManager.direction==="ltr");this.#r=t.getOutlines();const{firstPoint:n}=this.#l;this.#f=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height];const{lastPoint:s}=this.#r;this.#m=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height]}#x({highlightOutlines:e,highlightId:t,clipPathId:n}){this.#l=e;const s=1.5;if(this.#r=e.getNewOutline(this.#p/2+s,.0025),t>=0)this.#h=t,this.#n=n,this.parent.drawLayer.finalizeDraw(t,{bbox:e.box,path:{d:e.toSVGPath()}}),this.#g=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},!0);else if(this.parent){const b=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#h,{bbox:ca.#T(this.#l.box,(b-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#g,{bbox:ca.#T(this.#r.box,b),path:{d:this.#r.toSVGPath()}})}const[o,d,c,h]=e.box;switch(this.rotation){case 0:this.x=o,this.y=d,this.width=c,this.height=h;break;case 90:{const[b,A]=this.parentDimensions;this.x=d,this.y=1-o,this.width=c*A/b,this.height=h*b/A;break}case 180:this.x=1-o,this.y=1-d,this.width=c,this.height=h;break;case 270:{const[b,A]=this.parentDimensions;this.x=1-d,this.y=o,this.width=c*A/b,this.height=h*b/A;break}}const{firstPoint:f}=e;this.#f=[(f[0]-o)/c,(f[1]-d)/h];const{lastPoint:m}=this.#r;this.#m=[(m[0]-o)/c,(m[1]-d)/h]}static initialize(e,t){Mn.initialize(e,t),ca._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case Ki.HIGHLIGHT_COLOR:ca._defaultColor=t;break;case Ki.HIGHLIGHT_THICKNESS:ca._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#m}get commentButtonPosition(){return this.#f}updateParams(e,t){switch(e){case Ki.HIGHLIGHT_COLOR:this.#C(t);break;case Ki.HIGHLIGHT_THICKNESS:this.#A(t);break}}static get defaultPropertiesToUpdate(){return[[Ki.HIGHLIGHT_COLOR,ca._defaultColor],[Ki.HIGHLIGHT_THICKNESS,ca._defaultThickness]]}get propertiesToUpdate(){return[[Ki.HIGHLIGHT_COLOR,this.color||ca._defaultColor],[Ki.HIGHLIGHT_THICKNESS,this.#p||ca._defaultThickness],[Ki.HIGHLIGHT_FREE,this.#u]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#h,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#a?.updateColor(this.color),super.onUpdatedColor()}#C(e){const t=(o,d)=>{this.color=o,this.opacity=d,this.onUpdatedColor()},n=this.color,s=this.opacity;this.addCommands({cmd:t.bind(this,e,ca._defaultOpacity),undo:t.bind(this,n,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ki.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(e)},!0)}#A(e){const t=this.#p,n=s=>{this.#p=s,this.#w(s)};this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ki.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#a=new Bc({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#N())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#N())}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){this.#k(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#v(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#k():e&&(this.#v(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#w(e){this.#u&&(this.#x({highlightOutlines:this.#l.getNewOutline(e/2)}),this.fixAndSetPosition(),this.setDims())}#k(){this.#h===null||!this.parent||(this.parent.drawLayer.remove(this.#h),this.#h=null,this.parent.drawLayer.remove(this.#g),this.#g=null)}#v(e=this.parent){this.#h===null&&({id:this.#h,clipPathId:this.#n}=e.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#u},path:{d:this.#l.toSVGPath()}},!1,!0),this.#g=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#u},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},this.#u),this.#c&&(this.#c.style.clipPath=this.#n))}static#T([e,t,n,s],o){switch(o){case 90:return[1-t-s,e,s,n];case 180:return[1-e-n,1-t-s,n,s];case 270:return[t,1-e-n,s,n]}return[e,t,n,s]}rotate(e){const{drawLayer:t}=this.parent;let n;this.#u?(e=(e-this.rotation+360)%360,n=ca.#T(this.#l.box,e)):n=ca.#T([this.x,this.y,this.width,this.height],e),t.updateProperties(this.#h,{bbox:n,root:{"data-main-rotation":e}}),t.updateProperties(this.#g,{bbox:ca.#T(this.#r.box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();this.#d&&(e.setAttribute("aria-label",this.#d),e.setAttribute("role","mark")),this.#u?e.classList.add("free"):this.div.addEventListener("keydown",this.#P.bind(this),{signal:this._uiManager._signal});const t=this.#c=document.createElement("div");return e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#n,this.setDims(),iv(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1}})}#P(e){ca._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#j(!0);break;case 1:case 3:this.#j(!1);break}}#j(e){if(!this.#e)return;const t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#s,this.#o)}select(){super.select(),this.#g&&this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#g&&(this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{selected:!1}}),this.#u||this.#j(!1))}get _mustFixPosition(){return!this.#u}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#h,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#g,{rootClass:{hidden:!e}}))}#N(){return this.#u?this.rotation:0}#I(){if(this.#u)return null;const[e,t]=this.pageDimensions,[n,s]=this.pageTranslation,o=this.#i,d=new Float32Array(o.length*8);let c=0;for(const{x:h,y:f,width:m,height:b}of o){const A=h*e+n,v=(1-f)*t+s;d[c]=d[c+4]=A,d[c+1]=d[c+3]=v,d[c+2]=d[c+6]=A+m*e,d[c+5]=d[c+7]=v-b*t,c+=8}return d}#R(e){return this.#l.serialize(e,this.#N())}static startHighlighting(e,t,{target:n,x:s,y:o}){const{x:d,y:c,width:h,height:f}=n.getBoundingClientRect(),m=new AbortController,b=e.combinedSignal(m),A=v=>{m.abort(),this.#B(e,v)};window.addEventListener("blur",A,{signal:b}),window.addEventListener("pointerup",A,{signal:b}),window.addEventListener("pointerdown",ta,{capture:!0,passive:!1,signal:b}),window.addEventListener("contextmenu",Uc,{signal:b}),n.addEventListener("pointermove",this.#L.bind(this,e),{signal:b}),this._freeHighlight=new uy({x:s,y:o},[d,c,h,f],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#L(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#B(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,n){let s=null;if(e instanceof _v){const{data:{quadPoints:E,rect:x,rotation:k,id:j,color:$,opacity:z,popupRef:B,richText:F,contentsObj:I,creationDate:X,modificationDate:M},parent:{page:{pageNumber:G}}}=e;s=e={annotationType:mi.HIGHLIGHT,color:Array.from($),opacity:z,quadPoints:E,boxes:null,pageIndex:G-1,rect:x.slice(0),rotation:k,annotationElementId:j,id:j,deleted:!1,popupRef:B,richText:F,comment:I?.str||null,creationDate:X,modificationDate:M}}else if(e instanceof Ey){const{data:{inkLists:E,rect:x,rotation:k,id:j,color:$,borderStyle:{rawWidth:z},popupRef:B,richText:F,contentsObj:I,creationDate:X,modificationDate:M},parent:{page:{pageNumber:G}}}=e;s=e={annotationType:mi.HIGHLIGHT,color:Array.from($),thickness:z,inkLists:E,boxes:null,pageIndex:G-1,rect:x.slice(0),rotation:k,annotationElementId:j,id:j,deleted:!1,popupRef:B,richText:F,comment:I?.str||null,creationDate:X,modificationDate:M}}const{color:o,quadPoints:d,inkLists:c,opacity:h}=e,f=await super.deserialize(e,t,n);f.color=un.makeHexColor(...o),f.opacity=h||1,c&&(f.#p=e.thickness),f._initialData=s,e.comment&&f.setCommentData(e);const[m,b]=f.pageDimensions,[A,v]=f.pageTranslation;if(d){const E=f.#i=[];for(let x=0;x<d.length;x+=8)E.push({x:(d[x]-A)/m,y:1-(d[x+1]-v)/b,width:(d[x+2]-d[x])/m,height:(d[x+1]-d[x+5])/b});f.#b(),f.#v(),f.rotate(f.rotation)}else if(c){f.#u=!0;const E=c[0],x={x:E[0]-A,y:b-(E[1]-v)},k=new uy(x,[0,0,m,b],1,f.#p/2,!0,.001);for(let z=0,B=E.length;z<B;z+=2)x.x=E[z]-A,x.y=b-(E[z+1]-v),k.add(x);const{id:j,clipPathId:$}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:k.toSVGPath()}},!0,!0);f.#x({highlightOutlines:k.getOutlines(),highlightId:j,clipPathId:$}),f.#v(),f.rotate(f.parentRotation)}return f}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=Mn._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),n=super.serialize(e);return Object.assign(n,{color:t,opacity:this.opacity,thickness:this.#p,quadPoints:this.#I(),outlines:this.#R(n.rect)}),this.addComment(n),this.annotationElementId&&!this.#M(n)?null:(n.id=this.annotationElementId,n)}#M(e){const{color:t}=this._initialData;return this.hasEditedComment||e.color.some((n,s)=>n!==t[s])}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class Nv{#e=Object.create(null);updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,n)}updateSVGProperty(e,t){this.#e[e]=t}toSVGProperties(){const e=this.#e;return this.#e=Object.create(null),{root:e}}reset(){this.#e=Object.create(null)}updateAll(e=this){this.updateProperties(e)}clone(){Xs("Not implemented")}}class xs extends Mn{#e=null;#t;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#i=null;static#n=null;static#a=null;static _INNER_MARGIN=3;constructor(e){super(e),this.#t=e.mustBeCommitted||!1,this._addOutlines(e)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(e){e.drawOutlines&&(this.#r(e),this.#c())}#r({drawOutlines:e,drawId:t,drawingOptions:n}){this.#e=e,this._drawingOptions||=n,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),t>=0?(this._drawId=t,this.parent.drawLayer.finalizeDraw(t,e.defaultProperties)):this._drawId=this.#s(e,this.parent),this.#u(e.box)}#s(e,t){const{id:n}=t.drawLayer.draw(xs._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return n}static _mergeSVGProperties(e,t){const n=new Set(Object.keys(e));for(const[s,o]of Object.entries(t))n.has(s)?Object.assign(e[s],o):e[s]=o;return e}static getDefaultDrawingOptions(e){Xs("Not implemented")}static get typesMap(){Xs("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const n=this.typesMap.get(e);n&&this._defaultDrawingOptions.updateProperty(n,t),this._currentParent&&(xs.#i.updateProperty(n,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const n=this.constructor.typesMap.get(e);n&&this._updateProperty(e,n,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[n,s]of this.typesMap)e.push([n,t[s]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[n,s]of this.constructor.typesMap)e.push([n,t[s]]);return e}_updateProperty(e,t,n){const s=this._drawingOptions,o=s[t],d=c=>{s.updateProperty(t,c);const h=this.#e.updateProperty(t,c);h&&this.#u(h),this.parent?.drawLayer.updateProperties(this._drawId,s.toSVGProperties()),e===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:d.bind(this,n),undo:d.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,xs._mergeSVGProperties(this.#e.getPathResizingSVGProperties(this.#h()),{bbox:this.#f()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,xs._mergeSVGProperties(this.#e.getPathResizedSVGProperties(this.#h()),{bbox:this.#f()}))}_onTranslating(e,t){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#f()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,xs._mergeSVGProperties(this.#e.getPathTranslatedSVGProperties(this.#h(),this.parentDimensions),{bbox:this.#f()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#t&&(this.#t=!1,this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){this.#o(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#c(),this.#u(this.#e.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),this.#o()):e&&(this._uiManager.addShouldRescale(this),this.#c(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),t&&this.select()}#o(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#c(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#s(this.#e,e)}}#l([e,t,n,s]){const{parentDimensions:[o,d],rotation:c}=this;switch(c){case 90:return[t,1-e,n*(d/o),s*(o/d)];case 180:return[1-e,1-t,n,s];case 270:return[1-t,e,n*(d/o),s*(o/d)];default:return[e,t,n,s]}}#h(){const{x:e,y:t,width:n,height:s,parentDimensions:[o,d],rotation:c}=this;switch(c){case 90:return[1-t,e,n*(o/d),s*(d/o)];case 180:return[1-e,1-t,n,s];case 270:return[t,1-e,n*(o/d),s*(d/o)];default:return[e,t,n,s]}}#u(e){[this.x,this.y,this.width,this.height]=this.#l(e),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#f(){const{x:e,y:t,width:n,height:s,rotation:o,parentRotation:d,parentDimensions:[c,h]}=this;switch((o*4+d)/90){case 1:return[1-t-s,e,s,n];case 2:return[1-e-n,1-t-s,n,s];case 3:return[t,1-e-n,s,n];case 4:return[e,t-n*(c/h),s*(h/c),n*(c/h)];case 5:return[1-t,e,n*(c/h),s*(h/c)];case 6:return[1-e-s*(h/c),1-t,s*(h/c),n*(c/h)];case 7:return[t-n*(c/h),1-e-s*(h/c),n*(c/h),s*(h/c)];case 8:return[e-n,t-s,n,s];case 9:return[1-t,e-n,s,n];case 10:return[1-e,1-t,n,s];case 11:return[t-s,1-e,s,n];case 12:return[e-s*(h/c),t,s*(h/c),n*(c/h)];case 13:return[1-t-n*(c/h),e-s*(h/c),n*(c/h),s*(h/c)];case 14:return[1-e,1-t-n*(c/h),s*(h/c),n*(c/h)];case 15:return[t,1-e,n*(c/h),s*(h/c)];default:return[e,t,n,s]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,xs._mergeSVGProperties({bbox:this.#f()},this.#e.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#u(this.#e.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,t;this._isCopy&&(e=this.x,t=this.y);const n=super.render();n.classList.add("draw");const s=document.createElement("div");return n.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,t),n}static createDrawerInstance(e,t,n,s,o){Xs("Not implemented")}static startDrawing(e,t,n,s){const{target:o,offsetX:d,offsetY:c,pointerId:h,pointerType:f}=s;if(bs.isInitializedAndDifferentPointerType(f))return;const{viewport:{rotation:m}}=e,{width:b,height:A}=o.getBoundingClientRect(),v=xs.#n=new AbortController,E=e.combinedSignal(v);if(bs.setPointer(f,h),window.addEventListener("pointerup",x=>{bs.isSamePointerIdOrRemove(x.pointerId)&&this._endDraw(x)},{signal:E}),window.addEventListener("pointercancel",x=>{bs.isSamePointerIdOrRemove(x.pointerId)&&this._currentParent.endDrawingSession()},{signal:E}),window.addEventListener("pointerdown",x=>{bs.isSamePointerType(x.pointerType)&&(bs.initializeAndAddPointerId(x.pointerId),xs.#i.isCancellable()&&(xs.#i.removeLastElement(),xs.#i.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:E}),window.addEventListener("contextmenu",Uc,{signal:E}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:E}),o.addEventListener("touchmove",x=>{bs.isSameTimeStamp(x.timeStamp)&&ta(x)},{signal:E}),e.toggleDrawing(),t._editorUndoBar?.hide(),xs.#i){e.drawLayer.updateProperties(this._currentDrawId,xs.#i.startNew(d,c,b,A,m));return}t.updateUIForDefaultProperties(this),xs.#i=this.createDrawerInstance(d,c,b,A,m),xs.#a=this.getDefaultDrawingOptions(),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(xs.#a.toSVGProperties(),xs.#i.defaultSVGProperties),!0,!1)}static _drawMove(e){if(bs.isSameTimeStamp(e.timeStamp),!xs.#i)return;const{offsetX:t,offsetY:n,pointerId:s}=e;if(bs.isSamePointerId(s)){if(bs.isUsingMultiplePointers()){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,xs.#i.add(t,n)),bs.setTimeStamp(e.timeStamp),ta(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,xs.#i=null,xs.#a=null,bs.clearPointerType(),bs.clearTimeStamp()),xs.#n&&(xs.#n.abort(),xs.#n=null,bs.clearPointerIds())}static _endDraw(e){const t=this._currentParent;if(t){if(t.toggleDrawing(!0),this._cleanup(!1),e?.target===t.div&&t.drawLayer.updateProperties(this._currentDrawId,xs.#i.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const n=xs.#i,s=this._currentDrawId,o=n.getLastElement();t.addCommands({cmd:()=>{t.drawLayer.updateProperties(s,n.setLastElement(o))},undo:()=>{t.drawLayer.updateProperties(s,n.removeLastElement())},mustExec:!1,type:Ki.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(Ki.DRAW_STEP),!xs.#i.isEmpty()){const{pageDimensions:[n,s],scale:o}=t,d=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:xs.#i.getOutlines(n*o,s*o,o,this._INNER_MARGIN),drawingOptions:xs.#a,mustBeCommitted:!e});return this._cleanup(!0),d}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,n,s,o,d){Xs("Not implemented")}static async deserialize(e,t,n){const{rawDims:{pageWidth:s,pageHeight:o,pageX:d,pageY:c}}=t.viewport,h=this.deserializeDraw(d,c,s,o,this._INNER_MARGIN,e),f=await super.deserialize(e,t,n);return f.createDrawingOptions(e),f.#r({drawOutlines:h}),f.#c(),f.onScaleChanging(),f.rotate(),f}serializeDraw(e){const[t,n]=this.pageTranslation,[s,o]=this.pageDimensions;return this.#e.serialize([t,n,s,o],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class yC{#e=new Float64Array(6);#t;#i;#n;#a;#r;#s="";#o=0;#c=new Pp;#l;#h;constructor(e,t,n,s,o,d){this.#l=n,this.#h=s,this.#n=o,this.#a=d,[e,t]=this.#u(e,t);const c=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#r=[e,t],this.#i=[{line:c,points:this.#r}],this.#e.set(c,0)}updateProperty(e,t){e==="stroke-width"&&(this.#a=t)}#u(e,t){return an._normalizePoint(e,t,this.#l,this.#h,this.#n)}isEmpty(){return!this.#i||this.#i.length===0}isCancellable(){return this.#r.length<=10}add(e,t){[e,t]=this.#u(e,t);const[n,s,o,d]=this.#e.subarray(2,6),c=e-o,h=t-d;return Math.hypot(this.#l*c,this.#h*h)<=2?null:(this.#r.push(e,t),isNaN(n)?(this.#e.set([o,d,e,t],2),this.#t.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#e[0])&&this.#t.splice(6,6),this.#e.set([n,s,o,d,e,t],0),this.#t.push(...an.createBezierPoints(n,s,o,d,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(this.#r.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,s,o){this.#l=n,this.#h=s,this.#n=o,[e,t]=this.#u(e,t);const d=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#r=[e,t];const c=this.#i.at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),this.#i.push({line:d,points:this.#r}),this.#e.set(d,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#i.at(-1)}setLastElement(e){return this.#i?(this.#i.push(e),this.#t=e.line,this.#r=e.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(e)}removeLastElement(){if(!this.#i)return this.#c.removeLastElement();this.#i.pop(),this.#s="";for(let e=0,t=this.#i.length;e<t;e++){const{line:n,points:s}=this.#i[e];this.#t=n,this.#r=s,this.#o=0,this.toSVGPath()}return{path:{d:this.#s}}}toSVGPath(){const e=an.svgRound(this.#t[4]),t=an.svgRound(this.#t[5]);if(this.#r.length===2)return this.#s=`${this.#s} M ${e} ${t} Z`,this.#s;if(this.#r.length<=6){const s=this.#s.lastIndexOf("M");this.#s=`${this.#s.slice(0,s)} M ${e} ${t}`,this.#o=6}if(this.#r.length===4){const s=an.svgRound(this.#t[10]),o=an.svgRound(this.#t[11]);return this.#s=`${this.#s} L ${s} ${o}`,this.#o=12,this.#s}const n=[];this.#o===0&&(n.push(`M ${e} ${t}`),this.#o=6);for(let s=this.#o,o=this.#t.length;s<o;s+=6){const[d,c,h,f,m,b]=this.#t.slice(s,s+6).map(an.svgRound);n.push(`C${d} ${c} ${h} ${f} ${m} ${b}`)}return this.#s+=n.join(" "),this.#o=this.#t.length,this.#s}getOutlines(e,t,n,s){const o=this.#i.at(-1);return o.line=new Float32Array(o.line),o.points=new Float32Array(o.points),this.#c.build(this.#i,e,t,n,this.#n,this.#a,s),this.#e=null,this.#t=null,this.#i=null,this.#s=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Pp extends an{#e;#t=0;#i;#n;#a;#r;#s;#o;#c;build(e,t,n,s,o,d,c){this.#a=t,this.#r=n,this.#s=s,this.#o=o,this.#c=d,this.#i=c??0,this.#n=e,this.#u()}get thickness(){return this.#c}setLastElement(e){return this.#n.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#n.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of this.#n){if(e.push(`M${an.svgRound(t[4])} ${an.svgRound(t[5])}`),t.length===6){e.push("Z");continue}if(t.length===12&&isNaN(t[6])){e.push(`L${an.svgRound(t[10])} ${an.svgRound(t[11])}`);continue}for(let n=6,s=t.length;n<s;n+=6){const[o,d,c,h,f,m]=t.subarray(n,n+6).map(an.svgRound);e.push(`C${o} ${d} ${c} ${h} ${f} ${m}`)}}return e.join("")}serialize([e,t,n,s],o){const d=[],c=[],[h,f,m,b]=this.#h();let A,v,E,x,k,j,$,z,B;switch(this.#o){case 0:B=an._rescale,A=e,v=t+s,E=n,x=-s,k=e+h*n,j=t+(1-f-b)*s,$=e+(h+m)*n,z=t+(1-f)*s;break;case 90:B=an._rescaleAndSwap,A=e,v=t,E=n,x=s,k=e+f*n,j=t+h*s,$=e+(f+b)*n,z=t+(h+m)*s;break;case 180:B=an._rescale,A=e+n,v=t,E=-n,x=s,k=e+(1-h-m)*n,j=t+f*s,$=e+(1-h)*n,z=t+(f+b)*s;break;case 270:B=an._rescaleAndSwap,A=e+n,v=t+s,E=-n,x=-s,k=e+(1-f-b)*n,j=t+(1-h-m)*s,$=e+(1-f)*n,z=t+(1-h)*s;break}for(const{line:F,points:I}of this.#n)d.push(B(F,A,v,E,x,o?new Array(F.length):null)),c.push(B(I,A,v,E,x,o?new Array(I.length):null));return{lines:d,points:c,rect:[k,j,$,z]}}static deserialize(e,t,n,s,o,{paths:{lines:d,points:c},rotation:h,thickness:f}){const m=[];let b,A,v,E,x;switch(h){case 0:x=an._rescale,b=-e/n,A=t/s+1,v=1/n,E=-1/s;break;case 90:x=an._rescaleAndSwap,b=-t/s,A=-e/n,v=1/s,E=1/n;break;case 180:x=an._rescale,b=e/n+1,A=-t/s,v=-1/n,E=1/s;break;case 270:x=an._rescaleAndSwap,b=t/s+1,A=e/n+1,v=-1/s,E=-1/n;break}if(!d){d=[];for(const j of c){const $=j.length;if($===2){d.push(new Float32Array([NaN,NaN,NaN,NaN,j[0],j[1]]));continue}if($===4){d.push(new Float32Array([NaN,NaN,NaN,NaN,j[0],j[1],NaN,NaN,NaN,NaN,j[2],j[3]]));continue}const z=new Float32Array(3*($-2));d.push(z);let[B,F,I,X]=j.subarray(0,4);z.set([NaN,NaN,NaN,NaN,B,F],0);for(let M=4;M<$;M+=2){const G=j[M],U=j[M+1];z.set(an.createBezierPoints(B,F,I,X,G,U),(M-2)*3),[B,F,I,X]=[I,X,G,U]}}}for(let j=0,$=d.length;j<$;j++)m.push({line:x(d[j].map(z=>z??NaN),b,A,v,E),points:x(c[j].map(z=>z??NaN),b,A,v,E)});const k=new this.prototype.constructor;return k.build(m,n,s,1,h,f,o),k}#l(e=this.#c){const t=this.#i+e/2*this.#s;return this.#o%180===0?[t/this.#a,t/this.#r]:[t/this.#r,t/this.#a]}#h(){const[e,t,n,s]=this.#e,[o,d]=this.#l(0);return[e+o,t+d,n-2*o,s-2*d]}#u(){const e=this.#e=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:s}of this.#n){if(s.length<=12){for(let c=4,h=s.length;c<h;c+=6)un.pointBoundingBox(s[c],s[c+1],e);continue}let o=s[4],d=s[5];for(let c=6,h=s.length;c<h;c+=6){const[f,m,b,A,v,E]=s.subarray(c,c+6);un.bezierBoundingBox(o,d,f,m,b,A,v,E,e),o=v,d=E}}const[t,n]=this.#l();e[0]=vl(e[0]-t,0,1),e[1]=vl(e[1]-n,0,1),e[2]=vl(e[2]+t,0,1),e[3]=vl(e[3]+n,0,1),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#e}updateProperty(e,t){return e==="stroke-width"?this.#f(t):null}#f(e){const[t,n]=this.#l();this.#c=e;const[s,o]=this.#l(),[d,c]=[s-t,o-n],h=this.#e;return h[0]-=d,h[1]-=c,h[2]+=2*d,h[3]+=2*c,h}updateParentDimensions([e,t],n){const[s,o]=this.#l();this.#a=e,this.#r=t,this.#s=n;const[d,c]=this.#l(),h=d-s,f=c-o,m=this.#e;return m[0]-=h,m[1]-=f,m[2]+=2*h,m[3]+=2*f,m}updateRotation(e){return this.#t=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#e.map(an.svgRound).join(" ")}get defaultProperties(){const[e,t]=this.#e;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${an.svgRound(e)} ${an.svgRound(t)}`}}}get rotationTransform(){const[,,e,t]=this.#e;let n=0,s=0,o=0,d=0,c=0,h=0;switch(this.#t){case 90:s=t/e,o=-e/t,c=e;break;case 180:n=-1,d=-1,c=e,h=t;break;case 270:s=-t/e,o=e/t,h=t;break;default:return""}return`matrix(${n} ${s} ${o} ${d} ${an.svgRound(c)} ${an.svgRound(h)})`}getPathResizingSVGProperties([e,t,n,s]){const[o,d]=this.#l(),[c,h,f,m]=this.#e;if(Math.abs(f-o)<=an.PRECISION||Math.abs(m-d)<=an.PRECISION){const x=e+n/2-(c+f/2),k=t+s/2-(h+m/2);return{path:{"transform-origin":`${an.svgRound(e)} ${an.svgRound(t)}`,transform:`${this.rotationTransform} translate(${x} ${k})`}}}const b=(n-2*o)/(f-2*o),A=(s-2*d)/(m-2*d),v=f/n,E=m/s;return{path:{"transform-origin":`${an.svgRound(c)} ${an.svgRound(h)}`,transform:`${this.rotationTransform} scale(${v} ${E}) translate(${an.svgRound(o)} ${an.svgRound(d)}) scale(${b} ${A}) translate(${an.svgRound(-o)} ${an.svgRound(-d)})`}}}getPathResizedSVGProperties([e,t,n,s]){const[o,d]=this.#l(),c=this.#e,[h,f,m,b]=c;if(c[0]=e,c[1]=t,c[2]=n,c[3]=s,Math.abs(m-o)<=an.PRECISION||Math.abs(b-d)<=an.PRECISION){const k=e+n/2-(h+m/2),j=t+s/2-(f+b/2);for(const{line:$,points:z}of this.#n)an._translate($,k,j,$),an._translate(z,k,j,z);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${an.svgRound(e)} ${an.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const A=(n-2*o)/(m-2*o),v=(s-2*d)/(b-2*d),E=-A*(h+o)+e+o,x=-v*(f+d)+t+d;if(A!==1||v!==1||E!==0||x!==0)for(const{line:k,points:j}of this.#n)an._rescale(k,E,x,A,v,k),an._rescale(j,E,x,A,v,j);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${an.svgRound(e)} ${an.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,t],n){const[s,o]=n,d=this.#e,c=e-d[0],h=t-d[1];if(this.#a===s&&this.#r===o)for(const{line:f,points:m}of this.#n)an._translate(f,c,h,f),an._translate(m,c,h,m);else{const f=this.#a/s,m=this.#r/o;this.#a=s,this.#r=o;for(const{line:b,points:A}of this.#n)an._rescale(b,c,h,f,m,b),an._rescale(A,c,h,f,m,A);d[2]*=f,d[3]*=m}return d[0]=e,d[1]=t,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${an.svgRound(e)} ${an.svgRound(t)}`}}}get defaultSVGProperties(){const e=this.#e;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${an.svgRound(e[0])} ${an.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}class h0 extends Nv{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Mn._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??=this["stroke-width"],t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new h0(this._viewParameters);return e.updateAll(this),e}}class Dy extends xs{static _type="ink";static _editorType=mi.INK;static _defaultDrawingOptions=null;constructor(e){super({...e,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,t){Mn.initialize(e,t),this._defaultDrawingOptions=new h0(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return hi(this,"typesMap",new Map([[Ki.INK_THICKNESS,"stroke-width"],[Ki.INK_COLOR,"stroke"],[Ki.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,n,s,o){return new yC(e,t,n,s,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,n,s,o,d){return Pp.deserialize(e,t,n,s,o,d)}static async deserialize(e,t,n){let s=null;if(e instanceof Ey){const{data:{inkLists:d,rect:c,rotation:h,id:f,color:m,opacity:b,borderStyle:{rawWidth:A},popupRef:v,richText:E,contentsObj:x,creationDate:k,modificationDate:j},parent:{page:{pageNumber:$}}}=e;s=e={annotationType:mi.INK,color:Array.from(m),thickness:A,opacity:b,paths:{points:d},boxes:null,pageIndex:$-1,rect:c.slice(0),rotation:h,annotationElementId:f,id:f,deleted:!1,popupRef:v,richText:E,comment:x?.str||null,creationDate:k,modificationDate:j}}const o=await super.deserialize(e,t,n);return o._initialData=s,e.comment&&o.setCommentData(e),o}get toolbarButtons(){return this._colorPicker||=new wp(this),[["colorPicker",this._colorPicker]]}get colorType(){return Ki.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:n}=this;t.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:t,opacity:n}){this._drawingOptions=Dy.getDefaultDrawingOptions({stroke:un.makeHexColor(...e),"stroke-width":t,"stroke-opacity":n})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:n}=this.serializeDraw(e),{_drawingOptions:{stroke:s,"stroke-opacity":o,"stroke-width":d}}=this,c=Object.assign(super.serialize(e),{color:Mn._colorManager.convert(s),opacity:o,thickness:d,paths:{lines:t,points:n}});return this.addComment(c),e?(c.isCopy=!0,c):this.annotationElementId&&!this.#e(c)?null:(c.id=this.annotationElementId,c)}#e(e){const{color:t,thickness:n,opacity:s,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||e.color.some((d,c)=>d!==t[c])||e.thickness!==n||e.opacity!==s||e.pageIndex!==o}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;const{points:t,rect:n}=this.serializeDraw(!1);return e.updateEdited({rect:n,thickness:this._drawingOptions["stroke-width"],points:t,popup:this.comment}),null}}class hy extends Pp{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const Bg=8,op=3;class af{static#e={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#t(e,t,n,s){return n-=e,s-=t,n===0?s>0?0:4:n===1?s+6:2-s}static#i=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#n(e,t,n,s,o,d,c){const h=this.#t(n,s,o,d);for(let f=0;f<8;f++){const m=(-f+h-c+16)%8,b=this.#i[2*m],A=this.#i[2*m+1];if(e[(n+b)*t+(s+A)]!==0)return m}return-1}static#a(e,t,n,s,o,d,c){const h=this.#t(n,s,o,d);for(let f=0;f<8;f++){const m=(f+h+c+16)%8,b=this.#i[2*m],A=this.#i[2*m+1];if(e[(n+b)*t+(s+A)]!==0)return m}return-1}static#r(e,t,n,s){const o=e.length,d=new Int32Array(o);for(let m=0;m<o;m++)d[m]=e[m]<=s?1:0;for(let m=1;m<n-1;m++)d[m*t]=d[m*t+t-1]=0;for(let m=0;m<t;m++)d[m]=d[t*n-1-m]=0;let c=1,h;const f=[];for(let m=1;m<n-1;m++){h=1;for(let b=1;b<t-1;b++){const A=m*t+b,v=d[A];if(v===0)continue;let E=m,x=b;if(v===1&&d[A-1]===0)c+=1,x-=1;else if(v>=1&&d[A+1]===0)c+=1,x+=1,v>1&&(h=v);else{v!==1&&(h=Math.abs(v));continue}const k=[b,m],j=x===b+1,$={isHole:j,points:k,id:c,parent:0};f.push($);let z;for(const _ of f)if(_.id===h){z=_;break}z?z.isHole?$.parent=j?z.parent:h:$.parent=j?h:z.parent:$.parent=j?h:0;const B=this.#n(d,t,m,b,E,x,0);if(B===-1){d[A]=-c,d[A]!==1&&(h=Math.abs(d[A]));continue}let F=this.#i[2*B],I=this.#i[2*B+1];const X=m+F,M=b+I;E=X,x=M;let G=m,U=b;for(;;){const _=this.#a(d,t,G,U,E,x,1);F=this.#i[2*_],I=this.#i[2*_+1];const N=G+F,te=U+I;k.push(te,N);const ie=G*t+U;if(d[ie+1]===0?d[ie]=-c:d[ie]===1&&(d[ie]=c),N===m&&te===b&&G===X&&U===M){d[A]!==1&&(h=Math.abs(d[A]));break}else E=G,x=U,G=N,U=te}}}return f}static#s(e,t,n,s){if(n-t<=4){for(let X=t;X<n-2;X+=2)s.push(e[X],e[X+1]);return}const o=e[t],d=e[t+1],c=e[n-4]-o,h=e[n-3]-d,f=Math.hypot(c,h),m=c/f,b=h/f,A=m*d-b*o,v=h/c,E=1/f,x=Math.atan(v),k=Math.cos(x),j=Math.sin(x),$=E*(Math.abs(k)+Math.abs(j)),z=E*(1-$+$**2),B=Math.max(Math.atan(Math.abs(j+k)*z),Math.atan(Math.abs(j-k)*z));let F=0,I=t;for(let X=t+2;X<n-2;X+=2){const M=Math.abs(A-m*e[X+1]+b*e[X]);M>F&&(I=X,F=M)}F>(f*B)**2?(this.#s(e,t,I+2,s),this.#s(e,I,n,s)):s.push(o,d)}static#o(e){const t=[],n=e.length;return this.#s(e,0,n,t),t.push(e[n-2],e[n-1]),t.length<=4?null:t}static#c(e,t,n,s,o,d){const c=new Float32Array(d**2),h=-2*s**2,f=d>>1;for(let x=0;x<d;x++){const k=(x-f)**2;for(let j=0;j<d;j++)c[x*d+j]=Math.exp((k+(j-f)**2)/h)}const m=new Float32Array(256),b=-2*o**2;for(let x=0;x<256;x++)m[x]=Math.exp(x**2/b);const A=e.length,v=new Uint8Array(A),E=new Uint32Array(256);for(let x=0;x<n;x++)for(let k=0;k<t;k++){const j=x*t+k,$=e[j];let z=0,B=0;for(let I=0;I<d;I++){const X=x+I-f;if(!(X<0||X>=n))for(let M=0;M<d;M++){const G=k+M-f;if(G<0||G>=t)continue;const U=e[X*t+G],_=c[I*d+M]*m[Math.abs(U-$)];z+=U*_,B+=_}}const F=v[j]=Math.round(z/B);E[F]++}return[v,E]}static#l(e){const t=new Uint32Array(256);for(const n of e)t[n]++;return t}static#h(e){const t=e.length,n=new Uint8ClampedArray(t>>2);let s=-1/0,o=1/0;for(let c=0,h=n.length;c<h;c++){const f=n[c]=e[c<<2];s=Math.max(s,f),o=Math.min(o,f)}const d=255/(s-o);for(let c=0,h=n.length;c<h;c++)n[c]=(n[c]-o)*d;return n}static#u(e){let t,n=-1/0,s=-1/0;const o=e.findIndex(h=>h!==0);let d=o,c=o;for(t=o;t<256;t++){const h=e[t];h>n&&(t-d>s&&(s=t-d,c=t-1),n=h,d=t)}for(t=c-1;t>=0&&!(e[t]>e[t+1]);t--);return t}static#f(e){const t=e,{width:n,height:s}=e,{maxDim:o}=this.#e;let d=n,c=s;if(n>o||s>o){let A=n,v=s,E=Math.log2(Math.max(n,s)/o);const x=Math.floor(E);E=E===x?x-1:x;for(let j=0;j<E;j++){d=Math.ceil(A/2),c=Math.ceil(v/2);const $=new OffscreenCanvas(d,c);$.getContext("2d").drawImage(e,0,0,A,v,0,0,d,c),A=d,v=c,e!==t&&e.close(),e=$.transferToImageBitmap()}const k=Math.min(o/d,o/c);d=Math.round(d*k),c=Math.round(c*k)}const f=new OffscreenCanvas(d,c).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,d,c),f.filter="grayscale(1)",f.drawImage(e,0,0,e.width,e.height,0,0,d,c);const m=f.getImageData(0,0,d,c).data;return[this.#h(m),d,c]}static extractContoursFromText(e,{fontFamily:t,fontStyle:n,fontWeight:s},o,d,c,h){let f=new OffscreenCanvas(1,1),m=f.getContext("2d",{alpha:!1});const b=200,A=m.font=`${n} ${s} ${b}px ${t}`,{actualBoundingBoxLeft:v,actualBoundingBoxRight:E,actualBoundingBoxAscent:x,actualBoundingBoxDescent:k,fontBoundingBoxAscent:j,fontBoundingBoxDescent:$,width:z}=m.measureText(e),B=1.5,F=Math.ceil(Math.max(Math.abs(v)+Math.abs(E)||0,z)*B),I=Math.ceil(Math.max(Math.abs(x)+Math.abs(k)||b,Math.abs(j)+Math.abs($)||b)*B);f=new OffscreenCanvas(F,I),m=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),m.font=A,m.filter="grayscale(1)",m.fillStyle="white",m.fillRect(0,0,F,I),m.fillStyle="black",m.fillText(e,F*(B-1)/2,I*(3-B)/2);const X=this.#h(m.getImageData(0,0,F,I).data),M=this.#l(X),G=this.#u(M),U=this.#r(X,F,I,G);return this.processDrawnLines({lines:{curves:U,width:F,height:I},pageWidth:o,pageHeight:d,rotation:c,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(e,t,n,s,o){const[d,c,h]=this.#f(e),[f,m]=this.#c(d,c,h,Math.hypot(c,h)*this.#e.sigmaSFactor,this.#e.sigmaR,this.#e.kernelSize),b=this.#u(m),A=this.#r(f,c,h,b);return this.processDrawnLines({lines:{curves:A,width:c,height:h},pageWidth:t,pageHeight:n,rotation:s,innerMargin:o,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:s,innerMargin:o,mustSmooth:d,areContours:c}){s%180!==0&&([t,n]=[n,t]);const{curves:h,width:f,height:m}=e,b=e.thickness??0,A=[],v=Math.min(t/f,n/m),E=v/t,x=v/n,k=[];for(const{points:$}of h){const z=d?this.#o($):$;if(!z)continue;k.push(z);const B=z.length,F=new Float32Array(B),I=new Float32Array(3*(B===2?2:B-2));if(A.push({line:I,points:F}),B===2){F[0]=z[0]*E,F[1]=z[1]*x,I.set([NaN,NaN,NaN,NaN,F[0],F[1]],0);continue}let[X,M,G,U]=z;X*=E,M*=x,G*=E,U*=x,F.set([X,M,G,U],0),I.set([NaN,NaN,NaN,NaN,X,M],0);for(let _=4;_<B;_+=2){const N=F[_]=z[_]*E,te=F[_+1]=z[_+1]*x;I.set(an.createBezierPoints(X,M,G,U,N,te),(_-2)*3),[X,M,G,U]=[G,U,N,te]}}if(A.length===0)return null;const j=c?new hy:new Pp;return j.build(A,t,n,1,s,c?0:b,o),{outline:j,newCurves:k,areContours:c,thickness:b,width:f,height:m}}static async compressSignature({outlines:e,areContours:t,thickness:n,width:s,height:o}){let d=1/0,c=-1/0,h=0;for(const z of e){h+=z.length;for(let B=2,F=z.length;B<F;B++){const I=z[B]-z[B-2];d=Math.min(d,I),c=Math.max(c,I)}}let f;d>=-128&&c<=127?f=Int8Array:d>=-32768&&c<=32767?f=Int16Array:f=Int32Array;const m=e.length,b=Bg+op*m,A=new Uint32Array(b);let v=0;A[v++]=b*Uint32Array.BYTES_PER_ELEMENT+(h-2*m)*f.BYTES_PER_ELEMENT,A[v++]=0,A[v++]=s,A[v++]=o,A[v++]=t?0:1,A[v++]=Math.max(0,Math.floor(n??0)),A[v++]=m,A[v++]=f.BYTES_PER_ELEMENT;for(const z of e)A[v++]=z.length-2,A[v++]=z[0],A[v++]=z[1];const E=new CompressionStream("deflate-raw"),x=E.writable.getWriter();await x.ready,x.write(A);const k=f.prototype.constructor;for(const z of e){const B=new k(z.length-2);for(let F=2,I=z.length;F<I;F++)B[F-2]=z[F]-z[F-2];x.write(B)}x.close();const j=await new Response(E.readable).arrayBuffer(),$=new Uint8Array(j);return Q2($)}static async decompressSignature(e){try{const t=L3(e),{readable:n,writable:s}=new DecompressionStream("deflate-raw"),o=s.getWriter();await o.ready,o.write(t).then(async()=>{await o.ready,await o.close()}).catch(()=>{});let d=null,c=0;for await(const z of n)d||=new Uint8Array(new Uint32Array(z.buffer,0,4)[0]),d.set(z,c),c+=z.length;const h=new Uint32Array(d.buffer,0,d.length>>2),f=h[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const m=h[2],b=h[3],A=h[4]===0,v=h[5],E=h[6],x=h[7],k=[],j=(Bg+op*E)*Uint32Array.BYTES_PER_ELEMENT;let $;switch(x){case Int8Array.BYTES_PER_ELEMENT:$=new Int8Array(d.buffer,j);break;case Int16Array.BYTES_PER_ELEMENT:$=new Int16Array(d.buffer,j);break;case Int32Array.BYTES_PER_ELEMENT:$=new Int32Array(d.buffer,j);break}c=0;for(let z=0;z<E;z++){const B=h[op*z+Bg],F=new Float32Array(B+2);k.push(F);for(let I=0;I<op-1;I++)F[I]=h[op*z+Bg+I+1];for(let I=0;I<B;I++)F[I+2]=F[I]+$[c++]}return{areContours:A,thickness:v,outlines:k,width:m,height:b}}catch(t){return ui(`decompressSignature: ${t}`),null}}}class Ly extends Nv{constructor(){super(),super.updateProperties({fill:Mn._defaultLineColor,"stroke-width":0})}clone(){const e=new Ly;return e.updateAll(this),e}}class My extends h0{constructor(e){super(e),super.updateProperties({stroke:Mn._defaultLineColor,"stroke-width":1})}clone(){const e=new My(this._viewParameters);return e.updateAll(this),e}}class Ad extends xs{#e=!1;#t=null;#i=null;#n=null;static _type="signature";static _editorType=mi.SIGNATURE;static _defaultDrawingOptions=null;constructor(e){super({...e,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#i=e.signatureData||null,this.#t=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,t){Mn.initialize(e,t),this._defaultDrawingOptions=new Ly,this._defaultDrawnSignatureOptions=new My(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!1}static get typesMap(){return hi(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#t}}static computeTelemetryFinalData(e){const t=e.get("hasDescription");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,t;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,e=this.x,t=this.y),super.render(),this._drawId===null)if(this.#i){const{lines:s,mustSmooth:o,areContours:d,description:c,uuid:h,heightInPage:f}=this.#i,{rawDims:{pageWidth:m,pageHeight:b},rotation:A}=this.parent.viewport,v=af.processDrawnLines({lines:s,pageWidth:m,pageHeight:b,rotation:A,innerMargin:Ad._INNER_MARGIN,mustSmooth:o,areContours:d});this.addSignature(v,f,c,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#t||""}));return n&&(this._isCopy=!0,this._moveAfterPaste(e,t)),this.div}setUuid(e){this.#n=e,this.addEditToolbar()}getUuid(){return this.#n}get description(){return this.#t}set description(e){this.#t=e,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:e})),super.addEditToolbar().then(t=>{t?.updateEditSignatureButton(e)}))}getSignaturePreview(){const{newCurves:e,areContours:t,thickness:n,width:s,height:o}=this.#i,d=Math.max(s,o),c=af.processDrawnLines({lines:{curves:e.map(h=>({points:h})),thickness:n,width:s,height:o},pageWidth:d,pageHeight:d,rotation:0,innerMargin:0,mustSmooth:!1,areContours:t});return{areContours:t,outline:c.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,t,n,s){const{x:o,y:d}=this,{outline:c}=this.#i=e;this.#e=c instanceof hy,this.description=n;let h;this.#e?h=Ad.getDefaultDrawingOptions():(h=Ad._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:h});const[,f]=this.pageDimensions;let m=t/f;m=m>=1?.5:m,this.width*=m/this.height,this.width>=1&&(m*=.9/this.width,this.width=.9),this.height=m,this.setDims(),this.x=o,this.y=d,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:s}=this.parent.viewport;return af.process(e,t,n,s,Ad._INNER_MARGIN)}getFromText(e,t){const{rawDims:{pageWidth:n,pageHeight:s},rotation:o}=this.parent.viewport;return af.extractContoursFromText(e,t,n,s,o,Ad._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:s}=this.parent.viewport;return af.processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:s,innerMargin:Ad._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:e,thickness:t}){e?this._drawingOptions=Ad.getDefaultDrawingOptions():(this._drawingOptions=Ad._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":t}))}serialize(e=!1){if(this.isEmpty())return null;const{lines:t,points:n}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":s}}=this,o=Object.assign(super.serialize(e),{isSignature:!0,areContours:this.#e,color:[0,0,0],thickness:this.#e?0:s});return this.addComment(o),e?(o.paths={lines:t,points:n},o.uuid=this.#n,o.isCopy=!0):o.lines=t,this.#t&&(o.accessibilityData={type:"Figure",alt:this.#t}),o}static deserializeDraw(e,t,n,s,o,d){return d.areContours?hy.deserialize(e,t,n,s,o,d):Pp.deserialize(e,t,n,s,o,d)}static async deserialize(e,t,n){const s=await super.deserialize(e,t,n);return s.#e=e.areContours,s.description=e.accessibilityData?.alt||"",s.#n=e.uuid,s}}class xC extends Mn{#e=null;#t=null;#i=null;#n=null;#a=null;#r="";#s=null;#o=!1;#c=null;#l=!1;#h=!1;static _type="stamp";static _editorType=mi.STAMP;constructor(e){super({...e,name:"stampEditor"}),this.#n=e.bitmapUrl,this.#a=e.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,t){Mn.initialize(e,t)}static isHandlingMimeForPasting(e){return iy.includes(e)}static paste(e,t){t.pasteEditor({mode:mi.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#u(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#l=e.isSvg),e.file&&(this.#r=e.file.name),this.#g()}#f(){if(this.#i=null,this._uiManager.enableWaiting(!1),!!this.#s){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:o,height:d}=e||this.copyCanvas(null,null,!0).imageData,c=await n.guess({name:"altText",request:{data:s,width:o,height:d,channels:s.length/(o*d)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const h=c.output;return await this.setGuessedAltText(h),t&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#m(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(n=>this.#u(n,!0)).finally(()=>this.#f());return}if(this.#n){const n=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromUrl(n).then(s=>this.#u(s)).finally(()=>this.#f());return}if(this.#a){const n=this.#a;this.#a=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromFile(n).then(s=>this.#u(s)).finally(()=>this.#f());return}const e=document.createElement("input");e.type="file",e.accept=iy.join(",");const t=this._uiManager._signal;this.#i=new Promise(n=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#u(s)}n()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),n()},{signal:t})}).finally(()=>this.#f()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#s?.remove(),this.#s=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#m();return}super.rebuild(),this.div!==null&&(this.#t&&this.#s===null&&this.#m(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(this.#i||this.#e||this.#n||this.#a||this.#t||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;return this._isCopy&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#e?this.#g():this.#m()),this._isCopy&&this._moveAfterPaste(e,t),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,t){const{id:n,bitmap:s}=this._uiManager.imageManager.getFromCanvas(e,t);t.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(this.#t=n,s&&(this.#e=s),this.#o=!1,this.#g())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const e=200;this.#c=setTimeout(()=>{this.#c=null,this.#p()},e)}#g(){const{div:e}=this;let{width:t,height:n}=this.#e;const[s,o]=this.pageDimensions,d=.75;if(this.width)t=this.width*s,n=this.height*o;else if(t>d*s||n>d*o){const h=Math.min(d*s/t,d*o/n);t*=h,n*=h}this._uiManager.enableWaiting(!1);const c=this.#s=document.createElement("canvas");c.setAttribute("role","img"),this.addContainer(c),this.width=t/s,this.height=n/o,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#p(),this.#h||(this.parent.addUndoableEditor(this),this.#h=!0),this._reportTelemetry({action:"inserted_image"}),this.#r&&this.div.setAttribute("aria-description",this.#r),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(e,t,n=!1){e||(e=224);const{width:s,height:o}=this.#e,d=new kd;let c=this.#e,h=s,f=o,m=null;if(t){if(s>t||o>t){const I=Math.min(t/s,t/o);h=Math.floor(s*I),f=Math.floor(o*I)}m=document.createElement("canvas");const A=m.width=Math.ceil(h*d.sx),v=m.height=Math.ceil(f*d.sy);this.#l||(c=this.#d(A,v));const E=m.getContext("2d");E.filter=this._uiManager.hcmFilter;let x="white",k="#cfcfd8";this._uiManager.hcmFilter!=="none"?k="black":F3.isDarkMode&&(x="#8f8f9d",k="#42414d");const j=15,$=j*d.sx,z=j*d.sy,B=new OffscreenCanvas($*2,z*2),F=B.getContext("2d");F.fillStyle=x,F.fillRect(0,0,$*2,z*2),F.fillStyle=k,F.fillRect(0,0,$,z),F.fillRect($,z,$,z),E.fillStyle=E.createPattern(B,"repeat"),E.fillRect(0,0,A,v),E.drawImage(c,0,0,c.width,c.height,0,0,A,v)}let b=null;if(n){let A,v;if(d.symmetric&&c.width<e&&c.height<e)A=c.width,v=c.height;else if(c=this.#e,s>e||o>e){const k=Math.min(e/s,e/o);A=Math.floor(s*k),v=Math.floor(o*k),this.#l||(c=this.#d(A,v))}const x=new OffscreenCanvas(A,v).getContext("2d",{willReadFrequently:!0});x.drawImage(c,0,0,c.width,c.height,0,0,A,v),b={width:A,height:v,data:x.getImageData(0,0,A,v).data}}return{canvas:m,width:h,height:f,imageData:b}}#d(e,t){const{width:n,height:s}=this.#e;let o=n,d=s,c=this.#e;for(;o>2*e||d>2*t;){const h=o,f=d;o>2*e&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),d>2*t&&(d=d>=16384?Math.floor(d/2)-1:Math.ceil(d/2));const m=new OffscreenCanvas(o,d);m.getContext("2d").drawImage(c,0,0,h,f,0,0,o,d),c=m.transferToImageBitmap()}return c}#p(){const[e,t]=this.parentDimensions,{width:n,height:s}=this,o=new kd,d=Math.ceil(n*e*o.sx),c=Math.ceil(s*t*o.sy),h=this.#s;if(!h||h.width===d&&h.height===c)return;h.width=d,h.height=c;const f=this.#l?this.#e:this.#d(d,c),m=h.getContext("2d");m.filter=this._uiManager.hcmFilter,m.drawImage(f,0,0,f.width,f.height,0,0,d,c)}#y(e){if(e){if(this.#l){const s=this._uiManager.imageManager.getSvgUrl(this.#t);if(s)return s}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#l){const[t,n]=this.pageDimensions,s=Math.round(this.width*t*vf.PDF_TO_CSS_UNITS),o=Math.round(this.height*n*vf.PDF_TO_CSS_UNITS),d=new OffscreenCanvas(s,o);return d.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,s,o),d.transferToImageBitmap()}return structuredClone(this.#e)}static async deserialize(e,t,n){let s=null,o=!1;if(e instanceof kv){const{data:{rect:x,rotation:k,id:j,structParent:$,popupRef:z,richText:B,contentsObj:F,creationDate:I,modificationDate:X},container:M,parent:{page:{pageNumber:G}},canvas:U}=e;let _,N;U?(delete e.canvas,{id:_,bitmap:N}=n.imageManager.getFromCanvas(M.id,U),U.remove()):(o=!0,e._hasNoCanvas=!0);const te=(await t._structTree.getAriaAttributes(`${lf}${j}`))?.get("aria-label")||"";s=e={annotationType:mi.STAMP,bitmapId:_,bitmap:N,pageIndex:G-1,rect:x.slice(0),rotation:k,annotationElementId:j,id:j,deleted:!1,accessibilityData:{decorative:!1,altText:te},isSvg:!1,structParent:$,popupRef:z,richText:B,comment:F?.str||null,creationDate:I,modificationDate:X}}const d=await super.deserialize(e,t,n),{rect:c,bitmap:h,bitmapUrl:f,bitmapId:m,isSvg:b,accessibilityData:A}=e;o?(n.addMissingCanvas(e.id,d),d.#o=!0):m&&n.imageManager.isValidId(m)?(d.#t=m,h&&(d.#e=h)):d.#n=f,d.#l=b;const[v,E]=d.pageDimensions;return d.width=(c[2]-c[0])/v,d.height=(c[3]-c[1])/E,A&&(d.altTextData=A),d._initialData=s,e.comment&&d.setCommentData(e),d.#h=!!s,d}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Object.assign(super.serialize(e),{bitmapId:this.#t,isSvg:this.#l});if(this.addComment(n),e)return n.bitmapUrl=this.#y(!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:s,altText:o}=this.serializeAltText(!1);if(!s&&o&&(n.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const c=this.#b(n);return c.isSame?null:(c.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1,n.id=this.annotationElementId,delete n.bitmapId,n)}if(t===null)return n;t.stamps||=new Map;const d=this.#l?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:d,serialized:n}),n.bitmap=this.#y(!1);else if(this.#l){const c=t.stamps.get(this.#t);d>c.area&&(c.area=d,c.serialized.bitmap.close(),c.serialized.bitmap=this.#y(!1))}return n}#b(e){const{pageIndex:t,accessibilityData:{altText:n}}=this._initialData,s=e.pageIndex===t,o=(e.accessibilityData?.alt||"")===n;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&s&&o,isSameAltText:o}}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class Gd{#e;#t=!1;#i=null;#n=null;#a=null;#r=new Map;#s=!1;#o=!1;#c=!1;#l=null;#h=null;#u=null;#f=null;#m=null;#g=-1;#d;static _initialized=!1;static#p=new Map([oo,Dy,xC,ca,Ad].map(e=>[e._editorType,e]));constructor({uiManager:e,pageIndex:t,div:n,structTreeLayer:s,accessibilityManager:o,annotationLayer:d,drawLayer:c,textLayer:h,viewport:f,l10n:m}){const b=[...Gd.#p.values()];if(!Gd._initialized){Gd._initialized=!0;for(const A of b)A.initialize(m,e)}e.registerEditorTypes(b),this.#d=e,this.pageIndex=t,this.div=n,this.#e=o,this.#i=d,this.viewport=f,this.#u=h,this.drawLayer=c,this._structTree=s,this.#d.addLayer(this)}get isEmpty(){return this.#r.size===0}get isInvisible(){return this.isEmpty&&this.#d.getMode()===mi.NONE}updateToolbar(e){this.#d.updateToolbar(e)}updateMode(e=this.#d.getMode()){switch(this.#w(),e){case mi.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case mi.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case mi.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===mi.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const n of Gd.#p.values())t.toggle(`${n._type}Editing`,e===n._editorType)}this.div.hidden=!1}hasTextLayer(e){return e===this.#u?.div}setEditingState(e){this.#d.setEditingState(e)}addCommands(e){this.#d.addCommands(e)}cleanUndoStack(e){this.#d.cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){this.#i?.togglePointerEvents(e)}get#y(){return this.#r.size!==0?this.#r.values():this.#d.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#m?.abort(),this.#m=null;const e=new Set;for(const n of this.#y)n.enableEditing(),n.show(!0),n.annotationElementId&&(this.#d.removeChangedExistingAnnotation(n),e.add(n.annotationElementId));const t=this.#i;if(t)for(const n of t.getEditableAnnotations()){if(n.hide(),this.#d.isDeletedAnnotationElement(n.data.id)||e.has(n.data.id))continue;const s=await this.deserialize(n);s&&(this.addOrRebuild(s),s.enableEditing())}this.#c=!1,this.#d._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#u&&!this.#m){this.#m=new AbortController;const s=this.#d.combinedSignal(this.#m);this.#u.div.addEventListener("pointerdown",o=>{const{clientX:c,clientY:h,timeStamp:f}=o,m=this.#g;if(f-m>500){this.#g=f;return}this.#g=-1;const{classList:b}=this.div;b.toggle("getElements",!0);const A=document.elementsFromPoint(c,h);if(b.toggle("getElements",!1),!this.div.contains(A[0]))return;let v;const E=new RegExp(`^${yp}[0-9]+$`);for(const k of A)if(E.test(k.id)){v=k.id;break}if(!v)return;const x=this.#r.get(v);x?.annotationElementId===null&&(o.stopPropagation(),o.preventDefault(),x.dblclick(o))},{signal:s,capture:!0})}const e=this.#i,t=[];if(e){const s=new Map,o=new Map;for(const c of this.#y){if(c.disableEditing(),!c.annotationElementId){t.push(c);continue}if(c.serialize()!==null){s.set(c.annotationElementId,c);continue}else o.set(c.annotationElementId,c);this.getEditableAnnotation(c.annotationElementId)?.show(),c.remove()}const d=e.getEditableAnnotations();for(const c of d){const{id:h}=c.data;if(this.#d.isDeletedAnnotationElement(h)){c.updateEdited({deleted:!0});continue}let f=o.get(h);if(f){f.resetAnnotationElement(c),f.show(!1),c.show();continue}f=s.get(h),f&&(this.#d.addChangedExistingAnnotation(f),f.renderAnnotationElement(c)&&f.show(!1)),c.show()}}this.#w(),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const s of Gd.#p.values())n.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),e?.updateFakeAnnotations(t),this.#o=!1}getEditableAnnotation(e){return this.#i?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#d.getActive()!==e&&this.#d.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#u?.div&&!this.#f){this.#f=new AbortController;const e=this.#d.combinedSignal(this.#f);this.#u.div.addEventListener("pointerdown",this.#b.bind(this),{signal:e}),this.#u.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#u?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#u.div.classList.remove("highlighting"))}#b(e){this.#d.unselectAll();const{target:t}=e;if(t===this.#u.div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&this.#u.div.contains(t)){const{isMac:n}=jo.platform;if(e.button!==0||e.ctrlKey&&n)return;this.#d.showAllEditors("highlight",!0,!0),this.#u.div.classList.add("free"),this.toggleDrawing(),ca.startHighlighting(this,this.#d.direction==="ltr",{target:this.#u.div,x:e.x,y:e.y}),this.#u.div.addEventListener("pointerup",()=>{this.#u.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#d._signal}),e.preventDefault()}}enableClick(){if(this.#n)return;this.#n=new AbortController;const e=this.#d.combinedSignal(this.#n);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){this.#n?.abort(),this.#n=null}attach(e){this.#r.set(e.id,e);const{annotationElementId:t}=e;t&&this.#d.isDeletedAnnotationElement(t)&&this.#d.removeDeletedAnnotationElement(e)}detach(e){this.#r.delete(e.id),this.#e?.removePointerInTextLayer(e.contentDiv),!this.#o&&e.annotationElementId&&this.#d.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#d.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#d.addDeletedAnnotationElement(e),Mn.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),this.#d.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!this.#c),this.#d.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#a&&(e._focusEventsAllowed=!1,this.#a=setTimeout(()=>{this.#a=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this.#d._signal}),t.focus())},0)),e._structTreeParentId=this.#e?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),n=()=>{e.remove()};this.addCommands({cmd:t,undo:n,mustExec:!1})}getEditorByUID(e){for(const t of this.#r.values())if(t.uid===e)return t;return null}getNextId(){return this.#d.getId()}get#x(){return Gd.#p.get(this.#d.getMode())}combinedSignal(e){return this.#d.combinedSignal(e)}#C(e){const t=this.#x;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#x?.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await this.#d.updateMode(e.mode);const{offsetX:n,offsetY:s}=this.#A(),o=this.getNextId(),d=this.#C({parent:this,id:o,x:n,y:s,uiManager:this.#d,isCentered:!0,...t});d&&this.add(d)}async deserialize(e){return await Gd.#p.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#d)||null}createAndAddNewEditor(e,t,n={}){const s=this.getNextId(),o=this.#C({parent:this,id:s,x:e.offsetX,y:e.offsetY,uiManager:this.#d,isCentered:t,...n});return o&&this.add(o),o}get boundingClientRect(){return this.div.getBoundingClientRect()}#A(){const{x:e,y:t,width:n,height:s}=this.boundingClientRect,o=Math.max(0,e),d=Math.max(0,t),c=Math.min(window.innerWidth,e+n),h=Math.min(window.innerHeight,t+s),f=(o+c)/2-e,m=(d+h)/2-t,[b,A]=this.viewport.rotation%180===0?[f,m]:[m,f];return{offsetX:b,offsetY:A}}addNewEditor(e={}){this.createAndAddNewEditor(this.#A(),!0,e)}setSelected(e){this.#d.setSelected(e)}toggleSelected(e){this.#d.toggleSelected(e)}unselect(e){this.#d.unselect(e)}pointerup(e){const{isMac:t}=jo.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!this.#s||(this.#s=!1,this.#x?.isDrawer&&this.#x.supportMultipleDrawings))return;if(!this.#t){this.#t=!0;return}const n=this.#d.getMode();if(n===mi.STAMP||n===mi.SIGNATURE){this.#d.unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){if(this.#d.getMode()===mi.HIGHLIGHT&&this.enableTextSelection(),this.#s){this.#s=!1;return}const{isMac:t}=jo.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(this.#s=!0,this.#x?.isDrawer){this.startDrawingSession(e);return}const n=this.#d.getActive();this.#t=!n||n.isEmpty()}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),this.#l){this.#x.startDrawing(this,this.#d,!1,e);return}this.#d.setCurrentDrawingSession(this),this.#l=new AbortController;const t=this.#d.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(this.#h=null,this.commitOrRemove())},{signal:t}),this.#x.startDrawing(this,this.#d,!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&(this.#h=t);return}this.#h&&setTimeout(()=>{this.#h?.focus(),this.#h=null},0)}endDrawingSession(e=!1){return this.#l?(this.#d.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#h=null,this.#x.endDrawing(e)):null}findNewParent(e,t,n){const s=this.#d.findParent(t,n);return s===null||s===this?!1:(s.changeParent(e),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#x.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#d.getActive()?.parent===this&&(this.#d.commitOrRemove(),this.#d.setActiveEditor(null)),this.#a&&(clearTimeout(this.#a),this.#a=null);for(const e of this.#r.values())this.#e?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#r.clear(),this.#d.removeLayer(this)}#w(){for(const e of this.#r.values())e.isEmpty()&&e.remove()}render({viewport:e}){this.viewport=e,hh(this.div,e);for(const t of this.#d.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){this.#d.commitOrRemove(),this.#w();const t=this.viewport.rotation,n=e.rotation;if(this.viewport=e,hh(this.div,{rotation:n}),t!==n)for(const s of this.#r.values())s.rotate(n)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#d.viewParameters.realScale}}class _o{#e=null;#t=new Map;#i=new Map;static#n=0;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#t.size>0)for(const t of this.#t.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return hi(this,"_svgFactory",new t0)}static#a(e,[t,n,s,o]){const{style:d}=e;d.top=`${100*n}%`,d.left=`${100*t}%`,d.width=`${100*s}%`,d.height=`${100*o}%`}#r(){const e=_o._svgFactory.create(1,1,!0);return this.#e.append(e),e.setAttribute("aria-hidden",!0),e}#s(e,t){const n=_o._svgFactory.createElement("clipPath");e.append(n);const s=`clip_${t}`;n.setAttribute("id",s),n.setAttribute("clipPathUnits","objectBoundingBox");const o=_o._svgFactory.createElement("use");return n.append(o),o.setAttribute("href",`#${t}`),o.classList.add("clip"),s}#o(e,t){for(const[n,s]of Object.entries(t))s===null?e.removeAttribute(n):e.setAttribute(n,s)}draw(e,t=!1,n=!1){const s=_o.#n++,o=this.#r(),d=_o._svgFactory.createElement("defs");o.append(d);const c=_o._svgFactory.createElement("path");d.append(c);const h=`path_p${this.pageIndex}_${s}`;c.setAttribute("id",h),c.setAttribute("vector-effect","non-scaling-stroke"),t&&this.#i.set(s,c);const f=n?this.#s(d,h):null,m=_o._svgFactory.createElement("use");return o.append(m),m.setAttribute("href",`#${h}`),this.updateProperties(o,e),this.#t.set(s,o),{id:s,clipPathId:`url(#${f})`}}drawOutline(e,t){const n=_o.#n++,s=this.#r(),o=_o._svgFactory.createElement("defs");s.append(o);const d=_o._svgFactory.createElement("path");o.append(d);const c=`path_p${this.pageIndex}_${n}`;d.setAttribute("id",c),d.setAttribute("vector-effect","non-scaling-stroke");let h;if(t){const b=_o._svgFactory.createElement("mask");o.append(b),h=`mask_p${this.pageIndex}_${n}`,b.setAttribute("id",h),b.setAttribute("maskUnits","objectBoundingBox");const A=_o._svgFactory.createElement("rect");b.append(A),A.setAttribute("width","1"),A.setAttribute("height","1"),A.setAttribute("fill","white");const v=_o._svgFactory.createElement("use");b.append(v),v.setAttribute("href",`#${c}`),v.setAttribute("stroke","none"),v.setAttribute("fill","black"),v.setAttribute("fill-rule","nonzero"),v.classList.add("mask")}const f=_o._svgFactory.createElement("use");s.append(f),f.setAttribute("href",`#${c}`),h&&f.setAttribute("mask",`url(#${h})`);const m=f.cloneNode();return s.append(m),f.classList.add("mainOutline"),m.classList.add("secondaryOutline"),this.updateProperties(s,e),this.#t.set(n,s),n}finalizeDraw(e,t){this.#i.delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:n,bbox:s,rootClass:o,path:d}=t,c=typeof e=="number"?this.#t.get(e):e;if(c){if(n&&this.#o(c,n),s&&_o.#a(c,s),o){const{classList:h}=c;for(const[f,m]of Object.entries(o))h.toggle(f,m)}if(d){const f=c.firstElementChild.firstElementChild;this.#o(f,d)}}}updateParent(e,t){if(t===this)return;const n=this.#t.get(e);n&&(t.#e.append(n),this.#t.delete(e),t.#t.set(e,n))}remove(e){this.#i.delete(e),this.#e!==null&&(this.#t.get(e).remove(),this.#t.delete(e))}destroy(){this.#e=null;for(const e of this.#t.values())e.remove();this.#t.clear(),this.#i.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:dy};globalThis.pdfjsLib={AbortException:Mu,AnnotationEditorLayer:Gd,AnnotationEditorParamsType:Ki,AnnotationEditorType:mi,AnnotationEditorUIManager:zu,AnnotationLayer:Ry,AnnotationMode:Pu,AnnotationType:ja,applyOpacity:H3,build:YT,ColorPicker:Bc,createValidAbsoluteUrl:X2,CSSConstants:U3,DOMSVGFactory:t0,DrawLayer:_o,FeatureTest:jo,fetchData:Cp,findContrastColor:q3,getDocument:xv,getFilenameFromUrl:M3,getPdfFilenameFromUrl:z3,getRGB:kp,getUuid:J2,getXfaPageViewport:B3,GlobalWorkerOptions:xf,ImageKind:Wg,InvalidPDFException:ty,isDataScheme:c0,isPdfFile:Sy,isValidExplicitDest:Q3,MathClamp:vl,noContextMenu:Uc,normalizeUnicode:R3,OPS:xp,OutputScale:kd,PasswordResponses:A3,PDFDataRangeTransport:bv,PDFDateString:ny,PDFWorker:vp,PermissionFlag:S3,PixelsPerInch:vf,RenderingCancelledException:wy,renderRichText:tv,ResponseException:Qg,setLayerDimensions:hh,shadow:hi,SignatureExtractor:af,stopEvent:ta,SupportedImageMimeTypes:iy,TextLayer:xl,TouchManager:d0,updateUrlHash:K2,Util:un,VerbosityLevel:a0,version:Sv,XfaLayer:ev};typeof window<"u"&&(xf.workerSrc=`https://cdn.jsdelivr.net/npm/pdfjs-dist@${Sv}/build/pdf.worker.min.mjs`);const bC=r=>{const e=gy[r];return!e||!e.prefix||e.prefix.length<1?"?":e.prefix[0].substring(0,1).toUpperCase()},vC=({componentEditor:r,componentDefinition:e,setComponentEditor:t,componentsTop:n,componentsBottom:s,setComponentsTop:o,setComponentsBottom:d,connectingPin:c,setConnectingPin:h,componentDialogPosition:f,setComponentDialogPosition:m,isDraggingDialog:b,setIsDraggingDialog:A,dialogDragOffset:v,setDialogDragOffset:E,areComponentsLocked:x,setSelectedComponentIds:k,setNotesDialogVisible:j})=>{const[$,z]=K.useState(!1),[B,F]=K.useState(null);if(!r||!r.visible)return null;let I=n.find(U=>U.id===r.id),X="top";if(I||(I=s.find(U=>U.id===r.id),X="bottom"),!I)return null;r.layer!==X&&t({...r,layer:X});const M=U=>{const _={...U};console.log("[ComponentEditor] updateComponent - Entry:",{componentId:U.id,componentType:U.componentType,editorDatasheet:r.datasheet,editorDatasheetType:typeof r.datasheet,originalComponentDatasheet:U.datasheet});const N=r.designator?.trim()||"";_.designator=N,_.x=r.x,_.y=r.y,_.layer=r.layer,_.orientation=r.orientation??0;const te=N.length>0?N.charAt(0).toUpperCase():bC(U.componentType);if(_.abbreviation=te,"manufacturer"in _&&(_.manufacturer=r.manufacturer?.trim()||void 0),"partNumber"in _&&(_.partNumber=r.partNumber?.trim()||void 0),r.pinCount!==U.pinCount){_.pinCount=r.pinCount;const ie=U.pinConnections||[];if(_.pinConnections=new Array(r.pinCount).fill("").map((re,q)=>q<ie.length?ie[q]:""),U.pinPolarities){const re=U.pinPolarities||[];_.pinPolarities=new Array(r.pinCount).fill("").map((q,J)=>J<re.length?re[J]:"")}if(U.pinNames){const re=U.pinNames||[];_.pinNames=new Array(r.pinCount).fill("").map((q,J)=>J<re.length?re[J]:"")}}else _.pinConnections=U.pinConnections||[],U.pinPolarities&&(_.pinPolarities=U.pinPolarities),U.pinNames&&(_.pinNames=U.pinNames);if(U.componentType==="Resistor")_.resistance=r.resistance||void 0,_.resistanceUnit=r.resistanceUnit||void 0,_.power=r.power?`${r.power}W`:void 0,_.tolerance=r.tolerance||void 0;else if(U.componentType==="Capacitor")_.capacitance=r.capacitance||void 0,_.capacitanceUnit=r.capacitanceUnit||void 0,_.voltage=r.voltage||void 0,_.voltageUnit=r.voltageUnit||void 0,_.tolerance=r.tolerance||void 0,_.dielectric=r.dielectric||void 0;else if(U.componentType==="Electrolytic Capacitor")_.capacitance=r.capacitance||void 0,_.capacitanceUnit=r.capacitanceUnit||void 0,_.voltage=r.voltage||void 0,_.voltageUnit=r.voltageUnit||void 0,_.tolerance=r.tolerance||void 0,_.esr=r.esr||void 0,_.esrUnit=r.esrUnit||void 0,_.temperature=r.temperature||void 0;else if(U.componentType==="Film Capacitor")_.capacitance=r.capacitance||void 0,_.capacitanceUnit=r.capacitanceUnit||void 0,_.voltage=r.voltage||void 0,_.voltageUnit=r.voltageUnit||void 0,_.tolerance=r.tolerance||void 0,_.filmType=r.filmType||void 0;else if(U.componentType==="Diode")_.diodeType=r.diodeType||U.diodeType||"Standard",_.voltage=r.voltage||void 0,_.voltageUnit=r.voltageUnit||void 0,_.current=r.current||void 0,_.currentUnit=r.currentUnit||void 0,_.ledColor=r.ledColor||void 0;else if(U.componentType==="Battery")_.voltage=r.voltage||void 0,_.voltageUnit=r.voltageUnit||void 0,_.capacity=r.capacity||void 0,_.capacityUnit=r.capacityUnit||void 0,_.chemistry=r.chemistry||void 0;else if(U.componentType==="Fuse")_.current=r.current||void 0,_.currentUnit=r.currentUnit||void 0,_.voltage=r.voltage||void 0,_.voltageUnit=r.voltageUnit||void 0,_.fuseType=r.fuseType||void 0;else if(U.componentType==="FerriteBead")_.impedance=r.impedance||void 0,_.impedanceUnit=r.impedanceUnit||void 0,_.current=r.current||void 0,_.currentUnit=r.currentUnit||void 0;else if(U.componentType==="Connector")_.connectorType=r.connectorType||void 0,_.gender=r.gender||void 0;else if(U.componentType==="Jumper")_.positions=r.positions||void 0;else if(U.componentType==="Relay")_.coilVoltage=r.coilVoltage||void 0,_.coilVoltageUnit=r.coilVoltageUnit||void 0,_.contactType=r.contactType||void 0,_.current=r.current||void 0,_.currentUnit=r.currentUnit||void 0;else if(U.componentType==="Inductor")_.inductance=r.inductance||void 0,_.inductanceUnit=r.inductanceUnit||void 0,_.current=r.current||void 0,_.currentUnit=r.currentUnit||void 0,_.resistance=r.resistance||void 0,_.resistanceUnit=r.resistanceUnit||void 0;else if(U.componentType==="Speaker")_.impedance=r.impedance||void 0,_.impedanceUnit=r.impedanceUnit||void 0,_.power=r.power?`${r.power}W`:void 0;else if(U.componentType==="Motor")_.motorType=r.motorType||void 0,_.voltage=r.voltage||void 0,_.voltageUnit=r.voltageUnit||void 0,_.current=r.current||void 0,_.currentUnit=r.currentUnit||void 0;else if(U.componentType==="PowerSupply")_.inputVoltage=r.inputVoltage||void 0,_.inputVoltageUnit=r.inputVoltageUnit||void 0,_.outputVoltage=r.outputVoltage||void 0,_.outputVoltageUnit=r.outputVoltageUnit||void 0,_.current=r.current||void 0,_.currentUnit=r.currentUnit||void 0;else if(U.componentType==="Transistor")_.transistorType=r.transistorType||void 0,_.polarity=r.polarity||void 0,_.voltage=r.voltage||void 0,_.voltageUnit=r.voltageUnit||void 0,_.current=r.current||void 0,_.currentUnit=r.currentUnit||void 0;else if(U.componentType==="ResistorNetwork")_.resistance=r.resistance||void 0,_.resistanceUnit=r.resistanceUnit||void 0,_.configuration=r.configuration||void 0;else if(U.componentType==="Thermistor")_.resistance=r.resistance||void 0,_.resistanceUnit=r.resistanceUnit||void 0,_.thermistorType=r.thermistorType||void 0,_.beta=r.beta||void 0;else if(U.componentType==="Switch")_.switchType=r.switchType||void 0,_.current=r.current||void 0,_.currentUnit=r.currentUnit||void 0,_.voltage=r.voltage||void 0,_.voltageUnit=r.voltageUnit||void 0;else if(U.componentType==="Transformer")_.primaryVoltage=r.primaryVoltage||void 0,_.primaryVoltageUnit=r.primaryVoltageUnit||void 0,_.secondaryVoltage=r.secondaryVoltage||void 0,_.secondaryVoltageUnit=r.secondaryVoltageUnit||void 0,_.power=r.power?`${r.power}W`:void 0,_.turns=r.turns||void 0;else if(U.componentType==="TestPoint")_.signal=r.signal||void 0;else if(U.componentType==="Film Capacitor")_.capacitance=r.capacitance||void 0,_.capacitanceUnit=r.capacitanceUnit||void 0,_.voltage=r.voltage||void 0,_.voltageUnit=r.voltageUnit||void 0,_.tolerance=r.tolerance||void 0,_.filmType=r.filmType||void 0;else if(U.componentType==="IntegratedCircuit"||U.componentType==="Semiconductor"){_.description=r.description?.trim()||void 0;const ie=r.datasheet;if(console.log("[ComponentEditor] updateComponent - IntegratedCircuit/Semiconductor block:",{componentType:U.componentType,editorDatasheet:r.datasheet,editorDatasheetType:typeof r.datasheet,editorDatasheetLength:r.datasheet?.length,originalComponentDatasheet:U.datasheet,datasheetValue:ie}),ie!=null){const re=ie.trim();_.datasheet=re.length>0?re:""}else _.datasheet=U.datasheet||void 0;U.componentType==="Semiconductor"&&(_.componentType="IntegratedCircuit"),console.log("[ComponentEditor] updateComponent - Final datasheet value:",_.datasheet),_.icType=r.icType||void 0}else _.description=r.description?.trim()||void 0;return U.componentType==="VacuumTube"?_.tubeType=r.tubeType||void 0:U.componentType==="VariableResistor"?(_.vrType=r.vrType||void 0,_.resistance=r.resistance||void 0,_.resistanceUnit=r.resistanceUnit||void 0,_.power=r.power?`${r.power}W`:void 0,_.taper=r.taper||void 0):U.componentType==="Crystal"?(_.frequency=r.frequency||void 0,_.loadCapacitance=r.loadCapacitance||void 0,_.tolerance=r.tolerance||void 0):U.componentType==="GenericComponent"&&(_.genericType=r.genericType||"Attenuator",_.voltage=r.voltage||void 0,_.voltageUnit=r.voltageUnit||void 0,_.current=r.current||void 0,_.currentUnit=r.currentUnit||void 0,_.power=r.power||void 0,_.frequency=r.frequency||void 0,_.model=r.model||void 0),_},G=()=>{if(x){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const U=n.find(te=>te.id===r.id),_=s.find(te=>te.id===r.id),N=U||_;if(N){N.componentType==="IntegratedCircuit"&&console.log("[ComponentEditor] handleSave - Before updateComponent call:",{componentDatasheet:N.datasheet,editorDatasheet:r.datasheet,editorDatasheetType:typeof r.datasheet,editorDatasheetLength:r.datasheet?.length,fullEditor:r});const te=M(N);N.componentType==="IntegratedCircuit"&&console.log("[ComponentEditor] handleSave - After updateComponent call:",{updatedComponentDatasheet:te.datasheet,updatedComponentDatasheetType:typeof te.datasheet});const ie=N.layer,re=r.layer;ie!==re?ie==="top"?(o(q=>q.filter(J=>J.id!==r.id)),d(q=>[...q,te])):(d(q=>q.filter(J=>J.id!==r.id)),o(q=>[...q,te])):re==="top"?o(q=>{const J=q.map(_e=>_e.id===r.id?(console.log("[ComponentEditor] Updating component in top array - datasheet:",te.datasheet),te):_e),ce=J.find(_e=>_e.id===r.id);return ce&&ce.componentType==="IntegratedCircuit"&&console.log("[ComponentEditor] After state update - component datasheet in array:",ce.datasheet),J}):d(q=>{const J=q.map(_e=>_e.id===r.id?(console.log("[ComponentEditor] Updating component in bottom array - datasheet:",te.datasheet),te):_e),ce=J.find(_e=>_e.id===r.id);return ce&&ce.componentType==="IntegratedCircuit"&&console.log("[ComponentEditor] After state update - component datasheet in array:",ce.datasheet),J})}else if(console.warn(`Component ${r.id} not found in either layer array`),r.layer==="top"){const te=s.find(ie=>ie.id===r.id);if(te){const ie=M(te);d(re=>re.filter(q=>q.id!==r.id)),o(re=>[...re,ie])}}else{const te=n.find(ie=>ie.id===r.id);if(te){const ie=M(te);o(re=>re.filter(q=>q.id!==r.id)),d(re=>[...re,ie])}}t(null),h(null)};return l.jsxs("div",{"data-component-editor-dialog":!0,onClick:U=>{if(c&&c.componentId===I.id){const _=U.target;(_.tagName==="BUTTON"||_.tagName==="INPUT"||_.closest("button")||_.closest("input"))&&U.stopPropagation()}},style:{position:"fixed",top:f?`${f.y}px`:"90px",left:f?`${f.x}px`:`${window.innerWidth-280}px`,transform:"none",background:c&&c.componentId===I.id?"rgba(255, 255, 255, 0.95)":"#fff",border:"1px solid #0b5fff",borderRadius:4,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"350px",width:"350px",maxHeight:"40vh",display:"flex",flexDirection:"column",pointerEvents:"auto",cursor:b?"grabbing":"default"},children:[l.jsxs("div",{onMouseDown:U=>{const _=U.target;_.tagName==="BUTTON"||_.tagName==="INPUT"||_.closest("button")||_.closest("input")||f&&(E({x:U.clientX-f.x,y:U.clientY-f.y}),A(!0),U.preventDefault())},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:b?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[l.jsx("h3",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Component Properties"}),l.jsx("button",{onClick:()=>{t(null),h(null)},style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"6px 20px 6px 6px",overflowY:"auto",flex:1,minHeight:0},children:[(()=>{const U=e||_d(I);return l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Category:"}),l.jsx("div",{style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#000"},children:U?.category||"N/A"})]})})(),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Type:"}),l.jsx("div",{style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#000"},children:(()=>{const U=e||_d(I);return U?.displayName?I.componentType==="Capacitor"&&!U.displayName.toLowerCase().includes("capacitor")?`${U.displayName} Capacitor`:U.displayName:I.componentType==="GenericComponent"&&I.genericType?yc(I.genericType):I.componentType==="Diode"&&I.diodeType&&I.diodeType!=="Standard"?yc(I.diodeType):I.componentType==="VariableResistor"&&I.vrType&&I.vrType!=="Potentiometer"?yc(I.vrType):I.componentType==="Capacitor"&&I.dielectric==="Tantalum"?"Tantalum Capacitor":I.componentType==="Capacitor"&&I.capacitorType==="Electrolytic"?"Electrolytic Capacitor":I.componentType==="Capacitor"&&I.capacitorType==="Film"?"Film Capacitor":yc(I.componentType)})()})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-layer-${I.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Layer:"}),l.jsxs("select",{id:`component-layer-${I.id}`,name:`component-layer-${I.id}`,value:r.layer,onChange:U=>t({...r,layer:U.target.value}),disabled:x,style:{width:"80px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:x?.6:1},children:[l.jsx("option",{value:"top",children:"Top"}),l.jsx("option",{value:"bottom",children:"Bottom"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-orientation-${I.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Orientation:"}),l.jsxs("select",{id:`component-orientation-${I.id}`,name:`component-orientation-${I.id}`,value:r.orientation??0,onChange:U=>{const _=parseInt(U.target.value)||0;if(t({...r,orientation:_}),!x){const te=(r.layer==="top"?n:s).find(ie=>ie.id===r.id);if(te){const ie={...te,orientation:_};r.layer==="top"?o(re=>re.map(q=>q.id===r.id?ie:q)):d(re=>re.map(q=>q.id===r.id?ie:q))}}},disabled:x,style:{width:"70px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:x?.6:1},children:[l.jsx("option",{value:"0",children:"0"}),l.jsx("option",{value:"90",children:"90"}),l.jsx("option",{value:"180",children:"180"}),l.jsx("option",{value:"270",children:"270"})]})]}),l.jsx(w3,{component:I,componentEditor:r,componentDefinition:e,setComponentEditor:t,areComponentsLocked:x,componentsTop:n,componentsBottom:s,uploadedDatasheetFile:B,setUploadedDatasheetFile:F,setComponentsTop:o,setComponentsBottom:d}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginTop:"4px",paddingTop:"4px",borderTop:"1px solid #e0e0e0"},children:[l.jsx("label",{htmlFor:`component-designator-${I.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Designator:"}),l.jsx("input",{id:`component-designator-${I.id}`,name:`component-designator-${I.id}`,type:"text",value:r.designator||"",onChange:U=>{const _=U.target.value,N=_.length>0?_.charAt(0).toUpperCase():r.abbreviation;t({...r,designator:_,abbreviation:N})},disabled:x,style:{width:"80px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",fontFamily:"monospace",textTransform:"uppercase",opacity:x?.6:1},placeholder:"e.g., U2, R7, C1"})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-description-${I.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Description:"}),l.jsx("input",{id:`component-description-${I.id}`,name:`component-description-${I.id}`,type:"text",value:r.description||"",onChange:U=>{t({...r,description:U.target.value})},disabled:x,style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:x?.6:1},placeholder:""})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-notes-${I.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Notes:"}),l.jsx("input",{id:`component-notes-${I.id}`,name:`component-notes-${I.id}`,type:"text",readOnly:!0,value:I.notes||"",onClick:()=>{x||(k(new Set([I.id])),j(!0))},disabled:x,style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:x?.6:1,cursor:x?"not-allowed":"pointer",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},placeholder:"Click to edit notes...",title:I.notes||"Click to edit notes..."})]}),I.componentType!=="IntegratedCircuit"&&l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-pincount-${I.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Pin Count:"}),l.jsx("input",{id:`component-pincount-${I.id}`,name:`component-pincount-${I.id}`,type:"number",min:"1",value:r.pinCount,onChange:U=>{const _=Math.max(1,parseInt(U.target.value)||1);t({...r,pinCount:_})},onBlur:U=>{if(x){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const _=Math.max(1,parseInt(U.target.value)||1),te=(r.layer==="top"?n:s).find(ie=>ie.id===r.id);if(te&&_!==te.pinCount){const ie=te.pinConnections||[],re=new Array(_).fill("").map((_e,xe)=>xe<ie.length?ie[xe]:""),q=te.pinPolarities||[],J=te.pinPolarities?new Array(_).fill("").map((_e,xe)=>xe<q.length?q[xe]:""):void 0,ce={...te,pinCount:_,pinConnections:re,...J!==void 0&&{pinPolarities:J}};r.layer==="top"?o(_e=>_e.map(xe=>xe.id===r.id?ce:xe)):d(_e=>_e.map(xe=>xe.id===r.id?ce:xe)),t({...r,pinCount:_})}},disabled:x,style:{width:"60px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:x?.6:1}})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-x-${I.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"X:"}),l.jsx("input",{id:`component-x-${I.id}`,name:`component-x-${I.id}`,type:"number",value:r.x.toFixed(2),onChange:U=>{const _=parseFloat(U.target.value)||0;t({...r,x:_})},disabled:x,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:x?.6:1}})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{htmlFor:`component-y-${I.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Y:"}),l.jsx("input",{id:`component-y-${I.id}`,name:`component-y-${I.id}`,type:"number",value:r.y.toFixed(2),onChange:U=>{const _=parseFloat(U.target.value)||0;t({...r,y:_})},disabled:x,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:x?.6:1}})]}),l.jsxs("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid #e0e0e0"},children:[l.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"2px"},children:"Pin Connections:"}),c&&c.componentId===I.id&&l.jsxs("div",{style:{padding:"2px 3px",background:"#fff3cd",border:"1px solid #ffc107",borderRadius:2,marginBottom:"2px",fontSize:"8px",color:"#856404"},children:["Pin ",c.pinIndex+1," selected. Click on a via or pad to connect."]}),(()=>{const U=Sp(I),N=(r.layer==="top"?n:s).find(D=>D.id===r.id),te=N?.pinNames,re=(e||_d(I))?.properties?.pinNames,q=re&&re.length>0,J=q&&re.includes("CHIP_DEPENDENT"),ce=q&&!J,_e=J,xe=q,Z=async()=>{if(!B&&!r?.datasheet?.trim()){alert("Please upload a datasheet PDF file or enter a datasheet URL above before fetching pin names.");return}z(!0);try{let D;if(B)D=await B.arrayBuffer();else{const Pe=r?.datasheet?.trim();try{const Ue=await fetch(Pe);if(!Ue.ok)throw new Error(`Failed to fetch datasheet: ${Ue.statusText}`);D=await Ue.arrayBuffer()}catch(Ue){console.log("Direct fetch failed, trying CORS proxy...",Ue);const Re=`https://api.allorigins.win/raw?url=${encodeURIComponent(Pe)}`;try{const Ke=await fetch(Re);if(!Ke.ok)throw new Error(`CORS proxy failed: ${Ke.statusText}`);D=await Ke.arrayBuffer()}catch{throw new Error(`Unable to fetch datasheet due to CORS restrictions. Please download the PDF and upload it using the file input above. Original error: ${Ue instanceof Error?Ue.message:"Unknown error"}`)}}}const H=await xv({data:D}).promise;let Y="";for(let Pe=1;Pe<=H.numPages;Pe++){const Ke=(await(await H.getPage(Pe)).getTextContent()).items.map(Je=>Je.str).join(" ");Y+=Ke+`
`}const ue=new Array(r.pinCount).fill(""),Ne=Y.split(`
`);for(let Pe=1;Pe<=r.pinCount;Pe++){const Ue=[new RegExp(`(?:^|\\s)${Pe}\\s+([A-Z][A-Z0-9_/\\-]*?)(?:\\s|$)`,"i"),new RegExp(`Pin\\s+${Pe}[\\s:]+([A-Z][A-Z0-9_/\\-]*?)(?:\\s|$)`,"i"),new RegExp(`${Pe}\\s+([A-Z][A-Z0-9_/\\-]+)`,"i")];for(const Re of Ue){for(const Ke of Ne){const Je=Ke.match(Re);if(Je&&Je[1]){const st=Je[1].trim();if(st.length>0&&!["NC","N/C","N.C.","RESERVED","DNC","DNU"].includes(st.toUpperCase())&&st.length<20){ue[Pe-1]=st;break}}}if(ue[Pe-1])break}}if(N){const Pe={...N,pinNames:ue};r.layer==="top"?o(Re=>Re.map(Ke=>Ke.id===r.id?Pe:Ke)):d(Re=>Re.map(Ke=>Ke.id===r.id?Pe:Ke));const Ue=ue.filter(Re=>Re.length>0).length;Ue>0?alert(`Successfully fetched ${Ue} pin name(s) from datasheet. Please review and edit as needed.`):alert("Could not automatically extract pin names from the datasheet. Please enter them manually.")}}catch(D){console.error("Error fetching pin names:",D),alert(`Failed to fetch pin names: ${D instanceof Error?D.message:"Unknown error"}. Please enter pin names manually.`)}finally{z(!1)}};return l.jsxs("div",{children:[xe&&l.jsx("div",{style:{marginBottom:"4px",display:"flex",justifyContent:"flex-end"},children:l.jsx("button",{onClick:Z,disabled:$||x,style:{padding:"2px 8px",fontSize:"8px",background:$||x?"#ccc":"#4CAF50",color:"#fff",border:"none",borderRadius:"3px",cursor:$||x?"not-allowed":"pointer",opacity:x?.6:1,fontWeight:600},children:$?"Fetching...":"Fetch Pin Names"})}),l.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"8px",marginTop:"2px"},children:[l.jsx("thead",{children:l.jsxs("tr",{style:{borderBottom:"1px solid #ddd",background:"#f5f5f5"},children:[l.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"8px",color:"#333",width:"20px"}}),l.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"8px",color:"#333",width:"40px"},children:"Pin"}),xe&&l.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"8px",color:"#333",width:"70px"},children:"Pin Name"}),U&&l.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"8px",color:"#333",width:"50px"},children:"Polarity"}),l.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"8px",color:"#333"},children:"Node ID"})]})}),l.jsx("tbody",{children:Array.from({length:r.pinCount},(D,H)=>{const Y=N?.pinConnections&&N.pinConnections.length>H?N.pinConnections[H]:"",ue=N?.pinPolarities&&N.pinPolarities.length>H&&N.pinPolarities[H]||"",Ne=te&&H<te.length?te[H]:"",Pe=re&&H<re.length?re[H]:"",Ue=Pe==="CHIP_DEPENDENT",Re=Ne&&Ne.trim()!==""?Ne:Ue?"":Pe,Ke=c&&c.componentId===I.id&&c.pinIndex===H;return l.jsxs("tr",{style:{cursor:x?"not-allowed":"pointer",background:Ke?"#e6f0ff":Y?"#d4edda":"#fff",borderBottom:"1px solid #eee"},onClick:Je=>{if(Je.target.tagName!=="SELECT"){if(x){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}h(Ke?null:{componentId:I.id,pinIndex:H})}},title:Y?`Connected to: ${Y}`:"Select this pin, then click on a via or pad to connect",children:[l.jsx("td",{style:{padding:"2px 4px",textAlign:"center"},children:l.jsx("input",{id:`pin-radio-${I.id}-${H}`,name:`pin-radio-${I.id}`,type:"radio",checked:!!Ke,onChange:()=>{if(x){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}h(Ke?null:{componentId:I.id,pinIndex:H})},disabled:x,style:{margin:0,cursor:x?"not-allowed":"pointer",opacity:x?.6:1,width:"10px",height:"10px"}})}),l.jsx("td",{style:{padding:"2px 4px",color:"#333",fontWeight:Ke?600:400,fontFamily:"monospace"},children:H+1}),(ce||_e)&&l.jsx("td",{style:{padding:"2px 4px",textAlign:"left"},children:ce?l.jsx("select",{value:Re||"",onChange:Je=>{if(x){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const st=Je.target.value,Nt=(r.layer==="top"?n:s).find(pe=>pe.id===r.id);if(Nt){const St=[...Nt.pinNames||(re?[...re]:[])];for(;St.length<r.pinCount;)St.push("");St[H]=st;const Ut={...Nt,pinNames:St};r.layer==="top"?o(Lt=>Lt.map(at=>at.id===r.id?Ut:at)):d(Lt=>Lt.map(at=>at.id===r.id?Ut:at))}},disabled:x,onClick:Je=>Je.stopPropagation(),onFocus:Je=>Je.stopPropagation(),style:{padding:"2px 4px",fontSize:"8px",border:"1px solid #ddd",borderRadius:2,background:"#fff",color:"#333",cursor:x?"not-allowed":"pointer",opacity:x?.6:1,width:"100%",fontStyle:"italic",minHeight:"18px"},children:re&&re.length>0?re.filter(Je=>Je!=="CHIP_DEPENDENT").map((Je,st)=>l.jsx("option",{value:Je,children:Je},st)):l.jsx("option",{value:"",children:"-"})}):l.jsx("input",{type:"text",value:Re||"",onChange:Je=>{if(x){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const st=Je.target.value,Nt=(r.layer==="top"?n:s).find(pe=>pe.id===r.id);if(Nt){const St=[...Nt.pinNames||[]];for(;St.length<r.pinCount;)St.push("");St[H]=st;const Ut={...Nt,pinNames:St};r.layer==="top"?o(Lt=>Lt.map(at=>at.id===r.id?Ut:at)):d(Lt=>Lt.map(at=>at.id===r.id?Ut:at))}},disabled:x,onClick:Je=>Je.stopPropagation(),onFocus:Je=>Je.stopPropagation(),placeholder:"Pin name",style:{padding:"1px 2px",fontSize:"7px",border:"1px solid #ddd",borderRadius:2,background:"#fff",color:"#333",width:"100%",opacity:x?.6:1,cursor:x?"not-allowed":"text"}})}),U&&l.jsx("td",{style:{padding:"2px 4px",textAlign:"center"},children:Y?l.jsx("span",{style:{fontFamily:"monospace",fontWeight:600,color:ue==="+"?"#d32f2f":ue==="-"?"#1976d2":"#999"},children:ue||"-"}):l.jsxs("select",{value:ue??"",onChange:Je=>{if(x){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const st=Je.target.value,Nt=(r.layer==="top"?n:s).find(pe=>pe.id===r.id);if(Nt){const St=[...Nt.pinPolarities||new Array(Nt.pinCount).fill("")];for(;St.length<Nt.pinCount;)St.push("");St[H]=st;const Ut={...Nt,pinPolarities:St};r.layer==="top"?o(Lt=>Lt.map(at=>at.id===r.id?Ut:at)):d(Lt=>Lt.map(at=>at.id===r.id?Ut:at))}},disabled:x,onClick:Je=>Je.stopPropagation(),onFocus:Je=>Je.stopPropagation(),style:{padding:"1px 2px",fontSize:"8px",border:"1px solid #ddd",borderRadius:2,background:"#fff",cursor:x?"not-allowed":"pointer",opacity:x?.6:1,width:"100%",fontFamily:"monospace",fontWeight:600},children:[l.jsx("option",{value:"",children:"-"}),l.jsx("option",{value:"+",children:"+"}),l.jsx("option",{value:"-",children:"-"})]},`polarity-${I.id}-${H}-${ue}`)}),l.jsx("td",{style:{padding:"2px 4px",color:Y?"#28a745":"#999",fontWeight:Y?600:400,fontFamily:"monospace"},children:Y||"-"})]},H)})})]})]})})()]})]}),l.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"6px",padding:"6px",borderTop:"1px solid #e0e0e0",flexShrink:0},children:[l.jsx("button",{onClick:()=>{t(null),h(null)},disabled:x,style:{padding:"2px 5px",background:x?"#f5f5f5":"#fff",color:x?"#999":"#333",border:"1px solid #ddd",borderRadius:2,cursor:x?"not-allowed":"pointer",fontSize:"10px",opacity:x?.6:1},children:"Cancel"}),l.jsx("button",{onClick:G,disabled:x,style:{padding:"2px 5px",background:x?"#f5f5f5":"#0b5fff",color:x?"#999":"#fff",border:"1px solid #ddd",borderRadius:2,cursor:x?"not-allowed":"pointer",fontSize:"10px",opacity:x?.6:1},children:"Save"})]})]})};function wC(r){if(r.baseType)return r.baseType;switch(r.category){case"Capacitors":return"Capacitor";case"Diodes":return"Diode";case"Resistors":return"Resistor";case"Semiconductors":return"Semiconductor";case"Passive Components":return"Passive";case"Power & Energy":return"PowerEnergy";case"Connectors & Switches":return r.type==="Switch"||r.subcategory==="Switch"?"Switch":"Connector";case"Other":return r.type==="Transformer"?"Transformer":"Other";default:return"Other"}}const SC=i0.components,AC=SC.map(r=>{const e=`${r.category}:${r.subcategory}:${r.type}`,t=wC(r);return{...r,key:e,baseType:t}}),Pv=new Map;AC.forEach(r=>{Pv.set(r.key,r)});function TC(r){if(r)return Pv.get(r)}const Bm=r=>{const{category:e,subcategory:t,type:n,designator:s}=r;let o,d;switch(e){case"Capacitors":t==="Electrolytic"?o="Electrolytic Capacitor":t==="Film"?o="Film Capacitor":(o="Capacitor",t==="Tantalum"&&(d="Tantalum"));break;case"Diodes":o="Diode",t==="LED"?d="LED":t==="Infrared"?d="Infrared":t==="Photodiode"?d="Photodiode":t==="Schottky"?d="Schottky":t==="Zener"?d="Zener":d="Standard";break;case"Resistors":t==="Network"?(o="ResistorNetwork",d="Network"):t==="Thermistor"?(o="Thermistor",d="Thermistor"):t==="Variable"?(o="VariableResistor",d="Potentiometer"):t==="Varistor"?(o="VariableResistor",d="Varistor"):o="Resistor";break;case"Semiconductors":t==="BJT"||t==="MOSFET"||t==="JFET"?o="Transistor":o="IntegratedCircuit";break;case"Passive Components":n==="Inductor"?o="Inductor":n==="FerriteBead"?o="FerriteBead":o="Crystal";break;case"Power & Energy":t==="Battery"?o="Battery":t==="Power Supply"?o="PowerSupply":o="Fuse";break;case"Connectors & Switches":t==="Connector"?o="Connector":t==="Jumper"?o="Jumper":t==="Switch"?o="Switch":o="Relay";break;case"Other":t==="Transformer"?o="Transformer":t==="Speaker"?o="Speaker":t==="Motor"?o="Motor":t==="Test Point"?o="TestPoint":t==="Vacuum Tube"?o="VacuumTube":(o="GenericComponent",t==="Attenuator"?d="Attenuator":t==="Circuit Breaker"?d="CircuitBreaker":t==="Thermocouple"?d="Thermocouple":t==="Tuner"&&(d="Tuner"));break;default:o="GenericComponent";break}const c=`${e}:${t}:${n}:${s}`,h=`${e}:${t}:${n}`,f=TC(h);return{componentType:o,designator:s,subtype:d,uniqueKey:c,componentDefinition:r,dataDrivenDefinition:f}},Ev=Du.reduce((r,e)=>(r[e.category]||(r[e.category]=[]),r[e.category].push(e),r),{});Object.values(Ev).forEach(r=>{r.sort((e,t)=>e.displayName.localeCompare(t.displayName))});const CC=({visible:r,selectedLayer:e,selectedComponentType:t,selectedComponentKey:n,onLayerChange:s,onComponentTypeChange:o,onClose:d})=>{const[c,h]=K.useState(""),[f,m]=K.useState(null),[b,A]=K.useState(!1),v=K.useRef({x:0,y:0}),E=K.useRef(null),x=K.useRef(null);K.useEffect(()=>{r&&f===null&&m({x:window.innerWidth-400-8,y:130})},[r,f]),K.useEffect(()=>{if(r&&x.current){const F=setTimeout(()=>{x.current?.focus(),x.current?.select()},100);return()=>clearTimeout(F)}},[r]);const k=K.useCallback(F=>{const I=F.target;if(!(I.tagName==="BUTTON"||I.tagName==="INPUT"||I.closest("button")||I.closest("input"))&&E.current){const X=E.current.getBoundingClientRect();v.current={x:F.clientX-X.left,y:F.clientY-X.top},A(!0),F.preventDefault()}},[]);K.useEffect(()=>{if(!b)return;const F=X=>{const M=X.clientX-v.current.x,G=X.clientY-v.current.y,U=E.current?.offsetWidth||400,_=E.current?.offsetHeight||600,N=Math.max(0,Math.min(M,window.innerWidth-U)),te=Math.max(0,Math.min(G,window.innerHeight-_));m({x:N,y:te})},I=()=>{A(!1)};return document.addEventListener("mousemove",F),document.addEventListener("mouseup",I),()=>{document.removeEventListener("mousemove",F),document.removeEventListener("mouseup",I)}},[b]);const j=K.useMemo(()=>{if(!c.trim())return()=>!0;const F=c.toLowerCase();return I=>!!(I.searchText&&I.searchText.toLowerCase().includes(F)||I.displayName&&I.displayName.toLowerCase().includes(F)||I.description&&I.description.toLowerCase().includes(F)||I.category&&I.category.toLowerCase().includes(F)||I.subcategory&&I.subcategory.toLowerCase().includes(F)||I.designator&&I.designator.toLowerCase().includes(F)||I.type&&I.type.toLowerCase().includes(F)||I.resolvedTypeName&&I.resolvedTypeName.toLowerCase().includes(F))},[c]),$=K.useMemo(()=>c.trim()?Du.filter(F=>{const I=Bm(F);return j({category:F.category,type:I.componentType,subcategory:F.subcategory,designator:F.designator,displayName:F.displayName,description:F.description,resolvedTypeName:yc(I.componentType),searchText:F.searchText})}):Du,[c,j]);if(!r)return null;const z={position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"flex-start",justifyContent:"flex-end",zIndex:10005,pointerEvents:"none"},B={padding:"20px",overflow:"auto",flex:1};return l.jsx("div",{style:z,onClick:F=>F.stopPropagation(),children:l.jsxs("div",{ref:E,onClick:F=>F.stopPropagation(),style:{position:"fixed",top:f?`${f.y}px`:void 0,left:f?`${f.x}px`:void 0,backgroundColor:"#fff",borderRadius:8,minWidth:"300px",maxWidth:"400px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:10005,display:"flex",flexDirection:"column",pointerEvents:"auto",transform:"none"},children:[l.jsxs("div",{onMouseDown:k,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:b?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[l.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Select Component"}),l.jsx("button",{type:"button",onMouseDown:F=>{F.stopPropagation()},onClick:F=>{F.stopPropagation(),d()},style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),l.jsxs("div",{style:B,children:[l.jsx("div",{style:{marginBottom:"16px"},onClick:F=>F.stopPropagation(),children:l.jsx("input",{ref:x,type:"text",placeholder:"Search by Component Type...",value:c,onChange:F=>h(F.target.value),onClick:F=>F.stopPropagation(),onMouseDown:F=>F.stopPropagation(),style:{width:"100%",padding:"8px 12px",fontSize:"13px",border:"1px solid #ddd",borderRadius:4,color:"#333",backgroundColor:"#fff",boxSizing:"border-box"}})}),l.jsxs("div",{style:{marginBottom:"20px",paddingBottom:"16px",borderBottom:"2px solid #eee"},onClick:F=>F.stopPropagation(),children:[l.jsx("div",{style:{marginBottom:"8px",fontSize:"14px",fontWeight:600,color:"#333"},children:"Layer:"}),l.jsxs("div",{style:{display:"flex",gap:"16px"},children:[l.jsxs("label",{onClick:F=>F.stopPropagation(),onMouseDown:F=>F.stopPropagation(),style:{display:"flex",alignItems:"center",cursor:"pointer",fontSize:"14px",color:"#333"},children:[l.jsx("input",{type:"radio",name:"componentLayer",checked:e==="top",onChange:()=>s("top"),onClick:F=>F.stopPropagation(),onMouseDown:F=>F.stopPropagation(),style:{marginRight:"8px",width:"20px",height:"20px",cursor:"pointer",accentColor:"#0066cc",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",border:e==="top"?"2px solid #0066cc":"2px solid #999",borderRadius:"50%",backgroundColor:e==="top"?"#0066cc":"transparent",position:"relative"}}),"Top"]}),l.jsxs("label",{onClick:F=>F.stopPropagation(),onMouseDown:F=>F.stopPropagation(),style:{display:"flex",alignItems:"center",cursor:"pointer",fontSize:"14px",color:"#333"},children:[l.jsx("input",{type:"radio",name:"componentLayer",checked:e==="bottom",onChange:()=>s("bottom"),onClick:F=>F.stopPropagation(),onMouseDown:F=>F.stopPropagation(),style:{marginRight:"8px",width:"20px",height:"20px",cursor:"pointer",accentColor:"#0066cc",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",border:e==="bottom"?"2px solid #0066cc":"2px solid #999",borderRadius:"50%",backgroundColor:e==="bottom"?"#0066cc":"transparent",position:"relative"}}),"Bottom"]})]})]}),l.jsxs("div",{children:[l.jsx("div",{style:{marginBottom:"12px",fontSize:"14px",fontWeight:600,color:"#333"},children:"Component Type:"}),l.jsx("div",{style:{maxHeight:"calc(80vh - 280px)",overflowY:"auto"},children:c.trim()?$.length>0?$.map(F=>{const I=Bm(F),X=I.uniqueKey||`${F.category}:${F.subcategory}:${F.type}:${F.designator}`,M=n===X,G=`${F.designator} - ${F.displayName}`;return l.jsxs("label",{onClick:U=>{U.stopPropagation(),o(I.componentType,X,I)},onMouseDown:U=>U.stopPropagation(),style:{display:"block",width:"100%",textAlign:"left",padding:"8px 12px",marginBottom:"4px",background:M?"#e6f0ff":"#fff",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",fontSize:"12px",color:"#333"},children:[l.jsx("input",{type:"radio",name:"componentType-search",checked:M,onChange:()=>o(I.componentType,X,I),onClick:U=>U.stopPropagation(),onMouseDown:U=>U.stopPropagation(),style:{marginRight:"10px",width:"20px",height:"20px",cursor:"pointer",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",border:M?"2px solid #0066cc":"2px solid #999",borderRadius:"50%",backgroundColor:M?"#0066cc":"transparent",position:"relative",flexShrink:0}}),l.jsx("strong",{children:G})]},X)}):l.jsxs("div",{style:{padding:"12px",color:"#666",fontSize:"12px",textAlign:"center"},children:['No matches found for "',c,'"']}):Object.entries(Ev).map(([F,I])=>I.length===0?null:l.jsxs("div",{style:{marginBottom:"12px"},children:[l.jsx("div",{style:{fontSize:"13px",fontWeight:600,color:"#333",padding:"6px 8px",marginBottom:"4px",backgroundColor:"#f5f5f5",borderRadius:4},children:F}),l.jsx("div",{style:{marginLeft:"8px"},children:I.map(X=>{const M=Bm(X),G=M.uniqueKey||`${X.category}:${X.subcategory}:${X.type}:${X.designator}`,U=n===G,_=`${X.designator} - ${X.displayName}`;return l.jsxs("label",{onClick:N=>{N.stopPropagation(),o(M.componentType,G,M)},onMouseDown:N=>N.stopPropagation(),style:{display:"block",width:"100%",textAlign:"left",padding:"6px 12px",marginBottom:"2px",background:U?"#e6f0ff":"#fff",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",fontSize:"12px",color:"#333"},children:[l.jsx("input",{type:"radio",name:`componentType-${F}`,checked:U,onChange:()=>o(M.componentType,G,M),onMouseDown:N=>N.stopPropagation(),style:{marginRight:"10px",width:"20px",height:"20px",cursor:"pointer",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",border:U?"2px solid #0066cc":"2px solid #999",borderRadius:"50%",backgroundColor:U?"#0066cc":"transparent",position:"relative",flexShrink:0}}),_]},G)})})]},F))})]})]})]})})},_C=({visible:r,onClose:e,powerBuses:t,setPowerBuses:n,editingPowerBusId:s,setEditingPowerBusId:o,powers:d})=>{const[c,h]=K.useState(null),[f,m]=K.useState(!1),[b,A]=K.useState(null),v=K.useRef(null);K.useEffect(()=>{r&&!c&&h({x:window.innerWidth/2-140,y:window.innerHeight/2-200})},[r,c]),K.useEffect(()=>{if(!f)return;const B=I=>{c&&b&&h({x:I.clientX-b.x,y:I.clientY-b.y})},F=()=>{m(!1),A(null)};return window.addEventListener("mousemove",B),window.addEventListener("mouseup",F),()=>{window.removeEventListener("mousemove",B),window.removeEventListener("mouseup",F)}},[f,c,b]);const E=t.filter(B=>B.id!==s),x=t.find(B=>B.id===s);if(!r)return null;const k=[...E].sort((B,F)=>{const I=G=>{const U=G.match(/([+-]?)(\d+\.?\d*)/);if(U){const _=U[1]||"+",N=parseFloat(U[2]);return{absValue:Math.abs(N),isNegative:_==="-"}}return{absValue:1/0,isNegative:!1}},X=I(B.voltage),M=I(F.voltage);return X.absValue!==M.absValue?X.absValue-M.absValue:X.isNegative!==M.isNegative?X.isNegative?-1:1:0}),j=x?[...k,x]:k,$=()=>{const B={id:`powerbus-${Date.now()}-${Math.random()}`,name:"New Power Bus",voltage:"+0.0",color:"#ff0000"};n(F=>[...F,B]),o(B.id)},z=B=>{const F=B.target;F.tagName==="BUTTON"||F.tagName==="INPUT"||F.closest("button")||F.closest("input")||c&&(A({x:B.clientX-c.x,y:B.clientY-c.y}),m(!0),B.preventDefault())};return l.jsxs("div",{ref:v,style:{position:"fixed",top:c?`${c.y}px`:"50%",left:c?`${c.x}px`:"50%",transform:c?"none":"translate(-50%, -50%)",background:"#fff",border:"1px solid #0b5fff",borderRadius:4,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"280px",maxWidth:"320px",maxHeight:"80vh",display:"flex",flexDirection:"column",cursor:f?"grabbing":"default"},children:[l.jsxs("div",{onMouseDown:z,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:f?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[l.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Manage Power Buses"}),l.jsx("button",{onClick:e,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"6px 20px 6px 6px",overflowY:"auto",flex:1,minHeight:0},children:j.map(B=>{const F=t.find(G=>G.id===B.id)||B,I=t.findIndex(G=>G.id===B.id),X=t.some(G=>G.name===F.name&&G.id!==B.id),M=t.some(G=>G.voltage===F.voltage&&G.id!==B.id);return l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"4px",marginBottom:"4px",background:"#f9f9f9",borderRadius:4,border:"1px solid #e0e0e0"},children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsxs("div",{style:{flex:1,minWidth:0,display:"flex",flexDirection:"column",gap:"4px"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"50px",flexShrink:0},children:"Name:"}),l.jsx("input",{type:"text",value:F.name,onChange:G=>{const U=G.target.value;if(!t.some(N=>N.name===U&&N.id!==B.id)){const N=[...t];I>=0&&(N[I]={...F,name:U},n(N))}},placeholder:"e.g., +5VDC",style:{flex:1,padding:"2px 3px",border:X?"1px solid #ff0000":"1px solid #ddd",borderRadius:2,fontSize:"10px",background:"#f5f5f5",color:"#000"}})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"50px",flexShrink:0},children:"Value:"}),l.jsx("input",{type:"text",inputMode:"decimal",value:F.voltage,onChange:G=>{const U=G.target.value;if(U===""||/^[+-]?\d*\.?\d*$/.test(U)){const _=[...t];I>=0&&(_[I]={...F,voltage:U},n(_))}},onBlur:G=>{const U=G.target.value.trim();if(U==="")return;const _=parseFloat(U);if(!isNaN(_)){const N=_>=0?"+":"-",te=Math.abs(_),ie=`${N}${te.toFixed(1).replace(/\.?0+$/,"")}`,re=[...t];I>=0&&(re[I]={...F,voltage:ie},n(re))}},placeholder:"e.g., +5.0",style:{flex:1,padding:"2px 3px",border:M?"1px solid #ff0000":"1px solid #ddd",borderRadius:2,fontSize:"10px",background:"#f5f5f5",color:"#000"}})]})]}),l.jsx("input",{type:"color",value:F.color,onChange:G=>{const U=[...t];I>=0&&(U[I]={...F,color:G.target.value},n(U))},style:{width:"24px",height:"24px",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",flexShrink:0},title:"Color"}),l.jsx("button",{onClick:()=>{const G=d.filter(U=>U.powerBusId===B.id);if(G.length>0){alert(`Cannot delete: ${G.length} power node(s) are using this bus. Remove or reassign them first.`);return}n(U=>U.filter(_=>_.id!==B.id))},style:{padding:"2px 6px",background:"#f5f5f5",color:"#333",border:"1px solid #ddd",borderRadius:2,cursor:"pointer",fontSize:"9px",flexShrink:0},children:"Delete"})]})},B.id)})}),l.jsxs("div",{style:{padding:"6px",borderTop:"1px solid #e0e0e0",display:"flex",gap:"4px",flexShrink:0},children:[l.jsx("button",{onClick:$,style:{flex:1,padding:"4px 8px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",fontSize:"10px"},children:"+ Add Power Bus"}),l.jsx("button",{onClick:e,style:{flex:1,padding:"4px 8px",background:"#0b5fff",color:"#fff",border:"none",borderRadius:2,cursor:"pointer",fontSize:"10px",fontWeight:500},children:"Close"})]})]})},kC=({visible:r,onClose:e,groundBuses:t,setGroundBuses:n,editingGroundBusId:s,setEditingGroundBusId:o,grounds:d})=>{const[c,h]=K.useState(null),[f,m]=K.useState(!1),[b,A]=K.useState(null),v=K.useRef(null);K.useEffect(()=>{r&&!c&&h({x:window.innerWidth/2-140,y:window.innerHeight/2-200})},[r,c]),K.useEffect(()=>{if(!f)return;const B=I=>{c&&b&&h({x:I.clientX-b.x,y:I.clientY-b.y})},F=()=>{m(!1),A(null)};return window.addEventListener("mousemove",B),window.addEventListener("mouseup",F),()=>{window.removeEventListener("mousemove",B),window.removeEventListener("mouseup",F)}},[f,c,b]);const E=t.filter(B=>B.id!==s),x=t.find(B=>B.id===s);if(!r)return null;const k=[...E].sort((B,F)=>B.name.localeCompare(F.name)),j=x?[...k,x]:k,$=()=>{const B={id:`groundbus-${Date.now()}-${Math.random()}`,name:"New Ground Bus",color:"#000000"};n(F=>[...F,B]),o(B.id)},z=B=>{const F=B.target;F.tagName==="BUTTON"||F.tagName==="INPUT"||F.closest("button")||F.closest("input")||c&&(A({x:B.clientX-c.x,y:B.clientY-c.y}),m(!0),B.preventDefault())};return l.jsxs("div",{ref:v,style:{position:"fixed",top:c?`${c.y}px`:"50%",left:c?`${c.x}px`:"50%",transform:c?"none":"translate(-50%, -50%)",background:"#fff",border:"1px solid #0b5fff",borderRadius:4,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"280px",maxWidth:"320px",maxHeight:"80vh",display:"flex",flexDirection:"column",cursor:f?"grabbing":"default"},children:[l.jsxs("div",{onMouseDown:z,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:f?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[l.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Manage Ground Buses"}),l.jsx("button",{onClick:e,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"6px 20px 6px 6px",overflowY:"auto",flex:1,minHeight:0},children:j.map(B=>{const F=t.find(M=>M.id===B.id)||B,I=t.findIndex(M=>M.id===B.id),X=t.some(M=>M.name===F.name&&M.id!==B.id);return l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",padding:"4px",marginBottom:"4px",background:"#f9f9f9",borderRadius:4,border:"1px solid #e0e0e0"},children:[l.jsx("div",{style:{flex:1,minWidth:0},children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[l.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"50px",flexShrink:0},children:"Name:"}),l.jsx("input",{type:"text",value:F.name,onChange:M=>{const G=M.target.value;if(!t.some(_=>_.name===G&&_.id!==B.id)){const _=[...t];I>=0&&(_[I]={...F,name:G},n(_))}},placeholder:"e.g., GND, Earth",style:{flex:1,padding:"2px 3px",border:X?"1px solid #ff0000":"1px solid #ddd",borderRadius:2,fontSize:"10px",background:"#f5f5f5",color:"#000"}})]})}),l.jsx("input",{type:"color",value:F.color,onChange:M=>{const G=[...t];I>=0&&(G[I]={...F,color:M.target.value},n(G))},style:{width:"24px",height:"24px",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",flexShrink:0},title:"Color"}),l.jsx("button",{onClick:()=>{const M=d.filter(G=>G.groundBusId===B.id);if(M.length>0){alert(`Cannot delete: ${M.length} ground node(s) are using this bus. Remove or reassign them first.`);return}n(G=>G.filter(U=>U.id!==B.id))},style:{padding:"2px 6px",background:"#f5f5f5",color:"#333",border:"1px solid #ddd",borderRadius:2,cursor:"pointer",fontSize:"9px",flexShrink:0},children:"Delete"})]},B.id)})}),l.jsxs("div",{style:{padding:"6px",borderTop:"1px solid #e0e0e0",display:"flex",gap:"4px",flexShrink:0},children:[l.jsx("button",{onClick:$,style:{flex:1,padding:"4px 8px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",fontSize:"10px"},children:"+ Add Ground Bus"}),l.jsx("button",{onClick:e,style:{flex:1,padding:"4px 8px",background:"#0b5fff",color:"#fff",border:"none",borderRadius:2,cursor:"pointer",fontSize:"10px",fontWeight:500},children:"Close"})]})]})},jC=({visible:r,onClose:e,autoAssignDesignators:t,setAutoAssignDesignators:n,useGlobalDesignatorCounters:s,setUseGlobalDesignatorCounters:o})=>r?l.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#fff",border:"1px solid #ddd",borderRadius:6,padding:"16px",zIndex:1e3,minWidth:"300px",maxWidth:"400px",boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[l.jsx("h2",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#222"},children:"Manage Designators"}),l.jsx("button",{onClick:e,style:{background:"transparent",border:"none",fontSize:"18px",cursor:"pointer",color:"#666",padding:0,width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),l.jsxs("div",{style:{marginBottom:"16px"},children:[l.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:"13px",color:"#333",marginBottom:"12px"},children:[l.jsx("input",{type:"checkbox",checked:t,onChange:d=>{n(d.target.checked)},style:{width:"16px",height:"16px",cursor:"pointer"}}),l.jsx("span",{children:"Automatically assign designators"})]}),l.jsx("div",{style:{marginTop:"8px",padding:"8px",background:"#f5f5f5",borderRadius:4,fontSize:"11px",color:"#666",lineHeight:"1.4",marginBottom:"12px"},children:t?l.jsx("div",{children:"When enabled, new components automatically receive sequential designators (e.g., C1, C2, C3 for Capacitors; R1, R2, R3 for Resistors)."}):l.jsx("div",{children:"When disabled, you must manually assign designators to each component. The designator field will be empty when components are created."})}),l.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:"13px",color:"#333"},children:[l.jsx("input",{type:"checkbox",checked:s,onChange:d=>{o(d.target.checked)},style:{width:"16px",height:"16px",cursor:"pointer"}}),l.jsx("span",{children:"Use global designator counters"})]}),l.jsx("div",{style:{marginTop:"8px",padding:"8px",background:"#f5f5f5",borderRadius:4,fontSize:"11px",color:"#666",lineHeight:"1.4"},children:s?l.jsx("div",{children:"When ON, designators continue from global counters across all projects. New components start with the next value from the global counter (e.g., if global counter is C10, new capacitor will be C11)."}):l.jsx("div",{children:"When OFF (default), designators start at 1 for each project. Each project maintains its own independent designator sequence (e.g., C1, C2, C3...)."})})]}),l.jsx("button",{onClick:e,style:{width:"100%",padding:"6px 12px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:4,cursor:"pointer",fontSize:"12px"},children:"Close"})]}):null,Zb=({visible:r,title:e,message:t,onYes:n,onNo:s,onCancel:o,yesButtonRef:d})=>r?l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001},onClick:c=>{c.target===c.currentTarget&&o()},children:l.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:c=>c.stopPropagation(),children:[l.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:e}),l.jsx("p",{style:{margin:"0 0 24px 0",fontSize:"14px",color:"#e0e0e0",lineHeight:"1.5"},children:t}),l.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[l.jsx("button",{onClick:o,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),l.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"No"}),l.jsx("button",{ref:d,onClick:n,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},autoFocus:!0,children:"Yes"})]})]})}):null,NC=({visible:r,size:e,onSizeChange:t,onApply:n,onCancel:s})=>{const o=K.useRef(null);if(K.useEffect(()=>{r&&o.current&&(o.current.focus(),o.current.select())},[r]),!r)return null;const d=[2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32];return l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10003},onClick:c=>{c.target===c.currentTarget&&s()},children:l.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:c=>c.stopPropagation(),children:[l.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Set Size"}),l.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Size (pixels):"}),l.jsx("input",{ref:o,type:"number",min:"1",max:"99",value:e,onChange:c=>{const h=parseInt(c.target.value)||1,f=Math.max(1,Math.min(99,h));t(f)},onKeyDown:c=>{if(c.key==="Enter"?n():c.key==="Escape"&&s(),c.key.length===1&&/[0-9]/.test(c.key)){const h=e.toString();h.length>=2&&o.current?.selectionStart===o.current?.selectionEnd&&o.current?.selectionStart===h.length&&c.preventDefault()}},onInput:c=>{const h=c.target,f=h.value;if(f.length>2){h.value=f.slice(0,2);const m=parseInt(h.value)||1;t(Math.max(1,Math.min(99,m)))}},style:{width:"100%",padding:"8px 12px",marginBottom:"16px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0}),l.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Or select from list:"}),l.jsxs("select",{value:d.includes(e)?e:"",onChange:c=>{const h=parseInt(c.target.value);!isNaN(h)&&h>0&&t(h)},style:{width:"100%",padding:"8px 12px",marginBottom:"20px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},children:[l.jsx("option",{value:"",style:{background:"#1f1f24",color:"#f2f2f2"},children:"-- Select --"}),d.map(c=>l.jsxs("option",{value:c,style:{background:"#1f1f24",color:"#f2f2f2"},children:[c," pixels"]},c))]}),l.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[l.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),l.jsx("button",{onClick:n,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Apply"})]})]})})},PC=({visible:r,interval:e,onIntervalChange:t,onApply:n,onCancel:s})=>r?l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10003},onClick:o=>{o.target===o.currentTarget&&s()},children:l.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:o=>o.stopPropagation(),children:[l.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Auto Save"}),l.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Select time interval:"}),l.jsxs("select",{value:e===null?"disable":(e||5).toString(),onChange:o=>{const d=o.target.value;if(d==="disable")t(null);else{const c=parseFloat(d);!isNaN(c)&&c>0&&t(c)}},style:{width:"100%",padding:"8px 12px",marginBottom:"20px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0,children:[l.jsx("option",{value:"1",style:{background:"#1f1f24",color:"#f2f2f2"},children:"1 minute"}),l.jsx("option",{value:"5",style:{background:"#1f1f24",color:"#f2f2f2"},children:"5 minutes"}),l.jsx("option",{value:"10",style:{background:"#1f1f24",color:"#f2f2f2"},children:"10 minutes"}),l.jsx("option",{value:"20",style:{background:"#1f1f24",color:"#f2f2f2"},children:"20 minutes"}),l.jsx("option",{value:"30",style:{background:"#1f1f24",color:"#f2f2f2"},children:"30 minutes"}),l.jsx("option",{value:"disable",style:{background:"#1f1f24",color:"#f2f2f2"},children:"Disable"})]}),l.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[l.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),l.jsx("button",{onClick:n,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Apply"})]})]})}):null,EC=({visible:r,interval:e,onIntervalChange:t,onEnable:n,onSkip:s})=>r?l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:o=>{o.target===o.currentTarget&&s()},children:l.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:o=>o.stopPropagation(),children:[l.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Enable Auto Save?"}),l.jsx("p",{style:{margin:"0 0 20px 0",fontSize:"14px",color:"#e0e0e0",lineHeight:"1.5"},children:"We recommend enabling Auto Save to automatically save your project at regular intervals. This helps protect your work from accidental loss."}),l.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Select time interval:"}),l.jsxs("select",{value:e===null?"disable":(e||5).toString(),onChange:o=>{const d=o.target.value;if(d==="disable")t(null);else{const c=parseFloat(d);!isNaN(c)&&c>0&&t(c)}},style:{width:"100%",padding:"8px 12px",marginBottom:"24px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0,children:[l.jsx("option",{value:"1",style:{background:"#1f1f24",color:"#f2f2f2"},children:"1 minute"}),l.jsx("option",{value:"5",style:{background:"#1f1f24",color:"#f2f2f2"},children:"5 minutes"}),l.jsx("option",{value:"10",style:{background:"#1f1f24",color:"#f2f2f2"},children:"10 minutes"}),l.jsx("option",{value:"20",style:{background:"#1f1f24",color:"#f2f2f2"},children:"20 minutes"}),l.jsx("option",{value:"30",style:{background:"#1f1f24",color:"#f2f2f2"},children:"30 minutes"})]}),l.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[l.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Skip"}),l.jsx("button",{onClick:n,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Enable Auto Save"})]})]})}):null,RC=({visible:r,projectDirHandle:e,onClose:t,onRestore:n,position:s,isDragging:o=!1,onDragStart:d})=>{const[c,h]=K.useState([]),[f,m]=K.useState(!1),[b,A]=K.useState(null),[v,E]=K.useState(null),x=K.useRef(null);K.useEffect(()=>{if(!r||!e){h([]),A(null),E(null);return}(async()=>{m(!0),E(null);try{let F;try{F=await e.getDirectoryHandle("history")}catch{h([]),m(!1);return}const I=M=>{const G=M.match(/_(\d{4})_(\d{2})_(\d{2})-(\d{2})-(\d{2})-(\d{2})\.json$/);if(G){const[,_,N,te,ie,re,q]=G;return new Date(parseInt(_),parseInt(N)-1,parseInt(te),parseInt(ie),parseInt(re),parseInt(q))}const U=M.match(/_(\d{4})_(\d{2})_(\d{2})_(\d{2})_(\d{2})_(\d{2})\.json$/);if(U){const[,_,N,te,ie,re,q]=U;return new Date(parseInt(_),parseInt(N)-1,parseInt(te),parseInt(ie),parseInt(re),parseInt(q))}return null},X=[];for await(const M of F.keys())if(M.endsWith(".json"))try{const U=await(await F.getFileHandle(M)).getFile(),_=I(M);X.push({name:M,lastModified:new Date(U.lastModified),size:U.size,timestamp:_||new Date(U.lastModified)})}catch(G){console.warn(`Failed to read file ${M}:`,G)}X.sort((M,G)=>G.timestamp.getTime()-M.timestamp.getTime()),h(X)}catch(F){console.error("Failed to load history files:",F),E("Failed to load history files. Please try again.")}finally{m(!1)}})()},[r,e]);const k=async()=>{if(b)try{await n(b),t()}catch(B){console.error("Failed to restore file:",B),E("Failed to restore file. Please try again.")}},j=B=>B.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),$=B=>B<1024?`${B} B`:B<1024*1024?`${(B/1024).toFixed(1)} KB`:`${(B/(1024*1024)).toFixed(1)} MB`;if(!r)return null;const z=s?{position:"fixed",left:`${s.x}px`,top:`${s.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"500px",maxWidth:"700px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:o?"grabbing":"default"}:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"#fff",borderRadius:8,minWidth:"500px",maxWidth:"700px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column"};return l.jsxs("div",{style:z,children:[l.jsxs("div",{onMouseDown:d,style:{backgroundColor:"#f5f5f5",padding:"12px 16px",borderBottom:"1px solid #ddd",borderRadius:"8px 8px 0 0",cursor:o?"grabbing":"move",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[l.jsx("h2",{style:{margin:0,fontSize:"16px",fontWeight:600,color:"#000"},children:"PastTime"}),l.jsx("button",{onClick:t,style:{background:"transparent",border:"none",fontSize:"20px",cursor:"pointer",color:"#666",padding:"0 4px",lineHeight:1},title:"Close",children:""})]}),l.jsxs("div",{style:{padding:"16px",display:"flex",flexDirection:"column",flex:1,minHeight:0},children:[v&&l.jsx("div",{style:{padding:"12px",backgroundColor:"#fee",color:"#c00",borderRadius:4,marginBottom:"12px"},children:v}),f?l.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"Loading history files..."}):c.length===0?l.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"No history files found."}):l.jsxs(l.Fragment,{children:[l.jsx("div",{style:{marginBottom:"12px",color:"#333",fontSize:"14px"},children:"Select a file to restore:"}),l.jsx("div",{ref:x,style:{border:"1px solid #ddd",borderRadius:4,overflowY:"auto",maxHeight:"400px",backgroundColor:"#fafafa"},children:c.map((B,F)=>l.jsxs("div",{onClick:()=>A(B.name),style:{padding:"12px 16px",borderBottom:F<c.length-1?"1px solid #eee":"none",backgroundColor:b===B.name?"#e6f0ff":"transparent",cursor:"pointer",transition:"background-color 0.1s"},onMouseEnter:I=>{b!==B.name&&(I.currentTarget.style.backgroundColor="#f5f5f5")},onMouseLeave:I=>{b!==B.name&&(I.currentTarget.style.backgroundColor="transparent")},children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"4px"},children:[l.jsx("div",{style:{fontWeight:600,color:"#000",fontSize:"13px",wordBreak:"break-word",flex:1},children:B.name}),l.jsx("div",{style:{color:"#666",fontSize:"12px",marginLeft:"12px",whiteSpace:"nowrap"},children:$(B.size)})]}),l.jsx("div",{style:{color:"#666",fontSize:"12px"},children:j(B.lastModified)})]},B.name))})]})]}),l.jsxs("div",{style:{padding:"12px 16px",borderTop:"1px solid #ddd",display:"flex",justifyContent:"flex-end",gap:"8px"},children:[l.jsx("button",{onClick:t,style:{padding:"6px 16px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"13px"},children:"Cancel"}),l.jsx("button",{onClick:k,disabled:!b||f,style:{padding:"6px 16px",background:b&&!f?"#0066cc":"#ccc",border:"none",borderRadius:4,cursor:b&&!f?"pointer":"not-allowed",color:"#fff",fontSize:"13px",fontWeight:500},children:"Restore"})]})]})},DC=({visible:r,isPad:e,onConfirm:t,onClose:n})=>{const[s,o]=K.useState("linear"),[d,c]=K.useState("vertical-edges"),[h,f]=K.useState(8),[m,b]=K.useState("");K.useEffect(()=>{r&&(o("linear"),c("vertical-edges"),f(8),b(""))},[r]);const A=()=>{let v="";if(h<1?v="Number of pins must be >= 1.":s==="twoSided"&&h%2!==0?v="2-sided components must have an even number of pins.":s==="fourSided"&&h%4!==0&&(v="4-sided components must have N divisible by 4."),v){b(v);return}b(""),t({numPins:h,type:s,...s==="twoSided"?{twoSidedOrientation:d}:{}})};return r?l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},onClick:v=>{v.target===v.currentTarget&&n()},children:l.jsxs("div",{style:{backgroundColor:"#fff",padding:"20px",borderRadius:"8px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},onClick:v=>v.stopPropagation(),children:[l.jsxs("h2",{style:{marginTop:0,marginBottom:"20px",color:"#222"},children:[e?"Pad Pattern":"Via Pattern"," Placement"]}),l.jsxs("div",{style:{marginBottom:"15px"},children:[l.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#222",fontWeight:500},children:"Arrangement:"}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[l.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[l.jsx("input",{type:"radio",value:"linear",checked:s==="linear",onChange:v=>o(v.target.value),style:{marginRight:"8px"}}),l.jsx("span",{style:{color:"#222"},children:"Linear (1 side)"})]}),l.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[l.jsx("input",{type:"radio",value:"twoSided",checked:s==="twoSided",onChange:v=>o(v.target.value),style:{marginRight:"8px"}}),l.jsx("span",{style:{color:"#222"},children:"2-Sided"})]}),l.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[l.jsx("input",{type:"radio",value:"fourSided",checked:s==="fourSided",onChange:v=>o(v.target.value),style:{marginRight:"8px"}}),l.jsx("span",{style:{color:"#222"},children:"4-Sided"})]})]})]}),s==="twoSided"&&l.jsxs("div",{style:{marginBottom:"15px"},children:[l.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#222",fontWeight:500},children:"Orientation:"}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[l.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[l.jsx("input",{type:"radio",value:"vertical-edges",checked:d==="vertical-edges",onChange:v=>c(v.target.value),style:{marginRight:"8px"}}),l.jsxs("span",{style:{color:"#222"},children:["Vertical ",e?"Pads":"Vias"," (left & right)"]})]}),l.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[l.jsx("input",{type:"radio",value:"horizontal-edges",checked:d==="horizontal-edges",onChange:v=>c(v.target.value),style:{marginRight:"8px"}}),l.jsxs("span",{style:{color:"#222"},children:["Horizontal ",e?"Pads":"Vias"," (top & bottom)"]})]})]})]}),l.jsxs("div",{style:{marginBottom:"15px"},children:[l.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#222",fontWeight:500},children:"Number of Pins:"}),l.jsx("input",{type:"number",min:"1",value:h,onChange:v=>{const E=parseInt(v.target.value,10);isNaN(E)||(f(E),b(""))},style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px",color:"#000",background:"#fff"}}),m&&l.jsx("div",{style:{color:"#d32f2f",fontSize:"12px",marginTop:"4px"},children:m})]}),l.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",marginTop:"20px"},children:[l.jsx("button",{onClick:n,style:{padding:"8px 16px",background:"#f5f5f5",color:"#222",border:"1px solid #ddd",borderRadius:"4px",cursor:"pointer",fontSize:"14px"},children:"Cancel"}),l.jsx("button",{onClick:A,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px",fontWeight:500},children:"OK"})]})]})}):null};function LC(r,e){const t={x:r.x,y:r.y},n={x:e.x,y:e.y},s={x:n.x,y:t.y},o={x:t.x,y:n.y};return{corner1:t,corner2:s,corner3:n,corner4:o}}function MC(r){if(r.numPins<1)throw new Error("Number of pins must be >= 1.");if(r.type==="twoSided"){if(r.numPins%2!==0)throw new Error("2-sided components must have an even number of pins.");if(!r.twoSidedOrientation)throw new Error("Orientation required for 2-sided components.")}if(r.type==="fourSided"&&r.numPins%4!==0)throw new Error("4-sided components must have N divisible by 4.");if(Math.abs(r.point1.x-r.point2.x)<.001||Math.abs(r.point1.y-r.point2.y)<.001)throw new Error("Area must have non-zero width and height.")}function zC(r,e){const t=[],{corner1:n,corner2:s,corner3:o,corner4:d}=e,c=Math.abs(s.x-n.x),h=Math.abs(o.y-s.y);if(c>h){const f=(n.y+d.y)/2,m=Math.min(n.x,s.x),b=Math.max(n.x,s.x),A=b-m,v=r.numPins>1?A/(r.numPins-1):0,E=Math.hypot(n.x-m,n.y-f),x=Math.hypot(n.x-b,n.y-f),k=E<x;if(r.numPins===1)t.push({pinNumber:1,x:(m+b)/2,y:f});else for(let j=1;j<=r.numPins;j++){const $=k?m+(j-1)*v:b-(j-1)*v;t.push({pinNumber:j,x:$,y:f})}}else{const f=(n.x+s.x)/2,m=Math.min(n.y,s.y),b=Math.max(o.y,d.y),A=b-m,v=r.numPins>1?A/(r.numPins-1):0,E=Math.hypot(n.x-f,n.y-m),x=Math.hypot(n.x-f,n.y-b),k=E<x;if(r.numPins===1)t.push({pinNumber:1,x:f,y:(m+b)/2});else for(let j=1;j<=r.numPins;j++){const $=k?m+(j-1)*v:b-(j-1)*v;t.push({pinNumber:j,x:f,y:$})}}return t}function IC(r,e){const t=[],{corner1:n,corner2:s,corner3:o,corner4:d}=e,c=r.type==="fourSided"?r.numPins/4:r.numPins/2,h=Math.min(n.x,s.x,o.x,d.x),f=Math.min(n.y,s.y,o.y,d.y),m=Math.abs(n.y-f)<.001,b=Math.abs(n.x-h)<.001,A=m?b?"TopLeft":"TopRight":b?"BottomLeft":"BottomRight",v=Math.max(n.x,s.x,o.x,d.x),E=Math.max(n.y,s.y,o.y,d.y),x=(N,te,ie=.001)=>{const re=[n,s,o,d];for(const q of re)if(Math.abs(q.x-N)<ie&&Math.abs(q.y-te)<ie)return q;return null},k=x(h,f)||n,j=x(v,f)||s,$=x(v,E)||o,z=x(h,E)||d,B={start:k,end:z,name:"Left",direction:"Down"},F={start:z,end:$,name:"Bottom",direction:"Right"},I={start:$,end:j,name:"Right",direction:"Up"},X={start:j,end:k,name:"Top",direction:"Left"};let M;const G=[];if(A==="TopLeft"?(M=B,G.push(B,F,I,X)):A==="BottomLeft"?(M=F,G.push(F,I,X,B)):A==="BottomRight"?(M=I,G.push(I,X,B,F)):(M=X,G.push(X,B,F,I)),r.type==="twoSided"){if(r.twoSidedOrientation==="vertical-edges"){if(A!=="TopLeft"&&A!=="BottomRight")throw new Error(`Invalid Pin 1 location for Left/Right orientation. Pin 1 is at ${A}, but must be at Top-Left or Bottom-Right.`)}else if(A!=="TopRight"&&A!=="BottomLeft")throw new Error(`Invalid Pin 1 location for Top/Bottom orientation. Pin 1 is at ${A}, but must be at Top-Right or Bottom-Left.`)}const U=[];r.type==="fourSided"?U.push(...G):r.twoSidedOrientation==="vertical-edges"?M===B?U.push(B,I):U.push(I,B):M===X?U.push(X,F):U.push(F,X);let _=1;for(const N of U){const te=Math.hypot(N.end.x-N.start.x,N.end.y-N.start.y),ie=r.type==="fourSided"?te/(c+1):c>1?te/(c-1):0,re=[];if(r.type==="fourSided")if(N.direction==="Down")for(let q=1;q<=c;q++)re.push({x:N.start.x,y:N.start.y+q*ie});else if(N.direction==="Right")for(let q=1;q<=c;q++)re.push({x:N.start.x+q*ie,y:N.start.y});else if(N.direction==="Up")for(let q=1;q<=c;q++)re.push({x:N.start.x,y:N.start.y-q*ie});else for(let q=1;q<=c;q++)re.push({x:N.start.x-q*ie,y:N.start.y});else if(c===1){const q=(N.start.x+N.end.x)/2,J=(N.start.y+N.end.y)/2;re.push({x:q,y:J})}else if(N.direction==="Down")for(let q=0;q<c;q++)re.push({x:N.start.x,y:N.start.y+q*ie});else if(N.direction==="Right")for(let q=0;q<c;q++)re.push({x:N.start.x+q*ie,y:N.start.y});else if(N.direction==="Up")for(let q=0;q<c;q++)re.push({x:N.start.x,y:N.start.y-q*ie});else for(let q=0;q<c;q++)re.push({x:N.start.x-q*ie,y:N.start.y});if(N===M){let q=0,J=1/0;for(let _e=0;_e<re.length;_e++){const xe=Math.hypot(re[_e].x-n.x,re[_e].y-n.y);xe<J&&(J=xe,q=_e)}const ce=Math.hypot(N.start.x-n.x,N.start.y-n.y);if(J<ce&&q>0){const _e=re.slice(0,q),xe=re.slice(q);re.length=0,re.push(...xe,..._e)}}for(const q of re)t.push({pinNumber:_++,x:q.x,y:q.y})}return t}function BC(r){MC(r);const e=LC(r.point1,r.point2);return r.type==="linear"?zC(r,e):IC(r,e)}function OC(){const[r,e]=K.useState([]),[t,n]=K.useState(!1),[s,o]=K.useState([]),[d,c]=K.useState(null),[h,f]=K.useState("trace"),[m,b]=K.useState("top"),A=K.useRef([]),v=K.useRef(0),E=K.useRef(!1),x=K.useCallback(()=>{n(!0),o([]),A.current=[]},[]),k=K.useCallback(()=>{n(!1),o([]),A.current=[]},[]),j=K.useCallback(z=>{o(B=>[...B,z]),A.current=[...A.current,z]},[]),$=K.useCallback(z=>{e(B=>[...B,z]),o([]),A.current=[]},[]);return{drawingStrokes:r,setDrawingStrokes:e,isDrawing:t,setIsDrawing:n,currentStroke:s,setCurrentStroke:o,tracePreviewMousePos:d,setTracePreviewMousePos:c,drawingMode:h,setDrawingMode:f,selectedDrawingLayer:m,setSelectedDrawingLayer:b,currentStrokeRef:A,lastTraceClickTimeRef:v,isDoubleClickingTraceRef:E,startDrawing:x,stopDrawing:k,addPointToStroke:j,finishStroke:$}}function FC(){const[r,e]=K.useState(new Set),[t,n]=K.useState(!1),[s,o]=K.useState(new Set),[d,c]=K.useState(new Set),[h,f]=K.useState(new Set),m=K.useCallback(()=>{e(new Set),o(new Set),c(new Set),f(new Set)},[]),b=K.useCallback((E,x="stroke")=>{x==="stroke"?e(k=>new Set([...k,E])):x==="component"?o(k=>new Set([...k,E])):x==="power"?c(k=>new Set([...k,E])):x==="ground"&&f(k=>new Set([...k,E]))},[]),A=K.useCallback((E,x="stroke")=>{x==="stroke"?e(k=>{const j=new Set(k);return j.delete(E),j}):x==="component"?o(k=>{const j=new Set(k);return j.delete(E),j}):x==="power"?c(k=>{const j=new Set(k);return j.delete(E),j}):x==="ground"&&f(k=>{const j=new Set(k);return j.delete(E),j})},[]),v=K.useCallback((E,x="stroke")=>{x==="stroke"?e(E):x==="component"?o(E):x==="power"?c(E):x==="ground"&&f(E)},[]);return{selectedIds:r,setSelectedIds:e,isSelecting:t,setIsSelecting:n,selectedComponentIds:s,setSelectedComponentIds:o,selectedPowerIds:d,setSelectedPowerIds:c,selectedGroundIds:h,setSelectedGroundIds:f,clearSelection:m,addToSelection:b,removeFromSelection:A,setSelection:v}}function UC(){const[r,e]=K.useState(null),[t,n]=K.useState(!1),[s,o]=K.useState(null),[d,c]=K.useState("nudge"),h=K.useCallback((m,b)=>{e(m),n(!0),o(b)},[]),f=K.useCallback(()=>{n(!1),e(null),o(null)},[]);return{selectedImageForTransform:r,setSelectedImageForTransform:e,isTransforming:t,setIsTransforming:n,transformStartPos:s,setTransformStartPos:o,transformMode:d,setTransformMode:c,startTransform:h,stopTransform:f}}function HC(){const[r,e]=K.useState(null),[t,n]=K.useState(null),[s,o]=K.useState("overlay"),[d,c]=K.useState(50),[h,f]=K.useState(!1),[m,b]=K.useState(2e3),[A,v]=K.useState(!1),E=K.useCallback(j=>{e(j)},[]),x=K.useCallback(j=>{n(j)},[]),k=K.useCallback(()=>{e(null),n(null)},[]);return{topImage:r,setTopImage:e,bottomImage:t,setBottomImage:n,currentView:s,setCurrentView:o,transparency:d,setTransparency:c,isTransparencyCycling:h,setIsTransparencyCycling:f,transparencyCycleSpeed:m,setTransparencyCycleSpeed:b,isGrayscale:A,setIsGrayscale:v,loadTopImage:E,loadBottomImage:x,clearImages:k}}function qC(){const[r,e]=K.useState(1),[t,n]=K.useState({x:0,y:0}),[s,o]=K.useState(0),[d,c]=K.useState(!1),[h,f]=K.useState(!1),[m,b]=K.useState(!1),A=K.useCallback(()=>{e(1),n({x:0,y:0}),o(0),c(!1)},[]),v=K.useCallback((z=1.2)=>{e(B=>B*z)},[]),E=K.useCallback((z=1.2)=>{e(B=>B/z)},[]),x=K.useCallback(z=>{e(z)},[]),k=K.useCallback((z,B,F)=>{const I=z/F,X=B/F;n(M=>({x:M.x-I,y:M.y-X}))},[]),j=K.useCallback((z,B)=>{n({x:z,y:B})},[]),$=K.useCallback((z,B)=>({x:z-t.x*r,y:B-t.y*r}),[t,r]);return{viewScale:r,setViewScale:e,cameraWorldCenter:t,setCameraWorldCenter:n,viewRotation:s,setViewRotation:o,viewFlipX:d,setViewFlipX:c,isShiftConstrained:h,setIsShiftConstrained:f,showBothLayers:m,setShowBothLayers:b,resetView:A,zoomIn:v,zoomOut:E,setZoom:x,pan:k,setCameraCenter:j,getViewPan:$}}function VC(){const[r,e]=K.useState(()=>[{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),[t,n]=K.useState(()=>[{id:"groundbus-circuit",name:"GND",color:"#000000"}]),[s,o]=K.useState([]),[d,c]=K.useState([]),[h,f]=K.useState(null),[m,b]=K.useState(null),A=K.useCallback(I=>{e(X=>[...X,I])},[]),v=K.useCallback((I,X)=>{e(M=>M.map(G=>G.id===I?{...G,...X}:G))},[]),E=K.useCallback(I=>{e(X=>X.filter(M=>M.id!==I)),o(X=>X.filter(M=>M.powerBusId!==I))},[]),x=K.useCallback(I=>{o(X=>[...X,I])},[]),k=K.useCallback(I=>{o(X=>X.filter(M=>M.id!==I))},[]),j=K.useCallback(I=>{c(X=>[...X,I])},[]),$=K.useCallback(I=>{c(X=>X.filter(M=>M.id!==I))},[]),z=K.useCallback(I=>{n(X=>[...X,I])},[]),B=K.useCallback((I,X)=>{n(M=>M.map(G=>G.id===I?{...G,...X}:G))},[]),F=K.useCallback(I=>{n(X=>X.filter(M=>M.id!==I)),c(X=>X.filter(M=>M.groundBusId===I))},[]);return{powerBuses:r,setPowerBuses:e,groundBuses:t,setGroundBuses:n,powerSymbols:s,setPowerSymbols:o,groundSymbols:d,setGroundSymbols:c,powerEditor:h,setPowerEditor:f,groundEditor:m,setGroundEditor:b,addPowerBus:A,updatePowerBus:v,removePowerBus:E,addPowerSymbol:x,removePowerSymbol:k,addGroundSymbol:j,removeGroundSymbol:$,addGroundBus:z,updateGroundBus:B,removeGroundBus:F}}const wi={brushColor:"#008080",brushSize:6,topTraceColor:"#AA4499",bottomTraceColor:"#F781BF",topTraceSize:6,bottomTraceSize:6,viaSize:18,viaColor:"#ff0000",topPadColor:"#0072B2",bottomPadColor:"#56B4E9",topPadSize:18,bottomPadSize:18,topTestPointColor:"#FFFF00",bottomTestPointColor:"#FFFF00",topTestPointSize:18,bottomTestPointSize:18,topComponentColor:"#8C564B",bottomComponentColor:"#9C755F",topComponentSize:18,bottomComponentSize:18,componentConnectionColor:"#E69F00",componentConnectionSize:3};function WC(){const[r,e]=K.useState(wi.brushColor),[t,n]=K.useState(wi.brushSize),[s,o]=K.useState(wi.topTraceColor),[d,c]=K.useState(wi.bottomTraceColor),[h,f]=K.useState(wi.topTraceSize),[m,b]=K.useState(wi.bottomTraceSize),[A,v]=K.useState(wi.topPadColor),[E,x]=K.useState(wi.bottomPadColor),[k,j]=K.useState(wi.topPadSize),[$,z]=K.useState(wi.bottomPadSize),[B,F]=K.useState(wi.topTestPointColor),[I,X]=K.useState(wi.bottomTestPointColor),[M,G]=K.useState(wi.topTestPointSize),[U,_]=K.useState(wi.bottomTestPointSize),[N,te]=K.useState(wi.topComponentColor),[ie,re]=K.useState(wi.bottomComponentColor),[q,J]=K.useState(wi.topComponentSize),[ce,_e]=K.useState(wi.bottomComponentSize),[xe,Z]=K.useState(wi.componentConnectionColor),[D,H]=K.useState(wi.componentConnectionSize),Y=K.useCallback(()=>{e(wi.brushColor),n(wi.brushSize),o(wi.topTraceColor),c(wi.bottomTraceColor),f(wi.topTraceSize),b(wi.bottomTraceSize),v(wi.topPadColor),x(wi.bottomPadColor),j(wi.topPadSize),z(wi.bottomPadSize),F(wi.topTestPointColor),X(wi.bottomTestPointColor),G(wi.topTestPointSize),_(wi.bottomTestPointSize),te(wi.topComponentColor),re(wi.bottomComponentColor),J(wi.topComponentSize),_e(wi.bottomComponentSize),Z(wi.componentConnectionColor),H(wi.componentConnectionSize)},[]),ue=K.useCallback(Re=>{Re.brushColor!==void 0&&e(Re.brushColor),Re.brushSize!==void 0&&n(Re.brushSize),Re.topTraceColor!==void 0&&o(Re.topTraceColor),Re.bottomTraceColor!==void 0&&c(Re.bottomTraceColor),Re.topTraceSize!==void 0&&f(Re.topTraceSize),Re.bottomTraceSize!==void 0&&b(Re.bottomTraceSize),Re.topPadColor!==void 0&&v(Re.topPadColor),Re.bottomPadColor!==void 0&&x(Re.bottomPadColor),Re.topPadSize!==void 0&&j(Re.topPadSize),Re.bottomPadSize!==void 0&&z(Re.bottomPadSize),Re.topTestPointColor!==void 0&&F(Re.topTestPointColor),Re.bottomTestPointColor!==void 0&&X(Re.bottomTestPointColor),Re.topTestPointSize!==void 0&&G(Re.topTestPointSize),Re.bottomTestPointSize!==void 0&&_(Re.bottomTestPointSize),Re.topComponentColor!==void 0&&te(Re.topComponentColor),Re.bottomComponentColor!==void 0&&re(Re.bottomComponentColor),Re.topComponentSize!==void 0&&J(Re.topComponentSize),Re.bottomComponentSize!==void 0&&_e(Re.bottomComponentSize),Re.componentConnectionColor!==void 0&&Z(Re.componentConnectionColor),Re.componentConnectionSize!==void 0&&H(Re.componentConnectionSize)},[]),Ne=K.useCallback((Re,Ke,Je)=>{},[]),Pe=K.useCallback((Re,Ke,Je)=>{},[]),Ue=K.useCallback(()=>({brushColor:r,brushSize:t,topTraceColor:s,bottomTraceColor:d,topTraceSize:h,bottomTraceSize:m,viaSize:wi.viaSize,viaColor:wi.viaColor,topPadColor:A,bottomPadColor:E,topPadSize:k,bottomPadSize:$,topTestPointColor:B,bottomTestPointColor:I,topTestPointSize:M,bottomTestPointSize:U,topComponentColor:N,bottomComponentColor:ie,topComponentSize:q,bottomComponentSize:ce,componentConnectionColor:xe,componentConnectionSize:D}),[r,t,s,d,h,m,A,E,k,$,B,I,M,U,N,ie,q,ce,xe,D]);return{brushColor:r,setBrushColor:e,brushSize:t,setBrushSize:n,topTraceColor:s,setTopTraceColor:o,bottomTraceColor:d,setBottomTraceColor:c,topTraceSize:h,setTopTraceSize:f,bottomTraceSize:m,setBottomTraceSize:b,topPadColor:A,setTopPadColor:v,bottomPadColor:E,setBottomPadColor:x,topPadSize:k,setTopPadSize:j,bottomPadSize:$,setBottomPadSize:z,topTestPointColor:B,setTopTestPointColor:F,bottomTestPointColor:I,setBottomTestPointColor:X,topTestPointSize:M,setTopTestPointSize:G,bottomTestPointSize:U,setBottomTestPointSize:_,topComponentColor:N,setTopComponentColor:te,bottomComponentColor:ie,setBottomComponentColor:re,topComponentSize:q,setTopComponentSize:J,bottomComponentSize:ce,setBottomComponentSize:_e,componentConnectionColor:xe,setComponentConnectionColor:Z,componentConnectionSize:D,setComponentConnectionSize:H,resetToDefaults:Y,loadFromProject:ue,getCurrentSettings:Ue,saveDefaultSize:Ne,saveDefaultColor:Pe}}function $C(r,e,t,n,s,o,d,c,h,f,m,b,A,v,E,x,k,j,$,z,B,F,I,X,M){const[G,U]=K.useState(()=>r()),_=K.useRef(null),N=K.useRef(n),te=K.useRef(s),ie=K.useCallback(J=>e==="draw"&&t==="trace"?J.get("trace"):e==="draw"&&t==="via"?J.get("via"):e==="draw"&&t==="pad"?J.get("pad"):e==="component"?J.get("component"):e==="power"?J.get("power"):e==="ground"?J.get("ground"):null,[e,t]);K.useEffect(()=>{U(J=>{const ce=ie(J),_e=ce?.id||null,xe=_.current,Z=new Map(J);if(xe&&xe!==_e){const D=J.get(xe);D&&Z.set(xe,{...D,settings:{color:N.current,size:te.current}})}if(ce&&_e!==xe)if(e==="draw"&&t==="trace"){const D=F||"top",H=D==="top"?o:d,Y=D==="top"?c:h;N.current=H,te.current=Y,Z.set("trace",{...ce,settings:{color:H,size:Y}})}else if(e==="draw"&&t==="pad"){const D=I||"top",H=D==="top"?f:m,Y=D==="top"?b:A;N.current=H,te.current=Y,Z.set("pad",{...ce,settings:{color:H,size:Y}})}else if(e==="component"){const D=M||"top",H=D==="top"?j:$,Y=D==="top"?z:B;N.current=H,te.current=Y,Z.set("component",{...ce,settings:{color:H,size:Y}})}else N.current=ce.settings.color,te.current=ce.settings.size;return _.current=_e,Z})},[e,t,o,d,c,h,f,m,b,A,j,$,z,B,F,I,M,ie]);const re=K.useCallback((J,ce)=>{U(_e=>{const xe=new Map(_e),Z=xe.get(J);return Z&&xe.set(J,{...Z,settings:ce}),xe})},[]),q=K.useCallback((J,ce,_e)=>{U(xe=>{const Z=new Map(xe),D=Z.get(J);if(D){const H=new Map(D.layerSettings);H.set(ce,_e),Z.set(J,{...D,layerSettings:H})}return Z})},[]);return{toolRegistry:G,setToolRegistry:U,updateToolSettings:re,updateToolLayerSettings:q,getCurrentToolDef:ie}}function GC(r){const{currentTool:e,drawingMode:t,traceToolLayer:n,padToolLayer:s,testPointToolLayer:o,componentToolLayer:d}=r,[c,h]=K.useState(0),f=K.useCallback(()=>e==="draw"&&t==="via"?"via":e==="draw"&&t==="pad"?s==="bottom"?"padBottom":"padTop":e==="draw"&&t==="testPoint"?o==="bottom"?"testPointBottom":"testPointTop":e==="draw"&&t==="trace"?n==="bottom"?"traceBottom":"traceTop":e==="component"?d==="bottom"?"componentBottom":"componentTop":e==="power"?"power":e==="ground"?"ground":null,[e,t,s,o,n,d]),m=K.useCallback(()=>{const E=f();if(E){const x=Ln.get(E);return{currentTool:e,drawingMode:t,layer:e==="draw"&&t==="pad"?s||"top":e==="draw"&&t==="testPoint"?o||"top":e==="draw"&&t==="trace"?n||"top":e==="component"?d||"top":void 0,toolInstanceId:E,color:x.color,size:x.size}}return{currentTool:e,drawingMode:t,layer:void 0,toolInstanceId:null,color:"#000000",size:10}},[e,t,s,o,n,d,f]);K.useEffect(()=>{const E=f();return E?Ln.subscribe(E,()=>{h(k=>k+1)}):void 0},[f]);const b=m(),A=K.useCallback(E=>{const x=f();x&&Ln.setColor(x,E)},[f]),v=K.useCallback(E=>{const x=f();x&&Ln.setSize(x,E)},[f]);return{toolState:b,setColor:A,setSize:v,getCurrentToolInstanceId:f}}function YC(){const[r,e]=K.useState(!1),[t,n]=K.useState(!1),[s,o]=K.useState(!1),[d,c]=K.useState(!1),[h,f]=K.useState(!1),[m,b]=K.useState(!1),[A,v]=K.useState(!1),[E,x]=K.useState(!1),k=K.useCallback(()=>{e(!0),n(!0),o(!0),c(!0),f(!0),b(!0),v(!0),x(!0)},[]),j=K.useCallback(()=>{e(!1),n(!1),o(!1),c(!1),f(!1),b(!1),v(!1),x(!1)},[]);return{areImagesLocked:r,setAreImagesLocked:e,areViasLocked:t,setAreViasLocked:n,arePadsLocked:s,setArePadsLocked:o,areTestPointsLocked:d,setAreTestPointsLocked:c,areTracesLocked:h,setAreTracesLocked:f,areComponentsLocked:m,setAreComponentsLocked:b,areGroundNodesLocked:A,setAreGroundNodesLocked:v,arePowerNodesLocked:E,setArePowerNodesLocked:x,lockAll:k,unlockAll:j}}function XC(){const[r,e]=K.useState(null),[t,n]=K.useState({visible:!1,size:6}),[s,o]=K.useState({visible:!1,interval:5}),[d,c]=K.useState({visible:!1,source:null,interval:5}),[h,f]=K.useState({visible:!1,text:""}),[m,b]=K.useState({visible:!1,title:"",message:""}),[A,v]=K.useState({visible:!1}),[E,x]=K.useState({visible:!1}),[k,j]=K.useState({visible:!1,projectName:"",locationPath:"",locationHandle:null}),[$,z]=K.useState({visible:!1,filename:"",locationPath:"",locationHandle:null}),[B,F]=K.useState(!1),[I,X]=K.useState(!0),[M,G]=K.useState(!1);return{openMenu:r,setOpenMenu:e,setSizeDialog:t,setSetSizeDialog:n,autoSaveDialog:s,setAutoSaveDialog:o,autoSavePromptDialog:d,setAutoSavePromptDialog:c,debugDialog:h,setDebugDialog:f,errorDialog:m,setErrorDialog:b,newProjectDialog:A,setNewProjectDialog:v,openProjectDialog:E,setOpenProjectDialog:x,newProjectSetupDialog:k,setNewProjectSetupDialog:j,saveAsDialog:$,setSaveAsDialog:z,showColorPicker:B,setShowColorPicker:F,showWelcomeDialog:I,setShowWelcomeDialog:X,transformImagesDialogVisible:M,setTransformImagesDialogVisible:G}}function KC(){const[r,e]=K.useState(!1),[t,n]=K.useState(1),[s,o]=K.useState(null),[d,c]=K.useState(""),[h,f]=K.useState(""),[m,b]=K.useState(null),[A,v]=K.useState("pcb_project"),[E,x]=K.useState([]),[k,j]=K.useState(-1),$=K.useRef(null),z=K.useRef(!1),B=K.useRef(!1);return{autoSaveEnabled:r,setAutoSaveEnabled:e,autoSaveInterval:t,setAutoSaveInterval:n,autoSaveDirHandle:s,setAutoSaveDirHandle:o,autoSaveBaseName:d,setAutoSaveBaseName:c,currentProjectFilePath:h,setCurrentProjectFilePath:f,projectDirHandle:m,setProjectDirHandle:b,projectName:A,setProjectName:v,autoSaveFileHistory:E,setAutoSaveFileHistory:x,currentFileIndex:k,setCurrentFileIndex:j,autoSaveIntervalRef:$,hasChangesSinceLastAutoSaveRef:z,prevAutoSaveEnabledRef:B}}function ZC(){const[r,e]=K.useState(null),t=K.useRef(!1),n=K.useCallback((c,h,f,m,b)=>{if(t.current)return;const A={drawingStrokes:JSON.parse(JSON.stringify(c)),componentsTop:JSON.parse(JSON.stringify(h)),componentsBottom:JSON.parse(JSON.stringify(f)),powerSymbols:JSON.parse(JSON.stringify(m)),groundSymbols:JSON.parse(JSON.stringify(b))};e(A)},[]),s=K.useCallback(()=>{if(!r)return null;t.current=!0;const c=r;return e(null),setTimeout(()=>{t.current=!1},100),c},[r]),o=r!==null,d=K.useCallback(()=>{e(null)},[]);return{saveSnapshot:n,undo:s,canUndo:o,clearSnapshot:d}}function JC(){const e=HC(),{topImage:t,setTopImage:n,bottomImage:s,setBottomImage:o,currentView:d,setCurrentView:c,transparency:h,setTransparency:f,isTransparencyCycling:m,setIsTransparencyCycling:b,transparencyCycleSpeed:A,setTransparencyCycleSpeed:v,isGrayscale:E,setIsGrayscale:x}=e,[k,j]=K.useState("none"),[$,z]=K.useState(()=>{const p=localStorage.getItem("bomExportFormat");return p==="json"||p==="pdf"?p:"pdf"});Ct.useEffect(()=>{localStorage.setItem("bomExportFormat",$)},[$]);const B=WC(),{brushColor:F,setBrushColor:I,brushSize:X,setBrushSize:M,topTraceColor:G,setTopTraceColor:U,bottomTraceColor:_,setBottomTraceColor:N,topTraceSize:te,setTopTraceSize:ie,bottomTraceSize:re,setBottomTraceSize:q,topPadColor:J,setTopPadColor:ce,bottomPadColor:_e,setBottomPadColor:xe,topPadSize:Z,setTopPadSize:D,bottomPadSize:H,setBottomPadSize:Y,topTestPointColor:ue,setTopTestPointColor:Ne,bottomTestPointColor:Pe,setBottomTestPointColor:Ue,topTestPointSize:Re,setTopTestPointSize:Ke,bottomTestPointSize:Je,setBottomTestPointSize:st,topComponentColor:yt,setTopComponentColor:Nt,bottomComponentColor:pe,setBottomComponentColor:St,topComponentSize:Ut,setTopComponentSize:Lt,bottomComponentSize:at,setBottomComponentSize:en,componentConnectionColor:Ot,setComponentConnectionColor:wn,componentConnectionSize:nn,setComponentConnectionSize:Zn,saveDefaultSize:Pt,saveDefaultColor:Mt}=B,yi=OC(),{drawingStrokes:ft,setDrawingStrokes:_t,isDrawing:On,setIsDrawing:Jt,currentStroke:zn,setCurrentStroke:Nn,tracePreviewMousePos:on,setTracePreviewMousePos:Sn,drawingMode:lt,setDrawingMode:Qt,selectedDrawingLayer:$t,setSelectedDrawingLayer:Gt,currentStrokeRef:An,lastTraceClickTimeRef:Vi,isDoubleClickingTraceRef:qn}=yi,yn=UC(),{selectedImageForTransform:Kt,setSelectedImageForTransform:Tr,isTransforming:Ks,setIsTransforming:Ir,transformStartPos:Br,setTransformStartPos:Zt,transformMode:Or,setTransformMode:Na}=yn,fa=qC(),{viewScale:At,setViewScale:fi,viewRotation:ei,setViewRotation:vs,viewFlipX:Ji,setViewFlipX:Ds,cameraWorldCenter:Ci,setCameraWorldCenter:Si,resetView:Cr,isShiftConstrained:pa,setIsShiftConstrained:qa,showBothLayers:Yl,setShowBothLayers:Va,setCameraCenter:Wa,getViewPan:No}=fa,[$n,Fr]=K.useState("top"),[xi,ga]=K.useState("top"),[En,Qo]=K.useState("top"),[pi,ma]=K.useState("top"),Pa=Ct.useRef("top"),el=Ct.useRef("top"),tl=Ct.useRef("top"),$a=Ct.useRef("top");Ct.useEffect(()=>{Pa.current=$n},[$n]),Ct.useEffect(()=>{el.current=xi},[xi]),Ct.useEffect(()=>{tl.current=En},[En]),Ct.useEffect(()=>{$a.current=pi},[pi]);const td=GC({currentTool:k,drawingMode:lt,traceToolLayer:$n,padToolLayer:xi,testPointToolLayer:En,componentToolLayer:pi}),{toolState:ss}=td,nl=$C(l3,k,lt,F,X,G,_,te,re,J,_e,Z,H,ue,Pe,Re,Je,yt,pe,Ut,at,$n,xi,En,pi),{toolRegistry:Un,setToolRegistry:Fn,getCurrentToolDef:il,updateToolSettings:Ga,updateToolLayerSettings:Fs}=nl,_r=Ct.useRef(null),us=Ct.useRef(F),Vn=Ct.useRef(X);Ct.useEffect(()=>{Fn(p=>{const S=il(p),L=S?.id||null,Q=_r.current,oe=new Map(p);if(Q&&Q!==L){const he=p.get(Q);he&&oe.set(Q,{...he,settings:{color:us.current,size:Vn.current}})}if(S&&L!==Q)if(k==="draw"&&lt==="trace"){const he=$n||"top",V=he==="top"?G:_,Ae=he==="top"?te:re;I(V),M(Ae),us.current=V,Vn.current=Ae;const fe=new Map(S.layerSettings);fe.set("top",{color:G,size:te}),fe.set("bottom",{color:_,size:re}),oe.set("trace",{...S,settings:{color:V,size:Ae},layerSettings:fe})}else if(k==="draw"&&lt==="pad"){const he=xi||"top",V=he==="top"?J:_e,Ae=he==="top"?Z:H;I(V),M(Ae),us.current=V,Vn.current=Ae;const fe=new Map(S.layerSettings);fe.set("top",{color:J,size:Z}),fe.set("bottom",{color:_e,size:H}),oe.set("pad",{...S,settings:{color:V,size:Ae},layerSettings:fe})}else if(k==="draw"&&lt==="testPoint"){const he=En||"top",V=he==="top"?ue:Pe,Ae=he==="top"?Re:Je;I(V),M(Ae),us.current=V,Vn.current=Ae;const fe=new Map(S.layerSettings);fe.set("top",{color:ue,size:Re}),fe.set("bottom",{color:Pe,size:Je}),oe.set("testPoint",{...S,settings:{color:V,size:Ae},layerSettings:fe})}else if(k==="component"){const he=pi||"top",V=he==="top"?yt:pe,Ae=he==="top"?Ut:at;I(V),M(Ae),us.current=V,Vn.current=Ae;const fe=new Map(S.layerSettings);fe.set("top",{color:yt,size:Ut}),fe.set("bottom",{color:pe,size:at}),oe.set("component",{...S,settings:{color:V,size:Ae},layerSettings:fe})}else{const he=S.settings;I(he.color),M(he.size),us.current=he.color,Vn.current=he.size}return _r.current=L,oe})},[k,lt,il,G,_,te,re,J,_e,Z,H,ue,Pe,Re,Je,En,yt,pe,Ut,at]),Ct.useEffect(()=>{const p=Un.get("trace");if(p){const oe=p.layerSettings.get("top"),he=p.layerSettings.get("bottom");oe&&(U(oe.color),ie(oe.size)),he&&(N(he.color),q(he.size))}const S=Un.get("pad");if(S){const oe=S.layerSettings.get("top"),he=S.layerSettings.get("bottom");oe&&(ce(oe.color),D(oe.size)),he&&(xe(he.color),Y(he.size))}const L=Un.get("testPoint");if(L){const oe=L.layerSettings.get("top"),he=L.layerSettings.get("bottom");oe&&(Ne(oe.color),Ke(oe.size)),he&&(Ue(he.color),st(he.size))}const Q=Un.get("component");if(Q){const oe=Q.layerSettings.get("top"),he=Q.layerSettings.get("bottom");oe&&(Nt(oe.color),Lt(oe.size)),he&&(St(he.color),en(he.size))}},[]),Ct.useEffect(()=>{Fn(p=>{const S=new Map(p),L=p.get("trace");if(L){const Ae=new Map(L.layerSettings);Ae.set("top",{color:G,size:te}),Ae.set("bottom",{color:_,size:re}),S.set("trace",{...L,layerSettings:Ae})}const Q=p.get("pad");if(Q){const Ae=new Map(Q.layerSettings);Ae.set("top",{color:J,size:Z}),Ae.set("bottom",{color:_e,size:H}),S.set("pad",{...Q,layerSettings:Ae})}const oe=p.get("testPoint");if(oe){const Ae=new Map(oe.layerSettings);Ae.set("top",{color:ue,size:Re}),Ae.set("bottom",{color:Pe,size:Je}),S.set("testPoint",{...oe,layerSettings:Ae})}const he=p.get("component");if(he){const Ae=new Map(he.layerSettings);Ae.set("top",{color:yt,size:Ut}),Ae.set("bottom",{color:pe,size:at}),S.set("component",{...he,layerSettings:Ae})}const V=p.get("componentConnection");return V&&S.set("componentConnection",{...V,settings:{color:Ot,size:nn}}),S})},[G,_,te,re,J,_e,Z,H,ue,Pe,Re,Je,yt,pe,Ut,at,Ot,nn,Fn]),Ct.useEffect(()=>{Fn(p=>{const S=il(p);if(S)if(k==="draw"&&lt==="trace"){const L=$n||"top",Q=L==="top"?"traceTop":"traceBottom",oe=Ln.get(Q),he=oe.color,V=oe.size;L==="top"?(U(he),ie(V),Mt("trace",he,"top"),Pt("trace",V,"top")):(N(he),q(V),Mt("trace",he,"bottom"),Pt("trace",V,"bottom"));const Ae=new Map(p),fe=new Map(S.layerSettings);return fe.set(L,{color:he,size:V}),Ae.set(S.id,{...S,layerSettings:fe,settings:{color:he,size:V}}),us.current=he,Vn.current=V,Ae}else if(k==="draw"&&lt==="pad"){const L=xi||"top",Q=L==="top"?"padTop":"padBottom",oe=Ln.get(Q),he=oe.color,V=oe.size;L==="top"?(ce(he),D(V),Mt("pad",he,"top"),Pt("pad",V,"top")):(xe(he),Y(V),Mt("pad",he,"bottom"),Pt("pad",V,"bottom"));const Ae=new Map(p),fe=new Map(S.layerSettings);return fe.set(L,{color:he,size:V}),Ae.set(S.id,{...S,layerSettings:fe,settings:{color:he,size:V}}),us.current=he,Vn.current=V,Ae}else if(k==="draw"&&lt==="testPoint"){const L=En||"top",Q=L==="top"?"testPointTop":"testPointBottom",oe=Ln.get(Q),he=oe.color,V=oe.size;L==="top"?(Ne(he),Ke(V),Mt("testPoint",he,"top"),Pt("testPoint",V,"top")):(Ue(he),st(V),Mt("testPoint",he,"bottom"),Pt("testPoint",V,"bottom"));const Ae=new Map(p),fe=new Map(S.layerSettings);return fe.set(L,{color:he,size:V}),Ae.set(S.id,{...S,layerSettings:fe,settings:{color:he,size:V}}),us.current=he,Vn.current=V,Ae}else if(k==="component"){const L=pi||"top",Q=L==="top"?"componentTop":"componentBottom",oe=Ln.get(Q),he=oe.color,V=oe.size;L==="top"?(Nt(he),Lt(V),Mt("component",he,"top"),Pt("component",V,"top")):(St(he),en(V),Mt("component",he,"bottom"),Pt("component",V,"bottom"));const Ae=new Map(p),fe=new Map(S.layerSettings);return fe.set(L,{color:he,size:V}),Ae.set(S.id,{...S,layerSettings:fe,settings:{color:he,size:V}}),us.current=he,Vn.current=V,Ae}else{const L=new Map(p);return L.set(S.id,{...S,settings:{color:F,size:X}}),us.current=F,Vn.current=X,L}return p})},[F,X,k,lt,$n,xi,En,pi,il,Mt,Pt,Qh,U,N,ie,q,ce,xe,D,Y,Ne,Ue,Ke,st,Nt,St,Lt,en]),Ct.useEffect(()=>{if(k==="draw"&&lt==="trace"){const p=$n;Gt(p),I(p==="top"?G:_),M(p==="top"?te:re),p==="top"?(or(!0),Wr(!0)):(mr(!0),Ca(!0)),zd(!0)}else zd(!1)},[k,lt,$n,G,_,te,re]),Ct.useEffect(()=>{if(k==="draw"&&lt==="pad"){const p=xi;Gt(p);const S=Ln.get(p==="top"?"padTop":"padBottom");I(S.color),M(S.size),p==="top"?(or(!0),$r(!0)):(mr(!0),Yr(!0)),ru(!0)}else ru(!1)},[k,lt,xi]),Ct.useEffect(()=>{if(k==="draw"&&lt==="testPoint"){const p=En;Gt(p),I(p==="top"?ue:Pe),M(p==="top"?Re:Je),p==="top"?(or(!0),Uo(!0)):(mr(!0),sc(!0)),au(!0)}else au(!1)},[k,lt,En,ue,Pe,Re,Je]);const[bi,Xl]=K.useState(!1);Ct.useEffect(()=>{if(k==="component"){const p=pi;Gt(p),I(p==="top"?yt:pe),M(p==="top"?Ut:at),p==="top"?(or(!0),Ho(!0)):(mr(!0),ra(!0)),bi||Uu(!0)}else Uu(!1),Xl(!1)},[k,pi,yt,pe,Ut,at,bi]),Ct.useEffect(()=>{if(k==="component"){const p=pi;Gt(p),I(p==="top"?yt:pe),M(p==="top"?Ut:at)}},[pi,k,yt,pe,Ut,at]),Ct.useEffect(()=>{ss.toolInstanceId&&(I(ss.color),M(ss.size))},[ss.toolInstanceId,ss.color,ss.size,I,M,k,lt]);const[bc,ya]=K.useState(void 0),[,kr]=K.useState([]),[,sl]=K.useState([]),[,Ya]=K.useState([]),[,jr]=K.useState([]),[na,Et]=K.useState([]),[Qi,fr]=K.useState([]),[Al,Xa]=K.useState([]),[Ea,co]=K.useState([]),rs=K.useRef(null),es=Ct.useMemo(()=>{const p=rs.current;if(!p)return{x:0,y:0};const S=(p.width-10)/2,L=(p.height-10)/2;return No(S,L)},[rs.current?.width,rs.current?.height,Ci,At,No]),Po=Ct.useCallback(p=>{const S=rs.current;if(!S)return;const L=(S.width-10)/2,Q=(S.height-10)/2,oe=No(L,Q),he=typeof p=="function"?p(oe):p,V=(L-he.x)/At,Ae=(Q-he.y)/At;Si({x:V,y:Ae})},[No,At,Si]),In=FC(),{selectedIds:ti,setSelectedIds:Tn,isSelecting:Hc,setIsSelecting:xa,selectedComponentIds:ln,setSelectedComponentIds:Cn,selectedPowerIds:ri,setSelectedPowerIds:tn,selectedGroundIds:ai,setSelectedGroundIds:pn}=In,Zd=g5(),{componentsTop:It,setComponentsTop:Pi,componentsBottom:Yt,setComponentsBottom:Gn,componentEditor:Ur,setComponentEditor:Ka,connectingPin:Zs,setConnectingPin:rl,componentDialogPosition:Ra,setComponentDialogPosition:Za,isDraggingDialog:al,setIsDraggingDialog:vc,dialogDragOffset:Kl,setDialogDragOffset:Tl,openComponentEditor:Eo}=Zd,Jd=VC(),{powerBuses:gn,setPowerBuses:Ro,groundBuses:P,setGroundBuses:ee,powerSymbols:we,setPowerSymbols:De,groundSymbols:Fe,setGroundSymbols:rt,powerEditor:mt,setPowerEditor:Vt}=Jd,mn=ZC(),{saveSnapshot:hn,undo:Jn,clearSnapshot:vi}=mn;Ct.useEffect(()=>{k==="power"?(rn(!1),gn.length>1?Be&&gn.some(S=>S.id===Be)?ve(!1):(ve(!0),Be!==null&&$e(null)):gn.length===1?($e(gn[0].id),ve(!1)):(ve(!0),$e(null))):ve(!1)},[k,gn]),Ct.useEffect(()=>{k==="ground"?(ve(!1),P.length>1?Bt&&P.some(S=>S.id===Bt)?rn(!1):(rn(!0),Bt!==null&&ni(null)):P.length===1?(ni(P[0].id),rn(!1)):(rn(!0),ni(null))):rn(!1)},[k,P]),Ct.useEffect(()=>{k!=="power"&&k!=="ground"&&(ve(!1),rn(!1))},[k]);const Us=YC(),{areImagesLocked:Ni,setAreImagesLocked:Wi,areViasLocked:Ei,setAreViasLocked:ks,arePadsLocked:as,setArePadsLocked:uo,areTestPointsLocked:Nr,setAreTestPointsLocked:ol,areTracesLocked:pr,setAreTracesLocked:ll,areComponentsLocked:Hs,setAreComponentsLocked:ba,areGroundNodesLocked:gr,setAreGroundNodesLocked:Ja,arePowerNodesLocked:oi,setArePowerNodesLocked:ho}=Us,wc=XC(),{openMenu:nd,setOpenMenu:Qa,setSizeDialog:Hr,setSetSizeDialog:Do,autoSaveDialog:Sc,setAutoSaveDialog:Lo,autoSavePromptDialog:va,setAutoSavePromptDialog:nr,debugDialog:eo,setDebugDialog:cl,errorDialog:fo,setErrorDialog:po,newProjectDialog:wa,setNewProjectDialog:ir,openProjectDialog:Mo,setOpenProjectDialog:Da,newProjectSetupDialog:_i,setNewProjectSetupDialog:zo,saveAsDialog:os,setSaveAsDialog:ws,showColorPicker:id,setShowColorPicker:La,transformImagesDialogVisible:Cl,setTransformImagesDialogVisible:Pr}=wc,Zl=KC(),[sd,to]=K.useState(!1),[dl,Io]=K.useState(!1),[Sa,qr]=K.useState(!1),[Ma,Bo]=K.useState(null),[Aa,go]=K.useState(null),[$i,Ri]=K.useState(null),[Ss,sr]=K.useState(null),[_l,ul]=K.useState(null),{autoSaveEnabled:rr,setAutoSaveEnabled:Ta,autoSaveInterval:kl,setAutoSaveInterval:hl,autoSaveDirHandle:jl,setAutoSaveDirHandle:Jl,autoSaveBaseName:Nl,setAutoSaveBaseName:no,currentProjectFilePath:Pl,setCurrentProjectFilePath:hs,projectDirHandle:ki,setProjectDirHandle:qs,projectName:Vs,setProjectName:za,autoSaveFileHistory:Nd,setAutoSaveFileHistory:fl,currentFileIndex:Pd,setCurrentFileIndex:Oo,autoSaveIntervalRef:Fi,hasChangesSinceLastAutoSaveRef:ls,prevAutoSaveEnabledRef:Er}=Zl,Ed=K.useRef(null),ia=K.useRef(null),rd=K.useRef(null),Ia=K.useRef(null),qc=K.useRef(null),El=K.useRef(null),Ql=K.useRef(null),[pl,Ac]=K.useState(!1),Fo=K.useRef(null),ec=K.useRef(null),[Ba,tc]=K.useState(!1),[mo,Rl]=K.useState({}),[ad,ar]=K.useState(!1),yo=K.useCallback(()=>{const p=rs.current;if(!p)return null;const S=p.width-10,L=p.height-10;let Q=1/0,oe=1/0,he=-1/0,V=-1/0,Ae=!1;if(t){const Le=t,Ee=(Le.width||0)/2,qe=(Le.height||0)/2;Q=Math.min(Q,Le.x-Ee),oe=Math.min(oe,Le.y-qe),he=Math.max(he,Le.x+Ee),V=Math.max(V,Le.y+qe),Ae=!0}if(s){const Le=s,Ee=(Le.width||0)/2,qe=(Le.height||0)/2;Q=Math.min(Q,Le.x-Ee),oe=Math.min(oe,Le.y-qe),he=Math.max(he,Le.x+Ee),V=Math.max(V,Le.y+qe),Ae=!0}if(!Ae)return{pcbReferenceX:0,pcbReferenceY:0,x:0,y:0,zoom:1,viewRotation:0,viewFlipX:!1,isBottomView:!1,transparency:0,showTopImage:!0,showBottomImage:!0,showViasLayer:!0,showTopTracesLayer:!0,showBottomTracesLayer:!0,showTopPadsLayer:!0,showBottomPadsLayer:!0,showTopTestPointsLayer:!0,showBottomTestPointsLayer:!0,showTopComponents:!0,showBottomComponents:!0,showPowerLayer:!0,showGroundLayer:!0,showConnectionsLayer:!0};const fe=he-Q,je=V-oe,ke=.1,Ce=fe*(1+2*ke),ge=je*(1+2*ke),Se=Ce>0?S/Ce:1,be=ge>0?L/ge:1;return{pcbReferenceX:0,pcbReferenceY:0,x:0,y:0,zoom:Math.min(Se,be,1),viewRotation:0,viewFlipX:!1,isBottomView:!1,transparency:0,showTopImage:!0,showBottomImage:!0,showViasLayer:!0,showTopTracesLayer:!0,showBottomTracesLayer:!0,showTopPadsLayer:!0,showBottomPadsLayer:!0,showTopTestPointsLayer:!0,showBottomTestPointsLayer:!0,showTopComponents:!0,showBottomComponents:!0,showPowerLayer:!0,showGroundLayer:!0,showConnectionsLayer:!0}},[t,s]);Ct.useEffect(()=>{const p=yo();p&&Rl(S=>S[0]?S:{...S,0:p})},[t,s,yo]);const Js=K.useRef(null),[Oa,xo]=K.useState(!1),[Rr,Tc]=K.useState(null),[od,nc]=K.useState(null),[Dl,sa]=K.useState({width:960,height:600}),As=K.useRef(null),ji=K.useRef(null),Fa=K.useRef(null),Qs=K.useRef(null),bo=K.useRef(null),ic=K.useRef(null),Qd=K.useRef(null),Ll=K.useRef(null),[Ls,or]=K.useState(!0),[Ml,mr]=K.useState(!0),[lr,Vr]=K.useState(!0),[js,Wr]=K.useState(!0),[ys,Ca]=K.useState(!0),[cr,$r]=K.useState(!0),[Gr,Yr]=K.useState(!0),[fs,Uo]=K.useState(!0),[vo,sc]=K.useState(!0),[io,Ho]=K.useState(!0),[Di,ra]=K.useState(!0),[_a,Xr]=K.useState(!0),Rn=we,y=Fe,[T,R]=K.useState(!1),[O,ne]=K.useState(null),[se,ae]=K.useState(!1),[de,me]=K.useState(void 0),[Te,Ie]=K.useState(!1),[Ze,ve]=K.useState(!1),[Be,$e]=K.useState(null),[ut,We]=K.useState(new Set),et=K.useCallback(()=>{Tn(new Set),Cn(new Set),tn(new Set),pn(new Set),We(new Set)},[Tn,Cn,tn,pn,We]),[gt,Tt]=K.useState(!1),[bt,sn]=K.useState(null),[qt,rn]=K.useState(!1),[Bt,ni]=K.useState(null),[ts,Yn]=K.useState(!0),[Ht,Rt]=K.useState(!1),[Ws,Pn]=K.useState(!1),Hn=K.useRef({}),[si,Ui]=K.useState(!0),[Ts,Li]=K.useState(!0),[Ms,Kr]=K.useState(!0),[Gi,ii]=K.useState(null),[Mi,zs]=K.useState(!1),[zi,yr]=K.useState(null),[Ns,gi]=K.useState(!1),[Cs,Hi]=K.useState(null),[er,dr]=K.useState(!1),[ns,Ii]=K.useState(null),[xr,_s]=K.useState([]),[bn,vn]=K.useState(!1),[Ai,Zr]=K.useState(null),[so,aa]=K.useState(!1),[$s,zl]=K.useState(null),[Cc,Il]=K.useState(!1),[ps,Vc]=K.useState(!1),[eu,Rd]=K.useState(null),[qo,xh]=K.useState(!1),[_c,Dd]=K.useState(null),[Ld,Dr]=K.useState(!1),Ps=K.useRef(null),kc=K.useRef(!1),wo=K.useRef(null),rc=K.useRef(!1),gl=K.useRef(!1);Ct.useEffect(()=>{Ps.current=eu},[eu]),Ct.useEffect(()=>{kc.current=qo},[qo]),Ct.useEffect(()=>{wo.current=_c},[_c]),Ct.useEffect(()=>{rc.current=Ld},[Ld]),Ct.useEffect(()=>{gl.current=ps},[ps]);const[Bl,ld]=K.useState(null),[cd,Wc]=K.useState(!1);Ct.useEffect(()=>{gn.length===0&&Ro([{id:"default-3v3",name:"+3.3V",voltage:"+3.3VDC",color:"#ff6600"},{id:"default-5v",name:"+5V",voltage:"+5VDC",color:"#ff0000"}])},[gn.length,Ro]);const So=K.useCallback((p,S)=>{const L=Rn.find(oe=>oe.pointId===p);if(L){const oe=S.find(V=>V.id===L.powerBusId);return`Via (${oe?oe.voltage:L.type||"Power Node"})`}const Q=y.find(oe=>oe.pointId===p);return Q?`Via (${Q.type||"Ground"})`:"Via"},[Rn,y]),Jr=K.useCallback((p,S)=>{const L=Rn.find(oe=>oe.pointId===p);if(L){const oe=S.find(V=>V.id===L.powerBusId);return`Pad (${oe?oe.voltage:L.type||"Power Node"})`}const Q=y.find(oe=>oe.pointId===p);return Q?`Pad (${Q.type||"Ground"})`:"Pad"},[Rn,y]),ml=K.useCallback((p,S)=>{const L=Rn.find(oe=>oe.pointId===p);if(L){const oe=S.find(V=>V.id===L.powerBusId);return`Test Point (${oe?oe.voltage:L.type||"Power Node"})`}const Q=y.find(oe=>oe.pointId===p);return Q?`Test Point (${Q.type||"Ground"})`:"Test Point"},[Rn,y]),Iu=K.useCallback(()=>{const p=ft.filter(S=>S.type==="via").map(S=>S.id);Tn(new Set(p)),Cn(new Set),tn(new Set),pn(new Set),We(new Set)},[ft,Tn,Cn,tn,pn]),bh=K.useCallback(()=>{const p=ft.filter(S=>S.type==="trace").map(S=>S.id);Tn(new Set(p)),Cn(new Set),tn(new Set),pn(new Set),We(new Set)},[ft,Tn,Cn,tn,pn]),Bu=K.useCallback(()=>{const p=ft.filter(S=>S.type==="pad").map(S=>S.id);Tn(new Set(p)),Cn(new Set),tn(new Set),pn(new Set),We(new Set)},[ft,Tn,Cn,tn,pn]),jc=K.useCallback(()=>{const p=[...It,...Yt].map(S=>S.id);Cn(new Set(p)),Tn(new Set),tn(new Set),pn(new Set),We(new Set)},[It,Yt,Cn,Tn,tn,pn]),vh=K.useCallback(()=>{const p=[...It,...Yt].filter(S=>{const L=S.pinConnections||[];return!(L.length>0&&L.length===S.pinCount&&L.every(oe=>oe&&oe.trim()!==""))}).map(S=>S.id);Cn(new Set(p)),Tn(new Set),tn(new Set),pn(new Set),We(new Set),cl({visible:!0,text:""})},[It,Yt,Cn,Tn,tn,pn,cl]),wh=K.useCallback(()=>{const p=new Set;let S=0;for(const L of[...It,...Yt]){const Q=L.pinConnections||[];for(const oe of Q)if(oe&&oe.trim()!==""){const he=parseInt(oe.trim(),10);if(!isNaN(he)&&he>0){const V=`${L.id}:${he}`;p.add(V),S++}}}if(console.log(`Component connections: ${S} connection lines found`),p.size===0){console.log("No component connections found - components may not have pins connected"),alert("No component connections found. Please connect component pins to vias or pads first.");return}We(p),Tn(new Set),Cn(new Set),tn(new Set),pn(new Set),console.log(`Selected ${p.size} component connection lines`)},[It,Yt,Tn,Cn,tn,pn]),Ou=K.useCallback(()=>{Sa?(Ds(!1),qr(!1),f(0)):(Ds(!0),qr(!0),f(100))},[Sa,Ds,qr,f]),tu=K.useCallback(p=>{vs(S=>Om(S,p))},[vs]),ac=K.useCallback((p,S)=>{const L=rs.current;if(!L)return;const Q=L.width-10,oe=L.height-10,he=Q/2,V=oe/2,Ae=he-p*At,fe=V-S*At;Po({x:Ae,y:fe})},[At,Po]),$c=K.useCallback((p,S,L)=>{ac(S,L),Cn(new Set([p])),Tn(new Set),tn(new Set),pn(new Set),We(new Set)},[ac,Cn,Tn,tn,pn]),nu=K.useCallback((p,S,L)=>{ac(S,L),Tn(new Set([p])),Cn(new Set),tn(new Set),pn(new Set),We(new Set)},[ac,Tn,Cn,tn,pn]),Md=K.useCallback((p,S,L)=>{ac(S,L),tn(new Set([p])),Tn(new Set),Cn(new Set),pn(new Set),We(new Set)},[ac,tn,Tn,Cn,pn]),Ol=K.useCallback((p,S,L)=>{ac(S,L),pn(new Set([p])),Tn(new Set),Cn(new Set),tn(new Set),We(new Set)},[ac,pn,Tn,Cn,tn]),oc=Ct.useMemo(()=>{const p=new Set(Rn.map(L=>L.powerBusId).filter(L=>typeof L=="string"&&L.length>0)),S=gn.filter(L=>p.has(L.id)).map(L=>L.name);return Array.from(new Set(S)).sort()},[Rn,gn]),lc=Ct.useMemo(()=>{const p=new Set(y.map(L=>L.groundBusId).filter(L=>typeof L=="string"&&L.length>0)),S=P.filter(L=>p.has(L.id)).map(L=>L.name);return Array.from(new Set(S)).sort()},[y,P]),iu=K.useCallback(()=>{const p=Rn.map(S=>S.id);tn(new Set(p)),Tn(new Set),Cn(new Set),pn(new Set),We(new Set)},[Rn,tn,Tn,Cn,pn]),su=K.useCallback(()=>{const p=y.map(S=>S.id);pn(new Set(p)),Tn(new Set),Cn(new Set),tn(new Set),We(new Set)},[y,pn,Tn,Cn,tn]),Gc=K.useCallback(p=>{const S=gn.filter(Q=>Q.name===p).map(Q=>Q.id);if(S.length===0)return;const L=Rn.filter(Q=>Q.powerBusId&&S.includes(Q.powerBusId)).map(Q=>Q.id);tn(new Set(L)),Tn(new Set),Cn(new Set),pn(new Set)},[gn,Rn,tn,Tn,Cn,pn]),Sh=K.useCallback(p=>{const S=P.filter(Q=>Q.name===p).map(Q=>Q.id);if(S.length===0)return;const L=y.filter(Q=>Q.groundBusId&&S.includes(Q.groundBusId)).map(Q=>Q.id);pn(new Set(L)),Tn(new Set),Cn(new Set),tn(new Set)},[P,y,pn,Tn,Cn,tn]);K.useCallback(p=>{switch(p.componentType){case"Resistor":case"ResistorNetwork":case"Thermistor":case"VariableResistor":if("resistance"in p&&p.resistance&&"resistanceUnit"in p&&p.resistanceUnit)return`${p.resistance} ${p.resistanceUnit}`;break;case"Capacitor":case"Electrolytic Capacitor":case"Film Capacitor":if("capacitance"in p&&p.capacitance&&"capacitanceUnit"in p&&p.capacitanceUnit)return`${p.capacitance} ${p.capacitanceUnit}`;break;case"Inductor":if("inductance"in p&&p.inductance&&"inductanceUnit"in p&&p.inductanceUnit)return`${p.inductance} ${p.inductanceUnit}`;break;case"Battery":if("voltage"in p&&p.voltage&&"voltageUnit"in p&&p.voltageUnit)return`${p.voltage} ${p.voltageUnit}`;break;case"Diode":if("voltage"in p&&p.voltage&&"voltageUnit"in p&&p.voltageUnit)return`${p.voltage} ${p.voltageUnit}`;break;case"Fuse":if("current"in p&&p.current&&"currentUnit"in p&&p.currentUnit)return`${p.current} ${p.currentUnit}`;break;case"FerriteBead":if("impedance"in p&&p.impedance&&"impedanceUnit"in p&&p.impedanceUnit)return`${p.impedance} ${p.impedanceUnit}`;break;case"Relay":if("coilVoltage"in p&&p.coilVoltage&&"coilVoltageUnit"in p&&p.coilVoltageUnit)return`${p.coilVoltage} ${p.coilVoltageUnit}`;break;case"Speaker":if("impedance"in p&&p.impedance&&"impedanceUnit"in p&&p.impedanceUnit)return`${p.impedance} ${p.impedanceUnit}`;break;case"Motor":if("voltage"in p&&p.voltage&&"voltageUnit"in p&&p.voltageUnit)return`${p.voltage} ${p.voltageUnit}`;break;case"PowerSupply":if("outputVoltage"in p&&p.outputVoltage&&"outputVoltageUnit"in p&&p.outputVoltageUnit)return`${p.outputVoltage} ${p.outputVoltageUnit}`;break;case"Transistor":if("partNumber"in p&&p.partNumber)return p.partNumber;break;case"IntegratedCircuit":if("partNumber"in p&&p.partNumber)return p.partNumber;break}return null},[]);const dd=K.useCallback(p=>{const S=[];switch(p.componentType){case"Capacitor":case"Electrolytic Capacitor":case"Film Capacitor":"capacitance"in p&&p.capacitance&&"capacitanceUnit"in p&&p.capacitanceUnit&&S.push(`Capacitance: ${p.capacitance} ${p.capacitanceUnit}`),"voltage"in p&&p.voltage&&"voltageUnit"in p&&p.voltageUnit&&S.push(`Voltage: ${p.voltage} ${p.voltageUnit}`),"dielectric"in p&&p.dielectric&&S.push(`Dielectric: ${p.dielectric}`);break;case"Resistor":case"ResistorNetwork":case"Thermistor":"resistance"in p&&p.resistance&&"resistanceUnit"in p&&p.resistanceUnit&&S.push(`Resistance: ${p.resistance} ${p.resistanceUnit}`),"power"in p&&p.power&&S.push(`Power: ${p.power}`),"tolerance"in p&&p.tolerance&&S.push(`Tolerance: ${p.tolerance}`);break;case"VariableResistor":"resistance"in p&&p.resistance&&"resistanceUnit"in p&&p.resistanceUnit&&S.push(`Resistance: ${p.resistance} ${p.resistanceUnit}`),"vrType"in p&&p.vrType&&S.push(`Type: ${p.vrType}`),"power"in p&&p.power&&S.push(`Power: ${p.power}`),"taper"in p&&p.taper&&S.push(`Taper: ${p.taper}`);break;case"Inductor":"inductance"in p&&p.inductance&&"inductanceUnit"in p&&p.inductanceUnit&&S.push(`Inductance: ${p.inductance} ${p.inductanceUnit}`),"current"in p&&p.current&&"currentUnit"in p&&p.currentUnit&&S.push(`Current: ${p.current} ${p.currentUnit}`),"tolerance"in p&&p.tolerance&&S.push(`Tolerance: ${p.tolerance}`);break;case"Battery":"voltage"in p&&p.voltage&&"voltageUnit"in p&&p.voltageUnit&&S.push(`Voltage: ${p.voltage} ${p.voltageUnit}`),"capacity"in p&&p.capacity&&"capacityUnit"in p&&p.capacityUnit&&S.push(`Capacity: ${p.capacity} ${p.capacityUnit}`);break;case"Diode":"voltage"in p&&p.voltage&&"voltageUnit"in p&&p.voltageUnit&&S.push(`Voltage: ${p.voltage} ${p.voltageUnit}`),"current"in p&&p.current&&"currentUnit"in p&&p.currentUnit&&S.push(`Current: ${p.current} ${p.currentUnit}`);break;case"Fuse":"current"in p&&p.current&&"currentUnit"in p&&p.currentUnit&&S.push(`Current: ${p.current} ${p.currentUnit}`),"voltage"in p&&p.voltage&&"voltageUnit"in p&&p.voltageUnit&&S.push(`Voltage: ${p.voltage} ${p.voltageUnit}`);break;case"FerriteBead":"impedance"in p&&p.impedance&&"impedanceUnit"in p&&p.impedanceUnit&&S.push(`Impedance: ${p.impedance} ${p.impedanceUnit}`),"current"in p&&p.current&&"currentUnit"in p&&p.currentUnit&&S.push(`Current: ${p.current} ${p.currentUnit}`);break;case"Relay":"coilVoltage"in p&&p.coilVoltage&&"coilVoltageUnit"in p&&p.coilVoltageUnit&&S.push(`Coil Voltage: ${p.coilVoltage} ${p.coilVoltageUnit}`),"contactRating"in p&&p.contactRating&&S.push(`Contact Rating: ${p.contactRating}`);break;case"Speaker":"impedance"in p&&p.impedance&&"impedanceUnit"in p&&p.impedanceUnit&&S.push(`Impedance: ${p.impedance} ${p.impedanceUnit}`),"power"in p&&p.power&&S.push(`Power: ${p.power}`);break;case"Motor":"voltage"in p&&p.voltage&&"voltageUnit"in p&&p.voltageUnit&&S.push(`Voltage: ${p.voltage} ${p.voltageUnit}`),"speed"in p&&p.speed&&"speedUnit"in p&&p.speedUnit&&S.push(`Speed: ${p.speed} ${p.speedUnit}`);break;case"PowerSupply":"outputVoltage"in p&&p.outputVoltage&&"outputVoltageUnit"in p&&p.outputVoltageUnit&&S.push(`Output Voltage: ${p.outputVoltage} ${p.outputVoltageUnit}`),"outputCurrent"in p&&p.outputCurrent&&"outputCurrentUnit"in p&&p.outputCurrentUnit&&S.push(`Output Current: ${p.outputCurrent} ${p.outputCurrentUnit}`);break;case"Transistor":"partNumber"in p&&p.partNumber&&S.push(`Part Number: ${p.partNumber}`),"transistorType"in p&&p.transistorType&&S.push(`Type: ${p.transistorType}`);break;case"Crystal":"frequency"in p&&p.frequency&&S.push(`Frequency: ${p.frequency}`),"loadCapacitance"in p&&p.loadCapacitance&&S.push(`Load Capacitance: ${p.loadCapacitance}`),"tolerance"in p&&p.tolerance&&S.push(`Tolerance: ${p.tolerance}`);break;case"VacuumTube":"tubeType"in p&&p.tubeType&&S.push(`Tube Type: ${p.tubeType}`),"partNumber"in p&&p.partNumber&&S.push(`Part Number: ${p.partNumber}`);break}return S},[]),[Fl,zd]=K.useState(!1),ud=K.useRef(null),[Ah,ru]=K.useState(!1),[Th,au]=K.useState(!1),ou=K.useRef(null),lu=K.useRef(null),cu=K.useRef(null),Fu=K.useRef(null),[Ep,Uu]=K.useState(!1),[cc,Ch]=K.useState(null),[f0,Sf]=K.useState(null),[Yc,Rp]=K.useState(null),Hu=Ct.useRef(null),Af=Ct.useRef(null),_h=Ct.useRef(null),kh=K.useRef(null),jh=K.useRef(null),qu=K.useRef(null),Vu=K.useRef(null),Wu=K.useRef(null),du=K.useRef(null),[Dp,Lp]=K.useState(null),[Vo,Tf]=K.useState(!1),[hd,Cf]=K.useState(null),[Nc,$u]=K.useState(null);Ct.useEffect(()=>{Af.current=Yc},[Yc]),Ct.useEffect(()=>{_h.current=cc},[cc]);const _f=K.useCallback(async(p,S)=>{if(!S)throw new Error("No project directory available. Please create or open a project before loading images. The project directory is needed to store image files.");try{let L;try{L=await S.getDirectoryHandle("images",{create:!0})}catch(he){throw new Error(`Failed to create images directory in project folder. This may be due to insufficient permissions. Please ensure you have write access to the project directory. Error details: ${he.message}`)}const Q=p.name,oe=`images/${Q}`;try{const V=await(await L.getFileHandle(Q,{create:!0})).createWritable();return await V.write(p),await V.close(),console.log(`Image copied to project directory: ${oe}`),oe}catch(he){throw new Error(`Failed to copy image file "${Q}" to project images directory. The file may be locked by another application, or there may be insufficient disk space. Please try again or check your disk space. Error details: ${he.message}`)}}catch(L){throw L instanceof Error&&L.message.includes("No project directory")||L instanceof Error&&L.message.includes("Failed to")?L:new Error(`An unexpected error occurred while copying the image to the project directory. This may be due to file system permissions or disk space issues. Please try again. Technical details: ${L.message}`)}},[]),kf=K.useCallback(async(p,S)=>{try{const L=p.name.toLowerCase(),oe=[".png",".jpg",".jpeg"].some(be=>L.endsWith(be)),V=["image/png","image/jpeg","image/jpg"].includes(p.type);if(!oe&&!V){alert(`Error: Unsupported image format.

The software only accepts PNG and JPEG image files.

File selected: ${p.name}
File type: ${p.type||"unknown"}

Please select a .png, .jpg, or .jpeg image file.`);return}let Ae;if(ki)try{Ae=await _f(p,ki)}catch(be){const ye=be instanceof Error?be.message:"Unknown error occurred while copying image to project directory.";alert(`Error: ${ye}

The image could not be loaded. Please ensure you have a project open and have write permissions to the project directory.`);return}else{if(!confirm(`Warning: No project directory is currently open. The image will be loaded, but you must create or open a project and save it before the image will be stored in the project directory.

Do you want to continue loading the ${S==="top"?"top":"bottom"} image?`))return;Ae=p.name}const fe=await createImageBitmap(p),je=URL.createObjectURL(p),ke=rs.current;let Ce=0,ge=0;ke&&(Ce=Ci.x,ge=Ci.y);const Se={url:je,name:p.name,width:fe.width,height:fe.height,filePath:Ae,x:Ce,y:ge,scale:1,rotation:0,flipX:!1,flipY:!1,skewX:0,skewY:0,keystoneV:0,keystoneH:0,bitmap:fe};S==="top"?n(Se):o(Se)}catch(L){const Q=L instanceof Error?L.message:"Unknown error occurred while loading the image.";alert(`Error: Failed to load image file "${p.name}".

${Q}

Please ensure the file is a valid image format (PNG, JPEG, etc.) and is not corrupted.`),console.error("Failed to load image",L)}},[Ci,At,ki,_f]),Id=K.useCallback(p=>{p.stopPropagation(),p.preventDefault();const S=rs.current;if(!S)return;document.activeElement!==S&&S.focus();const L=S.getBoundingClientRect(),Q=S.width/L.width,oe=S.height/L.height,he=p.nativeEvent.offsetX,V=p.nativeEvent.offsetY,Ae=typeof he=="number"?he:p.clientX-L.left,fe=typeof V=="number"?V:p.clientY-L.top,je=Ae*Q,ke=fe*oe,Ce=je-5,ge=ke-5,Se=Qf(Ce,ge,es,At,ei,Ji),be=Se.x,ye=Se.y;if(kc.current&&k==="select"){Dr(!0),Dd({start:{x:be,y:ye},end:{x:be,y:ye}});return}if(k==="center"){ar(!0),Js.current&&clearTimeout(Js.current),Js.current=setTimeout(()=>{ar(!1),j("select"),ya(void 0)},2e3);return}if(k==="select"){if(Zs){let ze=1/0,Xe=null,Ye=null;const dt=Math.max(6/At,4),Xt=[...It,...Yt].find(kn=>kn.id===Zs.componentId)?.layer||"top";for(const kn of ft)if((kn.type==="via"||kn.type==="pad")&&kn.points.length>0){if(kn.type==="pad"&&(kn.layer||"top")!==Xt)continue;const _n=kn.points[0],Bn=Math.max(1,kn.size/2),Xn=Math.hypot(_n.x-be,_n.y-ye),Ft=Math.max(Bn,dt);Xn<=Ft&&Xn<ze&&(ze=Xn,Xe=_n.id??null,Ye=kn)}if(Ye?(console.log(`
[PIN CONNECTION] Found via!`),console.log(`  Stroke ID: ${Ye.id}`),console.log(`  Point ID: ${Xe}`),console.log(`  Point coordinates: x=${Ye.points[0].x.toFixed(2)}, y=${Ye.points[0].y.toFixed(2)}`),console.log(`  Click coordinates: x=${be.toFixed(2)}, y=${ye.toFixed(2)}`),console.log(`  Distance: ${ze.toFixed(2)}`),console.log(`  Via size: ${Ye.size}, radius: ${Math.max(1,Ye.size/2)}`)):(console.log(`
[PIN CONNECTION] No via found!`),console.log(`  Click coordinates: x=${be.toFixed(2)}, y=${ye.toFixed(2)}`),console.log(`  Hit tolerance: ${dt.toFixed(2)}`),console.log(`  Total vias in drawingStrokes: ${ft.filter(kn=>kn.type==="via").length}`)),Xe!=null){console.log(`
[PIN CONNECTION] Proceeding with connection...`),console.log(`  bestPointId is valid: ${Xe} (type: ${typeof Xe})`);const kn=String(Xe),_n=Zs.pinIndex,Bn=Zs.componentId;console.log(`
=== PIN CONNECTION START ===`),console.log(`Connecting pin ${_n} (Pin ${_n+1}) of component ${Bn} to point ID ${kn}`);const Xn=It.find(jt=>jt.id===Bn),Ft=Yt.find(jt=>jt.id===Bn);Xn?(console.log("Component found in TOP layer"),Pi(jt=>{const cn=jt.find(Kn=>Kn.id===Bn);if(!cn)return console.error(`Component ${Bn} not found in TOP layer during update!`),jt;console.log("BEFORE update: pinConnections =",cn.pinConnections);const cs=cn.pinConnections||[],Bi=cs.length>0?[...cs]:new Array(cn.pinCount).fill("");let ds;if(Bi.length!==cn.pinCount){ds=new Array(cn.pinCount).fill("");for(let Kn=0;Kn<Math.min(Bi.length,cn.pinCount);Kn++)ds[Kn]=Bi[Kn]||""}else ds=[...Bi];ds[_n]=kn,console.log(`Updating pin ${_n} with value: ${kn}`),console.log("New pinConnections array:",ds);const tr=jt.map(Kn=>Kn.id===Bn?{...Kn,pinConnections:ds}:Kn),Yi=tr.find(Kn=>Kn.id===Bn);return console.log("AFTER update: pinConnections =",Yi?.pinConnections),console.log(`Pin ${_n} value: ${Yi?.pinConnections[_n]}`),console.log(`=== PIN CONNECTION COMPLETE (TOP) ===
`),tr})):Ft?(console.log("Component found in BOTTOM layer"),Gn(jt=>{const cn=jt.find(Kn=>Kn.id===Bn);if(!cn)return console.error(`Component ${Bn} not found in BOTTOM layer during update!`),jt;console.log("BEFORE update: pinConnections =",cn.pinConnections);const cs=cn.pinConnections||[],Bi=cs.length>0?[...cs]:new Array(cn.pinCount).fill("");let ds;if(Bi.length!==cn.pinCount){ds=new Array(cn.pinCount).fill("");for(let Kn=0;Kn<Math.min(Bi.length,cn.pinCount);Kn++)ds[Kn]=Bi[Kn]||""}else ds=[...Bi];ds[_n]=kn,console.log(`Updating pin ${_n} with value: ${kn}`),console.log("New pinConnections array:",ds);const tr=jt.map(Kn=>Kn.id===Bn?{...Kn,pinConnections:ds}:Kn),Yi=tr.find(Kn=>Kn.id===Bn);return console.log("AFTER update: pinConnections =",Yi?.pinConnections),console.log(`Pin ${_n} value: ${Yi?.pinConnections[_n]}`),console.log(`=== PIN CONNECTION COMPLETE (BOTTOM) ===
`),tr})):(console.error(`Component ${Bn} not found in either TOP or BOTTOM layer!`),console.log("Available TOP components:",It.map(jt=>jt.id)),console.log("Available BOTTOM components:",Yt.map(jt=>jt.id))),setTimeout(()=>{rl(null)},0);return}else rl(null)}const Le=10,Ee=(()=>{for(const ze of It)if(be>=ze.x-Le&&be<=ze.x+Le&&ye>=ze.y-Le&&ye<=ze.y+Le)return{layer:"top",comp:ze};for(const ze of Yt)if(be>=ze.x-Le&&be<=ze.x+Le&&ye>=ze.y-Le&&ye<=ze.y+Le)return{layer:"bottom",comp:ze};return null})();if(Ee){const{comp:ze}=Ee;p.shiftKey?Cn(Xe=>{const Ye=new Set(Xe);return Ye.has(ze.id)?Ye.delete(ze.id):Ye.add(ze.id),Ye}):(Cn(new Set([ze.id])),Tn(new Set),tn(new Set),pn(new Set));return}const qe=Math.max(6/At,4);let ct=null;for(const ze of Rn){const Xe=Math.max(6,ze.size/2),Ye=Xe*.8,dt=Xe+Ye,kt=Math.hypot(ze.x-be,ze.y-ye),Xt=Math.abs(be-ze.x)<=qe&&Math.abs(ye-ze.y)<=dt,kn=Math.abs(ye-ze.y)<=qe&&Math.abs(be-ze.x)<=dt;if(kt<=Math.max(Xe,qe)||Xt||kn){ct=ze;break}}if(ct){p.shiftKey?tn(ze=>{const Xe=new Set(ze);return Xe.has(ct.id)?Xe.delete(ct.id):Xe.add(ct.id),Xe}):(tn(new Set([ct.id])),Tn(new Set),Cn(new Set),pn(new Set));return}let ht=null;for(const ze of y){const Xe=Math.max(6,(ze.size||18)/2),Ye=Xe*.8,dt=Xe+Ye,kt=Math.hypot(ze.x-be,ze.y-ye),Xt=Math.abs(be-ze.x)<=qe&&Math.abs(ye-ze.y)<=dt,kn=Math.abs(ye-ze.y)<=qe&&Math.abs(be-ze.x)<=dt;if(kt<=Math.max(Xe,qe)||Xt||kn){ht=ze;break}}if(ht){p.shiftKey?pn(ze=>{const Xe=new Set(ze);return Xe.has(ht.id)?Xe.delete(ht.id):Xe.add(ht.id),Xe}):(pn(new Set([ht.id])),Tn(new Set),Cn(new Set),tn(new Set));return}const it=Math.max(6/At,4/At),He=Math.max(it,.5);let Ve=null;for(const ze of ft)if((ze.type==="via"||ze.type==="pad"||ze.type==="testPoint")&&ze.points.length>0){let Xe=!1;if(ze.type==="via"?Xe=lr:ze.type==="pad"?Xe=(ze.layer||"top")==="top"?cr:Gr:ze.type==="testPoint"&&(Xe=(ze.layer||"top")==="top"?fs:vo),!Xe)continue;const Ye=ze.points[0],dt=Math.max(1,ze.size/2);if(Math.hypot(Ye.x-be,Ye.y-ye)<=Math.max(dt,He)){Ve=ze;break}}if(Ve){p.shiftKey?Tn(ze=>{const Xe=new Set(ze);return Xe.has(Ve.id)?Xe.delete(Ve.id):Xe.add(Ve.id),Xe}):(Tn(new Set([Ve.id])),Cn(new Set),tn(new Set),pn(new Set),We(new Set));return}p.shiftKey||(Tn(new Set),Cn(new Set),tn(new Set),pn(new Set),We(new Set)),xa(!0),Cf({x:be,y:ye,shiftKey:p.shiftKey}),$u({x:be,y:ye,width:0,height:0});return}else if(k==="magnify"){const Le=p.shiftKey?.5:2,Ee=Math.max(.25,Math.min(8,At*Le));Wa(be,ye),fi(Ee);return}else if(k==="pan"){const Le={topImageX:t?.x??0,topImageY:t?.y??0,bottomImageX:s?.x??0,bottomImageY:s?.y??0,componentsTop:Object.fromEntries(It.map(Ee=>[Ee.id,{x:Ee.x,y:Ee.y}])),componentsBottom:Object.fromEntries(Yt.map(Ee=>[Ee.id,{x:Ee.x,y:Ee.y}])),powerSymbols:Object.fromEntries(we.map(Ee=>[Ee.id,{x:Ee.x,y:Ee.y}])),groundSymbols:Object.fromEntries(Fe.map(Ee=>[Ee.id,{x:Ee.x,y:Ee.y}])),drawingStrokes:ft.map(Ee=>({points:Ee.points.map(qe=>({x:qe.x,y:qe.y}))})),vias:na.map(Ee=>({x:Ee.x,y:Ee.y})),pads:Qi.map(Ee=>({x:Ee.x,y:Ee.y}))};Fo.current={startCX:Ce,startCY:ge,panX:es.x,panY:es.y,objectStartPositions:Le},ec.current={startClientX:p.clientX,startClientY:p.clientY,panX:es.x,panY:es.y,objectStartPositions:Le},Ac(!0);return}else if(k==="draw"){const Le=(ct,ht)=>{let wt=1/0,it=null;const He=10/At,Ve=At>20?Math.max(He,1e-4):At>10?Math.max(He,.001):Math.max(He,.01);for(const Ye of ft)if(Ye.type==="via"){const dt=Ye.points[0],kt=Math.hypot(dt.x-ct,dt.y-ht);kt<=Ve&&kt<wt&&(wt=kt,it=dt)}else if(Ye.type==="pad"){const dt=Ye.points[0],kt=Math.hypot(dt.x-ct,dt.y-ht);kt<=Ve&&kt<wt&&(wt=kt,it=dt)}for(const Ye of Rn)if(Ye.pointId!==void 0){const dt=Math.hypot(Ye.x-ct,Ye.y-ht);dt<=Ve&&dt<wt&&(wt=dt,it={x:Ye.x,y:Ye.y,id:Ye.pointId})}for(const Ye of y)if(Ye.pointId!==void 0){const dt=Math.hypot(Ye.x-ct,Ye.y-ht);dt<=Ve&&dt<wt&&(wt=dt,it={x:Ye.x,y:Ye.y,id:Ye.pointId})}const Xe=is(it??{x:ct,y:ht});return{x:Xe.x,y:Xe.y,nodeId:it?.id}};if(lt==="via"){const ct=Ln.get("via"),ht=ct.color,wt=ct.size,zt=Vo?{x:is({x:be,y:ye}).x,y:is({x:be,y:ye}).y}:((Ye,dt)=>{let kt=1/0,Xt=null;const _n=10/At,Bn=At>10?Math.max(_n,.001):Math.max(_n,.01);for(const jt of ft)if(jt.type==="via"||jt.type==="pad"){const cn=jt.points[0],cs=Math.hypot(cn.x-Ye,cn.y-dt);cs<=Bn&&cs<kt&&(kt=cs,Xt=cn)}for(const jt of Rn)if(jt.pointId!==void 0){const cn=Math.hypot(jt.x-Ye,jt.y-dt);cn<=Bn&&cn<kt&&(kt=cn,Xt={x:jt.x,y:jt.y,id:jt.pointId})}for(const jt of y)if(jt.pointId!==void 0){const cn=Math.hypot(jt.x-Ye,jt.y-dt);cn<=Bn&&cn<kt&&(kt=cn,Xt={x:jt.x,y:jt.y,id:jt.pointId})}const Ft=is(Xt??{x:Ye,y:dt});return{x:Ft.x,y:Ft.y,nodeId:Xt?.id}})(be,ye),He=zt.nodeId??Xc(),Ve=So(He,gn),ze={id:He,x:zt.x,y:zt.y};hn(ft,It,Yt,we,Fe);const Xe={id:`${Date.now()}-via`,points:[ze],color:ht,size:wt,layer:$t,type:"via",viaType:Ve};_t(Ye=>[...Ye,Xe]),$t==="top"?kr(Ye=>[...Ye,Xe.id]):sl(Ye=>[...Ye,Xe.id]);return}if(lt==="pad"){if(!xi)return;const ht=Vo?{x:is({x:be,y:ye}).x,y:is({x:be,y:ye}).y}:((Xe,Ye)=>{let dt=1/0,kt=null;const kn=10/At,_n=At>10?Math.max(kn,.001):Math.max(kn,.01);for(const Ft of ft)if(Ft.type==="via"||Ft.type==="pad"||Ft.type==="testPoint"){const jt=Ft.points[0],cn=Math.hypot(jt.x-Xe,jt.y-Ye);cn<=_n&&cn<dt&&(dt=cn,kt=jt)}for(const Ft of Rn)if(Ft.pointId!==void 0){const jt=Math.hypot(Ft.x-Xe,Ft.y-Ye);jt<=_n&&jt<dt&&(dt=jt,kt={x:Ft.x,y:Ft.y,id:Ft.pointId})}for(const Ft of y)if(Ft.pointId!==void 0){const jt=Math.hypot(Ft.x-Xe,Ft.y-Ye);jt<=_n&&jt<dt&&(dt=jt,kt={x:Ft.x,y:Ft.y,id:Ft.pointId})}const Xn=is(kt??{x:Xe,y:Ye});return{x:Xn.x,y:Xn.y,nodeId:kt?.id}})(be,ye),wt=ht.nodeId??Xc(),it=Jr(wt,gn),zt=F||(xi==="top"?J:_e),He=X||(xi==="top"?Z:H),Ve={id:wt,x:ht.x,y:ht.y};hn(ft,It,Yt,we,Fe);const ze={id:`${Date.now()}-pad`,points:[Ve],color:zt,size:He,layer:xi,type:"pad",padType:it};_t(Xe=>[...Xe,ze]);return}if(lt==="testPoint"){if(!En)return;const ht=Vo?{x:is({x:be,y:ye}).x,y:is({x:be,y:ye}).y}:((Ye,dt)=>{let kt=1/0,Xt=null;const kn=15;for(const Xn of ft)if(Xn.type==="via"||Xn.type==="pad"||Xn.type==="testPoint"){const Ft=Xn.points[0],jt=Math.hypot(Ft.x-Ye,Ft.y-dt);jt<=kn&&jt<kt&&(kt=jt,Xt=Ft)}for(const Xn of Rn)if(Xn.pointId!==void 0){const Ft=Math.hypot(Xn.x-Ye,Xn.y-dt);Ft<=kn&&Ft<kt&&(kt=Ft,Xt={x:Xn.x,y:Xn.y,id:Xn.pointId})}for(const Xn of y)if(Xn.pointId!==void 0){const Ft=Math.hypot(Xn.x-Ye,Xn.y-dt);Ft<=kn&&Ft<kt&&(kt=Ft,Xt={x:Xn.x,y:Xn.y,id:Xn.pointId})}const Bn=is(Xt??{x:Ye,y:dt});return{x:Bn.x,y:Bn.y,nodeId:Xt?.id}})(be,ye),wt=ht.nodeId??Xc(),it=ml(wt,gn),zt=it.includes("Power")?"power":it.includes("Ground")?"ground":it.includes("Signal")?"signal":"unknown",He=is({x:ht.x,y:ht.y}),Ve=F||(En==="top"?ue:Pe),ze=X||(En==="top"?Re:Je);hn(ft,It,Yt,we,Fe);const Xe={id:`${Date.now()}-testPoint`,points:[{id:wt,x:He.x,y:He.y}],color:Ve,size:ze,layer:En,type:"testPoint",testPointType:zt};_t(Ye=>[...Ye,Xe]);return}if(qn.current)return;const Ee=lt==="trace"&&!Vo?Le(be,ye):{x:is({x:be,y:ye}).x,y:is({x:be,y:ye}).y},qe=Ee.nodeId!==void 0?{id:Ee.nodeId,x:Ee.x,y:Ee.y}:{x:Ee.x,y:Ee.y};Nn(ct=>ct.length===0?[qe]:[...ct,qe]),Vi.current=Date.now(),Sn(null),Jt(!1),qa(!1)}else if(k==="erase"){if(ft.some(Ee=>Ee.layer===$t&&(Ee.type==="via"&&Ei||Ee.type==="pad"&&as||Ee.type==="testPoint"&&Nr||Ee.type==="trace"&&pr))){const Ee=[];Ei&&ft.some(qe=>qe.layer===$t&&qe.type==="via")&&Ee.push("vias"),as&&ft.some(qe=>qe.layer===$t&&qe.type==="pad")&&Ee.push("pads"),Nr&&ft.some(qe=>qe.layer===$t&&qe.type==="testPoint")&&Ee.push("test points"),pr&&ft.some(qe=>qe.layer===$t&&qe.type==="trace")&&Ee.push("traces"),Ee.length>0&&alert(`Cannot erase: ${Ee.join(", ")} are locked on the ${$t} layer. Unlock them to erase.`)}Jt(!0),Nn([{id:Xc(),x:be,y:ye}]),console.log("Starting erase at:",be,ye,"selectedDrawingLayer:",$t,"total strokes:",ft.length)}else if(k==="transform"&&Kt){if(Ni){alert("Cannot transform: Images are locked. Unlock images to transform them.");return}Ir(!0),Zt({x:be,y:ye})}else if(k==="component"){if(!_h.current)return;const Le=is({x:be,y:ye}),qe=($a.current||"top")==="top"?"componentTop":"componentBottom",ct=Ln.get(qe),ht=ct.color,wt=ct.size,it=[...It,...Yt];let zt;if(Ht?zt=rm():zt={...Hn.current},!$a.current)return;const He=Af.current?.dataDrivenDefinition;if(!He){console.error("[Component Creation] Missing dataDrivenDefinition metadata for selected component.");return}let Ve;try{Ve=h5({definition:He,layer:$a.current,x:Le.x,y:Le.y,color:ht,size:wt,existingComponents:it,counters:ts?zt:{}})}catch(ze){console.error("[Component Creation] Error creating component with v2 runtime:",ze);return}if(Ve.abbreviation=jm(_h.current),ts&&Ve.designator){const ze=Ve.designator.match(/^([A-Za-z]+)(\d+)$/);if(ze){const Xe=ze[1],Ye=parseInt(ze[2],10);if(Ht){const dt=rm();l5(Xe,Ye,dt)}else Hn.current[Xe]=Math.max(Hn.current[Xe]||0,Ye)}}hn(ft,It,Yt,we,Fe),$a.current==="top"?(Ho(!0),Pi(ze=>[...ze,Ve])):(ra(!0),Gn(ze=>[...ze,Ve]));return}else if(k==="power"){if(!Be)return;const Ee=Vo?{x:is({x:be,y:ye}).x,y:is({x:be,y:ye}).y}:((ct,ht)=>{let wt=1/0,it=null;const He=10/At,Ve=At>20?Math.max(He,1e-4):At>10?Math.max(He,.001):Math.max(He,.01);for(const Ye of ft)if(Ye.type==="via"||Ye.type==="pad"){const dt=Ye.points[0],kt=Math.hypot(dt.x-ct,dt.y-ht);kt<=Ve&&kt<wt&&(wt=kt,it=dt)}else if(Ye.type==="trace")for(const dt of Ye.points){const kt=Math.hypot(dt.x-ct,dt.y-ht);kt<=Ve&&kt<wt&&(wt=kt,it=dt)}const Xe=is(it??{x:ct,y:ht});return{x:Xe.x,y:Xe.y,nodeId:it?.id}})(be,ye),qe=gn.find(ct=>ct.id===Be);if(qe){const ct=Ee.nodeId??Xc(),ht=`${qe.voltage} Power Node`;if(y.find(zt=>zt.pointId===ct)){po({visible:!0,title:"Node ID Conflict",message:`Cannot place power node: A ground node already exists at this Node ID (${ct}). Power and ground nodes cannot share the same Node ID.`});return}hn(ft,It,Yt,we,Fe);const it={id:`power-${Date.now()}-${Math.random()}`,x:Ee.x,y:Ee.y,color:"#ff0000",size:X,powerBusId:qe.id,layer:$t,type:ht,pointId:ct};if(De(zt=>[...zt,it]),Ee.nodeId!==void 0){const zt=So(Ee.nodeId,gn),He=Jr(Ee.nodeId,gn),Ve=ml(Ee.nodeId,gn),ze=Ve.includes("Power")?"power":Ve.includes("Ground")?"ground":Ve.includes("Signal")?"signal":"unknown";_t(Xe=>Xe.map(Ye=>Ye.type==="via"&&Ye.points.length>0&&Ye.points[0].id===Ee.nodeId?{...Ye,viaType:zt}:Ye.type==="pad"&&Ye.points.length>0&&Ye.points[0].id===Ee.nodeId?{...Ye,padType:He}:Ye.type==="testPoint"&&Ye.points.length>0&&Ye.points[0].id===Ee.nodeId?{...Ye,testPointType:ze}:Ye))}}return}else if(k==="ground"){if(Bt===null){if(P.length===0){po({visible:!0,title:"No Ground Bus",message:"No ground buses are defined. Please create a ground bus first using Tools  Manage Ground Buses."});return}rn(!0);return}const Le=P.find(Ee=>Ee.id===Bt);if(Le){const qe=Vo?{x:is({x:be,y:ye}).x,y:is({x:be,y:ye}).y}:((zt,He)=>{let Ve=1/0,ze=null;const Ye=10/At,dt=At>20?Math.max(Ye,1e-4):At>10?Math.max(Ye,.001):Math.max(Ye,.01);for(const kn of ft)if(kn.type==="via"||kn.type==="pad"){const _n=kn.points[0],Bn=Math.hypot(_n.x-zt,_n.y-He);Bn<=dt&&Bn<Ve&&(Ve=Bn,ze=_n)}else if(kn.type==="trace")for(const _n of kn.points){const Bn=Math.hypot(_n.x-zt,_n.y-He);Bn<=dt&&Bn<Ve&&(Ve=Bn,ze=_n)}const Xt=is(ze??{x:zt,y:He});return{x:Xt.x,y:Xt.y,nodeId:ze?.id}})(be,ye),ct=qe.nodeId??Xc(),ht=`${Le.name} Ground Node`,wt=Rn.find(zt=>zt.pointId===ct);if(wt){po({visible:!0,title:"Node ID Conflict",message:`Cannot place ground node: A power node (${wt.type||"Power Node"}) already exists at this Node ID (${ct}). Power and ground nodes cannot share the same Node ID.`});return}hn(ft,It,Yt,we,Fe);const it={id:`gnd-${Date.now()}-${Math.random().toString(36).slice(2,6)}`,x:qe.x,y:qe.y,color:Le.color,size:X||Un.get("ground")?.settings.size||18,groundBusId:Le.id,layer:$t,type:ht,pointId:ct};if(rt(zt=>[...zt,it]),qe.nodeId!==void 0){const zt=So(qe.nodeId,gn),He=Jr(qe.nodeId,gn);_t(Ve=>Ve.map(ze=>ze.type==="via"&&ze.points.length>0&&ze.points[0].id===qe.nodeId?{...ze,viaType:zt}:ze.type==="pad"&&ze.points.length>0&&ze.points[0].id===qe.nodeId?{...ze,padType:He}:ze))}}return}},[k,Kt,X,F,lt,$t,ft,At,es.x,es.y,ei,Ji,Vo,Be,Bt,gn,P,cc,Un,xi,$n,En,Rn,y,So,Jr,ml,lr,cr,Gr]),Mp=K.useCallback(p=>{if(k!=="magnify")return;p.preventDefault();const S=rs.current;if(!S)return;const L=S.getBoundingClientRect(),Q=S.width/L.width,oe=S.height/L.height,he=p.nativeEvent.offsetX,V=p.nativeEvent.offsetY,Ae=typeof he=="number"?he:p.clientX-L.left,fe=typeof V=="number"?V:p.clientY-L.top,je=Ae*Q,ke=fe*oe,Ce=je-5,ge=ke-5,Se=Qf(Ce,ge,es,At,ei,Ji),be=Se.x,ye=Se.y,Le=1.2,Ee=1/Le,qe=p.deltaY<0?Le:Ee,ct=Math.max(.25,Math.min(8,At*qe));Wa(be,ye),fi(ct)},[k,At,es.x,es.y,ei,Ji]),zp=K.useCallback(p=>{if(k==="draw"&&lt==="trace"){qn.current=!0;let qe=zn;if(qe.length>1){const ct=[qe[0]];for(let ht=1;ht<qe.length;ht++){const wt=ct[ct.length-1],it=qe[ht];(Math.abs(wt.x-it.x)>.001||Math.abs(wt.y-it.y)>.001)&&ct.push(it)}qe=ct}if(qe.length>=1){hn(ft,It,Yt,we,Fe);const ct=$n||"top",ht=ct==="top"?"traceTop":"traceBottom",wt=Ln.get(ht),it={id:`${Date.now()}-trace`,points:qe,color:wt.color,size:wt.size,layer:ct,type:"trace"};_t(zt=>[...zt,it]),ct==="top"?Ya(zt=>[...zt,it.id]):jr(zt=>[...zt,it.id]),Nn([]),Sn(null),setTimeout(()=>{qn.current=!1},300);return}}const S=rs.current;if(!S)return;const L=S.getBoundingClientRect(),Q=S.width/L.width,oe=S.height/L.height,he=p.nativeEvent.offsetX,V=p.nativeEvent.offsetY,Ae=typeof he=="number"?he:p.clientX-L.left,fe=typeof V=="number"?V:p.clientY-L.top,je=Ae*Q,ke=fe*oe,Ce=je-5,ge=ke-5,Se=Qf(Ce,ge,es,At,ei,Ji),be=Se.x,ye=Se.y,Le=Math.max(8/At,4),Ee=(()=>{for(const qe of ft)if(qe.type==="testPoint"&&qe.points.length>0){const ct=qe.points[0],ht=Math.hypot(ct.x-be,ct.y-ye),wt=(qe.size||18)/2;if(ht<=wt+Le)return qe}return null})();if(Ee){Tn(new Set([Ee.id])),Cn(new Set),tn(new Set),pn(new Set),gi(!0);return}if(k==="select"||k==="component"){const ct=(()=>{for(const it of It)if(be>=it.x-10&&be<=it.x+10&&ye>=it.y-10&&ye<=it.y+10)return{layer:"top",comp:it};for(const it of Yt)if(be>=it.x-10&&be<=it.x+10&&ye>=it.y-10&&ye<=it.y+10)return{layer:"bottom",comp:it};return null})(),ht=Math.max(6/At,4);let wt=null;for(const it of Rn){const zt=Math.max(6,it.size/2),He=zt*.8,Ve=zt+He,ze=Math.hypot(it.x-be,it.y-ye),Xe=Math.abs(be-it.x)<=ht&&Math.abs(ye-it.y)<=Ve,Ye=Math.abs(ye-it.y)<=ht&&Math.abs(be-it.x)<=Ve;if(ze<=Math.max(zt,ht)||Xe||Ye){wt=it;break}}if(wt){tn(new Set([wt.id])),Vt({visible:!0,id:wt.id,layer:wt.layer,x:wt.x,y:wt.y,size:wt.size,color:wt.color,powerBusId:wt.powerBusId});return}if(ct){const{layer:it,comp:zt}=ct;Eo(zt,it)}}},[k,lt,F,X,$t,It,Yt,Rn,At,es.x,es.y,ei,Ji,cc,Vo,ft,Kt,pl,Dp,Zs,Un,zn,$n,G,_,te,re,gi,Tn,Cn,tn,pn,Eo]),Gu=K.useCallback(()=>{const p=An.current;if(k==="draw"&&lt==="trace"&&p.length>=2){let S=[p[0]];for(let V=1;V<p.length;V++){const Ae=S[S.length-1],fe=p[V];(Math.abs(Ae.x-fe.x)>.001||Math.abs(Ae.y-fe.y)>.001)&&S.push(fe)}const L=$n||"top",Q=L==="top"?"traceTop":"traceBottom",oe=Ln.get(Q),he={id:`${Date.now()}-trace`,points:S,color:oe.color,size:oe.size,layer:L,type:"trace"};hn(ft,It,Yt,we,Fe),_t(V=>[...V,he]),L==="top"?Ya(V=>[...V,he.id]):jr(V=>[...V,he.id]),Nn([]),Sn(null)}else if(k==="draw"&&lt==="trace"&&p.length===1){const S=$n||"top",L=S==="top"?"traceTop":"traceBottom",Q=Ln.get(L),oe={id:`${Date.now()}-trace-dot`,points:p,color:Q.color,size:Q.size,layer:S,type:"trace"};_t(he=>[...he,oe]),S==="top"?Ya(he=>[...he,oe.id]):jr(he=>[...he,oe.id]),Nn([])}},[k,lt,$n,G,_,te,re,_t]),Yu=K.useCallback((p,S,L)=>{const Q=S-p.x,oe=L-p.y;if(Q===0&&oe===0)return{x:S,y:L};const V=(t5(Q,oe)%180+180)%180,Ae=[0,45,90];let fe=0,je=1e9;for(const ke of Ae){const Ce=Math.abs(V-ke);Ce<je&&(je=Ce,fe=ke)}if(fe===0)return{x:S,y:p.y};if(fe===90)return{x:p.x,y:L};{const ke=Math.min(Math.abs(Q),Math.abs(oe)),Ce=Q>=0?1:-1,ge=oe>=0?1:-1;return{x:p.x+Ce*ke,y:p.y+ge*ke}}},[]),Ip=K.useCallback(p=>{const S=rs.current?.getBoundingClientRect();if(!S)return;const L=p.clientX-S.left,Q=p.clientY-S.top,oe=rs.current,he=oe.width/S.width,V=oe.height/S.height,Ae=L*he,fe=Q*V,je=Ae-5,ke=fe-5,Ce=Qf(je,ke,es,At,ei,Ji),ge=Ce.x,Se=Ce.y;if(Bo({x:ge,y:Se}),rc.current&&wo.current&&Dd({start:wo.current.start,end:{x:ge,y:Se}}),k==="draw"&&lt==="trace"&&zn.length>0){const ye=Vo?{x:is({x:ge,y:Se}).x,y:is({x:ge,y:Se}).y}:((Le,Ee)=>{let qe=1/0,ct=null;const wt=10/At,it=At>20?Math.max(wt,1e-4):At>10?Math.max(wt,.001):Math.max(wt,.01);for(const Ve of ft)if(Ve.type==="via"){const ze=Ve.points[0],Xe=Math.hypot(ze.x-Le,ze.y-Ee);Xe<=it&&Xe<qe&&(qe=Xe,ct=ze)}else if(Ve.type==="pad"){const ze=Ve.points[0],Xe=Math.hypot(ze.x-Le,ze.y-Ee);Xe<=it&&Xe<qe&&(qe=Xe,ct=ze)}for(const Ve of Rn)if(Ve.pointId!==void 0){const ze=Math.hypot(Ve.x-Le,Ve.y-Ee);ze<=it&&ze<qe&&(qe=ze,ct={x:Ve.x,y:Ve.y,id:Ve.pointId})}for(const Ve of y)if(Ve.pointId!==void 0){const ze=Math.hypot(Ve.x-Le,Ve.y-Ee);ze<=it&&ze<qe&&(qe=ze,ct={x:Ve.x,y:Ve.y,id:Ve.pointId})}const He=is(ct??{x:Le,y:Ee});return{x:He.x,y:He.y,nodeId:ct?.id}})(ge,Se);Sn({x:ye.x,y:ye.y})}else Sn(null);if(Oa){const ye=(()=>{for(const Le of It)if(ge>=Le.x-10&&ge<=Le.x+10&&Se>=Le.y-10&&Se<=Le.y+10)return{layer:"top",comp:Le};for(const Le of Yt)if(ge>=Le.x-10&&ge<=Le.x+10&&Se>=Le.y-10&&Se<=Le.y+10)return{layer:"bottom",comp:Le};return null})();if(ye)Tc({component:ye.comp,layer:ye.layer,x:p.clientX,y:p.clientY}),nc(null);else{Tc(null);const Le=Math.max(8/At,4),Ee=(()=>{for(const qe of ft)if(qe.type==="testPoint"&&qe.points.length>0){const ct=qe.points[0],ht=Math.hypot(ct.x-ge,ct.y-Se),wt=(qe.size||18)/2;if(ht<=wt+Le)return qe}return null})();nc(Ee?{stroke:Ee,x:p.clientX,y:p.clientY}:null)}}else Tc(null),nc(null);if(k==="select"&&Hc&&hd){const be=hd.x,ye=hd.y;$u({x:Math.min(be,ge),y:Math.min(ye,Se),width:Math.abs(ge-be),height:Math.abs(Se-ye)})}else if(k==="pan"&&pl&&Fo.current){const{startCX:be,startCY:ye,objectStartPositions:Le}=Fo.current,Ee=je-be,qe=ke-ye,ct=sx(Ee,qe,At,ei,Ji),ht=ct.x,wt=ct.y;Le&&(t&&n({...t,x:Le.topImageX+ht,y:Le.topImageY+wt}),s&&o({...s,x:Le.bottomImageX+ht,y:Le.bottomImageY+wt}),Pi(It.map(it=>({...it,x:(Le.componentsTop?.[it.id]?.x??it.x)+ht,y:(Le.componentsTop?.[it.id]?.y??it.y)+wt}))),Gn(Yt.map(it=>({...it,x:(Le.componentsBottom?.[it.id]?.x??it.x)+ht,y:(Le.componentsBottom?.[it.id]?.y??it.y)+wt}))),De(we.map(it=>({...it,x:(Le.powerSymbols?.[it.id]?.x??it.x)+ht,y:(Le.powerSymbols?.[it.id]?.y??it.y)+wt}))),rt(Fe.map(it=>({...it,x:(Le.groundSymbols?.[it.id]?.x??it.x)+ht,y:(Le.groundSymbols?.[it.id]?.y??it.y)+wt}))),_t(ft.map((it,zt)=>({...it,points:it.points.map((He,Ve)=>{const ze=Le.drawingStrokes?.[zt]?.points?.[Ve];return{...He,x:(ze?.x??He.x)+ht,y:(ze?.y??He.y)+wt}})}))),Et(na.map((it,zt)=>{const He=Le.vias?.[zt];return{...it,x:(He?.x??it.x)+ht,y:(He?.y??it.y)+wt}})),fr(Qi.map((it,zt)=>{const He=Le.pads?.[zt];return{...it,x:(He?.x??it.x)+ht,y:(He?.y??it.y)+wt}})))}else if(On&&zn.length>0){if(k==="draw")if(pa){const be=zn[0],ye=Yu(be,ge,Se),Le=is(ye),Ee={id:Xc(),x:Le.x,y:Le.y};Nn([be,Ee])}else{const be=is({x:ge,y:Se});Nn(ye=>[...ye,{id:Xc(),x:be.x,y:be.y}])}else if(k==="erase"&&(Nn(be=>[...be,{id:Xc(),x:ge,y:Se}]),_t(be=>{const ye=be.filter(Ee=>{if(Ee.type==="via"&&Ei||Ee.type==="pad"&&as||Ee.type==="testPoint"&&Nr||Ee.type==="trace"&&pr||Ee.layer!==$t)return!0;const qe=X/2,ct=ge-qe,ht=ge+qe,wt=Se-qe,it=Se+qe,zt=(ze,Xe)=>ze>=ct&&ze<=ht&&Xe>=wt&&Xe<=it,He=(ze,Xe,Ye,dt)=>{const Xn=(tr,Yi)=>{let Kn=0;return tr<ct?Kn|=1:tr>ht&&(Kn|=2),Yi<wt?Kn|=4:Yi>it&&(Kn|=8),Kn};let Ft=ze,jt=Xe,cn=Ye,cs=dt,Bi=Xn(Ft,jt),ds=Xn(cn,cs);for(;;){if((Bi|ds)===0)return!0;if((Bi&ds)!==0)return!1;const tr=Bi!==0?Bi:ds;let Yi=0,Kn=0;tr&8?(Yi=Ft+(cn-Ft)*(it-jt)/(cs-jt),Kn=it):tr&4?(Yi=Ft+(cn-Ft)*(wt-jt)/(cs-jt),Kn=wt):tr&2?(Kn=jt+(cs-jt)*(ht-Ft)/(cn-Ft),Yi=ht):(Kn=jt+(cs-jt)*(ct-Ft)/(cn-Ft),Yi=ct),tr===Bi?(Ft=Yi,jt=Kn,Bi=Xn(Ft,jt)):(cn=Yi,cs=Kn,ds=Xn(cn,cs))}};let Ve=!1;if(Ee.points.length===1){const ze=Ee.points[0];Ve=zt(ze.x,ze.y)}else for(let ze=0;ze<Ee.points.length-1;ze++){const Xe=Ee.points[ze],Ye=Ee.points[ze+1];if(He(Xe.x,Xe.y,Ye.x,Ye.y)){Ve=!0;break}}return Ve&&console.log("Erasing stroke at position:",ge,Se,"brushSize:",X,"selectedLayer:",$t),!Ve});console.log("Strokes before:",be.length,"after:",ye.length);const Le=new Set(ye.map(Ee=>Ee.id));return kr(Ee=>Ee.filter(qe=>Le.has(qe))),sl(Ee=>Ee.filter(qe=>Le.has(qe))),Ya(Ee=>Ee.filter(qe=>Le.has(qe))),jr(Ee=>Ee.filter(qe=>Le.has(qe))),ye}),oi||De(be=>{const ye=X/2,Le=ge-ye,Ee=ge+ye,qe=Se-ye,ct=Se+ye,ht=wt=>{const it=wt.size/2,zt=wt.x-it,He=wt.x+it,Ve=wt.y-it,ze=wt.y+it;return!(Ee<zt||Le>He||ct<Ve||qe>ze)};return be.filter(wt=>!ht(wt))}),gr||rt(be=>{const ye=X/2,Le=ge-ye,Ee=ge+ye,qe=Se-ye,ct=Se+ye,ht=it=>{const zt=Math.max(6,(it.size||18)/2),He=zt*.8,Ve=zt+He,ze=it.x-Ve,Xe=it.x+Ve,Ye=it.y-Ve,dt=it.y+Ve;return!(Ee<ze||Le>Xe||ct<Ye||qe>dt)};return be.filter(it=>!ht(it))}),!Hs)){const be=X/2,ye=ge-be,Le=ge+be,Ee=Se-be,qe=Se+be,ct=ht=>{const it=(ht.size||18)/2,zt=ht.x-it,He=ht.x+it,Ve=ht.y-it,ze=ht.y+it;return!(Le<zt||ye>He||qe<Ve||Ee>ze)};hn(ft,It,Yt,we,Fe),Pi(ht=>ht.filter(wt=>!ct(wt))),Gn(ht=>ht.filter(wt=>!ct(wt)))}}else if(Ks&&Br&&Kt){if(Ni){Ir(!1),Zt(null);return}const be=ge-Br.x,ye=Se-Br.y;if(Kt==="top"){t&&n(Le=>Le?{...Le,x:Le.x+be,y:Le.y+ye}:null),Zt({x:ge,y:Se});return}if(Kt==="bottom"){s&&o(Le=>Le?{...Le,x:Le.x+be,y:Le.y+ye}:null),Zt({x:ge,y:Se});return}if(Kt==="both"){t&&n(Le=>Le?{...Le,x:Le.x+be,y:Le.y+ye}:null),s&&o(Le=>Le?{...Le,x:Le.x+be,y:Le.y+ye}:null),Zt({x:ge,y:Se});return}}},[On,zn,k,X,Ks,Br,Kt,t,s,pa,Yu,$t,_t,At,es.x,es.y,ei,Ji,Hc,hd,Ni,Ei,as,pr,oi,gr,It,Yt,Pi,Gn,Oa,Tc,Vo,ft,Rn,y,zn,lt,on,Sn,pl,Fo,Po,5,es,Xc,is,j,ar,hn,we,Fe,Bo]),Nh=K.useCallback(()=>{if(Bo(null),kc.current&&wo.current&&Ps.current&&rc.current){const p=wo.current,S=Ps.current,L=Math.abs(p.end.x-p.start.x),Q=Math.abs(p.end.y-p.start.y);if(L>=1&&Q>=1)try{const oe=BC({numPins:S.numPins,type:S.type,twoSidedOrientation:S.twoSidedOrientation,point1:p.start,point2:p.end}),he=new Set(ft.flatMap(fe=>fe.points.map(je=>je.id||0).filter(je=>je>0))),V=he.size>0?Math.max(...Array.from(he))+1:1,Ae=oe.map((fe,je)=>{const ke=gl.current?(xi||"top")==="top"?"padTop":"padBottom":"via",Ce=Ln.get(ke),ge=V+je,Se=gl.current&&xi||"top";return{id:ge.toString(),type:gl.current?"pad":"via",points:[{x:fe.x,y:fe.y,id:ge}],size:Ce.size,color:Ce.color,layer:Se}});_t(fe=>{const je=[...fe,...Ae];return hn(je,It,Yt,we,Fe),je})}catch(oe){console.error("IC Placement error:",oe),alert(`Error placing ${gl.current?"pads":"vias"}: ${oe instanceof Error?oe.message:String(oe)}`)}xh(!1),Dd(null),Rd(null),Dr(!1),kc.current=!1,wo.current=null,Ps.current=null,rc.current=!1,ya(void 0),j("select");return}if(k==="select"&&Hc){const p=Nc,S=hd;if(xa(!1),Cf(null),$u(null),p&&S){const oe=Math.max(3,5/At),he=p.width<oe&&p.height<oe,V=(He,Ve)=>{const ze=p.x,Xe=p.y,Ye=p.x+p.width,dt=p.y+p.height;return He>=ze&&He<=Ye&&Ve>=Xe&&Ve<=dt},Ae=(He,Ve,ze,Xe,Ye,dt,kt,Xt)=>{const jt=(Kn,Go)=>{let yl=0;return Kn<Ye?yl|=1:Kn>kt&&(yl|=2),Go<dt?yl|=4:Go>Xt&&(yl|=8),yl};let cn=He,cs=Ve,Bi=ze,ds=Xe,tr=jt(cn,cs),Yi=jt(Bi,ds);for(;;){if((tr|Yi)===0)return!0;if((tr&Yi)!==0)return!1;const Kn=tr!==0?tr:Yi;let Go=0,yl=0;Kn&8?(Go=cn+(Bi-cn)*(Xt-cs)/(ds-cs),yl=Xt):Kn&4?(Go=cn+(Bi-cn)*(dt-cs)/(ds-cs),yl=dt):Kn&2?(yl=cs+(ds-cs)*(kt-cn)/(Bi-cn),Go=kt):(yl=cs+(ds-cs)*(Ye-cn)/(Bi-cn),Go=Ye),Kn===tr?(cn=Go,cs=yl,tr=jt(cn,cs)):(Bi=Go,ds=yl,Yi=jt(Bi,ds))}},fe=p.x,je=p.y,ke=p.x+p.width,Ce=p.y+p.height,Se=Math.max(6/At,4/At,.5),be=(He,Ve,ze,Xe,Ye,dt)=>{const kt=Ye-ze,Xt=dt-Xe;if(kt===0&&Xt===0)return Math.hypot(He-ze,Ve-Xe);const kn=Math.max(0,Math.min(1,((He-ze)*kt+(Ve-Xe)*Xt)/(kt*kt+Xt*Xt))),_n=ze+kn*kt,Bn=Xe+kn*Xt;return Math.hypot(He-_n,Ve-Bn)},ye=S?.shiftKey===!0,Le=new Set(ye?Array.from(ti):[]),Ee=new Set(ye?Array.from(ln):[]),qe=new Set(ye?Array.from(ri):[]),ct=new Set(ye?Array.from(ai):[]),ht=S?.hitStrokeId;if(ht){const He=ft.find(Ve=>Ve.id===ht);if(He){let Ve=!1;if(He.type==="via"||He.type==="pad"?Ve=lr:Ve=He.layer==="top"?js:ys,Ve){ye?Tn(ze=>{const Xe=new Set(ze);return Xe.has(ht)?Xe.delete(ht):Xe.add(ht),Xe}):(Tn(new Set([ht])),Cn(new Set),tn(new Set),pn(new Set));return}}}if(he){let He=null;for(const Ve of ft){let ze=!1;if(Ve.type==="via"?ze=lr:Ve.type==="pad"?ze=(Ve.layer||"top")==="top"?cr:Gr:Ve.type==="testPoint"?ze=(Ve.layer||"top")==="top"?fs:vo:Ve.type==="trace"?ze=Ve.layer==="top"?js:ys:ze=!1,!ze)continue;let Xe=1/0;if(Ve.type==="via"||Ve.type==="pad"||Ve.type==="testPoint"){const Ye=Ve.points[0],dt=Math.max(1,Ve.size/2);Xe=Math.hypot(Ye.x-S.x,Ye.y-S.y);const Xt=Math.max(6/At,4/At,.5);Xe<=Math.max(dt,Xt)&&(!He||Xe<He.dist)&&(He={id:Ve.id,dist:Xe})}else for(let Ye=0;Ye<Ve.points.length-1;Ye++){const dt=Ve.points[Ye],kt=Ve.points[Ye+1],Xt=be(S.x,S.y,dt.x,dt.y,kt.x,kt.y);if(Xt<=Math.max(Se,Ve.size/2)){(!He||Xt<He.dist)&&(He={id:Ve.id,dist:Xt});break}}}He&&(ye&&Le.has(He.id)?Le.delete(He.id):Le.add(He.id))}else for(const He of ft){let Ve=!1;if(He.type==="via"?Ve=lr:He.type==="pad"?Ve=(He.layer||"top")==="top"?cr:Gr:He.type==="testPoint"?Ve=(He.layer||"top")==="top"?fs:vo:He.type==="trace"?Ve=He.layer==="top"?js:ys:Ve=!1,!Ve)continue;let ze=!1;if(He.type==="via"||He.type==="pad"||He.type==="testPoint"){const Xe=He.points[0];ze=V(Xe.x,Xe.y)}else for(let Xe=0;Xe<He.points.length-1;Xe++){const Ye=He.points[Xe],dt=He.points[Xe+1];if(Ae(Ye.x,Ye.y,dt.x,dt.y,fe,je,ke,Ce)||V(Ye.x,Ye.y)&&V(dt.x,dt.y)){ze=!0;break}}ze&&(ye&&Le.has(He.id)?Le.delete(He.id):Le.add(He.id))}const wt=He=>{const ze=Math.max(10,He.size||18)/2;return He.x-ze<=ke&&He.x+ze>=fe&&He.y-ze<=Ce&&He.y+ze>=je};if(he){const He=Ve=>{const Xe=Math.max(10,Ve.size||18)/2;return S.x>=Ve.x-Xe&&S.x<=Ve.x+Xe&&S.y>=Ve.y-Xe&&S.y<=Ve.y+Xe};io&&It.forEach(Ve=>{He(Ve)&&(ye&&Ee.has(Ve.id)?Ee.delete(Ve.id):Ee.add(Ve.id))}),Di&&Yt.forEach(Ve=>{He(Ve)&&(ye&&Ee.has(Ve.id)?Ee.delete(Ve.id):Ee.add(Ve.id))})}else io&&It.forEach(He=>{wt(He)&&(ye&&Ee.has(He.id)?Ee.delete(He.id):Ee.add(He.id))}),Di&&Yt.forEach(He=>{wt(He)&&(ye&&Ee.has(He.id)?Ee.delete(He.id):Ee.add(He.id))});const it=He=>{const Ve=Math.max(6,He.size/2),ze=Ve*.8,Xe=Ve+ze;return He.x-Xe<=ke&&He.x+Xe>=fe&&He.y-Xe<=Ce&&He.y+Xe>=je};if(_a)if(he){let He=null;for(const Ve of Rn){const ze=Math.max(6,Ve.size/2),Xe=ze*.8,Ye=ze+Xe,dt=Math.hypot(Ve.x-S.x,Ve.y-S.y),kt=Math.abs(S.x-Ve.x)<=Se&&Math.abs(S.y-Ve.y)<=Ye,Xt=Math.abs(S.y-Ve.y)<=Se&&Math.abs(S.x-Ve.x)<=Ye;if(dt<=Math.max(ze,Se)||kt||Xt){const _n=Math.min(dt,Math.abs(S.x-Ve.x)+Math.abs(S.y-Ve.y));(!He||_n<He.dist)&&(He={id:Ve.id,dist:_n})}}He&&(ye&&qe.has(He.id)?qe.delete(He.id):qe.add(He.id))}else Rn.forEach(He=>{it(He)&&(ye&&qe.has(He.id)?qe.delete(He.id):qe.add(He.id))});const zt=He=>{const Ve=Math.max(6,(He.size||18)/2),ze=Ve*.8,Xe=Ve+ze;return He.x-Xe<=ke&&He.x+Xe>=fe&&He.y-Xe<=Ce&&He.y+Xe>=je};if(si)if(he){let He=null;for(const Ve of y){const ze=Math.max(6,(Ve.size||18)/2),Xe=ze*.8,Ye=ze+Xe,dt=Math.hypot(Ve.x-S.x,Ve.y-S.y),kt=Math.abs(S.x-Ve.x)<=Se&&Math.abs(S.y-Ve.y)<=Ye,Xt=Math.abs(S.y-Ve.y)<=Se&&Math.abs(S.x-Ve.x)<=Ye;if(dt<=Math.max(ze,Se)||kt||Xt){const _n=Math.min(dt,Math.abs(S.x-Ve.x)+Math.abs(S.y-Ve.y));(!He||_n<He.dist)&&(He={id:Ve.id,dist:_n})}}He&&(ye&&ct.has(He.id)?ct.delete(He.id):ct.add(He.id))}else y.forEach(He=>{zt(He)&&(ye&&ct.has(He.id)?ct.delete(He.id):ct.add(He.id))});Tn(Le),Cn(Ee),tn(qe),pn(ct)}}if(On&&zn.length>0){if(k==="draw"&&lt!=="trace"){const p={id:Date.now().toString(),points:zn,color:F,size:X,layer:$t,type:"trace"};_t(S=>[...S,p]),$t==="top"?Ya(S=>[...S,p.id]):jr(S=>[...S,p.id])}Nn([])}pl&&(Ac(!1),Fo.current=null,ec.current=null),Jt(!1),Ir(!1),Zt(null),qa(!1)},[On,zn,k,F,X,$t,Nc,hd,Hc,ft,At,Ba,ti,Rn,y,It,Yt,ln,ri,ai,lr,js,ys,io,Di,_a,si,Bo]);Ct.useEffect(()=>{if(!(k==="pan"&&pl&&ec.current))return;const p=L=>{const Q=rs.current;if(!Q)return;const oe=Q.getBoundingClientRect(),he=Q.width/oe.width,V=Q.height/oe.height,{startClientX:Ae,startClientY:fe,objectStartPositions:je}=ec.current,ke=(L.clientX-Ae)*he,Ce=(L.clientY-fe)*V,ge=sx(ke,Ce,At,ei,Ji),Se=ge.x,be=ge.y;je&&(t&&n({...t,x:je.topImageX+Se,y:je.topImageY+be}),s&&o({...s,x:je.bottomImageX+Se,y:je.bottomImageY+be}),Pi(It.map(ye=>({...ye,x:(je.componentsTop?.[ye.id]?.x??ye.x)+Se,y:(je.componentsTop?.[ye.id]?.y??ye.y)+be}))),Gn(Yt.map(ye=>({...ye,x:(je.componentsBottom?.[ye.id]?.x??ye.x)+Se,y:(je.componentsBottom?.[ye.id]?.y??ye.y)+be}))),De(we.map(ye=>({...ye,x:(je.powerSymbols?.[ye.id]?.x??ye.x)+Se,y:(je.powerSymbols?.[ye.id]?.y??ye.y)+be}))),rt(Fe.map(ye=>({...ye,x:(je.groundSymbols?.[ye.id]?.x??ye.x)+Se,y:(je.groundSymbols?.[ye.id]?.y??ye.y)+be}))),_t(ft.map((ye,Le)=>({...ye,points:ye.points.map((Ee,qe)=>{const ct=je.drawingStrokes?.[Le]?.points?.[qe];return{...Ee,x:(ct?.x??Ee.x)+Se,y:(ct?.y??Ee.y)+be}})}))),Et(na.map((ye,Le)=>{const Ee=je.vias?.[Le];return{...ye,x:(Ee?.x??ye.x)+Se,y:(Ee?.y??ye.y)+be}})),fr(Qi.map((ye,Le)=>{const Ee=je.pads?.[Le];return{...ye,x:(Ee?.x??ye.x)+Se,y:(Ee?.y??ye.y)+be}})))},S=()=>{Ac(!1),Fo.current=null,ec.current=null,window.removeEventListener("mousemove",p,!0),window.removeEventListener("mouseup",S,!0)};return window.addEventListener("mousemove",p,!0),window.addEventListener("mouseup",S,!0),()=>{window.removeEventListener("mousemove",p,!0),window.removeEventListener("mouseup",S,!0)}},[k,pl,At,ei,Ji,t,s,It,Yt,we,Fe,ft,na,Qi,n,o,Pi,Gn,De,rt,_t,Et,fr]);const uu=K.useCallback(()=>{const p=rs.current;if(!p)return;const S=p.getContext("2d");if(!S)return;S.clearRect(0,0,p.width,p.height),S.fillStyle="#000000",S.fillRect(0,0,p.width,p.height),S.fillStyle="#ffffff",S.fillRect(5,5,p.width-10,p.height-10),S.save(),S.beginPath(),S.rect(5,5,p.width-10,p.height-10),S.clip(),S.translate(5,5);const L=(Ae,fe,je,ke,Ce,ge,Se,be)=>{const ye=document.createElement("canvas");ye.width=je,ye.height=ke;const Le=ye.getContext("2d",{willReadFrequently:!0});Le.clearRect(0,0,je,ke),Le.drawImage(fe,0,0,je,ke);let Ee=ye;if(Math.abs(Ce)>1e-6){const qe=Yg(Ce),ct=Math.max(.2,1-qe),ht=Math.max(.2,1+qe),wt=Math.max(ct,ht),it=Math.max(1,Math.ceil(je*wt)),zt=document.createElement("canvas");zt.width=it,zt.height=ke;const He=zt.getContext("2d",{willReadFrequently:!0});He.clearRect(0,0,it,ke);for(let Ve=0;Ve<ke;Ve++){const ze=ke<=1?0:Ve/(ke-1),Xe=ct*(1-ze)+ht*ze,Ye=Math.max(1,je*Xe),dt=(it-Ye)/2;He.drawImage(Ee,0,Ve,je,1,dt,Ve,Ye,1)}Ee=zt}if(Math.abs(ge)>1e-6){const qe=Yg(ge),ct=Math.max(.2,1-qe),ht=Math.max(.2,1+qe),wt=Math.max(ct,ht),it=Math.max(1,Math.ceil(ke*wt)),zt=document.createElement("canvas");zt.width=Ee.width,zt.height=it;const He=zt.getContext("2d",{willReadFrequently:!0});He.clearRect(0,0,zt.width,it);for(let Ve=0;Ve<Ee.width;Ve++){const ze=Ee.width<=1?0:Ve/(Ee.width-1),Xe=ct*(1-ze)+ht*ze,Ye=Math.max(1,ke*Xe),dt=(it-Ye)/2;He.drawImage(Ee,Ve,0,1,Ee.height,Ve,dt,1,Ye)}Ee=zt}Ae.drawImage(Ee,-Se/2,-be/2,Se,be)};S.translate(es.x,es.y),S.scale(At,At),n5(S,ei,Ji);{const Ae=Ls&&Ml;if(t&&t.bitmap&&Ls){const fe=t.bitmap;S.save(),S.globalAlpha=1;const je=[];t.brightness!==void 0&&t.brightness!==100&&je.push(`brightness(${t.brightness}%)`),t.contrast!==void 0&&t.contrast!==100&&je.push(`contrast(${t.contrast}%)`),E&&je.push("grayscale(100%)"),S.filter=je.length>0?je.join(" "):"none",Fm(S,{x:t.x,y:t.y,rotation:t.rotation||0,scale:t.scale||1,flipX:t.flipX||!1,flipY:t.flipY||!1,skewX:t.skewX||0,skewY:t.skewY||0});const ke=fe.width*1,Ce=fe.height*1,ge=fe;t.keystoneV&&Math.abs(t.keystoneV)>1e-6||t.keystoneH&&Math.abs(t.keystoneH)>1e-6?L(S,ge,fe.width,fe.height,t.keystoneV||0,t.keystoneH||0,ke,Ce):S.drawImage(ge,-ke/2,-Ce/2,ke,Ce),S.restore()}if(s&&s.bitmap&&Ml){const fe=s.bitmap;S.save(),S.globalAlpha=Ae?h/100:1;const je=[];s.brightness!==void 0&&s.brightness!==100&&je.push(`brightness(${s.brightness}%)`),s.contrast!==void 0&&s.contrast!==100&&je.push(`contrast(${s.contrast}%)`),E&&je.push("grayscale(100%)"),S.filter=je.length>0?je.join(" "):"none",Fm(S,{x:s.x,y:s.y,rotation:s.rotation||0,scale:s.scale||1,flipX:s.flipX||!1,flipY:s.flipY||!1,skewX:s.skewX||0,skewY:s.skewY||0});const ke=fe.width*1,Ce=fe.height*1,ge=fe;s.keystoneV&&Math.abs(s.keystoneV)>1e-6||s.keystoneH&&Math.abs(s.keystoneH)>1e-6?L(S,ge,fe.width,fe.height,s.keystoneV||0,s.keystoneH||0,ke,Ce):S.drawImage(ge,-ke/2,-Ce/2,ke,Ce),S.restore()}}if(Bp(S),_a&&Rn.length>0){const Ae=fe=>{S.save(),ix(S,fe.x,fe.y,fe.rotation??0,fe.flipX??!1,!1);const je=gn.find(be=>be.id===fe.powerBusId),ke=ri.has(fe.id),Ce=je?.color||"#ff0000";S.strokeStyle=Ce,S.lineWidth=Math.max(1,(ke?3:2)/Math.max(At,.001)),S.lineCap="round";const ge=Math.max(6,fe.size/2),Se=ge*.8;if(ke&&(S.strokeStyle="#0066ff",S.lineWidth=Math.max(1,4/Math.max(At,.001)),S.beginPath(),S.arc(0,0,ge+Se+3,0,Ha),S.stroke()),S.strokeStyle=Ce,S.lineWidth=Math.max(1,(ke?3:2)/Math.max(At,.001)),S.beginPath(),S.arc(0,0,ge,0,Ha),S.stroke(),S.beginPath(),S.moveTo(0,-ge-Se),S.lineTo(0,ge+Se),S.stroke(),S.beginPath(),S.moveTo(-ge-Se,0),S.lineTo(ge+Se,0),S.stroke(),je){S.fillStyle=Ce;const be=Math.max(10,ge*.8);S.font=`${be}px sans-serif`,S.textAlign="center",S.textBaseline="top",S.fillText(je.name,0,ge+Se+8)}S.restore()};Rn.forEach(Ae)}if(si&&y.length>0){const Ae=fe=>{S.save(),ix(S,fe.x,fe.y,fe.rotation??0,fe.flipX??!1,!1);const je=ai.has(fe.id),ke=P.find(be=>be.id===fe.groundBusId),Ce=ke?.color||fe.color||"#000000",ge=fe.groundBusId==="groundbus-earth";let Se;if(ge){const be=Math.max(6,fe.size||18),ye=be*.9,Le=be*.24,Ee=be*1.6;S.strokeStyle=Ce,S.lineWidth=Math.max(1,(je?3:2)/Math.max(At,.001)),S.lineCap="round",je&&(S.strokeStyle="#0066ff",S.lineWidth=Math.max(1,4/Math.max(At,.001)),S.setLineDash([5,5]),S.strokeRect(-Ee/2-3,-3,Ee+6,ye+Le*2+6),S.setLineDash([])),S.strokeStyle=Ce,S.lineWidth=Math.max(1,(je?3:2)/Math.max(At,.001)),S.beginPath(),S.moveTo(0,0),S.lineTo(0,ye),S.stroke();for(let qe=0;qe<3;qe++){const ct=ye+qe*Le,ht=Ee*(1-qe*.25);S.beginPath(),S.moveTo(-ht/2,ct),S.lineTo(ht/2,ct),S.stroke()}Se=ye+Le*2}else{const be=Math.max(6,(fe.size||18)/2),ye=be*.8;je&&(S.strokeStyle="#0066ff",S.lineWidth=Math.max(1,4/Math.max(At,.001)),S.beginPath(),S.arc(0,0,be+ye+3,0,Ha),S.stroke()),S.strokeStyle=Ce,S.lineWidth=Math.max(1,(je?3:2)/Math.max(At,.001)),S.beginPath(),S.arc(0,0,be,0,Ha),S.stroke(),S.beginPath(),S.moveTo(0,-be-ye),S.lineTo(0,be+ye),S.stroke(),S.beginPath(),S.moveTo(-be-ye,0),S.lineTo(be+ye,0),S.stroke(),Se=be+ye}if(ke){S.fillStyle=Ce;const be=Math.max(10,(fe.size||18)*.5);S.font=`${be}px sans-serif`,S.textAlign="center",S.textBaseline="top",S.fillText(ke.name,0,Se+8)}S.restore()};y.forEach(Ae)}const Q=Ae=>{const fe=Math.max(10,Ae.size||18),je=fe/2;S.save(),S.translate(Ae.x,Ae.y),i5(S,ei,Ji),Ae.orientation!==void 0&&Ae.orientation!==0&&S.rotate(Kd(Ae.orientation)),Ae.flipX&&S.scale(-1,1),Ae.flipY&&S.scale(1,-1),S.strokeStyle=Ae.color||"#111",S.lineWidth=Math.max(1,2/Math.max(At,.001));const ke=Ae.pinConnections||[],Ce=ke.length>0&&ke.length===Ae.pinCount&&ke.every(be=>be&&be.trim()!=="");S.fillStyle=Ce?"rgba(178, 223, 138, 0.85)":"rgba(255,255,255,0.85)",S.beginPath(),S.rect(-je,-je,fe,fe),S.fill(),S.stroke();const ge=Ae.designator?.trim()||"";if(ge){S.fillStyle=Ae.color||"#111";const be=Math.max(6,fe*.35),ye=fe*.9;let Le=be;S.font=`bold ${Le}px sans-serif`;const Ee=S.measureText(ge);Ee.width>ye&&(Le=ye/Ee.width*Le,Le=Math.max(6,Le),S.font=`bold ${Le}px sans-serif`),S.textAlign="center",S.textBaseline="middle",S.fillText(ge,0,0)}ln.has(Ae.id)&&(S.setLineDash([4,3]),S.strokeStyle="#00bfff",S.lineWidth=1.5,S.strokeRect(-je-3,-je-3,fe+6,fe+6),S.setLineDash([])),S.restore()};if(Ts){const Ae=je=>{const ke=parseInt(je,10);if(isNaN(ke))return null;for(const Ce of ft)if((Ce.type==="via"||Ce.type==="pad"||Ce.type==="testPoint")&&Ce.points.length>0){const ge=Ce.points[0];if(ge.id===ke)return{x:ge.x,y:ge.y}}for(const Ce of ft)if(Ce.type==="trace"){for(const ge of Ce.points)if(ge.id===ke)return{x:ge.x,y:ge.y}}for(const Ce of Rn)if(Ce.pointId===ke)return{x:Ce.x,y:Ce.y};for(const Ce of y)if(Ce.pointId===ke)return{x:Ce.x,y:Ce.y};return null},fe=je=>{const ke=je.pinConnections||[],Ce=Sp(je)&&je.pinPolarities,Se=_d(je)?.category==="Semiconductors",be=new Map;for(let ye=0;ye<ke.length;ye++){const Le=ke[ye];if(Le&&Le.trim()!==""){const Ee=Le.trim(),qe=Se&&ye===0,ct=!!(Ce&&je.pinPolarities&&ye<je.pinPolarities.length&&je.pinPolarities[ye]==="-"),ht=be.get(Ee);ht!==void 0?be.set(Ee,{isNegative:ht.isNegative||ct,hasPin1:ht.hasPin1||qe}):be.set(Ee,{isNegative:ct,hasPin1:qe})}}for(const[ye,Le]of be){const{isNegative:Ee,hasPin1:qe}=Le,ct=Ae(ye);if(ct){const ht={x:je.x,y:je.y},wt=parseInt(ye,10),it=`${je.id}:${wt}`,zt=ut.has(it);S.save(),zt?(S.strokeStyle="#00bfff",S.lineWidth=Math.max(2,nn*1.5/Math.max(At,.001)),S.setLineDash([4,3])):(Ee?S.strokeStyle="rgba(0, 0, 0, 0.8)":qe?S.strokeStyle=s5(Ot,.4):S.strokeStyle=Ot,S.lineWidth=Math.max(1,nn/Math.max(At,.001))),S.beginPath(),S.moveTo(ht.x,ht.y),S.lineTo(ct.x,ct.y),S.stroke(),S.setLineDash([]),S.restore()}}};io&&It.forEach(fe),Di&&Yt.forEach(fe)}if(io&&It.forEach(Q),Di&&Yt.forEach(Q),qo&&_c){S.save();const Ae=_c.start,fe=_c.end,je=Math.min(Ae.x,fe.x),ke=Math.min(Ae.y,fe.y),Ce=Math.max(Ae.x,fe.x),ge=Math.max(Ae.y,fe.y),Se=Ce-je,be=ge-ke,ye=Math.max(2,6/Math.max(1e-4,At));S.strokeStyle="#ff8800",S.fillStyle="rgba(255, 136, 0, 0.2)",S.lineWidth=Math.max(1,2/Math.max(1e-4,At)),S.setLineDash([ye,ye]),S.beginPath(),S.rect(je,ke,Se,be),S.fill(),S.stroke(),S.fillStyle="#ff8800",S.beginPath(),S.arc(Ae.x,Ae.y,Math.max(3,6/Math.max(1e-4,At)),0,Math.PI*2),S.fill(),S.setLineDash([]),S.restore()}if(k==="select"&&Nc){S.save();const Ae=Math.max(2,6/Math.max(1e-4,At));S.strokeStyle="#00bfff",S.fillStyle="rgba(0, 191, 255, 0.15)",S.lineWidth=Math.max(1,1.5/Math.max(1e-4,At)),S.setLineDash([Ae,Ae]),S.beginPath(),S.rect(Nc.x,Nc.y,Nc.width,Nc.height),S.fill(),S.stroke(),S.setLineDash([]),S.restore()}S.save();const oe=50,V=2/At;S.strokeStyle="#FF0000",S.lineWidth=V,S.lineCap="round",S.lineJoin="round",S.beginPath(),S.moveTo(-oe,0),S.lineTo(oe,0),S.stroke(),S.fillStyle="#FF0000",S.font=`${12/At}px sans-serif`,S.textAlign="left",S.textBaseline="top",S.fillText("+X",oe+2/At,2/At),S.textAlign="right",S.fillText("-X",-oe-2/At,2/At),S.strokeStyle="#0000FF",S.lineWidth=V,S.lineCap="round",S.lineJoin="round",S.beginPath(),S.moveTo(0,-oe),S.lineTo(0,oe),S.stroke(),S.fillStyle="#0000FF",S.font=`${12/At}px sans-serif`,S.textAlign="left",S.textBaseline="top",S.fillText("+Y",2/At,oe+2/At),S.textBaseline="bottom",S.fillText("-Y",2/At,-oe-2/At),S.restore(),S.restore()},[t,s,h,ft,zn,On,k,F,X,E,Kt,$t,At,es.x,es.y,ei,Ji,Ls,Ml,lr,js,ys,cr,Gr,fs,vo,io,Di,It,Yt,_a,Rn,si,y,Ts,Nc,ti,ln,ri,ai,ut,$n,G,_,te,re,lt,on,Ni,Ot,nn,Ms,Ci,qo,_c]);Ct.useEffect(()=>{const p=()=>{const S=qc.current;if(!S)return;const L=1.6,Q=244,oe=12,he=6,V=12,Ae=S.clientWidth-Q-oe,fe=S.getBoundingClientRect(),je=window.innerHeight,ke=fe.top,ge=je-ke-he-10,Se=Math.min(S.clientHeight-V,ge),be=Math.floor(Se*L),ye=Math.floor(Ae/L);let Le,Ee;be<=Ae?(Le=be,Ee=Se):(Le=Ae,Ee=ye),Le=Math.max(600,Le),Ee=Math.max(375,Ee),Ee=Math.max(355,Ee-20),sa(qe=>{const ct=qe.width===0&&qe.height===0,ht=qe.width!==Le||qe.height!==Ee;return ct&&ht&&setTimeout(()=>{Si({x:0,y:0})},0),qe.width===Le&&qe.height===Ee?qe:{width:Le,height:Ee}})};return p(),window.addEventListener("resize",p),()=>window.removeEventListener("resize",p)},[Po,Si]),Ct.useEffect(()=>{Ni&&(Ks&&(Ir(!1),Zt(null)),Tr(null))},[Ni,Ks,Ir,Zt,Tr]);const Bp=K.useCallback(p=>{if(ft.forEach(S=>{if(S.type==="via"||S.type==="pad"||S.type==="testPoint"||S.testPointType!==void 0||S.type!=="trace")return;let L=!1;if(S.layer==="top"?L=js:S.layer==="bottom"&&(L=ys),!!L){if(S.points.length===1){const Q=S.points[0],oe=Math.max(.5,S.size/2);ti.has(S.id)&&(p.strokeStyle="#00bfff",p.lineWidth=2,p.setLineDash([4,3]),p.beginPath(),p.arc(Q.x,Q.y,oe+3,0,Ha),p.stroke(),p.setLineDash([])),p.fillStyle=S.color,p.beginPath(),p.arc(Q.x,Q.y,oe,0,Ha),p.fill()}else if(ti.has(S.id)&&(p.strokeStyle="#00bfff",p.lineWidth=S.size+4,p.lineCap="round",p.lineJoin="round",p.globalAlpha=.6,p.beginPath(),S.points.forEach((Q,oe)=>{oe===0?p.moveTo(Q.x,Q.y):p.lineTo(Q.x,Q.y)}),p.stroke(),p.globalAlpha=1),p.strokeStyle=S.color,p.lineWidth=S.size,p.lineCap="round",p.lineJoin="round",p.globalAlpha=1,p.beginPath(),S.points.forEach((Q,oe)=>{oe===0?p.moveTo(Q.x,Q.y):p.lineTo(Q.x,Q.y)}),p.stroke(),Ms){p.fillStyle="#000000";for(const Q of S.points)p.beginPath(),p.arc(Q.x,Q.y,S.size/2,0,Ha),p.fill()}}}),ft.forEach(S=>{if(S.type==="via"){if(!lr)return}else if(S.type==="pad"){const Q=S.layer||"top";if(Q==="top"&&!cr||Q==="bottom"&&!Gr)return}else if(S.type==="testPoint"){const Q=S.layer||"top";if(Q==="top"&&!fs||Q==="bottom"&&!vo)return}else return;const L=S.points[0];if(ti.has(S.id)){if(S.type==="via"){const Q=Math.max(.5,S.size/2)+3;p.strokeStyle="#00bfff",p.lineWidth=2,p.setLineDash([4,3]),p.beginPath(),p.arc(L.x,L.y,Q,0,Ha),p.stroke(),p.setLineDash([])}else if(S.type==="pad"){const Q=Math.max(.5,S.size/2)+3;p.strokeStyle="#00bfff",p.lineWidth=2,p.setLineDash([4,3]),p.strokeRect(L.x-Q,L.y-Q,S.size+6,S.size+6),p.setLineDash([])}else if(S.type==="testPoint"){const Q=Math.max(.5,S.size/2)+3;p.strokeStyle="#00bfff",p.lineWidth=2,p.setLineDash([4,3]),p.beginPath(),p.moveTo(L.x,L.y-Q),p.lineTo(L.x+Q,L.y),p.lineTo(L.x,L.y+Q),p.lineTo(L.x-Q,L.y),p.closePath(),p.stroke(),p.setLineDash([])}}if(S.type==="via"){const Q=Math.max(.5,S.size/2),oe=Q*.5,he=Q*.7;p.fillStyle=S.color,p.beginPath(),p.arc(L.x,L.y,Q,0,Ha),p.arc(L.x,L.y,oe,0,Ha),p.fill("evenodd"),p.strokeStyle="#808080",p.lineWidth=1,p.beginPath(),p.moveTo(L.x-he,L.y),p.lineTo(L.x+he,L.y),p.stroke(),p.beginPath(),p.moveTo(L.x,L.y-he),p.lineTo(L.x,L.y+he),p.stroke()}else if(S.type==="pad"){const Q=Math.max(.5,S.size/2),oe=S.size,he=oe*.5,V=Q*.7;p.fillStyle=S.color,p.beginPath(),p.rect(L.x-Q,L.y-Q,oe,oe),p.rect(L.x-he/2,L.y-he/2,he,he),p.fill("evenodd"),p.strokeStyle="#808080",p.lineWidth=1,p.beginPath(),p.moveTo(L.x-V,L.y),p.lineTo(L.x+V,L.y),p.stroke(),p.beginPath(),p.moveTo(L.x,L.y-V),p.lineTo(L.x,L.y+V),p.stroke()}else if(S.type==="testPoint"){const Q=Math.max(.5,S.size/2),oe=Q*.7;p.fillStyle=S.color||"#FFFF00",p.strokeStyle="#000000",p.lineWidth=2,p.beginPath(),p.moveTo(L.x,L.y-Q),p.lineTo(L.x+Q,L.y),p.lineTo(L.x,L.y+Q),p.lineTo(L.x-Q,L.y),p.closePath(),p.fill(),p.stroke(),p.strokeStyle="#808080",p.lineWidth=1,p.beginPath(),p.moveTo(L.x-oe,L.y),p.lineTo(L.x+oe,L.y),p.stroke(),p.beginPath(),p.moveTo(L.x,L.y-oe),p.lineTo(L.x,L.y+oe),p.stroke()}}),zn.length>0){const S=$t;let L=!0;if(k==="draw"&&(lt==="via"?L=lr:L=S==="top"?js:ys),L)if(k==="draw")if(lt==="via"){const Q=zn[zn.length-1],oe=Math.max(.5,X/2),he=oe*.5,V=oe*.7;p.fillStyle=F,p.beginPath(),p.arc(Q.x,Q.y,oe,0,Ha),p.arc(Q.x,Q.y,he,0,Ha),p.fill("evenodd"),p.strokeStyle="#808080",p.lineWidth=1,p.beginPath(),p.moveTo(Q.x-V,Q.y),p.lineTo(Q.x+V,Q.y),p.stroke(),p.beginPath(),p.moveTo(Q.x,Q.y-V),p.lineTo(Q.x,Q.y+V),p.stroke()}else if(lt==="pad"){const Q=zn[zn.length-1],oe=Math.max(.5,X/2),he=X,V=he*.5,Ae=oe*.7;p.fillStyle=F,p.beginPath(),p.rect(Q.x-oe,Q.y-oe,he,he),p.rect(Q.x-V/2,Q.y-V/2,V,V),p.fill("evenodd"),p.strokeStyle="#808080",p.lineWidth=1,p.beginPath(),p.moveTo(Q.x-Ae,Q.y),p.lineTo(Q.x+Ae,Q.y),p.stroke(),p.beginPath(),p.moveTo(Q.x,Q.y-Ae),p.lineTo(Q.x,Q.y+Ae),p.stroke()}else if(lt==="testPoint"){const Q=zn[zn.length-1],oe=Math.max(.5,X/2),he=oe*.7;p.fillStyle=F,p.beginPath(),p.moveTo(Q.x,Q.y-oe),p.lineTo(Q.x+oe,Q.y),p.lineTo(Q.x,Q.y+oe),p.lineTo(Q.x-oe,Q.y),p.closePath(),p.fill(),p.strokeStyle="#808080",p.lineWidth=1,p.beginPath(),p.moveTo(Q.x-he,Q.y),p.lineTo(Q.x+he,Q.y),p.stroke(),p.beginPath(),p.moveTo(Q.x,Q.y-he),p.lineTo(Q.x,Q.y+he),p.stroke()}else{const Q=$n||"top",oe=Q==="top"?G:_,he=Q==="top"?te:re;if(zn.length===1){const V=zn[0],Ae=Math.max(.5,he/2);p.fillStyle=oe,p.beginPath(),p.arc(V.x,V.y,Ae,0,Ha),p.fill(),on&&(p.strokeStyle=oe,p.lineWidth=he,p.lineCap="round",p.lineJoin="round",p.globalAlpha=.6,p.beginPath(),p.moveTo(V.x,V.y),p.lineTo(on.x,on.y),p.stroke(),p.globalAlpha=1)}else if(p.strokeStyle=oe,p.lineWidth=he,p.lineCap="round",p.lineJoin="round",p.globalAlpha=1,p.beginPath(),zn.forEach((V,Ae)=>{Ae===0?p.moveTo(V.x,V.y):p.lineTo(V.x,V.y)}),p.stroke(),on&&zn.length>0){const V=zn[zn.length-1];p.globalAlpha=.6,p.beginPath(),p.moveTo(V.x,V.y),p.lineTo(on.x,on.y),p.stroke(),p.globalAlpha=1}}else k==="erase"&&(p.strokeStyle="rgba(255, 0, 0, 0.5)",p.lineWidth=X,p.lineCap="round",p.lineJoin="round",p.globalAlpha=.5,p.beginPath(),zn.forEach((Q,oe)=>{oe===0?p.moveTo(Q.x,Q.y):p.lineTo(Q.x,Q.y)}),p.stroke())}},[ft,ti,js,ys,lr,cr,Gr,fs,vo,zn,k,lt,F,X,$t,$n,G,_,te,re,on,Ms]),jf=K.useCallback((p,S)=>{if(Ni){alert("Cannot transform: Images are locked. Unlock images to transform them.");return}p==="top"&&t?n(L=>L?{...L,...S}:null):p==="bottom"&&s?o(L=>L?{...L,...S}:null):p==="both"&&(t&&n(L=>L?{...L,...S}:null),s&&o(L=>L?{...L,...S}:null))},[t,s,Ni]),Ph=K.useCallback(()=>{Kt&&(jf(Kt,{x:0,y:0,scale:1,rotation:0,flipX:!1,flipY:!1,skewX:0,skewY:0,keystoneV:0,keystoneH:0,brightness:100,contrast:100}),x(!1))},[jf,Kt]),br=K.useCallback(()=>{if(ti.size>0||ln.size>0||ri.size>0||ai.size>0){if(ti.size>0){const p=ft.filter(oe=>ti.has(oe.id)),S=Ei&&p.some(oe=>oe.type==="via"),L=pr&&p.some(oe=>oe.type==="trace"),Q=as&&p.some(oe=>oe.type==="pad");if(S){alert("Cannot change size: Vias are locked. Unlock vias to change their size.");return}if(L){alert("Cannot change size: Traces are locked. Unlock traces to change their size.");return}if(Q){alert("Cannot change size: Pads are locked. Unlock pads to change their size.");return}}if(ln.size>0&&Hs){alert("Cannot change size: Components are locked. Unlock components to change their size.");return}if(ri.size>0&&oi){alert("Cannot change size: Power nodes are locked. Unlock power nodes to change their size.");return}if(ai.size>0&&gr){alert("Cannot change size: Ground nodes are locked. Unlock ground nodes to change their size.");return}if(_t(p=>p.map(S=>{if(ti.has(S.id)){const L=S.size+1;return S.type==="via"?Pt("via",L):S.type==="pad"?Pt("pad",L):S.type==="trace"&&Pt("trace",L,S.layer),{...S,size:L}}return S})),ln.size>0){const p=(ln.size>0&&It.find(S=>ln.has(S.id))?.size||18)+1;Pt("component",p),Pi(S=>S.map(L=>ln.has(L.id)?{...L,size:(L.size||18)+1}:L)),Gn(S=>S.map(L=>ln.has(L.id)?{...L,size:(L.size||18)+1}:L))}if(ri.size>0){const p=(Rn.find(S=>ri.has(S.id))?.size||18)+1;Pt("power",p),De(S=>S.map(L=>ri.has(L.id)?{...L,size:L.size+1}:L))}if(ai.size>0){const p=(y.find(S=>ai.has(S.id))?.size||18)+1;Pt("ground",p),rt(S=>S.map(L=>ai.has(L.id)?{...L,size:(L.size||18)+1}:L))}}else{let p=null;if(k==="draw"&&lt==="via"?p="via":k==="draw"&&lt==="pad"?p=el.current==="bottom"?"padBottom":"padTop":k==="draw"&&lt==="testPoint"?p=tl.current==="bottom"?"testPointBottom":"testPointTop":k==="draw"&&lt==="trace"?p=Pa.current==="bottom"?"traceBottom":"traceTop":k==="component"?p=$a.current==="bottom"?"componentBottom":"componentTop":k==="power"?p="power":k==="ground"&&(p="ground"),p){const S=Ln.get(p),L=Math.min(40,S.size+1);Ln.setSize(p,L)}}},[ti,ln,ri,ai,ft,Ei,pr,as,Nr,Hs,oi,gr,k,lt,Pt]),oa=K.useCallback(()=>{if(ti.size>0||ln.size>0||ri.size>0||ai.size>0){if(ti.size>0){const p=ft.filter(he=>ti.has(he.id)),S=Ei&&p.some(he=>he.type==="via"),L=pr&&p.some(he=>he.type==="trace"),Q=as&&p.some(he=>he.type==="pad"),oe=Nr&&p.some(he=>he.type==="testPoint");if(S){alert("Cannot change size: Vias are locked. Unlock vias to change their size.");return}if(L){alert("Cannot change size: Traces are locked. Unlock traces to change their size.");return}if(Q){alert("Cannot change size: Pads are locked. Unlock pads to change their size.");return}if(oe){alert("Cannot change size: Test Points are locked. Unlock test points to change their size.");return}}if(ln.size>0&&Hs){alert("Cannot change size: Components are locked. Unlock components to change their size.");return}if(ri.size>0&&oi){alert("Cannot change size: Power nodes are locked. Unlock power nodes to change their size.");return}if(ai.size>0&&gr){alert("Cannot change size: Ground nodes are locked. Unlock ground nodes to change their size.");return}if(_t(p=>p.map(S=>{if(ti.has(S.id)){const L=Math.max(1,S.size-1);return S.type==="via"?Pt("via",L):S.type==="pad"?Pt("pad",L,S.layer):S.type==="testPoint"?Pt("testPoint",L,S.layer):S.type==="trace"&&Pt("trace",L,S.layer),{...S,size:L}}return S})),ln.size>0){const p=Math.max(1,(It.find(S=>ln.has(S.id))?.size||18)-1);Pt("component",p),Pi(S=>S.map(L=>ln.has(L.id)?{...L,size:Math.max(1,(L.size||18)-1)}:L)),Gn(S=>S.map(L=>ln.has(L.id)?{...L,size:Math.max(1,(L.size||18)-1)}:L))}if(ri.size>0){const p=Math.max(1,(Rn.find(S=>ri.has(S.id))?.size||18)-1);Pt("power",p),De(S=>S.map(L=>ri.has(L.id)?{...L,size:Math.max(1,L.size-1)}:L))}if(ai.size>0){const p=Math.max(1,(y.find(S=>ai.has(S.id))?.size||18)-1);Pt("ground",p),rt(S=>S.map(L=>ai.has(L.id)?{...L,size:Math.max(1,(L.size||18)-1)}:L))}}else{let p=null;if(k==="draw"&&lt==="via"?p="via":k==="draw"&&lt==="pad"?p=($t||xi||"top")==="bottom"?"padBottom":"padTop":k==="draw"&&lt==="testPoint"?p=($t||En||"top")==="bottom"?"testPointBottom":"testPointTop":k==="draw"&&lt==="trace"?p=($t||$n||"top")==="bottom"?"traceBottom":"traceTop":k==="component"?p=($t||pi||"top")==="bottom"?"componentBottom":"componentTop":k==="power"?p="power":k==="ground"&&(p="ground"),p){const S=Ln.get(p),L=Math.max(1,S.size-1);Ln.setSize(p,L)}}},[ti,ln,ri,ai,ft,Ei,pr,as,Nr,Hs,oi,gr,k,lt,$t,xi,En,$n,pi,Pt]),Op=K.useCallback(()=>{const p=Hr.size;if(ti.size>0||ln.size>0||ri.size>0||ai.size>0){if(ti.size>0){const S=ft.filter(V=>ti.has(V.id)),L=Ei&&S.some(V=>V.type==="via"),Q=as&&S.some(V=>V.type==="pad"),oe=pr&&S.some(V=>V.type==="trace"),he=Nr&&S.some(V=>V.type==="testPoint");if(L||Q||oe||he){alert("Cannot change size: selected items are locked.");return}}if(ln.size>0&&Hs){alert("Cannot change size: selected components are locked.");return}if(ri.size>0&&oi){alert("Cannot change size: selected power nodes are locked.");return}if(ai.size>0&&gr){alert("Cannot change size: selected ground nodes are locked.");return}_t(S=>S.map(L=>ti.has(L.id)?(L.type==="via"?(Pt("via",p),Fn(Q=>{const oe=new Map(Q),he=oe.get("via");return he&&oe.set("via",{...he,settings:{...he.settings,size:p}}),oe})):L.type==="pad"?(Pt("pad",p,L.layer),Fn(Q=>{const oe=new Map(Q),he=oe.get("pad");if(he){const V=new Map(he.layerSettings);V.set(L.layer,{...V.get(L.layer)||{color:he.settings.color,size:p},size:p}),oe.set("pad",{...he,layerSettings:V})}return oe})):L.type==="testPoint"?(Pt("testPoint",p,L.layer),Fn(Q=>{const oe=new Map(Q),he=oe.get("testPoint");if(he){const V=new Map(he.layerSettings);V.set(L.layer,{...V.get(L.layer)||{color:he.settings.color,size:p},size:p}),oe.set("testPoint",{...he,layerSettings:V})}return oe})):L.type==="trace"&&Pt("trace",p,L.layer),{...L,size:p}):L)),ln.size>0&&(Pt("component",p),Pi(S=>S.map(L=>ln.has(L.id)?{...L,size:p}:L)),Gn(S=>S.map(L=>ln.has(L.id)?{...L,size:p}:L))),ri.size>0&&(Pt("power",p),De(S=>S.map(L=>ri.has(L.id)?{...L,size:p}:L))),ai.size>0&&(Pt("ground",p),rt(S=>S.map(L=>ai.has(L.id)?{...L,size:p}:L)))}else M(p),k==="draw"&&lt==="trace"?$t==="top"?(ie(p),Pt("trace",p,"top")):(q(p),Pt("trace",p,"bottom")):k==="draw"&&lt==="via"?Pt("via",p):k==="draw"&&lt==="pad"?Pt("pad",p,$t):k==="draw"&&lt==="testPoint"?Pt("testPoint",p,$t):Pt(k==="component"?"component":k==="power"?"power":k==="ground"?"ground":"brush",p);Do({visible:!1,size:6})},[Hr.size,ti,ln,ri,ai,ft,Ei,pr,Hs,oi,gr,k,lt,$t,Pt,Un,Fn]),Fp=K.useCallback(()=>{nr({visible:!1,source:null,interval:5})},[]),Nf=K.useCallback(async(p,S=!1)=>{if(p===null){Ta(!1),hl(null),Fi.current&&(clearInterval(Fi.current),Fi.current=null),Lo({visible:!1,interval:5}),S&&nr({visible:!1,source:null,interval:5}),console.log("Auto save: Disabled");return}if(!Vs){alert("Please create a new project (File -> New Project) or open an existing project (File -> Open Project) first.");return}let L=ki;if(!L){const V=window;if(typeof V.showDirectoryPicker=="function")try{L=await V.showDirectoryPicker(),qs(L)}catch(Ae){Ae?.name!=="AbortError"&&(console.error("Failed to get directory:",Ae),alert("Failed to select project directory."));return}else{alert("Directory picker is not supported in this browser. Auto-save requires a directory handle.");return}}Jl(L);const Q=Vs.replace(/\.json$/i,""),he=Qu(Q).replace(/[^a-zA-Z0-9_-]/g,"_");no(he),Ul.current=L,uc.current=he,hl(p),Ta(!0),ls.current=!0,Lo({visible:!1,interval:5}),S&&nr({visible:!1,source:null,interval:5}),setTimeout(()=>{console.log(`Auto save: Enabled with interval ${p} minutes`),rd.current&&rd.current()},200)},[Vs,ki,Ta,hl,Jl,no,Lo,nr,qs]),hu=K.useCallback(()=>{et(),j("select")},[et]),Bd=K.useCallback(p=>{if(p.key==="Escape"){const V=document.activeElement;if(V&&(V.tagName==="INPUT"&&V.type==="checkbox"||V.tagName==="INPUT"&&V.type==="radio")){V.blur(),p.preventDefault(),p.stopPropagation();return}}const S=document.activeElement;if(S&&(S.tagName==="INPUT"&&S.type!=="checkbox"&&S.type!=="radio"||S.tagName==="TEXTAREA"||S.isContentEditable))return;const L=Ud.current>0;if(L&&p.key!=="m"&&p.key!=="M")return;const Q=parseInt(p.key);if(!isNaN(Q)&&Q>=0&&Q<=9){if(p.preventDefault(),p.stopPropagation(),k==="center"&&ad){if(Js.current&&(clearTimeout(Js.current),Js.current=null),rs.current){let fe=0,je=0;t?(fe=t.x,je=t.y):s&&(fe=s.x,je=s.y),Rl(ke=>({...ke,[Q]:{pcbReferenceX:fe,pcbReferenceY:je,x:0,y:0,zoom:At,viewRotation:ei,viewFlipX:Ji,isBottomView:Sa,transparency:h,showTopImage:Ls,showBottomImage:Ml,showViasLayer:lr,showTopTracesLayer:js,showBottomTracesLayer:ys,showTopPadsLayer:cr,showBottomPadsLayer:Gr,showTopTestPointsLayer:fs,showBottomTestPointsLayer:vo,showTopComponents:io,showBottomComponents:Di,showPowerLayer:_a,showGroundLayer:si,showConnectionsLayer:Ts}}))}ar(!1),j("select"),ya(void 0);return}const V=mo[Q];if(V){fi(V.zoom),vs(V.viewRotation??0),Ds(V.viewFlipX??!1),qr(V.isBottomView??!1),f(V.transparency??50);const Ae=V.pcbReferenceX??V.x??0,fe=V.pcbReferenceY??V.y??0;let je=0,ke=0;t?(je=t.x,ke=t.y):s&&(je=s.x,ke=s.y);const Ce=Ae-je,ge=fe-ke;(Math.abs(Ce)>.001||Math.abs(ge)>.001)&&(t&&n({...t,x:t.x+Ce,y:t.y+ge}),s&&o({...s,x:s.x+Ce,y:s.y+ge}),Pi(It.map(Se=>({...Se,x:Se.x+Ce,y:Se.y+ge}))),Gn(Yt.map(Se=>({...Se,x:Se.x+Ce,y:Se.y+ge}))),De(we.map(Se=>({...Se,x:Se.x+Ce,y:Se.y+ge}))),rt(Fe.map(Se=>({...Se,x:Se.x+Ce,y:Se.y+ge}))),_t(ft.map(Se=>({...Se,points:Se.points.map(be=>({...be,x:be.x+Ce,y:be.y+ge}))}))),Et(na.map(Se=>({...Se,x:Se.x+Ce,y:Se.y+ge}))),fr(Qi.map(Se=>({...Se,x:Se.x+Ce,y:Se.y+ge})))),Si({x:0,y:0}),or(V.showTopImage),mr(V.showBottomImage),Vr(V.showViasLayer),Wr(V.showTopTracesLayer),Ca(V.showBottomTracesLayer),$r(V.showTopPadsLayer),Yr(V.showBottomPadsLayer),Uo(V.showTopTestPointsLayer),sc(V.showBottomTestPointsLayer),Ho(V.showTopComponents),ra(V.showBottomComponents),Xr(V.showPowerLayer),Ui(V.showGroundLayer),Li(V.showConnectionsLayer)}return}if(p.key==="+"||p.key==="="){p.preventDefault(),p.stopPropagation(),br();return}if(p.key==="-"||p.key==="_"){p.preventDefault(),p.stopPropagation(),oa();return}const oe=p.shiftKey||p.getModifierState("CapsLock"),he=k==="transform"&&Kt;if(p.key==="ArrowUp"||p.key==="ArrowDown"||p.key==="ArrowLeft"||p.key==="ArrowRight"){if(ln.size>0){p.preventDefault(),p.stopPropagation();const V=p.shiftKey?10:1;let Ae=0,fe=0;p.key==="ArrowUp"?fe=-V:p.key==="ArrowDown"?fe=V:p.key==="ArrowLeft"?Ae=-V:p.key==="ArrowRight"&&(Ae=V);for(const je of ln){const ke=It.find(Ce=>Ce.id===je);if(ke){const Ce=ke.x+Ae,ge=ke.y+fe,Se=is({x:Ce,y:ge});Pi(be=>be.map(ye=>ye.id===je?{...ye,x:Se.x,y:Se.y}:ye))}else{const Ce=Yt.find(ge=>ge.id===je);if(Ce){const ge=Ce.x+Ae,Se=Ce.y+fe,be=is({x:ge,y:Se});Gn(ye=>ye.map(Le=>Le.id===je?{...Le,x:be.x,y:be.y}:Le))}}}return}if(oe&&!he&&ln.size===0){if(p.key==="ArrowUp"||p.key==="ArrowDown"){p.preventDefault(),p.stopPropagation();const V=p.key==="ArrowUp"?-90:90;tu(V);return}else if(p.key==="ArrowLeft"||p.key==="ArrowRight"){p.preventDefault(),p.stopPropagation(),Ou();return}}}if((p.key==="I"||p.key==="i")&&!p.ctrlKey&&!p.shiftKey&&!p.altKey){const V=document.activeElement;if(!!V&&(V.tagName==="INPUT"&&V.type!=="range"&&V.type!=="checkbox"&&V.type!=="radio"||V.tagName==="TEXTAREA"||V.isContentEditable))return;p.preventDefault(),p.stopPropagation();const fe=[];ti.size>0,ti.size===0&&ln.size===0&&ri.size===0&&ai.size===0&&fe.push(`
No objects selected.`);const je=fe.join(`
`);console.log(je),cl({visible:!0,text:je});return}if((p.key==="N"||p.key==="n")&&!p.ctrlKey&&!p.shiftKey&&!p.altKey){const V=document.activeElement;if(!!V&&(V.tagName==="INPUT"&&V.type!=="range"&&V.type!=="checkbox"&&V.type!=="radio"||V.tagName==="TEXTAREA"||V.isContentEditable))return;p.preventDefault(),p.stopPropagation(),gi(!0);return}if((p.key==="L"||p.key==="l")&&!p.ctrlKey&&!p.shiftKey&&!p.altKey){const V=document.activeElement;if(!!V&&(V.tagName==="INPUT"&&V.type!=="range"&&V.type!=="checkbox"&&V.type!=="radio"||V.tagName==="TEXTAREA"||V.isContentEditable))return;p.preventDefault(),p.stopPropagation(),Pf();return}if((p.key==="E"||p.key==="e")&&!p.ctrlKey&&!p.shiftKey&&!p.altKey){const V=document.activeElement;if(!!V&&(V.tagName==="INPUT"&&V.type!=="range"&&V.type!=="checkbox"&&V.type!=="radio"||V.tagName==="TEXTAREA"||V.isContentEditable))return;p.preventDefault(),p.stopPropagation(),Dt||Io(!0);return}if(p.key==="O"||p.key==="o"){const V=document.activeElement;if(!!V&&(V.tagName==="INPUT"&&V.type!=="range"&&V.type!=="checkbox"&&V.type!=="radio"||V.tagName==="TEXTAREA"||V.isContentEditable))return;p.preventDefault(),p.stopPropagation();const fe=mo[0];if(fe){fi(fe.zoom),vs(fe.viewRotation??0),Ds(fe.viewFlipX??!1),qr(fe.isBottomView??!1),f(fe.transparency??50);const je=fe.pcbReferenceX??fe.x??0,ke=fe.pcbReferenceY??fe.y??0;let Ce=0,ge=0;t?(Ce=t.x,ge=t.y):s&&(Ce=s.x,ge=s.y);const Se=je-Ce,be=ke-ge;(Math.abs(Se)>.001||Math.abs(be)>.001)&&(t&&n({...t,x:t.x+Se,y:t.y+be}),s&&o({...s,x:s.x+Se,y:s.y+be}),Pi(It.map(ye=>({...ye,x:ye.x+Se,y:ye.y+be}))),Gn(Yt.map(ye=>({...ye,x:ye.x+Se,y:ye.y+be}))),De(we.map(ye=>({...ye,x:ye.x+Se,y:ye.y+be}))),rt(Fe.map(ye=>({...ye,x:ye.x+Se,y:ye.y+be}))),_t(ft.map(ye=>({...ye,points:ye.points.map(Le=>({...Le,x:Le.x+Se,y:Le.y+be}))}))),Et(na.map(ye=>({...ye,x:ye.x+Se,y:ye.y+be}))),fr(Qi.map(ye=>({...ye,x:ye.x+Se,y:ye.y+be})))),or(fe.showTopImage),mr(fe.showBottomImage),Vr(fe.showViasLayer),Wr(fe.showTopTracesLayer),Ca(fe.showBottomTracesLayer),$r(fe.showTopPadsLayer),Yr(fe.showBottomPadsLayer),Uo(fe.showTopTestPointsLayer),sc(fe.showBottomTestPointsLayer),Ho(fe.showTopComponents),ra(fe.showBottomComponents),Xr(fe.showPowerLayer),Ui(fe.showGroundLayer),Li(fe.showConnectionsLayer)}else fi(1),vs(0),Ds(!1),qr(!1),f(0);Si({x:0,y:0}),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),c("overlay"),Tn(new Set),Cn(new Set),tn(new Set),pn(new Set),j("select");return}if((p.key==="Alt"||p.altKey)&&(Tf(!0),xo(!0)),p.key==="Escape"){p.preventDefault(),p.stopPropagation(),hu(),zd(!1),ru(!1),au(!1),ve(!1),La(!1),Lp(null);return}if(p.key==="Enter"&&k==="draw"&&lt==="trace"){Gu();return}if((p.key==="Delete"||p.key==="Backspace")&&(ti.size>0||ln.size>0||ri.size>0||ai.size>0)){if(p.preventDefault(),p.stopPropagation(),hn(ft,It,Yt,we,Fe),ti.size>0){const V=ft.filter(Ce=>ti.has(Ce.id)),Ae=Ei&&V.some(Ce=>Ce.type==="via"),fe=pr&&V.some(Ce=>Ce.type==="trace"),je=as&&V.some(Ce=>Ce.type==="pad"),ke=Nr&&V.some(Ce=>Ce.type==="testPoint");Ae?alert("Cannot delete: Vias are locked. Unlock vias to delete them."):fe?alert("Cannot delete: Traces are locked. Unlock traces to delete them."):je?alert("Cannot delete: Pads are locked. Unlock pads to delete them."):ke?alert("Cannot delete: Test points are locked. Unlock test points to delete them."):(_t(Ce=>Ce.filter(ge=>!ti.has(ge.id))),Tn(new Set))}ln.size>0&&(Hs?alert("Cannot delete: Components are locked. Unlock components to delete them."):(Pi(V=>V.filter(Ae=>!ln.has(Ae.id))),Gn(V=>V.filter(Ae=>!ln.has(Ae.id))),Cn(new Set))),ri.size>0&&(oi?alert("Cannot delete: Power nodes are locked. Unlock power nodes to delete them."):(De(V=>V.filter(Ae=>!ri.has(Ae.id))),tn(new Set))),ai.size>0&&(gr?alert("Cannot delete: Ground nodes are locked. Unlock ground nodes to delete them."):(rt(V=>V.filter(Ae=>!ai.has(Ae.id))),pn(new Set)));return}if((p.key==="z"||p.key==="Z")&&(p.ctrlKey||p.metaKey)&&!p.shiftKey&&!p.altKey){const V=document.activeElement;if(!!V&&(V.tagName==="INPUT"&&V.type!=="range"&&V.type!=="checkbox"&&V.type!=="radio"||V.tagName==="TEXTAREA"||V.isContentEditable))return;p.preventDefault(),p.stopPropagation();const fe=Jn();if(fe){const je=new Set(fe.drawingStrokes.map(Se=>Se.id));for(const Se of ft)if(!je.has(Se.id))for(const be of Se.points)be.id&&typeof be.id=="number"&&bg(be.id);const ke=new Set([...fe.componentsTop.map(Se=>Se.id),...fe.componentsBottom.map(Se=>Se.id)]);for(const Se of[...It,...Yt])if(!ke.has(Se.id)){for(const be of Se.pinConnections)if(be&&be.trim()!==""){const ye=parseInt(be,10);!isNaN(ye)&&ye>0&&bg(ye)}}const Ce=new Set(fe.powerSymbols.map(Se=>Se.id));for(const Se of we)!Ce.has(Se.id)&&Se.pointId&&typeof Se.pointId=="number"&&bg(Se.pointId);const ge=new Set(fe.groundSymbols.map(Se=>Se.id));for(const Se of Fe)!ge.has(Se.id)&&Se.pointId&&typeof Se.pointId=="number"&&bg(Se.pointId);_t(fe.drawingStrokes),Pi(fe.componentsTop),Gn(fe.componentsBottom),De(fe.powerSymbols),rt(fe.groundSymbols),Nn([])}return}if(p.code==="KeyV"&&p.altKey&&!p.ctrlKey&&!p.shiftKey&&!L){const V=document.activeElement;if(!!V&&(V.tagName==="INPUT"&&V.type!=="range"&&V.type!=="checkbox"&&V.type!=="radio"||V.tagName==="TEXTAREA"||V.isContentEditable))return;p.preventDefault(),p.stopPropagation(),Vc(!1),Il(!0);return}if(p.code==="KeyP"&&p.altKey&&!p.ctrlKey&&!p.shiftKey&&!L){const V=document.activeElement;if(!!V&&(V.tagName==="INPUT"&&V.type!=="range"&&V.type!=="checkbox"&&V.type!=="radio"||V.tagName==="TEXTAREA"||V.isContentEditable))return;p.preventDefault(),p.stopPropagation(),Vc(!0),Il(!0);return}if((p.key==="a"||p.key==="A")&&!p.ctrlKey&&!p.altKey&&!p.shiftKey&&!L){const V=document.activeElement;if(!!V&&(V.tagName==="INPUT"&&V.type!=="range"&&V.type!=="checkbox"&&V.type!=="radio"||V.tagName==="TEXTAREA"||V.isContentEditable))return;if(ln.size>0){p.preventDefault(),p.stopPropagation();const fe=Array.from(ln),je=fe[fe.length-1];let ke=null,Ce=null;ke=It.find(ge=>ge.id===je)||null,ke?Ce="top":(ke=Yt.find(ge=>ge.id===je)||null,ke&&(Ce="bottom")),ke&&Ce&&Eo(ke,Ce)}return}if(!p.ctrlKey&&!p.altKey){const V=document.activeElement;if(!(!!V&&(V.tagName==="INPUT"&&V.type!=="range"&&V.type!=="checkbox"&&V.type!=="radio"||V.tagName==="TEXTAREA"||V.isContentEditable)))switch(p.key){case"s":case"S":p.preventDefault(),et(),hu();return;case"b":case"B":p.preventDefault(),et(),gn.length===1?($e(gn[0].id),j("power"),ve(!1),Xr(!0)):gn.length>1?ve(!0):(ve(!0),j("power"),Xr(!0));return;case"g":case"G":p.preventDefault(),et(),P.length===1?(ni(P[0].id),j("ground"),rn(!1),Ui(!0)):P.length>1?rn(!0):(rn(!0),j("ground"),Ui(!0));return;case"v":case"V":p.preventDefault(),et(),Qt("via"),j("draw"),Vr(!0);return;case"p":case"P":p.preventDefault(),et(),Qt("pad"),j("draw");return;case"y":case"Y":p.preventDefault(),et(),Qt("testPoint"),j("draw");return;case"t":case"T":p.preventDefault(),et(),Qt("trace"),j("draw");return;case"c":case"C":p.preventDefault(),et(),j("component"),Hu.current?Ch(Hu.current):Ch(null);return;case"e":case"E":p.preventDefault(),et(),j("erase");return;case"h":case"H":p.preventDefault(),et(),j("pan");return;case"x":case"X":p.preventDefault(),et(),j("center"),ar(!0),Js.current&&clearTimeout(Js.current),Js.current=setTimeout(()=>{ar(!1),j("select"),ya(void 0)},2e3);return;case"m":case"M":if(!p.ctrlKey){p.preventDefault(),et(),tc(!1),j("magnify");return}break}}if(k==="transform"&&Kt){if(!(p.key==="ArrowLeft"||p.key==="ArrowRight"||p.key==="ArrowUp"||p.key==="ArrowDown"))return;p.preventDefault(),p.stopPropagation();const Ae=document.activeElement;if(Ae&&Ae.tagName==="INPUT"){const fe=Ae;fe.type==="radio"&&fe.blur()}if(Ni)return;if(Or==="nudge"){let fe=0,je=0;switch(p.key){case"ArrowLeft":fe=-1;break;case"ArrowRight":fe=1;break;case"ArrowUp":je=-1;break;case"ArrowDown":je=1;break;default:return}Kt==="top"&&t?n(ke=>ke?{...ke,x:ke.x+fe,y:ke.y+je}:null):Kt==="bottom"&&s?o(ke=>ke?{...ke,x:ke.x+fe,y:ke.y+je}:null):Kt==="both"&&(t&&n(ke=>ke?{...ke,x:ke.x+fe,y:ke.y+je}:null),s&&o(ke=>ke?{...ke,x:ke.x+fe,y:ke.y+je}:null))}else if(Or==="scale"){let fe=0;switch(p.key){case"ArrowUp":fe=.01;break;case"ArrowDown":fe=-.01;break;case"ArrowRight":fe=.001;break;case"ArrowLeft":fe=-.001;break;default:return}if(Kt==="top"){t&&n(je=>je?{...je,scale:Math.max(.1,Math.min(3,je.scale+fe))}:null);return}if(Kt==="bottom"){s&&o(je=>je?{...je,scale:Math.max(.1,Math.min(3,je.scale+fe))}:null);return}if(Kt==="both"){t&&n(je=>je?{...je,scale:Math.max(.1,Math.min(3,je.scale+fe))}:null),s&&o(je=>je?{...je,scale:Math.max(.1,Math.min(3,je.scale+fe))}:null);return}}else if(Or==="rotate"){let fe=0;switch(p.key){case"ArrowUp":fe=1;break;case"ArrowDown":fe=-1;break;case"ArrowRight":fe=.1;break;case"ArrowLeft":fe=-.1;break;default:return}if(Kt==="top"){t&&n(je=>je?{...je,rotation:je.rotation+fe}:null);return}if(Kt==="bottom"){s&&o(je=>je?{...je,rotation:je.rotation+fe}:null);return}if(Kt==="both"){t&&n(je=>je?{...je,rotation:je.rotation+fe}:null),s&&o(je=>je?{...je,rotation:je.rotation+fe}:null);return}}else if(Or==="slant"){let fe=0,je=0;switch(p.key){case"ArrowUp":je=-.5;break;case"ArrowDown":je=.5;break;case"ArrowLeft":fe=-.5;break;case"ArrowRight":fe=.5;break}if(fe!==0||je!==0){const ke=Kd,Ce=ge=>Math.max(-.7,Math.min(.7,ge));if(Kt==="top"){t&&n(ge=>ge?{...ge,skewX:Ce((ge.skewX||0)+ke(fe)),skewY:Ce((ge.skewY||0)+ke(je))}:null);return}if(Kt==="bottom"){s&&o(ge=>ge?{...ge,skewX:Ce((ge.skewX||0)+ke(fe)),skewY:Ce((ge.skewY||0)+ke(je))}:null);return}if(Kt==="both"){t&&n(ge=>ge?{...ge,skewX:Ce((ge.skewX||0)+ke(fe)),skewY:Ce((ge.skewY||0)+ke(je))}:null),s&&o(ge=>ge?{...ge,skewX:Ce((ge.skewX||0)+ke(fe)),skewY:Ce((ge.skewY||0)+ke(je))}:null);return}}}else if(Or==="keystone"){let fe=0,je=0;switch(p.key){case"ArrowUp":je=-.5;break;case"ArrowDown":je=.5;break;case"ArrowLeft":fe=-.5;break;case"ArrowRight":fe=.5;break}if(fe!==0||je!==0){const ke=Kd,Ce=ge=>Math.max(-.35,Math.min(.35,ge));if(Kt==="top"){t&&n(ge=>ge?{...ge,keystoneH:Ce((ge.keystoneH||0)+ke(fe)),keystoneV:Ce((ge.keystoneV||0)+ke(je))}:null);return}if(Kt==="bottom"){s&&o(ge=>ge?{...ge,keystoneH:Ce((ge.keystoneH||0)+ke(fe)),keystoneV:Ce((ge.keystoneV||0)+ke(je))}:null);return}if(Kt==="both"){t&&n(ge=>ge?{...ge,keystoneH:Ce((ge.keystoneH||0)+ke(fe)),keystoneV:Ce((ge.keystoneV||0)+ke(je))}:null),s&&o(ge=>ge?{...ge,keystoneH:Ce((ge.keystoneH||0)+ke(fe)),keystoneV:Ce((ge.keystoneV||0)+ke(je))}:null);return}}}}else{const V=p.target;if(V.tagName==="INPUT"&&V.type==="range"){const Ae=V,fe=Number(Ae.value),je=Number(Ae.min),ke=Number(Ae.max),Ce=Number(Ae.step)||1;switch(p.key){case"ArrowLeft":p.preventDefault();const ge=Math.max(je,fe-Ce);Ae.value=ge.toString(),Ae.dispatchEvent(new Event("input",{bubbles:!0}));break;case"ArrowRight":p.preventDefault();const Se=Math.min(ke,fe+Ce);Ae.value=Se.toString(),Ae.dispatchEvent(new Event("input",{bubbles:!0}));break}}}},[k,Kt,Or,t,s,ti,ln,ri,ai,ft,It,Yt,Rn,y,gn,lt,Gu,$n,G,_,te,re,hu,Pi,Gn,Jn,_t,De,rt,we,Fe,Ou,tu,mo,At,ei,Ji,Sa,h,fi,vs,Ds,qr,f,n,o,Et,fr,Si,c,Tn,Cn,tn,pn,j,na,Qi,Ls,Ml,lr,js,ys,cr,Gr,fs,vo,io,Di,_a,si,Ts,or,mr,Vr,Wr,Ca,$r,Yr,Uo,sc,Ho,ra,Xr,Ui,Li,Vc,Il,Eo]);Ct.useEffect(()=>{k!=="transform"&&Tr(null)},[k]),Ct.useEffect(()=>{window.addEventListener("keydown",Bd,!0);const p=S=>{S.key==="Alt"&&(Tf(!1),xo(!1),Tc(null))};return window.addEventListener("keyup",p,!0),()=>{window.removeEventListener("keydown",Bd,!0),window.removeEventListener("keyup",p,!0)}},[Bd,ri,ai,oi,oi,Rn,y,br,oa,hu,ln,It,Yt,Pi,Gn,mo,ad,k]);const fd=K.useCallback(()=>{Hn.current={},U("#AA4499"),N("#F781BF"),ie(6),q(6),Mt("trace","#AA4499","top"),Mt("trace","#F781BF","bottom"),Pt("trace",6,"top"),Pt("trace",6,"bottom"),ce("#0072B2"),xe("#56B4E9"),D(18),Y(18),Mt("pad","#0072B2","top"),Mt("pad","#56B4E9","bottom"),Pt("pad",18,"top"),Pt("pad",18,"bottom"),Nt("#6A3D9A"),St("#9467BD"),Lt(18),en(18),Mt("component","#6A3D9A","top"),Mt("component","#9467BD","bottom"),Pt("component",18,"top"),Pt("component",18,"bottom"),Fr("top"),I("#AA4499"),M(6),Ro([{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),ee([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),Pt("power",18),Pt("ground",18),Wi(!1),ks(!1),ll(!1),ba(!1),Ja(!1),ho(!1),Gt("top"),j("select"),f(50),b(!1),c("overlay"),rx(),vi()},[Mt,Pt,vi]),Od=K.useCallback(()=>{qs(null),Jl(null),Ao&&(Ao.current=null),Ul&&(Ul.current=null),hs(""),za("pcb_project"),Ta(!1),hl(null),no(""),fl([]),Oo(-1),uc&&(uc.current=""),ls.current=!1,to(!1),qr(!1),go(null),Ri(null),Fi.current&&(clearInterval(Fi.current),Fi.current=null),n(null),o(null),vi(),_t([]),Et([]),fr([]),Xa([]),co([]),Nn([]),An.current=[],Pi([]),Gn([]),Ka(null),rl(null),De([]),rt([]),Vt(null),Ro([{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),ee([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),Tn(new Set),Cn(new Set),tn(new Set),pn(new Set),xa(!1),_s([]),c("overlay"),fi(1),Wa(0,0),Va(!0),Gt("top"),Rl({}),ar(!1),Js.current&&(clearTimeout(Js.current),Js.current=null),Tr(null),Ir(!1),Zt(null),Na("nudge"),x(!1),f(50),b(!1),v(2e3),Wi(!1),ks(!1),uo(!1),ol(!1),ll(!1),ba(!1),Ja(!1),ho(!1),or(!0),mr(!0),Vr(!0),Wr(!0),Ca(!0),$r(!0),Yr(!0),Uo(!0),sc(!0),Ho(!0),ra(!0),Xr(!0),Ui(!0),Li(!0),Kr(!0),j("select"),Qt("trace"),Fr("top"),ga("top"),Qo("top"),ma("top"),Pa.current="top",el.current="top",tl.current="top",$a.current="top",Hn.current={},Yn(!0),Rt(!1),rx(),Qa(null),cl({visible:!1,text:""}),po({visible:!1,title:"",message:""}),ir({visible:!1}),Da({visible:!1}),zo({visible:!1,projectName:"",locationPath:"",locationHandle:null}),ws({visible:!1,filename:"",locationPath:"",locationHandle:null}),Lo({visible:!1,interval:null}),nr({visible:!1,source:"new",interval:5}),La(!1),R(!1),Tt(!1),Pn(!1),Wc(!1),gi(!1),vn(!1),Pr(!1),ld(null),Tc(null),nc(null),Ac(!1),Fo.current=null,ec.current=null,Jt(!1),Sn(null),Vi.current=0,qn.current=!1,console.log("Project closed: All state cleared and browser permissions released")},[qs,Jl,hs,za,Ta,hl,no,fl,Oo,n,o,_t,Nn,Et,fr,Xa,co,Pi,Gn,Ka,rl,De,rt,Vt,Ro,ee,Tn,Cn,tn,pn,xa,_s,c,fi,Po,Va,Gt,Rl,ar,Tr,Ir,Zt,Na,x,f,b,v,Wi,ks,uo,ol,ll,ba,Ja,ho,or,mr,Vr,Wr,Ca,$r,Yr,Uo,sc,Ho,ra,Xr,Ui,Li,j,Qt,Fr,ga,Qo,ma,Yn,Rt,Qa,cl,po,ir,zo,ws,Lo,nr,vi,La,R,Tt,Pn,Wc,gi,vn,ld,Tc,nc,Ac,Jt,Sn]),Pc=K.useCallback(()=>{fd(),setTimeout(()=>{fi(1),Si({x:0,y:0}),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),Tn(new Set),Cn(new Set),tn(new Set),pn(new Set)},200)},[fd,fi,Si]);Ct.useEffect(()=>{Pc()},[]),Ct.useEffect(()=>{if(!eo.visible)return;const p=[];ti.size>0,ti.size===0&&ln.size===0&&ri.size===0&&ai.size===0&&p.push(`
No objects selected.`);const S=p.join(`
`);cl(L=>({...L,text:S}))},[eo.visible,ti,ln,ri,ai,ft,It,Yt,Rn,y,gn]),Ct.useEffect(()=>{const p=S=>{const L=rs.current;if(L&&!(S.target instanceof Node&&L.contains(S.target))){if(Gu(),Fl){const Q=ud.current;(!Q||!(S.target instanceof Node)||!Q.contains(S.target))&&zd(!1)}if(id){const Q=Ll.current;!S.target?.closest('button[title="Color Picker"]')&&(!Q||!(S.target instanceof Node)||!Q.contains(S.target))&&La(!1)}}};return document.addEventListener("mousedown",p,!0),()=>document.removeEventListener("mousedown",p,!0)},[Gu,Fl,Ah,id]);const Xu=p=>{if(!p.current)return{top:0,left:0};const S=p.current.getBoundingClientRect(),L=qc.current?.getBoundingClientRect();return L?{top:S.top-L.top,left:S.left-L.left+S.width+4}:{top:0,left:0}},fu=K.useCallback(()=>{ud.current&&kh.current&&requestAnimationFrame(()=>{if(ud.current&&kh.current){const p=Xu(kh);ud.current.style.top=`${p.top}px`,ud.current.style.left=`${p.left}px`}})},[]),Ku=K.useCallback(()=>{ou.current&&jh.current&&requestAnimationFrame(()=>{if(ou.current&&jh.current){const p=Xu(jh);ou.current.style.top=`${p.top}px`,ou.current.style.left=`${p.left}px`}})},[]),Eh=K.useCallback(()=>{lu.current&&qu.current&&requestAnimationFrame(()=>{if(lu.current&&qu.current){const p=Xu(qu);lu.current.style.top=`${p.top}px`,lu.current.style.left=`${p.left}px`}})},[]);Ct.useEffect(()=>{Fl&&fu()},[Fl,fu]),Ct.useEffect(()=>{Ah&&Ku()},[Ah,Ku]),Ct.useEffect(()=>{Th&&Eh()},[Th,Eh]),Ct.useEffect(()=>{if(Ze&&cu.current&&Wu.current){const p=Xu(Wu);cu.current.style.top=`${p.top}px`,cu.current.style.left=`${p.left}px`}},[Ze]),Ct.useEffect(()=>{if(qt&&Fu.current&&du.current){const p=Xu(du);Fu.current.style.top=`${p.top}px`,Fu.current.style.left=`${p.left}px`}},[qt]),Ct.useEffect(()=>{const p=S=>{if(!Zs)return;const L=document.querySelector("[data-component-editor-dialog]");if(L&&S.target instanceof Node&&L.contains(S.target)){const He=S.target;if(He.tagName==="BUTTON"||He.tagName==="INPUT"||He.closest("button")||He.closest("input"))return}const Q=rs.current;if(!Q)return;const oe=Q.getBoundingClientRect(),he=S.clientX,V=S.clientY;if(he<oe.left||he>oe.right||V<oe.top||V>oe.bottom)return;const Ae=Q.width/oe.width,fe=Q.height/oe.height,je=he-oe.left,ke=V-oe.top,Ce=je*Ae,ge=ke*fe,Se=Ce-5,be=ge-5,ye=Qf(Se,be,es,At,ei,Ji),Le=ye.x,Ee=ye.y;let qe=1/0,ct=null,ht=null;const wt=Math.max(6/At,4),zt=[...It,...Yt].find(He=>He.id===Zs.componentId)?.layer||"top";for(const He of ft)if((He.type==="via"||He.type==="pad")&&He.points.length>0){if(He.type==="pad"&&(He.layer||"top")!==zt)continue;const Ve=He.points[0],ze=Math.max(1,He.size/2),Xe=Math.hypot(Ve.x-Le,Ve.y-Ee),Ye=Math.max(ze,wt);Xe<=Ye&&Xe<qe&&(qe=Xe,ct=Ve.id??null,ht=He)}if(ct!=null&&ht){console.log(`
[PIN CONNECTION - DOCUMENT HANDLER] Found via!`),console.log(`  Point ID: ${ct}`),console.log(`  Connecting pin ${Zs.pinIndex+1} of component ${Zs.componentId}`);const He=String(ct),Ve=Zs.pinIndex,ze=Zs.componentId,Xe=It.find(dt=>dt.id===ze),Ye=Yt.find(dt=>dt.id===ze);if(Xe){const dt=ft;Pi(kt=>{const Xt=kt.find(jt=>jt.id===ze);if(!Xt)return kt;const kn=Xt.pinConnections||[],_n=kn.length>0?[...kn]:new Array(Xt.pinCount).fill("");let Bn;if(_n.length!==Xt.pinCount){Bn=new Array(Xt.pinCount).fill("");for(let jt=0;jt<Math.min(_n.length,Xt.pinCount);jt++)Bn[jt]=_n[jt]||""}else Bn=[..._n];Bn[Ve]=He,console.log(`Updated pin ${Ve} with value: ${He}`),console.log("New pinConnections:",Bn);const Xn=kt.find(jt=>jt.id===ze),Ft=Xn?Um(Xn,Bn,dt):null;return kt.map(jt=>{if(jt.id===ze){const cn={...jt,pinConnections:Bn};return Ft&&(cn.pinPolarities=Ft),cn}return jt})})}else if(Ye){const dt=ft;Gn(kt=>{const Xt=kt.find(jt=>jt.id===ze);if(!Xt)return kt;const kn=Xt.pinConnections||[],_n=kn.length>0?[...kn]:new Array(Xt.pinCount).fill("");let Bn;if(_n.length!==Xt.pinCount){Bn=new Array(Xt.pinCount).fill("");for(let jt=0;jt<Math.min(_n.length,Xt.pinCount);jt++)Bn[jt]=_n[jt]||""}else Bn=[..._n];Bn[Ve]=He,console.log(`Updated pin ${Ve} with value: ${He}`),console.log("New pinConnections:",Bn);const Xn=kt.find(jt=>jt.id===ze),Ft=Xn?Um(Xn,Bn,dt):null;return kt.map(jt=>{if(jt.id===ze){const cn={...jt,pinConnections:Bn};return Ft&&(cn.pinPolarities=Ft),cn}return jt})})}setTimeout(()=>{rl(null)},0)}else console.log("[PIN CONNECTION - DOCUMENT HANDLER] No via found at click location")};if(Zs)return document.addEventListener("mousedown",p,!0),()=>document.removeEventListener("mousedown",p,!0)},[Zs,It,Yt,ft,At,es.x,es.y,ei,Ji]);const ro=K.useCallback((p,S,L,Q)=>{const oe=window.innerWidth,he=window.innerHeight,V=10;let Ae=Math.max(V,Math.min(p,oe-L-V)),fe=Math.max(V,Math.min(S,he-Q-V));return{x:Ae,y:fe}},[]);Ct.useEffect(()=>{if(!al)return;const p=L=>{if(!Kl)return;const Q={x:L.clientX-Kl.x,y:L.clientY-Kl.y},oe=ro(Q.x,Q.y,250,window.innerHeight*.4);Za(oe),localStorage.setItem("componentDialogPosition",JSON.stringify(oe))},S=()=>{vc(!1),Tl(null)};return document.addEventListener("mousemove",p),document.addEventListener("mouseup",S),()=>{document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",S)}},[al,Kl,ro]),Ct.useEffect(()=>{if(!Mi)return;const p=L=>{if(!zi)return;const Q={x:L.clientX-zi.x,y:L.clientY-zi.y},oe=ro(Q.x,Q.y,250,window.innerHeight*.4);ii(oe),localStorage.setItem("detailedInfoDialogPosition",JSON.stringify(oe))},S=()=>{zs(!1),yr(null)};return document.addEventListener("mousemove",p),document.addEventListener("mouseup",S),()=>{document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",S)}},[Mi,zi,ro]),Ct.useEffect(()=>{if(!er)return;const p=L=>{if(!ns)return;const Q={x:L.clientX-ns.x,y:L.clientY-ns.y};Hi(Q),localStorage.setItem("notesDialogPosition",JSON.stringify(Q))},S=()=>{dr(!1),Ii(null)};return document.addEventListener("mousemove",p),document.addEventListener("mouseup",S),()=>{document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",S)}},[er,ns]),Ct.useEffect(()=>{if(Ns&&Cs===null){const p=localStorage.getItem("notesDialogPosition");if(p)try{const S=JSON.parse(p);Hi(S)}catch{Hi({x:window.innerWidth-550,y:100})}else Hi({x:window.innerWidth-550,y:100})}},[Ns,Cs]),Ct.useEffect(()=>{if(!so)return;const p=L=>{if(!$s)return;const Q={x:L.clientX-$s.x,y:L.clientY-$s.y};Zr(Q),localStorage.setItem("projectNotesDialogPosition",JSON.stringify(Q))},S=()=>{aa(!1),zl(null)};return document.addEventListener("mousemove",p),document.addEventListener("mouseup",S),()=>{document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",S)}},[so,$s]),Ct.useEffect(()=>{if(bn&&Ai===null){const p=localStorage.getItem("projectNotesDialogPosition");if(p)try{const S=JSON.parse(p);Zr(S)}catch{Zr({x:100,y:100})}else Zr({x:100,y:100})}},[bn,Ai]);const Pf=K.useCallback(()=>{vn(!0)},[]);Ct.useEffect(()=>{if(Ur&&Ur.visible&&Ra===null){const p=localStorage.getItem("componentDialogPosition");let S;if(p)try{const L=JSON.parse(p);S=ro(L.x,L.y,250,window.innerHeight*.4),Za(S)}catch{S=ro(window.innerWidth-280,90,250,window.innerHeight*.4),Za(S)}else S=ro(window.innerWidth-280,90,250,window.innerHeight*.4),Za(S)}else!Ur||Ur.visible},[Ur,Ra,ro]),Ct.useEffect(()=>{if(eo.visible&&Gi===null){const p=localStorage.getItem("detailedInfoDialogPosition");let S;if(p)try{const L=JSON.parse(p);S=ro(L.x,L.y,400,window.innerHeight*.8),ii(S)}catch{S=ro(window.innerWidth-450,90,400,window.innerHeight*.8),ii(S)}else S=ro(window.innerWidth-450,90,400,window.innerHeight*.8),ii(S)}else eo.visible},[eo.visible,Gi,ro]),Ct.useEffect(()=>{const p=()=>{if(Ra){const S=ro(Ra.x,Ra.y,250,window.innerHeight*.4);(S.x!==Ra.x||S.y!==Ra.y)&&(Za(S),localStorage.setItem("componentDialogPosition",JSON.stringify(S)))}if(Gi){const S=ro(Gi.x,Gi.y,400,window.innerHeight*.8);(S.x!==Gi.x||S.y!==Gi.y)&&(ii(S),localStorage.setItem("detailedInfoDialogPosition",JSON.stringify(S)))}};return window.addEventListener("resize",p),()=>window.removeEventListener("resize",p)},[Ra,Gi,ro]);const Ef=K.useCallback(p=>{switch(p){case"transparency":f(50);break;case"brushSize":M(3);break}},[]),Rh=Ct.useRef(A);Ct.useEffect(()=>{Rh.current=A},[A]),Ct.useEffect(()=>{if(m){Ql.current=performance.now(),f(0);const p=S=>{const L=Ql.current||S,Q=Rh.current,oe=(S-L)%Q/Q,he=1-Math.abs(1-2*oe);f(Math.round(he*100)),El.current=requestAnimationFrame(p)};El.current=requestAnimationFrame(p)}return()=>{El.current&&(cancelAnimationFrame(El.current),El.current=null)}},[m]),Ct.useEffect(()=>{if(k==="center"){ya(f5());return}const p=k==="erase"?"erase":k==="magnify"?"magnify":k==="ground"?"ground":k==="power"?"power":k==="component"?"component":k==="draw"?lt==="via"?"via":lt==="pad"?"pad":lt==="testPoint"?"testPoint":"trace":"default";if(p==="default"){ya(void 0);return}const S=At;let L;if(p==="magnify")L=18;else if(p==="component"){const ge=(pi||"top")==="top"?"componentTop":"componentBottom",be=Ln.get(ge).size||py.DEFAULT_SIZE;L=Math.max(16,Math.round(be*S))}else if(p==="trace"){const ge=($n||"top")==="top"?"traceTop":"traceBottom",be=Ln.get(ge).size||6;L=Math.max(6,Math.round(be*S))}else if(p==="via"){const ge=Ln.get("via").size||6;L=Math.max(6,Math.round(ge*S))}else if(p==="pad"){const ge=(xi||"top")==="top"?"padTop":"padBottom",be=Ln.get(ge).size||6;L=Math.max(6,Math.round(be*S))}else if(p==="testPoint"){const ge=(En||"top")==="top"?"testPointTop":"testPointBottom",be=Ln.get(ge).size||18;L=Math.max(12,Math.round(be*S))}else p==="power"||p==="ground"?L=Math.max(12,Math.round(X*S)):L=Math.max(6,Math.round(X*S));const oe=L+4*2+(p==="magnify"?8:0),he=document.createElement("canvas");he.width=oe,he.height=oe;const V=he.getContext("2d");if(!V){ya(void 0);return}const Ae=oe/2,fe=oe/2,je=L/2;if(V.clearRect(0,0,oe,oe),p==="via"){const Ce=je,ge=je*.5,Se=je*.7,ye=Ln.get("via").color;V.fillStyle=ye,V.beginPath(),V.arc(Ae,fe,Ce,0,Ha),V.arc(Ae,fe,ge,0,Ha),V.fill("evenodd"),V.strokeStyle="#808080",V.lineWidth=1,V.beginPath(),V.moveTo(Ae-Se,fe),V.lineTo(Ae+Se,fe),V.stroke(),V.beginPath(),V.moveTo(Ae,fe-Se),V.lineTo(Ae,fe+Se),V.stroke()}else if(p==="pad"){const Ce=xi==="top"?"padTop":"padBottom",Se=Ln.get(Ce).color,ye=L/2,Le=ye*2,Ee=Le*.5,qe=ye*.7;V.fillStyle=Se,V.beginPath(),V.rect(Ae-ye,fe-ye,Le,Le),V.rect(Ae-Ee/2,fe-Ee/2,Ee,Ee),V.fill("evenodd"),V.strokeStyle="#808080",V.lineWidth=1,V.beginPath(),V.moveTo(Ae-qe,fe),V.lineTo(Ae+qe,fe),V.stroke(),V.beginPath(),V.moveTo(Ae,fe-qe),V.lineTo(Ae,fe+qe),V.stroke()}else if(p==="trace"){const Ce=$n==="top"?"traceTop":"traceBottom",Se=Ln.get(Ce).color;V.fillStyle=Se,V.beginPath(),V.arc(Ae,fe,je,0,Ha),V.fill()}else if(p==="testPoint"){ya(p5(L));return}else if(p==="erase"){const Ce=X*S,ge=Math.max(Ce*.75,8),Se=Math.max(Ce*.5,6),be=Math.max(Ce*.2,2);V.save(),V.translate(Ae,fe),V.rotate(Kd(-35)),V.fillStyle="#f5a3b3",V.strokeStyle="#111",V.lineWidth=1.5;const ye=1.5,Le=-ge/2,Ee=-Se/2;V.beginPath(),V.moveTo(Le+ye,Ee),V.lineTo(Le+ge-ye,Ee),V.quadraticCurveTo(Le+ge,Ee,Le+ge,Ee+ye),V.lineTo(Le+ge,Ee+Se-ye),V.quadraticCurveTo(Le+ge,Ee+Se,Le+ge-ye,Ee+Se),V.lineTo(Le+ye,Ee+Se),V.quadraticCurveTo(Le,Ee+Se,Le,Ee+Se-ye),V.lineTo(Le,Ee+ye),V.quadraticCurveTo(Le,Ee,Le+ye,Ee),V.closePath(),V.fill(),V.stroke(),V.fillStyle="#f18ea4",V.beginPath(),V.rect(-ge/2,Se/2-be,ge,be),V.fill(),V.restore()}else if(p==="magnify"){const Ce=je;V.strokeStyle="#111",V.lineWidth=2,V.beginPath(),V.arc(Ae-2,fe-2,Ce,0,Ha),V.stroke();const ge=Ae+Ce*.6,Se=fe+Ce*.6,be=ge+6,ye=Se+6;V.beginPath(),V.moveTo(ge,Se),V.lineTo(be,ye),V.stroke(),V.beginPath(),V.moveTo(Ae-6,fe-2),V.lineTo(Ae+2,fe-2),V.stroke(),Ba||(V.beginPath(),V.moveTo(Ae-2,fe-6),V.lineTo(Ae-2,fe+2),V.stroke())}else if(p==="ground"){const ge=(Bt?P.find(be=>be.id===Bt):null)?.color||"#000000";if(V.strokeStyle=ge,V.lineWidth=2,V.lineCap="round",Bt==="groundbus-earth"){const be=je*1.5,ye=be*.9,Le=be*.24,Ee=be*1.6;V.beginPath(),V.moveTo(Ae,fe-ye/2),V.lineTo(Ae,fe+ye/2),V.stroke();for(let qe=0;qe<3;qe++){const ct=fe+ye/2+qe*Le,ht=Ee*(1-qe*.25);V.beginPath(),V.moveTo(Ae-ht/2,ct),V.lineTo(Ae+ht/2,ct),V.stroke()}}else{const be=je*.8;V.beginPath(),V.arc(Ae,fe,je,0,Ha),V.stroke(),V.beginPath(),V.moveTo(Ae,fe-je-be),V.lineTo(Ae,fe+je+be),V.stroke(),V.beginPath(),V.moveTo(Ae-je-be,fe),V.lineTo(Ae+je+be,fe),V.stroke()}}else if(p==="power"){const ge=(Be?gn.find(be=>be.id===Be):null)?.color||"#ff0000";V.strokeStyle=ge,V.lineWidth=2,V.lineCap="round";const Se=je*.8;V.beginPath(),V.arc(Ae,fe,je,0,Ha),V.stroke(),V.beginPath(),V.moveTo(Ae,fe-je-Se),V.lineTo(Ae,fe+je+Se),V.stroke(),V.beginPath(),V.moveTo(Ae-je-Se,fe),V.lineTo(Ae+je+Se,fe),V.stroke()}else if(p==="component"){const ge=(pi||"top")==="top"?"componentTop":"componentBottom",be=Ln.get(ge).color,ye=L,Le=ye/2;V.strokeStyle=be,V.lineWidth=2,V.fillStyle="rgba(255,255,255,0.9)",V.beginPath(),V.rect(Ae-Le,fe-Le,ye,ye),V.fill(),V.stroke();const Ee=(()=>{const qe=Yc?.dataDrivenDefinition?.designator??Yc?.componentDefinition?.designator??Yc?.designator;return qe?qe.length<=3?qe:qe.substring(0,3):cc?jm(cc):"?"})();V.fillStyle=be,V.font=`bold ${Math.max(8,ye*.35)}px sans-serif`,V.textAlign="center",V.textBaseline="middle",V.fillText(Ee,Ae,fe)}const ke=`url(${he.toDataURL()}) ${Math.round(Ae)} ${Math.round(fe)}, crosshair`;ya(ke)},[k,lt,F,X,At,Ba,cc,Yc,Be,Bt,gn,P,Un,$n,xi,En,pi,ss.toolInstanceId]),Ct.useEffect(()=>{uu()},[uu]),Ct.useEffect(()=>{uu()},[Dl.width,Dl.height]),Ct.useEffect(()=>{ti.size===0&&k==="draw"&&lt==="trace"&&X>=1&&($t==="top"?ie(X):q(X))},[X,k,lt,$t,ti]),Ct.useEffect(()=>{_t(p=>p.map(S=>{if(S.type==="via"&&S.points.length>0&&S.points[0].id!==void 0){const L=S.points[0].id,Q=So(L,gn);if(S.viaType!==Q)return{...S,viaType:Q}}else if(S.type==="pad"&&S.points.length>0&&S.points[0].id!==void 0){const L=S.points[0].id,Q=Jr(L,gn);if(S.padType!==Q)return{...S,padType:Q}}else if(S.type==="testPoint"&&S.points.length>0&&S.points[0].id!==void 0){const L=S.points[0].id,Q=ml(L,gn),oe=Q.includes("Power")?"power":Q.includes("Ground")?"ground":Q.includes("Signal")?"signal":"unknown";if(S.testPointType!==oe)return{...S,testPointType:oe}}return S}))},[Rn,y,gn,So,Jr,ml]);const Rf=K.useCallback(()=>{const p=rs.current;if(!p)return;const S=p.toDataURL("image/png"),L=window.open("","_blank");if(!L){alert("Please allow popups to print the canvas.");return}L.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>PCB Drawing</title>
          <style>
            @media print {
              @page {
                margin: 0;
                size: auto;
              }
              body {
                margin: 0;
                padding: 0;
              }
            }
            body {
              margin: 0;
              padding: 20px;
              display: flex;
              justify-content: center;
              align-items: center;
              background: white;
            }
            img {
              max-width: 100%;
              height: auto;
              display: block;
            }
          </style>
        </head>
        <body>
          <img src="${S}" alt="PCB Drawing" onload="window.setTimeout(function() { window.print(); }, 250);" />
        </body>
      </html>
    `),L.document.close()},[]);Ct.useEffect(()=>{const p=L=>{L.key==="Shift"&&tc(!0)},S=L=>{L.key==="Shift"&&tc(!1)};return window.addEventListener("keydown",p),window.addEventListener("keyup",S),()=>{window.removeEventListener("keydown",p),window.removeEventListener("keyup",S)}},[]);const Df=K.useCallback(p=>{if(p.size===0)return;const S=Array.from(p).map(L=>String(L));_t(L=>L.map(Q=>{if(Q.type==="trace"){const oe=Q.points.filter(he=>he.id===void 0?!0:!p.has(he.id));return oe.length<2?null:{...Q,points:oe}}return Q}).filter(Q=>Q!==null)),Pi(L=>L.map(Q=>{const oe=Q.pinConnections||[];if(oe.some(V=>V&&S.includes(V))){const V=oe.map(Ae=>Ae&&S.includes(Ae)?"":Ae);return{...Q,pinConnections:V}}return Q})),Gn(L=>L.map(Q=>{const oe=Q.pinConnections||[];if(oe.some(V=>V&&S.includes(V))){const V=oe.map(Ae=>Ae&&S.includes(Ae)?"":Ae);return{...Q,pinConnections:V}}return Q}))},[_t,Pi,Gn]),Dh=K.useRef(new Set);Ct.useEffect(()=>{const p=new Set;for(const L of ft)if((L.type==="via"||L.type==="pad")&&L.points.length>0){const Q=L.points[0].id;Q!==void 0&&p.add(Q)}const S=new Set;for(const L of Dh.current)p.has(L)||S.add(L);S.size>0&&Df(S),Dh.current=p},[ft,Df]),Ct.useEffect(()=>{_t(p=>p.map(S=>{if(S.type==="via"&&S.points.length>0&&S.points[0].id!==void 0){const L=S.points[0].id,Q=So(L,gn);if(S.viaType!==Q)return{...S,viaType:Q}}else if(S.type==="pad"&&S.points.length>0&&S.points[0].id!==void 0){const L=S.points[0].id,Q=Jr(L,gn);if(S.padType!==Q)return{...S,padType:Q}}else if(S.type==="testPoint"&&S.points.length>0&&S.points[0].id!==void 0){const L=S.points[0].id,Q=ml(L,gn),oe=Q.includes("Power")?"power":Q.includes("Ground")?"ground":Q.includes("Signal")?"signal":"unknown";if(S.testPointType!==oe)return{...S,testPointType:oe}}return S}))},[Rn,y,gn,So,Jr,ml]),Ct.useEffect(()=>{const p=S=>{bo.current&&(bo.current.contains(S.target)||Qa(null))};return document.addEventListener("click",p),()=>document.removeEventListener("click",p)},[]),Ct.useEffect(()=>{const p=(S,L)=>{const Q=S.current;if(!Q)return;const oe=Q.getContext("2d");if(!oe)return;const he=Q.width,V=Q.height;if(oe.clearRect(0,0,he,V),oe.fillStyle="#fff",oe.fillRect(0,0,he,V),L?.bitmap){const Ae=L.bitmap,fe=Math.min(he/Ae.width,V/Ae.height),je=Math.max(1,Math.floor(Ae.width*fe)),ke=Math.max(1,Math.floor(Ae.height*fe)),Ce=Math.floor((he-je)/2),ge=Math.floor((V-ke)/2);oe.drawImage(Ae,Ce,ge,je,ke)}oe.strokeStyle="#ddd",oe.lineWidth=1,oe.strokeRect(.5,.5,he-1,V-1)};p(ic,t),p(Qd,s)},[t,s]),Ct.useEffect(()=>{const p=[],S=[],L=[],Q=[];for(const oe of ft)if(oe.type==="via"&&oe.points.length>=1){const he=oe.points[0],V={id:oe.id,pointId:he.id,x:he.x,y:he.y,size:oe.size,color:oe.color};p.push(V)}else if(oe.type==="pad"&&oe.points.length>=1){const he=oe.points[0],V={id:oe.id,pointId:he.id,x:he.x,y:he.y,size:oe.size,color:oe.color,layer:oe.layer||"top"};S.push(V)}else if(oe.type==="trace"&&oe.points.length>=2)for(let he=0;he<oe.points.length-1;he++){const V=oe.points[he],Ae=oe.points[he+1],fe={id:oe.id,startPointId:V.id,endPointId:Ae.id,x1:V.x,y1:V.y,x2:Ae.x,y2:Ae.y,size:oe.size,color:oe.color};oe.layer==="top"?L.push(fe):Q.push(fe)}Et(p),fr(S),Xa(L),co(Q)},[ft]);const Fd=K.useRef(ft);Fd.current=ft;const dc=K.useCallback(()=>{const S=new Date().toISOString(),L=ox();return{project:{version:1,fileType:"PCB_REVERSE_ENGINEERING_AUTOSAVE",savedAt:S,view:{currentView:d,viewScale:At,cameraWorldCenter:Ci,showBothLayers:Yl,selectedDrawingLayer:$t},images:{top:t?{name:t.name,width:t.width,height:t.height,filePath:t.filePath||t.name,x:t.x,y:t.y,scale:t.scale,rotation:t.rotation,flipX:t.flipX,flipY:t.flipY,skewX:t.skewX,skewY:t.skewY,keystoneV:t.keystoneV,keystoneH:t.keystoneH,brightness:t.brightness??100,contrast:t.contrast??100}:null,bottom:s?{name:s.name,width:s.width,height:s.height,filePath:s.filePath||s.name,x:s.x,y:s.y,scale:s.scale,rotation:s.rotation,flipX:s.flipX,flipY:s.flipY,skewX:s.skewX,skewY:s.skewY,keystoneV:s.keystoneV,keystoneH:s.keystoneH,brightness:s.brightness??100,contrast:s.contrast??100}:null},projectDirectoryName:Ao.current?Ao.current.name||null:ki&&ki.name||null,drawing:{drawingStrokes:Fd.current.filter(oe=>!(oe.type==="trace"&&oe.points.length<2)),vias:na,tracesTop:Al,tracesBottom:Ea,componentsTop:It,componentsBottom:Yt,grounds:y,powers:Rn},powerBuses:gn,groundBuses:P,pointIdCounter:im(),designatorCounters:{...Hn.current},autoAssignDesignators:ts,useGlobalDesignatorCounters:Ht,traceColors:{top:Un.get("trace")?.layerSettings.get("top")?.color||G,bottom:Un.get("trace")?.layerSettings.get("bottom")?.color||_},traceSizes:{top:Un.get("trace")?.layerSettings.get("top")?.size||te,bottom:Un.get("trace")?.layerSettings.get("bottom")?.size||re},padColors:{top:Un.get("pad")?.layerSettings.get("top")?.color||J,bottom:Un.get("pad")?.layerSettings.get("bottom")?.color||_e},padSizes:{top:Un.get("pad")?.layerSettings.get("top")?.size||Z,bottom:Un.get("pad")?.layerSettings.get("bottom")?.size||H},componentColors:{top:Un.get("component")?.layerSettings.get("top")?.color||yt,bottom:Un.get("component")?.layerSettings.get("bottom")?.color||pe},componentSizes:{top:Un.get("component")?.layerSettings.get("top")?.size||Ut,bottom:Un.get("component")?.layerSettings.get("bottom")?.size||at},testPointColors:{top:Un.get("testPoint")?.layerSettings.get("top")?.color||ue,bottom:Un.get("testPoint")?.layerSettings.get("bottom")?.color||Pe},testPointSizes:{top:Un.get("testPoint")?.layerSettings.get("top")?.size||Re,bottom:Un.get("testPoint")?.layerSettings.get("bottom")?.size||Je},componentConnectionColor:Ot,componentConnectionSize:nn,toolLayerDefaults:{trace:$n,pad:xi,testPoint:En,component:pi},toolSettings:{trace:Un.get("trace")?.settings||{color:"#ff0000",size:6},via:Un.get("via")?.settings||{color:"#ff0000",size:18},pad:Un.get("pad")?.settings||{color:"#ff0000",size:18},component:Un.get("component")?.settings||{color:"#ff0000",size:18},ground:Un.get("ground")?.settings||{color:"#000000",size:18},power:Un.get("power")?.settings||{color:"#ff0000",size:18},erase:Un.get("erase")?.settings||{color:"#f5a3b3",size:18}},locks:{areImagesLocked:Ni,areViasLocked:Ei,arePadsLocked:as,areTracesLocked:pr,areComponentsLocked:Hs,areGroundNodesLocked:gr,arePowerNodesLocked:oi},visibility:{showViasLayer:lr,showTopPadsLayer:cr,showBottomPadsLayer:Gr,showTopTracesLayer:js,showBottomTracesLayer:ys,showTopComponents:io,showBottomComponents:Di,showPowerLayer:_a,showGroundLayer:si,showConnectionsLayer:Ts,showTraceCornerDots:Ms},autoSave:{enabled:rr,interval:kl,baseName:Nl},projectInfo:{name:Vs},projectNotes:xr,homeViews:mo,toolInstances:Ln.getAll()},timestamp:L}},[d,At,Ci,Yl,$t,t,s,ft,na,Al,Ea,It,Yt,y,Un,Ni,Ei,as,pr,Hs,gr,oi,gn,P,im,G,_,te,re,J,_e,Z,H,yt,pe,Ut,at,$n,xi,En,pi,rr,kl,Nl,Vs,lr,cr,Gr,js,ys,io,Di,_a,si,Ts,ts,Ht,xr,mo]),Lf=K.useRef(dc);Lf.current=dc;const Ul=K.useRef(jl);Ul.current=jl;const uc=K.useRef(Nl);uc.current=Nl;const Ec=K.useRef(hs);Ec.current=hs;const Lh=K.useRef(Pl);Lh.current=Pl;const Wo=K.useRef([]);Wo.current=Nd;const Ud=K.useRef(-1);Ud.current=Pd;const Ao=K.useRef(null),pu=K.useRef(!1);Ct.useEffect(()=>{pu.current||(Ao.current=ki)},[ki]);const Mh=K.useCallback(async()=>{console.log("Auto save: performAutoSave called");let p=Ul.current||Ao.current,S=uc.current;if(console.log(`Auto save: dirHandle=${p?`set (using ${Ul.current?"autoSaveDirHandle":"projectDirHandle"})`:"missing"}, baseName=${S||"missing"}`),!p||!S){console.warn(`Auto save: Missing project directory handle (${!p}) or base name (${!S}). Please create a new project or open an existing project first.`),Ta(!1),Fi.current&&(clearInterval(Fi.current),Fi.current=null);return}if(!ls.current){console.log("Auto save: Skipping - no changes since last save");return}const L=Fd.current,Q=L.filter(ke=>ke.type==="trace"&&ke.points.length<2);if(Q.length>0){console.log(`Auto save: Cleaning up ${Q.length} single-point trace(s) before save`),Q.forEach(Ce=>console.log(`  - Removing single-point trace ${Ce.id}`));const ke=L.filter(Ce=>!(Ce.type==="trace"&&Ce.points.length<2));_t(ke),Fd.current=ke}console.log("Auto save: Starting save...");const{project:oe,timestamp:he}=Lf.current(),Ae=`${Qu(S)}_${he}.json`,fe=JSON.stringify(oe,null,2),je=new Blob([fe],{type:"application/json"});try{let ke;try{ke=await p.getDirectoryHandle("history",{create:!0})}catch(ye){console.error("Failed to get/create history directory:",ye);return}try{const ye=[],Le=Lh.current;for await(const Ee of p.keys())try{if(Ee==="history"||Ee===Ae)continue;const ct=await(await p.getFileHandle(Ee)).getFile();if(!Ee.endsWith(".json"))continue;const ht=await ct.text();try{const wt=JSON.parse(ht);if(wt.version&&(wt.fileType==="PCB_REVERSE_ENGINEERING_AUTOSAVE"||!wt.fileType)){ye.push(Ee);const it=wt.fileType?"auto-saved":"manually saved/opened";console.log(`Auto save: Found PCB project file in root: ${Ee} (${it}${Ee===Le?" - this is the opened file":""})`)}}catch{continue}}catch{continue}for(const Ee of ye)try{const ht=await(await(await p.getFileHandle(Ee)).getFile()).text(),it=await(await ke.getFileHandle(Ee,{create:!0})).createWritable();await it.write(new Blob([ht],{type:"application/json"})),await it.close(),await p.removeEntry(Ee),console.log(`Auto save: Moved ${Ee} from root to history/`)}catch(qe){console.warn(`Auto save: Failed to move ${Ee} to history:`,qe)}}catch(ye){console.warn("Auto save: Error checking for old files in root:",ye)}const ge=await(await p.getFileHandle(Ae,{create:!0})).createWritable();await ge.write(je),await ge.close(),console.log(`Auto save: Successfully saved ${Ae} to root directory`),Ec.current(Ae);const Se=Wo.current,be=[Ae,...Se.filter(ye=>ye!==Ae)].sort((ye,Le)=>Le.localeCompare(ye));fl(be),Wo.current=be,Oo(0),Ud.current=0,ls.current=!1,to(!1)}catch(ke){console.error("Auto save failed:",ke)}},[]);rd.current=Mh;const pd=K.useCallback(async()=>{const{project:p}=dc(),S=JSON.stringify(p,null,2),L=new Blob([S],{type:"application/json"});if(ki&&Vs)try{let je=null;try{je=await ki.getDirectoryHandle("history",{create:!0})}catch(Le){console.error("Failed to get/create history directory:",Le),je=null}const ke=Vs.replace(/\.json$/i,""),Ce=Qu(ke),{timestamp:ge}=dc(),Se=`${Ce}_${ge}.json`;if(je)try{const Le=[];for await(const Ee of ki.keys())try{if(Ee==="history"||Ee===Se)continue;const ct=await(await ki.getFileHandle(Ee)).getFile();if(!Ee.endsWith(".json"))continue;const ht=await ct.text();try{JSON.parse(ht).version&&(Le.push(Ee),console.log(`Save: Found PCB project file in root: ${Ee}`))}catch{continue}}catch{continue}for(const Ee of Le)try{const ht=await(await(await ki.getFileHandle(Ee)).getFile()).text(),it=await(await je.getFileHandle(Ee,{create:!0})).createWritable();await it.write(new Blob([ht],{type:"application/json"})),await it.close(),await ki.removeEntry(Ee),console.log(`Save: Moved ${Ee} from root to history/`)}catch(qe){console.warn(`Save: Failed to move ${Ee} to history:`,qe)}}catch(Le){console.warn("Save: Error checking for old files in root:",Le)}const ye=await(await ki.getFileHandle(Se,{create:!0})).createWritable();await ye.write(L),await ye.close(),hs(Se),to(!1),ls.current=!1,console.log(`Project saved successfully: ${Vs}/${Se}`),alert(`Project saved successfully!

File: ${Se}
Location: ${Vs}`);return}catch(je){const ke=je instanceof Error?je.message:String(je);console.error("Failed to save to project directory:",je),alert(`Failed to save project to directory.

Error: ${ke}

Please try saving again or use Save As...`),qs(null)}if(Vs&&!ki){const je=window;if(typeof je.showDirectoryPicker=="function")try{const ke=await je.showDirectoryPicker();qs(ke);const Ce=`${Vs}.json`,Se=await(await ke.getFileHandle(Ce,{create:!0})).createWritable();await Se.write(L),await Se.close(),hs(Ce),to(!1),ls.current=!1,console.log(`Project saved successfully: ${Ce} in selected directory`),alert(`Project saved successfully!

File: ${Ce}`);return}catch(ke){if(ke?.name!=="AbortError"){const Ce=ke instanceof Error?ke.message:String(ke);console.error("Failed to get directory:",ke),alert(`Failed to select directory.

Error: ${Ce}

Falling back to file picker...`)}}}const Q=je=>String(je).padStart(2,"0"),oe=new Date,V=`pcb_project_${`${oe.getFullYear()}_${Q(oe.getMonth()+1)}_${Q(oe.getDate())}_${Q(oe.getHours())}_${Q(oe.getMinutes())}_${Q(oe.getSeconds())}`}.json`,Ae=window;if(typeof Ae.showSaveFilePicker=="function")try{const je=await Ae.showSaveFilePicker({suggestedName:V,types:[{description:"PCB Project",accept:{"application/json":[".json"]}}]}),ke=await je.createWritable();await ke.write(L),await ke.close();const Ce=je.name;try{const be=await je.getFile();hs(be.name)}catch{hs(Ce)}const Se=Ce.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_");Se&&za(Se);try{const be=je.name.replace(/\.json$/i,""),Le=Qu(be).replace(/[^a-zA-Z0-9_-]/g,"_");no(Le),jl||console.log("Auto save: Directory handle not set. Will prompt on first auto save.")}catch(be){console.warn("Could not set up auto save for new file:",be)}console.log(`Project saved successfully: ${Ce}`),alert(`Project saved successfully!

File: ${Ce}`);return}catch(je){if(je?.name==="AbortError")return;const ke=je instanceof Error?je.message:String(je);console.warn("showSaveFilePicker failed, falling back to download",je),alert(`File picker unavailable.

Error: ${ke}

Falling back to browser download...`)}const fe=document.createElement("a");fe.href=URL.createObjectURL(L),fe.download=V,document.body.appendChild(fe),fe.click(),setTimeout(()=>{URL.revokeObjectURL(fe.href),document.body.removeChild(fe)},0),console.log(`Project downloaded: ${V}`),alert(`Project downloaded successfully!

File: ${V}

Note: For better project management, use File  New Project or File  Open Project.`)},[dc,ki,Vs,hs,qs,to,za,no,jl,Qu]),gu=K.useCallback(p=>{const S=new jn,L=S.internal.pageSize.getWidth(),Q=S.internal.pageSize.getHeight(),oe=20;let he=oe;const V=7,Ae=60;S.setFontSize(18),S.setFont("helvetica","bold"),S.text("Bill of Materials",L/2,he,{align:"center"}),he+=V*2,S.setFontSize(10),S.setFont("helvetica","normal"),p.projectName&&(S.text(`Project: ${p.projectName}`,oe,he),he+=V),S.text(`Exported: ${new Date(p.exportedAt).toLocaleString()}`,oe,he),he+=V,S.text(`Total Components: ${p.totalComponents} | Unique Components: ${p.uniqueComponents}`,oe,he),he=Ae,S.setFontSize(9),S.setFont("helvetica","bold");const fe=[15,50,30,20,25,30,20],je=["Qty","Component Type","Value","Package","Manufacturer","Part Number","Layer"];let ke=oe;return je.forEach((ge,Se)=>{S.text(ge,ke,he),ke+=fe[Se]}),he+=V,S.setLineWidth(.5),S.line(oe,he,L-oe,he),he+=V*.5,S.setFont("helvetica","normal"),S.setFontSize(8),p.items.forEach(ge=>{const Se=qe=>{he>Q-oe-V*qe&&(S.addPage(),he=oe+V)};Se(3),ke=oe,[ge.quantity.toString(),ge.componentType,ge.value||"-",ge.packageType||"-",ge.manufacturer||"-",ge.partNumber||"-",ge.layer].forEach((qe,ct)=>{const ht=fe[ct]-2,wt=S.splitTextToSize(qe,ht);S.text(wt[0]||"-",ke,he),ke+=fe[ct]}),he+=V*1.2;const ye=(ge.notes||"").toString().trim(),Le=ge.datasheet?ge.datasheet.toString().trim():"",Ee=[];if(ye&&Ee.push(`Notes: ${ye}`),Le&&Ee.push(`Spec Sheet URL: ${Le}`),Ee.length>0){const qe=oe+fe[0]+2,ct=L-oe-qe;Ee.forEach(ht=>{S.splitTextToSize(ht,ct).forEach(it=>{Se(2),S.text(it,qe,he),he+=V*.9})})}Se(1),S.setLineWidth(.2),S.line(oe,he,L-oe,he),he+=V*.5}),S.output("blob")},[]),Gs=K.useCallback(async()=>{if(console.log("handleExportBOM called, format:",$),!ki){alert("Please create or open a project before exporting BOM.");return}try{console.log("Generating BOM data...");const p=y5(It,Yt,Vs);console.log("BOM data generated:",p),console.log("Creating/getting BOM directory...");let S;try{S=await ki.getDirectoryHandle("BOM",{create:!0}),console.log("BOM directory obtained")}catch(Ae){console.error("Failed to get/create BOM directory:",Ae),alert("Failed to create BOM directory. See console for details.");return}const L=ox();let Q,oe;if($==="pdf")console.log("Generating PDF..."),Q=gu(p),oe=`BOM_${L}.pdf`;else{console.log("Generating JSON...");const Ae=JSON.stringify(p,null,2);Q=new Blob([Ae],{type:"application/json"}),oe=`BOM_${L}.json`}console.log("Saving file:",oe);const V=await(await S.getFileHandle(oe,{create:!0})).createWritable();await V.write(Q),await V.close(),console.log("BOM file saved successfully"),alert(`BOM exported successfully to ${oe} in BOM directory!`)}catch(p){console.error("Failed to export BOM:",p),alert(`Failed to export BOM: ${p instanceof Error?p.message:String(p)}. See console for details.`)}},[ki,It,Yt,Vs,$,gu]);Ct.useEffect(()=>{Fi.current&&(clearInterval(Fi.current),Fi.current=null);const p=Er.current;if(Er.current=rr,rr&&kl){const S=kl*60*1e3;(jl||ki)&&Nl?(console.log(`Auto save: Setting up interval for ${kl} minute(s) (${S}ms)`),p||(ls.current=!0,setTimeout(()=>{Mh()},100)),Fi.current&&(clearInterval(Fi.current),Fi.current=null),Fi.current=window.setInterval(()=>{console.log("Auto save: Interval triggered, calling performAutoSave..."),console.log(`  - hasChangesSinceLastAutoSave: ${ls.current}`),console.log(`  - dirHandle: ${Ul.current?"set":"missing"}`),console.log(`  - baseName: ${uc.current||"missing"}`),Mh()},S),console.log(`Auto save: Interval set up for ${S}ms (${kl} minutes)`),console.log(`  - Auto save directory handle: ${jl?"set":"missing"}`),console.log(`  - Project directory handle: ${ki?"set":"missing"}`),console.log(`  - Base name: ${Nl||"missing"}`)):(console.warn(`Auto save: Cannot set up interval - missing directory handle (autoSaveDirHandle: ${!!jl}, projectDirHandle: ${!!ki}) or base name (${!Nl}). Disabling auto save.`),Ta(!1),Fi.current&&(clearInterval(Fi.current),Fi.current=null))}else rr||(Er.current=!1);return()=>{Fi.current&&(clearInterval(Fi.current),Fi.current=null)}},[rr,kl,jl,Nl,ki]);const zh=K.useRef(!1),Ih=K.useRef(!1),[Up,Zu]=Ct.useState(0);Ct.useEffect(()=>{const S=Object.keys(Ln.getAll()).map(L=>Ln.subscribe(L,()=>{Zu(Q=>Q+1)}));return()=>S.forEach(L=>L())},[]),Ct.useEffect(()=>{if(Ih.current){console.log("Change tracking: Skipping - project is being loaded");return}if(rr&&zh.current){zh.current=!1,console.log("Auto save: Skipping change tracking on first run after enable (initial save handled separately)");return}ls.current=!0,to(!0),console.log("Change detected, marking as unsaved",{autoSaveEnabled:rr,topImage:!!t,bottomImage:!!s,drawingStrokesCount:ft.length,componentsTopCount:It.length,componentsBottomCount:Yt.length,powersCount:Rn.length,groundsCount:y.length,powerBusesCount:gn.length,projectNotesCount:xr.length,areImagesLocked:Ni,areViasLocked:Ei,areTracesLocked:pr,areComponentsLocked:Hs,areGroundNodesLocked:gr,arePowerNodesLocked:oi})},[t,s,ft,It,Yt,Rn,y,gn,xr,G,_,te,re,Ni,Ei,pr,Hs,gr,oi,P,rr,J,_e,Z,H,yt,pe,Ut,at,ue,Pe,Re,Je,Ot,nn,$n,ts,Ht,mo,Un,Up]),Ct.useEffect(()=>{rr?(zh.current=!0,console.log("Auto save: Enabled, marking first run")):zh.current=!1},[rr]),Ct.useEffect(()=>{rr||(ls.current=!1)},[rr]);const Rc=K.useCallback(()=>!!(t||s||ft.length>0||It.length>0||Yt.length>0||Rn.length>0||y.length>0),[t,s,ft,It,Yt,Rn,y]),mu=K.useCallback(()=>{zo({visible:!0,projectName:"",locationPath:"",locationHandle:null})},[]),Hp=K.useCallback(async()=>{const p=window;if(typeof p.showDirectoryPicker=="function")try{const S=await p.showDirectoryPicker({mode:"readwrite"});zo(L=>({...L,locationHandle:S,locationPath:S.name||"Selected folder"}))}catch(S){S?.name!=="AbortError"&&(console.error("Failed to get directory:",S),alert("Failed to select location directory."))}else alert("Directory picker is not supported in this browser. Please use a modern browser like Chrome or Edge.")},[]),yu=K.useCallback(async()=>{const p=_i.projectName.trim();if(!p){alert("Please enter a project name.");return}const S=p.replace(/[^a-zA-Z0-9_-]/g,"_")||"pcb_project";if(!_i.locationHandle){alert("Please select a location for the project.");return}const L=_i.locationHandle;let Q,oe;if(L.name===S)Q=L,oe=L;else{oe=L;try{Q=await oe.getDirectoryHandle(S,{create:!0})}catch(he){console.error("Failed to create project folder:",he),alert(`Failed to create project folder "${S}". See console for details.`);return}}Od(),zo({visible:!1,projectName:"",locationPath:"",locationHandle:null}),za(S),qs(Q),fd(),Cr(),qr(!1),f(0);try{const{project:he,timestamp:V}=dc(),fe=`${Qu(S)}_${V}.json`,je=JSON.stringify(he,null,2),ke=new Blob([je],{type:"application/json"}),ge=await(await Q.getFileHandle(fe,{create:!0})).createWritable();await ge.write(ke),await ge.close(),hs(fe),console.log(`New project created: ${S}/${fe}`),nr({visible:!0,source:"new",interval:5})}catch(he){console.error("Failed to save new project:",he),alert("Failed to save new project file. See console for details.")}},[fd,dc,_i,Od,Cr,qr,f]),Hl=K.useCallback(()=>{zo({visible:!1,projectName:"",locationPath:"",locationHandle:null})},[]),qp=K.useCallback(async()=>{const p=window;if(typeof p.showDirectoryPicker=="function")try{const S=await p.showDirectoryPicker();ws(L=>({...L,locationHandle:S,locationPath:S.name||"Selected folder"}))}catch(S){S?.name!=="AbortError"&&(console.error("Failed to get directory:",S),alert("Failed to select location directory."))}else alert("Directory picker is not supported in this browser. Please use a modern browser that supports the File System Access API.")},[]),Bh=K.useCallback(async()=>{const p=os.filename.trim();if(!p){alert("Please enter a file name.");return}const L=(p.endsWith(".json")?p:`${p}.json`).replace(/[^a-zA-Z0-9_.-]/g,"_");if(!os.locationHandle){alert("Please select a location for the file.");return}const Q=os.locationHandle;try{const{project:oe}=dc(),he=JSON.stringify(oe,null,2),V=new Blob([he],{type:"application/json"}),fe=await(await Q.getFileHandle(L,{create:!0})).createWritable();await fe.write(V),await fe.close(),hs(L);const je=L.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_");je&&za(je),qs(Q),to(!1),ls.current=!1,ws({visible:!1,filename:"",locationPath:"",locationHandle:null}),Qa(null),console.log(`Project saved as: ${L} in selected directory`)}catch(oe){console.error("Failed to save project:",oe),alert(`Failed to save project file "${L}". See console for details.`)}},[os,dc]),Oh=K.useCallback(()=>{ws({visible:!1,filename:"",locationPath:"",locationHandle:null})},[]),Ju=K.useCallback(async()=>{ir({visible:!1}),await pd(),mu(),Pc()},[pd,mu,Pc]),Mf=K.useCallback(()=>{ir({visible:!1}),mu(),Pc()},[mu,Pc]),Fh=K.useCallback(()=>{ir({visible:!1})},[]);Ct.useEffect(()=>{if(wa.visible){setTimeout(()=>{As.current?.focus()},0);const p=S=>{S.key==="Enter"?(S.preventDefault(),Ju()):S.key==="Escape"&&(S.preventDefault(),ir({visible:!1}))};return window.addEventListener("keydown",p),()=>{window.removeEventListener("keydown",p)}}},[wa.visible,Ju]);const gd=K.useCallback(async(p,S)=>{Ih.current=!0;try{if(vi(),p.toolInstances?Ln.initializeFromProject(p):Ln.initialize(),p.projectInfo&&p.projectInfo.name&&za(p.projectInfo.name),p.view){if(p.view.currentView&&c(p.view.currentView),p.view.viewScale!=null&&fi(p.view.viewScale),p.view.cameraWorldCenter)Si(p.view.cameraWorldCenter);else if(p.view.viewPan){const ke=rs.current;if(ke){const Ce=(ke.width-10)/2,ge=(ke.height-10)/2,Se=p.view.viewScale??1,be=(Ce-p.view.viewPan.x)/Se,ye=(ge-p.view.viewPan.y)/Se;Si({x:be,y:ye})}else Si({x:0,y:0})}p.view.showBothLayers!=null&&Va(p.view.showBothLayers),p.view.selectedDrawingLayer&&Gt(p.view.selectedDrawingLayer)}if(p.homeViews){const ke={};for(const[Ce,ge]of Object.entries(p.homeViews)){const Se=parseInt(Ce,10),be=ge;let ye=be.pcbReferenceX,Le=be.pcbReferenceY;(ye===void 0||Le===void 0)&&(ye=be.x??0,Le=be.y??0),be.showTopImage===void 0?ke[Se]={pcbReferenceX:ye,pcbReferenceY:Le,x:0,y:0,zoom:be.zoom,viewRotation:ei,viewFlipX:Ji,isBottomView:Sa,transparency:h,showTopImage:Ls,showBottomImage:Ml,showViasLayer:lr,showTopTracesLayer:js,showBottomTracesLayer:ys,showTopPadsLayer:cr,showBottomPadsLayer:Gr,showTopTestPointsLayer:fs,showBottomTestPointsLayer:vo,showTopComponents:io,showBottomComponents:Di,showPowerLayer:_a,showGroundLayer:si,showConnectionsLayer:Ts}:ke[Se]={...be,pcbReferenceX:ye,pcbReferenceY:Le,x:0,y:0,viewRotation:be.viewRotation??0,viewFlipX:be.viewFlipX??!1,isBottomView:be.isBottomView??!1,transparency:be.transparency??50}}Rl(ke)}else Rl({});if(p.projectNotes&&Array.isArray(p.projectNotes)?_s(p.projectNotes):_s([]),p.traceColors&&(p.traceColors.top&&(U(p.traceColors.top),Mt("trace",p.traceColors.top,"top")),p.traceColors.bottom&&(N(p.traceColors.bottom),Mt("trace",p.traceColors.bottom,"bottom"))),p.traceSizes){const ke=p.traceSizes.top!=null&&p.traceSizes.top>0?p.traceSizes.top:6;let Ce=p.traceSizes.bottom!=null&&p.traceSizes.bottom>0?p.traceSizes.bottom:6;Ce<6&&(Ce=6),ie(ke),q(Ce),Pt("trace",ke,"top"),Pt("trace",Ce,"bottom")}else ie(6),q(6);if(p.padColors&&(p.padColors.top&&(ce(p.padColors.top),Mt("pad",p.padColors.top,"top")),p.padColors.bottom&&(xe(p.padColors.bottom),Mt("pad",p.padColors.bottom,"bottom"))),p.padSizes){const ke=p.padSizes.top!=null&&p.padSizes.top>0?p.padSizes.top:18,Ce=p.padSizes.bottom!=null&&p.padSizes.bottom>0?p.padSizes.bottom:18;D(ke),Y(Ce),Pt("pad",ke,"top"),Pt("pad",Ce,"bottom")}if(p.componentColors&&(p.componentColors.top&&(Nt(p.componentColors.top),Mt("component",p.componentColors.top,"top")),p.componentColors.bottom&&(St(p.componentColors.bottom),Mt("component",p.componentColors.bottom,"bottom"))),p.componentSizes){const ke=p.componentSizes.top!=null&&p.componentSizes.top>0?p.componentSizes.top:18,Ce=p.componentSizes.bottom!=null&&p.componentSizes.bottom>0?p.componentSizes.bottom:18;Lt(ke),en(Ce),Pt("component",ke,"top"),Pt("component",Ce,"bottom")}p.toolLayerDefaults?(p.toolLayerDefaults.trace&&Fr(p.toolLayerDefaults.trace),p.toolLayerDefaults.pad&&ga(p.toolLayerDefaults.pad),p.toolLayerDefaults.testPoint&&Qo(p.toolLayerDefaults.testPoint),p.toolLayerDefaults.component&&ma(p.toolLayerDefaults.component)):p.traceToolLayer&&Fr(p.traceToolLayer),p.toolSettings&&Fn(ke=>{const Ce=new Map(ke);if(p.toolSettings.trace){const Se=Ce.get("trace");if(Se){const be={...Se,settings:p.toolSettings.trace},ye=new Map(Se.layerSettings);p.traceSizes&&p.traceColors&&(ye.set("top",{color:p.traceColors.top||Se.layerSettings.get("top")?.color||"#AA4499",size:p.traceSizes.top||Se.layerSettings.get("top")?.size||6}),ye.set("bottom",{color:p.traceColors.bottom||Se.layerSettings.get("bottom")?.color||"#F781BF",size:p.traceSizes.bottom||Se.layerSettings.get("bottom")?.size||6})),Ce.set("trace",{...be,layerSettings:ye})}}if(p.toolSettings.via){const Se=Ce.get("via");Se&&Ce.set("via",{...Se,settings:p.toolSettings.via})}if(p.toolSettings.pad){const Se=Ce.get("pad");if(Se){const be={...Se,settings:p.toolSettings.pad},ye=new Map(Se.layerSettings);p.padSizes&&p.padColors&&(ye.set("top",{color:p.padColors.top||Se.layerSettings.get("top")?.color||"#0072B2",size:p.padSizes.top||Se.layerSettings.get("top")?.size||18}),ye.set("bottom",{color:p.padColors.bottom||Se.layerSettings.get("bottom")?.color||"#56B4E9",size:p.padSizes.bottom||Se.layerSettings.get("bottom")?.size||18})),Ce.set("pad",{...be,layerSettings:ye})}}if(p.toolSettings.component){const Se=Ce.get("component");if(Se){const be={...Se,settings:p.toolSettings.component},ye=new Map(Se.layerSettings);p.componentSizes&&p.componentColors&&(ye.set("top",{color:p.componentColors.top||Se.layerSettings.get("top")?.color||"#6A3D9A",size:p.componentSizes.top||Se.layerSettings.get("top")?.size||18}),ye.set("bottom",{color:p.componentColors.bottom||Se.layerSettings.get("bottom")?.color||"#9467BD",size:p.componentSizes.bottom||Se.layerSettings.get("bottom")?.size||18})),Ce.set("component",{...be,layerSettings:ye})}}if(p.testPointSizes&&p.testPointColors){Ne(p.testPointColors.top||ue),Ue(p.testPointColors.bottom||Pe),Ke(p.testPointSizes.top||Re),st(p.testPointSizes.bottom||Je);const Se=Ce.get("testPoint");if(Se){const be=new Map(Se.layerSettings);be.set("top",{color:p.testPointColors.top||Se.layerSettings.get("top")?.color||"#E69F00",size:p.testPointSizes.top||Se.layerSettings.get("top")?.size||6}),be.set("bottom",{color:p.testPointColors.bottom||Se.layerSettings.get("bottom")?.color||"#F0E442",size:p.testPointSizes.bottom||Se.layerSettings.get("bottom")?.size||6}),Ce.set("testPoint",{...Se,layerSettings:be})}}if(p.componentConnectionColor!==void 0&&wn(p.componentConnectionColor),p.componentConnectionSize!==void 0&&Zn(p.componentConnectionSize),p.toolSettings.ground){const Se=Ce.get("ground");Se&&Ce.set("ground",{...Se,settings:p.toolSettings.ground})}if(p.toolSettings.power){const Se=Ce.get("power");Se&&Ce.set("power",{...Se,settings:p.toolSettings.power})}if(p.toolSettings.erase){const Se=Ce.get("erase");Se&&Ce.set("erase",{...Se,settings:p.toolSettings.erase})}const ge=k==="draw"&&lt==="trace"?Ce.get("trace"):k==="draw"&&lt==="via"?Ce.get("via"):k==="draw"&&lt==="pad"?Ce.get("pad"):k==="draw"&&lt==="testPoint"?Ce.get("testPoint"):k==="component"?Ce.get("component"):k==="power"?Ce.get("power"):k==="ground"?Ce.get("ground"):null;if(ge)if(k==="draw"&&lt==="trace"){const Se=$n||"top",be=ge.layerSettings.get(Se);be?(I(be.color),M(be.size),Se==="top"?(U(be.color),ie(be.size)):(N(be.color),q(be.size))):(I(ge.settings.color),M(ge.settings.size))}else if(k==="draw"&&lt==="pad"){const Se=xi||"top",be=ge.layerSettings.get(Se);be?(I(be.color),M(be.size),Se==="top"?(ce(be.color),D(be.size)):(xe(be.color),Y(be.size))):(I(ge.settings.color),M(ge.settings.size))}else if(k==="component"){const Se=pi||"top",be=ge.layerSettings.get(Se);be?(I(be.color),M(be.size),Se==="top"?(Nt(be.color),Lt(be.size)):(St(be.color),en(be.size))):(I(ge.settings.color),M(ge.settings.size))}else if(k==="draw"&&lt==="testPoint"){const Se=En||"top",be=ge.layerSettings.get(Se);be?(I(be.color),M(be.size),Se==="top"?(Ne(be.color),Ke(be.size)):(Ue(be.color),st(be.size))):(I(ge.settings.color),M(ge.settings.size))}else I(ge.settings.color),M(ge.settings.size);return Ce});const L=async(ke,Ce)=>{if(!ke)return null;let ge=null,Se="",be=ke.filePath||ke.name;if(!Ce){const ye=ke.name||"image";return alert(`Error: Cannot load image "${ye}" because no project directory is available.

Please ensure you opened the project file from its project directory. The project directory is required to access the image files stored in the images/ subdirectory.`),null}if(be)try{let ye=be;!be.startsWith("images/")&&!be.startsWith("Images/")?ye=be:be.startsWith("Images/")?ye=be.replace("Images/",""):be.startsWith("images/")&&(ye=be.replace("images/",""));let Le;try{Le=await Ce.getDirectoryHandle("images")}catch{try{Le=await Ce.getDirectoryHandle("Images")}catch{throw new Error("Neither 'images' nor 'Images' directory found in project folder.")}}const qe=await(await Le.getFileHandle(ye)).getFile();ge=await createImageBitmap(qe),Se=URL.createObjectURL(qe),console.log(`Loaded image from file path: images/${ye}`),be.startsWith("images/")||(be=`images/${be.replace("Images/","")}`)}catch(ye){const Le=ye instanceof Error?ye.message:"Unknown error",Ee=ke.name||"image",qe=be.startsWith("images/")||be.startsWith("Images/")?be.replace("Images/","images/"):`images/${be}`;return alert(`Error: Failed to load image "${Ee}" from project directory.

Expected location: ${qe}

This may occur if:
- The image file was moved or deleted
- The project directory structure was modified
- File permissions are insufficient

Please ensure the image file exists in the images/ subdirectory of your project folder.

Technical details: ${Le}`),null}else{const ye=ke.name||"image";return alert(`Error: Image "${ye}" has no file path specified in the project file.

The project file is missing the image file path information. This may indicate the project file is corrupted or was created with an older version of the software.`),null}if(!ge){const ye=ke.name||"image";return alert(`Error: Could not create image bitmap for "${ye}".

The image file may be corrupted or in an unsupported format. Please ensure the image is a valid PNG, JPEG, or other supported image format.`),null}return{url:Se,name:ke.name??"image",width:ke.width??ge.width,height:ke.height??ge.height,filePath:be,x:ke.x??0,y:ke.y??0,scale:ke.scale??1,rotation:ke.rotation??0,flipX:!!ke.flipX,flipY:!!ke.flipY,skewX:ke.skewX??0,skewY:ke.skewY??0,keystoneV:ke.keystoneV??0,keystoneH:ke.keystoneH??0,brightness:ke.brightness??100,contrast:ke.contrast??100,bitmap:ge}},Q=S!==void 0?S:ki,oe=await L(p.images?.top,Q),he=await L(p.images?.bottom,Q);if(n(oe),o(he),p.pointIdCounter&&typeof p.pointIdCounter=="number"?xg(p.pointIdCounter):(console.warn("Project file missing pointIdCounter. Starting from 1."),xg(1)),p.locks&&(typeof p.locks.areImagesLocked=="boolean"&&Wi(p.locks.areImagesLocked),typeof p.locks.areViasLocked=="boolean"&&ks(p.locks.areViasLocked),typeof p.locks.arePadsLocked=="boolean"&&uo(p.locks.arePadsLocked),typeof p.locks.areTracesLocked=="boolean"&&ll(p.locks.areTracesLocked),typeof p.locks.areComponentsLocked=="boolean"&&ba(p.locks.areComponentsLocked),typeof p.locks.areGroundNodesLocked=="boolean"&&Ja(p.locks.areGroundNodesLocked),typeof p.locks.arePowerNodesLocked=="boolean"&&ho(p.locks.arePowerNodesLocked)),p.visibility&&(typeof p.visibility.showViasLayer=="boolean"&&Vr(p.visibility.showViasLayer),typeof p.visibility.showTopPadsLayer=="boolean"&&$r(p.visibility.showTopPadsLayer),typeof p.visibility.showBottomPadsLayer=="boolean"&&Yr(p.visibility.showBottomPadsLayer),typeof p.visibility.showTopTracesLayer=="boolean"&&Wr(p.visibility.showTopTracesLayer),typeof p.visibility.showBottomTracesLayer=="boolean"&&Ca(p.visibility.showBottomTracesLayer),typeof p.visibility.showTopComponents=="boolean"&&Ho(p.visibility.showTopComponents),typeof p.visibility.showBottomComponents=="boolean"&&ra(p.visibility.showBottomComponents),typeof p.visibility.showPowerLayer=="boolean"&&Xr(p.visibility.showPowerLayer),typeof p.visibility.showGroundLayer=="boolean"&&Ui(p.visibility.showGroundLayer),typeof p.visibility.showConnectionsLayer=="boolean"&&Li(p.visibility.showConnectionsLayer),typeof p.visibility.showTraceCornerDots=="boolean"&&Kr(p.visibility.showTraceCornerDots)),p.autoSave?(typeof p.autoSave.enabled=="boolean"&&Ta(p.autoSave.enabled),typeof p.autoSave.interval=="number"&&hl(p.autoSave.interval),typeof p.autoSave.baseName=="string"&&p.autoSave.baseName?(no(p.autoSave.baseName),uc.current=p.autoSave.baseName,p.autoSave.enabled&&!jl&&(console.log("Auto save: Directory handle not available after page reload (expected). Auto save disabled. Use File -> Auto Save -> Enable to re-enable."),Ta(!1),hl(null))):p.autoSave.enabled&&(console.warn("Auto save was enabled in project file but base name is missing. Disabling auto save."),Ta(!1),hl(null),no(""),uc.current="")):(Ta(!1),hl(null),Jl(null),no(""),Ul.current=null,uc.current="",Fi.current&&(clearInterval(Fi.current),Fi.current=null)),p.drawing?.drawingStrokes&&Array.isArray(p.drawing.drawingStrokes)){const ke=p.drawing.drawingStrokes.map(Ce=>({...Ce,points:Ce.points.map(ge=>({...ge,...is(ge)}))})).filter(Ce=>!(Ce.type==="trace"&&Ce.points.length<2));_t(ke);for(const Ce of ke)for(const ge of Ce.points)ge.id&&typeof ge.id=="number"&&sm(ge.id)}else console.warn("Project file missing drawingStrokes. Starting with empty strokes."),_t([]);if(p.drawing?.componentsTop){const ke=p.drawing.componentsTop.map(Ce=>{const ge=is({x:Ce.x,y:Ce.y});return{...Ce,x:ge.x,y:ge.y,layer:Ce.layer||"top",pinConnections:Ce.pinConnections||new Array(Ce.pinCount||0).fill("")}});Pi(ke)}if(p.drawing?.componentsBottom){const ke=p.drawing.componentsBottom.map(Ce=>{const ge=is({x:Ce.x,y:Ce.y});return{...Ce,x:ge.x,y:ge.y,layer:Ce.layer||"bottom",pinConnections:Ce.pinConnections||new Array(Ce.pinCount||0).fill("")}});Gn(ke)}if(p.designatorCounters&&typeof p.designatorCounters=="object"){const ke=p.designatorCounters;Hn.current={...ke}}else Hn.current={};if(typeof p.autoAssignDesignators=="boolean"&&Yn(p.autoAssignDesignators),typeof p.useGlobalDesignatorCounters=="boolean"?Rt(p.useGlobalDesignatorCounters):Rt(!1),p.drawing?.grounds){const Ce=p.drawing.grounds.map(ge=>{ge.pointId||console.warn("Ground symbol missing pointId - this may cause issues");const Se=is({x:ge.x,y:ge.y});return{...ge,x:Se.x,y:Se.y}}).filter(ge=>{const Se=typeof ge.x=="number"&&typeof ge.y=="number"&&!isNaN(ge.x)&&!isNaN(ge.y)&&isFinite(ge.x)&&isFinite(ge.y);return Se||console.warn(`Filtered out invalid ground symbol at (${ge.x}, ${ge.y})`),Se});rt(Ce);for(const ge of Ce)ge.pointId&&typeof ge.pointId=="number"&&sm(ge.pointId)}else rt([]);let V;if(p.powerBuses&&Array.isArray(p.powerBuses)&&p.powerBuses.length>0?(V=p.powerBuses,Ro(V)):(V=[{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}],Ro(V)),p.groundBuses&&Array.isArray(p.groundBuses)&&p.groundBuses.length>0?ee(p.groundBuses):ee([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),p.drawing?.powers){const Ce=p.drawing.powers.map(ge=>{ge.pointId||console.warn("Power symbol missing pointId - this may cause issues");const Se=is({x:ge.x,y:ge.y});return{...ge,x:Se.x,y:Se.y}}).filter(ge=>{const Se=typeof ge.x=="number"&&typeof ge.y=="number"&&!isNaN(ge.x)&&!isNaN(ge.y)&&isFinite(ge.x)&&isFinite(ge.y);return Se||console.warn(`Filtered out invalid power node at (${ge.x}, ${ge.y})`),Se});De(Ce);for(const ge of Ce)ge.pointId&&typeof ge.pointId=="number"&&sm(ge.pointId)}else De([]);let Ae=0;if(p.drawing?.drawingStrokes&&Array.isArray(p.drawing.drawingStrokes))for(const ke of p.drawing.drawingStrokes)for(const Ce of ke.points)Ce.id&&typeof Ce.id=="number"&&Ce.id>Ae&&(Ae=Ce.id);if(p.drawing?.componentsTop&&Array.isArray(p.drawing.componentsTop)){for(const ke of p.drawing.componentsTop)if(ke.pinConnections&&Array.isArray(ke.pinConnections)){for(const Ce of ke.pinConnections)if(Ce&&typeof Ce=="string"){const ge=parseInt(Ce,10);!isNaN(ge)&&ge>Ae&&(Ae=ge)}}}if(p.drawing?.componentsBottom&&Array.isArray(p.drawing.componentsBottom)){for(const ke of p.drawing.componentsBottom)if(ke.pinConnections&&Array.isArray(ke.pinConnections)){for(const Ce of ke.pinConnections)if(Ce&&typeof Ce=="string"){const ge=parseInt(Ce,10);!isNaN(ge)&&ge>Ae&&(Ae=ge)}}}if(p.drawing?.grounds&&Array.isArray(p.drawing.grounds))for(const ke of p.drawing.grounds)ke.pointId&&typeof ke.pointId=="number"&&ke.pointId>Ae&&(Ae=ke.pointId);if(p.drawing?.powers&&Array.isArray(p.drawing.powers))for(const ke of p.drawing.powers)ke.pointId&&typeof ke.pointId=="number"&&ke.pointId>Ae&&(Ae=ke.pointId);const fe=Ae+1,je=im();je<fe&&(console.warn(`pointIdCounter was ${je} but max existing ID is ${Ae}. Correcting to ${fe}.`),xg(fe)),ls.current=!1,to(!1),qr(!1),setTimeout(()=>{Ih.current=!1},100)}catch(L){console.error("Failed to open project",L),alert("Failed to open project file. See console for details."),Ih.current=!1}},[k,lt,ki,n,o,xg,Wi,ks,uo,ll,ba,Ja,ho,Vr,$r,Yr,Wr,Ca,Ho,ra,Xr,Ui,Li,Ta,hl,Jl,no,_t,Pi,Gn,rt,Ro,ee,De,Xc,is,a5,o5,rm,Yn,Rt,vi]),$o=K.useCallback(async()=>{},[Pl]),ur=K.useCallback(async p=>{const S=Ul.current;if(!S){console.warn("Cannot load file: no directory handle");return}try{const Q=await(await S.getFileHandle(p)).getFile();if(Q.size===0){console.warn(`File ${p} is empty, skipping`);const je=Wo.current.filter(ke=>ke!==p);fl(je),Wo.current=je;return}const oe=await Q.text();if(!oe||oe.trim().length===0){console.warn(`File ${p} contains no data, skipping`);const je=Wo.current.filter(ke=>ke!==p);fl(je),Wo.current=je;return}let he;try{he=JSON.parse(oe)}catch(fe){console.error(`Failed to parse JSON from file ${p}:`,fe);const ke=Wo.current.filter(Ce=>Ce!==p);fl(ke),Wo.current=ke,await $o();return}fd(),fi(1),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),Tn(new Set),Cn(new Set),tn(new Set),pn(new Set),Pc(),await gd(he),hs(p);const Ae=Wo.current.indexOf(p);Ae>=0?(Oo(Ae),Ud.current=Ae):await $o(),ls.current=!1,to(!1)}catch(L){console.error("Failed to load file from history:",L);const Q=Wo.current;if(Q.includes(p)){const oe=Q.filter(he=>he!==p);fl(oe),Wo.current=oe,await $o()}}},[gd,$o,Pc]),zf=K.useCallback(async p=>{if(!ki){console.warn("Cannot restore file: no project directory handle"),alert("No project directory available. Please open or create a project first.");return}try{let S;try{S=await ki.getDirectoryHandle("history")}catch(V){console.error("History directory not found:",V),alert("History directory not found.");return}const Q=await(await S.getFileHandle(p)).getFile();if(Q.size===0){alert(`File ${p} is empty.`);return}const oe=await Q.text();if(!oe||oe.trim().length===0){alert(`File ${p} contains no data.`);return}let he;try{he=JSON.parse(oe)}catch(V){console.error(`Failed to parse JSON from file ${p}:`,V),alert(`Failed to parse file ${p}. It may be corrupted.`);return}fd(),fi(1),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),Tn(new Set),Cn(new Set),tn(new Set),pn(new Set),Pc(),await gd(he),hs(p),ls.current=!1,console.log(`Successfully restored file: ${p}`)}catch(S){console.error("Failed to restore file from history:",S),alert(`Failed to restore file ${p}. Please try again.`)}},[ki,gd,Tn,Cn,tn,pn,hs,fi,fd,Pc]);Ct.useEffect(()=>{se&&!de&&me({x:window.innerWidth/2-300,y:window.innerHeight/2-250})},[se,de]);const Vp=K.useCallback(p=>{if(!de)return;Ie(!0);const S=p.clientX-de.x,L=p.clientY-de.y,Q=he=>{me({x:he.clientX-S,y:he.clientY-L})},oe=()=>{Ie(!1),document.removeEventListener("mousemove",Q),document.removeEventListener("mouseup",oe)};document.addEventListener("mousemove",Q),document.addEventListener("mouseup",oe)},[de]);K.useCallback(async()=>{const p=Ud.current,S=Wo.current;if(p>=0&&p<S.length-1){const L=p+1,Q=S[L];Q&&await ur(Q)}},[ur]),K.useCallback(async()=>{const p=Ud.current,S=Wo.current;if(p<=0||p>=S.length||S.length===0){console.warn("Cannot navigate to newer file: index is",p,"history length is",S.length);return}if(p>0&&p<S.length&&S.length>0){const L=p-1;if(L>=0&&L<S.length){const Q=S[L];Q?await ur(Q):(console.warn("No newer file found at index",L),await $o())}else console.warn("Cannot navigate to newer file: prevIndex",L,"is out of bounds")}},[ur,$o]),Ct.useEffect(()=>{An.current=zn},[zn]);const Qr=Ct.useRef(lt),If=Ct.useRef($t);Ct.useEffect(()=>{const p=lt!==Qr.current;if(k==="draw"&&Qr.current==="trace"&&p){if(An.current.length>=2){hn(ft,It,Yt,we,Fe);const S={id:`${Date.now()}-trace-autofinalize`,points:An.current,color:F,size:X,layer:If.current,type:"trace"};_t(L=>[...L,S]),If.current==="top"?Ya(L=>[...L,S.id]):jr(L=>[...L,S.id])}Nn([]),Jt(!1)}Qr.current=lt,If.current=$t},[lt,$t,k,F,X]);const Bf=Ct.useRef(k);Ct.useEffect(()=>{if(Bf.current==="draw"&&k!=="draw"&&lt==="trace"&&An.current.length>=2){const p={id:`${Date.now()}-trace-autofinalize`,points:An.current,color:F,size:X,layer:$t,type:"trace"};_t(S=>[...S,p]),$t==="top"?Ya(S=>[...S,p.id]):jr(S=>[...S,p.id]),Nn([]),Jt(!1)}Bf.current=k},[k,lt,F,X,$t]);const Of=Ct.useMemo(()=>Gw,[]);Ct.useEffect(()=>{uu()},[ft]),Ct.useEffect(()=>{uu()},[It,Yt,y,si]);const Dt=Pd>0,la=K.useCallback(async()=>{const p=window;if(typeof p.showOpenFilePicker=="function")try{const[S]=await p.showOpenFilePicker({multiple:!1}),L=await S.getFile();if(!L.name.toLowerCase().endsWith(".json")){alert("Please select a .json project file.");return}pu.current=!0,Od(),await new Promise(fe=>setTimeout(fe,0)),hs(L.name);const Q=await L.text(),oe=JSON.parse(Q);pu.current=!0;let he=null;try{if(typeof S.getParent=="function")he=await S.getParent();else{console.warn("getParent() not available. Prompting user for directory access...");const fe=window;if(typeof fe.showDirectoryPicker=="function")he=await fe.showDirectoryPicker({startIn:S});else throw new Error("Directory picker not available in this browser")}if(he)try{if((await(await he.getFileHandle(L.name)).getFile()).name!==L.name)throw new Error("Directory verification failed: file name mismatch")}catch(fe){throw console.error("Directory verification failed:",fe),console.error("The selected directory might not contain the opened file"),new Error("Directory verification failed - selected directory does not contain the opened file")}qs(he),Ao.current=he}catch(fe){console.error("Failed to get directory handle from file handle:",fe)}finally{setTimeout(()=>{pu.current=!1},1e3)}const V=oe.autoSave?.enabled===!0;await gd(oe,he);let Ae;if(oe.projectInfo?.name?Ae=oe.projectInfo.name:(Ae=L.name.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_")||"pcb_project",za(Ae)),Vs||za(Ae),V&&he){const fe=Ae.replace(/\.json$/i,""),ke=Qu(fe).replace(/[^a-zA-Z0-9_-]/g,"_");Jl(he),no(ke),Ul.current=he,uc.current=ke,Fi.current&&(clearInterval(Fi.current),Fi.current=null)}setTimeout(()=>{nr({visible:!0,source:"open",interval:5})},100)}catch(S){if(S?.name==="AbortError")return;console.warn("showOpenFilePicker failed, falling back to input",S),Ia.current?.click()}else Ia.current?.click()},[gd,Vs,hs,za,qs,nr,rr,Jl,no,Od]),hc=K.useCallback(async()=>{Da({visible:!1}),await pd(),await la()},[pd,la]),Wp=K.useCallback(async()=>{Da({visible:!1}),await la()},[la]),$p=K.useCallback(()=>{Da({visible:!1})},[]);Ct.useEffect(()=>{if(Mo.visible){setTimeout(()=>{ji.current?.focus()},0);const p=S=>{S.key==="Enter"?(S.preventDefault(),hc()):S.key==="Escape"&&(S.preventDefault(),Da({visible:!1}))};return window.addEventListener("keydown",p),()=>{window.removeEventListener("keydown",p)}}},[Mo.visible,hc]);const Gp=K.useCallback(async()=>{Rc()?Da({visible:!0}):await la()},[Rc,la]);return l.jsxs("div",{className:"app",children:[l.jsx("header",{className:"app-header",children:l.jsx("h1",{children:" PCB Tracer (v2.8)"})}),l.jsx(h3,{openMenu:nd,setOpenMenu:Qa,isReadOnlyMode:Dt,currentProjectFilePath:Pl,isProjectActive:!!ki,autoSaveEnabled:rr,autoSaveInterval:kl,hasUnsavedChangesState:sd,onNewProject:mu,onOpenProject:Gp,onSaveProject:pd,onPrint:Rf,onExportBOM:Gs,bomExportFormat:$,setBomExportFormat:z,hasUnsavedChanges:Rc,setNewProjectDialog:ir,setAutoSaveDialog:Lo,topImage:t,bottomImage:s,setCurrentTool:j,resetImageTransform:Ph,areImagesLocked:Ni,setAreImagesLocked:Wi,onEnterBoardDimensions:()=>Wc(!0),fileInputTopRef:Ed,fileInputBottomRef:ia,openProjectRef:Ia,increaseSize:br,decreaseSize:oa,brushSize:X,drawingStrokes:ft,selectedIds:ti,selectedComponentIds:ln,selectedPowerIds:ri,selectedGroundIds:ai,componentsTop:It,componentsBottom:Yt,powers:Rn,grounds:y,powerNodeNames:oc,groundNodeNames:lc,setSetSizeDialog:Do,areViasLocked:Ei,setAreViasLocked:ks,arePadsLocked:as,setArePadsLocked:uo,areTestPointsLocked:Nr,setAreTestPointsLocked:ol,areTracesLocked:pr,setAreTracesLocked:ll,areComponentsLocked:Hs,setAreComponentsLocked:ba,areGroundNodesLocked:gr,setAreGroundNodesLocked:Ja,arePowerNodesLocked:oi,setArePowerNodesLocked:ho,showTraceCornerDots:Ms,setShowTraceCornerDots:Kr,setSelectedIds:Tn,setSelectedComponentIds:Cn,setSelectedPowerIds:tn,setSelectedGroundIds:pn,selectAllVias:Iu,selectAllTraces:bh,selectAllPads:Bu,selectAllComponents:jc,selectDisconnectedComponents:vh,selectAllComponentConnections:wh,selectAllPowerNodes:iu,selectAllGroundNodes:su,selectPowerNodesByName:Gc,selectGroundNodesByName:Sh,setShowPowerBusManager:R,setShowGroundBusManager:Tt,setShowPastMachine:ae,toolRegistry:Un,updateToolSettings:Ga,updateToolLayerSettings:Fs,setBrushSize:M,setBrushColor:I,saveToolSettings:Ab,saveToolLayerSettings:Qh,colorPalette:Of,currentTool:k,drawingMode:lt,traceToolLayer:$n,padToolLayer:xi,testPointToolLayer:En,componentToolLayer:pi,setTopTraceSize:ie,setBottomTraceSize:q,setTopPadSize:D,setBottomPadSize:Y,setTopTestPointSize:Ke,setBottomTestPointSize:st,setTopComponentSize:Lt,setBottomComponentSize:en,setComponentConnectionSize:Zn,topTraceColor:G,bottomTraceColor:_,topPadColor:J,bottomPadColor:_e,topTestPointColor:ue,bottomTestPointColor:Pe,topComponentColor:yt,bottomComponentColor:pe,setTopTraceColor:U,setBottomTraceColor:N,setTopPadColor:ce,setBottomPadColor:xe,setTopTestPointColor:Ne,setBottomTestPointColor:Ue,setTopComponentColor:Nt,setBottomComponentColor:St,setComponentConnectionColor:wn,saveDefaultSize:Pt,saveDefaultColor:Mt,menuBarRef:bo,onOpenProjectNotes:Pf,onOpenTransformImages:()=>Pr(!0),onOpenTransformAll:()=>Io(!0)}),l.jsx("div",{style:{display:"block",padding:0,margin:0,width:"100vw",height:"calc(100vh - 70px)",boxSizing:"border-box",position:"relative"},children:l.jsxs("div",{ref:qc,style:{position:"relative",width:"100%",height:"100%",margin:0,padding:0,boxSizing:"border-box",background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",borderRadius:"16px",overflow:"hidden"},children:[l.jsxs("div",{style:{position:"absolute",top:6,left:6,bottom:6,width:46,display:"flex",flexDirection:"column",gap:8,padding:"6px 3px",background:"rgba(250,250,255,0.95)",borderRadius:8,border:"1px solid #ddd",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:20},children:[l.jsxs("button",{onClick:()=>{Dt||hu()},onMouseDown:p=>p.currentTarget.blur(),disabled:Dt,title:"Select (S)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="select"?"2px solid #000":"1px solid #ddd",background:k==="select"?"#e6f0ff":"#fff",color:Dt?"#999":"#222",outline:"none",cursor:Dt?"not-allowed":"pointer",opacity:Dt?.5:1},children:[l.jsx(qw,{size:14}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[l.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"S"}),l.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),l.jsxs("button",{onMouseDown:p=>{if(p.altKey&&!Dt){p.preventDefault(),p.stopPropagation(),Vc(!1),Il(!0);return}},onClick:p=>{!Dt&&!p.altKey&&(console.log("Via tool clicked"),et(),Qt("via"),j("draw"),Vr(!0))},disabled:Dt,title:"Draw Vias (V), Option+click for Pattern Placement",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="draw"&&lt==="via"?"2px solid #000":"1px solid #ddd",background:k==="draw"&&lt==="via"?"#e6f0ff":"#fff",color:Dt?"#999":"#222",cursor:Dt?"not-allowed":"pointer",opacity:Dt?.5:1},children:[l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const p=Ln.get("via").color;return l.jsxs(l.Fragment,{children:[l.jsx("circle",{cx:"12",cy:"12",r:"8",fill:"none",stroke:p,strokeWidth:"3"}),l.jsx("circle",{cx:"12",cy:"12",r:"4",fill:p})]})})()}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[l.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"V"}),l.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:Ln.get("via").size})]})]}),l.jsxs("button",{ref:jh,onMouseDown:p=>{if(p.altKey&&!Dt){p.preventDefault(),p.stopPropagation(),Vc(!0),Il(!0);return}},onClick:p=>{!Dt&&!p.altKey&&(console.log("Pad tool clicked"),et(),Qt("pad"),j("draw"),setTimeout(()=>Ku(),0))},disabled:Dt,title:"Draw Pads (P), Option+click for Pattern Placement",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="draw"&&lt==="pad"?"2px solid #000":"1px solid #ddd",background:k==="draw"&&lt==="pad"?"#e6f0ff":"#fff",color:Dt?"#999":"#222",cursor:Dt?"not-allowed":"pointer",opacity:Dt?.5:1},children:[l.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const S=xi==="top"?"padTop":"padBottom",L=Ln.get(S).color,Q=14,oe=(24-Q)/2,he=(24-Q)/2;return l.jsx("rect",{x:oe,y:he,width:Q,height:Q,fill:L})})()}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[l.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"P"}),l.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{if(k==="draw"&&lt==="pad"&&ss.toolInstanceId&&(ss.toolInstanceId==="padTop"||ss.toolInstanceId==="padBottom"))return ss.size;const p=xi==="top"?"padTop":"padBottom";return Ln.get(p).size})()})]})]}),l.jsxs("button",{ref:qu,onClick:()=>{Dt||(console.log("Test Point tool clicked"),et(),Qt("testPoint"),j("draw"),setTimeout(()=>Eh(),0))},disabled:Dt,title:"Draw Test Points (Y)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="draw"&&lt==="testPoint"?"2px solid #000":"1px solid #ddd",background:k==="draw"&&lt==="testPoint"?"#e6f0ff":"#fff",color:Dt?"#999":"#222",cursor:Dt?"not-allowed":"pointer",opacity:Dt?.5:1},children:[l.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const S=En==="top"?"testPointTop":"testPointBottom",L=Ln.get(S).color,Q=14,oe=12,he=12;return l.jsx("path",{d:`M ${oe} ${he-Q/2} L ${oe+Q/2} ${he} L ${oe} ${he+Q/2} L ${oe-Q/2} ${he} Z`,fill:L,stroke:"#000",strokeWidth:"1.5"})})()}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[l.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"Y"}),l.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{if(k==="draw"&&lt==="testPoint"&&ss.toolInstanceId&&(ss.toolInstanceId==="testPointTop"||ss.toolInstanceId==="testPointBottom"))return ss.size;const p=En==="top"?"testPointTop":"testPointBottom";return Ln.get(p).size})()})]})]}),l.jsxs("button",{ref:kh,onClick:()=>{Dt||(console.log("Trace tool clicked"),et(),Qt("trace"),j("draw"),setTimeout(()=>fu(),0))},disabled:Dt,title:"Draw Traces (T)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="draw"&&lt==="trace"?"2px solid #000":"1px solid #ddd",background:k==="draw"&&lt==="trace"?"#e6f0ff":"#fff",color:Dt?"#999":"#222",cursor:Dt?"not-allowed":"pointer",opacity:Dt?.5:1},children:[l.jsx(Ww,{size:14,color:(()=>{const S=$n==="top"?"traceTop":"traceBottom";return Ln.get(S).color})()}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[l.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"T"}),l.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{const p=$n==="top"?"traceTop":"traceBottom";return Ln.get(p).size})()})]})]}),l.jsxs("button",{ref:Vu,onClick:()=>{Dt||(console.log("Component tool clicked"),et(),j("component"))},disabled:Dt,title:"Draw Component (C)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="component"?"2px solid #000":"1px solid #ddd",background:k==="component"?"#e6f0ff":"#fff",color:Dt?"#999":"#222",cursor:Dt?"not-allowed":"pointer",opacity:Dt?.5:1},children:[(()=>{const S=(pi||"top")==="top"?"componentTop":"componentBottom",L=Ln.get(S).color;return cc?l.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[l.jsx("rect",{x:"4",y:"4",width:"16",height:"16",fill:"rgba(255,255,255,0.9)",stroke:L,strokeWidth:"1.5"}),l.jsx("text",{x:"12",y:"14",textAnchor:"middle",fontSize:"7",fill:L,fontWeight:"bold",fontFamily:"monospace",children:(()=>{const Q=Yc?.componentDefinition?.designator??Yc?.designator;return Q?Q.length<=3?Q:Q.substring(0,3):jm(cc)})()})]}):l.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[l.jsx("rect",{x:"5",y:"3",width:"14",height:"7",fill:L,stroke:L,strokeWidth:"0.5"}),l.jsxs("g",{stroke:L,fill:"none",strokeWidth:"1.5",children:[l.jsx("rect",{x:"5",y:"10",width:"14",height:"4",rx:"1.2"}),l.jsx("path",{d:"M7 14 v4 M10 14 v4 M13 14 v4 M16 14 v4",stroke:L})]})]})})(),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[l.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"C"}),l.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{const p=pi==="top"?"componentTop":"componentBottom";return Ln.get(p).size})()})]})]}),l.jsxs("button",{ref:Wu,onClick:()=>{Dt||(console.log("Power tool clicked"),et(),rn(!1),gn.length===1?($e(gn[0].id),j("power"),ve(!1),Xr(!0)):gn.length>1?ve(!0):(ve(!0),j("power"),Xr(!0)))},disabled:Dt,title:"Draw Power (B)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="power"?"2px solid #000":"1px solid #ddd",background:k==="power"?"#e6f0ff":"#fff",color:Dt?"#999":"#222",cursor:Dt?"not-allowed":"pointer",opacity:Dt?.5:1},children:[l.jsx("span",{style:{color:(Be?gn.find(p=>p.id===Be)?.color:null)||"#ff0000",fontSize:"18px",fontWeight:"bold",lineHeight:1,flexShrink:0},children:"V"}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[l.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"B"}),l.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:Ln.get("power").size})]})]}),l.jsxs("button",{ref:du,onClick:()=>{Dt||(console.log("Ground tool clicked"),ve(!1),P.length===1?(ni(P[0].id),j("ground"),rn(!1),Ui(!0)):P.length>1?rn(!0):(rn(!0),j("ground"),Ui(!0)))},disabled:Dt,title:"Draw Ground (G)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="ground"?"2px solid #000":"1px solid #ddd",background:k==="ground"?"#e6f0ff":"#fff",color:Dt?"#999":"#222",cursor:Dt?"not-allowed":"pointer",opacity:Dt?.5:1},children:[l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 20","aria-hidden":"true",style:{overflow:"visible",flexShrink:0},children:l.jsxs("g",{stroke:(Bt?P.find(p=>p.id===Bt)?.color:null)||"#000000",strokeWidth:"2",strokeLinecap:"round",children:[l.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"10"}),l.jsx("line",{x1:"5",y1:"10",x2:"19",y2:"10"}),l.jsx("line",{x1:"7",y1:"13",x2:"17",y2:"13"}),l.jsx("line",{x1:"9.5",y1:"16",x2:"14.5",y2:"16"})]})}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[l.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"G"}),l.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:Ln.get("ground").size})]})]}),l.jsx("div",{style:{height:72}}),l.jsxs("button",{onClick:()=>{Dt||(et(),j(p=>p==="pan"?"draw":"pan"))},disabled:Dt,title:"Move (H)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:6,padding:"4px 6px",borderRadius:6,border:k==="pan"?"2px solid #000":"1px solid #ddd",background:k==="pan"?"#e6f0ff":"#fff",color:Dt?"#999":"#222",cursor:Dt?"not-allowed":"pointer",opacity:Dt?.5:1},children:[l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:l.jsxs("g",{stroke:"#111",fill:"none",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round",children:[l.jsx("path",{d:"M8 11v-4c0-.8.6-1.3 1.3-1.3S11 6.2 11 7v4"}),l.jsx("path",{d:"M11 11V6.5c0-.8.6-1.3 1.3-1.3S14 5.7 14 6.5V11"}),l.jsx("path",{d:"M14 11V7.2c0-.8.6-1.3 1.3-1.3.7 0 1.3.5 1.3 1.3V12c1 .6 1.6 1.5 1.6 2.7A4.3 4.3 0 0 1 14 19H9.2A4.2 4.2 0 0 1 5 14.8V11c0-.6.4-1 .9-1 .6 0 1 .4 1 1v2"})]})}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[l.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"H"}),l.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),l.jsxs("button",{onClick:()=>{et(),tc(!1),j(p=>p==="magnify"?"draw":"magnify")},title:"Magnify (M)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="magnify"?"2px solid #000":"1px solid #ddd",background:k==="magnify"?"#e6f0ff":"#fff",color:"#222",cursor:"pointer"},children:[l.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[l.jsx("circle",{cx:"10",cy:"10",r:"7.5",fill:"none",stroke:"#111",strokeWidth:"2"}),l.jsx("line",{x1:"15.5",y1:"15.5",x2:"21",y2:"21",stroke:"#111",strokeWidth:"2",strokeLinecap:"round"}),Ba?l.jsx("line",{x1:"6.5",y1:"10",x2:"13.5",y2:"10",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"}):l.jsxs(l.Fragment,{children:[l.jsx("line",{x1:"6.5",y1:"10",x2:"13.5",y2:"10",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"}),l.jsx("line",{x1:"10",y1:"6.5",x2:"10",y2:"13.5",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"})]})]}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[l.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"M"}),l.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),l.jsxs("button",{onClick:()=>{Dt||Io(!0)},disabled:Dt,title:"Change Perspective (E) - Open Change Perspective Dialog",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:dl?"2px solid #000":"1px solid #ddd",background:dl?"#e6f0ff":"#fff",color:Dt?"#999":"#222",cursor:Dt?"not-allowed":"pointer",opacity:Dt?.5:1},children:[l.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[l.jsx("ellipse",{cx:"12",cy:"12",rx:"9",ry:"6",fill:"none",stroke:"#111",strokeWidth:"2"}),l.jsx("circle",{cx:"12",cy:"12",r:"4",fill:"none",stroke:"#111",strokeWidth:"2"}),l.jsx("circle",{cx:"11",cy:"11",r:"1.5",fill:"#111",stroke:"none"})]}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[l.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"E"}),l.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),l.jsxs("button",{onClick:()=>{Dt||(et(),j("center"),ar(!0),Js.current&&clearTimeout(Js.current),Js.current=setTimeout(()=>{ar(!1),j("select"),ya(void 0)},2e3))},disabled:Dt,title:"Set View (X) - Press 0-9 to Set View",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="center"?"2px solid #000":"1px solid #ddd",background:k==="center"?"#e6f0ff":"#fff",color:Dt?"#999":"#222",cursor:Dt?"not-allowed":"pointer",opacity:Dt?.5:1},children:[l.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[l.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"10",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),l.jsx("line",{x1:"12",y1:"14",x2:"12",y2:"22",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),l.jsx("line",{x1:"2",y1:"12",x2:"10",y2:"12",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),l.jsx("line",{x1:"14",y1:"12",x2:"22",y2:"12",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"})]}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[l.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"X"}),l.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),l.jsxs("div",{style:{position:"relative"},children:[l.jsx("button",{onClick:()=>{Dt||La(p=>!p)},disabled:Dt,title:"Color Picker",style:{width:32,height:32,display:"grid",placeItems:"center",borderRadius:6,border:"1px solid #ddd",background:"#fff",cursor:Dt?"not-allowed":"pointer",opacity:Dt?.5:1},children:l.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 16 16","aria-hidden":"true",children:[l.jsx("rect",{x:"0",y:"0",width:"3.5",height:"3.5",fill:"#9E9E9E",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"4",y:"0",width:"3.5",height:"3.5",fill:"#0072B2",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"8",y:"0",width:"3.5",height:"3.5",fill:"#56B4E9",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"12",y:"0",width:"3.5",height:"3.5",fill:"#00BFC4",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"0",y:"4",width:"3.5",height:"3.5",fill:"#6A3D9A",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"4",y:"4",width:"3.5",height:"3.5",fill:"#2CA02C",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"8",y:"4",width:"3.5",height:"3.5",fill:"#7FC97F",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"12",y:"4",width:"3.5",height:"3.5",fill:"#FF7F0E",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"0",y:"8",width:"3.5",height:"3.5",fill:"#FFD700",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"4",y:"8",width:"3.5",height:"3.5",fill:"#FF6B6B",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"8",y:"8",width:"3.5",height:"3.5",fill:"#E74C3C",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"12",y:"8",width:"3.5",height:"3.5",fill:"#FFB6C1",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"0",y:"12",width:"3.5",height:"3.5",fill:"#DDA0DD",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"4",y:"12",width:"3.5",height:"3.5",fill:"#8B4513",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"8",y:"12",width:"3.5",height:"3.5",fill:"#A0522D",stroke:"#ccc",strokeWidth:"0.3"}),l.jsx("rect",{x:"12",y:"12",width:"3.5",height:"3.5",fill:"#FF4500",stroke:"#ccc",strokeWidth:"0.3"})]})}),id&&l.jsx("div",{ref:Ll,style:{position:"absolute",left:42,top:0,padding:8,background:"#fff",border:"1px solid #ddd",borderRadius:6,boxShadow:"0 8px 18px rgba(0,0,0,0.18)",zIndex:50},children:l.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(8, 22px)",gap:4},children:Of.map(p=>l.jsx("div",{onClick:()=>{I(p),La(!1);try{let L=null;k==="draw"&&lt==="via"?L="via":k==="draw"&&lt==="pad"?L=(xi||"top")==="bottom"?"padBottom":"padTop":k==="draw"&&lt==="testPoint"?L=(En||"top")==="bottom"?"testPointBottom":"testPointTop":k==="draw"&&lt==="trace"?L=($n||"top")==="bottom"?"traceBottom":"traceTop":k==="component"?L=(pi||"top")==="bottom"?"componentBottom":"componentTop":k==="power"?L="power":k==="ground"&&(L="ground"),L&&Ln.setColor(L,p)}catch(L){console.error("Error updating tool instance color:",L)}const S=il(Un);if(S)if(k==="draw"&&lt==="trace"){const L=$n||"top",oe=S.layerSettings.get(L)?.size||S.settings.size,he={color:p,size:oe};Fs(S.id,L,he),Qh(S.id),L==="top"?(U(p),Mt("trace",p,"top")):(N(p),Mt("trace",p,"bottom"))}else if(k==="draw"&&lt==="pad"){const L=xi||"top",oe=S.layerSettings.get(L)?.size||S.settings.size,he={color:p,size:oe};Fs(S.id,L,he),Qh(S.id),L==="top"?(ce(p),Mt("pad",p,"top")):(xe(p),Mt("pad",p,"bottom"))}else if(k==="draw"&&lt==="testPoint"){const L=En||"top",oe=S.layerSettings.get(L)?.size||S.settings.size,he={color:p,size:oe};Fs(S.id,L,he),Qh(S.id),L==="top"?(Ne(p),Mt("testPoint",p,"top")):(Ue(p),Mt("testPoint",p,"bottom"))}else if(k==="component"){const L=pi||"top",oe=S.layerSettings.get(L)?.size||S.settings.size,he={color:p,size:oe};Fs(S.id,L,he),Qh(S.id),L==="top"?(Nt(p),Mt("component",p,"top")):(St(p),Mt("component",p,"bottom"))}else{const L={...S.settings,color:p};Ga(S.id,L),Ab(S.id,p,S.settings.size),k==="draw"&&lt==="via"&&Mt("via",p)}Mt("brush",p),ti.size>0&&_t(L=>L.map(Q=>ti.has(Q.id)?(Q.type==="via"?(Mt("via",p),Fn(oe=>{const he=new Map(oe),V=he.get("via");return V&&he.set("via",{...V,settings:{...V.settings,color:p}}),he})):Q.type==="pad"?(Mt("pad",p),Fn(oe=>{const he=new Map(oe),V=he.get("pad");return V&&he.set("pad",{...V,settings:{...V.settings,color:p}}),he})):Q.type==="trace"&&Mt("trace",p,Q.layer),{...Q,color:p}):Q)),ln.size>0&&(Mt("component",p),Pi(L=>L.map(Q=>ln.has(Q.id)?{...Q,color:p}:Q)),Gn(L=>L.map(Q=>ln.has(Q.id)?{...Q,color:p}:Q))),ri.size>0&&De(L=>L.map(Q=>ri.has(Q.id)?{...Q,color:p}:Q)),ai.size>0&&rt(L=>L.map(Q=>ai.has(Q.id)?{...Q,color:p}:Q))},title:p,style:{width:22,height:22,backgroundColor:p,border:p===F?"2px solid #333":"1px solid #ccc",cursor:"pointer"}},p))})})]})]}),k==="draw"&&lt==="trace"&&Fl&&l.jsxs("div",{ref:ud,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[l.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[l.jsx("input",{type:"radio",name:"traceToolLayer",checked:$n==="top",onChange:()=>{console.log("Trace tool Top clicked"),Pa.current="top",Fr("top"),Gt("top"),I(G),M(te),Fn(p=>{const S=new Map(p),L=S.get("trace");return L&&S.set("trace",{...L,settings:{color:G,size:te}}),S}),zd(!1),or(!0),Wr(!0)}}),l.jsx("span",{children:"Top"})]}),l.jsxs("label",{className:"radio-label",children:[l.jsx("input",{type:"radio",name:"traceToolLayer",checked:$n==="bottom",onChange:()=>{console.log("Trace tool Bottom clicked"),Pa.current="bottom",Fr("bottom"),Gt("bottom"),I(_),M(re),Fn(p=>{const S=new Map(p),L=S.get("trace");return L&&S.set("trace",{...L,settings:{color:_,size:re}}),S}),zd(!1),mr(!0),Ca(!0)}}),l.jsx("span",{children:"Bottom"})]})]}),k==="draw"&&lt==="pad"&&Ah&&l.jsxs("div",{ref:ou,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[l.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[l.jsx("input",{type:"radio",name:"padToolLayer",checked:xi==="top",onChange:()=>{console.log("Pad tool Top clicked"),el.current="top",ga("top"),Gt("top");const p=Ln.get("padTop");I(p.color),M(p.size),Fn(S=>{const L=new Map(S),Q=L.get("pad");return Q&&L.set("pad",{...Q,settings:{color:p.color,size:p.size}}),L}),ru(!1),or(!0),$r(!0)}}),l.jsx("span",{children:"Top"})]}),l.jsxs("label",{className:"radio-label",children:[l.jsx("input",{type:"radio",name:"padToolLayer",checked:xi==="bottom",onChange:()=>{console.log("Pad tool Bottom clicked"),el.current="bottom",ga("bottom"),Gt("bottom");const p=Ln.get("padBottom");I(p.color),M(p.size),Fn(S=>{const L=new Map(S),Q=L.get("pad");return Q&&L.set("pad",{...Q,settings:{color:p.color,size:p.size}}),L}),ru(!1),mr(!0),Yr(!0)}}),l.jsx("span",{children:"Bottom"})]})]}),k==="draw"&&lt==="testPoint"&&Th&&l.jsxs("div",{ref:lu,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[l.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[l.jsx("input",{type:"radio",name:"testPointToolLayer",checked:En==="top",onChange:()=>{console.log("Test Point tool Top clicked"),tl.current="top",Qo("top"),Gt("top"),I(ue),M(Re),Fn(p=>{const S=new Map(p),L=S.get("testPoint");return L&&S.set("testPoint",{...L,settings:{color:ue,size:Re}}),S}),au(!1),or(!0),Uo(!0)}}),l.jsx("span",{children:"Top"})]}),l.jsxs("label",{className:"radio-label",children:[l.jsx("input",{type:"radio",name:"testPointToolLayer",checked:En==="bottom",onChange:()=>{console.log("Test Point tool Bottom clicked"),tl.current="bottom",Qo("bottom"),Gt("bottom"),I(Pe),M(Je),Fn(p=>{const S=new Map(p),L=S.get("testPoint");return L&&S.set("testPoint",{...L,settings:{color:Pe,size:Je}}),S}),au(!1),mr(!0),sc(!0)}}),l.jsx("span",{children:"Bottom"})]})]}),Ze&&l.jsxs("div",{ref:cu,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25,minWidth:"200px"},children:[l.jsx("div",{style:{marginBottom:"4px",fontWeight:600,fontSize:"12px",color:"#333"},children:"Select Power Bus:"}),gn.length===0?l.jsx("div",{style:{padding:"8px",color:"#666",fontSize:"12px"},children:"No power buses defined. Use Tools  Manage Power Buses to add one."}):[...gn].sort((p,S)=>{const L=he=>{const V=he.match(/([+-]?)(\d+\.?\d*)/);if(V){const Ae=V[1]||"+",fe=parseFloat(V[2]);return{absValue:Math.abs(fe),isNegative:Ae==="-",original:he}}return{absValue:1/0,isNegative:!1,original:he}},Q=L(p.voltage),oe=L(S.voltage);return Q.absValue!==oe.absValue?Q.absValue-oe.absValue:Q.isNegative!==oe.isNegative?Q.isNegative?-1:1:0}).map(p=>l.jsx("button",{onClick:S=>{S.preventDefault(),S.stopPropagation(),$e(p.id),k!=="power"&&(et(),j("power"),Xr(!0)),ve(!1)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#222"},children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[l.jsx("div",{style:{width:16,height:16,borderRadius:"50%",background:p.color,border:"1px solid #ccc"}}),l.jsxs("div",{children:[l.jsx("div",{style:{fontWeight:600,fontSize:"13px"},children:p.name}),l.jsx("div",{style:{fontSize:"11px",color:"#666"},children:p.voltage})]})]})},p.id)),l.jsx("div",{style:{height:1,background:"#ddd",margin:"4px 0"}}),l.jsx("button",{onClick:p=>{p.preventDefault(),p.stopPropagation(),ve(!1),R(!0)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"11px"},children:"Manage Power Buses"}),l.jsx("button",{onClick:p=>{p.preventDefault(),p.stopPropagation(),ve(!1),$e(null),j("select")},style:{display:"block",width:"100%",textAlign:"center",padding:"4px 6px",marginTop:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#666",fontSize:"11px"},children:"Cancel"})]}),qt&&l.jsxs("div",{ref:Fu,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25,minWidth:"200px"},children:[l.jsx("div",{style:{marginBottom:"4px",fontWeight:600,fontSize:"12px",color:"#333"},children:"Select Ground Bus:"}),P.length===0?l.jsx("div",{style:{padding:"8px",color:"#666",fontSize:"12px"},children:"No ground buses defined. Use Tools  Manage Ground Buses to add one."}):[...P].sort((p,S)=>p.name.localeCompare(S.name)).map(p=>{const S=p.id==="groundbus-earth",L=Bt===p.id;return l.jsx("button",{onClick:Q=>{Q.preventDefault(),Q.stopPropagation(),ni(p.id),k!=="ground"&&(et(),j("ground"),Ui(!0)),rn(!1)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:L?"#e0e0e0":"#f5f5f5",border:L?"2px solid #000":"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#222"},children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[l.jsx("div",{style:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:S?l.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",style:{display:"block"},children:[l.jsx("line",{x1:"10",y1:"2",x2:"10",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),l.jsx("line",{x1:"4",y1:"10",x2:"16",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),l.jsx("line",{x1:"5",y1:"12.5",x2:"15",y2:"12.5",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),l.jsx("line",{x1:"6",y1:"15",x2:"14",y2:"15",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"})]}):l.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",style:{display:"block"},children:[l.jsx("circle",{cx:"10",cy:"10",r:"6",fill:"none",stroke:"#000",strokeWidth:"2"}),l.jsx("line",{x1:"10",y1:"2",x2:"10",y2:"18",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),l.jsx("line",{x1:"2",y1:"10",x2:"18",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"})]})}),l.jsx("div",{children:l.jsx("div",{style:{fontWeight:600,fontSize:"13px"},children:p.name})})]})},p.id)}),l.jsx("div",{style:{height:1,background:"#ddd",margin:"4px 0"}}),l.jsx("button",{onClick:p=>{p.preventDefault(),p.stopPropagation(),rn(!1),Tt(!0)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"11px"},children:"Manage Ground Buses"}),l.jsx("button",{onClick:p=>{p.preventDefault(),p.stopPropagation(),rn(!1),ni(null),j("select")},style:{display:"block",width:"100%",textAlign:"center",padding:"4px 6px",marginTop:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#666",fontSize:"11px"},children:"Cancel"})]}),l.jsxs("div",{style:{position:"absolute",top:6,left:60,bottom:6,width:168,padding:6,display:"flex",flexDirection:"column",gap:2,background:"rgba(250,250,255,0.95)",borderRadius:8,border:"1px solid #ddd",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:3},children:[l.jsx("div",{style:{fontSize:11,fontWeight:700,color:"#333",marginBottom:2},children:"Layers"}),l.jsxs("div",{onClick:()=>Gt("top"),title:"Top layer",style:{cursor:"pointer",padding:2,borderRadius:4,border:Kt==="top"?"2px solid #0b5fff":"1px solid #ddd",background:"#fff"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:2},children:[l.jsx("div",{style:{fontSize:10,color:"#444",fontWeight:600},children:"Top Image"}),l.jsx("label",{className:"radio-label",style:{margin:0},children:l.jsx("input",{type:"checkbox",checked:Ls,onChange:p=>or(p.target.checked)})})]}),l.jsx("canvas",{ref:ic,width:60,height:40,style:{width:"60px",height:"40px"}})]}),l.jsxs("div",{onClick:()=>Gt("bottom"),title:"Bottom layer",style:{cursor:"pointer",padding:2,borderRadius:4,border:Kt==="bottom"?"2px solid #0b5fff":"1px solid #ddd",background:"#fff"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:2},children:[l.jsx("div",{style:{fontSize:10,color:"#444",fontWeight:600},children:"Bottom Image"}),l.jsx("label",{className:"radio-label",style:{margin:0},children:l.jsx("input",{type:"checkbox",checked:Ml,onChange:p=>mr(p.target.checked)})})]}),l.jsx("canvas",{ref:Qd,width:60,height:40,style:{width:"60px",height:"40px"}})]}),l.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),l.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",checked:lr,onChange:p=>Vr(p.target.checked)}),l.jsx("span",{children:"Vias"})]}),l.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),l.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",checked:js,onChange:p=>Wr(p.target.checked)}),l.jsx("span",{children:"Traces (Top)"})]}),l.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",checked:io,onChange:p=>Ho(p.target.checked)}),l.jsx("span",{children:"Components (Top)"})]}),l.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",checked:cr,onChange:p=>$r(p.target.checked)}),l.jsx("span",{children:"Pads (Top)"})]}),l.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",checked:fs,onChange:p=>Uo(p.target.checked)}),l.jsx("span",{children:"Test Points (Top)"})]}),l.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),l.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",checked:ys,onChange:p=>Ca(p.target.checked)}),l.jsx("span",{children:"Traces (Bottom)"})]}),l.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",checked:Di,onChange:p=>ra(p.target.checked)}),l.jsx("span",{children:"Components (Bottom)"})]}),l.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",checked:Gr,onChange:p=>Yr(p.target.checked)}),l.jsx("span",{children:"Pads (Bottom)"})]}),l.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",checked:vo,onChange:p=>sc(p.target.checked)}),l.jsx("span",{children:"Test Points (Bottom)"})]}),l.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),l.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",checked:_a,onChange:p=>Xr(p.target.checked)}),l.jsx("span",{children:"Power"})]}),l.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",checked:si,onChange:p=>Ui(p.target.checked)}),l.jsx("span",{children:"Ground"})]}),l.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",checked:Ts,onChange:p=>Li(p.target.checked)}),l.jsx("span",{children:"Connections"})]}),l.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),l.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",checked:lr&&cr&&Gr&&fs&&vo&&js&&ys&&io&&Di&&_a&&si&&Ts,onChange:p=>{const S=p.target.checked;Vr(S),$r(S),Yr(S),Uo(S),sc(S),Wr(S),Ca(S),Ho(S),ra(S),Xr(S),Ui(S),Li(S)}}),l.jsx("span",{style:{fontWeight:600,fontSize:11},children:"Select All Layers"})]}),l.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),l.jsxs("div",{style:{marginTop:6},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[l.jsxs("label",{style:{fontSize:10,color:"#333"},children:["Transparency: ",h,"%"]}),l.jsxs("label",{className:"radio-label",style:{margin:0},children:[l.jsx("input",{type:"checkbox",checked:m,onChange:p=>{const S=p.target.checked;S?(or(!0),mr(!0)):(f(50),j("select")),b(S)}}),l.jsx("span",{style:{marginLeft:6,fontSize:10},children:"Cycle"})]})]}),l.jsx("input",{type:"range",min:"0",max:"100",value:h,onChange:p=>f(Number(p.target.value)),onDoubleClick:()=>Ef("transparency"),className:"slider",style:{width:"100%",marginTop:3}}),m&&l.jsxs("div",{style:{marginTop:6},children:[l.jsxs("label",{style:{fontSize:10,color:"#333"},children:["Cycle Speed: ",(A/1e3).toFixed(1),"s"]}),l.jsx("input",{type:"range",min:"500",max:"8000",step:"100",value:8500-A,onChange:p=>v(8500-Number(p.target.value)),onDoubleClick:()=>v(2e3),className:"slider",style:{width:"100%",marginTop:3}})]})]})]}),l.jsx(f3,{visible:!t&&!s,canvasSize:Dl,canvasPosition:{left:244,top:6}}),l.jsx("canvas",{ref:rs,width:Dl.width,height:Dl.height,tabIndex:0,onMouseDown:Id,onMouseMove:Ip,onMouseUp:Nh,onMouseLeave:Nh,onWheel:Mp,onDoubleClick:zp,className:`pcb-canvas ${k==="transform"?"transform-cursor":k==="draw"?"draw-cursor":k==="erase"?"erase-cursor":"default-cursor"}`,style:{position:"absolute",left:"244px",top:"6px",...bc?{cursor:bc}:k==="pan"?{cursor:pl?"grabbing":"grab"}:{},width:`${Dl.width}px`,height:`${Dl.height}px`,maxHeight:"none",aspectRatio:"auto",border:"none"}}),Ma&&l.jsxs("div",{style:{position:"absolute",left:`${244+Dl.width-120}px`,top:`${6+Dl.height+4}px`,fontSize:"11px",fontFamily:"monospace",color:"#333",backgroundColor:"rgba(255, 255, 255, 0.9)",padding:"2px 6px",borderRadius:"3px",border:"1px solid #ccc",pointerEvents:"none",zIndex:1e3},children:["(",Ma.x.toFixed(1),"mm, ",Ma.y.toFixed(1),"mm)"]}),l.jsx(vC,{componentEditor:Ur,setComponentEditor:Ka,componentsTop:It,componentsBottom:Yt,setComponentsTop:Pi,setComponentsBottom:Gn,connectingPin:Zs,setConnectingPin:rl,componentDialogPosition:Ra,setComponentDialogPosition:Za,isDraggingDialog:al,setIsDraggingDialog:vc,dialogDragOffset:Kl,setDialogDragOffset:Tl,areComponentsLocked:Hs,setSelectedComponentIds:Cn,setNotesDialogVisible:gi,componentDefinition:Ur?(()=>{const p=It.find(S=>S.id===Ur.id)||Yt.find(S=>S.id===Ur.id);return p?_d(p):void 0})():void 0}),Rr&&Oa&&(()=>{const p=Rr.component,S=Rr.layer;if(!p)return null;const L=p.componentType||"Component",Q=p.componentType==="IntegratedCircuit"&&"icType"in p?p.icType:null,oe=dd(p),he=_d(p),V=he?.category==="Semiconductors",Ae=p?.pinNames,fe=he?.properties?.pinNames,je=8,ke=8,Ce=200,ge=150,Se=10;let be=Rr.x+je,ye=Rr.y+ke;return be+Ce+Se>window.innerWidth&&(be=Rr.x-Ce-je),ye+ge+Se>window.innerHeight&&(ye=Rr.y-ge-ke),be=Math.max(Se,Math.min(be,window.innerWidth-Ce-Se)),ye=Math.max(Se,Math.min(ye,window.innerHeight-ge-Se)),l.jsxs("div",{style:{position:"fixed",left:`${be}px`,top:`${ye}px`,background:"rgba(0, 0, 0, 0.85)",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:"12px",lineHeight:"1.4",zIndex:1e4,pointerEvents:"none",width:"max-content",maxWidth:"400px",minWidth:"150px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)",wordWrap:"break-word",overflowWrap:"break-word"},children:[l.jsx("div",{style:{fontWeight:600,marginBottom:"4px"},children:yc(L)}),l.jsxs("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:["Layer: ",S==="top"?"Top":"Bottom"]}),Q&&l.jsxs("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:["IC Type: ",Q]}),oe.length>0&&l.jsx("div",{style:{marginBottom:"4px"},children:oe.map((Le,Ee)=>l.jsx("div",{style:{color:"#e0e0e0",fontSize:"11px",marginBottom:"2px"},children:Le},Ee))}),p.description&&l.jsx("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:p.description}),p.notes&&l.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid rgba(255,255,255,0.2)",fontSize:"11px",color:"#d0d0d0",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:p.notes}),V&&p.pinCount>0&&(()=>{const Le=Array.from({length:p.pinCount},(Ee,qe)=>{const ct=p.pinConnections&&p.pinConnections.length>qe?p.pinConnections[qe]:"",ht=Ae&&qe<Ae.length?Ae[qe]:"",wt=fe&&qe<fe.length?fe[qe]:"",it=wt==="CHIP_DEPENDENT",zt=ht&&ht.trim()!==""?ht:it?"":wt;return{pin:qe+1,name:zt||"-",nodeId:ct||"-"}});return l.jsxs("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid rgba(255,255,255,0.2)"},children:[l.jsx("div",{style:{fontSize:"11px",fontWeight:600,marginBottom:"4px",color:"#fff"},children:"Pin Connections:"}),l.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px"},children:[l.jsx("thead",{children:l.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.3)"},children:[l.jsx("th",{style:{textAlign:"left",padding:"2px 6px",fontWeight:600,color:"#fff"},children:"Pin"}),l.jsx("th",{style:{textAlign:"left",padding:"2px 6px",fontWeight:600,color:"#fff"},children:"Name"}),l.jsx("th",{style:{textAlign:"left",padding:"2px 6px",fontWeight:600,color:"#fff"},children:"Node ID"})]})}),l.jsx("tbody",{children:Le.map((Ee,qe)=>l.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[l.jsx("td",{style:{padding:"2px 6px",color:"#e0e0e0",fontFamily:"monospace"},children:Ee.pin}),l.jsx("td",{style:{padding:"2px 6px",color:"#e0e0e0",fontStyle:Ee.name!=="-"?"italic":"normal"},children:Ee.name}),l.jsx("td",{style:{padding:"2px 6px",color:"#e0e0e0",fontFamily:"monospace"},children:Ee.nodeId})]},qe))})]})]})})()]})})(),od&&Oa&&(()=>{const p=od.stroke;return p.notes?l.jsxs("div",{style:{position:"fixed",left:`${od.x+10}px`,top:`${od.y+10}px`,background:"rgba(0, 0, 0, 0.85)",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:"12px",lineHeight:"1.4",zIndex:1e4,pointerEvents:"none",width:"max-content",maxWidth:"400px",minWidth:"150px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)",wordWrap:"break-word",overflowWrap:"break-word"},children:[l.jsx("div",{style:{fontWeight:600,marginBottom:"4px"},children:"Test Point"}),l.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid rgba(255,255,255,0.2)",fontSize:"11px",color:"#d0d0d0",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:p.notes})]}):null})(),mt&&mt.visible&&(()=>{if(!Rn.find(L=>L.id===mt.id))return null;const S=gn.find(L=>L.id===mt.powerBusId);return l.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#fff",border:"1px solid #0b5fff",borderRadius:4,padding:"6px",boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"175px",maxWidth:"250px",maxHeight:"40vh",overflowY:"auto",pointerEvents:"auto"},children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"5px"},children:[l.jsx("h3",{style:{margin:0,fontSize:"12px",color:"#333",fontWeight:600},children:"Power Properties"}),l.jsx("button",{onClick:()=>Vt(null),style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#666",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[l.jsxs("div",{children:[l.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Power Bus:"}),l.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:S?`${S.name} (${S.voltage})`:"Unknown"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:`power-layer-${mt.id}`,style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Layer:"}),l.jsxs("select",{id:`power-layer-${mt.id}`,name:`power-layer-${mt.id}`,value:mt.layer,onChange:L=>Vt({...mt,layer:L.target.value}),disabled:oi,style:{width:"100%",padding:"2px 3px",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",opacity:oi?.6:1},children:[l.jsx("option",{value:"top",children:"Top"}),l.jsx("option",{value:"bottom",children:"Bottom"})]})]}),l.jsxs("div",{children:[l.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"X:"}),l.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:mt.x.toFixed(2)})]}),l.jsxs("div",{children:[l.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Y:"}),l.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:mt.y.toFixed(2)})]})]}),l.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"3px",marginTop:"6px"},children:[l.jsx("button",{onClick:()=>Vt(null),style:{padding:"2px 5px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,cursor:"pointer",fontSize:"10px",color:"#333"},children:"Cancel"}),l.jsx("button",{onClick:()=>{oi||(De(L=>L.map(Q=>Q.id===mt.id?{...Q,layer:mt.layer}:Q)),Vt(null))},disabled:oi,style:{padding:"2px 5px",background:oi?"#f5f5f5":"#0b5fff",color:oi?"#999":"#fff",border:"1px solid #ddd",borderRadius:2,cursor:oi?"not-allowed":"pointer",fontSize:"10px"},children:"Save"})]})]})})(),!t&&!s&&l.jsx("div",{className:"placeholder"})]})}),l.jsx(_C,{visible:T,onClose:()=>R(!1),powerBuses:gn,setPowerBuses:Ro,editingPowerBusId:O,setEditingPowerBusId:ne,powers:Rn}),l.jsx(kC,{visible:gt,onClose:()=>Tt(!1),groundBuses:P,setGroundBuses:ee,editingGroundBusId:bt,setEditingGroundBusId:sn,grounds:y}),l.jsx(RC,{visible:se,projectDirHandle:ki,onClose:()=>{ae(!1),me(void 0)},onRestore:zf,position:de,isDragging:Te,onDragStart:Vp}),l.jsx(jC,{visible:Ws,onClose:()=>Pn(!1),autoAssignDesignators:ts,setAutoAssignDesignators:Yn,useGlobalDesignatorCounters:Ht,setUseGlobalDesignatorCounters:Rt}),l.jsx("input",{ref:Ed,type:"file",accept:".png,.jpg,.jpeg,image/png,image/jpeg",style:{display:"none"},onChange:p=>{const S=p.target.files?.[0];S&&kf(S,"top"),p.target.value=""}}),l.jsx("input",{ref:ia,type:"file",accept:".png,.jpg,.jpeg,image/png,image/jpeg",style:{display:"none"},onChange:p=>{const S=p.target.files?.[0];S&&kf(S,"bottom"),p.target.value=""}}),l.jsx("input",{ref:Ia,type:"file",accept:".json,application/json",style:{display:"none"},onChange:async p=>{const S=p.target.files?.[0];if(S)try{hs(S.name);const L=await S.text(),Q=JSON.parse(L);await gd(Q);let oe;Q.projectInfo?.name?oe=Q.projectInfo.name:(oe=S.name.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_")||"pcb_project",za(oe)),Vs||za(oe),setTimeout(()=>{nr({visible:!0,source:"open",interval:5})},100)}catch(L){console.error("Failed to open project",L),alert("Failed to open project file. See console for details.")}p.target.value=""}}),l.jsx(g3,{visible:eo.visible,selectedIds:ti,selectedComponentIds:ln,selectedPowerIds:ri,selectedGroundIds:ai,drawingStrokes:ft,componentsTop:It,componentsBottom:Yt,powers:Rn,grounds:y,powerBuses:gn,onClose:()=>{cl({visible:!1,text:""})},setComponentsTop:Pi,setComponentsBottom:Gn,determineViaType:So,determinePadType:Jr,determineTestPointType:ml,onFindComponent:$c,onFindStroke:nu,onFindPower:Md,onFindGround:Ol,onOpenNotesDialog:()=>gi(!0),position:Gi,isDragging:Mi,onDragStart:p=>{Gi&&(yr({x:p.clientX-Gi.x,y:p.clientY-Gi.y}),zs(!0),p.preventDefault())}}),l.jsx(m3,{visible:Ns,selectedIds:ti,selectedComponentIds:ln,selectedPowerIds:ri,selectedGroundIds:ai,drawingStrokes:ft,componentsTop:It,componentsBottom:Yt,powers:Rn,grounds:y,powerBuses:gn,onClose:()=>{gi(!1)},setComponentsTop:Pi,setComponentsBottom:Gn,setDrawingStrokes:_t,setPowerSymbols:De,setGroundSymbols:rt,determineViaType:So,determinePadType:Jr,determineTestPointType:ml,position:Cs,isDragging:er,onDragStart:p=>{Cs&&(Ii({x:p.clientX-Cs.x,y:p.clientY-Cs.y}),dr(!0),p.preventDefault())}}),l.jsx(y3,{visible:bn,projectNotes:xr,setProjectNotes:_s,onClose:()=>{vn(!1)},position:Ai,isDragging:so,onDragStart:p=>{Ai?(zl({x:p.clientX-Ai.x,y:p.clientY-Ai.y}),aa(!0),p.preventDefault()):(Zr({x:p.clientX-300,y:p.clientY-200}),zl({x:300,y:200}),aa(!0),p.preventDefault())}}),l.jsx(Zb,{visible:wa.visible,title:"New Project",message:"You have unsaved changes. Do you want to save your project before creating a new one?",onYes:Ju,onNo:Mf,onCancel:Fh,yesButtonRef:As}),l.jsx(Zb,{visible:Mo.visible,title:"Open Project",message:"You have unsaved changes. Do you want to save your project before opening another one?",onYes:hc,onNo:Wp,onCancel:$p,yesButtonRef:ji}),_i.visible&&l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10002},onClick:p=>{p.target===p.currentTarget&&Hl()},children:l.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:p=>p.stopPropagation(),children:[l.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"New Project"}),l.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Project Name:"}),l.jsx("input",{ref:Fa,type:"text",value:_i.projectName,onChange:p=>{zo(S=>({...S,projectName:p.target.value}))},onKeyDown:p=>{p.key==="Enter"?(p.preventDefault(),yu()):p.key==="Escape"&&(p.preventDefault(),Hl())},style:{width:"100%",padding:"8px 12px",marginBottom:"8px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},placeholder:"e.g., my_pcb_project",autoFocus:!0}),_i.projectName&&(()=>{const p=_i.projectName.match(/[^a-zA-Z0-9_-]/g);if(p){const S=[...new Set(p)];return l.jsxs("div",{style:{marginBottom:"12px",padding:"6px 10px",background:"#3a1f1f",border:"1px solid #a44",borderRadius:4,fontSize:"12px",color:"#ffaaaa"},children:["Invalid characters: ",S.map(L=>`"${L}"`).join(", "),". Only letters, numbers, underscore (_), and hyphen (-) are allowed."]})}return null})(),l.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Location:"}),l.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[l.jsx("input",{type:"text",value:_i.locationPath||"Not selected",readOnly:!0,style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:_i.locationPath?"#f2f2f2":"#888",fontSize:"14px",cursor:"not-allowed"},placeholder:"Select a location..."}),l.jsx("button",{onClick:Hp,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500,whiteSpace:"nowrap"},children:"Browse..."})]}),_i.projectName&&_i.locationPath&&l.jsxs("div",{style:{marginBottom:"20px",padding:"8px 12px",background:"#1a1a1f",border:"1px solid #333",borderRadius:6,fontSize:"12px",color:"#aaa",fontFamily:"monospace"},children:[l.jsx("div",{style:{marginBottom:"4px",color:"#888"},children:"Project will be created at:"}),l.jsx("div",{style:{color:"#4CAF50"},children:(()=>{if(!_i.projectName||!_i.locationPath)return"";const S=_i.projectName.trim().replace(/[^a-zA-Z0-9_-]/g,"_")||"pcb_project",L=`${S}.json`;return _i.locationPath===S?`${_i.locationPath}/${L}`:`${_i.locationPath}/${S}/${L}`})()})]}),l.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[l.jsx("button",{onClick:Hl,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),l.jsx("button",{onClick:yu,disabled:!_i.projectName.trim()||!_i.locationHandle,style:{padding:"8px 16px",background:!_i.projectName.trim()||!_i.locationHandle?"#555":"#4CAF50",color:"#fff",border:"1px solid "+(!_i.projectName.trim()||!_i.locationHandle?"#666":"#45a049"),borderRadius:6,cursor:!_i.projectName.trim()||!_i.locationHandle?"not-allowed":"pointer",fontSize:"14px",fontWeight:600,opacity:!_i.projectName.trim()||!_i.locationHandle?.6:1},children:"Create"})]})]})}),os.visible&&l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10002},onClick:p=>{p.target===p.currentTarget&&Oh()},children:l.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:p=>p.stopPropagation(),children:[l.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Save As"}),l.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"File Name:"}),l.jsx("input",{ref:Qs,type:"text",value:os.filename,onChange:p=>{ws(S=>({...S,filename:p.target.value}))},onKeyDown:p=>{p.key==="Enter"?(p.preventDefault(),Bh()):p.key==="Escape"&&(p.preventDefault(),Oh())},style:{width:"100%",padding:"8px 12px",marginBottom:"8px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},placeholder:"e.g., my_project.json",autoFocus:!0}),l.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Location:"}),l.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[l.jsx("input",{type:"text",value:os.locationPath||"Not selected",readOnly:!0,style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:os.locationPath?"#f2f2f2":"#888",fontSize:"14px",cursor:"not-allowed"},placeholder:"Select a location..."}),l.jsx("button",{onClick:qp,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500,whiteSpace:"nowrap"},children:"Browse..."})]}),os.filename&&os.locationPath&&l.jsxs("div",{style:{marginBottom:"20px",padding:"8px 12px",background:"#1a1a1f",border:"1px solid #333",borderRadius:6,fontSize:"12px",color:"#aaa",fontFamily:"monospace"},children:[l.jsx("div",{style:{marginBottom:"4px",color:"#888"},children:"File will be saved at:"}),l.jsxs("div",{style:{color:"#4CAF50"},children:[os.locationPath,"/",os.filename.endsWith(".json")?os.filename:`${os.filename}.json`]})]}),l.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[l.jsx("button",{onClick:Oh,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),l.jsx("button",{onClick:Bh,disabled:!os.filename.trim()||!os.locationHandle,style:{padding:"8px 16px",background:!os.filename.trim()||!os.locationHandle?"#555":"#4CAF50",color:"#fff",border:"1px solid "+(!os.filename.trim()||!os.locationHandle?"#666":"#45a049"),borderRadius:6,cursor:!os.filename.trim()||!os.locationHandle?"not-allowed":"pointer",fontSize:"14px",fontWeight:600,opacity:!os.filename.trim()||!os.locationHandle?.6:1},children:"Save"})]})]})}),l.jsx(p3,{visible:fo.visible,title:fo.title,message:fo.message,onClose:()=>po({visible:!1,title:"",message:""})}),l.jsx(x3,{visible:cd,dimensions:Bl,onSave:p=>{ld(p)},onClose:()=>Wc(!1)}),l.jsx(b3,{visible:Cl,onClose:()=>{let p=0,S=0;t?(p=t.x,S=t.y):s&&(p=s.x,S=s.y),Rl(L=>({...L,0:{pcbReferenceX:p,pcbReferenceY:S,x:0,y:0,zoom:At,viewRotation:ei,viewFlipX:Ji,isBottomView:Sa,transparency:h,showTopImage:Ls,showBottomImage:Ml,showViasLayer:lr,showTopTracesLayer:js,showBottomTracesLayer:ys,showTopPadsLayer:cr,showBottomPadsLayer:Gr,showTopTestPointsLayer:fs,showBottomTestPointsLayer:vo,showTopComponents:io,showBottomComponents:Di,showPowerLayer:_a,showGroundLayer:si,showConnectionsLayer:Ts}})),Pr(!1)},topImage:t,bottomImage:s,selectedImageForTransform:Kt,setSelectedImageForTransform:Tr,transformMode:Or,setTransformMode:Na,updateImageTransform:jf,resetImageTransform:Ph,setCurrentTool:j,isGrayscale:E,setIsGrayscale:x,areImagesLocked:Ni}),l.jsx(v3,{visible:dl,onClose:()=>Io(!1),topImage:t,bottomImage:s,setTopImage:n,setBottomImage:o,componentsTop:It,componentsBottom:Yt,setComponentsTop:Pi,setComponentsBottom:Gn,drawingStrokes:ft,setDrawingStrokes:_t,powerSymbols:Rn,groundSymbols:y,setPowerSymbols:De,setGroundSymbols:rt,canvasRef:rs,isBottomView:Sa,setIsBottomView:qr,originalTopFlipX:Aa,setOriginalTopFlipX:go,originalBottomFlipX:$i,setOriginalBottomFlipX:Ri,originalTopFlipY:Ss,setOriginalTopFlipY:sr,originalBottomFlipY:_l,setOriginalBottomFlipY:ul,cameraWorldCenter:Ci,setCameraWorldCenter:Si,viewScale:At,viewRotation:ei,setViewRotation:vs,viewFlipX:Ji,setViewFlipX:Ds,contentBorder:5,setTransparency:f}),l.jsx(CC,{visible:Ep,selectedLayer:pi,selectedComponentType:cc,selectedComponentKey:f0,onLayerChange:p=>{ma(p),$a.current=p,Gt(p),I(p==="top"?yt:pe),M(p==="top"?Ut:at),p==="top"?(or(!0),Ho(!0)):(mr(!0),ra(!0))},onComponentTypeChange:(p,S,L)=>{Ch(p),Sf(S),Rp(L||null),Hu.current=p},onClose:()=>{Uu(!1),Xl(!0),j("select")}}),l.jsx(NC,{visible:Hr.visible,size:Hr.size,onSizeChange:p=>Do(S=>({...S,size:p})),onApply:Op,onCancel:()=>Do({visible:!1,size:6})}),l.jsx(PC,{visible:Sc.visible,interval:Sc.interval,onIntervalChange:p=>Lo({visible:!0,interval:p}),onApply:()=>Nf(Sc.interval,!1),onCancel:()=>Lo({visible:!1,interval:5})}),l.jsx(EC,{visible:va.visible,interval:va.interval,onIntervalChange:p=>nr({...va,interval:p}),onEnable:()=>Nf(va.interval,!0),onSkip:Fp}),l.jsx(DC,{visible:Cc,isPad:ps,onConfirm:p=>{Rd({numPins:p.numPins,type:p.type,twoSidedOrientation:p.twoSidedOrientation,point1:{x:0,y:0},point2:{x:0,y:0}}),xh(!0),j("select"),Il(!1)},onClose:()=>{Il(!1)}}),l.jsx("div",{style:{position:"fixed",bottom:8,right:8,zIndex:100},children:l.jsxs("button",{onClick:()=>{window.open("https://github.com/sponsors/pgiacalo","_blank","noopener,noreferrer")},style:{display:"flex",alignItems:"center",gap:6,padding:"6px 12px",background:"linear-gradient(180deg, #f6f8fa 0%, #ebecef 100%)",border:"1px solid rgba(27, 31, 36, 0.15)",borderRadius:6,cursor:"pointer",fontSize:12,fontWeight:500,color:"#24292f",boxShadow:"0 1px 0 rgba(27, 31, 36, 0.04)",transition:"background 0.2s"},onMouseEnter:p=>{p.currentTarget.style.background="linear-gradient(180deg, #f3f4f6 0%, #e5e6e9 100%)"},onMouseLeave:p=>{p.currentTarget.style.background="linear-gradient(180deg, #f6f8fa 0%, #ebecef 100%)"},title:"Donate to support this project",children:[l.jsx("svg",{height:"16",width:"16",viewBox:"0 0 16 16",fill:"#bf3989","aria-hidden":"true",children:l.jsx("path",{d:"M4.25 2.5c-1.336 0-2.75 1.164-2.75 3 0 2.15 1.58 4.144 3.365 5.682A20.565 20.565 0 008 13.393a20.561 20.561 0 003.135-2.211C12.92 9.644 14.5 7.65 14.5 5.5c0-1.836-1.414-3-2.75-3-1.373 0-2.609.986-3.029 2.456a.749.749 0 01-1.442 0C6.859 3.486 5.623 2.5 4.25 2.5z"})}),"Donate"]})})]})}zw.createRoot(document.getElementById("root")).render(l.jsx(K.StrictMode,{children:l.jsx(JC,{})}));export{Rs as _,e4 as c,_w as g};

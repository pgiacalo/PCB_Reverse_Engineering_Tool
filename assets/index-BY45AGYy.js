(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const d of l)if(d.type==="childList")for(const b of d.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&s(b)}).observe(document,{childList:!0,subtree:!0});function o(l){const d={};return l.integrity&&(d.integrity=l.integrity),l.referrerPolicy&&(d.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?d.credentials="include":l.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function s(l){if(l.ep)return;l.ep=!0;const d=o(l);fetch(l.href,d)}})();var Zw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qm(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var lg={exports:{}},$f={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g1;function e2(){if(g1)return $f;g1=1;var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function o(s,l,d){var b=null;if(d!==void 0&&(b=""+d),l.key!==void 0&&(b=""+l.key),"key"in l){d={};for(var p in l)p!=="key"&&(d[p]=l[p])}else d=l;return l=d.ref,{$$typeof:n,type:s,key:b,ref:l!==void 0?l:null,props:d}}return $f.Fragment=r,$f.jsx=o,$f.jsxs=o,$f}var y1;function t2(){return y1||(y1=1,lg.exports=e2()),lg.exports}var i=t2(),cg={exports:{}},bi={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var x1;function n2(){if(x1)return bi;x1=1;var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),d=Symbol.for("react.consumer"),b=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),v=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),M=Symbol.iterator;function T(q){return q===null||typeof q!="object"?null:(q=M&&q[M]||q["@@iterator"],typeof q=="function"?q:null)}var F={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},P=Object.assign,k={};function y(q,w,V){this.props=q,this.context=w,this.refs=k,this.updater=V||F}y.prototype.isReactComponent={},y.prototype.setState=function(q,w){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,w,"setState")},y.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function ae(){}ae.prototype=y.prototype;function E(q,w,V){this.props=q,this.context=w,this.refs=k,this.updater=V||F}var U=E.prototype=new ae;U.constructor=E,P(U,y.prototype),U.isPureReactComponent=!0;var ne=Array.isArray;function Z(){}var G={H:null,A:null,T:null,S:null},te=Object.prototype.hasOwnProperty;function O(q,w,V){var H=V.ref;return{$$typeof:n,type:q,key:w,ref:H!==void 0?H:null,props:V}}function W(q,w){return O(q.type,w,q.props)}function Y(q){return typeof q=="object"&&q!==null&&q.$$typeof===n}function D(q){var w={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(V){return w[V]})}var J=/\/+/g;function $(q,w){return typeof q=="object"&&q!==null&&q.key!=null?D(""+q.key):w.toString(36)}function je(q){switch(q.status){case"fulfilled":return q.value;case"rejected":throw q.reason;default:switch(typeof q.status=="string"?q.then(Z,Z):(q.status="pending",q.then(function(w){q.status==="pending"&&(q.status="fulfilled",q.value=w)},function(w){q.status==="pending"&&(q.status="rejected",q.reason=w)})),q.status){case"fulfilled":return q.value;case"rejected":throw q.reason}}throw q}function ee(q,w,V,H,ue){var ve=typeof q;(ve==="undefined"||ve==="boolean")&&(q=null);var se=!1;if(q===null)se=!0;else switch(ve){case"bigint":case"string":case"number":se=!0;break;case"object":switch(q.$$typeof){case n:case r:se=!0;break;case j:return se=q._init,ee(se(q._payload),w,V,H,ue)}}if(se)return ue=ue(q),se=H===""?"."+$(q,0):H,ne(ue)?(V="",se!=null&&(V=se.replace(J,"$&/")+"/"),ee(ue,w,V,"",function(De){return De})):ue!=null&&(Y(ue)&&(ue=W(ue,V+(ue.key==null||q&&q.key===ue.key?"":(""+ue.key).replace(J,"$&/")+"/")+se)),w.push(ue)),1;se=0;var ze=H===""?".":H+":";if(ne(q))for(var xe=0;xe<q.length;xe++)H=q[xe],ve=ze+$(H,xe),se+=ee(H,w,V,ve,ue);else if(xe=T(q),typeof xe=="function")for(q=xe.call(q),xe=0;!(H=q.next()).done;)H=H.value,ve=ze+$(H,xe++),se+=ee(H,w,V,ve,ue);else if(ve==="object"){if(typeof q.then=="function")return ee(je(q),w,V,H,ue);throw w=String(q),Error("Objects are not valid as a React child (found: "+(w==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":w)+"). If you meant to render a collection of children, use an array instead.")}return se}function de(q,w,V){if(q==null)return q;var H=[],ue=0;return ee(q,H,"","",function(ve){return w.call(V,ve,ue++)}),H}function Ne(q){if(q._status===-1){var w=q._result;w=w(),w.then(function(V){(q._status===0||q._status===-1)&&(q._status=1,q._result=V)},function(V){(q._status===0||q._status===-1)&&(q._status=2,q._result=V)}),q._status===-1&&(q._status=0,q._result=w)}if(q._status===1)return q._result.default;throw q._result}var Ie=typeof reportError=="function"?reportError:function(q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var w=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof q=="object"&&q!==null&&typeof q.message=="string"?String(q.message):String(q),error:q});if(!window.dispatchEvent(w))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",q);return}console.error(q)},$e={map:de,forEach:function(q,w,V){de(q,function(){w.apply(this,arguments)},V)},count:function(q){var w=0;return de(q,function(){w++}),w},toArray:function(q){return de(q,function(w){return w})||[]},only:function(q){if(!Y(q))throw Error("React.Children.only expected to receive a single React element child.");return q}};return bi.Activity=_,bi.Children=$e,bi.Component=y,bi.Fragment=o,bi.Profiler=l,bi.PureComponent=E,bi.StrictMode=s,bi.Suspense=v,bi.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=G,bi.__COMPILER_RUNTIME={__proto__:null,c:function(q){return G.H.useMemoCache(q)}},bi.cache=function(q){return function(){return q.apply(null,arguments)}},bi.cacheSignal=function(){return null},bi.cloneElement=function(q,w,V){if(q==null)throw Error("The argument must be a React element, but you passed "+q+".");var H=P({},q.props),ue=q.key;if(w!=null)for(ve in w.key!==void 0&&(ue=""+w.key),w)!te.call(w,ve)||ve==="key"||ve==="__self"||ve==="__source"||ve==="ref"&&w.ref===void 0||(H[ve]=w[ve]);var ve=arguments.length-2;if(ve===1)H.children=V;else if(1<ve){for(var se=Array(ve),ze=0;ze<ve;ze++)se[ze]=arguments[ze+2];H.children=se}return O(q.type,ue,H)},bi.createContext=function(q){return q={$$typeof:b,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null},q.Provider=q,q.Consumer={$$typeof:d,_context:q},q},bi.createElement=function(q,w,V){var H,ue={},ve=null;if(w!=null)for(H in w.key!==void 0&&(ve=""+w.key),w)te.call(w,H)&&H!=="key"&&H!=="__self"&&H!=="__source"&&(ue[H]=w[H]);var se=arguments.length-2;if(se===1)ue.children=V;else if(1<se){for(var ze=Array(se),xe=0;xe<se;xe++)ze[xe]=arguments[xe+2];ue.children=ze}if(q&&q.defaultProps)for(H in se=q.defaultProps,se)ue[H]===void 0&&(ue[H]=se[H]);return O(q,ve,ue)},bi.createRef=function(){return{current:null}},bi.forwardRef=function(q){return{$$typeof:p,render:q}},bi.isValidElement=Y,bi.lazy=function(q){return{$$typeof:j,_payload:{_status:-1,_result:q},_init:Ne}},bi.memo=function(q,w){return{$$typeof:m,type:q,compare:w===void 0?null:w}},bi.startTransition=function(q){var w=G.T,V={};G.T=V;try{var H=q(),ue=G.S;ue!==null&&ue(V,H),typeof H=="object"&&H!==null&&typeof H.then=="function"&&H.then(Z,Ie)}catch(ve){Ie(ve)}finally{w!==null&&V.types!==null&&(w.types=V.types),G.T=w}},bi.unstable_useCacheRefresh=function(){return G.H.useCacheRefresh()},bi.use=function(q){return G.H.use(q)},bi.useActionState=function(q,w,V){return G.H.useActionState(q,w,V)},bi.useCallback=function(q,w){return G.H.useCallback(q,w)},bi.useContext=function(q){return G.H.useContext(q)},bi.useDebugValue=function(){},bi.useDeferredValue=function(q,w){return G.H.useDeferredValue(q,w)},bi.useEffect=function(q,w){return G.H.useEffect(q,w)},bi.useEffectEvent=function(q){return G.H.useEffectEvent(q)},bi.useId=function(){return G.H.useId()},bi.useImperativeHandle=function(q,w,V){return G.H.useImperativeHandle(q,w,V)},bi.useInsertionEffect=function(q,w){return G.H.useInsertionEffect(q,w)},bi.useLayoutEffect=function(q,w){return G.H.useLayoutEffect(q,w)},bi.useMemo=function(q,w){return G.H.useMemo(q,w)},bi.useOptimistic=function(q,w){return G.H.useOptimistic(q,w)},bi.useReducer=function(q,w,V){return G.H.useReducer(q,w,V)},bi.useRef=function(q){return G.H.useRef(q)},bi.useState=function(q){return G.H.useState(q)},bi.useSyncExternalStore=function(q,w,V){return G.H.useSyncExternalStore(q,w,V)},bi.useTransition=function(){return G.H.useTransition()},bi.version="19.2.0",bi}var m1;function s0(){return m1||(m1=1,cg.exports=n2()),cg.exports}var I=s0();const At=Qm(I);var ug={exports:{}},Yf={},dg={exports:{}},fg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b1;function i2(){return b1||(b1=1,(function(n){function r(ee,de){var Ne=ee.length;ee.push(de);e:for(;0<Ne;){var Ie=Ne-1>>>1,$e=ee[Ie];if(0<l($e,de))ee[Ie]=de,ee[Ne]=$e,Ne=Ie;else break e}}function o(ee){return ee.length===0?null:ee[0]}function s(ee){if(ee.length===0)return null;var de=ee[0],Ne=ee.pop();if(Ne!==de){ee[0]=Ne;e:for(var Ie=0,$e=ee.length,q=$e>>>1;Ie<q;){var w=2*(Ie+1)-1,V=ee[w],H=w+1,ue=ee[H];if(0>l(V,Ne))H<$e&&0>l(ue,V)?(ee[Ie]=ue,ee[H]=Ne,Ie=H):(ee[Ie]=V,ee[w]=Ne,Ie=w);else if(H<$e&&0>l(ue,Ne))ee[Ie]=ue,ee[H]=Ne,Ie=H;else break e}}return de}function l(ee,de){var Ne=ee.sortIndex-de.sortIndex;return Ne!==0?Ne:ee.id-de.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var d=performance;n.unstable_now=function(){return d.now()}}else{var b=Date,p=b.now();n.unstable_now=function(){return b.now()-p}}var v=[],m=[],j=1,_=null,M=3,T=!1,F=!1,P=!1,k=!1,y=typeof setTimeout=="function"?setTimeout:null,ae=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function U(ee){for(var de=o(m);de!==null;){if(de.callback===null)s(m);else if(de.startTime<=ee)s(m),de.sortIndex=de.expirationTime,r(v,de);else break;de=o(m)}}function ne(ee){if(P=!1,U(ee),!F)if(o(v)!==null)F=!0,Z||(Z=!0,D());else{var de=o(m);de!==null&&je(ne,de.startTime-ee)}}var Z=!1,G=-1,te=5,O=-1;function W(){return k?!0:!(n.unstable_now()-O<te)}function Y(){if(k=!1,Z){var ee=n.unstable_now();O=ee;var de=!0;try{e:{F=!1,P&&(P=!1,ae(G),G=-1),T=!0;var Ne=M;try{t:{for(U(ee),_=o(v);_!==null&&!(_.expirationTime>ee&&W());){var Ie=_.callback;if(typeof Ie=="function"){_.callback=null,M=_.priorityLevel;var $e=Ie(_.expirationTime<=ee);if(ee=n.unstable_now(),typeof $e=="function"){_.callback=$e,U(ee),de=!0;break t}_===o(v)&&s(v),U(ee)}else s(v);_=o(v)}if(_!==null)de=!0;else{var q=o(m);q!==null&&je(ne,q.startTime-ee),de=!1}}break e}finally{_=null,M=Ne,T=!1}de=void 0}}finally{de?D():Z=!1}}}var D;if(typeof E=="function")D=function(){E(Y)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,$=J.port2;J.port1.onmessage=Y,D=function(){$.postMessage(null)}}else D=function(){y(Y,0)};function je(ee,de){G=y(function(){ee(n.unstable_now())},de)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ee){ee.callback=null},n.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):te=0<ee?Math.floor(1e3/ee):5},n.unstable_getCurrentPriorityLevel=function(){return M},n.unstable_next=function(ee){switch(M){case 1:case 2:case 3:var de=3;break;default:de=M}var Ne=M;M=de;try{return ee()}finally{M=Ne}},n.unstable_requestPaint=function(){k=!0},n.unstable_runWithPriority=function(ee,de){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var Ne=M;M=ee;try{return de()}finally{M=Ne}},n.unstable_scheduleCallback=function(ee,de,Ne){var Ie=n.unstable_now();switch(typeof Ne=="object"&&Ne!==null?(Ne=Ne.delay,Ne=typeof Ne=="number"&&0<Ne?Ie+Ne:Ie):Ne=Ie,ee){case 1:var $e=-1;break;case 2:$e=250;break;case 5:$e=1073741823;break;case 4:$e=1e4;break;default:$e=5e3}return $e=Ne+$e,ee={id:j++,callback:de,priorityLevel:ee,startTime:Ne,expirationTime:$e,sortIndex:-1},Ne>Ie?(ee.sortIndex=Ne,r(m,ee),o(v)===null&&ee===o(m)&&(P?(ae(G),G=-1):P=!0,je(ne,Ne-Ie))):(ee.sortIndex=$e,r(v,ee),F||T||(F=!0,Z||(Z=!0,D()))),ee},n.unstable_shouldYield=W,n.unstable_wrapCallback=function(ee){var de=M;return function(){var Ne=M;M=de;try{return ee.apply(this,arguments)}finally{M=Ne}}}})(fg)),fg}var v1;function r2(){return v1||(v1=1,dg.exports=i2()),dg.exports}var pg={exports:{}},Fs={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w1;function o2(){if(w1)return Fs;w1=1;var n=s0();function r(v){var m="https://react.dev/errors/"+v;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var j=2;j<arguments.length;j++)m+="&args[]="+encodeURIComponent(arguments[j])}return"Minified React error #"+v+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(){}var s={d:{f:o,r:function(){throw Error(r(522))},D:o,C:o,L:o,m:o,X:o,S:o,M:o},p:0,findDOMNode:null},l=Symbol.for("react.portal");function d(v,m,j){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:_==null?null:""+_,children:v,containerInfo:m,implementation:j}}var b=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(v,m){if(v==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Fs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Fs.createPortal=function(v,m){var j=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(r(299));return d(v,m,null,j)},Fs.flushSync=function(v){var m=b.T,j=s.p;try{if(b.T=null,s.p=2,v)return v()}finally{b.T=m,s.p=j,s.d.f()}},Fs.preconnect=function(v,m){typeof v=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,s.d.C(v,m))},Fs.prefetchDNS=function(v){typeof v=="string"&&s.d.D(v)},Fs.preinit=function(v,m){if(typeof v=="string"&&m&&typeof m.as=="string"){var j=m.as,_=p(j,m.crossOrigin),M=typeof m.integrity=="string"?m.integrity:void 0,T=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;j==="style"?s.d.S(v,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:_,integrity:M,fetchPriority:T}):j==="script"&&s.d.X(v,{crossOrigin:_,integrity:M,fetchPriority:T,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Fs.preinitModule=function(v,m){if(typeof v=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var j=p(m.as,m.crossOrigin);s.d.M(v,{crossOrigin:j,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&s.d.M(v)},Fs.preload=function(v,m){if(typeof v=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var j=m.as,_=p(j,m.crossOrigin);s.d.L(v,j,{crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Fs.preloadModule=function(v,m){if(typeof v=="string")if(m){var j=p(m.as,m.crossOrigin);s.d.m(v,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:j,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else s.d.m(v)},Fs.requestFormReset=function(v){s.d.r(v)},Fs.unstable_batchedUpdates=function(v,m){return v(m)},Fs.useFormState=function(v,m,j){return b.H.useFormState(v,m,j)},Fs.useFormStatus=function(){return b.H.useHostTransitionStatus()},Fs.version="19.2.0",Fs}var S1;function a2(){if(S1)return pg.exports;S1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(r){console.error(r)}}return n(),pg.exports=o2(),pg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T1;function s2(){if(T1)return Yf;T1=1;var n=r2(),r=s0(),o=a2();function s(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function d(e){var t=e,a=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(a=t.return),e=t.return;while(e)}return t.tag===3?a:null}function b(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function v(e){if(d(e)!==e)throw Error(s(188))}function m(e){var t=e.alternate;if(!t){if(t=d(e),t===null)throw Error(s(188));return t!==e?null:e}for(var a=e,u=t;;){var h=a.return;if(h===null)break;var S=h.alternate;if(S===null){if(u=h.return,u!==null){a=u;continue}break}if(h.child===S.child){for(S=h.child;S;){if(S===a)return v(h),e;if(S===u)return v(h),t;S=S.sibling}throw Error(s(188))}if(a.return!==u.return)a=h,u=S;else{for(var B=!1,ce=h.child;ce;){if(ce===a){B=!0,a=h,u=S;break}if(ce===u){B=!0,u=h,a=S;break}ce=ce.sibling}if(!B){for(ce=S.child;ce;){if(ce===a){B=!0,a=S,u=h;break}if(ce===u){B=!0,u=S,a=h;break}ce=ce.sibling}if(!B)throw Error(s(189))}}if(a.alternate!==u)throw Error(s(190))}if(a.tag!==3)throw Error(s(188));return a.stateNode.current===a?e:t}function j(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=j(e),t!==null)return t;e=e.sibling}return null}var _=Object.assign,M=Symbol.for("react.element"),T=Symbol.for("react.transitional.element"),F=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),ae=Symbol.for("react.consumer"),E=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),ne=Symbol.for("react.suspense"),Z=Symbol.for("react.suspense_list"),G=Symbol.for("react.memo"),te=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),W=Symbol.for("react.memo_cache_sentinel"),Y=Symbol.iterator;function D(e){return e===null||typeof e!="object"?null:(e=Y&&e[Y]||e["@@iterator"],typeof e=="function"?e:null)}var J=Symbol.for("react.client.reference");function $(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===J?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case P:return"Fragment";case y:return"Profiler";case k:return"StrictMode";case ne:return"Suspense";case Z:return"SuspenseList";case O:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case F:return"Portal";case E:return e.displayName||"Context";case ae:return(e._context.displayName||"Context")+".Consumer";case U:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case G:return t=e.displayName||null,t!==null?t:$(e.type)||"Memo";case te:t=e._payload,e=e._init;try{return $(e(t))}catch{}}return null}var je=Array.isArray,ee=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,de=o.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ne={pending:!1,data:null,method:null,action:null},Ie=[],$e=-1;function q(e){return{current:e}}function w(e){0>$e||(e.current=Ie[$e],Ie[$e]=null,$e--)}function V(e,t){$e++,Ie[$e]=e.current,e.current=t}var H=q(null),ue=q(null),ve=q(null),se=q(null);function ze(e,t){switch(V(ve,t),V(ue,e),V(H,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?O0(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=O0(t),e=F0(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}w(H),V(H,e)}function xe(){w(H),w(ue),w(ve)}function De(e){e.memoizedState!==null&&V(se,e);var t=H.current,a=F0(t,e.type);t!==a&&(V(ue,e),V(H,a))}function Ye(e){ue.current===e&&(w(H),w(ue)),se.current===e&&(w(se),Vf._currentValue=Ne)}var lt,St;function Wt(e){if(lt===void 0)try{throw Error()}catch(a){var t=a.stack.trim().match(/\n( *(at )?)/);lt=t&&t[1]||"",St=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+lt+e+St}var ge=!1;function Ot(e,t){if(!e||ge)return"";ge=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(t){var Dt=function(){throw Error()};if(Object.defineProperty(Dt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Dt,[])}catch(ft){var at=ft}Reflect.construct(e,[],Dt)}else{try{Dt.call()}catch(ft){at=ft}e.call(Dt.prototype)}}else{try{throw Error()}catch(ft){at=ft}(Dt=e())&&typeof Dt.catch=="function"&&Dt.catch(function(){})}}catch(ft){if(ft&&at&&typeof ft.stack=="string")return[ft.stack,at.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var h=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");h&&h.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var S=u.DetermineComponentFrameRoot(),B=S[0],ce=S[1];if(B&&ce){var Fe=B.split(`
`),it=ce.split(`
`);for(h=u=0;u<Fe.length&&!Fe[u].includes("DetermineComponentFrameRoot");)u++;for(;h<it.length&&!it[h].includes("DetermineComponentFrameRoot");)h++;if(u===Fe.length||h===it.length)for(u=Fe.length-1,h=it.length-1;1<=u&&0<=h&&Fe[u]!==it[h];)h--;for(;1<=u&&0<=h;u--,h--)if(Fe[u]!==it[h]){if(u!==1||h!==1)do if(u--,h--,0>h||Fe[u]!==it[h]){var wt=`
`+Fe[u].replace(" at new "," at ");return e.displayName&&wt.includes("<anonymous>")&&(wt=wt.replace("<anonymous>",e.displayName)),wt}while(1<=u&&0<=h);break}}}finally{ge=!1,Error.prepareStackTrace=a}return(a=e?e.displayName||e.name:"")?Wt(a):""}function _t(e,t){switch(e.tag){case 26:case 27:case 5:return Wt(e.type);case 16:return Wt("Lazy");case 13:return e.child!==t&&t!==null?Wt("Suspense Fallback"):Wt("Suspense");case 19:return Wt("SuspenseList");case 0:case 15:return Ot(e.type,!1);case 11:return Ot(e.type.render,!1);case 1:return Ot(e.type,!0);case 31:return Wt("Activity");default:return""}}function qt(e){try{var t="",a=null;do t+=_t(e,a),a=e,e=e.return;while(e);return t}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var ht=Object.prototype.hasOwnProperty,fn=n.unstable_scheduleCallback,Yt=n.unstable_cancelCallback,ln=n.unstable_shouldYield,cn=n.unstable_requestPaint,Sn=n.unstable_now,mn=n.unstable_getCurrentPriorityLevel,tt=n.unstable_ImmediatePriority,Bt=n.unstable_UserBlockingPriority,Gt=n.unstable_NormalPriority,an=n.unstable_LowPriority,dt=n.unstable_IdlePriority,Mt=n.log,Me=n.unstable_setDisableYieldValue,we=null,st=null;function et(e){if(typeof Mt=="function"&&Me(e),st&&typeof st.setStrictMode=="function")try{st.setStrictMode(we,e)}catch{}}var Pt=Math.clz32?Math.clz32:zt,Rt=Math.log,Ge=Math.LN2;function zt(e){return e>>>=0,e===0?32:31-(Rt(e)/Ge|0)|0}var Tt=256,tn=262144,Xt=4194304;function pn(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function ti(e,t,a){var u=e.pendingLanes;if(u===0)return 0;var h=0,S=e.suspendedLanes,B=e.pingedLanes;e=e.warmLanes;var ce=u&134217727;return ce!==0?(u=ce&~S,u!==0?h=pn(u):(B&=ce,B!==0?h=pn(B):a||(a=ce&~e,a!==0&&(h=pn(a))))):(ce=u&~S,ce!==0?h=pn(ce):B!==0?h=pn(B):a||(a=u&~e,a!==0&&(h=pn(a)))),h===0?0:t!==0&&t!==h&&(t&S)===0&&(S=h&-h,a=t&-t,S>=a||S===32&&(a&4194048)!==0)?t:h}function Go(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function zn(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Bi(){var e=Xt;return Xt<<=1,(Xt&62914560)===0&&(Xt=4194304),e}function ni(e){for(var t=[],a=0;31>a;a++)t.push(e);return t}function nn(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function xi(e,t,a,u,h,S){var B=e.pendingLanes;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=a,e.entangledLanes&=a,e.errorRecoveryDisabledLanes&=a,e.shellSuspendCounter=0;var ce=e.entanglements,Fe=e.expirationTimes,it=e.hiddenUpdates;for(a=B&~a;0<a;){var wt=31-Pt(a),Dt=1<<wt;ce[wt]=0,Fe[wt]=-1;var at=it[wt];if(at!==null)for(it[wt]=null,wt=0;wt<at.length;wt++){var ft=at[wt];ft!==null&&(ft.lane&=-536870913)}a&=~Dt}u!==0&&hi(e,u,0),S!==0&&h===0&&e.tag!==0&&(e.suspendedLanes|=S&~(B&~t))}function hi(e,t,a){e.pendingLanes|=t,e.suspendedLanes&=~t;var u=31-Pt(t);e.entangledLanes|=t,e.entanglements[u]=e.entanglements[u]|1073741824|a&261930}function fr(e,t){var a=e.entangledLanes|=t;for(e=e.entanglements;a;){var u=31-Pt(a),h=1<<u;h&t|e[u]&t&&(e[u]|=t),a&=~h}}function zr(e,t){var a=t&-t;return a=(a&42)!==0?1:or(a),(a&(e.suspendedLanes|t))!==0?0:a}function or(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function xt(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Yn(){var e=de.p;return e!==0?e:(e=window.event,e===void 0?32:l1(e.type))}function ui(e,t){var a=de.p;try{return de.p=e,t()}finally{de.p=a}}var Si=Math.random().toString(36).slice(2),ut="__reactFiber$"+Si,Et="__reactProps$"+Si,En="__reactContainer$"+Si,Zt="__reactEvents$"+Si,Vn="__reactListeners$"+Si,Ti="__reactHandles$"+Si,_i="__reactResources$"+Si,mr="__reactMarker$"+Si;function mi(e){delete e[ut],delete e[Et],delete e[Zt],delete e[Vn],delete e[Ti]}function pr(e){var t=e[ut];if(t)return t;for(var a=e.parentNode;a;){if(t=a[En]||a[ut]){if(a=t.alternate,t.child!==null||a!==null&&a.child!==null)for(e=$0(e);e!==null;){if(a=e[ut])return a;e=$0(e)}return t}e=a,a=e.parentNode}return null}function Ci(e){if(e=e[ut]||e[En]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function _n(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(s(33))}function ko(e){var t=e[_i];return t||(t=e[_i]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function qn(e){e[mr]=!0}var us=new Set,gi={};function Mo(e,t){Ei(e,t),Ei(e+"Capture",t)}function Ei(e,t){for(gi[e]=t,e=0;e<t.length;e++)us.add(t[e])}var zs=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ka={},Za={};function ds(e){return ht.call(Za,e)?!0:ht.call(Ka,e)?!1:zs.test(e)?Za[e]=!0:(Ka[e]=!0,!1)}function Ur(e,t,a){if(ds(t))if(a===null)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var u=t.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+a)}}function Ws(e,t,a){if(a===null)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+a)}}function _r(e,t,a,u){if(u===null)e.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(a);return}e.setAttributeNS(t,a,""+u)}}function $i(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function yi(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Tr(e,t,a){var u=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var h=u.get,S=u.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return h.call(this)},set:function(B){a=""+B,S.call(this,B)}}),Object.defineProperty(e,t,{enumerable:u.enumerable}),{getValue:function(){return a},setValue:function(B){a=""+B},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ja(e){if(!e._valueTracker){var t=yi(e)?"checked":"value";e._valueTracker=Tr(e,t,""+e[t])}}function Yl(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var a=t.getValue(),u="";return e&&(u=yi(e)?e.checked?"true":"false":e.value),e=u,e!==a?(t.setValue(e),!0):!1}function xo(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var uo=/[\n"\\]/g;function Qi(e){return e.replace(uo,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function Xo(e,t,a,u,h,S,B,ce){e.name="",B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"?e.type=B:e.removeAttribute("type"),t!=null?B==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+$i(t)):e.value!==""+$i(t)&&(e.value=""+$i(t)):B!=="submit"&&B!=="reset"||e.removeAttribute("value"),t!=null?ca(e,B,$i(t)):a!=null?ca(e,B,$i(a)):u!=null&&e.removeAttribute("value"),h==null&&S!=null&&(e.defaultChecked=!!S),h!=null&&(e.checked=h&&typeof h!="function"&&typeof h!="symbol"),ce!=null&&typeof ce!="function"&&typeof ce!="symbol"&&typeof ce!="boolean"?e.name=""+$i(ce):e.removeAttribute("name")}function Gl(e,t,a,u,h,S,B,ce){if(S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(e.type=S),t!=null||a!=null){if(!(S!=="submit"&&S!=="reset"||t!=null)){Ja(e);return}a=a!=null?""+$i(a):"",t=t!=null?""+$i(t):a,ce||t===e.value||(e.value=t),e.defaultValue=t}u=u??h,u=typeof u!="function"&&typeof u!="symbol"&&!!u,e.checked=ce?e.checked:!!u,e.defaultChecked=!!u,B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"&&(e.name=B),Ja(e)}function ca(e,t,a){t==="number"&&xo(e.ownerDocument)===e||e.defaultValue===""+a||(e.defaultValue=""+a)}function Cr(e,t,a,u){if(e=e.options,t){t={};for(var h=0;h<a.length;h++)t["$"+a[h]]=!0;for(a=0;a<e.length;a++)h=t.hasOwnProperty("$"+e[a].value),e[a].selected!==h&&(e[a].selected=h),h&&u&&(e[a].defaultSelected=!0)}else{for(a=""+$i(a),t=null,h=0;h<e.length;h++){if(e[h].value===a){e[h].selected=!0,u&&(e[h].defaultSelected=!0);return}t!==null||e[h].disabled||(t=e[h])}t!==null&&(t.selected=!0)}}function Xl(e,t,a){if(t!=null&&(t=""+$i(t),t!==e.value&&(e.value=t),a==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=a!=null?""+$i(a):""}function Wr(e,t,a,u){if(t==null){if(u!=null){if(a!=null)throw Error(s(92));if(je(u)){if(1<u.length)throw Error(s(93));u=u[0]}a=u}a==null&&(a=""),t=a}a=$i(t),e.defaultValue=a,u=e.textContent,u===a&&u!==""&&u!==null&&(e.value=u),Ja(e)}function Di(e,t){if(t){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=t;return}}e.textContent=t}var cl=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ba(e,t,a){var u=t.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?u?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":u?e.setProperty(t,a):typeof a!="number"||a===0||cl.has(t)?t==="float"?e.cssFloat=a:e[t]=(""+a).trim():e[t]=a+"px"}function Bo(e,t,a){if(t!=null&&typeof t!="object")throw Error(s(62));if(e=e.style,a!=null){for(var u in a)!a.hasOwnProperty(u)||t!=null&&t.hasOwnProperty(u)||(u.indexOf("--")===0?e.setProperty(u,""):u==="float"?e.cssFloat="":e[u]="");for(var h in t)u=t[h],t.hasOwnProperty(h)&&a[h]!==u&&Ba(e,h,u)}else for(var S in t)t.hasOwnProperty(S)&&Ba(e,S,t[S])}function fs(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ka=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ko=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Qr(e){return Ko.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function jr(){}var ps=null;function Oa(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var $s=null,kn=null;function Ct(e){var t=Ci(e);if(t&&(e=t.stateNode)){var a=e[Et]||null;e:switch(e=t.stateNode,t.type){case"input":if(Xo(e,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),t=a.name,a.type==="radio"&&t!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+Qi(""+t)+'"][type="radio"]'),t=0;t<a.length;t++){var u=a[t];if(u!==e&&u.form===e.form){var h=u[Et]||null;if(!h)throw Error(s(90));Xo(u,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name)}}for(t=0;t<a.length;t++)u=a[t],u.form===e.form&&Yl(u)}break e;case"textarea":Xl(e,a.value,a.defaultValue);break e;case"select":t=a.value,t!=null&&Cr(e,!!a.multiple,t,!1)}}}var Kn=!1;function Fa(e,t,a){if(Kn)return e(t,a);Kn=!0;try{var u=e(t);return u}finally{if(Kn=!1,($s!==null||kn!==null)&&(Vr(),$s&&(t=$s,e=kn,kn=$s=null,Ct(t),e)))for(t=0;t<e.length;t++)Ct(e[t])}}function ua(e,t){var a=e.stateNode;if(a===null)return null;var u=a[Et]||null;if(u===null)return null;a=u[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(e=e.type,u=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!u;break e;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(s(231,t,typeof a));return a}var wn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tn=!1;if(wn)try{var ul={};Object.defineProperty(ul,"passive",{get:function(){Tn=!0}}),window.addEventListener("test",ul,ul),window.removeEventListener("test",ul,ul)}catch{Tn=!1}var Oo=null,Mn=null,yn=null;function Ri(){if(yn)return yn;var e,t=Mn,a=t.length,u,h="value"in Oo?Oo.value:Oo.textContent,S=h.length;for(e=0;e<a&&t[e]===h[e];e++);var B=a-e;for(u=1;u<=B&&t[a-u]===h[S-u];u++);return yn=h.slice(e,1<u?1-u:void 0)}function hn(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ji(){return!0}function Cn(){return!1}function Zo(e){function t(a,u,h,S,B){this._reactName=a,this._targetInst=h,this.type=u,this.nativeEvent=S,this.target=B,this.currentTarget=null;for(var ce in e)e.hasOwnProperty(ce)&&(a=e[ce],this[ce]=a?a(S):S[ce]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?ji:Cn,this.isPropagationStopped=Cn,this}return _(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=ji)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=ji)},persist:function(){},isPersistent:ji}),t}var Qt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},oi=Zo(Qt),en=_({},Qt,{view:0,detail:0}),Ni=Zo(en),Ua,Ea,fo,Aa=_({},en,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rn,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==fo&&(fo&&e.type==="mousemove"?(Ua=e.screenX-fo.screenX,Ea=e.screenY-fo.screenY):Ea=Ua=0,fo=e),Ua)},movementY:function(e){return"movementY"in e?e.movementY:Ea}}),hs=Zo(Aa),Qa=_({},Aa,{dataTransfer:0}),Ys=Zo(Qa),nu=_({},en,{relatedTarget:0}),gs=Zo(nu),iu=_({},Qt,{animationName:0,elapsedTime:0,pseudoElement:0}),C=Zo(iu),Q=_({},Qt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),pe=Zo(Q),Be=_({},Qt,{data:0}),Ve=Zo(Be),gt={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},mt={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$t={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Jt(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=$t[e])?!!t[e]:!1}function rn(){return Jt}var Bn=_({},en,{key:function(e){if(e.key){var t=gt[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=hn(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?mt[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rn,charCode:function(e){return e.type==="keypress"?hn(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?hn(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),di=Zo(Bn),eo=_({},Aa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Yi=Zo(eo),Dr=_({},en,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rn}),Rr=Zo(Dr),Ao=_({},Qt,{propertyName:0,elapsedTime:0,pseudoElement:0}),ar=Zo(Ao),da=_({},Aa,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Lr=Zo(da),fa=_({},Qt,{newState:0,oldState:0}),pa=Zo(fa),ys=[9,13,27,32],Jo=wn&&"CompositionEvent"in window,Pa=null;wn&&"documentMode"in document&&(Pa=document.documentMode);var po=wn&&"TextEvent"in window&&!Pa,ha=wn&&(!Jo||Pa&&8<Pa&&11>=Pa),er=" ",za=!1;function mo(e,t){switch(e){case"keyup":return ys.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function es(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var tr=!1;function to(e,t){switch(e){case"compositionend":return es(t);case"keypress":return t.which!==32?null:(za=!0,er);case"textInput":return e=t.data,e===er&&za?null:e;default:return null}}function Tl(e,t){if(tr)return e==="compositionend"||!Jo&&mo(e,t)?(e=Ri(),yn=Mn=Oo=null,tr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ha&&t.locale!=="ko"?null:t.data;default:return null}}var zc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _s(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!zc[e.type]:t==="textarea"}function _a(e,t,a,u){$s?kn?kn.push(u):kn=[u]:$s=u,t=Lp(t,"onChange"),0<t.length&&(a=new oi("onChange","change",null,a,u),e.push({event:a,listeners:t}))}var ts=null,Gs=null;function Po(e){D0(e,0)}function ns(e){var t=_n(e);if(Yl(t))return e}function ho(e,t){if(e==="change")return t}var Fo=!1;if(wn){var $r;if(wn){var Ds="oninput"in document;if(!Ds){var Qo=document.createElement("div");Qo.setAttribute("oninput","return;"),Ds=typeof Qo.oninput=="function"}$r=Ds}else $r=!1;Fo=$r&&(!document.documentMode||9<document.documentMode)}function Xs(){ts&&(ts.detachEvent("onpropertychange",Va),Gs=ts=null)}function Va(e){if(e.propertyName==="value"&&ns(Gs)){var t=[];_a(t,Gs,e,Oa(e)),Fa(Po,t)}}function Kl(e,t,a){e==="focusin"?(Xs(),ts=t,Gs=a,ts.attachEvent("onpropertychange",Va)):e==="focusout"&&Xs()}function Zn(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ns(Gs)}function xs(e,t){if(e==="click")return ns(t)}function Gi(e,t){if(e==="input"||e==="change")return ns(t)}function ea(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Uo=typeof Object.is=="function"?Object.is:ea;function ga(e,t){if(Uo(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var a=Object.keys(e),u=Object.keys(t);if(a.length!==u.length)return!1;for(u=0;u<a.length;u++){var h=a[u];if(!ht.call(t,h)||!Uo(e[h],t[h]))return!1}return!0}function _c(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ks(e,t){var a=_c(e);e=0;for(var u;a;){if(a.nodeType===3){if(u=e+a.textContent.length,e<=t&&u>=t)return{node:a,offset:t-e};e=u}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=_c(a)}}function Cl(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Cl(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function jl(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=xo(e.document);t instanceof e.HTMLIFrameElement;){try{var a=typeof t.contentWindow.location.href=="string"}catch{a=!1}if(a)e=t.contentWindow;else break;t=xo(e.document)}return t}function bo(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var Nl=wn&&"documentMode"in document&&11>=document.documentMode,Eo=null,qa=null,hr=null,is=!1;function Vi(e,t,a){var u=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;is||Eo==null||Eo!==xo(u)||(u=Eo,"selectionStart"in u&&bo(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),hr&&ga(hr,u)||(hr=u,u=Lp(qa,"onSelect"),0<u.length&&(t=new oi("onSelect","select",null,t,a),e.push({event:t,listeners:u}),t.target=Eo)))}function Xi(e,t){var a={};return a[e.toLowerCase()]=t.toLowerCase(),a["Webkit"+e]="webkit"+t,a["Moz"+e]="moz"+t,a}var gr={animationend:Xi("Animation","AnimationEnd"),animationiteration:Xi("Animation","AnimationIteration"),animationstart:Xi("Animation","AnimationStart"),transitionrun:Xi("Transition","TransitionRun"),transitionstart:Xi("Transition","TransitionStart"),transitioncancel:Xi("Transition","TransitionCancel"),transitionend:Xi("Transition","TransitionEnd")},vo={},rs={};wn&&(rs=document.createElement("div").style,"AnimationEvent"in window||(delete gr.animationend.animation,delete gr.animationiteration.animation,delete gr.animationstart.animation),"TransitionEvent"in window||delete gr.transitionend.transition);function Zs(e){if(vo[e])return vo[e];if(!gr[e])return e;var t=gr[e],a;for(a in t)if(t.hasOwnProperty(a)&&a in rs)return vo[e]=t[a];return e}var fc=Zs("animationend"),ru=Zs("animationiteration"),Ku=Zs("animationstart"),Ha=Zs("transitionrun"),go=Zs("transitionstart"),kl=Zs("transitioncancel"),zo=Zs("transitionend"),Rs=new Map,wo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");wo.push("scrollEnd");function _o(e,t){Rs.set(e,t),Mo(t,[e])}var no=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},ya=[],sr=0,ai=0;function Mr(){for(var e=sr,t=ai=sr=0;t<e;){var a=ya[t];ya[t++]=null;var u=ya[t];ya[t++]=null;var h=ya[t];ya[t++]=null;var S=ya[t];if(ya[t++]=null,u!==null&&h!==null){var B=u.pending;B===null?h.next=h:(h.next=B.next,B.next=h),u.pending=h}S!==0&&Wa(a,h,S)}}function io(e,t,a,u){ya[sr++]=e,ya[sr++]=t,ya[sr++]=a,ya[sr++]=u,ai|=u,e.lanes|=u,e=e.alternate,e!==null&&(e.lanes|=u)}function Do(e,t,a,u){return io(e,t,a,u),ta(e)}function dl(e,t){return io(e,null,null,t),ta(e)}function Wa(e,t,a){e.lanes|=a;var u=e.alternate;u!==null&&(u.lanes|=a);for(var h=!1,S=e.return;S!==null;)S.childLanes|=a,u=S.alternate,u!==null&&(u.childLanes|=a),S.tag===22&&(e=S.stateNode,e===null||e._visibility&1||(h=!0)),e=S,S=S.return;return e.tag===3?(S=e.stateNode,h&&t!==null&&(h=31-Pt(a),e=S.hiddenUpdates,u=e[h],u===null?e[h]=[t]:u.push(t),t.lane=a|536870912),S):null}function ta(e){if(50<sn)throw sn=0,Hn=null,Error(s(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Yr={};function Ii(e,t,a,u){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ai(e,t,a,u){return new Ii(e,t,a,u)}function Dc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function br(e,t){var a=e.alternate;return a===null?(a=Ai(e.tag,t,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=t,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&65011712,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,t=e.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a.refCleanup=e.refCleanup,a}function ro(e,t){e.flags&=65011714;var a=e.alternate;return a===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=a.childLanes,e.lanes=a.lanes,e.child=a.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,e.type=a.type,t=a.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function fl(e,t,a,u,h,S){var B=0;if(u=e,typeof e=="function")Dc(e)&&(B=1);else if(typeof e=="string")B=Em(e,a,H.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case O:return e=Ai(31,a,t,h),e.elementType=O,e.lanes=S,e;case P:return oo(a.children,h,S,t);case k:B=8,h|=24;break;case y:return e=Ai(12,a,t,h|2),e.elementType=y,e.lanes=S,e;case ne:return e=Ai(13,a,t,h),e.elementType=ne,e.lanes=S,e;case Z:return e=Ai(19,a,t,h),e.elementType=Z,e.lanes=S,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case E:B=10;break e;case ae:B=9;break e;case U:B=11;break e;case G:B=14;break e;case te:B=16,u=null;break e}B=29,a=Error(s(130,e===null?"null":typeof e,"")),u=null}return t=Ai(B,a,t,h),t.elementType=e,t.type=u,t.lanes=S,t}function oo(e,t,a,u){return e=Ai(7,e,u,t),e.lanes=a,e}function os(e,t,a){return e=Ai(6,e,null,t),e.lanes=a,e}function na(e){var t=Ai(18,null,null,0);return t.stateNode=e,t}function pl(e,t,a){return t=Ai(4,e.children!==null?e.children:[],e.key,t),t.lanes=a,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var ou=new WeakMap;function ms(e,t){if(typeof e=="object"&&e!==null){var a=ou.get(e);return a!==void 0?a:(t={value:e,source:t,stack:qt(t)},ou.set(e,t),t)}return{value:e,source:t,stack:qt(t)}}var as=[],hl=0,Rc=null,Al=0,bs=[],ia=0,$a=null,So=1,Ro="";function Da(e,t){as[hl++]=Al,as[hl++]=Rc,Rc=e,Al=t}function au(e,t,a){bs[ia++]=So,bs[ia++]=Ro,bs[ia++]=$a,$a=e;var u=So;e=Ro;var h=32-Pt(u)-1;u&=~(1<<h),a+=1;var S=32-Pt(t)+h;if(30<S){var B=h-h%5;S=(u&(1<<B)-1).toString(32),u>>=B,h-=B,So=1<<32-Pt(t)+h|a<<h|u,Ro=S+e}else So=1<<S|a<<h|u,Ro=e}function Pl(e){e.return!==null&&(Da(e,1),au(e,1,0))}function vs(e){for(;e===Rc;)Rc=as[--hl],as[hl]=null,Al=as[--hl],as[hl]=null;for(;e===$a;)$a=bs[--ia],bs[ia]=null,Ro=bs[--ia],bs[ia]=null,So=bs[--ia],bs[ia]=null}function Zu(e,t){bs[ia++]=So,bs[ia++]=Ro,bs[ia++]=$a,So=t.id,Ro=t.overflow,$a=e}var vr=null,Br=null,On=!1,Vo=null,ao=!1,xa=Error(s(519));function ma(e){var t=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Lc(ms(t,e)),xa}function Ic(e){var t=e.stateNode,a=e.type,u=e.memoizedProps;switch(t[ut]=e,t[Et]=u,a){case"dialog":Ji("cancel",t),Ji("close",t);break;case"iframe":case"object":case"embed":Ji("load",t);break;case"video":case"audio":for(a=0;a<Bf.length;a++)Ji(Bf[a],t);break;case"source":Ji("error",t);break;case"img":case"image":case"link":Ji("error",t),Ji("load",t);break;case"details":Ji("toggle",t);break;case"input":Ji("invalid",t),Gl(t,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":Ji("invalid",t);break;case"textarea":Ji("invalid",t),Wr(t,u.value,u.defaultValue,u.children)}a=u.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||t.textContent===""+a||u.suppressHydrationWarning===!0||M0(t.textContent,a)?(u.popover!=null&&(Ji("beforetoggle",t),Ji("toggle",t)),u.onScroll!=null&&Ji("scroll",t),u.onScrollEnd!=null&&Ji("scrollend",t),u.onClick!=null&&(t.onclick=jr),t=!0):t=!1,t||ma(e,!0)}function ba(e){for(vr=e.return;vr;)switch(vr.tag){case 5:case 31:case 13:ao=!1;return;case 27:case 3:ao=!0;return;default:vr=vr.return}}function Gr(e){if(e!==vr)return!1;if(!On)return ba(e),On=!0,!1;var t=e.tag,a;if((a=t!==3&&t!==27)&&((a=t===5)&&(a=e.type,a=!(a!=="form"&&a!=="button")||Yh(e.type,e.memoizedProps)),a=!a),a&&Br&&ma(e),ba(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));Br=W0(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));Br=W0(e)}else t===27?(t=Br,Mu(e.type)?(e=Jh,Jh=null,Br=e):Br=t):Br=vr?ac(e.stateNode.nextSibling):null;return!0}function Js(){Br=vr=null,On=!1}function ws(){var e=Vo;return e!==null&&(Le===null?Le=e:Le.push.apply(Le,e),Vo=null),e}function Lc(e){Vo===null?Vo=[e]:Vo.push(e)}var su=q(null),Zl=null,gl=null;function yl(e,t,a){V(su,t._currentValue),t._currentValue=a}function Ss(e){e._currentValue=su.current,w(su)}function pc(e,t,a){for(;e!==null;){var u=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,u!==null&&(u.childLanes|=t)):u!==null&&(u.childLanes&t)!==t&&(u.childLanes|=t),e===a)break;e=e.return}}function Jl(e,t,a,u){var h=e.child;for(h!==null&&(h.return=e);h!==null;){var S=h.dependencies;if(S!==null){var B=h.child;S=S.firstContext;e:for(;S!==null;){var ce=S;S=h;for(var Fe=0;Fe<t.length;Fe++)if(ce.context===t[Fe]){S.lanes|=a,ce=S.alternate,ce!==null&&(ce.lanes|=a),pc(S.return,a,e),u||(B=null);break e}S=ce.next}}else if(h.tag===18){if(B=h.return,B===null)throw Error(s(341));B.lanes|=a,S=B.alternate,S!==null&&(S.lanes|=a),pc(B,a,e),B=null}else B=h.child;if(B!==null)B.return=h;else for(B=h;B!==null;){if(B===e){B=null;break}if(h=B.sibling,h!==null){h.return=B.return,B=h;break}B=B.return}h=B}}function Ya(e,t,a,u){e=null;for(var h=t,S=!1;h!==null;){if(!S){if((h.flags&524288)!==0)S=!0;else if((h.flags&262144)!==0)break}if(h.tag===10){var B=h.alternate;if(B===null)throw Error(s(387));if(B=B.memoizedProps,B!==null){var ce=h.type;Uo(h.pendingProps.value,B.value)||(e!==null?e.push(ce):e=[ce])}}else if(h===se.current){if(B=h.alternate,B===null)throw Error(s(387));B.memoizedState.memoizedState!==h.memoizedState.memoizedState&&(e!==null?e.push(Vf):e=[Vf])}h=h.return}e!==null&&Jl(t,e,a,u),t.flags|=262144}function To(e){for(e=e.firstContext;e!==null;){if(!Uo(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ga(e){Zl=e,gl=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function qi(e){return Ju(Zl,e)}function ju(e,t){return Zl===null&&Ga(e),Ju(e,t)}function Ju(e,t){var a=t._currentValue;if(t={context:t,memoizedValue:a,next:null},gl===null){if(e===null)throw Error(s(308));gl=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else gl=gl.next=t;return a}var ra=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(a,u){e.push(u)}};this.abort=function(){t.aborted=!0,e.forEach(function(a){return a()})}},ss=n.unstable_scheduleCallback,Ra=n.unstable_NormalPriority,Hi={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Co(){return{controller:new ra,data:new Map,refCount:0}}function oa(e){e.refCount--,e.refCount===0&&ss(Ra,function(){e.controller.abort()})}var qo=null,va=0,f=0,x=null;function N(e,t){if(qo===null){var a=qo=[];va=0,f=Oh(),x={status:"pending",value:void 0,then:function(u){a.push(u)}}}return va++,t.then(R,R),t}function R(){if(--va===0&&qo!==null){x!==null&&(x.status="fulfilled");var e=qo;qo=null,f=0,x=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function X(e,t){var a=[],u={status:"pending",value:null,reason:null,then:function(h){a.push(h)}};return e.then(function(){u.status="fulfilled",u.value=t;for(var h=0;h<a.length;h++)(0,a[h])(t)},function(h){for(u.status="rejected",u.reason=h,h=0;h<a.length;h++)(0,a[h])(void 0)}),u}var ie=ee.S;ee.S=function(e,t){jt=Sn(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&N(e,t),ie!==null&&ie(e,t)};var re=q(null);function le(){var e=re.current;return e!==null?e:g.pooledCache}function he(e,t){t===null?V(re,re.current):V(re,t.pool)}function Te(){var e=le();return e===null?null:{parent:Hi._currentValue,pool:e}}var Ee=Error(s(460)),Xe=Error(s(474)),fe=Error(s(542)),Re={then:function(){}};function Je(e){return e=e.status,e==="fulfilled"||e==="rejected"}function pt(e,t,a){switch(a=e[a],a===void 0?e.push(t):a!==t&&(t.then(jr,jr),t=a),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Ft(e),e;default:if(typeof t.status=="string")t.then(jr,jr);else{if(e=g,e!==null&&100<e.shellSuspendCounter)throw Error(s(482));e=t,e.status="pending",e.then(function(u){if(t.status==="pending"){var h=t;h.status="fulfilled",h.value=u}},function(u){if(t.status==="pending"){var h=t;h.status="rejected",h.reason=u}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Ft(e),e}throw yt=t,Ee}}function Qe(e){try{var t=e._init;return t(e._payload)}catch(a){throw a!==null&&typeof a=="object"&&typeof a.then=="function"?(yt=a,Ee):a}}var yt=null;function vt(){if(yt===null)throw Error(s(459));var e=yt;return yt=null,e}function Ft(e){if(e===Ee||e===fe)throw Error(s(483))}var Nt=null,bn=0;function gn(e){var t=bn;return bn+=1,Nt===null&&(Nt=[]),pt(Nt,e,t)}function ri(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function xn(e,t){throw t.$$typeof===M?Error(s(525)):(e=Object.prototype.toString.call(t),Error(s(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Un(e){function t(Ke,He){if(e){var nt=Ke.deletions;nt===null?(Ke.deletions=[He],Ke.flags|=16):nt.push(He)}}function a(Ke,He){if(!e)return null;for(;He!==null;)t(Ke,He),He=He.sibling;return null}function u(Ke){for(var He=new Map;Ke!==null;)Ke.key!==null?He.set(Ke.key,Ke):He.set(Ke.index,Ke),Ke=Ke.sibling;return He}function h(Ke,He){return Ke=br(Ke,He),Ke.index=0,Ke.sibling=null,Ke}function S(Ke,He,nt){return Ke.index=nt,e?(nt=Ke.alternate,nt!==null?(nt=nt.index,nt<He?(Ke.flags|=67108866,He):nt):(Ke.flags|=67108866,He)):(Ke.flags|=1048576,He)}function B(Ke){return e&&Ke.alternate===null&&(Ke.flags|=67108866),Ke}function ce(Ke,He,nt,kt){return He===null||He.tag!==6?(He=os(nt,Ke.mode,kt),He.return=Ke,He):(He=h(He,nt),He.return=Ke,He)}function Fe(Ke,He,nt,kt){var $n=nt.type;return $n===P?wt(Ke,He,nt.props.children,kt,nt.key):He!==null&&(He.elementType===$n||typeof $n=="object"&&$n!==null&&$n.$$typeof===te&&Qe($n)===He.type)?(He=h(He,nt.props),ri(He,nt),He.return=Ke,He):(He=fl(nt.type,nt.key,nt.props,null,Ke.mode,kt),ri(He,nt),He.return=Ke,He)}function it(Ke,He,nt,kt){return He===null||He.tag!==4||He.stateNode.containerInfo!==nt.containerInfo||He.stateNode.implementation!==nt.implementation?(He=pl(nt,Ke.mode,kt),He.return=Ke,He):(He=h(He,nt.children||[]),He.return=Ke,He)}function wt(Ke,He,nt,kt,$n){return He===null||He.tag!==7?(He=oo(nt,Ke.mode,kt,$n),He.return=Ke,He):(He=h(He,nt),He.return=Ke,He)}function Dt(Ke,He,nt){if(typeof He=="string"&&He!==""||typeof He=="number"||typeof He=="bigint")return He=os(""+He,Ke.mode,nt),He.return=Ke,He;if(typeof He=="object"&&He!==null){switch(He.$$typeof){case T:return nt=fl(He.type,He.key,He.props,null,Ke.mode,nt),ri(nt,He),nt.return=Ke,nt;case F:return He=pl(He,Ke.mode,nt),He.return=Ke,He;case te:return He=Qe(He),Dt(Ke,He,nt)}if(je(He)||D(He))return He=oo(He,Ke.mode,nt,null),He.return=Ke,He;if(typeof He.then=="function")return Dt(Ke,gn(He),nt);if(He.$$typeof===E)return Dt(Ke,ju(Ke,He),nt);xn(Ke,He)}return null}function at(Ke,He,nt,kt){var $n=He!==null?He.key:null;if(typeof nt=="string"&&nt!==""||typeof nt=="number"||typeof nt=="bigint")return $n!==null?null:ce(Ke,He,""+nt,kt);if(typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case T:return nt.key===$n?Fe(Ke,He,nt,kt):null;case F:return nt.key===$n?it(Ke,He,nt,kt):null;case te:return nt=Qe(nt),at(Ke,He,nt,kt)}if(je(nt)||D(nt))return $n!==null?null:wt(Ke,He,nt,kt,null);if(typeof nt.then=="function")return at(Ke,He,gn(nt),kt);if(nt.$$typeof===E)return at(Ke,He,ju(Ke,nt),kt);xn(Ke,nt)}return null}function ft(Ke,He,nt,kt,$n){if(typeof kt=="string"&&kt!==""||typeof kt=="number"||typeof kt=="bigint")return Ke=Ke.get(nt)||null,ce(He,Ke,""+kt,$n);if(typeof kt=="object"&&kt!==null){switch(kt.$$typeof){case T:return Ke=Ke.get(kt.key===null?nt:kt.key)||null,Fe(He,Ke,kt,$n);case F:return Ke=Ke.get(kt.key===null?nt:kt.key)||null,it(He,Ke,kt,$n);case te:return kt=Qe(kt),ft(Ke,He,nt,kt,$n)}if(je(kt)||D(kt))return Ke=Ke.get(nt)||null,wt(He,Ke,kt,$n,null);if(typeof kt.then=="function")return ft(Ke,He,nt,gn(kt),$n);if(kt.$$typeof===E)return ft(Ke,He,nt,ju(He,kt),$n);xn(He,kt)}return null}function jn(Ke,He,nt,kt){for(var $n=null,kr=null,Pn=He,Mi=He=0,rr=null;Pn!==null&&Mi<nt.length;Mi++){Pn.index>Mi?(rr=Pn,Pn=null):rr=Pn.sibling;var Ar=at(Ke,Pn,nt[Mi],kt);if(Ar===null){Pn===null&&(Pn=rr);break}e&&Pn&&Ar.alternate===null&&t(Ke,Pn),He=S(Ar,He,Mi),kr===null?$n=Ar:kr.sibling=Ar,kr=Ar,Pn=rr}if(Mi===nt.length)return a(Ke,Pn),On&&Da(Ke,Mi),$n;if(Pn===null){for(;Mi<nt.length;Mi++)Pn=Dt(Ke,nt[Mi],kt),Pn!==null&&(He=S(Pn,He,Mi),kr===null?$n=Pn:kr.sibling=Pn,kr=Pn);return On&&Da(Ke,Mi),$n}for(Pn=u(Pn);Mi<nt.length;Mi++)rr=ft(Pn,Ke,Mi,nt[Mi],kt),rr!==null&&(e&&rr.alternate!==null&&Pn.delete(rr.key===null?Mi:rr.key),He=S(rr,He,Mi),kr===null?$n=rr:kr.sibling=rr,kr=rr);return e&&Pn.forEach(function(Eu){return t(Ke,Eu)}),On&&Da(Ke,Mi),$n}function ii(Ke,He,nt,kt){if(nt==null)throw Error(s(151));for(var $n=null,kr=null,Pn=He,Mi=He=0,rr=null,Ar=nt.next();Pn!==null&&!Ar.done;Mi++,Ar=nt.next()){Pn.index>Mi?(rr=Pn,Pn=null):rr=Pn.sibling;var Eu=at(Ke,Pn,Ar.value,kt);if(Eu===null){Pn===null&&(Pn=rr);break}e&&Pn&&Eu.alternate===null&&t(Ke,Pn),He=S(Eu,He,Mi),kr===null?$n=Eu:kr.sibling=Eu,kr=Eu,Pn=rr}if(Ar.done)return a(Ke,Pn),On&&Da(Ke,Mi),$n;if(Pn===null){for(;!Ar.done;Mi++,Ar=nt.next())Ar=Dt(Ke,Ar.value,kt),Ar!==null&&(He=S(Ar,He,Mi),kr===null?$n=Ar:kr.sibling=Ar,kr=Ar);return On&&Da(Ke,Mi),$n}for(Pn=u(Pn);!Ar.done;Mi++,Ar=nt.next())Ar=ft(Pn,Ke,Mi,Ar.value,kt),Ar!==null&&(e&&Ar.alternate!==null&&Pn.delete(Ar.key===null?Mi:Ar.key),He=S(Ar,He,Mi),kr===null?$n=Ar:kr.sibling=Ar,kr=Ar);return e&&Pn.forEach(function(Jm){return t(Ke,Jm)}),On&&Da(Ke,Mi),$n}function Jr(Ke,He,nt,kt){if(typeof nt=="object"&&nt!==null&&nt.type===P&&nt.key===null&&(nt=nt.props.children),typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case T:e:{for(var $n=nt.key;He!==null;){if(He.key===$n){if($n=nt.type,$n===P){if(He.tag===7){a(Ke,He.sibling),kt=h(He,nt.props.children),kt.return=Ke,Ke=kt;break e}}else if(He.elementType===$n||typeof $n=="object"&&$n!==null&&$n.$$typeof===te&&Qe($n)===He.type){a(Ke,He.sibling),kt=h(He,nt.props),ri(kt,nt),kt.return=Ke,Ke=kt;break e}a(Ke,He);break}else t(Ke,He);He=He.sibling}nt.type===P?(kt=oo(nt.props.children,Ke.mode,kt,nt.key),kt.return=Ke,Ke=kt):(kt=fl(nt.type,nt.key,nt.props,null,Ke.mode,kt),ri(kt,nt),kt.return=Ke,Ke=kt)}return B(Ke);case F:e:{for($n=nt.key;He!==null;){if(He.key===$n)if(He.tag===4&&He.stateNode.containerInfo===nt.containerInfo&&He.stateNode.implementation===nt.implementation){a(Ke,He.sibling),kt=h(He,nt.children||[]),kt.return=Ke,Ke=kt;break e}else{a(Ke,He);break}else t(Ke,He);He=He.sibling}kt=pl(nt,Ke.mode,kt),kt.return=Ke,Ke=kt}return B(Ke);case te:return nt=Qe(nt),Jr(Ke,He,nt,kt)}if(je(nt))return jn(Ke,He,nt,kt);if(D(nt)){if($n=D(nt),typeof $n!="function")throw Error(s(150));return nt=$n.call(nt),ii(Ke,He,nt,kt)}if(typeof nt.then=="function")return Jr(Ke,He,gn(nt),kt);if(nt.$$typeof===E)return Jr(Ke,He,ju(Ke,nt),kt);xn(Ke,nt)}return typeof nt=="string"&&nt!==""||typeof nt=="number"||typeof nt=="bigint"?(nt=""+nt,He!==null&&He.tag===6?(a(Ke,He.sibling),kt=h(He,nt),kt.return=Ke,Ke=kt):(a(Ke,He),kt=os(nt,Ke.mode,kt),kt.return=Ke,Ke=kt),B(Ke)):a(Ke,He)}return function(Ke,He,nt,kt){try{bn=0;var $n=Jr(Ke,He,nt,kt);return Nt=null,$n}catch(Pn){if(Pn===Ee||Pn===fe)throw Pn;var kr=Ai(29,Pn,null,Ke.mode);return kr.lanes=kt,kr.return=Ke,kr}finally{}}}var Fi=Un(!0),Jn=Un(!1),un=!1;function Ut(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Qn(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Gn(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ei(e,t,a){var u=e.updateQueue;if(u===null)return null;if(u=u.shared,(c&2)!==0){var h=u.pending;return h===null?t.next=t:(t.next=h.next,h.next=t),u.pending=t,t=ta(e),Wa(e,null,a),t}return io(e,u,t,a),ta(e)}function wr(e,t,a){if(t=t.updateQueue,t!==null&&(t=t.shared,(a&4194048)!==0)){var u=t.lanes;u&=e.pendingLanes,a|=u,t.lanes=a,fr(e,a)}}function Ho(e,t){var a=e.updateQueue,u=e.alternate;if(u!==null&&(u=u.updateQueue,a===u)){var h=null,S=null;if(a=a.firstBaseUpdate,a!==null){do{var B={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};S===null?h=S=B:S=S.next=B,a=a.next}while(a!==null);S===null?h=S=t:S=S.next=t}else h=S=t;a={baseState:u.baseState,firstBaseUpdate:h,lastBaseUpdate:S,shared:u.shared,callbacks:u.callbacks},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=t:e.next=t,a.lastBaseUpdate=t}var Wo=!1;function fi(){if(Wo){var e=x;if(e!==null)throw e}}function nr(e,t,a,u){Wo=!1;var h=e.updateQueue;un=!1;var S=h.firstBaseUpdate,B=h.lastBaseUpdate,ce=h.shared.pending;if(ce!==null){h.shared.pending=null;var Fe=ce,it=Fe.next;Fe.next=null,B===null?S=it:B.next=it,B=Fe;var wt=e.alternate;wt!==null&&(wt=wt.updateQueue,ce=wt.lastBaseUpdate,ce!==B&&(ce===null?wt.firstBaseUpdate=it:ce.next=it,wt.lastBaseUpdate=Fe))}if(S!==null){var Dt=h.baseState;B=0,wt=it=Fe=null,ce=S;do{var at=ce.lane&-536870913,ft=at!==ce.lane;if(ft?(L&at)===at:(u&at)===at){at!==0&&at===f&&(Wo=!0),wt!==null&&(wt=wt.next={lane:0,tag:ce.tag,payload:ce.payload,callback:null,next:null});e:{var jn=e,ii=ce;at=t;var Jr=a;switch(ii.tag){case 1:if(jn=ii.payload,typeof jn=="function"){Dt=jn.call(Jr,Dt,at);break e}Dt=jn;break e;case 3:jn.flags=jn.flags&-65537|128;case 0:if(jn=ii.payload,at=typeof jn=="function"?jn.call(Jr,Dt,at):jn,at==null)break e;Dt=_({},Dt,at);break e;case 2:un=!0}}at=ce.callback,at!==null&&(e.flags|=64,ft&&(e.flags|=8192),ft=h.callbacks,ft===null?h.callbacks=[at]:ft.push(at))}else ft={lane:at,tag:ce.tag,payload:ce.payload,callback:ce.callback,next:null},wt===null?(it=wt=ft,Fe=Dt):wt=wt.next=ft,B|=at;if(ce=ce.next,ce===null){if(ce=h.shared.pending,ce===null)break;ft=ce,ce=ft.next,ft.next=null,h.lastBaseUpdate=ft,h.shared.pending=null}}while(!0);wt===null&&(Fe=Dt),h.baseState=Fe,h.firstBaseUpdate=it,h.lastBaseUpdate=wt,S===null&&(h.shared.lanes=0),ke|=B,e.lanes=B,e.memoizedState=Dt}}function yo(e,t){if(typeof e!="function")throw Error(s(191,e));e.call(t)}function Er(e,t){var a=e.callbacks;if(a!==null)for(e.callbacks=null,e=0;e<a.length;e++)yo(a[e],t)}var si=q(null),ki=q(0);function lr(e,t){e=_e,V(ki,e),V(si,t),_e=e|t.baseLanes}function cr(){V(ki,_e),V(si,si.current)}function Xr(){_e=ki.current,w(si),w(ki)}var Oi=q(null),ci=null;function Li(e){var t=e.alternate;V(Ui,Ui.current&1),V(Oi,e),ci===null&&(t===null||si.current!==null||t.memoizedState!==null)&&(ci=e)}function Pi(e){V(Ui,Ui.current),V(Oi,e),ci===null&&(ci=e)}function ur(e){e.tag===22?(V(Ui,Ui.current),V(Oi,e),ci===null&&(ci=e)):Kr()}function Kr(){V(Ui,Ui.current),V(Oi,Oi.current)}function ir(e){w(Oi),ci===e&&(ci=null),w(Ui)}var Ui=q(0);function Ia(e){for(var t=e;t!==null;){if(t.tag===13){var a=t.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||Kh(a)||Zh(a)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ki=0,An=null,Dn=null,Zi=null,wa=!1,Ts=!1,Sa=!1,yr=0,Cs=0,Qs=null,Mc=0;function Ir(){throw Error(s(321))}function Bc(e,t){if(t===null)return!1;for(var a=0;a<t.length&&a<e.length;a++)if(!Uo(e[a],t[a]))return!1;return!0}function Nu(e,t,a,u,h,S){return Ki=S,An=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ee.H=e===null||e.memoizedState===null?jd:pu,Sa=!1,S=a(u,h),Sa=!1,Ts&&(S=La(t,a,u,h)),Ql(e),S}function Ql(e){ee.H=xc;var t=Dn!==null&&Dn.next!==null;if(Ki=0,Zi=Dn=An=null,wa=!1,Cs=0,Qs=null,t)throw Error(s(300));e===null||jo||(e=e.dependencies,e!==null&&To(e)&&(jo=!0))}function La(e,t,a,u){An=e;var h=0;do{if(Ts&&(Qs=null),Cs=0,Ts=!1,25<=h)throw Error(s(301));if(h+=1,Zi=Dn=null,e.updateQueue!=null){var S=e.updateQueue;S.lastEffect=null,S.events=null,S.stores=null,S.memoCache!=null&&(S.memoCache.index=0)}ee.H=ku,S=t(a,u)}while(Ts);return S}function Qu(){var e=ee.H,t=e.useState()[0];return t=typeof t.then=="function"?xl(t):t,e=e.useState()[0],(Dn!==null?Dn.memoizedState:null)!==e&&(An.flags|=1024),t}function zl(){var e=yr!==0;return yr=0,e}function lu(e,t,a){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a}function el(e){if(wa){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}wa=!1}Ki=0,Zi=Dn=An=null,Ts=!1,Cs=yr=0,Qs=null}function so(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zi===null?An.memoizedState=Zi=e:Zi=Zi.next=e,Zi}function Or(){if(Dn===null){var e=An.alternate;e=e!==null?e.memoizedState:null}else e=Dn.next;var t=Zi===null?An.memoizedState:Zi.next;if(t!==null)Zi=t,Dn=e;else{if(e===null)throw An.alternate===null?Error(s(467)):Error(s(310));Dn=e,e={memoizedState:Dn.memoizedState,baseState:Dn.baseState,baseQueue:Dn.baseQueue,queue:Dn.queue,next:null},Zi===null?An.memoizedState=Zi=e:Zi=Zi.next=e}return Zi}function hc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function xl(e){var t=Cs;return Cs+=1,Qs===null&&(Qs=[]),e=pt(Qs,e,t),t=An,(Zi===null?t.memoizedState:Zi.next)===null&&(t=t.alternate,ee.H=t===null||t.memoizedState===null?jd:pu),e}function _l(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return xl(e);if(e.$$typeof===E)return qi(e)}throw Error(s(438,String(e)))}function Dl(e){var t=null,a=An.updateQueue;if(a!==null&&(t=a.memoCache),t==null){var u=An.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(t={data:u.data.map(function(h){return h.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),a===null&&(a=hc(),An.updateQueue=a),a.memoCache=t,a=t.data[t.index],a===void 0)for(a=t.data[t.index]=Array(e),u=0;u<e;u++)a[u]=W;return t.index++,a}function Is(e,t){return typeof t=="function"?t(e):t}function cu(e){var t=Or();return tl(t,Dn,e)}function tl(e,t,a){var u=e.queue;if(u===null)throw Error(s(311));u.lastRenderedReducer=a;var h=e.baseQueue,S=u.pending;if(S!==null){if(h!==null){var B=h.next;h.next=S.next,S.next=B}t.baseQueue=h=S,u.pending=null}if(S=e.baseState,h===null)e.memoizedState=S;else{t=h.next;var ce=B=null,Fe=null,it=t,wt=!1;do{var Dt=it.lane&-536870913;if(Dt!==it.lane?(L&Dt)===Dt:(Ki&Dt)===Dt){var at=it.revertLane;if(at===0)Fe!==null&&(Fe=Fe.next={lane:0,revertLane:0,gesture:null,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null}),Dt===f&&(wt=!0);else if((Ki&at)===at){it=it.next,at===f&&(wt=!0);continue}else Dt={lane:0,revertLane:it.revertLane,gesture:null,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null},Fe===null?(ce=Fe=Dt,B=S):Fe=Fe.next=Dt,An.lanes|=at,ke|=at;Dt=it.action,Sa&&a(S,Dt),S=it.hasEagerState?it.eagerState:a(S,Dt)}else at={lane:Dt,revertLane:it.revertLane,gesture:it.gesture,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null},Fe===null?(ce=Fe=at,B=S):Fe=Fe.next=at,An.lanes|=Dt,ke|=Dt;it=it.next}while(it!==null&&it!==t);if(Fe===null?B=S:Fe.next=ce,!Uo(S,e.memoizedState)&&(jo=!0,wt&&(a=x,a!==null)))throw a;e.memoizedState=S,e.baseState=B,e.baseQueue=Fe,u.lastRenderedState=S}return h===null&&(u.lanes=0),[e.memoizedState,u.dispatch]}function ec(e){var t=Or(),a=t.queue;if(a===null)throw Error(s(311));a.lastRenderedReducer=e;var u=a.dispatch,h=a.pending,S=t.memoizedState;if(h!==null){a.pending=null;var B=h=h.next;do S=e(S,B.action),B=B.next;while(B!==h);Uo(S,t.memoizedState)||(jo=!0),t.memoizedState=S,t.baseQueue===null&&(t.baseState=S),a.lastRenderedState=S}return[S,u]}function Oc(e,t,a){var u=An,h=Or(),S=On;if(S){if(a===void 0)throw Error(s(407));a=a()}else a=t();var B=!Uo((Dn||h).memoizedState,a);if(B&&(h.memoizedState=a,jo=!0),h=h.queue,vl(uu.bind(null,u,h,e),[e]),h.getSnapshot!==t||B||Zi!==null&&Zi.memoizedState.tag&1){if(u.flags|=2048,rl(9,{destroy:void 0},Fc.bind(null,u,h,a,t),null),g===null)throw Error(s(349));S||(Ki&127)!==0||nl(u,t,a)}return a}function nl(e,t,a){e.flags|=16384,e={getSnapshot:t,value:a},t=An.updateQueue,t===null?(t=hc(),An.updateQueue=t,t.stores=[e]):(a=t.stores,a===null?t.stores=[e]:a.push(e))}function Fc(e,t,a,u){t.value=a,t.getSnapshot=u,Sd(t)&&ml(e)}function uu(e,t,a){return a(function(){Sd(t)&&ml(e)})}function Sd(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!Uo(e,a)}catch{return!0}}function ml(e){var t=dl(e,2);t!==null&&Wn(t,e,2)}function bl(e){var t=so();if(typeof e=="function"){var a=e;if(e=a(),Sa){et(!0);try{a()}finally{et(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Is,lastRenderedState:e},t}function gc(e,t,a,u){return e.baseState=a,tl(e,Dn,typeof u=="function"?u:Is)}function ed(e,t,a,u,h){if(nc(e))throw Error(s(485));if(e=t.action,e!==null){var S={payload:h,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(B){S.listeners.push(B)}};ee.T!==null?a(!0):S.isTransition=!1,u(S),a=t.pending,a===null?(S.next=t.pending=S,td(t,S)):(S.next=a.next,t.pending=a.next=S)}}function td(e,t){var a=t.action,u=t.payload,h=e.state;if(t.isTransition){var S=ee.T,B={};ee.T=B;try{var ce=a(h,u),Fe=ee.S;Fe!==null&&Fe(B,ce),Uc(e,t,ce)}catch(it){Ls(e,t,it)}finally{S!==null&&B.types!==null&&(S.types=B.types),ee.T=S}}else try{S=a(h,u),Uc(e,t,S)}catch(it){Ls(e,t,it)}}function Uc(e,t,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(u){nd(e,t,u)},function(u){return Ls(e,t,u)}):nd(e,t,a)}function nd(e,t,a){t.status="fulfilled",t.value=a,Ec(t),e.state=a,t=e.pending,t!==null&&(a=t.next,a===t?e.pending=null:(a=a.next,t.next=a,td(e,a)))}function Ls(e,t,a){var u=e.pending;if(e.pending=null,u!==null){u=u.next;do t.status="rejected",t.reason=a,Ec(t),t=t.next;while(t!==u)}e.action=null}function Ec(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Vc(e,t){return t}function il(e,t){if(On){var a=g.formState;if(a!==null){e:{var u=An;if(On){if(Br){t:{for(var h=Br,S=ao;h.nodeType!==8;){if(!S){h=null;break t}if(h=ac(h.nextSibling),h===null){h=null;break t}}S=h.data,h=S==="F!"||S==="F"?h:null}if(h){Br=ac(h.nextSibling),u=h.data==="F!";break e}}ma(u)}u=!1}u&&(t=a[0])}}return a=so(),a.memoizedState=a.baseState=t,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vc,lastRenderedState:t},a.queue=u,a=yp.bind(null,An,u),u.dispatch=a,u=bl(!1),S=du.bind(null,An,!1,u.queue),u=so(),h={state:t,dispatch:null,action:e,pending:null},u.queue=h,a=ed.bind(null,An,h,S,a),h.dispatch=a,u.memoizedState=e,[t,a,!1]}function Ms(e){var t=Or();return Bs(t,Dn,e)}function Bs(e,t,a){if(t=tl(e,t,Vc)[0],e=cu(Is)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var u=xl(t)}catch(B){throw B===Ee?fe:B}else u=t;t=Or();var h=t.queue,S=h.dispatch;return a!==t.memoizedState&&(An.flags|=2048,rl(9,{destroy:void 0},Rl.bind(null,h,a),null)),[u,S,e]}function Rl(e,t){e.action=t}function yc(e){var t=Or(),a=Dn;if(a!==null)return Bs(t,a,e);Or(),t=t.memoizedState,a=Or();var u=a.queue.dispatch;return a.memoizedState=e,[t,u,!1]}function rl(e,t,a,u){return e={tag:e,create:a,deps:u,inst:t,next:null},t=An.updateQueue,t===null&&(t=hc(),An.updateQueue=t),a=t.lastEffect,a===null?t.lastEffect=e.next=e:(u=a.next,a.next=e,e.next=u,t.lastEffect=e),e}function Td(){return Or().memoizedState}function ol(e,t,a,u){var h=so();An.flags|=e,h.memoizedState=rl(1|t,{destroy:void 0},a,u===void 0?null:u)}function qc(e,t,a,u){var h=Or();u=u===void 0?null:u;var S=h.memoizedState.inst;Dn!==null&&u!==null&&Bc(u,Dn.memoizedState.deps)?h.memoizedState=rl(t,S,a,u):(An.flags|=e,h.memoizedState=rl(1|t,S,a,u))}function Hc(e,t){ol(8390656,8,e,t)}function vl(e,t){qc(2048,8,e,t)}function tc(e){An.flags|=4;var t=An.updateQueue;if(t===null)t=hc(),An.updateQueue=t,t.events=[e];else{var a=t.events;a===null?t.events=[e]:a.push(e)}}function Il(e){var t=Or().memoizedState;return tc({ref:t,nextImpl:e}),function(){if((c&2)!==0)throw Error(s(440));return t.impl.apply(void 0,arguments)}}function sp(e,t){return qc(4,2,e,t)}function lp(e,t){return qc(4,4,e,t)}function cp(e,t){if(typeof t=="function"){e=e();var a=t(e);return function(){typeof a=="function"?a():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function up(e,t,a){a=a!=null?a.concat([e]):null,qc(4,4,cp.bind(null,t,e),a)}function xf(){}function dp(e,t){var a=Or();t=t===void 0?null:t;var u=a.memoizedState;return t!==null&&Bc(t,u[1])?u[0]:(a.memoizedState=[e,t],e)}function mf(e,t){var a=Or();t=t===void 0?null:t;var u=a.memoizedState;if(t!==null&&Bc(t,u[1]))return u[0];if(u=e(),Sa){et(!0);try{e()}finally{et(!1)}}return a.memoizedState=[u,t],u}function Cd(e,t,a){return a===void 0||(Ki&1073741824)!==0&&(L&261930)===0?e.memoizedState=t:(e.memoizedState=a,e=Xn(),An.lanes|=e,ke|=e,a)}function Ll(e,t,a,u){return Uo(a,t)?a:si.current!==null?(e=Cd(e,a,u),Uo(e,t)||(jo=!0),e):(Ki&42)===0||(Ki&1073741824)!==0&&(L&261930)===0?(jo=!0,e.memoizedState=a):(e=Xn(),An.lanes|=e,ke|=e,t)}function bf(e,t,a,u,h){var S=de.p;de.p=S!==0&&8>S?S:8;var B=ee.T,ce={};ee.T=ce,du(e,!1,t,a);try{var Fe=h(),it=ee.S;if(it!==null&&it(ce,Fe),Fe!==null&&typeof Fe=="object"&&typeof Fe.then=="function"){var wt=X(Fe,u);id(e,t,wt,vn(e))}else id(e,t,u,vn(e))}catch(Dt){id(e,t,{then:function(){},status:"rejected",reason:Dt},vn())}finally{de.p=S,B!==null&&ce.types!==null&&(B.types=ce.types),ee.T=B}}function kh(){}function vf(e,t,a,u){if(e.tag!==5)throw Error(s(476));var h=fp(e).queue;bf(e,h,t,Ne,a===null?kh:function(){return pp(e),a(u)})}function fp(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:Ne,baseState:Ne,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Is,lastRenderedState:Ne},next:null};var a={};return t.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Is,lastRenderedState:a},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function pp(e){var t=fp(e);t.next===null&&(t=e.alternate.memoizedState),id(e,t.next.queue,{},vn())}function wf(){return qi(Vf)}function hp(){return Or().memoizedState}function gp(){return Or().memoizedState}function Ah(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var a=vn();e=Gn(a);var u=ei(t,e,a);u!==null&&(Wn(u,t,a),wr(u,t,a)),t={cache:Co()},e.payload=t;return}t=t.return}}function Ph(e,t,a){var u=vn();a={lane:u,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},nc(e)?fu(t,a):(a=Do(e,t,a,u),a!==null&&(Wn(a,e,u),rd(a,t,u)))}function yp(e,t,a){var u=vn();id(e,t,a,u)}function id(e,t,a,u){var h={lane:u,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null};if(nc(e))fu(t,h);else{var S=e.alternate;if(e.lanes===0&&(S===null||S.lanes===0)&&(S=t.lastRenderedReducer,S!==null))try{var B=t.lastRenderedState,ce=S(B,a);if(h.hasEagerState=!0,h.eagerState=ce,Uo(ce,B))return io(e,t,h,0),g===null&&Mr(),!1}catch{}finally{}if(a=Do(e,t,h,u),a!==null)return Wn(a,e,u),rd(a,t,u),!0}return!1}function du(e,t,a,u){if(u={lane:2,revertLane:Oh(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},nc(e)){if(t)throw Error(s(479))}else t=Do(e,a,u,2),t!==null&&Wn(t,e,2)}function nc(e){var t=e.alternate;return e===An||t!==null&&t===An}function fu(e,t){Ts=wa=!0;var a=e.pending;a===null?t.next=t:(t.next=a.next,a.next=t),e.pending=t}function rd(e,t,a){if((a&4194048)!==0){var u=t.lanes;u&=e.pendingLanes,a|=u,t.lanes=a,fr(e,a)}}var xc={readContext:qi,use:_l,useCallback:Ir,useContext:Ir,useEffect:Ir,useImperativeHandle:Ir,useLayoutEffect:Ir,useInsertionEffect:Ir,useMemo:Ir,useReducer:Ir,useRef:Ir,useState:Ir,useDebugValue:Ir,useDeferredValue:Ir,useTransition:Ir,useSyncExternalStore:Ir,useId:Ir,useHostTransitionStatus:Ir,useFormState:Ir,useActionState:Ir,useOptimistic:Ir,useMemoCache:Ir,useCacheRefresh:Ir};xc.useEffectEvent=Ir;var jd={readContext:qi,use:_l,useCallback:function(e,t){return so().memoizedState=[e,t===void 0?null:t],e},useContext:qi,useEffect:Hc,useImperativeHandle:function(e,t,a){a=a!=null?a.concat([e]):null,ol(4194308,4,cp.bind(null,t,e),a)},useLayoutEffect:function(e,t){return ol(4194308,4,e,t)},useInsertionEffect:function(e,t){ol(4,2,e,t)},useMemo:function(e,t){var a=so();t=t===void 0?null:t;var u=e();if(Sa){et(!0);try{e()}finally{et(!1)}}return a.memoizedState=[u,t],u},useReducer:function(e,t,a){var u=so();if(a!==void 0){var h=a(t);if(Sa){et(!0);try{a(t)}finally{et(!1)}}}else h=t;return u.memoizedState=u.baseState=h,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:h},u.queue=e,e=e.dispatch=Ph.bind(null,An,e),[u.memoizedState,e]},useRef:function(e){var t=so();return e={current:e},t.memoizedState=e},useState:function(e){e=bl(e);var t=e.queue,a=yp.bind(null,An,t);return t.dispatch=a,[e.memoizedState,a]},useDebugValue:xf,useDeferredValue:function(e,t){var a=so();return Cd(a,e,t)},useTransition:function(){var e=bl(!1);return e=bf.bind(null,An,e.queue,!0,!1),so().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,a){var u=An,h=so();if(On){if(a===void 0)throw Error(s(407));a=a()}else{if(a=t(),g===null)throw Error(s(349));(L&127)!==0||nl(u,t,a)}h.memoizedState=a;var S={value:a,getSnapshot:t};return h.queue=S,Hc(uu.bind(null,u,S,e),[e]),u.flags|=2048,rl(9,{destroy:void 0},Fc.bind(null,u,S,a,t),null),a},useId:function(){var e=so(),t=g.identifierPrefix;if(On){var a=Ro,u=So;a=(u&~(1<<32-Pt(u)-1)).toString(32)+a,t="_"+t+"R_"+a,a=yr++,0<a&&(t+="H"+a.toString(32)),t+="_"}else a=Mc++,t="_"+t+"r_"+a.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:wf,useFormState:il,useActionState:il,useOptimistic:function(e){var t=so();t.memoizedState=t.baseState=e;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=a,t=du.bind(null,An,!0,a),a.dispatch=t,[e,t]},useMemoCache:Dl,useCacheRefresh:function(){return so().memoizedState=Ah.bind(null,An)},useEffectEvent:function(e){var t=so(),a={impl:e};return t.memoizedState=a,function(){if((c&2)!==0)throw Error(s(440));return a.impl.apply(void 0,arguments)}}},pu={readContext:qi,use:_l,useCallback:dp,useContext:qi,useEffect:vl,useImperativeHandle:up,useInsertionEffect:sp,useLayoutEffect:lp,useMemo:mf,useReducer:cu,useRef:Td,useState:function(){return cu(Is)},useDebugValue:xf,useDeferredValue:function(e,t){var a=Or();return Ll(a,Dn.memoizedState,e,t)},useTransition:function(){var e=cu(Is)[0],t=Or().memoizedState;return[typeof e=="boolean"?e:xl(e),t]},useSyncExternalStore:Oc,useId:hp,useHostTransitionStatus:wf,useFormState:Ms,useActionState:Ms,useOptimistic:function(e,t){var a=Or();return gc(a,Dn,e,t)},useMemoCache:Dl,useCacheRefresh:gp};pu.useEffectEvent=Il;var ku={readContext:qi,use:_l,useCallback:dp,useContext:qi,useEffect:vl,useImperativeHandle:up,useInsertionEffect:sp,useLayoutEffect:lp,useMemo:mf,useReducer:ec,useRef:Td,useState:function(){return ec(Is)},useDebugValue:xf,useDeferredValue:function(e,t){var a=Or();return Dn===null?Cd(a,e,t):Ll(a,Dn.memoizedState,e,t)},useTransition:function(){var e=ec(Is)[0],t=Or().memoizedState;return[typeof e=="boolean"?e:xl(e),t]},useSyncExternalStore:Oc,useId:hp,useHostTransitionStatus:wf,useFormState:yc,useActionState:yc,useOptimistic:function(e,t){var a=Or();return Dn!==null?gc(a,Dn,e,t):(a.baseState=e,[e,a.queue.dispatch])},useMemoCache:Dl,useCacheRefresh:gp};ku.useEffectEvent=Il;function hu(e,t,a,u){t=e.memoizedState,a=a(u,t),a=a==null?t:_({},t,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var Au={enqueueSetState:function(e,t,a){e=e._reactInternals;var u=vn(),h=Gn(u);h.payload=t,a!=null&&(h.callback=a),t=ei(e,h,u),t!==null&&(Wn(t,e,u),wr(t,e,u))},enqueueReplaceState:function(e,t,a){e=e._reactInternals;var u=vn(),h=Gn(u);h.tag=1,h.payload=t,a!=null&&(h.callback=a),t=ei(e,h,u),t!==null&&(Wn(t,e,u),wr(t,e,u))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var a=vn(),u=Gn(a);u.tag=2,t!=null&&(u.callback=t),t=ei(e,u,a),t!==null&&(Wn(t,e,a),wr(t,e,a))}};function od(e,t,a,u,h,S,B){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(u,S,B):t.prototype&&t.prototype.isPureReactComponent?!ga(a,u)||!ga(h,S):!0}function xp(e,t,a,u){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(a,u),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(a,u),t.state!==e&&Au.enqueueReplaceState(t,t.state,null)}function mc(e,t){var a=t;if("ref"in t){a={};for(var u in t)u!=="ref"&&(a[u]=t[u])}if(e=e.defaultProps){a===t&&(a=_({},a));for(var h in e)a[h]===void 0&&(a[h]=e[h])}return a}function Ml(e){no(e)}function Nd(e){console.error(e)}function mp(e){no(e)}function kd(e,t){try{var a=e.onUncaughtError;a(t.value,{componentStack:t.stack})}catch(u){setTimeout(function(){throw u})}}function bc(e,t,a){try{var u=e.onCaughtError;u(a.value,{componentStack:a.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(h){setTimeout(function(){throw h})}}function Sf(e,t,a){return a=Gn(a),a.tag=3,a.payload={element:null},a.callback=function(){kd(e,t)},a}function Ad(e){return e=Gn(e),e.tag=3,e}function Tf(e,t,a,u){var h=a.type.getDerivedStateFromError;if(typeof h=="function"){var S=u.value;e.payload=function(){return h(S)},e.callback=function(){bc(t,a,u)}}var B=a.stateNode;B!==null&&typeof B.componentDidCatch=="function"&&(e.callback=function(){bc(t,a,u),typeof h!="function"&&(Vt===null?Vt=new Set([this]):Vt.add(this));var ce=u.stack;this.componentDidCatch(u.value,{componentStack:ce!==null?ce:""})})}function Cf(e,t,a,u,h){if(a.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(t=a.alternate,t!==null&&Ya(t,a,h,!0),a=Oi.current,a!==null){switch(a.tag){case 31:case 13:return ci===null?Pp():a.alternate===null&&Pe===0&&(Pe=3),a.flags&=-257,a.flags|=65536,a.lanes=h,u===Re?a.flags|=16384:(t=a.updateQueue,t===null?a.updateQueue=new Set([u]):t.add(u),Lh(e,u,h)),!1;case 22:return a.flags|=65536,u===Re?a.flags|=16384:(t=a.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([u])},a.updateQueue=t):(a=t.retryQueue,a===null?t.retryQueue=new Set([u]):a.add(u)),Lh(e,u,h)),!1}throw Error(s(435,a.tag))}return Lh(e,u,h),Pp(),!1}if(On)return t=Oi.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=h,u!==xa&&(e=Error(s(422),{cause:u}),Lc(ms(e,a)))):(u!==xa&&(t=Error(s(423),{cause:u}),Lc(ms(t,a))),e=e.current.alternate,e.flags|=65536,h&=-h,e.lanes|=h,u=ms(u,a),h=Sf(e.stateNode,u,h),Ho(e,h),Pe!==4&&(Pe=2)),!1;var S=Error(s(520),{cause:u});if(S=ms(S,a),Ue===null?Ue=[S]:Ue.push(S),Pe!==4&&(Pe=2),t===null)return!0;u=ms(u,a),a=t;do{switch(a.tag){case 3:return a.flags|=65536,e=h&-h,a.lanes|=e,e=Sf(a.stateNode,u,e),Ho(a,e),!1;case 1:if(t=a.type,S=a.stateNode,(a.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Vt===null||!Vt.has(S))))return a.flags|=65536,h&=-h,a.lanes|=h,h=Ad(h),Tf(h,e,a,u),Ho(a,h),!1}a=a.return}while(a!==null);return!1}var Pu=Error(s(461)),jo=!1;function aa(e,t,a,u){t.child=e===null?Jn(t,null,a,u):Fi(t,e.child,a,u)}function bp(e,t,a,u,h){a=a.render;var S=t.ref;if("ref"in u){var B={};for(var ce in u)ce!=="ref"&&(B[ce]=u[ce])}else B=u;return Ga(t),u=Nu(e,t,a,B,S,h),ce=zl(),e!==null&&!jo?(lu(e,t,h),Ol(e,t,h)):(On&&ce&&Pl(t),t.flags|=1,aa(e,t,u,h),t.child)}function Pd(e,t,a,u,h){if(e===null){var S=a.type;return typeof S=="function"&&!Dc(S)&&S.defaultProps===void 0&&a.compare===null?(t.tag=15,t.type=S,zd(e,t,S,u,h)):(e=fl(a.type,null,u,t,t.mode,h),e.ref=t.ref,e.return=t,t.child=e)}if(S=e.child,!Ld(e,h)){var B=S.memoizedProps;if(a=a.compare,a=a!==null?a:ga,a(B,u)&&e.ref===t.ref)return Ol(e,t,h)}return t.flags|=1,e=br(S,u),e.ref=t.ref,e.return=t,t.child=e}function zd(e,t,a,u,h){if(e!==null){var S=e.memoizedProps;if(ga(S,u)&&e.ref===t.ref)if(jo=!1,t.pendingProps=u=S,Ld(e,h))(e.flags&131072)!==0&&(jo=!0);else return t.lanes=e.lanes,Ol(e,t,h)}return Dd(e,t,a,u,h)}function vp(e,t,a,u){var h=u.children,S=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((t.flags&128)!==0){if(S=S!==null?S.baseLanes|a:a,e!==null){for(u=t.child=e.child,h=0;u!==null;)h=h|u.lanes|u.childLanes,u=u.sibling;u=h&~S}else u=0,t.child=null;return Os(e,t,S,a,u)}if((a&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&he(t,S!==null?S.cachePool:null),S!==null?lr(t,S):cr(),ur(t);else return u=t.lanes=536870912,Os(e,t,S!==null?S.baseLanes|a:a,a,u)}else S!==null?(he(t,S.cachePool),lr(t,S),Kr(),t.memoizedState=null):(e!==null&&he(t,null),cr(),Kr());return aa(e,t,h,a),t.child}function ad(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Os(e,t,a,u,h){var S=le();return S=S===null?null:{parent:Hi._currentValue,pool:S},t.memoizedState={baseLanes:a,cachePool:S},e!==null&&he(t,null),cr(),ur(t),e!==null&&Ya(e,t,u,!0),t.childLanes=h,null}function _d(e,t){return t=sd({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function Bl(e,t,a){return Fi(t,e.child,null,a),e=_d(t,t.pendingProps),e.flags|=2,ir(t),t.memoizedState=null,e}function wp(e,t,a){var u=t.pendingProps,h=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(On){if(u.mode==="hidden")return e=_d(t,u),t.lanes=536870912,ad(null,e);if(Pi(t),(e=Br)?(e=H0(e,ao),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:$a!==null?{id:So,overflow:Ro}:null,retryLane:536870912,hydrationErrors:null},a=na(e),a.return=t,t.child=a,vr=t,Br=null)):e=null,e===null)throw ma(t);return t.lanes=536870912,null}return _d(t,u)}var S=e.memoizedState;if(S!==null){var B=S.dehydrated;if(Pi(t),h)if(t.flags&256)t.flags&=-257,t=Bl(e,t,a);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(s(558));else if(jo||Ya(e,t,a,!1),h=(a&e.childLanes)!==0,jo||h){if(u=g,u!==null&&(B=zr(u,a),B!==0&&B!==S.retryLane))throw S.retryLane=B,dl(e,B),Wn(u,e,B),Pu;Pp(),t=Bl(e,t,a)}else e=S.treeContext,Br=ac(B.nextSibling),vr=t,On=!0,Vo=null,ao=!1,e!==null&&Zu(t,e),t=_d(t,u),t.flags|=4096;return t}return e=br(e.child,{mode:u.mode,children:u.children}),e.ref=t.ref,t.child=e,e.return=t,e}function vc(e,t){var a=t.ref;if(a===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(s(284));(e===null||e.ref!==a)&&(t.flags|=4194816)}}function Dd(e,t,a,u,h){return Ga(t),a=Nu(e,t,a,u,void 0,h),u=zl(),e!==null&&!jo?(lu(e,t,h),Ol(e,t,h)):(On&&u&&Pl(t),t.flags|=1,aa(e,t,a,h),t.child)}function wc(e,t,a,u,h,S){return Ga(t),t.updateQueue=null,a=La(t,u,a,h),Ql(e),u=zl(),e!==null&&!jo?(lu(e,t,S),Ol(e,t,S)):(On&&u&&Pl(t),t.flags|=1,aa(e,t,a,S),t.child)}function Rd(e,t,a,u,h){if(Ga(t),t.stateNode===null){var S=Yr,B=a.contextType;typeof B=="object"&&B!==null&&(S=qi(B)),S=new a(u,S),t.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,S.updater=Au,t.stateNode=S,S._reactInternals=t,S=t.stateNode,S.props=u,S.state=t.memoizedState,S.refs={},Ut(t),B=a.contextType,S.context=typeof B=="object"&&B!==null?qi(B):Yr,S.state=t.memoizedState,B=a.getDerivedStateFromProps,typeof B=="function"&&(hu(t,a,B,u),S.state=t.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(B=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),B!==S.state&&Au.enqueueReplaceState(S,S.state,null),nr(t,u,S,h),fi(),S.state=t.memoizedState),typeof S.componentDidMount=="function"&&(t.flags|=4194308),u=!0}else if(e===null){S=t.stateNode;var ce=t.memoizedProps,Fe=mc(a,ce);S.props=Fe;var it=S.context,wt=a.contextType;B=Yr,typeof wt=="object"&&wt!==null&&(B=qi(wt));var Dt=a.getDerivedStateFromProps;wt=typeof Dt=="function"||typeof S.getSnapshotBeforeUpdate=="function",ce=t.pendingProps!==ce,wt||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(ce||it!==B)&&xp(t,S,u,B),un=!1;var at=t.memoizedState;S.state=at,nr(t,u,S,h),fi(),it=t.memoizedState,ce||at!==it||un?(typeof Dt=="function"&&(hu(t,a,Dt,u),it=t.memoizedState),(Fe=un||od(t,a,Fe,u,at,it,B))?(wt||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(t.flags|=4194308)):(typeof S.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=u,t.memoizedState=it),S.props=u,S.state=it,S.context=B,u=Fe):(typeof S.componentDidMount=="function"&&(t.flags|=4194308),u=!1)}else{S=t.stateNode,Qn(e,t),B=t.memoizedProps,wt=mc(a,B),S.props=wt,Dt=t.pendingProps,at=S.context,it=a.contextType,Fe=Yr,typeof it=="object"&&it!==null&&(Fe=qi(it)),ce=a.getDerivedStateFromProps,(it=typeof ce=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(B!==Dt||at!==Fe)&&xp(t,S,u,Fe),un=!1,at=t.memoizedState,S.state=at,nr(t,u,S,h),fi();var ft=t.memoizedState;B!==Dt||at!==ft||un||e!==null&&e.dependencies!==null&&To(e.dependencies)?(typeof ce=="function"&&(hu(t,a,ce,u),ft=t.memoizedState),(wt=un||od(t,a,wt,u,at,ft,Fe)||e!==null&&e.dependencies!==null&&To(e.dependencies))?(it||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(u,ft,Fe),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(u,ft,Fe)),typeof S.componentDidUpdate=="function"&&(t.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof S.componentDidUpdate!="function"||B===e.memoizedProps&&at===e.memoizedState||(t.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||B===e.memoizedProps&&at===e.memoizedState||(t.flags|=1024),t.memoizedProps=u,t.memoizedState=ft),S.props=u,S.state=ft,S.context=Fe,u=wt):(typeof S.componentDidUpdate!="function"||B===e.memoizedProps&&at===e.memoizedState||(t.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||B===e.memoizedProps&&at===e.memoizedState||(t.flags|=1024),u=!1)}return S=u,vc(e,t),u=(t.flags&128)!==0,S||u?(S=t.stateNode,a=u&&typeof a.getDerivedStateFromError!="function"?null:S.render(),t.flags|=1,e!==null&&u?(t.child=Fi(t,e.child,null,h),t.child=Fi(t,null,a,h)):aa(e,t,a,h),t.memoizedState=S.state,e=t.child):e=Ol(e,t,h),e}function jf(e,t,a,u){return Js(),t.flags|=256,aa(e,t,a,u),t.child}var Id={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Nf(e){return{baseLanes:e,cachePool:Te()}}function kf(e,t,a){return e=e!==null?e.childLanes&~a:0,t&&(e|=ye),e}function Sp(e,t,a){var u=t.pendingProps,h=!1,S=(t.flags&128)!==0,B;if((B=S)||(B=e!==null&&e.memoizedState===null?!1:(Ui.current&2)!==0),B&&(h=!0,t.flags&=-129),B=(t.flags&32)!==0,t.flags&=-33,e===null){if(On){if(h?Li(t):Kr(),(e=Br)?(e=H0(e,ao),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:$a!==null?{id:So,overflow:Ro}:null,retryLane:536870912,hydrationErrors:null},a=na(e),a.return=t,t.child=a,vr=t,Br=null)):e=null,e===null)throw ma(t);return Zh(e)?t.lanes=32:t.lanes=536870912,null}var ce=u.children;return u=u.fallback,h?(Kr(),h=t.mode,ce=sd({mode:"hidden",children:ce},h),u=oo(u,h,a,null),ce.return=t,u.return=t,ce.sibling=u,t.child=ce,u=t.child,u.memoizedState=Nf(a),u.childLanes=kf(e,B,a),t.memoizedState=Id,ad(null,u)):(Li(t),zu(t,ce))}var Fe=e.memoizedState;if(Fe!==null&&(ce=Fe.dehydrated,ce!==null)){if(S)t.flags&256?(Li(t),t.flags&=-257,t=Af(e,t,a)):t.memoizedState!==null?(Kr(),t.child=e.child,t.flags|=128,t=null):(Kr(),ce=u.fallback,h=t.mode,u=sd({mode:"visible",children:u.children},h),ce=oo(ce,h,a,null),ce.flags|=2,u.return=t,ce.return=t,u.sibling=ce,t.child=u,Fi(t,e.child,null,a),u=t.child,u.memoizedState=Nf(a),u.childLanes=kf(e,B,a),t.memoizedState=Id,t=ad(null,u));else if(Li(t),Zh(ce)){if(B=ce.nextSibling&&ce.nextSibling.dataset,B)var it=B.dgst;B=it,u=Error(s(419)),u.stack="",u.digest=B,Lc({value:u,source:null,stack:null}),t=Af(e,t,a)}else if(jo||Ya(e,t,a,!1),B=(a&e.childLanes)!==0,jo||B){if(B=g,B!==null&&(u=zr(B,a),u!==0&&u!==Fe.retryLane))throw Fe.retryLane=u,dl(e,u),Wn(B,e,u),Pu;Kh(ce)||Pp(),t=Af(e,t,a)}else Kh(ce)?(t.flags|=192,t.child=e.child,t=null):(e=Fe.treeContext,Br=ac(ce.nextSibling),vr=t,On=!0,Vo=null,ao=!1,e!==null&&Zu(t,e),t=zu(t,u.children),t.flags|=4096);return t}return h?(Kr(),ce=u.fallback,h=t.mode,Fe=e.child,it=Fe.sibling,u=br(Fe,{mode:"hidden",children:u.children}),u.subtreeFlags=Fe.subtreeFlags&65011712,it!==null?ce=br(it,ce):(ce=oo(ce,h,a,null),ce.flags|=2),ce.return=t,u.return=t,u.sibling=ce,t.child=u,ad(null,u),u=t.child,ce=e.child.memoizedState,ce===null?ce=Nf(a):(h=ce.cachePool,h!==null?(Fe=Hi._currentValue,h=h.parent!==Fe?{parent:Fe,pool:Fe}:h):h=Te(),ce={baseLanes:ce.baseLanes|a,cachePool:h}),u.memoizedState=ce,u.childLanes=kf(e,B,a),t.memoizedState=Id,ad(e.child,u)):(Li(t),a=e.child,e=a.sibling,a=br(a,{mode:"visible",children:u.children}),a.return=t,a.sibling=null,e!==null&&(B=t.deletions,B===null?(t.deletions=[e],t.flags|=16):B.push(e)),t.child=a,t.memoizedState=null,a)}function zu(e,t){return t=sd({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function sd(e,t){return e=Ai(22,e,null,t),e.lanes=0,e}function Af(e,t,a){return Fi(t,e.child,null,a),e=zu(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Pf(e,t,a){e.lanes|=t;var u=e.alternate;u!==null&&(u.lanes|=t),pc(e.return,t,a)}function gu(e,t,a,u,h,S){var B=e.memoizedState;B===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:u,tail:a,tailMode:h,treeForkCount:S}:(B.isBackwards=t,B.rendering=null,B.renderingStartTime=0,B.last=u,B.tail=a,B.tailMode=h,B.treeForkCount=S)}function Tp(e,t,a){var u=t.pendingProps,h=u.revealOrder,S=u.tail;u=u.children;var B=Ui.current,ce=(B&2)!==0;if(ce?(B=B&1|2,t.flags|=128):B&=1,V(Ui,B),aa(e,t,u,a),u=On?Al:0,!ce&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Pf(e,a,t);else if(e.tag===19)Pf(e,a,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(h){case"forwards":for(a=t.child,h=null;a!==null;)e=a.alternate,e!==null&&Ia(e)===null&&(h=a),a=a.sibling;a=h,a===null?(h=t.child,t.child=null):(h=a.sibling,a.sibling=null),gu(t,!1,h,a,S,u);break;case"backwards":case"unstable_legacy-backwards":for(a=null,h=t.child,t.child=null;h!==null;){if(e=h.alternate,e!==null&&Ia(e)===null){t.child=h;break}e=h.sibling,h.sibling=a,a=h,h=e}gu(t,!0,a,null,S,u);break;case"together":gu(t,!1,null,null,void 0,u);break;default:t.memoizedState=null}return t.child}function Ol(e,t,a){if(e!==null&&(t.dependencies=e.dependencies),ke|=t.lanes,(a&t.childLanes)===0)if(e!==null){if(Ya(e,t,a,!1),(a&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(s(153));if(t.child!==null){for(e=t.child,a=br(e,e.pendingProps),t.child=a,a.return=t;e.sibling!==null;)e=e.sibling,a=a.sibling=br(e,e.pendingProps),a.return=t;a.sibling=null}return t.child}function Ld(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&To(e)))}function zf(e,t,a){switch(t.tag){case 3:ze(t,t.stateNode.containerInfo),yl(t,Hi,e.memoizedState.cache),Js();break;case 27:case 5:De(t);break;case 4:ze(t,t.stateNode.containerInfo);break;case 10:yl(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,Pi(t),null;break;case 13:var u=t.memoizedState;if(u!==null)return u.dehydrated!==null?(Li(t),t.flags|=128,null):(a&t.child.childLanes)!==0?Sp(e,t,a):(Li(t),e=Ol(e,t,a),e!==null?e.sibling:null);Li(t);break;case 19:var h=(e.flags&128)!==0;if(u=(a&t.childLanes)!==0,u||(Ya(e,t,a,!1),u=(a&t.childLanes)!==0),h){if(u)return Tp(e,t,a);t.flags|=128}if(h=t.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),V(Ui,Ui.current),u)break;return null;case 22:return t.lanes=0,vp(e,t,a,t.pendingProps);case 24:yl(t,Hi,e.memoizedState.cache)}return Ol(e,t,a)}function Md(e,t,a){if(e!==null)if(e.memoizedProps!==t.pendingProps)jo=!0;else{if(!Ld(e,a)&&(t.flags&128)===0)return jo=!1,zf(e,t,a);jo=(e.flags&131072)!==0}else jo=!1,On&&(t.flags&1048576)!==0&&au(t,Al,t.index);switch(t.lanes=0,t.tag){case 16:e:{var u=t.pendingProps;if(e=Qe(t.elementType),t.type=e,typeof e=="function")Dc(e)?(u=mc(e,u),t.tag=1,t=Rd(null,t,e,u,a)):(t.tag=0,t=Dd(null,t,e,u,a));else{if(e!=null){var h=e.$$typeof;if(h===U){t.tag=11,t=bp(null,t,e,u,a);break e}else if(h===G){t.tag=14,t=Pd(null,t,e,u,a);break e}}throw t=$(e)||e,Error(s(306,t,""))}}return t;case 0:return Dd(e,t,t.type,t.pendingProps,a);case 1:return u=t.type,h=mc(u,t.pendingProps),Rd(e,t,u,h,a);case 3:e:{if(ze(t,t.stateNode.containerInfo),e===null)throw Error(s(387));u=t.pendingProps;var S=t.memoizedState;h=S.element,Qn(e,t),nr(t,u,null,a);var B=t.memoizedState;if(u=B.cache,yl(t,Hi,u),u!==S.cache&&Jl(t,[Hi],a,!0),fi(),u=B.element,S.isDehydrated)if(S={element:u,isDehydrated:!1,cache:B.cache},t.updateQueue.baseState=S,t.memoizedState=S,t.flags&256){t=jf(e,t,u,a);break e}else if(u!==h){h=ms(Error(s(424)),t),Lc(h),t=jf(e,t,u,a);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Br=ac(e.firstChild),vr=t,On=!0,Vo=null,ao=!0,a=Jn(t,null,u,a),t.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling}else{if(Js(),u===h){t=Ol(e,t,a);break e}aa(e,t,u,a)}t=t.child}return t;case 26:return vc(e,t),e===null?(a=K0(t.type,null,t.pendingProps,null))?t.memoizedState=a:On||(a=t.type,e=t.pendingProps,u=Mp(ve.current).createElement(a),u[ut]=t,u[Et]=e,As(u,a,e),qn(u),t.stateNode=u):t.memoizedState=K0(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return De(t),e===null&&On&&(u=t.stateNode=Y0(t.type,t.pendingProps,ve.current),vr=t,ao=!0,h=Br,Mu(t.type)?(Jh=h,Br=ac(u.firstChild)):Br=h),aa(e,t,t.pendingProps.children,a),vc(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&On&&((h=u=Br)&&(u=Am(u,t.type,t.pendingProps,ao),u!==null?(t.stateNode=u,vr=t,Br=ac(u.firstChild),ao=!1,h=!0):h=!1),h||ma(t)),De(t),h=t.type,S=t.pendingProps,B=e!==null?e.memoizedProps:null,u=S.children,Yh(h,S)?u=null:B!==null&&Yh(h,B)&&(t.flags|=32),t.memoizedState!==null&&(h=Nu(e,t,Qu,null,null,a),Vf._currentValue=h),vc(e,t),aa(e,t,u,a),t.child;case 6:return e===null&&On&&((e=a=Br)&&(a=Pm(a,t.pendingProps,ao),a!==null?(t.stateNode=a,vr=t,Br=null,e=!0):e=!1),e||ma(t)),null;case 13:return Sp(e,t,a);case 4:return ze(t,t.stateNode.containerInfo),u=t.pendingProps,e===null?t.child=Fi(t,null,u,a):aa(e,t,u,a),t.child;case 11:return bp(e,t,t.type,t.pendingProps,a);case 7:return aa(e,t,t.pendingProps,a),t.child;case 8:return aa(e,t,t.pendingProps.children,a),t.child;case 12:return aa(e,t,t.pendingProps.children,a),t.child;case 10:return u=t.pendingProps,yl(t,t.type,u.value),aa(e,t,u.children,a),t.child;case 9:return h=t.type._context,u=t.pendingProps.children,Ga(t),h=qi(h),u=u(h),t.flags|=1,aa(e,t,u,a),t.child;case 14:return Pd(e,t,t.type,t.pendingProps,a);case 15:return zd(e,t,t.type,t.pendingProps,a);case 19:return Tp(e,t,a);case 31:return wp(e,t,a);case 22:return vp(e,t,a,t.pendingProps);case 24:return Ga(t),u=qi(Hi),e===null?(h=le(),h===null&&(h=g,S=Co(),h.pooledCache=S,S.refCount++,S!==null&&(h.pooledCacheLanes|=a),h=S),t.memoizedState={parent:u,cache:h},Ut(t),yl(t,Hi,h)):((e.lanes&a)!==0&&(Qn(e,t),nr(t,null,null,a),fi()),h=e.memoizedState,S=t.memoizedState,h.parent!==u?(h={parent:u,cache:u},t.memoizedState=h,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=h),yl(t,Hi,u)):(u=S.cache,yl(t,Hi,u),u!==h.cache&&Jl(t,[Hi],a,!0))),aa(e,t,t.pendingProps.children,a),t.child;case 29:throw t.pendingProps}throw Error(s(156,t.tag))}function Sc(e){e.flags|=4}function _f(e,t,a,u,h){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(h&335544128)===h)if(e.stateNode.complete)e.flags|=8192;else if(li())e.flags|=8192;else throw yt=Re,Xe}else e.flags&=-16777217}function Bd(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!t1(t))if(li())e.flags|=8192;else throw yt=Re,Xe}function Wc(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?Bi():536870912,e.lanes|=t,Ce|=t)}function yu(e,t){if(!On)switch(e.tailMode){case"hidden":t=e.tail;for(var a=null;t!==null;)t.alternate!==null&&(a=t),t=t.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var u=null;a!==null;)a.alternate!==null&&(u=a),a=a.sibling;u===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:u.sibling=null}}function Sr(e){var t=e.alternate!==null&&e.alternate.child===e.child,a=0,u=0;if(t)for(var h=e.child;h!==null;)a|=h.lanes|h.childLanes,u|=h.subtreeFlags&65011712,u|=h.flags&65011712,h.return=e,h=h.sibling;else for(h=e.child;h!==null;)a|=h.lanes|h.childLanes,u|=h.subtreeFlags,u|=h.flags,h.return=e,h=h.sibling;return e.subtreeFlags|=u,e.childLanes=a,t}function zh(e,t,a){var u=t.pendingProps;switch(vs(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Sr(t),null;case 1:return Sr(t),null;case 3:return a=t.stateNode,u=null,e!==null&&(u=e.memoizedState.cache),t.memoizedState.cache!==u&&(t.flags|=2048),Ss(Hi),xe(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(Gr(t)?Sc(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,ws())),Sr(t),null;case 26:var h=t.type,S=t.memoizedState;return e===null?(Sc(t),S!==null?(Sr(t),Bd(t,S)):(Sr(t),_f(t,h,null,u,a))):S?S!==e.memoizedState?(Sc(t),Sr(t),Bd(t,S)):(Sr(t),t.flags&=-16777217):(e=e.memoizedProps,e!==u&&Sc(t),Sr(t),_f(t,h,e,u,a)),null;case 27:if(Ye(t),a=ve.current,h=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==u&&Sc(t);else{if(!u){if(t.stateNode===null)throw Error(s(166));return Sr(t),null}e=H.current,Gr(t)?Ic(t):(e=Y0(h,u,a),t.stateNode=e,Sc(t))}return Sr(t),null;case 5:if(Ye(t),h=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==u&&Sc(t);else{if(!u){if(t.stateNode===null)throw Error(s(166));return Sr(t),null}if(S=H.current,Gr(t))Ic(t);else{var B=Mp(ve.current);switch(S){case 1:S=B.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:S=B.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":S=B.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":S=B.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":S=B.createElement("div"),S.innerHTML="<script><\/script>",S=S.removeChild(S.firstChild);break;case"select":S=typeof u.is=="string"?B.createElement("select",{is:u.is}):B.createElement("select"),u.multiple?S.multiple=!0:u.size&&(S.size=u.size);break;default:S=typeof u.is=="string"?B.createElement(h,{is:u.is}):B.createElement(h)}}S[ut]=t,S[Et]=u;e:for(B=t.child;B!==null;){if(B.tag===5||B.tag===6)S.appendChild(B.stateNode);else if(B.tag!==4&&B.tag!==27&&B.child!==null){B.child.return=B,B=B.child;continue}if(B===t)break e;for(;B.sibling===null;){if(B.return===null||B.return===t)break e;B=B.return}B.sibling.return=B.return,B=B.sibling}t.stateNode=S;e:switch(As(S,h,u),h){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&Sc(t)}}return Sr(t),_f(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,a),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==u&&Sc(t);else{if(typeof u!="string"&&t.stateNode===null)throw Error(s(166));if(e=ve.current,Gr(t)){if(e=t.stateNode,a=t.memoizedProps,u=null,h=vr,h!==null)switch(h.tag){case 27:case 5:u=h.memoizedProps}e[ut]=t,e=!!(e.nodeValue===a||u!==null&&u.suppressHydrationWarning===!0||M0(e.nodeValue,a)),e||ma(t,!0)}else e=Mp(e).createTextNode(u),e[ut]=t,t.stateNode=e}return Sr(t),null;case 31:if(a=t.memoizedState,e===null||e.memoizedState!==null){if(u=Gr(t),a!==null){if(e===null){if(!u)throw Error(s(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(557));e[ut]=t}else Js(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Sr(t),e=!1}else a=ws(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=a),e=!0;if(!e)return t.flags&256?(ir(t),t):(ir(t),null);if((t.flags&128)!==0)throw Error(s(558))}return Sr(t),null;case 13:if(u=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(h=Gr(t),u!==null&&u.dehydrated!==null){if(e===null){if(!h)throw Error(s(318));if(h=t.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(s(317));h[ut]=t}else Js(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Sr(t),h=!1}else h=ws(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=h),h=!0;if(!h)return t.flags&256?(ir(t),t):(ir(t),null)}return ir(t),(t.flags&128)!==0?(t.lanes=a,t):(a=u!==null,e=e!==null&&e.memoizedState!==null,a&&(u=t.child,h=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(h=u.alternate.memoizedState.cachePool.pool),S=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(S=u.memoizedState.cachePool.pool),S!==h&&(u.flags|=2048)),a!==e&&a&&(t.child.flags|=8192),Wc(t,t.updateQueue),Sr(t),null);case 4:return xe(),e===null&&Vh(t.stateNode.containerInfo),Sr(t),null;case 10:return Ss(t.type),Sr(t),null;case 19:if(w(Ui),u=t.memoizedState,u===null)return Sr(t),null;if(h=(t.flags&128)!==0,S=u.rendering,S===null)if(h)yu(u,!1);else{if(Pe!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(S=Ia(e),S!==null){for(t.flags|=128,yu(u,!1),e=S.updateQueue,t.updateQueue=e,Wc(t,e),t.subtreeFlags=0,e=a,a=t.child;a!==null;)ro(a,e),a=a.sibling;return V(Ui,Ui.current&1|2),On&&Da(t,u.treeForkCount),t.child}e=e.sibling}u.tail!==null&&Sn()>It&&(t.flags|=128,h=!0,yu(u,!1),t.lanes=4194304)}else{if(!h)if(e=Ia(S),e!==null){if(t.flags|=128,h=!0,e=e.updateQueue,t.updateQueue=e,Wc(t,e),yu(u,!0),u.tail===null&&u.tailMode==="hidden"&&!S.alternate&&!On)return Sr(t),null}else 2*Sn()-u.renderingStartTime>It&&a!==536870912&&(t.flags|=128,h=!0,yu(u,!1),t.lanes=4194304);u.isBackwards?(S.sibling=t.child,t.child=S):(e=u.last,e!==null?e.sibling=S:t.child=S,u.last=S)}return u.tail!==null?(e=u.tail,u.rendering=e,u.tail=e.sibling,u.renderingStartTime=Sn(),e.sibling=null,a=Ui.current,V(Ui,h?a&1|2:a&1),On&&Da(t,u.treeForkCount),e):(Sr(t),null);case 22:case 23:return ir(t),Xr(),u=t.memoizedState!==null,e!==null?e.memoizedState!==null!==u&&(t.flags|=8192):u&&(t.flags|=8192),u?(a&536870912)!==0&&(t.flags&128)===0&&(Sr(t),t.subtreeFlags&6&&(t.flags|=8192)):Sr(t),a=t.updateQueue,a!==null&&Wc(t,a.retryQueue),a=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),u=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(u=t.memoizedState.cachePool.pool),u!==a&&(t.flags|=2048),e!==null&&w(re),null;case 24:return a=null,e!==null&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),Ss(Hi),Sr(t),null;case 25:return null;case 30:return null}throw Error(s(156,t.tag))}function Tc(e,t){switch(vs(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ss(Hi),xe(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Ye(t),null;case 31:if(t.memoizedState!==null){if(ir(t),t.alternate===null)throw Error(s(340));Js()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(ir(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(s(340));Js()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return w(Ui),null;case 4:return xe(),null;case 10:return Ss(t.type),null;case 22:case 23:return ir(t),Xr(),e!==null&&w(re),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Ss(Hi),null;case 25:return null;default:return null}}function _u(e,t){switch(vs(t),t.tag){case 3:Ss(Hi),xe();break;case 26:case 27:case 5:Ye(t);break;case 4:xe();break;case 31:t.memoizedState!==null&&ir(t);break;case 13:ir(t);break;case 19:w(Ui);break;case 10:Ss(t.type);break;case 22:case 23:ir(t),Xr(),e!==null&&w(re);break;case 24:Ss(Hi)}}function xu(e,t){try{var a=t.updateQueue,u=a!==null?a.lastEffect:null;if(u!==null){var h=u.next;a=h;do{if((a.tag&e)===e){u=void 0;var S=a.create,B=a.inst;u=S(),B.destroy=u}a=a.next}while(a!==h)}}catch(ce){qr(t,t.return,ce)}}function ic(e,t,a){try{var u=t.updateQueue,h=u!==null?u.lastEffect:null;if(h!==null){var S=h.next;u=S;do{if((u.tag&e)===e){var B=u.inst,ce=B.destroy;if(ce!==void 0){B.destroy=void 0,h=t;var Fe=a,it=ce;try{it()}catch(wt){qr(h,Fe,wt)}}}u=u.next}while(u!==S)}}catch(wt){qr(t,t.return,wt)}}function Od(e){var t=e.updateQueue;if(t!==null){var a=e.stateNode;try{Er(t,a)}catch(u){qr(e,e.return,u)}}}function ls(e,t,a){a.props=mc(e.type,e.memoizedProps),a.state=e.memoizedState;try{a.componentWillUnmount()}catch(u){qr(e,t,u)}}function Du(e,t){try{var a=e.ref;if(a!==null){switch(e.tag){case 26:case 27:case 5:var u=e.stateNode;break;case 30:u=e.stateNode;break;default:u=e.stateNode}typeof a=="function"?e.refCleanup=a(u):a.current=u}}catch(h){qr(e,t,h)}}function Fl(e,t){var a=e.ref,u=e.refCleanup;if(a!==null)if(typeof u=="function")try{u()}catch(h){qr(e,t,h)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(h){qr(e,t,h)}else a.current=null}function Cp(e){var t=e.type,a=e.memoizedProps,u=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":a.autoFocus&&u.focus();break e;case"img":a.src?u.src=a.src:a.srcSet&&(u.srcset=a.srcSet)}}catch(h){qr(e,e.return,h)}}function Fd(e,t,a){try{var u=e.stateNode;Sm(u,e.type,a,t),u[Et]=t}catch(h){qr(e,e.return,h)}}function jp(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Mu(e.type)||e.tag===4}function Ud(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||jp(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Mu(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ed(e,t,a){var u=e.tag;if(u===5||u===6)e=e.stateNode,t?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(e,t):(t=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,t.appendChild(e),a=a._reactRootContainer,a!=null||t.onclick!==null||(t.onclick=jr));else if(u!==4&&(u===27&&Mu(e.type)&&(a=e.stateNode,t=null),e=e.child,e!==null))for(Ed(e,t,a),e=e.sibling;e!==null;)Ed(e,t,a),e=e.sibling}function mu(e,t,a){var u=e.tag;if(u===5||u===6)e=e.stateNode,t?a.insertBefore(e,t):a.appendChild(e);else if(u!==4&&(u===27&&Mu(e.type)&&(a=e.stateNode),e=e.child,e!==null))for(mu(e,t,a),e=e.sibling;e!==null;)mu(e,t,a),e=e.sibling}function rc(e){var t=e.stateNode,a=e.memoizedProps;try{for(var u=e.type,h=t.attributes;h.length;)t.removeAttributeNode(h[0]);As(t,u,a),t[ut]=e,t[Et]=a}catch(S){qr(e,e.return,S)}}var Ul=!1,sa=!1,Df=!1,Np=typeof WeakSet=="function"?WeakSet:Set,Ta=null;function Vd(e,t){if(e=e.containerInfo,Wh=qp,e=jl(e),bo(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{a=(a=e.ownerDocument)&&a.defaultView||window;var u=a.getSelection&&a.getSelection();if(u&&u.rangeCount!==0){a=u.anchorNode;var h=u.anchorOffset,S=u.focusNode;u=u.focusOffset;try{a.nodeType,S.nodeType}catch{a=null;break e}var B=0,ce=-1,Fe=-1,it=0,wt=0,Dt=e,at=null;t:for(;;){for(var ft;Dt!==a||h!==0&&Dt.nodeType!==3||(ce=B+h),Dt!==S||u!==0&&Dt.nodeType!==3||(Fe=B+u),Dt.nodeType===3&&(B+=Dt.nodeValue.length),(ft=Dt.firstChild)!==null;)at=Dt,Dt=ft;for(;;){if(Dt===e)break t;if(at===a&&++it===h&&(ce=B),at===S&&++wt===u&&(Fe=B),(ft=Dt.nextSibling)!==null)break;Dt=at,at=Dt.parentNode}Dt=ft}a=ce===-1||Fe===-1?null:{start:ce,end:Fe}}else a=null}a=a||{start:0,end:0}}else a=null;for($h={focusedElem:e,selectionRange:a},qp=!1,Ta=t;Ta!==null;)if(t=Ta,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ta=e;else for(;Ta!==null;){switch(t=Ta,S=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(a=0;a<e.length;a++)h=e[a],h.ref.impl=h.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&S!==null){e=void 0,a=t,h=S.memoizedProps,S=S.memoizedState,u=a.stateNode;try{var jn=mc(a.type,h);e=u.getSnapshotBeforeUpdate(jn,S),u.__reactInternalSnapshotBeforeUpdate=e}catch(ii){qr(a,a.return,ii)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,a=e.nodeType,a===9)Xh(e);else if(a===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Xh(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(s(163))}if(e=t.sibling,e!==null){e.return=t.return,Ta=e;break}Ta=t.return}}function bu(e,t,a){var u=a.flags;switch(a.tag){case 0:case 11:case 15:jc(e,a),u&4&&xu(5,a);break;case 1:if(jc(e,a),u&4)if(e=a.stateNode,t===null)try{e.componentDidMount()}catch(B){qr(a,a.return,B)}else{var h=mc(a.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(h,t,e.__reactInternalSnapshotBeforeUpdate)}catch(B){qr(a,a.return,B)}}u&64&&Od(a),u&512&&Du(a,a.return);break;case 3:if(jc(e,a),u&64&&(e=a.updateQueue,e!==null)){if(t=null,a.child!==null)switch(a.child.tag){case 27:case 5:t=a.child.stateNode;break;case 1:t=a.child.stateNode}try{Er(e,t)}catch(B){qr(a,a.return,B)}}break;case 27:t===null&&u&4&&rc(a);case 26:case 5:jc(e,a),t===null&&u&4&&Cp(a),u&512&&Du(a,a.return);break;case 12:jc(e,a);break;case 31:jc(e,a),u&4&&ld(e,a);break;case 13:jc(e,a),u&4&&cd(e,a),u&64&&(e=a.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(a=um.bind(null,a),zm(e,a))));break;case 22:if(u=a.memoizedState!==null||Ul,!u){t=t!==null&&t.memoizedState!==null||sa,h=Ul;var S=sa;Ul=u,(sa=t)&&!S?El(e,a,(a.subtreeFlags&8772)!==0):jc(e,a),Ul=h,sa=S}break;case 30:break;default:jc(e,a)}}function qd(e){var t=e.alternate;t!==null&&(e.alternate=null,qd(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&mi(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Nr=null,js=!1;function Cc(e,t,a){for(a=a.child;a!==null;)kp(e,t,a),a=a.sibling}function kp(e,t,a){if(st&&typeof st.onCommitFiberUnmount=="function")try{st.onCommitFiberUnmount(we,a)}catch{}switch(a.tag){case 26:sa||Fl(a,t),Cc(e,t,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:sa||Fl(a,t);var u=Nr,h=js;Mu(a.type)&&(Nr=a.stateNode,js=!1),Cc(e,t,a),Ff(a.stateNode),Nr=u,js=h;break;case 5:sa||Fl(a,t);case 6:if(u=Nr,h=js,Nr=null,Cc(e,t,a),Nr=u,js=h,Nr!==null)if(js)try{(Nr.nodeType===9?Nr.body:Nr.nodeName==="HTML"?Nr.ownerDocument.body:Nr).removeChild(a.stateNode)}catch(S){qr(a,t,S)}else try{Nr.removeChild(a.stateNode)}catch(S){qr(a,t,S)}break;case 18:Nr!==null&&(js?(e=Nr,V0(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,a.stateNode),Qd(e)):V0(Nr,a.stateNode));break;case 4:u=Nr,h=js,Nr=a.stateNode.containerInfo,js=!0,Cc(e,t,a),Nr=u,js=h;break;case 0:case 11:case 14:case 15:ic(2,a,t),sa||ic(4,a,t),Cc(e,t,a);break;case 1:sa||(Fl(a,t),u=a.stateNode,typeof u.componentWillUnmount=="function"&&ls(a,t,u)),Cc(e,t,a);break;case 21:Cc(e,t,a);break;case 22:sa=(u=sa)||a.memoizedState!==null,Cc(e,t,a),sa=u;break;default:Cc(e,t,a)}}function ld(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Qd(e)}catch(a){qr(t,t.return,a)}}}function cd(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Qd(e)}catch(a){qr(t,t.return,a)}}function _h(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new Np),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new Np),t;default:throw Error(s(435,e.tag))}}function Hd(e,t){var a=_h(e);t.forEach(function(u){if(!a.has(u)){a.add(u);var h=dm.bind(null,e,u);u.then(h,h)}})}function Ma(e,t){var a=t.deletions;if(a!==null)for(var u=0;u<a.length;u++){var h=a[u],S=e,B=t,ce=B;e:for(;ce!==null;){switch(ce.tag){case 27:if(Mu(ce.type)){Nr=ce.stateNode,js=!1;break e}break;case 5:Nr=ce.stateNode,js=!1;break e;case 3:case 4:Nr=ce.stateNode.containerInfo,js=!0;break e}ce=ce.return}if(Nr===null)throw Error(s(160));kp(S,B,h),Nr=null,js=!1,S=h.alternate,S!==null&&(S.return=null),h.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)Ap(t,e),t=t.sibling}var Ns=null;function Ap(e,t){var a=e.alternate,u=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Ma(t,e),ks(e),u&4&&(ic(3,e,e.return),xu(3,e),ic(5,e,e.return));break;case 1:Ma(t,e),ks(e),u&512&&(sa||a===null||Fl(a,a.return)),u&64&&Ul&&(e=e.updateQueue,e!==null&&(u=e.callbacks,u!==null&&(a=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=a===null?u:a.concat(u))));break;case 26:var h=Ns;if(Ma(t,e),ks(e),u&512&&(sa||a===null||Fl(a,a.return)),u&4){var S=a!==null?a.memoizedState:null;if(u=e.memoizedState,a===null)if(u===null)if(e.stateNode===null){e:{u=e.type,a=e.memoizedProps,h=h.ownerDocument||h;t:switch(u){case"title":S=h.getElementsByTagName("title")[0],(!S||S[mr]||S[ut]||S.namespaceURI==="http://www.w3.org/2000/svg"||S.hasAttribute("itemprop"))&&(S=h.createElement(u),h.head.insertBefore(S,h.querySelector("head > title"))),As(S,u,a),S[ut]=e,qn(S),u=S;break e;case"link":var B=Q0("link","href",h).get(u+(a.href||""));if(B){for(var ce=0;ce<B.length;ce++)if(S=B[ce],S.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&S.getAttribute("rel")===(a.rel==null?null:a.rel)&&S.getAttribute("title")===(a.title==null?null:a.title)&&S.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){B.splice(ce,1);break t}}S=h.createElement(u),As(S,u,a),h.head.appendChild(S);break;case"meta":if(B=Q0("meta","content",h).get(u+(a.content||""))){for(ce=0;ce<B.length;ce++)if(S=B[ce],S.getAttribute("content")===(a.content==null?null:""+a.content)&&S.getAttribute("name")===(a.name==null?null:a.name)&&S.getAttribute("property")===(a.property==null?null:a.property)&&S.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&S.getAttribute("charset")===(a.charSet==null?null:a.charSet)){B.splice(ce,1);break t}}S=h.createElement(u),As(S,u,a),h.head.appendChild(S);break;default:throw Error(s(468,u))}S[ut]=e,qn(S),u=S}e.stateNode=u}else e1(h,e.type,e.stateNode);else e.stateNode=J0(h,u,e.memoizedProps);else S!==u?(S===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):S.count--,u===null?e1(h,e.type,e.stateNode):J0(h,u,e.memoizedProps)):u===null&&e.stateNode!==null&&Fd(e,e.memoizedProps,a.memoizedProps)}break;case 27:Ma(t,e),ks(e),u&512&&(sa||a===null||Fl(a,a.return)),a!==null&&u&4&&Fd(e,e.memoizedProps,a.memoizedProps);break;case 5:if(Ma(t,e),ks(e),u&512&&(sa||a===null||Fl(a,a.return)),e.flags&32){h=e.stateNode;try{Di(h,"")}catch(jn){qr(e,e.return,jn)}}u&4&&e.stateNode!=null&&(h=e.memoizedProps,Fd(e,h,a!==null?a.memoizedProps:h)),u&1024&&(Df=!0);break;case 6:if(Ma(t,e),ks(e),u&4){if(e.stateNode===null)throw Error(s(162));u=e.memoizedProps,a=e.stateNode;try{a.nodeValue=u}catch(jn){qr(e,e.return,jn)}}break;case 3:if(Fp=null,h=Ns,Ns=Bp(t.containerInfo),Ma(t,e),Ns=h,ks(e),u&4&&a!==null&&a.memoizedState.isDehydrated)try{Qd(t.containerInfo)}catch(jn){qr(e,e.return,jn)}Df&&(Df=!1,Wd(e));break;case 4:u=Ns,Ns=Bp(e.stateNode.containerInfo),Ma(t,e),ks(e),Ns=u;break;case 12:Ma(t,e),ks(e);break;case 31:Ma(t,e),ks(e),u&4&&(u=e.updateQueue,u!==null&&(e.updateQueue=null,Hd(e,u)));break;case 13:Ma(t,e),ks(e),e.child.flags&8192&&e.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(bt=Sn()),u&4&&(u=e.updateQueue,u!==null&&(e.updateQueue=null,Hd(e,u)));break;case 22:h=e.memoizedState!==null;var Fe=a!==null&&a.memoizedState!==null,it=Ul,wt=sa;if(Ul=it||h,sa=wt||Fe,Ma(t,e),sa=wt,Ul=it,ks(e),u&8192)e:for(t=e.stateNode,t._visibility=h?t._visibility&-2:t._visibility|1,h&&(a===null||Fe||Ul||sa||$c(e)),a=null,t=e;;){if(t.tag===5||t.tag===26){if(a===null){Fe=a=t;try{if(S=Fe.stateNode,h)B=S.style,typeof B.setProperty=="function"?B.setProperty("display","none","important"):B.display="none";else{ce=Fe.stateNode;var Dt=Fe.memoizedProps.style,at=Dt!=null&&Dt.hasOwnProperty("display")?Dt.display:null;ce.style.display=at==null||typeof at=="boolean"?"":(""+at).trim()}}catch(jn){qr(Fe,Fe.return,jn)}}}else if(t.tag===6){if(a===null){Fe=t;try{Fe.stateNode.nodeValue=h?"":Fe.memoizedProps}catch(jn){qr(Fe,Fe.return,jn)}}}else if(t.tag===18){if(a===null){Fe=t;try{var ft=Fe.stateNode;h?q0(ft,!0):q0(Fe.stateNode,!1)}catch(jn){qr(Fe,Fe.return,jn)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;a===t&&(a=null),t=t.return}a===t&&(a=null),t.sibling.return=t.return,t=t.sibling}u&4&&(u=e.updateQueue,u!==null&&(a=u.retryQueue,a!==null&&(u.retryQueue=null,Hd(e,a))));break;case 19:Ma(t,e),ks(e),u&4&&(u=e.updateQueue,u!==null&&(e.updateQueue=null,Hd(e,u)));break;case 30:break;case 21:break;default:Ma(t,e),ks(e)}}function ks(e){var t=e.flags;if(t&2){try{for(var a,u=e.return;u!==null;){if(jp(u)){a=u;break}u=u.return}if(a==null)throw Error(s(160));switch(a.tag){case 27:var h=a.stateNode,S=Ud(e);mu(e,S,h);break;case 5:var B=a.stateNode;a.flags&32&&(Di(B,""),a.flags&=-33);var ce=Ud(e);mu(e,ce,B);break;case 3:case 4:var Fe=a.stateNode.containerInfo,it=Ud(e);Ed(e,it,Fe);break;default:throw Error(s(161))}}catch(wt){qr(e,e.return,wt)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Wd(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;Wd(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function jc(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)bu(e,t.alternate,t),t=t.sibling}function $c(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:ic(4,t,t.return),$c(t);break;case 1:Fl(t,t.return);var a=t.stateNode;typeof a.componentWillUnmount=="function"&&ls(t,t.return,a),$c(t);break;case 27:Ff(t.stateNode);case 26:case 5:Fl(t,t.return),$c(t);break;case 22:t.memoizedState===null&&$c(t);break;case 30:$c(t);break;default:$c(t)}e=e.sibling}}function El(e,t,a){for(a=a&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var u=t.alternate,h=e,S=t,B=S.flags;switch(S.tag){case 0:case 11:case 15:El(h,S,a),xu(4,S);break;case 1:if(El(h,S,a),u=S,h=u.stateNode,typeof h.componentDidMount=="function")try{h.componentDidMount()}catch(it){qr(u,u.return,it)}if(u=S,h=u.updateQueue,h!==null){var ce=u.stateNode;try{var Fe=h.shared.hiddenCallbacks;if(Fe!==null)for(h.shared.hiddenCallbacks=null,h=0;h<Fe.length;h++)yo(Fe[h],ce)}catch(it){qr(u,u.return,it)}}a&&B&64&&Od(S),Du(S,S.return);break;case 27:rc(S);case 26:case 5:El(h,S,a),a&&u===null&&B&4&&Cp(S),Du(S,S.return);break;case 12:El(h,S,a);break;case 31:El(h,S,a),a&&B&4&&ld(h,S);break;case 13:El(h,S,a),a&&B&4&&cd(h,S);break;case 22:S.memoizedState===null&&El(h,S,a),Du(S,S.return);break;case 30:break;default:El(h,S,a)}t=t.sibling}}function ud(e,t){var a=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==a&&(e!=null&&e.refCount++,a!=null&&oa(a))}function Rf(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&oa(e))}function Vl(e,t,a,u){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)oc(e,t,a,u),t=t.sibling}function oc(e,t,a,u){var h=t.flags;switch(t.tag){case 0:case 11:case 15:Vl(e,t,a,u),h&2048&&xu(9,t);break;case 1:Vl(e,t,a,u);break;case 3:Vl(e,t,a,u),h&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&oa(e)));break;case 12:if(h&2048){Vl(e,t,a,u),e=t.stateNode;try{var S=t.memoizedProps,B=S.id,ce=S.onPostCommit;typeof ce=="function"&&ce(B,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(Fe){qr(t,t.return,Fe)}}else Vl(e,t,a,u);break;case 31:Vl(e,t,a,u);break;case 13:Vl(e,t,a,u);break;case 23:break;case 22:S=t.stateNode,B=t.alternate,t.memoizedState!==null?S._visibility&2?Vl(e,t,a,u):Yc(e,t):S._visibility&2?Vl(e,t,a,u):(S._visibility|=2,ql(e,t,a,u,(t.subtreeFlags&10256)!==0||!1)),h&2048&&ud(B,t);break;case 24:Vl(e,t,a,u),h&2048&&Rf(t.alternate,t);break;default:Vl(e,t,a,u)}}function ql(e,t,a,u,h){for(h=h&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var S=e,B=t,ce=a,Fe=u,it=B.flags;switch(B.tag){case 0:case 11:case 15:ql(S,B,ce,Fe,h),xu(8,B);break;case 23:break;case 22:var wt=B.stateNode;B.memoizedState!==null?wt._visibility&2?ql(S,B,ce,Fe,h):Yc(S,B):(wt._visibility|=2,ql(S,B,ce,Fe,h)),h&&it&2048&&ud(B.alternate,B);break;case 24:ql(S,B,ce,Fe,h),h&&it&2048&&Rf(B.alternate,B);break;default:ql(S,B,ce,Fe,h)}t=t.sibling}}function Yc(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var a=e,u=t,h=u.flags;switch(u.tag){case 22:Yc(a,u),h&2048&&ud(u.alternate,u);break;case 24:Yc(a,u),h&2048&&Rf(u.alternate,u);break;default:Yc(a,u)}t=t.sibling}}var dd=8192;function Ru(e,t,a){if(e.subtreeFlags&dd)for(e=e.child;e!==null;)$d(e,t,a),e=e.sibling}function $d(e,t,a){switch(e.tag){case 26:Ru(e,t,a),e.flags&dd&&e.memoizedState!==null&&Vm(a,Ns,e.memoizedState,e.memoizedProps);break;case 5:Ru(e,t,a);break;case 3:case 4:var u=Ns;Ns=Bp(e.stateNode.containerInfo),Ru(e,t,a),Ns=u;break;case 22:e.memoizedState===null&&(u=e.alternate,u!==null&&u.memoizedState!==null?(u=dd,dd=16777216,Ru(e,t,a),dd=u):Ru(e,t,a));break;default:Ru(e,t,a)}}function Yd(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Iu(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var a=0;a<t.length;a++){var u=t[a];Ta=u,Lf(u,e)}Yd(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)If(e),e=e.sibling}function If(e){switch(e.tag){case 0:case 11:case 15:Iu(e),e.flags&2048&&ic(9,e,e.return);break;case 3:Iu(e);break;case 12:Iu(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,on(e)):Iu(e);break;default:Iu(e)}}function on(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var a=0;a<t.length;a++){var u=t[a];Ta=u,Lf(u,e)}Yd(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:ic(8,t,t.return),on(t);break;case 22:a=t.stateNode,a._visibility&2&&(a._visibility&=-3,on(t));break;default:on(t)}e=e.sibling}}function Lf(e,t){for(;Ta!==null;){var a=Ta;switch(a.tag){case 0:case 11:case 15:ic(8,a,t);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var u=a.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:oa(a.memoizedState.cache)}if(u=a.child,u!==null)u.return=a,Ta=u;else e:for(a=e;Ta!==null;){u=Ta;var h=u.sibling,S=u.return;if(qd(u),u===a){Ta=null;break e}if(h!==null){h.return=S,Ta=h;break e}Ta=S}}}var Dh={getCacheForType:function(e){var t=qi(Hi),a=t.data.get(e);return a===void 0&&(a=e(),t.data.set(e,a)),a},cacheSignal:function(){return qi(Hi).controller.signal}},Rh=typeof WeakMap=="function"?WeakMap:Map,c=0,g=null,A=null,L=0,K=0,oe=null,z=!1,Ae=!1,Se=!1,_e=0,Pe=0,ke=0,me=0,be=0,ye=0,Ce=0,Ue=null,Le=null,Ze=!1,bt=0,jt=0,It=1/0,rt=null,Vt=null,Oe=0,qe=null,We=null,ot=0,ct=0,Lt=null,Kt=null,sn=0,Hn=null;function vn(){return(c&2)!==0&&L!==0?L&-L:ee.T!==null?Oh():Yn()}function Xn(){if(ye===0)if((L&536870912)===0||On){var e=tn;tn<<=1,(tn&3932160)===0&&(tn=262144),ye=e}else ye=536870912;return e=Oi.current,e!==null&&(e.flags|=32),ye}function Wn(e,t,a){(e===g&&(K===2||K===9)||e.cancelPendingCommit!==null)&&(lo(e,0),Wi(e,L,ye,!1)),nn(e,a),((c&2)===0||e!==g)&&(e===g&&((c&2)===0&&(me|=a),Pe===4&&Wi(e,L,ye,!1)),Gc(e))}function Rn(e,t,a){if((c&6)!==0)throw Error(s(327));var u=!a&&(t&127)===0&&(t&e.expiredLanes)===0||Go(e,t),h=u?sm(e,t):Ih(e,t,!0),S=u;do{if(h===0){Ae&&!u&&Wi(e,t,0,!1);break}else{if(a=e.current.alternate,S&&!In(a)){h=Ih(e,t,!1),S=!1;continue}if(h===2){if(S=t,e.errorRecoveryDisabledLanes&S)var B=0;else B=e.pendingLanes&-536870913,B=B!==0?B:B&536870912?536870912:0;if(B!==0){t=B;e:{var ce=e;h=Ue;var Fe=ce.current.memoizedState.isDehydrated;if(Fe&&(lo(ce,B).flags|=256),B=Ih(ce,B,!1),B!==2){if(Se&&!Fe){ce.errorRecoveryDisabledLanes|=S,me|=S,h=4;break e}S=Le,Le=h,S!==null&&(Le===null?Le=S:Le.push.apply(Le,S))}h=B}if(S=!1,h!==2)continue}}if(h===1){lo(e,0),Wi(e,t,0,!0);break}e:{switch(u=e,S=h,S){case 0:case 1:throw Error(s(345));case 4:if((t&4194048)!==t)break;case 6:Wi(u,t,ye,!z);break e;case 2:Le=null;break;case 3:case 5:break;default:throw Error(s(329))}if((t&62914560)===t&&(h=bt+300-Sn(),10<h)){if(Wi(u,t,ye,!z),ti(u,0,!0)!==0)break e;ot=t,u.timeoutHandle=U0(Ht.bind(null,u,a,Le,rt,Ze,t,ye,me,Ce,z,S,"Throttled",-0,0),h);break e}Ht(u,a,Le,rt,Ze,t,ye,me,Ce,z,S,null,-0,0)}}break}while(!0);Gc(e)}function Ht(e,t,a,u,h,S,B,ce,Fe,it,wt,Dt,at,ft){if(e.timeoutHandle=-1,Dt=t.subtreeFlags,Dt&8192||(Dt&16785408)===16785408){Dt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:jr},$d(t,S,Dt);var jn=(S&62914560)===S?bt-Sn():(S&4194048)===S?jt-Sn():0;if(jn=qm(Dt,jn),jn!==null){ot=S,e.cancelPendingCommit=jn(m0.bind(null,e,t,S,a,u,h,B,ce,Fe,wt,Dt,null,at,ft)),Wi(e,S,B,!it);return}}m0(e,t,S,a,u,h,B,ce,Fe)}function In(e){for(var t=e;;){var a=t.tag;if((a===0||a===11||a===15)&&t.flags&16384&&(a=t.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var u=0;u<a.length;u++){var h=a[u],S=h.getSnapshot;h=h.value;try{if(!Uo(S(),h))return!1}catch{return!1}}if(a=t.child,t.subtreeFlags&16384&&a!==null)a.return=t,t=a;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Wi(e,t,a,u){t&=~be,t&=~me,e.suspendedLanes|=t,e.pingedLanes&=~t,u&&(e.warmLanes|=t),u=e.expirationTimes;for(var h=t;0<h;){var S=31-Pt(h),B=1<<S;u[S]=-1,h&=~B}a!==0&&hi(e,a,t)}function Vr(){return(c&6)===0?(Mf(0),!1):!0}function Fr(){if(A!==null){if(K===0)var e=A.return;else e=A,gl=Zl=null,el(e),Nt=null,bn=0,e=A;for(;e!==null;)_u(e.alternate,e),e=e.return;A=null}}function lo(e,t){var a=e.timeoutHandle;a!==-1&&(e.timeoutHandle=-1,jm(a)),a=e.cancelPendingCommit,a!==null&&(e.cancelPendingCommit=null,a()),ot=0,Fr(),g=e,A=a=br(e.current,null),L=t,K=0,oe=null,z=!1,Ae=Go(e,t),Se=!1,Ce=ye=be=me=ke=Pe=0,Le=Ue=null,Ze=!1,(t&8)!==0&&(t|=t&32);var u=e.entangledLanes;if(u!==0)for(e=e.entanglements,u&=t;0<u;){var h=31-Pt(u),S=1<<h;t|=e[h],u&=~S}return _e=t,Mr(),a}function $o(e,t){An=null,ee.H=xc,t===Ee||t===fe?(t=vt(),K=3):t===Xe?(t=vt(),K=4):K=t===Pu?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,oe=t,A===null&&(Pe=1,kd(e,ms(t,e.current)))}function li(){var e=Oi.current;return e===null?!0:(L&4194048)===L?ci===null:(L&62914560)===L||(L&536870912)!==0?e===ci:!1}function wl(){var e=ee.H;return ee.H=xc,e===null?xc:e}function al(){var e=ee.A;return ee.A=Dh,e}function Pp(){Pe=4,z||(L&4194048)!==L&&Oi.current!==null||(Ae=!0),(ke&134217727)===0&&(me&134217727)===0||g===null||Wi(g,L,ye,!1)}function Ih(e,t,a){var u=c;c|=2;var h=wl(),S=al();(g!==e||L!==t)&&(rt=null,lo(e,t)),t=!1;var B=Pe;e:do try{if(K!==0&&A!==null){var ce=A,Fe=oe;switch(K){case 8:Fr(),B=6;break e;case 3:case 2:case 9:case 6:Oi.current===null&&(t=!0);var it=K;if(K=0,oe=null,Gd(e,ce,Fe,it),a&&Ae){B=0;break e}break;default:it=K,K=0,oe=null,Gd(e,ce,Fe,it)}}am(),B=Pe;break}catch(wt){$o(e,wt)}while(!0);return t&&e.shellSuspendCounter++,gl=Zl=null,c=u,ee.H=h,ee.A=S,A===null&&(g=null,L=0,Mr()),B}function am(){for(;A!==null;)g0(A)}function sm(e,t){var a=c;c|=2;var u=wl(),h=al();g!==e||L!==t?(rt=null,It=Sn()+500,lo(e,t)):Ae=Go(e,t);e:do try{if(K!==0&&A!==null){t=A;var S=oe;t:switch(K){case 1:K=0,oe=null,Gd(e,t,S,1);break;case 2:case 9:if(Je(S)){K=0,oe=null,y0(t);break}t=function(){K!==2&&K!==9||g!==e||(K=7),Gc(e)},S.then(t,t);break e;case 3:K=7;break e;case 4:K=5;break e;case 7:Je(S)?(K=0,oe=null,y0(t)):(K=0,oe=null,Gd(e,t,S,7));break;case 5:var B=null;switch(A.tag){case 26:B=A.memoizedState;case 5:case 27:var ce=A;if(B?t1(B):ce.stateNode.complete){K=0,oe=null;var Fe=ce.sibling;if(Fe!==null)A=Fe;else{var it=ce.return;it!==null?(A=it,zp(it)):A=null}break t}}K=0,oe=null,Gd(e,t,S,5);break;case 6:K=0,oe=null,Gd(e,t,S,6);break;case 8:Fr(),Pe=6;break e;default:throw Error(s(462))}}lm();break}catch(wt){$o(e,wt)}while(!0);return gl=Zl=null,ee.H=u,ee.A=h,c=a,A!==null?0:(g=null,L=0,Mr(),Pe)}function lm(){for(;A!==null&&!ln();)g0(A)}function g0(e){var t=Md(e.alternate,e,_e);e.memoizedProps=e.pendingProps,t===null?zp(e):A=t}function y0(e){var t=e,a=t.alternate;switch(t.tag){case 15:case 0:t=wc(a,t,t.pendingProps,t.type,void 0,L);break;case 11:t=wc(a,t,t.pendingProps,t.type.render,t.ref,L);break;case 5:el(t);default:_u(a,t),t=A=ro(t,_e),t=Md(a,t,_e)}e.memoizedProps=e.pendingProps,t===null?zp(e):A=t}function Gd(e,t,a,u){gl=Zl=null,el(t),Nt=null,bn=0;var h=t.return;try{if(Cf(e,h,t,a,L)){Pe=1,kd(e,ms(a,e.current)),A=null;return}}catch(S){if(h!==null)throw A=h,S;Pe=1,kd(e,ms(a,e.current)),A=null;return}t.flags&32768?(On||u===1?e=!0:Ae||(L&536870912)!==0?e=!1:(z=e=!0,(u===2||u===9||u===3||u===6)&&(u=Oi.current,u!==null&&u.tag===13&&(u.flags|=16384))),x0(t,e)):zp(t)}function zp(e){var t=e;do{if((t.flags&32768)!==0){x0(t,z);return}e=t.return;var a=zh(t.alternate,t,_e);if(a!==null){A=a;return}if(t=t.sibling,t!==null){A=t;return}A=t=e}while(t!==null);Pe===0&&(Pe=5)}function x0(e,t){do{var a=Tc(e.alternate,e);if(a!==null){a.flags&=32767,A=a;return}if(a=e.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!t&&(e=e.sibling,e!==null)){A=e;return}A=e=a}while(e!==null);Pe=6,A=null}function m0(e,t,a,u,h,S,B,ce,Fe){e.cancelPendingCommit=null;do _p();while(Oe!==0);if((c&6)!==0)throw Error(s(327));if(t!==null){if(t===e.current)throw Error(s(177));if(S=t.lanes|t.childLanes,S|=ai,xi(e,a,S,B,ce,Fe),e===g&&(A=g=null,L=0),We=t,qe=e,ot=a,ct=S,Lt=h,Kt=u,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,fm(Gt,function(){return T0(),null})):(e.callbackNode=null,e.callbackPriority=0),u=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||u){u=ee.T,ee.T=null,h=de.p,de.p=2,B=c,c|=4;try{Vd(e,t,a)}finally{c=B,de.p=h,ee.T=u}}Oe=1,b0(),v0(),w0()}}function b0(){if(Oe===1){Oe=0;var e=qe,t=We,a=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||a){a=ee.T,ee.T=null;var u=de.p;de.p=2;var h=c;c|=4;try{Ap(t,e);var S=$h,B=jl(e.containerInfo),ce=S.focusedElem,Fe=S.selectionRange;if(B!==ce&&ce&&ce.ownerDocument&&Cl(ce.ownerDocument.documentElement,ce)){if(Fe!==null&&bo(ce)){var it=Fe.start,wt=Fe.end;if(wt===void 0&&(wt=it),"selectionStart"in ce)ce.selectionStart=it,ce.selectionEnd=Math.min(wt,ce.value.length);else{var Dt=ce.ownerDocument||document,at=Dt&&Dt.defaultView||window;if(at.getSelection){var ft=at.getSelection(),jn=ce.textContent.length,ii=Math.min(Fe.start,jn),Jr=Fe.end===void 0?ii:Math.min(Fe.end,jn);!ft.extend&&ii>Jr&&(B=Jr,Jr=ii,ii=B);var Ke=Ks(ce,ii),He=Ks(ce,Jr);if(Ke&&He&&(ft.rangeCount!==1||ft.anchorNode!==Ke.node||ft.anchorOffset!==Ke.offset||ft.focusNode!==He.node||ft.focusOffset!==He.offset)){var nt=Dt.createRange();nt.setStart(Ke.node,Ke.offset),ft.removeAllRanges(),ii>Jr?(ft.addRange(nt),ft.extend(He.node,He.offset)):(nt.setEnd(He.node,He.offset),ft.addRange(nt))}}}}for(Dt=[],ft=ce;ft=ft.parentNode;)ft.nodeType===1&&Dt.push({element:ft,left:ft.scrollLeft,top:ft.scrollTop});for(typeof ce.focus=="function"&&ce.focus(),ce=0;ce<Dt.length;ce++){var kt=Dt[ce];kt.element.scrollLeft=kt.left,kt.element.scrollTop=kt.top}}qp=!!Wh,$h=Wh=null}finally{c=h,de.p=u,ee.T=a}}e.current=t,Oe=2}}function v0(){if(Oe===2){Oe=0;var e=qe,t=We,a=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||a){a=ee.T,ee.T=null;var u=de.p;de.p=2;var h=c;c|=4;try{bu(e,t.alternate,t)}finally{c=h,de.p=u,ee.T=a}}Oe=3}}function w0(){if(Oe===4||Oe===3){Oe=0,cn();var e=qe,t=We,a=ot,u=Kt;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Oe=5:(Oe=0,We=qe=null,S0(e,e.pendingLanes));var h=e.pendingLanes;if(h===0&&(Vt=null),xt(a),t=t.stateNode,st&&typeof st.onCommitFiberRoot=="function")try{st.onCommitFiberRoot(we,t,void 0,(t.current.flags&128)===128)}catch{}if(u!==null){t=ee.T,h=de.p,de.p=2,ee.T=null;try{for(var S=e.onRecoverableError,B=0;B<u.length;B++){var ce=u[B];S(ce.value,{componentStack:ce.stack})}}finally{ee.T=t,de.p=h}}(ot&3)!==0&&_p(),Gc(e),h=e.pendingLanes,(a&261930)!==0&&(h&42)!==0?e===Hn?sn++:(sn=0,Hn=e):sn=0,Mf(0)}}function S0(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,oa(t)))}function _p(){return b0(),v0(),w0(),T0()}function T0(){if(Oe!==5)return!1;var e=qe,t=ct;ct=0;var a=xt(ot),u=ee.T,h=de.p;try{de.p=32>a?32:a,ee.T=null,a=Lt,Lt=null;var S=qe,B=ot;if(Oe=0,We=qe=null,ot=0,(c&6)!==0)throw Error(s(331));var ce=c;if(c|=4,If(S.current),oc(S,S.current,B,a),c=ce,Mf(0,!1),st&&typeof st.onPostCommitFiberRoot=="function")try{st.onPostCommitFiberRoot(we,S)}catch{}return!0}finally{de.p=h,ee.T=u,S0(e,t)}}function C0(e,t,a){t=ms(a,t),t=Sf(e.stateNode,t,2),e=ei(e,t,2),e!==null&&(nn(e,2),Gc(e))}function qr(e,t,a){if(e.tag===3)C0(e,e,a);else for(;t!==null;){if(t.tag===3){C0(t,e,a);break}else if(t.tag===1){var u=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Vt===null||!Vt.has(u))){e=ms(a,e),a=Ad(2),u=ei(t,a,2),u!==null&&(Tf(a,u,t,e),nn(u,2),Gc(u));break}}t=t.return}}function Lh(e,t,a){var u=e.pingCache;if(u===null){u=e.pingCache=new Rh;var h=new Set;u.set(t,h)}else h=u.get(t),h===void 0&&(h=new Set,u.set(t,h));h.has(a)||(Se=!0,h.add(a),e=cm.bind(null,e,t,a),t.then(e,e))}function cm(e,t,a){var u=e.pingCache;u!==null&&u.delete(t),e.pingedLanes|=e.suspendedLanes&a,e.warmLanes&=~a,g===e&&(L&a)===a&&(Pe===4||Pe===3&&(L&62914560)===L&&300>Sn()-bt?(c&2)===0&&lo(e,0):be|=a,Ce===L&&(Ce=0)),Gc(e)}function j0(e,t){t===0&&(t=Bi()),e=dl(e,t),e!==null&&(nn(e,t),Gc(e))}function um(e){var t=e.memoizedState,a=0;t!==null&&(a=t.retryLane),j0(e,a)}function dm(e,t){var a=0;switch(e.tag){case 31:case 13:var u=e.stateNode,h=e.memoizedState;h!==null&&(a=h.retryLane);break;case 19:u=e.stateNode;break;case 22:u=e.stateNode._retryCache;break;default:throw Error(s(314))}u!==null&&u.delete(t),j0(e,a)}function fm(e,t){return fn(e,t)}var Dp=null,Xd=null,Mh=!1,Rp=!1,Bh=!1,Lu=0;function Gc(e){e!==Xd&&e.next===null&&(Xd===null?Dp=Xd=e:Xd=Xd.next=e),Rp=!0,Mh||(Mh=!0,hm())}function Mf(e,t){if(!Bh&&Rp){Bh=!0;do for(var a=!1,u=Dp;u!==null;){if(e!==0){var h=u.pendingLanes;if(h===0)var S=0;else{var B=u.suspendedLanes,ce=u.pingedLanes;S=(1<<31-Pt(42|e)+1)-1,S&=h&~(B&~ce),S=S&201326741?S&201326741|1:S?S|2:0}S!==0&&(a=!0,P0(u,S))}else S=L,S=ti(u,u===g?S:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(S&3)===0||Go(u,S)||(a=!0,P0(u,S));u=u.next}while(a);Bh=!1}}function pm(){N0()}function N0(){Rp=Mh=!1;var e=0;Lu!==0&&Cm()&&(e=Lu);for(var t=Sn(),a=null,u=Dp;u!==null;){var h=u.next,S=k0(u,t);S===0?(u.next=null,a===null?Dp=h:a.next=h,h===null&&(Xd=a)):(a=u,(e!==0||(S&3)!==0)&&(Rp=!0)),u=h}Oe!==0&&Oe!==5||Mf(e),Lu!==0&&(Lu=0)}function k0(e,t){for(var a=e.suspendedLanes,u=e.pingedLanes,h=e.expirationTimes,S=e.pendingLanes&-62914561;0<S;){var B=31-Pt(S),ce=1<<B,Fe=h[B];Fe===-1?((ce&a)===0||(ce&u)!==0)&&(h[B]=zn(ce,t)):Fe<=t&&(e.expiredLanes|=ce),S&=~ce}if(t=g,a=L,a=ti(e,e===t?a:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),u=e.callbackNode,a===0||e===t&&(K===2||K===9)||e.cancelPendingCommit!==null)return u!==null&&u!==null&&Yt(u),e.callbackNode=null,e.callbackPriority=0;if((a&3)===0||Go(e,a)){if(t=a&-a,t===e.callbackPriority)return t;switch(u!==null&&Yt(u),xt(a)){case 2:case 8:a=Bt;break;case 32:a=Gt;break;case 268435456:a=dt;break;default:a=Gt}return u=A0.bind(null,e),a=fn(a,u),e.callbackPriority=t,e.callbackNode=a,t}return u!==null&&u!==null&&Yt(u),e.callbackPriority=2,e.callbackNode=null,2}function A0(e,t){if(Oe!==0&&Oe!==5)return e.callbackNode=null,e.callbackPriority=0,null;var a=e.callbackNode;if(_p()&&e.callbackNode!==a)return null;var u=L;return u=ti(e,e===g?u:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),u===0?null:(Rn(e,u,t),k0(e,Sn()),e.callbackNode!=null&&e.callbackNode===a?A0.bind(null,e):null)}function P0(e,t){if(_p())return null;Rn(e,t,!0)}function hm(){Nm(function(){(c&6)!==0?fn(tt,pm):N0()})}function Oh(){if(Lu===0){var e=f;e===0&&(e=Tt,Tt<<=1,(Tt&261888)===0&&(Tt=256)),Lu=e}return Lu}function z0(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Qr(""+e)}function _0(e,t){var a=t.ownerDocument.createElement("input");return a.name=t.name,a.value=t.value,e.id&&a.setAttribute("form",e.id),t.parentNode.insertBefore(a,t),e=new FormData(e),a.parentNode.removeChild(a),e}function gm(e,t,a,u,h){if(t==="submit"&&a&&a.stateNode===h){var S=z0((h[Et]||null).action),B=u.submitter;B&&(t=(t=B[Et]||null)?z0(t.formAction):B.getAttribute("formAction"),t!==null&&(S=t,B=null));var ce=new oi("action","action",null,u,h);e.push({event:ce,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Lu!==0){var Fe=B?_0(h,B):new FormData(h);vf(a,{pending:!0,data:Fe,method:h.method,action:S},null,Fe)}}else typeof S=="function"&&(ce.preventDefault(),Fe=B?_0(h,B):new FormData(h),vf(a,{pending:!0,data:Fe,method:h.method,action:S},S,Fe))},currentTarget:h}]})}}for(var Fh=0;Fh<wo.length;Fh++){var Uh=wo[Fh],ym=Uh.toLowerCase(),xm=Uh[0].toUpperCase()+Uh.slice(1);_o(ym,"on"+xm)}_o(fc,"onAnimationEnd"),_o(ru,"onAnimationIteration"),_o(Ku,"onAnimationStart"),_o("dblclick","onDoubleClick"),_o("focusin","onFocus"),_o("focusout","onBlur"),_o(Ha,"onTransitionRun"),_o(go,"onTransitionStart"),_o(kl,"onTransitionCancel"),_o(zo,"onTransitionEnd"),Ei("onMouseEnter",["mouseout","mouseover"]),Ei("onMouseLeave",["mouseout","mouseover"]),Ei("onPointerEnter",["pointerout","pointerover"]),Ei("onPointerLeave",["pointerout","pointerover"]),Mo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Mo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Mo("onBeforeInput",["compositionend","keypress","textInput","paste"]),Mo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Mo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Mo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mm=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Bf));function D0(e,t){t=(t&4)!==0;for(var a=0;a<e.length;a++){var u=e[a],h=u.event;u=u.listeners;e:{var S=void 0;if(t)for(var B=u.length-1;0<=B;B--){var ce=u[B],Fe=ce.instance,it=ce.currentTarget;if(ce=ce.listener,Fe!==S&&h.isPropagationStopped())break e;S=ce,h.currentTarget=it;try{S(h)}catch(wt){no(wt)}h.currentTarget=null,S=Fe}else for(B=0;B<u.length;B++){if(ce=u[B],Fe=ce.instance,it=ce.currentTarget,ce=ce.listener,Fe!==S&&h.isPropagationStopped())break e;S=ce,h.currentTarget=it;try{S(h)}catch(wt){no(wt)}h.currentTarget=null,S=Fe}}}}function Ji(e,t){var a=t[Zt];a===void 0&&(a=t[Zt]=new Set);var u=e+"__bubble";a.has(u)||(R0(t,e,2,!1),a.add(u))}function Eh(e,t,a){var u=0;t&&(u|=4),R0(a,e,u,t)}var Ip="_reactListening"+Math.random().toString(36).slice(2);function Vh(e){if(!e[Ip]){e[Ip]=!0,us.forEach(function(a){a!=="selectionchange"&&(mm.has(a)||Eh(a,!1,e),Eh(a,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ip]||(t[Ip]=!0,Eh("selectionchange",!1,t))}}function R0(e,t,a,u){switch(l1(t)){case 2:var h=$m;break;case 8:h=Ym;break;default:h=ig}a=h.bind(null,t,a,e),h=void 0,!Tn||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(h=!0),u?h!==void 0?e.addEventListener(t,a,{capture:!0,passive:h}):e.addEventListener(t,a,!0):h!==void 0?e.addEventListener(t,a,{passive:h}):e.addEventListener(t,a,!1)}function qh(e,t,a,u,h){var S=u;if((t&1)===0&&(t&2)===0&&u!==null)e:for(;;){if(u===null)return;var B=u.tag;if(B===3||B===4){var ce=u.stateNode.containerInfo;if(ce===h)break;if(B===4)for(B=u.return;B!==null;){var Fe=B.tag;if((Fe===3||Fe===4)&&B.stateNode.containerInfo===h)return;B=B.return}for(;ce!==null;){if(B=pr(ce),B===null)return;if(Fe=B.tag,Fe===5||Fe===6||Fe===26||Fe===27){u=S=B;continue e}ce=ce.parentNode}}u=u.return}Fa(function(){var it=S,wt=Oa(a),Dt=[];e:{var at=Rs.get(e);if(at!==void 0){var ft=oi,jn=e;switch(e){case"keypress":if(hn(a)===0)break e;case"keydown":case"keyup":ft=di;break;case"focusin":jn="focus",ft=gs;break;case"focusout":jn="blur",ft=gs;break;case"beforeblur":case"afterblur":ft=gs;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ft=hs;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ft=Ys;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ft=Rr;break;case fc:case ru:case Ku:ft=C;break;case zo:ft=ar;break;case"scroll":case"scrollend":ft=Ni;break;case"wheel":ft=Lr;break;case"copy":case"cut":case"paste":ft=pe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ft=Yi;break;case"toggle":case"beforetoggle":ft=pa}var ii=(t&4)!==0,Jr=!ii&&(e==="scroll"||e==="scrollend"),Ke=ii?at!==null?at+"Capture":null:at;ii=[];for(var He=it,nt;He!==null;){var kt=He;if(nt=kt.stateNode,kt=kt.tag,kt!==5&&kt!==26&&kt!==27||nt===null||Ke===null||(kt=ua(He,Ke),kt!=null&&ii.push(Of(He,kt,nt))),Jr)break;He=He.return}0<ii.length&&(at=new ft(at,jn,null,a,wt),Dt.push({event:at,listeners:ii}))}}if((t&7)===0){e:{if(at=e==="mouseover"||e==="pointerover",ft=e==="mouseout"||e==="pointerout",at&&a!==ps&&(jn=a.relatedTarget||a.fromElement)&&(pr(jn)||jn[En]))break e;if((ft||at)&&(at=wt.window===wt?wt:(at=wt.ownerDocument)?at.defaultView||at.parentWindow:window,ft?(jn=a.relatedTarget||a.toElement,ft=it,jn=jn?pr(jn):null,jn!==null&&(Jr=d(jn),ii=jn.tag,jn!==Jr||ii!==5&&ii!==27&&ii!==6)&&(jn=null)):(ft=null,jn=it),ft!==jn)){if(ii=hs,kt="onMouseLeave",Ke="onMouseEnter",He="mouse",(e==="pointerout"||e==="pointerover")&&(ii=Yi,kt="onPointerLeave",Ke="onPointerEnter",He="pointer"),Jr=ft==null?at:_n(ft),nt=jn==null?at:_n(jn),at=new ii(kt,He+"leave",ft,a,wt),at.target=Jr,at.relatedTarget=nt,kt=null,pr(wt)===it&&(ii=new ii(Ke,He+"enter",jn,a,wt),ii.target=nt,ii.relatedTarget=Jr,kt=ii),Jr=kt,ft&&jn)t:{for(ii=bm,Ke=ft,He=jn,nt=0,kt=Ke;kt;kt=ii(kt))nt++;kt=0;for(var $n=He;$n;$n=ii($n))kt++;for(;0<nt-kt;)Ke=ii(Ke),nt--;for(;0<kt-nt;)He=ii(He),kt--;for(;nt--;){if(Ke===He||He!==null&&Ke===He.alternate){ii=Ke;break t}Ke=ii(Ke),He=ii(He)}ii=null}else ii=null;ft!==null&&I0(Dt,at,ft,ii,!1),jn!==null&&Jr!==null&&I0(Dt,Jr,jn,ii,!0)}}e:{if(at=it?_n(it):window,ft=at.nodeName&&at.nodeName.toLowerCase(),ft==="select"||ft==="input"&&at.type==="file")var kr=ho;else if(_s(at))if(Fo)kr=Gi;else{kr=Zn;var Pn=Kl}else ft=at.nodeName,!ft||ft.toLowerCase()!=="input"||at.type!=="checkbox"&&at.type!=="radio"?it&&fs(it.elementType)&&(kr=ho):kr=xs;if(kr&&(kr=kr(e,it))){_a(Dt,kr,a,wt);break e}Pn&&Pn(e,at,it),e==="focusout"&&it&&at.type==="number"&&it.memoizedProps.value!=null&&ca(at,"number",at.value)}switch(Pn=it?_n(it):window,e){case"focusin":(_s(Pn)||Pn.contentEditable==="true")&&(Eo=Pn,qa=it,hr=null);break;case"focusout":hr=qa=Eo=null;break;case"mousedown":is=!0;break;case"contextmenu":case"mouseup":case"dragend":is=!1,Vi(Dt,a,wt);break;case"selectionchange":if(Nl)break;case"keydown":case"keyup":Vi(Dt,a,wt)}var Mi;if(Jo)e:{switch(e){case"compositionstart":var rr="onCompositionStart";break e;case"compositionend":rr="onCompositionEnd";break e;case"compositionupdate":rr="onCompositionUpdate";break e}rr=void 0}else tr?mo(e,a)&&(rr="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(rr="onCompositionStart");rr&&(ha&&a.locale!=="ko"&&(tr||rr!=="onCompositionStart"?rr==="onCompositionEnd"&&tr&&(Mi=Ri()):(Oo=wt,Mn="value"in Oo?Oo.value:Oo.textContent,tr=!0)),Pn=Lp(it,rr),0<Pn.length&&(rr=new Ve(rr,e,null,a,wt),Dt.push({event:rr,listeners:Pn}),Mi?rr.data=Mi:(Mi=es(a),Mi!==null&&(rr.data=Mi)))),(Mi=po?to(e,a):Tl(e,a))&&(rr=Lp(it,"onBeforeInput"),0<rr.length&&(Pn=new Ve("onBeforeInput","beforeinput",null,a,wt),Dt.push({event:Pn,listeners:rr}),Pn.data=Mi)),gm(Dt,e,it,a,wt)}D0(Dt,t)})}function Of(e,t,a){return{instance:e,listener:t,currentTarget:a}}function Lp(e,t){for(var a=t+"Capture",u=[];e!==null;){var h=e,S=h.stateNode;if(h=h.tag,h!==5&&h!==26&&h!==27||S===null||(h=ua(e,a),h!=null&&u.unshift(Of(e,h,S)),h=ua(e,t),h!=null&&u.push(Of(e,h,S))),e.tag===3)return u;e=e.return}return[]}function bm(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function I0(e,t,a,u,h){for(var S=t._reactName,B=[];a!==null&&a!==u;){var ce=a,Fe=ce.alternate,it=ce.stateNode;if(ce=ce.tag,Fe!==null&&Fe===u)break;ce!==5&&ce!==26&&ce!==27||it===null||(Fe=it,h?(it=ua(a,S),it!=null&&B.unshift(Of(a,it,Fe))):h||(it=ua(a,S),it!=null&&B.push(Of(a,it,Fe)))),a=a.return}B.length!==0&&e.push({event:t,listeners:B})}var vm=/\r\n?/g,wm=/\u0000|\uFFFD/g;function L0(e){return(typeof e=="string"?e:""+e).replace(vm,`
`).replace(wm,"")}function M0(e,t){return t=L0(t),L0(e)===t}function Zr(e,t,a,u,h,S){switch(a){case"children":typeof u=="string"?t==="body"||t==="textarea"&&u===""||Di(e,u):(typeof u=="number"||typeof u=="bigint")&&t!=="body"&&Di(e,""+u);break;case"className":Ws(e,"class",u);break;case"tabIndex":Ws(e,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Ws(e,a,u);break;case"style":Bo(e,u,S);break;case"data":if(t!=="object"){Ws(e,"data",u);break}case"src":case"href":if(u===""&&(t!=="a"||a!=="href")){e.removeAttribute(a);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){e.removeAttribute(a);break}u=Qr(""+u),e.setAttribute(a,u);break;case"action":case"formAction":if(typeof u=="function"){e.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof S=="function"&&(a==="formAction"?(t!=="input"&&Zr(e,t,"name",h.name,h,null),Zr(e,t,"formEncType",h.formEncType,h,null),Zr(e,t,"formMethod",h.formMethod,h,null),Zr(e,t,"formTarget",h.formTarget,h,null)):(Zr(e,t,"encType",h.encType,h,null),Zr(e,t,"method",h.method,h,null),Zr(e,t,"target",h.target,h,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){e.removeAttribute(a);break}u=Qr(""+u),e.setAttribute(a,u);break;case"onClick":u!=null&&(e.onclick=jr);break;case"onScroll":u!=null&&Ji("scroll",e);break;case"onScrollEnd":u!=null&&Ji("scrollend",e);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(s(61));if(a=u.__html,a!=null){if(h.children!=null)throw Error(s(60));e.innerHTML=a}}break;case"multiple":e.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":e.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){e.removeAttribute("xlink:href");break}a=Qr(""+u),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?e.setAttribute(a,""+u):e.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?e.setAttribute(a,""):e.removeAttribute(a);break;case"capture":case"download":u===!0?e.setAttribute(a,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?e.setAttribute(a,u):e.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?e.setAttribute(a,u):e.removeAttribute(a);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?e.removeAttribute(a):e.setAttribute(a,u);break;case"popover":Ji("beforetoggle",e),Ji("toggle",e),Ur(e,"popover",u);break;case"xlinkActuate":_r(e,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":_r(e,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":_r(e,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":_r(e,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":_r(e,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":_r(e,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":_r(e,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":_r(e,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":_r(e,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Ur(e,"is",u);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=ka.get(a)||a,Ur(e,a,u))}}function Hh(e,t,a,u,h,S){switch(a){case"style":Bo(e,u,S);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(s(61));if(a=u.__html,a!=null){if(h.children!=null)throw Error(s(60));e.innerHTML=a}}break;case"children":typeof u=="string"?Di(e,u):(typeof u=="number"||typeof u=="bigint")&&Di(e,""+u);break;case"onScroll":u!=null&&Ji("scroll",e);break;case"onScrollEnd":u!=null&&Ji("scrollend",e);break;case"onClick":u!=null&&(e.onclick=jr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!gi.hasOwnProperty(a))e:{if(a[0]==="o"&&a[1]==="n"&&(h=a.endsWith("Capture"),t=a.slice(2,h?a.length-7:void 0),S=e[Et]||null,S=S!=null?S[a]:null,typeof S=="function"&&e.removeEventListener(t,S,h),typeof u=="function")){typeof S!="function"&&S!==null&&(a in e?e[a]=null:e.hasAttribute(a)&&e.removeAttribute(a)),e.addEventListener(t,u,h);break e}a in e?e[a]=u:u===!0?e.setAttribute(a,""):Ur(e,a,u)}}}function As(e,t,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ji("error",e),Ji("load",e);var u=!1,h=!1,S;for(S in a)if(a.hasOwnProperty(S)){var B=a[S];if(B!=null)switch(S){case"src":u=!0;break;case"srcSet":h=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:Zr(e,t,S,B,a,null)}}h&&Zr(e,t,"srcSet",a.srcSet,a,null),u&&Zr(e,t,"src",a.src,a,null);return;case"input":Ji("invalid",e);var ce=S=B=h=null,Fe=null,it=null;for(u in a)if(a.hasOwnProperty(u)){var wt=a[u];if(wt!=null)switch(u){case"name":h=wt;break;case"type":B=wt;break;case"checked":Fe=wt;break;case"defaultChecked":it=wt;break;case"value":S=wt;break;case"defaultValue":ce=wt;break;case"children":case"dangerouslySetInnerHTML":if(wt!=null)throw Error(s(137,t));break;default:Zr(e,t,u,wt,a,null)}}Gl(e,S,ce,Fe,it,B,h,!1);return;case"select":Ji("invalid",e),u=B=S=null;for(h in a)if(a.hasOwnProperty(h)&&(ce=a[h],ce!=null))switch(h){case"value":S=ce;break;case"defaultValue":B=ce;break;case"multiple":u=ce;default:Zr(e,t,h,ce,a,null)}t=S,a=B,e.multiple=!!u,t!=null?Cr(e,!!u,t,!1):a!=null&&Cr(e,!!u,a,!0);return;case"textarea":Ji("invalid",e),S=h=u=null;for(B in a)if(a.hasOwnProperty(B)&&(ce=a[B],ce!=null))switch(B){case"value":u=ce;break;case"defaultValue":h=ce;break;case"children":S=ce;break;case"dangerouslySetInnerHTML":if(ce!=null)throw Error(s(91));break;default:Zr(e,t,B,ce,a,null)}Wr(e,u,h,S);return;case"option":for(Fe in a)if(a.hasOwnProperty(Fe)&&(u=a[Fe],u!=null))switch(Fe){case"selected":e.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:Zr(e,t,Fe,u,a,null)}return;case"dialog":Ji("beforetoggle",e),Ji("toggle",e),Ji("cancel",e),Ji("close",e);break;case"iframe":case"object":Ji("load",e);break;case"video":case"audio":for(u=0;u<Bf.length;u++)Ji(Bf[u],e);break;case"image":Ji("error",e),Ji("load",e);break;case"details":Ji("toggle",e);break;case"embed":case"source":case"link":Ji("error",e),Ji("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(it in a)if(a.hasOwnProperty(it)&&(u=a[it],u!=null))switch(it){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:Zr(e,t,it,u,a,null)}return;default:if(fs(t)){for(wt in a)a.hasOwnProperty(wt)&&(u=a[wt],u!==void 0&&Hh(e,t,wt,u,a,void 0));return}}for(ce in a)a.hasOwnProperty(ce)&&(u=a[ce],u!=null&&Zr(e,t,ce,u,a,null))}function Sm(e,t,a,u){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var h=null,S=null,B=null,ce=null,Fe=null,it=null,wt=null;for(ft in a){var Dt=a[ft];if(a.hasOwnProperty(ft)&&Dt!=null)switch(ft){case"checked":break;case"value":break;case"defaultValue":Fe=Dt;default:u.hasOwnProperty(ft)||Zr(e,t,ft,null,u,Dt)}}for(var at in u){var ft=u[at];if(Dt=a[at],u.hasOwnProperty(at)&&(ft!=null||Dt!=null))switch(at){case"type":S=ft;break;case"name":h=ft;break;case"checked":it=ft;break;case"defaultChecked":wt=ft;break;case"value":B=ft;break;case"defaultValue":ce=ft;break;case"children":case"dangerouslySetInnerHTML":if(ft!=null)throw Error(s(137,t));break;default:ft!==Dt&&Zr(e,t,at,ft,u,Dt)}}Xo(e,B,ce,Fe,it,wt,S,h);return;case"select":ft=B=ce=at=null;for(S in a)if(Fe=a[S],a.hasOwnProperty(S)&&Fe!=null)switch(S){case"value":break;case"multiple":ft=Fe;default:u.hasOwnProperty(S)||Zr(e,t,S,null,u,Fe)}for(h in u)if(S=u[h],Fe=a[h],u.hasOwnProperty(h)&&(S!=null||Fe!=null))switch(h){case"value":at=S;break;case"defaultValue":ce=S;break;case"multiple":B=S;default:S!==Fe&&Zr(e,t,h,S,u,Fe)}t=ce,a=B,u=ft,at!=null?Cr(e,!!a,at,!1):!!u!=!!a&&(t!=null?Cr(e,!!a,t,!0):Cr(e,!!a,a?[]:"",!1));return;case"textarea":ft=at=null;for(ce in a)if(h=a[ce],a.hasOwnProperty(ce)&&h!=null&&!u.hasOwnProperty(ce))switch(ce){case"value":break;case"children":break;default:Zr(e,t,ce,null,u,h)}for(B in u)if(h=u[B],S=a[B],u.hasOwnProperty(B)&&(h!=null||S!=null))switch(B){case"value":at=h;break;case"defaultValue":ft=h;break;case"children":break;case"dangerouslySetInnerHTML":if(h!=null)throw Error(s(91));break;default:h!==S&&Zr(e,t,B,h,u,S)}Xl(e,at,ft);return;case"option":for(var jn in a)if(at=a[jn],a.hasOwnProperty(jn)&&at!=null&&!u.hasOwnProperty(jn))switch(jn){case"selected":e.selected=!1;break;default:Zr(e,t,jn,null,u,at)}for(Fe in u)if(at=u[Fe],ft=a[Fe],u.hasOwnProperty(Fe)&&at!==ft&&(at!=null||ft!=null))switch(Fe){case"selected":e.selected=at&&typeof at!="function"&&typeof at!="symbol";break;default:Zr(e,t,Fe,at,u,ft)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ii in a)at=a[ii],a.hasOwnProperty(ii)&&at!=null&&!u.hasOwnProperty(ii)&&Zr(e,t,ii,null,u,at);for(it in u)if(at=u[it],ft=a[it],u.hasOwnProperty(it)&&at!==ft&&(at!=null||ft!=null))switch(it){case"children":case"dangerouslySetInnerHTML":if(at!=null)throw Error(s(137,t));break;default:Zr(e,t,it,at,u,ft)}return;default:if(fs(t)){for(var Jr in a)at=a[Jr],a.hasOwnProperty(Jr)&&at!==void 0&&!u.hasOwnProperty(Jr)&&Hh(e,t,Jr,void 0,u,at);for(wt in u)at=u[wt],ft=a[wt],!u.hasOwnProperty(wt)||at===ft||at===void 0&&ft===void 0||Hh(e,t,wt,at,u,ft);return}}for(var Ke in a)at=a[Ke],a.hasOwnProperty(Ke)&&at!=null&&!u.hasOwnProperty(Ke)&&Zr(e,t,Ke,null,u,at);for(Dt in u)at=u[Dt],ft=a[Dt],!u.hasOwnProperty(Dt)||at===ft||at==null&&ft==null||Zr(e,t,Dt,at,u,ft)}function B0(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Tm(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,a=performance.getEntriesByType("resource"),u=0;u<a.length;u++){var h=a[u],S=h.transferSize,B=h.initiatorType,ce=h.duration;if(S&&ce&&B0(B)){for(B=0,ce=h.responseEnd,u+=1;u<a.length;u++){var Fe=a[u],it=Fe.startTime;if(it>ce)break;var wt=Fe.transferSize,Dt=Fe.initiatorType;wt&&B0(Dt)&&(Fe=Fe.responseEnd,B+=wt*(Fe<ce?1:(ce-it)/(Fe-it)))}if(--u,t+=8*(S+B)/(h.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Wh=null,$h=null;function Mp(e){return e.nodeType===9?e:e.ownerDocument}function O0(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function F0(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Yh(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Gh=null;function Cm(){var e=window.event;return e&&e.type==="popstate"?e===Gh?!1:(Gh=e,!0):(Gh=null,!1)}var U0=typeof setTimeout=="function"?setTimeout:void 0,jm=typeof clearTimeout=="function"?clearTimeout:void 0,E0=typeof Promise=="function"?Promise:void 0,Nm=typeof queueMicrotask=="function"?queueMicrotask:typeof E0<"u"?function(e){return E0.resolve(null).then(e).catch(km)}:U0;function km(e){setTimeout(function(){throw e})}function Mu(e){return e==="head"}function V0(e,t){var a=t,u=0;do{var h=a.nextSibling;if(e.removeChild(a),h&&h.nodeType===8)if(a=h.data,a==="/$"||a==="/&"){if(u===0){e.removeChild(h),Qd(t);return}u--}else if(a==="$"||a==="$?"||a==="$~"||a==="$!"||a==="&")u++;else if(a==="html")Ff(e.ownerDocument.documentElement);else if(a==="head"){a=e.ownerDocument.head,Ff(a);for(var S=a.firstChild;S;){var B=S.nextSibling,ce=S.nodeName;S[mr]||ce==="SCRIPT"||ce==="STYLE"||ce==="LINK"&&S.rel.toLowerCase()==="stylesheet"||a.removeChild(S),S=B}}else a==="body"&&Ff(e.ownerDocument.body);a=h}while(a);Qd(t)}function q0(e,t){var a=e;e=0;do{var u=a.nextSibling;if(a.nodeType===1?t?(a._stashedDisplay=a.style.display,a.style.display="none"):(a.style.display=a._stashedDisplay||"",a.getAttribute("style")===""&&a.removeAttribute("style")):a.nodeType===3&&(t?(a._stashedText=a.nodeValue,a.nodeValue=""):a.nodeValue=a._stashedText||""),u&&u.nodeType===8)if(a=u.data,a==="/$"){if(e===0)break;e--}else a!=="$"&&a!=="$?"&&a!=="$~"&&a!=="$!"||e++;a=u}while(a)}function Xh(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var a=t;switch(t=t.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":Xh(a),mi(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}e.removeChild(a)}}function Am(e,t,a,u){for(;e.nodeType===1;){var h=a;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!u&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(u){if(!e[mr])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(S=e.getAttribute("rel"),S==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(S!==h.rel||e.getAttribute("href")!==(h.href==null||h.href===""?null:h.href)||e.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin)||e.getAttribute("title")!==(h.title==null?null:h.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(S=e.getAttribute("src"),(S!==(h.src==null?null:h.src)||e.getAttribute("type")!==(h.type==null?null:h.type)||e.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin))&&S&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var S=h.name==null?null:""+h.name;if(h.type==="hidden"&&e.getAttribute("name")===S)return e}else return e;if(e=ac(e.nextSibling),e===null)break}return null}function Pm(e,t,a){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!a||(e=ac(e.nextSibling),e===null))return null;return e}function H0(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=ac(e.nextSibling),e===null))return null;return e}function Kh(e){return e.data==="$?"||e.data==="$~"}function Zh(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function zm(e,t){var a=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||a.readyState!=="loading")t();else{var u=function(){t(),a.removeEventListener("DOMContentLoaded",u)};a.addEventListener("DOMContentLoaded",u),e._reactRetry=u}}function ac(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var Jh=null;function W0(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"||a==="/&"){if(t===0)return ac(e.nextSibling);t--}else a!=="$"&&a!=="$!"&&a!=="$?"&&a!=="$~"&&a!=="&"||t++}e=e.nextSibling}return null}function $0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"){if(t===0)return e;t--}else a!=="/$"&&a!=="/&"||t++}e=e.previousSibling}return null}function Y0(e,t,a){switch(t=Mp(a),e){case"html":if(e=t.documentElement,!e)throw Error(s(452));return e;case"head":if(e=t.head,!e)throw Error(s(453));return e;case"body":if(e=t.body,!e)throw Error(s(454));return e;default:throw Error(s(451))}}function Ff(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);mi(e)}var sc=new Map,G0=new Set;function Bp(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var vu=de.d;de.d={f:_m,r:Dm,D:Rm,C:Im,L:Lm,m:Mm,X:Om,S:Bm,M:Fm};function _m(){var e=vu.f(),t=Vr();return e||t}function Dm(e){var t=Ci(e);t!==null&&t.tag===5&&t.type==="form"?pp(t):vu.r(e)}var Kd=typeof document>"u"?null:document;function X0(e,t,a){var u=Kd;if(u&&typeof t=="string"&&t){var h=Qi(t);h='link[rel="'+e+'"][href="'+h+'"]',typeof a=="string"&&(h+='[crossorigin="'+a+'"]'),G0.has(h)||(G0.add(h),e={rel:e,crossOrigin:a,href:t},u.querySelector(h)===null&&(t=u.createElement("link"),As(t,"link",e),qn(t),u.head.appendChild(t)))}}function Rm(e){vu.D(e),X0("dns-prefetch",e,null)}function Im(e,t){vu.C(e,t),X0("preconnect",e,t)}function Lm(e,t,a){vu.L(e,t,a);var u=Kd;if(u&&e&&t){var h='link[rel="preload"][as="'+Qi(t)+'"]';t==="image"&&a&&a.imageSrcSet?(h+='[imagesrcset="'+Qi(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(h+='[imagesizes="'+Qi(a.imageSizes)+'"]')):h+='[href="'+Qi(e)+'"]';var S=h;switch(t){case"style":S=Zd(e);break;case"script":S=Jd(e)}sc.has(S)||(e=_({rel:"preload",href:t==="image"&&a&&a.imageSrcSet?void 0:e,as:t},a),sc.set(S,e),u.querySelector(h)!==null||t==="style"&&u.querySelector(Uf(S))||t==="script"&&u.querySelector(Ef(S))||(t=u.createElement("link"),As(t,"link",e),qn(t),u.head.appendChild(t)))}}function Mm(e,t){vu.m(e,t);var a=Kd;if(a&&e){var u=t&&typeof t.as=="string"?t.as:"script",h='link[rel="modulepreload"][as="'+Qi(u)+'"][href="'+Qi(e)+'"]',S=h;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":S=Jd(e)}if(!sc.has(S)&&(e=_({rel:"modulepreload",href:e},t),sc.set(S,e),a.querySelector(h)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(Ef(S)))return}u=a.createElement("link"),As(u,"link",e),qn(u),a.head.appendChild(u)}}}function Bm(e,t,a){vu.S(e,t,a);var u=Kd;if(u&&e){var h=ko(u).hoistableStyles,S=Zd(e);t=t||"default";var B=h.get(S);if(!B){var ce={loading:0,preload:null};if(B=u.querySelector(Uf(S)))ce.loading=5;else{e=_({rel:"stylesheet",href:e,"data-precedence":t},a),(a=sc.get(S))&&Qh(e,a);var Fe=B=u.createElement("link");qn(Fe),As(Fe,"link",e),Fe._p=new Promise(function(it,wt){Fe.onload=it,Fe.onerror=wt}),Fe.addEventListener("load",function(){ce.loading|=1}),Fe.addEventListener("error",function(){ce.loading|=2}),ce.loading|=4,Op(B,t,u)}B={type:"stylesheet",instance:B,count:1,state:ce},h.set(S,B)}}}function Om(e,t){vu.X(e,t);var a=Kd;if(a&&e){var u=ko(a).hoistableScripts,h=Jd(e),S=u.get(h);S||(S=a.querySelector(Ef(h)),S||(e=_({src:e,async:!0},t),(t=sc.get(h))&&eg(e,t),S=a.createElement("script"),qn(S),As(S,"link",e),a.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},u.set(h,S))}}function Fm(e,t){vu.M(e,t);var a=Kd;if(a&&e){var u=ko(a).hoistableScripts,h=Jd(e),S=u.get(h);S||(S=a.querySelector(Ef(h)),S||(e=_({src:e,async:!0,type:"module"},t),(t=sc.get(h))&&eg(e,t),S=a.createElement("script"),qn(S),As(S,"link",e),a.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},u.set(h,S))}}function K0(e,t,a,u){var h=(h=ve.current)?Bp(h):null;if(!h)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(t=Zd(a.href),a=ko(h).hoistableStyles,u=a.get(t),u||(u={type:"style",instance:null,count:0,state:null},a.set(t,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){e=Zd(a.href);var S=ko(h).hoistableStyles,B=S.get(e);if(B||(h=h.ownerDocument||h,B={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},S.set(e,B),(S=h.querySelector(Uf(e)))&&!S._p&&(B.instance=S,B.state.loading=5),sc.has(e)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},sc.set(e,a),S||Um(h,e,a,B.state))),t&&u===null)throw Error(s(528,""));return B}if(t&&u!==null)throw Error(s(529,""));return null;case"script":return t=a.async,a=a.src,typeof a=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Jd(a),a=ko(h).hoistableScripts,u=a.get(t),u||(u={type:"script",instance:null,count:0,state:null},a.set(t,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function Zd(e){return'href="'+Qi(e)+'"'}function Uf(e){return'link[rel="stylesheet"]['+e+"]"}function Z0(e){return _({},e,{"data-precedence":e.precedence,precedence:null})}function Um(e,t,a,u){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?u.loading=1:(t=e.createElement("link"),u.preload=t,t.addEventListener("load",function(){return u.loading|=1}),t.addEventListener("error",function(){return u.loading|=2}),As(t,"link",a),qn(t),e.head.appendChild(t))}function Jd(e){return'[src="'+Qi(e)+'"]'}function Ef(e){return"script[async]"+e}function J0(e,t,a){if(t.count++,t.instance===null)switch(t.type){case"style":var u=e.querySelector('style[data-href~="'+Qi(a.href)+'"]');if(u)return t.instance=u,qn(u),u;var h=_({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return u=(e.ownerDocument||e).createElement("style"),qn(u),As(u,"style",h),Op(u,a.precedence,e),t.instance=u;case"stylesheet":h=Zd(a.href);var S=e.querySelector(Uf(h));if(S)return t.state.loading|=4,t.instance=S,qn(S),S;u=Z0(a),(h=sc.get(h))&&Qh(u,h),S=(e.ownerDocument||e).createElement("link"),qn(S);var B=S;return B._p=new Promise(function(ce,Fe){B.onload=ce,B.onerror=Fe}),As(S,"link",u),t.state.loading|=4,Op(S,a.precedence,e),t.instance=S;case"script":return S=Jd(a.src),(h=e.querySelector(Ef(S)))?(t.instance=h,qn(h),h):(u=a,(h=sc.get(S))&&(u=_({},a),eg(u,h)),e=e.ownerDocument||e,h=e.createElement("script"),qn(h),As(h,"link",u),e.head.appendChild(h),t.instance=h);case"void":return null;default:throw Error(s(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(u=t.instance,t.state.loading|=4,Op(u,a.precedence,e));return t.instance}function Op(e,t,a){for(var u=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),h=u.length?u[u.length-1]:null,S=h,B=0;B<u.length;B++){var ce=u[B];if(ce.dataset.precedence===t)S=ce;else if(S!==h)break}S?S.parentNode.insertBefore(e,S.nextSibling):(t=a.nodeType===9?a.head:a,t.insertBefore(e,t.firstChild))}function Qh(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function eg(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var Fp=null;function Q0(e,t,a){if(Fp===null){var u=new Map,h=Fp=new Map;h.set(a,u)}else h=Fp,u=h.get(a),u||(u=new Map,h.set(a,u));if(u.has(e))return u;for(u.set(e,null),a=a.getElementsByTagName(e),h=0;h<a.length;h++){var S=a[h];if(!(S[mr]||S[ut]||e==="link"&&S.getAttribute("rel")==="stylesheet")&&S.namespaceURI!=="http://www.w3.org/2000/svg"){var B=S.getAttribute(t)||"";B=e+B;var ce=u.get(B);ce?ce.push(S):u.set(B,[S])}}return u}function e1(e,t,a){e=e.ownerDocument||e,e.head.insertBefore(a,t==="title"?e.querySelector("head > title"):null)}function Em(e,t,a){if(a===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function t1(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function Vm(e,t,a,u){if(a.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var h=Zd(u.href),S=t.querySelector(Uf(h));if(S){t=S._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=Up.bind(e),t.then(e,e)),a.state.loading|=4,a.instance=S,qn(S);return}S=t.ownerDocument||t,u=Z0(u),(h=sc.get(h))&&Qh(u,h),S=S.createElement("link"),qn(S);var B=S;B._p=new Promise(function(ce,Fe){B.onload=ce,B.onerror=Fe}),As(S,"link",u),a.instance=S}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(a,t),(t=a.state.preload)&&(a.state.loading&3)===0&&(e.count++,a=Up.bind(e),t.addEventListener("load",a),t.addEventListener("error",a))}}var tg=0;function qm(e,t){return e.stylesheets&&e.count===0&&Vp(e,e.stylesheets),0<e.count||0<e.imgCount?function(a){var u=setTimeout(function(){if(e.stylesheets&&Vp(e,e.stylesheets),e.unsuspend){var S=e.unsuspend;e.unsuspend=null,S()}},6e4+t);0<e.imgBytes&&tg===0&&(tg=62500*Tm());var h=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Vp(e,e.stylesheets),e.unsuspend)){var S=e.unsuspend;e.unsuspend=null,S()}},(e.imgBytes>tg?50:800)+t);return e.unsuspend=a,function(){e.unsuspend=null,clearTimeout(u),clearTimeout(h)}}:null}function Up(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Vp(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Ep=null;function Vp(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Ep=new Map,t.forEach(Hm,e),Ep=null,Up.call(e))}function Hm(e,t){if(!(t.state.loading&4)){var a=Ep.get(e);if(a)var u=a.get(null);else{a=new Map,Ep.set(e,a);for(var h=e.querySelectorAll("link[data-precedence],style[data-precedence]"),S=0;S<h.length;S++){var B=h[S];(B.nodeName==="LINK"||B.getAttribute("media")!=="not all")&&(a.set(B.dataset.precedence,B),u=B)}u&&a.set(null,u)}h=t.instance,B=h.getAttribute("data-precedence"),S=a.get(B)||u,S===u&&a.set(null,h),a.set(B,h),this.count++,u=Up.bind(this),h.addEventListener("load",u),h.addEventListener("error",u),S?S.parentNode.insertBefore(h,S.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(h,e.firstChild)),t.state.loading|=4}}var Vf={$$typeof:E,Provider:null,Consumer:null,_currentValue:Ne,_currentValue2:Ne,_threadCount:0};function Wm(e,t,a,u,h,S,B,ce,Fe){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ni(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ni(0),this.hiddenUpdates=ni(null),this.identifierPrefix=u,this.onUncaughtError=h,this.onCaughtError=S,this.onRecoverableError=B,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Fe,this.incompleteTransitions=new Map}function n1(e,t,a,u,h,S,B,ce,Fe,it,wt,Dt){return e=new Wm(e,t,a,B,Fe,it,wt,Dt,ce),t=1,S===!0&&(t|=24),S=Ai(3,null,null,t),e.current=S,S.stateNode=e,t=Co(),t.refCount++,e.pooledCache=t,t.refCount++,S.memoizedState={element:u,isDehydrated:a,cache:t},Ut(S),e}function i1(e){return e?(e=Yr,e):Yr}function r1(e,t,a,u,h,S){h=i1(h),u.context===null?u.context=h:u.pendingContext=h,u=Gn(t),u.payload={element:a},S=S===void 0?null:S,S!==null&&(u.callback=S),a=ei(e,u,t),a!==null&&(Wn(a,e,t),wr(a,e,t))}function o1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<t?a:t}}function ng(e,t){o1(e,t),(e=e.alternate)&&o1(e,t)}function a1(e){if(e.tag===13||e.tag===31){var t=dl(e,67108864);t!==null&&Wn(t,e,67108864),ng(e,67108864)}}function s1(e){if(e.tag===13||e.tag===31){var t=vn();t=or(t);var a=dl(e,t);a!==null&&Wn(a,e,t),ng(e,t)}}var qp=!0;function $m(e,t,a,u){var h=ee.T;ee.T=null;var S=de.p;try{de.p=2,ig(e,t,a,u)}finally{de.p=S,ee.T=h}}function Ym(e,t,a,u){var h=ee.T;ee.T=null;var S=de.p;try{de.p=8,ig(e,t,a,u)}finally{de.p=S,ee.T=h}}function ig(e,t,a,u){if(qp){var h=rg(u);if(h===null)qh(e,t,u,Hp,a),c1(e,u);else if(Xm(h,e,t,a,u))u.stopPropagation();else if(c1(e,u),t&4&&-1<Gm.indexOf(e)){for(;h!==null;){var S=Ci(h);if(S!==null)switch(S.tag){case 3:if(S=S.stateNode,S.current.memoizedState.isDehydrated){var B=pn(S.pendingLanes);if(B!==0){var ce=S;for(ce.pendingLanes|=2,ce.entangledLanes|=2;B;){var Fe=1<<31-Pt(B);ce.entanglements[1]|=Fe,B&=~Fe}Gc(S),(c&6)===0&&(It=Sn()+500,Mf(0))}}break;case 31:case 13:ce=dl(S,2),ce!==null&&Wn(ce,S,2),Vr(),ng(S,2)}if(S=rg(u),S===null&&qh(e,t,u,Hp,a),S===h)break;h=S}h!==null&&u.stopPropagation()}else qh(e,t,u,null,a)}}function rg(e){return e=Oa(e),og(e)}var Hp=null;function og(e){if(Hp=null,e=pr(e),e!==null){var t=d(e);if(t===null)e=null;else{var a=t.tag;if(a===13){if(e=b(t),e!==null)return e;e=null}else if(a===31){if(e=p(t),e!==null)return e;e=null}else if(a===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Hp=e,null}function l1(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(mn()){case tt:return 2;case Bt:return 8;case Gt:case an:return 32;case dt:return 268435456;default:return 32}default:return 32}}var ag=!1,Bu=null,Ou=null,Fu=null,qf=new Map,Hf=new Map,Uu=[],Gm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function c1(e,t){switch(e){case"focusin":case"focusout":Bu=null;break;case"dragenter":case"dragleave":Ou=null;break;case"mouseover":case"mouseout":Fu=null;break;case"pointerover":case"pointerout":qf.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hf.delete(t.pointerId)}}function Wf(e,t,a,u,h,S){return e===null||e.nativeEvent!==S?(e={blockedOn:t,domEventName:a,eventSystemFlags:u,nativeEvent:S,targetContainers:[h]},t!==null&&(t=Ci(t),t!==null&&a1(t)),e):(e.eventSystemFlags|=u,t=e.targetContainers,h!==null&&t.indexOf(h)===-1&&t.push(h),e)}function Xm(e,t,a,u,h){switch(t){case"focusin":return Bu=Wf(Bu,e,t,a,u,h),!0;case"dragenter":return Ou=Wf(Ou,e,t,a,u,h),!0;case"mouseover":return Fu=Wf(Fu,e,t,a,u,h),!0;case"pointerover":var S=h.pointerId;return qf.set(S,Wf(qf.get(S)||null,e,t,a,u,h)),!0;case"gotpointercapture":return S=h.pointerId,Hf.set(S,Wf(Hf.get(S)||null,e,t,a,u,h)),!0}return!1}function u1(e){var t=pr(e.target);if(t!==null){var a=d(t);if(a!==null){if(t=a.tag,t===13){if(t=b(a),t!==null){e.blockedOn=t,ui(e.priority,function(){s1(a)});return}}else if(t===31){if(t=p(a),t!==null){e.blockedOn=t,ui(e.priority,function(){s1(a)});return}}else if(t===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Wp(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var a=rg(e.nativeEvent);if(a===null){a=e.nativeEvent;var u=new a.constructor(a.type,a);ps=u,a.target.dispatchEvent(u),ps=null}else return t=Ci(a),t!==null&&a1(t),e.blockedOn=a,!1;t.shift()}return!0}function d1(e,t,a){Wp(e)&&a.delete(t)}function Km(){ag=!1,Bu!==null&&Wp(Bu)&&(Bu=null),Ou!==null&&Wp(Ou)&&(Ou=null),Fu!==null&&Wp(Fu)&&(Fu=null),qf.forEach(d1),Hf.forEach(d1)}function $p(e,t){e.blockedOn===t&&(e.blockedOn=null,ag||(ag=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Km)))}var Yp=null;function f1(e){Yp!==e&&(Yp=e,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Yp===e&&(Yp=null);for(var t=0;t<e.length;t+=3){var a=e[t],u=e[t+1],h=e[t+2];if(typeof u!="function"){if(og(u||a)===null)continue;break}var S=Ci(a);S!==null&&(e.splice(t,3),t-=3,vf(S,{pending:!0,data:h,method:a.method,action:u},u,h))}}))}function Qd(e){function t(Fe){return $p(Fe,e)}Bu!==null&&$p(Bu,e),Ou!==null&&$p(Ou,e),Fu!==null&&$p(Fu,e),qf.forEach(t),Hf.forEach(t);for(var a=0;a<Uu.length;a++){var u=Uu[a];u.blockedOn===e&&(u.blockedOn=null)}for(;0<Uu.length&&(a=Uu[0],a.blockedOn===null);)u1(a),a.blockedOn===null&&Uu.shift();if(a=(e.ownerDocument||e).$$reactFormReplay,a!=null)for(u=0;u<a.length;u+=3){var h=a[u],S=a[u+1],B=h[Et]||null;if(typeof S=="function")B||f1(a);else if(B){var ce=null;if(S&&S.hasAttribute("formAction")){if(h=S,B=S[Et]||null)ce=B.formAction;else if(og(h)!==null)continue}else ce=B.action;typeof ce=="function"?a[u+1]=ce:(a.splice(u,3),u-=3),f1(a)}}}function p1(){function e(S){S.canIntercept&&S.info==="react-transition"&&S.intercept({handler:function(){return new Promise(function(B){return h=B})},focusReset:"manual",scroll:"manual"})}function t(){h!==null&&(h(),h=null),u||setTimeout(a,20)}function a(){if(!u&&!navigation.transition){var S=navigation.currentEntry;S&&S.url!=null&&navigation.navigate(S.url,{state:S.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,h=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(a,100),function(){u=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),h!==null&&(h(),h=null)}}}function sg(e){this._internalRoot=e}Gp.prototype.render=sg.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(s(409));var a=t.current,u=vn();r1(a,u,e,t,null,null)},Gp.prototype.unmount=sg.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;r1(e.current,2,null,e,null,null),Vr(),t[En]=null}};function Gp(e){this._internalRoot=e}Gp.prototype.unstable_scheduleHydration=function(e){if(e){var t=Yn();e={blockedOn:null,target:e,priority:t};for(var a=0;a<Uu.length&&t!==0&&t<Uu[a].priority;a++);Uu.splice(a,0,e),a===0&&u1(e)}};var h1=r.version;if(h1!=="19.2.0")throw Error(s(527,h1,"19.2.0"));de.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(s(188)):(e=Object.keys(e).join(","),Error(s(268,e)));return e=m(t),e=e!==null?j(e):null,e=e===null?null:e.stateNode,e};var Zm={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:ee,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xp.isDisabled&&Xp.supportsFiber)try{we=Xp.inject(Zm),st=Xp}catch{}}return Yf.createRoot=function(e,t){if(!l(e))throw Error(s(299));var a=!1,u="",h=Ml,S=Nd,B=mp;return t!=null&&(t.unstable_strictMode===!0&&(a=!0),t.identifierPrefix!==void 0&&(u=t.identifierPrefix),t.onUncaughtError!==void 0&&(h=t.onUncaughtError),t.onCaughtError!==void 0&&(S=t.onCaughtError),t.onRecoverableError!==void 0&&(B=t.onRecoverableError)),t=n1(e,1,!1,null,null,a,u,null,h,S,B,p1),e[En]=t.current,Vh(e),new sg(t)},Yf.hydrateRoot=function(e,t,a){if(!l(e))throw Error(s(299));var u=!1,h="",S=Ml,B=Nd,ce=mp,Fe=null;return a!=null&&(a.unstable_strictMode===!0&&(u=!0),a.identifierPrefix!==void 0&&(h=a.identifierPrefix),a.onUncaughtError!==void 0&&(S=a.onUncaughtError),a.onCaughtError!==void 0&&(B=a.onCaughtError),a.onRecoverableError!==void 0&&(ce=a.onRecoverableError),a.formState!==void 0&&(Fe=a.formState)),t=n1(e,1,!0,t,a??null,u,h,Fe,S,B,ce,p1),t.context=i1(null),a=t.current,u=vn(),u=or(u),h=Gn(u),h.callback=null,ei(a,h,u),a=u,t.current.lanes=a,nn(t,a),Gc(t),e[En]=t.current,Vh(e),new Gp(t)},Yf.version="19.2.0",Yf}var C1;function l2(){if(C1)return ug.exports;C1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(r){console.error(r)}}return n(),ug.exports=s2(),ug.exports}var c2=l2();/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u2=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),d2=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(r,o,s)=>s?s.toUpperCase():o.toLowerCase()),j1=n=>{const r=d2(n);return r.charAt(0).toUpperCase()+r.slice(1)},Jy=(...n)=>n.filter((r,o,s)=>!!r&&r.trim()!==""&&s.indexOf(r)===o).join(" ").trim(),f2=n=>{for(const r in n)if(r.startsWith("aria-")||r==="role"||r==="title")return!0};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var p2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h2=I.forwardRef(({color:n="currentColor",size:r=24,strokeWidth:o=2,absoluteStrokeWidth:s,className:l="",children:d,iconNode:b,...p},v)=>I.createElement("svg",{ref:v,...p2,width:r,height:r,stroke:n,strokeWidth:s?Number(o)*24/Number(r):o,className:Jy("lucide",l),...!d&&!f2(p)&&{"aria-hidden":"true"},...p},[...b.map(([m,j])=>I.createElement(m,j)),...Array.isArray(d)?d:[d]]));/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qy=(n,r)=>{const o=I.forwardRef(({className:s,...l},d)=>I.createElement(h2,{ref:d,iconNode:r,className:Jy(`lucide-${u2(j1(n))}`,`lucide-${n}`,s),...l}));return o.displayName=j1(n),o};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g2=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],y2=Qy("mouse-pointer",g2);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x2=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],m2=Qy("pen-line",x2),b2=JSON.parse('[{"category":"Capacitors","subcategory":"General","type":"Capacitor","displayName":"Capacitor","description":"General purpose capacitor","searchText":"capacitor general","designator":"C","defaultPins":2,"properties":{"capacitorType":"General"},"fields":[{"name":"capacitance","label":"Capacitance","type":"number","units":["pF","nF","F","mF","F"],"defaultUnit":"F","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"tolerance","label":"Tolerance","type":"string","required":false},{"name":"dielectric","label":"Dielectric","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Capacitors","subcategory":"Electrolytic","type":"Capacitor","displayName":"Electrolytic","description":"Electrolytic capacitor","searchText":"electrolytic capacitor","designator":"CE","defaultPins":2,"properties":{"capacitorType":"Electrolytic","polarized":true},"fields":[{"name":"capacitance","label":"Capacitance","type":"number","units":["pF","nF","F","mF","F"],"defaultUnit":"F","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"tolerance","label":"Tolerance","type":"string","defaultValue":"20%","required":false},{"name":"esr","label":"ESR","type":"number","units":["m",""],"defaultUnit":"","required":false},{"name":"temperature","label":"Temperature Range","type":"string","required":false},{"name":"ripple","label":"Ripple Current","type":"number","units":["mA","A"],"defaultUnit":"mA","required":false},{"name":"leakageCurrent","label":"Leakage Current","type":"number","units":["A","mA"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Capacitors","subcategory":"Film","type":"Capacitor","displayName":"Film","description":"Film capacitor","searchText":"film capacitor","designator":"CF","defaultPins":2,"properties":{"capacitorType":"Film"},"fields":[{"name":"capacitance","label":"Capacitance","type":"number","units":["pF","nF","F","mF","F"],"defaultUnit":"nF","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"tolerance","label":"Tolerance","type":"string","defaultValue":"10%","required":false},{"name":"filmType","label":"Film Type","type":"enum","enumValues":["Polyester","Polypropylene","Polyethylene","Polystyrene","Teflon"],"defaultValue":"Polyester","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Capacitors","subcategory":"Tantalum","type":"Capacitor","displayName":"Tantalum","description":"Tantalum capacitor","searchText":"tantalum capacitor","designator":"C","defaultPins":2,"properties":{"capacitorType":"Tantalum","dielectric":"Tantalum","polarized":true},"fields":[{"name":"capacitance","label":"Capacitance","type":"number","units":["pF","nF","F","mF","F"],"defaultUnit":"F","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"tolerance","label":"Tolerance","type":"string","required":false},{"name":"esr","label":"ESR","type":"number","units":["m",""],"defaultUnit":"","required":false},{"name":"leakageCurrent","label":"Leakage Current","type":"number","units":["A","mA"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Diodes","subcategory":"Standard","type":"Diode","displayName":"Diode","description":"Standard diode","searchText":"diode standard","designator":"D","defaultPins":2,"subtype":"Standard","properties":{"diodeType":"Standard","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"Zener","type":"Diode","displayName":"Zener","description":"Zener diode","searchText":"zener diode","designator":"Z","defaultPins":2,"subtype":"Zener","properties":{"diodeType":"Zener","polarized":true},"fields":[{"name":"voltage","label":"Zener Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"mA","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"LED","type":"Diode","displayName":"LED","description":"LED diode","searchText":"led diode","designator":"LED","defaultPins":2,"subtype":"LED","properties":{"diodeType":"LED","polarized":true},"fields":[{"name":"voltage","label":"Forward Voltage","type":"number","units":["mV","V"],"defaultUnit":"V","required":false},{"name":"current","label":"Forward Current","type":"number","units":["mA","A"],"defaultUnit":"mA","required":false},{"name":"ledColor","label":"Color","type":"string","required":false},{"name":"wavelength","label":"Wavelength","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"Schottky","type":"Diode","displayName":"Schottky","description":"Schottky diode","searchText":"schottky diode","designator":"D","defaultPins":2,"subtype":"Schottky","properties":{"diodeType":"Schottky","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"Infrared","type":"Diode","displayName":"Infrared","description":"Infrared diode","searchText":"infrared diode","designator":"IR","defaultPins":2,"subtype":"Infrared","properties":{"diodeType":"Infrared","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["mA","A"],"defaultUnit":"mA","required":false},{"name":"wavelength","label":"Wavelength","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"Photodiode","type":"Diode","displayName":"Photodiode","description":"Photodiode","searchText":"photodiode diode","designator":"PD","defaultPins":2,"subtype":"Photodiode","properties":{"diodeType":"Photodiode","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"wavelength","label":"Wavelength","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Resistors","subcategory":"Standard","type":"Resistor","displayName":"Resistor","description":"Standard resistor","searchText":"resistor standard","designator":"R","defaultPins":2,"properties":{"resistorType":"Standard"},"fields":[{"name":"resistance","label":"Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"tolerance","label":"Tolerance","type":"string","defaultValue":"5%","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Resistors","subcategory":"Network","type":"Resistor","displayName":"Resistor Network","description":"Resistor network","searchText":"resistor network","designator":"RN","defaultPins":8,"properties":{"resistorType":"Network"},"fields":[{"name":"resistance","label":"Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"configuration","label":"Configuration","type":"enum","enumValues":["Isolated","Bussed","Dual Terminator"],"defaultValue":"Isolated","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Resistors","subcategory":"Thermistor","type":"Resistor","displayName":"Thermistor","description":"Thermistor resistor","searchText":"thermistor resistor","designator":"RT","defaultPins":2,"properties":{"resistorType":"Thermistor"},"fields":[{"name":"resistance","label":"Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"thermistorType","label":"Thermistor Type","type":"enum","enumValues":["NTC","PTC"],"defaultValue":"NTC","required":false},{"name":"beta","label":"Beta Value","type":"number","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Resistors","subcategory":"Variable","type":"Resistor","displayName":"Variable Resistor","description":"Variable resistor","searchText":"variable resistor","designator":"VR","defaultPins":3,"subtype":"Potentiometer","properties":{"resistorType":"Variable","vrType":"Potentiometer"},"fields":[{"name":"resistance","label":"Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"taper","label":"Taper","type":"enum","enumValues":["Linear","Logarithmic"],"defaultValue":"Linear","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Resistors","subcategory":"Varistor","type":"Resistor","displayName":"Varistor","description":"Varistor resistor","searchText":"varistor resistor","designator":"RV","defaultPins":3,"subtype":"Varistor","properties":{"resistorType":"Variable","vrType":"Varistor"},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"BJT","type":"Semiconductor","displayName":"Transistor, BJT NPN","description":"Bipolar Junction Transistor NPN (Collector, Base, Emitter)","searchText":"bjt transistor bipolar junction base emitter collector npn","designator":"Q","defaultPins":3,"properties":{"semiconductorType":"Transistor","transistorType":"BJT","pinNames":["Collector","Base","Emitter"]},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"BJT PNP","type":"Semiconductor","displayName":"Transistor, BJT PNP","description":"Bipolar Junction Transistor PNP (Emitter, Base, Collector)","searchText":"bjt transistor bipolar junction base emitter collector pnp","designator":"Q","defaultPins":3,"properties":{"semiconductorType":"Transistor","transistorType":"BJT","pinNames":["Emitter","Base","Collector"]},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"MOSFET","type":"Semiconductor","displayName":"Transistor, MOSFET, N-Channel","description":"Metal-Oxide-Semiconductor Field-Effect Transistor N-Channel (Source, Gate, Drain)","searchText":"mosfet transistor metal oxide semiconductor field effect source gate drain n-channel","designator":"Q","defaultPins":3,"properties":{"semiconductorType":"Transistor","transistorType":"MOSFET","pinNames":["Source","Drain","Gate"]},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"MOSFET P-Channel","type":"Semiconductor","displayName":"Transistor, MOSFET, P-Channel","description":"Metal-Oxide-Semiconductor Field-Effect Transistor P-Channel (Source, Gate, Drain)","searchText":"mosfet transistor metal oxide semiconductor field effect source gate drain p-channel","designator":"Q","defaultPins":3,"properties":{"semiconductorType":"Transistor","transistorType":"MOSFET","pinNames":["Source","Drain","Gate"]},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"JFET","type":"Semiconductor","displayName":"Transistor, JFET","description":"Junction Field-Effect Transistor (Source, Gate, Drain)","searchText":"jfet transistor junction field effect source gate drain n-channel p-channel","designator":"Q","defaultPins":3,"properties":{"semiconductorType":"Transistor","transistorType":"JFET","pinNames":["Source","Gate","Drain"]},"fields":[{"name":"polarity","label":"Polarity","type":"enum","enumValues":["N-Channel","P-Channel"],"defaultValue":"N-Channel","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"Single Op Amp","type":"Semiconductor","displayName":"Op Amp, Single","description":"Single operational amplifier","searchText":"single op amp operational amplifier opamp","designator":"U","defaultPins":5,"properties":{"semiconductorType":"OpAmp","pinNames":["V+","V-","input+","input-","output"]},"fields":[{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"packageType","label":"Package Type","type":"enum","enumValues":["SOT-23-5","SC70-5","Other"],"defaultValue":"SOT-23-5","required":false},{"name":"voltage","label":"Supply Voltage","type":"number","units":["V","mV"],"defaultUnit":"V","required":false},{"name":"description","label":"Description","type":"string","required":false},{"name":"datasheet","label":"Datasheet URL","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"Dual Op Amp","type":"Semiconductor","displayName":"Op Amp, Dual","description":"Dual operational amplifier","searchText":"dual op amp operational amplifier opamp","designator":"U","defaultPins":8,"properties":{"semiconductorType":"OpAmp","pinNames":["Output 1","Input 1-","Input 1+","VEE / GND","Input 2+","Input 2-","Output 2","VCC / V+"]},"fields":[{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"packageType","label":"Package Type","type":"enum","enumValues":["DIP-8","SOIC-8","DIP-14","SOIC-14","SOT-23-5","Other"],"defaultValue":"DIP-8","required":false},{"name":"voltage","label":"Supply Voltage","type":"number","units":["V","mV"],"defaultUnit":"V","required":false},{"name":"description","label":"Description","type":"string","required":false},{"name":"datasheet","label":"Datasheet URL","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"Quad Op Amp","type":"Semiconductor","displayName":"Op Amp, Quad","description":"Quad operational amplifier","searchText":"quad op amp operational amplifier opamp","designator":"U","defaultPins":14,"properties":{"semiconductorType":"OpAmp","pinNames":["1OUT","1IN-","1IN+","VCC+","2IN+","2IN-","2OUT","3OUT","3IN-","3IN+","VCC-","4IN+","4IN-","4OUT"]},"fields":[{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"packageType","label":"Package Type","type":"enum","enumValues":["DIP-14","SOIC-14","TSSOP-14","Other"],"defaultValue":"DIP-14","required":false},{"name":"voltage","label":"Supply Voltage","type":"number","units":["V","mV"],"defaultUnit":"V","required":false},{"name":"description","label":"Description","type":"string","required":false},{"name":"datasheet","label":"Datasheet URL","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"Integrated Circuit","type":"Semiconductor","displayName":"Integrated Circuit","description":"Integrated circuit","searchText":"integrated circuit semiconductor ic","designator":"U","defaultPins":8,"fixedPinCount":false,"properties":{"semiconductorType":"IntegratedCircuit","pinNames":["CHIP_DEPENDENT"]},"fields":[{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"icType","label":"IC Type","type":"string","required":false},{"name":"packageType","label":"Package Type","type":"enum","enumValues":["DIP","SOIC","QFP","LQFP","TQFP","BGA","SSOP","TSOP","Various","Other"],"required":false},{"name":"description","label":"Description","type":"string","required":false},{"name":"datasheet","label":"Datasheet URL","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Passive Components","subcategory":"Inductor","type":"Inductor","displayName":"Inductor","description":"Inductor","searchText":"inductor","designator":"L","defaultPins":2,"properties":{"passiveType":"Inductor"},"fields":[{"name":"inductance","label":"Inductance","type":"number","units":["nH","H","mH","H"],"defaultUnit":"H","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"resistance","label":"DC Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Passive Components","subcategory":"Ferrite Bead","type":"FerriteBead","displayName":"Ferrite Bead","description":"Ferrite bead","searchText":"ferrite bead passive","designator":"FB","defaultPins":2,"properties":{"passiveType":"FerriteBead"},"fields":[{"name":"impedance","label":"Impedance","type":"number","units":["","m","k"],"defaultUnit":"","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Passive Components","subcategory":"Crystal","type":"Crystal","displayName":"Crystal","description":"Crystal oscillator","searchText":"crystal oscillator passive","designator":"X","defaultPins":2,"properties":{"passiveType":"Crystal"},"fields":[{"name":"frequency","label":"Frequency","type":"string","required":false},{"name":"loadCapacitance","label":"Load Capacitance","type":"string","required":false},{"name":"tolerance","label":"Tolerance","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Power & Energy","subcategory":"Battery","type":"PowerEnergy","displayName":"Battery","description":"Battery or battery holder","searchText":"battery power energy","designator":"B","defaultPins":2,"properties":{"powerType":"Battery","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"capacity","label":"Capacity","type":"number","units":["mAh","Ah"],"defaultUnit":"mAh","required":false},{"name":"chemistry","label":"Chemistry","type":"enum","enumValues":["Li-ion","Alkaline","NiMH","NiCd","Lead-acid"],"required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Power & Energy","subcategory":"Power Supply","type":"PowerEnergy","displayName":"Power Supply","description":"Power supply","searchText":"power supply energy","designator":"PS","defaultPins":4,"properties":{"powerType":"PowerSupply"},"fields":[{"name":"inputVoltage","label":"Input Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"outputVoltage","label":"Output Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"efficiency","label":"Efficiency","type":"number","required":false},{"name":"ripple","label":"Ripple","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Power & Energy","subcategory":"Fuse","type":"PowerEnergy","displayName":"Fuse","description":"Fuse","searchText":"fuse power energy","designator":"F","defaultPins":2,"properties":{"powerType":"Fuse"},"fields":[{"name":"current","label":"Current Rating","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"fuseType","label":"Fuse Type","type":"enum","enumValues":["Fast-blow","Slow-blow","Time-delay"],"defaultValue":"Fast-blow","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Connectors & Switches","subcategory":"Connector","type":"Connector","displayName":"Connector","description":"Connector","searchText":"connector","designator":"J","defaultPins":2,"properties":{"connectorType":"Connector"},"fields":[{"name":"connectorType","label":"Connector Type","type":"string","required":false},{"name":"gender","label":"Gender","type":"enum","enumValues":["Male","Female","N/A"],"defaultValue":"N/A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Connectors & Switches","subcategory":"Jumper","type":"Jumper","displayName":"Jumper","description":"Jumper link","searchText":"jumper link","designator":"JP","defaultPins":2,"properties":{"connectorType":"Jumper"},"fields":[{"name":"positions","label":"Positions","type":"number","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Connectors & Switches","subcategory":"Switch","type":"Switch","displayName":"Switch","description":"Switch","searchText":"switch","designator":"S","defaultPins":2,"properties":{"switchType":"Switch"},"fields":[{"name":"switchType","label":"Switch Type","type":"string","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Connectors & Switches","subcategory":"Relay","type":"Relay","displayName":"Relay","description":"Relay or contactor","searchText":"relay contactor","designator":"K","defaultPins":2,"properties":{"switchType":"Relay"},"fields":[{"name":"coilVoltage","label":"Coil Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"contactType","label":"Contact Type","type":"string","required":false},{"name":"current","label":"Contact Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Other","subcategory":"Transformer","type":"Transformer","displayName":"Transformer","description":"Transformer","searchText":"transformer","designator":"TR","defaultPins":4,"fields":[{"name":"primaryVoltage","label":"Primary Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"secondaryVoltage","label":"Secondary Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"turns","label":"Turns Ratio","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Speaker","type":"Speaker","displayName":"Speaker","description":"Loudspeaker or buzzer","searchText":"speaker loudspeaker buzzer","designator":"LS","defaultPins":2,"fields":[{"name":"impedance","label":"Impedance","type":"number","units":["","m","k"],"defaultUnit":"","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Motor","type":"Motor","displayName":"Motor","description":"Motor","searchText":"motor","designator":"M","defaultPins":2,"fields":[{"name":"motorType","label":"Motor Type","type":"string","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Test Point","type":"TestPoint","displayName":"Test Point","description":"Test point","searchText":"test point","designator":"TP","defaultPins":1,"fields":[{"name":"signal","label":"Signal","type":"string","required":false}]},{"category":"Other","subcategory":"Vacuum Tube","type":"VacuumTube","displayName":"Vacuum Tube","description":"Vacuum tube","searchText":"vacuum tube","designator":"V","defaultPins":5,"fields":[{"name":"tubeType","label":"Tube Type","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Attenuator","type":"GenericComponent","displayName":"Attenuator","description":"Attenuator or isolator","searchText":"attenuator isolator component","designator":"AT","defaultPins":2,"subtype":"Attenuator","fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Circuit Breaker","type":"GenericComponent","displayName":"Circuit Breaker","description":"Circuit breaker","searchText":"circuit breaker component","designator":"CB","defaultPins":2,"subtype":"CircuitBreaker","fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Thermocouple","type":"GenericComponent","displayName":"Thermocouple","description":"Thermocouple","searchText":"thermocouple component","designator":"TC","defaultPins":2,"subtype":"Thermocouple","fields":[{"name":"model","label":"Model","type":"string","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Tuner","type":"GenericComponent","displayName":"Tuner","description":"Tuner","searchText":"tuner component","designator":"TUN","defaultPins":2,"subtype":"Tuner","fields":[{"name":"frequency","label":"Frequency","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]}]'),bh={components:b2},v2=["#FFFFFF","#BFBFBF","#7F7F7F","#3C3C3C","#000000","#A6CEE3","#56B4E9","#17BECF","#00BFC4","#1F77B4","#0072B2","#332288","#B2DF8A","#B3DE69","#2CA02C","#009E73","#FFED6F","#F0E442","#BCBD22","#E69F00","#FF7F0E","#FB9A99","#F781BF","#E15759","#D62728","#CAB2D6","#CC79A7","#AA4499","#6A3D9A","#9467BD","#9C755F","#8C564B"],hg="#2CA02C",w2="#F0E442",S2="#00BFC4",gg="#000000",T2="#00008b",yg="#FF0000",l0={DEFAULT_SIZE:18},Qf={};bh.components.forEach(n=>{const r=n.type,o=n.designator;if(!Qf[r])Qf[r]={prefix:[o],defaultPins:n.defaultPins};else{const s=Qf[r],l=[...new Set([...s.prefix,o])];Qf[r]={prefix:l,defaultPins:s.defaultPins}}});const c0=Qf,ef={};bh.components.forEach(n=>{if(ef[n.category]||(ef[n.category]={}),!ef[n.category][n.subcategory])ef[n.category][n.subcategory]=[n.type];else{const r=ef[n.category][n.subcategory];r.includes(n.type)||(ef[n.category][n.subcategory]=[...r,n.type])}});const xg={DEFAULT_SIZE:18},ex={resistance:{validUnits:["","m","k","M"],defaultUnit:""},capacitance:{validUnits:["pF","nF","F","mF","F"],defaultUnit:"F"},voltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},current:{validUnits:["A","mA","A"],defaultUnit:"A"},power:{validUnits:["W","mW","kW"],defaultUnit:"W"},inductance:{validUnits:["nH","H","mH","H"],defaultUnit:"H"},impedance:{validUnits:["","m","k"],defaultUnit:""},capacity:{validUnits:["mAh","Ah"],defaultUnit:"mAh"},inputVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},outputVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},coilVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},primaryVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},secondaryVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},esr:{validUnits:["m",""],defaultUnit:""}};function dr(n){return ex[n]?.validUnits||[]}function dn(n){return ex[n]?.defaultUnit||""}function Wl(n){return n.includes(" ")?n:n.replace(/([a-z])([A-Z])/g,"$1 $2")}const Xa=Math.PI*2;function tx(n){return(n%360+360)%360}function Cu(n){return n*Math.PI/180}function C2(n){return n*180/Math.PI}function Wg(n,r){return tx(n+r)}function hh(n){return Math.tan(n)}function j2(n){return Math.cos(n)}function N2(n){return Math.sin(n)}function k2(n,r){return Math.atan2(n,r)}function A2(n,r){return C2(k2(r,n))}function $g(n,r){const{x:o,y:s,rotation:l=0,scale:d=1,flipX:b=!1,flipY:p=!1,skewX:v=0,skewY:m=0}=r;if(n.translate(o,s),l!==0&&n.rotate(Cu(l)),v!==0||m!==0){const M=hh(v),T=hh(m);n.transform(1,T,M,1,0,0)}const j=d*(b?-1:1),_=d*(p?-1:1);(j!==1||_!==1)&&n.scale(j,_)}function N1(n,r,o,s=0,l=!1,d=!1){$g(n,{x:r,y:o,rotation:s,flipX:l,flipY:d})}function nx(n,r,o){const s=Cu(o),l=j2(s),d=N2(s);return{x:n*l-r*d,y:n*d+r*l}}function P2(n,r=0,o=!1){o&&n.scale(-1,1),r!==0&&n.rotate(Cu(r))}function z2(n,r=0,o=!1){const s=tx(r),l=s===90||s===270;o&&n.scale(-1,1),r!==0&&n.rotate(Cu(-r)),o&&l&&n.rotate(Cu(180))}function k1(n,r,o,s=0,l=!1){let d=n/o,b=r/o;if(s!==0){const p=nx(d,b,-s);d=p.x,b=p.y}return l&&(d=-d),{x:d,y:b}}function Gf(n,r,o,s,l=0,d=!1){let b=n-o.x,p=r-o.y;if(b=b/s,p=p/s,d&&(b=-b),l!==0){const v=nx(b,p,-l);b=v.x,p=v.y}return{x:b,y:p}}function _2(n,r=.4){if(n.startsWith("#")){const s=n.slice(1),l=parseInt(s.slice(0,2),16),d=parseInt(s.slice(2,4),16),b=parseInt(s.slice(4,6),16),p=Math.max(0,Math.floor(l*(1-r))),v=Math.max(0,Math.floor(d*(1-r))),m=Math.max(0,Math.floor(b*(1-r)));return`#${p.toString(16).padStart(2,"0")}${v.toString(16).padStart(2,"0")}${m.toString(16).padStart(2,"0")}`}const o=n.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*[\d.]+)?\)/);if(o){const s=parseInt(o[1],10),l=parseInt(o[2],10),d=parseInt(o[3],10),b=o[4]?o[4].trim():"",p=Math.max(0,Math.floor(s*(1-r))),v=Math.max(0,Math.floor(l*(1-r))),m=Math.max(0,Math.floor(d*(1-r)));return n.includes("rgba")?`rgba(${p}, ${v}, ${m}${b?`, ${b}`:", 1"})`:`rgb(${p}, ${v}, ${m})`}return n}let sl=1;const uc=new Set;function lc(){const n=sl;if(sl++,uc.has(n)){for(console.error(`CRITICAL ERROR: Duplicate Node ID ${n} would be allocated!`),console.error(`Current counter: ${sl}, Allocated IDs count: ${uc.size}`);uc.has(sl);)sl++;const r=sl;return sl++,uc.add(r),console.error(`Recovered by allocating ID ${r} instead`),r}return uc.add(n),n}function Kp(n){n<1&&(console.warn(`setPointIdCounter called with invalid value ${n}, using 1`),n=1),sl=n,uc.clear()}function mg(){return sl}function ep(){sl=1,uc.clear()}function bg(n){n>0&&(uc.add(n),n>=sl&&(sl=n+1))}function Zp(n){if(n>0&&uc.has(n))if(uc.delete(n),uc.size>0){const r=Math.max(...Array.from(uc));r<sl&&(sl=Math.max(1,r+1))}else sl=1}function ix(n="id"){return`${n}-${Date.now()}-${Math.random().toString(36).slice(2,11)}`}function A1(n){return Math.round(n*1e4)/1e4}function xr(n){return{x:A1(n.x),y:A1(n.y)}}const Gu=bh.components;Gu.map(n=>({designator:n.designator,componentType:n.description}));function ll(n){if(!n)return;const r=n.componentDefinitionKey;if(r){const s=Gu.find(l=>`${l.category}:${l.subcategory}:${l.type}`===r);if(s)return s}if(typeof n.designator=="string"&&n.designator.trim()!==""){const s=n.designator.trim().match(/^[A-Za-z]+/),l=s?s[0]:null;if(l){const d=Gu.find(b=>Array.isArray(b.designators)&&b.designators.includes(l));if(d)return d}}const o=n.componentType==="Electrolytic Capacitor"||n.componentType==="Film Capacitor"?"Capacitor":n.componentType;return Gu.find(s=>{if(s.type!==o)return!1;if(s.category==="Capacitors"){const l=n.capacitorType||n.dielectric;return!!(l&&s.properties?.capacitorType===l||!l)}if(s.category==="Diodes"){const l=n.diodeType;return!!(l&&s.properties?.diodeType===l||!s.properties?.diodeType)}if(s.category==="Resistors"){const l=n.resistorType,d=n.vrType;return!!(l&&s.properties?.resistorType===l||d&&s.properties?.vrType===d||!s.properties?.resistorType&&!s.properties?.vrType)}if(s.category==="Semiconductors"){const l=n.semiconductorType;return!!(l&&s.properties?.semiconductorType===l||!s.properties?.semiconductorType)}if(s.category==="Passive Components"){const l=n.passiveType;return!!(l&&s.properties?.passiveType===l||!s.properties?.passiveType)}if(s.category==="Power & Energy"){const l=n.powerType;return!!(l&&s.properties?.powerType===l||!s.properties?.powerType)}if(s.category==="Connectors & Switches"){const l=n.connectorType,d=n.switchType;return!!(l&&s.properties?.connectorType===l||d&&s.properties?.switchType===d||!s.properties?.connectorType&&!s.properties?.switchType)}if(n.componentType==="GenericComponent"){const l=n.genericType;return!!(l&&s.subtype===l)}return!0})}function vg(n){return(c0[n]?.prefix||["?"])[0]}function op(n){return ll(n)?.properties?.polarized===!0}function Yg(n,r,o){if(!op(n)||n.pinCount!==2||!(r.length===2&&r[0]&&r[0].trim()!==""&&r[1]&&r[1].trim()!==""))return null;const l=j=>{const _=parseInt(j,10);if(isNaN(_))return null;for(const M of o)if((M.type==="via"||M.type==="pad")&&M.points.length>0){const T=M.points[0];if(T.id===_)return{x:T.x,y:T.y}}return null},d=l(r[0]),b=l(r[1]);if(!d||!b)return null;const p=Math.hypot(n.x-d.x,n.y-d.y),v=Math.hypot(n.x-b.x,n.y-b.y),m=["",""];return p<v?(m[0]="-",m[1]="+"):(m[0]="+",m[1]="-"),m}function Xf(){return{}}function D2(n){}function R2(n,r,o){let s=0;for(const d of r)if(d.designator){const b=d.designator.match(new RegExp(`^${n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(\\d+)$`));if(b){const p=parseInt(b[1],10);p>s&&(s=p)}}const l=o[n]||0;return Math.max(s,l)+1}function P1(n,r,o){const s={...o};return s[n]=Math.max(s[n]||0,r),s}function I2(n){if(n.designator&&n.designator.trim()!=="")return n.designator.trim();switch(n.baseType){case"Capacitor":return"C";case"Diode":return"D";case"Resistor":return"R";case"Semiconductor":return"Q";case"Passive":return"L";case"PowerEnergy":return"PS";case"Connector":return"J";case"Switch":return"S";case"Transformer":return"T";case"Other":default:return"?"}}function L2(n,r,o){let s=0;for(const b of r){if(!b.designator||!b.designator.startsWith(n))continue;const p=parseInt(b.designator.slice(n.length),10);!isNaN(p)&&p>s&&(s=p)}const d=(o[n]??s)+1;return o[n]=d,d}function M2(n,r,o){const s=I2(n),l=L2(s,r,o);return`${s}${l}`}function B2(n){const{definition:r,layer:o,x:s,y:l,color:d,size:b,designator:p,existingComponents:v=[],counters:m={}}=n,j=b&&b>0?b:l0.DEFAULT_SIZE,_=p||M2(r,v,m),M={id:ix("comp"),componentType:r.type,designator:_,layer:o,x:s,y:l,color:d,size:j,pinCount:r.defaultPins,pinConnections:new Array(r.defaultPins).fill(""),pinPolarities:void 0,notes:null,orientation:0,flipX:!1,flipY:!1,description:r.description};if(M.componentDefinitionKey=r.key,r.properties&&Object.assign(M,r.properties),r.properties?.pinNames&&Array.isArray(r.properties.pinNames)){const T=r.properties.pinNames;T.includes("CHIP_DEPENDENT")?M.pinNames=new Array(M.pinCount).fill(""):M.pinNames=new Array(M.pinCount).fill("").map((P,k)=>k<T.length?T[k]:"")}return r.fields&&r.fields.length>0&&r.fields.forEach(T=>{T.defaultValue!==void 0&&T.defaultValue!==""&&(M[T.name]=T.defaultValue),T.units&&T.defaultUnit&&(M[`${T.name}Unit`]=T.defaultUnit)}),M}function O2(){const n=document.createElement("canvas"),r=24;n.width=r,n.height=r;const o=n.getContext("2d");o.strokeStyle="#000",o.lineWidth=3,o.lineCap="round";const s=r/2,l=8;return o.beginPath(),o.moveTo(s,s-l),o.lineTo(s,s-2),o.moveTo(s,s+2),o.lineTo(s,s+l),o.moveTo(s-l,s),o.lineTo(s-2,s),o.moveTo(s+2,s),o.lineTo(s+l,s),o.stroke(),`url(${n.toDataURL()}) ${s} ${s}, crosshair`}function F2(n){const r=document.createElement("canvas"),o=Math.max(12,Math.min(n,32)),l=o+4*2;r.width=l,r.height=l;const d=r.getContext("2d"),b=l/2,p=l/2,v=o/2;return d.fillStyle="#FFFF00",d.strokeStyle="#000000",d.lineWidth=2,d.beginPath(),d.moveTo(b,p-v),d.lineTo(b+v,p),d.lineTo(b,p+v),d.lineTo(b-v,p),d.closePath(),d.fill(),d.stroke(),`url(${r.toDataURL()}) ${b} ${p}, crosshair`}function z1(){const n=new Date,r=n.getFullYear(),o=String(n.getMonth()+1).padStart(2,"0"),s=String(n.getDate()).padStart(2,"0"),l=String(n.getHours()).padStart(2,"0"),d=String(n.getMinutes()).padStart(2,"0"),b=String(n.getSeconds()).padStart(2,"0");return`${r}_${o}_${s}-${l}-${d}-${b}`}function yd(n){let r=n.replace(/\.json$/i,""),o="";for(;o!==r;)o=r,r=r.replace(/_\d{4}_\d{2}_\d{2}-\d{2}-\d{2}-\d{2}$/,""),r=r.replace(/_\d{4}_\d{2}_\d{2}_\d{2}_\d{2}_\d{2}$/,"");return r}const Pr={CONFIG:"aiServiceConfig",API_KEY_PREFIX:"aiApiKey_",MODEL_PREFIX:"aiModel_"},tf={provider:"gemini",model:"gemini-2.0-flash",apiKeyStorageType:"sessionStorage"},Vu="gemini",rx={id:"gemini",name:"Google Gemini",description:"Google's multimodal AI with native PDF support",models:[{id:"gemini-2.0-flash",name:"Gemini 2.0 Flash",description:"Fast and efficient",supportsPDF:!0},{id:"gemini-2.0-flash-lite",name:"Gemini 2.0 Flash Lite",description:"Lightweight and fast",supportsPDF:!0},{id:"gemini-1.5-flash",name:"Gemini 1.5 Flash",description:"Previous generation flash",supportsPDF:!0},{id:"gemini-1.5-pro",name:"Gemini 1.5 Pro",description:"More capable, slower",supportsPDF:!0}],defaultModel:"gemini-2.0-flash",apiKeyPlaceholder:"AIza...",apiKeyHelpUrl:"https://aistudio.google.com/apikey",supportsPDF:!0};class U2{info=rx;getStorageType(){if(typeof window>"u")return"sessionStorage";const r=localStorage.getItem(Pr.CONFIG);if(r)try{return JSON.parse(r).apiKeyStorageType||"sessionStorage"}catch{return"sessionStorage"}return"sessionStorage"}getStorage(){return this.getStorageType()==="localStorage"?localStorage:sessionStorage}getApiKey(){return typeof window>"u"?null:this.getStorage().getItem(`${Pr.API_KEY_PREFIX}${Vu}`)?.trim()||null}saveApiKey(r,o){if(typeof window>"u")return;sessionStorage.removeItem(`${Pr.API_KEY_PREFIX}${Vu}`),localStorage.removeItem(`${Pr.API_KEY_PREFIX}${Vu}`),(o==="localStorage"?localStorage:sessionStorage).setItem(`${Pr.API_KEY_PREFIX}${Vu}`,r.trim())}removeApiKey(){typeof window>"u"||(sessionStorage.removeItem(`${Pr.API_KEY_PREFIX}${Vu}`),localStorage.removeItem(`${Pr.API_KEY_PREFIX}${Vu}`))}hasApiKey(){return!!this.getApiKey()}getModel(){return typeof window>"u"?this.info.defaultModel:localStorage.getItem(`${Pr.MODEL_PREFIX}${Vu}`)||this.info.defaultModel}saveModel(r){typeof window>"u"||localStorage.setItem(`${Pr.MODEL_PREFIX}${Vu}`,r)}getApiUrl(){const r=this.getApiKey();return r?`https://generativelanguage.googleapis.com/v1/models/${this.getModel()}:generateContent?key=${r}`:null}async extractFromPDF(r){const o=this.getApiUrl();if(!o)return{success:!1,error:"API key not configured"};try{const s=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:r.prompt},{inlineData:{mimeType:r.mimeType||"application/pdf",data:r.pdfBase64}}]}]})});if(!s.ok){const b=await s.text();let p=`Gemini API error: ${s.status} ${s.statusText}`;try{const v=JSON.parse(b);if(v.error?.message){let m=v.error.message;m.length>500&&(m=m.replace(/"([A-Za-z0-9+/]{100,})"/g,(j,_)=>`"[Base64 data truncated - ${_.length} characters]"`)),p+=`.

${m}`}}catch{b.length>1e3?p+=`.

${b.substring(0,1e3)}... [truncated]`:p+=`.

${b}`}return{success:!1,error:p}}const l=await s.json();let d="";if(l.candidates?.[0]){if(l.candidates[0].finishReason&&l.candidates[0].finishReason!=="STOP")return{success:!1,error:`Response blocked: ${l.candidates[0].finishReason}`};const b=l.candidates[0].content?.parts;b?.[0]?.text&&(d=b[0].text.trim())}return d?{success:!0,text:d,rawResponse:l}:{success:!1,error:"No response text from API",rawResponse:l}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Unknown error occurred"}}}}const Gg=new U2,qu="claude",ox={id:"claude",name:"Anthropic Claude",description:"Anthropic's Claude with native PDF support",models:[{id:"claude-sonnet-4-20250514",name:"Claude Sonnet 4",description:"Latest balanced model",supportsPDF:!0},{id:"claude-3-5-sonnet-20241022",name:"Claude 3.5 Sonnet",description:"Fast and intelligent",supportsPDF:!0},{id:"claude-3-5-haiku-20241022",name:"Claude 3.5 Haiku",description:"Fastest model",supportsPDF:!0},{id:"claude-3-opus-20240229",name:"Claude 3 Opus",description:"Most capable",supportsPDF:!0}],defaultModel:"claude-sonnet-4-20250514",apiKeyPlaceholder:"sk-ant-...",apiKeyHelpUrl:"https://console.anthropic.com/settings/keys",supportsPDF:!0};class E2{info=ox;getStorageType(){if(typeof window>"u")return"sessionStorage";const r=localStorage.getItem(Pr.CONFIG);if(r)try{return JSON.parse(r).apiKeyStorageType||"sessionStorage"}catch{return"sessionStorage"}return"sessionStorage"}getStorage(){return this.getStorageType()==="localStorage"?localStorage:sessionStorage}getApiKey(){return typeof window>"u"?null:this.getStorage().getItem(`${Pr.API_KEY_PREFIX}${qu}`)?.trim()||null}saveApiKey(r,o){if(typeof window>"u")return;sessionStorage.removeItem(`${Pr.API_KEY_PREFIX}${qu}`),localStorage.removeItem(`${Pr.API_KEY_PREFIX}${qu}`),(o==="localStorage"?localStorage:sessionStorage).setItem(`${Pr.API_KEY_PREFIX}${qu}`,r.trim())}removeApiKey(){typeof window>"u"||(sessionStorage.removeItem(`${Pr.API_KEY_PREFIX}${qu}`),localStorage.removeItem(`${Pr.API_KEY_PREFIX}${qu}`))}hasApiKey(){return!!this.getApiKey()}getModel(){return typeof window>"u"?this.info.defaultModel:localStorage.getItem(`${Pr.MODEL_PREFIX}${qu}`)||this.info.defaultModel}saveModel(r){typeof window>"u"||localStorage.setItem(`${Pr.MODEL_PREFIX}${qu}`,r)}getApiUrl(){return this.getApiKey()?"https://api.anthropic.com/v1/messages":null}async extractFromPDF(r){const o=this.getApiKey(),s=this.getApiUrl();if(!o||!s)return{success:!1,error:"API key not configured"};try{const l=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":o,"anthropic-version":"2023-06-01","anthropic-dangerous-direct-browser-access":"true"},body:JSON.stringify({model:this.getModel(),max_tokens:4096,messages:[{role:"user",content:[{type:"document",source:{type:"base64",media_type:r.mimeType||"application/pdf",data:r.pdfBase64}},{type:"text",text:r.prompt}]}]})});if(!l.ok){const p=await l.text();let v=`Claude API error: ${l.status} ${l.statusText}`;try{const m=JSON.parse(p);m.error?.message&&(v+=`.

${m.error.message}`)}catch{p.length>1e3?v+=`.

${p.substring(0,1e3)}... [truncated]`:v+=`.

${p}`}return{success:!1,error:v}}const d=await l.json();let b="";if(d.content&&Array.isArray(d.content))for(const p of d.content)p.type==="text"&&(b+=p.text);return b?{success:!0,text:b.trim(),rawResponse:d}:{success:!1,error:"No response text from API",rawResponse:d}}catch(l){return{success:!1,error:l instanceof Error?l.message:"Unknown error occurred"}}}}const V2=new E2,Hu="openai",ax={id:"openai",name:"OpenAI ChatGPT",description:"OpenAI's GPT models with PDF support",models:[{id:"gpt-4o",name:"GPT-4o",description:"Most capable multimodal model",supportsPDF:!0},{id:"gpt-4o-mini",name:"GPT-4o Mini",description:"Fast and affordable",supportsPDF:!0},{id:"gpt-4-turbo",name:"GPT-4 Turbo",description:"Previous generation",supportsPDF:!0}],defaultModel:"gpt-4o",apiKeyPlaceholder:"sk-...",apiKeyHelpUrl:"https://platform.openai.com/api-keys",supportsPDF:!0};class q2{info=ax;getStorageType(){if(typeof window>"u")return"sessionStorage";const r=localStorage.getItem(Pr.CONFIG);if(r)try{return JSON.parse(r).apiKeyStorageType||"sessionStorage"}catch{return"sessionStorage"}return"sessionStorage"}getStorage(){return this.getStorageType()==="localStorage"?localStorage:sessionStorage}getApiKey(){return typeof window>"u"?null:this.getStorage().getItem(`${Pr.API_KEY_PREFIX}${Hu}`)?.trim()||null}saveApiKey(r,o){if(typeof window>"u")return;sessionStorage.removeItem(`${Pr.API_KEY_PREFIX}${Hu}`),localStorage.removeItem(`${Pr.API_KEY_PREFIX}${Hu}`),(o==="localStorage"?localStorage:sessionStorage).setItem(`${Pr.API_KEY_PREFIX}${Hu}`,r.trim())}removeApiKey(){typeof window>"u"||(sessionStorage.removeItem(`${Pr.API_KEY_PREFIX}${Hu}`),localStorage.removeItem(`${Pr.API_KEY_PREFIX}${Hu}`))}hasApiKey(){return!!this.getApiKey()}getModel(){return typeof window>"u"?this.info.defaultModel:localStorage.getItem(`${Pr.MODEL_PREFIX}${Hu}`)||this.info.defaultModel}saveModel(r){typeof window>"u"||localStorage.setItem(`${Pr.MODEL_PREFIX}${Hu}`,r)}getApiUrl(){return this.getApiKey()?"https://api.openai.com/v1/chat/completions":null}async extractFromPDF(r){const o=this.getApiKey(),s=this.getApiUrl();if(!o||!s)return{success:!1,error:"API key not configured"};try{const l=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({model:this.getModel(),max_tokens:4096,messages:[{role:"user",content:[{type:"file",file:{filename:"datasheet.pdf",file_data:`data:${r.mimeType||"application/pdf"};base64,${r.pdfBase64}`}},{type:"text",text:r.prompt}]}]})});if(!l.ok){const p=await l.text();let v=`OpenAI API error: ${l.status} ${l.statusText}`;try{const m=JSON.parse(p);m.error?.message&&(v+=`.

${m.error.message}`)}catch{p.length>1e3?v+=`.

${p.substring(0,1e3)}... [truncated]`:v+=`.

${p}`}return{success:!1,error:v}}const d=await l.json();let b="";return d.choices?.[0]?.message?.content&&(b=d.choices[0].message.content),b?{success:!0,text:b.trim(),rawResponse:d}:{success:!1,error:"No response text from API",rawResponse:d}}catch(l){return{success:!1,error:l instanceof Error?l.message:"Unknown error occurred"}}}}const H2=new q2,Xg={gemini:Gg,claude:V2,openai:H2},Us={gemini:rx,claude:ox,openai:ax},_1=["gemini","claude","openai"];function df(){if(typeof window>"u")return tf;const n=localStorage.getItem(Pr.CONFIG);if(n)try{const r=JSON.parse(n);return{provider:r.provider||tf.provider,model:r.model||tf.model,apiKeyStorageType:r.apiKeyStorageType||tf.apiKeyStorageType}}catch{return tf}return tf}function vh(n){if(typeof window>"u")return;const o={...df(),...n};localStorage.setItem(Pr.CONFIG,JSON.stringify(o))}function Xc(){const n=df();return Xg[n.provider]||Xg.gemini}function D1(n){const r=Xg[n];r&&vh({provider:n,model:r.getModel()})}function W2(){return df().apiKeyStorageType}function $2(n){vh({apiKeyStorageType:n})}function sx(){if(typeof window>"u")return;const n=sessionStorage.getItem("geminiApiKey"),r=localStorage.getItem("geminiApiKey"),o=localStorage.getItem("geminiModel"),s=localStorage.getItem(Pr.CONFIG),l=sessionStorage.getItem(`${Pr.API_KEY_PREFIX}gemini`)||localStorage.getItem(`${Pr.API_KEY_PREFIX}gemini`);if((n||r)&&!s&&!l){console.log("Migrating legacy Gemini API key storage to new format...");const d=n?"sessionStorage":"localStorage",b=n||r;vh({provider:"gemini",model:o||"gemini-2.0-flash",apiKeyStorageType:d}),b&&Gg.saveApiKey(b,d),o&&Gg.saveModel(o),sessionStorage.removeItem("geminiApiKey"),localStorage.removeItem("geminiApiKey"),localStorage.removeItem("geminiModel"),console.log("Migration complete.")}}function vi(n,r,o,s){if(r==="power"){const d=n[r]||"";return typeof d=="string"&&d.trim()!==""?{value:d.replace(/W$/i,"").trim(),unit:"W"}:{value:"",unit:"W"}}if(n[r]!==void 0||n[o]!==void 0)return{value:n[r]!==void 0?String(n[r]):"",unit:n[o]!==void 0?String(n[o]):s};const l=n[r]||"";return typeof l=="string"&&l.trim()!==""?lx(l):{value:"",unit:s}}function lx(n){if(!n||n.trim()==="")return{value:"",unit:""};const r=n.trim(),o=r.match(/^([\d]+\/[\d]+)\s*([a-zA-ZuW]+)?$/);if(o)return{value:o[1],unit:o[2]||""};const s=r.match(/^([\d.]+)\s*([a-zA-ZuW]+)?$/);return s?{value:s[1],unit:s[2]||""}:{value:r,unit:""}}function fd(n,r){return!n||n.trim()===""?"":!r||r.trim()===""?n.trim():`${n.trim()}${r.trim()}`}function Y2(){const[n,r]=I.useState([]),[o,s]=I.useState([]),[l,d]=I.useState(null),[b,p]=I.useState(null),[v,m]=I.useState(null),[j,_]=I.useState(!1),[M,T]=I.useState(null),F=I.useCallback((E,U)=>{U==="top"?r(ne=>[...ne,E]):s(ne=>[...ne,E])},[]),P=I.useCallback((E,U,ne)=>{ne==="top"?r(Z=>Z.map(G=>G.id===E?{...G,...U}:G)):s(Z=>Z.map(G=>G.id===E?{...G,...U}:G))},[]),k=I.useCallback((E,U)=>{U==="top"?r(ne=>ne.filter(Z=>Z.id!==E)):s(ne=>ne.filter(Z=>Z.id!==E))},[]),y=I.useCallback((E,U)=>{if(!E){console.error("[openComponentEditor] Component is null or undefined");return}if(!E.id||typeof E.id!="string"){console.error("[openComponentEditor] Component missing valid id property:",{component:E});return}const ne=E.id;if(!E.componentType||typeof E.componentType!="string"){console.error("[openComponentEditor] Component missing valid componentType property:",{componentId:ne,component:E});return}const Z=E.componentType;if(typeof E.pinCount!="number"||E.pinCount<0){console.error("[openComponentEditor] Component missing valid pinCount property:",{componentId:ne,componentType:Z,pinCount:E.pinCount,component:E});return}if(U!=="top"&&U!=="bottom"){console.error("[openComponentEditor] Invalid layer parameter:",{layer:U,componentId:E.id});return}const G=E.designator||"",te=E.abbreviation||(G.length>0?G.charAt(0).toUpperCase():""),O=E.componentType,W={visible:!0,layer:U,id:E.id,designator:G,abbreviation:te,manufacturer:"manufacturer"in E&&E.manufacturer||"",partNumber:"partNumber"in E&&E.partNumber||"",pinCount:E.pinCount,x:E.x,y:E.y,orientation:E.orientation??0,description:E.description||"",datasheet:E.datasheet||"",componentDefinitionKey:E.componentDefinitionKey||""};if(O==="Resistor"){const D=E;console.log("[openComponentEditor] Resistor - component values:",{resistance:D.resistance,resistanceUnit:D.resistanceUnit,resistanceType:typeof D.resistance});const J=vi(D,"resistance","resistanceUnit",dn("resistance"));console.log("[openComponentEditor] Resistor - readValueAndUnit result:",J),W.resistance=J.value,W.resistanceUnit=J.unit;const $=vi(D,"power","powerUnit","W");W.power=$.value||"1/4",W.tolerance=D.tolerance||"5%"}else if(O==="Capacitor"){const D=E;console.log("[openComponentEditor] Capacitor - component values:",{capacitance:D.capacitance,capacitanceUnit:D.capacitanceUnit,capacitanceType:typeof D.capacitance});const J=vi(D,"capacitance","capacitanceUnit",dn("capacitance"));console.log("[openComponentEditor] Capacitor - readValueAndUnit result:",J),W.capacitance=J.value,W.capacitanceUnit=J.unit;const $=vi(D,"voltage","voltageUnit",dn("voltage"));W.voltage=$.value,W.voltageUnit=$.unit,W.tolerance=D.tolerance||"10%",W.dielectric=D.dielectric||"Ceramic"}else if(O==="Electrolytic Capacitor"){const D=E,J=vi(D,"capacitance","capacitanceUnit",dn("capacitance"));W.capacitance=J.value,W.capacitanceUnit=J.unit;const $=vi(D,"voltage","voltageUnit",dn("voltage"));W.voltage=$.value,W.voltageUnit=$.unit,W.tolerance=D.tolerance||"20%",W.polarized=D.polarized!==void 0?D.polarized:!0;const je=vi(D,"esr","esrUnit",dn("esr"));W.esr=je.value,W.esrUnit=je.unit,W.temperature=D.temperature||""}else if(O==="Film Capacitor"){const D=E,J=vi(D,"capacitance","capacitanceUnit",dn("capacitance"));W.capacitance=J.value,W.capacitanceUnit=J.unit;const $=vi(D,"voltage","voltageUnit",dn("voltage"));W.voltage=$.value,W.voltageUnit=$.unit,W.tolerance=D.tolerance||"10%",W.filmType=D.filmType||"Polyester"}else if(O==="Diode"){const D=E;W.diodeType=D.diodeType||"Standard";const J=vi(D,"voltage","voltageUnit",dn("voltage"));W.voltage=J.value,W.voltageUnit=J.unit;const $=vi(D,"current","currentUnit",dn("current"));W.current=$.value,W.currentUnit=$.unit,W.ledColor=D.ledColor||""}else if(O==="Battery"){const D=E,J=vi(D,"voltage","voltageUnit",dn("voltage"));W.voltage=J.value,W.voltageUnit=J.unit;const $=vi(D,"capacity","capacityUnit",dn("capacity"));W.capacity=$.value,W.capacityUnit=$.unit,W.chemistry=D.chemistry||"Li-ion"}else if(O==="Fuse"){const D=E,J=vi(D,"current","currentUnit",dn("current"));W.current=J.value,W.currentUnit=J.unit;const $=vi(D,"voltage","voltageUnit",dn("voltage"));W.voltage=$.value,W.voltageUnit=$.unit,W.fuseType=D.fuseType||"Fast-blow"}else if(O==="FerriteBead"){const D=E,J=vi(D,"impedance","impedanceUnit",dn("impedance"));W.impedance=J.value,W.impedanceUnit=J.unit;const $=vi(D,"current","currentUnit",dn("current"));W.current=$.value,W.currentUnit=$.unit}else if(O==="Connector"){const D=E;W.connectorType=D.connectorType||"",W.gender=D.gender||"N/A"}else if(O==="Jumper"){const D=E;W.positions=D.positions||3}else if(O==="Relay"){const D=E,J=vi(D,"coilVoltage","coilVoltageUnit",dn("coilVoltage"));W.coilVoltage=J.value,W.coilVoltageUnit=J.unit,W.contactType=D.contactType||"SPST";const $=vi(D,"current","currentUnit",dn("current"));W.current=$.value,W.currentUnit=$.unit}else if(O==="Inductor"){const D=E,J=vi(D,"inductance","inductanceUnit",dn("inductance"));W.inductance=J.value,W.inductanceUnit=J.unit;const $=vi(D,"current","currentUnit",dn("current"));W.current=$.value,W.currentUnit=$.unit;const je=vi(D,"resistance","resistanceUnit",dn("resistance"));W.resistance=je.value,W.resistanceUnit=je.unit}else if(O==="Speaker"){const D=E,J=vi(D,"impedance","impedanceUnit",dn("impedance"));W.impedance=J.value,W.impedanceUnit=J.unit;const $=vi(D,"power","powerUnit","W");W.power=$.value||"1"}else if(O==="Motor"){const D=E;W.motorType=D.motorType||"DC";const J=vi(D,"voltage","voltageUnit",dn("voltage"));W.voltage=J.value,W.voltageUnit=J.unit;const $=vi(D,"current","currentUnit",dn("current"));W.current=$.value,W.currentUnit=$.unit}else if(O==="PowerSupply"){const D=E,J=vi(D,"inputVoltage","inputVoltageUnit",dn("inputVoltage"));W.inputVoltage=J.value,W.inputVoltageUnit=J.unit;const $=vi(D,"outputVoltage","outputVoltageUnit",dn("outputVoltage"));W.outputVoltage=$.value,W.outputVoltageUnit=$.unit;const je=vi(D,"current","currentUnit",dn("current"));W.current=je.value,W.currentUnit=je.unit}else if(O==="Transistor"){const D=E;W.transistorType=D.transistorType||"BJT",W.polarity=D.polarity||"NPN";const J=vi(D,"voltage","voltageUnit",dn("voltage"));W.voltage=J.value,W.voltageUnit=J.unit;const $=vi(D,"current","currentUnit",dn("current"));W.current=$.value,W.currentUnit=$.unit}else if(O==="ResistorNetwork"){const D=E,J=vi(D,"resistance","resistanceUnit",dn("resistance"));W.resistance=J.value,W.resistanceUnit=J.unit,W.configuration=D.configuration||""}else if(O==="Thermistor"){const D=E,J=vi(D,"resistance","resistanceUnit",dn("resistance"));W.resistance=J.value,W.resistanceUnit=J.unit,W.thermistorType=D.thermistorType||"NTC",W.beta=D.beta||""}else if(O==="Switch"){const D=E;W.switchType=D.switchType||"Toggle";const J=vi(D,"current","currentUnit",dn("current"));W.current=J.value,W.currentUnit=J.unit;const $=vi(D,"voltage","voltageUnit",dn("voltage"));W.voltage=$.value,W.voltageUnit=$.unit}else if(O==="Transformer"){const D=E,J=vi(D,"primaryVoltage","primaryVoltageUnit",dn("primaryVoltage"));W.primaryVoltage=J.value,W.primaryVoltageUnit=J.unit;const $=vi(D,"secondaryVoltage","secondaryVoltageUnit",dn("secondaryVoltage"));W.secondaryVoltage=$.value,W.secondaryVoltageUnit=$.unit;const je=vi(D,"power","powerUnit",dn("power"));W.power=je.value||"1",W.turns=D.turns||""}else if(O==="TestPoint"){const D=E;W.signal=D.signal||""}else if(O==="IntegratedCircuit"||O==="Semiconductor"){const D=E;W.description=D.description||E.designator||"",W.datasheet=D.datasheet||"",W.datasheetFileName=D.datasheetFileName||void 0,W.manufacturer=D.manufacturer||"",W.partNumber=D.partNumber||"",W.operatingTemperature=D.operatingTemperature||"",W.packageType=D.packageType||"",console.log("[useComponents] Loading IC component - datasheet from component:",D.datasheet,"editor datasheet:",W.datasheet,"datasheetFileName:",D.datasheetFileName),W.icType=D.icType||"Op-Amp"}else if(O==="VacuumTube"){const D=E;W.tubeType=D.tubeType||""}else if(O==="VariableResistor"){const D=E;W.vrType=D.vrType||"Potentiometer";const J=vi(D,"resistance","resistanceUnit",dn("resistance"));W.resistance=J.value,W.resistanceUnit=J.unit;const $=vi(D,"power","powerUnit",dn("power"));W.power=$.value||"1/4",W.taper=D.taper||""}else if(O==="Crystal"){const D=E;W.frequency=D.frequency||"",W.loadCapacitance=D.loadCapacitance||"",W.tolerance=D.tolerance||""}else if(O==="Diode"){const D=E;W.diodeType=D.diodeType||"Standard";const J=vi(D,"voltage","voltageUnit",dn("voltage"));W.voltage=J.value,W.voltageUnit=J.unit;const $=vi(D,"current","currentUnit",dn("current"));W.current=$.value,W.currentUnit=$.unit,W.ledColor=D.ledColor||""}else if(O==="GenericComponent"){const D=E;W.genericType=D.genericType||"Attenuator";const J=vi(D,"voltage","voltageUnit",dn("voltage"));W.voltage=J.value,W.voltageUnit=J.unit;const $=vi(D,"current","currentUnit",dn("current"));W.current=$.value,W.currentUnit=$.unit,W.power=D.power||"",W.frequency=D.frequency||"",W.model=D.model||""}const Y=E.componentDefinitionKey;if(Y){const D=Gu.find(J=>`${J.category}:${J.subcategory}:${J.type}`===Y);D&&(W.componentDefinition=D,W.componentDefinitionKey=Y)}d(W)},[]),ae=I.useCallback(()=>{d(null),p(null)},[]);return{componentsTop:n,setComponentsTop:r,componentsBottom:o,setComponentsBottom:s,componentEditor:l,setComponentEditor:d,connectingPin:b,setConnectingPin:p,componentDialogPosition:v,setComponentDialogPosition:m,isDraggingDialog:j,setIsDraggingDialog:_,dialogDragOffset:M,setDialogDragOffset:T,addComponent:F,updateComponent:P,removeComponent:k,openComponentEditor:y,closeComponentEditor:ae}}class G2{parent=new Map;rank=new Map;find(r){return this.parent.has(r)?(this.parent.get(r)!==r&&this.parent.set(r,this.find(this.parent.get(r))),this.parent.get(r)):(this.parent.set(r,r),this.rank.set(r,0),r)}union(r,o){const s=this.find(r),l=this.find(o);if(s===l)return;const d=this.rank.get(s)||0,b=this.rank.get(l)||0;d<b?this.parent.set(s,l):d>b?this.parent.set(l,s):(this.parent.set(l,s),this.rank.set(s,d+1))}getGroups(){const r=new Map;for(const o of this.parent.keys()){const s=this.find(o);r.has(s)||r.set(s,[]),r.get(s).push(o)}return r}}function X2(n,r){const o=n.pinCount,s=n.size||24,l=s*.8,d=s*.6,b=s*.15,p=d/4,v=Math.ceil(o/2),m=r<v;let j,_;if(m)j=n.x-l/2-b,_=n.y-d/2+d/4+r*p;else{const M=r-v;j=n.x+l/2+b,_=n.y-d/2+d/4+M*p}return{x:Math.round(j),y:Math.round(_)}}function wh(n,r,o,s,l){const d=new Map,b=new Map;let p=1;const v=6,m=(k,y)=>{const ae=Math.round(k*Math.pow(10,v))/Math.pow(10,v),E=Math.round(y*Math.pow(10,v))/Math.pow(10,v);return`${ae},${E}`},j=(k,y,ae,E)=>{const U=m(k,y);if(d.has(U)){const Z=d.get(U);if(E){E.componentId&&E.pinIndex!==void 0&&(Z.componentId=E.componentId,Z.pinIndex=E.pinIndex),E.voltage!==void 0&&(Z.voltage=E.voltage),E.powerBusId!==void 0&&(Z.powerBusId=E.powerBusId),E.groundBusId!==void 0&&(Z.groundBusId=E.groundBusId);for(const G in E)G!=="componentId"&&G!=="pinIndex"&&G!=="voltage"&&G!=="powerBusId"&&G!=="groundBusId"&&(Z[G]=E[G]);E.type==="component_pin"||Z.type==="component_pin"?Z.type="component_pin":E.type&&!Z.type&&(Z.type=E.type)}return Z}const ne={id:p++,type:ae,x:k,y,...E};return d.set(U,ne),ne};let _=0;for(const k of n)if(k.type==="via"&&k.points.length>0){const y=k.points[0];j(y.x,y.y,"via");const ae=m(y.x,y.y);y.id!==void 0&&b.set(y.id,ae),_++}console.log(`[Connectivity] Added ${_} vias to coordinate graph`);let M=0;for(const k of n)if(k.type==="trace")for(const y of k.points){j(y.x,y.y,"trace_point");const ae=m(y.x,y.y);y.id!==void 0&&b.set(y.id,ae),M++}console.log(`[Connectivity] Added ${M} trace points to coordinate graph`);for(const k of o){const y=l.find(ae=>ae.id===k.powerBusId);if(j(k.x,k.y,"power",{voltage:y?.voltage||k.type||"UNKNOWN",powerBusId:k.powerBusId}),k.pointId!==void 0){const ae=m(k.x,k.y);b.set(k.pointId,ae)}}for(const k of s){const y=k;if(j(k.x,k.y,"ground",{groundBusId:y.groundBusId}),y.pointId!==void 0){const ae=m(k.x,k.y);b.set(y.pointId,ae)}}const T=new Set;for(const[k]of d)T.add(k);const F=[];let P=0;for(const k of r){const y=k.abbreviation?.trim()||k.designator?.trim()||"UNKNOWN";for(let ae=0;ae<k.pinCount;ae++){const E=k.pinConnections?.[ae];if(E&&E.trim()!==""){const U=parseInt(E.trim(),10);if(!isNaN(U)&&U>0){const ne=b.get(U);if(ne){const[Z,G]=ne.split(",").map(Number);j(Z,G,"component_pin",{componentId:k.id,pinIndex:ae}),P++,console.log(`[Connectivity] Component ${y} pin ${ae+1}: Connected to point ID ${U} at coord(${Z},${G})`)}else{const Z=X2(k,ae);j(Z.x,Z.y,"component_pin",{componentId:k.id,pinIndex:ae});const G=m(Z.x,Z.y);b.set(U,G),P++,console.warn(`[Connectivity] Component ${y} pin ${ae+1}: Point ID ${U} not in pointIdToCoord, but adding pin at calculated position (${Z.x},${Z.y}) - may be connected to power/ground`)}}else F.push({compId:k.id,designator:y,pinIndex:ae,pointId:E.trim()}),console.warn(`[Connectivity] Component ${y} pin ${ae+1}: Invalid point ID "${E}" - pin is NOT connected`)}}}if(console.log(`[Connectivity] Added ${P} connected component pins to coordinate graph`),F.length>0){console.warn(`[Connectivity] Found ${F.length} component pins with invalid or missing connections (not added to graph):`);for(const k of F.slice(0,10))console.warn(`  - ${k.designator} pin ${k.pinIndex+1}: point ID "${k.pointId}" not found`)}return d}function Sh(n,r){const o=[],l=(d,b)=>{const p=Math.round(d*Math.pow(10,6))/Math.pow(10,6),v=Math.round(b*Math.pow(10,6))/Math.pow(10,6);return`${p},${v}`};for(const d of n)if(d.type==="trace"&&d.points.length>=2)for(let b=0;b<d.points.length-1;b++){const p=d.points[b],v=d.points[b+1];if(p&&v){const m=l(p.x,p.y),j=l(v.x,v.y);m!==j&&o.push([m,j])}}return o}function K2(n){let r=n.trim();r=r.replace(/\s*(VDC|VAC)\s*$/i,""),r=r.replace(/\s*(DC|AC)\s*$/i,""),r=r.replace(/\s*V\s*$/i,"");const o=r.match(/^([+-])?/),s=o&&o[1]||"+",l=r.match(/(\d+\.?\d*)/);if(!l)return n.trim();let d=l[1];if(d.includes(".")){const b=d.split("."),p=b[0],m=(b[1]||"0").replace(/0+$/,"")||"0";d=`${p}V${m}`}return`${s}${d}V`}function Th(n,r,o=[],s=[]){const l=new G2,d=new Map;let b=1;const p=T=>(d.has(T)||d.set(T,b++),d.get(T));for(const[T,F]of r){const P=p(T),k=p(F);l.union(P,k)}const v=new Map;for(const[T,F]of n)if(F.type==="ground"){const P=F.groundBusId||"default";v.has(P)||v.set(P,[]),v.get(P).push(T),p(T)}for(const[T,F]of v)if(F.length>0){const k=s.find(y=>y.id===T)?.name||(T==="default"?"GND":T);if(F.length>1){const y=p(F[0]);for(let ae=1;ae<F.length;ae++){const E=p(F[ae]);l.union(y,E)}console.log(`[Connectivity] Unified ${F.length} ground nodes with bus "${k}" into a single net (common ground bus)`)}else console.log(`[Connectivity] Found 1 ground node with bus "${k}" (common ground bus)`)}const m=new Map;for(const[T,F]of n)if(F.type==="power"&&F.powerBusId){const P=F.powerBusId;m.has(P)||m.set(P,[]),m.get(P).push(T),p(T)}for(const[T,F]of m)if(F.length>0){const k=o.find(y=>y.id===T)?.name||T;if(F.length>1){const y=p(F[0]);for(let ae=1;ae<F.length;ae++){const E=p(F[ae]);l.union(y,E)}console.log(`[Connectivity] Unified ${F.length} power nodes with bus "${k}" into a single net (common power bus)`)}else console.log(`[Connectivity] Found 1 power node with bus "${k}" (common power bus)`)}for(const T of n.keys())p(T);const j=l.getGroups(),_=new Map,M=new Map;for(const[T,F]of d)M.set(F,T);for(const[T,F]of j){const P=M.get(T);if(!P)continue;const k=F.map(y=>M.get(y)).filter(y=>y!==void 0).map(y=>n.get(y)).filter(y=>y!==void 0);_.set(P,k)}return _}function Ch(n,r){const o=new Map;let s=1;for(const[l,d]of n){if(d.some(v=>v.type==="ground")){o.set(l,"GND");continue}const p=d.filter(v=>v.type==="power");if(p.length>0){const v=p[0].voltage||"UNKNOWN",m=K2(v);o.set(l,m);continue}o.set(l,`N$${s++}`)}return o}function Jc(n,r,o,s){if(r==="power"){const d=n[r]||"";return typeof d=="string"&&d.trim()!==""?{value:d.replace(/W$/i,"").trim(),unit:"W"}:{value:"",unit:"W"}}if(n[r]!==void 0||n[o]!==void 0)return{value:n[r]||"",unit:n[o]||s};const l=n[r]||"";if(typeof l=="string"&&l.trim()!==""){const d=l.trim().match(/^([\d]+\/[\d]+)\s*([a-zA-ZuW]+)?$/);if(d)return{value:d[1],unit:d[2]||""};const b=l.trim().match(/^([\d.]+)\s*([a-zA-ZuW]+)?$/);return b?{value:b[1],unit:b[2]||""}:{value:l.trim(),unit:""}}return{value:"",unit:s}}function Qc(n,r){return!n||n.trim()===""?"":!r||r.trim()===""?n.trim():`${n.trim()}${r.trim()}`}function Ps(n){return{resistance:"",capacitance:"F",inductance:"H",voltage:"V",current:"A",power:"W",impedance:"",capacity:"mAh",esr:"",coilVoltage:"V",inputVoltage:"V",outputVoltage:"V"}[n]||""}function cx(n){if(n.componentType==="Resistor"&&"resistance"in n){const{value:s,unit:l}=Jc(n,"resistance","resistanceUnit",Ps("resistance"));if(s&&s.trim()!=="")return Qc(s,l)}if(n.componentType==="Capacitor"&&"capacitance"in n){const{value:s,unit:l}=Jc(n,"capacitance","capacitanceUnit",Ps("capacitance"));if(s&&s.trim()!=="")return Qc(s,l)}if(n.componentType==="Electrolytic Capacitor"&&"capacitance"in n){const{value:s,unit:l}=Jc(n,"capacitance","capacitanceUnit",Ps("capacitance"));if(s&&s.trim()!=="")return Qc(s,l)}if(n.componentType==="Inductor"&&"inductance"in n){const{value:s,unit:l}=Jc(n,"inductance","inductanceUnit",Ps("inductance"));if(s&&s.trim()!=="")return Qc(s,l)}const r=n.partName?.trim();if(r&&r!=="")return r;const o=n.partNumber?.trim();return o&&o!==""?o:n.componentType}function ux(n){return n.packageType?n.packageType:{Resistor:"R_0805",Capacitor:"C_0805",Inductor:"L_0805",Diode:"D_SOD-123",Transistor:"TO-92",IntegratedCircuit:"DIP-8"}[n.componentType]||"Unknown"}function Z2(n,r,o,s,l){const d=wh(r,n,o,s,l),b=Sh(r),p=Th(d,b),v=Ch(p),m=new Map;for(const F of n){const P=F.abbreviation?.trim()||F.designator?.trim();P&&m.set(P,F)}const j=[];let _=1;for(const[F,P]of p){const k=v.get(F)||`N$${_}`,y=[];for(const ae of P)if(ae.type==="component_pin"&&ae.componentId&&ae.pinIndex!==void 0){const E=n.find(U=>U.id===ae.componentId);if(E){const U=E.abbreviation?.trim()||E.designator?.trim();U&&y.push({designator:U,pin:(ae.pinIndex||0)+1})}}y.length>0&&j.push({name:k,code:_++,componentPins:y})}j.sort((F,P)=>F.name==="GND"?-1:P.name==="GND"?1:F.name.startsWith("+")||F.name.startsWith("-")?-1:P.name.startsWith("+")||P.name.startsWith("-")?1:F.code-P.code);let M=`(
`;M+=`  (components
`;const T=Array.from(m.keys()).sort();for(const F of T){const P=m.get(F),k=cx(P),y=ux(P);M+=`    (comp (ref ${F})
`,M+=`      (value ${k})
`,M+=`      (footprint ${y})
`,M+=`    )
`}M+=`  )
`,M+=`  (nets
`;for(const F of j){M+=`    (net (code ${F.code}) (name ${F.name})
`;for(const P of F.componentPins)M+=`      (node (ref ${P.designator}) (pin ${P.pin}))
`;M+=`    )
`}return M+=`  )
`,M+=`)
`,M}function J2(n,r,o,s,l){const d=wh(r,n,o,s,l),b=Sh(r),p=Th(d,b),v=Ch(p),m=new Map;for(const F of n){const P=F.abbreviation?.trim()||F.designator?.trim();P&&m.set(P,F)}const j=new Set;for(const[,F]of p)for(const P of F)if(P.type==="component_pin"&&P.componentId&&P.pinIndex!==void 0){const k=n.find(y=>y.id===P.componentId);if(k){const y=k.abbreviation?.trim()||k.designator?.trim();y&&j.add(y)}}let _="";_+="[";const M=Array.from(j).sort();for(const F of M){const P=m.get(F);if(!P)continue;const k=P.packageType||ux(P),y=cx(P);_+=`[${F}
`,_+=`${k}
`,_+=`${y}
`,_+=`



`,_+="]"}_+=`]
`,_+=`(
`;let T=1;for(const[F,P]of p){const k=v.get(F)||`N$${T}`,y=[];for(const ae of P)if(ae.type==="component_pin"&&ae.componentId&&ae.pinIndex!==void 0){const E=n.find(U=>U.id===ae.componentId);if(E){const U=E.abbreviation?.trim()||E.designator?.trim();U&&y.push({designator:U,pin:(ae.pinIndex||0)+1})}}if(y.length>0){_+=`(${k}
`;for(const ae of y)_+=`  (${ae.designator}-${ae.pin})
`;_+=`)
`}T++}return _+=`)
`,_}function Q2(n,r,o,s,l){const d=wh(r,n,o,s,l),b=Sh(r),p=Th(d,b),v=Ch(p),m=new Map;for(const E of n){const U=E.abbreviation?.trim()||E.designator?.trim();U&&m.set(U,E)}const j=E=>{switch(E.componentType){case"Resistor":return"R";case"Capacitor":return"C";case"Electrolytic Capacitor":return"C";case"Film Capacitor":return"C";case"Inductor":return"L";case"Diode":return"D";case"Transistor":return"Q";case"IntegratedCircuit":return"X";case"Switch":return"S";case"Battery":return"V";case"Fuse":return"R";case"Jumper":return"R";default:return"X"}},_=E=>{const ne=(E.abbreviation?.trim()||E.designator?.trim()||"").match(/\d+/);return ne?ne[0]:E.id.substring(0,8)},M=E=>{if(E.componentType==="Resistor"&&"resistance"in E){const{value:Z,unit:G}=Jc(E,"resistance","resistanceUnit",Ps("resistance"));if(Z&&Z.trim()!=="")return Qc(Z,G)}if((E.componentType==="Capacitor"||E.componentType==="Electrolytic Capacitor")&&"capacitance"in E){const{value:Z,unit:G}=Jc(E,"capacitance","capacitanceUnit",Ps("capacitance"));if(Z&&Z.trim()!=="")return Qc(Z,G)}if(E.componentType==="Inductor"&&"inductance"in E){const{value:Z,unit:G}=Jc(E,"inductance","inductanceUnit",Ps("inductance"));if(Z&&Z.trim()!=="")return Qc(Z,G)}const U=E.partName?.trim();if(U&&U!=="")return U;const ne=E.partNumber?.trim();return ne&&ne!==""?ne:E.componentType},T=new Map;let F=1;for(const[E]of p){const U=v.get(E);if(!U)continue;let ne;U==="GND"?ne="0":U.startsWith("+")||U.startsWith("-")?ne=U.replace(/\s+/g,"").replace(/[^a-zA-Z0-9_+-]/g,"_"):ne=`N${F++}`,T.set(E,ne)}const P=new Map;for(const[E,U]of T.entries()){const ne=v.get(E);ne&&(ne.startsWith("+")||ne.startsWith("-"))&&P.set(ne,U)}let k=`* SPICE Netlist
`;k+=`* Generated from PCB Reverse Engineering Tool
*

`;const y=Array.from(m.keys()).sort();for(const E of y){const U=m.get(E),ne=j(U),Z=M(U),G=[];for(const[O,W]of p){const Y=T.get(O);if(Y)for(const D of W)D.type==="component_pin"&&D.componentId===U.id&&D.pinIndex!==void 0&&G.push({pinIndex:D.pinIndex,nodeName:Y})}G.sort((O,W)=>O.pinIndex-W.pinIndex);const te=_(U);if(U.componentType==="Switch")G.length>=2&&(k+=`* Switch ${E}: ${U.componentType} - needs manual modeling
`,k+=`* S${te} ${G[0].nodeName} ${G[1].nodeName} 0 0 SW_MODEL
`);else if(U.componentType==="IntegratedCircuit"){const O=U.partNumber?.trim()||U.partName?.trim()||U.componentType;if(G.length>0){k+=`X${te}`;for(const W of G)k+=` ${W.nodeName}`;k+=` ${O}
`,k+=`* Note: Subcircuit definition for ${O} must be provided
`}}else if(U.componentType==="Battery"){const O=M(U);G.length>=2&&(k+=`V${te} ${G[0].nodeName} ${G[1].nodeName} DC ${O||"5"}
`)}else if(G.length>0){k+=`${ne}${te}`;for(const O of G)k+=` ${O.nodeName}`;Z&&Z.trim()!==""&&(U.componentType==="Resistor"||U.componentType==="Capacitor"||U.componentType==="Electrolytic Capacitor"||U.componentType==="Film Capacitor"||U.componentType==="Inductor"||U.componentType==="Diode")&&(k+=` ${Z}`),k+=`
`}else{const O=U.pinCount||2;k+=`${ne}${te}`;for(let W=0;W<O;W++)k+=` NC${W+1}`;Z&&Z.trim()!==""&&(k+=` ${Z}`),k+=`
`}}const ae=new Set;for(const[E]of p){const U=v.get(E);U&&(U.startsWith("+")||U.startsWith("-"))&&ae.add(U)}if(ae.size>0){k+=`
* Power sources (user should define these)
`;let E=1;for(const U of Array.from(ae).sort()){const ne=P.get(U)||U.replace(/\s+/g,"").replace(/[^a-zA-Z0-9_+-]/g,"_"),Z=U.match(/[+-]?[\d.]+/),G=Z?Z[0]:"5";k+=`* V${E++} ${ne} 0 DC ${G}
`}}return k+=`
* Simulation commands (uncomment and modify as needed):
`,k+=`* .op                    ; DC operating point
`,k+=`* .tran 1ms 10ms         ; Transient analysis
`,k+=`* .ac dec 10 1 1k        ; AC analysis
`,k+=`
.end
`,k}function eb(n,r,o,s,l,d,b){const p=wh(r,n,o,s,l),v=Sh(r),m=Th(p,v,l,d),j=Ch(m),_=new Map,M=Z=>Z.componentType==="Jumper"||Z.componentType==="Connector"||Z.componentType==="Switch",T=new Map;for(const[Z,G]of p)if(G.componentId&&G.pinIndex!==void 0){const te=`${G.componentId}:${G.pinIndex}`;T.set(te,Z)}const F=new Map;for(const[Z]of p.keys())F.set(Z,new Set);for(const[Z,G]of v)F.has(Z)&&F.get(Z).add(G),F.has(G)&&F.get(G).add(Z);const P=(Z,G,te)=>{if(te.has(Z))return;te.add(Z);const O=p.get(Z);if(!O)return;if(O.componentId&&O.pinIndex!==void 0){const Y=`${O.componentId}:${O.pinIndex}`;_.has(Y)||_.set(Y,new Set),_.get(Y).add(G);const D=n.find(J=>J.id===O.componentId);if(D&&M(D))for(let J=0;J<D.pinCount;J++){const $=`${D.id}:${J}`;_.has($)||_.set($,new Set),_.get($).add(G);const je=T.get($);je&&!te.has(je)&&P(je,G,te)}}const W=F.get(Z);if(W)for(const Y of W)P(Y,G,te)};for(const Z of l){const G=Z.name,te=new Set;for(const[O,W]of p)W.type==="power"&&W.powerBusId===Z.id&&P(O,G,te)}for(const Z of d){const G=Z.name,te=new Set;for(const[O,W]of p)W.type==="ground"&&W.groundBusId===Z.id&&P(O,G,te)}const k=new Map;for(const Z of n){const G=Z.designator?.trim()||Z.abbreviation?.trim();G&&k.set(G,Z)}const y=Z=>{if(!Z||Z.trim()==="")return"unknown";const G=Z.toUpperCase().trim();return G==="VCC"||G==="VDD"||G.startsWith("VCC")||G.startsWith("VDD")||G==="V+"||G.startsWith("V+")||G==="VP"||G==="VPOS"?"power":G==="GND"||G==="VSS"||G==="V-"||G.startsWith("V-")||G==="VN"||G==="VNEG"||G==="GROUND"?"ground":G.startsWith("IN")||G.startsWith("INPUT")||G.includes("IN+")||G.includes("IN-")||G==="A"||G==="B"||G.startsWith("CLK")||G.startsWith("EN")||G.startsWith("CS")||G.startsWith("CE")?"input":G.startsWith("OUT")||G.startsWith("OUTPUT")||G.includes("OUT+")||G.includes("OUT-")||G==="Y"||G==="Q"||G.startsWith("DO")?"output":"unknown"},ae=[],E=Array.from(k.keys()).sort();for(const Z of E){const G=k.get(Z),te=G.partNumber?.trim()||"";let O="";if(G.componentType==="Resistor"&&"resistance"in G){const{value:ee,unit:de}=Jc(G,"resistance","resistanceUnit",Ps("resistance"));O=ee&&ee.trim()!==""?Qc(ee,de):""}else if((G.componentType==="Capacitor"||G.componentType==="Electrolytic Capacitor"||G.componentType==="Film Capacitor")&&"capacitance"in G){const{value:ee,unit:de}=Jc(G,"capacitance","capacitanceUnit",Ps("capacitance"));O=ee&&ee.trim()!==""?Qc(ee,de):""}else if(G.componentType==="Inductor"&&"inductance"in G){const{value:ee,unit:de}=Jc(G,"inductance","inductanceUnit",Ps("inductance"));O=ee&&ee.trim()!==""?Qc(ee,de):""}else te||(O=G.partName?.trim()||G.componentType);const W=G.packageType?.trim()||G.package?.trim()||G.footprint?.trim()||"",Y=G.pinData,D=G.pinNames,J=G.pinCount||0,$=[];for(let ee=0;ee<J;ee++){const de=String(ee+1);let Ne=de;Y&&ee<Y.length&&Y[ee]?.name?.trim()?Ne=Y[ee].name.trim():D&&ee<D.length&&D[ee]?.trim()&&(Ne=D[ee].trim());let Ie;const $e=Y?.[ee]?.type?.trim();$e&&$e!==""?Ie=$e:Ie=y(Ne),$.push({number:de,name:Ne,type:Ie})}const je={designator:Z,package:W,pins:$};te&&(je.part_number=te),O&&(je.value=O),ae.push(je)}const U=[];for(const[Z,G]of m){const te=j.get(Z);if(!te)continue;const O=[];let W,Y;for(const $ of G)if($.type==="power"&&$.powerBusId){const je=l.find(ee=>ee.id===$.powerBusId);je&&(W=je.name)}else if($.type==="ground"&&$.groundBusId){const je=d.find(ee=>ee.id===$.groundBusId);je&&(Y=je.name)}for(const $ of G)if($.componentId&&$.pinIndex!==void 0){const je=n.find(ee=>ee.id===$.componentId);if(je){const ee=je.designator?.trim()||je.abbreviation?.trim();if(ee){const de=String($.pinIndex+1),Ne=je.pinData,Ie=je.pinNames;let $e=de;Ne&&$.pinIndex<Ne.length&&Ne[$.pinIndex]?.name?.trim()?$e=Ne[$.pinIndex].name.trim():Ie&&$.pinIndex<Ie.length&&Ie[$.pinIndex]?.trim()&&($e=Ie[$.pinIndex].trim());let q;const w=Ne?.[$.pinIndex]?.type?.trim();w&&w!==""&&(q=w);const V={component:ee,pin_number:de,pin_name:$e};q&&(V.pin_type=q);const H=`${je.id}:${$.pinIndex}`,ue=_.get(H);if(ue&&ue.size>0)for(const ve of ue){const se=l.find(xe=>xe.name===ve),ze=d.find(xe=>xe.name===ve);se&&!V.power_bus?V.power_bus=ve:ze&&!V.ground_bus&&(V.ground_bus=ve)}if(!V.power_bus&&$.powerBusId){const ve=l.find(se=>se.id===$.powerBusId);ve&&(V.power_bus=ve.name)}if(!V.ground_bus&&$.groundBusId){const ve=d.find(se=>se.id===$.groundBusId);ve&&(V.ground_bus=ve.name)}!V.power_bus&&W&&(V.power_bus=W),!V.ground_bus&&Y&&(V.ground_bus=Y),O.push(V)}}}const D=te.startsWith("+")||te.startsWith("-"),J=te==="GND"||te.toUpperCase().includes("GROUND");(O.length>0||D||J)&&U.push({name:te,connections:O})}U.sort((Z,G)=>{if(Z.name==="GND")return-1;if(G.name==="GND")return 1;const te=Z.name.startsWith("+")||Z.name.startsWith("-"),O=G.name.startsWith("+")||G.name.startsWith("-");if(te&&!O)return-1;if(!te&&O)return 1;if(te&&O){const W=parseFloat(Z.name.replace(/[^0-9.-]/g,""))||0,Y=parseFloat(G.name.replace(/[^0-9.-]/g,""))||0;if(Y!==W)return Y-W}return Z.name.localeCompare(G.name)});const ne={design_info:{name:b||"reversed_pcb",date:new Date().toISOString().split("T")[0]},components:ae,nets:U};return JSON.stringify(ne,null,2)}function pd(n,r,o,s){if(r==="power"){const d=n[r]||"";return typeof d=="string"&&d.trim()!==""?{value:d.replace(/W$/i,"").trim(),unit:"W"}:{value:"",unit:"W"}}if(n[r]!==void 0||n[o]!==void 0)return{value:n[r]||"",unit:n[o]||s};const l=n[r]||"";return typeof l=="string"&&l.trim()!==""?lx(l):{value:"",unit:s}}function tb(n){if((n.componentType==="Resistor"||n.componentType==="ResistorNetwork"||n.componentType==="Thermistor"||n.componentType==="VariableResistor")&&"resistance"in n){const{value:s,unit:l}=pd(n,"resistance","resistanceUnit",Ps("resistance"));if(s&&s.trim()!=="")return fd(s,l)}if((n.componentType==="Capacitor"||n.componentType==="Electrolytic Capacitor"||n.componentType==="Film Capacitor")&&"capacitance"in n){const{value:s,unit:l}=pd(n,"capacitance","capacitanceUnit",Ps("capacitance"));if(s&&s.trim()!=="")return fd(s,l)}if(n.componentType==="Inductor"&&"inductance"in n){const{value:s,unit:l}=pd(n,"inductance","inductanceUnit",Ps("inductance"));if(s&&s.trim()!=="")return fd(s,l)}if(n.componentType==="Fuse"&&"current"in n){const{value:s,unit:l}=pd(n,"current","currentUnit",Ps("current"));if(s&&s.trim()!=="")return fd(s,l)}if(n.componentType==="Battery"){const{value:s,unit:l}=pd(n,"capacity","capacityUnit",Ps("capacity"));if(s&&s.trim()!=="")return fd(s,l);const{value:d,unit:b}=pd(n,"voltage","voltageUnit",Ps("voltage"));if(d&&d.trim()!=="")return fd(d,b)}if(n.componentType==="PowerSupply"){const{value:s,unit:l}=pd(n,"outputVoltage","outputVoltageUnit",Ps("voltage"));if(s&&s.trim()!=="")return fd(s,l)}const r=n.partName?.trim();if(r&&r!=="")return r;const o=n.partNumber?.trim();return o&&o!==""?o:Wl(n.componentType)}function nb(n,r,o){const s=[...n,...r],l=s.length,d=new Map;for(const p of s){const v=Wl(p.componentType),m=tb(p),j=`${v}|${m}`;if(!d.has(j)){const M=n.some(P=>P.id===p.id),T=r.some(P=>P.id===p.id),F=M&&T?"both":M?"top":"bottom";d.set(j,{componentType:v,value:m,quantity:0,designators:[],packageType:p.packageType,manufacturer:p.manufacturer,partNumber:p.partNumber,description:p.description,notes:p.notes,datasheet:p.datasheet,layer:F})}const _=d.get(j);_.quantity++,p.designator&&p.designator.trim()!==""&&_.designators.push(p.designator.trim())}const b=Array.from(d.values()).sort((p,v)=>p.componentType!==v.componentType?p.componentType.localeCompare(v.componentType):p.value.localeCompare(v.value));return{version:"1.0",exportedAt:new Date().toISOString(),projectName:o,totalComponents:l,uniqueComponents:b.length,items:b}}const R1={via:{color:"#2CA02C",size:18},padTop:{color:"#0072B2",size:18},padBottom:{color:"#56B4E9",size:18},testPointTop:{color:"#FFFF00",size:18},testPointBottom:{color:"#FFFF00",size:18},traceTop:{color:"#AA4499",size:6},traceBottom:{color:"#F781BF",size:6},componentTop:{color:"#6A3D9A",size:18},componentBottom:{color:"#9467BD",size:18},power:{color:"#ff0000",size:18},ground:{color:"#000000",size:18}},Kf={via:"Via",padTop:"Pad (Top)",padBottom:"Pad (Bottom)",testPointTop:"Test Point (Top)",testPointBottom:"Test Point (Bottom)",traceTop:"Trace (Top)",traceBottom:"Trace (Bottom)",componentTop:"Component (Top)",componentBottom:"Component (Bottom)",power:"Power",ground:"Ground"};class ib{instances=new Map;listeners=new Map;initialize(){for(const r of Object.keys(R1)){const o=R1[r];this.instances.set(r,{id:r,name:Kf[r],color:o.color,size:o.size}),this.listeners.set(r,new Set)}}initializeFromProject(r){if(this.initialize(),r?.toolInstances)for(const[o,s]of Object.entries(r.toolInstances))this.instances.has(o)&&this.instances.set(o,s)}get(r){const o=this.instances.get(r);if(!o)throw new Error(`Tool instance ${r} not found`);return o}getColor(r){const o=this.instances.get(r);if(!o)throw new Error(`Tool instance ${r} not found`);const s=Kf[r];return console.log(`${s}, returning color value=${o.color}`),o.color}getSize(r){const o=this.instances.get(r);if(!o)throw new Error(`Tool instance ${r} not found`);const s=Kf[r];return console.log(`${s}, returning size value=${o.size}`),o.size}setColor(r,o){const s=this.instances.get(r);if(s){const l=Kf[r];console.log(`${l}, setting color value=${o}`),s.color=o,this.notifyListeners(r)}}setSize(r,o){const s=this.instances.get(r);if(s){const l=Kf[r];console.log(`${l}, setting size value=${o}`),s.size=o,this.notifyListeners(r)}}getAll(){const r={};for(const[o,s]of this.instances.entries())r[o]=s;return r}subscribe(r,o){const s=this.listeners.get(r);return s?(s.add(o),()=>{s.delete(o)}):()=>{}}notifyListeners(r){const o=this.listeners.get(r);o&&o.forEach(s=>s())}}const Ln=new ib;Ln.initialize();function Jp(n,r){switch(n){case"via":return"via";case"pad":return r==="bottom"?"padBottom":"padTop";case"testPoint":return r==="bottom"?"testPointBottom":"testPointTop";case"trace":return r==="bottom"?"traceBottom":"traceTop";case"component":return r==="bottom"?"componentBottom":"componentTop";case"power":return"power";case"ground":return"ground";default:throw new Error(`Unknown tool: ${n}`)}}function rb(n){return()=>{console.log("closeProject: Starting comprehensive state clearing..."),n.setProjectDirHandle(null),n.setAutoSaveDirHandle(null),n.projectDirHandleRef&&(n.projectDirHandleRef.current=null),n.autoSaveDirHandleRef&&(n.autoSaveDirHandleRef.current=null),n.setCurrentProjectFilePath(""),n.setProjectName(""),n.setAutoSaveEnabled(!1),n.setAutoSaveInterval(null),n.setAutoSaveBaseName(""),n.setAutoSaveFileHistory([]),n.setCurrentFileIndex(-1),n.autoSaveBaseNameRef&&(n.autoSaveBaseNameRef.current=""),n.hasChangesSinceLastAutoSaveRef.current=!1,n.setHasUnsavedChangesState(!1),n.setIsBottomView(!1),n.setOriginalTopFlipX(null),n.setOriginalBottomFlipX(null),n.autoSaveIntervalRef.current&&(clearInterval(n.autoSaveIntervalRef.current),n.autoSaveIntervalRef.current=null),n.setTopImage(null),n.setBottomImage(null),n.clearSnapshot(),n.setDrawingStrokes([]),n.setVias([]),n.setPads([]),n.setTracesTop([]),n.setTracesBottom([]),n.setCurrentStroke([]),n.currentStrokeRef.current=[],n.setComponentsTop([]),n.setComponentsBottom([]),n.setComponentEditor(null),n.setConnectingPin(null),n.setPowerSymbols([]),n.setGroundSymbols([]),n.setPowerEditor(null),n.setPowerBuses([{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),n.setGroundBuses([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),n.setSelectedIds(new Set),n.setSelectedComponentIds(new Set),n.setSelectedPowerIds(new Set),n.setSelectedGroundIds(new Set),n.setIsSelecting(!1),n.setProjectNotes([]),n.setProjectMetadata({productName:"",productVersion:"",manufacturer:"",date:new Date().toISOString().split("T")[0]}),n.setCurrentView("overlay"),n.setViewScale(1),n.setCameraCenter(0,0),n.setShowBothLayers(!0),n.setSelectedDrawingLayer("top"),n.setHomeViews({}),n.setIsWaitingForHomeViewKey(!1),n.homeViewTimeoutRef.current&&(clearTimeout(n.homeViewTimeoutRef.current),n.homeViewTimeoutRef.current=null),n.setSelectedImageForTransform(null),n.setIsTransforming(!1),n.setTransformStartPos(null),n.setTransformMode("nudge"),n.setIsGrayscale(!1),n.setTransparency(50),n.setIsTransparencyCycling(!1),n.setTransparencyCycleSpeed(2e3),n.setAreImagesLocked(!1),n.setAreViasLocked(!1),n.setArePadsLocked(!1),n.setAreTestPointsLocked(!1),n.setAreTracesLocked(!1),n.setAreComponentsLocked(!1),n.setAreGroundNodesLocked(!1),n.setArePowerNodesLocked(!1),n.setShowTopImage(!0),n.setShowBottomImage(!0),n.setShowViasLayer(!0),n.setShowTopTracesLayer(!0),n.setShowBottomTracesLayer(!0),n.setShowTopPadsLayer(!0),n.setShowBottomPadsLayer(!0),n.setShowTopTestPointsLayer(!0),n.setShowBottomTestPointsLayer(!0),n.setShowTopComponents(!0),n.setShowBottomComponents(!0),n.setShowPowerLayer(!0),n.setShowGroundLayer(!0),n.setShowConnectionsLayer(!0),n.setShowTraceCornerDots(!0),n.setCurrentTool("select"),n.setDrawingMode("trace"),n.setTraceToolLayer("top"),n.setPadToolLayer("top"),n.setTestPointToolLayer("top"),n.setComponentToolLayer("top"),n.traceToolLayerRef.current="top",n.padToolLayerRef.current="top",n.testPointToolLayerRef.current="top",n.componentToolLayerRef.current="top",n.sessionDesignatorCountersRef.current={},n.setAutoAssignDesignators(!0),n.setUseGlobalDesignatorCounters(!1),ep(),Ln.initialize(),n.setOpenMenu(null),n.setDebugDialog({visible:!1,text:""}),n.setErrorDialog({visible:!1,title:"",message:""}),n.setNewProjectDialog({visible:!1}),n.setOpenProjectDialog({visible:!1}),n.setNewProjectSetupDialog({visible:!1,projectName:"",locationPath:"",locationHandle:null}),n.setSaveAsDialog({visible:!1,filename:"",locationPath:"",locationHandle:null}),n.setAutoSaveDialog({visible:!1,interval:null}),n.setAutoSavePromptDialog({visible:!1,source:"new",interval:5}),n.setShowColorPicker(!1),n.setShowPowerBusManager(!1),n.setShowGroundBusManager(!1),n.setShowDesignatorManager(!1),n.setShowBoardDimensionsDialog(!1),n.setNotesDialogVisible(!1),n.setProjectNotesDialogVisible(!1),n.setTransformImagesDialogVisible(!1),n.setTransformAllDialogVisible(!1),n.setBoardDimensions(null),n.setHoverComponent(null),n.setHoverTestPoint(null),n.setIsPanning(!1),n.panStartRef.current=null,n.panClientStartRef.current=null,n.setIsDrawing(!1),n.setTracePreviewMousePos(null),n.lastTraceClickTimeRef.current=0,n.isDoubleClickingTraceRef.current=!1,console.log("closeProject: All state cleared and browser permissions released")}}async function ob(n){console.log("Ensuring project isolation: Starting comprehensive cleanup..."),n(),await new Promise(r=>setTimeout(r,150)),Ln.initialize(),ep(),await new Promise(r=>setTimeout(r,50)),console.log("Project isolation complete: All state cleared, safe to proceed with new project")}async function ab(n,r,o,s,l,d,b,p,v,m,j,_,M){const T=n.trim().replace(/[^a-zA-Z0-9_-]/g,"_");if(!T)return{success:!1,error:"Please enter a valid project name."};await o();let F;try{F=await r.getDirectoryHandle(T,{create:!0})}catch(P){return console.error("Failed to create project folder:",P),{success:!1,error:`Failed to create project folder "${T}". See console for details.`}}try{const P=F;if(P.queryPermission&&await P.queryPermission({mode:"readwrite"})!=="granted"&&await P.requestPermission({mode:"readwrite"})!=="granted")return{success:!1,error:"Full access to the project directory is required to create and manage project files."}}catch(P){console.warn("Permission check failed (may not be supported in this browser):",P)}try{await F.getDirectoryHandle("history",{create:!0}),await F.getDirectoryHandle("images",{create:!0}),await F.getDirectoryHandle("datasheets",{create:!0}),await F.getDirectoryHandle("BOM",{create:!0}),await F.getDirectoryHandle("netlists",{create:!0}),console.log("Created project subdirectories: history, images, datasheets, BOM, netlists")}catch(P){console.error("Failed to create project subdirectories:",P)}s(T),l(F),b.current=F,v(),m(),j(!1),_(0);try{const{project:P,timestamp:k}=p(),y=`${T}_${k}.json`,ae=JSON.stringify(P,null,2),E=new Blob([ae],{type:"application/json"}),ne=await(await F.getFileHandle(y,{create:!0})).createWritable();return await ne.write(E),await ne.close(),d(y),console.log(`New project created: ${T}/${y}`),await M(5,T,F,!0),{success:!0,projectDirHandle:F,projectFileName:y,projectName:T}}catch(P){return console.error("Failed to save new project:",P),{success:!1,error:"Failed to save new project file. See console for details."}}}async function I1(n,r,o,s,l,d,b,p,v){const m=window;let j;if(v)j=v;else{if(typeof m.showDirectoryPicker!="function")return{success:!1,error:"Directory picker is not supported in this browser."};try{j=await m.showDirectoryPicker({mode:"readwrite"})}catch(_){if(_?.name==="AbortError")return{success:!1,error:"User cancelled directory selection."};throw _}}try{try{const y=j;if(y.queryPermission&&await y.queryPermission({mode:"readwrite"})!=="granted"&&await y.requestPermission({mode:"readwrite"})!=="granted")return{success:!1,error:"Full access to the project directory is required to open and manage project files."}}catch(y){console.warn("Permission check failed (may not be supported in this browser):",y)}d.current=!0,await n();const _=j.name;let M=null,T=null,F="";try{const y=[],ae=j;for await(const[Z,G]of ae.entries())if(G.kind==="file"&&Z.toLowerCase().endsWith(".json")&&Z.replace(/\.json$/i,"").toLowerCase().startsWith(_.toLowerCase()))try{const O=await G.getFile();y.push({name:Z,handle:G,lastModified:O.lastModified})}catch(O){console.warn(`Failed to read file ${Z}:`,O)}if(y.length===0)return{success:!1,error:`No project file found in the selected directory that starts with "${_}". Please ensure the project file name starts with the directory name.`};y.sort((Z,G)=>G.lastModified-Z.lastModified);const E=y[0];M=E.handle,F=E.name;const ne=await(await M.getFile()).text();T=JSON.parse(ne),o(F),y.length>1?console.log(`Found ${y.length} project files starting with "${_}". Selected most recent: ${F}`):console.log(`Found project file: ${F}`)}catch(y){return console.error("Failed to find or open project file:",y),{success:!1,error:`Failed to open project file: ${y instanceof Error?y.message:String(y)}. See console for details.`}}r(j),l.current=j;try{await j.getDirectoryHandle("history",{create:!0}),await j.getDirectoryHandle("images",{create:!0}),await j.getDirectoryHandle("datasheets",{create:!0}),await j.getDirectoryHandle("BOM",{create:!0}),await j.getDirectoryHandle("netlists",{create:!0}),console.log("Created/verified project subdirectories: history, images, datasheets, BOM, netlists")}catch(y){console.error("Failed to create/verify project subdirectories:",y)}setTimeout(()=>{d.current=!1},1e3),await b(T,j);let P;if(T.projectInfo?.name)P=T.projectInfo.name;else if(P=yd(_).replace(/[^a-zA-Z0-9_-]/g,"_"),!P){const ae=F.replace(/\.json$/i,"");P=yd(ae).replace(/[^a-zA-Z0-9_-]/g,"_")}return P?(s(P),T.autoSave?.enabled===!0&&T.autoSave?.interval?await p(T.autoSave.interval,P,j,!1):await p(5,P,j,!1),{success:!0,projectDirHandle:j,projectFileName:F,projectName:P}):{success:!1,error:"Warning: Could not determine project name. Please ensure the project file or directory has a valid name."}}catch(_){return _?.name==="AbortError"?{success:!1,error:"User cancelled directory selection."}:(console.error("Failed to open project:",_),{success:!1,error:`Failed to open project: ${_ instanceof Error?_.message:String(_)}. See console for details.`})}}async function sb(n,r,o,s,l,d,b,p,v,m,j,_,M,T,F){if(console.log("Auto save: performAutoSave called"),!n||!r){console.warn(`Auto save: Missing project directory handle (${!n}) or base name (${!r}). Please create a new project or open an existing project first.`),T(!1),F.current&&(clearInterval(F.current),F.current=null);return}if(!o.current){console.log("Auto save: Skipping - no changes since last save");return}const P=s.current,k=P.filter(G=>G.type==="trace"&&G.points.length<2);if(k.length>0){console.log(`Auto save: Cleaning up ${k.length} single-point trace(s) before save`),k.forEach(te=>console.log(`  - Removing single-point trace ${te.id}`));const G=P.filter(te=>!(te.type==="trace"&&te.points.length<2));l(G),s.current=G}console.log("Auto save: Starting save...");const{project:y,timestamp:ae}=d(),U=`${yd(r)}_${ae}.json`,ne=JSON.stringify(y,null,2),Z=new Blob([ne],{type:"application/json"});try{let G;try{G=await n.getDirectoryHandle("history",{create:!0})}catch(D){console.error("Failed to get/create history directory:",D);return}try{const D=[],J=p.current;for await(const $ of n.keys())try{if($==="history"||$==="images"||$==="datasheets"||$==="BOM"||$==="netlists"||$===U)continue;const ee=await(await n.getFileHandle($)).getFile();if(!$.endsWith(".json"))continue;const de=await ee.text();try{const Ne=JSON.parse(de);if(Ne.version){D.push($);const Ie=Ne.fileType?"auto-saved":"manually saved/opened";console.log(`Auto save: Found PCB project file in root: ${$} (${Ie}${$===J?" - this is the opened file":""})`)}}catch{continue}}catch{continue}for(const $ of D)try{const de=await(await(await n.getFileHandle($)).getFile()).text(),Ie=await(await G.getFileHandle($,{create:!0})).createWritable();await Ie.write(new Blob([de],{type:"application/json"})),await Ie.close(),await n.removeEntry($),console.log(`Auto save: Moved ${$} from root to history/`)}catch(je){console.warn(`Auto save: Failed to move ${$} to history:`,je)}}catch(D){console.warn("Auto save: Error checking for old files in root:",D)}const O=await(await n.getFileHandle(U,{create:!0})).createWritable();await O.write(Z),await O.close(),console.log(`Auto save: Successfully saved ${U} to root directory`),b(U),p.current=U;const W=m.current,Y=[U,...W.filter(D=>D!==U)].sort((D,J)=>J.localeCompare(D));v(Y),m.current=Y,j(0),_.current=0,o.current=!1,M(!1)}catch(G){console.error("Auto save failed:",G)}}async function nf(n,r,o,s,l,d,b,p,v,m,j,_,M,T,F,P=!1){if(n===null){s(!1),l(null),m.current&&(clearInterval(m.current),m.current=null),_({visible:!1,interval:5}),P&&M({visible:!1,source:null,interval:5}),console.log("Auto save: Disabled");return}if(!r){console.warn("Auto save: No project name available. Please create a new project or open an existing project first.");return}let k=o;if(!k){const ne=window;if(typeof ne.showDirectoryPicker=="function")try{k=await ne.showDirectoryPicker(),T(k)}catch(Z){Z?.name!=="AbortError"&&console.error("Failed to get directory:",Z);return}else{console.warn("Directory picker is not supported in this browser. Auto-save requires a directory handle.");return}}d(k);const y=r.replace(/\.json$/i,""),E=yd(y).replace(/[^a-zA-Z0-9_-]/g,"_");b(E),p.current=k,v.current=E,m.current&&(clearInterval(m.current),m.current=null),l(n),s(!0),j.current=!0,_({visible:!1,interval:5}),P&&M({visible:!1,source:null,interval:5});const U=n*60*1e3;m.current=setInterval(()=>{F.current&&F.current()},U),setTimeout(()=>{console.log(`Auto save: Enabled with interval ${n} minutes`),F.current&&F.current()},200)}const lb="modulepreload",cb=function(n){return"/PCB_Reverse_Engineering_Tool/"+n},L1={},wg=function(r,o,s){let l=Promise.resolve();if(o&&o.length>0){let v=function(m){return Promise.all(m.map(j=>Promise.resolve(j).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};document.getElementsByTagName("link");const b=document.querySelector("meta[property=csp-nonce]"),p=b?.nonce||b?.getAttribute("nonce");l=v(o.map(m=>{if(m=cb(m),m in L1)return;L1[m]=!0;const j=m.endsWith(".css"),_=j?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${_}`))return;const M=document.createElement("link");if(M.rel=j?"stylesheet":lb,j||(M.as="script"),M.crossOrigin="",M.href=m,p&&M.setAttribute("nonce",p),document.head.appendChild(M),j)return new Promise((T,F)=>{M.addEventListener("load",T),M.addEventListener("error",()=>F(new Error(`Unable to preload CSS for ${m}`)))})}))}function d(b){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=b,window.dispatchEvent(p),!p.defaultPrevented)throw b}return l.then(b=>{for(const p of b||[])p.status==="rejected"&&d(p.reason);return r().catch(d)})};function Hr(n){"@babel/helpers - typeof";return Hr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Hr(n)}var kc=Uint8Array,$l=Uint16Array,u0=Int32Array,d0=new kc([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),f0=new kc([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),M1=new kc([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),dx=function(n,r){for(var o=new $l(31),s=0;s<31;++s)o[s]=r+=1<<n[s-1];for(var l=new u0(o[30]),s=1;s<30;++s)for(var d=o[s];d<o[s+1];++d)l[d]=d-o[s]<<5|s;return{b:o,r:l}},fx=dx(d0,2),ub=fx.b,Kg=fx.r;ub[28]=258,Kg[258]=28;var db=dx(f0,0),B1=db.r,Zg=new $l(32768);for(var No=0;No<32768;++No){var Wu=(No&43690)>>1|(No&21845)<<1;Wu=(Wu&52428)>>2|(Wu&13107)<<2,Wu=(Wu&61680)>>4|(Wu&3855)<<4,Zg[No]=((Wu&65280)>>8|(Wu&255)<<8)>>1}var tp=(function(n,r,o){for(var s=n.length,l=0,d=new $l(r);l<s;++l)n[l]&&++d[n[l]-1];var b=new $l(r);for(l=1;l<r;++l)b[l]=b[l-1]+d[l-1]<<1;var p;if(o){p=new $l(1<<r);var v=15-r;for(l=0;l<s;++l)if(n[l])for(var m=l<<4|n[l],j=r-n[l],_=b[n[l]-1]++<<j,M=_|(1<<j)-1;_<=M;++_)p[Zg[_]>>v]=m}else for(p=new $l(s),l=0;l<s;++l)n[l]&&(p[l]=Zg[b[n[l]-1]++]>>15-n[l]);return p}),md=new kc(288);for(var No=0;No<144;++No)md[No]=8;for(var No=144;No<256;++No)md[No]=9;for(var No=256;No<280;++No)md[No]=7;for(var No=280;No<288;++No)md[No]=8;var gh=new kc(32);for(var No=0;No<32;++No)gh[No]=5;var fb=tp(md,9,0),pb=tp(gh,5,0),px=function(n){return(n+7)/8|0},hb=function(n,r,o){return(o==null||o>n.length)&&(o=n.length),new kc(n.subarray(r,o))},wu=function(n,r,o){o<<=r&7;var s=r/8|0;n[s]|=o,n[s+1]|=o>>8},Zf=function(n,r,o){o<<=r&7;var s=r/8|0;n[s]|=o,n[s+1]|=o>>8,n[s+2]|=o>>16},Sg=function(n,r){for(var o=[],s=0;s<n.length;++s)n[s]&&o.push({s,f:n[s]});var l=o.length,d=o.slice();if(!l)return{t:gx,l:0};if(l==1){var b=new kc(o[0].s+1);return b[o[0].s]=1,{t:b,l:1}}o.sort(function(ne,Z){return ne.f-Z.f}),o.push({s:-1,f:25001});var p=o[0],v=o[1],m=0,j=1,_=2;for(o[0]={s:-1,f:p.f+v.f,l:p,r:v};j!=l-1;)p=o[o[m].f<o[_].f?m++:_++],v=o[m!=j&&o[m].f<o[_].f?m++:_++],o[j++]={s:-1,f:p.f+v.f,l:p,r:v};for(var M=d[0].s,s=1;s<l;++s)d[s].s>M&&(M=d[s].s);var T=new $l(M+1),F=Jg(o[j-1],T,0);if(F>r){var s=0,P=0,k=F-r,y=1<<k;for(d.sort(function(Z,G){return T[G.s]-T[Z.s]||Z.f-G.f});s<l;++s){var ae=d[s].s;if(T[ae]>r)P+=y-(1<<F-T[ae]),T[ae]=r;else break}for(P>>=k;P>0;){var E=d[s].s;T[E]<r?P-=1<<r-T[E]++-1:++s}for(;s>=0&&P;--s){var U=d[s].s;T[U]==r&&(--T[U],++P)}F=r}return{t:new kc(T),l:F}},Jg=function(n,r,o){return n.s==-1?Math.max(Jg(n.l,r,o+1),Jg(n.r,r,o+1)):r[n.s]=o},O1=function(n){for(var r=n.length;r&&!n[--r];);for(var o=new $l(++r),s=0,l=n[0],d=1,b=function(v){o[s++]=v},p=1;p<=r;++p)if(n[p]==l&&p!=r)++d;else{if(!l&&d>2){for(;d>138;d-=138)b(32754);d>2&&(b(d>10?d-11<<5|28690:d-3<<5|12305),d=0)}else if(d>3){for(b(l),--d;d>6;d-=6)b(8304);d>2&&(b(d-3<<5|8208),d=0)}for(;d--;)b(l);d=1,l=n[p]}return{c:o.subarray(0,s),n:r}},Jf=function(n,r){for(var o=0,s=0;s<r.length;++s)o+=n[s]*r[s];return o},hx=function(n,r,o){var s=o.length,l=px(r+2);n[l]=s&255,n[l+1]=s>>8,n[l+2]=n[l]^255,n[l+3]=n[l+1]^255;for(var d=0;d<s;++d)n[l+d+4]=o[d];return(l+4+s)*8},F1=function(n,r,o,s,l,d,b,p,v,m,j){wu(r,j++,o),++l[256];for(var _=Sg(l,15),M=_.t,T=_.l,F=Sg(d,15),P=F.t,k=F.l,y=O1(M),ae=y.c,E=y.n,U=O1(P),ne=U.c,Z=U.n,G=new $l(19),te=0;te<ae.length;++te)++G[ae[te]&31];for(var te=0;te<ne.length;++te)++G[ne[te]&31];for(var O=Sg(G,7),W=O.t,Y=O.l,D=19;D>4&&!W[M1[D-1]];--D);var J=m+5<<3,$=Jf(l,md)+Jf(d,gh)+b,je=Jf(l,M)+Jf(d,P)+b+14+3*D+Jf(G,W)+2*G[16]+3*G[17]+7*G[18];if(v>=0&&J<=$&&J<=je)return hx(r,j,n.subarray(v,v+m));var ee,de,Ne,Ie;if(wu(r,j,1+(je<$)),j+=2,je<$){ee=tp(M,T,0),de=M,Ne=tp(P,k,0),Ie=P;var $e=tp(W,Y,0);wu(r,j,E-257),wu(r,j+5,Z-1),wu(r,j+10,D-4),j+=14;for(var te=0;te<D;++te)wu(r,j+3*te,W[M1[te]]);j+=3*D;for(var q=[ae,ne],w=0;w<2;++w)for(var V=q[w],te=0;te<V.length;++te){var H=V[te]&31;wu(r,j,$e[H]),j+=W[H],H>15&&(wu(r,j,V[te]>>5&127),j+=V[te]>>12)}}else ee=fb,de=md,Ne=pb,Ie=gh;for(var te=0;te<p;++te){var ue=s[te];if(ue>255){var H=ue>>18&31;Zf(r,j,ee[H+257]),j+=de[H+257],H>7&&(wu(r,j,ue>>23&31),j+=d0[H]);var ve=ue&31;Zf(r,j,Ne[ve]),j+=Ie[ve],ve>3&&(Zf(r,j,ue>>5&8191),j+=f0[ve])}else Zf(r,j,ee[ue]),j+=de[ue]}return Zf(r,j,ee[256]),j+de[256]},gb=new u0([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),gx=new kc(0),yb=function(n,r,o,s,l,d){var b=d.z||n.length,p=new kc(s+b+5*(1+Math.ceil(b/7e3))+l),v=p.subarray(s,p.length-l),m=d.l,j=(d.r||0)&7;if(r){j&&(v[0]=d.r>>3);for(var _=gb[r-1],M=_>>13,T=_&8191,F=(1<<o)-1,P=d.p||new $l(32768),k=d.h||new $l(F+1),y=Math.ceil(o/3),ae=2*y,E=function(Wt){return(n[Wt]^n[Wt+1]<<y^n[Wt+2]<<ae)&F},U=new u0(25e3),ne=new $l(288),Z=new $l(32),G=0,te=0,O=d.i||0,W=0,Y=d.w||0,D=0;O+2<b;++O){var J=E(O),$=O&32767,je=k[J];if(P[$]=je,k[J]=$,Y<=O){var ee=b-O;if((G>7e3||W>24576)&&(ee>423||!m)){j=F1(n,v,0,U,ne,Z,te,W,D,O-D,j),W=G=te=0,D=O;for(var de=0;de<286;++de)ne[de]=0;for(var de=0;de<30;++de)Z[de]=0}var Ne=2,Ie=0,$e=T,q=$-je&32767;if(ee>2&&J==E(O-q))for(var w=Math.min(M,ee)-1,V=Math.min(32767,O),H=Math.min(258,ee);q<=V&&--$e&&$!=je;){if(n[O+Ne]==n[O+Ne-q]){for(var ue=0;ue<H&&n[O+ue]==n[O+ue-q];++ue);if(ue>Ne){if(Ne=ue,Ie=q,ue>w)break;for(var ve=Math.min(q,ue-2),se=0,de=0;de<ve;++de){var ze=O-q+de&32767,xe=P[ze],De=ze-xe&32767;De>se&&(se=De,je=ze)}}}$=je,je=P[$],q+=$-je&32767}if(Ie){U[W++]=268435456|Kg[Ne]<<18|B1[Ie];var Ye=Kg[Ne]&31,lt=B1[Ie]&31;te+=d0[Ye]+f0[lt],++ne[257+Ye],++Z[lt],Y=O+Ne,++G}else U[W++]=n[O],++ne[n[O]]}}for(O=Math.max(O,Y);O<b;++O)U[W++]=n[O],++ne[n[O]];j=F1(n,v,m,U,ne,Z,te,W,D,O-D,j),m||(d.r=j&7|v[j/8|0]<<3,j-=7,d.h=k,d.p=P,d.i=O,d.w=Y)}else{for(var O=d.w||0;O<b+m;O+=65535){var St=O+65535;St>=b&&(v[j/8|0]=m,St=b),j=hx(v,j+1,n.subarray(O,St))}d.i=b}return hb(p,0,s+px(j)+l)},yx=function(){var n=1,r=0;return{p:function(o){for(var s=n,l=r,d=o.length|0,b=0;b!=d;){for(var p=Math.min(b+2655,d);b<p;++b)l+=s+=o[b];s=(s&65535)+15*(s>>16),l=(l&65535)+15*(l>>16)}n=s,r=l},d:function(){return n%=65521,r%=65521,(n&255)<<24|(n&65280)<<8|(r&255)<<8|r>>8}}},xb=function(n,r,o,s,l){if(!l&&(l={l:1},r.dictionary)){var d=r.dictionary.subarray(-32768),b=new kc(d.length+n.length);b.set(d),b.set(n,d.length),n=b,l.w=d.length}return yb(n,r.level==null?6:r.level,r.mem==null?l.l?Math.ceil(Math.max(8,Math.min(13,Math.log(n.length)))*1.5):20:12+r.mem,o,s,l)},xx=function(n,r,o){for(;o;++r)n[r]=o,o>>>=8},mb=function(n,r){var o=r.level,s=o==0?0:o<6?1:o==9?3:2;if(n[0]=120,n[1]=s<<6|(r.dictionary&&32),n[1]|=31-(n[0]<<8|n[1])%31,r.dictionary){var l=yx();l.p(r.dictionary),xx(n,2,l.d())}};function Qg(n,r){r||(r={});var o=yx();o.p(n);var s=xb(n,r,r.dictionary?6:2,4);return mb(s,r),xx(s,s.length-4,o.d()),s}var bb=typeof TextDecoder<"u"&&new TextDecoder,vb=0;try{bb.decode(gx,{stream:!0}),vb=1}catch{}function wb(n){if(Array.isArray(n))return n}function Sb(n,r){var o=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(o!=null){var s,l,d,b,p=[],v=!0,m=!1;try{if(d=(o=o.call(n)).next,r!==0)for(;!(v=(s=d.call(o)).done)&&(p.push(s.value),p.length!==r);v=!0);}catch(j){m=!0,l=j}finally{try{if(!v&&o.return!=null&&(b=o.return(),Object(b)!==b))return}finally{if(m)throw l}}return p}}function U1(n,r){(r==null||r>n.length)&&(r=n.length);for(var o=0,s=Array(r);o<r;o++)s[o]=n[o];return s}function Tb(n,r){if(n){if(typeof n=="string")return U1(n,r);var o={}.toString.call(n).slice(8,-1);return o==="Object"&&n.constructor&&(o=n.constructor.name),o==="Map"||o==="Set"?Array.from(n):o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?U1(n,r):void 0}}function Cb(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E1(n,r){return wb(n)||Sb(n,r)||Tb(n,r)||Cb()}function V1(n,r="utf8"){return new TextDecoder(r).decode(n)}const jb=new TextEncoder;function Nb(n){return jb.encode(n)}const kb=1024*8,Ab=(()=>{const n=new Uint8Array(4),r=new Uint32Array(n.buffer);return!((r[0]=1)&n[0])})(),Tg={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class p0{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(r=kb,o={}){let s=!1;typeof r=="number"?r=new ArrayBuffer(r):(s=!0,this.lastWrittenByte=r.byteLength);const l=o.offset?o.offset>>>0:0,d=r.byteLength-l;let b=l;(ArrayBuffer.isView(r)||r instanceof p0)&&(r.byteLength!==r.buffer.byteLength&&(b=r.byteOffset+l),r=r.buffer),s?this.lastWrittenByte=d:this.lastWrittenByte=0,this.buffer=r,this.length=d,this.byteLength=d,this.byteOffset=b,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,b,d),this._mark=0,this._marks=[]}available(r=1){return this.offset+r<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(r=1){return this.offset+=r,this}back(r=1){return this.offset-=r,this}seek(r){return this.offset=r,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const r=this._marks.pop();if(r===void 0)throw new Error("Mark stack empty");return this.seek(r),this}rewind(){return this.offset=0,this}ensureAvailable(r=1){if(!this.available(r)){const s=(this.offset+r)*2,l=new Uint8Array(s);l.set(new Uint8Array(this.buffer)),this.buffer=l.buffer,this.length=s,this.byteLength=s,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(r=1){return this.readArray(r,"uint8")}readArray(r,o){const s=Tg[o].BYTES_PER_ELEMENT*r,l=this.byteOffset+this.offset,d=this.buffer.slice(l,l+s);if(this.littleEndian===Ab&&o!=="uint8"&&o!=="int8"){const p=new Uint8Array(this.buffer.slice(l,l+s));p.reverse();const v=new Tg[o](p.buffer);return this.offset+=s,v.reverse(),v}const b=new Tg[o](d);return this.offset+=s,b}readInt16(){const r=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,r}readUint16(){const r=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,r}readInt32(){const r=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,r}readUint32(){const r=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,r}readFloat32(){const r=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,r}readFloat64(){const r=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,r}readBigInt64(){const r=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,r}readBigUint64(){const r=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,r}readChar(){return String.fromCharCode(this.readInt8())}readChars(r=1){let o="";for(let s=0;s<r;s++)o+=this.readChar();return o}readUtf8(r=1){return V1(this.readBytes(r))}decodeText(r=1,o="utf8"){return V1(this.readBytes(r),o)}writeBoolean(r){return this.writeUint8(r?255:0),this}writeInt8(r){return this.ensureAvailable(1),this._data.setInt8(this.offset++,r),this._updateLastWrittenByte(),this}writeUint8(r){return this.ensureAvailable(1),this._data.setUint8(this.offset++,r),this._updateLastWrittenByte(),this}writeByte(r){return this.writeUint8(r)}writeBytes(r){this.ensureAvailable(r.length);for(let o=0;o<r.length;o++)this._data.setUint8(this.offset++,r[o]);return this._updateLastWrittenByte(),this}writeInt16(r){return this.ensureAvailable(2),this._data.setInt16(this.offset,r,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(r){return this.ensureAvailable(2),this._data.setUint16(this.offset,r,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(r){return this.ensureAvailable(4),this._data.setInt32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(r){return this.ensureAvailable(4),this._data.setUint32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(r){return this.ensureAvailable(4),this._data.setFloat32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(r){return this.ensureAvailable(8),this._data.setFloat64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(r){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(r){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(r){return this.writeUint8(r.charCodeAt(0))}writeChars(r){for(let o=0;o<r.length;o++)this.writeUint8(r.charCodeAt(o));return this}writeUtf8(r){return this.writeBytes(Nb(r))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function yf(n){let r=n.length;for(;--r>=0;)n[r]=0}const Pb=3,zb=258,mx=29,_b=256,Db=_b+1+mx,bx=30,Rb=512,Ib=new Array((Db+2)*2);yf(Ib);const Lb=new Array(bx*2);yf(Lb);const Mb=new Array(Rb);yf(Mb);const Bb=new Array(zb-Pb+1);yf(Bb);const Ob=new Array(mx);yf(Ob);const Fb=new Array(bx);yf(Fb);const Ub=(n,r,o,s)=>{let l=n&65535|0,d=n>>>16&65535|0,b=0;for(;o!==0;){b=o>2e3?2e3:o,o-=b;do l=l+r[s++]|0,d=d+l|0;while(--b);l%=65521,d%=65521}return l|d<<16|0};var e0=Ub;const Eb=()=>{let n,r=[];for(var o=0;o<256;o++){n=o;for(var s=0;s<8;s++)n=n&1?3988292384^n>>>1:n>>>1;r[o]=n}return r},Vb=new Uint32Array(Eb()),qb=(n,r,o,s)=>{const l=Vb,d=s+o;n^=-1;for(let b=s;b<d;b++)n=n>>>8^l[(n^r[b])&255];return n^-1};var Kc=qb,t0={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},vx={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const Hb=(n,r)=>Object.prototype.hasOwnProperty.call(n,r);var Wb=function(n){const r=Array.prototype.slice.call(arguments,1);for(;r.length;){const o=r.shift();if(o){if(typeof o!="object")throw new TypeError(o+"must be non-object");for(const s in o)Hb(o,s)&&(n[s]=o[s])}}return n},$b=n=>{let r=0;for(let s=0,l=n.length;s<l;s++)r+=n[s].length;const o=new Uint8Array(r);for(let s=0,l=0,d=n.length;s<d;s++){let b=n[s];o.set(b,l),l+=b.length}return o},wx={assign:Wb,flattenChunks:$b};let Sx=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Sx=!1}const ip=new Uint8Array(256);for(let n=0;n<256;n++)ip[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;ip[254]=ip[254]=1;var Yb=n=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(n);let r,o,s,l,d,b=n.length,p=0;for(l=0;l<b;l++)o=n.charCodeAt(l),(o&64512)===55296&&l+1<b&&(s=n.charCodeAt(l+1),(s&64512)===56320&&(o=65536+(o-55296<<10)+(s-56320),l++)),p+=o<128?1:o<2048?2:o<65536?3:4;for(r=new Uint8Array(p),d=0,l=0;d<p;l++)o=n.charCodeAt(l),(o&64512)===55296&&l+1<b&&(s=n.charCodeAt(l+1),(s&64512)===56320&&(o=65536+(o-55296<<10)+(s-56320),l++)),o<128?r[d++]=o:o<2048?(r[d++]=192|o>>>6,r[d++]=128|o&63):o<65536?(r[d++]=224|o>>>12,r[d++]=128|o>>>6&63,r[d++]=128|o&63):(r[d++]=240|o>>>18,r[d++]=128|o>>>12&63,r[d++]=128|o>>>6&63,r[d++]=128|o&63);return r};const Gb=(n,r)=>{if(r<65534&&n.subarray&&Sx)return String.fromCharCode.apply(null,n.length===r?n:n.subarray(0,r));let o="";for(let s=0;s<r;s++)o+=String.fromCharCode(n[s]);return o};var Xb=(n,r)=>{const o=r||n.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(n.subarray(0,r));let s,l;const d=new Array(o*2);for(l=0,s=0;s<o;){let b=n[s++];if(b<128){d[l++]=b;continue}let p=ip[b];if(p>4){d[l++]=65533,s+=p-1;continue}for(b&=p===2?31:p===3?15:7;p>1&&s<o;)b=b<<6|n[s++]&63,p--;if(p>1){d[l++]=65533;continue}b<65536?d[l++]=b:(b-=65536,d[l++]=55296|b>>10&1023,d[l++]=56320|b&1023)}return Gb(d,l)},Kb=(n,r)=>{r=r||n.length,r>n.length&&(r=n.length);let o=r-1;for(;o>=0&&(n[o]&192)===128;)o--;return o<0||o===0?r:o+ip[n[o]]>r?o:r},n0={string2buf:Yb,buf2string:Xb,utf8border:Kb};function Zb(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Jb=Zb;const Qp=16209,Qb=16191;var ev=function(r,o){let s,l,d,b,p,v,m,j,_,M,T,F,P,k,y,ae,E,U,ne,Z,G,te,O,W;const Y=r.state;s=r.next_in,O=r.input,l=s+(r.avail_in-5),d=r.next_out,W=r.output,b=d-(o-r.avail_out),p=d+(r.avail_out-257),v=Y.dmax,m=Y.wsize,j=Y.whave,_=Y.wnext,M=Y.window,T=Y.hold,F=Y.bits,P=Y.lencode,k=Y.distcode,y=(1<<Y.lenbits)-1,ae=(1<<Y.distbits)-1;e:do{F<15&&(T+=O[s++]<<F,F+=8,T+=O[s++]<<F,F+=8),E=P[T&y];t:for(;;){if(U=E>>>24,T>>>=U,F-=U,U=E>>>16&255,U===0)W[d++]=E&65535;else if(U&16){ne=E&65535,U&=15,U&&(F<U&&(T+=O[s++]<<F,F+=8),ne+=T&(1<<U)-1,T>>>=U,F-=U),F<15&&(T+=O[s++]<<F,F+=8,T+=O[s++]<<F,F+=8),E=k[T&ae];n:for(;;){if(U=E>>>24,T>>>=U,F-=U,U=E>>>16&255,U&16){if(Z=E&65535,U&=15,F<U&&(T+=O[s++]<<F,F+=8,F<U&&(T+=O[s++]<<F,F+=8)),Z+=T&(1<<U)-1,Z>v){r.msg="invalid distance too far back",Y.mode=Qp;break e}if(T>>>=U,F-=U,U=d-b,Z>U){if(U=Z-U,U>j&&Y.sane){r.msg="invalid distance too far back",Y.mode=Qp;break e}if(G=0,te=M,_===0){if(G+=m-U,U<ne){ne-=U;do W[d++]=M[G++];while(--U);G=d-Z,te=W}}else if(_<U){if(G+=m+_-U,U-=_,U<ne){ne-=U;do W[d++]=M[G++];while(--U);if(G=0,_<ne){U=_,ne-=U;do W[d++]=M[G++];while(--U);G=d-Z,te=W}}}else if(G+=_-U,U<ne){ne-=U;do W[d++]=M[G++];while(--U);G=d-Z,te=W}for(;ne>2;)W[d++]=te[G++],W[d++]=te[G++],W[d++]=te[G++],ne-=3;ne&&(W[d++]=te[G++],ne>1&&(W[d++]=te[G++]))}else{G=d-Z;do W[d++]=W[G++],W[d++]=W[G++],W[d++]=W[G++],ne-=3;while(ne>2);ne&&(W[d++]=W[G++],ne>1&&(W[d++]=W[G++]))}}else if((U&64)===0){E=k[(E&65535)+(T&(1<<U)-1)];continue n}else{r.msg="invalid distance code",Y.mode=Qp;break e}break}}else if((U&64)===0){E=P[(E&65535)+(T&(1<<U)-1)];continue t}else if(U&32){Y.mode=Qb;break e}else{r.msg="invalid literal/length code",Y.mode=Qp;break e}break}}while(s<l&&d<p);ne=F>>3,s-=ne,F-=ne<<3,T&=(1<<F)-1,r.next_in=s,r.next_out=d,r.avail_in=s<l?5+(l-s):5-(s-l),r.avail_out=d<p?257+(p-d):257-(d-p),Y.hold=T,Y.bits=F};const rf=15,q1=852,H1=592,W1=0,Cg=1,$1=2,tv=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),nv=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),iv=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),rv=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),ov=(n,r,o,s,l,d,b,p)=>{const v=p.bits;let m=0,j=0,_=0,M=0,T=0,F=0,P=0,k=0,y=0,ae=0,E,U,ne,Z,G,te=null,O;const W=new Uint16Array(rf+1),Y=new Uint16Array(rf+1);let D=null,J,$,je;for(m=0;m<=rf;m++)W[m]=0;for(j=0;j<s;j++)W[r[o+j]]++;for(T=v,M=rf;M>=1&&W[M]===0;M--);if(T>M&&(T=M),M===0)return l[d++]=1<<24|64<<16|0,l[d++]=1<<24|64<<16|0,p.bits=1,0;for(_=1;_<M&&W[_]===0;_++);for(T<_&&(T=_),k=1,m=1;m<=rf;m++)if(k<<=1,k-=W[m],k<0)return-1;if(k>0&&(n===W1||M!==1))return-1;for(Y[1]=0,m=1;m<rf;m++)Y[m+1]=Y[m]+W[m];for(j=0;j<s;j++)r[o+j]!==0&&(b[Y[r[o+j]]++]=j);if(n===W1?(te=D=b,O=20):n===Cg?(te=tv,D=nv,O=257):(te=iv,D=rv,O=0),ae=0,j=0,m=_,G=d,F=T,P=0,ne=-1,y=1<<T,Z=y-1,n===Cg&&y>q1||n===$1&&y>H1)return 1;for(;;){J=m-P,b[j]+1<O?($=0,je=b[j]):b[j]>=O?($=D[b[j]-O],je=te[b[j]-O]):($=96,je=0),E=1<<m-P,U=1<<F,_=U;do U-=E,l[G+(ae>>P)+U]=J<<24|$<<16|je|0;while(U!==0);for(E=1<<m-1;ae&E;)E>>=1;if(E!==0?(ae&=E-1,ae+=E):ae=0,j++,--W[m]===0){if(m===M)break;m=r[o+b[j]]}if(m>T&&(ae&Z)!==ne){for(P===0&&(P=T),G+=_,F=m-P,k=1<<F;F+P<M&&(k-=W[F+P],!(k<=0));)F++,k<<=1;if(y+=1<<F,n===Cg&&y>q1||n===$1&&y>H1)return 1;ne=ae&Z,l[ne]=T<<24|F<<16|G-d|0}}return ae!==0&&(l[G+ae]=m-P<<24|64<<16|0),p.bits=T,0};var np=ov;const av=0,Tx=1,Cx=2,{Z_FINISH:Y1,Z_BLOCK:sv,Z_TREES:eh,Z_OK:bd,Z_STREAM_END:lv,Z_NEED_DICT:cv,Z_STREAM_ERROR:dc,Z_DATA_ERROR:jx,Z_MEM_ERROR:Nx,Z_BUF_ERROR:uv,Z_DEFLATED:G1}=vx,jh=16180,X1=16181,K1=16182,Z1=16183,J1=16184,Q1=16185,ey=16186,ty=16187,ny=16188,iy=16189,yh=16190,Su=16191,jg=16192,ry=16193,Ng=16194,oy=16195,ay=16196,sy=16197,ly=16198,th=16199,nh=16200,cy=16201,uy=16202,dy=16203,fy=16204,py=16205,kg=16206,hy=16207,gy=16208,Io=16209,kx=16210,Ax=16211,dv=852,fv=592,pv=15,hv=pv,yy=n=>(n>>>24&255)+(n>>>8&65280)+((n&65280)<<8)+((n&255)<<24);function gv(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const vd=n=>{if(!n)return 1;const r=n.state;return!r||r.strm!==n||r.mode<jh||r.mode>Ax?1:0},Px=n=>{if(vd(n))return dc;const r=n.state;return n.total_in=n.total_out=r.total=0,n.msg="",r.wrap&&(n.adler=r.wrap&1),r.mode=jh,r.last=0,r.havedict=0,r.flags=-1,r.dmax=32768,r.head=null,r.hold=0,r.bits=0,r.lencode=r.lendyn=new Int32Array(dv),r.distcode=r.distdyn=new Int32Array(fv),r.sane=1,r.back=-1,bd},zx=n=>{if(vd(n))return dc;const r=n.state;return r.wsize=0,r.whave=0,r.wnext=0,Px(n)},_x=(n,r)=>{let o;if(vd(n))return dc;const s=n.state;return r<0?(o=0,r=-r):(o=(r>>4)+5,r<48&&(r&=15)),r&&(r<8||r>15)?dc:(s.window!==null&&s.wbits!==r&&(s.window=null),s.wrap=o,s.wbits=r,zx(n))},Dx=(n,r)=>{if(!n)return dc;const o=new gv;n.state=o,o.strm=n,o.window=null,o.mode=jh;const s=_x(n,r);return s!==bd&&(n.state=null),s},yv=n=>Dx(n,hv);let xy=!0,Ag,Pg;const xv=n=>{if(xy){Ag=new Int32Array(512),Pg=new Int32Array(32);let r=0;for(;r<144;)n.lens[r++]=8;for(;r<256;)n.lens[r++]=9;for(;r<280;)n.lens[r++]=7;for(;r<288;)n.lens[r++]=8;for(np(Tx,n.lens,0,288,Ag,0,n.work,{bits:9}),r=0;r<32;)n.lens[r++]=5;np(Cx,n.lens,0,32,Pg,0,n.work,{bits:5}),xy=!1}n.lencode=Ag,n.lenbits=9,n.distcode=Pg,n.distbits=5},Rx=(n,r,o,s)=>{let l;const d=n.state;return d.window===null&&(d.wsize=1<<d.wbits,d.wnext=0,d.whave=0,d.window=new Uint8Array(d.wsize)),s>=d.wsize?(d.window.set(r.subarray(o-d.wsize,o),0),d.wnext=0,d.whave=d.wsize):(l=d.wsize-d.wnext,l>s&&(l=s),d.window.set(r.subarray(o-s,o-s+l),d.wnext),s-=l,s?(d.window.set(r.subarray(o-s,o),0),d.wnext=s,d.whave=d.wsize):(d.wnext+=l,d.wnext===d.wsize&&(d.wnext=0),d.whave<d.wsize&&(d.whave+=l))),0},mv=(n,r)=>{let o,s,l,d,b,p,v,m,j,_,M,T,F,P,k=0,y,ae,E,U,ne,Z,G,te;const O=new Uint8Array(4);let W,Y;const D=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(vd(n)||!n.output||!n.input&&n.avail_in!==0)return dc;o=n.state,o.mode===Su&&(o.mode=jg),b=n.next_out,l=n.output,v=n.avail_out,d=n.next_in,s=n.input,p=n.avail_in,m=o.hold,j=o.bits,_=p,M=v,te=bd;e:for(;;)switch(o.mode){case jh:if(o.wrap===0){o.mode=jg;break}for(;j<16;){if(p===0)break e;p--,m+=s[d++]<<j,j+=8}if(o.wrap&2&&m===35615){o.wbits===0&&(o.wbits=15),o.check=0,O[0]=m&255,O[1]=m>>>8&255,o.check=Kc(o.check,O,2,0),m=0,j=0,o.mode=X1;break}if(o.head&&(o.head.done=!1),!(o.wrap&1)||(((m&255)<<8)+(m>>8))%31){n.msg="incorrect header check",o.mode=Io;break}if((m&15)!==G1){n.msg="unknown compression method",o.mode=Io;break}if(m>>>=4,j-=4,G=(m&15)+8,o.wbits===0&&(o.wbits=G),G>15||G>o.wbits){n.msg="invalid window size",o.mode=Io;break}o.dmax=1<<o.wbits,o.flags=0,n.adler=o.check=1,o.mode=m&512?iy:Su,m=0,j=0;break;case X1:for(;j<16;){if(p===0)break e;p--,m+=s[d++]<<j,j+=8}if(o.flags=m,(o.flags&255)!==G1){n.msg="unknown compression method",o.mode=Io;break}if(o.flags&57344){n.msg="unknown header flags set",o.mode=Io;break}o.head&&(o.head.text=m>>8&1),o.flags&512&&o.wrap&4&&(O[0]=m&255,O[1]=m>>>8&255,o.check=Kc(o.check,O,2,0)),m=0,j=0,o.mode=K1;case K1:for(;j<32;){if(p===0)break e;p--,m+=s[d++]<<j,j+=8}o.head&&(o.head.time=m),o.flags&512&&o.wrap&4&&(O[0]=m&255,O[1]=m>>>8&255,O[2]=m>>>16&255,O[3]=m>>>24&255,o.check=Kc(o.check,O,4,0)),m=0,j=0,o.mode=Z1;case Z1:for(;j<16;){if(p===0)break e;p--,m+=s[d++]<<j,j+=8}o.head&&(o.head.xflags=m&255,o.head.os=m>>8),o.flags&512&&o.wrap&4&&(O[0]=m&255,O[1]=m>>>8&255,o.check=Kc(o.check,O,2,0)),m=0,j=0,o.mode=J1;case J1:if(o.flags&1024){for(;j<16;){if(p===0)break e;p--,m+=s[d++]<<j,j+=8}o.length=m,o.head&&(o.head.extra_len=m),o.flags&512&&o.wrap&4&&(O[0]=m&255,O[1]=m>>>8&255,o.check=Kc(o.check,O,2,0)),m=0,j=0}else o.head&&(o.head.extra=null);o.mode=Q1;case Q1:if(o.flags&1024&&(T=o.length,T>p&&(T=p),T&&(o.head&&(G=o.head.extra_len-o.length,o.head.extra||(o.head.extra=new Uint8Array(o.head.extra_len)),o.head.extra.set(s.subarray(d,d+T),G)),o.flags&512&&o.wrap&4&&(o.check=Kc(o.check,s,T,d)),p-=T,d+=T,o.length-=T),o.length))break e;o.length=0,o.mode=ey;case ey:if(o.flags&2048){if(p===0)break e;T=0;do G=s[d+T++],o.head&&G&&o.length<65536&&(o.head.name+=String.fromCharCode(G));while(G&&T<p);if(o.flags&512&&o.wrap&4&&(o.check=Kc(o.check,s,T,d)),p-=T,d+=T,G)break e}else o.head&&(o.head.name=null);o.length=0,o.mode=ty;case ty:if(o.flags&4096){if(p===0)break e;T=0;do G=s[d+T++],o.head&&G&&o.length<65536&&(o.head.comment+=String.fromCharCode(G));while(G&&T<p);if(o.flags&512&&o.wrap&4&&(o.check=Kc(o.check,s,T,d)),p-=T,d+=T,G)break e}else o.head&&(o.head.comment=null);o.mode=ny;case ny:if(o.flags&512){for(;j<16;){if(p===0)break e;p--,m+=s[d++]<<j,j+=8}if(o.wrap&4&&m!==(o.check&65535)){n.msg="header crc mismatch",o.mode=Io;break}m=0,j=0}o.head&&(o.head.hcrc=o.flags>>9&1,o.head.done=!0),n.adler=o.check=0,o.mode=Su;break;case iy:for(;j<32;){if(p===0)break e;p--,m+=s[d++]<<j,j+=8}n.adler=o.check=yy(m),m=0,j=0,o.mode=yh;case yh:if(o.havedict===0)return n.next_out=b,n.avail_out=v,n.next_in=d,n.avail_in=p,o.hold=m,o.bits=j,cv;n.adler=o.check=1,o.mode=Su;case Su:if(r===sv||r===eh)break e;case jg:if(o.last){m>>>=j&7,j-=j&7,o.mode=kg;break}for(;j<3;){if(p===0)break e;p--,m+=s[d++]<<j,j+=8}switch(o.last=m&1,m>>>=1,j-=1,m&3){case 0:o.mode=ry;break;case 1:if(xv(o),o.mode=th,r===eh){m>>>=2,j-=2;break e}break;case 2:o.mode=ay;break;case 3:n.msg="invalid block type",o.mode=Io}m>>>=2,j-=2;break;case ry:for(m>>>=j&7,j-=j&7;j<32;){if(p===0)break e;p--,m+=s[d++]<<j,j+=8}if((m&65535)!==(m>>>16^65535)){n.msg="invalid stored block lengths",o.mode=Io;break}if(o.length=m&65535,m=0,j=0,o.mode=Ng,r===eh)break e;case Ng:o.mode=oy;case oy:if(T=o.length,T){if(T>p&&(T=p),T>v&&(T=v),T===0)break e;l.set(s.subarray(d,d+T),b),p-=T,d+=T,v-=T,b+=T,o.length-=T;break}o.mode=Su;break;case ay:for(;j<14;){if(p===0)break e;p--,m+=s[d++]<<j,j+=8}if(o.nlen=(m&31)+257,m>>>=5,j-=5,o.ndist=(m&31)+1,m>>>=5,j-=5,o.ncode=(m&15)+4,m>>>=4,j-=4,o.nlen>286||o.ndist>30){n.msg="too many length or distance symbols",o.mode=Io;break}o.have=0,o.mode=sy;case sy:for(;o.have<o.ncode;){for(;j<3;){if(p===0)break e;p--,m+=s[d++]<<j,j+=8}o.lens[D[o.have++]]=m&7,m>>>=3,j-=3}for(;o.have<19;)o.lens[D[o.have++]]=0;if(o.lencode=o.lendyn,o.lenbits=7,W={bits:o.lenbits},te=np(av,o.lens,0,19,o.lencode,0,o.work,W),o.lenbits=W.bits,te){n.msg="invalid code lengths set",o.mode=Io;break}o.have=0,o.mode=ly;case ly:for(;o.have<o.nlen+o.ndist;){for(;k=o.lencode[m&(1<<o.lenbits)-1],y=k>>>24,ae=k>>>16&255,E=k&65535,!(y<=j);){if(p===0)break e;p--,m+=s[d++]<<j,j+=8}if(E<16)m>>>=y,j-=y,o.lens[o.have++]=E;else{if(E===16){for(Y=y+2;j<Y;){if(p===0)break e;p--,m+=s[d++]<<j,j+=8}if(m>>>=y,j-=y,o.have===0){n.msg="invalid bit length repeat",o.mode=Io;break}G=o.lens[o.have-1],T=3+(m&3),m>>>=2,j-=2}else if(E===17){for(Y=y+3;j<Y;){if(p===0)break e;p--,m+=s[d++]<<j,j+=8}m>>>=y,j-=y,G=0,T=3+(m&7),m>>>=3,j-=3}else{for(Y=y+7;j<Y;){if(p===0)break e;p--,m+=s[d++]<<j,j+=8}m>>>=y,j-=y,G=0,T=11+(m&127),m>>>=7,j-=7}if(o.have+T>o.nlen+o.ndist){n.msg="invalid bit length repeat",o.mode=Io;break}for(;T--;)o.lens[o.have++]=G}}if(o.mode===Io)break;if(o.lens[256]===0){n.msg="invalid code -- missing end-of-block",o.mode=Io;break}if(o.lenbits=9,W={bits:o.lenbits},te=np(Tx,o.lens,0,o.nlen,o.lencode,0,o.work,W),o.lenbits=W.bits,te){n.msg="invalid literal/lengths set",o.mode=Io;break}if(o.distbits=6,o.distcode=o.distdyn,W={bits:o.distbits},te=np(Cx,o.lens,o.nlen,o.ndist,o.distcode,0,o.work,W),o.distbits=W.bits,te){n.msg="invalid distances set",o.mode=Io;break}if(o.mode=th,r===eh)break e;case th:o.mode=nh;case nh:if(p>=6&&v>=258){n.next_out=b,n.avail_out=v,n.next_in=d,n.avail_in=p,o.hold=m,o.bits=j,ev(n,M),b=n.next_out,l=n.output,v=n.avail_out,d=n.next_in,s=n.input,p=n.avail_in,m=o.hold,j=o.bits,o.mode===Su&&(o.back=-1);break}for(o.back=0;k=o.lencode[m&(1<<o.lenbits)-1],y=k>>>24,ae=k>>>16&255,E=k&65535,!(y<=j);){if(p===0)break e;p--,m+=s[d++]<<j,j+=8}if(ae&&(ae&240)===0){for(U=y,ne=ae,Z=E;k=o.lencode[Z+((m&(1<<U+ne)-1)>>U)],y=k>>>24,ae=k>>>16&255,E=k&65535,!(U+y<=j);){if(p===0)break e;p--,m+=s[d++]<<j,j+=8}m>>>=U,j-=U,o.back+=U}if(m>>>=y,j-=y,o.back+=y,o.length=E,ae===0){o.mode=py;break}if(ae&32){o.back=-1,o.mode=Su;break}if(ae&64){n.msg="invalid literal/length code",o.mode=Io;break}o.extra=ae&15,o.mode=cy;case cy:if(o.extra){for(Y=o.extra;j<Y;){if(p===0)break e;p--,m+=s[d++]<<j,j+=8}o.length+=m&(1<<o.extra)-1,m>>>=o.extra,j-=o.extra,o.back+=o.extra}o.was=o.length,o.mode=uy;case uy:for(;k=o.distcode[m&(1<<o.distbits)-1],y=k>>>24,ae=k>>>16&255,E=k&65535,!(y<=j);){if(p===0)break e;p--,m+=s[d++]<<j,j+=8}if((ae&240)===0){for(U=y,ne=ae,Z=E;k=o.distcode[Z+((m&(1<<U+ne)-1)>>U)],y=k>>>24,ae=k>>>16&255,E=k&65535,!(U+y<=j);){if(p===0)break e;p--,m+=s[d++]<<j,j+=8}m>>>=U,j-=U,o.back+=U}if(m>>>=y,j-=y,o.back+=y,ae&64){n.msg="invalid distance code",o.mode=Io;break}o.offset=E,o.extra=ae&15,o.mode=dy;case dy:if(o.extra){for(Y=o.extra;j<Y;){if(p===0)break e;p--,m+=s[d++]<<j,j+=8}o.offset+=m&(1<<o.extra)-1,m>>>=o.extra,j-=o.extra,o.back+=o.extra}if(o.offset>o.dmax){n.msg="invalid distance too far back",o.mode=Io;break}o.mode=fy;case fy:if(v===0)break e;if(T=M-v,o.offset>T){if(T=o.offset-T,T>o.whave&&o.sane){n.msg="invalid distance too far back",o.mode=Io;break}T>o.wnext?(T-=o.wnext,F=o.wsize-T):F=o.wnext-T,T>o.length&&(T=o.length),P=o.window}else P=l,F=b-o.offset,T=o.length;T>v&&(T=v),v-=T,o.length-=T;do l[b++]=P[F++];while(--T);o.length===0&&(o.mode=nh);break;case py:if(v===0)break e;l[b++]=o.length,v--,o.mode=nh;break;case kg:if(o.wrap){for(;j<32;){if(p===0)break e;p--,m|=s[d++]<<j,j+=8}if(M-=v,n.total_out+=M,o.total+=M,o.wrap&4&&M&&(n.adler=o.check=o.flags?Kc(o.check,l,M,b-M):e0(o.check,l,M,b-M)),M=v,o.wrap&4&&(o.flags?m:yy(m))!==o.check){n.msg="incorrect data check",o.mode=Io;break}m=0,j=0}o.mode=hy;case hy:if(o.wrap&&o.flags){for(;j<32;){if(p===0)break e;p--,m+=s[d++]<<j,j+=8}if(o.wrap&4&&m!==(o.total&4294967295)){n.msg="incorrect length check",o.mode=Io;break}m=0,j=0}o.mode=gy;case gy:te=lv;break e;case Io:te=jx;break e;case kx:return Nx;case Ax:default:return dc}return n.next_out=b,n.avail_out=v,n.next_in=d,n.avail_in=p,o.hold=m,o.bits=j,(o.wsize||M!==n.avail_out&&o.mode<Io&&(o.mode<kg||r!==Y1))&&Rx(n,n.output,n.next_out,M-n.avail_out),_-=n.avail_in,M-=n.avail_out,n.total_in+=_,n.total_out+=M,o.total+=M,o.wrap&4&&M&&(n.adler=o.check=o.flags?Kc(o.check,l,M,n.next_out-M):e0(o.check,l,M,n.next_out-M)),n.data_type=o.bits+(o.last?64:0)+(o.mode===Su?128:0)+(o.mode===th||o.mode===Ng?256:0),(_===0&&M===0||r===Y1)&&te===bd&&(te=uv),te},bv=n=>{if(vd(n))return dc;let r=n.state;return r.window&&(r.window=null),n.state=null,bd},vv=(n,r)=>{if(vd(n))return dc;const o=n.state;return(o.wrap&2)===0?dc:(o.head=r,r.done=!1,bd)},wv=(n,r)=>{const o=r.length;let s,l,d;return vd(n)||(s=n.state,s.wrap!==0&&s.mode!==yh)?dc:s.mode===yh&&(l=1,l=e0(l,r,o,0),l!==s.check)?jx:(d=Rx(n,r,o,o),d?(s.mode=kx,Nx):(s.havedict=1,bd))};var Sv=zx,Tv=_x,Cv=Px,jv=yv,Nv=Dx,kv=mv,Av=bv,Pv=vv,zv=wv,_v="pako inflate (from Nodeca project)",Tu={inflateReset:Sv,inflateReset2:Tv,inflateResetKeep:Cv,inflateInit:jv,inflateInit2:Nv,inflate:kv,inflateEnd:Av,inflateGetHeader:Pv,inflateSetDictionary:zv,inflateInfo:_v};function Dv(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Rv=Dv;const Ix=Object.prototype.toString,{Z_NO_FLUSH:Iv,Z_FINISH:Lv,Z_OK:rp,Z_STREAM_END:zg,Z_NEED_DICT:_g,Z_STREAM_ERROR:Mv,Z_DATA_ERROR:my,Z_MEM_ERROR:Bv}=vx;function ap(n){this.options=wx.assign({chunkSize:1024*64,windowBits:15,to:""},n||{});const r=this.options;r.raw&&r.windowBits>=0&&r.windowBits<16&&(r.windowBits=-r.windowBits,r.windowBits===0&&(r.windowBits=-15)),r.windowBits>=0&&r.windowBits<16&&!(n&&n.windowBits)&&(r.windowBits+=32),r.windowBits>15&&r.windowBits<48&&(r.windowBits&15)===0&&(r.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Jb,this.strm.avail_out=0;let o=Tu.inflateInit2(this.strm,r.windowBits);if(o!==rp)throw new Error(t0[o]);if(this.header=new Rv,Tu.inflateGetHeader(this.strm,this.header),r.dictionary&&(typeof r.dictionary=="string"?r.dictionary=n0.string2buf(r.dictionary):Ix.call(r.dictionary)==="[object ArrayBuffer]"&&(r.dictionary=new Uint8Array(r.dictionary)),r.raw&&(o=Tu.inflateSetDictionary(this.strm,r.dictionary),o!==rp)))throw new Error(t0[o])}ap.prototype.push=function(n,r){const o=this.strm,s=this.options.chunkSize,l=this.options.dictionary;let d,b,p;if(this.ended)return!1;for(r===~~r?b=r:b=r===!0?Lv:Iv,Ix.call(n)==="[object ArrayBuffer]"?o.input=new Uint8Array(n):o.input=n,o.next_in=0,o.avail_in=o.input.length;;){for(o.avail_out===0&&(o.output=new Uint8Array(s),o.next_out=0,o.avail_out=s),d=Tu.inflate(o,b),d===_g&&l&&(d=Tu.inflateSetDictionary(o,l),d===rp?d=Tu.inflate(o,b):d===my&&(d=_g));o.avail_in>0&&d===zg&&o.state.wrap>0&&n[o.next_in]!==0;)Tu.inflateReset(o),d=Tu.inflate(o,b);switch(d){case Mv:case my:case _g:case Bv:return this.onEnd(d),this.ended=!0,!1}if(p=o.avail_out,o.next_out&&(o.avail_out===0||d===zg))if(this.options.to==="string"){let v=n0.utf8border(o.output,o.next_out),m=o.next_out-v,j=n0.buf2string(o.output,v);o.next_out=m,o.avail_out=s-m,m&&o.output.set(o.output.subarray(v,v+m),0),this.onData(j)}else this.onData(o.output.length===o.next_out?o.output:o.output.subarray(0,o.next_out));if(!(d===rp&&p===0)){if(d===zg)return d=Tu.inflateEnd(this.strm),this.onEnd(d),this.ended=!0,!0;if(o.avail_in===0)break}}return!0};ap.prototype.onData=function(n){this.chunks.push(n)};ap.prototype.onEnd=function(n){n===rp&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=wx.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function Ov(n,r){const o=new ap(r);if(o.push(n),o.err)throw o.msg||t0[o.err];return o.result}var Fv=ap,Uv=Ov,Ev={Inflate:Fv,inflate:Uv};const{Inflate:Vv,inflate:qv}=Ev;var by=Vv,Hv=qv;const Lx=[];for(let n=0;n<256;n++){let r=n;for(let o=0;o<8;o++)r&1?r=3988292384^r>>>1:r=r>>>1;Lx[n]=r}const vy=4294967295;function Wv(n,r,o){let s=n;for(let l=0;l<o;l++)s=Lx[(s^r[l])&255]^s>>>8;return s}function $v(n,r){return(Wv(vy,n,r)^vy)>>>0}function wy(n,r,o){const s=n.readUint32(),l=$v(new Uint8Array(n.buffer,n.byteOffset+n.offset-r-4,r),r);if(l!==s)throw new Error(`CRC mismatch for chunk ${o}. Expected ${s}, found ${l}`)}function Mx(n,r,o){for(let s=0;s<o;s++)r[s]=n[s]}function Bx(n,r,o,s){let l=0;for(;l<s;l++)r[l]=n[l];for(;l<o;l++)r[l]=n[l]+r[l-s]&255}function Ox(n,r,o,s){let l=0;if(o.length===0)for(;l<s;l++)r[l]=n[l];else for(;l<s;l++)r[l]=n[l]+o[l]&255}function Fx(n,r,o,s,l){let d=0;if(o.length===0){for(;d<l;d++)r[d]=n[d];for(;d<s;d++)r[d]=n[d]+(r[d-l]>>1)&255}else{for(;d<l;d++)r[d]=n[d]+(o[d]>>1)&255;for(;d<s;d++)r[d]=n[d]+(r[d-l]+o[d]>>1)&255}}function Ux(n,r,o,s,l){let d=0;if(o.length===0){for(;d<l;d++)r[d]=n[d];for(;d<s;d++)r[d]=n[d]+r[d-l]&255}else{for(;d<l;d++)r[d]=n[d]+o[d]&255;for(;d<s;d++)r[d]=n[d]+Yv(r[d-l],o[d],o[d-l])&255}}function Yv(n,r,o){const s=n+r-o,l=Math.abs(s-n),d=Math.abs(s-r),b=Math.abs(s-o);return l<=d&&l<=b?n:d<=b?r:o}function Gv(n,r,o,s,l,d){switch(n){case 0:Mx(r,o,l);break;case 1:Bx(r,o,l,d);break;case 2:Ox(r,o,s,l);break;case 3:Fx(r,o,s,l,d);break;case 4:Ux(r,o,s,l,d);break;default:throw new Error(`Unsupported filter: ${n}`)}}const Xv=new Uint16Array([255]),Kv=new Uint8Array(Xv.buffer),Zv=Kv[0]===255;function Jv(n){const{data:r,width:o,height:s,channels:l,depth:d}=n,b=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],p=Math.ceil(d/8)*l,v=new Uint8Array(s*o*p);let m=0;for(let j=0;j<7;j++){const _=b[j],M=Math.ceil((o-_.x)/_.xStep),T=Math.ceil((s-_.y)/_.yStep);if(M<=0||T<=0)continue;const F=M*p,P=new Uint8Array(F);for(let k=0;k<T;k++){const y=r[m++],ae=r.subarray(m,m+F);m+=F;const E=new Uint8Array(F);Gv(y,ae,E,P,F,p),P.set(E);for(let U=0;U<M;U++){const ne=_.x+U*_.xStep,Z=_.y+k*_.yStep;if(!(ne>=o||Z>=s))for(let G=0;G<p;G++)v[(Z*o+ne)*p+G]=E[U*p+G]}}}if(d===16){const j=new Uint16Array(v.buffer);if(Zv)for(let _=0;_<j.length;_++)j[_]=Qv(j[_]);return j}else return v}function Qv(n){return(n&255)<<8|n>>8&255}const e5=new Uint16Array([255]),t5=new Uint8Array(e5.buffer),n5=t5[0]===255,i5=new Uint8Array(0);function Sy(n){const{data:r,width:o,height:s,channels:l,depth:d}=n,b=Math.ceil(d/8)*l,p=Math.ceil(d/8*l*o),v=new Uint8Array(s*p);let m=i5,j=0,_,M;for(let T=0;T<s;T++){switch(_=r.subarray(j+1,j+1+p),M=v.subarray(T*p,(T+1)*p),r[j]){case 0:Mx(_,M,p);break;case 1:Bx(_,M,p,b);break;case 2:Ox(_,M,m,p);break;case 3:Fx(_,M,m,p,b);break;case 4:Ux(_,M,m,p,b);break;default:throw new Error(`Unsupported filter: ${r[j]}`)}m=M,j+=p+1}if(d===16){const T=new Uint16Array(v.buffer);if(n5)for(let F=0;F<T.length;F++)T[F]=r5(T[F]);return T}else return v}function r5(n){return(n&255)<<8|n>>8&255}const lh=Uint8Array.of(137,80,78,71,13,10,26,10);function Ty(n){if(!o5(n.readBytes(lh.length)))throw new Error("wrong PNG signature")}function o5(n){if(n.length<lh.length)return!1;for(let r=0;r<lh.length;r++)if(n[r]!==lh[r])return!1;return!0}const a5="tEXt",s5=0,Ex=new TextDecoder("latin1");function l5(n){if(u5(n),n.length===0||n.length>79)throw new Error("keyword length must be between 1 and 79")}const c5=/^[\u0000-\u00FF]*$/;function u5(n){if(!c5.test(n))throw new Error("invalid latin1 text")}function d5(n,r,o){const s=Vx(r);n[s]=f5(r,o-s.length-1)}function Vx(n){for(n.mark();n.readByte()!==s5;);const r=n.offset;n.reset();const o=Ex.decode(n.readBytes(r-n.offset-1));return n.skip(1),l5(o),o}function f5(n,r){return Ex.decode(n.readBytes(r))}const Hl={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Dg={UNKNOWN:-1,DEFLATE:0},Cy={UNKNOWN:-1,ADAPTIVE:0},Rg={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},ih={NONE:0,BACKGROUND:1,PREVIOUS:2},Ig={SOURCE:0,OVER:1};class p5 extends p0{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(r,o={}){super(r);const{checkCrc:s=!1}=o;this._checkCrc=s,this._inflator=new by,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Dg.UNKNOWN,this._filterMethod=Cy.UNKNOWN,this._interlaceMethod=Rg.UNKNOWN,this._colorType=Hl.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(Ty(this);!this._end;){const r=this.readUint32(),o=this.readChars(4);this.decodeChunk(r,o)}return this.decodeImage(),this._png}decodeApng(){for(Ty(this);!this._end;){const r=this.readUint32(),o=this.readChars(4);this.decodeApngChunk(r,o)}return this.decodeApngImage(),this._apng}decodeChunk(r,o){const s=this.offset;switch(o){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case a5:d5(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${o}`);this._checkCrc?wy(this,r+4,o):this.skip(4)}decodeApngChunk(r,o){const s=this.offset;switch(o!=="fdAT"&&o!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),o){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,o),this.offset=s+r;break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${o}`);this._checkCrc?wy(this,r+4,o):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=h5(this.readUint8());const o=this.readUint8();this._colorType=o;let s;switch(o){case Hl.GREYSCALE:s=1;break;case Hl.TRUECOLOUR:s=3;break;case Hl.INDEXED_COLOUR:s=1;break;case Hl.GREYSCALE_ALPHA:s=2;break;case Hl.TRUECOLOUR_ALPHA:s=4;break;case Hl.UNKNOWN:default:throw new Error(`Unknown color type: ${o}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==Dg.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const o=r/3;this._hasPalette=!0;const s=[];this._palette=s;for(let l=0;l<o;l++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const o=r,s=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,s,o)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let o=r,s=this.offset+this.byteOffset;if(s+=4,o-=4,this._inflator.push(new Uint8Array(this.buffer,s,o)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case Hl.GREYSCALE:case Hl.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let o=0;o<r/2;o++)this._transparency[o]=this.readUint16();break}case Hl.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let o=0;for(;o<r;o++){const s=this.readByte();this._palette[o].push(s)}for(;o<this._palette.length;o++)this._palette[o].push(255);break}case Hl.UNKNOWN:case Hl.GREYSCALE_ALPHA:case Hl.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const o=Vx(this),s=this.readUint8();if(s!==Dg.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const l=this.readBytes(r-o.length-2);this._png.iccEmbeddedProfile={name:o,profile:Hv(l)}}decodepHYs(){const r=this.readUint32(),o=this.readUint32(),s=this.readByte();this._png.resolution={x:r,y:o,unit:s}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const o={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},s=this._frames.at(r);if(s){if(s.data=Sy({data:s.data,width:s.width,height:s.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||s.xOffset===0&&s.yOffset===0&&s.width===this._png.width&&s.height===this._png.height)o.data=s.data;else{const l=this._apng.frames.at(r-1);this.disposeFrame(s,l,o),this.addFrameDataToCanvas(o,s)}this._apng.frames.push(o)}}return this._apng}disposeFrame(r,o,s){switch(r.disposeOp){case ih.NONE:break;case ih.BACKGROUND:for(let l=0;l<this._png.height;l++)for(let d=0;d<this._png.width;d++){const b=(l*r.width+d)*this._png.channels;for(let p=0;p<this._png.channels;p++)s.data[b+p]=0}break;case ih.PREVIOUS:s.data.set(o.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,o){const s=1<<this._png.depth,l=(d,b)=>{const p=((d+o.yOffset)*this._png.width+o.xOffset+b)*this._png.channels,v=(d*o.width+b)*this._png.channels;return{index:p,frameIndex:v}};switch(o.blendOp){case Ig.SOURCE:for(let d=0;d<o.height;d++)for(let b=0;b<o.width;b++){const{index:p,frameIndex:v}=l(d,b);for(let m=0;m<this._png.channels;m++)r.data[p+m]=o.data[v+m]}break;case Ig.OVER:for(let d=0;d<o.height;d++)for(let b=0;b<o.width;b++){const{index:p,frameIndex:v}=l(d,b);for(let m=0;m<this._png.channels;m++){const j=o.data[v+this._png.channels-1]/s,_=m%(this._png.channels-1)===0?1:o.data[v+m],M=Math.floor(j*_+(1-j)*r.data[p+m]);r.data[p+m]+=M}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==Cy.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Rg.NO_INTERLACE)this._png.data=Sy({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Rg.ADAM7)this._png.data=Jv({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,o=this._frames.at(-1);o?o.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:ih.NONE,blendOp:Ig.SOURCE,data:r}),this._inflator=new by,this._writingDataChunks=!1}}function h5(n){if(n!==1&&n!==2&&n!==4&&n!==8&&n!==16)throw new Error(`invalid bit depth: ${n}`);return n}var jy;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.METRE=1]="METRE"})(jy||(jy={}));function g5(n,r){return new p5(n,r).decode()}var pi=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function Lg(){pi.console&&typeof pi.console.log=="function"&&pi.console.log.apply(pi.console,arguments)}var co={log:Lg,warn:function(n){pi.console&&(typeof pi.console.warn=="function"?pi.console.warn.apply(pi.console,arguments):Lg.call(null,arguments))},error:function(n){pi.console&&(typeof pi.console.error=="function"?pi.console.error.apply(pi.console,arguments):Lg(n))}};function Mg(n,r,o){var s=new XMLHttpRequest;s.open("GET",n),s.responseType="blob",s.onload=function(){hd(s.response,r,o)},s.onerror=function(){co.error("could not download file")},s.send()}function Ny(n){var r=new XMLHttpRequest;r.open("HEAD",n,!1);try{r.send()}catch{}return r.status>=200&&r.status<=299}function rh(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(r)}}var hd=pi.saveAs||((typeof window>"u"?"undefined":Hr(window))!=="object"||window!==pi?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(n,r,o){var s=pi.URL||pi.webkitURL,l=document.createElement("a");r=r||n.name||"download",l.download=r,l.rel="noopener",typeof n=="string"?(l.href=n,l.origin!==location.origin?Ny(l.href)?Mg(n,r,o):rh(l,l.target="_blank"):rh(l)):(l.href=s.createObjectURL(n),setTimeout(function(){s.revokeObjectURL(l.href)},4e4),setTimeout(function(){rh(l)},0))}:"msSaveOrOpenBlob"in navigator?function(n,r,o){if(r=r||n.name||"download",typeof n=="string")if(Ny(n))Mg(n,r,o);else{var s=document.createElement("a");s.href=n,s.target="_blank",setTimeout(function(){rh(s)})}else navigator.msSaveOrOpenBlob((function(l,d){return d===void 0?d={autoBom:!1}:Hr(d)!=="object"&&(co.warn("Deprecated: Expected third argument to be a object"),d={autoBom:!d}),d.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(l.type)?new Blob(["\uFEFF",l],{type:l.type}):l})(n,o),r)}:function(n,r,o,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),typeof n=="string")return Mg(n,r,o);var l=n.type==="application/octet-stream",d=/constructor/i.test(pi.HTMLElement)||pi.safari,b=/CriOS\/[\d]+/.test(navigator.userAgent);if((b||l&&d)&&(typeof FileReader>"u"?"undefined":Hr(FileReader))==="object"){var p=new FileReader;p.onloadend=function(){var j=p.result;j=b?j:j.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=j:location=j,s=null},p.readAsDataURL(n)}else{var v=pi.URL||pi.webkitURL,m=v.createObjectURL(n);s?s.location=m:location.href=m,s=null,setTimeout(function(){v.revokeObjectURL(m)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function qx(n){var r;n=n||"",this.ok=!1,n.charAt(0)=="#"&&(n=n.substr(1,6)),n={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[n=(n=n.replace(/ /g,"")).toLowerCase()]||n;for(var o=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(p){return[parseInt(p[1]),parseInt(p[2]),parseInt(p[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(p){return[parseInt(p[1],16),parseInt(p[2],16),parseInt(p[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(p){return[parseInt(p[1]+p[1],16),parseInt(p[2]+p[2],16),parseInt(p[3]+p[3],16)]}}],s=0;s<o.length;s++){var l=o[s].re,d=o[s].process,b=l.exec(n);b&&(r=d(b),this.r=r[0],this.g=r[1],this.b=r[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var p=this.r.toString(16),v=this.g.toString(16),m=this.b.toString(16);return p.length==1&&(p="0"+p),v.length==1&&(v="0"+v),m.length==1&&(m="0"+m),"#"+p+v+m}}var ch=pi.atob.bind(pi),ky=pi.btoa.bind(pi);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Bg(n,r){var o=n[0],s=n[1],l=n[2],d=n[3];o=Es(o,s,l,d,r[0],7,-680876936),d=Es(d,o,s,l,r[1],12,-389564586),l=Es(l,d,o,s,r[2],17,606105819),s=Es(s,l,d,o,r[3],22,-1044525330),o=Es(o,s,l,d,r[4],7,-176418897),d=Es(d,o,s,l,r[5],12,1200080426),l=Es(l,d,o,s,r[6],17,-1473231341),s=Es(s,l,d,o,r[7],22,-45705983),o=Es(o,s,l,d,r[8],7,1770035416),d=Es(d,o,s,l,r[9],12,-1958414417),l=Es(l,d,o,s,r[10],17,-42063),s=Es(s,l,d,o,r[11],22,-1990404162),o=Es(o,s,l,d,r[12],7,1804603682),d=Es(d,o,s,l,r[13],12,-40341101),l=Es(l,d,o,s,r[14],17,-1502002290),o=Vs(o,s=Es(s,l,d,o,r[15],22,1236535329),l,d,r[1],5,-165796510),d=Vs(d,o,s,l,r[6],9,-1069501632),l=Vs(l,d,o,s,r[11],14,643717713),s=Vs(s,l,d,o,r[0],20,-373897302),o=Vs(o,s,l,d,r[5],5,-701558691),d=Vs(d,o,s,l,r[10],9,38016083),l=Vs(l,d,o,s,r[15],14,-660478335),s=Vs(s,l,d,o,r[4],20,-405537848),o=Vs(o,s,l,d,r[9],5,568446438),d=Vs(d,o,s,l,r[14],9,-1019803690),l=Vs(l,d,o,s,r[3],14,-187363961),s=Vs(s,l,d,o,r[8],20,1163531501),o=Vs(o,s,l,d,r[13],5,-1444681467),d=Vs(d,o,s,l,r[2],9,-51403784),l=Vs(l,d,o,s,r[7],14,1735328473),o=qs(o,s=Vs(s,l,d,o,r[12],20,-1926607734),l,d,r[5],4,-378558),d=qs(d,o,s,l,r[8],11,-2022574463),l=qs(l,d,o,s,r[11],16,1839030562),s=qs(s,l,d,o,r[14],23,-35309556),o=qs(o,s,l,d,r[1],4,-1530992060),d=qs(d,o,s,l,r[4],11,1272893353),l=qs(l,d,o,s,r[7],16,-155497632),s=qs(s,l,d,o,r[10],23,-1094730640),o=qs(o,s,l,d,r[13],4,681279174),d=qs(d,o,s,l,r[0],11,-358537222),l=qs(l,d,o,s,r[3],16,-722521979),s=qs(s,l,d,o,r[6],23,76029189),o=qs(o,s,l,d,r[9],4,-640364487),d=qs(d,o,s,l,r[12],11,-421815835),l=qs(l,d,o,s,r[15],16,530742520),o=Hs(o,s=qs(s,l,d,o,r[2],23,-995338651),l,d,r[0],6,-198630844),d=Hs(d,o,s,l,r[7],10,1126891415),l=Hs(l,d,o,s,r[14],15,-1416354905),s=Hs(s,l,d,o,r[5],21,-57434055),o=Hs(o,s,l,d,r[12],6,1700485571),d=Hs(d,o,s,l,r[3],10,-1894986606),l=Hs(l,d,o,s,r[10],15,-1051523),s=Hs(s,l,d,o,r[1],21,-2054922799),o=Hs(o,s,l,d,r[8],6,1873313359),d=Hs(d,o,s,l,r[15],10,-30611744),l=Hs(l,d,o,s,r[6],15,-1560198380),s=Hs(s,l,d,o,r[13],21,1309151649),o=Hs(o,s,l,d,r[4],6,-145523070),d=Hs(d,o,s,l,r[11],10,-1120210379),l=Hs(l,d,o,s,r[2],15,718787259),s=Hs(s,l,d,o,r[9],21,-343485551),n[0]=Yu(o,n[0]),n[1]=Yu(s,n[1]),n[2]=Yu(l,n[2]),n[3]=Yu(d,n[3])}function Nh(n,r,o,s,l,d){return r=Yu(Yu(r,n),Yu(s,d)),Yu(r<<l|r>>>32-l,o)}function Es(n,r,o,s,l,d,b){return Nh(r&o|~r&s,n,r,l,d,b)}function Vs(n,r,o,s,l,d,b){return Nh(r&s|o&~s,n,r,l,d,b)}function qs(n,r,o,s,l,d,b){return Nh(r^o^s,n,r,l,d,b)}function Hs(n,r,o,s,l,d,b){return Nh(o^(r|~s),n,r,l,d,b)}function Hx(n){var r,o=n.length,s=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=n.length;r+=64)Bg(s,y5(n.substring(r-64,r)));n=n.substring(r-64);var l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<n.length;r++)l[r>>2]|=n.charCodeAt(r)<<(r%4<<3);if(l[r>>2]|=128<<(r%4<<3),r>55)for(Bg(s,l),r=0;r<16;r++)l[r]=0;return l[14]=8*o,Bg(s,l),s}function y5(n){var r,o=[];for(r=0;r<64;r+=4)o[r>>2]=n.charCodeAt(r)+(n.charCodeAt(r+1)<<8)+(n.charCodeAt(r+2)<<16)+(n.charCodeAt(r+3)<<24);return o}var Ay="0123456789abcdef".split("");function x5(n){for(var r="",o=0;o<4;o++)r+=Ay[n>>8*o+4&15]+Ay[n>>8*o&15];return r}function m5(n){return String.fromCharCode(255&n,(65280&n)>>8,(16711680&n)>>16,(4278190080&n)>>24)}function i0(n){return Hx(n).map(m5).join("")}var b5=(function(n){for(var r=0;r<n.length;r++)n[r]=x5(n[r]);return n.join("")})(Hx("hello"))!="5d41402abc4b2a76b9719d911017c592";function Yu(n,r){if(b5){var o=(65535&n)+(65535&r);return(n>>16)+(r>>16)+(o>>16)<<16|65535&o}return n+r&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function r0(n,r){var o,s,l,d;if(n!==o){for(var b=(l=n,d=1+(256/n.length|0),new Array(d+1).join(l)),p=[],v=0;v<256;v++)p[v]=v;var m=0;for(v=0;v<256;v++){var j=p[v];m=(m+j+b.charCodeAt(v))%256,p[v]=p[m],p[m]=j}o=n,s=p}else p=s;var _=r.length,M=0,T=0,F="";for(v=0;v<_;v++)T=(T+(j=p[M=(M+1)%256]))%256,p[M]=p[T],p[T]=j,b=p[(p[M]+p[T])%256],F+=String.fromCharCode(r.charCodeAt(v)^b);return F}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Py={print:4,modify:8,copy:16,"annot-forms":32};function lf(n,r,o,s){this.v=1,this.r=2;var l=192;n.forEach(function(p){if(Py.perm!==void 0)throw new Error("Invalid permission: "+p);l+=Py[p]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var d=(r+this.padding).substr(0,32),b=(o+this.padding).substr(0,32);this.O=this.processOwnerPassword(d,b),this.P=-(1+(255^l)),this.encryptionKey=i0(d+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(s)).substr(0,5),this.U=r0(this.encryptionKey,this.padding)}function cf(n){if(/[^\u0000-\u00ff]/.test(n))throw new Error("Invalid PDF Name Object: "+n+", Only accept ASCII characters.");for(var r="",o=n.length,s=0;s<o;s++){var l=n.charCodeAt(s);r+=l<33||l===35||l===37||l===40||l===41||l===47||l===60||l===62||l===91||l===93||l===123||l===125||l>126?"#"+("0"+l.toString(16)).slice(-2):n[s]}return r}function zy(n){if(Hr(n)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var r={};this.subscribe=function(o,s,l){if(l=l||!1,typeof o!="string"||typeof s!="function"||typeof l!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");r.hasOwnProperty(o)||(r[o]={});var d=Math.random().toString(35);return r[o][d]=[s,!!l],d},this.unsubscribe=function(o){for(var s in r)if(r[s][o])return delete r[s][o],Object.keys(r[s]).length===0&&delete r[s],!0;return!1},this.publish=function(o){if(r.hasOwnProperty(o)){var s=Array.prototype.slice.call(arguments,1),l=[];for(var d in r[o]){var b=r[o][d];try{b[0].apply(n,s)}catch(p){pi.console&&co.error("jsPDF PubSub Error",p.message,p)}b[1]&&l.push(d)}l.length&&l.forEach(this.unsubscribe)}},this.getTopics=function(){return r}}function xh(n){if(!(this instanceof xh))return new xh(n);var r="opacity,stroke-opacity".split(",");for(var o in n)n.hasOwnProperty(o)&&r.indexOf(o)>=0&&(this[o]=n[o]);this.id="",this.objectNumber=-1}function Wx(n,r){this.gState=n,this.matrix=r,this.id="",this.objectNumber=-1}function gd(n,r,o,s,l){if(!(this instanceof gd))return new gd(n,r,o,s,l);this.type=n==="axial"?2:3,this.coords=r,this.colors=o,Wx.call(this,s,l)}function uf(n,r,o,s,l){if(!(this instanceof uf))return new uf(n,r,o,s,l);this.boundingBox=n,this.xStep=r,this.yStep=o,this.stream="",this.cloneIndex=0,Wx.call(this,s,l)}function Fn(n){var r,o=typeof arguments[0]=="string"?arguments[0]:"p",s=arguments[1],l=arguments[2],d=arguments[3],b=[],p=1,v=16,m="S",j=null;Hr(n=n||{})==="object"&&(o=n.orientation,s=n.unit||s,l=n.format||l,d=n.compress||n.compressPdf||d,(j=n.encryption||null)!==null&&(j.userPassword=j.userPassword||"",j.ownerPassword=j.ownerPassword||"",j.userPermissions=j.userPermissions||[]),p=typeof n.userUnit=="number"?Math.abs(n.userUnit):1,n.precision!==void 0&&(r=n.precision),n.floatPrecision!==void 0&&(v=n.floatPrecision),m=n.defaultPathOperation||"S"),b=n.filters||(d===!0?["FlateEncode"]:b),s=s||"mm",o=(""+(o||"P")).toLowerCase();var _=n.putOnlyUsedFonts||!1,M={},T={internal:{},__private__:{}};T.__private__.PubSub=zy;var F="1.3",P=T.__private__.getPdfVersion=function(){return F};T.__private__.setPdfVersion=function(C){F=C};var k={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};T.__private__.getPageFormats=function(){return k};var y=T.__private__.getPageFormat=function(C){return k[C]};l=l||"a4";var ae="compat",E="advanced",U=ae;function ne(){this.saveGraphicsState(),ge(new nn(dt,0,0,-dt,0,gs()*dt).toString()+" cm"),this.setFontSize(this.getFontSize()/dt),m="n",U=E}function Z(){this.restoreGraphicsState(),m="S",U=ae}var G=T.__private__.combineFontStyleAndFontWeight=function(C,Q){if(C=="bold"&&Q=="normal"||C=="bold"&&Q==400||C=="normal"&&Q=="italic"||C=="bold"&&Q=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Q&&(C=Q==400||Q==="normal"?C==="italic"?"italic":"normal":Q!=700&&Q!=="bold"||C!=="normal"?(Q==700?"bold":Q)+""+C:"bold"),C};T.advancedAPI=function(C){var Q=U===ae;return Q&&ne.call(this),typeof C!="function"||(C(this),Q&&Z.call(this)),this},T.compatAPI=function(C){var Q=U===E;return Q&&Z.call(this),typeof C!="function"||(C(this),Q&&ne.call(this)),this},T.isAdvancedAPI=function(){return U===E};var te,O=function(C){if(U!==E)throw new Error(C+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},W=T.roundToPrecision=T.__private__.roundToPrecision=function(C,Q){var pe=r||Q;if(isNaN(C)||isNaN(pe))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return C.toFixed(pe).replace(/0+$/,"")};te=T.hpf=T.__private__.hpf=typeof v=="number"?function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.hpf");return W(C,v)}:v==="smart"?function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.hpf");return W(C,C>-1&&C<1?16:5)}:function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.hpf");return W(C,16)};var Y=T.f2=T.__private__.f2=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.f2");return W(C,2)},D=T.__private__.f3=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.f3");return W(C,3)},J=T.scale=T.__private__.scale=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.scale");return U===ae?C*dt:U===E?C:void 0},$=function(C){return J((function(Q){return U===ae?gs()-Q:U===E?Q:void 0})(C))};T.__private__.setPrecision=T.setPrecision=function(C){typeof parseInt(C,10)=="number"&&(r=parseInt(C,10))};var je,ee="00000000000000000000000000000000",de=T.__private__.getFileId=function(){return ee},Ne=T.__private__.setFileId=function(C){return ee=C!==void 0&&/^[a-fA-F0-9]{32}$/.test(C)?C.toUpperCase():ee.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),j!==null&&(uo=new lf(j.userPermissions,j.userPassword,j.ownerPassword,ee)),ee};T.setFileId=function(C){return Ne(C),this},T.getFileId=function(){return de()};var Ie=T.__private__.convertDateToPDFDate=function(C){var Q=C.getTimezoneOffset(),pe=Q<0?"+":"-",Be=Math.floor(Math.abs(Q/60)),Ve=Math.abs(Q%60),gt=[pe,H(Be),"'",H(Ve),"'"].join("");return["D:",C.getFullYear(),H(C.getMonth()+1),H(C.getDate()),H(C.getHours()),H(C.getMinutes()),H(C.getSeconds()),gt].join("")},$e=T.__private__.convertPDFDateToDate=function(C){var Q=parseInt(C.substr(2,4),10),pe=parseInt(C.substr(6,2),10)-1,Be=parseInt(C.substr(8,2),10),Ve=parseInt(C.substr(10,2),10),gt=parseInt(C.substr(12,2),10),mt=parseInt(C.substr(14,2),10);return new Date(Q,pe,Be,Ve,gt,mt,0)},q=T.__private__.setCreationDate=function(C){var Q;if(C===void 0&&(C=new Date),C instanceof Date)Q=Ie(C);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(C))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Q=C}return je=Q},w=T.__private__.getCreationDate=function(C){var Q=je;return C==="jsDate"&&(Q=$e(je)),Q};T.setCreationDate=function(C){return q(C),this},T.getCreationDate=function(C){return w(C)};var V,H=T.__private__.padd2=function(C){return("0"+parseInt(C)).slice(-2)},ue=T.__private__.padd2Hex=function(C){return("00"+(C=C.toString())).substr(C.length)},ve=0,se=[],ze=[],xe=0,De=[],Ye=[],lt=!1,St=ze;T.__private__.setCustomOutputDestination=function(C){lt=!0,St=C};var Wt=function(C){lt||(St=C)};T.__private__.resetCustomOutputDestination=function(){lt=!1,St=ze};var ge=T.__private__.out=function(C){return C=C.toString(),xe+=C.length+1,St.push(C),St},Ot=T.__private__.write=function(C){return ge(arguments.length===1?C.toString():Array.prototype.join.call(arguments," "))},_t=T.__private__.getArrayBuffer=function(C){for(var Q=C.length,pe=new ArrayBuffer(Q),Be=new Uint8Array(pe);Q--;)Be[Q]=C.charCodeAt(Q);return pe},qt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];T.__private__.getStandardFonts=function(){return qt};var ht=n.fontSize||16;T.__private__.setFontSize=T.setFontSize=function(C){return ht=U===E?C/dt:C,this};var fn,Yt=T.__private__.getFontSize=T.getFontSize=function(){return U===ae?ht:ht*dt},ln=n.R2L||!1;T.__private__.setR2L=T.setR2L=function(C){return ln=C,this},T.__private__.getR2L=T.getR2L=function(){return ln};var cn,Sn=T.__private__.setZoomMode=function(C){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(C))fn=C;else if(isNaN(C)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(C)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+C+'" is not recognized.');fn=C}else fn=parseInt(C,10)};T.__private__.getZoomMode=function(){return fn};var mn,tt=T.__private__.setPageMode=function(C){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(C)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+C+'" is not recognized.');cn=C};T.__private__.getPageMode=function(){return cn};var Bt=T.__private__.setLayoutMode=function(C){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(C)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+C+'" is not recognized.');mn=C};T.__private__.getLayoutMode=function(){return mn},T.__private__.setDisplayMode=T.setDisplayMode=function(C,Q,pe){return Sn(C),Bt(Q),tt(pe),this};var Gt={title:"",subject:"",author:"",keywords:"",creator:""};T.__private__.getDocumentProperty=function(C){if(Object.keys(Gt).indexOf(C)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Gt[C]},T.__private__.getDocumentProperties=function(){return Gt},T.__private__.setDocumentProperties=T.setProperties=T.setDocumentProperties=function(C){for(var Q in Gt)Gt.hasOwnProperty(Q)&&C[Q]&&(Gt[Q]=C[Q]);return this},T.__private__.setDocumentProperty=function(C,Q){if(Object.keys(Gt).indexOf(C)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Gt[C]=Q};var an,dt,Mt,Me,we,st={},et={},Pt=[],Rt={},Ge={},zt={},Tt={},tn=null,Xt=0,pn=[],ti=new zy(T),Go=n.hotfixes||[],zn={},Bi={},ni=[],nn=function C(Q,pe,Be,Ve,gt,mt){if(!(this instanceof C))return new C(Q,pe,Be,Ve,gt,mt);isNaN(Q)&&(Q=1),isNaN(pe)&&(pe=0),isNaN(Be)&&(Be=0),isNaN(Ve)&&(Ve=1),isNaN(gt)&&(gt=0),isNaN(mt)&&(mt=0),this._matrix=[Q,pe,Be,Ve,gt,mt]};Object.defineProperty(nn.prototype,"sx",{get:function(){return this._matrix[0]},set:function(C){this._matrix[0]=C}}),Object.defineProperty(nn.prototype,"shy",{get:function(){return this._matrix[1]},set:function(C){this._matrix[1]=C}}),Object.defineProperty(nn.prototype,"shx",{get:function(){return this._matrix[2]},set:function(C){this._matrix[2]=C}}),Object.defineProperty(nn.prototype,"sy",{get:function(){return this._matrix[3]},set:function(C){this._matrix[3]=C}}),Object.defineProperty(nn.prototype,"tx",{get:function(){return this._matrix[4]},set:function(C){this._matrix[4]=C}}),Object.defineProperty(nn.prototype,"ty",{get:function(){return this._matrix[5]},set:function(C){this._matrix[5]=C}}),Object.defineProperty(nn.prototype,"a",{get:function(){return this._matrix[0]},set:function(C){this._matrix[0]=C}}),Object.defineProperty(nn.prototype,"b",{get:function(){return this._matrix[1]},set:function(C){this._matrix[1]=C}}),Object.defineProperty(nn.prototype,"c",{get:function(){return this._matrix[2]},set:function(C){this._matrix[2]=C}}),Object.defineProperty(nn.prototype,"d",{get:function(){return this._matrix[3]},set:function(C){this._matrix[3]=C}}),Object.defineProperty(nn.prototype,"e",{get:function(){return this._matrix[4]},set:function(C){this._matrix[4]=C}}),Object.defineProperty(nn.prototype,"f",{get:function(){return this._matrix[5]},set:function(C){this._matrix[5]=C}}),Object.defineProperty(nn.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(nn.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(nn.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(nn.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),nn.prototype.join=function(C){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(te).join(C)},nn.prototype.multiply=function(C){var Q=C.sx*this.sx+C.shy*this.shx,pe=C.sx*this.shy+C.shy*this.sy,Be=C.shx*this.sx+C.sy*this.shx,Ve=C.shx*this.shy+C.sy*this.sy,gt=C.tx*this.sx+C.ty*this.shx+this.tx,mt=C.tx*this.shy+C.ty*this.sy+this.ty;return new nn(Q,pe,Be,Ve,gt,mt)},nn.prototype.decompose=function(){var C=this.sx,Q=this.shy,pe=this.shx,Be=this.sy,Ve=this.tx,gt=this.ty,mt=Math.sqrt(C*C+Q*Q),$t=(C/=mt)*pe+(Q/=mt)*Be;pe-=C*$t,Be-=Q*$t;var Jt=Math.sqrt(pe*pe+Be*Be);return $t/=Jt,C*(Be/=Jt)<Q*(pe/=Jt)&&(C=-C,Q=-Q,$t=-$t,mt=-mt),{scale:new nn(mt,0,0,Jt,0,0),translate:new nn(1,0,0,1,Ve,gt),rotate:new nn(C,Q,-Q,C,0,0),skew:new nn(1,0,$t,1,0,0)}},nn.prototype.toString=function(C){return this.join(" ")},nn.prototype.inversed=function(){var C=this.sx,Q=this.shy,pe=this.shx,Be=this.sy,Ve=this.tx,gt=this.ty,mt=1/(C*Be-Q*pe),$t=Be*mt,Jt=-Q*mt,rn=-pe*mt,Bn=C*mt;return new nn($t,Jt,rn,Bn,-$t*Ve-rn*gt,-Jt*Ve-Bn*gt)},nn.prototype.applyToPoint=function(C){var Q=C.x*this.sx+C.y*this.shx+this.tx,pe=C.x*this.shy+C.y*this.sy+this.ty;return new oi(Q,pe)},nn.prototype.applyToRectangle=function(C){var Q=this.applyToPoint(C),pe=this.applyToPoint(new oi(C.x+C.w,C.y+C.h));return new en(Q.x,Q.y,pe.x-Q.x,pe.y-Q.y)},nn.prototype.clone=function(){var C=this.sx,Q=this.shy,pe=this.shx,Be=this.sy,Ve=this.tx,gt=this.ty;return new nn(C,Q,pe,Be,Ve,gt)},T.Matrix=nn;var xi=T.matrixMult=function(C,Q){return Q.multiply(C)},hi=new nn(1,0,0,1,0,0);T.unitMatrix=T.identityMatrix=hi;var fr=function(C,Q){if(!Ge[C]){var pe=(Q instanceof gd?"Sh":"P")+(Object.keys(Rt).length+1).toString(10);Q.id=pe,Ge[C]=pe,Rt[pe]=Q,ti.publish("addPattern",Q)}};T.ShadingPattern=gd,T.TilingPattern=uf,T.addShadingPattern=function(C,Q){return O("addShadingPattern()"),fr(C,Q),this},T.beginTilingPattern=function(C){O("beginTilingPattern()"),Ua(C.boundingBox[0],C.boundingBox[1],C.boundingBox[2]-C.boundingBox[0],C.boundingBox[3]-C.boundingBox[1],C.matrix)},T.endTilingPattern=function(C,Q){O("endTilingPattern()"),Q.stream=Ye[V].join(`
`),fr(C,Q),ti.publish("endTilingPattern",Q),ni.pop().restore()};var zr,or=T.__private__.newObject=function(){var C=xt();return Yn(C,!0),C},xt=T.__private__.newObjectDeferred=function(){return ve++,se[ve]=function(){return xe},ve},Yn=function(C,Q){return Q=typeof Q=="boolean"&&Q,se[C]=xe,Q&&ge(C+" 0 obj"),C},ui=T.__private__.newAdditionalObject=function(){var C={objId:xt(),content:""};return De.push(C),C},Si=xt(),ut=xt(),Et=T.__private__.decodeColorString=function(C){var Q=C.split(" ");if(Q.length!==2||Q[1]!=="g"&&Q[1]!=="G")Q.length!==5||Q[4]!=="k"&&Q[4]!=="K"||(Q=[(1-Q[0])*(1-Q[3]),(1-Q[1])*(1-Q[3]),(1-Q[2])*(1-Q[3]),"r"]);else{var pe=parseFloat(Q[0]);Q=[pe,pe,pe,"r"]}for(var Be="#",Ve=0;Ve<3;Ve++)Be+=("0"+Math.floor(255*parseFloat(Q[Ve])).toString(16)).slice(-2);return Be},En=T.__private__.encodeColorString=function(C){var Q;typeof C=="string"&&(C={ch1:C});var pe=C.ch1,Be=C.ch2,Ve=C.ch3,gt=C.ch4,mt=C.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof pe=="string"&&pe.charAt(0)!=="#"){var $t=new qx(pe);if($t.ok)pe=$t.toHex();else if(!/^\d*\.?\d*$/.test(pe))throw new Error('Invalid color "'+pe+'" passed to jsPDF.encodeColorString.')}if(typeof pe=="string"&&/^#[0-9A-Fa-f]{3}$/.test(pe)&&(pe="#"+pe[1]+pe[1]+pe[2]+pe[2]+pe[3]+pe[3]),typeof pe=="string"&&/^#[0-9A-Fa-f]{6}$/.test(pe)){var Jt=parseInt(pe.substr(1),16);pe=Jt>>16&255,Be=Jt>>8&255,Ve=255&Jt}if(Be===void 0||gt===void 0&&pe===Be&&Be===Ve)Q=typeof pe=="string"?pe+" "+mt[0]:C.precision===2?Y(pe/255)+" "+mt[0]:D(pe/255)+" "+mt[0];else if(gt===void 0||Hr(gt)==="object"){if(gt&&!isNaN(gt.a)&&gt.a===0)return["1.","1.","1.",mt[1]].join(" ");Q=typeof pe=="string"?[pe,Be,Ve,mt[1]].join(" "):C.precision===2?[Y(pe/255),Y(Be/255),Y(Ve/255),mt[1]].join(" "):[D(pe/255),D(Be/255),D(Ve/255),mt[1]].join(" ")}else Q=typeof pe=="string"?[pe,Be,Ve,gt,mt[2]].join(" "):C.precision===2?[Y(pe),Y(Be),Y(Ve),Y(gt),mt[2]].join(" "):[D(pe),D(Be),D(Ve),D(gt),mt[2]].join(" ");return Q},Zt=T.__private__.getFilters=function(){return b},Vn=T.__private__.putStream=function(C){var Q=(C=C||{}).data||"",pe=C.filters||Zt(),Be=C.alreadyAppliedFilters||[],Ve=C.addLength1||!1,gt=Q.length,mt=C.objectId,$t=function(Rr){return Rr};if(j!==null&&mt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");j!==null&&($t=uo.encryptor(mt,0));var Jt={};pe===!0&&(pe=["FlateEncode"]);var rn=C.additionalKeyValues||[],Bn=(Jt=Fn.API.processDataByFilters!==void 0?Fn.API.processDataByFilters(Q,pe):{data:Q,reverseChain:[]}).reverseChain+(Array.isArray(Be)?Be.join(" "):Be.toString());if(Jt.data.length!==0&&(rn.push({key:"Length",value:Jt.data.length}),Ve===!0&&rn.push({key:"Length1",value:gt})),Bn.length!=0)if(Bn.split("/").length-1==1)rn.push({key:"Filter",value:Bn});else{rn.push({key:"Filter",value:"["+Bn+"]"});for(var di=0;di<rn.length;di+=1)if(rn[di].key==="DecodeParms"){for(var eo=[],Yi=0;Yi<Jt.reverseChain.split("/").length-1;Yi+=1)eo.push("null");eo.push(rn[di].value),rn[di].value="["+eo.join(" ")+"]"}}ge("<<");for(var Dr=0;Dr<rn.length;Dr++)ge("/"+rn[Dr].key+" "+rn[Dr].value);ge(">>"),Jt.data.length!==0&&(ge("stream"),ge($t(Jt.data)),ge("endstream"))},Ti=T.__private__.putPage=function(C){var Q=C.number,pe=C.data,Be=C.objId,Ve=C.contentsObjId;Yn(Be,!0),ge("<</Type /Page"),ge("/Parent "+C.rootDictionaryObjId+" 0 R"),ge("/Resources "+C.resourceDictionaryObjId+" 0 R"),ge("/MediaBox ["+parseFloat(te(C.mediaBox.bottomLeftX))+" "+parseFloat(te(C.mediaBox.bottomLeftY))+" "+te(C.mediaBox.topRightX)+" "+te(C.mediaBox.topRightY)+"]"),C.cropBox!==null&&ge("/CropBox ["+te(C.cropBox.bottomLeftX)+" "+te(C.cropBox.bottomLeftY)+" "+te(C.cropBox.topRightX)+" "+te(C.cropBox.topRightY)+"]"),C.bleedBox!==null&&ge("/BleedBox ["+te(C.bleedBox.bottomLeftX)+" "+te(C.bleedBox.bottomLeftY)+" "+te(C.bleedBox.topRightX)+" "+te(C.bleedBox.topRightY)+"]"),C.trimBox!==null&&ge("/TrimBox ["+te(C.trimBox.bottomLeftX)+" "+te(C.trimBox.bottomLeftY)+" "+te(C.trimBox.topRightX)+" "+te(C.trimBox.topRightY)+"]"),C.artBox!==null&&ge("/ArtBox ["+te(C.artBox.bottomLeftX)+" "+te(C.artBox.bottomLeftY)+" "+te(C.artBox.topRightX)+" "+te(C.artBox.topRightY)+"]"),typeof C.userUnit=="number"&&C.userUnit!==1&&ge("/UserUnit "+C.userUnit),ti.publish("putPage",{objId:Be,pageContext:pn[Q],pageNumber:Q,page:pe}),ge("/Contents "+Ve+" 0 R"),ge(">>"),ge("endobj");var gt=pe.join(`
`);return U===E&&(gt+=`
Q`),Yn(Ve,!0),Vn({data:gt,filters:Zt(),objectId:Ve}),ge("endobj"),Be},_i=T.__private__.putPages=function(){var C,Q,pe=[];for(C=1;C<=Xt;C++)pn[C].objId=xt(),pn[C].contentsObjId=xt();for(C=1;C<=Xt;C++)pe.push(Ti({number:C,data:Ye[C],objId:pn[C].objId,contentsObjId:pn[C].contentsObjId,mediaBox:pn[C].mediaBox,cropBox:pn[C].cropBox,bleedBox:pn[C].bleedBox,trimBox:pn[C].trimBox,artBox:pn[C].artBox,userUnit:pn[C].userUnit,rootDictionaryObjId:Si,resourceDictionaryObjId:ut}));Yn(Si,!0),ge("<</Type /Pages");var Be="/Kids [";for(Q=0;Q<Xt;Q++)Be+=pe[Q]+" 0 R ";ge(Be+"]"),ge("/Count "+Xt),ge(">>"),ge("endobj"),ti.publish("postPutPages")},mr=function(C){ti.publish("putFont",{font:C,out:ge,newObject:or,putStream:Vn}),C.isAlreadyPutted!==!0&&(C.objectNumber=or(),ge("<<"),ge("/Type /Font"),ge("/BaseFont /"+cf(C.postScriptName)),ge("/Subtype /Type1"),typeof C.encoding=="string"&&ge("/Encoding /"+C.encoding),ge("/FirstChar 32"),ge("/LastChar 255"),ge(">>"),ge("endobj"))},mi=function(C){C.objectNumber=or();var Q=[];Q.push({key:"Type",value:"/XObject"}),Q.push({key:"Subtype",value:"/Form"}),Q.push({key:"BBox",value:"["+[te(C.x),te(C.y),te(C.x+C.width),te(C.y+C.height)].join(" ")+"]"}),Q.push({key:"Matrix",value:"["+C.matrix.toString()+"]"});var pe=C.pages[1].join(`
`);Vn({data:pe,additionalKeyValues:Q,objectId:C.objectNumber}),ge("endobj")},pr=function(C,Q){Q||(Q=21);var pe=or(),Be=(function(mt,$t){var Jt,rn=[],Bn=1/($t-1);for(Jt=0;Jt<1;Jt+=Bn)rn.push(Jt);if(rn.push(1),mt[0].offset!=0){var di={offset:0,color:mt[0].color};mt.unshift(di)}if(mt[mt.length-1].offset!=1){var eo={offset:1,color:mt[mt.length-1].color};mt.push(eo)}for(var Yi="",Dr=0,Rr=0;Rr<rn.length;Rr++){for(Jt=rn[Rr];Jt>mt[Dr+1].offset;)Dr++;var Ao=mt[Dr].offset,ar=(Jt-Ao)/(mt[Dr+1].offset-Ao),da=mt[Dr].color,Lr=mt[Dr+1].color;Yi+=ue(Math.round((1-ar)*da[0]+ar*Lr[0]).toString(16))+ue(Math.round((1-ar)*da[1]+ar*Lr[1]).toString(16))+ue(Math.round((1-ar)*da[2]+ar*Lr[2]).toString(16))}return Yi.trim()})(C.colors,Q),Ve=[];Ve.push({key:"FunctionType",value:"0"}),Ve.push({key:"Domain",value:"[0.0 1.0]"}),Ve.push({key:"Size",value:"["+Q+"]"}),Ve.push({key:"BitsPerSample",value:"8"}),Ve.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ve.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Vn({data:Be,additionalKeyValues:Ve,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:pe}),ge("endobj"),C.objectNumber=or(),ge("<< /ShadingType "+C.type),ge("/ColorSpace /DeviceRGB");var gt="/Coords ["+te(parseFloat(C.coords[0]))+" "+te(parseFloat(C.coords[1]))+" ";C.type===2?gt+=te(parseFloat(C.coords[2]))+" "+te(parseFloat(C.coords[3])):gt+=te(parseFloat(C.coords[2]))+" "+te(parseFloat(C.coords[3]))+" "+te(parseFloat(C.coords[4]))+" "+te(parseFloat(C.coords[5])),ge(gt+="]"),C.matrix&&ge("/Matrix ["+C.matrix.toString()+"]"),ge("/Function "+pe+" 0 R"),ge("/Extend [true true]"),ge(">>"),ge("endobj")},Ci=function(C,Q){var pe=xt(),Be=or();Q.push({resourcesOid:pe,objectOid:Be}),C.objectNumber=Be;var Ve=[];Ve.push({key:"Type",value:"/Pattern"}),Ve.push({key:"PatternType",value:"1"}),Ve.push({key:"PaintType",value:"1"}),Ve.push({key:"TilingType",value:"1"}),Ve.push({key:"BBox",value:"["+C.boundingBox.map(te).join(" ")+"]"}),Ve.push({key:"XStep",value:te(C.xStep)}),Ve.push({key:"YStep",value:te(C.yStep)}),Ve.push({key:"Resources",value:pe+" 0 R"}),C.matrix&&Ve.push({key:"Matrix",value:"["+C.matrix.toString()+"]"}),Vn({data:C.stream,additionalKeyValues:Ve,objectId:C.objectNumber}),ge("endobj")},_n=function(C){for(var Q in C.objectNumber=or(),ge("<<"),C)switch(Q){case"opacity":ge("/ca "+Y(C[Q]));break;case"stroke-opacity":ge("/CA "+Y(C[Q]))}ge(">>"),ge("endobj")},ko=function(C){Yn(C.resourcesOid,!0),ge("<<"),ge("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var Q in ge("/Font <<"),st)st.hasOwnProperty(Q)&&(_===!1||_===!0&&M.hasOwnProperty(Q))&&ge("/"+Q+" "+st[Q].objectNumber+" 0 R");ge(">>")})(),(function(){if(Object.keys(Rt).length>0){for(var Q in ge("/Shading <<"),Rt)Rt.hasOwnProperty(Q)&&Rt[Q]instanceof gd&&Rt[Q].objectNumber>=0&&ge("/"+Q+" "+Rt[Q].objectNumber+" 0 R");ti.publish("putShadingPatternDict"),ge(">>")}})(),(function(Q){if(Object.keys(Rt).length>0){for(var pe in ge("/Pattern <<"),Rt)Rt.hasOwnProperty(pe)&&Rt[pe]instanceof T.TilingPattern&&Rt[pe].objectNumber>=0&&Rt[pe].objectNumber<Q&&ge("/"+pe+" "+Rt[pe].objectNumber+" 0 R");ti.publish("putTilingPatternDict"),ge(">>")}})(C.objectOid),(function(){if(Object.keys(zt).length>0){var Q;for(Q in ge("/ExtGState <<"),zt)zt.hasOwnProperty(Q)&&zt[Q].objectNumber>=0&&ge("/"+Q+" "+zt[Q].objectNumber+" 0 R");ti.publish("putGStateDict"),ge(">>")}})(),(function(){for(var Q in ge("/XObject <<"),zn)zn.hasOwnProperty(Q)&&zn[Q].objectNumber>=0&&ge("/"+Q+" "+zn[Q].objectNumber+" 0 R");ti.publish("putXobjectDict"),ge(">>")})(),ge(">>"),ge("endobj")},qn=function(C){et[C.fontName]=et[C.fontName]||{},et[C.fontName][C.fontStyle]=C.id},us=function(C,Q,pe,Be,Ve){var gt={id:"F"+(Object.keys(st).length+1).toString(10),postScriptName:C,fontName:Q,fontStyle:pe,encoding:Be,isStandardFont:Ve||!1,metadata:{}};return ti.publish("addFont",{font:gt,instance:this}),st[gt.id]=gt,qn(gt),gt.id},gi=T.__private__.pdfEscape=T.pdfEscape=function(C,Q){return(function(pe,Be){var Ve,gt,mt,$t,Jt,rn,Bn,di,eo;if(mt=(Be=Be||{}).sourceEncoding||"Unicode",Jt=Be.outputEncoding,(Be.autoencode||Jt)&&st[an].metadata&&st[an].metadata[mt]&&st[an].metadata[mt].encoding&&($t=st[an].metadata[mt].encoding,!Jt&&st[an].encoding&&(Jt=st[an].encoding),!Jt&&$t.codePages&&(Jt=$t.codePages[0]),typeof Jt=="string"&&(Jt=$t[Jt]),Jt)){for(Bn=!1,rn=[],Ve=0,gt=pe.length;Ve<gt;Ve++)(di=Jt[pe.charCodeAt(Ve)])?rn.push(String.fromCharCode(di)):rn.push(pe[Ve]),rn[Ve].charCodeAt(0)>>8&&(Bn=!0);pe=rn.join("")}for(Ve=pe.length;Bn===void 0&&Ve!==0;)pe.charCodeAt(Ve-1)>>8&&(Bn=!0),Ve--;if(!Bn)return pe;for(rn=Be.noBOM?[]:[254,255],Ve=0,gt=pe.length;Ve<gt;Ve++){if((eo=(di=pe.charCodeAt(Ve))>>8)>>8)throw new Error("Character at position "+Ve+" of string '"+pe+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");rn.push(eo),rn.push(di-(eo<<8))}return String.fromCharCode.apply(void 0,rn)})(C,Q).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Mo=T.__private__.beginPage=function(C){Ye[++Xt]=[],pn[Xt]={objId:0,contentsObjId:0,userUnit:Number(p),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(C[0]),topRightY:Number(C[1])}},Ka(Xt),Wt(Ye[V])},Ei=function(C,Q){var pe,Be,Ve;switch(o=Q||o,typeof C=="string"&&(pe=y(C.toLowerCase()),Array.isArray(pe)&&(Be=pe[0],Ve=pe[1])),Array.isArray(C)&&(Be=C[0]*dt,Ve=C[1]*dt),isNaN(Be)&&(Be=l[0],Ve=l[1]),(Be>14400||Ve>14400)&&(co.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Be=Math.min(14400,Be),Ve=Math.min(14400,Ve)),l=[Be,Ve],o.substr(0,1)){case"l":Ve>Be&&(l=[Ve,Be]);break;case"p":Be>Ve&&(l=[Ve,Be])}Mo(l),kn(Oa),ge(Oo),Cn!==0&&ge(Cn+" J"),Zo!==0&&ge(Zo+" j"),ti.publish("addPage",{pageNumber:Xt})},zs=function(C){C>0&&C<=Xt&&(Ye.splice(C,1),pn.splice(C,1),Xt--,V>Xt&&(V=Xt),this.setPage(V))},Ka=function(C){C>0&&C<=Xt&&(V=C)},Za=T.__private__.getNumberOfPages=T.getNumberOfPages=function(){return Ye.length-1},ds=function(C,Q,pe){var Be,Ve=void 0;return pe=pe||{},C=C!==void 0?C:st[an].fontName,Q=Q!==void 0?Q:st[an].fontStyle,Be=C.toLowerCase(),et[Be]!==void 0&&et[Be][Q]!==void 0?Ve=et[Be][Q]:et[C]!==void 0&&et[C][Q]!==void 0?Ve=et[C][Q]:pe.disableWarning===!1&&co.warn("Unable to look up font label for font '"+C+"', '"+Q+"'. Refer to getFontList() for available fonts."),Ve||pe.noFallback||(Ve=et.times[Q])==null&&(Ve=et.times.normal),Ve},Ur=T.__private__.putInfo=function(){var C=or(),Q=function(Be){return Be};for(var pe in j!==null&&(Q=uo.encryptor(C,0)),ge("<<"),ge("/Producer ("+gi(Q("jsPDF "+Fn.version))+")"),Gt)Gt.hasOwnProperty(pe)&&Gt[pe]&&ge("/"+pe.substr(0,1).toUpperCase()+pe.substr(1)+" ("+gi(Q(Gt[pe]))+")");ge("/CreationDate ("+gi(Q(je))+")"),ge(">>"),ge("endobj")},Ws=T.__private__.putCatalog=function(C){var Q=(C=C||{}).rootDictionaryObjId||Si;switch(or(),ge("<<"),ge("/Type /Catalog"),ge("/Pages "+Q+" 0 R"),fn||(fn="fullwidth"),fn){case"fullwidth":ge("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ge("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ge("/OpenAction [3 0 R /Fit]");break;case"original":ge("/OpenAction [3 0 R /XYZ null null 1]");break;default:var pe=""+fn;pe.substr(pe.length-1)==="%"&&(fn=parseInt(fn)/100),typeof fn=="number"&&ge("/OpenAction [3 0 R /XYZ null null "+Y(fn)+"]")}switch(mn||(mn="continuous"),mn){case"continuous":ge("/PageLayout /OneColumn");break;case"single":ge("/PageLayout /SinglePage");break;case"two":case"twoleft":ge("/PageLayout /TwoColumnLeft");break;case"tworight":ge("/PageLayout /TwoColumnRight")}cn&&ge("/PageMode /"+cn),ti.publish("putCatalog"),ge(">>"),ge("endobj")},_r=T.__private__.putTrailer=function(){ge("trailer"),ge("<<"),ge("/Size "+(ve+1)),ge("/Root "+ve+" 0 R"),ge("/Info "+(ve-1)+" 0 R"),j!==null&&ge("/Encrypt "+uo.oid+" 0 R"),ge("/ID [ <"+ee+"> <"+ee+"> ]"),ge(">>")},$i=T.__private__.putHeader=function(){ge("%PDF-"+F),ge("%")},yi=T.__private__.putXRef=function(){var C="0000000000";ge("xref"),ge("0 "+(ve+1)),ge("0000000000 65535 f ");for(var Q=1;Q<=ve;Q++)typeof se[Q]=="function"?ge((C+se[Q]()).slice(-10)+" 00000 n "):se[Q]!==void 0?ge((C+se[Q]).slice(-10)+" 00000 n "):ge("0000000000 00000 n ")},Tr=T.__private__.buildDocument=function(){var C;ve=0,xe=0,ze=[],se=[],De=[],Si=xt(),ut=xt(),Wt(ze),ti.publish("buildDocument"),$i(),_i(),(function(){ti.publish("putAdditionalObjects");for(var pe=0;pe<De.length;pe++){var Be=De[pe];Yn(Be.objId,!0),ge(Be.content),ge("endobj")}ti.publish("postPutAdditionalObjects")})(),C=[],(function(){for(var pe in st)st.hasOwnProperty(pe)&&(_===!1||_===!0&&M.hasOwnProperty(pe))&&mr(st[pe])})(),(function(){var pe;for(pe in zt)zt.hasOwnProperty(pe)&&_n(zt[pe])})(),(function(){for(var pe in zn)zn.hasOwnProperty(pe)&&mi(zn[pe])})(),(function(pe){var Be;for(Be in Rt)Rt.hasOwnProperty(Be)&&(Rt[Be]instanceof gd?pr(Rt[Be]):Rt[Be]instanceof uf&&Ci(Rt[Be],pe))})(C),ti.publish("putResources"),C.forEach(ko),ko({resourcesOid:ut,objectOid:Number.MAX_SAFE_INTEGER}),ti.publish("postPutResources"),j!==null&&(uo.oid=or(),ge("<<"),ge("/Filter /Standard"),ge("/V "+uo.v),ge("/R "+uo.r),ge("/U <"+uo.toHexString(uo.U)+">"),ge("/O <"+uo.toHexString(uo.O)+">"),ge("/P "+uo.P),ge(">>"),ge("endobj")),Ur(),Ws();var Q=xe;return yi(),_r(),ge("startxref"),ge(""+Q),ge("%%EOF"),Wt(Ye[V]),ze.join(`
`)},Ja=T.__private__.getBlob=function(C){return new Blob([_t(C)],{type:"application/pdf"})},Yl=T.output=T.__private__.output=(zr=function(C,Q){switch(typeof(Q=Q||{})=="string"?Q={filename:Q}:Q.filename=Q.filename||"generated.pdf",C){case void 0:return Tr();case"save":T.save(Q.filename);break;case"arraybuffer":return _t(Tr());case"blob":return Ja(Tr());case"bloburi":case"bloburl":if(pi.URL!==void 0&&typeof pi.URL.createObjectURL=="function")return pi.URL&&pi.URL.createObjectURL(Ja(Tr()))||void 0;co.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var pe="",Be=Tr();try{pe=ky(Be)}catch{pe=ky(unescape(encodeURIComponent(Be)))}return"data:application/pdf;filename="+Q.filename+";base64,"+pe;case"pdfobjectnewwindow":if(Object.prototype.toString.call(pi)==="[object Window]"){var Ve="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",gt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Q.pdfObjectUrl&&(Ve=Q.pdfObjectUrl,gt="");var mt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ve+'"'+gt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Q)+");<\/script></body></html>",$t=pi.open();return $t!==null&&$t.document.write(mt),$t}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(pi)==="[object Window]"){var Jt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Q.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Q.filename+'" width="500px" height="400px" /></body></html>',rn=pi.open();if(rn!==null){rn.document.write(Jt);var Bn=this;rn.document.documentElement.querySelector("#pdfViewer").onload=function(){rn.document.title=Q.filename,rn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Bn.output("bloburl"))}}return rn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(pi)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var di='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Q)+'"></iframe></body></html>',eo=pi.open();if(eo!==null&&(eo.document.write(di),eo.document.title=Q.filename),eo||typeof safari>"u")return eo;break;case"datauri":case"dataurl":return pi.document.location.href=this.output("datauristring",Q);default:return null}},zr.foo=function(){try{return zr.apply(this,arguments)}catch(pe){var C=pe.stack||"";~C.indexOf(" at ")&&(C=C.split(" at ")[1]);var Q="Error in function "+C.split(`
`)[0].split("<")[0]+": "+pe.message;if(!pi.console)throw new Error(Q);pi.console.error(Q,pe),pi.alert&&alert(Q)}},zr.foo.bar=zr,zr.foo),xo=function(C){return Array.isArray(Go)===!0&&Go.indexOf(C)>-1};switch(s){case"pt":dt=1;break;case"mm":dt=72/25.4;break;case"cm":dt=72/2.54;break;case"in":dt=72;break;case"px":dt=xo("px_scaling")==1?.75:96/72;break;case"pc":case"em":dt=12;break;case"ex":dt=6;break;default:if(typeof s!="number")throw new Error("Invalid unit: "+s);dt=s}var uo=null;q(),Ne();var Qi=T.__private__.getPageInfo=T.getPageInfo=function(C){if(isNaN(C)||C%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:pn[C].objId,pageNumber:C,pageContext:pn[C]}},Xo=T.__private__.getPageInfoByObjId=function(C){if(isNaN(C)||C%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Q in pn)if(pn[Q].objId===C)break;return Qi(Q)},Gl=T.__private__.getCurrentPageInfo=T.getCurrentPageInfo=function(){return{objId:pn[V].objId,pageNumber:V,pageContext:pn[V]}};T.addPage=function(){return Ei.apply(this,arguments),this},T.setPage=function(){return Ka.apply(this,arguments),Wt.call(this,Ye[V]),this},T.insertPage=function(C){return this.addPage(),this.movePage(V,C),this},T.movePage=function(C,Q){var pe,Be;if(C>Q){pe=Ye[C],Be=pn[C];for(var Ve=C;Ve>Q;Ve--)Ye[Ve]=Ye[Ve-1],pn[Ve]=pn[Ve-1];Ye[Q]=pe,pn[Q]=Be,this.setPage(Q)}else if(C<Q){pe=Ye[C],Be=pn[C];for(var gt=C;gt<Q;gt++)Ye[gt]=Ye[gt+1],pn[gt]=pn[gt+1];Ye[Q]=pe,pn[Q]=Be,this.setPage(Q)}return this},T.deletePage=function(){return zs.apply(this,arguments),this},T.__private__.text=T.text=function(C,Q,pe,Be,Ve){var gt,mt,$t,Jt,rn,Bn,di,eo,Yi,Dr=(Be=Be||{}).scope||this;if(typeof C=="number"&&typeof Q=="number"&&(typeof pe=="string"||Array.isArray(pe))){var Rr=pe;pe=Q,Q=C,C=Rr}if(arguments[3]instanceof nn==0?($t=arguments[4],Jt=arguments[5],Hr(di=arguments[3])==="object"&&di!==null||(typeof $t=="string"&&(Jt=$t,$t=null),typeof di=="string"&&(Jt=di,di=null),typeof di=="number"&&($t=di,di=null),Be={flags:di,angle:$t,align:Jt})):(O("The transform parameter of text() with a Matrix value"),Yi=Ve),isNaN(Q)||isNaN(pe)||C==null)throw new Error("Invalid arguments passed to jsPDF.text");if(C.length===0)return Dr;var Ao,ar="",da=typeof Be.lineHeightFactor=="number"?Be.lineHeightFactor:ps,Lr=Dr.internal.scaleFactor;function fa(Vi){return Vi=Vi.split("	").join(Array(Be.TabLen||9).join(" ")),gi(Vi,di)}function pa(Vi){for(var Xi,gr=Vi.concat(),vo=[],rs=gr.length;rs--;)typeof(Xi=gr.shift())=="string"?vo.push(Xi):Array.isArray(Vi)&&(Xi.length===1||Xi[1]===void 0&&Xi[2]===void 0)?vo.push(Xi[0]):vo.push([Xi[0],Xi[1],Xi[2]]);return vo}function ys(Vi,Xi){var gr;if(typeof Vi=="string")gr=Xi(Vi)[0];else if(Array.isArray(Vi)){for(var vo,rs,Zs=Vi.concat(),fc=[],ru=Zs.length;ru--;)typeof(vo=Zs.shift())=="string"?fc.push(Xi(vo)[0]):Array.isArray(vo)&&typeof vo[0]=="string"&&(rs=Xi(vo[0],vo[1],vo[2]),fc.push([rs[0],rs[1],rs[2]]));gr=fc}return gr}var Jo=!1,Pa=!0;if(typeof C=="string")Jo=!0;else if(Array.isArray(C)){var po=C.concat();mt=[];for(var ha,er=po.length;er--;)(typeof(ha=po.shift())!="string"||Array.isArray(ha)&&typeof ha[0]!="string")&&(Pa=!1);Jo=Pa}if(Jo===!1)throw new Error('Type of text must be string or Array. "'+C+'" is not recognized.');typeof C=="string"&&(C=C.match(/[\r?\n]/)?C.split(/\r\n|\r|\n/g):[C]);var za=ht/Dr.internal.scaleFactor,mo=za*(da-1);switch(Be.baseline){case"bottom":pe-=mo;break;case"top":pe+=za-mo;break;case"hanging":pe+=za-2*mo;break;case"middle":pe+=za/2-mo}if((Bn=Be.maxWidth||0)>0&&(typeof C=="string"?C=Dr.splitTextToSize(C,Bn):Object.prototype.toString.call(C)==="[object Array]"&&(C=C.reduce(function(Vi,Xi){return Vi.concat(Dr.splitTextToSize(Xi,Bn))},[]))),gt={text:C,x:Q,y:pe,options:Be,mutex:{pdfEscape:gi,activeFontKey:an,fonts:st,activeFontSize:ht}},ti.publish("preProcessText",gt),C=gt.text,$t=(Be=gt.options).angle,Yi instanceof nn==0&&$t&&typeof $t=="number"){$t*=Math.PI/180,Be.rotationDirection===0&&($t=-$t),U===E&&($t=-$t);var es=Math.cos($t),tr=Math.sin($t);Yi=new nn(es,tr,-tr,es,0,0)}else $t&&$t instanceof nn&&(Yi=$t);U!==E||Yi||(Yi=hi),(rn=Be.charSpace||hn)!==void 0&&(ar+=te(J(rn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(eo=Be.horizontalScale)!==void 0&&(ar+=te(100*eo)+` Tz
`),Be.lang;var to=-1,Tl=Be.renderingMode!==void 0?Be.renderingMode:Be.stroke,zc=Dr.internal.getCurrentPageInfo().pageContext;switch(Tl){case 0:case!1:case"fill":to=0;break;case 1:case!0:case"stroke":to=1;break;case 2:case"fillThenStroke":to=2;break;case 3:case"invisible":to=3;break;case 4:case"fillAndAddForClipping":to=4;break;case 5:case"strokeAndAddPathForClipping":to=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":to=6;break;case 7:case"addToPathForClipping":to=7}var _s=zc.usedRenderingMode!==void 0?zc.usedRenderingMode:-1;to!==-1?ar+=to+` Tr
`:_s!==-1&&(ar+=`0 Tr
`),to!==-1&&(zc.usedRenderingMode=to),Jt=Be.align||"left";var _a,ts=ht*da,Gs=Dr.internal.pageSize.getWidth(),Po=st[an];rn=Be.charSpace||hn,Bn=Be.maxWidth||0,di=Object.assign({autoencode:!0,noBOM:!0},Be.flags);var ns=[],ho=function(Vi){return Dr.getStringUnitWidth(Vi,{font:Po,charSpace:rn,fontSize:ht,doKerning:!1})*ht/Lr};if(Object.prototype.toString.call(C)==="[object Array]"){var Fo;mt=pa(C),Jt!=="left"&&(_a=mt.map(ho));var $r,Ds=0;if(Jt==="right"){Q-=_a[0],C=[],er=mt.length;for(var Qo=0;Qo<er;Qo++)Qo===0?($r=ua(Q),Fo=wn(pe)):($r=J(Ds-_a[Qo]),Fo=-ts),C.push([mt[Qo],$r,Fo]),Ds=_a[Qo]}else if(Jt==="center"){Q-=_a[0]/2,C=[],er=mt.length;for(var Xs=0;Xs<er;Xs++)Xs===0?($r=ua(Q),Fo=wn(pe)):($r=J((Ds-_a[Xs])/2),Fo=-ts),C.push([mt[Xs],$r,Fo]),Ds=_a[Xs]}else if(Jt==="left"){C=[],er=mt.length;for(var Va=0;Va<er;Va++)C.push(mt[Va])}else if(Jt==="justify"&&Po.encoding==="Identity-H"){C=[],er=mt.length,Bn=Bn!==0?Bn:Gs;for(var Kl=0,Zn=0;Zn<er;Zn++)if(Fo=Zn===0?wn(pe):-ts,$r=Zn===0?ua(Q):Kl,Zn<er-1){var xs=J((Bn-_a[Zn])/(mt[Zn].split(" ").length-1)),Gi=mt[Zn].split(" ");C.push([Gi[0]+" ",$r,Fo]),Kl=0;for(var ea=1;ea<Gi.length;ea++){var Uo=(ho(Gi[ea-1]+" "+Gi[ea])-ho(Gi[ea]))*Lr+xs;ea==Gi.length-1?C.push([Gi[ea],Uo,0]):C.push([Gi[ea]+" ",Uo,0]),Kl-=Uo}}else C.push([mt[Zn],$r,Fo]);C.push(["",Kl,0])}else{if(Jt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(C=[],er=mt.length,Bn=Bn!==0?Bn:Gs,Zn=0;Zn<er;Zn++){Fo=Zn===0?wn(pe):-ts,$r=Zn===0?ua(Q):0;var ga=mt[Zn].split(" ").length-1,_c=ga>0?(Bn-_a[Zn])/ga:0;Zn<er-1?ns.push(te(J(_c))):ns.push(0),C.push([mt[Zn],$r,Fo])}}}(typeof Be.R2L=="boolean"?Be.R2L:ln)===!0&&(C=ys(C,function(Vi,Xi,gr){return[Vi.split("").reverse().join(""),Xi,gr]})),gt={text:C,x:Q,y:pe,options:Be,mutex:{pdfEscape:gi,activeFontKey:an,fonts:st,activeFontSize:ht}},ti.publish("postProcessText",gt),C=gt.text,Ao=gt.mutex.isHex||!1;var Ks=st[an].encoding;Ks!=="WinAnsiEncoding"&&Ks!=="StandardEncoding"||(C=ys(C,function(Vi,Xi,gr){return[fa(Vi),Xi,gr]})),mt=pa(C),C=[];for(var Cl,jl,bo,Nl=Array.isArray(mt[0])?1:0,Eo="",qa=function(Vi,Xi,gr){var vo="";return gr instanceof nn?(gr=typeof Be.angle=="number"?xi(gr,new nn(1,0,0,1,Vi,Xi)):xi(new nn(1,0,0,1,Vi,Xi),gr),U===E&&(gr=xi(new nn(1,0,0,-1,0,0),gr)),vo=gr.join(" ")+` Tm
`):vo=te(Vi)+" "+te(Xi)+` Td
`,vo},hr=0;hr<mt.length;hr++){switch(Eo="",Nl){case 1:bo=(Ao?"<":"(")+mt[hr][0]+(Ao?">":")"),Cl=parseFloat(mt[hr][1]),jl=parseFloat(mt[hr][2]);break;case 0:bo=(Ao?"<":"(")+mt[hr]+(Ao?">":")"),Cl=ua(Q),jl=wn(pe)}ns!==void 0&&ns[hr]!==void 0&&(Eo=ns[hr]+` Tw
`),hr===0?C.push(Eo+qa(Cl,jl,Yi)+bo):Nl===0?C.push(Eo+bo):Nl===1&&C.push(Eo+qa(Cl,jl,Yi)+bo)}C=Nl===0?C.join(` Tj
T* `):C.join(` Tj
`),C+=` Tj
`;var is=`BT
/`;return is+=an+" "+ht+` Tf
`,is+=te(ht*da)+` TL
`,is+=yn+`
`,is+=ar,is+=C,ge(is+="ET"),M[an]=!0,Dr};var ca=T.__private__.clip=T.clip=function(C){return ge(C==="evenodd"?"W*":"W"),this};T.clipEvenOdd=function(){return ca("evenodd")},T.__private__.discardPath=T.discardPath=function(){return ge("n"),this};var Cr=T.__private__.isValidStyle=function(C){var Q=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(C)!==-1&&(Q=!0),Q};T.__private__.setDefaultPathOperation=T.setDefaultPathOperation=function(C){return Cr(C)&&(m=C),this};var Xl=T.__private__.getStyle=T.getStyle=function(C){var Q=m;switch(C){case"D":case"S":Q="S";break;case"F":Q="f";break;case"FD":case"DF":Q="B";break;case"f":case"f*":case"B":case"B*":Q=C}return Q},Wr=T.close=function(){return ge("h"),this};T.stroke=function(){return ge("S"),this},T.fill=function(C){return Di("f",C),this},T.fillEvenOdd=function(C){return Di("f*",C),this},T.fillStroke=function(C){return Di("B",C),this},T.fillStrokeEvenOdd=function(C){return Di("B*",C),this};var Di=function(C,Q){Hr(Q)==="object"?Bo(Q,C):ge(C)},cl=function(C){C===null||U===E&&C===void 0||(C=Xl(C),ge(C))};function Ba(C,Q,pe,Be,Ve){var gt=new uf(Q||this.boundingBox,pe||this.xStep,Be||this.yStep,this.gState,Ve||this.matrix);gt.stream=this.stream;var mt=C+"$$"+this.cloneIndex+++"$$";return fr(mt,gt),gt}var Bo=function(C,Q){var pe=Ge[C.key],Be=Rt[pe];if(Be instanceof gd)ge("q"),ge(fs(Q)),Be.gState&&T.setGState(Be.gState),ge(C.matrix.toString()+" cm"),ge("/"+pe+" sh"),ge("Q");else if(Be instanceof uf){var Ve=new nn(1,0,0,-1,0,gs());C.matrix&&(Ve=Ve.multiply(C.matrix||hi),pe=Ba.call(Be,C.key,C.boundingBox,C.xStep,C.yStep,Ve).id),ge("q"),ge("/Pattern cs"),ge("/"+pe+" scn"),Be.gState&&T.setGState(Be.gState),ge(Q),ge("Q")}},fs=function(C){switch(C){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},ka=T.moveTo=function(C,Q){return ge(te(J(C))+" "+te($(Q))+" m"),this},Ko=T.lineTo=function(C,Q){return ge(te(J(C))+" "+te($(Q))+" l"),this},Qr=T.curveTo=function(C,Q,pe,Be,Ve,gt){return ge([te(J(C)),te($(Q)),te(J(pe)),te($(Be)),te(J(Ve)),te($(gt)),"c"].join(" ")),this};T.__private__.line=T.line=function(C,Q,pe,Be,Ve){if(isNaN(C)||isNaN(Q)||isNaN(pe)||isNaN(Be)||!Cr(Ve))throw new Error("Invalid arguments passed to jsPDF.line");return U===ae?this.lines([[pe-C,Be-Q]],C,Q,[1,1],Ve||"S"):this.lines([[pe-C,Be-Q]],C,Q,[1,1]).stroke()},T.__private__.lines=T.lines=function(C,Q,pe,Be,Ve,gt){var mt,$t,Jt,rn,Bn,di,eo,Yi,Dr,Rr,Ao,ar;if(typeof C=="number"&&(ar=pe,pe=Q,Q=C,C=ar),Be=Be||[1,1],gt=gt||!1,isNaN(Q)||isNaN(pe)||!Array.isArray(C)||!Array.isArray(Be)||!Cr(Ve)||typeof gt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(ka(Q,pe),mt=Be[0],$t=Be[1],rn=C.length,Rr=Q,Ao=pe,Jt=0;Jt<rn;Jt++)(Bn=C[Jt]).length===2?(Rr=Bn[0]*mt+Rr,Ao=Bn[1]*$t+Ao,Ko(Rr,Ao)):(di=Bn[0]*mt+Rr,eo=Bn[1]*$t+Ao,Yi=Bn[2]*mt+Rr,Dr=Bn[3]*$t+Ao,Rr=Bn[4]*mt+Rr,Ao=Bn[5]*$t+Ao,Qr(di,eo,Yi,Dr,Rr,Ao));return gt&&Wr(),cl(Ve),this},T.path=function(C){for(var Q=0;Q<C.length;Q++){var pe=C[Q],Be=pe.c;switch(pe.op){case"m":ka(Be[0],Be[1]);break;case"l":Ko(Be[0],Be[1]);break;case"c":Qr.apply(this,Be);break;case"h":Wr()}}return this},T.__private__.rect=T.rect=function(C,Q,pe,Be,Ve){if(isNaN(C)||isNaN(Q)||isNaN(pe)||isNaN(Be)||!Cr(Ve))throw new Error("Invalid arguments passed to jsPDF.rect");return U===ae&&(Be=-Be),ge([te(J(C)),te($(Q)),te(J(pe)),te(J(Be)),"re"].join(" ")),cl(Ve),this},T.__private__.triangle=T.triangle=function(C,Q,pe,Be,Ve,gt,mt){if(isNaN(C)||isNaN(Q)||isNaN(pe)||isNaN(Be)||isNaN(Ve)||isNaN(gt)||!Cr(mt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[pe-C,Be-Q],[Ve-pe,gt-Be],[C-Ve,Q-gt]],C,Q,[1,1],mt,!0),this},T.__private__.roundedRect=T.roundedRect=function(C,Q,pe,Be,Ve,gt,mt){if(isNaN(C)||isNaN(Q)||isNaN(pe)||isNaN(Be)||isNaN(Ve)||isNaN(gt)||!Cr(mt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var $t=4/3*(Math.SQRT2-1);return Ve=Math.min(Ve,.5*pe),gt=Math.min(gt,.5*Be),this.lines([[pe-2*Ve,0],[Ve*$t,0,Ve,gt-gt*$t,Ve,gt],[0,Be-2*gt],[0,gt*$t,-Ve*$t,gt,-Ve,gt],[2*Ve-pe,0],[-Ve*$t,0,-Ve,-gt*$t,-Ve,-gt],[0,2*gt-Be],[0,-gt*$t,Ve*$t,-gt,Ve,-gt]],C+Ve,Q,[1,1],mt,!0),this},T.__private__.ellipse=T.ellipse=function(C,Q,pe,Be,Ve){if(isNaN(C)||isNaN(Q)||isNaN(pe)||isNaN(Be)||!Cr(Ve))throw new Error("Invalid arguments passed to jsPDF.ellipse");var gt=4/3*(Math.SQRT2-1)*pe,mt=4/3*(Math.SQRT2-1)*Be;return ka(C+pe,Q),Qr(C+pe,Q-mt,C+gt,Q-Be,C,Q-Be),Qr(C-gt,Q-Be,C-pe,Q-mt,C-pe,Q),Qr(C-pe,Q+mt,C-gt,Q+Be,C,Q+Be),Qr(C+gt,Q+Be,C+pe,Q+mt,C+pe,Q),cl(Ve),this},T.__private__.circle=T.circle=function(C,Q,pe,Be){if(isNaN(C)||isNaN(Q)||isNaN(pe)||!Cr(Be))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(C,Q,pe,pe,Be)},T.setFont=function(C,Q,pe){return pe&&(Q=G(Q,pe)),an=ds(C,Q,{disableWarning:!1}),this};var jr=T.__private__.getFont=T.getFont=function(){return st[ds.apply(T,arguments)]};T.__private__.getFontList=T.getFontList=function(){var C,Q,pe={};for(C in et)if(et.hasOwnProperty(C))for(Q in pe[C]=[],et[C])et[C].hasOwnProperty(Q)&&pe[C].push(Q);return pe},T.addFont=function(C,Q,pe,Be,Ve){var gt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&gt.indexOf(arguments[3])!==-1?Ve=arguments[3]:arguments[3]&&gt.indexOf(arguments[3])==-1&&(pe=G(pe,Be)),us.call(this,C,Q,pe,Ve=Ve||"Identity-H")};var ps,Oa=n.lineWidth||.200025,$s=T.__private__.getLineWidth=T.getLineWidth=function(){return Oa},kn=T.__private__.setLineWidth=T.setLineWidth=function(C){return Oa=C,ge(te(J(C))+" w"),this};T.__private__.setLineDash=Fn.API.setLineDash=Fn.API.setLineDashPattern=function(C,Q){if(C=C||[],Q=Q||0,isNaN(Q)||!Array.isArray(C))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return C=C.map(function(pe){return te(J(pe))}).join(" "),Q=te(J(Q)),ge("["+C+"] "+Q+" d"),this};var Ct=T.__private__.getLineHeight=T.getLineHeight=function(){return ht*ps};T.__private__.getLineHeight=T.getLineHeight=function(){return ht*ps};var Kn=T.__private__.setLineHeightFactor=T.setLineHeightFactor=function(C){return typeof(C=C||1.15)=="number"&&(ps=C),this},Fa=T.__private__.getLineHeightFactor=T.getLineHeightFactor=function(){return ps};Kn(n.lineHeight);var ua=T.__private__.getHorizontalCoordinate=function(C){return J(C)},wn=T.__private__.getVerticalCoordinate=function(C){return U===E?C:pn[V].mediaBox.topRightY-pn[V].mediaBox.bottomLeftY-J(C)},Tn=T.__private__.getHorizontalCoordinateString=T.getHorizontalCoordinateString=function(C){return te(ua(C))},ul=T.__private__.getVerticalCoordinateString=T.getVerticalCoordinateString=function(C){return te(wn(C))},Oo=n.strokeColor||"0 G";T.__private__.getStrokeColor=T.getDrawColor=function(){return Et(Oo)},T.__private__.setStrokeColor=T.setDrawColor=function(C,Q,pe,Be){return Oo=En({ch1:C,ch2:Q,ch3:pe,ch4:Be,pdfColorType:"draw",precision:2}),ge(Oo),this};var Mn=n.fillColor||"0 g";T.__private__.getFillColor=T.getFillColor=function(){return Et(Mn)},T.__private__.setFillColor=T.setFillColor=function(C,Q,pe,Be){return Mn=En({ch1:C,ch2:Q,ch3:pe,ch4:Be,pdfColorType:"fill",precision:2}),ge(Mn),this};var yn=n.textColor||"0 g",Ri=T.__private__.getTextColor=T.getTextColor=function(){return Et(yn)};T.__private__.setTextColor=T.setTextColor=function(C,Q,pe,Be){return yn=En({ch1:C,ch2:Q,ch3:pe,ch4:Be,pdfColorType:"text",precision:3}),this};var hn=n.charSpace,ji=T.__private__.getCharSpace=T.getCharSpace=function(){return parseFloat(hn||0)};T.__private__.setCharSpace=T.setCharSpace=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return hn=C,this};var Cn=0;T.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},T.__private__.setLineCap=T.setLineCap=function(C){var Q=T.CapJoinStyles[C];if(Q===void 0)throw new Error("Line cap style of '"+C+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Cn=Q,ge(Q+" J"),this};var Zo=0;T.__private__.setLineJoin=T.setLineJoin=function(C){var Q=T.CapJoinStyles[C];if(Q===void 0)throw new Error("Line join style of '"+C+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Zo=Q,ge(Q+" j"),this},T.__private__.setLineMiterLimit=T.__private__.setMiterLimit=T.setLineMiterLimit=T.setMiterLimit=function(C){if(C=C||0,isNaN(C))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ge(te(J(C))+" M"),this},T.GState=xh,T.setGState=function(C){(C=typeof C=="string"?zt[Tt[C]]:Qt(null,C)).equals(tn)||(ge("/"+C.id+" gs"),tn=C)};var Qt=function(C,Q){if(!C||!Tt[C]){var pe=!1;for(var Be in zt)if(zt.hasOwnProperty(Be)&&zt[Be].equals(Q)){pe=!0;break}if(pe)Q=zt[Be];else{var Ve="GS"+(Object.keys(zt).length+1).toString(10);zt[Ve]=Q,Q.id=Ve}return C&&(Tt[C]=Q.id),ti.publish("addGState",Q),Q}};T.addGState=function(C,Q){return Qt(C,Q),this},T.saveGraphicsState=function(){return ge("q"),Pt.push({key:an,size:ht,color:yn}),this},T.restoreGraphicsState=function(){ge("Q");var C=Pt.pop();return an=C.key,ht=C.size,yn=C.color,tn=null,this},T.setCurrentTransformationMatrix=function(C){return ge(C.toString()+" cm"),this},T.comment=function(C){return ge("#"+C),this};var oi=function(C,Q){var pe=C||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return pe},set:function(gt){isNaN(gt)||(pe=parseFloat(gt))}});var Be=Q||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Be},set:function(gt){isNaN(gt)||(Be=parseFloat(gt))}});var Ve="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ve},set:function(gt){Ve=gt.toString()}}),this},en=function(C,Q,pe,Be){oi.call(this,C,Q),this.type="rect";var Ve=pe||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ve},set:function(mt){isNaN(mt)||(Ve=parseFloat(mt))}});var gt=Be||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return gt},set:function(mt){isNaN(mt)||(gt=parseFloat(mt))}}),this},Ni=function(){this.page=Xt,this.currentPage=V,this.pages=Ye.slice(0),this.pagesContext=pn.slice(0),this.x=Mt,this.y=Me,this.matrix=we,this.width=fo(V),this.height=hs(V),this.outputDestination=St,this.id="",this.objectNumber=-1};Ni.prototype.restore=function(){Xt=this.page,V=this.currentPage,pn=this.pagesContext,Ye=this.pages,Mt=this.x,Me=this.y,we=this.matrix,Aa(V,this.width),Qa(V,this.height),St=this.outputDestination};var Ua=function(C,Q,pe,Be,Ve){ni.push(new Ni),Xt=V=0,Ye=[],Mt=C,Me=Q,we=Ve,Mo([pe,Be])};for(var Ea in T.beginFormObject=function(C,Q,pe,Be,Ve){return Ua(C,Q,pe,Be,Ve),this},T.endFormObject=function(C){return(function(Q){if(Bi[Q])ni.pop().restore();else{var pe=new Ni,Be="Xo"+(Object.keys(zn).length+1).toString(10);pe.id=Be,Bi[Q]=Be,zn[Be]=pe,ti.publish("addFormObject",pe),ni.pop().restore()}})(C),this},T.doFormObject=function(C,Q){var pe=zn[Bi[C]];return ge("q"),ge(Q.toString()+" cm"),ge("/"+pe.id+" Do"),ge("Q"),this},T.getFormObject=function(C){var Q=zn[Bi[C]];return{x:Q.x,y:Q.y,width:Q.width,height:Q.height,matrix:Q.matrix}},T.save=function(C,Q){return C=C||"generated.pdf",(Q=Q||{}).returnPromise=Q.returnPromise||!1,Q.returnPromise===!1?(hd(Ja(Tr()),C),typeof hd.unload=="function"&&pi.setTimeout&&setTimeout(hd.unload,911),this):new Promise(function(pe,Be){try{var Ve=hd(Ja(Tr()),C);typeof hd.unload=="function"&&pi.setTimeout&&setTimeout(hd.unload,911),pe(Ve)}catch(gt){Be(gt.message)}})},Fn.API)Fn.API.hasOwnProperty(Ea)&&(Ea==="events"&&Fn.API.events.length?(function(C,Q){var pe,Be,Ve;for(Ve=Q.length-1;Ve!==-1;Ve--)pe=Q[Ve][0],Be=Q[Ve][1],C.subscribe.apply(C,[pe].concat(typeof Be=="function"?[Be]:Be))})(ti,Fn.API.events):T[Ea]=Fn.API[Ea]);function fo(C){return pn[C].mediaBox.topRightX-pn[C].mediaBox.bottomLeftX}function Aa(C,Q){pn[C].mediaBox.topRightX=Q+pn[C].mediaBox.bottomLeftX}function hs(C){return pn[C].mediaBox.topRightY-pn[C].mediaBox.bottomLeftY}function Qa(C,Q){pn[C].mediaBox.topRightY=Q+pn[C].mediaBox.bottomLeftY}var Ys=T.getPageWidth=function(C){return fo(C=C||V)/dt},nu=T.setPageWidth=function(C,Q){Aa(C,Q*dt)},gs=T.getPageHeight=function(C){return hs(C=C||V)/dt},iu=T.setPageHeight=function(C,Q){Qa(C,Q*dt)};return T.internal={pdfEscape:gi,getStyle:Xl,getFont:jr,getFontSize:Yt,getCharSpace:ji,getTextColor:Ri,getLineHeight:Ct,getLineHeightFactor:Fa,getLineWidth:$s,write:Ot,getHorizontalCoordinate:ua,getVerticalCoordinate:wn,getCoordinateString:Tn,getVerticalCoordinateString:ul,collections:{},newObject:or,newAdditionalObject:ui,newObjectDeferred:xt,newObjectDeferredBegin:Yn,getFilters:Zt,putStream:Vn,events:ti,scaleFactor:dt,pageSize:{getWidth:function(){return Ys(V)},setWidth:function(C){nu(V,C)},getHeight:function(){return gs(V)},setHeight:function(C){iu(V,C)}},encryptionOptions:j,encryption:uo,getEncryptor:function(C){return j!==null?uo.encryptor(C,0):function(Q){return Q}},output:Yl,getNumberOfPages:Za,get pages(){return Ye},out:ge,f2:Y,f3:D,getPageInfo:Qi,getPageInfoByObjId:Xo,getCurrentPageInfo:Gl,getPDFVersion:P,Point:oi,Rectangle:en,Matrix:nn,hasHotfix:xo},Object.defineProperty(T.internal.pageSize,"width",{get:function(){return Ys(V)},set:function(C){nu(V,C)},enumerable:!0,configurable:!0}),Object.defineProperty(T.internal.pageSize,"height",{get:function(){return gs(V)},set:function(C){iu(V,C)},enumerable:!0,configurable:!0}),(function(C){for(var Q=0,pe=qt.length;Q<pe;Q++){var Be=us.call(this,C[Q][0],C[Q][1],C[Q][2],qt[Q][3],!0);_===!1&&(M[Be]=!0);var Ve=C[Q][0].split("-");qn({id:Be,fontName:Ve[0],fontStyle:Ve[1]||""})}ti.publish("addFonts",{fonts:st,dictionary:et})}).call(T,qt),an="F1",Ei(l,o),ti.publish("initialized"),T}lf.prototype.lsbFirstWord=function(n){return String.fromCharCode(255&n,n>>8&255,n>>16&255,n>>24&255)},lf.prototype.toHexString=function(n){return n.split("").map(function(r){return("0"+(255&r.charCodeAt(0)).toString(16)).slice(-2)}).join("")},lf.prototype.hexToBytes=function(n){for(var r=[],o=0;o<n.length;o+=2)r.push(String.fromCharCode(parseInt(n.substr(o,2),16)));return r.join("")},lf.prototype.processOwnerPassword=function(n,r){return r0(i0(r).substr(0,5),n)},lf.prototype.encryptor=function(n,r){var o=i0(this.encryptionKey+String.fromCharCode(255&n,n>>8&255,n>>16&255,255&r,r>>8&255)).substr(0,10);return function(s){return r0(o,s)}},xh.prototype.equals=function(n){var r,o="id,objectNumber,equals";if(!n||Hr(n)!==Hr(this))return!1;var s=0;for(r in this)if(!(o.indexOf(r)>=0)){if(this.hasOwnProperty(r)&&!n.hasOwnProperty(r)||this[r]!==n[r])return!1;s++}for(r in n)n.hasOwnProperty(r)&&o.indexOf(r)<0&&s--;return s===0},Fn.API={events:[]},Fn.version="3.0.4";var la=Fn.API,h0=1,wd=function(n){return n.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},of=function(n){return n.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},wi=function(n){return n.toFixed(2)},$u=function(n){return n.toFixed(5)};la.__acroform__={};var Sl=function(n,r){n.prototype=Object.create(r.prototype),n.prototype.constructor=n},_y=function(n){return n*h0},Zc=function(n){var r=new Yx,o=Nn.internal.getHeight(n)||0,s=Nn.internal.getWidth(n)||0;return r.BBox=[0,0,Number(wi(s)),Number(wi(o))],r},v5=la.__acroform__.setBit=function(n,r){if(n=n||0,r=r||0,isNaN(n)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return n|1<<r},w5=la.__acroform__.clearBit=function(n,r){if(n=n||0,r=r||0,isNaN(n)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return n&~(1<<r)},S5=la.__acroform__.getBit=function(n,r){if(isNaN(n)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return n&1<<r?1:0},Ca=la.__acroform__.getBitForPdf=function(n,r){if(isNaN(n)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return S5(n,r-1)},ja=la.__acroform__.setBitForPdf=function(n,r){if(isNaN(n)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return v5(n,r-1)},Na=la.__acroform__.clearBitForPdf=function(n,r){if(isNaN(n)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return w5(n,r-1)},T5=la.__acroform__.calculateCoordinates=function(n,r){var o=r.internal.getHorizontalCoordinate,s=r.internal.getVerticalCoordinate,l=n[0],d=n[1],b=n[2],p=n[3],v={};return v.lowerLeft_X=o(l)||0,v.lowerLeft_Y=s(d+p)||0,v.upperRight_X=o(l+b)||0,v.upperRight_Y=s(d)||0,[Number(wi(v.lowerLeft_X)),Number(wi(v.lowerLeft_Y)),Number(wi(v.upperRight_X)),Number(wi(v.upperRight_Y))]},C5=function(n){if(n.appearanceStreamContent)return n.appearanceStreamContent;if(n.V||n.DV){var r=[],o=n._V||n.DV,s=o0(n,o),l=n.scope.internal.getFont(n.fontName,n.fontStyle).id;r.push("/Tx BMC"),r.push("q"),r.push("BT"),r.push(n.scope.__private__.encodeColorString(n.color)),r.push("/"+l+" "+wi(s.fontSize)+" Tf"),r.push("1 0 0 1 0 0 Tm"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC");var d=Zc(n);return d.scope=n.scope,d.stream=r.join(`
`),d}},o0=function(n,r){var o=n.fontSize===0?n.maxFontSize:n.fontSize,s={text:"",fontSize:""},l=(r=(r=r.substr(0,1)=="("?r.substr(1):r).substr(r.length-1)==")"?r.substr(0,r.length-1):r).split(" ");l=n.multiline?l.map(function(Y){return Y.split(`
`)}):l.map(function(Y){return[Y]});var d=o,b=Nn.internal.getHeight(n)||0;b=b<0?-b:b;var p=Nn.internal.getWidth(n)||0;p=p<0?-p:p;var v=function(Y,D,J){if(Y+1<l.length){var $=D+" "+l[Y+1][0];return oh($,n,J).width<=p-4}return!1};d++;e:for(;d>0;){r="",d--;var m,j,_=oh("3",n,d).height,M=n.multiline?b-d:(b-_)/2,T=M+=2,F=0,P=0,k=0;if(d<=0){r=`(...) Tj
`,r+="% Width of Text: "+oh(r,n,d=12).width+", FieldWidth:"+p+`
`;break}for(var y="",ae=0,E=0;E<l.length;E++)if(l.hasOwnProperty(E)){var U=!1;if(l[E].length!==1&&k!==l[E].length-1){if((_+2)*(ae+2)+2>b)continue e;y+=l[E][k],U=!0,P=E,E--}else{y=(y+=l[E][k]+" ").substr(y.length-1)==" "?y.substr(0,y.length-1):y;var ne=parseInt(E),Z=v(ne,y,d),G=E>=l.length-1;if(Z&&!G){y+=" ",k=0;continue}if(Z||G){if(G)P=ne;else if(n.multiline&&(_+2)*(ae+2)+2>b)continue e}else{if(!n.multiline||(_+2)*(ae+2)+2>b)continue e;P=ne}}for(var te="",O=F;O<=P;O++){var W=l[O];if(n.multiline){if(O===P){te+=W[k]+" ",k=(k+1)%W.length;continue}if(O===F){te+=W[W.length-1]+" ";continue}}te+=W[0]+" "}switch(te=te.substr(te.length-1)==" "?te.substr(0,te.length-1):te,j=oh(te,n,d).width,n.textAlign){case"right":m=p-j-2;break;case"center":m=(p-j)/2;break;default:m=2}r+=wi(m)+" "+wi(T)+` Td
`,r+="("+wd(te)+`) Tj
`,r+=-wi(m)+` 0 Td
`,T=-(d+2),j=0,F=U?P:P+1,ae++,y=""}break}return s.text=r,s.fontSize=d,s},oh=function(n,r,o){var s=r.scope.internal.getFont(r.fontName,r.fontStyle),l=r.scope.getStringUnitWidth(n,{font:s,fontSize:parseFloat(o),charSpace:0})*parseFloat(o);return{height:r.scope.getStringUnitWidth("3",{font:s,fontSize:parseFloat(o),charSpace:0})*parseFloat(o)*1.5,width:l}},j5={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},N5=function(n,r){var o={type:"reference",object:n};r.internal.getPageInfo(n.page).pageContext.annotations.find(function(s){return s.type===o.type&&s.object===o.object})===void 0&&r.internal.getPageInfo(n.page).pageContext.annotations.push(o)},k5=function(n,r){if(r.scope=n,n.internal!==void 0&&(n.internal.acroformPlugin===void 0||n.internal.acroformPlugin.isInitialized===!1)){if(Ac.FieldNum=0,n.internal.acroformPlugin=JSON.parse(JSON.stringify(j5)),n.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");h0=n.internal.scaleFactor,n.internal.acroformPlugin.acroFormDictionaryRoot=new Gx,n.internal.acroformPlugin.acroFormDictionaryRoot.scope=n,n.internal.acroformPlugin.acroFormDictionaryRoot._eventID=n.internal.events.subscribe("postPutResources",function(){(function(o){o.internal.events.unsubscribe(o.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete o.internal.acroformPlugin.acroFormDictionaryRoot._eventID,o.internal.acroformPlugin.printedOut=!0})(n)}),n.internal.events.subscribe("buildDocument",function(){(function(o){o.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var s=o.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var l in s)if(s.hasOwnProperty(l)){var d=s[l];d.objId=void 0,d.hasAnnotation&&N5(d,o)}})(n)}),n.internal.events.subscribe("putCatalog",function(){(function(o){if(o.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");o.internal.write("/AcroForm "+o.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(n)}),n.internal.events.subscribe("postPutPages",function(o){(function(s,l){var d=!s;for(var b in s||(l.internal.newObjectDeferredBegin(l.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),l.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),s=s||l.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(s.hasOwnProperty(b)){var p=s[b],v=[],m=p.Rect;if(p.Rect&&(p.Rect=T5(p.Rect,l)),l.internal.newObjectDeferredBegin(p.objId,!0),p.DA=Nn.createDefaultAppearanceStream(p),Hr(p)==="object"&&typeof p.getKeyValueListForStream=="function"&&(v=p.getKeyValueListForStream()),p.Rect=m,p.hasAppearanceStream&&!p.appearanceStreamContent){var j=C5(p);v.push({key:"AP",value:"<</N "+j+">>"}),l.internal.acroformPlugin.xForms.push(j)}if(p.appearanceStreamContent){var _="";for(var M in p.appearanceStreamContent)if(p.appearanceStreamContent.hasOwnProperty(M)){var T=p.appearanceStreamContent[M];if(_+="/"+M+" ",_+="<<",Object.keys(T).length>=1||Array.isArray(T)){for(var b in T)if(T.hasOwnProperty(b)){var F=T[b];typeof F=="function"&&(F=F.call(l,p)),_+="/"+b+" "+F+" ",l.internal.acroformPlugin.xForms.indexOf(F)>=0||l.internal.acroformPlugin.xForms.push(F)}}else typeof(F=T)=="function"&&(F=F.call(l,p)),_+="/"+b+" "+F,l.internal.acroformPlugin.xForms.indexOf(F)>=0||l.internal.acroformPlugin.xForms.push(F);_+=">>"}v.push({key:"AP",value:`<<
`+_+">>"})}l.internal.putStream({additionalKeyValues:v,objectId:p.objId}),l.internal.out("endobj")}d&&(function(P,k){for(var y in P)if(P.hasOwnProperty(y)){var ae=y,E=P[y];k.internal.newObjectDeferredBegin(E.objId,!0),Hr(E)==="object"&&typeof E.putStream=="function"&&E.putStream(),delete P[ae]}})(l.internal.acroformPlugin.xForms,l)})(o,n)}),n.internal.acroformPlugin.isInitialized=!0}},$x=la.__acroform__.arrayToPdfArray=function(n,r,o){var s=function(b){return b};if(Array.isArray(n)){for(var l="[",d=0;d<n.length;d++)switch(d!==0&&(l+=" "),Hr(n[d])){case"boolean":case"number":case"object":l+=n[d].toString();break;case"string":n[d].substr(0,1)!=="/"?(r!==void 0&&o&&(s=o.internal.getEncryptor(r)),l+="("+wd(s(n[d].toString()))+")"):l+=n[d].toString()}return l+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Og=function(n,r,o){var s=function(l){return l};return r!==void 0&&o&&(s=o.internal.getEncryptor(r)),(n=n||"").toString(),"("+wd(s(n))+")"},eu=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(n){this._objId=n}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};eu.prototype.toString=function(){return this.objId+" 0 R"},eu.prototype.putStream=function(){var n=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:n,objectId:this.objId}),this.scope.internal.out("endobj")},eu.prototype.getKeyValueListForStream=function(){var n=[],r=Object.getOwnPropertyNames(this).filter(function(d){return d!="content"&&d!="appearanceStreamContent"&&d!="scope"&&d!="objId"&&d.substring(0,1)!="_"});for(var o in r)if(Object.getOwnPropertyDescriptor(this,r[o]).configurable===!1){var s=r[o],l=this[s];l&&(Array.isArray(l)?n.push({key:s,value:$x(l,this.objId,this.scope)}):l instanceof eu?(l.scope=this.scope,n.push({key:s,value:l.objId+" 0 R"})):typeof l!="function"&&n.push({key:s,value:l}))}return n};var Yx=function(){eu.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var n,r=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return r},set:function(o){r=o}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(o){n=o.trim()},get:function(){return n||null}})};Sl(Yx,eu);var Gx=function(){eu.call(this);var n,r=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return r.length>0?r:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return r}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(n){var o=function(s){return s};return this.scope&&(o=this.scope.internal.getEncryptor(this.objId)),"("+wd(o(n))+")"}},set:function(o){n=o}})};Sl(Gx,eu);var Ac=function n(){eu.call(this);var r=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return r},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute F supplied.');r=y}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Ca(r,3)},set:function(y){y?this.F=ja(r,3):this.F=Na(r,3)}});var o=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return o},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute Ff supplied.');o=y}});var s=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(s.length!==0)return s},set:function(y){s=y!==void 0?y:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[0])?0:s[0]},set:function(y){s[0]=y}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[1])?0:s[1]},set:function(y){s[1]=y}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[2])?0:s[2]},set:function(y){s[2]=y}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[3])?0:s[3]},set:function(y){s[3]=y}});var l="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return l},set:function(y){switch(y){case"/Btn":case"/Tx":case"/Ch":case"/Sig":l=y;break;default:throw new Error('Invalid value "'+y+'" for attribute FT supplied.')}}});var d=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!d||d.length<1){if(this instanceof mh)return;d="FieldObject"+n.FieldNum++}var y=function(ae){return ae};return this.scope&&(y=this.scope.internal.getEncryptor(this.objId)),"("+wd(y(d))+")"},set:function(y){d=y.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return d},set:function(y){d=y}});var b="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return b},set:function(y){b=y}});var p="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return p},set:function(y){p=y}});var v=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return v},set:function(y){v=y}});var m=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return m===void 0?50/h0:m},set:function(y){m=y}});var j="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return j},set:function(y){j=y}});var _="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!_||this instanceof mh||this instanceof xd))return Og(_,this.objId,this.scope)},set:function(y){y=y.toString(),_=y}});var M=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(M)return this instanceof cs==0?Og(M,this.objId,this.scope):M},set:function(y){y=y.toString(),M=this instanceof cs==0?y.substr(0,1)==="("?of(y.substr(1,y.length-2)):of(y):y}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof cs==1?of(M.substr(1,M.length-1)):M},set:function(y){y=y.toString(),M=this instanceof cs==1?"/"+y:y}});var T=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(T)return T},set:function(y){this.V=y}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(T)return this instanceof cs==0?Og(T,this.objId,this.scope):T},set:function(y){y=y.toString(),T=this instanceof cs==0?y.substr(0,1)==="("?of(y.substr(1,y.length-2)):of(y):y}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof cs==1?of(T.substr(1,T.length-1)):T},set:function(y){y=y.toString(),T=this instanceof cs==1?"/"+y:y}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var F,P=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return P},set:function(y){y=!!y,P=y}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(F)return F},set:function(y){F=y}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Ca(this.Ff,1)},set:function(y){y?this.Ff=ja(this.Ff,1):this.Ff=Na(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Ca(this.Ff,2)},set:function(y){y?this.Ff=ja(this.Ff,2):this.Ff=Na(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Ca(this.Ff,3)},set:function(y){y?this.Ff=ja(this.Ff,3):this.Ff=Na(this.Ff,3)}});var k=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(k!==null)return k},set:function(y){if([0,1,2].indexOf(y)===-1)throw new Error('Invalid value "'+y+'" for attribute Q supplied.');k=y}}),Object.defineProperty(this,"textAlign",{get:function(){var y;switch(k){case 0:default:y="left";break;case 1:y="center";break;case 2:y="right"}return y},configurable:!0,enumerable:!0,set:function(y){switch(y){case"right":case 2:k=2;break;case"center":case 1:k=1;break;default:k=0}}})};Sl(Ac,eu);var ff=function(){Ac.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var n=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return n},set:function(o){n=o}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return n},set:function(o){n=o}});var r=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return $x(r,this.objId,this.scope)},set:function(o){var s,l;l=[],typeof(s=o)=="string"&&(l=(function(d,b,p){p||(p=1);for(var v,m=[];v=b.exec(d);)m.push(v[p]);return m})(s,/\((.*?)\)/g)),r=l}}),this.getOptions=function(){return r},this.setOptions=function(o){r=o,this.sort&&r.sort()},this.addOption=function(o){o=(o=o||"").toString(),r.push(o),this.sort&&r.sort()},this.removeOption=function(o,s){for(s=s||!1,o=(o=o||"").toString();r.indexOf(o)!==-1&&(r.splice(r.indexOf(o),1),s!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Ca(this.Ff,18)},set:function(o){o?this.Ff=ja(this.Ff,18):this.Ff=Na(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Ca(this.Ff,19)},set:function(o){this.combo===!0&&(o?this.Ff=ja(this.Ff,19):this.Ff=Na(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Ca(this.Ff,20)},set:function(o){o?(this.Ff=ja(this.Ff,20),r.sort()):this.Ff=Na(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ca(this.Ff,22)},set:function(o){o?this.Ff=ja(this.Ff,22):this.Ff=Na(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ca(this.Ff,23)},set:function(o){o?this.Ff=ja(this.Ff,23):this.Ff=Na(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Ca(this.Ff,27)},set:function(o){o?this.Ff=ja(this.Ff,27):this.Ff=Na(this.Ff,27)}}),this.hasAppearanceStream=!1};Sl(ff,Ac);var pf=function(){ff.call(this),this.fontName="helvetica",this.combo=!1};Sl(pf,ff);var hf=function(){pf.call(this),this.combo=!0};Sl(hf,pf);var uh=function(){hf.call(this),this.edit=!0};Sl(uh,hf);var cs=function(){Ac.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Ca(this.Ff,15)},set:function(o){o?this.Ff=ja(this.Ff,15):this.Ff=Na(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Ca(this.Ff,16)},set:function(o){o?this.Ff=ja(this.Ff,16):this.Ff=Na(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Ca(this.Ff,17)},set:function(o){o?this.Ff=ja(this.Ff,17):this.Ff=Na(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Ca(this.Ff,26)},set:function(o){o?this.Ff=ja(this.Ff,26):this.Ff=Na(this.Ff,26)}});var n,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var o=function(d){return d};if(this.scope&&(o=this.scope.internal.getEncryptor(this.objId)),Object.keys(r).length!==0){var s,l=[];for(s in l.push("<<"),r)l.push("/"+s+" ("+wd(o(r[s]))+")");return l.push(">>"),l.join(`
`)}},set:function(o){Hr(o)==="object"&&(r=o)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(o){typeof o=="string"&&(r.CA=o)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(o){n=o}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(o){n="/"+o}})};Sl(cs,Ac);var dh=function(){cs.call(this),this.pushButton=!0};Sl(dh,cs);var gf=function(){cs.call(this),this.radio=!0,this.pushButton=!1;var n=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return n},set:function(r){n=r!==void 0?r:[]}})};Sl(gf,cs);var mh=function(){var n,r;Ac.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return n},set:function(l){n=l}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return r},set:function(l){r=l}});var o,s={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var l=function(p){return p};this.scope&&(l=this.scope.internal.getEncryptor(this.objId));var d,b=[];for(d in b.push("<<"),s)b.push("/"+d+" ("+wd(l(s[d]))+")");return b.push(">>"),b.join(`
`)},set:function(l){Hr(l)==="object"&&(s=l)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return s.CA||""},set:function(l){typeof l=="string"&&(s.CA=l)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return o.substr(1,o.length-1)},set:function(l){o="/"+l}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Nn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Sl(mh,Ac),gf.prototype.setAppearance=function(n){if(!("createAppearanceStream"in n)||!("getCA"in n))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var r in this.Kids)if(this.Kids.hasOwnProperty(r)){var o=this.Kids[r];o.appearanceStreamContent=n.createAppearanceStream(o.optionName),o.caption=n.getCA()}},gf.prototype.createOption=function(n){var r=new mh;return r.Parent=this,r.optionName=n,this.Kids.push(r),A5.call(this.scope,r),r};var fh=function(){cs.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Nn.CheckBox.createAppearanceStream()};Sl(fh,cs);var xd=function(){Ac.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Ca(this.Ff,13)},set:function(r){r?this.Ff=ja(this.Ff,13):this.Ff=Na(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ca(this.Ff,21)},set:function(r){r?this.Ff=ja(this.Ff,21):this.Ff=Na(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ca(this.Ff,23)},set:function(r){r?this.Ff=ja(this.Ff,23):this.Ff=Na(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Ca(this.Ff,24)},set:function(r){r?this.Ff=ja(this.Ff,24):this.Ff=Na(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Ca(this.Ff,25)},set:function(r){r?this.Ff=ja(this.Ff,25):this.Ff=Na(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Ca(this.Ff,26)},set:function(r){r?this.Ff=ja(this.Ff,26):this.Ff=Na(this.Ff,26)}});var n=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return n},set:function(r){n=r}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return n},set:function(r){Number.isInteger(r)&&(n=r)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Sl(xd,Ac);var ph=function(){xd.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Ca(this.Ff,14)},set:function(n){n?this.Ff=ja(this.Ff,14):this.Ff=Na(this.Ff,14)}}),this.password=!0};Sl(ph,xd);var Nn={CheckBox:{createAppearanceStream:function(){return{N:{On:Nn.CheckBox.YesNormal},D:{On:Nn.CheckBox.YesPushDown,Off:Nn.CheckBox.OffPushDown}}},YesPushDown:function(n){var r=Zc(n);r.scope=n.scope;var o=[],s=n.scope.internal.getFont(n.fontName,n.fontStyle).id,l=n.scope.__private__.encodeColorString(n.color),d=o0(n,n.caption);return o.push("0.749023 g"),o.push("0 0 "+wi(Nn.internal.getWidth(n))+" "+wi(Nn.internal.getHeight(n))+" re"),o.push("f"),o.push("BMC"),o.push("q"),o.push("0 0 1 rg"),o.push("/"+s+" "+wi(d.fontSize)+" Tf "+l),o.push("BT"),o.push(d.text),o.push("ET"),o.push("Q"),o.push("EMC"),r.stream=o.join(`
`),r},YesNormal:function(n){var r=Zc(n);r.scope=n.scope;var o=n.scope.internal.getFont(n.fontName,n.fontStyle).id,s=n.scope.__private__.encodeColorString(n.color),l=[],d=Nn.internal.getHeight(n),b=Nn.internal.getWidth(n),p=o0(n,n.caption);return l.push("1 g"),l.push("0 0 "+wi(b)+" "+wi(d)+" re"),l.push("f"),l.push("q"),l.push("0 0 1 rg"),l.push("0 0 "+wi(b-1)+" "+wi(d-1)+" re"),l.push("W"),l.push("n"),l.push("0 g"),l.push("BT"),l.push("/"+o+" "+wi(p.fontSize)+" Tf "+s),l.push(p.text),l.push("ET"),l.push("Q"),r.stream=l.join(`
`),r},OffPushDown:function(n){var r=Zc(n);r.scope=n.scope;var o=[];return o.push("0.749023 g"),o.push("0 0 "+wi(Nn.internal.getWidth(n))+" "+wi(Nn.internal.getHeight(n))+" re"),o.push("f"),r.stream=o.join(`
`),r}},RadioButton:{Circle:{createAppearanceStream:function(n){var r={D:{Off:Nn.RadioButton.Circle.OffPushDown},N:{}};return r.N[n]=Nn.RadioButton.Circle.YesNormal,r.D[n]=Nn.RadioButton.Circle.YesPushDown,r},getCA:function(){return"l"},YesNormal:function(n){var r=Zc(n);r.scope=n.scope;var o=[],s=Nn.internal.getWidth(n)<=Nn.internal.getHeight(n)?Nn.internal.getWidth(n)/4:Nn.internal.getHeight(n)/4;s=Number((.9*s).toFixed(5));var l=Nn.internal.Bezier_C,d=Number((s*l).toFixed(5));return o.push("q"),o.push("1 0 0 1 "+$u(Nn.internal.getWidth(n)/2)+" "+$u(Nn.internal.getHeight(n)/2)+" cm"),o.push(s+" 0 m"),o.push(s+" "+d+" "+d+" "+s+" 0 "+s+" c"),o.push("-"+d+" "+s+" -"+s+" "+d+" -"+s+" 0 c"),o.push("-"+s+" -"+d+" -"+d+" -"+s+" 0 -"+s+" c"),o.push(d+" -"+s+" "+s+" -"+d+" "+s+" 0 c"),o.push("f"),o.push("Q"),r.stream=o.join(`
`),r},YesPushDown:function(n){var r=Zc(n);r.scope=n.scope;var o=[],s=Nn.internal.getWidth(n)<=Nn.internal.getHeight(n)?Nn.internal.getWidth(n)/4:Nn.internal.getHeight(n)/4;s=Number((.9*s).toFixed(5));var l=Number((2*s).toFixed(5)),d=Number((l*Nn.internal.Bezier_C).toFixed(5)),b=Number((s*Nn.internal.Bezier_C).toFixed(5));return o.push("0.749023 g"),o.push("q"),o.push("1 0 0 1 "+$u(Nn.internal.getWidth(n)/2)+" "+$u(Nn.internal.getHeight(n)/2)+" cm"),o.push(l+" 0 m"),o.push(l+" "+d+" "+d+" "+l+" 0 "+l+" c"),o.push("-"+d+" "+l+" -"+l+" "+d+" -"+l+" 0 c"),o.push("-"+l+" -"+d+" -"+d+" -"+l+" 0 -"+l+" c"),o.push(d+" -"+l+" "+l+" -"+d+" "+l+" 0 c"),o.push("f"),o.push("Q"),o.push("0 g"),o.push("q"),o.push("1 0 0 1 "+$u(Nn.internal.getWidth(n)/2)+" "+$u(Nn.internal.getHeight(n)/2)+" cm"),o.push(s+" 0 m"),o.push(s+" "+b+" "+b+" "+s+" 0 "+s+" c"),o.push("-"+b+" "+s+" -"+s+" "+b+" -"+s+" 0 c"),o.push("-"+s+" -"+b+" -"+b+" -"+s+" 0 -"+s+" c"),o.push(b+" -"+s+" "+s+" -"+b+" "+s+" 0 c"),o.push("f"),o.push("Q"),r.stream=o.join(`
`),r},OffPushDown:function(n){var r=Zc(n);r.scope=n.scope;var o=[],s=Nn.internal.getWidth(n)<=Nn.internal.getHeight(n)?Nn.internal.getWidth(n)/4:Nn.internal.getHeight(n)/4;s=Number((.9*s).toFixed(5));var l=Number((2*s).toFixed(5)),d=Number((l*Nn.internal.Bezier_C).toFixed(5));return o.push("0.749023 g"),o.push("q"),o.push("1 0 0 1 "+$u(Nn.internal.getWidth(n)/2)+" "+$u(Nn.internal.getHeight(n)/2)+" cm"),o.push(l+" 0 m"),o.push(l+" "+d+" "+d+" "+l+" 0 "+l+" c"),o.push("-"+d+" "+l+" -"+l+" "+d+" -"+l+" 0 c"),o.push("-"+l+" -"+d+" -"+d+" -"+l+" 0 -"+l+" c"),o.push(d+" -"+l+" "+l+" -"+d+" "+l+" 0 c"),o.push("f"),o.push("Q"),r.stream=o.join(`
`),r}},Cross:{createAppearanceStream:function(n){var r={D:{Off:Nn.RadioButton.Cross.OffPushDown},N:{}};return r.N[n]=Nn.RadioButton.Cross.YesNormal,r.D[n]=Nn.RadioButton.Cross.YesPushDown,r},getCA:function(){return"8"},YesNormal:function(n){var r=Zc(n);r.scope=n.scope;var o=[],s=Nn.internal.calculateCross(n);return o.push("q"),o.push("1 1 "+wi(Nn.internal.getWidth(n)-2)+" "+wi(Nn.internal.getHeight(n)-2)+" re"),o.push("W"),o.push("n"),o.push(wi(s.x1.x)+" "+wi(s.x1.y)+" m"),o.push(wi(s.x2.x)+" "+wi(s.x2.y)+" l"),o.push(wi(s.x4.x)+" "+wi(s.x4.y)+" m"),o.push(wi(s.x3.x)+" "+wi(s.x3.y)+" l"),o.push("s"),o.push("Q"),r.stream=o.join(`
`),r},YesPushDown:function(n){var r=Zc(n);r.scope=n.scope;var o=Nn.internal.calculateCross(n),s=[];return s.push("0.749023 g"),s.push("0 0 "+wi(Nn.internal.getWidth(n))+" "+wi(Nn.internal.getHeight(n))+" re"),s.push("f"),s.push("q"),s.push("1 1 "+wi(Nn.internal.getWidth(n)-2)+" "+wi(Nn.internal.getHeight(n)-2)+" re"),s.push("W"),s.push("n"),s.push(wi(o.x1.x)+" "+wi(o.x1.y)+" m"),s.push(wi(o.x2.x)+" "+wi(o.x2.y)+" l"),s.push(wi(o.x4.x)+" "+wi(o.x4.y)+" m"),s.push(wi(o.x3.x)+" "+wi(o.x3.y)+" l"),s.push("s"),s.push("Q"),r.stream=s.join(`
`),r},OffPushDown:function(n){var r=Zc(n);r.scope=n.scope;var o=[];return o.push("0.749023 g"),o.push("0 0 "+wi(Nn.internal.getWidth(n))+" "+wi(Nn.internal.getHeight(n))+" re"),o.push("f"),r.stream=o.join(`
`),r}}},createDefaultAppearanceStream:function(n){var r=n.scope.internal.getFont(n.fontName,n.fontStyle).id,o=n.scope.__private__.encodeColorString(n.color);return"/"+r+" "+n.fontSize+" Tf "+o}};Nn.internal={Bezier_C:.551915024494,calculateCross:function(n){var r=Nn.internal.getWidth(n),o=Nn.internal.getHeight(n),s=Math.min(r,o);return{x1:{x:(r-s)/2,y:(o-s)/2+s},x2:{x:(r-s)/2+s,y:(o-s)/2},x3:{x:(r-s)/2,y:(o-s)/2},x4:{x:(r-s)/2+s,y:(o-s)/2+s}}}},Nn.internal.getWidth=function(n){var r=0;return Hr(n)==="object"&&(r=_y(n.Rect[2])),r},Nn.internal.getHeight=function(n){var r=0;return Hr(n)==="object"&&(r=_y(n.Rect[3])),r};var A5=la.addField=function(n){if(k5(this,n),!(n instanceof Ac))throw new Error("Invalid argument passed to jsPDF.addField.");var r;return(r=n).scope.internal.acroformPlugin.printedOut&&(r.scope.internal.acroformPlugin.printedOut=!1,r.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),r.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(r),n.page=n.scope.internal.getCurrentPageInfo().pageNumber,this};la.AcroFormChoiceField=ff,la.AcroFormListBox=pf,la.AcroFormComboBox=hf,la.AcroFormEditBox=uh,la.AcroFormButton=cs,la.AcroFormPushButton=dh,la.AcroFormRadioButton=gf,la.AcroFormCheckBox=fh,la.AcroFormTextField=xd,la.AcroFormPasswordField=ph,la.AcroFormAppearance=Nn,la.AcroForm={ChoiceField:ff,ListBox:pf,ComboBox:hf,EditBox:uh,Button:cs,PushButton:dh,RadioButton:gf,CheckBox:fh,TextField:xd,PasswordField:ph,Appearance:Nn},Fn.AcroForm={ChoiceField:ff,ListBox:pf,ComboBox:hf,EditBox:uh,Button:cs,PushButton:dh,RadioButton:gf,CheckBox:fh,TextField:xd,PasswordField:ph,Appearance:Nn};Fn.AcroForm;function Xx(n){return n.reduce(function(r,o,s){return r[o]=s,r},{})}(function(n){var r="addImage_";n.__addimage__={};var o="UNKNOWN",s={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},l=n.__addimage__.getImageFileTypeByImageData=function(Y,D){var J,$,je,ee,de,Ne=o;if((D=D||o)==="RGBA"||Y.data!==void 0&&Y.data instanceof Uint8ClampedArray&&"height"in Y&&"width"in Y)return"RGBA";if(Z(Y))for(de in s)for(je=s[de],J=0;J<je.length;J+=1){for(ee=!0,$=0;$<je[J].length;$+=1)if(je[J][$]!==void 0&&je[J][$]!==Y[$]){ee=!1;break}if(ee===!0){Ne=de;break}}else for(de in s)for(je=s[de],J=0;J<je.length;J+=1){for(ee=!0,$=0;$<je[J].length;$+=1)if(je[J][$]!==void 0&&je[J][$]!==Y.charCodeAt($)){ee=!1;break}if(ee===!0){Ne=de;break}}return Ne===o&&D!==o&&(Ne=D),Ne},d=function Y(D){for(var J=this.internal.write,$=this.internal.putStream,je=(0,this.internal.getFilters)();je.indexOf("FlateEncode")!==-1;)je.splice(je.indexOf("FlateEncode"),1);D.objectId=this.internal.newObject();var ee=[];if(ee.push({key:"Type",value:"/XObject"}),ee.push({key:"Subtype",value:"/Image"}),ee.push({key:"Width",value:D.width}),ee.push({key:"Height",value:D.height}),D.colorSpace===y.INDEXED?ee.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(D.palette.length/3-1)+" "+("sMask"in D&&D.sMask!==void 0?D.objectId+2:D.objectId+1)+" 0 R]"}):(ee.push({key:"ColorSpace",value:"/"+D.colorSpace}),D.colorSpace===y.DEVICE_CMYK&&ee.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ee.push({key:"BitsPerComponent",value:D.bitsPerComponent}),"decodeParameters"in D&&D.decodeParameters!==void 0&&ee.push({key:"DecodeParms",value:"<<"+D.decodeParameters+">>"}),"transparency"in D&&Array.isArray(D.transparency)&&D.transparency.length>0){for(var de="",Ne=0,Ie=D.transparency.length;Ne<Ie;Ne++)de+=D.transparency[Ne]+" "+D.transparency[Ne]+" ";ee.push({key:"Mask",value:"["+de+"]"})}D.sMask!==void 0&&ee.push({key:"SMask",value:D.objectId+1+" 0 R"});var $e=D.filter!==void 0?["/"+D.filter]:void 0;if($({data:D.data,additionalKeyValues:ee,alreadyAppliedFilters:$e,objectId:D.objectId}),J("endobj"),"sMask"in D&&D.sMask!==void 0){var q,w=(q=D.sMaskBitsPerComponent)!==null&&q!==void 0?q:D.bitsPerComponent,V={width:D.width,height:D.height,colorSpace:"DeviceGray",bitsPerComponent:w,data:D.sMask};"filter"in D&&(V.decodeParameters="/Predictor ".concat(D.predictor," /Colors 1 /BitsPerComponent ").concat(w," /Columns ").concat(D.width),V.filter=D.filter),Y.call(this,V)}if(D.colorSpace===y.INDEXED){var H=this.internal.newObject();$({data:te(new Uint8Array(D.palette)),objectId:H}),J("endobj")}},b=function(){var Y=this.internal.collections[r+"images"];for(var D in Y)d.call(this,Y[D])},p=function(){var Y,D=this.internal.collections[r+"images"],J=this.internal.write;for(var $ in D)J("/I"+(Y=D[$]).index,Y.objectId,"0","R")},v=function(){this.internal.collections[r+"images"]||(this.internal.collections[r+"images"]={},this.internal.events.subscribe("putResources",b),this.internal.events.subscribe("putXobjectDict",p))},m=function(){var Y=this.internal.collections[r+"images"];return v.call(this),Y},j=function(){return Object.keys(this.internal.collections[r+"images"]).length},_=function(Y){return typeof n["process"+Y.toUpperCase()]=="function"},M=function(Y){return Hr(Y)==="object"&&Y.nodeType===1},T=function(Y,D){if(Y.nodeName==="IMG"&&Y.hasAttribute("src")){var J=""+Y.getAttribute("src");if(J.indexOf("data:image/")===0)return ch(unescape(J).split("base64,").pop());var $=n.loadFile(J,!0);if($!==void 0)return $}if(Y.nodeName==="CANVAS"){if(Y.width===0||Y.height===0)throw new Error("Given canvas must have data. Canvas width: "+Y.width+", height: "+Y.height);var je;switch(D){case"PNG":je="image/png";break;case"WEBP":je="image/webp";break;default:je="image/jpeg"}return ch(Y.toDataURL(je,1).split("base64,").pop())}},F=function(Y){var D=this.internal.collections[r+"images"];if(D){for(var J in D)if(Y===D[J].alias)return D[J]}},P=function(Y,D,J){return Y||D||(Y=-96,D=-96),Y<0&&(Y=-1*J.width*72/Y/this.internal.scaleFactor),D<0&&(D=-1*J.height*72/D/this.internal.scaleFactor),Y===0&&(Y=D*J.width/J.height),D===0&&(D=Y*J.height/J.width),[Y,D]},k=function(Y,D,J,$,je,ee){var de=P.call(this,J,$,je),Ne=this.internal.getCoordinateString,Ie=this.internal.getVerticalCoordinateString,$e=m.call(this);if(J=de[0],$=de[1],$e[je.index]=je,ee){ee*=Math.PI/180;var q=Math.cos(ee),w=Math.sin(ee),V=function(ue){return ue.toFixed(4)},H=[V(q),V(w),V(-1*w),V(q),0,0,"cm"]}this.internal.write("q"),ee?(this.internal.write([1,"0","0",1,Ne(Y),Ie(D+$),"cm"].join(" ")),this.internal.write(H.join(" ")),this.internal.write([Ne(J),"0","0",Ne($),"0","0","cm"].join(" "))):this.internal.write([Ne(J),"0","0",Ne($),Ne(Y),Ie(D+$),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+je.index+" Do"),this.internal.write("Q")},y=n.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};n.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var ae=n.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},E=n.__addimage__.sHashCode=function(Y){var D,J,$=0;if(typeof Y=="string")for(J=Y.length,D=0;D<J;D++)$=($<<5)-$+Y.charCodeAt(D),$|=0;else if(Z(Y))for(J=Y.byteLength/2,D=0;D<J;D++)$=($<<5)-$+Y[D],$|=0;return $},U=n.__addimage__.validateStringAsBase64=function(Y){(Y=Y||"").toString().trim();var D=!0;return Y.length===0&&(D=!1),Y.length%4!=0&&(D=!1),/^[A-Za-z0-9+/]+$/.test(Y.substr(0,Y.length-2))===!1&&(D=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(Y.substr(-2))===!1&&(D=!1),D},ne=n.__addimage__.extractImageFromDataUrl=function(Y){if(Y==null||!(Y=Y.trim()).startsWith("data:"))return null;var D=Y.indexOf(",");return D<0?null:Y.substring(0,D).trim().endsWith("base64")?Y.substring(D+1):null};n.__addimage__.isArrayBuffer=function(Y){return Y instanceof ArrayBuffer};var Z=n.__addimage__.isArrayBufferView=function(Y){return Y instanceof Int8Array||Y instanceof Uint8Array||Y instanceof Uint8ClampedArray||Y instanceof Int16Array||Y instanceof Uint16Array||Y instanceof Int32Array||Y instanceof Uint32Array||Y instanceof Float32Array||Y instanceof Float64Array},G=n.__addimage__.binaryStringToUint8Array=function(Y){for(var D=Y.length,J=new Uint8Array(D),$=0;$<D;$++)J[$]=Y.charCodeAt($);return J},te=n.__addimage__.arrayBufferToBinaryString=function(Y){for(var D="",J=Z(Y)?Y:new Uint8Array(Y),$=0;$<J.length;$+=8192)D+=String.fromCharCode.apply(null,J.subarray($,$+8192));return D};n.addImage=function(){var Y,D,J,$,je,ee,de,Ne,Ie;if(typeof arguments[1]=="number"?(D=o,J=arguments[1],$=arguments[2],je=arguments[3],ee=arguments[4],de=arguments[5],Ne=arguments[6],Ie=arguments[7]):(D=arguments[1],J=arguments[2],$=arguments[3],je=arguments[4],ee=arguments[5],de=arguments[6],Ne=arguments[7],Ie=arguments[8]),Hr(Y=arguments[0])==="object"&&!M(Y)&&"imageData"in Y){var $e=Y;Y=$e.imageData,D=$e.format||D||o,J=$e.x||J||0,$=$e.y||$||0,je=$e.w||$e.width||je,ee=$e.h||$e.height||ee,de=$e.alias||de,Ne=$e.compression||Ne,Ie=$e.rotation||$e.angle||Ie}var q=this.internal.getFilters();if(Ne===void 0&&q.indexOf("FlateEncode")!==-1&&(Ne="SLOW"),isNaN(J)||isNaN($))throw new Error("Invalid coordinates passed to jsPDF.addImage");v.call(this);var w=O.call(this,Y,D,de,Ne);return k.call(this,J,$,je,ee,w,Ie),this};var O=function(Y,D,J,$){var je,ee,de;if(typeof Y=="string"&&l(Y)===o){Y=unescape(Y);var Ne=W(Y,!1);(Ne!==""||(Ne=n.loadFile(Y,!0))!==void 0)&&(Y=Ne)}if(M(Y)&&(Y=T(Y,D)),D=l(Y,D),!_(D))throw new Error("addImage does not support files of type '"+D+"', please ensure that a plugin for '"+D+"' support is added.");if(((de=J)==null||de.length===0)&&(J=(function(Ie){return typeof Ie=="string"||Z(Ie)?E(Ie):Z(Ie.data)?E(Ie.data):null})(Y)),(je=F.call(this,J))||(Y instanceof Uint8Array||D==="RGBA"||(ee=Y,Y=G(Y)),je=this["process"+D.toUpperCase()](Y,j.call(this),J,(function(Ie){return Ie&&typeof Ie=="string"&&(Ie=Ie.toUpperCase()),Ie in n.image_compression?Ie:ae.NONE})($),ee)),!je)throw new Error("An unknown error occurred whilst processing the image.");return je},W=n.__addimage__.convertBase64ToBinaryString=function(Y,D){D=typeof D!="boolean"||D;var J,$="";if(typeof Y=="string"){var je;J=(je=ne(Y))!==null&&je!==void 0?je:Y;try{$=ch(J)}catch(ee){if(D)throw U(J)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ee.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return $};n.getImageProperties=function(Y){var D,J,$="";if(M(Y)&&(Y=T(Y)),typeof Y=="string"&&l(Y)===o&&(($=W(Y,!1))===""&&($=n.loadFile(Y)||""),Y=$),J=l(Y),!_(J))throw new Error("addImage does not support files of type '"+J+"', please ensure that a plugin for '"+J+"' support is added.");if(Y instanceof Uint8Array||(Y=G(Y)),!(D=this["process"+J.toUpperCase()](Y)))throw new Error("An unknown error occurred whilst processing the image");return D.fileType=J,D}})(Fn.API),(function(n){var r=function(o){if(o!==void 0&&o!="")return!0};Fn.API.events.push(["addPage",function(o){this.internal.getPageInfo(o.pageNumber).pageContext.annotations=[]}]),n.events.push(["putPage",function(o){for(var s,l,d,b=this.internal.getCoordinateString,p=this.internal.getVerticalCoordinateString,v=this.internal.getPageInfoByObjId(o.objId),m=o.pageContext.annotations,j=!1,_=0;_<m.length&&!j;_++)switch((s=m[_]).type){case"link":(r(s.options.url)||r(s.options.pageNumber))&&(j=!0);break;case"reference":case"text":case"freetext":j=!0}if(j!=0){this.internal.write("/Annots [");for(var M=0;M<m.length;M++){s=m[M];var T=this.internal.pdfEscape,F=this.internal.getEncryptor(o.objId);switch(s.type){case"reference":this.internal.write(" "+s.object.objId+" 0 R ");break;case"text":var P=this.internal.newAdditionalObject(),k=this.internal.newAdditionalObject(),y=this.internal.getEncryptor(P.objId),ae=s.title||"Note";d="<</Type /Annot /Subtype /Text "+(l="/Rect ["+b(s.bounds.x)+" "+p(s.bounds.y+s.bounds.h)+" "+b(s.bounds.x+s.bounds.w)+" "+p(s.bounds.y)+"] ")+"/Contents ("+T(y(s.contents))+")",d+=" /Popup "+k.objId+" 0 R",d+=" /P "+v.objId+" 0 R",d+=" /T ("+T(y(ae))+") >>",P.content=d;var E=P.objId+" 0 R";d="<</Type /Annot /Subtype /Popup "+(l="/Rect ["+b(s.bounds.x+30)+" "+p(s.bounds.y+s.bounds.h)+" "+b(s.bounds.x+s.bounds.w+30)+" "+p(s.bounds.y)+"] ")+" /Parent "+E,s.open&&(d+=" /Open true"),d+=" >>",k.content=d,this.internal.write(P.objId,"0 R",k.objId,"0 R");break;case"freetext":l="/Rect ["+b(s.bounds.x)+" "+p(s.bounds.y)+" "+b(s.bounds.x+s.bounds.w)+" "+p(s.bounds.y+s.bounds.h)+"] ";var U=s.color||"#000000";d="<</Type /Annot /Subtype /FreeText "+l+"/Contents ("+T(F(s.contents))+")",d+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+U+")",d+=" /Border [0 0 0]",d+=" >>",this.internal.write(d);break;case"link":if(s.options.name){var ne=this.annotations._nameMap[s.options.name];s.options.pageNumber=ne.page,s.options.top=ne.y}else s.options.top||(s.options.top=0);if(l="/Rect ["+s.finalBounds.x+" "+s.finalBounds.y+" "+s.finalBounds.w+" "+s.finalBounds.h+"] ",d="",s.options.url)d="<</Type /Annot /Subtype /Link "+l+"/Border [0 0 0] /A <</S /URI /URI ("+T(F(s.options.url))+") >>";else if(s.options.pageNumber)switch(d="<</Type /Annot /Subtype /Link "+l+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(s.options.pageNumber).objId+" 0 R",s.options.magFactor=s.options.magFactor||"XYZ",s.options.magFactor){case"Fit":d+=" /Fit]";break;case"FitH":d+=" /FitH "+s.options.top+"]";break;case"FitV":s.options.left=s.options.left||0,d+=" /FitV "+s.options.left+"]";break;default:var Z=p(s.options.top);s.options.left=s.options.left||0,s.options.zoom===void 0&&(s.options.zoom=0),d+=" /XYZ "+s.options.left+" "+Z+" "+s.options.zoom+"]"}d!=""&&(d+=" >>",this.internal.write(d))}}this.internal.write("]")}}]),n.createAnnotation=function(o){var s=this.internal.getCurrentPageInfo();switch(o.type){case"link":this.link(o.bounds.x,o.bounds.y,o.bounds.w,o.bounds.h,o);break;case"text":case"freetext":s.pageContext.annotations.push(o)}},n.link=function(o,s,l,d,b){var p=this.internal.getCurrentPageInfo(),v=this.internal.getCoordinateString,m=this.internal.getVerticalCoordinateString;p.pageContext.annotations.push({finalBounds:{x:v(o),y:m(s),w:v(o+l),h:m(s+d)},options:b,type:"link"})},n.textWithLink=function(o,s,l,d){var b,p,v=this.getTextWidth(o),m=this.internal.getLineHeight()/this.internal.scaleFactor;if(d.maxWidth!==void 0){p=d.maxWidth;var j=this.splitTextToSize(o,p).length;b=Math.ceil(m*j)}else p=v,b=m;return this.text(o,s,l,d),l+=.2*m,d.align==="center"&&(s-=v/2),d.align==="right"&&(s-=v),this.link(s,l-m,p,b,d),v},n.getTextWidth=function(o){var s=this.internal.getFontSize();return this.getStringUnitWidth(o)*s/this.internal.scaleFactor}})(Fn.API),(function(n){var r={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},o={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},s={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},l=[1570,1571,1573,1575];n.__arabicParser__={};var d=n.__arabicParser__.isInArabicSubstitutionA=function(P){return r[P.charCodeAt(0)]!==void 0},b=n.__arabicParser__.isArabicLetter=function(P){return typeof P=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(P)},p=n.__arabicParser__.isArabicEndLetter=function(P){return b(P)&&d(P)&&r[P.charCodeAt(0)].length<=2},v=n.__arabicParser__.isArabicAlfLetter=function(P){return b(P)&&l.indexOf(P.charCodeAt(0))>=0};n.__arabicParser__.arabicLetterHasIsolatedForm=function(P){return b(P)&&d(P)&&r[P.charCodeAt(0)].length>=1};var m=n.__arabicParser__.arabicLetterHasFinalForm=function(P){return b(P)&&d(P)&&r[P.charCodeAt(0)].length>=2};n.__arabicParser__.arabicLetterHasInitialForm=function(P){return b(P)&&d(P)&&r[P.charCodeAt(0)].length>=3};var j=n.__arabicParser__.arabicLetterHasMedialForm=function(P){return b(P)&&d(P)&&r[P.charCodeAt(0)].length==4},_=n.__arabicParser__.resolveLigatures=function(P){var k=0,y=o,ae="",E=0;for(k=0;k<P.length;k+=1)y[P.charCodeAt(k)]!==void 0?(E++,typeof(y=y[P.charCodeAt(k)])=="number"&&(ae+=String.fromCharCode(y),y=o,E=0),k===P.length-1&&(y=o,ae+=P.charAt(k-(E-1)),k-=E-1,E=0)):(y=o,ae+=P.charAt(k-E),k-=E,E=0);return ae};n.__arabicParser__.isArabicDiacritic=function(P){return P!==void 0&&s[P.charCodeAt(0)]!==void 0};var M=n.__arabicParser__.getCorrectForm=function(P,k,y){return b(P)?d(P)===!1?-1:!m(P)||!b(k)&&!b(y)||!b(y)&&p(k)||p(P)&&!b(k)||p(P)&&v(k)||p(P)&&p(k)?0:j(P)&&b(k)&&!p(k)&&b(y)&&m(y)?3:p(P)||!b(y)?1:2:-1},T=function(P){var k=0,y=0,ae=0,E="",U="",ne="",Z=(P=P||"").split("\\s+"),G=[];for(k=0;k<Z.length;k+=1){for(G.push(""),y=0;y<Z[k].length;y+=1)E=Z[k][y],U=Z[k][y-1],ne=Z[k][y+1],b(E)?(ae=M(E,U,ne),G[k]+=ae!==-1?String.fromCharCode(r[E.charCodeAt(0)][ae]):E):G[k]+=E;G[k]=_(G[k])}return G.join(" ")},F=n.__arabicParser__.processArabic=n.processArabic=function(){var P,k=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,y=[];if(Array.isArray(k)){var ae=0;for(y=[],ae=0;ae<k.length;ae+=1)Array.isArray(k[ae])?y.push([T(k[ae][0]),k[ae][1],k[ae][2]]):y.push([T(k[ae])]);P=y}else P=T(k);return typeof arguments[0]=="string"?P:(arguments[0].text=P,arguments[0])};n.events.push(["preProcessText",F])})(Fn.API),Fn.API.autoPrint=function(n){var r;return(n=n||{}).variant=n.variant||"non-conform",n.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){r=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+r+" 0 R")})),this},(function(n){var r=function(){var o=void 0;Object.defineProperty(this,"pdf",{get:function(){return o},set:function(p){o=p}});var s=150;Object.defineProperty(this,"width",{get:function(){return s},set:function(p){s=isNaN(p)||Number.isInteger(p)===!1||p<0?150:p,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=s+1)}});var l=300;Object.defineProperty(this,"height",{get:function(){return l},set:function(p){l=isNaN(p)||Number.isInteger(p)===!1||p<0?300:p,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=l+1)}});var d=[];Object.defineProperty(this,"childNodes",{get:function(){return d},set:function(p){d=p}});var b={};Object.defineProperty(this,"style",{get:function(){return b},set:function(p){b=p}}),Object.defineProperty(this,"parentNode",{})};r.prototype.getContext=function(o,s){var l;if((o=o||"2d")!=="2d")return null;for(l in s)this.pdf.context2d.hasOwnProperty(l)&&(this.pdf.context2d[l]=s[l]);return this.pdf.context2d._canvas=this,this.pdf.context2d},r.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},n.events.push(["initialized",function(){this.canvas=new r,this.canvas.pdf=this}])})(Fn.API),(function(n){var r={left:0,top:0,bottom:0,right:0},o=!1,s=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},r),this.internal.__cell__.margins.width=this.getPageWidth(),l.call(this))},l=function(){this.internal.__cell__.lastCell=new d,this.internal.__cell__.pages=1},d=function(){var v=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return v},set:function(P){v=P}});var m=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return m},set:function(P){m=P}});var j=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return j},set:function(P){j=P}});var _=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return _},set:function(P){_=P}});var M=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return M},set:function(P){M=P}});var T=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return T},set:function(P){T=P}});var F=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return F},set:function(P){F=P}}),this};d.prototype.clone=function(){return new d(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},d.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},n.setHeaderFunction=function(v){return s.call(this),this.internal.__cell__.headerFunction=typeof v=="function"?v:void 0,this},n.getTextDimensions=function(v,m){s.call(this);var j=(m=m||{}).fontSize||this.getFontSize(),_=m.font||this.getFont(),M=m.scaleFactor||this.internal.scaleFactor,T=0,F=0,P=0,k=this;if(!Array.isArray(v)&&typeof v!="string"){if(typeof v!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");v=String(v)}var y=m.maxWidth;y>0?typeof v=="string"?v=this.splitTextToSize(v,y):Object.prototype.toString.call(v)==="[object Array]"&&(v=v.reduce(function(E,U){return E.concat(k.splitTextToSize(U,y))},[])):v=Array.isArray(v)?v:[v];for(var ae=0;ae<v.length;ae++)T<(P=this.getStringUnitWidth(v[ae],{font:_})*j)&&(T=P);return T!==0&&(F=v.length),{w:T/=M,h:Math.max((F*j*this.getLineHeightFactor()-j*(this.getLineHeightFactor()-1))/M,0)}},n.cellAddPage=function(){s.call(this),this.addPage();var v=this.internal.__cell__.margins||r;return this.internal.__cell__.lastCell=new d(v.left,v.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var b=n.cell=function(){var v;v=arguments[0]instanceof d?arguments[0]:new d(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),s.call(this);var m=this.internal.__cell__.lastCell,j=this.internal.__cell__.padding,_=this.internal.__cell__.margins||r,M=this.internal.__cell__.tableHeaderRow,T=this.internal.__cell__.printHeaders;return m.lineNumber!==void 0&&(m.lineNumber===v.lineNumber?(v.x=(m.x||0)+(m.width||0),v.y=m.y||0):m.y+m.height+v.height+_.bottom>this.getPageHeight()?(this.cellAddPage(),v.y=_.top,T&&M&&(this.printHeaderRow(v.lineNumber,!0),v.y+=M[0].height)):v.y=m.y+m.height||v.y),v.text[0]!==void 0&&(this.rect(v.x,v.y,v.width,v.height,o===!0?"FD":void 0),v.align==="right"?this.text(v.text,v.x+v.width-j,v.y+j,{align:"right",baseline:"top"}):v.align==="center"?this.text(v.text,v.x+v.width/2,v.y+j,{align:"center",baseline:"top",maxWidth:v.width-j-j}):this.text(v.text,v.x+j,v.y+j,{align:"left",baseline:"top",maxWidth:v.width-j-j})),this.internal.__cell__.lastCell=v,this};n.table=function(v,m,j,_,M){if(s.call(this),!j)throw new Error("No data for PDF table.");var T,F,P,k,y=[],ae=[],E=[],U={},ne={},Z=[],G=[],te=(M=M||{}).autoSize||!1,O=M.printHeaders!==!1,W=M.css&&M.css["font-size"]!==void 0?16*M.css["font-size"]:M.fontSize||12,Y=M.margins||Object.assign({width:this.getPageWidth()},r),D=typeof M.padding=="number"?M.padding:3,J=M.headerBackgroundColor||"#c8c8c8",$=M.headerTextColor||"#000";if(l.call(this),this.internal.__cell__.printHeaders=O,this.internal.__cell__.margins=Y,this.internal.__cell__.table_font_size=W,this.internal.__cell__.padding=D,this.internal.__cell__.headerBackgroundColor=J,this.internal.__cell__.headerTextColor=$,this.setFontSize(W),_==null)ae=y=Object.keys(j[0]),E=y.map(function(){return"left"});else if(Array.isArray(_)&&Hr(_[0])==="object")for(y=_.map(function($e){return $e.name}),ae=_.map(function($e){return $e.prompt||$e.name||""}),E=_.map(function($e){return $e.align||"left"}),T=0;T<_.length;T+=1)ne[_[T].name]=.7499990551181103*_[T].width;else Array.isArray(_)&&typeof _[0]=="string"&&(ae=y=_,E=y.map(function(){return"left"}));if(te||Array.isArray(_)&&typeof _[0]=="string")for(T=0;T<y.length;T+=1){for(U[k=y[T]]=j.map(function($e){return $e[k]}),this.setFont(void 0,"bold"),Z.push(this.getTextDimensions(ae[T],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),F=U[k],this.setFont(void 0,"normal"),P=0;P<F.length;P+=1)Z.push(this.getTextDimensions(F[P],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);ne[k]=Math.max.apply(null,Z)+D+D,Z=[]}if(O){var je={};for(T=0;T<y.length;T+=1)je[y[T]]={},je[y[T]].text=ae[T],je[y[T]].align=E[T];var ee=p.call(this,je,ne);G=y.map(function($e){return new d(v,m,ne[$e],ee,je[$e].text,void 0,je[$e].align)}),this.setTableHeaderRow(G),this.printHeaderRow(1,!1)}var de=_.reduce(function($e,q){return $e[q.name]=q.align,$e},{});for(T=0;T<j.length;T+=1){"rowStart"in M&&M.rowStart instanceof Function&&M.rowStart({row:T,data:j[T]},this);var Ne=p.call(this,j[T],ne);for(P=0;P<y.length;P+=1){var Ie=j[T][y[P]];"cellStart"in M&&M.cellStart instanceof Function&&M.cellStart({row:T,col:P,data:Ie},this),b.call(this,new d(v,m,ne[y[P]],Ne,Ie,T+2,de[y[P]]))}}return this.internal.__cell__.table_x=v,this.internal.__cell__.table_y=m,this};var p=function(v,m){var j=this.internal.__cell__.padding,_=this.internal.__cell__.table_font_size,M=this.internal.scaleFactor;return Object.keys(v).map(function(T){var F=v[T];return this.splitTextToSize(F.hasOwnProperty("text")?F.text:F,m[T]-j-j)},this).map(function(T){return this.getLineHeightFactor()*T.length*_/M+j+j},this).reduce(function(T,F){return Math.max(T,F)},0)};n.setTableHeaderRow=function(v){s.call(this),this.internal.__cell__.tableHeaderRow=v},n.printHeaderRow=function(v,m){if(s.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var j;if(o=!0,typeof this.internal.__cell__.headerFunction=="function"){var _=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new d(_[0],_[1],_[2],_[3],void 0,-1)}this.setFont(void 0,"bold");for(var M=[],T=0;T<this.internal.__cell__.tableHeaderRow.length;T+=1){j=this.internal.__cell__.tableHeaderRow[T].clone(),m&&(j.y=this.internal.__cell__.margins.top||0,M.push(j)),j.lineNumber=v;var F=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),b.call(this,j),this.setTextColor(F)}M.length>0&&this.setTableHeaderRow(M),this.setFont(void 0,"normal"),o=!1}})(Fn.API);var Kx={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Zx=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],a0=Xx(Zx),Jx=[100,200,300,400,500,600,700,800,900],P5=Xx(Jx);function Fg(n){var r=n.family.replace(/"|'/g,"").toLowerCase(),o=(function(d){return Kx[d=d||"normal"]?d:"normal"})(n.style),s=(function(d){return d?typeof d=="number"?d>=100&&d<=900&&d%100==0?d:400:/^\d00$/.test(d)?parseInt(d):d==="bold"?700:400:400})(n.weight),l=(function(d){return typeof a0[d=d||"normal"]=="number"?d:"normal"})(n.stretch);return{family:r,style:o,weight:s,stretch:l,src:n.src||[],ref:n.ref||{name:r,style:[l,o,s].join(" ")}}}function Dy(n,r,o,s){var l;for(l=o;l>=0&&l<r.length;l+=s)if(n[r[l]])return n[r[l]];for(l=o;l>=0&&l<r.length;l-=s)if(n[r[l]])return n[r[l]]}var z5={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Ry={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Iy(n){return[n.stretch,n.style,n.weight,n.family].join(" ")}function Ly(n){return n.trimLeft()}function _5(n,r){for(var o=0;o<n.length;){if(n.charAt(o)===r)return[n.substring(0,o),n.substring(o+1)];o+=1}return null}function D5(n){var r=n.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return r===null?null:[r[0],n.substring(r[0].length)]}var ah,My,By,af,sh,Oy,Fy,Uy,Ug=["times"];function Ey(n,r,o,s,l){var d=4,b=qy;switch(l){case Fn.API.image_compression.FAST:d=1,b=Vy;break;case Fn.API.image_compression.MEDIUM:d=6,b=Hy;break;case Fn.API.image_compression.SLOW:d=9,b=Wy}n=(function(v,m,j,_){for(var M,T=v.length/m,F=new Uint8Array(v.length+T),P=[R5,Vy,qy,Hy,Wy],k=0;k<T;k+=1){var y=k*m,ae=v.subarray(y,y+m);if(_)F.set(_(ae,j,M),y+k);else{for(var E=P.length,U=[],ne=0;ne<E;ne+=1)U[ne]=P[ne](ae,j,M);var Z=L5(U.concat());F.set(U[Z],y+k)}M=ae}return F})(n,r,Math.ceil(o*s/8),b);var p=Qg(n,{level:d});return Fn.API.__addimage__.arrayBufferToBinaryString(p)}function R5(n){var r=Array.apply([],n);return r.unshift(0),r}function Vy(n,r){var o=n.length,s=[];s[0]=1;for(var l=0;l<o;l+=1){var d=n[l-r]||0;s[l+1]=n[l]-d+256&255}return s}function qy(n,r,o){var s=n.length,l=[];l[0]=2;for(var d=0;d<s;d+=1){var b=o&&o[d]||0;l[d+1]=n[d]-b+256&255}return l}function Hy(n,r,o){var s=n.length,l=[];l[0]=3;for(var d=0;d<s;d+=1){var b=n[d-r]||0,p=o&&o[d]||0;l[d+1]=n[d]+256-(b+p>>>1)&255}return l}function Wy(n,r,o){var s=n.length,l=[];l[0]=4;for(var d=0;d<s;d+=1){var b=I5(n[d-r]||0,o&&o[d]||0,o&&o[d-r]||0);l[d+1]=n[d]-b+256&255}return l}function I5(n,r,o){if(n===r&&r===o)return n;var s=Math.abs(r-o),l=Math.abs(n-o),d=Math.abs(n+r-o-o);return s<=l&&s<=d?n:l<=d?r:o}function L5(n){var r=n.map(function(o){return o.reduce(function(s,l){return s+Math.abs(l)},0)});return r.indexOf(Math.min.apply(null,r))}function Eg(n,r,o){var s=r*o,l=Math.floor(s/8),d=16-(s-8*l+o),b=(1<<o)-1;return Qx(n,l)>>d&b}function $y(n,r,o,s){var l=o*s,d=Math.floor(l/8),b=16-(l-8*d+s),p=(1<<s)-1,v=(r&p)<<b;(function(m,j,_){if(j+1<m.byteLength)m.setUint16(j,_,!1);else{var M=_>>8&255;m.setUint8(j,M)}})(n,d,Qx(n,d)&~(p<<b)&65535|v)}function Qx(n,r){return r+1<n.byteLength?n.getUint16(r,!1):n.getUint8(r)<<8}function M5(n){var r=0;if(n[r++]!==71||n[r++]!==73||n[r++]!==70||n[r++]!==56||(n[r++]+1&253)!=56||n[r++]!==97)throw new Error("Invalid GIF 87a/89a header.");var o=n[r++]|n[r++]<<8,s=n[r++]|n[r++]<<8,l=n[r++],d=l>>7,b=1<<1+(7&l);n[r++],n[r++];var p=null,v=null;d&&(p=r,v=b,r+=3*b);var m=!0,j=[],_=0,M=null,T=0,F=null;for(this.width=o,this.height=s;m&&r<n.length;)switch(n[r++]){case 33:switch(n[r++]){case 255:if(n[r]!==11||n[r+1]==78&&n[r+2]==69&&n[r+3]==84&&n[r+4]==83&&n[r+5]==67&&n[r+6]==65&&n[r+7]==80&&n[r+8]==69&&n[r+9]==50&&n[r+10]==46&&n[r+11]==48&&n[r+12]==3&&n[r+13]==1&&n[r+16]==0)r+=14,F=n[r++]|n[r++]<<8,r++;else for(r+=12;;){if(!((Y=n[r++])>=0))throw Error("Invalid block size");if(Y===0)break;r+=Y}break;case 249:if(n[r++]!==4||n[r+4]!==0)throw new Error("Invalid graphics extension block.");var P=n[r++];_=n[r++]|n[r++]<<8,M=n[r++],1&P||(M=null),T=P>>2&7,r++;break;case 254:for(;;){if(!((Y=n[r++])>=0))throw Error("Invalid block size");if(Y===0)break;r+=Y}break;default:throw new Error("Unknown graphic control label: 0x"+n[r-1].toString(16))}break;case 44:var k=n[r++]|n[r++]<<8,y=n[r++]|n[r++]<<8,ae=n[r++]|n[r++]<<8,E=n[r++]|n[r++]<<8,U=n[r++],ne=U>>6&1,Z=1<<1+(7&U),G=p,te=v,O=!1;U>>7&&(O=!0,G=r,te=Z,r+=3*Z);var W=r;for(r++;;){var Y;if(!((Y=n[r++])>=0))throw Error("Invalid block size");if(Y===0)break;r+=Y}j.push({x:k,y,width:ae,height:E,has_local_palette:O,palette_offset:G,palette_size:te,data_offset:W,data_length:r-W,transparent_index:M,interlaced:!!ne,delay:_,disposal:T});break;case 59:m=!1;break;default:throw new Error("Unknown gif block: 0x"+n[r-1].toString(16))}this.numFrames=function(){return j.length},this.loopCount=function(){return F},this.frameInfo=function(D){if(D<0||D>=j.length)throw new Error("Frame index out of range.");return j[D]},this.decodeAndBlitFrameBGRA=function(D,J){var $=this.frameInfo(D),je=$.width*$.height,ee=new Uint8Array(je);Yy(n,$.data_offset,ee,je);var de=$.palette_offset,Ne=$.transparent_index;Ne===null&&(Ne=256);var Ie=$.width,$e=o-Ie,q=Ie,w=4*($.y*o+$.x),V=4*(($.y+$.height)*o+$.x),H=w,ue=4*$e;$.interlaced===!0&&(ue+=4*o*7);for(var ve=8,se=0,ze=ee.length;se<ze;++se){var xe=ee[se];if(q===0&&(q=Ie,(H+=ue)>=V&&(ue=4*$e+4*o*(ve-1),H=w+(Ie+$e)*(ve<<1),ve>>=1)),xe===Ne)H+=4;else{var De=n[de+3*xe],Ye=n[de+3*xe+1],lt=n[de+3*xe+2];J[H++]=lt,J[H++]=Ye,J[H++]=De,J[H++]=255}--q}},this.decodeAndBlitFrameRGBA=function(D,J){var $=this.frameInfo(D),je=$.width*$.height,ee=new Uint8Array(je);Yy(n,$.data_offset,ee,je);var de=$.palette_offset,Ne=$.transparent_index;Ne===null&&(Ne=256);var Ie=$.width,$e=o-Ie,q=Ie,w=4*($.y*o+$.x),V=4*(($.y+$.height)*o+$.x),H=w,ue=4*$e;$.interlaced===!0&&(ue+=4*o*7);for(var ve=8,se=0,ze=ee.length;se<ze;++se){var xe=ee[se];if(q===0&&(q=Ie,(H+=ue)>=V&&(ue=4*$e+4*o*(ve-1),H=w+(Ie+$e)*(ve<<1),ve>>=1)),xe===Ne)H+=4;else{var De=n[de+3*xe],Ye=n[de+3*xe+1],lt=n[de+3*xe+2];J[H++]=De,J[H++]=Ye,J[H++]=lt,J[H++]=255}--q}}}function Yy(n,r,o,s){for(var l=n[r++],d=1<<l,b=d+1,p=b+1,v=l+1,m=(1<<v)-1,j=0,_=0,M=0,T=n[r++],F=new Int32Array(4096),P=null;;){for(;j<16&&T!==0;)_|=n[r++]<<j,j+=8,T===1?T=n[r++]:--T;if(j<v)break;var k=_&m;if(_>>=v,j-=v,k!==d){if(k===b)break;for(var y=k<p?k:P,ae=0,E=y;E>d;)E=F[E]>>8,++ae;var U=E;if(M+ae+(y!==k?1:0)>s)return void co.log("Warning, gif stream longer than expected.");o[M++]=U;var ne=M+=ae;for(y!==k&&(o[M++]=U),E=y;ae--;)E=F[E],o[--ne]=255&E,E>>=8;P!==null&&p<4096&&(F[p++]=P<<8|U,p>=m+1&&v<12&&(++v,m=m<<1|1)),P=k}else p=b+1,m=(1<<(v=l+1))-1,P=null}return M!==s&&co.log("Warning, gif stream shorter than expected."),o}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Vg(n){var r,o,s,l,d,b=Math.floor,p=new Array(64),v=new Array(64),m=new Array(64),j=new Array(64),_=new Array(65535),M=new Array(65535),T=new Array(64),F=new Array(64),P=[],k=0,y=7,ae=new Array(64),E=new Array(64),U=new Array(64),ne=new Array(256),Z=new Array(2048),G=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],te=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],O=[0,1,2,3,4,5,6,7,8,9,10,11],W=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],Y=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],D=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],J=[0,1,2,3,4,5,6,7,8,9,10,11],$=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],je=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ee(w,V){for(var H=0,ue=0,ve=new Array,se=1;se<=16;se++){for(var ze=1;ze<=w[se];ze++)ve[V[ue]]=[],ve[V[ue]][0]=H,ve[V[ue]][1]=se,ue++,H++;H*=2}return ve}function de(w){for(var V=w[0],H=w[1]-1;H>=0;)V&1<<H&&(k|=1<<y),H--,--y<0&&(k==255?(Ne(255),Ne(0)):Ne(k),y=7,k=0)}function Ne(w){P.push(w)}function Ie(w){Ne(w>>8&255),Ne(255&w)}function $e(w,V,H,ue,ve){for(var se,ze=ve[0],xe=ve[240],De=(function(ht,fn){var Yt,ln,cn,Sn,mn,tt,Bt,Gt,an,dt,Mt=0;for(an=0;an<8;++an){Yt=ht[Mt],ln=ht[Mt+1],cn=ht[Mt+2],Sn=ht[Mt+3],mn=ht[Mt+4],tt=ht[Mt+5],Bt=ht[Mt+6];var Me=Yt+(Gt=ht[Mt+7]),we=Yt-Gt,st=ln+Bt,et=ln-Bt,Pt=cn+tt,Rt=cn-tt,Ge=Sn+mn,zt=Sn-mn,Tt=Me+Ge,tn=Me-Ge,Xt=st+Pt,pn=st-Pt;ht[Mt]=Tt+Xt,ht[Mt+4]=Tt-Xt;var ti=.707106781*(pn+tn);ht[Mt+2]=tn+ti,ht[Mt+6]=tn-ti;var Go=.382683433*((Tt=zt+Rt)-(pn=et+we)),zn=.5411961*Tt+Go,Bi=1.306562965*pn+Go,ni=.707106781*(Xt=Rt+et),nn=we+ni,xi=we-ni;ht[Mt+5]=xi+zn,ht[Mt+3]=xi-zn,ht[Mt+1]=nn+Bi,ht[Mt+7]=nn-Bi,Mt+=8}for(Mt=0,an=0;an<8;++an){Yt=ht[Mt],ln=ht[Mt+8],cn=ht[Mt+16],Sn=ht[Mt+24],mn=ht[Mt+32],tt=ht[Mt+40],Bt=ht[Mt+48];var hi=Yt+(Gt=ht[Mt+56]),fr=Yt-Gt,zr=ln+Bt,or=ln-Bt,xt=cn+tt,Yn=cn-tt,ui=Sn+mn,Si=Sn-mn,ut=hi+ui,Et=hi-ui,En=zr+xt,Zt=zr-xt;ht[Mt]=ut+En,ht[Mt+32]=ut-En;var Vn=.707106781*(Zt+Et);ht[Mt+16]=Et+Vn,ht[Mt+48]=Et-Vn;var Ti=.382683433*((ut=Si+Yn)-(Zt=or+fr)),_i=.5411961*ut+Ti,mr=1.306562965*Zt+Ti,mi=.707106781*(En=Yn+or),pr=fr+mi,Ci=fr-mi;ht[Mt+40]=Ci+_i,ht[Mt+24]=Ci-_i,ht[Mt+8]=pr+mr,ht[Mt+56]=pr-mr,Mt++}for(an=0;an<64;++an)dt=ht[an]*fn[an],T[an]=dt>0?dt+.5|0:dt-.5|0;return T})(w,V),Ye=0;Ye<64;++Ye)F[G[Ye]]=De[Ye];var lt=F[0]-H;H=F[0],lt==0?de(ue[0]):(de(ue[M[se=32767+lt]]),de(_[se]));for(var St=63;St>0&&F[St]==0;)St--;if(St==0)return de(ze),H;for(var Wt,ge=1;ge<=St;){for(var Ot=ge;F[ge]==0&&ge<=St;)++ge;var _t=ge-Ot;if(_t>=16){Wt=_t>>4;for(var qt=1;qt<=Wt;++qt)de(xe);_t&=15}se=32767+F[ge],de(ve[(_t<<4)+M[se]]),de(_[se]),ge++}return St!=63&&de(ze),H}function q(w){w=Math.min(Math.max(w,1),100),d!=w&&((function(V){for(var H=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],ue=0;ue<64;ue++){var ve=b((H[ue]*V+50)/100);ve=Math.min(Math.max(ve,1),255),p[G[ue]]=ve}for(var se=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ze=0;ze<64;ze++){var xe=b((se[ze]*V+50)/100);xe=Math.min(Math.max(xe,1),255),v[G[ze]]=xe}for(var De=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ye=0,lt=0;lt<8;lt++)for(var St=0;St<8;St++)m[Ye]=1/(p[G[Ye]]*De[lt]*De[St]*8),j[Ye]=1/(v[G[Ye]]*De[lt]*De[St]*8),Ye++})(w<50?Math.floor(5e3/w):Math.floor(200-2*w)),d=w)}this.encode=function(w,V){V&&q(V),P=new Array,k=0,y=7,Ie(65496),Ie(65504),Ie(16),Ne(74),Ne(70),Ne(73),Ne(70),Ne(0),Ne(1),Ne(1),Ne(0),Ie(1),Ie(1),Ne(0),Ne(0),(function(){Ie(65499),Ie(132),Ne(0);for(var ln=0;ln<64;ln++)Ne(p[ln]);Ne(1);for(var cn=0;cn<64;cn++)Ne(v[cn])})(),(function(ln,cn){Ie(65472),Ie(17),Ne(8),Ie(cn),Ie(ln),Ne(3),Ne(1),Ne(17),Ne(0),Ne(2),Ne(17),Ne(1),Ne(3),Ne(17),Ne(1)})(w.width,w.height),(function(){Ie(65476),Ie(418),Ne(0);for(var ln=0;ln<16;ln++)Ne(te[ln+1]);for(var cn=0;cn<=11;cn++)Ne(O[cn]);Ne(16);for(var Sn=0;Sn<16;Sn++)Ne(W[Sn+1]);for(var mn=0;mn<=161;mn++)Ne(Y[mn]);Ne(1);for(var tt=0;tt<16;tt++)Ne(D[tt+1]);for(var Bt=0;Bt<=11;Bt++)Ne(J[Bt]);Ne(17);for(var Gt=0;Gt<16;Gt++)Ne($[Gt+1]);for(var an=0;an<=161;an++)Ne(je[an])})(),Ie(65498),Ie(12),Ne(3),Ne(1),Ne(0),Ne(2),Ne(17),Ne(3),Ne(17),Ne(0),Ne(63),Ne(0);var H=0,ue=0,ve=0;k=0,y=7,this.encode.displayName="_encode_";for(var se,ze,xe,De,Ye,lt,St,Wt,ge,Ot=w.data,_t=w.width,qt=w.height,ht=4*_t,fn=0;fn<qt;){for(se=0;se<ht;){for(Ye=ht*fn+se,St=-1,Wt=0,ge=0;ge<64;ge++)lt=Ye+(Wt=ge>>3)*ht+(St=4*(7&ge)),fn+Wt>=qt&&(lt-=ht*(fn+1+Wt-qt)),se+St>=ht&&(lt-=se+St-ht+4),ze=Ot[lt++],xe=Ot[lt++],De=Ot[lt++],ae[ge]=(Z[ze]+Z[xe+256|0]+Z[De+512|0]>>16)-128,E[ge]=(Z[ze+768|0]+Z[xe+1024|0]+Z[De+1280|0]>>16)-128,U[ge]=(Z[ze+1280|0]+Z[xe+1536|0]+Z[De+1792|0]>>16)-128;H=$e(ae,m,H,r,s),ue=$e(E,j,ue,o,l),ve=$e(U,j,ve,o,l),se+=32}fn+=8}if(y>=0){var Yt=[];Yt[1]=y+1,Yt[0]=(1<<y+1)-1,de(Yt)}return Ie(65497),new Uint8Array(P)},n=n||50,(function(){for(var w=String.fromCharCode,V=0;V<256;V++)ne[V]=w(V)})(),r=ee(te,O),o=ee(D,J),s=ee(W,Y),l=ee($,je),(function(){for(var w=1,V=2,H=1;H<=15;H++){for(var ue=w;ue<V;ue++)M[32767+ue]=H,_[32767+ue]=[],_[32767+ue][1]=H,_[32767+ue][0]=ue;for(var ve=-(V-1);ve<=-w;ve++)M[32767+ve]=H,_[32767+ve]=[],_[32767+ve][1]=H,_[32767+ve][0]=V-1+ve;w<<=1,V<<=1}})(),(function(){for(var w=0;w<256;w++)Z[w]=19595*w,Z[w+256|0]=38470*w,Z[w+512|0]=7471*w+32768,Z[w+768|0]=-11059*w,Z[w+1024|0]=-21709*w,Z[w+1280|0]=32768*w+8421375,Z[w+1536|0]=-27439*w,Z[w+1792|0]=-5329*w})(),q(n)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Nc(n,r){if(this.pos=0,this.buffer=n,this.datav=new DataView(n.buffer),this.is_with_alpha=!!r,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Gy(n){function r(O){if(!O)throw Error("assert :P")}function o(O,W,Y){for(var D=0;4>D;D++)if(O[W+D]!=Y.charCodeAt(D))return!0;return!1}function s(O,W,Y,D,J){for(var $=0;$<J;$++)O[W+$]=Y[D+$]}function l(O,W,Y,D){for(var J=0;J<D;J++)O[W+J]=Y}function d(O){return new Int32Array(O)}function b(O,W){for(var Y=[],D=0;D<O;D++)Y.push(new W);return Y}function p(O,W){var Y=[];return(function D(J,$,je){for(var ee=je[$],de=0;de<ee&&(J.push(je.length>$+1?[]:new W),!(je.length<$+1));de++)D(J[de],$+1,je)})(Y,0,O),Y}var v=function(){var O=this;function W(f,x){for(var N=1<<x-1>>>0;f&N;)N>>>=1;return N?(f&N-1)+N:f}function Y(f,x,N,R,X){r(!(R%N));do f[x+(R-=N)]=X;while(0<R)}function D(f,x,N,R,X){if(r(2328>=X),512>=X)var ie=d(512);else if((ie=d(X))==null)return 0;return(function(re,le,he,Te,Ee,Xe){var fe,Re,Je=le,pt=1<<he,Qe=d(16),yt=d(16);for(r(Ee!=0),r(Te!=null),r(re!=null),r(0<he),Re=0;Re<Ee;++Re){if(15<Te[Re])return 0;++Qe[Te[Re]]}if(Qe[0]==Ee)return 0;for(yt[1]=0,fe=1;15>fe;++fe){if(Qe[fe]>1<<fe)return 0;yt[fe+1]=yt[fe]+Qe[fe]}for(Re=0;Re<Ee;++Re)fe=Te[Re],0<Te[Re]&&(Xe[yt[fe]++]=Re);if(yt[15]==1)return(Te=new J).g=0,Te.value=Xe[0],Y(re,Je,1,pt,Te),pt;var vt,Ft=-1,Nt=pt-1,bn=0,gn=1,ri=1,xn=1<<he;for(Re=0,fe=1,Ee=2;fe<=he;++fe,Ee<<=1){if(gn+=ri<<=1,0>(ri-=Qe[fe]))return 0;for(;0<Qe[fe];--Qe[fe])(Te=new J).g=fe,Te.value=Xe[Re++],Y(re,Je+bn,Ee,xn,Te),bn=W(bn,fe)}for(fe=he+1,Ee=2;15>=fe;++fe,Ee<<=1){if(gn+=ri<<=1,0>(ri-=Qe[fe]))return 0;for(;0<Qe[fe];--Qe[fe]){if(Te=new J,(bn&Nt)!=Ft){for(Je+=xn,vt=1<<(Ft=fe)-he;15>Ft&&!(0>=(vt-=Qe[Ft]));)++Ft,vt<<=1;pt+=xn=1<<(vt=Ft-he),re[le+(Ft=bn&Nt)].g=vt+he,re[le+Ft].value=Je-le-Ft}Te.g=fe-he,Te.value=Xe[Re++],Y(re,Je+(bn>>he),Ee,xn,Te),bn=W(bn,fe)}}return gn!=2*yt[15]-1?0:pt})(f,x,N,R,X,ie)}function J(){this.value=this.g=0}function $(){this.value=this.g=0}function je(){this.G=b(5,J),this.H=d(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=b(ho,$)}function ee(f,x,N,R){r(f!=null),r(x!=null),r(2147483648>R),f.Ca=254,f.I=0,f.b=-8,f.Ka=0,f.oa=x,f.pa=N,f.Jd=x,f.Yc=N+R,f.Zc=4<=R?N+R-4+1:N,ze(f)}function de(f,x){for(var N=0;0<x--;)N|=De(f,128)<<x;return N}function Ne(f,x){var N=de(f,x);return xe(f)?-N:N}function Ie(f,x,N,R){var X,ie=0;for(r(f!=null),r(x!=null),r(4294967288>R),f.Sb=R,f.Ra=0,f.u=0,f.h=0,4<R&&(R=4),X=0;X<R;++X)ie+=x[N+X]<<8*X;f.Ra=ie,f.bb=R,f.oa=x,f.pa=N}function $e(f){for(;8<=f.u&&f.bb<f.Sb;)f.Ra>>>=8,f.Ra+=f.oa[f.pa+f.bb]<<Ds-8>>>0,++f.bb,f.u-=8;ue(f)&&(f.h=1,f.u=0)}function q(f,x){if(r(0<=x),!f.h&&x<=$r){var N=H(f)&Fo[x];return f.u+=x,$e(f),N}return f.h=1,f.u=0}function w(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function V(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function H(f){return f.Ra>>>(f.u&Ds-1)>>>0}function ue(f){return r(f.bb<=f.Sb),f.h||f.bb==f.Sb&&f.u>Ds}function ve(f,x){f.u=x,f.h=ue(f)}function se(f){f.u>=Qo&&(r(f.u>=Qo),$e(f))}function ze(f){r(f!=null&&f.oa!=null),f.pa<f.Zc?(f.I=(f.oa[f.pa++]|f.I<<8)>>>0,f.b+=8):(r(f!=null&&f.oa!=null),f.pa<f.Yc?(f.b+=8,f.I=f.oa[f.pa++]|f.I<<8):f.Ka?f.b=0:(f.I<<=8,f.b+=8,f.Ka=1))}function xe(f){return de(f,1)}function De(f,x){var N=f.Ca;0>f.b&&ze(f);var R=f.b,X=N*x>>>8,ie=(f.I>>>R>X)+0;for(ie?(N-=X,f.I-=X+1<<R>>>0):N=X+1,R=N,X=0;256<=R;)X+=8,R>>=8;return R=7^X+Xs[R],f.b-=R,f.Ca=(N<<R)-1,ie}function Ye(f,x,N){f[x+0]=N>>24&255,f[x+1]=N>>16&255,f[x+2]=N>>8&255,f[x+3]=255&N}function lt(f,x){return f[x+0]|f[x+1]<<8}function St(f,x){return lt(f,x)|f[x+2]<<16}function Wt(f,x){return lt(f,x)|lt(f,x+2)<<16}function ge(f,x){var N=1<<x;return r(f!=null),r(0<x),f.X=d(N),f.X==null?0:(f.Mb=32-x,f.Xa=x,1)}function Ot(f,x){r(f!=null),r(x!=null),r(f.Xa==x.Xa),s(x.X,0,f.X,0,1<<x.Xa)}function _t(){this.X=[],this.Xa=this.Mb=0}function qt(f,x,N,R){r(N!=null),r(R!=null);var X=N[0],ie=R[0];return X==0&&(X=(f*ie+x/2)/x),ie==0&&(ie=(x*X+f/2)/f),0>=X||0>=ie?0:(N[0]=X,R[0]=ie,1)}function ht(f,x){return f+(1<<x)-1>>>x}function fn(f,x){return((4278255360&f)+(4278255360&x)>>>0&4278255360)+((16711935&f)+(16711935&x)>>>0&16711935)>>>0}function Yt(f,x){O[x]=function(N,R,X,ie,re,le,he){var Te;for(Te=0;Te<re;++Te){var Ee=O[f](le[he+Te-1],X,ie+Te);le[he+Te]=fn(N[R+Te],Ee)}}}function ln(){this.ud=this.hd=this.jd=0}function cn(f,x){return((4278124286&(f^x))>>>1)+(f&x)>>>0}function Sn(f){return 0<=f&&256>f?f:0>f?0:255<f?255:void 0}function mn(f,x){return Sn(f+(f-x+.5>>1))}function tt(f,x,N){return Math.abs(x-N)-Math.abs(f-N)}function Bt(f,x,N,R,X,ie,re){for(R=ie[re-1],N=0;N<X;++N)ie[re+N]=R=fn(f[x+N],R)}function Gt(f,x,N,R,X){var ie;for(ie=0;ie<N;++ie){var re=f[x+ie],le=re>>8&255,he=16711935&(he=(he=16711935&re)+((le<<16)+le));R[X+ie]=(4278255360&re)+he>>>0}}function an(f,x){x.jd=255&f,x.hd=f>>8&255,x.ud=f>>16&255}function dt(f,x,N,R,X,ie){var re;for(re=0;re<R;++re){var le=x[N+re],he=le>>>8,Te=le,Ee=255&(Ee=(Ee=le>>>16)+((f.jd<<24>>24)*(he<<24>>24)>>>5));Te=255&(Te=(Te+=(f.hd<<24>>24)*(he<<24>>24)>>>5)+((f.ud<<24>>24)*(Ee<<24>>24)>>>5)),X[ie+re]=(4278255360&le)+(Ee<<16)+Te}}function Mt(f,x,N,R,X){O[x]=function(ie,re,le,he,Te,Ee,Xe,fe,Re){for(he=Xe;he<fe;++he)for(Xe=0;Xe<Re;++Xe)Te[Ee++]=X(le[R(ie[re++])])},O[f]=function(ie,re,le,he,Te,Ee,Xe){var fe=8>>ie.b,Re=ie.Ea,Je=ie.K[0],pt=ie.w;if(8>fe)for(ie=(1<<ie.b)-1,pt=(1<<fe)-1;re<le;++re){var Qe,yt=0;for(Qe=0;Qe<Re;++Qe)Qe&ie||(yt=R(he[Te++])),Ee[Xe++]=X(Je[yt&pt]),yt>>=fe}else O["VP8LMapColor"+N](he,Te,Je,pt,Ee,Xe,re,le,Re)}}function Me(f,x,N,R,X){for(N=x+N;x<N;){var ie=f[x++];R[X++]=ie>>16&255,R[X++]=ie>>8&255,R[X++]=255&ie}}function we(f,x,N,R,X){for(N=x+N;x<N;){var ie=f[x++];R[X++]=ie>>16&255,R[X++]=ie>>8&255,R[X++]=255&ie,R[X++]=ie>>24&255}}function st(f,x,N,R,X){for(N=x+N;x<N;){var ie=(re=f[x++])>>16&240|re>>12&15,re=240&re|re>>28&15;R[X++]=ie,R[X++]=re}}function et(f,x,N,R,X){for(N=x+N;x<N;){var ie=(re=f[x++])>>16&248|re>>13&7,re=re>>5&224|re>>3&31;R[X++]=ie,R[X++]=re}}function Pt(f,x,N,R,X){for(N=x+N;x<N;){var ie=f[x++];R[X++]=255&ie,R[X++]=ie>>8&255,R[X++]=ie>>16&255}}function Rt(f,x,N,R,X,ie){if(ie==0)for(N=x+N;x<N;)Ye(R,((ie=f[x++])[0]>>24|ie[1]>>8&65280|ie[2]<<8&16711680|ie[3]<<24)>>>0),X+=32;else s(R,X,f,x,N)}function Ge(f,x){O[x][0]=O[f+"0"],O[x][1]=O[f+"1"],O[x][2]=O[f+"2"],O[x][3]=O[f+"3"],O[x][4]=O[f+"4"],O[x][5]=O[f+"5"],O[x][6]=O[f+"6"],O[x][7]=O[f+"7"],O[x][8]=O[f+"8"],O[x][9]=O[f+"9"],O[x][10]=O[f+"10"],O[x][11]=O[f+"11"],O[x][12]=O[f+"12"],O[x][13]=O[f+"13"],O[x][14]=O[f+"0"],O[x][15]=O[f+"0"]}function zt(f){return f==os||f==na||f==pl||f==ou}function Tt(){this.eb=[],this.size=this.A=this.fb=0}function tn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Xt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Tt,this.f.kb=new tn,this.sd=null}function pn(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function ti(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Go(f){return alert("todo:WebPSamplerProcessPlane"),f.T}function zn(f,x){var N=f.T,R=x.ba.f.RGBA,X=R.eb,ie=R.fb+f.ka*R.A,re=Gr[x.ba.S],le=f.y,he=f.O,Te=f.f,Ee=f.N,Xe=f.ea,fe=f.W,Re=x.cc,Je=x.dc,pt=x.Mc,Qe=x.Nc,yt=f.ka,vt=f.ka+f.T,Ft=f.U,Nt=Ft+1>>1;for(yt==0?re(le,he,null,null,Te,Ee,Xe,fe,Te,Ee,Xe,fe,X,ie,null,null,Ft):(re(x.ec,x.fc,le,he,Re,Je,pt,Qe,Te,Ee,Xe,fe,X,ie-R.A,X,ie,Ft),++N);yt+2<vt;yt+=2)Re=Te,Je=Ee,pt=Xe,Qe=fe,Ee+=f.Rc,fe+=f.Rc,ie+=2*R.A,re(le,(he+=2*f.fa)-f.fa,le,he,Re,Je,pt,Qe,Te,Ee,Xe,fe,X,ie-R.A,X,ie,Ft);return he+=f.fa,f.j+vt<f.o?(s(x.ec,x.fc,le,he,Ft),s(x.cc,x.dc,Te,Ee,Nt),s(x.Mc,x.Nc,Xe,fe,Nt),N--):1&vt||re(le,he,null,null,Te,Ee,Xe,fe,Te,Ee,Xe,fe,X,ie+R.A,null,null,Ft),N}function Bi(f,x,N){var R=f.F,X=[f.J];if(R!=null){var ie=f.U,re=x.ba.S,le=re==ro||re==pl;x=x.ba.f.RGBA;var he=[0],Te=f.ka;he[0]=f.T,f.Kb&&(Te==0?--he[0]:(--Te,X[0]-=f.width),f.j+f.ka+f.T==f.o&&(he[0]=f.o-f.j-Te));var Ee=x.eb;Te=x.fb+Te*x.A,f=no(R,X[0],f.width,ie,he,Ee,Te+(le?0:3),x.A),r(N==he),f&&zt(re)&&wo(Ee,Te,le,ie,he,x.A)}return 0}function ni(f){var x=f.ma,N=x.ba.S,R=11>N,X=N==Ai||N==br||N==ro||N==fl||N==12||zt(N);if(x.memory=null,x.Ib=null,x.Jb=null,x.Nd=null,!Gs(x.Oa,f,X?11:12))return 0;if(X&&zt(N)&&pa(),f.da)alert("todo:use_scaling");else{if(R){if(x.Ib=Go,f.Kb){if(N=f.U+1>>1,x.memory=d(f.U+2*N),x.memory==null)return 0;x.ec=x.memory,x.fc=0,x.cc=x.ec,x.dc=x.fc+f.U,x.Mc=x.cc,x.Nc=x.dc+N,x.Ib=zn,pa()}}else alert("todo:EmitYUV");X&&(x.Jb=Bi,R&&Lr())}if(R&&!Ga){for(f=0;256>f;++f)qi[f]=89858*(f-128)+pc>>Ss,ra[f]=-22014*(f-128)+pc,Ju[f]=-45773*(f-128),ju[f]=113618*(f-128)+pc>>Ss;for(f=Jl;f<Ya;++f)x=76283*(f-16)+pc>>Ss,ss[f-Jl]=Ur(x,255),Ra[f-Jl]=Ur(x+8>>4,15);Ga=1}return 1}function nn(f){var x=f.ma,N=f.U,R=f.T;return r(!(1&f.ka)),0>=N||0>=R?0:(N=x.Ib(f,x),x.Jb!=null&&x.Jb(f,x,N),x.Dc+=N,1)}function xi(f){f.ma.memory=null}function hi(f,x,N,R){return q(f,8)!=47?0:(x[0]=q(f,14)+1,N[0]=q(f,14)+1,R[0]=q(f,1),q(f,3)!=0?0:!f.h)}function fr(f,x){if(4>f)return f+1;var N=f-2>>1;return(2+(1&f)<<N)+q(x,N)+1}function zr(f,x){return 120<x?x-120:1<=(N=((N=bs[x-1])>>4)*f+(8-(15&N)))?N:1;var N}function or(f,x,N){var R=H(N),X=f[x+=255&R].g-8;return 0<X&&(ve(N,N.u+8),R=H(N),x+=f[x].value,x+=R&(1<<X)-1),ve(N,N.u+f[x].g),f[x].value}function xt(f,x,N){return N.g+=f.g,N.value+=f.value<<x>>>0,r(8>=N.g),f.g}function Yn(f,x,N){var R=f.xc;return r((x=R==0?0:f.vc[f.md*(N>>R)+(x>>R)])<f.Wb),f.Ya[x]}function ui(f,x,N,R){var X=f.ab,ie=f.c*x,re=f.C;x=re+x;var le=N,he=R;for(R=f.Ta,N=f.Ua;0<X--;){var Te=f.gc[X],Ee=re,Xe=x,fe=le,Re=he,Je=(he=R,le=N,Te.Ea);switch(r(Ee<Xe),r(Xe<=Te.nc),Te.hc){case 2:Zn(fe,Re,(Xe-Ee)*Je,he,le);break;case 0:var pt=Ee,Qe=Xe,yt=he,vt=le,Ft=(xn=Te).Ea;pt==0&&(Va(fe,Re,null,null,1,yt,vt),Bt(fe,Re+1,0,0,Ft-1,yt,vt+1),Re+=Ft,vt+=Ft,++pt);for(var Nt=1<<xn.b,bn=Nt-1,gn=ht(Ft,xn.b),ri=xn.K,xn=xn.w+(pt>>xn.b)*gn;pt<Qe;){var Un=ri,Fi=xn,Jn=1;for(Kl(fe,Re,yt,vt-Ft,1,yt,vt);Jn<Ft;){var un=(Jn&~bn)+Nt;un>Ft&&(un=Ft),(0,ga[Un[Fi++]>>8&15])(fe,Re+ +Jn,yt,vt+Jn-Ft,un-Jn,yt,vt+Jn),Jn=un}Re+=Ft,vt+=Ft,++pt&bn||(xn+=gn)}Xe!=Te.nc&&s(he,le-Je,he,le+(Xe-Ee-1)*Je,Je);break;case 1:for(Je=fe,Qe=Re,Ft=(fe=Te.Ea)-(vt=fe&~(yt=(Re=1<<Te.b)-1)),pt=ht(fe,Te.b),Nt=Te.K,Te=Te.w+(Ee>>Te.b)*pt;Ee<Xe;){for(bn=Nt,gn=Te,ri=new ln,xn=Qe+vt,Un=Qe+fe;Qe<xn;)an(bn[gn++],ri),_c(ri,Je,Qe,Re,he,le),Qe+=Re,le+=Re;Qe<Un&&(an(bn[gn++],ri),_c(ri,Je,Qe,Ft,he,le),Qe+=Ft,le+=Ft),++Ee&yt||(Te+=pt)}break;case 3:if(fe==he&&Re==le&&0<Te.b){for(Qe=he,fe=Je=le+(Xe-Ee)*Je-(vt=(Xe-Ee)*ht(Te.Ea,Te.b)),Re=he,yt=le,pt=[],vt=(Ft=vt)-1;0<=vt;--vt)pt[vt]=Re[yt+vt];for(vt=Ft-1;0<=vt;--vt)Qe[fe+vt]=pt[vt];xs(Te,Ee,Xe,he,Je,he,le)}else xs(Te,Ee,Xe,fe,Re,he,le)}le=R,he=N}he!=N&&s(R,N,le,he,ie)}function Si(f,x){var N=f.V,R=f.Ba+f.c*f.C,X=x-f.C;if(r(x<=f.l.o),r(16>=X),0<X){var ie=f.l,re=f.Ta,le=f.Ua,he=ie.width;if(ui(f,X,N,R),X=le=[le],r((N=f.C)<(R=x)),r(ie.v<ie.va),R>ie.o&&(R=ie.o),N<ie.j){var Te=ie.j-N;N=ie.j,X[0]+=Te*he}if(N>=R?N=0:(X[0]+=4*ie.v,ie.ka=N-ie.j,ie.U=ie.va-ie.v,ie.T=R-N,N=1),N){if(le=le[0],11>(N=f.ca).S){var Ee=N.f.RGBA,Xe=(R=N.S,X=ie.U,ie=ie.T,Te=Ee.eb,Ee.A),fe=ie;for(Ee=Ee.fb+f.Ma*Ee.A;0<fe--;){var Re=re,Je=le,pt=X,Qe=Te,yt=Ee;switch(R){case Ii:Ks(Re,Je,pt,Qe,yt);break;case Ai:Cl(Re,Je,pt,Qe,yt);break;case os:Cl(Re,Je,pt,Qe,yt),wo(Qe,yt,0,pt,1,0);break;case Dc:Nl(Re,Je,pt,Qe,yt);break;case br:Rt(Re,Je,pt,Qe,yt,1);break;case na:Rt(Re,Je,pt,Qe,yt,1),wo(Qe,yt,0,pt,1,0);break;case ro:Rt(Re,Je,pt,Qe,yt,0);break;case pl:Rt(Re,Je,pt,Qe,yt,0),wo(Qe,yt,1,pt,1,0);break;case fl:jl(Re,Je,pt,Qe,yt);break;case ou:jl(Re,Je,pt,Qe,yt),_o(Qe,yt,pt,1,0);break;case oo:bo(Re,Je,pt,Qe,yt);break;default:r(0)}le+=he,Ee+=Xe}f.Ma+=ie}else alert("todo:EmitRescaledRowsYUVA");r(f.Ma<=N.height)}}f.C=x,r(f.C<=f.i)}function ut(f){var x;if(0<f.ua)return 0;for(x=0;x<f.Wb;++x){var N=f.Ya[x].G,R=f.Ya[x].H;if(0<N[1][R[1]+0].g||0<N[2][R[2]+0].g||0<N[3][R[3]+0].g)return 0}return 1}function Et(f,x,N,R,X,ie){if(f.Z!=0){var re=f.qd,le=f.rd;for(r(ba[f.Z]!=null);x<N;++x)ba[f.Z](re,le,R,X,R,X,ie),re=R,le=X,X+=ie;f.qd=re,f.rd=le}}function En(f,x){var N=f.l.ma,R=N.Z==0||N.Z==1?f.l.j:f.C;if(R=f.C<R?R:f.C,r(x<=f.l.o),x>R){var X=f.l.width,ie=N.ca,re=N.tb+X*R,le=f.V,he=f.Ba+f.c*R,Te=f.gc;r(f.ab==1),r(Te[0].hc==3),ea(Te[0],R,x,le,he,ie,re),Et(N,R,x,ie,re,X)}f.C=f.Ma=x}function Zt(f,x,N,R,X,ie,re){var le=f.$/R,he=f.$%R,Te=f.m,Ee=f.s,Xe=N+f.$,fe=Xe;X=N+R*X;var Re=N+R*ie,Je=280+Ee.ua,pt=f.Pb?le:16777216,Qe=0<Ee.ua?Ee.Wa:null,yt=Ee.wc,vt=Xe<Re?Yn(Ee,he,le):null;r(f.C<ie),r(Re<=X);var Ft=!1;e:for(;;){for(;Ft||Xe<Re;){var Nt=0;if(le>=pt){var bn=Xe-N;r((pt=f).Pb),pt.wd=pt.m,pt.xd=bn,0<pt.s.ua&&Ot(pt.s.Wa,pt.s.vb),pt=le+$a}if(he&yt||(vt=Yn(Ee,he,le)),r(vt!=null),vt.Qb&&(x[Xe]=vt.qb,Ft=!0),!Ft)if(se(Te),vt.jc){Nt=Te,bn=x;var gn=Xe,ri=vt.pd[H(Nt)&ho-1];r(vt.jc),256>ri.g?(ve(Nt,Nt.u+ri.g),bn[gn]=ri.value,Nt=0):(ve(Nt,Nt.u+ri.g-256),r(256<=ri.value),Nt=ri.value),Nt==0&&(Ft=!0)}else Nt=or(vt.G[0],vt.H[0],Te);if(Te.h)break;if(Ft||256>Nt){if(!Ft)if(vt.nd)x[Xe]=(vt.qb|Nt<<8)>>>0;else{if(se(Te),Ft=or(vt.G[1],vt.H[1],Te),se(Te),bn=or(vt.G[2],vt.H[2],Te),gn=or(vt.G[3],vt.H[3],Te),Te.h)break;x[Xe]=(gn<<24|Ft<<16|Nt<<8|bn)>>>0}if(Ft=!1,++Xe,++he>=R&&(he=0,++le,re!=null&&le<=ie&&!(le%16)&&re(f,le),Qe!=null))for(;fe<Xe;)Nt=x[fe++],Qe.X[(506832829*Nt&4294967295)>>>Qe.Mb]=Nt}else if(280>Nt){if(Nt=fr(Nt-256,Te),bn=or(vt.G[4],vt.H[4],Te),se(Te),bn=zr(R,bn=fr(bn,Te)),Te.h)break;if(Xe-N<bn||X-Xe<Nt)break e;for(gn=0;gn<Nt;++gn)x[Xe+gn]=x[Xe+gn-bn];for(Xe+=Nt,he+=Nt;he>=R;)he-=R,++le,re!=null&&le<=ie&&!(le%16)&&re(f,le);if(r(Xe<=X),he&yt&&(vt=Yn(Ee,he,le)),Qe!=null)for(;fe<Xe;)Nt=x[fe++],Qe.X[(506832829*Nt&4294967295)>>>Qe.Mb]=Nt}else{if(!(Nt<Je))break e;for(Ft=Nt-280,r(Qe!=null);fe<Xe;)Nt=x[fe++],Qe.X[(506832829*Nt&4294967295)>>>Qe.Mb]=Nt;Nt=Xe,r(!(Ft>>>(bn=Qe).Xa)),x[Nt]=bn.X[Ft],Ft=!0}Ft||r(Te.h==ue(Te))}if(f.Pb&&Te.h&&Xe<X)r(f.m.h),f.a=5,f.m=f.wd,f.$=f.xd,0<f.s.ua&&Ot(f.s.vb,f.s.Wa);else{if(Te.h)break e;re?.(f,le>ie?ie:le),f.a=0,f.$=Xe-N}return 1}return f.a=3,0}function Vn(f){r(f!=null),f.vc=null,f.yc=null,f.Ya=null;var x=f.Wa;x!=null&&(x.X=null),f.vb=null,r(f!=null)}function Ti(){var f=new rn;return f==null?null:(f.a=0,f.xb=Ic,Ge("Predictor","VP8LPredictors"),Ge("Predictor","VP8LPredictors_C"),Ge("PredictorAdd","VP8LPredictorsAdd"),Ge("PredictorAdd","VP8LPredictorsAdd_C"),Zn=Gt,_c=dt,Ks=Me,Cl=we,jl=st,bo=et,Nl=Pt,O.VP8LMapColor32b=Gi,O.VP8LMapColor8b=Uo,f)}function _i(f,x,N,R,X){var ie=1,re=[f],le=[x],he=R.m,Te=R.s,Ee=null,Xe=0;e:for(;;){if(N)for(;ie&&q(he,1);){var fe=re,Re=le,Je=R,pt=1,Qe=Je.m,yt=Je.gc[Je.ab],vt=q(Qe,2);if(Je.Oc&1<<vt)ie=0;else{switch(Je.Oc|=1<<vt,yt.hc=vt,yt.Ea=fe[0],yt.nc=Re[0],yt.K=[null],++Je.ab,r(4>=Je.ab),vt){case 0:case 1:yt.b=q(Qe,3)+2,pt=_i(ht(yt.Ea,yt.b),ht(yt.nc,yt.b),0,Je,yt.K),yt.K=yt.K[0];break;case 3:var Ft,Nt=q(Qe,8)+1,bn=16<Nt?0:4<Nt?1:2<Nt?2:3;if(fe[0]=ht(yt.Ea,bn),yt.b=bn,Ft=pt=_i(Nt,1,0,Je,yt.K)){var gn,ri=Nt,xn=yt,Un=1<<(8>>xn.b),Fi=d(Un);if(Fi==null)Ft=0;else{var Jn=xn.K[0],un=xn.w;for(Fi[0]=xn.K[0][0],gn=1;gn<1*ri;++gn)Fi[gn]=fn(Jn[un+gn],Fi[gn-1]);for(;gn<4*Un;++gn)Fi[gn]=0;xn.K[0]=null,xn.K[0]=Fi,Ft=1}}pt=Ft;break;case 2:break;default:r(0)}ie=pt}}if(re=re[0],le=le[0],ie&&q(he,1)&&!(ie=1<=(Xe=q(he,4))&&11>=Xe)){R.a=3;break e}var Ut;if(Ut=ie)t:{var Qn,Gn,ei,wr=R,Ho=re,Wo=le,fi=Xe,nr=N,yo=wr.m,Er=wr.s,si=[null],ki=1,lr=0,cr=ia[fi];n:for(;;){if(nr&&q(yo,1)){var Xr=q(yo,3)+2,Oi=ht(Ho,Xr),ci=ht(Wo,Xr),Li=Oi*ci;if(!_i(Oi,ci,0,wr,si))break n;for(si=si[0],Er.xc=Xr,Qn=0;Qn<Li;++Qn){var Pi=si[Qn]>>8&65535;si[Qn]=Pi,Pi>=ki&&(ki=Pi+1)}}if(yo.h)break n;for(Gn=0;5>Gn;++Gn){var ur=hl[Gn];!Gn&&0<fi&&(ur+=1<<fi),lr<ur&&(lr=ur)}var Kr=b(ki*cr,J),ir=ki,Ui=b(ir,je);if(Ui==null)var Ia=null;else r(65536>=ir),Ia=Ui;var Ki=d(lr);if(Ia==null||Ki==null||Kr==null){wr.a=1;break n}var An=Kr;for(Qn=ei=0;Qn<ki;++Qn){var Dn=Ia[Qn],Zi=Dn.G,wa=Dn.H,Ts=0,Sa=1,yr=0;for(Gn=0;5>Gn;++Gn){ur=hl[Gn],Zi[Gn]=An,wa[Gn]=ei,!Gn&&0<fi&&(ur+=1<<fi);r:{var Cs,Qs=ur,Mc=wr,Ir=Ki,Bc=An,Nu=ei,Ql=0,La=Mc.m,Qu=q(La,1);if(l(Ir,0,0,Qs),Qu){var zl=q(La,1)+1,lu=q(La,1),el=q(La,lu==0?1:8);Ir[el]=1,zl==2&&(Ir[el=q(La,8)]=1);var so=1}else{var Or=d(19),hc=q(La,4)+4;if(19<hc){Mc.a=3;var xl=0;break r}for(Cs=0;Cs<hc;++Cs)Or[Al[Cs]]=q(La,3);var _l=void 0,Dl=void 0,Is=Mc,cu=Or,tl=Qs,ec=Ir,Oc=0,nl=Is.m,Fc=8,uu=b(128,J);i:for(;D(uu,0,7,cu,19);){if(q(nl,1)){var Sd=2+2*q(nl,3);if((_l=2+q(nl,Sd))>tl)break i}else _l=tl;for(Dl=0;Dl<tl&&_l--;){se(nl);var ml=uu[0+(127&H(nl))];ve(nl,nl.u+ml.g);var bl=ml.value;if(16>bl)ec[Dl++]=bl,bl!=0&&(Fc=bl);else{var gc=bl==16,ed=bl-16,td=as[ed],Uc=q(nl,ms[ed])+td;if(Dl+Uc>tl)break i;for(var nd=gc?Fc:0;0<Uc--;)ec[Dl++]=nd}}Oc=1;break i}Oc||(Is.a=3),so=Oc}(so=so&&!La.h)&&(Ql=D(Bc,Nu,8,Ir,Qs)),so&&Ql!=0?xl=Ql:(Mc.a=3,xl=0)}if(xl==0)break n;if(Sa&&Rc[Gn]==1&&(Sa=An[ei].g==0),Ts+=An[ei].g,ei+=xl,3>=Gn){var Ls,Ec=Ki[0];for(Ls=1;Ls<ur;++Ls)Ki[Ls]>Ec&&(Ec=Ki[Ls]);yr+=Ec}}if(Dn.nd=Sa,Dn.Qb=0,Sa&&(Dn.qb=(Zi[3][wa[3]+0].value<<24|Zi[1][wa[1]+0].value<<16|Zi[2][wa[2]+0].value)>>>0,Ts==0&&256>Zi[0][wa[0]+0].value&&(Dn.Qb=1,Dn.qb+=Zi[0][wa[0]+0].value<<8)),Dn.jc=!Dn.Qb&&6>yr,Dn.jc){var Vc,il=Dn;for(Vc=0;Vc<ho;++Vc){var Ms=Vc,Bs=il.pd[Ms],Rl=il.G[0][il.H[0]+Ms];256<=Rl.value?(Bs.g=Rl.g+256,Bs.value=Rl.value):(Bs.g=0,Bs.value=0,Ms>>=xt(Rl,8,Bs),Ms>>=xt(il.G[1][il.H[1]+Ms],16,Bs),Ms>>=xt(il.G[2][il.H[2]+Ms],0,Bs),xt(il.G[3][il.H[3]+Ms],24,Bs))}}}Er.vc=si,Er.Wb=ki,Er.Ya=Ia,Er.yc=Kr,Ut=1;break t}Ut=0}if(!(ie=Ut)){R.a=3;break e}if(0<Xe){if(Te.ua=1<<Xe,!ge(Te.Wa,Xe)){R.a=1,ie=0;break e}}else Te.ua=0;var yc=R,rl=re,Td=le,ol=yc.s,qc=ol.xc;if(yc.c=rl,yc.i=Td,ol.md=ht(rl,qc),ol.wc=qc==0?-1:(1<<qc)-1,N){R.xb=ma;break e}if((Ee=d(re*le))==null){R.a=1,ie=0;break e}ie=(ie=Zt(R,Ee,0,re,le,le,null))&&!he.h;break e}return ie?(X!=null?X[0]=Ee:(r(Ee==null),r(N)),R.$=0,N||Vn(Te)):Vn(Te),ie}function mr(f,x){var N=f.c*f.i,R=N+x+16*x;return r(f.c<=x),f.V=d(R),f.V==null?(f.Ta=null,f.Ua=0,f.a=1,0):(f.Ta=f.V,f.Ua=f.Ba+N+x,1)}function mi(f,x){var N=f.C,R=x-N,X=f.V,ie=f.Ba+f.c*N;for(r(x<=f.l.o);0<R;){var re=16<R?16:R,le=f.l.ma,he=f.l.width,Te=he*re,Ee=le.ca,Xe=le.tb+he*N,fe=f.Ta,Re=f.Ua;ui(f,re,X,ie),ya(fe,Re,Ee,Xe,Te),Et(le,N,N+re,Ee,Xe,he),R-=re,X+=re*f.c,N+=re}r(N==x),f.C=f.Ma=x}function pr(){this.ub=this.yd=this.td=this.Rb=0}function Ci(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function _n(){this.Fb=this.Bb=this.Cb=0,this.Zb=d(4),this.Lb=d(4)}function ko(){this.Yb=(function(){var f=[];return(function x(N,R,X){for(var ie=X[R],re=0;re<ie&&(N.push(X.length>R+1?[]:0),!(X.length<R+1));re++)x(N[re],R+1,X)})(f,0,[3,11]),f})()}function qn(){this.jb=d(3),this.Wc=p([4,8],ko),this.Xc=p([4,17],ko)}function us(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new d(4),this.od=new d(4)}function gi(){this.ld=this.La=this.dd=this.tc=0}function Mo(){this.Na=this.la=0}function Ei(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function zs(){this.ad=d(384),this.Za=0,this.Ob=d(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ka(){this.uc=this.M=this.Nb=0,this.wa=Array(new gi),this.Y=0,this.ya=Array(new zs),this.aa=0,this.l=new Ws}function Za(){this.y=d(16),this.f=d(8),this.ea=d(8)}function ds(){this.cb=this.a=0,this.sc="",this.m=new w,this.Od=new pr,this.Kc=new Ci,this.ed=new us,this.Qa=new _n,this.Ic=this.$c=this.Aa=0,this.D=new Ka,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=b(8,w),this.ia=0,this.pb=b(4,Ei),this.Pa=new qn,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Za),this.Hd=0,this.rb=Array(new Mo),this.sb=0,this.wa=Array(new gi),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new zs),this.L=this.aa=0,this.gd=p([4,2],gi),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Ur(f,x){return 0>f?0:f>x?x:f}function Ws(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function _r(){var f=new ds;return f!=null&&(f.a=0,f.sc="OK",f.cb=0,f.Xb=0,Da||(Da=Ja)),f}function $i(f,x,N){return f.a==0&&(f.a=x,f.sc=N,f.cb=0),0}function yi(f,x,N){return 3<=N&&f[x+0]==157&&f[x+1]==1&&f[x+2]==42}function Tr(f,x){if(f==null)return 0;if(f.a=0,f.sc="OK",x==null)return $i(f,2,"null VP8Io passed to VP8GetHeaders()");var N=x.data,R=x.w,X=x.ha;if(4>X)return $i(f,7,"Truncated header.");var ie=N[R+0]|N[R+1]<<8|N[R+2]<<16,re=f.Od;if(re.Rb=!(1&ie),re.td=ie>>1&7,re.yd=ie>>4&1,re.ub=ie>>5,3<re.td)return $i(f,3,"Incorrect keyframe parameters.");if(!re.yd)return $i(f,4,"Frame not displayable.");R+=3,X-=3;var le=f.Kc;if(re.Rb){if(7>X)return $i(f,7,"cannot parse picture header");if(!yi(N,R,X))return $i(f,3,"Bad code word");le.c=16383&(N[R+4]<<8|N[R+3]),le.Td=N[R+4]>>6,le.i=16383&(N[R+6]<<8|N[R+5]),le.Ud=N[R+6]>>6,R+=7,X-=7,f.za=le.c+15>>4,f.Ub=le.i+15>>4,x.width=le.c,x.height=le.i,x.Da=0,x.j=0,x.v=0,x.va=x.width,x.o=x.height,x.da=0,x.ib=x.width,x.hb=x.height,x.U=x.width,x.T=x.height,l((ie=f.Pa).jb,0,255,ie.jb.length),r((ie=f.Qa)!=null),ie.Cb=0,ie.Bb=0,ie.Fb=1,l(ie.Zb,0,0,ie.Zb.length),l(ie.Lb,0,0,ie.Lb)}if(re.ub>X)return $i(f,7,"bad partition length");ee(ie=f.m,N,R,re.ub),R+=re.ub,X-=re.ub,re.Rb&&(le.Ld=xe(ie),le.Kd=xe(ie)),le=f.Qa;var he,Te=f.Pa;if(r(ie!=null),r(le!=null),le.Cb=xe(ie),le.Cb){if(le.Bb=xe(ie),xe(ie)){for(le.Fb=xe(ie),he=0;4>he;++he)le.Zb[he]=xe(ie)?Ne(ie,7):0;for(he=0;4>he;++he)le.Lb[he]=xe(ie)?Ne(ie,6):0}if(le.Bb)for(he=0;3>he;++he)Te.jb[he]=xe(ie)?de(ie,8):255}else le.Bb=0;if(ie.Ka)return $i(f,3,"cannot parse segment header");if((le=f.ed).zd=xe(ie),le.Tb=de(ie,6),le.wb=de(ie,3),le.Pc=xe(ie),le.Pc&&xe(ie)){for(Te=0;4>Te;++Te)xe(ie)&&(le.vd[Te]=Ne(ie,6));for(Te=0;4>Te;++Te)xe(ie)&&(le.od[Te]=Ne(ie,6))}if(f.L=le.Tb==0?0:le.zd?1:2,ie.Ka)return $i(f,3,"cannot parse filter header");var Ee=X;if(X=he=R,R=he+Ee,le=Ee,f.Xb=(1<<de(f.m,2))-1,Ee<3*(Te=f.Xb))N=7;else{for(he+=3*Te,le-=3*Te,Ee=0;Ee<Te;++Ee){var Xe=N[X+0]|N[X+1]<<8|N[X+2]<<16;Xe>le&&(Xe=le),ee(f.Jc[+Ee],N,he,Xe),he+=Xe,le-=Xe,X+=3}ee(f.Jc[+Te],N,he,le),N=he<R?0:5}if(N!=0)return $i(f,N,"cannot parse partitions");for(N=de(he=f.m,7),X=xe(he)?Ne(he,4):0,R=xe(he)?Ne(he,4):0,le=xe(he)?Ne(he,4):0,Te=xe(he)?Ne(he,4):0,he=xe(he)?Ne(he,4):0,Ee=f.Qa,Xe=0;4>Xe;++Xe){if(Ee.Cb){var fe=Ee.Zb[Xe];Ee.Fb||(fe+=N)}else{if(0<Xe){f.pb[Xe]=f.pb[0];continue}fe=N}var Re=f.pb[Xe];Re.Sc[0]=So[Ur(fe+X,127)],Re.Sc[1]=Ro[Ur(fe+0,127)],Re.Eb[0]=2*So[Ur(fe+R,127)],Re.Eb[1]=101581*Ro[Ur(fe+le,127)]>>16,8>Re.Eb[1]&&(Re.Eb[1]=8),Re.Qc[0]=So[Ur(fe+Te,117)],Re.Qc[1]=Ro[Ur(fe+he,127)],Re.lc=fe+he}if(!re.Rb)return $i(f,4,"Not a key frame.");for(xe(ie),re=f.Pa,N=0;4>N;++N){for(X=0;8>X;++X)for(R=0;3>R;++R)for(le=0;11>le;++le)Te=De(ie,Br[N][X][R][le])?de(ie,8):Zu[N][X][R][le],re.Wc[N][X].Yb[R][le]=Te;for(X=0;17>X;++X)re.Xc[N][X]=re.Wc[N][On[X]]}return f.kc=xe(ie),f.kc&&(f.Bd=de(ie,8)),f.cb=1}function Ja(f,x,N,R,X,ie,re){var le=x[X].Yb[N];for(N=0;16>X;++X){if(!De(f,le[N+0]))return X;for(;!De(f,le[N+1]);)if(le=x[++X].Yb[0],N=0,X==16)return 16;var he=x[X+1].Yb;if(De(f,le[N+2])){var Te=f,Ee=0;if(De(Te,(fe=le)[(Xe=N)+3]))if(De(Te,fe[Xe+6])){for(le=0,Xe=2*(Ee=De(Te,fe[Xe+8]))+(fe=De(Te,fe[Xe+9+Ee])),Ee=0,fe=au[Xe];fe[le];++le)Ee+=Ee+De(Te,fe[le]);Ee+=3+(8<<Xe)}else De(Te,fe[Xe+7])?(Ee=7+2*De(Te,165),Ee+=De(Te,145)):Ee=5+De(Te,159);else Ee=De(Te,fe[Xe+4])?3+De(Te,fe[Xe+5]):2;le=he[2]}else Ee=1,le=he[1];he=re+Pl[X],0>(Te=f).b&&ze(Te);var Xe,fe=Te.b,Re=(Xe=Te.Ca>>1)-(Te.I>>fe)>>31;--Te.b,Te.Ca+=Re,Te.Ca|=1,Te.I-=(Xe+1&Re)<<fe,ie[he]=((Ee^Re)-Re)*R[(0<X)+0]}return 16}function Yl(f){var x=f.rb[f.sb-1];x.la=0,x.Na=0,l(f.zc,0,0,f.zc.length),f.ja=0}function xo(f,x,N,R,X){X=f[x+N+32*R]+(X>>3),f[x+N+32*R]=-256&X?0>X?0:255:X}function uo(f,x,N,R,X,ie){xo(f,x,0,N,R+X),xo(f,x,1,N,R+ie),xo(f,x,2,N,R-ie),xo(f,x,3,N,R-X)}function Qi(f){return(20091*f>>16)+f}function Xo(f,x,N,R){var X,ie=0,re=d(16);for(X=0;4>X;++X){var le=f[x+0]+f[x+8],he=f[x+0]-f[x+8],Te=(35468*f[x+4]>>16)-Qi(f[x+12]),Ee=Qi(f[x+4])+(35468*f[x+12]>>16);re[ie+0]=le+Ee,re[ie+1]=he+Te,re[ie+2]=he-Te,re[ie+3]=le-Ee,ie+=4,x++}for(X=ie=0;4>X;++X)le=(f=re[ie+0]+4)+re[ie+8],he=f-re[ie+8],Te=(35468*re[ie+4]>>16)-Qi(re[ie+12]),xo(N,R,0,0,le+(Ee=Qi(re[ie+4])+(35468*re[ie+12]>>16))),xo(N,R,1,0,he+Te),xo(N,R,2,0,he-Te),xo(N,R,3,0,le-Ee),ie++,R+=32}function Gl(f,x,N,R){var X=f[x+0]+4,ie=35468*f[x+4]>>16,re=Qi(f[x+4]),le=35468*f[x+1]>>16;uo(N,R,0,X+re,f=Qi(f[x+1]),le),uo(N,R,1,X+ie,f,le),uo(N,R,2,X-ie,f,le),uo(N,R,3,X-re,f,le)}function ca(f,x,N,R,X){Xo(f,x,N,R),X&&Xo(f,x+16,N,R+4)}function Cr(f,x,N,R){qa(f,x+0,N,R,1),qa(f,x+32,N,R+128,1)}function Xl(f,x,N,R){var X;for(f=f[x+0]+4,X=0;4>X;++X)for(x=0;4>x;++x)xo(N,R,x,X,f)}function Wr(f,x,N,R){f[x+0]&&Vi(f,x+0,N,R),f[x+16]&&Vi(f,x+16,N,R+4),f[x+32]&&Vi(f,x+32,N,R+128),f[x+48]&&Vi(f,x+48,N,R+128+4)}function Di(f,x,N,R){var X,ie=d(16);for(X=0;4>X;++X){var re=f[x+0+X]+f[x+12+X],le=f[x+4+X]+f[x+8+X],he=f[x+4+X]-f[x+8+X],Te=f[x+0+X]-f[x+12+X];ie[0+X]=re+le,ie[8+X]=re-le,ie[4+X]=Te+he,ie[12+X]=Te-he}for(X=0;4>X;++X)re=(f=ie[0+4*X]+3)+ie[3+4*X],le=ie[1+4*X]+ie[2+4*X],he=ie[1+4*X]-ie[2+4*X],Te=f-ie[3+4*X],N[R+0]=re+le>>3,N[R+16]=Te+he>>3,N[R+32]=re-le>>3,N[R+48]=Te-he>>3,R+=64}function cl(f,x,N){var R,X=x-32,ie=ta,re=255-f[X-1];for(R=0;R<N;++R){var le,he=ie,Te=re+f[x-1];for(le=0;le<N;++le)f[x+le]=he[Te+f[X+le]];x+=32}}function Ba(f,x){cl(f,x,4)}function Bo(f,x){cl(f,x,8)}function fs(f,x){cl(f,x,16)}function ka(f,x){var N;for(N=0;16>N;++N)s(f,x+32*N,f,x-32,16)}function Ko(f,x){var N;for(N=16;0<N;--N)l(f,x,f[x-1],16),x+=32}function Qr(f,x,N){var R;for(R=0;16>R;++R)l(x,N+32*R,f,16)}function jr(f,x){var N,R=16;for(N=0;16>N;++N)R+=f[x-1+32*N]+f[x+N-32];Qr(R>>5,f,x)}function ps(f,x){var N,R=8;for(N=0;16>N;++N)R+=f[x-1+32*N];Qr(R>>4,f,x)}function Oa(f,x){var N,R=8;for(N=0;16>N;++N)R+=f[x+N-32];Qr(R>>4,f,x)}function $s(f,x){Qr(128,f,x)}function kn(f,x,N){return f+2*x+N+2>>2}function Ct(f,x){var N,R=x-32;for(R=new Uint8Array([kn(f[R-1],f[R+0],f[R+1]),kn(f[R+0],f[R+1],f[R+2]),kn(f[R+1],f[R+2],f[R+3]),kn(f[R+2],f[R+3],f[R+4])]),N=0;4>N;++N)s(f,x+32*N,R,0,R.length)}function Kn(f,x){var N=f[x-1],R=f[x-1+32],X=f[x-1+64],ie=f[x-1+96];Ye(f,x+0,16843009*kn(f[x-1-32],N,R)),Ye(f,x+32,16843009*kn(N,R,X)),Ye(f,x+64,16843009*kn(R,X,ie)),Ye(f,x+96,16843009*kn(X,ie,ie))}function Fa(f,x){var N,R=4;for(N=0;4>N;++N)R+=f[x+N-32]+f[x-1+32*N];for(R>>=3,N=0;4>N;++N)l(f,x+32*N,R,4)}function ua(f,x){var N=f[x-1+0],R=f[x-1+32],X=f[x-1+64],ie=f[x-1-32],re=f[x+0-32],le=f[x+1-32],he=f[x+2-32],Te=f[x+3-32];f[x+0+96]=kn(R,X,f[x-1+96]),f[x+1+96]=f[x+0+64]=kn(N,R,X),f[x+2+96]=f[x+1+64]=f[x+0+32]=kn(ie,N,R),f[x+3+96]=f[x+2+64]=f[x+1+32]=f[x+0+0]=kn(re,ie,N),f[x+3+64]=f[x+2+32]=f[x+1+0]=kn(le,re,ie),f[x+3+32]=f[x+2+0]=kn(he,le,re),f[x+3+0]=kn(Te,he,le)}function wn(f,x){var N=f[x+1-32],R=f[x+2-32],X=f[x+3-32],ie=f[x+4-32],re=f[x+5-32],le=f[x+6-32],he=f[x+7-32];f[x+0+0]=kn(f[x+0-32],N,R),f[x+1+0]=f[x+0+32]=kn(N,R,X),f[x+2+0]=f[x+1+32]=f[x+0+64]=kn(R,X,ie),f[x+3+0]=f[x+2+32]=f[x+1+64]=f[x+0+96]=kn(X,ie,re),f[x+3+32]=f[x+2+64]=f[x+1+96]=kn(ie,re,le),f[x+3+64]=f[x+2+96]=kn(re,le,he),f[x+3+96]=kn(le,he,he)}function Tn(f,x){var N=f[x-1+0],R=f[x-1+32],X=f[x-1+64],ie=f[x-1-32],re=f[x+0-32],le=f[x+1-32],he=f[x+2-32],Te=f[x+3-32];f[x+0+0]=f[x+1+64]=ie+re+1>>1,f[x+1+0]=f[x+2+64]=re+le+1>>1,f[x+2+0]=f[x+3+64]=le+he+1>>1,f[x+3+0]=he+Te+1>>1,f[x+0+96]=kn(X,R,N),f[x+0+64]=kn(R,N,ie),f[x+0+32]=f[x+1+96]=kn(N,ie,re),f[x+1+32]=f[x+2+96]=kn(ie,re,le),f[x+2+32]=f[x+3+96]=kn(re,le,he),f[x+3+32]=kn(le,he,Te)}function ul(f,x){var N=f[x+0-32],R=f[x+1-32],X=f[x+2-32],ie=f[x+3-32],re=f[x+4-32],le=f[x+5-32],he=f[x+6-32],Te=f[x+7-32];f[x+0+0]=N+R+1>>1,f[x+1+0]=f[x+0+64]=R+X+1>>1,f[x+2+0]=f[x+1+64]=X+ie+1>>1,f[x+3+0]=f[x+2+64]=ie+re+1>>1,f[x+0+32]=kn(N,R,X),f[x+1+32]=f[x+0+96]=kn(R,X,ie),f[x+2+32]=f[x+1+96]=kn(X,ie,re),f[x+3+32]=f[x+2+96]=kn(ie,re,le),f[x+3+64]=kn(re,le,he),f[x+3+96]=kn(le,he,Te)}function Oo(f,x){var N=f[x-1+0],R=f[x-1+32],X=f[x-1+64],ie=f[x-1+96];f[x+0+0]=N+R+1>>1,f[x+2+0]=f[x+0+32]=R+X+1>>1,f[x+2+32]=f[x+0+64]=X+ie+1>>1,f[x+1+0]=kn(N,R,X),f[x+3+0]=f[x+1+32]=kn(R,X,ie),f[x+3+32]=f[x+1+64]=kn(X,ie,ie),f[x+3+64]=f[x+2+64]=f[x+0+96]=f[x+1+96]=f[x+2+96]=f[x+3+96]=ie}function Mn(f,x){var N=f[x-1+0],R=f[x-1+32],X=f[x-1+64],ie=f[x-1+96],re=f[x-1-32],le=f[x+0-32],he=f[x+1-32],Te=f[x+2-32];f[x+0+0]=f[x+2+32]=N+re+1>>1,f[x+0+32]=f[x+2+64]=R+N+1>>1,f[x+0+64]=f[x+2+96]=X+R+1>>1,f[x+0+96]=ie+X+1>>1,f[x+3+0]=kn(le,he,Te),f[x+2+0]=kn(re,le,he),f[x+1+0]=f[x+3+32]=kn(N,re,le),f[x+1+32]=f[x+3+64]=kn(R,N,re),f[x+1+64]=f[x+3+96]=kn(X,R,N),f[x+1+96]=kn(ie,X,R)}function yn(f,x){var N;for(N=0;8>N;++N)s(f,x+32*N,f,x-32,8)}function Ri(f,x){var N;for(N=0;8>N;++N)l(f,x,f[x-1],8),x+=32}function hn(f,x,N){var R;for(R=0;8>R;++R)l(x,N+32*R,f,8)}function ji(f,x){var N,R=8;for(N=0;8>N;++N)R+=f[x+N-32]+f[x-1+32*N];hn(R>>4,f,x)}function Cn(f,x){var N,R=4;for(N=0;8>N;++N)R+=f[x+N-32];hn(R>>3,f,x)}function Zo(f,x){var N,R=4;for(N=0;8>N;++N)R+=f[x-1+32*N];hn(R>>3,f,x)}function Qt(f,x){hn(128,f,x)}function oi(f,x,N){var R=f[x-N],X=f[x+0],ie=3*(X-R)+dl[1020+f[x-2*N]-f[x+N]],re=Wa[112+(ie+4>>3)];f[x-N]=ta[255+R+Wa[112+(ie+3>>3)]],f[x+0]=ta[255+X-re]}function en(f,x,N,R){var X=f[x+0],ie=f[x+N];return Yr[255+f[x-2*N]-f[x-N]]>R||Yr[255+ie-X]>R}function Ni(f,x,N,R){return 4*Yr[255+f[x-N]-f[x+0]]+Yr[255+f[x-2*N]-f[x+N]]<=R}function Ua(f,x,N,R,X){var ie=f[x-3*N],re=f[x-2*N],le=f[x-N],he=f[x+0],Te=f[x+N],Ee=f[x+2*N],Xe=f[x+3*N];return 4*Yr[255+le-he]+Yr[255+re-Te]>R?0:Yr[255+f[x-4*N]-ie]<=X&&Yr[255+ie-re]<=X&&Yr[255+re-le]<=X&&Yr[255+Xe-Ee]<=X&&Yr[255+Ee-Te]<=X&&Yr[255+Te-he]<=X}function Ea(f,x,N,R){var X=2*R+1;for(R=0;16>R;++R)Ni(f,x+R,N,X)&&oi(f,x+R,N)}function fo(f,x,N,R){var X=2*R+1;for(R=0;16>R;++R)Ni(f,x+R*N,1,X)&&oi(f,x+R*N,1)}function Aa(f,x,N,R){var X;for(X=3;0<X;--X)Ea(f,x+=4*N,N,R)}function hs(f,x,N,R){var X;for(X=3;0<X;--X)fo(f,x+=4,N,R)}function Qa(f,x,N,R,X,ie,re,le){for(ie=2*ie+1;0<X--;){if(Ua(f,x,N,ie,re))if(en(f,x,N,le))oi(f,x,N);else{var he=f,Te=x,Ee=N,Xe=he[Te-2*Ee],fe=he[Te-Ee],Re=he[Te+0],Je=he[Te+Ee],pt=he[Te+2*Ee],Qe=27*(vt=dl[1020+3*(Re-fe)+dl[1020+Xe-Je]])+63>>7,yt=18*vt+63>>7,vt=9*vt+63>>7;he[Te-3*Ee]=ta[255+he[Te-3*Ee]+vt],he[Te-2*Ee]=ta[255+Xe+yt],he[Te-Ee]=ta[255+fe+Qe],he[Te+0]=ta[255+Re-Qe],he[Te+Ee]=ta[255+Je-yt],he[Te+2*Ee]=ta[255+pt-vt]}x+=R}}function Ys(f,x,N,R,X,ie,re,le){for(ie=2*ie+1;0<X--;){if(Ua(f,x,N,ie,re))if(en(f,x,N,le))oi(f,x,N);else{var he=f,Te=x,Ee=N,Xe=he[Te-Ee],fe=he[Te+0],Re=he[Te+Ee],Je=Wa[112+(4+(pt=3*(fe-Xe))>>3)],pt=Wa[112+(pt+3>>3)],Qe=Je+1>>1;he[Te-2*Ee]=ta[255+he[Te-2*Ee]+Qe],he[Te-Ee]=ta[255+Xe+pt],he[Te+0]=ta[255+fe-Je],he[Te+Ee]=ta[255+Re-Qe]}x+=R}}function nu(f,x,N,R,X,ie){Qa(f,x,N,1,16,R,X,ie)}function gs(f,x,N,R,X,ie){Qa(f,x,1,N,16,R,X,ie)}function iu(f,x,N,R,X,ie){var re;for(re=3;0<re;--re)Ys(f,x+=4*N,N,1,16,R,X,ie)}function C(f,x,N,R,X,ie){var re;for(re=3;0<re;--re)Ys(f,x+=4,1,N,16,R,X,ie)}function Q(f,x,N,R,X,ie,re,le){Qa(f,x,X,1,8,ie,re,le),Qa(N,R,X,1,8,ie,re,le)}function pe(f,x,N,R,X,ie,re,le){Qa(f,x,1,X,8,ie,re,le),Qa(N,R,1,X,8,ie,re,le)}function Be(f,x,N,R,X,ie,re,le){Ys(f,x+4*X,X,1,8,ie,re,le),Ys(N,R+4*X,X,1,8,ie,re,le)}function Ve(f,x,N,R,X,ie,re,le){Ys(f,x+4,1,X,8,ie,re,le),Ys(N,R+4,1,X,8,ie,re,le)}function gt(){this.ba=new Xt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new ti,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function mt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function $t(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Jt(){this.ua=0,this.Wa=new _t,this.vb=new _t,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new je,this.yc=new J}function rn(){this.xb=this.a=0,this.l=new Ws,this.ca=new Xt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new V,this.Pb=0,this.wd=new V,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Jt,this.ab=0,this.gc=b(4,$t),this.Oc=0}function Bn(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Ws,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function di(f,x,N,R,X,ie,re){for(f=f==null?0:f[x+0],x=0;x<re;++x)X[ie+x]=f+N[R+x]&255,f=X[ie+x]}function eo(f,x,N,R,X,ie,re){var le;if(f==null)di(null,null,N,R,X,ie,re);else for(le=0;le<re;++le)X[ie+le]=f[x+le]+N[R+le]&255}function Yi(f,x,N,R,X,ie,re){if(f==null)di(null,null,N,R,X,ie,re);else{var le,he=f[x+0],Te=he,Ee=he;for(le=0;le<re;++le)Te=Ee+(he=f[x+le])-Te,Ee=N[R+le]+(-256&Te?0>Te?0:255:Te)&255,Te=he,X[ie+le]=Ee}}function Dr(f,x,N,R){var X=x.width,ie=x.o;if(r(f!=null&&x!=null),0>N||0>=R||N+R>ie)return null;if(!f.Cc){if(f.ga==null){var re;if(f.ga=new Bn,(re=f.ga==null)||(re=x.width*x.o,r(f.Gb.length==0),f.Gb=d(re),f.Uc=0,f.Gb==null?re=0:(f.mb=f.Gb,f.nb=f.Uc,f.rc=null,re=1),re=!re),!re){re=f.ga;var le=f.Fa,he=f.P,Te=f.qc,Ee=f.mb,Xe=f.nb,fe=he+1,Re=Te-1,Je=re.l;if(r(le!=null&&Ee!=null&&x!=null),ba[0]=null,ba[1]=di,ba[2]=eo,ba[3]=Yi,re.ca=Ee,re.tb=Xe,re.c=x.width,re.i=x.height,r(0<re.c&&0<re.i),1>=Te)x=0;else if(re.$a=3&le[he+0],re.Z=le[he+0]>>2&3,re.Lc=le[he+0]>>4&3,he=le[he+0]>>6&3,0>re.$a||1<re.$a||4<=re.Z||1<re.Lc||he)x=0;else if(Je.put=nn,Je.ac=ni,Je.bc=xi,Je.ma=re,Je.width=x.width,Je.height=x.height,Je.Da=x.Da,Je.v=x.v,Je.va=x.va,Je.j=x.j,Je.o=x.o,re.$a)e:{r(re.$a==1),x=Ti();t:for(;;){if(x==null){x=0;break e}if(r(re!=null),re.mc=x,x.c=re.c,x.i=re.i,x.l=re.l,x.l.ma=re,x.l.width=re.c,x.l.height=re.i,x.a=0,Ie(x.m,le,fe,Re),!_i(re.c,re.i,1,x,null)||(x.ab==1&&x.gc[0].hc==3&&ut(x.s)?(re.ic=1,le=x.c*x.i,x.Ta=null,x.Ua=0,x.V=d(le),x.Ba=0,x.V==null?(x.a=1,x=0):x=1):(re.ic=0,x=mr(x,re.c)),!x))break t;x=1;break e}re.mc=null,x=0}else x=Re>=re.c*re.i;re=!x}if(re)return null;f.ga.Lc!=1?f.Ga=0:R=ie-N}r(f.ga!=null),r(N+R<=ie);e:{if(x=(le=f.ga).c,ie=le.l.o,le.$a==0){if(fe=f.rc,Re=f.Vc,Je=f.Fa,he=f.P+1+N*x,Te=f.mb,Ee=f.nb+N*x,r(he<=f.P+f.qc),le.Z!=0)for(r(ba[le.Z]!=null),re=0;re<R;++re)ba[le.Z](fe,Re,Je,he,Te,Ee,x),fe=Te,Re=Ee,Ee+=x,he+=x;else for(re=0;re<R;++re)s(Te,Ee,Je,he,x),fe=Te,Re=Ee,Ee+=x,he+=x;f.rc=fe,f.Vc=Re}else{if(r(le.mc!=null),x=N+R,r((re=le.mc)!=null),r(x<=re.i),re.C>=x)x=1;else if(le.ic||Lr(),le.ic){le=re.V,fe=re.Ba,Re=re.c;var pt=re.i,Qe=(Je=1,he=re.$/Re,Te=re.$%Re,Ee=re.m,Xe=re.s,re.$),yt=Re*pt,vt=Re*x,Ft=Xe.wc,Nt=Qe<vt?Yn(Xe,Te,he):null;r(Qe<=yt),r(x<=pt),r(ut(Xe));t:for(;;){for(;!Ee.h&&Qe<vt;){if(Te&Ft||(Nt=Yn(Xe,Te,he)),r(Nt!=null),se(Ee),256>(pt=or(Nt.G[0],Nt.H[0],Ee)))le[fe+Qe]=pt,++Qe,++Te>=Re&&(Te=0,++he<=x&&!(he%16)&&En(re,he));else{if(!(280>pt)){Je=0;break t}pt=fr(pt-256,Ee);var bn,gn=or(Nt.G[4],Nt.H[4],Ee);if(se(Ee),!(Qe>=(gn=zr(Re,gn=fr(gn,Ee)))&&yt-Qe>=pt)){Je=0;break t}for(bn=0;bn<pt;++bn)le[fe+Qe+bn]=le[fe+Qe+bn-gn];for(Qe+=pt,Te+=pt;Te>=Re;)Te-=Re,++he<=x&&!(he%16)&&En(re,he);Qe<vt&&Te&Ft&&(Nt=Yn(Xe,Te,he))}r(Ee.h==ue(Ee))}En(re,he>x?x:he);break t}!Je||Ee.h&&Qe<yt?(Je=0,re.a=Ee.h?5:3):re.$=Qe,x=Je}else x=Zt(re,re.V,re.Ba,re.c,re.i,x,mi);if(!x){R=0;break e}}N+R>=ie&&(f.Cc=1),R=1}if(!R)return null;if(f.Cc&&((R=f.ga)!=null&&(R.mc=null),f.ga=null,0<f.Ga))return alert("todo:WebPDequantizeLevels"),null}return f.nb+N*X}function Rr(f,x,N,R,X,ie){for(;0<X--;){var re,le=f,he=x+(N?1:0),Te=f,Ee=x+(N?0:3);for(re=0;re<R;++re){var Xe=Te[Ee+4*re];Xe!=255&&(Xe*=32897,le[he+4*re+0]=le[he+4*re+0]*Xe>>23,le[he+4*re+1]=le[he+4*re+1]*Xe>>23,le[he+4*re+2]=le[he+4*re+2]*Xe>>23)}x+=ie}}function Ao(f,x,N,R,X){for(;0<R--;){var ie;for(ie=0;ie<N;++ie){var re=f[x+2*ie+0],le=15&(Te=f[x+2*ie+1]),he=4369*le,Te=(240&Te|Te>>4)*he>>16;f[x+2*ie+0]=(240&re|re>>4)*he>>16&240|(15&re|re<<4)*he>>16>>4&15,f[x+2*ie+1]=240&Te|le}x+=X}}function ar(f,x,N,R,X,ie,re,le){var he,Te,Ee=255;for(Te=0;Te<X;++Te){for(he=0;he<R;++he){var Xe=f[x+he];ie[re+4*he]=Xe,Ee&=Xe}x+=N,re+=le}return Ee!=255}function da(f,x,N,R,X){var ie;for(ie=0;ie<X;++ie)N[R+ie]=f[x+ie]>>8}function Lr(){wo=Rr,_o=Ao,no=ar,ya=da}function fa(f,x,N){O[f]=function(R,X,ie,re,le,he,Te,Ee,Xe,fe,Re,Je,pt,Qe,yt,vt,Ft){var Nt,bn=Ft-1>>1,gn=le[he+0]|Te[Ee+0]<<16,ri=Xe[fe+0]|Re[Je+0]<<16;r(R!=null);var xn=3*gn+ri+131074>>2;for(x(R[X+0],255&xn,xn>>16,pt,Qe),ie!=null&&(xn=3*ri+gn+131074>>2,x(ie[re+0],255&xn,xn>>16,yt,vt)),Nt=1;Nt<=bn;++Nt){var Un=le[he+Nt]|Te[Ee+Nt]<<16,Fi=Xe[fe+Nt]|Re[Je+Nt]<<16,Jn=gn+Un+ri+Fi+524296,un=Jn+2*(Un+ri)>>3;xn=un+gn>>1,gn=(Jn=Jn+2*(gn+Fi)>>3)+Un>>1,x(R[X+2*Nt-1],255&xn,xn>>16,pt,Qe+(2*Nt-1)*N),x(R[X+2*Nt-0],255&gn,gn>>16,pt,Qe+(2*Nt-0)*N),ie!=null&&(xn=Jn+ri>>1,gn=un+Fi>>1,x(ie[re+2*Nt-1],255&xn,xn>>16,yt,vt+(2*Nt-1)*N),x(ie[re+2*Nt+0],255&gn,gn>>16,yt,vt+(2*Nt+0)*N)),gn=Un,ri=Fi}1&Ft||(xn=3*gn+ri+131074>>2,x(R[X+Ft-1],255&xn,xn>>16,pt,Qe+(Ft-1)*N),ie!=null&&(xn=3*ri+gn+131074>>2,x(ie[re+Ft-1],255&xn,xn>>16,yt,vt+(Ft-1)*N)))}}function pa(){Gr[Ii]=Js,Gr[Ai]=Lc,Gr[Dc]=ws,Gr[br]=su,Gr[ro]=Zl,Gr[fl]=gl,Gr[oo]=yl,Gr[os]=Lc,Gr[na]=su,Gr[pl]=Zl,Gr[ou]=gl}function ys(f){return f&-16384?0>f?0:255:f>>To}function Jo(f,x){return ys((19077*f>>8)+(26149*x>>8)-14234)}function Pa(f,x,N){return ys((19077*f>>8)-(6419*x>>8)-(13320*N>>8)+8708)}function po(f,x){return ys((19077*f>>8)+(33050*x>>8)-17685)}function ha(f,x,N,R,X){R[X+0]=Jo(f,N),R[X+1]=Pa(f,x,N),R[X+2]=po(f,x)}function er(f,x,N,R,X){R[X+0]=po(f,x),R[X+1]=Pa(f,x,N),R[X+2]=Jo(f,N)}function za(f,x,N,R,X){var ie=Pa(f,x,N);x=ie<<3&224|po(f,x)>>3,R[X+0]=248&Jo(f,N)|ie>>5,R[X+1]=x}function mo(f,x,N,R,X){var ie=240&po(f,x)|15;R[X+0]=240&Jo(f,N)|Pa(f,x,N)>>4,R[X+1]=ie}function es(f,x,N,R,X){R[X+0]=255,ha(f,x,N,R,X+1)}function tr(f,x,N,R,X){er(f,x,N,R,X),R[X+3]=255}function to(f,x,N,R,X){ha(f,x,N,R,X),R[X+3]=255}function Tl(f,x,N){O[f]=function(R,X,ie,re,le,he,Te,Ee,Xe){for(var fe=Ee+(-2&Xe)*N;Ee!=fe;)x(R[X+0],ie[re+0],le[he+0],Te,Ee),x(R[X+1],ie[re+0],le[he+0],Te,Ee+N),X+=2,++re,++he,Ee+=2*N;1&Xe&&x(R[X+0],ie[re+0],le[he+0],Te,Ee)}}function zc(f,x,N){return N==0?f==0?x==0?6:5:x==0?4:0:N}function _s(f,x,N,R,X){switch(f>>>30){case 3:qa(x,N,R,X,0);break;case 2:hr(x,N,R,X);break;case 1:Vi(x,N,R,X)}}function _a(f,x){var N,R,X=x.M,ie=x.Nb,re=f.oc,le=f.pc+40,he=f.oc,Te=f.pc+584,Ee=f.oc,Xe=f.pc+600;for(N=0;16>N;++N)re[le+32*N-1]=129;for(N=0;8>N;++N)he[Te+32*N-1]=129,Ee[Xe+32*N-1]=129;for(0<X?re[le-1-32]=he[Te-1-32]=Ee[Xe-1-32]=129:(l(re,le-32-1,127,21),l(he,Te-32-1,127,9),l(Ee,Xe-32-1,127,9)),R=0;R<f.za;++R){var fe=x.ya[x.aa+R];if(0<R){for(N=-1;16>N;++N)s(re,le+32*N-4,re,le+32*N+12,4);for(N=-1;8>N;++N)s(he,Te+32*N-4,he,Te+32*N+4,4),s(Ee,Xe+32*N-4,Ee,Xe+32*N+4,4)}var Re=f.Gd,Je=f.Hd+R,pt=fe.ad,Qe=fe.Hc;if(0<X&&(s(re,le-32,Re[Je].y,0,16),s(he,Te-32,Re[Je].f,0,8),s(Ee,Xe-32,Re[Je].ea,0,8)),fe.Za){var yt=re,vt=le-32+16;for(0<X&&(R>=f.za-1?l(yt,vt,Re[Je].y[15],4):s(yt,vt,Re[Je+1].y,0,4)),N=0;4>N;N++)yt[vt+128+N]=yt[vt+256+N]=yt[vt+384+N]=yt[vt+0+N];for(N=0;16>N;++N,Qe<<=2)yt=re,vt=le+Hi[N],ao[fe.Ob[N]](yt,vt),_s(Qe,pt,16*+N,yt,vt)}else if(yt=zc(R,X,fe.Ob[0]),Vo[yt](re,le),Qe!=0)for(N=0;16>N;++N,Qe<<=2)_s(Qe,pt,16*+N,re,le+Hi[N]);for(N=fe.Gc,yt=zc(R,X,fe.Dd),xa[yt](he,Te),xa[yt](Ee,Xe),Qe=pt,yt=he,vt=Te,255&(fe=0|N)&&(170&fe?is(Qe,256,yt,vt):Xi(Qe,256,yt,vt)),fe=Ee,Qe=Xe,255&(N>>=8)&&(170&N?is(pt,320,fe,Qe):Xi(pt,320,fe,Qe)),X<f.Ub-1&&(s(Re[Je].y,0,re,le+480,16),s(Re[Je].f,0,he,Te+224,8),s(Re[Je].ea,0,Ee,Xe+224,8)),N=8*ie*f.B,Re=f.sa,Je=f.ta+16*R+16*ie*f.R,pt=f.qa,fe=f.ra+8*R+N,Qe=f.Ha,yt=f.Ia+8*R+N,N=0;16>N;++N)s(Re,Je+N*f.R,re,le+32*N,16);for(N=0;8>N;++N)s(pt,fe+N*f.B,he,Te+32*N,8),s(Qe,yt+N*f.B,Ee,Xe+32*N,8)}}function ts(f,x,N,R,X,ie,re,le,he){var Te=[0],Ee=[0],Xe=0,fe=he!=null?he.kd:0,Re=he??new mt;if(f==null||12>N)return 7;Re.data=f,Re.w=x,Re.ha=N,x=[x],N=[N],Re.gb=[Re.gb];e:{var Je=x,pt=N,Qe=Re.gb;if(r(f!=null),r(pt!=null),r(Qe!=null),Qe[0]=0,12<=pt[0]&&!o(f,Je[0],"RIFF")){if(o(f,Je[0]+8,"WEBP")){Qe=3;break e}var yt=Wt(f,Je[0]+4);if(12>yt||4294967286<yt){Qe=3;break e}if(fe&&yt>pt[0]-8){Qe=7;break e}Qe[0]=yt,Je[0]+=12,pt[0]-=12}Qe=0}if(Qe!=0)return Qe;for(yt=0<Re.gb[0],N=N[0];;){e:{var vt=f;pt=x,Qe=N;var Ft=Te,Nt=Ee,bn=Je=[0];if((xn=Xe=[Xe])[0]=0,8>Qe[0])Qe=7;else{if(!o(vt,pt[0],"VP8X")){if(Wt(vt,pt[0]+4)!=10){Qe=3;break e}if(18>Qe[0]){Qe=7;break e}var gn=Wt(vt,pt[0]+8),ri=1+St(vt,pt[0]+12);if(2147483648<=ri*(vt=1+St(vt,pt[0]+15))){Qe=3;break e}bn!=null&&(bn[0]=gn),Ft!=null&&(Ft[0]=ri),Nt!=null&&(Nt[0]=vt),pt[0]+=18,Qe[0]-=18,xn[0]=1}Qe=0}}if(Xe=Xe[0],Je=Je[0],Qe!=0)return Qe;if(pt=!!(2&Je),!yt&&Xe)return 3;if(ie!=null&&(ie[0]=!!(16&Je)),re!=null&&(re[0]=pt),le!=null&&(le[0]=0),re=Te[0],Je=Ee[0],Xe&&pt&&he==null){Qe=0;break}if(4>N){Qe=7;break}if(yt&&Xe||!yt&&!Xe&&!o(f,x[0],"ALPH")){N=[N],Re.na=[Re.na],Re.P=[Re.P],Re.Sa=[Re.Sa];e:{gn=f,Qe=x,yt=N;var xn=Re.gb;Ft=Re.na,Nt=Re.P,bn=Re.Sa,ri=22,r(gn!=null),r(yt!=null),vt=Qe[0];var Un=yt[0];for(r(Ft!=null),r(bn!=null),Ft[0]=null,Nt[0]=null,bn[0]=0;;){if(Qe[0]=vt,yt[0]=Un,8>Un){Qe=7;break e}var Fi=Wt(gn,vt+4);if(4294967286<Fi){Qe=3;break e}var Jn=8+Fi+1&-2;if(ri+=Jn,0<xn&&ri>xn){Qe=3;break e}if(!o(gn,vt,"VP8 ")||!o(gn,vt,"VP8L")){Qe=0;break e}if(Un[0]<Jn){Qe=7;break e}o(gn,vt,"ALPH")||(Ft[0]=gn,Nt[0]=vt+8,bn[0]=Fi),vt+=Jn,Un-=Jn}}if(N=N[0],Re.na=Re.na[0],Re.P=Re.P[0],Re.Sa=Re.Sa[0],Qe!=0)break}N=[N],Re.Ja=[Re.Ja],Re.xa=[Re.xa];e:if(xn=f,Qe=x,yt=N,Ft=Re.gb[0],Nt=Re.Ja,bn=Re.xa,gn=Qe[0],vt=!o(xn,gn,"VP8 "),ri=!o(xn,gn,"VP8L"),r(xn!=null),r(yt!=null),r(Nt!=null),r(bn!=null),8>yt[0])Qe=7;else{if(vt||ri){if(xn=Wt(xn,gn+4),12<=Ft&&xn>Ft-12){Qe=3;break e}if(fe&&xn>yt[0]-8){Qe=7;break e}Nt[0]=xn,Qe[0]+=8,yt[0]-=8,bn[0]=ri}else bn[0]=5<=yt[0]&&xn[gn+0]==47&&!(xn[gn+4]>>5),Nt[0]=yt[0];Qe=0}if(N=N[0],Re.Ja=Re.Ja[0],Re.xa=Re.xa[0],x=x[0],Qe!=0)break;if(4294967286<Re.Ja)return 3;if(le==null||pt||(le[0]=Re.xa?2:1),re=[re],Je=[Je],Re.xa){if(5>N){Qe=7;break}le=re,fe=Je,pt=ie,f==null||5>N?f=0:5<=N&&f[x+0]==47&&!(f[x+4]>>5)?(yt=[0],xn=[0],Ft=[0],Ie(Nt=new V,f,x,N),hi(Nt,yt,xn,Ft)?(le!=null&&(le[0]=yt[0]),fe!=null&&(fe[0]=xn[0]),pt!=null&&(pt[0]=Ft[0]),f=1):f=0):f=0}else{if(10>N){Qe=7;break}le=Je,f==null||10>N||!yi(f,x+3,N-3)?f=0:(fe=f[x+0]|f[x+1]<<8|f[x+2]<<16,pt=16383&(f[x+7]<<8|f[x+6]),f=16383&(f[x+9]<<8|f[x+8]),1&fe||3<(fe>>1&7)||!(fe>>4&1)||fe>>5>=Re.Ja||!pt||!f?f=0:(re&&(re[0]=pt),le&&(le[0]=f),f=1))}if(!f||(re=re[0],Je=Je[0],Xe&&(Te[0]!=re||Ee[0]!=Je)))return 3;he!=null&&(he[0]=Re,he.offset=x-he.w,r(4294967286>x-he.w),r(he.offset==he.ha-N));break}return Qe==0||Qe==7&&Xe&&he==null?(ie!=null&&(ie[0]|=Re.na!=null&&0<Re.na.length),R!=null&&(R[0]=re),X!=null&&(X[0]=Je),0):Qe}function Gs(f,x,N){var R=x.width,X=x.height,ie=0,re=0,le=R,he=X;if(x.Da=f!=null&&0<f.Da,x.Da&&(le=f.cd,he=f.bd,ie=f.v,re=f.j,11>N||(ie&=-2,re&=-2),0>ie||0>re||0>=le||0>=he||ie+le>R||re+he>X))return 0;if(x.v=ie,x.j=re,x.va=ie+le,x.o=re+he,x.U=le,x.T=he,x.da=f!=null&&0<f.da,x.da){if(!qt(le,he,N=[f.ib],ie=[f.hb]))return 0;x.ib=N[0],x.hb=ie[0]}return x.ob=f!=null&&f.ob,x.Kb=f==null||!f.Sd,x.da&&(x.ob=x.ib<3*R/4&&x.hb<3*X/4,x.Kb=0),1}function Po(f){if(f==null)return 2;if(11>f.S){var x=f.f.RGBA;x.fb+=(f.height-1)*x.A,x.A=-x.A}else x=f.f.kb,f=f.height,x.O+=(f-1)*x.fa,x.fa=-x.fa,x.N+=(f-1>>1)*x.Ab,x.Ab=-x.Ab,x.W+=(f-1>>1)*x.Db,x.Db=-x.Db,x.F!=null&&(x.J+=(f-1)*x.lb,x.lb=-x.lb);return 0}function ns(f,x,N,R){if(R==null||0>=f||0>=x)return 2;if(N!=null){if(N.Da){var X=N.cd,ie=N.bd,re=-2&N.v,le=-2&N.j;if(0>re||0>le||0>=X||0>=ie||re+X>f||le+ie>x)return 2;f=X,x=ie}if(N.da){if(!qt(f,x,X=[N.ib],ie=[N.hb]))return 2;f=X[0],x=ie[0]}}R.width=f,R.height=x;e:{var he=R.width,Te=R.height;if(f=R.S,0>=he||0>=Te||!(f>=Ii&&13>f))f=2;else{if(0>=R.Rd&&R.sd==null){re=ie=X=x=0;var Ee=(le=he*va[f])*Te;if(11>f||(ie=(Te+1)/2*(x=(he+1)/2),f==12&&(re=(X=he)*Te)),(Te=d(Ee+2*ie+re))==null){f=1;break e}R.sd=Te,11>f?((he=R.f.RGBA).eb=Te,he.fb=0,he.A=le,he.size=Ee):((he=R.f.kb).y=Te,he.O=0,he.fa=le,he.Fd=Ee,he.f=Te,he.N=0+Ee,he.Ab=x,he.Cd=ie,he.ea=Te,he.W=0+Ee+ie,he.Db=x,he.Ed=ie,f==12&&(he.F=Te,he.J=0+Ee+2*ie),he.Tc=re,he.lb=X)}if(x=1,X=R.S,ie=R.width,re=R.height,X>=Ii&&13>X)if(11>X)f=R.f.RGBA,x&=(le=Math.abs(f.A))*(re-1)+ie<=f.size,x&=le>=ie*va[X],x&=f.eb!=null;else{f=R.f.kb,le=(ie+1)/2,Ee=(re+1)/2,he=Math.abs(f.fa),Te=Math.abs(f.Ab);var Xe=Math.abs(f.Db),fe=Math.abs(f.lb),Re=fe*(re-1)+ie;x&=he*(re-1)+ie<=f.Fd,x&=Te*(Ee-1)+le<=f.Cd,x=(x&=Xe*(Ee-1)+le<=f.Ed)&he>=ie&Te>=le&Xe>=le,x&=f.y!=null,x&=f.f!=null,x&=f.ea!=null,X==12&&(x&=fe>=ie,x&=Re<=f.Tc,x&=f.F!=null)}else x=0;f=x?0:2}}return f!=0||N!=null&&N.fd&&(f=Po(R)),f}var ho=64,Fo=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],$r=24,Ds=32,Qo=8,Xs=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Yt("Predictor0","PredictorAdd0"),O.Predictor0=function(){return 4278190080},O.Predictor1=function(f){return f},O.Predictor2=function(f,x,N){return x[N+0]},O.Predictor3=function(f,x,N){return x[N+1]},O.Predictor4=function(f,x,N){return x[N-1]},O.Predictor5=function(f,x,N){return cn(cn(f,x[N+1]),x[N+0])},O.Predictor6=function(f,x,N){return cn(f,x[N-1])},O.Predictor7=function(f,x,N){return cn(f,x[N+0])},O.Predictor8=function(f,x,N){return cn(x[N-1],x[N+0])},O.Predictor9=function(f,x,N){return cn(x[N+0],x[N+1])},O.Predictor10=function(f,x,N){return cn(cn(f,x[N-1]),cn(x[N+0],x[N+1]))},O.Predictor11=function(f,x,N){var R=x[N+0];return 0>=tt(R>>24&255,f>>24&255,(x=x[N-1])>>24&255)+tt(R>>16&255,f>>16&255,x>>16&255)+tt(R>>8&255,f>>8&255,x>>8&255)+tt(255&R,255&f,255&x)?R:f},O.Predictor12=function(f,x,N){var R=x[N+0];return(Sn((f>>24&255)+(R>>24&255)-((x=x[N-1])>>24&255))<<24|Sn((f>>16&255)+(R>>16&255)-(x>>16&255))<<16|Sn((f>>8&255)+(R>>8&255)-(x>>8&255))<<8|Sn((255&f)+(255&R)-(255&x)))>>>0},O.Predictor13=function(f,x,N){var R=x[N-1];return(mn((f=cn(f,x[N+0]))>>24&255,R>>24&255)<<24|mn(f>>16&255,R>>16&255)<<16|mn(f>>8&255,R>>8&255)<<8|mn(255&f,255&R))>>>0};var Va=O.PredictorAdd0;O.PredictorAdd1=Bt,Yt("Predictor2","PredictorAdd2"),Yt("Predictor3","PredictorAdd3"),Yt("Predictor4","PredictorAdd4"),Yt("Predictor5","PredictorAdd5"),Yt("Predictor6","PredictorAdd6"),Yt("Predictor7","PredictorAdd7"),Yt("Predictor8","PredictorAdd8"),Yt("Predictor9","PredictorAdd9"),Yt("Predictor10","PredictorAdd10"),Yt("Predictor11","PredictorAdd11"),Yt("Predictor12","PredictorAdd12"),Yt("Predictor13","PredictorAdd13");var Kl=O.PredictorAdd2;Mt("ColorIndexInverseTransform","MapARGB","32b",function(f){return f>>8&255},function(f){return f}),Mt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(f){return f},function(f){return f>>8&255});var Zn,xs=O.ColorIndexInverseTransform,Gi=O.MapARGB,ea=O.VP8LColorIndexInverseTransformAlpha,Uo=O.MapAlpha,ga=O.VP8LPredictorsAdd=[];ga.length=16,(O.VP8LPredictors=[]).length=16,(O.VP8LPredictorsAdd_C=[]).length=16,(O.VP8LPredictors_C=[]).length=16;var _c,Ks,Cl,jl,bo,Nl,Eo,qa,hr,is,Vi,Xi,gr,vo,rs,Zs,fc,ru,Ku,Ha,go,kl,zo,Rs,wo,_o,no,ya,sr=d(511),ai=d(2041),Mr=d(225),io=d(767),Do=0,dl=ai,Wa=Mr,ta=io,Yr=sr,Ii=0,Ai=1,Dc=2,br=3,ro=4,fl=5,oo=6,os=7,na=8,pl=9,ou=10,ms=[2,3,7],as=[3,3,11],hl=[280,256,256,256,40],Rc=[0,1,1,1,0],Al=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],bs=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],ia=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],$a=8,So=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Ro=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Da=null,au=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Pl=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],vs=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Zu=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],vr=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Br=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],On=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Vo=[],ao=[],xa=[],ma=1,Ic=2,ba=[],Gr=[];fa("UpsampleRgbLinePair",ha,3),fa("UpsampleBgrLinePair",er,3),fa("UpsampleRgbaLinePair",to,4),fa("UpsampleBgraLinePair",tr,4),fa("UpsampleArgbLinePair",es,4),fa("UpsampleRgba4444LinePair",mo,2),fa("UpsampleRgb565LinePair",za,2);var Js=O.UpsampleRgbLinePair,ws=O.UpsampleBgrLinePair,Lc=O.UpsampleRgbaLinePair,su=O.UpsampleBgraLinePair,Zl=O.UpsampleArgbLinePair,gl=O.UpsampleRgba4444LinePair,yl=O.UpsampleRgb565LinePair,Ss=16,pc=1<<Ss-1,Jl=-227,Ya=482,To=6,Ga=0,qi=d(256),ju=d(256),Ju=d(256),ra=d(256),ss=d(Ya-Jl),Ra=d(Ya-Jl);Tl("YuvToRgbRow",ha,3),Tl("YuvToBgrRow",er,3),Tl("YuvToRgbaRow",to,4),Tl("YuvToBgraRow",tr,4),Tl("YuvToArgbRow",es,4),Tl("YuvToRgba4444Row",mo,2),Tl("YuvToRgb565Row",za,2);var Hi=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Co=[0,2,8],oa=[8,7,6,4,4,2,2,2,1,1,1,1],qo=1;this.WebPDecodeRGBA=function(f,x,N,R,X){var ie=Ai,re=new gt,le=new Xt;re.ba=le,le.S=ie,le.width=[le.width],le.height=[le.height];var he=le.width,Te=le.height,Ee=new pn;if(Ee==null||f==null)var Xe=2;else r(Ee!=null),Xe=ts(f,x,N,Ee.width,Ee.height,Ee.Pd,Ee.Qd,Ee.format,null);if(Xe!=0?he=0:(he!=null&&(he[0]=Ee.width[0]),Te!=null&&(Te[0]=Ee.height[0]),he=1),he){le.width=le.width[0],le.height=le.height[0],R!=null&&(R[0]=le.width),X!=null&&(X[0]=le.height);e:{if(R=new Ws,(X=new mt).data=f,X.w=x,X.ha=N,X.kd=1,x=[0],r(X!=null),((f=ts(X.data,X.w,X.ha,null,null,null,x,null,X))==0||f==7)&&x[0]&&(f=4),(x=f)==0){if(r(re!=null),R.data=X.data,R.w=X.w+X.offset,R.ha=X.ha-X.offset,R.put=nn,R.ac=ni,R.bc=xi,R.ma=re,X.xa){if((f=Ti())==null){re=1;break e}if((function(fe,Re){var Je=[0],pt=[0],Qe=[0];t:for(;;){if(fe==null)return 0;if(Re==null)return fe.a=2,0;if(fe.l=Re,fe.a=0,Ie(fe.m,Re.data,Re.w,Re.ha),!hi(fe.m,Je,pt,Qe)){fe.a=3;break t}if(fe.xb=Ic,Re.width=Je[0],Re.height=pt[0],!_i(Je[0],pt[0],1,fe,null))break t;return 1}return r(fe.a!=0),0})(f,R)){if(R=(x=ns(R.width,R.height,re.Oa,re.ba))==0){t:{R=f;n:for(;;){if(R==null){R=0;break t}if(r(R.s.yc!=null),r(R.s.Ya!=null),r(0<R.s.Wb),r((N=R.l)!=null),r((X=N.ma)!=null),R.xb!=0){if(R.ca=X.ba,R.tb=X.tb,r(R.ca!=null),!Gs(X.Oa,N,br)){R.a=2;break n}if(!mr(R,N.width)||N.da)break n;if((N.da||zt(R.ca.S))&&Lr(),11>R.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),R.ca.f.kb.F!=null&&Lr()),R.Pb&&0<R.s.ua&&R.s.vb.X==null&&!ge(R.s.vb,R.s.Wa.Xa)){R.a=1;break n}R.xb=0}if(!Zt(R,R.V,R.Ba,R.c,R.i,N.o,Si))break n;X.Dc=R.Ma,R=1;break t}r(R.a!=0),R=0}R=!R}R&&(x=f.a)}else x=f.a}else{if((f=new _r)==null){re=1;break e}if(f.Fa=X.na,f.P=X.P,f.qc=X.Sa,Tr(f,R)){if((x=ns(R.width,R.height,re.Oa,re.ba))==0){if(f.Aa=0,N=re.Oa,r((X=f)!=null),N!=null){if(0<(he=0>(he=N.Md)?0:100<he?255:255*he/100)){for(Te=Ee=0;4>Te;++Te)12>(Xe=X.pb[Te]).lc&&(Xe.ia=he*oa[0>Xe.lc?0:Xe.lc]>>3),Ee|=Xe.ia;Ee&&(alert("todo:VP8InitRandom"),X.ia=1)}X.Ga=N.Id,100<X.Ga?X.Ga=100:0>X.Ga&&(X.Ga=0)}(function(fe,Re){if(fe==null)return 0;if(Re==null)return $i(fe,2,"NULL VP8Io parameter in VP8Decode().");if(!fe.cb&&!Tr(fe,Re))return 0;if(r(fe.cb),Re.ac==null||Re.ac(Re)){Re.ob&&(fe.L=0);var Je=Co[fe.L];if(fe.L==2?(fe.yb=0,fe.zb=0):(fe.yb=Re.v-Je>>4,fe.zb=Re.j-Je>>4,0>fe.yb&&(fe.yb=0),0>fe.zb&&(fe.zb=0)),fe.Va=Re.o+15+Je>>4,fe.Hb=Re.va+15+Je>>4,fe.Hb>fe.za&&(fe.Hb=fe.za),fe.Va>fe.Ub&&(fe.Va=fe.Ub),0<fe.L){var pt=fe.ed;for(Je=0;4>Je;++Je){var Qe;if(fe.Qa.Cb){var yt=fe.Qa.Lb[Je];fe.Qa.Fb||(yt+=pt.Tb)}else yt=pt.Tb;for(Qe=0;1>=Qe;++Qe){var vt=fe.gd[Je][Qe],Ft=yt;if(pt.Pc&&(Ft+=pt.vd[0],Qe&&(Ft+=pt.od[0])),0<(Ft=0>Ft?0:63<Ft?63:Ft)){var Nt=Ft;0<pt.wb&&(Nt=4<pt.wb?Nt>>2:Nt>>1)>9-pt.wb&&(Nt=9-pt.wb),1>Nt&&(Nt=1),vt.dd=Nt,vt.tc=2*Ft+Nt,vt.ld=40<=Ft?2:15<=Ft?1:0}else vt.tc=0;vt.La=Qe}}}Je=0}else $i(fe,6,"Frame setup failed"),Je=fe.a;if(Je=Je==0){if(Je){fe.$c=0,0<fe.Aa||(fe.Ic=qo);t:{Je=fe.Ic,pt=4*(Nt=fe.za);var bn=32*Nt,gn=Nt+1,ri=0<fe.L?Nt*(0<fe.Aa?2:1):0,xn=(fe.Aa==2?2:1)*Nt;if((vt=pt+832+(Qe=3*(16*Je+Co[fe.L])/2*bn)+(yt=fe.Fa!=null&&0<fe.Fa.length?fe.Kc.c*fe.Kc.i:0))!=vt)Je=0;else{if(vt>fe.Vb){if(fe.Vb=0,fe.Ec=d(vt),fe.Fc=0,fe.Ec==null){Je=$i(fe,1,"no memory during frame initialization.");break t}fe.Vb=vt}vt=fe.Ec,Ft=fe.Fc,fe.Ac=vt,fe.Bc=Ft,Ft+=pt,fe.Gd=b(bn,Za),fe.Hd=0,fe.rb=b(gn+1,Mo),fe.sb=1,fe.wa=ri?b(ri,gi):null,fe.Y=0,fe.D.Nb=0,fe.D.wa=fe.wa,fe.D.Y=fe.Y,0<fe.Aa&&(fe.D.Y+=Nt),r(!0),fe.oc=vt,fe.pc=Ft,Ft+=832,fe.ya=b(xn,zs),fe.aa=0,fe.D.ya=fe.ya,fe.D.aa=fe.aa,fe.Aa==2&&(fe.D.aa+=Nt),fe.R=16*Nt,fe.B=8*Nt,Nt=(bn=Co[fe.L])*fe.R,bn=bn/2*fe.B,fe.sa=vt,fe.ta=Ft+Nt,fe.qa=fe.sa,fe.ra=fe.ta+16*Je*fe.R+bn,fe.Ha=fe.qa,fe.Ia=fe.ra+8*Je*fe.B+bn,fe.$c=0,Ft+=Qe,fe.mb=yt?vt:null,fe.nb=yt?Ft:null,r(Ft+yt<=fe.Fc+fe.Vb),Yl(fe),l(fe.Ac,fe.Bc,0,pt),Je=1}}if(Je){if(Re.ka=0,Re.y=fe.sa,Re.O=fe.ta,Re.f=fe.qa,Re.N=fe.ra,Re.ea=fe.Ha,Re.Vd=fe.Ia,Re.fa=fe.R,Re.Rc=fe.B,Re.F=null,Re.J=0,!Do){for(Je=-255;255>=Je;++Je)sr[255+Je]=0>Je?-Je:Je;for(Je=-1020;1020>=Je;++Je)ai[1020+Je]=-128>Je?-128:127<Je?127:Je;for(Je=-112;112>=Je;++Je)Mr[112+Je]=-16>Je?-16:15<Je?15:Je;for(Je=-255;510>=Je;++Je)io[255+Je]=0>Je?0:255<Je?255:Je;Do=1}Eo=Di,qa=ca,is=Cr,Vi=Xl,Xi=Wr,hr=Gl,gr=nu,vo=gs,rs=Q,Zs=pe,fc=iu,ru=C,Ku=Be,Ha=Ve,go=Ea,kl=fo,zo=Aa,Rs=hs,ao[0]=Fa,ao[1]=Ba,ao[2]=Ct,ao[3]=Kn,ao[4]=ua,ao[5]=Tn,ao[6]=wn,ao[7]=ul,ao[8]=Mn,ao[9]=Oo,Vo[0]=jr,Vo[1]=fs,Vo[2]=ka,Vo[3]=Ko,Vo[4]=ps,Vo[5]=Oa,Vo[6]=$s,xa[0]=ji,xa[1]=Bo,xa[2]=yn,xa[3]=Ri,xa[4]=Zo,xa[5]=Cn,xa[6]=Qt,Je=1}else Je=0}Je&&(Je=(function(Un,Fi){for(Un.M=0;Un.M<Un.Va;++Un.M){var Jn,un=Un.Jc[Un.M&Un.Xb],Ut=Un.m,Qn=Un;for(Jn=0;Jn<Qn.za;++Jn){var Gn=Ut,ei=Qn,wr=ei.Ac,Ho=ei.Bc+4*Jn,Wo=ei.zc,fi=ei.ya[ei.aa+Jn];if(ei.Qa.Bb?fi.$b=De(Gn,ei.Pa.jb[0])?2+De(Gn,ei.Pa.jb[2]):De(Gn,ei.Pa.jb[1]):fi.$b=0,ei.kc&&(fi.Ad=De(Gn,ei.Bd)),fi.Za=!De(Gn,145)+0,fi.Za){var nr=fi.Ob,yo=0;for(ei=0;4>ei;++ei){var Er,si=Wo[0+ei];for(Er=0;4>Er;++Er){si=vr[wr[Ho+Er]][si];for(var ki=vs[De(Gn,si[0])];0<ki;)ki=vs[2*ki+De(Gn,si[ki])];si=-ki,wr[Ho+Er]=si}s(nr,yo,wr,Ho,4),yo+=4,Wo[0+ei]=si}}else si=De(Gn,156)?De(Gn,128)?1:3:De(Gn,163)?2:0,fi.Ob[0]=si,l(wr,Ho,si,4),l(Wo,0,si,4);fi.Dd=De(Gn,142)?De(Gn,114)?De(Gn,183)?1:3:2:0}if(Qn.m.Ka)return $i(Un,7,"Premature end-of-partition0 encountered.");for(;Un.ja<Un.za;++Un.ja){if(Qn=un,Gn=(Ut=Un).rb[Ut.sb-1],wr=Ut.rb[Ut.sb+Ut.ja],Jn=Ut.ya[Ut.aa+Ut.ja],Ho=Ut.kc?Jn.Ad:0)Gn.la=wr.la=0,Jn.Za||(Gn.Na=wr.Na=0),Jn.Hc=0,Jn.Gc=0,Jn.ia=0;else{var lr,cr;if(Gn=wr,wr=Qn,Ho=Ut.Pa.Xc,Wo=Ut.ya[Ut.aa+Ut.ja],fi=Ut.pb[Wo.$b],ei=Wo.ad,nr=0,yo=Ut.rb[Ut.sb-1],si=Er=0,l(ei,nr,0,384),Wo.Za)var Xr=0,Oi=Ho[3];else{ki=d(16);var ci=Gn.Na+yo.Na;if(ci=Da(wr,Ho[1],ci,fi.Eb,0,ki,0),Gn.Na=yo.Na=(0<ci)+0,1<ci)Eo(ki,0,ei,nr);else{var Li=ki[0]+3>>3;for(ki=0;256>ki;ki+=16)ei[nr+ki]=Li}Xr=1,Oi=Ho[0]}var Pi=15&Gn.la,ur=15&yo.la;for(ki=0;4>ki;++ki){var Kr=1&ur;for(Li=cr=0;4>Li;++Li)Pi=Pi>>1|(Kr=(ci=Da(wr,Oi,ci=Kr+(1&Pi),fi.Sc,Xr,ei,nr))>Xr)<<7,cr=cr<<2|(3<ci?3:1<ci?2:ei[nr+0]!=0),nr+=16;Pi>>=4,ur=ur>>1|Kr<<7,Er=(Er<<8|cr)>>>0}for(Oi=Pi,Xr=ur>>4,lr=0;4>lr;lr+=2){for(cr=0,Pi=Gn.la>>4+lr,ur=yo.la>>4+lr,ki=0;2>ki;++ki){for(Kr=1&ur,Li=0;2>Li;++Li)ci=Kr+(1&Pi),Pi=Pi>>1|(Kr=0<(ci=Da(wr,Ho[2],ci,fi.Qc,0,ei,nr)))<<3,cr=cr<<2|(3<ci?3:1<ci?2:ei[nr+0]!=0),nr+=16;Pi>>=2,ur=ur>>1|Kr<<5}si|=cr<<4*lr,Oi|=Pi<<4<<lr,Xr|=(240&ur)<<lr}Gn.la=Oi,yo.la=Xr,Wo.Hc=Er,Wo.Gc=si,Wo.ia=43690&si?0:fi.ia,Ho=!(Er|si)}if(0<Ut.L&&(Ut.wa[Ut.Y+Ut.ja]=Ut.gd[Jn.$b][Jn.Za],Ut.wa[Ut.Y+Ut.ja].La|=!Ho),Qn.Ka)return $i(Un,7,"Premature end-of-file encountered.")}if(Yl(Un),Ut=Fi,Qn=1,Jn=(un=Un).D,Gn=0<un.L&&un.M>=un.zb&&un.M<=un.Va,un.Aa==0)t:{if(Jn.M=un.M,Jn.uc=Gn,_a(un,Jn),Qn=1,Jn=(cr=un.D).Nb,Gn=(si=Co[un.L])*un.R,wr=si/2*un.B,ki=16*Jn*un.R,Li=8*Jn*un.B,Ho=un.sa,Wo=un.ta-Gn+ki,fi=un.qa,ei=un.ra-wr+Li,nr=un.Ha,yo=un.Ia-wr+Li,ur=(Pi=cr.M)==0,Er=Pi>=un.Va-1,un.Aa==2&&_a(un,cr),cr.uc)for(Kr=(ci=un).D.M,r(ci.D.uc),cr=ci.yb;cr<ci.Hb;++cr){Xr=cr,Oi=Kr;var ir=(Ui=(yr=ci).D).Nb;lr=yr.R;var Ui=Ui.wa[Ui.Y+Xr],Ia=yr.sa,Ki=yr.ta+16*ir*lr+16*Xr,An=Ui.dd,Dn=Ui.tc;if(Dn!=0)if(r(3<=Dn),yr.L==1)0<Xr&&kl(Ia,Ki,lr,Dn+4),Ui.La&&Rs(Ia,Ki,lr,Dn),0<Oi&&go(Ia,Ki,lr,Dn+4),Ui.La&&zo(Ia,Ki,lr,Dn);else{var Zi=yr.B,wa=yr.qa,Ts=yr.ra+8*ir*Zi+8*Xr,Sa=yr.Ha,yr=yr.Ia+8*ir*Zi+8*Xr;ir=Ui.ld,0<Xr&&(vo(Ia,Ki,lr,Dn+4,An,ir),Zs(wa,Ts,Sa,yr,Zi,Dn+4,An,ir)),Ui.La&&(ru(Ia,Ki,lr,Dn,An,ir),Ha(wa,Ts,Sa,yr,Zi,Dn,An,ir)),0<Oi&&(gr(Ia,Ki,lr,Dn+4,An,ir),rs(wa,Ts,Sa,yr,Zi,Dn+4,An,ir)),Ui.La&&(fc(Ia,Ki,lr,Dn,An,ir),Ku(wa,Ts,Sa,yr,Zi,Dn,An,ir))}}if(un.ia&&alert("todo:DitherRow"),Ut.put!=null){if(cr=16*Pi,Pi=16*(Pi+1),ur?(Ut.y=un.sa,Ut.O=un.ta+ki,Ut.f=un.qa,Ut.N=un.ra+Li,Ut.ea=un.Ha,Ut.W=un.Ia+Li):(cr-=si,Ut.y=Ho,Ut.O=Wo,Ut.f=fi,Ut.N=ei,Ut.ea=nr,Ut.W=yo),Er||(Pi-=si),Pi>Ut.o&&(Pi=Ut.o),Ut.F=null,Ut.J=null,un.Fa!=null&&0<un.Fa.length&&cr<Pi&&(Ut.J=Dr(un,Ut,cr,Pi-cr),Ut.F=un.mb,Ut.F==null&&Ut.F.length==0)){Qn=$i(un,3,"Could not decode alpha data.");break t}cr<Ut.j&&(si=Ut.j-cr,cr=Ut.j,r(!(1&si)),Ut.O+=un.R*si,Ut.N+=un.B*(si>>1),Ut.W+=un.B*(si>>1),Ut.F!=null&&(Ut.J+=Ut.width*si)),cr<Pi&&(Ut.O+=Ut.v,Ut.N+=Ut.v>>1,Ut.W+=Ut.v>>1,Ut.F!=null&&(Ut.J+=Ut.v),Ut.ka=cr-Ut.j,Ut.U=Ut.va-Ut.v,Ut.T=Pi-cr,Qn=Ut.put(Ut))}Jn+1!=un.Ic||Er||(s(un.sa,un.ta-Gn,Ho,Wo+16*un.R,Gn),s(un.qa,un.ra-wr,fi,ei+8*un.B,wr),s(un.Ha,un.Ia-wr,nr,yo+8*un.B,wr))}if(!Qn)return $i(Un,6,"Output aborted.")}return 1})(fe,Re)),Re.bc!=null&&Re.bc(Re),Je&=1}return Je?(fe.cb=0,Je):0})(f,R)||(x=f.a)}}else x=f.a}x==0&&re.Oa!=null&&re.Oa.fd&&(x=Po(re.ba))}re=x}ie=re!=0?null:11>ie?le.f.RGBA.eb:le.f.kb.y}else ie=null;return ie};var va=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function m(O,W){for(var Y="",D=0;D<4;D++)Y+=String.fromCharCode(O[W++]);return Y}function j(O,W){return O[W+0]|O[W+1]<<8}function _(O,W){return(O[W+0]|O[W+1]<<8|O[W+2]<<16)>>>0}function M(O,W){return(O[W+0]|O[W+1]<<8|O[W+2]<<16|O[W+3]<<24)>>>0}new v;var T=[0],F=[0],P=[],k=new v,y=n,ae=(function(O,W){var Y={},D=0,J=!1,$=0,je=0;if(Y.frames=[],!(function(w,V){for(var H=0;H<4;H++)if(w[V+H]!="RIFF".charCodeAt(H))return!0;return!1})(O,W)){for(M(O,W+=4),W+=8;W<O.length;){var ee=m(O,W),de=M(O,W+=4);W+=4;var Ne=de+(1&de);switch(ee){case"VP8 ":case"VP8L":Y.frames[D]===void 0&&(Y.frames[D]={}),(q=Y.frames[D]).src_off=J?je:W-8,q.src_size=$+de+8,D++,J&&(J=!1,$=0,je=0);break;case"VP8X":(q=Y.header={}).feature_flags=O[W];var Ie=W+4;q.canvas_width=1+_(O,Ie),Ie+=3,q.canvas_height=1+_(O,Ie),Ie+=3;break;case"ALPH":J=!0,$=Ne+8,je=W-8;break;case"ANIM":(q=Y.header).bgcolor=M(O,W),Ie=W+4,q.loop_count=j(O,Ie),Ie+=2;break;case"ANMF":var $e,q;(q=Y.frames[D]={}).offset_x=2*_(O,W),W+=3,q.offset_y=2*_(O,W),W+=3,q.width=1+_(O,W),W+=3,q.height=1+_(O,W),W+=3,q.duration=_(O,W),W+=3,$e=O[W++],q.dispose=1&$e,q.blend=$e>>1&1}ee!="ANMF"&&(W+=Ne)}return Y}})(y,0);ae.response=y,ae.rgbaoutput=!0,ae.dataurl=!1;var E=ae.header?ae.header:null,U=ae.frames?ae.frames:null;if(E){E.loop_counter=E.loop_count,T=[E.canvas_height],F=[E.canvas_width];for(var ne=0;ne<U.length&&U[ne].blend!=0;ne++);}var Z=U[0],G=k.WebPDecodeRGBA(y,Z.src_off,Z.src_size,F,T);Z.rgba=G,Z.imgwidth=F[0],Z.imgheight=T[0];for(var te=0;te<F[0]*T[0]*4;te++)P[te]=G[te];return this.width=F,this.height=T,this.data=P,this}(function(n){var r,o,s,l,d,b,p,v,m,j=function(w){return w=w||{},this.isStrokeTransparent=w.isStrokeTransparent||!1,this.strokeOpacity=w.strokeOpacity||1,this.strokeStyle=w.strokeStyle||"#000000",this.fillStyle=w.fillStyle||"#000000",this.isFillTransparent=w.isFillTransparent||!1,this.fillOpacity=w.fillOpacity||1,this.font=w.font||"10px sans-serif",this.textBaseline=w.textBaseline||"alphabetic",this.textAlign=w.textAlign||"left",this.lineWidth=w.lineWidth||1,this.lineJoin=w.lineJoin||"miter",this.lineCap=w.lineCap||"butt",this.path=w.path||[],this.transform=w.transform!==void 0?w.transform.clone():new v,this.globalCompositeOperation=w.globalCompositeOperation||"normal",this.globalAlpha=w.globalAlpha||1,this.clip_path=w.clip_path||[],this.currentPoint=w.currentPoint||new b,this.miterLimit=w.miterLimit||10,this.lastPoint=w.lastPoint||new b,this.lineDashOffset=w.lineDashOffset||0,this.lineDash=w.lineDash||[],this.margin=w.margin||[0,0,0,0],this.prevPageLastElemOffset=w.prevPageLastElemOffset||0,this.ignoreClearRect=typeof w.ignoreClearRect!="boolean"||w.ignoreClearRect,this};n.events.push(["initialized",function(){this.context2d=new _(this),r=this.internal.f2,o=this.internal.getCoordinateString,s=this.internal.getVerticalCoordinateString,l=this.internal.getHorizontalCoordinate,d=this.internal.getVerticalCoordinate,b=this.internal.Point,p=this.internal.Rectangle,v=this.internal.Matrix,m=new j}]);var _=function(w){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var V=w;Object.defineProperty(this,"pdf",{get:function(){return V}});var H=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return H},set:function(ge){H=!!ge}});var ue=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return ue},set:function(ge){ue=!!ge}});var ve=0;Object.defineProperty(this,"posX",{get:function(){return ve},set:function(ge){isNaN(ge)||(ve=ge)}});var se=0;Object.defineProperty(this,"posY",{get:function(){return se},set:function(ge){isNaN(ge)||(se=ge)}}),Object.defineProperty(this,"margin",{get:function(){return m.margin},set:function(ge){var Ot;typeof ge=="number"?Ot=[ge,ge,ge,ge]:((Ot=new Array(4))[0]=ge[0],Ot[1]=ge.length>=2?ge[1]:Ot[0],Ot[2]=ge.length>=3?ge[2]:Ot[0],Ot[3]=ge.length>=4?ge[3]:Ot[1]),m.margin=Ot}});var ze=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ze},set:function(ge){ze=ge}});var xe=0;Object.defineProperty(this,"lastBreak",{get:function(){return xe},set:function(ge){xe=ge}});var De=[];Object.defineProperty(this,"pageBreaks",{get:function(){return De},set:function(ge){De=ge}}),Object.defineProperty(this,"ctx",{get:function(){return m},set:function(ge){ge instanceof j&&(m=ge)}}),Object.defineProperty(this,"path",{get:function(){return m.path},set:function(ge){m.path=ge}});var Ye=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ye},set:function(ge){Ye=ge}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ge){var Ot;Ot=M(ge),this.ctx.fillStyle=Ot.style,this.ctx.isFillTransparent=Ot.a===0,this.ctx.fillOpacity=Ot.a,this.pdf.setFillColor(Ot.r,Ot.g,Ot.b,{a:Ot.a}),this.pdf.setTextColor(Ot.r,Ot.g,Ot.b,{a:Ot.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ge){var Ot=M(ge);this.ctx.strokeStyle=Ot.style,this.ctx.isStrokeTransparent=Ot.a===0,this.ctx.strokeOpacity=Ot.a,Ot.a===0?this.pdf.setDrawColor(255,255,255):(Ot.a,this.pdf.setDrawColor(Ot.r,Ot.g,Ot.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ge){["butt","round","square"].indexOf(ge)!==-1&&(this.ctx.lineCap=ge,this.pdf.setLineCap(ge))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ge){isNaN(ge)||(this.ctx.lineWidth=ge,this.pdf.setLineWidth(ge))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ge){["bevel","round","miter"].indexOf(ge)!==-1&&(this.ctx.lineJoin=ge,this.pdf.setLineJoin(ge))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ge){isNaN(ge)||(this.ctx.miterLimit=ge,this.pdf.setMiterLimit(ge))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ge){this.ctx.textBaseline=ge}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ge){["right","end","center","left","start"].indexOf(ge)!==-1&&(this.ctx.textAlign=ge)}});var lt=null,St=null,Wt=null;Object.defineProperty(this,"fontFaces",{get:function(){return Wt},set:function(ge){lt=null,St=null,Wt=ge}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ge){var Ot;if(this.ctx.font=ge,(Ot=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(ge))!==null){var _t=Ot[1];Ot[2];var qt=Ot[3],ht=Ot[4];Ot[5];var fn=Ot[6],Yt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ht)[2];ht=Math.floor(Yt==="px"?parseFloat(ht)*this.pdf.internal.scaleFactor:Yt==="em"?parseFloat(ht)*this.pdf.getFontSize():parseFloat(ht)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ht);var ln=(function(Mt){var Me,we,st=[],et=Mt.trim();if(et==="")return Ug;if(et in Ry)return[Ry[et]];for(;et!=="";){switch(we=null,Me=(et=Ly(et)).charAt(0)){case'"':case"'":we=_5(et.substring(1),Me);break;default:we=D5(et)}if(we===null||(st.push(we[0]),(et=Ly(we[1]))!==""&&et.charAt(0)!==","))return Ug;et=et.replace(/^,/,"")}return st})(fn);if(this.fontFaces){var cn=(function(Mt,Me){var we=Mt.getFontList(),st=JSON.stringify(we);if(lt===null||St!==st){var et=(function(Pt){var Rt=[];return Object.keys(Pt).forEach(function(Ge){Pt[Ge].forEach(function(zt){var Tt=null;switch(zt){case"bold":Tt={family:Ge,weight:"bold"};break;case"italic":Tt={family:Ge,style:"italic"};break;case"bolditalic":Tt={family:Ge,weight:"bold",style:"italic"};break;case"":case"normal":Tt={family:Ge}}Tt!==null&&(Tt.ref={name:Ge,style:zt},Rt.push(Tt))})}),Rt})(we);lt=(function(Pt){for(var Rt={},Ge=0;Ge<Pt.length;++Ge){var zt=Fg(Pt[Ge]),Tt=zt.family,tn=zt.stretch,Xt=zt.style,pn=zt.weight;Rt[Tt]=Rt[Tt]||{},Rt[Tt][tn]=Rt[Tt][tn]||{},Rt[Tt][tn][Xt]=Rt[Tt][tn][Xt]||{},Rt[Tt][tn][Xt][pn]=zt}return Rt})(et.concat(Me)),St=st}return lt})(this.pdf,this.fontFaces),Sn=ln.map(function(Mt){return{family:Mt,stretch:"normal",weight:qt,style:_t}}),mn=(function(Mt,Me,we){for(var st=(we=we||{}).defaultFontFamily||"times",et=Object.assign({},z5,we.genericFontFamilies||{}),Pt=null,Rt=null,Ge=0;Ge<Me.length;++Ge)if(et[(Pt=Fg(Me[Ge])).family]&&(Pt.family=et[Pt.family]),Mt.hasOwnProperty(Pt.family)){Rt=Mt[Pt.family];break}if(!(Rt=Rt||Mt[st]))throw new Error("Could not find a font-family for the rule '"+Iy(Pt)+"' and default family '"+st+"'.");if(Rt=(function(zt,Tt){if(Tt[zt])return Tt[zt];var tn=a0[zt],Xt=tn<=a0.normal?-1:1,pn=Dy(Tt,Zx,tn,Xt);if(!pn)throw new Error("Could not find a matching font-stretch value for "+zt);return pn})(Pt.stretch,Rt),Rt=(function(zt,Tt){if(Tt[zt])return Tt[zt];for(var tn=Kx[zt],Xt=0;Xt<tn.length;++Xt)if(Tt[tn[Xt]])return Tt[tn[Xt]];throw new Error("Could not find a matching font-style for "+zt)})(Pt.style,Rt),!(Rt=(function(zt,Tt){if(Tt[zt])return Tt[zt];if(zt===400&&Tt[500])return Tt[500];if(zt===500&&Tt[400])return Tt[400];var tn=P5[zt],Xt=Dy(Tt,Jx,tn,zt<400?-1:1);if(!Xt)throw new Error("Could not find a matching font-weight for value "+zt);return Xt})(Pt.weight,Rt)))throw new Error("Failed to resolve a font for the rule '"+Iy(Pt)+"'.");return Rt})(cn,Sn);this.pdf.setFont(mn.ref.name,mn.ref.style)}else{var tt="";(qt==="bold"||parseInt(qt,10)>=700||_t==="bold")&&(tt="bold"),_t==="italic"&&(tt+="italic"),tt.length===0&&(tt="normal");for(var Bt="",Gt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},an=0;an<ln.length;an++){if(this.pdf.internal.getFont(ln[an],tt,{noFallback:!0,disableWarning:!0})!==void 0){Bt=ln[an];break}if(tt==="bolditalic"&&this.pdf.internal.getFont(ln[an],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Bt=ln[an],tt="bold";else if(this.pdf.internal.getFont(ln[an],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Bt=ln[an],tt="normal";break}}if(Bt===""){for(var dt=0;dt<ln.length;dt++)if(Gt[ln[dt]]){Bt=Gt[ln[dt]];break}}Bt=Bt===""?"Times":Bt,this.pdf.setFont(Bt,tt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ge){this.ctx.globalCompositeOperation=ge}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ge){this.ctx.globalAlpha=ge}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ge){this.ctx.lineDashOffset=ge,q.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ge){this.ctx.lineDash=ge,q.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ge){this.ctx.ignoreClearRect=!!ge}})};_.prototype.setLineDash=function(w){this.lineDash=w},_.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},_.prototype.fill=function(){U.call(this,"fill",!1)},_.prototype.stroke=function(){U.call(this,"stroke",!1)},_.prototype.beginPath=function(){this.path=[{type:"begin"}]},_.prototype.moveTo=function(w,V){if(isNaN(w)||isNaN(V))throw co.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var H=this.ctx.transform.applyToPoint(new b(w,V));this.path.push({type:"mt",x:H.x,y:H.y}),this.ctx.lastPoint=new b(w,V)},_.prototype.closePath=function(){var w=new b(0,0),V=0;for(V=this.path.length-1;V!==-1;V--)if(this.path[V].type==="begin"&&Hr(this.path[V+1])==="object"&&typeof this.path[V+1].x=="number"){w=new b(this.path[V+1].x,this.path[V+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new b(w.x,w.y)},_.prototype.lineTo=function(w,V){if(isNaN(w)||isNaN(V))throw co.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var H=this.ctx.transform.applyToPoint(new b(w,V));this.path.push({type:"lt",x:H.x,y:H.y}),this.ctx.lastPoint=new b(H.x,H.y)},_.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),U.call(this,null,!0)},_.prototype.quadraticCurveTo=function(w,V,H,ue){if(isNaN(H)||isNaN(ue)||isNaN(w)||isNaN(V))throw co.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ve=this.ctx.transform.applyToPoint(new b(H,ue)),se=this.ctx.transform.applyToPoint(new b(w,V));this.path.push({type:"qct",x1:se.x,y1:se.y,x:ve.x,y:ve.y}),this.ctx.lastPoint=new b(ve.x,ve.y)},_.prototype.bezierCurveTo=function(w,V,H,ue,ve,se){if(isNaN(ve)||isNaN(se)||isNaN(w)||isNaN(V)||isNaN(H)||isNaN(ue))throw co.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ze=this.ctx.transform.applyToPoint(new b(ve,se)),xe=this.ctx.transform.applyToPoint(new b(w,V)),De=this.ctx.transform.applyToPoint(new b(H,ue));this.path.push({type:"bct",x1:xe.x,y1:xe.y,x2:De.x,y2:De.y,x:ze.x,y:ze.y}),this.ctx.lastPoint=new b(ze.x,ze.y)},_.prototype.arc=function(w,V,H,ue,ve,se){if(isNaN(w)||isNaN(V)||isNaN(H)||isNaN(ue)||isNaN(ve))throw co.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(se=!!se,!this.ctx.transform.isIdentity){var ze=this.ctx.transform.applyToPoint(new b(w,V));w=ze.x,V=ze.y;var xe=this.ctx.transform.applyToPoint(new b(0,H)),De=this.ctx.transform.applyToPoint(new b(0,0));H=Math.sqrt(Math.pow(xe.x-De.x,2)+Math.pow(xe.y-De.y,2))}Math.abs(ve-ue)>=2*Math.PI&&(ue=0,ve=2*Math.PI),this.path.push({type:"arc",x:w,y:V,radius:H,startAngle:ue,endAngle:ve,counterclockwise:se})},_.prototype.arcTo=function(w,V,H,ue,ve){throw new Error("arcTo not implemented.")},_.prototype.rect=function(w,V,H,ue){if(isNaN(w)||isNaN(V)||isNaN(H)||isNaN(ue))throw co.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(w,V),this.lineTo(w+H,V),this.lineTo(w+H,V+ue),this.lineTo(w,V+ue),this.lineTo(w,V),this.lineTo(w+H,V),this.lineTo(w,V)},_.prototype.fillRect=function(w,V,H,ue){if(isNaN(w)||isNaN(V)||isNaN(H)||isNaN(ue))throw co.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!T.call(this)){var ve={};this.lineCap!=="butt"&&(ve.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ve.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(w,V,H,ue),this.fill(),ve.hasOwnProperty("lineCap")&&(this.lineCap=ve.lineCap),ve.hasOwnProperty("lineJoin")&&(this.lineJoin=ve.lineJoin)}},_.prototype.strokeRect=function(w,V,H,ue){if(isNaN(w)||isNaN(V)||isNaN(H)||isNaN(ue))throw co.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");F.call(this)||(this.beginPath(),this.rect(w,V,H,ue),this.stroke())},_.prototype.clearRect=function(w,V,H,ue){if(isNaN(w)||isNaN(V)||isNaN(H)||isNaN(ue))throw co.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(w,V,H,ue))},_.prototype.save=function(w){w=typeof w!="boolean"||w;for(var V=this.pdf.internal.getCurrentPageInfo().pageNumber,H=0;H<this.pdf.internal.getNumberOfPages();H++)this.pdf.setPage(H+1),this.pdf.internal.out("q");if(this.pdf.setPage(V),w){this.ctx.fontSize=this.pdf.internal.getFontSize();var ue=new j(this.ctx);this.ctxStack.push(this.ctx),this.ctx=ue}},_.prototype.restore=function(w){w=typeof w!="boolean"||w;for(var V=this.pdf.internal.getCurrentPageInfo().pageNumber,H=0;H<this.pdf.internal.getNumberOfPages();H++)this.pdf.setPage(H+1),this.pdf.internal.out("Q");this.pdf.setPage(V),w&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},_.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var M=function(w){var V,H,ue,ve;if(w.isCanvasGradient===!0&&(w=w.getColor()),!w)return{r:0,g:0,b:0,a:0,style:w};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(w))V=0,H=0,ue=0,ve=0;else{var se=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(w);if(se!==null)V=parseInt(se[1]),H=parseInt(se[2]),ue=parseInt(se[3]),ve=1;else if((se=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(w))!==null)V=parseInt(se[1]),H=parseInt(se[2]),ue=parseInt(se[3]),ve=parseFloat(se[4]);else{if(ve=1,typeof w=="string"&&w.charAt(0)!=="#"){var ze=new qx(w);w=ze.ok?ze.toHex():"#000000"}w.length===4?(V=w.substring(1,2),V+=V,H=w.substring(2,3),H+=H,ue=w.substring(3,4),ue+=ue):(V=w.substring(1,3),H=w.substring(3,5),ue=w.substring(5,7)),V=parseInt(V,16),H=parseInt(H,16),ue=parseInt(ue,16)}}return{r:V,g:H,b:ue,a:ve,style:w}},T=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},F=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};_.prototype.fillText=function(w,V,H,ue){if(isNaN(V)||isNaN(H)||typeof w!="string")throw co.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(ue=isNaN(ue)?void 0:ue,!T.call(this)){var ve=Ne(this.ctx.transform.rotation),se=this.ctx.transform.scaleX;D.call(this,{text:w,x:V,y:H,scale:se,angle:ve,align:this.textAlign,maxWidth:ue})}},_.prototype.strokeText=function(w,V,H,ue){if(isNaN(V)||isNaN(H)||typeof w!="string")throw co.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!F.call(this)){ue=isNaN(ue)?void 0:ue;var ve=Ne(this.ctx.transform.rotation),se=this.ctx.transform.scaleX;D.call(this,{text:w,x:V,y:H,scale:se,renderingMode:"stroke",angle:ve,align:this.textAlign,maxWidth:ue})}},_.prototype.measureText=function(w){if(typeof w!="string")throw co.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var V=this.pdf,H=this.pdf.internal.scaleFactor,ue=V.internal.getFontSize(),ve=V.getStringUnitWidth(w)*ue/V.internal.scaleFactor;return new function(se){var ze=(se=se||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ze}}),this}({width:ve*=Math.round(96*H/72*1e4)/1e4})},_.prototype.scale=function(w,V){if(isNaN(w)||isNaN(V))throw co.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var H=new v(w,0,0,V,0,0);this.ctx.transform=this.ctx.transform.multiply(H)},_.prototype.rotate=function(w){if(isNaN(w))throw co.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var V=new v(Math.cos(w),Math.sin(w),-Math.sin(w),Math.cos(w),0,0);this.ctx.transform=this.ctx.transform.multiply(V)},_.prototype.translate=function(w,V){if(isNaN(w)||isNaN(V))throw co.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var H=new v(1,0,0,1,w,V);this.ctx.transform=this.ctx.transform.multiply(H)},_.prototype.transform=function(w,V,H,ue,ve,se){if(isNaN(w)||isNaN(V)||isNaN(H)||isNaN(ue)||isNaN(ve)||isNaN(se))throw co.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ze=new v(w,V,H,ue,ve,se);this.ctx.transform=this.ctx.transform.multiply(ze)},_.prototype.setTransform=function(w,V,H,ue,ve,se){w=isNaN(w)?1:w,V=isNaN(V)?0:V,H=isNaN(H)?0:H,ue=isNaN(ue)?1:ue,ve=isNaN(ve)?0:ve,se=isNaN(se)?0:se,this.ctx.transform=new v(w,V,H,ue,ve,se)};var P=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};_.prototype.drawImage=function(w,V,H,ue,ve,se,ze,xe,De){var Ye=this.pdf.getImageProperties(w),lt=1,St=1,Wt=1,ge=1;ue!==void 0&&xe!==void 0&&(Wt=xe/ue,ge=De/ve,lt=Ye.width/ue*xe/ue,St=Ye.height/ve*De/ve),se===void 0&&(se=V,ze=H,V=0,H=0),ue!==void 0&&xe===void 0&&(xe=ue,De=ve),ue===void 0&&xe===void 0&&(xe=Ye.width,De=Ye.height);var Ot=this.ctx.transform.decompose(),_t=Ne(Ot.rotate.shx),qt=new v,ht=(qt=(qt=(qt=qt.multiply(Ot.translate)).multiply(Ot.skew)).multiply(Ot.scale)).applyToRectangle(new p(se-V*Wt,ze-H*ge,ue*lt,ve*St));if(this.autoPaging){for(var fn,Yt=k.call(this,ht),ln=[],cn=0;cn<Yt.length;cn+=1)ln.indexOf(Yt[cn])===-1&&ln.push(Yt[cn]);E(ln);for(var Sn=ln[0],mn=ln[ln.length-1],tt=Sn;tt<mn+1;tt++){this.pdf.setPage(tt);var Bt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Gt=tt===1?this.posY+this.margin[0]:this.margin[0],an=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],dt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Mt=tt===1?0:an+(tt-2)*dt;if(this.ctx.clip_path.length!==0){var Me=this.path;fn=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=ae(fn,this.posX+this.margin[3],-Mt+Gt+this.ctx.prevPageLastElemOffset),ne.call(this,"fill",!0),this.path=Me}var we=JSON.parse(JSON.stringify(ht));we=ae([we],this.posX+this.margin[3],-Mt+Gt+this.ctx.prevPageLastElemOffset)[0];var st=(tt>Sn||tt<mn)&&P.call(this);st&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Bt,dt,null).clip().discardPath()),this.pdf.addImage(w,"JPEG",we.x,we.y,we.w,we.h,null,null,_t),st&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(w,"JPEG",ht.x,ht.y,ht.w,ht.h,null,null,_t)};var k=function(w,V,H){var ue=[];V=V||this.pdf.internal.pageSize.width,H=H||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ve=this.posY+this.ctx.prevPageLastElemOffset;switch(w.type){default:case"mt":case"lt":ue.push(Math.floor((w.y+ve)/H)+1);break;case"arc":ue.push(Math.floor((w.y+ve-w.radius)/H)+1),ue.push(Math.floor((w.y+ve+w.radius)/H)+1);break;case"qct":var se=Ie(this.ctx.lastPoint.x,this.ctx.lastPoint.y,w.x1,w.y1,w.x,w.y);ue.push(Math.floor((se.y+ve)/H)+1),ue.push(Math.floor((se.y+se.h+ve)/H)+1);break;case"bct":var ze=$e(this.ctx.lastPoint.x,this.ctx.lastPoint.y,w.x1,w.y1,w.x2,w.y2,w.x,w.y);ue.push(Math.floor((ze.y+ve)/H)+1),ue.push(Math.floor((ze.y+ze.h+ve)/H)+1);break;case"rect":ue.push(Math.floor((w.y+ve)/H)+1),ue.push(Math.floor((w.y+w.h+ve)/H)+1)}for(var xe=0;xe<ue.length;xe+=1)for(;this.pdf.internal.getNumberOfPages()<ue[xe];)y.call(this);return ue},y=function(){var w=this.fillStyle,V=this.strokeStyle,H=this.font,ue=this.lineCap,ve=this.lineWidth,se=this.lineJoin;this.pdf.addPage(),this.fillStyle=w,this.strokeStyle=V,this.font=H,this.lineCap=ue,this.lineWidth=ve,this.lineJoin=se},ae=function(w,V,H){for(var ue=0;ue<w.length;ue++)switch(w[ue].type){case"bct":w[ue].x2+=V,w[ue].y2+=H;case"qct":w[ue].x1+=V,w[ue].y1+=H;default:w[ue].x+=V,w[ue].y+=H}return w},E=function(w){return w.sort(function(V,H){return V-H})},U=function(w,V){var H=this.fillStyle,ue=this.strokeStyle,ve=this.lineCap,se=this.lineWidth,ze=Math.abs(se*this.ctx.transform.scaleX),xe=this.lineJoin;if(this.autoPaging){for(var De,Ye,lt=JSON.parse(JSON.stringify(this.path)),St=JSON.parse(JSON.stringify(this.path)),Wt=[],ge=0;ge<St.length;ge++)if(St[ge].x!==void 0)for(var Ot=k.call(this,St[ge]),_t=0;_t<Ot.length;_t+=1)Wt.indexOf(Ot[_t])===-1&&Wt.push(Ot[_t]);for(var qt=0;qt<Wt.length;qt++)for(;this.pdf.internal.getNumberOfPages()<Wt[qt];)y.call(this);E(Wt);for(var ht=Wt[0],fn=Wt[Wt.length-1],Yt=ht;Yt<fn+1;Yt++){this.pdf.setPage(Yt),this.fillStyle=H,this.strokeStyle=ue,this.lineCap=ve,this.lineWidth=ze,this.lineJoin=xe;var ln=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],cn=Yt===1?this.posY+this.margin[0]:this.margin[0],Sn=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],mn=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],tt=Yt===1?0:Sn+(Yt-2)*mn;if(this.ctx.clip_path.length!==0){var Bt=this.path;De=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=ae(De,this.posX+this.margin[3],-tt+cn+this.ctx.prevPageLastElemOffset),ne.call(this,w,!0),this.path=Bt}if(Ye=JSON.parse(JSON.stringify(lt)),this.path=ae(Ye,this.posX+this.margin[3],-tt+cn+this.ctx.prevPageLastElemOffset),V===!1||Yt===0){var Gt=(Yt>ht||Yt<fn)&&P.call(this);Gt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ln,mn,null).clip().discardPath()),ne.call(this,w,V),Gt&&this.pdf.restoreGraphicsState()}this.lineWidth=se}this.path=lt}else this.lineWidth=ze,ne.call(this,w,V),this.lineWidth=se},ne=function(w,V){if((w!=="stroke"||V||!F.call(this))&&(w==="stroke"||V||!T.call(this))){for(var H,ue,ve=[],se=this.path,ze=0;ze<se.length;ze++){var xe=se[ze];switch(xe.type){case"begin":ve.push({begin:!0});break;case"close":ve.push({close:!0});break;case"mt":ve.push({start:xe,deltas:[],abs:[]});break;case"lt":var De=ve.length;if(se[ze-1]&&!isNaN(se[ze-1].x)&&(H=[xe.x-se[ze-1].x,xe.y-se[ze-1].y],De>0)){for(;De>=0;De--)if(ve[De-1].close!==!0&&ve[De-1].begin!==!0){ve[De-1].deltas.push(H),ve[De-1].abs.push(xe);break}}break;case"bct":H=[xe.x1-se[ze-1].x,xe.y1-se[ze-1].y,xe.x2-se[ze-1].x,xe.y2-se[ze-1].y,xe.x-se[ze-1].x,xe.y-se[ze-1].y],ve[ve.length-1].deltas.push(H);break;case"qct":var Ye=se[ze-1].x+2/3*(xe.x1-se[ze-1].x),lt=se[ze-1].y+2/3*(xe.y1-se[ze-1].y),St=xe.x+2/3*(xe.x1-xe.x),Wt=xe.y+2/3*(xe.y1-xe.y),ge=xe.x,Ot=xe.y;H=[Ye-se[ze-1].x,lt-se[ze-1].y,St-se[ze-1].x,Wt-se[ze-1].y,ge-se[ze-1].x,Ot-se[ze-1].y],ve[ve.length-1].deltas.push(H);break;case"arc":ve.push({deltas:[],abs:[],arc:!0}),Array.isArray(ve[ve.length-1].abs)&&ve[ve.length-1].abs.push(xe)}}ue=V?null:w==="stroke"?"stroke":"fill";for(var _t=!1,qt=0;qt<ve.length;qt++)if(ve[qt].arc)for(var ht=ve[qt].abs,fn=0;fn<ht.length;fn++){var Yt=ht[fn];Yt.type==="arc"?te.call(this,Yt.x,Yt.y,Yt.radius,Yt.startAngle,Yt.endAngle,Yt.counterclockwise,void 0,V,!_t):J.call(this,Yt.x,Yt.y),_t=!0}else if(ve[qt].close===!0)this.pdf.internal.out("h"),_t=!1;else if(ve[qt].begin!==!0){var ln=ve[qt].start.x,cn=ve[qt].start.y;$.call(this,ve[qt].deltas,ln,cn),_t=!0}ue&&O.call(this,ue),V&&W.call(this)}},Z=function(w){var V=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,H=V*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return w-H;case"top":return w+V-H;case"hanging":return w+V-2*H;case"middle":return w+V/2-H;default:return w}},G=function(w){return w+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};_.prototype.createLinearGradient=function(){var w=function(){};return w.colorStops=[],w.addColorStop=function(V,H){this.colorStops.push([V,H])},w.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},w.isCanvasGradient=!0,w},_.prototype.createPattern=function(){return this.createLinearGradient()},_.prototype.createRadialGradient=function(){return this.createLinearGradient()};var te=function(w,V,H,ue,ve,se,ze,xe,De){for(var Ye=ee.call(this,H,ue,ve,se),lt=0;lt<Ye.length;lt++){var St=Ye[lt];lt===0&&(De?Y.call(this,St.x1+w,St.y1+V):J.call(this,St.x1+w,St.y1+V)),je.call(this,w,V,St.x2,St.y2,St.x3,St.y3,St.x4,St.y4)}xe?W.call(this):O.call(this,ze)},O=function(w){switch(w){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},W=function(){this.pdf.clip(),this.pdf.discardPath()},Y=function(w,V){this.pdf.internal.out(o(w)+" "+s(V)+" m")},D=function(w){var V;switch(w.align){case"right":case"end":V="right";break;case"center":V="center";break;default:V="left"}var H,ue,ve,se=this.pdf.getTextDimensions(w.text),ze=Z.call(this,w.y),xe=G.call(this,ze)-se.h,De=this.ctx.transform.applyToPoint(new b(w.x,ze));if(this.autoPaging){var Ye=this.ctx.transform.decompose(),lt=new v;lt=(lt=(lt=lt.multiply(Ye.translate)).multiply(Ye.skew)).multiply(Ye.scale);for(var St=this.ctx.transform.applyToRectangle(new p(w.x,ze,se.w,se.h)),Wt=lt.applyToRectangle(new p(w.x,xe,se.w,se.h)),ge=k.call(this,Wt),Ot=[],_t=0;_t<ge.length;_t+=1)Ot.indexOf(ge[_t])===-1&&Ot.push(ge[_t]);E(Ot);for(var qt=Ot[0],ht=Ot[Ot.length-1],fn=qt;fn<ht+1;fn++){this.pdf.setPage(fn);var Yt=fn===1?this.posY+this.margin[0]:this.margin[0],ln=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],cn=this.pdf.internal.pageSize.height-this.margin[2],Sn=cn-this.margin[0],mn=this.pdf.internal.pageSize.width-this.margin[1],tt=mn-this.margin[3],Bt=fn===1?0:ln+(fn-2)*Sn;if(this.ctx.clip_path.length!==0){var Gt=this.path;H=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=ae(H,this.posX+this.margin[3],-1*Bt+Yt),ne.call(this,"fill",!0),this.path=Gt}var an=ae([JSON.parse(JSON.stringify(Wt))],this.posX+this.margin[3],-Bt+Yt+this.ctx.prevPageLastElemOffset)[0];w.scale>=.01&&(ue=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ue*w.scale),ve=this.lineWidth,this.lineWidth=ve*w.scale);var dt=this.autoPaging!=="text";if(dt||an.y+an.h<=cn){if(dt||an.y>=Yt&&an.x<=mn){var Mt=dt?w.text:this.pdf.splitTextToSize(w.text,w.maxWidth||mn-an.x)[0],Me=ae([JSON.parse(JSON.stringify(St))],this.posX+this.margin[3],-Bt+Yt+this.ctx.prevPageLastElemOffset)[0],we=dt&&(fn>qt||fn<ht)&&P.call(this);we&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],tt,Sn,null).clip().discardPath()),this.pdf.text(Mt,Me.x,Me.y,{angle:w.angle,align:V,renderingMode:w.renderingMode}),we&&this.pdf.restoreGraphicsState()}}else an.y<cn&&(this.ctx.prevPageLastElemOffset+=cn-an.y);w.scale>=.01&&(this.pdf.setFontSize(ue),this.lineWidth=ve)}}else w.scale>=.01&&(ue=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ue*w.scale),ve=this.lineWidth,this.lineWidth=ve*w.scale),this.pdf.text(w.text,De.x+this.posX,De.y+this.posY,{angle:w.angle,align:V,renderingMode:w.renderingMode,maxWidth:w.maxWidth}),w.scale>=.01&&(this.pdf.setFontSize(ue),this.lineWidth=ve)},J=function(w,V,H,ue){H=H||0,ue=ue||0,this.pdf.internal.out(o(w+H)+" "+s(V+ue)+" l")},$=function(w,V,H){return this.pdf.lines(w,V,H,null,null)},je=function(w,V,H,ue,ve,se,ze,xe){this.pdf.internal.out([r(l(H+w)),r(d(ue+V)),r(l(ve+w)),r(d(se+V)),r(l(ze+w)),r(d(xe+V)),"c"].join(" "))},ee=function(w,V,H,ue){for(var ve=2*Math.PI,se=Math.PI/2;V>H;)V-=ve;var ze=Math.abs(H-V);ze<ve&&ue&&(ze=ve-ze);for(var xe=[],De=ue?-1:1,Ye=V;ze>1e-5;){var lt=Ye+De*Math.min(ze,se);xe.push(de.call(this,w,Ye,lt)),ze-=Math.abs(lt-Ye),Ye=lt}return xe},de=function(w,V,H){var ue=(H-V)/2,ve=w*Math.cos(ue),se=w*Math.sin(ue),ze=ve,xe=-se,De=ze*ze+xe*xe,Ye=De+ze*ve+xe*se,lt=4/3*(Math.sqrt(2*De*Ye)-Ye)/(ze*se-xe*ve),St=ze-lt*xe,Wt=xe+lt*ze,ge=St,Ot=-Wt,_t=ue+V,qt=Math.cos(_t),ht=Math.sin(_t);return{x1:w*Math.cos(V),y1:w*Math.sin(V),x2:St*qt-Wt*ht,y2:St*ht+Wt*qt,x3:ge*qt-Ot*ht,y3:ge*ht+Ot*qt,x4:w*Math.cos(H),y4:w*Math.sin(H)}},Ne=function(w){return 180*w/Math.PI},Ie=function(w,V,H,ue,ve,se){var ze=w+.5*(H-w),xe=V+.5*(ue-V),De=ve+.5*(H-ve),Ye=se+.5*(ue-se),lt=Math.min(w,ve,ze,De),St=Math.max(w,ve,ze,De),Wt=Math.min(V,se,xe,Ye),ge=Math.max(V,se,xe,Ye);return new p(lt,Wt,St-lt,ge-Wt)},$e=function(w,V,H,ue,ve,se,ze,xe){var De,Ye,lt,St,Wt,ge,Ot,_t,qt,ht,fn,Yt,ln,cn,Sn=H-w,mn=ue-V,tt=ve-H,Bt=se-ue,Gt=ze-ve,an=xe-se;for(Ye=0;Ye<41;Ye++)qt=(Ot=(lt=w+(De=Ye/40)*Sn)+De*((Wt=H+De*tt)-lt))+De*(Wt+De*(ve+De*Gt-Wt)-Ot),ht=(_t=(St=V+De*mn)+De*((ge=ue+De*Bt)-St))+De*(ge+De*(se+De*an-ge)-_t),Ye==0?(fn=qt,Yt=ht,ln=qt,cn=ht):(fn=Math.min(fn,qt),Yt=Math.min(Yt,ht),ln=Math.max(ln,qt),cn=Math.max(cn,ht));return new p(Math.round(fn),Math.round(Yt),Math.round(ln-fn),Math.round(cn-Yt))},q=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var w,V,H=(w=this.ctx.lineDash,V=this.ctx.lineDashOffset,JSON.stringify({lineDash:w,lineDashOffset:V}));this.prevLineDash!==H&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=H)}}})(Fn.API),(function(n){var r=function(b){var p,v,m,j,_,M,T,F,P,k;for(v=[],m=0,j=(b+=p="\0\0\0\0".slice(b.length%4||4)).length;j>m;m+=4)(_=(b.charCodeAt(m)<<24)+(b.charCodeAt(m+1)<<16)+(b.charCodeAt(m+2)<<8)+b.charCodeAt(m+3))!==0?(M=(_=((_=((_=((_=(_-(k=_%85))/85)-(P=_%85))/85)-(F=_%85))/85)-(T=_%85))/85)%85,v.push(M+33,T+33,F+33,P+33,k+33)):v.push(122);return(function(y,ae){for(var E=ae;E>0;E--)y.pop()})(v,p.length),String.fromCharCode.apply(String,v)+"~>"},o=function(b){var p,v,m,j,_,M=String,T="length",F=255,P="charCodeAt",k="slice",y="replace";for(b[k](-2),b=b[k](0,-2)[y](/\s/g,"")[y]("z","!!!!!"),m=[],j=0,_=(b+=p="uuuuu"[k](b[T]%5||5))[T];_>j;j+=5)v=52200625*(b[P](j)-33)+614125*(b[P](j+1)-33)+7225*(b[P](j+2)-33)+85*(b[P](j+3)-33)+(b[P](j+4)-33),m.push(F&v>>24,F&v>>16,F&v>>8,F&v);return(function(ae,E){for(var U=E;U>0;U--)ae.pop()})(m,p[T]),M.fromCharCode.apply(M,m)},s=function(b){return b.split("").map(function(p){return("0"+p.charCodeAt().toString(16)).slice(-2)}).join("")+">"},l=function(b){var p=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((b=b.replace(/\s/g,"")).indexOf(">")!==-1&&(b=b.substr(0,b.indexOf(">"))),b.length%2&&(b+="0"),p.test(b)===!1)return"";for(var v="",m=0;m<b.length;m+=2)v+=String.fromCharCode("0x"+(b[m]+b[m+1]));return v},d=function(b){for(var p=new Uint8Array(b.length),v=b.length;v--;)p[v]=b.charCodeAt(v);return(p=Qg(p)).reduce(function(m,j){return m+String.fromCharCode(j)},"")};n.processDataByFilters=function(b,p){var v=0,m=b||"",j=[];for(typeof(p=p||[])=="string"&&(p=[p]),v=0;v<p.length;v+=1)switch(p[v]){case"ASCII85Decode":case"/ASCII85Decode":m=o(m),j.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":m=r(m),j.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":m=l(m),j.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":m=s(m),j.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":m=d(m),j.push("/FlateDecode");break;default:throw new Error('The filter: "'+p[v]+'" is not implemented')}return{data:m,reverseChain:j.reverse().join(" ")}}})(Fn.API),(function(n){n.loadFile=function(r,o,s){return(function(l,d,b){d=d!==!1,b=typeof b=="function"?b:function(){};var p=void 0;try{p=(function(v,m,j){var _=new XMLHttpRequest,M=0,T=function(F){var P=F.length,k=[],y=String.fromCharCode;for(M=0;M<P;M+=1)k.push(y(255&F.charCodeAt(M)));return k.join("")};if(_.open("GET",v,!m),_.overrideMimeType("text/plain; charset=x-user-defined"),m===!1&&(_.onload=function(){_.status===200?j(T(this.responseText)):j(void 0)}),_.send(null),m&&_.status===200)return T(_.responseText)})(l,d,b)}catch{}return p})(r,o,s)},n.loadImageFile=n.loadFile})(Fn.API),(function(n){function r(){return(pi.html2canvas?Promise.resolve(pi.html2canvas):wg(()=>import("./html2canvas.esm-B0tyYwQk.js"),[])).catch(function(p){return Promise.reject(new Error("Could not load html2canvas: "+p))}).then(function(p){return p.default?p.default:p})}function o(){return(pi.DOMPurify?Promise.resolve(pi.DOMPurify):wg(()=>import("./purify.es-B6FQ9oRL.js"),[])).catch(function(p){return Promise.reject(new Error("Could not load dompurify: "+p))}).then(function(p){return p.default?p.default:p})}var s=function(p){var v=Hr(p);return v==="undefined"?"undefined":v==="string"||p instanceof String?"string":v==="number"||p instanceof Number?"number":v==="function"||p instanceof Function?"function":p&&p.constructor===Array?"array":p&&p.nodeType===1?"element":v==="object"?"object":"unknown"},l=function(p,v){var m=document.createElement(p);for(var j in v.className&&(m.className=v.className),v.innerHTML&&v.dompurify&&(m.innerHTML=v.dompurify.sanitize(v.innerHTML)),v.style)m.style[j]=v.style[j];return m},d=function p(v,m){for(var j=v.nodeType===3?document.createTextNode(v.nodeValue):v.cloneNode(!1),_=v.firstChild;_;_=_.nextSibling)m!==!0&&_.nodeType===1&&_.nodeName==="SCRIPT"||j.appendChild(p(_,m));return v.nodeType===1&&(v.nodeName==="CANVAS"?(j.width=v.width,j.height=v.height,j.getContext("2d").drawImage(v,0,0)):v.nodeName!=="TEXTAREA"&&v.nodeName!=="SELECT"||(j.value=v.value),j.addEventListener("load",function(){j.scrollTop=v.scrollTop,j.scrollLeft=v.scrollLeft},!0)),j},b=function p(v){var m=Object.assign(p.convert(Promise.resolve()),JSON.parse(JSON.stringify(p.template))),j=p.convert(Promise.resolve(),m);return(j=j.setProgress(1,p,1,[p])).set(v)};(b.prototype=Object.create(Promise.prototype)).constructor=b,b.convert=function(p,v){return p.__proto__=v||b.prototype,p},b.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},b.prototype.from=function(p,v){return this.then(function(){switch(v=v||(function(m){switch(s(m)){case"string":return"string";case"element":return m.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(p),v){case"string":return this.then(o).then(function(m){return this.set({src:l("div",{innerHTML:p,dompurify:m})})});case"element":return this.set({src:p});case"canvas":return this.set({canvas:p});case"img":return this.set({img:p});default:return this.error("Unknown source type.")}})},b.prototype.to=function(p){switch(p){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},b.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var p={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},v=d(this.prop.src,this.opt.html2canvas.javascriptEnabled);v.tagName==="BODY"&&(p.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=l("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=l("div",{className:"html2pdf__container",style:p}),this.prop.container.appendChild(v),this.prop.container.firstChild.appendChild(l("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},b.prototype.toCanvas=function(){var p=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(p).then(r).then(function(v){var m=Object.assign({},this.opt.html2canvas);return delete m.onrendered,v(this.prop.container,m)}).then(function(v){(this.opt.html2canvas.onrendered||function(){})(v),this.prop.canvas=v,document.body.removeChild(this.prop.overlay)})},b.prototype.toContext2d=function(){var p=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(p).then(r).then(function(v){var m=this.opt.jsPDF,j=this.opt.fontFaces,_=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,M=Object.assign({async:!0,allowTaint:!0,scale:_,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete M.onrendered,m.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,m.context2d.posX=this.opt.x,m.context2d.posY=this.opt.y,m.context2d.margin=this.opt.margin,m.context2d.fontFaces=j,j)for(var T=0;T<j.length;++T){var F=j[T],P=F.src.find(function(k){return k.format==="truetype"});P&&m.addFont(P.url,F.ref.name,F.ref.style)}return M.windowHeight=M.windowHeight||0,M.windowHeight=M.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):M.windowHeight,m.context2d.save(!0),v(this.prop.container,M)}).then(function(v){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(v),this.prop.canvas=v,document.body.removeChild(this.prop.overlay)})},b.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var p=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=p})},b.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},b.prototype.output=function(p,v,m){return(m=m||"pdf").toLowerCase()==="img"||m.toLowerCase()==="image"?this.outputImg(p,v):this.outputPdf(p,v)},b.prototype.outputPdf=function(p,v){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(p,v)})},b.prototype.outputImg=function(p){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(p){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+p+'" is not supported.'}})},b.prototype.save=function(p){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(p?{filename:p}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},b.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},b.prototype.set=function(p){if(s(p)!=="object")return this;var v=Object.keys(p||{}).map(function(m){if(m in b.template.prop)return function(){this.prop[m]=p[m]};switch(m){case"margin":return this.setMargin.bind(this,p.margin);case"jsPDF":return function(){return this.opt.jsPDF=p.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,p.pageSize);default:return function(){this.opt[m]=p[m]}}},this);return this.then(function(){return this.thenList(v)})},b.prototype.get=function(p,v){return this.then(function(){var m=p in b.template.prop?this.prop[p]:this.opt[p];return v?v(m):m})},b.prototype.setMargin=function(p){return this.then(function(){switch(s(p)){case"number":p=[p,p,p,p];case"array":if(p.length===2&&(p=[p[0],p[1],p[0],p[1]]),p.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=p}).then(this.setPageSize)},b.prototype.setPageSize=function(p){function v(m,j){return Math.floor(m*j/72*96)}return this.then(function(){(p=p||Fn.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(p.inner={width:p.width-this.opt.margin[1]-this.opt.margin[3],height:p.height-this.opt.margin[0]-this.opt.margin[2]},p.inner.px={width:v(p.inner.width,p.k),height:v(p.inner.height,p.k)},p.inner.ratio=p.inner.height/p.inner.width),this.prop.pageSize=p})},b.prototype.setProgress=function(p,v,m,j){return p!=null&&(this.progress.val=p),v!=null&&(this.progress.state=v),m!=null&&(this.progress.n=m),j!=null&&(this.progress.stack=j),this.progress.ratio=this.progress.val/this.progress.state,this},b.prototype.updateProgress=function(p,v,m,j){return this.setProgress(p?this.progress.val+p:null,v||null,m?this.progress.n+m:null,j?this.progress.stack.concat(j):null)},b.prototype.then=function(p,v){var m=this;return this.thenCore(p,v,function(j,_){return m.updateProgress(null,null,1,[j]),Promise.prototype.then.call(this,function(M){return m.updateProgress(null,j),M}).then(j,_).then(function(M){return m.updateProgress(1),M})})},b.prototype.thenCore=function(p,v,m){m=m||Promise.prototype.then;var j=this;p&&(p=p.bind(j)),v&&(v=v.bind(j));var _=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?j:b.convert(Object.assign({},j),Promise.prototype),M=m.call(_,p,v);return b.convert(M,j.__proto__)},b.prototype.thenExternal=function(p,v){return Promise.prototype.then.call(this,p,v)},b.prototype.thenList=function(p){var v=this;return p.forEach(function(m){v=v.thenCore(m)}),v},b.prototype.catch=function(p){p&&(p=p.bind(this));var v=Promise.prototype.catch.call(this,p);return b.convert(v,this)},b.prototype.catchExternal=function(p){return Promise.prototype.catch.call(this,p)},b.prototype.error=function(p){return this.then(function(){throw new Error(p)})},b.prototype.using=b.prototype.set,b.prototype.saveAs=b.prototype.save,b.prototype.export=b.prototype.output,b.prototype.run=b.prototype.then,Fn.getPageSize=function(p,v,m){if(Hr(p)==="object"){var j=p;p=j.orientation,v=j.unit||v,m=j.format||m}v=v||"mm",m=m||"a4",p=(""+(p||"P")).toLowerCase();var _,M=(""+m).toLowerCase(),T={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(v){case"pt":_=1;break;case"mm":_=72/25.4;break;case"cm":_=72/2.54;break;case"in":_=72;break;case"px":_=.75;break;case"pc":case"em":_=12;break;case"ex":_=6;break;default:throw"Invalid unit: "+v}var F,P=0,k=0;if(T.hasOwnProperty(M))P=T[M][1]/_,k=T[M][0]/_;else try{P=m[1],k=m[0]}catch{throw new Error("Invalid format: "+m)}if(p==="p"||p==="portrait")p="p",k>P&&(F=k,k=P,P=F);else{if(p!=="l"&&p!=="landscape")throw"Invalid orientation: "+p;p="l",P>k&&(F=k,k=P,P=F)}return{width:k,height:P,unit:v,k:_,orientation:p}},n.html=function(p,v){(v=v||{}).callback=v.callback||function(){},v.html2canvas=v.html2canvas||{},v.html2canvas.canvas=v.html2canvas.canvas||this.canvas,v.jsPDF=v.jsPDF||this,v.fontFaces=v.fontFaces?v.fontFaces.map(Fg):null;var m=new b(v);return v.worker?m:m.from(p).doCallback()}})(Fn.API),Fn.API.addJS=function(n){return By=n,this.internal.events.subscribe("postPutResources",function(){ah=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(ah+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),My=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+By+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){ah!==void 0&&My!==void 0&&this.internal.out("/Names <</JavaScript "+ah+" 0 R>>")}),this},(function(n){var r;n.events.push(["postPutResources",function(){var o=this,s=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var l=o.outline.render().split(/\r\n/),d=0;d<l.length;d++){var b=l[d],p=s.exec(b);if(p!=null){var v=p[1];o.internal.newObjectDeferredBegin(v,!1)}o.internal.write(b)}if(this.outline.createNamedDestinations){var m=this.internal.pages.length,j=[];for(d=0;d<m;d++){var _=o.internal.newObject();j.push(_);var M=o.internal.getPageInfo(d+1);o.internal.write("<< /D["+M.objId+" 0 R /XYZ null null null]>> endobj")}var T=o.internal.newObject();for(o.internal.write("<< /Names [ "),d=0;d<j.length;d++)o.internal.write("(page_"+(d+1)+")"+j[d]+" 0 R");o.internal.write(" ] >>","endobj"),r=o.internal.newObject(),o.internal.write("<< /Dests "+T+" 0 R"),o.internal.write(">>","endobj")}}]),n.events.push(["putCatalog",function(){var o=this;o.outline.root.children.length>0&&(o.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&o.internal.write("/Names "+r+" 0 R"))}]),n.events.push(["initialized",function(){var o=this;o.outline={createNamedDestinations:!1,root:{children:[]}},o.outline.add=function(s,l,d){var b={title:l,options:d,children:[]};return s==null&&(s=this.root),s.children.push(b),b},o.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=o,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},o.outline.genIds_r=function(s){s.id=o.internal.newObjectDeferred();for(var l=0;l<s.children.length;l++)this.genIds_r(s.children[l])},o.outline.renderRoot=function(s){this.objStart(s),this.line("/Type /Outlines"),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1]))),this.line("/Count "+this.count_r({count:0},s)),this.objEnd()},o.outline.renderItems=function(s){for(var l=this.ctx.pdf.internal.getVerticalCoordinateString,d=0;d<s.children.length;d++){var b=s.children[d];this.objStart(b),this.line("/Title "+this.makeString(b.title)),this.line("/Parent "+this.makeRef(s)),d>0&&this.line("/Prev "+this.makeRef(s.children[d-1])),d<s.children.length-1&&this.line("/Next "+this.makeRef(s.children[d+1])),b.children.length>0&&(this.line("/First "+this.makeRef(b.children[0])),this.line("/Last "+this.makeRef(b.children[b.children.length-1])));var p=this.count=this.count_r({count:0},b);if(p>0&&this.line("/Count "+p),b.options&&b.options.pageNumber){var v=o.internal.getPageInfo(b.options.pageNumber);this.line("/Dest ["+v.objId+" 0 R /XYZ 0 "+l(0)+" 0]")}this.objEnd()}for(var m=0;m<s.children.length;m++)this.renderItems(s.children[m])},o.outline.line=function(s){this.ctx.val+=s+`\r
`},o.outline.makeRef=function(s){return s.id+" 0 R"},o.outline.makeString=function(s){return"("+o.internal.pdfEscape(s)+")"},o.outline.objStart=function(s){this.ctx.val+=`\r
`+s.id+` 0 obj\r
<<\r
`},o.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},o.outline.count_r=function(s,l){for(var d=0;d<l.children.length;d++)s.count++,this.count_r(s,l.children[d]);return s.count}}])})(Fn.API),(function(n){var r=[192,193,194,195,196,197,198,199];n.processJPEG=function(o,s,l,d,b,p){var v,m=this.decode.DCT_DECODE,j=null;if(typeof o=="string"||this.__addimage__.isArrayBuffer(o)||this.__addimage__.isArrayBufferView(o)){switch(o=b||o,o=this.__addimage__.isArrayBuffer(o)?new Uint8Array(o):o,v=(function(_){for(var M,T=256*_.charCodeAt(4)+_.charCodeAt(5),F=_.length,P={width:0,height:0,numcomponents:1},k=4;k<F;k+=2){if(k+=T,r.indexOf(_.charCodeAt(k+1))!==-1){M=256*_.charCodeAt(k+5)+_.charCodeAt(k+6),P={width:256*_.charCodeAt(k+7)+_.charCodeAt(k+8),height:M,numcomponents:_.charCodeAt(k+9)};break}T=256*_.charCodeAt(k+2)+_.charCodeAt(k+3)}return P})(o=this.__addimage__.isArrayBufferView(o)?this.__addimage__.arrayBufferToBinaryString(o):o),v.numcomponents){case 1:p=this.color_spaces.DEVICE_GRAY;break;case 4:p=this.color_spaces.DEVICE_CMYK;break;case 3:p=this.color_spaces.DEVICE_RGB}j={data:o,width:v.width,height:v.height,colorSpace:p,bitsPerComponent:8,filter:m,index:s,alias:l}}return j}})(Fn.API),Fn.API.processPNG=function(n,r,o,s){if(this.__addimage__.isArrayBuffer(n)&&(n=new Uint8Array(n)),this.__addimage__.isArrayBufferView(n)){var l,d=g5(n,{checkCrc:!0}),b=d.width,p=d.height,v=d.channels,m=d.palette,j=d.depth;l=m&&v===1?(function(te){for(var O=te.width,W=te.height,Y=te.data,D=te.palette,J=te.depth,$=!1,je=[],ee=[],de=void 0,Ne=!1,Ie=0,$e=0;$e<D.length;$e++){var q=E1(D[$e],4),w=q[0],V=q[1],H=q[2],ue=q[3];je.push(w,V,H),ue!=null&&(ue===0?(Ie++,ee.length<1&&ee.push($e)):ue<255&&(Ne=!0))}if(Ne||Ie>1){$=!0,ee=void 0;var ve=O*W;de=new Uint8Array(ve);for(var se=new DataView(Y.buffer),ze=0;ze<ve;ze++){var xe=Eg(se,ze,J),De=E1(D[xe],4)[3];de[ze]=De}}else Ie===0&&(ee=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:$?8:void 0,colorBytes:Y,alphaBytes:de,needSMask:$,palette:je,mask:ee}})(d):v===2||v===4?(function(te){for(var O=te.data,W=te.width,Y=te.height,D=te.channels,J=te.depth,$=D===2?"DeviceGray":"DeviceRGB",je=D-1,ee=W*Y,de=je,Ne=ee*de,Ie=1*ee,$e=Math.ceil(Ne*J/8),q=Math.ceil(Ie*J/8),w=new Uint8Array($e),V=new Uint8Array(q),H=new DataView(O.buffer),ue=new DataView(w.buffer),ve=new DataView(V.buffer),se=!1,ze=0;ze<ee;ze++){for(var xe=ze*D,De=0;De<de;De++)$y(ue,Eg(H,xe+De,J),ze*de+De,J);var Ye=Eg(H,xe+de,J);Ye<(1<<J)-1&&(se=!0),$y(ve,Ye,1*ze,J)}return{colorSpace:$,colorsPerPixel:je,sMaskBitsPerComponent:se?J:void 0,colorBytes:w,alphaBytes:V,needSMask:se}})(d):(function(te){var O=te.data,W=te.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:W,colorsPerPixel:W==="DeviceGray"?1:3,colorBytes:O instanceof Uint16Array?(function(Y){for(var D=Y.length,J=new Uint8Array(2*D),$=new DataView(J.buffer,J.byteOffset,J.byteLength),je=0;je<D;je++)$.setUint16(2*je,Y[je],!1);return J})(O):O,needSMask:!1}})(d);var _,M,T,F=l,P=F.colorSpace,k=F.colorsPerPixel,y=F.sMaskBitsPerComponent,ae=F.colorBytes,E=F.alphaBytes,U=F.needSMask,ne=F.palette,Z=F.mask,G=null;return s!==Fn.API.image_compression.NONE&&typeof Qg=="function"?(G=(function(te){var O;switch(te){case Fn.API.image_compression.FAST:O=11;break;case Fn.API.image_compression.MEDIUM:O=13;break;case Fn.API.image_compression.SLOW:O=14;break;default:O=12}return O})(s),_=this.decode.FLATE_DECODE,M="/Predictor ".concat(G," /Colors ").concat(k," /BitsPerComponent ").concat(j," /Columns ").concat(b),n=Ey(ae,Math.ceil(b*k*j/8),k,j,s),U&&(T=Ey(E,Math.ceil(b*y/8),1,y,s))):(_=void 0,M=void 0,n=ae,U&&(T=E)),(this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n))&&(n=this.__addimage__.arrayBufferToBinaryString(n)),(T&&this.__addimage__.isArrayBuffer(T)||this.__addimage__.isArrayBufferView(T))&&(T=this.__addimage__.arrayBufferToBinaryString(T)),{alias:o,data:n,index:r,filter:_,decodeParameters:M,transparency:Z,palette:ne,sMask:T,predictor:G,width:b,height:p,bitsPerComponent:j,sMaskBitsPerComponent:y,colorSpace:P}}},(function(n){n.processGIF89A=function(r,o,s,l){var d=new M5(r),b=d.width,p=d.height,v=[];d.decodeAndBlitFrameRGBA(0,v);var m={data:v,width:b,height:p},j=new Vg(100).encode(m,100);return n.processJPEG.call(this,j,o,s,l)},n.processGIF87A=n.processGIF89A})(Fn.API),Nc.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var n=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(n);for(var r=0;r<n;r++){var o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),d=this.datav.getUint8(this.pos++,!0);this.palette[r]={red:l,green:s,blue:o,quad:d}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Nc.prototype.parseBGR=function(){this.pos=this.offset;try{var n="bit"+this.bitPP,r=this.width*this.height*4;this.data=new Uint8Array(r),this[n]()}catch(o){co.log("bit decode error:"+o)}},Nc.prototype.bit1=function(){var n,r=Math.ceil(this.width/8),o=r%4;for(n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,l=0;l<r;l++)for(var d=this.datav.getUint8(this.pos++,!0),b=s*this.width*4+8*l*4,p=0;p<8&&8*l+p<this.width;p++){var v=this.palette[d>>7-p&1];this.data[b+4*p]=v.blue,this.data[b+4*p+1]=v.green,this.data[b+4*p+2]=v.red,this.data[b+4*p+3]=255}o!==0&&(this.pos+=4-o)}},Nc.prototype.bit4=function(){for(var n=Math.ceil(this.width/2),r=n%4,o=this.height-1;o>=0;o--){for(var s=this.bottom_up?o:this.height-1-o,l=0;l<n;l++){var d=this.datav.getUint8(this.pos++,!0),b=s*this.width*4+2*l*4,p=d>>4,v=15&d,m=this.palette[p];if(this.data[b]=m.blue,this.data[b+1]=m.green,this.data[b+2]=m.red,this.data[b+3]=255,2*l+1>=this.width)break;m=this.palette[v],this.data[b+4]=m.blue,this.data[b+4+1]=m.green,this.data[b+4+2]=m.red,this.data[b+4+3]=255}r!==0&&(this.pos+=4-r)}},Nc.prototype.bit8=function(){for(var n=this.width%4,r=this.height-1;r>=0;r--){for(var o=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var l=this.datav.getUint8(this.pos++,!0),d=o*this.width*4+4*s;if(l<this.palette.length){var b=this.palette[l];this.data[d]=b.red,this.data[d+1]=b.green,this.data[d+2]=b.blue,this.data[d+3]=255}else this.data[d]=255,this.data[d+1]=255,this.data[d+2]=255,this.data[d+3]=255}n!==0&&(this.pos+=4-n)}},Nc.prototype.bit15=function(){for(var n=this.width%3,r=parseInt("11111",2),o=this.height-1;o>=0;o--){for(var s=this.bottom_up?o:this.height-1-o,l=0;l<this.width;l++){var d=this.datav.getUint16(this.pos,!0);this.pos+=2;var b=(d&r)/r*255|0,p=(d>>5&r)/r*255|0,v=(d>>10&r)/r*255|0,m=d>>15?255:0,j=s*this.width*4+4*l;this.data[j]=v,this.data[j+1]=p,this.data[j+2]=b,this.data[j+3]=m}this.pos+=n}},Nc.prototype.bit16=function(){for(var n=this.width%3,r=parseInt("11111",2),o=parseInt("111111",2),s=this.height-1;s>=0;s--){for(var l=this.bottom_up?s:this.height-1-s,d=0;d<this.width;d++){var b=this.datav.getUint16(this.pos,!0);this.pos+=2;var p=(b&r)/r*255|0,v=(b>>5&o)/o*255|0,m=(b>>11)/r*255|0,j=l*this.width*4+4*d;this.data[j]=m,this.data[j+1]=v,this.data[j+2]=p,this.data[j+3]=255}this.pos+=n}},Nc.prototype.bit24=function(){for(var n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,o=0;o<this.width;o++){var s=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),d=this.datav.getUint8(this.pos++,!0),b=r*this.width*4+4*o;this.data[b]=d,this.data[b+1]=l,this.data[b+2]=s,this.data[b+3]=255}this.pos+=this.width%4}},Nc.prototype.bit32=function(){for(var n=this.height-1;n>=0;n--)for(var r=this.bottom_up?n:this.height-1-n,o=0;o<this.width;o++){var s=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),d=this.datav.getUint8(this.pos++,!0),b=this.datav.getUint8(this.pos++,!0),p=r*this.width*4+4*o;this.data[p]=d,this.data[p+1]=l,this.data[p+2]=s,this.data[p+3]=b}},Nc.prototype.getData=function(){return this.data},(function(n){n.processBMP=function(r,o,s,l){var d=new Nc(r,!1),b=d.width,p=d.height,v={data:d.getData(),width:b,height:p},m=new Vg(100).encode(v,100);return n.processJPEG.call(this,m,o,s,l)}})(Fn.API),Gy.prototype.getData=function(){return this.data},(function(n){n.processWEBP=function(r,o,s,l){var d=new Gy(r),b=d.width,p=d.height,v={data:d.getData(),width:b,height:p},m=new Vg(100).encode(v,100);return n.processJPEG.call(this,m,o,s,l)}})(Fn.API),Fn.API.processRGBA=function(n,r,o){for(var s=n.data,l=s.length,d=new Uint8Array(l/4*3),b=new Uint8Array(l/4),p=0,v=0,m=0;m<l;m+=4){var j=s[m],_=s[m+1],M=s[m+2],T=s[m+3];d[p++]=j,d[p++]=_,d[p++]=M,b[v++]=T}var F=this.__addimage__.arrayBufferToBinaryString(d);return{alpha:this.__addimage__.arrayBufferToBinaryString(b),data:F,index:r,alias:o,colorSpace:"DeviceRGB",bitsPerComponent:8,width:n.width,height:n.height}},Fn.API.setLanguage=function(n){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[n]!==void 0&&(this.internal.languageSettings.languageCode=n,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},af=Fn.API,sh=af.getCharWidthsArray=function(n,r){var o,s,l=(r=r||{}).font||this.internal.getFont(),d=r.fontSize||this.internal.getFontSize(),b=r.charSpace||this.internal.getCharSpace(),p=r.widths?r.widths:l.metadata.Unicode.widths,v=p.fof?p.fof:1,m=r.kerning?r.kerning:l.metadata.Unicode.kerning,j=m.fof?m.fof:1,_=r.doKerning!==!1,M=0,T=n.length,F=0,P=p[0]||v,k=[];for(o=0;o<T;o++)s=n.charCodeAt(o),typeof l.metadata.widthOfString=="function"?k.push((l.metadata.widthOfGlyph(l.metadata.characterToGlyph(s))+b*(1e3/d)||0)/1e3):(M=_&&Hr(m[s])==="object"&&!isNaN(parseInt(m[s][F],10))?m[s][F]/j:0,k.push((p[s]||P)/v+M)),F=s;return k},Oy=af.getStringUnitWidth=function(n,r){var o=(r=r||{}).fontSize||this.internal.getFontSize(),s=r.font||this.internal.getFont(),l=r.charSpace||this.internal.getCharSpace();return af.processArabic&&(n=af.processArabic(n)),typeof s.metadata.widthOfString=="function"?s.metadata.widthOfString(n,o,l)/o:sh.apply(this,arguments).reduce(function(d,b){return d+b},0)},Fy=function(n,r,o,s){for(var l=[],d=0,b=n.length,p=0;d!==b&&p+r[d]<o;)p+=r[d],d++;l.push(n.slice(0,d));var v=d;for(p=0;d!==b;)p+r[d]>s&&(l.push(n.slice(v,d)),p=0,v=d),p+=r[d],d++;return v!==d&&l.push(n.slice(v,d)),l},Uy=function(n,r,o){o||(o={});var s,l,d,b,p,v,m,j=[],_=[j],M=o.textIndent||0,T=0,F=0,P=n.split(" "),k=sh.apply(this,[" ",o])[0];if(v=o.lineIndent===-1?P[0].length+2:o.lineIndent||0){var y=Array(v).join(" "),ae=[];P.map(function(U){(U=U.split(/\s*\n/)).length>1?ae=ae.concat(U.map(function(ne,Z){return(Z&&ne.length?`
`:"")+ne})):ae.push(U[0])}),P=ae,v=Oy.apply(this,[y,o])}for(d=0,b=P.length;d<b;d++){var E=0;if(s=P[d],v&&s[0]==`
`&&(s=s.substr(1),E=1),M+T+(F=(l=sh.apply(this,[s,o])).reduce(function(U,ne){return U+ne},0))>r||E){if(F>r){for(p=Fy.apply(this,[s,l,r-(M+T),r]),j.push(p.shift()),j=[p.pop()];p.length;)_.push([p.shift()]);F=l.slice(s.length-(j[0]?j[0].length:0)).reduce(function(U,ne){return U+ne},0)}else j=[s];_.push(j),M=F+v,T=k}else j.push(s),M+=T+F,T=k}return m=v?function(U,ne){return(ne?y:"")+U.join(" ")}:function(U){return U.join(" ")},_.map(m)},af.splitTextToSize=function(n,r,o){var s,l=(o=o||{}).fontSize||this.internal.getFontSize(),d=(function(j){if(j.widths&&j.kerning)return{widths:j.widths,kerning:j.kerning};var _=this.internal.getFont(j.fontName,j.fontStyle),M="Unicode";return _.metadata[M]?{widths:_.metadata[M].widths||{0:1},kerning:_.metadata[M].kerning||{}}:{font:_.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,o);s=Array.isArray(n)?n:String(n).split(/\r?\n/);var b=1*this.internal.scaleFactor*r/l;d.textIndent=o.textIndent?1*o.textIndent*this.internal.scaleFactor/l:0,d.lineIndent=o.lineIndent;var p,v,m=[];for(p=0,v=s.length;p<v;p++)m=m.concat(Uy.apply(this,[s[p],b,d]));return m},(function(n){n.__fontmetrics__=n.__fontmetrics__||{};for(var r="0123456789abcdef",o="klmnopqrstuvwxyz",s={},l={},d=0;d<16;d++)s[o[d]]=r[d],l[r[d]]=o[d];var b=function(M){return"0x"+parseInt(M,10).toString(16)},p=n.__fontmetrics__.compress=function(M){var T,F,P,k,y=["{"];for(var ae in M){if(T=M[ae],isNaN(parseInt(ae,10))?F="'"+ae+"'":(ae=parseInt(ae,10),F=(F=b(ae).slice(2)).slice(0,-1)+l[F.slice(-1)]),typeof T=="number")T<0?(P=b(T).slice(3),k="-"):(P=b(T).slice(2),k=""),P=k+P.slice(0,-1)+l[P.slice(-1)];else{if(Hr(T)!=="object")throw new Error("Don't know what to do with value type "+Hr(T)+".");P=p(T)}y.push(F+P)}return y.push("}"),y.join("")},v=n.__fontmetrics__.uncompress=function(M){if(typeof M!="string")throw new Error("Invalid argument passed to uncompress.");for(var T,F,P,k,y={},ae=1,E=y,U=[],ne="",Z="",G=M.length-1,te=1;te<G;te+=1)(k=M[te])=="'"?T?(P=T.join(""),T=void 0):T=[]:T?T.push(k):k=="{"?(U.push([E,P]),E={},P=void 0):k=="}"?((F=U.pop())[0][F[1]]=E,P=void 0,E=F[0]):k=="-"?ae=-1:P===void 0?s.hasOwnProperty(k)?(ne+=s[k],P=parseInt(ne,16)*ae,ae=1,ne=""):ne+=k:s.hasOwnProperty(k)?(Z+=s[k],E[P]=parseInt(Z,16)*ae,ae=1,P=void 0,Z=""):Z+=k;return y},m={codePages:["WinAnsiEncoding"],WinAnsiEncoding:v("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},j={Unicode:{Courier:m,"Courier-Bold":m,"Courier-BoldOblique":m,"Courier-Oblique":m,Helvetica:m,"Helvetica-Bold":m,"Helvetica-BoldOblique":m,"Helvetica-Oblique":m,"Times-Roman":m,"Times-Bold":m,"Times-BoldItalic":m,"Times-Italic":m}},_={Unicode:{"Courier-Oblique":v("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":v("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":v("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:v("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":v("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":v("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:v("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:v("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":v("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:v("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":v("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":v("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":v("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":v("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};n.events.push(["addFont",function(M){var T=M.font,F=_.Unicode[T.postScriptName];F&&(T.metadata.Unicode={},T.metadata.Unicode.widths=F.widths,T.metadata.Unicode.kerning=F.kerning);var P=j.Unicode[T.postScriptName];P&&(T.metadata.Unicode.encoding=P,T.encoding=P.codePages[0])}])})(Fn.API),(function(n){var r=function(o){for(var s=o.length,l=new Uint8Array(s),d=0;d<s;d++)l[d]=o.charCodeAt(d);return l};n.API.events.push(["addFont",function(o){var s=void 0,l=o.font,d=o.instance;if(!l.isStandardFont){if(d===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+l.postScriptName+"').");if(typeof(s=d.existsFileInVFS(l.postScriptName)===!1?d.loadFile(l.postScriptName):d.getFileFromVFS(l.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+l.postScriptName+"').");(function(b,p){p=/^\x00\x01\x00\x00/.test(p)?r(p):r(ch(p)),b.metadata=n.API.TTFFont.open(p),b.metadata.Unicode=b.metadata.Unicode||{encoding:{},kerning:{},widths:[]},b.metadata.glyIdsUsed=[0]})(l,s)}}])})(Fn),Fn.API.addSvgAsImage=function(n,r,o,s,l,d,b,p){if(isNaN(r)||isNaN(o))throw co.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(l))throw co.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var v=document.createElement("canvas");v.width=s,v.height=l;var m=v.getContext("2d");m.fillStyle="#fff",m.fillRect(0,0,v.width,v.height);var j={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},_=this;return(pi.canvg?Promise.resolve(pi.canvg):wg(()=>import("./index.es-Buw90qDC.js"),[])).catch(function(M){return Promise.reject(new Error("Could not load canvg: "+M))}).then(function(M){return M.default?M.default:M}).then(function(M){return M.fromString(m,n,j)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(M){return M.render(j)}).then(function(){_.addImage(v.toDataURL("image/jpeg",1),r,o,s,l,b,p)})},Fn.API.putTotalPages=function(n){var r,o=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(r=new RegExp(n,"g"),o=this.internal.getNumberOfPages()):(r=new RegExp(this.pdfEscape16(n,this.internal.getFont()),"g"),o=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var s=1;s<=this.internal.getNumberOfPages();s++)for(var l=0;l<this.internal.pages[s].length;l++)this.internal.pages[s][l]=this.internal.pages[s][l].replace(r,o);return this},Fn.API.viewerPreferences=function(n,r){var o;n=n||{},r=r||!1;var s,l,d,b={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},p=Object.keys(b),v=[],m=0,j=0,_=0;function M(F,P){var k,y=!1;for(k=0;k<F.length;k+=1)F[k]===P&&(y=!0);return y}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(b)),this.internal.viewerpreferences.isSubscribed=!1),o=this.internal.viewerpreferences.configuration,n==="reset"||r===!0){var T=p.length;for(_=0;_<T;_+=1)o[p[_]].value=o[p[_]].defaultValue,o[p[_]].explicitSet=!1}if(Hr(n)==="object"){for(l in n)if(d=n[l],M(p,l)&&d!==void 0){if(o[l].type==="boolean"&&typeof d=="boolean")o[l].value=d;else if(o[l].type==="name"&&M(o[l].valueSet,d))o[l].value=d;else if(o[l].type==="integer"&&Number.isInteger(d))o[l].value=d;else if(o[l].type==="array"){for(m=0;m<d.length;m+=1)if(s=!0,d[m].length===1&&typeof d[m][0]=="number")v.push(String(d[m]-1));else if(d[m].length>1){for(j=0;j<d[m].length;j+=1)typeof d[m][j]!="number"&&(s=!1);s===!0&&v.push([d[m][0]-1,d[m][1]-1].join(" "))}o[l].value="["+v.join(" ")+"]"}else o[l].value=o[l].defaultValue;o[l].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var F,P=[];for(F in o)o[F].explicitSet===!0&&(o[F].type==="name"?P.push("/"+F+" /"+o[F].value):P.push("/"+F+" "+o[F].value));P.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+P.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=o,this},(function(n){var r=function(){var s='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',l=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),d=unescape(encodeURIComponent(s)),b=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),p=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),v=unescape(encodeURIComponent("</x:xmpmeta>")),m=d.length+b.length+p.length+l.length+v.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+m+" >>"),this.internal.write("stream"),this.internal.write(l+d+b+p+v),this.internal.write("endstream"),this.internal.write("endobj")},o=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};n.addMetadata=function(s,l){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:s,namespaceuri:l||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",o),this.internal.events.subscribe("postPutResources",r)),this}})(Fn.API),(function(n){var r=n.API,o=r.pdfEscape16=function(d,b){for(var p,v=b.metadata.Unicode.widths,m=["","0","00","000","0000"],j=[""],_=0,M=d.length;_<M;++_){if(p=b.metadata.characterToGlyph(d.charCodeAt(_)),b.metadata.glyIdsUsed.push(p),b.metadata.toUnicode[p]=d.charCodeAt(_),v.indexOf(p)==-1&&(v.push(p),v.push([parseInt(b.metadata.widthOfGlyph(p),10)])),p=="0")return j.join("");p=p.toString(16),j.push(m[4-p.length],p)}return j.join("")},s=function(d){var b,p,v,m,j,_,M;for(j=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,v=[],_=0,M=(p=Object.keys(d).sort(function(T,F){return T-F})).length;_<M;_++)b=p[_],v.length>=100&&(j+=`
`+v.length+` beginbfchar
`+v.join(`
`)+`
endbfchar`,v=[]),d[b]!==void 0&&d[b]!==null&&typeof d[b].toString=="function"&&(m=("0000"+d[b].toString(16)).slice(-4),b=("0000"+(+b).toString(16)).slice(-4),v.push("<"+b+"><"+m+">"));return v.length&&(j+=`
`+v.length+` beginbfchar
`+v.join(`
`)+`
endbfchar
`),j+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};r.events.push(["putFont",function(d){(function(b){var p=b.font,v=b.out,m=b.newObject,j=b.putStream;if(p.metadata instanceof n.API.TTFFont&&p.encoding==="Identity-H"){for(var _=p.metadata.Unicode.widths,M=p.metadata.subset.encode(p.metadata.glyIdsUsed,1),T="",F=0;F<M.length;F++)T+=String.fromCharCode(M[F]);var P=m();j({data:T,addLength1:!0,objectId:P}),v("endobj");var k=m();j({data:s(p.metadata.toUnicode),addLength1:!0,objectId:k}),v("endobj");var y=m();v("<<"),v("/Type /FontDescriptor"),v("/FontName /"+cf(p.fontName)),v("/FontFile2 "+P+" 0 R"),v("/FontBBox "+n.API.PDFObject.convert(p.metadata.bbox)),v("/Flags "+p.metadata.flags),v("/StemV "+p.metadata.stemV),v("/ItalicAngle "+p.metadata.italicAngle),v("/Ascent "+p.metadata.ascender),v("/Descent "+p.metadata.decender),v("/CapHeight "+p.metadata.capHeight),v(">>"),v("endobj");var ae=m();v("<<"),v("/Type /Font"),v("/BaseFont /"+cf(p.fontName)),v("/FontDescriptor "+y+" 0 R"),v("/W "+n.API.PDFObject.convert(_)),v("/CIDToGIDMap /Identity"),v("/DW 1000"),v("/Subtype /CIDFontType2"),v("/CIDSystemInfo"),v("<<"),v("/Supplement 0"),v("/Registry (Adobe)"),v("/Ordering ("+p.encoding+")"),v(">>"),v(">>"),v("endobj"),p.objectNumber=m(),v("<<"),v("/Type /Font"),v("/Subtype /Type0"),v("/ToUnicode "+k+" 0 R"),v("/BaseFont /"+cf(p.fontName)),v("/Encoding /"+p.encoding),v("/DescendantFonts ["+ae+" 0 R]"),v(">>"),v("endobj"),p.isAlreadyPutted=!0}})(d)}]),r.events.push(["putFont",function(d){(function(b){var p=b.font,v=b.out,m=b.newObject,j=b.putStream;if(p.metadata instanceof n.API.TTFFont&&p.encoding==="WinAnsiEncoding"){for(var _=p.metadata.rawData,M="",T=0;T<_.length;T++)M+=String.fromCharCode(_[T]);var F=m();j({data:M,addLength1:!0,objectId:F}),v("endobj");var P=m();j({data:s(p.metadata.toUnicode),addLength1:!0,objectId:P}),v("endobj");var k=m();v("<<"),v("/Descent "+p.metadata.decender),v("/CapHeight "+p.metadata.capHeight),v("/StemV "+p.metadata.stemV),v("/Type /FontDescriptor"),v("/FontFile2 "+F+" 0 R"),v("/Flags 96"),v("/FontBBox "+n.API.PDFObject.convert(p.metadata.bbox)),v("/FontName /"+cf(p.fontName)),v("/ItalicAngle "+p.metadata.italicAngle),v("/Ascent "+p.metadata.ascender),v(">>"),v("endobj"),p.objectNumber=m();for(var y=0;y<p.metadata.hmtx.widths.length;y++)p.metadata.hmtx.widths[y]=parseInt(p.metadata.hmtx.widths[y]*(1e3/p.metadata.head.unitsPerEm));v("<</Subtype/TrueType/Type/Font/ToUnicode "+P+" 0 R/BaseFont/"+cf(p.fontName)+"/FontDescriptor "+k+" 0 R/Encoding/"+p.encoding+" /FirstChar 29 /LastChar 255 /Widths "+n.API.PDFObject.convert(p.metadata.hmtx.widths)+">>"),v("endobj"),p.isAlreadyPutted=!0}})(d)}]);var l=function(d){var b,p=d.text||"",v=d.x,m=d.y,j=d.options||{},_=d.mutex||{},M=_.pdfEscape,T=_.activeFontKey,F=_.fonts,P=T,k="",y=0,ae="",E=F[P].encoding;if(F[P].encoding!=="Identity-H")return{text:p,x:v,y:m,options:j,mutex:_};for(ae=p,P=T,Array.isArray(p)&&(ae=p[0]),y=0;y<ae.length;y+=1)F[P].metadata.hasOwnProperty("cmap")&&(b=F[P].metadata.cmap.unicode.codeMap[ae[y].charCodeAt(0)]),b||ae[y].charCodeAt(0)<256&&F[P].metadata.hasOwnProperty("Unicode")?k+=ae[y]:k+="";var U="";return parseInt(P.slice(1))<14||E==="WinAnsiEncoding"?U=M(k,P).split("").map(function(ne){return ne.charCodeAt(0).toString(16)}).join(""):E==="Identity-H"&&(U=o(k,F[P])),_.isHex=!0,{text:U,x:v,y:m,options:j,mutex:_}};r.events.push(["postProcessText",function(d){var b=d.text||"",p=[],v={text:b,x:d.x,y:d.y,options:d.options,mutex:d.mutex};if(Array.isArray(b)){var m=0;for(m=0;m<b.length;m+=1)Array.isArray(b[m])&&b[m].length===3?p.push([l(Object.assign({},v,{text:b[m][0]})).text,b[m][1],b[m][2]]):p.push(l(Object.assign({},v,{text:b[m]})).text);d.text=p}else d.text=l(Object.assign({},v,{text:b})).text}])})(Fn),(function(n){var r=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};n.existsFileInVFS=function(o){return r.call(this),this.internal.vFS[o]!==void 0},n.addFileToVFS=function(o,s){return r.call(this),this.internal.vFS[o]=s,this},n.getFileFromVFS=function(o){return r.call(this),this.internal.vFS[o]!==void 0?this.internal.vFS[o]:null}})(Fn.API),(function(n){n.__bidiEngine__=n.prototype.__bidiEngine__=function(s){var l,d,b,p,v,m,j,_=r,M=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],T=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],F={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},P={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},k=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],y=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),ae=!1,E=0;this.__bidiEngine__={};var U=function(Y){var D=Y.charCodeAt(),J=D>>8,$=P[J];return $!==void 0?_[256*$+(255&D)]:J===252||J===253?"AL":y.test(J)?"L":J===8?"R":"N"},ne=function(Y){for(var D,J=0;J<Y.length;J++){if((D=U(Y.charAt(J)))==="L")return!1;if(D==="R")return!0}return!1},Z=function(Y,D,J,$){var je,ee,de,Ne,Ie=D[$];switch(Ie){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":ae=!1;break;case"N":case"AN":break;case"EN":ae&&(Ie="AN");break;case"AL":ae=!0,Ie="R";break;case"WS":case"BN":Ie="N";break;case"CS":$<1||$+1>=D.length||(je=J[$-1])!=="EN"&&je!=="AN"||(ee=D[$+1])!=="EN"&&ee!=="AN"?Ie="N":ae&&(ee="AN"),Ie=ee===je?ee:"N";break;case"ES":Ie=(je=$>0?J[$-1]:"B")==="EN"&&$+1<D.length&&D[$+1]==="EN"?"EN":"N";break;case"ET":if($>0&&J[$-1]==="EN"){Ie="EN";break}if(ae){Ie="N";break}for(de=$+1,Ne=D.length;de<Ne&&D[de]==="ET";)de++;Ie=de<Ne&&D[de]==="EN"?"EN":"N";break;case"NSM":if(b&&!p){for(Ne=D.length,de=$+1;de<Ne&&D[de]==="NSM";)de++;if(de<Ne){var $e=Y[$],q=$e>=1425&&$e<=2303||$e===64286;if(je=D[de],q&&(je==="R"||je==="AL")){Ie="R";break}}}Ie=$<1||(je=D[$-1])==="B"?"N":J[$-1];break;case"B":ae=!1,l=!0,Ie=E;break;case"S":d=!0,Ie="N"}return Ie},G=function(Y,D,J){var $=Y.split("");return J&&te($,J,{hiLevel:E}),$.reverse(),D&&D.reverse(),$.join("")},te=function(Y,D,J){var $,je,ee,de,Ne,Ie=-1,$e=Y.length,q=0,w=[],V=E?T:M,H=[];for(ae=!1,l=!1,d=!1,je=0;je<$e;je++)H[je]=U(Y[je]);for(ee=0;ee<$e;ee++){if(Ne=q,w[ee]=Z(Y,H,w,ee),$=240&(q=V[Ne][F[w[ee]]]),q&=15,D[ee]=de=V[q][5],$>0)if($===16){for(je=Ie;je<ee;je++)D[je]=1;Ie=-1}else Ie=-1;if(V[q][6])Ie===-1&&(Ie=ee);else if(Ie>-1){for(je=Ie;je<ee;je++)D[je]=de;Ie=-1}H[ee]==="B"&&(D[ee]=0),J.hiLevel|=de}d&&(function(ue,ve,se){for(var ze=0;ze<se;ze++)if(ue[ze]==="S"){ve[ze]=E;for(var xe=ze-1;xe>=0&&ue[xe]==="WS";xe--)ve[xe]=E}})(H,D,$e)},O=function(Y,D,J,$,je){if(!(je.hiLevel<Y)){if(Y===1&&E===1&&!l)return D.reverse(),void(J&&J.reverse());for(var ee,de,Ne,Ie,$e=D.length,q=0;q<$e;){if($[q]>=Y){for(Ne=q+1;Ne<$e&&$[Ne]>=Y;)Ne++;for(Ie=q,de=Ne-1;Ie<de;Ie++,de--)ee=D[Ie],D[Ie]=D[de],D[de]=ee,J&&(ee=J[Ie],J[Ie]=J[de],J[de]=ee);q=Ne}q++}}},W=function(Y,D,J){var $=Y.split(""),je={hiLevel:E};return J||(J=[]),te($,J,je),(function(ee,de,Ne){if(Ne.hiLevel!==0&&j)for(var Ie,$e=0;$e<ee.length;$e++)de[$e]===1&&(Ie=k.indexOf(ee[$e]))>=0&&(ee[$e]=k[Ie+1])})($,J,je),O(2,$,D,J,je),O(1,$,D,J,je),$.join("")};return this.__bidiEngine__.doBidiReorder=function(Y,D,J){if((function(je,ee){if(ee)for(var de=0;de<je.length;de++)ee[de]=de;p===void 0&&(p=ne(je)),m===void 0&&(m=ne(je))})(Y,D),b||!v||m)if(b&&v&&p^m)E=p?1:0,Y=G(Y,D,J);else if(!b&&v&&m)E=p?1:0,Y=W(Y,D,J),Y=G(Y,D);else if(!b||p||v||m){if(b&&!v&&p^m)Y=G(Y,D),p?(E=0,Y=W(Y,D,J)):(E=1,Y=W(Y,D,J),Y=G(Y,D));else if(b&&p&&!v&&m)E=1,Y=W(Y,D,J),Y=G(Y,D);else if(!b&&!v&&p^m){var $=j;p?(E=1,Y=W(Y,D,J),E=0,j=!1,Y=W(Y,D,J),j=$):(E=0,Y=W(Y,D,J),Y=G(Y,D),E=1,j=!1,Y=W(Y,D,J),j=$,Y=G(Y,D))}}else E=0,Y=W(Y,D,J);else E=p?1:0,Y=W(Y,D,J);return Y},this.__bidiEngine__.setOptions=function(Y){Y&&(b=Y.isInputVisual,v=Y.isOutputVisual,p=Y.isInputRtl,m=Y.isOutputRtl,j=Y.isSymmetricSwapping)},this.__bidiEngine__.setOptions(s),this.__bidiEngine__};var r=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],o=new n.__bidiEngine__({isInputVisual:!0});n.API.events.push(["postProcessText",function(s){var l=s.text;s.x,s.y;var d=s.options||{};s.mutex,d.lang;var b=[];if(d.isInputVisual=typeof d.isInputVisual!="boolean"||d.isInputVisual,o.setOptions(d),Object.prototype.toString.call(l)==="[object Array]"){var p=0;for(b=[],p=0;p<l.length;p+=1)Object.prototype.toString.call(l[p])==="[object Array]"?b.push([o.doBidiReorder(l[p][0]),l[p][1],l[p][2]]):b.push([o.doBidiReorder(l[p])]);s.text=b}else s.text=o.doBidiReorder(l);o.setOptions({isInputVisual:!0})}])})(Fn),Fn.API.TTFFont=(function(){function n(r){var o;if(this.rawData=r,o=this.contents=new Xu(r),this.contents.pos=4,o.readString(4)==="ttcf")throw new Error("TTCF not supported.");o.pos=0,this.parse(),this.subset=new Z5(this),this.registerTTF()}return n.open=function(r){return new n(r)},n.prototype.parse=function(){return this.directory=new B5(this.contents),this.head=new F5(this),this.name=new H5(this),this.cmap=new em(this),this.toUnicode={},this.hhea=new U5(this),this.maxp=new W5(this),this.hmtx=new $5(this),this.post=new V5(this),this.os2=new E5(this),this.loca=new K5(this),this.glyf=new Y5(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},n.prototype.registerTTF=function(){var r,o,s,l,d;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var b,p,v,m;for(m=[],b=0,p=(v=this.bbox).length;b<p;b++)r=v[b],m.push(Math.round(r*this.scaleFactor));return m}).call(this),this.stemV=0,this.post.exists?(s=255&(l=this.post.italic_angle),32768&(o=l>>16)&&(o=-(1+(65535^o))),this.italicAngle=+(o+"."+s)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(d=this.familyClass)===1||d===2||d===3||d===4||d===5||d===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},n.prototype.characterToGlyph=function(r){var o;return((o=this.cmap.unicode)!=null?o.codeMap[r]:void 0)||0},n.prototype.widthOfGlyph=function(r){var o;return o=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(r).advance*o},n.prototype.widthOfString=function(r,o,s){var l,d,b,p;for(b=0,d=0,p=(r=""+r).length;0<=p?d<p:d>p;d=0<=p?++d:--d)l=r.charCodeAt(d),b+=this.widthOfGlyph(this.characterToGlyph(l))+s*(1e3/o)||0;return b*(o/1e3)},n.prototype.lineHeight=function(r,o){var s;return o==null&&(o=!1),s=o?this.lineGap:0,(this.ascender+s-this.decender)/1e3*r},n})();var Pc,Xu=(function(){function n(r){this.data=r??[],this.pos=0,this.length=this.data.length}return n.prototype.readByte=function(){return this.data[this.pos++]},n.prototype.writeByte=function(r){return this.data[this.pos++]=r},n.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},n.prototype.writeUInt32=function(r){return this.writeByte(r>>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},n.prototype.readInt32=function(){var r;return(r=this.readUInt32())>=2147483648?r-4294967296:r},n.prototype.writeInt32=function(r){return r<0&&(r+=4294967296),this.writeUInt32(r)},n.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},n.prototype.writeUInt16=function(r){return this.writeByte(r>>8&255),this.writeByte(255&r)},n.prototype.readInt16=function(){var r;return(r=this.readUInt16())>=32768?r-65536:r},n.prototype.writeInt16=function(r){return r<0&&(r+=65536),this.writeUInt16(r)},n.prototype.readString=function(r){var o,s;for(s=[],o=0;0<=r?o<r:o>r;o=0<=r?++o:--o)s[o]=String.fromCharCode(this.readByte());return s.join("")},n.prototype.writeString=function(r){var o,s,l;for(l=[],o=0,s=r.length;0<=s?o<s:o>s;o=0<=s?++o:--o)l.push(this.writeByte(r.charCodeAt(o)));return l},n.prototype.readShort=function(){return this.readInt16()},n.prototype.writeShort=function(r){return this.writeInt16(r)},n.prototype.readLongLong=function(){var r,o,s,l,d,b,p,v;return r=this.readByte(),o=this.readByte(),s=this.readByte(),l=this.readByte(),d=this.readByte(),b=this.readByte(),p=this.readByte(),v=this.readByte(),128&r?-1*(72057594037927940*(255^r)+281474976710656*(255^o)+1099511627776*(255^s)+4294967296*(255^l)+16777216*(255^d)+65536*(255^b)+256*(255^p)+(255^v)+1):72057594037927940*r+281474976710656*o+1099511627776*s+4294967296*l+16777216*d+65536*b+256*p+v},n.prototype.writeLongLong=function(r){var o,s;return o=Math.floor(r/4294967296),s=4294967295&r,this.writeByte(o>>24&255),this.writeByte(o>>16&255),this.writeByte(o>>8&255),this.writeByte(255&o),this.writeByte(s>>24&255),this.writeByte(s>>16&255),this.writeByte(s>>8&255),this.writeByte(255&s)},n.prototype.readInt=function(){return this.readInt32()},n.prototype.writeInt=function(r){return this.writeInt32(r)},n.prototype.read=function(r){var o,s;for(o=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)o.push(this.readByte());return o},n.prototype.write=function(r){var o,s,l,d;for(d=[],s=0,l=r.length;s<l;s++)o=r[s],d.push(this.writeByte(o));return d},n})(),B5=(function(){var n;function r(o){var s,l,d;for(this.scalarType=o.readInt(),this.tableCount=o.readShort(),this.searchRange=o.readShort(),this.entrySelector=o.readShort(),this.rangeShift=o.readShort(),this.tables={},l=0,d=this.tableCount;0<=d?l<d:l>d;l=0<=d?++l:--l)s={tag:o.readString(4),checksum:o.readInt(),offset:o.readInt(),length:o.readInt()},this.tables[s.tag]=s}return r.prototype.encode=function(o){var s,l,d,b,p,v,m,j,_,M,T,F,P;for(P in T=Object.keys(o).length,v=Math.log(2),_=16*Math.floor(Math.log(T)/v),b=Math.floor(_/v),j=16*T-_,(l=new Xu).writeInt(this.scalarType),l.writeShort(T),l.writeShort(_),l.writeShort(b),l.writeShort(j),d=16*T,m=l.pos+d,p=null,F=[],o)for(M=o[P],l.writeString(P),l.writeInt(n(M)),l.writeInt(m),l.writeInt(M.length),F=F.concat(M),P==="head"&&(p=m),m+=M.length;m%4;)F.push(0),m++;return l.write(F),s=2981146554-n(l.data),l.pos=p+8,l.writeUInt32(s),l.data},n=function(o){var s,l,d,b;for(o=tm.call(o);o.length%4;)o.push(0);for(d=new Xu(o),l=0,s=0,b=o.length;s<b;s=s+=4)l+=d.readUInt32();return 4294967295&l},r})(),O5={}.hasOwnProperty,tu=function(n,r){for(var o in r)O5.call(r,o)&&(n[o]=r[o]);function s(){this.constructor=n}return s.prototype=r.prototype,n.prototype=new s,n.__super__=r.prototype,n};Pc=(function(){function n(r){var o;this.file=r,o=this.file.directory.tables[this.tag],this.exists=!!o,o&&(this.offset=o.offset,this.length=o.length,this.parse(this.file.contents))}return n.prototype.parse=function(){},n.prototype.encode=function(){},n.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},n})();var F5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return tu(n,Pc),n.prototype.tag="head",n.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},n.prototype.encode=function(r){var o;return(o=new Xu).writeInt(this.version),o.writeInt(this.revision),o.writeInt(this.checkSumAdjustment),o.writeInt(this.magicNumber),o.writeShort(this.flags),o.writeShort(this.unitsPerEm),o.writeLongLong(this.created),o.writeLongLong(this.modified),o.writeShort(this.xMin),o.writeShort(this.yMin),o.writeShort(this.xMax),o.writeShort(this.yMax),o.writeShort(this.macStyle),o.writeShort(this.lowestRecPPEM),o.writeShort(this.fontDirectionHint),o.writeShort(r),o.writeShort(this.glyphDataFormat),o.data},n})(),Xy=(function(){function n(r,o){var s,l,d,b,p,v,m,j,_,M,T,F,P,k,y,ae,E;switch(this.platformID=r.readUInt16(),this.encodingID=r.readShort(),this.offset=o+r.readInt(),_=r.pos,r.pos=this.offset,this.format=r.readUInt16(),this.length=r.readUInt16(),this.language=r.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(v=0;v<256;++v)this.codeMap[v]=r.readByte();break;case 4:for(T=r.readUInt16(),M=T/2,r.pos+=6,d=(function(){var U,ne;for(ne=[],v=U=0;0<=M?U<M:U>M;v=0<=M?++U:--U)ne.push(r.readUInt16());return ne})(),r.pos+=2,P=(function(){var U,ne;for(ne=[],v=U=0;0<=M?U<M:U>M;v=0<=M?++U:--U)ne.push(r.readUInt16());return ne})(),m=(function(){var U,ne;for(ne=[],v=U=0;0<=M?U<M:U>M;v=0<=M?++U:--U)ne.push(r.readUInt16());return ne})(),j=(function(){var U,ne;for(ne=[],v=U=0;0<=M?U<M:U>M;v=0<=M?++U:--U)ne.push(r.readUInt16());return ne})(),l=(this.length-r.pos+this.offset)/2,p=(function(){var U,ne;for(ne=[],v=U=0;0<=l?U<l:U>l;v=0<=l?++U:--U)ne.push(r.readUInt16());return ne})(),v=y=0,E=d.length;y<E;v=++y)for(k=d[v],s=ae=F=P[v];F<=k?ae<=k:ae>=k;s=F<=k?++ae:--ae)j[v]===0?b=s+m[v]:(b=p[j[v]/2+(s-F)-(M-v)]||0)!==0&&(b+=m[v]),this.codeMap[s]=65535&b}r.pos=_}return n.encode=function(r,o){var s,l,d,b,p,v,m,j,_,M,T,F,P,k,y,ae,E,U,ne,Z,G,te,O,W,Y,D,J,$,je,ee,de,Ne,Ie,$e,q,w,V,H,ue,ve,se,ze,xe,De,Ye,lt;switch($=new Xu,b=Object.keys(r).sort(function(St,Wt){return St-Wt}),o){case"macroman":for(P=0,k=(function(){var St=[];for(F=0;F<256;++F)St.push(0);return St})(),ae={0:0},d={},je=0,Ie=b.length;je<Ie;je++)ae[xe=r[l=b[je]]]==null&&(ae[xe]=++P),d[l]={old:r[l],new:ae[r[l]]},k[l]=ae[r[l]];return $.writeUInt16(1),$.writeUInt16(0),$.writeUInt32(12),$.writeUInt16(0),$.writeUInt16(262),$.writeUInt16(0),$.write(k),{charMap:d,subtable:$.data,maxGlyphID:P+1};case"unicode":for(D=[],_=[],E=0,ae={},s={},y=m=null,ee=0,$e=b.length;ee<$e;ee++)ae[ne=r[l=b[ee]]]==null&&(ae[ne]=++E),s[l]={old:ne,new:ae[ne]},p=ae[ne]-l,y!=null&&p===m||(y&&_.push(y),D.push(l),m=p),y=l;for(y&&_.push(y),_.push(65535),D.push(65535),W=2*(O=D.length),te=2*Math.pow(Math.log(O)/Math.LN2,2),M=Math.log(te/2)/Math.LN2,G=2*O-te,v=[],Z=[],T=[],F=de=0,q=D.length;de<q;F=++de){if(Y=D[F],j=_[F],Y===65535){v.push(0),Z.push(0);break}if(Y-(J=s[Y].new)>=32768)for(v.push(0),Z.push(2*(T.length+O-F)),l=Ne=Y;Y<=j?Ne<=j:Ne>=j;l=Y<=j?++Ne:--Ne)T.push(s[l].new);else v.push(J-Y),Z.push(0)}for($.writeUInt16(3),$.writeUInt16(1),$.writeUInt32(12),$.writeUInt16(4),$.writeUInt16(16+8*O+2*T.length),$.writeUInt16(0),$.writeUInt16(W),$.writeUInt16(te),$.writeUInt16(M),$.writeUInt16(G),se=0,w=_.length;se<w;se++)l=_[se],$.writeUInt16(l);for($.writeUInt16(0),ze=0,V=D.length;ze<V;ze++)l=D[ze],$.writeUInt16(l);for(De=0,H=v.length;De<H;De++)p=v[De],$.writeUInt16(p);for(Ye=0,ue=Z.length;Ye<ue;Ye++)U=Z[Ye],$.writeUInt16(U);for(lt=0,ve=T.length;lt<ve;lt++)P=T[lt],$.writeUInt16(P);return{charMap:s,subtable:$.data,maxGlyphID:E+1}}},n})(),em=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return tu(n,Pc),n.prototype.tag="cmap",n.prototype.parse=function(r){var o,s,l;for(r.pos=this.offset,this.version=r.readUInt16(),l=r.readUInt16(),this.tables=[],this.unicode=null,s=0;0<=l?s<l:s>l;s=0<=l?++s:--s)o=new Xy(r,this.offset),this.tables.push(o),o.isUnicode&&this.unicode==null&&(this.unicode=o);return!0},n.encode=function(r,o){var s,l;return o==null&&(o="macroman"),s=Xy.encode(r,o),(l=new Xu).writeUInt16(0),l.writeUInt16(1),s.table=l.data.concat(s.subtable),s},n})(),U5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return tu(n,Pc),n.prototype.tag="hhea",n.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},n})(),E5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return tu(n,Pc),n.prototype.tag="OS/2",n.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=(function(){var o,s;for(s=[],o=0;o<10;++o)s.push(r.readByte());return s})(),this.charRange=(function(){var o,s;for(s=[],o=0;o<4;++o)s.push(r.readInt());return s})(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=(function(){var o,s;for(s=[],o=0;o<2;o=++o)s.push(r.readInt());return s})(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},n})(),V5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return tu(n,Pc),n.prototype.tag="post",n.prototype.parse=function(r){var o,s,l;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:case 196608:break;case 131072:var d;for(s=r.readUInt16(),this.glyphNameIndex=[],d=0;0<=s?d<s:d>s;d=0<=s?++d:--d)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],l=[];r.pos<this.offset+this.length;)o=r.readByte(),l.push(this.names.push(r.readString(o)));return l;case 151552:return s=r.readUInt16(),this.offsets=r.read(s);case 262144:return this.map=(function(){var b,p,v;for(v=[],d=b=0,p=this.file.maxp.numGlyphs;0<=p?b<p:b>p;d=0<=p?++b:--b)v.push(r.readUInt32());return v}).call(this)}},n})(),q5=function(n,r){this.raw=n,this.length=n.length,this.platformID=r.platformID,this.encodingID=r.encodingID,this.languageID=r.languageID},H5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return tu(n,Pc),n.prototype.tag="name",n.prototype.parse=function(r){var o,s,l,d,b,p,v,m,j,_,M;for(r.pos=this.offset,r.readShort(),o=r.readShort(),p=r.readShort(),s=[],d=0;0<=o?d<o:d>o;d=0<=o?++d:--d)s.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+p+r.readShort()});for(v={},d=j=0,_=s.length;j<_;d=++j)l=s[d],r.pos=l.offset,m=r.readString(l.length),b=new q5(m,l),v[M=l.nameID]==null&&(v[M]=[]),v[l.nameID].push(b);this.strings=v,this.copyright=v[0],this.fontFamily=v[1],this.fontSubfamily=v[2],this.uniqueSubfamily=v[3],this.fontName=v[4],this.version=v[5];try{this.postscriptName=v[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=v[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=v[7],this.manufacturer=v[8],this.designer=v[9],this.description=v[10],this.vendorUrl=v[11],this.designerUrl=v[12],this.license=v[13],this.licenseUrl=v[14],this.preferredFamily=v[15],this.preferredSubfamily=v[17],this.compatibleFull=v[18],this.sampleText=v[19]},n})(),W5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return tu(n,Pc),n.prototype.tag="maxp",n.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},n})(),$5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return tu(n,Pc),n.prototype.tag="hmtx",n.prototype.parse=function(r){var o,s,l,d,b,p,v;for(r.pos=this.offset,this.metrics=[],o=0,p=this.file.hhea.numberOfMetrics;0<=p?o<p:o>p;o=0<=p?++o:--o)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(l=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var m,j;for(j=[],o=m=0;0<=l?m<l:m>l;o=0<=l?++m:--m)j.push(r.readInt16());return j})(),this.widths=(function(){var m,j,_,M;for(M=[],m=0,j=(_=this.metrics).length;m<j;m++)d=_[m],M.push(d.advance);return M}).call(this),s=this.widths[this.widths.length-1],v=[],o=b=0;0<=l?b<l:b>l;o=0<=l?++b:--b)v.push(this.widths.push(s));return v},n.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},n})(),tm=[].slice,Y5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return tu(n,Pc),n.prototype.tag="glyf",n.prototype.parse=function(){return this.cache={}},n.prototype.glyphFor=function(r){var o,s,l,d,b,p,v,m,j,_;return r in this.cache?this.cache[r]:(d=this.file.loca,o=this.file.contents,s=d.indexOf(r),(l=d.lengthOf(r))===0?this.cache[r]=null:(o.pos=this.offset+s,b=(p=new Xu(o.read(l))).readShort(),m=p.readShort(),_=p.readShort(),v=p.readShort(),j=p.readShort(),this.cache[r]=b===-1?new X5(p,m,_,v,j):new G5(p,b,m,_,v,j),this.cache[r]))},n.prototype.encode=function(r,o,s){var l,d,b,p,v;for(b=[],d=[],p=0,v=o.length;p<v;p++)l=r[o[p]],d.push(b.length),l&&(b=b.concat(l.encode(s)));return d.push(b.length),{table:b,offsets:d}},n})(),G5=(function(){function n(r,o,s,l,d,b){this.raw=r,this.numberOfContours=o,this.xMin=s,this.yMin=l,this.xMax=d,this.yMax=b,this.compound=!1}return n.prototype.encode=function(){return this.raw.data},n})(),X5=(function(){function n(r,o,s,l,d){var b,p;for(this.raw=r,this.xMin=o,this.yMin=s,this.xMax=l,this.yMax=d,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],b=this.raw;p=b.readShort(),this.glyphOffsets.push(b.pos),this.glyphIDs.push(b.readUInt16()),32&p;)b.pos+=1&p?4:2,128&p?b.pos+=8:64&p?b.pos+=4:8&p&&(b.pos+=2)}return n.prototype.encode=function(){var r,o,s;for(o=new Xu(tm.call(this.raw.data)),r=0,s=this.glyphIDs.length;r<s;++r)o.pos=this.glyphOffsets[r];return o.data},n})(),K5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return tu(n,Pc),n.prototype.tag="loca",n.prototype.parse=function(r){var o,s;return r.pos=this.offset,o=this.file.head.indexToLocFormat,this.offsets=o===0?(function(){var l,d;for(d=[],s=0,l=this.length;s<l;s+=2)d.push(2*r.readUInt16());return d}).call(this):(function(){var l,d;for(d=[],s=0,l=this.length;s<l;s+=4)d.push(r.readUInt32());return d}).call(this)},n.prototype.indexOf=function(r){return this.offsets[r]},n.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},n.prototype.encode=function(r,o){for(var s=new Uint32Array(this.offsets.length),l=0,d=0,b=0;b<s.length;++b)if(s[b]=l,d<o.length&&o[d]==b){++d,s[b]=l;var p=this.offsets[b],v=this.offsets[b+1]-p;v>0&&(l+=v)}for(var m=new Array(4*s.length),j=0;j<s.length;++j)m[4*j+3]=255&s[j],m[4*j+2]=(65280&s[j])>>8,m[4*j+1]=(16711680&s[j])>>16,m[4*j]=(4278190080&s[j])>>24;return m},n})(),Z5=(function(){function n(r){this.font=r,this.subset={},this.unicodes={},this.next=33}return n.prototype.generateCmap=function(){var r,o,s,l,d;for(o in l=this.font.cmap.tables[0].codeMap,r={},d=this.subset)s=d[o],r[o]=l[s];return r},n.prototype.glyphsFor=function(r){var o,s,l,d,b,p,v;for(l={},b=0,p=r.length;b<p;b++)l[d=r[b]]=this.font.glyf.glyphFor(d);for(d in o=[],l)(s=l[d])!=null&&s.compound&&o.push.apply(o,s.glyphIDs);if(o.length>0)for(d in v=this.glyphsFor(o))s=v[d],l[d]=s;return l},n.prototype.encode=function(r,o){var s,l,d,b,p,v,m,j,_,M,T,F,P,k,y;for(l in s=em.encode(this.generateCmap(),"unicode"),b=this.glyphsFor(r),T={0:0},y=s.charMap)T[(v=y[l]).old]=v.new;for(F in M=s.maxGlyphID,b)F in T||(T[F]=M++);return j=(function(ae){var E,U;for(E in U={},ae)U[ae[E]]=E;return U})(T),_=Object.keys(j).sort(function(ae,E){return ae-E}),P=(function(){var ae,E,U;for(U=[],ae=0,E=_.length;ae<E;ae++)p=_[ae],U.push(j[p]);return U})(),d=this.font.glyf.encode(b,P,T),m=this.font.loca.encode(d.offsets,P),k={cmap:this.font.cmap.raw(),glyf:d.table,loca:m,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(o)},this.font.os2.exists&&(k["OS/2"]=this.font.os2.raw()),this.font.directory.encode(k)},n})();Fn.API.PDFObject=(function(){var n;function r(){}return n=function(o,s){return(Array(s+1).join("0")+o).slice(-s)},r.convert=function(o){var s,l,d,b;if(Array.isArray(o))return"["+(function(){var p,v,m;for(m=[],p=0,v=o.length;p<v;p++)s=o[p],m.push(r.convert(s));return m})().join(" ")+"]";if(typeof o=="string")return"/"+o;if(o?.isString)return"("+o+")";if(o instanceof Date)return"(D:"+n(o.getUTCFullYear(),4)+n(o.getUTCMonth(),2)+n(o.getUTCDate(),2)+n(o.getUTCHours(),2)+n(o.getUTCMinutes(),2)+n(o.getUTCSeconds(),2)+"Z)";if({}.toString.call(o)==="[object Object]"){for(l in d=["<<"],o)b=o[l],d.push("/"+l+" "+r.convert(b));return d.push(">>"),d.join(`
`)}return""+o},r})();const qg=n=>{const r=c0[n];return!r||!r.prefix||r.prefix.length<1?"?":r.prefix[0].substring(0,1).toUpperCase()},cc=(n,r,o)=>({color:r,size:o}),Ky=(n,r,o)=>{},Lo=(n,r,o,s)=>({color:o,size:s}),sf=(n,r,o,s)=>{},J5=()=>{const n=new Map,r={top:"#0072B2",bottom:"#56B4E9"},o={top:18,bottom:18},s={top:"#FFFF00",bottom:"#FFFF00"},l={top:18,bottom:18},d={top:"#AA4499",bottom:"#F781BF"},b={top:6,bottom:6},p={top:"#6A3D9A",bottom:"#9467BD"},v={top:18,bottom:18};return n.set("select",{id:"select",name:"Select",toolType:"select",icon:"",shortcut:"S",tooltip:"Select objects or groups",colorReflective:!1,settings:cc("select","#ff0000",10),layerSettings:new Map([["top",Lo("select","top","#ff0000",10)],["bottom",Lo("select","bottom","#ff0000",10)]])}),n.set("via",{id:"via",name:"Via",toolType:"draw",drawingMode:"via",icon:"",shortcut:"V",tooltip:"Place via connection",colorReflective:!0,settings:cc("via",hg,xg.DEFAULT_SIZE),layerSettings:new Map([["top",Lo("via","top",hg,xg.DEFAULT_SIZE)],["bottom",Lo("via","bottom",hg,xg.DEFAULT_SIZE)]]),defaultLayer:"top"}),n.set("pad",{id:"pad",name:"Pad",toolType:"draw",drawingMode:"pad",icon:"",shortcut:"P",tooltip:"Place pad connection",colorReflective:!0,settings:cc("pad",T2,18),layerSettings:new Map([["top",Lo("pad","top",r.top,o.top)],["bottom",Lo("pad","bottom",r.bottom,o.bottom)]]),defaultLayer:"top"}),n.set("testPoint",{id:"testPoint",name:"Test Point",toolType:"draw",drawingMode:"testPoint",icon:"",shortcut:"Y",tooltip:"Place test point",colorReflective:!0,settings:cc("testPoint","#FFFF00",18),layerSettings:new Map([["top",Lo("testPoint","top",s.top,l.top)],["bottom",Lo("testPoint","bottom",s.bottom,l.bottom)]]),defaultLayer:"top"}),n.set("trace",{id:"trace",name:"Trace",toolType:"draw",drawingMode:"trace",icon:"",shortcut:"T",tooltip:"Draw copper traces",colorReflective:!0,settings:cc("trace",w2,6),layerSettings:new Map([["top",Lo("trace","top",d.top,b.top)],["bottom",Lo("trace","bottom",d.bottom,b.bottom)]]),defaultLayer:"top"}),n.set("component",{id:"component",name:"Component",toolType:"component",icon:"",shortcut:"C",tooltip:"Place component",colorReflective:!0,settings:cc("component",S2,l0.DEFAULT_SIZE),layerSettings:new Map([["top",Lo("component","top",p.top,v.top)],["bottom",Lo("component","bottom",p.bottom,v.bottom)]]),defaultLayer:"top"}),n.set("componentConnection",{id:"componentConnection",name:"Component Connections",toolType:"componentConnection",icon:"",shortcut:"",tooltip:"Component connection lines",colorReflective:!1,settings:cc("componentConnection","#E69F00",3),layerSettings:new Map([["top",Lo("componentConnection","top","#E69F00",3)],["bottom",Lo("componentConnection","bottom","#E69F00",3)]])}),n.set("power",{id:"power",name:"Power",toolType:"power",icon:"",shortcut:"B",tooltip:"Place power node",colorReflective:!0,settings:cc("power",yg,18),layerSettings:new Map([["top",Lo("power","top",yg,18)],["bottom",Lo("power","bottom",yg,18)]]),defaultLayer:"top"}),n.set("ground",{id:"ground",name:"Ground",toolType:"ground",icon:"",shortcut:"G",tooltip:"Place ground symbol",colorReflective:!0,settings:cc("ground",gg,18),layerSettings:new Map([["top",Lo("ground","top",gg,18)],["bottom",Lo("ground","bottom",gg,18)]]),defaultLayer:"top"}),n.set("erase",{id:"erase",name:"Erase",toolType:"erase",icon:"",shortcut:"E",tooltip:"Erase objects",colorReflective:!1,settings:cc("erase","#f5a3b3",18),layerSettings:new Map([["top",Lo("erase","top","#f5a3b3",18)],["bottom",Lo("erase","bottom","#f5a3b3",18)]])}),n.set("pan",{id:"pan",name:"Move",toolType:"pan",icon:"",shortcut:"H",tooltip:"Pan the view",colorReflective:!1,settings:cc("pan","#ff0000",10),layerSettings:new Map([["top",Lo("pan","top","#ff0000",10)],["bottom",Lo("pan","bottom","#ff0000",10)]])}),n.set("magnify",{id:"magnify",name:"Zoom",toolType:"magnify",icon:"+",shortcut:"M",tooltip:"Magnify",colorReflective:!1,settings:cc("magnify","#ff0000",10),layerSettings:new Map([["top",Lo("magnify","top","#ff0000",10)],["bottom",Lo("magnify","bottom","#ff0000",10)]])}),n},Q5=({visible:n,toolRegistry:r,currentTool:o,drawingMode:s,traceToolLayer:l,padToolLayer:d,testPointToolLayer:b,componentToolLayer:p,updateToolSettings:v,updateToolLayerSettings:m,setBrushSize:j,saveToolSettings:_,saveToolLayerSettings:M,setTopTraceSize:T,setBottomTraceSize:F,setTopPadSize:P,setBottomPadSize:k,setTopTestPointSize:y,setBottomTestPointSize:ae,setTopComponentSize:E,setBottomComponentSize:U,setComponentConnectionSize:ne,saveDefaultSize:Z,onClose:G})=>{const[te,O]=I.useState({}),W=[{id:"via",name:"Via",instanceId:"via"},{id:"pad",name:"Pad",layer:"top",instanceId:"padTop"},{id:"pad",name:"Pad",layer:"bottom",instanceId:"padBottom"},{id:"testPoint",name:"Test Point",layer:"top",instanceId:"testPointTop"},{id:"testPoint",name:"Test Point",layer:"bottom",instanceId:"testPointBottom"},{id:"trace",name:"Trace",layer:"top",instanceId:"traceTop"},{id:"trace",name:"Trace",layer:"bottom",instanceId:"traceBottom"},{id:"component",name:"Component",layer:"top",instanceId:"componentTop"},{id:"component",name:"Component",layer:"bottom",instanceId:"componentBottom"},{id:"componentConnection",name:"Component Connections"},{id:"power",name:"Power",instanceId:"power"},{id:"ground",name:"Ground",instanceId:"ground"},{id:"erase",name:"Erase"}];I.useEffect(()=>{if(n){const J={};for(const $ of W){const je=$.instanceId||$.id;if($.instanceId)try{const ee=Ln.get($.instanceId);J[je]=ee.size}catch{const ee=r.get($.id);ee&&(J[je]=$.layer?ee.layerSettings.get($.layer)?.size??ee.settings.size??10:ee.settings.size??10)}else{const ee=r.get($.id);ee&&(J[je]=ee.settings.size??10)}}O(J)}},[n]);const Y=I.useCallback((J,$,je,ee)=>{if(!r.get(J)&&J!=="componentConnection")return;const Ne=ee||J;O($e=>({...$e,[Ne]:$})),["trace","pad","testPoint","component"].includes(J)&&je&&ee?(Ln.setSize(ee,$),(J==="trace"&&o==="draw"&&s==="trace"||J==="pad"&&o==="draw"&&s==="pad"||J==="testPoint"&&o==="draw"&&s==="testPoint"||J==="component"&&o==="component")&&((J==="trace"?l:J==="pad"?d:J==="testPoint"?b:p)||"top")===je&&j($)):ee?(Ln.setSize(ee,$),(J==="via"&&o==="draw"&&s==="via"||J==="power"&&o==="power"||J==="ground"&&o==="ground")&&j($)):(J==="componentConnection"&&(ne($),Z("componentConnection",$)),J==="erase"&&o==="erase"&&j($))},[r,o,s,l,d,b,p,j,ne,Z]);if(!n)return null;const D=Array.from({length:50},(J,$)=>$+1);return i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:J=>{J.target===J.currentTarget&&G()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"16px",width:"fit-content",maxWidth:"400px",maxHeight:"85vh",overflowY:"auto",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:J=>J.stopPropagation(),children:[i.jsx("h3",{style:{margin:"0 0 12px 0",color:"#fff",fontSize:"16px",fontWeight:600},children:"Set Tool Size"}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:W.map((J,$)=>{if(!r.get(J.id)&&J.id!=="componentConnection")return null;const ee=J.layer?`${J.name} (${J.layer==="top"?"Top":"Bottom"})`:J.name,de=J.instanceId||J.id,Ne=te[de]??10;return i.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"6px 10px",background:"#1f1f24",borderRadius:4},children:[i.jsxs("label",{style:{color:"#f2f2f2",fontSize:"13px",width:"140px",flexShrink:0,marginRight:"8px"},children:[ee,":"]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[i.jsx("select",{value:Ne,onChange:Ie=>{const $e=parseInt(Ie.target.value,10);Y(J.id,$e,J.layer,J.instanceId)},style:{width:"50px",padding:"4px 6px",background:"#2b2b31",border:"1px solid #3a3a44",borderRadius:4,color:"#f2f2f2",fontSize:"12px",cursor:"pointer"},children:D.map(Ie=>i.jsx("option",{value:Ie,style:{background:"#2b2b31",color:"#f2f2f2"},children:Ie},Ie))}),i.jsx("span",{style:{color:"#f2f2f2",fontSize:"12px"},children:"px"})]})]},`${J.id}-${J.layer||"default"}-${$}`)})}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:i.jsx("button",{onClick:G,style:{padding:"6px 12px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:600},children:"Close"})})]})})},ew=({visible:n,toolRegistry:r,currentTool:o,drawingMode:s,traceToolLayer:l,padToolLayer:d,testPointToolLayer:b,componentToolLayer:p,updateToolSettings:v,updateToolLayerSettings:m,saveToolSettings:j,saveToolLayerSettings:_,setBrushColor:M,setTopTraceColor:T,setBottomTraceColor:F,setTopPadColor:P,setBottomPadColor:k,setTopTestPointColor:y,setBottomTestPointColor:ae,setTopComponentColor:E,setBottomComponentColor:U,setComponentConnectionColor:ne,saveDefaultColor:Z,colorPalette:G,onClose:te})=>{const[O,W]=At.useState(null),[Y,D]=At.useState(0);if(At.useEffect(()=>{const de=[];return[{id:"via"},{id:"pad",layer:"top"},{id:"pad",layer:"bottom"},{id:"testPoint",layer:"top"},{id:"testPoint",layer:"bottom"},{id:"trace",layer:"top"},{id:"trace",layer:"bottom"},{id:"component",layer:"top"},{id:"component",layer:"bottom"},{id:"power"},{id:"ground"}].forEach(({id:Ie,layer:$e})=>{try{const q=Jp(Ie,$e),w=Ln.subscribe(q,()=>{D(V=>V+1)});de.push(w)}catch{}}),()=>{de.forEach(Ie=>Ie())}},[]),!n)return null;const J=["pad","testPoint","trace","component"],$=[{id:"via",name:"Via"},{id:"pad",name:"Pad",layer:"top"},{id:"pad",name:"Pad",layer:"bottom"},{id:"testPoint",name:"Test Point",layer:"top"},{id:"testPoint",name:"Test Point",layer:"bottom"},{id:"trace",name:"Trace",layer:"top"},{id:"trace",name:"Trace",layer:"bottom"},{id:"component",name:"Component",layer:"top"},{id:"component",name:"Component",layer:"bottom"},{id:"componentConnection",name:"Component Connections"},{id:"power",name:"Power"},{id:"ground",name:"Ground"},{id:"erase",name:"Erase"}],je=(de,Ne,Ie)=>{if(de==="componentConnection"){ne(Ne),Z("componentConnection",Ne),W(null);return}if(de==="erase"){const $e=r.get(de);$e&&(v(de,{...$e.settings,color:Ne}),j(de,Ne,$e.settings.size)),W(null);return}try{let $e;Ie&&J.includes(de)?$e=Jp(de,Ie):$e=Jp(de),Ln.setColor($e,Ne),(de==="via"&&o==="draw"&&s==="via"||de==="trace"&&o==="draw"&&s==="trace"||de==="pad"&&o==="draw"&&s==="pad"||de==="testPoint"&&o==="draw"&&s==="testPoint"||de==="component"&&o==="component"||de==="power"&&o==="power"||de==="ground"&&o==="ground")&&(Ie&&J.includes(de)?((de==="trace"?l:de==="pad"?d:de==="testPoint"?b:p)||"top")===Ie&&M(Ne):M(Ne))}catch($e){console.error(`Error updating color for tool ${de}:`,$e);const q=r.get(de);q&&(Ie&&J.includes(de)?(m(de,Ie,{...q.layerSettings.get(Ie),color:Ne}),_(de,Ie,Ne,q.layerSettings.get(Ie)?.size||q.settings.size)):(v(de,{...q.settings,color:Ne}),j(de,Ne,q.settings.size)))}W(null)},ee=(de,Ne)=>{let Ie;try{const w=Jp(de,Ne);Ie=Ln.get(w).color}catch{const w=r.get(de);if(!w)return null;Ie=w.settings.color??"#000000"}const $e=Ne?`${de}-${Ne}`:de,q=O?.toolId===de&&O?.layer===Ne;return i.jsxs("div",{style:{position:"relative",display:"inline-block",zIndex:10005},children:[i.jsx("button",{className:"color-swatch-button",onClick:w=>{w.stopPropagation(),W(q?null:{toolId:de,layer:Ne})},style:{width:"40px",height:"24px",background:Ie,backgroundColor:Ie,backgroundImage:"none",border:"1px solid #3a3a44",borderRadius:3,cursor:"pointer",padding:0,margin:0,display:"block","--swatch-color":Ie},title:Ie},`${$e}-button-${Ie}-${Y}`),q&&i.jsx("div",{onClick:w=>{w.stopPropagation()},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",padding:8,background:"#fff",border:"1px solid #ddd",borderRadius:6,boxShadow:"0 8px 18px rgba(0,0,0,0.18)",zIndex:100},children:i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(8, 22px)",gap:4},children:G.map(w=>i.jsx("div",{onClick:()=>je(de,w,Ne),title:w,style:{width:22,height:22,backgroundColor:w,border:w===Ie?"2px solid #333":"1px solid #ccc",cursor:"pointer"}},w))})})]},`${$e}-${Ie}-${Y}`)};return i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:de=>{de.target===de.currentTarget&&(te(),W(null))},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"16px",width:"fit-content",minWidth:"450px",maxWidth:"600px",maxHeight:"85vh",overflowY:"auto",overflowX:"visible",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:de=>de.stopPropagation(),children:[i.jsx("h3",{style:{margin:"0 0 12px 0",color:"#fff",fontSize:"16px",fontWeight:600},children:"Set Tool Color"}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:$.map((de,Ne)=>{if(!r.get(de.id))return null;const $e=de.layer?`${de.name} (${de.layer==="top"?"Top":"Bottom"})`:de.name;return i.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"6px 10px",background:"#1f1f24",borderRadius:4},children:[i.jsxs("label",{style:{color:"#f2f2f2",fontSize:"13px",width:"140px",flexShrink:0,marginRight:"8px"},children:[$e,":"]}),ee(de.id,de.layer)]},`${de.id}-${de.layer||"default"}-${Ne}`)})}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:i.jsx("button",{onClick:()=>{te(),W(null)},style:{padding:"6px 12px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:600},children:"Close"})})]})})},tw=({openMenu:n,setOpenMenu:r,isReadOnlyMode:o,currentProjectFilePath:s,isProjectActive:l,autoSaveEnabled:d,autoSaveInterval:b,hasUnsavedChangesState:p,onNewProject:v,onOpenProject:m,onSaveProject:j,onCloseProject:_,onPrint:M,onExportBOM:T,hasUnsavedChanges:F,bomExportFormat:P,setBomExportFormat:k,netlistExportFormat:y,setNetlistExportFormat:ae,onExportNetlist:E,setNewProjectDialog:U,setAutoSaveDialog:ne,onShowAiSettings:Z,topImage:G,bottomImage:te,setCurrentTool:O,resetImageTransform:W,areImagesLocked:Y,setAreImagesLocked:D,onEnterBoardDimensions:J,fileInputTopRef:$,fileInputBottomRef:je,openProjectRef:ee,increaseSize:de,decreaseSize:Ne,brushSize:Ie,drawingStrokes:$e,selectedIds:q,selectedComponentIds:w,selectedPowerIds:V,selectedGroundIds:H,componentsTop:ue,componentsBottom:ve,powers:se,grounds:ze,powerNodeNames:xe,groundNodeNames:De,setSetSizeDialog:Ye,areViasLocked:lt,setAreViasLocked:St,arePadsLocked:Wt,setArePadsLocked:ge,areTestPointsLocked:Ot,setAreTestPointsLocked:_t,areTracesLocked:qt,setAreTracesLocked:ht,areComponentsLocked:fn,setAreComponentsLocked:Yt,areGroundNodesLocked:ln,setAreGroundNodesLocked:cn,arePowerNodesLocked:Sn,setArePowerNodesLocked:mn,showTraceCornerDots:tt,setShowTraceCornerDots:Bt,showCrosshairs:Gt,setShowCrosshairs:an,setSelectedIds:dt,setSelectedComponentIds:Mt,setSelectedPowerIds:Me,setSelectedGroundIds:we,selectAllVias:st,selectAllTraces:et,selectAllPads:Pt,selectAllComponents:Rt,selectDisconnectedComponents:Ge,selectAllComponentConnections:zt,selectAllPowerNodes:Tt,selectAllGroundNodes:tn,selectPowerNodesByName:Xt,selectGroundNodesByName:pn,setShowPowerBusManager:ti,setShowGroundBusManager:Go,setShowPastMachine:zn,toolRegistry:Bi,updateToolSettings:ni,updateToolLayerSettings:nn,setBrushSize:xi,setBrushColor:hi,saveToolSettings:fr,saveToolLayerSettings:zr,colorPalette:or,currentTool:xt,drawingMode:Yn,traceToolLayer:ui,padToolLayer:Si,testPointToolLayer:ut,componentToolLayer:Et,setTopTraceSize:En,setBottomTraceSize:Zt,setTopPadSize:Vn,setBottomPadSize:Ti,setTopTestPointSize:_i,setBottomTestPointSize:mr,setTopComponentSize:mi,setBottomComponentSize:pr,setComponentConnectionSize:Ci,topTraceColor:_n,bottomTraceColor:ko,topPadColor:qn,bottomPadColor:us,topTestPointColor:gi,bottomTestPointColor:Mo,topComponentColor:Ei,bottomComponentColor:zs,setTopTraceColor:Ka,setBottomTraceColor:Za,setTopPadColor:ds,setBottomPadColor:Ur,setTopTestPointColor:Ws,setBottomTestPointColor:_r,setTopComponentColor:$i,setBottomComponentColor:yi,setComponentConnectionColor:Tr,saveDefaultSize:Ja,saveDefaultColor:Yl,menuBarRef:xo,onOpenProjectNotes:uo,onOpenTransformImages:Qi,onOpenTransformAll:Xo})=>{const[Gl,ca]=At.useState(null),Cr=At.useRef(null),[Xl,Wr]=At.useState(null),Di=At.useRef(null),[cl,Ba]=At.useState(!1),Bo=At.useRef(null),[fs,ka]=At.useState(!1),[Ko,Qr]=At.useState(!1),jr=Ct=>{if(!l){alert("Please create a new project (File  New Project) or open an existing project (File  Open Project) before using this feature."),r(null);return}const Kn=Ct();Kn instanceof Promise&&Kn.catch(Fa=>{const ua=Fa instanceof Error?Fa.message:String(Fa);console.error("Error in requireProject action:",Fa),alert(`An error occurred:

${ua}

See console for details.`)})},ps=Ct=>{const Kn=Ct==="power"?xe:De,Fa=Kn.length>0,ua=Ct==="power"?"Select Power Nodes":"Select Ground Nodes";return i.jsxs("div",{onMouseEnter:()=>{Cr.current&&(clearTimeout(Cr.current),Cr.current=null),ca(Ct)},onMouseLeave:()=>{Cr.current=window.setTimeout(()=>{ca(wn=>wn===Ct?null:wn)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[i.jsxs("div",{style:{padding:"4px 10px",fontSize:12,color:"#bbb"},children:[ua," by Name"]}),i.jsxs("button",{onClick:()=>{Ct==="power"?Tt():tn(),ca(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:["All ",Ct==="power"?"Power Nodes":"Ground Nodes"]}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),Fa?Kn.map(wn=>i.jsx("button",{onClick:()=>{Ct==="power"?Xt(wn):pn(wn),ca(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:wn},wn)):i.jsxs("div",{style:{padding:"4px 10px",fontSize:12,color:"#bbb"},children:["No ",Ct==="power"?"power":"ground"," nodes available."]})]})},Oa=()=>i.jsxs("div",{onMouseEnter:()=>{Bo.current&&(clearTimeout(Bo.current),Bo.current=null),Ba(!0)},onMouseLeave:()=>{Bo.current=window.setTimeout(()=>{Ba(!1)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:180,background:"#2b2b31",border:"1px solid #555",borderRadius:"4px",padding:"4px 0",zIndex:1001,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)"},children:[i.jsxs("button",{onClick:async()=>{if(!(o||!l)){ae("kicad"),Ba(!1),r(null);try{await E("kicad")}catch(Ct){console.error("Error exporting netlist:",Ct)}}},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 16px",color:o||!l?"#777":y==="kicad"?"#4CAF50":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer",fontWeight:y==="kicad"?"bold":"normal"},children:[y==="kicad"?" ":"","KiCad (.net)"]}),i.jsxs("button",{onClick:async()=>{if(!(o||!l)){ae("protel"),Ba(!1),r(null);try{await E("protel")}catch(Ct){console.error("Error exporting netlist:",Ct)}}},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 16px",color:o||!l?"#777":y==="protel"?"#4CAF50":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer",fontWeight:y==="protel"?"bold":"normal"},children:[y==="protel"?" ":"","Protel (.net)"]}),i.jsxs("button",{onClick:async()=>{if(!(o||!l)){ae("spice"),Ba(!1),r(null);try{await E("spice")}catch(Ct){console.error("Error exporting netlist:",Ct)}}},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 16px",color:o||!l?"#777":y==="spice"?"#4CAF50":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer",fontWeight:y==="spice"?"bold":"normal"},children:[y==="spice"?" ":"","SPICE (.cir)"]}),i.jsxs("button",{onClick:async()=>{if(!(o||!l)){ae("pads"),Ba(!1),r(null);try{await E("pads")}catch(Ct){console.error("Error exporting netlist:",Ct)}}},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 16px",color:o||!l?"#777":y==="pads"?"#4CAF50":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer",fontWeight:y==="pads"?"bold":"normal"},children:[y==="pads"?" ":"","PADS-PCB (.json)"]})]}),$s=()=>i.jsxs("div",{onMouseEnter:()=>{Di.current&&(clearTimeout(Di.current),Di.current=null),Wr("lock")},onMouseLeave:()=>{Di.current=window.setTimeout(()=>{Wr(Ct=>Ct==="lock"?null:Ct)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[i.jsxs("label",{onClick:Ct=>{Ct.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:lt,onChange:()=>{St(Ct=>!Ct)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Vias"})]}),i.jsxs("label",{onClick:Ct=>{Ct.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:Wt,onChange:()=>{ge(Ct=>!Ct)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Pads"})]}),i.jsxs("label",{onClick:Ct=>{Ct.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:Ot,onChange:()=>{_t(Ct=>!Ct)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Test Points"})]}),i.jsxs("label",{onClick:Ct=>{Ct.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:qt,onChange:()=>{ht(Ct=>!Ct)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Traces"})]}),i.jsxs("label",{onClick:Ct=>{Ct.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:fn,onChange:()=>{Yt(Ct=>!Ct)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Components"})]}),i.jsxs("label",{onClick:Ct=>{Ct.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:ln,onChange:()=>{cn(Ct=>!Ct)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Ground Node"})]}),i.jsxs("label",{onClick:Ct=>{Ct.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:Sn,onChange:()=>{mn(Ct=>!Ct)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Power Nodes"})]})]}),kn=()=>i.jsxs("div",{onMouseEnter:()=>{Di.current&&(clearTimeout(Di.current),Di.current=null),Wr("select")},onMouseLeave:()=>{Di.current=window.setTimeout(()=>{Wr(Ct=>Ct==="select"?null:Ct)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[i.jsx("button",{onClick:()=>{st(),Wr(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Vias"}),i.jsx("button",{onClick:()=>{et(),Wr(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Traces"}),i.jsx("button",{onClick:()=>{Pt(),Wr(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Pads"}),i.jsx("button",{onClick:()=>{const Ct=new Set($e.filter(Kn=>Kn.type==="testPoint").map(Kn=>Kn.id));dt(Ct),Mt(new Set),Me(new Set),we(new Set),Wr(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Test Points"}),i.jsx("button",{onClick:()=>{Rt(),Wr(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Components"}),i.jsx("button",{onClick:()=>{zt(),Wr(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Component Connections"}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onMouseEnter:()=>{Cr.current&&(clearTimeout(Cr.current),Cr.current=null),ca("power")},onMouseLeave:()=>{Cr.current=window.setTimeout(()=>{ca(Ct=>Ct==="power"?null:Ct)},200)},onClick:()=>{ca(Ct=>Ct==="power"?null:"power")},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Power Nodes "}),Gl==="power"&&ps("power")]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onMouseEnter:()=>{Cr.current&&(clearTimeout(Cr.current),Cr.current=null),ca("ground")},onMouseLeave:()=>{Cr.current=window.setTimeout(()=>{ca(Ct=>Ct==="ground"?null:Ct)},200)},onClick:()=>{ca(Ct=>Ct==="ground"?null:"ground")},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Ground Nodes "}),Gl==="ground"&&ps("ground")]}),i.jsx("button",{onClick:()=>{Ge(),Wr(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Disconnected Components"})]});return i.jsxs(i.Fragment,{children:[i.jsxs("div",{ref:xo,style:{position:"relative",background:"rgba(250,250,255,0.9)",borderBottom:"1px solid #e6e6ef",padding:"6px 12px",display:"flex",gap:16,alignItems:"center",zIndex:3},children:[i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onClick:Ct=>{Ct.stopPropagation(),r(Kn=>Kn==="file"?null:"file")},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:n==="file"?"#eef3ff":"#fff",fontWeight:600,color:"#222"},children:"File "}),n==="file"&&i.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:200,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[i.jsx("button",{onClick:()=>{o||(r(null),F()?U({visible:!0}):v())},disabled:o,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o?"not-allowed":"pointer"},children:"New Project"}),i.jsx("button",{onClick:async()=>{await m(),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Open Project"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{o||jr(()=>{j(),r(null)})},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer"},children:"Save Project"}),i.jsx("button",{onClick:async()=>{!o&&l&&(await _(),r(null))},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer"},children:"Close Project"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{o||jr(()=>{ne({visible:!0,interval:5}),r(null)})},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer"},children:"Auto Save"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{l&&(zn(!0),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Restore from History"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{Z(),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"AI Settings"}),i.jsx("button",{onClick:async()=>{if(!o){if(!l){alert("Please create a new project (File  New Project) or open an existing project (File  Open Project) before using this feature."),r(null);return}try{await T(),r(null)}catch(Ct){console.error("Error exporting BOM:",Ct)}}},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer"},children:"Export BOM"}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onMouseEnter:()=>{l&&Bo.current&&(clearTimeout(Bo.current),Bo.current=null),l&&Ba(!0)},onMouseLeave:()=>{l&&(Bo.current=window.setTimeout(()=>{Ba(!1)},200))},onClick:()=>{if(o||!l){l||(alert("Please create a new project (File  New Project) or open an existing project (File  Open Project) before using this feature."),r(null));return}Ba(Ct=>!Ct)},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer"},children:"Export Netlist "}),cl&&l&&Oa()]}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{jr(()=>{M(),r(null)})},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Print"}),i.jsx("button",{onClick:()=>{jr(()=>{M(),r(null)})},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Printer Settings"})]})]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onClick:Ct=>{o||(Ct.stopPropagation(),r(Kn=>Kn==="transform"?null:"transform"))},disabled:o,style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:n==="transform"?"#eef3ff":"#fff",fontWeight:600,color:o?"#999":"#222",cursor:o?"not-allowed":"pointer",opacity:o?.5:1},children:"Images "}),n==="transform"&&i.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:260,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[i.jsx("button",{onClick:()=>{!o&&!Y&&l&&($.current?.click(),r(null))},disabled:o||Y||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o||Y||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o||Y||!l?"not-allowed":"pointer"},children:"Load Top PCB"}),i.jsx("button",{onClick:()=>{!o&&!Y&&l&&(je.current?.click(),r(null))},disabled:o||Y||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o||Y||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o||Y||!l?"not-allowed":"pointer"},children:"Load Bottom PCB"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{!Y&&l&&(J(),r(null))},disabled:Y||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:Y||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:Y||!l?"not-allowed":"pointer"},children:"Enter PCB Dimensions"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{l&&(Qi(),r(null))},disabled:!G&&!te||Y||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:!G&&!te||Y||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:!G&&!te||Y||!l?"not-allowed":"pointer"},children:"Transform Images"}),i.jsx("button",{onClick:()=>{!Y&&l&&(O("transform"),W(),r(null))},disabled:Y||!G&&!te||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:Y||!G&&!te||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:Y||!G&&!te||!l?"not-allowed":"pointer"},children:"Reset Transform"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{l&&(D(Ct=>!Ct),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:Y?"Unlock Images ":"Lock Images"})]})]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onClick:Ct=>{o||(Ct.stopPropagation(),r(Kn=>Kn==="tools"?null:"tools"))},disabled:o,style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:n==="tools"?"#eef3ff":"#fff",fontWeight:600,color:o?"#999":"#222",cursor:o?"not-allowed":"pointer",opacity:o?.5:1},children:"Tools "}),n==="tools"&&i.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[i.jsx("button",{onClick:()=>{l&&(Xo(),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Change Perspective"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:Ct=>{l&&(de(Ct.shiftKey?5:1),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Increase Size (+)"}),i.jsx("button",{onClick:Ct=>{l&&(Ne(Ct.shiftKey?5:1),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Decrease Size (-)"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onMouseEnter:()=>{l&&Di.current&&(clearTimeout(Di.current),Di.current=null),l&&Wr("lock")},onMouseLeave:()=>{l&&(Di.current=window.setTimeout(()=>{Wr(Ct=>Ct==="lock"?null:Ct)},200))},onClick:()=>{l&&Wr(Ct=>Ct==="lock"?null:"lock")},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Lock "}),Xl==="lock"&&l&&$s()]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onMouseEnter:()=>{l&&Di.current&&(clearTimeout(Di.current),Di.current=null),l&&Wr("select")},onMouseLeave:()=>{l&&(Di.current=window.setTimeout(()=>{Wr(Ct=>Ct==="select"?null:Ct)},200))},onClick:()=>{l&&Wr(Ct=>Ct==="select"?null:"select")},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Select "}),Xl==="select"&&l&&kn()]}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{l&&(uo(),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Open Project Notes"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{l&&(ka(!0),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Set Tool Sizes"}),i.jsx("button",{onClick:()=>{l&&(Qr(!0),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Set Tool Colors"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{l&&(ti(!0),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Manage Power Buses"}),i.jsx("button",{onClick:()=>{l&&(Go(!0),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Manage Ground Buses"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsxs("button",{onClick:()=>{l&&(Bt(!tt),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:[tt?" ":"   ","Show Trace Corner Dots"]}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsxs("button",{onClick:()=>{l&&(an(!Gt),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:[Gt?" ":"   ","Show X-Y Axis Crosshairs"]})]})]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onClick:Ct=>{Ct.stopPropagation(),r(Kn=>Kn==="about"?null:"about")},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:n==="about"?"#eef3ff":"#fff",fontWeight:600,color:"#222"},children:"About "}),n==="about"&&i.jsx("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:500,maxWidth:700,maxHeight:"80vh",background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:20,overflowY:"auto",zIndex:100},children:i.jsxs("div",{style:{marginBottom:16},children:[i.jsx("h2",{style:{margin:"0 0 16px 0",color:"#f2f2f2",fontSize:"20px",fontWeight:700},children:"PCBTracer (v3.1)"}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"About"}),i.jsx("p",{style:{margin:"0 0 12px 0",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:"A specialized tool useful for both reverse engineering and troubleshooting printed circuit boards (PCBs) by tracing and documenting circuit connections from photographs. This application supports typical 2 to 4 layer PCBs and enables comprehensive PCB analysis and documentation."}),i.jsx("p",{style:{margin:"0 0 12px 0",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:"This tool can assist in troubleshooting by tracing circuits, holding contextual notes, comparing test results, and documenting findings during the debugging process."})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Technologies"}),i.jsxs("p",{style:{margin:"0 0 12px 0",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:["Built with ",i.jsx("strong",{children:"TypeScript"})," and ",i.jsx("strong",{children:"React"}),", with ",i.jsx("strong",{children:"AI integration"})," for intelligent extraction of electronic component information from datasheets. The application runs entirely client-side in the browser, providing a responsive, interactive drawing experience with no backend server requirements."]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Features"}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Via/Pad Placement"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsxs("li",{children:["Alt/Option+click the Via or Pad tool, or press ",i.jsx("code",{children:"Alt/Option+V"})," or ",i.jsx("code",{children:"Alt/Option+P"})," to open the placement dialog"]}),i.jsx("li",{children:"Place multiple vias or pads in Linear, 2-Sided, or 4-Sided arrangements"}),i.jsx("li",{children:"Automatic counter-clockwise numbering starting from Pin 1"}),i.jsx("li",{children:"Supports chip orientations of 0, 90, 180, or 270"}),i.jsx("li",{children:"Click and drag to define the placement area"}),i.jsx("li",{children:"Tool automatically returns to Select tool after placement"})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Tools & Shortcuts"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px 16px",fontSize:"13px",color:"#f2f2f2"},children:[i.jsx("div",{children:i.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Select"}),"  ",i.jsx("code",{children:"S"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Via"}),"  ",i.jsx("code",{children:"V"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Pad"}),"  ",i.jsx("code",{children:"P"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Test Point"}),"  ",i.jsx("code",{children:"Y"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Trace"}),"  ",i.jsx("code",{children:"T"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Component"}),"  ",i.jsx("code",{children:"C"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Component Properties"}),"  double-click component"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Resize Icons"}),"  ",i.jsx("code",{children:"+"})," / ",i.jsx("code",{children:"-"})," (",i.jsx("code",{children:"Shift"})," + ",i.jsx("code",{children:"+"})," / ",i.jsx("code",{children:"-"})," = 5x faster)"]})]})}),i.jsx("div",{children:i.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Power"}),"  ",i.jsx("code",{children:"B"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Ground"}),"  ",i.jsx("code",{children:"G"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Move (Pan)"}),"  ",i.jsx("code",{children:"H"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Magnify"}),"  ",i.jsx("code",{children:"M"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Set View"}),"  ",i.jsx("code",{children:"X"})," then ",i.jsx("code",{children:"0-9"})," to save view"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Recall View"}),"  ",i.jsx("code",{children:"0-9"})," to recall saved view"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Default View 0"}),"  ",i.jsx("code",{children:"0"})," to recall default view (origin with all images contained)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Information Dialog"}),"  ",i.jsx("code",{children:"I"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Notes Dialog"}),"  ",i.jsx("code",{children:"N"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Project Notes / TODO"}),"  ",i.jsx("code",{children:"L"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Undo"}),"  ",i.jsx("code",{children:"Ctrl"})," + ",i.jsx("code",{children:"Z"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Copy Component"}),"  ",i.jsx("code",{children:"Ctrl"})," + ",i.jsx("code",{children:"C"})," / ",i.jsx("code",{children:"Cmd"})," + ",i.jsx("code",{children:"C"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Paste Component"}),"  ",i.jsx("code",{children:"Ctrl"})," + ",i.jsx("code",{children:"V"})," / ",i.jsx("code",{children:"Cmd"})," + ",i.jsx("code",{children:"V"})]})]})})]}),i.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#f2f2f2"},children:[i.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#f2f2f2"},children:"Arrow Keys"}),i.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Move Selected Components"}),"  Arrow keys to nudge selected components (1 unit per press, ",i.jsx("code",{children:"Shift"})," = 10 units)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Switch Perspective"}),"  ",i.jsx("code",{children:"Shift"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," or ",i.jsx("code",{children:"Caps Lock"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," to switch between top/bottom view"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Rotate Perspective"}),"  ",i.jsx("code",{children:"Shift"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," or ",i.jsx("code",{children:"Caps Lock"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," to rotate in 90 increments (",i.jsx("code",{children:""})," = counter-clockwise, ",i.jsx("code",{children:""})," = clockwise)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Image Transformations"}),"  Arrow keys for scaling, rotating, and adjusting image transformations (when image is selected for transform)"]}),i.jsx("li",{children:"Click a slider first, then use arrow keys for precise adjustment"})]})]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px 20px"},children:[i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Image Management"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Load top and bottom PCB images"}),i.jsx("li",{children:"Image alignment and transformation"}),i.jsx("li",{children:"Transform modes: nudge, scale, rotate, slant, keystone"}),i.jsx("li",{children:"Horizontal and vertical flip controls"}),i.jsx("li",{children:"Brightness and contrast controls"}),i.jsx("li",{children:"Grayscale mode"}),i.jsx("li",{children:"Automated transparency slider"}),i.jsx("li",{children:"Board dimensions configuration"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Drawing Tools"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Draw copper traces (top and bottom layers)"}),i.jsx("li",{children:"Place vias for layer connections"}),i.jsx("li",{children:"Place component pads (SMD and through-hole)"}),i.jsx("li",{children:"Place test points for circuit testing"}),i.jsx("li",{children:"Place and annotate components"}),i.jsx("li",{children:"Place power and ground nodes"}),i.jsx("li",{children:"Erase tool for removing elements"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Layer Management"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"14 independent layers to manage PCB element types"}),i.jsx("li",{children:"Separate top and bottom layer support"}),i.jsx("li",{children:"Layer-specific color customization"}),i.jsx("li",{children:"Layer-specific size controls"}),i.jsx("li",{children:"Layer visibility toggles"}),i.jsx("li",{children:"Overlay view mode"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Component Management"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Component placement with pin counts"}),i.jsx("li",{children:"Pin connection tracking"}),i.jsx("li",{children:"Component type classification"}),i.jsx("li",{children:"Designator and value annotation"}),i.jsx("li",{children:"Component editor dialog"}),i.jsx("li",{children:"Find and center component"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Selection & Locking"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Select individual elements or groups"}),i.jsx("li",{children:"Select all vias, traces, pads, or components"}),i.jsx("li",{children:"Select power/ground nodes by name"}),i.jsx("li",{children:"Select disconnected components"}),i.jsx("li",{children:"Lock/unlock elements by type"}),i.jsx("li",{children:"Image locking for protection"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Power & Ground"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Multiple voltage power nodes"}),i.jsx("li",{children:"Power bus management"}),i.jsx("li",{children:"Ground node placement"}),i.jsx("li",{children:"Ground bus management"}),i.jsx("li",{children:"Node naming and organization"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Customization"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Customizable colors per layer"}),i.jsx("li",{children:"Adjustable brush/tool sizes"}),i.jsx("li",{children:"Size presets for common tools"}),i.jsx("li",{children:"Color palette management"}),i.jsx("li",{children:"Tool settings persistence"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Project Management"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Create, open, and save projects"}),i.jsx("li",{children:"Auto-save with configurable intervals"}),i.jsx("li",{children:"File history automatically saved in history subdirectory when Auto Save is enabled"}),i.jsx("li",{children:"Project Notes / TODO list with spreadsheet-like editing"}),i.jsx("li",{children:"Project file format (JSON)"}),i.jsx("li",{children:"Print functionality"}),i.jsx("li",{children:"Export to KiCad schematic format (future feature, not yet implemented)"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"View Controls"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Zoom in/out with mouse wheel"}),i.jsx("li",{children:"Pan view with hand tool"}),i.jsx("li",{children:"Zoom to fit"}),i.jsx("li",{children:"View mode switching (top/bottom/overlay)"}),i.jsx("li",{children:"Save up to 10 view locations (X + 0-9)"}),i.jsx("li",{children:"Recall saved views instantly (0-9 keys)"}),i.jsxs("li",{children:["Default View 0: Press ",i.jsx("code",{children:"0"})," to recall the default view showing the origin with all loaded images fully contained within the canvas"]}),i.jsx("li",{children:"Change Perspective (Tools menu) - switch between top/bottom view and rotate all elements"}),i.jsx("li",{children:"Detailed information dialog"})]})]})]})]}),i.jsx("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #444"},children:i.jsxs("p",{style:{margin:"0 0 8px 0",color:"#bbb",fontSize:"12px",lineHeight:"1.5"},children:["Use the ",i.jsx("strong",{children:"File"})," menu to manage projects, the ",i.jsx("strong",{children:"Images"})," menu for image loading and transformation, and the ",i.jsx("strong",{children:"Tools"})," menu for selection, locking, and customization options."]})}),i.jsxs("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #444"},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Future / TODO List"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"A searchable list of common components"}),i.jsx("li",{children:"Output schematics (perhaps as KiCad files)"}),i.jsx("li",{children:"Dynamic layers"}),i.jsx("li",{children:"Create a desktop version of this application using Electron"})]})]})]})})]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onClick:Ct=>{Ct.stopPropagation(),r(Kn=>Kn==="help"?null:"help")},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:n==="help"?"#eef3ff":"#fff",fontWeight:600,color:"#222"},children:"Help "}),n==="help"&&i.jsx("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:500,maxWidth:700,maxHeight:"80vh",background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:20,overflowY:"auto",zIndex:100},children:i.jsxs("div",{style:{marginBottom:16},children:[i.jsx("h2",{style:{margin:"0 0 16px 0",color:"#f2f2f2",fontSize:"20px",fontWeight:700},children:"Help: Typical Usage Steps"}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 1: Create or Open a Project"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"New Project:"})," File  New Project. Choose a project name and location."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Open Project:"})," File  Open Project. Select an existing project file (.json)."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Auto-Save:"})," File  Auto Save  Enable to automatically save your work at regular intervals."]})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 2: Load PCB Images"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Load Top Image:"})," Images  Load Top Image. Select your top-side PCB photo (.png or .jpeg)."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Load Bottom Image:"})," Images  Load Bottom Image. Select your bottom-side PCB photo."]}),i.jsxs("li",{children:["Images are automatically copied to the ",i.jsx("code",{style:{background:"#1f1f24",padding:"2px 4px",borderRadius:3,color:"#fff"},children:"images/"})," subdirectory."]})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 3: Align and Transform Images"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Enter Transform Mode:"})," Images  Transform Images. Select which image (Top or Bottom) to transform."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Transform Operations:"})," Use Move, Nudge, Scale, Rotate, Slant, or Keystone to align images."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Image Adjustments:"})," Adjust brightness, contrast, sharpness, and grayscale as needed."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Flip Images:"})," Use horizontal or vertical flip if your images are mirrored."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Arrow Keys:"})," When transform tool is active, use arrow keys for precise image adjustments."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Move Components:"})," Select components, then use arrow keys to move them (1 unit per press, ",i.jsx("code",{children:"Shift"})," = 10 units for larger steps)."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Change Perspective:"})," Tools  Change Perspective (or press ",i.jsx("code",{children:"E"}),") to switch between top/bottom view or rotate all elements (images, components, traces) together by 90, 180, or 270."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Quick Perspective Switch:"})," Press ",i.jsx("code",{children:"Shift"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," or ",i.jsx("code",{children:"Caps Lock"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," to quickly switch between top/bottom view."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Quick Perspective Rotation:"})," Press ",i.jsx("code",{children:"Shift"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," or ",i.jsx("code",{children:"Caps Lock"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," to rotate perspective in 90 increments (",i.jsx("code",{children:""})," = counter-clockwise, ",i.jsx("code",{children:""})," = clockwise)."]})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 4: Set Board Dimensions"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Enter Dimensions:"})," Images  Enter Board Dimensions. Specify the actual physical dimensions of your PCB."]}),i.jsx("li",{children:"This helps ensure accurate measurements and scaling for your reverse engineering work."})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 5: Trace Connections"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Place Vias:"})," Click the Via tool (",i.jsx("code",{children:"V"}),") and click on the PCB where vias connect layers."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Place Pads:"})," Click the Pad tool (",i.jsx("code",{children:"P"}),") and mark component pad locations."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Place Multiple Vias/Pads:"})," Alt/Option+click the Via or Pad tool, or press ",i.jsx("code",{children:"Alt/Option+V"})," (vias) or ",i.jsx("code",{children:"Alt/Option+P"})," (pads) to open the placement dialog. Choose arrangement (Linear, 2-Sided, or 4-Sided), number of pins, orientation, and layer. Click and drag on the canvas to define the placement area. Vias/pads are automatically arranged in counter-clockwise order starting from Pin 1."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Place Test Points:"})," Click the Test Point tool (",i.jsx("code",{children:"Y"}),") to mark test points."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Draw Traces:"})," Click the Trace tool (",i.jsx("code",{children:"T"}),"), select Top or Bottom layer, then click to start a trace. Click again to add segments. Press ",i.jsx("code",{children:"Enter"})," or click outside to finish."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Snapping:"})," Traces automatically snap to nearby vias, pads, power nodes, and ground nodes."]})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 6: Place Components"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Place Component:"})," Click the Component tool (",i.jsx("code",{children:"C"}),"), select component type, then click on the PCB."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Edit Component:"})," Double-click a component or select a component and press ",i.jsx("code",{children:"A"})," to open the Component Properties dialog. If multiple components are selected, opens the most recently selected one."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Set Properties:"})," Enter designator (e.g., R1, C2), value, and other component details."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Connect Pins:"})," Click on pads or vias to connect component pins to the circuit."]})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 7: Add Power and Ground Nodes"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Manage Power Buses:"})," Tools  Manage Power Buses to create and configure voltage buses (e.g., +5V, +3.3V)."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Place Power Nodes:"})," Click the Power tool (",i.jsx("code",{children:"B"}),"), select a voltage bus, then click on the PCB."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Manage Ground Buses:"})," Tools  Manage Ground Buses to configure ground connections."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Place Ground Nodes:"})," Click the Ground tool (",i.jsx("code",{children:"G"}),"), select a ground bus, then click on the PCB."]})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 8: Add Notes and Documentation"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Element Notes:"})," Press ",i.jsx("code",{children:"N"})," to open the Notes dialog for selected elements (vias, pads, traces, etc.)."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Project Notes:"})," Press ",i.jsx("code",{children:"L"})," to open Project Notes / TODO list for general project documentation."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Information Dialog:"})," Press ",i.jsx("code",{children:"I"})," to see detailed information about selected elements."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Find Elements:"})," Use the Find button in the Information dialog to center and highlight specific elements."]})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 9: Save Your Work"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Manual Save:"})," File  Save Project to save your work manually."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Auto-Save:"})," If enabled, your project is automatically saved at regular intervals."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"History:"})," Auto-saved versions are stored in the ",i.jsx("code",{style:{background:"#1f1f24",padding:"2px 4px",borderRadius:3,color:"#fff"},children:"history/"})," subdirectory."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Restore from History:"})," File  Restore from History to access previous versions."]})]})]}),i.jsxs("div",{style:{marginBottom:20,paddingTop:16,borderTop:"1px solid #444"},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Keyboard Shortcuts"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px 16px",fontSize:"13px",color:"#f2f2f2"},children:[i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#f2f2f2"},children:"Drawing Tools"}),i.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Select"}),"  ",i.jsx("code",{children:"S"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Via"}),"  ",i.jsx("code",{children:"V"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Via Pattern"}),"  ",i.jsx("code",{children:"Alt/Option+V"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Pad"}),"  ",i.jsx("code",{children:"P"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Pad Pattern"}),"  ",i.jsx("code",{children:"Alt/Option+P"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Test Point"}),"  ",i.jsx("code",{children:"Y"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Trace"}),"  ",i.jsx("code",{children:"T"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Component"}),"  ",i.jsx("code",{children:"C"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Component Properties"}),"  ",i.jsx("code",{children:"A"})," (opens dialog for selected component)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Power"}),"  ",i.jsx("code",{children:"B"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Ground"}),"  ",i.jsx("code",{children:"G"})]})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#f2f2f2"},children:"View & Navigation"}),i.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Move (Pan)"}),"  ",i.jsx("code",{children:"H"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Magnify"}),"  ",i.jsx("code",{children:"M"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Set View"}),"  ",i.jsx("code",{children:"X"})," then ",i.jsx("code",{children:"0-9"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Recall View"}),"  ",i.jsx("code",{children:"0-9"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Default View 0"}),"  ",i.jsx("code",{children:"0"})," (origin with all images contained)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Default View 0"}),"  ",i.jsx("code",{children:"0"})," (origin with all images contained)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Information"}),"  ",i.jsx("code",{children:"I"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Notes"}),"  ",i.jsx("code",{children:"N"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Project Notes"}),"  ",i.jsx("code",{children:"L"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Undo"}),"  ",i.jsx("code",{children:"Ctrl+Z"})," / ",i.jsx("code",{children:"Cmd+Z"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Copy Component"}),"  ",i.jsx("code",{children:"Ctrl+C"})," / ",i.jsx("code",{children:"Cmd+C"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Paste Component"}),"  ",i.jsx("code",{children:"Ctrl+V"})," / ",i.jsx("code",{children:"Cmd+V"})]})]})]})]}),i.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#f2f2f2"},children:[i.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#f2f2f2"},children:"Arrow Keys"}),i.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Move Selected Components"}),"  Arrow keys to nudge selected components (1 unit per press, ",i.jsx("code",{children:"Shift"})," = 10 units)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Switch Perspective"}),"  ",i.jsx("code",{children:"Shift"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," or ",i.jsx("code",{children:"Caps Lock"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Rotate Perspective"}),"  ",i.jsx("code",{children:"Shift"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," or ",i.jsx("code",{children:"Caps Lock"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," (",i.jsx("code",{children:""})," = counter-clockwise, ",i.jsx("code",{children:""})," = clockwise)"]}),i.jsx("li",{children:"Use arrow keys to adjust image transformations (when transform tool is active)"}),i.jsx("li",{children:"Click a slider first, then use arrow keys for precise adjustment"})]})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Tips & Tricks"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Double-click any slider to reset it to the default value"}),i.jsx("li",{children:"Double-click a component to edit its properties"}),i.jsxs("li",{children:["Hold ",i.jsx("code",{children:"Shift"})," while clicking to add to selection"]}),i.jsxs("li",{children:["Use the Information dialog (",i.jsx("code",{children:"I"}),") to see details about selected elements"]}),i.jsx("li",{children:"Lock layers (Tools  Lock) to prevent accidental modifications"}),i.jsx("li",{children:"Use the Find button in the Information dialog to center elements in view"}),i.jsxs("li",{children:["Save views with ",i.jsx("code",{children:"X"})," + number key for quick navigation"]}),i.jsxs("li",{children:["Use ",i.jsx("code",{children:"+"})," and ",i.jsx("code",{children:"-"})," keys to resize tool icons (",i.jsx("code",{children:"Shift"})," + ",i.jsx("code",{children:"+"})," / ",i.jsx("code",{children:"-"})," changes size 5 times faster)"]})]})]}),i.jsx("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #444"},children:i.jsxs("p",{style:{margin:"0 0 8px 0",color:"#bbb",fontSize:"12px",lineHeight:"1.5"},children:["For more detailed feature information, see the ",i.jsx("strong",{children:"About"})," menu."]})})]})})]}),s&&i.jsxs("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:"8px",paddingLeft:"16px"},children:[i.jsx("div",{style:{fontSize:"12px",color:"#333",fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"40vw"},title:s,children:s}),i.jsx("div",{style:{width:"16px",height:"16px",borderRadius:"50%",border:"1px solid #666",backgroundColor:p?d?"#ffaa00":"#ff0000":"#00ff00",flexShrink:0},title:p?d?`Changes detected  Auto Save: ON  Will be saved automatically every ${b||1} minute${b===1?"":"s"}`:"Changes detected  Auto Save: OFF  You need to save manually (File  Save Project)":"Project saved  No unsaved changes  Auto Save: "+(d?"ON":"OFF")})]})]}),i.jsx(Q5,{visible:fs,toolRegistry:Bi,currentTool:xt,drawingMode:Yn,traceToolLayer:ui,padToolLayer:Si,testPointToolLayer:ut,componentToolLayer:Et,updateToolSettings:ni,updateToolLayerSettings:nn,setBrushSize:xi,saveToolSettings:fr,saveToolLayerSettings:zr,setTopTraceSize:En,setBottomTraceSize:Zt,setTopPadSize:Vn,setBottomPadSize:Ti,setTopTestPointSize:_i,setBottomTestPointSize:mr,setTopComponentSize:mi,setBottomComponentSize:pr,setComponentConnectionSize:Ci,saveDefaultSize:Ja,onClose:()=>ka(!1)}),i.jsx(ew,{visible:Ko,toolRegistry:Bi,currentTool:xt,drawingMode:Yn,traceToolLayer:ui,padToolLayer:Si,testPointToolLayer:ut,componentToolLayer:Et,updateToolSettings:ni,updateToolLayerSettings:nn,saveToolSettings:fr,saveToolLayerSettings:zr,setBrushColor:hi,setTopTraceColor:Ka,setBottomTraceColor:Za,setTopPadColor:ds,setBottomPadColor:Ur,setTopTestPointColor:Ws,setBottomTestPointColor:_r,setTopComponentColor:$i,setBottomComponentColor:yi,setComponentConnectionColor:Tr,saveDefaultColor:Yl,colorPalette:or,onClose:()=>Qr(!1)})]})},nw=({visible:n,canvasSize:r={width:960,height:600},canvasPosition:o={left:244,top:6},onDismiss:s})=>{const l=I.useRef(null),d=I.useRef(null),[b,p]=I.useState(!0),v=I.useCallback(()=>{l.current&&(l.current.pause(),l.current.src="",l.current.load()),p(!1),s&&s()},[s]);return I.useEffect(()=>{n&&p(!0)},[n]),I.useEffect(()=>{if(!n)return;const m=()=>{v()};return document.addEventListener("click",m,{once:!0}),document.addEventListener("mousedown",m,{once:!0}),()=>{document.removeEventListener("click",m),document.removeEventListener("mousedown",m)}},[n,v]),I.useEffect(()=>{n&&b&&l.current?l.current.play().catch(m=>{console.warn("Video autoplay failed:",m)}):(!n||!b)&&l.current&&l.current&&(l.current.pause(),l.current.src="",l.current.load())},[n,b]),n?i.jsxs("div",{ref:d,onClick:v,style:{position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"#ffffff",pointerEvents:"auto",zIndex:10},children:[b&&i.jsx("video",{ref:l,src:"/PCB_Reverse_Engineering_Tool/SplashLoop.mp4",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,style:{position:"absolute",left:`${o.left}px`,top:`${o.top}px`,width:`${r.width}px`,height:`${r.height}px`,objectFit:"cover",pointerEvents:"none",zIndex:1}}),i.jsxs("div",{onClick:v,style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",padding:"24px 32px",background:"#ffffff",borderRadius:8,border:"2px solid #4CAF50",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",maxWidth:"500px",pointerEvents:"auto",zIndex:2,cursor:"pointer"},children:[i.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"#000",marginBottom:"12px"},children:"PCB Tracer: An Electronics Tool"}),i.jsxs("div",{style:{fontSize:"16px",fontWeight:600,color:"#000",marginBottom:"16px",lineHeight:"1.5"},children:["Reverse Engineer, Troubleshoot, Trace Signals,",i.jsx("br",{}),"Document Tests, Aid Repairs"]}),i.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"8px",lineHeight:"1.5",textAlign:"left"},children:"1) Use the File menu to start a new project."}),i.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"8px",lineHeight:"1.5",textAlign:"left"},children:"2) Use the Images menu to load images."}),i.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"12px",lineHeight:"1.5",textAlign:"left"},children:"3) Use the tools to draw vias, traces, components, etc."}),i.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"16px",textAlign:"center",fontStyle:"italic",fontWeight:"bold"},children:"Best viewed in browser's full screen mode."})]})]}):null},nm=({visible:n,title:r,message:o,onClose:s})=>n?i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:l=>{l.target===l.currentTarget&&s()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"2px solid #ff4444"},onClick:l=>l.stopPropagation(),children:[i.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",gap:"12px"},children:[i.jsx("div",{style:{fontSize:"24px",color:"#ff4444"},children:""}),i.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:r})]}),i.jsx("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"14px",lineHeight:"1.5"},children:o}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:i.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"OK"})})]})}):null,iw=({visible:n,selectedIds:r,selectedComponentIds:o,selectedPowerIds:s,selectedGroundIds:l,drawingStrokes:d,componentsTop:b,componentsBottom:p,powers:v,grounds:m,powerBuses:j,onClose:_,setComponentsTop:M,setComponentsBottom:T,determineViaType:F,determinePadType:P,determineTestPointType:k,onFindComponent:y,onFindStroke:ae,onFindPower:E,onFindGround:U,position:ne,isDragging:Z,onDragStart:G,onOpenNotesDialog:te,canvasHeight:O})=>{const[W,Y]=I.useState({visible:!1,title:"",message:""}),[D,J]=I.useState(()=>{const q=localStorage.getItem("detailedInfoDialogSize");if(q)try{return JSON.parse(q)}catch{return{width:400,height:window.innerHeight*.8}}return{width:400,height:window.innerHeight*.8}}),[$,je]=I.useState(!1),[ee,de]=I.useState({x:0,y:0,width:0,height:0});I.useEffect(()=>{if(!$)return;const q=V=>{const H=V.clientX-ee.x,ue=V.clientY-ee.y,ve=Math.max(300,Math.min(window.innerWidth-20,ee.width+H)),se=Math.max(200,Math.min(window.innerHeight-20,ee.height+ue)),ze={width:ve,height:se};J(ze),localStorage.setItem("detailedInfoDialogSize",JSON.stringify(ze))},w=()=>{je(!1)};return document.addEventListener("mousemove",q),document.addEventListener("mouseup",w),()=>{document.removeEventListener("mousemove",q),document.removeEventListener("mouseup",w)}},[$,ee]),I.useEffect(()=>{O&&O>200&&J(q=>{const w={...q,height:O};return localStorage.setItem("detailedInfoDialogSize",JSON.stringify(w)),w})},[O]);const Ne=q=>{q.preventDefault(),q.stopPropagation(),je(!0),de({x:q.clientX,y:q.clientY,width:D.width,height:D.height})};if(!n)return null;const Ie=ne?{position:"fixed",left:`${ne.x}px`,top:`${ne.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"300px",width:`${D.width}px`,height:`${D.height}px`,maxHeight:`${window.innerHeight-20}px`,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:Z?"grabbing":"default"}:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"flex-start",justifyContent:"flex-end",paddingRight:"20px",paddingTop:"80px",zIndex:1e4,pointerEvents:"none"},$e={padding:"20px",overflow:"auto",flex:1};return i.jsxs("div",{style:Ie,children:[i.jsxs("div",{style:{position:"relative",width:"100%",height:"100%",display:"flex",flexDirection:"column",...ne?{}:{backgroundColor:"#fff",borderRadius:8,minWidth:"300px",width:`${D.width}px`,height:`${D.height}px`,maxHeight:`${window.innerHeight-20}px`,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",pointerEvents:"auto"}},children:[i.jsxs("div",{onMouseDown:q=>{const w=q.target;w.tagName==="BUTTON"||w.closest("button")||ne&&G(q)},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:Z?"grabbing":ne?"grab":"default",userSelect:"none",flexShrink:0},children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Information (I)"}),i.jsx("button",{onClick:_,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsx("div",{style:$e,children:i.jsxs("div",{style:{margin:0,padding:0,backgroundColor:"#f5f5f5",borderRadius:4,fontSize:"12px",fontFamily:"monospace",maxHeight:"calc(80vh - 100px)",overflow:"auto",color:"#000"},children:[(()=>{const q=d.filter(ve=>r.has(ve.id)).length,w=[...b,...p].filter(ve=>o.has(ve.id)).length,V=v.filter(ve=>s.has(ve.id)).length,H=m.filter(ve=>l.has(ve.id)).length,ue=q+w+V+H;return i.jsx("div",{style:{padding:"12px 16px",backgroundColor:ue>0?"#e8e8e8":"#fff3cd",borderBottom:"2px solid #ccc",fontSize:"13px",fontWeight:600,color:ue>0?"#333":"#856404",marginBottom:"8px"},children:ue>0?`${ue} Object${ue!==1?"s":""} Selected`:"Zero Objects Selected"})})(),o.size>0&&(()=>{const q=d.some(w=>r.has(w.id)&&(w.type==="via"||w.type==="pad"));return[...b,...p].filter(w=>o.has(w.id)).map(w=>{const V=ll(w),H=V?.fields,ue=H&&H.length>0?i.jsx("div",{style:{marginTop:"6px",marginBottom:"6px",padding:"4px 0"},children:H.map(ve=>{const se=w[ve.name];if(se==null||se==="")return null;const ze=w[`${ve.name}Unit`],xe=typeof se=="boolean"?se?"Yes":"No":se;return i.jsxs("div",{style:{fontSize:"11px",color:"#444",marginBottom:"2px"},children:[ve.label,": ",xe,ze?` ${ze}`:""]},ve.name)})}):i.jsx("div",{style:{padding:"6px 0",fontSize:"11px",color:"#856404",background:"#fff3cd",border:"1px solid #ffeeba",borderRadius:4,marginTop:"6px",marginBottom:"6px"},children:"Component definition missing for this instance. Please ensure componentDefinitions.json entry and componentDefinitionKey are set."});return i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",flexDirection:"column",gap:"4px",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Category:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:V?.category||"N/A"})]})}),i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:V?.displayName?w.componentType==="Capacitor"&&!V.displayName.toLowerCase().includes("capacitor")?`${V.displayName} Capacitor`:V.displayName:w.componentType==="GenericComponent"&&w.genericType?Wl(w.genericType):w.componentType==="Diode"&&w.diodeType&&w.diodeType!=="Standard"?Wl(w.diodeType):w.componentType==="VariableResistor"&&w.vrType&&w.vrType!=="Potentiometer"?Wl(w.vrType):w.componentType==="Capacitor"&&w.dielectric==="Tantalum"?"Tantalum Capacitor":w.componentType==="Capacitor"&&w.capacitorType==="Electrolytic"?"Electrolytic Capacitor":w.componentType==="Capacitor"&&w.capacitorType==="Film"?"Film Capacitor":Wl(w.componentType)})]}),y&&i.jsx("button",{onClick:()=>{y(w.id,w.x,w.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:ve=>{ve.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:ve=>{ve.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[ue,i.jsxs("div",{children:["Layer: ",w.layer]}),w.componentType==="IntegratedCircuit"&&i.jsxs(i.Fragment,{children:[w.description&&i.jsxs("div",{children:["Description: ",w.description]}),w.icType&&i.jsxs("div",{children:["IC Type: ",w.icType]})]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:w.notes||"",readOnly:!0,onClick:te,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsxs("span",{children:["Designator: ",w.designator||"(empty)"]}),q&&i.jsx("button",{onClick:()=>{const ve=[...b,...p].filter(_t=>o.has(_t.id)&&_t.componentType===w.componentType),se=ve.length,ze=d.filter(_t=>r.has(_t.id)&&_t.type==="pad"&&_t.points.length>0&&_t.points[0].id!==void 0).map(_t=>{const qt=_t.points[0].id;if(qt===void 0)throw new Error("Unexpected undefined id");return{stroke:_t,nodeId:qt}}).sort((_t,qt)=>_t.nodeId-qt.nodeId),xe=ze.length>0?ze:d.filter(_t=>r.has(_t.id)&&_t.type==="via"&&_t.points.length>0&&_t.points[0].id!==void 0).map(_t=>{const qt=_t.points[0].id;if(qt===void 0)throw new Error("Unexpected undefined id");return{stroke:_t,nodeId:qt}}).sort((_t,qt)=>_t.nodeId-qt.nodeId),De=xe.length;if(De===0){console.warn("No vias or pads with Node IDs found in selection");return}const Ye=Math.floor(De/se);if(Ye===0){console.warn(`Not enough ${ze.length>0?"pads":"vias"} (${De}) for ${se} components`);return}const lt=ll(ve[0]);if(lt?.fixedPinCount!==!1){const _t=ve[0]?.pinCount??lt?.defaultPins??Ye;if(ve.every(ht=>(ht.pinCount??lt?.defaultPins)===_t)||console.warn("Selected components have different pin counts"),Ye!==_t){const ht=ze.length>0?"pads":"vias";console.warn(`Cannot change pin count for ${w.componentType}. Expected ${_t} ${ht} per component, but got ${Ye}. This component has a fixed pin count.`),Y({visible:!0,title:"Cannot Connect Components",message:`${w.componentType} has a fixed pin count of ${_t}. Please select exactly ${_t*se} ${ht} (${_t} per component).`});return}}const Wt=[...ve].sort((_t,qt)=>_t.id.localeCompare(qt.id)),ge=d.filter(_t=>r.has(_t.id)&&(_t.type==="via"||_t.type==="pad"));Wt.forEach((_t,qt)=>{const ht=qt*Ye,fn=ht+Ye,ln=xe.slice(ht,fn).map(Sn=>Sn.nodeId.toString()),cn=Yg(_t,ln,ge);_t.layer==="top"?M(Sn=>Sn.map(mn=>{if(mn.id===_t.id){const tt={...mn,pinCount:Ye,pinConnections:ln};if(cn&&(tt.pinPolarities=cn),mn.pinNames){const Bt=mn.pinNames||[];tt.pinNames=new Array(Ye).fill("").map((Gt,an)=>an<Bt.length?Bt[an]:"")}return tt}return mn})):T(Sn=>Sn.map(mn=>{if(mn.id===_t.id){const tt={...mn,pinCount:Ye,pinConnections:ln};if(cn&&(tt.pinPolarities=cn),mn.pinNames){const Bt=mn.pinNames||[];tt.pinNames=new Array(Ye).fill("").map((Gt,an)=>an<Bt.length?Bt[an]:"")}return tt}return mn}))});const Ot=ze.length>0?"pads":"vias";console.log(`Connected ${se} components of type ${w.componentType} to ${De} ${Ot} (${Ye} pins each)`)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap"},onMouseEnter:ve=>{ve.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:ve=>{ve.currentTarget.style.backgroundColor="#4CAF50"},children:"Connect"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:w.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:w.color})]}),i.jsxs("div",{children:["Size: ",w.size]}),i.jsxs("div",{children:["Pin Count: ",w.pinCount]}),w.componentType==="Resistor"&&i.jsxs(i.Fragment,{children:[w.resistance&&i.jsxs("div",{children:["Resistance: ",w.resistance]}),w.power&&i.jsxs("div",{children:["Power: ",w.power]}),w.tolerance&&i.jsxs("div",{children:["Tolerance: ",w.tolerance]})]}),w.componentType==="Capacitor"&&i.jsxs(i.Fragment,{children:[w.capacitance&&i.jsxs("div",{children:["Capacitance: ",w.capacitance]}),w.voltage&&i.jsxs("div",{children:["Voltage: ",w.voltage]}),w.dielectric&&i.jsxs("div",{children:["Dielectric: ",w.dielectric]}),w.tolerance&&i.jsxs("div",{children:["Tolerance: ",w.tolerance]})]}),w.componentType==="Electrolytic Capacitor"&&i.jsxs(i.Fragment,{children:[w.capacitance&&i.jsxs("div",{children:["Capacitance: ",w.capacitance]}),w.voltage&&i.jsxs("div",{children:["Voltage: ",w.voltage]}),w.tolerance&&i.jsxs("div",{children:["Tolerance: ",w.tolerance]}),w.polarized!==void 0&&i.jsxs("div",{children:["Polarized: ",w.polarized?"Yes":"No"]}),w.esr&&i.jsxs("div",{children:["ESR: ",w.esr]}),w.temperature&&i.jsxs("div",{children:["Temperature: ",w.temperature]})]}),w.pinConnections&&w.pinConnections.length>0&&(()=>{const ve=op(w),se=ll(w),ze=w?.pinNames,xe=se?.properties?.pinNames,Ye=xe&&xe.length>0;return i.jsxs("div",{style:{marginTop:"8px",marginBottom:"8px"},children:[i.jsx("div",{style:{marginBottom:"4px",fontWeight:600},children:"Pin Connections:"}),i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px",border:"1px solid #ddd"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Pin #"}),Ye&&i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Pin Name"}),ve&&i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Polarity"}),i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Node ID"})]})}),i.jsx("tbody",{children:w.pinConnections.map((lt,St)=>{const Wt=w.pinPolarities&&w.pinPolarities.length>St?w.pinPolarities[St]:"",ge=ze&&St<ze.length?ze[St]:"",Ot=xe&&St<xe.length?xe[St]:"",_t=Ot==="CHIP_DEPENDENT",qt=ge&&ge.trim()!==""?ge:_t?"":Ot;return i.jsxs("tr",{style:{backgroundColor:St%2===0?"#fff":"#f9f9f9"},children:[i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:St+1}),Ye&&i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd",fontSize:"9px",fontStyle:"italic",color:"#555"},children:qt||"-"}),ve&&i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd",textAlign:"center",fontFamily:"monospace",fontWeight:600,color:Wt==="+"?"#d32f2f":Wt==="-"?"#1976d2":"#999"},children:Wt||"-"}),i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:lt||"(not connected)"})]},St)})})]})]})})(),"manufacturer"in w&&w.manufacturer&&i.jsxs("div",{children:["Manufacturer: ",w.manufacturer]}),"partNumber"in w&&w.partNumber&&i.jsxs("div",{children:["Part Number: ",w.partNumber]}),w.componentType==="Diode"&&i.jsxs(i.Fragment,{children:[w.diodeType&&i.jsxs("div",{children:["Type: ",w.diodeType]}),w.voltage&&i.jsxs("div",{children:["Voltage: ",w.voltage]}),w.current&&i.jsxs("div",{children:["Current: ",w.current]}),w.ledColor&&i.jsxs("div",{children:["LED Color: ",w.ledColor]})]}),w.componentType==="Battery"&&i.jsxs(i.Fragment,{children:[w.voltage&&i.jsxs("div",{children:["Voltage: ",w.voltage]}),w.capacity&&i.jsxs("div",{children:["Capacity: ",w.capacity]}),w.chemistry&&i.jsxs("div",{children:["Chemistry: ",w.chemistry]})]}),w.componentType==="Fuse"&&i.jsxs(i.Fragment,{children:[w.current&&i.jsxs("div",{children:["Current: ",w.current]}),w.voltage&&i.jsxs("div",{children:["Voltage: ",w.voltage]}),w.fuseType&&i.jsxs("div",{children:["Type: ",w.fuseType]})]}),w.componentType==="FerriteBead"&&i.jsxs(i.Fragment,{children:[w.impedance&&i.jsxs("div",{children:["Impedance: ",w.impedance]}),w.current&&i.jsxs("div",{children:["Current: ",w.current]})]}),w.componentType==="Connector"&&i.jsxs(i.Fragment,{children:[w.connectorType&&i.jsxs("div",{children:["Type: ",w.connectorType]}),w.gender&&i.jsxs("div",{children:["Gender: ",w.gender]})]}),w.componentType==="Jumper"&&i.jsx(i.Fragment,{children:w.positions&&i.jsxs("div",{children:["Positions: ",w.positions]})}),w.componentType==="Relay"&&i.jsxs(i.Fragment,{children:[w.coilVoltage&&i.jsxs("div",{children:["Coil Voltage: ",w.coilVoltage]}),w.contactType&&i.jsxs("div",{children:["Contact Type: ",w.contactType]}),w.current&&i.jsxs("div",{children:["Current: ",w.current]})]}),w.componentType==="Inductor"&&i.jsxs(i.Fragment,{children:[w.inductance&&i.jsxs("div",{children:["Inductance: ",w.inductance]}),w.current&&i.jsxs("div",{children:["Current: ",w.current]}),w.resistance&&i.jsxs("div",{children:["DC Resistance: ",w.resistance]})]}),w.componentType==="Speaker"&&i.jsxs(i.Fragment,{children:[w.impedance&&i.jsxs("div",{children:["Impedance: ",w.impedance]}),w.power&&i.jsxs("div",{children:["Power: ",w.power]})]}),w.componentType==="Motor"&&i.jsxs(i.Fragment,{children:[w.motorType&&i.jsxs("div",{children:["Type: ",w.motorType]}),w.voltage&&i.jsxs("div",{children:["Voltage: ",w.voltage]}),w.current&&i.jsxs("div",{children:["Current: ",w.current]})]}),w.componentType==="PowerSupply"&&i.jsxs(i.Fragment,{children:[w.inputVoltage&&i.jsxs("div",{children:["Input Voltage: ",w.inputVoltage]}),w.outputVoltage&&i.jsxs("div",{children:["Output Voltage: ",w.outputVoltage]}),w.current&&i.jsxs("div",{children:["Current: ",w.current]})]}),w.componentType==="Transistor"&&i.jsxs(i.Fragment,{children:[w.transistorType&&i.jsxs("div",{children:["Type: ",w.transistorType]}),w.polarized!==void 0&&i.jsxs("div",{children:["Polarized: ",w.polarized?"Yes":"No"]}),w.voltage&&i.jsxs("div",{children:["Voltage: ",w.voltage]}),w.current&&i.jsxs("div",{children:["Current: ",w.current]})]}),w.componentType==="ResistorNetwork"&&i.jsxs(i.Fragment,{children:[w.resistance&&i.jsxs("div",{children:["Resistance: ",w.resistance]}),w.configuration&&i.jsxs("div",{children:["Configuration: ",w.configuration]})]}),w.componentType==="Thermistor"&&i.jsxs(i.Fragment,{children:[w.resistance&&i.jsxs("div",{children:["Resistance: ",w.resistance]}),w.thermistorType&&i.jsxs("div",{children:["Type: ",w.thermistorType]}),w.beta&&i.jsxs("div",{children:["Beta: ",w.beta]})]}),w.componentType==="Switch"&&i.jsxs(i.Fragment,{children:[w.switchType&&i.jsxs("div",{children:["Type: ",w.switchType]}),w.current&&i.jsxs("div",{children:["Current: ",w.current]}),w.voltage&&i.jsxs("div",{children:["Voltage: ",w.voltage]})]}),w.componentType==="Transformer"&&i.jsxs(i.Fragment,{children:[w.primaryVoltage&&i.jsxs("div",{children:["Primary Voltage: ",w.primaryVoltage]}),w.secondaryVoltage&&i.jsxs("div",{children:["Secondary Voltage: ",w.secondaryVoltage]}),w.power&&i.jsxs("div",{children:["Power: ",w.power]}),w.turns&&i.jsxs("div",{children:["Turns Ratio: ",w.turns]})]}),w.componentType==="TestPoint"&&i.jsx(i.Fragment,{children:w.signal&&i.jsxs("div",{children:["Signal: ",w.signal]})}),w.componentType==="IntegratedCircuit"&&i.jsxs(i.Fragment,{children:[w.datasheet&&(()=>{const ve=w.datasheet.trim(),se=ve.match(/^https?:\/\//)?ve:`https://${ve}`;return i.jsxs("div",{children:["Datasheet URL:"," ",i.jsx("a",{href:se,target:"_blank",rel:"noopener noreferrer",style:{color:"#0066cc",textDecoration:"underline"},children:ve})]})})(),w.datasheetFileName&&(()=>{const se=w.datasheetFileName.split("/").pop();return i.jsxs("div",{children:["Datasheet File:"," ",i.jsxs("span",{style:{color:"#666",fontStyle:"italic"},title:"Re-choose the datasheet file in Component Properties to open it",children:[se," (re-choose file to open)"]})]})})()]}),w.componentType==="VacuumTube"&&i.jsx(i.Fragment,{children:w.tubeType&&i.jsxs("div",{children:["Type: ",w.tubeType]})}),w.componentType==="VariableResistor"&&i.jsxs(i.Fragment,{children:[w.vrType&&i.jsxs("div",{children:["Type: ",w.vrType]}),w.resistance&&i.jsxs("div",{children:["Resistance: ",w.resistance]}),w.power&&i.jsxs("div",{children:["Power: ",w.power]}),w.taper&&i.jsxs("div",{children:["Taper: ",w.taper]})]}),w.componentType==="Crystal"&&i.jsxs(i.Fragment,{children:[w.frequency&&i.jsxs("div",{children:["Frequency: ",w.frequency]}),w.loadCapacitance&&i.jsxs("div",{children:["Load Capacitance: ",w.loadCapacitance]}),w.tolerance&&i.jsxs("div",{children:["Tolerance: ",w.tolerance]})]}),w.componentType==="GenericComponent"&&i.jsxs(i.Fragment,{children:[w.genericType&&i.jsxs("div",{children:["Type: ",w.genericType]}),w.voltage&&i.jsxs("div",{children:["Voltage: ",w.voltage," ",w.voltageUnit||"V"]}),w.current&&i.jsxs("div",{children:["Current: ",w.current," ",w.currentUnit||"A"]}),w.power&&i.jsxs("div",{children:["Power: ",w.power]}),w.frequency&&i.jsxs("div",{children:["Frequency: ",w.frequency]}),w.model&&i.jsxs("div",{children:["Model: ",w.model]})]}),i.jsx("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid #eee",fontSize:"10px",color:"#999"},children:i.jsxs("div",{children:["Position: x=",w.x.toFixed(2),", y=",w.y.toFixed(2)]})})]})]},w.id)})})(),r.size>0&&d.filter(q=>r.has(q.id)&&q.type==="via"&&q.points.length>0).map(q=>{const w=q.points[0],V=q.viaType||(w.id!==void 0?F(w.id,j):"Via");return i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:V})]}),ae&&i.jsx("button",{onClick:()=>{ae(q.id,w.x,w.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:H=>{H.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:H=>{H.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[w.id&&i.jsxs("div",{children:["Node ID: ",w.id]}),i.jsx("div",{children:"Layer: Top and Bottom"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:q.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:q.color})]}),i.jsxs("div",{children:["Size: ",q.size]}),i.jsxs("div",{children:["Position: x=",w.x.toFixed(2),", y=",w.y.toFixed(2)]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:q.notes||"",readOnly:!0,onClick:te,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},q.id)}),r.size>0&&d.filter(q=>r.has(q.id)&&q.type==="pad"&&q.points.length>0).map(q=>{const w=q.points[0],V=q.padType||(w.id!==void 0?P(w.id,j):"Pad");return i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:V})]}),ae&&i.jsx("button",{onClick:()=>{ae(q.id,w.x,w.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:H=>{H.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:H=>{H.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[w.id&&i.jsxs("div",{children:["Node ID: ",w.id]}),i.jsxs("div",{children:["Layer: ",q.layer]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:q.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:q.color})]}),i.jsxs("div",{children:["Size: ",q.size]}),i.jsxs("div",{children:["Position: x=",w.x.toFixed(2),", y=",w.y.toFixed(2)]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:q.notes||"",readOnly:!0,onClick:te,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},q.id)}),r.size>0&&d.filter(q=>r.has(q.id)&&q.type==="testPoint"&&q.points.length>0).map(q=>{const w=q.points[0],V=w.id!==void 0?k(w.id,j):"Test Point";return i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:V})]}),ae&&i.jsx("button",{onClick:()=>{ae(q.id,w.x,w.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:H=>{H.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:H=>{H.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[w.id&&i.jsxs("div",{children:["Node ID: ",w.id]}),i.jsxs("div",{children:["Layer: ",q.layer]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:q.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:q.color})]}),i.jsxs("div",{children:["Size: ",q.size]}),i.jsxs("div",{children:["Position: x=",w.x.toFixed(2),", y=",w.y.toFixed(2)]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:q.notes||"",readOnly:!0,onClick:te,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},q.id)}),r.size>0&&d.filter(q=>r.has(q.id)&&q.type==="trace").map(q=>{const w=q.points.length>0?q.points.reduce((H,ue)=>H+ue.x,0)/q.points.length:0,V=q.points.length>0?q.points.reduce((H,ue)=>H+ue.y,0)/q.points.length:0;return i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:q.type||"unknown"})]}),ae&&q.points.length>0&&i.jsx("button",{onClick:()=>{ae(q.id,w,V)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:H=>{H.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:H=>{H.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[q.points.length>0&&i.jsxs("div",{style:{marginTop:"8px",marginBottom:"8px"},children:[i.jsxs("div",{style:{marginBottom:"4px",fontWeight:600},children:["Points: ",q.points.length]}),i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px",border:"1px solid #ddd"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Point #"}),i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"x"}),i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"y"}),i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Node ID"})]})}),i.jsx("tbody",{children:q.points.map((H,ue)=>i.jsxs("tr",{style:{backgroundColor:ue%2===0?"#fff":"#f9f9f9"},children:[i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:ue}),i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:H.x.toFixed(2)}),i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:H.y.toFixed(2)}),i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:H.id||"(none)"})]},ue))})]})]}),i.jsxs("div",{style:{marginTop:"4px"},children:["Layer: ",q.layer]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:q.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:q.color})]}),i.jsxs("div",{children:["Size: ",q.size]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:q.notes||"",readOnly:!0,onClick:te,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},q.id)}),s.size>0&&v.filter(q=>s.has(q.id)).map(q=>{const w=j.find(V=>V.id===q.powerBusId);return i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:q.type||(w?`${w.name} Power Node`:"Power Node")})]}),E&&i.jsx("button",{onClick:()=>{E(q.id,q.x,q.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:V=>{V.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:V=>{V.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[i.jsxs("div",{children:["Node ID: ",q.pointId||"(not assigned)"]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:q.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:q.color})]}),i.jsxs("div",{children:["Size: ",q.size]}),i.jsxs("div",{children:["Layer: ",q.layer]}),i.jsxs("div",{children:["Power Bus: ",w?.name||q.powerBusId||"(unknown)"]}),i.jsxs("div",{children:["Position: x=",q.x.toFixed(2),", y=",q.y.toFixed(2)]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:q.notes||"",readOnly:!0,onClick:te,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},q.id)}),l.size>0&&m.filter(q=>l.has(q.id)).map(q=>i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:q.type||"Ground Node"})]}),U&&i.jsx("button",{onClick:()=>{U(q.id,q.x,q.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:w=>{w.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:w=>{w.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[i.jsxs("div",{children:["Node ID: ",q.pointId||"(not assigned)"]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:q.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:q.color})]}),i.jsxs("div",{children:["Size: ",q.size]}),i.jsxs("div",{children:["Position: x=",q.x.toFixed(2),", y=",q.y.toFixed(2)]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:q.notes||"",readOnly:!0,onClick:te,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},q.id))]})}),i.jsx("div",{onMouseDown:Ne,style:{position:"absolute",bottom:0,right:0,width:"20px",height:"20px",cursor:"nwse-resize",background:"linear-gradient(135deg, transparent 0%, transparent 40%, #ccc 40%, #ccc 45%, transparent 45%, transparent 55%, #ccc 55%, #ccc 60%, transparent 60%)",zIndex:10001},title:"Drag to resize"})]}),i.jsx(nm,{visible:W.visible,title:W.title,message:W.message,onClose:()=>Y({visible:!1,title:"",message:""})})]})},Yo=500,rw=({visible:n,selectedIds:r,selectedComponentIds:o,selectedPowerIds:s,selectedGroundIds:l,drawingStrokes:d,componentsTop:b,componentsBottom:p,powers:v,grounds:m,powerBuses:j,onClose:_,setComponentsTop:M,setComponentsBottom:T,setDrawingStrokes:F,setPowerSymbols:P,setGroundSymbols:k,determineViaType:y,determinePadType:ae,determineTestPointType:E,position:U,isDragging:ne,onDragStart:Z})=>{const[G,te]=I.useState(new Map),O=I.useRef(""),[W,Y]=I.useState(()=>{const se=localStorage.getItem("notesDialogSize");if(se)try{return JSON.parse(se)}catch{return{width:400,height:window.innerHeight*.8}}return{width:400,height:window.innerHeight*.8}}),[D,J]=I.useState(!1),[$,je]=I.useState({x:0,y:0,width:0,height:0}),ee=()=>[...Array.from(r).sort(),...Array.from(o).sort(),...Array.from(s).sort(),...Array.from(l).sort()].join(",");I.useEffect(()=>{if(!n)return;const se=ee();se!==O.current&&(O.current=se,te(ze=>{const xe=new Map;return[...b,...p].filter(De=>o.has(De.id)).forEach(De=>{const Ye=ze.get(De.id);xe.set(De.id,Ye!==void 0?Ye:De.notes||"")}),d.filter(De=>r.has(De.id)).forEach(De=>{const Ye=ze.get(De.id);xe.set(De.id,Ye!==void 0?Ye:De.notes||"")}),v.filter(De=>s.has(De.id)).forEach(De=>{const Ye=ze.get(De.id);xe.set(De.id,Ye!==void 0?Ye:De.notes||"")}),m.filter(De=>l.has(De.id)).forEach(De=>{const Ye=ze.get(De.id);xe.set(De.id,Ye!==void 0?Ye:De.notes||"")}),xe}))},[n,r,o,s,l,d,b,p,v,m]),I.useEffect(()=>{if(!D)return;const se=xe=>{const De=xe.clientX-$.x,Ye=xe.clientY-$.y,lt=Math.max(300,Math.min(window.innerWidth-20,$.width+De)),St=Math.max(200,Math.min(window.innerHeight-20,$.height+Ye)),Wt={width:lt,height:St};Y(Wt),localStorage.setItem("notesDialogSize",JSON.stringify(Wt))},ze=()=>{J(!1)};return document.addEventListener("mousemove",se),document.addEventListener("mouseup",ze),()=>{document.removeEventListener("mousemove",se),document.removeEventListener("mouseup",ze)}},[D,$]);const de=se=>{se.preventDefault(),se.stopPropagation(),J(!0),je({x:se.clientX,y:se.clientY,width:W.width,height:W.height})};if(!n)return null;const Ne=U?{position:"fixed",left:`${U.x}px`,top:`${U.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"300px",width:`${W.width}px`,height:`${W.height}px`,maxHeight:`${window.innerHeight-20}px`,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:ne?"grabbing":"default"}:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"flex-start",justifyContent:"flex-end",paddingRight:"20px",paddingTop:"80px",zIndex:1e4,pointerEvents:"none"},Ie={padding:"20px",overflow:"auto",flex:1},$e=d.filter(se=>r.has(se.id)).length,q=[...b,...p].filter(se=>o.has(se.id)).length,w=v.filter(se=>s.has(se.id)).length,V=m.filter(se=>l.has(se.id)).length,H=$e+q+w+V,ue=(se,ze)=>{const xe=ze.length>Yo?ze.substring(0,Yo):ze;te(De=>{const Ye=new Map(De);return Ye.set(se,xe),Ye})},ve=()=>{M(se=>se.map(ze=>{if(o.has(ze.id)&&G.has(ze.id)){const xe=G.get(ze.id)||"";return{...ze,notes:xe.trim()===""?void 0:xe.trim()}}return ze})),T(se=>se.map(ze=>{if(o.has(ze.id)&&G.has(ze.id)){const xe=G.get(ze.id)||"";return{...ze,notes:xe.trim()===""?void 0:xe.trim()}}return ze})),F(se=>se.map(ze=>{if(r.has(ze.id)&&G.has(ze.id)){const xe=G.get(ze.id)||"";return{...ze,notes:xe.trim()===""?null:xe.trim()}}return ze})),P(se=>se.map(ze=>{if(s.has(ze.id)&&G.has(ze.id)){const xe=G.get(ze.id)||"";return{...ze,notes:xe.trim()===""?null:xe.trim()}}return ze})),k(se=>se.map(ze=>{if(l.has(ze.id)&&G.has(ze.id)){const xe=G.get(ze.id)||"";return{...ze,notes:xe.trim()===""?null:xe.trim()}}return ze}))};return i.jsx("div",{style:Ne,children:i.jsxs("div",{style:{position:"relative",width:"100%",height:"100%",display:"flex",flexDirection:"column",...U?{}:{backgroundColor:"#fff",borderRadius:8,minWidth:"300px",width:`${W.width}px`,height:`${W.height}px`,maxHeight:`${window.innerHeight-20}px`,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",pointerEvents:"auto"}},children:[i.jsxs("div",{onMouseDown:se=>{const ze=se.target;ze.tagName==="BUTTON"||ze.closest("button")||U&&Z(se)},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:ne?"grabbing":U?"grab":"default",userSelect:"none",flexShrink:0},children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Notes (N)"}),i.jsx("button",{onClick:_,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsx("div",{style:Ie,children:i.jsxs("div",{style:{margin:0,padding:0,backgroundColor:"#f5f5f5",borderRadius:4,fontSize:"12px",fontFamily:"monospace",maxHeight:"calc(80vh - 100px)",overflow:"auto",color:"#000"},children:[i.jsx("div",{style:{padding:"12px 16px",backgroundColor:H>0?"#e8e8e8":"#fff3cd",borderBottom:"2px solid #ccc",fontSize:"13px",fontWeight:600,color:H>0?"#333":"#856404",marginBottom:"8px"},children:H>0?`${H} Object${H!==1?"s":""} Selected`:"Zero Objects Selected"}),H===0?i.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"No objects selected. Select one or more objects to add or edit notes."}):i.jsxs(i.Fragment,{children:[[...b,...p].filter(se=>o.has(se.id)).map(se=>{const ze=G.get(se.id)||"",xe=ze.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsxs("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:[Wl(se.componentType),se.designator&&se.designator.trim()?` (${se.designator.trim()})`:""]})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("textarea",{value:ze,onChange:De=>ue(se.id,De.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Yo,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:xe>=Yo?"#d32f2f":"#666",textAlign:"right"},children:[xe," / ",Yo]})]})]},se.id)}),d.filter(se=>r.has(se.id)&&se.type==="via"&&se.points.length>0).map(se=>{const ze=se.points[0],xe=se.viaType||(ze.id!==void 0?y(ze.id,j):"Via"),De=G.get(se.id)||"",Ye=De.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:xe})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:ze.id&&i.jsxs("div",{children:["Node ID: ",ze.id]})}),i.jsx("textarea",{value:De,onChange:lt=>ue(se.id,lt.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Yo,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Ye>=Yo?"#d32f2f":"#666",textAlign:"right"},children:[Ye," / ",Yo]})]})]},se.id)}),d.filter(se=>r.has(se.id)&&se.type==="pad"&&se.points.length>0).map(se=>{const ze=se.points[0],xe=se.padType||(ze.id!==void 0?ae(ze.id,j):"Pad"),De=G.get(se.id)||"",Ye=De.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:xe})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:ze.id&&i.jsxs("div",{children:["Node ID: ",ze.id]})}),i.jsx("textarea",{value:De,onChange:lt=>ue(se.id,lt.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Yo,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Ye>=Yo?"#d32f2f":"#666",textAlign:"right"},children:[Ye," / ",Yo]})]})]},se.id)}),d.filter(se=>r.has(se.id)&&se.type==="testPoint"&&se.points.length>0).map(se=>{const ze=se.points[0],xe=ze.id!==void 0?E(ze.id,j):"Test Point",De=G.get(se.id)||"",Ye=De.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:xe})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:ze.id&&i.jsxs("div",{children:["Node ID: ",ze.id]})}),i.jsx("textarea",{value:De,onChange:lt=>ue(se.id,lt.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Yo,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Ye>=Yo?"#d32f2f":"#666",textAlign:"right"},children:[Ye," / ",Yo]})]})]},se.id)}),d.filter(se=>r.has(se.id)&&se.type==="trace").map(se=>{const ze=G.get(se.id)||"",xe=ze.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:se.type||"unknown"})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("textarea",{value:ze,onChange:De=>ue(se.id,De.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Yo,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:xe>=Yo?"#d32f2f":"#666",textAlign:"right"},children:[xe," / ",Yo]})]})]},se.id)}),v.filter(se=>s.has(se.id)).map(se=>{const ze=j.find(lt=>lt.id===se.powerBusId),xe=se.type||(ze?`${ze.name} Power Node`:"Power Node"),De=G.get(se.id)||"",Ye=De.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:xe})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:i.jsxs("div",{children:["Node ID: ",se.pointId||"(not assigned)"]})}),i.jsx("textarea",{value:De,onChange:lt=>ue(se.id,lt.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Yo,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Ye>=Yo?"#d32f2f":"#666",textAlign:"right"},children:[Ye," / ",Yo]})]})]},se.id)}),m.filter(se=>l.has(se.id)).map(se=>{const ze=se.type||"Ground Node",xe=G.get(se.id)||"",De=xe.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:ze})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:i.jsxs("div",{children:["Node ID: ",se.pointId||"(not assigned)"]})}),i.jsx("textarea",{value:xe,onChange:Ye=>ue(se.id,Ye.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Yo,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:De>=Yo?"#d32f2f":"#666",textAlign:"right"},children:[De," / ",Yo]})]})]},se.id)}),i.jsxs("div",{style:{marginTop:"20px",padding:"12px",display:"flex",justifyContent:"flex-end",gap:"8px",borderTop:"1px solid #ddd"},children:[i.jsx("button",{onClick:_,style:{padding:"8px 16px",fontSize:"12px",backgroundColor:"#757575",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500},onMouseEnter:se=>{se.currentTarget.style.backgroundColor="#616161"},onMouseLeave:se=>{se.currentTarget.style.backgroundColor="#757575"},children:"Close"}),i.jsx("button",{onClick:ve,style:{padding:"8px 16px",fontSize:"12px",backgroundColor:"#2196F3",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500},onMouseEnter:se=>{se.currentTarget.style.backgroundColor="#1976D2"},onMouseLeave:se=>{se.currentTarget.style.backgroundColor="#2196F3"},children:"Save"})]})]})]})}),i.jsx("div",{onMouseDown:de,style:{position:"absolute",bottom:0,right:0,width:"20px",height:"20px",cursor:"nwse-resize",background:"linear-gradient(135deg, transparent 0%, transparent 40%, #ccc 40%, #ccc 45%, transparent 45%, transparent 55%, #ccc 55%, #ccc 60%, transparent 60%)",zIndex:10001},title:"Drag to resize"})]})})},ow=({visible:n,projectNotes:r,setProjectNotes:o,projectMetadata:s,setProjectMetadata:l,onClose:d,position:b,isDragging:p,onDragStart:v})=>{const[m,j]=I.useState([]),[_,M]=I.useState({productName:"",productVersion:"",manufacturer:"",date:new Date().toISOString().split("T")[0]}),[T,F]=I.useState(null),[P,k]=I.useState(null),y=I.useRef(new Map),[ae,E]=I.useState({width:Math.min(window.innerWidth*.85,1400),height:window.innerHeight*.7}),[U,ne]=I.useState(!1),[Z,G]=I.useState({x:0,y:0,width:0,height:0}),[te,O]=I.useState("");I.useEffect(()=>{n&&(j([...r]),M({...s}),(!s.date||s.date.trim()==="")&&M(w=>({...w,date:new Date().toISOString().split("T")[0]})),F(null),k(null),O(""))},[n,r,s]);const W=te.trim()===""?m:m.filter(w=>{const V=te.toLowerCase(),H=w.name.toLowerCase().includes(V),ue=w.value.toLowerCase().includes(V);return H||ue});I.useEffect(()=>{if(!U)return;const w=H=>{const ue=H.clientX-Z.x,ve=H.clientY-Z.y,se=Math.max(400,Math.min(window.innerWidth-20,Z.width+ue)),ze=Math.max(300,Math.min(window.innerHeight-20,Z.height+ve));E({width:se,height:ze})},V=()=>{ne(!1)};return document.addEventListener("mousemove",w),document.addEventListener("mouseup",V),()=>{document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",V)}},[U,Z]);const Y=w=>{w.preventDefault(),w.stopPropagation(),ne(!0),G({x:w.clientX,y:w.clientY,width:ae.width,height:ae.height})};if(!n)return null;const D=()=>{const w={name:"",value:"",checked:!1};j([...m,w]),F(m.length),k("name")},J=w=>{const V=m.filter((H,ue)=>ue!==w);j(V),T===w?(F(null),k(null)):T!==null&&T>w&&F(T-1)},$=()=>{const w=m.filter(V=>V.name.trim()!==""||V.value.trim()!=="");o(w),l(_),d()},je=()=>{j([...r]),M({...s}),F(null),k(null),d()},ee=(w,V,H)=>{const ue=[...m];ue[w]={...ue[w],[V]:H},j(ue)},de=(w,V)=>{const H=[...m];H[w]={...H[w],checked:V},j(H)},Ne=(w,V,H)=>{w.stopPropagation();const ue=w.currentTarget,ve=ue.selectionStart,se=ue.value.length,ze=ue.selectionStart!==ue.selectionEnd;if(!(w.key==="Enter"&&w.altKey)){if(w.key==="ArrowRight"&&!w.ctrlKey&&!w.shiftKey&&!w.altKey){if(ve===se&&!ze&&H==="name"){w.preventDefault();const xe=`${V}-value`,De=y.current.get(xe);De&&(De.focus(),De.setSelectionRange(0,0))}return}if(w.key==="ArrowLeft"&&!w.ctrlKey&&!w.shiftKey&&!w.altKey){if(ve===0&&!ze&&H==="value"){w.preventDefault();const xe=`${V}-name`,De=y.current.get(xe);De&&(De.focus(),De.setSelectionRange(De.value.length,De.value.length))}return}if(w.key==="ArrowDown"&&!w.ctrlKey&&!w.shiftKey&&!w.altKey){if(w.preventDefault(),V<m.length-1){const xe=`${V+1}-${H}`,De=y.current.get(xe);if(De){De.focus();const Ye=Math.min(ve,De.value.length);De.setSelectionRange(Ye,Ye)}}else{const xe=m.length;D(),setTimeout(()=>{const De=`${xe}-${H}`,Ye=y.current.get(De);Ye&&(Ye.focus(),Ye.setSelectionRange(0,0))},0)}return}if(w.key==="ArrowUp"&&!w.ctrlKey&&!w.shiftKey&&!w.altKey){if(w.preventDefault(),V>0){const xe=`${V-1}-${H}`,De=y.current.get(xe);if(De){De.focus();const Ye=Math.min(ve,De.value.length);De.setSelectionRange(Ye,Ye)}}return}if(w.key==="Enter"&&!w.altKey&&!w.shiftKey){if(w.preventDefault(),H==="name"){const xe=`${V}-value`,De=y.current.get(xe);De&&(De.focus(),De.setSelectionRange(0,0))}else if(H==="value")if(V<m.length-1){const xe=`${V+1}-name`,De=y.current.get(xe);De&&(De.focus(),De.setSelectionRange(0,0))}else{const xe=m.length;D(),setTimeout(()=>{const De=`${xe}-name`,Ye=y.current.get(De);Ye&&(Ye.focus(),Ye.setSelectionRange(0,0))},0)}return}if(w.key==="Tab"&&!w.shiftKey){if(w.preventDefault(),H==="name"){const xe=`${V}-value`,De=y.current.get(xe);De&&(De.focus(),De.select())}else if(H==="value")if(V<m.length-1){const xe=`${V+1}-name`,De=y.current.get(xe);De&&(De.focus(),De.select())}else{const xe=m.length;D(),setTimeout(()=>{const De=`${xe}-name`,Ye=y.current.get(De);Ye&&Ye.focus()},0)}return}if(w.key==="Tab"&&w.shiftKey){if(w.preventDefault(),H==="value"){const xe=`${V}-name`,De=y.current.get(xe);De&&(De.focus(),De.select())}else if(H==="name"&&V>0){const xe=`${V-1}-value`,De=y.current.get(xe);De&&(De.focus(),De.select())}return}}},Ie=(w,V)=>{F(w),k(V)},$e=()=>{},q={position:"fixed",top:b?.y??100,left:b?.x??(window.innerWidth-ae.width)/2,width:`${ae.width}px`,height:`${ae.height}px`,backgroundColor:"#fff",borderRadius:8,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:p?"grabbing":"default",overflow:"hidden"};return i.jsxs("div",{style:q,children:[i.jsxs("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e0e0",background:"#888",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"move",userSelect:"none"},onMouseDown:v,children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Project Notes / TODO List (L)"}),i.jsx("button",{onClick:je,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:"0 4px",lineHeight:1},title:"Close",children:""})]}),i.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e0e0e0",backgroundColor:"#f9f9f9",display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr",gap:"12px",alignItems:"center",flexShrink:0},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[i.jsx("label",{style:{fontSize:"11px",fontWeight:600,color:"#333"},children:"Product Name:"}),i.jsx("input",{type:"text",value:_.productName,onChange:w=>M({..._,productName:w.target.value}),placeholder:"Enter product name",style:{padding:"6px 8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"12px",color:"#000",background:"#fff",outline:"none"}})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[i.jsx("label",{style:{fontSize:"11px",fontWeight:600,color:"#333"},children:"Product Version:"}),i.jsx("input",{type:"text",value:_.productVersion,onChange:w=>M({..._,productVersion:w.target.value}),placeholder:"Enter version",style:{padding:"6px 8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"12px",color:"#000",background:"#fff",outline:"none"}})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[i.jsx("label",{style:{fontSize:"11px",fontWeight:600,color:"#333"},children:"Manufacturer:"}),i.jsx("input",{type:"text",value:_.manufacturer,onChange:w=>M({..._,manufacturer:w.target.value}),placeholder:"Enter manufacturer",style:{padding:"6px 8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"12px",color:"#000",background:"#fff",outline:"none"}})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[i.jsx("label",{style:{fontSize:"11px",fontWeight:600,color:"#333"},children:"Date:"}),i.jsx("input",{type:"date",value:_.date,onChange:w=>M({..._,date:w.target.value}),style:{padding:"6px 8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"12px",color:"#000",background:"#fff",outline:"none"}})]})]}),i.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e0e0e0",backgroundColor:"#f5f5f5",display:"flex",gap:"8px",alignItems:"center",flexShrink:0},children:[i.jsx("input",{type:"text",value:te,onChange:w=>O(w.target.value),onKeyDown:w=>{w.key==="Enter"&&w.preventDefault()},placeholder:"Search notes...",style:{flex:1,padding:"6px 12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"13px",color:"#000",background:"#fff",outline:"none"}}),i.jsx("button",{onClick:()=>{te.trim()!==""&&O("")},style:{padding:"6px 16px",background:te.trim()!==""?"#4CAF50":"#888",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"13px",fontWeight:500,whiteSpace:"nowrap"},children:te.trim()!==""?"Clear":"Search"})]}),i.jsxs("div",{className:"project-notes-content",style:{padding:0,flex:1,overflowY:"auto",overflowX:"hidden",display:"flex",flexDirection:"column",minHeight:0,scrollbarWidth:"thin",scrollbarColor:"#888 #f0f0f0"},children:[i.jsxs("div",{style:{border:"none",borderTop:"1px solid #ccc",borderRadius:0,overflow:"visible",marginBottom:"16px",backgroundColor:"#e0e0e0",flexShrink:0},children:[i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"40px 1fr 3fr auto",backgroundColor:"#e0e0e0",borderBottom:"1px solid #ccc",position:"sticky",top:0,zIndex:10},children:[i.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",display:"flex",alignItems:"center",justifyContent:"center",color:"#000"},children:i.jsx("label",{className:"radio-label",style:{margin:0,cursor:"default"},children:i.jsx("input",{type:"checkbox",disabled:!0,style:{opacity:.5}})})}),i.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",color:"#000"},children:"Item"}),i.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",color:"#000"},children:"Notes"}),i.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",color:"#000"}})]}),i.jsx("div",{children:m.length===0?i.jsx("div",{style:{padding:"24px",textAlign:"center",color:"#999",fontSize:"13px"},children:'No notes. Click "Add Note" to create one.'}):W.length===0?i.jsxs("div",{style:{padding:"24px",textAlign:"center",color:"#999",fontSize:"13px"},children:['No matches found for "',te,'".']}):W.map(w=>{const V=m.findIndex(H=>H===w);return i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"40px 1fr 3fr auto",borderBottom:"1px solid #ccc",backgroundColor:"#fff"},children:[i.jsx("div",{style:{padding:"8px 12px",borderRight:"1px solid #ccc",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("label",{className:"radio-label",style:{margin:0,cursor:"pointer"},children:i.jsx("input",{type:"checkbox",checked:w.checked||!1,onChange:H=>de(V,H.target.checked)})})}),i.jsx("div",{style:{padding:"4px",borderRight:"1px solid #ccc"},children:i.jsx("textarea",{ref:H=>{H?y.current.set(`${V}-name`,H):y.current.delete(`${V}-name`)},value:w.name,onChange:H=>ee(V,"name",H.target.value),onFocus:()=>Ie(V,"name"),onBlur:$e,onKeyDown:H=>Ne(H,V,"name"),placeholder:"Item name...",rows:1,style:{width:"100%",padding:"4px 6px",border:T===V&&P==="name"?"2px solid #0b5fff":"1px solid transparent",borderRadius:3,fontSize:"12px",backgroundColor:"#fff",color:"#000",fontFamily:"inherit",resize:"none",minHeight:"24px",lineHeight:"1.4",overflow:"hidden",outline:"none",boxSizing:"border-box"},onInput:H=>{const ue=H.target;ue.style.height="auto",ue.style.height=`${ue.scrollHeight}px`}})}),i.jsx("div",{style:{padding:"4px",borderRight:"1px solid #ccc"},children:i.jsx("textarea",{ref:H=>{H?y.current.set(`${V}-value`,H):y.current.delete(`${V}-value`)},value:w.value,onChange:H=>ee(V,"value",H.target.value),onFocus:()=>Ie(V,"value"),onBlur:$e,onKeyDown:H=>Ne(H,V,"value"),placeholder:"Notes...",rows:1,style:{width:"100%",padding:"4px 6px",border:T===V&&P==="value"?"2px solid #0b5fff":"1px solid transparent",borderRadius:3,fontSize:"12px",backgroundColor:"#fff",color:"#000",fontFamily:"inherit",resize:"none",minHeight:"24px",lineHeight:"1.4",overflow:"hidden",outline:"none",boxSizing:"border-box"},onInput:H=>{const ue=H.target;ue.style.height="auto",ue.style.height=`${ue.scrollHeight}px`}})}),i.jsx("div",{style:{padding:"8px 12px",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("button",{onClick:()=>J(V),style:{background:"#f44336",color:"#fff",border:"none",borderRadius:3,padding:"4px 8px",cursor:"pointer",fontSize:"11px"},title:"Delete note",children:"Delete"})})]},V)})})]}),i.jsx("div",{style:{padding:"16px",flexShrink:0},children:i.jsx("button",{onClick:D,style:{background:"#888",color:"#fff",border:"none",borderRadius:4,padding:"8px 16px",cursor:"pointer",fontSize:"12px",fontWeight:500,alignSelf:"flex-start"},children:"+ Add Note"})})]}),i.jsxs("div",{style:{padding:"12px 16px",borderTop:"1px solid #ddd",display:"flex",justifyContent:"flex-end",gap:"8px",flexShrink:0},children:[i.jsx("button",{onClick:je,style:{background:"#f5f5f5",color:"#000",border:"1px solid #ddd",borderRadius:4,padding:"6px 16px",cursor:"pointer",fontSize:"12px"},children:"Cancel"}),i.jsx("button",{onClick:$,style:{background:"#0b5fff",color:"#fff",border:"none",borderRadius:4,padding:"6px 16px",cursor:"pointer",fontSize:"12px",fontWeight:500},children:"Save"})]}),i.jsx("div",{onMouseDown:Y,style:{position:"absolute",bottom:0,right:0,width:"20px",height:"20px",cursor:"nwse-resize",background:"linear-gradient(135deg, transparent 0%, transparent 40%, #ccc 40%, #ccc 45%, transparent 45%, transparent 55%, #ccc 55%, #ccc 60%, transparent 60%)",zIndex:10001},title:"Drag to resize"})]})},aw=({visible:n,drawingStrokes:r,onClose:o,onFindTestPoint:s,position:l,isDragging:d,onDragStart:b,determineTestPointType:p,powerBuses:v})=>{const[m,j]=I.useState("");if(I.useEffect(()=>{n&&j("")},[n]),!n)return null;const _=r.filter(P=>P.type==="testPoint"&&P.points.length>0),M=m.trim()===""?_:_.filter(P=>(P.notes||"").toLowerCase().includes(m.toLowerCase())),T=l?{position:"fixed",left:`${l.x}px`,top:`${l.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"150px",maxWidth:"500px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:d?"grabbing":"default"}:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},F={padding:"20px",overflow:"auto",flex:1};return i.jsxs("div",{style:T,children:[i.jsxs("div",{onMouseDown:P=>{const k=P.target;k.tagName==="BUTTON"||k.closest("button")||l&&b(P)},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:d?"grabbing":l?"grab":"default",userSelect:"none",flexShrink:0},children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Test Points"}),i.jsx("button",{onClick:o,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e0e0e0",backgroundColor:"#f5f5f5",display:"flex",gap:"8px",alignItems:"center",flexShrink:0},children:[i.jsx("input",{type:"text",value:m,onChange:P=>j(P.target.value),onKeyDown:P=>{P.key==="Enter"&&P.preventDefault()},placeholder:"Search test point notes...",style:{flex:1,padding:"6px 12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"13px",color:"#000",background:"#fff",outline:"none"}}),i.jsx("button",{onClick:()=>{m.trim()!==""&&j("")},style:{padding:"6px 16px",background:m.trim()!==""?"#4CAF50":"#888",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"13px",fontWeight:500,whiteSpace:"nowrap"},children:m.trim()!==""?"Clear":"Search"})]}),i.jsx("div",{style:F,children:_.length===0?i.jsx("div",{style:{padding:"24px",textAlign:"center",color:"#999",fontSize:"13px"},children:"No test points found."}):M.length===0?i.jsxs("div",{style:{padding:"24px",textAlign:"center",color:"#999",fontSize:"13px"},children:['No matches found for "',m,'".']}):i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:M.map(P=>{const k=P.points[0],y=k.id!==void 0?p(k.id,v):"Test Point",ae=y.includes("(")?y.substring(0,y.indexOf("(")).trim():y;return i.jsxs("div",{style:{padding:"12px",backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{flexShrink:0},children:i.jsx("path",{d:"M 12 5 L 19 12 L 12 19 L 5 12 Z",fill:"#FFD700",stroke:"#000",strokeWidth:"1.5"})}),i.jsx("div",{style:{fontSize:"12px",fontWeight:500,color:"#000"},children:ae})]}),s&&i.jsx("button",{onClick:()=>{s(P.id,k.x,k.y)},style:{padding:"4px 12px",fontSize:"11px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap"},onMouseEnter:E=>{E.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:E=>{E.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),P.notes&&P.notes.trim()!==""?i.jsx("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px",padding:"8px",backgroundColor:"#f5f5f5",borderRadius:"3px",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:P.notes}):i.jsx("div",{style:{fontSize:"11px",color:"#999",fontStyle:"italic",marginTop:"8px"},children:"No notes"}),i.jsxs("div",{style:{fontSize:"10px",color:"#999",marginTop:"8px"},children:["Layer: ",P.layer," | Position: (",k.x.toFixed(2),", ",k.y.toFixed(2),")"]})]},P.id)})})})]})},sw=({visible:n,dimensions:r,onSave:o,onClose:s})=>{const[l,d]=I.useState(""),[b,p]=I.useState(""),[v,m]=I.useState("inches");I.useEffect(()=>{n&&r?(d(r.width.toString()),p(r.height.toString()),m(r.unit)):n&&(d(""),p(""),m("inches"))},[n,r]);const j=()=>{const M=parseFloat(l),T=parseFloat(b);if(isNaN(M)||M<=0){alert("Please enter a valid width greater than 0");return}if(isNaN(T)||T<=0){alert("Please enter a valid height greater than 0");return}o({width:M,height:T,unit:v}),s()},_=()=>{s()};return n?i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:M=>{M.target===M.currentTarget&&_()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"320px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #444"},onClick:M=>M.stopPropagation(),children:[i.jsx("h3",{style:{margin:"0 0 20px 0",color:"#fff",fontSize:"18px",fontWeight:600},children:"Board Dimensions"}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#ddd",fontSize:"14px"},children:"Width"}),i.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[i.jsx("input",{type:"number",step:"0.001",min:"0.001",value:l,onChange:M=>d(M.target.value),style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px"},placeholder:"0.000"}),i.jsxs("select",{value:v,onChange:M=>m(M.target.value),style:{padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px",cursor:"pointer"},children:[i.jsx("option",{value:"inches",children:"inches"}),i.jsx("option",{value:"mm",children:"mm"})]})]})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#ddd",fontSize:"14px"},children:"Height"}),i.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[i.jsx("input",{type:"number",step:"0.001",min:"0.001",value:b,onChange:M=>p(M.target.value),style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px"},placeholder:"0.000"}),i.jsxs("select",{value:v,onChange:M=>m(M.target.value),style:{padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px",cursor:"pointer"},children:[i.jsx("option",{value:"inches",children:"inches"}),i.jsx("option",{value:"mm",children:"mm"})]})]})]}),i.jsx("div",{style:{marginBottom:"12px",padding:"10px",background:"#1f1f24",borderRadius:4,fontSize:"12px",color:"#bbb"},children:"This information will be used to convert pixel coordinates to real-world measurements."}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[i.jsx("button",{onClick:_,style:{padding:"8px 16px",background:"#444",color:"#fff",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px"},children:"Cancel"}),i.jsx("button",{onClick:j,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Save"})]})]})}):null},lw=({visible:n,onClose:r,topImage:o,bottomImage:s,selectedImageForTransform:l,setSelectedImageForTransform:d,transformMode:b,setTransformMode:p,updateImageTransform:v,resetImageTransform:m,setCurrentTool:j,isGrayscale:_,setIsGrayscale:M,areImagesLocked:T})=>{const[F,P]=I.useState(null),[k,y]=I.useState(!1),ae=I.useRef({x:0,y:0}),E=I.useRef(null);I.useEffect(()=>{n&&F===null&&P({x:window.innerWidth-320-20,y:80})},[n,F]),I.useEffect(()=>{n||P(null)},[n]);const U=I.useCallback(H=>{if(E.current){const ue=E.current.getBoundingClientRect();ae.current={x:H.clientX-ue.left,y:H.clientY-ue.top},y(!0)}},[]);if(I.useEffect(()=>{if(!k)return;const H=ve=>{const se=ve.clientX-ae.current.x,ze=ve.clientY-ae.current.y,xe=E.current?.offsetWidth||320,De=E.current?.offsetHeight||600,Ye=Math.max(0,Math.min(se,window.innerWidth-xe)),lt=Math.max(0,Math.min(ze,window.innerHeight-De));P({x:Ye,y:lt})},ue=()=>{y(!1)};return document.addEventListener("mousemove",H),document.addEventListener("mouseup",ue),()=>{document.removeEventListener("mousemove",H),document.removeEventListener("mouseup",ue)}},[k]),!n)return null;const ne=o!==null,Z=s!==null,G=ne||Z,te=ne&&Z,O=l||(ne?"top":Z?"bottom":null),W=()=>O==="top"&&o?o.brightness??100:O==="bottom"&&s?s.brightness??100:O==="both"&&o?o.brightness??100:100,Y=()=>O==="top"&&o?o.contrast??100:O==="bottom"&&s?s.contrast??100:O==="both"&&o?o.contrast??100:100,D=W(),J=Y(),$=!G||T,je=()=>{if(!(!O||$))if(O==="both"){const H=!o?.flipX;v("both",{flipX:H})}else{const H=O==="top"?o?.flipX||!1:s?.flipX||!1;v(O,{flipX:!H})}},ee=()=>{if(!(!O||$))if(O==="both"){const H=!o?.flipY;v("both",{flipY:H})}else{const H=O==="top"?o?.flipY||!1:s?.flipY||!1;v(O,{flipY:!H})}},de=H=>{$||(O&&d(O),p(H),j("transform"))},Ne=H=>{!O||$||v(O,{brightness:H})},Ie=H=>{!O||$||v(O,{contrast:H})},$e=()=>{$||(O&&d(O),j("transform"),M(!_))},q=()=>{$||(j("transform"),m())},w=(H,ue=!1)=>({display:"block",width:"100%",textAlign:"left",padding:"8px 12px",color:H?"#666":"#f2f2f2",background:ue?"#3a3a42":"transparent",border:"none",borderRadius:4,cursor:H?"not-allowed":"pointer",fontSize:"13px",transition:"background 0.15s"}),V=(H,ue)=>({display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",color:H?"#666":"#f2f2f2",cursor:H?"not-allowed":"pointer",fontSize:"13px",background:ue?"#3a3a42":"transparent",borderRadius:4,transition:"background 0.15s"});return i.jsxs("div",{ref:E,style:{position:"fixed",top:F?.y??80,left:F?.x??window.innerWidth-340,backgroundColor:"#2b2b31",borderRadius:8,minWidth:"320px",maxWidth:"400px",maxHeight:"calc(100vh - 100px)",overflowY:"auto",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24",zIndex:10001},children:[i.jsxs("div",{onMouseDown:U,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 16px",background:"linear-gradient(to bottom, #3a3a42, #2b2b31)",borderTopLeftRadius:8,borderTopRightRadius:8,borderBottom:"1px solid #1f1f24",cursor:k?"grabbing":"grab",userSelect:"none"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("span",{style:{color:"#888",fontSize:"14px"},children:""}),i.jsx("h2",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#f2f2f2"},children:"Transform Images"})]}),i.jsx("button",{onClick:r,style:{background:"transparent",border:"none",color:"#888",fontSize:"16px",cursor:"pointer",padding:"2px 6px",lineHeight:1,borderRadius:4},onMouseEnter:H=>{H.currentTarget.style.background="#444",H.currentTarget.style.color="#fff"},onMouseLeave:H=>{H.currentTarget.style.background="transparent",H.currentTarget.style.color="#888"},children:""})]}),i.jsxs("div",{style:{padding:"16px"},children:[i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("div",{style:{fontSize:"12px",color:"#888",marginBottom:"8px",fontWeight:500},children:"Apply to:"}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[i.jsxs("label",{style:V(!ne,O==="top"),children:[i.jsx("input",{type:"radio",name:"imageSelection",checked:O==="top",onChange:()=>d("top"),disabled:!ne,style:{accentColor:"#6b9fff"}}),"Top Image",!ne&&i.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(not loaded)"})]}),i.jsxs("label",{style:V(!Z,O==="bottom"),children:[i.jsx("input",{type:"radio",name:"imageSelection",checked:O==="bottom",onChange:()=>d("bottom"),disabled:!Z,style:{accentColor:"#6b9fff"}}),"Bottom Image",!Z&&i.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(not loaded)"})]}),i.jsxs("label",{style:V(!te,O==="both"),children:[i.jsx("input",{type:"radio",name:"imageSelection",checked:O==="both",onChange:()=>d("both"),disabled:!te,style:{accentColor:"#6b9fff"}}),"Both Images",!te&&i.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(need both)"})]})]})]}),i.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),i.jsxs("div",{style:{marginBottom:"12px"},children:[i.jsx("button",{onClick:je,disabled:$,style:w($),onMouseEnter:H=>!$&&(H.currentTarget.style.background="#3a3a42"),onMouseLeave:H=>H.currentTarget.style.background="transparent",children:"Horizontal Flip"}),i.jsx("button",{onClick:ee,disabled:$,style:w($),onMouseEnter:H=>!$&&(H.currentTarget.style.background="#3a3a42"),onMouseLeave:H=>H.currentTarget.style.background="transparent",children:"Vertical Flip"})]}),i.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),i.jsx("div",{style:{marginBottom:"12px"},children:["nudge","scale","rotate","slant","keystone"].map(H=>i.jsxs("button",{onClick:()=>de(H),disabled:$,style:w($,b===H),onMouseEnter:ue=>!$&&b!==H&&(ue.currentTarget.style.background="#3a3a42"),onMouseLeave:ue=>b!==H&&(ue.currentTarget.style.background="transparent"),children:[b===H?" ":"","Mode: ",H.charAt(0).toUpperCase()+H.slice(1)]},H))}),i.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[i.jsx("label",{style:{color:"#f2f2f2",fontSize:"13px",fontWeight:500},children:"Brightness"}),i.jsxs("span",{style:{color:"#888",fontSize:"12px",minWidth:"45px",textAlign:"right"},children:[D,"%"]})]}),i.jsx("input",{type:"range",min:"0",max:"200",step:"1",value:D,onChange:H=>Ne(parseInt(H.target.value,10)),disabled:$,style:{width:"100%",cursor:$?"not-allowed":"pointer",accentColor:"#6b9fff"}})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[i.jsx("label",{style:{color:"#f2f2f2",fontSize:"13px",fontWeight:500},children:"Contrast"}),i.jsxs("span",{style:{color:"#888",fontSize:"12px",minWidth:"45px",textAlign:"right"},children:[J,"%"]})]}),i.jsx("input",{type:"range",min:"0",max:"200",step:"1",value:J,onChange:H=>Ie(parseInt(H.target.value,10)),disabled:$,style:{width:"100%",cursor:$?"not-allowed":"pointer",accentColor:"#6b9fff"}})]}),i.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),i.jsx("div",{style:{marginBottom:"12px"},children:i.jsxs("button",{onClick:$e,disabled:$,style:w($,_),onMouseEnter:H=>!$&&!_&&(H.currentTarget.style.background="#3a3a42"),onMouseLeave:H=>!_&&(H.currentTarget.style.background="transparent"),children:[_?" ":"","Grayscale Mode"]})}),i.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[i.jsx("button",{onClick:q,disabled:$,style:{padding:"8px 16px",background:$?"#444":"#555",color:$?"#777":"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:$?"not-allowed":"pointer",fontSize:"13px",fontWeight:500},children:"Reset Transform"}),i.jsx("button",{onClick:r,style:{padding:"8px 16px",background:"#4a9eff",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:500},onMouseEnter:H=>H.currentTarget.style.background="#3a8ee6",onMouseLeave:H=>H.currentTarget.style.background="#4a9eff",children:"Close"})]}),T&&i.jsx("div",{style:{marginTop:"12px",padding:"8px 12px",background:"#3d2b2b",border:"1px solid #5a3a3a",borderRadius:4,fontSize:"12px",color:"#e88"},children:" Images are locked. Unlock via Images  Lock Images to make changes."})]})]})},cw=({visible:n,onClose:r,topImage:o,bottomImage:s,setTopImage:l,setBottomImage:d,componentsTop:b,componentsBottom:p,setComponentsTop:v,setComponentsBottom:m,drawingStrokes:j,setDrawingStrokes:_,powerSymbols:M,groundSymbols:T,setPowerSymbols:F,setGroundSymbols:P,canvasRef:k,isBottomView:y,setIsBottomView:ae,originalTopFlipX:E,setOriginalTopFlipX:U,originalBottomFlipX:ne,setOriginalBottomFlipX:Z,originalTopFlipY:G,setOriginalTopFlipY:te,originalBottomFlipY:O,setOriginalBottomFlipY:W,cameraWorldCenter:Y,setCameraWorldCenter:D,viewScale:J,viewRotation:$,setViewRotation:je,viewFlipX:ee,setViewFlipX:de,contentBorder:Ne,setTransparency:Ie})=>{const[$e,q]=I.useState(null),[w,V]=I.useState(!1),H=I.useRef({x:0,y:0}),ue=I.useRef(null),ve=I.useCallback((lt,St,Wt,ge)=>{const Ot=window.innerWidth,_t=window.innerHeight,qt=10,ht=Math.max(qt,Math.min(lt,Ot-Wt-qt)),fn=Math.max(qt,Math.min(St,_t-ge-qt));return{x:ht,y:fn}},[]);I.useEffect(()=>{if(n&&$e===null){const lt=localStorage.getItem("transformAllDialogPosition"),St=320,Wt=400,ge=20,Ot=150;let _t;if(lt)try{const qt=JSON.parse(lt);_t=ve(qt.x,qt.y,St,Wt)}catch{_t=ve(window.innerWidth-St-ge,Ot,St,Wt)}else _t=ve(window.innerWidth-St-ge,Ot,St,Wt);q(_t)}},[n,$e,ve]);const se=I.useCallback(lt=>{if(ue.current){const St=ue.current.getBoundingClientRect();H.current={x:lt.clientX-St.left,y:lt.clientY-St.top},V(!0)}},[]);I.useEffect(()=>{if(!w)return;const lt=Wt=>{const ge=Wt.clientX-H.current.x,Ot=Wt.clientY-H.current.y,_t=ue.current?.offsetWidth||320,qt=ue.current?.offsetHeight||400,ht=ve(ge,Ot,_t,qt);q(ht),localStorage.setItem("transformAllDialogPosition",JSON.stringify(ht))},St=()=>{V(!1)};return document.addEventListener("mousemove",lt),document.addEventListener("mouseup",St),()=>{document.removeEventListener("mousemove",lt),document.removeEventListener("mouseup",St)}},[w,ve]);const ze=I.useCallback(()=>{y||(de(!0),ae(!0),Ie(100))},[y,de,ae,Ie]),xe=I.useCallback(()=>{y&&(de(!1),ae(!1),Ie(0))},[y,de,ae,Ie]),De=I.useCallback(lt=>{je(St=>Wg(St,lt))},[je,Wg]);if(!n)return null;const Ye=(lt=!1)=>({display:"block",width:"100%",textAlign:"left",padding:"8px 12px",color:lt?"#999":"#222",background:"transparent",border:"none",borderRadius:4,cursor:lt?"not-allowed":"pointer",fontSize:"13px",transition:"background 0.15s"});return i.jsxs("div",{ref:ue,style:{position:"fixed",top:$e?.y??150,left:$e?.x??window.innerWidth-340,backgroundColor:"#fff",borderRadius:8,minWidth:"320px",maxWidth:"400px",maxHeight:"calc(100vh - 100px)",overflowY:"auto",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:10001,display:"flex",flexDirection:"column"},children:[i.jsxs("div",{onMouseDown:se,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:w?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Change Perspective"}),i.jsx("button",{onClick:r,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsxs("div",{style:{padding:"20px",overflow:"auto",flex:1},children:[i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"8px",fontWeight:500},children:"View:"}),i.jsx("button",{onClick:y?xe:ze,style:Ye(!1),onMouseEnter:lt=>lt.currentTarget.style.background="#f0f0f0",onMouseLeave:lt=>lt.currentTarget.style.background="transparent",children:y?"Switch to Top View":"Switch to Bottom View"}),i.jsx("div",{style:{fontSize:"10px",color:"#999",marginTop:"6px",fontStyle:"italic"},children:"Shortcut: Shift-Left/Right Arrow Keys"})]}),i.jsx("div",{style:{height:1,background:"#e0e0e0",margin:"16px 0"}}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"8px",fontWeight:500},children:"Rotate (clockwise):"}),i.jsx("button",{onClick:()=>De(90),style:Ye(),onMouseEnter:lt=>lt.currentTarget.style.background="#f0f0f0",onMouseLeave:lt=>lt.currentTarget.style.background="transparent",children:"Rotate 90"}),i.jsx("button",{onClick:()=>De(180),style:Ye(),onMouseEnter:lt=>lt.currentTarget.style.background="#f0f0f0",onMouseLeave:lt=>lt.currentTarget.style.background="transparent",children:"Rotate 180"}),i.jsx("button",{onClick:()=>De(270),style:Ye(),onMouseEnter:lt=>lt.currentTarget.style.background="#f0f0f0",onMouseLeave:lt=>lt.currentTarget.style.background="transparent",children:"Rotate 270"}),i.jsx("div",{style:{fontSize:"10px",color:"#999",marginTop:"6px",fontStyle:"italic"},children:"Shortcut: Shift-Up/Down Arrow Keys"})]}),i.jsx("div",{style:{height:1,background:"#e0e0e0",margin:"16px 0"}}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:i.jsx("button",{onClick:r,style:{padding:"8px 16px",background:"#4a9eff",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:500},onMouseEnter:lt=>lt.currentTarget.style.background="#3a8ee6",onMouseLeave:lt=>lt.currentTarget.style.background="#4a9eff",children:"Close"})})]})]})},Zy=({visible:n,title:r,message:o,onClose:s,type:l="info",onShowResponse:d})=>{if(!n)return null;const b=l==="success"?"#4CAF50":"#2196F3",p=l==="success"?"#4CAF50":"#2196F3",v=l==="success"?"":"";return i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:m=>{m.target===m.currentTarget&&s()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"90vw",maxHeight:"90vh",width:"600px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:`2px solid ${p}`,display:"flex",flexDirection:"column"},onClick:m=>m.stopPropagation(),children:[i.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",gap:"12px",flexShrink:0},children:[i.jsx("div",{style:{fontSize:"24px",color:b},children:v}),i.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:r})]}),i.jsx("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"14px",lineHeight:"1.5",whiteSpace:"pre-wrap",wordWrap:"break-word",overflowY:"auto",maxHeight:"60vh",paddingRight:"8px",flex:1},children:o}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[d&&i.jsx("button",{onClick:()=>{d(),s()},style:{padding:"8px 16px",background:"#555",color:"#fff",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Show Response"}),i.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"OK"})]})]})})},uw=({component:n,componentEditor:r,componentDefinition:o,setComponentEditor:s,areComponentsLocked:l,componentsTop:d,componentsBottom:b,setComponentsTop:p,setComponentsBottom:v,uploadedDatasheetFile:m,setUploadedDatasheetFile:j})=>{if(!n||!n.id||!n.componentType||typeof n.pinCount!="number")return console.error("[ComponentTypeFields] Component missing required properties:",{comp:n,hasId:!!n?.id,hasComponentType:!!n?.componentType,componentType:n?.componentType,pinCount:n?.pinCount,pinCountType:typeof n?.pinCount}),null;const M=(o||r?.componentDefinition||ll(n))?.fields,T=n.componentType,F=T==="IntegratedCircuit"||T==="Semiconductor",P=T==="Semiconductor",k=T==="IntegratedCircuit";if(M&&M.length>0&&!k){const y=(E,U,ne)=>ne?E==="capacitance"||E==="resistance"||E==="voltage"||E==="current"?"80px":E==="power"||E==="inductance"||E==="impedance"||E==="esr"||E==="ripple"||E==="leakageCurrent"?"70px":"80px":E==="tolerance"||E==="pinCount"?"60px":E==="partNumber"||E==="manufacturer"?"150px":E==="description"||E==="operatingTemperature"?"180px":U==="string"&&!E.includes("Unit")?"150px":"120px",ae=E=>{const U=n.componentType,ne=U==="IntegratedCircuit"||U==="Semiconductor";if(ne&&E.name==="datasheet"||ne&&(E.name==="manufacturer"||E.name==="partNumber")||E.name==="description")return null;const Z=E.name,G=`${E.name}Unit`,te=r[Z]??n[Z]??E.defaultValue??"",O=r[G]??n[G]??(E.units&&E.defaultUnit?E.defaultUnit:""),W=$=>{s(ee=>ee&&{...ee,[Z]:$})},Y=$=>{s(ee=>ee&&{...ee,[G]:$})},D=!!(E.units&&E.units.length>0),J=y(E.name,E.type,D);return i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsxs("label",{style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:[E.label,":"]}),E.type==="enum"?i.jsx("select",{value:te,onChange:$=>W($.target.value),disabled:l,style:{width:J,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:(E.enumValues||[]).map($=>i.jsx("option",{value:$,children:$},$))}):i.jsx("input",{type:"text",value:te,onChange:$=>W($.target.value),disabled:l,style:{width:J,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:D?"8px":"0"},placeholder:E.defaultValue!==void 0?String(E.defaultValue):""}),D&&E.units&&i.jsx("select",{value:O||E.defaultUnit||E.units[0],onChange:$=>Y($.target.value),disabled:l,style:{width:"70px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,flexShrink:0},children:E.units.map($=>i.jsx("option",{value:$,children:$},$))})]},E.name)};if(!P)return i.jsx(i.Fragment,{children:M.map(ae).filter(Boolean)})}return F?i.jsxs(i.Fragment,{children:[n.componentType==="Resistor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-resistance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),i.jsx("input",{id:`component-resistance-${n.id}`,type:"text",value:r.resistance||"",onChange:y=>s({...r,resistance:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 10"}),i.jsx("select",{value:r.resistanceUnit||dn("resistance"),onChange:y=>s({...r,resistanceUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("resistance").map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-power-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),i.jsxs("select",{id:`component-power-${n.id}`,value:r.power||"1/4",onChange:y=>s({...r,power:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"12px"},children:[i.jsx("option",{value:"1/20",children:"1/20 W"}),i.jsx("option",{value:"1/16",children:"1/16 W"}),i.jsx("option",{value:"1/10",children:"1/10 W"}),i.jsx("option",{value:"1/8",children:"1/8 W"}),i.jsx("option",{value:"1/4",children:"1/4 W"}),i.jsx("option",{value:"1/2",children:"1/2 W"}),i.jsx("option",{value:"1",children:"1 W"}),i.jsx("option",{value:"2",children:"2 W"}),i.jsx("option",{value:"3",children:"3 W"}),i.jsx("option",{value:"5",children:"5 W"}),i.jsx("option",{value:"10",children:"10 W"}),i.jsx("option",{value:"25",children:"25 W"}),i.jsx("option",{value:"50",children:"50 W"}),i.jsx("option",{value:"100",children:"100 W"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-tolerance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),i.jsxs("select",{id:`component-tolerance-${n.id}`,value:r.tolerance||"5%",onChange:y=>s({...r,tolerance:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"0.05%",children:"0.05%"}),i.jsx("option",{value:"0.1%",children:"0.1%"}),i.jsx("option",{value:"0.25%",children:"0.25%"}),i.jsx("option",{value:"0.5%",children:"0.5%"}),i.jsx("option",{value:"1%",children:"1%"}),i.jsx("option",{value:"2%",children:"2%"}),i.jsx("option",{value:"5%",children:"5%"}),i.jsx("option",{value:"10%",children:"10%"}),i.jsx("option",{value:"20%",children:"20%"})]})]})]}),n.componentType==="Capacitor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-capacitance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),i.jsx("input",{id:`component-capacitance-${n.id}`,type:"text",value:r.capacitance||"",onChange:y=>s({...r,capacitance:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 100"}),i.jsx("select",{value:r.capacitanceUnit||dn("capacitance"),onChange:y=>s({...r,capacitanceUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("capacitance").map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:y=>s({...r,voltage:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 50"}),i.jsx("select",{value:r.voltageUnit||dn("voltage"),onChange:y=>s({...r,voltageUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("voltage").map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-dielectric-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Dielectric:"}),i.jsxs("select",{id:`component-dielectric-${n.id}`,value:r.dielectric||"Ceramic",onChange:y=>s({...r,dielectric:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Ceramic",children:"Ceramic"}),i.jsx("option",{value:"Tantalum",children:"Tantalum"}),i.jsx("option",{value:"Film",children:"Film"}),i.jsx("option",{value:"Polyester",children:"Polyester"}),i.jsx("option",{value:"Polypropylene",children:"Polypropylene"}),i.jsx("option",{value:"Mica",children:"Mica"}),i.jsx("option",{value:"Paper",children:"Paper"}),i.jsx("option",{value:"Glass",children:"Glass"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-tolerance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),i.jsxs("select",{id:`component-tolerance-${n.id}`,value:r.tolerance||"10%",onChange:y=>s({...r,tolerance:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"0.5%",children:"0.5%"}),i.jsx("option",{value:"1%",children:"1%"}),i.jsx("option",{value:"2%",children:"2%"}),i.jsx("option",{value:"5%",children:"5%"}),i.jsx("option",{value:"10%",children:"10%"}),i.jsx("option",{value:"20%",children:"20%"})]})]})]}),n.componentType==="Film Capacitor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-capacitance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),i.jsx("input",{id:`component-capacitance-${n.id}`,type:"text",value:r.capacitance||"",onChange:y=>s({...r,capacitance:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 100"}),i.jsx("select",{value:r.capacitanceUnit||dn("capacitance"),onChange:y=>s({...r,capacitanceUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("capacitance").map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:y=>s({...r,voltage:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 50"}),i.jsx("select",{value:r.voltageUnit||dn("voltage"),onChange:y=>s({...r,voltageUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("voltage").map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-filmtype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Film Type:"}),i.jsxs("select",{id:`component-filmtype-${n.id}`,value:r.filmType||"Polyester",onChange:y=>s({...r,filmType:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Polyester",children:"Polyester"}),i.jsx("option",{value:"Polypropylene",children:"Polypropylene"}),i.jsx("option",{value:"Polyethylene",children:"Polyethylene"}),i.jsx("option",{value:"Polystyrene",children:"Polystyrene"}),i.jsx("option",{value:"Polycarbonate",children:"Polycarbonate"}),i.jsx("option",{value:"PTFE",children:"PTFE (Teflon)"}),i.jsx("option",{value:"PPS",children:"PPS (Polyphenylene Sulfide)"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-tolerance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),i.jsxs("select",{id:`component-tolerance-${n.id}`,value:r.tolerance||"10%",onChange:y=>s({...r,tolerance:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"0.5%",children:"0.5%"}),i.jsx("option",{value:"1%",children:"1%"}),i.jsx("option",{value:"2%",children:"2%"}),i.jsx("option",{value:"5%",children:"5%"}),i.jsx("option",{value:"10%",children:"10%"}),i.jsx("option",{value:"20%",children:"20%"})]})]})]}),n.componentType==="Electrolytic Capacitor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-capacitance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),i.jsx("input",{id:`component-capacitance-${n.id}`,type:"text",value:r.capacitance||"",onChange:y=>s({...r,capacitance:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 100"}),i.jsxs("select",{value:r.capacitanceUnit||"F",onChange:y=>s({...r,capacitanceUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:[i.jsx("option",{value:"pF",children:"pF"}),i.jsx("option",{value:"nF",children:"nF"}),i.jsx("option",{value:"F",children:"F"}),i.jsx("option",{value:"mF",children:"mF"}),i.jsx("option",{value:"F",children:"F"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:y=>s({...r,voltage:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 25"}),i.jsx("select",{value:r.voltageUnit||dn("voltage"),onChange:y=>s({...r,voltageUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("voltage").map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-tolerance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),i.jsxs("select",{id:`component-tolerance-${n.id}`,value:r.tolerance||"20%",onChange:y=>s({...r,tolerance:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},children:[i.jsx("option",{value:"0.5%",children:"0.5%"}),i.jsx("option",{value:"1%",children:"1%"}),i.jsx("option",{value:"2%",children:"2%"}),i.jsx("option",{value:"5%",children:"5%"}),i.jsx("option",{value:"10%",children:"10%"}),i.jsx("option",{value:"20%",children:"20%"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-polarized-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Polarized:"}),i.jsx("input",{id:`component-polarized-${n.id}`,type:"checkbox",checked:op(n),disabled:!0,style:{opacity:.6,cursor:"not-allowed"},title:"Polarized is a fixed property determined by component type"})]})]}),n.componentType==="Inductor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-inductance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Inductance:"}),i.jsx("input",{id:`component-inductance-${n.id}`,type:"text",value:r.inductance||"",onChange:y=>s({...r,inductance:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 10"}),i.jsx("select",{value:r.inductanceUnit||dn("inductance"),onChange:y=>s({...r,inductanceUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("inductance").map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:y=>s({...r,current:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:r.currentUnit||dn("current"),onChange:y=>s({...r,currentUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("current").map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-resistance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"DC Resistance:"}),i.jsx("input",{id:`component-resistance-${n.id}`,type:"text",value:r.resistance||"",onChange:y=>s({...r,resistance:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 50"}),i.jsx("select",{value:r.resistanceUnit||"",onChange:y=>s({...r,resistanceUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("resistance").map(y=>i.jsx("option",{value:y,children:y},y))})]})]}),n.componentType==="Diode"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-diodetype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Diode Type:"}),i.jsxs("select",{id:`component-diodetype-${n.id}`,value:r.diodeType||"Standard",onChange:y=>s({...r,diodeType:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Standard",children:"Standard"}),i.jsx("option",{value:"Zener",children:"Zener"}),i.jsx("option",{value:"LED",children:"LED"}),i.jsx("option",{value:"Schottky",children:"Schottky"}),i.jsx("option",{value:"Infrared",children:"Infrared"}),i.jsx("option",{value:"Photodiode",children:"Photodiode"}),i.jsx("option",{value:"Other",children:"Other"})]})]}),r.diodeType==="LED"&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-ledcolor-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"LED Color:"}),i.jsxs("select",{id:`component-ledcolor-${n.id}`,value:r.ledColor||"",onChange:y=>s({...r,ledColor:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"",children:"Select..."}),i.jsx("option",{value:"Red",children:"Red"}),i.jsx("option",{value:"Green",children:"Green"}),i.jsx("option",{value:"Blue",children:"Blue"}),i.jsx("option",{value:"Yellow",children:"Yellow"}),i.jsx("option",{value:"Orange",children:"Orange"}),i.jsx("option",{value:"White",children:"White"}),i.jsx("option",{value:"RGB",children:"RGB"}),i.jsx("option",{value:"IR",children:"IR (Infrared)"}),i.jsx("option",{value:"UV",children:"UV (Ultraviolet)"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:y=>s({...r,voltage:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 50"}),i.jsx("select",{value:r.voltageUnit||dn("voltage"),onChange:y=>s({...r,voltageUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("voltage").map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:y=>s({...r,current:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:r.currentUnit||dn("current"),onChange:y=>s({...r,currentUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("current").map(y=>i.jsx("option",{value:y,children:y},y))})]})]}),n.componentType==="Battery"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:y=>s({...r,voltage:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 3.7"}),i.jsx("select",{value:r.voltageUnit||"V",onChange:y=>s({...r,voltageUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("voltage").map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-capacity-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacity:"}),i.jsx("input",{id:`component-capacity-${n.id}`,type:"text",value:r.capacity||"",onChange:y=>s({...r,capacity:y.target.value}),disabled:l,style:{width:"120px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 2000mAh"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-chemistry-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Chemistry:"}),i.jsxs("select",{id:`component-chemistry-${n.id}`,value:r.chemistry||"Li-ion",onChange:y=>s({...r,chemistry:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Li-ion",children:"Li-ion"}),i.jsx("option",{value:"LiPo",children:"LiPo"}),i.jsx("option",{value:"NiMH",children:"NiMH"}),i.jsx("option",{value:"NiCd",children:"NiCd"}),i.jsx("option",{value:"Alkaline",children:"Alkaline"}),i.jsx("option",{value:"Lead-Acid",children:"Lead-Acid"}),i.jsx("option",{value:"Lithium",children:"Lithium"}),i.jsx("option",{value:"Zinc-Carbon",children:"Zinc-Carbon"})]})]})]}),n.componentType==="Fuse"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:y=>s({...r,current:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 5"}),i.jsx("select",{value:r.currentUnit||"A",onChange:y=>s({...r,currentUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("current").map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:y=>s({...r,voltage:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 250"}),i.jsx("select",{value:r.voltageUnit||"V",onChange:y=>s({...r,voltageUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("voltage").map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-fusetype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Fuse Type:"}),i.jsxs("select",{id:`component-fusetype-${n.id}`,value:r.fuseType||"Fast-blow",onChange:y=>s({...r,fuseType:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Fast-blow",children:"Fast-blow"}),i.jsx("option",{value:"Slow-blow",children:"Slow-blow"}),i.jsx("option",{value:"Time-delay",children:"Time-delay"}),i.jsx("option",{value:"Resettable",children:"Resettable"}),i.jsx("option",{value:"Cartridge",children:"Cartridge"}),i.jsx("option",{value:"Glass",children:"Glass"}),i.jsx("option",{value:"Ceramic",children:"Ceramic"})]})]})]}),n.componentType==="Relay"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-coilvoltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Coil Voltage:"}),i.jsx("input",{id:`component-coilvoltage-${n.id}`,type:"text",value:r.coilVoltage||"",onChange:y=>s({...r,coilVoltage:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 12"}),i.jsx("select",{value:r.coilVoltageUnit||dn("voltage"),onChange:y=>s({...r,coilVoltageUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("voltage").map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-contacttype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Contact Type:"}),i.jsxs("select",{id:`component-contacttype-${n.id}`,value:r.contactType||"SPST",onChange:y=>s({...r,contactType:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"SPST",children:"SPST (Single Pole Single Throw)"}),i.jsx("option",{value:"SPDT",children:"SPDT (Single Pole Double Throw)"}),i.jsx("option",{value:"DPST",children:"DPST (Double Pole Single Throw)"}),i.jsx("option",{value:"DPDT",children:"DPDT (Double Pole Double Throw)"}),i.jsx("option",{value:"3PDT",children:"3PDT (3 Pole Double Throw)"}),i.jsx("option",{value:"4PDT",children:"4PDT (4 Pole Double Throw)"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:y=>s({...r,current:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 10"}),i.jsx("select",{value:r.currentUnit||dn("current"),onChange:y=>s({...r,currentUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("current").map(y=>i.jsx("option",{value:y,children:y},y))})]})]}),n.componentType==="Motor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-motortype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Motor Type:"}),i.jsxs("select",{id:`component-motortype-${n.id}`,value:r.motorType||"DC",onChange:y=>s({...r,motorType:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"DC",children:"DC Motor"}),i.jsx("option",{value:"Stepper",children:"Stepper Motor"}),i.jsx("option",{value:"Servo",children:"Servo Motor"}),i.jsx("option",{value:"Brushless",children:"Brushless DC"}),i.jsx("option",{value:"AC",children:"AC Motor"}),i.jsx("option",{value:"Synchronous",children:"Synchronous"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:y=>s({...r,voltage:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 12"}),i.jsx("select",{value:r.voltageUnit||dn("voltage"),onChange:y=>s({...r,voltageUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("voltage").map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:y=>s({...r,current:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:r.currentUnit||dn("current"),onChange:y=>s({...r,currentUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("current").map(y=>i.jsx("option",{value:y,children:y},y))})]})]}),n.componentType==="Switch"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-switchtype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Switch Type:"}),i.jsxs("select",{id:`component-switchtype-${n.id}`,value:r.switchType||"Toggle",onChange:y=>s({...r,switchType:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Toggle",children:"Toggle"}),i.jsx("option",{value:"Push-button",children:"Push-button"}),i.jsx("option",{value:"Slide",children:"Slide"}),i.jsx("option",{value:"Rotary",children:"Rotary"}),i.jsx("option",{value:"DIP",children:"DIP Switch"}),i.jsx("option",{value:"Momentary",children:"Momentary"}),i.jsx("option",{value:"Latching",children:"Latching"}),i.jsx("option",{value:"Reed",children:"Reed Switch"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:y=>s({...r,current:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 5"}),i.jsx("select",{value:r.currentUnit||dn("current"),onChange:y=>s({...r,currentUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("current").map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:y=>s({...r,voltage:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 250"}),i.jsx("select",{value:r.voltageUnit||dn("voltage"),onChange:y=>s({...r,voltageUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("voltage").map(y=>i.jsx("option",{value:y,children:y},y))})]})]}),n.componentType==="FerriteBead"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-impedance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Impedance:"}),i.jsx("input",{id:`component-impedance-${n.id}`,type:"text",value:r.impedance||"",onChange:y=>s({...r,impedance:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 100"}),i.jsx("select",{value:r.impedanceUnit||dn("impedance"),onChange:y=>s({...r,impedanceUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("impedance").map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:y=>s({...r,current:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:r.currentUnit||dn("current"),onChange:y=>s({...r,currentUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("current").map(y=>i.jsx("option",{value:y,children:y},y))})]})]}),n.componentType==="Connector"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-connectortype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Connector Type:"}),i.jsx("input",{id:`component-connectortype-${n.id}`,type:"text",value:r.connectorType||"",onChange:y=>s({...r,connectorType:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., USB-A, HDMI"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-gender-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Gender:"}),i.jsxs("select",{id:`component-gender-${n.id}`,value:r.gender||"N/A",onChange:y=>s({...r,gender:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Male",children:"Male"}),i.jsx("option",{value:"Female",children:"Female"}),i.jsx("option",{value:"N/A",children:"N/A"})]})]})]}),n.componentType==="Jumper"&&i.jsx(i.Fragment,{children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-positions-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Positions:"}),i.jsx("input",{id:`component-positions-${n.id}`,type:"number",min:"2",value:r.positions||3,onChange:y=>s({...r,positions:parseInt(y.target.value)||3}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"}})]})}),n.componentType==="Speaker"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-impedance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Impedance:"}),i.jsx("input",{id:`component-impedance-${n.id}`,type:"text",value:r.impedance||"",onChange:y=>s({...r,impedance:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 8"}),i.jsx("select",{value:r.impedanceUnit||dn("impedance"),onChange:y=>s({...r,impedanceUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("impedance").map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-power-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),i.jsxs("select",{id:`component-power-${n.id}`,value:r.power||"1/4",onChange:y=>s({...r,power:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"12px"},children:[i.jsx("option",{value:"1/20",children:"1/20 W"}),i.jsx("option",{value:"1/16",children:"1/16 W"}),i.jsx("option",{value:"1/10",children:"1/10 W"}),i.jsx("option",{value:"1/8",children:"1/8 W"}),i.jsx("option",{value:"1/4",children:"1/4 W"}),i.jsx("option",{value:"1/2",children:"1/2 W"}),i.jsx("option",{value:"1",children:"1 W"}),i.jsx("option",{value:"2",children:"2 W"}),i.jsx("option",{value:"3",children:"3 W"}),i.jsx("option",{value:"5",children:"5 W"}),i.jsx("option",{value:"10",children:"10 W"}),i.jsx("option",{value:"25",children:"25 W"}),i.jsx("option",{value:"50",children:"50 W"}),i.jsx("option",{value:"100",children:"100 W"})]})]})]}),n.componentType==="PowerSupply"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-inputvoltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Input Voltage:"}),i.jsx("input",{id:`component-inputvoltage-${n.id}`,type:"text",value:r.inputVoltage||"",onChange:y=>s({...r,inputVoltage:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 120"}),i.jsx("select",{value:r.inputVoltageUnit||dn("voltage"),onChange:y=>s({...r,inputVoltageUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("voltage").map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-outputvoltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Output Voltage:"}),i.jsx("input",{id:`component-outputvoltage-${n.id}`,type:"text",value:r.outputVoltage||"",onChange:y=>s({...r,outputVoltage:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 12"}),i.jsx("select",{value:r.outputVoltageUnit||dn("voltage"),onChange:y=>s({...r,outputVoltageUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("voltage").map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:y=>s({...r,current:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:r.currentUnit||dn("current"),onChange:y=>s({...r,currentUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("current").map(y=>i.jsx("option",{value:y,children:y},y))})]})]}),n.componentType==="Transistor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-transistortype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Transistor Type:"}),i.jsxs("select",{id:`component-transistortype-${n.id}`,value:r.transistorType||"BJT",onChange:y=>s({...r,transistorType:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"BJT",children:"BJT (Bipolar Junction Transistor)"}),i.jsx("option",{value:"FET",children:"FET (Field Effect Transistor)"}),i.jsx("option",{value:"MOSFET",children:"MOSFET"}),i.jsx("option",{value:"IGBT",children:"IGBT"}),i.jsx("option",{value:"JFET",children:"JFET"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-polarity-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Polarity:"}),i.jsxs("select",{id:`component-polarity-${n.id}`,value:r.polarity||"NPN",onChange:y=>s({...r,polarity:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"NPN",children:"NPN"}),i.jsx("option",{value:"PNP",children:"PNP"}),i.jsx("option",{value:"N-Channel",children:"N-Channel"}),i.jsx("option",{value:"P-Channel",children:"P-Channel"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:y=>s({...r,voltage:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 50"}),i.jsx("select",{value:r.voltageUnit||dn("voltage"),onChange:y=>s({...r,voltageUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("voltage").map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:y=>s({...r,current:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:r.currentUnit||dn("current"),onChange:y=>s({...r,currentUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("current").map(y=>i.jsx("option",{value:y,children:y},y))})]})]}),n.componentType==="ResistorNetwork"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-resistance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),i.jsx("input",{id:`component-resistance-${n.id}`,type:"text",value:r.resistance||"",onChange:y=>s({...r,resistance:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 10"}),i.jsx("select",{value:r.resistanceUnit||dn("resistance"),onChange:y=>s({...r,resistanceUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("resistance").map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-configuration-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Configuration:"}),i.jsx("input",{id:`component-configuration-${n.id}`,type:"text",value:r.configuration||"",onChange:y=>s({...r,configuration:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., Isolated, Bussed"})]})]}),n.componentType==="Thermistor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-resistance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),i.jsx("input",{id:`component-resistance-${n.id}`,type:"text",value:r.resistance||"",onChange:y=>s({...r,resistance:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 10"}),i.jsx("select",{value:r.resistanceUnit||dn("resistance"),onChange:y=>s({...r,resistanceUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("resistance").map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-thermistortype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Thermistor Type:"}),i.jsxs("select",{id:`component-thermistortype-${n.id}`,value:r.thermistorType||"NTC",onChange:y=>s({...r,thermistorType:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"NTC",children:"NTC (Negative Temperature Coefficient)"}),i.jsx("option",{value:"PTC",children:"PTC (Positive Temperature Coefficient)"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-beta-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Beta ():"}),i.jsx("input",{id:`component-beta-${n.id}`,type:"text",value:r.beta||"",onChange:y=>s({...r,beta:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., 3950"})]})]}),n.componentType==="Transformer"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-primaryvoltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Primary Voltage:"}),i.jsx("input",{id:`component-primaryvoltage-${n.id}`,type:"text",value:r.primaryVoltage||"",onChange:y=>s({...r,primaryVoltage:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 120"}),i.jsx("select",{value:r.primaryVoltageUnit||dn("voltage"),onChange:y=>s({...r,primaryVoltageUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("voltage").map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-secondaryvoltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Secondary Voltage:"}),i.jsx("input",{id:`component-secondaryvoltage-${n.id}`,type:"text",value:r.secondaryVoltage||"",onChange:y=>s({...r,secondaryVoltage:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 12"}),i.jsx("select",{value:r.secondaryVoltageUnit||dn("voltage"),onChange:y=>s({...r,secondaryVoltageUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("voltage").map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-power-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),i.jsxs("select",{id:`component-power-${n.id}`,value:r.power||"1/4",onChange:y=>s({...r,power:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"12px"},children:[i.jsx("option",{value:"1/20",children:"1/20 W"}),i.jsx("option",{value:"1/16",children:"1/16 W"}),i.jsx("option",{value:"1/10",children:"1/10 W"}),i.jsx("option",{value:"1/8",children:"1/8 W"}),i.jsx("option",{value:"1/4",children:"1/4 W"}),i.jsx("option",{value:"1/2",children:"1/2 W"}),i.jsx("option",{value:"1",children:"1 W"}),i.jsx("option",{value:"2",children:"2 W"}),i.jsx("option",{value:"3",children:"3 W"}),i.jsx("option",{value:"5",children:"5 W"}),i.jsx("option",{value:"10",children:"10 W"}),i.jsx("option",{value:"25",children:"25 W"}),i.jsx("option",{value:"50",children:"50 W"}),i.jsx("option",{value:"100",children:"100 W"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-turns-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Turns Ratio:"}),i.jsx("input",{id:`component-turns-${n.id}`,type:"text",value:r.turns||"",onChange:y=>s({...r,turns:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., 10:1"})]})]}),n.componentType==="TestPoint"&&i.jsx(i.Fragment,{children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-signal-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Signal:"}),i.jsx("input",{id:`component-signal-${n.id}`,type:"text",value:r.signal||"",onChange:y=>s({...r,signal:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., VCC, GND, CLK"})]})}),(n.componentType==="IntegratedCircuit"||n.componentType==="Semiconductor")&&i.jsxs(i.Fragment,{children:[P&&M&&M.length>0&&(()=>{const y=(Z,G,te)=>te?"80px":Z==="partNumber"||Z==="manufacturer"?"150px":Z==="description"||Z==="operatingTemperature"?"180px":G==="string"&&!Z.includes("Unit")?"150px":"120px",ae=Z=>{if(Z.name==="datasheet"||Z.name==="description"||Z.name==="operatingTemperature"||P&&(Z.name==="manufacturer"||Z.name==="partNumber")||Z.name==="icType"||P&&!Z.name)return null;const G=Z.name,te=`${Z.name}Unit`,O=r[G]??n[G]??Z.defaultValue??"",W=r[te]??n[te]??(Z.units&&Z.defaultUnit?Z.defaultUnit:""),Y=je=>{s({...r,[G]:je})},D=je=>{s({...r,[te]:je})},J=!!(Z.units&&Z.units.length>0),$=y(Z.name,Z.type,J);return i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsxs("label",{style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:[Z.label,":"]}),Z.type==="enum"?i.jsx("select",{value:O,onChange:je=>Y(je.target.value),disabled:l,style:{width:$,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:(Z.enumValues||[]).map(je=>i.jsx("option",{value:je,children:je},je))}):i.jsx("input",{type:"text",value:O,onChange:je=>Y(je.target.value),disabled:l,style:{width:$,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:J?"8px":"0"},placeholder:Z.defaultValue!==void 0?String(Z.defaultValue):""}),J&&Z.units&&i.jsx("select",{value:W||Z.defaultUnit||Z.units[0],onChange:je=>D(je.target.value),disabled:l,style:{width:"70px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,flexShrink:0},children:Z.units.map(je=>i.jsx("option",{value:je,children:je},je))})]},Z.name)},E=M.map(ae).filter(Boolean),U=P?i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsx("label",{htmlFor:`component-ictype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"IC Type:"}),i.jsxs("select",{id:`component-ictype-${n.id}`,value:r.icType||"Other",onChange:Z=>s({...r,icType:Z.target.value}),disabled:l,style:{width:"150px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Op-Amp",children:"Op-Amp"}),i.jsx("option",{value:"Microcontroller",children:"Microcontroller"}),i.jsx("option",{value:"Microprocessor",children:"Microprocessor"}),i.jsx("option",{value:"Logic",children:"Logic"}),i.jsx("option",{value:"Memory",children:"Memory"}),i.jsx("option",{value:"Voltage Regulator",children:"Voltage Regulator"}),i.jsx("option",{value:"Timer",children:"Timer"}),i.jsx("option",{value:"ADC",children:"ADC (Analog-to-Digital)"}),i.jsx("option",{value:"DAC",children:"DAC (Digital-to-Analog)"}),i.jsx("option",{value:"Comparator",children:"Comparator"}),i.jsx("option",{value:"Transceiver",children:"Transceiver"}),i.jsx("option",{value:"Driver",children:"Driver"}),i.jsx("option",{value:"Amplifier",children:"Amplifier"}),i.jsx("option",{value:"Other",children:"Other"})]})]},"icType"):null,ne=E.findIndex(Z=>Z?.key==="manufacturer");return ne>=0&&U?E.splice(ne+1,0,U):U&&E.push(U),E})(),k&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsx("label",{htmlFor:`component-ictype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"IC Type:"}),i.jsxs("select",{id:`component-ictype-${n.id}`,value:r.icType||"Other",onChange:y=>s({...r,icType:y.target.value}),disabled:l,style:{width:"150px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},children:[i.jsx("option",{value:"Op-Amp",children:"Op-Amp"}),i.jsx("option",{value:"Microcontroller",children:"Microcontroller"}),i.jsx("option",{value:"Microprocessor",children:"Microprocessor"}),i.jsx("option",{value:"Logic",children:"Logic"}),i.jsx("option",{value:"Memory",children:"Memory"}),i.jsx("option",{value:"Voltage Regulator",children:"Voltage Regulator"}),i.jsx("option",{value:"Timer",children:"Timer"}),i.jsx("option",{value:"ADC",children:"ADC (Analog-to-Digital)"}),i.jsx("option",{value:"DAC",children:"DAC (Digital-to-Analog)"}),i.jsx("option",{value:"Comparator",children:"Comparator"}),i.jsx("option",{value:"Transceiver",children:"Transceiver"}),i.jsx("option",{value:"Driver",children:"Driver"}),i.jsx("option",{value:"Amplifier",children:"Amplifier"}),i.jsx("option",{value:"Other",children:"Other"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsx("label",{htmlFor:`component-packagetype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Package Type:"}),i.jsxs("select",{id:`component-packagetype-${n.id}`,value:r.packageType||"",onChange:y=>s({...r,packageType:y.target.value}),disabled:l,style:{width:"150px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},children:[i.jsx("option",{value:"",children:"-- Select --"}),i.jsx("option",{value:"DIP",children:"DIP"}),i.jsx("option",{value:"PDIP",children:"PDIP"}),i.jsx("option",{value:"SOIC",children:"SOIC"}),i.jsx("option",{value:"QFP",children:"QFP"}),i.jsx("option",{value:"LQFP",children:"LQFP"}),i.jsx("option",{value:"TQFP",children:"TQFP"}),i.jsx("option",{value:"BGA",children:"BGA"}),i.jsx("option",{value:"SSOP",children:"SSOP"}),i.jsx("option",{value:"TSOP",children:"TSOP"}),i.jsx("option",{value:"Various",children:"Various"}),i.jsx("option",{value:"Other",children:"Other"})]})]})]})]}),n.componentType==="VacuumTube"&&i.jsx(i.Fragment,{children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-tubetype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tube Type:"}),i.jsx("input",{id:`component-tubetype-${n.id}`,type:"text",value:r.tubeType||"",onChange:y=>s({...r,tubeType:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., 12AX7, 6L6"})]})}),n.componentType==="VariableResistor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-vrtype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"VR Type:"}),i.jsxs("select",{id:`component-vrtype-${n.id}`,value:r.vrType||"Potentiometer",onChange:y=>s({...r,vrType:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Potentiometer",children:"Potentiometer"}),i.jsx("option",{value:"Rheostat",children:"Rheostat"}),i.jsx("option",{value:"Trimmer",children:"Trimmer"}),i.jsx("option",{value:"Varistor",children:"Varistor"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-resistance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),i.jsx("input",{id:`component-resistance-${n.id}`,type:"text",value:r.resistance||"",onChange:y=>s({...r,resistance:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 10"}),i.jsx("select",{value:r.resistanceUnit||dn("resistance"),onChange:y=>s({...r,resistanceUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("resistance").map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-power-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),i.jsxs("select",{id:`component-power-${n.id}`,value:r.power||"1/4",onChange:y=>s({...r,power:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"12px"},children:[i.jsx("option",{value:"1/20",children:"1/20 W"}),i.jsx("option",{value:"1/16",children:"1/16 W"}),i.jsx("option",{value:"1/10",children:"1/10 W"}),i.jsx("option",{value:"1/8",children:"1/8 W"}),i.jsx("option",{value:"1/4",children:"1/4 W"}),i.jsx("option",{value:"1/2",children:"1/2 W"}),i.jsx("option",{value:"1",children:"1 W"}),i.jsx("option",{value:"2",children:"2 W"}),i.jsx("option",{value:"3",children:"3 W"}),i.jsx("option",{value:"5",children:"5 W"}),i.jsx("option",{value:"10",children:"10 W"}),i.jsx("option",{value:"25",children:"25 W"}),i.jsx("option",{value:"50",children:"50 W"}),i.jsx("option",{value:"100",children:"100 W"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-taper-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Taper:"}),i.jsxs("select",{id:`component-taper-${n.id}`,value:r.taper||"Linear",onChange:y=>s({...r,taper:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Linear",children:"Linear"}),i.jsx("option",{value:"Logarithmic",children:"Logarithmic"}),i.jsx("option",{value:"Audio",children:"Audio"})]})]})]}),n.componentType==="Crystal"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-frequency-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Frequency:"}),i.jsx("input",{id:`component-frequency-${n.id}`,type:"text",value:r.frequency||"",onChange:y=>s({...r,frequency:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., 16.000 MHz"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-loadcapacitance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Load Capacitance:"}),i.jsx("input",{id:`component-loadcapacitance-${n.id}`,type:"text",value:r.loadCapacitance||"",onChange:y=>s({...r,loadCapacitance:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., 18pF"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-tolerance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),i.jsxs("select",{id:`component-tolerance-${n.id}`,value:r.tolerance||"10ppm",onChange:y=>s({...r,tolerance:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"10ppm",children:"10ppm"}),i.jsx("option",{value:"20ppm",children:"20ppm"}),i.jsx("option",{value:"30ppm",children:"30ppm"}),i.jsx("option",{value:"50ppm",children:"50ppm"}),i.jsx("option",{value:"100ppm",children:"100ppm"})]})]})]}),n.componentType==="GenericComponent"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-generictype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Type:"}),i.jsxs("select",{id:`component-generictype-${n.id}`,value:n.genericType||"Attenuator",onChange:y=>s({...r,genericType:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Attenuator",children:"Attenuator"}),i.jsx("option",{value:"CircuitBreaker",children:"Circuit Breaker"}),i.jsx("option",{value:"Thermocouple",children:"Thermocouple"}),i.jsx("option",{value:"Tuner",children:"Tuner"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:y=>s({...r,voltage:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 50"}),i.jsx("select",{value:r.voltageUnit||dn("voltage"),onChange:y=>s({...r,voltageUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("voltage").map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:y=>s({...r,current:y.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:r.currentUnit||dn("current"),onChange:y=>s({...r,currentUnit:y.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:dr("current").map(y=>i.jsx("option",{value:y,children:y},y))})]}),n.genericType==="Tuner"&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-frequency-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Frequency:"}),i.jsx("input",{id:`component-frequency-${n.id}`,type:"text",value:r.frequency||"",onChange:y=>s({...r,frequency:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., 100MHz"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-power-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),i.jsx("input",{id:`component-power-${n.id}`,type:"text",value:r.power||"",onChange:y=>s({...r,power:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., 1W"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-model-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Model:"}),i.jsx("input",{id:`component-model-${n.id}`,type:"text",value:r.model||"",onChange:y=>s({...r,model:y.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"Part number or model"})]})]})]}):i.jsx("div",{style:{padding:"8px",background:"#fff3cd",border:"1px solid #ffeeba",borderRadius:4,color:"#856404",marginBottom:"8px",fontSize:"11px"},children:"Component definition missing for this instance. Using legacy fields. Please ensure the component has a definition in componentDefinitions.json and a valid componentDefinitionKey."})};typeof window<"u"&&sx();const dw=n=>{const r=c0[n];return!r||!r.prefix||r.prefix.length<1?"?":r.prefix[0].substring(0,1).toUpperCase()},fw=({componentEditor:n,componentDefinition:r,setComponentEditor:o,componentsTop:s,componentsBottom:l,setComponentsTop:d,setComponentsBottom:b,connectingPin:p,setConnectingPin:v,componentDialogPosition:m,setComponentDialogPosition:j,isDraggingDialog:_,setIsDraggingDialog:M,dialogDragOffset:T,setDialogDragOffset:F,areComponentsLocked:P,setSelectedComponentIds:k,setNotesDialogVisible:y,projectDirHandle:ae,showAiSettingsDialog:E=!1,onAiSettingsDialogClose:U,onFindComponent:ne,canvasHeight:Z})=>{const[G,te]=I.useState(!1),[O,W]=I.useState(null),[Y,D]=I.useState(!1),[J,$]=I.useState(!1),[je,ee]=I.useState(null),[de,Ne]=I.useState(!1),[Ie,$e]=I.useState(!1),[q,w]=I.useState(""),[V,H]=I.useState(()=>typeof window<"u"?df().provider:"gemini"),[ue,ve]=I.useState(()=>typeof window<"u"&&Xc().getApiKey()||""),[se,ze]=I.useState(()=>typeof window<"u"?Xc().getModel():"gemini-2.0-flash"),[xe,De]=I.useState(()=>typeof window<"u"?W2():"sessionStorage"),[Ye,lt]=I.useState(()=>typeof window<"u"?Xc().hasApiKey():!1);I.useEffect(()=>{if(E){if(typeof window<"u"){const we=df();H(we.provider),De(we.apiKeyStorageType);const st=Xc(),et=st.getApiKey(),Pt=st.getModel();ve(et||""),ze(Pt),lt(!!et)}const Me=setTimeout(()=>{$(!0)},0);return()=>clearTimeout(Me)}},[E]),I.useEffect(()=>{if(typeof window<"u"){const Me=Xc();lt(Me.hasApiKey()||!!ue.trim())}},[ue,V]),I.useEffect(()=>{if(n){const we=(n.layer==="top"?s:l).find(st=>st.id===n.id);if(we){const st=we.customGeminiPrompt;w(st||"")}}},[n?.id,s,l]);const St=()=>{if(typeof window<"u"){vh({provider:V,model:se,apiKeyStorageType:xe}),$2(xe),D1(V);const Me=Xc(),we=Us[V];if(ue.trim()){Me.saveApiKey(ue.trim(),xe),Me.saveModel(se),lt(!0);const st=xe==="sessionStorage"?"Note: The API key will be cleared when you close the browser tab.":"Note: The API key will persist until you remove it.";mn({visible:!0,title:"Settings Saved",message:`${we.name} API key and model (${se}) saved! You can now use the "Extract Datasheet Information" feature. ${st}`,type:"success"})}else Me.removeApiKey(),Me.saveModel(se),lt(!1),mn({visible:!0,title:"API Key Removed",message:"API key removed. Model preference saved.",type:"info"})}},Wt=()=>{typeof window<"u"&&Xc().removeApiKey(),ve(""),lt(!1),mn({visible:!0,title:"API Key Removed",message:"API key has been removed. You will need to enter it again to use AI features.",type:"info"})},ge=Me=>{H(Me),D1(Me);const we=Xc();ve(we.getApiKey()||""),ze(we.getModel()),lt(we.hasApiKey())},Ot=()=>{const Me=n?.designator?.trim().toUpperCase();if(!Me)return;const st=[...s,...l].filter(Pt=>Pt.designator?.trim().toUpperCase()===Me);if(st.length===0)return;if(ne&&st.length>0){const Pt=st[0];ne(Pt.id,Pt.x,Pt.y)}const et=new Set(st.map(Pt=>Pt.id));k(et)},_t=Me=>`You are analyzing an electronic component datasheet PDF. Extract pin information, component properties, a datasheet summary, IC type, and pin count, then return the data as a JSON object.

Requirements:
1. Return a JSON object with three sections: "pins", "properties", and "summary"
2. First, determine the total number of pins (pinCount) for this component from the datasheet. This should be a positive integer representing the total number of pins/pads on the component.
3. For pins, extract information for ALL pins found in the datasheet (not just a subset). For each pin, provide:
   - pinNumber: The pin number (1, 2, 3, etc.)
   - pinName: The signal name (e.g., VCC, GND, IN+, OUT, etc.). Use the exact name from the datasheet.
   - pinDescription: A brief description of the pin's function (optional, can be empty string)
   - pinType: The pin type (optional): "input", "output", "bidirectional", "power", "ground", "no_connect", or "passive". Only include if clearly identifiable from the datasheet.
   - alternateFunctions: An array of alternate function names for this pin (optional, only if the pin has multiple functions). For example, a microcontroller GPIO pin might have ["SPI_MOSI", "I2C_SDA"] as alternate functions.
4. For component properties, extract the following information if available in the datasheet:
${Me.map(we=>we.hasUnits?`   - ${we.name}: The ${we.label.toLowerCase()} value (as a number) and ${we.name}Unit: The unit (one of: ${we.units.join(", ")})`:we.type==="enum"?`   - ${we.name}: The ${we.label.toLowerCase()} (as a string)`:`   - ${we.name}: The ${we.label.toLowerCase()} (as a string or number, depending on the field type)`).join(`
`)}
5. For IC Type (icType), determine the type of integrated circuit from the datasheet. Choose from: "Op-Amp", "Microcontroller", "Microprocessor", "Logic", "Memory", "Voltage Regulator", "Timer", "ADC", "DAC", "Comparator", "Transceiver", "Driver", "Amplifier", or "Other". If it's clearly an op amp, use "Op-Amp". If it's clearly a microcontroller, use "Microcontroller", etc.
6. For Package Type (packageType), determine the package type from the datasheet. Choose from: "DIP", "PDIP", "SOIC", "QFP", "LQFP", "TQFP", "BGA", "SSOP", "TSOP", "Various", or "Other". If multiple package types are mentioned in the datasheet, use "Various". If it's a plastic DIP, use "PDIP". If it's a standard DIP, use "DIP".
7. For pin count (pinCount), determine the total number of pins/pads on the component from the datasheet. This should be a positive integer. Include this in the properties section.
8. For datasheet summary (datasheetSummary), provide a concise summary (2-4 sentences) of the introductory information from the datasheet, including what the component is, its main purpose, and key features mentioned in the introduction or overview section.
9. Only include properties that are actually found in the datasheet - do not make up values
10. For numeric fields with units, extract both the numeric value and the appropriate unit
11. Return ONLY valid JSON, no additional text, explanations, or markdown formatting

Example JSON format:
{
  "pins": [
    {"pinNumber": 1, "pinName": "VCC", "pinDescription": "Power supply positive", "pinType": "power"},
    {"pinNumber": 2, "pinName": "GND", "pinDescription": "Ground", "pinType": "ground"},
    {"pinNumber": 3, "pinName": "IN+", "pinDescription": "Non-inverting input", "pinType": "input"},
    {"pinNumber": 4, "pinName": "IN-", "pinDescription": "Inverting input", "pinType": "input"},
    {"pinNumber": 5, "pinName": "OUT", "pinDescription": "Output", "pinType": "output"},
    {"pinNumber": 6, "pinName": "GPIO1", "pinDescription": "General purpose I/O", "pinType": "bidirectional", "alternateFunctions": ["SPI_MOSI", "I2C_SDA"]}
  ],
  "properties": {
    "partNumber": "LM358",
    "manufacturer": "Texas Instruments",
    "voltage": 36,
    "voltageUnit": "V",
    "description": "Dual operational amplifier",
    "icType": "Op-Amp",
    "packageType": "PDIP",
    "pinCount": 5
  },
  "summary": {
    "datasheetSummary": "The LM358 is a dual operational amplifier featuring low power consumption and wide supply voltage range. It is designed for single supply operation from 3V to 32V or dual supplies from 1.5V to 16V. The device offers high gain bandwidth product and low input offset voltage."
  }
}

Analyze the attached PDF datasheet and extract the information according to the requirements above.`,[qt,ht]=I.useState(()=>{const Me=localStorage.getItem("componentDialogSize");if(Me)try{return JSON.parse(Me)}catch{return{width:350,height:window.innerHeight*.4}}return{width:350,height:window.innerHeight*.4}}),[fn,Yt]=I.useState(!1),[ln,cn]=I.useState({x:0,y:0,width:0,height:0}),[Sn,mn]=I.useState({visible:!1,title:"",message:"",type:"info"}),tt=At.useMemo(()=>{if(!n||!n.visible)return null;let Me=s.find(we=>we.id===n.id);return Me||(Me=l.find(we=>we.id===n.id)),Me||null},[n,s,l]);At.useEffect(()=>{if(!tt){W(null);return}const Me=tt.id,we=tt.componentType,st=tt.componentType;if(!we){console.error("[ComponentEditor useEffect] Component missing componentType:",{comp:tt,componentId:Me}),W(null);return}if(we==="IntegratedCircuit"||st==="Semiconductor"){const et=tt;W(null),n&&o({...n,datasheetFileName:et.datasheetFileName||void 0})}else W(null)},[tt?.id,tt?.componentType,tt?.datasheetFileName]),I.useEffect(()=>{if(!fn)return;const Me=st=>{const et=st.clientX-ln.x,Pt=st.clientY-ln.y,Rt=Math.max(350,Math.min(window.innerWidth-20,ln.width+et)),Ge=Math.max(200,Math.min(window.innerHeight-20,ln.height+Pt)),zt={width:Rt,height:Ge};ht(zt),localStorage.setItem("componentDialogSize",JSON.stringify(zt))},we=()=>{Yt(!1)};return document.addEventListener("mousemove",Me),document.addEventListener("mouseup",we),()=>{document.removeEventListener("mousemove",Me),document.removeEventListener("mouseup",we)}},[fn,ln]),I.useEffect(()=>{Z&&Z>200&&ht(Me=>{const we={...Me,height:Z};return localStorage.setItem("componentDialogSize",JSON.stringify(we)),we})},[Z]);const Bt=Me=>{Me.preventDefault(),Me.stopPropagation(),Yt(!0),cn({x:Me.clientX,y:Me.clientY,width:qt.width,height:qt.height})};if(!n||!n.visible)return i.jsxs(i.Fragment,{children:[J&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10005},onClick:Me=>{Me.target===Me.currentTarget&&($(!1),U?.())},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"520px",maxWidth:"620px",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:Me=>Me.stopPropagation(),children:[i.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:"AI Service Configuration"}),i.jsx("button",{onClick:()=>{$(!1),U?.()},style:{background:"transparent",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:0,width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center"},title:"Close",children:""})]}),i.jsxs("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"14px",lineHeight:"1.6"},children:[i.jsx("p",{style:{margin:"0 0 16px 0"},children:"Extract datasheet information for components  avoiding manual data entry. Choose your preferred AI service below."}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#fff",fontSize:"13px",fontWeight:600},children:"AI Service Provider:"}),i.jsx("select",{value:V,onChange:Me=>ge(Me.target.value),style:{width:"100%",padding:"8px 12px",fontSize:"13px",border:"1px solid #555",borderRadius:"4px",background:"#1f1f24",color:"#fff",boxSizing:"border-box",cursor:"pointer"},children:_1.map(Me=>i.jsx("option",{value:Me,children:Us[Me].name},Me))}),i.jsx("p",{style:{margin:"6px 0 0 0",color:"#aaa",fontSize:"12px",lineHeight:"1.4"},children:Us[V].description})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsxs("label",{style:{display:"block",marginBottom:"6px",color:"#fff",fontSize:"13px",fontWeight:600},children:[Us[V].name," API Key:"]}),i.jsx("input",{type:"password",value:ue,onChange:Me=>ve(Me.target.value),placeholder:Us[V].apiKeyPlaceholder,style:{width:"100%",padding:"8px 12px",fontSize:"13px",border:"1px solid #555",borderRadius:"4px",background:"#1f1f24",color:"#fff",boxSizing:"border-box"},autoFocus:!0}),i.jsxs("p",{style:{margin:"6px 0 0 0",color:"#aaa",fontSize:"12px"},children:["Get your API key from:"," ",i.jsx("a",{href:Us[V].apiKeyHelpUrl,target:"_blank",rel:"noopener noreferrer",style:{color:"#4CAF50"},children:Us[V].apiKeyHelpUrl})]})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#fff",fontSize:"13px",fontWeight:600},children:"Model:"}),i.jsx("select",{value:se,onChange:Me=>ze(Me.target.value),style:{width:"100%",padding:"8px 12px",fontSize:"13px",border:"1px solid #555",borderRadius:"4px",background:"#1f1f24",color:"#fff",boxSizing:"border-box",cursor:"pointer"},children:Us[V].models.map(Me=>i.jsxs("option",{value:Me.id,children:[Me.name," ",Me.description?`(${Me.description})`:""]},Me.id))})]}),i.jsxs("div",{style:{marginBottom:"16px",padding:"12px",background:"#1f1f24",borderRadius:"4px",border:"1px solid #444"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#fff",fontSize:"13px",fontWeight:600},children:"API Key Storage:"}),i.jsxs("div",{style:{display:"flex",gap:"16px"},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",cursor:"pointer",color:"#ddd",fontSize:"13px"},children:[i.jsx("input",{type:"radio",name:"storageType",value:"sessionStorage",checked:xe==="sessionStorage",onChange:()=>De("sessionStorage"),style:{cursor:"pointer"}}),"Session Storage"]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",cursor:"pointer",color:"#ddd",fontSize:"13px"},children:[i.jsx("input",{type:"radio",name:"storageType",value:"localStorage",checked:xe==="localStorage",onChange:()=>De("localStorage"),style:{cursor:"pointer"}}),"Local Storage"]})]}),i.jsx("p",{style:{margin:"8px 0 0 0",color:xe==="sessionStorage"?"#4CAF50":"#ffaa00",fontSize:"12px",lineHeight:"1.4"},children:xe==="sessionStorage"?" Session Storage: API key is cleared when you close the browser tab (more secure)":" Local Storage: API key persists until you remove it (more convenient)"})]}),i.jsx("div",{style:{padding:"10px",background:"#1a1a1f",borderRadius:"4px",border:"1px solid #333"},children:i.jsxs("p",{style:{margin:"0",color:"#aaa",fontSize:"11px",lineHeight:"1.4"},children:[i.jsx("strong",{style:{color:"#ffaa00"},children:" Security:"})," API keys are stored in plain text in browser storage and are accessible via DevTools. Do not use on shared computers. Consider using API key restrictions from your provider."]})})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"8px"},children:[i.jsx("button",{onClick:Wt,disabled:!Ye,style:{padding:"8px 16px",background:Ye?"#d32f2f":"#444",color:"#fff",border:"1px solid #666",borderRadius:6,cursor:Ye?"pointer":"not-allowed",fontSize:"14px",fontWeight:600,opacity:Ye?1:.5},title:Ye?"Remove API key":"No API key stored",children:"Remove Key"}),i.jsxs("div",{style:{display:"flex",gap:"8px"},children:[i.jsx("button",{onClick:()=>{$(!1),U?.()},style:{padding:"8px 16px",background:"#555",color:"#fff",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Cancel"}),i.jsx("button",{onClick:()=>{St(),$(!1),U?.()},style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Save Settings"})]})]})]})}),i.jsx(Zy,{visible:Sn.visible,title:Sn.title,message:Sn.message,type:Sn.type,onClose:()=>{mn({visible:!1,title:"",message:"",type:"info"})},onShowResponse:Sn.onShowResponse})]});if(!tt)return console.error("[ComponentEditor] Component not found:",{componentId:n.id,componentsTopCount:s.length,componentsBottomCount:l.length}),null;if(!tt.id||!tt.componentType||typeof tt.pinCount!="number")return console.error("[ComponentEditor] Component missing required properties:",{componentId:tt.id,hasComponentType:!!tt.componentType,componentType:tt.componentType,pinCount:tt.pinCount,pinCountType:typeof tt.pinCount,component:tt}),null;let Gt="top";s.find(Me=>Me.id===n.id)||(Gt="bottom"),n.layer!==Gt&&o({...n,layer:Gt});const an=Me=>{const we={...Me};console.log("[ComponentEditor] updateComponent - Entry:",{componentId:Me.id,componentType:Me.componentType});const st=n.designator?.trim()||"";we.designator=st,we.x=n.x,we.y=n.y,we.layer=n.layer,we.orientation=n.orientation??0;const et=st.length>0?st.charAt(0).toUpperCase():dw(Me.componentType);if(we.abbreviation=et,n.manufacturer!==void 0&&(we.manufacturer=n.manufacturer?.trim()||void 0),n.partNumber!==void 0&&(we.partNumber=n.partNumber?.trim()||void 0),n.pinCount!==Me.pinCount){we.pinCount=n.pinCount;const Pt=Me.pinConnections||[];if(we.pinConnections=new Array(n.pinCount).fill("").map((Rt,Ge)=>Ge<Pt.length?Pt[Ge]:""),Me.pinPolarities){const Rt=Me.pinPolarities||[];we.pinPolarities=new Array(n.pinCount).fill("").map((Ge,zt)=>zt<Rt.length?Rt[zt]:"")}if(Me.pinData&&Array.isArray(Me.pinData)){const Rt=Me.pinData;we.pinData=new Array(n.pinCount).fill(null).map((Ge,zt)=>zt<Rt.length&&Rt[zt]?Rt[zt]:{name:""})}if(Me.pinNames){const Rt=Me.pinNames||[];we.pinNames=new Array(n.pinCount).fill("").map((Ge,zt)=>zt<Rt.length?Rt[zt]:"")}}else we.pinConnections=Me.pinConnections||[],Me.pinPolarities&&(we.pinPolarities=Me.pinPolarities),Me.pinData&&(we.pinData=Me.pinData),Me.pinNames&&(we.pinNames=Me.pinNames);return Me.componentType==="Resistor"?(we.resistance=n.resistance!==void 0?n.resistance:void 0,we.resistanceUnit=n.resistanceUnit!==void 0?n.resistanceUnit:void 0,we.power=n.power?`${n.power}W`:void 0,we.tolerance=n.tolerance!==void 0?n.tolerance:void 0):Me.componentType==="Capacitor"?(we.capacitance=n.capacitance!==void 0?n.capacitance:void 0,we.capacitanceUnit=n.capacitanceUnit!==void 0?n.capacitanceUnit:void 0,we.voltage=n.voltage!==void 0?n.voltage:void 0,we.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,we.tolerance=n.tolerance!==void 0?n.tolerance:void 0,we.dielectric=n.dielectric!==void 0?n.dielectric:void 0):Me.componentType==="Electrolytic Capacitor"?(we.capacitance=n.capacitance!==void 0?n.capacitance:void 0,we.capacitanceUnit=n.capacitanceUnit!==void 0?n.capacitanceUnit:void 0,we.voltage=n.voltage!==void 0?n.voltage:void 0,we.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,we.tolerance=n.tolerance!==void 0?n.tolerance:void 0,we.esr=n.esr!==void 0?n.esr:void 0,we.esrUnit=n.esrUnit!==void 0?n.esrUnit:void 0,we.temperature=n.temperature!==void 0?n.temperature:void 0):Me.componentType==="Film Capacitor"?(we.capacitance=n.capacitance!==void 0?n.capacitance:void 0,we.capacitanceUnit=n.capacitanceUnit!==void 0?n.capacitanceUnit:void 0,we.voltage=n.voltage!==void 0?n.voltage:void 0,we.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,we.tolerance=n.tolerance!==void 0?n.tolerance:void 0,we.filmType=n.filmType||void 0):Me.componentType==="Diode"?(we.diodeType=n.diodeType||Me.diodeType||"Standard",we.voltage=n.voltage!==void 0?n.voltage:void 0,we.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,we.current=n.current!==void 0?n.current:void 0,we.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0,we.ledColor=n.ledColor!==void 0?n.ledColor:void 0):Me.componentType==="Battery"?(we.voltage=n.voltage!==void 0?n.voltage:void 0,we.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,we.capacity=n.capacity!==void 0?n.capacity:void 0,we.capacityUnit=n.capacityUnit!==void 0?n.capacityUnit:void 0,we.chemistry=n.chemistry!==void 0?n.chemistry:void 0):Me.componentType==="Fuse"?(we.current=n.current!==void 0?n.current:void 0,we.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0,we.voltage=n.voltage!==void 0?n.voltage:void 0,we.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,we.fuseType=n.fuseType!==void 0?n.fuseType:void 0):Me.componentType==="FerriteBead"?(we.impedance=n.impedance!==void 0?n.impedance:void 0,we.impedanceUnit=n.impedanceUnit!==void 0?n.impedanceUnit:void 0,we.current=n.current!==void 0?n.current:void 0,we.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0):Me.componentType==="Connector"?(we.connectorType=n.connectorType||void 0,we.gender=n.gender||void 0):Me.componentType==="Jumper"?we.positions=n.positions||void 0:Me.componentType==="Relay"?(we.coilVoltage=n.coilVoltage!==void 0?n.coilVoltage:void 0,we.coilVoltageUnit=n.coilVoltageUnit!==void 0?n.coilVoltageUnit:void 0,we.contactType=n.contactType!==void 0?n.contactType:void 0,we.current=n.current!==void 0?n.current:void 0,we.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0):Me.componentType==="Inductor"?(we.inductance=n.inductance!==void 0?n.inductance:void 0,we.inductanceUnit=n.inductanceUnit!==void 0?n.inductanceUnit:void 0,we.current=n.current!==void 0?n.current:void 0,we.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0,we.resistance=n.resistance!==void 0?n.resistance:void 0,we.resistanceUnit=n.resistanceUnit!==void 0?n.resistanceUnit:void 0):Me.componentType==="Speaker"?(we.impedance=n.impedance!==void 0?n.impedance:void 0,we.impedanceUnit=n.impedanceUnit!==void 0?n.impedanceUnit:void 0,we.power=n.power?`${n.power}W`:void 0):Me.componentType==="Motor"?(we.motorType=n.motorType!==void 0?n.motorType:void 0,we.voltage=n.voltage!==void 0?n.voltage:void 0,we.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,we.current=n.current!==void 0?n.current:void 0,we.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0):Me.componentType==="PowerSupply"?(we.inputVoltage=n.inputVoltage!==void 0?n.inputVoltage:void 0,we.inputVoltageUnit=n.inputVoltageUnit!==void 0?n.inputVoltageUnit:void 0,we.outputVoltage=n.outputVoltage!==void 0?n.outputVoltage:void 0,we.outputVoltageUnit=n.outputVoltageUnit!==void 0?n.outputVoltageUnit:void 0,we.current=n.current!==void 0?n.current:void 0,we.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0):Me.componentType==="Transistor"?(we.transistorType=n.transistorType!==void 0?n.transistorType:void 0,we.polarity=n.polarity!==void 0?n.polarity:void 0,we.voltage=n.voltage!==void 0?n.voltage:void 0,we.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,we.current=n.current!==void 0?n.current:void 0,we.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0):Me.componentType==="ResistorNetwork"?(we.resistance=n.resistance!==void 0?n.resistance:void 0,we.resistanceUnit=n.resistanceUnit!==void 0?n.resistanceUnit:void 0,we.configuration=n.configuration||void 0):Me.componentType==="Thermistor"?(we.resistance=n.resistance!==void 0?n.resistance:void 0,we.resistanceUnit=n.resistanceUnit!==void 0?n.resistanceUnit:void 0,we.thermistorType=n.thermistorType||void 0,we.beta=n.beta||void 0):Me.componentType==="Switch"?(we.switchType=n.switchType!==void 0?n.switchType:void 0,we.current=n.current!==void 0?n.current:void 0,we.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0,we.voltage=n.voltage!==void 0?n.voltage:void 0,we.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0):Me.componentType==="Transformer"?(we.primaryVoltage=n.primaryVoltage!==void 0?n.primaryVoltage:void 0,we.primaryVoltageUnit=n.primaryVoltageUnit!==void 0?n.primaryVoltageUnit:void 0,we.secondaryVoltage=n.secondaryVoltage!==void 0?n.secondaryVoltage:void 0,we.secondaryVoltageUnit=n.secondaryVoltageUnit!==void 0?n.secondaryVoltageUnit:void 0,we.power=n.power?`${n.power}W`:void 0,we.turns=n.turns||void 0):Me.componentType==="TestPoint"?we.signal=n.signal||void 0:Me.componentType==="Film Capacitor"?(we.capacitance=n.capacitance!==void 0?n.capacitance:void 0,we.capacitanceUnit=n.capacitanceUnit!==void 0?n.capacitanceUnit:void 0,we.voltage=n.voltage!==void 0?n.voltage:void 0,we.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,we.tolerance=n.tolerance!==void 0?n.tolerance:void 0,we.filmType=n.filmType||void 0):Me.componentType==="IntegratedCircuit"||Me.componentType==="Semiconductor"?(we.description=n.description?.trim()||void 0,Me.componentType==="Semiconductor"&&(we.componentType="IntegratedCircuit"),we.icType=n.icType||void 0,we.manufacturer=n.manufacturer?.trim()||void 0,we.partNumber=n.partNumber?.trim()||void 0,we.operatingTemperature=n.operatingTemperature?.trim()||void 0,we.packageType=n.packageType||void 0,n.datasheetFileName?we.datasheetFileName=n.datasheetFileName:we.datasheetFileName=void 0):we.description=n.description?.trim()||void 0,Me.componentType==="VacuumTube"?we.tubeType=n.tubeType||void 0:Me.componentType==="VariableResistor"?(we.vrType=n.vrType!==void 0?n.vrType:void 0,we.resistance=n.resistance!==void 0?n.resistance:void 0,we.resistanceUnit=n.resistanceUnit!==void 0?n.resistanceUnit:void 0,we.power=n.power?`${n.power}W`:void 0,we.taper=n.taper||void 0):Me.componentType==="Crystal"?(we.frequency=n.frequency!==void 0?n.frequency:void 0,we.loadCapacitance=n.loadCapacitance!==void 0?n.loadCapacitance:void 0,we.tolerance=n.tolerance!==void 0?n.tolerance:void 0):Me.componentType==="GenericComponent"&&(we.genericType=n.genericType||"Attenuator",we.voltage=n.voltage!==void 0?n.voltage:void 0,we.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,we.current=n.current!==void 0?n.current:void 0,we.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0,we.power=n.power||void 0,we.frequency=n.frequency||void 0,we.model=n.model||void 0),we},dt=()=>{if(P){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const Me=s.find(et=>et.id===n.id),we=l.find(et=>et.id===n.id),st=Me||we;if(st){st.componentType==="IntegratedCircuit"&&console.log("[ComponentEditor] handleSave - Before updateComponent call:",{componentDatasheet:st.datasheet,editorDatasheet:n.datasheet,editorDatasheetType:typeof n.datasheet,editorDatasheetLength:n.datasheet?.length,fullEditor:n}),console.log("[ComponentEditor] handleSave - componentEditor state before update:",{resistance:n.resistance,resistanceUnit:n.resistanceUnit,capacitance:n.capacitance,capacitanceUnit:n.capacitanceUnit,componentType:st.componentType});const et=an(st);console.log("[ComponentEditor] handleSave - updatedComp after save:",{resistance:et.resistance,resistanceUnit:et.resistanceUnit,capacitance:et.capacitance,capacitanceUnit:et.capacitanceUnit,componentType:et.componentType}),st.componentType==="IntegratedCircuit"&&console.log("[ComponentEditor] handleSave - After updateComponent call:",{updatedComponentDatasheet:et.datasheet,updatedComponentDatasheetType:typeof et.datasheet});const Pt=st.layer,Rt=n.layer;Pt!==Rt?Pt==="top"?(d(Ge=>Ge.filter(zt=>zt.id!==n.id)),b(Ge=>[...Ge,et])):(b(Ge=>Ge.filter(zt=>zt.id!==n.id)),d(Ge=>[...Ge,et])):Rt==="top"?d(Ge=>{const zt=Ge.map(tn=>tn.id===n.id?(console.log("[ComponentEditor] Updating component in top array - datasheet:",et.datasheet),(et.componentType==="Resistor"||et.componentType==="Capacitor")&&console.log("[ComponentEditor] Updated component values:",{resistance:et.resistance,resistanceUnit:et.resistanceUnit,capacitance:et.capacitance,capacitanceUnit:et.capacitanceUnit}),et):tn),Tt=zt.find(tn=>tn.id===n.id);return Tt&&(Tt.componentType==="IntegratedCircuit"&&console.log("[ComponentEditor] After state update - component datasheet in array:",Tt.datasheet),(Tt.componentType==="Resistor"||Tt.componentType==="Capacitor")&&console.log("[ComponentEditor] After state update - component values in array:",{resistance:Tt.resistance,resistanceUnit:Tt.resistanceUnit,capacitance:Tt.capacitance,capacitanceUnit:Tt.capacitanceUnit})),zt}):b(Ge=>{const zt=Ge.map(tn=>tn.id===n.id?(console.log("[ComponentEditor] Updating component in bottom array - datasheet:",et.datasheet),(et.componentType==="Resistor"||et.componentType==="Capacitor")&&console.log("[ComponentEditor] Updated component values:",{resistance:et.resistance,resistanceUnit:et.resistanceUnit,capacitance:et.capacitance,capacitanceUnit:et.capacitanceUnit}),et):tn),Tt=zt.find(tn=>tn.id===n.id);return Tt&&(Tt.componentType==="IntegratedCircuit"&&console.log("[ComponentEditor] After state update - component datasheet in array:",Tt.datasheet),(Tt.componentType==="Resistor"||Tt.componentType==="Capacitor")&&console.log("[ComponentEditor] After state update - component values in array:",{resistance:Tt.resistance,resistanceUnit:Tt.resistanceUnit,capacitance:Tt.capacitance,capacitanceUnit:Tt.capacitanceUnit})),zt})}else if(console.warn(`Component ${n.id} not found in either layer array`),n.layer==="top"){const et=l.find(Pt=>Pt.id===n.id);if(et){const Pt=an(et);b(Rt=>Rt.filter(Ge=>Ge.id!==n.id)),d(Rt=>[...Rt,Pt])}}else{const et=s.find(Pt=>Pt.id===n.id);if(et){const Pt=an(et);d(Rt=>Rt.filter(Ge=>Ge.id!==n.id)),b(Rt=>[...Rt,Pt])}}o(null),v(null)},Mt=async()=>{if(!Xc().hasApiKey()){$(!0);return}const we=tt?.datasheetFileName;if(!O&&(!ae||!we)){mn({visible:!0,title:"Datasheet Required",message:"Please choose a datasheet file before extracting information.",type:"info"});return}te(!0);try{let st,et;if(O)st=await O.arrayBuffer(),et=O.size;else if(ae&&we){const ut=we.split("/");let Et=ae;for(let Vn=0;Vn<ut.length-1;Vn++){const Ti=ut[Vn];try{Et=await Et.getDirectoryHandle(Ti)}catch{const mr=Ti==="datasheets"?"Datasheets":Ti==="Datasheets"?"datasheets":Ti;try{Et=await Et.getDirectoryHandle(mr)}catch{throw new Error(`Directory '${Ti}' not found in project folder.`)}}}const Zt=await(await Et.getFileHandle(ut[ut.length-1])).getFile();st=await Zt.arrayBuffer(),et=Zt.size}else throw new Error("No datasheet file available");const Pt=20*1024*1024;if(et>Pt){const ut=(et/1048576).toFixed(2);throw new Error(`PDF file is too large (${ut} MB). Maximum file size is 20 MB. Please use a smaller file or split the datasheet.`)}const Rt=await new Promise((ut,Et)=>{const En=new Blob([st],{type:"application/pdf"}),Zt=new FileReader;Zt.onloadend=()=>{const Ti=Zt.result.split(",")[1];if(!Ti){Et(new Error("Failed to extract base64 data from FileReader result"));return}ut(Ti)},Zt.onerror=()=>Et(new Error("FileReader failed to read PDF file")),Zt.readAsDataURL(En)}),zt=(n.layer==="top"?s:l).find(ut=>ut.id===n.id);if(!zt)throw new Error("Component not found");const Xt=((r||ll(zt))?.fields||[]).filter(ut=>ut.name!=="datasheet").map(ut=>({name:ut.name,label:ut.label,type:ut.type,hasUnits:!!(ut.units&&ut.units.length>0),units:ut.units||[]}));let pn;const ti=zt.customGeminiPrompt;ti&&ti.trim()?pn=ti:pn=_t(Xt);const Go=Xc(),zn=Us[df().provider],Bi=await Go.extractFromPDF({prompt:pn,pdfBase64:Rt,mimeType:"application/pdf"});if(!Bi.success)throw ee(null),new Error(Bi.error||`${zn.name} API error`);let ni=Bi.text||"";if(!ni)throw ee(null),new Error(`No response text from ${zn.name} API. The API may have returned an empty response.`);ee(ni),ni=ni.replace(/^```[\w]*\n?/gm,"").replace(/\n?```$/gm,"");let xi;try{xi=JSON.parse(ni)}catch(ut){throw new Error(`Failed to parse JSON response from Gemini API: ${ut instanceof Error?ut.message:"Unknown error"}`)}if(!xi||typeof xi!="object")throw new Error("Invalid JSON response from Gemini API: expected an object");let hi=n.pinCount;if(xi.properties&&typeof xi.properties=="object"&&xi.properties.pinCount){const ut=parseInt(String(xi.properties.pinCount),10);!isNaN(ut)&&ut>0&&(hi=ut)}else if(xi.pins&&Array.isArray(xi.pins)){let ut=0;for(const Et of xi.pins)if(Et&&typeof Et=="object"&&Et.pinNumber){const En=parseInt(String(Et.pinNumber),10);!isNaN(En)&&En>ut&&(ut=En)}ut>0&&(hi=ut)}const fr=new Array(hi).fill(null).map(()=>({name:""}));let zr=0;if(xi.pins&&Array.isArray(xi.pins)){for(const ut of xi.pins)if(ut&&typeof ut=="object"&&ut.pinNumber&&ut.pinName){const Et=parseInt(String(ut.pinNumber),10);if(!isNaN(Et)&&Et>=1&&Et<=hi){const En=Et-1;fr[En]={name:String(ut.pinName).trim(),type:ut.pinType&&String(ut.pinType).trim()?String(ut.pinType).trim():void 0,alternate_functions:ut.alternateFunctions&&Array.isArray(ut.alternateFunctions)&&ut.alternateFunctions.length>0?ut.alternateFunctions.map(Zt=>String(Zt).trim()).filter(Zt=>Zt!==""):void 0},zr++}}}if(zr===0)throw new Error("Could not parse any pin information from the JSON response.");const or=fr.map(ut=>ut.name),xt={...n};let Yn=0;const ui=[];if(hi!==n.pinCount&&(xt.pinCount=hi,ui.push({label:"Pin Count",value:String(hi)}),Yn++),xi.properties&&typeof xi.properties=="object"){const ut=xi.properties;for(const Et of Xt)if(ut.hasOwnProperty(Et.name)){const En=ut[Et.name];if(En!=null&&En!==""){let Zt="";if(Et.hasUnits){xt[Et.name]=String(En);const Vn=`${Et.name}Unit`;let Ti="";if(ut.hasOwnProperty(Vn)){const _i=String(ut[Vn]).trim();Et.units.includes(_i)?(xt[Vn]=_i,Ti=_i):Et.units.length>0&&(xt[Vn]=Et.units[0],Ti=Et.units[0])}else Et.units.length>0&&(xt[Vn]=Et.units[0],Ti=Et.units[0]);Zt=`${En} ${Ti}`.trim()}else xt[Et.name]=String(En),Zt=String(En);ui.push({label:Et.label,value:Zt}),Yn++}}if(ut.hasOwnProperty("icType")&&ut.icType){const Et=String(ut.icType).trim();["Op-Amp","Microcontroller","Microprocessor","Logic","Memory","Voltage Regulator","Timer","ADC","DAC","Comparator","Transceiver","Driver","Amplifier","Other"].includes(Et)&&(xt.icType=Et,ui.push({label:"IC Type",value:Et}),Yn++)}if(ut.hasOwnProperty("packageType")&&ut.packageType){const Et=String(ut.packageType).trim(),En=["DIP","PDIP","SOIC","QFP","LQFP","TQFP","BGA","SSOP","TSOP","Various","Other"];let Zt=Et;if(Et.toUpperCase()==="PDIP"||Et.toUpperCase()==="DIP")Et.includes(",")||Et.includes(" or ")||Et.includes(" and ")?Zt="Various":Et.toUpperCase().includes("PDIP")?Zt="PDIP":Zt="DIP";else if(En.includes(Et))Zt=Et;else if(Et.includes(",")||Et.includes(" or ")||Et.includes(" and "))Zt="Various";else{const Vn=Et.toUpperCase();Vn.includes("LQFP")?Zt="LQFP":Vn.includes("TQFP")?Zt="TQFP":Vn.includes("QFP")?Zt="QFP":Vn.includes("SOIC")?Zt="SOIC":Vn.includes("BGA")?Zt="BGA":Vn.includes("SSOP")?Zt="SSOP":Vn.includes("TSOP")?Zt="TSOP":Zt="Other"}(En.includes(Zt)||Zt==="Various")&&(xt.packageType=Zt,ui.push({label:"Package Type",value:Zt}),Yn++)}}let Si="";if(xi.summary&&typeof xi.summary=="object"&&xi.summary.datasheetSummary&&(Si=String(xi.summary.datasheetSummary).trim(),Si)){xt.notes=Si;const ut=Si.length>100?Si.substring(0,100)+"...":Si;ui.push({label:"Notes",value:ut}),Yn++}if(o(xt),zt){const ut=zt.pinConnections||[],Et=new Array(hi).fill("").map((Ci,_n)=>_n<ut.length?ut[_n]:""),En=zt.pinPolarities||[],Zt=new Array(hi).fill("").map((Ci,_n)=>_n<En.length?En[_n]:""),Vn=[...fr];for(;Vn.length<hi;)Vn.push({name:""});const Ti=Vn.map(Ci=>Ci.name),_i={...zt,pinData:Vn,pinNames:Ti,pinCount:hi,pinConnections:Et,pinPolarities:Zt,...Si&&{notes:Si}};console.log("[AI Extraction] Saving pin data to component:",{componentId:n.id,layer:n.layer,pinData:Vn,pinNames:Ti,pinCount:hi}),n.layer==="top"?d(Ci=>Ci.map(_n=>_n.id===n.id?_i:_n)):b(Ci=>Ci.map(_n=>_n.id===n.id?_i:_n));const mr=or.filter(Ci=>Ci.length>0).length;let mi=`Extracted ${mr} pin name${mr!==1?"s":""}`;hi!==n.pinCount&&(mi+=" and pin count"),Yn>0&&(mi+=` and ${Yn} propert${Yn===1?"y":"ies"}`),mi+=" from datasheet.",ui.length>0&&(mi+=`

Extracted Properties:`,ui.forEach(Ci=>{mi+=`
   ${Ci.label}: ${Ci.value}`}));const pr=[];or.forEach((Ci,_n)=>{Ci&&Ci.trim()&&pr.push(`Pin ${_n+1}: ${Ci.trim()}`)}),pr.length>0&&(mi+=`

Pin Names:`,mi+=`
  `+pr.join(", ")),mn({visible:!0,title:"Extraction Complete",message:mi,type:"success"}),ee(null)}}catch(st){console.error("Error fetching pin names:",st),mn({visible:!0,title:"Extraction Failed",message:`Failed to extract information: ${st instanceof Error?st.message:"Unknown error"}. Please enter pin names manually.`,type:"info",onShowResponse:je?()=>Ne(!0):void 0})}finally{te(!1)}};return i.jsxs(i.Fragment,{children:[i.jsx("style",{children:`
        @keyframes heartbeat {
          0%, 100% {
            transform: scale(1);
            box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.8);
          }
          50% {
            transform: scale(1.15);
            box-shadow: 0 0 0 8px rgba(76, 175, 80, 0);
          }
        }
        .fetch-pin-names-pulse {
          animation: heartbeat 0.8s ease-in-out infinite;
        }
      `}),i.jsxs("div",{"data-component-editor-dialog":!0,onClick:Me=>{if(p&&p.componentId===tt.id){const we=Me.target;(we.tagName==="BUTTON"||we.tagName==="INPUT"||we.closest("button")||we.closest("input"))&&Me.stopPropagation()}},style:{position:"fixed",top:m?`${m.y}px`:"90px",left:m?`${m.x}px`:`${window.innerWidth-280}px`,transform:"none",background:p&&p.componentId===tt.id?"rgba(255, 255, 255, 0.95)":"#fff",border:"1px solid #0b5fff",borderRadius:4,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"350px",width:`${qt.width}px`,height:`${qt.height}px`,maxHeight:`${window.innerHeight-20}px`,display:"flex",flexDirection:"column",pointerEvents:"auto",cursor:_?"grabbing":"default"},children:[i.jsxs("div",{onMouseDown:Me=>{const we=Me.target;we.tagName==="BUTTON"||we.tagName==="INPUT"||we.closest("button")||we.closest("input")||m&&(F({x:Me.clientX-m.x,y:Me.clientY-m.y}),M(!0),Me.preventDefault())},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:_?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[i.jsx("h3",{style:{margin:0,fontSize:"13px",color:"#fff",fontWeight:600},children:"Component Properties"}),i.jsx("button",{onClick:()=>{o(null),v(null)},style:{background:"transparent",border:"none",fontSize:"15px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsxs("div",{className:"component-editor-content",style:{display:"flex",flexDirection:"column",gap:"4px",padding:"6px 20px 6px 6px",overflowY:"auto",overflowX:"hidden",flex:1,minHeight:0,scrollbarWidth:"thin",scrollbarColor:"#888 #f0f0f0"},children:[(()=>{const Me=r||ll(tt);return i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Category:"}),i.jsx("div",{style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"11px",color:"#000"},children:Me?.category||"N/A"})]})})(),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Type:"}),i.jsx("div",{style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"11px",color:"#000"},children:(()=>{const Me=r||ll(tt);return Me?.displayName?tt.componentType==="Capacitor"&&!Me.displayName.toLowerCase().includes("capacitor")?`${Me.displayName} Capacitor`:Me.displayName:tt.componentType==="GenericComponent"&&tt.genericType?Wl(tt.genericType):tt.componentType==="Diode"&&tt.diodeType&&tt.diodeType!=="Standard"?Wl(tt.diodeType):tt.componentType==="VariableResistor"&&tt.vrType&&tt.vrType!=="Potentiometer"?Wl(tt.vrType):tt.componentType==="Capacitor"&&tt.dielectric==="Tantalum"?"Tantalum Capacitor":tt.componentType==="Capacitor"&&tt.capacitorType==="Electrolytic"?"Electrolytic Capacitor":tt.componentType==="Capacitor"&&tt.capacitorType==="Film"?"Film Capacitor":Wl(tt.componentType)})()})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-layer-${tt.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Layer:"}),i.jsxs("select",{id:`component-layer-${tt.id}`,name:`component-layer-${tt.id}`,value:n.layer,onChange:Me=>o({...n,layer:Me.target.value}),disabled:P,style:{width:"80px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:P?.6:1},children:[i.jsx("option",{value:"top",children:"Top"}),i.jsx("option",{value:"bottom",children:"Bottom"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-designator-${tt.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Designator:"}),i.jsx("input",{id:`component-designator-${tt.id}`,name:`component-designator-${tt.id}`,type:"text",value:n.designator||"",onChange:Me=>{const we=Me.target.value,st=we.length>0?we.charAt(0).toUpperCase():n.abbreviation;o({...n,designator:we,abbreviation:st})},disabled:P,style:{width:"80px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",fontFamily:"monospace",textTransform:"uppercase",opacity:P?.6:1},placeholder:"e.g., U2, R7, C1",onKeyDown:Me=>{Me.key==="Enter"&&!P&&(Me.preventDefault(),Ot())}}),i.jsx("button",{onClick:Ot,disabled:P||!n.designator?.trim(),style:{padding:"4px 12px",background:P||!n.designator?.trim()?"#ccc":"linear-gradient(90deg, #7B68EE 0%, #6A5ACD 100%)",color:"#fff",border:"none",borderRadius:"4px",fontSize:"11px",fontWeight:600,cursor:P||!n.designator?.trim()?"not-allowed":"pointer",opacity:P||!n.designator?.trim()?.6:1,textShadow:"0 1px 2px rgba(0, 0, 0, 0.3)",whiteSpace:"nowrap"},title:"Find all components with this designator",children:"Find"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-orientation-${tt.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Orientation:"}),i.jsxs("select",{id:`component-orientation-${tt.id}`,name:`component-orientation-${tt.id}`,value:n.orientation??0,onChange:Me=>{const we=parseInt(Me.target.value)||0;if(o({...n,orientation:we}),!P){const et=(n.layer==="top"?s:l).find(Pt=>Pt.id===n.id);if(et){const Pt={...et,orientation:we};n.layer==="top"?d(Rt=>Rt.map(Ge=>Ge.id===n.id?Pt:Ge)):b(Rt=>Rt.map(Ge=>Ge.id===n.id?Pt:Ge))}}},disabled:P,style:{width:"70px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:P?.6:1},children:[i.jsx("option",{value:"0",children:"0"}),i.jsx("option",{value:"90",children:"90"}),i.jsx("option",{value:"180",children:"180"}),i.jsx("option",{value:"270",children:"270"})]})]}),(tt.componentType==="IntegratedCircuit"||tt.componentType==="Semiconductor")&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsx("label",{htmlFor:`component-datasheet-${tt.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Datasheet:"}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px",flex:1},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",flexWrap:"wrap",flex:1},children:[i.jsx("input",{id:`component-datasheet-file-${tt.id}`,type:"file",accept:".pdf",onChange:async Me=>{const we=Me.target.files?.[0]||null;if(we){W(we);let st=we.name;if(ae)try{let et;try{et=await ae.getDirectoryHandle("datasheets",{create:!0})}catch(Ge){console.error("Failed to get/create datasheets directory:",Ge),et=ae}const Rt=await(await et.getFileHandle(we.name,{create:!0})).createWritable();await Rt.write(await we.arrayBuffer()),await Rt.close(),st=et===ae?we.name:`datasheets/${we.name}`}catch(et){console.error("Failed to copy datasheet to project directory:",et)}o({...n,datasheetFileName:st})}else W(null),o({...n,datasheetFileName:void 0})},disabled:P,style:{position:"absolute",width:"0.1px",height:"0.1px",opacity:0,overflow:"hidden",zIndex:-1}}),i.jsx("label",{htmlFor:`component-datasheet-file-${tt.id}`,style:{display:"inline-block",padding:"2px 6px",background:P?"#ccc":"#4CAF50",border:"none",borderRadius:2,fontSize:"11px",color:"#fff",cursor:P?"not-allowed":"pointer",opacity:P?.6:1,whiteSpace:"nowrap",flex:"0 0 auto"},children:"Choose File"}),(()=>{const Me=tt?.datasheetFileName,we=O?.name||(Me?Me.split("/").pop():null),st=!!O;return we?st?i.jsx("a",{href:"#",onClick:et=>{et.preventDefault(),et.stopPropagation();try{const Pt=O,Rt=URL.createObjectURL(Pt),Ge=window.open(Rt,"_blank","noopener,noreferrer");if(!Ge||Ge.closed){URL.revokeObjectURL(Rt);const zt=document.createElement("a"),Tt=URL.createObjectURL(Pt);zt.href=Tt,zt.target="_blank",zt.rel="noopener noreferrer",document.body.appendChild(zt),zt.click(),document.body.removeChild(zt)}}catch(Pt){console.error("Error opening datasheet:",Pt),alert("Failed to open datasheet file.")}},style:{fontSize:"11px",color:"#0066cc",whiteSpace:"nowrap",textDecoration:"underline",cursor:"pointer",flex:"0 0 auto"},title:"Click to open PDF in new window",children:we}):i.jsxs("span",{style:{fontSize:"11px",color:"#666",flex:"0 0 auto",fontStyle:"italic"},title:"Re-choose the datasheet file to open it",children:[we," (re-choose file to open)"]}):i.jsx("span",{style:{fontSize:"11px",color:"#666",flex:"0 0 auto"},children:"No file chosen"})})()]}),i.jsx("div",{style:{display:"flex",alignItems:"center",gap:"4px",marginTop:"4px"},children:i.jsx("button",{onClick:()=>{if(n&&tt){const we=(n.layer==="top"?s:l).find(st=>st.id===n.id);if(we){const Pt=((r||ll(we))?.fields||[]).filter(Ge=>Ge.name!=="datasheet").map(Ge=>({name:Ge.name,label:Ge.label,type:Ge.type,hasUnits:!!(Ge.units&&Ge.units.length>0),units:Ge.units||[]})),Rt=we.customGeminiPrompt;if(Rt&&Rt.trim())w(Rt);else{const Ge=_t(Pt);w(Ge)}}}$e(!0)},disabled:P,style:{padding:"3px 8px",fontSize:"11px",background:P?"#ccc":"#0066cc",color:"#fff",border:"none",borderRadius:"3px",cursor:P?"not-allowed":"pointer",opacity:P?.6:1,fontWeight:600,whiteSpace:"nowrap",transition:"background 0.2s"},title:"View and edit the AI prompt that will be sent to Gemini",children:"View/Edit Prompt"})}),i.jsx("div",{style:{display:"flex",alignItems:"center",gap:"4px",marginTop:"4px"},children:i.jsx("button",{onClick:Mt,disabled:G||P,className:G?"fetch-pin-names-pulse":"",style:{padding:"3px 8px",fontSize:"11px",background:P?"#ccc":"#4CAF50",color:"#fff",border:"none",borderRadius:"3px",cursor:G||P?"not-allowed":"pointer",opacity:P?.6:1,fontWeight:600,whiteSpace:"nowrap",transition:"background 0.2s"},children:G?"Extracting...":"Extract Datasheet Information"})})]})]}),(tt.componentType==="IntegratedCircuit"||tt.componentType==="Semiconductor")&&i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid #e0e0e0",fontSize:"11px",fontWeight:600,color:"#000",marginBottom:"4px"},children:"IC Properties:"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsx("label",{htmlFor:`component-manufacturer-ic-${tt.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Manufacturer:"}),i.jsx("input",{id:`component-manufacturer-ic-${tt.id}`,type:"text",value:n.manufacturer||"",onChange:Me=>o({...n,manufacturer:Me.target.value}),disabled:P,style:{width:"150px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:P?.6:1}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsx("label",{htmlFor:`component-partnumber-ic-${tt.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Part Number:"}),i.jsx("input",{id:`component-partnumber-ic-${tt.id}`,type:"text",value:n.partNumber||"",onChange:Me=>o({...n,partNumber:Me.target.value}),disabled:P,style:{width:"150px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:P?.6:1}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsx("label",{htmlFor:`component-pincount-ic-${tt.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Pin Count:"}),i.jsx("input",{id:`component-pincount-ic-${tt.id}`,name:`component-pincount-ic-${tt.id}`,type:"number",min:"1",value:n.pinCount,onChange:Me=>{const we=Math.max(1,parseInt(Me.target.value)||1);o({...n,pinCount:we})},onBlur:Me=>{if(P){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const we=Math.max(1,parseInt(Me.target.value)||1),et=(n.layer==="top"?s:l).find(Pt=>Pt.id===n.id);if(et&&we!==et.pinCount){const Pt=et.pinConnections||[],Rt=new Array(we).fill("").map((tn,Xt)=>Xt<Pt.length?Pt[Xt]:""),Ge=et.pinPolarities||[],zt=et.pinPolarities?new Array(we).fill("").map((tn,Xt)=>Xt<Ge.length?Ge[Xt]:""):void 0,Tt={...et,pinCount:we,pinConnections:Rt,...zt!==void 0&&{pinPolarities:zt}};n.layer==="top"?d(tn=>tn.map(Xt=>Xt.id===n.id?Tt:Xt)):b(tn=>tn.map(Xt=>Xt.id===n.id?Tt:Xt)),o({...n,pinCount:we})}},disabled:P,style:{width:"80px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:P?.6:1}})]})]})]}),i.jsx(uw,{component:tt,componentEditor:n,componentDefinition:r,setComponentEditor:o,areComponentsLocked:P,componentsTop:s,componentsBottom:l,uploadedDatasheetFile:O,setUploadedDatasheetFile:W,setComponentsTop:d,setComponentsBottom:b}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-description-${tt.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Description:"}),i.jsx("input",{id:`component-description-${tt.id}`,name:`component-description-${tt.id}`,type:"text",value:n.description||"",onChange:Me=>{o({...n,description:Me.target.value})},disabled:P,style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:P?.6:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},placeholder:"",title:n.description||""})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-notes-${tt.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Notes:"}),i.jsx("input",{id:`component-notes-${tt.id}`,name:`component-notes-${tt.id}`,type:"text",readOnly:!0,value:tt.notes||"",onClick:()=>{P||(k(new Set([tt.id])),y(!0))},disabled:P,style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:P?.6:1,cursor:P?"not-allowed":"pointer",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},placeholder:"Click to edit notes...",title:tt.notes||"Click to edit notes..."})]}),(tt.componentType==="IntegratedCircuit"||tt.componentType==="Semiconductor")&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-operatingTemperature-${tt.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Operating Temperature:"}),i.jsx("input",{id:`component-operatingTemperature-${tt.id}`,name:`component-operatingTemperature-${tt.id}`,type:"text",value:n.operatingTemperature||"",onChange:Me=>{o({...n,operatingTemperature:Me.target.value})},disabled:P,style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:P?.6:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},placeholder:"",title:n.operatingTemperature||""})]}),tt.componentType!=="IntegratedCircuit"&&tt.componentType!=="Semiconductor"&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-pincount-${tt.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Pin Count:"}),i.jsx("input",{id:`component-pincount-${tt.id}`,name:`component-pincount-${tt.id}`,type:"number",min:"1",value:n.pinCount,onChange:Me=>{const we=Math.max(1,parseInt(Me.target.value)||1);o({...n,pinCount:we})},onBlur:Me=>{if(P){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const we=Math.max(1,parseInt(Me.target.value)||1),et=(n.layer==="top"?s:l).find(Pt=>Pt.id===n.id);if(et&&we!==et.pinCount){const Pt=et.pinConnections||[],Rt=new Array(we).fill("").map((tn,Xt)=>Xt<Pt.length?Pt[Xt]:""),Ge=et.pinPolarities||[],zt=et.pinPolarities?new Array(we).fill("").map((tn,Xt)=>Xt<Ge.length?Ge[Xt]:""):void 0,Tt={...et,pinCount:we,pinConnections:Rt,...zt!==void 0&&{pinPolarities:zt}};n.layer==="top"?d(tn=>tn.map(Xt=>Xt.id===n.id?Tt:Xt)):b(tn=>tn.map(Xt=>Xt.id===n.id?Tt:Xt)),o({...n,pinCount:we})}},disabled:P,style:{width:"60px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:P?.6:1}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-x-${tt.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"X:"}),i.jsx("input",{id:`component-x-${tt.id}`,name:`component-x-${tt.id}`,type:"number",value:n.x.toFixed(2),onChange:Me=>{const we=parseFloat(Me.target.value)||0;o({...n,x:we})},disabled:P,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:P?.6:1}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-y-${tt.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Y:"}),i.jsx("input",{id:`component-y-${tt.id}`,name:`component-y-${tt.id}`,type:"number",value:n.y.toFixed(2),onChange:Me=>{const we=parseFloat(Me.target.value)||0;o({...n,y:we})},disabled:P,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:P?.6:1}})]}),i.jsxs("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid #e0e0e0"},children:[i.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:600,color:"#333",marginBottom:"2px"},children:"Pin Connections:"}),p&&p.componentId===tt.id&&i.jsxs("div",{style:{padding:"2px 3px",background:"#fff3cd",border:"1px solid #ffc107",borderRadius:2,marginBottom:"2px",fontSize:"11px",color:"#856404"},children:["Pin ",p.pinIndex+1," selected. Click on a via or pad to connect."]}),(()=>{const Me=op(tt),st=(n.layer==="top"?s:l).find(Bi=>Bi.id===n.id),et=st?.pinData,Pt=st?.pinNames;console.log("[ComponentEditor] Pin data debug:",{componentId:n.id,hasInstancePinData:!!et,instancePinDataLength:et?.length,instancePinData:et,hasInstancePinNames:!!Pt,instancePinNamesLength:Pt?.length,instancePinNames:Pt});const Ge=(r||ll(tt))?.properties?.pinNames,zt=Ge&&Ge.length>0,Tt=et&&et.length>0||Pt&&Pt.length>0,tn=zt&&Ge.includes("CHIP_DEPENDENT"),Xt=zt&&!tn,pn=tn||!zt&&Tt,ti=zt||Tt,Go=et&&et.some(Bi=>Bi&&Bi.type&&Bi.type.trim()!==""),zn=et&&et.some(Bi=>Bi&&Bi.alternate_functions&&Bi.alternate_functions.length>0);return i.jsx("div",{children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px",marginTop:"2px"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{borderBottom:"1px solid #ddd",background:"#f5f5f5"},children:[i.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333",width:"20px"}}),i.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333",width:"40px"},children:"Pin"}),ti&&i.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333",width:"70px"},children:"Pin Name"}),Go&&i.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333",width:"80px"},children:"Type"}),zn&&i.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333",width:"120px"},children:"Alt Functions"}),Me&&i.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333",width:"50px"},children:"Polarity"}),i.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333"},children:"Node ID"})]})}),i.jsx("tbody",{children:Array.from({length:n.pinCount},(Bi,ni)=>{const nn=st?.pinConnections&&st.pinConnections.length>ni?st.pinConnections[ni]:"",xi=st?.pinPolarities&&st.pinPolarities.length>ni&&st.pinPolarities[ni]||"",hi=et&&ni<et.length&&et[ni]?et[ni]:null,fr=hi?.name||(Pt&&ni<Pt.length?Pt[ni]:""),zr=Ge&&ni<Ge.length?Ge[ni]:"",or=zr==="CHIP_DEPENDENT",xt=fr&&fr.trim()!==""?fr:or?"":zr,Yn=hi?.type,ui=hi?.alternate_functions,Si=p&&p.componentId===tt.id&&p.pinIndex===ni;return i.jsxs("tr",{style:{cursor:P?"not-allowed":"pointer",background:Si?"#e6f0ff":nn?"#d4edda":"#fff",borderBottom:"1px solid #eee"},onClick:ut=>{if(ut.target.tagName!=="SELECT"){if(P){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}v(Si?null:{componentId:tt.id,pinIndex:ni})}},title:nn?`Connected to: ${nn}`:"Select this pin, then click on a via or pad to connect",children:[i.jsx("td",{style:{padding:"2px 4px",textAlign:"center"},children:i.jsx("input",{id:`pin-radio-${tt.id}-${ni}`,name:`pin-radio-${tt.id}`,type:"radio",checked:!!Si,onChange:()=>{if(P){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}v(Si?null:{componentId:tt.id,pinIndex:ni})},disabled:P,style:{margin:0,cursor:P?"not-allowed":"pointer",opacity:P?.6:1,width:"10px",height:"10px"}})}),i.jsx("td",{style:{padding:"2px 4px",color:"#333",fontWeight:Si?600:400,fontFamily:"monospace"},children:ni+1}),(Xt||pn)&&i.jsx("td",{style:{padding:"2px 4px",textAlign:"left"},children:Xt?i.jsx("select",{value:xt||"",onChange:ut=>{if(P){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const Et=ut.target.value,Zt=(n.layer==="top"?s:l).find(Vn=>Vn.id===n.id);if(Zt){const Ti=[...Zt.pinNames||(Ge?[...Ge]:[])];for(;Ti.length<n.pinCount;)Ti.push("");Ti[ni]=Et;const _i={...Zt,pinNames:Ti};n.layer==="top"?d(mr=>mr.map(mi=>mi.id===n.id?_i:mi)):b(mr=>mr.map(mi=>mi.id===n.id?_i:mi))}},disabled:P,onClick:ut=>ut.stopPropagation(),onFocus:ut=>ut.stopPropagation(),style:{padding:"2px 4px",fontSize:"11px",border:"1px solid #ddd",borderRadius:2,background:"#fff",color:"#333",cursor:P?"not-allowed":"pointer",opacity:P?.6:1,width:"100%",fontStyle:"italic",minHeight:"18px"},children:Ge&&Ge.length>0?Ge.filter(ut=>ut!=="CHIP_DEPENDENT").map((ut,Et)=>i.jsx("option",{value:ut,children:ut},Et)):i.jsx("option",{value:"",children:"-"})}):i.jsx("input",{type:"text",value:xt||"",onChange:ut=>{if(P){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const Et=ut.target.value,Zt=(n.layer==="top"?s:l).find(Vn=>Vn.id===n.id);if(Zt){const Vn=Zt.pinData,Ti=Zt.pinNames||[];let _i;for(Vn&&Array.isArray(Vn)?_i=[...Vn]:_i=Ti.map(pr=>({name:pr}));_i.length<n.pinCount;)_i.push({name:""});_i[ni]={..._i[ni],name:Et};const mr=_i.map(pr=>pr.name),mi={...Zt,pinData:_i,pinNames:mr};n.layer==="top"?d(pr=>pr.map(Ci=>Ci.id===n.id?mi:Ci)):b(pr=>pr.map(Ci=>Ci.id===n.id?mi:Ci))}},disabled:P,onClick:ut=>ut.stopPropagation(),onFocus:ut=>ut.stopPropagation(),placeholder:"Pin name",style:{padding:"1px 2px",fontSize:"11px",border:"1px solid #ddd",borderRadius:2,background:"#fff",color:"#333",width:"100%",opacity:P?.6:1,cursor:P?"not-allowed":"text"}})}),Go&&i.jsx("td",{style:{padding:"2px 4px",color:"#333",fontSize:"11px"},children:Yn&&Yn.trim()!==""?i.jsx("span",{style:{fontFamily:"monospace",color:"#666"},children:Yn}):i.jsx("span",{style:{color:"#ccc"},children:"-"})}),zn&&i.jsx("td",{style:{padding:"2px 4px",color:"#333",fontSize:"11px"},children:ui&&ui.length>0?i.jsx("span",{style:{fontFamily:"monospace",color:"#666",fontSize:"10px"},children:ui.join(", ")}):i.jsx("span",{style:{color:"#ccc"},children:"-"})}),Me&&i.jsx("td",{style:{padding:"2px 4px",textAlign:"center"},children:nn?i.jsx("span",{style:{fontFamily:"monospace",fontWeight:600,color:xi==="+"?"#d32f2f":xi==="-"?"#1976d2":"#999"},children:xi||"-"}):i.jsxs("select",{value:xi??"",onChange:ut=>{if(P){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const Et=ut.target.value,Zt=(n.layer==="top"?s:l).find(Vn=>Vn.id===n.id);if(Zt){const Ti=[...Zt.pinPolarities||new Array(Zt.pinCount).fill("")];for(;Ti.length<Zt.pinCount;)Ti.push("");Ti[ni]=Et;const _i={...Zt,pinPolarities:Ti};n.layer==="top"?d(mr=>mr.map(mi=>mi.id===n.id?_i:mi)):b(mr=>mr.map(mi=>mi.id===n.id?_i:mi))}},disabled:P,onClick:ut=>ut.stopPropagation(),onFocus:ut=>ut.stopPropagation(),style:{padding:"1px 2px",fontSize:"11px",border:"1px solid #ddd",borderRadius:2,background:"#fff",cursor:P?"not-allowed":"pointer",opacity:P?.6:1,width:"100%",fontFamily:"monospace",fontWeight:600},children:[i.jsx("option",{value:"",children:"-"}),i.jsx("option",{value:"+",children:"+"}),i.jsx("option",{value:"-",children:"-"})]},`polarity-${tt.id}-${ni}-${xi}`)}),i.jsx("td",{style:{padding:"2px 4px",color:nn?"#28a745":"#999",fontWeight:nn?600:400,fontFamily:"monospace"},children:nn||"-"})]},ni)})})]})})})()]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"6px",padding:"6px",paddingRight:"24px",borderTop:"1px solid #e0e0e0",flexShrink:0},children:[i.jsx("button",{onClick:()=>{o(null),v(null)},disabled:P,style:{padding:"2px 5px",background:P?"#f5f5f5":"#fff",color:P?"#999":"#333",border:"1px solid #ddd",borderRadius:2,cursor:P?"not-allowed":"pointer",fontSize:"11px",opacity:P?.6:1},children:"Cancel"}),i.jsx("button",{onClick:dt,disabled:P,style:{padding:"2px 5px",background:P?"#f5f5f5":"#0b5fff",color:P?"#999":"#fff",border:"1px solid #ddd",borderRadius:2,cursor:P?"not-allowed":"pointer",fontSize:"11px",opacity:P?.6:1},children:"Save"})]}),Y&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10005},onClick:Me=>{Me.target===Me.currentTarget&&D(!1)},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"600px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:Me=>Me.stopPropagation(),children:[i.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:"How to Get a Google Gemini API Key"}),i.jsx("button",{onClick:()=>D(!1),style:{background:"transparent",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:0,width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center"},title:"Close",children:""})]}),i.jsx("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"14px",lineHeight:"1.6"},children:i.jsxs("p",{style:{margin:"0 0 12px 0"},children:["To get a Google Gemini API key, go to"," ",i.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",style:{color:"#4CAF50",textDecoration:"underline"},children:"Google AI Studio (aistudio.google.com/app/apikey)"}),', sign in with your Google account, and click "Get API key" or "Create API key" in the Dashboard to generate a key for a new or existing Google Cloud project, then copy it and store it securely.']})}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:i.jsx("button",{onClick:()=>D(!1),style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"OK"})})]})}),i.jsx("div",{onMouseDown:Bt,style:{position:"absolute",bottom:0,right:0,width:"20px",height:"20px",cursor:"nwse-resize",background:"linear-gradient(135deg, transparent 0%, transparent 40%, #ccc 40%, #ccc 45%, transparent 45%, transparent 55%, #ccc 55%, #ccc 60%, transparent 60%)",zIndex:1001},title:"Drag to resize"})]}),J&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10005},onClick:Me=>{Me.target===Me.currentTarget&&($(!1),U?.())},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"520px",maxWidth:"620px",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:Me=>Me.stopPropagation(),children:[i.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:"AI Service Configuration"}),i.jsx("button",{onClick:()=>{$(!1),U?.()},style:{background:"transparent",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:0,width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center"},title:"Close",children:""})]}),i.jsxs("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"14px",lineHeight:"1.6"},children:[i.jsx("p",{style:{margin:"0 0 16px 0"},children:"Extract datasheet information for components  avoiding manual data entry. Choose your preferred AI service below."}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#fff",fontSize:"13px",fontWeight:600},children:"AI Service Provider:"}),i.jsx("select",{value:V,onChange:Me=>ge(Me.target.value),style:{width:"100%",padding:"8px 12px",fontSize:"13px",border:"1px solid #555",borderRadius:"4px",background:"#1f1f24",color:"#fff",boxSizing:"border-box",cursor:"pointer"},children:_1.map(Me=>i.jsx("option",{value:Me,children:Us[Me].name},Me))}),i.jsx("p",{style:{margin:"6px 0 0 0",color:"#aaa",fontSize:"12px",lineHeight:"1.4"},children:Us[V].description})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsxs("label",{style:{display:"block",marginBottom:"6px",color:"#fff",fontSize:"13px",fontWeight:600},children:[Us[V].name," API Key:"]}),i.jsx("input",{type:"password",value:ue,onChange:Me=>ve(Me.target.value),placeholder:Us[V].apiKeyPlaceholder,style:{width:"100%",padding:"8px 12px",fontSize:"13px",border:"1px solid #555",borderRadius:"4px",background:"#1f1f24",color:"#fff",boxSizing:"border-box"},autoFocus:!0}),i.jsxs("p",{style:{margin:"6px 0 0 0",color:"#aaa",fontSize:"12px"},children:["Get your API key from:"," ",i.jsx("a",{href:Us[V].apiKeyHelpUrl,target:"_blank",rel:"noopener noreferrer",style:{color:"#4CAF50"},children:Us[V].apiKeyHelpUrl})]})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#fff",fontSize:"13px",fontWeight:600},children:"Model:"}),i.jsx("select",{value:se,onChange:Me=>ze(Me.target.value),style:{width:"100%",padding:"8px 12px",fontSize:"13px",border:"1px solid #555",borderRadius:"4px",background:"#1f1f24",color:"#fff",boxSizing:"border-box",cursor:"pointer"},children:Us[V].models.map(Me=>i.jsxs("option",{value:Me.id,children:[Me.name," ",Me.description?`(${Me.description})`:""]},Me.id))})]}),i.jsxs("div",{style:{marginBottom:"16px",padding:"12px",background:"#1f1f24",borderRadius:"4px",border:"1px solid #444"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#fff",fontSize:"13px",fontWeight:600},children:"API Key Storage:"}),i.jsxs("div",{style:{display:"flex",gap:"16px"},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",cursor:"pointer",color:"#ddd",fontSize:"13px"},children:[i.jsx("input",{type:"radio",name:"storageType2",value:"sessionStorage",checked:xe==="sessionStorage",onChange:()=>De("sessionStorage"),style:{cursor:"pointer"}}),"Session Storage"]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",cursor:"pointer",color:"#ddd",fontSize:"13px"},children:[i.jsx("input",{type:"radio",name:"storageType2",value:"localStorage",checked:xe==="localStorage",onChange:()=>De("localStorage"),style:{cursor:"pointer"}}),"Local Storage"]})]}),i.jsx("p",{style:{margin:"8px 0 0 0",color:xe==="sessionStorage"?"#4CAF50":"#ffaa00",fontSize:"12px",lineHeight:"1.4"},children:xe==="sessionStorage"?" Session Storage: API key is cleared when you close the browser tab (more secure)":" Local Storage: API key persists until you remove it (more convenient)"})]}),i.jsx("div",{style:{padding:"10px",background:"#1a1a1f",borderRadius:"4px",border:"1px solid #333"},children:i.jsxs("p",{style:{margin:"0",color:"#aaa",fontSize:"11px",lineHeight:"1.4"},children:[i.jsx("strong",{style:{color:"#ffaa00"},children:" Security:"})," API keys are stored in plain text in browser storage and are accessible via DevTools. Do not use on shared computers. Consider using API key restrictions from your provider."]})})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"8px"},children:[i.jsx("button",{onClick:Wt,disabled:!Ye,style:{padding:"8px 16px",background:Ye?"#d32f2f":"#444",color:"#fff",border:"1px solid #666",borderRadius:6,cursor:Ye?"pointer":"not-allowed",fontSize:"14px",fontWeight:600,opacity:Ye?1:.5},title:Ye?"Remove API key":"No API key stored",children:"Remove Key"}),i.jsxs("div",{style:{display:"flex",gap:"8px"},children:[i.jsx("button",{onClick:()=>{$(!1),U?.()},style:{padding:"8px 16px",background:"#555",color:"#fff",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Cancel"}),i.jsx("button",{onClick:()=>{St(),$(!1),U?.()},style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Save Settings"})]})]})]})}),de&&je&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10006},onClick:Me=>{Me.target===Me.currentTarget&&Ne(!1)},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"600px",maxWidth:"90vw",maxHeight:"90vh",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"2px solid #2196F3",display:"flex",flexDirection:"column"},onClick:Me=>Me.stopPropagation(),children:[i.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:"AI Service Response"}),i.jsx("button",{onClick:()=>{Ne(!1),ee(null)},style:{background:"transparent",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:0,width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center"},title:"Close",children:""})]}),i.jsx("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"13px",lineHeight:"1.6",overflow:"auto",flex:1,padding:"12px",background:"#1f1f24",borderRadius:"4px",fontFamily:"monospace",whiteSpace:"pre-wrap",wordBreak:"break-word",maxHeight:"60vh"},children:je}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[i.jsx("button",{onClick:()=>{navigator.clipboard.writeText(je||""),alert("Response copied to clipboard")},style:{padding:"8px 16px",background:"#555",color:"#fff",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Copy to Clipboard"}),i.jsx("button",{onClick:()=>{Ne(!1),ee(null)},style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Close"})]})]})}),Ie&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},onClick:Me=>{Me.target===Me.currentTarget&&$e(!1)},children:i.jsxs("div",{style:{background:"#fff",borderRadius:8,padding:"20px",maxWidth:"90%",maxHeight:"90%",width:"800px",display:"flex",flexDirection:"column",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)"},onClick:Me=>Me.stopPropagation(),children:[i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:"18px",fontWeight:600,color:"#333"},children:"AI Prompt Editor"}),i.jsx("p",{style:{margin:"0",fontSize:"13px",color:"#666",lineHeight:"1.5"},children:'This is the prompt that will be sent to Gemini when you click "Extract Datasheet Information". You can customize it for this component. The prompt will be saved with this component and reloaded when you open it again.'}),i.jsx("p",{style:{margin:"8px 0 0 0",fontSize:"12px",color:"#888",fontStyle:"italic"},children:'Note: The PDF datasheet will be automatically attached to your prompt when extracting information. You can reference it in your prompt as "the attached PDF" or "the datasheet".'})]}),i.jsx("textarea",{value:q,onChange:Me=>w(Me.target.value),style:{flex:1,minHeight:"400px",padding:"12px",border:"1px solid #ddd",borderRadius:4,fontSize:"13px",fontFamily:"monospace",resize:"vertical",color:"#000",background:"#fff",lineHeight:"1.5"},placeholder:"Enter your custom prompt here..."}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[i.jsx("button",{onClick:()=>{$e(!1)},style:{padding:"8px 16px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:()=>{if(n&&tt){const we=(n.layer==="top"?s:l).find(st=>st.id===n.id);if(we){const st={...we,customGeminiPrompt:q.trim()||void 0};n.layer==="top"?d(et=>et.map(Pt=>Pt.id===n.id?st:Pt)):b(et=>et.map(Pt=>Pt.id===n.id?st:Pt)),o({...n,customGeminiPrompt:q.trim()||void 0})}}$e(!1)},style:{padding:"8px 16px",background:"#4CAF50",border:"none",borderRadius:4,cursor:"pointer",color:"#fff",fontSize:"14px",fontWeight:600},children:"Save Prompt"})]})]})}),i.jsx(Zy,{visible:Sn.visible,title:Sn.title,message:Sn.message,type:Sn.type,onClose:()=>{mn({visible:!1,title:"",message:"",type:"info"}),de||ee(null)},onShowResponse:Sn.onShowResponse})]})};function pw(n){if(n.baseType)return n.baseType;switch(n.category){case"Capacitors":return"Capacitor";case"Diodes":return"Diode";case"Resistors":return"Resistor";case"Semiconductors":return"Semiconductor";case"Passive Components":return"Passive";case"Power & Energy":return"PowerEnergy";case"Connectors & Switches":return n.type==="Switch"||n.subcategory==="Switch"?"Switch":"Connector";case"Other":return n.type==="Transformer"?"Transformer":"Other";default:return"Other"}}const hw=bh.components,gw=hw.map(n=>{const r=`${n.category}:${n.subcategory}:${n.type}`,o=pw(n);return{...n,key:r,baseType:o}}),im=new Map;gw.forEach(n=>{im.set(n.key,n)});function yw(n){if(n)return im.get(n)}const Hg=n=>{const{category:r,subcategory:o,type:s,designator:l}=n;let d,b;switch(r){case"Capacitors":o==="Electrolytic"?d="Electrolytic Capacitor":o==="Film"?d="Film Capacitor":(d="Capacitor",o==="Tantalum"&&(b="Tantalum"));break;case"Diodes":d="Diode",o==="LED"?b="LED":o==="Infrared"?b="Infrared":o==="Photodiode"?b="Photodiode":o==="Schottky"?b="Schottky":o==="Zener"?b="Zener":b="Standard";break;case"Resistors":o==="Network"?(d="ResistorNetwork",b="Network"):o==="Thermistor"?(d="Thermistor",b="Thermistor"):o==="Variable"?(d="VariableResistor",b="Potentiometer"):o==="Varistor"?(d="VariableResistor",b="Varistor"):d="Resistor";break;case"Semiconductors":o==="BJT"||o==="MOSFET"||o==="JFET"?d="Transistor":d="IntegratedCircuit";break;case"Passive Components":s==="Inductor"?d="Inductor":s==="FerriteBead"?d="FerriteBead":d="Crystal";break;case"Power & Energy":o==="Battery"?d="Battery":o==="Power Supply"?d="PowerSupply":d="Fuse";break;case"Connectors & Switches":o==="Connector"?d="Connector":o==="Jumper"?d="Jumper":o==="Switch"?d="Switch":d="Relay";break;case"Other":o==="Transformer"?d="Transformer":o==="Speaker"?d="Speaker":o==="Motor"?d="Motor":o==="Test Point"?d="TestPoint":o==="Vacuum Tube"?d="VacuumTube":(d="GenericComponent",o==="Attenuator"?b="Attenuator":o==="Circuit Breaker"?b="CircuitBreaker":o==="Thermocouple"?b="Thermocouple":o==="Tuner"&&(b="Tuner"));break;default:d="GenericComponent";break}const p=`${r}:${o}:${s}:${l}`,v=`${r}:${o}:${s}`,m=yw(v);return{componentType:d,designator:l,subtype:b,uniqueKey:p,componentDefinition:n,dataDrivenDefinition:m}},rm=Gu.reduce((n,r)=>(n[r.category]||(n[r.category]=[]),n[r.category].push(r),n),{});Object.values(rm).forEach(n=>{n.sort((r,o)=>r.displayName.localeCompare(o.displayName))});const xw=({visible:n,selectedLayer:r,selectedComponentType:o,selectedComponentKey:s,onLayerChange:l,onComponentTypeChange:d,onClose:b})=>{const[p,v]=I.useState(""),[m,j]=I.useState(null),[_,M]=I.useState(!1),T=I.useRef({x:0,y:0}),F=I.useRef(null),P=I.useRef(null);I.useEffect(()=>{if(n&&m===null){const ne=document.querySelector(".pcb-canvas");if(ne){const Z=ne.getBoundingClientRect();j({x:Z.left,y:Z.top})}else j({x:244,y:6})}},[n,m]),I.useEffect(()=>{if(n&&P.current){const ne=setTimeout(()=>{P.current?.focus(),P.current?.select()},100);return()=>clearTimeout(ne)}},[n]);const k=I.useCallback(ne=>{const Z=ne.target;if(!(Z.tagName==="BUTTON"||Z.tagName==="INPUT"||Z.closest("button")||Z.closest("input"))&&F.current){const G=F.current.getBoundingClientRect();T.current={x:ne.clientX-G.left,y:ne.clientY-G.top},M(!0),ne.preventDefault()}},[]);I.useEffect(()=>{if(!_)return;const ne=G=>{const te=G.clientX-T.current.x,O=G.clientY-T.current.y,W=F.current?.offsetWidth||400,Y=F.current?.offsetHeight||600,D=Math.max(0,Math.min(te,window.innerWidth-W)),J=Math.max(0,Math.min(O,window.innerHeight-Y));j({x:D,y:J})},Z=()=>{M(!1)};return document.addEventListener("mousemove",ne),document.addEventListener("mouseup",Z),()=>{document.removeEventListener("mousemove",ne),document.removeEventListener("mouseup",Z)}},[_]);const y=I.useMemo(()=>{if(!p.trim())return()=>!0;const ne=p.toLowerCase();return Z=>!!(Z.searchText&&Z.searchText.toLowerCase().includes(ne)||Z.displayName&&Z.displayName.toLowerCase().includes(ne)||Z.description&&Z.description.toLowerCase().includes(ne)||Z.category&&Z.category.toLowerCase().includes(ne)||Z.subcategory&&Z.subcategory.toLowerCase().includes(ne)||Z.designator&&Z.designator.toLowerCase().includes(ne)||Z.type&&Z.type.toLowerCase().includes(ne)||Z.resolvedTypeName&&Z.resolvedTypeName.toLowerCase().includes(ne))},[p]),ae=I.useMemo(()=>p.trim()?Gu.filter(ne=>{const Z=Hg(ne);return y({category:ne.category,type:Z.componentType,subcategory:ne.subcategory,designator:ne.designator,displayName:ne.displayName,description:ne.description,resolvedTypeName:Wl(Z.componentType),searchText:ne.searchText})}):Gu,[p,y]);if(!n)return null;const E={position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"flex-start",justifyContent:"flex-end",zIndex:10005,pointerEvents:"none"},U={padding:"20px",overflow:"auto",flex:1};return i.jsx("div",{style:E,onClick:ne=>ne.stopPropagation(),children:i.jsxs("div",{ref:F,onClick:ne=>ne.stopPropagation(),style:{position:"fixed",top:m?`${m.y}px`:void 0,left:m?`${m.x}px`:void 0,backgroundColor:"#fff",borderRadius:8,minWidth:"250px",maxWidth:"300px",width:"280px",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:10005,display:"flex",flexDirection:"column",pointerEvents:"auto",transform:"none"},children:[i.jsxs("div",{onMouseDown:k,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:_?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Select Component"}),i.jsx("button",{type:"button",onMouseDown:ne=>{ne.stopPropagation()},onClick:ne=>{ne.stopPropagation(),b()},style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsxs("div",{style:U,children:[i.jsx("div",{style:{marginBottom:"16px"},onClick:ne=>ne.stopPropagation(),children:i.jsx("input",{ref:P,type:"text",placeholder:"Search by Component Type...",value:p,onChange:ne=>v(ne.target.value),onClick:ne=>ne.stopPropagation(),onMouseDown:ne=>ne.stopPropagation(),style:{width:"100%",padding:"8px 12px",fontSize:"13px",border:"1px solid #ddd",borderRadius:4,color:"#333",backgroundColor:"#fff",boxSizing:"border-box"}})}),i.jsxs("div",{style:{marginBottom:"20px",paddingBottom:"16px",borderBottom:"2px solid #eee"},onClick:ne=>ne.stopPropagation(),children:[i.jsx("div",{style:{marginBottom:"8px",fontSize:"14px",fontWeight:600,color:"#333"},children:"Layer:"}),i.jsxs("div",{style:{display:"flex",gap:"16px"},children:[i.jsxs("label",{onClick:ne=>ne.stopPropagation(),onMouseDown:ne=>ne.stopPropagation(),style:{display:"flex",alignItems:"center",cursor:"pointer",fontSize:"14px",color:"#333"},children:[i.jsx("input",{type:"radio",name:"componentLayer",checked:r==="top",onChange:()=>l("top"),onClick:ne=>ne.stopPropagation(),onMouseDown:ne=>ne.stopPropagation(),style:{marginRight:"8px",width:"14px",height:"14px",cursor:"pointer",accentColor:"#0066cc",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",border:r==="top"?"1.5px solid #0066cc":"1.5px solid #999",borderRadius:"50%",backgroundColor:r==="top"?"#0066cc":"transparent",position:"relative"}}),"Top"]}),i.jsxs("label",{onClick:ne=>ne.stopPropagation(),onMouseDown:ne=>ne.stopPropagation(),style:{display:"flex",alignItems:"center",cursor:"pointer",fontSize:"14px",color:"#333"},children:[i.jsx("input",{type:"radio",name:"componentLayer",checked:r==="bottom",onChange:()=>l("bottom"),onClick:ne=>ne.stopPropagation(),onMouseDown:ne=>ne.stopPropagation(),style:{marginRight:"8px",width:"14px",height:"14px",cursor:"pointer",accentColor:"#0066cc",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",border:r==="bottom"?"1.5px solid #0066cc":"1.5px solid #999",borderRadius:"50%",backgroundColor:r==="bottom"?"#0066cc":"transparent",position:"relative"}}),"Bottom"]})]})]}),i.jsxs("div",{children:[i.jsx("div",{style:{marginBottom:"12px",fontSize:"14px",fontWeight:600,color:"#333"},children:"Component Type:"}),i.jsx("div",{style:{maxHeight:"calc(80vh - 280px)",overflowY:"auto"},children:p.trim()?ae.length>0?ae.map(ne=>{const Z=Hg(ne),G=Z.uniqueKey||`${ne.category}:${ne.subcategory}:${ne.type}:${ne.designator}`,te=s===G,O=`${ne.designator} - ${ne.displayName}`;return i.jsxs("label",{onClick:W=>{W.stopPropagation(),d(Z.componentType,G,Z)},onMouseDown:W=>W.stopPropagation(),style:{display:"flex",alignItems:"center",width:"100%",maxWidth:"100%",textAlign:"left",padding:"8px 12px",marginBottom:"4px",background:te?"#e6f0ff":"#fff",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",fontSize:"12px",color:"#333",boxSizing:"border-box",overflow:"hidden"},children:[i.jsx("input",{type:"radio",name:"componentType-search",checked:te,onChange:()=>d(Z.componentType,G,Z),onClick:W=>W.stopPropagation(),onMouseDown:W=>W.stopPropagation(),style:{marginRight:"8px",width:"14px",height:"14px",cursor:"pointer",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",border:te?"1.5px solid #0066cc":"1.5px solid #999",borderRadius:"50%",backgroundColor:te?"#0066cc":"transparent",position:"relative",flexShrink:0}}),i.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1,minWidth:0},children:i.jsx("strong",{children:O})})]},G)}):i.jsxs("div",{style:{padding:"12px",color:"#666",fontSize:"12px",textAlign:"center"},children:['No matches found for "',p,'"']}):Object.entries(rm).map(([ne,Z])=>Z.length===0?null:i.jsxs("div",{style:{marginBottom:"12px"},children:[i.jsx("div",{style:{fontSize:"13px",fontWeight:600,color:"#333",padding:"6px 8px",marginBottom:"4px",backgroundColor:"#f5f5f5",borderRadius:4},children:ne}),i.jsx("div",{style:{marginLeft:"8px"},children:Z.map(G=>{const te=Hg(G),O=te.uniqueKey||`${G.category}:${G.subcategory}:${G.type}:${G.designator}`,W=s===O,Y=`${G.designator} - ${G.displayName}`;return i.jsxs("label",{onClick:D=>{D.stopPropagation(),d(te.componentType,O,te)},onMouseDown:D=>D.stopPropagation(),style:{display:"flex",alignItems:"center",width:"100%",maxWidth:"100%",textAlign:"left",padding:"6px 12px",marginBottom:"2px",background:W?"#e6f0ff":"#fff",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",fontSize:"12px",color:"#333",boxSizing:"border-box",overflow:"hidden"},children:[i.jsx("input",{type:"radio",name:`componentType-${ne}`,checked:W,onChange:()=>d(te.componentType,O,te),onMouseDown:D=>D.stopPropagation(),style:{marginRight:"8px",width:"14px",height:"14px",cursor:"pointer",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",border:W?"1.5px solid #0066cc":"1.5px solid #999",borderRadius:"50%",backgroundColor:W?"#0066cc":"transparent",position:"relative",flexShrink:0}}),i.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1,minWidth:0},children:Y})]},O)})})]},ne))})]})]})]})})},mw=({visible:n,onClose:r,powerBuses:o,setPowerBuses:s,editingPowerBusId:l,setEditingPowerBusId:d,powers:b})=>{const[p,v]=I.useState(null),[m,j]=I.useState(!1),[_,M]=I.useState(null),T=I.useRef(null);I.useEffect(()=>{n&&!p&&v({x:window.innerWidth/2-140,y:window.innerHeight/2-200})},[n,p]),I.useEffect(()=>{if(!m)return;const U=Z=>{p&&_&&v({x:Z.clientX-_.x,y:Z.clientY-_.y})},ne=()=>{j(!1),M(null)};return window.addEventListener("mousemove",U),window.addEventListener("mouseup",ne),()=>{window.removeEventListener("mousemove",U),window.removeEventListener("mouseup",ne)}},[m,p,_]);const F=o.filter(U=>U.id!==l),P=o.find(U=>U.id===l);if(!n)return null;const k=[...F].sort((U,ne)=>{const Z=O=>{const W=O.match(/([+-]?)(\d+\.?\d*)/);if(W){const Y=W[1]||"+",D=parseFloat(W[2]);return{absValue:Math.abs(D),isNegative:Y==="-"}}return{absValue:1/0,isNegative:!1}},G=Z(U.voltage),te=Z(ne.voltage);return G.absValue!==te.absValue?G.absValue-te.absValue:G.isNegative!==te.isNegative?G.isNegative?-1:1:0}),y=P?[...k,P]:k,ae=()=>{const U={id:`powerbus-${Date.now()}-${Math.random()}`,name:"New Power Bus",voltage:"+0.0",color:"#ff0000"};s(ne=>[...ne,U]),d(U.id)},E=U=>{const ne=U.target;ne.tagName==="BUTTON"||ne.tagName==="INPUT"||ne.closest("button")||ne.closest("input")||p&&(M({x:U.clientX-p.x,y:U.clientY-p.y}),j(!0),U.preventDefault())};return i.jsxs("div",{ref:T,style:{position:"fixed",top:p?`${p.y}px`:"50%",left:p?`${p.x}px`:"50%",transform:p?"none":"translate(-50%, -50%)",background:"#fff",border:"1px solid #0b5fff",borderRadius:4,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"280px",maxWidth:"320px",maxHeight:"80vh",display:"flex",flexDirection:"column",cursor:m?"grabbing":"default"},children:[i.jsxs("div",{onMouseDown:E,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:m?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Manage Power Buses"}),i.jsx("button",{onClick:r,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"6px 20px 6px 6px",overflowY:"auto",flex:1,minHeight:0},children:y.map(U=>{const ne=o.find(O=>O.id===U.id)||U,Z=o.findIndex(O=>O.id===U.id),G=o.some(O=>O.name===ne.name&&O.id!==U.id),te=o.some(O=>O.voltage===ne.voltage&&O.id!==U.id);return i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"4px",marginBottom:"4px",background:"#f9f9f9",borderRadius:4,border:"1px solid #e0e0e0"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsxs("div",{style:{flex:1,minWidth:0,display:"flex",flexDirection:"column",gap:"4px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"50px",flexShrink:0},children:"Name:"}),i.jsx("input",{type:"text",value:ne.name,onChange:O=>{const W=O.target.value;if(!o.some(D=>D.name===W&&D.id!==U.id)){const D=[...o];Z>=0&&(D[Z]={...ne,name:W},s(D))}},placeholder:"e.g., +5VDC",style:{flex:1,padding:"2px 3px",border:G?"1px solid #ff0000":"1px solid #ddd",borderRadius:2,fontSize:"10px",background:"#f5f5f5",color:"#000"}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"50px",flexShrink:0},children:"Value:"}),i.jsx("input",{type:"text",inputMode:"decimal",value:ne.voltage,onChange:O=>{const W=O.target.value;if(W===""||/^[+-]?\d*\.?\d*$/.test(W)){const Y=[...o];Z>=0&&(Y[Z]={...ne,voltage:W},s(Y))}},onBlur:O=>{const W=O.target.value.trim();if(W==="")return;const Y=parseFloat(W);if(!isNaN(Y)){const D=Y>=0?"+":"-",J=Math.abs(Y),$=`${D}${J.toFixed(1).replace(/\.?0+$/,"")}`,je=[...o];Z>=0&&(je[Z]={...ne,voltage:$},s(je))}},placeholder:"e.g., +5.0",style:{flex:1,padding:"2px 3px",border:te?"1px solid #ff0000":"1px solid #ddd",borderRadius:2,fontSize:"10px",background:"#f5f5f5",color:"#000"}})]})]}),i.jsx("input",{type:"color",value:ne.color,onChange:O=>{const W=[...o];Z>=0&&(W[Z]={...ne,color:O.target.value},s(W))},style:{width:"24px",height:"24px",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",flexShrink:0},title:"Color"}),i.jsx("button",{onClick:()=>{const O=b.filter(W=>W.powerBusId===U.id);if(O.length>0){alert(`Cannot delete: ${O.length} power node(s) are using this bus. Remove or reassign them first.`);return}s(W=>W.filter(Y=>Y.id!==U.id))},style:{padding:"2px 6px",background:"#f5f5f5",color:"#333",border:"1px solid #ddd",borderRadius:2,cursor:"pointer",fontSize:"9px",flexShrink:0},children:"Delete"})]})},U.id)})}),i.jsxs("div",{style:{padding:"6px",borderTop:"1px solid #e0e0e0",display:"flex",gap:"4px",flexShrink:0},children:[i.jsx("button",{onClick:ae,style:{flex:1,padding:"4px 8px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",fontSize:"10px"},children:"+ Add Power Bus"}),i.jsx("button",{onClick:r,style:{flex:1,padding:"4px 8px",background:"#0b5fff",color:"#fff",border:"none",borderRadius:2,cursor:"pointer",fontSize:"10px",fontWeight:500},children:"Close"})]})]})},bw=({visible:n,onClose:r,groundBuses:o,setGroundBuses:s,editingGroundBusId:l,setEditingGroundBusId:d,grounds:b})=>{const[p,v]=I.useState(null),[m,j]=I.useState(!1),[_,M]=I.useState(null),T=I.useRef(null);I.useEffect(()=>{n&&!p&&v({x:window.innerWidth/2-140,y:window.innerHeight/2-200})},[n,p]),I.useEffect(()=>{if(!m)return;const U=Z=>{p&&_&&v({x:Z.clientX-_.x,y:Z.clientY-_.y})},ne=()=>{j(!1),M(null)};return window.addEventListener("mousemove",U),window.addEventListener("mouseup",ne),()=>{window.removeEventListener("mousemove",U),window.removeEventListener("mouseup",ne)}},[m,p,_]);const F=o.filter(U=>U.id!==l),P=o.find(U=>U.id===l);if(!n)return null;const k=[...F].sort((U,ne)=>U.name.localeCompare(ne.name)),y=P?[...k,P]:k,ae=()=>{const U={id:`groundbus-${Date.now()}-${Math.random()}`,name:"New Ground Bus",color:"#000000"};s(ne=>[...ne,U]),d(U.id)},E=U=>{const ne=U.target;ne.tagName==="BUTTON"||ne.tagName==="INPUT"||ne.closest("button")||ne.closest("input")||p&&(M({x:U.clientX-p.x,y:U.clientY-p.y}),j(!0),U.preventDefault())};return i.jsxs("div",{ref:T,style:{position:"fixed",top:p?`${p.y}px`:"50%",left:p?`${p.x}px`:"50%",transform:p?"none":"translate(-50%, -50%)",background:"#fff",border:"1px solid #0b5fff",borderRadius:4,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"280px",maxWidth:"320px",maxHeight:"80vh",display:"flex",flexDirection:"column",cursor:m?"grabbing":"default"},children:[i.jsxs("div",{onMouseDown:E,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:m?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Manage Ground Buses"}),i.jsx("button",{onClick:r,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"6px 20px 6px 6px",overflowY:"auto",flex:1,minHeight:0},children:y.map(U=>{const ne=o.find(te=>te.id===U.id)||U,Z=o.findIndex(te=>te.id===U.id),G=o.some(te=>te.name===ne.name&&te.id!==U.id);return i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",padding:"4px",marginBottom:"4px",background:"#f9f9f9",borderRadius:4,border:"1px solid #e0e0e0"},children:[i.jsx("div",{style:{flex:1,minWidth:0},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"50px",flexShrink:0},children:"Name:"}),i.jsx("input",{type:"text",value:ne.name,onChange:te=>{const O=te.target.value;if(!o.some(Y=>Y.name===O&&Y.id!==U.id)){const Y=[...o];Z>=0&&(Y[Z]={...ne,name:O},s(Y))}},placeholder:"e.g., GND, Earth",style:{flex:1,padding:"2px 3px",border:G?"1px solid #ff0000":"1px solid #ddd",borderRadius:2,fontSize:"10px",background:"#f5f5f5",color:"#000"}})]})}),i.jsx("input",{type:"color",value:ne.color,onChange:te=>{const O=[...o];Z>=0&&(O[Z]={...ne,color:te.target.value},s(O))},style:{width:"24px",height:"24px",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",flexShrink:0},title:"Color"}),i.jsx("button",{onClick:()=>{const te=b.filter(O=>O.groundBusId===U.id);if(te.length>0){alert(`Cannot delete: ${te.length} ground node(s) are using this bus. Remove or reassign them first.`);return}s(O=>O.filter(W=>W.id!==U.id))},style:{padding:"2px 6px",background:"#f5f5f5",color:"#333",border:"1px solid #ddd",borderRadius:2,cursor:"pointer",fontSize:"9px",flexShrink:0},children:"Delete"})]},U.id)})}),i.jsxs("div",{style:{padding:"6px",borderTop:"1px solid #e0e0e0",display:"flex",gap:"4px",flexShrink:0},children:[i.jsx("button",{onClick:ae,style:{flex:1,padding:"4px 8px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",fontSize:"10px"},children:"+ Add Ground Bus"}),i.jsx("button",{onClick:r,style:{flex:1,padding:"4px 8px",background:"#0b5fff",color:"#fff",border:"none",borderRadius:2,cursor:"pointer",fontSize:"10px",fontWeight:500},children:"Close"})]})]})},vw=({visible:n,onClose:r,autoAssignDesignators:o,setAutoAssignDesignators:s,useGlobalDesignatorCounters:l,setUseGlobalDesignatorCounters:d})=>n?i.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#fff",border:"1px solid #ddd",borderRadius:6,padding:"16px",zIndex:1e3,minWidth:"300px",maxWidth:"400px",boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[i.jsx("h2",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#222"},children:"Manage Designators"}),i.jsx("button",{onClick:r,style:{background:"transparent",border:"none",fontSize:"18px",cursor:"pointer",color:"#666",padding:0,width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:"13px",color:"#333",marginBottom:"12px"},children:[i.jsx("input",{type:"checkbox",checked:o,onChange:b=>{s(b.target.checked)},style:{width:"16px",height:"16px",cursor:"pointer"}}),i.jsx("span",{children:"Automatically assign designators"})]}),i.jsx("div",{style:{marginTop:"8px",padding:"8px",background:"#f5f5f5",borderRadius:4,fontSize:"11px",color:"#666",lineHeight:"1.4",marginBottom:"12px"},children:o?i.jsx("div",{children:"When enabled, new components automatically receive sequential designators (e.g., C1, C2, C3 for Capacitors; R1, R2, R3 for Resistors)."}):i.jsx("div",{children:"When disabled, you must manually assign designators to each component. The designator field will be empty when components are created."})}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:"13px",color:"#333"},children:[i.jsx("input",{type:"checkbox",checked:l,onChange:b=>{d(b.target.checked)},style:{width:"16px",height:"16px",cursor:"pointer"}}),i.jsx("span",{children:"Use global designator counters"})]}),i.jsx("div",{style:{marginTop:"8px",padding:"8px",background:"#f5f5f5",borderRadius:4,fontSize:"11px",color:"#666",lineHeight:"1.4"},children:l?i.jsx("div",{children:"When ON, designators continue from global counters across all projects. New components start with the next value from the global counter (e.g., if global counter is C10, new capacitor will be C11)."}):i.jsx("div",{children:"When OFF (default), designators start at 1 for each project. Each project maintains its own independent designator sequence (e.g., C1, C2, C3...)."})})]}),i.jsx("button",{onClick:r,style:{width:"100%",padding:"6px 12px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:4,cursor:"pointer",fontSize:"12px"},children:"Close"})]}):null,ww=({visible:n,title:r,message:o,onYes:s,onNo:l,onCancel:d,yesButtonRef:b})=>n?i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001},onClick:p=>{p.target===p.currentTarget&&d()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:p=>p.stopPropagation(),children:[i.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:r}),i.jsx("p",{style:{margin:"0 0 24px 0",fontSize:"14px",color:"#e0e0e0",lineHeight:"1.5"},children:o}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[i.jsx("button",{onClick:d,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:l,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"No"}),i.jsx("button",{ref:b,onClick:s,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},autoFocus:!0,children:"Yes"})]})]})}):null,Sw=({visible:n,size:r,onSizeChange:o,onApply:s,onCancel:l})=>{const d=I.useRef(null);if(I.useEffect(()=>{n&&d.current&&(d.current.focus(),d.current.select())},[n]),!n)return null;const b=[2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32];return i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10003},onClick:p=>{p.target===p.currentTarget&&l()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:p=>p.stopPropagation(),children:[i.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Set Size"}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Size (pixels):"}),i.jsx("input",{ref:d,type:"number",min:"1",max:"99",value:r,onChange:p=>{const v=parseInt(p.target.value)||1,m=Math.max(1,Math.min(99,v));o(m)},onKeyDown:p=>{if(p.key==="Enter"?s():p.key==="Escape"&&l(),p.key.length===1&&/[0-9]/.test(p.key)){const v=r.toString();v.length>=2&&d.current?.selectionStart===d.current?.selectionEnd&&d.current?.selectionStart===v.length&&p.preventDefault()}},onInput:p=>{const v=p.target,m=v.value;if(m.length>2){v.value=m.slice(0,2);const j=parseInt(v.value)||1;o(Math.max(1,Math.min(99,j)))}},style:{width:"100%",padding:"8px 12px",marginBottom:"16px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Or select from list:"}),i.jsxs("select",{value:b.includes(r)?r:"",onChange:p=>{const v=parseInt(p.target.value);!isNaN(v)&&v>0&&o(v)},style:{width:"100%",padding:"8px 12px",marginBottom:"20px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},children:[i.jsx("option",{value:"",style:{background:"#1f1f24",color:"#f2f2f2"},children:"-- Select --"}),b.map(p=>i.jsxs("option",{value:p,style:{background:"#1f1f24",color:"#f2f2f2"},children:[p," pixels"]},p))]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[i.jsx("button",{onClick:l,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Apply"})]})]})})},Tw=({visible:n,interval:r,onIntervalChange:o,onApply:s,onCancel:l})=>n?i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10003},onClick:d=>{d.target===d.currentTarget&&l()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:d=>d.stopPropagation(),children:[i.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Auto Save"}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Select time interval:"}),i.jsxs("select",{value:r===null?"disable":(r||5).toString(),onChange:d=>{const b=d.target.value;if(b==="disable")o(null);else{const p=parseFloat(b);!isNaN(p)&&p>0&&o(p)}},style:{width:"100%",padding:"8px 12px",marginBottom:"20px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0,children:[i.jsx("option",{value:"1",style:{background:"#1f1f24",color:"#f2f2f2"},children:"1 minute"}),i.jsx("option",{value:"5",style:{background:"#1f1f24",color:"#f2f2f2"},children:"5 minutes"}),i.jsx("option",{value:"10",style:{background:"#1f1f24",color:"#f2f2f2"},children:"10 minutes"}),i.jsx("option",{value:"20",style:{background:"#1f1f24",color:"#f2f2f2"},children:"20 minutes"}),i.jsx("option",{value:"30",style:{background:"#1f1f24",color:"#f2f2f2"},children:"30 minutes"}),i.jsx("option",{value:"disable",style:{background:"#1f1f24",color:"#f2f2f2"},children:"Disable"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[i.jsx("button",{onClick:l,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Apply"})]})]})}):null,Cw=({visible:n,interval:r,onIntervalChange:o,onEnable:s,onSkip:l})=>n?i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:d=>{d.target===d.currentTarget&&l()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:d=>d.stopPropagation(),children:[i.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Enable Auto Save?"}),i.jsx("p",{style:{margin:"0 0 20px 0",fontSize:"14px",color:"#e0e0e0",lineHeight:"1.5"},children:"We recommend enabling Auto Save to automatically save your project at regular intervals. This helps protect your work from accidental loss."}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Select time interval:"}),i.jsxs("select",{value:r===null?"disable":(r||5).toString(),onChange:d=>{const b=d.target.value;if(b==="disable")o(null);else{const p=parseFloat(b);!isNaN(p)&&p>0&&o(p)}},style:{width:"100%",padding:"8px 12px",marginBottom:"24px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0,children:[i.jsx("option",{value:"1",style:{background:"#1f1f24",color:"#f2f2f2"},children:"1 minute"}),i.jsx("option",{value:"5",style:{background:"#1f1f24",color:"#f2f2f2"},children:"5 minutes"}),i.jsx("option",{value:"10",style:{background:"#1f1f24",color:"#f2f2f2"},children:"10 minutes"}),i.jsx("option",{value:"20",style:{background:"#1f1f24",color:"#f2f2f2"},children:"20 minutes"}),i.jsx("option",{value:"30",style:{background:"#1f1f24",color:"#f2f2f2"},children:"30 minutes"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[i.jsx("button",{onClick:l,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Skip"}),i.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Enable Auto Save"})]})]})}):null,jw=({visible:n,projectDirHandle:r,onClose:o,onRestore:s,position:l,isDragging:d=!1,onDragStart:b})=>{const[p,v]=I.useState([]),[m,j]=I.useState(!1),[_,M]=I.useState(null),[T,F]=I.useState(null),P=I.useRef(null);I.useEffect(()=>{if(!n||!r){v([]),M(null),F(null);return}(async()=>{j(!0),F(null);try{let ne;try{ne=await r.getDirectoryHandle("history")}catch{v([]),j(!1);return}const Z=te=>{const O=te.match(/_(\d{4})_(\d{2})_(\d{2})-(\d{2})-(\d{2})-(\d{2})\.json$/);if(O){const[,Y,D,J,$,je,ee]=O;return new Date(parseInt(Y),parseInt(D)-1,parseInt(J),parseInt($),parseInt(je),parseInt(ee))}const W=te.match(/_(\d{4})_(\d{2})_(\d{2})_(\d{2})_(\d{2})_(\d{2})\.json$/);if(W){const[,Y,D,J,$,je,ee]=W;return new Date(parseInt(Y),parseInt(D)-1,parseInt(J),parseInt($),parseInt(je),parseInt(ee))}return null},G=[];for await(const te of ne.keys())if(te.endsWith(".json"))try{const W=await(await ne.getFileHandle(te)).getFile(),Y=Z(te);G.push({name:te,lastModified:new Date(W.lastModified),size:W.size,timestamp:Y||new Date(W.lastModified)})}catch(O){console.warn(`Failed to read file ${te}:`,O)}G.sort((te,O)=>O.timestamp.getTime()-te.timestamp.getTime()),v(G)}catch(ne){console.error("Failed to load history files:",ne),F("Failed to load history files. Please try again.")}finally{j(!1)}})()},[n,r]);const k=async()=>{if(_)try{await s(_),o()}catch(U){console.error("Failed to restore file:",U),F("Failed to restore file. Please try again.")}},y=U=>U.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),ae=U=>U<1024?`${U} B`:U<1024*1024?`${(U/1024).toFixed(1)} KB`:`${(U/(1024*1024)).toFixed(1)} MB`;if(!n)return null;const E=l?{position:"fixed",left:`${l.x}px`,top:`${l.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"500px",maxWidth:"700px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:d?"grabbing":"default"}:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"#fff",borderRadius:8,minWidth:"500px",maxWidth:"700px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column"};return i.jsxs("div",{style:E,children:[i.jsxs("div",{onMouseDown:b,style:{backgroundColor:"#f5f5f5",padding:"12px 16px",borderBottom:"1px solid #ddd",borderRadius:"8px 8px 0 0",cursor:d?"grabbing":"move",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h2",{style:{margin:0,fontSize:"16px",fontWeight:600,color:"#000"},children:"PastTime"}),i.jsx("button",{onClick:o,style:{background:"transparent",border:"none",fontSize:"20px",cursor:"pointer",color:"#666",padding:"0 4px",lineHeight:1},title:"Close",children:""})]}),i.jsxs("div",{style:{padding:"16px",display:"flex",flexDirection:"column",flex:1,minHeight:0},children:[T&&i.jsx("div",{style:{padding:"12px",backgroundColor:"#fee",color:"#c00",borderRadius:4,marginBottom:"12px"},children:T}),m?i.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"Loading history files..."}):p.length===0?i.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"No history files found."}):i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{marginBottom:"12px",color:"#333",fontSize:"14px"},children:"Select a file to restore:"}),i.jsx("div",{ref:P,style:{border:"1px solid #ddd",borderRadius:4,overflowY:"auto",maxHeight:"400px",backgroundColor:"#fafafa"},children:p.map((U,ne)=>i.jsxs("div",{onClick:()=>M(U.name),style:{padding:"12px 16px",borderBottom:ne<p.length-1?"1px solid #eee":"none",backgroundColor:_===U.name?"#e6f0ff":"transparent",cursor:"pointer",transition:"background-color 0.1s"},onMouseEnter:Z=>{_!==U.name&&(Z.currentTarget.style.backgroundColor="#f5f5f5")},onMouseLeave:Z=>{_!==U.name&&(Z.currentTarget.style.backgroundColor="transparent")},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"4px"},children:[i.jsx("div",{style:{fontWeight:600,color:"#000",fontSize:"13px",wordBreak:"break-word",flex:1},children:U.name}),i.jsx("div",{style:{color:"#666",fontSize:"12px",marginLeft:"12px",whiteSpace:"nowrap"},children:ae(U.size)})]}),i.jsx("div",{style:{color:"#666",fontSize:"12px"},children:y(U.lastModified)})]},U.name))})]})]}),i.jsxs("div",{style:{padding:"12px 16px",borderTop:"1px solid #ddd",display:"flex",justifyContent:"flex-end",gap:"8px"},children:[i.jsx("button",{onClick:o,style:{padding:"6px 16px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"13px"},children:"Cancel"}),i.jsx("button",{onClick:k,disabled:!_||m,style:{padding:"6px 16px",background:_&&!m?"#0066cc":"#ccc",border:"none",borderRadius:4,cursor:_&&!m?"pointer":"not-allowed",color:"#fff",fontSize:"13px",fontWeight:500},children:"Restore"})]})]})},Nw=()=>i.jsxs("svg",{width:"45",height:"30",viewBox:"0 0 45 30",style:{marginLeft:"8px",flexShrink:0},children:[i.jsx("rect",{x:"8",y:"4",width:"29",height:"14",rx:"2",ry:"2",fill:"#000"}),i.jsx("rect",{x:"10",y:"18",width:"2.5",height:"6",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"14.5",y:"18",width:"2.5",height:"6",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"19",y:"18",width:"2.5",height:"6",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"23.5",y:"18",width:"2.5",height:"6",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"28",y:"18",width:"2.5",height:"6",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"32.5",y:"18",width:"2.5",height:"6",rx:"0.5",fill:"#000"})]}),kw=()=>i.jsxs("svg",{width:"40",height:"30",viewBox:"0 0 40 30",style:{marginLeft:"8px",flexShrink:0},children:[i.jsx("rect",{x:"2",y:"11",width:"5",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"2",y:"14.5",width:"5",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"2",y:"18",width:"5",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"7",y:"6",width:"26",height:"18",rx:"2",ry:"2",fill:"#000"}),i.jsx("rect",{x:"13",y:"10",width:"14",height:"10",rx:"1.5",ry:"1.5",fill:"#fff"}),i.jsx("circle",{cx:"14.5",cy:"11.5",r:"1",fill:"#000"}),i.jsx("rect",{x:"33",y:"11",width:"5",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"33",y:"14.5",width:"5",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"33",y:"18",width:"5",height:"2.5",rx:"0.5",fill:"#000"})]}),Aw=()=>i.jsxs("svg",{width:"35",height:"35",viewBox:"0 0 35 35",style:{marginLeft:"8px",flexShrink:0},children:[i.jsx("rect",{x:"12",y:"2",width:"2.5",height:"4",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"16.25",y:"2",width:"2.5",height:"4",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"20.5",y:"2",width:"2.5",height:"4",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"2",y:"12",width:"4",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"2",y:"16.25",width:"4",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"2",y:"20.5",width:"4",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"6",y:"6",width:"23",height:"23",fill:"#000"}),i.jsx("rect",{x:"29",y:"12",width:"4",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"29",y:"16.25",width:"4",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"29",y:"20.5",width:"4",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"12",y:"29",width:"2.5",height:"4",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"16.25",y:"29",width:"2.5",height:"4",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"20.5",y:"29",width:"2.5",height:"4",rx:"0.5",fill:"#000"})]}),om=({rotate:n=0})=>{const s=n!==0?`rotate(${n} 20 20)`:"";return i.jsx("svg",{width:"40",height:"40",viewBox:"0 0 40 40",style:{marginLeft:"8px",flexShrink:0},children:i.jsxs("g",{transform:s,children:[i.jsx("rect",{x:"8",y:"10",width:"24",height:"20",rx:"2",ry:"2",fill:"#555"}),i.jsx("rect",{x:"2",y:"12",width:"6",height:"3",rx:"1",ry:"1",fill:"#555"}),i.jsx("rect",{x:"2",y:"18",width:"6",height:"3",rx:"1",ry:"1",fill:"#555"}),i.jsx("rect",{x:"2",y:"24",width:"6",height:"3",rx:"1",ry:"1",fill:"#555"}),i.jsx("rect",{x:"32",y:"12",width:"6",height:"3",rx:"1",ry:"1",fill:"#555"}),i.jsx("rect",{x:"32",y:"18",width:"6",height:"3",rx:"1",ry:"1",fill:"#555"}),i.jsx("rect",{x:"32",y:"24",width:"6",height:"3",rx:"1",ry:"1",fill:"#555"}),i.jsx("rect",{x:"12",y:"14",width:"16",height:"12",rx:"1.5",ry:"1.5",fill:"#fff"}),i.jsx("circle",{cx:"14",cy:"16",r:"1.5",fill:"#555"})]})})},Pw=()=>i.jsx(om,{rotate:0}),zw=()=>i.jsx(om,{rotate:90}),_w=({visible:n,isPad:r,onConfirm:o,onClose:s})=>{const[l,d]=I.useState("linear"),[b,p]=I.useState("vertical-edges"),[v,m]=I.useState("8"),[j,_]=I.useState("");I.useEffect(()=>{n&&(d("linear"),p("vertical-edges"),m("8"),_(""))},[n]);const M=(P,k)=>{const y=P.trim();if(y==="")return{valid:!1,error:"Number of pins is required."};const ae=parseInt(y,10);return isNaN(ae)?{valid:!1,error:"Please enter a valid number."}:ae<1?{valid:!1,error:"Number of pins must be >= 1."}:k==="linear"?ae!==Math.floor(ae)||ae<=0?{valid:!1,error:"Linear arrangement requires a positive integer."}:{valid:!0,error:"",numPins:ae}:k==="twoSided"?ae!==Math.floor(ae)||ae<=0?{valid:!1,error:"2-sided arrangement requires a positive integer."}:ae%2!==0?{valid:!1,error:"2-sided components must have an even number of pins."}:{valid:!0,error:"",numPins:ae}:k==="fourSided"?ae!==Math.floor(ae)||ae<=0?{valid:!1,error:"4-sided arrangement requires a positive integer."}:ae%4!==0?{valid:!1,error:"4-sided components must have a number of pins divisible by 4."}:{valid:!0,error:"",numPins:ae}:{valid:!0,error:"",numPins:ae}},T=P=>{let k=P===""?"":P.replace(/[^\d]/g,"");m(k);const y=M(k,l);y.error?_(y.error):_("")},F=I.useCallback(()=>{const P=M(v,l);if(!P.valid||P.numPins===void 0){_(P.error||"Invalid number of pins.");return}_(""),o({numPins:P.numPins,type:l,...l==="twoSided"?{twoSidedOrientation:b}:{}})},[v,l,b,o]);return I.useEffect(()=>{if(!n)return;const P=k=>{k.key==="Enter"&&!k.shiftKey&&!k.ctrlKey&&!k.altKey&&!k.metaKey&&(k.preventDefault(),F())};return window.addEventListener("keydown",P),()=>{window.removeEventListener("keydown",P)}},[n,F]),n?i.jsxs(i.Fragment,{children:[i.jsx("style",{children:`
        .number-input-large-spinners::-webkit-inner-spin-button,
        .number-input-large-spinners::-webkit-outer-spin-button {
          opacity: 1;
          height: 20px;
          width: 20px;
          cursor: pointer;
        }
        .number-input-large-spinners::-webkit-inner-spin-button {
          margin-right: 4px;
        }
      `}),i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},onClick:P=>{P.target===P.currentTarget&&s()},children:i.jsxs("div",{style:{backgroundColor:"#fff",padding:"20px",borderRadius:"8px",minWidth:"320px",maxWidth:"380px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},onClick:P=>P.stopPropagation(),children:[i.jsxs("h2",{style:{marginTop:0,marginBottom:"20px",color:"#222",fontSize:"18px"},children:[r?"Pad Pattern":"Via Pattern"," Placement"]}),i.jsxs("div",{style:{marginBottom:"15px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#222",fontWeight:500},children:"Arrangement:"}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[i.jsx("input",{type:"radio",value:"linear",checked:l==="linear",onChange:P=>{const k=P.target.value;d(k);const y=M(v,k);y.error?_(y.error):_("")},style:{marginRight:"8px"}}),i.jsx("span",{style:{color:"#222"},children:"Linear (1 side)"}),i.jsx(Nw,{})]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[i.jsx("input",{type:"radio",value:"twoSided",checked:l==="twoSided",onChange:P=>{const k=P.target.value;d(k);const y=M(v,k);y.error?_(y.error):_("")},style:{marginRight:"8px"}}),i.jsx("span",{style:{color:"#222"},children:"2-Sided"}),i.jsx(kw,{})]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[i.jsx("input",{type:"radio",value:"fourSided",checked:l==="fourSided",onChange:P=>{const k=P.target.value;d(k);const y=M(v,k);y.error?_(y.error):_("")},style:{marginRight:"8px"}}),i.jsx("span",{style:{color:"#222"},children:"4-Sided"}),i.jsx(Aw,{})]})]})]}),l==="twoSided"&&i.jsxs("div",{style:{marginBottom:"15px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#222",fontWeight:500},children:"Orientation:"}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[i.jsx("input",{type:"radio",value:"vertical-edges",checked:b==="vertical-edges",onChange:P=>p(P.target.value),style:{marginRight:"8px"}}),i.jsxs("span",{style:{color:"#222"},children:["Vertical ",r?"Pads":"Vias"," (left & right)"]}),i.jsx(Pw,{})]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[i.jsx("input",{type:"radio",value:"horizontal-edges",checked:b==="horizontal-edges",onChange:P=>p(P.target.value),style:{marginRight:"8px"}}),i.jsxs("span",{style:{color:"#222"},children:["Horizontal ",r?"Pads":"Vias"," (top & bottom)"]}),i.jsx(zw,{})]})]})]}),i.jsxs("div",{style:{marginBottom:"15px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#222",fontWeight:500},children:"Number of Pins:"}),i.jsx("input",{type:"number",min:l==="linear"?1:l==="twoSided"?2:4,step:l==="linear"?1:l==="twoSided"?2:4,value:v,onChange:P=>T(P.target.value),onBlur:()=>{const P=M(v,l);P.valid?_(""):_(P.error)},style:{width:"80px",padding:"6px 24px 6px 6px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px",color:"#000",background:"#fff"},className:"number-input-large-spinners"}),j&&i.jsx("div",{style:{color:"#d32f2f",fontSize:"12px",marginTop:"4px"},children:j})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",marginTop:"20px"},children:[i.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:F,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"OK"})]})]})})]}):null};function Dw(n,r){const o={x:n.x,y:n.y},s={x:r.x,y:r.y},l={x:s.x,y:o.y},d={x:o.x,y:s.y};return{corner1:o,corner2:l,corner3:s,corner4:d}}function Rw(n){if(n.numPins<1)throw new Error("Number of pins must be >= 1.");if(n.type==="twoSided"){if(n.numPins%2!==0)throw new Error("2-sided components must have an even number of pins.");if(!n.twoSidedOrientation)throw new Error("Orientation required for 2-sided components.")}if(n.type==="fourSided"&&n.numPins%4!==0)throw new Error("4-sided components must have N divisible by 4.");if(Math.abs(n.point1.x-n.point2.x)<.001||Math.abs(n.point1.y-n.point2.y)<.001)throw new Error("Area must have non-zero width and height.")}function Iw(n,r){const o=[],{corner1:s,corner2:l,corner3:d,corner4:b}=r,p=Math.abs(l.x-s.x),v=Math.abs(d.y-l.y);if(p>v){const m=(s.y+b.y)/2,j=Math.min(s.x,l.x),_=Math.max(s.x,l.x),M=_-j,T=n.numPins>1?M/(n.numPins-1):0,F=Math.hypot(s.x-j,s.y-m),P=Math.hypot(s.x-_,s.y-m),k=F<P;if(n.numPins===1)o.push({pinNumber:1,x:(j+_)/2,y:m});else for(let y=1;y<=n.numPins;y++){const ae=k?j+(y-1)*T:_-(y-1)*T;o.push({pinNumber:y,x:ae,y:m})}}else{const m=(s.x+l.x)/2,j=Math.min(s.y,l.y),_=Math.max(d.y,b.y),M=_-j,T=n.numPins>1?M/(n.numPins-1):0,F=Math.hypot(s.x-m,s.y-j),P=Math.hypot(s.x-m,s.y-_),k=F<P;if(n.numPins===1)o.push({pinNumber:1,x:m,y:(j+_)/2});else for(let y=1;y<=n.numPins;y++){const ae=k?j+(y-1)*T:_-(y-1)*T;o.push({pinNumber:y,x:m,y:ae})}}return o}function Lw(n,r){const o=[],{corner1:s,corner2:l,corner3:d,corner4:b}=r,p=n.type==="fourSided"?n.numPins/4:n.numPins/2,v=Math.min(s.x,l.x,d.x,b.x),m=Math.min(s.y,l.y,d.y,b.y),j=Math.abs(s.y-m)<.001,_=Math.abs(s.x-v)<.001,M=j?_?"TopLeft":"TopRight":_?"BottomLeft":"BottomRight",T=Math.max(s.x,l.x,d.x,b.x),F=Math.max(s.y,l.y,d.y,b.y),P=(D,J,$=.001)=>{const je=[s,l,d,b];for(const ee of je)if(Math.abs(ee.x-D)<$&&Math.abs(ee.y-J)<$)return ee;return null},k=P(v,m)||s,y=P(T,m)||l,ae=P(T,F)||d,E=P(v,F)||b,U={start:k,end:E,name:"Left",direction:"Down"},ne={start:E,end:ae,name:"Bottom",direction:"Right"},Z={start:ae,end:y,name:"Right",direction:"Up"},G={start:y,end:k,name:"Top",direction:"Left"};let te;const O=[];if(M==="TopLeft"?(te=U,O.push(U,ne,Z,G)):M==="BottomLeft"?(te=ne,O.push(ne,Z,G,U)):M==="BottomRight"?(te=Z,O.push(Z,G,U,ne)):(te=G,O.push(G,U,ne,Z)),n.type==="twoSided"){if(n.twoSidedOrientation==="vertical-edges"){if(M!=="TopLeft"&&M!=="BottomRight")throw new Error(`Invalid Pin 1 location for Left/Right orientation. Pin 1 is at ${M}, but must be at Top-Left or Bottom-Right.`)}else if(M!=="TopRight"&&M!=="BottomLeft")throw new Error(`Invalid Pin 1 location for Top/Bottom orientation. Pin 1 is at ${M}, but must be at Top-Right or Bottom-Left.`)}const W=[];n.type==="fourSided"?W.push(...O):n.twoSidedOrientation==="vertical-edges"?te===U?W.push(U,Z):W.push(Z,U):te===G?W.push(G,ne):W.push(ne,G);let Y=1;for(const D of W){const J=Math.hypot(D.end.x-D.start.x,D.end.y-D.start.y),$=n.type==="fourSided"?J/(p+1):p>1?J/(p-1):0,je=[];if(n.type==="fourSided")if(D.direction==="Down")for(let ee=1;ee<=p;ee++)je.push({x:D.start.x,y:D.start.y+ee*$});else if(D.direction==="Right")for(let ee=1;ee<=p;ee++)je.push({x:D.start.x+ee*$,y:D.start.y});else if(D.direction==="Up")for(let ee=1;ee<=p;ee++)je.push({x:D.start.x,y:D.start.y-ee*$});else for(let ee=1;ee<=p;ee++)je.push({x:D.start.x-ee*$,y:D.start.y});else if(p===1){const ee=(D.start.x+D.end.x)/2,de=(D.start.y+D.end.y)/2;je.push({x:ee,y:de})}else if(D.direction==="Down")for(let ee=0;ee<p;ee++)je.push({x:D.start.x,y:D.start.y+ee*$});else if(D.direction==="Right")for(let ee=0;ee<p;ee++)je.push({x:D.start.x+ee*$,y:D.start.y});else if(D.direction==="Up")for(let ee=0;ee<p;ee++)je.push({x:D.start.x,y:D.start.y-ee*$});else for(let ee=0;ee<p;ee++)je.push({x:D.start.x-ee*$,y:D.start.y});if(D===te){let ee=0,de=1/0;for(let Ie=0;Ie<je.length;Ie++){const $e=Math.hypot(je[Ie].x-s.x,je[Ie].y-s.y);$e<de&&(de=$e,ee=Ie)}const Ne=Math.hypot(D.start.x-s.x,D.start.y-s.y);if(de<Ne&&ee>0){const Ie=je.slice(0,ee),$e=je.slice(ee);je.length=0,je.push(...$e,...Ie)}}for(const ee of je)o.push({pinNumber:Y++,x:ee.x,y:ee.y})}return o}function Mw(n){Rw(n);const r=Dw(n.point1,n.point2);return n.type==="linear"?Iw(n,r):Lw(n,r)}function Bw(){const[n,r]=I.useState([]),[o,s]=I.useState(!1),[l,d]=I.useState([]),[b,p]=I.useState(null),[v,m]=I.useState("trace"),[j,_]=I.useState("top"),M=I.useRef([]),T=I.useRef(0),F=I.useRef(!1),P=I.useCallback(()=>{s(!0),d([]),M.current=[]},[]),k=I.useCallback(()=>{s(!1),d([]),M.current=[]},[]),y=I.useCallback(E=>{d(U=>[...U,E]),M.current=[...M.current,E]},[]),ae=I.useCallback(E=>{r(U=>[...U,E]),d([]),M.current=[]},[]);return{drawingStrokes:n,setDrawingStrokes:r,isDrawing:o,setIsDrawing:s,currentStroke:l,setCurrentStroke:d,tracePreviewMousePos:b,setTracePreviewMousePos:p,drawingMode:v,setDrawingMode:m,selectedDrawingLayer:j,setSelectedDrawingLayer:_,currentStrokeRef:M,lastTraceClickTimeRef:T,isDoubleClickingTraceRef:F,startDrawing:P,stopDrawing:k,addPointToStroke:y,finishStroke:ae}}function Ow(){const[n,r]=I.useState(new Set),[o,s]=I.useState(!1),[l,d]=I.useState(new Set),[b,p]=I.useState(new Set),[v,m]=I.useState(new Set),j=I.useCallback(()=>{r(new Set),d(new Set),p(new Set),m(new Set)},[]),_=I.useCallback((F,P="stroke")=>{P==="stroke"?r(k=>new Set([...k,F])):P==="component"?d(k=>new Set([...k,F])):P==="power"?p(k=>new Set([...k,F])):P==="ground"&&m(k=>new Set([...k,F]))},[]),M=I.useCallback((F,P="stroke")=>{P==="stroke"?r(k=>{const y=new Set(k);return y.delete(F),y}):P==="component"?d(k=>{const y=new Set(k);return y.delete(F),y}):P==="power"?p(k=>{const y=new Set(k);return y.delete(F),y}):P==="ground"&&m(k=>{const y=new Set(k);return y.delete(F),y})},[]),T=I.useCallback((F,P="stroke")=>{P==="stroke"?r(F):P==="component"?d(F):P==="power"?p(F):P==="ground"&&m(F)},[]);return{selectedIds:n,setSelectedIds:r,isSelecting:o,setIsSelecting:s,selectedComponentIds:l,setSelectedComponentIds:d,selectedPowerIds:b,setSelectedPowerIds:p,selectedGroundIds:v,setSelectedGroundIds:m,clearSelection:j,addToSelection:_,removeFromSelection:M,setSelection:T}}function Fw(){const[n,r]=I.useState(null),[o,s]=I.useState(!1),[l,d]=I.useState(null),[b,p]=I.useState("nudge"),v=I.useCallback((j,_)=>{r(j),s(!0),d(_)},[]),m=I.useCallback(()=>{s(!1),r(null),d(null)},[]);return{selectedImageForTransform:n,setSelectedImageForTransform:r,isTransforming:o,setIsTransforming:s,transformStartPos:l,setTransformStartPos:d,transformMode:b,setTransformMode:p,startTransform:v,stopTransform:m}}function Uw(){const[n,r]=I.useState(null),[o,s]=I.useState(null),[l,d]=I.useState("overlay"),[b,p]=I.useState(50),[v,m]=I.useState(!1),[j,_]=I.useState(2e3),[M,T]=I.useState(!1),F=I.useCallback(y=>{r(y)},[]),P=I.useCallback(y=>{s(y)},[]),k=I.useCallback(()=>{r(null),s(null)},[]);return{topImage:n,setTopImage:r,bottomImage:o,setBottomImage:s,currentView:l,setCurrentView:d,transparency:b,setTransparency:p,isTransparencyCycling:v,setIsTransparencyCycling:m,transparencyCycleSpeed:j,setTransparencyCycleSpeed:_,isGrayscale:M,setIsGrayscale:T,loadTopImage:F,loadBottomImage:P,clearImages:k}}function Ew(){const[n,r]=I.useState(1),[o,s]=I.useState({x:0,y:0}),[l,d]=I.useState(0),[b,p]=I.useState(!1),[v,m]=I.useState(!1),[j,_]=I.useState(!1),M=I.useCallback(()=>{r(1),s({x:0,y:0}),d(0),p(!1)},[]),T=I.useCallback((E=1.2)=>{r(U=>U*E)},[]),F=I.useCallback((E=1.2)=>{r(U=>U/E)},[]),P=I.useCallback(E=>{r(E)},[]),k=I.useCallback((E,U,ne)=>{const Z=E/ne,G=U/ne;s(te=>({x:te.x-Z,y:te.y-G}))},[]),y=I.useCallback((E,U)=>{s({x:E,y:U})},[]),ae=I.useCallback((E,U)=>({x:E-o.x*n,y:U-o.y*n}),[o,n]);return{viewScale:n,setViewScale:r,cameraWorldCenter:o,setCameraWorldCenter:s,viewRotation:l,setViewRotation:d,viewFlipX:b,setViewFlipX:p,isShiftConstrained:v,setIsShiftConstrained:m,showBothLayers:j,setShowBothLayers:_,resetView:M,zoomIn:T,zoomOut:F,setZoom:P,pan:k,setCameraCenter:y,getViewPan:ae}}function Vw(){const[n,r]=I.useState(()=>[{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),[o,s]=I.useState(()=>[{id:"groundbus-circuit",name:"GND",color:"#000000"}]),[l,d]=I.useState([]),[b,p]=I.useState([]),[v,m]=I.useState(null),[j,_]=I.useState(null),M=I.useCallback(Z=>{r(G=>[...G,Z])},[]),T=I.useCallback((Z,G)=>{r(te=>te.map(O=>O.id===Z?{...O,...G}:O))},[]),F=I.useCallback(Z=>{r(G=>G.filter(te=>te.id!==Z)),d(G=>G.filter(te=>te.powerBusId!==Z))},[]),P=I.useCallback(Z=>{d(G=>[...G,Z])},[]),k=I.useCallback(Z=>{d(G=>G.filter(te=>te.id!==Z))},[]),y=I.useCallback(Z=>{p(G=>[...G,Z])},[]),ae=I.useCallback(Z=>{p(G=>G.filter(te=>te.id!==Z))},[]),E=I.useCallback(Z=>{s(G=>[...G,Z])},[]),U=I.useCallback((Z,G)=>{s(te=>te.map(O=>O.id===Z?{...O,...G}:O))},[]),ne=I.useCallback(Z=>{s(G=>G.filter(te=>te.id!==Z)),p(G=>G.filter(te=>te.groundBusId===Z))},[]);return{powerBuses:n,setPowerBuses:r,groundBuses:o,setGroundBuses:s,powerSymbols:l,setPowerSymbols:d,groundSymbols:b,setGroundSymbols:p,powerEditor:v,setPowerEditor:m,groundEditor:j,setGroundEditor:_,addPowerBus:M,updatePowerBus:T,removePowerBus:F,addPowerSymbol:P,removePowerSymbol:k,addGroundSymbol:y,removeGroundSymbol:ae,addGroundBus:E,updateGroundBus:U,removeGroundBus:ne}}const zi={brushColor:"#008080",brushSize:6,topTraceColor:"#AA4499",bottomTraceColor:"#F781BF",topTraceSize:6,bottomTraceSize:6,viaSize:18,viaColor:"#ff0000",topPadColor:"#0072B2",bottomPadColor:"#56B4E9",topPadSize:18,bottomPadSize:18,topTestPointColor:"#FFFF00",bottomTestPointColor:"#FFFF00",topTestPointSize:18,bottomTestPointSize:18,topComponentColor:"#8C564B",bottomComponentColor:"#9C755F",topComponentSize:18,bottomComponentSize:18,componentConnectionColor:"#E69F00",componentConnectionSize:3};function qw(){const[n,r]=I.useState(zi.brushColor),[o,s]=I.useState(zi.brushSize),[l,d]=I.useState(zi.topTraceColor),[b,p]=I.useState(zi.bottomTraceColor),[v,m]=I.useState(zi.topTraceSize),[j,_]=I.useState(zi.bottomTraceSize),[M,T]=I.useState(zi.topPadColor),[F,P]=I.useState(zi.bottomPadColor),[k,y]=I.useState(zi.topPadSize),[ae,E]=I.useState(zi.bottomPadSize),[U,ne]=I.useState(zi.topTestPointColor),[Z,G]=I.useState(zi.bottomTestPointColor),[te,O]=I.useState(zi.topTestPointSize),[W,Y]=I.useState(zi.bottomTestPointSize),[D,J]=I.useState(zi.topComponentColor),[$,je]=I.useState(zi.bottomComponentColor),[ee,de]=I.useState(zi.topComponentSize),[Ne,Ie]=I.useState(zi.bottomComponentSize),[$e,q]=I.useState(zi.componentConnectionColor),[w,V]=I.useState(zi.componentConnectionSize),H=I.useCallback(()=>{r(zi.brushColor),s(zi.brushSize),d(zi.topTraceColor),p(zi.bottomTraceColor),m(zi.topTraceSize),_(zi.bottomTraceSize),T(zi.topPadColor),P(zi.bottomPadColor),y(zi.topPadSize),E(zi.bottomPadSize),ne(zi.topTestPointColor),G(zi.bottomTestPointColor),O(zi.topTestPointSize),Y(zi.bottomTestPointSize),J(zi.topComponentColor),je(zi.bottomComponentColor),de(zi.topComponentSize),Ie(zi.bottomComponentSize),q(zi.componentConnectionColor),V(zi.componentConnectionSize)},[]),ue=I.useCallback(xe=>{xe.brushColor!==void 0&&r(xe.brushColor),xe.brushSize!==void 0&&s(xe.brushSize),xe.topTraceColor!==void 0&&d(xe.topTraceColor),xe.bottomTraceColor!==void 0&&p(xe.bottomTraceColor),xe.topTraceSize!==void 0&&m(xe.topTraceSize),xe.bottomTraceSize!==void 0&&_(xe.bottomTraceSize),xe.topPadColor!==void 0&&T(xe.topPadColor),xe.bottomPadColor!==void 0&&P(xe.bottomPadColor),xe.topPadSize!==void 0&&y(xe.topPadSize),xe.bottomPadSize!==void 0&&E(xe.bottomPadSize),xe.topTestPointColor!==void 0&&ne(xe.topTestPointColor),xe.bottomTestPointColor!==void 0&&G(xe.bottomTestPointColor),xe.topTestPointSize!==void 0&&O(xe.topTestPointSize),xe.bottomTestPointSize!==void 0&&Y(xe.bottomTestPointSize),xe.topComponentColor!==void 0&&J(xe.topComponentColor),xe.bottomComponentColor!==void 0&&je(xe.bottomComponentColor),xe.topComponentSize!==void 0&&de(xe.topComponentSize),xe.bottomComponentSize!==void 0&&Ie(xe.bottomComponentSize),xe.componentConnectionColor!==void 0&&q(xe.componentConnectionColor),xe.componentConnectionSize!==void 0&&V(xe.componentConnectionSize)},[]),ve=I.useCallback((xe,De,Ye)=>{},[]),se=I.useCallback((xe,De,Ye)=>{},[]),ze=I.useCallback(()=>({brushColor:n,brushSize:o,topTraceColor:l,bottomTraceColor:b,topTraceSize:v,bottomTraceSize:j,viaSize:zi.viaSize,viaColor:zi.viaColor,topPadColor:M,bottomPadColor:F,topPadSize:k,bottomPadSize:ae,topTestPointColor:U,bottomTestPointColor:Z,topTestPointSize:te,bottomTestPointSize:W,topComponentColor:D,bottomComponentColor:$,topComponentSize:ee,bottomComponentSize:Ne,componentConnectionColor:$e,componentConnectionSize:w}),[n,o,l,b,v,j,M,F,k,ae,U,Z,te,W,D,$,ee,Ne,$e,w]);return{brushColor:n,setBrushColor:r,brushSize:o,setBrushSize:s,topTraceColor:l,setTopTraceColor:d,bottomTraceColor:b,setBottomTraceColor:p,topTraceSize:v,setTopTraceSize:m,bottomTraceSize:j,setBottomTraceSize:_,topPadColor:M,setTopPadColor:T,bottomPadColor:F,setBottomPadColor:P,topPadSize:k,setTopPadSize:y,bottomPadSize:ae,setBottomPadSize:E,topTestPointColor:U,setTopTestPointColor:ne,bottomTestPointColor:Z,setBottomTestPointColor:G,topTestPointSize:te,setTopTestPointSize:O,bottomTestPointSize:W,setBottomTestPointSize:Y,topComponentColor:D,setTopComponentColor:J,bottomComponentColor:$,setBottomComponentColor:je,topComponentSize:ee,setTopComponentSize:de,bottomComponentSize:Ne,setBottomComponentSize:Ie,componentConnectionColor:$e,setComponentConnectionColor:q,componentConnectionSize:w,setComponentConnectionSize:V,resetToDefaults:H,loadFromProject:ue,getCurrentSettings:ze,saveDefaultSize:ve,saveDefaultColor:se}}function Hw(n,r,o,s,l,d,b,p,v,m,j,_,M,T,F,P,k,y,ae,E,U,ne,Z,G,te){const[O,W]=I.useState(()=>n()),Y=I.useRef(null),D=I.useRef(s),J=I.useRef(l),$=I.useCallback(de=>r==="draw"&&o==="trace"?de.get("trace"):r==="draw"&&o==="via"?de.get("via"):r==="draw"&&o==="pad"?de.get("pad"):r==="component"?de.get("component"):r==="power"?de.get("power"):r==="ground"?de.get("ground"):null,[r,o]);I.useEffect(()=>{W(de=>{const Ne=$(de),Ie=Ne?.id||null,$e=Y.current,q=new Map(de);if($e&&$e!==Ie){const w=de.get($e);w&&q.set($e,{...w,settings:{color:D.current,size:J.current}})}if(Ne&&Ie!==$e)if(r==="draw"&&o==="trace"){const w=ne||"top",V=w==="top"?d:b,H=w==="top"?p:v;D.current=V,J.current=H,q.set("trace",{...Ne,settings:{color:V,size:H}})}else if(r==="draw"&&o==="pad"){const w=Z||"top",V=w==="top"?m:j,H=w==="top"?_:M;D.current=V,J.current=H,q.set("pad",{...Ne,settings:{color:V,size:H}})}else if(r==="component"){const w=te||"top",V=w==="top"?y:ae,H=w==="top"?E:U;D.current=V,J.current=H,q.set("component",{...Ne,settings:{color:V,size:H}})}else D.current=Ne.settings.color,J.current=Ne.settings.size;return Y.current=Ie,q})},[r,o,d,b,p,v,m,j,_,M,y,ae,E,U,ne,Z,te,$]);const je=I.useCallback((de,Ne)=>{W(Ie=>{const $e=new Map(Ie),q=$e.get(de);return q&&$e.set(de,{...q,settings:Ne}),$e})},[]),ee=I.useCallback((de,Ne,Ie)=>{W($e=>{const q=new Map($e),w=q.get(de);if(w){const V=new Map(w.layerSettings);V.set(Ne,Ie),q.set(de,{...w,layerSettings:V})}return q})},[]);return{toolRegistry:O,setToolRegistry:W,updateToolSettings:je,updateToolLayerSettings:ee,getCurrentToolDef:$}}function Ww(n){const{currentTool:r,drawingMode:o,traceToolLayer:s,padToolLayer:l,testPointToolLayer:d,componentToolLayer:b}=n,[p,v]=I.useState(0),m=I.useCallback(()=>r==="draw"&&o==="via"?"via":r==="draw"&&o==="pad"?l==="bottom"?"padBottom":"padTop":r==="draw"&&o==="testPoint"?d==="bottom"?"testPointBottom":"testPointTop":r==="draw"&&o==="trace"?s==="bottom"?"traceBottom":"traceTop":r==="component"?b==="bottom"?"componentBottom":"componentTop":r==="power"?"power":r==="ground"?"ground":null,[r,o,l,d,s,b]),j=I.useCallback(()=>{const F=m();if(F){const P=Ln.get(F);return{currentTool:r,drawingMode:o,layer:r==="draw"&&o==="pad"?l||"top":r==="draw"&&o==="testPoint"?d||"top":r==="draw"&&o==="trace"?s||"top":r==="component"?b||"top":void 0,toolInstanceId:F,color:P.color,size:P.size}}return{currentTool:r,drawingMode:o,layer:void 0,toolInstanceId:null,color:"#000000",size:10}},[r,o,l,d,s,b,m]);I.useEffect(()=>{const F=m();return F?Ln.subscribe(F,()=>{v(k=>k+1)}):void 0},[m]);const _=j(),M=I.useCallback(F=>{const P=m();P&&Ln.setColor(P,F)},[m]),T=I.useCallback(F=>{const P=m();P&&Ln.setSize(P,F)},[m]);return{toolState:_,setColor:M,setSize:T,getCurrentToolInstanceId:m}}function $w(){const[n,r]=I.useState(!1),[o,s]=I.useState(!1),[l,d]=I.useState(!1),[b,p]=I.useState(!1),[v,m]=I.useState(!1),[j,_]=I.useState(!1),[M,T]=I.useState(!1),[F,P]=I.useState(!1),k=I.useCallback(()=>{r(!0),s(!0),d(!0),p(!0),m(!0),_(!0),T(!0),P(!0)},[]),y=I.useCallback(()=>{r(!1),s(!1),d(!1),p(!1),m(!1),_(!1),T(!1),P(!1)},[]);return{areImagesLocked:n,setAreImagesLocked:r,areViasLocked:o,setAreViasLocked:s,arePadsLocked:l,setArePadsLocked:d,areTestPointsLocked:b,setAreTestPointsLocked:p,areTracesLocked:v,setAreTracesLocked:m,areComponentsLocked:j,setAreComponentsLocked:_,areGroundNodesLocked:M,setAreGroundNodesLocked:T,arePowerNodesLocked:F,setArePowerNodesLocked:P,lockAll:k,unlockAll:y}}function Yw(){const[n,r]=I.useState(null),[o,s]=I.useState({visible:!1,size:6}),[l,d]=I.useState({visible:!1,interval:5}),[b,p]=I.useState({visible:!1,source:null,interval:5}),[v,m]=I.useState({visible:!1,text:""}),[j,_]=I.useState({visible:!1,title:"",message:""}),[M,T]=I.useState({visible:!1}),[F,P]=I.useState({visible:!1}),[k,y]=I.useState({visible:!1,projectName:"",locationPath:"",locationHandle:null}),[ae,E]=I.useState({visible:!1,filename:"",locationPath:"",locationHandle:null}),[U,ne]=I.useState(!1),[Z,G]=I.useState(!0),[te,O]=I.useState(!1);return{openMenu:n,setOpenMenu:r,setSizeDialog:o,setSetSizeDialog:s,autoSaveDialog:l,setAutoSaveDialog:d,autoSavePromptDialog:b,setAutoSavePromptDialog:p,debugDialog:v,setDebugDialog:m,errorDialog:j,setErrorDialog:_,newProjectDialog:M,setNewProjectDialog:T,openProjectDialog:F,setOpenProjectDialog:P,newProjectSetupDialog:k,setNewProjectSetupDialog:y,saveAsDialog:ae,setSaveAsDialog:E,showColorPicker:U,setShowColorPicker:ne,showWelcomeDialog:Z,setShowWelcomeDialog:G,transformImagesDialogVisible:te,setTransformImagesDialogVisible:O}}function Gw(){const[n,r]=I.useState(!1),[o,s]=I.useState(1),[l,d]=I.useState(null),[b,p]=I.useState(""),[v,m]=I.useState(""),[j,_]=I.useState(null),[M,T]=I.useState("pcb_project"),[F,P]=I.useState([]),[k,y]=I.useState(-1),ae=I.useRef(null),E=I.useRef(!1),U=I.useRef(!1);return{autoSaveEnabled:n,setAutoSaveEnabled:r,autoSaveInterval:o,setAutoSaveInterval:s,autoSaveDirHandle:l,setAutoSaveDirHandle:d,autoSaveBaseName:b,setAutoSaveBaseName:p,currentProjectFilePath:v,setCurrentProjectFilePath:m,projectDirHandle:j,setProjectDirHandle:_,projectName:M,setProjectName:T,autoSaveFileHistory:F,setAutoSaveFileHistory:P,currentFileIndex:k,setCurrentFileIndex:y,autoSaveIntervalRef:ae,hasChangesSinceLastAutoSaveRef:E,prevAutoSaveEnabledRef:U}}function Xw(){const[n,r]=I.useState(null),o=I.useRef(!1),s=I.useCallback((p,v,m,j,_)=>{if(o.current)return;const M={drawingStrokes:JSON.parse(JSON.stringify(p)),componentsTop:JSON.parse(JSON.stringify(v)),componentsBottom:JSON.parse(JSON.stringify(m)),powerSymbols:JSON.parse(JSON.stringify(j)),groundSymbols:JSON.parse(JSON.stringify(_))};r(M)},[]),l=I.useCallback(()=>{if(!n)return null;o.current=!0;const p=n;return r(null),setTimeout(()=>{o.current=!1},100),p},[n]),d=n!==null,b=I.useCallback(()=>{r(null)},[]);return{saveSnapshot:s,undo:l,canUndo:d,clearSnapshot:b}}sx();function Kw(){const r=Uw(),{topImage:o,setTopImage:s,bottomImage:l,setBottomImage:d,currentView:b,setCurrentView:p,transparency:v,setTransparency:m,isTransparencyCycling:j,setIsTransparencyCycling:_,transparencyCycleSpeed:M,setTransparencyCycleSpeed:T,isGrayscale:F,setIsGrayscale:P}=r,[k,y]=I.useState("none"),[ae,E]=I.useState(()=>{const c=localStorage.getItem("bomExportFormat");return c==="json"||c==="pdf"?c:"pdf"});At.useEffect(()=>{localStorage.setItem("bomExportFormat",ae)},[ae]);const[U,ne]=I.useState(()=>{const c=localStorage.getItem("netlistExportFormat");return c==="kicad"||c==="protel"||c==="spice"||c==="pads"?c:"kicad"});At.useEffect(()=>{localStorage.setItem("netlistExportFormat",U)},[U]);const Z=qw(),{brushColor:G,setBrushColor:te,brushSize:O,setBrushSize:W,topTraceColor:Y,setTopTraceColor:D,bottomTraceColor:J,setBottomTraceColor:$,topTraceSize:je,setTopTraceSize:ee,bottomTraceSize:de,setBottomTraceSize:Ne,topPadColor:Ie,setTopPadColor:$e,bottomPadColor:q,setBottomPadColor:w,topPadSize:V,setTopPadSize:H,bottomPadSize:ue,setBottomPadSize:ve,topTestPointColor:se,setTopTestPointColor:ze,bottomTestPointColor:xe,setBottomTestPointColor:De,topTestPointSize:Ye,setTopTestPointSize:lt,bottomTestPointSize:St,setBottomTestPointSize:Wt,topComponentColor:ge,setTopComponentColor:Ot,bottomComponentColor:_t,setBottomComponentColor:qt,topComponentSize:ht,setTopComponentSize:fn,bottomComponentSize:Yt,setBottomComponentSize:ln,componentConnectionColor:cn,setComponentConnectionColor:Sn,componentConnectionSize:mn,setComponentConnectionSize:tt,saveDefaultSize:Bt,saveDefaultColor:Gt}=Z,an=Bw(),{drawingStrokes:dt,setDrawingStrokes:Mt,isDrawing:Me,setIsDrawing:we,currentStroke:st,setCurrentStroke:et,tracePreviewMousePos:Pt,setTracePreviewMousePos:Rt,drawingMode:Ge,setDrawingMode:zt,selectedDrawingLayer:Tt,setSelectedDrawingLayer:tn,currentStrokeRef:Xt,lastTraceClickTimeRef:pn,isDoubleClickingTraceRef:ti}=an,Go=Fw(),{selectedImageForTransform:zn,setSelectedImageForTransform:Bi,isTransforming:ni,setIsTransforming:nn,transformStartPos:xi,setTransformStartPos:hi,transformMode:fr,setTransformMode:zr}=Go,or=Ew(),{viewScale:xt,setViewScale:Yn,viewRotation:ui,setViewRotation:Si,viewFlipX:ut,setViewFlipX:Et,cameraWorldCenter:En,setCameraWorldCenter:Zt,resetView:Vn,isShiftConstrained:Ti,setIsShiftConstrained:_i,showBothLayers:mr,setShowBothLayers:mi,setCameraCenter:pr,getViewPan:Ci}=or,[_n,ko]=I.useState("top"),[qn,us]=I.useState("top"),[gi,Mo]=I.useState("top"),[Ei,zs]=I.useState("top"),Ka=At.useRef("top"),Za=At.useRef("top"),ds=At.useRef("top"),Ur=At.useRef("top");At.useEffect(()=>{Ka.current=_n},[_n]),At.useEffect(()=>{Za.current=qn},[qn]),At.useEffect(()=>{ds.current=gi},[gi]),At.useEffect(()=>{Ur.current=Ei},[Ei]);const Ws=Ww({currentTool:k,drawingMode:Ge,traceToolLayer:_n,padToolLayer:qn,testPointToolLayer:gi,componentToolLayer:Ei}),{toolState:_r}=Ws,$i=Hw(J5,k,Ge,G,O,Y,J,je,de,Ie,q,V,ue,se,xe,Ye,St,ge,_t,ht,Yt,_n,qn,gi,Ei),{toolRegistry:yi,setToolRegistry:Tr,getCurrentToolDef:Ja,updateToolSettings:Yl,updateToolLayerSettings:xo}=$i,uo=At.useRef(null),Qi=At.useRef(G),Xo=At.useRef(O);At.useEffect(()=>{Tr(c=>{const g=Ja(c),A=g?.id||null,L=uo.current,K=new Map(c);if(L&&L!==A){const oe=c.get(L);oe&&K.set(L,{...oe,settings:{color:Qi.current,size:Xo.current}})}if(g&&A!==L)if(k==="draw"&&Ge==="trace"){const oe=_n||"top",z=oe==="top"?Y:J,Ae=oe==="top"?je:de;te(z),W(Ae),Qi.current=z,Xo.current=Ae;const Se=new Map(g.layerSettings);Se.set("top",{color:Y,size:je}),Se.set("bottom",{color:J,size:de}),K.set("trace",{...g,settings:{color:z,size:Ae},layerSettings:Se})}else if(k==="draw"&&Ge==="pad"){const oe=qn||"top",z=oe==="top"?Ie:q,Ae=oe==="top"?V:ue;te(z),W(Ae),Qi.current=z,Xo.current=Ae;const Se=new Map(g.layerSettings);Se.set("top",{color:Ie,size:V}),Se.set("bottom",{color:q,size:ue}),K.set("pad",{...g,settings:{color:z,size:Ae},layerSettings:Se})}else if(k==="draw"&&Ge==="testPoint"){const oe=gi||"top",z=oe==="top"?se:xe,Ae=oe==="top"?Ye:St;te(z),W(Ae),Qi.current=z,Xo.current=Ae;const Se=new Map(g.layerSettings);Se.set("top",{color:se,size:Ye}),Se.set("bottom",{color:xe,size:St}),K.set("testPoint",{...g,settings:{color:z,size:Ae},layerSettings:Se})}else if(k==="component"){const oe=Ei||"top",z=oe==="top"?ge:_t,Ae=oe==="top"?ht:Yt;te(z),W(Ae),Qi.current=z,Xo.current=Ae;const Se=new Map(g.layerSettings);Se.set("top",{color:ge,size:ht}),Se.set("bottom",{color:_t,size:Yt}),K.set("component",{...g,settings:{color:z,size:Ae},layerSettings:Se})}else{const oe=g.settings;te(oe.color),W(oe.size),Qi.current=oe.color,Xo.current=oe.size}return uo.current=A,K})},[k,Ge,Ja,Y,J,je,de,Ie,q,V,ue,se,xe,Ye,St,gi,ge,_t,ht,Yt]),At.useEffect(()=>{const c=yi.get("trace");if(c){const K=c.layerSettings.get("top"),oe=c.layerSettings.get("bottom");K&&(D(K.color),ee(K.size)),oe&&($(oe.color),Ne(oe.size))}const g=yi.get("pad");if(g){const K=g.layerSettings.get("top"),oe=g.layerSettings.get("bottom");K&&($e(K.color),H(K.size)),oe&&(w(oe.color),ve(oe.size))}const A=yi.get("testPoint");if(A){const K=A.layerSettings.get("top"),oe=A.layerSettings.get("bottom");K&&(ze(K.color),lt(K.size)),oe&&(De(oe.color),Wt(oe.size))}const L=yi.get("component");if(L){const K=L.layerSettings.get("top"),oe=L.layerSettings.get("bottom");K&&(Ot(K.color),fn(K.size)),oe&&(qt(oe.color),ln(oe.size))}},[]),At.useEffect(()=>{Tr(c=>{const g=new Map(c),A=c.get("trace");if(A){const Ae=new Map(A.layerSettings);Ae.set("top",{color:Y,size:je}),Ae.set("bottom",{color:J,size:de}),g.set("trace",{...A,layerSettings:Ae})}const L=c.get("pad");if(L){const Ae=new Map(L.layerSettings);Ae.set("top",{color:Ie,size:V}),Ae.set("bottom",{color:q,size:ue}),g.set("pad",{...L,layerSettings:Ae})}const K=c.get("testPoint");if(K){const Ae=new Map(K.layerSettings);Ae.set("top",{color:se,size:Ye}),Ae.set("bottom",{color:xe,size:St}),g.set("testPoint",{...K,layerSettings:Ae})}const oe=c.get("component");if(oe){const Ae=new Map(oe.layerSettings);Ae.set("top",{color:ge,size:ht}),Ae.set("bottom",{color:_t,size:Yt}),g.set("component",{...oe,layerSettings:Ae})}const z=c.get("componentConnection");return z&&g.set("componentConnection",{...z,settings:{color:cn,size:mn}}),g})},[Y,J,je,de,Ie,q,V,ue,se,xe,Ye,St,ge,_t,ht,Yt,cn,mn,Tr]),At.useEffect(()=>{Tr(c=>{const g=Ja(c);if(g)if(k==="draw"&&Ge==="trace"){const A=_n||"top",L=A==="top"?"traceTop":"traceBottom",K=Ln.get(L),oe=K.color,z=K.size;A==="top"?(D(oe),ee(z),Gt("trace",oe,"top"),Bt("trace",z,"top")):($(oe),Ne(z),Gt("trace",oe,"bottom"),Bt("trace",z,"bottom"));const Ae=new Map(c),Se=new Map(g.layerSettings);return Se.set(A,{color:oe,size:z}),Ae.set(g.id,{...g,layerSettings:Se,settings:{color:oe,size:z}}),Qi.current=oe,Xo.current=z,Ae}else if(k==="draw"&&Ge==="pad"){const A=qn||"top",L=A==="top"?"padTop":"padBottom",K=Ln.get(L),oe=K.color,z=K.size;A==="top"?($e(oe),H(z),Gt("pad",oe,"top"),Bt("pad",z,"top")):(w(oe),ve(z),Gt("pad",oe,"bottom"),Bt("pad",z,"bottom"));const Ae=new Map(c),Se=new Map(g.layerSettings);return Se.set(A,{color:oe,size:z}),Ae.set(g.id,{...g,layerSettings:Se,settings:{color:oe,size:z}}),Qi.current=oe,Xo.current=z,Ae}else if(k==="draw"&&Ge==="testPoint"){const A=gi||"top",L=A==="top"?"testPointTop":"testPointBottom",K=Ln.get(L),oe=K.color,z=K.size;A==="top"?(ze(oe),lt(z),Gt("testPoint",oe,"top"),Bt("testPoint",z,"top")):(De(oe),Wt(z),Gt("testPoint",oe,"bottom"),Bt("testPoint",z,"bottom"));const Ae=new Map(c),Se=new Map(g.layerSettings);return Se.set(A,{color:oe,size:z}),Ae.set(g.id,{...g,layerSettings:Se,settings:{color:oe,size:z}}),Qi.current=oe,Xo.current=z,Ae}else if(k==="component"){const A=Ei||"top",L=A==="top"?"componentTop":"componentBottom",K=Ln.get(L),oe=K.color,z=K.size;A==="top"?(Ot(oe),fn(z),Gt("component",oe,"top"),Bt("component",z,"top")):(qt(oe),ln(z),Gt("component",oe,"bottom"),Bt("component",z,"bottom"));const Ae=new Map(c),Se=new Map(g.layerSettings);return Se.set(A,{color:oe,size:z}),Ae.set(g.id,{...g,layerSettings:Se,settings:{color:oe,size:z}}),Qi.current=oe,Xo.current=z,Ae}else{const A=new Map(c);return A.set(g.id,{...g,settings:{color:G,size:O}}),Qi.current=G,Xo.current=O,A}return c})},[G,O,k,Ge,_n,qn,gi,Ei,Ja,Gt,Bt,sf,D,$,ee,Ne,$e,w,H,ve,ze,De,lt,Wt,Ot,qt,fn,ln]),At.useEffect(()=>{if(k==="draw"&&Ge==="trace"){const c=_n;tn(c),te(c==="top"?Y:J),W(c==="top"?je:de),c==="top"?(To(!0),Hi(!0)):(qi(!0),oa(!0)),nc(!0)}else nc(!1)},[k,Ge,_n,Y,J,je,de]),At.useEffect(()=>{if(k==="draw"&&Ge==="pad"){const c=qn;tn(c);const g=Ln.get(c==="top"?"padTop":"padBottom");te(g.color),W(g.size),c==="top"?(To(!0),va(!0)):(qi(!0),x(!0)),xc(!0)}else xc(!1)},[k,Ge,qn]),At.useEffect(()=>{if(k==="draw"&&Ge==="testPoint"){const c=gi;tn(c),te(c==="top"?se:xe),W(c==="top"?Ye:St),c==="top"?(To(!0),R(!0)):(qi(!0),ie(!0)),pu(!0)}else pu(!1)},[k,Ge,gi,se,xe,Ye,St]);const[Gl,ca]=I.useState(!1),[Cr,Xl]=I.useState(!1);At.useEffect(()=>{if(k==="component"){const c=Ei;tn(c),te(c==="top"?ge:_t),W(c==="top"?ht:Yt),c==="top"?(To(!0),le(!0)):(qi(!0),Te(!0)),Gl||mc(!0)}else mc(!1),ca(!1)},[k,Ei,ge,_t,ht,Yt,Gl]),At.useEffect(()=>{if(k==="component"){const c=Ei;tn(c),te(c==="top"?ge:_t),W(c==="top"?ht:Yt)}},[Ei,k,ge,_t,ht,Yt]),At.useEffect(()=>{_r.toolInstanceId&&(te(_r.color),W(_r.size))},[_r.toolInstanceId,_r.color,_r.size,te,W,k,Ge]);const[Wr,Di]=I.useState(void 0),[,cl]=I.useState([]),[,Ba]=I.useState([]),[,Bo]=I.useState([]),[,fs]=I.useState([]),[ka,Ko]=I.useState([]),[Qr,jr]=I.useState([]),[ps,Oa]=I.useState([]),[$s,kn]=I.useState([]),Ct=I.useRef(null),Kn=At.useMemo(()=>{const c=Ct.current;if(!c)return{x:0,y:0};const g=(c.width-10)/2,A=(c.height-10)/2;return Ci(g,A)},[Ct.current?.width,Ct.current?.height,En,xt,Ci]),Fa=At.useCallback(c=>{const g=Ct.current;if(!g)return;const A=(g.width-10)/2,L=(g.height-10)/2,K=Ci(A,L),oe=typeof c=="function"?c(K):c,z=(A-oe.x)/xt,Ae=(L-oe.y)/xt;Zt({x:z,y:Ae})},[Ci,xt,Zt]),ua=Ow(),{selectedIds:wn,setSelectedIds:Tn,isSelecting:ul,setIsSelecting:Oo,selectedComponentIds:Mn,setSelectedComponentIds:yn,selectedPowerIds:Ri,setSelectedPowerIds:hn,selectedGroundIds:ji,setSelectedGroundIds:Cn}=ua,Zo=Y2(),{componentsTop:Qt,setComponentsTop:oi,componentsBottom:en,setComponentsBottom:Ni,componentEditor:Ua,setComponentEditor:Ea,connectingPin:fo,setConnectingPin:Aa,componentDialogPosition:hs,setComponentDialogPosition:Qa,isDraggingDialog:Ys,setIsDraggingDialog:nu,dialogDragOffset:gs,setDialogDragOffset:iu,openComponentEditor:C}=Zo,Q=Vw(),{powerBuses:pe,setPowerBuses:Be,groundBuses:Ve,setGroundBuses:gt,powerSymbols:mt,setPowerSymbols:$t,groundSymbols:Jt,setGroundSymbols:rn,powerEditor:Bn,setPowerEditor:di}=Q,eo=Xw(),{saveSnapshot:Yi,undo:Dr,clearSnapshot:Rr}=eo;At.useEffect(()=>{k==="power"?(fi(!1),pe.length>1?Fi&&pe.some(g=>g.id===Fi)?Un(!1):(Un(!0),Fi!==null&&Jn(null)):pe.length===1?(Jn(pe[0].id),Un(!1)):(Un(!0),Jn(null))):Un(!1)},[k,pe]),At.useEffect(()=>{k==="ground"?(Un(!1),Ve.length>1?nr&&Ve.some(g=>g.id===nr)?fi(!1):(fi(!0),nr!==null&&yo(null)):Ve.length===1?(yo(Ve[0].id),fi(!1)):(fi(!0),yo(null))):fi(!1)},[k,Ve]),At.useEffect(()=>{k!=="power"&&k!=="ground"&&(Un(!1),fi(!1))},[k]);const Ao=$w(),{areImagesLocked:ar,setAreImagesLocked:da,areViasLocked:Lr,setAreViasLocked:fa,arePadsLocked:pa,setArePadsLocked:ys,areTestPointsLocked:Jo,setAreTestPointsLocked:Pa,areTracesLocked:po,setAreTracesLocked:ha,areComponentsLocked:er,setAreComponentsLocked:za,areGroundNodesLocked:mo,setAreGroundNodesLocked:es,arePowerNodesLocked:tr,setArePowerNodesLocked:to}=Ao,Tl=Yw(),{openMenu:zc,setOpenMenu:_s,setSizeDialog:_a,setSetSizeDialog:ts,autoSaveDialog:Gs,setAutoSaveDialog:Po,autoSavePromptDialog:ns,setAutoSavePromptDialog:ho,debugDialog:Fo,setDebugDialog:$r,errorDialog:Ds,setErrorDialog:Qo,newProjectDialog:Xs,setNewProjectDialog:Va,setOpenProjectDialog:Kl,newProjectSetupDialog:Zn,setNewProjectSetupDialog:xs,saveAsDialog:Gi,setSaveAsDialog:ea,showColorPicker:Uo,setShowColorPicker:ga,transformImagesDialogVisible:_c,setTransformImagesDialogVisible:Ks}=Tl,Cl=Gw(),[jl,bo]=I.useState(!1),[Nl,Eo]=I.useState(!1),[qa,hr]=I.useState(!1),[is,Vi]=I.useState(null),[Xi,gr]=I.useState(null),[vo,rs]=I.useState(null),[Zs,fc]=I.useState(null),[ru,Ku]=I.useState(null),{autoSaveEnabled:Ha,setAutoSaveEnabled:go,autoSaveInterval:kl,setAutoSaveInterval:zo,autoSaveDirHandle:Rs,setAutoSaveDirHandle:wo,autoSaveBaseName:_o,setAutoSaveBaseName:no,currentProjectFilePath:ya,setCurrentProjectFilePath:sr,projectDirHandle:ai,setProjectDirHandle:Mr,projectName:io,setProjectName:Do,autoSaveFileHistory:dl,setAutoSaveFileHistory:Wa,currentFileIndex:ta,setCurrentFileIndex:Yr,autoSaveIntervalRef:Ii,hasChangesSinceLastAutoSaveRef:Ai,prevAutoSaveEnabledRef:Dc}=Cl,br=I.useRef(Rs),ro=I.useRef(_o),fl=I.useRef(ya),oo=I.useRef([]),os=I.useRef(-1),na=I.useRef(null),pl=I.useRef(!1);At.useEffect(()=>{br.current=Rs},[Rs]),At.useEffect(()=>{ro.current=_o},[_o]),At.useEffect(()=>{fl.current=ya},[ya]),At.useEffect(()=>{oo.current=dl},[dl]),At.useEffect(()=>{os.current=ta},[ta]),At.useEffect(()=>{pl.current||(na.current=ai)},[ai]);const ou=I.useRef(null),ms=I.useRef(null),as=I.useRef(null),hl=I.useRef(null),Rc=I.useRef(null),Al=I.useRef(null),bs=I.useRef(null),[ia,$a]=I.useState(!1),So=I.useRef(null),Ro=I.useRef(null),[Da,au]=I.useState(!1),[Pl,vs]=I.useState({}),[Zu,vr]=I.useState(!1),Br=I.useCallback(()=>{const c=Ct.current;if(!c)return null;const g=c.width-10,A=c.height-10;let L=1/0,K=1/0,oe=-1/0,z=-1/0,Ae=!1;if(o){const Ue=o,Le=(Ue.width||0)/2,Ze=(Ue.height||0)/2;L=Math.min(L,Ue.x-Le),K=Math.min(K,Ue.y-Ze),oe=Math.max(oe,Ue.x+Le),z=Math.max(z,Ue.y+Ze),Ae=!0}if(l){const Ue=l,Le=(Ue.width||0)/2,Ze=(Ue.height||0)/2;L=Math.min(L,Ue.x-Le),K=Math.min(K,Ue.y-Ze),oe=Math.max(oe,Ue.x+Le),z=Math.max(z,Ue.y+Ze),Ae=!0}if(!Ae)return{pcbReferenceX:0,pcbReferenceY:0,x:0,y:0,zoom:1,viewRotation:0,viewFlipX:!1,isBottomView:!1,transparency:0,showTopImage:!0,showBottomImage:!0,showViasLayer:!0,showTopTracesLayer:!0,showBottomTracesLayer:!0,showTopPadsLayer:!0,showBottomPadsLayer:!0,showTopTestPointsLayer:!0,showBottomTestPointsLayer:!0,showTopComponents:!0,showBottomComponents:!0,showPowerLayer:!0,showGroundLayer:!0,showConnectionsLayer:!0};const Se=oe-L,_e=z-K,Pe=.1,ke=Se*(1+2*Pe),me=_e*(1+2*Pe),be=ke>0?g/ke:1,ye=me>0?A/me:1;return{pcbReferenceX:0,pcbReferenceY:0,x:0,y:0,zoom:Math.min(be,ye,1),viewRotation:0,viewFlipX:!1,isBottomView:!1,transparency:0,showTopImage:!0,showBottomImage:!0,showViasLayer:!0,showTopTracesLayer:!0,showBottomTracesLayer:!0,showTopPadsLayer:!0,showBottomPadsLayer:!0,showTopTestPointsLayer:!0,showBottomTestPointsLayer:!0,showTopComponents:!0,showBottomComponents:!0,showPowerLayer:!0,showGroundLayer:!0,showConnectionsLayer:!0}},[o,l]);At.useEffect(()=>{const c=Br();c&&vs(g=>g[0]?g:{...g,0:c})},[o,l,Br]);const On=I.useRef(null),[Vo,ao]=I.useState(!1),[xa,ma]=I.useState(null),[Ic,ba]=I.useState(null),[Gr,Js]=I.useState(null),[ws,Lc]=I.useState({width:960,height:600}),su=I.useRef(null),Zl=I.useRef(null),gl=I.useRef(null),yl=I.useRef(null),Ss=I.useRef(null),pc=I.useRef(null),Jl=I.useRef(null),[Ya,To]=I.useState(!0),[Ga,qi]=I.useState(!0),[ju,Ju]=I.useState(!1),[ra,ss]=I.useState(!0),[Ra,Hi]=I.useState(!0),[Co,oa]=I.useState(!0),[qo,va]=I.useState(!0),[f,x]=I.useState(!0),[N,R]=I.useState(!0),[X,ie]=I.useState(!0),[re,le]=I.useState(!0),[he,Te]=I.useState(!0),[Ee,Xe]=I.useState(!0),fe=mt,Re=Jt,[Je,pt]=I.useState(!1),[Qe,yt]=I.useState(null),[vt,Ft]=I.useState(!1),[Nt,bn]=I.useState(void 0),[gn,ri]=I.useState(!1),[xn,Un]=I.useState(!1),[Fi,Jn]=I.useState(null),[un,Ut]=I.useState(new Set),Qn=I.useCallback(()=>{Tn(new Set),yn(new Set),hn(new Set),Cn(new Set),Ut(new Set)},[Tn,yn,hn,Cn,Ut]),[Gn,ei]=I.useState(!1),[wr,Ho]=I.useState(null),[Wo,fi]=I.useState(!1),[nr,yo]=I.useState(null),[Er,si]=I.useState(!0),[ki,lr]=I.useState(!1),[cr,Xr]=I.useState(!1),Oi=I.useRef({}),[ci,Li]=I.useState(!0),[Pi,ur]=I.useState(!0),[Kr,ir]=I.useState(!0),[Ui,Ia]=I.useState(!1),[Ki,An]=I.useState(null),[Dn,Zi]=I.useState(!1),[wa,Ts]=I.useState(null),[Sa,yr]=I.useState(!1),[Cs,Qs]=I.useState(null),[Mc,Ir]=I.useState(!1),[Bc,Nu]=I.useState(null),[Ql,La]=I.useState([]),[Qu,zl]=I.useState({productName:"",productVersion:"",manufacturer:"",date:new Date().toISOString().split("T")[0]}),[lu,el]=I.useState(!1),[so,Or]=I.useState(null),[hc,xl]=I.useState(!1),[_l,Dl]=I.useState(null),[Is,cu]=I.useState(!1),[tl,ec]=I.useState(null),[Oc,nl]=I.useState(!1),[Fc,uu]=I.useState(null),[Sd,ml]=I.useState(!1),[bl,gc]=I.useState(!1),[ed,td]=I.useState(null),[Uc,nd]=I.useState(!1),[Ls,Ec]=I.useState(null),[Vc,il]=I.useState(!1),Ms=I.useRef(null),Bs=I.useRef(!1),Rl=I.useRef(null),yc=I.useRef(!1),rl=I.useRef(!1);At.useEffect(()=>{Ms.current=ed},[ed]),At.useEffect(()=>{Bs.current=Uc},[Uc]),At.useEffect(()=>{Rl.current=Ls},[Ls]),At.useEffect(()=>{yc.current=Vc},[Vc]),At.useEffect(()=>{rl.current=bl},[bl]);const[Td,ol]=I.useState(null),[qc,Hc]=I.useState(!1);At.useEffect(()=>{pe.length===0&&Be([{id:"default-3v3",name:"+3.3V",voltage:"+3.3VDC",color:"#ff6600"},{id:"default-5v",name:"+5V",voltage:"+5VDC",color:"#ff0000"}])},[pe.length,Be]);const vl=I.useCallback((c,g)=>{const A=fe.find(K=>K.pointId===c);if(A){const K=g.find(z=>z.id===A.powerBusId);return`Via (${K?K.voltage:A.type||"Power Node"})`}const L=Re.find(K=>K.pointId===c);return L?`Via (${L.type||"Ground"})`:"Via"},[fe,Re]),tc=I.useCallback((c,g)=>{const A=fe.find(K=>K.pointId===c);if(A){const K=g.find(z=>z.id===A.powerBusId);return`Pad (${K?K.voltage:A.type||"Power Node"})`}const L=Re.find(K=>K.pointId===c);return L?`Pad (${L.type||"Ground"})`:"Pad"},[fe,Re]),Il=I.useCallback((c,g)=>{const A=fe.find(K=>K.pointId===c);if(A){const K=g.find(z=>z.id===A.powerBusId);return`Test Point (${K?K.voltage:A.type||"Power Node"})`}const L=Re.find(K=>K.pointId===c);return L?`Test Point (${L.type||"Ground"})`:"Test Point"},[fe,Re]),sp=I.useCallback(()=>{const c=dt.filter(g=>g.type==="via").map(g=>g.id);Tn(new Set(c)),yn(new Set),hn(new Set),Cn(new Set),Ut(new Set)},[dt,Tn,yn,hn,Cn]),lp=I.useCallback(()=>{const c=dt.filter(g=>g.type==="trace").map(g=>g.id);Tn(new Set(c)),yn(new Set),hn(new Set),Cn(new Set),Ut(new Set)},[dt,Tn,yn,hn,Cn]),cp=I.useCallback(()=>{const c=dt.filter(g=>g.type==="pad").map(g=>g.id);Tn(new Set(c)),yn(new Set),hn(new Set),Cn(new Set),Ut(new Set)},[dt,Tn,yn,hn,Cn]),up=I.useCallback(()=>{const c=[...Qt,...en].map(g=>g.id);yn(new Set(c)),Tn(new Set),hn(new Set),Cn(new Set),Ut(new Set)},[Qt,en,yn,Tn,hn,Cn]),xf=I.useCallback(()=>{const c=[...Qt,...en].filter(g=>{const A=g.pinConnections||[];return!(A.length>0&&A.length===g.pinCount&&A.every(K=>K&&K.trim()!==""))}).map(g=>g.id);yn(new Set(c)),Tn(new Set),hn(new Set),Cn(new Set),Ut(new Set),$r({visible:!0,text:""})},[Qt,en,yn,Tn,hn,Cn,$r]),dp=I.useCallback(()=>{const c=new Set;let g=0;for(const A of[...Qt,...en]){const L=A.pinConnections||[];for(const K of L)if(K&&K.trim()!==""){const oe=parseInt(K.trim(),10);if(!isNaN(oe)&&oe>0){const z=`${A.id}:${oe}`;c.add(z),g++}}}if(console.log(`Component connections: ${g} connection lines found`),c.size===0){console.log("No component connections found - components may not have pins connected"),alert("No component connections found. Please connect component pins to vias or pads first.");return}Ut(c),Tn(new Set),yn(new Set),hn(new Set),Cn(new Set),console.log(`Selected ${c.size} component connection lines`)},[Qt,en,Tn,yn,hn,Cn]),mf=I.useCallback(()=>{qa?(Et(!1),hr(!1),m(0)):(Et(!0),hr(!0),m(100))},[qa,Et,hr,m]),Cd=I.useCallback(c=>{Si(g=>Wg(g,c))},[Si]),Ll=I.useCallback((c,g)=>{const A=Ct.current;if(!A)return;const L=A.width-10,K=A.height-10,oe=L/2,z=K/2,Ae=oe-c*xt,Se=z-g*xt;Fa({x:Ae,y:Se})},[xt,Fa]),bf=I.useCallback((c,g,A)=>{Ll(g,A),yn(new Set([c])),Tn(new Set),hn(new Set),Cn(new Set),Ut(new Set)},[Ll,yn,Tn,hn,Cn]),kh=I.useCallback((c,g,A)=>{Ll(g,A),Tn(new Set([c])),yn(new Set),hn(new Set),Cn(new Set),Ut(new Set)},[Ll,Tn,yn,hn,Cn]),vf=I.useCallback((c,g,A)=>{Ll(g,A),hn(new Set([c])),Tn(new Set),yn(new Set),Cn(new Set),Ut(new Set)},[Ll,hn,Tn,yn,Cn]),fp=I.useCallback((c,g,A)=>{Ll(g,A),Cn(new Set([c])),Tn(new Set),yn(new Set),hn(new Set),Ut(new Set)},[Ll,Cn,Tn,yn,hn]),pp=I.useCallback((c,g,A)=>{Ll(g,A),Tn(new Set([c])),yn(new Set),hn(new Set),Cn(new Set),Ut(new Set)},[Ll,Tn,yn,hn,Cn]),wf=At.useMemo(()=>{const c=new Set(fe.map(A=>A.powerBusId).filter(A=>typeof A=="string"&&A.length>0)),g=pe.filter(A=>c.has(A.id)).map(A=>A.name);return Array.from(new Set(g)).sort()},[fe,pe]),hp=At.useMemo(()=>{const c=new Set(Re.map(A=>A.groundBusId).filter(A=>typeof A=="string"&&A.length>0)),g=Ve.filter(A=>c.has(A.id)).map(A=>A.name);return Array.from(new Set(g)).sort()},[Re,Ve]),gp=I.useCallback(()=>{const c=fe.map(g=>g.id);hn(new Set(c)),Tn(new Set),yn(new Set),Cn(new Set),Ut(new Set)},[fe,hn,Tn,yn,Cn]),Ah=I.useCallback(()=>{const c=Re.map(g=>g.id);Cn(new Set(c)),Tn(new Set),yn(new Set),hn(new Set),Ut(new Set)},[Re,Cn,Tn,yn,hn]),Ph=I.useCallback(c=>{const g=pe.filter(L=>L.name===c).map(L=>L.id);if(g.length===0)return;const A=fe.filter(L=>L.powerBusId&&g.includes(L.powerBusId)).map(L=>L.id);hn(new Set(A)),Tn(new Set),yn(new Set),Cn(new Set)},[pe,fe,hn,Tn,yn,Cn]),yp=I.useCallback(c=>{const g=Ve.filter(L=>L.name===c).map(L=>L.id);if(g.length===0)return;const A=Re.filter(L=>L.groundBusId&&g.includes(L.groundBusId)).map(L=>L.id);Cn(new Set(A)),Tn(new Set),yn(new Set),hn(new Set)},[Ve,Re,Cn,Tn,yn,hn]);I.useCallback(c=>{switch(c.componentType){case"Resistor":case"ResistorNetwork":case"Thermistor":case"VariableResistor":if("resistance"in c&&c.resistance&&"resistanceUnit"in c&&c.resistanceUnit)return`${c.resistance} ${c.resistanceUnit}`;break;case"Capacitor":case"Electrolytic Capacitor":case"Film Capacitor":if("capacitance"in c&&c.capacitance&&"capacitanceUnit"in c&&c.capacitanceUnit)return`${c.capacitance} ${c.capacitanceUnit}`;break;case"Inductor":if("inductance"in c&&c.inductance&&"inductanceUnit"in c&&c.inductanceUnit)return`${c.inductance} ${c.inductanceUnit}`;break;case"Battery":if("voltage"in c&&c.voltage&&"voltageUnit"in c&&c.voltageUnit)return`${c.voltage} ${c.voltageUnit}`;break;case"Diode":if("voltage"in c&&c.voltage&&"voltageUnit"in c&&c.voltageUnit)return`${c.voltage} ${c.voltageUnit}`;break;case"Fuse":if("current"in c&&c.current&&"currentUnit"in c&&c.currentUnit)return`${c.current} ${c.currentUnit}`;break;case"FerriteBead":if("impedance"in c&&c.impedance&&"impedanceUnit"in c&&c.impedanceUnit)return`${c.impedance} ${c.impedanceUnit}`;break;case"Relay":if("coilVoltage"in c&&c.coilVoltage&&"coilVoltageUnit"in c&&c.coilVoltageUnit)return`${c.coilVoltage} ${c.coilVoltageUnit}`;break;case"Speaker":if("impedance"in c&&c.impedance&&"impedanceUnit"in c&&c.impedanceUnit)return`${c.impedance} ${c.impedanceUnit}`;break;case"Motor":if("voltage"in c&&c.voltage&&"voltageUnit"in c&&c.voltageUnit)return`${c.voltage} ${c.voltageUnit}`;break;case"PowerSupply":if("outputVoltage"in c&&c.outputVoltage&&"outputVoltageUnit"in c&&c.outputVoltageUnit)return`${c.outputVoltage} ${c.outputVoltageUnit}`;break;case"Transistor":if("partNumber"in c&&c.partNumber)return c.partNumber;break;case"IntegratedCircuit":if("partNumber"in c&&c.partNumber)return c.partNumber;break}return null},[]);const id=I.useCallback(c=>{const g=[];switch(c.componentType){case"Capacitor":case"Electrolytic Capacitor":case"Film Capacitor":"capacitance"in c&&c.capacitance&&"capacitanceUnit"in c&&c.capacitanceUnit&&g.push(`Capacitance: ${c.capacitance} ${c.capacitanceUnit}`),"voltage"in c&&c.voltage&&"voltageUnit"in c&&c.voltageUnit&&g.push(`Voltage: ${c.voltage} ${c.voltageUnit}`),"dielectric"in c&&c.dielectric&&g.push(`Dielectric: ${c.dielectric}`);break;case"Resistor":case"ResistorNetwork":case"Thermistor":"resistance"in c&&c.resistance&&"resistanceUnit"in c&&c.resistanceUnit&&g.push(`Resistance: ${c.resistance} ${c.resistanceUnit}`),"power"in c&&c.power&&g.push(`Power: ${c.power}`),"tolerance"in c&&c.tolerance&&g.push(`Tolerance: ${c.tolerance}`);break;case"VariableResistor":"resistance"in c&&c.resistance&&"resistanceUnit"in c&&c.resistanceUnit&&g.push(`Resistance: ${c.resistance} ${c.resistanceUnit}`),"vrType"in c&&c.vrType&&g.push(`Type: ${c.vrType}`),"power"in c&&c.power&&g.push(`Power: ${c.power}`),"taper"in c&&c.taper&&g.push(`Taper: ${c.taper}`);break;case"Inductor":"inductance"in c&&c.inductance&&"inductanceUnit"in c&&c.inductanceUnit&&g.push(`Inductance: ${c.inductance} ${c.inductanceUnit}`),"current"in c&&c.current&&"currentUnit"in c&&c.currentUnit&&g.push(`Current: ${c.current} ${c.currentUnit}`),"tolerance"in c&&c.tolerance&&g.push(`Tolerance: ${c.tolerance}`);break;case"Battery":"voltage"in c&&c.voltage&&"voltageUnit"in c&&c.voltageUnit&&g.push(`Voltage: ${c.voltage} ${c.voltageUnit}`),"capacity"in c&&c.capacity&&"capacityUnit"in c&&c.capacityUnit&&g.push(`Capacity: ${c.capacity} ${c.capacityUnit}`);break;case"Diode":"voltage"in c&&c.voltage&&"voltageUnit"in c&&c.voltageUnit&&g.push(`Voltage: ${c.voltage} ${c.voltageUnit}`),"current"in c&&c.current&&"currentUnit"in c&&c.currentUnit&&g.push(`Current: ${c.current} ${c.currentUnit}`);break;case"Fuse":"current"in c&&c.current&&"currentUnit"in c&&c.currentUnit&&g.push(`Current: ${c.current} ${c.currentUnit}`),"voltage"in c&&c.voltage&&"voltageUnit"in c&&c.voltageUnit&&g.push(`Voltage: ${c.voltage} ${c.voltageUnit}`);break;case"FerriteBead":"impedance"in c&&c.impedance&&"impedanceUnit"in c&&c.impedanceUnit&&g.push(`Impedance: ${c.impedance} ${c.impedanceUnit}`),"current"in c&&c.current&&"currentUnit"in c&&c.currentUnit&&g.push(`Current: ${c.current} ${c.currentUnit}`);break;case"Relay":"coilVoltage"in c&&c.coilVoltage&&"coilVoltageUnit"in c&&c.coilVoltageUnit&&g.push(`Coil Voltage: ${c.coilVoltage} ${c.coilVoltageUnit}`),"contactRating"in c&&c.contactRating&&g.push(`Contact Rating: ${c.contactRating}`);break;case"Speaker":"impedance"in c&&c.impedance&&"impedanceUnit"in c&&c.impedanceUnit&&g.push(`Impedance: ${c.impedance} ${c.impedanceUnit}`),"power"in c&&c.power&&g.push(`Power: ${c.power}`);break;case"Motor":"voltage"in c&&c.voltage&&"voltageUnit"in c&&c.voltageUnit&&g.push(`Voltage: ${c.voltage} ${c.voltageUnit}`),"speed"in c&&c.speed&&"speedUnit"in c&&c.speedUnit&&g.push(`Speed: ${c.speed} ${c.speedUnit}`);break;case"PowerSupply":"outputVoltage"in c&&c.outputVoltage&&"outputVoltageUnit"in c&&c.outputVoltageUnit&&g.push(`Output Voltage: ${c.outputVoltage} ${c.outputVoltageUnit}`),"outputCurrent"in c&&c.outputCurrent&&"outputCurrentUnit"in c&&c.outputCurrentUnit&&g.push(`Output Current: ${c.outputCurrent} ${c.outputCurrentUnit}`);break;case"Transistor":"partNumber"in c&&c.partNumber&&g.push(`Part Number: ${c.partNumber}`),"transistorType"in c&&c.transistorType&&g.push(`Type: ${c.transistorType}`);break;case"Crystal":"frequency"in c&&c.frequency&&g.push(`Frequency: ${c.frequency}`),"loadCapacitance"in c&&c.loadCapacitance&&g.push(`Load Capacitance: ${c.loadCapacitance}`),"tolerance"in c&&c.tolerance&&g.push(`Tolerance: ${c.tolerance}`);break;case"VacuumTube":"tubeType"in c&&c.tubeType&&g.push(`Tube Type: ${c.tubeType}`),"partNumber"in c&&c.partNumber&&g.push(`Part Number: ${c.partNumber}`);break}return g},[]),[du,nc]=I.useState(!1),fu=I.useRef(null),[rd,xc]=I.useState(!1),[jd,pu]=I.useState(!1),ku=I.useRef(null),hu=I.useRef(null),Au=I.useRef(null),od=I.useRef(null),[xp,mc]=I.useState(!1),[Ml,Nd]=I.useState(null),[mp,kd]=I.useState(null),[bc,Sf]=I.useState(null),Ad=At.useRef(null),Tf=At.useRef(null),Cf=At.useRef(null),Pu=I.useRef(null),jo=I.useRef(null),aa=I.useRef(null),bp=I.useRef(null),Pd=I.useRef(null),zd=I.useRef(null),[vp,ad]=I.useState(null),[Os,_d]=I.useState(null),[Bl,wp]=I.useState(!1),[vc,Dd]=I.useState(null),[wc,Rd]=I.useState(null);At.useEffect(()=>{Tf.current=bc},[bc]),At.useEffect(()=>{Cf.current=Ml},[Ml]);const jf=I.useCallback(async(c,g)=>{if(!g)throw new Error("No project directory available. Please create or open a project before loading images. The project directory is needed to store image files.");try{let A;try{A=await g.getDirectoryHandle("images",{create:!0})}catch(oe){throw new Error(`Failed to create images directory in project folder. This may be due to insufficient permissions. Please ensure you have write access to the project directory. Error details: ${oe.message}`)}const L=c.name,K=`images/${L}`;try{const z=await(await A.getFileHandle(L,{create:!0})).createWritable();return await z.write(c),await z.close(),console.log(`Image copied to project directory: ${K}`),K}catch(oe){throw new Error(`Failed to copy image file "${L}" to project images directory. The file may be locked by another application, or there may be insufficient disk space. Please try again or check your disk space. Error details: ${oe.message}`)}}catch(A){throw A instanceof Error&&A.message.includes("No project directory")||A instanceof Error&&A.message.includes("Failed to")?A:new Error(`An unexpected error occurred while copying the image to the project directory. This may be due to file system permissions or disk space issues. Please try again. Technical details: ${A.message}`)}},[]),Id=I.useCallback(async(c,g)=>{try{const A=c.name.toLowerCase(),K=[".png",".jpg",".jpeg"].some(ye=>A.endsWith(ye)),z=["image/png","image/jpeg","image/jpg"].includes(c.type);if(!K&&!z){alert(`Error: Unsupported image format.

The software only accepts PNG and JPEG image files.

File selected: ${c.name}
File type: ${c.type||"unknown"}

Please select a .png, .jpg, or .jpeg image file.`);return}let Ae;if(ai)try{Ae=await jf(c,ai)}catch(ye){const Ce=ye instanceof Error?ye.message:"Unknown error occurred while copying image to project directory.";alert(`Error: ${Ce}

The image could not be loaded. Please ensure you have a project open and have write permissions to the project directory.`);return}else{if(!confirm(`Warning: No project directory is currently open. The image will be loaded, but you must create or open a project and save it before the image will be stored in the project directory.

Do you want to continue loading the ${g==="top"?"top":"bottom"} image?`))return;Ae=c.name}const Se=await createImageBitmap(c),_e=URL.createObjectURL(c),Pe=Ct.current;let ke=0,me=0;Pe&&(ke=En.x,me=En.y);const be={url:_e,name:c.name,width:Se.width,height:Se.height,filePath:Ae,x:ke,y:me,scale:1,rotation:0,flipX:!1,flipY:!1,skewX:0,skewY:0,keystoneV:0,keystoneH:0,bitmap:Se};g==="top"?s(be):d(be)}catch(A){const L=A instanceof Error?A.message:"Unknown error occurred while loading the image.";alert(`Error: Failed to load image file "${c.name}".

${L}

Please ensure the file is a valid image format (PNG, JPEG, etc.) and is not corrupted.`),console.error("Failed to load image",A)}},[En,xt,ai,jf]),Nf=I.useCallback(c=>{c.stopPropagation(),c.preventDefault();const g=Ct.current;if(!g)return;document.activeElement!==g&&g.focus();const A=g.getBoundingClientRect(),L=g.width/A.width,K=g.height/A.height,oe=c.nativeEvent.offsetX,z=c.nativeEvent.offsetY,Ae=typeof oe=="number"?oe:c.clientX-A.left,Se=typeof z=="number"?z:c.clientY-A.top,_e=Ae*L,Pe=Se*K,ke=_e-5,me=Pe-5,be=Gf(ke,me,Kn,xt,ui,ut),ye=be.x,Ce=be.y;if(Bs.current&&k==="select"){il(!0),Ec({start:{x:ye,y:Ce},end:{x:ye,y:Ce}});return}if(k==="center"){vr(!0),On.current&&clearTimeout(On.current),On.current=setTimeout(()=>{vr(!1),y("select"),Di(void 0)},2e3);return}if(k==="select"){if(fo){let We=1/0,ot=null,ct=null;const Lt=Math.max(6/xt,4),sn=[...Qt,...en].find(Hn=>Hn.id===fo.componentId)?.layer||"top";for(const Hn of dt)if((Hn.type==="via"||Hn.type==="pad")&&Hn.points.length>0){if(Hn.type==="pad"&&(Hn.layer||"top")!==sn)continue;const vn=Hn.points[0],Xn=Math.max(1,Hn.size/2),Wn=Math.hypot(vn.x-ye,vn.y-Ce),Rn=Math.max(Xn,Lt);Wn<=Rn&&Wn<We&&(We=Wn,ot=vn.id??null,ct=Hn)}if(ct?(console.log(`
[PIN CONNECTION] Found via!`),console.log(`  Stroke ID: ${ct.id}`),console.log(`  Point ID: ${ot}`),console.log(`  Point coordinates: x=${ct.points[0].x.toFixed(2)}, y=${ct.points[0].y.toFixed(2)}`),console.log(`  Click coordinates: x=${ye.toFixed(2)}, y=${Ce.toFixed(2)}`),console.log(`  Distance: ${We.toFixed(2)}`),console.log(`  Via size: ${ct.size}, radius: ${Math.max(1,ct.size/2)}`)):(console.log(`
[PIN CONNECTION] No via found!`),console.log(`  Click coordinates: x=${ye.toFixed(2)}, y=${Ce.toFixed(2)}`),console.log(`  Hit tolerance: ${Lt.toFixed(2)}`),console.log(`  Total vias in drawingStrokes: ${dt.filter(Hn=>Hn.type==="via").length}`)),ot!=null){console.log(`
[PIN CONNECTION] Proceeding with connection...`),console.log(`  bestPointId is valid: ${ot} (type: ${typeof ot})`);const Hn=String(ot),vn=fo.pinIndex,Xn=fo.componentId;console.log(`
=== PIN CONNECTION START ===`),console.log(`Connecting pin ${vn} (Pin ${vn+1}) of component ${Xn} to point ID ${Hn}`);const Wn=Qt.find(Ht=>Ht.id===Xn),Rn=en.find(Ht=>Ht.id===Xn);Wn?(console.log("Component found in TOP layer"),oi(Ht=>{const In=Ht.find(li=>li.id===Xn);if(!In)return console.error(`Component ${Xn} not found in TOP layer during update!`),Ht;console.log("BEFORE update: pinConnections =",In.pinConnections);const Wi=In.pinConnections||[],Vr=Wi.length>0?[...Wi]:new Array(In.pinCount).fill("");let Fr;if(Vr.length!==In.pinCount){Fr=new Array(In.pinCount).fill("");for(let li=0;li<Math.min(Vr.length,In.pinCount);li++)Fr[li]=Vr[li]||""}else Fr=[...Vr];Fr[vn]=Hn,console.log(`Updating pin ${vn} with value: ${Hn}`),console.log("New pinConnections array:",Fr);const lo=Ht.map(li=>li.id===Xn?{...li,pinConnections:Fr}:li),$o=lo.find(li=>li.id===Xn);return console.log("AFTER update: pinConnections =",$o?.pinConnections),console.log(`Pin ${vn} value: ${$o?.pinConnections[vn]}`),console.log(`=== PIN CONNECTION COMPLETE (TOP) ===
`),lo})):Rn?(console.log("Component found in BOTTOM layer"),Ni(Ht=>{const In=Ht.find(li=>li.id===Xn);if(!In)return console.error(`Component ${Xn} not found in BOTTOM layer during update!`),Ht;console.log("BEFORE update: pinConnections =",In.pinConnections);const Wi=In.pinConnections||[],Vr=Wi.length>0?[...Wi]:new Array(In.pinCount).fill("");let Fr;if(Vr.length!==In.pinCount){Fr=new Array(In.pinCount).fill("");for(let li=0;li<Math.min(Vr.length,In.pinCount);li++)Fr[li]=Vr[li]||""}else Fr=[...Vr];Fr[vn]=Hn,console.log(`Updating pin ${vn} with value: ${Hn}`),console.log("New pinConnections array:",Fr);const lo=Ht.map(li=>li.id===Xn?{...li,pinConnections:Fr}:li),$o=lo.find(li=>li.id===Xn);return console.log("AFTER update: pinConnections =",$o?.pinConnections),console.log(`Pin ${vn} value: ${$o?.pinConnections[vn]}`),console.log(`=== PIN CONNECTION COMPLETE (BOTTOM) ===
`),lo})):(console.error(`Component ${Xn} not found in either TOP or BOTTOM layer!`),console.log("Available TOP components:",Qt.map(Ht=>Ht.id)),console.log("Available BOTTOM components:",en.map(Ht=>Ht.id))),setTimeout(()=>{Aa(null)},0);return}else Aa(null)}const Ue=10,Le=(()=>{for(const We of Qt)if(ye>=We.x-Ue&&ye<=We.x+Ue&&Ce>=We.y-Ue&&Ce<=We.y+Ue)return{layer:"top",comp:We};for(const We of en)if(ye>=We.x-Ue&&ye<=We.x+Ue&&Ce>=We.y-Ue&&Ce<=We.y+Ue)return{layer:"bottom",comp:We};return null})();if(Le){const{comp:We}=Le;c.shiftKey?yn(ot=>{const ct=new Set(ot);return ct.has(We.id)?ct.delete(We.id):ct.add(We.id),ct}):(yn(new Set([We.id])),Tn(new Set),hn(new Set),Cn(new Set));return}const Ze=Math.max(6/xt,4);let bt=null;for(const We of fe){const ot=Math.max(6,We.size/2),ct=ot*.8,Lt=ot+ct,Kt=Math.hypot(We.x-ye,We.y-Ce),sn=Math.abs(ye-We.x)<=Ze&&Math.abs(Ce-We.y)<=Lt,Hn=Math.abs(Ce-We.y)<=Ze&&Math.abs(ye-We.x)<=Lt;if(Kt<=Math.max(ot,Ze)||sn||Hn){bt=We;break}}if(bt){c.shiftKey?hn(We=>{const ot=new Set(We);return ot.has(bt.id)?ot.delete(bt.id):ot.add(bt.id),ot}):(hn(new Set([bt.id])),Tn(new Set),yn(new Set),Cn(new Set));return}let jt=null;for(const We of Re){const ot=Math.max(6,(We.size||18)/2),ct=ot*.8,Lt=ot+ct,Kt=Math.hypot(We.x-ye,We.y-Ce),sn=Math.abs(ye-We.x)<=Ze&&Math.abs(Ce-We.y)<=Lt,Hn=Math.abs(Ce-We.y)<=Ze&&Math.abs(ye-We.x)<=Lt;if(Kt<=Math.max(ot,Ze)||sn||Hn){jt=We;break}}if(jt){c.shiftKey?Cn(We=>{const ot=new Set(We);return ot.has(jt.id)?ot.delete(jt.id):ot.add(jt.id),ot}):(Cn(new Set([jt.id])),Tn(new Set),yn(new Set),hn(new Set));return}const rt=Math.max(6/xt,4/xt),Oe=Math.max(rt,.5);let qe=null;for(const We of dt)if((We.type==="via"||We.type==="pad"||We.type==="testPoint")&&We.points.length>0){let ot=!1;if(We.type==="via"?ot=ra:We.type==="pad"?ot=(We.layer||"top")==="top"?qo:f:We.type==="testPoint"&&(ot=(We.layer||"top")==="top"?N:X),!ot)continue;const ct=We.points[0],Lt=Math.max(1,We.size/2);if(Math.hypot(ct.x-ye,ct.y-Ce)<=Math.max(Lt,Oe)){qe=We;break}}if(qe){c.shiftKey?Tn(We=>{const ot=new Set(We);return ot.has(qe.id)?ot.delete(qe.id):ot.add(qe.id),ot}):(Tn(new Set([qe.id])),yn(new Set),hn(new Set),Cn(new Set),Ut(new Set));return}c.shiftKey||(Tn(new Set),yn(new Set),hn(new Set),Cn(new Set),Ut(new Set)),Oo(!0),Dd({x:ye,y:Ce,shiftKey:c.shiftKey}),Rd({x:ye,y:Ce,width:0,height:0});return}else if(k==="magnify"){const Ue=c.shiftKey?.5:2,Le=Math.max(.25,Math.min(8,xt*Ue));pr(ye,Ce),Yn(Le);return}else if(k==="pan"){const Ue={topImageX:o?.x??0,topImageY:o?.y??0,bottomImageX:l?.x??0,bottomImageY:l?.y??0,componentsTop:Object.fromEntries(Qt.map(Le=>[Le.id,{x:Le.x,y:Le.y}])),componentsBottom:Object.fromEntries(en.map(Le=>[Le.id,{x:Le.x,y:Le.y}])),powerSymbols:Object.fromEntries(mt.map(Le=>[Le.id,{x:Le.x,y:Le.y}])),groundSymbols:Object.fromEntries(Jt.map(Le=>[Le.id,{x:Le.x,y:Le.y}])),drawingStrokes:dt.map(Le=>({points:Le.points.map(Ze=>({x:Ze.x,y:Ze.y}))})),vias:ka.map(Le=>({x:Le.x,y:Le.y})),pads:Qr.map(Le=>({x:Le.x,y:Le.y}))};So.current={startCX:ke,startCY:me,panX:Kn.x,panY:Kn.y,objectStartPositions:Ue},Ro.current={startClientX:c.clientX,startClientY:c.clientY,panX:Kn.x,panY:Kn.y,objectStartPositions:Ue},$a(!0);return}else if(k==="draw"){const Ue=(bt,jt)=>{let It=1/0,rt=null;const Oe=10/xt,qe=xt>20?Math.max(Oe,1e-4):xt>10?Math.max(Oe,.001):Math.max(Oe,.01);for(const ct of dt)if(ct.type==="via"){const Lt=ct.points[0],Kt=Math.hypot(Lt.x-bt,Lt.y-jt);Kt<=qe&&Kt<It&&(It=Kt,rt=Lt)}else if(ct.type==="pad"){const Lt=ct.points[0],Kt=Math.hypot(Lt.x-bt,Lt.y-jt);Kt<=qe&&Kt<It&&(It=Kt,rt=Lt)}for(const ct of fe)if(ct.pointId!==void 0){const Lt=Math.hypot(ct.x-bt,ct.y-jt);Lt<=qe&&Lt<It&&(It=Lt,rt={x:ct.x,y:ct.y,id:ct.pointId})}for(const ct of Re)if(ct.pointId!==void 0){const Lt=Math.hypot(ct.x-bt,ct.y-jt);Lt<=qe&&Lt<It&&(It=Lt,rt={x:ct.x,y:ct.y,id:ct.pointId})}const ot=xr(rt??{x:bt,y:jt});return{x:ot.x,y:ot.y,nodeId:rt?.id}};if(Ge==="via"){const bt=Ln.get("via"),jt=bt.color,It=bt.size,Vt=Bl?{x:xr({x:ye,y:Ce}).x,y:xr({x:ye,y:Ce}).y}:((ct,Lt)=>{let Kt=1/0,sn=null;const vn=10/xt,Xn=xt>10?Math.max(vn,.001):Math.max(vn,.01);for(const Ht of dt)if(Ht.type==="via"||Ht.type==="pad"){const In=Ht.points[0],Wi=Math.hypot(In.x-ct,In.y-Lt);Wi<=Xn&&Wi<Kt&&(Kt=Wi,sn=In)}for(const Ht of fe)if(Ht.pointId!==void 0){const In=Math.hypot(Ht.x-ct,Ht.y-Lt);In<=Xn&&In<Kt&&(Kt=In,sn={x:Ht.x,y:Ht.y,id:Ht.pointId})}for(const Ht of Re)if(Ht.pointId!==void 0){const In=Math.hypot(Ht.x-ct,Ht.y-Lt);In<=Xn&&In<Kt&&(Kt=In,sn={x:Ht.x,y:Ht.y,id:Ht.pointId})}const Rn=xr(sn??{x:ct,y:Lt});return{x:Rn.x,y:Rn.y,nodeId:sn?.id}})(ye,Ce),Oe=Vt.nodeId??lc(),qe=vl(Oe,pe),We={id:Oe,x:Vt.x,y:Vt.y};Yi(dt,Qt,en,mt,Jt);const ot={id:`${Date.now()}-via`,points:[We],color:jt,size:It,layer:Tt,type:"via",viaType:qe};Mt(ct=>[...ct,ot]),Tt==="top"?cl(ct=>[...ct,ot.id]):Ba(ct=>[...ct,ot.id]);return}if(Ge==="pad"){if(!qn)return;const jt=Bl?{x:xr({x:ye,y:Ce}).x,y:xr({x:ye,y:Ce}).y}:((ot,ct)=>{let Lt=1/0,Kt=null;const Hn=10/xt,vn=xt>10?Math.max(Hn,.001):Math.max(Hn,.01);for(const Rn of dt)if(Rn.type==="via"||Rn.type==="pad"||Rn.type==="testPoint"){const Ht=Rn.points[0],In=Math.hypot(Ht.x-ot,Ht.y-ct);In<=vn&&In<Lt&&(Lt=In,Kt=Ht)}for(const Rn of fe)if(Rn.pointId!==void 0){const Ht=Math.hypot(Rn.x-ot,Rn.y-ct);Ht<=vn&&Ht<Lt&&(Lt=Ht,Kt={x:Rn.x,y:Rn.y,id:Rn.pointId})}for(const Rn of Re)if(Rn.pointId!==void 0){const Ht=Math.hypot(Rn.x-ot,Rn.y-ct);Ht<=vn&&Ht<Lt&&(Lt=Ht,Kt={x:Rn.x,y:Rn.y,id:Rn.pointId})}const Wn=xr(Kt??{x:ot,y:ct});return{x:Wn.x,y:Wn.y,nodeId:Kt?.id}})(ye,Ce),It=jt.nodeId??lc(),rt=tc(It,pe),Vt=G||(qn==="top"?Ie:q),Oe=O||(qn==="top"?V:ue),qe={id:It,x:jt.x,y:jt.y};Yi(dt,Qt,en,mt,Jt);const We={id:`${Date.now()}-pad`,points:[qe],color:Vt,size:Oe,layer:qn,type:"pad",padType:rt};Mt(ot=>[...ot,We]);return}if(Ge==="testPoint"){if(!gi)return;const jt=Bl?{x:xr({x:ye,y:Ce}).x,y:xr({x:ye,y:Ce}).y}:((ct,Lt)=>{let Kt=1/0,sn=null;const Hn=15;for(const Wn of dt)if(Wn.type==="via"||Wn.type==="pad"||Wn.type==="testPoint"){const Rn=Wn.points[0],Ht=Math.hypot(Rn.x-ct,Rn.y-Lt);Ht<=Hn&&Ht<Kt&&(Kt=Ht,sn=Rn)}for(const Wn of fe)if(Wn.pointId!==void 0){const Rn=Math.hypot(Wn.x-ct,Wn.y-Lt);Rn<=Hn&&Rn<Kt&&(Kt=Rn,sn={x:Wn.x,y:Wn.y,id:Wn.pointId})}for(const Wn of Re)if(Wn.pointId!==void 0){const Rn=Math.hypot(Wn.x-ct,Wn.y-Lt);Rn<=Hn&&Rn<Kt&&(Kt=Rn,sn={x:Wn.x,y:Wn.y,id:Wn.pointId})}const Xn=xr(sn??{x:ct,y:Lt});return{x:Xn.x,y:Xn.y,nodeId:sn?.id}})(ye,Ce),It=jt.nodeId??lc(),rt=Il(It,pe),Vt=rt.includes("Power")?"power":rt.includes("Ground")?"ground":rt.includes("Signal")?"signal":"unknown",Oe=xr({x:jt.x,y:jt.y}),qe=G||(gi==="top"?se:xe),We=O||(gi==="top"?Ye:St);Yi(dt,Qt,en,mt,Jt);const ot={id:`${Date.now()}-testPoint`,points:[{id:It,x:Oe.x,y:Oe.y}],color:qe,size:We,layer:gi,type:"testPoint",testPointType:Vt};Mt(ct=>[...ct,ot]);return}if(ti.current)return;const Le=Ge==="trace"&&!Bl?Ue(ye,Ce):{x:xr({x:ye,y:Ce}).x,y:xr({x:ye,y:Ce}).y},Ze=Le.nodeId!==void 0?{id:Le.nodeId,x:Le.x,y:Le.y}:{x:Le.x,y:Le.y};et(bt=>bt.length===0?[Ze]:[...bt,Ze]),pn.current=Date.now(),Rt(null),we(!1),_i(!1)}else if(k==="erase"){if(dt.some(Le=>Le.layer===Tt&&(Le.type==="via"&&Lr||Le.type==="pad"&&pa||Le.type==="testPoint"&&Jo||Le.type==="trace"&&po))){const Le=[];Lr&&dt.some(Ze=>Ze.layer===Tt&&Ze.type==="via")&&Le.push("vias"),pa&&dt.some(Ze=>Ze.layer===Tt&&Ze.type==="pad")&&Le.push("pads"),Jo&&dt.some(Ze=>Ze.layer===Tt&&Ze.type==="testPoint")&&Le.push("test points"),po&&dt.some(Ze=>Ze.layer===Tt&&Ze.type==="trace")&&Le.push("traces"),Le.length>0&&alert(`Cannot erase: ${Le.join(", ")} are locked on the ${Tt} layer. Unlock them to erase.`)}we(!0),et([{id:lc(),x:ye,y:Ce}]),console.log("Starting erase at:",ye,Ce,"selectedDrawingLayer:",Tt,"total strokes:",dt.length)}else if(k==="transform"&&zn){if(ar){alert("Cannot transform: Images are locked. Unlock images to transform them.");return}nn(!0),hi({x:ye,y:Ce})}else if(k==="component"){if(!Cf.current)return;const Ue=xr({x:ye,y:Ce}),Ze=(Ur.current||"top")==="top"?"componentTop":"componentBottom",bt=Ln.get(Ze),jt=bt.color,It=bt.size,rt=[...Qt,...en];let Vt;if(ki?Vt=Xf():Vt={...Oi.current},!Ur.current)return;const Oe=Tf.current?.dataDrivenDefinition;if(!Oe){console.error("[Component Creation] Missing dataDrivenDefinition metadata for selected component.");return}let qe;try{qe=B2({definition:Oe,layer:Ur.current,x:Ue.x,y:Ue.y,color:jt,size:It,existingComponents:rt,counters:Er?Vt:{}})}catch(We){console.error("[Component Creation] Error creating component with v2 runtime:",We);return}if(qe.abbreviation=qg(Cf.current),Er&&qe.designator){const We=qe.designator.match(/^([A-Za-z]+)(\d+)$/);if(We){const ot=We[1],ct=parseInt(We[2],10);if(ki){const Lt=Xf();P1(ot,ct,Lt)}else Oi.current[ot]=Math.max(Oi.current[ot]||0,ct)}}Yi(dt,Qt,en,mt,Jt),Ur.current==="top"?(le(!0),oi(We=>[...We,qe])):(Te(!0),Ni(We=>[...We,qe]));return}else if(k==="power"){if(!Fi)return;const Le=Bl?{x:xr({x:ye,y:Ce}).x,y:xr({x:ye,y:Ce}).y}:((bt,jt)=>{let It=1/0,rt=null;const Oe=10/xt,qe=xt>20?Math.max(Oe,1e-4):xt>10?Math.max(Oe,.001):Math.max(Oe,.01);for(const ct of dt)if(ct.type==="via"||ct.type==="pad"){const Lt=ct.points[0],Kt=Math.hypot(Lt.x-bt,Lt.y-jt);Kt<=qe&&Kt<It&&(It=Kt,rt=Lt)}else if(ct.type==="trace")for(const Lt of ct.points){const Kt=Math.hypot(Lt.x-bt,Lt.y-jt);Kt<=qe&&Kt<It&&(It=Kt,rt=Lt)}const ot=xr(rt??{x:bt,y:jt});return{x:ot.x,y:ot.y,nodeId:rt?.id}})(ye,Ce),Ze=pe.find(bt=>bt.id===Fi);if(Ze){const bt=Le.nodeId??lc(),jt=`${Ze.voltage} Power Node`;if(Re.find(Vt=>Vt.pointId===bt)){Qo({visible:!0,title:"Node ID Conflict",message:`Cannot place power node: A ground node already exists at this Node ID (${bt}). Power and ground nodes cannot share the same Node ID.`});return}Yi(dt,Qt,en,mt,Jt);const rt={id:`power-${Date.now()}-${Math.random()}`,x:Le.x,y:Le.y,color:"#ff0000",size:O,powerBusId:Ze.id,layer:Tt,type:jt,pointId:bt};if($t(Vt=>[...Vt,rt]),Le.nodeId!==void 0){const Vt=vl(Le.nodeId,pe),Oe=tc(Le.nodeId,pe),qe=Il(Le.nodeId,pe),We=qe.includes("Power")?"power":qe.includes("Ground")?"ground":qe.includes("Signal")?"signal":"unknown";Mt(ot=>ot.map(ct=>ct.type==="via"&&ct.points.length>0&&ct.points[0].id===Le.nodeId?{...ct,viaType:Vt}:ct.type==="pad"&&ct.points.length>0&&ct.points[0].id===Le.nodeId?{...ct,padType:Oe}:ct.type==="testPoint"&&ct.points.length>0&&ct.points[0].id===Le.nodeId?{...ct,testPointType:We}:ct))}}return}else if(k==="ground"){if(nr===null){if(Ve.length===0){Qo({visible:!0,title:"No Ground Bus",message:"No ground buses are defined. Please create a ground bus first using Tools  Manage Ground Buses."});return}fi(!0);return}const Ue=Ve.find(Le=>Le.id===nr);if(Ue){const Ze=Bl?{x:xr({x:ye,y:Ce}).x,y:xr({x:ye,y:Ce}).y}:((Vt,Oe)=>{let qe=1/0,We=null;const ct=10/xt,Lt=xt>20?Math.max(ct,1e-4):xt>10?Math.max(ct,.001):Math.max(ct,.01);for(const Hn of dt)if(Hn.type==="via"||Hn.type==="pad"){const vn=Hn.points[0],Xn=Math.hypot(vn.x-Vt,vn.y-Oe);Xn<=Lt&&Xn<qe&&(qe=Xn,We=vn)}else if(Hn.type==="trace")for(const vn of Hn.points){const Xn=Math.hypot(vn.x-Vt,vn.y-Oe);Xn<=Lt&&Xn<qe&&(qe=Xn,We=vn)}const sn=xr(We??{x:Vt,y:Oe});return{x:sn.x,y:sn.y,nodeId:We?.id}})(ye,Ce),bt=Ze.nodeId??lc(),jt=`${Ue.name} Ground Node`,It=fe.find(Vt=>Vt.pointId===bt);if(It){Qo({visible:!0,title:"Node ID Conflict",message:`Cannot place ground node: A power node (${It.type||"Power Node"}) already exists at this Node ID (${bt}). Power and ground nodes cannot share the same Node ID.`});return}Yi(dt,Qt,en,mt,Jt);const rt={id:`gnd-${Date.now()}-${Math.random().toString(36).slice(2,6)}`,x:Ze.x,y:Ze.y,color:Ue.color,size:O||yi.get("ground")?.settings.size||18,groundBusId:Ue.id,layer:Tt,type:jt,pointId:bt};if(rn(Vt=>[...Vt,rt]),Ze.nodeId!==void 0){const Vt=vl(Ze.nodeId,pe),Oe=tc(Ze.nodeId,pe);Mt(qe=>qe.map(We=>We.type==="via"&&We.points.length>0&&We.points[0].id===Ze.nodeId?{...We,viaType:Vt}:We.type==="pad"&&We.points.length>0&&We.points[0].id===Ze.nodeId?{...We,padType:Oe}:We))}}return}},[k,zn,O,G,Ge,Tt,dt,xt,Kn.x,Kn.y,ui,ut,Bl,Fi,nr,pe,Ve,Ml,yi,qn,_n,gi,fe,Re,vl,tc,Il,ra,qo,f]),kf=I.useCallback(c=>{if(k!=="magnify")return;c.preventDefault();const g=Ct.current;if(!g)return;const A=g.getBoundingClientRect(),L=g.width/A.width,K=g.height/A.height,oe=c.nativeEvent.offsetX,z=c.nativeEvent.offsetY,Ae=typeof oe=="number"?oe:c.clientX-A.left,Se=typeof z=="number"?z:c.clientY-A.top,_e=Ae*L,Pe=Se*K,ke=_e-5,me=Pe-5,be=Gf(ke,me,Kn,xt,ui,ut),ye=be.x,Ce=be.y,Ue=1.2,Le=1/Ue,Ze=c.deltaY<0?Ue:Le,bt=Math.max(.25,Math.min(8,xt*Ze));pr(ye,Ce),Yn(bt)},[k,xt,Kn.x,Kn.y,ui,ut]),Sp=I.useCallback(c=>{if(k==="draw"&&Ge==="trace"){ti.current=!0;let Ze=st;if(Ze.length>1){const bt=[Ze[0]];for(let jt=1;jt<Ze.length;jt++){const It=bt[bt.length-1],rt=Ze[jt];(Math.abs(It.x-rt.x)>.001||Math.abs(It.y-rt.y)>.001)&&bt.push(rt)}Ze=bt}if(Ze.length>=1){Yi(dt,Qt,en,mt,Jt);const bt=_n||"top",jt=bt==="top"?"traceTop":"traceBottom",It=Ln.get(jt),rt={id:`${Date.now()}-trace`,points:Ze,color:It.color,size:It.size,layer:bt,type:"trace"};Mt(Vt=>[...Vt,rt]),bt==="top"?Bo(Vt=>[...Vt,rt.id]):fs(Vt=>[...Vt,rt.id]),et([]),Rt(null),setTimeout(()=>{ti.current=!1},300);return}}const g=Ct.current;if(!g)return;const A=g.getBoundingClientRect(),L=g.width/A.width,K=g.height/A.height,oe=c.nativeEvent.offsetX,z=c.nativeEvent.offsetY,Ae=typeof oe=="number"?oe:c.clientX-A.left,Se=typeof z=="number"?z:c.clientY-A.top,_e=Ae*L,Pe=Se*K,ke=_e-5,me=Pe-5,be=Gf(ke,me,Kn,xt,ui,ut),ye=be.x,Ce=be.y,Ue=Math.max(8/xt,4),Le=(()=>{for(const Ze of dt)if(Ze.type==="testPoint"&&Ze.points.length>0){const bt=Ze.points[0],jt=Math.hypot(bt.x-ye,bt.y-Ce),It=(Ze.size||18)/2;if(jt<=It+Ue)return Ze}return null})();if(Le){Tn(new Set([Le.id])),yn(new Set),hn(new Set),Cn(new Set),yr(!0);return}if(k==="select"||k==="component"){const bt=(()=>{for(const rt of Qt)if(ye>=rt.x-10&&ye<=rt.x+10&&Ce>=rt.y-10&&Ce<=rt.y+10)return{layer:"top",comp:rt};for(const rt of en)if(ye>=rt.x-10&&ye<=rt.x+10&&Ce>=rt.y-10&&Ce<=rt.y+10)return{layer:"bottom",comp:rt};return null})(),jt=Math.max(6/xt,4);let It=null;for(const rt of fe){const Vt=Math.max(6,rt.size/2),Oe=Vt*.8,qe=Vt+Oe,We=Math.hypot(rt.x-ye,rt.y-Ce),ot=Math.abs(ye-rt.x)<=jt&&Math.abs(Ce-rt.y)<=qe,ct=Math.abs(Ce-rt.y)<=jt&&Math.abs(ye-rt.x)<=qe;if(We<=Math.max(Vt,jt)||ot||ct){It=rt;break}}if(It){hn(new Set([It.id])),di({visible:!0,id:It.id,layer:It.layer,x:It.x,y:It.y,size:It.size,color:It.color,powerBusId:It.powerBusId});return}if(bt){const{layer:rt,comp:Vt}=bt;C(Vt,rt)}}},[k,Ge,G,O,Tt,Qt,en,fe,xt,Kn.x,Kn.y,ui,ut,Ml,Bl,dt,zn,ia,vp,fo,yi,st,_n,Y,J,je,de,yr,Tn,yn,hn,Cn,C]),zu=I.useCallback(()=>{const c=Xt.current;if(k==="draw"&&Ge==="trace"&&c.length>=2){let g=[c[0]];for(let z=1;z<c.length;z++){const Ae=g[g.length-1],Se=c[z];(Math.abs(Ae.x-Se.x)>.001||Math.abs(Ae.y-Se.y)>.001)&&g.push(Se)}const A=_n||"top",L=A==="top"?"traceTop":"traceBottom",K=Ln.get(L),oe={id:`${Date.now()}-trace`,points:g,color:K.color,size:K.size,layer:A,type:"trace"};Yi(dt,Qt,en,mt,Jt),Mt(z=>[...z,oe]),A==="top"?Bo(z=>[...z,oe.id]):fs(z=>[...z,oe.id]),et([]),Rt(null)}else if(k==="draw"&&Ge==="trace"&&c.length===1){const g=_n||"top",A=g==="top"?"traceTop":"traceBottom",L=Ln.get(A),K={id:`${Date.now()}-trace-dot`,points:c,color:L.color,size:L.size,layer:g,type:"trace"};Mt(oe=>[...oe,K]),g==="top"?Bo(oe=>[...oe,K.id]):fs(oe=>[...oe,K.id]),et([])}},[k,Ge,_n,Y,J,je,de,Mt]),sd=I.useCallback((c,g,A)=>{const L=g-c.x,K=A-c.y;if(L===0&&K===0)return{x:g,y:A};const z=(A2(L,K)%180+180)%180,Ae=[0,45,90];let Se=0,_e=1e9;for(const Pe of Ae){const ke=Math.abs(z-Pe);ke<_e&&(_e=ke,Se=Pe)}if(Se===0)return{x:g,y:c.y};if(Se===90)return{x:c.x,y:A};{const Pe=Math.min(Math.abs(L),Math.abs(K)),ke=L>=0?1:-1,me=K>=0?1:-1;return{x:c.x+ke*Pe,y:c.y+me*Pe}}},[]),Af=I.useCallback(c=>{const g=Ct.current?.getBoundingClientRect();if(!g)return;const A=c.clientX-g.left,L=c.clientY-g.top,K=Ct.current,oe=K.width/g.width,z=K.height/g.height,Ae=A*oe,Se=L*z,_e=Ae-5,Pe=Se-5,ke=Gf(_e,Pe,Kn,xt,ui,ut),me=ke.x,be=ke.y;if(Vi({x:me,y:be}),yc.current&&Rl.current&&Ec({start:Rl.current.start,end:{x:me,y:be}}),k==="draw"&&Ge==="trace"&&st.length>0){const Ce=Bl?{x:xr({x:me,y:be}).x,y:xr({x:me,y:be}).y}:((Ue,Le)=>{let Ze=1/0,bt=null;const It=10/xt,rt=xt>20?Math.max(It,1e-4):xt>10?Math.max(It,.001):Math.max(It,.01);for(const qe of dt)if(qe.type==="via"){const We=qe.points[0],ot=Math.hypot(We.x-Ue,We.y-Le);ot<=rt&&ot<Ze&&(Ze=ot,bt=We)}else if(qe.type==="pad"){const We=qe.points[0],ot=Math.hypot(We.x-Ue,We.y-Le);ot<=rt&&ot<Ze&&(Ze=ot,bt=We)}for(const qe of fe)if(qe.pointId!==void 0){const We=Math.hypot(qe.x-Ue,qe.y-Le);We<=rt&&We<Ze&&(Ze=We,bt={x:qe.x,y:qe.y,id:qe.pointId})}for(const qe of Re)if(qe.pointId!==void 0){const We=Math.hypot(qe.x-Ue,qe.y-Le);We<=rt&&We<Ze&&(Ze=We,bt={x:qe.x,y:qe.y,id:qe.pointId})}const Oe=xr(bt??{x:Ue,y:Le});return{x:Oe.x,y:Oe.y,nodeId:bt?.id}})(me,be);Rt({x:Ce.x,y:Ce.y})}else Rt(null);if(Vo){const Ce=(()=>{for(const Ue of Qt)if(me>=Ue.x-10&&me<=Ue.x+10&&be>=Ue.y-10&&be<=Ue.y+10)return{layer:"top",comp:Ue};for(const Ue of en)if(me>=Ue.x-10&&me<=Ue.x+10&&be>=Ue.y-10&&be<=Ue.y+10)return{layer:"bottom",comp:Ue};return null})();if(Ce)ma({component:Ce.comp,layer:Ce.layer,x:c.clientX,y:c.clientY}),ba(null),Js(null);else{ma(null);const Ue=Math.max(8/xt,4),Le=(()=>{for(const Ze of dt)if(Ze.type==="testPoint"&&Ze.points.length>0){const bt=Ze.points[0],jt=Math.hypot(bt.x-me,bt.y-be),It=(Ze.size||18)/2;if(jt<=It+Ue)return Ze}return null})();if(Le)ba({stroke:Le,x:c.clientX,y:c.clientY}),Js(null);else{ba(null);const Ze=Math.max(6/xt,3),bt=(rt,Vt,Oe,qe,We,ot)=>{const ct=We-Oe,Lt=ot-qe,Kt=ct*ct+Lt*Lt;if(Kt===0)return Math.hypot(rt-Oe,Vt-qe);let sn=((rt-Oe)*ct+(Vt-qe)*Lt)/Kt;sn=Math.max(0,Math.min(1,sn));const Hn=Oe+sn*ct,vn=qe+sn*Lt;return Math.hypot(rt-Hn,Vt-vn)},jt=rt=>{const Vt=parseInt(rt,10);if(isNaN(Vt))return null;for(const Oe of dt)if((Oe.type==="via"||Oe.type==="pad"||Oe.type==="testPoint")&&Oe.points.length>0){const qe=Oe.points[0];if(qe.id===Vt)return{x:qe.x,y:qe.y}}for(const Oe of dt)if(Oe.type==="trace"){for(const qe of Oe.points)if(qe.id===Vt)return{x:qe.x,y:qe.y}}for(const Oe of fe)if(Oe.pointId===Vt)return{x:Oe.x,y:Oe.y};for(const Oe of Re)if(Oe.pointId===Vt)return{x:Oe.x,y:Oe.y};return null},It=(()=>{const rt=[...Qt.map(Vt=>({comp:Vt,layer:"top"})),...en.map(Vt=>({comp:Vt,layer:"bottom"}))];for(const{comp:Vt,layer:Oe}of rt){if(ll(Vt)?.category!=="Semiconductors")continue;const We=Vt.pinConnections||[],ot=new Map;for(let ct=0;ct<We.length;ct++){const Lt=We[ct];if(Lt&&Lt.trim()!==""){const Kt=Lt.trim(),sn=ot.get(Kt)||[];sn.push(ct),ot.set(Kt,sn)}}for(const[ct,Lt]of ot){const Kt=jt(ct);if(!Kt)continue;const sn={x:Vt.x,y:Vt.y};if(bt(me,be,sn.x,sn.y,Kt.x,Kt.y)<=Ze)return{comp:Vt,layer:Oe,pinIndices:Lt,nodeIdStr:ct}}}return null})();Js(It?{component:It.comp,layer:It.layer,pinIndices:It.pinIndices,nodeId:It.nodeIdStr,x:c.clientX,y:c.clientY}:null)}}}else ma(null),ba(null),Js(null);if(k==="select"&&ul&&vc){const ye=vc.x,Ce=vc.y;Rd({x:Math.min(ye,me),y:Math.min(Ce,be),width:Math.abs(me-ye),height:Math.abs(be-Ce)})}else if(k==="pan"&&ia&&So.current){const{startCX:ye,startCY:Ce,objectStartPositions:Ue}=So.current,Le=_e-ye,Ze=Pe-Ce,bt=k1(Le,Ze,xt,ui,ut),jt=bt.x,It=bt.y;Ue&&(o&&s({...o,x:Ue.topImageX+jt,y:Ue.topImageY+It}),l&&d({...l,x:Ue.bottomImageX+jt,y:Ue.bottomImageY+It}),oi(Qt.map(rt=>({...rt,x:(Ue.componentsTop?.[rt.id]?.x??rt.x)+jt,y:(Ue.componentsTop?.[rt.id]?.y??rt.y)+It}))),Ni(en.map(rt=>({...rt,x:(Ue.componentsBottom?.[rt.id]?.x??rt.x)+jt,y:(Ue.componentsBottom?.[rt.id]?.y??rt.y)+It}))),$t(mt.map(rt=>({...rt,x:(Ue.powerSymbols?.[rt.id]?.x??rt.x)+jt,y:(Ue.powerSymbols?.[rt.id]?.y??rt.y)+It}))),rn(Jt.map(rt=>({...rt,x:(Ue.groundSymbols?.[rt.id]?.x??rt.x)+jt,y:(Ue.groundSymbols?.[rt.id]?.y??rt.y)+It}))),Mt(dt.map((rt,Vt)=>({...rt,points:rt.points.map((Oe,qe)=>{const We=Ue.drawingStrokes?.[Vt]?.points?.[qe];return{...Oe,x:(We?.x??Oe.x)+jt,y:(We?.y??Oe.y)+It}})}))),Ko(ka.map((rt,Vt)=>{const Oe=Ue.vias?.[Vt];return{...rt,x:(Oe?.x??rt.x)+jt,y:(Oe?.y??rt.y)+It}})),jr(Qr.map((rt,Vt)=>{const Oe=Ue.pads?.[Vt];return{...rt,x:(Oe?.x??rt.x)+jt,y:(Oe?.y??rt.y)+It}})))}else if(Me&&st.length>0){if(k==="draw")if(Ti){const ye=st[0],Ce=sd(ye,me,be),Ue=xr(Ce),Le={id:lc(),x:Ue.x,y:Ue.y};et([ye,Le])}else{const ye=xr({x:me,y:be});et(Ce=>[...Ce,{id:lc(),x:ye.x,y:ye.y}])}else if(k==="erase"&&(et(ye=>[...ye,{id:lc(),x:me,y:be}]),Mt(ye=>{const Ce=ye.filter(Le=>{if(Le.type==="via"&&Lr||Le.type==="pad"&&pa||Le.type==="testPoint"&&Jo||Le.type==="trace"&&po||Le.layer!==Tt)return!0;const Ze=O/2,bt=me-Ze,jt=me+Ze,It=be-Ze,rt=be+Ze,Vt=(We,ot)=>We>=bt&&We<=jt&&ot>=It&&ot<=rt,Oe=(We,ot,ct,Lt)=>{const Wn=(lo,$o)=>{let li=0;return lo<bt?li|=1:lo>jt&&(li|=2),$o<It?li|=4:$o>rt&&(li|=8),li};let Rn=We,Ht=ot,In=ct,Wi=Lt,Vr=Wn(Rn,Ht),Fr=Wn(In,Wi);for(;;){if((Vr|Fr)===0)return!0;if((Vr&Fr)!==0)return!1;const lo=Vr!==0?Vr:Fr;let $o=0,li=0;lo&8?($o=Rn+(In-Rn)*(rt-Ht)/(Wi-Ht),li=rt):lo&4?($o=Rn+(In-Rn)*(It-Ht)/(Wi-Ht),li=It):lo&2?(li=Ht+(Wi-Ht)*(jt-Rn)/(In-Rn),$o=jt):(li=Ht+(Wi-Ht)*(bt-Rn)/(In-Rn),$o=bt),lo===Vr?(Rn=$o,Ht=li,Vr=Wn(Rn,Ht)):(In=$o,Wi=li,Fr=Wn(In,Wi))}};let qe=!1;if(Le.points.length===1){const We=Le.points[0];qe=Vt(We.x,We.y)}else for(let We=0;We<Le.points.length-1;We++){const ot=Le.points[We],ct=Le.points[We+1];if(Oe(ot.x,ot.y,ct.x,ct.y)){qe=!0;break}}return qe&&console.log("Erasing stroke at position:",me,be,"brushSize:",O,"selectedLayer:",Tt),!qe});console.log("Strokes before:",ye.length,"after:",Ce.length);const Ue=new Set(Ce.map(Le=>Le.id));return cl(Le=>Le.filter(Ze=>Ue.has(Ze))),Ba(Le=>Le.filter(Ze=>Ue.has(Ze))),Bo(Le=>Le.filter(Ze=>Ue.has(Ze))),fs(Le=>Le.filter(Ze=>Ue.has(Ze))),Ce}),tr||$t(ye=>{const Ce=O/2,Ue=me-Ce,Le=me+Ce,Ze=be-Ce,bt=be+Ce,jt=It=>{const rt=It.size/2,Vt=It.x-rt,Oe=It.x+rt,qe=It.y-rt,We=It.y+rt;return!(Le<Vt||Ue>Oe||bt<qe||Ze>We)};return ye.filter(It=>!jt(It))}),mo||rn(ye=>{const Ce=O/2,Ue=me-Ce,Le=me+Ce,Ze=be-Ce,bt=be+Ce,jt=rt=>{const Vt=Math.max(6,(rt.size||18)/2),Oe=Vt*.8,qe=Vt+Oe,We=rt.x-qe,ot=rt.x+qe,ct=rt.y-qe,Lt=rt.y+qe;return!(Le<We||Ue>ot||bt<ct||Ze>Lt)};return ye.filter(rt=>!jt(rt))}),!er)){const ye=O/2,Ce=me-ye,Ue=me+ye,Le=be-ye,Ze=be+ye,bt=jt=>{const rt=(jt.size||18)/2,Vt=jt.x-rt,Oe=jt.x+rt,qe=jt.y-rt,We=jt.y+rt;return!(Ue<Vt||Ce>Oe||Ze<qe||Le>We)};Yi(dt,Qt,en,mt,Jt),oi(jt=>jt.filter(It=>!bt(It))),Ni(jt=>jt.filter(It=>!bt(It)))}}else if(ni&&xi&&zn){if(ar){nn(!1),hi(null);return}const ye=me-xi.x,Ce=be-xi.y;if(zn==="top"){o&&s(Ue=>Ue?{...Ue,x:Ue.x+ye,y:Ue.y+Ce}:null),hi({x:me,y:be});return}if(zn==="bottom"){l&&d(Ue=>Ue?{...Ue,x:Ue.x+ye,y:Ue.y+Ce}:null),hi({x:me,y:be});return}if(zn==="both"){o&&s(Ue=>Ue?{...Ue,x:Ue.x+ye,y:Ue.y+Ce}:null),l&&d(Ue=>Ue?{...Ue,x:Ue.x+ye,y:Ue.y+Ce}:null),hi({x:me,y:be});return}}},[Me,st,k,O,ni,xi,zn,o,l,Ti,sd,Tt,Mt,xt,Kn.x,Kn.y,ui,ut,ul,vc,ar,Lr,pa,po,tr,mo,Qt,en,oi,Ni,Vo,ma,Bl,dt,fe,Re,st,Ge,Pt,Rt,ia,So,Fa,5,Kn,lc,xr,y,vr,Yi,mt,Jt,Vi]),Pf=I.useCallback(()=>{if(Vi(null),Bs.current&&Rl.current&&Ms.current&&yc.current){const c=Rl.current,g=Ms.current,A=Math.abs(c.end.x-c.start.x),L=Math.abs(c.end.y-c.start.y);if(A>=1&&L>=1)try{const oe=Mw({numPins:g.numPins,type:g.type,twoSidedOrientation:g.twoSidedOrientation,point1:c.start,point2:c.end}).map(z=>{const Ae=rl.current?(qn||"top")==="top"?"padTop":"padBottom":"via",Se=Ln.get(Ae),_e=lc(),Pe=rl.current&&qn||"top";return{id:_e.toString(),type:rl.current?"pad":"via",points:[{x:z.x,y:z.y,id:_e}],size:Se.size,color:Se.color,layer:Pe}});Mt(z=>{const Ae=[...z,...oe];return Yi(Ae,Qt,en,mt,Jt),Ae})}catch(K){console.error("IC Placement error:",K),alert(`Error placing ${rl.current?"pads":"vias"}: ${K instanceof Error?K.message:String(K)}`)}nd(!1),Ec(null),td(null),il(!1),Bs.current=!1,Rl.current=null,Ms.current=null,yc.current=!1,Di(void 0),y("select");return}if(k==="select"&&ul){const c=wc,g=vc;if(Oo(!1),Dd(null),Rd(null),c&&g){const K=Math.max(3,5/xt),oe=c.width<K&&c.height<K,z=(Oe,qe)=>{const We=c.x,ot=c.y,ct=c.x+c.width,Lt=c.y+c.height;return Oe>=We&&Oe<=ct&&qe>=ot&&qe<=Lt},Ae=(Oe,qe,We,ot,ct,Lt,Kt,sn)=>{const Ht=(li,wl)=>{let al=0;return li<ct?al|=1:li>Kt&&(al|=2),wl<Lt?al|=4:wl>sn&&(al|=8),al};let In=Oe,Wi=qe,Vr=We,Fr=ot,lo=Ht(In,Wi),$o=Ht(Vr,Fr);for(;;){if((lo|$o)===0)return!0;if((lo&$o)!==0)return!1;const li=lo!==0?lo:$o;let wl=0,al=0;li&8?(wl=In+(Vr-In)*(sn-Wi)/(Fr-Wi),al=sn):li&4?(wl=In+(Vr-In)*(Lt-Wi)/(Fr-Wi),al=Lt):li&2?(al=Wi+(Fr-Wi)*(Kt-In)/(Vr-In),wl=Kt):(al=Wi+(Fr-Wi)*(ct-In)/(Vr-In),wl=ct),li===lo?(In=wl,Wi=al,lo=Ht(In,Wi)):(Vr=wl,Fr=al,$o=Ht(Vr,Fr))}},Se=c.x,_e=c.y,Pe=c.x+c.width,ke=c.y+c.height,be=Math.max(6/xt,4/xt,.5),ye=(Oe,qe,We,ot,ct,Lt)=>{const Kt=ct-We,sn=Lt-ot;if(Kt===0&&sn===0)return Math.hypot(Oe-We,qe-ot);const Hn=Math.max(0,Math.min(1,((Oe-We)*Kt+(qe-ot)*sn)/(Kt*Kt+sn*sn))),vn=We+Hn*Kt,Xn=ot+Hn*sn;return Math.hypot(Oe-vn,qe-Xn)},Ce=g?.shiftKey===!0,Ue=new Set(Ce?Array.from(wn):[]),Le=new Set(Ce?Array.from(Mn):[]),Ze=new Set(Ce?Array.from(Ri):[]),bt=new Set(Ce?Array.from(ji):[]),jt=g?.hitStrokeId;if(jt){const Oe=dt.find(qe=>qe.id===jt);if(Oe){let qe=!1;if(Oe.type==="via"||Oe.type==="pad"?qe=ra:qe=Oe.layer==="top"?Ra:Co,qe){Ce?Tn(We=>{const ot=new Set(We);return ot.has(jt)?ot.delete(jt):ot.add(jt),ot}):(Tn(new Set([jt])),yn(new Set),hn(new Set),Cn(new Set));return}}}if(oe){let Oe=null;for(const qe of dt){let We=!1;if(qe.type==="via"?We=ra:qe.type==="pad"?We=(qe.layer||"top")==="top"?qo:f:qe.type==="testPoint"?We=(qe.layer||"top")==="top"?N:X:qe.type==="trace"?We=qe.layer==="top"?Ra:Co:We=!1,!We)continue;let ot=1/0;if(qe.type==="via"||qe.type==="pad"||qe.type==="testPoint"){const ct=qe.points[0],Lt=Math.max(1,qe.size/2);ot=Math.hypot(ct.x-g.x,ct.y-g.y);const sn=Math.max(6/xt,4/xt,.5);ot<=Math.max(Lt,sn)&&(!Oe||ot<Oe.dist)&&(Oe={id:qe.id,dist:ot})}else for(let ct=0;ct<qe.points.length-1;ct++){const Lt=qe.points[ct],Kt=qe.points[ct+1],sn=ye(g.x,g.y,Lt.x,Lt.y,Kt.x,Kt.y);if(sn<=Math.max(be,qe.size/2)){(!Oe||sn<Oe.dist)&&(Oe={id:qe.id,dist:sn});break}}}Oe&&(Ce&&Ue.has(Oe.id)?Ue.delete(Oe.id):Ue.add(Oe.id))}else for(const Oe of dt){let qe=!1;if(Oe.type==="via"?qe=ra:Oe.type==="pad"?qe=(Oe.layer||"top")==="top"?qo:f:Oe.type==="testPoint"?qe=(Oe.layer||"top")==="top"?N:X:Oe.type==="trace"?qe=Oe.layer==="top"?Ra:Co:qe=!1,!qe)continue;let We=!1;if(Oe.type==="via"||Oe.type==="pad"||Oe.type==="testPoint"){const ot=Oe.points[0];We=z(ot.x,ot.y)}else for(let ot=0;ot<Oe.points.length-1;ot++){const ct=Oe.points[ot],Lt=Oe.points[ot+1];if(Ae(ct.x,ct.y,Lt.x,Lt.y,Se,_e,Pe,ke)||z(ct.x,ct.y)&&z(Lt.x,Lt.y)){We=!0;break}}We&&(Ce&&Ue.has(Oe.id)?Ue.delete(Oe.id):Ue.add(Oe.id))}const It=Oe=>{const We=Math.max(10,Oe.size||18)/2;return Oe.x-We<=Pe&&Oe.x+We>=Se&&Oe.y-We<=ke&&Oe.y+We>=_e};if(oe){const Oe=qe=>{const ot=Math.max(10,qe.size||18)/2;return g.x>=qe.x-ot&&g.x<=qe.x+ot&&g.y>=qe.y-ot&&g.y<=qe.y+ot};re&&Qt.forEach(qe=>{Oe(qe)&&(Ce&&Le.has(qe.id)?Le.delete(qe.id):Le.add(qe.id))}),he&&en.forEach(qe=>{Oe(qe)&&(Ce&&Le.has(qe.id)?Le.delete(qe.id):Le.add(qe.id))})}else re&&Qt.forEach(Oe=>{It(Oe)&&(Ce&&Le.has(Oe.id)?Le.delete(Oe.id):Le.add(Oe.id))}),he&&en.forEach(Oe=>{It(Oe)&&(Ce&&Le.has(Oe.id)?Le.delete(Oe.id):Le.add(Oe.id))});const rt=Oe=>{const qe=Math.max(6,Oe.size/2),We=qe*.8,ot=qe+We;return Oe.x-ot<=Pe&&Oe.x+ot>=Se&&Oe.y-ot<=ke&&Oe.y+ot>=_e};if(Ee)if(oe){let Oe=null;for(const qe of fe){const We=Math.max(6,qe.size/2),ot=We*.8,ct=We+ot,Lt=Math.hypot(qe.x-g.x,qe.y-g.y),Kt=Math.abs(g.x-qe.x)<=be&&Math.abs(g.y-qe.y)<=ct,sn=Math.abs(g.y-qe.y)<=be&&Math.abs(g.x-qe.x)<=ct;if(Lt<=Math.max(We,be)||Kt||sn){const vn=Math.min(Lt,Math.abs(g.x-qe.x)+Math.abs(g.y-qe.y));(!Oe||vn<Oe.dist)&&(Oe={id:qe.id,dist:vn})}}Oe&&(Ce&&Ze.has(Oe.id)?Ze.delete(Oe.id):Ze.add(Oe.id))}else fe.forEach(Oe=>{rt(Oe)&&(Ce&&Ze.has(Oe.id)?Ze.delete(Oe.id):Ze.add(Oe.id))});const Vt=Oe=>{const qe=Math.max(6,(Oe.size||18)/2),We=qe*.8,ot=qe+We;return Oe.x-ot<=Pe&&Oe.x+ot>=Se&&Oe.y-ot<=ke&&Oe.y+ot>=_e};if(ci)if(oe){let Oe=null;for(const qe of Re){const We=Math.max(6,(qe.size||18)/2),ot=We*.8,ct=We+ot,Lt=Math.hypot(qe.x-g.x,qe.y-g.y),Kt=Math.abs(g.x-qe.x)<=be&&Math.abs(g.y-qe.y)<=ct,sn=Math.abs(g.y-qe.y)<=be&&Math.abs(g.x-qe.x)<=ct;if(Lt<=Math.max(We,be)||Kt||sn){const vn=Math.min(Lt,Math.abs(g.x-qe.x)+Math.abs(g.y-qe.y));(!Oe||vn<Oe.dist)&&(Oe={id:qe.id,dist:vn})}}Oe&&(Ce&&bt.has(Oe.id)?bt.delete(Oe.id):bt.add(Oe.id))}else Re.forEach(Oe=>{Vt(Oe)&&(Ce&&bt.has(Oe.id)?bt.delete(Oe.id):bt.add(Oe.id))});Tn(Ue),yn(Le),hn(Ze),Cn(bt)}}if(Me&&st.length>0){if(k==="draw"&&Ge!=="trace"){const c={id:Date.now().toString(),points:st,color:G,size:O,layer:Tt,type:"trace"};Mt(g=>[...g,c]),Tt==="top"?Bo(g=>[...g,c.id]):fs(g=>[...g,c.id])}et([])}ia&&($a(!1),So.current=null,Ro.current=null),we(!1),nn(!1),hi(null),_i(!1)},[Me,st,k,G,O,Tt,wc,vc,ul,dt,xt,Da,wn,fe,Re,Qt,en,Mn,Ri,ji,ra,Ra,Co,re,he,Ee,ci,Vi]);At.useEffect(()=>{if(!(k==="pan"&&ia&&Ro.current))return;const c=A=>{const L=Ct.current;if(!L)return;const K=L.getBoundingClientRect(),oe=L.width/K.width,z=L.height/K.height,{startClientX:Ae,startClientY:Se,objectStartPositions:_e}=Ro.current,Pe=(A.clientX-Ae)*oe,ke=(A.clientY-Se)*z,me=k1(Pe,ke,xt,ui,ut),be=me.x,ye=me.y;_e&&(o&&s({...o,x:_e.topImageX+be,y:_e.topImageY+ye}),l&&d({...l,x:_e.bottomImageX+be,y:_e.bottomImageY+ye}),oi(Qt.map(Ce=>({...Ce,x:(_e.componentsTop?.[Ce.id]?.x??Ce.x)+be,y:(_e.componentsTop?.[Ce.id]?.y??Ce.y)+ye}))),Ni(en.map(Ce=>({...Ce,x:(_e.componentsBottom?.[Ce.id]?.x??Ce.x)+be,y:(_e.componentsBottom?.[Ce.id]?.y??Ce.y)+ye}))),$t(mt.map(Ce=>({...Ce,x:(_e.powerSymbols?.[Ce.id]?.x??Ce.x)+be,y:(_e.powerSymbols?.[Ce.id]?.y??Ce.y)+ye}))),rn(Jt.map(Ce=>({...Ce,x:(_e.groundSymbols?.[Ce.id]?.x??Ce.x)+be,y:(_e.groundSymbols?.[Ce.id]?.y??Ce.y)+ye}))),Mt(dt.map((Ce,Ue)=>({...Ce,points:Ce.points.map((Le,Ze)=>{const bt=_e.drawingStrokes?.[Ue]?.points?.[Ze];return{...Le,x:(bt?.x??Le.x)+be,y:(bt?.y??Le.y)+ye}})}))),Ko(ka.map((Ce,Ue)=>{const Le=_e.vias?.[Ue];return{...Ce,x:(Le?.x??Ce.x)+be,y:(Le?.y??Ce.y)+ye}})),jr(Qr.map((Ce,Ue)=>{const Le=_e.pads?.[Ue];return{...Ce,x:(Le?.x??Ce.x)+be,y:(Le?.y??Ce.y)+ye}})))},g=()=>{$a(!1),So.current=null,Ro.current=null,window.removeEventListener("mousemove",c,!0),window.removeEventListener("mouseup",g,!0)};return window.addEventListener("mousemove",c,!0),window.addEventListener("mouseup",g,!0),()=>{window.removeEventListener("mousemove",c,!0),window.removeEventListener("mouseup",g,!0)}},[k,ia,xt,ui,ut,o,l,Qt,en,mt,Jt,dt,ka,Qr,s,d,oi,Ni,$t,rn,Mt,Ko,jr]);const gu=I.useCallback(()=>{const c=Ct.current;if(!c)return;const g=c.getContext("2d");if(!g)return;g.clearRect(0,0,c.width,c.height),g.fillStyle="#000000",g.fillRect(0,0,c.width,c.height),g.fillStyle="#ffffff",g.fillRect(5,5,c.width-10,c.height-10),g.save(),g.beginPath(),g.rect(5,5,c.width-10,c.height-10),g.clip(),g.translate(5,5);const A=(K,oe,z,Ae,Se,_e,Pe,ke)=>{const me=document.createElement("canvas");me.width=z,me.height=Ae;const be=me.getContext("2d",{willReadFrequently:!0});be.clearRect(0,0,z,Ae),be.drawImage(oe,0,0,z,Ae);let ye=me;if(Math.abs(Se)>1e-6){const Ce=hh(Se),Ue=Math.max(.2,1-Ce),Le=Math.max(.2,1+Ce),Ze=Math.max(Ue,Le),bt=Math.max(1,Math.ceil(z*Ze)),jt=document.createElement("canvas");jt.width=bt,jt.height=Ae;const It=jt.getContext("2d",{willReadFrequently:!0});It.clearRect(0,0,bt,Ae);for(let rt=0;rt<Ae;rt++){const Vt=Ae<=1?0:rt/(Ae-1),Oe=Ue*(1-Vt)+Le*Vt,qe=Math.max(1,z*Oe),We=(bt-qe)/2;It.drawImage(ye,0,rt,z,1,We,rt,qe,1)}ye=jt}if(Math.abs(_e)>1e-6){const Ce=hh(_e),Ue=Math.max(.2,1-Ce),Le=Math.max(.2,1+Ce),Ze=Math.max(Ue,Le),bt=Math.max(1,Math.ceil(Ae*Ze)),jt=document.createElement("canvas");jt.width=ye.width,jt.height=bt;const It=jt.getContext("2d",{willReadFrequently:!0});It.clearRect(0,0,jt.width,bt);for(let rt=0;rt<ye.width;rt++){const Vt=ye.width<=1?0:rt/(ye.width-1),Oe=Ue*(1-Vt)+Le*Vt,qe=Math.max(1,Ae*Oe),We=(bt-qe)/2;It.drawImage(ye,rt,0,1,ye.height,rt,We,1,qe)}ye=jt}K.drawImage(ye,-Pe/2,-ke/2,Pe,ke)};g.translate(Kn.x,Kn.y),g.scale(xt,xt),P2(g,ui,ut);{const K=Ya&&Ga;if(o&&o.bitmap&&Ya){const oe=o.bitmap;g.save(),g.globalAlpha=1;const z=[];o.brightness!==void 0&&o.brightness!==100&&z.push(`brightness(${o.brightness}%)`),o.contrast!==void 0&&o.contrast!==100&&z.push(`contrast(${o.contrast}%)`),F&&z.push("grayscale(100%)"),g.filter=z.length>0?z.join(" "):"none",$g(g,{x:o.x,y:o.y,rotation:o.rotation||0,scale:o.scale||1,flipX:o.flipX||!1,flipY:o.flipY||!1,skewX:o.skewX||0,skewY:o.skewY||0});const Ae=oe.width*1,Se=oe.height*1,_e=oe;o.keystoneV&&Math.abs(o.keystoneV)>1e-6||o.keystoneH&&Math.abs(o.keystoneH)>1e-6?A(g,_e,oe.width,oe.height,o.keystoneV||0,o.keystoneH||0,Ae,Se):g.drawImage(_e,-Ae/2,-Se/2,Ae,Se),g.restore()}if(l&&l.bitmap&&Ga){const oe=l.bitmap;g.save(),g.globalAlpha=K?v/100:1;const z=[];l.brightness!==void 0&&l.brightness!==100&&z.push(`brightness(${l.brightness}%)`),l.contrast!==void 0&&l.contrast!==100&&z.push(`contrast(${l.contrast}%)`),F&&z.push("grayscale(100%)"),g.filter=z.length>0?z.join(" "):"none",$g(g,{x:l.x,y:l.y,rotation:l.rotation||0,scale:l.scale||1,flipX:l.flipX||!1,flipY:l.flipY||!1,skewX:l.skewX||0,skewY:l.skewY||0});const Ae=oe.width*1,Se=oe.height*1,_e=oe;l.keystoneV&&Math.abs(l.keystoneV)>1e-6||l.keystoneH&&Math.abs(l.keystoneH)>1e-6?A(g,_e,oe.width,oe.height,l.keystoneV||0,l.keystoneH||0,Ae,Se):g.drawImage(_e,-Ae/2,-Se/2,Ae,Se),g.restore()}}if(Tp(g),Ee&&fe.length>0){const K=oe=>{g.save(),N1(g,oe.x,oe.y,oe.rotation??0,oe.flipX??!1,!1);const z=pe.find(ke=>ke.id===oe.powerBusId),Ae=Ri.has(oe.id),Se=z?.color||"#ff0000";g.strokeStyle=Se,g.lineWidth=Math.max(1,(Ae?3:2)/Math.max(xt,.001)),g.lineCap="round";const _e=Math.max(6,oe.size/2),Pe=_e*.8;if(Ae&&(g.strokeStyle="#0066ff",g.lineWidth=Math.max(1,4/Math.max(xt,.001)),g.beginPath(),g.arc(0,0,_e+Pe+3,0,Xa),g.stroke()),g.strokeStyle=Se,g.lineWidth=Math.max(1,(Ae?3:2)/Math.max(xt,.001)),g.beginPath(),g.arc(0,0,_e,0,Xa),g.stroke(),g.beginPath(),g.moveTo(0,-_e-Pe),g.lineTo(0,_e+Pe),g.stroke(),g.beginPath(),g.moveTo(-_e-Pe,0),g.lineTo(_e+Pe,0),g.stroke(),z){g.fillStyle=Se;const ke=Math.max(10,_e*.8);g.font=`${ke}px sans-serif`,g.textAlign="center",g.textBaseline="top",g.fillText(z.name,0,_e+Pe+8)}g.restore()};fe.forEach(K)}if(ci&&Re.length>0){const K=oe=>{g.save(),N1(g,oe.x,oe.y,oe.rotation??0,oe.flipX??!1,!1);const z=ji.has(oe.id),Ae=Ve.find(ke=>ke.id===oe.groundBusId),Se=Ae?.color||oe.color||"#000000",_e=oe.groundBusId==="groundbus-earth";let Pe;if(_e){const ke=Math.max(6,oe.size||18),me=ke*.9,be=ke*.24,ye=ke*1.6;g.strokeStyle=Se,g.lineWidth=Math.max(1,(z?3:2)/Math.max(xt,.001)),g.lineCap="round",z&&(g.strokeStyle="#0066ff",g.lineWidth=Math.max(1,4/Math.max(xt,.001)),g.setLineDash([5,5]),g.strokeRect(-ye/2-3,-3,ye+6,me+be*2+6),g.setLineDash([])),g.strokeStyle=Se,g.lineWidth=Math.max(1,(z?3:2)/Math.max(xt,.001)),g.beginPath(),g.moveTo(0,0),g.lineTo(0,me),g.stroke();for(let Ce=0;Ce<3;Ce++){const Ue=me+Ce*be,Le=ye*(1-Ce*.25);g.beginPath(),g.moveTo(-Le/2,Ue),g.lineTo(Le/2,Ue),g.stroke()}Pe=me+be*2}else{const ke=Math.max(6,(oe.size||18)/2),me=ke*.8;z&&(g.strokeStyle="#0066ff",g.lineWidth=Math.max(1,4/Math.max(xt,.001)),g.beginPath(),g.arc(0,0,ke+me+3,0,Xa),g.stroke()),g.strokeStyle=Se,g.lineWidth=Math.max(1,(z?3:2)/Math.max(xt,.001)),g.beginPath(),g.arc(0,0,ke,0,Xa),g.stroke(),g.beginPath(),g.moveTo(0,-ke-me),g.lineTo(0,ke+me),g.stroke(),g.beginPath(),g.moveTo(-ke-me,0),g.lineTo(ke+me,0),g.stroke(),Pe=ke+me}if(Ae){g.fillStyle=Se;const ke=Math.max(10,(oe.size||18)*.5);g.font=`${ke}px sans-serif`,g.textAlign="center",g.textBaseline="top",g.fillText(Ae.name,0,Pe+8)}g.restore()};Re.forEach(K)}const L=K=>{const oe=Math.max(10,K.size||18),z=oe/2;g.save(),g.translate(K.x,K.y),z2(g,ui,ut),K.orientation!==void 0&&K.orientation!==0&&g.rotate(Cu(K.orientation)),K.flipX&&g.scale(-1,1),K.flipY&&g.scale(1,-1),g.strokeStyle=K.color||"#111",g.lineWidth=Math.max(1,2/Math.max(xt,.001));const Ae=K.pinConnections||[],Se=Ae.length>0&&Ae.length===K.pinCount&&Ae.every(ke=>ke&&ke.trim()!=="");g.fillStyle=Se?"rgba(178, 223, 138, 0.85)":"rgba(255,255,255,0.85)",g.beginPath(),g.rect(-z,-z,oe,oe),g.fill(),g.stroke();const _e=K.designator?.trim()||"";if(_e){g.fillStyle=K.color||"#111";const ke=Math.max(6,oe*.35),me=oe*.9;let be=ke;g.font=`bold ${be}px sans-serif`;const ye=g.measureText(_e);ye.width>me&&(be=me/ye.width*be,be=Math.max(6,be),g.font=`bold ${be}px sans-serif`),g.textAlign="center",g.textBaseline="middle",g.fillText(_e,0,0)}Mn.has(K.id)&&(g.setLineDash([4,3]),g.strokeStyle="#00bfff",g.lineWidth=1.5,g.strokeRect(-z-3,-z-3,oe+6,oe+6),g.setLineDash([])),g.restore()};if(Pi){const K=z=>{const Ae=parseInt(z,10);if(isNaN(Ae))return null;for(const Se of dt)if((Se.type==="via"||Se.type==="pad"||Se.type==="testPoint")&&Se.points.length>0){const _e=Se.points[0];if(_e.id===Ae)return{x:_e.x,y:_e.y}}for(const Se of dt)if(Se.type==="trace"){for(const _e of Se.points)if(_e.id===Ae)return{x:_e.x,y:_e.y}}for(const Se of fe)if(Se.pointId===Ae)return{x:Se.x,y:Se.y};for(const Se of Re)if(Se.pointId===Ae)return{x:Se.x,y:Se.y};return null},oe=z=>{const Ae=z.pinConnections||[],Se=op(z)&&z.pinPolarities,Pe=ll(z)?.category==="Semiconductors",ke=new Map;for(let me=0;me<Ae.length;me++){const be=Ae[me];if(be&&be.trim()!==""){const ye=be.trim(),Ce=Pe&&me===0,Ue=!!(Se&&z.pinPolarities&&me<z.pinPolarities.length&&z.pinPolarities[me]==="-"),Le=ke.get(ye);Le!==void 0?ke.set(ye,{isNegative:Le.isNegative||Ue,hasPin1:Le.hasPin1||Ce}):ke.set(ye,{isNegative:Ue,hasPin1:Ce})}}for(const[me,be]of ke){const{isNegative:ye,hasPin1:Ce}=be,Ue=K(me);if(Ue){const Le={x:z.x,y:z.y},Ze=parseInt(me,10),bt=`${z.id}:${Ze}`,jt=un.has(bt);g.save(),jt?(g.strokeStyle="#00bfff",g.lineWidth=Math.max(2,mn*1.5/Math.max(xt,.001)),g.setLineDash([4,3])):(ye?g.strokeStyle="rgba(0, 0, 0, 0.8)":Ce?g.strokeStyle=_2(cn,.4):g.strokeStyle=cn,g.lineWidth=Math.max(1,mn/Math.max(xt,.001))),g.beginPath(),g.moveTo(Le.x,Le.y),g.lineTo(Ue.x,Ue.y),g.stroke(),g.setLineDash([]),g.restore()}}};re&&Qt.forEach(oe),he&&en.forEach(oe)}if(re&&Qt.forEach(L),he&&en.forEach(L),Uc&&Ls){g.save();const K=Ls.start,oe=Ls.end,z=Math.min(K.x,oe.x),Ae=Math.min(K.y,oe.y),Se=Math.max(K.x,oe.x),_e=Math.max(K.y,oe.y),Pe=Se-z,ke=_e-Ae,me=Math.max(2,6/Math.max(1e-4,xt));g.strokeStyle="#ff8800",g.fillStyle="rgba(255, 136, 0, 0.2)",g.lineWidth=Math.max(1,2/Math.max(1e-4,xt)),g.setLineDash([me,me]),g.beginPath(),g.rect(z,Ae,Pe,ke),g.fill(),g.stroke(),g.fillStyle="#ff8800",g.beginPath(),g.arc(K.x,K.y,Math.max(3,6/Math.max(1e-4,xt)),0,Math.PI*2),g.fill(),g.setLineDash([]),g.restore()}if(k==="select"&&wc){g.save();const K=Math.max(2,6/Math.max(1e-4,xt));g.strokeStyle="#00bfff",g.fillStyle="rgba(0, 191, 255, 0.15)",g.lineWidth=Math.max(1,1.5/Math.max(1e-4,xt)),g.setLineDash([K,K]),g.beginPath(),g.rect(wc.x,wc.y,wc.width,wc.height),g.fill(),g.stroke(),g.setLineDash([]),g.restore()}if(Ui){g.save();const K=50,z=2/xt;g.strokeStyle="#FF0000",g.lineWidth=z,g.lineCap="round",g.lineJoin="round",g.beginPath(),g.moveTo(-K,0),g.lineTo(K,0),g.stroke(),g.fillStyle="#FF0000",g.font=`${12/xt}px sans-serif`,g.textAlign="left",g.textBaseline="top",g.fillText("+X",K+2/xt,2/xt),g.textAlign="right",g.fillText("-X",-K-2/xt,2/xt),g.strokeStyle="#0000FF",g.lineWidth=z,g.lineCap="round",g.lineJoin="round",g.beginPath(),g.moveTo(0,-K),g.lineTo(0,K),g.stroke(),g.fillStyle="#0000FF",g.font=`${12/xt}px sans-serif`,g.textAlign="left",g.textBaseline="top",g.fillText("+Y",2/xt,K+2/xt),g.textBaseline="bottom",g.fillText("-Y",2/xt,-K-2/xt),g.restore()}g.restore()},[o,l,v,dt,st,Me,k,G,O,F,zn,Tt,xt,Kn.x,Kn.y,ui,ut,Ya,Ga,ra,Ra,Co,qo,f,N,X,re,he,Qt,en,Ee,fe,ci,Re,Pi,wc,wn,Mn,Ri,ji,un,_n,Y,J,je,de,Ge,Pt,ar,cn,mn,Kr,Ui,En,Uc,Ls]);At.useEffect(()=>{const c=()=>{const g=Rc.current;if(!g)return;const A=1.6,L=244,K=12,oe=6,z=12,Ae=g.clientWidth-L-K,Se=g.getBoundingClientRect(),_e=window.innerHeight,Pe=Se.top,me=_e-Pe-oe-10,be=Math.min(g.clientHeight-z,me),ye=Math.floor(be*A),Ce=Math.floor(Ae/A);let Ue,Le;ye<=Ae?(Ue=ye,Le=be):(Ue=Ae,Le=Ce),Ue=Math.max(600,Ue),Le=Math.max(375,Le),Le=Math.max(355,Le-20),Lc(Ze=>{const bt=Ze.width===0&&Ze.height===0,jt=Ze.width!==Ue||Ze.height!==Le;return bt&&jt&&setTimeout(()=>{Zt({x:0,y:0})},0),Ze.width===Ue&&Ze.height===Le?Ze:{width:Ue,height:Le}})};return c(),window.addEventListener("resize",c),()=>window.removeEventListener("resize",c)},[Fa,Zt]),At.useEffect(()=>{ar&&(ni&&(nn(!1),hi(null)),Bi(null))},[ar,ni,nn,hi,Bi]);const Tp=I.useCallback(c=>{if(dt.forEach(g=>{if(g.type==="via"||g.type==="pad"||g.type==="testPoint"||g.testPointType!==void 0||g.type!=="trace")return;let A=!1;if(g.layer==="top"?A=Ra:g.layer==="bottom"&&(A=Co),!!A){if(g.points.length===1){const L=g.points[0],K=Math.max(.5,g.size/2);wn.has(g.id)&&(c.strokeStyle="#00bfff",c.lineWidth=2,c.setLineDash([4,3]),c.beginPath(),c.arc(L.x,L.y,K+3,0,Xa),c.stroke(),c.setLineDash([])),c.fillStyle=g.color,c.beginPath(),c.arc(L.x,L.y,K,0,Xa),c.fill()}else if(wn.has(g.id)&&(c.strokeStyle="#00bfff",c.lineWidth=g.size+4,c.lineCap="round",c.lineJoin="round",c.globalAlpha=.6,c.beginPath(),g.points.forEach((L,K)=>{K===0?c.moveTo(L.x,L.y):c.lineTo(L.x,L.y)}),c.stroke(),c.globalAlpha=1),c.strokeStyle=g.color,c.lineWidth=g.size,c.lineCap="round",c.lineJoin="round",c.globalAlpha=1,c.beginPath(),g.points.forEach((L,K)=>{K===0?c.moveTo(L.x,L.y):c.lineTo(L.x,L.y)}),c.stroke(),Kr){c.fillStyle="#000000";for(const L of g.points)c.beginPath(),c.arc(L.x,L.y,g.size/2,0,Xa),c.fill()}}}),dt.forEach(g=>{if(g.type==="via"){if(!ra)return}else if(g.type==="pad"){const L=g.layer||"top";if(L==="top"&&!qo||L==="bottom"&&!f)return}else if(g.type==="testPoint"){const L=g.layer||"top";if(L==="top"&&!N||L==="bottom"&&!X)return}else return;const A=g.points[0];if(wn.has(g.id)){if(g.type==="via"){const L=Math.max(.5,g.size/2)+3;c.strokeStyle="#00bfff",c.lineWidth=2,c.setLineDash([4,3]),c.beginPath(),c.arc(A.x,A.y,L,0,Xa),c.stroke(),c.setLineDash([])}else if(g.type==="pad"){const L=Math.max(.5,g.size/2)+3;c.strokeStyle="#00bfff",c.lineWidth=2,c.setLineDash([4,3]),c.strokeRect(A.x-L,A.y-L,g.size+6,g.size+6),c.setLineDash([])}else if(g.type==="testPoint"){const L=Math.max(.5,g.size/2)+3;c.strokeStyle="#00bfff",c.lineWidth=2,c.setLineDash([4,3]),c.beginPath(),c.moveTo(A.x,A.y-L),c.lineTo(A.x+L,A.y),c.lineTo(A.x,A.y+L),c.lineTo(A.x-L,A.y),c.closePath(),c.stroke(),c.setLineDash([])}}if(g.type==="via"){const L=Math.max(.5,g.size/2),K=L*.5,oe=L*.7;c.fillStyle=g.color,c.beginPath(),c.arc(A.x,A.y,L,0,Xa),c.arc(A.x,A.y,K,0,Xa),c.fill("evenodd"),c.strokeStyle="#808080",c.lineWidth=1,c.beginPath(),c.moveTo(A.x-oe,A.y),c.lineTo(A.x+oe,A.y),c.stroke(),c.beginPath(),c.moveTo(A.x,A.y-oe),c.lineTo(A.x,A.y+oe),c.stroke()}else if(g.type==="pad"){const L=Math.max(.5,g.size/2),K=g.size,oe=K*.5,z=L*.7;c.fillStyle=g.color,c.beginPath(),c.rect(A.x-L,A.y-L,K,K),c.rect(A.x-oe/2,A.y-oe/2,oe,oe),c.fill("evenodd"),c.strokeStyle="#808080",c.lineWidth=1,c.beginPath(),c.moveTo(A.x-z,A.y),c.lineTo(A.x+z,A.y),c.stroke(),c.beginPath(),c.moveTo(A.x,A.y-z),c.lineTo(A.x,A.y+z),c.stroke()}else if(g.type==="testPoint"){const L=Math.max(.5,g.size/2),K=L*.7;c.fillStyle=g.color||"#FFFF00",c.strokeStyle="#000000",c.lineWidth=2,c.beginPath(),c.moveTo(A.x,A.y-L),c.lineTo(A.x+L,A.y),c.lineTo(A.x,A.y+L),c.lineTo(A.x-L,A.y),c.closePath(),c.fill(),c.stroke(),c.strokeStyle="#808080",c.lineWidth=1,c.beginPath(),c.moveTo(A.x-K,A.y),c.lineTo(A.x+K,A.y),c.stroke(),c.beginPath(),c.moveTo(A.x,A.y-K),c.lineTo(A.x,A.y+K),c.stroke()}}),st.length>0){const g=Tt;let A=!0;if(k==="draw"&&(Ge==="via"?A=ra:A=g==="top"?Ra:Co),A)if(k==="draw")if(Ge==="via"){const L=st[st.length-1],K=Math.max(.5,O/2),oe=K*.5,z=K*.7;c.fillStyle=G,c.beginPath(),c.arc(L.x,L.y,K,0,Xa),c.arc(L.x,L.y,oe,0,Xa),c.fill("evenodd"),c.strokeStyle="#808080",c.lineWidth=1,c.beginPath(),c.moveTo(L.x-z,L.y),c.lineTo(L.x+z,L.y),c.stroke(),c.beginPath(),c.moveTo(L.x,L.y-z),c.lineTo(L.x,L.y+z),c.stroke()}else if(Ge==="pad"){const L=st[st.length-1],K=Math.max(.5,O/2),oe=O,z=oe*.5,Ae=K*.7;c.fillStyle=G,c.beginPath(),c.rect(L.x-K,L.y-K,oe,oe),c.rect(L.x-z/2,L.y-z/2,z,z),c.fill("evenodd"),c.strokeStyle="#808080",c.lineWidth=1,c.beginPath(),c.moveTo(L.x-Ae,L.y),c.lineTo(L.x+Ae,L.y),c.stroke(),c.beginPath(),c.moveTo(L.x,L.y-Ae),c.lineTo(L.x,L.y+Ae),c.stroke()}else if(Ge==="testPoint"){const L=st[st.length-1],K=Math.max(.5,O/2),oe=K*.7;c.fillStyle=G,c.beginPath(),c.moveTo(L.x,L.y-K),c.lineTo(L.x+K,L.y),c.lineTo(L.x,L.y+K),c.lineTo(L.x-K,L.y),c.closePath(),c.fill(),c.strokeStyle="#808080",c.lineWidth=1,c.beginPath(),c.moveTo(L.x-oe,L.y),c.lineTo(L.x+oe,L.y),c.stroke(),c.beginPath(),c.moveTo(L.x,L.y-oe),c.lineTo(L.x,L.y+oe),c.stroke()}else{const L=_n||"top",K=L==="top"?Y:J,oe=L==="top"?je:de;if(st.length===1){const z=st[0],Ae=Math.max(.5,oe/2);c.fillStyle=K,c.beginPath(),c.arc(z.x,z.y,Ae,0,Xa),c.fill(),Pt&&(c.strokeStyle=K,c.lineWidth=oe,c.lineCap="round",c.lineJoin="round",c.globalAlpha=.6,c.beginPath(),c.moveTo(z.x,z.y),c.lineTo(Pt.x,Pt.y),c.stroke(),c.globalAlpha=1)}else if(c.strokeStyle=K,c.lineWidth=oe,c.lineCap="round",c.lineJoin="round",c.globalAlpha=1,c.beginPath(),st.forEach((z,Ae)=>{Ae===0?c.moveTo(z.x,z.y):c.lineTo(z.x,z.y)}),c.stroke(),Pt&&st.length>0){const z=st[st.length-1];c.globalAlpha=.6,c.beginPath(),c.moveTo(z.x,z.y),c.lineTo(Pt.x,Pt.y),c.stroke(),c.globalAlpha=1}}else k==="erase"&&(c.strokeStyle="rgba(255, 0, 0, 0.5)",c.lineWidth=O,c.lineCap="round",c.lineJoin="round",c.globalAlpha=.5,c.beginPath(),st.forEach((L,K)=>{K===0?c.moveTo(L.x,L.y):c.lineTo(L.x,L.y)}),c.stroke())}},[dt,wn,Ra,Co,ra,qo,f,N,X,st,k,Ge,G,O,Tt,_n,Y,J,je,de,Pt,Kr]),Ol=I.useCallback((c,g)=>{if(ar){alert("Cannot transform: Images are locked. Unlock images to transform them.");return}c==="top"&&o?s(A=>A?{...A,...g}:null):c==="bottom"&&l?d(A=>A?{...A,...g}:null):c==="both"&&(o&&s(A=>A?{...A,...g}:null),l&&d(A=>A?{...A,...g}:null))},[o,l,ar]),Ld=I.useCallback(()=>{zn&&(Ol(zn,{x:0,y:0,scale:1,rotation:0,flipX:!1,flipY:!1,skewX:0,skewY:0,keystoneV:0,keystoneH:0,brightness:100,contrast:100}),P(!1))},[Ol,zn]),zf=I.useCallback((c=1)=>{if(wn.size>0||Mn.size>0||Ri.size>0||ji.size>0){if(wn.size>0){const g=dt.filter(oe=>wn.has(oe.id)),A=Lr&&g.some(oe=>oe.type==="via"),L=po&&g.some(oe=>oe.type==="trace"),K=pa&&g.some(oe=>oe.type==="pad");if(A){alert("Cannot change size: Vias are locked. Unlock vias to change their size.");return}if(L){alert("Cannot change size: Traces are locked. Unlock traces to change their size.");return}if(K){alert("Cannot change size: Pads are locked. Unlock pads to change their size.");return}}if(Mn.size>0&&er){alert("Cannot change size: Components are locked. Unlock components to change their size.");return}if(Ri.size>0&&tr){alert("Cannot change size: Power nodes are locked. Unlock power nodes to change their size.");return}if(ji.size>0&&mo){alert("Cannot change size: Ground nodes are locked. Unlock ground nodes to change their size.");return}if(Mt(g=>g.map(A=>{if(wn.has(A.id)){const L=A.size+c;return A.type==="via"?Bt("via",L):A.type==="pad"?Bt("pad",L):A.type==="trace"&&Bt("trace",L,A.layer),{...A,size:L}}return A})),Mn.size>0){const g=(Mn.size>0&&Qt.find(A=>Mn.has(A.id))?.size||18)+c;Bt("component",g),oi(A=>A.map(L=>Mn.has(L.id)?{...L,size:(L.size||18)+c}:L)),Ni(A=>A.map(L=>Mn.has(L.id)?{...L,size:(L.size||18)+c}:L))}if(Ri.size>0){const g=(fe.find(A=>Ri.has(A.id))?.size||18)+c;Bt("power",g),$t(A=>A.map(L=>Ri.has(L.id)?{...L,size:L.size+c}:L))}if(ji.size>0){const g=(Re.find(A=>ji.has(A.id))?.size||18)+c;Bt("ground",g),rn(A=>A.map(L=>ji.has(L.id)?{...L,size:(L.size||18)+c}:L))}}else{let g=null;if(k==="draw"&&Ge==="via"?g="via":k==="draw"&&Ge==="pad"?g=Za.current==="bottom"?"padBottom":"padTop":k==="draw"&&Ge==="testPoint"?g=ds.current==="bottom"?"testPointBottom":"testPointTop":k==="draw"&&Ge==="trace"?g=Ka.current==="bottom"?"traceBottom":"traceTop":k==="component"?g=Ur.current==="bottom"?"componentBottom":"componentTop":k==="power"?g="power":k==="ground"&&(g="ground"),g){const A=Ln.get(g),L=Math.min(40,A.size+c);Ln.setSize(g,L)}}},[wn,Mn,Ri,ji,dt,Lr,po,pa,Jo,er,tr,mo,k,Ge,Bt]),Md=I.useCallback((c=1)=>{if(wn.size>0||Mn.size>0||Ri.size>0||ji.size>0){if(wn.size>0){const g=dt.filter(z=>wn.has(z.id)),A=Lr&&g.some(z=>z.type==="via"),L=po&&g.some(z=>z.type==="trace"),K=pa&&g.some(z=>z.type==="pad"),oe=Jo&&g.some(z=>z.type==="testPoint");if(A){alert("Cannot change size: Vias are locked. Unlock vias to change their size.");return}if(L){alert("Cannot change size: Traces are locked. Unlock traces to change their size.");return}if(K){alert("Cannot change size: Pads are locked. Unlock pads to change their size.");return}if(oe){alert("Cannot change size: Test Points are locked. Unlock test points to change their size.");return}}if(Mn.size>0&&er){alert("Cannot change size: Components are locked. Unlock components to change their size.");return}if(Ri.size>0&&tr){alert("Cannot change size: Power nodes are locked. Unlock power nodes to change their size.");return}if(ji.size>0&&mo){alert("Cannot change size: Ground nodes are locked. Unlock ground nodes to change their size.");return}if(Mt(g=>g.map(A=>{if(wn.has(A.id)){const L=Math.max(1,A.size-c);return A.type==="via"?Bt("via",L):A.type==="pad"?Bt("pad",L,A.layer):A.type==="testPoint"?Bt("testPoint",L,A.layer):A.type==="trace"&&Bt("trace",L,A.layer),{...A,size:L}}return A})),Mn.size>0){const g=Math.max(12,(Mn.size>0&&Qt.find(A=>Mn.has(A.id))?.size||18)-c);Bt("component",g),oi(A=>A.map(L=>Mn.has(L.id)?{...L,size:Math.max(12,(L.size||18)-c)}:L)),Ni(A=>A.map(L=>Mn.has(L.id)?{...L,size:Math.max(12,(L.size||18)-c)}:L))}if(Ri.size>0){const g=Math.max(12,(fe.find(A=>Ri.has(A.id))?.size||18)-c);Bt("power",g),$t(A=>A.map(L=>Ri.has(L.id)?{...L,size:Math.max(12,L.size-c)}:L))}if(ji.size>0){const g=Math.max(12,(Re.find(A=>ji.has(A.id))?.size||18)-c);Bt("ground",g),rn(A=>A.map(L=>ji.has(L.id)?{...L,size:Math.max(12,(L.size||18)-c)}:L))}}else{let g=null;if(k==="draw"&&Ge==="via"?g="via":k==="draw"&&Ge==="pad"?g=(Tt||qn||"top")==="bottom"?"padBottom":"padTop":k==="draw"&&Ge==="testPoint"?g=(Tt||gi||"top")==="bottom"?"testPointBottom":"testPointTop":k==="draw"&&Ge==="trace"?g=(Tt||_n||"top")==="bottom"?"traceBottom":"traceTop":k==="component"?g=(Tt||Ei||"top")==="bottom"?"componentBottom":"componentTop":k==="power"?g="power":k==="ground"&&(g="ground"),g){const A=Ln.get(g),L=Math.max(1,A.size-c);Ln.setSize(g,L)}}},[wn,Mn,Ri,ji,dt,Lr,po,pa,Jo,er,tr,mo,k,Ge,Tt,qn,gi,_n,Ei,Bt]),Sc=I.useCallback(()=>{const c=_a.size;if(wn.size>0||Mn.size>0||Ri.size>0||ji.size>0){if(wn.size>0){const g=dt.filter(z=>wn.has(z.id)),A=Lr&&g.some(z=>z.type==="via"),L=pa&&g.some(z=>z.type==="pad"),K=po&&g.some(z=>z.type==="trace"),oe=Jo&&g.some(z=>z.type==="testPoint");if(A||L||K||oe){alert("Cannot change size: selected items are locked.");return}}if(Mn.size>0&&er){alert("Cannot change size: selected components are locked.");return}if(Ri.size>0&&tr){alert("Cannot change size: selected power nodes are locked.");return}if(ji.size>0&&mo){alert("Cannot change size: selected ground nodes are locked.");return}Mt(g=>g.map(A=>wn.has(A.id)?(A.type==="via"?(Bt("via",c),Tr(L=>{const K=new Map(L),oe=K.get("via");return oe&&K.set("via",{...oe,settings:{...oe.settings,size:c}}),K})):A.type==="pad"?(Bt("pad",c,A.layer),Tr(L=>{const K=new Map(L),oe=K.get("pad");if(oe){const z=new Map(oe.layerSettings);z.set(A.layer,{...z.get(A.layer)||{color:oe.settings.color,size:c},size:c}),K.set("pad",{...oe,layerSettings:z})}return K})):A.type==="testPoint"?(Bt("testPoint",c,A.layer),Tr(L=>{const K=new Map(L),oe=K.get("testPoint");if(oe){const z=new Map(oe.layerSettings);z.set(A.layer,{...z.get(A.layer)||{color:oe.settings.color,size:c},size:c}),K.set("testPoint",{...oe,layerSettings:z})}return K})):A.type==="trace"&&Bt("trace",c,A.layer),{...A,size:c}):A)),Mn.size>0&&(Bt("component",c),oi(g=>g.map(A=>Mn.has(A.id)?{...A,size:c}:A)),Ni(g=>g.map(A=>Mn.has(A.id)?{...A,size:c}:A))),Ri.size>0&&(Bt("power",c),$t(g=>g.map(A=>Ri.has(A.id)?{...A,size:c}:A))),ji.size>0&&(Bt("ground",c),rn(g=>g.map(A=>ji.has(A.id)?{...A,size:c}:A)))}else W(c),k==="draw"&&Ge==="trace"?Tt==="top"?(ee(c),Bt("trace",c,"top")):(Ne(c),Bt("trace",c,"bottom")):k==="draw"&&Ge==="via"?Bt("via",c):k==="draw"&&Ge==="pad"?Bt("pad",c,Tt):k==="draw"&&Ge==="testPoint"?Bt("testPoint",c,Tt):Bt(k==="component"?"component":k==="power"?"power":k==="ground"?"ground":"brush",c);ts({visible:!1,size:6})},[_a.size,wn,Mn,Ri,ji,dt,Lr,po,er,tr,mo,k,Ge,Tt,Bt,yi,Tr]),_f=I.useCallback(()=>{ho({visible:!1,source:null,interval:5})},[]),Bd=I.useCallback(async(c,g=!1)=>{await nf(c,io,ai,go,zo,wo,no,br,ro,Ii,Ai,Po,ho,Mr,as,g)},[io,ai,go,zo,wo,no,br,ro,Ii,Ai,Po,ho,Mr,as]),Wc=I.useCallback(()=>{Qn(),y("select")},[Qn]),yu=I.useCallback(c=>{if(c.key==="Escape"){const z=document.activeElement;if(z&&(z.tagName==="INPUT"&&z.type==="checkbox"||z.tagName==="INPUT"&&z.type==="radio")){z.blur(),c.preventDefault(),c.stopPropagation();return}}const g=document.activeElement;if(g&&(g.tagName==="INPUT"&&g.type!=="checkbox"&&g.type!=="radio"||g.tagName==="TEXTAREA"||g.isContentEditable))return;const A=os.current>0;if(A&&c.key!=="m"&&c.key!=="M")return;const L=parseInt(c.key);if(!isNaN(L)&&L>=0&&L<=9){if(c.preventDefault(),c.stopPropagation(),k==="center"&&Zu){if(On.current&&(clearTimeout(On.current),On.current=null),Ct.current){let Se=0,_e=0;o?(Se=o.x,_e=o.y):l&&(Se=l.x,_e=l.y),vs(Pe=>({...Pe,[L]:{pcbReferenceX:Se,pcbReferenceY:_e,x:0,y:0,zoom:xt,viewRotation:ui,viewFlipX:ut,isBottomView:qa,transparency:v,showTopImage:Ya,showBottomImage:Ga,showViasLayer:ra,showTopTracesLayer:Ra,showBottomTracesLayer:Co,showTopPadsLayer:qo,showBottomPadsLayer:f,showTopTestPointsLayer:N,showBottomTestPointsLayer:X,showTopComponents:re,showBottomComponents:he,showPowerLayer:Ee,showGroundLayer:ci,showConnectionsLayer:Pi}}))}vr(!1),y("select"),Di(void 0);return}const z=Pl[L];if(z){Yn(z.zoom),Si(z.viewRotation??0),Et(z.viewFlipX??!1),hr(z.isBottomView??!1),m(z.transparency??50);const Ae=z.pcbReferenceX??z.x??0,Se=z.pcbReferenceY??z.y??0;let _e=0,Pe=0;o?(_e=o.x,Pe=o.y):l&&(_e=l.x,Pe=l.y);const ke=Ae-_e,me=Se-Pe;(Math.abs(ke)>.001||Math.abs(me)>.001)&&(o&&s({...o,x:o.x+ke,y:o.y+me}),l&&d({...l,x:l.x+ke,y:l.y+me}),oi(Qt.map(be=>({...be,x:be.x+ke,y:be.y+me}))),Ni(en.map(be=>({...be,x:be.x+ke,y:be.y+me}))),$t(mt.map(be=>({...be,x:be.x+ke,y:be.y+me}))),rn(Jt.map(be=>({...be,x:be.x+ke,y:be.y+me}))),Mt(dt.map(be=>({...be,points:be.points.map(ye=>({...ye,x:ye.x+ke,y:ye.y+me}))}))),Ko(ka.map(be=>({...be,x:be.x+ke,y:be.y+me}))),jr(Qr.map(be=>({...be,x:be.x+ke,y:be.y+me})))),Zt({x:0,y:0}),To(z.showTopImage),qi(z.showBottomImage),ss(z.showViasLayer),Hi(z.showTopTracesLayer),oa(z.showBottomTracesLayer),va(z.showTopPadsLayer),x(z.showBottomPadsLayer),R(z.showTopTestPointsLayer),ie(z.showBottomTestPointsLayer),le(z.showTopComponents),Te(z.showBottomComponents),Xe(z.showPowerLayer),Li(z.showGroundLayer),ur(z.showConnectionsLayer)}return}if(c.key==="+"||c.key==="="){c.preventDefault(),c.stopPropagation(),zf(c.shiftKey?5:1);return}if(c.key==="-"||c.key==="_"){c.preventDefault(),c.stopPropagation(),Md(c.shiftKey?5:1);return}const K=c.shiftKey||c.getModifierState("CapsLock"),oe=k==="transform"&&zn;if(c.key==="ArrowUp"||c.key==="ArrowDown"||c.key==="ArrowLeft"||c.key==="ArrowRight"){if(Mn.size>0){c.preventDefault(),c.stopPropagation();const z=c.shiftKey?10:1;let Ae=0,Se=0;c.key==="ArrowUp"?Se=-z:c.key==="ArrowDown"?Se=z:c.key==="ArrowLeft"?Ae=-z:c.key==="ArrowRight"&&(Ae=z);for(const _e of Mn){const Pe=Qt.find(ke=>ke.id===_e);if(Pe){const ke=Pe.x+Ae,me=Pe.y+Se,be=xr({x:ke,y:me});oi(ye=>ye.map(Ce=>Ce.id===_e?{...Ce,x:be.x,y:be.y}:Ce))}else{const ke=en.find(me=>me.id===_e);if(ke){const me=ke.x+Ae,be=ke.y+Se,ye=xr({x:me,y:be});Ni(Ce=>Ce.map(Ue=>Ue.id===_e?{...Ue,x:ye.x,y:ye.y}:Ue))}}}return}if(K&&!oe&&Mn.size===0){if(c.key==="ArrowUp"||c.key==="ArrowDown"){c.preventDefault(),c.stopPropagation();const z=c.key==="ArrowUp"?-90:90;Cd(z);return}else if(c.key==="ArrowLeft"||c.key==="ArrowRight"){c.preventDefault(),c.stopPropagation(),mf();return}}}if((c.key==="I"||c.key==="i")&&!c.ctrlKey&&!c.shiftKey&&!c.altKey){const z=document.activeElement;if(!!z&&(z.tagName==="INPUT"&&z.type!=="range"&&z.type!=="checkbox"&&z.type!=="radio"||z.tagName==="TEXTAREA"||z.isContentEditable))return;c.preventDefault(),c.stopPropagation();const Se=[];wn.size>0,wn.size===0&&Mn.size===0&&Ri.size===0&&ji.size===0&&Se.push(`
No objects selected.`);const _e=Se.join(`
`);console.log(_e),$r({visible:!0,text:_e});return}if((c.key==="N"||c.key==="n")&&!c.ctrlKey&&!c.shiftKey&&!c.altKey){const z=document.activeElement;if(!!z&&(z.tagName==="INPUT"&&z.type!=="range"&&z.type!=="checkbox"&&z.type!=="radio"||z.tagName==="TEXTAREA"||z.isContentEditable))return;c.preventDefault(),c.stopPropagation(),yr(!0);return}if((c.key==="L"||c.key==="l")&&!c.ctrlKey&&!c.shiftKey&&!c.altKey){const z=document.activeElement;if(!!z&&(z.tagName==="INPUT"&&z.type!=="range"&&z.type!=="checkbox"&&z.type!=="radio"||z.tagName==="TEXTAREA"||z.isContentEditable))return;c.preventDefault(),c.stopPropagation(),el(!0);return}if((c.key==="E"||c.key==="e")&&!c.ctrlKey&&!c.shiftKey&&!c.altKey){const z=document.activeElement;if(!!z&&(z.tagName==="INPUT"&&z.type!=="range"&&z.type!=="checkbox"&&z.type!=="radio"||z.tagName==="TEXTAREA"||z.isContentEditable))return;c.preventDefault(),c.stopPropagation(),os.current<=0&&Eo(!0);return}if(c.key==="O"||c.key==="o"){const z=document.activeElement;if(!!z&&(z.tagName==="INPUT"&&z.type!=="range"&&z.type!=="checkbox"&&z.type!=="radio"||z.tagName==="TEXTAREA"||z.isContentEditable))return;c.preventDefault(),c.stopPropagation();const Se=Pl[0];if(Se){Yn(Se.zoom),Si(Se.viewRotation??0),Et(Se.viewFlipX??!1),hr(Se.isBottomView??!1),m(Se.transparency??50);const _e=Se.pcbReferenceX??Se.x??0,Pe=Se.pcbReferenceY??Se.y??0;let ke=0,me=0;o?(ke=o.x,me=o.y):l&&(ke=l.x,me=l.y);const be=_e-ke,ye=Pe-me;(Math.abs(be)>.001||Math.abs(ye)>.001)&&(o&&s({...o,x:o.x+be,y:o.y+ye}),l&&d({...l,x:l.x+be,y:l.y+ye}),oi(Qt.map(Ce=>({...Ce,x:Ce.x+be,y:Ce.y+ye}))),Ni(en.map(Ce=>({...Ce,x:Ce.x+be,y:Ce.y+ye}))),$t(mt.map(Ce=>({...Ce,x:Ce.x+be,y:Ce.y+ye}))),rn(Jt.map(Ce=>({...Ce,x:Ce.x+be,y:Ce.y+ye}))),Mt(dt.map(Ce=>({...Ce,points:Ce.points.map(Ue=>({...Ue,x:Ue.x+be,y:Ue.y+ye}))}))),Ko(ka.map(Ce=>({...Ce,x:Ce.x+be,y:Ce.y+ye}))),jr(Qr.map(Ce=>({...Ce,x:Ce.x+be,y:Ce.y+ye})))),To(Se.showTopImage),qi(Se.showBottomImage),ss(Se.showViasLayer),Hi(Se.showTopTracesLayer),oa(Se.showBottomTracesLayer),va(Se.showTopPadsLayer),x(Se.showBottomPadsLayer),R(Se.showTopTestPointsLayer),ie(Se.showBottomTestPointsLayer),le(Se.showTopComponents),Te(Se.showBottomComponents),Xe(Se.showPowerLayer),Li(Se.showGroundLayer),ur(Se.showConnectionsLayer)}else Yn(1),Si(0),Et(!1),hr(!1),m(0);Zt({x:0,y:0}),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),p("overlay"),Tn(new Set),yn(new Set),hn(new Set),Cn(new Set),y("select");return}if((c.key==="Alt"||c.altKey)&&(wp(!0),ao(!0)),c.key==="Escape"){c.preventDefault(),c.stopPropagation(),Wc(),nc(!1),xc(!1),pu(!1),Un(!1),ga(!1),ad(null);return}if(c.key==="Enter"&&k==="draw"&&Ge==="trace"){zu();return}if((c.key==="Delete"||c.key==="Backspace")&&(wn.size>0||Mn.size>0||Ri.size>0||ji.size>0)){if(c.preventDefault(),c.stopPropagation(),Yi(dt,Qt,en,mt,Jt),wn.size>0){const z=dt.filter(ke=>wn.has(ke.id)),Ae=Lr&&z.some(ke=>ke.type==="via"),Se=po&&z.some(ke=>ke.type==="trace"),_e=pa&&z.some(ke=>ke.type==="pad"),Pe=Jo&&z.some(ke=>ke.type==="testPoint");Ae?alert("Cannot delete: Vias are locked. Unlock vias to delete them."):Se?alert("Cannot delete: Traces are locked. Unlock traces to delete them."):_e?alert("Cannot delete: Pads are locked. Unlock pads to delete them."):Pe?alert("Cannot delete: Test points are locked. Unlock test points to delete them."):(Mt(ke=>ke.filter(me=>!wn.has(me.id))),Tn(new Set))}Mn.size>0&&(er?alert("Cannot delete: Components are locked. Unlock components to delete them."):(oi(z=>z.filter(Ae=>!Mn.has(Ae.id))),Ni(z=>z.filter(Ae=>!Mn.has(Ae.id))),yn(new Set))),Ri.size>0&&(tr?alert("Cannot delete: Power nodes are locked. Unlock power nodes to delete them."):($t(z=>z.filter(Ae=>!Ri.has(Ae.id))),hn(new Set))),ji.size>0&&(mo?alert("Cannot delete: Ground nodes are locked. Unlock ground nodes to delete them."):(rn(z=>z.filter(Ae=>!ji.has(Ae.id))),Cn(new Set)));return}if((c.key==="z"||c.key==="Z")&&(c.ctrlKey||c.metaKey)&&!c.shiftKey&&!c.altKey){const z=document.activeElement;if(!!z&&(z.tagName==="INPUT"&&z.type!=="range"&&z.type!=="checkbox"&&z.type!=="radio"||z.tagName==="TEXTAREA"||z.isContentEditable))return;c.preventDefault(),c.stopPropagation();const Se=Dr();if(Se){const _e=new Set(Se.drawingStrokes.map(be=>be.id));for(const be of dt)if(!_e.has(be.id))for(const ye of be.points)ye.id&&typeof ye.id=="number"&&Zp(ye.id);const Pe=new Set([...Se.componentsTop.map(be=>be.id),...Se.componentsBottom.map(be=>be.id)]);for(const be of[...Qt,...en])if(!Pe.has(be.id)){for(const ye of be.pinConnections)if(ye&&ye.trim()!==""){const Ce=parseInt(ye,10);!isNaN(Ce)&&Ce>0&&Zp(Ce)}}const ke=new Set(Se.powerSymbols.map(be=>be.id));for(const be of mt)!ke.has(be.id)&&be.pointId&&typeof be.pointId=="number"&&Zp(be.pointId);const me=new Set(Se.groundSymbols.map(be=>be.id));for(const be of Jt)!me.has(be.id)&&be.pointId&&typeof be.pointId=="number"&&Zp(be.pointId);Mt(Se.drawingStrokes),oi(Se.componentsTop),Ni(Se.componentsBottom),$t(Se.powerSymbols),rn(Se.groundSymbols),et([])}return}if((c.key==="c"||c.key==="C")&&(c.ctrlKey||c.metaKey)&&!c.shiftKey&&!c.altKey){const z=document.activeElement;if(!!z&&(z.tagName==="INPUT"&&z.type!=="range"&&z.type!=="checkbox"&&z.type!=="radio"||z.tagName==="TEXTAREA"||z.isContentEditable))return;if(Mn.size===1){c.preventDefault(),c.stopPropagation();const Se=Array.from(Mn)[0],_e=[...Qt,...en].find(Pe=>Pe.id===Se);_e&&(_d(_e),console.log("Component copied:",_e.id,_e.designator))}return}if((c.key==="v"||c.key==="V")&&(c.ctrlKey||c.metaKey)&&!c.shiftKey&&!c.altKey){const z=document.activeElement;if(!!z&&(z.tagName==="INPUT"&&z.type!=="range"&&z.type!=="checkbox"&&z.type!=="radio"||z.tagName==="TEXTAREA"||z.isContentEditable))return;if(Os&&!er){c.preventDefault(),c.stopPropagation();const Se=[...Qt,...en];let _e;ki?_e=Xf():_e={...Oi.current};let Pe;if(Os.designator){const ye=Os.designator.match(/^([A-Za-z]+)(\d+)$/);ye?Pe=ye[1]:Pe=vg(Os.componentType)}else Pe=vg(Os.componentType);const ke=R2(Pe,Se,_e),me=`${Pe}${ke}`;if(ki){const ye=Xf();P1(Pe,ke,ye)}else Oi.current[Pe]=Math.max(Oi.current[Pe]||0,ke);const be={...Os,id:ix("comp"),designator:me,pinConnections:new Array(Os.pinCount).fill(""),pinPolarities:Os.pinPolarities?new Array(Os.pinCount).fill(""):void 0,x:Os.x+5,y:Os.y+5};Os.pinNames&&(be.pinNames=[...Os.pinNames]),be.layer==="top"?oi(ye=>[...ye,be]):Ni(ye=>[...ye,be]),Qn(),yn(new Set([be.id])),console.log("Component pasted:",be.id,be.designator)}return}if(c.code==="KeyV"&&c.altKey&&!c.ctrlKey&&!c.shiftKey&&!A){const z=document.activeElement;if(!!z&&(z.tagName==="INPUT"&&z.type!=="range"&&z.type!=="checkbox"&&z.type!=="radio"||z.tagName==="TEXTAREA"||z.isContentEditable))return;c.preventDefault(),c.stopPropagation(),gc(!1),ml(!0);return}if(c.code==="KeyP"&&c.altKey&&!c.ctrlKey&&!c.shiftKey&&!A){const z=document.activeElement;if(!!z&&(z.tagName==="INPUT"&&z.type!=="range"&&z.type!=="checkbox"&&z.type!=="radio"||z.tagName==="TEXTAREA"||z.isContentEditable))return;c.preventDefault(),c.stopPropagation(),gc(!0),ml(!0);return}if((c.key==="a"||c.key==="A")&&!c.ctrlKey&&!c.altKey&&!c.shiftKey&&!A){const z=document.activeElement;if(!!z&&(z.tagName==="INPUT"&&z.type!=="range"&&z.type!=="checkbox"&&z.type!=="radio"||z.tagName==="TEXTAREA"||z.isContentEditable))return;if(Mn.size>0){c.preventDefault(),c.stopPropagation();const Se=Array.from(Mn),_e=Se[Se.length-1];let Pe=null,ke=null;Pe=Qt.find(me=>me.id===_e)||null,Pe?ke="top":(Pe=en.find(me=>me.id===_e)||null,Pe&&(ke="bottom")),Pe&&ke&&C(Pe,ke)}return}if(!c.ctrlKey&&!c.altKey){const z=document.activeElement;if(!(!!z&&(z.tagName==="INPUT"&&z.type!=="range"&&z.type!=="checkbox"&&z.type!=="radio"||z.tagName==="TEXTAREA"||z.isContentEditable)))switch(c.key){case"s":case"S":c.preventDefault(),Qn(),Wc();return;case"b":case"B":c.preventDefault(),Qn(),pe.length===1?(Jn(pe[0].id),y("power"),Un(!1),Xe(!0)):pe.length>1?Un(!0):(Un(!0),y("power"),Xe(!0));return;case"g":case"G":c.preventDefault(),Qn(),Ve.length===1?(yo(Ve[0].id),y("ground"),fi(!1),Li(!0)):Ve.length>1?fi(!0):(fi(!0),y("ground"),Li(!0));return;case"v":case"V":c.preventDefault(),Qn(),zt("via"),y("draw"),ss(!0);return;case"p":case"P":c.preventDefault(),Qn(),zt("pad"),y("draw");return;case"y":case"Y":c.preventDefault(),Qn(),zt("testPoint"),y("draw");return;case"t":case"T":c.preventDefault(),Qn(),zt("trace"),y("draw");return;case"c":case"C":c.preventDefault(),Qn(),y("component"),Ad.current?Nd(Ad.current):Nd(null);return;case"e":case"E":c.preventDefault(),Qn(),y("erase");return;case"h":case"H":c.preventDefault(),Qn(),y("pan");return;case"x":case"X":c.preventDefault(),Qn(),y("center"),vr(!0),On.current&&clearTimeout(On.current),On.current=setTimeout(()=>{vr(!1),y("select"),Di(void 0)},2e3);return;case"m":case"M":if(!c.ctrlKey){c.preventDefault(),Qn(),au(!1),y("magnify");return}break}}if(k==="transform"&&zn){if(!(c.key==="ArrowLeft"||c.key==="ArrowRight"||c.key==="ArrowUp"||c.key==="ArrowDown"))return;c.preventDefault(),c.stopPropagation();const Ae=document.activeElement;if(Ae&&Ae.tagName==="INPUT"){const Se=Ae;Se.type==="radio"&&Se.blur()}if(ar)return;if(fr==="nudge"){let Se=0,_e=0;switch(c.key){case"ArrowLeft":Se=-1;break;case"ArrowRight":Se=1;break;case"ArrowUp":_e=-1;break;case"ArrowDown":_e=1;break;default:return}zn==="top"&&o?s(Pe=>Pe?{...Pe,x:Pe.x+Se,y:Pe.y+_e}:null):zn==="bottom"&&l?d(Pe=>Pe?{...Pe,x:Pe.x+Se,y:Pe.y+_e}:null):zn==="both"&&(o&&s(Pe=>Pe?{...Pe,x:Pe.x+Se,y:Pe.y+_e}:null),l&&d(Pe=>Pe?{...Pe,x:Pe.x+Se,y:Pe.y+_e}:null))}else if(fr==="scale"){let Se=0;switch(c.key){case"ArrowUp":Se=.01;break;case"ArrowDown":Se=-.01;break;case"ArrowRight":Se=.001;break;case"ArrowLeft":Se=-.001;break;default:return}if(zn==="top"){o&&s(_e=>_e?{..._e,scale:Math.max(.1,Math.min(3,_e.scale+Se))}:null);return}if(zn==="bottom"){l&&d(_e=>_e?{..._e,scale:Math.max(.1,Math.min(3,_e.scale+Se))}:null);return}if(zn==="both"){o&&s(_e=>_e?{..._e,scale:Math.max(.1,Math.min(3,_e.scale+Se))}:null),l&&d(_e=>_e?{..._e,scale:Math.max(.1,Math.min(3,_e.scale+Se))}:null);return}}else if(fr==="rotate"){let Se=0;switch(c.key){case"ArrowUp":Se=1;break;case"ArrowDown":Se=-1;break;case"ArrowRight":Se=.1;break;case"ArrowLeft":Se=-.1;break;default:return}if(zn==="top"){o&&s(_e=>_e?{..._e,rotation:_e.rotation+Se}:null);return}if(zn==="bottom"){l&&d(_e=>_e?{..._e,rotation:_e.rotation+Se}:null);return}if(zn==="both"){o&&s(_e=>_e?{..._e,rotation:_e.rotation+Se}:null),l&&d(_e=>_e?{..._e,rotation:_e.rotation+Se}:null);return}}else if(fr==="slant"){let Se=0,_e=0;switch(c.key){case"ArrowUp":_e=-.5;break;case"ArrowDown":_e=.5;break;case"ArrowLeft":Se=-.5;break;case"ArrowRight":Se=.5;break}if(Se!==0||_e!==0){const Pe=Cu,ke=me=>Math.max(-.7,Math.min(.7,me));if(zn==="top"){o&&s(me=>me?{...me,skewX:ke((me.skewX||0)+Pe(Se)),skewY:ke((me.skewY||0)+Pe(_e))}:null);return}if(zn==="bottom"){l&&d(me=>me?{...me,skewX:ke((me.skewX||0)+Pe(Se)),skewY:ke((me.skewY||0)+Pe(_e))}:null);return}if(zn==="both"){o&&s(me=>me?{...me,skewX:ke((me.skewX||0)+Pe(Se)),skewY:ke((me.skewY||0)+Pe(_e))}:null),l&&d(me=>me?{...me,skewX:ke((me.skewX||0)+Pe(Se)),skewY:ke((me.skewY||0)+Pe(_e))}:null);return}}}else if(fr==="keystone"){let Se=0,_e=0;switch(c.key){case"ArrowUp":_e=-.5;break;case"ArrowDown":_e=.5;break;case"ArrowLeft":Se=-.5;break;case"ArrowRight":Se=.5;break}if(Se!==0||_e!==0){const Pe=Cu,ke=me=>Math.max(-.35,Math.min(.35,me));if(zn==="top"){o&&s(me=>me?{...me,keystoneH:ke((me.keystoneH||0)+Pe(Se)),keystoneV:ke((me.keystoneV||0)+Pe(_e))}:null);return}if(zn==="bottom"){l&&d(me=>me?{...me,keystoneH:ke((me.keystoneH||0)+Pe(Se)),keystoneV:ke((me.keystoneV||0)+Pe(_e))}:null);return}if(zn==="both"){o&&s(me=>me?{...me,keystoneH:ke((me.keystoneH||0)+Pe(Se)),keystoneV:ke((me.keystoneV||0)+Pe(_e))}:null),l&&d(me=>me?{...me,keystoneH:ke((me.keystoneH||0)+Pe(Se)),keystoneV:ke((me.keystoneV||0)+Pe(_e))}:null);return}}}}else{const z=c.target;if(z.tagName==="INPUT"&&z.type==="range"){const Ae=z,Se=Number(Ae.value),_e=Number(Ae.min),Pe=Number(Ae.max),ke=Number(Ae.step)||1;switch(c.key){case"ArrowLeft":c.preventDefault();const me=Math.max(_e,Se-ke);Ae.value=me.toString(),Ae.dispatchEvent(new Event("input",{bubbles:!0}));break;case"ArrowRight":c.preventDefault();const be=Math.min(Pe,Se+ke);Ae.value=be.toString(),Ae.dispatchEvent(new Event("input",{bubbles:!0}));break}}}},[k,zn,fr,o,l,wn,Mn,Ri,ji,dt,Qt,en,fe,Re,pe,Ge,zu,_n,Y,J,je,de,Wc,oi,Ni,Dr,Mt,$t,rn,mt,Jt,mf,Cd,Pl,xt,ui,ut,qa,v,Yn,Si,Et,hr,m,s,d,Ko,jr,Zt,p,Tn,yn,hn,Cn,y,ka,Qr,Ya,Ga,ra,Ra,Co,qo,f,N,X,re,he,Ee,ci,Pi,To,qi,ss,Hi,oa,va,x,R,ie,le,Te,Xe,Li,ur,gc,ml,C]);At.useEffect(()=>{k!=="transform"&&Bi(null)},[k]),At.useEffect(()=>{window.addEventListener("keydown",yu,!0);const c=g=>{g.key==="Alt"&&(wp(!1),ao(!1),ma(null))};return window.addEventListener("keyup",c,!0),()=>{window.removeEventListener("keydown",yu,!0),window.removeEventListener("keyup",c,!0)}},[yu,Ri,ji,tr,tr,fe,Re,zf,Md,Wc,Mn,Qt,en,oi,Ni,Pl,Zu,k]);const Sr=I.useCallback(()=>{Oi.current={},D("#AA4499"),$("#F781BF"),ee(6),Ne(6),Gt("trace","#AA4499","top"),Gt("trace","#F781BF","bottom"),Bt("trace",6,"top"),Bt("trace",6,"bottom"),$e("#0072B2"),w("#56B4E9"),H(18),ve(18),Gt("pad","#0072B2","top"),Gt("pad","#56B4E9","bottom"),Bt("pad",18,"top"),Bt("pad",18,"bottom"),Ot("#6A3D9A"),qt("#9467BD"),fn(18),ln(18),Gt("component","#6A3D9A","top"),Gt("component","#9467BD","bottom"),Bt("component",18,"top"),Bt("component",18,"bottom"),ko("top"),te("#AA4499"),W(6),Be([{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),gt([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),Bt("power",18),Bt("ground",18),da(!1),fa(!1),ha(!1),za(!1),es(!1),to(!1),tn("top"),y("select"),m(50),_(!1),p("overlay"),ep(),Rr()},[Gt,Bt,Rr]),zh=I.useCallback(()=>{Mr(null),wo(null),sr(""),Do(""),go(!1),zo(null),no(""),Wa([]),Yr(-1),bo(!1),hr(!1),gr(null),rs(null),Ii.current&&(clearInterval(Ii.current),Ii.current=null),s(null),d(null),Rr(),Mt([]),Ko([]),jr([]),Oa([]),kn([]),et([]),Xt.current=[],oi([]),Ni([]),Ea(null),Aa(null),$t([]),rn([]),di(null),Be([{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),gt([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),Tn(new Set),yn(new Set),hn(new Set),Cn(new Set),Oo(!1),La([]),zl({productName:"",productVersion:"",manufacturer:"",date:new Date().toISOString().split("T")[0]}),p("overlay"),Yn(1),pr(0,0),mi(!0),tn("top"),vs({}),vr(!1),On.current&&(clearTimeout(On.current),On.current=null),Bi(null),nn(!1),hi(null),zr("nudge"),P(!1),m(50),_(!1),T(2e3),da(!1),fa(!1),ys(!1),Pa(!1),ha(!1),za(!1),es(!1),to(!1),To(!0),qi(!0),ss(!0),Hi(!0),oa(!0),va(!0),x(!0),R(!0),ie(!0),le(!0),Te(!0),Xe(!0),Li(!0),ur(!0),ir(!0),y("select"),zt("trace"),ko("top"),us("top"),Mo("top"),zs("top"),Ka.current="top",Za.current="top",ds.current="top",Ur.current="top",Oi.current={},si(!0),lr(!1),ep(),Ln.initialize(),_s(null),$r({visible:!1,text:""}),Qo({visible:!1,title:"",message:""}),Va({visible:!1}),Kl({visible:!1}),xs({visible:!1,projectName:"",locationPath:"",locationHandle:null}),ea({visible:!1,filename:"",locationPath:"",locationHandle:null}),Po({visible:!1,interval:null}),ho({visible:!1,source:"new",interval:5}),ga(!1),pt(!1),ei(!1),Xr(!1),Hc(!1),yr(!1),el(!1),Ks(!1),Eo(!1),ol(null),ma(null),ba(null),$a(!1),So.current=null,Ro.current=null,we(!1),Rt(null),pn.current=0,ti.current=!1,console.log("Project closed: All state cleared and browser permissions released")},[]);I.useCallback(()=>{Mr(null),wo(null),na&&(na.current=null),br&&(br.current=null),sr(""),Do(""),go(!1),zo(null),no(""),Wa([]),Yr(-1),ro&&(ro.current=""),Ai.current=!1,bo(!1),hr(!1),gr(null),rs(null),Ii.current&&(clearInterval(Ii.current),Ii.current=null),s(null),d(null),Rr(),Mt([]),Ko([]),jr([]),Oa([]),kn([]),et([]),Xt.current=[],oi([]),Ni([]),Ea(null),Aa(null),$t([]),rn([]),di(null),Be([{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),gt([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),Tn(new Set),yn(new Set),hn(new Set),Cn(new Set),Oo(!1),La([]),zl({productName:"",productVersion:"",manufacturer:"",date:new Date().toISOString().split("T")[0]}),p("overlay"),Yn(1),pr(0,0),mi(!0),tn("top"),vs({}),vr(!1),On.current&&(clearTimeout(On.current),On.current=null),Bi(null),nn(!1),hi(null),zr("nudge"),P(!1),m(50),_(!1),T(2e3),da(!1),fa(!1),ys(!1),Pa(!1),ha(!1),za(!1),es(!1),to(!1),To(!0),qi(!0),ss(!0),Hi(!0),oa(!0),va(!0),x(!0),R(!0),ie(!0),le(!0),Te(!0),Xe(!0),Li(!0),ur(!0),ir(!0),y("select"),zt("trace"),ko("top"),us("top"),Mo("top"),zs("top"),Ka.current="top",Za.current="top",ds.current="top",Ur.current="top",Oi.current={},si(!0),lr(!1),ep(),Ln.initialize(),_s(null),$r({visible:!1,text:""}),Qo({visible:!1,title:"",message:""}),Va({visible:!1}),Kl({visible:!1}),xs({visible:!1,projectName:"",locationPath:"",locationHandle:null}),ea({visible:!1,filename:"",locationPath:"",locationHandle:null}),Po({visible:!1,interval:null}),ho({visible:!1,source:"new",interval:5}),ga(!1),pt(!1),ei(!1),Xr(!1),Hc(!1),yr(!1),el(!1),Ks(!1),ol(null),ma(null),ba(null),$a(!1),So.current=null,Ro.current=null,we(!1),Rt(null),pn.current=0,ti.current=!1,console.log("Project closed: All state cleared and browser permissions released")},[Mr,wo,sr,Do,go,zo,no,Wa,Yr,s,d,Mt,et,Ko,jr,Oa,kn,oi,Ni,Ea,Aa,$t,rn,di,Be,gt,Tn,yn,hn,Cn,Oo,La,p,Yn,Fa,mi,tn,vs,vr,Bi,nn,hi,zr,P,m,_,T,da,fa,ys,Pa,ha,za,es,to,To,qi,ss,Hi,oa,va,x,R,ie,le,Te,Xe,Li,ur,y,zt,ko,us,Mo,zs,si,lr,_s,$r,Qo,Va,xs,ea,Po,ho,Rr,ga,pt,ei,Xr,Hc,yr,el,ol,ma,ba,$a,we,Rt]);const Tc=I.useCallback(()=>{Sr(),setTimeout(()=>{Yn(1),Zt({x:0,y:0}),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),Tn(new Set),yn(new Set),hn(new Set),Cn(new Set)},200)},[Sr,Yn,Zt]);At.useEffect(()=>{Tc()},[]),At.useEffect(()=>{if(!Fo.visible)return;const c=[];wn.size>0,wn.size===0&&Mn.size===0&&Ri.size===0&&ji.size===0&&c.push(`
No objects selected.`);const g=c.join(`
`);$r(A=>({...A,text:g}))},[Fo.visible,wn,Mn,Ri,ji,dt,Qt,en,fe,Re,pe]),At.useEffect(()=>{const c=g=>{const A=Ct.current;if(A&&!(g.target instanceof Node&&A.contains(g.target))){if(zu(),du){const L=fu.current;(!L||!(g.target instanceof Node)||!L.contains(g.target))&&nc(!1)}if(Uo){const L=Jl.current;!g.target?.closest('button[title="Color Picker"]')&&(!L||!(g.target instanceof Node)||!L.contains(g.target))&&ga(!1)}}};return document.addEventListener("mousedown",c,!0),()=>document.removeEventListener("mousedown",c,!0)},[zu,du,rd,Uo]);const _u=c=>{if(!c.current)return{top:0,left:0};const g=c.current.getBoundingClientRect(),A=Rc.current?.getBoundingClientRect();return A?{top:g.top-A.top,left:g.left-A.left+g.width+4}:{top:0,left:0}},xu=I.useCallback(()=>{fu.current&&Pu.current&&requestAnimationFrame(()=>{if(fu.current&&Pu.current){const c=_u(Pu);fu.current.style.top=`${c.top}px`,fu.current.style.left=`${c.left}px`}})},[]),ic=I.useCallback(()=>{ku.current&&jo.current&&requestAnimationFrame(()=>{if(ku.current&&jo.current){const c=_u(jo);ku.current.style.top=`${c.top}px`,ku.current.style.left=`${c.left}px`}})},[]),Od=I.useCallback(()=>{hu.current&&aa.current&&requestAnimationFrame(()=>{if(hu.current&&aa.current){const c=_u(aa);hu.current.style.top=`${c.top}px`,hu.current.style.left=`${c.left}px`}})},[]);At.useEffect(()=>{du&&xu()},[du,xu]),At.useEffect(()=>{rd&&ic()},[rd,ic]),At.useEffect(()=>{jd&&Od()},[jd,Od]),At.useEffect(()=>{if(xn&&Au.current&&Pd.current){const c=_u(Pd);Au.current.style.top=`${c.top}px`,Au.current.style.left=`${c.left}px`}},[xn]),At.useEffect(()=>{if(Wo&&od.current&&zd.current){const c=_u(zd);od.current.style.top=`${c.top}px`,od.current.style.left=`${c.left}px`}},[Wo]),At.useEffect(()=>{const c=g=>{if(!fo)return;const A=document.querySelector("[data-component-editor-dialog]");if(A&&g.target instanceof Node&&A.contains(g.target)){const Oe=g.target;if(Oe.tagName==="BUTTON"||Oe.tagName==="INPUT"||Oe.closest("button")||Oe.closest("input"))return}const L=Ct.current;if(!L)return;const K=L.getBoundingClientRect(),oe=g.clientX,z=g.clientY;if(oe<K.left||oe>K.right||z<K.top||z>K.bottom)return;const Ae=L.width/K.width,Se=L.height/K.height,_e=oe-K.left,Pe=z-K.top,ke=_e*Ae,me=Pe*Se,be=ke-5,ye=me-5,Ce=Gf(be,ye,Kn,xt,ui,ut),Ue=Ce.x,Le=Ce.y;let Ze=1/0,bt=null,jt=null;const It=Math.max(6/xt,4),Vt=[...Qt,...en].find(Oe=>Oe.id===fo.componentId)?.layer||"top";for(const Oe of dt)if((Oe.type==="via"||Oe.type==="pad")&&Oe.points.length>0){if(Oe.type==="pad"&&(Oe.layer||"top")!==Vt)continue;const qe=Oe.points[0],We=Math.max(1,Oe.size/2),ot=Math.hypot(qe.x-Ue,qe.y-Le),ct=Math.max(We,It);ot<=ct&&ot<Ze&&(Ze=ot,bt=qe.id??null,jt=Oe)}if(bt!=null&&jt){console.log(`
[PIN CONNECTION - DOCUMENT HANDLER] Found via!`),console.log(`  Point ID: ${bt}`),console.log(`  Connecting pin ${fo.pinIndex+1} of component ${fo.componentId}`);const Oe=String(bt),qe=fo.pinIndex,We=fo.componentId,ot=Qt.find(Lt=>Lt.id===We),ct=en.find(Lt=>Lt.id===We);if(ot){const Lt=dt;oi(Kt=>{const sn=Kt.find(Ht=>Ht.id===We);if(!sn)return Kt;const Hn=sn.pinConnections||[],vn=Hn.length>0?[...Hn]:new Array(sn.pinCount).fill("");let Xn;if(vn.length!==sn.pinCount){Xn=new Array(sn.pinCount).fill("");for(let Ht=0;Ht<Math.min(vn.length,sn.pinCount);Ht++)Xn[Ht]=vn[Ht]||""}else Xn=[...vn];Xn[qe]=Oe,console.log(`Updated pin ${qe} with value: ${Oe}`),console.log("New pinConnections:",Xn);const Wn=Kt.find(Ht=>Ht.id===We),Rn=Wn?Yg(Wn,Xn,Lt):null;return Kt.map(Ht=>{if(Ht.id===We){const In={...Ht,pinConnections:Xn};return Rn&&(In.pinPolarities=Rn),In}return Ht})})}else if(ct){const Lt=dt;Ni(Kt=>{const sn=Kt.find(Ht=>Ht.id===We);if(!sn)return Kt;const Hn=sn.pinConnections||[],vn=Hn.length>0?[...Hn]:new Array(sn.pinCount).fill("");let Xn;if(vn.length!==sn.pinCount){Xn=new Array(sn.pinCount).fill("");for(let Ht=0;Ht<Math.min(vn.length,sn.pinCount);Ht++)Xn[Ht]=vn[Ht]||""}else Xn=[...vn];Xn[qe]=Oe,console.log(`Updated pin ${qe} with value: ${Oe}`),console.log("New pinConnections:",Xn);const Wn=Kt.find(Ht=>Ht.id===We),Rn=Wn?Yg(Wn,Xn,Lt):null;return Kt.map(Ht=>{if(Ht.id===We){const In={...Ht,pinConnections:Xn};return Rn&&(In.pinPolarities=Rn),In}return Ht})})}setTimeout(()=>{Aa(null)},0)}else console.log("[PIN CONNECTION - DOCUMENT HANDLER] No via found at click location")};if(fo)return document.addEventListener("mousedown",c,!0),()=>document.removeEventListener("mousedown",c,!0)},[fo,Qt,en,dt,xt,Kn.x,Kn.y,ui,ut]);const ls=I.useCallback((c,g,A,L)=>{const K=window.innerWidth,oe=window.innerHeight,z=10;let Ae=Math.max(z,Math.min(c,K-A-z)),Se=Math.max(z,Math.min(g,oe-L-z));return{x:Ae,y:Se}},[]);At.useEffect(()=>{if(!Ys)return;const c=A=>{if(!gs)return;const L={x:A.clientX-gs.x,y:A.clientY-gs.y},K=ls(L.x,L.y,250,window.innerHeight*.4);Qa(K),localStorage.setItem("componentDialogPosition",JSON.stringify(K))},g=()=>{nu(!1),iu(null)};return document.addEventListener("mousemove",c),document.addEventListener("mouseup",g),()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",g)}},[Ys,gs,ls]),At.useEffect(()=>{if(!Dn)return;const c=A=>{if(!wa)return;const L={x:A.clientX-wa.x,y:A.clientY-wa.y},K=ls(L.x,L.y,250,window.innerHeight*.4);An(K),localStorage.setItem("detailedInfoDialogPosition",JSON.stringify(K))},g=()=>{Zi(!1),Ts(null)};return document.addEventListener("mousemove",c),document.addEventListener("mouseup",g),()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",g)}},[Dn,wa,ls]),At.useEffect(()=>{if(!Mc)return;const c=A=>{if(!Bc)return;const L={x:A.clientX-Bc.x,y:A.clientY-Bc.y};Qs(L),localStorage.setItem("notesDialogPosition",JSON.stringify(L))},g=()=>{Ir(!1),Nu(null)};return document.addEventListener("mousemove",c),document.addEventListener("mouseup",g),()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",g)}},[Mc,Bc]),At.useEffect(()=>{if(Sa&&Cs===null){const c=localStorage.getItem("notesDialogPosition");if(c)try{const g=JSON.parse(c);Qs(g)}catch{Qs({x:window.innerWidth-550,y:100})}else Qs({x:window.innerWidth-550,y:100})}},[Sa,Cs]),At.useEffect(()=>{if(!hc)return;const c=A=>{if(!_l)return;const L={x:A.clientX-_l.x,y:A.clientY-_l.y};Or(L),localStorage.setItem("projectNotesDialogPosition",JSON.stringify(L))},g=()=>{xl(!1),Dl(null)};return document.addEventListener("mousemove",c),document.addEventListener("mouseup",g),()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",g)}},[hc,_l]),At.useEffect(()=>{if(!Oc)return;const c=A=>{if(!Fc)return;const L={x:A.clientX-Fc.x,y:A.clientY-Fc.y};ec(L),localStorage.setItem("testPointsDialogPosition",JSON.stringify(L))},g=()=>{nl(!1),uu(null)};return document.addEventListener("mousemove",c),document.addEventListener("mouseup",g),()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",g)}},[Oc,Fc]),At.useEffect(()=>{if(Is&&tl===null){const c=localStorage.getItem("testPointsDialogPosition");if(c)try{const g=JSON.parse(c);ec(g)}catch{ec({x:100,y:100})}else ec({x:100,y:100})}},[Is,tl]),At.useEffect(()=>{if(lu&&so===null){const c=localStorage.getItem("projectNotesDialogPosition");if(c)try{const g=JSON.parse(c);Or(g)}catch{Or({x:100,y:100})}else Or({x:100,y:100})}},[lu,so]);const Du=I.useCallback(()=>{el(!0)},[]),Fl=I.useCallback(()=>{cu(!0)},[]);At.useEffect(()=>{if(Ua&&Ua.visible&&hs===null){const c=localStorage.getItem("componentDialogPosition");let g;if(c)try{const A=JSON.parse(c);g=ls(A.x,A.y,250,window.innerHeight*.4),Qa(g)}catch{g=ls(window.innerWidth-280,90,250,window.innerHeight*.4),Qa(g)}else g=ls(window.innerWidth-280,90,250,window.innerHeight*.4),Qa(g)}else!Ua||Ua.visible},[Ua,hs,ls]),At.useEffect(()=>{if(Fo.visible&&Ki===null){const c=localStorage.getItem("detailedInfoDialogPosition");let g;if(c)try{const A=JSON.parse(c);g=ls(A.x,A.y,400,window.innerHeight*.8),An(g)}catch{g=ls(window.innerWidth-450,90,400,window.innerHeight*.8),An(g)}else g=ls(window.innerWidth-450,90,400,window.innerHeight*.8),An(g)}else Fo.visible},[Fo.visible,Ki,ls]),At.useEffect(()=>{const c=()=>{if(hs){const g=ls(hs.x,hs.y,250,window.innerHeight*.4);(g.x!==hs.x||g.y!==hs.y)&&(Qa(g),localStorage.setItem("componentDialogPosition",JSON.stringify(g)))}if(Ki){const g=ls(Ki.x,Ki.y,400,window.innerHeight*.8);(g.x!==Ki.x||g.y!==Ki.y)&&(An(g),localStorage.setItem("detailedInfoDialogPosition",JSON.stringify(g)))}};return window.addEventListener("resize",c),()=>window.removeEventListener("resize",c)},[hs,Ki,ls]);const Cp=I.useCallback(c=>{switch(c){case"transparency":m(50);break;case"brushSize":W(3);break}},[]),Fd=At.useRef(M);At.useEffect(()=>{Fd.current=M},[M]),At.useEffect(()=>{if(j){bs.current=performance.now(),m(0);const c=g=>{const A=bs.current||g,L=Fd.current,K=(g-A)%L/L,oe=1-Math.abs(1-2*K);m(Math.round(oe*100)),Al.current=requestAnimationFrame(c)};Al.current=requestAnimationFrame(c)}return()=>{Al.current&&(cancelAnimationFrame(Al.current),Al.current=null)}},[j]),At.useEffect(()=>{if(k==="center"){Di(O2());return}const c=k==="erase"?"erase":k==="magnify"?"magnify":k==="ground"?"ground":k==="power"?"power":k==="component"?"component":k==="draw"?Ge==="via"?"via":Ge==="pad"?"pad":Ge==="testPoint"?"testPoint":"trace":"default";if(c==="default"){Di(void 0);return}const g=xt;let A;if(c==="magnify")A=18;else if(c==="component"){const me=(Ei||"top")==="top"?"componentTop":"componentBottom",ye=Ln.get(me).size||l0.DEFAULT_SIZE;A=Math.max(16,Math.round(ye*g))}else if(c==="trace"){const me=(_n||"top")==="top"?"traceTop":"traceBottom",ye=Ln.get(me).size||6;A=Math.max(6,Math.round(ye*g))}else if(c==="via"){const me=Ln.get("via").size||6;A=Math.max(6,Math.round(me*g))}else if(c==="pad"){const me=(qn||"top")==="top"?"padTop":"padBottom",ye=Ln.get(me).size||6;A=Math.max(6,Math.round(ye*g))}else if(c==="testPoint"){const me=(gi||"top")==="top"?"testPointTop":"testPointBottom",ye=Ln.get(me).size||18;A=Math.max(12,Math.round(ye*g))}else c==="power"||c==="ground"?A=Math.max(12,Math.round(O*g)):A=Math.max(6,Math.round(O*g));const K=A+4*2+(c==="magnify"?8:0),oe=document.createElement("canvas");oe.width=K,oe.height=K;const z=oe.getContext("2d");if(!z){Di(void 0);return}const Ae=K/2,Se=K/2,_e=A/2;if(z.clearRect(0,0,K,K),c==="via"){const ke=_e,me=_e*.5,be=_e*.7,Ce=Ln.get("via").color;z.fillStyle=Ce,z.beginPath(),z.arc(Ae,Se,ke,0,Xa),z.arc(Ae,Se,me,0,Xa),z.fill("evenodd"),z.strokeStyle="#808080",z.lineWidth=1,z.beginPath(),z.moveTo(Ae-be,Se),z.lineTo(Ae+be,Se),z.stroke(),z.beginPath(),z.moveTo(Ae,Se-be),z.lineTo(Ae,Se+be),z.stroke()}else if(c==="pad"){const ke=qn==="top"?"padTop":"padBottom",be=Ln.get(ke).color,Ce=A/2,Ue=Ce*2,Le=Ue*.5,Ze=Ce*.7;z.fillStyle=be,z.beginPath(),z.rect(Ae-Ce,Se-Ce,Ue,Ue),z.rect(Ae-Le/2,Se-Le/2,Le,Le),z.fill("evenodd"),z.strokeStyle="#808080",z.lineWidth=1,z.beginPath(),z.moveTo(Ae-Ze,Se),z.lineTo(Ae+Ze,Se),z.stroke(),z.beginPath(),z.moveTo(Ae,Se-Ze),z.lineTo(Ae,Se+Ze),z.stroke()}else if(c==="trace"){const ke=_n==="top"?"traceTop":"traceBottom",be=Ln.get(ke).color;z.fillStyle=be,z.beginPath(),z.arc(Ae,Se,_e,0,Xa),z.fill()}else if(c==="testPoint"){Di(F2(A));return}else if(c==="erase"){const ke=O*g,me=Math.max(ke*.75,8),be=Math.max(ke*.5,6),ye=Math.max(ke*.2,2);z.save(),z.translate(Ae,Se),z.rotate(Cu(-35)),z.fillStyle="#f5a3b3",z.strokeStyle="#111",z.lineWidth=1.5;const Ce=1.5,Ue=-me/2,Le=-be/2;z.beginPath(),z.moveTo(Ue+Ce,Le),z.lineTo(Ue+me-Ce,Le),z.quadraticCurveTo(Ue+me,Le,Ue+me,Le+Ce),z.lineTo(Ue+me,Le+be-Ce),z.quadraticCurveTo(Ue+me,Le+be,Ue+me-Ce,Le+be),z.lineTo(Ue+Ce,Le+be),z.quadraticCurveTo(Ue,Le+be,Ue,Le+be-Ce),z.lineTo(Ue,Le+Ce),z.quadraticCurveTo(Ue,Le,Ue+Ce,Le),z.closePath(),z.fill(),z.stroke(),z.fillStyle="#f18ea4",z.beginPath(),z.rect(-me/2,be/2-ye,me,ye),z.fill(),z.restore()}else if(c==="magnify"){const ke=_e;z.strokeStyle="#111",z.lineWidth=2,z.beginPath(),z.arc(Ae-2,Se-2,ke,0,Xa),z.stroke();const me=Ae+ke*.6,be=Se+ke*.6,ye=me+6,Ce=be+6;z.beginPath(),z.moveTo(me,be),z.lineTo(ye,Ce),z.stroke(),z.beginPath(),z.moveTo(Ae-6,Se-2),z.lineTo(Ae+2,Se-2),z.stroke(),Da||(z.beginPath(),z.moveTo(Ae-2,Se-6),z.lineTo(Ae-2,Se+2),z.stroke())}else if(c==="ground"){const me=(nr?Ve.find(ye=>ye.id===nr):null)?.color||"#000000";if(z.strokeStyle=me,z.lineWidth=2,z.lineCap="round",nr==="groundbus-earth"){const ye=_e*1.5,Ce=ye*.9,Ue=ye*.24,Le=ye*1.6;z.beginPath(),z.moveTo(Ae,Se-Ce/2),z.lineTo(Ae,Se+Ce/2),z.stroke();for(let Ze=0;Ze<3;Ze++){const bt=Se+Ce/2+Ze*Ue,jt=Le*(1-Ze*.25);z.beginPath(),z.moveTo(Ae-jt/2,bt),z.lineTo(Ae+jt/2,bt),z.stroke()}}else{const ye=_e*.8;z.beginPath(),z.arc(Ae,Se,_e,0,Xa),z.stroke(),z.beginPath(),z.moveTo(Ae,Se-_e-ye),z.lineTo(Ae,Se+_e+ye),z.stroke(),z.beginPath(),z.moveTo(Ae-_e-ye,Se),z.lineTo(Ae+_e+ye,Se),z.stroke()}}else if(c==="power"){const me=(Fi?pe.find(ye=>ye.id===Fi):null)?.color||"#ff0000";z.strokeStyle=me,z.lineWidth=2,z.lineCap="round";const be=_e*.8;z.beginPath(),z.arc(Ae,Se,_e,0,Xa),z.stroke(),z.beginPath(),z.moveTo(Ae,Se-_e-be),z.lineTo(Ae,Se+_e+be),z.stroke(),z.beginPath(),z.moveTo(Ae-_e-be,Se),z.lineTo(Ae+_e+be,Se),z.stroke()}else if(c==="component"){const me=(Ei||"top")==="top"?"componentTop":"componentBottom",ye=Ln.get(me).color,Ce=A,Ue=Ce/2;z.strokeStyle=ye,z.lineWidth=2,z.fillStyle="rgba(255,255,255,0.9)",z.beginPath(),z.rect(Ae-Ue,Se-Ue,Ce,Ce),z.fill(),z.stroke();const Le=(()=>{const Ze=bc?.dataDrivenDefinition?.designator??bc?.componentDefinition?.designator??bc?.designator;return Ze?Ze.length<=3?Ze:Ze.substring(0,3):Ml?qg(Ml):"?"})();z.fillStyle=ye,z.font=`bold ${Math.max(8,Ce*.35)}px sans-serif`,z.textAlign="center",z.textBaseline="middle",z.fillText(Le,Ae,Se)}const Pe=`url(${oe.toDataURL()}) ${Math.round(Ae)} ${Math.round(Se)}, crosshair`;Di(Pe)},[k,Ge,G,O,xt,Da,Ml,bc,Fi,nr,pe,Ve,yi,_n,qn,gi,Ei,_r.toolInstanceId]),At.useEffect(()=>{gu()},[gu]),At.useEffect(()=>{gu()},[ws.width,ws.height]),At.useEffect(()=>{wn.size===0&&k==="draw"&&Ge==="trace"&&O>=1&&(Tt==="top"?ee(O):Ne(O))},[O,k,Ge,Tt,wn]),At.useEffect(()=>{Mt(c=>c.map(g=>{if(g.type==="via"&&g.points.length>0&&g.points[0].id!==void 0){const A=g.points[0].id,L=vl(A,pe);if(g.viaType!==L)return{...g,viaType:L}}else if(g.type==="pad"&&g.points.length>0&&g.points[0].id!==void 0){const A=g.points[0].id,L=tc(A,pe);if(g.padType!==L)return{...g,padType:L}}else if(g.type==="testPoint"&&g.points.length>0&&g.points[0].id!==void 0){const A=g.points[0].id,L=Il(A,pe),K=L.includes("Power")?"power":L.includes("Ground")?"ground":L.includes("Signal")?"signal":"unknown";if(g.testPointType!==K)return{...g,testPointType:K}}return g}))},[fe,Re,pe,vl,tc,Il]);const jp=I.useCallback(()=>{const c=Ct.current;if(!c)return;const g=c.toDataURL("image/png"),A=window.open("","_blank");if(!A){alert("Please allow popups to print the canvas.");return}A.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>PCB Drawing</title>
          <style>
            @media print {
              @page {
                margin: 0;
                size: auto;
              }
              body {
                margin: 0;
                padding: 0;
              }
            }
            body {
              margin: 0;
              padding: 20px;
              display: flex;
              justify-content: center;
              align-items: center;
              background: white;
            }
            img {
              max-width: 100%;
              height: auto;
              display: block;
            }
          </style>
        </head>
        <body>
          <img src="${g}" alt="PCB Drawing" onload="window.setTimeout(function() { window.print(); }, 250);" />
        </body>
      </html>
    `),A.document.close()},[]);At.useEffect(()=>{const c=A=>{A.key==="Shift"&&au(!0)},g=A=>{A.key==="Shift"&&au(!1)};return window.addEventListener("keydown",c),window.addEventListener("keyup",g),()=>{window.removeEventListener("keydown",c),window.removeEventListener("keyup",g)}},[]);const Ud=I.useCallback(c=>{if(c.size===0)return;const g=Array.from(c).map(A=>String(A));Mt(A=>A.map(L=>{if(L.type==="trace"){const K=L.points.filter(oe=>oe.id===void 0?!0:!c.has(oe.id));return K.length<2?null:{...L,points:K}}return L}).filter(L=>L!==null)),oi(A=>A.map(L=>{const K=L.pinConnections||[];if(K.some(z=>z&&g.includes(z))){const z=K.map(Ae=>Ae&&g.includes(Ae)?"":Ae);return{...L,pinConnections:z}}return L})),Ni(A=>A.map(L=>{const K=L.pinConnections||[];if(K.some(z=>z&&g.includes(z))){const z=K.map(Ae=>Ae&&g.includes(Ae)?"":Ae);return{...L,pinConnections:z}}return L}))},[Mt,oi,Ni]),Ed=I.useRef(new Set);At.useEffect(()=>{const c=new Set;for(const A of dt)if((A.type==="via"||A.type==="pad")&&A.points.length>0){const L=A.points[0].id;L!==void 0&&c.add(L)}const g=new Set;for(const A of Ed.current)c.has(A)||g.add(A);g.size>0&&Ud(g),Ed.current=c},[dt,Ud]),At.useEffect(()=>{Mt(c=>c.map(g=>{if(g.type==="via"&&g.points.length>0&&g.points[0].id!==void 0){const A=g.points[0].id,L=vl(A,pe);if(g.viaType!==L)return{...g,viaType:L}}else if(g.type==="pad"&&g.points.length>0&&g.points[0].id!==void 0){const A=g.points[0].id,L=tc(A,pe);if(g.padType!==L)return{...g,padType:L}}else if(g.type==="testPoint"&&g.points.length>0&&g.points[0].id!==void 0){const A=g.points[0].id,L=Il(A,pe),K=L.includes("Power")?"power":L.includes("Ground")?"ground":L.includes("Signal")?"signal":"unknown";if(g.testPointType!==K)return{...g,testPointType:K}}return g}))},[fe,Re,pe,vl,tc,Il]),At.useEffect(()=>{const c=g=>{yl.current&&(yl.current.contains(g.target)||_s(null))};return document.addEventListener("click",c),()=>document.removeEventListener("click",c)},[]),At.useEffect(()=>{const c=(g,A)=>{const L=g.current;if(!L)return;const K=L.getContext("2d");if(!K)return;const oe=L.width,z=L.height;if(K.clearRect(0,0,oe,z),K.fillStyle="#fff",K.fillRect(0,0,oe,z),A?.bitmap){const Ae=A.bitmap,Se=Math.min(oe/Ae.width,z/Ae.height),_e=Math.max(1,Math.floor(Ae.width*Se)),Pe=Math.max(1,Math.floor(Ae.height*Se)),ke=Math.floor((oe-_e)/2),me=Math.floor((z-Pe)/2);K.drawImage(Ae,ke,me,_e,Pe)}K.strokeStyle="#ddd",K.lineWidth=1,K.strokeRect(.5,.5,oe-1,z-1)};c(Ss,o),c(pc,l)},[o,l]),At.useEffect(()=>{const c=[],g=[],A=[],L=[];for(const K of dt)if(K.type==="via"&&K.points.length>=1){const oe=K.points[0],z={id:K.id,pointId:oe.id,x:oe.x,y:oe.y,size:K.size,color:K.color};c.push(z)}else if(K.type==="pad"&&K.points.length>=1){const oe=K.points[0],z={id:K.id,pointId:oe.id,x:oe.x,y:oe.y,size:K.size,color:K.color,layer:K.layer||"top"};g.push(z)}else if(K.type==="trace"&&K.points.length>=2)for(let oe=0;oe<K.points.length-1;oe++){const z=K.points[oe],Ae=K.points[oe+1],Se={id:K.id,startPointId:z.id,endPointId:Ae.id,x1:z.x,y1:z.y,x2:Ae.x,y2:Ae.y,size:K.size,color:K.color};K.layer==="top"?A.push(Se):L.push(Se)}Ko(c),jr(g),Oa(A),kn(L)},[dt]);const mu=I.useRef(dt);mu.current=dt;const rc=I.useCallback(()=>{const g=new Date().toISOString(),A=z1();return{project:{version:1,fileType:"PCB_REVERSE_ENGINEERING_AUTOSAVE",savedAt:g,view:{currentView:b,viewScale:xt,cameraWorldCenter:En,showBothLayers:mr,selectedDrawingLayer:Tt},images:{top:o?{name:o.name,width:o.width,height:o.height,filePath:o.filePath||o.name,x:o.x,y:o.y,scale:o.scale,rotation:o.rotation,flipX:o.flipX,flipY:o.flipY,skewX:o.skewX,skewY:o.skewY,keystoneV:o.keystoneV,keystoneH:o.keystoneH,brightness:o.brightness??100,contrast:o.contrast??100}:null,bottom:l?{name:l.name,width:l.width,height:l.height,filePath:l.filePath||l.name,x:l.x,y:l.y,scale:l.scale,rotation:l.rotation,flipX:l.flipX,flipY:l.flipY,skewX:l.skewX,skewY:l.skewY,keystoneV:l.keystoneV,keystoneH:l.keystoneH,brightness:l.brightness??100,contrast:l.contrast??100}:null},projectDirectoryName:na.current?na.current.name||null:ai&&ai.name||null,drawing:{drawingStrokes:mu.current.filter(K=>!(K.type==="trace"&&K.points.length<2)),vias:ka,tracesTop:ps,tracesBottom:$s,componentsTop:Qt,componentsBottom:en,grounds:Re,powers:fe},powerBuses:pe,groundBuses:Ve,pointIdCounter:mg(),designatorCounters:{...Oi.current},autoAssignDesignators:Er,useGlobalDesignatorCounters:ki,traceColors:{top:yi.get("trace")?.layerSettings.get("top")?.color||Y,bottom:yi.get("trace")?.layerSettings.get("bottom")?.color||J},traceSizes:{top:yi.get("trace")?.layerSettings.get("top")?.size||je,bottom:yi.get("trace")?.layerSettings.get("bottom")?.size||de},padColors:{top:yi.get("pad")?.layerSettings.get("top")?.color||Ie,bottom:yi.get("pad")?.layerSettings.get("bottom")?.color||q},padSizes:{top:yi.get("pad")?.layerSettings.get("top")?.size||V,bottom:yi.get("pad")?.layerSettings.get("bottom")?.size||ue},componentColors:{top:yi.get("component")?.layerSettings.get("top")?.color||ge,bottom:yi.get("component")?.layerSettings.get("bottom")?.color||_t},componentSizes:{top:yi.get("component")?.layerSettings.get("top")?.size||ht,bottom:yi.get("component")?.layerSettings.get("bottom")?.size||Yt},testPointColors:{top:yi.get("testPoint")?.layerSettings.get("top")?.color||se,bottom:yi.get("testPoint")?.layerSettings.get("bottom")?.color||xe},testPointSizes:{top:yi.get("testPoint")?.layerSettings.get("top")?.size||Ye,bottom:yi.get("testPoint")?.layerSettings.get("bottom")?.size||St},componentConnectionColor:cn,componentConnectionSize:mn,toolLayerDefaults:{trace:_n,pad:qn,testPoint:gi,component:Ei},toolSettings:{trace:yi.get("trace")?.settings||{color:"#ff0000",size:6},via:yi.get("via")?.settings||{color:"#ff0000",size:18},pad:yi.get("pad")?.settings||{color:"#ff0000",size:18},component:yi.get("component")?.settings||{color:"#ff0000",size:18},ground:yi.get("ground")?.settings||{color:"#000000",size:18},power:yi.get("power")?.settings||{color:"#ff0000",size:18},erase:yi.get("erase")?.settings||{color:"#f5a3b3",size:18}},locks:{areImagesLocked:ar,areViasLocked:Lr,arePadsLocked:pa,areTracesLocked:po,areComponentsLocked:er,areGroundNodesLocked:mo,arePowerNodesLocked:tr},visibility:{showViasLayer:ra,showTopPadsLayer:qo,showBottomPadsLayer:f,showTopTracesLayer:Ra,showBottomTracesLayer:Co,showTopComponents:re,showBottomComponents:he,showPowerLayer:Ee,showGroundLayer:ci,showConnectionsLayer:Pi,showTraceCornerDots:Kr},autoSave:{enabled:Ha,interval:kl,baseName:_o},projectInfo:{name:io},projectNotes:Ql,projectMetadata:Qu,homeViews:Pl,toolInstances:Ln.getAll()},timestamp:A}},[b,xt,En,mr,Tt,o,l,dt,ka,ps,$s,Qt,en,Re,yi,ar,Lr,pa,po,er,mo,tr,pe,Ve,mg,Y,J,je,de,Ie,q,V,ue,ge,_t,ht,Yt,_n,qn,gi,Ei,Ha,kl,_o,io,ra,qo,f,Ra,Co,re,he,Ee,ci,Pi,Er,ki,Ql,Qu,Pl]),Ul=I.useRef(rc);Ul.current=rc;const sa=I.useRef(sr);sa.current=sr;const Df={setProjectDirHandle:Mr,setAutoSaveDirHandle:wo,setCurrentProjectFilePath:sr,setProjectName:Do,setAutoSaveEnabled:go,setAutoSaveInterval:zo,setAutoSaveBaseName:no,setAutoSaveFileHistory:Wa,setCurrentFileIndex:Yr,setHasUnsavedChangesState:bo,setTopImage:s,setBottomImage:d,setDrawingStrokes:Mt,setCurrentStroke:et,setVias:Ko,setPads:jr,setTracesTop:Oa,setTracesBottom:kn,setComponentsTop:oi,setComponentsBottom:Ni,setComponentEditor:Ea,setConnectingPin:Aa,setPowerSymbols:$t,setGroundSymbols:rn,setPowerEditor:di,setPowerBuses:Be,setGroundBuses:gt,setSelectedIds:Tn,setSelectedComponentIds:yn,setSelectedPowerIds:hn,setSelectedGroundIds:Cn,setIsSelecting:Oo,setProjectNotes:La,setProjectMetadata:zl,setCurrentView:p,setViewScale:Yn,setCameraCenter:pr,setCameraWorldCenter:Zt,setShowBothLayers:mi,setSelectedDrawingLayer:tn,setHomeViews:vs,setIsWaitingForHomeViewKey:vr,setSelectedImageForTransform:Bi,setIsTransforming:nn,setTransformStartPos:hi,setTransformMode:zr,setIsBottomView:hr,setOriginalTopFlipX:gr,setOriginalBottomFlipX:rs,setIsGrayscale:P,setTransparency:m,setIsTransparencyCycling:_,setTransparencyCycleSpeed:T,setAreImagesLocked:da,setAreViasLocked:fa,setArePadsLocked:ys,setAreTestPointsLocked:Pa,setAreTracesLocked:ha,setAreComponentsLocked:za,setAreGroundNodesLocked:es,setArePowerNodesLocked:to,setShowTopImage:To,setShowBottomImage:qi,setShowViasLayer:ss,setShowTopTracesLayer:Hi,setShowBottomTracesLayer:oa,setShowTopPadsLayer:va,setShowBottomPadsLayer:x,setShowTopTestPointsLayer:R,setShowBottomTestPointsLayer:ie,setShowTopComponents:le,setShowBottomComponents:Te,setShowPowerLayer:Xe,setShowGroundLayer:Li,setShowConnectionsLayer:ur,setShowTraceCornerDots:ir,setCurrentTool:y,setDrawingMode:zt,setTraceToolLayer:ko,setPadToolLayer:us,setTestPointToolLayer:Mo,setComponentToolLayer:zs,setAutoAssignDesignators:si,setUseGlobalDesignatorCounters:lr,setOpenMenu:_s,setDebugDialog:$r,setErrorDialog:Qo,setNewProjectDialog:Va,setOpenProjectDialog:Kl,setNewProjectSetupDialog:xs,setSaveAsDialog:ea,setAutoSaveDialog:Po,setAutoSavePromptDialog:ho,setShowColorPicker:ga,setShowPowerBusManager:pt,setShowGroundBusManager:ei,setShowDesignatorManager:Xr,setShowBoardDimensionsDialog:Hc,setNotesDialogVisible:yr,setProjectNotesDialogVisible:el,setTransformImagesDialogVisible:Ks,setTransformAllDialogVisible:Eo,setBoardDimensions:ol,setHoverComponent:ma,setHoverTestPoint:ba,setIsPanning:$a,setIsDrawing:we,setTracePreviewMousePos:Rt,clearSnapshot:Rr,projectDirHandleRef:na,autoSaveDirHandleRef:br,autoSaveBaseNameRef:ro,autoSaveIntervalRef:Ii,hasChangesSinceLastAutoSaveRef:Ai,currentProjectFilePathRef:fl,autoSaveFileHistoryRef:oo,currentFileIndexRef:os,currentStrokeRef:Xt,sessionDesignatorCountersRef:Oi,traceToolLayerRef:Ka,padToolLayerRef:Za,testPointToolLayerRef:ds,componentToolLayerRef:Ur,homeViewTimeoutRef:On,panStartRef:So,panClientStartRef:Ro,lastTraceClickTimeRef:pn,isDoubleClickingTraceRef:ti},Np=I.useMemo(()=>rb(Df),[Mr,wo,sr,Do,go,zo,no,Wa,Yr,s,d,Mt,et,Ko,jr,Oa,kn,oi,Ni,Ea,Aa,$t,rn,di,Be,gt,Tn,yn,hn,Cn,Oo,La,zl,p,Yn,pr,Zt,mi,tn,vs,vr,Bi,nn,hi,zr,hr,gr,rs,P,m,_,T,da,fa,ys,Pa,ha,za,es,to,To,qi,ss,Hi,oa,va,x,R,ie,le,Te,Xe,Li,ur,ir,y,zt,ko,us,Mo,zs,si,lr,_s,$r,Qo,Va,xs,ea,Po,ho,Rr,ga,pt,ei,Xr,Hc,yr,el,Ks,Eo,ol,ma,ba,$a,we,Rt,na,br,ro,Ii,Ai,fl,oo,os,Xt,Oi,Ka,Za,ds,Ur,On,So,Ro,pn,ti]),Ta=I.useRef(Np),Vd=I.useCallback(()=>{Ta.current&&Ta.current()},[]),bu=I.useCallback(async()=>{await ob(Vd)},[Vd]),qd=I.useCallback(async()=>{const c=br.current||na.current,g=ro.current;!c||!g||await sb(c,g,Ai,mu,Mt,Ul.current,sr,fl,Wa,oo,Yr,os,bo,go,Ii)},[br,na,ro,Ai,mu,Mt,Ul,sr,fl,Wa,oo,Yr,os,bo,go,Ii]);as.current=qd;const Nr=I.useCallback(async()=>{const{project:c}=rc(),g=JSON.stringify(c,null,2),A=new Blob([g],{type:"application/json"});if(ai&&io)try{let _e=null;try{_e=await ai.getDirectoryHandle("history",{create:!0})}catch(Ue){console.error("Failed to get/create history directory:",Ue),_e=null}const Pe=io.replace(/\.json$/i,""),ke=yd(Pe),{timestamp:me}=rc(),be=`${ke}_${me}.json`;if(_e)try{const Ue=[];for await(const Le of ai.keys())try{if(Le==="history"||Le===be)continue;const bt=await(await ai.getFileHandle(Le)).getFile();if(!Le.endsWith(".json"))continue;const jt=await bt.text();try{JSON.parse(jt).version&&(Ue.push(Le),console.log(`Save: Found PCB project file in root: ${Le}`))}catch{continue}}catch{continue}for(const Le of Ue)try{const jt=await(await(await ai.getFileHandle(Le)).getFile()).text(),rt=await(await _e.getFileHandle(Le,{create:!0})).createWritable();await rt.write(new Blob([jt],{type:"application/json"})),await rt.close(),await ai.removeEntry(Le),console.log(`Save: Moved ${Le} from root to history/`)}catch(Ze){console.warn(`Save: Failed to move ${Le} to history:`,Ze)}}catch(Ue){console.warn("Save: Error checking for old files in root:",Ue)}const Ce=await(await ai.getFileHandle(be,{create:!0})).createWritable();await Ce.write(A),await Ce.close(),sr(be),bo(!1),Ai.current=!1,console.log(`Project saved successfully: ${io}/${be}`),alert(`Project saved successfully!

File: ${be}
Location: ${io}`);return}catch(_e){const Pe=_e instanceof Error?_e.message:String(_e);console.error("Failed to save to project directory:",_e),alert(`Failed to save project to directory.

Error: ${Pe}

Please try saving again or use Save As...`),Mr(null)}if(io&&!ai){const _e=window;if(typeof _e.showDirectoryPicker=="function")try{const Pe=await _e.showDirectoryPicker();Mr(Pe);const ke=`${io}.json`,be=await(await Pe.getFileHandle(ke,{create:!0})).createWritable();await be.write(A),await be.close(),sr(ke),bo(!1),Ai.current=!1,console.log(`Project saved successfully: ${ke} in selected directory`),alert(`Project saved successfully!

File: ${ke}`);return}catch(Pe){if(Pe?.name!=="AbortError"){const ke=Pe instanceof Error?Pe.message:String(Pe);console.error("Failed to get directory:",Pe),alert(`Failed to select directory.

Error: ${ke}

Falling back to file picker...`)}}}const L=_e=>String(_e).padStart(2,"0"),K=new Date,z=`pcb_project_${`${K.getFullYear()}_${L(K.getMonth()+1)}_${L(K.getDate())}_${L(K.getHours())}_${L(K.getMinutes())}_${L(K.getSeconds())}`}.json`,Ae=window;if(typeof Ae.showSaveFilePicker=="function")try{const _e=await Ae.showSaveFilePicker({suggestedName:z,types:[{description:"PCB Project",accept:{"application/json":[".json"]}}]}),Pe=await _e.createWritable();await Pe.write(A),await Pe.close();const ke=_e.name;try{const ye=await _e.getFile();sr(ye.name)}catch{sr(ke)}const be=ke.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_");be&&Do(be);try{const ye=_e.name.replace(/\.json$/i,""),Ue=yd(ye).replace(/[^a-zA-Z0-9_-]/g,"_");no(Ue),Rs||console.log("Auto save: Directory handle not set. Will prompt on first auto save.")}catch(ye){console.warn("Could not set up auto save for new file:",ye)}console.log(`Project saved successfully: ${ke}`),alert(`Project saved successfully!

File: ${ke}`);return}catch(_e){if(_e?.name==="AbortError")return;const Pe=_e instanceof Error?_e.message:String(_e);console.warn("showSaveFilePicker failed, falling back to download",_e),alert(`File picker unavailable.

Error: ${Pe}

Falling back to browser download...`)}const Se=document.createElement("a");Se.href=URL.createObjectURL(A),Se.download=z,document.body.appendChild(Se),Se.click(),setTimeout(()=>{URL.revokeObjectURL(Se.href),document.body.removeChild(Se)},0),console.log(`Project downloaded: ${z}`),alert(`Project downloaded successfully!

File: ${z}

Note: For better project management, use File  New Project or File  Open Project.`)},[rc,ai,io,sr,Mr,bo,Do,no,Rs,yd]),js=I.useCallback(c=>{const g=new Fn,A=g.internal.pageSize.getWidth(),L=g.internal.pageSize.getHeight(),K=20;let oe=K;const z=7,Ae=60;g.setFontSize(18),g.setFont("helvetica","bold"),g.text("Bill of Materials",A/2,oe,{align:"center"}),oe+=z*2,g.setFontSize(10),g.setFont("helvetica","normal"),c.projectName&&(g.text(`Project: ${c.projectName}`,K,oe),oe+=z),g.text(`Exported: ${new Date(c.exportedAt).toLocaleString()}`,K,oe),oe+=z,g.text(`Total Components: ${c.totalComponents} | Unique Components: ${c.uniqueComponents}`,K,oe),oe=Ae,g.setFontSize(9),g.setFont("helvetica","bold");const Se=[15,50,30,20,25,30,20],_e=["Qty","Component Type","Value","Package","Manufacturer","Part Number","Layer"];let Pe=K;return _e.forEach((me,be)=>{g.text(me,Pe,oe),Pe+=Se[be]}),oe+=z,g.setLineWidth(.5),g.line(K,oe,A-K,oe),oe+=z*.5,g.setFont("helvetica","normal"),g.setFontSize(8),c.items.forEach(me=>{const be=Ze=>{oe>L-K-z*Ze&&(g.addPage(),oe=K+z)};be(3),Pe=K,[me.quantity.toString(),me.componentType,me.value||"-",me.packageType||"-",me.manufacturer||"-",me.partNumber||"-",me.layer].forEach((Ze,bt)=>{const jt=Se[bt]-2,It=g.splitTextToSize(Ze,jt);g.text(It[0]||"-",Pe,oe),Pe+=Se[bt]}),oe+=z*1.2;const Ce=(me.notes||"").toString().trim(),Ue=me.datasheet?me.datasheet.toString().trim():"",Le=[];if(Ce&&Le.push(`Notes: ${Ce}`),Ue&&Le.push(`Spec Sheet URL: ${Ue}`),Le.length>0){const Ze=K+Se[0]+2,bt=A-K-Ze;Le.forEach(jt=>{g.splitTextToSize(jt,bt).forEach(rt=>{be(2),g.text(rt,Ze,oe),oe+=z*.9})})}be(1),g.setLineWidth(.2),g.line(K,oe,A-K,oe),oe+=z*.5}),g.output("blob")},[]),Cc=I.useCallback(async()=>{if(console.log("handleExportBOM called, format:",ae),!ai){alert("Please create or open a project before exporting BOM.");return}try{console.log("Generating BOM data...");const c=nb(Qt,en,io);console.log("BOM data generated:",c),console.log("Creating/getting BOM directory...");let g;try{g=await ai.getDirectoryHandle("BOM",{create:!0}),console.log("BOM directory obtained")}catch(Ae){console.error("Failed to get/create BOM directory:",Ae),alert("Failed to create BOM directory. See console for details.");return}const A=z1();let L,K;if(ae==="pdf")console.log("Generating PDF..."),L=js(c),K=`BOM_${A}.pdf`;else{console.log("Generating JSON...");const Ae=JSON.stringify(c,null,2);L=new Blob([Ae],{type:"application/json"}),K=`BOM_${A}.json`}console.log("Saving file:",K);const z=await(await g.getFileHandle(K,{create:!0})).createWritable();await z.write(L),await z.close(),console.log("BOM file saved successfully"),alert(`BOM exported successfully to ${K} in BOM directory!`)}catch(c){console.error("Failed to export BOM:",c),alert(`Failed to export BOM: ${c instanceof Error?c.message:String(c)}. See console for details.`)}},[ai,Qt,en,io,ae,js]),kp=I.useCallback(async c=>{if(!ai){alert("Please create or open a project before exporting netlist.");return}const g=c||U;try{const A=[...Qt,...en];let L,K,oe;g==="kicad"?(L=Z2(A,dt,fe,Re,pe),K="KiCad",oe=".net"):g==="protel"?(L=J2(A,dt,fe,Re,pe),K="Protel",oe=".net"):g==="spice"?(L=Q2(A,dt,fe,Re,pe),K="SPICE",oe=".cir"):(L=eb(A,dt,fe,Re,pe,Ve,io),K="PADS",oe=".json");const z=`${io}_${K}${oe}`,Ae=g==="pads"?"application/json":"text/plain",Se=new Blob([L],{type:Ae});try{const ke=await(await(await ai.getDirectoryHandle("netlists",{create:!0})).getFileHandle(z,{create:!0})).createWritable();await ke.write(Se),await ke.close(),alert(`Netlist exported successfully to netlists/${z}!`)}catch(_e){console.warn("File System Access API failed, using download fallback:",_e);const Pe=URL.createObjectURL(Se),ke=document.createElement("a");ke.href=Pe,ke.download=z,document.body.appendChild(ke),ke.click(),document.body.removeChild(ke),URL.revokeObjectURL(Pe),alert(`Netlist downloaded as ${z}!`)}}catch(A){console.error("Failed to export netlist:",A),alert(`Failed to export netlist: ${A instanceof Error?A.message:String(A)}. See console for details.`)}},[ai,Qt,en,dt,fe,Re,pe,io,U]);At.useEffect(()=>{Ii.current&&(clearInterval(Ii.current),Ii.current=null);const c=Dc.current;if(Dc.current=Ha,Ha&&kl){const g=kl*60*1e3;(Rs||ai)&&_o?(console.log(`Auto save: Setting up interval for ${kl} minute(s) (${g}ms)`),c||(Ai.current=!0,setTimeout(()=>{qd()},100)),Ii.current&&(clearInterval(Ii.current),Ii.current=null),Ii.current=window.setInterval(()=>{console.log("Auto save: Interval triggered, calling performAutoSave..."),console.log(`  - hasChangesSinceLastAutoSave: ${Ai.current}`),console.log(`  - dirHandle: ${br.current?"set":"missing"}`),console.log(`  - baseName: ${ro.current||"missing"}`),qd()},g),console.log(`Auto save: Interval set up for ${g}ms (${kl} minutes)`),console.log(`  - Auto save directory handle: ${Rs?"set":"missing"}`),console.log(`  - Project directory handle: ${ai?"set":"missing"}`),console.log(`  - Base name: ${_o||"missing"}`)):(console.warn(`Auto save: Cannot set up interval - missing directory handle (autoSaveDirHandle: ${!!Rs}, projectDirHandle: ${!!ai}) or base name (${!_o}). Disabling auto save.`),go(!1),Ii.current&&(clearInterval(Ii.current),Ii.current=null))}else Ha||(Dc.current=!1);return()=>{Ii.current&&(clearInterval(Ii.current),Ii.current=null)}},[Ha,kl,Rs,_o,ai]);const ld=I.useRef(!1),cd=I.useRef(!1),[_h,Hd]=At.useState(0);At.useEffect(()=>{const g=Object.keys(Ln.getAll()).map(A=>Ln.subscribe(A,()=>{Hd(L=>L+1)}));return()=>g.forEach(A=>A())},[]),At.useEffect(()=>{if(cd.current){console.log("Change tracking: Skipping - project is being loaded");return}if(Ha&&ld.current){ld.current=!1,console.log("Auto save: Skipping change tracking on first run after enable (initial save handled separately)");return}Ai.current=!0,bo(!0),console.log("Change detected, marking as unsaved",{autoSaveEnabled:Ha,topImage:!!o,bottomImage:!!l,drawingStrokesCount:dt.length,componentsTopCount:Qt.length,componentsBottomCount:en.length,powersCount:fe.length,groundsCount:Re.length,powerBusesCount:pe.length,projectNotesCount:Ql.length,areImagesLocked:ar,areViasLocked:Lr,areTracesLocked:po,areComponentsLocked:er,areGroundNodesLocked:mo,arePowerNodesLocked:tr})},[o,l,dt,Qt,en,fe,Re,pe,Ql,Y,J,je,de,ar,Lr,po,er,mo,tr,Ve,Ha,Ie,q,V,ue,ge,_t,ht,Yt,se,xe,Ye,St,cn,mn,_n,Er,ki,Pl,yi,_h]),At.useEffect(()=>{Ha?(ld.current=!0,console.log("Auto save: Enabled, marking first run")):ld.current=!1},[Ha]),At.useEffect(()=>{Ha||(Ai.current=!1)},[Ha]);const Ma=I.useCallback(()=>!!(o||l||dt.length>0||Qt.length>0||en.length>0||fe.length>0||Re.length>0),[o,l,dt,Qt,en,fe,Re]),Ns=I.useCallback(()=>{xs({visible:!0,projectName:"",locationPath:"",locationHandle:null})},[]),Ap=I.useCallback(async()=>{const c=window;if(typeof c.showDirectoryPicker=="function")try{const g=await c.showDirectoryPicker({mode:"readwrite"});xs(A=>({...A,locationHandle:g,locationPath:g.name||"Selected folder"}))}catch(g){g?.name!=="AbortError"&&(console.error("Failed to get directory:",g),alert("Failed to select location directory."))}else alert("Directory picker is not supported in this browser. Please use a modern browser like Chrome or Edge.")},[]),ks=I.useCallback(async()=>{const c=Zn.projectName.trim();if(!c){alert("Please enter a project name.");return}if(!Zn.locationHandle){alert("Please select a location for the project.");return}const g=await ab(c,Zn.locationHandle,bu,Do,Mr,sr,na,rc,Sr,Vn,hr,m,async(A,L,K,oe)=>{await nf(A,L,K,go,zo,wo,no,br,ro,Ii,Ai,Po,ho,Mr,as,oe)});if(!g.success){g.error&&alert(g.error);return}xs({visible:!1,projectName:"",locationPath:"",locationHandle:null}),console.log(`New project created successfully: ${g.projectName}/${g.projectFileName}`)},[Zn,bu,Do,Mr,sr,na,rc,Sr,Vn,hr,m,io,ai,go,zo,wo,no,br,ro,Ii,Ai,Po,ho,as]),Wd=I.useCallback(()=>{xs({visible:!1,projectName:"",locationPath:"",locationHandle:null})},[]),jc=I.useCallback(async()=>{const c=window;if(typeof c.showDirectoryPicker=="function")try{const g=await c.showDirectoryPicker();ea(A=>({...A,locationHandle:g,locationPath:g.name||"Selected folder"}))}catch(g){g?.name!=="AbortError"&&(console.error("Failed to get directory:",g),alert("Failed to select location directory."))}else alert("Directory picker is not supported in this browser. Please use a modern browser that supports the File System Access API.")},[]),$c=I.useCallback(async()=>{const c=Gi.filename.trim();if(!c){alert("Please enter a file name.");return}const A=(c.endsWith(".json")?c:`${c}.json`).replace(/[^a-zA-Z0-9_.-]/g,"_");if(!Gi.locationHandle){alert("Please select a location for the file.");return}const L=Gi.locationHandle;try{const{project:K}=rc(),oe=JSON.stringify(K,null,2),z=new Blob([oe],{type:"application/json"}),Se=await(await L.getFileHandle(A,{create:!0})).createWritable();await Se.write(z),await Se.close(),sr(A);const _e=A.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_");_e&&Do(_e),Mr(L),bo(!1),Ai.current=!1,ea({visible:!1,filename:"",locationPath:"",locationHandle:null}),_s(null),console.log(`Project saved as: ${A} in selected directory`)}catch(K){console.error("Failed to save project:",K),alert(`Failed to save project file "${A}". See console for details.`)}},[Gi,rc]),El=I.useCallback(()=>{ea({visible:!1,filename:"",locationPath:"",locationHandle:null})},[]),ud=I.useCallback(async()=>{Va({visible:!1}),await Nr(),Ns(),Tc()},[Nr,Ns,Tc]),Rf=I.useCallback(()=>{Va({visible:!1}),Ns(),Tc()},[Ns,Tc]),Vl=I.useCallback(()=>{Va({visible:!1})},[]);At.useEffect(()=>{if(Xs.visible){setTimeout(()=>{su.current?.focus()},0);const c=g=>{g.key==="Enter"?(g.preventDefault(),ud()):g.key==="Escape"&&(g.preventDefault(),Va({visible:!1}))};return window.addEventListener("keydown",c),()=>{window.removeEventListener("keydown",c)}}},[Xs.visible,ud]);const oc=I.useCallback(async(c,g)=>{cd.current=!0;try{if(console.log("loadProject: Clearing all existing project data before loading..."),s(null),d(null),Mt([]),Ko([]),jr([]),Oa([]),kn([]),et([]),Xt.current=[],oi([]),Ni([]),Ea(null),Aa(null),$t([]),rn([]),di(null),Tn(new Set),yn(new Set),hn(new Set),Cn(new Set),Rr(),c.toolInstances?Ln.initializeFromProject(c):Ln.initialize(),c.projectInfo&&c.projectInfo.name&&Do(c.projectInfo.name),c.view){if(c.view.currentView&&p(c.view.currentView),c.view.viewScale!=null&&Yn(c.view.viewScale),c.view.cameraWorldCenter)Zt(c.view.cameraWorldCenter);else if(c.view.viewPan){const Pe=Ct.current;if(Pe){const ke=(Pe.width-10)/2,me=(Pe.height-10)/2,be=c.view.viewScale??1,ye=(ke-c.view.viewPan.x)/be,Ce=(me-c.view.viewPan.y)/be;Zt({x:ye,y:Ce})}else Zt({x:0,y:0})}c.view.showBothLayers!=null&&mi(c.view.showBothLayers),c.view.selectedDrawingLayer&&tn(c.view.selectedDrawingLayer)}if(c.homeViews){const Pe={};for(const[ke,me]of Object.entries(c.homeViews)){const be=parseInt(ke,10),ye=me;let Ce=ye.pcbReferenceX,Ue=ye.pcbReferenceY;(Ce===void 0||Ue===void 0)&&(Ce=ye.x??0,Ue=ye.y??0),ye.showTopImage===void 0?Pe[be]={pcbReferenceX:Ce,pcbReferenceY:Ue,x:0,y:0,zoom:ye.zoom,viewRotation:ui,viewFlipX:ut,isBottomView:qa,transparency:v,showTopImage:Ya,showBottomImage:Ga,showViasLayer:ra,showTopTracesLayer:Ra,showBottomTracesLayer:Co,showTopPadsLayer:qo,showBottomPadsLayer:f,showTopTestPointsLayer:N,showBottomTestPointsLayer:X,showTopComponents:re,showBottomComponents:he,showPowerLayer:Ee,showGroundLayer:ci,showConnectionsLayer:Pi}:Pe[be]={...ye,pcbReferenceX:Ce,pcbReferenceY:Ue,x:0,y:0,viewRotation:ye.viewRotation??0,viewFlipX:ye.viewFlipX??!1,isBottomView:ye.isBottomView??!1,transparency:ye.transparency??50}}vs(Pe)}else vs({});if(c.projectNotes&&Array.isArray(c.projectNotes)?La(c.projectNotes):La([]),c.projectMetadata?zl({productName:c.projectMetadata.productName||"",productVersion:c.projectMetadata.productVersion||"",manufacturer:c.projectMetadata.manufacturer||"",date:c.projectMetadata.date||new Date().toISOString().split("T")[0]}):zl({productName:"",productVersion:"",manufacturer:"",date:new Date().toISOString().split("T")[0]}),c.traceColors&&(c.traceColors.top&&(D(c.traceColors.top),Gt("trace",c.traceColors.top,"top")),c.traceColors.bottom&&($(c.traceColors.bottom),Gt("trace",c.traceColors.bottom,"bottom"))),c.traceSizes){const Pe=c.traceSizes.top!=null&&c.traceSizes.top>0?c.traceSizes.top:6;let ke=c.traceSizes.bottom!=null&&c.traceSizes.bottom>0?c.traceSizes.bottom:6;ke<6&&(ke=6),ee(Pe),Ne(ke),Bt("trace",Pe,"top"),Bt("trace",ke,"bottom")}else ee(6),Ne(6);if(c.padColors&&(c.padColors.top&&($e(c.padColors.top),Gt("pad",c.padColors.top,"top")),c.padColors.bottom&&(w(c.padColors.bottom),Gt("pad",c.padColors.bottom,"bottom"))),c.padSizes){const Pe=c.padSizes.top!=null&&c.padSizes.top>0?c.padSizes.top:18,ke=c.padSizes.bottom!=null&&c.padSizes.bottom>0?c.padSizes.bottom:18;H(Pe),ve(ke),Bt("pad",Pe,"top"),Bt("pad",ke,"bottom")}if(c.componentColors&&(c.componentColors.top&&(Ot(c.componentColors.top),Gt("component",c.componentColors.top,"top")),c.componentColors.bottom&&(qt(c.componentColors.bottom),Gt("component",c.componentColors.bottom,"bottom"))),c.componentSizes){const Pe=c.componentSizes.top!=null&&c.componentSizes.top>0?c.componentSizes.top:18,ke=c.componentSizes.bottom!=null&&c.componentSizes.bottom>0?c.componentSizes.bottom:18;fn(Pe),ln(ke),Bt("component",Pe,"top"),Bt("component",ke,"bottom")}c.toolLayerDefaults?(c.toolLayerDefaults.trace&&ko(c.toolLayerDefaults.trace),c.toolLayerDefaults.pad&&us(c.toolLayerDefaults.pad),c.toolLayerDefaults.testPoint&&Mo(c.toolLayerDefaults.testPoint),c.toolLayerDefaults.component&&zs(c.toolLayerDefaults.component)):c.traceToolLayer&&ko(c.traceToolLayer),c.toolSettings&&Tr(Pe=>{const ke=new Map(Pe);if(c.toolSettings.trace){const be=ke.get("trace");if(be){const ye={...be,settings:c.toolSettings.trace},Ce=new Map(be.layerSettings);c.traceSizes&&c.traceColors&&(Ce.set("top",{color:c.traceColors.top||be.layerSettings.get("top")?.color||"#AA4499",size:c.traceSizes.top||be.layerSettings.get("top")?.size||6}),Ce.set("bottom",{color:c.traceColors.bottom||be.layerSettings.get("bottom")?.color||"#F781BF",size:c.traceSizes.bottom||be.layerSettings.get("bottom")?.size||6})),ke.set("trace",{...ye,layerSettings:Ce})}}if(c.toolSettings.via){const be=ke.get("via");be&&ke.set("via",{...be,settings:c.toolSettings.via})}if(c.toolSettings.pad){const be=ke.get("pad");if(be){const ye={...be,settings:c.toolSettings.pad},Ce=new Map(be.layerSettings);c.padSizes&&c.padColors&&(Ce.set("top",{color:c.padColors.top||be.layerSettings.get("top")?.color||"#0072B2",size:c.padSizes.top||be.layerSettings.get("top")?.size||18}),Ce.set("bottom",{color:c.padColors.bottom||be.layerSettings.get("bottom")?.color||"#56B4E9",size:c.padSizes.bottom||be.layerSettings.get("bottom")?.size||18})),ke.set("pad",{...ye,layerSettings:Ce})}}if(c.toolSettings.component){const be=ke.get("component");if(be){const ye={...be,settings:c.toolSettings.component},Ce=new Map(be.layerSettings);c.componentSizes&&c.componentColors&&(Ce.set("top",{color:c.componentColors.top||be.layerSettings.get("top")?.color||"#6A3D9A",size:c.componentSizes.top||be.layerSettings.get("top")?.size||18}),Ce.set("bottom",{color:c.componentColors.bottom||be.layerSettings.get("bottom")?.color||"#9467BD",size:c.componentSizes.bottom||be.layerSettings.get("bottom")?.size||18})),ke.set("component",{...ye,layerSettings:Ce})}}if(c.testPointSizes&&c.testPointColors){ze(c.testPointColors.top||se),De(c.testPointColors.bottom||xe),lt(c.testPointSizes.top||Ye),Wt(c.testPointSizes.bottom||St);const be=ke.get("testPoint");if(be){const ye=new Map(be.layerSettings);ye.set("top",{color:c.testPointColors.top||be.layerSettings.get("top")?.color||"#E69F00",size:c.testPointSizes.top||be.layerSettings.get("top")?.size||6}),ye.set("bottom",{color:c.testPointColors.bottom||be.layerSettings.get("bottom")?.color||"#F0E442",size:c.testPointSizes.bottom||be.layerSettings.get("bottom")?.size||6}),ke.set("testPoint",{...be,layerSettings:ye})}}if(c.componentConnectionColor!==void 0&&Sn(c.componentConnectionColor),c.componentConnectionSize!==void 0&&tt(c.componentConnectionSize),c.toolSettings.ground){const be=ke.get("ground");be&&ke.set("ground",{...be,settings:c.toolSettings.ground})}if(c.toolSettings.power){const be=ke.get("power");be&&ke.set("power",{...be,settings:c.toolSettings.power})}if(c.toolSettings.erase){const be=ke.get("erase");be&&ke.set("erase",{...be,settings:c.toolSettings.erase})}const me=k==="draw"&&Ge==="trace"?ke.get("trace"):k==="draw"&&Ge==="via"?ke.get("via"):k==="draw"&&Ge==="pad"?ke.get("pad"):k==="draw"&&Ge==="testPoint"?ke.get("testPoint"):k==="component"?ke.get("component"):k==="power"?ke.get("power"):k==="ground"?ke.get("ground"):null;if(me)if(k==="draw"&&Ge==="trace"){const be=_n||"top",ye=me.layerSettings.get(be);ye?(te(ye.color),W(ye.size),be==="top"?(D(ye.color),ee(ye.size)):($(ye.color),Ne(ye.size))):(te(me.settings.color),W(me.settings.size))}else if(k==="draw"&&Ge==="pad"){const be=qn||"top",ye=me.layerSettings.get(be);ye?(te(ye.color),W(ye.size),be==="top"?($e(ye.color),H(ye.size)):(w(ye.color),ve(ye.size))):(te(me.settings.color),W(me.settings.size))}else if(k==="component"){const be=Ei||"top",ye=me.layerSettings.get(be);ye?(te(ye.color),W(ye.size),be==="top"?(Ot(ye.color),fn(ye.size)):(qt(ye.color),ln(ye.size))):(te(me.settings.color),W(me.settings.size))}else if(k==="draw"&&Ge==="testPoint"){const be=gi||"top",ye=me.layerSettings.get(be);ye?(te(ye.color),W(ye.size),be==="top"?(ze(ye.color),lt(ye.size)):(De(ye.color),Wt(ye.size))):(te(me.settings.color),W(me.settings.size))}else te(me.settings.color),W(me.settings.size);return ke});const A=async(Pe,ke)=>{if(!Pe)return null;let me=null,be="",ye=Pe.filePath||Pe.name;if(!ke){const Ce=Pe.name||"image";return alert(`Error: Cannot load image "${Ce}" because no project directory is available.

Please ensure you opened the project file from its project directory. The project directory is required to access the image files stored in the images/ subdirectory.`),null}if(ye)try{let Ce=ye;!ye.startsWith("images/")&&!ye.startsWith("Images/")?Ce=ye:ye.startsWith("Images/")?Ce=ye.replace("Images/",""):ye.startsWith("images/")&&(Ce=ye.replace("images/",""));let Ue;try{Ue=await ke.getDirectoryHandle("images")}catch{try{Ue=await ke.getDirectoryHandle("Images")}catch{throw new Error("Neither 'images' nor 'Images' directory found in project folder.")}}const Ze=await(await Ue.getFileHandle(Ce)).getFile();me=await createImageBitmap(Ze),be=URL.createObjectURL(Ze),console.log(`Loaded image from file path: images/${Ce}`),ye.startsWith("images/")||(ye=`images/${ye.replace("Images/","")}`)}catch(Ce){const Ue=Ce instanceof Error?Ce.message:"Unknown error",Le=Pe.name||"image",Ze=ye.startsWith("images/")||ye.startsWith("Images/")?ye.replace("Images/","images/"):`images/${ye}`;return alert(`Error: Failed to load image "${Le}" from project directory.

Expected location: ${Ze}

This may occur if:
- The image file was moved or deleted
- The project directory structure was modified
- File permissions are insufficient

Please ensure the image file exists in the images/ subdirectory of your project folder.

Technical details: ${Ue}`),null}else{const Ce=Pe.name||"image";return alert(`Error: Image "${Ce}" has no file path specified in the project file.

The project file is missing the image file path information. This may indicate the project file is corrupted or was created with an older version of the software.`),null}if(!me){const Ce=Pe.name||"image";return alert(`Error: Could not create image bitmap for "${Ce}".

The image file may be corrupted or in an unsupported format. Please ensure the image is a valid PNG, JPEG, or other supported image format.`),null}return{url:be,name:Pe.name??"image",width:Pe.width??me.width,height:Pe.height??me.height,filePath:ye,x:Pe.x??0,y:Pe.y??0,scale:Pe.scale??1,rotation:Pe.rotation??0,flipX:!!Pe.flipX,flipY:!!Pe.flipY,skewX:Pe.skewX??0,skewY:Pe.skewY??0,keystoneV:Pe.keystoneV??0,keystoneH:Pe.keystoneH??0,brightness:Pe.brightness??100,contrast:Pe.contrast??100,bitmap:me}},L=g!==void 0?g:ai,K=await A(c.images?.top,L),oe=await A(c.images?.bottom,L);if(s(K),d(oe),c.pointIdCounter&&typeof c.pointIdCounter=="number"?Kp(c.pointIdCounter):(console.warn("Project file missing pointIdCounter. Starting from 1."),Kp(1)),c.locks&&(typeof c.locks.areImagesLocked=="boolean"&&da(c.locks.areImagesLocked),typeof c.locks.areViasLocked=="boolean"&&fa(c.locks.areViasLocked),typeof c.locks.arePadsLocked=="boolean"&&ys(c.locks.arePadsLocked),typeof c.locks.areTracesLocked=="boolean"&&ha(c.locks.areTracesLocked),typeof c.locks.areComponentsLocked=="boolean"&&za(c.locks.areComponentsLocked),typeof c.locks.areGroundNodesLocked=="boolean"&&es(c.locks.areGroundNodesLocked),typeof c.locks.arePowerNodesLocked=="boolean"&&to(c.locks.arePowerNodesLocked)),c.visibility&&(typeof c.visibility.showViasLayer=="boolean"&&ss(c.visibility.showViasLayer),typeof c.visibility.showTopPadsLayer=="boolean"&&va(c.visibility.showTopPadsLayer),typeof c.visibility.showBottomPadsLayer=="boolean"&&x(c.visibility.showBottomPadsLayer),typeof c.visibility.showTopTracesLayer=="boolean"&&Hi(c.visibility.showTopTracesLayer),typeof c.visibility.showBottomTracesLayer=="boolean"&&oa(c.visibility.showBottomTracesLayer),typeof c.visibility.showTopComponents=="boolean"&&le(c.visibility.showTopComponents),typeof c.visibility.showBottomComponents=="boolean"&&Te(c.visibility.showBottomComponents),typeof c.visibility.showPowerLayer=="boolean"&&Xe(c.visibility.showPowerLayer),typeof c.visibility.showGroundLayer=="boolean"&&Li(c.visibility.showGroundLayer),typeof c.visibility.showConnectionsLayer=="boolean"&&ur(c.visibility.showConnectionsLayer),typeof c.visibility.showTraceCornerDots=="boolean"&&ir(c.visibility.showTraceCornerDots)),c.autoSave?(typeof c.autoSave.enabled=="boolean"&&go(c.autoSave.enabled),typeof c.autoSave.interval=="number"&&zo(c.autoSave.interval),typeof c.autoSave.baseName=="string"&&c.autoSave.baseName?(no(c.autoSave.baseName),ro.current=c.autoSave.baseName,c.autoSave.enabled&&!Rs&&(console.log("Auto save: Directory handle not available after page reload (expected). Auto save disabled. Use File -> Auto Save -> Enable to re-enable."),go(!1),zo(null))):c.autoSave.enabled&&(console.warn("Auto save was enabled in project file but base name is missing. Disabling auto save."),go(!1),zo(null),no(""),ro.current="")):(go(!1),zo(null),wo(null),no(""),br.current=null,ro.current="",Ii.current&&(clearInterval(Ii.current),Ii.current=null)),c.drawing?.drawingStrokes&&Array.isArray(c.drawing.drawingStrokes)){const Pe=c.drawing.drawingStrokes.map(ke=>({...ke,points:ke.points.map(me=>({...me,...xr(me)}))})).filter(ke=>!(ke.type==="trace"&&ke.points.length<2));Mt(Pe);for(const ke of Pe)for(const me of ke.points)me.id&&typeof me.id=="number"&&bg(me.id)}else console.warn("Project file missing drawingStrokes. Starting with empty strokes."),Mt([]);if(c.drawing?.componentsTop){const Pe=c.drawing.componentsTop.map(ke=>{const me=xr({x:ke.x,y:ke.y});return{...ke,x:me.x,y:me.y,layer:ke.layer||"top",pinConnections:ke.pinConnections||new Array(ke.pinCount||0).fill("")}});oi(Pe)}if(c.drawing?.componentsBottom){const Pe=c.drawing.componentsBottom.map(ke=>{const me=xr({x:ke.x,y:ke.y});return{...ke,x:me.x,y:me.y,layer:ke.layer||"bottom",pinConnections:ke.pinConnections||new Array(ke.pinCount||0).fill("")}});Ni(Pe)}if(c.designatorCounters&&typeof c.designatorCounters=="object"){const Pe=c.designatorCounters;Oi.current={...Pe}}else Oi.current={};if(typeof c.autoAssignDesignators=="boolean"&&si(c.autoAssignDesignators),typeof c.useGlobalDesignatorCounters=="boolean"?lr(c.useGlobalDesignatorCounters):lr(!1),c.drawing?.grounds){const ke=c.drawing.grounds.map(me=>{me.pointId||console.warn("Ground symbol missing pointId - this may cause issues");const be=xr({x:me.x,y:me.y});return{...me,x:be.x,y:be.y}}).filter(me=>{const be=typeof me.x=="number"&&typeof me.y=="number"&&!isNaN(me.x)&&!isNaN(me.y)&&isFinite(me.x)&&isFinite(me.y);return be||console.warn(`Filtered out invalid ground symbol at (${me.x}, ${me.y})`),be});rn(ke);for(const me of ke)me.pointId&&typeof me.pointId=="number"&&bg(me.pointId)}else rn([]);let z;if(c.powerBuses&&Array.isArray(c.powerBuses)&&c.powerBuses.length>0?(z=c.powerBuses,Be(z)):(z=[{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}],Be(z)),c.groundBuses&&Array.isArray(c.groundBuses)&&c.groundBuses.length>0?gt(c.groundBuses):gt([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),c.drawing?.powers){const ke=c.drawing.powers.map(me=>{me.pointId||console.warn("Power symbol missing pointId - this may cause issues");const be=xr({x:me.x,y:me.y});return{...me,x:be.x,y:be.y}}).filter(me=>{const be=typeof me.x=="number"&&typeof me.y=="number"&&!isNaN(me.x)&&!isNaN(me.y)&&isFinite(me.x)&&isFinite(me.y);return be||console.warn(`Filtered out invalid power node at (${me.x}, ${me.y})`),be});$t(ke);for(const me of ke)me.pointId&&typeof me.pointId=="number"&&bg(me.pointId)}else $t([]);let Ae=0;if(c.drawing?.drawingStrokes&&Array.isArray(c.drawing.drawingStrokes))for(const Pe of c.drawing.drawingStrokes)for(const ke of Pe.points)ke.id&&typeof ke.id=="number"&&ke.id>Ae&&(Ae=ke.id);if(c.drawing?.componentsTop&&Array.isArray(c.drawing.componentsTop)){for(const Pe of c.drawing.componentsTop)if(Pe.pinConnections&&Array.isArray(Pe.pinConnections)){for(const ke of Pe.pinConnections)if(ke&&typeof ke=="string"){const me=parseInt(ke,10);!isNaN(me)&&me>Ae&&(Ae=me)}}}if(c.drawing?.componentsBottom&&Array.isArray(c.drawing.componentsBottom)){for(const Pe of c.drawing.componentsBottom)if(Pe.pinConnections&&Array.isArray(Pe.pinConnections)){for(const ke of Pe.pinConnections)if(ke&&typeof ke=="string"){const me=parseInt(ke,10);!isNaN(me)&&me>Ae&&(Ae=me)}}}if(c.drawing?.grounds&&Array.isArray(c.drawing.grounds))for(const Pe of c.drawing.grounds)Pe.pointId&&typeof Pe.pointId=="number"&&Pe.pointId>Ae&&(Ae=Pe.pointId);if(c.drawing?.powers&&Array.isArray(c.drawing.powers))for(const Pe of c.drawing.powers)Pe.pointId&&typeof Pe.pointId=="number"&&Pe.pointId>Ae&&(Ae=Pe.pointId);const Se=Ae+1,_e=mg();_e<Se&&(console.warn(`pointIdCounter was ${_e} but max existing ID is ${Ae}. Correcting to ${Se}.`),Kp(Se)),Ai.current=!1,bo(!1),hr(!1),setTimeout(()=>{cd.current=!1},100)}catch(A){console.error("Failed to open project",A),alert("Failed to open project file. See console for details."),cd.current=!1}},[k,Ge,ai,s,d,Kp,da,fa,ys,ha,za,es,to,ss,va,x,Hi,oa,le,Te,Xe,Li,ur,go,zo,wo,no,Mt,oi,Ni,rn,Be,gt,$t,lc,xr,vg,D2,Xf,si,lr,Rr]),ql=I.useCallback(async()=>{},[ya]),Yc=I.useCallback(async c=>{const g=br.current;if(!g){console.warn("Cannot load file: no directory handle");return}try{const L=await(await g.getFileHandle(c)).getFile();if(L.size===0){console.warn(`File ${c} is empty, skipping`);const _e=oo.current.filter(Pe=>Pe!==c);Wa(_e),oo.current=_e;return}const K=await L.text();if(!K||K.trim().length===0){console.warn(`File ${c} contains no data, skipping`);const _e=oo.current.filter(Pe=>Pe!==c);Wa(_e),oo.current=_e;return}let oe;try{oe=JSON.parse(K)}catch(Se){console.error(`Failed to parse JSON from file ${c}:`,Se);const Pe=oo.current.filter(ke=>ke!==c);Wa(Pe),oo.current=Pe,await ql();return}Sr(),Yn(1),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),Tn(new Set),yn(new Set),hn(new Set),Cn(new Set),Tc(),await oc(oe),sr(c);const Ae=oo.current.indexOf(c);Ae>=0?(Yr(Ae),os.current=Ae):await ql(),Ai.current=!1,bo(!1)}catch(A){console.error("Failed to load file from history:",A);const L=oo.current;if(L.includes(c)){const K=L.filter(oe=>oe!==c);Wa(K),oo.current=K,await ql()}}},[oc,ql,Tc]),dd=I.useCallback(async c=>{if(!ai){console.warn("Cannot restore file: no project directory handle"),alert("No project directory available. Please open or create a project first.");return}try{let g;try{g=await ai.getDirectoryHandle("history")}catch(z){console.error("History directory not found:",z),alert("History directory not found.");return}const L=await(await g.getFileHandle(c)).getFile();if(L.size===0){alert(`File ${c} is empty.`);return}const K=await L.text();if(!K||K.trim().length===0){alert(`File ${c} contains no data.`);return}let oe;try{oe=JSON.parse(K)}catch(z){console.error(`Failed to parse JSON from file ${c}:`,z),alert(`Failed to parse file ${c}. It may be corrupted.`);return}Sr(),Yn(1),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),Tn(new Set),yn(new Set),hn(new Set),Cn(new Set),Tc(),await oc(oe),sr(c),Ai.current=!1,console.log(`Successfully restored file: ${c}`)}catch(g){console.error("Failed to restore file from history:",g),alert(`Failed to restore file ${c}. Please try again.`)}},[ai,oc,Tn,yn,hn,Cn,sr,Yn,Sr,Tc]);At.useEffect(()=>{vt&&!Nt&&bn({x:window.innerWidth/2-300,y:window.innerHeight/2-250})},[vt,Nt]);const Ru=I.useCallback(c=>{if(!Nt)return;ri(!0);const g=c.clientX-Nt.x,A=c.clientY-Nt.y,L=oe=>{bn({x:oe.clientX-g,y:oe.clientY-A})},K=()=>{ri(!1),document.removeEventListener("mousemove",L),document.removeEventListener("mouseup",K)};document.addEventListener("mousemove",L),document.addEventListener("mouseup",K)},[Nt]);I.useCallback(async()=>{const c=os.current,g=oo.current;if(c>=0&&c<g.length-1){const A=c+1,L=g[A];L&&await Yc(L)}},[Yc]),I.useCallback(async()=>{const c=os.current,g=oo.current;if(c<=0||c>=g.length||g.length===0){console.warn("Cannot navigate to newer file: index is",c,"history length is",g.length);return}if(c>0&&c<g.length&&g.length>0){const A=c-1;if(A>=0&&A<g.length){const L=g[A];L?await Yc(L):(console.warn("No newer file found at index",A),await ql())}else console.warn("Cannot navigate to newer file: prevIndex",A,"is out of bounds")}},[Yc,ql]),At.useEffect(()=>{Xt.current=st},[st]);const $d=At.useRef(Ge),Yd=At.useRef(Tt);At.useEffect(()=>{const c=Ge!==$d.current;if(k==="draw"&&$d.current==="trace"&&c){if(Xt.current.length>=2){Yi(dt,Qt,en,mt,Jt);const g={id:`${Date.now()}-trace-autofinalize`,points:Xt.current,color:G,size:O,layer:Yd.current,type:"trace"};Mt(A=>[...A,g]),Yd.current==="top"?Bo(A=>[...A,g.id]):fs(A=>[...A,g.id])}et([]),we(!1)}$d.current=Ge,Yd.current=Tt},[Ge,Tt,k,G,O]);const Iu=At.useRef(k);At.useEffect(()=>{if(Iu.current==="draw"&&k!=="draw"&&Ge==="trace"&&Xt.current.length>=2){const c={id:`${Date.now()}-trace-autofinalize`,points:Xt.current,color:G,size:O,layer:Tt,type:"trace"};Mt(g=>[...g,c]),Tt==="top"?Bo(g=>[...g,c.id]):fs(g=>[...g,c.id]),et([]),we(!1)}Iu.current=k},[k,Ge,G,O,Tt]);const If=At.useMemo(()=>v2,[]);At.useEffect(()=>{gu()},[dt]),At.useEffect(()=>{gu()},[Qt,en,Re,ci]);const on=ta>0,Lf=I.useCallback(async c=>await I1(bu,Mr,sr,Do,na,pl,oc,async(L,K,oe,z)=>{await nf(L,K,oe,go,zo,wo,no,br,ro,Ii,Ai,Po,ho,Mr,as,z)},c),[bu,Mr,sr,Do,na,pl,oc,go,zo,wo,no,br,ro,Ii,Ai,Po,ho,Mr,as,nf]);I.useCallback(async()=>{const g=await I1(bu,Mr,sr,Do,na,pl,oc,async(A,L,K,oe)=>{await nf(A,L,K,go,zo,wo,no,br,ro,Ii,Ai,Po,ho,Mr,as,oe)});if(!g.success){if(g.error&&g.error!=="User cancelled directory selection."&&alert(g.error),g.error==="User cancelled directory selection.")return;g.error?.includes("not supported")&&hl.current?.click()}},[bu,Mr,sr,Do,na,pl,oc,io,ai,go,zo,wo,no,br,ro,Ii,Ai,Po,ho,Mr,as,hl,nf]);const Dh=I.useCallback(async()=>{const c=window;if(typeof c.showDirectoryPicker!="function"){alert("Directory picker is not supported in this browser.");return}let g=null;try{g=await c.showDirectoryPicker({mode:"readwrite"});try{if(g&&"queryPermission"in g&&typeof g.queryPermission=="function"&&await g.queryPermission({mode:"readwrite"})!=="granted"&&"requestPermission"in g&&typeof g.requestPermission=="function"&&await g.requestPermission({mode:"readwrite"})!=="granted"){alert("Full access to the project directory is required to open and manage project files.");return}}catch(L){console.warn("Permission check failed (may not be supported in this browser):",L)}}catch(L){if(L?.name==="AbortError")return;alert(`Failed to open directory picker: ${L instanceof Error?L.message:String(L)}`);return}if(Ma()&&ai)try{await Nr()}catch(L){console.warn("Failed to auto-save before opening project:",L)}const A=await Lf(g);!A.success&&A.error&&A.error!=="User cancelled directory selection."&&alert(A.error)},[Ma,Nr,ai,Lf]),Rh=I.useCallback(async()=>{if(Ma()&&ai)try{await Nr()}catch(c){console.warn("Failed to save before closing project:",c)}Vd()},[Ma,Nr,ai,Vd]);return i.jsxs("div",{className:"app",children:[i.jsxs("header",{className:"app-header",children:[i.jsx("h1",{style:{position:"absolute",left:"50%",transform:"translateX(-50%)"},children:" PCB Tracer"}),i.jsxs("button",{onClick:()=>{window.open("https://github.com/sponsors/pgiacalo","_blank","noopener,noreferrer")},style:{display:"flex",alignItems:"center",gap:6,padding:"6px 12px",background:"#ffffff",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:6,cursor:"pointer",fontSize:12,fontWeight:500,color:"#000000",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)",transition:"background 0.2s",marginLeft:"auto"},onMouseEnter:c=>{c.currentTarget.style.background="#f0f0f0"},onMouseLeave:c=>{c.currentTarget.style.background="#ffffff"},title:"Donate to support this project",children:[i.jsx("svg",{height:"16",width:"16",viewBox:"0 0 16 16",fill:"#ff0000","aria-hidden":"true",children:i.jsx("path",{d:"M4.25 2.5c-1.336 0-2.75 1.164-2.75 3 0 2.15 1.58 4.144 3.365 5.682A20.565 20.565 0 008 13.393a20.561 20.561 0 003.135-2.211C12.92 9.644 14.5 7.65 14.5 5.5c0-1.836-1.414-3-2.75-3-1.373 0-2.609.986-3.029 2.456a.749.749 0 01-1.442 0C6.859 3.486 5.623 2.5 4.25 2.5z"})}),"Donate"]})]}),i.jsx(tw,{openMenu:zc,setOpenMenu:_s,isReadOnlyMode:on,currentProjectFilePath:ya,isProjectActive:!!ai,autoSaveEnabled:Ha,autoSaveInterval:kl,hasUnsavedChangesState:jl,onNewProject:Ns,onOpenProject:Dh,onSaveProject:Nr,onCloseProject:Rh,onPrint:jp,onExportBOM:Cc,bomExportFormat:ae,setBomExportFormat:E,onExportNetlist:kp,netlistExportFormat:U,setNetlistExportFormat:ne,hasUnsavedChanges:Ma,setNewProjectDialog:Va,setAutoSaveDialog:Po,onShowAiSettings:()=>Ju(!0),topImage:o,bottomImage:l,setCurrentTool:y,resetImageTransform:Ld,areImagesLocked:ar,setAreImagesLocked:da,onEnterBoardDimensions:()=>Hc(!0),fileInputTopRef:ou,fileInputBottomRef:ms,openProjectRef:hl,increaseSize:zf,decreaseSize:Md,brushSize:O,drawingStrokes:dt,selectedIds:wn,selectedComponentIds:Mn,selectedPowerIds:Ri,selectedGroundIds:ji,componentsTop:Qt,componentsBottom:en,powers:fe,grounds:Re,powerNodeNames:wf,groundNodeNames:hp,setSetSizeDialog:ts,areViasLocked:Lr,setAreViasLocked:fa,arePadsLocked:pa,setArePadsLocked:ys,areTestPointsLocked:Jo,setAreTestPointsLocked:Pa,areTracesLocked:po,setAreTracesLocked:ha,areComponentsLocked:er,setAreComponentsLocked:za,areGroundNodesLocked:mo,setAreGroundNodesLocked:es,arePowerNodesLocked:tr,setArePowerNodesLocked:to,showTraceCornerDots:Kr,setShowTraceCornerDots:ir,showCrosshairs:Ui,setShowCrosshairs:Ia,setSelectedIds:Tn,setSelectedComponentIds:yn,setSelectedPowerIds:hn,setSelectedGroundIds:Cn,selectAllVias:sp,selectAllTraces:lp,selectAllPads:cp,selectAllComponents:up,selectDisconnectedComponents:xf,selectAllComponentConnections:dp,selectAllPowerNodes:gp,selectAllGroundNodes:Ah,selectPowerNodesByName:Ph,selectGroundNodesByName:yp,setShowPowerBusManager:pt,setShowGroundBusManager:ei,setShowPastMachine:Ft,toolRegistry:yi,updateToolSettings:Yl,updateToolLayerSettings:xo,setBrushSize:W,setBrushColor:te,saveToolSettings:Ky,saveToolLayerSettings:sf,colorPalette:If,currentTool:k,drawingMode:Ge,traceToolLayer:_n,padToolLayer:qn,testPointToolLayer:gi,componentToolLayer:Ei,setTopTraceSize:ee,setBottomTraceSize:Ne,setTopPadSize:H,setBottomPadSize:ve,setTopTestPointSize:lt,setBottomTestPointSize:Wt,setTopComponentSize:fn,setBottomComponentSize:ln,setComponentConnectionSize:tt,topTraceColor:Y,bottomTraceColor:J,topPadColor:Ie,bottomPadColor:q,topTestPointColor:se,bottomTestPointColor:xe,topComponentColor:ge,bottomComponentColor:_t,setTopTraceColor:D,setBottomTraceColor:$,setTopPadColor:$e,setBottomPadColor:w,setTopTestPointColor:ze,setBottomTestPointColor:De,setTopComponentColor:Ot,setBottomComponentColor:qt,setComponentConnectionColor:Sn,saveDefaultSize:Bt,saveDefaultColor:Gt,menuBarRef:yl,onOpenProjectNotes:Du,onOpenTestPoints:Fl,onOpenTransformImages:()=>Ks(!0),onOpenTransformAll:()=>Eo(!0)}),i.jsx("div",{style:{display:"block",padding:0,margin:0,width:"100vw",height:"calc(100vh - 70px)",boxSizing:"border-box",position:"relative"},children:i.jsxs("div",{ref:Rc,style:{position:"relative",width:"100%",height:"100%",margin:0,padding:0,boxSizing:"border-box",background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",borderRadius:"16px",overflow:"hidden"},children:[i.jsxs("div",{style:{position:"absolute",top:6,left:6,bottom:6,width:46,display:"flex",flexDirection:"column",gap:8,padding:"6px 3px",background:"rgba(250,250,255,0.95)",borderRadius:8,border:"1px solid #ddd",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:20},children:[i.jsxs("button",{onClick:()=>{on||Wc()},onMouseDown:c=>c.currentTarget.blur(),disabled:on,title:"Select (S)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="select"?"2px solid #000":"1px solid #ddd",background:k==="select"?"#e6f0ff":"#fff",color:on?"#999":"#222",outline:"none",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:[i.jsx(y2,{size:14}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"S"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),i.jsxs("button",{onMouseDown:c=>{if(c.altKey&&!on){c.preventDefault(),c.stopPropagation(),gc(!1),ml(!0);return}},onClick:c=>{!on&&!c.altKey&&(console.log("Via tool clicked"),Qn(),zt("via"),y("draw"),ss(!0))},disabled:on,title:"Draw Vias (V), Option+click for Pattern Placement",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="draw"&&Ge==="via"?"2px solid #000":"1px solid #ddd",background:k==="draw"&&Ge==="via"?"#e6f0ff":"#fff",color:on?"#999":"#222",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:[i.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const c=Ln.get("via").color;return i.jsxs(i.Fragment,{children:[i.jsx("circle",{cx:"12",cy:"12",r:"8",fill:"none",stroke:c,strokeWidth:"3"}),i.jsx("circle",{cx:"12",cy:"12",r:"4",fill:c})]})})()}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"V"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:Ln.get("via").size})]})]}),i.jsxs("button",{ref:jo,onMouseDown:c=>{if(c.altKey&&!on){c.preventDefault(),c.stopPropagation(),gc(!0),ml(!0);return}},onClick:c=>{!on&&!c.altKey&&(console.log("Pad tool clicked"),Qn(),zt("pad"),y("draw"),setTimeout(()=>ic(),0))},disabled:on,title:"Draw Pads (P), Option+click for Pattern Placement",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="draw"&&Ge==="pad"?"2px solid #000":"1px solid #ddd",background:k==="draw"&&Ge==="pad"?"#e6f0ff":"#fff",color:on?"#999":"#222",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:[i.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const g=qn==="top"?"padTop":"padBottom",A=Ln.get(g).color,L=14,K=(24-L)/2,oe=(24-L)/2;return i.jsx("rect",{x:K,y:oe,width:L,height:L,fill:A})})()}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"P"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{if(k==="draw"&&Ge==="pad"&&_r.toolInstanceId&&(_r.toolInstanceId==="padTop"||_r.toolInstanceId==="padBottom"))return _r.size;const c=qn==="top"?"padTop":"padBottom";return Ln.get(c).size})()})]})]}),i.jsxs("button",{ref:aa,onClick:()=>{on||(console.log("Test Point tool clicked"),Qn(),zt("testPoint"),y("draw"),setTimeout(()=>Od(),0))},disabled:on,title:"Draw Test Points (Y)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="draw"&&Ge==="testPoint"?"2px solid #000":"1px solid #ddd",background:k==="draw"&&Ge==="testPoint"?"#e6f0ff":"#fff",color:on?"#999":"#222",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:[i.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const g=gi==="top"?"testPointTop":"testPointBottom",A=Ln.get(g).color,L=14,K=12,oe=12;return i.jsx("path",{d:`M ${K} ${oe-L/2} L ${K+L/2} ${oe} L ${K} ${oe+L/2} L ${K-L/2} ${oe} Z`,fill:A,stroke:"#000",strokeWidth:"1.5"})})()}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"Y"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{if(k==="draw"&&Ge==="testPoint"&&_r.toolInstanceId&&(_r.toolInstanceId==="testPointTop"||_r.toolInstanceId==="testPointBottom"))return _r.size;const c=gi==="top"?"testPointTop":"testPointBottom";return Ln.get(c).size})()})]})]}),i.jsxs("button",{ref:Pu,onMouseDown:c=>{if(c.altKey&&!on){c.preventDefault(),c.stopPropagation(),gc(!1),ml(!0);return}},onClick:c=>{!on&&!c.altKey&&(console.log("Trace tool clicked"),Qn(),zt("trace"),y("draw"),nc(!0),setTimeout(()=>xu(),0))},disabled:on,title:"Draw Traces (T)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="draw"&&Ge==="trace"?"2px solid #000":"1px solid #ddd",background:k==="draw"&&Ge==="trace"?"#e6f0ff":"#fff",color:on?"#999":"#222",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:[i.jsx(m2,{size:14,color:(()=>{const g=_n==="top"?"traceTop":"traceBottom";return Ln.get(g).color})()}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"T"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{const c=_n==="top"?"traceTop":"traceBottom";return Ln.get(c).size})()})]})]}),i.jsxs("button",{ref:bp,onClick:()=>{on||(console.log("Component tool clicked"),Qn(),y("component"))},disabled:on,title:"Draw Component (C)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="component"?"2px solid #000":"1px solid #ddd",background:k==="component"?"#e6f0ff":"#fff",color:on?"#999":"#222",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:[(()=>{const g=(Ei||"top")==="top"?"componentTop":"componentBottom",A=Ln.get(g).color;return Ml?i.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[i.jsx("rect",{x:"4",y:"4",width:"16",height:"16",fill:"rgba(255,255,255,0.9)",stroke:A,strokeWidth:"1.5"}),i.jsx("text",{x:"12",y:"14",textAnchor:"middle",fontSize:"7",fill:A,fontWeight:"bold",fontFamily:"monospace",children:(()=>{const L=bc?.componentDefinition?.designator??bc?.designator;return L?L.length<=3?L:L.substring(0,3):qg(Ml)})()})]}):i.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[i.jsx("rect",{x:"5",y:"3",width:"14",height:"7",fill:A,stroke:A,strokeWidth:"0.5"}),i.jsxs("g",{stroke:A,fill:"none",strokeWidth:"1.5",children:[i.jsx("rect",{x:"5",y:"10",width:"14",height:"4",rx:"1.2"}),i.jsx("path",{d:"M7 14 v4 M10 14 v4 M13 14 v4 M16 14 v4",stroke:A})]})]})})(),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"C"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{const c=Ei==="top"?"componentTop":"componentBottom";return Ln.get(c).size})()})]})]}),i.jsxs("button",{ref:Pd,onClick:()=>{on||(console.log("Power tool clicked"),Qn(),fi(!1),pe.length===1?(Jn(pe[0].id),y("power"),Un(!1),Xe(!0)):pe.length>1?Un(!0):(Un(!0),y("power"),Xe(!0)))},disabled:on,title:"Draw Power (B)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="power"?"2px solid #000":"1px solid #ddd",background:k==="power"?"#e6f0ff":"#fff",color:on?"#999":"#222",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:[i.jsx("span",{style:{color:(Fi?pe.find(c=>c.id===Fi)?.color:null)||"#ff0000",fontSize:"18px",fontWeight:"bold",lineHeight:1,flexShrink:0},children:"V"}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"B"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:Ln.get("power").size})]})]}),i.jsxs("button",{ref:zd,onClick:()=>{on||(console.log("Ground tool clicked"),Un(!1),Ve.length===1?(yo(Ve[0].id),y("ground"),fi(!1),Li(!0)):Ve.length>1?fi(!0):(fi(!0),y("ground"),Li(!0)))},disabled:on,title:"Draw Ground (G)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="ground"?"2px solid #000":"1px solid #ddd",background:k==="ground"?"#e6f0ff":"#fff",color:on?"#999":"#222",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:[i.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 20","aria-hidden":"true",style:{overflow:"visible",flexShrink:0},children:i.jsxs("g",{stroke:(nr?Ve.find(c=>c.id===nr)?.color:null)||"#000000",strokeWidth:"2",strokeLinecap:"round",children:[i.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"10"}),i.jsx("line",{x1:"5",y1:"10",x2:"19",y2:"10"}),i.jsx("line",{x1:"7",y1:"13",x2:"17",y2:"13"}),i.jsx("line",{x1:"9.5",y1:"16",x2:"14.5",y2:"16"})]})}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"G"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:Ln.get("ground").size})]})]}),i.jsx("div",{style:{height:32}}),i.jsxs("button",{onClick:()=>{on||(Qn(),y(c=>c==="pan"?"draw":"pan"))},disabled:on,title:"Move (H)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:6,padding:"4px 6px",borderRadius:6,border:k==="pan"?"2px solid #000":"1px solid #ddd",background:k==="pan"?"#e6f0ff":"#fff",color:on?"#999":"#222",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:[i.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:i.jsxs("g",{stroke:"#111",fill:"none",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("path",{d:"M8 11v-4c0-.8.6-1.3 1.3-1.3S11 6.2 11 7v4"}),i.jsx("path",{d:"M11 11V6.5c0-.8.6-1.3 1.3-1.3S14 5.7 14 6.5V11"}),i.jsx("path",{d:"M14 11V7.2c0-.8.6-1.3 1.3-1.3.7 0 1.3.5 1.3 1.3V12c1 .6 1.6 1.5 1.6 2.7A4.3 4.3 0 0 1 14 19H9.2A4.2 4.2 0 0 1 5 14.8V11c0-.6.4-1 .9-1 .6 0 1 .4 1 1v2"})]})}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"H"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),i.jsxs("button",{onClick:()=>{Qn(),au(!1),y(c=>c==="magnify"?"draw":"magnify")},title:"Magnify (M)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="magnify"?"2px solid #000":"1px solid #ddd",background:k==="magnify"?"#e6f0ff":"#fff",color:"#222",cursor:"pointer"},children:[i.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[i.jsx("circle",{cx:"10",cy:"10",r:"7.5",fill:"none",stroke:"#111",strokeWidth:"2"}),i.jsx("line",{x1:"15.5",y1:"15.5",x2:"21",y2:"21",stroke:"#111",strokeWidth:"2",strokeLinecap:"round"}),Da?i.jsx("line",{x1:"6.5",y1:"10",x2:"13.5",y2:"10",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"}):i.jsxs(i.Fragment,{children:[i.jsx("line",{x1:"6.5",y1:"10",x2:"13.5",y2:"10",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"}),i.jsx("line",{x1:"10",y1:"6.5",x2:"10",y2:"13.5",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"})]})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"M"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),i.jsxs("button",{onClick:()=>{on||Eo(!0)},disabled:on,title:"Change Perspective (E) - Open Change Perspective Dialog",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:Nl?"2px solid #000":"1px solid #ddd",background:Nl?"#e6f0ff":"#fff",color:on?"#999":"#222",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:[i.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[i.jsx("ellipse",{cx:"12",cy:"12",rx:"9",ry:"6",fill:"none",stroke:"#111",strokeWidth:"2"}),i.jsx("circle",{cx:"12",cy:"12",r:"4",fill:"none",stroke:"#111",strokeWidth:"2"}),i.jsx("circle",{cx:"11",cy:"11",r:"1.5",fill:"#111",stroke:"none"})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"E"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),i.jsxs("button",{onClick:()=>{on||(Qn(),y("center"),vr(!0),On.current&&clearTimeout(On.current),On.current=setTimeout(()=>{vr(!1),y("select"),Di(void 0)},2e3))},disabled:on,title:"Set View (X) - Press 0-9 to Set View",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:k==="center"?"2px solid #000":"1px solid #ddd",background:k==="center"?"#e6f0ff":"#fff",color:on?"#999":"#222",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:[i.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[i.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"10",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),i.jsx("line",{x1:"12",y1:"14",x2:"12",y2:"22",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),i.jsx("line",{x1:"2",y1:"12",x2:"10",y2:"12",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),i.jsx("line",{x1:"14",y1:"12",x2:"22",y2:"12",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"X"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onClick:()=>{on||ga(c=>!c)},disabled:on,title:"Color Picker",style:{width:32,height:32,display:"grid",placeItems:"center",borderRadius:6,border:"1px solid #ddd",background:"#fff",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:i.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 16 16","aria-hidden":"true",children:[i.jsx("rect",{x:"0",y:"0",width:"3.5",height:"3.5",fill:"#9E9E9E",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"4",y:"0",width:"3.5",height:"3.5",fill:"#0072B2",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"8",y:"0",width:"3.5",height:"3.5",fill:"#56B4E9",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"12",y:"0",width:"3.5",height:"3.5",fill:"#00BFC4",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"0",y:"4",width:"3.5",height:"3.5",fill:"#6A3D9A",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"4",y:"4",width:"3.5",height:"3.5",fill:"#2CA02C",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"8",y:"4",width:"3.5",height:"3.5",fill:"#7FC97F",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"12",y:"4",width:"3.5",height:"3.5",fill:"#FF7F0E",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"0",y:"8",width:"3.5",height:"3.5",fill:"#FFD700",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"4",y:"8",width:"3.5",height:"3.5",fill:"#FF6B6B",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"8",y:"8",width:"3.5",height:"3.5",fill:"#E74C3C",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"12",y:"8",width:"3.5",height:"3.5",fill:"#FFB6C1",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"0",y:"12",width:"3.5",height:"3.5",fill:"#DDA0DD",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"4",y:"12",width:"3.5",height:"3.5",fill:"#8B4513",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"8",y:"12",width:"3.5",height:"3.5",fill:"#A0522D",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"12",y:"12",width:"3.5",height:"3.5",fill:"#FF4500",stroke:"#ccc",strokeWidth:"0.3"})]})}),Uo&&i.jsx("div",{ref:Jl,style:{position:"absolute",left:42,top:0,padding:8,background:"#fff",border:"1px solid #ddd",borderRadius:6,boxShadow:"0 8px 18px rgba(0,0,0,0.18)",zIndex:50},children:i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(8, 22px)",gap:4},children:If.map(c=>i.jsx("div",{onClick:()=>{te(c),ga(!1);try{let A=null;k==="draw"&&Ge==="via"?A="via":k==="draw"&&Ge==="pad"?A=(qn||"top")==="bottom"?"padBottom":"padTop":k==="draw"&&Ge==="testPoint"?A=(gi||"top")==="bottom"?"testPointBottom":"testPointTop":k==="draw"&&Ge==="trace"?A=(_n||"top")==="bottom"?"traceBottom":"traceTop":k==="component"?A=(Ei||"top")==="bottom"?"componentBottom":"componentTop":k==="power"?A="power":k==="ground"&&(A="ground"),A&&Ln.setColor(A,c)}catch(A){console.error("Error updating tool instance color:",A)}const g=Ja(yi);if(g)if(k==="draw"&&Ge==="trace"){const A=_n||"top",K=g.layerSettings.get(A)?.size||g.settings.size,oe={color:c,size:K};xo(g.id,A,oe),sf(g.id),A==="top"?(D(c),Gt("trace",c,"top")):($(c),Gt("trace",c,"bottom"))}else if(k==="draw"&&Ge==="pad"){const A=qn||"top",K=g.layerSettings.get(A)?.size||g.settings.size,oe={color:c,size:K};xo(g.id,A,oe),sf(g.id),A==="top"?($e(c),Gt("pad",c,"top")):(w(c),Gt("pad",c,"bottom"))}else if(k==="draw"&&Ge==="testPoint"){const A=gi||"top",K=g.layerSettings.get(A)?.size||g.settings.size,oe={color:c,size:K};xo(g.id,A,oe),sf(g.id),A==="top"?(ze(c),Gt("testPoint",c,"top")):(De(c),Gt("testPoint",c,"bottom"))}else if(k==="component"){const A=Ei||"top",K=g.layerSettings.get(A)?.size||g.settings.size,oe={color:c,size:K};xo(g.id,A,oe),sf(g.id),A==="top"?(Ot(c),Gt("component",c,"top")):(qt(c),Gt("component",c,"bottom"))}else{const A={...g.settings,color:c};Yl(g.id,A),Ky(g.id,c,g.settings.size),k==="draw"&&Ge==="via"&&Gt("via",c)}Gt("brush",c),wn.size>0&&Mt(A=>A.map(L=>wn.has(L.id)?(L.type==="via"?(Gt("via",c),Tr(K=>{const oe=new Map(K),z=oe.get("via");return z&&oe.set("via",{...z,settings:{...z.settings,color:c}}),oe})):L.type==="pad"?(Gt("pad",c),Tr(K=>{const oe=new Map(K),z=oe.get("pad");return z&&oe.set("pad",{...z,settings:{...z.settings,color:c}}),oe})):L.type==="trace"&&Gt("trace",c,L.layer),{...L,color:c}):L)),Mn.size>0&&(Gt("component",c),oi(A=>A.map(L=>Mn.has(L.id)?{...L,color:c}:L)),Ni(A=>A.map(L=>Mn.has(L.id)?{...L,color:c}:L))),Ri.size>0&&$t(A=>A.map(L=>Ri.has(L.id)?{...L,color:c}:L)),ji.size>0&&rn(A=>A.map(L=>ji.has(L.id)?{...L,color:c}:L))},title:c,style:{width:22,height:22,backgroundColor:c,border:c===G?"2px solid #333":"1px solid #ccc",cursor:"pointer"}},c))})})]}),i.jsx("div",{style:{height:32}}),i.jsx("button",{onClick:()=>{on||Du()},disabled:on,title:"Project Notes",style:{width:32,height:32,display:"grid",placeItems:"center",borderRadius:6,border:"1px solid #ddd",background:"#fff",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:i.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[i.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2",fill:"#fff",stroke:"#FFD700",strokeWidth:"1"}),i.jsx("circle",{cx:"6",cy:"7",r:"1.5",fill:"#000"}),i.jsx("rect",{x:"9",y:"6",width:"8",height:"2",rx:"1",fill:"#000"}),i.jsx("circle",{cx:"6",cy:"11",r:"1.5",fill:"#000"}),i.jsx("rect",{x:"9",y:"10",width:"8",height:"2",rx:"1",fill:"#000"}),i.jsx("circle",{cx:"6",cy:"15",r:"1.5",fill:"#000"}),i.jsx("rect",{x:"9",y:"14",width:"8",height:"2",rx:"1",fill:"#000"}),i.jsx("circle",{cx:"6",cy:"19",r:"1.5",fill:"#000"}),i.jsx("rect",{x:"9",y:"18",width:"8",height:"2",rx:"1",fill:"#000"})]})}),i.jsx("button",{onClick:()=>{on||Fl()},disabled:on,title:"Test Points",style:{width:32,height:32,display:"grid",placeItems:"center",borderRadius:6,border:"1px solid #ddd",background:"#fff",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:i.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[i.jsx("rect",{width:"24",height:"24",fill:"#FFD700"}),i.jsx("circle",{cx:"6",cy:"7",r:"1.5",fill:"#000"}),i.jsx("rect",{x:"9",y:"6",width:"8",height:"2",rx:"1",fill:"#000"}),i.jsx("circle",{cx:"6",cy:"11",r:"1.5",fill:"#000"}),i.jsx("rect",{x:"9",y:"10",width:"8",height:"2",rx:"1",fill:"#000"}),i.jsx("circle",{cx:"6",cy:"15",r:"1.5",fill:"#000"}),i.jsx("rect",{x:"9",y:"14",width:"8",height:"2",rx:"1",fill:"#000"}),i.jsx("circle",{cx:"6",cy:"19",r:"1.5",fill:"#000"}),i.jsx("rect",{x:"9",y:"18",width:"8",height:"2",rx:"1",fill:"#000"})]})})]}),k==="draw"&&Ge==="trace"&&du&&i.jsxs("div",{ref:fu,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[i.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[i.jsx("input",{type:"radio",name:"traceToolLayer",checked:_n==="top",onChange:()=>{console.log("Trace tool Top clicked"),Ka.current="top",ko("top"),tn("top"),te(Y),W(je),Tr(c=>{const g=new Map(c),A=g.get("trace");return A&&g.set("trace",{...A,settings:{color:Y,size:je}}),g}),nc(!1),To(!0),Hi(!0)}}),i.jsx("span",{children:"Top"})]}),i.jsxs("label",{className:"radio-label",children:[i.jsx("input",{type:"radio",name:"traceToolLayer",checked:_n==="bottom",onChange:()=>{console.log("Trace tool Bottom clicked"),Ka.current="bottom",ko("bottom"),tn("bottom"),te(J),W(de),Tr(c=>{const g=new Map(c),A=g.get("trace");return A&&g.set("trace",{...A,settings:{color:J,size:de}}),g}),nc(!1),qi(!0),oa(!0)}}),i.jsx("span",{children:"Bottom"})]})]}),k==="draw"&&Ge==="pad"&&rd&&i.jsxs("div",{ref:ku,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[i.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[i.jsx("input",{type:"radio",name:"padToolLayer",checked:qn==="top",onChange:()=>{console.log("Pad tool Top clicked"),Za.current="top",us("top"),tn("top");const c=Ln.get("padTop");te(c.color),W(c.size),Tr(g=>{const A=new Map(g),L=A.get("pad");return L&&A.set("pad",{...L,settings:{color:c.color,size:c.size}}),A}),xc(!1),To(!0),va(!0)}}),i.jsx("span",{children:"Top"})]}),i.jsxs("label",{className:"radio-label",children:[i.jsx("input",{type:"radio",name:"padToolLayer",checked:qn==="bottom",onChange:()=>{console.log("Pad tool Bottom clicked"),Za.current="bottom",us("bottom"),tn("bottom");const c=Ln.get("padBottom");te(c.color),W(c.size),Tr(g=>{const A=new Map(g),L=A.get("pad");return L&&A.set("pad",{...L,settings:{color:c.color,size:c.size}}),A}),xc(!1),qi(!0),x(!0)}}),i.jsx("span",{children:"Bottom"})]})]}),k==="draw"&&Ge==="testPoint"&&jd&&i.jsxs("div",{ref:hu,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[i.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[i.jsx("input",{type:"radio",name:"testPointToolLayer",checked:gi==="top",onChange:()=>{console.log("Test Point tool Top clicked"),ds.current="top",Mo("top"),tn("top"),te(se),W(Ye),Tr(c=>{const g=new Map(c),A=g.get("testPoint");return A&&g.set("testPoint",{...A,settings:{color:se,size:Ye}}),g}),pu(!1),To(!0),R(!0)}}),i.jsx("span",{children:"Top"})]}),i.jsxs("label",{className:"radio-label",children:[i.jsx("input",{type:"radio",name:"testPointToolLayer",checked:gi==="bottom",onChange:()=>{console.log("Test Point tool Bottom clicked"),ds.current="bottom",Mo("bottom"),tn("bottom"),te(xe),W(St),Tr(c=>{const g=new Map(c),A=g.get("testPoint");return A&&g.set("testPoint",{...A,settings:{color:xe,size:St}}),g}),pu(!1),qi(!0),ie(!0)}}),i.jsx("span",{children:"Bottom"})]})]}),xn&&i.jsxs("div",{ref:Au,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25,minWidth:"200px"},children:[i.jsx("div",{style:{marginBottom:"4px",fontWeight:600,fontSize:"12px",color:"#333"},children:"Select Power Bus:"}),pe.length===0?i.jsx("div",{style:{padding:"8px",color:"#666",fontSize:"12px"},children:"No power buses defined. Use Tools  Manage Power Buses to add one."}):[...pe].sort((c,g)=>{const A=oe=>{const z=oe.match(/([+-]?)(\d+\.?\d*)/);if(z){const Ae=z[1]||"+",Se=parseFloat(z[2]);return{absValue:Math.abs(Se),isNegative:Ae==="-",original:oe}}return{absValue:1/0,isNegative:!1,original:oe}},L=A(c.voltage),K=A(g.voltage);return L.absValue!==K.absValue?L.absValue-K.absValue:L.isNegative!==K.isNegative?L.isNegative?-1:1:0}).map(c=>i.jsx("button",{onClick:g=>{g.preventDefault(),g.stopPropagation(),Jn(c.id),k!=="power"&&(Qn(),y("power"),Xe(!0)),Un(!1)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#222"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("div",{style:{width:16,height:16,borderRadius:"50%",background:c.color,border:"1px solid #ccc"}}),i.jsxs("div",{children:[i.jsx("div",{style:{fontWeight:600,fontSize:"13px"},children:c.name}),i.jsx("div",{style:{fontSize:"11px",color:"#666"},children:c.voltage})]})]})},c.id)),i.jsx("div",{style:{height:1,background:"#ddd",margin:"4px 0"}}),i.jsx("button",{onClick:c=>{c.preventDefault(),c.stopPropagation(),Un(!1),pt(!0)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"11px"},children:"Manage Power Buses"}),i.jsx("button",{onClick:c=>{c.preventDefault(),c.stopPropagation(),Un(!1),Jn(null),y("select")},style:{display:"block",width:"100%",textAlign:"center",padding:"4px 6px",marginTop:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#666",fontSize:"11px"},children:"Cancel"})]}),Wo&&i.jsxs("div",{ref:od,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25,minWidth:"200px"},children:[i.jsx("div",{style:{marginBottom:"4px",fontWeight:600,fontSize:"12px",color:"#333"},children:"Select Ground Bus:"}),Ve.length===0?i.jsx("div",{style:{padding:"8px",color:"#666",fontSize:"12px"},children:"No ground buses defined. Use Tools  Manage Ground Buses to add one."}):[...Ve].sort((c,g)=>c.name.localeCompare(g.name)).map(c=>{const g=c.id==="groundbus-earth",A=nr===c.id;return i.jsx("button",{onClick:L=>{L.preventDefault(),L.stopPropagation(),yo(c.id),k!=="ground"&&(Qn(),y("ground"),Li(!0)),fi(!1)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:A?"#e0e0e0":"#f5f5f5",border:A?"2px solid #000":"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#222"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("div",{style:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:g?i.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",style:{display:"block"},children:[i.jsx("line",{x1:"10",y1:"2",x2:"10",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),i.jsx("line",{x1:"4",y1:"10",x2:"16",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),i.jsx("line",{x1:"5",y1:"12.5",x2:"15",y2:"12.5",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),i.jsx("line",{x1:"6",y1:"15",x2:"14",y2:"15",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"})]}):i.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",style:{display:"block"},children:[i.jsx("circle",{cx:"10",cy:"10",r:"6",fill:"none",stroke:"#000",strokeWidth:"2"}),i.jsx("line",{x1:"10",y1:"2",x2:"10",y2:"18",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),i.jsx("line",{x1:"2",y1:"10",x2:"18",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"})]})}),i.jsx("div",{children:i.jsx("div",{style:{fontWeight:600,fontSize:"13px"},children:c.name})})]})},c.id)}),i.jsx("div",{style:{height:1,background:"#ddd",margin:"4px 0"}}),i.jsx("button",{onClick:c=>{c.preventDefault(),c.stopPropagation(),fi(!1),ei(!0)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"11px"},children:"Manage Ground Buses"}),i.jsx("button",{onClick:c=>{c.preventDefault(),c.stopPropagation(),fi(!1),yo(null),y("select")},style:{display:"block",width:"100%",textAlign:"center",padding:"4px 6px",marginTop:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#666",fontSize:"11px"},children:"Cancel"})]}),i.jsxs("div",{style:{position:"absolute",top:6,left:60,bottom:6,width:168,padding:6,display:"flex",flexDirection:"column",gap:2,background:"rgba(250,250,255,0.95)",borderRadius:8,border:"1px solid #ddd",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:15},children:[i.jsx("div",{style:{fontSize:11,fontWeight:700,color:"#333",marginBottom:2},children:"Layers"}),i.jsxs("div",{onClick:()=>tn("top"),title:"Top layer",style:{cursor:"pointer",padding:2,borderRadius:4,border:zn==="top"?"2px solid #0b5fff":"1px solid #ddd",background:"#fff"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:2},children:[i.jsx("div",{style:{fontSize:10,color:"#444",fontWeight:600},children:"Top Image"}),i.jsx("label",{className:"radio-label",style:{margin:0},children:i.jsx("input",{type:"checkbox",checked:Ya,onChange:c=>To(c.target.checked)})})]}),i.jsx("canvas",{ref:Ss,width:60,height:40,style:{width:"60px",height:"40px"}})]}),i.jsxs("div",{onClick:()=>tn("bottom"),title:"Bottom layer",style:{cursor:"pointer",padding:2,borderRadius:4,border:zn==="bottom"?"2px solid #0b5fff":"1px solid #ddd",background:"#fff"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:2},children:[i.jsx("div",{style:{fontSize:10,color:"#444",fontWeight:600},children:"Bottom Image"}),i.jsx("label",{className:"radio-label",style:{margin:0},children:i.jsx("input",{type:"checkbox",checked:Ga,onChange:c=>qi(c.target.checked)})})]}),i.jsx("canvas",{ref:pc,width:60,height:40,style:{width:"60px",height:"40px"}})]}),i.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:ra,onChange:c=>ss(c.target.checked)}),i.jsx("span",{children:"Vias"})]}),i.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:Ra,onChange:c=>Hi(c.target.checked)}),i.jsx("span",{children:"Traces (Top)"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:re,onChange:c=>le(c.target.checked)}),i.jsx("span",{children:"Components (Top)"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:qo,onChange:c=>va(c.target.checked)}),i.jsx("span",{children:"Pads (Top)"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:N,onChange:c=>R(c.target.checked)}),i.jsx("span",{children:"Test Points (Top)"})]}),i.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:Co,onChange:c=>oa(c.target.checked)}),i.jsx("span",{children:"Traces (Bottom)"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:he,onChange:c=>Te(c.target.checked)}),i.jsx("span",{children:"Components (Bottom)"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:f,onChange:c=>x(c.target.checked)}),i.jsx("span",{children:"Pads (Bottom)"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:X,onChange:c=>ie(c.target.checked)}),i.jsx("span",{children:"Test Points (Bottom)"})]}),i.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:Ee,onChange:c=>Xe(c.target.checked)}),i.jsx("span",{children:"Power"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:ci,onChange:c=>Li(c.target.checked)}),i.jsx("span",{children:"Ground"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:Pi,onChange:c=>ur(c.target.checked)}),i.jsx("span",{children:"Connections"})]}),i.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:ra&&qo&&f&&N&&X&&Ra&&Co&&re&&he&&Ee&&ci&&Pi,onChange:c=>{const g=c.target.checked;ss(g),va(g),x(g),R(g),ie(g),Hi(g),oa(g),le(g),Te(g),Xe(g),Li(g),ur(g)}}),i.jsx("span",{style:{fontWeight:600,fontSize:11},children:"Select All Layers"})]}),i.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),i.jsxs("div",{style:{marginTop:6},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i.jsxs("label",{style:{fontSize:10,color:"#333"},children:["Transparency: ",v,"%"]}),i.jsxs("label",{className:"radio-label",style:{margin:0},children:[i.jsx("input",{type:"checkbox",checked:j,onChange:c=>{const g=c.target.checked;g?(To(!0),qi(!0)):(m(50),y("select")),_(g)}}),i.jsx("span",{style:{marginLeft:6,fontSize:10},children:"Cycle"})]})]}),i.jsx("input",{type:"range",min:"0",max:"100",value:v,onChange:c=>m(Number(c.target.value)),onDoubleClick:()=>Cp("transparency"),className:"slider",style:{width:"100%",marginTop:3}}),j&&i.jsxs("div",{style:{marginTop:6},children:[i.jsxs("label",{style:{fontSize:10,color:"#333"},children:["Cycle Speed: ",(M/1e3).toFixed(1),"s"]}),i.jsx("input",{type:"range",min:"500",max:"8000",step:"100",value:8500-M,onChange:c=>T(8500-Number(c.target.value)),onDoubleClick:()=>T(2e3),className:"slider",style:{width:"100%",marginTop:3}})]})]})]}),i.jsx(nw,{visible:!o&&!l&&!Cr,canvasSize:ws,canvasPosition:{left:244,top:6},onDismiss:()=>Xl(!0)}),i.jsx("canvas",{ref:Ct,width:ws.width,height:ws.height,tabIndex:0,onMouseDown:Nf,onMouseMove:Af,onMouseUp:Pf,onMouseLeave:Pf,onWheel:kf,onDoubleClick:Sp,className:`pcb-canvas ${k==="transform"?"transform-cursor":k==="draw"?"draw-cursor":k==="erase"?"erase-cursor":"default-cursor"}`,style:{position:"absolute",left:"244px",top:"6px",...Wr?{cursor:Wr}:k==="pan"?{cursor:ia?"grabbing":"grab"}:{},width:`${ws.width}px`,height:`${ws.height}px`,maxHeight:"none",aspectRatio:"auto",border:"none"}}),is&&i.jsxs("div",{style:{position:"absolute",left:`${244+ws.width-120}px`,top:`${6+ws.height+4}px`,fontSize:"11px",fontFamily:"monospace",color:"#333",backgroundColor:"rgba(255, 255, 255, 0.9)",padding:"2px 6px",borderRadius:"3px",border:"1px solid #ccc",pointerEvents:"none",zIndex:1e3},children:["(",is.x.toFixed(1),"mm, ",is.y.toFixed(1),"mm)"]}),i.jsx(fw,{componentEditor:Ua,setComponentEditor:Ea,componentsTop:Qt,componentsBottom:en,setComponentsTop:oi,setComponentsBottom:Ni,connectingPin:fo,setConnectingPin:Aa,componentDialogPosition:hs,setComponentDialogPosition:Qa,isDraggingDialog:Ys,setIsDraggingDialog:nu,dialogDragOffset:gs,setDialogDragOffset:iu,areComponentsLocked:er,setSelectedComponentIds:yn,setNotesDialogVisible:yr,projectDirHandle:ai,showAiSettingsDialog:ju,onAiSettingsDialogClose:()=>Ju(!1),onFindComponent:bf,componentDefinition:Ua?(()=>{const c=Qt.find(g=>g.id===Ua.id)||en.find(g=>g.id===Ua.id);return c?ll(c):void 0})():void 0,canvasHeight:ws.height}),xa&&Vo&&(()=>{const c=xa.component,g=xa.layer;if(!c)return null;const A=c.componentType||"Component",L=c.componentType==="IntegratedCircuit"&&"icType"in c?c.icType:null,K=id(c),oe=ll(c),z=oe?.category==="Semiconductors",Ae=c?.pinNames,Se=oe?.properties?.pinNames,_e=8,Pe=8,ke=200,me=150,be=10;let ye=xa.x+_e,Ce=xa.y+Pe;return ye+ke+be>window.innerWidth&&(ye=xa.x-ke-_e),Ce+me+be>window.innerHeight&&(Ce=xa.y-me-Pe),ye=Math.max(be,Math.min(ye,window.innerWidth-ke-be)),Ce=Math.max(be,Math.min(Ce,window.innerHeight-me-be)),i.jsxs("div",{style:{position:"fixed",left:`${ye}px`,top:`${Ce}px`,background:"rgba(0, 0, 0, 0.85)",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:"12px",lineHeight:"1.4",zIndex:1e4,pointerEvents:"none",width:"max-content",maxWidth:"400px",minWidth:"150px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)",wordWrap:"break-word",overflowWrap:"break-word"},children:[i.jsx("div",{style:{fontWeight:600,marginBottom:"4px"},children:Wl(A)}),i.jsxs("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:["Layer: ",g==="top"?"Top":"Bottom"]}),L&&i.jsxs("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:["IC Type: ",L]}),K.length>0&&i.jsx("div",{style:{marginBottom:"4px"},children:K.map((Ue,Le)=>i.jsx("div",{style:{color:"#e0e0e0",fontSize:"11px",marginBottom:"2px"},children:Ue},Le))}),c.description&&i.jsx("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:c.description}),c.notes&&i.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid rgba(255,255,255,0.2)",fontSize:"11px",color:"#d0d0d0",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:c.notes}),z&&c.pinCount>0&&(()=>{const Ue=Array.from({length:c.pinCount},(Le,Ze)=>{const bt=c.pinConnections&&c.pinConnections.length>Ze?c.pinConnections[Ze]:"",jt=Ae&&Ze<Ae.length?Ae[Ze]:"",It=Se&&Ze<Se.length?Se[Ze]:"",rt=It==="CHIP_DEPENDENT",Vt=jt&&jt.trim()!==""?jt:rt?"":It;return{pin:Ze+1,name:Vt||"-",nodeId:bt||"-"}});return i.jsxs("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid rgba(255,255,255,0.2)"},children:[i.jsx("div",{style:{fontSize:"11px",fontWeight:600,marginBottom:"4px",color:"#fff"},children:"Pin Connections:"}),i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.3)"},children:[i.jsx("th",{style:{textAlign:"left",padding:"2px 6px",fontWeight:600,color:"#fff"},children:"Pin"}),i.jsx("th",{style:{textAlign:"left",padding:"2px 6px",fontWeight:600,color:"#fff"},children:"Name"}),i.jsx("th",{style:{textAlign:"left",padding:"2px 6px",fontWeight:600,color:"#fff"},children:"Node ID"})]})}),i.jsx("tbody",{children:Ue.map((Le,Ze)=>i.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[i.jsx("td",{style:{padding:"2px 6px",color:"#e0e0e0",fontFamily:"monospace"},children:Le.pin}),i.jsx("td",{style:{padding:"2px 6px",color:"#e0e0e0",fontStyle:Le.name!=="-"?"italic":"normal"},children:Le.name}),i.jsx("td",{style:{padding:"2px 6px",color:"#e0e0e0",fontFamily:"monospace"},children:Le.nodeId})]},Ze))})]})]})})()]})})(),Ic&&Vo&&(()=>{const c=Ic.stroke;return c.notes?i.jsxs("div",{style:{position:"fixed",left:`${Ic.x+10}px`,top:`${Ic.y+10}px`,background:"rgba(0, 0, 0, 0.85)",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:"12px",lineHeight:"1.4",zIndex:1e4,pointerEvents:"none",width:"max-content",maxWidth:"400px",minWidth:"150px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)",wordWrap:"break-word",overflowWrap:"break-word"},children:[i.jsx("div",{style:{fontWeight:600,marginBottom:"4px"},children:"Test Point"}),i.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid rgba(255,255,255,0.2)",fontSize:"11px",color:"#d0d0d0",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:c.notes})]}):null})(),Gr&&Vo&&(()=>{const c=Gr.component,g=Gr.pinIndices,A=c.pinData,L=c.pinNames,oe=ll(c)?.properties?.pinNames,z=g.map(ye=>{let Ce=`Pin ${ye+1}`;if(A&&ye<A.length&&A[ye]?.name?.trim())Ce=A[ye].name.trim();else if(L&&ye<L.length&&L[ye]?.trim())Ce=L[ye].trim();else if(oe&&ye<oe.length){const Le=oe[ye];Le&&Le!=="CHIP_DEPENDENT"&&(Ce=Le)}const Ue=A&&ye<A.length?A[ye]?.type?.trim():void 0;return{pinNumber:ye+1,pinName:Ce,pinType:Ue||void 0}}),Ae=10,Se=10;let _e=Gr.x+Ae,Pe=Gr.y+Se;const ke=180,me=80+z.length*20,be=10;return _e+ke+be>window.innerWidth&&(_e=Gr.x-ke-Ae),Pe+me+be>window.innerHeight&&(Pe=Gr.y-me-Se),_e=Math.max(be,_e),Pe=Math.max(be,Pe),i.jsxs("div",{style:{position:"fixed",left:`${_e}px`,top:`${Pe}px`,background:"rgba(0, 0, 0, 0.90)",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:"12px",lineHeight:"1.4",zIndex:1e4,pointerEvents:"none",width:"max-content",maxWidth:"300px",minWidth:"120px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)",border:"1px solid rgba(100, 180, 255, 0.5)"},children:[i.jsxs("div",{style:{fontWeight:600,marginBottom:"6px",color:"#90caf9"},children:[c.designator," Connection"]}),i.jsxs("div",{style:{fontSize:"11px",marginBottom:"4px",color:"#bbb"},children:["Node ID: ",i.jsx("span",{style:{fontFamily:"monospace",color:"#fff"},children:Gr.nodeId})]}),z.map((ye,Ce)=>i.jsxs("div",{style:{marginTop:Ce>0?"6px":"0",paddingTop:Ce>0?"6px":"0",borderTop:Ce>0?"1px solid rgba(255,255,255,0.15)":"none"},children:[i.jsxs("div",{style:{fontSize:"11px",color:"#e0e0e0"},children:[i.jsxs("span",{style:{fontWeight:500},children:["Pin ",ye.pinNumber,":"]})," ",i.jsx("span",{style:{fontStyle:"italic",color:"#fff"},children:ye.pinName})]}),ye.pinType&&i.jsxs("div",{style:{fontSize:"10px",marginTop:"2px",color:"#90caf9"},children:["Type: ",ye.pinType]})]},Ce))]})})(),Bn&&Bn.visible&&(()=>{if(!fe.find(A=>A.id===Bn.id))return null;const g=pe.find(A=>A.id===Bn.powerBusId);return i.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#fff",border:"1px solid #0b5fff",borderRadius:4,padding:"6px",boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"175px",maxWidth:"250px",maxHeight:"40vh",overflowY:"auto",pointerEvents:"auto"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"5px"},children:[i.jsx("h3",{style:{margin:0,fontSize:"12px",color:"#333",fontWeight:600},children:"Power Properties"}),i.jsx("button",{onClick:()=>di(null),style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#666",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Power Bus:"}),i.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:g?`${g.name} (${g.voltage})`:"Unknown"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:`power-layer-${Bn.id}`,style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Layer:"}),i.jsxs("select",{id:`power-layer-${Bn.id}`,name:`power-layer-${Bn.id}`,value:Bn.layer,onChange:A=>di({...Bn,layer:A.target.value}),disabled:tr,style:{width:"100%",padding:"2px 3px",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",opacity:tr?.6:1},children:[i.jsx("option",{value:"top",children:"Top"}),i.jsx("option",{value:"bottom",children:"Bottom"})]})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"X:"}),i.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:Bn.x.toFixed(2)})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Y:"}),i.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:Bn.y.toFixed(2)})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"3px",marginTop:"6px"},children:[i.jsx("button",{onClick:()=>di(null),style:{padding:"2px 5px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,cursor:"pointer",fontSize:"10px",color:"#333"},children:"Cancel"}),i.jsx("button",{onClick:()=>{tr||($t(A=>A.map(L=>L.id===Bn.id?{...L,layer:Bn.layer}:L)),di(null))},disabled:tr,style:{padding:"2px 5px",background:tr?"#f5f5f5":"#0b5fff",color:tr?"#999":"#fff",border:"1px solid #ddd",borderRadius:2,cursor:tr?"not-allowed":"pointer",fontSize:"10px"},children:"Save"})]})]})})(),!o&&!l&&i.jsx("div",{className:"placeholder"})]})}),i.jsx(mw,{visible:Je,onClose:()=>pt(!1),powerBuses:pe,setPowerBuses:Be,editingPowerBusId:Qe,setEditingPowerBusId:yt,powers:fe}),i.jsx(bw,{visible:Gn,onClose:()=>ei(!1),groundBuses:Ve,setGroundBuses:gt,editingGroundBusId:wr,setEditingGroundBusId:Ho,grounds:Re}),i.jsx(jw,{visible:vt,projectDirHandle:ai,onClose:()=>{Ft(!1),bn(void 0)},onRestore:dd,position:Nt,isDragging:gn,onDragStart:Ru}),i.jsx(vw,{visible:cr,onClose:()=>Xr(!1),autoAssignDesignators:Er,setAutoAssignDesignators:si,useGlobalDesignatorCounters:ki,setUseGlobalDesignatorCounters:lr}),i.jsx("input",{ref:ou,type:"file",accept:".png,.jpg,.jpeg,image/png,image/jpeg",style:{display:"none"},onChange:c=>{const g=c.target.files?.[0];g&&Id(g,"top"),c.target.value=""}}),i.jsx("input",{ref:ms,type:"file",accept:".png,.jpg,.jpeg,image/png,image/jpeg",style:{display:"none"},onChange:c=>{const g=c.target.files?.[0];g&&Id(g,"bottom"),c.target.value=""}}),i.jsx("input",{ref:hl,type:"file",accept:".json,application/json",style:{display:"none"},onChange:async c=>{const g=c.target.files?.[0];if(g)try{zh(),await new Promise(z=>setTimeout(z,0)),sr(g.name);const A=await g.text(),L=JSON.parse(A);await oc(L,null);let oe;if(L.projectInfo?.name)oe=L.projectInfo.name;else{if(oe=g.name.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_"),!oe){console.error("Failed to extract project name from filename"),alert("Warning: Could not determine project name from filename. Please ensure the project file has a valid name.");return}Do(oe)}io||Do(oe),setTimeout(async()=>{await Bd(5,!0)},100)}catch(A){console.error("Failed to open project",A),alert("Failed to open project file. See console for details.")}c.target.value=""}}),i.jsx(iw,{visible:Fo.visible,selectedIds:wn,selectedComponentIds:Mn,selectedPowerIds:Ri,selectedGroundIds:ji,drawingStrokes:dt,componentsTop:Qt,componentsBottom:en,powers:fe,grounds:Re,powerBuses:pe,onClose:()=>{$r({visible:!1,text:""})},setComponentsTop:oi,setComponentsBottom:Ni,determineViaType:vl,determinePadType:tc,determineTestPointType:Il,onFindComponent:bf,onFindStroke:kh,onFindPower:vf,onFindGround:fp,onOpenNotesDialog:()=>yr(!0),position:Ki,isDragging:Dn,onDragStart:c=>{Ki&&(Ts({x:c.clientX-Ki.x,y:c.clientY-Ki.y}),Zi(!0),c.preventDefault())},canvasHeight:ws.height}),i.jsx(rw,{visible:Sa,selectedIds:wn,selectedComponentIds:Mn,selectedPowerIds:Ri,selectedGroundIds:ji,drawingStrokes:dt,componentsTop:Qt,componentsBottom:en,powers:fe,grounds:Re,powerBuses:pe,onClose:()=>{yr(!1)},setComponentsTop:oi,setComponentsBottom:Ni,setDrawingStrokes:Mt,setPowerSymbols:$t,setGroundSymbols:rn,determineViaType:vl,determinePadType:tc,determineTestPointType:Il,position:Cs,isDragging:Mc,onDragStart:c=>{Cs&&(Nu({x:c.clientX-Cs.x,y:c.clientY-Cs.y}),Ir(!0),c.preventDefault())}}),i.jsx(ow,{visible:lu,projectNotes:Ql,setProjectNotes:La,projectMetadata:Qu,setProjectMetadata:zl,onClose:()=>{el(!1)},position:so,isDragging:hc,onDragStart:c=>{so?(Dl({x:c.clientX-so.x,y:c.clientY-so.y}),xl(!0),c.preventDefault()):(Or({x:c.clientX-300,y:c.clientY-200}),Dl({x:300,y:200}),xl(!0),c.preventDefault())}}),i.jsx(aw,{visible:Is,drawingStrokes:dt,onClose:()=>{cu(!1)},onFindTestPoint:pp,position:tl,isDragging:Oc,onDragStart:c=>{tl?(uu({x:c.clientX-tl.x,y:c.clientY-tl.y}),nl(!0),c.preventDefault()):(ec({x:c.clientX-300,y:c.clientY-200}),uu({x:300,y:200}),nl(!0),c.preventDefault())},determineTestPointType:Il,powerBuses:pe}),i.jsx(ww,{visible:Xs.visible,title:"New Project",message:"You have unsaved changes. Do you want to save your project before creating a new one?",onYes:ud,onNo:Rf,onCancel:Vl,yesButtonRef:su}),Zn.visible&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10002},onClick:c=>{c.target===c.currentTarget&&Wd()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:c=>c.stopPropagation(),children:[i.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"New Project"}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Project Name:"}),i.jsx("input",{ref:Zl,type:"text",value:Zn.projectName,onChange:c=>{xs(g=>({...g,projectName:c.target.value}))},onKeyDown:c=>{c.key==="Enter"?(c.preventDefault(),ks()):c.key==="Escape"&&(c.preventDefault(),Wd())},style:{width:"100%",padding:"8px 12px",marginBottom:"8px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},placeholder:"e.g., my_pcb_project",autoFocus:!0}),Zn.projectName&&(()=>{const c=Zn.projectName.match(/[^a-zA-Z0-9_-]/g);if(c){const g=[...new Set(c)];return i.jsxs("div",{style:{marginBottom:"12px",padding:"6px 10px",background:"#3a1f1f",border:"1px solid #a44",borderRadius:4,fontSize:"12px",color:"#ffaaaa"},children:["Invalid characters: ",g.map(A=>`"${A}"`).join(", "),". Only letters, numbers, underscore (_), and hyphen (-) are allowed."]})}return null})(),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Location:"}),i.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"8px"},children:[i.jsx("input",{type:"text",value:Zn.locationPath||"Not selected",readOnly:!0,style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:Zn.locationPath?"#f2f2f2":"#888",fontSize:"14px",cursor:"not-allowed"},placeholder:"Select a location..."}),i.jsx("button",{onClick:Ap,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500,whiteSpace:"nowrap"},children:"Browse..."})]}),i.jsx("div",{style:{marginBottom:"12px",padding:"6px 10px",background:"#2a2a2f",border:"1px solid #444",borderRadius:4,fontSize:"11px",color:"#aaa",fontStyle:"italic"},children:"Note: Select an existing parent directory. The project directory will be created automatically when you click Create."}),Zn.projectName&&Zn.locationPath&&i.jsxs("div",{style:{marginBottom:"20px",padding:"8px 12px",background:"#1a1a1f",border:"1px solid #333",borderRadius:6,fontSize:"12px",color:"#aaa",fontFamily:"monospace"},children:[i.jsx("div",{style:{marginBottom:"4px",color:"#888"},children:"Project will be created at:"}),i.jsx("div",{style:{color:"#4CAF50"},children:(()=>{if(!Zn.projectName||!Zn.locationPath)return"";const g=Zn.projectName.trim().replace(/[^a-zA-Z0-9_-]/g,"_");if(!g)return"";const A=`${g}.json`;return Zn.locationPath===g?`${Zn.locationPath}/${A}`:`${Zn.locationPath}/${g}/${A}`})()})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[i.jsx("button",{onClick:Wd,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:ks,disabled:!Zn.projectName.trim()||!Zn.locationHandle,style:{padding:"8px 16px",background:!Zn.projectName.trim()||!Zn.locationHandle?"#555":"#4CAF50",color:"#fff",border:"1px solid "+(!Zn.projectName.trim()||!Zn.locationHandle?"#666":"#45a049"),borderRadius:6,cursor:!Zn.projectName.trim()||!Zn.locationHandle?"not-allowed":"pointer",fontSize:"14px",fontWeight:600,opacity:!Zn.projectName.trim()||!Zn.locationHandle?.6:1},children:"Create"})]})]})}),Gi.visible&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10002},onClick:c=>{c.target===c.currentTarget&&El()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:c=>c.stopPropagation(),children:[i.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Save As"}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"File Name:"}),i.jsx("input",{ref:gl,type:"text",value:Gi.filename,onChange:c=>{ea(g=>({...g,filename:c.target.value}))},onKeyDown:c=>{c.key==="Enter"?(c.preventDefault(),$c()):c.key==="Escape"&&(c.preventDefault(),El())},style:{width:"100%",padding:"8px 12px",marginBottom:"8px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},placeholder:"e.g., my_project.json",autoFocus:!0}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Location:"}),i.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[i.jsx("input",{type:"text",value:Gi.locationPath||"Not selected",readOnly:!0,style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:Gi.locationPath?"#f2f2f2":"#888",fontSize:"14px",cursor:"not-allowed"},placeholder:"Select a location..."}),i.jsx("button",{onClick:jc,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500,whiteSpace:"nowrap"},children:"Browse..."})]}),Gi.filename&&Gi.locationPath&&i.jsxs("div",{style:{marginBottom:"20px",padding:"8px 12px",background:"#1a1a1f",border:"1px solid #333",borderRadius:6,fontSize:"12px",color:"#aaa",fontFamily:"monospace"},children:[i.jsx("div",{style:{marginBottom:"4px",color:"#888"},children:"File will be saved at:"}),i.jsxs("div",{style:{color:"#4CAF50"},children:[Gi.locationPath,"/",Gi.filename.endsWith(".json")?Gi.filename:`${Gi.filename}.json`]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[i.jsx("button",{onClick:El,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:$c,disabled:!Gi.filename.trim()||!Gi.locationHandle,style:{padding:"8px 16px",background:!Gi.filename.trim()||!Gi.locationHandle?"#555":"#4CAF50",color:"#fff",border:"1px solid "+(!Gi.filename.trim()||!Gi.locationHandle?"#666":"#45a049"),borderRadius:6,cursor:!Gi.filename.trim()||!Gi.locationHandle?"not-allowed":"pointer",fontSize:"14px",fontWeight:600,opacity:!Gi.filename.trim()||!Gi.locationHandle?.6:1},children:"Save"})]})]})}),i.jsx(nm,{visible:Ds.visible,title:Ds.title,message:Ds.message,onClose:()=>Qo({visible:!1,title:"",message:""})}),i.jsx(sw,{visible:qc,dimensions:Td,onSave:c=>{ol(c)},onClose:()=>Hc(!1)}),i.jsx(lw,{visible:_c,onClose:()=>{let c=0,g=0;o?(c=o.x,g=o.y):l&&(c=l.x,g=l.y),vs(A=>({...A,0:{pcbReferenceX:c,pcbReferenceY:g,x:0,y:0,zoom:xt,viewRotation:ui,viewFlipX:ut,isBottomView:qa,transparency:v,showTopImage:Ya,showBottomImage:Ga,showViasLayer:ra,showTopTracesLayer:Ra,showBottomTracesLayer:Co,showTopPadsLayer:qo,showBottomPadsLayer:f,showTopTestPointsLayer:N,showBottomTestPointsLayer:X,showTopComponents:re,showBottomComponents:he,showPowerLayer:Ee,showGroundLayer:ci,showConnectionsLayer:Pi}})),Ks(!1)},topImage:o,bottomImage:l,selectedImageForTransform:zn,setSelectedImageForTransform:Bi,transformMode:fr,setTransformMode:zr,updateImageTransform:Ol,resetImageTransform:Ld,setCurrentTool:y,isGrayscale:F,setIsGrayscale:P,areImagesLocked:ar}),i.jsx(cw,{visible:Nl,onClose:()=>Eo(!1),topImage:o,bottomImage:l,setTopImage:s,setBottomImage:d,componentsTop:Qt,componentsBottom:en,setComponentsTop:oi,setComponentsBottom:Ni,drawingStrokes:dt,setDrawingStrokes:Mt,powerSymbols:fe,groundSymbols:Re,setPowerSymbols:$t,setGroundSymbols:rn,canvasRef:Ct,isBottomView:qa,setIsBottomView:hr,originalTopFlipX:Xi,setOriginalTopFlipX:gr,originalBottomFlipX:vo,setOriginalBottomFlipX:rs,originalTopFlipY:Zs,setOriginalTopFlipY:fc,originalBottomFlipY:ru,setOriginalBottomFlipY:Ku,cameraWorldCenter:En,setCameraWorldCenter:Zt,viewScale:xt,viewRotation:ui,setViewRotation:Si,viewFlipX:ut,setViewFlipX:Et,contentBorder:5,setTransparency:m}),i.jsx(xw,{visible:xp,selectedLayer:Ei,selectedComponentType:Ml,selectedComponentKey:mp,onLayerChange:c=>{zs(c),Ur.current=c,tn(c),te(c==="top"?ge:_t),W(c==="top"?ht:Yt),c==="top"?(To(!0),le(!0)):(qi(!0),Te(!0))},onComponentTypeChange:(c,g,A)=>{Nd(c),kd(g),Sf(A||null),Ad.current=c},onClose:()=>{mc(!1),ca(!0),y("select")}}),i.jsx(Sw,{visible:_a.visible,size:_a.size,onSizeChange:c=>ts(g=>({...g,size:c})),onApply:Sc,onCancel:()=>ts({visible:!1,size:6})}),i.jsx(Tw,{visible:Gs.visible,interval:Gs.interval,onIntervalChange:c=>Po({visible:!0,interval:c}),onApply:()=>Bd(Gs.interval,!1),onCancel:()=>Po({visible:!1,interval:5})}),i.jsx(Cw,{visible:ns.visible,interval:ns.interval,onIntervalChange:c=>ho({...ns,interval:c}),onEnable:()=>Bd(ns.interval,!0),onSkip:_f}),i.jsx(_w,{visible:Sd,isPad:bl,onConfirm:c=>{td({numPins:c.numPins,type:c.type,twoSidedOrientation:c.twoSidedOrientation,point1:{x:0,y:0},point2:{x:0,y:0}}),nd(!0),y("select"),ml(!1)},onClose:()=>{ml(!1)}})]})}c2.createRoot(document.getElementById("root")).render(i.jsx(I.StrictMode,{children:i.jsx(Kw,{})}));export{Hr as _,Zw as c,Qm as g};

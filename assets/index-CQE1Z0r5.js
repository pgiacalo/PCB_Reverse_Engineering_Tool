(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const R of document.querySelectorAll('link[rel="modulepreload"]'))d(R);new MutationObserver(R=>{for(const I of R)if(I.type==="childList")for(const xe of I.addedNodes)xe.tagName==="LINK"&&xe.rel==="modulepreload"&&d(xe)}).observe(document,{childList:!0,subtree:!0});function g(R){const I={};return R.integrity&&(I.integrity=R.integrity),R.referrerPolicy&&(I.referrerPolicy=R.referrerPolicy),R.crossOrigin==="use-credentials"?I.credentials="include":R.crossOrigin==="anonymous"?I.credentials="omit":I.credentials="same-origin",I}function d(R){if(R.ep)return;R.ep=!0;const I=g(R);fetch(R.href,I)}})();function Ug(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var Hf={exports:{}},Id={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yh;function Pg(){if(yh)return Id;yh=1;var c=Symbol.for("react.transitional.element"),u=Symbol.for("react.fragment");function g(d,R,I){var xe=null;if(I!==void 0&&(xe=""+I),R.key!==void 0&&(xe=""+R.key),"key"in R){I={};for(var q in R)q!=="key"&&(I[q]=R[q])}else I=R;return R=I.ref,{$$typeof:c,type:d,key:xe,ref:R!==void 0?R:null,props:I}}return Id.Fragment=u,Id.jsx=g,Id.jsxs=g,Id}var bh;function Og(){return bh||(bh=1,Hf.exports=Pg()),Hf.exports}var n=Og(),If={exports:{}},zt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mh;function Eg(){if(mh)return zt;mh=1;var c=Symbol.for("react.transitional.element"),u=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),I=Symbol.for("react.consumer"),xe=Symbol.for("react.context"),q=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),V=Symbol.for("react.memo"),ue=Symbol.for("react.lazy"),he=Symbol.for("react.activity"),Ce=Symbol.iterator;function Me(S){return S===null||typeof S!="object"?null:(S=Ce&&S[Ce]||S["@@iterator"],typeof S=="function"?S:null)}var se={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Be=Object.assign,B={};function te(S,A,$){this.props=S,this.context=A,this.refs=B,this.updater=$||se}te.prototype.isReactComponent={},te.prototype.setState=function(S,A){if(typeof S!="object"&&typeof S!="function"&&S!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,S,A,"setState")},te.prototype.forceUpdate=function(S){this.updater.enqueueForceUpdate(this,S,"forceUpdate")};function Le(){}Le.prototype=te.prototype;function J(S,A,$){this.props=S,this.context=A,this.refs=B,this.updater=$||se}var ne=J.prototype=new Le;ne.constructor=J,Be(ne,te.prototype),ne.isPureReactComponent=!0;var M=Array.isArray;function z(){}var D={H:null,A:null,T:null,S:null},P=Object.prototype.hasOwnProperty;function E(S,A,$){var Z=$.ref;return{$$typeof:c,type:S,key:A,ref:Z!==void 0?Z:null,props:$}}function pe(S,A){return E(S.type,A,S.props)}function W(S){return typeof S=="object"&&S!==null&&S.$$typeof===c}function j(S){var A={"=":"=0",":":"=2"};return"$"+S.replace(/[=:]/g,function($){return A[$]})}var me=/\/+/g;function be(S,A){return typeof S=="object"&&S!==null&&S.key!=null?j(""+S.key):A.toString(36)}function re(S){switch(S.status){case"fulfilled":return S.value;case"rejected":throw S.reason;default:switch(typeof S.status=="string"?S.then(z,z):(S.status="pending",S.then(function(A){S.status==="pending"&&(S.status="fulfilled",S.value=A)},function(A){S.status==="pending"&&(S.status="rejected",S.reason=A)})),S.status){case"fulfilled":return S.value;case"rejected":throw S.reason}}throw S}function _(S,A,$,Z,Oe){var Ge=typeof S;(Ge==="undefined"||Ge==="boolean")&&(S=null);var Xe=!1;if(S===null)Xe=!0;else switch(Ge){case"bigint":case"string":case"number":Xe=!0;break;case"object":switch(S.$$typeof){case c:case u:Xe=!0;break;case ue:return Xe=S._init,_(Xe(S._payload),A,$,Z,Oe)}}if(Xe)return Oe=Oe(S),Xe=Z===""?"."+be(S,0):Z,M(Oe)?($="",Xe!=null&&($=Xe.replace(me,"$&/")+"/"),_(Oe,A,$,"",function(_n){return _n})):Oe!=null&&(W(Oe)&&(Oe=pe(Oe,$+(Oe.key==null||S&&S.key===Oe.key?"":(""+Oe.key).replace(me,"$&/")+"/")+Xe)),A.push(Oe)),1;Xe=0;var xt=Z===""?".":Z+":";if(M(S))for(var Pe=0;Pe<S.length;Pe++)Z=S[Pe],Ge=xt+be(Z,Pe),Xe+=_(Z,A,$,Ge,Oe);else if(Pe=Me(S),typeof Pe=="function")for(S=Pe.call(S),Pe=0;!(Z=S.next()).done;)Z=Z.value,Ge=xt+be(Z,Pe++),Xe+=_(Z,A,$,Ge,Oe);else if(Ge==="object"){if(typeof S.then=="function")return _(re(S),A,$,Z,Oe);throw A=String(S),Error("Objects are not valid as a React child (found: "+(A==="[object Object]"?"object with keys {"+Object.keys(S).join(", ")+"}":A)+"). If you meant to render a collection of children, use an array instead.")}return Xe}function O(S,A,$){if(S==null)return S;var Z=[],Oe=0;return _(S,Z,"","",function(Ge){return A.call($,Ge,Oe++)}),Z}function Y(S){if(S._status===-1){var A=S._result;A=A(),A.then(function($){(S._status===0||S._status===-1)&&(S._status=1,S._result=$)},function($){(S._status===0||S._status===-1)&&(S._status=2,S._result=$)}),S._status===-1&&(S._status=0,S._result=A)}if(S._status===1)return S._result.default;throw S._result}var je=typeof reportError=="function"?reportError:function(S){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var A=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof S=="object"&&S!==null&&typeof S.message=="string"?String(S.message):String(S),error:S});if(!window.dispatchEvent(A))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",S);return}console.error(S)},L={map:O,forEach:function(S,A,$){O(S,function(){A.apply(this,arguments)},$)},count:function(S){var A=0;return O(S,function(){A++}),A},toArray:function(S){return O(S,function(A){return A})||[]},only:function(S){if(!W(S))throw Error("React.Children.only expected to receive a single React element child.");return S}};return zt.Activity=he,zt.Children=L,zt.Component=te,zt.Fragment=g,zt.Profiler=R,zt.PureComponent=J,zt.StrictMode=d,zt.Suspense=p,zt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,zt.__COMPILER_RUNTIME={__proto__:null,c:function(S){return D.H.useMemoCache(S)}},zt.cache=function(S){return function(){return S.apply(null,arguments)}},zt.cacheSignal=function(){return null},zt.cloneElement=function(S,A,$){if(S==null)throw Error("The argument must be a React element, but you passed "+S+".");var Z=Be({},S.props),Oe=S.key;if(A!=null)for(Ge in A.key!==void 0&&(Oe=""+A.key),A)!P.call(A,Ge)||Ge==="key"||Ge==="__self"||Ge==="__source"||Ge==="ref"&&A.ref===void 0||(Z[Ge]=A[Ge]);var Ge=arguments.length-2;if(Ge===1)Z.children=$;else if(1<Ge){for(var Xe=Array(Ge),xt=0;xt<Ge;xt++)Xe[xt]=arguments[xt+2];Z.children=Xe}return E(S.type,Oe,Z)},zt.createContext=function(S){return S={$$typeof:xe,_currentValue:S,_currentValue2:S,_threadCount:0,Provider:null,Consumer:null},S.Provider=S,S.Consumer={$$typeof:I,_context:S},S},zt.createElement=function(S,A,$){var Z,Oe={},Ge=null;if(A!=null)for(Z in A.key!==void 0&&(Ge=""+A.key),A)P.call(A,Z)&&Z!=="key"&&Z!=="__self"&&Z!=="__source"&&(Oe[Z]=A[Z]);var Xe=arguments.length-2;if(Xe===1)Oe.children=$;else if(1<Xe){for(var xt=Array(Xe),Pe=0;Pe<Xe;Pe++)xt[Pe]=arguments[Pe+2];Oe.children=xt}if(S&&S.defaultProps)for(Z in Xe=S.defaultProps,Xe)Oe[Z]===void 0&&(Oe[Z]=Xe[Z]);return E(S,Ge,Oe)},zt.createRef=function(){return{current:null}},zt.forwardRef=function(S){return{$$typeof:q,render:S}},zt.isValidElement=W,zt.lazy=function(S){return{$$typeof:ue,_payload:{_status:-1,_result:S},_init:Y}},zt.memo=function(S,A){return{$$typeof:V,type:S,compare:A===void 0?null:A}},zt.startTransition=function(S){var A=D.T,$={};D.T=$;try{var Z=S(),Oe=D.S;Oe!==null&&Oe($,Z),typeof Z=="object"&&Z!==null&&typeof Z.then=="function"&&Z.then(z,je)}catch(Ge){je(Ge)}finally{A!==null&&$.types!==null&&(A.types=$.types),D.T=A}},zt.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},zt.use=function(S){return D.H.use(S)},zt.useActionState=function(S,A,$){return D.H.useActionState(S,A,$)},zt.useCallback=function(S,A){return D.H.useCallback(S,A)},zt.useContext=function(S){return D.H.useContext(S)},zt.useDebugValue=function(){},zt.useDeferredValue=function(S,A){return D.H.useDeferredValue(S,A)},zt.useEffect=function(S,A){return D.H.useEffect(S,A)},zt.useEffectEvent=function(S){return D.H.useEffectEvent(S)},zt.useId=function(){return D.H.useId()},zt.useImperativeHandle=function(S,A,$){return D.H.useImperativeHandle(S,A,$)},zt.useInsertionEffect=function(S,A){return D.H.useInsertionEffect(S,A)},zt.useLayoutEffect=function(S,A){return D.H.useLayoutEffect(S,A)},zt.useMemo=function(S,A){return D.H.useMemo(S,A)},zt.useOptimistic=function(S,A){return D.H.useOptimistic(S,A)},zt.useReducer=function(S,A,$){return D.H.useReducer(S,A,$)},zt.useRef=function(S){return D.H.useRef(S)},zt.useState=function(S){return D.H.useState(S)},zt.useSyncExternalStore=function(S,A,$){return D.H.useSyncExternalStore(S,A,$)},zt.useTransition=function(){return D.H.useTransition()},zt.version="19.2.0",zt}var vh;function ep(){return vh||(vh=1,If.exports=Eg()),If.exports}var b=ep();const _e=Ug(b);var Vf={exports:{}},Vd={},Wf={exports:{}},Ff={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sh;function _g(){return Sh||(Sh=1,(function(c){function u(_,O){var Y=_.length;_.push(O);e:for(;0<Y;){var je=Y-1>>>1,L=_[je];if(0<R(L,O))_[je]=O,_[Y]=L,Y=je;else break e}}function g(_){return _.length===0?null:_[0]}function d(_){if(_.length===0)return null;var O=_[0],Y=_.pop();if(Y!==O){_[0]=Y;e:for(var je=0,L=_.length,S=L>>>1;je<S;){var A=2*(je+1)-1,$=_[A],Z=A+1,Oe=_[Z];if(0>R($,Y))Z<L&&0>R(Oe,$)?(_[je]=Oe,_[Z]=Y,je=Z):(_[je]=$,_[A]=Y,je=A);else if(Z<L&&0>R(Oe,Y))_[je]=Oe,_[Z]=Y,je=Z;else break e}}return O}function R(_,O){var Y=_.sortIndex-O.sortIndex;return Y!==0?Y:_.id-O.id}if(c.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var I=performance;c.unstable_now=function(){return I.now()}}else{var xe=Date,q=xe.now();c.unstable_now=function(){return xe.now()-q}}var p=[],V=[],ue=1,he=null,Ce=3,Me=!1,se=!1,Be=!1,B=!1,te=typeof setTimeout=="function"?setTimeout:null,Le=typeof clearTimeout=="function"?clearTimeout:null,J=typeof setImmediate<"u"?setImmediate:null;function ne(_){for(var O=g(V);O!==null;){if(O.callback===null)d(V);else if(O.startTime<=_)d(V),O.sortIndex=O.expirationTime,u(p,O);else break;O=g(V)}}function M(_){if(Be=!1,ne(_),!se)if(g(p)!==null)se=!0,z||(z=!0,j());else{var O=g(V);O!==null&&re(M,O.startTime-_)}}var z=!1,D=-1,P=5,E=-1;function pe(){return B?!0:!(c.unstable_now()-E<P)}function W(){if(B=!1,z){var _=c.unstable_now();E=_;var O=!0;try{e:{se=!1,Be&&(Be=!1,Le(D),D=-1),Me=!0;var Y=Ce;try{t:{for(ne(_),he=g(p);he!==null&&!(he.expirationTime>_&&pe());){var je=he.callback;if(typeof je=="function"){he.callback=null,Ce=he.priorityLevel;var L=je(he.expirationTime<=_);if(_=c.unstable_now(),typeof L=="function"){he.callback=L,ne(_),O=!0;break t}he===g(p)&&d(p),ne(_)}else d(p);he=g(p)}if(he!==null)O=!0;else{var S=g(V);S!==null&&re(M,S.startTime-_),O=!1}}break e}finally{he=null,Ce=Y,Me=!1}O=void 0}}finally{O?j():z=!1}}}var j;if(typeof J=="function")j=function(){J(W)};else if(typeof MessageChannel<"u"){var me=new MessageChannel,be=me.port2;me.port1.onmessage=W,j=function(){be.postMessage(null)}}else j=function(){te(W,0)};function re(_,O){D=te(function(){_(c.unstable_now())},O)}c.unstable_IdlePriority=5,c.unstable_ImmediatePriority=1,c.unstable_LowPriority=4,c.unstable_NormalPriority=3,c.unstable_Profiling=null,c.unstable_UserBlockingPriority=2,c.unstable_cancelCallback=function(_){_.callback=null},c.unstable_forceFrameRate=function(_){0>_||125<_?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<_?Math.floor(1e3/_):5},c.unstable_getCurrentPriorityLevel=function(){return Ce},c.unstable_next=function(_){switch(Ce){case 1:case 2:case 3:var O=3;break;default:O=Ce}var Y=Ce;Ce=O;try{return _()}finally{Ce=Y}},c.unstable_requestPaint=function(){B=!0},c.unstable_runWithPriority=function(_,O){switch(_){case 1:case 2:case 3:case 4:case 5:break;default:_=3}var Y=Ce;Ce=_;try{return O()}finally{Ce=Y}},c.unstable_scheduleCallback=function(_,O,Y){var je=c.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?je+Y:je):Y=je,_){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=Y+L,_={id:ue++,callback:O,priorityLevel:_,startTime:Y,expirationTime:L,sortIndex:-1},Y>je?(_.sortIndex=Y,u(V,_),g(p)===null&&_===g(V)&&(Be?(Le(D),D=-1):Be=!0,re(M,Y-je))):(_.sortIndex=L,u(p,_),se||Me||(se=!0,z||(z=!0,j()))),_},c.unstable_shouldYield=pe,c.unstable_wrapCallback=function(_){var O=Ce;return function(){var Y=Ce;Ce=O;try{return _.apply(this,arguments)}finally{Ce=Y}}}})(Ff)),Ff}var wh;function Hg(){return wh||(wh=1,Wf.exports=_g()),Wf.exports}var Lf={exports:{}},Ji={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jh;function Ig(){if(jh)return Ji;jh=1;var c=ep();function u(p){var V="https://react.dev/errors/"+p;if(1<arguments.length){V+="?args[]="+encodeURIComponent(arguments[1]);for(var ue=2;ue<arguments.length;ue++)V+="&args[]="+encodeURIComponent(arguments[ue])}return"Minified React error #"+p+"; visit "+V+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function g(){}var d={d:{f:g,r:function(){throw Error(u(522))},D:g,C:g,L:g,m:g,X:g,S:g,M:g},p:0,findDOMNode:null},R=Symbol.for("react.portal");function I(p,V,ue){var he=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:R,key:he==null?null:""+he,children:p,containerInfo:V,implementation:ue}}var xe=c.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function q(p,V){if(p==="font")return"";if(typeof V=="string")return V==="use-credentials"?V:""}return Ji.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=d,Ji.createPortal=function(p,V){var ue=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!V||V.nodeType!==1&&V.nodeType!==9&&V.nodeType!==11)throw Error(u(299));return I(p,V,null,ue)},Ji.flushSync=function(p){var V=xe.T,ue=d.p;try{if(xe.T=null,d.p=2,p)return p()}finally{xe.T=V,d.p=ue,d.d.f()}},Ji.preconnect=function(p,V){typeof p=="string"&&(V?(V=V.crossOrigin,V=typeof V=="string"?V==="use-credentials"?V:"":void 0):V=null,d.d.C(p,V))},Ji.prefetchDNS=function(p){typeof p=="string"&&d.d.D(p)},Ji.preinit=function(p,V){if(typeof p=="string"&&V&&typeof V.as=="string"){var ue=V.as,he=q(ue,V.crossOrigin),Ce=typeof V.integrity=="string"?V.integrity:void 0,Me=typeof V.fetchPriority=="string"?V.fetchPriority:void 0;ue==="style"?d.d.S(p,typeof V.precedence=="string"?V.precedence:void 0,{crossOrigin:he,integrity:Ce,fetchPriority:Me}):ue==="script"&&d.d.X(p,{crossOrigin:he,integrity:Ce,fetchPriority:Me,nonce:typeof V.nonce=="string"?V.nonce:void 0})}},Ji.preinitModule=function(p,V){if(typeof p=="string")if(typeof V=="object"&&V!==null){if(V.as==null||V.as==="script"){var ue=q(V.as,V.crossOrigin);d.d.M(p,{crossOrigin:ue,integrity:typeof V.integrity=="string"?V.integrity:void 0,nonce:typeof V.nonce=="string"?V.nonce:void 0})}}else V==null&&d.d.M(p)},Ji.preload=function(p,V){if(typeof p=="string"&&typeof V=="object"&&V!==null&&typeof V.as=="string"){var ue=V.as,he=q(ue,V.crossOrigin);d.d.L(p,ue,{crossOrigin:he,integrity:typeof V.integrity=="string"?V.integrity:void 0,nonce:typeof V.nonce=="string"?V.nonce:void 0,type:typeof V.type=="string"?V.type:void 0,fetchPriority:typeof V.fetchPriority=="string"?V.fetchPriority:void 0,referrerPolicy:typeof V.referrerPolicy=="string"?V.referrerPolicy:void 0,imageSrcSet:typeof V.imageSrcSet=="string"?V.imageSrcSet:void 0,imageSizes:typeof V.imageSizes=="string"?V.imageSizes:void 0,media:typeof V.media=="string"?V.media:void 0})}},Ji.preloadModule=function(p,V){if(typeof p=="string")if(V){var ue=q(V.as,V.crossOrigin);d.d.m(p,{as:typeof V.as=="string"&&V.as!=="script"?V.as:void 0,crossOrigin:ue,integrity:typeof V.integrity=="string"?V.integrity:void 0})}else d.d.m(p)},Ji.requestFormReset=function(p){d.d.r(p)},Ji.unstable_batchedUpdates=function(p,V){return p(V)},Ji.useFormState=function(p,V,ue){return xe.H.useFormState(p,V,ue)},Ji.useFormStatus=function(){return xe.H.useHostTransitionStatus()},Ji.version="19.2.0",Ji}var Th;function Vg(){if(Th)return Lf.exports;Th=1;function c(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(c)}catch(u){console.error(u)}}return c(),Lf.exports=Ig(),Lf.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ch;function Wg(){if(Ch)return Vd;Ch=1;var c=Hg(),u=ep(),g=Vg();function d(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var i=2;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function R(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function I(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(i=t.return),e=t.return;while(e)}return t.tag===3?i:null}function xe(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function q(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(I(e)!==e)throw Error(d(188))}function V(e){var t=e.alternate;if(!t){if(t=I(e),t===null)throw Error(d(188));return t!==e?null:e}for(var i=e,l=t;;){var a=i.return;if(a===null)break;var s=a.alternate;if(s===null){if(l=a.return,l!==null){i=l;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===i)return p(a),e;if(s===l)return p(a),t;s=s.sibling}throw Error(d(188))}if(i.return!==l.return)i=a,l=s;else{for(var h=!1,w=a.child;w;){if(w===i){h=!0,i=a,l=s;break}if(w===l){h=!0,l=a,i=s;break}w=w.sibling}if(!h){for(w=s.child;w;){if(w===i){h=!0,i=s,l=a;break}if(w===l){h=!0,l=s,i=a;break}w=w.sibling}if(!h)throw Error(d(189))}}if(i.alternate!==l)throw Error(d(190))}if(i.tag!==3)throw Error(d(188));return i.stateNode.current===i?e:t}function ue(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=ue(e),t!==null)return t;e=e.sibling}return null}var he=Object.assign,Ce=Symbol.for("react.element"),Me=Symbol.for("react.transitional.element"),se=Symbol.for("react.portal"),Be=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),te=Symbol.for("react.profiler"),Le=Symbol.for("react.consumer"),J=Symbol.for("react.context"),ne=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),pe=Symbol.for("react.memo_cache_sentinel"),W=Symbol.iterator;function j(e){return e===null||typeof e!="object"?null:(e=W&&e[W]||e["@@iterator"],typeof e=="function"?e:null)}var me=Symbol.for("react.client.reference");function be(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===me?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Be:return"Fragment";case te:return"Profiler";case B:return"StrictMode";case M:return"Suspense";case z:return"SuspenseList";case E:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case se:return"Portal";case J:return e.displayName||"Context";case Le:return(e._context.displayName||"Context")+".Consumer";case ne:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case D:return t=e.displayName||null,t!==null?t:be(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return be(e(t))}catch{}}return null}var re=Array.isArray,_=u.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,O=g.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Y={pending:!1,data:null,method:null,action:null},je=[],L=-1;function S(e){return{current:e}}function A(e){0>L||(e.current=je[L],je[L]=null,L--)}function $(e,t){L++,je[L]=e.current,e.current=t}var Z=S(null),Oe=S(null),Ge=S(null),Xe=S(null);function xt(e,t){switch($(Ge,t),$(Oe,e),$(Z,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Ip(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Ip(t),e=Vp(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}A(Z),$(Z,e)}function Pe(){A(Z),A(Oe),A(Ge)}function _n(e){e.memoizedState!==null&&$(Xe,e);var t=Z.current,i=Vp(t,e.type);t!==i&&($(Oe,e),$(Z,i))}function Mn(e){Oe.current===e&&(A(Z),A(Oe)),Xe.current===e&&(A(Xe),Od._currentValue=Y)}var Vi,Di;function yi(e){if(Vi===void 0)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);Vi=t&&t[1]||"",Di=-1<i.stack.indexOf(`
    at`)?" (<anonymous>)":-1<i.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Vi+e+Di}var Ai=!1;function Nl(e,t){if(!e||Ai)return"";Ai=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var l={DetermineComponentFrameRoot:function(){try{if(t){var De=function(){throw Error()};if(Object.defineProperty(De.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(De,[])}catch(ye){var fe=ye}Reflect.construct(e,[],De)}else{try{De.call()}catch(ye){fe=ye}e.call(De.prototype)}}else{try{throw Error()}catch(ye){fe=ye}(De=e())&&typeof De.catch=="function"&&De.catch(function(){})}}catch(ye){if(ye&&fe&&typeof ye.stack=="string")return[ye.stack,fe.stack]}return[null,null]}};l.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var a=Object.getOwnPropertyDescriptor(l.DetermineComponentFrameRoot,"name");a&&a.configurable&&Object.defineProperty(l.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=l.DetermineComponentFrameRoot(),h=s[0],w=s[1];if(h&&w){var F=h.split(`
`),de=w.split(`
`);for(a=l=0;l<F.length&&!F[l].includes("DetermineComponentFrameRoot");)l++;for(;a<de.length&&!de[a].includes("DetermineComponentFrameRoot");)a++;if(l===F.length||a===de.length)for(l=F.length-1,a=de.length-1;1<=l&&0<=a&&F[l]!==de[a];)a--;for(;1<=l&&0<=a;l--,a--)if(F[l]!==de[a]){if(l!==1||a!==1)do if(l--,a--,0>a||F[l]!==de[a]){var Te=`
`+F[l].replace(" at new "," at ");return e.displayName&&Te.includes("<anonymous>")&&(Te=Te.replace("<anonymous>",e.displayName)),Te}while(1<=l&&0<=a);break}}}finally{Ai=!1,Error.prepareStackTrace=i}return(i=e?e.displayName||e.name:"")?yi(i):""}function el(e,t){switch(e.tag){case 26:case 27:case 5:return yi(e.type);case 16:return yi("Lazy");case 13:return e.child!==t&&t!==null?yi("Suspense Fallback"):yi("Suspense");case 19:return yi("SuspenseList");case 0:case 15:return Nl(e.type,!1);case 11:return Nl(e.type.render,!1);case 1:return Nl(e.type,!0);case 31:return yi("Activity");default:return""}}function Ql(e){try{var t="",i=null;do t+=el(e,i),i=e,e=e.return;while(e);return t}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}var mo=Object.prototype.hasOwnProperty,ir=c.unstable_scheduleCallback,Yo=c.unstable_cancelCallback,Lc=c.unstable_shouldYield,Je=c.unstable_requestPaint,ut=c.unstable_now,$c=c.unstable_getCurrentPriorityLevel,He=c.unstable_ImmediatePriority,Pt=c.unstable_UserBlockingPriority,Jl=c.unstable_NormalPriority,vo=c.unstable_LowPriority,Xt=c.unstable_IdlePriority,bi=c.log,Ml=c.unstable_setDisableYieldValue,Wi=null,Ne=null;function Yn(e){if(typeof bi=="function"&&Ml(e),Ne&&typeof Ne.setStrictMode=="function")try{Ne.setStrictMode(Wi,e)}catch{}}var lt=Math.clz32?Math.clz32:lr,Cn=Math.log,So=Math.LN2;function lr(e){return e>>>=0,e===0?32:31-(Cn(e)/So|0)|0}var eo=256,Sa=262144,Bt=4194304;function Fi(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function to(e,t,i){var l=e.pendingLanes;if(l===0)return 0;var a=0,s=e.suspendedLanes,h=e.pingedLanes;e=e.warmLanes;var w=l&134217727;return w!==0?(l=w&~s,l!==0?a=Fi(l):(h&=w,h!==0?a=Fi(h):i||(i=w&~e,i!==0&&(a=Fi(i))))):(w=l&~s,w!==0?a=Fi(w):h!==0?a=Fi(h):i||(i=l&~e,i!==0&&(a=Fi(i)))),a===0?0:t!==0&&t!==a&&(t&s)===0&&(s=a&-a,i=t&-t,s>=i||s===32&&(i&4194048)!==0)?t:a}function Li(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function gs(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $i(){var e=Bt;return Bt<<=1,(Bt&62914560)===0&&(Bt=4194304),e}function dl(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function no(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function $r(e,t,i,l,a,s){var h=e.pendingLanes;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=i,e.entangledLanes&=i,e.errorRecoveryDisabledLanes&=i,e.shellSuspendCounter=0;var w=e.entanglements,F=e.expirationTimes,de=e.hiddenUpdates;for(i=h&~i;0<i;){var Te=31-lt(i),De=1<<Te;w[Te]=0,F[Te]=-1;var fe=de[Te];if(fe!==null)for(de[Te]=null,Te=0;Te<fe.length;Te++){var ye=fe[Te];ye!==null&&(ye.lane&=-536870913)}i&=~De}l!==0&&Fe(e,l,0),s!==0&&a===0&&e.tag!==0&&(e.suspendedLanes|=s&~(h&~t))}function Fe(e,t,i){e.pendingLanes|=t,e.suspendedLanes&=~t;var l=31-lt(t);e.entangledLanes|=t,e.entanglements[l]=e.entanglements[l]|1073741824|i&261930}function mi(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var l=31-lt(i),a=1<<l;a&t|e[l]&t&&(e[l]|=t),i&=~a}}function kt(e,t){var i=t&-t;return i=(i&42)!==0?1:Hn(i),(i&(e.suspendedLanes|t))!==0?0:i}function Hn(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function xs(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function or(){var e=O.p;return e!==0?e:(e=window.event,e===void 0?32:dh(e.type))}function ar(e,t){var i=O.p;try{return O.p=e,t()}finally{O.p=i}}var ul=Math.random().toString(36).slice(2),ft="__reactFiber$"+ul,Bn="__reactProps$"+ul,Lt="__reactContainer$"+ul,wa="__reactEvents$"+ul,ln="__reactListeners$"+ul,sr="__reactHandles$"+ul,vn="__reactResources$"+ul,wo="__reactMarker$"+ul;function Xo(e){delete e[ft],delete e[Bn],delete e[wa],delete e[ln],delete e[sr]}function Bl(e){var t=e[ft];if(t)return t;for(var i=e.parentNode;i;){if(t=i[Lt]||i[ft]){if(i=t.alternate,t.child!==null||i!==null&&i.child!==null)for(e=Gp(e);e!==null;){if(i=e[ft])return i;e=Gp(e)}return t}e=i,i=e.parentNode}return null}function Ul(e){if(e=e[ft]||e[Lt]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function Pl(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(d(33))}function Go(e){var t=e[vn];return t||(t=e[vn]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Ot(e){e[wo]=!0}var Yr=new Set,Ht={};function on(e,t){fl(e,t),fl(e+"Capture",t)}function fl(e,t){for(Ht[e]=t,e=0;e<t.length;e++)Yr.add(t[e])}var Xr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),qo={},rr={};function tl(e){return mo.call(rr,e)?!0:mo.call(qo,e)?!1:Xr.test(e)?rr[e]=!0:(qo[e]=!0,!1)}function vi(e,t,i){if(tl(t))if(i===null)e.removeAttribute(t);else{switch(typeof i){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var l=t.toLowerCase().slice(0,5);if(l!=="data-"&&l!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+i)}}function ja(e,t,i){if(i===null)e.removeAttribute(t);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+i)}}function Xn(e,t,i,l){if(l===null)e.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(i);return}e.setAttributeNS(t,i,""+l)}}function Ni(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ys(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Gn(e,t,i){var l=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var a=l.get,s=l.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(h){i=""+h,s.call(this,h)}}),Object.defineProperty(e,t,{enumerable:l.enumerable}),{getValue:function(){return i},setValue:function(h){i=""+h},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function zn(e){if(!e._valueTracker){var t=ys(e)?"checked":"value";e._valueTracker=Gn(e,t,""+e[t])}}function bs(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),l="";return e&&(l=ys(e)?e.checked?"true":"false":e.value),e=l,e!==i?(t.setValue(e),!0):!1}function xn(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var li=/[\n"\\]/g;function Si(e){return e.replace(li,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function Ta(e,t,i,l,a,s,h,w){e.name="",h!=null&&typeof h!="function"&&typeof h!="symbol"&&typeof h!="boolean"?e.type=h:e.removeAttribute("type"),t!=null?h==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Ni(t)):e.value!==""+Ni(t)&&(e.value=""+Ni(t)):h!=="submit"&&h!=="reset"||e.removeAttribute("value"),t!=null?Ca(e,h,Ni(t)):i!=null?Ca(e,h,Ni(i)):l!=null&&e.removeAttribute("value"),a==null&&s!=null&&(e.defaultChecked=!!s),a!=null&&(e.checked=a&&typeof a!="function"&&typeof a!="symbol"),w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?e.name=""+Ni(w):e.removeAttribute("name")}function ms(e,t,i,l,a,s,h,w){if(s!=null&&typeof s!="function"&&typeof s!="symbol"&&typeof s!="boolean"&&(e.type=s),t!=null||i!=null){if(!(s!=="submit"&&s!=="reset"||t!=null)){zn(e);return}i=i!=null?""+Ni(i):"",t=t!=null?""+Ni(t):i,w||t===e.value||(e.value=t),e.defaultValue=t}l=l??a,l=typeof l!="function"&&typeof l!="symbol"&&!!l,e.checked=w?e.checked:!!l,e.defaultChecked=!!l,h!=null&&typeof h!="function"&&typeof h!="symbol"&&typeof h!="boolean"&&(e.name=h),zn(e)}function Ca(e,t,i){t==="number"&&xn(e.ownerDocument)===e||e.defaultValue===""+i||(e.defaultValue=""+i)}function Yi(e,t,i,l){if(e=e.options,t){t={};for(var a=0;a<i.length;a++)t["$"+i[a]]=!0;for(i=0;i<e.length;i++)a=t.hasOwnProperty("$"+e[i].value),e[i].selected!==a&&(e[i].selected=a),a&&l&&(e[i].defaultSelected=!0)}else{for(i=""+Ni(i),t=null,a=0;a<e.length;a++){if(e[a].value===i){e[a].selected=!0,l&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Sn(e,t,i){if(t!=null&&(t=""+Ni(t),t!==e.value&&(e.value=t),i==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=i!=null?""+Ni(i):""}function Gr(e,t,i,l){if(t==null){if(l!=null){if(i!=null)throw Error(d(92));if(re(l)){if(1<l.length)throw Error(d(93));l=l[0]}i=l}i==null&&(i=""),t=i}i=Ni(t),e.defaultValue=i,l=e.textContent,l===i&&l!==""&&l!==null&&(e.value=l),zn(e)}function mt(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=t;return}}e.textContent=t}var we=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function kn(e,t,i){var l=t.indexOf("--")===0;i==null||typeof i=="boolean"||i===""?l?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":l?e.setProperty(t,i):typeof i!="number"||i===0||we.has(t)?t==="float"?e.cssFloat=i:e[t]=(""+i).trim():e[t]=i+"px"}function za(e,t,i){if(t!=null&&typeof t!="object")throw Error(d(62));if(e=e.style,i!=null){for(var l in i)!i.hasOwnProperty(l)||t!=null&&t.hasOwnProperty(l)||(l.indexOf("--")===0?e.setProperty(l,""):l==="float"?e.cssFloat="":e[l]="");for(var a in t)l=t[a],t.hasOwnProperty(a)&&i[a]!==l&&kn(e,a,l)}else for(var s in t)t.hasOwnProperty(s)&&kn(e,s,t[s])}function vt(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var nt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),It=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function st(e){return It.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function jt(){}var pt=null;function Yc(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var et=null,Qt=null;function rt(e){var t=Ul(e);if(t&&(e=t.stateNode)){var i=e[Bn]||null;e:switch(e=t.stateNode,t.type){case"input":if(Ta(e,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name),t=i.name,i.type==="radio"&&t!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll('input[name="'+Si(""+t)+'"][type="radio"]'),t=0;t<i.length;t++){var l=i[t];if(l!==e&&l.form===e.form){var a=l[Bn]||null;if(!a)throw Error(d(90));Ta(l,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name)}}for(t=0;t<i.length;t++)l=i[t],l.form===e.form&&bs(l)}break e;case"textarea":Sn(e,i.value,i.defaultValue);break e;case"select":t=i.value,t!=null&&Yi(e,!!i.multiple,t,!1)}}}var rn=!1;function ka(e,t,i){if(rn)return e(t,i);rn=!0;try{var l=e(t);return l}finally{if(rn=!1,(et!==null||Qt!==null)&&(Su(),et&&(t=et,e=Qt,Qt=et=null,rt(t),e)))for(t=0;t<e.length;t++)rt(e[t])}}function Ra(e,t){var i=e.stateNode;if(i===null)return null;var l=i[Bn]||null;if(l===null)return null;i=l[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(d(231,t,typeof i));return i}var Rn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Zo=!1;if(Rn)try{var nl={};Object.defineProperty(nl,"passive",{get:function(){Zo=!0}}),window.addEventListener("test",nl,nl),window.removeEventListener("test",nl,nl)}catch{Zo=!1}var il=null,cr=null,dr=null;function vs(){if(dr)return dr;var e,t=cr,i=t.length,l,a="value"in il?il.value:il.textContent,s=a.length;for(e=0;e<i&&t[e]===a[e];e++);var h=i-e;for(l=1;l<=h&&t[i-l]===a[s-l];l++);return dr=a.slice(e,1<l?1-l:void 0)}function ur(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function fr(){return!0}function Yd(){return!1}function Ke(e){function t(i,l,a,s,h){this._reactName=i,this._targetInst=a,this.type=l,this.nativeEvent=s,this.target=h,this.currentTarget=null;for(var w in e)e.hasOwnProperty(w)&&(i=e[w],this[w]=i?i(s):s[w]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?fr:Yd,this.isPropagationStopped=Yd,this}return he(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=fr)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=fr)},persist:function(){},isPersistent:fr}),t}var Mi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gt=Ke(Mi),Ol=he({},Mi,{view:0,detail:0}),Bi=Ke(Ol),oi,ai,qn,wi=he({},Ol,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Jo,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==qn&&(qn&&e.type==="mousemove"?(oi=e.screenX-qn.screenX,ai=e.screenY-qn.screenY):ai=oi=0,qn=e),oi)},movementY:function(e){return"movementY"in e?e.movementY:ai}}),Ko=Ke(wi),$u=he({},wi,{dataTransfer:0}),pl=Ke($u),Xd=he({},Ol,{relatedTarget:0}),Qo=Ke(Xd),Yu=he({},Mi,{animationName:0,elapsedTime:0,pseudoElement:0}),Ui=Ke(Yu),Ss=he({},Mi,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ji=Ke(Ss),ws=he({},Mi,{data:0}),Xi=Ke(ws),pr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jo={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Xc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ti(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Xc[e])?!!t[e]:!1}function Jo(){return Ti}var Gi=he({},Ol,{key:function(e){if(e.key){var t=pr[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ur(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?jo[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Jo,charCode:function(e){return e.type==="keypress"?ur(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ur(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),js=Ke(Gi),qi=he({},wi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Da=Ke(qi),wn=he({},Ol,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Jo}),Ts=Ke(wn),Xu=he({},Mi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Gu=Ke(Xu),hr=he({},wi,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),qr=Ke(hr),Zr=he({},Mi,{newState:0,oldState:0}),Gc=Ke(Zr),ea=[9,13,27,32],Cs=Rn&&"CompositionEvent"in window,Pi=null;Rn&&"documentMode"in document&&(Pi=document.documentMode);var zs=Rn&&"TextEvent"in window&&!Pi,ta=Rn&&(!Cs||Pi&&8<Pi&&11>=Pi),Kr=" ",Aa=!1;function Qr(e,t){switch(e){case"keyup":return ea.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function na(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ia=!1;function ks(e,t){switch(e){case"compositionend":return na(t);case"keypress":return t.which!==32?null:(Aa=!0,Kr);case"textInput":return e=t.data,e===Kr&&Aa?null:e;default:return null}}function tn(e,t){if(ia)return e==="compositionend"||!Cs&&Qr(e,t)?(e=vs(),dr=cr=il=null,ia=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ta&&t.locale!=="ko"?null:t.data;default:return null}}var Na={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function pn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Na[e.type]:t==="textarea"}function la(e,t,i,l){et?Qt?Qt.push(l):Qt=[l]:et=l,t=Ru(t,"onChange"),0<t.length&&(i=new Gt("onChange","change",null,i,l),e.push({event:i,listeners:t}))}var Ma=null,io=null;function qu(e){Up(e,0)}function Rs(e){var t=Pl(e);if(bs(t))return e}function Gd(e,t){if(e==="change")return t}var qd=!1;if(Rn){var lo;if(Rn){var qc="oninput"in document;if(!qc){var Zc=document.createElement("div");Zc.setAttribute("oninput","return;"),qc=typeof Zc.oninput=="function"}lo=qc}else lo=!1;qd=lo&&(!document.documentMode||9<document.documentMode)}function Zd(){Ma&&(Ma.detachEvent("onpropertychange",Jr),io=Ma=null)}function Jr(e){if(e.propertyName==="value"&&Rs(io)){var t=[];la(t,io,e,Yc(e)),ka(qu,t)}}function Zu(e,t,i){e==="focusin"?(Zd(),Ma=t,io=i,Ma.attachEvent("onpropertychange",Jr)):e==="focusout"&&Zd()}function Kd(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Rs(io)}function Ku(e,t){if(e==="click")return Rs(t)}function Qd(e,t){if(e==="input"||e==="change")return Rs(t)}function Oi(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var yn=typeof Object.is=="function"?Object.is:Oi;function hl(e,t){if(yn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var i=Object.keys(e),l=Object.keys(t);if(i.length!==l.length)return!1;for(l=0;l<i.length;l++){var a=i[l];if(!mo.call(t,a)||!yn(e[a],t[a]))return!1}return!0}function El(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function To(e,t){var i=El(e);e=0;for(var l;i;){if(i.nodeType===3){if(l=e+i.textContent.length,e<=t&&l>=t)return{node:i,offset:t-e};e=l}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=El(i)}}function Co(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Co(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function zo(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=xn(e.document);t instanceof e.HTMLIFrameElement;){try{var i=typeof t.contentWindow.location.href=="string"}catch{i=!1}if(i)e=t.contentWindow;else break;t=xn(e.document)}return t}function ll(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var ec=Rn&&"documentMode"in document&&11>=document.documentMode,Un=null,cn=null,Zi=null,Zn=!1;function gl(e,t,i){var l=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;Zn||Un==null||Un!==xn(l)||(l=Un,"selectionStart"in l&&ll(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),Zi&&hl(Zi,l)||(Zi=l,l=Ru(cn,"onSelect"),0<l.length&&(t=new Gt("onSelect","select",null,t,i),e.push({event:t,listeners:l}),t.target=Un)))}function Ba(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var xl={animationend:Ba("Animation","AnimationEnd"),animationiteration:Ba("Animation","AnimationIteration"),animationstart:Ba("Animation","AnimationStart"),transitionrun:Ba("Transition","TransitionRun"),transitionstart:Ba("Transition","TransitionStart"),transitioncancel:Ba("Transition","TransitionCancel"),transitionend:Ba("Transition","TransitionEnd")},tc={},gr={};Rn&&(gr=document.createElement("div").style,"AnimationEvent"in window||(delete xl.animationend.animation,delete xl.animationiteration.animation,delete xl.animationstart.animation),"TransitionEvent"in window||delete xl.transitionend.transition);function Vt(e){if(tc[e])return tc[e];if(!xl[e])return e;var t=xl[e],i;for(i in t)if(t.hasOwnProperty(i)&&i in gr)return tc[e]=t[i];return e}var Ei=Vt("animationend"),nc=Vt("animationiteration"),Kc=Vt("animationstart"),Jd=Vt("transitionrun"),Qc=Vt("transitionstart"),ic=Vt("transitioncancel"),xr=Vt("transitionend"),Ds=new Map,lc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");lc.push("scrollEnd");function si(e,t){Ds.set(e,t),on(t,[e])}var oa=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},Kn=[],_l=0,As=0;function Ua(){for(var e=_l,t=As=_l=0;t<e;){var i=Kn[t];Kn[t++]=null;var l=Kn[t];Kn[t++]=null;var a=Kn[t];Kn[t++]=null;var s=Kn[t];if(Kn[t++]=null,l!==null&&a!==null){var h=l.pending;h===null?a.next=a:(a.next=h.next,h.next=a),l.pending=a}s!==0&&Hl(i,a,s)}}function aa(e,t,i,l){Kn[_l++]=e,Kn[_l++]=t,Kn[_l++]=i,Kn[_l++]=l,As|=l,e.lanes|=l,e=e.alternate,e!==null&&(e.lanes|=l)}function Pa(e,t,i,l){return aa(e,t,i,l),Qn(e)}function sa(e,t){return aa(e,null,null,t),Qn(e)}function Hl(e,t,i){e.lanes|=i;var l=e.alternate;l!==null&&(l.lanes|=i);for(var a=!1,s=e.return;s!==null;)s.childLanes|=i,l=s.alternate,l!==null&&(l.childLanes|=i),s.tag===22&&(e=s.stateNode,e===null||e._visibility&1||(a=!0)),e=s,s=s.return;return e.tag===3?(s=e.stateNode,a&&t!==null&&(a=31-lt(i),e=s.hiddenUpdates,l=e[a],l===null?e[a]=[t]:l.push(t),t.lane=i|536870912),s):null}function Qn(e){if(50<Dd)throw Dd=0,cf=null,Error(d(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var ko={};function eu(e,t,i,l){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ri(e,t,i,l){return new eu(e,t,i,l)}function Ro(e){return e=e.prototype,!(!e||!e.isReactComponent)}function yl(e,t){var i=e.alternate;return i===null?(i=ri(e.tag,t,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&65011712,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i.refCleanup=e.refCleanup,i}function Oa(e,t){e.flags&=65011714;var i=e.alternate;return i===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=i.childLanes,e.lanes=i.lanes,e.child=i.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=i.memoizedProps,e.memoizedState=i.memoizedState,e.updateQueue=i.updateQueue,e.type=i.type,t=i.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Do(e,t,i,l,a,s){var h=0;if(l=e,typeof e=="function")Ro(e)&&(h=1);else if(typeof e=="string")h=wg(e,i,Z.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case E:return e=ri(31,i,t,a),e.elementType=E,e.lanes=s,e;case Be:return Ea(i.children,a,s,t);case B:h=8,a|=24;break;case te:return e=ri(12,i,t,a|2),e.elementType=te,e.lanes=s,e;case M:return e=ri(13,i,t,a),e.elementType=M,e.lanes=s,e;case z:return e=ri(19,i,t,a),e.elementType=z,e.lanes=s,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case J:h=10;break e;case Le:h=9;break e;case ne:h=11;break e;case D:h=14;break e;case P:h=16,l=null;break e}h=29,i=Error(d(130,e===null?"null":typeof e,"")),l=null}return t=ri(h,i,t,a),t.elementType=e,t.type=l,t.lanes=s,t}function Ea(e,t,i,l){return e=ri(7,e,l,t),e.lanes=i,e}function oc(e,t,i){return e=ri(6,e,null,t),e.lanes=i,e}function Jc(e){var t=ri(18,null,null,0);return t.stateNode=e,t}function ed(e,t,i){return t=ri(4,e.children!==null?e.children:[],e.key,t),t.lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var yr=new WeakMap;function Ki(e,t){if(typeof e=="object"&&e!==null){var i=yr.get(e);return i!==void 0?i:(t={value:e,source:t,stack:Ql(t)},yr.set(e,t),t)}return{value:e,source:t,stack:Ql(t)}}var _a=[],Ha=0,br=null,oo=0,Pn=[],ci=0,di=null,hn=1,ui="";function Dn(e,t){_a[Ha++]=oo,_a[Ha++]=br,br=e,oo=t}function Ao(e,t,i){Pn[ci++]=hn,Pn[ci++]=ui,Pn[ci++]=di,di=e;var l=hn;e=ui;var a=32-lt(l)-1;l&=~(1<<a),i+=1;var s=32-lt(t)+a;if(30<s){var h=a-a%5;s=(l&(1<<h)-1).toString(32),l>>=h,a-=h,hn=1<<32-lt(t)+a|i<<a|l,ui=s+e}else hn=1<<s|i<<a|l,ui=e}function Ci(e){e.return!==null&&(Dn(e,1),Ao(e,1,0))}function ao(e){for(;e===br;)br=_a[--Ha],_a[Ha]=null,oo=_a[--Ha],_a[Ha]=null;for(;e===di;)di=Pn[--ci],Pn[ci]=null,ui=Pn[--ci],Pn[ci]=null,hn=Pn[--ci],Pn[ci]=null}function Qi(e,t){Pn[ci++]=hn,Pn[ci++]=ui,Pn[ci++]=di,hn=t.id,ui=t.overflow,di=e}var bn=null,Ut=null,Tt=!1,fi=null,pi=!1,bl=Error(d(519));function ol(e){var t=Error(d(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw vl(Ki(t,e)),bl}function al(e){var t=e.stateNode,i=e.type,l=e.memoizedProps;switch(t[ft]=e,t[Bn]=l,i){case"dialog":_t("cancel",t),_t("close",t);break;case"iframe":case"object":case"embed":_t("load",t);break;case"video":case"audio":for(i=0;i<Nd.length;i++)_t(Nd[i],t);break;case"source":_t("error",t);break;case"img":case"image":case"link":_t("error",t),_t("load",t);break;case"details":_t("toggle",t);break;case"input":_t("invalid",t),ms(t,l.value,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name,!0);break;case"select":_t("invalid",t);break;case"textarea":_t("invalid",t),Gr(t,l.value,l.defaultValue,l.children)}i=l.children,typeof i!="string"&&typeof i!="number"&&typeof i!="bigint"||t.textContent===""+i||l.suppressHydrationWarning===!0||_p(t.textContent,i)?(l.popover!=null&&(_t("beforetoggle",t),_t("toggle",t)),l.onScroll!=null&&_t("scroll",t),l.onScrollEnd!=null&&_t("scrollend",t),l.onClick!=null&&(t.onclick=jt),t=!0):t=!1,t||ol(e,!0)}function so(e){for(bn=e.return;bn;)switch(bn.tag){case 5:case 31:case 13:pi=!1;return;case 27:case 3:pi=!0;return;default:bn=bn.return}}function hi(e){if(e!==bn)return!1;if(!Tt)return so(e),Tt=!0,!1;var t=e.tag,i;if((i=t!==3&&t!==27)&&((i=t===5)&&(i=e.type,i=!(i!=="form"&&i!=="button")||Tf(e.type,e.memoizedProps)),i=!i),i&&Ut&&ol(e),so(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(d(317));Ut=Xp(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(d(317));Ut=Xp(e)}else t===27?(t=Ut,Ks(e.type)?(e=Df,Df=null,Ut=e):Ut=t):Ut=bn?go(e.stateNode.nextSibling):null;return!0}function _i(){Ut=bn=null,Tt=!1}function ml(){var e=fi;return e!==null&&(Dl===null?Dl=e:Dl.push.apply(Dl,e),fi=null),e}function vl(e){fi===null?fi=[e]:fi.push(e)}var yt=S(null),dt=null,No=null;function Sl(e,t,i){$(yt,t._currentValue),t._currentValue=i}function Mo(e){e._currentValue=yt.current,A(yt)}function td(e,t,i){for(;e!==null;){var l=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,l!==null&&(l.childLanes|=t)):l!==null&&(l.childLanes&t)!==t&&(l.childLanes|=t),e===i)break;e=e.return}}function mr(e,t,i,l){var a=e.child;for(a!==null&&(a.return=e);a!==null;){var s=a.dependencies;if(s!==null){var h=a.child;s=s.firstContext;e:for(;s!==null;){var w=s;s=a;for(var F=0;F<t.length;F++)if(w.context===t[F]){s.lanes|=i,w=s.alternate,w!==null&&(w.lanes|=i),td(s.return,i,e),l||(h=null);break e}s=w.next}}else if(a.tag===18){if(h=a.return,h===null)throw Error(d(341));h.lanes|=i,s=h.alternate,s!==null&&(s.lanes|=i),td(h,i,e),h=null}else h=a.child;if(h!==null)h.return=a;else for(h=a;h!==null;){if(h===e){h=null;break}if(a=h.sibling,a!==null){a.return=h.return,h=a;break}h=h.return}a=h}}function Ia(e,t,i,l){e=null;for(var a=t,s=!1;a!==null;){if(!s){if((a.flags&524288)!==0)s=!0;else if((a.flags&262144)!==0)break}if(a.tag===10){var h=a.alternate;if(h===null)throw Error(d(387));if(h=h.memoizedProps,h!==null){var w=a.type;yn(a.pendingProps.value,h.value)||(e!==null?e.push(w):e=[w])}}else if(a===Xe.current){if(h=a.alternate,h===null)throw Error(d(387));h.memoizedState.memoizedState!==a.memoizedState.memoizedState&&(e!==null?e.push(Od):e=[Od])}a=a.return}e!==null&&mr(t,e,i,l),t.flags|=262144}function ro(e){for(e=e.firstContext;e!==null;){if(!yn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Bo(e){dt=e,No=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function gi(e){return ac(dt,e)}function vr(e,t){return dt===null&&Bo(e),ac(e,t)}function ac(e,t){var i=t._currentValue;if(t={context:t,memoizedValue:i,next:null},No===null){if(e===null)throw Error(d(308));No=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else No=No.next=t;return i}var Jn=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(i,l){e.push(l)}};this.abort=function(){t.aborted=!0,e.forEach(function(i){return i()})}},Il=c.unstable_scheduleCallback,Va=c.unstable_NormalPriority,In={$$typeof:J,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Wa(){return{controller:new Jn,data:new Map,refCount:0}}function Sr(e){e.refCount--,e.refCount===0&&Il(Va,function(){e.controller.abort()})}var wr=null,jr=0,jn=0,ei=null;function Fa(e,t){if(wr===null){var i=wr=[];jr=0,jn=gf(),ei={status:"pending",value:void 0,then:function(l){i.push(l)}}}return jr++,t.then(Ns,Ns),t}function Ns(){if(--jr===0&&wr!==null){ei!==null&&(ei.status="fulfilled");var e=wr;wr=null,jn=0,ei=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function Tr(e,t){var i=[],l={status:"pending",value:null,reason:null,then:function(a){i.push(a)}};return e.then(function(){l.status="fulfilled",l.value=t;for(var a=0;a<i.length;a++)(0,i[a])(t)},function(a){for(l.status="rejected",l.reason=a,a=0;a<i.length;a++)(0,i[a])(void 0)}),l}var Ms=_.S;_.S=function(e,t){rp=ut(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&Fa(e,t),Ms!==null&&Ms(e,t)};var wl=S(null);function nd(){var e=wl.current;return e!==null?e:gn.pooledCache}function La(e,t){t===null?$(wl,wl.current):$(wl,t.pool)}function ra(){var e=nd();return e===null?null:{parent:In._currentValue,pool:e}}var zi=Error(d(460)),co=Error(d(474)),Vl=Error(d(542)),Wl={then:function(){}};function Bs(e){return e=e.status,e==="fulfilled"||e==="rejected"}function sc(e,t,i){switch(i=e[i],i===void 0?e.push(t):i!==t&&(t.then(jt,jt),t=i),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,id(e),e;default:if(typeof t.status=="string")t.then(jt,jt);else{if(e=gn,e!==null&&100<e.shellSuspendCounter)throw Error(d(482));e=t,e.status="pending",e.then(function(l){if(t.status==="pending"){var a=t;a.status="fulfilled",a.value=l}},function(l){if(t.status==="pending"){var a=t;a.status="rejected",a.reason=l}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,id(e),e}throw Fl=t,zi}}function ti(e){try{var t=e._init;return t(e._payload)}catch(i){throw i!==null&&typeof i=="object"&&typeof i.then=="function"?(Fl=i,zi):i}}var Fl=null;function rc(){if(Fl===null)throw Error(d(459));var e=Fl;return Fl=null,e}function id(e){if(e===zi||e===Vl)throw Error(d(483))}var Uo=null,Us=0;function Ps(e){var t=Us;return Us+=1,Uo===null&&(Uo=[]),sc(Uo,e,t)}function jl(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Po(e,t){throw t.$$typeof===Ce?Error(d(525)):(e=Object.prototype.toString.call(t),Error(d(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Cr(e){function t(ie,G){if(e){var ce=ie.deletions;ce===null?(ie.deletions=[G],ie.flags|=16):ce.push(G)}}function i(ie,G){if(!e)return null;for(;G!==null;)t(ie,G),G=G.sibling;return null}function l(ie){for(var G=new Map;ie!==null;)ie.key!==null?G.set(ie.key,ie):G.set(ie.index,ie),ie=ie.sibling;return G}function a(ie,G){return ie=yl(ie,G),ie.index=0,ie.sibling=null,ie}function s(ie,G,ce){return ie.index=ce,e?(ce=ie.alternate,ce!==null?(ce=ce.index,ce<G?(ie.flags|=67108866,G):ce):(ie.flags|=67108866,G)):(ie.flags|=1048576,G)}function h(ie){return e&&ie.alternate===null&&(ie.flags|=67108866),ie}function w(ie,G,ce,ke){return G===null||G.tag!==6?(G=oc(ce,ie.mode,ke),G.return=ie,G):(G=a(G,ce),G.return=ie,G)}function F(ie,G,ce,ke){var ct=ce.type;return ct===Be?Te(ie,G,ce.props.children,ke,ce.key):G!==null&&(G.elementType===ct||typeof ct=="object"&&ct!==null&&ct.$$typeof===P&&ti(ct)===G.type)?(G=a(G,ce.props),jl(G,ce),G.return=ie,G):(G=Do(ce.type,ce.key,ce.props,null,ie.mode,ke),jl(G,ce),G.return=ie,G)}function de(ie,G,ce,ke){return G===null||G.tag!==4||G.stateNode.containerInfo!==ce.containerInfo||G.stateNode.implementation!==ce.implementation?(G=ed(ce,ie.mode,ke),G.return=ie,G):(G=a(G,ce.children||[]),G.return=ie,G)}function Te(ie,G,ce,ke,ct){return G===null||G.tag!==7?(G=Ea(ce,ie.mode,ke,ct),G.return=ie,G):(G=a(G,ce),G.return=ie,G)}function De(ie,G,ce){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return G=oc(""+G,ie.mode,ce),G.return=ie,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case Me:return ce=Do(G.type,G.key,G.props,null,ie.mode,ce),jl(ce,G),ce.return=ie,ce;case se:return G=ed(G,ie.mode,ce),G.return=ie,G;case P:return G=ti(G),De(ie,G,ce)}if(re(G)||j(G))return G=Ea(G,ie.mode,ce,null),G.return=ie,G;if(typeof G.then=="function")return De(ie,Ps(G),ce);if(G.$$typeof===J)return De(ie,vr(ie,G),ce);Po(ie,G)}return null}function fe(ie,G,ce,ke){var ct=G!==null?G.key:null;if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return ct!==null?null:w(ie,G,""+ce,ke);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case Me:return ce.key===ct?F(ie,G,ce,ke):null;case se:return ce.key===ct?de(ie,G,ce,ke):null;case P:return ce=ti(ce),fe(ie,G,ce,ke)}if(re(ce)||j(ce))return ct!==null?null:Te(ie,G,ce,ke,null);if(typeof ce.then=="function")return fe(ie,G,Ps(ce),ke);if(ce.$$typeof===J)return fe(ie,G,vr(ie,ce),ke);Po(ie,ce)}return null}function ye(ie,G,ce,ke,ct){if(typeof ke=="string"&&ke!==""||typeof ke=="number"||typeof ke=="bigint")return ie=ie.get(ce)||null,w(G,ie,""+ke,ct);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case Me:return ie=ie.get(ke.key===null?ce:ke.key)||null,F(G,ie,ke,ct);case se:return ie=ie.get(ke.key===null?ce:ke.key)||null,de(G,ie,ke,ct);case P:return ke=ti(ke),ye(ie,G,ce,ke,ct)}if(re(ke)||j(ke))return ie=ie.get(ce)||null,Te(G,ie,ke,ct,null);if(typeof ke.then=="function")return ye(ie,G,ce,Ps(ke),ct);if(ke.$$typeof===J)return ye(ie,G,ce,vr(G,ke),ct);Po(G,ke)}return null}function Qe(ie,G,ce,ke){for(var ct=null,Zt=null,tt=G,Mt=G=0,Ft=null;tt!==null&&Mt<ce.length;Mt++){tt.index>Mt?(Ft=tt,tt=null):Ft=tt.sibling;var Kt=fe(ie,tt,ce[Mt],ke);if(Kt===null){tt===null&&(tt=Ft);break}e&&tt&&Kt.alternate===null&&t(ie,tt),G=s(Kt,G,Mt),Zt===null?ct=Kt:Zt.sibling=Kt,Zt=Kt,tt=Ft}if(Mt===ce.length)return i(ie,tt),Tt&&Dn(ie,Mt),ct;if(tt===null){for(;Mt<ce.length;Mt++)tt=De(ie,ce[Mt],ke),tt!==null&&(G=s(tt,G,Mt),Zt===null?ct=tt:Zt.sibling=tt,Zt=tt);return Tt&&Dn(ie,Mt),ct}for(tt=l(tt);Mt<ce.length;Mt++)Ft=ye(tt,ie,Mt,ce[Mt],ke),Ft!==null&&(e&&Ft.alternate!==null&&tt.delete(Ft.key===null?Mt:Ft.key),G=s(Ft,G,Mt),Zt===null?ct=Ft:Zt.sibling=Ft,Zt=Ft);return e&&tt.forEach(function(nr){return t(ie,nr)}),Tt&&Dn(ie,Mt),ct}function bt(ie,G,ce,ke){if(ce==null)throw Error(d(151));for(var ct=null,Zt=null,tt=G,Mt=G=0,Ft=null,Kt=ce.next();tt!==null&&!Kt.done;Mt++,Kt=ce.next()){tt.index>Mt?(Ft=tt,tt=null):Ft=tt.sibling;var nr=fe(ie,tt,Kt.value,ke);if(nr===null){tt===null&&(tt=Ft);break}e&&tt&&nr.alternate===null&&t(ie,tt),G=s(nr,G,Mt),Zt===null?ct=nr:Zt.sibling=nr,Zt=nr,tt=Ft}if(Kt.done)return i(ie,tt),Tt&&Dn(ie,Mt),ct;if(tt===null){for(;!Kt.done;Mt++,Kt=ce.next())Kt=De(ie,Kt.value,ke),Kt!==null&&(G=s(Kt,G,Mt),Zt===null?ct=Kt:Zt.sibling=Kt,Zt=Kt);return Tt&&Dn(ie,Mt),ct}for(tt=l(tt);!Kt.done;Mt++,Kt=ce.next())Kt=ye(tt,ie,Mt,Kt.value,ke),Kt!==null&&(e&&Kt.alternate!==null&&tt.delete(Kt.key===null?Mt:Kt.key),G=s(Kt,G,Mt),Zt===null?ct=Kt:Zt.sibling=Kt,Zt=Kt);return e&&tt.forEach(function(Bg){return t(ie,Bg)}),Tt&&Dn(ie,Mt),ct}function fn(ie,G,ce,ke){if(typeof ce=="object"&&ce!==null&&ce.type===Be&&ce.key===null&&(ce=ce.props.children),typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case Me:e:{for(var ct=ce.key;G!==null;){if(G.key===ct){if(ct=ce.type,ct===Be){if(G.tag===7){i(ie,G.sibling),ke=a(G,ce.props.children),ke.return=ie,ie=ke;break e}}else if(G.elementType===ct||typeof ct=="object"&&ct!==null&&ct.$$typeof===P&&ti(ct)===G.type){i(ie,G.sibling),ke=a(G,ce.props),jl(ke,ce),ke.return=ie,ie=ke;break e}i(ie,G);break}else t(ie,G);G=G.sibling}ce.type===Be?(ke=Ea(ce.props.children,ie.mode,ke,ce.key),ke.return=ie,ie=ke):(ke=Do(ce.type,ce.key,ce.props,null,ie.mode,ke),jl(ke,ce),ke.return=ie,ie=ke)}return h(ie);case se:e:{for(ct=ce.key;G!==null;){if(G.key===ct)if(G.tag===4&&G.stateNode.containerInfo===ce.containerInfo&&G.stateNode.implementation===ce.implementation){i(ie,G.sibling),ke=a(G,ce.children||[]),ke.return=ie,ie=ke;break e}else{i(ie,G);break}else t(ie,G);G=G.sibling}ke=ed(ce,ie.mode,ke),ke.return=ie,ie=ke}return h(ie);case P:return ce=ti(ce),fn(ie,G,ce,ke)}if(re(ce))return Qe(ie,G,ce,ke);if(j(ce)){if(ct=j(ce),typeof ct!="function")throw Error(d(150));return ce=ct.call(ce),bt(ie,G,ce,ke)}if(typeof ce.then=="function")return fn(ie,G,Ps(ce),ke);if(ce.$$typeof===J)return fn(ie,G,vr(ie,ce),ke);Po(ie,ce)}return typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint"?(ce=""+ce,G!==null&&G.tag===6?(i(ie,G.sibling),ke=a(G,ce),ke.return=ie,ie=ke):(i(ie,G),ke=oc(ce,ie.mode,ke),ke.return=ie,ie=ke),h(ie)):i(ie,G)}return function(ie,G,ce,ke){try{Us=0;var ct=fn(ie,G,ce,ke);return Uo=null,ct}catch(tt){if(tt===zi||tt===Vl)throw tt;var Zt=ri(29,tt,null,ie.mode);return Zt.lanes=ke,Zt.return=ie,Zt}finally{}}}var Oo=Cr(!0),ld=Cr(!1),Ll=!1;function cc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function $a(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Tl(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function uo(e,t,i){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,(en&2)!==0){var a=l.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),l.pending=t,t=Qn(e),Hl(e,null,i),t}return aa(e,l,t,i),Qn(e)}function ca(e,t,i){if(t=t.updateQueue,t!==null&&(t=t.shared,(i&4194048)!==0)){var l=t.lanes;l&=e.pendingLanes,i|=l,t.lanes=i,mi(e,i)}}function da(e,t){var i=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,i===l)){var a=null,s=null;if(i=i.firstBaseUpdate,i!==null){do{var h={lane:i.lane,tag:i.tag,payload:i.payload,callback:null,next:null};s===null?a=s=h:s=s.next=h,i=i.next}while(i!==null);s===null?a=s=t:s=s.next=t}else a=s=t;i={baseState:l.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:l.shared,callbacks:l.callbacks},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}var Ya=!1;function Xa(){if(Ya){var e=ei;if(e!==null)throw e}}function Ga(e,t,i,l){Ya=!1;var a=e.updateQueue;Ll=!1;var s=a.firstBaseUpdate,h=a.lastBaseUpdate,w=a.shared.pending;if(w!==null){a.shared.pending=null;var F=w,de=F.next;F.next=null,h===null?s=de:h.next=de,h=F;var Te=e.alternate;Te!==null&&(Te=Te.updateQueue,w=Te.lastBaseUpdate,w!==h&&(w===null?Te.firstBaseUpdate=de:w.next=de,Te.lastBaseUpdate=F))}if(s!==null){var De=a.baseState;h=0,Te=de=F=null,w=s;do{var fe=w.lane&-536870913,ye=fe!==w.lane;if(ye?(Wt&fe)===fe:(l&fe)===fe){fe!==0&&fe===jn&&(Ya=!0),Te!==null&&(Te=Te.next={lane:0,tag:w.tag,payload:w.payload,callback:null,next:null});e:{var Qe=e,bt=w;fe=t;var fn=i;switch(bt.tag){case 1:if(Qe=bt.payload,typeof Qe=="function"){De=Qe.call(fn,De,fe);break e}De=Qe;break e;case 3:Qe.flags=Qe.flags&-65537|128;case 0:if(Qe=bt.payload,fe=typeof Qe=="function"?Qe.call(fn,De,fe):Qe,fe==null)break e;De=he({},De,fe);break e;case 2:Ll=!0}}fe=w.callback,fe!==null&&(e.flags|=64,ye&&(e.flags|=8192),ye=a.callbacks,ye===null?a.callbacks=[fe]:ye.push(fe))}else ye={lane:fe,tag:w.tag,payload:w.payload,callback:w.callback,next:null},Te===null?(de=Te=ye,F=De):Te=Te.next=ye,h|=fe;if(w=w.next,w===null){if(w=a.shared.pending,w===null)break;ye=w,w=ye.next,ye.next=null,a.lastBaseUpdate=ye,a.shared.pending=null}}while(!0);Te===null&&(F=De),a.baseState=F,a.firstBaseUpdate=de,a.lastBaseUpdate=Te,s===null&&(a.shared.lanes=0),Ys|=h,e.lanes=h,e.memoizedState=De}}function zr(e,t){if(typeof e!="function")throw Error(d(191,e));e.call(t)}function dc(e,t){var i=e.callbacks;if(i!==null)for(e.callbacks=null,e=0;e<i.length;e++)zr(i[e],t)}var Os=S(null),Es=S(0);function tu(e,t){e=fs,$(Es,e),$(Os,t),fs=e|t.baseLanes}function _s(){$(Es,fs),$(Os,Os.current)}function Cl(){fs=Es.current,A(Os),A(Es)}var An=S(null),Vn=null;function ua(e){var t=e.alternate;$(On,On.current&1),$(An,e),Vn===null&&(t===null||Os.current!==null||t.memoizedState!==null)&&(Vn=e)}function od(e){$(On,On.current),$(An,e),Vn===null&&(Vn=e)}function nu(e){e.tag===22?($(On,On.current),$(An,e),Vn===null&&(Vn=e)):fa()}function fa(){$(On,On.current),$(An,An.current)}function sl(e){A(An),Vn===e&&(Vn=null),A(On)}var On=S(0);function $l(e){for(var t=e;t!==null;){if(t.tag===13){var i=t.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||kf(i)||Rf(i)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Eo=0,Ct=null,nn=null,Wn=null,uc=!1,Hs=!1,qa=!1,fc=0,kr=0,Is=null,Qu=0;function dn(){throw Error(d(321))}function _o(e,t){if(t===null)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!yn(e[i],t[i]))return!1;return!0}function pa(e,t,i,l,a,s){return Eo=s,Ct=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,_.H=e===null||e.memoizedState===null?Vo:zl,qa=!1,s=i(l,a),qa=!1,Hs&&(s=Za(t,i,l,a)),Rr(e),s}function Rr(e){_.H=Ws;var t=nn!==null&&nn.next!==null;if(Eo=0,Wn=nn=Ct=null,uc=!1,kr=0,Is=null,t)throw Error(d(300));e===null||Ln||(e=e.dependencies,e!==null&&ro(e)&&(Ln=!0))}function Za(e,t,i,l){Ct=e;var a=0;do{if(Hs&&(Is=null),kr=0,Hs=!1,25<=a)throw Error(d(301));if(a+=1,Wn=nn=null,e.updateQueue!=null){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,s.memoCache!=null&&(s.memoCache.index=0)}_.H=yd,s=t(i,l)}while(Hs);return s}function ad(){var e=_.H,t=e.useState()[0];return t=typeof t.then=="function"?rl(t):t,e=e.useState()[0],(nn!==null?nn.memoizedState:null)!==e&&(Ct.flags|=1024),t}function ha(){var e=fc!==0;return fc=0,e}function Ka(e,t,i){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i}function Qa(e){if(uc){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}uc=!1}Eo=0,Wn=nn=Ct=null,Hs=!1,kr=fc=0,Is=null}function ni(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wn===null?Ct.memoizedState=Wn=e:Wn=Wn.next=e,Wn}function mn(){if(nn===null){var e=Ct.alternate;e=e!==null?e.memoizedState:null}else e=nn.next;var t=Wn===null?Ct.memoizedState:Wn.next;if(t!==null)Wn=t,nn=e;else{if(e===null)throw Ct.alternate===null?Error(d(467)):Error(d(310));nn=e,e={memoizedState:nn.memoizedState,baseState:nn.baseState,baseQueue:nn.baseQueue,queue:nn.queue,next:null},Wn===null?Ct.memoizedState=Wn=e:Wn=Wn.next=e}return Wn}function Ja(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function rl(e){var t=kr;return kr+=1,Is===null&&(Is=[]),e=sc(Is,e,t),t=Ct,(Wn===null?t.memoizedState:Wn.next)===null&&(t=t.alternate,_.H=t===null||t.memoizedState===null?Vo:zl),e}function ga(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return rl(e);if(e.$$typeof===J)return gi(e)}throw Error(d(438,String(e)))}function Ho(e){var t=null,i=Ct.updateQueue;if(i!==null&&(t=i.memoCache),t==null){var l=Ct.alternate;l!==null&&(l=l.updateQueue,l!==null&&(l=l.memoCache,l!=null&&(t={data:l.data.map(function(a){return a.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),i===null&&(i=Ja(),Ct.updateQueue=i),i.memoCache=t,i=t.data[t.index],i===void 0)for(i=t.data[t.index]=Array(e),l=0;l<e;l++)i[l]=pe;return t.index++,i}function Fn(e,t){return typeof t=="function"?t(e):t}function es(e){var t=mn();return Dr(t,nn,e)}function Dr(e,t,i){var l=e.queue;if(l===null)throw Error(d(311));l.lastRenderedReducer=i;var a=e.baseQueue,s=l.pending;if(s!==null){if(a!==null){var h=a.next;a.next=s.next,s.next=h}t.baseQueue=a=s,l.pending=null}if(s=e.baseState,a===null)e.memoizedState=s;else{t=a.next;var w=h=null,F=null,de=t,Te=!1;do{var De=de.lane&-536870913;if(De!==de.lane?(Wt&De)===De:(Eo&De)===De){var fe=de.revertLane;if(fe===0)F!==null&&(F=F.next={lane:0,revertLane:0,gesture:null,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null}),De===jn&&(Te=!0);else if((Eo&fe)===fe){de=de.next,fe===jn&&(Te=!0);continue}else De={lane:0,revertLane:de.revertLane,gesture:null,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null},F===null?(w=F=De,h=s):F=F.next=De,Ct.lanes|=fe,Ys|=fe;De=de.action,qa&&i(s,De),s=de.hasEagerState?de.eagerState:i(s,De)}else fe={lane:De,revertLane:de.revertLane,gesture:de.gesture,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null},F===null?(w=F=fe,h=s):F=F.next=fe,Ct.lanes|=De,Ys|=De;de=de.next}while(de!==null&&de!==t);if(F===null?h=s:F.next=w,!yn(s,e.memoizedState)&&(Ln=!0,Te&&(i=ei,i!==null)))throw i;e.memoizedState=s,e.baseState=h,e.baseQueue=F,l.lastRenderedState=s}return a===null&&(l.lanes=0),[e.memoizedState,l.dispatch]}function sd(e){var t=mn(),i=t.queue;if(i===null)throw Error(d(311));i.lastRenderedReducer=e;var l=i.dispatch,a=i.pending,s=t.memoizedState;if(a!==null){i.pending=null;var h=a=a.next;do s=e(s,h.action),h=h.next;while(h!==a);yn(s,t.memoizedState)||(Ln=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),i.lastRenderedState=s}return[s,l]}function iu(e,t,i){var l=Ct,a=mn(),s=Tt;if(s){if(i===void 0)throw Error(d(407));i=i()}else i=t();var h=!yn((nn||a).memoizedState,i);if(h&&(a.memoizedState=i,Ln=!0),a=a.queue,xc(Ar.bind(null,l,a,e),[e]),a.getSnapshot!==t||h||Wn!==null&&Wn.memoizedState.tag&1){if(l.flags|=2048,Vs(9,{destroy:void 0},xa.bind(null,l,a,i,t),null),gn===null)throw Error(d(349));s||(Eo&127)!==0||rd(l,t,i)}return i}function rd(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},t=Ct.updateQueue,t===null?(t=Ja(),Ct.updateQueue=t,t.stores=[e]):(i=t.stores,i===null?t.stores=[e]:i.push(e))}function xa(e,t,i,l){t.value=i,t.getSnapshot=l,Nr(t)&&Mr(e)}function Ar(e,t,i){return i(function(){Nr(t)&&Mr(e)})}function Nr(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!yn(e,i)}catch{return!0}}function Mr(e){var t=sa(e,2);t!==null&&Al(t,e,2)}function Br(e){var t=ni();if(typeof e=="function"){var i=e;if(e=i(),qa){Yn(!0);try{i()}finally{Yn(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fn,lastRenderedState:e},t}function pc(e,t,i,l){return e.baseState=i,Dr(e,nn,typeof l=="function"?l:Fn)}function cd(e,t,i,l,a){if(_r(e))throw Error(d(485));if(e=t.action,e!==null){var s={payload:a,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(h){s.listeners.push(h)}};_.T!==null?i(!0):s.isTransition=!1,l(s),i=t.pending,i===null?(s.next=t.pending=s,lu(t,s)):(s.next=i.next,t.pending=i.next=s)}}function lu(e,t){var i=t.action,l=t.payload,a=e.state;if(t.isTransition){var s=_.T,h={};_.T=h;try{var w=i(a,l),F=_.S;F!==null&&F(h,w),dd(e,t,w)}catch(de){hc(e,t,de)}finally{s!==null&&h.types!==null&&(s.types=h.types),_.T=s}}else try{s=i(a,l),dd(e,t,s)}catch(de){hc(e,t,de)}}function dd(e,t,i){i!==null&&typeof i=="object"&&typeof i.then=="function"?i.then(function(l){Yl(e,t,l)},function(l){return hc(e,t,l)}):Yl(e,t,i)}function Yl(e,t,i){t.status="fulfilled",t.value=i,ts(t),e.state=i,t=e.pending,t!==null&&(i=t.next,i===t?e.pending=null:(i=i.next,t.next=i,lu(e,i)))}function hc(e,t,i){var l=e.pending;if(e.pending=null,l!==null){l=l.next;do t.status="rejected",t.reason=i,ts(t),t=t.next;while(t!==l)}e.action=null}function ts(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function ud(e,t){return t}function Io(e,t){if(Tt){var i=gn.formState;if(i!==null){e:{var l=Ct;if(Tt){if(Ut){t:{for(var a=Ut,s=pi;a.nodeType!==8;){if(!s){a=null;break t}if(a=go(a.nextSibling),a===null){a=null;break t}}s=a.data,a=s==="F!"||s==="F"?a:null}if(a){Ut=go(a.nextSibling),l=a.data==="F!";break e}}ol(l)}l=!1}l&&(t=i[0])}}return i=ni(),i.memoizedState=i.baseState=t,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ud,lastRenderedState:t},i.queue=l,i=xd.bind(null,Ct,l),l.dispatch=i,l=Br(!1),s=Tc.bind(null,Ct,!1,l.queue),l=ni(),a={state:t,dispatch:null,action:e,pending:null},l.queue=a,i=cd.bind(null,Ct,a,s,i),a.dispatch=i,l.memoizedState=e,[t,i,!1]}function gc(e){var t=mn();return fd(t,nn,e)}function fd(e,t,i){if(t=Dr(e,t,ud)[0],e=es(Fn)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var l=rl(t)}catch(h){throw h===zi?Vl:h}else l=t;t=mn();var a=t.queue,s=a.dispatch;return i!==t.memoizedState&&(Ct.flags|=2048,Vs(9,{destroy:void 0},ou.bind(null,a,i),null)),[l,s,e]}function ou(e,t){e.action=t}function au(e){var t=mn(),i=nn;if(i!==null)return fd(t,i,e);mn(),t=t.memoizedState,i=mn();var l=i.queue.dispatch;return i.memoizedState=e,[t,l,!1]}function Vs(e,t,i,l){return e={tag:e,create:i,deps:l,inst:t,next:null},t=Ct.updateQueue,t===null&&(t=Ja(),Ct.updateQueue=t),i=t.lastEffect,i===null?t.lastEffect=e.next=e:(l=i.next,i.next=e,e.next=l,t.lastEffect=e),e}function su(){return mn().memoizedState}function ns(e,t,i,l){var a=ni();Ct.flags|=e,a.memoizedState=Vs(1|t,{destroy:void 0},i,l===void 0?null:l)}function Ur(e,t,i,l){var a=mn();l=l===void 0?null:l;var s=a.memoizedState.inst;nn!==null&&l!==null&&_o(l,nn.memoizedState.deps)?a.memoizedState=Vs(t,s,i,l):(Ct.flags|=e,a.memoizedState=Vs(1|t,s,i,l))}function ru(e,t){ns(8390656,8,e,t)}function xc(e,t){Ur(2048,8,e,t)}function Pr(e){Ct.flags|=4;var t=Ct.updateQueue;if(t===null)t=Ja(),Ct.updateQueue=t,t.events=[e];else{var i=t.events;i===null?t.events=[e]:i.push(e)}}function cu(e){var t=mn().memoizedState;return Pr({ref:t,nextImpl:e}),function(){if((en&2)!==0)throw Error(d(440));return t.impl.apply(void 0,arguments)}}function yc(e,t){return Ur(4,2,e,t)}function pd(e,t){return Ur(4,4,e,t)}function bc(e,t){if(typeof t=="function"){e=e();var i=t(e);return function(){typeof i=="function"?i():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function mc(e,t,i){i=i!=null?i.concat([e]):null,Ur(4,4,bc.bind(null,t,e),i)}function hd(){}function du(e,t){var i=mn();t=t===void 0?null:t;var l=i.memoizedState;return t!==null&&_o(t,l[1])?l[0]:(i.memoizedState=[e,t],e)}function gd(e,t){var i=mn();t=t===void 0?null:t;var l=i.memoizedState;if(t!==null&&_o(t,l[1]))return l[0];if(l=e(),qa){Yn(!0);try{e()}finally{Yn(!1)}}return i.memoizedState=[l,t],l}function is(e,t,i){return i===void 0||(Eo&1073741824)!==0&&(Wt&261930)===0?e.memoizedState=t:(e.memoizedState=i,e=dp(),Ct.lanes|=e,Ys|=e,i)}function vc(e,t,i,l){return yn(i,t)?i:Os.current!==null?(e=is(e,i,l),yn(e,t)||(Ln=!0),e):(Eo&42)===0||(Eo&1073741824)!==0&&(Wt&261930)===0?(Ln=!0,e.memoizedState=i):(e=dp(),Ct.lanes|=e,Ys|=e,t)}function ya(e,t,i,l,a){var s=O.p;O.p=s!==0&&8>s?s:8;var h=_.T,w={};_.T=w,Tc(e,!1,t,i);try{var F=a(),de=_.S;if(de!==null&&de(w,F),F!==null&&typeof F=="object"&&typeof F.then=="function"){var Te=Tr(F,l);Er(e,t,Te,Kl(e))}else Er(e,t,l,Kl(e))}catch(De){Er(e,t,{then:function(){},status:"rejected",reason:De},Kl())}finally{O.p=s,h!==null&&w.types!==null&&(h.types=w.types),_.T=h}}function Sc(){}function Xl(e,t,i,l){if(e.tag!==5)throw Error(d(476));var a=ls(e).queue;ya(e,a,t,Y,i===null?Sc:function(){return wc(e),i(l)})}function ls(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:Y,baseState:Y,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fn,lastRenderedState:Y},next:null};var i={};return t.next={memoizedState:i,baseState:i,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fn,lastRenderedState:i},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function wc(e){var t=ls(e);t.next===null&&(t=e.alternate.memoizedState),Er(e,t.next.queue,{},Kl())}function Or(){return gi(Od)}function jc(){return mn().memoizedState}function ki(){return mn().memoizedState}function uu(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var i=Kl();e=Tl(i);var l=uo(t,e,i);l!==null&&(Al(l,t,i),ca(l,t,i)),t={cache:Wa()},e.payload=t;return}t=t.return}}function Ju(e,t,i){var l=Kl();i={lane:l,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},_r(e)?Hr(t,i):(i=Pa(e,t,i,l),i!==null&&(Al(i,e,l),fo(i,t,l)))}function xd(e,t,i){var l=Kl();Er(e,t,i,l)}function Er(e,t,i,l){var a={lane:l,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null};if(_r(e))Hr(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var h=t.lastRenderedState,w=s(h,i);if(a.hasEagerState=!0,a.eagerState=w,yn(w,h))return aa(e,t,a,0),gn===null&&Ua(),!1}catch{}finally{}if(i=Pa(e,t,a,l),i!==null)return Al(i,e,l),fo(i,t,l),!0}return!1}function Tc(e,t,i,l){if(l={lane:2,revertLane:gf(),gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},_r(e)){if(t)throw Error(d(479))}else t=Pa(e,i,l,2),t!==null&&Al(t,e,2)}function _r(e){var t=e.alternate;return e===Ct||t!==null&&t===Ct}function Hr(e,t){Hs=uc=!0;var i=e.pending;i===null?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function fo(e,t,i){if((i&4194048)!==0){var l=t.lanes;l&=e.pendingLanes,i|=l,t.lanes=i,mi(e,i)}}var Ws={readContext:gi,use:ga,useCallback:dn,useContext:dn,useEffect:dn,useImperativeHandle:dn,useLayoutEffect:dn,useInsertionEffect:dn,useMemo:dn,useReducer:dn,useRef:dn,useState:dn,useDebugValue:dn,useDeferredValue:dn,useTransition:dn,useSyncExternalStore:dn,useId:dn,useHostTransitionStatus:dn,useFormState:dn,useActionState:dn,useOptimistic:dn,useMemoCache:dn,useCacheRefresh:dn};Ws.useEffectEvent=dn;var Vo={readContext:gi,use:ga,useCallback:function(e,t){return ni().memoizedState=[e,t===void 0?null:t],e},useContext:gi,useEffect:ru,useImperativeHandle:function(e,t,i){i=i!=null?i.concat([e]):null,ns(4194308,4,bc.bind(null,t,e),i)},useLayoutEffect:function(e,t){return ns(4194308,4,e,t)},useInsertionEffect:function(e,t){ns(4,2,e,t)},useMemo:function(e,t){var i=ni();t=t===void 0?null:t;var l=e();if(qa){Yn(!0);try{e()}finally{Yn(!1)}}return i.memoizedState=[l,t],l},useReducer:function(e,t,i){var l=ni();if(i!==void 0){var a=i(t);if(qa){Yn(!0);try{i(t)}finally{Yn(!1)}}}else a=t;return l.memoizedState=l.baseState=a,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:a},l.queue=e,e=e.dispatch=Ju.bind(null,Ct,e),[l.memoizedState,e]},useRef:function(e){var t=ni();return e={current:e},t.memoizedState=e},useState:function(e){e=Br(e);var t=e.queue,i=xd.bind(null,Ct,t);return t.dispatch=i,[e.memoizedState,i]},useDebugValue:hd,useDeferredValue:function(e,t){var i=ni();return is(i,e,t)},useTransition:function(){var e=Br(!1);return e=ya.bind(null,Ct,e.queue,!0,!1),ni().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,i){var l=Ct,a=ni();if(Tt){if(i===void 0)throw Error(d(407));i=i()}else{if(i=t(),gn===null)throw Error(d(349));(Wt&127)!==0||rd(l,t,i)}a.memoizedState=i;var s={value:i,getSnapshot:t};return a.queue=s,ru(Ar.bind(null,l,s,e),[e]),l.flags|=2048,Vs(9,{destroy:void 0},xa.bind(null,l,s,i,t),null),i},useId:function(){var e=ni(),t=gn.identifierPrefix;if(Tt){var i=ui,l=hn;i=(l&~(1<<32-lt(l)-1)).toString(32)+i,t="_"+t+"R_"+i,i=fc++,0<i&&(t+="H"+i.toString(32)),t+="_"}else i=Qu++,t="_"+t+"r_"+i.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:Or,useFormState:Io,useActionState:Io,useOptimistic:function(e){var t=ni();t.memoizedState=t.baseState=e;var i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=i,t=Tc.bind(null,Ct,!0,i),i.dispatch=t,[e,t]},useMemoCache:Ho,useCacheRefresh:function(){return ni().memoizedState=uu.bind(null,Ct)},useEffectEvent:function(e){var t=ni(),i={impl:e};return t.memoizedState=i,function(){if((en&2)!==0)throw Error(d(440));return i.impl.apply(void 0,arguments)}}},zl={readContext:gi,use:ga,useCallback:du,useContext:gi,useEffect:xc,useImperativeHandle:mc,useInsertionEffect:yc,useLayoutEffect:pd,useMemo:gd,useReducer:es,useRef:su,useState:function(){return es(Fn)},useDebugValue:hd,useDeferredValue:function(e,t){var i=mn();return vc(i,nn.memoizedState,e,t)},useTransition:function(){var e=es(Fn)[0],t=mn().memoizedState;return[typeof e=="boolean"?e:rl(e),t]},useSyncExternalStore:iu,useId:jc,useHostTransitionStatus:Or,useFormState:gc,useActionState:gc,useOptimistic:function(e,t){var i=mn();return pc(i,nn,e,t)},useMemoCache:Ho,useCacheRefresh:ki};zl.useEffectEvent=cu;var yd={readContext:gi,use:ga,useCallback:du,useContext:gi,useEffect:xc,useImperativeHandle:mc,useInsertionEffect:yc,useLayoutEffect:pd,useMemo:gd,useReducer:sd,useRef:su,useState:function(){return sd(Fn)},useDebugValue:hd,useDeferredValue:function(e,t){var i=mn();return nn===null?is(i,e,t):vc(i,nn.memoizedState,e,t)},useTransition:function(){var e=sd(Fn)[0],t=mn().memoizedState;return[typeof e=="boolean"?e:rl(e),t]},useSyncExternalStore:iu,useId:jc,useHostTransitionStatus:Or,useFormState:au,useActionState:au,useOptimistic:function(e,t){var i=mn();return nn!==null?pc(i,nn,e,t):(i.baseState=e,[e,i.queue.dispatch])},useMemoCache:Ho,useCacheRefresh:ki};yd.useEffectEvent=cu;function Cc(e,t,i,l){t=e.memoizedState,i=i(l,t),i=i==null?t:he({},t,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var Ri={enqueueSetState:function(e,t,i){e=e._reactInternals;var l=Kl(),a=Tl(l);a.payload=t,i!=null&&(a.callback=i),t=uo(e,a,l),t!==null&&(Al(t,e,l),ca(t,e,l))},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var l=Kl(),a=Tl(l);a.tag=1,a.payload=t,i!=null&&(a.callback=i),t=uo(e,a,l),t!==null&&(Al(t,e,l),ca(t,e,l))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=Kl(),l=Tl(i);l.tag=2,t!=null&&(l.callback=t),t=uo(e,l,i),t!==null&&(Al(t,e,i),ca(t,e,i))}};function os(e,t,i,l,a,s,h){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,s,h):t.prototype&&t.prototype.isPureReactComponent?!hl(i,l)||!hl(a,s):!0}function ba(e,t,i,l){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(i,l),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(i,l),t.state!==e&&Ri.enqueueReplaceState(t,t.state,null)}function po(e,t){var i=t;if("ref"in t){i={};for(var l in t)l!=="ref"&&(i[l]=t[l])}if(e=e.defaultProps){i===t&&(i=he({},i));for(var a in e)i[a]===void 0&&(i[a]=e[a])}return i}function zc(e){oa(e)}function Fs(e){console.error(e)}function Ir(e){oa(e)}function as(e,t){try{var i=e.onUncaughtError;i(t.value,{componentStack:t.stack})}catch(l){setTimeout(function(){throw l})}}function kc(e,t,i){try{var l=e.onCaughtError;l(i.value,{componentStack:i.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(a){setTimeout(function(){throw a})}}function ss(e,t,i){return i=Tl(i),i.tag=3,i.payload={element:null},i.callback=function(){as(e,t)},i}function fu(e){return e=Tl(e),e.tag=3,e}function bd(e,t,i,l){var a=i.type.getDerivedStateFromError;if(typeof a=="function"){var s=l.value;e.payload=function(){return a(s)},e.callback=function(){kc(t,i,l)}}var h=i.stateNode;h!==null&&typeof h.componentDidCatch=="function"&&(e.callback=function(){kc(t,i,l),typeof a!="function"&&(Xs===null?Xs=new Set([this]):Xs.add(this));var w=l.stack;this.componentDidCatch(l.value,{componentStack:w!==null?w:""})})}function md(e,t,i,l,a){if(i.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){if(t=i.alternate,t!==null&&Ia(t,i,a,!0),i=An.current,i!==null){switch(i.tag){case 31:case 13:return Vn===null?wu():i.alternate===null&&$n===0&&($n=3),i.flags&=-257,i.flags|=65536,i.lanes=a,l===Wl?i.flags|=16384:(t=i.updateQueue,t===null?i.updateQueue=new Set([l]):t.add(l),ff(e,l,a)),!1;case 22:return i.flags|=65536,l===Wl?i.flags|=16384:(t=i.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([l])},i.updateQueue=t):(i=t.retryQueue,i===null?t.retryQueue=new Set([l]):i.add(l)),ff(e,l,a)),!1}throw Error(d(435,i.tag))}return ff(e,l,a),wu(),!1}if(Tt)return t=An.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=a,l!==bl&&(e=Error(d(422),{cause:l}),vl(Ki(e,i)))):(l!==bl&&(t=Error(d(423),{cause:l}),vl(Ki(t,i))),e=e.current.alternate,e.flags|=65536,a&=-a,e.lanes|=a,l=Ki(l,i),a=ss(e.stateNode,l,a),da(e,a),$n!==4&&($n=2)),!1;var s=Error(d(520),{cause:l});if(s=Ki(s,i),Rd===null?Rd=[s]:Rd.push(s),$n!==4&&($n=2),t===null)return!0;l=Ki(l,i),i=t;do{switch(i.tag){case 3:return i.flags|=65536,e=a&-a,i.lanes|=e,e=ss(i.stateNode,l,e),da(i,e),!1;case 1:if(t=i.type,s=i.stateNode,(i.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||s!==null&&typeof s.componentDidCatch=="function"&&(Xs===null||!Xs.has(s))))return i.flags|=65536,a&=-a,i.lanes|=a,a=fu(a),bd(a,e,i,l),da(i,a),!1}i=i.return}while(i!==null);return!1}var vd=Error(d(461)),Ln=!1;function ii(e,t,i,l){t.child=e===null?ld(t,null,i,l):Oo(t,e.child,i,l)}function Rc(e,t,i,l,a){i=i.render;var s=t.ref;if("ref"in l){var h={};for(var w in l)w!=="ref"&&(h[w]=l[w])}else h=l;return Bo(t),l=pa(e,t,i,h,s,a),w=ha(),e!==null&&!Ln?(Ka(e,t,a),v(e,t,a)):(Tt&&w&&Ci(t),t.flags|=1,ii(e,t,l,a),t.child)}function Dc(e,t,i,l,a){if(e===null){var s=i.type;return typeof s=="function"&&!Ro(s)&&s.defaultProps===void 0&&i.compare===null?(t.tag=15,t.type=s,pu(e,t,s,l,a)):(e=Do(i.type,null,l,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!x(e,a)){var h=s.memoizedProps;if(i=i.compare,i=i!==null?i:hl,i(h,l)&&e.ref===t.ref)return v(e,t,a)}return t.flags|=1,e=yl(s,l),e.ref=t.ref,e.return=t,t.child=e}function pu(e,t,i,l,a){if(e!==null){var s=e.memoizedProps;if(hl(s,l)&&e.ref===t.ref)if(Ln=!1,t.pendingProps=l=s,x(e,a))(e.flags&131072)!==0&&(Ln=!0);else return t.lanes=e.lanes,v(e,t,a)}return Vr(e,t,i,l,a)}function hu(e,t,i,l){var a=l.children,s=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.mode==="hidden"){if((t.flags&128)!==0){if(s=s!==null?s.baseLanes|i:i,e!==null){for(l=t.child=e.child,a=0;l!==null;)a=a|l.lanes|l.childLanes,l=l.sibling;l=a&~s}else l=0,t.child=null;return rs(e,t,s,i,l)}if((i&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&La(t,s!==null?s.cachePool:null),s!==null?tu(t,s):_s(),nu(t);else return l=t.lanes=536870912,rs(e,t,s!==null?s.baseLanes|i:i,i,l)}else s!==null?(La(t,s.cachePool),tu(t,s),fa(),t.memoizedState=null):(e!==null&&La(t,null),_s(),fa());return ii(e,t,a,i),t.child}function Gl(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function rs(e,t,i,l,a){var s=nd();return s=s===null?null:{parent:In._currentValue,pool:s},t.memoizedState={baseLanes:i,cachePool:s},e!==null&&La(t,null),_s(),nu(t),e!==null&&Ia(e,t,l,!0),t.childLanes=a,null}function cs(e,t){return t=o({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function gu(e,t,i){return Oo(t,e.child,null,i),e=cs(t,t.pendingProps),e.flags|=2,sl(t),t.memoizedState=null,e}function ef(e,t,i){var l=t.pendingProps,a=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(Tt){if(l.mode==="hidden")return e=cs(t,l),t.lanes=536870912,Gl(null,e);if(od(t),(e=Ut)?(e=Yp(e,pi),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:di!==null?{id:hn,overflow:ui}:null,retryLane:536870912,hydrationErrors:null},i=Jc(e),i.return=t,t.child=i,bn=t,Ut=null)):e=null,e===null)throw ol(t);return t.lanes=536870912,null}return cs(t,l)}var s=e.memoizedState;if(s!==null){var h=s.dehydrated;if(od(t),a)if(t.flags&256)t.flags&=-257,t=gu(e,t,i);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(d(558));else if(Ln||Ia(e,t,i,!1),a=(i&e.childLanes)!==0,Ln||a){if(l=gn,l!==null&&(h=kt(l,i),h!==0&&h!==s.retryLane))throw s.retryLane=h,sa(e,h),Al(l,e,h),vd;wu(),t=gu(e,t,i)}else e=s.treeContext,Ut=go(h.nextSibling),bn=t,Tt=!0,fi=null,pi=!1,e!==null&&Qi(t,e),t=cs(t,l),t.flags|=4096;return t}return e=yl(e.child,{mode:l.mode,children:l.children}),e.ref=t.ref,t.child=e,e.return=t,e}function Ls(e,t){var i=t.ref;if(i===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof i!="function"&&typeof i!="object")throw Error(d(284));(e===null||e.ref!==i)&&(t.flags|=4194816)}}function Vr(e,t,i,l,a){return Bo(t),i=pa(e,t,i,l,void 0,a),l=ha(),e!==null&&!Ln?(Ka(e,t,a),v(e,t,a)):(Tt&&l&&Ci(t),t.flags|=1,ii(e,t,i,a),t.child)}function Sd(e,t,i,l,a,s){return Bo(t),t.updateQueue=null,i=Za(t,l,i,a),Rr(e),l=ha(),e!==null&&!Ln?(Ka(e,t,s),v(e,t,s)):(Tt&&l&&Ci(t),t.flags|=1,ii(e,t,i,s),t.child)}function wd(e,t,i,l,a){if(Bo(t),t.stateNode===null){var s=ko,h=i.contextType;typeof h=="object"&&h!==null&&(s=gi(h)),s=new i(l,s),t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=Ri,t.stateNode=s,s._reactInternals=t,s=t.stateNode,s.props=l,s.state=t.memoizedState,s.refs={},cc(t),h=i.contextType,s.context=typeof h=="object"&&h!==null?gi(h):ko,s.state=t.memoizedState,h=i.getDerivedStateFromProps,typeof h=="function"&&(Cc(t,i,h,l),s.state=t.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(h=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),h!==s.state&&Ri.enqueueReplaceState(s,s.state,null),Ga(t,l,s,a),Xa(),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308),l=!0}else if(e===null){s=t.stateNode;var w=t.memoizedProps,F=po(i,w);s.props=F;var de=s.context,Te=i.contextType;h=ko,typeof Te=="object"&&Te!==null&&(h=gi(Te));var De=i.getDerivedStateFromProps;Te=typeof De=="function"||typeof s.getSnapshotBeforeUpdate=="function",w=t.pendingProps!==w,Te||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(w||de!==h)&&ba(t,s,l,h),Ll=!1;var fe=t.memoizedState;s.state=fe,Ga(t,l,s,a),Xa(),de=t.memoizedState,w||fe!==de||Ll?(typeof De=="function"&&(Cc(t,i,De,l),de=t.memoizedState),(F=Ll||os(t,i,F,l,fe,de,h))?(Te||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=l,t.memoizedState=de),s.props=l,s.state=de,s.context=h,l=F):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),l=!1)}else{s=t.stateNode,$a(e,t),h=t.memoizedProps,Te=po(i,h),s.props=Te,De=t.pendingProps,fe=s.context,de=i.contextType,F=ko,typeof de=="object"&&de!==null&&(F=gi(de)),w=i.getDerivedStateFromProps,(de=typeof w=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(h!==De||fe!==F)&&ba(t,s,l,F),Ll=!1,fe=t.memoizedState,s.state=fe,Ga(t,l,s,a),Xa();var ye=t.memoizedState;h!==De||fe!==ye||Ll||e!==null&&e.dependencies!==null&&ro(e.dependencies)?(typeof w=="function"&&(Cc(t,i,w,l),ye=t.memoizedState),(Te=Ll||os(t,i,Te,l,fe,ye,F)||e!==null&&e.dependencies!==null&&ro(e.dependencies))?(de||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(l,ye,F),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(l,ye,F)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||h===e.memoizedProps&&fe===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||h===e.memoizedProps&&fe===e.memoizedState||(t.flags|=1024),t.memoizedProps=l,t.memoizedState=ye),s.props=l,s.state=ye,s.context=F,l=Te):(typeof s.componentDidUpdate!="function"||h===e.memoizedProps&&fe===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||h===e.memoizedProps&&fe===e.memoizedState||(t.flags|=1024),l=!1)}return s=l,Ls(e,t),l=(t.flags&128)!==0,s||l?(s=t.stateNode,i=l&&typeof i.getDerivedStateFromError!="function"?null:s.render(),t.flags|=1,e!==null&&l?(t.child=Oo(t,e.child,null,a),t.child=Oo(t,null,i,a)):ii(e,t,i,a),t.memoizedState=s.state,e=t.child):e=v(e,t,a),e}function at(e,t,i,l){return _i(),t.flags|=256,ii(e,t,i,l),t.child}var ma={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Wr(e){return{baseLanes:e,cachePool:ra()}}function jd(e,t,i){return e=e!==null?e.childLanes&~i:0,t&&(e|=Zl),e}function xu(e,t,i){var l=t.pendingProps,a=!1,s=(t.flags&128)!==0,h;if((h=s)||(h=e!==null&&e.memoizedState===null?!1:(On.current&2)!==0),h&&(a=!0,t.flags&=-129),h=(t.flags&32)!==0,t.flags&=-33,e===null){if(Tt){if(a?ua(t):fa(),(e=Ut)?(e=Yp(e,pi),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:di!==null?{id:hn,overflow:ui}:null,retryLane:536870912,hydrationErrors:null},i=Jc(e),i.return=t,t.child=i,bn=t,Ut=null)):e=null,e===null)throw ol(t);return Rf(e)?t.lanes=32:t.lanes=536870912,null}var w=l.children;return l=l.fallback,a?(fa(),a=t.mode,w=o({mode:"hidden",children:w},a),l=Ea(l,a,i,null),w.return=t,l.return=t,w.sibling=l,t.child=w,l=t.child,l.memoizedState=Wr(i),l.childLanes=jd(e,h,i),t.memoizedState=ma,Gl(null,l)):(ua(t),Td(t,w))}var F=e.memoizedState;if(F!==null&&(w=F.dehydrated,w!==null)){if(s)t.flags&256?(ua(t),t.flags&=-257,t=r(e,t,i)):t.memoizedState!==null?(fa(),t.child=e.child,t.flags|=128,t=null):(fa(),w=l.fallback,a=t.mode,l=o({mode:"visible",children:l.children},a),w=Ea(w,a,i,null),w.flags|=2,l.return=t,w.return=t,l.sibling=w,t.child=l,Oo(t,e.child,null,i),l=t.child,l.memoizedState=Wr(i),l.childLanes=jd(e,h,i),t.memoizedState=ma,t=Gl(null,l));else if(ua(t),Rf(w)){if(h=w.nextSibling&&w.nextSibling.dataset,h)var de=h.dgst;h=de,l=Error(d(419)),l.stack="",l.digest=h,vl({value:l,source:null,stack:null}),t=r(e,t,i)}else if(Ln||Ia(e,t,i,!1),h=(i&e.childLanes)!==0,Ln||h){if(h=gn,h!==null&&(l=kt(h,i),l!==0&&l!==F.retryLane))throw F.retryLane=l,sa(e,l),Al(h,e,l),vd;kf(w)||wu(),t=r(e,t,i)}else kf(w)?(t.flags|=192,t.child=e.child,t=null):(e=F.treeContext,Ut=go(w.nextSibling),bn=t,Tt=!0,fi=null,pi=!1,e!==null&&Qi(t,e),t=Td(t,l.children),t.flags|=4096);return t}return a?(fa(),w=l.fallback,a=t.mode,F=e.child,de=F.sibling,l=yl(F,{mode:"hidden",children:l.children}),l.subtreeFlags=F.subtreeFlags&65011712,de!==null?w=yl(de,w):(w=Ea(w,a,i,null),w.flags|=2),w.return=t,l.return=t,l.sibling=w,t.child=l,Gl(null,l),l=t.child,w=e.child.memoizedState,w===null?w=Wr(i):(a=w.cachePool,a!==null?(F=In._currentValue,a=a.parent!==F?{parent:F,pool:F}:a):a=ra(),w={baseLanes:w.baseLanes|i,cachePool:a}),l.memoizedState=w,l.childLanes=jd(e,h,i),t.memoizedState=ma,Gl(e.child,l)):(ua(t),i=e.child,e=i.sibling,i=yl(i,{mode:"visible",children:l.children}),i.return=t,i.sibling=null,e!==null&&(h=t.deletions,h===null?(t.deletions=[e],t.flags|=16):h.push(e)),t.child=i,t.memoizedState=null,i)}function Td(e,t){return t=o({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function o(e,t){return e=ri(22,e,null,t),e.lanes=0,e}function r(e,t,i){return Oo(t,e.child,null,i),e=Td(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function f(e,t,i){e.lanes|=t;var l=e.alternate;l!==null&&(l.lanes|=t),td(e.return,t,i)}function m(e,t,i,l,a,s){var h=e.memoizedState;h===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:l,tail:i,tailMode:a,treeForkCount:s}:(h.isBackwards=t,h.rendering=null,h.renderingStartTime=0,h.last=l,h.tail=i,h.tailMode=a,h.treeForkCount=s)}function y(e,t,i){var l=t.pendingProps,a=l.revealOrder,s=l.tail;l=l.children;var h=On.current,w=(h&2)!==0;if(w?(h=h&1|2,t.flags|=128):h&=1,$(On,h),ii(e,t,l,i),l=Tt?oo:0,!w&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&f(e,i,t);else if(e.tag===19)f(e,i,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(a){case"forwards":for(i=t.child,a=null;i!==null;)e=i.alternate,e!==null&&$l(e)===null&&(a=i),i=i.sibling;i=a,i===null?(a=t.child,t.child=null):(a=i.sibling,i.sibling=null),m(t,!1,a,i,s,l);break;case"backwards":case"unstable_legacy-backwards":for(i=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&$l(e)===null){t.child=a;break}e=a.sibling,a.sibling=i,i=a,a=e}m(t,!0,i,null,s,l);break;case"together":m(t,!1,null,null,void 0,l);break;default:t.memoizedState=null}return t.child}function v(e,t,i){if(e!==null&&(t.dependencies=e.dependencies),Ys|=t.lanes,(i&t.childLanes)===0)if(e!==null){if(Ia(e,t,i,!1),(i&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(d(153));if(t.child!==null){for(e=t.child,i=yl(e,e.pendingProps),t.child=i,i.return=t;e.sibling!==null;)e=e.sibling,i=i.sibling=yl(e,e.pendingProps),i.return=t;i.sibling=null}return t.child}function x(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&ro(e)))}function T(e,t,i){switch(t.tag){case 3:xt(t,t.stateNode.containerInfo),Sl(t,In,e.memoizedState.cache),_i();break;case 27:case 5:_n(t);break;case 4:xt(t,t.stateNode.containerInfo);break;case 10:Sl(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,od(t),null;break;case 13:var l=t.memoizedState;if(l!==null)return l.dehydrated!==null?(ua(t),t.flags|=128,null):(i&t.child.childLanes)!==0?xu(e,t,i):(ua(t),e=v(e,t,i),e!==null?e.sibling:null);ua(t);break;case 19:var a=(e.flags&128)!==0;if(l=(i&t.childLanes)!==0,l||(Ia(e,t,i,!1),l=(i&t.childLanes)!==0),a){if(l)return y(e,t,i);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),$(On,On.current),l)break;return null;case 22:return t.lanes=0,hu(e,t,i,t.pendingProps);case 24:Sl(t,In,e.memoizedState.cache)}return v(e,t,i)}function C(e,t,i){if(e!==null)if(e.memoizedProps!==t.pendingProps)Ln=!0;else{if(!x(e,i)&&(t.flags&128)===0)return Ln=!1,T(e,t,i);Ln=(e.flags&131072)!==0}else Ln=!1,Tt&&(t.flags&1048576)!==0&&Ao(t,oo,t.index);switch(t.lanes=0,t.tag){case 16:e:{var l=t.pendingProps;if(e=ti(t.elementType),t.type=e,typeof e=="function")Ro(e)?(l=po(e,l),t.tag=1,t=wd(null,t,e,l,i)):(t.tag=0,t=Vr(null,t,e,l,i));else{if(e!=null){var a=e.$$typeof;if(a===ne){t.tag=11,t=Rc(null,t,e,l,i);break e}else if(a===D){t.tag=14,t=Dc(null,t,e,l,i);break e}}throw t=be(e)||e,Error(d(306,t,""))}}return t;case 0:return Vr(e,t,t.type,t.pendingProps,i);case 1:return l=t.type,a=po(l,t.pendingProps),wd(e,t,l,a,i);case 3:e:{if(xt(t,t.stateNode.containerInfo),e===null)throw Error(d(387));l=t.pendingProps;var s=t.memoizedState;a=s.element,$a(e,t),Ga(t,l,null,i);var h=t.memoizedState;if(l=h.cache,Sl(t,In,l),l!==s.cache&&mr(t,[In],i,!0),Xa(),l=h.element,s.isDehydrated)if(s={element:l,isDehydrated:!1,cache:h.cache},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){t=at(e,t,l,i);break e}else if(l!==a){a=Ki(Error(d(424)),t),vl(a),t=at(e,t,l,i);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Ut=go(e.firstChild),bn=t,Tt=!0,fi=null,pi=!0,i=ld(t,null,l,i),t.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling}else{if(_i(),l===a){t=v(e,t,i);break e}ii(e,t,l,i)}t=t.child}return t;case 26:return Ls(e,t),e===null?(i=Qp(t.type,null,t.pendingProps,null))?t.memoizedState=i:Tt||(i=t.type,e=t.pendingProps,l=Du(Ge.current).createElement(i),l[ft]=t,l[Bn]=e,Ii(l,i,e),Ot(l),t.stateNode=l):t.memoizedState=Qp(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return _n(t),e===null&&Tt&&(l=t.stateNode=qp(t.type,t.pendingProps,Ge.current),bn=t,pi=!0,a=Ut,Ks(t.type)?(Df=a,Ut=go(l.firstChild)):Ut=a),ii(e,t,t.pendingProps.children,i),Ls(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Tt&&((a=l=Ut)&&(l=cg(l,t.type,t.pendingProps,pi),l!==null?(t.stateNode=l,bn=t,Ut=go(l.firstChild),pi=!1,a=!0):a=!1),a||ol(t)),_n(t),a=t.type,s=t.pendingProps,h=e!==null?e.memoizedProps:null,l=s.children,Tf(a,s)?l=null:h!==null&&Tf(a,h)&&(t.flags|=32),t.memoizedState!==null&&(a=pa(e,t,ad,null,null,i),Od._currentValue=a),Ls(e,t),ii(e,t,l,i),t.child;case 6:return e===null&&Tt&&((e=i=Ut)&&(i=dg(i,t.pendingProps,pi),i!==null?(t.stateNode=i,bn=t,Ut=null,e=!0):e=!1),e||ol(t)),null;case 13:return xu(e,t,i);case 4:return xt(t,t.stateNode.containerInfo),l=t.pendingProps,e===null?t.child=Oo(t,null,l,i):ii(e,t,l,i),t.child;case 11:return Rc(e,t,t.type,t.pendingProps,i);case 7:return ii(e,t,t.pendingProps,i),t.child;case 8:return ii(e,t,t.pendingProps.children,i),t.child;case 12:return ii(e,t,t.pendingProps.children,i),t.child;case 10:return l=t.pendingProps,Sl(t,t.type,l.value),ii(e,t,l.children,i),t.child;case 9:return a=t.type._context,l=t.pendingProps.children,Bo(t),a=gi(a),l=l(a),t.flags|=1,ii(e,t,l,i),t.child;case 14:return Dc(e,t,t.type,t.pendingProps,i);case 15:return pu(e,t,t.type,t.pendingProps,i);case 19:return y(e,t,i);case 31:return ef(e,t,i);case 22:return hu(e,t,i,t.pendingProps);case 24:return Bo(t),l=gi(In),e===null?(a=nd(),a===null&&(a=gn,s=Wa(),a.pooledCache=s,s.refCount++,s!==null&&(a.pooledCacheLanes|=i),a=s),t.memoizedState={parent:l,cache:a},cc(t),Sl(t,In,a)):((e.lanes&i)!==0&&($a(e,t),Ga(t,null,null,i),Xa()),a=e.memoizedState,s=t.memoizedState,a.parent!==l?(a={parent:l,cache:l},t.memoizedState=a,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=a),Sl(t,In,l)):(l=s.cache,Sl(t,In,l),l!==a.cache&&mr(t,[In],i,!0))),ii(e,t,t.pendingProps.children,i),t.child;case 29:throw t.pendingProps}throw Error(d(156,t.tag))}function k(e){e.flags|=4}function N(e,t,i,l,a){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(a&335544128)===a)if(e.stateNode.complete)e.flags|=8192;else if(hp())e.flags|=8192;else throw Fl=Wl,co}else e.flags&=-16777217}function U(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!ih(t))if(hp())e.flags|=8192;else throw Fl=Wl,co}function le(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?$i():536870912,e.lanes|=t,Bc|=t)}function K(e,t){if(!Tt)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function X(e){var t=e.alternate!==null&&e.alternate.child===e.child,i=0,l=0;if(t)for(var a=e.child;a!==null;)i|=a.lanes|a.childLanes,l|=a.subtreeFlags&65011712,l|=a.flags&65011712,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)i|=a.lanes|a.childLanes,l|=a.subtreeFlags,l|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=l,e.childLanes=i,t}function oe(e,t,i){var l=t.pendingProps;switch(ao(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return X(t),null;case 1:return X(t),null;case 3:return i=t.stateNode,l=null,e!==null&&(l=e.memoizedState.cache),t.memoizedState.cache!==l&&(t.flags|=2048),Mo(In),Pe(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(hi(t)?k(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,ml())),X(t),null;case 26:var a=t.type,s=t.memoizedState;return e===null?(k(t),s!==null?(X(t),U(t,s)):(X(t),N(t,a,null,l,i))):s?s!==e.memoizedState?(k(t),X(t),U(t,s)):(X(t),t.flags&=-16777217):(e=e.memoizedProps,e!==l&&k(t),X(t),N(t,a,e,l,i)),null;case 27:if(Mn(t),i=Ge.current,a=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==l&&k(t);else{if(!l){if(t.stateNode===null)throw Error(d(166));return X(t),null}e=Z.current,hi(t)?al(t):(e=qp(a,l,i),t.stateNode=e,k(t))}return X(t),null;case 5:if(Mn(t),a=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==l&&k(t);else{if(!l){if(t.stateNode===null)throw Error(d(166));return X(t),null}if(s=Z.current,hi(t))al(t);else{var h=Du(Ge.current);switch(s){case 1:s=h.createElementNS("http://www.w3.org/2000/svg",a);break;case 2:s=h.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;default:switch(a){case"svg":s=h.createElementNS("http://www.w3.org/2000/svg",a);break;case"math":s=h.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;case"script":s=h.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof l.is=="string"?h.createElement("select",{is:l.is}):h.createElement("select"),l.multiple?s.multiple=!0:l.size&&(s.size=l.size);break;default:s=typeof l.is=="string"?h.createElement(a,{is:l.is}):h.createElement(a)}}s[ft]=t,s[Bn]=l;e:for(h=t.child;h!==null;){if(h.tag===5||h.tag===6)s.appendChild(h.stateNode);else if(h.tag!==4&&h.tag!==27&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}t.stateNode=s;e:switch(Ii(s,a,l),a){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}l&&k(t)}}return X(t),N(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,i),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==l&&k(t);else{if(typeof l!="string"&&t.stateNode===null)throw Error(d(166));if(e=Ge.current,hi(t)){if(e=t.stateNode,i=t.memoizedProps,l=null,a=bn,a!==null)switch(a.tag){case 27:case 5:l=a.memoizedProps}e[ft]=t,e=!!(e.nodeValue===i||l!==null&&l.suppressHydrationWarning===!0||_p(e.nodeValue,i)),e||ol(t,!0)}else e=Du(e).createTextNode(l),e[ft]=t,t.stateNode=e}return X(t),null;case 31:if(i=t.memoizedState,e===null||e.memoizedState!==null){if(l=hi(t),i!==null){if(e===null){if(!l)throw Error(d(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(d(557));e[ft]=t}else _i(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;X(t),e=!1}else i=ml(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=i),e=!0;if(!e)return t.flags&256?(sl(t),t):(sl(t),null);if((t.flags&128)!==0)throw Error(d(558))}return X(t),null;case 13:if(l=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(a=hi(t),l!==null&&l.dehydrated!==null){if(e===null){if(!a)throw Error(d(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(d(317));a[ft]=t}else _i(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;X(t),a=!1}else a=ml(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=a),a=!0;if(!a)return t.flags&256?(sl(t),t):(sl(t),null)}return sl(t),(t.flags&128)!==0?(t.lanes=i,t):(i=l!==null,e=e!==null&&e.memoizedState!==null,i&&(l=t.child,a=null,l.alternate!==null&&l.alternate.memoizedState!==null&&l.alternate.memoizedState.cachePool!==null&&(a=l.alternate.memoizedState.cachePool.pool),s=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(s=l.memoizedState.cachePool.pool),s!==a&&(l.flags|=2048)),i!==e&&i&&(t.child.flags|=8192),le(t,t.updateQueue),X(t),null);case 4:return Pe(),e===null&&mf(t.stateNode.containerInfo),X(t),null;case 10:return Mo(t.type),X(t),null;case 19:if(A(On),l=t.memoizedState,l===null)return X(t),null;if(a=(t.flags&128)!==0,s=l.rendering,s===null)if(a)K(l,!1);else{if($n!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(s=$l(e),s!==null){for(t.flags|=128,K(l,!1),e=s.updateQueue,t.updateQueue=e,le(t,e),t.subtreeFlags=0,e=i,i=t.child;i!==null;)Oa(i,e),i=i.sibling;return $(On,On.current&1|2),Tt&&Dn(t,l.treeForkCount),t.child}e=e.sibling}l.tail!==null&&ut()>mu&&(t.flags|=128,a=!0,K(l,!1),t.lanes=4194304)}else{if(!a)if(e=$l(s),e!==null){if(t.flags|=128,a=!0,e=e.updateQueue,t.updateQueue=e,le(t,e),K(l,!0),l.tail===null&&l.tailMode==="hidden"&&!s.alternate&&!Tt)return X(t),null}else 2*ut()-l.renderingStartTime>mu&&i!==536870912&&(t.flags|=128,a=!0,K(l,!1),t.lanes=4194304);l.isBackwards?(s.sibling=t.child,t.child=s):(e=l.last,e!==null?e.sibling=s:t.child=s,l.last=s)}return l.tail!==null?(e=l.tail,l.rendering=e,l.tail=e.sibling,l.renderingStartTime=ut(),e.sibling=null,i=On.current,$(On,a?i&1|2:i&1),Tt&&Dn(t,l.treeForkCount),e):(X(t),null);case 22:case 23:return sl(t),Cl(),l=t.memoizedState!==null,e!==null?e.memoizedState!==null!==l&&(t.flags|=8192):l&&(t.flags|=8192),l?(i&536870912)!==0&&(t.flags&128)===0&&(X(t),t.subtreeFlags&6&&(t.flags|=8192)):X(t),i=t.updateQueue,i!==null&&le(t,i.retryQueue),i=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(i=e.memoizedState.cachePool.pool),l=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(l=t.memoizedState.cachePool.pool),l!==i&&(t.flags|=2048),e!==null&&A(wl),null;case 24:return i=null,e!==null&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),Mo(In),X(t),null;case 25:return null;case 30:return null}throw Error(d(156,t.tag))}function ae(e,t){switch(ao(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Mo(In),Pe(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Mn(t),null;case 31:if(t.memoizedState!==null){if(sl(t),t.alternate===null)throw Error(d(340));_i()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(sl(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(d(340));_i()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return A(On),null;case 4:return Pe(),null;case 10:return Mo(t.type),null;case 22:case 23:return sl(t),Cl(),e!==null&&A(wl),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Mo(In),null;case 25:return null;default:return null}}function ee(e,t){switch(ao(t),t.tag){case 3:Mo(In),Pe();break;case 26:case 27:case 5:Mn(t);break;case 4:Pe();break;case 31:t.memoizedState!==null&&sl(t);break;case 13:sl(t);break;case 19:A(On);break;case 10:Mo(t.type);break;case 22:case 23:sl(t),Cl(),e!==null&&A(wl);break;case 24:Mo(In)}}function ve(e,t){try{var i=t.updateQueue,l=i!==null?i.lastEffect:null;if(l!==null){var a=l.next;i=a;do{if((i.tag&e)===e){l=void 0;var s=i.create,h=i.inst;l=s(),h.destroy=l}i=i.next}while(i!==a)}}catch(w){sn(t,t.return,w)}}function Ae(e,t,i){try{var l=t.updateQueue,a=l!==null?l.lastEffect:null;if(a!==null){var s=a.next;l=s;do{if((l.tag&e)===e){var h=l.inst,w=h.destroy;if(w!==void 0){h.destroy=void 0,a=t;var F=i,de=w;try{de()}catch(Te){sn(a,F,Te)}}}l=l.next}while(l!==s)}}catch(Te){sn(t,t.return,Te)}}function Re(e){var t=e.updateQueue;if(t!==null){var i=e.stateNode;try{dc(t,i)}catch(l){sn(e,e.return,l)}}}function ze(e,t,i){i.props=po(e.type,e.memoizedProps),i.state=e.memoizedState;try{i.componentWillUnmount()}catch(l){sn(e,t,l)}}function Ve(e,t){try{var i=e.ref;if(i!==null){switch(e.tag){case 26:case 27:case 5:var l=e.stateNode;break;case 30:l=e.stateNode;break;default:l=e.stateNode}typeof i=="function"?e.refCleanup=i(l):i.current=l}}catch(a){sn(e,t,a)}}function Ie(e,t){var i=e.ref,l=e.refCleanup;if(i!==null)if(typeof l=="function")try{l()}catch(a){sn(e,t,a)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof i=="function")try{i(null)}catch(a){sn(e,t,a)}else i.current=null}function Q(e){var t=e.type,i=e.memoizedProps,l=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":i.autoFocus&&l.focus();break e;case"img":i.src?l.src=i.src:i.srcSet&&(l.srcset=i.srcSet)}}catch(a){sn(e,e.return,a)}}function H(e,t,i){try{var l=e.stateNode;ig(l,e.type,i,t),l[Bn]=t}catch(a){sn(e,e.return,a)}}function Se(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Ks(e.type)||e.tag===4}function ge(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Se(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Ks(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ue(e,t,i){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i).insertBefore(e,t):(t=i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,t.appendChild(e),i=i._reactRootContainer,i!=null||t.onclick!==null||(t.onclick=jt));else if(l!==4&&(l===27&&Ks(e.type)&&(i=e.stateNode,t=null),e=e.child,e!==null))for(Ue(e,t,i),e=e.sibling;e!==null;)Ue(e,t,i),e=e.sibling}function We(e,t,i){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?i.insertBefore(e,t):i.appendChild(e);else if(l!==4&&(l===27&&Ks(e.type)&&(i=e.stateNode),e=e.child,e!==null))for(We(e,t,i),e=e.sibling;e!==null;)We(e,t,i),e=e.sibling}function ot(e){var t=e.stateNode,i=e.memoizedProps;try{for(var l=e.type,a=t.attributes;a.length;)t.removeAttributeNode(a[0]);Ii(t,l,i),t[ft]=e,t[Bn]=i}catch(s){sn(e,e.return,s)}}var Ye=!1,qe=!1,it=!1,wt=typeof WeakSet=="function"?WeakSet:Set,$e=null;function Ee(e,t){if(e=e.containerInfo,wf=Ou,e=zo(e),ll(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var l=i.getSelection&&i.getSelection();if(l&&l.rangeCount!==0){i=l.anchorNode;var a=l.anchorOffset,s=l.focusNode;l=l.focusOffset;try{i.nodeType,s.nodeType}catch{i=null;break e}var h=0,w=-1,F=-1,de=0,Te=0,De=e,fe=null;t:for(;;){for(var ye;De!==i||a!==0&&De.nodeType!==3||(w=h+a),De!==s||l!==0&&De.nodeType!==3||(F=h+l),De.nodeType===3&&(h+=De.nodeValue.length),(ye=De.firstChild)!==null;)fe=De,De=ye;for(;;){if(De===e)break t;if(fe===i&&++de===a&&(w=h),fe===s&&++Te===l&&(F=h),(ye=De.nextSibling)!==null)break;De=fe,fe=De.parentNode}De=ye}i=w===-1||F===-1?null:{start:w,end:F}}else i=null}i=i||{start:0,end:0}}else i=null;for(jf={focusedElem:e,selectionRange:i},Ou=!1,$e=t;$e!==null;)if(t=$e,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,$e=e;else for(;$e!==null;){switch(t=$e,s=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(i=0;i<e.length;i++)a=e[i],a.ref.impl=a.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&s!==null){e=void 0,i=t,a=s.memoizedProps,s=s.memoizedState,l=i.stateNode;try{var Qe=po(i.type,a);e=l.getSnapshotBeforeUpdate(Qe,s),l.__reactInternalSnapshotBeforeUpdate=e}catch(bt){sn(i,i.return,bt)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,i=e.nodeType,i===9)zf(e);else if(i===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":zf(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(d(163))}if(e=t.sibling,e!==null){e.return=t.return,$e=e;break}$e=t.return}}function ht(e,t,i){var l=i.flags;switch(i.tag){case 0:case 11:case 15:ds(e,i),l&4&&ve(5,i);break;case 1:if(ds(e,i),l&4)if(e=i.stateNode,t===null)try{e.componentDidMount()}catch(h){sn(i,i.return,h)}else{var a=po(i.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(a,t,e.__reactInternalSnapshotBeforeUpdate)}catch(h){sn(i,i.return,h)}}l&64&&Re(i),l&512&&Ve(i,i.return);break;case 3:if(ds(e,i),l&64&&(e=i.updateQueue,e!==null)){if(t=null,i.child!==null)switch(i.child.tag){case 27:case 5:t=i.child.stateNode;break;case 1:t=i.child.stateNode}try{dc(e,t)}catch(h){sn(i,i.return,h)}}break;case 27:t===null&&l&4&&ot(i);case 26:case 5:ds(e,i),t===null&&l&4&&Q(i),l&512&&Ve(i,i.return);break;case 12:ds(e,i);break;case 31:ds(e,i),l&4&&St(e,i);break;case 13:ds(e,i),l&4&&ho(e,i),l&64&&(e=i.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(i=$h.bind(null,i),ug(e,i))));break;case 22:if(l=i.memoizedState!==null||Ye,!l){t=t!==null&&t.memoizedState!==null||qe,a=Ye;var s=qe;Ye=l,(qe=t)&&!s?us(e,i,(i.subtreeFlags&8772)!==0):ds(e,i),Ye=a,qe=s}break;case 30:break;default:ds(e,i)}}function qt(e){var t=e.alternate;t!==null&&(e.alternate=null,qt(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Xo(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var gt=null,Nt=!1;function Jt(e,t,i){for(i=i.child;i!==null;)Tn(e,t,i),i=i.sibling}function Tn(e,t,i){if(Ne&&typeof Ne.onCommitFiberUnmount=="function")try{Ne.onCommitFiberUnmount(Wi,i)}catch{}switch(i.tag){case 26:qe||Ie(i,t),Jt(e,t,i),i.memoizedState?i.memoizedState.count--:i.stateNode&&(i=i.stateNode,i.parentNode.removeChild(i));break;case 27:qe||Ie(i,t);var l=gt,a=Nt;Ks(i.type)&&(gt=i.stateNode,Nt=!1),Jt(e,t,i),Bd(i.stateNode),gt=l,Nt=a;break;case 5:qe||Ie(i,t);case 6:if(l=gt,a=Nt,gt=null,Jt(e,t,i),gt=l,Nt=a,gt!==null)if(Nt)try{(gt.nodeType===9?gt.body:gt.nodeName==="HTML"?gt.ownerDocument.body:gt).removeChild(i.stateNode)}catch(s){sn(i,t,s)}else try{gt.removeChild(i.stateNode)}catch(s){sn(i,t,s)}break;case 18:gt!==null&&(Nt?(e=gt,Lp(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,i.stateNode),Vc(e)):Lp(gt,i.stateNode));break;case 4:l=gt,a=Nt,gt=i.stateNode.containerInfo,Nt=!0,Jt(e,t,i),gt=l,Nt=a;break;case 0:case 11:case 14:case 15:Ae(2,i,t),qe||Ae(4,i,t),Jt(e,t,i);break;case 1:qe||(Ie(i,t),l=i.stateNode,typeof l.componentWillUnmount=="function"&&ze(i,t,l)),Jt(e,t,i);break;case 21:Jt(e,t,i);break;case 22:qe=(l=qe)||i.memoizedState!==null,Jt(e,t,i),qe=l;break;default:Jt(e,t,i)}}function St(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Vc(e)}catch(i){sn(t,t.return,i)}}}function ho(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Vc(e)}catch(i){sn(t,t.return,i)}}function Wo(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new wt),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new wt),t;default:throw Error(d(435,e.tag))}}function Hi(e,t){var i=Wo(e);t.forEach(function(l){if(!i.has(l)){i.add(l);var a=Yh.bind(null,e,l);l.then(a,a)}})}function kl(e,t){var i=t.deletions;if(i!==null)for(var l=0;l<i.length;l++){var a=i[l],s=e,h=t,w=h;e:for(;w!==null;){switch(w.tag){case 27:if(Ks(w.type)){gt=w.stateNode,Nt=!1;break e}break;case 5:gt=w.stateNode,Nt=!1;break e;case 3:case 4:gt=w.stateNode.containerInfo,Nt=!0;break e}w=w.return}if(gt===null)throw Error(d(160));Tn(s,h,a),gt=null,Nt=!1,s=a.alternate,s!==null&&(s.return=null),a.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)tp(t,e),t=t.sibling}var Fo=null;function tp(e,t){var i=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:kl(t,e),Rl(e),l&4&&(Ae(3,e,e.return),ve(3,e),Ae(5,e,e.return));break;case 1:kl(t,e),Rl(e),l&512&&(qe||i===null||Ie(i,i.return)),l&64&&Ye&&(e=e.updateQueue,e!==null&&(l=e.callbacks,l!==null&&(i=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=i===null?l:i.concat(l))));break;case 26:var a=Fo;if(kl(t,e),Rl(e),l&512&&(qe||i===null||Ie(i,i.return)),l&4){var s=i!==null?i.memoizedState:null;if(l=e.memoizedState,i===null)if(l===null)if(e.stateNode===null){e:{l=e.type,i=e.memoizedProps,a=a.ownerDocument||a;t:switch(l){case"title":s=a.getElementsByTagName("title")[0],(!s||s[wo]||s[ft]||s.namespaceURI==="http://www.w3.org/2000/svg"||s.hasAttribute("itemprop"))&&(s=a.createElement(l),a.head.insertBefore(s,a.querySelector("head > title"))),Ii(s,l,i),s[ft]=e,Ot(s),l=s;break e;case"link":var h=th("link","href",a).get(l+(i.href||""));if(h){for(var w=0;w<h.length;w++)if(s=h[w],s.getAttribute("href")===(i.href==null||i.href===""?null:i.href)&&s.getAttribute("rel")===(i.rel==null?null:i.rel)&&s.getAttribute("title")===(i.title==null?null:i.title)&&s.getAttribute("crossorigin")===(i.crossOrigin==null?null:i.crossOrigin)){h.splice(w,1);break t}}s=a.createElement(l),Ii(s,l,i),a.head.appendChild(s);break;case"meta":if(h=th("meta","content",a).get(l+(i.content||""))){for(w=0;w<h.length;w++)if(s=h[w],s.getAttribute("content")===(i.content==null?null:""+i.content)&&s.getAttribute("name")===(i.name==null?null:i.name)&&s.getAttribute("property")===(i.property==null?null:i.property)&&s.getAttribute("http-equiv")===(i.httpEquiv==null?null:i.httpEquiv)&&s.getAttribute("charset")===(i.charSet==null?null:i.charSet)){h.splice(w,1);break t}}s=a.createElement(l),Ii(s,l,i),a.head.appendChild(s);break;default:throw Error(d(468,l))}s[ft]=e,Ot(s),l=s}e.stateNode=l}else nh(a,e.type,e.stateNode);else e.stateNode=eh(a,l,e.memoizedProps);else s!==l?(s===null?i.stateNode!==null&&(i=i.stateNode,i.parentNode.removeChild(i)):s.count--,l===null?nh(a,e.type,e.stateNode):eh(a,l,e.memoizedProps)):l===null&&e.stateNode!==null&&H(e,e.memoizedProps,i.memoizedProps)}break;case 27:kl(t,e),Rl(e),l&512&&(qe||i===null||Ie(i,i.return)),i!==null&&l&4&&H(e,e.memoizedProps,i.memoizedProps);break;case 5:if(kl(t,e),Rl(e),l&512&&(qe||i===null||Ie(i,i.return)),e.flags&32){a=e.stateNode;try{mt(a,"")}catch(Qe){sn(e,e.return,Qe)}}l&4&&e.stateNode!=null&&(a=e.memoizedProps,H(e,a,i!==null?i.memoizedProps:a)),l&1024&&(it=!0);break;case 6:if(kl(t,e),Rl(e),l&4){if(e.stateNode===null)throw Error(d(162));l=e.memoizedProps,i=e.stateNode;try{i.nodeValue=l}catch(Qe){sn(e,e.return,Qe)}}break;case 3:if(Mu=null,a=Fo,Fo=Au(t.containerInfo),kl(t,e),Fo=a,Rl(e),l&4&&i!==null&&i.memoizedState.isDehydrated)try{Vc(t.containerInfo)}catch(Qe){sn(e,e.return,Qe)}it&&(it=!1,np(e));break;case 4:l=Fo,Fo=Au(e.stateNode.containerInfo),kl(t,e),Rl(e),Fo=l;break;case 12:kl(t,e),Rl(e);break;case 31:kl(t,e),Rl(e),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,Hi(e,l)));break;case 13:kl(t,e),Rl(e),e.child.flags&8192&&e.memoizedState!==null!=(i!==null&&i.memoizedState!==null)&&(bu=ut()),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,Hi(e,l)));break;case 22:a=e.memoizedState!==null;var F=i!==null&&i.memoizedState!==null,de=Ye,Te=qe;if(Ye=de||a,qe=Te||F,kl(t,e),qe=Te,Ye=de,Rl(e),l&8192)e:for(t=e.stateNode,t._visibility=a?t._visibility&-2:t._visibility|1,a&&(i===null||F||Ye||qe||Fr(e)),i=null,t=e;;){if(t.tag===5||t.tag===26){if(i===null){F=i=t;try{if(s=F.stateNode,a)h=s.style,typeof h.setProperty=="function"?h.setProperty("display","none","important"):h.display="none";else{w=F.stateNode;var De=F.memoizedProps.style,fe=De!=null&&De.hasOwnProperty("display")?De.display:null;w.style.display=fe==null||typeof fe=="boolean"?"":(""+fe).trim()}}catch(Qe){sn(F,F.return,Qe)}}}else if(t.tag===6){if(i===null){F=t;try{F.stateNode.nodeValue=a?"":F.memoizedProps}catch(Qe){sn(F,F.return,Qe)}}}else if(t.tag===18){if(i===null){F=t;try{var ye=F.stateNode;a?$p(ye,!0):$p(F.stateNode,!1)}catch(Qe){sn(F,F.return,Qe)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;i===t&&(i=null),t=t.return}i===t&&(i=null),t.sibling.return=t.return,t=t.sibling}l&4&&(l=e.updateQueue,l!==null&&(i=l.retryQueue,i!==null&&(l.retryQueue=null,Hi(e,i))));break;case 19:kl(t,e),Rl(e),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,Hi(e,l)));break;case 30:break;case 21:break;default:kl(t,e),Rl(e)}}function Rl(e){var t=e.flags;if(t&2){try{for(var i,l=e.return;l!==null;){if(Se(l)){i=l;break}l=l.return}if(i==null)throw Error(d(160));switch(i.tag){case 27:var a=i.stateNode,s=ge(e);We(e,s,a);break;case 5:var h=i.stateNode;i.flags&32&&(mt(h,""),i.flags&=-33);var w=ge(e);We(e,w,h);break;case 3:case 4:var F=i.stateNode.containerInfo,de=ge(e);Ue(e,de,F);break;default:throw Error(d(161))}}catch(Te){sn(e,e.return,Te)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function np(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;np(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function ds(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)ht(e,t.alternate,t),t=t.sibling}function Fr(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Ae(4,t,t.return),Fr(t);break;case 1:Ie(t,t.return);var i=t.stateNode;typeof i.componentWillUnmount=="function"&&ze(t,t.return,i),Fr(t);break;case 27:Bd(t.stateNode);case 26:case 5:Ie(t,t.return),Fr(t);break;case 22:t.memoizedState===null&&Fr(t);break;case 30:Fr(t);break;default:Fr(t)}e=e.sibling}}function us(e,t,i){for(i=i&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var l=t.alternate,a=e,s=t,h=s.flags;switch(s.tag){case 0:case 11:case 15:us(a,s,i),ve(4,s);break;case 1:if(us(a,s,i),l=s,a=l.stateNode,typeof a.componentDidMount=="function")try{a.componentDidMount()}catch(de){sn(l,l.return,de)}if(l=s,a=l.updateQueue,a!==null){var w=l.stateNode;try{var F=a.shared.hiddenCallbacks;if(F!==null)for(a.shared.hiddenCallbacks=null,a=0;a<F.length;a++)zr(F[a],w)}catch(de){sn(l,l.return,de)}}i&&h&64&&Re(s),Ve(s,s.return);break;case 27:ot(s);case 26:case 5:us(a,s,i),i&&l===null&&h&4&&Q(s),Ve(s,s.return);break;case 12:us(a,s,i);break;case 31:us(a,s,i),i&&h&4&&St(a,s);break;case 13:us(a,s,i),i&&h&4&&ho(a,s);break;case 22:s.memoizedState===null&&us(a,s,i),Ve(s,s.return);break;case 30:break;default:us(a,s,i)}t=t.sibling}}function tf(e,t){var i=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(i=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==i&&(e!=null&&e.refCount++,i!=null&&Sr(i))}function nf(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Sr(e))}function Lo(e,t,i,l){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)ip(e,t,i,l),t=t.sibling}function ip(e,t,i,l){var a=t.flags;switch(t.tag){case 0:case 11:case 15:Lo(e,t,i,l),a&2048&&ve(9,t);break;case 1:Lo(e,t,i,l);break;case 3:Lo(e,t,i,l),a&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Sr(e)));break;case 12:if(a&2048){Lo(e,t,i,l),e=t.stateNode;try{var s=t.memoizedProps,h=s.id,w=s.onPostCommit;typeof w=="function"&&w(h,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(F){sn(t,t.return,F)}}else Lo(e,t,i,l);break;case 31:Lo(e,t,i,l);break;case 13:Lo(e,t,i,l);break;case 23:break;case 22:s=t.stateNode,h=t.alternate,t.memoizedState!==null?s._visibility&2?Lo(e,t,i,l):Cd(e,t):s._visibility&2?Lo(e,t,i,l):(s._visibility|=2,Ac(e,t,i,l,(t.subtreeFlags&10256)!==0||!1)),a&2048&&tf(h,t);break;case 24:Lo(e,t,i,l),a&2048&&nf(t.alternate,t);break;default:Lo(e,t,i,l)}}function Ac(e,t,i,l,a){for(a=a&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var s=e,h=t,w=i,F=l,de=h.flags;switch(h.tag){case 0:case 11:case 15:Ac(s,h,w,F,a),ve(8,h);break;case 23:break;case 22:var Te=h.stateNode;h.memoizedState!==null?Te._visibility&2?Ac(s,h,w,F,a):Cd(s,h):(Te._visibility|=2,Ac(s,h,w,F,a)),a&&de&2048&&tf(h.alternate,h);break;case 24:Ac(s,h,w,F,a),a&&de&2048&&nf(h.alternate,h);break;default:Ac(s,h,w,F,a)}t=t.sibling}}function Cd(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var i=e,l=t,a=l.flags;switch(l.tag){case 22:Cd(i,l),a&2048&&tf(l.alternate,l);break;case 24:Cd(i,l),a&2048&&nf(l.alternate,l);break;default:Cd(i,l)}t=t.sibling}}var zd=8192;function Nc(e,t,i){if(e.subtreeFlags&zd)for(e=e.child;e!==null;)lp(e,t,i),e=e.sibling}function lp(e,t,i){switch(e.tag){case 26:Nc(e,t,i),e.flags&zd&&e.memoizedState!==null&&jg(i,Fo,e.memoizedState,e.memoizedProps);break;case 5:Nc(e,t,i);break;case 3:case 4:var l=Fo;Fo=Au(e.stateNode.containerInfo),Nc(e,t,i),Fo=l;break;case 22:e.memoizedState===null&&(l=e.alternate,l!==null&&l.memoizedState!==null?(l=zd,zd=16777216,Nc(e,t,i),zd=l):Nc(e,t,i));break;default:Nc(e,t,i)}}function op(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function kd(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var i=0;i<t.length;i++){var l=t[i];$e=l,sp(l,e)}op(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)ap(e),e=e.sibling}function ap(e){switch(e.tag){case 0:case 11:case 15:kd(e),e.flags&2048&&Ae(9,e,e.return);break;case 3:kd(e);break;case 12:kd(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,yu(e)):kd(e);break;default:kd(e)}}function yu(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var i=0;i<t.length;i++){var l=t[i];$e=l,sp(l,e)}op(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:Ae(8,t,t.return),yu(t);break;case 22:i=t.stateNode,i._visibility&2&&(i._visibility&=-3,yu(t));break;default:yu(t)}e=e.sibling}}function sp(e,t){for(;$e!==null;){var i=$e;switch(i.tag){case 0:case 11:case 15:Ae(8,i,t);break;case 23:case 22:if(i.memoizedState!==null&&i.memoizedState.cachePool!==null){var l=i.memoizedState.cachePool.pool;l!=null&&l.refCount++}break;case 24:Sr(i.memoizedState.cache)}if(l=i.child,l!==null)l.return=i,$e=l;else e:for(i=e;$e!==null;){l=$e;var a=l.sibling,s=l.return;if(qt(l),l===i){$e=null;break e}if(a!==null){a.return=s,$e=a;break e}$e=s}}}var _h={getCacheForType:function(e){var t=gi(In),i=t.data.get(e);return i===void 0&&(i=e(),t.data.set(e,i)),i},cacheSignal:function(){return gi(In).controller.signal}},Hh=typeof WeakMap=="function"?WeakMap:Map,en=0,gn=null,Et=null,Wt=0,an=0,ql=null,$s=!1,Mc=!1,lf=!1,fs=0,$n=0,Ys=0,Lr=0,of=0,Zl=0,Bc=0,Rd=null,Dl=null,af=!1,bu=0,rp=0,mu=1/0,vu=null,Xs=null,xi=0,Gs=null,Uc=null,ps=0,sf=0,rf=null,cp=null,Dd=0,cf=null;function Kl(){return(en&2)!==0&&Wt!==0?Wt&-Wt:_.T!==null?gf():or()}function dp(){if(Zl===0)if((Wt&536870912)===0||Tt){var e=Sa;Sa<<=1,(Sa&3932160)===0&&(Sa=262144),Zl=e}else Zl=536870912;return e=An.current,e!==null&&(e.flags|=32),Zl}function Al(e,t,i){(e===gn&&(an===2||an===9)||e.cancelPendingCommit!==null)&&(Pc(e,0),qs(e,Wt,Zl,!1)),no(e,i),((en&2)===0||e!==gn)&&(e===gn&&((en&2)===0&&(Lr|=i),$n===4&&qs(e,Wt,Zl,!1)),va(e))}function up(e,t,i){if((en&6)!==0)throw Error(d(327));var l=!i&&(t&127)===0&&(t&e.expiredLanes)===0||Li(e,t),a=l?Wh(e,t):uf(e,t,!0),s=l;do{if(a===0){Mc&&!l&&qs(e,t,0,!1);break}else{if(i=e.current.alternate,s&&!Ih(i)){a=uf(e,t,!1),s=!1;continue}if(a===2){if(s=t,e.errorRecoveryDisabledLanes&s)var h=0;else h=e.pendingLanes&-536870913,h=h!==0?h:h&536870912?536870912:0;if(h!==0){t=h;e:{var w=e;a=Rd;var F=w.current.memoizedState.isDehydrated;if(F&&(Pc(w,h).flags|=256),h=uf(w,h,!1),h!==2){if(lf&&!F){w.errorRecoveryDisabledLanes|=s,Lr|=s,a=4;break e}s=Dl,Dl=a,s!==null&&(Dl===null?Dl=s:Dl.push.apply(Dl,s))}a=h}if(s=!1,a!==2)continue}}if(a===1){Pc(e,0),qs(e,t,0,!0);break}e:{switch(l=e,s=a,s){case 0:case 1:throw Error(d(345));case 4:if((t&4194048)!==t)break;case 6:qs(l,t,Zl,!$s);break e;case 2:Dl=null;break;case 3:case 5:break;default:throw Error(d(329))}if((t&62914560)===t&&(a=bu+300-ut(),10<a)){if(qs(l,t,Zl,!$s),to(l,0,!0)!==0)break e;ps=t,l.timeoutHandle=Wp(fp.bind(null,l,i,Dl,vu,af,t,Zl,Lr,Bc,$s,s,"Throttled",-0,0),a);break e}fp(l,i,Dl,vu,af,t,Zl,Lr,Bc,$s,s,null,-0,0)}}break}while(!0);va(e)}function fp(e,t,i,l,a,s,h,w,F,de,Te,De,fe,ye){if(e.timeoutHandle=-1,De=t.subtreeFlags,De&8192||(De&16785408)===16785408){De={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:jt},lp(t,s,De);var Qe=(s&62914560)===s?bu-ut():(s&4194048)===s?rp-ut():0;if(Qe=Tg(De,Qe),Qe!==null){ps=s,e.cancelPendingCommit=Qe(vp.bind(null,e,t,s,i,l,a,h,w,F,Te,De,null,fe,ye)),qs(e,s,h,!de);return}}vp(e,t,s,i,l,a,h,w,F)}function Ih(e){for(var t=e;;){var i=t.tag;if((i===0||i===11||i===15)&&t.flags&16384&&(i=t.updateQueue,i!==null&&(i=i.stores,i!==null)))for(var l=0;l<i.length;l++){var a=i[l],s=a.getSnapshot;a=a.value;try{if(!yn(s(),a))return!1}catch{return!1}}if(i=t.child,t.subtreeFlags&16384&&i!==null)i.return=t,t=i;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function qs(e,t,i,l){t&=~of,t&=~Lr,e.suspendedLanes|=t,e.pingedLanes&=~t,l&&(e.warmLanes|=t),l=e.expirationTimes;for(var a=t;0<a;){var s=31-lt(a),h=1<<s;l[s]=-1,a&=~h}i!==0&&Fe(e,i,t)}function Su(){return(en&6)===0?(Ad(0),!1):!0}function df(){if(Et!==null){if(an===0)var e=Et.return;else e=Et,No=dt=null,Qa(e),Uo=null,Us=0,e=Et;for(;e!==null;)ee(e.alternate,e),e=e.return;Et=null}}function Pc(e,t){var i=e.timeoutHandle;i!==-1&&(e.timeoutHandle=-1,ag(i)),i=e.cancelPendingCommit,i!==null&&(e.cancelPendingCommit=null,i()),ps=0,df(),gn=e,Et=i=yl(e.current,null),Wt=t,an=0,ql=null,$s=!1,Mc=Li(e,t),lf=!1,Bc=Zl=of=Lr=Ys=$n=0,Dl=Rd=null,af=!1,(t&8)!==0&&(t|=t&32);var l=e.entangledLanes;if(l!==0)for(e=e.entanglements,l&=t;0<l;){var a=31-lt(l),s=1<<a;t|=e[a],l&=~s}return fs=t,Ua(),i}function pp(e,t){Ct=null,_.H=Ws,t===zi||t===Vl?(t=rc(),an=3):t===co?(t=rc(),an=4):an=t===vd?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,ql=t,Et===null&&($n=1,as(e,Ki(t,e.current)))}function hp(){var e=An.current;return e===null?!0:(Wt&4194048)===Wt?Vn===null:(Wt&62914560)===Wt||(Wt&536870912)!==0?e===Vn:!1}function gp(){var e=_.H;return _.H=Ws,e===null?Ws:e}function xp(){var e=_.A;return _.A=_h,e}function wu(){$n=4,$s||(Wt&4194048)!==Wt&&An.current!==null||(Mc=!0),(Ys&134217727)===0&&(Lr&134217727)===0||gn===null||qs(gn,Wt,Zl,!1)}function uf(e,t,i){var l=en;en|=2;var a=gp(),s=xp();(gn!==e||Wt!==t)&&(vu=null,Pc(e,t)),t=!1;var h=$n;e:do try{if(an!==0&&Et!==null){var w=Et,F=ql;switch(an){case 8:df(),h=6;break e;case 3:case 2:case 9:case 6:An.current===null&&(t=!0);var de=an;if(an=0,ql=null,Oc(e,w,F,de),i&&Mc){h=0;break e}break;default:de=an,an=0,ql=null,Oc(e,w,F,de)}}Vh(),h=$n;break}catch(Te){pp(e,Te)}while(!0);return t&&e.shellSuspendCounter++,No=dt=null,en=l,_.H=a,_.A=s,Et===null&&(gn=null,Wt=0,Ua()),h}function Vh(){for(;Et!==null;)yp(Et)}function Wh(e,t){var i=en;en|=2;var l=gp(),a=xp();gn!==e||Wt!==t?(vu=null,mu=ut()+500,Pc(e,t)):Mc=Li(e,t);e:do try{if(an!==0&&Et!==null){t=Et;var s=ql;t:switch(an){case 1:an=0,ql=null,Oc(e,t,s,1);break;case 2:case 9:if(Bs(s)){an=0,ql=null,bp(t);break}t=function(){an!==2&&an!==9||gn!==e||(an=7),va(e)},s.then(t,t);break e;case 3:an=7;break e;case 4:an=5;break e;case 7:Bs(s)?(an=0,ql=null,bp(t)):(an=0,ql=null,Oc(e,t,s,7));break;case 5:var h=null;switch(Et.tag){case 26:h=Et.memoizedState;case 5:case 27:var w=Et;if(h?ih(h):w.stateNode.complete){an=0,ql=null;var F=w.sibling;if(F!==null)Et=F;else{var de=w.return;de!==null?(Et=de,ju(de)):Et=null}break t}}an=0,ql=null,Oc(e,t,s,5);break;case 6:an=0,ql=null,Oc(e,t,s,6);break;case 8:df(),$n=6;break e;default:throw Error(d(462))}}Fh();break}catch(Te){pp(e,Te)}while(!0);return No=dt=null,_.H=l,_.A=a,en=i,Et!==null?0:(gn=null,Wt=0,Ua(),$n)}function Fh(){for(;Et!==null&&!Lc();)yp(Et)}function yp(e){var t=C(e.alternate,e,fs);e.memoizedProps=e.pendingProps,t===null?ju(e):Et=t}function bp(e){var t=e,i=t.alternate;switch(t.tag){case 15:case 0:t=Sd(i,t,t.pendingProps,t.type,void 0,Wt);break;case 11:t=Sd(i,t,t.pendingProps,t.type.render,t.ref,Wt);break;case 5:Qa(t);default:ee(i,t),t=Et=Oa(t,fs),t=C(i,t,fs)}e.memoizedProps=e.pendingProps,t===null?ju(e):Et=t}function Oc(e,t,i,l){No=dt=null,Qa(t),Uo=null,Us=0;var a=t.return;try{if(md(e,a,t,i,Wt)){$n=1,as(e,Ki(i,e.current)),Et=null;return}}catch(s){if(a!==null)throw Et=a,s;$n=1,as(e,Ki(i,e.current)),Et=null;return}t.flags&32768?(Tt||l===1?e=!0:Mc||(Wt&536870912)!==0?e=!1:($s=e=!0,(l===2||l===9||l===3||l===6)&&(l=An.current,l!==null&&l.tag===13&&(l.flags|=16384))),mp(t,e)):ju(t)}function ju(e){var t=e;do{if((t.flags&32768)!==0){mp(t,$s);return}e=t.return;var i=oe(t.alternate,t,fs);if(i!==null){Et=i;return}if(t=t.sibling,t!==null){Et=t;return}Et=t=e}while(t!==null);$n===0&&($n=5)}function mp(e,t){do{var i=ae(e.alternate,e);if(i!==null){i.flags&=32767,Et=i;return}if(i=e.return,i!==null&&(i.flags|=32768,i.subtreeFlags=0,i.deletions=null),!t&&(e=e.sibling,e!==null)){Et=e;return}Et=e=i}while(e!==null);$n=6,Et=null}function vp(e,t,i,l,a,s,h,w,F){e.cancelPendingCommit=null;do Tu();while(xi!==0);if((en&6)!==0)throw Error(d(327));if(t!==null){if(t===e.current)throw Error(d(177));if(s=t.lanes|t.childLanes,s|=As,$r(e,i,s,h,w,F),e===gn&&(Et=gn=null,Wt=0),Uc=t,Gs=e,ps=i,sf=s,rf=a,cp=l,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Xh(Jl,function(){return Cp(),null})):(e.callbackNode=null,e.callbackPriority=0),l=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||l){l=_.T,_.T=null,a=O.p,O.p=2,h=en,en|=4;try{Ee(e,t,i)}finally{en=h,O.p=a,_.T=l}}xi=1,Sp(),wp(),jp()}}function Sp(){if(xi===1){xi=0;var e=Gs,t=Uc,i=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||i){i=_.T,_.T=null;var l=O.p;O.p=2;var a=en;en|=4;try{tp(t,e);var s=jf,h=zo(e.containerInfo),w=s.focusedElem,F=s.selectionRange;if(h!==w&&w&&w.ownerDocument&&Co(w.ownerDocument.documentElement,w)){if(F!==null&&ll(w)){var de=F.start,Te=F.end;if(Te===void 0&&(Te=de),"selectionStart"in w)w.selectionStart=de,w.selectionEnd=Math.min(Te,w.value.length);else{var De=w.ownerDocument||document,fe=De&&De.defaultView||window;if(fe.getSelection){var ye=fe.getSelection(),Qe=w.textContent.length,bt=Math.min(F.start,Qe),fn=F.end===void 0?bt:Math.min(F.end,Qe);!ye.extend&&bt>fn&&(h=fn,fn=bt,bt=h);var ie=To(w,bt),G=To(w,fn);if(ie&&G&&(ye.rangeCount!==1||ye.anchorNode!==ie.node||ye.anchorOffset!==ie.offset||ye.focusNode!==G.node||ye.focusOffset!==G.offset)){var ce=De.createRange();ce.setStart(ie.node,ie.offset),ye.removeAllRanges(),bt>fn?(ye.addRange(ce),ye.extend(G.node,G.offset)):(ce.setEnd(G.node,G.offset),ye.addRange(ce))}}}}for(De=[],ye=w;ye=ye.parentNode;)ye.nodeType===1&&De.push({element:ye,left:ye.scrollLeft,top:ye.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<De.length;w++){var ke=De[w];ke.element.scrollLeft=ke.left,ke.element.scrollTop=ke.top}}Ou=!!wf,jf=wf=null}finally{en=a,O.p=l,_.T=i}}e.current=t,xi=2}}function wp(){if(xi===2){xi=0;var e=Gs,t=Uc,i=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||i){i=_.T,_.T=null;var l=O.p;O.p=2;var a=en;en|=4;try{ht(e,t.alternate,t)}finally{en=a,O.p=l,_.T=i}}xi=3}}function jp(){if(xi===4||xi===3){xi=0,Je();var e=Gs,t=Uc,i=ps,l=cp;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?xi=5:(xi=0,Uc=Gs=null,Tp(e,e.pendingLanes));var a=e.pendingLanes;if(a===0&&(Xs=null),xs(i),t=t.stateNode,Ne&&typeof Ne.onCommitFiberRoot=="function")try{Ne.onCommitFiberRoot(Wi,t,void 0,(t.current.flags&128)===128)}catch{}if(l!==null){t=_.T,a=O.p,O.p=2,_.T=null;try{for(var s=e.onRecoverableError,h=0;h<l.length;h++){var w=l[h];s(w.value,{componentStack:w.stack})}}finally{_.T=t,O.p=a}}(ps&3)!==0&&Tu(),va(e),a=e.pendingLanes,(i&261930)!==0&&(a&42)!==0?e===cf?Dd++:(Dd=0,cf=e):Dd=0,Ad(0)}}function Tp(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Sr(t)))}function Tu(){return Sp(),wp(),jp(),Cp()}function Cp(){if(xi!==5)return!1;var e=Gs,t=sf;sf=0;var i=xs(ps),l=_.T,a=O.p;try{O.p=32>i?32:i,_.T=null,i=rf,rf=null;var s=Gs,h=ps;if(xi=0,Uc=Gs=null,ps=0,(en&6)!==0)throw Error(d(331));var w=en;if(en|=4,ap(s.current),ip(s,s.current,h,i),en=w,Ad(0,!1),Ne&&typeof Ne.onPostCommitFiberRoot=="function")try{Ne.onPostCommitFiberRoot(Wi,s)}catch{}return!0}finally{O.p=a,_.T=l,Tp(e,t)}}function zp(e,t,i){t=Ki(i,t),t=ss(e.stateNode,t,2),e=uo(e,t,2),e!==null&&(no(e,2),va(e))}function sn(e,t,i){if(e.tag===3)zp(e,e,i);else for(;t!==null;){if(t.tag===3){zp(t,e,i);break}else if(t.tag===1){var l=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(Xs===null||!Xs.has(l))){e=Ki(i,e),i=fu(2),l=uo(t,i,2),l!==null&&(bd(i,l,t,e),no(l,2),va(l));break}}t=t.return}}function ff(e,t,i){var l=e.pingCache;if(l===null){l=e.pingCache=new Hh;var a=new Set;l.set(t,a)}else a=l.get(t),a===void 0&&(a=new Set,l.set(t,a));a.has(i)||(lf=!0,a.add(i),e=Lh.bind(null,e,t,i),t.then(e,e))}function Lh(e,t,i){var l=e.pingCache;l!==null&&l.delete(t),e.pingedLanes|=e.suspendedLanes&i,e.warmLanes&=~i,gn===e&&(Wt&i)===i&&($n===4||$n===3&&(Wt&62914560)===Wt&&300>ut()-bu?(en&2)===0&&Pc(e,0):of|=i,Bc===Wt&&(Bc=0)),va(e)}function kp(e,t){t===0&&(t=$i()),e=sa(e,t),e!==null&&(no(e,t),va(e))}function $h(e){var t=e.memoizedState,i=0;t!==null&&(i=t.retryLane),kp(e,i)}function Yh(e,t){var i=0;switch(e.tag){case 31:case 13:var l=e.stateNode,a=e.memoizedState;a!==null&&(i=a.retryLane);break;case 19:l=e.stateNode;break;case 22:l=e.stateNode._retryCache;break;default:throw Error(d(314))}l!==null&&l.delete(t),kp(e,i)}function Xh(e,t){return ir(e,t)}var Cu=null,Ec=null,pf=!1,zu=!1,hf=!1,Zs=0;function va(e){e!==Ec&&e.next===null&&(Ec===null?Cu=Ec=e:Ec=Ec.next=e),zu=!0,pf||(pf=!0,qh())}function Ad(e,t){if(!hf&&zu){hf=!0;do for(var i=!1,l=Cu;l!==null;){if(e!==0){var a=l.pendingLanes;if(a===0)var s=0;else{var h=l.suspendedLanes,w=l.pingedLanes;s=(1<<31-lt(42|e)+1)-1,s&=a&~(h&~w),s=s&201326741?s&201326741|1:s?s|2:0}s!==0&&(i=!0,Np(l,s))}else s=Wt,s=to(l,l===gn?s:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),(s&3)===0||Li(l,s)||(i=!0,Np(l,s));l=l.next}while(i);hf=!1}}function Gh(){Rp()}function Rp(){zu=pf=!1;var e=0;Zs!==0&&og()&&(e=Zs);for(var t=ut(),i=null,l=Cu;l!==null;){var a=l.next,s=Dp(l,t);s===0?(l.next=null,i===null?Cu=a:i.next=a,a===null&&(Ec=i)):(i=l,(e!==0||(s&3)!==0)&&(zu=!0)),l=a}xi!==0&&xi!==5||Ad(e),Zs!==0&&(Zs=0)}function Dp(e,t){for(var i=e.suspendedLanes,l=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes&-62914561;0<s;){var h=31-lt(s),w=1<<h,F=a[h];F===-1?((w&i)===0||(w&l)!==0)&&(a[h]=gs(w,t)):F<=t&&(e.expiredLanes|=w),s&=~w}if(t=gn,i=Wt,i=to(e,e===t?i:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),l=e.callbackNode,i===0||e===t&&(an===2||an===9)||e.cancelPendingCommit!==null)return l!==null&&l!==null&&Yo(l),e.callbackNode=null,e.callbackPriority=0;if((i&3)===0||Li(e,i)){if(t=i&-i,t===e.callbackPriority)return t;switch(l!==null&&Yo(l),xs(i)){case 2:case 8:i=Pt;break;case 32:i=Jl;break;case 268435456:i=Xt;break;default:i=Jl}return l=Ap.bind(null,e),i=ir(i,l),e.callbackPriority=t,e.callbackNode=i,t}return l!==null&&l!==null&&Yo(l),e.callbackPriority=2,e.callbackNode=null,2}function Ap(e,t){if(xi!==0&&xi!==5)return e.callbackNode=null,e.callbackPriority=0,null;var i=e.callbackNode;if(Tu()&&e.callbackNode!==i)return null;var l=Wt;return l=to(e,e===gn?l:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),l===0?null:(up(e,l,t),Dp(e,ut()),e.callbackNode!=null&&e.callbackNode===i?Ap.bind(null,e):null)}function Np(e,t){if(Tu())return null;up(e,t,!0)}function qh(){sg(function(){(en&6)!==0?ir(He,Gh):Rp()})}function gf(){if(Zs===0){var e=jn;e===0&&(e=eo,eo<<=1,(eo&261888)===0&&(eo=256)),Zs=e}return Zs}function Mp(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:st(""+e)}function Bp(e,t){var i=t.ownerDocument.createElement("input");return i.name=t.name,i.value=t.value,e.id&&i.setAttribute("form",e.id),t.parentNode.insertBefore(i,t),e=new FormData(e),i.parentNode.removeChild(i),e}function Zh(e,t,i,l,a){if(t==="submit"&&i&&i.stateNode===a){var s=Mp((a[Bn]||null).action),h=l.submitter;h&&(t=(t=h[Bn]||null)?Mp(t.formAction):h.getAttribute("formAction"),t!==null&&(s=t,h=null));var w=new Gt("action","action",null,l,a);e.push({event:w,listeners:[{instance:null,listener:function(){if(l.defaultPrevented){if(Zs!==0){var F=h?Bp(a,h):new FormData(a);Xl(i,{pending:!0,data:F,method:a.method,action:s},null,F)}}else typeof s=="function"&&(w.preventDefault(),F=h?Bp(a,h):new FormData(a),Xl(i,{pending:!0,data:F,method:a.method,action:s},s,F))},currentTarget:a}]})}}for(var xf=0;xf<lc.length;xf++){var yf=lc[xf],Kh=yf.toLowerCase(),Qh=yf[0].toUpperCase()+yf.slice(1);si(Kh,"on"+Qh)}si(Ei,"onAnimationEnd"),si(nc,"onAnimationIteration"),si(Kc,"onAnimationStart"),si("dblclick","onDoubleClick"),si("focusin","onFocus"),si("focusout","onBlur"),si(Jd,"onTransitionRun"),si(Qc,"onTransitionStart"),si(ic,"onTransitionCancel"),si(xr,"onTransitionEnd"),fl("onMouseEnter",["mouseout","mouseover"]),fl("onMouseLeave",["mouseout","mouseover"]),fl("onPointerEnter",["pointerout","pointerover"]),fl("onPointerLeave",["pointerout","pointerover"]),on("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),on("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),on("onBeforeInput",["compositionend","keypress","textInput","paste"]),on("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),on("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),on("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Nd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Jh=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Nd));function Up(e,t){t=(t&4)!==0;for(var i=0;i<e.length;i++){var l=e[i],a=l.event;l=l.listeners;e:{var s=void 0;if(t)for(var h=l.length-1;0<=h;h--){var w=l[h],F=w.instance,de=w.currentTarget;if(w=w.listener,F!==s&&a.isPropagationStopped())break e;s=w,a.currentTarget=de;try{s(a)}catch(Te){oa(Te)}a.currentTarget=null,s=F}else for(h=0;h<l.length;h++){if(w=l[h],F=w.instance,de=w.currentTarget,w=w.listener,F!==s&&a.isPropagationStopped())break e;s=w,a.currentTarget=de;try{s(a)}catch(Te){oa(Te)}a.currentTarget=null,s=F}}}}function _t(e,t){var i=t[wa];i===void 0&&(i=t[wa]=new Set);var l=e+"__bubble";i.has(l)||(Pp(t,e,2,!1),i.add(l))}function bf(e,t,i){var l=0;t&&(l|=4),Pp(i,e,l,t)}var ku="_reactListening"+Math.random().toString(36).slice(2);function mf(e){if(!e[ku]){e[ku]=!0,Yr.forEach(function(i){i!=="selectionchange"&&(Jh.has(i)||bf(i,!1,e),bf(i,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ku]||(t[ku]=!0,bf("selectionchange",!1,t))}}function Pp(e,t,i,l){switch(dh(t)){case 2:var a=kg;break;case 8:a=Rg;break;default:a=Uf}i=a.bind(null,t,i,e),a=void 0,!Zo||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),l?a!==void 0?e.addEventListener(t,i,{capture:!0,passive:a}):e.addEventListener(t,i,!0):a!==void 0?e.addEventListener(t,i,{passive:a}):e.addEventListener(t,i,!1)}function vf(e,t,i,l,a){var s=l;if((t&1)===0&&(t&2)===0&&l!==null)e:for(;;){if(l===null)return;var h=l.tag;if(h===3||h===4){var w=l.stateNode.containerInfo;if(w===a)break;if(h===4)for(h=l.return;h!==null;){var F=h.tag;if((F===3||F===4)&&h.stateNode.containerInfo===a)return;h=h.return}for(;w!==null;){if(h=Bl(w),h===null)return;if(F=h.tag,F===5||F===6||F===26||F===27){l=s=h;continue e}w=w.parentNode}}l=l.return}ka(function(){var de=s,Te=Yc(i),De=[];e:{var fe=Ds.get(e);if(fe!==void 0){var ye=Gt,Qe=e;switch(e){case"keypress":if(ur(i)===0)break e;case"keydown":case"keyup":ye=js;break;case"focusin":Qe="focus",ye=Qo;break;case"focusout":Qe="blur",ye=Qo;break;case"beforeblur":case"afterblur":ye=Qo;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ye=Ko;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ye=pl;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ye=Ts;break;case Ei:case nc:case Kc:ye=Ui;break;case xr:ye=Gu;break;case"scroll":case"scrollend":ye=Bi;break;case"wheel":ye=qr;break;case"copy":case"cut":case"paste":ye=ji;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ye=Da;break;case"toggle":case"beforetoggle":ye=Gc}var bt=(t&4)!==0,fn=!bt&&(e==="scroll"||e==="scrollend"),ie=bt?fe!==null?fe+"Capture":null:fe;bt=[];for(var G=de,ce;G!==null;){var ke=G;if(ce=ke.stateNode,ke=ke.tag,ke!==5&&ke!==26&&ke!==27||ce===null||ie===null||(ke=Ra(G,ie),ke!=null&&bt.push(Md(G,ke,ce))),fn)break;G=G.return}0<bt.length&&(fe=new ye(fe,Qe,null,i,Te),De.push({event:fe,listeners:bt}))}}if((t&7)===0){e:{if(fe=e==="mouseover"||e==="pointerover",ye=e==="mouseout"||e==="pointerout",fe&&i!==pt&&(Qe=i.relatedTarget||i.fromElement)&&(Bl(Qe)||Qe[Lt]))break e;if((ye||fe)&&(fe=Te.window===Te?Te:(fe=Te.ownerDocument)?fe.defaultView||fe.parentWindow:window,ye?(Qe=i.relatedTarget||i.toElement,ye=de,Qe=Qe?Bl(Qe):null,Qe!==null&&(fn=I(Qe),bt=Qe.tag,Qe!==fn||bt!==5&&bt!==27&&bt!==6)&&(Qe=null)):(ye=null,Qe=de),ye!==Qe)){if(bt=Ko,ke="onMouseLeave",ie="onMouseEnter",G="mouse",(e==="pointerout"||e==="pointerover")&&(bt=Da,ke="onPointerLeave",ie="onPointerEnter",G="pointer"),fn=ye==null?fe:Pl(ye),ce=Qe==null?fe:Pl(Qe),fe=new bt(ke,G+"leave",ye,i,Te),fe.target=fn,fe.relatedTarget=ce,ke=null,Bl(Te)===de&&(bt=new bt(ie,G+"enter",Qe,i,Te),bt.target=ce,bt.relatedTarget=fn,ke=bt),fn=ke,ye&&Qe)t:{for(bt=eg,ie=ye,G=Qe,ce=0,ke=ie;ke;ke=bt(ke))ce++;ke=0;for(var ct=G;ct;ct=bt(ct))ke++;for(;0<ce-ke;)ie=bt(ie),ce--;for(;0<ke-ce;)G=bt(G),ke--;for(;ce--;){if(ie===G||G!==null&&ie===G.alternate){bt=ie;break t}ie=bt(ie),G=bt(G)}bt=null}else bt=null;ye!==null&&Op(De,fe,ye,bt,!1),Qe!==null&&fn!==null&&Op(De,fn,Qe,bt,!0)}}e:{if(fe=de?Pl(de):window,ye=fe.nodeName&&fe.nodeName.toLowerCase(),ye==="select"||ye==="input"&&fe.type==="file")var Zt=Gd;else if(pn(fe))if(qd)Zt=Qd;else{Zt=Kd;var tt=Zu}else ye=fe.nodeName,!ye||ye.toLowerCase()!=="input"||fe.type!=="checkbox"&&fe.type!=="radio"?de&&vt(de.elementType)&&(Zt=Gd):Zt=Ku;if(Zt&&(Zt=Zt(e,de))){la(De,Zt,i,Te);break e}tt&&tt(e,fe,de),e==="focusout"&&de&&fe.type==="number"&&de.memoizedProps.value!=null&&Ca(fe,"number",fe.value)}switch(tt=de?Pl(de):window,e){case"focusin":(pn(tt)||tt.contentEditable==="true")&&(Un=tt,cn=de,Zi=null);break;case"focusout":Zi=cn=Un=null;break;case"mousedown":Zn=!0;break;case"contextmenu":case"mouseup":case"dragend":Zn=!1,gl(De,i,Te);break;case"selectionchange":if(ec)break;case"keydown":case"keyup":gl(De,i,Te)}var Mt;if(Cs)e:{switch(e){case"compositionstart":var Ft="onCompositionStart";break e;case"compositionend":Ft="onCompositionEnd";break e;case"compositionupdate":Ft="onCompositionUpdate";break e}Ft=void 0}else ia?Qr(e,i)&&(Ft="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(Ft="onCompositionStart");Ft&&(ta&&i.locale!=="ko"&&(ia||Ft!=="onCompositionStart"?Ft==="onCompositionEnd"&&ia&&(Mt=vs()):(il=Te,cr="value"in il?il.value:il.textContent,ia=!0)),tt=Ru(de,Ft),0<tt.length&&(Ft=new Xi(Ft,e,null,i,Te),De.push({event:Ft,listeners:tt}),Mt?Ft.data=Mt:(Mt=na(i),Mt!==null&&(Ft.data=Mt)))),(Mt=zs?ks(e,i):tn(e,i))&&(Ft=Ru(de,"onBeforeInput"),0<Ft.length&&(tt=new Xi("onBeforeInput","beforeinput",null,i,Te),De.push({event:tt,listeners:Ft}),tt.data=Mt)),Zh(De,e,de,i,Te)}Up(De,t)})}function Md(e,t,i){return{instance:e,listener:t,currentTarget:i}}function Ru(e,t){for(var i=t+"Capture",l=[];e!==null;){var a=e,s=a.stateNode;if(a=a.tag,a!==5&&a!==26&&a!==27||s===null||(a=Ra(e,i),a!=null&&l.unshift(Md(e,a,s)),a=Ra(e,t),a!=null&&l.push(Md(e,a,s))),e.tag===3)return l;e=e.return}return[]}function eg(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Op(e,t,i,l,a){for(var s=t._reactName,h=[];i!==null&&i!==l;){var w=i,F=w.alternate,de=w.stateNode;if(w=w.tag,F!==null&&F===l)break;w!==5&&w!==26&&w!==27||de===null||(F=de,a?(de=Ra(i,s),de!=null&&h.unshift(Md(i,de,F))):a||(de=Ra(i,s),de!=null&&h.push(Md(i,de,F)))),i=i.return}h.length!==0&&e.push({event:t,listeners:h})}var tg=/\r\n?/g,ng=/\u0000|\uFFFD/g;function Ep(e){return(typeof e=="string"?e:""+e).replace(tg,`
`).replace(ng,"")}function _p(e,t){return t=Ep(t),Ep(e)===t}function un(e,t,i,l,a,s){switch(i){case"children":typeof l=="string"?t==="body"||t==="textarea"&&l===""||mt(e,l):(typeof l=="number"||typeof l=="bigint")&&t!=="body"&&mt(e,""+l);break;case"className":ja(e,"class",l);break;case"tabIndex":ja(e,"tabindex",l);break;case"dir":case"role":case"viewBox":case"width":case"height":ja(e,i,l);break;case"style":za(e,l,s);break;case"data":if(t!=="object"){ja(e,"data",l);break}case"src":case"href":if(l===""&&(t!=="a"||i!=="href")){e.removeAttribute(i);break}if(l==null||typeof l=="function"||typeof l=="symbol"||typeof l=="boolean"){e.removeAttribute(i);break}l=st(""+l),e.setAttribute(i,l);break;case"action":case"formAction":if(typeof l=="function"){e.setAttribute(i,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof s=="function"&&(i==="formAction"?(t!=="input"&&un(e,t,"name",a.name,a,null),un(e,t,"formEncType",a.formEncType,a,null),un(e,t,"formMethod",a.formMethod,a,null),un(e,t,"formTarget",a.formTarget,a,null)):(un(e,t,"encType",a.encType,a,null),un(e,t,"method",a.method,a,null),un(e,t,"target",a.target,a,null)));if(l==null||typeof l=="symbol"||typeof l=="boolean"){e.removeAttribute(i);break}l=st(""+l),e.setAttribute(i,l);break;case"onClick":l!=null&&(e.onclick=jt);break;case"onScroll":l!=null&&_t("scroll",e);break;case"onScrollEnd":l!=null&&_t("scrollend",e);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(d(61));if(i=l.__html,i!=null){if(a.children!=null)throw Error(d(60));e.innerHTML=i}}break;case"multiple":e.multiple=l&&typeof l!="function"&&typeof l!="symbol";break;case"muted":e.muted=l&&typeof l!="function"&&typeof l!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(l==null||typeof l=="function"||typeof l=="boolean"||typeof l=="symbol"){e.removeAttribute("xlink:href");break}i=st(""+l),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",i);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":l!=null&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(i,""+l):e.removeAttribute(i);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":l&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(i,""):e.removeAttribute(i);break;case"capture":case"download":l===!0?e.setAttribute(i,""):l!==!1&&l!=null&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(i,l):e.removeAttribute(i);break;case"cols":case"rows":case"size":case"span":l!=null&&typeof l!="function"&&typeof l!="symbol"&&!isNaN(l)&&1<=l?e.setAttribute(i,l):e.removeAttribute(i);break;case"rowSpan":case"start":l==null||typeof l=="function"||typeof l=="symbol"||isNaN(l)?e.removeAttribute(i):e.setAttribute(i,l);break;case"popover":_t("beforetoggle",e),_t("toggle",e),vi(e,"popover",l);break;case"xlinkActuate":Xn(e,"http://www.w3.org/1999/xlink","xlink:actuate",l);break;case"xlinkArcrole":Xn(e,"http://www.w3.org/1999/xlink","xlink:arcrole",l);break;case"xlinkRole":Xn(e,"http://www.w3.org/1999/xlink","xlink:role",l);break;case"xlinkShow":Xn(e,"http://www.w3.org/1999/xlink","xlink:show",l);break;case"xlinkTitle":Xn(e,"http://www.w3.org/1999/xlink","xlink:title",l);break;case"xlinkType":Xn(e,"http://www.w3.org/1999/xlink","xlink:type",l);break;case"xmlBase":Xn(e,"http://www.w3.org/XML/1998/namespace","xml:base",l);break;case"xmlLang":Xn(e,"http://www.w3.org/XML/1998/namespace","xml:lang",l);break;case"xmlSpace":Xn(e,"http://www.w3.org/XML/1998/namespace","xml:space",l);break;case"is":vi(e,"is",l);break;case"innerText":case"textContent":break;default:(!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(i=nt.get(i)||i,vi(e,i,l))}}function Sf(e,t,i,l,a,s){switch(i){case"style":za(e,l,s);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(d(61));if(i=l.__html,i!=null){if(a.children!=null)throw Error(d(60));e.innerHTML=i}}break;case"children":typeof l=="string"?mt(e,l):(typeof l=="number"||typeof l=="bigint")&&mt(e,""+l);break;case"onScroll":l!=null&&_t("scroll",e);break;case"onScrollEnd":l!=null&&_t("scrollend",e);break;case"onClick":l!=null&&(e.onclick=jt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ht.hasOwnProperty(i))e:{if(i[0]==="o"&&i[1]==="n"&&(a=i.endsWith("Capture"),t=i.slice(2,a?i.length-7:void 0),s=e[Bn]||null,s=s!=null?s[i]:null,typeof s=="function"&&e.removeEventListener(t,s,a),typeof l=="function")){typeof s!="function"&&s!==null&&(i in e?e[i]=null:e.hasAttribute(i)&&e.removeAttribute(i)),e.addEventListener(t,l,a);break e}i in e?e[i]=l:l===!0?e.setAttribute(i,""):vi(e,i,l)}}}function Ii(e,t,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":_t("error",e),_t("load",e);var l=!1,a=!1,s;for(s in i)if(i.hasOwnProperty(s)){var h=i[s];if(h!=null)switch(s){case"src":l=!0;break;case"srcSet":a=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(d(137,t));default:un(e,t,s,h,i,null)}}a&&un(e,t,"srcSet",i.srcSet,i,null),l&&un(e,t,"src",i.src,i,null);return;case"input":_t("invalid",e);var w=s=h=a=null,F=null,de=null;for(l in i)if(i.hasOwnProperty(l)){var Te=i[l];if(Te!=null)switch(l){case"name":a=Te;break;case"type":h=Te;break;case"checked":F=Te;break;case"defaultChecked":de=Te;break;case"value":s=Te;break;case"defaultValue":w=Te;break;case"children":case"dangerouslySetInnerHTML":if(Te!=null)throw Error(d(137,t));break;default:un(e,t,l,Te,i,null)}}ms(e,s,w,F,de,h,a,!1);return;case"select":_t("invalid",e),l=h=s=null;for(a in i)if(i.hasOwnProperty(a)&&(w=i[a],w!=null))switch(a){case"value":s=w;break;case"defaultValue":h=w;break;case"multiple":l=w;default:un(e,t,a,w,i,null)}t=s,i=h,e.multiple=!!l,t!=null?Yi(e,!!l,t,!1):i!=null&&Yi(e,!!l,i,!0);return;case"textarea":_t("invalid",e),s=a=l=null;for(h in i)if(i.hasOwnProperty(h)&&(w=i[h],w!=null))switch(h){case"value":l=w;break;case"defaultValue":a=w;break;case"children":s=w;break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(d(91));break;default:un(e,t,h,w,i,null)}Gr(e,l,a,s);return;case"option":for(F in i)if(i.hasOwnProperty(F)&&(l=i[F],l!=null))switch(F){case"selected":e.selected=l&&typeof l!="function"&&typeof l!="symbol";break;default:un(e,t,F,l,i,null)}return;case"dialog":_t("beforetoggle",e),_t("toggle",e),_t("cancel",e),_t("close",e);break;case"iframe":case"object":_t("load",e);break;case"video":case"audio":for(l=0;l<Nd.length;l++)_t(Nd[l],e);break;case"image":_t("error",e),_t("load",e);break;case"details":_t("toggle",e);break;case"embed":case"source":case"link":_t("error",e),_t("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(de in i)if(i.hasOwnProperty(de)&&(l=i[de],l!=null))switch(de){case"children":case"dangerouslySetInnerHTML":throw Error(d(137,t));default:un(e,t,de,l,i,null)}return;default:if(vt(t)){for(Te in i)i.hasOwnProperty(Te)&&(l=i[Te],l!==void 0&&Sf(e,t,Te,l,i,void 0));return}}for(w in i)i.hasOwnProperty(w)&&(l=i[w],l!=null&&un(e,t,w,l,i,null))}function ig(e,t,i,l){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var a=null,s=null,h=null,w=null,F=null,de=null,Te=null;for(ye in i){var De=i[ye];if(i.hasOwnProperty(ye)&&De!=null)switch(ye){case"checked":break;case"value":break;case"defaultValue":F=De;default:l.hasOwnProperty(ye)||un(e,t,ye,null,l,De)}}for(var fe in l){var ye=l[fe];if(De=i[fe],l.hasOwnProperty(fe)&&(ye!=null||De!=null))switch(fe){case"type":s=ye;break;case"name":a=ye;break;case"checked":de=ye;break;case"defaultChecked":Te=ye;break;case"value":h=ye;break;case"defaultValue":w=ye;break;case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(d(137,t));break;default:ye!==De&&un(e,t,fe,ye,l,De)}}Ta(e,h,w,F,de,Te,s,a);return;case"select":ye=h=w=fe=null;for(s in i)if(F=i[s],i.hasOwnProperty(s)&&F!=null)switch(s){case"value":break;case"multiple":ye=F;default:l.hasOwnProperty(s)||un(e,t,s,null,l,F)}for(a in l)if(s=l[a],F=i[a],l.hasOwnProperty(a)&&(s!=null||F!=null))switch(a){case"value":fe=s;break;case"defaultValue":w=s;break;case"multiple":h=s;default:s!==F&&un(e,t,a,s,l,F)}t=w,i=h,l=ye,fe!=null?Yi(e,!!i,fe,!1):!!l!=!!i&&(t!=null?Yi(e,!!i,t,!0):Yi(e,!!i,i?[]:"",!1));return;case"textarea":ye=fe=null;for(w in i)if(a=i[w],i.hasOwnProperty(w)&&a!=null&&!l.hasOwnProperty(w))switch(w){case"value":break;case"children":break;default:un(e,t,w,null,l,a)}for(h in l)if(a=l[h],s=i[h],l.hasOwnProperty(h)&&(a!=null||s!=null))switch(h){case"value":fe=a;break;case"defaultValue":ye=a;break;case"children":break;case"dangerouslySetInnerHTML":if(a!=null)throw Error(d(91));break;default:a!==s&&un(e,t,h,a,l,s)}Sn(e,fe,ye);return;case"option":for(var Qe in i)if(fe=i[Qe],i.hasOwnProperty(Qe)&&fe!=null&&!l.hasOwnProperty(Qe))switch(Qe){case"selected":e.selected=!1;break;default:un(e,t,Qe,null,l,fe)}for(F in l)if(fe=l[F],ye=i[F],l.hasOwnProperty(F)&&fe!==ye&&(fe!=null||ye!=null))switch(F){case"selected":e.selected=fe&&typeof fe!="function"&&typeof fe!="symbol";break;default:un(e,t,F,fe,l,ye)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var bt in i)fe=i[bt],i.hasOwnProperty(bt)&&fe!=null&&!l.hasOwnProperty(bt)&&un(e,t,bt,null,l,fe);for(de in l)if(fe=l[de],ye=i[de],l.hasOwnProperty(de)&&fe!==ye&&(fe!=null||ye!=null))switch(de){case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(d(137,t));break;default:un(e,t,de,fe,l,ye)}return;default:if(vt(t)){for(var fn in i)fe=i[fn],i.hasOwnProperty(fn)&&fe!==void 0&&!l.hasOwnProperty(fn)&&Sf(e,t,fn,void 0,l,fe);for(Te in l)fe=l[Te],ye=i[Te],!l.hasOwnProperty(Te)||fe===ye||fe===void 0&&ye===void 0||Sf(e,t,Te,fe,l,ye);return}}for(var ie in i)fe=i[ie],i.hasOwnProperty(ie)&&fe!=null&&!l.hasOwnProperty(ie)&&un(e,t,ie,null,l,fe);for(De in l)fe=l[De],ye=i[De],!l.hasOwnProperty(De)||fe===ye||fe==null&&ye==null||un(e,t,De,fe,l,ye)}function Hp(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function lg(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,i=performance.getEntriesByType("resource"),l=0;l<i.length;l++){var a=i[l],s=a.transferSize,h=a.initiatorType,w=a.duration;if(s&&w&&Hp(h)){for(h=0,w=a.responseEnd,l+=1;l<i.length;l++){var F=i[l],de=F.startTime;if(de>w)break;var Te=F.transferSize,De=F.initiatorType;Te&&Hp(De)&&(F=F.responseEnd,h+=Te*(F<w?1:(w-de)/(F-de)))}if(--l,t+=8*(s+h)/(a.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var wf=null,jf=null;function Du(e){return e.nodeType===9?e:e.ownerDocument}function Ip(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Vp(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Tf(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Cf=null;function og(){var e=window.event;return e&&e.type==="popstate"?e===Cf?!1:(Cf=e,!0):(Cf=null,!1)}var Wp=typeof setTimeout=="function"?setTimeout:void 0,ag=typeof clearTimeout=="function"?clearTimeout:void 0,Fp=typeof Promise=="function"?Promise:void 0,sg=typeof queueMicrotask=="function"?queueMicrotask:typeof Fp<"u"?function(e){return Fp.resolve(null).then(e).catch(rg)}:Wp;function rg(e){setTimeout(function(){throw e})}function Ks(e){return e==="head"}function Lp(e,t){var i=t,l=0;do{var a=i.nextSibling;if(e.removeChild(i),a&&a.nodeType===8)if(i=a.data,i==="/$"||i==="/&"){if(l===0){e.removeChild(a),Vc(t);return}l--}else if(i==="$"||i==="$?"||i==="$~"||i==="$!"||i==="&")l++;else if(i==="html")Bd(e.ownerDocument.documentElement);else if(i==="head"){i=e.ownerDocument.head,Bd(i);for(var s=i.firstChild;s;){var h=s.nextSibling,w=s.nodeName;s[wo]||w==="SCRIPT"||w==="STYLE"||w==="LINK"&&s.rel.toLowerCase()==="stylesheet"||i.removeChild(s),s=h}}else i==="body"&&Bd(e.ownerDocument.body);i=a}while(i);Vc(t)}function $p(e,t){var i=e;e=0;do{var l=i.nextSibling;if(i.nodeType===1?t?(i._stashedDisplay=i.style.display,i.style.display="none"):(i.style.display=i._stashedDisplay||"",i.getAttribute("style")===""&&i.removeAttribute("style")):i.nodeType===3&&(t?(i._stashedText=i.nodeValue,i.nodeValue=""):i.nodeValue=i._stashedText||""),l&&l.nodeType===8)if(i=l.data,i==="/$"){if(e===0)break;e--}else i!=="$"&&i!=="$?"&&i!=="$~"&&i!=="$!"||e++;i=l}while(i)}function zf(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var i=t;switch(t=t.nextSibling,i.nodeName){case"HTML":case"HEAD":case"BODY":zf(i),Xo(i);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(i.rel.toLowerCase()==="stylesheet")continue}e.removeChild(i)}}function cg(e,t,i,l){for(;e.nodeType===1;){var a=i;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!l&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(l){if(!e[wo])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(s=e.getAttribute("rel"),s==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(s!==a.rel||e.getAttribute("href")!==(a.href==null||a.href===""?null:a.href)||e.getAttribute("crossorigin")!==(a.crossOrigin==null?null:a.crossOrigin)||e.getAttribute("title")!==(a.title==null?null:a.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(s=e.getAttribute("src"),(s!==(a.src==null?null:a.src)||e.getAttribute("type")!==(a.type==null?null:a.type)||e.getAttribute("crossorigin")!==(a.crossOrigin==null?null:a.crossOrigin))&&s&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var s=a.name==null?null:""+a.name;if(a.type==="hidden"&&e.getAttribute("name")===s)return e}else return e;if(e=go(e.nextSibling),e===null)break}return null}function dg(e,t,i){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!i||(e=go(e.nextSibling),e===null))return null;return e}function Yp(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=go(e.nextSibling),e===null))return null;return e}function kf(e){return e.data==="$?"||e.data==="$~"}function Rf(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function ug(e,t){var i=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||i.readyState!=="loading")t();else{var l=function(){t(),i.removeEventListener("DOMContentLoaded",l)};i.addEventListener("DOMContentLoaded",l),e._reactRetry=l}}function go(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var Df=null;function Xp(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"||i==="/&"){if(t===0)return go(e.nextSibling);t--}else i!=="$"&&i!=="$!"&&i!=="$?"&&i!=="$~"&&i!=="&"||t++}e=e.nextSibling}return null}function Gp(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"){if(t===0)return e;t--}else i!=="/$"&&i!=="/&"||t++}e=e.previousSibling}return null}function qp(e,t,i){switch(t=Du(i),e){case"html":if(e=t.documentElement,!e)throw Error(d(452));return e;case"head":if(e=t.head,!e)throw Error(d(453));return e;case"body":if(e=t.body,!e)throw Error(d(454));return e;default:throw Error(d(451))}}function Bd(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Xo(e)}var xo=new Map,Zp=new Set;function Au(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var hs=O.d;O.d={f:fg,r:pg,D:hg,C:gg,L:xg,m:yg,X:mg,S:bg,M:vg};function fg(){var e=hs.f(),t=Su();return e||t}function pg(e){var t=Ul(e);t!==null&&t.tag===5&&t.type==="form"?wc(t):hs.r(e)}var _c=typeof document>"u"?null:document;function Kp(e,t,i){var l=_c;if(l&&typeof t=="string"&&t){var a=Si(t);a='link[rel="'+e+'"][href="'+a+'"]',typeof i=="string"&&(a+='[crossorigin="'+i+'"]'),Zp.has(a)||(Zp.add(a),e={rel:e,crossOrigin:i,href:t},l.querySelector(a)===null&&(t=l.createElement("link"),Ii(t,"link",e),Ot(t),l.head.appendChild(t)))}}function hg(e){hs.D(e),Kp("dns-prefetch",e,null)}function gg(e,t){hs.C(e,t),Kp("preconnect",e,t)}function xg(e,t,i){hs.L(e,t,i);var l=_c;if(l&&e&&t){var a='link[rel="preload"][as="'+Si(t)+'"]';t==="image"&&i&&i.imageSrcSet?(a+='[imagesrcset="'+Si(i.imageSrcSet)+'"]',typeof i.imageSizes=="string"&&(a+='[imagesizes="'+Si(i.imageSizes)+'"]')):a+='[href="'+Si(e)+'"]';var s=a;switch(t){case"style":s=Hc(e);break;case"script":s=Ic(e)}xo.has(s)||(e=he({rel:"preload",href:t==="image"&&i&&i.imageSrcSet?void 0:e,as:t},i),xo.set(s,e),l.querySelector(a)!==null||t==="style"&&l.querySelector(Ud(s))||t==="script"&&l.querySelector(Pd(s))||(t=l.createElement("link"),Ii(t,"link",e),Ot(t),l.head.appendChild(t)))}}function yg(e,t){hs.m(e,t);var i=_c;if(i&&e){var l=t&&typeof t.as=="string"?t.as:"script",a='link[rel="modulepreload"][as="'+Si(l)+'"][href="'+Si(e)+'"]',s=a;switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":s=Ic(e)}if(!xo.has(s)&&(e=he({rel:"modulepreload",href:e},t),xo.set(s,e),i.querySelector(a)===null)){switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(i.querySelector(Pd(s)))return}l=i.createElement("link"),Ii(l,"link",e),Ot(l),i.head.appendChild(l)}}}function bg(e,t,i){hs.S(e,t,i);var l=_c;if(l&&e){var a=Go(l).hoistableStyles,s=Hc(e);t=t||"default";var h=a.get(s);if(!h){var w={loading:0,preload:null};if(h=l.querySelector(Ud(s)))w.loading=5;else{e=he({rel:"stylesheet",href:e,"data-precedence":t},i),(i=xo.get(s))&&Af(e,i);var F=h=l.createElement("link");Ot(F),Ii(F,"link",e),F._p=new Promise(function(de,Te){F.onload=de,F.onerror=Te}),F.addEventListener("load",function(){w.loading|=1}),F.addEventListener("error",function(){w.loading|=2}),w.loading|=4,Nu(h,t,l)}h={type:"stylesheet",instance:h,count:1,state:w},a.set(s,h)}}}function mg(e,t){hs.X(e,t);var i=_c;if(i&&e){var l=Go(i).hoistableScripts,a=Ic(e),s=l.get(a);s||(s=i.querySelector(Pd(a)),s||(e=he({src:e,async:!0},t),(t=xo.get(a))&&Nf(e,t),s=i.createElement("script"),Ot(s),Ii(s,"link",e),i.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},l.set(a,s))}}function vg(e,t){hs.M(e,t);var i=_c;if(i&&e){var l=Go(i).hoistableScripts,a=Ic(e),s=l.get(a);s||(s=i.querySelector(Pd(a)),s||(e=he({src:e,async:!0,type:"module"},t),(t=xo.get(a))&&Nf(e,t),s=i.createElement("script"),Ot(s),Ii(s,"link",e),i.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},l.set(a,s))}}function Qp(e,t,i,l){var a=(a=Ge.current)?Au(a):null;if(!a)throw Error(d(446));switch(e){case"meta":case"title":return null;case"style":return typeof i.precedence=="string"&&typeof i.href=="string"?(t=Hc(i.href),i=Go(a).hoistableStyles,l=i.get(t),l||(l={type:"style",instance:null,count:0,state:null},i.set(t,l)),l):{type:"void",instance:null,count:0,state:null};case"link":if(i.rel==="stylesheet"&&typeof i.href=="string"&&typeof i.precedence=="string"){e=Hc(i.href);var s=Go(a).hoistableStyles,h=s.get(e);if(h||(a=a.ownerDocument||a,h={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},s.set(e,h),(s=a.querySelector(Ud(e)))&&!s._p&&(h.instance=s,h.state.loading=5),xo.has(e)||(i={rel:"preload",as:"style",href:i.href,crossOrigin:i.crossOrigin,integrity:i.integrity,media:i.media,hrefLang:i.hrefLang,referrerPolicy:i.referrerPolicy},xo.set(e,i),s||Sg(a,e,i,h.state))),t&&l===null)throw Error(d(528,""));return h}if(t&&l!==null)throw Error(d(529,""));return null;case"script":return t=i.async,i=i.src,typeof i=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Ic(i),i=Go(a).hoistableScripts,l=i.get(t),l||(l={type:"script",instance:null,count:0,state:null},i.set(t,l)),l):{type:"void",instance:null,count:0,state:null};default:throw Error(d(444,e))}}function Hc(e){return'href="'+Si(e)+'"'}function Ud(e){return'link[rel="stylesheet"]['+e+"]"}function Jp(e){return he({},e,{"data-precedence":e.precedence,precedence:null})}function Sg(e,t,i,l){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?l.loading=1:(t=e.createElement("link"),l.preload=t,t.addEventListener("load",function(){return l.loading|=1}),t.addEventListener("error",function(){return l.loading|=2}),Ii(t,"link",i),Ot(t),e.head.appendChild(t))}function Ic(e){return'[src="'+Si(e)+'"]'}function Pd(e){return"script[async]"+e}function eh(e,t,i){if(t.count++,t.instance===null)switch(t.type){case"style":var l=e.querySelector('style[data-href~="'+Si(i.href)+'"]');if(l)return t.instance=l,Ot(l),l;var a=he({},i,{"data-href":i.href,"data-precedence":i.precedence,href:null,precedence:null});return l=(e.ownerDocument||e).createElement("style"),Ot(l),Ii(l,"style",a),Nu(l,i.precedence,e),t.instance=l;case"stylesheet":a=Hc(i.href);var s=e.querySelector(Ud(a));if(s)return t.state.loading|=4,t.instance=s,Ot(s),s;l=Jp(i),(a=xo.get(a))&&Af(l,a),s=(e.ownerDocument||e).createElement("link"),Ot(s);var h=s;return h._p=new Promise(function(w,F){h.onload=w,h.onerror=F}),Ii(s,"link",l),t.state.loading|=4,Nu(s,i.precedence,e),t.instance=s;case"script":return s=Ic(i.src),(a=e.querySelector(Pd(s)))?(t.instance=a,Ot(a),a):(l=i,(a=xo.get(s))&&(l=he({},i),Nf(l,a)),e=e.ownerDocument||e,a=e.createElement("script"),Ot(a),Ii(a,"link",l),e.head.appendChild(a),t.instance=a);case"void":return null;default:throw Error(d(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(l=t.instance,t.state.loading|=4,Nu(l,i.precedence,e));return t.instance}function Nu(e,t,i){for(var l=i.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),a=l.length?l[l.length-1]:null,s=a,h=0;h<l.length;h++){var w=l[h];if(w.dataset.precedence===t)s=w;else if(s!==a)break}s?s.parentNode.insertBefore(e,s.nextSibling):(t=i.nodeType===9?i.head:i,t.insertBefore(e,t.firstChild))}function Af(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Nf(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var Mu=null;function th(e,t,i){if(Mu===null){var l=new Map,a=Mu=new Map;a.set(i,l)}else a=Mu,l=a.get(i),l||(l=new Map,a.set(i,l));if(l.has(e))return l;for(l.set(e,null),i=i.getElementsByTagName(e),a=0;a<i.length;a++){var s=i[a];if(!(s[wo]||s[ft]||e==="link"&&s.getAttribute("rel")==="stylesheet")&&s.namespaceURI!=="http://www.w3.org/2000/svg"){var h=s.getAttribute(t)||"";h=e+h;var w=l.get(h);w?w.push(s):l.set(h,[s])}}return l}function nh(e,t,i){e=e.ownerDocument||e,e.head.insertBefore(i,t==="title"?e.querySelector("head > title"):null)}function wg(e,t,i){if(i===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function ih(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function jg(e,t,i,l){if(i.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var a=Hc(l.href),s=t.querySelector(Ud(a));if(s){t=s._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=Bu.bind(e),t.then(e,e)),i.state.loading|=4,i.instance=s,Ot(s);return}s=t.ownerDocument||t,l=Jp(l),(a=xo.get(a))&&Af(l,a),s=s.createElement("link"),Ot(s);var h=s;h._p=new Promise(function(w,F){h.onload=w,h.onerror=F}),Ii(s,"link",l),i.instance=s}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(i,t),(t=i.state.preload)&&(i.state.loading&3)===0&&(e.count++,i=Bu.bind(e),t.addEventListener("load",i),t.addEventListener("error",i))}}var Mf=0;function Tg(e,t){return e.stylesheets&&e.count===0&&Pu(e,e.stylesheets),0<e.count||0<e.imgCount?function(i){var l=setTimeout(function(){if(e.stylesheets&&Pu(e,e.stylesheets),e.unsuspend){var s=e.unsuspend;e.unsuspend=null,s()}},6e4+t);0<e.imgBytes&&Mf===0&&(Mf=62500*lg());var a=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Pu(e,e.stylesheets),e.unsuspend)){var s=e.unsuspend;e.unsuspend=null,s()}},(e.imgBytes>Mf?50:800)+t);return e.unsuspend=i,function(){e.unsuspend=null,clearTimeout(l),clearTimeout(a)}}:null}function Bu(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Pu(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Uu=null;function Pu(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Uu=new Map,t.forEach(Cg,e),Uu=null,Bu.call(e))}function Cg(e,t){if(!(t.state.loading&4)){var i=Uu.get(e);if(i)var l=i.get(null);else{i=new Map,Uu.set(e,i);for(var a=e.querySelectorAll("link[data-precedence],style[data-precedence]"),s=0;s<a.length;s++){var h=a[s];(h.nodeName==="LINK"||h.getAttribute("media")!=="not all")&&(i.set(h.dataset.precedence,h),l=h)}l&&i.set(null,l)}a=t.instance,h=a.getAttribute("data-precedence"),s=i.get(h)||l,s===l&&i.set(null,a),i.set(h,a),this.count++,l=Bu.bind(this),a.addEventListener("load",l),a.addEventListener("error",l),s?s.parentNode.insertBefore(a,s.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(a,e.firstChild)),t.state.loading|=4}}var Od={$$typeof:J,Provider:null,Consumer:null,_currentValue:Y,_currentValue2:Y,_threadCount:0};function zg(e,t,i,l,a,s,h,w,F){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=dl(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dl(0),this.hiddenUpdates=dl(null),this.identifierPrefix=l,this.onUncaughtError=a,this.onCaughtError=s,this.onRecoverableError=h,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=F,this.incompleteTransitions=new Map}function lh(e,t,i,l,a,s,h,w,F,de,Te,De){return e=new zg(e,t,i,h,F,de,Te,De,w),t=1,s===!0&&(t|=24),s=ri(3,null,null,t),e.current=s,s.stateNode=e,t=Wa(),t.refCount++,e.pooledCache=t,t.refCount++,s.memoizedState={element:l,isDehydrated:i,cache:t},cc(s),e}function oh(e){return e?(e=ko,e):ko}function ah(e,t,i,l,a,s){a=oh(a),l.context===null?l.context=a:l.pendingContext=a,l=Tl(t),l.payload={element:i},s=s===void 0?null:s,s!==null&&(l.callback=s),i=uo(e,l,t),i!==null&&(Al(i,e,t),ca(i,e,t))}function sh(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<t?i:t}}function Bf(e,t){sh(e,t),(e=e.alternate)&&sh(e,t)}function rh(e){if(e.tag===13||e.tag===31){var t=sa(e,67108864);t!==null&&Al(t,e,67108864),Bf(e,67108864)}}function ch(e){if(e.tag===13||e.tag===31){var t=Kl();t=Hn(t);var i=sa(e,t);i!==null&&Al(i,e,t),Bf(e,t)}}var Ou=!0;function kg(e,t,i,l){var a=_.T;_.T=null;var s=O.p;try{O.p=2,Uf(e,t,i,l)}finally{O.p=s,_.T=a}}function Rg(e,t,i,l){var a=_.T;_.T=null;var s=O.p;try{O.p=8,Uf(e,t,i,l)}finally{O.p=s,_.T=a}}function Uf(e,t,i,l){if(Ou){var a=Pf(l);if(a===null)vf(e,t,l,Eu,i),uh(e,l);else if(Ag(a,e,t,i,l))l.stopPropagation();else if(uh(e,l),t&4&&-1<Dg.indexOf(e)){for(;a!==null;){var s=Ul(a);if(s!==null)switch(s.tag){case 3:if(s=s.stateNode,s.current.memoizedState.isDehydrated){var h=Fi(s.pendingLanes);if(h!==0){var w=s;for(w.pendingLanes|=2,w.entangledLanes|=2;h;){var F=1<<31-lt(h);w.entanglements[1]|=F,h&=~F}va(s),(en&6)===0&&(mu=ut()+500,Ad(0))}}break;case 31:case 13:w=sa(s,2),w!==null&&Al(w,s,2),Su(),Bf(s,2)}if(s=Pf(l),s===null&&vf(e,t,l,Eu,i),s===a)break;a=s}a!==null&&l.stopPropagation()}else vf(e,t,l,null,i)}}function Pf(e){return e=Yc(e),Of(e)}var Eu=null;function Of(e){if(Eu=null,e=Bl(e),e!==null){var t=I(e);if(t===null)e=null;else{var i=t.tag;if(i===13){if(e=xe(t),e!==null)return e;e=null}else if(i===31){if(e=q(t),e!==null)return e;e=null}else if(i===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Eu=e,null}function dh(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch($c()){case He:return 2;case Pt:return 8;case Jl:case vo:return 32;case Xt:return 268435456;default:return 32}default:return 32}}var Ef=!1,Qs=null,Js=null,er=null,Ed=new Map,_d=new Map,tr=[],Dg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function uh(e,t){switch(e){case"focusin":case"focusout":Qs=null;break;case"dragenter":case"dragleave":Js=null;break;case"mouseover":case"mouseout":er=null;break;case"pointerover":case"pointerout":Ed.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":_d.delete(t.pointerId)}}function Hd(e,t,i,l,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:i,eventSystemFlags:l,nativeEvent:s,targetContainers:[a]},t!==null&&(t=Ul(t),t!==null&&rh(t)),e):(e.eventSystemFlags|=l,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function Ag(e,t,i,l,a){switch(t){case"focusin":return Qs=Hd(Qs,e,t,i,l,a),!0;case"dragenter":return Js=Hd(Js,e,t,i,l,a),!0;case"mouseover":return er=Hd(er,e,t,i,l,a),!0;case"pointerover":var s=a.pointerId;return Ed.set(s,Hd(Ed.get(s)||null,e,t,i,l,a)),!0;case"gotpointercapture":return s=a.pointerId,_d.set(s,Hd(_d.get(s)||null,e,t,i,l,a)),!0}return!1}function fh(e){var t=Bl(e.target);if(t!==null){var i=I(t);if(i!==null){if(t=i.tag,t===13){if(t=xe(i),t!==null){e.blockedOn=t,ar(e.priority,function(){ch(i)});return}}else if(t===31){if(t=q(i),t!==null){e.blockedOn=t,ar(e.priority,function(){ch(i)});return}}else if(t===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function _u(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var i=Pf(e.nativeEvent);if(i===null){i=e.nativeEvent;var l=new i.constructor(i.type,i);pt=l,i.target.dispatchEvent(l),pt=null}else return t=Ul(i),t!==null&&rh(t),e.blockedOn=i,!1;t.shift()}return!0}function ph(e,t,i){_u(e)&&i.delete(t)}function Ng(){Ef=!1,Qs!==null&&_u(Qs)&&(Qs=null),Js!==null&&_u(Js)&&(Js=null),er!==null&&_u(er)&&(er=null),Ed.forEach(ph),_d.forEach(ph)}function Hu(e,t){e.blockedOn===t&&(e.blockedOn=null,Ef||(Ef=!0,c.unstable_scheduleCallback(c.unstable_NormalPriority,Ng)))}var Iu=null;function hh(e){Iu!==e&&(Iu=e,c.unstable_scheduleCallback(c.unstable_NormalPriority,function(){Iu===e&&(Iu=null);for(var t=0;t<e.length;t+=3){var i=e[t],l=e[t+1],a=e[t+2];if(typeof l!="function"){if(Of(l||i)===null)continue;break}var s=Ul(i);s!==null&&(e.splice(t,3),t-=3,Xl(s,{pending:!0,data:a,method:i.method,action:l},l,a))}}))}function Vc(e){function t(F){return Hu(F,e)}Qs!==null&&Hu(Qs,e),Js!==null&&Hu(Js,e),er!==null&&Hu(er,e),Ed.forEach(t),_d.forEach(t);for(var i=0;i<tr.length;i++){var l=tr[i];l.blockedOn===e&&(l.blockedOn=null)}for(;0<tr.length&&(i=tr[0],i.blockedOn===null);)fh(i),i.blockedOn===null&&tr.shift();if(i=(e.ownerDocument||e).$$reactFormReplay,i!=null)for(l=0;l<i.length;l+=3){var a=i[l],s=i[l+1],h=a[Bn]||null;if(typeof s=="function")h||hh(i);else if(h){var w=null;if(s&&s.hasAttribute("formAction")){if(a=s,h=s[Bn]||null)w=h.formAction;else if(Of(a)!==null)continue}else w=h.action;typeof w=="function"?i[l+1]=w:(i.splice(l,3),l-=3),hh(i)}}}function gh(){function e(s){s.canIntercept&&s.info==="react-transition"&&s.intercept({handler:function(){return new Promise(function(h){return a=h})},focusReset:"manual",scroll:"manual"})}function t(){a!==null&&(a(),a=null),l||setTimeout(i,20)}function i(){if(!l&&!navigation.transition){var s=navigation.currentEntry;s&&s.url!=null&&navigation.navigate(s.url,{state:s.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var l=!1,a=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(i,100),function(){l=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),a!==null&&(a(),a=null)}}}function _f(e){this._internalRoot=e}Vu.prototype.render=_f.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(d(409));var i=t.current,l=Kl();ah(i,l,e,t,null,null)},Vu.prototype.unmount=_f.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ah(e.current,2,null,e,null,null),Su(),t[Lt]=null}};function Vu(e){this._internalRoot=e}Vu.prototype.unstable_scheduleHydration=function(e){if(e){var t=or();e={blockedOn:null,target:e,priority:t};for(var i=0;i<tr.length&&t!==0&&t<tr[i].priority;i++);tr.splice(i,0,e),i===0&&fh(e)}};var xh=u.version;if(xh!=="19.2.0")throw Error(d(527,xh,"19.2.0"));O.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(d(188)):(e=Object.keys(e).join(","),Error(d(268,e)));return e=V(t),e=e!==null?ue(e):null,e=e===null?null:e.stateNode,e};var Mg={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:_,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wu.isDisabled&&Wu.supportsFiber)try{Wi=Wu.inject(Mg),Ne=Wu}catch{}}return Vd.createRoot=function(e,t){if(!R(e))throw Error(d(299));var i=!1,l="",a=zc,s=Fs,h=Ir;return t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(l=t.identifierPrefix),t.onUncaughtError!==void 0&&(a=t.onUncaughtError),t.onCaughtError!==void 0&&(s=t.onCaughtError),t.onRecoverableError!==void 0&&(h=t.onRecoverableError)),t=lh(e,1,!1,null,null,i,l,null,a,s,h,gh),e[Lt]=t.current,mf(e),new _f(t)},Vd.hydrateRoot=function(e,t,i){if(!R(e))throw Error(d(299));var l=!1,a="",s=zc,h=Fs,w=Ir,F=null;return i!=null&&(i.unstable_strictMode===!0&&(l=!0),i.identifierPrefix!==void 0&&(a=i.identifierPrefix),i.onUncaughtError!==void 0&&(s=i.onUncaughtError),i.onCaughtError!==void 0&&(h=i.onCaughtError),i.onRecoverableError!==void 0&&(w=i.onRecoverableError),i.formState!==void 0&&(F=i.formState)),t=lh(e,1,!0,t,i??null,l,a,F,s,h,w,gh),t.context=oh(null),i=t.current,l=Kl(),l=Hn(l),a=Tl(l),a.callback=null,uo(i,a,l),i=l,t.current.lanes=i,no(t,i),va(t),e[Lt]=t.current,mf(e),new Vu(t)},Vd.version="19.2.0",Vd}var zh;function Fg(){if(zh)return Vf.exports;zh=1;function c(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(c)}catch(u){console.error(u)}}return c(),Vf.exports=Wg(),Vf.exports}var Lg=Fg();/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $g=c=>c.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Yg=c=>c.replace(/^([A-Z])|[\s-_]+(\w)/g,(u,g,d)=>d?d.toUpperCase():g.toLowerCase()),kh=c=>{const u=Yg(c);return u.charAt(0).toUpperCase()+u.slice(1)},Uh=(...c)=>c.filter((u,g,d)=>!!u&&u.trim()!==""&&d.indexOf(u)===g).join(" ").trim(),Xg=c=>{for(const u in c)if(u.startsWith("aria-")||u==="role"||u==="title")return!0};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Gg={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qg=b.forwardRef(({color:c="currentColor",size:u=24,strokeWidth:g=2,absoluteStrokeWidth:d,className:R="",children:I,iconNode:xe,...q},p)=>b.createElement("svg",{ref:p,...Gg,width:u,height:u,stroke:c,strokeWidth:d?Number(g)*24/Number(u):g,className:Uh("lucide",R),...!I&&!Xg(q)&&{"aria-hidden":"true"},...q},[...xe.map(([V,ue])=>b.createElement(V,ue)),...Array.isArray(I)?I:[I]]));/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ph=(c,u)=>{const g=b.forwardRef(({className:d,...R},I)=>b.createElement(qg,{ref:I,iconNode:u,className:Uh(`lucide-${$g(kh(c))}`,`lucide-${c}`,d),...R}));return g.displayName=kh(c),g};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zg=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],Kg=Ph("mouse-pointer",Zg);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qg=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Jg=Ph("pen-line",Qg),$f="#2CA02C",ex="#F0E442",tx="#00BFC4",Yf="#000000",nx="#00008b",Xf="#FF0000",Oh={DEFAULT_SIZE:18},$d={Battery:{prefix:["B","BT"],defaultPins:2},Capacitor:{prefix:["C"],defaultPins:2},"Electrolytic Capacitor":{prefix:["C","CE"],defaultPins:2},"Film Capacitor":{prefix:["C","CF"],defaultPins:2},Diode:{prefix:["D","CR"],defaultPins:2},Fuse:{prefix:["F"],defaultPins:2},FerriteBead:{prefix:["FB"],defaultPins:2},Connector:{prefix:["J","P"],defaultPins:4},Jumper:{prefix:["JP"],defaultPins:3},Relay:{prefix:["K"],defaultPins:5},Inductor:{prefix:["L"],defaultPins:2},Speaker:{prefix:["LS"],defaultPins:2},Motor:{prefix:["M"],defaultPins:2},PowerSupply:{prefix:["PS"],defaultPins:4},Transistor:{prefix:["Q"],defaultPins:3},Resistor:{prefix:["R"],defaultPins:2},ResistorNetwork:{prefix:["RN"],defaultPins:8},Thermistor:{prefix:["RT"],defaultPins:2},Switch:{prefix:["S","SW"],defaultPins:2},Transformer:{prefix:["T"],defaultPins:4},TestPoint:{prefix:["TP"],defaultPins:1},IntegratedCircuit:{prefix:["U","IC"],defaultPins:8},VacuumTube:{prefix:["V"],defaultPins:5},VariableResistor:{prefix:["VR"],defaultPins:3},Crystal:{prefix:["X","XTAL","Y"],defaultPins:2},ZenerDiode:{prefix:["Z"],defaultPins:2}},ix={Capacitors:{General:["Capacitor"],Electrolytic:["Electrolytic Capacitor"],Film:["Film Capacitor"],Tantalum:["Capacitor"]},Diodes:{Standard:["Diode"],Zener:["ZenerDiode"],LED:["Diode"],Schottky:["Diode"]},Resistors:{Standard:["Resistor"],Network:["ResistorNetwork"],Thermistor:["Thermistor"],Variable:["VariableResistor"]},Semiconductors:{Transistor:["Transistor"],"Integrated Circuit":["IntegratedCircuit"]},"Passive Components":{Inductor:["Inductor"],"Ferrite Bead":["FerriteBead"],Crystal:["Crystal"]},"Power & Energy":{Battery:["Battery"],"Power Supply":["PowerSupply"],Fuse:["Fuse"]},"Connectors & Switches":{Connector:["Connector"],Jumper:["Jumper"],Switch:["Switch"],Relay:["Relay"]},Other:{Transformer:["Transformer"],Speaker:["Speaker"],Motor:["Motor"],"Test Point":["TestPoint"],"Vacuum Tube":["VacuumTube"]}},Gf={DEFAULT_SIZE:18},Eh={resistance:{validUnits:["","m","k","M"],defaultUnit:""},capacitance:{validUnits:["pF","nF","F","mF","F"],defaultUnit:"F"},voltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},current:{validUnits:["A","mA","A"],defaultUnit:"A"},power:{validUnits:["W","mW","kW"],defaultUnit:"W"},inductance:{validUnits:["nH","H","mH","H"],defaultUnit:"H"},impedance:{validUnits:["","m","k"],defaultUnit:""},capacity:{validUnits:["mAh","Ah"],defaultUnit:"mAh"},inputVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},outputVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},coilVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},primaryVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},secondaryVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},esr:{validUnits:["m",""],defaultUnit:""}};function $t(c){return Eh[c]?.validUnits||[]}function Ze(c){return Eh[c]?.defaultUnit||""}function Ld(c){return c.includes(" ")?c:c.replace(/([a-z])([A-Z])/g,"$1 $2")}let cl=1;const bo=new Set;function $o(){const c=cl;if(cl++,bo.has(c)){for(console.error(`CRITICAL ERROR: Duplicate Node ID ${c} would be allocated!`),console.error(`Current counter: ${cl}, Allocated IDs count: ${bo.size}`);bo.has(cl);)cl++;const u=cl;return cl++,bo.add(u),console.error(`Recovered by allocating ID ${u} instead`),u}return bo.add(c),c}function qf(c){c<1&&(console.warn(`setPointIdCounter called with invalid value ${c}, using 1`),c=1),cl=c,bo.clear()}function Rh(){return cl}function Dh(){cl=1,bo.clear()}function Zf(c){c>0&&(bo.add(c),c>=cl&&(cl=c+1))}function Fu(c){if(c>0&&bo.has(c))if(bo.delete(c),bo.size>0){const u=Math.max(...Array.from(bo));u<cl&&(cl=Math.max(1,u+1))}else cl=1}function lx(c="id"){return`${c}-${Date.now()}-${Math.random().toString(36).slice(2,11)}`}function Ah(c){return Math.round(c*1e4)/1e4}function Yt(c){return{x:Ah(c.x),y:Ah(c.y)}}function ox(c){return $d[c]?.defaultPins||2}function Qf(c){return($d[c]?.prefix||["?"])[0]}function ax(c,u,g,d,R,I=Oh.DEFAULT_SIZE,xe=[],q=Fd(),p=!0){let V="";if(p){const Ce=Qf(c),Me=rx(Ce,xe,q);V=`${Ce}${Me}`}const ue={id:lx("comp"),componentType:c,designator:V,layer:u,x:g,y:d,color:R,size:I,pinCount:ox(c),pinConnections:[],orientation:0};switch(ue.pinConnections=new Array(ue.pinCount).fill(""),(c==="Electrolytic Capacitor"||c==="Diode"||c==="Battery"||c==="ZenerDiode")&&(ue.pinPolarities=new Array(ue.pinCount).fill("")),c){case"Battery":return{...ue,componentType:"Battery"};case"Capacitor":return{...ue,componentType:"Capacitor"};case"Electrolytic Capacitor":return{...ue,componentType:"Electrolytic Capacitor",polarity:"Positive"};case"Film Capacitor":return{...ue,componentType:"Film Capacitor",filmType:"Polyester"};case"Diode":return{...ue,componentType:"Diode",diodeType:"Standard"};case"Fuse":return{...ue,componentType:"Fuse"};case"FerriteBead":return{...ue,componentType:"FerriteBead"};case"Connector":return{...ue,componentType:"Connector",gender:"N/A"};case"Jumper":return{...ue,componentType:"Jumper"};case"Relay":return{...ue,componentType:"Relay"};case"Inductor":return{...ue,componentType:"Inductor"};case"Speaker":return{...ue,componentType:"Speaker"};case"Motor":return{...ue,componentType:"Motor"};case"PowerSupply":return{...ue,componentType:"PowerSupply"};case"Transistor":return{...ue,componentType:"Transistor",transistorType:"BJT"};case"Resistor":return{...ue,componentType:"Resistor"};case"ResistorNetwork":return{...ue,componentType:"ResistorNetwork"};case"Thermistor":return{...ue,componentType:"Thermistor",thermistorType:"NTC"};case"Switch":return{...ue,componentType:"Switch"};case"Transformer":return{...ue,componentType:"Transformer"};case"TestPoint":return{...ue,componentType:"TestPoint"};case"IntegratedCircuit":return{...ue,componentType:"IntegratedCircuit"};case"VacuumTube":return{...ue,componentType:"VacuumTube"};case"VariableResistor":return{...ue,componentType:"VariableResistor",vrType:"Potentiometer"};case"Crystal":return{...ue,componentType:"Crystal"};case"ZenerDiode":return{...ue,componentType:"ZenerDiode"};default:return{...ue,componentType:"Resistor"}}}function Jf(c,u,g){const d=c.componentType==="Electrolytic Capacitor"||c.componentType==="Diode"||c.componentType==="Battery"||c.componentType==="ZenerDiode",R=c.componentType==="Capacitor"&&"dielectric"in c&&c.dielectric==="Tantalum";if(!(d||R)||c.pinCount!==2||!(u.length===2&&u[0]&&u[0].trim()!==""&&u[1]&&u[1].trim()!==""))return null;const xe=Ce=>{const Me=parseInt(Ce,10);if(isNaN(Me))return null;for(const se of g)if((se.type==="via"||se.type==="pad")&&se.points.length>0){const Be=se.points[0];if(Be.id===Me)return{x:Be.x,y:Be.y}}return null},q=xe(u[0]),p=xe(u[1]);if(!q||!p)return null;const V=Math.hypot(c.x-q.x,c.y-q.y),ue=Math.hypot(c.x-p.x,c.y-p.y),he=["",""];return V<ue?(he[0]="-",he[1]="+"):(he[0]="+",he[1]="-"),he}function Fd(){return{}}function sx(c){}function rx(c,u,g){let d=0;for(const I of u)if(I.designator){const xe=I.designator.match(new RegExp(`^${c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(\\d+)$`));if(xe){const q=parseInt(xe[1],10);q>d&&(d=q)}}const R=g[c]||0;return Math.max(d,R)+1}function cx(c,u,g){const d={...g};return d[c]=Math.max(d[c]||0,u),d}function dx(){const c=document.createElement("canvas"),u=24;c.width=u,c.height=u;const g=c.getContext("2d");g.strokeStyle="#000",g.lineWidth=3,g.lineCap="round";const d=u/2,R=8;return g.beginPath(),g.moveTo(d,d-R),g.lineTo(d,d-2),g.moveTo(d,d+2),g.lineTo(d,d+R),g.moveTo(d-R,d),g.lineTo(d-2,d),g.moveTo(d+2,d),g.lineTo(d+R,d),g.stroke(),`url(${c.toDataURL()}) ${d} ${d}, crosshair`}function ux(c){const u=document.createElement("canvas"),g=Math.max(12,Math.min(c,32)),R=g+4*2;u.width=R,u.height=R;const I=u.getContext("2d"),xe=R/2,q=R/2,p=g/2;return I.fillStyle="#FFFF00",I.strokeStyle="#000000",I.lineWidth=2,I.beginPath(),I.moveTo(xe,q-p),I.lineTo(xe+p,q),I.lineTo(xe,q+p),I.lineTo(xe-p,q),I.closePath(),I.fill(),I.stroke(),`url(${u.toDataURL()}) ${xe} ${q}, crosshair`}function fx(){const c=new Date,u=c.getFullYear(),g=String(c.getMonth()+1).padStart(2,"0"),d=String(c.getDate()).padStart(2,"0"),R=String(c.getHours()).padStart(2,"0"),I=String(c.getMinutes()).padStart(2,"0"),xe=String(c.getSeconds()).padStart(2,"0");return`${u}_${g}_${d}-${R}-${I}-${xe}`}function Wc(c){let u=c.replace(/\.json$/i,""),g="";for(;g!==u;)g=u,u=u.replace(/_\d{4}_\d{2}_\d{2}-\d{2}-\d{2}-\d{2}$/,""),u=u.replace(/_\d{4}_\d{2}_\d{2}_\d{2}_\d{2}_\d{2}$/,"");return u}const Kf=c=>{const u=$d[c];return!u||!u.prefix||u.prefix.length<1?"?":u.prefix[0].substring(0,1).toUpperCase()},yo=(c,u,g)=>({color:u,size:g}),Nh=(c,u,g)=>{},Nn=(c,u,g,d)=>({color:g,size:d}),Fc=(c,u,g,d)=>{},px=()=>{const c=new Map,u={top:"#0072B2",bottom:"#56B4E9"},g={top:18,bottom:18},d={top:"#FFFF00",bottom:"#FFFF00"},R={top:18,bottom:18},I={top:"#AA4499",bottom:"#F781BF"},xe={top:6,bottom:6},q={top:"#6A3D9A",bottom:"#9467BD"},p={top:18,bottom:18};return c.set("select",{id:"select",name:"Select",toolType:"select",icon:"",shortcut:"S",tooltip:"Select objects or groups",colorReflective:!1,settings:yo("select","#ff0000",10),layerSettings:new Map([["top",Nn("select","top","#ff0000",10)],["bottom",Nn("select","bottom","#ff0000",10)]])}),c.set("via",{id:"via",name:"Via",toolType:"draw",drawingMode:"via",icon:"",shortcut:"V",tooltip:"Place via connection",colorReflective:!0,settings:yo("via",$f,Gf.DEFAULT_SIZE),layerSettings:new Map([["top",Nn("via","top",$f,Gf.DEFAULT_SIZE)],["bottom",Nn("via","bottom",$f,Gf.DEFAULT_SIZE)]]),defaultLayer:"top"}),c.set("pad",{id:"pad",name:"Pad",toolType:"draw",drawingMode:"pad",icon:"",shortcut:"P",tooltip:"Place pad connection",colorReflective:!0,settings:yo("pad",nx,18),layerSettings:new Map([["top",Nn("pad","top",u.top,g.top)],["bottom",Nn("pad","bottom",u.bottom,g.bottom)]]),defaultLayer:"top"}),c.set("testPoint",{id:"testPoint",name:"Test Point",toolType:"draw",drawingMode:"testPoint",icon:"",shortcut:"Y",tooltip:"Place test point",colorReflective:!0,settings:yo("testPoint","#FFFF00",18),layerSettings:new Map([["top",Nn("testPoint","top",d.top,R.top)],["bottom",Nn("testPoint","bottom",d.bottom,R.bottom)]]),defaultLayer:"top"}),c.set("trace",{id:"trace",name:"Trace",toolType:"draw",drawingMode:"trace",icon:"",shortcut:"T",tooltip:"Draw copper traces",colorReflective:!0,settings:yo("trace",ex,6),layerSettings:new Map([["top",Nn("trace","top",I.top,xe.top)],["bottom",Nn("trace","bottom",I.bottom,xe.bottom)]]),defaultLayer:"top"}),c.set("component",{id:"component",name:"Component",toolType:"component",icon:"",shortcut:"C",tooltip:"Place component",colorReflective:!0,settings:yo("component",tx,Oh.DEFAULT_SIZE),layerSettings:new Map([["top",Nn("component","top",q.top,p.top)],["bottom",Nn("component","bottom",q.bottom,p.bottom)]]),defaultLayer:"top"}),c.set("componentConnection",{id:"componentConnection",name:"Component Connections",toolType:"componentConnection",icon:"",shortcut:"",tooltip:"Component connection lines",colorReflective:!1,settings:yo("componentConnection","#E69F00",3),layerSettings:new Map([["top",Nn("componentConnection","top","#E69F00",3)],["bottom",Nn("componentConnection","bottom","#E69F00",3)]])}),c.set("power",{id:"power",name:"Power",toolType:"power",icon:"",shortcut:"B",tooltip:"Place power node",colorReflective:!0,settings:yo("power",Xf,18),layerSettings:new Map([["top",Nn("power","top",Xf,18)],["bottom",Nn("power","bottom",Xf,18)]]),defaultLayer:"top"}),c.set("ground",{id:"ground",name:"Ground",toolType:"ground",icon:"",shortcut:"G",tooltip:"Place ground symbol",colorReflective:!0,settings:yo("ground",Yf,18),layerSettings:new Map([["top",Nn("ground","top",Yf,18)],["bottom",Nn("ground","bottom",Yf,18)]]),defaultLayer:"top"}),c.set("erase",{id:"erase",name:"Erase",toolType:"erase",icon:"",shortcut:"E",tooltip:"Erase objects",colorReflective:!1,settings:yo("erase","#f5a3b3",18),layerSettings:new Map([["top",Nn("erase","top","#f5a3b3",18)],["bottom",Nn("erase","bottom","#f5a3b3",18)]])}),c.set("pan",{id:"pan",name:"Move",toolType:"pan",icon:"",shortcut:"H",tooltip:"Pan the view",colorReflective:!1,settings:yo("pan","#ff0000",10),layerSettings:new Map([["top",Nn("pan","top","#ff0000",10)],["bottom",Nn("pan","bottom","#ff0000",10)]])}),c.set("magnify",{id:"magnify",name:"Zoom",toolType:"magnify",icon:"+",shortcut:"M",tooltip:"Magnify",colorReflective:!1,settings:yo("magnify","#ff0000",10),layerSettings:new Map([["top",Nn("magnify","top","#ff0000",10)],["bottom",Nn("magnify","bottom","#ff0000",10)]])}),c},Mh={via:{color:"#2CA02C",size:18},padTop:{color:"#0072B2",size:18},padBottom:{color:"#56B4E9",size:18},testPointTop:{color:"#FFFF00",size:18},testPointBottom:{color:"#FFFF00",size:18},traceTop:{color:"#AA4499",size:6},traceBottom:{color:"#F781BF",size:6},componentTop:{color:"#6A3D9A",size:18},componentBottom:{color:"#9467BD",size:18},power:{color:"#ff0000",size:18},ground:{color:"#000000",size:18}},Wd={via:"Via",padTop:"Pad (Top)",padBottom:"Pad (Bottom)",testPointTop:"Test Point (Top)",testPointBottom:"Test Point (Bottom)",traceTop:"Trace (Top)",traceBottom:"Trace (Bottom)",componentTop:"Component (Top)",componentBottom:"Component (Bottom)",power:"Power",ground:"Ground"};class hx{instances=new Map;listeners=new Map;initialize(){for(const u of Object.keys(Mh)){const g=Mh[u];this.instances.set(u,{id:u,name:Wd[u],color:g.color,size:g.size}),this.listeners.set(u,new Set)}}initializeFromProject(u){if(this.initialize(),u?.toolInstances)for(const[g,d]of Object.entries(u.toolInstances))this.instances.has(g)&&this.instances.set(g,d)}get(u){const g=this.instances.get(u);if(!g)throw new Error(`Tool instance ${u} not found`);return g}getColor(u){const g=this.instances.get(u);if(!g)throw new Error(`Tool instance ${u} not found`);const d=Wd[u];return console.log(`${d}, returning color value=${g.color}`),g.color}getSize(u){const g=this.instances.get(u);if(!g)throw new Error(`Tool instance ${u} not found`);const d=Wd[u];return console.log(`${d}, returning size value=${g.size}`),g.size}setColor(u,g){const d=this.instances.get(u);if(d){const R=Wd[u];console.log(`${R}, setting color value=${g}`),d.color=g,this.notifyListeners(u)}}setSize(u,g){const d=this.instances.get(u);if(d){const R=Wd[u];console.log(`${R}, setting size value=${g}`),d.size=g,this.notifyListeners(u)}}getAll(){const u={};for(const[g,d]of this.instances.entries())u[g]=d;return u}subscribe(u,g){const d=this.listeners.get(u);return d?(d.add(g),()=>{d.delete(g)}):()=>{}}notifyListeners(u){const g=this.listeners.get(u);g&&g.forEach(d=>d())}}const At=new hx;At.initialize();function Lu(c,u){switch(c){case"via":return"via";case"pad":return u==="bottom"?"padBottom":"padTop";case"testPoint":return u==="bottom"?"testPointBottom":"testPointTop";case"trace":return u==="bottom"?"traceBottom":"traceTop";case"component":return u==="bottom"?"componentBottom":"componentTop";case"power":return"power";case"ground":return"ground";default:throw new Error(`Unknown tool: ${c}`)}}const gx=({visible:c,toolRegistry:u,currentTool:g,drawingMode:d,traceToolLayer:R,padToolLayer:I,testPointToolLayer:xe,componentToolLayer:q,updateToolSettings:p,updateToolLayerSettings:V,setBrushSize:ue,saveToolSettings:he,saveToolLayerSettings:Ce,setTopTraceSize:Me,setBottomTraceSize:se,setTopPadSize:Be,setBottomPadSize:B,setTopTestPointSize:te,setBottomTestPointSize:Le,setTopComponentSize:J,setBottomComponentSize:ne,setComponentConnectionSize:M,saveDefaultSize:z,onClose:D})=>{const[P,E]=b.useState({}),pe=[{id:"via",name:"Via",instanceId:"via"},{id:"pad",name:"Pad",layer:"top",instanceId:"padTop"},{id:"pad",name:"Pad",layer:"bottom",instanceId:"padBottom"},{id:"testPoint",name:"Test Point",layer:"top",instanceId:"testPointTop"},{id:"testPoint",name:"Test Point",layer:"bottom",instanceId:"testPointBottom"},{id:"trace",name:"Trace",layer:"top",instanceId:"traceTop"},{id:"trace",name:"Trace",layer:"bottom",instanceId:"traceBottom"},{id:"component",name:"Component",layer:"top",instanceId:"componentTop"},{id:"component",name:"Component",layer:"bottom",instanceId:"componentBottom"},{id:"componentConnection",name:"Component Connections"},{id:"power",name:"Power",instanceId:"power"},{id:"ground",name:"Ground",instanceId:"ground"},{id:"erase",name:"Erase"}];b.useEffect(()=>{if(c){const me={};for(const be of pe){const re=be.instanceId||be.id;if(be.instanceId)try{const _=At.get(be.instanceId);me[re]=_.size}catch{const _=u.get(be.id);_&&(me[re]=be.layer?_.layerSettings.get(be.layer)?.size??_.settings.size??10:_.settings.size??10)}else{const _=u.get(be.id);_&&(me[re]=_.settings.size??10)}}E(me)}},[c]);const W=b.useCallback((me,be,re,_)=>{if(!u.get(me)&&me!=="componentConnection")return;const Y=_||me;E(L=>({...L,[Y]:be})),["trace","pad","testPoint","component"].includes(me)&&re&&_?(At.setSize(_,be),(me==="trace"&&g==="draw"&&d==="trace"||me==="pad"&&g==="draw"&&d==="pad"||me==="testPoint"&&g==="draw"&&d==="testPoint"||me==="component"&&g==="component")&&((me==="trace"?R:me==="pad"?I:me==="testPoint"?xe:q)||"top")===re&&ue(be)):_?(At.setSize(_,be),(me==="via"&&g==="draw"&&d==="via"||me==="power"&&g==="power"||me==="ground"&&g==="ground")&&ue(be)):(me==="componentConnection"&&(M(be),z("componentConnection",be)),me==="erase"&&g==="erase"&&ue(be))},[u,g,d,R,I,xe,q,ue,M,z]);if(!c)return null;const j=Array.from({length:50},(me,be)=>be+1);return n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:me=>{me.target===me.currentTarget&&D()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"16px",width:"fit-content",maxWidth:"400px",maxHeight:"70vh",overflowY:"auto",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:me=>me.stopPropagation(),children:[n.jsx("h3",{style:{margin:"0 0 12px 0",color:"#fff",fontSize:"16px",fontWeight:600},children:"Set Tool Size"}),n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:pe.map((me,be)=>{if(!u.get(me.id)&&me.id!=="componentConnection")return null;const _=me.layer?`${me.name} (${me.layer==="top"?"Top":"Bottom"})`:me.name,O=me.instanceId||me.id,Y=P[O]??10;return n.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"6px 10px",background:"#1f1f24",borderRadius:4},children:[n.jsxs("label",{style:{color:"#f2f2f2",fontSize:"13px",width:"140px",flexShrink:0,marginRight:"8px"},children:[_,":"]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[n.jsx("select",{value:Y,onChange:je=>{const L=parseInt(je.target.value,10);W(me.id,L,me.layer,me.instanceId)},style:{width:"50px",padding:"4px 6px",background:"#2b2b31",border:"1px solid #3a3a44",borderRadius:4,color:"#f2f2f2",fontSize:"12px",cursor:"pointer"},children:j.map(je=>n.jsx("option",{value:je,style:{background:"#2b2b31",color:"#f2f2f2"},children:je},je))}),n.jsx("span",{style:{color:"#f2f2f2",fontSize:"12px"},children:"px"})]})]},`${me.id}-${me.layer||"default"}-${be}`)})}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:n.jsx("button",{onClick:D,style:{padding:"6px 12px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:600},children:"Close"})})]})})},xx=({visible:c,toolRegistry:u,currentTool:g,drawingMode:d,traceToolLayer:R,padToolLayer:I,testPointToolLayer:xe,componentToolLayer:q,updateToolSettings:p,updateToolLayerSettings:V,saveToolSettings:ue,saveToolLayerSettings:he,setBrushColor:Ce,setTopTraceColor:Me,setBottomTraceColor:se,setTopPadColor:Be,setBottomPadColor:B,setTopTestPointColor:te,setBottomTestPointColor:Le,setTopComponentColor:J,setBottomComponentColor:ne,setComponentConnectionColor:M,saveDefaultColor:z,colorPalette:D,onClose:P})=>{const[E,pe]=_e.useState(null),[W,j]=_e.useState(0);if(_e.useEffect(()=>{const O=[];return[{id:"via"},{id:"pad",layer:"top"},{id:"pad",layer:"bottom"},{id:"testPoint",layer:"top"},{id:"testPoint",layer:"bottom"},{id:"trace",layer:"top"},{id:"trace",layer:"bottom"},{id:"component",layer:"top"},{id:"component",layer:"bottom"},{id:"power"},{id:"ground"}].forEach(({id:je,layer:L})=>{try{const S=Lu(je,L),A=At.subscribe(S,()=>{j($=>$+1)});O.push(A)}catch{}}),()=>{O.forEach(je=>je())}},[]),!c)return null;const me=["pad","testPoint","trace","component"],be=[{id:"via",name:"Via"},{id:"pad",name:"Pad",layer:"top"},{id:"pad",name:"Pad",layer:"bottom"},{id:"testPoint",name:"Test Point",layer:"top"},{id:"testPoint",name:"Test Point",layer:"bottom"},{id:"trace",name:"Trace",layer:"top"},{id:"trace",name:"Trace",layer:"bottom"},{id:"component",name:"Component",layer:"top"},{id:"component",name:"Component",layer:"bottom"},{id:"componentConnection",name:"Component Connections"},{id:"power",name:"Power"},{id:"ground",name:"Ground"},{id:"erase",name:"Erase"}],re=(O,Y,je)=>{if(O==="componentConnection"){M(Y),z("componentConnection",Y),pe(null);return}if(O==="erase"){const L=u.get(O);L&&(p(O,{...L.settings,color:Y}),ue(O,Y,L.settings.size)),pe(null);return}try{let L;je&&me.includes(O)?L=Lu(O,je):L=Lu(O),At.setColor(L,Y),(O==="via"&&g==="draw"&&d==="via"||O==="trace"&&g==="draw"&&d==="trace"||O==="pad"&&g==="draw"&&d==="pad"||O==="testPoint"&&g==="draw"&&d==="testPoint"||O==="component"&&g==="component"||O==="power"&&g==="power"||O==="ground"&&g==="ground")&&(je&&me.includes(O)?((O==="trace"?R:O==="pad"?I:O==="testPoint"?xe:q)||"top")===je&&Ce(Y):Ce(Y))}catch(L){console.error(`Error updating color for tool ${O}:`,L);const S=u.get(O);S&&(je&&me.includes(O)?(V(O,je,{...S.layerSettings.get(je),color:Y}),he(O,je,Y,S.layerSettings.get(je)?.size||S.settings.size)):(p(O,{...S.settings,color:Y}),ue(O,Y,S.settings.size)))}pe(null)},_=(O,Y)=>{let je;try{const A=Lu(O,Y);je=At.get(A).color}catch{const A=u.get(O);if(!A)return null;je=A.settings.color??"#000000"}const L=Y?`${O}-${Y}`:O,S=E?.toolId===O&&E?.layer===Y;return n.jsxs("div",{style:{position:"relative",display:"inline-block",zIndex:10005},children:[n.jsx("button",{className:"color-swatch-button",onClick:A=>{A.stopPropagation(),pe(S?null:{toolId:O,layer:Y})},style:{width:"40px",height:"24px",background:je,backgroundColor:je,backgroundImage:"none",border:"1px solid #3a3a44",borderRadius:3,cursor:"pointer",padding:0,margin:0,display:"block","--swatch-color":je},title:je},`${L}-button-${je}-${W}`),S&&n.jsx("div",{onClick:A=>{A.stopPropagation()},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",padding:8,background:"#fff",border:"1px solid #ddd",borderRadius:6,boxShadow:"0 8px 18px rgba(0,0,0,0.18)",zIndex:100},children:n.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(8, 22px)",gap:4},children:D.map(A=>n.jsx("div",{onClick:()=>re(O,A,Y),title:A,style:{width:22,height:22,backgroundColor:A,border:A===je?"2px solid #333":"1px solid #ccc",cursor:"pointer"}},A))})})]},`${L}-${je}-${W}`)};return n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:O=>{O.target===O.currentTarget&&(P(),pe(null))},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"16px",width:"fit-content",minWidth:"450px",maxWidth:"600px",maxHeight:"70vh",overflowY:"auto",overflowX:"visible",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:O=>O.stopPropagation(),children:[n.jsx("h3",{style:{margin:"0 0 12px 0",color:"#fff",fontSize:"16px",fontWeight:600},children:"Set Tool Color"}),n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:be.map((O,Y)=>{if(!u.get(O.id))return null;const L=O.layer?`${O.name} (${O.layer==="top"?"Top":"Bottom"})`:O.name;return n.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"6px 10px",background:"#1f1f24",borderRadius:4},children:[n.jsxs("label",{style:{color:"#f2f2f2",fontSize:"13px",width:"140px",flexShrink:0,marginRight:"8px"},children:[L,":"]}),_(O.id,O.layer)]},`${O.id}-${O.layer||"default"}-${Y}`)})}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:n.jsx("button",{onClick:()=>{P(),pe(null)},style:{padding:"6px 12px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:600},children:"Close"})})]})})},yx=({openMenu:c,setOpenMenu:u,isReadOnlyMode:g,currentProjectFilePath:d,isProjectActive:R,autoSaveEnabled:I,autoSaveInterval:xe,hasUnsavedChangesState:q,onNewProject:p,onOpenProject:V,onSaveProject:ue,onSaveAs:he,onPrint:Ce,hasUnsavedChanges:Me,setNewProjectDialog:se,setAutoSaveDialog:Be,topImage:B,bottomImage:te,setCurrentTool:Le,resetImageTransform:J,areImagesLocked:ne,setAreImagesLocked:M,onEnterBoardDimensions:z,fileInputTopRef:D,fileInputBottomRef:P,openProjectRef:E,increaseSize:pe,decreaseSize:W,brushSize:j,drawingStrokes:me,selectedIds:be,selectedComponentIds:re,selectedPowerIds:_,selectedGroundIds:O,componentsTop:Y,componentsBottom:je,powers:L,grounds:S,powerNodeNames:A,groundNodeNames:$,setSetSizeDialog:Z,areViasLocked:Oe,setAreViasLocked:Ge,arePadsLocked:Xe,setArePadsLocked:xt,areTestPointsLocked:Pe,setAreTestPointsLocked:_n,areTracesLocked:Mn,setAreTracesLocked:Vi,areComponentsLocked:Di,setAreComponentsLocked:yi,areGroundNodesLocked:Ai,setAreGroundNodesLocked:Nl,arePowerNodesLocked:el,setArePowerNodesLocked:Ql,showTraceCornerDots:mo,setShowTraceCornerDots:ir,setSelectedIds:Yo,setSelectedComponentIds:Lc,setSelectedPowerIds:Je,setSelectedGroundIds:ut,selectAllVias:$c,selectAllTraces:He,selectAllPads:Pt,selectAllComponents:Jl,selectDisconnectedComponents:vo,selectAllComponentConnections:Xt,selectAllPowerNodes:bi,selectAllGroundNodes:Ml,selectPowerNodesByName:Wi,selectGroundNodesByName:Ne,setShowPowerBusManager:Yn,setShowGroundBusManager:lt,setShowDesignatorManager:Cn,setShowPastMachine:So,toolRegistry:lr,updateToolSettings:eo,updateToolLayerSettings:Sa,setBrushSize:Bt,setBrushColor:Fi,saveToolSettings:to,saveToolLayerSettings:Li,colorPalette:gs,currentTool:$i,drawingMode:dl,traceToolLayer:no,padToolLayer:$r,testPointToolLayer:Fe,componentToolLayer:mi,setTopTraceSize:kt,setBottomTraceSize:Hn,setTopPadSize:xs,setBottomPadSize:or,setTopTestPointSize:ar,setBottomTestPointSize:ul,setTopComponentSize:ft,setBottomComponentSize:Bn,setComponentConnectionSize:Lt,topTraceColor:wa,bottomTraceColor:ln,topPadColor:sr,bottomPadColor:vn,topTestPointColor:wo,bottomTestPointColor:Xo,topComponentColor:Bl,bottomComponentColor:Ul,setTopTraceColor:Pl,setBottomTraceColor:Go,setTopPadColor:Ot,setBottomPadColor:Yr,setTopTestPointColor:Ht,setBottomTestPointColor:on,setTopComponentColor:fl,setBottomComponentColor:Xr,setComponentConnectionColor:qo,saveDefaultSize:rr,saveDefaultColor:tl,menuBarRef:vi,onOpenProjectNotes:ja,onOpenTransformImages:Xn,onOpenTransformAll:Ni})=>{const[ys,Gn]=_e.useState(null),zn=_e.useRef(null),[bs,xn]=_e.useState(null),li=_e.useRef(null),[Si,Ta]=_e.useState(!1),[ms,Ca]=_e.useState(!1),Yi=we=>{if(!R){alert("Please create a new project (File  New Project) or open an existing project (File  Open Project) before using this feature."),u(null);return}we()},Sn=we=>{const kn=we==="power"?A:$,za=kn.length>0,vt=we==="power"?"Select Power Nodes":"Select Ground Nodes";return n.jsxs("div",{onMouseEnter:()=>{zn.current&&(clearTimeout(zn.current),zn.current=null),Gn(we)},onMouseLeave:()=>{zn.current=window.setTimeout(()=>{Gn(nt=>nt===we?null:nt)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[n.jsxs("div",{style:{padding:"4px 10px",fontSize:12,color:"#bbb"},children:[vt," by Name"]}),n.jsxs("button",{onClick:()=>{we==="power"?bi():Ml(),Gn(null),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:["All ",we==="power"?"Power Nodes":"Ground Nodes"]}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),za?kn.map(nt=>n.jsx("button",{onClick:()=>{we==="power"?Wi(nt):Ne(nt),Gn(null),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:nt},nt)):n.jsxs("div",{style:{padding:"4px 10px",fontSize:12,color:"#bbb"},children:["No ",we==="power"?"power":"ground"," nodes available."]})]})},Gr=()=>n.jsxs("div",{onMouseEnter:()=>{li.current&&(clearTimeout(li.current),li.current=null),xn("lock")},onMouseLeave:()=>{li.current=window.setTimeout(()=>{xn(we=>we==="lock"?null:we)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[n.jsxs("label",{onClick:we=>{we.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[n.jsx("input",{type:"checkbox",checked:Oe,onChange:()=>{Ge(we=>!we)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),n.jsx("span",{children:"Lock Vias"})]}),n.jsxs("label",{onClick:we=>{we.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[n.jsx("input",{type:"checkbox",checked:Xe,onChange:()=>{xt(we=>!we)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),n.jsx("span",{children:"Lock Pads"})]}),n.jsxs("label",{onClick:we=>{we.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[n.jsx("input",{type:"checkbox",checked:Pe,onChange:()=>{_n(we=>!we)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),n.jsx("span",{children:"Lock Test Points"})]}),n.jsxs("label",{onClick:we=>{we.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[n.jsx("input",{type:"checkbox",checked:Mn,onChange:()=>{Vi(we=>!we)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),n.jsx("span",{children:"Lock Traces"})]}),n.jsxs("label",{onClick:we=>{we.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[n.jsx("input",{type:"checkbox",checked:Di,onChange:()=>{yi(we=>!we)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),n.jsx("span",{children:"Lock Components"})]}),n.jsxs("label",{onClick:we=>{we.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[n.jsx("input",{type:"checkbox",checked:Ai,onChange:()=>{Nl(we=>!we)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),n.jsx("span",{children:"Lock Ground Node"})]}),n.jsxs("label",{onClick:we=>{we.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[n.jsx("input",{type:"checkbox",checked:el,onChange:()=>{Ql(we=>!we)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),n.jsx("span",{children:"Lock Power Nodes"})]})]}),mt=()=>n.jsxs("div",{onMouseEnter:()=>{li.current&&(clearTimeout(li.current),li.current=null),xn("select")},onMouseLeave:()=>{li.current=window.setTimeout(()=>{xn(we=>we==="select"?null:we)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[n.jsx("button",{onClick:()=>{$c(),xn(null),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Vias"}),n.jsx("button",{onClick:()=>{He(),xn(null),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Traces"}),n.jsx("button",{onClick:()=>{Pt(),xn(null),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Pads"}),n.jsx("button",{onClick:()=>{const we=new Set(me.filter(kn=>kn.type==="testPoint").map(kn=>kn.id));Yo(we),Lc(new Set),Je(new Set),ut(new Set),xn(null),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Test Points"}),n.jsx("button",{onClick:()=>{Jl(),xn(null),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Components"}),n.jsx("button",{onClick:()=>{Xt(),xn(null),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Component Connections"}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onMouseEnter:()=>{zn.current&&(clearTimeout(zn.current),zn.current=null),Gn("power")},onMouseLeave:()=>{zn.current=window.setTimeout(()=>{Gn(we=>we==="power"?null:we)},200)},onClick:()=>{Gn(we=>we==="power"?null:"power")},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Power Nodes "}),ys==="power"&&Sn("power")]}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onMouseEnter:()=>{zn.current&&(clearTimeout(zn.current),zn.current=null),Gn("ground")},onMouseLeave:()=>{zn.current=window.setTimeout(()=>{Gn(we=>we==="ground"?null:we)},200)},onClick:()=>{Gn(we=>we==="ground"?null:"ground")},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Ground Nodes "}),ys==="ground"&&Sn("ground")]}),n.jsx("button",{onClick:()=>{vo(),xn(null),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Disconnected Components"})]});return n.jsxs(n.Fragment,{children:[n.jsxs("div",{ref:vi,style:{position:"relative",background:"rgba(250,250,255,0.9)",borderBottom:"1px solid #e6e6ef",padding:"6px 12px",display:"flex",gap:16,alignItems:"center",zIndex:3},children:[n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onClick:we=>{we.stopPropagation(),u(kn=>kn==="file"?null:"file")},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:c==="file"?"#eef3ff":"#fff",fontWeight:600,color:"#222"},children:"File "}),c==="file"&&n.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:200,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[n.jsx("button",{onClick:()=>{g||(u(null),Me()?se({visible:!0}):p())},disabled:g,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:g?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:g?"not-allowed":"pointer"},children:"New Project"}),n.jsx("button",{onClick:async()=>{await V(),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Open Project"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{g||Yi(()=>{ue(),u(null)})},disabled:g||!R,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:g||!R?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:g||!R?"not-allowed":"pointer"},children:"Save Project"}),n.jsx("button",{onClick:()=>{g||Yi(()=>{he(),u(null)})},disabled:g||!R,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:g||!R?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:g||!R?"not-allowed":"pointer"},children:"Save As"}),n.jsx("button",{onClick:()=>{g||Yi(()=>{Be({visible:!0,interval:5}),u(null)})},disabled:g||!R,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:g||!R?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:g||!R?"not-allowed":"pointer"},children:"Auto Save"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{Yi(()=>{Ce(),u(null)})},disabled:!R,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:R?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:R?"pointer":"not-allowed"},children:"Print"}),n.jsx("button",{onClick:()=>{Yi(()=>{Ce(),u(null)})},disabled:!R,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:R?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:R?"pointer":"not-allowed"},children:"Printer Settings"})]})]}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onClick:we=>{if(!g){if(!R){alert("Please create a new project (File  New Project) or open an existing project (File  Open Project) before using this feature.");return}we.stopPropagation(),u(kn=>kn==="transform"?null:"transform")}},disabled:g||!R,style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:c==="transform"?"#eef3ff":"#fff",fontWeight:600,color:g||!R?"#999":"#222",cursor:g||!R?"not-allowed":"pointer",opacity:g||!R?.5:1},children:"Images "}),c==="transform"&&n.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:260,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[n.jsx("button",{onClick:()=>{!g&&!ne&&(D.current?.click(),u(null))},disabled:g||ne,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:g||ne?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:g||ne?"not-allowed":"pointer"},children:"Load Top PCB"}),n.jsx("button",{onClick:()=>{!g&&!ne&&(P.current?.click(),u(null))},disabled:g||ne,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:g||ne?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:g||ne?"not-allowed":"pointer"},children:"Load Bottom PCB"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{ne||(z(),u(null))},disabled:ne,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:ne?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:ne?"not-allowed":"pointer"},children:"Enter PCB Dimensions"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{Xn(),u(null)},disabled:!B&&!te||ne,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:!B&&!te||ne?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:!B&&!te||ne?"not-allowed":"pointer"},children:"Transform Images"}),n.jsx("button",{onClick:()=>{ne||(Le("transform"),J(),u(null))},disabled:ne||!B&&!te,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:ne||!B&&!te?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:ne||!B&&!te?"not-allowed":"pointer"},children:"Reset Transform"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{M(we=>!we),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:ne?"Unlock Images ":"Lock Images"})]})]}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onClick:we=>{if(!g){if(!R){alert("Please create a new project (File  New Project) or open an existing project (File  Open Project) before using this feature.");return}we.stopPropagation(),u(kn=>kn==="tools"?null:"tools")}},disabled:g||!R,style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:c==="tools"?"#eef3ff":"#fff",fontWeight:600,color:g||!R?"#999":"#222",cursor:g||!R?"not-allowed":"pointer",opacity:g||!R?.5:1},children:"Tools "}),c==="tools"&&n.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[n.jsx("button",{onClick:()=>{Ni(),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Change Perspective"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{pe(),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Increase Size (+)"}),n.jsx("button",{onClick:()=>{W(),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Decrease Size (-)"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{Ta(!0),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Set Tool Size"}),n.jsx("button",{onClick:()=>{Ca(!0),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Set Tool Color"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onMouseEnter:()=>{li.current&&(clearTimeout(li.current),li.current=null),xn("lock")},onMouseLeave:()=>{li.current=window.setTimeout(()=>{xn(we=>we==="lock"?null:we)},200)},onClick:()=>{xn(we=>we==="lock"?null:"lock")},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Lock "}),bs==="lock"&&Gr()]}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onMouseEnter:()=>{li.current&&(clearTimeout(li.current),li.current=null),xn("select")},onMouseLeave:()=>{li.current=window.setTimeout(()=>{xn(we=>we==="select"?null:we)},200)},onClick:()=>{xn(we=>we==="select"?null:"select")},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Select "}),bs==="select"&&mt()]}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{ja(),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Open Project Notes"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{Yn(!0),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Manage Power Buses"}),n.jsx("button",{onClick:()=>{lt(!0),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Manage Ground Buses"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{Cn(!0),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Manage Designators"}),n.jsxs("button",{onClick:()=>{ir(!mo),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:[mo?" ":"   ","Show Trace Corner Dots"]}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{So(!0),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Restore from History"})]})]}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onClick:we=>{we.stopPropagation(),u(kn=>kn==="about"?null:"about")},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:c==="about"?"#eef3ff":"#fff",fontWeight:600,color:"#222"},children:"About "}),c==="about"&&n.jsx("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:500,maxWidth:700,maxHeight:"80vh",background:"#fff",border:"1px solid #ccc",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:20,overflowY:"auto",zIndex:100},children:n.jsxs("div",{style:{marginBottom:16},children:[n.jsx("h2",{style:{margin:"0 0 16px 0",color:"#000",fontSize:"20px",fontWeight:700},children:"Worms: An Electronics Tool"}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"About"}),n.jsx("p",{style:{margin:"0 0 12px 0",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:"A specialized tool useful for both reverse engineering and troubleshooting electronics by tracing and documenting circuit connections from PCB images. This application supports typical 2 to 4 layer PCBs and enables comprehensive PCB analysis and documentation."}),n.jsx("p",{style:{margin:"0 0 12px 0",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:"This tool can assist in troubleshooting by tracing circuits, holding contextual notes, comparing test results, and documenting findings during the debugging process."})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Technology"}),n.jsx("p",{style:{margin:"0 0 12px 0",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:"The application runs entirely client-side in the browser, to provide a responsive, interactive drawing experience with no backend server requirements."})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Features"}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Tools & Shortcuts"}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px 16px",fontSize:"13px",color:"#222"},children:[n.jsx("div",{children:n.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Select"}),"  ",n.jsx("code",{children:"S"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Via"}),"  ",n.jsx("code",{children:"V"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Pad"}),"  ",n.jsx("code",{children:"P"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Test Point"}),"  ",n.jsx("code",{children:"Y"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Trace"}),"  ",n.jsx("code",{children:"T"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Component"}),"  ",n.jsx("code",{children:"C"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Component Properties"}),"  double-click component"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Resize Icons"}),"  ",n.jsx("code",{children:"+"})," / ",n.jsx("code",{children:"-"})]})]})}),n.jsx("div",{children:n.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Power"}),"  ",n.jsx("code",{children:"B"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Ground"}),"  ",n.jsx("code",{children:"G"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Move (Pan)"}),"  ",n.jsx("code",{children:"H"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Magnify"}),"  ",n.jsx("code",{children:"M"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Set View"}),"  ",n.jsx("code",{children:"X"})," then ",n.jsx("code",{children:"0-9"})," to save view"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Recall View"}),"  ",n.jsx("code",{children:"0-9"})," to recall saved view"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Information Dialog"}),"  ",n.jsx("code",{children:"I"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Notes Dialog"}),"  ",n.jsx("code",{children:"N"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Project Notes / TODO"}),"  ",n.jsx("code",{children:"L"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Undo"}),"  ",n.jsx("code",{children:"Ctrl"})," + ",n.jsx("code",{children:"Z"})]})]})})]}),n.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#222"},children:[n.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600},children:"Arrow Keys"}),n.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Image Transformations"}),"  Arrow keys for scaling, rotating, and adjusting image transformations (when image is selected for transform)"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Move Selected Components"}),"  Arrow keys to nudge selected components"]})]})]})]}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px 20px"},children:[n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Image Management"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Load top and bottom PCB images"}),n.jsx("li",{children:"Image alignment and transformation"}),n.jsx("li",{children:"Transform modes: nudge, scale, rotate, slant, keystone"}),n.jsx("li",{children:"Horizontal and vertical flip controls"}),n.jsx("li",{children:"Brightness and contrast controls"}),n.jsx("li",{children:"Grayscale mode"}),n.jsx("li",{children:"Automated transparency slider"}),n.jsx("li",{children:"Board dimensions configuration"})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Drawing Tools"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Draw copper traces (top and bottom layers)"}),n.jsx("li",{children:"Place vias for layer connections"}),n.jsx("li",{children:"Place component pads (SMD and through-hole)"}),n.jsx("li",{children:"Place test points for circuit testing"}),n.jsx("li",{children:"Place and annotate components"}),n.jsx("li",{children:"Place power and ground nodes"}),n.jsx("li",{children:"Erase tool for removing elements"})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Layer Management"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"14 independent layers to manage PCB element types"}),n.jsx("li",{children:"Separate top and bottom layer support"}),n.jsx("li",{children:"Layer-specific color customization"}),n.jsx("li",{children:"Layer-specific size controls"}),n.jsx("li",{children:"Layer visibility toggles"}),n.jsx("li",{children:"Overlay view mode"})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Component Management"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Component placement with pin counts"}),n.jsx("li",{children:"Pin connection tracking"}),n.jsx("li",{children:"Component type classification"}),n.jsx("li",{children:"Designator and value annotation"}),n.jsx("li",{children:"Component editor dialog"}),n.jsx("li",{children:"Find and center component"})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Selection & Locking"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Select individual elements or groups"}),n.jsx("li",{children:"Select all vias, traces, pads, or components"}),n.jsx("li",{children:"Select power/ground nodes by name"}),n.jsx("li",{children:"Select disconnected components"}),n.jsx("li",{children:"Lock/unlock elements by type"}),n.jsx("li",{children:"Image locking for protection"})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Power & Ground"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Multiple voltage power nodes"}),n.jsx("li",{children:"Power bus management"}),n.jsx("li",{children:"Ground node placement"}),n.jsx("li",{children:"Ground bus management"}),n.jsx("li",{children:"Node naming and organization"})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Customization"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Customizable colors per layer"}),n.jsx("li",{children:"Adjustable brush/tool sizes"}),n.jsx("li",{children:"Size presets for common tools"}),n.jsx("li",{children:"Color palette management"}),n.jsx("li",{children:"Tool settings persistence"})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Project Management"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Create, open, and save projects"}),n.jsx("li",{children:"Auto-save with configurable intervals"}),n.jsx("li",{children:"File history automatically saved in history subdirectory when Auto Save is enabled"}),n.jsx("li",{children:"Project Notes / TODO list with spreadsheet-like editing"}),n.jsx("li",{children:"Project file format (JSON)"}),n.jsx("li",{children:"Print functionality"}),n.jsx("li",{children:"Export to KiCad schematic format (future feature, not yet implemented)"})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"View Controls"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Zoom in/out with mouse wheel"}),n.jsx("li",{children:"Pan view with hand tool"}),n.jsx("li",{children:"Zoom to fit"}),n.jsx("li",{children:"View mode switching (top/bottom/overlay)"}),n.jsx("li",{children:"Save up to 10 view locations (X + 0-9)"}),n.jsx("li",{children:"Recall saved views instantly (0-9 keys)"}),n.jsx("li",{children:"Change Perspective (Tools menu) - switch between top/bottom view and rotate all elements"}),n.jsx("li",{children:"Detailed information dialog"})]})]})]})]}),n.jsx("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #ddd"},children:n.jsxs("p",{style:{margin:"0 0 8px 0",color:"#666",fontSize:"12px",lineHeight:"1.5"},children:["Use the ",n.jsx("strong",{children:"File"})," menu to manage projects, the ",n.jsx("strong",{children:"Images"})," menu for image loading and transformation, and the ",n.jsx("strong",{children:"Tools"})," menu for selection, locking, and customization options."]})}),n.jsxs("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #ddd"},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Future / TODO List"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"A searchable list of common components"}),n.jsx("li",{children:"Output schematics (perhaps as KiCad files)"}),n.jsx("li",{children:"Dynamic layers"}),n.jsx("li",{children:"Create a desktop version of this application using Electron"})]})]})]})})]}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onClick:we=>{we.stopPropagation(),u(kn=>kn==="help"?null:"help")},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:c==="help"?"#eef3ff":"#fff",fontWeight:600,color:"#222"},children:"Help "}),c==="help"&&n.jsx("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:500,maxWidth:700,maxHeight:"80vh",background:"#fff",border:"1px solid #ccc",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:20,overflowY:"auto",zIndex:100},children:n.jsxs("div",{style:{marginBottom:16},children:[n.jsx("h2",{style:{margin:"0 0 16px 0",color:"#000",fontSize:"20px",fontWeight:700},children:"Help: Typical Usage Steps"}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Step 1: Create or Open a Project"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"New Project:"})," File  New Project. Choose a project name and location."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Open Project:"})," File  Open Project. Select an existing project file (.json)."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Auto-Save:"})," File  Auto Save  Enable to automatically save your work at regular intervals."]})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Step 2: Load PCB Images"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Load Top Image:"})," Images  Load Top Image. Select your top-side PCB photo (.png or .jpeg)."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Load Bottom Image:"})," Images  Load Bottom Image. Select your bottom-side PCB photo."]}),n.jsxs("li",{children:["Images are automatically copied to the ",n.jsx("code",{style:{background:"#1f1f24",padding:"2px 4px",borderRadius:3,color:"#fff"},children:"images/"})," subdirectory."]})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Step 3: Align and Transform Images"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Enter Transform Mode:"})," Images  Transform Images. Select which image (Top or Bottom) to transform."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Transform Operations:"})," Use Move, Nudge, Scale, Rotate, Slant, or Keystone to align images."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Image Adjustments:"})," Adjust brightness, contrast, sharpness, and grayscale as needed."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Flip Images:"})," Use horizontal or vertical flip if your images are mirrored."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Arrow Keys:"})," When transform tool is active, use arrow keys for precise adjustments."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Change Perspective:"})," Tools  Change Perspective to switch between top/bottom view or rotate all elements (images, components, traces) together by 90, 180, or 270."]})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Step 4: Set Board Dimensions"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Enter Dimensions:"})," Images  Enter Board Dimensions. Specify the actual physical dimensions of your PCB."]}),n.jsx("li",{children:"This helps ensure accurate measurements and scaling for your reverse engineering work."})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Step 5: Trace Connections"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Place Vias:"})," Click the Via tool (",n.jsx("code",{children:"V"}),") and click on the PCB where vias connect layers."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Place Pads:"})," Click the Pad tool (",n.jsx("code",{children:"P"}),") and mark component pad locations."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Place Test Points:"})," Click the Test Point tool (",n.jsx("code",{children:"Y"}),") to mark test points."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Draw Traces:"})," Click the Trace tool (",n.jsx("code",{children:"T"}),"), select Top or Bottom layer, then click to start a trace. Click again to add segments. Press ",n.jsx("code",{children:"Enter"})," or click outside to finish."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Snapping:"})," Traces automatically snap to nearby vias, pads, power nodes, and ground nodes."]})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Step 6: Place Components"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Place Component:"})," Click the Component tool (",n.jsx("code",{children:"C"}),"), select component type, then click on the PCB."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Edit Component:"})," Double-click a component to open the Component Editor dialog."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Set Properties:"})," Enter designator (e.g., R1, C2), value, and other component details."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Connect Pins:"})," Click on pads or vias to connect component pins to the circuit."]})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Step 7: Add Power and Ground Nodes"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Manage Power Buses:"})," Tools  Manage Power Buses to create and configure voltage buses (e.g., +5V, +3.3V)."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Place Power Nodes:"})," Click the Power tool (",n.jsx("code",{children:"B"}),"), select a voltage bus, then click on the PCB."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Manage Ground Buses:"})," Tools  Manage Ground Buses to configure ground connections."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Place Ground Nodes:"})," Click the Ground tool (",n.jsx("code",{children:"G"}),"), select a ground bus, then click on the PCB."]})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Step 8: Add Notes and Documentation"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Element Notes:"})," Press ",n.jsx("code",{children:"N"})," to open the Notes dialog for selected elements (vias, pads, traces, etc.)."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Project Notes:"})," Press ",n.jsx("code",{children:"L"})," to open Project Notes / TODO list for general project documentation."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Information Dialog:"})," Press ",n.jsx("code",{children:"I"})," to see detailed information about selected elements."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Find Elements:"})," Use the Find button in the Information dialog to center and highlight specific elements."]})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Step 9: Save Your Work"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Manual Save:"})," File  Save Project to save your work manually."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Auto-Save:"})," If enabled, your project is automatically saved at regular intervals."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"History:"})," Auto-saved versions are stored in the ",n.jsx("code",{style:{background:"#1f1f24",padding:"2px 4px",borderRadius:3,color:"#fff"},children:"history/"})," subdirectory."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Restore from History:"})," Tools  Restore from History to access previous versions."]})]})]}),n.jsxs("div",{style:{marginBottom:20,paddingTop:16,borderTop:"1px solid #ddd"},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Keyboard Shortcuts"}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px 16px",fontSize:"13px",color:"#222"},children:[n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600},children:"Drawing Tools"}),n.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Select"}),"  ",n.jsx("code",{children:"S"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Via"}),"  ",n.jsx("code",{children:"V"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Pad"}),"  ",n.jsx("code",{children:"P"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Test Point"}),"  ",n.jsx("code",{children:"Y"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Trace"}),"  ",n.jsx("code",{children:"T"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Component"}),"  ",n.jsx("code",{children:"C"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Power"}),"  ",n.jsx("code",{children:"B"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Ground"}),"  ",n.jsx("code",{children:"G"})]})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600},children:"View & Navigation"}),n.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Move (Pan)"}),"  ",n.jsx("code",{children:"H"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Magnify"}),"  ",n.jsx("code",{children:"M"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Set View"}),"  ",n.jsx("code",{children:"X"})," then ",n.jsx("code",{children:"0-9"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Recall View"}),"  ",n.jsx("code",{children:"0-9"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Information"}),"  ",n.jsx("code",{children:"I"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Notes"}),"  ",n.jsx("code",{children:"N"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Project Notes"}),"  ",n.jsx("code",{children:"L"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Undo"}),"  ",n.jsx("code",{children:"Ctrl+Z"})," / ",n.jsx("code",{children:"Cmd+Z"})]})]})]})]}),n.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#222"},children:[n.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600},children:"Arrow Keys"}),n.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Use arrow keys to adjust image transformations (when transform tool is active)"}),n.jsx("li",{children:"Use arrow keys to nudge selected components"}),n.jsx("li",{children:"Click a slider first, then use arrow keys for precise adjustment"})]})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Tips & Tricks"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Double-click any slider to reset it to the default value"}),n.jsx("li",{children:"Double-click a component to edit its properties"}),n.jsxs("li",{children:["Hold ",n.jsx("code",{children:"Shift"})," while clicking to add to selection"]}),n.jsxs("li",{children:["Use the Information dialog (",n.jsx("code",{children:"I"}),") to see details about selected elements"]}),n.jsx("li",{children:"Lock layers (Tools  Lock) to prevent accidental modifications"}),n.jsx("li",{children:"Use the Find button in the Information dialog to center elements in view"}),n.jsxs("li",{children:["Save views with ",n.jsx("code",{children:"X"})," + number key for quick navigation"]}),n.jsxs("li",{children:["Use ",n.jsx("code",{children:"+"})," and ",n.jsx("code",{children:"-"})," keys to resize tool icons"]})]})]}),n.jsx("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #ddd"},children:n.jsxs("p",{style:{margin:"0 0 8px 0",color:"#666",fontSize:"12px",lineHeight:"1.5"},children:["For more detailed feature information, see the ",n.jsx("strong",{children:"About"})," menu."]})})]})})]}),d&&n.jsxs("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:"8px",paddingLeft:"16px"},children:[n.jsx("div",{style:{fontSize:"12px",color:"#333",fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"40vw"},title:d,children:d}),n.jsx("div",{style:{width:"16px",height:"16px",borderRadius:"50%",border:"1px solid #666",backgroundColor:q?I?"#ffaa00":"#ff0000":"#00ff00",flexShrink:0},title:q?I?`Changes detected  Auto Save: ON  Will be saved automatically every ${xe||1} minute${xe===1?"":"s"}`:"Changes detected  Auto Save: OFF  You need to save manually (File  Save Project)":"Project saved  No unsaved changes  Auto Save: "+(I?"ON":"OFF")})]})]}),n.jsx(gx,{visible:Si,toolRegistry:lr,currentTool:$i,drawingMode:dl,traceToolLayer:no,padToolLayer:$r,testPointToolLayer:Fe,componentToolLayer:mi,updateToolSettings:eo,updateToolLayerSettings:Sa,setBrushSize:Bt,saveToolSettings:to,saveToolLayerSettings:Li,setTopTraceSize:kt,setBottomTraceSize:Hn,setTopPadSize:xs,setBottomPadSize:or,setTopTestPointSize:ar,setBottomTestPointSize:ul,setTopComponentSize:ft,setBottomComponentSize:Bn,setComponentConnectionSize:Lt,saveDefaultSize:rr,onClose:()=>Ta(!1)}),n.jsx(xx,{visible:ms,toolRegistry:lr,currentTool:$i,drawingMode:dl,traceToolLayer:no,padToolLayer:$r,testPointToolLayer:Fe,componentToolLayer:mi,updateToolSettings:eo,updateToolLayerSettings:Sa,saveToolSettings:to,saveToolLayerSettings:Li,setBrushColor:Fi,setTopTraceColor:Pl,setBottomTraceColor:Go,setTopPadColor:Ot,setBottomPadColor:Yr,setTopTestPointColor:Ht,setBottomTestPointColor:on,setTopComponentColor:fl,setBottomComponentColor:Xr,setComponentConnectionColor:qo,saveDefaultColor:tl,colorPalette:gs,onClose:()=>Ca(!1)})]})},bx=({visible:c})=>c?n.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",padding:"24px 32px",background:"rgba(255, 255, 255, 0.95)",borderRadius:8,border:"2px solid #4CAF50",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",zIndex:1,maxWidth:"500px"},children:[n.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"#000",marginBottom:"12px"},children:"PCB Reverse Engineering Tool"}),n.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"#000",marginBottom:"16px",lineHeight:"1.5"},children:"Supports Typical 4-Layer PCBs"}),n.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"8px",lineHeight:"1.5",textAlign:"left"},children:"1) Use the File menu to start a new project."}),n.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"8px",lineHeight:"1.5",textAlign:"left"},children:"2) Use the Images menu to load PCB photos."}),n.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"12px",lineHeight:"1.5",textAlign:"left"},children:"3) Use the tools to draw vias, pads, traces, etc."}),n.jsx("div",{style:{fontSize:"13px",color:"#555",marginTop:"16px",lineHeight:"1.5",textAlign:"left",fontWeight:"bold"},children:"Best viewed in browser's Full Screen Mode"})]}):null,mx=({visible:c,title:u,message:g,onClose:d})=>c?n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:R=>{R.target===R.currentTarget&&d()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"2px solid #ff4444"},onClick:R=>R.stopPropagation(),children:[n.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",gap:"12px"},children:[n.jsx("div",{style:{fontSize:"24px",color:"#ff4444"},children:""}),n.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:u})]}),n.jsx("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"14px",lineHeight:"1.5"},children:g}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:n.jsx("button",{onClick:d,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"OK"})})]})}):null,vx=({visible:c,selectedIds:u,selectedComponentIds:g,selectedPowerIds:d,selectedGroundIds:R,drawingStrokes:I,componentsTop:xe,componentsBottom:q,powers:p,grounds:V,powerBuses:ue,onClose:he,setComponentsTop:Ce,setComponentsBottom:Me,determineViaType:se,determinePadType:Be,determineTestPointType:B,onFindComponent:te,onFindStroke:Le,onFindPower:J,onFindGround:ne,position:M,isDragging:z,onDragStart:D,onOpenNotesDialog:P})=>{if(!c)return null;const E=M?{position:"fixed",left:`${M.x}px`,top:`${M.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"150px",maxWidth:"400px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:z?"grabbing":"default"}:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"flex-start",justifyContent:"flex-end",paddingRight:"20px",paddingTop:"80px",zIndex:1e4,pointerEvents:"none"},pe={padding:"20px",overflow:"auto",flex:1};return n.jsxs("div",{style:E,children:[n.jsxs("div",{onMouseDown:W=>{const j=W.target;j.tagName==="BUTTON"||j.closest("button")||M&&D(W)},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:z?"grabbing":M?"grab":"default",userSelect:"none",flexShrink:0},children:[n.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Information (I)"}),n.jsx("button",{onClick:he,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),n.jsx("div",{style:pe,children:n.jsxs("div",{style:{margin:0,padding:0,backgroundColor:"#f5f5f5",borderRadius:4,fontSize:"12px",fontFamily:"monospace",maxHeight:"calc(80vh - 100px)",overflow:"auto",color:"#000"},children:[(()=>{const W=I.filter(_=>u.has(_.id)).length,j=[...xe,...q].filter(_=>g.has(_.id)).length,me=p.filter(_=>d.has(_.id)).length,be=V.filter(_=>R.has(_.id)).length,re=W+j+me+be;return n.jsx("div",{style:{padding:"12px 16px",backgroundColor:re>0?"#e8e8e8":"#fff3cd",borderBottom:"2px solid #ccc",fontSize:"13px",fontWeight:600,color:re>0?"#333":"#856404",marginBottom:"8px"},children:re>0?`${re} Object${re!==1?"s":""} Selected`:"Zero Objects Selected"})})(),g.size>0&&(()=>{const W=I.some(j=>u.has(j.id)&&(j.type==="via"||j.type==="pad"));return[...xe,...q].filter(j=>g.has(j.id)).map(j=>n.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:Ld(j.componentType)})]}),te&&n.jsx("button",{onClick:()=>{te(j.id,j.x,j.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:me=>{me.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:me=>{me.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),n.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[n.jsxs("div",{children:["Layer: ",j.layer]}),j.componentType==="IntegratedCircuit"&&n.jsxs(n.Fragment,{children:[j.description&&n.jsxs("div",{children:["Description: ",j.description]}),j.icType&&n.jsxs("div",{children:["IC Type: ",j.icType]})]}),n.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),n.jsx("input",{type:"text",value:j.notes||"",readOnly:!0,onClick:P,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[n.jsxs("span",{children:["Designator: ",j.designator||"(empty)"]}),W&&n.jsx("button",{onClick:()=>{const me=[...xe,...q].filter(S=>g.has(S.id)&&S.componentType===j.componentType),be=me.length,re=I.filter(S=>u.has(S.id)&&S.type==="pad"&&S.points.length>0&&S.points[0].id!==void 0).map(S=>{const A=S.points[0].id;if(A===void 0)throw new Error("Unexpected undefined id");return{stroke:S,nodeId:A}}).sort((S,A)=>S.nodeId-A.nodeId),_=re.length>0?re:I.filter(S=>u.has(S.id)&&S.type==="via"&&S.points.length>0&&S.points[0].id!==void 0).map(S=>{const A=S.points[0].id;if(A===void 0)throw new Error("Unexpected undefined id");return{stroke:S,nodeId:A}}).sort((S,A)=>S.nodeId-A.nodeId),O=_.length;if(O===0){console.warn("No vias or pads with Node IDs found in selection");return}const Y=Math.floor(O/be);if(Y===0){console.warn(`Not enough ${re.length>0?"pads":"vias"} (${O}) for ${be} components`);return}[...me].sort((S,A)=>S.id.localeCompare(A.id)).forEach((S,A)=>{const $=A*Y,Z=$+Y,Ge=_.slice($,Z).map(xt=>xt.nodeId.toString()),Xe=Jf(S,Ge,I);S.layer==="top"?Ce(xt=>xt.map(Pe=>{if(Pe.id===S.id){const _n={...Pe,pinCount:Y,pinConnections:Ge};return Xe&&(_n.pinPolarities=Xe),_n}return Pe})):Me(xt=>xt.map(Pe=>{if(Pe.id===S.id){const _n={...Pe,pinCount:Y,pinConnections:Ge};return Xe&&(_n.pinPolarities=Xe),_n}return Pe}))});const L=re.length>0?"pads":"vias";console.log(`Connected ${be} components of type ${j.componentType} to ${O} ${L} (${Y} pins each)`)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap"},onMouseEnter:me=>{me.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:me=>{me.currentTarget.style.backgroundColor="#4CAF50"},children:"Connect"})]}),n.jsxs("div",{children:["Abbreviation: ",j.abbreviation||"(empty)"]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("span",{children:"Color:"}),n.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:j.color,border:"1px solid #ccc",borderRadius:2}}),n.jsx("span",{children:j.color})]}),n.jsxs("div",{children:["Size: ",j.size]}),n.jsxs("div",{children:["Pin Count: ",j.pinCount]}),j.componentType==="Resistor"&&n.jsxs(n.Fragment,{children:[j.resistance&&n.jsxs("div",{children:["Resistance: ",j.resistance]}),j.power&&n.jsxs("div",{children:["Power: ",j.power]}),j.tolerance&&n.jsxs("div",{children:["Tolerance: ",j.tolerance]})]}),j.componentType==="Capacitor"&&n.jsxs(n.Fragment,{children:[j.capacitance&&n.jsxs("div",{children:["Capacitance: ",j.capacitance]}),j.voltage&&n.jsxs("div",{children:["Voltage: ",j.voltage]}),j.dielectric&&n.jsxs("div",{children:["Dielectric: ",j.dielectric]}),j.tolerance&&n.jsxs("div",{children:["Tolerance: ",j.tolerance]})]}),j.componentType==="Electrolytic Capacitor"&&n.jsxs(n.Fragment,{children:[j.capacitance&&n.jsxs("div",{children:["Capacitance: ",j.capacitance]}),j.voltage&&n.jsxs("div",{children:["Voltage: ",j.voltage]}),j.tolerance&&n.jsxs("div",{children:["Tolerance: ",j.tolerance]}),j.polarity&&n.jsxs("div",{children:["Polarity: ",j.polarity]}),j.esr&&n.jsxs("div",{children:["ESR: ",j.esr]}),j.temperature&&n.jsxs("div",{children:["Temperature: ",j.temperature]})]}),j.pinConnections&&j.pinConnections.length>0&&(()=>{const me=j.componentType==="Electrolytic Capacitor"||j.componentType==="Diode"||j.componentType==="Battery"||j.componentType==="ZenerDiode",be=j.componentType==="Capacitor"&&"dielectric"in j&&j.dielectric==="Tantalum",re=me||be;return n.jsxs("div",{style:{marginTop:"8px",marginBottom:"8px"},children:[n.jsx("div",{style:{marginBottom:"4px",fontWeight:600},children:"Pin Connections:"}),n.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px",border:"1px solid #ddd"},children:[n.jsx("thead",{children:n.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[n.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Pin #"}),re&&n.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Polarity"}),n.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Node ID"})]})}),n.jsx("tbody",{children:j.pinConnections.map((_,O)=>{const Y=j.pinPolarities&&j.pinPolarities.length>O?j.pinPolarities[O]:"";return n.jsxs("tr",{style:{backgroundColor:O%2===0?"#fff":"#f9f9f9"},children:[n.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:O+1}),re&&n.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd",textAlign:"center",fontFamily:"monospace",fontWeight:600,color:Y==="+"?"#d32f2f":Y==="-"?"#1976d2":"#999"},children:Y||"-"}),n.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:_||"(not connected)"})]},O)})})]})]})})(),"manufacturer"in j&&j.manufacturer&&n.jsxs("div",{children:["Manufacturer: ",j.manufacturer]}),"partNumber"in j&&j.partNumber&&n.jsxs("div",{children:["Part Number: ",j.partNumber]}),j.componentType==="Diode"&&n.jsxs(n.Fragment,{children:[j.diodeType&&n.jsxs("div",{children:["Type: ",j.diodeType]}),j.voltage&&n.jsxs("div",{children:["Voltage: ",j.voltage]}),j.current&&n.jsxs("div",{children:["Current: ",j.current]}),j.ledColor&&n.jsxs("div",{children:["LED Color: ",j.ledColor]})]}),j.componentType==="Battery"&&n.jsxs(n.Fragment,{children:[j.voltage&&n.jsxs("div",{children:["Voltage: ",j.voltage]}),j.capacity&&n.jsxs("div",{children:["Capacity: ",j.capacity]}),j.chemistry&&n.jsxs("div",{children:["Chemistry: ",j.chemistry]})]}),j.componentType==="Fuse"&&n.jsxs(n.Fragment,{children:[j.current&&n.jsxs("div",{children:["Current: ",j.current]}),j.voltage&&n.jsxs("div",{children:["Voltage: ",j.voltage]}),j.fuseType&&n.jsxs("div",{children:["Type: ",j.fuseType]})]}),j.componentType==="FerriteBead"&&n.jsxs(n.Fragment,{children:[j.impedance&&n.jsxs("div",{children:["Impedance: ",j.impedance]}),j.current&&n.jsxs("div",{children:["Current: ",j.current]})]}),j.componentType==="Connector"&&n.jsxs(n.Fragment,{children:[j.connectorType&&n.jsxs("div",{children:["Type: ",j.connectorType]}),j.gender&&n.jsxs("div",{children:["Gender: ",j.gender]})]}),j.componentType==="Jumper"&&n.jsx(n.Fragment,{children:j.positions&&n.jsxs("div",{children:["Positions: ",j.positions]})}),j.componentType==="Relay"&&n.jsxs(n.Fragment,{children:[j.coilVoltage&&n.jsxs("div",{children:["Coil Voltage: ",j.coilVoltage]}),j.contactType&&n.jsxs("div",{children:["Contact Type: ",j.contactType]}),j.current&&n.jsxs("div",{children:["Current: ",j.current]})]}),j.componentType==="Inductor"&&n.jsxs(n.Fragment,{children:[j.inductance&&n.jsxs("div",{children:["Inductance: ",j.inductance]}),j.current&&n.jsxs("div",{children:["Current: ",j.current]}),j.resistance&&n.jsxs("div",{children:["DC Resistance: ",j.resistance]})]}),j.componentType==="Speaker"&&n.jsxs(n.Fragment,{children:[j.impedance&&n.jsxs("div",{children:["Impedance: ",j.impedance]}),j.power&&n.jsxs("div",{children:["Power: ",j.power]})]}),j.componentType==="Motor"&&n.jsxs(n.Fragment,{children:[j.motorType&&n.jsxs("div",{children:["Type: ",j.motorType]}),j.voltage&&n.jsxs("div",{children:["Voltage: ",j.voltage]}),j.current&&n.jsxs("div",{children:["Current: ",j.current]})]}),j.componentType==="PowerSupply"&&n.jsxs(n.Fragment,{children:[j.inputVoltage&&n.jsxs("div",{children:["Input Voltage: ",j.inputVoltage]}),j.outputVoltage&&n.jsxs("div",{children:["Output Voltage: ",j.outputVoltage]}),j.current&&n.jsxs("div",{children:["Current: ",j.current]})]}),j.componentType==="Transistor"&&n.jsxs(n.Fragment,{children:[j.transistorType&&n.jsxs("div",{children:["Type: ",j.transistorType]}),j.polarity&&n.jsxs("div",{children:["Polarity: ",j.polarity]}),j.voltage&&n.jsxs("div",{children:["Voltage: ",j.voltage]}),j.current&&n.jsxs("div",{children:["Current: ",j.current]})]}),j.componentType==="ResistorNetwork"&&n.jsxs(n.Fragment,{children:[j.resistance&&n.jsxs("div",{children:["Resistance: ",j.resistance]}),j.configuration&&n.jsxs("div",{children:["Configuration: ",j.configuration]})]}),j.componentType==="Thermistor"&&n.jsxs(n.Fragment,{children:[j.resistance&&n.jsxs("div",{children:["Resistance: ",j.resistance]}),j.thermistorType&&n.jsxs("div",{children:["Type: ",j.thermistorType]}),j.beta&&n.jsxs("div",{children:["Beta: ",j.beta]})]}),j.componentType==="Switch"&&n.jsxs(n.Fragment,{children:[j.switchType&&n.jsxs("div",{children:["Type: ",j.switchType]}),j.current&&n.jsxs("div",{children:["Current: ",j.current]}),j.voltage&&n.jsxs("div",{children:["Voltage: ",j.voltage]})]}),j.componentType==="Transformer"&&n.jsxs(n.Fragment,{children:[j.primaryVoltage&&n.jsxs("div",{children:["Primary Voltage: ",j.primaryVoltage]}),j.secondaryVoltage&&n.jsxs("div",{children:["Secondary Voltage: ",j.secondaryVoltage]}),j.power&&n.jsxs("div",{children:["Power: ",j.power]}),j.turns&&n.jsxs("div",{children:["Turns Ratio: ",j.turns]})]}),j.componentType==="TestPoint"&&n.jsx(n.Fragment,{children:j.signal&&n.jsxs("div",{children:["Signal: ",j.signal]})}),j.componentType==="IntegratedCircuit"&&n.jsx(n.Fragment,{children:j.datasheet&&n.jsxs("div",{children:["Datasheet: ",n.jsx("a",{href:j.datasheet,target:"_blank",rel:"noopener noreferrer",children:j.datasheet})]})}),j.componentType==="VacuumTube"&&n.jsx(n.Fragment,{children:j.tubeType&&n.jsxs("div",{children:["Type: ",j.tubeType]})}),j.componentType==="VariableResistor"&&n.jsxs(n.Fragment,{children:[j.vrType&&n.jsxs("div",{children:["Type: ",j.vrType]}),j.resistance&&n.jsxs("div",{children:["Resistance: ",j.resistance]}),j.power&&n.jsxs("div",{children:["Power: ",j.power]}),j.taper&&n.jsxs("div",{children:["Taper: ",j.taper]})]}),j.componentType==="Crystal"&&n.jsxs(n.Fragment,{children:[j.frequency&&n.jsxs("div",{children:["Frequency: ",j.frequency]}),j.loadCapacitance&&n.jsxs("div",{children:["Load Capacitance: ",j.loadCapacitance]}),j.tolerance&&n.jsxs("div",{children:["Tolerance: ",j.tolerance]})]}),j.componentType==="ZenerDiode"&&n.jsxs(n.Fragment,{children:[j.voltage&&n.jsxs("div",{children:["Zener Voltage: ",j.voltage]}),j.power&&n.jsxs("div",{children:["Power: ",j.power]}),j.tolerance&&n.jsxs("div",{children:["Tolerance: ",j.tolerance]})]}),n.jsx("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid #eee",fontSize:"10px",color:"#999"},children:n.jsxs("div",{children:["Position: x=",j.x.toFixed(2),", y=",j.y.toFixed(2)]})})]})]},j.id))})(),u.size>0&&I.filter(W=>u.has(W.id)&&W.type==="via"&&W.points.length>0).map(W=>{const j=W.points[0],me=W.viaType||(j.id!==void 0?se(j.id,ue):"Via");return n.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:me})]}),Le&&n.jsx("button",{onClick:()=>{Le(W.id,j.x,j.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:be=>{be.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:be=>{be.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),n.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[j.id&&n.jsxs("div",{children:["Node ID: ",j.id]}),n.jsx("div",{children:"Layer: Top and Bottom"}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("span",{children:"Color:"}),n.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:W.color,border:"1px solid #ccc",borderRadius:2}}),n.jsx("span",{children:W.color})]}),n.jsxs("div",{children:["Size: ",W.size]}),n.jsxs("div",{children:["Position: x=",j.x.toFixed(2),", y=",j.y.toFixed(2)]}),n.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),n.jsx("input",{type:"text",value:W.notes||"",readOnly:!0,onClick:P,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},W.id)}),u.size>0&&I.filter(W=>u.has(W.id)&&W.type==="pad"&&W.points.length>0).map(W=>{const j=W.points[0],me=W.padType||(j.id!==void 0?Be(j.id,ue):"Pad");return n.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:me})]}),Le&&n.jsx("button",{onClick:()=>{Le(W.id,j.x,j.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:be=>{be.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:be=>{be.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),n.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[j.id&&n.jsxs("div",{children:["Node ID: ",j.id]}),n.jsxs("div",{children:["Layer: ",W.layer]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("span",{children:"Color:"}),n.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:W.color,border:"1px solid #ccc",borderRadius:2}}),n.jsx("span",{children:W.color})]}),n.jsxs("div",{children:["Size: ",W.size]}),n.jsxs("div",{children:["Position: x=",j.x.toFixed(2),", y=",j.y.toFixed(2)]}),n.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),n.jsx("input",{type:"text",value:W.notes||"",readOnly:!0,onClick:P,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},W.id)}),u.size>0&&I.filter(W=>u.has(W.id)&&W.type==="testPoint"&&W.points.length>0).map(W=>{const j=W.points[0],me=j.id!==void 0?B(j.id,ue):"Test Point";return n.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:me})]}),Le&&n.jsx("button",{onClick:()=>{Le(W.id,j.x,j.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:be=>{be.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:be=>{be.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),n.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[j.id&&n.jsxs("div",{children:["Node ID: ",j.id]}),n.jsxs("div",{children:["Layer: ",W.layer]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("span",{children:"Color:"}),n.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:W.color,border:"1px solid #ccc",borderRadius:2}}),n.jsx("span",{children:W.color})]}),n.jsxs("div",{children:["Size: ",W.size]}),n.jsxs("div",{children:["Position: x=",j.x.toFixed(2),", y=",j.y.toFixed(2)]}),n.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),n.jsx("input",{type:"text",value:W.notes||"",readOnly:!0,onClick:P,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},W.id)}),u.size>0&&I.filter(W=>u.has(W.id)&&W.type==="trace").map(W=>{const j=W.points.length>0?W.points.reduce((be,re)=>be+re.x,0)/W.points.length:0,me=W.points.length>0?W.points.reduce((be,re)=>be+re.y,0)/W.points.length:0;return n.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:W.type||"unknown"})]}),Le&&W.points.length>0&&n.jsx("button",{onClick:()=>{Le(W.id,j,me)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:be=>{be.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:be=>{be.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),n.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[W.points.length>0&&n.jsxs("div",{style:{marginTop:"8px",marginBottom:"8px"},children:[n.jsxs("div",{style:{marginBottom:"4px",fontWeight:600},children:["Points: ",W.points.length]}),n.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px",border:"1px solid #ddd"},children:[n.jsx("thead",{children:n.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[n.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Point #"}),n.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"x"}),n.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"y"}),n.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Node ID"})]})}),n.jsx("tbody",{children:W.points.map((be,re)=>n.jsxs("tr",{style:{backgroundColor:re%2===0?"#fff":"#f9f9f9"},children:[n.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:re}),n.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:be.x.toFixed(2)}),n.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:be.y.toFixed(2)}),n.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:be.id||"(none)"})]},re))})]})]}),n.jsxs("div",{style:{marginTop:"4px"},children:["Layer: ",W.layer]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("span",{children:"Color:"}),n.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:W.color,border:"1px solid #ccc",borderRadius:2}}),n.jsx("span",{children:W.color})]}),n.jsxs("div",{children:["Size: ",W.size]}),n.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),n.jsx("input",{type:"text",value:W.notes||"",readOnly:!0,onClick:P,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},W.id)}),d.size>0&&p.filter(W=>d.has(W.id)).map(W=>{const j=ue.find(me=>me.id===W.powerBusId);return n.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:W.type||(j?`${j.name} Power Node`:"Power Node")})]}),J&&n.jsx("button",{onClick:()=>{J(W.id,W.x,W.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:me=>{me.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:me=>{me.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),n.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[n.jsxs("div",{children:["Node ID: ",W.pointId||"(not assigned)"]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("span",{children:"Color:"}),n.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:W.color,border:"1px solid #ccc",borderRadius:2}}),n.jsx("span",{children:W.color})]}),n.jsxs("div",{children:["Size: ",W.size]}),n.jsxs("div",{children:["Layer: ",W.layer]}),n.jsxs("div",{children:["Power Bus: ",j?.name||W.powerBusId||"(unknown)"]}),n.jsxs("div",{children:["Position: x=",W.x.toFixed(2),", y=",W.y.toFixed(2)]}),n.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),n.jsx("input",{type:"text",value:W.notes||"",readOnly:!0,onClick:P,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},W.id)}),R.size>0&&V.filter(W=>R.has(W.id)).map(W=>n.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:W.type||"Ground Node"})]}),ne&&n.jsx("button",{onClick:()=>{ne(W.id,W.x,W.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:j=>{j.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:j=>{j.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),n.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[n.jsxs("div",{children:["Node ID: ",W.pointId||"(not assigned)"]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("span",{children:"Color:"}),n.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:W.color,border:"1px solid #ccc",borderRadius:2}}),n.jsx("span",{children:W.color})]}),n.jsxs("div",{children:["Size: ",W.size]}),n.jsxs("div",{children:["Position: x=",W.x.toFixed(2),", y=",W.y.toFixed(2)]}),n.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),n.jsx("input",{type:"text",value:W.notes||"",readOnly:!0,onClick:P,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},W.id))]})})]})},En=200,Sx=({visible:c,selectedIds:u,selectedComponentIds:g,selectedPowerIds:d,selectedGroundIds:R,drawingStrokes:I,componentsTop:xe,componentsBottom:q,powers:p,grounds:V,powerBuses:ue,onClose:he,setComponentsTop:Ce,setComponentsBottom:Me,setDrawingStrokes:se,setPowerSymbols:Be,setGroundSymbols:B,determineViaType:te,determinePadType:Le,determineTestPointType:J,position:ne,isDragging:M,onDragStart:z})=>{const[D,P]=b.useState(new Map),E=b.useRef(""),pe=()=>[...Array.from(u).sort(),...Array.from(g).sort(),...Array.from(d).sort(),...Array.from(R).sort()].join(",");if(b.useEffect(()=>{if(!c)return;const L=pe();L!==E.current&&(E.current=L,P(S=>{const A=new Map;return[...xe,...q].filter($=>g.has($.id)).forEach($=>{const Z=S.get($.id);A.set($.id,Z!==void 0?Z:$.notes||"")}),I.filter($=>u.has($.id)).forEach($=>{const Z=S.get($.id);A.set($.id,Z!==void 0?Z:$.notes||"")}),p.filter($=>d.has($.id)).forEach($=>{const Z=S.get($.id);A.set($.id,Z!==void 0?Z:$.notes||"")}),V.filter($=>R.has($.id)).forEach($=>{const Z=S.get($.id);A.set($.id,Z!==void 0?Z:$.notes||"")}),A}))},[c,u,g,d,R,I,xe,q,p,V]),!c)return null;const W=ne?{position:"fixed",left:`${ne.x}px`,top:`${ne.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"150px",maxWidth:"400px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:M?"grabbing":"default"}:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"flex-start",justifyContent:"flex-end",paddingRight:"20px",paddingTop:"80px",zIndex:1e4,pointerEvents:"none"},j={padding:"20px",overflow:"auto",flex:1},me=I.filter(L=>u.has(L.id)).length,be=[...xe,...q].filter(L=>g.has(L.id)).length,re=p.filter(L=>d.has(L.id)).length,_=V.filter(L=>R.has(L.id)).length,O=me+be+re+_,Y=(L,S)=>{const A=S.length>En?S.substring(0,En):S;P($=>{const Z=new Map($);return Z.set(L,A),Z})},je=()=>{Ce(L=>L.map(S=>{if(g.has(S.id)&&D.has(S.id)){const A=D.get(S.id)||"";return{...S,notes:A.trim()===""?null:A.trim()}}return S})),Me(L=>L.map(S=>{if(g.has(S.id)&&D.has(S.id)){const A=D.get(S.id)||"";return{...S,notes:A.trim()===""?null:A.trim()}}return S})),se(L=>L.map(S=>{if(u.has(S.id)&&D.has(S.id)){const A=D.get(S.id)||"";return{...S,notes:A.trim()===""?null:A.trim()}}return S})),Be(L=>L.map(S=>{if(d.has(S.id)&&D.has(S.id)){const A=D.get(S.id)||"";return{...S,notes:A.trim()===""?null:A.trim()}}return S})),B(L=>L.map(S=>{if(R.has(S.id)&&D.has(S.id)){const A=D.get(S.id)||"";return{...S,notes:A.trim()===""?null:A.trim()}}return S}))};return n.jsxs("div",{style:W,children:[n.jsxs("div",{onMouseDown:L=>{const S=L.target;S.tagName==="BUTTON"||S.closest("button")||ne&&z(L)},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:M?"grabbing":ne?"grab":"default",userSelect:"none",flexShrink:0},children:[n.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Notes (N)"}),n.jsx("button",{onClick:he,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),n.jsx("div",{style:j,children:n.jsxs("div",{style:{margin:0,padding:0,backgroundColor:"#f5f5f5",borderRadius:4,fontSize:"12px",fontFamily:"monospace",maxHeight:"calc(80vh - 100px)",overflow:"auto",color:"#000"},children:[n.jsx("div",{style:{padding:"12px 16px",backgroundColor:O>0?"#e8e8e8":"#fff3cd",borderBottom:"2px solid #ccc",fontSize:"13px",fontWeight:600,color:O>0?"#333":"#856404",marginBottom:"8px"},children:O>0?`${O} Object${O!==1?"s":""} Selected`:"Zero Objects Selected"}),O===0?n.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"No objects selected. Select one or more objects to add or edit notes."}):n.jsxs(n.Fragment,{children:[[...xe,...q].filter(L=>g.has(L.id)).map(L=>{const S=D.get(L.id)||"",A=S.length;return n.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),n.jsxs("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:[Ld(L.componentType),L.designator&&L.designator.trim()?` (${L.designator.trim()})`:""]})]}),n.jsxs("div",{style:{padding:"8px"},children:[n.jsx("textarea",{value:S,onChange:$=>Y(L.id,$.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:En,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),n.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:A>=En?"#d32f2f":"#666",textAlign:"right"},children:[A," / ",En]})]})]},L.id)}),I.filter(L=>u.has(L.id)&&L.type==="via"&&L.points.length>0).map(L=>{const S=L.points[0],A=L.viaType||(S.id!==void 0?te(S.id,ue):"Via"),$=D.get(L.id)||"",Z=$.length;return n.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:A})]}),n.jsxs("div",{style:{padding:"8px"},children:[n.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:S.id&&n.jsxs("div",{children:["Node ID: ",S.id]})}),n.jsx("textarea",{value:$,onChange:Oe=>Y(L.id,Oe.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:En,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),n.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Z>=En?"#d32f2f":"#666",textAlign:"right"},children:[Z," / ",En]})]})]},L.id)}),I.filter(L=>u.has(L.id)&&L.type==="pad"&&L.points.length>0).map(L=>{const S=L.points[0],A=L.padType||(S.id!==void 0?Le(S.id,ue):"Pad"),$=D.get(L.id)||"",Z=$.length;return n.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:A})]}),n.jsxs("div",{style:{padding:"8px"},children:[n.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:S.id&&n.jsxs("div",{children:["Node ID: ",S.id]})}),n.jsx("textarea",{value:$,onChange:Oe=>Y(L.id,Oe.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:En,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),n.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Z>=En?"#d32f2f":"#666",textAlign:"right"},children:[Z," / ",En]})]})]},L.id)}),I.filter(L=>u.has(L.id)&&L.type==="testPoint"&&L.points.length>0).map(L=>{const S=L.points[0],A=S.id!==void 0?J(S.id,ue):"Test Point",$=D.get(L.id)||"",Z=$.length;return n.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:A})]}),n.jsxs("div",{style:{padding:"8px"},children:[n.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:S.id&&n.jsxs("div",{children:["Node ID: ",S.id]})}),n.jsx("textarea",{value:$,onChange:Oe=>Y(L.id,Oe.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:En,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),n.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Z>=En?"#d32f2f":"#666",textAlign:"right"},children:[Z," / ",En]})]})]},L.id)}),I.filter(L=>u.has(L.id)&&L.type==="trace").map(L=>{const S=D.get(L.id)||"",A=S.length;return n.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:L.type||"unknown"})]}),n.jsxs("div",{style:{padding:"8px"},children:[n.jsx("textarea",{value:S,onChange:$=>Y(L.id,$.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:En,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),n.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:A>=En?"#d32f2f":"#666",textAlign:"right"},children:[A," / ",En]})]})]},L.id)}),p.filter(L=>d.has(L.id)).map(L=>{const S=ue.find(Oe=>Oe.id===L.powerBusId),A=L.type||(S?`${S.name} Power Node`:"Power Node"),$=D.get(L.id)||"",Z=$.length;return n.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:A})]}),n.jsxs("div",{style:{padding:"8px"},children:[n.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:n.jsxs("div",{children:["Node ID: ",L.pointId||"(not assigned)"]})}),n.jsx("textarea",{value:$,onChange:Oe=>Y(L.id,Oe.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:En,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),n.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Z>=En?"#d32f2f":"#666",textAlign:"right"},children:[Z," / ",En]})]})]},L.id)}),V.filter(L=>R.has(L.id)).map(L=>{const S=L.type||"Ground Node",A=D.get(L.id)||"",$=A.length;return n.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:S})]}),n.jsxs("div",{style:{padding:"8px"},children:[n.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:n.jsxs("div",{children:["Node ID: ",L.pointId||"(not assigned)"]})}),n.jsx("textarea",{value:A,onChange:Z=>Y(L.id,Z.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:En,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),n.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:$>=En?"#d32f2f":"#666",textAlign:"right"},children:[$," / ",En]})]})]},L.id)}),n.jsxs("div",{style:{marginTop:"20px",padding:"12px",display:"flex",justifyContent:"flex-end",gap:"8px",borderTop:"1px solid #ddd"},children:[n.jsx("button",{onClick:he,style:{padding:"8px 16px",fontSize:"12px",backgroundColor:"#757575",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500},onMouseEnter:L=>{L.currentTarget.style.backgroundColor="#616161"},onMouseLeave:L=>{L.currentTarget.style.backgroundColor="#757575"},children:"Close"}),n.jsx("button",{onClick:je,style:{padding:"8px 16px",fontSize:"12px",backgroundColor:"#2196F3",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500},onMouseEnter:L=>{L.currentTarget.style.backgroundColor="#1976D2"},onMouseLeave:L=>{L.currentTarget.style.backgroundColor="#2196F3"},children:"Save"})]})]})]})})]})},wx=({visible:c,projectNotes:u,setProjectNotes:g,onClose:d,position:R,isDragging:I,onDragStart:xe})=>{const[q,p]=b.useState([]),[V,ue]=b.useState(null),[he,Ce]=b.useState(null),Me=b.useRef(new Map),[se,Be]=b.useState({width:Math.min(window.innerWidth*.85,1400),height:window.innerHeight*.7}),[B,te]=b.useState(!1),[Le,J]=b.useState({x:0,y:0,width:0,height:0});b.useEffect(()=>{c&&(p([...u]),ue(null),Ce(null))},[c,u]),b.useEffect(()=>{if(!B)return;const re=O=>{const Y=O.clientX-Le.x,je=O.clientY-Le.y,L=Math.max(400,Math.min(window.innerWidth-20,Le.width+Y)),S=Math.max(300,Math.min(window.innerHeight-20,Le.height+je));Be({width:L,height:S})},_=()=>{te(!1)};return document.addEventListener("mousemove",re),document.addEventListener("mouseup",_),()=>{document.removeEventListener("mousemove",re),document.removeEventListener("mouseup",_)}},[B,Le]);const ne=re=>{re.preventDefault(),re.stopPropagation(),te(!0),J({x:re.clientX,y:re.clientY,width:se.width,height:se.height})};if(!c)return null;const M=()=>{const re={name:"",value:"",checked:!1};p([...q,re]),ue(q.length),Ce("name")},z=re=>{const _=q.filter((O,Y)=>Y!==re);p(_),V===re?(ue(null),Ce(null)):V!==null&&V>re&&ue(V-1)},D=()=>{const re=q.filter(_=>_.name.trim()!==""||_.value.trim()!=="");g(re),d()},P=()=>{p([...u]),ue(null),Ce(null),d()},E=(re,_,O)=>{const Y=[...q];Y[re]={...Y[re],[_]:O},p(Y)},pe=(re,_)=>{const O=[...q];O[re]={...O[re],checked:_},p(O)},W=(re,_,O)=>{re.stopPropagation();const Y=re.currentTarget,je=Y.selectionStart,L=Y.value.length,S=Y.selectionStart!==Y.selectionEnd;if(!(re.key==="Enter"&&re.altKey)){if(re.key==="ArrowRight"&&!re.ctrlKey&&!re.shiftKey&&!re.altKey){if(je===L&&!S&&O==="name"){re.preventDefault();const A=`${_}-value`,$=Me.current.get(A);$&&($.focus(),$.setSelectionRange(0,0))}return}if(re.key==="ArrowLeft"&&!re.ctrlKey&&!re.shiftKey&&!re.altKey){if(je===0&&!S&&O==="value"){re.preventDefault();const A=`${_}-name`,$=Me.current.get(A);$&&($.focus(),$.setSelectionRange($.value.length,$.value.length))}return}if(re.key==="ArrowDown"&&!re.ctrlKey&&!re.shiftKey&&!re.altKey){if(re.preventDefault(),_<q.length-1){const A=`${_+1}-${O}`,$=Me.current.get(A);if($){$.focus();const Z=Math.min(je,$.value.length);$.setSelectionRange(Z,Z)}}else{const A=q.length;M(),setTimeout(()=>{const $=`${A}-${O}`,Z=Me.current.get($);Z&&(Z.focus(),Z.setSelectionRange(0,0))},0)}return}if(re.key==="ArrowUp"&&!re.ctrlKey&&!re.shiftKey&&!re.altKey){if(re.preventDefault(),_>0){const A=`${_-1}-${O}`,$=Me.current.get(A);if($){$.focus();const Z=Math.min(je,$.value.length);$.setSelectionRange(Z,Z)}}return}if(re.key==="Enter"&&!re.altKey&&!re.shiftKey){if(re.preventDefault(),O==="name"){const A=`${_}-value`,$=Me.current.get(A);$&&($.focus(),$.setSelectionRange(0,0))}else if(O==="value")if(_<q.length-1){const A=`${_+1}-name`,$=Me.current.get(A);$&&($.focus(),$.setSelectionRange(0,0))}else{const A=q.length;M(),setTimeout(()=>{const $=`${A}-name`,Z=Me.current.get($);Z&&(Z.focus(),Z.setSelectionRange(0,0))},0)}return}if(re.key==="Tab"&&!re.shiftKey){if(re.preventDefault(),O==="name"){const A=`${_}-value`,$=Me.current.get(A);$&&($.focus(),$.select())}else if(O==="value")if(_<q.length-1){const A=`${_+1}-name`,$=Me.current.get(A);$&&($.focus(),$.select())}else{const A=q.length;M(),setTimeout(()=>{const $=`${A}-name`,Z=Me.current.get($);Z&&Z.focus()},0)}return}if(re.key==="Tab"&&re.shiftKey){if(re.preventDefault(),O==="value"){const A=`${_}-name`,$=Me.current.get(A);$&&($.focus(),$.select())}else if(O==="name"&&_>0){const A=`${_-1}-value`,$=Me.current.get(A);$&&($.focus(),$.select())}return}}},j=(re,_)=>{ue(re),Ce(_)},me=()=>{},be={position:"fixed",top:R?.y??100,left:R?.x??(window.innerWidth-se.width)/2,width:`${se.width}px`,height:`${se.height}px`,backgroundColor:"#fff",borderRadius:8,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:I?"grabbing":"default",overflow:"hidden"};return n.jsxs("div",{style:be,children:[n.jsxs("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e0e0",background:"#888",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"move",userSelect:"none"},onMouseDown:xe,children:[n.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Project Notes / TODO List (L)"}),n.jsx("button",{onClick:P,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:"0 4px",lineHeight:1},title:"Close",children:""})]}),n.jsxs("div",{className:"project-notes-content",style:{padding:0,flex:1,overflowY:"auto",overflowX:"hidden",display:"flex",flexDirection:"column",minHeight:0,scrollbarWidth:"thin",scrollbarColor:"#888 #f0f0f0"},children:[n.jsxs("div",{style:{border:"none",borderTop:"1px solid #ccc",borderRadius:0,overflow:"visible",marginBottom:"16px",backgroundColor:"#e0e0e0",flexShrink:0},children:[n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"40px 1fr 3fr auto",backgroundColor:"#e0e0e0",borderBottom:"1px solid #ccc",position:"sticky",top:0,zIndex:10},children:[n.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",display:"flex",alignItems:"center",justifyContent:"center",color:"#000"},children:n.jsx("label",{className:"radio-label",style:{margin:0,cursor:"default"},children:n.jsx("input",{type:"checkbox",disabled:!0,style:{opacity:.5}})})}),n.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",color:"#000"},children:"Item"}),n.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",color:"#000"},children:"Notes"}),n.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",color:"#000"}})]}),n.jsx("div",{children:q.length===0?n.jsx("div",{style:{padding:"24px",textAlign:"center",color:"#999",fontSize:"13px"},children:'No notes. Click "Add Note" to create one.'}):q.map((re,_)=>n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"40px 1fr 3fr auto",borderBottom:"1px solid #ccc",backgroundColor:"#fff"},children:[n.jsx("div",{style:{padding:"8px 12px",borderRight:"1px solid #ccc",display:"flex",alignItems:"center",justifyContent:"center"},children:n.jsx("label",{className:"radio-label",style:{margin:0,cursor:"pointer"},children:n.jsx("input",{type:"checkbox",checked:re.checked||!1,onChange:O=>pe(_,O.target.checked)})})}),n.jsx("div",{style:{padding:"4px",borderRight:"1px solid #ccc"},children:n.jsx("textarea",{ref:O=>{O?Me.current.set(`${_}-name`,O):Me.current.delete(`${_}-name`)},value:re.name,onChange:O=>E(_,"name",O.target.value),onFocus:()=>j(_,"name"),onBlur:me,onKeyDown:O=>W(O,_,"name"),placeholder:"Item name...",rows:1,style:{width:"100%",padding:"4px 6px",border:V===_&&he==="name"?"2px solid #0b5fff":"1px solid transparent",borderRadius:3,fontSize:"12px",backgroundColor:"#fff",color:"#000",fontFamily:"inherit",resize:"none",minHeight:"24px",lineHeight:"1.4",overflow:"hidden",outline:"none",boxSizing:"border-box"},onInput:O=>{const Y=O.target;Y.style.height="auto",Y.style.height=`${Y.scrollHeight}px`}})}),n.jsx("div",{style:{padding:"4px",borderRight:"1px solid #ccc"},children:n.jsx("textarea",{ref:O=>{O?Me.current.set(`${_}-value`,O):Me.current.delete(`${_}-value`)},value:re.value,onChange:O=>E(_,"value",O.target.value),onFocus:()=>j(_,"value"),onBlur:me,onKeyDown:O=>W(O,_,"value"),placeholder:"Notes...",rows:1,style:{width:"100%",padding:"4px 6px",border:V===_&&he==="value"?"2px solid #0b5fff":"1px solid transparent",borderRadius:3,fontSize:"12px",backgroundColor:"#fff",color:"#000",fontFamily:"inherit",resize:"none",minHeight:"24px",lineHeight:"1.4",overflow:"hidden",outline:"none",boxSizing:"border-box"},onInput:O=>{const Y=O.target;Y.style.height="auto",Y.style.height=`${Y.scrollHeight}px`}})}),n.jsx("div",{style:{padding:"8px 12px",display:"flex",alignItems:"center",justifyContent:"center"},children:n.jsx("button",{onClick:()=>z(_),style:{background:"#f44336",color:"#fff",border:"none",borderRadius:3,padding:"4px 8px",cursor:"pointer",fontSize:"11px"},title:"Delete note",children:"Delete"})})]},_))})]}),n.jsx("div",{style:{padding:"16px",flexShrink:0},children:n.jsx("button",{onClick:M,style:{background:"#888",color:"#fff",border:"none",borderRadius:4,padding:"8px 16px",cursor:"pointer",fontSize:"12px",fontWeight:500,alignSelf:"flex-start"},children:"+ Add Note"})})]}),n.jsxs("div",{style:{padding:"12px 16px",borderTop:"1px solid #ddd",display:"flex",justifyContent:"flex-end",gap:"8px",flexShrink:0},children:[n.jsx("button",{onClick:P,style:{background:"#f5f5f5",color:"#000",border:"1px solid #ddd",borderRadius:4,padding:"6px 16px",cursor:"pointer",fontSize:"12px"},children:"Cancel"}),n.jsx("button",{onClick:D,style:{background:"#0b5fff",color:"#fff",border:"none",borderRadius:4,padding:"6px 16px",cursor:"pointer",fontSize:"12px",fontWeight:500},children:"Save"})]}),n.jsx("div",{onMouseDown:ne,style:{position:"absolute",bottom:0,right:0,width:"20px",height:"20px",cursor:"nwse-resize",background:"linear-gradient(135deg, transparent 0%, transparent 40%, #ccc 40%, #ccc 45%, transparent 45%, transparent 55%, #ccc 55%, #ccc 60%, transparent 60%)",zIndex:10001},title:"Drag to resize"})]})},jx=({visible:c,dimensions:u,onSave:g,onClose:d})=>{const[R,I]=b.useState(""),[xe,q]=b.useState(""),[p,V]=b.useState("inches");b.useEffect(()=>{c&&u?(I(u.width.toString()),q(u.height.toString()),V(u.unit)):c&&(I(""),q(""),V("inches"))},[c,u]);const ue=()=>{const Ce=parseFloat(R),Me=parseFloat(xe);if(isNaN(Ce)||Ce<=0){alert("Please enter a valid width greater than 0");return}if(isNaN(Me)||Me<=0){alert("Please enter a valid height greater than 0");return}g({width:Ce,height:Me,unit:p}),d()},he=()=>{d()};return c?n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:Ce=>{Ce.target===Ce.currentTarget&&he()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"320px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #444"},onClick:Ce=>Ce.stopPropagation(),children:[n.jsx("h3",{style:{margin:"0 0 20px 0",color:"#fff",fontSize:"18px",fontWeight:600},children:"Board Dimensions"}),n.jsxs("div",{style:{marginBottom:"16px"},children:[n.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#ddd",fontSize:"14px"},children:"Width"}),n.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[n.jsx("input",{type:"number",step:"0.001",min:"0.001",value:R,onChange:Ce=>I(Ce.target.value),style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px"},placeholder:"0.000"}),n.jsxs("select",{value:p,onChange:Ce=>V(Ce.target.value),style:{padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px",cursor:"pointer"},children:[n.jsx("option",{value:"inches",children:"inches"}),n.jsx("option",{value:"mm",children:"mm"})]})]})]}),n.jsxs("div",{style:{marginBottom:"20px"},children:[n.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#ddd",fontSize:"14px"},children:"Height"}),n.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[n.jsx("input",{type:"number",step:"0.001",min:"0.001",value:xe,onChange:Ce=>q(Ce.target.value),style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px"},placeholder:"0.000"}),n.jsxs("select",{value:p,onChange:Ce=>V(Ce.target.value),style:{padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px",cursor:"pointer"},children:[n.jsx("option",{value:"inches",children:"inches"}),n.jsx("option",{value:"mm",children:"mm"})]})]})]}),n.jsx("div",{style:{marginBottom:"12px",padding:"10px",background:"#1f1f24",borderRadius:4,fontSize:"12px",color:"#bbb"},children:"This information will be used to convert pixel coordinates to real-world measurements."}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[n.jsx("button",{onClick:he,style:{padding:"8px 16px",background:"#444",color:"#fff",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px"},children:"Cancel"}),n.jsx("button",{onClick:ue,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Save"})]})]})}):null},Tx=({visible:c,onClose:u,topImage:g,bottomImage:d,selectedImageForTransform:R,setSelectedImageForTransform:I,transformMode:xe,setTransformMode:q,updateImageTransform:p,resetImageTransform:V,setCurrentTool:ue,isGrayscale:he,setIsGrayscale:Ce,areImagesLocked:Me})=>{const[se,Be]=b.useState(null),[B,te]=b.useState(!1),Le=b.useRef({x:0,y:0}),J=b.useRef(null);b.useEffect(()=>{c&&se===null&&Be({x:window.innerWidth-320-20,y:80})},[c,se]),b.useEffect(()=>{c||Be(null)},[c]);const ne=b.useCallback(Z=>{if(J.current){const Oe=J.current.getBoundingClientRect();Le.current={x:Z.clientX-Oe.left,y:Z.clientY-Oe.top},te(!0)}},[]);if(b.useEffect(()=>{if(!B)return;const Z=Ge=>{const Xe=Ge.clientX-Le.current.x,xt=Ge.clientY-Le.current.y,Pe=J.current?.offsetWidth||320,_n=J.current?.offsetHeight||600,Mn=Math.max(0,Math.min(Xe,window.innerWidth-Pe)),Vi=Math.max(0,Math.min(xt,window.innerHeight-_n));Be({x:Mn,y:Vi})},Oe=()=>{te(!1)};return document.addEventListener("mousemove",Z),document.addEventListener("mouseup",Oe),()=>{document.removeEventListener("mousemove",Z),document.removeEventListener("mouseup",Oe)}},[B]),!c)return null;const M=g!==null,z=d!==null,D=M||z,P=M&&z,E=R||(M?"top":z?"bottom":null),pe=()=>E==="top"&&g?g.brightness??100:E==="bottom"&&d?d.brightness??100:E==="both"&&g?g.brightness??100:100,W=()=>E==="top"&&g?g.contrast??100:E==="bottom"&&d?d.contrast??100:E==="both"&&g?g.contrast??100:100,j=pe(),me=W(),be=!D||Me,re=()=>{if(!(!E||be))if(E==="both"){const Z=!g?.flipX;p("both",{flipX:Z})}else{const Z=E==="top"?g?.flipX||!1:d?.flipX||!1;p(E,{flipX:!Z})}},_=()=>{if(!(!E||be))if(E==="both"){const Z=!g?.flipY;p("both",{flipY:Z})}else{const Z=E==="top"?g?.flipY||!1:d?.flipY||!1;p(E,{flipY:!Z})}},O=Z=>{be||(E&&I(E),q(Z),ue("transform"))},Y=Z=>{!E||be||p(E,{brightness:Z})},je=Z=>{!E||be||p(E,{contrast:Z})},L=()=>{be||(E&&I(E),ue("transform"),Ce(!he))},S=()=>{be||(ue("transform"),V())},A=(Z,Oe=!1)=>({display:"block",width:"100%",textAlign:"left",padding:"8px 12px",color:Z?"#666":"#f2f2f2",background:Oe?"#3a3a42":"transparent",border:"none",borderRadius:4,cursor:Z?"not-allowed":"pointer",fontSize:"13px",transition:"background 0.15s"}),$=(Z,Oe)=>({display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",color:Z?"#666":"#f2f2f2",cursor:Z?"not-allowed":"pointer",fontSize:"13px",background:Oe?"#3a3a42":"transparent",borderRadius:4,transition:"background 0.15s"});return n.jsxs("div",{ref:J,style:{position:"fixed",top:se?.y??80,left:se?.x??window.innerWidth-340,backgroundColor:"#2b2b31",borderRadius:8,minWidth:"320px",maxWidth:"400px",maxHeight:"calc(100vh - 100px)",overflowY:"auto",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24",zIndex:10001},children:[n.jsxs("div",{onMouseDown:ne,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 16px",background:"linear-gradient(to bottom, #3a3a42, #2b2b31)",borderTopLeftRadius:8,borderTopRightRadius:8,borderBottom:"1px solid #1f1f24",cursor:B?"grabbing":"grab",userSelect:"none"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[n.jsx("span",{style:{color:"#888",fontSize:"14px"},children:""}),n.jsx("h2",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#f2f2f2"},children:"Transform Images"})]}),n.jsx("button",{onClick:u,style:{background:"transparent",border:"none",color:"#888",fontSize:"16px",cursor:"pointer",padding:"2px 6px",lineHeight:1,borderRadius:4},onMouseEnter:Z=>{Z.currentTarget.style.background="#444",Z.currentTarget.style.color="#fff"},onMouseLeave:Z=>{Z.currentTarget.style.background="transparent",Z.currentTarget.style.color="#888"},children:""})]}),n.jsxs("div",{style:{padding:"16px"},children:[n.jsxs("div",{style:{marginBottom:"16px"},children:[n.jsx("div",{style:{fontSize:"12px",color:"#888",marginBottom:"8px",fontWeight:500},children:"Apply to:"}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[n.jsxs("label",{style:$(!M,E==="top"),children:[n.jsx("input",{type:"radio",name:"imageSelection",checked:E==="top",onChange:()=>I("top"),disabled:!M,style:{accentColor:"#6b9fff"}}),"Top Image",!M&&n.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(not loaded)"})]}),n.jsxs("label",{style:$(!z,E==="bottom"),children:[n.jsx("input",{type:"radio",name:"imageSelection",checked:E==="bottom",onChange:()=>I("bottom"),disabled:!z,style:{accentColor:"#6b9fff"}}),"Bottom Image",!z&&n.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(not loaded)"})]}),n.jsxs("label",{style:$(!P,E==="both"),children:[n.jsx("input",{type:"radio",name:"imageSelection",checked:E==="both",onChange:()=>I("both"),disabled:!P,style:{accentColor:"#6b9fff"}}),"Both Images",!P&&n.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(need both)"})]})]})]}),n.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),n.jsxs("div",{style:{marginBottom:"12px"},children:[n.jsx("button",{onClick:re,disabled:be,style:A(be),onMouseEnter:Z=>!be&&(Z.currentTarget.style.background="#3a3a42"),onMouseLeave:Z=>Z.currentTarget.style.background="transparent",children:"Horizontal Flip"}),n.jsx("button",{onClick:_,disabled:be,style:A(be),onMouseEnter:Z=>!be&&(Z.currentTarget.style.background="#3a3a42"),onMouseLeave:Z=>Z.currentTarget.style.background="transparent",children:"Vertical Flip"})]}),n.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),n.jsx("div",{style:{marginBottom:"12px"},children:["nudge","scale","rotate","slant","keystone"].map(Z=>n.jsxs("button",{onClick:()=>O(Z),disabled:be,style:A(be,xe===Z),onMouseEnter:Oe=>!be&&xe!==Z&&(Oe.currentTarget.style.background="#3a3a42"),onMouseLeave:Oe=>xe!==Z&&(Oe.currentTarget.style.background="transparent"),children:[xe===Z?" ":"","Mode: ",Z.charAt(0).toUpperCase()+Z.slice(1)]},Z))}),n.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),n.jsxs("div",{style:{marginBottom:"16px"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[n.jsx("label",{style:{color:"#f2f2f2",fontSize:"13px",fontWeight:500},children:"Brightness"}),n.jsxs("span",{style:{color:"#888",fontSize:"12px",minWidth:"45px",textAlign:"right"},children:[j,"%"]})]}),n.jsx("input",{type:"range",min:"0",max:"200",step:"1",value:j,onChange:Z=>Y(parseInt(Z.target.value,10)),disabled:be,style:{width:"100%",cursor:be?"not-allowed":"pointer",accentColor:"#6b9fff"}})]}),n.jsxs("div",{style:{marginBottom:"16px"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[n.jsx("label",{style:{color:"#f2f2f2",fontSize:"13px",fontWeight:500},children:"Contrast"}),n.jsxs("span",{style:{color:"#888",fontSize:"12px",minWidth:"45px",textAlign:"right"},children:[me,"%"]})]}),n.jsx("input",{type:"range",min:"0",max:"200",step:"1",value:me,onChange:Z=>je(parseInt(Z.target.value,10)),disabled:be,style:{width:"100%",cursor:be?"not-allowed":"pointer",accentColor:"#6b9fff"}})]}),n.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),n.jsx("div",{style:{marginBottom:"12px"},children:n.jsxs("button",{onClick:L,disabled:be,style:A(be,he),onMouseEnter:Z=>!be&&!he&&(Z.currentTarget.style.background="#3a3a42"),onMouseLeave:Z=>!he&&(Z.currentTarget.style.background="transparent"),children:[he?" ":"","Grayscale Mode"]})}),n.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[n.jsx("button",{onClick:S,disabled:be,style:{padding:"8px 16px",background:be?"#444":"#555",color:be?"#777":"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:be?"not-allowed":"pointer",fontSize:"13px",fontWeight:500},children:"Reset Transform"}),n.jsx("button",{onClick:u,style:{padding:"8px 16px",background:"#4a9eff",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:500},onMouseEnter:Z=>Z.currentTarget.style.background="#3a8ee6",onMouseLeave:Z=>Z.currentTarget.style.background="#4a9eff",children:"Close"})]}),Me&&n.jsx("div",{style:{marginTop:"12px",padding:"8px 12px",background:"#3d2b2b",border:"1px solid #5a3a3a",borderRadius:4,fontSize:"12px",color:"#e88"},children:" Images are locked. Unlock via Images  Lock Images to make changes."})]})]})},Cx=({visible:c,onClose:u,topImage:g,bottomImage:d,setTopImage:R,setBottomImage:I,componentsTop:xe,componentsBottom:q,setComponentsTop:p,setComponentsBottom:V,drawingStrokes:ue,setDrawingStrokes:he,canvasRef:Ce,isBottomView:Me,setIsBottomView:se,originalTopFlipX:Be,setOriginalTopFlipX:B,originalBottomFlipX:te,setOriginalBottomFlipX:Le,viewPan:J,viewScale:ne,contentBorder:M})=>{const[z,D]=b.useState(null),[P,E]=b.useState(!1),pe=b.useRef({x:0,y:0}),W=b.useRef(null);b.useEffect(()=>{c&&z===null&&D({x:window.innerWidth-320-20,y:80})},[c,z]),b.useEffect(()=>{c||D(null)},[c]);const j=b.useCallback(Y=>{if(W.current){const je=W.current.getBoundingClientRect();pe.current={x:Y.clientX-je.left,y:Y.clientY-je.top},E(!0)}},[]);b.useEffect(()=>{if(!P)return;const Y=L=>{const S=L.clientX-pe.current.x,A=L.clientY-pe.current.y,$=W.current?.offsetWidth||320,Z=W.current?.offsetHeight||400,Oe=Math.max(0,Math.min(S,window.innerWidth-$)),Ge=Math.max(0,Math.min(A,window.innerHeight-Z));D({x:Oe,y:Ge})},je=()=>{E(!1)};return document.addEventListener("mousemove",Y),document.addEventListener("mouseup",je),()=>{document.removeEventListener("mousemove",Y),document.removeEventListener("mouseup",je)}},[P]);const me=()=>{let Y=0,je=0,L=0;return g&&(Y+=g.x,je+=g.y,L++),d&&(Y+=d.x,je+=d.y,L++),L>0?{x:Y/L,y:je/L}:{x:0,y:0}},be=b.useCallback(()=>{if(Me)return;const je=me().x;g?(B(g.flipX||!1),R(L=>L?{...L,flipX:!L.flipX}:null)):B(null),d?(Le(d.flipX||!1),I(L=>L?{...L,flipX:!L.flipX}:null)):Le(null),p(L=>L.map(S=>({...S,x:je-(S.x-je),orientation:S.orientation?(360-S.orientation)%360:0}))),V(L=>L.map(S=>({...S,x:je-(S.x-je),orientation:S.orientation?(360-S.orientation)%360:0}))),he(L=>L.map(S=>({...S,points:S.points.map(A=>({...A,x:je-(A.x-je)}))}))),se(!0)},[Me,g,d,R,I,p,V,he,Ce,B,Le,J,ne,M]),re=b.useCallback(()=>{if(!Me)return;const je=me().x;g&&Be!==null&&R(L=>L?{...L,flipX:Be}:null),d&&te!==null&&I(L=>L?{...L,flipX:te}:null),p(L=>L.map(S=>({...S,x:je-(S.x-je),orientation:S.orientation?(360-S.orientation)%360:0}))),V(L=>L.map(S=>({...S,x:je-(S.x-je),orientation:S.orientation?(360-S.orientation)%360:0}))),he(L=>L.map(S=>({...S,points:S.points.map(A=>({...A,x:je-(A.x-je)}))}))),se(!1)},[Me,g,d,R,I,p,V,he,Ce,Be,te,J,ne,M]),_=b.useCallback(Y=>{const je=me(),L=je.x,S=je.y,A=Y*Math.PI/180,$=Math.cos(A),Z=Math.sin(A),Oe=(Ge,Xe)=>{const xt=Ge-L,Pe=Xe-S;return{x:L+xt*$-Pe*Z,y:S+xt*Z+Pe*$}};if(g){const Ge=Oe(g.x,g.y),Xe=((g.rotation||0)+Y)%360;R(xt=>xt?{...xt,x:Ge.x,y:Ge.y,rotation:Xe}:null)}if(d){const Ge=Oe(d.x,d.y),Xe=((d.rotation||0)+Y)%360;I(xt=>xt?{...xt,x:Ge.x,y:Ge.y,rotation:Xe}:null)}p(Ge=>Ge.map(Xe=>{const xt=Oe(Xe.x,Xe.y),Pe=Xe.orientation?(Xe.orientation+Y)%360:Y;return{...Xe,x:xt.x,y:xt.y,orientation:Pe}})),V(Ge=>Ge.map(Xe=>{const xt=Oe(Xe.x,Xe.y),Pe=Xe.orientation?(Xe.orientation+Y)%360:Y;return{...Xe,x:xt.x,y:xt.y,orientation:Pe}})),he(Ge=>Ge.map(Xe=>({...Xe,points:Xe.points.map(xt=>{const Pe=Oe(xt.x,xt.y);return{...xt,x:Pe.x,y:Pe.y}})})))},[g,d,R,I,p,V,he,Ce,J,ne,M]);if(!c)return null;const O=(Y=!1)=>({display:"block",width:"100%",textAlign:"left",padding:"8px 12px",color:Y?"#666":"#f2f2f2",background:"transparent",border:"none",borderRadius:4,cursor:Y?"not-allowed":"pointer",fontSize:"13px",transition:"background 0.15s"});return n.jsxs("div",{ref:W,style:{position:"fixed",top:z?.y??80,left:z?.x??window.innerWidth-340,backgroundColor:"#2b2b31",borderRadius:8,minWidth:"320px",maxWidth:"400px",maxHeight:"calc(100vh - 100px)",overflowY:"auto",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24",zIndex:10001},children:[n.jsxs("div",{onMouseDown:j,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 16px",background:"linear-gradient(to bottom, #3a3a42, #2b2b31)",borderTopLeftRadius:8,borderTopRightRadius:8,borderBottom:"1px solid #1f1f24",cursor:P?"grabbing":"grab",userSelect:"none"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[n.jsx("span",{style:{color:"#888",fontSize:"14px"},children:""}),n.jsx("h2",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#f2f2f2"},children:"Change Perspective"})]}),n.jsx("button",{onClick:u,style:{background:"transparent",border:"none",color:"#888",fontSize:"16px",cursor:"pointer",padding:"2px 6px",lineHeight:1,borderRadius:4},onMouseEnter:Y=>{Y.currentTarget.style.background="#444",Y.currentTarget.style.color="#fff"},onMouseLeave:Y=>{Y.currentTarget.style.background="transparent",Y.currentTarget.style.color="#888"},children:""})]}),n.jsxs("div",{style:{padding:"16px"},children:[n.jsxs("div",{style:{marginBottom:"16px"},children:[n.jsx("div",{style:{fontSize:"12px",color:"#888",marginBottom:"8px",fontWeight:500},children:"View:"}),n.jsxs("button",{onClick:re,disabled:!Me,style:O(!Me),onMouseEnter:Y=>!Me&&(Y.currentTarget.style.background="#3a3a42"),onMouseLeave:Y=>!Me&&(Y.currentTarget.style.background="transparent"),children:[Me?"":" ","Switch to Top View"]}),n.jsxs("button",{onClick:be,disabled:Me,style:O(Me),onMouseEnter:Y=>Me&&(Y.currentTarget.style.background="#3a3a42"),onMouseLeave:Y=>Me&&(Y.currentTarget.style.background="transparent"),children:[Me?" ":"","Switch to Bottom View"]})]}),n.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),n.jsxs("div",{style:{marginBottom:"16px"},children:[n.jsx("div",{style:{fontSize:"12px",color:"#888",marginBottom:"8px",fontWeight:500},children:"Rotate (clockwise):"}),n.jsx("button",{onClick:()=>_(90),style:O(),onMouseEnter:Y=>Y.currentTarget.style.background="#3a3a42",onMouseLeave:Y=>Y.currentTarget.style.background="transparent",children:"Rotate 90"}),n.jsx("button",{onClick:()=>_(180),style:O(),onMouseEnter:Y=>Y.currentTarget.style.background="#3a3a42",onMouseLeave:Y=>Y.currentTarget.style.background="transparent",children:"Rotate 180"}),n.jsx("button",{onClick:()=>_(270),style:O(),onMouseEnter:Y=>Y.currentTarget.style.background="#3a3a42",onMouseLeave:Y=>Y.currentTarget.style.background="transparent",children:"Rotate 270"})]}),n.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:n.jsx("button",{onClick:u,style:{padding:"8px 16px",background:"#4a9eff",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:500},onMouseEnter:Y=>Y.currentTarget.style.background="#3a8ee6",onMouseLeave:Y=>Y.currentTarget.style.background="#4a9eff",children:"Close"})})]})]})},zx=({component:c,componentEditor:u,setComponentEditor:g,areComponentsLocked:d,componentsTop:R,componentsBottom:I,setComponentsTop:xe,setComponentsBottom:q})=>n.jsxs(n.Fragment,{children:[c.componentType==="Resistor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-resistance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),n.jsx("input",{id:`component-resistance-${c.id}`,type:"text",value:u.resistance||"",onChange:p=>g({...u,resistance:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 10"}),n.jsx("select",{value:u.resistanceUnit||Ze("resistance"),onChange:p=>g({...u,resistanceUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("resistance").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-power-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),n.jsxs("select",{id:`component-power-${c.id}`,value:u.power||"1/4",onChange:p=>g({...u,power:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"12px"},children:[n.jsx("option",{value:"1/20",children:"1/20 W"}),n.jsx("option",{value:"1/16",children:"1/16 W"}),n.jsx("option",{value:"1/10",children:"1/10 W"}),n.jsx("option",{value:"1/8",children:"1/8 W"}),n.jsx("option",{value:"1/4",children:"1/4 W"}),n.jsx("option",{value:"1/2",children:"1/2 W"}),n.jsx("option",{value:"1",children:"1 W"}),n.jsx("option",{value:"2",children:"2 W"}),n.jsx("option",{value:"3",children:"3 W"}),n.jsx("option",{value:"5",children:"5 W"}),n.jsx("option",{value:"10",children:"10 W"}),n.jsx("option",{value:"25",children:"25 W"}),n.jsx("option",{value:"50",children:"50 W"}),n.jsx("option",{value:"100",children:"100 W"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-tolerance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),n.jsxs("select",{id:`component-tolerance-${c.id}`,value:u.tolerance||"5%",onChange:p=>g({...u,tolerance:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"0.05%",children:"0.05%"}),n.jsx("option",{value:"0.1%",children:"0.1%"}),n.jsx("option",{value:"0.25%",children:"0.25%"}),n.jsx("option",{value:"0.5%",children:"0.5%"}),n.jsx("option",{value:"1%",children:"1%"}),n.jsx("option",{value:"2%",children:"2%"}),n.jsx("option",{value:"5%",children:"5%"}),n.jsx("option",{value:"10%",children:"10%"}),n.jsx("option",{value:"20%",children:"20%"})]})]})]}),c.componentType==="Capacitor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-capacitance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),n.jsx("input",{id:`component-capacitance-${c.id}`,type:"text",value:u.capacitance||"",onChange:p=>g({...u,capacitance:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 100"}),n.jsx("select",{value:u.capacitanceUnit||Ze("capacitance"),onChange:p=>g({...u,capacitanceUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("capacitance").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:p=>g({...u,voltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 50"}),n.jsx("select",{value:u.voltageUnit||Ze("voltage"),onChange:p=>g({...u,voltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-dielectric-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Dielectric:"}),n.jsxs("select",{id:`component-dielectric-${c.id}`,value:u.dielectric||"Ceramic",onChange:p=>g({...u,dielectric:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Ceramic",children:"Ceramic"}),n.jsx("option",{value:"Tantalum",children:"Tantalum"}),n.jsx("option",{value:"Film",children:"Film"}),n.jsx("option",{value:"Polyester",children:"Polyester"}),n.jsx("option",{value:"Polypropylene",children:"Polypropylene"}),n.jsx("option",{value:"Mica",children:"Mica"}),n.jsx("option",{value:"Paper",children:"Paper"}),n.jsx("option",{value:"Glass",children:"Glass"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-tolerance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),n.jsxs("select",{id:`component-tolerance-${c.id}`,value:u.tolerance||"10%",onChange:p=>g({...u,tolerance:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"0.5%",children:"0.5%"}),n.jsx("option",{value:"1%",children:"1%"}),n.jsx("option",{value:"2%",children:"2%"}),n.jsx("option",{value:"5%",children:"5%"}),n.jsx("option",{value:"10%",children:"10%"}),n.jsx("option",{value:"20%",children:"20%"})]})]})]}),c.componentType==="Film Capacitor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-capacitance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),n.jsx("input",{id:`component-capacitance-${c.id}`,type:"text",value:u.capacitance||"",onChange:p=>g({...u,capacitance:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 100"}),n.jsx("select",{value:u.capacitanceUnit||Ze("capacitance"),onChange:p=>g({...u,capacitanceUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("capacitance").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:p=>g({...u,voltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 50"}),n.jsx("select",{value:u.voltageUnit||Ze("voltage"),onChange:p=>g({...u,voltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-filmtype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Film Type:"}),n.jsxs("select",{id:`component-filmtype-${c.id}`,value:u.filmType||"Polyester",onChange:p=>g({...u,filmType:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Polyester",children:"Polyester"}),n.jsx("option",{value:"Polypropylene",children:"Polypropylene"}),n.jsx("option",{value:"Polyethylene",children:"Polyethylene"}),n.jsx("option",{value:"Polystyrene",children:"Polystyrene"}),n.jsx("option",{value:"Polycarbonate",children:"Polycarbonate"}),n.jsx("option",{value:"PTFE",children:"PTFE (Teflon)"}),n.jsx("option",{value:"PPS",children:"PPS (Polyphenylene Sulfide)"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-tolerance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),n.jsxs("select",{id:`component-tolerance-${c.id}`,value:u.tolerance||"10%",onChange:p=>g({...u,tolerance:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"0.5%",children:"0.5%"}),n.jsx("option",{value:"1%",children:"1%"}),n.jsx("option",{value:"2%",children:"2%"}),n.jsx("option",{value:"5%",children:"5%"}),n.jsx("option",{value:"10%",children:"10%"}),n.jsx("option",{value:"20%",children:"20%"})]})]})]}),c.componentType==="Electrolytic Capacitor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-capacitance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),n.jsx("input",{id:`component-capacitance-${c.id}`,type:"text",value:u.capacitance||"",onChange:p=>g({...u,capacitance:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 100"}),n.jsxs("select",{value:u.capacitanceUnit||"F",onChange:p=>g({...u,capacitanceUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:[n.jsx("option",{value:"pF",children:"pF"}),n.jsx("option",{value:"nF",children:"nF"}),n.jsx("option",{value:"F",children:"F"}),n.jsx("option",{value:"mF",children:"mF"}),n.jsx("option",{value:"F",children:"F"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:p=>g({...u,voltage:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 25"}),n.jsx("select",{value:u.voltageUnit||Ze("voltage"),onChange:p=>g({...u,voltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-tolerance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),n.jsxs("select",{id:`component-tolerance-${c.id}`,value:u.tolerance||"20%",onChange:p=>g({...u,tolerance:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},children:[n.jsx("option",{value:"0.5%",children:"0.5%"}),n.jsx("option",{value:"1%",children:"1%"}),n.jsx("option",{value:"2%",children:"2%"}),n.jsx("option",{value:"5%",children:"5%"}),n.jsx("option",{value:"10%",children:"10%"}),n.jsx("option",{value:"20%",children:"20%"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-polarity-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Polarity:"}),n.jsxs("select",{id:`component-polarity-${c.id}`,value:u.polarityCapacitor||c.polarity||"Positive",onChange:p=>g({...u,polarityCapacitor:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Positive",children:"Positive"}),n.jsx("option",{value:"Negative",children:"Negative"})]})]})]}),c.componentType==="Inductor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-inductance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Inductance:"}),n.jsx("input",{id:`component-inductance-${c.id}`,type:"text",value:u.inductance||"",onChange:p=>g({...u,inductance:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 10"}),n.jsx("select",{value:u.inductanceUnit||Ze("inductance"),onChange:p=>g({...u,inductanceUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("inductance").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:p=>g({...u,current:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 1"}),n.jsx("select",{value:u.currentUnit||Ze("current"),onChange:p=>g({...u,currentUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("current").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-resistance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"DC Resistance:"}),n.jsx("input",{id:`component-resistance-${c.id}`,type:"text",value:u.resistance||"",onChange:p=>g({...u,resistance:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 50"}),n.jsx("select",{value:u.resistanceUnit||"",onChange:p=>g({...u,resistanceUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("resistance").map(p=>n.jsx("option",{value:p,children:p},p))})]})]}),c.componentType==="Diode"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-diodetype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Diode Type:"}),n.jsxs("select",{id:`component-diodetype-${c.id}`,value:u.diodeType||"Standard",onChange:p=>g({...u,diodeType:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Standard",children:"Standard"}),n.jsx("option",{value:"Zener",children:"Zener"}),n.jsx("option",{value:"LED",children:"LED"}),n.jsx("option",{value:"Schottky",children:"Schottky"}),n.jsx("option",{value:"Other",children:"Other"})]})]}),u.diodeType==="LED"&&n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-ledcolor-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"LED Color:"}),n.jsxs("select",{id:`component-ledcolor-${c.id}`,value:u.ledColor||"",onChange:p=>g({...u,ledColor:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"",children:"Select..."}),n.jsx("option",{value:"Red",children:"Red"}),n.jsx("option",{value:"Green",children:"Green"}),n.jsx("option",{value:"Blue",children:"Blue"}),n.jsx("option",{value:"Yellow",children:"Yellow"}),n.jsx("option",{value:"Orange",children:"Orange"}),n.jsx("option",{value:"White",children:"White"}),n.jsx("option",{value:"RGB",children:"RGB"}),n.jsx("option",{value:"IR",children:"IR (Infrared)"}),n.jsx("option",{value:"UV",children:"UV (Ultraviolet)"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:p=>g({...u,voltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 50"}),n.jsx("select",{value:u.voltageUnit||Ze("voltage"),onChange:p=>g({...u,voltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:p=>g({...u,current:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 1"}),n.jsx("select",{value:u.currentUnit||Ze("current"),onChange:p=>g({...u,currentUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("current").map(p=>n.jsx("option",{value:p,children:p},p))})]})]}),c.componentType==="Battery"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:p=>g({...u,voltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 3.7"}),n.jsx("select",{value:u.voltageUnit||"V",onChange:p=>g({...u,voltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-capacity-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacity:"}),n.jsx("input",{id:`component-capacity-${c.id}`,type:"text",value:u.capacity||"",onChange:p=>g({...u,capacity:p.target.value}),disabled:d,style:{width:"120px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 2000mAh"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-chemistry-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Chemistry:"}),n.jsxs("select",{id:`component-chemistry-${c.id}`,value:u.chemistry||"Li-ion",onChange:p=>g({...u,chemistry:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Li-ion",children:"Li-ion"}),n.jsx("option",{value:"LiPo",children:"LiPo"}),n.jsx("option",{value:"NiMH",children:"NiMH"}),n.jsx("option",{value:"NiCd",children:"NiCd"}),n.jsx("option",{value:"Alkaline",children:"Alkaline"}),n.jsx("option",{value:"Lead-Acid",children:"Lead-Acid"}),n.jsx("option",{value:"Lithium",children:"Lithium"}),n.jsx("option",{value:"Zinc-Carbon",children:"Zinc-Carbon"})]})]})]}),c.componentType==="Fuse"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:p=>g({...u,current:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 5"}),n.jsx("select",{value:u.currentUnit||"A",onChange:p=>g({...u,currentUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("current").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:p=>g({...u,voltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 250"}),n.jsx("select",{value:u.voltageUnit||"V",onChange:p=>g({...u,voltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-fusetype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Fuse Type:"}),n.jsxs("select",{id:`component-fusetype-${c.id}`,value:u.fuseType||"Fast-blow",onChange:p=>g({...u,fuseType:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Fast-blow",children:"Fast-blow"}),n.jsx("option",{value:"Slow-blow",children:"Slow-blow"}),n.jsx("option",{value:"Time-delay",children:"Time-delay"}),n.jsx("option",{value:"Resettable",children:"Resettable"}),n.jsx("option",{value:"Cartridge",children:"Cartridge"}),n.jsx("option",{value:"Glass",children:"Glass"}),n.jsx("option",{value:"Ceramic",children:"Ceramic"})]})]})]}),c.componentType==="Relay"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-coilvoltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Coil Voltage:"}),n.jsx("input",{id:`component-coilvoltage-${c.id}`,type:"text",value:u.coilVoltage||"",onChange:p=>g({...u,coilVoltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 12"}),n.jsx("select",{value:u.coilVoltageUnit||Ze("voltage"),onChange:p=>g({...u,coilVoltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-contacttype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Contact Type:"}),n.jsxs("select",{id:`component-contacttype-${c.id}`,value:u.contactType||"SPST",onChange:p=>g({...u,contactType:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"SPST",children:"SPST (Single Pole Single Throw)"}),n.jsx("option",{value:"SPDT",children:"SPDT (Single Pole Double Throw)"}),n.jsx("option",{value:"DPST",children:"DPST (Double Pole Single Throw)"}),n.jsx("option",{value:"DPDT",children:"DPDT (Double Pole Double Throw)"}),n.jsx("option",{value:"3PDT",children:"3PDT (3 Pole Double Throw)"}),n.jsx("option",{value:"4PDT",children:"4PDT (4 Pole Double Throw)"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:p=>g({...u,current:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 10"}),n.jsx("select",{value:u.currentUnit||Ze("current"),onChange:p=>g({...u,currentUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("current").map(p=>n.jsx("option",{value:p,children:p},p))})]})]}),c.componentType==="Motor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-motortype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Motor Type:"}),n.jsxs("select",{id:`component-motortype-${c.id}`,value:u.motorType||"DC",onChange:p=>g({...u,motorType:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"DC",children:"DC Motor"}),n.jsx("option",{value:"Stepper",children:"Stepper Motor"}),n.jsx("option",{value:"Servo",children:"Servo Motor"}),n.jsx("option",{value:"Brushless",children:"Brushless DC"}),n.jsx("option",{value:"AC",children:"AC Motor"}),n.jsx("option",{value:"Synchronous",children:"Synchronous"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:p=>g({...u,voltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 12"}),n.jsx("select",{value:u.voltageUnit||Ze("voltage"),onChange:p=>g({...u,voltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:p=>g({...u,current:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 1"}),n.jsx("select",{value:u.currentUnit||Ze("current"),onChange:p=>g({...u,currentUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("current").map(p=>n.jsx("option",{value:p,children:p},p))})]})]}),c.componentType==="Switch"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-switchtype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Switch Type:"}),n.jsxs("select",{id:`component-switchtype-${c.id}`,value:u.switchType||"Toggle",onChange:p=>g({...u,switchType:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Toggle",children:"Toggle"}),n.jsx("option",{value:"Push-button",children:"Push-button"}),n.jsx("option",{value:"Slide",children:"Slide"}),n.jsx("option",{value:"Rotary",children:"Rotary"}),n.jsx("option",{value:"DIP",children:"DIP Switch"}),n.jsx("option",{value:"Momentary",children:"Momentary"}),n.jsx("option",{value:"Latching",children:"Latching"}),n.jsx("option",{value:"Reed",children:"Reed Switch"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:p=>g({...u,current:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 5"}),n.jsx("select",{value:u.currentUnit||Ze("current"),onChange:p=>g({...u,currentUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("current").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:p=>g({...u,voltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 250"}),n.jsx("select",{value:u.voltageUnit||Ze("voltage"),onChange:p=>g({...u,voltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]})]}),c.componentType==="FerriteBead"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-impedance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Impedance:"}),n.jsx("input",{id:`component-impedance-${c.id}`,type:"text",value:u.impedance||"",onChange:p=>g({...u,impedance:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 100"}),n.jsx("select",{value:u.impedanceUnit||Ze("impedance"),onChange:p=>g({...u,impedanceUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("impedance").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:p=>g({...u,current:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 1"}),n.jsx("select",{value:u.currentUnit||Ze("current"),onChange:p=>g({...u,currentUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("current").map(p=>n.jsx("option",{value:p,children:p},p))})]})]}),c.componentType==="Connector"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-connectortype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Connector Type:"}),n.jsx("input",{id:`component-connectortype-${c.id}`,type:"text",value:u.connectorType||"",onChange:p=>g({...u,connectorType:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},placeholder:"e.g., USB-A, HDMI"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-gender-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Gender:"}),n.jsxs("select",{id:`component-gender-${c.id}`,value:u.gender||"N/A",onChange:p=>g({...u,gender:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Male",children:"Male"}),n.jsx("option",{value:"Female",children:"Female"}),n.jsx("option",{value:"N/A",children:"N/A"})]})]})]}),c.componentType==="Jumper"&&n.jsx(n.Fragment,{children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-positions-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Positions:"}),n.jsx("input",{id:`component-positions-${c.id}`,type:"number",min:"2",value:u.positions||3,onChange:p=>g({...u,positions:parseInt(p.target.value)||3}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"}})]})}),c.componentType==="Speaker"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-impedance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Impedance:"}),n.jsx("input",{id:`component-impedance-${c.id}`,type:"text",value:u.impedance||"",onChange:p=>g({...u,impedance:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 8"}),n.jsx("select",{value:u.impedanceUnit||Ze("impedance"),onChange:p=>g({...u,impedanceUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("impedance").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-power-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),n.jsxs("select",{id:`component-power-${c.id}`,value:u.power||"1/4",onChange:p=>g({...u,power:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"12px"},children:[n.jsx("option",{value:"1/20",children:"1/20 W"}),n.jsx("option",{value:"1/16",children:"1/16 W"}),n.jsx("option",{value:"1/10",children:"1/10 W"}),n.jsx("option",{value:"1/8",children:"1/8 W"}),n.jsx("option",{value:"1/4",children:"1/4 W"}),n.jsx("option",{value:"1/2",children:"1/2 W"}),n.jsx("option",{value:"1",children:"1 W"}),n.jsx("option",{value:"2",children:"2 W"}),n.jsx("option",{value:"3",children:"3 W"}),n.jsx("option",{value:"5",children:"5 W"}),n.jsx("option",{value:"10",children:"10 W"}),n.jsx("option",{value:"25",children:"25 W"}),n.jsx("option",{value:"50",children:"50 W"}),n.jsx("option",{value:"100",children:"100 W"})]})]})]}),c.componentType==="PowerSupply"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-inputvoltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Input Voltage:"}),n.jsx("input",{id:`component-inputvoltage-${c.id}`,type:"text",value:u.inputVoltage||"",onChange:p=>g({...u,inputVoltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 120"}),n.jsx("select",{value:u.inputVoltageUnit||Ze("voltage"),onChange:p=>g({...u,inputVoltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-outputvoltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Output Voltage:"}),n.jsx("input",{id:`component-outputvoltage-${c.id}`,type:"text",value:u.outputVoltage||"",onChange:p=>g({...u,outputVoltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 12"}),n.jsx("select",{value:u.outputVoltageUnit||Ze("voltage"),onChange:p=>g({...u,outputVoltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:p=>g({...u,current:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 1"}),n.jsx("select",{value:u.currentUnit||Ze("current"),onChange:p=>g({...u,currentUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("current").map(p=>n.jsx("option",{value:p,children:p},p))})]})]}),c.componentType==="Transistor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-transistortype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Transistor Type:"}),n.jsxs("select",{id:`component-transistortype-${c.id}`,value:u.transistorType||"BJT",onChange:p=>g({...u,transistorType:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"BJT",children:"BJT (Bipolar Junction Transistor)"}),n.jsx("option",{value:"FET",children:"FET (Field Effect Transistor)"}),n.jsx("option",{value:"MOSFET",children:"MOSFET"}),n.jsx("option",{value:"IGBT",children:"IGBT"}),n.jsx("option",{value:"JFET",children:"JFET"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-polarity-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Polarity:"}),n.jsxs("select",{id:`component-polarity-${c.id}`,value:u.polarity||"NPN",onChange:p=>g({...u,polarity:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"NPN",children:"NPN"}),n.jsx("option",{value:"PNP",children:"PNP"}),n.jsx("option",{value:"N-Channel",children:"N-Channel"}),n.jsx("option",{value:"P-Channel",children:"P-Channel"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:p=>g({...u,voltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 50"}),n.jsx("select",{value:u.voltageUnit||Ze("voltage"),onChange:p=>g({...u,voltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:p=>g({...u,current:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 1"}),n.jsx("select",{value:u.currentUnit||Ze("current"),onChange:p=>g({...u,currentUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("current").map(p=>n.jsx("option",{value:p,children:p},p))})]})]}),c.componentType==="ResistorNetwork"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-resistance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),n.jsx("input",{id:`component-resistance-${c.id}`,type:"text",value:u.resistance||"",onChange:p=>g({...u,resistance:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 10"}),n.jsx("select",{value:u.resistanceUnit||Ze("resistance"),onChange:p=>g({...u,resistanceUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("resistance").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-configuration-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Configuration:"}),n.jsx("input",{id:`component-configuration-${c.id}`,type:"text",value:u.configuration||"",onChange:p=>g({...u,configuration:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},placeholder:"e.g., Isolated, Bussed"})]})]}),c.componentType==="Thermistor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-resistance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),n.jsx("input",{id:`component-resistance-${c.id}`,type:"text",value:u.resistance||"",onChange:p=>g({...u,resistance:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 10"}),n.jsx("select",{value:u.resistanceUnit||Ze("resistance"),onChange:p=>g({...u,resistanceUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("resistance").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-thermistortype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Thermistor Type:"}),n.jsxs("select",{id:`component-thermistortype-${c.id}`,value:u.thermistorType||"NTC",onChange:p=>g({...u,thermistorType:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"NTC",children:"NTC (Negative Temperature Coefficient)"}),n.jsx("option",{value:"PTC",children:"PTC (Positive Temperature Coefficient)"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-beta-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Beta ():"}),n.jsx("input",{id:`component-beta-${c.id}`,type:"text",value:u.beta||"",onChange:p=>g({...u,beta:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},placeholder:"e.g., 3950"})]})]}),c.componentType==="Transformer"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-primaryvoltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Primary Voltage:"}),n.jsx("input",{id:`component-primaryvoltage-${c.id}`,type:"text",value:u.primaryVoltage||"",onChange:p=>g({...u,primaryVoltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 120"}),n.jsx("select",{value:u.primaryVoltageUnit||Ze("voltage"),onChange:p=>g({...u,primaryVoltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-secondaryvoltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Secondary Voltage:"}),n.jsx("input",{id:`component-secondaryvoltage-${c.id}`,type:"text",value:u.secondaryVoltage||"",onChange:p=>g({...u,secondaryVoltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 12"}),n.jsx("select",{value:u.secondaryVoltageUnit||Ze("voltage"),onChange:p=>g({...u,secondaryVoltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-power-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),n.jsxs("select",{id:`component-power-${c.id}`,value:u.power||"1/4",onChange:p=>g({...u,power:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"12px"},children:[n.jsx("option",{value:"1/20",children:"1/20 W"}),n.jsx("option",{value:"1/16",children:"1/16 W"}),n.jsx("option",{value:"1/10",children:"1/10 W"}),n.jsx("option",{value:"1/8",children:"1/8 W"}),n.jsx("option",{value:"1/4",children:"1/4 W"}),n.jsx("option",{value:"1/2",children:"1/2 W"}),n.jsx("option",{value:"1",children:"1 W"}),n.jsx("option",{value:"2",children:"2 W"}),n.jsx("option",{value:"3",children:"3 W"}),n.jsx("option",{value:"5",children:"5 W"}),n.jsx("option",{value:"10",children:"10 W"}),n.jsx("option",{value:"25",children:"25 W"}),n.jsx("option",{value:"50",children:"50 W"}),n.jsx("option",{value:"100",children:"100 W"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-turns-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Turns Ratio:"}),n.jsx("input",{id:`component-turns-${c.id}`,type:"text",value:u.turns||"",onChange:p=>g({...u,turns:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},placeholder:"e.g., 10:1"})]})]}),c.componentType==="TestPoint"&&n.jsx(n.Fragment,{children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-signal-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Signal:"}),n.jsx("input",{id:`component-signal-${c.id}`,type:"text",value:u.signal||"",onChange:p=>g({...u,signal:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},placeholder:"e.g., VCC, GND, CLK"})]})}),c.componentType==="IntegratedCircuit"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid #e0e0e0",fontSize:"9px",fontWeight:600,color:"#000"},children:"IC Properties:"}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-ictype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"IC Type:"}),n.jsxs("select",{id:`component-ictype-${c.id}`,value:u.icType||"Op-Amp",onChange:p=>g({...u,icType:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Op-Amp",children:"Op-Amp"}),n.jsx("option",{value:"Microcontroller",children:"Microcontroller"}),n.jsx("option",{value:"Microprocessor",children:"Microprocessor"}),n.jsx("option",{value:"Logic",children:"Logic"}),n.jsx("option",{value:"Memory",children:"Memory"}),n.jsx("option",{value:"Voltage Regulator",children:"Voltage Regulator"}),n.jsx("option",{value:"Timer",children:"Timer"}),n.jsx("option",{value:"ADC",children:"ADC (Analog-to-Digital)"}),n.jsx("option",{value:"DAC",children:"DAC (Digital-to-Analog)"}),n.jsx("option",{value:"Comparator",children:"Comparator"}),n.jsx("option",{value:"Transceiver",children:"Transceiver"}),n.jsx("option",{value:"Driver",children:"Driver"}),n.jsx("option",{value:"Amplifier",children:"Amplifier"}),n.jsx("option",{value:"Other",children:"Other"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-datasheet-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Datasheet:"}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",flex:1},children:[n.jsx("input",{id:`component-datasheet-${c.id}`,type:"text",value:u.datasheet||"",onChange:p=>g({...u,datasheet:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"URL"}),u.datasheet&&u.datasheet.trim()&&n.jsx("button",{onClick:p=>{p.preventDefault(),p.stopPropagation();const V=u.datasheet.trim(),ue=V.match(/^https?:\/\//)?V:`https://${V}`;window.open(ue,"_blank","noopener,noreferrer")},style:{background:"transparent",border:"none",cursor:"pointer",padding:"2px",display:"flex",alignItems:"center",justifyContent:"center",opacity:d?.4:1,flexShrink:0},title:"Open URL in new tab",disabled:d,children:n.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{color:"#4a9eff"},children:[n.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),n.jsx("polyline",{points:"15 3 21 3 21 9"}),n.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-pincount-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Pin Count:"}),n.jsx("input",{id:`component-pincount-${c.id}`,name:`component-pincount-${c.id}`,type:"number",min:"1",value:u.pinCount,onChange:p=>{const V=Math.max(1,parseInt(p.target.value)||1);g({...u,pinCount:V})},onBlur:p=>{if(d){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const V=Math.max(1,parseInt(p.target.value)||1),he=(u.layer==="top"?R:I).find(Ce=>Ce.id===u.id);if(he&&V!==he.pinCount){const Ce=he.pinConnections||[],Me=new Array(V).fill("").map((te,Le)=>Le<Ce.length?Ce[Le]:""),se=he.pinPolarities||[],Be=he.pinPolarities?new Array(V).fill("").map((te,Le)=>Le<se.length?se[Le]:""):void 0,B={...he,pinCount:V,pinConnections:Me,...Be!==void 0&&{pinPolarities:Be}};u.layer==="top"?xe(te=>te.map(Le=>Le.id===u.id?B:Le)):q(te=>te.map(Le=>Le.id===u.id?B:Le)),g({...u,pinCount:V})}},disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"}})]})]}),c.componentType==="VacuumTube"&&n.jsx(n.Fragment,{children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-tubetype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tube Type:"}),n.jsx("input",{id:`component-tubetype-${c.id}`,type:"text",value:u.tubeType||"",onChange:p=>g({...u,tubeType:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},placeholder:"e.g., 12AX7, 6L6"})]})}),c.componentType==="VariableResistor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-vrtype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"VR Type:"}),n.jsxs("select",{id:`component-vrtype-${c.id}`,value:u.vrType||"Potentiometer",onChange:p=>g({...u,vrType:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Potentiometer",children:"Potentiometer"}),n.jsx("option",{value:"Rheostat",children:"Rheostat"}),n.jsx("option",{value:"Trimmer",children:"Trimmer"}),n.jsx("option",{value:"Varistor",children:"Varistor"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-resistance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),n.jsx("input",{id:`component-resistance-${c.id}`,type:"text",value:u.resistance||"",onChange:p=>g({...u,resistance:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 10"}),n.jsx("select",{value:u.resistanceUnit||Ze("resistance"),onChange:p=>g({...u,resistanceUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("resistance").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-power-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),n.jsxs("select",{id:`component-power-${c.id}`,value:u.power||"1/4",onChange:p=>g({...u,power:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"12px"},children:[n.jsx("option",{value:"1/20",children:"1/20 W"}),n.jsx("option",{value:"1/16",children:"1/16 W"}),n.jsx("option",{value:"1/10",children:"1/10 W"}),n.jsx("option",{value:"1/8",children:"1/8 W"}),n.jsx("option",{value:"1/4",children:"1/4 W"}),n.jsx("option",{value:"1/2",children:"1/2 W"}),n.jsx("option",{value:"1",children:"1 W"}),n.jsx("option",{value:"2",children:"2 W"}),n.jsx("option",{value:"3",children:"3 W"}),n.jsx("option",{value:"5",children:"5 W"}),n.jsx("option",{value:"10",children:"10 W"}),n.jsx("option",{value:"25",children:"25 W"}),n.jsx("option",{value:"50",children:"50 W"}),n.jsx("option",{value:"100",children:"100 W"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-taper-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Taper:"}),n.jsxs("select",{id:`component-taper-${c.id}`,value:u.taper||"Linear",onChange:p=>g({...u,taper:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Linear",children:"Linear"}),n.jsx("option",{value:"Logarithmic",children:"Logarithmic"}),n.jsx("option",{value:"Audio",children:"Audio"})]})]})]}),c.componentType==="Crystal"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-frequency-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Frequency:"}),n.jsx("input",{id:`component-frequency-${c.id}`,type:"text",value:u.frequency||"",onChange:p=>g({...u,frequency:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},placeholder:"e.g., 16.000 MHz"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-loadcapacitance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Load Capacitance:"}),n.jsx("input",{id:`component-loadcapacitance-${c.id}`,type:"text",value:u.loadCapacitance||"",onChange:p=>g({...u,loadCapacitance:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},placeholder:"e.g., 18pF"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-tolerance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),n.jsxs("select",{id:`component-tolerance-${c.id}`,value:u.tolerance||"10ppm",onChange:p=>g({...u,tolerance:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"10ppm",children:"10ppm"}),n.jsx("option",{value:"20ppm",children:"20ppm"}),n.jsx("option",{value:"30ppm",children:"30ppm"}),n.jsx("option",{value:"50ppm",children:"50ppm"}),n.jsx("option",{value:"100ppm",children:"100ppm"})]})]})]}),c.componentType==="ZenerDiode"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Zener Voltage:"}),n.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:p=>g({...u,voltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 5.1"}),n.jsx("select",{value:u.voltageUnit||Ze("voltage"),onChange:p=>g({...u,voltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-power-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),n.jsxs("select",{id:`component-power-${c.id}`,value:u.power||"1/4",onChange:p=>g({...u,power:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"12px"},children:[n.jsx("option",{value:"1/20",children:"1/20 W"}),n.jsx("option",{value:"1/16",children:"1/16 W"}),n.jsx("option",{value:"1/10",children:"1/10 W"}),n.jsx("option",{value:"1/8",children:"1/8 W"}),n.jsx("option",{value:"1/4",children:"1/4 W"}),n.jsx("option",{value:"1/2",children:"1/2 W"}),n.jsx("option",{value:"1",children:"1 W"}),n.jsx("option",{value:"2",children:"2 W"}),n.jsx("option",{value:"3",children:"3 W"}),n.jsx("option",{value:"5",children:"5 W"}),n.jsx("option",{value:"10",children:"10 W"}),n.jsx("option",{value:"25",children:"25 W"}),n.jsx("option",{value:"50",children:"50 W"}),n.jsx("option",{value:"100",children:"100 W"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-tolerance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),n.jsxs("select",{id:`component-tolerance-${c.id}`,value:u.tolerance||"5%",onChange:p=>g({...u,tolerance:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"0.5%",children:"0.5%"}),n.jsx("option",{value:"1%",children:"1%"}),n.jsx("option",{value:"2%",children:"2%"}),n.jsx("option",{value:"5%",children:"5%"}),n.jsx("option",{value:"10%",children:"10%"}),n.jsx("option",{value:"20%",children:"20%"})]})]})]})]}),kx=c=>{const u=$d[c];return!u||!u.prefix||u.prefix.length<1?"?":u.prefix[0].substring(0,1).toUpperCase()},Rx=({componentEditor:c,setComponentEditor:u,componentsTop:g,componentsBottom:d,setComponentsTop:R,setComponentsBottom:I,connectingPin:xe,setConnectingPin:q,componentDialogPosition:p,setComponentDialogPosition:V,isDraggingDialog:ue,setIsDraggingDialog:he,dialogDragOffset:Ce,setDialogDragOffset:Me,areComponentsLocked:se,setSelectedComponentIds:Be,setNotesDialogVisible:B})=>{if(!c||!c.visible)return null;let te=g.find(M=>M.id===c.id),Le="top";if(te||(te=d.find(M=>M.id===c.id),Le="bottom"),!te)return null;c.layer!==Le&&u({...c,layer:Le});const J=M=>{const z={...M},D=c.designator?.trim()||"";z.designator=D,z.x=c.x,z.y=c.y,z.layer=c.layer,z.orientation=c.orientation??0;const P=D.length>0?D.charAt(0).toUpperCase():kx(M.componentType);if(z.abbreviation=P,"manufacturer"in z&&(z.manufacturer=c.manufacturer?.trim()||void 0),"partNumber"in z&&(z.partNumber=c.partNumber?.trim()||void 0),c.pinCount!==M.pinCount){z.pinCount=c.pinCount;const E=M.pinConnections||[];if(z.pinConnections=new Array(c.pinCount).fill("").map((pe,W)=>W<E.length?E[W]:""),M.pinPolarities){const pe=M.pinPolarities||[];z.pinPolarities=new Array(c.pinCount).fill("").map((W,j)=>j<pe.length?pe[j]:"")}}else z.pinConnections=M.pinConnections||[],M.pinPolarities&&(z.pinPolarities=M.pinPolarities);return M.componentType==="Resistor"?(z.resistance=c.resistance||void 0,z.resistanceUnit=c.resistanceUnit||void 0,z.power=c.power?`${c.power}W`:void 0,z.tolerance=c.tolerance||void 0):M.componentType==="Capacitor"?(z.capacitance=c.capacitance||void 0,z.capacitanceUnit=c.capacitanceUnit||void 0,z.voltage=c.voltage||void 0,z.voltageUnit=c.voltageUnit||void 0,z.tolerance=c.tolerance||void 0,z.dielectric=c.dielectric||void 0):M.componentType==="Electrolytic Capacitor"?(z.capacitance=c.capacitance||void 0,z.capacitanceUnit=c.capacitanceUnit||void 0,z.voltage=c.voltage||void 0,z.voltageUnit=c.voltageUnit||void 0,z.tolerance=c.tolerance||void 0,z.polarity=c.polarityCapacitor||void 0,z.esr=c.esr||void 0,z.esrUnit=c.esrUnit||void 0,z.temperature=c.temperature||void 0):M.componentType==="Film Capacitor"?(z.capacitance=c.capacitance||void 0,z.capacitanceUnit=c.capacitanceUnit||void 0,z.voltage=c.voltage||void 0,z.voltageUnit=c.voltageUnit||void 0,z.tolerance=c.tolerance||void 0,z.filmType=c.filmType||void 0):M.componentType==="Diode"?(z.diodeType=c.diodeType||void 0,z.voltage=c.voltage||void 0,z.voltageUnit=c.voltageUnit||void 0,z.current=c.current||void 0,z.currentUnit=c.currentUnit||void 0,z.ledColor=c.ledColor||void 0):M.componentType==="Battery"?(z.voltage=c.voltage||void 0,z.voltageUnit=c.voltageUnit||void 0,z.capacity=c.capacity||void 0,z.capacityUnit=c.capacityUnit||void 0,z.chemistry=c.chemistry||void 0):M.componentType==="Fuse"?(z.current=c.current||void 0,z.currentUnit=c.currentUnit||void 0,z.voltage=c.voltage||void 0,z.voltageUnit=c.voltageUnit||void 0,z.fuseType=c.fuseType||void 0):M.componentType==="FerriteBead"?(z.impedance=c.impedance||void 0,z.impedanceUnit=c.impedanceUnit||void 0,z.current=c.current||void 0,z.currentUnit=c.currentUnit||void 0):M.componentType==="Connector"?(z.connectorType=c.connectorType||void 0,z.gender=c.gender||void 0):M.componentType==="Jumper"?z.positions=c.positions||void 0:M.componentType==="Relay"?(z.coilVoltage=c.coilVoltage||void 0,z.coilVoltageUnit=c.coilVoltageUnit||void 0,z.contactType=c.contactType||void 0,z.current=c.current||void 0,z.currentUnit=c.currentUnit||void 0):M.componentType==="Inductor"?(z.inductance=c.inductance||void 0,z.inductanceUnit=c.inductanceUnit||void 0,z.current=c.current||void 0,z.currentUnit=c.currentUnit||void 0,z.resistance=c.resistance||void 0,z.resistanceUnit=c.resistanceUnit||void 0):M.componentType==="Speaker"?(z.impedance=c.impedance||void 0,z.impedanceUnit=c.impedanceUnit||void 0,z.power=c.power?`${c.power}W`:void 0):M.componentType==="Motor"?(z.motorType=c.motorType||void 0,z.voltage=c.voltage||void 0,z.voltageUnit=c.voltageUnit||void 0,z.current=c.current||void 0,z.currentUnit=c.currentUnit||void 0):M.componentType==="PowerSupply"?(z.inputVoltage=c.inputVoltage||void 0,z.inputVoltageUnit=c.inputVoltageUnit||void 0,z.outputVoltage=c.outputVoltage||void 0,z.outputVoltageUnit=c.outputVoltageUnit||void 0,z.current=c.current||void 0,z.currentUnit=c.currentUnit||void 0):M.componentType==="Transistor"?(z.transistorType=c.transistorType||void 0,z.polarity=c.polarity||void 0,z.voltage=c.voltage||void 0,z.voltageUnit=c.voltageUnit||void 0,z.current=c.current||void 0,z.currentUnit=c.currentUnit||void 0):M.componentType==="ResistorNetwork"?(z.resistance=c.resistance||void 0,z.resistanceUnit=c.resistanceUnit||void 0,z.configuration=c.configuration||void 0):M.componentType==="Thermistor"?(z.resistance=c.resistance||void 0,z.resistanceUnit=c.resistanceUnit||void 0,z.thermistorType=c.thermistorType||void 0,z.beta=c.beta||void 0):M.componentType==="Switch"?(z.switchType=c.switchType||void 0,z.current=c.current||void 0,z.currentUnit=c.currentUnit||void 0,z.voltage=c.voltage||void 0,z.voltageUnit=c.voltageUnit||void 0):M.componentType==="Transformer"?(z.primaryVoltage=c.primaryVoltage||void 0,z.primaryVoltageUnit=c.primaryVoltageUnit||void 0,z.secondaryVoltage=c.secondaryVoltage||void 0,z.secondaryVoltageUnit=c.secondaryVoltageUnit||void 0,z.power=c.power?`${c.power}W`:void 0,z.turns=c.turns||void 0):M.componentType==="TestPoint"?z.signal=c.signal||void 0:M.componentType==="Film Capacitor"?(z.capacitance=c.capacitance||void 0,z.capacitanceUnit=c.capacitanceUnit||void 0,z.voltage=c.voltage||void 0,z.voltageUnit=c.voltageUnit||void 0,z.tolerance=c.tolerance||void 0,z.filmType=c.filmType||void 0):M.componentType==="IntegratedCircuit"?(z.description=c.description?.trim()||void 0,z.datasheet=c.datasheet?.trim()||void 0,z.icType=c.icType||void 0):z.description=c.description?.trim()||void 0,M.componentType==="VacuumTube"?z.tubeType=c.tubeType||void 0:M.componentType==="VariableResistor"?(z.vrType=c.vrType||void 0,z.resistance=c.resistance||void 0,z.resistanceUnit=c.resistanceUnit||void 0,z.power=c.power?`${c.power}W`:void 0,z.taper=c.taper||void 0):M.componentType==="Crystal"?(z.frequency=c.frequency||void 0,z.loadCapacitance=c.loadCapacitance||void 0,z.tolerance=c.tolerance||void 0):M.componentType==="ZenerDiode"&&(z.voltage=c.voltage||void 0,z.voltageUnit=c.voltageUnit||void 0,z.power=c.power?`${c.power}W`:void 0,z.tolerance=c.tolerance||void 0),z},ne=()=>{if(se){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const M=g.find(P=>P.id===c.id),z=d.find(P=>P.id===c.id),D=M||z;if(D){const P=J(D),E=D.layer,pe=c.layer;E!==pe?E==="top"?(R(W=>W.filter(j=>j.id!==c.id)),I(W=>[...W,P])):(I(W=>W.filter(j=>j.id!==c.id)),R(W=>[...W,P])):pe==="top"?R(W=>W.map(j=>j.id===c.id?P:j)):I(W=>W.map(j=>j.id===c.id?P:j))}else if(console.warn(`Component ${c.id} not found in either layer array`),c.layer==="top"){const P=d.find(E=>E.id===c.id);if(P){const E=J(P);I(pe=>pe.filter(W=>W.id!==c.id)),R(pe=>[...pe,E])}}else{const P=g.find(E=>E.id===c.id);if(P){const E=J(P);R(pe=>pe.filter(W=>W.id!==c.id)),I(pe=>[...pe,E])}}u(null),q(null)};return n.jsxs("div",{"data-component-editor-dialog":!0,onClick:M=>{if(xe&&xe.componentId===te.id){const z=M.target;(z.tagName==="BUTTON"||z.tagName==="INPUT"||z.closest("button")||z.closest("input"))&&M.stopPropagation()}},style:{position:"fixed",top:p?`${p.y}px`:"90px",left:p?`${p.x}px`:`${window.innerWidth-280}px`,transform:"none",background:xe&&xe.componentId===te.id?"rgba(255, 255, 255, 0.95)":"#fff",border:"1px solid #0b5fff",borderRadius:4,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"175px",maxWidth:"250px",maxHeight:"40vh",display:"flex",flexDirection:"column",pointerEvents:"auto",cursor:ue?"grabbing":"default"},children:[n.jsxs("div",{onMouseDown:M=>{const z=M.target;z.tagName==="BUTTON"||z.tagName==="INPUT"||z.closest("button")||z.closest("input")||p&&(Me({x:M.clientX-p.x,y:M.clientY-p.y}),he(!0),M.preventDefault())},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:ue?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[n.jsx("h3",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Component Properties"}),n.jsx("button",{onClick:()=>{u(null),q(null)},style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"6px 20px 6px 6px",overflowY:"auto",flex:1,minHeight:0},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Type:"}),n.jsx("div",{style:{flex:1,padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#000"},children:Ld(te.componentType)})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-layer-${te.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Layer:"}),n.jsxs("select",{id:`component-layer-${te.id}`,name:`component-layer-${te.id}`,value:c.layer,onChange:M=>u({...c,layer:M.target.value}),disabled:se,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:se?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"top",children:"Top"}),n.jsx("option",{value:"bottom",children:"Bottom"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-orientation-${te.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Orientation:"}),n.jsxs("select",{id:`component-orientation-${te.id}`,name:`component-orientation-${te.id}`,value:c.orientation??0,onChange:M=>{const z=parseInt(M.target.value)||0;if(u({...c,orientation:z}),!se){const P=(c.layer==="top"?g:d).find(E=>E.id===c.id);if(P){const E={...P,orientation:z};c.layer==="top"?R(pe=>pe.map(W=>W.id===c.id?E:W)):I(pe=>pe.map(W=>W.id===c.id?E:W))}}},disabled:se,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:se?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"0",children:"0"}),n.jsx("option",{value:"90",children:"90"}),n.jsx("option",{value:"180",children:"180"}),n.jsx("option",{value:"270",children:"270"})]})]}),n.jsx(zx,{component:te,componentEditor:c,setComponentEditor:u,areComponentsLocked:se,componentsTop:g,componentsBottom:d,setComponentsTop:R,setComponentsBottom:I}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginTop:"4px",paddingTop:"4px",borderTop:"1px solid #e0e0e0"},children:[n.jsx("label",{htmlFor:`component-designator-${te.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Designator:"}),n.jsx("input",{id:`component-designator-${te.id}`,name:`component-designator-${te.id}`,type:"text",value:c.designator||"",onChange:M=>{const z=M.target.value,D=z.length>0?z.charAt(0).toUpperCase():c.abbreviation;u({...c,designator:z,abbreviation:D})},disabled:se,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",fontFamily:"monospace",textTransform:"uppercase",opacity:se?.6:1},placeholder:"e.g., U2, R7, C1"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-description-${te.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Description:"}),n.jsx("input",{id:`component-description-${te.id}`,name:`component-description-${te.id}`,type:"text",value:c.description||"",onChange:M=>{u({...c,description:M.target.value})},disabled:se,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:se?.6:1},placeholder:te.componentType==="IntegratedCircuit"?"e.g., Dual Op-Amp":"e.g., Op Amp OP07"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-notes-${te.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Notes:"}),n.jsx("input",{id:`component-notes-${te.id}`,name:`component-notes-${te.id}`,type:"text",readOnly:!0,value:te.notes||"",onClick:()=>{se||(Be(new Set([te.id])),B(!0))},disabled:se,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:se?.6:1,cursor:se?"not-allowed":"pointer",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},placeholder:"Click to edit notes...",title:te.notes||"Click to edit notes..."})]}),te.componentType!=="IntegratedCircuit"&&n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-pincount-${te.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Pin Count:"}),n.jsx("input",{id:`component-pincount-${te.id}`,name:`component-pincount-${te.id}`,type:"number",min:"1",value:c.pinCount,onChange:M=>{const z=Math.max(1,parseInt(M.target.value)||1);u({...c,pinCount:z})},onBlur:M=>{if(se){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const z=Math.max(1,parseInt(M.target.value)||1),P=(c.layer==="top"?g:d).find(E=>E.id===c.id);if(P&&z!==P.pinCount){const E=P.pinConnections||[],pe=new Array(z).fill("").map((be,re)=>re<E.length?E[re]:""),W=P.pinPolarities||[],j=P.pinPolarities?new Array(z).fill("").map((be,re)=>re<W.length?W[re]:""):void 0,me={...P,pinCount:z,pinConnections:pe,...j!==void 0&&{pinPolarities:j}};c.layer==="top"?R(be=>be.map(re=>re.id===c.id?me:re)):I(be=>be.map(re=>re.id===c.id?me:re)),u({...c,pinCount:z})}},disabled:se,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:se?.6:1}})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-x-${te.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"X:"}),n.jsx("input",{id:`component-x-${te.id}`,name:`component-x-${te.id}`,type:"number",value:c.x.toFixed(2),onChange:M=>{const z=parseFloat(M.target.value)||0;u({...c,x:z})},disabled:se,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:se?.6:1}})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-y-${te.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Y:"}),n.jsx("input",{id:`component-y-${te.id}`,name:`component-y-${te.id}`,type:"number",value:c.y.toFixed(2),onChange:M=>{const z=parseFloat(M.target.value)||0;u({...c,y:z})},disabled:se,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:se?.6:1}})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-manufacturer-${te.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Manufacturer:"}),n.jsx("input",{id:`component-manufacturer-${te.id}`,name:`component-manufacturer-${te.id}`,type:"text",value:c.manufacturer,onChange:M=>u({...c,manufacturer:M.target.value}),disabled:se,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:se?.6:1}})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-partnumber-${te.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Part Number:"}),n.jsx("input",{id:`component-partnumber-${te.id}`,name:`component-partnumber-${te.id}`,type:"text",value:c.partNumber,onChange:M=>u({...c,partNumber:M.target.value}),disabled:se,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:se?.6:1}})]}),n.jsxs("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid #e0e0e0"},children:[n.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"2px"},children:"Pin Connections:"}),xe&&xe.componentId===te.id&&n.jsxs("div",{style:{padding:"2px 3px",background:"#fff3cd",border:"1px solid #ffc107",borderRadius:2,marginBottom:"2px",fontSize:"8px",color:"#856404"},children:["Pin ",xe.pinIndex+1," selected. Click on a via or pad to connect."]}),(()=>{const M=te.componentType==="Electrolytic Capacitor"||te.componentType==="Diode"||te.componentType==="Battery"||te.componentType==="ZenerDiode",z=te.componentType==="Capacitor"&&"dielectric"in te&&te.dielectric==="Tantalum",D=M||z;return n.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"8px",marginTop:"2px"},children:[n.jsx("thead",{children:n.jsxs("tr",{style:{borderBottom:"1px solid #ddd",background:"#f5f5f5"},children:[n.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"8px",color:"#333",width:"20px"}}),n.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"8px",color:"#333",width:"40px"},children:"Pin"}),D&&n.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"8px",color:"#333",width:"50px"},children:"Polarity"}),n.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"8px",color:"#333"},children:"Node ID"})]})}),n.jsx("tbody",{children:Array.from({length:c.pinCount},(P,E)=>{const W=(c.layer==="top"?g:d).find(re=>re.id===c.id),j=W?.pinConnections&&W.pinConnections.length>E?W.pinConnections[E]:"",me=W?.pinPolarities&&W.pinPolarities.length>E&&W.pinPolarities[E]||"",be=xe&&xe.componentId===te.id&&xe.pinIndex===E;return n.jsxs("tr",{style:{cursor:se?"not-allowed":"pointer",background:be?"#e6f0ff":j?"#d4edda":"#fff",borderBottom:"1px solid #eee"},onClick:re=>{if(re.target.tagName!=="SELECT"){if(se){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}q(be?null:{componentId:te.id,pinIndex:E})}},title:j?`Connected to: ${j}`:"Select this pin, then click on a via or pad to connect",children:[n.jsx("td",{style:{padding:"2px 4px",textAlign:"center"},children:n.jsx("input",{id:`pin-radio-${te.id}-${E}`,name:`pin-radio-${te.id}`,type:"radio",checked:!!be,onChange:()=>{if(se){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}q(be?null:{componentId:te.id,pinIndex:E})},disabled:se,style:{margin:0,cursor:se?"not-allowed":"pointer",opacity:se?.6:1,width:"10px",height:"10px"}})}),n.jsx("td",{style:{padding:"2px 4px",color:"#333",fontWeight:be?600:400,fontFamily:"monospace"},children:E+1}),D&&n.jsx("td",{style:{padding:"2px 4px",textAlign:"center"},children:n.jsxs("select",{value:me??"",onChange:re=>{if(se){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const _=re.target.value,Y=(c.layer==="top"?g:d).find(je=>je.id===c.id);if(Y){const L=[...Y.pinPolarities||new Array(Y.pinCount).fill("")];for(;L.length<Y.pinCount;)L.push("");L[E]=_;const S={...Y,pinPolarities:L};c.layer==="top"?R(A=>A.map($=>$.id===c.id?S:$)):I(A=>A.map($=>$.id===c.id?S:$))}},disabled:se,onClick:re=>re.stopPropagation(),onFocus:re=>re.stopPropagation(),style:{padding:"1px 2px",fontSize:"8px",border:"1px solid #ddd",borderRadius:2,background:"#fff",cursor:se?"not-allowed":"pointer",opacity:se?.6:1,width:"100%",fontFamily:"monospace",fontWeight:600},children:[n.jsx("option",{value:"",children:"-"}),n.jsx("option",{value:"+",children:"+"}),n.jsx("option",{value:"-",children:"-"})]},`polarity-${te.id}-${E}-${me}`)}),n.jsx("td",{style:{padding:"2px 4px",color:j?"#28a745":"#999",fontWeight:j?600:400,fontFamily:"monospace"},children:j||"-"})]},E)})})]})})()]})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"6px",padding:"6px",borderTop:"1px solid #e0e0e0",flexShrink:0},children:[n.jsx("button",{onClick:()=>{u(null),q(null)},disabled:se,style:{padding:"2px 5px",background:se?"#f5f5f5":"#fff",color:se?"#999":"#333",border:"1px solid #ddd",borderRadius:2,cursor:se?"not-allowed":"pointer",fontSize:"10px",opacity:se?.6:1},children:"Cancel"}),n.jsx("button",{onClick:ne,disabled:se,style:{padding:"2px 5px",background:se?"#f5f5f5":"#0b5fff",color:se?"#999":"#fff",border:"1px solid #ddd",borderRadius:2,cursor:se?"not-allowed":"pointer",fontSize:"10px",opacity:se?.6:1},children:"Save"})]})]})},Dx=({visible:c,onClose:u,powerBuses:g,setPowerBuses:d,editingPowerBusId:R,setEditingPowerBusId:I,powers:xe})=>{const[q,p]=b.useState(null),[V,ue]=b.useState(!1),[he,Ce]=b.useState(null),Me=b.useRef(null);b.useEffect(()=>{c&&!q&&p({x:window.innerWidth/2-140,y:window.innerHeight/2-200})},[c,q]),b.useEffect(()=>{if(!V)return;const ne=z=>{q&&he&&p({x:z.clientX-he.x,y:z.clientY-he.y})},M=()=>{ue(!1),Ce(null)};return window.addEventListener("mousemove",ne),window.addEventListener("mouseup",M),()=>{window.removeEventListener("mousemove",ne),window.removeEventListener("mouseup",M)}},[V,q,he]);const se=g.filter(ne=>ne.id!==R),Be=g.find(ne=>ne.id===R);if(!c)return null;const B=[...se].sort((ne,M)=>{const z=E=>{const pe=E.match(/([+-]?)(\d+\.?\d*)/);if(pe){const W=pe[1]||"+",j=parseFloat(pe[2]);return{absValue:Math.abs(j),isNegative:W==="-"}}return{absValue:1/0,isNegative:!1}},D=z(ne.voltage),P=z(M.voltage);return D.absValue!==P.absValue?D.absValue-P.absValue:D.isNegative!==P.isNegative?D.isNegative?-1:1:0}),te=Be?[...B,Be]:B,Le=()=>{const ne={id:`powerbus-${Date.now()}-${Math.random()}`,name:"New Power Bus",voltage:"+0.0",color:"#ff0000"};d(M=>[...M,ne]),I(ne.id)},J=ne=>{const M=ne.target;M.tagName==="BUTTON"||M.tagName==="INPUT"||M.closest("button")||M.closest("input")||q&&(Ce({x:ne.clientX-q.x,y:ne.clientY-q.y}),ue(!0),ne.preventDefault())};return n.jsxs("div",{ref:Me,style:{position:"fixed",top:q?`${q.y}px`:"50%",left:q?`${q.x}px`:"50%",transform:q?"none":"translate(-50%, -50%)",background:"#fff",border:"1px solid #0b5fff",borderRadius:4,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"280px",maxWidth:"320px",maxHeight:"80vh",display:"flex",flexDirection:"column",cursor:V?"grabbing":"default"},children:[n.jsxs("div",{onMouseDown:J,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:V?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[n.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Manage Power Buses"}),n.jsx("button",{onClick:u,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"6px 20px 6px 6px",overflowY:"auto",flex:1,minHeight:0},children:te.map(ne=>{const M=g.find(E=>E.id===ne.id)||ne,z=g.findIndex(E=>E.id===ne.id),D=g.some(E=>E.name===M.name&&E.id!==ne.id),P=g.some(E=>E.voltage===M.voltage&&E.id!==ne.id);return n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"4px",marginBottom:"4px",background:"#f9f9f9",borderRadius:4,border:"1px solid #e0e0e0"},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsxs("div",{style:{flex:1,minWidth:0,display:"flex",flexDirection:"column",gap:"4px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"50px",flexShrink:0},children:"Name:"}),n.jsx("input",{type:"text",value:M.name,onChange:E=>{const pe=E.target.value;if(!g.some(j=>j.name===pe&&j.id!==ne.id)){const j=[...g];z>=0&&(j[z]={...M,name:pe},d(j))}},placeholder:"e.g., +5VDC",style:{flex:1,padding:"2px 3px",border:D?"1px solid #ff0000":"1px solid #ddd",borderRadius:2,fontSize:"10px",background:"#f5f5f5",color:"#000"}})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"50px",flexShrink:0},children:"Value:"}),n.jsx("input",{type:"text",inputMode:"decimal",value:M.voltage,onChange:E=>{const pe=E.target.value;if(pe===""||/^[+-]?\d*\.?\d*$/.test(pe)){const W=[...g];z>=0&&(W[z]={...M,voltage:pe},d(W))}},onBlur:E=>{const pe=E.target.value.trim();if(pe==="")return;const W=parseFloat(pe);if(!isNaN(W)){const j=W>=0?"+":"-",me=Math.abs(W),be=`${j}${me.toFixed(1).replace(/\.?0+$/,"")}`,re=[...g];z>=0&&(re[z]={...M,voltage:be},d(re))}},placeholder:"e.g., +5.0",style:{flex:1,padding:"2px 3px",border:P?"1px solid #ff0000":"1px solid #ddd",borderRadius:2,fontSize:"10px",background:"#f5f5f5",color:"#000"}})]})]}),n.jsx("input",{type:"color",value:M.color,onChange:E=>{const pe=[...g];z>=0&&(pe[z]={...M,color:E.target.value},d(pe))},style:{width:"24px",height:"24px",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",flexShrink:0},title:"Color"}),n.jsx("button",{onClick:()=>{const E=xe.filter(pe=>pe.powerBusId===ne.id);if(E.length>0){alert(`Cannot delete: ${E.length} power node(s) are using this bus. Remove or reassign them first.`);return}d(pe=>pe.filter(W=>W.id!==ne.id))},style:{padding:"2px 6px",background:"#f5f5f5",color:"#333",border:"1px solid #ddd",borderRadius:2,cursor:"pointer",fontSize:"9px",flexShrink:0},children:"Delete"})]})},ne.id)})}),n.jsxs("div",{style:{padding:"6px",borderTop:"1px solid #e0e0e0",display:"flex",gap:"4px",flexShrink:0},children:[n.jsx("button",{onClick:Le,style:{flex:1,padding:"4px 8px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",fontSize:"10px"},children:"+ Add Power Bus"}),n.jsx("button",{onClick:u,style:{flex:1,padding:"4px 8px",background:"#0b5fff",color:"#fff",border:"none",borderRadius:2,cursor:"pointer",fontSize:"10px",fontWeight:500},children:"Close"})]})]})},Ax=({visible:c,onClose:u,groundBuses:g,setGroundBuses:d,editingGroundBusId:R,setEditingGroundBusId:I,grounds:xe})=>{const[q,p]=b.useState(null),[V,ue]=b.useState(!1),[he,Ce]=b.useState(null),Me=b.useRef(null);b.useEffect(()=>{c&&!q&&p({x:window.innerWidth/2-140,y:window.innerHeight/2-200})},[c,q]),b.useEffect(()=>{if(!V)return;const ne=z=>{q&&he&&p({x:z.clientX-he.x,y:z.clientY-he.y})},M=()=>{ue(!1),Ce(null)};return window.addEventListener("mousemove",ne),window.addEventListener("mouseup",M),()=>{window.removeEventListener("mousemove",ne),window.removeEventListener("mouseup",M)}},[V,q,he]);const se=g.filter(ne=>ne.id!==R),Be=g.find(ne=>ne.id===R);if(!c)return null;const B=[...se].sort((ne,M)=>ne.name.localeCompare(M.name)),te=Be?[...B,Be]:B,Le=()=>{const ne={id:`groundbus-${Date.now()}-${Math.random()}`,name:"New Ground Bus",color:"#000000"};d(M=>[...M,ne]),I(ne.id)},J=ne=>{const M=ne.target;M.tagName==="BUTTON"||M.tagName==="INPUT"||M.closest("button")||M.closest("input")||q&&(Ce({x:ne.clientX-q.x,y:ne.clientY-q.y}),ue(!0),ne.preventDefault())};return n.jsxs("div",{ref:Me,style:{position:"fixed",top:q?`${q.y}px`:"50%",left:q?`${q.x}px`:"50%",transform:q?"none":"translate(-50%, -50%)",background:"#fff",border:"1px solid #0b5fff",borderRadius:4,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"280px",maxWidth:"320px",maxHeight:"80vh",display:"flex",flexDirection:"column",cursor:V?"grabbing":"default"},children:[n.jsxs("div",{onMouseDown:J,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:V?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[n.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Manage Ground Buses"}),n.jsx("button",{onClick:u,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"6px 20px 6px 6px",overflowY:"auto",flex:1,minHeight:0},children:te.map(ne=>{const M=g.find(P=>P.id===ne.id)||ne,z=g.findIndex(P=>P.id===ne.id),D=g.some(P=>P.name===M.name&&P.id!==ne.id);return n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",padding:"4px",marginBottom:"4px",background:"#f9f9f9",borderRadius:4,border:"1px solid #e0e0e0"},children:[n.jsx("div",{style:{flex:1,minWidth:0},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"50px",flexShrink:0},children:"Name:"}),n.jsx("input",{type:"text",value:M.name,onChange:P=>{const E=P.target.value;if(!g.some(W=>W.name===E&&W.id!==ne.id)){const W=[...g];z>=0&&(W[z]={...M,name:E},d(W))}},placeholder:"e.g., GND, Earth",style:{flex:1,padding:"2px 3px",border:D?"1px solid #ff0000":"1px solid #ddd",borderRadius:2,fontSize:"10px",background:"#f5f5f5",color:"#000"}})]})}),n.jsx("input",{type:"color",value:M.color,onChange:P=>{const E=[...g];z>=0&&(E[z]={...M,color:P.target.value},d(E))},style:{width:"24px",height:"24px",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",flexShrink:0},title:"Color"}),n.jsx("button",{onClick:()=>{const P=xe.filter(E=>E.groundBusId===ne.id);if(P.length>0){alert(`Cannot delete: ${P.length} ground node(s) are using this bus. Remove or reassign them first.`);return}d(E=>E.filter(pe=>pe.id!==ne.id))},style:{padding:"2px 6px",background:"#f5f5f5",color:"#333",border:"1px solid #ddd",borderRadius:2,cursor:"pointer",fontSize:"9px",flexShrink:0},children:"Delete"})]},ne.id)})}),n.jsxs("div",{style:{padding:"6px",borderTop:"1px solid #e0e0e0",display:"flex",gap:"4px",flexShrink:0},children:[n.jsx("button",{onClick:Le,style:{flex:1,padding:"4px 8px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",fontSize:"10px"},children:"+ Add Ground Bus"}),n.jsx("button",{onClick:u,style:{flex:1,padding:"4px 8px",background:"#0b5fff",color:"#fff",border:"none",borderRadius:2,cursor:"pointer",fontSize:"10px",fontWeight:500},children:"Close"})]})]})},Nx=({visible:c,onClose:u,autoAssignDesignators:g,setAutoAssignDesignators:d,useGlobalDesignatorCounters:R,setUseGlobalDesignatorCounters:I})=>c?n.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#fff",border:"1px solid #ddd",borderRadius:6,padding:"16px",zIndex:1e3,minWidth:"300px",maxWidth:"400px",boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[n.jsx("h2",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#222"},children:"Manage Designators"}),n.jsx("button",{onClick:u,style:{background:"transparent",border:"none",fontSize:"18px",cursor:"pointer",color:"#666",padding:0,width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),n.jsxs("div",{style:{marginBottom:"16px"},children:[n.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:"13px",color:"#333",marginBottom:"12px"},children:[n.jsx("input",{type:"checkbox",checked:g,onChange:xe=>{d(xe.target.checked)},style:{width:"16px",height:"16px",cursor:"pointer"}}),n.jsx("span",{children:"Automatically assign designators"})]}),n.jsx("div",{style:{marginTop:"8px",padding:"8px",background:"#f5f5f5",borderRadius:4,fontSize:"11px",color:"#666",lineHeight:"1.4",marginBottom:"12px"},children:g?n.jsx("div",{children:"When enabled, new components automatically receive sequential designators (e.g., C1, C2, C3 for Capacitors; R1, R2, R3 for Resistors)."}):n.jsx("div",{children:"When disabled, you must manually assign designators to each component. The designator field will be empty when components are created."})}),n.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:"13px",color:"#333"},children:[n.jsx("input",{type:"checkbox",checked:R,onChange:xe=>{I(xe.target.checked)},style:{width:"16px",height:"16px",cursor:"pointer"}}),n.jsx("span",{children:"Use global designator counters"})]}),n.jsx("div",{style:{marginTop:"8px",padding:"8px",background:"#f5f5f5",borderRadius:4,fontSize:"11px",color:"#666",lineHeight:"1.4"},children:R?n.jsx("div",{children:"When ON, designators continue from global counters across all projects. New components start with the next value from the global counter (e.g., if global counter is C10, new capacitor will be C11)."}):n.jsx("div",{children:"When OFF (default), designators start at 1 for each project. Each project maintains its own independent designator sequence (e.g., C1, C2, C3...)."})})]}),n.jsx("button",{onClick:u,style:{width:"100%",padding:"6px 12px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:4,cursor:"pointer",fontSize:"12px"},children:"Close"})]}):null,Bh=({visible:c,title:u,message:g,onYes:d,onNo:R,onCancel:I,yesButtonRef:xe})=>c?n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001},onClick:q=>{q.target===q.currentTarget&&I()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:q=>q.stopPropagation(),children:[n.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:u}),n.jsx("p",{style:{margin:"0 0 24px 0",fontSize:"14px",color:"#e0e0e0",lineHeight:"1.5"},children:g}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[n.jsx("button",{onClick:I,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),n.jsx("button",{onClick:R,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"No"}),n.jsx("button",{ref:xe,onClick:d,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},autoFocus:!0,children:"Yes"})]})]})}):null,Mx=({visible:c,size:u,onSizeChange:g,onApply:d,onCancel:R})=>{const I=b.useRef(null);if(b.useEffect(()=>{c&&I.current&&(I.current.focus(),I.current.select())},[c]),!c)return null;const xe=[2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32];return n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10003},onClick:q=>{q.target===q.currentTarget&&R()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:q=>q.stopPropagation(),children:[n.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Set Size"}),n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Size (pixels):"}),n.jsx("input",{ref:I,type:"number",min:"1",max:"99",value:u,onChange:q=>{const p=parseInt(q.target.value)||1,V=Math.max(1,Math.min(99,p));g(V)},onKeyDown:q=>{if(q.key==="Enter"?d():q.key==="Escape"&&R(),q.key.length===1&&/[0-9]/.test(q.key)){const p=u.toString();p.length>=2&&I.current?.selectionStart===I.current?.selectionEnd&&I.current?.selectionStart===p.length&&q.preventDefault()}},onInput:q=>{const p=q.target,V=p.value;if(V.length>2){p.value=V.slice(0,2);const ue=parseInt(p.value)||1;g(Math.max(1,Math.min(99,ue)))}},style:{width:"100%",padding:"8px 12px",marginBottom:"16px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0}),n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Or select from list:"}),n.jsxs("select",{value:xe.includes(u)?u:"",onChange:q=>{const p=parseInt(q.target.value);!isNaN(p)&&p>0&&g(p)},style:{width:"100%",padding:"8px 12px",marginBottom:"20px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},children:[n.jsx("option",{value:"",style:{background:"#1f1f24",color:"#f2f2f2"},children:"-- Select --"}),xe.map(q=>n.jsxs("option",{value:q,style:{background:"#1f1f24",color:"#f2f2f2"},children:[q," pixels"]},q))]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[n.jsx("button",{onClick:R,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),n.jsx("button",{onClick:d,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Apply"})]})]})})},Bx=({visible:c,interval:u,onIntervalChange:g,onApply:d,onCancel:R})=>c?n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10003},onClick:I=>{I.target===I.currentTarget&&R()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:I=>I.stopPropagation(),children:[n.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Auto Save"}),n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Select time interval:"}),n.jsxs("select",{value:u===null?"disable":(u||5).toString(),onChange:I=>{const xe=I.target.value;if(xe==="disable")g(null);else{const q=parseFloat(xe);!isNaN(q)&&q>0&&g(q)}},style:{width:"100%",padding:"8px 12px",marginBottom:"20px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0,children:[n.jsx("option",{value:"1",style:{background:"#1f1f24",color:"#f2f2f2"},children:"1 minute"}),n.jsx("option",{value:"5",style:{background:"#1f1f24",color:"#f2f2f2"},children:"5 minutes"}),n.jsx("option",{value:"10",style:{background:"#1f1f24",color:"#f2f2f2"},children:"10 minutes"}),n.jsx("option",{value:"20",style:{background:"#1f1f24",color:"#f2f2f2"},children:"20 minutes"}),n.jsx("option",{value:"30",style:{background:"#1f1f24",color:"#f2f2f2"},children:"30 minutes"}),n.jsx("option",{value:"disable",style:{background:"#1f1f24",color:"#f2f2f2"},children:"Disable"})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[n.jsx("button",{onClick:R,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),n.jsx("button",{onClick:d,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Apply"})]})]})}):null,Ux=({visible:c,interval:u,onIntervalChange:g,onEnable:d,onSkip:R})=>c?n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:I=>{I.target===I.currentTarget&&R()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:I=>I.stopPropagation(),children:[n.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Enable Auto Save?"}),n.jsx("p",{style:{margin:"0 0 20px 0",fontSize:"14px",color:"#e0e0e0",lineHeight:"1.5"},children:"We recommend enabling Auto Save to automatically save your project at regular intervals. This helps protect your work from accidental loss."}),n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Select time interval:"}),n.jsxs("select",{value:u===null?"disable":(u||5).toString(),onChange:I=>{const xe=I.target.value;if(xe==="disable")g(null);else{const q=parseFloat(xe);!isNaN(q)&&q>0&&g(q)}},style:{width:"100%",padding:"8px 12px",marginBottom:"24px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0,children:[n.jsx("option",{value:"1",style:{background:"#1f1f24",color:"#f2f2f2"},children:"1 minute"}),n.jsx("option",{value:"5",style:{background:"#1f1f24",color:"#f2f2f2"},children:"5 minutes"}),n.jsx("option",{value:"10",style:{background:"#1f1f24",color:"#f2f2f2"},children:"10 minutes"}),n.jsx("option",{value:"20",style:{background:"#1f1f24",color:"#f2f2f2"},children:"20 minutes"}),n.jsx("option",{value:"30",style:{background:"#1f1f24",color:"#f2f2f2"},children:"30 minutes"})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[n.jsx("button",{onClick:R,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Skip"}),n.jsx("button",{onClick:d,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Enable Auto Save"})]})]})}):null,Px=({visible:c,projectDirHandle:u,onClose:g,onRestore:d,position:R,isDragging:I=!1,onDragStart:xe})=>{const[q,p]=b.useState([]),[V,ue]=b.useState(!1),[he,Ce]=b.useState(null),[Me,se]=b.useState(null),Be=b.useRef(null);b.useEffect(()=>{if(!c||!u){p([]),Ce(null),se(null);return}(async()=>{ue(!0),se(null);try{let M;try{M=await u.getDirectoryHandle("history")}catch{p([]),ue(!1);return}const z=P=>{const E=P.match(/_(\d{4})_(\d{2})_(\d{2})-(\d{2})-(\d{2})-(\d{2})\.json$/);if(E){const[,W,j,me,be,re,_]=E;return new Date(parseInt(W),parseInt(j)-1,parseInt(me),parseInt(be),parseInt(re),parseInt(_))}const pe=P.match(/_(\d{4})_(\d{2})_(\d{2})_(\d{2})_(\d{2})_(\d{2})\.json$/);if(pe){const[,W,j,me,be,re,_]=pe;return new Date(parseInt(W),parseInt(j)-1,parseInt(me),parseInt(be),parseInt(re),parseInt(_))}return null},D=[];for await(const P of M.keys())if(P.endsWith(".json"))try{const pe=await(await M.getFileHandle(P)).getFile(),W=z(P);D.push({name:P,lastModified:new Date(pe.lastModified),size:pe.size,timestamp:W||new Date(pe.lastModified)})}catch(E){console.warn(`Failed to read file ${P}:`,E)}D.sort((P,E)=>E.timestamp.getTime()-P.timestamp.getTime()),p(D)}catch(M){console.error("Failed to load history files:",M),se("Failed to load history files. Please try again.")}finally{ue(!1)}})()},[c,u]);const B=async()=>{if(he)try{await d(he),g()}catch(ne){console.error("Failed to restore file:",ne),se("Failed to restore file. Please try again.")}},te=ne=>ne.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),Le=ne=>ne<1024?`${ne} B`:ne<1024*1024?`${(ne/1024).toFixed(1)} KB`:`${(ne/(1024*1024)).toFixed(1)} MB`;if(!c)return null;const J=R?{position:"fixed",left:`${R.x}px`,top:`${R.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"500px",maxWidth:"700px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:I?"grabbing":"default"}:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"#fff",borderRadius:8,minWidth:"500px",maxWidth:"700px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column"};return n.jsxs("div",{style:J,children:[n.jsxs("div",{onMouseDown:xe,style:{backgroundColor:"#f5f5f5",padding:"12px 16px",borderBottom:"1px solid #ddd",borderRadius:"8px 8px 0 0",cursor:I?"grabbing":"move",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsx("h2",{style:{margin:0,fontSize:"16px",fontWeight:600,color:"#000"},children:"PastTime"}),n.jsx("button",{onClick:g,style:{background:"transparent",border:"none",fontSize:"20px",cursor:"pointer",color:"#666",padding:"0 4px",lineHeight:1},title:"Close",children:""})]}),n.jsxs("div",{style:{padding:"16px",display:"flex",flexDirection:"column",flex:1,minHeight:0},children:[Me&&n.jsx("div",{style:{padding:"12px",backgroundColor:"#fee",color:"#c00",borderRadius:4,marginBottom:"12px"},children:Me}),V?n.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"Loading history files..."}):q.length===0?n.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"No history files found."}):n.jsxs(n.Fragment,{children:[n.jsx("div",{style:{marginBottom:"12px",color:"#333",fontSize:"14px"},children:"Select a file to restore:"}),n.jsx("div",{ref:Be,style:{border:"1px solid #ddd",borderRadius:4,overflowY:"auto",maxHeight:"400px",backgroundColor:"#fafafa"},children:q.map((ne,M)=>n.jsxs("div",{onClick:()=>Ce(ne.name),style:{padding:"12px 16px",borderBottom:M<q.length-1?"1px solid #eee":"none",backgroundColor:he===ne.name?"#e6f0ff":"transparent",cursor:"pointer",transition:"background-color 0.1s"},onMouseEnter:z=>{he!==ne.name&&(z.currentTarget.style.backgroundColor="#f5f5f5")},onMouseLeave:z=>{he!==ne.name&&(z.currentTarget.style.backgroundColor="transparent")},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"4px"},children:[n.jsx("div",{style:{fontWeight:600,color:"#000",fontSize:"13px",wordBreak:"break-word",flex:1},children:ne.name}),n.jsx("div",{style:{color:"#666",fontSize:"12px",marginLeft:"12px",whiteSpace:"nowrap"},children:Le(ne.size)})]}),n.jsx("div",{style:{color:"#666",fontSize:"12px"},children:te(ne.lastModified)})]},ne.name))})]})]}),n.jsxs("div",{style:{padding:"12px 16px",borderTop:"1px solid #ddd",display:"flex",justifyContent:"flex-end",gap:"8px"},children:[n.jsx("button",{onClick:g,style:{padding:"6px 16px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"13px"},children:"Cancel"}),n.jsx("button",{onClick:B,disabled:!he||V,style:{padding:"6px 16px",background:he&&!V?"#0066cc":"#ccc",border:"none",borderRadius:4,cursor:he&&!V?"pointer":"not-allowed",color:"#fff",fontSize:"13px",fontWeight:500},children:"Restore"})]})]})};function Ox(){const[c,u]=b.useState([]),[g,d]=b.useState(!1),[R,I]=b.useState([]),[xe,q]=b.useState(null),[p,V]=b.useState("trace"),[ue,he]=b.useState("top"),Ce=b.useRef([]),Me=b.useRef(0),se=b.useRef(!1),Be=b.useCallback(()=>{d(!0),I([]),Ce.current=[]},[]),B=b.useCallback(()=>{d(!1),I([]),Ce.current=[]},[]),te=b.useCallback(J=>{I(ne=>[...ne,J]),Ce.current=[...Ce.current,J]},[]),Le=b.useCallback(J=>{u(ne=>[...ne,J]),I([]),Ce.current=[]},[]);return{drawingStrokes:c,setDrawingStrokes:u,isDrawing:g,setIsDrawing:d,currentStroke:R,setCurrentStroke:I,tracePreviewMousePos:xe,setTracePreviewMousePos:q,drawingMode:p,setDrawingMode:V,selectedDrawingLayer:ue,setSelectedDrawingLayer:he,currentStrokeRef:Ce,lastTraceClickTimeRef:Me,isDoubleClickingTraceRef:se,startDrawing:Be,stopDrawing:B,addPointToStroke:te,finishStroke:Le}}function Ex(){const[c,u]=b.useState(new Set),[g,d]=b.useState(!1),[R,I]=b.useState(new Set),[xe,q]=b.useState(new Set),[p,V]=b.useState(new Set),ue=b.useCallback(()=>{u(new Set),I(new Set),q(new Set),V(new Set)},[]),he=b.useCallback((se,Be="stroke")=>{Be==="stroke"?u(B=>new Set([...B,se])):Be==="component"?I(B=>new Set([...B,se])):Be==="power"?q(B=>new Set([...B,se])):Be==="ground"&&V(B=>new Set([...B,se]))},[]),Ce=b.useCallback((se,Be="stroke")=>{Be==="stroke"?u(B=>{const te=new Set(B);return te.delete(se),te}):Be==="component"?I(B=>{const te=new Set(B);return te.delete(se),te}):Be==="power"?q(B=>{const te=new Set(B);return te.delete(se),te}):Be==="ground"&&V(B=>{const te=new Set(B);return te.delete(se),te})},[]),Me=b.useCallback((se,Be="stroke")=>{Be==="stroke"?u(se):Be==="component"?I(se):Be==="power"?q(se):Be==="ground"&&V(se)},[]);return{selectedIds:c,setSelectedIds:u,isSelecting:g,setIsSelecting:d,selectedComponentIds:R,setSelectedComponentIds:I,selectedPowerIds:xe,setSelectedPowerIds:q,selectedGroundIds:p,setSelectedGroundIds:V,clearSelection:ue,addToSelection:he,removeFromSelection:Ce,setSelection:Me}}function _x(){const[c,u]=b.useState(null),[g,d]=b.useState(!1),[R,I]=b.useState(null),[xe,q]=b.useState("nudge"),p=b.useCallback((ue,he)=>{u(ue),d(!0),I(he)},[]),V=b.useCallback(()=>{d(!1),u(null),I(null)},[]);return{selectedImageForTransform:c,setSelectedImageForTransform:u,isTransforming:g,setIsTransforming:d,transformStartPos:R,setTransformStartPos:I,transformMode:xe,setTransformMode:q,startTransform:p,stopTransform:V}}function Hx(){const[c,u]=b.useState(null),[g,d]=b.useState(null),[R,I]=b.useState("overlay"),[xe,q]=b.useState(50),[p,V]=b.useState(!1),[ue,he]=b.useState(2e3),[Ce,Me]=b.useState(!1),se=b.useCallback(te=>{u(te)},[]),Be=b.useCallback(te=>{d(te)},[]),B=b.useCallback(()=>{u(null),d(null)},[]);return{topImage:c,setTopImage:u,bottomImage:g,setBottomImage:d,currentView:R,setCurrentView:I,transparency:xe,setTransparency:q,isTransparencyCycling:p,setIsTransparencyCycling:V,transparencyCycleSpeed:ue,setTransparencyCycleSpeed:he,isGrayscale:Ce,setIsGrayscale:Me,loadTopImage:se,loadBottomImage:Be,clearImages:B}}function Ix(){const[c,u]=b.useState(1),[g,d]=b.useState({x:0,y:0}),[R,I]=b.useState(!1),[xe,q]=b.useState(!1),p=b.useCallback(()=>{u(1),d({x:0,y:0})},[]),V=b.useCallback((se=1.2)=>{u(Be=>Be*se)},[]),ue=b.useCallback((se=1.2)=>{u(Be=>Be/se)},[]),he=b.useCallback(se=>{u(se)},[]),Ce=b.useCallback((se,Be)=>{d(B=>({x:B.x+se,y:B.y+Be}))},[]),Me=b.useCallback((se,Be)=>{d({x:se,y:Be})},[]);return{viewScale:c,setViewScale:u,viewPan:g,setViewPan:d,isShiftConstrained:R,setIsShiftConstrained:I,showBothLayers:xe,setShowBothLayers:q,resetView:p,zoomIn:V,zoomOut:ue,setZoom:he,pan:Ce,setPan:Me}}function Rt(c,u,g,d){if(u==="power"){const I=c[u]||"";return typeof I=="string"&&I.trim()!==""?{value:I.replace(/W$/i,"").trim(),unit:"W"}:{value:"",unit:"W"}}if(c[u]!==void 0||c[g]!==void 0)return{value:c[u]||"",unit:c[g]||d};const R=c[u]||"";return typeof R=="string"&&R.trim()!==""?Vx(R):{value:"",unit:d}}function Vx(c){if(!c||c.trim()==="")return{value:"",unit:""};const u=c.trim(),g=u.match(/^([\d]+\/[\d]+)\s*([a-zA-ZuW]+)?$/);if(g)return{value:g[1],unit:g[2]||""};const d=u.match(/^([\d.]+)\s*([a-zA-ZuW]+)?$/);return d?{value:d[1],unit:d[2]||""}:{value:u,unit:""}}function Wx(){const[c,u]=b.useState([]),[g,d]=b.useState([]),[R,I]=b.useState(null),[xe,q]=b.useState(null),[p,V]=b.useState(null),[ue,he]=b.useState(!1),[Ce,Me]=b.useState(null),se=b.useCallback((J,ne)=>{ne==="top"?u(M=>[...M,J]):d(M=>[...M,J])},[]),Be=b.useCallback((J,ne,M)=>{M==="top"?u(z=>z.map(D=>D.id===J?{...D,...ne}:D)):d(z=>z.map(D=>D.id===J?{...D,...ne}:D))},[]),B=b.useCallback((J,ne)=>{ne==="top"?u(M=>M.filter(z=>z.id!==J)):d(M=>M.filter(z=>z.id!==J))},[]),te=b.useCallback((J,ne)=>{const M=J.designator||"",z=J.abbreviation||(M.length>0?M.charAt(0).toUpperCase():""),D={visible:!0,layer:ne,id:J.id,designator:M,abbreviation:z,manufacturer:"manufacturer"in J&&J.manufacturer||"",partNumber:"partNumber"in J&&J.partNumber||"",pinCount:J.pinCount,x:J.x,y:J.y,orientation:J.orientation??0,description:J.description||""};if(J.componentType==="Resistor"){const P=J,E=Rt(P,"resistance","resistanceUnit",Ze("resistance"));D.resistance=E.value,D.resistanceUnit=E.unit;const pe=Rt(P,"power","powerUnit","W");D.power=pe.value||"1/4",D.tolerance=P.tolerance||"5%"}else if(J.componentType==="Capacitor"){const P=J,E=Rt(P,"capacitance","capacitanceUnit",Ze("capacitance"));D.capacitance=E.value,D.capacitanceUnit=E.unit;const pe=Rt(P,"voltage","voltageUnit",Ze("voltage"));D.voltage=pe.value,D.voltageUnit=pe.unit,D.tolerance=P.tolerance||"10%",D.dielectric=P.dielectric||"Ceramic"}else if(J.componentType==="Electrolytic Capacitor"){const P=J,E=Rt(P,"capacitance","capacitanceUnit",Ze("capacitance"));D.capacitance=E.value,D.capacitanceUnit=E.unit;const pe=Rt(P,"voltage","voltageUnit",Ze("voltage"));D.voltage=pe.value,D.voltageUnit=pe.unit,D.tolerance=P.tolerance||"20%",D.polarityCapacitor=P.polarity||"Positive";const W=Rt(P,"esr","esrUnit",Ze("esr"));D.esr=W.value,D.esrUnit=W.unit,D.temperature=P.temperature||""}else if(J.componentType==="Film Capacitor"){const P=J,E=Rt(P,"capacitance","capacitanceUnit",Ze("capacitance"));D.capacitance=E.value,D.capacitanceUnit=E.unit;const pe=Rt(P,"voltage","voltageUnit",Ze("voltage"));D.voltage=pe.value,D.voltageUnit=pe.unit,D.tolerance=P.tolerance||"10%",D.filmType=P.filmType||"Polyester"}else if(J.componentType==="Diode"){const P=J;D.diodeType=P.diodeType||"Standard";const E=Rt(P,"voltage","voltageUnit",Ze("voltage"));D.voltage=E.value,D.voltageUnit=E.unit;const pe=Rt(P,"current","currentUnit",Ze("current"));D.current=pe.value,D.currentUnit=pe.unit,D.ledColor=P.ledColor||""}else if(J.componentType==="Battery"){const P=J,E=Rt(P,"voltage","voltageUnit",Ze("voltage"));D.voltage=E.value,D.voltageUnit=E.unit;const pe=Rt(P,"capacity","capacityUnit",Ze("capacity"));D.capacity=pe.value,D.capacityUnit=pe.unit,D.chemistry=P.chemistry||"Li-ion"}else if(J.componentType==="Fuse"){const P=J,E=Rt(P,"current","currentUnit",Ze("current"));D.current=E.value,D.currentUnit=E.unit;const pe=Rt(P,"voltage","voltageUnit",Ze("voltage"));D.voltage=pe.value,D.voltageUnit=pe.unit,D.fuseType=P.fuseType||"Fast-blow"}else if(J.componentType==="FerriteBead"){const P=J,E=Rt(P,"impedance","impedanceUnit",Ze("impedance"));D.impedance=E.value,D.impedanceUnit=E.unit;const pe=Rt(P,"current","currentUnit",Ze("current"));D.current=pe.value,D.currentUnit=pe.unit}else if(J.componentType==="Connector"){const P=J;D.connectorType=P.connectorType||"",D.gender=P.gender||"N/A"}else if(J.componentType==="Jumper"){const P=J;D.positions=P.positions||3}else if(J.componentType==="Relay"){const P=J,E=Rt(P,"coilVoltage","coilVoltageUnit",Ze("coilVoltage"));D.coilVoltage=E.value,D.coilVoltageUnit=E.unit,D.contactType=P.contactType||"SPST";const pe=Rt(P,"current","currentUnit",Ze("current"));D.current=pe.value,D.currentUnit=pe.unit}else if(J.componentType==="Inductor"){const P=J,E=Rt(P,"inductance","inductanceUnit",Ze("inductance"));D.inductance=E.value,D.inductanceUnit=E.unit;const pe=Rt(P,"current","currentUnit",Ze("current"));D.current=pe.value,D.currentUnit=pe.unit;const W=Rt(P,"resistance","resistanceUnit",Ze("resistance"));D.resistance=W.value,D.resistanceUnit=W.unit}else if(J.componentType==="Speaker"){const P=J,E=Rt(P,"impedance","impedanceUnit",Ze("impedance"));D.impedance=E.value,D.impedanceUnit=E.unit;const pe=Rt(P,"power","powerUnit","W");D.power=pe.value||"1"}else if(J.componentType==="Motor"){const P=J;D.motorType=P.motorType||"DC";const E=Rt(P,"voltage","voltageUnit",Ze("voltage"));D.voltage=E.value,D.voltageUnit=E.unit;const pe=Rt(P,"current","currentUnit",Ze("current"));D.current=pe.value,D.currentUnit=pe.unit}else if(J.componentType==="PowerSupply"){const P=J,E=Rt(P,"inputVoltage","inputVoltageUnit",Ze("inputVoltage"));D.inputVoltage=E.value,D.inputVoltageUnit=E.unit;const pe=Rt(P,"outputVoltage","outputVoltageUnit",Ze("outputVoltage"));D.outputVoltage=pe.value,D.outputVoltageUnit=pe.unit;const W=Rt(P,"current","currentUnit",Ze("current"));D.current=W.value,D.currentUnit=W.unit}else if(J.componentType==="Transistor"){const P=J;D.transistorType=P.transistorType||"BJT",D.polarity=P.polarity||"NPN";const E=Rt(P,"voltage","voltageUnit",Ze("voltage"));D.voltage=E.value,D.voltageUnit=E.unit;const pe=Rt(P,"current","currentUnit",Ze("current"));D.current=pe.value,D.currentUnit=pe.unit}else if(J.componentType==="ResistorNetwork"){const P=J,E=Rt(P,"resistance","resistanceUnit",Ze("resistance"));D.resistance=E.value,D.resistanceUnit=E.unit,D.configuration=P.configuration||""}else if(J.componentType==="Thermistor"){const P=J,E=Rt(P,"resistance","resistanceUnit",Ze("resistance"));D.resistance=E.value,D.resistanceUnit=E.unit,D.thermistorType=P.thermistorType||"NTC",D.beta=P.beta||""}else if(J.componentType==="Switch"){const P=J;D.switchType=P.switchType||"Toggle";const E=Rt(P,"current","currentUnit",Ze("current"));D.current=E.value,D.currentUnit=E.unit;const pe=Rt(P,"voltage","voltageUnit",Ze("voltage"));D.voltage=pe.value,D.voltageUnit=pe.unit}else if(J.componentType==="Transformer"){const P=J,E=Rt(P,"primaryVoltage","primaryVoltageUnit",Ze("primaryVoltage"));D.primaryVoltage=E.value,D.primaryVoltageUnit=E.unit;const pe=Rt(P,"secondaryVoltage","secondaryVoltageUnit",Ze("secondaryVoltage"));D.secondaryVoltage=pe.value,D.secondaryVoltageUnit=pe.unit;const W=Rt(P,"power","powerUnit",Ze("power"));D.power=W.value||"1",D.turns=P.turns||""}else if(J.componentType==="TestPoint"){const P=J;D.signal=P.signal||""}else if(J.componentType==="IntegratedCircuit"){const P=J;D.description=P.description||J.designator||"",D.datasheet=P.datasheet||"",D.icType=P.icType||"Op-Amp"}else if(J.componentType==="VacuumTube"){const P=J;D.tubeType=P.tubeType||""}else if(J.componentType==="VariableResistor"){const P=J;D.vrType=P.vrType||"Potentiometer";const E=Rt(P,"resistance","resistanceUnit",Ze("resistance"));D.resistance=E.value,D.resistanceUnit=E.unit;const pe=Rt(P,"power","powerUnit",Ze("power"));D.power=pe.value||"1/4",D.taper=P.taper||""}else if(J.componentType==="Crystal"){const P=J;D.frequency=P.frequency||"",D.loadCapacitance=P.loadCapacitance||"",D.tolerance=P.tolerance||""}else if(J.componentType==="ZenerDiode"){const P=J,E=Rt(P,"voltage","voltageUnit",Ze("voltage"));D.voltage=E.value,D.voltageUnit=E.unit;const pe=Rt(P,"power","powerUnit",Ze("power"));D.power=pe.value||"1/4",D.tolerance=P.tolerance||"5%"}I(D)},[]),Le=b.useCallback(()=>{I(null),q(null)},[]);return{componentsTop:c,setComponentsTop:u,componentsBottom:g,setComponentsBottom:d,componentEditor:R,setComponentEditor:I,connectingPin:xe,setConnectingPin:q,componentDialogPosition:p,setComponentDialogPosition:V,isDraggingDialog:ue,setIsDraggingDialog:he,dialogDragOffset:Ce,setDialogDragOffset:Me,addComponent:se,updateComponent:Be,removeComponent:B,openComponentEditor:te,closeComponentEditor:Le}}function Fx(){const[c,u]=b.useState(()=>[{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),[g,d]=b.useState(()=>[{id:"groundbus-circuit",name:"GND",color:"#000000"}]),[R,I]=b.useState([]),[xe,q]=b.useState([]),[p,V]=b.useState(null),[ue,he]=b.useState(null),Ce=b.useCallback(z=>{u(D=>[...D,z])},[]),Me=b.useCallback((z,D)=>{u(P=>P.map(E=>E.id===z?{...E,...D}:E))},[]),se=b.useCallback(z=>{u(D=>D.filter(P=>P.id!==z)),I(D=>D.filter(P=>P.powerBusId!==z))},[]),Be=b.useCallback(z=>{I(D=>[...D,z])},[]),B=b.useCallback(z=>{I(D=>D.filter(P=>P.id!==z))},[]),te=b.useCallback(z=>{q(D=>[...D,z])},[]),Le=b.useCallback(z=>{q(D=>D.filter(P=>P.id!==z))},[]),J=b.useCallback(z=>{d(D=>[...D,z])},[]),ne=b.useCallback((z,D)=>{d(P=>P.map(E=>E.id===z?{...E,...D}:E))},[]),M=b.useCallback(z=>{d(D=>D.filter(P=>P.id!==z)),q(D=>D.filter(P=>P.groundBusId===z))},[]);return{powerBuses:c,setPowerBuses:u,groundBuses:g,setGroundBuses:d,powerSymbols:R,setPowerSymbols:I,groundSymbols:xe,setGroundSymbols:q,powerEditor:p,setPowerEditor:V,groundEditor:ue,setGroundEditor:he,addPowerBus:Ce,updatePowerBus:Me,removePowerBus:se,addPowerSymbol:Be,removePowerSymbol:B,addGroundSymbol:te,removeGroundSymbol:Le,addGroundBus:J,updateGroundBus:ne,removeGroundBus:M}}const Dt={brushColor:"#008080",brushSize:6,topTraceColor:"#AA4499",bottomTraceColor:"#F781BF",topTraceSize:6,bottomTraceSize:6,viaSize:18,viaColor:"#ff0000",topPadColor:"#0072B2",bottomPadColor:"#56B4E9",topPadSize:18,bottomPadSize:18,topTestPointColor:"#FFFF00",bottomTestPointColor:"#FFFF00",topTestPointSize:18,bottomTestPointSize:18,topComponentColor:"#8C564B",bottomComponentColor:"#9C755F",topComponentSize:18,bottomComponentSize:18,componentConnectionColor:"#E69F00",componentConnectionSize:3};function Lx(){const[c,u]=b.useState(Dt.brushColor),[g,d]=b.useState(Dt.brushSize),[R,I]=b.useState(Dt.topTraceColor),[xe,q]=b.useState(Dt.bottomTraceColor),[p,V]=b.useState(Dt.topTraceSize),[ue,he]=b.useState(Dt.bottomTraceSize),[Ce,Me]=b.useState(Dt.topPadColor),[se,Be]=b.useState(Dt.bottomPadColor),[B,te]=b.useState(Dt.topPadSize),[Le,J]=b.useState(Dt.bottomPadSize),[ne,M]=b.useState(Dt.topTestPointColor),[z,D]=b.useState(Dt.bottomTestPointColor),[P,E]=b.useState(Dt.topTestPointSize),[pe,W]=b.useState(Dt.bottomTestPointSize),[j,me]=b.useState(Dt.topComponentColor),[be,re]=b.useState(Dt.bottomComponentColor),[_,O]=b.useState(Dt.topComponentSize),[Y,je]=b.useState(Dt.bottomComponentSize),[L,S]=b.useState(Dt.componentConnectionColor),[A,$]=b.useState(Dt.componentConnectionSize),Z=b.useCallback(()=>{u(Dt.brushColor),d(Dt.brushSize),I(Dt.topTraceColor),q(Dt.bottomTraceColor),V(Dt.topTraceSize),he(Dt.bottomTraceSize),Me(Dt.topPadColor),Be(Dt.bottomPadColor),te(Dt.topPadSize),J(Dt.bottomPadSize),M(Dt.topTestPointColor),D(Dt.bottomTestPointColor),E(Dt.topTestPointSize),W(Dt.bottomTestPointSize),me(Dt.topComponentColor),re(Dt.bottomComponentColor),O(Dt.topComponentSize),je(Dt.bottomComponentSize),S(Dt.componentConnectionColor),$(Dt.componentConnectionSize)},[]),Oe=b.useCallback(Pe=>{Pe.brushColor!==void 0&&u(Pe.brushColor),Pe.brushSize!==void 0&&d(Pe.brushSize),Pe.topTraceColor!==void 0&&I(Pe.topTraceColor),Pe.bottomTraceColor!==void 0&&q(Pe.bottomTraceColor),Pe.topTraceSize!==void 0&&V(Pe.topTraceSize),Pe.bottomTraceSize!==void 0&&he(Pe.bottomTraceSize),Pe.topPadColor!==void 0&&Me(Pe.topPadColor),Pe.bottomPadColor!==void 0&&Be(Pe.bottomPadColor),Pe.topPadSize!==void 0&&te(Pe.topPadSize),Pe.bottomPadSize!==void 0&&J(Pe.bottomPadSize),Pe.topTestPointColor!==void 0&&M(Pe.topTestPointColor),Pe.bottomTestPointColor!==void 0&&D(Pe.bottomTestPointColor),Pe.topTestPointSize!==void 0&&E(Pe.topTestPointSize),Pe.bottomTestPointSize!==void 0&&W(Pe.bottomTestPointSize),Pe.topComponentColor!==void 0&&me(Pe.topComponentColor),Pe.bottomComponentColor!==void 0&&re(Pe.bottomComponentColor),Pe.topComponentSize!==void 0&&O(Pe.topComponentSize),Pe.bottomComponentSize!==void 0&&je(Pe.bottomComponentSize),Pe.componentConnectionColor!==void 0&&S(Pe.componentConnectionColor),Pe.componentConnectionSize!==void 0&&$(Pe.componentConnectionSize)},[]),Ge=b.useCallback((Pe,_n,Mn)=>{},[]),Xe=b.useCallback((Pe,_n,Mn)=>{},[]),xt=b.useCallback(()=>({brushColor:c,brushSize:g,topTraceColor:R,bottomTraceColor:xe,topTraceSize:p,bottomTraceSize:ue,viaSize:Dt.viaSize,viaColor:Dt.viaColor,topPadColor:Ce,bottomPadColor:se,topPadSize:B,bottomPadSize:Le,topTestPointColor:ne,bottomTestPointColor:z,topTestPointSize:P,bottomTestPointSize:pe,topComponentColor:j,bottomComponentColor:be,topComponentSize:_,bottomComponentSize:Y,componentConnectionColor:L,componentConnectionSize:A}),[c,g,R,xe,p,ue,Ce,se,B,Le,ne,z,P,pe,j,be,_,Y,L,A]);return{brushColor:c,setBrushColor:u,brushSize:g,setBrushSize:d,topTraceColor:R,setTopTraceColor:I,bottomTraceColor:xe,setBottomTraceColor:q,topTraceSize:p,setTopTraceSize:V,bottomTraceSize:ue,setBottomTraceSize:he,topPadColor:Ce,setTopPadColor:Me,bottomPadColor:se,setBottomPadColor:Be,topPadSize:B,setTopPadSize:te,bottomPadSize:Le,setBottomPadSize:J,topTestPointColor:ne,setTopTestPointColor:M,bottomTestPointColor:z,setBottomTestPointColor:D,topTestPointSize:P,setTopTestPointSize:E,bottomTestPointSize:pe,setBottomTestPointSize:W,topComponentColor:j,setTopComponentColor:me,bottomComponentColor:be,setBottomComponentColor:re,topComponentSize:_,setTopComponentSize:O,bottomComponentSize:Y,setBottomComponentSize:je,componentConnectionColor:L,setComponentConnectionColor:S,componentConnectionSize:A,setComponentConnectionSize:$,resetToDefaults:Z,loadFromProject:Oe,getCurrentSettings:xt,saveDefaultSize:Ge,saveDefaultColor:Xe}}function $x(c,u,g,d,R,I,xe,q,p,V,ue,he,Ce,Me,se,Be,B,te,Le,J,ne,M,z,D,P){const[E,pe]=b.useState(()=>c()),W=b.useRef(null),j=b.useRef(d),me=b.useRef(R),be=b.useCallback(O=>u==="draw"&&g==="trace"?O.get("trace"):u==="draw"&&g==="via"?O.get("via"):u==="draw"&&g==="pad"?O.get("pad"):u==="component"?O.get("component"):u==="power"?O.get("power"):u==="ground"?O.get("ground"):null,[u,g]);b.useEffect(()=>{pe(O=>{const Y=be(O),je=Y?.id||null,L=W.current,S=new Map(O);if(L&&L!==je){const A=O.get(L);A&&S.set(L,{...A,settings:{color:j.current,size:me.current}})}if(Y&&je!==L)if(u==="draw"&&g==="trace"){const A=M||"top",$=A==="top"?I:xe,Z=A==="top"?q:p;j.current=$,me.current=Z,S.set("trace",{...Y,settings:{color:$,size:Z}})}else if(u==="draw"&&g==="pad"){const A=z||"top",$=A==="top"?V:ue,Z=A==="top"?he:Ce;j.current=$,me.current=Z,S.set("pad",{...Y,settings:{color:$,size:Z}})}else if(u==="component"){const A=P||"top",$=A==="top"?te:Le,Z=A==="top"?J:ne;j.current=$,me.current=Z,S.set("component",{...Y,settings:{color:$,size:Z}})}else j.current=Y.settings.color,me.current=Y.settings.size;return W.current=je,S})},[u,g,d,R,I,xe,q,p,V,ue,he,Ce,te,Le,J,ne,M,z,P,be]);const re=b.useCallback((O,Y)=>{pe(je=>{const L=new Map(je),S=L.get(O);return S&&L.set(O,{...S,settings:Y}),L})},[]),_=b.useCallback((O,Y,je)=>{pe(L=>{const S=new Map(L),A=S.get(O);if(A){const $=new Map(A.layerSettings);$.set(Y,je),S.set(O,{...A,layerSettings:$})}return S})},[]);return{toolRegistry:E,setToolRegistry:pe,updateToolSettings:re,updateToolLayerSettings:_,getCurrentToolDef:be}}function Yx(c){const{currentTool:u,drawingMode:g,traceToolLayer:d,padToolLayer:R,testPointToolLayer:I,componentToolLayer:xe}=c,[q,p]=b.useState(0),V=b.useCallback(()=>u==="draw"&&g==="via"?"via":u==="draw"&&g==="pad"?R==="bottom"?"padBottom":"padTop":u==="draw"&&g==="testPoint"?I==="bottom"?"testPointBottom":"testPointTop":u==="draw"&&g==="trace"?d==="bottom"?"traceBottom":"traceTop":u==="component"?xe==="bottom"?"componentBottom":"componentTop":u==="power"?"power":u==="ground"?"ground":null,[u,g,R,I,d,xe]),ue=b.useCallback(()=>{const se=V();if(se){const Be=At.get(se);return{currentTool:u,drawingMode:g,layer:u==="draw"&&g==="pad"?R||"top":u==="draw"&&g==="testPoint"?I||"top":u==="draw"&&g==="trace"?d||"top":u==="component"?xe||"top":void 0,toolInstanceId:se,color:Be.color,size:Be.size}}return{currentTool:u,drawingMode:g,layer:void 0,toolInstanceId:null,color:"#000000",size:10}},[u,g,R,I,d,xe,V]);b.useEffect(()=>{const se=V();return se?At.subscribe(se,()=>{p(B=>B+1)}):void 0},[V]);const he=ue(),Ce=b.useCallback(se=>{const Be=V();Be&&At.setColor(Be,se)},[V]),Me=b.useCallback(se=>{const Be=V();Be&&At.setSize(Be,se)},[V]);return{toolState:he,setColor:Ce,setSize:Me,getCurrentToolInstanceId:V}}function Xx(){const[c,u]=b.useState(!1),[g,d]=b.useState(!1),[R,I]=b.useState(!1),[xe,q]=b.useState(!1),[p,V]=b.useState(!1),[ue,he]=b.useState(!1),[Ce,Me]=b.useState(!1),[se,Be]=b.useState(!1),B=b.useCallback(()=>{u(!0),d(!0),I(!0),q(!0),V(!0),he(!0),Me(!0),Be(!0)},[]),te=b.useCallback(()=>{u(!1),d(!1),I(!1),q(!1),V(!1),he(!1),Me(!1),Be(!1)},[]);return{areImagesLocked:c,setAreImagesLocked:u,areViasLocked:g,setAreViasLocked:d,arePadsLocked:R,setArePadsLocked:I,areTestPointsLocked:xe,setAreTestPointsLocked:q,areTracesLocked:p,setAreTracesLocked:V,areComponentsLocked:ue,setAreComponentsLocked:he,areGroundNodesLocked:Ce,setAreGroundNodesLocked:Me,arePowerNodesLocked:se,setArePowerNodesLocked:Be,lockAll:B,unlockAll:te}}function Gx(){const[c,u]=b.useState(null),[g,d]=b.useState({visible:!1,size:6}),[R,I]=b.useState({visible:!1,interval:5}),[xe,q]=b.useState({visible:!1,source:null,interval:5}),[p,V]=b.useState({visible:!1,text:""}),[ue,he]=b.useState({visible:!1,title:"",message:""}),[Ce,Me]=b.useState({visible:!1}),[se,Be]=b.useState({visible:!1}),[B,te]=b.useState({visible:!1,projectName:"",locationPath:"",locationHandle:null}),[Le,J]=b.useState({visible:!1,filename:"",locationPath:"",locationHandle:null}),[ne,M]=b.useState(!1),[z,D]=b.useState(!0),[P,E]=b.useState(!1);return{openMenu:c,setOpenMenu:u,setSizeDialog:g,setSetSizeDialog:d,autoSaveDialog:R,setAutoSaveDialog:I,autoSavePromptDialog:xe,setAutoSavePromptDialog:q,debugDialog:p,setDebugDialog:V,errorDialog:ue,setErrorDialog:he,newProjectDialog:Ce,setNewProjectDialog:Me,openProjectDialog:se,setOpenProjectDialog:Be,newProjectSetupDialog:B,setNewProjectSetupDialog:te,saveAsDialog:Le,setSaveAsDialog:J,showColorPicker:ne,setShowColorPicker:M,showWelcomeDialog:z,setShowWelcomeDialog:D,transformImagesDialogVisible:P,setTransformImagesDialogVisible:E}}function qx(){const[c,u]=b.useState(!1),[g,d]=b.useState(1),[R,I]=b.useState(null),[xe,q]=b.useState(""),[p,V]=b.useState(""),[ue,he]=b.useState(null),[Ce,Me]=b.useState("pcb_project"),[se,Be]=b.useState([]),[B,te]=b.useState(-1),Le=b.useRef(null),J=b.useRef(!1),ne=b.useRef(!1);return{autoSaveEnabled:c,setAutoSaveEnabled:u,autoSaveInterval:g,setAutoSaveInterval:d,autoSaveDirHandle:R,setAutoSaveDirHandle:I,autoSaveBaseName:xe,setAutoSaveBaseName:q,currentProjectFilePath:p,setCurrentProjectFilePath:V,projectDirHandle:ue,setProjectDirHandle:he,projectName:Ce,setProjectName:Me,autoSaveFileHistory:se,setAutoSaveFileHistory:Be,currentFileIndex:B,setCurrentFileIndex:te,autoSaveIntervalRef:Le,hasChangesSinceLastAutoSaveRef:J,prevAutoSaveEnabledRef:ne}}function Zx(){const[c,u]=b.useState(null),g=b.useRef(!1),d=b.useCallback((q,p,V,ue,he)=>{if(g.current)return;const Ce={drawingStrokes:JSON.parse(JSON.stringify(q)),componentsTop:JSON.parse(JSON.stringify(p)),componentsBottom:JSON.parse(JSON.stringify(V)),powerSymbols:JSON.parse(JSON.stringify(ue)),groundSymbols:JSON.parse(JSON.stringify(he))};u(Ce)},[]),R=b.useCallback(()=>{if(!c)return null;g.current=!0;const q=c;return u(null),setTimeout(()=>{g.current=!1},100),q},[c]),I=c!==null,xe=b.useCallback(()=>{u(null)},[]);return{saveSnapshot:d,undo:R,canUndo:I,clearSnapshot:xe}}function Kx(){const u=Hx(),{topImage:g,setTopImage:d,bottomImage:R,setBottomImage:I,currentView:xe,setCurrentView:q,transparency:p,setTransparency:V,isTransparencyCycling:ue,setIsTransparencyCycling:he,transparencyCycleSpeed:Ce,setTransparencyCycleSpeed:Me,isGrayscale:se,setIsGrayscale:Be}=u,[B,te]=b.useState("none"),Le=Lx(),{brushColor:J,setBrushColor:ne,brushSize:M,setBrushSize:z,topTraceColor:D,setTopTraceColor:P,bottomTraceColor:E,setBottomTraceColor:pe,topTraceSize:W,setTopTraceSize:j,bottomTraceSize:me,setBottomTraceSize:be,topPadColor:re,setTopPadColor:_,bottomPadColor:O,setBottomPadColor:Y,topPadSize:je,setTopPadSize:L,bottomPadSize:S,setBottomPadSize:A,topTestPointColor:$,setTopTestPointColor:Z,bottomTestPointColor:Oe,setBottomTestPointColor:Ge,topTestPointSize:Xe,setTopTestPointSize:xt,bottomTestPointSize:Pe,setBottomTestPointSize:_n,topComponentColor:Mn,setTopComponentColor:Vi,bottomComponentColor:Di,setBottomComponentColor:yi,topComponentSize:Ai,setTopComponentSize:Nl,bottomComponentSize:el,setBottomComponentSize:Ql,componentConnectionColor:mo,setComponentConnectionColor:ir,componentConnectionSize:Yo,setComponentConnectionSize:Lc,saveDefaultSize:Je,saveDefaultColor:ut}=Le,$c=Ox(),{drawingStrokes:He,setDrawingStrokes:Pt,isDrawing:Jl,setIsDrawing:vo,currentStroke:Xt,setCurrentStroke:bi,tracePreviewMousePos:Ml,setTracePreviewMousePos:Wi,drawingMode:Ne,setDrawingMode:Yn,selectedDrawingLayer:lt,setSelectedDrawingLayer:Cn,currentStrokeRef:So,lastTraceClickTimeRef:lr,isDoubleClickingTraceRef:eo}=$c,Sa=_x(),{selectedImageForTransform:Bt,setSelectedImageForTransform:Fi,isTransforming:to,setIsTransforming:Li,transformStartPos:gs,setTransformStartPos:$i,transformMode:dl,setTransformMode:no}=Sa,$r=Ix(),{viewScale:Fe,setViewScale:mi,viewPan:kt,setViewPan:Hn,isShiftConstrained:xs,setIsShiftConstrained:or,showBothLayers:ar,setShowBothLayers:ul}=$r,[ft,Bn]=b.useState("top"),[Lt,wa]=b.useState("top"),[ln,sr]=b.useState("top"),[vn,wo]=b.useState("top"),Xo=_e.useRef("top"),Bl=_e.useRef("top"),Ul=_e.useRef("top"),Pl=_e.useRef("top");_e.useEffect(()=>{Xo.current=ft},[ft]),_e.useEffect(()=>{Bl.current=Lt},[Lt]),_e.useEffect(()=>{Ul.current=ln},[ln]),_e.useEffect(()=>{Pl.current=vn},[vn]);const Go=Yx({currentTool:B,drawingMode:Ne,traceToolLayer:ft,padToolLayer:Lt,testPointToolLayer:ln,componentToolLayer:vn}),{toolState:Ot}=Go,Yr=$x(px,B,Ne,J,M,D,E,W,me,re,O,je,S,$,Oe,Xe,Pe,Mn,Di,Ai,el,ft,Lt,ln,vn),{toolRegistry:Ht,setToolRegistry:on,getCurrentToolDef:fl,updateToolSettings:Xr,updateToolLayerSettings:qo}=Yr,rr=_e.useRef(null),tl=_e.useRef(J),vi=_e.useRef(M);_e.useEffect(()=>{on(o=>{const r=fl(o),f=r?.id||null,m=rr.current,y=new Map(o);if(m&&m!==f){const v=o.get(m);v&&y.set(m,{...v,settings:{color:tl.current,size:vi.current}})}if(r&&f!==m)if(B==="draw"&&Ne==="trace"){const v=ft||"top",x=v==="top"?D:E,T=v==="top"?W:me;ne(x),z(T),tl.current=x,vi.current=T;const C=new Map(r.layerSettings);C.set("top",{color:D,size:W}),C.set("bottom",{color:E,size:me}),y.set("trace",{...r,settings:{color:x,size:T},layerSettings:C})}else if(B==="draw"&&Ne==="pad"){const v=Lt||"top",x=v==="top"?re:O,T=v==="top"?je:S;ne(x),z(T),tl.current=x,vi.current=T;const C=new Map(r.layerSettings);C.set("top",{color:re,size:je}),C.set("bottom",{color:O,size:S}),y.set("pad",{...r,settings:{color:x,size:T},layerSettings:C})}else if(B==="draw"&&Ne==="testPoint"){const v=ln||"top",x=v==="top"?$:Oe,T=v==="top"?Xe:Pe;ne(x),z(T),tl.current=x,vi.current=T;const C=new Map(r.layerSettings);C.set("top",{color:$,size:Xe}),C.set("bottom",{color:Oe,size:Pe}),y.set("testPoint",{...r,settings:{color:x,size:T},layerSettings:C})}else if(B==="component"){const v=vn||"top",x=v==="top"?Mn:Di,T=v==="top"?Ai:el;ne(x),z(T),tl.current=x,vi.current=T;const C=new Map(r.layerSettings);C.set("top",{color:Mn,size:Ai}),C.set("bottom",{color:Di,size:el}),y.set("component",{...r,settings:{color:x,size:T},layerSettings:C})}else{const v=r.settings;ne(v.color),z(v.size),tl.current=v.color,vi.current=v.size}return rr.current=f,y})},[B,Ne,fl,D,E,W,me,re,O,je,S,$,Oe,Xe,Pe,ln,Mn,Di,Ai,el]),_e.useEffect(()=>{const o=Ht.get("trace");if(o){const y=o.layerSettings.get("top"),v=o.layerSettings.get("bottom");y&&(P(y.color),j(y.size)),v&&(pe(v.color),be(v.size))}const r=Ht.get("pad");if(r){const y=r.layerSettings.get("top"),v=r.layerSettings.get("bottom");y&&(_(y.color),L(y.size)),v&&(Y(v.color),A(v.size))}const f=Ht.get("testPoint");if(f){const y=f.layerSettings.get("top"),v=f.layerSettings.get("bottom");y&&(Z(y.color),xt(y.size)),v&&(Ge(v.color),_n(v.size))}const m=Ht.get("component");if(m){const y=m.layerSettings.get("top"),v=m.layerSettings.get("bottom");y&&(Vi(y.color),Nl(y.size)),v&&(yi(v.color),Ql(v.size))}},[]),_e.useEffect(()=>{on(o=>{const r=new Map(o),f=o.get("trace");if(f){const T=new Map(f.layerSettings);T.set("top",{color:D,size:W}),T.set("bottom",{color:E,size:me}),r.set("trace",{...f,layerSettings:T})}const m=o.get("pad");if(m){const T=new Map(m.layerSettings);T.set("top",{color:re,size:je}),T.set("bottom",{color:O,size:S}),r.set("pad",{...m,layerSettings:T})}const y=o.get("testPoint");if(y){const T=new Map(y.layerSettings);T.set("top",{color:$,size:Xe}),T.set("bottom",{color:Oe,size:Pe}),r.set("testPoint",{...y,layerSettings:T})}const v=o.get("component");if(v){const T=new Map(v.layerSettings);T.set("top",{color:Mn,size:Ai}),T.set("bottom",{color:Di,size:el}),r.set("component",{...v,layerSettings:T})}const x=o.get("componentConnection");return x&&r.set("componentConnection",{...x,settings:{color:mo,size:Yo}}),r})},[D,E,W,me,re,O,je,S,$,Oe,Xe,Pe,Mn,Di,Ai,el,mo,Yo,on]),_e.useEffect(()=>{on(o=>{const r=fl(o);if(r)if(B==="draw"&&Ne==="trace"){const f=ft||"top";f==="top"?(P(J),j(M),ut("trace",J,"top"),Je("trace",M,"top")):(pe(J),be(M),ut("trace",J,"bottom"),Je("trace",M,"bottom"));const m=new Map(o),y=new Map(r.layerSettings);return y.set(f,{color:J,size:M}),m.set(r.id,{...r,layerSettings:y,settings:{color:J,size:M}}),tl.current=J,vi.current=M,m}else if(B==="draw"&&Ne==="pad"){const f=Lt||"top";f==="top"?(_(J),L(M),ut("pad",J,"top"),Je("pad",M,"top")):(Y(J),A(M),ut("pad",J,"bottom"),Je("pad",M,"bottom"));const m=new Map(o),y=new Map(r.layerSettings);return y.set(f,{color:J,size:M}),m.set(r.id,{...r,layerSettings:y,settings:{color:J,size:M}}),tl.current=J,vi.current=M,m}else if(B==="draw"&&Ne==="testPoint"){const f=ln||"top";f==="top"?(Z(J),xt(M),ut("testPoint",J,"top"),Je("testPoint",M,"top")):(Ge(J),_n(M),ut("testPoint",J,"bottom"),Je("testPoint",M,"bottom"));const m=new Map(o),y=new Map(r.layerSettings);return y.set(f,{color:J,size:M}),m.set(r.id,{...r,layerSettings:y,settings:{color:J,size:M}}),tl.current=J,vi.current=M,m}else if(B==="component"){const f=vn||"top";f==="top"?(Vi(J),Nl(M),ut("component",J,"top"),Je("component",M,"top")):(yi(J),Ql(M),ut("component",J,"bottom"),Je("component",M,"bottom"));const m=new Map(o),y=new Map(r.layerSettings);return y.set(f,{color:J,size:M}),m.set(r.id,{...r,layerSettings:y,settings:{color:J,size:M}}),tl.current=J,vi.current=M,m}else{const f=new Map(o);return f.set(r.id,{...r,settings:{color:J,size:M}}),tl.current=J,vi.current=M,f}return o})},[J,M,B,Ne,ft,Lt,ln,vn,fl,ut,Je,Fc,P,pe,j,be,_,Y,L,A,Z,Ge,xt,_n,Vi,yi,Nl,Ql]),_e.useEffect(()=>{_o(B==="draw"&&Ne==="trace")},[B,Ne]),_e.useEffect(()=>{Za(B==="draw"&&Ne==="pad")},[B,Ne]),_e.useEffect(()=>{ha(B==="draw"&&Ne==="testPoint")},[B,Ne]),_e.useEffect(()=>{Ot.toolInstanceId&&(ne(Ot.color),z(Ot.size))},[Ot.toolInstanceId,Ot.color,Ot.size,ne,z,B,Ne]);const[ja,Xn]=b.useState(void 0),[,Ni]=b.useState([]),[,ys]=b.useState([]),[,Gn]=b.useState([]),[,zn]=b.useState([]),[bs,xn]=b.useState([]),[li,Si]=b.useState([]),[Ta,ms]=b.useState([]),[Ca,Yi]=b.useState([]),Sn=b.useRef(null),Gr=Ex(),{selectedIds:mt,setSelectedIds:we,isSelecting:kn,setIsSelecting:za,selectedComponentIds:vt,setSelectedComponentIds:nt,selectedPowerIds:It,setSelectedPowerIds:st,selectedGroundIds:jt,setSelectedGroundIds:pt}=Gr,Yc=Wx(),{componentsTop:et,setComponentsTop:Qt,componentsBottom:rt,setComponentsBottom:rn,componentEditor:ka,setComponentEditor:Ra,connectingPin:Rn,setConnectingPin:Zo,componentDialogPosition:nl,setComponentDialogPosition:il,isDraggingDialog:cr,setIsDraggingDialog:dr,dialogDragOffset:vs,setDialogDragOffset:ur,openComponentEditor:fr}=Yc,Yd=Fx(),{powerBuses:Ke,setPowerBuses:Mi,groundBuses:Gt,setGroundBuses:Ol,powerSymbols:Bi,setPowerSymbols:oi,groundSymbols:ai,setGroundSymbols:qn,powerEditor:wi,setPowerEditor:Ko}=Yd,$u=Zx(),{saveSnapshot:pl,undo:Xd,clearSnapshot:Qo}=$u;_e.useEffect(()=>{B==="power"?(jn(!1),Ke.length>1?Il&&Ke.some(r=>r.id===Il)?Jn(!1):(Jn(!0),Il!==null&&Va(null)):Ke.length===1?(Va(Ke[0].id),Jn(!1)):(Jn(!0),Va(null))):Jn(!1)},[B,Ke]),_e.useEffect(()=>{B==="ground"?(Jn(!1),Gt.length>1?ei&&Gt.some(r=>r.id===ei)?jn(!1):(jn(!0),ei!==null&&Fa(null)):Gt.length===1?(Fa(Gt[0].id),jn(!1)):(jn(!0),Fa(null))):jn(!1)},[B,Gt]),_e.useEffect(()=>{B!=="power"&&B!=="ground"&&(Jn(!1),jn(!1))},[B]);const Yu=Xx(),{areImagesLocked:Ui,setAreImagesLocked:Ss,areViasLocked:ji,setAreViasLocked:ws,arePadsLocked:Xi,setArePadsLocked:pr,areTestPointsLocked:jo,setAreTestPointsLocked:Xc,areTracesLocked:Ti,setAreTracesLocked:Jo,areComponentsLocked:Gi,setAreComponentsLocked:js,areGroundNodesLocked:qi,setAreGroundNodesLocked:Da,arePowerNodesLocked:wn,setArePowerNodesLocked:Ts}=Yu,Xu=Gx(),{openMenu:Gu,setOpenMenu:hr,setSizeDialog:qr,setSetSizeDialog:Zr,autoSaveDialog:Gc,setAutoSaveDialog:ea,autoSavePromptDialog:Cs,setAutoSavePromptDialog:Pi,debugDialog:zs,setDebugDialog:ta,errorDialog:Kr,setErrorDialog:Aa,newProjectDialog:Qr,setNewProjectDialog:na,openProjectDialog:ia,setOpenProjectDialog:ks,newProjectSetupDialog:tn,setNewProjectSetupDialog:Na,saveAsDialog:pn,setSaveAsDialog:la,showColorPicker:Ma,setShowColorPicker:io,transformImagesDialogVisible:qu,setTransformImagesDialogVisible:Rs}=Xu,Gd=qx(),[qd,lo]=b.useState(!1),[qc,Zc]=b.useState(!1),[Zd,Jr]=b.useState(!1),[Zu,Kd]=b.useState(null),[Ku,Qd]=b.useState(null),{autoSaveEnabled:Oi,setAutoSaveEnabled:yn,autoSaveInterval:hl,setAutoSaveInterval:El,autoSaveDirHandle:To,setAutoSaveDirHandle:Co,autoSaveBaseName:zo,setAutoSaveBaseName:ll,currentProjectFilePath:ec,setCurrentProjectFilePath:Un,projectDirHandle:cn,setProjectDirHandle:Zi,projectName:Zn,setProjectName:gl,autoSaveFileHistory:Ba,setAutoSaveFileHistory:xl,currentFileIndex:tc,setCurrentFileIndex:gr,autoSaveIntervalRef:Vt,hasChangesSinceLastAutoSaveRef:Ei,prevAutoSaveEnabledRef:nc}=Gd,Kc=b.useRef(null),Jd=b.useRef(null),Qc=b.useRef(null),ic=b.useRef(null),xr=b.useRef(null),Ds=b.useRef(null),lc=b.useRef(null),[si,oa]=b.useState(!1),Kn=b.useRef(null),_l=b.useRef(null),[As,Ua]=b.useState(!1),[aa,Pa]=b.useState({}),[sa,Hl]=b.useState(!1),Qn=b.useRef(null),[ko,eu]=b.useState(!1),[ri,Ro]=b.useState(null),[yl,Oa]=b.useState(null),[Do,Ea]=b.useState({width:960,height:600}),oc=b.useRef(null),Jc=b.useRef(null),ed=b.useRef(null),yr=b.useRef(null),Ki=b.useRef(null),_a=b.useRef(null),Ha=b.useRef(null),br=b.useRef(null),[oo,Pn]=b.useState(!0),[ci,di]=b.useState(!0),[hn,ui]=b.useState(!0),[Dn,Ao]=b.useState(!0),[Ci,ao]=b.useState(!0),[Qi,bn]=b.useState(!0),[Ut,Tt]=b.useState(!0),[fi,pi]=b.useState(!0),[bl,ol]=b.useState(!0),[al,so]=b.useState(!0),[hi,_i]=b.useState(!0),[ml,vl]=b.useState(!0),yt=Bi,dt=ai,[No,Sl]=b.useState(!1),[Mo,td]=b.useState(null),[mr,Ia]=b.useState(!1),[ro,Bo]=b.useState(void 0),[gi,vr]=b.useState(!1),[ac,Jn]=b.useState(!1),[Il,Va]=b.useState(null),[In,Wa]=b.useState(!1),[Sr,wr]=b.useState(null),[jr,jn]=b.useState(!1),[ei,Fa]=b.useState(null),[Ns,Tr]=b.useState(!0),[Ms,wl]=b.useState(!1),[nd,La]=b.useState(!1),ra=b.useRef({}),[zi,co]=b.useState(!0),[Vl,Wl]=b.useState(!0),[Bs,sc]=b.useState(!0),[ti,Fl]=b.useState(null),[rc,id]=b.useState(!1),[Uo,Us]=b.useState(null),[Ps,jl]=b.useState(!1),[Po,Cr]=b.useState(null),[Oo,ld]=b.useState(!1),[Ll,cc]=b.useState(null),[$a,Tl]=b.useState([]),[uo,ca]=b.useState(!1),[da,Ya]=b.useState(null),[Xa,Ga]=b.useState(!1),[zr,dc]=b.useState(null),[Os,Es]=b.useState(null),[tu,_s]=b.useState(!1);_e.useEffect(()=>{Ke.length===0&&Mi([{id:"default-3v3",name:"+3.3V",voltage:"+3.3VDC",color:"#ff6600"},{id:"default-5v",name:"+5V",voltage:"+5VDC",color:"#ff0000"}])},[Ke.length,Mi]);const Cl=b.useCallback((o,r)=>{const f=yt.find(y=>y.pointId===o);if(f){const y=r.find(x=>x.id===f.powerBusId);return`Via (${y?y.voltage:f.type||"Power Node"})`}const m=dt.find(y=>y.pointId===o);return m?`Via (${m.type||"Ground"})`:"Via"},[yt,dt]),An=b.useCallback((o,r)=>{const f=yt.find(y=>y.pointId===o);if(f){const y=r.find(x=>x.id===f.powerBusId);return`Pad (${y?y.voltage:f.type||"Power Node"})`}const m=dt.find(y=>y.pointId===o);return m?`Pad (${m.type||"Ground"})`:"Pad"},[yt,dt]),Vn=b.useCallback((o,r)=>{const f=yt.find(y=>y.pointId===o);if(f){const y=r.find(x=>x.id===f.powerBusId);return`Test Point (${y?y.voltage:f.type||"Power Node"})`}const m=dt.find(y=>y.pointId===o);return m?`Test Point (${m.type||"Ground"})`:"Test Point"},[yt,dt]),ua=b.useCallback(()=>{const o=He.filter(r=>r.type==="via").map(r=>r.id);we(new Set(o)),nt(new Set),st(new Set),pt(new Set)},[He,we,nt,st,pt]),od=b.useCallback(()=>{const o=He.filter(r=>r.type==="trace").map(r=>r.id);we(new Set(o)),nt(new Set),st(new Set),pt(new Set)},[He,we,nt,st,pt]),nu=b.useCallback(()=>{const o=He.filter(r=>r.type==="pad").map(r=>r.id);we(new Set(o)),nt(new Set),st(new Set),pt(new Set)},[He,we,nt,st,pt]),fa=b.useCallback(()=>{const o=[...et,...rt].map(r=>r.id);nt(new Set(o)),we(new Set),st(new Set),pt(new Set)},[et,rt,nt,we,st,pt]),sl=b.useCallback(()=>{const o=[...et,...rt].filter(r=>{const f=r.pinConnections||[];return!(f.length>0&&f.length===r.pinCount&&f.every(y=>y&&y.trim()!==""))}).map(r=>r.id);nt(new Set(o)),we(new Set),st(new Set),pt(new Set),ta({visible:!0,text:""})},[et,rt,nt,we,st,pt,ta]),On=b.useCallback(()=>{const o=new Set;let r=0,f=0;for(const k of[...et,...rt]){const N=k.pinConnections||[];r+=k.pinCount||0;for(const U of N)if(U&&U.trim()!==""){const le=parseInt(U.trim(),10);!isNaN(le)&&le>0&&(o.add(le),f++)}}if(console.log(`Component connections: ${f} pins connected, ${o.size} unique Point IDs`),o.size===0){console.log("No component connections found - components may not have pins connected"),alert("No component connections found. Please connect component pins to vias, pads, or traces first.");return}const m=new Map;for(const k of He)if(k.type==="trace"&&k.points.length>=2)for(const N of k.points)N&&N.id!==void 0&&N.id!==null&&(m.has(N.id)||m.set(N.id,new Set),m.get(N.id).add(k.id));const y=new Map;for(const k of He)if((k.type==="via"||k.type==="pad")&&k.points.length>=1){const N=k.points[0]?.id;N!=null&&(y.has(N)||y.set(N,new Set))}for(const k of He)if(k.type==="trace"&&k.points.length>=2){const N=[];for(const U of k.points)U&&U.id!==void 0&&U.id!==null&&N.push(U.id);for(let U=0;U<N.length;U++)for(let le=U+1;le<N.length;le++){const K=N[U],X=N[le];y.has(K)||y.set(K,new Set),y.has(X)||y.set(X,new Set),y.get(K).add(X),y.get(X).add(K)}}const v=new Set,x=new Set,T=k=>{if(v.has(k))return;v.add(k),x.add(k);const N=y.get(k);if(N)for(const U of N)T(U)};for(const k of o)T(k);const C=new Set;for(const k of x){const N=m.get(k);if(N)for(const U of N)C.add(U)}for(const k of He)if((k.type==="via"||k.type==="pad")&&k.points.length>=1){const N=k.points[0]?.id;if(N!=null&&o.has(N)){const U=m.get(N);if(U)for(const le of U)C.add(le)}}if(console.log(`Found ${C.size} traces connected to components`),console.log(`  - Component Point IDs: ${Array.from(o).slice(0,10).join(", ")}${o.size>10?"...":""}`),console.log(`  - Connected Point IDs: ${x.size} total`),console.log(`  - Traces found: ${Array.from(C).slice(0,5).join(", ")}${C.size>5?"...":""}`),C.size===0){const k=Array.from(o).slice(0,5).join(", ");alert(`No traces found connected to components.

Component Point IDs: ${k}${o.size>5?"...":""}

Make sure:
1. Component pins are connected to vias/pads
2. Traces are drawn and snapped to those same vias/pads
3. When drawing traces, click on the vias/pads to snap (this shares the Point ID)`);return}we(C),nt(new Set),st(new Set),pt(new Set),console.log(`Selected ${C.size} traces`)},[et,rt,He,we,nt,st,pt]),$l=b.useCallback((o,r)=>{const f=Sn.current;if(!f)return;const m=f.width-10,y=f.height-10,v=m/2,x=y/2,T=v-o*Fe,C=x-r*Fe;Hn({x:T,y:C})},[Fe,Hn]),Eo=b.useCallback((o,r,f)=>{$l(r,f),nt(new Set([o])),we(new Set),st(new Set),pt(new Set)},[$l,nt,we,st,pt]),Ct=b.useCallback((o,r,f)=>{$l(r,f),we(new Set([o])),nt(new Set),st(new Set),pt(new Set)},[$l,we,nt,st,pt]),nn=b.useCallback((o,r,f)=>{$l(r,f),st(new Set([o])),we(new Set),nt(new Set),pt(new Set)},[$l,st,we,nt,pt]),Wn=b.useCallback((o,r,f)=>{$l(r,f),pt(new Set([o])),we(new Set),nt(new Set),st(new Set)},[$l,pt,we,nt,st]),uc=_e.useMemo(()=>{const o=new Set(yt.map(f=>f.powerBusId).filter(f=>typeof f=="string"&&f.length>0)),r=Ke.filter(f=>o.has(f.id)).map(f=>f.name);return Array.from(new Set(r)).sort()},[yt,Ke]),Hs=_e.useMemo(()=>{const o=new Set(dt.map(f=>f.groundBusId).filter(f=>typeof f=="string"&&f.length>0)),r=Gt.filter(f=>o.has(f.id)).map(f=>f.name);return Array.from(new Set(r)).sort()},[dt,Gt]),qa=b.useCallback(()=>{const o=yt.map(r=>r.id);st(new Set(o)),we(new Set),nt(new Set),pt(new Set)},[yt,st,we,nt,pt]),fc=b.useCallback(()=>{const o=dt.map(r=>r.id);pt(new Set(o)),we(new Set),nt(new Set),st(new Set)},[dt,pt,we,nt,st]),kr=b.useCallback(o=>{const r=Ke.filter(m=>m.name===o).map(m=>m.id);if(r.length===0)return;const f=yt.filter(m=>m.powerBusId&&r.includes(m.powerBusId)).map(m=>m.id);st(new Set(f)),we(new Set),nt(new Set),pt(new Set)},[Ke,yt,st,we,nt,pt]),Is=b.useCallback(o=>{const r=Gt.filter(m=>m.name===o).map(m=>m.id);if(r.length===0)return;const f=dt.filter(m=>m.groundBusId&&r.includes(m.groundBusId)).map(m=>m.id);pt(new Set(f)),we(new Set),nt(new Set),st(new Set)},[Gt,dt,pt,we,nt,st]);b.useCallback(o=>{switch(o.componentType){case"Resistor":case"ResistorNetwork":case"Thermistor":case"VariableResistor":if("resistance"in o&&o.resistance&&"resistanceUnit"in o&&o.resistanceUnit)return`${o.resistance} ${o.resistanceUnit}`;break;case"Capacitor":case"Electrolytic Capacitor":case"Film Capacitor":if("capacitance"in o&&o.capacitance&&"capacitanceUnit"in o&&o.capacitanceUnit)return`${o.capacitance} ${o.capacitanceUnit}`;break;case"Inductor":if("inductance"in o&&o.inductance&&"inductanceUnit"in o&&o.inductanceUnit)return`${o.inductance} ${o.inductanceUnit}`;break;case"Battery":if("voltage"in o&&o.voltage&&"voltageUnit"in o&&o.voltageUnit)return`${o.voltage} ${o.voltageUnit}`;break;case"Diode":case"ZenerDiode":if("voltage"in o&&o.voltage&&"voltageUnit"in o&&o.voltageUnit)return`${o.voltage} ${o.voltageUnit}`;break;case"Fuse":if("current"in o&&o.current&&"currentUnit"in o&&o.currentUnit)return`${o.current} ${o.currentUnit}`;break;case"FerriteBead":if("impedance"in o&&o.impedance&&"impedanceUnit"in o&&o.impedanceUnit)return`${o.impedance} ${o.impedanceUnit}`;break;case"Relay":if("coilVoltage"in o&&o.coilVoltage&&"coilVoltageUnit"in o&&o.coilVoltageUnit)return`${o.coilVoltage} ${o.coilVoltageUnit}`;break;case"Speaker":if("impedance"in o&&o.impedance&&"impedanceUnit"in o&&o.impedanceUnit)return`${o.impedance} ${o.impedanceUnit}`;break;case"Motor":if("voltage"in o&&o.voltage&&"voltageUnit"in o&&o.voltageUnit)return`${o.voltage} ${o.voltageUnit}`;break;case"PowerSupply":if("outputVoltage"in o&&o.outputVoltage&&"outputVoltageUnit"in o&&o.outputVoltageUnit)return`${o.outputVoltage} ${o.outputVoltageUnit}`;break;case"Transistor":if("partNumber"in o&&o.partNumber)return o.partNumber;break;case"IntegratedCircuit":if("partNumber"in o&&o.partNumber)return o.partNumber;break}return null},[]);const Qu=b.useCallback(o=>{const r=[];switch(o.componentType){case"Capacitor":case"Electrolytic Capacitor":case"Film Capacitor":"capacitance"in o&&o.capacitance&&"capacitanceUnit"in o&&o.capacitanceUnit&&r.push(`Capacitance: ${o.capacitance} ${o.capacitanceUnit}`),"voltage"in o&&o.voltage&&"voltageUnit"in o&&o.voltageUnit&&r.push(`Voltage: ${o.voltage} ${o.voltageUnit}`),"dielectric"in o&&o.dielectric&&r.push(`Dielectric: ${o.dielectric}`);break;case"Resistor":case"ResistorNetwork":case"Thermistor":"resistance"in o&&o.resistance&&"resistanceUnit"in o&&o.resistanceUnit&&r.push(`Resistance: ${o.resistance} ${o.resistanceUnit}`),"power"in o&&o.power&&r.push(`Power: ${o.power}`),"tolerance"in o&&o.tolerance&&r.push(`Tolerance: ${o.tolerance}`);break;case"VariableResistor":"resistance"in o&&o.resistance&&"resistanceUnit"in o&&o.resistanceUnit&&r.push(`Resistance: ${o.resistance} ${o.resistanceUnit}`),"vrType"in o&&o.vrType&&r.push(`Type: ${o.vrType}`),"power"in o&&o.power&&r.push(`Power: ${o.power}`),"taper"in o&&o.taper&&r.push(`Taper: ${o.taper}`);break;case"Inductor":"inductance"in o&&o.inductance&&"inductanceUnit"in o&&o.inductanceUnit&&r.push(`Inductance: ${o.inductance} ${o.inductanceUnit}`),"current"in o&&o.current&&"currentUnit"in o&&o.currentUnit&&r.push(`Current: ${o.current} ${o.currentUnit}`),"tolerance"in o&&o.tolerance&&r.push(`Tolerance: ${o.tolerance}`);break;case"Battery":"voltage"in o&&o.voltage&&"voltageUnit"in o&&o.voltageUnit&&r.push(`Voltage: ${o.voltage} ${o.voltageUnit}`),"capacity"in o&&o.capacity&&"capacityUnit"in o&&o.capacityUnit&&r.push(`Capacity: ${o.capacity} ${o.capacityUnit}`);break;case"Diode":"voltage"in o&&o.voltage&&"voltageUnit"in o&&o.voltageUnit&&r.push(`Voltage: ${o.voltage} ${o.voltageUnit}`),"current"in o&&o.current&&"currentUnit"in o&&o.currentUnit&&r.push(`Current: ${o.current} ${o.currentUnit}`);break;case"ZenerDiode":"voltage"in o&&o.voltage&&"voltageUnit"in o&&o.voltageUnit&&r.push(`Voltage: ${o.voltage} ${o.voltageUnit}`),"power"in o&&o.power&&r.push(`Power: ${o.power}`),"tolerance"in o&&o.tolerance&&r.push(`Tolerance: ${o.tolerance}`);break;case"Fuse":"current"in o&&o.current&&"currentUnit"in o&&o.currentUnit&&r.push(`Current: ${o.current} ${o.currentUnit}`),"voltage"in o&&o.voltage&&"voltageUnit"in o&&o.voltageUnit&&r.push(`Voltage: ${o.voltage} ${o.voltageUnit}`);break;case"FerriteBead":"impedance"in o&&o.impedance&&"impedanceUnit"in o&&o.impedanceUnit&&r.push(`Impedance: ${o.impedance} ${o.impedanceUnit}`),"current"in o&&o.current&&"currentUnit"in o&&o.currentUnit&&r.push(`Current: ${o.current} ${o.currentUnit}`);break;case"Relay":"coilVoltage"in o&&o.coilVoltage&&"coilVoltageUnit"in o&&o.coilVoltageUnit&&r.push(`Coil Voltage: ${o.coilVoltage} ${o.coilVoltageUnit}`),"contactRating"in o&&o.contactRating&&r.push(`Contact Rating: ${o.contactRating}`);break;case"Speaker":"impedance"in o&&o.impedance&&"impedanceUnit"in o&&o.impedanceUnit&&r.push(`Impedance: ${o.impedance} ${o.impedanceUnit}`),"power"in o&&o.power&&r.push(`Power: ${o.power}`);break;case"Motor":"voltage"in o&&o.voltage&&"voltageUnit"in o&&o.voltageUnit&&r.push(`Voltage: ${o.voltage} ${o.voltageUnit}`),"speed"in o&&o.speed&&"speedUnit"in o&&o.speedUnit&&r.push(`Speed: ${o.speed} ${o.speedUnit}`);break;case"PowerSupply":"outputVoltage"in o&&o.outputVoltage&&"outputVoltageUnit"in o&&o.outputVoltageUnit&&r.push(`Output Voltage: ${o.outputVoltage} ${o.outputVoltageUnit}`),"outputCurrent"in o&&o.outputCurrent&&"outputCurrentUnit"in o&&o.outputCurrentUnit&&r.push(`Output Current: ${o.outputCurrent} ${o.outputCurrentUnit}`);break;case"Transistor":"partNumber"in o&&o.partNumber&&r.push(`Part Number: ${o.partNumber}`),"transistorType"in o&&o.transistorType&&r.push(`Type: ${o.transistorType}`);break;case"Crystal":"frequency"in o&&o.frequency&&r.push(`Frequency: ${o.frequency}`),"loadCapacitance"in o&&o.loadCapacitance&&r.push(`Load Capacitance: ${o.loadCapacitance}`),"tolerance"in o&&o.tolerance&&r.push(`Tolerance: ${o.tolerance}`);break;case"VacuumTube":"tubeType"in o&&o.tubeType&&r.push(`Tube Type: ${o.tubeType}`),"partNumber"in o&&o.partNumber&&r.push(`Part Number: ${o.partNumber}`);break}return r},[]),[dn,_o]=b.useState(!1),pa=b.useRef(null),[Rr,Za]=b.useState(!1),[ad,ha]=b.useState(!1),Ka=b.useRef(null),Qa=b.useRef(null),ni=b.useRef(null),mn=b.useRef(null),[Ja,rl]=b.useState(!1),[ga,Ho]=b.useState(!1),[Fn,es]=b.useState(null),Dr=_e.useRef(null),[sd,iu]=b.useState(new Set),rd=b.useRef(null),xa=b.useRef(null),Ar=b.useRef(null),Nr=b.useRef(null),Mr=b.useRef(null),Br=b.useRef(null),pc=b.useRef(null),cd=b.useRef(null),[lu,dd]=b.useState(null),[Yl,hc]=b.useState(!1),[ts,ud]=b.useState(null),[Io,gc]=b.useState(null),fd=b.useCallback(async(o,r)=>{if(!r)throw new Error("No project directory available. Please create or open a project before loading images. The project directory is needed to store image files.");try{let f;try{f=await r.getDirectoryHandle("images",{create:!0})}catch(v){throw new Error(`Failed to create images directory in project folder. This may be due to insufficient permissions. Please ensure you have write access to the project directory. Error details: ${v.message}`)}const m=o.name,y=`images/${m}`;try{const x=await(await f.getFileHandle(m,{create:!0})).createWritable();return await x.write(o),await x.close(),console.log(`Image copied to project directory: ${y}`),y}catch(v){throw new Error(`Failed to copy image file "${m}" to project images directory. The file may be locked by another application, or there may be insufficient disk space. Please try again or check your disk space. Error details: ${v.message}`)}}catch(f){throw f instanceof Error&&f.message.includes("No project directory")||f instanceof Error&&f.message.includes("Failed to")?f:new Error(`An unexpected error occurred while copying the image to the project directory. This may be due to file system permissions or disk space issues. Please try again. Technical details: ${f.message}`)}},[]),ou=b.useCallback(async(o,r)=>{try{const f=o.name.toLowerCase(),y=[".png",".jpg",".jpeg"].some(X=>f.endsWith(X)),x=["image/png","image/jpeg","image/jpg"].includes(o.type);if(!y&&!x){alert(`Error: Unsupported image format.

The software only accepts PNG and JPEG image files.

File selected: ${o.name}
File type: ${o.type||"unknown"}

Please select a .png, .jpg, or .jpeg image file.`);return}let T;if(cn)try{T=await fd(o,cn)}catch(X){const oe=X instanceof Error?X.message:"Unknown error occurred while copying image to project directory.";alert(`Error: ${oe}

The image could not be loaded. Please ensure you have a project open and have write permissions to the project directory.`);return}else{if(!confirm(`Warning: No project directory is currently open. The image will be loaded, but you must create or open a project and save it before the image will be stored in the project directory.

Do you want to continue loading the ${r==="top"?"top":"bottom"} image?`))return;T=o.name}const C=await createImageBitmap(o),k=URL.createObjectURL(o),N=Sn.current;let U=0,le=0;if(N){const X=N.width-10,oe=N.height-10,ae=X/2,ee=oe/2;U=(ae-kt.x)/Fe,le=(ee-kt.y)/Fe}const K={url:k,name:o.name,width:C.width,height:C.height,filePath:T,x:U,y:le,scale:1,rotation:0,flipX:!1,flipY:!1,skewX:0,skewY:0,keystoneV:0,keystoneH:0,bitmap:C};r==="top"?d(K):I(K)}catch(f){const m=f instanceof Error?f.message:"Unknown error occurred while loading the image.";alert(`Error: Failed to load image file "${o.name}".

${m}

Please ensure the file is a valid image format (PNG, JPEG, etc.) and is not corrupted.`),console.error("Failed to load image",f)}},[kt.x,kt.y,Fe,cn,fd]),au=b.useCallback(o=>{o.stopPropagation(),o.preventDefault();const r=Sn.current;if(!r)return;document.activeElement!==r&&r.focus();const f=r.getBoundingClientRect(),m=r.width/f.width,y=r.height/f.height,v=o.nativeEvent.offsetX,x=o.nativeEvent.offsetY,T=typeof v=="number"?v:o.clientX-f.left,C=typeof x=="number"?x:o.clientY-f.top,k=T*m,N=C*y,U=k-5,le=N-5,K=(U-kt.x)/Fe,X=(le-kt.y)/Fe;if(B==="center"){Hl(!0),Qn.current&&clearTimeout(Qn.current),Qn.current=setTimeout(()=>{Hl(!1),te("select"),Xn(void 0)},2e3);return}if(B==="select"){if(Rn){let H=1/0,Se=null,ge=null;const Ue=Math.max(6/Fe,4),ot=[...et,...rt].find(Ye=>Ye.id===Rn.componentId)?.layer||"top";for(const Ye of He)if((Ye.type==="via"||Ye.type==="pad")&&Ye.points.length>0){if(Ye.type==="pad"&&(Ye.layer||"top")!==ot)continue;const qe=Ye.points[0],it=Math.max(1,Ye.size/2),wt=Math.hypot(qe.x-K,qe.y-X),$e=Math.max(it,Ue);wt<=$e&&wt<H&&(H=wt,Se=qe.id??null,ge=Ye)}if(ge?(console.log(`
[PIN CONNECTION] Found via!`),console.log(`  Stroke ID: ${ge.id}`),console.log(`  Point ID: ${Se}`),console.log(`  Point coordinates: x=${ge.points[0].x.toFixed(2)}, y=${ge.points[0].y.toFixed(2)}`),console.log(`  Click coordinates: x=${K.toFixed(2)}, y=${X.toFixed(2)}`),console.log(`  Distance: ${H.toFixed(2)}`),console.log(`  Via size: ${ge.size}, radius: ${Math.max(1,ge.size/2)}`)):(console.log(`
[PIN CONNECTION] No via found!`),console.log(`  Click coordinates: x=${K.toFixed(2)}, y=${X.toFixed(2)}`),console.log(`  Hit tolerance: ${Ue.toFixed(2)}`),console.log(`  Total vias in drawingStrokes: ${He.filter(Ye=>Ye.type==="via").length}`)),Se!=null){console.log(`
[PIN CONNECTION] Proceeding with connection...`),console.log(`  bestPointId is valid: ${Se} (type: ${typeof Se})`);const Ye=String(Se),qe=Rn.pinIndex,it=Rn.componentId;console.log(`
=== PIN CONNECTION START ===`),console.log(`Connecting pin ${qe} (Pin ${qe+1}) of component ${it} to point ID ${Ye}`);const wt=et.find(Ee=>Ee.id===it),$e=rt.find(Ee=>Ee.id===it);wt?(console.log("Component found in TOP layer"),Qt(Ee=>{const ht=Ee.find(St=>St.id===it);if(!ht)return console.error(`Component ${it} not found in TOP layer during update!`),Ee;console.log("BEFORE update: pinConnections =",ht.pinConnections);const qt=ht.pinConnections||[],gt=qt.length>0?[...qt]:new Array(ht.pinCount).fill("");let Nt;if(gt.length!==ht.pinCount){Nt=new Array(ht.pinCount).fill("");for(let St=0;St<Math.min(gt.length,ht.pinCount);St++)Nt[St]=gt[St]||""}else Nt=[...gt];Nt[qe]=Ye,console.log(`Updating pin ${qe} with value: ${Ye}`),console.log("New pinConnections array:",Nt);const Jt=Ee.map(St=>St.id===it?{...St,pinConnections:Nt}:St),Tn=Jt.find(St=>St.id===it);return console.log("AFTER update: pinConnections =",Tn?.pinConnections),console.log(`Pin ${qe} value: ${Tn?.pinConnections[qe]}`),console.log(`=== PIN CONNECTION COMPLETE (TOP) ===
`),Jt})):$e?(console.log("Component found in BOTTOM layer"),rn(Ee=>{const ht=Ee.find(St=>St.id===it);if(!ht)return console.error(`Component ${it} not found in BOTTOM layer during update!`),Ee;console.log("BEFORE update: pinConnections =",ht.pinConnections);const qt=ht.pinConnections||[],gt=qt.length>0?[...qt]:new Array(ht.pinCount).fill("");let Nt;if(gt.length!==ht.pinCount){Nt=new Array(ht.pinCount).fill("");for(let St=0;St<Math.min(gt.length,ht.pinCount);St++)Nt[St]=gt[St]||""}else Nt=[...gt];Nt[qe]=Ye,console.log(`Updating pin ${qe} with value: ${Ye}`),console.log("New pinConnections array:",Nt);const Jt=Ee.map(St=>St.id===it?{...St,pinConnections:Nt}:St),Tn=Jt.find(St=>St.id===it);return console.log("AFTER update: pinConnections =",Tn?.pinConnections),console.log(`Pin ${qe} value: ${Tn?.pinConnections[qe]}`),console.log(`=== PIN CONNECTION COMPLETE (BOTTOM) ===
`),Jt})):(console.error(`Component ${it} not found in either TOP or BOTTOM layer!`),console.log("Available TOP components:",et.map(Ee=>Ee.id)),console.log("Available BOTTOM components:",rt.map(Ee=>Ee.id))),setTimeout(()=>{Zo(null)},0);return}else Zo(null)}const oe=10,ae=(()=>{for(const H of et)if(K>=H.x-oe&&K<=H.x+oe&&X>=H.y-oe&&X<=H.y+oe)return{layer:"top",comp:H};for(const H of rt)if(K>=H.x-oe&&K<=H.x+oe&&X>=H.y-oe&&X<=H.y+oe)return{layer:"bottom",comp:H};return null})();if(ae){const{comp:H}=ae;o.shiftKey?nt(Se=>{const ge=new Set(Se);return ge.has(H.id)?ge.delete(H.id):ge.add(H.id),ge}):(nt(new Set([H.id])),we(new Set),st(new Set),pt(new Set));return}const ee=Math.max(6/Fe,4);let ve=null;for(const H of yt){const Se=Math.max(6,H.size/2),ge=Se*.8,Ue=Se+ge,We=Math.hypot(H.x-K,H.y-X),ot=Math.abs(K-H.x)<=ee&&Math.abs(X-H.y)<=Ue,Ye=Math.abs(X-H.y)<=ee&&Math.abs(K-H.x)<=Ue;if(We<=Math.max(Se,ee)||ot||Ye){ve=H;break}}if(ve){o.shiftKey?st(H=>{const Se=new Set(H);return Se.has(ve.id)?Se.delete(ve.id):Se.add(ve.id),Se}):(st(new Set([ve.id])),we(new Set),nt(new Set),pt(new Set));return}let Ae=null;for(const H of dt){const Se=Math.max(6,(H.size||18)/2),ge=Se*.8,Ue=Se+ge,We=Math.hypot(H.x-K,H.y-X),ot=Math.abs(K-H.x)<=ee&&Math.abs(X-H.y)<=Ue,Ye=Math.abs(X-H.y)<=ee&&Math.abs(K-H.x)<=Ue;if(We<=Math.max(Se,ee)||ot||Ye){Ae=H;break}}if(Ae){o.shiftKey?pt(H=>{const Se=new Set(H);return Se.has(Ae.id)?Se.delete(Ae.id):Se.add(Ae.id),Se}):(pt(new Set([Ae.id])),we(new Set),nt(new Set),st(new Set));return}const ze=Math.max(6/Fe,4/Fe),Ie=Math.max(ze,.5);let Q=null;for(const H of He)if((H.type==="via"||H.type==="pad"||H.type==="testPoint")&&H.points.length>0){let Se=!1;if(H.type==="via"?Se=hn:H.type==="pad"?Se=(H.layer||"top")==="top"?Qi:Ut:H.type==="testPoint"&&(Se=(H.layer||"top")==="top"?fi:bl),!Se)continue;const ge=H.points[0],Ue=Math.max(1,H.size/2);if(Math.hypot(ge.x-K,ge.y-X)<=Math.max(Ue,Ie)){Q=H;break}}if(Q){o.shiftKey?we(H=>{const Se=new Set(H);return Se.has(Q.id)?Se.delete(Q.id):Se.add(Q.id),Se}):(we(new Set([Q.id])),nt(new Set),st(new Set),pt(new Set));return}o.shiftKey||(we(new Set),nt(new Set),st(new Set),pt(new Set)),za(!0),ud({x:K,y:X,shiftKey:o.shiftKey}),gc({x:K,y:X,width:0,height:0});return}else if(B==="magnify"){const oe=o.shiftKey?.5:2,ae=Math.max(.25,Math.min(8,Fe*oe)),ee=U-ae*K,ve=le-ae*X;mi(ae),Hn({x:ee,y:ve});return}else if(B==="pan"){Kn.current={startCX:U,startCY:le,panX:kt.x,panY:kt.y},_l.current={startClientX:o.clientX,startClientY:o.clientY,panX:kt.x,panY:kt.y},oa(!0);return}else if(B==="draw"){const oe=(ve,Ae)=>{let Re=1/0,ze=null;const Ie=10/Fe,Q=Fe>20?Math.max(Ie,1e-4):Fe>10?Math.max(Ie,.001):Math.max(Ie,.01);for(const ge of He)if(ge.type==="via"){const Ue=ge.points[0],We=Math.hypot(Ue.x-ve,Ue.y-Ae);We<=Q&&We<Re&&(Re=We,ze=Ue)}else if(ge.type==="pad"){const Ue=ge.points[0],We=Math.hypot(Ue.x-ve,Ue.y-Ae);We<=Q&&We<Re&&(Re=We,ze=Ue)}for(const ge of yt)if(ge.pointId!==void 0){const Ue=Math.hypot(ge.x-ve,ge.y-Ae);Ue<=Q&&Ue<Re&&(Re=Ue,ze={x:ge.x,y:ge.y,id:ge.pointId})}for(const ge of dt)if(ge.pointId!==void 0){const Ue=Math.hypot(ge.x-ve,ge.y-Ae);Ue<=Q&&Ue<Re&&(Re=Ue,ze={x:ge.x,y:ge.y,id:ge.pointId})}const Se=Yt(ze??{x:ve,y:Ae});return{x:Se.x,y:Se.y,nodeId:ze?.id}};if(Ne==="via"){const ve=At.get("via"),Ae=ve.color,Re=ve.size,Ve=Yl?{x:Yt({x:K,y:X}).x,y:Yt({x:K,y:X}).y}:((ge,Ue)=>{let We=1/0,ot=null;const qe=10/Fe,it=Fe>10?Math.max(qe,.001):Math.max(qe,.01);for(const Ee of He)if(Ee.type==="via"||Ee.type==="pad"){const ht=Ee.points[0],qt=Math.hypot(ht.x-ge,ht.y-Ue);qt<=it&&qt<We&&(We=qt,ot=ht)}for(const Ee of yt)if(Ee.pointId!==void 0){const ht=Math.hypot(Ee.x-ge,Ee.y-Ue);ht<=it&&ht<We&&(We=ht,ot={x:Ee.x,y:Ee.y,id:Ee.pointId})}for(const Ee of dt)if(Ee.pointId!==void 0){const ht=Math.hypot(Ee.x-ge,Ee.y-Ue);ht<=it&&ht<We&&(We=ht,ot={x:Ee.x,y:Ee.y,id:Ee.pointId})}const $e=Yt(ot??{x:ge,y:Ue});return{x:$e.x,y:$e.y,nodeId:ot?.id}})(K,X),Ie=Ve.nodeId??$o(),Q=Cl(Ie,Ke),H={id:Ie,x:Ve.x,y:Ve.y};pl(He,et,rt,Bi,ai);const Se={id:`${Date.now()}-via`,points:[H],color:Ae,size:Re,layer:lt,type:"via",viaType:Q};Pt(ge=>[...ge,Se]),lt==="top"?Ni(ge=>[...ge,Se.id]):ys(ge=>[...ge,Se.id]);return}if(Ne==="pad"){if(!Lt)return;const Ae=Yl?{x:Yt({x:K,y:X}).x,y:Yt({x:K,y:X}).y}:((Se,ge)=>{let Ue=1/0,We=null;const Ye=10/Fe,qe=Fe>10?Math.max(Ye,.001):Math.max(Ye,.01);for(const $e of He)if($e.type==="via"||$e.type==="pad"||$e.type==="testPoint"){const Ee=$e.points[0],ht=Math.hypot(Ee.x-Se,Ee.y-ge);ht<=qe&&ht<Ue&&(Ue=ht,We=Ee)}for(const $e of yt)if($e.pointId!==void 0){const Ee=Math.hypot($e.x-Se,$e.y-ge);Ee<=qe&&Ee<Ue&&(Ue=Ee,We={x:$e.x,y:$e.y,id:$e.pointId})}for(const $e of dt)if($e.pointId!==void 0){const Ee=Math.hypot($e.x-Se,$e.y-ge);Ee<=qe&&Ee<Ue&&(Ue=Ee,We={x:$e.x,y:$e.y,id:$e.pointId})}const wt=Yt(We??{x:Se,y:ge});return{x:wt.x,y:wt.y,nodeId:We?.id}})(K,X),Re=Ae.nodeId??$o(),ze=An(Re,Ke),Ve=J||(Lt==="top"?re:O),Ie=M||(Lt==="top"?je:S),Q={id:Re,x:Ae.x,y:Ae.y};pl(He,et,rt,Bi,ai);const H={id:`${Date.now()}-pad`,points:[Q],color:Ve,size:Ie,layer:Lt,type:"pad",padType:ze};Pt(Se=>[...Se,H]);return}if(Ne==="testPoint"){if(!ln)return;const Ae=Yl?{x:Yt({x:K,y:X}).x,y:Yt({x:K,y:X}).y}:((ge,Ue)=>{let We=1/0,ot=null;const Ye=15;for(const wt of He)if(wt.type==="via"||wt.type==="pad"||wt.type==="testPoint"){const $e=wt.points[0],Ee=Math.hypot($e.x-ge,$e.y-Ue);Ee<=Ye&&Ee<We&&(We=Ee,ot=$e)}for(const wt of yt)if(wt.pointId!==void 0){const $e=Math.hypot(wt.x-ge,wt.y-Ue);$e<=Ye&&$e<We&&(We=$e,ot={x:wt.x,y:wt.y,id:wt.pointId})}for(const wt of dt)if(wt.pointId!==void 0){const $e=Math.hypot(wt.x-ge,wt.y-Ue);$e<=Ye&&$e<We&&(We=$e,ot={x:wt.x,y:wt.y,id:wt.pointId})}const it=Yt(ot??{x:ge,y:Ue});return{x:it.x,y:it.y,nodeId:ot?.id}})(K,X),Re=Ae.nodeId??$o(),ze=Vn(Re,Ke),Ve=ze.includes("Power")?"power":ze.includes("Ground")?"ground":ze.includes("Signal")?"signal":"unknown",Ie=Yt({x:Ae.x,y:Ae.y}),Q=J||(ln==="top"?$:Oe),H=M||(ln==="top"?Xe:Pe);pl(He,et,rt,Bi,ai);const Se={id:`${Date.now()}-testPoint`,points:[{id:Re,x:Ie.x,y:Ie.y}],color:Q,size:H,layer:ln,type:"testPoint",testPointType:Ve};Pt(ge=>[...ge,Se]);return}if(eo.current)return;const ae=Ne==="trace"&&!Yl?oe(K,X):{x:Yt({x:K,y:X}).x,y:Yt({x:K,y:X}).y},ee=ae.nodeId!==void 0?{id:ae.nodeId,x:ae.x,y:ae.y}:{x:ae.x,y:ae.y};bi(ve=>ve.length===0?[ee]:[...ve,ee]),lr.current=Date.now(),Wi(null),vo(!1),or(!1)}else if(B==="erase"){if(He.some(ae=>ae.layer===lt&&(ae.type==="via"&&ji||ae.type==="pad"&&Xi||ae.type==="testPoint"&&jo||ae.type==="trace"&&Ti))){const ae=[];ji&&He.some(ee=>ee.layer===lt&&ee.type==="via")&&ae.push("vias"),Xi&&He.some(ee=>ee.layer===lt&&ee.type==="pad")&&ae.push("pads"),jo&&He.some(ee=>ee.layer===lt&&ee.type==="testPoint")&&ae.push("test points"),Ti&&He.some(ee=>ee.layer===lt&&ee.type==="trace")&&ae.push("traces"),ae.length>0&&alert(`Cannot erase: ${ae.join(", ")} are locked on the ${lt} layer. Unlock them to erase.`)}vo(!0),bi([{id:$o(),x:K,y:X}]),console.log("Starting erase at:",K,X,"selectedDrawingLayer:",lt,"total strokes:",He.length)}else if(B==="transform"&&Bt){if(Ui){alert("Cannot transform: Images are locked. Unlock images to transform them.");return}Li(!0),$i({x:K,y:X})}else if(B==="component"){if(!Fn)return;const oe=Yt({x:K,y:X}),ae=J||(vn==="top"?Mn:Di),ee=M||(vn==="top"?Ai:el),ve=[...et,...rt];let Ae;Ms?Ae=Fd():Ae={...ra.current};const Re=ax(Fn,vn,oe.x,oe.y,ae,ee,ve,Ae,Ns);if(Re.abbreviation=Kf(Fn),Ns&&Re.designator){const ze=Qf(Fn),Ve=Re.designator.match(new RegExp(`^${ze.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(\\d+)$`));if(Ve){const Ie=parseInt(Ve[1],10);if(Ms){const Q=Fd();cx(ze,Ie,Q)}else ra.current[ze]=Math.max(ra.current[ze]||0,Ie)}}pl(He,et,rt,Bi,ai),vn==="top"?(so(!0),Qt(ze=>[...ze,Re])):(_i(!0),rn(ze=>[...ze,Re]));return}else if(B==="power"){if(!Il)return;const ae=Yl?{x:Yt({x:K,y:X}).x,y:Yt({x:K,y:X}).y}:((ve,Ae)=>{let Re=1/0,ze=null;const Ie=10/Fe,Q=Fe>20?Math.max(Ie,1e-4):Fe>10?Math.max(Ie,.001):Math.max(Ie,.01);for(const ge of He)if(ge.type==="via"||ge.type==="pad"){const Ue=ge.points[0],We=Math.hypot(Ue.x-ve,Ue.y-Ae);We<=Q&&We<Re&&(Re=We,ze=Ue)}else if(ge.type==="trace")for(const Ue of ge.points){const We=Math.hypot(Ue.x-ve,Ue.y-Ae);We<=Q&&We<Re&&(Re=We,ze=Ue)}const Se=Yt(ze??{x:ve,y:Ae});return{x:Se.x,y:Se.y,nodeId:ze?.id}})(K,X),ee=Ke.find(ve=>ve.id===Il);if(ee){const ve=ae.nodeId??$o(),Ae=`${ee.voltage} Power Node`;if(dt.find(Ve=>Ve.pointId===ve)){Aa({visible:!0,title:"Node ID Conflict",message:`Cannot place power node: A ground node already exists at this Node ID (${ve}). Power and ground nodes cannot share the same Node ID.`});return}pl(He,et,rt,Bi,ai);const ze={id:`power-${Date.now()}-${Math.random()}`,x:ae.x,y:ae.y,color:"#ff0000",size:M,powerBusId:ee.id,layer:lt,type:Ae,pointId:ve};if(oi(Ve=>[...Ve,ze]),ae.nodeId!==void 0){const Ve=Cl(ae.nodeId,Ke),Ie=An(ae.nodeId,Ke),Q=Vn(ae.nodeId,Ke),H=Q.includes("Power")?"power":Q.includes("Ground")?"ground":Q.includes("Signal")?"signal":"unknown";Pt(Se=>Se.map(ge=>ge.type==="via"&&ge.points.length>0&&ge.points[0].id===ae.nodeId?{...ge,viaType:Ve}:ge.type==="pad"&&ge.points.length>0&&ge.points[0].id===ae.nodeId?{...ge,padType:Ie}:ge.type==="testPoint"&&ge.points.length>0&&ge.points[0].id===ae.nodeId?{...ge,testPointType:H}:ge))}}return}else if(B==="ground"){if(ei===null){if(Gt.length===0){Aa({visible:!0,title:"No Ground Bus",message:"No ground buses are defined. Please create a ground bus first using Tools  Manage Ground Buses."});return}jn(!0);return}const oe=Gt.find(ae=>ae.id===ei);if(oe){const ee=Yl?{x:Yt({x:K,y:X}).x,y:Yt({x:K,y:X}).y}:((Ve,Ie)=>{let Q=1/0,H=null;const ge=10/Fe,Ue=Fe>20?Math.max(ge,1e-4):Fe>10?Math.max(ge,.001):Math.max(ge,.01);for(const Ye of He)if(Ye.type==="via"||Ye.type==="pad"){const qe=Ye.points[0],it=Math.hypot(qe.x-Ve,qe.y-Ie);it<=Ue&&it<Q&&(Q=it,H=qe)}else if(Ye.type==="trace")for(const qe of Ye.points){const it=Math.hypot(qe.x-Ve,qe.y-Ie);it<=Ue&&it<Q&&(Q=it,H=qe)}const ot=Yt(H??{x:Ve,y:Ie});return{x:ot.x,y:ot.y,nodeId:H?.id}})(K,X),ve=ee.nodeId??$o(),Ae=`${oe.name} Ground Node`,Re=yt.find(Ve=>Ve.pointId===ve);if(Re){Aa({visible:!0,title:"Node ID Conflict",message:`Cannot place ground node: A power node (${Re.type||"Power Node"}) already exists at this Node ID (${ve}). Power and ground nodes cannot share the same Node ID.`});return}pl(He,et,rt,Bi,ai);const ze={id:`gnd-${Date.now()}-${Math.random().toString(36).slice(2,6)}`,x:ee.x,y:ee.y,color:oe.color,size:M||Ht.get("ground")?.settings.size||18,groundBusId:oe.id,layer:lt,type:Ae,pointId:ve};if(qn(Ve=>[...Ve,ze]),ee.nodeId!==void 0){const Ve=Cl(ee.nodeId,Ke),Ie=An(ee.nodeId,Ke);Pt(Q=>Q.map(H=>H.type==="via"&&H.points.length>0&&H.points[0].id===ee.nodeId?{...H,viaType:Ve}:H.type==="pad"&&H.points.length>0&&H.points[0].id===ee.nodeId?{...H,padType:Ie}:H))}}return}},[B,Bt,M,J,Ne,lt,He,Fe,kt.x,kt.y,Yl,Il,ei,Ke,Gt,Fn,Ht,Lt,ft,ln,yt,dt,Cl,An,Vn,hn,Qi,Ut]),Vs=b.useCallback(o=>{if(B!=="magnify")return;o.preventDefault();const r=Sn.current;if(!r)return;const f=r.getBoundingClientRect(),m=r.width/f.width,y=r.height/f.height,v=o.nativeEvent.offsetX,x=o.nativeEvent.offsetY,T=typeof v=="number"?v:o.clientX-f.left,C=typeof x=="number"?x:o.clientY-f.top,k=T*m,N=C*y,U=(k-5-kt.x)/Fe,le=(N-5-kt.y)/Fe,K=1.2,X=1/K,oe=o.deltaY<0?K:X,ae=Math.max(.25,Math.min(8,Fe*oe)),ee=k-5-ae*U,ve=N-5-ae*le;mi(ae),Hn({x:ee,y:ve})},[B,Fe,kt.x,kt.y]),su=b.useCallback(o=>{if(B==="draw"&&Ne==="trace"){eo.current=!0;let ee=Xt;if(ee.length>1){const ve=[ee[0]];for(let Ae=1;Ae<ee.length;Ae++){const Re=ve[ve.length-1],ze=ee[Ae];(Math.abs(Re.x-ze.x)>.001||Math.abs(Re.y-ze.y)>.001)&&ve.push(ze)}ee=ve}if(ee.length>=1){pl(He,et,rt,Bi,ai);const ve=ft||"top",Ae=ve==="top"?"traceTop":"traceBottom",Re=At.get(Ae),ze={id:`${Date.now()}-trace`,points:ee,color:Re.color,size:Re.size,layer:ve,type:"trace"};Pt(Ve=>[...Ve,ze]),ve==="top"?Gn(Ve=>[...Ve,ze.id]):zn(Ve=>[...Ve,ze.id]),bi([]),Wi(null),setTimeout(()=>{eo.current=!1},300);return}}const r=Sn.current;if(!r)return;const f=r.getBoundingClientRect(),m=r.width/f.width,y=r.height/f.height,v=o.nativeEvent.offsetX,x=o.nativeEvent.offsetY,T=typeof v=="number"?v:o.clientX-f.left,C=typeof x=="number"?x:o.clientY-f.top,k=T*m,N=C*y,U=k-5,le=N-5,K=(U-kt.x)/Fe,X=(le-kt.y)/Fe,oe=Math.max(8/Fe,4),ae=(()=>{for(const ee of He)if(ee.type==="testPoint"&&ee.points.length>0){const ve=ee.points[0],Ae=Math.hypot(ve.x-K,ve.y-X),Re=(ee.size||18)/2;if(Ae<=Re+oe)return ee}return null})();if(ae){we(new Set([ae.id])),nt(new Set),st(new Set),pt(new Set),jl(!0);return}if(B==="select"||B==="component"){const ve=(()=>{for(const ze of et)if(K>=ze.x-10&&K<=ze.x+10&&X>=ze.y-10&&X<=ze.y+10)return{layer:"top",comp:ze};for(const ze of rt)if(K>=ze.x-10&&K<=ze.x+10&&X>=ze.y-10&&X<=ze.y+10)return{layer:"bottom",comp:ze};return null})(),Ae=Math.max(6/Fe,4);let Re=null;for(const ze of yt){const Ve=Math.max(6,ze.size/2),Ie=Ve*.8,Q=Ve+Ie,H=Math.hypot(ze.x-K,ze.y-X),Se=Math.abs(K-ze.x)<=Ae&&Math.abs(X-ze.y)<=Q,ge=Math.abs(X-ze.y)<=Ae&&Math.abs(K-ze.x)<=Q;if(H<=Math.max(Ve,Ae)||Se||ge){Re=ze;break}}if(Re){st(new Set([Re.id])),Ko({visible:!0,id:Re.id,layer:Re.layer,x:Re.x,y:Re.y,size:Re.size,color:Re.color,powerBusId:Re.powerBusId});return}if(ve){const{layer:ze,comp:Ve}=ve;fr(Ve,ze)}}},[B,Ne,J,M,lt,et,rt,yt,Fe,kt.x,kt.y,Fn,Ja,Yl,He,Bt,si,lu,Rn,Ht,Xt,ft,D,E,W,me,jl,we,nt,st,pt,fr]),ns=b.useCallback(()=>{const o=So.current;if(B==="draw"&&Ne==="trace"&&o.length>=2){let r=[o[0]];for(let x=1;x<o.length;x++){const T=r[r.length-1],C=o[x];(Math.abs(T.x-C.x)>.001||Math.abs(T.y-C.y)>.001)&&r.push(C)}const f=ft||"top",m=f==="top"?"traceTop":"traceBottom",y=At.get(m),v={id:`${Date.now()}-trace`,points:r,color:y.color,size:y.size,layer:f,type:"trace"};pl(He,et,rt,Bi,ai),Pt(x=>[...x,v]),f==="top"?Gn(x=>[...x,v.id]):zn(x=>[...x,v.id]),bi([]),Wi(null)}else if(B==="draw"&&Ne==="trace"&&o.length===1){const r=ft||"top",f=r==="top"?"traceTop":"traceBottom",m=At.get(f),y={id:`${Date.now()}-trace-dot`,points:o,color:m.color,size:m.size,layer:r,type:"trace"};Pt(v=>[...v,y]),r==="top"?Gn(v=>[...v,y.id]):zn(v=>[...v,y.id]),bi([])}},[B,Ne,ft,D,E,W,me,Pt]),Ur=b.useCallback((o,r,f)=>{const m=r-o.x,y=f-o.y;if(m===0&&y===0)return{x:r,y:f};const x=(Math.atan2(y,m)*180/Math.PI%180+180)%180,T=[0,45,90];let C=0,k=1e9;for(const N of T){const U=Math.abs(x-N);U<k&&(k=U,C=N)}if(C===0)return{x:r,y:o.y};if(C===90)return{x:o.x,y:f};{const N=Math.min(Math.abs(m),Math.abs(y)),U=m>=0?1:-1,le=y>=0?1:-1;return{x:o.x+U*N,y:o.y+le*N}}},[]),ru=b.useCallback(o=>{const r=Sn.current?.getBoundingClientRect();if(!r)return;const f=o.clientX-r.left,m=o.clientY-r.top,y=Sn.current,v=y.width/r.width,x=y.height/r.height,T=f*v,C=m*x,k=T-5,N=C-5,U=(k-kt.x)/Fe,le=(N-kt.y)/Fe;if(B==="draw"&&Ne==="trace"&&Xt.length>0){const X=Yl?{x:Yt({x:U,y:le}).x,y:Yt({x:U,y:le}).y}:((oe,ae)=>{let ee=1/0,ve=null;const Re=10/Fe,ze=Fe>20?Math.max(Re,1e-4):Fe>10?Math.max(Re,.001):Math.max(Re,.01);for(const Q of He)if(Q.type==="via"){const H=Q.points[0],Se=Math.hypot(H.x-oe,H.y-ae);Se<=ze&&Se<ee&&(ee=Se,ve=H)}else if(Q.type==="pad"){const H=Q.points[0],Se=Math.hypot(H.x-oe,H.y-ae);Se<=ze&&Se<ee&&(ee=Se,ve=H)}for(const Q of yt)if(Q.pointId!==void 0){const H=Math.hypot(Q.x-oe,Q.y-ae);H<=ze&&H<ee&&(ee=H,ve={x:Q.x,y:Q.y,id:Q.pointId})}for(const Q of dt)if(Q.pointId!==void 0){const H=Math.hypot(Q.x-oe,Q.y-ae);H<=ze&&H<ee&&(ee=H,ve={x:Q.x,y:Q.y,id:Q.pointId})}const Ie=Yt(ve??{x:oe,y:ae});return{x:Ie.x,y:Ie.y,nodeId:ve?.id}})(U,le);Wi({x:X.x,y:X.y})}else Wi(null);if(ko){const X=(()=>{for(const oe of et)if(U>=oe.x-10&&U<=oe.x+10&&le>=oe.y-10&&le<=oe.y+10)return{layer:"top",comp:oe};for(const oe of rt)if(U>=oe.x-10&&U<=oe.x+10&&le>=oe.y-10&&le<=oe.y+10)return{layer:"bottom",comp:oe};return null})();if(X)Ro({component:X.comp,layer:X.layer,x:o.clientX,y:o.clientY}),Oa(null);else{Ro(null);const oe=Math.max(8/Fe,4),ae=(()=>{for(const ee of He)if(ee.type==="testPoint"&&ee.points.length>0){const ve=ee.points[0],Ae=Math.hypot(ve.x-U,ve.y-le),Re=(ee.size||18)/2;if(Ae<=Re+oe)return ee}return null})();Oa(ae?{stroke:ae,x:o.clientX,y:o.clientY}:null)}}else Ro(null),Oa(null);if(B==="select"&&kn&&ts){const K=ts.x,X=ts.y;gc({x:Math.min(K,U),y:Math.min(X,le),width:Math.abs(U-K),height:Math.abs(le-X)})}else if(B==="pan"&&si&&Kn.current){const{startCX:K,startCY:X,panX:oe,panY:ae}=Kn.current,ee=k-K,ve=N-X;Hn({x:oe+ee,y:ae+ve})}else if(Jl&&Xt.length>0){if(B==="draw")if(xs){const K=Xt[0],X=Ur(K,U,le),oe=Yt(X),ae={id:$o(),x:oe.x,y:oe.y};bi([K,ae])}else{const K=Yt({x:U,y:le});bi(X=>[...X,{id:$o(),x:K.x,y:K.y}])}else if(B==="erase"&&(bi(K=>[...K,{id:$o(),x:U,y:le}]),Pt(K=>{const X=K.filter(ae=>{if(ae.type==="via"&&ji||ae.type==="pad"&&Xi||ae.type==="testPoint"&&jo||ae.type==="trace"&&Ti||ae.layer!==lt)return!0;const ee=M/2,ve=U-ee,Ae=U+ee,Re=le-ee,ze=le+ee,Ve=(H,Se)=>H>=ve&&H<=Ae&&Se>=Re&&Se<=ze,Ie=(H,Se,ge,Ue)=>{const wt=(Jt,Tn)=>{let St=0;return Jt<ve?St|=1:Jt>Ae&&(St|=2),Tn<Re?St|=4:Tn>ze&&(St|=8),St};let $e=H,Ee=Se,ht=ge,qt=Ue,gt=wt($e,Ee),Nt=wt(ht,qt);for(;;){if((gt|Nt)===0)return!0;if((gt&Nt)!==0)return!1;const Jt=gt!==0?gt:Nt;let Tn=0,St=0;Jt&8?(Tn=$e+(ht-$e)*(ze-Ee)/(qt-Ee),St=ze):Jt&4?(Tn=$e+(ht-$e)*(Re-Ee)/(qt-Ee),St=Re):Jt&2?(St=Ee+(qt-Ee)*(Ae-$e)/(ht-$e),Tn=Ae):(St=Ee+(qt-Ee)*(ve-$e)/(ht-$e),Tn=ve),Jt===gt?($e=Tn,Ee=St,gt=wt($e,Ee)):(ht=Tn,qt=St,Nt=wt(ht,qt))}};let Q=!1;if(ae.points.length===1){const H=ae.points[0];Q=Ve(H.x,H.y)}else for(let H=0;H<ae.points.length-1;H++){const Se=ae.points[H],ge=ae.points[H+1];if(Ie(Se.x,Se.y,ge.x,ge.y)){Q=!0;break}}return Q&&console.log("Erasing stroke at position:",U,le,"brushSize:",M,"selectedLayer:",lt),!Q});console.log("Strokes before:",K.length,"after:",X.length);const oe=new Set(X.map(ae=>ae.id));return Ni(ae=>ae.filter(ee=>oe.has(ee))),ys(ae=>ae.filter(ee=>oe.has(ee))),Gn(ae=>ae.filter(ee=>oe.has(ee))),zn(ae=>ae.filter(ee=>oe.has(ee))),X}),wn||oi(K=>{const X=M/2,oe=U-X,ae=U+X,ee=le-X,ve=le+X,Ae=Re=>{const ze=Re.size/2,Ve=Re.x-ze,Ie=Re.x+ze,Q=Re.y-ze,H=Re.y+ze;return!(ae<Ve||oe>Ie||ve<Q||ee>H)};return K.filter(Re=>!Ae(Re))}),qi||qn(K=>{const X=M/2,oe=U-X,ae=U+X,ee=le-X,ve=le+X,Ae=ze=>{const Ve=Math.max(6,(ze.size||18)/2),Ie=Ve*.8,Q=Ve+Ie,H=ze.x-Q,Se=ze.x+Q,ge=ze.y-Q,Ue=ze.y+Q;return!(ae<H||oe>Se||ve<ge||ee>Ue)};return K.filter(ze=>!Ae(ze))}),!Gi)){const K=M/2,X=U-K,oe=U+K,ae=le-K,ee=le+K,ve=Ae=>{const ze=(Ae.size||18)/2,Ve=Ae.x-ze,Ie=Ae.x+ze,Q=Ae.y-ze,H=Ae.y+ze;return!(oe<Ve||X>Ie||ee<Q||ae>H)};pl(He,et,rt,Bi,ai),Qt(Ae=>Ae.filter(Re=>!ve(Re))),rn(Ae=>Ae.filter(Re=>!ve(Re)))}}else if(to&&gs&&Bt){if(Ui){Li(!1),$i(null);return}const K=U-gs.x,X=le-gs.y;if(Bt==="top"){g&&d(oe=>oe?{...oe,x:oe.x+K,y:oe.y+X}:null),$i({x:U,y:le});return}if(Bt==="bottom"){R&&I(oe=>oe?{...oe,x:oe.x+K,y:oe.y+X}:null),$i({x:U,y:le});return}if(Bt==="both"){g&&d(oe=>oe?{...oe,x:oe.x+K,y:oe.y+X}:null),R&&I(oe=>oe?{...oe,x:oe.x+K,y:oe.y+X}:null),$i({x:U,y:le});return}}},[Jl,Xt,B,M,to,gs,Bt,g,R,xs,Ur,lt,Pt,Fe,kt.x,kt.y,kn,ts,Ui,ji,Xi,Ti,wn,qi,et,rt,Qt,rn,ko,Ro,Yl,He,yt,dt,Xt,Ne,Ml,Wi,si,Kn,Hn,5,kt,$o,Yt,te,Hl,pl,Bi,ai]),xc=b.useCallback(()=>{if(B==="select"&&kn){const o=Io,r=ts;if(za(!1),ud(null),gc(null),o&&r){const y=Math.max(3,5/Fe),v=o.width<y&&o.height<y,x=(Q,H)=>{const Se=o.x,ge=o.y,Ue=o.x+o.width,We=o.y+o.height;return Q>=Se&&Q<=Ue&&H>=ge&&H<=We},T=(Q,H,Se,ge,Ue,We,ot,Ye)=>{const ht=(ho,Wo)=>{let Hi=0;return ho<Ue?Hi|=1:ho>ot&&(Hi|=2),Wo<We?Hi|=4:Wo>Ye&&(Hi|=8),Hi};let qt=Q,gt=H,Nt=Se,Jt=ge,Tn=ht(qt,gt),St=ht(Nt,Jt);for(;;){if((Tn|St)===0)return!0;if((Tn&St)!==0)return!1;const ho=Tn!==0?Tn:St;let Wo=0,Hi=0;ho&8?(Wo=qt+(Nt-qt)*(Ye-gt)/(Jt-gt),Hi=Ye):ho&4?(Wo=qt+(Nt-qt)*(We-gt)/(Jt-gt),Hi=We):ho&2?(Hi=gt+(Jt-gt)*(ot-qt)/(Nt-qt),Wo=ot):(Hi=gt+(Jt-gt)*(Ue-qt)/(Nt-qt),Wo=Ue),ho===Tn?(qt=Wo,gt=Hi,Tn=ht(qt,gt)):(Nt=Wo,Jt=Hi,St=ht(Nt,Jt))}},C=o.x,k=o.y,N=o.x+o.width,U=o.y+o.height,K=Math.max(6/Fe,4/Fe,.5),X=(Q,H,Se,ge,Ue,We)=>{const ot=Ue-Se,Ye=We-ge;if(ot===0&&Ye===0)return Math.hypot(Q-Se,H-ge);const qe=Math.max(0,Math.min(1,((Q-Se)*ot+(H-ge)*Ye)/(ot*ot+Ye*Ye))),it=Se+qe*ot,wt=ge+qe*Ye;return Math.hypot(Q-it,H-wt)},oe=r?.shiftKey===!0,ae=new Set(oe?Array.from(mt):[]),ee=new Set(oe?Array.from(vt):[]),ve=new Set(oe?Array.from(It):[]),Ae=new Set(oe?Array.from(jt):[]),Re=r?.hitStrokeId;if(Re){const Q=He.find(H=>H.id===Re);if(Q){let H=!1;if(Q.type==="via"||Q.type==="pad"?H=hn:H=Q.layer==="top"?Dn:Ci,H){oe?we(Se=>{const ge=new Set(Se);return ge.has(Re)?ge.delete(Re):ge.add(Re),ge}):(we(new Set([Re])),nt(new Set),st(new Set),pt(new Set));return}}}if(v){let Q=null;for(const H of He){let Se=!1;if(H.type==="via"?Se=hn:H.type==="pad"?Se=(H.layer||"top")==="top"?Qi:Ut:H.type==="testPoint"?Se=(H.layer||"top")==="top"?fi:bl:H.type==="trace"?Se=H.layer==="top"?Dn:Ci:Se=!1,!Se)continue;let ge=1/0;if(H.type==="via"||H.type==="pad"||H.type==="testPoint"){const Ue=H.points[0],We=Math.max(1,H.size/2);ge=Math.hypot(Ue.x-r.x,Ue.y-r.y);const Ye=Math.max(6/Fe,4/Fe,.5);ge<=Math.max(We,Ye)&&(!Q||ge<Q.dist)&&(Q={id:H.id,dist:ge})}else for(let Ue=0;Ue<H.points.length-1;Ue++){const We=H.points[Ue],ot=H.points[Ue+1],Ye=X(r.x,r.y,We.x,We.y,ot.x,ot.y);if(Ye<=Math.max(K,H.size/2)){(!Q||Ye<Q.dist)&&(Q={id:H.id,dist:Ye});break}}}Q&&(oe&&ae.has(Q.id)?ae.delete(Q.id):ae.add(Q.id))}else for(const Q of He){let H=!1;if(Q.type==="via"?H=hn:Q.type==="pad"?H=(Q.layer||"top")==="top"?Qi:Ut:Q.type==="testPoint"?H=(Q.layer||"top")==="top"?fi:bl:Q.type==="trace"?H=Q.layer==="top"?Dn:Ci:H=!1,!H)continue;let Se=!1;if(Q.type==="via"||Q.type==="pad"||Q.type==="testPoint"){const ge=Q.points[0];Se=x(ge.x,ge.y)}else for(let ge=0;ge<Q.points.length-1;ge++){const Ue=Q.points[ge],We=Q.points[ge+1];if(T(Ue.x,Ue.y,We.x,We.y,C,k,N,U)||x(Ue.x,Ue.y)&&x(We.x,We.y)){Se=!0;break}}Se&&(oe&&ae.has(Q.id)?ae.delete(Q.id):ae.add(Q.id))}const ze=Q=>{const Se=Math.max(10,Q.size||18)/2;return Q.x-Se<=N&&Q.x+Se>=C&&Q.y-Se<=U&&Q.y+Se>=k};if(v){const Q=H=>{const ge=Math.max(10,H.size||18)/2;return r.x>=H.x-ge&&r.x<=H.x+ge&&r.y>=H.y-ge&&r.y<=H.y+ge};al&&et.forEach(H=>{Q(H)&&(oe&&ee.has(H.id)?ee.delete(H.id):ee.add(H.id))}),hi&&rt.forEach(H=>{Q(H)&&(oe&&ee.has(H.id)?ee.delete(H.id):ee.add(H.id))})}else al&&et.forEach(Q=>{ze(Q)&&(oe&&ee.has(Q.id)?ee.delete(Q.id):ee.add(Q.id))}),hi&&rt.forEach(Q=>{ze(Q)&&(oe&&ee.has(Q.id)?ee.delete(Q.id):ee.add(Q.id))});const Ve=Q=>{const H=Math.max(6,Q.size/2),Se=H*.8,ge=H+Se;return Q.x-ge<=N&&Q.x+ge>=C&&Q.y-ge<=U&&Q.y+ge>=k};if(ml)if(v){let Q=null;for(const H of yt){const Se=Math.max(6,H.size/2),ge=Se*.8,Ue=Se+ge,We=Math.hypot(H.x-r.x,H.y-r.y),ot=Math.abs(r.x-H.x)<=K&&Math.abs(r.y-H.y)<=Ue,Ye=Math.abs(r.y-H.y)<=K&&Math.abs(r.x-H.x)<=Ue;if(We<=Math.max(Se,K)||ot||Ye){const it=Math.min(We,Math.abs(r.x-H.x)+Math.abs(r.y-H.y));(!Q||it<Q.dist)&&(Q={id:H.id,dist:it})}}Q&&(oe&&ve.has(Q.id)?ve.delete(Q.id):ve.add(Q.id))}else yt.forEach(Q=>{Ve(Q)&&(oe&&ve.has(Q.id)?ve.delete(Q.id):ve.add(Q.id))});const Ie=Q=>{const H=Math.max(6,(Q.size||18)/2),Se=H*.8,ge=H+Se;return Q.x-ge<=N&&Q.x+ge>=C&&Q.y-ge<=U&&Q.y+ge>=k};if(zi)if(v){let Q=null;for(const H of dt){const Se=Math.max(6,(H.size||18)/2),ge=Se*.8,Ue=Se+ge,We=Math.hypot(H.x-r.x,H.y-r.y),ot=Math.abs(r.x-H.x)<=K&&Math.abs(r.y-H.y)<=Ue,Ye=Math.abs(r.y-H.y)<=K&&Math.abs(r.x-H.x)<=Ue;if(We<=Math.max(Se,K)||ot||Ye){const it=Math.min(We,Math.abs(r.x-H.x)+Math.abs(r.y-H.y));(!Q||it<Q.dist)&&(Q={id:H.id,dist:it})}}Q&&(oe&&Ae.has(Q.id)?Ae.delete(Q.id):Ae.add(Q.id))}else dt.forEach(Q=>{Ie(Q)&&(oe&&Ae.has(Q.id)?Ae.delete(Q.id):Ae.add(Q.id))});we(ae),nt(ee),st(ve),pt(Ae)}}if(Jl&&Xt.length>0){if(B==="draw"&&Ne!=="trace"){const o={id:Date.now().toString(),points:Xt,color:J,size:M,layer:lt,type:"trace"};Pt(r=>[...r,o]),lt==="top"?Gn(r=>[...r,o.id]):zn(r=>[...r,o.id])}bi([])}si&&(oa(!1),Kn.current=null,_l.current=null),vo(!1),Li(!1),$i(null),or(!1)},[Jl,Xt,B,J,M,lt,Io,ts,kn,He,Fe,As,mt,yt,dt,et,rt,vt,It,jt,hn,Dn,Ci,al,hi,ml,zi]);_e.useEffect(()=>{if(!(B==="pan"&&si&&_l.current))return;const o=f=>{const m=Sn.current;if(!m)return;const y=m.getBoundingClientRect(),v=m.width/y.width,x=m.height/y.height,{startClientX:T,startClientY:C,panX:k,panY:N}=_l.current,U=(f.clientX-T)*v,le=(f.clientY-C)*x;Hn({x:k+U,y:N+le})},r=()=>{oa(!1),Kn.current=null,_l.current=null,window.removeEventListener("mousemove",o,!0),window.removeEventListener("mouseup",r,!0)};return window.addEventListener("mousemove",o,!0),window.addEventListener("mouseup",r,!0),()=>{window.removeEventListener("mousemove",o,!0),window.removeEventListener("mouseup",r,!0)}},[B,si]);const Pr=b.useCallback(()=>{const o=Sn.current;if(!o)return;const r=o.getContext("2d");if(!r)return;r.clearRect(0,0,o.width,o.height),r.fillStyle="#000000",r.fillRect(0,0,o.width,o.height),r.fillStyle="#ffffff",r.fillRect(5,5,o.width-10,o.height-10),r.save(),r.beginPath(),r.rect(5,5,o.width-10,o.height-10),r.clip(),r.translate(5,5);const f=(y,v,x,T,C,k,N,U)=>{const le=document.createElement("canvas");le.width=x,le.height=T;const K=le.getContext("2d",{willReadFrequently:!0});K.clearRect(0,0,x,T),K.drawImage(v,0,0,x,T);let X=le;if(Math.abs(C)>1e-6){const oe=Math.tan(C),ae=Math.max(.2,1-oe),ee=Math.max(.2,1+oe),ve=Math.max(ae,ee),Ae=Math.max(1,Math.ceil(x*ve)),Re=document.createElement("canvas");Re.width=Ae,Re.height=T;const ze=Re.getContext("2d",{willReadFrequently:!0});ze.clearRect(0,0,Ae,T);for(let Ve=0;Ve<T;Ve++){const Ie=T<=1?0:Ve/(T-1),Q=ae*(1-Ie)+ee*Ie,H=Math.max(1,x*Q),Se=(Ae-H)/2;ze.drawImage(X,0,Ve,x,1,Se,Ve,H,1)}X=Re}if(Math.abs(k)>1e-6){const oe=Math.tan(k),ae=Math.max(.2,1-oe),ee=Math.max(.2,1+oe),ve=Math.max(ae,ee),Ae=Math.max(1,Math.ceil(T*ve)),Re=document.createElement("canvas");Re.width=X.width,Re.height=Ae;const ze=Re.getContext("2d",{willReadFrequently:!0});ze.clearRect(0,0,Re.width,Ae);for(let Ve=0;Ve<X.width;Ve++){const Ie=X.width<=1?0:Ve/(X.width-1),Q=ae*(1-Ie)+ee*Ie,H=Math.max(1,T*Q),Se=(Ae-H)/2;ze.drawImage(X,Ve,0,1,X.height,Ve,Se,1,H)}X=Re}y.drawImage(X,-N/2,-U/2,N,U)};r.translate(kt.x,kt.y),r.scale(Fe,Fe);{const y=oo&&ci;if(g&&g.bitmap&&oo){const v=g.bitmap;r.save(),r.globalAlpha=1;const x=[];if(g.brightness!==void 0&&g.brightness!==100&&x.push(`brightness(${g.brightness}%)`),g.contrast!==void 0&&g.contrast!==100&&x.push(`contrast(${g.contrast}%)`),se&&x.push("grayscale(100%)"),r.filter=x.length>0?x.join(" "):"none",r.translate(g.x,g.y),r.rotate(g.rotation*Math.PI/180),g.skewX||g.skewY){const N=Math.tan(g.skewX||0),U=Math.tan(g.skewY||0);r.transform(1,U,N,1,0,0)}r.scale(g.scale*(g.flipX?-1:1),g.scale*(g.flipY?-1:1));const T=v.width*1,C=v.height*1,k=v;g.keystoneV&&Math.abs(g.keystoneV)>1e-6||g.keystoneH&&Math.abs(g.keystoneH)>1e-6?f(r,k,v.width,v.height,g.keystoneV||0,g.keystoneH||0,T,C):r.drawImage(k,-T/2,-C/2,T,C),r.restore()}if(R&&R.bitmap&&ci){const v=R.bitmap;r.save(),r.globalAlpha=y?p/100:1;const x=[];if(R.brightness!==void 0&&R.brightness!==100&&x.push(`brightness(${R.brightness}%)`),R.contrast!==void 0&&R.contrast!==100&&x.push(`contrast(${R.contrast}%)`),se&&x.push("grayscale(100%)"),r.filter=x.length>0?x.join(" "):"none",r.translate(R.x,R.y),r.rotate(R.rotation*Math.PI/180),R.skewX||R.skewY){const N=Math.tan(R.skewX||0),U=Math.tan(R.skewY||0);r.transform(1,U,N,1,0,0)}r.scale(R.scale*(R.flipX?-1:1),R.scale*(R.flipY?-1:1));const T=v.width*1,C=v.height*1,k=v;R.keystoneV&&Math.abs(R.keystoneV)>1e-6||R.keystoneH&&Math.abs(R.keystoneH)>1e-6?f(r,k,v.width,v.height,R.keystoneV||0,R.keystoneH||0,T,C):r.drawImage(k,-T/2,-C/2,T,C),r.restore()}}if(cu(r),ml&&yt.length>0){const y=v=>{r.save();const x=Ke.find(U=>U.id===v.powerBusId),T=It.has(v.id),C=x?.color||"#ff0000";r.strokeStyle=C,r.lineWidth=Math.max(1,(T?3:2)/Math.max(Fe,.001)),r.lineCap="round";const k=Math.max(6,v.size/2),N=k*.8;if(T&&(r.strokeStyle="#0066ff",r.lineWidth=Math.max(1,4/Math.max(Fe,.001)),r.beginPath(),r.arc(v.x,v.y,k+N+3,0,Math.PI*2),r.stroke()),r.strokeStyle=C,r.lineWidth=Math.max(1,(T?3:2)/Math.max(Fe,.001)),r.beginPath(),r.arc(v.x,v.y,k,0,Math.PI*2),r.stroke(),r.beginPath(),r.moveTo(v.x,v.y-k-N),r.lineTo(v.x,v.y+k+N),r.stroke(),r.beginPath(),r.moveTo(v.x-k-N,v.y),r.lineTo(v.x+k+N,v.y),r.stroke(),x){r.fillStyle=C;const U=Math.max(10,k*.8);r.font=`${U}px sans-serif`,r.textAlign="center",r.textBaseline="top",r.fillText(x.name,v.x,v.y+k+N+8)}r.restore()};yt.forEach(y)}if(zi&&dt.length>0){const y=v=>{r.save();const x=jt.has(v.id),T=Gt.find(U=>U.id===v.groundBusId),C=T?.color||v.color||"#000000",k=v.groundBusId==="groundbus-earth";let N;if(k){const U=Math.max(6,v.size||18),le=U*.9,K=U*.24,X=U*1.6;r.strokeStyle=C,r.lineWidth=Math.max(1,(x?3:2)/Math.max(Fe,.001)),r.lineCap="round",x&&(r.strokeStyle="#0066ff",r.lineWidth=Math.max(1,4/Math.max(Fe,.001)),r.setLineDash([5,5]),r.strokeRect(v.x-X/2-3,v.y-3,X+6,le+K*2+6),r.setLineDash([])),r.strokeStyle=C,r.lineWidth=Math.max(1,(x?3:2)/Math.max(Fe,.001)),r.beginPath(),r.moveTo(v.x,v.y),r.lineTo(v.x,v.y+le),r.stroke();for(let oe=0;oe<3;oe++){const ae=v.y+le+oe*K,ee=X*(1-oe*.25);r.beginPath(),r.moveTo(v.x-ee/2,ae),r.lineTo(v.x+ee/2,ae),r.stroke()}N=v.y+le+K*2}else{const U=Math.max(6,(v.size||18)/2),le=U*.8;x&&(r.strokeStyle="#0066ff",r.lineWidth=Math.max(1,4/Math.max(Fe,.001)),r.beginPath(),r.arc(v.x,v.y,U+le+3,0,Math.PI*2),r.stroke()),r.strokeStyle=C,r.lineWidth=Math.max(1,(x?3:2)/Math.max(Fe,.001)),r.beginPath(),r.arc(v.x,v.y,U,0,Math.PI*2),r.stroke(),r.beginPath(),r.moveTo(v.x,v.y-U-le),r.lineTo(v.x,v.y+U+le),r.stroke(),r.beginPath(),r.moveTo(v.x-U-le,v.y),r.lineTo(v.x+U+le,v.y),r.stroke(),N=v.y+U+le}if(T){r.fillStyle=C;const U=Math.max(10,(v.size||18)*.5);r.font=`${U}px sans-serif`,r.textAlign="center",r.textBaseline="top",r.fillText(T.name,v.x,N+8)}r.restore()};dt.forEach(y)}const m=y=>{const v=Math.max(10,y.size||18),x=v/2;r.save(),r.strokeStyle=y.color||"#111",r.lineWidth=Math.max(1,2/Math.max(Fe,.001));const T=y.pinConnections||[],C=T.length>0&&T.length===y.pinCount&&T.every(U=>U&&U.trim()!=="");r.fillStyle=C?"rgba(178, 223, 138, 0.85)":"rgba(255,255,255,0.85)",r.beginPath(),r.rect(y.x-x,y.y-x,v,v),r.fill(),r.stroke();const k=y.designator?.trim()||"";if(k){r.fillStyle=y.color||"#111";const U=Math.max(6,v*.35),le=v*.9;let K=U;r.font=`bold ${K}px sans-serif`;const X=r.measureText(k);X.width>le&&(K=le/X.width*K,K=Math.max(6,K),r.font=`bold ${K}px sans-serif`),r.textAlign="center",r.textBaseline="middle",r.fillText(k,y.x,y.y)}vt.has(y.id)&&(r.setLineDash([4,3]),r.strokeStyle="#00bfff",r.lineWidth=1.5,r.strokeRect(y.x-x-3,y.y-x-3,v+6,v+6),r.setLineDash([])),r.restore()};if(Vl){const y=x=>{const T=parseInt(x,10);if(isNaN(T))return null;for(const C of He)if((C.type==="via"||C.type==="pad"||C.type==="testPoint")&&C.points.length>0){const k=C.points[0];if(k.id===T)return{x:k.x,y:k.y}}for(const C of He)if(C.type==="trace"){for(const k of C.points)if(k.id===T)return{x:k.x,y:k.y}}for(const C of yt)if(C.pointId===T)return{x:C.x,y:C.y};for(const C of dt)if(C.pointId===T)return{x:C.x,y:C.y};return null},v=x=>{const T=x.pinConnections||[],C=x.componentType==="Electrolytic Capacitor"||x.componentType==="Diode"||x.componentType==="Battery"||x.componentType==="ZenerDiode",k=x.componentType==="Capacitor"&&"dielectric"in x&&x.dielectric==="Tantalum",N=(C||k)&&x.pinPolarities,U=new Map;for(let le=0;le<T.length;le++){const K=T[le];if(K&&K.trim()!==""){const X=K.trim(),oe=!!(N&&x.pinPolarities&&le<x.pinPolarities.length&&x.pinPolarities[le]==="-"),ae=U.get(X);ae!==void 0?U.set(X,ae||oe):U.set(X,oe)}}for(const[le,K]of U){const X=y(le);if(X){const oe={x:x.x,y:x.y};r.save(),r.strokeStyle=K?"rgba(0, 0, 0, 0.8)":mo,r.lineWidth=Math.max(1,Yo/Math.max(Fe,.001)),r.beginPath(),r.moveTo(oe.x,oe.y),r.lineTo(X.x,X.y),r.stroke(),r.restore()}}};al&&et.forEach(v),hi&&rt.forEach(v)}if(al&&et.forEach(m),hi&&rt.forEach(m),B==="select"&&Io){r.save();const y=Math.max(2,6/Math.max(1e-4,Fe));r.strokeStyle="#00bfff",r.fillStyle="rgba(0, 191, 255, 0.15)",r.lineWidth=Math.max(1,1.5/Math.max(1e-4,Fe)),r.setLineDash([y,y]),r.beginPath(),r.rect(Io.x,Io.y,Io.width,Io.height),r.fill(),r.stroke(),r.setLineDash([]),r.restore()}r.restore()},[g,R,p,He,Xt,Jl,B,J,M,se,Bt,lt,Fe,kt.x,kt.y,oo,ci,hn,Dn,Ci,Qi,Ut,fi,bl,al,hi,et,rt,ml,yt,zi,dt,Vl,Io,mt,vt,It,jt,ft,D,E,W,me,Ne,Ml,Ui,mo,Yo,Bs]);_e.useEffect(()=>{const o=()=>{const r=xr.current;if(!r)return;const f=1.6,m=244,y=12,v=6,x=12,T=r.clientWidth-m-y,C=r.getBoundingClientRect(),k=window.innerHeight,N=C.top,le=k-N-v-10,K=Math.min(r.clientHeight-x,le),X=Math.floor(K*f),oe=Math.floor(T/f);let ae,ee;X<=T?(ae=X,ee=K):(ae=T,ee=oe),ae=Math.max(600,ae),ee=Math.max(375,ee),ee=Math.max(355,ee-20),Ea(ve=>{if(ve.width!==ae||ve.height!==ee){const Ae=ve.width-10,Re=ve.height-10,ze=ae-10,Ve=ee-10,Ie=Ae>0?ze/Ae:1,Q=Re>0?Ve/Re:1;Hn(H=>({x:H.x*Ie,y:H.y*Q}))}return ve.width===ae&&ve.height===ee?ve:{width:ae,height:ee}})};return o(),window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[Hn]),_e.useEffect(()=>{Ui&&(to&&(Li(!1),$i(null)),Fi(null))},[Ui,to,Li,$i,Fi]);const cu=b.useCallback(o=>{if(He.forEach(r=>{if(r.type==="via"||r.type==="pad"||r.type==="testPoint"||r.testPointType!==void 0||r.type!=="trace")return;let f=!1;if(r.layer==="top"?f=Dn:r.layer==="bottom"&&(f=Ci),!!f){if(r.points.length===1){const m=r.points[0],y=Math.max(.5,r.size/2);mt.has(r.id)&&(o.strokeStyle="#00bfff",o.lineWidth=2,o.setLineDash([4,3]),o.beginPath(),o.arc(m.x,m.y,y+3,0,Math.PI*2),o.stroke(),o.setLineDash([])),o.fillStyle=r.color,o.beginPath(),o.arc(m.x,m.y,y,0,Math.PI*2),o.fill()}else if(mt.has(r.id)&&(o.strokeStyle="#00bfff",o.lineWidth=r.size+4,o.lineCap="round",o.lineJoin="round",o.globalAlpha=.6,o.beginPath(),r.points.forEach((m,y)=>{y===0?o.moveTo(m.x,m.y):o.lineTo(m.x,m.y)}),o.stroke(),o.globalAlpha=1),o.strokeStyle=r.color,o.lineWidth=r.size,o.lineCap="round",o.lineJoin="round",o.globalAlpha=1,o.beginPath(),r.points.forEach((m,y)=>{y===0?o.moveTo(m.x,m.y):o.lineTo(m.x,m.y)}),o.stroke(),Bs){o.fillStyle="#000000";for(const m of r.points)o.beginPath(),o.arc(m.x,m.y,r.size/2,0,Math.PI*2),o.fill()}}}),He.forEach(r=>{if(r.type==="via"){if(!hn)return}else if(r.type==="pad"){const m=r.layer||"top";if(m==="top"&&!Qi||m==="bottom"&&!Ut)return}else if(r.type==="testPoint"){const m=r.layer||"top";if(m==="top"&&!fi||m==="bottom"&&!bl)return}else return;const f=r.points[0];if(mt.has(r.id)){if(r.type==="via"){const m=Math.max(.5,r.size/2)+3;o.strokeStyle="#00bfff",o.lineWidth=2,o.setLineDash([4,3]),o.beginPath(),o.arc(f.x,f.y,m,0,Math.PI*2),o.stroke(),o.setLineDash([])}else if(r.type==="pad"){const m=Math.max(.5,r.size/2)+3;o.strokeStyle="#00bfff",o.lineWidth=2,o.setLineDash([4,3]),o.strokeRect(f.x-m,f.y-m,r.size+6,r.size+6),o.setLineDash([])}else if(r.type==="testPoint"){const m=Math.max(.5,r.size/2)+3;o.strokeStyle="#00bfff",o.lineWidth=2,o.setLineDash([4,3]),o.beginPath(),o.moveTo(f.x,f.y-m),o.lineTo(f.x+m,f.y),o.lineTo(f.x,f.y+m),o.lineTo(f.x-m,f.y),o.closePath(),o.stroke(),o.setLineDash([])}}if(r.type==="via"){const m=Math.max(.5,r.size/2),y=m*.5,v=m*.7;o.fillStyle=r.color,o.beginPath(),o.arc(f.x,f.y,m,0,Math.PI*2),o.arc(f.x,f.y,y,0,Math.PI*2),o.fill("evenodd"),o.strokeStyle="#808080",o.lineWidth=1,o.beginPath(),o.moveTo(f.x-v,f.y),o.lineTo(f.x+v,f.y),o.stroke(),o.beginPath(),o.moveTo(f.x,f.y-v),o.lineTo(f.x,f.y+v),o.stroke()}else if(r.type==="pad"){const m=Math.max(.5,r.size/2),y=r.size,v=y*.5,x=m*.7;o.fillStyle=r.color,o.beginPath(),o.rect(f.x-m,f.y-m,y,y),o.rect(f.x-v/2,f.y-v/2,v,v),o.fill("evenodd"),o.strokeStyle="#808080",o.lineWidth=1,o.beginPath(),o.moveTo(f.x-x,f.y),o.lineTo(f.x+x,f.y),o.stroke(),o.beginPath(),o.moveTo(f.x,f.y-x),o.lineTo(f.x,f.y+x),o.stroke()}else if(r.type==="testPoint"){const m=Math.max(.5,r.size/2),y=m*.7;o.fillStyle=r.color||"#FFFF00",o.strokeStyle="#000000",o.lineWidth=2,o.beginPath(),o.moveTo(f.x,f.y-m),o.lineTo(f.x+m,f.y),o.lineTo(f.x,f.y+m),o.lineTo(f.x-m,f.y),o.closePath(),o.fill(),o.stroke(),o.strokeStyle="#808080",o.lineWidth=1,o.beginPath(),o.moveTo(f.x-y,f.y),o.lineTo(f.x+y,f.y),o.stroke(),o.beginPath(),o.moveTo(f.x,f.y-y),o.lineTo(f.x,f.y+y),o.stroke()}}),Xt.length>0){const r=lt;let f=!0;if(B==="draw"&&(Ne==="via"?f=hn:f=r==="top"?Dn:Ci),f)if(B==="draw")if(Ne==="via"){const m=Xt[Xt.length-1],y=Math.max(.5,M/2),v=y*.5,x=y*.7;o.fillStyle=J,o.beginPath(),o.arc(m.x,m.y,y,0,Math.PI*2),o.arc(m.x,m.y,v,0,Math.PI*2),o.fill("evenodd"),o.strokeStyle="#808080",o.lineWidth=1,o.beginPath(),o.moveTo(m.x-x,m.y),o.lineTo(m.x+x,m.y),o.stroke(),o.beginPath(),o.moveTo(m.x,m.y-x),o.lineTo(m.x,m.y+x),o.stroke()}else if(Ne==="pad"){const m=Xt[Xt.length-1],y=Math.max(.5,M/2),v=M,x=v*.5,T=y*.7;o.fillStyle=J,o.beginPath(),o.rect(m.x-y,m.y-y,v,v),o.rect(m.x-x/2,m.y-x/2,x,x),o.fill("evenodd"),o.strokeStyle="#808080",o.lineWidth=1,o.beginPath(),o.moveTo(m.x-T,m.y),o.lineTo(m.x+T,m.y),o.stroke(),o.beginPath(),o.moveTo(m.x,m.y-T),o.lineTo(m.x,m.y+T),o.stroke()}else if(Ne==="testPoint"){const m=Xt[Xt.length-1],y=Math.max(.5,M/2),v=y*.7;o.fillStyle=J,o.beginPath(),o.moveTo(m.x,m.y-y),o.lineTo(m.x+y,m.y),o.lineTo(m.x,m.y+y),o.lineTo(m.x-y,m.y),o.closePath(),o.fill(),o.strokeStyle="#808080",o.lineWidth=1,o.beginPath(),o.moveTo(m.x-v,m.y),o.lineTo(m.x+v,m.y),o.stroke(),o.beginPath(),o.moveTo(m.x,m.y-v),o.lineTo(m.x,m.y+v),o.stroke()}else{const m=ft||"top",y=m==="top"?D:E,v=m==="top"?W:me;if(Xt.length===1){const x=Xt[0],T=Math.max(.5,v/2);o.fillStyle=y,o.beginPath(),o.arc(x.x,x.y,T,0,Math.PI*2),o.fill(),Ml&&(o.strokeStyle=y,o.lineWidth=v,o.lineCap="round",o.lineJoin="round",o.globalAlpha=.6,o.beginPath(),o.moveTo(x.x,x.y),o.lineTo(Ml.x,Ml.y),o.stroke(),o.globalAlpha=1)}else if(o.strokeStyle=y,o.lineWidth=v,o.lineCap="round",o.lineJoin="round",o.globalAlpha=1,o.beginPath(),Xt.forEach((x,T)=>{T===0?o.moveTo(x.x,x.y):o.lineTo(x.x,x.y)}),o.stroke(),Ml&&Xt.length>0){const x=Xt[Xt.length-1];o.globalAlpha=.6,o.beginPath(),o.moveTo(x.x,x.y),o.lineTo(Ml.x,Ml.y),o.stroke(),o.globalAlpha=1}}else B==="erase"&&(o.strokeStyle="rgba(255, 0, 0, 0.5)",o.lineWidth=M,o.lineCap="round",o.lineJoin="round",o.globalAlpha=.5,o.beginPath(),Xt.forEach((m,y)=>{y===0?o.moveTo(m.x,m.y):o.lineTo(m.x,m.y)}),o.stroke())}},[He,mt,Dn,Ci,hn,Qi,Ut,fi,bl,Xt,B,Ne,J,M,lt,ft,D,E,W,me,Ml,Bs]),yc=b.useCallback((o,r)=>{if(Ui){alert("Cannot transform: Images are locked. Unlock images to transform them.");return}o==="top"&&g?d(f=>f?{...f,...r}:null):o==="bottom"&&R?I(f=>f?{...f,...r}:null):o==="both"&&(g&&d(f=>f?{...f,...r}:null),R&&I(f=>f?{...f,...r}:null))},[g,R,Ui]),pd=b.useCallback(()=>{Bt&&(yc(Bt,{x:0,y:0,scale:1,rotation:0,flipX:!1,flipY:!1,skewX:0,skewY:0,keystoneV:0,keystoneH:0,brightness:100,contrast:100}),Be(!1))},[yc,Bt]),bc=b.useCallback(()=>{if(mt.size>0||vt.size>0||It.size>0||jt.size>0){if(mt.size>0){const o=He.filter(y=>mt.has(y.id)),r=ji&&o.some(y=>y.type==="via"),f=Ti&&o.some(y=>y.type==="trace"),m=Xi&&o.some(y=>y.type==="pad");if(r){alert("Cannot change size: Vias are locked. Unlock vias to change their size.");return}if(f){alert("Cannot change size: Traces are locked. Unlock traces to change their size.");return}if(m){alert("Cannot change size: Pads are locked. Unlock pads to change their size.");return}}if(vt.size>0&&Gi){alert("Cannot change size: Components are locked. Unlock components to change their size.");return}if(It.size>0&&wn){alert("Cannot change size: Power nodes are locked. Unlock power nodes to change their size.");return}if(jt.size>0&&qi){alert("Cannot change size: Ground nodes are locked. Unlock ground nodes to change their size.");return}if(Pt(o=>o.map(r=>{if(mt.has(r.id)){const f=r.size+1;return r.type==="via"?Je("via",f):r.type==="pad"?Je("pad",f):r.type==="trace"&&Je("trace",f,r.layer),{...r,size:f}}return r})),vt.size>0){const o=(vt.size>0&&et.find(r=>vt.has(r.id))?.size||18)+1;Je("component",o),Qt(r=>r.map(f=>vt.has(f.id)?{...f,size:(f.size||18)+1}:f)),rn(r=>r.map(f=>vt.has(f.id)?{...f,size:(f.size||18)+1}:f))}if(It.size>0){const o=(yt.find(r=>It.has(r.id))?.size||18)+1;Je("power",o),oi(r=>r.map(f=>It.has(f.id)?{...f,size:f.size+1}:f))}if(jt.size>0){const o=(dt.find(r=>jt.has(r.id))?.size||18)+1;Je("ground",o),qn(r=>r.map(f=>jt.has(f.id)?{...f,size:(f.size||18)+1}:f))}}else{let o=null;if(B==="draw"&&Ne==="via"?o="via":B==="draw"&&Ne==="pad"?o=Bl.current==="bottom"?"padBottom":"padTop":B==="draw"&&Ne==="testPoint"?o=Ul.current==="bottom"?"testPointBottom":"testPointTop":B==="draw"&&Ne==="trace"?o=Xo.current==="bottom"?"traceBottom":"traceTop":B==="component"?o=Pl.current==="bottom"?"componentBottom":"componentTop":B==="power"?o="power":B==="ground"&&(o="ground"),o){const r=At.get(o),f=Math.min(40,r.size+1);At.setSize(o,f)}}},[mt,vt,It,jt,He,ji,Ti,Xi,jo,Gi,wn,qi,B,Ne,Je]),mc=b.useCallback(()=>{if(mt.size>0||vt.size>0||It.size>0||jt.size>0){if(mt.size>0){const o=He.filter(v=>mt.has(v.id)),r=ji&&o.some(v=>v.type==="via"),f=Ti&&o.some(v=>v.type==="trace"),m=Xi&&o.some(v=>v.type==="pad"),y=jo&&o.some(v=>v.type==="testPoint");if(r){alert("Cannot change size: Vias are locked. Unlock vias to change their size.");return}if(f){alert("Cannot change size: Traces are locked. Unlock traces to change their size.");return}if(m){alert("Cannot change size: Pads are locked. Unlock pads to change their size.");return}if(y){alert("Cannot change size: Test Points are locked. Unlock test points to change their size.");return}}if(vt.size>0&&Gi){alert("Cannot change size: Components are locked. Unlock components to change their size.");return}if(It.size>0&&wn){alert("Cannot change size: Power nodes are locked. Unlock power nodes to change their size.");return}if(jt.size>0&&qi){alert("Cannot change size: Ground nodes are locked. Unlock ground nodes to change their size.");return}if(Pt(o=>o.map(r=>{if(mt.has(r.id)){const f=Math.max(1,r.size-1);return r.type==="via"?Je("via",f):r.type==="pad"?Je("pad",f,r.layer):r.type==="testPoint"?Je("testPoint",f,r.layer):r.type==="trace"&&Je("trace",f,r.layer),{...r,size:f}}return r})),vt.size>0){const o=Math.max(1,(et.find(r=>vt.has(r.id))?.size||18)-1);Je("component",o),Qt(r=>r.map(f=>vt.has(f.id)?{...f,size:Math.max(1,(f.size||18)-1)}:f)),rn(r=>r.map(f=>vt.has(f.id)?{...f,size:Math.max(1,(f.size||18)-1)}:f))}if(It.size>0){const o=Math.max(1,(yt.find(r=>It.has(r.id))?.size||18)-1);Je("power",o),oi(r=>r.map(f=>It.has(f.id)?{...f,size:Math.max(1,f.size-1)}:f))}if(jt.size>0){const o=Math.max(1,(dt.find(r=>jt.has(r.id))?.size||18)-1);Je("ground",o),qn(r=>r.map(f=>jt.has(f.id)?{...f,size:Math.max(1,(f.size||18)-1)}:f))}}else{let o=null;if(B==="draw"&&Ne==="via"?o="via":B==="draw"&&Ne==="pad"?o=(lt||Lt||"top")==="bottom"?"padBottom":"padTop":B==="draw"&&Ne==="testPoint"?o=(lt||ln||"top")==="bottom"?"testPointBottom":"testPointTop":B==="draw"&&Ne==="trace"?o=(lt||ft||"top")==="bottom"?"traceBottom":"traceTop":B==="component"?o=(lt||vn||"top")==="bottom"?"componentBottom":"componentTop":B==="power"?o="power":B==="ground"&&(o="ground"),o){const r=At.get(o),f=Math.max(1,r.size-1);At.setSize(o,f)}}},[mt,vt,It,jt,He,ji,Ti,Xi,jo,Gi,wn,qi,B,Ne,lt,Lt,ln,ft,vn,Je]),hd=b.useCallback(()=>{const o=qr.size;if(mt.size>0||vt.size>0||It.size>0||jt.size>0){if(mt.size>0){const r=He.filter(x=>mt.has(x.id)),f=ji&&r.some(x=>x.type==="via"),m=Xi&&r.some(x=>x.type==="pad"),y=Ti&&r.some(x=>x.type==="trace"),v=jo&&r.some(x=>x.type==="testPoint");if(f||m||y||v){alert("Cannot change size: selected items are locked.");return}}if(vt.size>0&&Gi){alert("Cannot change size: selected components are locked.");return}if(It.size>0&&wn){alert("Cannot change size: selected power nodes are locked.");return}if(jt.size>0&&qi){alert("Cannot change size: selected ground nodes are locked.");return}Pt(r=>r.map(f=>mt.has(f.id)?(f.type==="via"?(Je("via",o),on(m=>{const y=new Map(m),v=y.get("via");return v&&y.set("via",{...v,settings:{...v.settings,size:o}}),y})):f.type==="pad"?(Je("pad",o,f.layer),on(m=>{const y=new Map(m),v=y.get("pad");if(v){const x=new Map(v.layerSettings);x.set(f.layer,{...x.get(f.layer)||{color:v.settings.color,size:o},size:o}),y.set("pad",{...v,layerSettings:x})}return y})):f.type==="testPoint"?(Je("testPoint",o,f.layer),on(m=>{const y=new Map(m),v=y.get("testPoint");if(v){const x=new Map(v.layerSettings);x.set(f.layer,{...x.get(f.layer)||{color:v.settings.color,size:o},size:o}),y.set("testPoint",{...v,layerSettings:x})}return y})):f.type==="trace"&&Je("trace",o,f.layer),{...f,size:o}):f)),vt.size>0&&(Je("component",o),Qt(r=>r.map(f=>vt.has(f.id)?{...f,size:o}:f)),rn(r=>r.map(f=>vt.has(f.id)?{...f,size:o}:f))),It.size>0&&(Je("power",o),oi(r=>r.map(f=>It.has(f.id)?{...f,size:o}:f))),jt.size>0&&(Je("ground",o),qn(r=>r.map(f=>jt.has(f.id)?{...f,size:o}:f)))}else z(o),B==="draw"&&Ne==="trace"?lt==="top"?(j(o),Je("trace",o,"top")):(be(o),Je("trace",o,"bottom")):B==="draw"&&Ne==="via"?Je("via",o):B==="draw"&&Ne==="pad"?Je("pad",o,lt):B==="draw"&&Ne==="testPoint"?Je("testPoint",o,lt):Je(B==="component"?"component":B==="power"?"power":B==="ground"?"ground":"brush",o);Zr({visible:!1,size:6})},[qr.size,mt,vt,It,jt,He,ji,Ti,Gi,wn,qi,B,Ne,lt,Je,Ht,on]),du=b.useCallback(()=>{Pi({visible:!1,source:null,interval:5})},[]),gd=b.useCallback(async(o,r=!1)=>{if(o===null){yn(!1),El(null),Vt.current&&(clearInterval(Vt.current),Vt.current=null),ea({visible:!1,interval:5}),r&&Pi({visible:!1,source:null,interval:5}),console.log("Auto save: Disabled");return}if(!Zn){alert("Please create a new project (File -> New Project) or open an existing project (File -> Open Project) first.");return}let f=cn;if(!f){const x=window;if(typeof x.showDirectoryPicker=="function")try{f=await x.showDirectoryPicker(),Zi(f)}catch(T){T?.name!=="AbortError"&&(console.error("Failed to get directory:",T),alert("Failed to select project directory."));return}else{alert("Directory picker is not supported in this browser. Auto-save requires a directory handle.");return}}Co(f);const m=Zn.replace(/\.json$/i,""),v=Wc(m).replace(/[^a-zA-Z0-9_-]/g,"_");ll(v),Vo.current=f,zl.current=v,El(o),yn(!0),Ei.current=!0,ea({visible:!1,interval:5}),r&&Pi({visible:!1,source:null,interval:5}),setTimeout(()=>{console.log(`Auto save: Enabled with interval ${o} minutes`),Qc.current&&Qc.current()},200)},[Zn,cn,yn,El,Co,ll,ea,Pi,Zi]),is=b.useCallback(()=>{te("select"),we(new Set),nt(new Set),st(new Set),pt(new Set)},[we,nt,st,pt]),vc=b.useCallback(o=>{if(o.key==="Escape"){const y=document.activeElement;if(y&&(y.tagName==="INPUT"&&y.type==="checkbox"||y.tagName==="INPUT"&&y.type==="radio")){y.blur(),o.preventDefault(),o.stopPropagation();return}}const r=document.activeElement;if(r&&(r.tagName==="INPUT"&&r.type!=="checkbox"&&r.type!=="radio"||r.tagName==="TEXTAREA"||r.isContentEditable)||os.current>0&&o.key!=="m"&&o.key!=="M")return;const m=parseInt(o.key);if(!isNaN(m)&&m>=0&&m<=9){if(o.preventDefault(),o.stopPropagation(),B==="center"&&sa){Qn.current&&(clearTimeout(Qn.current),Qn.current=null);const v=Sn.current;if(v){const x=v.width-10,T=v.height-10,C=x/2,k=T/2,N=(C-kt.x)/Fe,U=(k-kt.y)/Fe;Pa(le=>({...le,[m]:{x:N,y:U,zoom:Fe,showTopImage:oo,showBottomImage:ci,showViasLayer:hn,showTopTracesLayer:Dn,showBottomTracesLayer:Ci,showTopPadsLayer:Qi,showBottomPadsLayer:Ut,showTopTestPointsLayer:fi,showBottomTestPointsLayer:bl,showTopComponents:al,showBottomComponents:hi,showPowerLayer:ml,showGroundLayer:zi,showConnectionsLayer:Vl}}))}Hl(!1),te("select"),Xn(void 0);return}const y=aa[m];if(y){mi(y.zoom);const v=Sn.current;let x=0,T=0;if(v){const C=v.width-10,k=v.height-10,N=C/2,U=k/2;x=N-y.x*y.zoom,T=U-y.y*y.zoom}Hn({x,y:T}),Pn(y.showTopImage),di(y.showBottomImage),ui(y.showViasLayer),Ao(y.showTopTracesLayer),ao(y.showBottomTracesLayer),bn(y.showTopPadsLayer),Tt(y.showBottomPadsLayer),pi(y.showTopTestPointsLayer),ol(y.showBottomTestPointsLayer),so(y.showTopComponents),_i(y.showBottomComponents),vl(y.showPowerLayer),co(y.showGroundLayer),Wl(y.showConnectionsLayer)}return}if(o.key==="+"||o.key==="="){o.preventDefault(),o.stopPropagation(),bc();return}if(o.key==="-"||o.key==="_"){o.preventDefault(),o.stopPropagation(),mc();return}if((o.key==="ArrowUp"||o.key==="ArrowDown"||o.key==="ArrowLeft"||o.key==="ArrowRight")&&vt.size>0){o.preventDefault(),o.stopPropagation();const y=o.shiftKey?10:1;let v=0,x=0;o.key==="ArrowUp"?x=-y:o.key==="ArrowDown"?x=y:o.key==="ArrowLeft"?v=-y:o.key==="ArrowRight"&&(v=y);for(const T of vt){const C=et.find(k=>k.id===T);if(C){const k=C.x+v,N=C.y+x,U=Yt({x:k,y:N});Qt(le=>le.map(K=>K.id===T?{...K,x:U.x,y:U.y}:K))}else{const k=rt.find(N=>N.id===T);if(k){const N=k.x+v,U=k.y+x,le=Yt({x:N,y:U});rn(K=>K.map(X=>X.id===T?{...X,x:le.x,y:le.y}:X))}}}return}if((o.key==="I"||o.key==="i")&&!o.ctrlKey&&!o.shiftKey&&!o.altKey){const y=document.activeElement;if(!!y&&(y.tagName==="INPUT"&&y.type!=="range"&&y.type!=="checkbox"&&y.type!=="radio"||y.tagName==="TEXTAREA"||y.isContentEditable))return;o.preventDefault(),o.stopPropagation();const x=[];mt.size>0,mt.size===0&&vt.size===0&&It.size===0&&jt.size===0&&x.push(`
No objects selected.`);const T=x.join(`
`);console.log(T),ta({visible:!0,text:T});return}if((o.key==="N"||o.key==="n")&&!o.ctrlKey&&!o.shiftKey&&!o.altKey){const y=document.activeElement;if(!!y&&(y.tagName==="INPUT"&&y.type!=="range"&&y.type!=="checkbox"&&y.type!=="radio"||y.tagName==="TEXTAREA"||y.isContentEditable))return;o.preventDefault(),o.stopPropagation(),jl(!0);return}if((o.key==="L"||o.key==="l")&&!o.ctrlKey&&!o.shiftKey&&!o.altKey){const y=document.activeElement;if(!!y&&(y.tagName==="INPUT"&&y.type!=="range"&&y.type!=="checkbox"&&y.type!=="radio"||y.tagName==="TEXTAREA"||y.isContentEditable))return;o.preventDefault(),o.stopPropagation(),uu();return}if(o.key==="O"||o.key==="o"){const y=document.activeElement;if(!!y&&(y.tagName==="INPUT"&&y.type!=="range"&&y.type!=="checkbox"&&y.type!=="radio"||y.tagName==="TEXTAREA"||y.isContentEditable))return;o.preventDefault(),o.stopPropagation();const x=aa[0];if(x){mi(x.zoom);const T=Sn.current;let C=0,k=0;if(T){const N=T.width-10,U=T.height-10,le=N/2,K=U/2;C=le-x.x*x.zoom,k=K-x.y*x.zoom}Hn({x:C,y:k}),Pn(x.showTopImage),di(x.showBottomImage),ui(x.showViasLayer),Ao(x.showTopTracesLayer),ao(x.showBottomTracesLayer),bn(x.showTopPadsLayer),Tt(x.showBottomPadsLayer),pi(x.showTopTestPointsLayer),ol(x.showBottomTestPointsLayer),so(x.showTopComponents),_i(x.showBottomComponents),vl(x.showPowerLayer),co(x.showGroundLayer),Wl(x.showConnectionsLayer)}else{mi(1);const T=Sn.current;let C=0,k=0;if(T){const N=T.width-10,U=T.height-10,le=N/2,K=U/2;C=le,k=K}document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),Hn({x:C,y:k})}q("overlay"),we(new Set),nt(new Set),st(new Set),pt(new Set),te("select");return}if((o.key==="Alt"||o.altKey)&&(hc(!0),eu(!0)),o.key==="Escape"){o.preventDefault(),o.stopPropagation(),is(),_o(!1),Za(!1),ha(!1),Ho(!1),rl(!1),Jn(!1),io(!1),dd(null);return}if(o.key==="Enter"&&B==="draw"&&Ne==="trace"){ns();return}if((o.key==="Delete"||o.key==="Backspace")&&(mt.size>0||vt.size>0||It.size>0||jt.size>0)){if(o.preventDefault(),o.stopPropagation(),pl(He,et,rt,Bi,ai),mt.size>0){const y=He.filter(k=>mt.has(k.id)),v=ji&&y.some(k=>k.type==="via"),x=Ti&&y.some(k=>k.type==="trace"),T=Xi&&y.some(k=>k.type==="pad"),C=jo&&y.some(k=>k.type==="testPoint");v?alert("Cannot delete: Vias are locked. Unlock vias to delete them."):x?alert("Cannot delete: Traces are locked. Unlock traces to delete them."):T?alert("Cannot delete: Pads are locked. Unlock pads to delete them."):C?alert("Cannot delete: Test points are locked. Unlock test points to delete them."):(Pt(k=>k.filter(N=>!mt.has(N.id))),we(new Set))}vt.size>0&&(Gi?alert("Cannot delete: Components are locked. Unlock components to delete them."):(Qt(y=>y.filter(v=>!vt.has(v.id))),rn(y=>y.filter(v=>!vt.has(v.id))),nt(new Set))),It.size>0&&(wn?alert("Cannot delete: Power nodes are locked. Unlock power nodes to delete them."):(oi(y=>y.filter(v=>!It.has(v.id))),st(new Set))),jt.size>0&&(qi?alert("Cannot delete: Ground nodes are locked. Unlock ground nodes to delete them."):(qn(y=>y.filter(v=>!jt.has(v.id))),pt(new Set)));return}if((o.key==="z"||o.key==="Z")&&(o.ctrlKey||o.metaKey)&&!o.shiftKey&&!o.altKey){const y=document.activeElement;if(!!y&&(y.tagName==="INPUT"&&y.type!=="range"&&y.type!=="checkbox"&&y.type!=="radio"||y.tagName==="TEXTAREA"||y.isContentEditable))return;o.preventDefault(),o.stopPropagation();const x=Xd();if(x){const T=new Set(x.drawingStrokes.map(U=>U.id));for(const U of He)if(!T.has(U.id))for(const le of U.points)le.id&&typeof le.id=="number"&&Fu(le.id);const C=new Set([...x.componentsTop.map(U=>U.id),...x.componentsBottom.map(U=>U.id)]);for(const U of[...et,...rt])if(!C.has(U.id)){for(const le of U.pinConnections)if(le&&le.trim()!==""){const K=parseInt(le,10);!isNaN(K)&&K>0&&Fu(K)}}const k=new Set(x.powerSymbols.map(U=>U.id));for(const U of Bi)!k.has(U.id)&&U.pointId&&typeof U.pointId=="number"&&Fu(U.pointId);const N=new Set(x.groundSymbols.map(U=>U.id));for(const U of ai)!N.has(U.id)&&U.pointId&&typeof U.pointId=="number"&&Fu(U.pointId);Pt(x.drawingStrokes),Qt(x.componentsTop),rn(x.componentsBottom),oi(x.powerSymbols),qn(x.groundSymbols),bi([])}return}if(!o.ctrlKey&&!o.altKey){const y=document.activeElement;if(!(!!y&&(y.tagName==="INPUT"&&y.type!=="range"&&y.type!=="checkbox"&&y.type!=="radio"||y.tagName==="TEXTAREA"||y.isContentEditable)))switch(o.key){case"s":case"S":o.preventDefault(),is();return;case"b":case"B":o.preventDefault(),Ke.length===1?(Va(Ke[0].id),te("power"),Jn(!1)):Ke.length>1?Jn(!0):(Jn(!0),te("power"));return;case"g":case"G":o.preventDefault(),Gt.length===1?(Fa(Gt[0].id),te("ground"),jn(!1)):Gt.length>1?jn(!0):(jn(!0),te("ground"));return;case"v":case"V":o.preventDefault(),Yn("via"),te("draw");return;case"p":case"P":o.preventDefault(),Yn("pad"),te("draw"),Cn(Lt||"top");return;case"y":case"Y":o.preventDefault(),Yn("testPoint"),te("draw"),Cn(ln||"top");return;case"t":case"T":o.preventDefault(),Yn("trace"),te("draw"),Cn(ft||"top");return;case"c":case"C":o.preventDefault(),te("component"),Dr.current?(es(Dr.current),Ho(!1),rl(!1)):(Ho(!0),rl(!1),es(null));return;case"e":case"E":o.preventDefault(),te("erase");return;case"h":case"H":o.preventDefault(),te("pan");return;case"x":case"X":o.preventDefault(),te("center"),Hl(!0),Qn.current&&clearTimeout(Qn.current),Qn.current=setTimeout(()=>{Hl(!1),te("select"),Xn(void 0)},2e3);return;case"m":case"M":if(!o.ctrlKey){o.preventDefault(),Ua(!1),te("magnify");return}break}}if(B==="transform"&&Bt){if(!(o.key==="ArrowLeft"||o.key==="ArrowRight"||o.key==="ArrowUp"||o.key==="ArrowDown"))return;o.preventDefault(),o.stopPropagation();const v=document.activeElement;if(v&&v.tagName==="INPUT"){const x=v;x.type==="radio"&&x.blur()}if(Ui)return;if(dl==="nudge"){let x=0,T=0;switch(o.key){case"ArrowLeft":x=-1;break;case"ArrowRight":x=1;break;case"ArrowUp":T=-1;break;case"ArrowDown":T=1;break;default:return}Bt==="top"&&g?d(C=>C?{...C,x:C.x+x,y:C.y+T}:null):Bt==="bottom"&&R?I(C=>C?{...C,x:C.x+x,y:C.y+T}:null):Bt==="both"&&(g&&d(C=>C?{...C,x:C.x+x,y:C.y+T}:null),R&&I(C=>C?{...C,x:C.x+x,y:C.y+T}:null))}else if(dl==="scale"){let x=0;switch(o.key){case"ArrowUp":x=.01;break;case"ArrowDown":x=-.01;break;case"ArrowRight":x=.001;break;case"ArrowLeft":x=-.001;break;default:return}if(Bt==="top"){g&&d(T=>T?{...T,scale:Math.max(.1,Math.min(3,T.scale+x))}:null);return}if(Bt==="bottom"){R&&I(T=>T?{...T,scale:Math.max(.1,Math.min(3,T.scale+x))}:null);return}if(Bt==="both"){g&&d(T=>T?{...T,scale:Math.max(.1,Math.min(3,T.scale+x))}:null),R&&I(T=>T?{...T,scale:Math.max(.1,Math.min(3,T.scale+x))}:null);return}}else if(dl==="rotate"){let x=0;switch(o.key){case"ArrowUp":x=1;break;case"ArrowDown":x=-1;break;case"ArrowRight":x=.1;break;case"ArrowLeft":x=-.1;break;default:return}if(Bt==="top"){g&&d(T=>T?{...T,rotation:T.rotation+x}:null);return}if(Bt==="bottom"){R&&I(T=>T?{...T,rotation:T.rotation+x}:null);return}if(Bt==="both"){g&&d(T=>T?{...T,rotation:T.rotation+x}:null),R&&I(T=>T?{...T,rotation:T.rotation+x}:null);return}}else if(dl==="slant"){let x=0,T=0;switch(o.key){case"ArrowUp":T=-.5;break;case"ArrowDown":T=.5;break;case"ArrowLeft":x=-.5;break;case"ArrowRight":x=.5;break}if(x!==0||T!==0){const C=N=>N*Math.PI/180,k=N=>Math.max(-.7,Math.min(.7,N));if(Bt==="top"){g&&d(N=>N?{...N,skewX:k((N.skewX||0)+C(x)),skewY:k((N.skewY||0)+C(T))}:null);return}if(Bt==="bottom"){R&&I(N=>N?{...N,skewX:k((N.skewX||0)+C(x)),skewY:k((N.skewY||0)+C(T))}:null);return}if(Bt==="both"){g&&d(N=>N?{...N,skewX:k((N.skewX||0)+C(x)),skewY:k((N.skewY||0)+C(T))}:null),R&&I(N=>N?{...N,skewX:k((N.skewX||0)+C(x)),skewY:k((N.skewY||0)+C(T))}:null);return}}}else if(dl==="keystone"){let x=0,T=0;switch(o.key){case"ArrowUp":T=-.5;break;case"ArrowDown":T=.5;break;case"ArrowLeft":x=-.5;break;case"ArrowRight":x=.5;break}if(x!==0||T!==0){const C=N=>N*Math.PI/180,k=N=>Math.max(-.35,Math.min(.35,N));if(Bt==="top"){g&&d(N=>N?{...N,keystoneH:k((N.keystoneH||0)+C(x)),keystoneV:k((N.keystoneV||0)+C(T))}:null);return}if(Bt==="bottom"){R&&I(N=>N?{...N,keystoneH:k((N.keystoneH||0)+C(x)),keystoneV:k((N.keystoneV||0)+C(T))}:null);return}if(Bt==="both"){g&&d(N=>N?{...N,keystoneH:k((N.keystoneH||0)+C(x)),keystoneV:k((N.keystoneV||0)+C(T))}:null),R&&I(N=>N?{...N,keystoneH:k((N.keystoneH||0)+C(x)),keystoneV:k((N.keystoneV||0)+C(T))}:null);return}}}}else{const y=o.target;if(y.tagName==="INPUT"&&y.type==="range"){const v=y,x=Number(v.value),T=Number(v.min),C=Number(v.max),k=Number(v.step)||1;switch(o.key){case"ArrowLeft":o.preventDefault();const N=Math.max(T,x-k);v.value=N.toString(),v.dispatchEvent(new Event("input",{bubbles:!0}));break;case"ArrowRight":o.preventDefault();const U=Math.min(C,x+k);v.value=U.toString(),v.dispatchEvent(new Event("input",{bubbles:!0}));break}}}},[B,Bt,dl,g,R,mt,vt,It,jt,He,et,rt,yt,dt,Ke,Ne,ns,ft,D,E,W,me,is,Qt,rn,Xd,Pt,oi,qn,Bi,ai]);_e.useEffect(()=>{B!=="transform"&&Fi(null)},[B]),_e.useEffect(()=>{window.addEventListener("keydown",vc,!0);const o=r=>{r.key==="Alt"&&(hc(!1),eu(!1),Ro(null))};return window.addEventListener("keyup",o,!0),()=>{window.removeEventListener("keydown",vc,!0),window.removeEventListener("keyup",o,!0)}},[vc,It,jt,wn,wn,yt,dt,bc,mc,is,vt,et,rt,Qt,rn,aa,sa,B]);const ya=b.useCallback(()=>{ra.current={},P("#AA4499"),pe("#F781BF"),j(6),be(6),ut("trace","#AA4499","top"),ut("trace","#F781BF","bottom"),Je("trace",6,"top"),Je("trace",6,"bottom"),_("#0072B2"),Y("#56B4E9"),L(18),A(18),ut("pad","#0072B2","top"),ut("pad","#56B4E9","bottom"),Je("pad",18,"top"),Je("pad",18,"bottom"),Vi("#6A3D9A"),yi("#9467BD"),Nl(18),Ql(18),ut("component","#6A3D9A","top"),ut("component","#9467BD","bottom"),Je("component",18,"top"),Je("component",18,"bottom"),Bn("top"),ne("#AA4499"),z(6),Mi([{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),Ol([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),Je("power",18),Je("ground",18),Ss(!1),ws(!1),Jo(!1),js(!1),Da(!1),Ts(!1),Cn("top"),te("select"),V(50),he(!1),q("overlay"),Dh(),Qo()},[ut,Je,Qo]),Sc=b.useCallback(()=>{Zi(null),Co(null),ba&&(ba.current=null),Vo&&(Vo.current=null),Un(""),gl("pcb_project"),yn(!1),El(null),ll(""),xl([]),gr(-1),zl&&(zl.current=""),Ei.current=!1,lo(!1),Jr(!1),Kd(null),Qd(null),Vt.current&&(clearInterval(Vt.current),Vt.current=null),d(null),I(null),Qo(),Pt([]),xn([]),Si([]),ms([]),Yi([]),bi([]),So.current=[],Qt([]),rn([]),Ra(null),Zo(null),oi([]),qn([]),Ko(null),Mi([{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),Ol([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),we(new Set),nt(new Set),st(new Set),pt(new Set),za(!1),Tl([]),q("overlay"),mi(1),Hn({x:0,y:0}),ul(!0),Cn("top"),Pa({}),Hl(!1),Qn.current&&(clearTimeout(Qn.current),Qn.current=null),Fi(null),Li(!1),$i(null),no("nudge"),Be(!1),V(50),he(!1),Me(2e3),Ss(!1),ws(!1),pr(!1),Xc(!1),Jo(!1),js(!1),Da(!1),Ts(!1),Pn(!0),di(!0),ui(!0),Ao(!0),ao(!0),bn(!0),Tt(!0),pi(!0),ol(!0),so(!0),_i(!0),vl(!0),co(!0),Wl(!0),sc(!0),te("select"),Yn("trace"),Bn("top"),wa("top"),sr("top"),wo("top"),Xo.current="top",Bl.current="top",Ul.current="top",Pl.current="top",ra.current={},Tr(!0),wl(!1),Dh(),hr(null),ta({visible:!1,text:""}),Aa({visible:!1,title:"",message:""}),na({visible:!1}),ks({visible:!1}),Na({visible:!1,projectName:"",locationPath:"",locationHandle:null}),la({visible:!1,filename:"",locationPath:"",locationHandle:null}),ea({visible:!1,interval:null}),Pi({visible:!1,source:"new",interval:5}),io(!1),Sl(!1),Wa(!1),La(!1),_s(!1),jl(!1),ca(!1),Rs(!1),Es(null),Ro(null),Oa(null),oa(!1),Kn.current=null,_l.current=null,vo(!1),Wi(null),lr.current=0,eo.current=!1,console.log("Project closed: All state cleared and browser permissions released")},[Zi,Co,Un,gl,yn,El,ll,xl,gr,d,I,Pt,bi,xn,Si,ms,Yi,Qt,rn,Ra,Zo,oi,qn,Ko,Mi,Ol,we,nt,st,pt,za,Tl,q,mi,Hn,ul,Cn,Pa,Hl,Fi,Li,$i,no,Be,V,he,Me,Ss,ws,pr,Xc,Jo,js,Da,Ts,Pn,di,ui,Ao,ao,bn,Tt,pi,ol,so,_i,vl,co,Wl,te,Yn,Bn,wa,sr,wo,Tr,wl,hr,ta,Aa,na,Na,la,ea,Pi,Qo,io,Sl,Wa,La,_s,jl,ca,Es,Ro,Oa,oa,vo,Wi]),Xl=b.useCallback(()=>{ya(),setTimeout(()=>{mi(1);const o=Sn.current,r=xr.current;let f=0,m=0;if(o&&r){const y=o.getBoundingClientRect(),v=r.getBoundingClientRect(),x=o.width-10,T=o.height-10,N=60+168+6,U=y.left-v.left,le=N-U,K=y.width-Math.max(0,le),X=le+K/2,oe=y.height/2,ae=x/2,ee=T/2,ve=y.width/o.width,Ae=y.height/o.height,Re=X/ve,ze=oe/Ae,Ve=Re-5,Ie=ze-5;f=Ve-ae,m=Ie-ee}document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),Hn({x:f,y:m}),we(new Set),nt(new Set),st(new Set),pt(new Set)},100)},[ya]);_e.useEffect(()=>{Xl()},[]),_e.useEffect(()=>{if(!zs.visible)return;const o=[];mt.size>0,mt.size===0&&vt.size===0&&It.size===0&&jt.size===0&&o.push(`
No objects selected.`);const r=o.join(`
`);ta(f=>({...f,text:r}))},[zs.visible,mt,vt,It,jt,He,et,rt,yt,dt,Ke]),_e.useEffect(()=>{const o=r=>{const f=Sn.current;if(f&&!(xa.current&&xa.current.contains(r.target))&&!(r.target instanceof Node&&f.contains(r.target))){if(ns(),dn){const m=pa.current;(!m||!(r.target instanceof Node)||!m.contains(r.target))&&_o(!1)}if(ga){const m=xa.current;(!m||!(r.target instanceof Node)||!m.contains(r.target))&&(Ho(!1),te("select"))}if(Ja){const m=rd.current;(!m||!(r.target instanceof Node)||!m.contains(r.target))&&(rl(!1),dd(null))}if(Ma){const m=br.current;!r.target?.closest('button[title="Color Picker"]')&&(!m||!(r.target instanceof Node)||!m.contains(r.target))&&io(!1)}}};return document.addEventListener("mousedown",o,!0),()=>document.removeEventListener("mousedown",o,!0)},[ns,dn,Rr,ga,Ja,Ma]);const ls=o=>{if(!o.current)return{top:0,left:0};const r=o.current.getBoundingClientRect(),f=xr.current?.getBoundingClientRect();return f?{top:r.top-f.top,left:r.left-f.left+r.width+4}:{top:0,left:0}},wc=b.useCallback(()=>{pa.current&&Ar.current&&requestAnimationFrame(()=>{if(pa.current&&Ar.current){const o=ls(Ar);pa.current.style.top=`${o.top}px`,pa.current.style.left=`${o.left}px`}})},[]),Or=b.useCallback(()=>{Ka.current&&Nr.current&&requestAnimationFrame(()=>{if(Ka.current&&Nr.current){const o=ls(Nr);Ka.current.style.top=`${o.top}px`,Ka.current.style.left=`${o.left}px`}})},[]),jc=b.useCallback(()=>{Qa.current&&Mr.current&&requestAnimationFrame(()=>{if(Qa.current&&Mr.current){const o=ls(Mr);Qa.current.style.top=`${o.top}px`,Qa.current.style.left=`${o.left}px`}})},[]);_e.useEffect(()=>{dn&&wc()},[dn,wc]),_e.useEffect(()=>{Rr&&Or()},[Rr,Or]),_e.useEffect(()=>{ad&&jc()},[ad,jc]),_e.useEffect(()=>{if(ga&&xa.current&&Br.current){const o=ls(Br);xa.current.style.top=`${o.top}px`,xa.current.style.left=`${o.left}px`}},[ga]),_e.useEffect(()=>{if(ac&&ni.current&&pc.current){const o=ls(pc);ni.current.style.top=`${o.top}px`,ni.current.style.left=`${o.left}px`}},[ac]),_e.useEffect(()=>{if(jr&&mn.current&&cd.current){const o=ls(cd);mn.current.style.top=`${o.top}px`,mn.current.style.left=`${o.left}px`}},[jr]),_e.useEffect(()=>{const o=r=>{if(!Rn)return;const f=document.querySelector("[data-component-editor-dialog]");if(f&&r.target instanceof Node&&f.contains(r.target)){const Ie=r.target;if(Ie.tagName==="BUTTON"||Ie.tagName==="INPUT"||Ie.closest("button")||Ie.closest("input"))return}const m=Sn.current;if(!m)return;const y=m.getBoundingClientRect(),v=r.clientX,x=r.clientY;if(v<y.left||v>y.right||x<y.top||x>y.bottom)return;const T=m.width/y.width,C=m.height/y.height,k=v-y.left,N=x-y.top,U=k*T,le=N*C,K=U-5,X=le-5,oe=(K-kt.x)/Fe,ae=(X-kt.y)/Fe;let ee=1/0,ve=null,Ae=null;const Re=Math.max(6/Fe,4),Ve=[...et,...rt].find(Ie=>Ie.id===Rn.componentId)?.layer||"top";for(const Ie of He)if((Ie.type==="via"||Ie.type==="pad")&&Ie.points.length>0){if(Ie.type==="pad"&&(Ie.layer||"top")!==Ve)continue;const Q=Ie.points[0],H=Math.max(1,Ie.size/2),Se=Math.hypot(Q.x-oe,Q.y-ae),ge=Math.max(H,Re);Se<=ge&&Se<ee&&(ee=Se,ve=Q.id??null,Ae=Ie)}if(ve!=null&&Ae){console.log(`
[PIN CONNECTION - DOCUMENT HANDLER] Found via!`),console.log(`  Point ID: ${ve}`),console.log(`  Connecting pin ${Rn.pinIndex+1} of component ${Rn.componentId}`);const Ie=String(ve),Q=Rn.pinIndex,H=Rn.componentId,Se=et.find(Ue=>Ue.id===H),ge=rt.find(Ue=>Ue.id===H);if(Se){const Ue=He;Qt(We=>{const ot=We.find(Ee=>Ee.id===H);if(!ot)return We;const Ye=ot.pinConnections||[],qe=Ye.length>0?[...Ye]:new Array(ot.pinCount).fill("");let it;if(qe.length!==ot.pinCount){it=new Array(ot.pinCount).fill("");for(let Ee=0;Ee<Math.min(qe.length,ot.pinCount);Ee++)it[Ee]=qe[Ee]||""}else it=[...qe];it[Q]=Ie,console.log(`Updated pin ${Q} with value: ${Ie}`),console.log("New pinConnections:",it);const wt=We.find(Ee=>Ee.id===H),$e=wt?Jf(wt,it,Ue):null;return We.map(Ee=>{if(Ee.id===H){const ht={...Ee,pinConnections:it};return $e&&(ht.pinPolarities=$e),ht}return Ee})})}else if(ge){const Ue=He;rn(We=>{const ot=We.find(Ee=>Ee.id===H);if(!ot)return We;const Ye=ot.pinConnections||[],qe=Ye.length>0?[...Ye]:new Array(ot.pinCount).fill("");let it;if(qe.length!==ot.pinCount){it=new Array(ot.pinCount).fill("");for(let Ee=0;Ee<Math.min(qe.length,ot.pinCount);Ee++)it[Ee]=qe[Ee]||""}else it=[...qe];it[Q]=Ie,console.log(`Updated pin ${Q} with value: ${Ie}`),console.log("New pinConnections:",it);const wt=We.find(Ee=>Ee.id===H),$e=wt?Jf(wt,it,Ue):null;return We.map(Ee=>{if(Ee.id===H){const ht={...Ee,pinConnections:it};return $e&&(ht.pinPolarities=$e),ht}return Ee})})}setTimeout(()=>{Zo(null)},0)}else console.log("[PIN CONNECTION - DOCUMENT HANDLER] No via found at click location")};if(Rn)return document.addEventListener("mousedown",o,!0),()=>document.removeEventListener("mousedown",o,!0)},[Rn,et,rt,He,Fe,kt.x,kt.y]);const ki=b.useCallback((o,r,f,m)=>{const y=window.innerWidth,v=window.innerHeight,x=10;let T=Math.max(x,Math.min(o,y-f-x)),C=Math.max(x,Math.min(r,v-m-x));return{x:T,y:C}},[]);_e.useEffect(()=>{if(!cr)return;const o=f=>{if(!vs)return;const m={x:f.clientX-vs.x,y:f.clientY-vs.y},y=ki(m.x,m.y,250,window.innerHeight*.4);il(y),localStorage.setItem("componentDialogPosition",JSON.stringify(y))},r=()=>{dr(!1),ur(null)};return document.addEventListener("mousemove",o),document.addEventListener("mouseup",r),()=>{document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",r)}},[cr,vs,ki]),_e.useEffect(()=>{if(!rc)return;const o=f=>{if(!Uo)return;const m={x:f.clientX-Uo.x,y:f.clientY-Uo.y},y=ki(m.x,m.y,250,window.innerHeight*.4);Fl(y),localStorage.setItem("detailedInfoDialogPosition",JSON.stringify(y))},r=()=>{id(!1),Us(null)};return document.addEventListener("mousemove",o),document.addEventListener("mouseup",r),()=>{document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",r)}},[rc,Uo,ki]),_e.useEffect(()=>{if(!Oo)return;const o=f=>{if(!Ll)return;const m={x:f.clientX-Ll.x,y:f.clientY-Ll.y};Cr(m),localStorage.setItem("notesDialogPosition",JSON.stringify(m))},r=()=>{ld(!1),cc(null)};return document.addEventListener("mousemove",o),document.addEventListener("mouseup",r),()=>{document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",r)}},[Oo,Ll]),_e.useEffect(()=>{if(Ps&&Po===null){const o=localStorage.getItem("notesDialogPosition");if(o)try{const r=JSON.parse(o);Cr(r)}catch{Cr({x:window.innerWidth-550,y:100})}else Cr({x:window.innerWidth-550,y:100})}},[Ps,Po]),_e.useEffect(()=>{if(!Xa)return;const o=f=>{if(!zr)return;const m={x:f.clientX-zr.x,y:f.clientY-zr.y};Ya(m),localStorage.setItem("projectNotesDialogPosition",JSON.stringify(m))},r=()=>{Ga(!1),dc(null)};return document.addEventListener("mousemove",o),document.addEventListener("mouseup",r),()=>{document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",r)}},[Xa,zr]),_e.useEffect(()=>{if(uo&&da===null){const o=localStorage.getItem("projectNotesDialogPosition");if(o)try{const r=JSON.parse(o);Ya(r)}catch{Ya({x:100,y:100})}else Ya({x:100,y:100})}},[uo,da]);const uu=b.useCallback(()=>{ca(!0)},[]);_e.useEffect(()=>{if(ka&&ka.visible&&nl===null){const o=localStorage.getItem("componentDialogPosition");let r;if(o)try{const f=JSON.parse(o);r=ki(f.x,f.y,250,window.innerHeight*.4),il(r)}catch{r=ki(window.innerWidth-280,90,250,window.innerHeight*.4),il(r)}else r=ki(window.innerWidth-280,90,250,window.innerHeight*.4),il(r)}else!ka||ka.visible},[ka,nl,ki]),_e.useEffect(()=>{if(zs.visible&&ti===null){const o=localStorage.getItem("detailedInfoDialogPosition");let r;if(o)try{const f=JSON.parse(o);r=ki(f.x,f.y,400,window.innerHeight*.8),Fl(r)}catch{r=ki(window.innerWidth-450,90,400,window.innerHeight*.8),Fl(r)}else r=ki(window.innerWidth-450,90,400,window.innerHeight*.8),Fl(r)}else zs.visible},[zs.visible,ti,ki]),_e.useEffect(()=>{const o=()=>{if(nl){const r=ki(nl.x,nl.y,250,window.innerHeight*.4);(r.x!==nl.x||r.y!==nl.y)&&(il(r),localStorage.setItem("componentDialogPosition",JSON.stringify(r)))}if(ti){const r=ki(ti.x,ti.y,400,window.innerHeight*.8);(r.x!==ti.x||r.y!==ti.y)&&(Fl(r),localStorage.setItem("detailedInfoDialogPosition",JSON.stringify(r)))}};return window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[nl,ti,ki]);const Ju=b.useCallback(o=>{switch(o){case"transparency":V(50);break;case"brushSize":z(3);break}},[]),xd=_e.useRef(Ce);_e.useEffect(()=>{xd.current=Ce},[Ce]),_e.useEffect(()=>{if(ue){lc.current=performance.now(),V(0);const o=r=>{const f=lc.current||r,m=xd.current,y=(r-f)%m/m,v=1-Math.abs(1-2*y);V(Math.round(v*100)),Ds.current=requestAnimationFrame(o)};Ds.current=requestAnimationFrame(o)}return()=>{Ds.current&&(cancelAnimationFrame(Ds.current),Ds.current=null)}},[ue]),_e.useEffect(()=>{if(B==="center"){Xn(dx());return}const o=B==="erase"?"erase":B==="magnify"?"magnify":B==="ground"?"ground":B==="power"?"power":B==="component"?"component":B==="draw"?Ne==="via"?"via":Ne==="pad"?"pad":Ne==="testPoint"?"testPoint":"trace":"default";if(o==="default"){Xn(void 0);return}const r=Fe,f=o==="magnify"?18:Math.max(o==="component"?16:o==="power"||o==="ground"?12:6,Math.round(M*r)),y=f+4*2+(o==="magnify"?8:0),v=document.createElement("canvas");v.width=y,v.height=y;const x=v.getContext("2d");if(!x){Xn(void 0);return}const T=y/2,C=y/2,k=f/2;if(x.clearRect(0,0,y,y),o==="via"){const U=k,le=k*.5,K=k*.7,oe=At.get("via").color;x.fillStyle=oe,x.beginPath(),x.arc(T,C,U,0,Math.PI*2),x.arc(T,C,le,0,Math.PI*2),x.fill("evenodd"),x.strokeStyle="#808080",x.lineWidth=1,x.beginPath(),x.moveTo(T-K,C),x.lineTo(T+K,C),x.stroke(),x.beginPath(),x.moveTo(T,C-K),x.lineTo(T,C+K),x.stroke()}else if(o==="pad"){const U=Lt==="top"?"padTop":"padBottom",le=At.get(U),K=le.color,oe=Math.max(6,Math.round(le.size*r))/2,ae=oe*2,ee=ae*.5,ve=oe*.7;x.fillStyle=K,x.beginPath(),x.rect(T-oe,C-oe,ae,ae),x.rect(T-ee/2,C-ee/2,ee,ee),x.fill("evenodd"),x.strokeStyle="#808080",x.lineWidth=1,x.beginPath(),x.moveTo(T-ve,C),x.lineTo(T+ve,C),x.stroke(),x.beginPath(),x.moveTo(T,C-ve),x.lineTo(T,C+ve),x.stroke()}else if(o==="trace"){const U=ft==="top"?"traceTop":"traceBottom",K=At.get(U).color;x.fillStyle=K,x.beginPath(),x.arc(T,C,k,0,Math.PI*2),x.fill()}else if(o==="testPoint"){const U=ln==="top"?"testPointTop":"testPointBottom",K=At.get(U).size*r;Xn(ux(K));return}else if(o==="erase"){const U=M*r,le=Math.max(U*.75,8),K=Math.max(U*.5,6),X=Math.max(U*.2,2);x.save(),x.translate(T,C),x.rotate(-35*Math.PI/180),x.fillStyle="#f5a3b3",x.strokeStyle="#111",x.lineWidth=1.5;const oe=1.5,ae=-le/2,ee=-K/2;x.beginPath(),x.moveTo(ae+oe,ee),x.lineTo(ae+le-oe,ee),x.quadraticCurveTo(ae+le,ee,ae+le,ee+oe),x.lineTo(ae+le,ee+K-oe),x.quadraticCurveTo(ae+le,ee+K,ae+le-oe,ee+K),x.lineTo(ae+oe,ee+K),x.quadraticCurveTo(ae,ee+K,ae,ee+K-oe),x.lineTo(ae,ee+oe),x.quadraticCurveTo(ae,ee,ae+oe,ee),x.closePath(),x.fill(),x.stroke(),x.fillStyle="#f18ea4",x.beginPath(),x.rect(-le/2,K/2-X,le,X),x.fill(),x.restore()}else if(o==="magnify"){const U=k;x.strokeStyle="#111",x.lineWidth=2,x.beginPath(),x.arc(T-2,C-2,U,0,Math.PI*2),x.stroke();const le=T+U*.6,K=C+U*.6,X=le+6,oe=K+6;x.beginPath(),x.moveTo(le,K),x.lineTo(X,oe),x.stroke(),x.beginPath(),x.moveTo(T-6,C-2),x.lineTo(T+2,C-2),x.stroke(),As||(x.beginPath(),x.moveTo(T-2,C-6),x.lineTo(T-2,C+2),x.stroke())}else if(o==="ground"){const le=(ei?Gt.find(X=>X.id===ei):null)?.color||"#000000";if(x.strokeStyle=le,x.lineWidth=2,x.lineCap="round",ei==="groundbus-earth"){const X=k*1.5,oe=X*.9,ae=X*.24,ee=X*1.6;x.beginPath(),x.moveTo(T,C-oe/2),x.lineTo(T,C+oe/2),x.stroke();for(let ve=0;ve<3;ve++){const Ae=C+oe/2+ve*ae,Re=ee*(1-ve*.25);x.beginPath(),x.moveTo(T-Re/2,Ae),x.lineTo(T+Re/2,Ae),x.stroke()}}else{const X=k*.8;x.beginPath(),x.arc(T,C,k,0,Math.PI*2),x.stroke(),x.beginPath(),x.moveTo(T,C-k-X),x.lineTo(T,C+k+X),x.stroke(),x.beginPath(),x.moveTo(T-k-X,C),x.lineTo(T+k+X,C),x.stroke()}}else if(o==="power"){const le=(Il?Ke.find(X=>X.id===Il):null)?.color||"#ff0000";x.strokeStyle=le,x.lineWidth=2,x.lineCap="round";const K=k*.8;x.beginPath(),x.arc(T,C,k,0,Math.PI*2),x.stroke(),x.beginPath(),x.moveTo(T,C-k-K),x.lineTo(T,C+k+K),x.stroke(),x.beginPath(),x.moveTo(T-k-K,C),x.lineTo(T+k+K,C),x.stroke()}else if(o==="component"){const le=(vn||"top")==="top"?"componentTop":"componentBottom",X=At.get(le).color,oe=f,ae=oe/2;x.strokeStyle=X,x.lineWidth=2,x.fillStyle="rgba(255,255,255,0.9)",x.beginPath(),x.rect(T-ae,C-ae,oe,oe),x.fill(),x.stroke();const ee=Fn?Kf(Fn):"?";x.fillStyle=X,x.font=`bold ${Math.max(8,oe*.35)}px sans-serif`,x.textAlign="center",x.textBaseline="middle",x.fillText(ee,T,C)}const N=`url(${v.toDataURL()}) ${Math.round(T)} ${Math.round(C)}, crosshair`;Xn(N)},[B,Ne,J,M,Fe,As,Fn,Il,ei,Ke,Gt,Ht,ft,Lt,ln,vn,Ot.toolInstanceId,Ot.color,Ot.size]),_e.useEffect(()=>{Pr()},[Pr]),_e.useEffect(()=>{Pr()},[Do.width,Do.height]),_e.useEffect(()=>{mt.size===0&&B==="draw"&&Ne==="trace"&&M>=1&&(lt==="top"?j(M):be(M))},[M,B,Ne,lt,mt]),_e.useEffect(()=>{Pt(o=>o.map(r=>{if(r.type==="via"&&r.points.length>0&&r.points[0].id!==void 0){const f=r.points[0].id,m=Cl(f,Ke);if(r.viaType!==m)return{...r,viaType:m}}else if(r.type==="pad"&&r.points.length>0&&r.points[0].id!==void 0){const f=r.points[0].id,m=An(f,Ke);if(r.padType!==m)return{...r,padType:m}}else if(r.type==="testPoint"&&r.points.length>0&&r.points[0].id!==void 0){const f=r.points[0].id,m=Vn(f,Ke),y=m.includes("Power")?"power":m.includes("Ground")?"ground":m.includes("Signal")?"signal":"unknown";if(r.testPointType!==y)return{...r,testPointType:y}}return r}))},[yt,dt,Ke,Cl,An,Vn]);const Er=b.useCallback(()=>{const o=Sn.current;if(!o)return;const r=o.toDataURL("image/png"),f=window.open("","_blank");if(!f){alert("Please allow popups to print the canvas.");return}f.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>PCB Drawing</title>
          <style>
            @media print {
              @page {
                margin: 0;
                size: auto;
              }
              body {
                margin: 0;
                padding: 0;
              }
            }
            body {
              margin: 0;
              padding: 20px;
              display: flex;
              justify-content: center;
              align-items: center;
              background: white;
            }
            img {
              max-width: 100%;
              height: auto;
              display: block;
            }
          </style>
        </head>
        <body>
          <img src="${r}" alt="PCB Drawing" onload="window.setTimeout(function() { window.print(); }, 250);" />
        </body>
      </html>
    `),f.document.close()},[]);_e.useEffect(()=>{const o=f=>{f.key==="Shift"&&Ua(!0)},r=f=>{f.key==="Shift"&&Ua(!1)};return window.addEventListener("keydown",o),window.addEventListener("keyup",r),()=>{window.removeEventListener("keydown",o),window.removeEventListener("keyup",r)}},[]);const Tc=b.useCallback(o=>{if(o.size===0)return;const r=Array.from(o).map(f=>String(f));Pt(f=>f.map(m=>{if(m.type==="trace"){const y=m.points.filter(v=>v.id===void 0?!0:!o.has(v.id));return y.length<2?null:{...m,points:y}}return m}).filter(m=>m!==null)),Qt(f=>f.map(m=>{const y=m.pinConnections||[];if(y.some(x=>x&&r.includes(x))){const x=y.map(T=>T&&r.includes(T)?"":T);return{...m,pinConnections:x}}return m})),rn(f=>f.map(m=>{const y=m.pinConnections||[];if(y.some(x=>x&&r.includes(x))){const x=y.map(T=>T&&r.includes(T)?"":T);return{...m,pinConnections:x}}return m}))},[Pt,Qt,rn]),_r=b.useRef(new Set);_e.useEffect(()=>{const o=new Set;for(const f of He)if((f.type==="via"||f.type==="pad")&&f.points.length>0){const m=f.points[0].id;m!==void 0&&o.add(m)}const r=new Set;for(const f of _r.current)o.has(f)||r.add(f);r.size>0&&Tc(r),_r.current=o},[He,Tc]),_e.useEffect(()=>{Pt(o=>o.map(r=>{if(r.type==="via"&&r.points.length>0&&r.points[0].id!==void 0){const f=r.points[0].id,m=Cl(f,Ke);if(r.viaType!==m)return{...r,viaType:m}}else if(r.type==="pad"&&r.points.length>0&&r.points[0].id!==void 0){const f=r.points[0].id,m=An(f,Ke);if(r.padType!==m)return{...r,padType:m}}else if(r.type==="testPoint"&&r.points.length>0&&r.points[0].id!==void 0){const f=r.points[0].id,m=Vn(f,Ke),y=m.includes("Power")?"power":m.includes("Ground")?"ground":m.includes("Signal")?"signal":"unknown";if(r.testPointType!==y)return{...r,testPointType:y}}return r}))},[yt,dt,Ke,Cl,An,Vn]),_e.useEffect(()=>{const o=r=>{Ki.current&&(Ki.current.contains(r.target)||hr(null))};return document.addEventListener("click",o),()=>document.removeEventListener("click",o)},[]),_e.useEffect(()=>{const o=(r,f)=>{const m=r.current;if(!m)return;const y=m.getContext("2d");if(!y)return;const v=m.width,x=m.height;if(y.clearRect(0,0,v,x),y.fillStyle="#fff",y.fillRect(0,0,v,x),f?.bitmap){const T=f.bitmap,C=Math.min(v/T.width,x/T.height),k=Math.max(1,Math.floor(T.width*C)),N=Math.max(1,Math.floor(T.height*C)),U=Math.floor((v-k)/2),le=Math.floor((x-N)/2);y.drawImage(T,U,le,k,N)}y.strokeStyle="#ddd",y.lineWidth=1,y.strokeRect(.5,.5,v-1,x-1)};o(_a,g),o(Ha,R)},[g,R]),_e.useEffect(()=>{const o=[],r=[],f=[],m=[];for(const y of He)if(y.type==="via"&&y.points.length>=1){const v=y.points[0],x={id:y.id,pointId:v.id,x:v.x,y:v.y,size:y.size,color:y.color};o.push(x)}else if(y.type==="pad"&&y.points.length>=1){const v=y.points[0],x={id:y.id,pointId:v.id,x:v.x,y:v.y,size:y.size,color:y.color,layer:y.layer||"top"};r.push(x)}else if(y.type==="trace"&&y.points.length>=2)for(let v=0;v<y.points.length-1;v++){const x=y.points[v],T=y.points[v+1],C={id:y.id,startPointId:x.id,endPointId:T.id,x1:x.x,y1:x.y,x2:T.x,y2:T.y,size:y.size,color:y.color};y.layer==="top"?f.push(C):m.push(C)}xn(o),Si(r),ms(f),Yi(m)},[He]);const Hr=b.useRef(He);Hr.current=He;const fo=b.useCallback(()=>{const r=new Date().toISOString(),f=fx();return{project:{version:1,fileType:"PCB_REVERSE_ENGINEERING_AUTOSAVE",savedAt:r,view:{currentView:xe,viewScale:Fe,viewPan:kt,showBothLayers:ar,selectedDrawingLayer:lt},images:{top:g?{name:g.name,width:g.width,height:g.height,filePath:g.filePath||g.name,x:g.x,y:g.y,scale:g.scale,rotation:g.rotation,flipX:g.flipX,flipY:g.flipY,skewX:g.skewX,skewY:g.skewY,keystoneV:g.keystoneV,keystoneH:g.keystoneH,brightness:g.brightness??100,contrast:g.contrast??100}:null,bottom:R?{name:R.name,width:R.width,height:R.height,filePath:R.filePath||R.name,x:R.x,y:R.y,scale:R.scale,rotation:R.rotation,flipX:R.flipX,flipY:R.flipY,skewX:R.skewX,skewY:R.skewY,keystoneV:R.keystoneV,keystoneH:R.keystoneH,brightness:R.brightness??100,contrast:R.contrast??100}:null},projectDirectoryName:ba.current?ba.current.name||null:cn&&cn.name||null,drawing:{drawingStrokes:Hr.current.filter(y=>!(y.type==="trace"&&y.points.length<2)),vias:bs,tracesTop:Ta,tracesBottom:Ca,componentsTop:et,componentsBottom:rt,grounds:dt,powers:yt},powerBuses:Ke,groundBuses:Gt,pointIdCounter:Rh(),designatorCounters:Fd(),autoAssignDesignators:Ns,useGlobalDesignatorCounters:Ms,traceColors:{top:Ht.get("trace")?.layerSettings.get("top")?.color||D,bottom:Ht.get("trace")?.layerSettings.get("bottom")?.color||E},traceSizes:{top:Ht.get("trace")?.layerSettings.get("top")?.size||W,bottom:Ht.get("trace")?.layerSettings.get("bottom")?.size||me},padColors:{top:Ht.get("pad")?.layerSettings.get("top")?.color||re,bottom:Ht.get("pad")?.layerSettings.get("bottom")?.color||O},padSizes:{top:Ht.get("pad")?.layerSettings.get("top")?.size||je,bottom:Ht.get("pad")?.layerSettings.get("bottom")?.size||S},componentColors:{top:Ht.get("component")?.layerSettings.get("top")?.color||Mn,bottom:Ht.get("component")?.layerSettings.get("bottom")?.color||Di},componentSizes:{top:Ht.get("component")?.layerSettings.get("top")?.size||Ai,bottom:Ht.get("component")?.layerSettings.get("bottom")?.size||el},traceToolLayer:ft,toolSettings:{trace:Ht.get("trace")?.settings||{color:"#ff0000",size:6},via:Ht.get("via")?.settings||{color:"#ff0000",size:18},pad:Ht.get("pad")?.settings||{color:"#ff0000",size:18},component:Ht.get("component")?.settings||{color:"#ff0000",size:18},ground:Ht.get("ground")?.settings||{color:"#000000",size:18},power:Ht.get("power")?.settings||{color:"#ff0000",size:18},erase:Ht.get("erase")?.settings||{color:"#f5a3b3",size:18}},locks:{areImagesLocked:Ui,areViasLocked:ji,arePadsLocked:Xi,areTracesLocked:Ti,areComponentsLocked:Gi,areGroundNodesLocked:qi,arePowerNodesLocked:wn},visibility:{showViasLayer:hn,showTopPadsLayer:Qi,showBottomPadsLayer:Ut,showTopTracesLayer:Dn,showBottomTracesLayer:Ci,showTopComponents:al,showBottomComponents:hi,showPowerLayer:ml,showGroundLayer:zi,showConnectionsLayer:Vl,showTraceCornerDots:Bs},autoSave:{enabled:Oi,interval:hl,baseName:zo},projectInfo:{name:Zn},projectNotes:$a,homeViews:aa,toolInstances:At.getAll()},timestamp:f}},[xe,Fe,kt,ar,lt,g,R,He,bs,Ta,Ca,et,rt,dt,Ht,Ui,ji,Xi,Ti,Gi,qi,wn,Ke,Gt,Rh,D,E,W,me,re,O,je,S,Mn,Di,Ai,el,ft,Oi,hl,zo,Zn,hn,Qi,Ut,Dn,Ci,al,hi,ml,zi,Vl,Ns,Ms,$a,aa]),Ws=b.useRef(fo);Ws.current=fo;const Vo=b.useRef(To);Vo.current=To;const zl=b.useRef(zo);zl.current=zo;const yd=b.useRef(Un);yd.current=Un;const Cc=b.useRef(ec);Cc.current=ec;const Ri=b.useRef([]);Ri.current=Ba;const os=b.useRef(-1);os.current=tc;const ba=b.useRef(null),po=b.useRef(!1);_e.useEffect(()=>{po.current||(ba.current=cn)},[cn]);const zc=b.useCallback(async()=>{console.log("Auto save: performAutoSave called");let o=ba.current,r=zl.current;if(console.log(`Auto save: projectDirHandle=${o?`set (${o.name})`:"missing"}, baseName=${r||"missing"}`),!o||!r){console.warn(`Auto save: Missing project directory handle (${!o}) or base name (${!r}). Please create a new project or open an existing project first.`),yn(!1),Vt.current&&(clearInterval(Vt.current),Vt.current=null);return}if(!Ei.current){console.log("Auto save: Skipping - no changes since last save");return}const f=Hr.current,m=f.filter(N=>N.type==="trace"&&N.points.length<2);if(m.length>0){console.log(`Auto save: Cleaning up ${m.length} single-point trace(s) before save`),m.forEach(U=>console.log(`  - Removing single-point trace ${U.id}`));const N=f.filter(U=>!(U.type==="trace"&&U.points.length<2));Pt(N),Hr.current=N}console.log("Auto save: Starting save...");const{project:y,timestamp:v}=Ws.current(),T=`${Wc(r)}_${v}.json`,C=JSON.stringify(y,null,2),k=new Blob([C],{type:"application/json"});try{let N;try{N=await o.getDirectoryHandle("history",{create:!0})}catch(oe){console.error("Failed to get/create history directory:",oe);return}try{const oe=[],ae=Cc.current;for await(const ee of o.keys())try{if(ee==="history"||ee===T)continue;const Ae=await(await o.getFileHandle(ee)).getFile();if(!ee.endsWith(".json"))continue;const Re=await Ae.text();try{const ze=JSON.parse(Re);if(ze.version&&(ze.fileType==="PCB_REVERSE_ENGINEERING_AUTOSAVE"||!ze.fileType)){oe.push(ee);const Ve=ze.fileType?"auto-saved":"manually saved/opened";console.log(`Auto save: Found PCB project file in root: ${ee} (${Ve}${ee===ae?" - this is the opened file":""})`)}}catch{continue}}catch{continue}for(const ee of oe)try{const Re=await(await(await o.getFileHandle(ee)).getFile()).text(),Ve=await(await N.getFileHandle(ee,{create:!0})).createWritable();await Ve.write(new Blob([Re],{type:"application/json"})),await Ve.close(),await o.removeEntry(ee),console.log(`Auto save: Moved ${ee} from root to history/`)}catch(ve){console.warn(`Auto save: Failed to move ${ee} to history:`,ve)}}catch(oe){console.warn("Auto save: Error checking for old files in root:",oe)}const le=await(await o.getFileHandle(T,{create:!0})).createWritable();await le.write(k),await le.close(),console.log(`Auto save: Successfully saved ${T} to root directory`),yd.current(T);const K=Ri.current,X=[T,...K.filter(oe=>oe!==T)].sort((oe,ae)=>ae.localeCompare(oe));xl(X),Ri.current=X,gr(0),os.current=0,Ei.current=!1,lo(!1)}catch(N){console.error("Auto save failed:",N)}},[]);Qc.current=zc;const Fs=b.useCallback(async()=>{const{project:o}=fo(),r=JSON.stringify(o,null,2),f=new Blob([r],{type:"application/json"});if(cn&&Zn)try{let k=null;try{k=await cn.getDirectoryHandle("history",{create:!0})}catch(ae){console.error("Failed to get/create history directory:",ae),k=null}const N=Zn.replace(/\.json$/i,""),U=Wc(N),{timestamp:le}=fo(),K=`${U}_${le}.json`;if(k)try{const ae=[];for await(const ee of cn.keys())try{if(ee==="history"||ee===K)continue;const Ae=await(await cn.getFileHandle(ee)).getFile();if(!ee.endsWith(".json"))continue;const Re=await Ae.text();try{JSON.parse(Re).version&&(ae.push(ee),console.log(`Save: Found PCB project file in root: ${ee}`))}catch{continue}}catch{continue}for(const ee of ae)try{const Re=await(await(await cn.getFileHandle(ee)).getFile()).text(),Ve=await(await k.getFileHandle(ee,{create:!0})).createWritable();await Ve.write(new Blob([Re],{type:"application/json"})),await Ve.close(),await cn.removeEntry(ee),console.log(`Save: Moved ${ee} from root to history/`)}catch(ve){console.warn(`Save: Failed to move ${ee} to history:`,ve)}}catch(ae){console.warn("Save: Error checking for old files in root:",ae)}const oe=await(await cn.getFileHandle(K,{create:!0})).createWritable();await oe.write(f),await oe.close(),Un(K),lo(!1),Ei.current=!1,console.log(`Project saved: ${Zn}/${K}`);return}catch(k){console.error("Failed to save to project directory:",k),Zi(null)}if(Zn&&!cn){const k=window;if(typeof k.showDirectoryPicker=="function")try{const N=await k.showDirectoryPicker();Zi(N);const U=`${Zn}.json`,K=await(await N.getFileHandle(U,{create:!0})).createWritable();await K.write(f),await K.close(),Un(U),lo(!1),Ei.current=!1,console.log(`Project saved: ${U} in selected directory`);return}catch(N){N?.name!=="AbortError"&&console.error("Failed to get directory:",N)}}const m=k=>String(k).padStart(2,"0"),y=new Date,x=`pcb_project_${`${y.getFullYear()}_${m(y.getMonth()+1)}_${m(y.getDate())}_${m(y.getHours())}_${m(y.getMinutes())}_${m(y.getSeconds())}`}.json`,T=window;if(typeof T.showSaveFilePicker=="function")try{const k=await T.showSaveFilePicker({suggestedName:x,types:[{description:"PCB Project",accept:{"application/json":[".json"]}}]}),N=await k.createWritable();await N.write(f),await N.close();const U=k.name;try{const X=await k.getFile();Un(X.name)}catch{Un(U)}const K=U.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_");K&&gl(K);try{const X=k.name.replace(/\.json$/i,""),ae=Wc(X).replace(/[^a-zA-Z0-9_-]/g,"_");ll(ae),To||console.log("Auto save: Directory handle not set. Will prompt on first auto save.")}catch(X){console.warn("Could not set up auto save for new file:",X)}return}catch(k){if(k?.name==="AbortError")return;console.warn("showSaveFilePicker failed, falling back to download",k)}const C=document.createElement("a");C.href=URL.createObjectURL(f),C.download=x,document.body.appendChild(C),C.click(),setTimeout(()=>{URL.revokeObjectURL(C.href),document.body.removeChild(C)},0)},[fo]);_e.useEffect(()=>{Vt.current&&(clearInterval(Vt.current),Vt.current=null);const o=nc.current;if(nc.current=Oi,Oi&&hl){const r=hl*60*1e3;To&&zo?(console.log(`Auto save: Setting up interval for ${hl} minute(s) (${r}ms)`),o||(Ei.current=!0,setTimeout(()=>{zc()},100)),Vt.current&&(clearInterval(Vt.current),Vt.current=null),Vt.current=window.setInterval(()=>{console.log("Auto save: Interval triggered, calling performAutoSave..."),console.log(`  - hasChangesSinceLastAutoSave: ${Ei.current}`),console.log(`  - dirHandle: ${Vo.current?"set":"missing"}`),console.log(`  - baseName: ${zl.current||"missing"}`),zc()},r),console.log(`Auto save: Interval set up for ${r}ms (${hl} minutes)`),console.log(`  - Directory handle: ${To?"set":"missing"}`),console.log(`  - Base name: ${zo||"missing"}`)):(console.warn(`Auto save: Cannot set up interval - missing directory handle (${!To}) or base name (${!zo}). Disabling auto save.`),yn(!1),Vt.current&&(clearInterval(Vt.current),Vt.current=null))}else Oi||(nc.current=!1);return()=>{Vt.current&&(clearInterval(Vt.current),Vt.current=null)}},[Oi,hl,To,zo]);const Ir=b.useRef(!1),as=b.useRef(!1);_e.useEffect(()=>{if(as.current){console.log("Change tracking: Skipping - project is being loaded");return}if(Oi&&Ir.current){Ir.current=!1,console.log("Auto save: Skipping change tracking on first run after enable (initial save handled separately)");return}Ei.current=!0,lo(!0),console.log("Change detected, marking as unsaved",{autoSaveEnabled:Oi,topImage:!!g,bottomImage:!!R,drawingStrokesCount:He.length,componentsTopCount:et.length,componentsBottomCount:rt.length,powersCount:yt.length,groundsCount:dt.length,powerBusesCount:Ke.length,projectNotesCount:$a.length,areImagesLocked:Ui,areViasLocked:ji,areTracesLocked:Ti,areComponentsLocked:Gi,areGroundNodesLocked:qi,arePowerNodesLocked:wn})},[g,R,He,et,rt,yt,dt,Ke,$a,D,E,W,me,Ui,ji,Ti,Gi,qi,wn,Oi]),_e.useEffect(()=>{Oi?(Ir.current=!0,console.log("Auto save: Enabled, marking first run")):Ir.current=!1},[Oi]),_e.useEffect(()=>{Oi||(Ei.current=!1)},[Oi]);const kc=b.useCallback(()=>!!(g||R||He.length>0||et.length>0||rt.length>0||yt.length>0||dt.length>0),[g,R,He,et,rt,yt,dt]),ss=b.useCallback(()=>{Na({visible:!0,projectName:"",locationPath:"",locationHandle:null})},[]),fu=b.useCallback(async()=>{const o=window;if(typeof o.showDirectoryPicker=="function")try{const r=await o.showDirectoryPicker({mode:"readwrite"});Na(f=>({...f,locationHandle:r,locationPath:r.name||"Selected folder"}))}catch(r){r?.name!=="AbortError"&&(console.error("Failed to get directory:",r),alert("Failed to select location directory."))}else alert("Directory picker is not supported in this browser. Please use a modern browser like Chrome or Edge.")},[]),bd=b.useCallback(async()=>{const o=tn.projectName.trim();if(!o){alert("Please enter a project name.");return}const r=o.replace(/[^a-zA-Z0-9_-]/g,"_")||"pcb_project";if(!tn.locationHandle){alert("Please select a location for the project.");return}const f=tn.locationHandle;let m,y;if(f.name===r)m=f,y=f;else{y=f;try{m=await y.getDirectoryHandle(r,{create:!0})}catch(v){console.error("Failed to create project folder:",v),alert(`Failed to create project folder "${r}". See console for details.`);return}}Sc(),Na({visible:!1,projectName:"",locationPath:"",locationHandle:null}),gl(r),Zi(m),ya();try{const{project:v,timestamp:x}=fo(),C=`${Wc(r)}_${x}.json`,k=JSON.stringify(v,null,2),N=new Blob([k],{type:"application/json"}),le=await(await m.getFileHandle(C,{create:!0})).createWritable();await le.write(N),await le.close(),Un(C),console.log(`New project created: ${r}/${C}`),Pi({visible:!0,source:"new",interval:5})}catch(v){console.error("Failed to save new project:",v),alert("Failed to save new project file. See console for details.")}},[ya,fo,tn,Sc]),md=b.useCallback(()=>{Na({visible:!1,projectName:"",locationPath:"",locationHandle:null})},[]),vd=b.useCallback(()=>{const o=Zn?`${Zn}.json`:"";la({visible:!0,filename:o,locationPath:"",locationHandle:null}),setTimeout(()=>{if(yr.current?.focus(),yr.current&&o){const r=o.replace(/\.json$/i,"");yr.current.setSelectionRange(0,r.length)}},100)},[Zn]),Ln=b.useCallback(async()=>{const o=window;if(typeof o.showDirectoryPicker=="function")try{const r=await o.showDirectoryPicker();la(f=>({...f,locationHandle:r,locationPath:r.name||"Selected folder"}))}catch(r){r?.name!=="AbortError"&&(console.error("Failed to get directory:",r),alert("Failed to select location directory."))}else alert("Directory picker is not supported in this browser. Please use a modern browser that supports the File System Access API.")},[]),ii=b.useCallback(async()=>{const o=pn.filename.trim();if(!o){alert("Please enter a file name.");return}const f=(o.endsWith(".json")?o:`${o}.json`).replace(/[^a-zA-Z0-9_.-]/g,"_");if(!pn.locationHandle){alert("Please select a location for the file.");return}const m=pn.locationHandle;try{const{project:y}=fo(),v=JSON.stringify(y,null,2),x=new Blob([v],{type:"application/json"}),C=await(await m.getFileHandle(f,{create:!0})).createWritable();await C.write(x),await C.close(),Un(f);const k=f.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_");k&&gl(k),Zi(m),lo(!1),Ei.current=!1,la({visible:!1,filename:"",locationPath:"",locationHandle:null}),hr(null),console.log(`Project saved as: ${f} in selected directory`)}catch(y){console.error("Failed to save project:",y),alert(`Failed to save project file "${f}". See console for details.`)}},[pn,fo]),Rc=b.useCallback(()=>{la({visible:!1,filename:"",locationPath:"",locationHandle:null})},[]),Dc=b.useCallback(async()=>{na({visible:!1}),await Fs(),ss(),Xl()},[Fs,ss,Xl]),pu=b.useCallback(()=>{na({visible:!1}),ss(),Xl()},[ss,Xl]),hu=b.useCallback(()=>{na({visible:!1})},[]);_e.useEffect(()=>{if(Qr.visible){setTimeout(()=>{oc.current?.focus()},0);const o=r=>{r.key==="Enter"?(r.preventDefault(),Dc()):r.key==="Escape"&&(r.preventDefault(),na({visible:!1}))};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}}},[Qr.visible,Dc]);const Gl=b.useCallback(async(o,r)=>{as.current=!0;try{if(Qo(),o.toolInstances?At.initializeFromProject(o):At.initialize(),o.projectInfo&&o.projectInfo.name&&gl(o.projectInfo.name),o.view&&(o.view.currentView&&q(o.view.currentView),o.view.viewScale!=null&&mi(o.view.viewScale),o.view.viewPan&&Hn(o.view.viewPan),o.view.showBothLayers!=null&&ul(o.view.showBothLayers),o.view.selectedDrawingLayer&&Cn(o.view.selectedDrawingLayer)),o.homeViews){const T={};for(const[C,k]of Object.entries(o.homeViews)){const N=parseInt(C,10),U=k;U.showTopImage===void 0?T[N]={x:U.x,y:U.y,zoom:U.zoom,showTopImage:oo,showBottomImage:ci,showViasLayer:hn,showTopTracesLayer:Dn,showBottomTracesLayer:Ci,showTopPadsLayer:Qi,showBottomPadsLayer:Ut,showTopTestPointsLayer:fi,showBottomTestPointsLayer:bl,showTopComponents:al,showBottomComponents:hi,showPowerLayer:ml,showGroundLayer:zi,showConnectionsLayer:Vl}:T[N]=U}Pa(T)}else Pa({});if(o.projectNotes&&Array.isArray(o.projectNotes)?Tl(o.projectNotes):Tl([]),o.traceColors&&(o.traceColors.top&&(P(o.traceColors.top),ut("trace",o.traceColors.top,"top")),o.traceColors.bottom&&(pe(o.traceColors.bottom),ut("trace",o.traceColors.bottom,"bottom"))),o.traceSizes){const T=o.traceSizes.top!=null&&o.traceSizes.top>0?o.traceSizes.top:6;let C=o.traceSizes.bottom!=null&&o.traceSizes.bottom>0?o.traceSizes.bottom:6;C<6&&(C=6),j(T),be(C),Je("trace",T,"top"),Je("trace",C,"bottom")}else j(6),be(6);if(o.padColors&&(o.padColors.top&&(_(o.padColors.top),ut("pad",o.padColors.top,"top")),o.padColors.bottom&&(Y(o.padColors.bottom),ut("pad",o.padColors.bottom,"bottom"))),o.padSizes){const T=o.padSizes.top!=null&&o.padSizes.top>0?o.padSizes.top:18,C=o.padSizes.bottom!=null&&o.padSizes.bottom>0?o.padSizes.bottom:18;L(T),A(C),Je("pad",T,"top"),Je("pad",C,"bottom")}if(o.componentColors&&(o.componentColors.top&&(Vi(o.componentColors.top),ut("component",o.componentColors.top,"top")),o.componentColors.bottom&&(yi(o.componentColors.bottom),ut("component",o.componentColors.bottom,"bottom"))),o.componentSizes){const T=o.componentSizes.top!=null&&o.componentSizes.top>0?o.componentSizes.top:18,C=o.componentSizes.bottom!=null&&o.componentSizes.bottom>0?o.componentSizes.bottom:18;Nl(T),Ql(C),Je("component",T,"top"),Je("component",C,"bottom")}if(o.traceToolLayer&&(Bn(o.traceToolLayer),B==="draw"&&Ne==="trace")){const T=o.traceToolLayer;ne(T==="top"?o.traceColors?.top||D:o.traceColors?.bottom||E);const C=o.traceSizes?.top!=null&&o.traceSizes.top>0?o.traceSizes.top:6;let k=o.traceSizes?.bottom!=null&&o.traceSizes.bottom>0?o.traceSizes.bottom:6;k<6&&(k=6),z(T==="top"?C:k)}o.toolSettings&&on(T=>{const C=new Map(T);if(o.toolSettings.trace){const N=C.get("trace");if(N){const U={...N,settings:o.toolSettings.trace},le=new Map(N.layerSettings);o.traceSizes&&o.traceColors&&(le.set("top",{color:o.traceColors.top||N.layerSettings.get("top")?.color||"#AA4499",size:o.traceSizes.top||N.layerSettings.get("top")?.size||6}),le.set("bottom",{color:o.traceColors.bottom||N.layerSettings.get("bottom")?.color||"#F781BF",size:o.traceSizes.bottom||N.layerSettings.get("bottom")?.size||6})),C.set("trace",{...U,layerSettings:le})}}if(o.toolSettings.via){const N=C.get("via");N&&C.set("via",{...N,settings:o.toolSettings.via})}if(o.toolSettings.pad){const N=C.get("pad");if(N){const U={...N,settings:o.toolSettings.pad},le=new Map(N.layerSettings);o.padSizes&&o.padColors&&(le.set("top",{color:o.padColors.top||N.layerSettings.get("top")?.color||"#0072B2",size:o.padSizes.top||N.layerSettings.get("top")?.size||18}),le.set("bottom",{color:o.padColors.bottom||N.layerSettings.get("bottom")?.color||"#56B4E9",size:o.padSizes.bottom||N.layerSettings.get("bottom")?.size||18})),C.set("pad",{...U,layerSettings:le})}}if(o.toolSettings.component){const N=C.get("component");if(N){const U={...N,settings:o.toolSettings.component},le=new Map(N.layerSettings);o.componentSizes&&o.componentColors&&(le.set("top",{color:o.componentColors.top||N.layerSettings.get("top")?.color||"#6A3D9A",size:o.componentSizes.top||N.layerSettings.get("top")?.size||18}),le.set("bottom",{color:o.componentColors.bottom||N.layerSettings.get("bottom")?.color||"#9467BD",size:o.componentSizes.bottom||N.layerSettings.get("bottom")?.size||18})),C.set("component",{...U,layerSettings:le})}}if(o.toolSettings.ground){const N=C.get("ground");N&&C.set("ground",{...N,settings:o.toolSettings.ground})}if(o.toolSettings.power){const N=C.get("power");N&&C.set("power",{...N,settings:o.toolSettings.power})}if(o.toolSettings.erase){const N=C.get("erase");N&&C.set("erase",{...N,settings:o.toolSettings.erase})}const k=B==="draw"&&Ne==="trace"?C.get("trace"):B==="draw"&&Ne==="via"?C.get("via"):B==="draw"&&Ne==="pad"?C.get("pad"):B==="component"?C.get("component"):B==="power"?C.get("power"):B==="ground"?C.get("ground"):null;if(k)if(B==="draw"&&Ne==="trace"){const N=ft||"top",U=k.layerSettings.get(N);U?(ne(U.color),z(U.size),N==="top"?(P(U.color),j(U.size)):(pe(U.color),be(U.size))):(ne(k.settings.color),z(k.settings.size))}else if(B==="draw"&&Ne==="pad"){const N=Lt||"top",U=k.layerSettings.get(N);U?(ne(U.color),z(U.size),N==="top"?(_(U.color),L(U.size)):(Y(U.color),A(U.size))):(ne(k.settings.color),z(k.settings.size))}else if(B==="component"){const N=vn||"top",U=k.layerSettings.get(N);U?(ne(U.color),z(U.size),N==="top"?(Vi(U.color),Nl(U.size)):(yi(U.color),Ql(U.size))):(ne(k.settings.color),z(k.settings.size))}else ne(k.settings.color),z(k.settings.size);return C});const f=async(T,C)=>{if(!T)return null;let k=null,N="",U=T.filePath||T.name;if(!C){const le=T.name||"image";return alert(`Error: Cannot load image "${le}" because no project directory is available.

Please ensure you opened the project file from its project directory. The project directory is required to access the image files stored in the images/ subdirectory.`),null}if(U)try{let le=U;!U.startsWith("images/")&&!U.startsWith("Images/")?le=U:U.startsWith("Images/")?le=U.replace("Images/",""):U.startsWith("images/")&&(le=U.replace("images/",""));let K;try{K=await C.getDirectoryHandle("images")}catch{try{K=await C.getDirectoryHandle("Images")}catch{throw new Error("Neither 'images' nor 'Images' directory found in project folder.")}}const oe=await(await K.getFileHandle(le)).getFile();k=await createImageBitmap(oe),N=URL.createObjectURL(oe),console.log(`Loaded image from file path: images/${le}`),U.startsWith("images/")||(U=`images/${U.replace("Images/","")}`)}catch(le){const K=le instanceof Error?le.message:"Unknown error",X=T.name||"image",oe=U.startsWith("images/")||U.startsWith("Images/")?U.replace("Images/","images/"):`images/${U}`;return alert(`Error: Failed to load image "${X}" from project directory.

Expected location: ${oe}

This may occur if:
- The image file was moved or deleted
- The project directory structure was modified
- File permissions are insufficient

Please ensure the image file exists in the images/ subdirectory of your project folder.

Technical details: ${K}`),null}else{const le=T.name||"image";return alert(`Error: Image "${le}" has no file path specified in the project file.

The project file is missing the image file path information. This may indicate the project file is corrupted or was created with an older version of the software.`),null}if(!k){const le=T.name||"image";return alert(`Error: Could not create image bitmap for "${le}".

The image file may be corrupted or in an unsupported format. Please ensure the image is a valid PNG, JPEG, or other supported image format.`),null}return{url:N,name:T.name??"image",width:T.width??k.width,height:T.height??k.height,filePath:U,x:T.x??0,y:T.y??0,scale:T.scale??1,rotation:T.rotation??0,flipX:!!T.flipX,flipY:!!T.flipY,skewX:T.skewX??0,skewY:T.skewY??0,keystoneV:T.keystoneV??0,keystoneH:T.keystoneH??0,brightness:T.brightness??100,contrast:T.contrast??100,bitmap:k}},m=r!==void 0?r:cn,y=await f(o.images?.top,m),v=await f(o.images?.bottom,m);if(d(y),I(v),o.pointIdCounter&&typeof o.pointIdCounter=="number"?qf(o.pointIdCounter):(console.warn("Project file missing pointIdCounter. Starting from 1."),qf(1)),o.locks&&(typeof o.locks.areImagesLocked=="boolean"&&Ss(o.locks.areImagesLocked),typeof o.locks.areViasLocked=="boolean"&&ws(o.locks.areViasLocked),typeof o.locks.arePadsLocked=="boolean"&&pr(o.locks.arePadsLocked),typeof o.locks.areTracesLocked=="boolean"&&Jo(o.locks.areTracesLocked),typeof o.locks.areComponentsLocked=="boolean"&&js(o.locks.areComponentsLocked),typeof o.locks.areGroundNodesLocked=="boolean"&&Da(o.locks.areGroundNodesLocked),typeof o.locks.arePowerNodesLocked=="boolean"&&Ts(o.locks.arePowerNodesLocked)),o.visibility&&(typeof o.visibility.showViasLayer=="boolean"&&ui(o.visibility.showViasLayer),typeof o.visibility.showTopPadsLayer=="boolean"&&bn(o.visibility.showTopPadsLayer),typeof o.visibility.showBottomPadsLayer=="boolean"&&Tt(o.visibility.showBottomPadsLayer),typeof o.visibility.showTopTracesLayer=="boolean"&&Ao(o.visibility.showTopTracesLayer),typeof o.visibility.showBottomTracesLayer=="boolean"&&ao(o.visibility.showBottomTracesLayer),typeof o.visibility.showTopComponents=="boolean"&&so(o.visibility.showTopComponents),typeof o.visibility.showBottomComponents=="boolean"&&_i(o.visibility.showBottomComponents),typeof o.visibility.showPowerLayer=="boolean"&&vl(o.visibility.showPowerLayer),typeof o.visibility.showGroundLayer=="boolean"&&co(o.visibility.showGroundLayer),typeof o.visibility.showConnectionsLayer=="boolean"&&Wl(o.visibility.showConnectionsLayer),typeof o.visibility.showTraceCornerDots=="boolean"&&sc(o.visibility.showTraceCornerDots)),o.autoSave?(typeof o.autoSave.enabled=="boolean"&&yn(o.autoSave.enabled),typeof o.autoSave.interval=="number"&&El(o.autoSave.interval),typeof o.autoSave.baseName=="string"&&o.autoSave.baseName?(ll(o.autoSave.baseName),zl.current=o.autoSave.baseName,o.autoSave.enabled&&!To&&(console.log("Auto save: Directory handle not available after page reload (expected). Auto save disabled. Use File -> Auto Save -> Enable to re-enable."),yn(!1),El(null))):o.autoSave.enabled&&(console.warn("Auto save was enabled in project file but base name is missing. Disabling auto save."),yn(!1),El(null),ll(""),zl.current="")):(yn(!1),El(null),Co(null),ll(""),Vo.current=null,zl.current="",Vt.current&&(clearInterval(Vt.current),Vt.current=null)),o.drawing?.drawingStrokes&&Array.isArray(o.drawing.drawingStrokes)){const T=o.drawing.drawingStrokes.map(C=>({...C,points:C.points.map(k=>({...k,...Yt(k)}))})).filter(C=>!(C.type==="trace"&&C.points.length<2));Pt(T);for(const C of T)for(const k of C.points)k.id&&typeof k.id=="number"&&Zf(k.id)}else console.warn("Project file missing drawingStrokes. Starting with empty strokes."),Pt([]);if(o.drawing?.componentsTop){const T=o.drawing.componentsTop.map(C=>{const k=Yt({x:C.x,y:C.y});return{...C,x:k.x,y:k.y,layer:C.layer||"top",pinConnections:C.pinConnections||new Array(C.pinCount||0).fill("")}});Qt(T)}if(o.drawing?.componentsBottom){const T=o.drawing.componentsBottom.map(C=>{const k=Yt({x:C.x,y:C.y});return{...C,x:k.x,y:k.y,layer:C.layer||"bottom",pinConnections:C.pinConnections||new Array(C.pinCount||0).fill("")}});rn(T)}if(o.designatorCounters&&typeof o.designatorCounters=="object"){const T=o.designatorCounters;}else ra.current={};if(typeof o.autoAssignDesignators=="boolean"&&Tr(o.autoAssignDesignators),typeof o.useGlobalDesignatorCounters=="boolean"?wl(o.useGlobalDesignatorCounters):wl(!1),ra.current={},o.drawing?.grounds){const C=o.drawing.grounds.map(k=>{k.pointId||console.warn("Ground symbol missing pointId - this may cause issues");const N=Yt({x:k.x,y:k.y});return{...k,x:N.x,y:N.y}}).filter(k=>{const N=k.y>=0&&k.x>=0&&typeof k.x=="number"&&typeof k.y=="number"&&!isNaN(k.x)&&!isNaN(k.y)&&isFinite(k.x)&&isFinite(k.y);return N||console.warn(`Filtered out invalid ground symbol at (${k.x}, ${k.y})`),N});qn(C);for(const k of C)k.pointId&&typeof k.pointId=="number"&&Zf(k.pointId)}let x;if(o.powerBuses&&Array.isArray(o.powerBuses)&&o.powerBuses.length>0?(x=o.powerBuses,Mi(x)):(x=[{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}],Mi(x)),o.groundBuses&&Array.isArray(o.groundBuses)&&o.groundBuses.length>0?Ol(o.groundBuses):Ol([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),o.drawing?.powers){const C=o.drawing.powers.map(k=>{k.pointId||console.warn("Power symbol missing pointId - this may cause issues");const N=Yt({x:k.x,y:k.y});return{...k,x:N.x,y:N.y}}).filter(k=>{const N=k.y>=0&&k.x>=0&&typeof k.x=="number"&&typeof k.y=="number"&&!isNaN(k.x)&&!isNaN(k.y)&&isFinite(k.x)&&isFinite(k.y);return N||console.warn(`Filtered out invalid power node at (${k.x}, ${k.y})`),N});oi(C);for(const k of C)k.pointId&&typeof k.pointId=="number"&&Zf(k.pointId)}Ei.current=!1,lo(!1),Jr(!1),setTimeout(()=>{as.current=!1},100)}catch(f){console.error("Failed to open project",f),alert("Failed to open project file. See console for details."),as.current=!1}},[B,Ne,cn,d,I,qf,Ss,ws,pr,Jo,js,Da,Ts,ui,bn,Tt,Ao,ao,so,_i,vl,co,Wl,yn,El,Co,ll,Pt,Qt,rn,qn,Mi,Ol,oi,$o,Yt,Qf,sx,Fd,Tr,wl,Qo]),rs=b.useCallback(async()=>{},[ec]),cs=b.useCallback(async o=>{const r=Vo.current;if(!r){console.warn("Cannot load file: no directory handle");return}try{const m=await(await r.getFileHandle(o)).getFile();if(m.size===0){console.warn(`File ${o} is empty, skipping`);const k=Ri.current.filter(N=>N!==o);xl(k),Ri.current=k;return}const y=await m.text();if(!y||y.trim().length===0){console.warn(`File ${o} contains no data, skipping`);const k=Ri.current.filter(N=>N!==o);xl(k),Ri.current=k;return}let v;try{v=JSON.parse(y)}catch(C){console.error(`Failed to parse JSON from file ${o}:`,C);const N=Ri.current.filter(U=>U!==o);xl(N),Ri.current=N,await rs();return}ya(),mi(1),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),we(new Set),nt(new Set),st(new Set),pt(new Set),Xl(),await Gl(v),Un(o);const T=Ri.current.indexOf(o);T>=0?(gr(T),os.current=T):await rs(),Ei.current=!1,lo(!1)}catch(f){console.error("Failed to load file from history:",f);const m=Ri.current;if(m.includes(o)){const y=m.filter(v=>v!==o);xl(y),Ri.current=y,await rs()}}},[Gl,rs,Xl]),gu=b.useCallback(async o=>{if(!cn){console.warn("Cannot restore file: no project directory handle"),alert("No project directory available. Please open or create a project first.");return}try{let r;try{r=await cn.getDirectoryHandle("history")}catch(x){console.error("History directory not found:",x),alert("History directory not found.");return}const m=await(await r.getFileHandle(o)).getFile();if(m.size===0){alert(`File ${o} is empty.`);return}const y=await m.text();if(!y||y.trim().length===0){alert(`File ${o} contains no data.`);return}let v;try{v=JSON.parse(y)}catch(x){console.error(`Failed to parse JSON from file ${o}:`,x),alert(`Failed to parse file ${o}. It may be corrupted.`);return}ya(),mi(1),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),we(new Set),nt(new Set),st(new Set),pt(new Set),Xl(),await Gl(v),Un(o),Ei.current=!1,console.log(`Successfully restored file: ${o}`)}catch(r){console.error("Failed to restore file from history:",r),alert(`Failed to restore file ${o}. Please try again.`)}},[cn,Gl,we,nt,st,pt,Un,mi,ya,Xl]);_e.useEffect(()=>{mr&&!ro&&Bo({x:window.innerWidth/2-300,y:window.innerHeight/2-250})},[mr,ro]);const ef=b.useCallback(o=>{if(!ro)return;vr(!0);const r=o.clientX-ro.x,f=o.clientY-ro.y,m=v=>{Bo({x:v.clientX-r,y:v.clientY-f})},y=()=>{vr(!1),document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",y)};document.addEventListener("mousemove",m),document.addEventListener("mouseup",y)},[ro]);b.useCallback(async()=>{const o=os.current,r=Ri.current;if(o>=0&&o<r.length-1){const f=o+1,m=r[f];m&&await cs(m)}},[cs]),b.useCallback(async()=>{const o=os.current,r=Ri.current;if(o<=0||o>=r.length||r.length===0){console.warn("Cannot navigate to newer file: index is",o,"history length is",r.length);return}if(o>0&&o<r.length&&r.length>0){const f=o-1;if(f>=0&&f<r.length){const m=r[f];m?await cs(m):(console.warn("No newer file found at index",f),await rs())}else console.warn("Cannot navigate to newer file: prevIndex",f,"is out of bounds")}},[cs,rs]),_e.useEffect(()=>{So.current=Xt},[Xt]);const Ls=_e.useRef(Ne),Vr=_e.useRef(lt);_e.useEffect(()=>{const o=Ne!==Ls.current;if(B==="draw"&&Ls.current==="trace"&&o){if(So.current.length>=2){pl(He,et,rt,Bi,ai);const r={id:`${Date.now()}-trace-autofinalize`,points:So.current,color:J,size:M,layer:Vr.current,type:"trace"};Pt(f=>[...f,r]),Vr.current==="top"?Gn(f=>[...f,r.id]):zn(f=>[...f,r.id])}bi([]),vo(!1)}Ls.current=Ne,Vr.current=lt},[Ne,lt,B,J,M]);const Sd=_e.useRef(B);_e.useEffect(()=>{if(Sd.current==="draw"&&B!=="draw"&&Ne==="trace"&&So.current.length>=2){const o={id:`${Date.now()}-trace-autofinalize`,points:So.current,color:J,size:M,layer:lt,type:"trace"};Pt(r=>[...r,o]),lt==="top"?Gn(r=>[...r,o.id]):zn(r=>[...r,o.id]),bi([]),vo(!1)}Sd.current=B},[B,Ne,J,M,lt]);const wd=_e.useMemo(()=>["#000000","#3C3C3C","#7F7F7F","#BFBFBF","#0072B2","#56B4E9","#00BFC4","#332288","#1F77B4","#A6CEE3","#17BECF","#6A3D9A","#009E73","#B3DE69","#E69F00","#F0E442","#2CA02C","#B2DF8A","#BCBD22","#FFED6F","#E15759","#D62728","#FB9A99","#CC79A7","#AA4499","#F781BF","#9467BD","#CAB2D6","#9C755F","#8C564B","#FF7F0E","#FFFFFF"],[]);_e.useEffect(()=>{Pr()},[He]),_e.useEffect(()=>{Pr()},[et,rt,dt,zi]);const at=tc>0,ma=b.useCallback(async()=>{const o=window;if(typeof o.showOpenFilePicker=="function")try{const[r]=await o.showOpenFilePicker({multiple:!1}),f=await r.getFile();if(!f.name.toLowerCase().endsWith(".json")){alert("Please select a .json project file.");return}po.current=!0,Sc(),await new Promise(C=>setTimeout(C,0)),Un(f.name);const m=await f.text(),y=JSON.parse(m);po.current=!0;let v=null;try{if(typeof r.getParent=="function")v=await r.getParent();else{console.warn("getParent() not available. Prompting user for directory access...");const C=window;if(typeof C.showDirectoryPicker=="function")v=await C.showDirectoryPicker({startIn:r});else throw new Error("Directory picker not available in this browser")}if(v)try{if((await(await v.getFileHandle(f.name)).getFile()).name!==f.name)throw new Error("Directory verification failed: file name mismatch")}catch(C){throw console.error("Directory verification failed:",C),console.error("The selected directory might not contain the opened file"),new Error("Directory verification failed - selected directory does not contain the opened file")}Zi(v),ba.current=v}catch(C){console.error("Failed to get directory handle from file handle:",C)}finally{setTimeout(()=>{po.current=!1},1e3)}const x=y.autoSave?.enabled===!0;await Gl(y,v);let T;if(y.projectInfo?.name?T=y.projectInfo.name:(T=f.name.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_")||"pcb_project",gl(T)),Zn||gl(T),x&&v){const C=T.replace(/\.json$/i,""),N=Wc(C).replace(/[^a-zA-Z0-9_-]/g,"_");Co(v),ll(N),Vo.current=v,zl.current=N,Vt.current&&(clearInterval(Vt.current),Vt.current=null)}setTimeout(()=>{Pi({visible:!0,source:"open",interval:5})},100)}catch(r){if(r?.name==="AbortError")return;console.warn("showOpenFilePicker failed, falling back to input",r),ic.current?.click()}else ic.current?.click()},[Gl,Zn,Un,gl,Zi,Pi,Oi,Co,ll,Sc]),Wr=b.useCallback(async()=>{ks({visible:!1}),await Fs(),await ma()},[Fs,ma]),jd=b.useCallback(async()=>{ks({visible:!1}),await ma()},[ma]),xu=b.useCallback(()=>{ks({visible:!1})},[]);_e.useEffect(()=>{if(ia.visible){setTimeout(()=>{Jc.current?.focus()},0);const o=r=>{r.key==="Enter"?(r.preventDefault(),Wr()):r.key==="Escape"&&(r.preventDefault(),ks({visible:!1}))};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}}},[ia.visible,Wr]);const Td=b.useCallback(async()=>{kc()?ks({visible:!0}):await ma()},[kc,ma]);return n.jsxs("div",{className:"app",children:[n.jsx("header",{className:"app-header",children:n.jsx("h1",{children:" Worms: An Electronics Tool (v2.6)"})}),n.jsx(yx,{openMenu:Gu,setOpenMenu:hr,isReadOnlyMode:at,currentProjectFilePath:ec,isProjectActive:!!cn,autoSaveEnabled:Oi,autoSaveInterval:hl,hasUnsavedChangesState:qd,onNewProject:ss,onOpenProject:Td,onSaveProject:Fs,onSaveAs:vd,onPrint:Er,hasUnsavedChanges:kc,setNewProjectDialog:na,setAutoSaveDialog:ea,topImage:g,bottomImage:R,setCurrentTool:te,resetImageTransform:pd,areImagesLocked:Ui,setAreImagesLocked:Ss,onEnterBoardDimensions:()=>_s(!0),fileInputTopRef:Kc,fileInputBottomRef:Jd,openProjectRef:ic,increaseSize:bc,decreaseSize:mc,brushSize:M,drawingStrokes:He,selectedIds:mt,selectedComponentIds:vt,selectedPowerIds:It,selectedGroundIds:jt,componentsTop:et,componentsBottom:rt,powers:yt,grounds:dt,powerNodeNames:uc,groundNodeNames:Hs,setSetSizeDialog:Zr,areViasLocked:ji,setAreViasLocked:ws,arePadsLocked:Xi,setArePadsLocked:pr,areTestPointsLocked:jo,setAreTestPointsLocked:Xc,areTracesLocked:Ti,setAreTracesLocked:Jo,areComponentsLocked:Gi,setAreComponentsLocked:js,areGroundNodesLocked:qi,setAreGroundNodesLocked:Da,arePowerNodesLocked:wn,setArePowerNodesLocked:Ts,showTraceCornerDots:Bs,setShowTraceCornerDots:sc,setSelectedIds:we,setSelectedComponentIds:nt,setSelectedPowerIds:st,setSelectedGroundIds:pt,selectAllVias:ua,selectAllTraces:od,selectAllPads:nu,selectAllComponents:fa,selectDisconnectedComponents:sl,selectAllComponentConnections:On,selectAllPowerNodes:qa,selectAllGroundNodes:fc,selectPowerNodesByName:kr,selectGroundNodesByName:Is,setShowPowerBusManager:Sl,setShowGroundBusManager:Wa,setShowDesignatorManager:La,setShowPastMachine:Ia,toolRegistry:Ht,updateToolSettings:Xr,updateToolLayerSettings:qo,setBrushSize:z,setBrushColor:ne,saveToolSettings:Nh,saveToolLayerSettings:Fc,colorPalette:wd,currentTool:B,drawingMode:Ne,traceToolLayer:ft,padToolLayer:Lt,testPointToolLayer:ln,componentToolLayer:vn,setTopTraceSize:j,setBottomTraceSize:be,setTopPadSize:L,setBottomPadSize:A,setTopTestPointSize:xt,setBottomTestPointSize:_n,setTopComponentSize:Nl,setBottomComponentSize:Ql,setComponentConnectionSize:Lc,topTraceColor:D,bottomTraceColor:E,topPadColor:re,bottomPadColor:O,topTestPointColor:$,bottomTestPointColor:Oe,topComponentColor:Mn,bottomComponentColor:Di,setTopTraceColor:P,setBottomTraceColor:pe,setTopPadColor:_,setBottomPadColor:Y,setTopTestPointColor:Z,setBottomTestPointColor:Ge,setTopComponentColor:Vi,setBottomComponentColor:yi,setComponentConnectionColor:ir,saveDefaultSize:Je,saveDefaultColor:ut,menuBarRef:Ki,onOpenProjectNotes:uu,onOpenTransformImages:()=>Rs(!0),onOpenTransformAll:()=>Zc(!0)}),n.jsx("div",{style:{display:"block",padding:0,margin:0,width:"100vw",height:"calc(100vh - 70px)",boxSizing:"border-box",position:"relative"},children:n.jsxs("div",{ref:xr,style:{position:"relative",width:"100%",height:"100%",margin:0,padding:0,boxSizing:"border-box",background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",borderRadius:"16px",overflow:"hidden"},children:[n.jsxs("div",{style:{position:"absolute",top:6,left:6,bottom:6,width:46,display:"flex",flexDirection:"column",gap:8,padding:"6px 3px",background:"rgba(250,250,255,0.95)",borderRadius:8,border:"1px solid #ddd",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:20},children:[n.jsxs("button",{onClick:()=>{at||is()},onMouseDown:o=>o.currentTarget.blur(),disabled:at,title:"Select (S)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:B==="select"?"2px solid #000":"1px solid #ddd",background:B==="select"?"#e6f0ff":"#fff",color:at?"#999":"#222",outline:"none",cursor:at?"not-allowed":"pointer",opacity:at?.5:1},children:[n.jsx(Kg,{size:14}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"S"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),n.jsxs("button",{onClick:()=>{at||(console.log("Via tool clicked"),Yn("via"),te("draw"))},disabled:at,title:"Draw Vias (V)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:B==="draw"&&Ne==="via"?"2px solid #000":"1px solid #ddd",background:B==="draw"&&Ne==="via"?"#e6f0ff":"#fff",color:at?"#999":"#222",cursor:at?"not-allowed":"pointer",opacity:at?.5:1},children:[n.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const o=At.get("via").color;return n.jsxs(n.Fragment,{children:[n.jsx("circle",{cx:"12",cy:"12",r:"8",fill:"none",stroke:o,strokeWidth:"3"}),n.jsx("circle",{cx:"12",cy:"12",r:"4",fill:o})]})})()}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"V"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:At.get("via").size})]})]}),n.jsxs("button",{ref:Nr,onClick:()=>{at||(console.log("Pad tool clicked"),Yn("pad"),te("draw"),Za(!0),Cn(Lt||"top"),setTimeout(()=>Or(),0))},disabled:at,title:"Draw Pads (P)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:B==="draw"&&Ne==="pad"?"2px solid #000":"1px solid #ddd",background:B==="draw"&&Ne==="pad"?"#e6f0ff":"#fff",color:at?"#999":"#222",cursor:at?"not-allowed":"pointer",opacity:at?.5:1},children:[n.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const r=(Lt||"top")==="top"?"padTop":"padBottom",f=At.get(r).color,m=14,y=(24-m)/2,v=(24-m)/2;return n.jsx("rect",{x:y,y:v,width:m,height:m,fill:f})})()}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"P"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{if(B==="draw"&&Ne==="pad"&&Ot.toolInstanceId&&(Ot.toolInstanceId==="padTop"||Ot.toolInstanceId==="padBottom"))return Ot.size;const o=Lt==="top"?"padTop":"padBottom";return At.get(o).size})()})]})]}),n.jsxs("button",{ref:Mr,onClick:()=>{at||(console.log("Test Point tool clicked"),Yn("testPoint"),te("draw"),ha(!0),Cn(ln||"top"),setTimeout(()=>jc(),0))},disabled:at,title:"Draw Test Points (Y)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:B==="draw"&&Ne==="testPoint"?"2px solid #000":"1px solid #ddd",background:B==="draw"&&Ne==="testPoint"?"#e6f0ff":"#fff",color:at?"#999":"#222",cursor:at?"not-allowed":"pointer",opacity:at?.5:1},children:[n.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const r=(ln||"top")==="top"?"testPointTop":"testPointBottom",f=At.get(r).color,m=14,y=12,v=12;return n.jsx("path",{d:`M ${y} ${v-m/2} L ${y+m/2} ${v} L ${y} ${v+m/2} L ${y-m/2} ${v} Z`,fill:f,stroke:"#000",strokeWidth:"1.5"})})()}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"Y"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{if(B==="draw"&&Ne==="testPoint"&&Ot.toolInstanceId&&(Ot.toolInstanceId==="testPointTop"||Ot.toolInstanceId==="testPointBottom"))return Ot.size;const o=ln==="top"?"testPointTop":"testPointBottom";return At.get(o).size})()})]})]}),n.jsxs("button",{ref:Ar,onClick:()=>{at||(console.log("Trace tool clicked"),Yn("trace"),te("draw"),_o(!0),Cn(ft||"top"),setTimeout(()=>wc(),0))},disabled:at,title:"Draw Traces (T)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:B==="draw"&&Ne==="trace"?"2px solid #000":"1px solid #ddd",background:B==="draw"&&Ne==="trace"?"#e6f0ff":"#fff",color:at?"#999":"#222",cursor:at?"not-allowed":"pointer",opacity:at?.5:1},children:[n.jsx(Jg,{size:14,color:(()=>{const r=(ft||"top")==="top"?"traceTop":"traceBottom";return At.get(r).color})()}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"T"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{const o=ft==="top"?"traceTop":"traceBottom";return At.get(o).size})()})]})]}),n.jsxs("button",{ref:Br,onClick:()=>{at||(console.log("Component tool clicked"),te("component"),Ho(!0),rl(!1),es(null))},disabled:at,title:"Draw Component (C)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:B==="component"?"2px solid #000":"1px solid #ddd",background:B==="component"?"#e6f0ff":"#fff",color:at?"#999":"#222",cursor:at?"not-allowed":"pointer",opacity:at?.5:1},children:[(()=>{const r=(vn||"top")==="top"?"componentTop":"componentBottom",f=At.get(r).color;return Fn?n.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[n.jsx("rect",{x:"4",y:"4",width:"16",height:"16",fill:"rgba(255,255,255,0.9)",stroke:f,strokeWidth:"1.5"}),n.jsx("text",{x:"12",y:"14",textAnchor:"middle",fontSize:"7",fill:f,fontWeight:"bold",fontFamily:"monospace",children:Kf(Fn)})]}):n.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[n.jsx("rect",{x:"5",y:"3",width:"14",height:"7",fill:f,stroke:f,strokeWidth:"0.5"}),n.jsxs("g",{stroke:f,fill:"none",strokeWidth:"1.5",children:[n.jsx("rect",{x:"5",y:"10",width:"14",height:"4",rx:"1.2"}),n.jsx("path",{d:"M7 14 v4 M10 14 v4 M13 14 v4 M16 14 v4",stroke:f})]})]})})(),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"C"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{const o=vn==="top"?"componentTop":"componentBottom";return At.get(o).size})()})]})]}),n.jsxs("button",{ref:pc,onClick:()=>{at||(console.log("Power tool clicked"),jn(!1),Ke.length===1?(Va(Ke[0].id),te("power"),Jn(!1)):Ke.length>1?Jn(!0):(Jn(!0),te("power")))},disabled:at,title:"Draw Power (B)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:B==="power"?"2px solid #000":"1px solid #ddd",background:B==="power"?"#e6f0ff":"#fff",color:at?"#999":"#222",cursor:at?"not-allowed":"pointer",opacity:at?.5:1},children:[n.jsx("span",{style:{color:(Il?Ke.find(o=>o.id===Il)?.color:null)||"#ff0000",fontSize:"18px",fontWeight:"bold",lineHeight:1,flexShrink:0},children:"V"}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"B"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:At.get("power").size})]})]}),n.jsxs("button",{ref:cd,onClick:()=>{at||(console.log("Ground tool clicked"),Jn(!1),Gt.length===1?(Fa(Gt[0].id),te("ground"),jn(!1)):Gt.length>1?jn(!0):(jn(!0),te("ground")))},disabled:at,title:"Draw Ground (G)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:B==="ground"?"2px solid #000":"1px solid #ddd",background:B==="ground"?"#e6f0ff":"#fff",color:at?"#999":"#222",cursor:at?"not-allowed":"pointer",opacity:at?.5:1},children:[n.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 20","aria-hidden":"true",style:{overflow:"visible",flexShrink:0},children:n.jsxs("g",{stroke:(ei?Gt.find(o=>o.id===ei)?.color:null)||"#000000",strokeWidth:"2",strokeLinecap:"round",children:[n.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"10"}),n.jsx("line",{x1:"5",y1:"10",x2:"19",y2:"10"}),n.jsx("line",{x1:"7",y1:"13",x2:"17",y2:"13"}),n.jsx("line",{x1:"9.5",y1:"16",x2:"14.5",y2:"16"})]})}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"G"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:At.get("ground").size})]})]}),n.jsx("div",{style:{height:72}}),n.jsxs("button",{onClick:()=>{at||te(o=>o==="pan"?"draw":"pan")},disabled:at,title:"Move (H)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:6,padding:"4px 6px",borderRadius:6,border:B==="pan"?"2px solid #000":"1px solid #ddd",background:B==="pan"?"#e6f0ff":"#fff",color:at?"#999":"#222",cursor:at?"not-allowed":"pointer",opacity:at?.5:1},children:[n.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:n.jsxs("g",{stroke:"#111",fill:"none",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round",children:[n.jsx("path",{d:"M8 11v-4c0-.8.6-1.3 1.3-1.3S11 6.2 11 7v4"}),n.jsx("path",{d:"M11 11V6.5c0-.8.6-1.3 1.3-1.3S14 5.7 14 6.5V11"}),n.jsx("path",{d:"M14 11V7.2c0-.8.6-1.3 1.3-1.3.7 0 1.3.5 1.3 1.3V12c1 .6 1.6 1.5 1.6 2.7A4.3 4.3 0 0 1 14 19H9.2A4.2 4.2 0 0 1 5 14.8V11c0-.6.4-1 .9-1 .6 0 1 .4 1 1v2"})]})}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"H"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),n.jsxs("button",{onClick:()=>{Ua(!1),te(o=>o==="magnify"?"draw":"magnify")},title:"Magnify (M)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:B==="magnify"?"2px solid #000":"1px solid #ddd",background:B==="magnify"?"#e6f0ff":"#fff",color:"#222",cursor:"pointer"},children:[n.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[n.jsx("circle",{cx:"10",cy:"10",r:"7.5",fill:"none",stroke:"#111",strokeWidth:"2"}),n.jsx("line",{x1:"15.5",y1:"15.5",x2:"21",y2:"21",stroke:"#111",strokeWidth:"2",strokeLinecap:"round"}),As?n.jsx("line",{x1:"6.5",y1:"10",x2:"13.5",y2:"10",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"}):n.jsxs(n.Fragment,{children:[n.jsx("line",{x1:"6.5",y1:"10",x2:"13.5",y2:"10",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"}),n.jsx("line",{x1:"10",y1:"6.5",x2:"10",y2:"13.5",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"})]})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"M"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),n.jsxs("button",{onClick:()=>{at||(te("center"),Hl(!0),Qn.current&&clearTimeout(Qn.current),Qn.current=setTimeout(()=>{Hl(!1),te("select"),Xn(void 0)},2e3))},disabled:at,title:"Set View (X) - Press 0-9 to Set View",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:B==="center"?"2px solid #000":"1px solid #ddd",background:B==="center"?"#e6f0ff":"#fff",color:at?"#999":"#222",cursor:at?"not-allowed":"pointer",opacity:at?.5:1},children:[n.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[n.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"10",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),n.jsx("line",{x1:"12",y1:"14",x2:"12",y2:"22",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),n.jsx("line",{x1:"2",y1:"12",x2:"10",y2:"12",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),n.jsx("line",{x1:"14",y1:"12",x2:"22",y2:"12",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"X"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onClick:()=>{at||io(o=>!o)},disabled:at,title:"Color Picker",style:{width:32,height:32,display:"grid",placeItems:"center",borderRadius:6,border:"1px solid #ddd",background:"#fff",cursor:at?"not-allowed":"pointer",opacity:at?.5:1},children:n.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 16 16","aria-hidden":"true",children:[n.jsx("rect",{x:"0",y:"0",width:"3.5",height:"3.5",fill:"#9E9E9E",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"4",y:"0",width:"3.5",height:"3.5",fill:"#0072B2",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"8",y:"0",width:"3.5",height:"3.5",fill:"#56B4E9",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"12",y:"0",width:"3.5",height:"3.5",fill:"#00BFC4",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"0",y:"4",width:"3.5",height:"3.5",fill:"#6A3D9A",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"4",y:"4",width:"3.5",height:"3.5",fill:"#2CA02C",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"8",y:"4",width:"3.5",height:"3.5",fill:"#7FC97F",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"12",y:"4",width:"3.5",height:"3.5",fill:"#FF7F0E",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"0",y:"8",width:"3.5",height:"3.5",fill:"#FFD700",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"4",y:"8",width:"3.5",height:"3.5",fill:"#FF6B6B",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"8",y:"8",width:"3.5",height:"3.5",fill:"#E74C3C",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"12",y:"8",width:"3.5",height:"3.5",fill:"#FFB6C1",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"0",y:"12",width:"3.5",height:"3.5",fill:"#DDA0DD",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"4",y:"12",width:"3.5",height:"3.5",fill:"#8B4513",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"8",y:"12",width:"3.5",height:"3.5",fill:"#A0522D",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"12",y:"12",width:"3.5",height:"3.5",fill:"#FF4500",stroke:"#ccc",strokeWidth:"0.3"})]})}),Ma&&n.jsx("div",{ref:br,style:{position:"absolute",left:42,top:0,padding:8,background:"#fff",border:"1px solid #ddd",borderRadius:6,boxShadow:"0 8px 18px rgba(0,0,0,0.18)",zIndex:50},children:n.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(8, 22px)",gap:4},children:wd.map(o=>n.jsx("div",{onClick:()=>{ne(o),io(!1);try{let f=null;B==="draw"&&Ne==="via"?f="via":B==="draw"&&Ne==="pad"?f=(Lt||"top")==="bottom"?"padBottom":"padTop":B==="draw"&&Ne==="testPoint"?f=(ln||"top")==="bottom"?"testPointBottom":"testPointTop":B==="draw"&&Ne==="trace"?f=(ft||"top")==="bottom"?"traceBottom":"traceTop":B==="component"?f=(vn||"top")==="bottom"?"componentBottom":"componentTop":B==="power"?f="power":B==="ground"&&(f="ground"),f&&At.setColor(f,o)}catch(f){console.error("Error updating tool instance color:",f)}const r=fl(Ht);if(r)if(B==="draw"&&Ne==="trace"){const f=ft||"top",y=r.layerSettings.get(f)?.size||r.settings.size,v={color:o,size:y};qo(r.id,f,v),Fc(r.id),f==="top"?(P(o),ut("trace",o,"top")):(pe(o),ut("trace",o,"bottom"))}else if(B==="draw"&&Ne==="pad"){const f=Lt||"top",y=r.layerSettings.get(f)?.size||r.settings.size,v={color:o,size:y};qo(r.id,f,v),Fc(r.id),f==="top"?(_(o),ut("pad",o,"top")):(Y(o),ut("pad",o,"bottom"))}else if(B==="draw"&&Ne==="testPoint"){const f=ln||"top",y=r.layerSettings.get(f)?.size||r.settings.size,v={color:o,size:y};qo(r.id,f,v),Fc(r.id),f==="top"?(Z(o),ut("testPoint",o,"top")):(Ge(o),ut("testPoint",o,"bottom"))}else if(B==="component"){const f=vn||"top",y=r.layerSettings.get(f)?.size||r.settings.size,v={color:o,size:y};qo(r.id,f,v),Fc(r.id),f==="top"?(Vi(o),ut("component",o,"top")):(yi(o),ut("component",o,"bottom"))}else{const f={...r.settings,color:o};Xr(r.id,f),Nh(r.id,o,r.settings.size),B==="draw"&&Ne==="via"&&ut("via",o)}ut("brush",o),mt.size>0&&Pt(f=>f.map(m=>mt.has(m.id)?(m.type==="via"?(ut("via",o),on(y=>{const v=new Map(y),x=v.get("via");return x&&v.set("via",{...x,settings:{...x.settings,color:o}}),v})):m.type==="pad"?(ut("pad",o),on(y=>{const v=new Map(y),x=v.get("pad");return x&&v.set("pad",{...x,settings:{...x.settings,color:o}}),v})):m.type==="trace"&&ut("trace",o,m.layer),{...m,color:o}):m)),vt.size>0&&(ut("component",o),Qt(f=>f.map(m=>vt.has(m.id)?{...m,color:o}:m)),rn(f=>f.map(m=>vt.has(m.id)?{...m,color:o}:m))),It.size>0&&oi(f=>f.map(m=>It.has(m.id)?{...m,color:o}:m)),jt.size>0&&qn(f=>f.map(m=>jt.has(m.id)?{...m,color:o}:m))},title:o,style:{width:22,height:22,backgroundColor:o,border:o===J?"2px solid #333":"1px solid #ccc",cursor:"pointer"}},o))})})]})]}),B==="draw"&&Ne==="trace"&&dn&&n.jsxs("div",{ref:pa,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[n.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[n.jsx("input",{type:"radio",name:"traceToolLayer",checked:ft==="top",onChange:()=>{console.log("Trace tool Top clicked"),Xo.current="top",Bn("top"),Cn("top"),ne(D),z(W),on(o=>{const r=new Map(o),f=r.get("trace");return f&&r.set("trace",{...f,settings:{color:D,size:W}}),r}),_o(!1),Pn(!0)}}),n.jsx("span",{children:"Top"})]}),n.jsxs("label",{className:"radio-label",children:[n.jsx("input",{type:"radio",name:"traceToolLayer",checked:ft==="bottom",onChange:()=>{console.log("Trace tool Bottom clicked"),Xo.current="bottom",Bn("bottom"),Cn("bottom"),ne(E),z(me),on(o=>{const r=new Map(o),f=r.get("trace");return f&&r.set("trace",{...f,settings:{color:E,size:me}}),r}),_o(!1),di(!0)}}),n.jsx("span",{children:"Bottom"})]})]}),B==="draw"&&Ne==="pad"&&Rr&&n.jsxs("div",{ref:Ka,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[n.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[n.jsx("input",{type:"radio",name:"padToolLayer",checked:Lt==="top",onChange:()=>{console.log("Pad tool Top clicked"),Bl.current="top",wa("top"),Cn("top");const o=At.get("padTop");ne(o.color),z(o.size),on(r=>{const f=new Map(r),m=f.get("pad");return m&&f.set("pad",{...m,settings:{color:o.color,size:o.size}}),f}),Za(!1),Pn(!0)}}),n.jsx("span",{children:"Top"})]}),n.jsxs("label",{className:"radio-label",children:[n.jsx("input",{type:"radio",name:"padToolLayer",checked:Lt==="bottom",onChange:()=>{console.log("Pad tool Bottom clicked"),Bl.current="bottom",wa("bottom"),Cn("bottom");const o=At.get("padBottom");ne(o.color),z(o.size),on(r=>{const f=new Map(r),m=f.get("pad");return m&&f.set("pad",{...m,settings:{color:o.color,size:o.size}}),f}),Za(!1),di(!0)}}),n.jsx("span",{children:"Bottom"})]})]}),B==="draw"&&Ne==="testPoint"&&ad&&n.jsxs("div",{ref:Qa,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[n.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[n.jsx("input",{type:"radio",name:"testPointToolLayer",checked:ln==="top",onChange:()=>{console.log("Test Point tool Top clicked"),Ul.current="top",sr("top"),Cn("top"),ne($),z(Xe),on(o=>{const r=new Map(o),f=r.get("testPoint");return f&&r.set("testPoint",{...f,settings:{color:$,size:Xe}}),r}),ha(!1),Pn(!0)}}),n.jsx("span",{children:"Top"})]}),n.jsxs("label",{className:"radio-label",children:[n.jsx("input",{type:"radio",name:"testPointToolLayer",checked:ln==="bottom",onChange:()=>{console.log("Test Point tool Bottom clicked"),Ul.current="bottom",sr("bottom"),Cn("bottom"),ne(Oe),z(Pe),on(o=>{const r=new Map(o),f=r.get("testPoint");return f&&r.set("testPoint",{...f,settings:{color:Oe,size:Pe}}),r}),ha(!1),di(!0)}}),n.jsx("span",{children:"Bottom"})]})]}),ac&&n.jsxs("div",{ref:ni,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25,minWidth:"200px"},children:[n.jsx("div",{style:{marginBottom:"4px",fontWeight:600,fontSize:"12px",color:"#333"},children:"Select Power Bus:"}),Ke.length===0?n.jsx("div",{style:{padding:"8px",color:"#666",fontSize:"12px"},children:"No power buses defined. Use Tools  Manage Power Buses to add one."}):[...Ke].sort((o,r)=>{const f=v=>{const x=v.match(/([+-]?)(\d+\.?\d*)/);if(x){const T=x[1]||"+",C=parseFloat(x[2]);return{absValue:Math.abs(C),isNegative:T==="-",original:v}}return{absValue:1/0,isNegative:!1,original:v}},m=f(o.voltage),y=f(r.voltage);return m.absValue!==y.absValue?m.absValue-y.absValue:m.isNegative!==y.isNegative?m.isNegative?-1:1:0}).map(o=>n.jsx("button",{onClick:r=>{r.preventDefault(),r.stopPropagation(),Va(o.id),B!=="power"&&te("power"),Jn(!1)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#222"},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[n.jsx("div",{style:{width:16,height:16,borderRadius:"50%",background:o.color,border:"1px solid #ccc"}}),n.jsxs("div",{children:[n.jsx("div",{style:{fontWeight:600,fontSize:"13px"},children:o.name}),n.jsx("div",{style:{fontSize:"11px",color:"#666"},children:o.voltage})]})]})},o.id)),n.jsx("div",{style:{height:1,background:"#ddd",margin:"4px 0"}}),n.jsx("button",{onClick:o=>{o.preventDefault(),o.stopPropagation(),Jn(!1),Sl(!0)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"11px"},children:"Manage Power Buses"}),n.jsx("button",{onClick:o=>{o.preventDefault(),o.stopPropagation(),Jn(!1),Va(null),te("select")},style:{display:"block",width:"100%",textAlign:"center",padding:"4px 6px",marginTop:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#666",fontSize:"11px"},children:"Cancel"})]}),jr&&n.jsxs("div",{ref:mn,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25,minWidth:"200px"},children:[n.jsx("div",{style:{marginBottom:"4px",fontWeight:600,fontSize:"12px",color:"#333"},children:"Select Ground Bus:"}),Gt.length===0?n.jsx("div",{style:{padding:"8px",color:"#666",fontSize:"12px"},children:"No ground buses defined. Use Tools  Manage Ground Buses to add one."}):[...Gt].sort((o,r)=>o.name.localeCompare(r.name)).map(o=>{const r=o.id==="groundbus-earth",f=ei===o.id;return n.jsx("button",{onClick:m=>{m.preventDefault(),m.stopPropagation(),Fa(o.id),B!=="ground"&&te("ground"),jn(!1)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:f?"#e0e0e0":"#f5f5f5",border:f?"2px solid #000":"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#222"},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[n.jsx("div",{style:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:r?n.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",style:{display:"block"},children:[n.jsx("line",{x1:"10",y1:"2",x2:"10",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),n.jsx("line",{x1:"4",y1:"10",x2:"16",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),n.jsx("line",{x1:"5",y1:"12.5",x2:"15",y2:"12.5",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),n.jsx("line",{x1:"6",y1:"15",x2:"14",y2:"15",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"})]}):n.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",style:{display:"block"},children:[n.jsx("circle",{cx:"10",cy:"10",r:"6",fill:"none",stroke:"#000",strokeWidth:"2"}),n.jsx("line",{x1:"10",y1:"2",x2:"10",y2:"18",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),n.jsx("line",{x1:"2",y1:"10",x2:"18",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"})]})}),n.jsx("div",{children:n.jsx("div",{style:{fontWeight:600,fontSize:"13px"},children:o.name})})]})},o.id)}),n.jsx("div",{style:{height:1,background:"#ddd",margin:"4px 0"}}),n.jsx("button",{onClick:o=>{o.preventDefault(),o.stopPropagation(),jn(!1),Wa(!0)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"11px"},children:"Manage Ground Buses"}),n.jsx("button",{onClick:o=>{o.preventDefault(),o.stopPropagation(),jn(!1),Fa(null),te("select")},style:{display:"block",width:"100%",textAlign:"center",padding:"4px 6px",marginTop:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#666",fontSize:"11px"},children:"Cancel"})]}),B==="component"&&ga&&n.jsxs("div",{ref:xa,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[n.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[n.jsx("input",{type:"radio",name:"componentToolLayer",checked:lt==="top",onClick:()=>{console.log("Component tool Top clicked"),Pl.current="top",wo("top"),Cn("top"),ne(Mn),z(Ai),on(o=>{const r=new Map(o),f=r.get("component");return f&&r.set("component",{...f,settings:{color:Mn,size:Ai}}),r}),Ho(!1),Pn(!0),rl(!0)}}),n.jsx("span",{children:"Top"})]}),n.jsxs("label",{className:"radio-label",children:[n.jsx("input",{type:"radio",name:"componentToolLayer",checked:lt==="bottom",onClick:()=>{console.log("Component tool Bottom clicked"),Pl.current="bottom",wo("bottom"),Cn("bottom"),ne(Di),z(el),on(o=>{const r=new Map(o),f=r.get("component");return f&&r.set("component",{...f,settings:{color:Di,size:el}}),r}),Ho(!1),di(!0),rl(!0)}}),n.jsx("span",{children:"Bottom"})]})]}),B==="component"&&Ja&&n.jsxs("div",{ref:rd,style:{position:"absolute",top:44,left:52,padding:"8px",background:"#fff",border:"1px solid #ddd",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:26,maxHeight:"500px",overflowY:"auto",minWidth:"250px",maxWidth:"350px"},children:[n.jsx("div",{style:{marginBottom:"8px",fontWeight:600,fontSize:"13px",color:"#333",borderBottom:"1px solid #eee",paddingBottom:"6px"},children:"Select Component Type:"}),Object.entries(ix).map(([o,r])=>{const f=sd.has(o);return n.jsxs("div",{style:{marginBottom:"4px"},children:[n.jsxs("button",{onClick:m=>{m.preventDefault(),m.stopPropagation(),iu(y=>{const v=new Set(y);return v.has(o)?v.delete(o):v.add(o),v})},style:{display:"flex",alignItems:"center",width:"100%",textAlign:"left",padding:"6px 8px",background:f?"#f0f0f0":"#fff",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",fontSize:"12px",fontWeight:600,color:"#333"},children:[n.jsx("span",{style:{marginRight:"6px",fontSize:"10px"},children:f?"":""}),o]}),f&&n.jsx("div",{style:{marginLeft:"12px",marginTop:"2px",marginBottom:"4px"},children:Object.entries(r).map(([m,y])=>n.jsxs("div",{style:{marginBottom:"2px"},children:[n.jsxs("div",{style:{fontSize:"11px",fontWeight:500,color:"#666",padding:"2px 4px",marginBottom:"2px"},children:[m,":"]}),y.map(v=>{const x=$d[v];return x?n.jsxs("button",{onClick:T=>{T.preventDefault(),T.stopPropagation();const C=v;es(C),Dr.current=C,rl(!1)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 8px 4px 16px",marginBottom:"2px",background:Fn===v?"#e6f0ff":"#fff",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",fontSize:"11px",color:"#333"},children:[x.prefix.join(", ")," - ",Ld(v)]},v):null})]},m))})]},o)}),n.jsx("button",{onClick:o=>{o.preventDefault(),o.stopPropagation(),rl(!1),te("select")},style:{display:"block",width:"100%",textAlign:"center",padding:"6px 10px",marginTop:"8px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#222"},children:"Cancel"})]}),n.jsxs("div",{style:{position:"absolute",top:6,left:60,bottom:6,width:168,padding:6,display:"flex",flexDirection:"column",gap:2,background:"rgba(250,250,255,0.95)",borderRadius:8,border:"1px solid #ddd",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:3},children:[n.jsx("div",{style:{fontSize:11,fontWeight:700,color:"#333",marginBottom:2},children:"Layers"}),n.jsxs("div",{onClick:()=>Cn("top"),title:"Top layer",style:{cursor:"pointer",padding:2,borderRadius:4,border:Bt==="top"?"2px solid #0b5fff":"1px solid #ddd",background:"#fff"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:2},children:[n.jsx("div",{style:{fontSize:10,color:"#444",fontWeight:600},children:"Top Image"}),n.jsx("label",{className:"radio-label",style:{margin:0},children:n.jsx("input",{type:"checkbox",checked:oo,onChange:o=>Pn(o.target.checked)})})]}),n.jsx("canvas",{ref:_a,width:60,height:40,style:{width:"60px",height:"40px"}})]}),n.jsxs("div",{onClick:()=>Cn("bottom"),title:"Bottom layer",style:{cursor:"pointer",padding:2,borderRadius:4,border:Bt==="bottom"?"2px solid #0b5fff":"1px solid #ddd",background:"#fff"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:2},children:[n.jsx("div",{style:{fontSize:10,color:"#444",fontWeight:600},children:"Bottom Image"}),n.jsx("label",{className:"radio-label",style:{margin:0},children:n.jsx("input",{type:"checkbox",checked:ci,onChange:o=>di(o.target.checked)})})]}),n.jsx("canvas",{ref:Ha,width:60,height:40,style:{width:"60px",height:"40px"}})]}),n.jsx("div",{style:{height:1,background:"#e9e9ef",margin:"2px 0"}}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:hn,onChange:o=>ui(o.target.checked)}),n.jsx("span",{children:"Vias"})]}),n.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:Qi,onChange:o=>bn(o.target.checked)}),n.jsx("span",{children:"Pads (Top)"})]}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:fi,onChange:o=>pi(o.target.checked)}),n.jsx("span",{children:"Test Points (Top)"})]}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:Dn,onChange:o=>Ao(o.target.checked)}),n.jsx("span",{children:"Traces (Top)"})]}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:al,onChange:o=>so(o.target.checked)}),n.jsx("span",{children:"Components (Top)"})]}),n.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:Ut,onChange:o=>Tt(o.target.checked)}),n.jsx("span",{children:"Pads (Bottom)"})]}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:bl,onChange:o=>ol(o.target.checked)}),n.jsx("span",{children:"Test Points (Bottom)"})]}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:Ci,onChange:o=>ao(o.target.checked)}),n.jsx("span",{children:"Traces (Bottom)"})]}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:hi,onChange:o=>_i(o.target.checked)}),n.jsx("span",{children:"Components (Bottom)"})]}),n.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:ml,onChange:o=>vl(o.target.checked)}),n.jsx("span",{children:"Power"})]}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:zi,onChange:o=>co(o.target.checked)}),n.jsx("span",{children:"Ground"})]}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:Vl,onChange:o=>Wl(o.target.checked)}),n.jsx("span",{children:"Connections"})]}),n.jsx("div",{style:{height:1,background:"#e9e9ef",margin:"2px 0"}}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:hn&&Qi&&Ut&&fi&&bl&&Dn&&Ci&&al&&hi&&ml&&zi&&Vl,onChange:o=>{const r=o.target.checked;ui(r),bn(r),Tt(r),pi(r),ol(r),Ao(r),ao(r),so(r),_i(r),vl(r),co(r),Wl(r)}}),n.jsx("span",{style:{fontWeight:600,fontSize:11},children:"Select All Layers"})]}),n.jsxs("div",{style:{marginTop:6},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[n.jsxs("label",{style:{fontSize:10,color:"#333"},children:["Transparency: ",p,"%"]}),n.jsxs("label",{className:"radio-label",style:{margin:0},children:[n.jsx("input",{type:"checkbox",checked:ue,onChange:o=>{const r=o.target.checked;r?(Pn(!0),di(!0)):(V(50),te("select")),he(r)}}),n.jsx("span",{style:{marginLeft:6,fontSize:10},children:"Cycle"})]})]}),n.jsx("input",{type:"range",min:"0",max:"100",value:p,onChange:o=>V(Number(o.target.value)),onDoubleClick:()=>Ju("transparency"),className:"slider",style:{width:"100%",marginTop:3}}),ue&&n.jsxs("div",{style:{marginTop:6},children:[n.jsxs("label",{style:{fontSize:10,color:"#333"},children:["Cycle Speed: ",(Ce/1e3).toFixed(1),"s"]}),n.jsx("input",{type:"range",min:"500",max:"8000",step:"100",value:8500-Ce,onChange:o=>Me(8500-Number(o.target.value)),onDoubleClick:()=>Me(2e3),className:"slider",style:{width:"100%",marginTop:3}})]})]})]}),n.jsx(bx,{visible:!g&&!R}),n.jsx("canvas",{ref:Sn,width:Do.width,height:Do.height,tabIndex:0,onMouseDown:au,onMouseMove:ru,onMouseUp:xc,onMouseLeave:xc,onWheel:Vs,onDoubleClick:su,className:`pcb-canvas ${B==="transform"?"transform-cursor":B==="draw"?"draw-cursor":B==="erase"?"erase-cursor":"default-cursor"}`,style:{position:"absolute",left:"244px",top:"6px",...ja?{cursor:ja}:B==="pan"?{cursor:si?"grabbing":"grab"}:{},width:`${Do.width}px`,height:`${Do.height}px`,maxHeight:"none",aspectRatio:"auto",border:"none"}}),n.jsx(Rx,{componentEditor:ka,setComponentEditor:Ra,componentsTop:et,componentsBottom:rt,setComponentsTop:Qt,setComponentsBottom:rn,connectingPin:Rn,setConnectingPin:Zo,componentDialogPosition:nl,setComponentDialogPosition:il,isDraggingDialog:cr,setIsDraggingDialog:dr,dialogDragOffset:vs,setDialogDragOffset:ur,areComponentsLocked:Gi,setSelectedComponentIds:nt,setNotesDialogVisible:jl}),ri&&ko&&(()=>{const o=ri.component,r=ri.layer;if(!o)return null;const f=o.componentType||"Component",m=o.componentType==="IntegratedCircuit"&&"icType"in o?o.icType:null,y=Qu(o);return n.jsxs("div",{style:{position:"fixed",left:`${ri.x+10}px`,top:`${ri.y+10}px`,background:"rgba(0, 0, 0, 0.85)",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:"12px",lineHeight:"1.4",zIndex:1e4,pointerEvents:"none",width:"max-content",maxWidth:"400px",minWidth:"150px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)",wordWrap:"break-word",overflowWrap:"break-word"},children:[n.jsx("div",{style:{fontWeight:600,marginBottom:"4px"},children:Ld(f)}),n.jsxs("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:["Layer: ",r==="top"?"Top":"Bottom"]}),m&&n.jsxs("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:["IC Type: ",m]}),y.length>0&&n.jsx("div",{style:{marginBottom:"4px"},children:y.map((v,x)=>n.jsx("div",{style:{color:"#e0e0e0",fontSize:"11px",marginBottom:"2px"},children:v},x))}),o.description&&n.jsx("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:o.description}),o.notes&&n.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid rgba(255,255,255,0.2)",fontSize:"11px",color:"#d0d0d0",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:o.notes})]})})(),yl&&ko&&(()=>{const o=yl.stroke;return o.notes?n.jsxs("div",{style:{position:"fixed",left:`${yl.x+10}px`,top:`${yl.y+10}px`,background:"rgba(0, 0, 0, 0.85)",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:"12px",lineHeight:"1.4",zIndex:1e4,pointerEvents:"none",width:"max-content",maxWidth:"400px",minWidth:"150px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)",wordWrap:"break-word",overflowWrap:"break-word"},children:[n.jsx("div",{style:{fontWeight:600,marginBottom:"4px"},children:"Test Point"}),n.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid rgba(255,255,255,0.2)",fontSize:"11px",color:"#d0d0d0",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:o.notes})]}):null})(),wi&&wi.visible&&(()=>{if(!yt.find(f=>f.id===wi.id))return null;const r=Ke.find(f=>f.id===wi.powerBusId);return n.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#fff",border:"1px solid #0b5fff",borderRadius:4,padding:"6px",boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"175px",maxWidth:"250px",maxHeight:"40vh",overflowY:"auto",pointerEvents:"auto"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"5px"},children:[n.jsx("h3",{style:{margin:0,fontSize:"12px",color:"#333",fontWeight:600},children:"Power Properties"}),n.jsx("button",{onClick:()=>Ko(null),style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#666",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Power Bus:"}),n.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:r?`${r.name} (${r.voltage})`:"Unknown"})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:`power-layer-${wi.id}`,style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Layer:"}),n.jsxs("select",{id:`power-layer-${wi.id}`,name:`power-layer-${wi.id}`,value:wi.layer,onChange:f=>Ko({...wi,layer:f.target.value}),disabled:wn,style:{width:"100%",padding:"2px 3px",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",opacity:wn?.6:1},children:[n.jsx("option",{value:"top",children:"Top"}),n.jsx("option",{value:"bottom",children:"Bottom"})]})]}),n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"X:"}),n.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:wi.x.toFixed(2)})]}),n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Y:"}),n.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:wi.y.toFixed(2)})]})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"3px",marginTop:"6px"},children:[n.jsx("button",{onClick:()=>Ko(null),style:{padding:"2px 5px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,cursor:"pointer",fontSize:"10px",color:"#333"},children:"Cancel"}),n.jsx("button",{onClick:()=>{wn||(oi(f=>f.map(m=>m.id===wi.id?{...m,layer:wi.layer}:m)),Ko(null))},disabled:wn,style:{padding:"2px 5px",background:wn?"#f5f5f5":"#0b5fff",color:wn?"#999":"#fff",border:"1px solid #ddd",borderRadius:2,cursor:wn?"not-allowed":"pointer",fontSize:"10px"},children:"Save"})]})]})})(),!g&&!R&&n.jsx("div",{className:"placeholder"})]})}),n.jsx(Dx,{visible:No,onClose:()=>Sl(!1),powerBuses:Ke,setPowerBuses:Mi,editingPowerBusId:Mo,setEditingPowerBusId:td,powers:yt}),n.jsx(Ax,{visible:In,onClose:()=>Wa(!1),groundBuses:Gt,setGroundBuses:Ol,editingGroundBusId:Sr,setEditingGroundBusId:wr,grounds:dt}),n.jsx(Px,{visible:mr,projectDirHandle:cn,onClose:()=>{Ia(!1),Bo(void 0)},onRestore:gu,position:ro,isDragging:gi,onDragStart:ef}),n.jsx(Nx,{visible:nd,onClose:()=>La(!1),autoAssignDesignators:Ns,setAutoAssignDesignators:Tr,useGlobalDesignatorCounters:Ms,setUseGlobalDesignatorCounters:wl}),n.jsx("input",{ref:Kc,type:"file",accept:".png,.jpg,.jpeg,image/png,image/jpeg",style:{display:"none"},onChange:o=>{const r=o.target.files?.[0];r&&ou(r,"top"),o.target.value=""}}),n.jsx("input",{ref:Jd,type:"file",accept:".png,.jpg,.jpeg,image/png,image/jpeg",style:{display:"none"},onChange:o=>{const r=o.target.files?.[0];r&&ou(r,"bottom"),o.target.value=""}}),n.jsx("input",{ref:ic,type:"file",accept:".json,application/json",style:{display:"none"},onChange:async o=>{const r=o.target.files?.[0];if(r)try{Un(r.name);const f=await r.text(),m=JSON.parse(f);await Gl(m);let y;m.projectInfo?.name?y=m.projectInfo.name:(y=r.name.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_")||"pcb_project",gl(y)),Zn||gl(y),setTimeout(()=>{Pi({visible:!0,source:"open",interval:5})},100)}catch(f){console.error("Failed to open project",f),alert("Failed to open project file. See console for details.")}o.target.value=""}}),n.jsx(vx,{visible:zs.visible,selectedIds:mt,selectedComponentIds:vt,selectedPowerIds:It,selectedGroundIds:jt,drawingStrokes:He,componentsTop:et,componentsBottom:rt,powers:yt,grounds:dt,powerBuses:Ke,onClose:()=>{ta({visible:!1,text:""})},setComponentsTop:Qt,setComponentsBottom:rn,determineViaType:Cl,determinePadType:An,determineTestPointType:Vn,onFindComponent:Eo,onFindStroke:Ct,onFindPower:nn,onFindGround:Wn,onOpenNotesDialog:()=>jl(!0),position:ti,isDragging:rc,onDragStart:o=>{ti&&(Us({x:o.clientX-ti.x,y:o.clientY-ti.y}),id(!0),o.preventDefault())}}),n.jsx(Sx,{visible:Ps,selectedIds:mt,selectedComponentIds:vt,selectedPowerIds:It,selectedGroundIds:jt,drawingStrokes:He,componentsTop:et,componentsBottom:rt,powers:yt,grounds:dt,powerBuses:Ke,onClose:()=>{jl(!1)},setComponentsTop:Qt,setComponentsBottom:rn,setDrawingStrokes:Pt,setPowerSymbols:oi,setGroundSymbols:qn,determineViaType:Cl,determinePadType:An,determineTestPointType:Vn,position:Po,isDragging:Oo,onDragStart:o=>{Po&&(cc({x:o.clientX-Po.x,y:o.clientY-Po.y}),ld(!0),o.preventDefault())}}),n.jsx(wx,{visible:uo,projectNotes:$a,setProjectNotes:Tl,onClose:()=>{ca(!1)},position:da,isDragging:Xa,onDragStart:o=>{da?(dc({x:o.clientX-da.x,y:o.clientY-da.y}),Ga(!0),o.preventDefault()):(Ya({x:o.clientX-300,y:o.clientY-200}),dc({x:300,y:200}),Ga(!0),o.preventDefault())}}),n.jsx(Bh,{visible:Qr.visible,title:"New Project",message:"You have unsaved changes. Do you want to save your project before creating a new one?",onYes:Dc,onNo:pu,onCancel:hu,yesButtonRef:oc}),n.jsx(Bh,{visible:ia.visible,title:"Open Project",message:"You have unsaved changes. Do you want to save your project before opening another one?",onYes:Wr,onNo:jd,onCancel:xu,yesButtonRef:Jc}),tn.visible&&n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10002},onClick:o=>{o.target===o.currentTarget&&md()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:o=>o.stopPropagation(),children:[n.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"New Project"}),n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Project Name:"}),n.jsx("input",{ref:ed,type:"text",value:tn.projectName,onChange:o=>{Na(r=>({...r,projectName:o.target.value}))},onKeyDown:o=>{o.key==="Enter"?(o.preventDefault(),bd()):o.key==="Escape"&&(o.preventDefault(),md())},style:{width:"100%",padding:"8px 12px",marginBottom:"8px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},placeholder:"e.g., my_pcb_project",autoFocus:!0}),tn.projectName&&(()=>{const o=tn.projectName.match(/[^a-zA-Z0-9_-]/g);if(o){const r=[...new Set(o)];return n.jsxs("div",{style:{marginBottom:"12px",padding:"6px 10px",background:"#3a1f1f",border:"1px solid #a44",borderRadius:4,fontSize:"12px",color:"#ffaaaa"},children:["Invalid characters: ",r.map(f=>`"${f}"`).join(", "),". Only letters, numbers, underscore (_), and hyphen (-) are allowed."]})}return null})(),n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Location:"}),n.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[n.jsx("input",{type:"text",value:tn.locationPath||"Not selected",readOnly:!0,style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:tn.locationPath?"#f2f2f2":"#888",fontSize:"14px",cursor:"not-allowed"},placeholder:"Select a location..."}),n.jsx("button",{onClick:fu,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500,whiteSpace:"nowrap"},children:"Browse..."})]}),tn.projectName&&tn.locationPath&&n.jsxs("div",{style:{marginBottom:"20px",padding:"8px 12px",background:"#1a1a1f",border:"1px solid #333",borderRadius:6,fontSize:"12px",color:"#aaa",fontFamily:"monospace"},children:[n.jsx("div",{style:{marginBottom:"4px",color:"#888"},children:"Project will be created at:"}),n.jsx("div",{style:{color:"#4CAF50"},children:(()=>{if(!tn.projectName||!tn.locationPath)return"";const r=tn.projectName.trim().replace(/[^a-zA-Z0-9_-]/g,"_")||"pcb_project",f=`${r}.json`;return tn.locationPath===r?`${tn.locationPath}/${f}`:`${tn.locationPath}/${r}/${f}`})()})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[n.jsx("button",{onClick:md,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),n.jsx("button",{onClick:bd,disabled:!tn.projectName.trim()||!tn.locationHandle,style:{padding:"8px 16px",background:!tn.projectName.trim()||!tn.locationHandle?"#555":"#4CAF50",color:"#fff",border:"1px solid "+(!tn.projectName.trim()||!tn.locationHandle?"#666":"#45a049"),borderRadius:6,cursor:!tn.projectName.trim()||!tn.locationHandle?"not-allowed":"pointer",fontSize:"14px",fontWeight:600,opacity:!tn.projectName.trim()||!tn.locationHandle?.6:1},children:"Create"})]})]})}),pn.visible&&n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10002},onClick:o=>{o.target===o.currentTarget&&Rc()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:o=>o.stopPropagation(),children:[n.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Save As"}),n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"File Name:"}),n.jsx("input",{ref:yr,type:"text",value:pn.filename,onChange:o=>{la(r=>({...r,filename:o.target.value}))},onKeyDown:o=>{o.key==="Enter"?(o.preventDefault(),ii()):o.key==="Escape"&&(o.preventDefault(),Rc())},style:{width:"100%",padding:"8px 12px",marginBottom:"8px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},placeholder:"e.g., my_project.json",autoFocus:!0}),n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Location:"}),n.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[n.jsx("input",{type:"text",value:pn.locationPath||"Not selected",readOnly:!0,style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:pn.locationPath?"#f2f2f2":"#888",fontSize:"14px",cursor:"not-allowed"},placeholder:"Select a location..."}),n.jsx("button",{onClick:Ln,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500,whiteSpace:"nowrap"},children:"Browse..."})]}),pn.filename&&pn.locationPath&&n.jsxs("div",{style:{marginBottom:"20px",padding:"8px 12px",background:"#1a1a1f",border:"1px solid #333",borderRadius:6,fontSize:"12px",color:"#aaa",fontFamily:"monospace"},children:[n.jsx("div",{style:{marginBottom:"4px",color:"#888"},children:"File will be saved at:"}),n.jsxs("div",{style:{color:"#4CAF50"},children:[pn.locationPath,"/",pn.filename.endsWith(".json")?pn.filename:`${pn.filename}.json`]})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[n.jsx("button",{onClick:Rc,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),n.jsx("button",{onClick:ii,disabled:!pn.filename.trim()||!pn.locationHandle,style:{padding:"8px 16px",background:!pn.filename.trim()||!pn.locationHandle?"#555":"#4CAF50",color:"#fff",border:"1px solid "+(!pn.filename.trim()||!pn.locationHandle?"#666":"#45a049"),borderRadius:6,cursor:!pn.filename.trim()||!pn.locationHandle?"not-allowed":"pointer",fontSize:"14px",fontWeight:600,opacity:!pn.filename.trim()||!pn.locationHandle?.6:1},children:"Save"})]})]})}),n.jsx(mx,{visible:Kr.visible,title:Kr.title,message:Kr.message,onClose:()=>Aa({visible:!1,title:"",message:""})}),n.jsx(jx,{visible:tu,dimensions:Os,onSave:o=>{Es(o)},onClose:()=>_s(!1)}),n.jsx(Tx,{visible:qu,onClose:()=>Rs(!1),topImage:g,bottomImage:R,selectedImageForTransform:Bt,setSelectedImageForTransform:Fi,transformMode:dl,setTransformMode:no,updateImageTransform:yc,resetImageTransform:pd,setCurrentTool:te,isGrayscale:se,setIsGrayscale:Be,areImagesLocked:Ui}),n.jsx(Cx,{visible:qc,onClose:()=>Zc(!1),topImage:g,bottomImage:R,setTopImage:d,setBottomImage:I,componentsTop:et,componentsBottom:rt,setComponentsTop:Qt,setComponentsBottom:rn,drawingStrokes:He,setDrawingStrokes:Pt,canvasRef:Sn,isBottomView:Zd,setIsBottomView:Jr,originalTopFlipX:Zu,setOriginalTopFlipX:Kd,originalBottomFlipX:Ku,setOriginalBottomFlipX:Qd,viewPan:kt,viewScale:Fe,contentBorder:5}),n.jsx(Mx,{visible:qr.visible,size:qr.size,onSizeChange:o=>Zr(r=>({...r,size:o})),onApply:hd,onCancel:()=>Zr({visible:!1,size:6})}),n.jsx(Bx,{visible:Gc.visible,interval:Gc.interval,onIntervalChange:o=>ea({visible:!0,interval:o}),onApply:()=>gd(Gc.interval,!1),onCancel:()=>ea({visible:!1,interval:5})}),n.jsx(Ux,{visible:Cs.visible,interval:Cs.interval,onIntervalChange:o=>Pi({...Cs,interval:o}),onEnable:()=>gd(Cs.interval,!0),onSkip:du}),n.jsx("div",{style:{position:"fixed",bottom:8,right:8,zIndex:100},children:n.jsxs("button",{onClick:()=>{window.open("https://github.com/sponsors/pgiacalo","_blank","noopener,noreferrer")},style:{display:"flex",alignItems:"center",gap:6,padding:"6px 12px",background:"linear-gradient(180deg, #f6f8fa 0%, #ebecef 100%)",border:"1px solid rgba(27, 31, 36, 0.15)",borderRadius:6,cursor:"pointer",fontSize:12,fontWeight:500,color:"#24292f",boxShadow:"0 1px 0 rgba(27, 31, 36, 0.04)",transition:"background 0.2s"},onMouseEnter:o=>{o.currentTarget.style.background="linear-gradient(180deg, #f3f4f6 0%, #e5e6e9 100%)"},onMouseLeave:o=>{o.currentTarget.style.background="linear-gradient(180deg, #f6f8fa 0%, #ebecef 100%)"},title:"Donate to support this project",children:[n.jsx("svg",{height:"16",width:"16",viewBox:"0 0 16 16",fill:"#bf3989","aria-hidden":"true",children:n.jsx("path",{d:"M4.25 2.5c-1.336 0-2.75 1.164-2.75 3 0 2.15 1.58 4.144 3.365 5.682A20.565 20.565 0 008 13.393a20.561 20.561 0 003.135-2.211C12.92 9.644 14.5 7.65 14.5 5.5c0-1.836-1.414-3-2.75-3-1.373 0-2.609.986-3.029 2.456a.749.749 0 01-1.442 0C6.859 3.486 5.623 2.5 4.25 2.5z"})}),"Donate"]})})]})}Lg.createRoot(document.getElementById("root")).render(n.jsx(b.StrictMode,{children:n.jsx(Kx,{})}));

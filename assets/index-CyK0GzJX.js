(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const D of document.querySelectorAll('link[rel="modulepreload"]'))d(D);new MutationObserver(D=>{for(const $ of D)if($.type==="childList")for(const Se of $.addedNodes)Se.tagName==="LINK"&&Se.rel==="modulepreload"&&d(Se)}).observe(document,{childList:!0,subtree:!0});function b(D){const $={};return D.integrity&&($.integrity=D.integrity),D.referrerPolicy&&($.referrerPolicy=D.referrerPolicy),D.crossOrigin==="use-credentials"?$.credentials="include":D.crossOrigin==="anonymous"?$.credentials="omit":$.credentials="same-origin",$}function d(D){if(D.ep)return;D.ep=!0;const $=b(D);fetch(D.href,$)}})();function Ag(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var kf={exports:{}},kd={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ph;function Ng(){if(ph)return kd;ph=1;var c=Symbol.for("react.transitional.element"),u=Symbol.for("react.fragment");function b(d,D,$){var Se=null;if($!==void 0&&(Se=""+$),D.key!==void 0&&(Se=""+D.key),"key"in D){$={};for(var ye in D)ye!=="key"&&($[ye]=D[ye])}else $=D;return D=$.ref,{$$typeof:c,type:d,key:Se,ref:D!==void 0?D:null,props:$}}return kd.Fragment=u,kd.jsx=b,kd.jsxs=b,kd}var hh;function Mg(){return hh||(hh=1,kf.exports=Ng()),kf.exports}var i=Mg(),Rf={exports:{}},Tt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gh;function Ug(){if(gh)return Tt;gh=1;var c=Symbol.for("react.transitional.element"),u=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),$=Symbol.for("react.consumer"),Se=Symbol.for("react.context"),ye=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),I=Symbol.for("react.memo"),ue=Symbol.for("react.lazy"),ve=Symbol.for("react.activity"),je=Symbol.iterator;function Ae(C){return C===null||typeof C!="object"?null:(C=je&&C[je]||C["@@iterator"],typeof C=="function"?C:null)}var le={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Me=Object.assign,Ie={};function ae(C,M,H){this.props=C,this.context=M,this.refs=Ie,this.updater=H||le}ae.prototype.isReactComponent={},ae.prototype.setState=function(C,M){if(typeof C!="object"&&typeof C!="function"&&C!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,C,M,"setState")},ae.prototype.forceUpdate=function(C){this.updater.enqueueForceUpdate(this,C,"forceUpdate")};function Fe(){}Fe.prototype=ae.prototype;function ge(C,M,H){this.props=C,this.context=M,this.refs=Ie,this.updater=H||le}var U=ge.prototype=new Fe;U.constructor=ge,Me(U,ae.prototype),U.isPureReactComponent=!0;var G=Array.isArray;function A(){}var R={H:null,A:null,T:null,S:null},z=Object.prototype.hasOwnProperty;function y(C,M,H){var he=H.ref;return{$$typeof:c,type:C,key:M,ref:he!==void 0?he:null,props:H}}function Q(C,M){return y(C.type,M,C.props)}function Re(C){return typeof C=="object"&&C!==null&&C.$$typeof===c}function Oe(C){var M={"=":"=0",":":"=2"};return"$"+C.replace(/[=:]/g,function(H){return M[H]})}var fe=/\/+/g;function Ee(C,M){return typeof C=="object"&&C!==null&&C.key!=null?Oe(""+C.key):M.toString(36)}function se(C){switch(C.status){case"fulfilled":return C.value;case"rejected":throw C.reason;default:switch(typeof C.status=="string"?C.then(A,A):(C.status="pending",C.then(function(M){C.status==="pending"&&(C.status="fulfilled",C.value=M)},function(M){C.status==="pending"&&(C.status="rejected",C.reason=M)})),C.status){case"fulfilled":return C.value;case"rejected":throw C.reason}}throw C}function _(C,M,H,he,We){var et=typeof C;(et==="undefined"||et==="boolean")&&(C=null);var it=!1;if(C===null)it=!0;else switch(et){case"bigint":case"string":case"number":it=!0;break;case"object":switch(C.$$typeof){case c:case u:it=!0;break;case ue:return it=C._init,_(it(C._payload),M,H,he,We)}}if(it)return We=We(C),it=he===""?"."+Ee(C,0):he,G(We)?(H="",it!=null&&(H=it.replace(fe,"$&/")+"/"),_(We,M,H,"",function(en){return en})):We!=null&&(Re(We)&&(We=Q(We,H+(We.key==null||C&&C.key===We.key?"":(""+We.key).replace(fe,"$&/")+"/")+it)),M.push(We)),1;it=0;var on=he===""?".":he+":";if(G(C))for(var ce=0;ce<C.length;ce++)he=C[ce],et=on+Ee(he,ce),it+=_(he,M,H,et,We);else if(ce=Ae(C),typeof ce=="function")for(C=ce.call(C),ce=0;!(he=C.next()).done;)he=he.value,et=on+Ee(he,ce++),it+=_(he,M,H,et,We);else if(et==="object"){if(typeof C.then=="function")return _(se(C),M,H,he,We);throw M=String(C),Error("Objects are not valid as a React child (found: "+(M==="[object Object]"?"object with keys {"+Object.keys(C).join(", ")+"}":M)+"). If you meant to render a collection of children, use an array instead.")}return it}function O(C,M,H){if(C==null)return C;var he=[],We=0;return _(C,he,"","",function(et){return M.call(H,et,We++)}),he}function W(C){if(C._status===-1){var M=C._result;M=M(),M.then(function(H){(C._status===0||C._status===-1)&&(C._status=1,C._result=H)},function(H){(C._status===0||C._status===-1)&&(C._status=2,C._result=H)}),C._status===-1&&(C._status=0,C._result=M)}if(C._status===1)return C._result.default;throw C._result}var Te=typeof reportError=="function"?reportError:function(C){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var M=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof C=="object"&&C!==null&&typeof C.message=="string"?String(C.message):String(C),error:C});if(!window.dispatchEvent(M))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",C);return}console.error(C)},F={map:O,forEach:function(C,M,H){O(C,function(){M.apply(this,arguments)},H)},count:function(C){var M=0;return O(C,function(){M++}),M},toArray:function(C){return O(C,function(M){return M})||[]},only:function(C){if(!Re(C))throw Error("React.Children.only expected to receive a single React element child.");return C}};return Tt.Activity=ve,Tt.Children=F,Tt.Component=ae,Tt.Fragment=b,Tt.Profiler=D,Tt.PureComponent=ge,Tt.StrictMode=d,Tt.Suspense=g,Tt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Tt.__COMPILER_RUNTIME={__proto__:null,c:function(C){return R.H.useMemoCache(C)}},Tt.cache=function(C){return function(){return C.apply(null,arguments)}},Tt.cacheSignal=function(){return null},Tt.cloneElement=function(C,M,H){if(C==null)throw Error("The argument must be a React element, but you passed "+C+".");var he=Me({},C.props),We=C.key;if(M!=null)for(et in M.key!==void 0&&(We=""+M.key),M)!z.call(M,et)||et==="key"||et==="__self"||et==="__source"||et==="ref"&&M.ref===void 0||(he[et]=M[et]);var et=arguments.length-2;if(et===1)he.children=H;else if(1<et){for(var it=Array(et),on=0;on<et;on++)it[on]=arguments[on+2];he.children=it}return y(C.type,We,he)},Tt.createContext=function(C){return C={$$typeof:Se,_currentValue:C,_currentValue2:C,_threadCount:0,Provider:null,Consumer:null},C.Provider=C,C.Consumer={$$typeof:$,_context:C},C},Tt.createElement=function(C,M,H){var he,We={},et=null;if(M!=null)for(he in M.key!==void 0&&(et=""+M.key),M)z.call(M,he)&&he!=="key"&&he!=="__self"&&he!=="__source"&&(We[he]=M[he]);var it=arguments.length-2;if(it===1)We.children=H;else if(1<it){for(var on=Array(it),ce=0;ce<it;ce++)on[ce]=arguments[ce+2];We.children=on}if(C&&C.defaultProps)for(he in it=C.defaultProps,it)We[he]===void 0&&(We[he]=it[he]);return y(C,et,We)},Tt.createRef=function(){return{current:null}},Tt.forwardRef=function(C){return{$$typeof:ye,render:C}},Tt.isValidElement=Re,Tt.lazy=function(C){return{$$typeof:ue,_payload:{_status:-1,_result:C},_init:W}},Tt.memo=function(C,M){return{$$typeof:I,type:C,compare:M===void 0?null:M}},Tt.startTransition=function(C){var M=R.T,H={};R.T=H;try{var he=C(),We=R.S;We!==null&&We(H,he),typeof he=="object"&&he!==null&&typeof he.then=="function"&&he.then(A,Te)}catch(et){Te(et)}finally{M!==null&&H.types!==null&&(M.types=H.types),R.T=M}},Tt.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},Tt.use=function(C){return R.H.use(C)},Tt.useActionState=function(C,M,H){return R.H.useActionState(C,M,H)},Tt.useCallback=function(C,M){return R.H.useCallback(C,M)},Tt.useContext=function(C){return R.H.useContext(C)},Tt.useDebugValue=function(){},Tt.useDeferredValue=function(C,M){return R.H.useDeferredValue(C,M)},Tt.useEffect=function(C,M){return R.H.useEffect(C,M)},Tt.useEffectEvent=function(C){return R.H.useEffectEvent(C)},Tt.useId=function(){return R.H.useId()},Tt.useImperativeHandle=function(C,M,H){return R.H.useImperativeHandle(C,M,H)},Tt.useInsertionEffect=function(C,M){return R.H.useInsertionEffect(C,M)},Tt.useLayoutEffect=function(C,M){return R.H.useLayoutEffect(C,M)},Tt.useMemo=function(C,M){return R.H.useMemo(C,M)},Tt.useOptimistic=function(C,M){return R.H.useOptimistic(C,M)},Tt.useReducer=function(C,M,H){return R.H.useReducer(C,M,H)},Tt.useRef=function(C){return R.H.useRef(C)},Tt.useState=function(C){return R.H.useState(C)},Tt.useSyncExternalStore=function(C,M,H){return R.H.useSyncExternalStore(C,M,H)},Tt.useTransition=function(){return R.H.useTransition()},Tt.version="19.2.0",Tt}var xh;function Ef(){return xh||(xh=1,Rf.exports=Ug()),Rf.exports}var w=Ef();const Pe=Ag(w);var Df={exports:{}},Rd={},Af={exports:{}},Nf={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yh;function Bg(){return yh||(yh=1,(function(c){function u(_,O){var W=_.length;_.push(O);e:for(;0<W;){var Te=W-1>>>1,F=_[Te];if(0<D(F,O))_[Te]=O,_[W]=F,W=Te;else break e}}function b(_){return _.length===0?null:_[0]}function d(_){if(_.length===0)return null;var O=_[0],W=_.pop();if(W!==O){_[0]=W;e:for(var Te=0,F=_.length,C=F>>>1;Te<C;){var M=2*(Te+1)-1,H=_[M],he=M+1,We=_[he];if(0>D(H,W))he<F&&0>D(We,H)?(_[Te]=We,_[he]=W,Te=he):(_[Te]=H,_[M]=W,Te=M);else if(he<F&&0>D(We,W))_[Te]=We,_[he]=W,Te=he;else break e}}return O}function D(_,O){var W=_.sortIndex-O.sortIndex;return W!==0?W:_.id-O.id}if(c.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var $=performance;c.unstable_now=function(){return $.now()}}else{var Se=Date,ye=Se.now();c.unstable_now=function(){return Se.now()-ye}}var g=[],I=[],ue=1,ve=null,je=3,Ae=!1,le=!1,Me=!1,Ie=!1,ae=typeof setTimeout=="function"?setTimeout:null,Fe=typeof clearTimeout=="function"?clearTimeout:null,ge=typeof setImmediate<"u"?setImmediate:null;function U(_){for(var O=b(I);O!==null;){if(O.callback===null)d(I);else if(O.startTime<=_)d(I),O.sortIndex=O.expirationTime,u(g,O);else break;O=b(I)}}function G(_){if(Me=!1,U(_),!le)if(b(g)!==null)le=!0,A||(A=!0,Oe());else{var O=b(I);O!==null&&se(G,O.startTime-_)}}var A=!1,R=-1,z=5,y=-1;function Q(){return Ie?!0:!(c.unstable_now()-y<z)}function Re(){if(Ie=!1,A){var _=c.unstable_now();y=_;var O=!0;try{e:{le=!1,Me&&(Me=!1,Fe(R),R=-1),Ae=!0;var W=je;try{t:{for(U(_),ve=b(g);ve!==null&&!(ve.expirationTime>_&&Q());){var Te=ve.callback;if(typeof Te=="function"){ve.callback=null,je=ve.priorityLevel;var F=Te(ve.expirationTime<=_);if(_=c.unstable_now(),typeof F=="function"){ve.callback=F,U(_),O=!0;break t}ve===b(g)&&d(g),U(_)}else d(g);ve=b(g)}if(ve!==null)O=!0;else{var C=b(I);C!==null&&se(G,C.startTime-_),O=!1}}break e}finally{ve=null,je=W,Ae=!1}O=void 0}}finally{O?Oe():A=!1}}}var Oe;if(typeof ge=="function")Oe=function(){ge(Re)};else if(typeof MessageChannel<"u"){var fe=new MessageChannel,Ee=fe.port2;fe.port1.onmessage=Re,Oe=function(){Ee.postMessage(null)}}else Oe=function(){ae(Re,0)};function se(_,O){R=ae(function(){_(c.unstable_now())},O)}c.unstable_IdlePriority=5,c.unstable_ImmediatePriority=1,c.unstable_LowPriority=4,c.unstable_NormalPriority=3,c.unstable_Profiling=null,c.unstable_UserBlockingPriority=2,c.unstable_cancelCallback=function(_){_.callback=null},c.unstable_forceFrameRate=function(_){0>_||125<_?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<_?Math.floor(1e3/_):5},c.unstable_getCurrentPriorityLevel=function(){return je},c.unstable_next=function(_){switch(je){case 1:case 2:case 3:var O=3;break;default:O=je}var W=je;je=O;try{return _()}finally{je=W}},c.unstable_requestPaint=function(){Ie=!0},c.unstable_runWithPriority=function(_,O){switch(_){case 1:case 2:case 3:case 4:case 5:break;default:_=3}var W=je;je=_;try{return O()}finally{je=W}},c.unstable_scheduleCallback=function(_,O,W){var Te=c.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?Te+W:Te):W=Te,_){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=W+F,_={id:ue++,callback:O,priorityLevel:_,startTime:W,expirationTime:F,sortIndex:-1},W>Te?(_.sortIndex=W,u(I,_),b(g)===null&&_===b(I)&&(Me?(Fe(R),R=-1):Me=!0,se(G,W-Te))):(_.sortIndex=F,u(g,_),le||Ae||(le=!0,A||(A=!0,Oe()))),_},c.unstable_shouldYield=Q,c.unstable_wrapCallback=function(_){var O=je;return function(){var W=je;je=O;try{return _.apply(this,arguments)}finally{je=W}}}})(Nf)),Nf}var bh;function Pg(){return bh||(bh=1,Af.exports=Bg()),Af.exports}var Mf={exports:{}},Li={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vh;function Og(){if(vh)return Li;vh=1;var c=Ef();function u(g){var I="https://react.dev/errors/"+g;if(1<arguments.length){I+="?args[]="+encodeURIComponent(arguments[1]);for(var ue=2;ue<arguments.length;ue++)I+="&args[]="+encodeURIComponent(arguments[ue])}return"Minified React error #"+g+"; visit "+I+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function b(){}var d={d:{f:b,r:function(){throw Error(u(522))},D:b,C:b,L:b,m:b,X:b,S:b,M:b},p:0,findDOMNode:null},D=Symbol.for("react.portal");function $(g,I,ue){var ve=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:D,key:ve==null?null:""+ve,children:g,containerInfo:I,implementation:ue}}var Se=c.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function ye(g,I){if(g==="font")return"";if(typeof I=="string")return I==="use-credentials"?I:""}return Li.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=d,Li.createPortal=function(g,I){var ue=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!I||I.nodeType!==1&&I.nodeType!==9&&I.nodeType!==11)throw Error(u(299));return $(g,I,null,ue)},Li.flushSync=function(g){var I=Se.T,ue=d.p;try{if(Se.T=null,d.p=2,g)return g()}finally{Se.T=I,d.p=ue,d.d.f()}},Li.preconnect=function(g,I){typeof g=="string"&&(I?(I=I.crossOrigin,I=typeof I=="string"?I==="use-credentials"?I:"":void 0):I=null,d.d.C(g,I))},Li.prefetchDNS=function(g){typeof g=="string"&&d.d.D(g)},Li.preinit=function(g,I){if(typeof g=="string"&&I&&typeof I.as=="string"){var ue=I.as,ve=ye(ue,I.crossOrigin),je=typeof I.integrity=="string"?I.integrity:void 0,Ae=typeof I.fetchPriority=="string"?I.fetchPriority:void 0;ue==="style"?d.d.S(g,typeof I.precedence=="string"?I.precedence:void 0,{crossOrigin:ve,integrity:je,fetchPriority:Ae}):ue==="script"&&d.d.X(g,{crossOrigin:ve,integrity:je,fetchPriority:Ae,nonce:typeof I.nonce=="string"?I.nonce:void 0})}},Li.preinitModule=function(g,I){if(typeof g=="string")if(typeof I=="object"&&I!==null){if(I.as==null||I.as==="script"){var ue=ye(I.as,I.crossOrigin);d.d.M(g,{crossOrigin:ue,integrity:typeof I.integrity=="string"?I.integrity:void 0,nonce:typeof I.nonce=="string"?I.nonce:void 0})}}else I==null&&d.d.M(g)},Li.preload=function(g,I){if(typeof g=="string"&&typeof I=="object"&&I!==null&&typeof I.as=="string"){var ue=I.as,ve=ye(ue,I.crossOrigin);d.d.L(g,ue,{crossOrigin:ve,integrity:typeof I.integrity=="string"?I.integrity:void 0,nonce:typeof I.nonce=="string"?I.nonce:void 0,type:typeof I.type=="string"?I.type:void 0,fetchPriority:typeof I.fetchPriority=="string"?I.fetchPriority:void 0,referrerPolicy:typeof I.referrerPolicy=="string"?I.referrerPolicy:void 0,imageSrcSet:typeof I.imageSrcSet=="string"?I.imageSrcSet:void 0,imageSizes:typeof I.imageSizes=="string"?I.imageSizes:void 0,media:typeof I.media=="string"?I.media:void 0})}},Li.preloadModule=function(g,I){if(typeof g=="string")if(I){var ue=ye(I.as,I.crossOrigin);d.d.m(g,{as:typeof I.as=="string"&&I.as!=="script"?I.as:void 0,crossOrigin:ue,integrity:typeof I.integrity=="string"?I.integrity:void 0})}else d.d.m(g)},Li.requestFormReset=function(g){d.d.r(g)},Li.unstable_batchedUpdates=function(g,I){return g(I)},Li.useFormState=function(g,I,ue){return Se.H.useFormState(g,I,ue)},Li.useFormStatus=function(){return Se.H.useHostTransitionStatus()},Li.version="19.2.0",Li}var mh;function _g(){if(mh)return Mf.exports;mh=1;function c(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(c)}catch(u){console.error(u)}}return c(),Mf.exports=Og(),Mf.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sh;function Hg(){if(Sh)return Rd;Sh=1;var c=Pg(),u=Ef(),b=_g();function d(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function D(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function $(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Se(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ye(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function g(e){if($(e)!==e)throw Error(d(188))}function I(e){var t=e.alternate;if(!t){if(t=$(e),t===null)throw Error(d(188));return t!==e?null:e}for(var n=e,l=t;;){var o=n.return;if(o===null)break;var s=o.alternate;if(s===null){if(l=o.return,l!==null){n=l;continue}break}if(o.child===s.child){for(s=o.child;s;){if(s===n)return g(o),e;if(s===l)return g(o),t;s=s.sibling}throw Error(d(188))}if(n.return!==l.return)n=o,l=s;else{for(var h=!1,j=o.child;j;){if(j===n){h=!0,n=o,l=s;break}if(j===l){h=!0,l=o,n=s;break}j=j.sibling}if(!h){for(j=s.child;j;){if(j===n){h=!0,n=s,l=o;break}if(j===l){h=!0,l=s,n=o;break}j=j.sibling}if(!h)throw Error(d(189))}}if(n.alternate!==l)throw Error(d(190))}if(n.tag!==3)throw Error(d(188));return n.stateNode.current===n?e:t}function ue(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=ue(e),t!==null)return t;e=e.sibling}return null}var ve=Object.assign,je=Symbol.for("react.element"),Ae=Symbol.for("react.transitional.element"),le=Symbol.for("react.portal"),Me=Symbol.for("react.fragment"),Ie=Symbol.for("react.strict_mode"),ae=Symbol.for("react.profiler"),Fe=Symbol.for("react.consumer"),ge=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),G=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),Q=Symbol.for("react.memo_cache_sentinel"),Re=Symbol.iterator;function Oe(e){return e===null||typeof e!="object"?null:(e=Re&&e[Re]||e["@@iterator"],typeof e=="function"?e:null)}var fe=Symbol.for("react.client.reference");function Ee(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===fe?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Me:return"Fragment";case ae:return"Profiler";case Ie:return"StrictMode";case G:return"Suspense";case A:return"SuspenseList";case y:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case le:return"Portal";case ge:return e.displayName||"Context";case Fe:return(e._context.displayName||"Context")+".Consumer";case U:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case R:return t=e.displayName||null,t!==null?t:Ee(e.type)||"Memo";case z:t=e._payload,e=e._init;try{return Ee(e(t))}catch{}}return null}var se=Array.isArray,_=u.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,O=b.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W={pending:!1,data:null,method:null,action:null},Te=[],F=-1;function C(e){return{current:e}}function M(e){0>F||(e.current=Te[F],Te[F]=null,F--)}function H(e,t){F++,Te[F]=e.current,e.current=t}var he=C(null),We=C(null),et=C(null),it=C(null);function on(e,t){switch(H(et,t),H(We,e),H(he,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Op(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Op(t),e=_p(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}M(he),H(he,e)}function ce(){M(he),M(We),M(et)}function en(e){e.memoizedState!==null&&H(it,e);var t=he.current,n=_p(t,e.type);t!==n&&(H(We,e),H(he,n))}function Hn(e){We.current===e&&(M(he),M(We)),it.current===e&&(M(it),Td._currentValue=W)}var El,Ni;function Mi(e){if(El===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);El=t&&t[1]||"",Ni=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+El+e+Ni}var Xn=!1;function Ui(e,t){if(!e||Xn)return"";Xn=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var l={DetermineComponentFrameRoot:function(){try{if(t){var we=function(){throw Error()};if(Object.defineProperty(we.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(we,[])}catch(de){var ie=de}Reflect.construct(e,[],we)}else{try{we.call()}catch(de){ie=de}e.call(we.prototype)}}else{try{throw Error()}catch(de){ie=de}(we=e())&&typeof we.catch=="function"&&we.catch(function(){})}}catch(de){if(de&&ie&&typeof de.stack=="string")return[de.stack,ie.stack]}return[null,null]}};l.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var o=Object.getOwnPropertyDescriptor(l.DetermineComponentFrameRoot,"name");o&&o.configurable&&Object.defineProperty(l.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=l.DetermineComponentFrameRoot(),h=s[0],j=s[1];if(h&&j){var P=h.split(`
`),ne=j.split(`
`);for(o=l=0;l<P.length&&!P[l].includes("DetermineComponentFrameRoot");)l++;for(;o<ne.length&&!ne[o].includes("DetermineComponentFrameRoot");)o++;if(l===P.length||o===ne.length)for(l=P.length-1,o=ne.length-1;1<=l&&0<=o&&P[l]!==ne[o];)o--;for(;1<=l&&0<=o;l--,o--)if(P[l]!==ne[o]){if(l!==1||o!==1)do if(l--,o--,0>o||P[l]!==ne[o]){var be=`
`+P[l].replace(" at new "," at ");return e.displayName&&be.includes("<anonymous>")&&(be=be.replace("<anonymous>",e.displayName)),be}while(1<=l&&0<=o);break}}}finally{Xn=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?Mi(n):""}function si(e,t){switch(e.tag){case 26:case 27:case 5:return Mi(e.type);case 16:return Mi("Lazy");case 13:return e.child!==t&&t!==null?Mi("Suspense Fallback"):Mi("Suspense");case 19:return Mi("SuspenseList");case 0:case 15:return Ui(e.type,!1);case 11:return Ui(e.type.render,!1);case 1:return Ui(e.type,!0);case 31:return Mi("Activity");default:return""}}function wl(e){try{var t="",n=null;do t+=si(e,n),n=e,e=e.return;while(e);return t}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}var bi=Object.prototype.hasOwnProperty,Tl=c.unstable_scheduleCallback,vi=c.unstable_cancelCallback,ha=c.unstable_shouldYield,us=c.unstable_requestPaint,mi=c.unstable_now,fs=c.unstable_getCurrentPriorityLevel,Vr=c.unstable_ImmediatePriority,qe=c.unstable_UserBlockingPriority,mt=c.unstable_NormalPriority,Hc=c.unstable_LowPriority,$e=c.unstable_IdlePriority,It=c.log,ga=c.unstable_setDisableYieldValue,Xi=null,pt=null;function hn(e){if(typeof It=="function"&&ga(e),pt&&typeof pt.setStrictMode=="function")try{pt.setStrictMode(Xi,e)}catch{}}var Rn=Math.clz32?Math.clz32:nl,jl=Math.log,De=Math.LN2;function nl(e){return e>>>=0,e===0?32:31-(jl(e)/De|0)|0}var ct=256,cn=262144,il=4194304;function Cl(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Vl(e,t,n){var l=e.pendingLanes;if(l===0)return 0;var o=0,s=e.suspendedLanes,h=e.pingedLanes;e=e.warmLanes;var j=l&134217727;return j!==0?(l=j&~s,l!==0?o=Cl(l):(h&=j,h!==0?o=Cl(h):n||(n=j&~e,n!==0&&(o=Cl(n))))):(j=l&~s,j!==0?o=Cl(j):h!==0?o=Cl(h):n||(n=l&~e,n!==0&&(o=Cl(n)))),o===0?0:t!==0&&t!==o&&(t&s)===0&&(s=o&-o,n=t&-t,s>=n||s===32&&(n&4194048)!==0)?t:o}function Ea(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function Ht(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xa(){var e=il;return il<<=1,(il&62914560)===0&&(il=4194304),e}function Va(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Gi(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function ps(e,t,n,l,o,s){var h=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var j=e.entanglements,P=e.expirationTimes,ne=e.hiddenUpdates;for(n=h&~n;0<n;){var be=31-Rn(n),we=1<<be;j[be]=0,P[be]=-1;var ie=ne[be];if(ie!==null)for(ne[be]=null,be=0;be<ie.length;be++){var de=ie[be];de!==null&&(de.lane&=-536870913)}n&=~we}l!==0&&qi(e,l,0),s!==0&&o===0&&e.tag!==0&&(e.suspendedLanes|=s&~(h&~t))}function qi(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var l=31-Rn(t);e.entangledLanes|=t,e.entanglements[l]=e.entanglements[l]|1073741824|n&261930}function Il(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var l=31-Rn(n),o=1<<l;o&t|e[l]&t&&(e[l]|=t),n&=~o}}function hs(e,t){var n=t&-t;return n=(n&42)!==0?1:ar(n),(n&(e.suspendedLanes|t))!==0?0:n}function ar(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Ve(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function ll(){var e=O.p;return e!==0?e:(e=window.event,e===void 0?32:oh(e.type))}function At(e,t){var n=O.p;try{return O.p=e,t()}finally{O.p=n}}var Tn=Math.random().toString(36).slice(2),Fn="__reactFiber$"+Tn,ri="__reactProps$"+Tn,Ia="__reactContainer$"+Tn,gs="__reactEvents$"+Tn,Bt="__reactListeners$"+Tn,Wa="__reactHandles$"+Tn,Zt="__reactResources$"+Tn,Wl="__reactMarker$"+Tn;function Xt(e){delete e[Fn],delete e[ri],delete e[gs],delete e[Bt],delete e[Wa]}function zl(e){var t=e[Fn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Ia]||n[Fn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=$p(e);e!==null;){if(n=e[Fn])return n;e=$p(e)}return t}e=n,n=e.parentNode}return null}function tn(e){if(e=e[Fn]||e[Ia]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function Fl(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(d(33))}function al(e){var t=e[Zt];return t||(t=e[Zt]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function jn(e){e[Wl]=!0}var Fa=new Set,$a={};function ya(e,t){Cn(e,t),Cn(e+"Capture",t)}function Cn(e,t){for($a[e]=t,e=0;e<t.length;e++)Fa.add(t[e])}var Ir=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),bt={},Wt={};function La(e){return bi.call(Wt,e)?!0:bi.call(bt,e)?!1:Ir.test(e)?Wt[e]=!0:(bt[e]=!0,!1)}function An(e,t,n){if(La(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var l=t.toLowerCase().slice(0,5);if(l!=="data-"&&l!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function gn(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function ol(e,t,n,l){if(l===null)e.removeAttribute(n);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+l)}}function xn(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Bi(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function or(e,t,n){var l=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var o=l.get,s=l.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(h){n=""+h,s.call(this,h)}}),Object.defineProperty(e,t,{enumerable:l.enumerable}),{getValue:function(){return n},setValue:function(h){n=""+h},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Jn(e){if(!e._valueTracker){var t=Bi(e)?"checked":"value";e._valueTracker=or(e,t,""+e[t])}}function xs(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),l="";return e&&(l=Bi(e)?e.checked?"true":"false":e.value),e=l,e!==n?(t.setValue(e),!0):!1}function zo(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Ya=/[\n"\\]/g;function Ne(e){return e.replace(Ya,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function $n(e,t,n,l,o,s,h,j){e.name="",h!=null&&typeof h!="function"&&typeof h!="symbol"&&typeof h!="boolean"?e.type=h:e.removeAttribute("type"),t!=null?h==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+xn(t)):e.value!==""+xn(t)&&(e.value=""+xn(t)):h!=="submit"&&h!=="reset"||e.removeAttribute("value"),t!=null?Wr(e,h,xn(t)):n!=null?Wr(e,h,xn(n)):l!=null&&e.removeAttribute("value"),o==null&&s!=null&&(e.defaultChecked=!!s),o!=null&&(e.checked=o&&typeof o!="function"&&typeof o!="symbol"),j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?e.name=""+xn(j):e.removeAttribute("name")}function ys(e,t,n,l,o,s,h,j){if(s!=null&&typeof s!="function"&&typeof s!="symbol"&&typeof s!="boolean"&&(e.type=s),t!=null||n!=null){if(!(s!=="submit"&&s!=="reset"||t!=null)){Jn(e);return}n=n!=null?""+xn(n):"",t=t!=null?""+xn(t):n,j||t===e.value||(e.value=t),e.defaultValue=t}l=l??o,l=typeof l!="function"&&typeof l!="symbol"&&!!l,e.checked=j?e.checked:!!l,e.defaultChecked=!!l,h!=null&&typeof h!="function"&&typeof h!="symbol"&&typeof h!="boolean"&&(e.name=h),Jn(e)}function Wr(e,t,n){t==="number"&&zo(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function ci(e,t,n,l){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&l&&(e[n].defaultSelected=!0)}else{for(n=""+xn(n),t=null,o=0;o<e.length;o++){if(e[o].value===n){e[o].selected=!0,l&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function Ec(e,t,n){if(t!=null&&(t=""+xn(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+xn(n):""}function Fr(e,t,n,l){if(t==null){if(l!=null){if(n!=null)throw Error(d(92));if(se(l)){if(1<l.length)throw Error(d(93));l=l[0]}n=l}n==null&&(n=""),t=n}n=xn(t),e.defaultValue=n,l=e.textContent,l===n&&l!==""&&l!==null&&(e.value=l),Jn(e)}function ko(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Vc=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ln(e,t,n){var l=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?l?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":l?e.setProperty(t,n):typeof n!="number"||n===0||Vc.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Bd(e,t,n){if(t!=null&&typeof t!="object")throw Error(d(62));if(e=e.style,n!=null){for(var l in n)!n.hasOwnProperty(l)||t!=null&&t.hasOwnProperty(l)||(l.indexOf("--")===0?e.setProperty(l,""):l==="float"?e.cssFloat="":e[l]="");for(var o in t)l=t[o],t.hasOwnProperty(o)&&n[o]!==l&&Ln(e,o,l)}else for(var s in t)t.hasOwnProperty(s)&&Ln(e,s,t[s])}function jt(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ct=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),$r=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ro(e){return $r.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function at(){}var St=null;function Ut(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ht=null,Nt=null;function zt(e){var t=tn(e);if(t&&(e=t.stateNode)){var n=e[ri]||null;e:switch(e=t.stateNode,t.type){case"input":if($n(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+Ne(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var l=n[t];if(l!==e&&l.form===e.form){var o=l[ri]||null;if(!o)throw Error(d(90));$n(l,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name)}}for(t=0;t<n.length;t++)l=n[t],l.form===e.form&&xs(l)}break e;case"textarea":Ec(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&ci(e,!!n.multiple,t,!1)}}}var Ic=!1;function kt(e,t,n){if(Ic)return e(t,n);Ic=!0;try{var l=e(t);return l}finally{if(Ic=!1,(ht!==null||Nt!==null)&&(au(),ht&&(t=ht,e=Nt,Nt=ht=null,zt(t),e)))for(t=0;t<e.length;t++)zt(e[t])}}function dn(e,t){var n=e.stateNode;if(n===null)return null;var l=n[ri]||null;if(l===null)return null;n=l[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(d(231,t,typeof n));return n}var gt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),zn=!1;if(gt)try{var $l={};Object.defineProperty($l,"passive",{get:function(){zn=!0}}),window.addEventListener("test",$l,$l),window.removeEventListener("test",$l,$l)}catch{zn=!1}var Ll=null,di=null,ba=null;function Yl(){if(ba)return ba;var e,t=di,n=t.length,l,o="value"in Ll?Ll.value:Ll.textContent,s=o.length;for(e=0;e<n&&t[e]===o[e];e++);var h=n-e;for(l=1;l<=h&&t[n-l]===o[s-l];l++);return ba=o.slice(e,1<l?1-l:void 0)}function va(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function bs(){return!0}function Wc(){return!1}function Gn(e){function t(n,l,o,s,h){this._reactName=n,this._targetInst=o,this.type=l,this.nativeEvent=s,this.target=h,this.currentTarget=null;for(var j in e)e.hasOwnProperty(j)&&(n=e[j],this[j]=n?n(s):s[j]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?bs:Wc,this.isPropagationStopped=Wc,this}return ve(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=bs)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=bs)},persist:function(){},isPersistent:bs}),t}var Xa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sr=Gn(Xa),rr=ve({},Xa,{view:0,detail:0}),ut=Gn(rr),ui,Yn,Pi,Lr=ve({},rr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ga,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Pi&&(Pi&&e.type==="mousemove"?(ui=e.screenX-Pi.screenX,Yn=e.screenY-Pi.screenY):Yn=ui=0,Pi=e),ui)},movementY:function(e){return"movementY"in e?e.movementY:Yn}}),Si=Gn(Lr),Au=ve({},Lr,{dataTransfer:0}),Zi=Gn(Au),Qi=ve({},rr,{relatedTarget:0}),ma=Gn(Qi),Nu=ve({},Xa,{animationName:0,elapsedTime:0,pseudoElement:0}),wi=Gn(Nu),Do=ve({},Xa,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),fi=Gn(Do),vs=ve({},Xa,{data:0}),Oi=Gn(vs),cr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sa={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Fc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pi(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Fc[e])?!!t[e]:!1}function Ga(){return pi}var _i=ve({},rr,{key:function(e){if(e.key){var t=cr[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=va(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Sa[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ga,charCode:function(e){return e.type==="keypress"?va(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?va(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),ms=Gn(_i),Hi=ve({},Lr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qa=Gn(Hi),Dn=ve({},rr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ga}),Ss=Gn(Dn),Mu=ve({},Xa,{propertyName:0,elapsedTime:0,pseudoElement:0}),Uu=Gn(Mu),dr=ve({},Lr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ao=Gn(dr),Za=ve({},Xa,{newState:0,oldState:0}),Yr=Gn(Za),Xl=[9,13,27,32],Qa=gt&&"CompositionEvent"in window,hi=null;gt&&"documentMode"in document&&(hi=document.documentMode);var ws=gt&&"TextEvent"in window&&!hi,Ka=gt&&(!Qa||hi&&8<hi&&11>=hi),Xr=" ",No=!1;function Gr(e,t){switch(e){case"keyup":return Xl.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ja(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var eo=!1;function Ts(e,t){switch(e){case"compositionend":return Ja(t);case"keypress":return t.which!==32?null:(No=!0,Xr);case"textInput":return e=t.data,e===Xr&&No?null:e;default:return null}}function nn(e,t){if(eo)return e==="compositionend"||!Qa&&Gr(e,t)?(e=Yl(),ba=di=Ll=null,eo=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ka&&t.locale!=="ko"?null:t.data;default:return null}}var Mo={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function yn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Mo[e.type]:t==="textarea"}function to(e,t,n,l){ht?Nt?Nt.push(l):Nt=[l]:ht=l,t=fu(t,"onChange"),0<t.length&&(n=new sr("onChange","change",null,n,l),e.push({event:n,listeners:t}))}var Uo=null,Gl=null;function Bu(e){Ap(e,0)}function js(e){var t=Fl(e);if(xs(t))return e}function Pd(e,t){if(e==="change")return t}var Ei=!1;if(gt){var Vi;if(gt){var wa="oninput"in document;if(!wa){var kl=document.createElement("div");kl.setAttribute("oninput","return;"),wa=typeof kl.oninput=="function"}Vi=wa}else Vi=!1;Ei=Vi&&(!document.documentMode||9<document.documentMode)}function Ta(){Uo&&(Uo.detachEvent("onpropertychange",ja),Gl=Uo=null)}function ja(e){if(e.propertyName==="value"&&js(Gl)){var t=[];to(t,Gl,e,Ut(e)),kt(Bu,t)}}function no(e,t,n){e==="focusin"?(Ta(),Uo=t,Gl=n,Uo.attachEvent("onpropertychange",ja)):e==="focusout"&&Ta()}function Rl(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return js(Gl)}function qr(e,t){if(e==="click")return js(t)}function Ii(e,t){if(e==="input"||e==="change")return js(t)}function qn(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Nn=typeof Object.is=="function"?Object.is:qn;function En(e,t){if(Nn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),l=Object.keys(t);if(n.length!==l.length)return!1;for(l=0;l<n.length;l++){var o=n[l];if(!bi.call(t,o)||!Nn(e[o],t[o]))return!1}return!0}function sl(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Od(e,t){var n=sl(e);e=0;for(var l;n;){if(n.nodeType===3){if(l=e+n.textContent.length,e<=t&&l>=t)return{node:n,offset:t-e};e=l}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=sl(n)}}function io(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?io(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function $c(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=zo(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=zo(e.document)}return t}function Cs(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var ln=gt&&"documentMode"in document&&11>=document.documentMode,Ti=null,ur=null,zs=null,Zr=!1;function Qr(e,t,n){var l=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Zr||Ti==null||Ti!==zo(l)||(l=Ti,"selectionStart"in l&&Cs(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),zs&&En(zs,l)||(zs=l,l=fu(ur,"onSelect"),0<l.length&&(t=new sr("onSelect","select",null,t,n),e.push({event:t,listeners:l}),t.target=Ti)))}function ql(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ca={animationend:ql("Animation","AnimationEnd"),animationiteration:ql("Animation","AnimationIteration"),animationstart:ql("Animation","AnimationStart"),transitionrun:ql("Transition","TransitionRun"),transitionstart:ql("Transition","TransitionStart"),transitioncancel:ql("Transition","TransitionCancel"),transitionend:ql("Transition","TransitionEnd")},Bo={},Lc={};gt&&(Lc=document.createElement("div").style,"AnimationEvent"in window||(delete Ca.animationend.animation,delete Ca.animationiteration.animation,delete Ca.animationstart.animation),"TransitionEvent"in window||delete Ca.transitionend.transition);function Ki(e){if(Bo[e])return Bo[e];if(!Ca[e])return e;var t=Ca[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Lc)return Bo[e]=t[n];return e}var ks=Ki("animationend"),lo=Ki("animationiteration"),Po=Ki("animationstart"),fr=Ki("transitionrun"),Kr=Ki("transitionstart"),pr=Ki("transitioncancel"),Oo=Ki("transitionend"),Yc=new Map,rl="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");rl.push("scrollEnd");function bn(e,t){Yc.set(e,t),ya(t,[e])}var _o=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},Ji=[],Zl=0,za=0;function Ho(){for(var e=Zl,t=za=Zl=0;t<e;){var n=Ji[t];Ji[t++]=null;var l=Ji[t];Ji[t++]=null;var o=Ji[t];Ji[t++]=null;var s=Ji[t];if(Ji[t++]=null,l!==null&&o!==null){var h=l.pending;h===null?o.next=o:(o.next=h.next,h.next=o),l.pending=o}s!==0&&hr(n,o,s)}}function ka(e,t,n,l){Ji[Zl++]=e,Ji[Zl++]=t,Ji[Zl++]=n,Ji[Zl++]=l,za|=l,e.lanes|=l,e=e.alternate,e!==null&&(e.lanes|=l)}function ao(e,t,n,l){return ka(e,t,n,l),gr(e)}function Eo(e,t){return ka(e,null,null,t),gr(e)}function hr(e,t,n){e.lanes|=n;var l=e.alternate;l!==null&&(l.lanes|=n);for(var o=!1,s=e.return;s!==null;)s.childLanes|=n,l=s.alternate,l!==null&&(l.childLanes|=n),s.tag===22&&(e=s.stateNode,e===null||e._visibility&1||(o=!0)),e=s,s=s.return;return e.tag===3?(s=e.stateNode,o&&t!==null&&(o=31-Rn(n),e=s.hiddenUpdates,l=e[o],l===null?e[o]=[t]:l.push(t),t.lane=n|536870912),s):null}function gr(e){if(50<xd)throw xd=0,Zu=null,Error(d(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Vo={};function Pu(e,t,n,l){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gi(e,t,n,l){return new Pu(e,t,n,l)}function xr(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ql(e,t){var n=e.alternate;return n===null?(n=gi(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Xc(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function yr(e,t,n,l,o,s){var h=0;if(l=e,typeof e=="function")xr(e)&&(h=1);else if(typeof e=="string")h=bg(e,n,he.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case y:return e=gi(31,n,t,o),e.elementType=y,e.lanes=s,e;case Me:return Kl(n.children,o,s,t);case Ie:h=8,o|=24;break;case ae:return e=gi(12,n,t,o|2),e.elementType=ae,e.lanes=s,e;case G:return e=gi(13,n,t,o),e.elementType=G,e.lanes=s,e;case A:return e=gi(19,n,t,o),e.elementType=A,e.lanes=s,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ge:h=10;break e;case Fe:h=9;break e;case U:h=11;break e;case R:h=14;break e;case z:h=16,l=null;break e}h=29,n=Error(d(130,e===null?"null":typeof e,"")),l=null}return t=gi(h,n,t,o),t.elementType=e,t.type=l,t.lanes=s,t}function Kl(e,t,n,l){return e=gi(7,e,l,t),e.lanes=n,e}function Jl(e,t,n){return e=gi(6,e,null,t),e.lanes=n,e}function br(e){var t=gi(18,null,null,0);return t.stateNode=e,t}function ea(e,t,n){return t=gi(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var ji=new WeakMap;function ei(e,t){if(typeof e=="object"&&e!==null){var n=ji.get(e);return n!==void 0?n:(t={value:e,source:t,stack:wl(t)},ji.set(e,t),t)}return{value:e,source:t,stack:wl(t)}}var ti=[],Dl=0,Ci=null,ta=0,Mn=[],ni=0,Zn=null,zi=1,ii="";function cl(e,t){ti[Dl++]=ta,ti[Dl++]=Ci,Ci=e,ta=t}function Ra(e,t,n){Mn[ni++]=zi,Mn[ni++]=ii,Mn[ni++]=Zn,Zn=e;var l=zi;e=ii;var o=32-Rn(l)-1;l&=~(1<<o),n+=1;var s=32-Rn(t)+o;if(30<s){var h=o-o%5;s=(l&(1<<h)-1).toString(32),l>>=h,o-=h,zi=1<<32-Rn(t)+o|n<<o|l,ii=s+e}else zi=1<<s|n<<o|l,ii=e}function Rs(e){e.return!==null&&(cl(e,1),Ra(e,1,0))}function dl(e){for(;e===Ci;)Ci=ti[--Dl],ti[Dl]=null,ta=ti[--Dl],ti[Dl]=null;for(;e===Zn;)Zn=Mn[--ni],Mn[ni]=null,ii=Mn[--ni],Mn[ni]=null,zi=Mn[--ni],Mn[ni]=null}function oo(e,t){Mn[ni++]=zi,Mn[ni++]=ii,Mn[ni++]=Zn,zi=t.id,ii=t.overflow,Zn=e}var un=null,Lt=null,wt=!1,el=null,Ke=!1,dt=Error(d(519));function so(e){var t=Error(d(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw co(ei(t,e)),dt}function Io(e){var t=e.stateNode,n=e.type,l=e.memoizedProps;switch(t[Fn]=e,t[ri]=l,n){case"dialog":Ot("cancel",t),Ot("close",t);break;case"iframe":case"object":case"embed":Ot("load",t);break;case"video":case"audio":for(n=0;n<bd.length;n++)Ot(bd[n],t);break;case"source":Ot("error",t);break;case"img":case"image":case"link":Ot("error",t),Ot("load",t);break;case"details":Ot("toggle",t);break;case"input":Ot("invalid",t),ys(t,l.value,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name,!0);break;case"select":Ot("invalid",t);break;case"textarea":Ot("invalid",t),Fr(t,l.value,l.defaultValue,l.children)}n=l.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||l.suppressHydrationWarning===!0||Bp(t.textContent,n)?(l.popover!=null&&(Ot("beforetoggle",t),Ot("toggle",t)),l.onScroll!=null&&Ot("scroll",t),l.onScrollEnd!=null&&Ot("scrollend",t),l.onClick!=null&&(t.onclick=at),t=!0):t=!1,t||so(e,!0)}function vr(e){for(un=e.return;un;)switch(un.tag){case 5:case 31:case 13:Ke=!1;return;case 27:case 3:Ke=!0;return;default:un=un.return}}function na(e){if(e!==un)return!1;if(!wt)return vr(e),wt=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||ff(e.type,e.memoizedProps)),n=!n),n&&Lt&&so(e),vr(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(d(317));Lt=Fp(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(d(317));Lt=Fp(e)}else t===27?(t=Lt,Js(e.type)?(e=yf,yf=null,Lt=e):Lt=t):Lt=un?ua(e.stateNode.nextSibling):null;return!0}function Da(){Lt=un=null,wt=!1}function ro(){var e=el;return e!==null&&(ml===null?ml=e:ml.push.apply(ml,e),el=null),e}function co(e){el===null?el=[e]:el.push(e)}var Ds=C(null),Wo=null,Wi=null;function ia(e,t,n){H(Ds,t._currentValue),t._currentValue=n}function Al(e){e._currentValue=Ds.current,M(Ds)}function mr(e,t,n){for(;e!==null;){var l=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,l!==null&&(l.childLanes|=t)):l!==null&&(l.childLanes&t)!==t&&(l.childLanes|=t),e===n)break;e=e.return}}function uo(e,t,n,l){var o=e.child;for(o!==null&&(o.return=e);o!==null;){var s=o.dependencies;if(s!==null){var h=o.child;s=s.firstContext;e:for(;s!==null;){var j=s;s=o;for(var P=0;P<t.length;P++)if(j.context===t[P]){s.lanes|=n,j=s.alternate,j!==null&&(j.lanes|=n),mr(s.return,n,e),l||(h=null);break e}s=j.next}}else if(o.tag===18){if(h=o.return,h===null)throw Error(d(341));h.lanes|=n,s=h.alternate,s!==null&&(s.lanes|=n),mr(h,n,e),h=null}else h=o.child;if(h!==null)h.return=o;else for(h=o;h!==null;){if(h===e){h=null;break}if(o=h.sibling,o!==null){o.return=h.return,h=o;break}h=h.return}o=h}}function Nl(e,t,n,l){e=null;for(var o=t,s=!1;o!==null;){if(!s){if((o.flags&524288)!==0)s=!0;else if((o.flags&262144)!==0)break}if(o.tag===10){var h=o.alternate;if(h===null)throw Error(d(387));if(h=h.memoizedProps,h!==null){var j=o.type;Nn(o.pendingProps.value,h.value)||(e!==null?e.push(j):e=[j])}}else if(o===it.current){if(h=o.alternate,h===null)throw Error(d(387));h.memoizedState.memoizedState!==o.memoizedState.memoizedState&&(e!==null?e.push(Td):e=[Td])}o=o.return}e!==null&&uo(t,e,n,l),t.flags|=262144}function Fo(e){for(e=e.firstContext;e!==null;){if(!Nn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function ul(e){Wo=e,Wi=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function On(e){return $o(Wo,e)}function Aa(e,t){return Wo===null&&ul(e),$o(e,t)}function $o(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},Wi===null){if(e===null)throw Error(d(308));Wi=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Wi=Wi.next=t;return n}var Ou=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,l){e.push(l)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},Sr=c.unstable_scheduleCallback,Lo=c.unstable_NormalPriority,an={$$typeof:ge,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function fo(){return{controller:new Ou,data:new Map,refCount:0}}function la(e){e.refCount--,e.refCount===0&&Sr(Lo,function(){e.controller.abort()})}var aa=null,Fi=0,oa=0,po=null;function _d(e,t){if(aa===null){var n=aa=[];Fi=0,oa=nf(),po={status:"pending",value:void 0,then:function(l){n.push(l)}}}return Fi++,t.then(wr,wr),t}function wr(){if(--Fi===0&&aa!==null){po!==null&&(po.status="fulfilled");var e=aa;aa=null,oa=0,po=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function Hd(e,t){var n=[],l={status:"pending",value:null,reason:null,then:function(o){n.push(o)}};return e.then(function(){l.status="fulfilled",l.value=t;for(var o=0;o<n.length;o++)(0,n[o])(t)},function(o){for(l.status="rejected",l.reason=o,o=0;o<n.length;o++)(0,n[o])(void 0)}),l}var Jr=_.S;_.S=function(e,t){lp=mi(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&_d(e,t),Jr!==null&&Jr(e,t)};var $i=C(null);function ho(){var e=$i.current;return e!==null?e:wn.pooledCache}function Yo(e,t){t===null?H($i,$i.current):H($i,t.pool)}function ec(){var e=ho();return e===null?null:{parent:an._currentValue,pool:e}}var Xo=Error(d(460)),As=Error(d(474)),Tr=Error(d(542)),go={then:function(){}};function Ns(e){return e=e.status,e==="fulfilled"||e==="rejected"}function tc(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(at,at),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,nc(e),e;default:if(typeof t.status=="string")t.then(at,at);else{if(e=wn,e!==null&&100<e.shellSuspendCounter)throw Error(d(482));e=t,e.status="pending",e.then(function(l){if(t.status==="pending"){var o=t;o.status="fulfilled",o.value=l}},function(l){if(t.status==="pending"){var o=t;o.status="rejected",o.reason=l}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,nc(e),e}throw fl=t,Xo}}function sa(e){try{var t=e._init;return t(e._payload)}catch(n){throw n!==null&&typeof n=="object"&&typeof n.then=="function"?(fl=n,Xo):n}}var fl=null;function Ms(){if(fl===null)throw Error(d(459));var e=fl;return fl=null,e}function nc(e){if(e===Xo||e===Tr)throw Error(d(483))}var xo=null,yo=0;function Us(e){var t=yo;return yo+=1,xo===null&&(xo=[]),tc(xo,e,t)}function jr(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Bs(e,t){throw t.$$typeof===je?Error(d(525)):(e=Object.prototype.toString.call(t),Error(d(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Ed(e){function t(X,V){if(e){var ee=X.deletions;ee===null?(X.deletions=[V],X.flags|=16):ee.push(V)}}function n(X,V){if(!e)return null;for(;V!==null;)t(X,V),V=V.sibling;return null}function l(X){for(var V=new Map;X!==null;)X.key!==null?V.set(X.key,X):V.set(X.index,X),X=X.sibling;return V}function o(X,V){return X=Ql(X,V),X.index=0,X.sibling=null,X}function s(X,V,ee){return X.index=ee,e?(ee=X.alternate,ee!==null?(ee=ee.index,ee<V?(X.flags|=67108866,V):ee):(X.flags|=67108866,V)):(X.flags|=1048576,V)}function h(X){return e&&X.alternate===null&&(X.flags|=67108866),X}function j(X,V,ee,me){return V===null||V.tag!==6?(V=Jl(ee,X.mode,me),V.return=X,V):(V=o(V,ee),V.return=X,V)}function P(X,V,ee,me){var lt=ee.type;return lt===Me?be(X,V,ee.props.children,me,ee.key):V!==null&&(V.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===z&&sa(lt)===V.type)?(V=o(V,ee.props),jr(V,ee),V.return=X,V):(V=yr(ee.type,ee.key,ee.props,null,X.mode,me),jr(V,ee),V.return=X,V)}function ne(X,V,ee,me){return V===null||V.tag!==4||V.stateNode.containerInfo!==ee.containerInfo||V.stateNode.implementation!==ee.implementation?(V=ea(ee,X.mode,me),V.return=X,V):(V=o(V,ee.children||[]),V.return=X,V)}function be(X,V,ee,me,lt){return V===null||V.tag!==7?(V=Kl(ee,X.mode,me,lt),V.return=X,V):(V=o(V,ee),V.return=X,V)}function we(X,V,ee){if(typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint")return V=Jl(""+V,X.mode,ee),V.return=X,V;if(typeof V=="object"&&V!==null){switch(V.$$typeof){case Ae:return ee=yr(V.type,V.key,V.props,null,X.mode,ee),jr(ee,V),ee.return=X,ee;case le:return V=ea(V,X.mode,ee),V.return=X,V;case z:return V=sa(V),we(X,V,ee)}if(se(V)||Oe(V))return V=Kl(V,X.mode,ee,null),V.return=X,V;if(typeof V.then=="function")return we(X,Us(V),ee);if(V.$$typeof===ge)return we(X,Aa(X,V),ee);Bs(X,V)}return null}function ie(X,V,ee,me){var lt=V!==null?V.key:null;if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return lt!==null?null:j(X,V,""+ee,me);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case Ae:return ee.key===lt?P(X,V,ee,me):null;case le:return ee.key===lt?ne(X,V,ee,me):null;case z:return ee=sa(ee),ie(X,V,ee,me)}if(se(ee)||Oe(ee))return lt!==null?null:be(X,V,ee,me,null);if(typeof ee.then=="function")return ie(X,V,Us(ee),me);if(ee.$$typeof===ge)return ie(X,V,Aa(X,ee),me);Bs(X,ee)}return null}function de(X,V,ee,me,lt){if(typeof me=="string"&&me!==""||typeof me=="number"||typeof me=="bigint")return X=X.get(ee)||null,j(V,X,""+me,lt);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case Ae:return X=X.get(me.key===null?ee:me.key)||null,P(V,X,me,lt);case le:return X=X.get(me.key===null?ee:me.key)||null,ne(V,X,me,lt);case z:return me=sa(me),de(X,V,ee,me,lt)}if(se(me)||Oe(me))return X=X.get(ee)||null,be(V,X,me,lt,null);if(typeof me.then=="function")return de(X,V,ee,Us(me),lt);if(me.$$typeof===ge)return de(X,V,ee,Aa(V,me),lt);Bs(V,me)}return null}function Ge(X,V,ee,me){for(var lt=null,Gt=null,Qe=V,Mt=V=0,Vt=null;Qe!==null&&Mt<ee.length;Mt++){Qe.index>Mt?(Vt=Qe,Qe=null):Vt=Qe.sibling;var qt=ie(X,Qe,ee[Mt],me);if(qt===null){Qe===null&&(Qe=Vt);break}e&&Qe&&qt.alternate===null&&t(X,Qe),V=s(qt,V,Mt),Gt===null?lt=qt:Gt.sibling=qt,Gt=qt,Qe=Vt}if(Mt===ee.length)return n(X,Qe),wt&&cl(X,Mt),lt;if(Qe===null){for(;Mt<ee.length;Mt++)Qe=we(X,ee[Mt],me),Qe!==null&&(V=s(Qe,V,Mt),Gt===null?lt=Qe:Gt.sibling=Qe,Gt=Qe);return wt&&cl(X,Mt),lt}for(Qe=l(Qe);Mt<ee.length;Mt++)Vt=de(Qe,X,Mt,ee[Mt],me),Vt!==null&&(e&&Vt.alternate!==null&&Qe.delete(Vt.key===null?Mt:Vt.key),V=s(Vt,V,Mt),Gt===null?lt=Vt:Gt.sibling=Vt,Gt=Vt);return e&&Qe.forEach(function(lr){return t(X,lr)}),wt&&cl(X,Mt),lt}function rt(X,V,ee,me){if(ee==null)throw Error(d(151));for(var lt=null,Gt=null,Qe=V,Mt=V=0,Vt=null,qt=ee.next();Qe!==null&&!qt.done;Mt++,qt=ee.next()){Qe.index>Mt?(Vt=Qe,Qe=null):Vt=Qe.sibling;var lr=ie(X,Qe,qt.value,me);if(lr===null){Qe===null&&(Qe=Vt);break}e&&Qe&&lr.alternate===null&&t(X,Qe),V=s(lr,V,Mt),Gt===null?lt=lr:Gt.sibling=lr,Gt=lr,Qe=Vt}if(qt.done)return n(X,Qe),wt&&cl(X,Mt),lt;if(Qe===null){for(;!qt.done;Mt++,qt=ee.next())qt=we(X,qt.value,me),qt!==null&&(V=s(qt,V,Mt),Gt===null?lt=qt:Gt.sibling=qt,Gt=qt);return wt&&cl(X,Mt),lt}for(Qe=l(Qe);!qt.done;Mt++,qt=ee.next())qt=de(Qe,X,Mt,qt.value,me),qt!==null&&(e&&qt.alternate!==null&&Qe.delete(qt.key===null?Mt:qt.key),V=s(qt,V,Mt),Gt===null?lt=qt:Gt.sibling=qt,Gt=qt);return e&&Qe.forEach(function(Dg){return t(X,Dg)}),wt&&cl(X,Mt),lt}function pn(X,V,ee,me){if(typeof ee=="object"&&ee!==null&&ee.type===Me&&ee.key===null&&(ee=ee.props.children),typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case Ae:e:{for(var lt=ee.key;V!==null;){if(V.key===lt){if(lt=ee.type,lt===Me){if(V.tag===7){n(X,V.sibling),me=o(V,ee.props.children),me.return=X,X=me;break e}}else if(V.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===z&&sa(lt)===V.type){n(X,V.sibling),me=o(V,ee.props),jr(me,ee),me.return=X,X=me;break e}n(X,V);break}else t(X,V);V=V.sibling}ee.type===Me?(me=Kl(ee.props.children,X.mode,me,ee.key),me.return=X,X=me):(me=yr(ee.type,ee.key,ee.props,null,X.mode,me),jr(me,ee),me.return=X,X=me)}return h(X);case le:e:{for(lt=ee.key;V!==null;){if(V.key===lt)if(V.tag===4&&V.stateNode.containerInfo===ee.containerInfo&&V.stateNode.implementation===ee.implementation){n(X,V.sibling),me=o(V,ee.children||[]),me.return=X,X=me;break e}else{n(X,V);break}else t(X,V);V=V.sibling}me=ea(ee,X.mode,me),me.return=X,X=me}return h(X);case z:return ee=sa(ee),pn(X,V,ee,me)}if(se(ee))return Ge(X,V,ee,me);if(Oe(ee)){if(lt=Oe(ee),typeof lt!="function")throw Error(d(150));return ee=lt.call(ee),rt(X,V,ee,me)}if(typeof ee.then=="function")return pn(X,V,Us(ee),me);if(ee.$$typeof===ge)return pn(X,V,Aa(X,ee),me);Bs(X,ee)}return typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint"?(ee=""+ee,V!==null&&V.tag===6?(n(X,V.sibling),me=o(V,ee),me.return=X,X=me):(n(X,V),me=Jl(ee,X.mode,me),me.return=X,X=me),h(X)):n(X,V)}return function(X,V,ee,me){try{yo=0;var lt=pn(X,V,ee,me);return xo=null,lt}catch(Qe){if(Qe===Xo||Qe===Tr)throw Qe;var Gt=gi(29,Qe,null,X.mode);return Gt.lanes=me,Gt.return=X,Gt}finally{}}}var ra=Ed(!0),Ml=Ed(!1),li=!1;function Ul(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Gc(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function bo(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function vo(e,t,n){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,(Jt&2)!==0){var o=l.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),l.pending=t,t=gr(e),hr(e,null,n),t}return ka(e,l,t,n),gr(e)}function Cr(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var l=t.lanes;l&=e.pendingLanes,n|=l,t.lanes=n,Il(e,n)}}function qc(e,t){var n=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,n===l)){var o=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var h={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};s===null?o=s=h:s=s.next=h,n=n.next}while(n!==null);s===null?o=s=t:s=s.next=t}else o=s=t;n={baseState:l.baseState,firstBaseUpdate:o,lastBaseUpdate:s,shared:l.shared,callbacks:l.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Zc=!1;function zr(){if(Zc){var e=po;if(e!==null)throw e}}function kr(e,t,n,l){Zc=!1;var o=e.updateQueue;li=!1;var s=o.firstBaseUpdate,h=o.lastBaseUpdate,j=o.shared.pending;if(j!==null){o.shared.pending=null;var P=j,ne=P.next;P.next=null,h===null?s=ne:h.next=ne,h=P;var be=e.alternate;be!==null&&(be=be.updateQueue,j=be.lastBaseUpdate,j!==h&&(j===null?be.firstBaseUpdate=ne:j.next=ne,be.lastBaseUpdate=P))}if(s!==null){var we=o.baseState;h=0,be=ne=P=null,j=s;do{var ie=j.lane&-536870913,de=ie!==j.lane;if(de?(Et&ie)===ie:(l&ie)===ie){ie!==0&&ie===oa&&(Zc=!0),be!==null&&(be=be.next={lane:0,tag:j.tag,payload:j.payload,callback:null,next:null});e:{var Ge=e,rt=j;ie=t;var pn=n;switch(rt.tag){case 1:if(Ge=rt.payload,typeof Ge=="function"){we=Ge.call(pn,we,ie);break e}we=Ge;break e;case 3:Ge.flags=Ge.flags&-65537|128;case 0:if(Ge=rt.payload,ie=typeof Ge=="function"?Ge.call(pn,we,ie):Ge,ie==null)break e;we=ve({},we,ie);break e;case 2:li=!0}}ie=j.callback,ie!==null&&(e.flags|=64,de&&(e.flags|=8192),de=o.callbacks,de===null?o.callbacks=[ie]:de.push(ie))}else de={lane:ie,tag:j.tag,payload:j.payload,callback:j.callback,next:null},be===null?(ne=be=de,P=we):be=be.next=de,h|=ie;if(j=j.next,j===null){if(j=o.shared.pending,j===null)break;de=j,j=de.next,de.next=null,o.lastBaseUpdate=de,o.shared.pending=null}}while(!0);be===null&&(P=we),o.baseState=P,o.firstBaseUpdate=ne,o.lastBaseUpdate=be,s===null&&(o.shared.lanes=0),Gs|=h,e.lanes=h,e.memoizedState=we}}function Vd(e,t){if(typeof e!="function")throw Error(d(191,e));e.call(t)}function Id(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)Vd(n[e],t)}var Ps=C(null),ic=C(0);function Wd(e,t){e=rs,H(ic,e),H(Ps,t),rs=e|t.baseLanes}function Go(){H(ic,rs),H(Ps,Ps.current)}function Na(){rs=ic.current,M(Ps),M(ic)}var Qn=C(null),ki=null;function tl(e){var t=e.alternate;H(kn,kn.current&1),H(Qn,e),ki===null&&(t===null||Ps.current!==null||t.memoizedState!==null)&&(ki=e)}function Rr(e){H(kn,kn.current),H(Qn,e),ki===null&&(ki=e)}function qo(e){e.tag===22?(H(kn,kn.current),H(Qn,e),ki===null&&(ki=e)):pl()}function pl(){H(kn,kn.current),H(Qn,Qn.current)}function ai(e){M(Qn),ki===e&&(ki=null),M(kn)}var kn=C(0);function Zo(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||gf(n)||xf(n)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var hl=0,st=null,Ft=null,vn=null,Ri=!1,mo=!1,Qo=!1,lc=0,Os=0,gl=null,ac=0;function mn(){throw Error(d(321))}function _s(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Nn(e[n],t[n]))return!1;return!0}function Dr(e,t,n,l,o,s){return hl=s,st=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,_.H=e===null||e.memoizedState===null?ns:Ls,Qo=!1,s=n(l,o),Qo=!1,mo&&(s=sc(t,n,l,o)),oc(e),s}function oc(e){_.H=Ba;var t=Ft!==null&&Ft.next!==null;if(hl=0,vn=Ft=st=null,Ri=!1,Os=0,gl=null,t)throw Error(d(300));e===null||v||(e=e.dependencies,e!==null&&Fo(e)&&(v=!0))}function sc(e,t,n,l){st=e;var o=0;do{if(mo&&(gl=null),Os=0,mo=!1,25<=o)throw Error(d(301));if(o+=1,vn=Ft=null,e.updateQueue!=null){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,s.memoCache!=null&&(s.memoCache.index=0)}_.H=Sc,s=t(n,l)}while(mo);return s}function _u(){var e=_.H,t=e.useState()[0];return t=typeof t.then=="function"?Ko(t):t,e=e.useState()[0],(Ft!==null?Ft.memoizedState:null)!==e&&(st.flags|=1024),t}function rc(){var e=lc!==0;return lc=0,e}function xl(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function cc(e){if(Ri){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Ri=!1}hl=0,vn=Ft=st=null,mo=!1,Os=lc=0,gl=null}function Vn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vn===null?st.memoizedState=vn=e:vn=vn.next=e,vn}function Un(){if(Ft===null){var e=st.alternate;e=e!==null?e.memoizedState:null}else e=Ft.next;var t=vn===null?st.memoizedState:vn.next;if(t!==null)vn=t,Ft=e;else{if(e===null)throw st.alternate===null?Error(d(467)):Error(d(310));Ft=e,e={memoizedState:Ft.memoizedState,baseState:Ft.baseState,baseQueue:Ft.baseQueue,queue:Ft.queue,next:null},vn===null?st.memoizedState=vn=e:vn=vn.next=e}return vn}function Bl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ko(e){var t=Os;return Os+=1,gl===null&&(gl=[]),e=tc(gl,e,t),t=st,(vn===null?t.memoizedState:vn.next)===null&&(t=t.alternate,_.H=t===null||t.memoizedState===null?ns:Ls),e}function Ar(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Ko(e);if(e.$$typeof===ge)return On(e)}throw Error(d(438,String(e)))}function Qc(e){var t=null,n=st.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var l=st.alternate;l!==null&&(l=l.updateQueue,l!==null&&(l=l.memoCache,l!=null&&(t={data:l.data.map(function(o){return o.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=Bl(),st.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),l=0;l<e;l++)n[l]=Q;return t.index++,n}function Ma(e,t){return typeof t=="function"?t(e):t}function dc(e){var t=Un();return Hs(t,Ft,e)}function Hs(e,t,n){var l=e.queue;if(l===null)throw Error(d(311));l.lastRenderedReducer=n;var o=e.baseQueue,s=l.pending;if(s!==null){if(o!==null){var h=o.next;o.next=s.next,s.next=h}t.baseQueue=o=s,l.pending=null}if(s=e.baseState,o===null)e.memoizedState=s;else{t=o.next;var j=h=null,P=null,ne=t,be=!1;do{var we=ne.lane&-536870913;if(we!==ne.lane?(Et&we)===we:(hl&we)===we){var ie=ne.revertLane;if(ie===0)P!==null&&(P=P.next={lane:0,revertLane:0,gesture:null,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null}),we===oa&&(be=!0);else if((hl&ie)===ie){ne=ne.next,ie===oa&&(be=!0);continue}else we={lane:0,revertLane:ne.revertLane,gesture:null,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},P===null?(j=P=we,h=s):P=P.next=we,st.lanes|=ie,Gs|=ie;we=ne.action,Qo&&n(s,we),s=ne.hasEagerState?ne.eagerState:n(s,we)}else ie={lane:we,revertLane:ne.revertLane,gesture:ne.gesture,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},P===null?(j=P=ie,h=s):P=P.next=ie,st.lanes|=we,Gs|=we;ne=ne.next}while(ne!==null&&ne!==t);if(P===null?h=s:P.next=j,!Nn(s,e.memoizedState)&&(v=!0,be&&(n=po,n!==null)))throw n;e.memoizedState=s,e.baseState=h,e.baseQueue=P,l.lastRenderedState=s}return o===null&&(l.lanes=0),[e.memoizedState,l.dispatch]}function uc(e){var t=Un(),n=t.queue;if(n===null)throw Error(d(311));n.lastRenderedReducer=e;var l=n.dispatch,o=n.pending,s=t.memoizedState;if(o!==null){n.pending=null;var h=o=o.next;do s=e(s,h.action),h=h.next;while(h!==o);Nn(s,t.memoizedState)||(v=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),n.lastRenderedState=s}return[s,l]}function Fd(e,t,n){var l=st,o=Un(),s=wt;if(s){if(n===void 0)throw Error(d(407));n=n()}else n=t();var h=!Nn((Ft||o).memoizedState,n);if(h&&(o.memoizedState=n,v=!0),o=o.queue,yc($d.bind(null,l,o,e),[e]),o.getSnapshot!==t||h||vn!==null&&vn.memoizedState.tag&1){if(l.flags|=2048,In(9,{destroy:void 0},Es.bind(null,l,o,n,t),null),wn===null)throw Error(d(349));s||(hl&127)!==0||Kc(l,t,n)}return n}function Kc(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=st.updateQueue,t===null?(t=Bl(),st.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Es(e,t,n,l){t.value=n,t.getSnapshot=l,fc(t)&&Jc(e)}function $d(e,t,n){return n(function(){fc(t)&&Jc(e)})}function fc(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Nn(e,n)}catch{return!0}}function Jc(e){var t=Eo(e,2);t!==null&&Sl(t,e,2)}function Nr(e){var t=Vn();if(typeof e=="function"){var n=e;if(e=n(),Qo){hn(!0);try{n()}finally{hn(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ma,lastRenderedState:e},t}function pc(e,t,n,l){return e.baseState=n,Hs(e,Ft,typeof l=="function"?l:Ma)}function Ld(e,t,n,l,o){if($s(e))throw Error(d(485));if(e=t.action,e!==null){var s={payload:o,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(h){s.listeners.push(h)}};_.T!==null?n(!0):s.isTransition=!1,l(s),n=t.pending,n===null?(s.next=t.pending=s,ed(t,s)):(s.next=n.next,t.pending=n.next=s)}}function ed(e,t){var n=t.action,l=t.payload,o=e.state;if(t.isTransition){var s=_.T,h={};_.T=h;try{var j=n(o,l),P=_.S;P!==null&&P(h,j),td(e,t,j)}catch(ne){Mr(e,t,ne)}finally{s!==null&&h.types!==null&&(s.types=h.types),_.T=s}}else try{s=n(o,l),td(e,t,s)}catch(ne){Mr(e,t,ne)}}function td(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(l){Vs(e,t,l)},function(l){return Mr(e,t,l)}):Vs(e,t,n)}function Vs(e,t,n){t.status="fulfilled",t.value=n,Is(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,ed(e,n)))}function Mr(e,t,n){var l=e.pending;if(e.pending=null,l!==null){l=l.next;do t.status="rejected",t.reason=n,Is(t),t=t.next;while(t!==l)}e.action=null}function Is(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Ur(e,t){return t}function So(e,t){if(wt){var n=wn.formState;if(n!==null){e:{var l=st;if(wt){if(Lt){t:{for(var o=Lt,s=Ke;o.nodeType!==8;){if(!s){o=null;break t}if(o=ua(o.nextSibling),o===null){o=null;break t}}s=o.data,o=s==="F!"||s==="F"?o:null}if(o){Lt=ua(o.nextSibling),l=o.data==="F!";break e}}so(l)}l=!1}l&&(t=n[0])}}return n=Vn(),n.memoizedState=n.baseState=t,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ur,lastRenderedState:t},n.queue=l,n=qd.bind(null,st,l),l.dispatch=n,l=Nr(!1),s=Or.bind(null,st,!1,l.queue),l=Vn(),o={state:t,dispatch:null,action:e,pending:null},l.queue=o,n=Ld.bind(null,st,o,s,n),o.dispatch=n,l.memoizedState=e,[t,n,!1]}function Jo(e){var t=Un();return hc(t,Ft,e)}function hc(e,t,n){if(t=Hs(e,t,Ur)[0],e=dc(Ma)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var l=Ko(t)}catch(h){throw h===Xo?Tr:h}else l=t;t=Un();var o=t.queue,s=o.dispatch;return n!==t.memoizedState&&(st.flags|=2048,In(9,{destroy:void 0},nd.bind(null,o,n),null)),[l,s,e]}function nd(e,t){e.action=t}function gc(e){var t=Un(),n=Ft;if(n!==null)return hc(t,n,e);Un(),t=t.memoizedState,n=Un();var l=n.queue.dispatch;return n.memoizedState=e,[t,l,!1]}function In(e,t,n,l){return e={tag:e,create:n,deps:l,inst:t,next:null},t=st.updateQueue,t===null&&(t=Bl(),st.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(l=n.next,n.next=e,e.next=l,t.lastEffect=e),e}function id(){return Un().memoizedState}function xc(e,t,n,l){var o=Vn();st.flags|=e,o.memoizedState=In(1|t,{destroy:void 0},n,l===void 0?null:l)}function Br(e,t,n,l){var o=Un();l=l===void 0?null:l;var s=o.memoizedState.inst;Ft!==null&&l!==null&&_s(l,Ft.memoizedState.deps)?o.memoizedState=In(t,s,n,l):(st.flags|=e,o.memoizedState=In(1|t,s,n,l))}function Yd(e,t){xc(8390656,8,e,t)}function yc(e,t){Br(2048,8,e,t)}function Xd(e){st.flags|=4;var t=st.updateQueue;if(t===null)t=Bl(),st.updateQueue=t,t.events=[e];else{var n=t.events;n===null?t.events=[e]:n.push(e)}}function Pr(e){var t=Un().memoizedState;return Xd({ref:t,nextImpl:e}),function(){if((Jt&2)!==0)throw Error(d(440));return t.impl.apply(void 0,arguments)}}function ca(e,t){return Br(4,2,e,t)}function ld(e,t){return Br(4,4,e,t)}function Ua(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Pl(e,t,n){n=n!=null?n.concat([e]):null,Br(4,4,Ua.bind(null,t,e),n)}function bc(){}function ad(e,t){var n=Un();t=t===void 0?null:t;var l=n.memoizedState;return t!==null&&_s(t,l[1])?l[0]:(n.memoizedState=[e,t],e)}function Di(e,t){var n=Un();t=t===void 0?null:t;var l=n.memoizedState;if(t!==null&&_s(t,l[1]))return l[0];if(l=e(),Qo){hn(!0);try{e()}finally{hn(!1)}}return n.memoizedState=[l,t],l}function wo(e,t,n){return n===void 0||(hl&1073741824)!==0&&(Et&261930)===0?e.memoizedState=t:(e.memoizedState=n,e=op(),st.lanes|=e,Gs|=e,n)}function To(e,t,n,l){return Nn(n,t)?n:Ps.current!==null?(e=wo(e,n,l),Nn(e,t)||(v=!0),e):(hl&42)===0||(hl&1073741824)!==0&&(Et&261930)===0?(v=!0,e.memoizedState=n):(e=op(),st.lanes|=e,Gs|=e,t)}function vc(e,t,n,l,o){var s=O.p;O.p=s!==0&&8>s?s:8;var h=_.T,j={};_.T=j,Or(e,!1,t,n);try{var P=o(),ne=_.S;if(ne!==null&&ne(j,P),P!==null&&typeof P=="object"&&typeof P.then=="function"){var be=Hd(P,l);Fs(e,t,be,Hl(e))}else Fs(e,t,l,Hl(e))}catch(we){Fs(e,t,{then:function(){},status:"rejected",reason:we},Hl())}finally{O.p=s,h!==null&&j.types!==null&&(h.types=j.types),_.T=h}}function od(){}function es(e,t,n,l){if(e.tag!==5)throw Error(d(476));var o=Ws(e).queue;vc(e,o,t,W,n===null?od:function(){return mc(e),n(l)})}function Ws(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:W,baseState:W,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ma,lastRenderedState:W},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ma,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function mc(e){var t=Ws(e);t.next===null&&(t=e.alternate.memoizedState),Fs(e,t.next.queue,{},Hl())}function ts(){return On(Td)}function Gd(){return Un().memoizedState}function sd(){return Un().memoizedState}function rd(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=Hl();e=bo(n);var l=vo(t,e,n);l!==null&&(Sl(l,t,n),Cr(l,t,n)),t={cache:fo()},e.payload=t;return}t=t.return}}function Hu(e,t,n){var l=Hl();n={lane:l,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},$s(e)?Zd(t,n):(n=ao(e,t,n,l),n!==null&&(Sl(n,e,l),cd(n,t,l)))}function qd(e,t,n){var l=Hl();Fs(e,t,n,l)}function Fs(e,t,n,l){var o={lane:l,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if($s(e))Zd(t,o);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var h=t.lastRenderedState,j=s(h,n);if(o.hasEagerState=!0,o.eagerState=j,Nn(j,h))return ka(e,t,o,0),wn===null&&Ho(),!1}catch{}finally{}if(n=ao(e,t,o,l),n!==null)return Sl(n,e,l),cd(n,t,l),!0}return!1}function Or(e,t,n,l){if(l={lane:2,revertLane:nf(),gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},$s(e)){if(t)throw Error(d(479))}else t=ao(e,n,l,2),t!==null&&Sl(t,e,2)}function $s(e){var t=e.alternate;return e===st||t!==null&&t===st}function Zd(e,t){mo=Ri=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function cd(e,t,n){if((n&4194048)!==0){var l=t.lanes;l&=e.pendingLanes,n|=l,t.lanes=n,Il(e,n)}}var Ba={readContext:On,use:Ar,useCallback:mn,useContext:mn,useEffect:mn,useImperativeHandle:mn,useLayoutEffect:mn,useInsertionEffect:mn,useMemo:mn,useReducer:mn,useRef:mn,useState:mn,useDebugValue:mn,useDeferredValue:mn,useTransition:mn,useSyncExternalStore:mn,useId:mn,useHostTransitionStatus:mn,useFormState:mn,useActionState:mn,useOptimistic:mn,useMemoCache:mn,useCacheRefresh:mn};Ba.useEffectEvent=mn;var ns={readContext:On,use:Ar,useCallback:function(e,t){return Vn().memoizedState=[e,t===void 0?null:t],e},useContext:On,useEffect:Yd,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,xc(4194308,4,Ua.bind(null,t,e),n)},useLayoutEffect:function(e,t){return xc(4194308,4,e,t)},useInsertionEffect:function(e,t){xc(4,2,e,t)},useMemo:function(e,t){var n=Vn();t=t===void 0?null:t;var l=e();if(Qo){hn(!0);try{e()}finally{hn(!1)}}return n.memoizedState=[l,t],l},useReducer:function(e,t,n){var l=Vn();if(n!==void 0){var o=n(t);if(Qo){hn(!0);try{n(t)}finally{hn(!1)}}}else o=t;return l.memoizedState=l.baseState=o,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:o},l.queue=e,e=e.dispatch=Hu.bind(null,st,e),[l.memoizedState,e]},useRef:function(e){var t=Vn();return e={current:e},t.memoizedState=e},useState:function(e){e=Nr(e);var t=e.queue,n=qd.bind(null,st,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:bc,useDeferredValue:function(e,t){var n=Vn();return wo(n,e,t)},useTransition:function(){var e=Nr(!1);return e=vc.bind(null,st,e.queue,!0,!1),Vn().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var l=st,o=Vn();if(wt){if(n===void 0)throw Error(d(407));n=n()}else{if(n=t(),wn===null)throw Error(d(349));(Et&127)!==0||Kc(l,t,n)}o.memoizedState=n;var s={value:n,getSnapshot:t};return o.queue=s,Yd($d.bind(null,l,s,e),[e]),l.flags|=2048,In(9,{destroy:void 0},Es.bind(null,l,s,n,t),null),n},useId:function(){var e=Vn(),t=wn.identifierPrefix;if(wt){var n=ii,l=zi;n=(l&~(1<<32-Rn(l)-1)).toString(32)+n,t="_"+t+"R_"+n,n=lc++,0<n&&(t+="H"+n.toString(32)),t+="_"}else n=ac++,t="_"+t+"r_"+n.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:ts,useFormState:So,useActionState:So,useOptimistic:function(e){var t=Vn();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Or.bind(null,st,!0,n),n.dispatch=t,[e,t]},useMemoCache:Qc,useCacheRefresh:function(){return Vn().memoizedState=rd.bind(null,st)},useEffectEvent:function(e){var t=Vn(),n={impl:e};return t.memoizedState=n,function(){if((Jt&2)!==0)throw Error(d(440));return n.impl.apply(void 0,arguments)}}},Ls={readContext:On,use:Ar,useCallback:ad,useContext:On,useEffect:yc,useImperativeHandle:Pl,useInsertionEffect:ca,useLayoutEffect:ld,useMemo:Di,useReducer:dc,useRef:id,useState:function(){return dc(Ma)},useDebugValue:bc,useDeferredValue:function(e,t){var n=Un();return To(n,Ft.memoizedState,e,t)},useTransition:function(){var e=dc(Ma)[0],t=Un().memoizedState;return[typeof e=="boolean"?e:Ko(e),t]},useSyncExternalStore:Fd,useId:Gd,useHostTransitionStatus:ts,useFormState:Jo,useActionState:Jo,useOptimistic:function(e,t){var n=Un();return pc(n,Ft,e,t)},useMemoCache:Qc,useCacheRefresh:sd};Ls.useEffectEvent=Pr;var Sc={readContext:On,use:Ar,useCallback:ad,useContext:On,useEffect:yc,useImperativeHandle:Pl,useInsertionEffect:ca,useLayoutEffect:ld,useMemo:Di,useReducer:uc,useRef:id,useState:function(){return uc(Ma)},useDebugValue:bc,useDeferredValue:function(e,t){var n=Un();return Ft===null?wo(n,e,t):To(n,Ft.memoizedState,e,t)},useTransition:function(){var e=uc(Ma)[0],t=Un().memoizedState;return[typeof e=="boolean"?e:Ko(e),t]},useSyncExternalStore:Fd,useId:Gd,useHostTransitionStatus:ts,useFormState:gc,useActionState:gc,useOptimistic:function(e,t){var n=Un();return Ft!==null?pc(n,Ft,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:Qc,useCacheRefresh:sd};Sc.useEffectEvent=Pr;function _r(e,t,n,l){t=e.memoizedState,n=n(l,t),n=n==null?t:ve({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var wc={enqueueSetState:function(e,t,n){e=e._reactInternals;var l=Hl(),o=bo(l);o.payload=t,n!=null&&(o.callback=n),t=vo(e,o,l),t!==null&&(Sl(t,e,l),Cr(t,e,l))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var l=Hl(),o=bo(l);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=vo(e,o,l),t!==null&&(Sl(t,e,l),Cr(t,e,l))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Hl(),l=bo(n);l.tag=2,t!=null&&(l.callback=t),t=vo(e,l,n),t!==null&&(Sl(t,e,n),Cr(t,e,n))}};function tt(e,t,n,l,o,s,h){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,s,h):t.prototype&&t.prototype.isPureReactComponent?!En(n,l)||!En(o,s):!0}function is(e,t,n,l){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,l),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,l),t.state!==e&&wc.enqueueReplaceState(t,t.state,null)}function Pa(e,t){var n=t;if("ref"in t){n={};for(var l in t)l!=="ref"&&(n[l]=t[l])}if(e=e.defaultProps){n===t&&(n=ve({},n));for(var o in e)n[o]===void 0&&(n[o]=e[o])}return n}function Qd(e){_o(e)}function dd(e){console.error(e)}function Kd(e){_o(e)}function a(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(l){setTimeout(function(){throw l})}}function r(e,t,n){try{var l=e.onCaughtError;l(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(o){setTimeout(function(){throw o})}}function f(e,t,n){return n=bo(n),n.tag=3,n.payload={element:null},n.callback=function(){a(e,t)},n}function m(e){return e=bo(e),e.tag=3,e}function x(e,t,n,l){var o=n.type.getDerivedStateFromError;if(typeof o=="function"){var s=l.value;e.payload=function(){return o(s)},e.callback=function(){r(t,n,l)}}var h=n.stateNode;h!==null&&typeof h.componentDidCatch=="function"&&(e.callback=function(){r(t,n,l),typeof o!="function"&&(qs===null?qs=new Set([this]):qs.add(this));var j=l.stack;this.componentDidCatch(l.value,{componentStack:j!==null?j:""})})}function S(e,t,n,l,o){if(n.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){if(t=n.alternate,t!==null&&Nl(t,n,o,!0),n=Qn.current,n!==null){switch(n.tag){case 31:case 13:return ki===null?ou():n.alternate===null&&Wn===0&&(Wn=3),n.flags&=-257,n.flags|=65536,n.lanes=o,l===go?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([l]):t.add(l),Ju(e,l,o)),!1;case 22:return n.flags|=65536,l===go?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([l])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([l]):n.add(l)),Ju(e,l,o)),!1}throw Error(d(435,n.tag))}return Ju(e,l,o),ou(),!1}if(wt)return t=Qn.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=o,l!==dt&&(e=Error(d(422),{cause:l}),co(ei(e,n)))):(l!==dt&&(t=Error(d(423),{cause:l}),co(ei(t,n))),e=e.current.alternate,e.flags|=65536,o&=-o,e.lanes|=o,l=ei(l,n),o=f(e.stateNode,l,o),qc(e,o),Wn!==4&&(Wn=2)),!1;var s=Error(d(520),{cause:l});if(s=ei(s,n),gd===null?gd=[s]:gd.push(s),Wn!==4&&(Wn=2),t===null)return!0;l=ei(l,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=o&-o,n.lanes|=e,e=f(n.stateNode,l,e),qc(n,e),!1;case 1:if(t=n.type,s=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||s!==null&&typeof s.componentDidCatch=="function"&&(qs===null||!qs.has(s))))return n.flags|=65536,o&=-o,n.lanes|=o,o=m(o),x(o,e,n,l),qc(n,o),!1}n=n.return}while(n!==null);return!1}var p=Error(d(461)),v=!1;function T(e,t,n,l){t.child=e===null?Ml(t,null,n,l):ra(t,e.child,n,l)}function k(e,t,n,l,o){n=n.render;var s=t.ref;if("ref"in l){var h={};for(var j in l)j!=="ref"&&(h[j]=l[j])}else h=l;return ul(t),l=Dr(e,t,n,h,s,o),j=rc(),e!==null&&!v?(xl(e,t,o),Xe(e,t,o)):(wt&&j&&Rs(t),t.flags|=1,T(e,t,l,o),t.child)}function N(e,t,n,l,o){if(e===null){var s=n.type;return typeof s=="function"&&!xr(s)&&s.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=s,Z(e,t,s,l,o)):(e=yr(n.type,null,l,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!xt(e,o)){var h=s.memoizedProps;if(n=n.compare,n=n!==null?n:En,n(h,l)&&e.ref===t.ref)return Xe(e,t,o)}return t.flags|=1,e=Ql(s,l),e.ref=t.ref,e.return=t,t.child=e}function Z(e,t,n,l,o){if(e!==null){var s=e.memoizedProps;if(En(s,l)&&e.ref===t.ref)if(v=!1,t.pendingProps=l=s,xt(e,o))(e.flags&131072)!==0&&(v=!0);else return t.lanes=e.lanes,Xe(e,t,o)}return Ce(e,t,n,l,o)}function re(e,t,n,l){var o=l.children,s=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.mode==="hidden"){if((t.flags&128)!==0){if(s=s!==null?s.baseLanes|n:n,e!==null){for(l=t.child=e.child,o=0;l!==null;)o=o|l.lanes|l.childLanes,l=l.sibling;l=o&~s}else l=0,t.child=null;return J(e,t,s,n,l)}if((n&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Yo(t,s!==null?s.cachePool:null),s!==null?Wd(t,s):Go(),qo(t);else return l=t.lanes=536870912,J(e,t,s!==null?s.baseLanes|n:n,n,l)}else s!==null?(Yo(t,s.cachePool),Wd(t,s),pl(),t.memoizedState=null):(e!==null&&Yo(t,null),Go(),pl());return T(e,t,o,n),t.child}function Y(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function J(e,t,n,l,o){var s=ho();return s=s===null?null:{parent:an._currentValue,pool:s},t.memoizedState={baseLanes:n,cachePool:s},e!==null&&Yo(t,null),Go(),qo(t),e!==null&&Nl(e,t,l,!0),t.childLanes=o,null}function L(e,t){return t=ke({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function K(e,t,n){return ra(t,e.child,null,n),e=L(t,t.pendingProps),e.flags|=2,ai(t),t.memoizedState=null,e}function q(e,t,n){var l=t.pendingProps,o=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(wt){if(l.mode==="hidden")return e=L(t,l),t.lanes=536870912,Y(null,e);if(Rr(t),(e=Lt)?(e=Wp(e,Ke),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Zn!==null?{id:zi,overflow:ii}:null,retryLane:536870912,hydrationErrors:null},n=br(e),n.return=t,t.child=n,un=t,Lt=null)):e=null,e===null)throw so(t);return t.lanes=536870912,null}return L(t,l)}var s=e.memoizedState;if(s!==null){var h=s.dehydrated;if(Rr(t),o)if(t.flags&256)t.flags&=-257,t=K(e,t,n);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(d(558));else if(v||Nl(e,t,n,!1),o=(n&e.childLanes)!==0,v||o){if(l=wn,l!==null&&(h=hs(l,n),h!==0&&h!==s.retryLane))throw s.retryLane=h,Eo(e,h),Sl(l,e,h),p;ou(),t=K(e,t,n)}else e=s.treeContext,Lt=ua(h.nextSibling),un=t,wt=!0,el=null,Ke=!1,e!==null&&oo(t,e),t=L(t,l),t.flags|=4096;return t}return e=Ql(e.child,{mode:l.mode,children:l.children}),e.ref=t.ref,t.child=e,e.return=t,e}function xe(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(d(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function Ce(e,t,n,l,o){return ul(t),n=Dr(e,t,n,l,void 0,o),l=rc(),e!==null&&!v?(xl(e,t,o),Xe(e,t,o)):(wt&&l&&Rs(t),t.flags|=1,T(e,t,n,o),t.child)}function ze(e,t,n,l,o,s){return ul(t),t.updateQueue=null,n=sc(t,l,n,o),oc(e),l=rc(),e!==null&&!v?(xl(e,t,s),Xe(e,t,s)):(wt&&l&&Rs(t),t.flags|=1,T(e,t,n,s),t.child)}function oe(e,t,n,l,o){if(ul(t),t.stateNode===null){var s=Vo,h=n.contextType;typeof h=="object"&&h!==null&&(s=On(h)),s=new n(l,s),t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=wc,t.stateNode=s,s._reactInternals=t,s=t.stateNode,s.props=l,s.state=t.memoizedState,s.refs={},Ul(t),h=n.contextType,s.context=typeof h=="object"&&h!==null?On(h):Vo,s.state=t.memoizedState,h=n.getDerivedStateFromProps,typeof h=="function"&&(_r(t,n,h,l),s.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(h=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),h!==s.state&&wc.enqueueReplaceState(s,s.state,null),kr(t,l,s,o),zr(),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308),l=!0}else if(e===null){s=t.stateNode;var j=t.memoizedProps,P=Pa(n,j);s.props=P;var ne=s.context,be=n.contextType;h=Vo,typeof be=="object"&&be!==null&&(h=On(be));var we=n.getDerivedStateFromProps;be=typeof we=="function"||typeof s.getSnapshotBeforeUpdate=="function",j=t.pendingProps!==j,be||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(j||ne!==h)&&is(t,s,l,h),li=!1;var ie=t.memoizedState;s.state=ie,kr(t,l,s,o),zr(),ne=t.memoizedState,j||ie!==ne||li?(typeof we=="function"&&(_r(t,n,we,l),ne=t.memoizedState),(P=li||tt(t,n,P,l,ie,ne,h))?(be||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=l,t.memoizedState=ne),s.props=l,s.state=ne,s.context=h,l=P):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),l=!1)}else{s=t.stateNode,Gc(e,t),h=t.memoizedProps,be=Pa(n,h),s.props=be,we=t.pendingProps,ie=s.context,ne=n.contextType,P=Vo,typeof ne=="object"&&ne!==null&&(P=On(ne)),j=n.getDerivedStateFromProps,(ne=typeof j=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(h!==we||ie!==P)&&is(t,s,l,P),li=!1,ie=t.memoizedState,s.state=ie,kr(t,l,s,o),zr();var de=t.memoizedState;h!==we||ie!==de||li||e!==null&&e.dependencies!==null&&Fo(e.dependencies)?(typeof j=="function"&&(_r(t,n,j,l),de=t.memoizedState),(be=li||tt(t,n,be,l,ie,de,P)||e!==null&&e.dependencies!==null&&Fo(e.dependencies))?(ne||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(l,de,P),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(l,de,P)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||h===e.memoizedProps&&ie===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||h===e.memoizedProps&&ie===e.memoizedState||(t.flags|=1024),t.memoizedProps=l,t.memoizedState=de),s.props=l,s.state=de,s.context=P,l=be):(typeof s.componentDidUpdate!="function"||h===e.memoizedProps&&ie===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||h===e.memoizedProps&&ie===e.memoizedState||(t.flags|=1024),l=!1)}return s=l,xe(e,t),l=(t.flags&128)!==0,s||l?(s=t.stateNode,n=l&&typeof n.getDerivedStateFromError!="function"?null:s.render(),t.flags|=1,e!==null&&l?(t.child=ra(t,e.child,null,o),t.child=ra(t,null,n,o)):T(e,t,n,o),t.memoizedState=s.state,e=t.child):e=Xe(e,t,o),e}function He(e,t,n,l){return Da(),t.flags|=256,T(e,t,n,l),t.child}var Ue={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function E(e){return{baseLanes:e,cachePool:ec()}}function B(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=_l),e}function pe(e,t,n){var l=t.pendingProps,o=!1,s=(t.flags&128)!==0,h;if((h=s)||(h=e!==null&&e.memoizedState===null?!1:(kn.current&2)!==0),h&&(o=!0,t.flags&=-129),h=(t.flags&32)!==0,t.flags&=-33,e===null){if(wt){if(o?tl(t):pl(),(e=Lt)?(e=Wp(e,Ke),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Zn!==null?{id:zi,overflow:ii}:null,retryLane:536870912,hydrationErrors:null},n=br(e),n.return=t,t.child=n,un=t,Lt=null)):e=null,e===null)throw so(t);return xf(e)?t.lanes=32:t.lanes=536870912,null}var j=l.children;return l=l.fallback,o?(pl(),o=t.mode,j=ke({mode:"hidden",children:j},o),l=Kl(l,o,n,null),j.return=t,l.return=t,j.sibling=l,t.child=j,l=t.child,l.memoizedState=E(n),l.childLanes=B(e,h,n),t.memoizedState=Ue,Y(null,l)):(tl(t),te(t,j))}var P=e.memoizedState;if(P!==null&&(j=P.dehydrated,j!==null)){if(s)t.flags&256?(tl(t),t.flags&=-257,t=_e(e,t,n)):t.memoizedState!==null?(pl(),t.child=e.child,t.flags|=128,t=null):(pl(),j=l.fallback,o=t.mode,l=ke({mode:"visible",children:l.children},o),j=Kl(j,o,n,null),j.flags|=2,l.return=t,j.return=t,l.sibling=j,t.child=l,ra(t,e.child,null,n),l=t.child,l.memoizedState=E(n),l.childLanes=B(e,h,n),t.memoizedState=Ue,t=Y(null,l));else if(tl(t),xf(j)){if(h=j.nextSibling&&j.nextSibling.dataset,h)var ne=h.dgst;h=ne,l=Error(d(419)),l.stack="",l.digest=h,co({value:l,source:null,stack:null}),t=_e(e,t,n)}else if(v||Nl(e,t,n,!1),h=(n&e.childLanes)!==0,v||h){if(h=wn,h!==null&&(l=hs(h,n),l!==0&&l!==P.retryLane))throw P.retryLane=l,Eo(e,l),Sl(h,e,l),p;gf(j)||ou(),t=_e(e,t,n)}else gf(j)?(t.flags|=192,t.child=e.child,t=null):(e=P.treeContext,Lt=ua(j.nextSibling),un=t,wt=!0,el=null,Ke=!1,e!==null&&oo(t,e),t=te(t,l.children),t.flags|=4096);return t}return o?(pl(),j=l.fallback,o=t.mode,P=e.child,ne=P.sibling,l=Ql(P,{mode:"hidden",children:l.children}),l.subtreeFlags=P.subtreeFlags&65011712,ne!==null?j=Ql(ne,j):(j=Kl(j,o,n,null),j.flags|=2),j.return=t,l.return=t,l.sibling=j,t.child=l,Y(null,l),l=t.child,j=e.child.memoizedState,j===null?j=E(n):(o=j.cachePool,o!==null?(P=an._currentValue,o=o.parent!==P?{parent:P,pool:P}:o):o=ec(),j={baseLanes:j.baseLanes|n,cachePool:o}),l.memoizedState=j,l.childLanes=B(e,h,n),t.memoizedState=Ue,Y(e.child,l)):(tl(t),n=e.child,e=n.sibling,n=Ql(n,{mode:"visible",children:l.children}),n.return=t,n.sibling=null,e!==null&&(h=t.deletions,h===null?(t.deletions=[e],t.flags|=16):h.push(e)),t.child=n,t.memoizedState=null,n)}function te(e,t){return t=ke({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function ke(e,t){return e=gi(22,e,null,t),e.lanes=0,e}function _e(e,t,n){return ra(t,e.child,null,n),e=te(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Ze(e,t,n){e.lanes|=t;var l=e.alternate;l!==null&&(l.lanes|=t),mr(e.return,t,n)}function Le(e,t,n,l,o,s){var h=e.memoizedState;h===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:l,tail:n,tailMode:o,treeForkCount:s}:(h.isBackwards=t,h.rendering=null,h.renderingStartTime=0,h.last=l,h.tail=n,h.tailMode=o,h.treeForkCount=s)}function ot(e,t,n){var l=t.pendingProps,o=l.revealOrder,s=l.tail;l=l.children;var h=kn.current,j=(h&2)!==0;if(j?(h=h&1|2,t.flags|=128):h&=1,H(kn,h),T(e,t,l,n),l=wt?ta:0,!j&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Ze(e,n,t);else if(e.tag===19)Ze(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(o){case"forwards":for(n=t.child,o=null;n!==null;)e=n.alternate,e!==null&&Zo(e)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),Le(t,!1,o,n,s,l);break;case"backwards":case"unstable_legacy-backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&Zo(e)===null){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}Le(t,!0,n,null,s,l);break;case"together":Le(t,!1,null,null,void 0,l);break;default:t.memoizedState=null}return t.child}function Xe(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Gs|=t.lanes,(n&t.childLanes)===0)if(e!==null){if(Nl(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(d(153));if(t.child!==null){for(e=t.child,n=Ql(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Ql(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function xt(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Fo(e)))}function nt(e,t,n){switch(t.tag){case 3:on(t,t.stateNode.containerInfo),ia(t,an,e.memoizedState.cache),Da();break;case 27:case 5:en(t);break;case 4:on(t,t.stateNode.containerInfo);break;case 10:ia(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,Rr(t),null;break;case 13:var l=t.memoizedState;if(l!==null)return l.dehydrated!==null?(tl(t),t.flags|=128,null):(n&t.child.childLanes)!==0?pe(e,t,n):(tl(t),e=Xe(e,t,n),e!==null?e.sibling:null);tl(t);break;case 19:var o=(e.flags&128)!==0;if(l=(n&t.childLanes)!==0,l||(Nl(e,t,n,!1),l=(n&t.childLanes)!==0),o){if(l)return ot(e,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),H(kn,kn.current),l)break;return null;case 22:return t.lanes=0,re(e,t,n,t.pendingProps);case 24:ia(t,an,e.memoizedState.cache)}return Xe(e,t,n)}function Be(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)v=!0;else{if(!xt(e,n)&&(t.flags&128)===0)return v=!1,nt(e,t,n);v=(e.flags&131072)!==0}else v=!1,wt&&(t.flags&1048576)!==0&&Ra(t,ta,t.index);switch(t.lanes=0,t.tag){case 16:e:{var l=t.pendingProps;if(e=sa(t.elementType),t.type=e,typeof e=="function")xr(e)?(l=Pa(e,l),t.tag=1,t=oe(null,t,e,l,n)):(t.tag=0,t=Ce(null,t,e,l,n));else{if(e!=null){var o=e.$$typeof;if(o===U){t.tag=11,t=k(null,t,e,l,n);break e}else if(o===R){t.tag=14,t=N(null,t,e,l,n);break e}}throw t=Ee(e)||e,Error(d(306,t,""))}}return t;case 0:return Ce(e,t,t.type,t.pendingProps,n);case 1:return l=t.type,o=Pa(l,t.pendingProps),oe(e,t,l,o,n);case 3:e:{if(on(t,t.stateNode.containerInfo),e===null)throw Error(d(387));l=t.pendingProps;var s=t.memoizedState;o=s.element,Gc(e,t),kr(t,l,null,n);var h=t.memoizedState;if(l=h.cache,ia(t,an,l),l!==s.cache&&uo(t,[an],n,!0),zr(),l=h.element,s.isDehydrated)if(s={element:l,isDehydrated:!1,cache:h.cache},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){t=He(e,t,l,n);break e}else if(l!==o){o=ei(Error(d(424)),t),co(o),t=He(e,t,l,n);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Lt=ua(e.firstChild),un=t,wt=!0,el=null,Ke=!0,n=Ml(t,null,l,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(Da(),l===o){t=Xe(e,t,n);break e}T(e,t,l,n)}t=t.child}return t;case 26:return xe(e,t),e===null?(n=Gp(t.type,null,t.pendingProps,null))?t.memoizedState=n:wt||(n=t.type,e=t.pendingProps,l=pu(et.current).createElement(n),l[Fn]=t,l[ri]=e,Ai(l,n,e),jn(l),t.stateNode=l):t.memoizedState=Gp(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return en(t),e===null&&wt&&(l=t.stateNode=Lp(t.type,t.pendingProps,et.current),un=t,Ke=!0,o=Lt,Js(t.type)?(yf=o,Lt=ua(l.firstChild)):Lt=o),T(e,t,t.pendingProps.children,n),xe(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&wt&&((o=l=Lt)&&(l=ag(l,t.type,t.pendingProps,Ke),l!==null?(t.stateNode=l,un=t,Lt=ua(l.firstChild),Ke=!1,o=!0):o=!1),o||so(t)),en(t),o=t.type,s=t.pendingProps,h=e!==null?e.memoizedProps:null,l=s.children,ff(o,s)?l=null:h!==null&&ff(o,h)&&(t.flags|=32),t.memoizedState!==null&&(o=Dr(e,t,_u,null,null,n),Td._currentValue=o),xe(e,t),T(e,t,l,n),t.child;case 6:return e===null&&wt&&((e=n=Lt)&&(n=og(n,t.pendingProps,Ke),n!==null?(t.stateNode=n,un=t,Lt=null,e=!0):e=!1),e||so(t)),null;case 13:return pe(e,t,n);case 4:return on(t,t.stateNode.containerInfo),l=t.pendingProps,e===null?t.child=ra(t,null,l,n):T(e,t,l,n),t.child;case 11:return k(e,t,t.type,t.pendingProps,n);case 7:return T(e,t,t.pendingProps,n),t.child;case 8:return T(e,t,t.pendingProps.children,n),t.child;case 12:return T(e,t,t.pendingProps.children,n),t.child;case 10:return l=t.pendingProps,ia(t,t.type,l.value),T(e,t,l.children,n),t.child;case 9:return o=t.type._context,l=t.pendingProps.children,ul(t),o=On(o),l=l(o),t.flags|=1,T(e,t,l,n),t.child;case 14:return N(e,t,t.type,t.pendingProps,n);case 15:return Z(e,t,t.type,t.pendingProps,n);case 19:return ot(e,t,n);case 31:return q(e,t,n);case 22:return re(e,t,n,t.pendingProps);case 24:return ul(t),l=On(an),e===null?(o=ho(),o===null&&(o=wn,s=fo(),o.pooledCache=s,s.refCount++,s!==null&&(o.pooledCacheLanes|=n),o=s),t.memoizedState={parent:l,cache:o},Ul(t),ia(t,an,o)):((e.lanes&n)!==0&&(Gc(e,t),kr(t,null,null,n),zr()),o=e.memoizedState,s=t.memoizedState,o.parent!==l?(o={parent:l,cache:l},t.memoizedState=o,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=o),ia(t,an,l)):(l=s.cache,ia(t,an,l),l!==o.cache&&uo(t,[an],n,!0))),T(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(d(156,t.tag))}function Je(e){e.flags|=4}function Yt(e,t,n,l,o){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(o&335544128)===o)if(e.stateNode.complete)e.flags|=8192;else if(dp())e.flags|=8192;else throw fl=go,As}else e.flags&=-16777217}function Qt(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Jp(t))if(dp())e.flags|=8192;else throw fl=go,As}function Kt(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?xa():536870912,e.lanes|=t,zc|=t)}function Sn(e,t){if(!wt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var l=null;n!==null;)n.alternate!==null&&(l=n),n=n.sibling;l===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function ft(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,l=0;if(t)for(var o=e.child;o!==null;)n|=o.lanes|o.childLanes,l|=o.subtreeFlags&65011712,l|=o.flags&65011712,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)n|=o.lanes|o.childLanes,l|=o.subtreeFlags,l|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=l,e.childLanes=n,t}function vt(e,t,n){var l=t.pendingProps;switch(dl(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ft(t),null;case 1:return ft(t),null;case 3:return n=t.stateNode,l=null,e!==null&&(l=e.memoizedState.cache),t.memoizedState.cache!==l&&(t.flags|=2048),Al(an),ce(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(na(t)?Je(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,ro())),ft(t),null;case 26:var o=t.type,s=t.memoizedState;return e===null?(Je(t),s!==null?(ft(t),Qt(t,s)):(ft(t),Yt(t,o,null,l,n))):s?s!==e.memoizedState?(Je(t),ft(t),Qt(t,s)):(ft(t),t.flags&=-16777217):(e=e.memoizedProps,e!==l&&Je(t),ft(t),Yt(t,o,e,l,n)),null;case 27:if(Hn(t),n=et.current,o=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==l&&Je(t);else{if(!l){if(t.stateNode===null)throw Error(d(166));return ft(t),null}e=he.current,na(t)?Io(t):(e=Lp(o,l,n),t.stateNode=e,Je(t))}return ft(t),null;case 5:if(Hn(t),o=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==l&&Je(t);else{if(!l){if(t.stateNode===null)throw Error(d(166));return ft(t),null}if(s=he.current,na(t))Io(t);else{var h=pu(et.current);switch(s){case 1:s=h.createElementNS("http://www.w3.org/2000/svg",o);break;case 2:s=h.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;default:switch(o){case"svg":s=h.createElementNS("http://www.w3.org/2000/svg",o);break;case"math":s=h.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;case"script":s=h.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof l.is=="string"?h.createElement("select",{is:l.is}):h.createElement("select"),l.multiple?s.multiple=!0:l.size&&(s.size=l.size);break;default:s=typeof l.is=="string"?h.createElement(o,{is:l.is}):h.createElement(o)}}s[Fn]=t,s[ri]=l;e:for(h=t.child;h!==null;){if(h.tag===5||h.tag===6)s.appendChild(h.stateNode);else if(h.tag!==4&&h.tag!==27&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}t.stateNode=s;e:switch(Ai(s,o,l),o){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}l&&Je(t)}}return ft(t),Yt(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==l&&Je(t);else{if(typeof l!="string"&&t.stateNode===null)throw Error(d(166));if(e=et.current,na(t)){if(e=t.stateNode,n=t.memoizedProps,l=null,o=un,o!==null)switch(o.tag){case 27:case 5:l=o.memoizedProps}e[Fn]=t,e=!!(e.nodeValue===n||l!==null&&l.suppressHydrationWarning===!0||Bp(e.nodeValue,n)),e||so(t,!0)}else e=pu(e).createTextNode(l),e[Fn]=t,t.stateNode=e}return ft(t),null;case 31:if(n=t.memoizedState,e===null||e.memoizedState!==null){if(l=na(t),n!==null){if(e===null){if(!l)throw Error(d(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(d(557));e[Fn]=t}else Da(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;ft(t),e=!1}else n=ro(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return t.flags&256?(ai(t),t):(ai(t),null);if((t.flags&128)!==0)throw Error(d(558))}return ft(t),null;case 13:if(l=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(o=na(t),l!==null&&l.dehydrated!==null){if(e===null){if(!o)throw Error(d(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(d(317));o[Fn]=t}else Da(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;ft(t),o=!1}else o=ro(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=o),o=!0;if(!o)return t.flags&256?(ai(t),t):(ai(t),null)}return ai(t),(t.flags&128)!==0?(t.lanes=n,t):(n=l!==null,e=e!==null&&e.memoizedState!==null,n&&(l=t.child,o=null,l.alternate!==null&&l.alternate.memoizedState!==null&&l.alternate.memoizedState.cachePool!==null&&(o=l.alternate.memoizedState.cachePool.pool),s=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(s=l.memoizedState.cachePool.pool),s!==o&&(l.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),Kt(t,t.updateQueue),ft(t),null);case 4:return ce(),e===null&&sf(t.stateNode.containerInfo),ft(t),null;case 10:return Al(t.type),ft(t),null;case 19:if(M(kn),l=t.memoizedState,l===null)return ft(t),null;if(o=(t.flags&128)!==0,s=l.rendering,s===null)if(o)Sn(l,!1);else{if(Wn!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(s=Zo(e),s!==null){for(t.flags|=128,Sn(l,!1),e=s.updateQueue,t.updateQueue=e,Kt(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)Xc(n,e),n=n.sibling;return H(kn,kn.current&1|2),wt&&cl(t,l.treeForkCount),t.child}e=e.sibling}l.tail!==null&&mi()>iu&&(t.flags|=128,o=!0,Sn(l,!1),t.lanes=4194304)}else{if(!o)if(e=Zo(s),e!==null){if(t.flags|=128,o=!0,e=e.updateQueue,t.updateQueue=e,Kt(t,e),Sn(l,!0),l.tail===null&&l.tailMode==="hidden"&&!s.alternate&&!wt)return ft(t),null}else 2*mi()-l.renderingStartTime>iu&&n!==536870912&&(t.flags|=128,o=!0,Sn(l,!1),t.lanes=4194304);l.isBackwards?(s.sibling=t.child,t.child=s):(e=l.last,e!==null?e.sibling=s:t.child=s,l.last=s)}return l.tail!==null?(e=l.tail,l.rendering=e,l.tail=e.sibling,l.renderingStartTime=mi(),e.sibling=null,n=kn.current,H(kn,o?n&1|2:n&1),wt&&cl(t,l.treeForkCount),e):(ft(t),null);case 22:case 23:return ai(t),Na(),l=t.memoizedState!==null,e!==null?e.memoizedState!==null!==l&&(t.flags|=8192):l&&(t.flags|=8192),l?(n&536870912)!==0&&(t.flags&128)===0&&(ft(t),t.subtreeFlags&6&&(t.flags|=8192)):ft(t),n=t.updateQueue,n!==null&&Kt(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),l=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(l=t.memoizedState.cachePool.pool),l!==n&&(t.flags|=2048),e!==null&&M($i),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Al(an),ft(t),null;case 25:return null;case 30:return null}throw Error(d(156,t.tag))}function Oa(e,t){switch(dl(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Al(an),ce(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Hn(t),null;case 31:if(t.memoizedState!==null){if(ai(t),t.alternate===null)throw Error(d(340));Da()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(ai(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(d(340));Da()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return M(kn),null;case 4:return ce(),null;case 10:return Al(t.type),null;case 22:case 23:return ai(t),Na(),e!==null&&M($i),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Al(an),null;case 25:return null;default:return null}}function da(e,t){switch(dl(t),t.tag){case 3:Al(an),ce();break;case 26:case 27:case 5:Hn(t);break;case 4:ce();break;case 31:t.memoizedState!==null&&ai(t);break;case 13:ai(t);break;case 19:M(kn);break;case 10:Al(t.type);break;case 22:case 23:ai(t),Na(),e!==null&&M($i);break;case 24:Al(an)}}function xi(e,t){try{var n=t.updateQueue,l=n!==null?n.lastEffect:null;if(l!==null){var o=l.next;n=o;do{if((n.tag&e)===e){l=void 0;var s=n.create,h=n.inst;l=s(),h.destroy=l}n=n.next}while(n!==o)}}catch(j){rn(t,t.return,j)}}function Ys(e,t,n){try{var l=t.updateQueue,o=l!==null?l.lastEffect:null;if(o!==null){var s=o.next;l=s;do{if((l.tag&e)===e){var h=l.inst,j=h.destroy;if(j!==void 0){h.destroy=void 0,o=t;var P=n,ne=j;try{ne()}catch(be){rn(o,P,be)}}}l=l.next}while(l!==s)}}catch(be){rn(t,t.return,be)}}function Vf(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{Id(t,n)}catch(l){rn(e,e.return,l)}}}function If(e,t,n){n.props=Pa(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(l){rn(e,t,l)}}function ud(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var l=e.stateNode;break;case 30:l=e.stateNode;break;default:l=e.stateNode}typeof n=="function"?e.refCleanup=n(l):n.current=l}}catch(o){rn(e,t,o)}}function jo(e,t){var n=e.ref,l=e.refCleanup;if(n!==null)if(typeof l=="function")try{l()}catch(o){rn(e,t,o)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(o){rn(e,t,o)}else n.current=null}function Wf(e){var t=e.type,n=e.memoizedProps,l=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&l.focus();break e;case"img":n.src?l.src=n.src:n.srcSet&&(l.srcset=n.srcSet)}}catch(o){rn(e,e.return,o)}}function Eu(e,t,n){try{var l=e.stateNode;Jh(l,e.type,n,t),l[ri]=t}catch(o){rn(e,e.return,o)}}function Ff(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Js(e.type)||e.tag===4}function Vu(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Ff(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Js(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Iu(e,t,n){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=at));else if(l!==4&&(l===27&&Js(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(Iu(e,t,n),e=e.sibling;e!==null;)Iu(e,t,n),e=e.sibling}function Jd(e,t,n){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(l!==4&&(l===27&&Js(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(Jd(e,t,n),e=e.sibling;e!==null;)Jd(e,t,n),e=e.sibling}function $f(e){var t=e.stateNode,n=e.memoizedProps;try{for(var l=e.type,o=t.attributes;o.length;)t.removeAttributeNode(o[0]);Ai(t,l,n),t[Fn]=e,t[ri]=n}catch(s){rn(e,e.return,s)}}var ls=!1,Kn=!1,Wu=!1,Lf=typeof WeakSet=="function"?WeakSet:Set,yi=null;function Mh(e,t){if(e=e.containerInfo,df=mu,e=$c(e),Cs(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var l=n.getSelection&&n.getSelection();if(l&&l.rangeCount!==0){n=l.anchorNode;var o=l.anchorOffset,s=l.focusNode;l=l.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var h=0,j=-1,P=-1,ne=0,be=0,we=e,ie=null;t:for(;;){for(var de;we!==n||o!==0&&we.nodeType!==3||(j=h+o),we!==s||l!==0&&we.nodeType!==3||(P=h+l),we.nodeType===3&&(h+=we.nodeValue.length),(de=we.firstChild)!==null;)ie=we,we=de;for(;;){if(we===e)break t;if(ie===n&&++ne===o&&(j=h),ie===s&&++be===l&&(P=h),(de=we.nextSibling)!==null)break;we=ie,ie=we.parentNode}we=de}n=j===-1||P===-1?null:{start:j,end:P}}else n=null}n=n||{start:0,end:0}}else n=null;for(uf={focusedElem:e,selectionRange:n},mu=!1,yi=t;yi!==null;)if(t=yi,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,yi=e;else for(;yi!==null;){switch(t=yi,s=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(n=0;n<e.length;n++)o=e[n],o.ref.impl=o.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&s!==null){e=void 0,n=t,o=s.memoizedProps,s=s.memoizedState,l=n.stateNode;try{var Ge=Pa(n.type,o);e=l.getSnapshotBeforeUpdate(Ge,s),l.__reactInternalSnapshotBeforeUpdate=e}catch(rt){rn(n,n.return,rt)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)hf(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":hf(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(d(163))}if(e=t.sibling,e!==null){e.return=t.return,yi=e;break}yi=t.return}}function Yf(e,t,n){var l=n.flags;switch(n.tag){case 0:case 11:case 15:os(e,n),l&4&&xi(5,n);break;case 1:if(os(e,n),l&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(h){rn(n,n.return,h)}else{var o=Pa(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(o,t,e.__reactInternalSnapshotBeforeUpdate)}catch(h){rn(n,n.return,h)}}l&64&&Vf(n),l&512&&ud(n,n.return);break;case 3:if(os(e,n),l&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{Id(e,t)}catch(h){rn(n,n.return,h)}}break;case 27:t===null&&l&4&&$f(n);case 26:case 5:os(e,n),t===null&&l&4&&Wf(n),l&512&&ud(n,n.return);break;case 12:os(e,n);break;case 31:os(e,n),l&4&&qf(e,n);break;case 13:os(e,n),l&4&&Zf(e,n),l&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=Ih.bind(null,n),sg(e,n))));break;case 22:if(l=n.memoizedState!==null||ls,!l){t=t!==null&&t.memoizedState!==null||Kn,o=ls;var s=Kn;ls=l,(Kn=t)&&!s?ss(e,n,(n.subtreeFlags&8772)!==0):os(e,n),ls=o,Kn=s}break;case 30:break;default:os(e,n)}}function Xf(e){var t=e.alternate;t!==null&&(e.alternate=null,Xf(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Xt(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Bn=null,yl=!1;function as(e,t,n){for(n=n.child;n!==null;)Gf(e,t,n),n=n.sibling}function Gf(e,t,n){if(pt&&typeof pt.onCommitFiberUnmount=="function")try{pt.onCommitFiberUnmount(Xi,n)}catch{}switch(n.tag){case 26:Kn||jo(n,t),as(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:Kn||jo(n,t);var l=Bn,o=yl;Js(n.type)&&(Bn=n.stateNode,yl=!1),as(e,t,n),md(n.stateNode),Bn=l,yl=o;break;case 5:Kn||jo(n,t);case 6:if(l=Bn,o=yl,Bn=null,as(e,t,n),Bn=l,yl=o,Bn!==null)if(yl)try{(Bn.nodeType===9?Bn.body:Bn.nodeName==="HTML"?Bn.ownerDocument.body:Bn).removeChild(n.stateNode)}catch(s){rn(n,t,s)}else try{Bn.removeChild(n.stateNode)}catch(s){rn(n,t,s)}break;case 18:Bn!==null&&(yl?(e=Bn,Vp(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,n.stateNode),Bc(e)):Vp(Bn,n.stateNode));break;case 4:l=Bn,o=yl,Bn=n.stateNode.containerInfo,yl=!0,as(e,t,n),Bn=l,yl=o;break;case 0:case 11:case 14:case 15:Ys(2,n,t),Kn||Ys(4,n,t),as(e,t,n);break;case 1:Kn||(jo(n,t),l=n.stateNode,typeof l.componentWillUnmount=="function"&&If(n,t,l)),as(e,t,n);break;case 21:as(e,t,n);break;case 22:Kn=(l=Kn)||n.memoizedState!==null,as(e,t,n),Kn=l;break;default:as(e,t,n)}}function qf(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Bc(e)}catch(n){rn(t,t.return,n)}}}function Zf(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Bc(e)}catch(n){rn(t,t.return,n)}}function Uh(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new Lf),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new Lf),t;default:throw Error(d(435,e.tag))}}function eu(e,t){var n=Uh(e);t.forEach(function(l){if(!n.has(l)){n.add(l);var o=Wh.bind(null,e,l);l.then(o,o)}})}function bl(e,t){var n=t.deletions;if(n!==null)for(var l=0;l<n.length;l++){var o=n[l],s=e,h=t,j=h;e:for(;j!==null;){switch(j.tag){case 27:if(Js(j.type)){Bn=j.stateNode,yl=!1;break e}break;case 5:Bn=j.stateNode,yl=!1;break e;case 3:case 4:Bn=j.stateNode.containerInfo,yl=!0;break e}j=j.return}if(Bn===null)throw Error(d(160));Gf(s,h,o),Bn=null,yl=!1,s=o.alternate,s!==null&&(s.return=null),o.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)Qf(t,e),t=t.sibling}var _a=null;function Qf(e,t){var n=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:bl(t,e),vl(e),l&4&&(Ys(3,e,e.return),xi(3,e),Ys(5,e,e.return));break;case 1:bl(t,e),vl(e),l&512&&(Kn||n===null||jo(n,n.return)),l&64&&ls&&(e=e.updateQueue,e!==null&&(l=e.callbacks,l!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?l:n.concat(l))));break;case 26:var o=_a;if(bl(t,e),vl(e),l&512&&(Kn||n===null||jo(n,n.return)),l&4){var s=n!==null?n.memoizedState:null;if(l=e.memoizedState,n===null)if(l===null)if(e.stateNode===null){e:{l=e.type,n=e.memoizedProps,o=o.ownerDocument||o;t:switch(l){case"title":s=o.getElementsByTagName("title")[0],(!s||s[Wl]||s[Fn]||s.namespaceURI==="http://www.w3.org/2000/svg"||s.hasAttribute("itemprop"))&&(s=o.createElement(l),o.head.insertBefore(s,o.querySelector("head > title"))),Ai(s,l,n),s[Fn]=e,jn(s),l=s;break e;case"link":var h=Qp("link","href",o).get(l+(n.href||""));if(h){for(var j=0;j<h.length;j++)if(s=h[j],s.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&s.getAttribute("rel")===(n.rel==null?null:n.rel)&&s.getAttribute("title")===(n.title==null?null:n.title)&&s.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){h.splice(j,1);break t}}s=o.createElement(l),Ai(s,l,n),o.head.appendChild(s);break;case"meta":if(h=Qp("meta","content",o).get(l+(n.content||""))){for(j=0;j<h.length;j++)if(s=h[j],s.getAttribute("content")===(n.content==null?null:""+n.content)&&s.getAttribute("name")===(n.name==null?null:n.name)&&s.getAttribute("property")===(n.property==null?null:n.property)&&s.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&s.getAttribute("charset")===(n.charSet==null?null:n.charSet)){h.splice(j,1);break t}}s=o.createElement(l),Ai(s,l,n),o.head.appendChild(s);break;default:throw Error(d(468,l))}s[Fn]=e,jn(s),l=s}e.stateNode=l}else Kp(o,e.type,e.stateNode);else e.stateNode=Zp(o,l,e.memoizedProps);else s!==l?(s===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):s.count--,l===null?Kp(o,e.type,e.stateNode):Zp(o,l,e.memoizedProps)):l===null&&e.stateNode!==null&&Eu(e,e.memoizedProps,n.memoizedProps)}break;case 27:bl(t,e),vl(e),l&512&&(Kn||n===null||jo(n,n.return)),n!==null&&l&4&&Eu(e,e.memoizedProps,n.memoizedProps);break;case 5:if(bl(t,e),vl(e),l&512&&(Kn||n===null||jo(n,n.return)),e.flags&32){o=e.stateNode;try{ko(o,"")}catch(Ge){rn(e,e.return,Ge)}}l&4&&e.stateNode!=null&&(o=e.memoizedProps,Eu(e,o,n!==null?n.memoizedProps:o)),l&1024&&(Wu=!0);break;case 6:if(bl(t,e),vl(e),l&4){if(e.stateNode===null)throw Error(d(162));l=e.memoizedProps,n=e.stateNode;try{n.nodeValue=l}catch(Ge){rn(e,e.return,Ge)}}break;case 3:if(xu=null,o=_a,_a=hu(t.containerInfo),bl(t,e),_a=o,vl(e),l&4&&n!==null&&n.memoizedState.isDehydrated)try{Bc(t.containerInfo)}catch(Ge){rn(e,e.return,Ge)}Wu&&(Wu=!1,Kf(e));break;case 4:l=_a,_a=hu(e.stateNode.containerInfo),bl(t,e),vl(e),_a=l;break;case 12:bl(t,e),vl(e);break;case 31:bl(t,e),vl(e),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,eu(e,l)));break;case 13:bl(t,e),vl(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(nu=mi()),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,eu(e,l)));break;case 22:o=e.memoizedState!==null;var P=n!==null&&n.memoizedState!==null,ne=ls,be=Kn;if(ls=ne||o,Kn=be||P,bl(t,e),Kn=be,ls=ne,vl(e),l&8192)e:for(t=e.stateNode,t._visibility=o?t._visibility&-2:t._visibility|1,o&&(n===null||P||ls||Kn||Hr(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){P=n=t;try{if(s=P.stateNode,o)h=s.style,typeof h.setProperty=="function"?h.setProperty("display","none","important"):h.display="none";else{j=P.stateNode;var we=P.memoizedProps.style,ie=we!=null&&we.hasOwnProperty("display")?we.display:null;j.style.display=ie==null||typeof ie=="boolean"?"":(""+ie).trim()}}catch(Ge){rn(P,P.return,Ge)}}}else if(t.tag===6){if(n===null){P=t;try{P.stateNode.nodeValue=o?"":P.memoizedProps}catch(Ge){rn(P,P.return,Ge)}}}else if(t.tag===18){if(n===null){P=t;try{var de=P.stateNode;o?Ip(de,!0):Ip(P.stateNode,!1)}catch(Ge){rn(P,P.return,Ge)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}l&4&&(l=e.updateQueue,l!==null&&(n=l.retryQueue,n!==null&&(l.retryQueue=null,eu(e,n))));break;case 19:bl(t,e),vl(e),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,eu(e,l)));break;case 30:break;case 21:break;default:bl(t,e),vl(e)}}function vl(e){var t=e.flags;if(t&2){try{for(var n,l=e.return;l!==null;){if(Ff(l)){n=l;break}l=l.return}if(n==null)throw Error(d(160));switch(n.tag){case 27:var o=n.stateNode,s=Vu(e);Jd(e,s,o);break;case 5:var h=n.stateNode;n.flags&32&&(ko(h,""),n.flags&=-33);var j=Vu(e);Jd(e,j,h);break;case 3:case 4:var P=n.stateNode.containerInfo,ne=Vu(e);Iu(e,ne,P);break;default:throw Error(d(161))}}catch(be){rn(e,e.return,be)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Kf(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;Kf(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function os(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)Yf(e,t.alternate,t),t=t.sibling}function Hr(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Ys(4,t,t.return),Hr(t);break;case 1:jo(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&If(t,t.return,n),Hr(t);break;case 27:md(t.stateNode);case 26:case 5:jo(t,t.return),Hr(t);break;case 22:t.memoizedState===null&&Hr(t);break;case 30:Hr(t);break;default:Hr(t)}e=e.sibling}}function ss(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var l=t.alternate,o=e,s=t,h=s.flags;switch(s.tag){case 0:case 11:case 15:ss(o,s,n),xi(4,s);break;case 1:if(ss(o,s,n),l=s,o=l.stateNode,typeof o.componentDidMount=="function")try{o.componentDidMount()}catch(ne){rn(l,l.return,ne)}if(l=s,o=l.updateQueue,o!==null){var j=l.stateNode;try{var P=o.shared.hiddenCallbacks;if(P!==null)for(o.shared.hiddenCallbacks=null,o=0;o<P.length;o++)Vd(P[o],j)}catch(ne){rn(l,l.return,ne)}}n&&h&64&&Vf(s),ud(s,s.return);break;case 27:$f(s);case 26:case 5:ss(o,s,n),n&&l===null&&h&4&&Wf(s),ud(s,s.return);break;case 12:ss(o,s,n);break;case 31:ss(o,s,n),n&&h&4&&qf(o,s);break;case 13:ss(o,s,n),n&&h&4&&Zf(o,s);break;case 22:s.memoizedState===null&&ss(o,s,n),ud(s,s.return);break;case 30:break;default:ss(o,s,n)}t=t.sibling}}function Fu(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&la(n))}function $u(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&la(e))}function Ha(e,t,n,l){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Jf(e,t,n,l),t=t.sibling}function Jf(e,t,n,l){var o=t.flags;switch(t.tag){case 0:case 11:case 15:Ha(e,t,n,l),o&2048&&xi(9,t);break;case 1:Ha(e,t,n,l);break;case 3:Ha(e,t,n,l),o&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&la(e)));break;case 12:if(o&2048){Ha(e,t,n,l),e=t.stateNode;try{var s=t.memoizedProps,h=s.id,j=s.onPostCommit;typeof j=="function"&&j(h,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(P){rn(t,t.return,P)}}else Ha(e,t,n,l);break;case 31:Ha(e,t,n,l);break;case 13:Ha(e,t,n,l);break;case 23:break;case 22:s=t.stateNode,h=t.alternate,t.memoizedState!==null?s._visibility&2?Ha(e,t,n,l):fd(e,t):s._visibility&2?Ha(e,t,n,l):(s._visibility|=2,Tc(e,t,n,l,(t.subtreeFlags&10256)!==0||!1)),o&2048&&Fu(h,t);break;case 24:Ha(e,t,n,l),o&2048&&$u(t.alternate,t);break;default:Ha(e,t,n,l)}}function Tc(e,t,n,l,o){for(o=o&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var s=e,h=t,j=n,P=l,ne=h.flags;switch(h.tag){case 0:case 11:case 15:Tc(s,h,j,P,o),xi(8,h);break;case 23:break;case 22:var be=h.stateNode;h.memoizedState!==null?be._visibility&2?Tc(s,h,j,P,o):fd(s,h):(be._visibility|=2,Tc(s,h,j,P,o)),o&&ne&2048&&Fu(h.alternate,h);break;case 24:Tc(s,h,j,P,o),o&&ne&2048&&$u(h.alternate,h);break;default:Tc(s,h,j,P,o)}t=t.sibling}}function fd(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,l=t,o=l.flags;switch(l.tag){case 22:fd(n,l),o&2048&&Fu(l.alternate,l);break;case 24:fd(n,l),o&2048&&$u(l.alternate,l);break;default:fd(n,l)}t=t.sibling}}var pd=8192;function jc(e,t,n){if(e.subtreeFlags&pd)for(e=e.child;e!==null;)ep(e,t,n),e=e.sibling}function ep(e,t,n){switch(e.tag){case 26:jc(e,t,n),e.flags&pd&&e.memoizedState!==null&&vg(n,_a,e.memoizedState,e.memoizedProps);break;case 5:jc(e,t,n);break;case 3:case 4:var l=_a;_a=hu(e.stateNode.containerInfo),jc(e,t,n),_a=l;break;case 22:e.memoizedState===null&&(l=e.alternate,l!==null&&l.memoizedState!==null?(l=pd,pd=16777216,jc(e,t,n),pd=l):jc(e,t,n));break;default:jc(e,t,n)}}function tp(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function hd(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var l=t[n];yi=l,ip(l,e)}tp(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)np(e),e=e.sibling}function np(e){switch(e.tag){case 0:case 11:case 15:hd(e),e.flags&2048&&Ys(9,e,e.return);break;case 3:hd(e);break;case 12:hd(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,tu(e)):hd(e);break;default:hd(e)}}function tu(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var l=t[n];yi=l,ip(l,e)}tp(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:Ys(8,t,t.return),tu(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,tu(t));break;default:tu(t)}e=e.sibling}}function ip(e,t){for(;yi!==null;){var n=yi;switch(n.tag){case 0:case 11:case 15:Ys(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var l=n.memoizedState.cachePool.pool;l!=null&&l.refCount++}break;case 24:la(n.memoizedState.cache)}if(l=n.child,l!==null)l.return=n,yi=l;else e:for(n=e;yi!==null;){l=yi;var o=l.sibling,s=l.return;if(Xf(l),l===n){yi=null;break e}if(o!==null){o.return=s,yi=o;break e}yi=s}}}var Bh={getCacheForType:function(e){var t=On(an),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return On(an).controller.signal}},Ph=typeof WeakMap=="function"?WeakMap:Map,Jt=0,wn=null,Pt=null,Et=0,sn=0,Ol=null,Xs=!1,Cc=!1,Lu=!1,rs=0,Wn=0,Gs=0,Er=0,Yu=0,_l=0,zc=0,gd=null,ml=null,Xu=!1,nu=0,lp=0,iu=1/0,lu=null,qs=null,oi=0,Zs=null,kc=null,cs=0,Gu=0,qu=null,ap=null,xd=0,Zu=null;function Hl(){return(Jt&2)!==0&&Et!==0?Et&-Et:_.T!==null?nf():ll()}function op(){if(_l===0)if((Et&536870912)===0||wt){var e=cn;cn<<=1,(cn&3932160)===0&&(cn=262144),_l=e}else _l=536870912;return e=Qn.current,e!==null&&(e.flags|=32),_l}function Sl(e,t,n){(e===wn&&(sn===2||sn===9)||e.cancelPendingCommit!==null)&&(Rc(e,0),Qs(e,Et,_l,!1)),Gi(e,n),((Jt&2)===0||e!==wn)&&(e===wn&&((Jt&2)===0&&(Er|=n),Wn===4&&Qs(e,Et,_l,!1)),Co(e))}function sp(e,t,n){if((Jt&6)!==0)throw Error(d(327));var l=!n&&(t&127)===0&&(t&e.expiredLanes)===0||Ea(e,t),o=l?Hh(e,t):Ku(e,t,!0),s=l;do{if(o===0){Cc&&!l&&Qs(e,t,0,!1);break}else{if(n=e.current.alternate,s&&!Oh(n)){o=Ku(e,t,!1),s=!1;continue}if(o===2){if(s=t,e.errorRecoveryDisabledLanes&s)var h=0;else h=e.pendingLanes&-536870913,h=h!==0?h:h&536870912?536870912:0;if(h!==0){t=h;e:{var j=e;o=gd;var P=j.current.memoizedState.isDehydrated;if(P&&(Rc(j,h).flags|=256),h=Ku(j,h,!1),h!==2){if(Lu&&!P){j.errorRecoveryDisabledLanes|=s,Er|=s,o=4;break e}s=ml,ml=o,s!==null&&(ml===null?ml=s:ml.push.apply(ml,s))}o=h}if(s=!1,o!==2)continue}}if(o===1){Rc(e,0),Qs(e,t,0,!0);break}e:{switch(l=e,s=o,s){case 0:case 1:throw Error(d(345));case 4:if((t&4194048)!==t)break;case 6:Qs(l,t,_l,!Xs);break e;case 2:ml=null;break;case 3:case 5:break;default:throw Error(d(329))}if((t&62914560)===t&&(o=nu+300-mi(),10<o)){if(Qs(l,t,_l,!Xs),Vl(l,0,!0)!==0)break e;cs=t,l.timeoutHandle=Hp(rp.bind(null,l,n,ml,lu,Xu,t,_l,Er,zc,Xs,s,"Throttled",-0,0),o);break e}rp(l,n,ml,lu,Xu,t,_l,Er,zc,Xs,s,null,-0,0)}}break}while(!0);Co(e)}function rp(e,t,n,l,o,s,h,j,P,ne,be,we,ie,de){if(e.timeoutHandle=-1,we=t.subtreeFlags,we&8192||(we&16785408)===16785408){we={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:at},ep(t,s,we);var Ge=(s&62914560)===s?nu-mi():(s&4194048)===s?lp-mi():0;if(Ge=mg(we,Ge),Ge!==null){cs=s,e.cancelPendingCommit=Ge(xp.bind(null,e,t,s,n,l,o,h,j,P,be,we,null,ie,de)),Qs(e,s,h,!ne);return}}xp(e,t,s,n,l,o,h,j,P)}function Oh(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var l=0;l<n.length;l++){var o=n[l],s=o.getSnapshot;o=o.value;try{if(!Nn(s(),o))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Qs(e,t,n,l){t&=~Yu,t&=~Er,e.suspendedLanes|=t,e.pingedLanes&=~t,l&&(e.warmLanes|=t),l=e.expirationTimes;for(var o=t;0<o;){var s=31-Rn(o),h=1<<s;l[s]=-1,o&=~h}n!==0&&qi(e,n,t)}function au(){return(Jt&6)===0?(yd(0),!1):!0}function Qu(){if(Pt!==null){if(sn===0)var e=Pt.return;else e=Pt,Wi=Wo=null,cc(e),xo=null,yo=0,e=Pt;for(;e!==null;)da(e.alternate,e),e=e.return;Pt=null}}function Rc(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,ng(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),cs=0,Qu(),wn=e,Pt=n=Ql(e.current,null),Et=t,sn=0,Ol=null,Xs=!1,Cc=Ea(e,t),Lu=!1,zc=_l=Yu=Er=Gs=Wn=0,ml=gd=null,Xu=!1,(t&8)!==0&&(t|=t&32);var l=e.entangledLanes;if(l!==0)for(e=e.entanglements,l&=t;0<l;){var o=31-Rn(l),s=1<<o;t|=e[o],l&=~s}return rs=t,Ho(),n}function cp(e,t){st=null,_.H=Ba,t===Xo||t===Tr?(t=Ms(),sn=3):t===As?(t=Ms(),sn=4):sn=t===p?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Ol=t,Pt===null&&(Wn=1,a(e,ei(t,e.current)))}function dp(){var e=Qn.current;return e===null?!0:(Et&4194048)===Et?ki===null:(Et&62914560)===Et||(Et&536870912)!==0?e===ki:!1}function up(){var e=_.H;return _.H=Ba,e===null?Ba:e}function fp(){var e=_.A;return _.A=Bh,e}function ou(){Wn=4,Xs||(Et&4194048)!==Et&&Qn.current!==null||(Cc=!0),(Gs&134217727)===0&&(Er&134217727)===0||wn===null||Qs(wn,Et,_l,!1)}function Ku(e,t,n){var l=Jt;Jt|=2;var o=up(),s=fp();(wn!==e||Et!==t)&&(lu=null,Rc(e,t)),t=!1;var h=Wn;e:do try{if(sn!==0&&Pt!==null){var j=Pt,P=Ol;switch(sn){case 8:Qu(),h=6;break e;case 3:case 2:case 9:case 6:Qn.current===null&&(t=!0);var ne=sn;if(sn=0,Ol=null,Dc(e,j,P,ne),n&&Cc){h=0;break e}break;default:ne=sn,sn=0,Ol=null,Dc(e,j,P,ne)}}_h(),h=Wn;break}catch(be){cp(e,be)}while(!0);return t&&e.shellSuspendCounter++,Wi=Wo=null,Jt=l,_.H=o,_.A=s,Pt===null&&(wn=null,Et=0,Ho()),h}function _h(){for(;Pt!==null;)pp(Pt)}function Hh(e,t){var n=Jt;Jt|=2;var l=up(),o=fp();wn!==e||Et!==t?(lu=null,iu=mi()+500,Rc(e,t)):Cc=Ea(e,t);e:do try{if(sn!==0&&Pt!==null){t=Pt;var s=Ol;t:switch(sn){case 1:sn=0,Ol=null,Dc(e,t,s,1);break;case 2:case 9:if(Ns(s)){sn=0,Ol=null,hp(t);break}t=function(){sn!==2&&sn!==9||wn!==e||(sn=7),Co(e)},s.then(t,t);break e;case 3:sn=7;break e;case 4:sn=5;break e;case 7:Ns(s)?(sn=0,Ol=null,hp(t)):(sn=0,Ol=null,Dc(e,t,s,7));break;case 5:var h=null;switch(Pt.tag){case 26:h=Pt.memoizedState;case 5:case 27:var j=Pt;if(h?Jp(h):j.stateNode.complete){sn=0,Ol=null;var P=j.sibling;if(P!==null)Pt=P;else{var ne=j.return;ne!==null?(Pt=ne,su(ne)):Pt=null}break t}}sn=0,Ol=null,Dc(e,t,s,5);break;case 6:sn=0,Ol=null,Dc(e,t,s,6);break;case 8:Qu(),Wn=6;break e;default:throw Error(d(462))}}Eh();break}catch(be){cp(e,be)}while(!0);return Wi=Wo=null,_.H=l,_.A=o,Jt=n,Pt!==null?0:(wn=null,Et=0,Ho(),Wn)}function Eh(){for(;Pt!==null&&!ha();)pp(Pt)}function pp(e){var t=Be(e.alternate,e,rs);e.memoizedProps=e.pendingProps,t===null?su(e):Pt=t}function hp(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=ze(n,t,t.pendingProps,t.type,void 0,Et);break;case 11:t=ze(n,t,t.pendingProps,t.type.render,t.ref,Et);break;case 5:cc(t);default:da(n,t),t=Pt=Xc(t,rs),t=Be(n,t,rs)}e.memoizedProps=e.pendingProps,t===null?su(e):Pt=t}function Dc(e,t,n,l){Wi=Wo=null,cc(t),xo=null,yo=0;var o=t.return;try{if(S(e,o,t,n,Et)){Wn=1,a(e,ei(n,e.current)),Pt=null;return}}catch(s){if(o!==null)throw Pt=o,s;Wn=1,a(e,ei(n,e.current)),Pt=null;return}t.flags&32768?(wt||l===1?e=!0:Cc||(Et&536870912)!==0?e=!1:(Xs=e=!0,(l===2||l===9||l===3||l===6)&&(l=Qn.current,l!==null&&l.tag===13&&(l.flags|=16384))),gp(t,e)):su(t)}function su(e){var t=e;do{if((t.flags&32768)!==0){gp(t,Xs);return}e=t.return;var n=vt(t.alternate,t,rs);if(n!==null){Pt=n;return}if(t=t.sibling,t!==null){Pt=t;return}Pt=t=e}while(t!==null);Wn===0&&(Wn=5)}function gp(e,t){do{var n=Oa(e.alternate,e);if(n!==null){n.flags&=32767,Pt=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){Pt=e;return}Pt=e=n}while(e!==null);Wn=6,Pt=null}function xp(e,t,n,l,o,s,h,j,P){e.cancelPendingCommit=null;do ru();while(oi!==0);if((Jt&6)!==0)throw Error(d(327));if(t!==null){if(t===e.current)throw Error(d(177));if(s=t.lanes|t.childLanes,s|=za,ps(e,n,s,h,j,P),e===wn&&(Pt=wn=null,Et=0),kc=t,Zs=e,cs=n,Gu=s,qu=o,ap=l,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Fh(mt,function(){return Sp(),null})):(e.callbackNode=null,e.callbackPriority=0),l=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||l){l=_.T,_.T=null,o=O.p,O.p=2,h=Jt,Jt|=4;try{Mh(e,t,n)}finally{Jt=h,O.p=o,_.T=l}}oi=1,yp(),bp(),vp()}}function yp(){if(oi===1){oi=0;var e=Zs,t=kc,n=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||n){n=_.T,_.T=null;var l=O.p;O.p=2;var o=Jt;Jt|=4;try{Qf(t,e);var s=uf,h=$c(e.containerInfo),j=s.focusedElem,P=s.selectionRange;if(h!==j&&j&&j.ownerDocument&&io(j.ownerDocument.documentElement,j)){if(P!==null&&Cs(j)){var ne=P.start,be=P.end;if(be===void 0&&(be=ne),"selectionStart"in j)j.selectionStart=ne,j.selectionEnd=Math.min(be,j.value.length);else{var we=j.ownerDocument||document,ie=we&&we.defaultView||window;if(ie.getSelection){var de=ie.getSelection(),Ge=j.textContent.length,rt=Math.min(P.start,Ge),pn=P.end===void 0?rt:Math.min(P.end,Ge);!de.extend&&rt>pn&&(h=pn,pn=rt,rt=h);var X=Od(j,rt),V=Od(j,pn);if(X&&V&&(de.rangeCount!==1||de.anchorNode!==X.node||de.anchorOffset!==X.offset||de.focusNode!==V.node||de.focusOffset!==V.offset)){var ee=we.createRange();ee.setStart(X.node,X.offset),de.removeAllRanges(),rt>pn?(de.addRange(ee),de.extend(V.node,V.offset)):(ee.setEnd(V.node,V.offset),de.addRange(ee))}}}}for(we=[],de=j;de=de.parentNode;)de.nodeType===1&&we.push({element:de,left:de.scrollLeft,top:de.scrollTop});for(typeof j.focus=="function"&&j.focus(),j=0;j<we.length;j++){var me=we[j];me.element.scrollLeft=me.left,me.element.scrollTop=me.top}}mu=!!df,uf=df=null}finally{Jt=o,O.p=l,_.T=n}}e.current=t,oi=2}}function bp(){if(oi===2){oi=0;var e=Zs,t=kc,n=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||n){n=_.T,_.T=null;var l=O.p;O.p=2;var o=Jt;Jt|=4;try{Yf(e,t.alternate,t)}finally{Jt=o,O.p=l,_.T=n}}oi=3}}function vp(){if(oi===4||oi===3){oi=0,us();var e=Zs,t=kc,n=cs,l=ap;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?oi=5:(oi=0,kc=Zs=null,mp(e,e.pendingLanes));var o=e.pendingLanes;if(o===0&&(qs=null),Ve(n),t=t.stateNode,pt&&typeof pt.onCommitFiberRoot=="function")try{pt.onCommitFiberRoot(Xi,t,void 0,(t.current.flags&128)===128)}catch{}if(l!==null){t=_.T,o=O.p,O.p=2,_.T=null;try{for(var s=e.onRecoverableError,h=0;h<l.length;h++){var j=l[h];s(j.value,{componentStack:j.stack})}}finally{_.T=t,O.p=o}}(cs&3)!==0&&ru(),Co(e),o=e.pendingLanes,(n&261930)!==0&&(o&42)!==0?e===Zu?xd++:(xd=0,Zu=e):xd=0,yd(0)}}function mp(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,la(t)))}function ru(){return yp(),bp(),vp(),Sp()}function Sp(){if(oi!==5)return!1;var e=Zs,t=Gu;Gu=0;var n=Ve(cs),l=_.T,o=O.p;try{O.p=32>n?32:n,_.T=null,n=qu,qu=null;var s=Zs,h=cs;if(oi=0,kc=Zs=null,cs=0,(Jt&6)!==0)throw Error(d(331));var j=Jt;if(Jt|=4,np(s.current),Jf(s,s.current,h,n),Jt=j,yd(0,!1),pt&&typeof pt.onPostCommitFiberRoot=="function")try{pt.onPostCommitFiberRoot(Xi,s)}catch{}return!0}finally{O.p=o,_.T=l,mp(e,t)}}function wp(e,t,n){t=ei(n,t),t=f(e.stateNode,t,2),e=vo(e,t,2),e!==null&&(Gi(e,2),Co(e))}function rn(e,t,n){if(e.tag===3)wp(e,e,n);else for(;t!==null;){if(t.tag===3){wp(t,e,n);break}else if(t.tag===1){var l=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(qs===null||!qs.has(l))){e=ei(n,e),n=m(2),l=vo(t,n,2),l!==null&&(x(n,l,t,e),Gi(l,2),Co(l));break}}t=t.return}}function Ju(e,t,n){var l=e.pingCache;if(l===null){l=e.pingCache=new Ph;var o=new Set;l.set(t,o)}else o=l.get(t),o===void 0&&(o=new Set,l.set(t,o));o.has(n)||(Lu=!0,o.add(n),e=Vh.bind(null,e,t,n),t.then(e,e))}function Vh(e,t,n){var l=e.pingCache;l!==null&&l.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,wn===e&&(Et&n)===n&&(Wn===4||Wn===3&&(Et&62914560)===Et&&300>mi()-nu?(Jt&2)===0&&Rc(e,0):Yu|=n,zc===Et&&(zc=0)),Co(e)}function Tp(e,t){t===0&&(t=xa()),e=Eo(e,t),e!==null&&(Gi(e,t),Co(e))}function Ih(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Tp(e,n)}function Wh(e,t){var n=0;switch(e.tag){case 31:case 13:var l=e.stateNode,o=e.memoizedState;o!==null&&(n=o.retryLane);break;case 19:l=e.stateNode;break;case 22:l=e.stateNode._retryCache;break;default:throw Error(d(314))}l!==null&&l.delete(t),Tp(e,n)}function Fh(e,t){return Tl(e,t)}var cu=null,Ac=null,ef=!1,du=!1,tf=!1,Ks=0;function Co(e){e!==Ac&&e.next===null&&(Ac===null?cu=Ac=e:Ac=Ac.next=e),du=!0,ef||(ef=!0,Lh())}function yd(e,t){if(!tf&&du){tf=!0;do for(var n=!1,l=cu;l!==null;){if(e!==0){var o=l.pendingLanes;if(o===0)var s=0;else{var h=l.suspendedLanes,j=l.pingedLanes;s=(1<<31-Rn(42|e)+1)-1,s&=o&~(h&~j),s=s&201326741?s&201326741|1:s?s|2:0}s!==0&&(n=!0,kp(l,s))}else s=Et,s=Vl(l,l===wn?s:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),(s&3)===0||Ea(l,s)||(n=!0,kp(l,s));l=l.next}while(n);tf=!1}}function $h(){jp()}function jp(){du=ef=!1;var e=0;Ks!==0&&tg()&&(e=Ks);for(var t=mi(),n=null,l=cu;l!==null;){var o=l.next,s=Cp(l,t);s===0?(l.next=null,n===null?cu=o:n.next=o,o===null&&(Ac=n)):(n=l,(e!==0||(s&3)!==0)&&(du=!0)),l=o}oi!==0&&oi!==5||yd(e),Ks!==0&&(Ks=0)}function Cp(e,t){for(var n=e.suspendedLanes,l=e.pingedLanes,o=e.expirationTimes,s=e.pendingLanes&-62914561;0<s;){var h=31-Rn(s),j=1<<h,P=o[h];P===-1?((j&n)===0||(j&l)!==0)&&(o[h]=Ht(j,t)):P<=t&&(e.expiredLanes|=j),s&=~j}if(t=wn,n=Et,n=Vl(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),l=e.callbackNode,n===0||e===t&&(sn===2||sn===9)||e.cancelPendingCommit!==null)return l!==null&&l!==null&&vi(l),e.callbackNode=null,e.callbackPriority=0;if((n&3)===0||Ea(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(l!==null&&vi(l),Ve(n)){case 2:case 8:n=qe;break;case 32:n=mt;break;case 268435456:n=$e;break;default:n=mt}return l=zp.bind(null,e),n=Tl(n,l),e.callbackPriority=t,e.callbackNode=n,t}return l!==null&&l!==null&&vi(l),e.callbackPriority=2,e.callbackNode=null,2}function zp(e,t){if(oi!==0&&oi!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(ru()&&e.callbackNode!==n)return null;var l=Et;return l=Vl(e,e===wn?l:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),l===0?null:(sp(e,l,t),Cp(e,mi()),e.callbackNode!=null&&e.callbackNode===n?zp.bind(null,e):null)}function kp(e,t){if(ru())return null;sp(e,t,!0)}function Lh(){ig(function(){(Jt&6)!==0?Tl(Vr,$h):jp()})}function nf(){if(Ks===0){var e=oa;e===0&&(e=ct,ct<<=1,(ct&261888)===0&&(ct=256)),Ks=e}return Ks}function Rp(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Ro(""+e)}function Dp(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function Yh(e,t,n,l,o){if(t==="submit"&&n&&n.stateNode===o){var s=Rp((o[ri]||null).action),h=l.submitter;h&&(t=(t=h[ri]||null)?Rp(t.formAction):h.getAttribute("formAction"),t!==null&&(s=t,h=null));var j=new sr("action","action",null,l,o);e.push({event:j,listeners:[{instance:null,listener:function(){if(l.defaultPrevented){if(Ks!==0){var P=h?Dp(o,h):new FormData(o);es(n,{pending:!0,data:P,method:o.method,action:s},null,P)}}else typeof s=="function"&&(j.preventDefault(),P=h?Dp(o,h):new FormData(o),es(n,{pending:!0,data:P,method:o.method,action:s},s,P))},currentTarget:o}]})}}for(var lf=0;lf<rl.length;lf++){var af=rl[lf],Xh=af.toLowerCase(),Gh=af[0].toUpperCase()+af.slice(1);bn(Xh,"on"+Gh)}bn(ks,"onAnimationEnd"),bn(lo,"onAnimationIteration"),bn(Po,"onAnimationStart"),bn("dblclick","onDoubleClick"),bn("focusin","onFocus"),bn("focusout","onBlur"),bn(fr,"onTransitionRun"),bn(Kr,"onTransitionStart"),bn(pr,"onTransitionCancel"),bn(Oo,"onTransitionEnd"),Cn("onMouseEnter",["mouseout","mouseover"]),Cn("onMouseLeave",["mouseout","mouseover"]),Cn("onPointerEnter",["pointerout","pointerover"]),Cn("onPointerLeave",["pointerout","pointerover"]),ya("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ya("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ya("onBeforeInput",["compositionend","keypress","textInput","paste"]),ya("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ya("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ya("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qh=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(bd));function Ap(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var l=e[n],o=l.event;l=l.listeners;e:{var s=void 0;if(t)for(var h=l.length-1;0<=h;h--){var j=l[h],P=j.instance,ne=j.currentTarget;if(j=j.listener,P!==s&&o.isPropagationStopped())break e;s=j,o.currentTarget=ne;try{s(o)}catch(be){_o(be)}o.currentTarget=null,s=P}else for(h=0;h<l.length;h++){if(j=l[h],P=j.instance,ne=j.currentTarget,j=j.listener,P!==s&&o.isPropagationStopped())break e;s=j,o.currentTarget=ne;try{s(o)}catch(be){_o(be)}o.currentTarget=null,s=P}}}}function Ot(e,t){var n=t[gs];n===void 0&&(n=t[gs]=new Set);var l=e+"__bubble";n.has(l)||(Np(t,e,2,!1),n.add(l))}function of(e,t,n){var l=0;t&&(l|=4),Np(n,e,l,t)}var uu="_reactListening"+Math.random().toString(36).slice(2);function sf(e){if(!e[uu]){e[uu]=!0,Fa.forEach(function(n){n!=="selectionchange"&&(qh.has(n)||of(n,!1,e),of(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[uu]||(t[uu]=!0,of("selectionchange",!1,t))}}function Np(e,t,n,l){switch(oh(t)){case 2:var o=Tg;break;case 8:o=jg;break;default:o=wf}n=o.bind(null,t,n,e),o=void 0,!zn||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),l?o!==void 0?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):o!==void 0?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function rf(e,t,n,l,o){var s=l;if((t&1)===0&&(t&2)===0&&l!==null)e:for(;;){if(l===null)return;var h=l.tag;if(h===3||h===4){var j=l.stateNode.containerInfo;if(j===o)break;if(h===4)for(h=l.return;h!==null;){var P=h.tag;if((P===3||P===4)&&h.stateNode.containerInfo===o)return;h=h.return}for(;j!==null;){if(h=zl(j),h===null)return;if(P=h.tag,P===5||P===6||P===26||P===27){l=s=h;continue e}j=j.parentNode}}l=l.return}kt(function(){var ne=s,be=Ut(n),we=[];e:{var ie=Yc.get(e);if(ie!==void 0){var de=sr,Ge=e;switch(e){case"keypress":if(va(n)===0)break e;case"keydown":case"keyup":de=ms;break;case"focusin":Ge="focus",de=ma;break;case"focusout":Ge="blur",de=ma;break;case"beforeblur":case"afterblur":de=ma;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":de=Si;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":de=Zi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":de=Ss;break;case ks:case lo:case Po:de=wi;break;case Oo:de=Uu;break;case"scroll":case"scrollend":de=ut;break;case"wheel":de=Ao;break;case"copy":case"cut":case"paste":de=fi;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":de=qa;break;case"toggle":case"beforetoggle":de=Yr}var rt=(t&4)!==0,pn=!rt&&(e==="scroll"||e==="scrollend"),X=rt?ie!==null?ie+"Capture":null:ie;rt=[];for(var V=ne,ee;V!==null;){var me=V;if(ee=me.stateNode,me=me.tag,me!==5&&me!==26&&me!==27||ee===null||X===null||(me=dn(V,X),me!=null&&rt.push(vd(V,me,ee))),pn)break;V=V.return}0<rt.length&&(ie=new de(ie,Ge,null,n,be),we.push({event:ie,listeners:rt}))}}if((t&7)===0){e:{if(ie=e==="mouseover"||e==="pointerover",de=e==="mouseout"||e==="pointerout",ie&&n!==St&&(Ge=n.relatedTarget||n.fromElement)&&(zl(Ge)||Ge[Ia]))break e;if((de||ie)&&(ie=be.window===be?be:(ie=be.ownerDocument)?ie.defaultView||ie.parentWindow:window,de?(Ge=n.relatedTarget||n.toElement,de=ne,Ge=Ge?zl(Ge):null,Ge!==null&&(pn=$(Ge),rt=Ge.tag,Ge!==pn||rt!==5&&rt!==27&&rt!==6)&&(Ge=null)):(de=null,Ge=ne),de!==Ge)){if(rt=Si,me="onMouseLeave",X="onMouseEnter",V="mouse",(e==="pointerout"||e==="pointerover")&&(rt=qa,me="onPointerLeave",X="onPointerEnter",V="pointer"),pn=de==null?ie:Fl(de),ee=Ge==null?ie:Fl(Ge),ie=new rt(me,V+"leave",de,n,be),ie.target=pn,ie.relatedTarget=ee,me=null,zl(be)===ne&&(rt=new rt(X,V+"enter",Ge,n,be),rt.target=ee,rt.relatedTarget=pn,me=rt),pn=me,de&&Ge)t:{for(rt=Zh,X=de,V=Ge,ee=0,me=X;me;me=rt(me))ee++;me=0;for(var lt=V;lt;lt=rt(lt))me++;for(;0<ee-me;)X=rt(X),ee--;for(;0<me-ee;)V=rt(V),me--;for(;ee--;){if(X===V||V!==null&&X===V.alternate){rt=X;break t}X=rt(X),V=rt(V)}rt=null}else rt=null;de!==null&&Mp(we,ie,de,rt,!1),Ge!==null&&pn!==null&&Mp(we,pn,Ge,rt,!0)}}e:{if(ie=ne?Fl(ne):window,de=ie.nodeName&&ie.nodeName.toLowerCase(),de==="select"||de==="input"&&ie.type==="file")var Gt=Pd;else if(yn(ie))if(Ei)Gt=Ii;else{Gt=Rl;var Qe=no}else de=ie.nodeName,!de||de.toLowerCase()!=="input"||ie.type!=="checkbox"&&ie.type!=="radio"?ne&&jt(ne.elementType)&&(Gt=Pd):Gt=qr;if(Gt&&(Gt=Gt(e,ne))){to(we,Gt,n,be);break e}Qe&&Qe(e,ie,ne),e==="focusout"&&ne&&ie.type==="number"&&ne.memoizedProps.value!=null&&Wr(ie,"number",ie.value)}switch(Qe=ne?Fl(ne):window,e){case"focusin":(yn(Qe)||Qe.contentEditable==="true")&&(Ti=Qe,ur=ne,zs=null);break;case"focusout":zs=ur=Ti=null;break;case"mousedown":Zr=!0;break;case"contextmenu":case"mouseup":case"dragend":Zr=!1,Qr(we,n,be);break;case"selectionchange":if(ln)break;case"keydown":case"keyup":Qr(we,n,be)}var Mt;if(Qa)e:{switch(e){case"compositionstart":var Vt="onCompositionStart";break e;case"compositionend":Vt="onCompositionEnd";break e;case"compositionupdate":Vt="onCompositionUpdate";break e}Vt=void 0}else eo?Gr(e,n)&&(Vt="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(Vt="onCompositionStart");Vt&&(Ka&&n.locale!=="ko"&&(eo||Vt!=="onCompositionStart"?Vt==="onCompositionEnd"&&eo&&(Mt=Yl()):(Ll=be,di="value"in Ll?Ll.value:Ll.textContent,eo=!0)),Qe=fu(ne,Vt),0<Qe.length&&(Vt=new Oi(Vt,e,null,n,be),we.push({event:Vt,listeners:Qe}),Mt?Vt.data=Mt:(Mt=Ja(n),Mt!==null&&(Vt.data=Mt)))),(Mt=ws?Ts(e,n):nn(e,n))&&(Vt=fu(ne,"onBeforeInput"),0<Vt.length&&(Qe=new Oi("onBeforeInput","beforeinput",null,n,be),we.push({event:Qe,listeners:Vt}),Qe.data=Mt)),Yh(we,e,ne,n,be)}Ap(we,t)})}function vd(e,t,n){return{instance:e,listener:t,currentTarget:n}}function fu(e,t){for(var n=t+"Capture",l=[];e!==null;){var o=e,s=o.stateNode;if(o=o.tag,o!==5&&o!==26&&o!==27||s===null||(o=dn(e,n),o!=null&&l.unshift(vd(e,o,s)),o=dn(e,t),o!=null&&l.push(vd(e,o,s))),e.tag===3)return l;e=e.return}return[]}function Zh(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Mp(e,t,n,l,o){for(var s=t._reactName,h=[];n!==null&&n!==l;){var j=n,P=j.alternate,ne=j.stateNode;if(j=j.tag,P!==null&&P===l)break;j!==5&&j!==26&&j!==27||ne===null||(P=ne,o?(ne=dn(n,s),ne!=null&&h.unshift(vd(n,ne,P))):o||(ne=dn(n,s),ne!=null&&h.push(vd(n,ne,P)))),n=n.return}h.length!==0&&e.push({event:t,listeners:h})}var Qh=/\r\n?/g,Kh=/\u0000|\uFFFD/g;function Up(e){return(typeof e=="string"?e:""+e).replace(Qh,`
`).replace(Kh,"")}function Bp(e,t){return t=Up(t),Up(e)===t}function fn(e,t,n,l,o,s){switch(n){case"children":typeof l=="string"?t==="body"||t==="textarea"&&l===""||ko(e,l):(typeof l=="number"||typeof l=="bigint")&&t!=="body"&&ko(e,""+l);break;case"className":gn(e,"class",l);break;case"tabIndex":gn(e,"tabindex",l);break;case"dir":case"role":case"viewBox":case"width":case"height":gn(e,n,l);break;case"style":Bd(e,l,s);break;case"data":if(t!=="object"){gn(e,"data",l);break}case"src":case"href":if(l===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(l==null||typeof l=="function"||typeof l=="symbol"||typeof l=="boolean"){e.removeAttribute(n);break}l=Ro(""+l),e.setAttribute(n,l);break;case"action":case"formAction":if(typeof l=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof s=="function"&&(n==="formAction"?(t!=="input"&&fn(e,t,"name",o.name,o,null),fn(e,t,"formEncType",o.formEncType,o,null),fn(e,t,"formMethod",o.formMethod,o,null),fn(e,t,"formTarget",o.formTarget,o,null)):(fn(e,t,"encType",o.encType,o,null),fn(e,t,"method",o.method,o,null),fn(e,t,"target",o.target,o,null)));if(l==null||typeof l=="symbol"||typeof l=="boolean"){e.removeAttribute(n);break}l=Ro(""+l),e.setAttribute(n,l);break;case"onClick":l!=null&&(e.onclick=at);break;case"onScroll":l!=null&&Ot("scroll",e);break;case"onScrollEnd":l!=null&&Ot("scrollend",e);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(d(61));if(n=l.__html,n!=null){if(o.children!=null)throw Error(d(60));e.innerHTML=n}}break;case"multiple":e.multiple=l&&typeof l!="function"&&typeof l!="symbol";break;case"muted":e.muted=l&&typeof l!="function"&&typeof l!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(l==null||typeof l=="function"||typeof l=="boolean"||typeof l=="symbol"){e.removeAttribute("xlink:href");break}n=Ro(""+l),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":l!=null&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(n,""+l):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":l&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":l===!0?e.setAttribute(n,""):l!==!1&&l!=null&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(n,l):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":l!=null&&typeof l!="function"&&typeof l!="symbol"&&!isNaN(l)&&1<=l?e.setAttribute(n,l):e.removeAttribute(n);break;case"rowSpan":case"start":l==null||typeof l=="function"||typeof l=="symbol"||isNaN(l)?e.removeAttribute(n):e.setAttribute(n,l);break;case"popover":Ot("beforetoggle",e),Ot("toggle",e),An(e,"popover",l);break;case"xlinkActuate":ol(e,"http://www.w3.org/1999/xlink","xlink:actuate",l);break;case"xlinkArcrole":ol(e,"http://www.w3.org/1999/xlink","xlink:arcrole",l);break;case"xlinkRole":ol(e,"http://www.w3.org/1999/xlink","xlink:role",l);break;case"xlinkShow":ol(e,"http://www.w3.org/1999/xlink","xlink:show",l);break;case"xlinkTitle":ol(e,"http://www.w3.org/1999/xlink","xlink:title",l);break;case"xlinkType":ol(e,"http://www.w3.org/1999/xlink","xlink:type",l);break;case"xmlBase":ol(e,"http://www.w3.org/XML/1998/namespace","xml:base",l);break;case"xmlLang":ol(e,"http://www.w3.org/XML/1998/namespace","xml:lang",l);break;case"xmlSpace":ol(e,"http://www.w3.org/XML/1998/namespace","xml:space",l);break;case"is":An(e,"is",l);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=Ct.get(n)||n,An(e,n,l))}}function cf(e,t,n,l,o,s){switch(n){case"style":Bd(e,l,s);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(d(61));if(n=l.__html,n!=null){if(o.children!=null)throw Error(d(60));e.innerHTML=n}}break;case"children":typeof l=="string"?ko(e,l):(typeof l=="number"||typeof l=="bigint")&&ko(e,""+l);break;case"onScroll":l!=null&&Ot("scroll",e);break;case"onScrollEnd":l!=null&&Ot("scrollend",e);break;case"onClick":l!=null&&(e.onclick=at);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!$a.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(o=n.endsWith("Capture"),t=n.slice(2,o?n.length-7:void 0),s=e[ri]||null,s=s!=null?s[n]:null,typeof s=="function"&&e.removeEventListener(t,s,o),typeof l=="function")){typeof s!="function"&&s!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,l,o);break e}n in e?e[n]=l:l===!0?e.setAttribute(n,""):An(e,n,l)}}}function Ai(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ot("error",e),Ot("load",e);var l=!1,o=!1,s;for(s in n)if(n.hasOwnProperty(s)){var h=n[s];if(h!=null)switch(s){case"src":l=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(d(137,t));default:fn(e,t,s,h,n,null)}}o&&fn(e,t,"srcSet",n.srcSet,n,null),l&&fn(e,t,"src",n.src,n,null);return;case"input":Ot("invalid",e);var j=s=h=o=null,P=null,ne=null;for(l in n)if(n.hasOwnProperty(l)){var be=n[l];if(be!=null)switch(l){case"name":o=be;break;case"type":h=be;break;case"checked":P=be;break;case"defaultChecked":ne=be;break;case"value":s=be;break;case"defaultValue":j=be;break;case"children":case"dangerouslySetInnerHTML":if(be!=null)throw Error(d(137,t));break;default:fn(e,t,l,be,n,null)}}ys(e,s,j,P,ne,h,o,!1);return;case"select":Ot("invalid",e),l=h=s=null;for(o in n)if(n.hasOwnProperty(o)&&(j=n[o],j!=null))switch(o){case"value":s=j;break;case"defaultValue":h=j;break;case"multiple":l=j;default:fn(e,t,o,j,n,null)}t=s,n=h,e.multiple=!!l,t!=null?ci(e,!!l,t,!1):n!=null&&ci(e,!!l,n,!0);return;case"textarea":Ot("invalid",e),s=o=l=null;for(h in n)if(n.hasOwnProperty(h)&&(j=n[h],j!=null))switch(h){case"value":l=j;break;case"defaultValue":o=j;break;case"children":s=j;break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(d(91));break;default:fn(e,t,h,j,n,null)}Fr(e,l,o,s);return;case"option":for(P in n)if(n.hasOwnProperty(P)&&(l=n[P],l!=null))switch(P){case"selected":e.selected=l&&typeof l!="function"&&typeof l!="symbol";break;default:fn(e,t,P,l,n,null)}return;case"dialog":Ot("beforetoggle",e),Ot("toggle",e),Ot("cancel",e),Ot("close",e);break;case"iframe":case"object":Ot("load",e);break;case"video":case"audio":for(l=0;l<bd.length;l++)Ot(bd[l],e);break;case"image":Ot("error",e),Ot("load",e);break;case"details":Ot("toggle",e);break;case"embed":case"source":case"link":Ot("error",e),Ot("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ne in n)if(n.hasOwnProperty(ne)&&(l=n[ne],l!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":throw Error(d(137,t));default:fn(e,t,ne,l,n,null)}return;default:if(jt(t)){for(be in n)n.hasOwnProperty(be)&&(l=n[be],l!==void 0&&cf(e,t,be,l,n,void 0));return}}for(j in n)n.hasOwnProperty(j)&&(l=n[j],l!=null&&fn(e,t,j,l,n,null))}function Jh(e,t,n,l){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var o=null,s=null,h=null,j=null,P=null,ne=null,be=null;for(de in n){var we=n[de];if(n.hasOwnProperty(de)&&we!=null)switch(de){case"checked":break;case"value":break;case"defaultValue":P=we;default:l.hasOwnProperty(de)||fn(e,t,de,null,l,we)}}for(var ie in l){var de=l[ie];if(we=n[ie],l.hasOwnProperty(ie)&&(de!=null||we!=null))switch(ie){case"type":s=de;break;case"name":o=de;break;case"checked":ne=de;break;case"defaultChecked":be=de;break;case"value":h=de;break;case"defaultValue":j=de;break;case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(d(137,t));break;default:de!==we&&fn(e,t,ie,de,l,we)}}$n(e,h,j,P,ne,be,s,o);return;case"select":de=h=j=ie=null;for(s in n)if(P=n[s],n.hasOwnProperty(s)&&P!=null)switch(s){case"value":break;case"multiple":de=P;default:l.hasOwnProperty(s)||fn(e,t,s,null,l,P)}for(o in l)if(s=l[o],P=n[o],l.hasOwnProperty(o)&&(s!=null||P!=null))switch(o){case"value":ie=s;break;case"defaultValue":j=s;break;case"multiple":h=s;default:s!==P&&fn(e,t,o,s,l,P)}t=j,n=h,l=de,ie!=null?ci(e,!!n,ie,!1):!!l!=!!n&&(t!=null?ci(e,!!n,t,!0):ci(e,!!n,n?[]:"",!1));return;case"textarea":de=ie=null;for(j in n)if(o=n[j],n.hasOwnProperty(j)&&o!=null&&!l.hasOwnProperty(j))switch(j){case"value":break;case"children":break;default:fn(e,t,j,null,l,o)}for(h in l)if(o=l[h],s=n[h],l.hasOwnProperty(h)&&(o!=null||s!=null))switch(h){case"value":ie=o;break;case"defaultValue":de=o;break;case"children":break;case"dangerouslySetInnerHTML":if(o!=null)throw Error(d(91));break;default:o!==s&&fn(e,t,h,o,l,s)}Ec(e,ie,de);return;case"option":for(var Ge in n)if(ie=n[Ge],n.hasOwnProperty(Ge)&&ie!=null&&!l.hasOwnProperty(Ge))switch(Ge){case"selected":e.selected=!1;break;default:fn(e,t,Ge,null,l,ie)}for(P in l)if(ie=l[P],de=n[P],l.hasOwnProperty(P)&&ie!==de&&(ie!=null||de!=null))switch(P){case"selected":e.selected=ie&&typeof ie!="function"&&typeof ie!="symbol";break;default:fn(e,t,P,ie,l,de)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var rt in n)ie=n[rt],n.hasOwnProperty(rt)&&ie!=null&&!l.hasOwnProperty(rt)&&fn(e,t,rt,null,l,ie);for(ne in l)if(ie=l[ne],de=n[ne],l.hasOwnProperty(ne)&&ie!==de&&(ie!=null||de!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(d(137,t));break;default:fn(e,t,ne,ie,l,de)}return;default:if(jt(t)){for(var pn in n)ie=n[pn],n.hasOwnProperty(pn)&&ie!==void 0&&!l.hasOwnProperty(pn)&&cf(e,t,pn,void 0,l,ie);for(be in l)ie=l[be],de=n[be],!l.hasOwnProperty(be)||ie===de||ie===void 0&&de===void 0||cf(e,t,be,ie,l,de);return}}for(var X in n)ie=n[X],n.hasOwnProperty(X)&&ie!=null&&!l.hasOwnProperty(X)&&fn(e,t,X,null,l,ie);for(we in l)ie=l[we],de=n[we],!l.hasOwnProperty(we)||ie===de||ie==null&&de==null||fn(e,t,we,ie,l,de)}function Pp(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function eg(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,n=performance.getEntriesByType("resource"),l=0;l<n.length;l++){var o=n[l],s=o.transferSize,h=o.initiatorType,j=o.duration;if(s&&j&&Pp(h)){for(h=0,j=o.responseEnd,l+=1;l<n.length;l++){var P=n[l],ne=P.startTime;if(ne>j)break;var be=P.transferSize,we=P.initiatorType;be&&Pp(we)&&(P=P.responseEnd,h+=be*(P<j?1:(j-ne)/(P-ne)))}if(--l,t+=8*(s+h)/(o.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var df=null,uf=null;function pu(e){return e.nodeType===9?e:e.ownerDocument}function Op(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function _p(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function ff(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var pf=null;function tg(){var e=window.event;return e&&e.type==="popstate"?e===pf?!1:(pf=e,!0):(pf=null,!1)}var Hp=typeof setTimeout=="function"?setTimeout:void 0,ng=typeof clearTimeout=="function"?clearTimeout:void 0,Ep=typeof Promise=="function"?Promise:void 0,ig=typeof queueMicrotask=="function"?queueMicrotask:typeof Ep<"u"?function(e){return Ep.resolve(null).then(e).catch(lg)}:Hp;function lg(e){setTimeout(function(){throw e})}function Js(e){return e==="head"}function Vp(e,t){var n=t,l=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"||n==="/&"){if(l===0){e.removeChild(o),Bc(t);return}l--}else if(n==="$"||n==="$?"||n==="$~"||n==="$!"||n==="&")l++;else if(n==="html")md(e.ownerDocument.documentElement);else if(n==="head"){n=e.ownerDocument.head,md(n);for(var s=n.firstChild;s;){var h=s.nextSibling,j=s.nodeName;s[Wl]||j==="SCRIPT"||j==="STYLE"||j==="LINK"&&s.rel.toLowerCase()==="stylesheet"||n.removeChild(s),s=h}}else n==="body"&&md(e.ownerDocument.body);n=o}while(n);Bc(t)}function Ip(e,t){var n=e;e=0;do{var l=n.nextSibling;if(n.nodeType===1?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",n.getAttribute("style")===""&&n.removeAttribute("style")):n.nodeType===3&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),l&&l.nodeType===8)if(n=l.data,n==="/$"){if(e===0)break;e--}else n!=="$"&&n!=="$?"&&n!=="$~"&&n!=="$!"||e++;n=l}while(n)}function hf(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":hf(n),Xt(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function ag(e,t,n,l){for(;e.nodeType===1;){var o=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!l&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(l){if(!e[Wl])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(s=e.getAttribute("rel"),s==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(s!==o.rel||e.getAttribute("href")!==(o.href==null||o.href===""?null:o.href)||e.getAttribute("crossorigin")!==(o.crossOrigin==null?null:o.crossOrigin)||e.getAttribute("title")!==(o.title==null?null:o.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(s=e.getAttribute("src"),(s!==(o.src==null?null:o.src)||e.getAttribute("type")!==(o.type==null?null:o.type)||e.getAttribute("crossorigin")!==(o.crossOrigin==null?null:o.crossOrigin))&&s&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var s=o.name==null?null:""+o.name;if(o.type==="hidden"&&e.getAttribute("name")===s)return e}else return e;if(e=ua(e.nextSibling),e===null)break}return null}function og(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=ua(e.nextSibling),e===null))return null;return e}function Wp(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=ua(e.nextSibling),e===null))return null;return e}function gf(e){return e.data==="$?"||e.data==="$~"}function xf(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function sg(e,t){var n=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||n.readyState!=="loading")t();else{var l=function(){t(),n.removeEventListener("DOMContentLoaded",l)};n.addEventListener("DOMContentLoaded",l),e._reactRetry=l}}function ua(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var yf=null;function Fp(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"||n==="/&"){if(t===0)return ua(e.nextSibling);t--}else n!=="$"&&n!=="$!"&&n!=="$?"&&n!=="$~"&&n!=="&"||t++}e=e.nextSibling}return null}function $p(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"){if(t===0)return e;t--}else n!=="/$"&&n!=="/&"||t++}e=e.previousSibling}return null}function Lp(e,t,n){switch(t=pu(n),e){case"html":if(e=t.documentElement,!e)throw Error(d(452));return e;case"head":if(e=t.head,!e)throw Error(d(453));return e;case"body":if(e=t.body,!e)throw Error(d(454));return e;default:throw Error(d(451))}}function md(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Xt(e)}var fa=new Map,Yp=new Set;function hu(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var ds=O.d;O.d={f:rg,r:cg,D:dg,C:ug,L:fg,m:pg,X:gg,S:hg,M:xg};function rg(){var e=ds.f(),t=au();return e||t}function cg(e){var t=tn(e);t!==null&&t.tag===5&&t.type==="form"?mc(t):ds.r(e)}var Nc=typeof document>"u"?null:document;function Xp(e,t,n){var l=Nc;if(l&&typeof t=="string"&&t){var o=Ne(t);o='link[rel="'+e+'"][href="'+o+'"]',typeof n=="string"&&(o+='[crossorigin="'+n+'"]'),Yp.has(o)||(Yp.add(o),e={rel:e,crossOrigin:n,href:t},l.querySelector(o)===null&&(t=l.createElement("link"),Ai(t,"link",e),jn(t),l.head.appendChild(t)))}}function dg(e){ds.D(e),Xp("dns-prefetch",e,null)}function ug(e,t){ds.C(e,t),Xp("preconnect",e,t)}function fg(e,t,n){ds.L(e,t,n);var l=Nc;if(l&&e&&t){var o='link[rel="preload"][as="'+Ne(t)+'"]';t==="image"&&n&&n.imageSrcSet?(o+='[imagesrcset="'+Ne(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(o+='[imagesizes="'+Ne(n.imageSizes)+'"]')):o+='[href="'+Ne(e)+'"]';var s=o;switch(t){case"style":s=Mc(e);break;case"script":s=Uc(e)}fa.has(s)||(e=ve({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),fa.set(s,e),l.querySelector(o)!==null||t==="style"&&l.querySelector(Sd(s))||t==="script"&&l.querySelector(wd(s))||(t=l.createElement("link"),Ai(t,"link",e),jn(t),l.head.appendChild(t)))}}function pg(e,t){ds.m(e,t);var n=Nc;if(n&&e){var l=t&&typeof t.as=="string"?t.as:"script",o='link[rel="modulepreload"][as="'+Ne(l)+'"][href="'+Ne(e)+'"]',s=o;switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":s=Uc(e)}if(!fa.has(s)&&(e=ve({rel:"modulepreload",href:e},t),fa.set(s,e),n.querySelector(o)===null)){switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(wd(s)))return}l=n.createElement("link"),Ai(l,"link",e),jn(l),n.head.appendChild(l)}}}function hg(e,t,n){ds.S(e,t,n);var l=Nc;if(l&&e){var o=al(l).hoistableStyles,s=Mc(e);t=t||"default";var h=o.get(s);if(!h){var j={loading:0,preload:null};if(h=l.querySelector(Sd(s)))j.loading=5;else{e=ve({rel:"stylesheet",href:e,"data-precedence":t},n),(n=fa.get(s))&&bf(e,n);var P=h=l.createElement("link");jn(P),Ai(P,"link",e),P._p=new Promise(function(ne,be){P.onload=ne,P.onerror=be}),P.addEventListener("load",function(){j.loading|=1}),P.addEventListener("error",function(){j.loading|=2}),j.loading|=4,gu(h,t,l)}h={type:"stylesheet",instance:h,count:1,state:j},o.set(s,h)}}}function gg(e,t){ds.X(e,t);var n=Nc;if(n&&e){var l=al(n).hoistableScripts,o=Uc(e),s=l.get(o);s||(s=n.querySelector(wd(o)),s||(e=ve({src:e,async:!0},t),(t=fa.get(o))&&vf(e,t),s=n.createElement("script"),jn(s),Ai(s,"link",e),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},l.set(o,s))}}function xg(e,t){ds.M(e,t);var n=Nc;if(n&&e){var l=al(n).hoistableScripts,o=Uc(e),s=l.get(o);s||(s=n.querySelector(wd(o)),s||(e=ve({src:e,async:!0,type:"module"},t),(t=fa.get(o))&&vf(e,t),s=n.createElement("script"),jn(s),Ai(s,"link",e),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},l.set(o,s))}}function Gp(e,t,n,l){var o=(o=et.current)?hu(o):null;if(!o)throw Error(d(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=Mc(n.href),n=al(o).hoistableStyles,l=n.get(t),l||(l={type:"style",instance:null,count:0,state:null},n.set(t,l)),l):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=Mc(n.href);var s=al(o).hoistableStyles,h=s.get(e);if(h||(o=o.ownerDocument||o,h={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},s.set(e,h),(s=o.querySelector(Sd(e)))&&!s._p&&(h.instance=s,h.state.loading=5),fa.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},fa.set(e,n),s||yg(o,e,n,h.state))),t&&l===null)throw Error(d(528,""));return h}if(t&&l!==null)throw Error(d(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Uc(n),n=al(o).hoistableScripts,l=n.get(t),l||(l={type:"script",instance:null,count:0,state:null},n.set(t,l)),l):{type:"void",instance:null,count:0,state:null};default:throw Error(d(444,e))}}function Mc(e){return'href="'+Ne(e)+'"'}function Sd(e){return'link[rel="stylesheet"]['+e+"]"}function qp(e){return ve({},e,{"data-precedence":e.precedence,precedence:null})}function yg(e,t,n,l){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?l.loading=1:(t=e.createElement("link"),l.preload=t,t.addEventListener("load",function(){return l.loading|=1}),t.addEventListener("error",function(){return l.loading|=2}),Ai(t,"link",n),jn(t),e.head.appendChild(t))}function Uc(e){return'[src="'+Ne(e)+'"]'}function wd(e){return"script[async]"+e}function Zp(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var l=e.querySelector('style[data-href~="'+Ne(n.href)+'"]');if(l)return t.instance=l,jn(l),l;var o=ve({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return l=(e.ownerDocument||e).createElement("style"),jn(l),Ai(l,"style",o),gu(l,n.precedence,e),t.instance=l;case"stylesheet":o=Mc(n.href);var s=e.querySelector(Sd(o));if(s)return t.state.loading|=4,t.instance=s,jn(s),s;l=qp(n),(o=fa.get(o))&&bf(l,o),s=(e.ownerDocument||e).createElement("link"),jn(s);var h=s;return h._p=new Promise(function(j,P){h.onload=j,h.onerror=P}),Ai(s,"link",l),t.state.loading|=4,gu(s,n.precedence,e),t.instance=s;case"script":return s=Uc(n.src),(o=e.querySelector(wd(s)))?(t.instance=o,jn(o),o):(l=n,(o=fa.get(s))&&(l=ve({},n),vf(l,o)),e=e.ownerDocument||e,o=e.createElement("script"),jn(o),Ai(o,"link",l),e.head.appendChild(o),t.instance=o);case"void":return null;default:throw Error(d(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(l=t.instance,t.state.loading|=4,gu(l,n.precedence,e));return t.instance}function gu(e,t,n){for(var l=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),o=l.length?l[l.length-1]:null,s=o,h=0;h<l.length;h++){var j=l[h];if(j.dataset.precedence===t)s=j;else if(s!==o)break}s?s.parentNode.insertBefore(e,s.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function bf(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function vf(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var xu=null;function Qp(e,t,n){if(xu===null){var l=new Map,o=xu=new Map;o.set(n,l)}else o=xu,l=o.get(n),l||(l=new Map,o.set(n,l));if(l.has(e))return l;for(l.set(e,null),n=n.getElementsByTagName(e),o=0;o<n.length;o++){var s=n[o];if(!(s[Wl]||s[Fn]||e==="link"&&s.getAttribute("rel")==="stylesheet")&&s.namespaceURI!=="http://www.w3.org/2000/svg"){var h=s.getAttribute(t)||"";h=e+h;var j=l.get(h);j?j.push(s):l.set(h,[s])}}return l}function Kp(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function bg(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function Jp(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function vg(e,t,n,l){if(n.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var o=Mc(l.href),s=t.querySelector(Sd(o));if(s){t=s._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=yu.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=s,jn(s);return}s=t.ownerDocument||t,l=qp(l),(o=fa.get(o))&&bf(l,o),s=s.createElement("link"),jn(s);var h=s;h._p=new Promise(function(j,P){h.onload=j,h.onerror=P}),Ai(s,"link",l),n.instance=s}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&(n.state.loading&3)===0&&(e.count++,n=yu.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}var mf=0;function mg(e,t){return e.stylesheets&&e.count===0&&vu(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var l=setTimeout(function(){if(e.stylesheets&&vu(e,e.stylesheets),e.unsuspend){var s=e.unsuspend;e.unsuspend=null,s()}},6e4+t);0<e.imgBytes&&mf===0&&(mf=62500*eg());var o=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&vu(e,e.stylesheets),e.unsuspend)){var s=e.unsuspend;e.unsuspend=null,s()}},(e.imgBytes>mf?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(l),clearTimeout(o)}}:null}function yu(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)vu(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var bu=null;function vu(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,bu=new Map,t.forEach(Sg,e),bu=null,yu.call(e))}function Sg(e,t){if(!(t.state.loading&4)){var n=bu.get(e);if(n)var l=n.get(null);else{n=new Map,bu.set(e,n);for(var o=e.querySelectorAll("link[data-precedence],style[data-precedence]"),s=0;s<o.length;s++){var h=o[s];(h.nodeName==="LINK"||h.getAttribute("media")!=="not all")&&(n.set(h.dataset.precedence,h),l=h)}l&&n.set(null,l)}o=t.instance,h=o.getAttribute("data-precedence"),s=n.get(h)||l,s===l&&n.set(null,o),n.set(h,o),this.count++,l=yu.bind(this),o.addEventListener("load",l),o.addEventListener("error",l),s?s.parentNode.insertBefore(o,s.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(o,e.firstChild)),t.state.loading|=4}}var Td={$$typeof:ge,Provider:null,Consumer:null,_currentValue:W,_currentValue2:W,_threadCount:0};function wg(e,t,n,l,o,s,h,j,P){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Va(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Va(0),this.hiddenUpdates=Va(null),this.identifierPrefix=l,this.onUncaughtError=o,this.onCaughtError=s,this.onRecoverableError=h,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=P,this.incompleteTransitions=new Map}function eh(e,t,n,l,o,s,h,j,P,ne,be,we){return e=new wg(e,t,n,h,P,ne,be,we,j),t=1,s===!0&&(t|=24),s=gi(3,null,null,t),e.current=s,s.stateNode=e,t=fo(),t.refCount++,e.pooledCache=t,t.refCount++,s.memoizedState={element:l,isDehydrated:n,cache:t},Ul(s),e}function th(e){return e?(e=Vo,e):Vo}function nh(e,t,n,l,o,s){o=th(o),l.context===null?l.context=o:l.pendingContext=o,l=bo(t),l.payload={element:n},s=s===void 0?null:s,s!==null&&(l.callback=s),n=vo(e,l,t),n!==null&&(Sl(n,e,t),Cr(n,e,t))}function ih(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Sf(e,t){ih(e,t),(e=e.alternate)&&ih(e,t)}function lh(e){if(e.tag===13||e.tag===31){var t=Eo(e,67108864);t!==null&&Sl(t,e,67108864),Sf(e,67108864)}}function ah(e){if(e.tag===13||e.tag===31){var t=Hl();t=ar(t);var n=Eo(e,t);n!==null&&Sl(n,e,t),Sf(e,t)}}var mu=!0;function Tg(e,t,n,l){var o=_.T;_.T=null;var s=O.p;try{O.p=2,wf(e,t,n,l)}finally{O.p=s,_.T=o}}function jg(e,t,n,l){var o=_.T;_.T=null;var s=O.p;try{O.p=8,wf(e,t,n,l)}finally{O.p=s,_.T=o}}function wf(e,t,n,l){if(mu){var o=Tf(l);if(o===null)rf(e,t,l,Su,n),sh(e,l);else if(zg(o,e,t,n,l))l.stopPropagation();else if(sh(e,l),t&4&&-1<Cg.indexOf(e)){for(;o!==null;){var s=tn(o);if(s!==null)switch(s.tag){case 3:if(s=s.stateNode,s.current.memoizedState.isDehydrated){var h=Cl(s.pendingLanes);if(h!==0){var j=s;for(j.pendingLanes|=2,j.entangledLanes|=2;h;){var P=1<<31-Rn(h);j.entanglements[1]|=P,h&=~P}Co(s),(Jt&6)===0&&(iu=mi()+500,yd(0))}}break;case 31:case 13:j=Eo(s,2),j!==null&&Sl(j,s,2),au(),Sf(s,2)}if(s=Tf(l),s===null&&rf(e,t,l,Su,n),s===o)break;o=s}o!==null&&l.stopPropagation()}else rf(e,t,l,null,n)}}function Tf(e){return e=Ut(e),jf(e)}var Su=null;function jf(e){if(Su=null,e=zl(e),e!==null){var t=$(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=Se(t),e!==null)return e;e=null}else if(n===31){if(e=ye(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Su=e,null}function oh(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(fs()){case Vr:return 2;case qe:return 8;case mt:case Hc:return 32;case $e:return 268435456;default:return 32}default:return 32}}var Cf=!1,er=null,tr=null,nr=null,jd=new Map,Cd=new Map,ir=[],Cg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function sh(e,t){switch(e){case"focusin":case"focusout":er=null;break;case"dragenter":case"dragleave":tr=null;break;case"mouseover":case"mouseout":nr=null;break;case"pointerover":case"pointerout":jd.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Cd.delete(t.pointerId)}}function zd(e,t,n,l,o,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:l,nativeEvent:s,targetContainers:[o]},t!==null&&(t=tn(t),t!==null&&lh(t)),e):(e.eventSystemFlags|=l,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function zg(e,t,n,l,o){switch(t){case"focusin":return er=zd(er,e,t,n,l,o),!0;case"dragenter":return tr=zd(tr,e,t,n,l,o),!0;case"mouseover":return nr=zd(nr,e,t,n,l,o),!0;case"pointerover":var s=o.pointerId;return jd.set(s,zd(jd.get(s)||null,e,t,n,l,o)),!0;case"gotpointercapture":return s=o.pointerId,Cd.set(s,zd(Cd.get(s)||null,e,t,n,l,o)),!0}return!1}function rh(e){var t=zl(e.target);if(t!==null){var n=$(t);if(n!==null){if(t=n.tag,t===13){if(t=Se(n),t!==null){e.blockedOn=t,At(e.priority,function(){ah(n)});return}}else if(t===31){if(t=ye(n),t!==null){e.blockedOn=t,At(e.priority,function(){ah(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function wu(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Tf(e.nativeEvent);if(n===null){n=e.nativeEvent;var l=new n.constructor(n.type,n);St=l,n.target.dispatchEvent(l),St=null}else return t=tn(n),t!==null&&lh(t),e.blockedOn=n,!1;t.shift()}return!0}function ch(e,t,n){wu(e)&&n.delete(t)}function kg(){Cf=!1,er!==null&&wu(er)&&(er=null),tr!==null&&wu(tr)&&(tr=null),nr!==null&&wu(nr)&&(nr=null),jd.forEach(ch),Cd.forEach(ch)}function Tu(e,t){e.blockedOn===t&&(e.blockedOn=null,Cf||(Cf=!0,c.unstable_scheduleCallback(c.unstable_NormalPriority,kg)))}var ju=null;function dh(e){ju!==e&&(ju=e,c.unstable_scheduleCallback(c.unstable_NormalPriority,function(){ju===e&&(ju=null);for(var t=0;t<e.length;t+=3){var n=e[t],l=e[t+1],o=e[t+2];if(typeof l!="function"){if(jf(l||n)===null)continue;break}var s=tn(n);s!==null&&(e.splice(t,3),t-=3,es(s,{pending:!0,data:o,method:n.method,action:l},l,o))}}))}function Bc(e){function t(P){return Tu(P,e)}er!==null&&Tu(er,e),tr!==null&&Tu(tr,e),nr!==null&&Tu(nr,e),jd.forEach(t),Cd.forEach(t);for(var n=0;n<ir.length;n++){var l=ir[n];l.blockedOn===e&&(l.blockedOn=null)}for(;0<ir.length&&(n=ir[0],n.blockedOn===null);)rh(n),n.blockedOn===null&&ir.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(l=0;l<n.length;l+=3){var o=n[l],s=n[l+1],h=o[ri]||null;if(typeof s=="function")h||dh(n);else if(h){var j=null;if(s&&s.hasAttribute("formAction")){if(o=s,h=s[ri]||null)j=h.formAction;else if(jf(o)!==null)continue}else j=h.action;typeof j=="function"?n[l+1]=j:(n.splice(l,3),l-=3),dh(n)}}}function uh(){function e(s){s.canIntercept&&s.info==="react-transition"&&s.intercept({handler:function(){return new Promise(function(h){return o=h})},focusReset:"manual",scroll:"manual"})}function t(){o!==null&&(o(),o=null),l||setTimeout(n,20)}function n(){if(!l&&!navigation.transition){var s=navigation.currentEntry;s&&s.url!=null&&navigation.navigate(s.url,{state:s.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var l=!1,o=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){l=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),o!==null&&(o(),o=null)}}}function zf(e){this._internalRoot=e}Cu.prototype.render=zf.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(d(409));var n=t.current,l=Hl();nh(n,l,e,t,null,null)},Cu.prototype.unmount=zf.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;nh(e.current,2,null,e,null,null),au(),t[Ia]=null}};function Cu(e){this._internalRoot=e}Cu.prototype.unstable_scheduleHydration=function(e){if(e){var t=ll();e={blockedOn:null,target:e,priority:t};for(var n=0;n<ir.length&&t!==0&&t<ir[n].priority;n++);ir.splice(n,0,e),n===0&&rh(e)}};var fh=u.version;if(fh!=="19.2.0")throw Error(d(527,fh,"19.2.0"));O.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(d(188)):(e=Object.keys(e).join(","),Error(d(268,e)));return e=I(t),e=e!==null?ue(e):null,e=e===null?null:e.stateNode,e};var Rg={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:_,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zu.isDisabled&&zu.supportsFiber)try{Xi=zu.inject(Rg),pt=zu}catch{}}return Rd.createRoot=function(e,t){if(!D(e))throw Error(d(299));var n=!1,l="",o=Qd,s=dd,h=Kd;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(l=t.identifierPrefix),t.onUncaughtError!==void 0&&(o=t.onUncaughtError),t.onCaughtError!==void 0&&(s=t.onCaughtError),t.onRecoverableError!==void 0&&(h=t.onRecoverableError)),t=eh(e,1,!1,null,null,n,l,null,o,s,h,uh),e[Ia]=t.current,sf(e),new zf(t)},Rd.hydrateRoot=function(e,t,n){if(!D(e))throw Error(d(299));var l=!1,o="",s=Qd,h=dd,j=Kd,P=null;return n!=null&&(n.unstable_strictMode===!0&&(l=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onUncaughtError!==void 0&&(s=n.onUncaughtError),n.onCaughtError!==void 0&&(h=n.onCaughtError),n.onRecoverableError!==void 0&&(j=n.onRecoverableError),n.formState!==void 0&&(P=n.formState)),t=eh(e,1,!0,t,n??null,l,o,P,s,h,j,uh),t.context=th(null),n=t.current,l=Hl(),l=ar(l),o=bo(l),o.callback=null,vo(n,o,l),n=l,t.current.lanes=n,Gi(t,n),Co(t),e[Ia]=t.current,sf(e),new Cu(t)},Rd.version="19.2.0",Rd}var wh;function Eg(){if(wh)return Df.exports;wh=1;function c(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(c)}catch(u){console.error(u)}}return c(),Df.exports=Hg(),Df.exports}var Vg=Eg();/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ig=c=>c.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Wg=c=>c.replace(/^([A-Z])|[\s-_]+(\w)/g,(u,b,d)=>d?d.toUpperCase():b.toLowerCase()),Th=c=>{const u=Wg(c);return u.charAt(0).toUpperCase()+u.slice(1)},Rh=(...c)=>c.filter((u,b,d)=>!!u&&u.trim()!==""&&d.indexOf(u)===b).join(" ").trim(),Fg=c=>{for(const u in c)if(u.startsWith("aria-")||u==="role"||u==="title")return!0};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var $g={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lg=w.forwardRef(({color:c="currentColor",size:u=24,strokeWidth:b=2,absoluteStrokeWidth:d,className:D="",children:$,iconNode:Se,...ye},g)=>w.createElement("svg",{ref:g,...$g,width:u,height:u,stroke:c,strokeWidth:d?Number(b)*24/Number(u):b,className:Rh("lucide",D),...!$&&!Fg(ye)&&{"aria-hidden":"true"},...ye},[...Se.map(([I,ue])=>w.createElement(I,ue)),...Array.isArray($)?$:[$]]));/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dh=(c,u)=>{const b=w.forwardRef(({className:d,...D},$)=>w.createElement(Lg,{ref:$,iconNode:u,className:Rh(`lucide-${Ig(Th(c))}`,`lucide-${c}`,d),...D}));return b.displayName=Th(c),b};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yg=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],Xg=Dh("mouse-pointer",Yg);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gg=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],qg=Dh("pen-line",Gg),Uf="#2CA02C",Zg="#F0E442",Qg="#00BFC4",Bf="#000000",Kg="#00008b",Pf="#FF0000",Ah={DEFAULT_SIZE:18},Ud={Battery:{prefix:["B","BT"],defaultPins:2},Capacitor:{prefix:["C"],defaultPins:2},"Electrolytic Capacitor":{prefix:["C","CE"],defaultPins:2},"Film Capacitor":{prefix:["C","CF"],defaultPins:2},Diode:{prefix:["D","CR"],defaultPins:2},Fuse:{prefix:["F"],defaultPins:2},FerriteBead:{prefix:["FB"],defaultPins:2},Connector:{prefix:["J","P"],defaultPins:4},Jumper:{prefix:["JP"],defaultPins:3},Relay:{prefix:["K"],defaultPins:5},Inductor:{prefix:["L"],defaultPins:2},Speaker:{prefix:["LS"],defaultPins:2},Motor:{prefix:["M"],defaultPins:2},PowerSupply:{prefix:["PS"],defaultPins:4},Transistor:{prefix:["Q"],defaultPins:3},Resistor:{prefix:["R"],defaultPins:2},ResistorNetwork:{prefix:["RN"],defaultPins:8},Thermistor:{prefix:["RT"],defaultPins:2},Switch:{prefix:["S","SW"],defaultPins:2},Transformer:{prefix:["T"],defaultPins:4},TestPoint:{prefix:["TP"],defaultPins:1},IntegratedCircuit:{prefix:["U","IC"],defaultPins:8},VacuumTube:{prefix:["V"],defaultPins:5},VariableResistor:{prefix:["VR"],defaultPins:3},Crystal:{prefix:["X","XTAL","Y"],defaultPins:2},ZenerDiode:{prefix:["Z"],defaultPins:2}},Jg={Capacitors:{General:["Capacitor"],Electrolytic:["Electrolytic Capacitor"],Film:["Film Capacitor"],Tantalum:["Capacitor"]},Diodes:{Standard:["Diode"],Zener:["ZenerDiode"],LED:["Diode"],Schottky:["Diode"]},Resistors:{Standard:["Resistor"],Network:["ResistorNetwork"],Thermistor:["Thermistor"],Variable:["VariableResistor"]},Semiconductors:{Transistor:["Transistor"],"Integrated Circuit":["IntegratedCircuit"]},"Passive Components":{Inductor:["Inductor"],"Ferrite Bead":["FerriteBead"],Crystal:["Crystal"]},"Power & Energy":{Battery:["Battery"],"Power Supply":["PowerSupply"],Fuse:["Fuse"]},"Connectors & Switches":{Connector:["Connector"],Jumper:["Jumper"],Switch:["Switch"],Relay:["Relay"]},Other:{Transformer:["Transformer"],Speaker:["Speaker"],Motor:["Motor"],"Test Point":["TestPoint"],"Vacuum Tube":["VacuumTube"]}},Of={DEFAULT_SIZE:18},Nh={resistance:{validUnits:["","m","k","M"],defaultUnit:""},capacitance:{validUnits:["pF","nF","F","mF","F"],defaultUnit:"F"},voltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},current:{validUnits:["A","mA","A"],defaultUnit:"A"},power:{validUnits:["W","mW","kW"],defaultUnit:"W"},inductance:{validUnits:["nH","H","mH","H"],defaultUnit:"H"},impedance:{validUnits:["","m","k"],defaultUnit:""},capacity:{validUnits:["mAh","Ah"],defaultUnit:"mAh"},inputVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},outputVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},coilVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},primaryVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},secondaryVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},esr:{validUnits:["m",""],defaultUnit:""}};function $t(c){return Nh[c]?.validUnits||[]}function Ye(c){return Nh[c]?.defaultUnit||""}function Md(c){return c.includes(" ")?c:c.replace(/([a-z])([A-Z])/g,"$1 $2")}let _c=1,Du=Promise.resolve(0);function Yi(){let c;Du=Du.then(b=>(c=b+1,_c=c+1,c));const u=_c;return _c=u+1,u}function Dd(c){Du=Du.then(()=>(_c=c,c-1)),_c=c}function jh(){return _c}function ex(c="id"){return`${c}-${Date.now()}-${Math.random().toString(36).slice(2,11)}`}function Ch(c){return Math.round(c*1e4)/1e4}function _t(c){return{x:Ch(c.x),y:Ch(c.y)}}function tx(c){return Ud[c]?.defaultPins||2}function Ru(c){return(Ud[c]?.prefix||["?"])[0]}function nx(c,u,b,d,D,$=Ah.DEFAULT_SIZE,Se=[],ye=Nd(),g=!0){let I="";if(g){const je=Ru(c),Ae=lx(je,Se,ye);I=`${je}${Ae}`}const ue={id:ex("comp"),componentType:c,designator:I,layer:u,x:b,y:d,color:D,size:$,pinCount:tx(c),pinConnections:[],orientation:0};switch(ue.pinConnections=new Array(ue.pinCount).fill(""),(c==="Electrolytic Capacitor"||c==="Diode"||c==="Battery"||c==="ZenerDiode")&&(ue.pinPolarities=new Array(ue.pinCount).fill("")),c){case"Battery":return{...ue,componentType:"Battery"};case"Capacitor":return{...ue,componentType:"Capacitor"};case"Electrolytic Capacitor":return{...ue,componentType:"Electrolytic Capacitor",polarity:"Positive"};case"Diode":return{...ue,componentType:"Diode",diodeType:"Standard"};case"Fuse":return{...ue,componentType:"Fuse"};case"FerriteBead":return{...ue,componentType:"FerriteBead"};case"Connector":return{...ue,componentType:"Connector",gender:"N/A"};case"Jumper":return{...ue,componentType:"Jumper"};case"Relay":return{...ue,componentType:"Relay"};case"Inductor":return{...ue,componentType:"Inductor"};case"Speaker":return{...ue,componentType:"Speaker"};case"Motor":return{...ue,componentType:"Motor"};case"PowerSupply":return{...ue,componentType:"PowerSupply"};case"Transistor":return{...ue,componentType:"Transistor",transistorType:"BJT"};case"Resistor":return{...ue,componentType:"Resistor"};case"ResistorNetwork":return{...ue,componentType:"ResistorNetwork"};case"Thermistor":return{...ue,componentType:"Thermistor",thermistorType:"NTC"};case"Switch":return{...ue,componentType:"Switch"};case"Transformer":return{...ue,componentType:"Transformer"};case"TestPoint":return{...ue,componentType:"TestPoint"};case"IntegratedCircuit":return{...ue,componentType:"IntegratedCircuit"};case"VacuumTube":return{...ue,componentType:"VacuumTube"};case"VariableResistor":return{...ue,componentType:"VariableResistor",vrType:"Potentiometer"};case"Crystal":return{...ue,componentType:"Crystal"};case"ZenerDiode":return{...ue,componentType:"ZenerDiode"};default:return{...ue,componentType:"Resistor"}}}function Hf(c,u,b){const d=c.componentType==="Electrolytic Capacitor"||c.componentType==="Diode"||c.componentType==="Battery"||c.componentType==="ZenerDiode",D=c.componentType==="Capacitor"&&"dielectric"in c&&c.dielectric==="Tantalum";if(!(d||D)||c.pinCount!==2||!(u.length===2&&u[0]&&u[0].trim()!==""&&u[1]&&u[1].trim()!==""))return null;const Se=je=>{const Ae=parseInt(je,10);if(isNaN(Ae))return null;for(const le of b)if((le.type==="via"||le.type==="pad")&&le.points.length>0){const Me=le.points[0];if(Me.id===Ae)return{x:Me.x,y:Me.y}}return null},ye=Se(u[0]),g=Se(u[1]);if(!ye||!g)return null;const I=Math.hypot(c.x-ye.x,c.y-ye.y),ue=Math.hypot(c.x-g.x,c.y-g.y),ve=["",""];return I<ue?(ve[0]="-",ve[1]="+"):(ve[0]="+",ve[1]="-"),ve}function Nd(){return{}}function ix(c){}function lx(c,u,b){let d=0;for(const $ of u)if($.designator){const Se=$.designator.match(new RegExp(`^${c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(\\d+)$`));if(Se){const ye=parseInt(Se[1],10);ye>d&&(d=ye)}}const D=b[c]||0;return Math.max(d,D)+1}function ax(c,u,b){const d={...b};return d[c]=Math.max(d[c]||0,u),d}function ox(){const c=document.createElement("canvas"),u=24;c.width=u,c.height=u;const b=c.getContext("2d");b.strokeStyle="#000",b.lineWidth=3,b.lineCap="round";const d=u/2,D=8;return b.beginPath(),b.moveTo(d,d-D),b.lineTo(d,d-2),b.moveTo(d,d+2),b.lineTo(d,d+D),b.moveTo(d-D,d),b.lineTo(d-2,d),b.moveTo(d+2,d),b.lineTo(d+D,d),b.stroke(),`url(${c.toDataURL()}) ${d} ${d}, crosshair`}function sx(c){const u=document.createElement("canvas"),b=Math.max(12,Math.min(c,32)),D=b+4*2;u.width=D,u.height=D;const $=u.getContext("2d"),Se=D/2,ye=D/2,g=b/2;return $.fillStyle="#FFFF00",$.strokeStyle="#000000",$.lineWidth=2,$.beginPath(),$.moveTo(Se,ye-g),$.lineTo(Se+g,ye),$.lineTo(Se,ye+g),$.lineTo(Se-g,ye),$.closePath(),$.fill(),$.stroke(),`url(${u.toDataURL()}) ${Se} ${ye}, crosshair`}function rx(){const c=new Date,u=c.getFullYear(),b=String(c.getMonth()+1).padStart(2,"0"),d=String(c.getDate()).padStart(2,"0"),D=String(c.getHours()).padStart(2,"0"),$=String(c.getMinutes()).padStart(2,"0"),Se=String(c.getSeconds()).padStart(2,"0");return`${u}_${b}_${d}-${D}-${$}-${Se}`}function Pc(c){let u=c.replace(/\.json$/i,""),b="";for(;b!==u;)b=u,u=u.replace(/_\d{4}_\d{2}_\d{2}-\d{2}-\d{2}-\d{2}$/,""),u=u.replace(/_\d{4}_\d{2}_\d{2}_\d{2}_\d{2}_\d{2}$/,"");return u}const _f=c=>{const u=Ud[c];return!u||!u.prefix||u.prefix.length<1?"?":u.prefix[0].substring(0,1).toUpperCase()},pa=(c,u,b)=>({color:u,size:b}),zh=(c,u,b)=>{},Pn=(c,u,b,d)=>({color:b,size:d}),Oc=(c,u,b,d)=>{},cx=()=>{const c=new Map,u={top:"#0072B2",bottom:"#56B4E9"},b={top:18,bottom:18},d={top:"#FFFF00",bottom:"#FFFF00"},D={top:18,bottom:18},$={top:"#AA4499",bottom:"#F781BF"},Se={top:6,bottom:6},ye={top:"#6A3D9A",bottom:"#9467BD"},g={top:18,bottom:18};return c.set("select",{id:"select",name:"Select",toolType:"select",icon:"",shortcut:"S",tooltip:"Select objects or groups",colorReflective:!1,settings:pa("select","#ff0000",10),layerSettings:new Map([["top",Pn("select","top","#ff0000",10)],["bottom",Pn("select","bottom","#ff0000",10)]])}),c.set("via",{id:"via",name:"Via",toolType:"draw",drawingMode:"via",icon:"",shortcut:"V",tooltip:"Place via connection",colorReflective:!0,settings:pa("via",Uf,Of.DEFAULT_SIZE),layerSettings:new Map([["top",Pn("via","top",Uf,Of.DEFAULT_SIZE)],["bottom",Pn("via","bottom",Uf,Of.DEFAULT_SIZE)]]),defaultLayer:"top"}),c.set("pad",{id:"pad",name:"Pad",toolType:"draw",drawingMode:"pad",icon:"",shortcut:"P",tooltip:"Place pad connection",colorReflective:!0,settings:pa("pad",Kg,18),layerSettings:new Map([["top",Pn("pad","top",u.top,b.top)],["bottom",Pn("pad","bottom",u.bottom,b.bottom)]]),defaultLayer:"top"}),c.set("testPoint",{id:"testPoint",name:"Test Point",toolType:"draw",drawingMode:"testPoint",icon:"",shortcut:"Y",tooltip:"Place test point",colorReflective:!0,settings:pa("testPoint","#FFFF00",18),layerSettings:new Map([["top",Pn("testPoint","top",d.top,D.top)],["bottom",Pn("testPoint","bottom",d.bottom,D.bottom)]]),defaultLayer:"top"}),c.set("trace",{id:"trace",name:"Trace",toolType:"draw",drawingMode:"trace",icon:"",shortcut:"T",tooltip:"Draw copper traces",colorReflective:!0,settings:pa("trace",Zg,6),layerSettings:new Map([["top",Pn("trace","top",$.top,Se.top)],["bottom",Pn("trace","bottom",$.bottom,Se.bottom)]]),defaultLayer:"top"}),c.set("component",{id:"component",name:"Component",toolType:"component",icon:"",shortcut:"C",tooltip:"Place component",colorReflective:!0,settings:pa("component",Qg,Ah.DEFAULT_SIZE),layerSettings:new Map([["top",Pn("component","top",ye.top,g.top)],["bottom",Pn("component","bottom",ye.bottom,g.bottom)]]),defaultLayer:"top"}),c.set("componentConnection",{id:"componentConnection",name:"Component Connections",toolType:"componentConnection",icon:"",shortcut:"",tooltip:"Component connection lines",colorReflective:!1,settings:pa("componentConnection","#E69F00",3),layerSettings:new Map([["top",Pn("componentConnection","top","#E69F00",3)],["bottom",Pn("componentConnection","bottom","#E69F00",3)]])}),c.set("power",{id:"power",name:"Power",toolType:"power",icon:"",shortcut:"B",tooltip:"Place power node",colorReflective:!0,settings:pa("power",Pf,18),layerSettings:new Map([["top",Pn("power","top",Pf,18)],["bottom",Pn("power","bottom",Pf,18)]]),defaultLayer:"top"}),c.set("ground",{id:"ground",name:"Ground",toolType:"ground",icon:"",shortcut:"G",tooltip:"Place ground symbol",colorReflective:!0,settings:pa("ground",Bf,18),layerSettings:new Map([["top",Pn("ground","top",Bf,18)],["bottom",Pn("ground","bottom",Bf,18)]]),defaultLayer:"top"}),c.set("erase",{id:"erase",name:"Erase",toolType:"erase",icon:"",shortcut:"E",tooltip:"Erase objects",colorReflective:!1,settings:pa("erase","#f5a3b3",18),layerSettings:new Map([["top",Pn("erase","top","#f5a3b3",18)],["bottom",Pn("erase","bottom","#f5a3b3",18)]])}),c.set("pan",{id:"pan",name:"Move",toolType:"pan",icon:"",shortcut:"H",tooltip:"Pan the view",colorReflective:!1,settings:pa("pan","#ff0000",10),layerSettings:new Map([["top",Pn("pan","top","#ff0000",10)],["bottom",Pn("pan","bottom","#ff0000",10)]])}),c.set("magnify",{id:"magnify",name:"Zoom",toolType:"magnify",icon:"+",shortcut:"Z",tooltip:"Zoom In (or Zoom Out)",colorReflective:!1,settings:pa("magnify","#ff0000",10),layerSettings:new Map([["top",Pn("magnify","top","#ff0000",10)],["bottom",Pn("magnify","bottom","#ff0000",10)]])}),c},kh={via:{color:"#2CA02C",size:18},padTop:{color:"#0072B2",size:18},padBottom:{color:"#56B4E9",size:18},testPointTop:{color:"#FFFF00",size:18},testPointBottom:{color:"#FFFF00",size:18},traceTop:{color:"#AA4499",size:6},traceBottom:{color:"#F781BF",size:6},componentTop:{color:"#6A3D9A",size:18},componentBottom:{color:"#9467BD",size:18},power:{color:"#ff0000",size:18},ground:{color:"#000000",size:18}},Ad={via:"Via",padTop:"Pad (Top)",padBottom:"Pad (Bottom)",testPointTop:"Test Point (Top)",testPointBottom:"Test Point (Bottom)",traceTop:"Trace (Top)",traceBottom:"Trace (Bottom)",componentTop:"Component (Top)",componentBottom:"Component (Bottom)",power:"Power",ground:"Ground"};class dx{instances=new Map;listeners=new Map;initialize(){for(const u of Object.keys(kh)){const b=kh[u];this.instances.set(u,{id:u,name:Ad[u],color:b.color,size:b.size}),this.listeners.set(u,new Set)}}initializeFromProject(u){if(this.initialize(),u?.toolInstances)for(const[b,d]of Object.entries(u.toolInstances))this.instances.has(b)&&this.instances.set(b,d)}get(u){const b=this.instances.get(u);if(!b)throw new Error(`Tool instance ${u} not found`);return b}getColor(u){const b=this.instances.get(u);if(!b)throw new Error(`Tool instance ${u} not found`);const d=Ad[u];return console.log(`${d}, returning color value=${b.color}`),b.color}getSize(u){const b=this.instances.get(u);if(!b)throw new Error(`Tool instance ${u} not found`);const d=Ad[u];return console.log(`${d}, returning size value=${b.size}`),b.size}setColor(u,b){const d=this.instances.get(u);if(d){const D=Ad[u];console.log(`${D}, setting color value=${b}`),d.color=b,this.notifyListeners(u)}}setSize(u,b){const d=this.instances.get(u);if(d){const D=Ad[u];console.log(`${D}, setting size value=${b}`),d.size=b,this.notifyListeners(u)}}getAll(){const u={};for(const[b,d]of this.instances.entries())u[b]=d;return u}subscribe(u,b){const d=this.listeners.get(u);return d?(d.add(b),()=>{d.delete(b)}):()=>{}}notifyListeners(u){const b=this.listeners.get(u);b&&b.forEach(d=>d())}}const yt=new dx;yt.initialize();function ku(c,u){switch(c){case"via":return"via";case"pad":return u==="bottom"?"padBottom":"padTop";case"testPoint":return u==="bottom"?"testPointBottom":"testPointTop";case"trace":return u==="bottom"?"traceBottom":"traceTop";case"component":return u==="bottom"?"componentBottom":"componentTop";case"power":return"power";case"ground":return"ground";default:throw new Error(`Unknown tool: ${c}`)}}const ux=({visible:c,toolRegistry:u,currentTool:b,drawingMode:d,traceToolLayer:D,padToolLayer:$,testPointToolLayer:Se,componentToolLayer:ye,updateToolSettings:g,updateToolLayerSettings:I,setBrushSize:ue,saveToolSettings:ve,saveToolLayerSettings:je,setTopTraceSize:Ae,setBottomTraceSize:le,setTopPadSize:Me,setBottomPadSize:Ie,setTopTestPointSize:ae,setBottomTestPointSize:Fe,setTopComponentSize:ge,setBottomComponentSize:U,setComponentConnectionSize:G,saveDefaultSize:A,onClose:R})=>{const[z,y]=w.useState({}),Q=[{id:"via",name:"Via",instanceId:"via"},{id:"pad",name:"Pad",layer:"top",instanceId:"padTop"},{id:"pad",name:"Pad",layer:"bottom",instanceId:"padBottom"},{id:"testPoint",name:"Test Point",layer:"top",instanceId:"testPointTop"},{id:"testPoint",name:"Test Point",layer:"bottom",instanceId:"testPointBottom"},{id:"trace",name:"Trace",layer:"top",instanceId:"traceTop"},{id:"trace",name:"Trace",layer:"bottom",instanceId:"traceBottom"},{id:"component",name:"Component",layer:"top",instanceId:"componentTop"},{id:"component",name:"Component",layer:"bottom",instanceId:"componentBottom"},{id:"componentConnection",name:"Component Connections"},{id:"power",name:"Power",instanceId:"power"},{id:"ground",name:"Ground",instanceId:"ground"},{id:"erase",name:"Erase"}];w.useEffect(()=>{if(c){const fe={};for(const Ee of Q){const se=Ee.instanceId||Ee.id;if(Ee.instanceId)try{const _=yt.get(Ee.instanceId);fe[se]=_.size}catch{const _=u.get(Ee.id);_&&(fe[se]=Ee.layer?_.layerSettings.get(Ee.layer)?.size??_.settings.size??10:_.settings.size??10)}else{const _=u.get(Ee.id);_&&(fe[se]=_.settings.size??10)}}y(fe)}},[c]);const Re=w.useCallback((fe,Ee,se,_)=>{if(!u.get(fe)&&fe!=="componentConnection")return;const W=_||fe;y(F=>({...F,[W]:Ee})),["trace","pad","testPoint","component"].includes(fe)&&se&&_?(yt.setSize(_,Ee),(fe==="trace"&&b==="draw"&&d==="trace"||fe==="pad"&&b==="draw"&&d==="pad"||fe==="testPoint"&&b==="draw"&&d==="testPoint"||fe==="component"&&b==="component")&&((fe==="trace"?D:fe==="pad"?$:fe==="testPoint"?Se:ye)||"top")===se&&ue(Ee)):_?(yt.setSize(_,Ee),(fe==="via"&&b==="draw"&&d==="via"||fe==="power"&&b==="power"||fe==="ground"&&b==="ground")&&ue(Ee)):(fe==="componentConnection"&&(G(Ee),A("componentConnection",Ee)),fe==="erase"&&b==="erase"&&ue(Ee))},[u,b,d,D,$,Se,ye,ue,G,A]);if(!c)return null;const Oe=Array.from({length:50},(fe,Ee)=>Ee+1);return i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:fe=>{fe.target===fe.currentTarget&&R()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"16px",width:"fit-content",maxWidth:"400px",maxHeight:"70vh",overflowY:"auto",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:fe=>fe.stopPropagation(),children:[i.jsx("h3",{style:{margin:"0 0 12px 0",color:"#fff",fontSize:"16px",fontWeight:600},children:"Set Tool Size"}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:Q.map((fe,Ee)=>{if(!u.get(fe.id)&&fe.id!=="componentConnection")return null;const _=fe.layer?`${fe.name} (${fe.layer==="top"?"Top":"Bottom"})`:fe.name,O=fe.instanceId||fe.id,W=z[O]??10;return i.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"6px 10px",background:"#1f1f24",borderRadius:4},children:[i.jsxs("label",{style:{color:"#f2f2f2",fontSize:"13px",width:"140px",flexShrink:0,marginRight:"8px"},children:[_,":"]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[i.jsx("select",{value:W,onChange:Te=>{const F=parseInt(Te.target.value,10);Re(fe.id,F,fe.layer,fe.instanceId)},style:{width:"50px",padding:"4px 6px",background:"#2b2b31",border:"1px solid #3a3a44",borderRadius:4,color:"#f2f2f2",fontSize:"12px",cursor:"pointer"},children:Oe.map(Te=>i.jsx("option",{value:Te,style:{background:"#2b2b31",color:"#f2f2f2"},children:Te},Te))}),i.jsx("span",{style:{color:"#f2f2f2",fontSize:"12px"},children:"px"})]})]},`${fe.id}-${fe.layer||"default"}-${Ee}`)})}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:i.jsx("button",{onClick:R,style:{padding:"6px 12px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:600},children:"Close"})})]})})},fx=({visible:c,toolRegistry:u,currentTool:b,drawingMode:d,traceToolLayer:D,padToolLayer:$,testPointToolLayer:Se,componentToolLayer:ye,updateToolSettings:g,updateToolLayerSettings:I,saveToolSettings:ue,saveToolLayerSettings:ve,setBrushColor:je,setTopTraceColor:Ae,setBottomTraceColor:le,setTopPadColor:Me,setBottomPadColor:Ie,setTopTestPointColor:ae,setBottomTestPointColor:Fe,setTopComponentColor:ge,setBottomComponentColor:U,setComponentConnectionColor:G,saveDefaultColor:A,colorPalette:R,onClose:z})=>{const[y,Q]=Pe.useState(null),[Re,Oe]=Pe.useState(0);if(Pe.useEffect(()=>{const O=[];return[{id:"via"},{id:"pad",layer:"top"},{id:"pad",layer:"bottom"},{id:"testPoint",layer:"top"},{id:"testPoint",layer:"bottom"},{id:"trace",layer:"top"},{id:"trace",layer:"bottom"},{id:"component",layer:"top"},{id:"component",layer:"bottom"},{id:"power"},{id:"ground"}].forEach(({id:Te,layer:F})=>{try{const C=ku(Te,F),M=yt.subscribe(C,()=>{Oe(H=>H+1)});O.push(M)}catch{}}),()=>{O.forEach(Te=>Te())}},[]),!c)return null;const fe=["pad","testPoint","trace","component"],Ee=[{id:"via",name:"Via"},{id:"pad",name:"Pad",layer:"top"},{id:"pad",name:"Pad",layer:"bottom"},{id:"testPoint",name:"Test Point",layer:"top"},{id:"testPoint",name:"Test Point",layer:"bottom"},{id:"trace",name:"Trace",layer:"top"},{id:"trace",name:"Trace",layer:"bottom"},{id:"component",name:"Component",layer:"top"},{id:"component",name:"Component",layer:"bottom"},{id:"componentConnection",name:"Component Connections"},{id:"power",name:"Power"},{id:"ground",name:"Ground"},{id:"erase",name:"Erase"}],se=(O,W,Te)=>{if(O==="componentConnection"){G(W),A("componentConnection",W),Q(null);return}if(O==="erase"){const F=u.get(O);F&&(g(O,{...F.settings,color:W}),ue(O,W,F.settings.size)),Q(null);return}try{let F;Te&&fe.includes(O)?F=ku(O,Te):F=ku(O),yt.setColor(F,W),(O==="via"&&b==="draw"&&d==="via"||O==="trace"&&b==="draw"&&d==="trace"||O==="pad"&&b==="draw"&&d==="pad"||O==="testPoint"&&b==="draw"&&d==="testPoint"||O==="component"&&b==="component"||O==="power"&&b==="power"||O==="ground"&&b==="ground")&&(Te&&fe.includes(O)?((O==="trace"?D:O==="pad"?$:O==="testPoint"?Se:ye)||"top")===Te&&je(W):je(W))}catch(F){console.error(`Error updating color for tool ${O}:`,F);const C=u.get(O);C&&(Te&&fe.includes(O)?(I(O,Te,{...C.layerSettings.get(Te),color:W}),ve(O,Te,W,C.layerSettings.get(Te)?.size||C.settings.size)):(g(O,{...C.settings,color:W}),ue(O,W,C.settings.size)))}Q(null)},_=(O,W)=>{let Te;try{const M=ku(O,W);Te=yt.get(M).color}catch{const M=u.get(O);if(!M)return null;Te=M.settings.color??"#000000"}const F=W?`${O}-${W}`:O,C=y?.toolId===O&&y?.layer===W;return i.jsxs("div",{style:{position:"relative",display:"inline-block",zIndex:10005},children:[i.jsx("button",{className:"color-swatch-button",onClick:M=>{M.stopPropagation(),Q(C?null:{toolId:O,layer:W})},style:{width:"40px",height:"24px",background:Te,backgroundColor:Te,backgroundImage:"none",border:"1px solid #3a3a44",borderRadius:3,cursor:"pointer",padding:0,margin:0,display:"block","--swatch-color":Te},title:Te},`${F}-button-${Te}-${Re}`),C&&i.jsx("div",{onClick:M=>{M.stopPropagation()},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",padding:8,background:"#fff",border:"1px solid #ddd",borderRadius:6,boxShadow:"0 8px 18px rgba(0,0,0,0.18)",zIndex:100},children:i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(8, 22px)",gap:4},children:R.map(M=>i.jsx("div",{onClick:()=>se(O,M,W),title:M,style:{width:22,height:22,backgroundColor:M,border:M===Te?"2px solid #333":"1px solid #ccc",cursor:"pointer"}},M))})})]},`${F}-${Te}-${Re}`)};return i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:O=>{O.target===O.currentTarget&&(z(),Q(null))},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"16px",width:"fit-content",minWidth:"450px",maxWidth:"600px",maxHeight:"70vh",overflowY:"auto",overflowX:"visible",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:O=>O.stopPropagation(),children:[i.jsx("h3",{style:{margin:"0 0 12px 0",color:"#fff",fontSize:"16px",fontWeight:600},children:"Set Tool Color"}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:Ee.map((O,W)=>{if(!u.get(O.id))return null;const F=O.layer?`${O.name} (${O.layer==="top"?"Top":"Bottom"})`:O.name;return i.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"6px 10px",background:"#1f1f24",borderRadius:4},children:[i.jsxs("label",{style:{color:"#f2f2f2",fontSize:"13px",width:"140px",flexShrink:0,marginRight:"8px"},children:[F,":"]}),_(O.id,O.layer)]},`${O.id}-${O.layer||"default"}-${W}`)})}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:i.jsx("button",{onClick:()=>{z(),Q(null)},style:{padding:"6px 12px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:600},children:"Close"})})]})})},px=({openMenu:c,setOpenMenu:u,isReadOnlyMode:b,currentProjectFilePath:d,isProjectActive:D,onNewProject:$,onOpenProject:Se,onSaveProject:ye,onSaveAs:g,onPrint:I,hasUnsavedChanges:ue,setNewProjectDialog:ve,setAutoSaveDialog:je,topImage:Ae,bottomImage:le,setCurrentTool:Me,resetImageTransform:Ie,areImagesLocked:ae,setAreImagesLocked:Fe,onEnterBoardDimensions:ge,fileInputTopRef:U,fileInputBottomRef:G,openProjectRef:A,increaseSize:R,decreaseSize:z,brushSize:y,drawingStrokes:Q,selectedIds:Re,selectedComponentIds:Oe,selectedPowerIds:fe,selectedGroundIds:Ee,componentsTop:se,componentsBottom:_,powers:O,grounds:W,powerNodeNames:Te,groundNodeNames:F,setSetSizeDialog:C,areViasLocked:M,setAreViasLocked:H,arePadsLocked:he,setArePadsLocked:We,areTestPointsLocked:et,setAreTestPointsLocked:it,areTracesLocked:on,setAreTracesLocked:ce,areComponentsLocked:en,setAreComponentsLocked:Hn,areGroundNodesLocked:El,setAreGroundNodesLocked:Ni,arePowerNodesLocked:Mi,setArePowerNodesLocked:Xn,setSelectedIds:Ui,setSelectedComponentIds:si,setSelectedPowerIds:wl,setSelectedGroundIds:bi,selectAllVias:Tl,selectAllTraces:vi,selectAllPads:ha,selectAllComponents:us,selectDisconnectedComponents:mi,selectAllPowerNodes:fs,selectAllGroundNodes:Vr,selectPowerNodesByName:qe,selectGroundNodesByName:mt,setShowPowerBusManager:Hc,setShowGroundBusManager:$e,setShowDesignatorManager:It,toolRegistry:ga,updateToolSettings:Xi,updateToolLayerSettings:pt,setBrushSize:hn,setBrushColor:Rn,saveToolSettings:jl,saveToolLayerSettings:De,colorPalette:nl,currentTool:ct,drawingMode:cn,traceToolLayer:il,padToolLayer:Cl,testPointToolLayer:Vl,componentToolLayer:Ea,setTopTraceSize:Ht,setBottomTraceSize:xa,setTopPadSize:Va,setBottomPadSize:Gi,setTopTestPointSize:ps,setBottomTestPointSize:qi,setTopComponentSize:Il,setBottomComponentSize:hs,setComponentConnectionSize:ar,topTraceColor:Ve,bottomTraceColor:ll,topPadColor:At,bottomPadColor:Tn,topTestPointColor:Fn,bottomTestPointColor:ri,topComponentColor:Ia,bottomComponentColor:gs,setTopTraceColor:Bt,setBottomTraceColor:Wa,setTopPadColor:Zt,setBottomPadColor:Wl,setTopTestPointColor:Xt,setBottomTestPointColor:zl,setTopComponentColor:tn,setBottomComponentColor:Fl,setComponentConnectionColor:al,saveDefaultSize:jn,saveDefaultColor:Fa,menuBarRef:$a,onOpenProjectNotes:ya,onOpenTransformImages:Cn})=>{const[Ir,bt]=Pe.useState(null),Wt=Pe.useRef(null),[La,An]=Pe.useState(null),gn=Pe.useRef(null),[ol,xn]=Pe.useState(!1),[Bi,or]=Pe.useState(!1),Jn=Ne=>{if(!D){alert("Please create a new project (File  New Project) or open an existing project (File  Open Project) before using this feature."),u(null);return}Ne()},xs=Ne=>{const $n=Ne==="power"?Te:F,ys=$n.length>0,Wr=Ne==="power"?"Select Power Nodes":"Select Ground Nodes";return i.jsxs("div",{onMouseEnter:()=>{Wt.current&&(clearTimeout(Wt.current),Wt.current=null),bt(Ne)},onMouseLeave:()=>{Wt.current=window.setTimeout(()=>{bt(ci=>ci===Ne?null:ci)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[i.jsxs("div",{style:{padding:"4px 10px",fontSize:12,color:"#bbb"},children:[Wr," by Name"]}),i.jsxs("button",{onClick:()=>{Ne==="power"?fs():Vr(),bt(null),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:["All ",Ne==="power"?"Power Nodes":"Ground Nodes"]}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),ys?$n.map(ci=>i.jsx("button",{onClick:()=>{Ne==="power"?qe(ci):mt(ci),bt(null),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:ci},ci)):i.jsxs("div",{style:{padding:"4px 10px",fontSize:12,color:"#bbb"},children:["No ",Ne==="power"?"power":"ground"," nodes available."]})]})},zo=()=>i.jsxs("div",{onMouseEnter:()=>{gn.current&&(clearTimeout(gn.current),gn.current=null),An("lock")},onMouseLeave:()=>{gn.current=window.setTimeout(()=>{An(Ne=>Ne==="lock"?null:Ne)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[i.jsxs("label",{onClick:Ne=>{Ne.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:M,onChange:()=>{H(Ne=>!Ne)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Vias"})]}),i.jsxs("label",{onClick:Ne=>{Ne.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:he,onChange:()=>{We(Ne=>!Ne)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Pads"})]}),i.jsxs("label",{onClick:Ne=>{Ne.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:et,onChange:()=>{it(Ne=>!Ne)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Test Points"})]}),i.jsxs("label",{onClick:Ne=>{Ne.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:on,onChange:()=>{ce(Ne=>!Ne)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Traces"})]}),i.jsxs("label",{onClick:Ne=>{Ne.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:en,onChange:()=>{Hn(Ne=>!Ne)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Components"})]}),i.jsxs("label",{onClick:Ne=>{Ne.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:El,onChange:()=>{Ni(Ne=>!Ne)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Ground Node"})]}),i.jsxs("label",{onClick:Ne=>{Ne.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:Mi,onChange:()=>{Xn(Ne=>!Ne)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Power Nodes"})]})]}),Ya=()=>i.jsxs("div",{onMouseEnter:()=>{gn.current&&(clearTimeout(gn.current),gn.current=null),An("select")},onMouseLeave:()=>{gn.current=window.setTimeout(()=>{An(Ne=>Ne==="select"?null:Ne)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[i.jsx("button",{onClick:()=>{Tl(),An(null),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Vias"}),i.jsx("button",{onClick:()=>{vi(),An(null),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Traces"}),i.jsx("button",{onClick:()=>{ha(),An(null),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Pads"}),i.jsx("button",{onClick:()=>{const Ne=new Set(Q.filter($n=>$n.type==="testPoint").map($n=>$n.id));Ui(Ne),si(new Set),wl(new Set),bi(new Set),An(null),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Test Points"}),i.jsx("button",{onClick:()=>{us(),An(null),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Components"}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onMouseEnter:()=>{Wt.current&&(clearTimeout(Wt.current),Wt.current=null),bt("power")},onMouseLeave:()=>{Wt.current=window.setTimeout(()=>{bt(Ne=>Ne==="power"?null:Ne)},200)},onClick:()=>{bt(Ne=>Ne==="power"?null:"power")},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Power Nodes "}),Ir==="power"&&xs("power")]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onMouseEnter:()=>{Wt.current&&(clearTimeout(Wt.current),Wt.current=null),bt("ground")},onMouseLeave:()=>{Wt.current=window.setTimeout(()=>{bt(Ne=>Ne==="ground"?null:Ne)},200)},onClick:()=>{bt(Ne=>Ne==="ground"?null:"ground")},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Ground Nodes "}),Ir==="ground"&&xs("ground")]}),i.jsx("button",{onClick:()=>{mi(),An(null),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Disconnected Components"})]});return i.jsxs(i.Fragment,{children:[i.jsxs("div",{ref:$a,style:{position:"relative",background:"rgba(250,250,255,0.9)",borderBottom:"1px solid #e6e6ef",padding:"6px 12px",display:"flex",gap:16,alignItems:"center",zIndex:3},children:[i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onClick:Ne=>{Ne.stopPropagation(),u($n=>$n==="file"?null:"file")},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:c==="file"?"#eef3ff":"#fff",fontWeight:600,color:"#222"},children:"File "}),c==="file"&&i.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:200,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[i.jsx("button",{onClick:()=>{b||(u(null),ue()?ve({visible:!0}):$())},disabled:b,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:b?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:b?"not-allowed":"pointer"},children:"New Project"}),i.jsx("button",{onClick:async()=>{await Se(),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Open Project"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{b||Jn(()=>{ye(),u(null)})},disabled:b||!D,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:b||!D?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:b||!D?"not-allowed":"pointer"},children:"Save Project"}),i.jsx("button",{onClick:()=>{b||Jn(()=>{g(),u(null)})},disabled:b||!D,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:b||!D?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:b||!D?"not-allowed":"pointer"},children:"Save As"}),i.jsx("button",{onClick:()=>{b||Jn(()=>{je({visible:!0,interval:5}),u(null)})},disabled:b||!D,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:b||!D?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:b||!D?"not-allowed":"pointer"},children:"Auto Save"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{Jn(()=>{I(),u(null)})},disabled:!D,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:D?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:D?"pointer":"not-allowed"},children:"Print"}),i.jsx("button",{onClick:()=>{Jn(()=>{I(),u(null)})},disabled:!D,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:D?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:D?"pointer":"not-allowed"},children:"Printer Settings"})]})]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onClick:Ne=>{if(!b){if(!D){alert("Please create a new project (File  New Project) or open an existing project (File  Open Project) before using this feature.");return}Ne.stopPropagation(),u($n=>$n==="transform"?null:"transform")}},disabled:b||!D,style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:c==="transform"?"#eef3ff":"#fff",fontWeight:600,color:b||!D?"#999":"#222",cursor:b||!D?"not-allowed":"pointer",opacity:b||!D?.5:1},children:"Images "}),c==="transform"&&i.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:260,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[i.jsx("div",{style:{padding:"4px 10px",fontSize:12,color:"#bbb"},children:"Load Images"}),i.jsx("button",{onClick:()=>{!b&&!ae&&(U.current?.click(),u(null))},disabled:b||ae,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:b||ae?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:b||ae?"not-allowed":"pointer"},children:"Load Top PCB"}),i.jsx("button",{onClick:()=>{!b&&!ae&&(G.current?.click(),u(null))},disabled:b||ae,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:b||ae?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:b||ae?"not-allowed":"pointer"},children:"Load Bottom PCB"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{ae||(ge(),u(null))},disabled:ae,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:ae?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:ae?"not-allowed":"pointer"},children:"Enter PCB Dimensions"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{Cn(),u(null)},disabled:!Ae&&!le||ae,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:!Ae&&!le||ae?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:!Ae&&!le||ae?"not-allowed":"pointer"},children:"Transform Images"}),i.jsx("button",{onClick:()=>{ae||(Me("transform"),Ie(),u(null))},disabled:ae||!Ae&&!le,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:ae||!Ae&&!le?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:ae||!Ae&&!le?"not-allowed":"pointer"},children:"Reset Transform"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{Fe(Ne=>!Ne),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:ae?"Unlock Images ":"Lock Images"})]})]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onClick:Ne=>{if(!b){if(!D){alert("Please create a new project (File  New Project) or open an existing project (File  Open Project) before using this feature.");return}Ne.stopPropagation(),u($n=>$n==="tools"?null:"tools")}},disabled:b||!D,style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:c==="tools"?"#eef3ff":"#fff",fontWeight:600,color:b||!D?"#999":"#222",cursor:b||!D?"not-allowed":"pointer",opacity:b||!D?.5:1},children:"Tools "}),c==="tools"&&i.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[i.jsx("button",{onClick:()=>{R(),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Increase Size (+)"}),i.jsx("button",{onClick:()=>{z(),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Decrease Size (-)"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{xn(!0),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Set Tool Size"}),i.jsx("button",{onClick:()=>{or(!0),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Set Tool Color"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onMouseEnter:()=>{gn.current&&(clearTimeout(gn.current),gn.current=null),An("lock")},onMouseLeave:()=>{gn.current=window.setTimeout(()=>{An(Ne=>Ne==="lock"?null:Ne)},200)},onClick:()=>{An(Ne=>Ne==="lock"?null:"lock")},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Lock "}),La==="lock"&&zo()]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onMouseEnter:()=>{gn.current&&(clearTimeout(gn.current),gn.current=null),An("select")},onMouseLeave:()=>{gn.current=window.setTimeout(()=>{An(Ne=>Ne==="select"?null:Ne)},200)},onClick:()=>{An(Ne=>Ne==="select"?null:"select")},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Select "}),La==="select"&&Ya()]}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{ya(),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Project Notes"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{Hc(!0),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Manage Power Buses"}),i.jsx("button",{onClick:()=>{$e(!0),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Manage Ground Buses"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{It(!0),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Manage Designators"})]})]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onClick:Ne=>{Ne.stopPropagation(),u($n=>$n==="about"?null:"about")},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:c==="about"?"#eef3ff":"#fff",fontWeight:600,color:"#222"},children:"About "}),c==="about"&&i.jsx("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:500,maxWidth:700,maxHeight:"80vh",background:"#fff",border:"1px solid #ccc",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:20,overflowY:"auto",zIndex:100},children:i.jsxs("div",{style:{marginBottom:16},children:[i.jsx("h2",{style:{margin:"0 0 16px 0",color:"#000",fontSize:"20px",fontWeight:700},children:"PCB Reverse Engineering Tool"}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"About"}),i.jsx("p",{style:{margin:"0 0 12px 0",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:"A specialized tool for reverse engineering printed circuit boards (PCBs) by tracing and documenting circuit connections from PCB images. This application supports typical 2 to 4 layer PCBs and enables comprehensive PCB analysis and documentation."}),i.jsx("p",{style:{margin:"0 0 12px 0",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:"This tool can also be used to assist in troubleshooting electronics by tracing circuits, holding contextual notes, comparing test results, and documenting findings during the debugging process."})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Technology"}),i.jsx("p",{style:{margin:"0 0 12px 0",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:"The application runs entirely client-side in the browser, to provide a responsive, interactive drawing experience with no backend server requirements."})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Features"}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Tools & Shortcuts"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px 16px",fontSize:"13px",color:"#222"},children:[i.jsx("div",{children:i.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Select"}),"  ",i.jsx("code",{children:"S"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Via"}),"  ",i.jsx("code",{children:"V"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Pad"}),"  ",i.jsx("code",{children:"P"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Test Point"}),"  ",i.jsx("code",{children:"Y"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Trace"}),"  ",i.jsx("code",{children:"T"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Component"}),"  ",i.jsx("code",{children:"C"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Component Properties"}),"  double-click component"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Resize Icons"}),"  ",i.jsx("code",{children:"+"})," / ",i.jsx("code",{children:"-"})]})]})}),i.jsx("div",{children:i.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Power"}),"  ",i.jsx("code",{children:"B"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Ground"}),"  ",i.jsx("code",{children:"G"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Erase"}),"  ",i.jsx("code",{children:"E"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Move (Pan)"}),"  ",i.jsx("code",{children:"H"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Zoom"}),"  ",i.jsx("code",{children:"Z"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Set View"}),"  ",i.jsx("code",{children:"X"})," then ",i.jsx("code",{children:"0-9"})," to save view"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Recall View"}),"  ",i.jsx("code",{children:"0-9"})," to recall saved view"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Information Dialog"}),"  ",i.jsx("code",{children:"I"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Notes Dialog"}),"  ",i.jsx("code",{children:"N"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Project Notes / TODO"}),"  ",i.jsx("code",{children:"L"})]})]})})]}),i.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#222"},children:[i.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600},children:"Arrow Keys"}),i.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Image Transformations"}),"  Arrow keys for scaling, rotating, and adjusting image transformations (when image is selected for transform)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Move Selected Components"}),"  Arrow keys to nudge selected components"]})]})]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px 20px"},children:[i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Image Management"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Load top and bottom PCB images"}),i.jsx("li",{children:"Image alignment and transformation"}),i.jsx("li",{children:"Transform modes: nudge, scale, rotate, slant, keystone"}),i.jsx("li",{children:"Horizontal and vertical flip controls"}),i.jsx("li",{children:"Grayscale and edge detection modes"}),i.jsx("li",{children:"Board dimensions configuration"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Drawing Tools"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Draw copper traces (top and bottom layers)"}),i.jsx("li",{children:"Place vias for layer connections"}),i.jsx("li",{children:"Place component pads (SMD and through-hole)"}),i.jsx("li",{children:"Place test points for circuit testing"}),i.jsx("li",{children:"Place and annotate components"}),i.jsx("li",{children:"Place power and ground nodes"}),i.jsx("li",{children:"Erase tool for removing elements"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Layer Management"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Separate top and bottom layer support"}),i.jsx("li",{children:"Layer-specific color customization"}),i.jsx("li",{children:"Layer-specific size controls"}),i.jsx("li",{children:"Layer visibility toggles"}),i.jsx("li",{children:"Overlay view mode"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Component Management"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Component placement with pin counts"}),i.jsx("li",{children:"Pin connection tracking"}),i.jsx("li",{children:"Component type classification"}),i.jsx("li",{children:"Designator and value annotation"}),i.jsx("li",{children:"Component editor dialog"}),i.jsx("li",{children:"Find and center component"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Selection & Locking"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Select individual elements or groups"}),i.jsx("li",{children:"Select all vias, traces, pads, or components"}),i.jsx("li",{children:"Select power/ground nodes by name"}),i.jsx("li",{children:"Select disconnected components"}),i.jsx("li",{children:"Lock/unlock elements by type"}),i.jsx("li",{children:"Image locking for protection"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Power & Ground"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Multiple voltage power nodes"}),i.jsx("li",{children:"Power bus management"}),i.jsx("li",{children:"Ground node placement"}),i.jsx("li",{children:"Ground bus management"}),i.jsx("li",{children:"Node naming and organization"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Customization"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Customizable colors per layer"}),i.jsx("li",{children:"Adjustable brush/tool sizes"}),i.jsx("li",{children:"Size presets for common tools"}),i.jsx("li",{children:"Color palette management"}),i.jsx("li",{children:"Tool settings persistence"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Project Management"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Create, open, and save projects"}),i.jsx("li",{children:"Auto-save with configurable intervals"}),i.jsx("li",{children:"File history automatically saved in history subdirectory when Auto Save is enabled"}),i.jsx("li",{children:"Project Notes / TODO list with spreadsheet-like editing"}),i.jsx("li",{children:"Project file format (JSON)"}),i.jsx("li",{children:"Print functionality"}),i.jsx("li",{children:"Export to KiCad schematic format (future feature, not yet implemented)"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"View Controls"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Zoom in/out with mouse wheel"}),i.jsx("li",{children:"Pan view with hand tool"}),i.jsx("li",{children:"Zoom to fit"}),i.jsx("li",{children:"View mode switching (top/bottom/overlay)"}),i.jsx("li",{children:"Save up to 10 view locations (X + 0-9)"}),i.jsx("li",{children:"Recall saved views instantly (0-9 keys)"}),i.jsx("li",{children:"Detailed information dialog"})]})]})]})]}),i.jsx("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #ddd"},children:i.jsxs("p",{style:{margin:"0 0 8px 0",color:"#666",fontSize:"12px",lineHeight:"1.5"},children:["Use the ",i.jsx("strong",{children:"File"})," menu to manage projects, the ",i.jsx("strong",{children:"Images"})," menu for image loading and transformation, and the ",i.jsx("strong",{children:"Tools"})," menu for selection, locking, and customization options."]})}),i.jsxs("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #ddd"},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Future / TODO List"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"A searchable list of common components"}),i.jsx("li",{children:"Output schematics (perhaps as KiCad files)"}),i.jsx("li",{children:"Dynamic layers"})]})]})]})})]}),d&&i.jsx("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:"8px",paddingLeft:"16px"},children:i.jsx("div",{style:{fontSize:"12px",color:"#333",fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"40vw"},title:d,children:d})})]}),i.jsx(ux,{visible:ol,toolRegistry:ga,currentTool:ct,drawingMode:cn,traceToolLayer:il,padToolLayer:Cl,testPointToolLayer:Vl,componentToolLayer:Ea,updateToolSettings:Xi,updateToolLayerSettings:pt,setBrushSize:hn,saveToolSettings:jl,saveToolLayerSettings:De,setTopTraceSize:Ht,setBottomTraceSize:xa,setTopPadSize:Va,setBottomPadSize:Gi,setTopTestPointSize:ps,setBottomTestPointSize:qi,setTopComponentSize:Il,setBottomComponentSize:hs,setComponentConnectionSize:ar,saveDefaultSize:jn,onClose:()=>xn(!1)}),i.jsx(fx,{visible:Bi,toolRegistry:ga,currentTool:ct,drawingMode:cn,traceToolLayer:il,padToolLayer:Cl,testPointToolLayer:Vl,componentToolLayer:Ea,updateToolSettings:Xi,updateToolLayerSettings:pt,saveToolSettings:jl,saveToolLayerSettings:De,setBrushColor:Rn,setTopTraceColor:Bt,setBottomTraceColor:Wa,setTopPadColor:Zt,setBottomPadColor:Wl,setTopTestPointColor:Xt,setBottomTestPointColor:zl,setTopComponentColor:tn,setBottomComponentColor:Fl,setComponentConnectionColor:al,saveDefaultColor:Fa,colorPalette:nl,onClose:()=>or(!1)})]})},hx=({visible:c})=>c?i.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",padding:"24px 32px",background:"rgba(255, 255, 255, 0.95)",borderRadius:8,border:"2px solid #4CAF50",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",zIndex:1,maxWidth:"500px"},children:[i.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"#000",marginBottom:"12px"},children:"PCB Reverse Engineering Tool"}),i.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"#000",marginBottom:"16px",lineHeight:"1.5"},children:"Supports Typical 4-Layer PCBs"}),i.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"8px",lineHeight:"1.5",textAlign:"left"},children:"1) Use the File menu to start a new project."}),i.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"8px",lineHeight:"1.5",textAlign:"left"},children:"2) Use the Images menu to load PCB photos."}),i.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"12px",lineHeight:"1.5",textAlign:"left"},children:"3) Use the tools to draw vias, pads, traces, etc."}),i.jsx("div",{style:{fontSize:"13px",color:"#555",marginTop:"16px",lineHeight:"1.5",textAlign:"left",fontWeight:"bold"},children:"Best viewed in browser's Full Screen Mode"})]}):null,gx=({visible:c,title:u,message:b,onClose:d})=>c?i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:D=>{D.target===D.currentTarget&&d()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"2px solid #ff4444"},onClick:D=>D.stopPropagation(),children:[i.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",gap:"12px"},children:[i.jsx("div",{style:{fontSize:"24px",color:"#ff4444"},children:""}),i.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:u})]}),i.jsx("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"14px",lineHeight:"1.5"},children:b}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:i.jsx("button",{onClick:d,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"OK"})})]})}):null,xx=({visible:c,selectedIds:u,selectedComponentIds:b,selectedPowerIds:d,selectedGroundIds:D,drawingStrokes:$,componentsTop:Se,componentsBottom:ye,powers:g,grounds:I,powerBuses:ue,onClose:ve,setComponentsTop:je,setComponentsBottom:Ae,determineViaType:le,determinePadType:Me,determineTestPointType:Ie,onFindComponent:ae,position:Fe,isDragging:ge,onDragStart:U,onOpenNotesDialog:G})=>{if(!c)return null;const A=Fe?{position:"fixed",left:`${Fe.x}px`,top:`${Fe.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"150px",maxWidth:"400px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:ge?"grabbing":"default"}:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"flex-start",justifyContent:"flex-end",paddingRight:"20px",paddingTop:"80px",zIndex:1e4,pointerEvents:"none"},R={padding:"20px",overflow:"auto",flex:1};return i.jsxs("div",{style:A,children:[i.jsxs("div",{onMouseDown:z=>{const y=z.target;y.tagName==="BUTTON"||y.closest("button")||Fe&&U(z)},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:ge?"grabbing":Fe?"grab":"default",userSelect:"none",flexShrink:0},children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Information (I)"}),i.jsx("button",{onClick:ve,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsx("div",{style:R,children:i.jsxs("div",{style:{margin:0,padding:0,backgroundColor:"#f5f5f5",borderRadius:4,fontSize:"12px",fontFamily:"monospace",maxHeight:"calc(80vh - 100px)",overflow:"auto",color:"#000"},children:[(()=>{const z=$.filter(fe=>u.has(fe.id)).length,y=[...Se,...ye].filter(fe=>b.has(fe.id)).length,Q=g.filter(fe=>d.has(fe.id)).length,Re=I.filter(fe=>D.has(fe.id)).length,Oe=z+y+Q+Re;return i.jsx("div",{style:{padding:"12px 16px",backgroundColor:Oe>0?"#e8e8e8":"#fff3cd",borderBottom:"2px solid #ccc",fontSize:"13px",fontWeight:600,color:Oe>0?"#333":"#856404",marginBottom:"8px"},children:Oe>0?`${Oe} Object${Oe!==1?"s":""} Selected`:"Zero Objects Selected"})})(),b.size>0&&(()=>{const z=$.some(y=>u.has(y.id)&&(y.type==="via"||y.type==="pad"));return[...Se,...ye].filter(y=>b.has(y.id)).map(y=>i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:Md(y.componentType)})]}),ae&&i.jsx("button",{onClick:()=>{ae(y.id,y.x,y.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:Q=>{Q.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:Q=>{Q.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[i.jsxs("div",{children:["Layer: ",y.layer]}),y.componentType==="IntegratedCircuit"&&i.jsxs(i.Fragment,{children:[y.description&&i.jsxs("div",{children:["Description: ",y.description]}),y.icType&&i.jsxs("div",{children:["IC Type: ",y.icType]})]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:y.notes||"",readOnly:!0,onClick:G,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsxs("span",{children:["Designator: ",y.designator||"(empty)"]}),z&&i.jsx("button",{onClick:()=>{const Q=[...Se,...ye].filter(W=>b.has(W.id)&&W.componentType===y.componentType),Re=Q.length,Oe=$.filter(W=>u.has(W.id)&&W.type==="pad"&&W.points.length>0&&W.points[0].id!==void 0).map(W=>{const Te=W.points[0].id;if(Te===void 0)throw new Error("Unexpected undefined id");return{stroke:W,nodeId:Te}}).sort((W,Te)=>W.nodeId-Te.nodeId),fe=Oe.length>0?Oe:$.filter(W=>u.has(W.id)&&W.type==="via"&&W.points.length>0&&W.points[0].id!==void 0).map(W=>{const Te=W.points[0].id;if(Te===void 0)throw new Error("Unexpected undefined id");return{stroke:W,nodeId:Te}}).sort((W,Te)=>W.nodeId-Te.nodeId),Ee=fe.length;if(Ee===0){console.warn("No vias or pads with Node IDs found in selection");return}const se=Math.floor(Ee/Re);if(se===0){console.warn(`Not enough ${Oe.length>0?"pads":"vias"} (${Ee}) for ${Re} components`);return}[...Q].sort((W,Te)=>W.id.localeCompare(Te.id)).forEach((W,Te)=>{const F=Te*se,C=F+se,H=fe.slice(F,C).map(We=>We.nodeId.toString()),he=Hf(W,H,$);W.layer==="top"?je(We=>We.map(et=>{if(et.id===W.id){const it={...et,pinCount:se,pinConnections:H};return he&&(it.pinPolarities=he),it}return et})):Ae(We=>We.map(et=>{if(et.id===W.id){const it={...et,pinCount:se,pinConnections:H};return he&&(it.pinPolarities=he),it}return et}))});const O=Oe.length>0?"pads":"vias";console.log(`Connected ${Re} components of type ${y.componentType} to ${Ee} ${O} (${se} pins each)`)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap"},onMouseEnter:Q=>{Q.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:Q=>{Q.currentTarget.style.backgroundColor="#4CAF50"},children:"Connect"})]}),i.jsxs("div",{children:["Abbreviation: ",y.abbreviation||"(empty)"]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:y.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:y.color})]}),i.jsxs("div",{children:["Size: ",y.size]}),i.jsxs("div",{children:["Pin Count: ",y.pinCount]}),y.componentType==="Resistor"&&i.jsxs(i.Fragment,{children:[y.resistance&&i.jsxs("div",{children:["Resistance: ",y.resistance]}),y.power&&i.jsxs("div",{children:["Power: ",y.power]}),y.tolerance&&i.jsxs("div",{children:["Tolerance: ",y.tolerance]})]}),y.componentType==="Capacitor"&&i.jsxs(i.Fragment,{children:[y.capacitance&&i.jsxs("div",{children:["Capacitance: ",y.capacitance]}),y.voltage&&i.jsxs("div",{children:["Voltage: ",y.voltage]}),y.dielectric&&i.jsxs("div",{children:["Dielectric: ",y.dielectric]}),y.tolerance&&i.jsxs("div",{children:["Tolerance: ",y.tolerance]})]}),y.componentType==="Electrolytic Capacitor"&&i.jsxs(i.Fragment,{children:[y.capacitance&&i.jsxs("div",{children:["Capacitance: ",y.capacitance]}),y.voltage&&i.jsxs("div",{children:["Voltage: ",y.voltage]}),y.tolerance&&i.jsxs("div",{children:["Tolerance: ",y.tolerance]}),y.polarity&&i.jsxs("div",{children:["Polarity: ",y.polarity]}),y.esr&&i.jsxs("div",{children:["ESR: ",y.esr]}),y.temperature&&i.jsxs("div",{children:["Temperature: ",y.temperature]})]}),y.pinConnections&&y.pinConnections.length>0&&(()=>{const Q=y.componentType==="Electrolytic Capacitor"||y.componentType==="Diode"||y.componentType==="Battery"||y.componentType==="ZenerDiode",Re=y.componentType==="Capacitor"&&"dielectric"in y&&y.dielectric==="Tantalum",Oe=Q||Re;return i.jsxs("div",{style:{marginTop:"8px",marginBottom:"8px"},children:[i.jsx("div",{style:{marginBottom:"4px",fontWeight:600},children:"Pin Connections:"}),i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px",border:"1px solid #ddd"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Pin #"}),Oe&&i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Polarity"}),i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Node ID"})]})}),i.jsx("tbody",{children:y.pinConnections.map((fe,Ee)=>{const se=y.pinPolarities&&y.pinPolarities.length>Ee?y.pinPolarities[Ee]:"";return i.jsxs("tr",{style:{backgroundColor:Ee%2===0?"#fff":"#f9f9f9"},children:[i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:Ee+1}),Oe&&i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd",textAlign:"center",fontFamily:"monospace",fontWeight:600,color:se==="+"?"#d32f2f":se==="-"?"#1976d2":"#999"},children:se||"-"}),i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:fe||"(not connected)"})]},Ee)})})]})]})})(),"manufacturer"in y&&y.manufacturer&&i.jsxs("div",{children:["Manufacturer: ",y.manufacturer]}),"partNumber"in y&&y.partNumber&&i.jsxs("div",{children:["Part Number: ",y.partNumber]}),y.componentType==="Diode"&&i.jsxs(i.Fragment,{children:[y.diodeType&&i.jsxs("div",{children:["Type: ",y.diodeType]}),y.voltage&&i.jsxs("div",{children:["Voltage: ",y.voltage]}),y.current&&i.jsxs("div",{children:["Current: ",y.current]}),y.ledColor&&i.jsxs("div",{children:["LED Color: ",y.ledColor]})]}),y.componentType==="Battery"&&i.jsxs(i.Fragment,{children:[y.voltage&&i.jsxs("div",{children:["Voltage: ",y.voltage]}),y.capacity&&i.jsxs("div",{children:["Capacity: ",y.capacity]}),y.chemistry&&i.jsxs("div",{children:["Chemistry: ",y.chemistry]})]}),y.componentType==="Fuse"&&i.jsxs(i.Fragment,{children:[y.current&&i.jsxs("div",{children:["Current: ",y.current]}),y.voltage&&i.jsxs("div",{children:["Voltage: ",y.voltage]}),y.fuseType&&i.jsxs("div",{children:["Type: ",y.fuseType]})]}),y.componentType==="FerriteBead"&&i.jsxs(i.Fragment,{children:[y.impedance&&i.jsxs("div",{children:["Impedance: ",y.impedance]}),y.current&&i.jsxs("div",{children:["Current: ",y.current]})]}),y.componentType==="Connector"&&i.jsxs(i.Fragment,{children:[y.connectorType&&i.jsxs("div",{children:["Type: ",y.connectorType]}),y.gender&&i.jsxs("div",{children:["Gender: ",y.gender]})]}),y.componentType==="Jumper"&&i.jsx(i.Fragment,{children:y.positions&&i.jsxs("div",{children:["Positions: ",y.positions]})}),y.componentType==="Relay"&&i.jsxs(i.Fragment,{children:[y.coilVoltage&&i.jsxs("div",{children:["Coil Voltage: ",y.coilVoltage]}),y.contactType&&i.jsxs("div",{children:["Contact Type: ",y.contactType]}),y.current&&i.jsxs("div",{children:["Current: ",y.current]})]}),y.componentType==="Inductor"&&i.jsxs(i.Fragment,{children:[y.inductance&&i.jsxs("div",{children:["Inductance: ",y.inductance]}),y.current&&i.jsxs("div",{children:["Current: ",y.current]}),y.resistance&&i.jsxs("div",{children:["DC Resistance: ",y.resistance]})]}),y.componentType==="Speaker"&&i.jsxs(i.Fragment,{children:[y.impedance&&i.jsxs("div",{children:["Impedance: ",y.impedance]}),y.power&&i.jsxs("div",{children:["Power: ",y.power]})]}),y.componentType==="Motor"&&i.jsxs(i.Fragment,{children:[y.motorType&&i.jsxs("div",{children:["Type: ",y.motorType]}),y.voltage&&i.jsxs("div",{children:["Voltage: ",y.voltage]}),y.current&&i.jsxs("div",{children:["Current: ",y.current]})]}),y.componentType==="PowerSupply"&&i.jsxs(i.Fragment,{children:[y.inputVoltage&&i.jsxs("div",{children:["Input Voltage: ",y.inputVoltage]}),y.outputVoltage&&i.jsxs("div",{children:["Output Voltage: ",y.outputVoltage]}),y.current&&i.jsxs("div",{children:["Current: ",y.current]})]}),y.componentType==="Transistor"&&i.jsxs(i.Fragment,{children:[y.transistorType&&i.jsxs("div",{children:["Type: ",y.transistorType]}),y.polarity&&i.jsxs("div",{children:["Polarity: ",y.polarity]}),y.voltage&&i.jsxs("div",{children:["Voltage: ",y.voltage]}),y.current&&i.jsxs("div",{children:["Current: ",y.current]})]}),y.componentType==="ResistorNetwork"&&i.jsxs(i.Fragment,{children:[y.resistance&&i.jsxs("div",{children:["Resistance: ",y.resistance]}),y.configuration&&i.jsxs("div",{children:["Configuration: ",y.configuration]})]}),y.componentType==="Thermistor"&&i.jsxs(i.Fragment,{children:[y.resistance&&i.jsxs("div",{children:["Resistance: ",y.resistance]}),y.thermistorType&&i.jsxs("div",{children:["Type: ",y.thermistorType]}),y.beta&&i.jsxs("div",{children:["Beta: ",y.beta]})]}),y.componentType==="Switch"&&i.jsxs(i.Fragment,{children:[y.switchType&&i.jsxs("div",{children:["Type: ",y.switchType]}),y.current&&i.jsxs("div",{children:["Current: ",y.current]}),y.voltage&&i.jsxs("div",{children:["Voltage: ",y.voltage]})]}),y.componentType==="Transformer"&&i.jsxs(i.Fragment,{children:[y.primaryVoltage&&i.jsxs("div",{children:["Primary Voltage: ",y.primaryVoltage]}),y.secondaryVoltage&&i.jsxs("div",{children:["Secondary Voltage: ",y.secondaryVoltage]}),y.power&&i.jsxs("div",{children:["Power: ",y.power]}),y.turns&&i.jsxs("div",{children:["Turns Ratio: ",y.turns]})]}),y.componentType==="TestPoint"&&i.jsx(i.Fragment,{children:y.signal&&i.jsxs("div",{children:["Signal: ",y.signal]})}),y.componentType==="IntegratedCircuit"&&i.jsx(i.Fragment,{children:y.datasheet&&i.jsxs("div",{children:["Datasheet: ",i.jsx("a",{href:y.datasheet,target:"_blank",rel:"noopener noreferrer",children:y.datasheet})]})}),y.componentType==="VacuumTube"&&i.jsx(i.Fragment,{children:y.tubeType&&i.jsxs("div",{children:["Type: ",y.tubeType]})}),y.componentType==="VariableResistor"&&i.jsxs(i.Fragment,{children:[y.vrType&&i.jsxs("div",{children:["Type: ",y.vrType]}),y.resistance&&i.jsxs("div",{children:["Resistance: ",y.resistance]}),y.power&&i.jsxs("div",{children:["Power: ",y.power]}),y.taper&&i.jsxs("div",{children:["Taper: ",y.taper]})]}),y.componentType==="Crystal"&&i.jsxs(i.Fragment,{children:[y.frequency&&i.jsxs("div",{children:["Frequency: ",y.frequency]}),y.loadCapacitance&&i.jsxs("div",{children:["Load Capacitance: ",y.loadCapacitance]}),y.tolerance&&i.jsxs("div",{children:["Tolerance: ",y.tolerance]})]}),y.componentType==="ZenerDiode"&&i.jsxs(i.Fragment,{children:[y.voltage&&i.jsxs("div",{children:["Zener Voltage: ",y.voltage]}),y.power&&i.jsxs("div",{children:["Power: ",y.power]}),y.tolerance&&i.jsxs("div",{children:["Tolerance: ",y.tolerance]})]}),i.jsx("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid #eee",fontSize:"10px",color:"#999"},children:i.jsxs("div",{children:["Position: x=",y.x.toFixed(2),", y=",y.y.toFixed(2)]})})]})]},y.id))})(),u.size>0&&$.filter(z=>u.has(z.id)&&z.type==="via"&&z.points.length>0).map(z=>{const y=z.points[0],Q=z.viaType||(y.id!==void 0?le(y.id,ue):"Via (Signal)");return i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:Q})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[y.id&&i.jsxs("div",{children:["Node ID: ",y.id]}),i.jsx("div",{children:"Layer: Top and Bottom"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:z.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:z.color})]}),i.jsxs("div",{children:["Size: ",z.size]}),i.jsxs("div",{children:["Position: x=",y.x.toFixed(2),", y=",y.y.toFixed(2)]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:z.notes||"",readOnly:!0,onClick:G,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},z.id)}),u.size>0&&$.filter(z=>u.has(z.id)&&z.type==="pad"&&z.points.length>0).map(z=>{const y=z.points[0],Q=z.padType||(y.id!==void 0?Me(y.id,ue):"Pad (Signal)");return i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:Q})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[y.id&&i.jsxs("div",{children:["Node ID: ",y.id]}),i.jsxs("div",{children:["Layer: ",z.layer]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:z.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:z.color})]}),i.jsxs("div",{children:["Size: ",z.size]}),i.jsxs("div",{children:["Position: x=",y.x.toFixed(2),", y=",y.y.toFixed(2)]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:z.notes||"",readOnly:!0,onClick:G,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},z.id)}),u.size>0&&$.filter(z=>u.has(z.id)&&z.type==="testPoint"&&z.points.length>0).map(z=>{const y=z.points[0],Q=z.testPointType||(y.id!==void 0?Ie(y.id,ue):"Test Point (Signal)");return i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:Q})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[y.id&&i.jsxs("div",{children:["Node ID: ",y.id]}),i.jsxs("div",{children:["Layer: ",z.layer]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:z.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:z.color})]}),i.jsxs("div",{children:["Size: ",z.size]}),i.jsxs("div",{children:["Position: x=",y.x.toFixed(2),", y=",y.y.toFixed(2)]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:z.notes||"",readOnly:!0,onClick:G,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},z.id)}),u.size>0&&$.filter(z=>u.has(z.id)&&z.type==="trace").map(z=>i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:z.type||"unknown"})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[z.points.length>0&&i.jsxs("div",{style:{marginTop:"8px",marginBottom:"8px"},children:[i.jsxs("div",{style:{marginBottom:"4px",fontWeight:600},children:["Points: ",z.points.length]}),i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px",border:"1px solid #ddd"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Point #"}),i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"x"}),i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"y"}),i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Node ID"})]})}),i.jsx("tbody",{children:z.points.map((y,Q)=>i.jsxs("tr",{style:{backgroundColor:Q%2===0?"#fff":"#f9f9f9"},children:[i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:Q}),i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:y.x.toFixed(2)}),i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:y.y.toFixed(2)}),i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:y.id||"(none)"})]},Q))})]})]}),i.jsxs("div",{style:{marginTop:"4px"},children:["Layer: ",z.layer]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:z.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:z.color})]}),i.jsxs("div",{children:["Size: ",z.size]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:z.notes||"",readOnly:!0,onClick:G,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},z.id)),d.size>0&&g.filter(z=>d.has(z.id)).map(z=>{const y=ue.find(Q=>Q.id===z.powerBusId);return i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:z.type||(y?`${y.name} Power Node`:"Power Node")})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[i.jsxs("div",{children:["Node ID: ",z.pointId||"(not assigned)"]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:z.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:z.color})]}),i.jsxs("div",{children:["Size: ",z.size]}),i.jsxs("div",{children:["Layer: ",z.layer]}),i.jsxs("div",{children:["Power Bus: ",y?.name||z.powerBusId||"(unknown)"]}),i.jsxs("div",{children:["Position: x=",z.x.toFixed(2),", y=",z.y.toFixed(2)]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:z.notes||"",readOnly:!0,onClick:G,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},z.id)}),D.size>0&&I.filter(z=>D.has(z.id)).map(z=>i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:z.type||"Ground Node"})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[i.jsxs("div",{children:["Node ID: ",z.pointId||"(not assigned)"]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:z.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:z.color})]}),i.jsxs("div",{children:["Size: ",z.size]}),i.jsxs("div",{children:["Position: x=",z.x.toFixed(2),", y=",z.y.toFixed(2)]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:z.notes||"",readOnly:!0,onClick:G,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},z.id))]})})]})},_n=200,yx=({visible:c,selectedIds:u,selectedComponentIds:b,selectedPowerIds:d,selectedGroundIds:D,drawingStrokes:$,componentsTop:Se,componentsBottom:ye,powers:g,grounds:I,powerBuses:ue,onClose:ve,setComponentsTop:je,setComponentsBottom:Ae,setDrawingStrokes:le,setPowerSymbols:Me,setGroundSymbols:Ie,determineViaType:ae,determinePadType:Fe,determineTestPointType:ge,position:U,isDragging:G,onDragStart:A})=>{const[R,z]=w.useState(new Map),y=w.useRef(""),Q=()=>[...Array.from(u).sort(),...Array.from(b).sort(),...Array.from(d).sort(),...Array.from(D).sort()].join(",");if(w.useEffect(()=>{if(!c)return;const F=Q();F!==y.current&&(y.current=F,z(C=>{const M=new Map;return[...Se,...ye].filter(H=>b.has(H.id)).forEach(H=>{const he=C.get(H.id);M.set(H.id,he!==void 0?he:H.notes||"")}),$.filter(H=>u.has(H.id)).forEach(H=>{const he=C.get(H.id);M.set(H.id,he!==void 0?he:H.notes||"")}),g.filter(H=>d.has(H.id)).forEach(H=>{const he=C.get(H.id);M.set(H.id,he!==void 0?he:H.notes||"")}),I.filter(H=>D.has(H.id)).forEach(H=>{const he=C.get(H.id);M.set(H.id,he!==void 0?he:H.notes||"")}),M}))},[c,u,b,d,D,$,Se,ye,g,I]),!c)return null;const Re=U?{position:"fixed",left:`${U.x}px`,top:`${U.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"150px",maxWidth:"400px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:G?"grabbing":"default"}:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"flex-start",justifyContent:"flex-end",paddingRight:"20px",paddingTop:"80px",zIndex:1e4,pointerEvents:"none"},Oe={padding:"20px",overflow:"auto",flex:1},fe=$.filter(F=>u.has(F.id)).length,Ee=[...Se,...ye].filter(F=>b.has(F.id)).length,se=g.filter(F=>d.has(F.id)).length,_=I.filter(F=>D.has(F.id)).length,O=fe+Ee+se+_,W=(F,C)=>{const M=C.length>_n?C.substring(0,_n):C;z(H=>{const he=new Map(H);return he.set(F,M),he})},Te=()=>{je(F=>F.map(C=>{if(b.has(C.id)&&R.has(C.id)){const M=R.get(C.id)||"";return{...C,notes:M.trim()===""?null:M.trim()}}return C})),Ae(F=>F.map(C=>{if(b.has(C.id)&&R.has(C.id)){const M=R.get(C.id)||"";return{...C,notes:M.trim()===""?null:M.trim()}}return C})),le(F=>F.map(C=>{if(u.has(C.id)&&R.has(C.id)){const M=R.get(C.id)||"";return{...C,notes:M.trim()===""?null:M.trim()}}return C})),Me(F=>F.map(C=>{if(d.has(C.id)&&R.has(C.id)){const M=R.get(C.id)||"";return{...C,notes:M.trim()===""?null:M.trim()}}return C})),Ie(F=>F.map(C=>{if(D.has(C.id)&&R.has(C.id)){const M=R.get(C.id)||"";return{...C,notes:M.trim()===""?null:M.trim()}}return C}))};return i.jsxs("div",{style:Re,children:[i.jsxs("div",{onMouseDown:F=>{const C=F.target;C.tagName==="BUTTON"||C.closest("button")||U&&A(F)},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:G?"grabbing":U?"grab":"default",userSelect:"none",flexShrink:0},children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Notes (N)"}),i.jsx("button",{onClick:ve,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsx("div",{style:Oe,children:i.jsxs("div",{style:{margin:0,padding:0,backgroundColor:"#f5f5f5",borderRadius:4,fontSize:"12px",fontFamily:"monospace",maxHeight:"calc(80vh - 100px)",overflow:"auto",color:"#000"},children:[i.jsx("div",{style:{padding:"12px 16px",backgroundColor:O>0?"#e8e8e8":"#fff3cd",borderBottom:"2px solid #ccc",fontSize:"13px",fontWeight:600,color:O>0?"#333":"#856404",marginBottom:"8px"},children:O>0?`${O} Object${O!==1?"s":""} Selected`:"Zero Objects Selected"}),O===0?i.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"No objects selected. Select one or more objects to add or edit notes."}):i.jsxs(i.Fragment,{children:[[...Se,...ye].filter(F=>b.has(F.id)).map(F=>{const C=R.get(F.id)||"",M=C.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsxs("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:[Md(F.componentType),F.designator&&F.designator.trim()?` (${F.designator.trim()})`:""]})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("textarea",{value:C,onChange:H=>W(F.id,H.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:_n,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:M>=_n?"#d32f2f":"#666",textAlign:"right"},children:[M," / ",_n]})]})]},F.id)}),$.filter(F=>u.has(F.id)&&F.type==="via"&&F.points.length>0).map(F=>{const C=F.points[0],M=F.viaType||(C.id!==void 0?ae(C.id,ue):"Via (Signal)"),H=R.get(F.id)||"",he=H.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:M})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:C.id&&i.jsxs("div",{children:["Node ID: ",C.id]})}),i.jsx("textarea",{value:H,onChange:We=>W(F.id,We.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:_n,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:he>=_n?"#d32f2f":"#666",textAlign:"right"},children:[he," / ",_n]})]})]},F.id)}),$.filter(F=>u.has(F.id)&&F.type==="pad"&&F.points.length>0).map(F=>{const C=F.points[0],M=F.padType||(C.id!==void 0?Fe(C.id,ue):"Pad (Signal)"),H=R.get(F.id)||"",he=H.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:M})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:C.id&&i.jsxs("div",{children:["Node ID: ",C.id]})}),i.jsx("textarea",{value:H,onChange:We=>W(F.id,We.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:_n,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:he>=_n?"#d32f2f":"#666",textAlign:"right"},children:[he," / ",_n]})]})]},F.id)}),$.filter(F=>u.has(F.id)&&F.type==="testPoint"&&F.points.length>0).map(F=>{const C=F.points[0],M=F.testPointType||(C.id!==void 0?ge(C.id,ue):"Test Point (Signal)"),H=R.get(F.id)||"",he=H.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:M})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:C.id&&i.jsxs("div",{children:["Node ID: ",C.id]})}),i.jsx("textarea",{value:H,onChange:We=>W(F.id,We.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:_n,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:he>=_n?"#d32f2f":"#666",textAlign:"right"},children:[he," / ",_n]})]})]},F.id)}),$.filter(F=>u.has(F.id)&&F.type==="trace").map(F=>{const C=R.get(F.id)||"",M=C.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:F.type||"unknown"})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("textarea",{value:C,onChange:H=>W(F.id,H.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:_n,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:M>=_n?"#d32f2f":"#666",textAlign:"right"},children:[M," / ",_n]})]})]},F.id)}),g.filter(F=>d.has(F.id)).map(F=>{const C=ue.find(We=>We.id===F.powerBusId),M=F.type||(C?`${C.name} Power Node`:"Power Node"),H=R.get(F.id)||"",he=H.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:M})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:i.jsxs("div",{children:["Node ID: ",F.pointId||"(not assigned)"]})}),i.jsx("textarea",{value:H,onChange:We=>W(F.id,We.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:_n,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:he>=_n?"#d32f2f":"#666",textAlign:"right"},children:[he," / ",_n]})]})]},F.id)}),I.filter(F=>D.has(F.id)).map(F=>{const C=F.type||"Ground Node",M=R.get(F.id)||"",H=M.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:C})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:i.jsxs("div",{children:["Node ID: ",F.pointId||"(not assigned)"]})}),i.jsx("textarea",{value:M,onChange:he=>W(F.id,he.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:_n,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:H>=_n?"#d32f2f":"#666",textAlign:"right"},children:[H," / ",_n]})]})]},F.id)}),i.jsxs("div",{style:{marginTop:"20px",padding:"12px",display:"flex",justifyContent:"flex-end",gap:"8px",borderTop:"1px solid #ddd"},children:[i.jsx("button",{onClick:ve,style:{padding:"8px 16px",fontSize:"12px",backgroundColor:"#757575",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500},onMouseEnter:F=>{F.currentTarget.style.backgroundColor="#616161"},onMouseLeave:F=>{F.currentTarget.style.backgroundColor="#757575"},children:"Close"}),i.jsx("button",{onClick:Te,style:{padding:"8px 16px",fontSize:"12px",backgroundColor:"#2196F3",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500},onMouseEnter:F=>{F.currentTarget.style.backgroundColor="#1976D2"},onMouseLeave:F=>{F.currentTarget.style.backgroundColor="#2196F3"},children:"Save"})]})]})]})})]})},bx=({visible:c,projectNotes:u,setProjectNotes:b,onClose:d,position:D,isDragging:$,onDragStart:Se})=>{const[ye,g]=w.useState([]),[I,ue]=w.useState(null),[ve,je]=w.useState(null),Ae=w.useRef(new Map),[le,Me]=w.useState({width:Math.min(window.innerWidth*.85,1400),height:window.innerHeight*.7}),[Ie,ae]=w.useState(!1),[Fe,ge]=w.useState({x:0,y:0,width:0,height:0});w.useEffect(()=>{c&&(g([...u]),ue(null),je(null))},[c,u]),w.useEffect(()=>{if(!Ie)return;const se=O=>{const W=O.clientX-Fe.x,Te=O.clientY-Fe.y,F=Math.max(400,Math.min(window.innerWidth-20,Fe.width+W)),C=Math.max(300,Math.min(window.innerHeight-20,Fe.height+Te));Me({width:F,height:C})},_=()=>{ae(!1)};return document.addEventListener("mousemove",se),document.addEventListener("mouseup",_),()=>{document.removeEventListener("mousemove",se),document.removeEventListener("mouseup",_)}},[Ie,Fe]);const U=se=>{se.preventDefault(),se.stopPropagation(),ae(!0),ge({x:se.clientX,y:se.clientY,width:le.width,height:le.height})};if(!c)return null;const G=()=>{const se={name:"",value:"",checked:!1};g([...ye,se]),ue(ye.length),je("name")},A=se=>{const _=ye.filter((O,W)=>W!==se);g(_),I===se?(ue(null),je(null)):I!==null&&I>se&&ue(I-1)},R=()=>{const se=ye.filter(_=>_.name.trim()!==""||_.value.trim()!=="");b(se),d()},z=()=>{g([...u]),ue(null),je(null),d()},y=(se,_,O)=>{const W=[...ye];W[se]={...W[se],[_]:O},g(W)},Q=(se,_)=>{const O=[...ye];O[se]={...O[se],checked:_},g(O)},Re=(se,_,O)=>{se.stopPropagation();const W=se.currentTarget,Te=W.selectionStart,F=W.value.length,C=W.selectionStart!==W.selectionEnd;if(!(se.key==="Enter"&&se.altKey)){if(se.key==="ArrowRight"&&!se.ctrlKey&&!se.shiftKey&&!se.altKey){if(Te===F&&!C&&O==="name"){se.preventDefault();const M=`${_}-value`,H=Ae.current.get(M);H&&(H.focus(),H.setSelectionRange(0,0))}return}if(se.key==="ArrowLeft"&&!se.ctrlKey&&!se.shiftKey&&!se.altKey){if(Te===0&&!C&&O==="value"){se.preventDefault();const M=`${_}-name`,H=Ae.current.get(M);H&&(H.focus(),H.setSelectionRange(H.value.length,H.value.length))}return}if(se.key==="ArrowDown"&&!se.ctrlKey&&!se.shiftKey&&!se.altKey){if(se.preventDefault(),_<ye.length-1){const M=`${_+1}-${O}`,H=Ae.current.get(M);if(H){H.focus();const he=Math.min(Te,H.value.length);H.setSelectionRange(he,he)}}else{const M=ye.length;G(),setTimeout(()=>{const H=`${M}-${O}`,he=Ae.current.get(H);he&&(he.focus(),he.setSelectionRange(0,0))},0)}return}if(se.key==="ArrowUp"&&!se.ctrlKey&&!se.shiftKey&&!se.altKey){if(se.preventDefault(),_>0){const M=`${_-1}-${O}`,H=Ae.current.get(M);if(H){H.focus();const he=Math.min(Te,H.value.length);H.setSelectionRange(he,he)}}return}if(se.key==="Enter"&&!se.altKey&&!se.shiftKey){if(se.preventDefault(),O==="name"){const M=`${_}-value`,H=Ae.current.get(M);H&&(H.focus(),H.setSelectionRange(0,0))}else if(O==="value")if(_<ye.length-1){const M=`${_+1}-name`,H=Ae.current.get(M);H&&(H.focus(),H.setSelectionRange(0,0))}else{const M=ye.length;G(),setTimeout(()=>{const H=`${M}-name`,he=Ae.current.get(H);he&&(he.focus(),he.setSelectionRange(0,0))},0)}return}if(se.key==="Tab"&&!se.shiftKey){if(se.preventDefault(),O==="name"){const M=`${_}-value`,H=Ae.current.get(M);H&&(H.focus(),H.select())}else if(O==="value")if(_<ye.length-1){const M=`${_+1}-name`,H=Ae.current.get(M);H&&(H.focus(),H.select())}else{const M=ye.length;G(),setTimeout(()=>{const H=`${M}-name`,he=Ae.current.get(H);he&&he.focus()},0)}return}if(se.key==="Tab"&&se.shiftKey){if(se.preventDefault(),O==="value"){const M=`${_}-name`,H=Ae.current.get(M);H&&(H.focus(),H.select())}else if(O==="name"&&_>0){const M=`${_-1}-value`,H=Ae.current.get(M);H&&(H.focus(),H.select())}return}}},Oe=(se,_)=>{ue(se),je(_)},fe=()=>{},Ee={position:"fixed",top:D?.y??100,left:D?.x??(window.innerWidth-le.width)/2,width:`${le.width}px`,height:`${le.height}px`,backgroundColor:"#fff",borderRadius:8,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:$?"grabbing":"default",overflow:"hidden"};return i.jsxs("div",{style:Ee,children:[i.jsxs("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e0e0",background:"#888",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"move",userSelect:"none"},onMouseDown:Se,children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Project Notes / TODO List (L)"}),i.jsx("button",{onClick:z,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:"0 4px",lineHeight:1},title:"Close",children:""})]}),i.jsxs("div",{className:"project-notes-content",style:{padding:0,flex:1,overflowY:"auto",overflowX:"hidden",display:"flex",flexDirection:"column",minHeight:0,scrollbarWidth:"thin",scrollbarColor:"#888 #f0f0f0"},children:[i.jsxs("div",{style:{border:"none",borderTop:"1px solid #ccc",borderRadius:0,overflow:"visible",marginBottom:"16px",backgroundColor:"#e0e0e0",flexShrink:0},children:[i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"40px 1fr 3fr auto",backgroundColor:"#e0e0e0",borderBottom:"1px solid #ccc",position:"sticky",top:0,zIndex:10},children:[i.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",display:"flex",alignItems:"center",justifyContent:"center",color:"#000"},children:i.jsx("label",{className:"radio-label",style:{margin:0,cursor:"default"},children:i.jsx("input",{type:"checkbox",disabled:!0,style:{opacity:.5}})})}),i.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",color:"#000"},children:"Item"}),i.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",color:"#000"},children:"Notes"}),i.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",color:"#000"}})]}),i.jsx("div",{children:ye.length===0?i.jsx("div",{style:{padding:"24px",textAlign:"center",color:"#999",fontSize:"13px"},children:'No notes. Click "Add Note" to create one.'}):ye.map((se,_)=>i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"40px 1fr 3fr auto",borderBottom:"1px solid #ccc",backgroundColor:"#fff"},children:[i.jsx("div",{style:{padding:"8px 12px",borderRight:"1px solid #ccc",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("label",{className:"radio-label",style:{margin:0,cursor:"pointer"},children:i.jsx("input",{type:"checkbox",checked:se.checked||!1,onChange:O=>Q(_,O.target.checked)})})}),i.jsx("div",{style:{padding:"4px",borderRight:"1px solid #ccc"},children:i.jsx("textarea",{ref:O=>{O?Ae.current.set(`${_}-name`,O):Ae.current.delete(`${_}-name`)},value:se.name,onChange:O=>y(_,"name",O.target.value),onFocus:()=>Oe(_,"name"),onBlur:fe,onKeyDown:O=>Re(O,_,"name"),placeholder:"Item name...",rows:1,style:{width:"100%",padding:"4px 6px",border:I===_&&ve==="name"?"2px solid #0b5fff":"1px solid transparent",borderRadius:3,fontSize:"12px",backgroundColor:"#fff",color:"#000",fontFamily:"inherit",resize:"none",minHeight:"24px",lineHeight:"1.4",overflow:"hidden",outline:"none",boxSizing:"border-box"},onInput:O=>{const W=O.target;W.style.height="auto",W.style.height=`${W.scrollHeight}px`}})}),i.jsx("div",{style:{padding:"4px",borderRight:"1px solid #ccc"},children:i.jsx("textarea",{ref:O=>{O?Ae.current.set(`${_}-value`,O):Ae.current.delete(`${_}-value`)},value:se.value,onChange:O=>y(_,"value",O.target.value),onFocus:()=>Oe(_,"value"),onBlur:fe,onKeyDown:O=>Re(O,_,"value"),placeholder:"Notes...",rows:1,style:{width:"100%",padding:"4px 6px",border:I===_&&ve==="value"?"2px solid #0b5fff":"1px solid transparent",borderRadius:3,fontSize:"12px",backgroundColor:"#fff",color:"#000",fontFamily:"inherit",resize:"none",minHeight:"24px",lineHeight:"1.4",overflow:"hidden",outline:"none",boxSizing:"border-box"},onInput:O=>{const W=O.target;W.style.height="auto",W.style.height=`${W.scrollHeight}px`}})}),i.jsx("div",{style:{padding:"8px 12px",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("button",{onClick:()=>A(_),style:{background:"#f44336",color:"#fff",border:"none",borderRadius:3,padding:"4px 8px",cursor:"pointer",fontSize:"11px"},title:"Delete note",children:"Delete"})})]},_))})]}),i.jsx("div",{style:{padding:"16px",flexShrink:0},children:i.jsx("button",{onClick:G,style:{background:"#888",color:"#fff",border:"none",borderRadius:4,padding:"8px 16px",cursor:"pointer",fontSize:"12px",fontWeight:500,alignSelf:"flex-start"},children:"+ Add Note"})})]}),i.jsxs("div",{style:{padding:"12px 16px",borderTop:"1px solid #ddd",display:"flex",justifyContent:"flex-end",gap:"8px",flexShrink:0},children:[i.jsx("button",{onClick:z,style:{background:"#f5f5f5",color:"#000",border:"1px solid #ddd",borderRadius:4,padding:"6px 16px",cursor:"pointer",fontSize:"12px"},children:"Cancel"}),i.jsx("button",{onClick:R,style:{background:"#0b5fff",color:"#fff",border:"none",borderRadius:4,padding:"6px 16px",cursor:"pointer",fontSize:"12px",fontWeight:500},children:"Save"})]}),i.jsx("div",{onMouseDown:U,style:{position:"absolute",bottom:0,right:0,width:"20px",height:"20px",cursor:"nwse-resize",background:"linear-gradient(135deg, transparent 0%, transparent 40%, #ccc 40%, #ccc 45%, transparent 45%, transparent 55%, #ccc 55%, #ccc 60%, transparent 60%)",zIndex:10001},title:"Drag to resize"})]})},vx=({visible:c,dimensions:u,onSave:b,onClose:d})=>{const[D,$]=w.useState(""),[Se,ye]=w.useState(""),[g,I]=w.useState("inches");w.useEffect(()=>{c&&u?($(u.width.toString()),ye(u.height.toString()),I(u.unit)):c&&($(""),ye(""),I("inches"))},[c,u]);const ue=()=>{const je=parseFloat(D),Ae=parseFloat(Se);if(isNaN(je)||je<=0){alert("Please enter a valid width greater than 0");return}if(isNaN(Ae)||Ae<=0){alert("Please enter a valid height greater than 0");return}b({width:je,height:Ae,unit:g}),d()},ve=()=>{d()};return c?i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:je=>{je.target===je.currentTarget&&ve()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"320px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #444"},onClick:je=>je.stopPropagation(),children:[i.jsx("h3",{style:{margin:"0 0 20px 0",color:"#fff",fontSize:"18px",fontWeight:600},children:"Board Dimensions"}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#ddd",fontSize:"14px"},children:"Width"}),i.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[i.jsx("input",{type:"number",step:"0.001",min:"0.001",value:D,onChange:je=>$(je.target.value),style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px"},placeholder:"0.000"}),i.jsxs("select",{value:g,onChange:je=>I(je.target.value),style:{padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px",cursor:"pointer"},children:[i.jsx("option",{value:"inches",children:"inches"}),i.jsx("option",{value:"mm",children:"mm"})]})]})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#ddd",fontSize:"14px"},children:"Height"}),i.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[i.jsx("input",{type:"number",step:"0.001",min:"0.001",value:Se,onChange:je=>ye(je.target.value),style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px"},placeholder:"0.000"}),i.jsxs("select",{value:g,onChange:je=>I(je.target.value),style:{padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px",cursor:"pointer"},children:[i.jsx("option",{value:"inches",children:"inches"}),i.jsx("option",{value:"mm",children:"mm"})]})]})]}),i.jsx("div",{style:{marginBottom:"12px",padding:"10px",background:"#1f1f24",borderRadius:4,fontSize:"12px",color:"#bbb"},children:"This information will be used to convert pixel coordinates to real-world measurements."}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[i.jsx("button",{onClick:ve,style:{padding:"8px 16px",background:"#444",color:"#fff",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px"},children:"Cancel"}),i.jsx("button",{onClick:ue,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Save"})]})]})}):null},mx=({visible:c,onClose:u,topImage:b,bottomImage:d,selectedImageForTransform:D,setSelectedImageForTransform:$,transformMode:Se,setTransformMode:ye,updateImageTransform:g,resetImageTransform:I,setCurrentTool:ue,isGrayscale:ve,setIsGrayscale:je,isBlackAndWhiteEdges:Ae,setIsBlackAndWhiteEdges:le,isBlackAndWhiteInverted:Me,setIsBlackAndWhiteInverted:Ie,areImagesLocked:ae})=>{const[Fe,ge]=w.useState(null),[U,G]=w.useState(!1),A=w.useRef({x:0,y:0}),R=w.useRef(null);w.useEffect(()=>{c&&Fe===null&&ge({x:window.innerWidth-320-20,y:80})},[c,Fe]),w.useEffect(()=>{c||ge(null)},[c]);const z=w.useCallback(ce=>{if(R.current){const en=R.current.getBoundingClientRect();A.current={x:ce.clientX-en.left,y:ce.clientY-en.top},G(!0)}},[]);if(w.useEffect(()=>{if(!U)return;const ce=Hn=>{const El=Hn.clientX-A.current.x,Ni=Hn.clientY-A.current.y,Mi=R.current?.offsetWidth||320,Xn=R.current?.offsetHeight||600,Ui=Math.max(0,Math.min(El,window.innerWidth-Mi)),si=Math.max(0,Math.min(Ni,window.innerHeight-Xn));ge({x:Ui,y:si})},en=()=>{G(!1)};return document.addEventListener("mousemove",ce),document.addEventListener("mouseup",en),()=>{document.removeEventListener("mousemove",ce),document.removeEventListener("mouseup",en)}},[U]),!c)return null;const y=b!==null,Q=d!==null,Re=y||Q,Oe=y&&Q,fe=D||(y?"top":Q?"bottom":null),Ee=()=>fe==="top"&&b?b.brightness??100:fe==="bottom"&&d?d.brightness??100:fe==="both"&&b?b.brightness??100:100,se=()=>fe==="top"&&b?b.contrast??100:fe==="bottom"&&d?d.contrast??100:fe==="both"&&b?b.contrast??100:100,_=Ee(),O=se(),W=!Re||ae,Te=()=>{if(!(!fe||W))if(fe==="both"){const ce=!b?.flipX;g("both",{flipX:ce})}else{const ce=fe==="top"?b?.flipX||!1:d?.flipX||!1;g(fe,{flipX:!ce})}},F=()=>{if(!(!fe||W))if(fe==="both"){const ce=!b?.flipY;g("both",{flipY:ce})}else{const ce=fe==="top"?b?.flipY||!1:d?.flipY||!1;g(fe,{flipY:!ce})}},C=ce=>{W||(fe&&$(fe),ye(ce),ue("transform"))},M=ce=>{!fe||W||g(fe,{brightness:ce})},H=ce=>{!fe||W||g(fe,{contrast:ce})},he=()=>{W||(fe&&$(fe),ue("transform"),ve||Ae?(je(!1),le(!1),Ie(!1)):je(!0))},We=()=>{W||(fe&&$(fe),ue("transform"),Ae?Ie(ce=>!ce):(le(!0),Ie(!1)))},et=()=>{W||(ue("transform"),I())},it=(ce,en=!1)=>({display:"block",width:"100%",textAlign:"left",padding:"8px 12px",color:ce?"#666":"#f2f2f2",background:en?"#3a3a42":"transparent",border:"none",borderRadius:4,cursor:ce?"not-allowed":"pointer",fontSize:"13px",transition:"background 0.15s"}),on=(ce,en)=>({display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",color:ce?"#666":"#f2f2f2",cursor:ce?"not-allowed":"pointer",fontSize:"13px",background:en?"#3a3a42":"transparent",borderRadius:4,transition:"background 0.15s"});return i.jsxs("div",{ref:R,style:{position:"fixed",top:Fe?.y??80,left:Fe?.x??window.innerWidth-340,backgroundColor:"#2b2b31",borderRadius:8,minWidth:"320px",maxWidth:"400px",maxHeight:"calc(100vh - 100px)",overflowY:"auto",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24",zIndex:10001},children:[i.jsxs("div",{onMouseDown:z,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 16px",background:"linear-gradient(to bottom, #3a3a42, #2b2b31)",borderTopLeftRadius:8,borderTopRightRadius:8,borderBottom:"1px solid #1f1f24",cursor:U?"grabbing":"grab",userSelect:"none"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("span",{style:{color:"#888",fontSize:"14px"},children:""}),i.jsx("h2",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#f2f2f2"},children:"Transform Images"})]}),i.jsx("button",{onClick:u,style:{background:"transparent",border:"none",color:"#888",fontSize:"16px",cursor:"pointer",padding:"2px 6px",lineHeight:1,borderRadius:4},onMouseEnter:ce=>{ce.currentTarget.style.background="#444",ce.currentTarget.style.color="#fff"},onMouseLeave:ce=>{ce.currentTarget.style.background="transparent",ce.currentTarget.style.color="#888"},children:""})]}),i.jsxs("div",{style:{padding:"16px"},children:[i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("div",{style:{fontSize:"12px",color:"#888",marginBottom:"8px",fontWeight:500},children:"Apply to:"}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[i.jsxs("label",{style:on(!y,fe==="top"),children:[i.jsx("input",{type:"radio",name:"imageSelection",checked:fe==="top",onChange:()=>$("top"),disabled:!y,style:{accentColor:"#6b9fff"}}),"Top Image",!y&&i.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(not loaded)"})]}),i.jsxs("label",{style:on(!Q,fe==="bottom"),children:[i.jsx("input",{type:"radio",name:"imageSelection",checked:fe==="bottom",onChange:()=>$("bottom"),disabled:!Q,style:{accentColor:"#6b9fff"}}),"Bottom Image",!Q&&i.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(not loaded)"})]}),i.jsxs("label",{style:on(!Oe,fe==="both"),children:[i.jsx("input",{type:"radio",name:"imageSelection",checked:fe==="both",onChange:()=>$("both"),disabled:!Oe,style:{accentColor:"#6b9fff"}}),"Both Images",!Oe&&i.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(need both)"})]})]})]}),i.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),i.jsxs("div",{style:{marginBottom:"12px"},children:[i.jsx("button",{onClick:Te,disabled:W,style:it(W),onMouseEnter:ce=>!W&&(ce.currentTarget.style.background="#3a3a42"),onMouseLeave:ce=>ce.currentTarget.style.background="transparent",children:"Horizontal Flip"}),i.jsx("button",{onClick:F,disabled:W,style:it(W),onMouseEnter:ce=>!W&&(ce.currentTarget.style.background="#3a3a42"),onMouseLeave:ce=>ce.currentTarget.style.background="transparent",children:"Vertical Flip"})]}),i.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),i.jsx("div",{style:{marginBottom:"12px"},children:["nudge","scale","rotate","slant","keystone"].map(ce=>i.jsxs("button",{onClick:()=>C(ce),disabled:W,style:it(W,Se===ce),onMouseEnter:en=>!W&&Se!==ce&&(en.currentTarget.style.background="#3a3a42"),onMouseLeave:en=>Se!==ce&&(en.currentTarget.style.background="transparent"),children:[Se===ce?" ":"","Mode: ",ce.charAt(0).toUpperCase()+ce.slice(1)]},ce))}),i.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[i.jsx("label",{style:{color:"#f2f2f2",fontSize:"13px",fontWeight:500},children:"Brightness"}),i.jsxs("span",{style:{color:"#888",fontSize:"12px",minWidth:"45px",textAlign:"right"},children:[_,"%"]})]}),i.jsx("input",{type:"range",min:"0",max:"200",step:"1",value:_,onChange:ce=>M(parseInt(ce.target.value,10)),disabled:W,style:{width:"100%",cursor:W?"not-allowed":"pointer",accentColor:"#6b9fff"}})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[i.jsx("label",{style:{color:"#f2f2f2",fontSize:"13px",fontWeight:500},children:"Contrast"}),i.jsxs("span",{style:{color:"#888",fontSize:"12px",minWidth:"45px",textAlign:"right"},children:[O,"%"]})]}),i.jsx("input",{type:"range",min:"0",max:"200",step:"1",value:O,onChange:ce=>H(parseInt(ce.target.value,10)),disabled:W,style:{width:"100%",cursor:W?"not-allowed":"pointer",accentColor:"#6b9fff"}})]}),i.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),i.jsxs("div",{style:{marginBottom:"12px"},children:[i.jsxs("button",{onClick:he,disabled:W,style:it(W,ve&&!Ae),onMouseEnter:ce=>!W&&!(ve&&!Ae)&&(ce.currentTarget.style.background="#3a3a42"),onMouseLeave:ce=>!(ve&&!Ae)&&(ce.currentTarget.style.background="transparent"),children:[ve&&!Ae?" ":"","Grayscale Mode"]}),i.jsxs("button",{onClick:We,disabled:W,style:it(W,Ae),onMouseEnter:ce=>!W&&!Ae&&(ce.currentTarget.style.background="#3a3a42"),onMouseLeave:ce=>!Ae&&(ce.currentTarget.style.background="transparent"),children:[Ae?Me?" Inverted ":" ":"","Black & White Edges"]})]}),i.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[i.jsx("button",{onClick:et,disabled:W,style:{padding:"8px 16px",background:W?"#444":"#555",color:W?"#777":"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:W?"not-allowed":"pointer",fontSize:"13px",fontWeight:500},children:"Reset Transform"}),i.jsx("button",{onClick:u,style:{padding:"8px 16px",background:"#4a9eff",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:500},onMouseEnter:ce=>ce.currentTarget.style.background="#3a8ee6",onMouseLeave:ce=>ce.currentTarget.style.background="#4a9eff",children:"Close"})]}),ae&&i.jsx("div",{style:{marginTop:"12px",padding:"8px 12px",background:"#3d2b2b",border:"1px solid #5a3a3a",borderRadius:4,fontSize:"12px",color:"#e88"},children:" Images are locked. Unlock via Images  Lock Images to make changes."})]})]})},Sx=({component:c,componentEditor:u,setComponentEditor:b,areComponentsLocked:d,componentsTop:D,componentsBottom:$,setComponentsTop:Se,setComponentsBottom:ye})=>i.jsxs(i.Fragment,{children:[c.componentType==="Resistor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-resistance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),i.jsx("input",{id:`component-resistance-${c.id}`,type:"text",value:u.resistance||"",onChange:g=>b({...u,resistance:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 10"}),i.jsx("select",{value:u.resistanceUnit||Ye("resistance"),onChange:g=>b({...u,resistanceUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("resistance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-power-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),i.jsxs("select",{id:`component-power-${c.id}`,value:u.power||"1/4",onChange:g=>b({...u,power:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"12px"},children:[i.jsx("option",{value:"1/20",children:"1/20 W"}),i.jsx("option",{value:"1/16",children:"1/16 W"}),i.jsx("option",{value:"1/10",children:"1/10 W"}),i.jsx("option",{value:"1/8",children:"1/8 W"}),i.jsx("option",{value:"1/4",children:"1/4 W"}),i.jsx("option",{value:"1/2",children:"1/2 W"}),i.jsx("option",{value:"1",children:"1 W"}),i.jsx("option",{value:"2",children:"2 W"}),i.jsx("option",{value:"3",children:"3 W"}),i.jsx("option",{value:"5",children:"5 W"}),i.jsx("option",{value:"10",children:"10 W"}),i.jsx("option",{value:"25",children:"25 W"}),i.jsx("option",{value:"50",children:"50 W"}),i.jsx("option",{value:"100",children:"100 W"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-tolerance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),i.jsxs("select",{id:`component-tolerance-${c.id}`,value:u.tolerance||"5%",onChange:g=>b({...u,tolerance:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"0.05%",children:"0.05%"}),i.jsx("option",{value:"0.1%",children:"0.1%"}),i.jsx("option",{value:"0.25%",children:"0.25%"}),i.jsx("option",{value:"0.5%",children:"0.5%"}),i.jsx("option",{value:"1%",children:"1%"}),i.jsx("option",{value:"2%",children:"2%"}),i.jsx("option",{value:"5%",children:"5%"}),i.jsx("option",{value:"10%",children:"10%"}),i.jsx("option",{value:"20%",children:"20%"})]})]})]}),c.componentType==="Capacitor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-capacitance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),i.jsx("input",{id:`component-capacitance-${c.id}`,type:"text",value:u.capacitance||"",onChange:g=>b({...u,capacitance:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 100"}),i.jsx("select",{value:u.capacitanceUnit||Ye("capacitance"),onChange:g=>b({...u,capacitanceUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("capacitance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:g=>b({...u,voltage:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 50"}),i.jsx("select",{value:u.voltageUnit||Ye("voltage"),onChange:g=>b({...u,voltageUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-dielectric-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Dielectric:"}),i.jsxs("select",{id:`component-dielectric-${c.id}`,value:u.dielectric||"Ceramic",onChange:g=>b({...u,dielectric:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Ceramic",children:"Ceramic"}),i.jsx("option",{value:"Tantalum",children:"Tantalum"}),i.jsx("option",{value:"Film",children:"Film"}),i.jsx("option",{value:"Polyester",children:"Polyester"}),i.jsx("option",{value:"Polypropylene",children:"Polypropylene"}),i.jsx("option",{value:"Mica",children:"Mica"}),i.jsx("option",{value:"Paper",children:"Paper"}),i.jsx("option",{value:"Glass",children:"Glass"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-tolerance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),i.jsxs("select",{id:`component-tolerance-${c.id}`,value:u.tolerance||"10%",onChange:g=>b({...u,tolerance:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"0.5%",children:"0.5%"}),i.jsx("option",{value:"1%",children:"1%"}),i.jsx("option",{value:"2%",children:"2%"}),i.jsx("option",{value:"5%",children:"5%"}),i.jsx("option",{value:"10%",children:"10%"}),i.jsx("option",{value:"20%",children:"20%"})]})]})]}),c.componentType==="Film Capacitor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-capacitance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),i.jsx("input",{id:`component-capacitance-${c.id}`,type:"text",value:u.capacitance||"",onChange:g=>b({...u,capacitance:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 100"}),i.jsx("select",{value:u.capacitanceUnit||Ye("capacitance"),onChange:g=>b({...u,capacitanceUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("capacitance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:g=>b({...u,voltage:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 50"}),i.jsx("select",{value:u.voltageUnit||Ye("voltage"),onChange:g=>b({...u,voltageUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-filmtype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Film Type:"}),i.jsxs("select",{id:`component-filmtype-${c.id}`,value:u.filmType||"Polyester",onChange:g=>b({...u,filmType:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Polyester",children:"Polyester"}),i.jsx("option",{value:"Polypropylene",children:"Polypropylene"}),i.jsx("option",{value:"Polyethylene",children:"Polyethylene"}),i.jsx("option",{value:"Polystyrene",children:"Polystyrene"}),i.jsx("option",{value:"Polycarbonate",children:"Polycarbonate"}),i.jsx("option",{value:"PTFE",children:"PTFE (Teflon)"}),i.jsx("option",{value:"PPS",children:"PPS (Polyphenylene Sulfide)"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-tolerance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),i.jsxs("select",{id:`component-tolerance-${c.id}`,value:u.tolerance||"10%",onChange:g=>b({...u,tolerance:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"0.5%",children:"0.5%"}),i.jsx("option",{value:"1%",children:"1%"}),i.jsx("option",{value:"2%",children:"2%"}),i.jsx("option",{value:"5%",children:"5%"}),i.jsx("option",{value:"10%",children:"10%"}),i.jsx("option",{value:"20%",children:"20%"})]})]})]}),c.componentType==="Electrolytic Capacitor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-capacitance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),i.jsx("input",{id:`component-capacitance-${c.id}`,type:"text",value:u.capacitance||"",onChange:g=>b({...u,capacitance:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 100"}),i.jsxs("select",{value:u.capacitanceUnit||"F",onChange:g=>b({...u,capacitanceUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:[i.jsx("option",{value:"pF",children:"pF"}),i.jsx("option",{value:"nF",children:"nF"}),i.jsx("option",{value:"F",children:"F"}),i.jsx("option",{value:"mF",children:"mF"}),i.jsx("option",{value:"F",children:"F"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:g=>b({...u,voltage:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 25"}),i.jsx("select",{value:u.voltageUnit||Ye("voltage"),onChange:g=>b({...u,voltageUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-tolerance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),i.jsxs("select",{id:`component-tolerance-${c.id}`,value:u.tolerance||"20%",onChange:g=>b({...u,tolerance:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},children:[i.jsx("option",{value:"0.5%",children:"0.5%"}),i.jsx("option",{value:"1%",children:"1%"}),i.jsx("option",{value:"2%",children:"2%"}),i.jsx("option",{value:"5%",children:"5%"}),i.jsx("option",{value:"10%",children:"10%"}),i.jsx("option",{value:"20%",children:"20%"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-polarity-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Polarity:"}),i.jsxs("select",{id:`component-polarity-${c.id}`,value:u.polarityCapacitor||c.polarity||"Positive",onChange:g=>b({...u,polarityCapacitor:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Positive",children:"Positive"}),i.jsx("option",{value:"Negative",children:"Negative"})]})]})]}),c.componentType==="Inductor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-inductance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Inductance:"}),i.jsx("input",{id:`component-inductance-${c.id}`,type:"text",value:u.inductance||"",onChange:g=>b({...u,inductance:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 10"}),i.jsx("select",{value:u.inductanceUnit||Ye("inductance"),onChange:g=>b({...u,inductanceUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("inductance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:g=>b({...u,current:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:u.currentUnit||Ye("current"),onChange:g=>b({...u,currentUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("current").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-resistance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"DC Resistance:"}),i.jsx("input",{id:`component-resistance-${c.id}`,type:"text",value:u.resistance||"",onChange:g=>b({...u,resistance:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 50"}),i.jsx("select",{value:u.resistanceUnit||"",onChange:g=>b({...u,resistanceUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("resistance").map(g=>i.jsx("option",{value:g,children:g},g))})]})]}),c.componentType==="Diode"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-diodetype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Diode Type:"}),i.jsxs("select",{id:`component-diodetype-${c.id}`,value:u.diodeType||"Standard",onChange:g=>b({...u,diodeType:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Standard",children:"Standard"}),i.jsx("option",{value:"Zener",children:"Zener"}),i.jsx("option",{value:"LED",children:"LED"}),i.jsx("option",{value:"Schottky",children:"Schottky"}),i.jsx("option",{value:"Other",children:"Other"})]})]}),u.diodeType==="LED"&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-ledcolor-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"LED Color:"}),i.jsxs("select",{id:`component-ledcolor-${c.id}`,value:u.ledColor||"",onChange:g=>b({...u,ledColor:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"",children:"Select..."}),i.jsx("option",{value:"Red",children:"Red"}),i.jsx("option",{value:"Green",children:"Green"}),i.jsx("option",{value:"Blue",children:"Blue"}),i.jsx("option",{value:"Yellow",children:"Yellow"}),i.jsx("option",{value:"Orange",children:"Orange"}),i.jsx("option",{value:"White",children:"White"}),i.jsx("option",{value:"RGB",children:"RGB"}),i.jsx("option",{value:"IR",children:"IR (Infrared)"}),i.jsx("option",{value:"UV",children:"UV (Ultraviolet)"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:g=>b({...u,voltage:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 50"}),i.jsx("select",{value:u.voltageUnit||Ye("voltage"),onChange:g=>b({...u,voltageUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:g=>b({...u,current:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:u.currentUnit||Ye("current"),onChange:g=>b({...u,currentUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("current").map(g=>i.jsx("option",{value:g,children:g},g))})]})]}),c.componentType==="Battery"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:g=>b({...u,voltage:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 3.7"}),i.jsx("select",{value:u.voltageUnit||"V",onChange:g=>b({...u,voltageUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-capacity-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacity:"}),i.jsx("input",{id:`component-capacity-${c.id}`,type:"text",value:u.capacity||"",onChange:g=>b({...u,capacity:g.target.value}),disabled:d,style:{width:"120px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 2000mAh"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-chemistry-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Chemistry:"}),i.jsxs("select",{id:`component-chemistry-${c.id}`,value:u.chemistry||"Li-ion",onChange:g=>b({...u,chemistry:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Li-ion",children:"Li-ion"}),i.jsx("option",{value:"LiPo",children:"LiPo"}),i.jsx("option",{value:"NiMH",children:"NiMH"}),i.jsx("option",{value:"NiCd",children:"NiCd"}),i.jsx("option",{value:"Alkaline",children:"Alkaline"}),i.jsx("option",{value:"Lead-Acid",children:"Lead-Acid"}),i.jsx("option",{value:"Lithium",children:"Lithium"}),i.jsx("option",{value:"Zinc-Carbon",children:"Zinc-Carbon"})]})]})]}),c.componentType==="Fuse"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:g=>b({...u,current:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 5"}),i.jsx("select",{value:u.currentUnit||"A",onChange:g=>b({...u,currentUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("current").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:g=>b({...u,voltage:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 250"}),i.jsx("select",{value:u.voltageUnit||"V",onChange:g=>b({...u,voltageUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-fusetype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Fuse Type:"}),i.jsxs("select",{id:`component-fusetype-${c.id}`,value:u.fuseType||"Fast-blow",onChange:g=>b({...u,fuseType:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Fast-blow",children:"Fast-blow"}),i.jsx("option",{value:"Slow-blow",children:"Slow-blow"}),i.jsx("option",{value:"Time-delay",children:"Time-delay"}),i.jsx("option",{value:"Resettable",children:"Resettable"}),i.jsx("option",{value:"Cartridge",children:"Cartridge"}),i.jsx("option",{value:"Glass",children:"Glass"}),i.jsx("option",{value:"Ceramic",children:"Ceramic"})]})]})]}),c.componentType==="Relay"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-coilvoltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Coil Voltage:"}),i.jsx("input",{id:`component-coilvoltage-${c.id}`,type:"text",value:u.coilVoltage||"",onChange:g=>b({...u,coilVoltage:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 12"}),i.jsx("select",{value:u.coilVoltageUnit||Ye("voltage"),onChange:g=>b({...u,coilVoltageUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-contacttype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Contact Type:"}),i.jsxs("select",{id:`component-contacttype-${c.id}`,value:u.contactType||"SPST",onChange:g=>b({...u,contactType:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"SPST",children:"SPST (Single Pole Single Throw)"}),i.jsx("option",{value:"SPDT",children:"SPDT (Single Pole Double Throw)"}),i.jsx("option",{value:"DPST",children:"DPST (Double Pole Single Throw)"}),i.jsx("option",{value:"DPDT",children:"DPDT (Double Pole Double Throw)"}),i.jsx("option",{value:"3PDT",children:"3PDT (3 Pole Double Throw)"}),i.jsx("option",{value:"4PDT",children:"4PDT (4 Pole Double Throw)"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:g=>b({...u,current:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 10"}),i.jsx("select",{value:u.currentUnit||Ye("current"),onChange:g=>b({...u,currentUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("current").map(g=>i.jsx("option",{value:g,children:g},g))})]})]}),c.componentType==="Motor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-motortype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Motor Type:"}),i.jsxs("select",{id:`component-motortype-${c.id}`,value:u.motorType||"DC",onChange:g=>b({...u,motorType:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"DC",children:"DC Motor"}),i.jsx("option",{value:"Stepper",children:"Stepper Motor"}),i.jsx("option",{value:"Servo",children:"Servo Motor"}),i.jsx("option",{value:"Brushless",children:"Brushless DC"}),i.jsx("option",{value:"AC",children:"AC Motor"}),i.jsx("option",{value:"Synchronous",children:"Synchronous"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:g=>b({...u,voltage:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 12"}),i.jsx("select",{value:u.voltageUnit||Ye("voltage"),onChange:g=>b({...u,voltageUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:g=>b({...u,current:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:u.currentUnit||Ye("current"),onChange:g=>b({...u,currentUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("current").map(g=>i.jsx("option",{value:g,children:g},g))})]})]}),c.componentType==="Switch"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-switchtype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Switch Type:"}),i.jsxs("select",{id:`component-switchtype-${c.id}`,value:u.switchType||"Toggle",onChange:g=>b({...u,switchType:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Toggle",children:"Toggle"}),i.jsx("option",{value:"Push-button",children:"Push-button"}),i.jsx("option",{value:"Slide",children:"Slide"}),i.jsx("option",{value:"Rotary",children:"Rotary"}),i.jsx("option",{value:"DIP",children:"DIP Switch"}),i.jsx("option",{value:"Momentary",children:"Momentary"}),i.jsx("option",{value:"Latching",children:"Latching"}),i.jsx("option",{value:"Reed",children:"Reed Switch"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:g=>b({...u,current:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 5"}),i.jsx("select",{value:u.currentUnit||Ye("current"),onChange:g=>b({...u,currentUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("current").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:g=>b({...u,voltage:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 250"}),i.jsx("select",{value:u.voltageUnit||Ye("voltage"),onChange:g=>b({...u,voltageUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]})]}),c.componentType==="FerriteBead"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-impedance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Impedance:"}),i.jsx("input",{id:`component-impedance-${c.id}`,type:"text",value:u.impedance||"",onChange:g=>b({...u,impedance:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 100"}),i.jsx("select",{value:u.impedanceUnit||Ye("impedance"),onChange:g=>b({...u,impedanceUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("impedance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:g=>b({...u,current:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:u.currentUnit||Ye("current"),onChange:g=>b({...u,currentUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("current").map(g=>i.jsx("option",{value:g,children:g},g))})]})]}),c.componentType==="Connector"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-connectortype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Connector Type:"}),i.jsx("input",{id:`component-connectortype-${c.id}`,type:"text",value:u.connectorType||"",onChange:g=>b({...u,connectorType:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},placeholder:"e.g., USB-A, HDMI"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-gender-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Gender:"}),i.jsxs("select",{id:`component-gender-${c.id}`,value:u.gender||"N/A",onChange:g=>b({...u,gender:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Male",children:"Male"}),i.jsx("option",{value:"Female",children:"Female"}),i.jsx("option",{value:"N/A",children:"N/A"})]})]})]}),c.componentType==="Jumper"&&i.jsx(i.Fragment,{children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-positions-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Positions:"}),i.jsx("input",{id:`component-positions-${c.id}`,type:"number",min:"2",value:u.positions||3,onChange:g=>b({...u,positions:parseInt(g.target.value)||3}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"}})]})}),c.componentType==="Speaker"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-impedance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Impedance:"}),i.jsx("input",{id:`component-impedance-${c.id}`,type:"text",value:u.impedance||"",onChange:g=>b({...u,impedance:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 8"}),i.jsx("select",{value:u.impedanceUnit||Ye("impedance"),onChange:g=>b({...u,impedanceUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("impedance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-power-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),i.jsxs("select",{id:`component-power-${c.id}`,value:u.power||"1/4",onChange:g=>b({...u,power:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"12px"},children:[i.jsx("option",{value:"1/20",children:"1/20 W"}),i.jsx("option",{value:"1/16",children:"1/16 W"}),i.jsx("option",{value:"1/10",children:"1/10 W"}),i.jsx("option",{value:"1/8",children:"1/8 W"}),i.jsx("option",{value:"1/4",children:"1/4 W"}),i.jsx("option",{value:"1/2",children:"1/2 W"}),i.jsx("option",{value:"1",children:"1 W"}),i.jsx("option",{value:"2",children:"2 W"}),i.jsx("option",{value:"3",children:"3 W"}),i.jsx("option",{value:"5",children:"5 W"}),i.jsx("option",{value:"10",children:"10 W"}),i.jsx("option",{value:"25",children:"25 W"}),i.jsx("option",{value:"50",children:"50 W"}),i.jsx("option",{value:"100",children:"100 W"})]})]})]}),c.componentType==="PowerSupply"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-inputvoltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Input Voltage:"}),i.jsx("input",{id:`component-inputvoltage-${c.id}`,type:"text",value:u.inputVoltage||"",onChange:g=>b({...u,inputVoltage:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 120"}),i.jsx("select",{value:u.inputVoltageUnit||Ye("voltage"),onChange:g=>b({...u,inputVoltageUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-outputvoltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Output Voltage:"}),i.jsx("input",{id:`component-outputvoltage-${c.id}`,type:"text",value:u.outputVoltage||"",onChange:g=>b({...u,outputVoltage:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 12"}),i.jsx("select",{value:u.outputVoltageUnit||Ye("voltage"),onChange:g=>b({...u,outputVoltageUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:g=>b({...u,current:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:u.currentUnit||Ye("current"),onChange:g=>b({...u,currentUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("current").map(g=>i.jsx("option",{value:g,children:g},g))})]})]}),c.componentType==="Transistor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-transistortype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Transistor Type:"}),i.jsxs("select",{id:`component-transistortype-${c.id}`,value:u.transistorType||"BJT",onChange:g=>b({...u,transistorType:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"BJT",children:"BJT (Bipolar Junction Transistor)"}),i.jsx("option",{value:"FET",children:"FET (Field Effect Transistor)"}),i.jsx("option",{value:"MOSFET",children:"MOSFET"}),i.jsx("option",{value:"IGBT",children:"IGBT"}),i.jsx("option",{value:"JFET",children:"JFET"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-polarity-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Polarity:"}),i.jsxs("select",{id:`component-polarity-${c.id}`,value:u.polarity||"NPN",onChange:g=>b({...u,polarity:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"NPN",children:"NPN"}),i.jsx("option",{value:"PNP",children:"PNP"}),i.jsx("option",{value:"N-Channel",children:"N-Channel"}),i.jsx("option",{value:"P-Channel",children:"P-Channel"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:g=>b({...u,voltage:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 50"}),i.jsx("select",{value:u.voltageUnit||Ye("voltage"),onChange:g=>b({...u,voltageUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:g=>b({...u,current:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:u.currentUnit||Ye("current"),onChange:g=>b({...u,currentUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("current").map(g=>i.jsx("option",{value:g,children:g},g))})]})]}),c.componentType==="ResistorNetwork"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-resistance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),i.jsx("input",{id:`component-resistance-${c.id}`,type:"text",value:u.resistance||"",onChange:g=>b({...u,resistance:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 10"}),i.jsx("select",{value:u.resistanceUnit||Ye("resistance"),onChange:g=>b({...u,resistanceUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("resistance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-configuration-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Configuration:"}),i.jsx("input",{id:`component-configuration-${c.id}`,type:"text",value:u.configuration||"",onChange:g=>b({...u,configuration:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},placeholder:"e.g., Isolated, Bussed"})]})]}),c.componentType==="Thermistor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-resistance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),i.jsx("input",{id:`component-resistance-${c.id}`,type:"text",value:u.resistance||"",onChange:g=>b({...u,resistance:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 10"}),i.jsx("select",{value:u.resistanceUnit||Ye("resistance"),onChange:g=>b({...u,resistanceUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("resistance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-thermistortype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Thermistor Type:"}),i.jsxs("select",{id:`component-thermistortype-${c.id}`,value:u.thermistorType||"NTC",onChange:g=>b({...u,thermistorType:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"NTC",children:"NTC (Negative Temperature Coefficient)"}),i.jsx("option",{value:"PTC",children:"PTC (Positive Temperature Coefficient)"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-beta-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Beta ():"}),i.jsx("input",{id:`component-beta-${c.id}`,type:"text",value:u.beta||"",onChange:g=>b({...u,beta:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},placeholder:"e.g., 3950"})]})]}),c.componentType==="Transformer"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-primaryvoltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Primary Voltage:"}),i.jsx("input",{id:`component-primaryvoltage-${c.id}`,type:"text",value:u.primaryVoltage||"",onChange:g=>b({...u,primaryVoltage:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 120"}),i.jsx("select",{value:u.primaryVoltageUnit||Ye("voltage"),onChange:g=>b({...u,primaryVoltageUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-secondaryvoltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Secondary Voltage:"}),i.jsx("input",{id:`component-secondaryvoltage-${c.id}`,type:"text",value:u.secondaryVoltage||"",onChange:g=>b({...u,secondaryVoltage:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 12"}),i.jsx("select",{value:u.secondaryVoltageUnit||Ye("voltage"),onChange:g=>b({...u,secondaryVoltageUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-power-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),i.jsxs("select",{id:`component-power-${c.id}`,value:u.power||"1/4",onChange:g=>b({...u,power:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"12px"},children:[i.jsx("option",{value:"1/20",children:"1/20 W"}),i.jsx("option",{value:"1/16",children:"1/16 W"}),i.jsx("option",{value:"1/10",children:"1/10 W"}),i.jsx("option",{value:"1/8",children:"1/8 W"}),i.jsx("option",{value:"1/4",children:"1/4 W"}),i.jsx("option",{value:"1/2",children:"1/2 W"}),i.jsx("option",{value:"1",children:"1 W"}),i.jsx("option",{value:"2",children:"2 W"}),i.jsx("option",{value:"3",children:"3 W"}),i.jsx("option",{value:"5",children:"5 W"}),i.jsx("option",{value:"10",children:"10 W"}),i.jsx("option",{value:"25",children:"25 W"}),i.jsx("option",{value:"50",children:"50 W"}),i.jsx("option",{value:"100",children:"100 W"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-turns-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Turns Ratio:"}),i.jsx("input",{id:`component-turns-${c.id}`,type:"text",value:u.turns||"",onChange:g=>b({...u,turns:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},placeholder:"e.g., 10:1"})]})]}),c.componentType==="TestPoint"&&i.jsx(i.Fragment,{children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-signal-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Signal:"}),i.jsx("input",{id:`component-signal-${c.id}`,type:"text",value:u.signal||"",onChange:g=>b({...u,signal:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},placeholder:"e.g., VCC, GND, CLK"})]})}),c.componentType==="IntegratedCircuit"&&i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid #e0e0e0",fontSize:"9px",fontWeight:600,color:"#666"},children:"IC Properties:"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-ictype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"IC Type:"}),i.jsxs("select",{id:`component-ictype-${c.id}`,value:u.icType||"Op-Amp",onChange:g=>b({...u,icType:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Op-Amp",children:"Op-Amp"}),i.jsx("option",{value:"Microcontroller",children:"Microcontroller"}),i.jsx("option",{value:"Microprocessor",children:"Microprocessor"}),i.jsx("option",{value:"Logic",children:"Logic"}),i.jsx("option",{value:"Memory",children:"Memory"}),i.jsx("option",{value:"Voltage Regulator",children:"Voltage Regulator"}),i.jsx("option",{value:"Timer",children:"Timer"}),i.jsx("option",{value:"ADC",children:"ADC (Analog-to-Digital)"}),i.jsx("option",{value:"DAC",children:"DAC (Digital-to-Analog)"}),i.jsx("option",{value:"Comparator",children:"Comparator"}),i.jsx("option",{value:"Transceiver",children:"Transceiver"}),i.jsx("option",{value:"Driver",children:"Driver"}),i.jsx("option",{value:"Amplifier",children:"Amplifier"}),i.jsx("option",{value:"Other",children:"Other"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-datasheet-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Datasheet:"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",flex:1},children:[i.jsx("input",{id:`component-datasheet-${c.id}`,type:"text",value:u.datasheet||"",onChange:g=>b({...u,datasheet:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"URL"}),u.datasheet&&u.datasheet.trim()&&i.jsx("button",{onClick:g=>{g.preventDefault(),g.stopPropagation();const I=u.datasheet.trim(),ue=I.match(/^https?:\/\//)?I:`https://${I}`;window.open(ue,"_blank","noopener,noreferrer")},style:{background:"transparent",border:"none",cursor:"pointer",padding:"2px",display:"flex",alignItems:"center",justifyContent:"center",opacity:d?.4:1,flexShrink:0},title:"Open URL in new tab",disabled:d,children:i.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{color:"#4a9eff"},children:[i.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),i.jsx("polyline",{points:"15 3 21 3 21 9"}),i.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-pincount-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Pin Count:"}),i.jsx("input",{id:`component-pincount-${c.id}`,name:`component-pincount-${c.id}`,type:"number",min:"1",value:u.pinCount,onChange:g=>{const I=Math.max(1,parseInt(g.target.value)||1);b({...u,pinCount:I})},onBlur:g=>{if(d){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const I=Math.max(1,parseInt(g.target.value)||1),ve=(u.layer==="top"?D:$).find(je=>je.id===u.id);if(ve&&I!==ve.pinCount){const je=ve.pinConnections||[],Ae=new Array(I).fill("").map((ae,Fe)=>Fe<je.length?je[Fe]:""),le=ve.pinPolarities||[],Me=ve.pinPolarities?new Array(I).fill("").map((ae,Fe)=>Fe<le.length?le[Fe]:""):void 0,Ie={...ve,pinCount:I,pinConnections:Ae,...Me!==void 0&&{pinPolarities:Me}};u.layer==="top"?Se(ae=>ae.map(Fe=>Fe.id===u.id?Ie:Fe)):ye(ae=>ae.map(Fe=>Fe.id===u.id?Ie:Fe)),b({...u,pinCount:I})}},disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"}})]})]}),c.componentType==="VacuumTube"&&i.jsx(i.Fragment,{children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-tubetype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tube Type:"}),i.jsx("input",{id:`component-tubetype-${c.id}`,type:"text",value:u.tubeType||"",onChange:g=>b({...u,tubeType:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},placeholder:"e.g., 12AX7, 6L6"})]})}),c.componentType==="VariableResistor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-vrtype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"VR Type:"}),i.jsxs("select",{id:`component-vrtype-${c.id}`,value:u.vrType||"Potentiometer",onChange:g=>b({...u,vrType:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Potentiometer",children:"Potentiometer"}),i.jsx("option",{value:"Rheostat",children:"Rheostat"}),i.jsx("option",{value:"Trimmer",children:"Trimmer"}),i.jsx("option",{value:"Varistor",children:"Varistor"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-resistance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),i.jsx("input",{id:`component-resistance-${c.id}`,type:"text",value:u.resistance||"",onChange:g=>b({...u,resistance:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 10"}),i.jsx("select",{value:u.resistanceUnit||Ye("resistance"),onChange:g=>b({...u,resistanceUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("resistance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-power-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),i.jsxs("select",{id:`component-power-${c.id}`,value:u.power||"1/4",onChange:g=>b({...u,power:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"12px"},children:[i.jsx("option",{value:"1/20",children:"1/20 W"}),i.jsx("option",{value:"1/16",children:"1/16 W"}),i.jsx("option",{value:"1/10",children:"1/10 W"}),i.jsx("option",{value:"1/8",children:"1/8 W"}),i.jsx("option",{value:"1/4",children:"1/4 W"}),i.jsx("option",{value:"1/2",children:"1/2 W"}),i.jsx("option",{value:"1",children:"1 W"}),i.jsx("option",{value:"2",children:"2 W"}),i.jsx("option",{value:"3",children:"3 W"}),i.jsx("option",{value:"5",children:"5 W"}),i.jsx("option",{value:"10",children:"10 W"}),i.jsx("option",{value:"25",children:"25 W"}),i.jsx("option",{value:"50",children:"50 W"}),i.jsx("option",{value:"100",children:"100 W"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-taper-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Taper:"}),i.jsxs("select",{id:`component-taper-${c.id}`,value:u.taper||"Linear",onChange:g=>b({...u,taper:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Linear",children:"Linear"}),i.jsx("option",{value:"Logarithmic",children:"Logarithmic"}),i.jsx("option",{value:"Audio",children:"Audio"})]})]})]}),c.componentType==="Crystal"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-frequency-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Frequency:"}),i.jsx("input",{id:`component-frequency-${c.id}`,type:"text",value:u.frequency||"",onChange:g=>b({...u,frequency:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},placeholder:"e.g., 16.000 MHz"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-loadcapacitance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Load Capacitance:"}),i.jsx("input",{id:`component-loadcapacitance-${c.id}`,type:"text",value:u.loadCapacitance||"",onChange:g=>b({...u,loadCapacitance:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},placeholder:"e.g., 18pF"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-tolerance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),i.jsxs("select",{id:`component-tolerance-${c.id}`,value:u.tolerance||"10ppm",onChange:g=>b({...u,tolerance:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"10ppm",children:"10ppm"}),i.jsx("option",{value:"20ppm",children:"20ppm"}),i.jsx("option",{value:"30ppm",children:"30ppm"}),i.jsx("option",{value:"50ppm",children:"50ppm"}),i.jsx("option",{value:"100ppm",children:"100ppm"})]})]})]}),c.componentType==="ZenerDiode"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Zener Voltage:"}),i.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:g=>b({...u,voltage:g.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1},placeholder:"e.g., 5.1"}),i.jsx("select",{value:u.voltageUnit||Ye("voltage"),onChange:g=>b({...u,voltageUnit:g.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:$t("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-power-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),i.jsxs("select",{id:`component-power-${c.id}`,value:u.power||"1/4",onChange:g=>b({...u,power:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"12px"},children:[i.jsx("option",{value:"1/20",children:"1/20 W"}),i.jsx("option",{value:"1/16",children:"1/16 W"}),i.jsx("option",{value:"1/10",children:"1/10 W"}),i.jsx("option",{value:"1/8",children:"1/8 W"}),i.jsx("option",{value:"1/4",children:"1/4 W"}),i.jsx("option",{value:"1/2",children:"1/2 W"}),i.jsx("option",{value:"1",children:"1 W"}),i.jsx("option",{value:"2",children:"2 W"}),i.jsx("option",{value:"3",children:"3 W"}),i.jsx("option",{value:"5",children:"5 W"}),i.jsx("option",{value:"10",children:"10 W"}),i.jsx("option",{value:"25",children:"25 W"}),i.jsx("option",{value:"50",children:"50 W"}),i.jsx("option",{value:"100",children:"100 W"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-tolerance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),i.jsxs("select",{id:`component-tolerance-${c.id}`,value:u.tolerance||"5%",onChange:g=>b({...u,tolerance:g.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:d?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"0.5%",children:"0.5%"}),i.jsx("option",{value:"1%",children:"1%"}),i.jsx("option",{value:"2%",children:"2%"}),i.jsx("option",{value:"5%",children:"5%"}),i.jsx("option",{value:"10%",children:"10%"}),i.jsx("option",{value:"20%",children:"20%"})]})]})]})]}),wx=c=>{const u=Ud[c];return!u||!u.prefix||u.prefix.length<1?"?":u.prefix[0].substring(0,1).toUpperCase()},Tx=({componentEditor:c,setComponentEditor:u,componentsTop:b,componentsBottom:d,setComponentsTop:D,setComponentsBottom:$,connectingPin:Se,setConnectingPin:ye,componentDialogPosition:g,setComponentDialogPosition:I,isDraggingDialog:ue,setIsDraggingDialog:ve,dialogDragOffset:je,setDialogDragOffset:Ae,areComponentsLocked:le,setSelectedComponentIds:Me,setNotesDialogVisible:Ie})=>{if(!c||!c.visible)return null;let ae=b.find(G=>G.id===c.id),Fe="top";if(ae||(ae=d.find(G=>G.id===c.id),Fe="bottom"),!ae)return null;c.layer!==Fe&&u({...c,layer:Fe});const ge=G=>{const A={...G},R=c.designator?.trim()||"";A.designator=R,A.x=c.x,A.y=c.y,A.layer=c.layer,A.orientation=c.orientation??0;const z=R.length>0?R.charAt(0).toUpperCase():wx(G.componentType);if(A.abbreviation=z,"manufacturer"in A&&(A.manufacturer=c.manufacturer?.trim()||void 0),"partNumber"in A&&(A.partNumber=c.partNumber?.trim()||void 0),c.pinCount!==G.pinCount){A.pinCount=c.pinCount;const y=G.pinConnections||[];if(A.pinConnections=new Array(c.pinCount).fill("").map((Q,Re)=>Re<y.length?y[Re]:""),G.pinPolarities){const Q=G.pinPolarities||[];A.pinPolarities=new Array(c.pinCount).fill("").map((Re,Oe)=>Oe<Q.length?Q[Oe]:"")}}else A.pinConnections=G.pinConnections||[],G.pinPolarities&&(A.pinPolarities=G.pinPolarities);return G.componentType==="Resistor"?(A.resistance=c.resistance||void 0,A.resistanceUnit=c.resistanceUnit||void 0,A.power=c.power?`${c.power}W`:void 0,A.tolerance=c.tolerance||void 0):G.componentType==="Capacitor"?(A.capacitance=c.capacitance||void 0,A.capacitanceUnit=c.capacitanceUnit||void 0,A.voltage=c.voltage||void 0,A.voltageUnit=c.voltageUnit||void 0,A.tolerance=c.tolerance||void 0,A.dielectric=c.dielectric||void 0):G.componentType==="Electrolytic Capacitor"?(A.capacitance=c.capacitance||void 0,A.capacitanceUnit=c.capacitanceUnit||void 0,A.voltage=c.voltage||void 0,A.voltageUnit=c.voltageUnit||void 0,A.tolerance=c.tolerance||void 0,A.polarity=c.polarityCapacitor||void 0,A.esr=c.esr||void 0,A.esrUnit=c.esrUnit||void 0,A.temperature=c.temperature||void 0):G.componentType==="Film Capacitor"?(A.capacitance=c.capacitance||void 0,A.capacitanceUnit=c.capacitanceUnit||void 0,A.voltage=c.voltage||void 0,A.voltageUnit=c.voltageUnit||void 0,A.tolerance=c.tolerance||void 0,A.filmType=c.filmType||void 0):G.componentType==="Diode"?(A.diodeType=c.diodeType||void 0,A.voltage=c.voltage||void 0,A.voltageUnit=c.voltageUnit||void 0,A.current=c.current||void 0,A.currentUnit=c.currentUnit||void 0,A.ledColor=c.ledColor||void 0):G.componentType==="Battery"?(A.voltage=c.voltage||void 0,A.voltageUnit=c.voltageUnit||void 0,A.capacity=c.capacity||void 0,A.capacityUnit=c.capacityUnit||void 0,A.chemistry=c.chemistry||void 0):G.componentType==="Fuse"?(A.current=c.current||void 0,A.currentUnit=c.currentUnit||void 0,A.voltage=c.voltage||void 0,A.voltageUnit=c.voltageUnit||void 0,A.fuseType=c.fuseType||void 0):G.componentType==="FerriteBead"?(A.impedance=c.impedance||void 0,A.impedanceUnit=c.impedanceUnit||void 0,A.current=c.current||void 0,A.currentUnit=c.currentUnit||void 0):G.componentType==="Connector"?(A.connectorType=c.connectorType||void 0,A.gender=c.gender||void 0):G.componentType==="Jumper"?A.positions=c.positions||void 0:G.componentType==="Relay"?(A.coilVoltage=c.coilVoltage||void 0,A.coilVoltageUnit=c.coilVoltageUnit||void 0,A.contactType=c.contactType||void 0,A.current=c.current||void 0,A.currentUnit=c.currentUnit||void 0):G.componentType==="Inductor"?(A.inductance=c.inductance||void 0,A.inductanceUnit=c.inductanceUnit||void 0,A.current=c.current||void 0,A.currentUnit=c.currentUnit||void 0,A.resistance=c.resistance||void 0,A.resistanceUnit=c.resistanceUnit||void 0):G.componentType==="Speaker"?(A.impedance=c.impedance||void 0,A.impedanceUnit=c.impedanceUnit||void 0,A.power=c.power?`${c.power}W`:void 0):G.componentType==="Motor"?(A.motorType=c.motorType||void 0,A.voltage=c.voltage||void 0,A.voltageUnit=c.voltageUnit||void 0,A.current=c.current||void 0,A.currentUnit=c.currentUnit||void 0):G.componentType==="PowerSupply"?(A.inputVoltage=c.inputVoltage||void 0,A.inputVoltageUnit=c.inputVoltageUnit||void 0,A.outputVoltage=c.outputVoltage||void 0,A.outputVoltageUnit=c.outputVoltageUnit||void 0,A.current=c.current||void 0,A.currentUnit=c.currentUnit||void 0):G.componentType==="Transistor"?(A.transistorType=c.transistorType||void 0,A.polarity=c.polarity||void 0,A.voltage=c.voltage||void 0,A.voltageUnit=c.voltageUnit||void 0,A.current=c.current||void 0,A.currentUnit=c.currentUnit||void 0):G.componentType==="ResistorNetwork"?(A.resistance=c.resistance||void 0,A.resistanceUnit=c.resistanceUnit||void 0,A.configuration=c.configuration||void 0):G.componentType==="Thermistor"?(A.resistance=c.resistance||void 0,A.resistanceUnit=c.resistanceUnit||void 0,A.thermistorType=c.thermistorType||void 0,A.beta=c.beta||void 0):G.componentType==="Switch"?(A.switchType=c.switchType||void 0,A.current=c.current||void 0,A.currentUnit=c.currentUnit||void 0,A.voltage=c.voltage||void 0,A.voltageUnit=c.voltageUnit||void 0):G.componentType==="Transformer"?(A.primaryVoltage=c.primaryVoltage||void 0,A.primaryVoltageUnit=c.primaryVoltageUnit||void 0,A.secondaryVoltage=c.secondaryVoltage||void 0,A.secondaryVoltageUnit=c.secondaryVoltageUnit||void 0,A.power=c.power?`${c.power}W`:void 0,A.turns=c.turns||void 0):G.componentType==="TestPoint"?A.signal=c.signal||void 0:G.componentType==="Film Capacitor"?(A.capacitance=c.capacitance||void 0,A.capacitanceUnit=c.capacitanceUnit||void 0,A.voltage=c.voltage||void 0,A.voltageUnit=c.voltageUnit||void 0,A.tolerance=c.tolerance||void 0,A.filmType=c.filmType||void 0):G.componentType==="IntegratedCircuit"?(A.description=c.description?.trim()||void 0,A.datasheet=c.datasheet?.trim()||void 0,A.icType=c.icType||void 0):A.description=c.description?.trim()||void 0,G.componentType==="VacuumTube"?A.tubeType=c.tubeType||void 0:G.componentType==="VariableResistor"?(A.vrType=c.vrType||void 0,A.resistance=c.resistance||void 0,A.resistanceUnit=c.resistanceUnit||void 0,A.power=c.power?`${c.power}W`:void 0,A.taper=c.taper||void 0):G.componentType==="Crystal"?(A.frequency=c.frequency||void 0,A.loadCapacitance=c.loadCapacitance||void 0,A.tolerance=c.tolerance||void 0):G.componentType==="ZenerDiode"&&(A.voltage=c.voltage||void 0,A.voltageUnit=c.voltageUnit||void 0,A.power=c.power?`${c.power}W`:void 0,A.tolerance=c.tolerance||void 0),A},U=()=>{if(le){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const G=b.find(z=>z.id===c.id),A=d.find(z=>z.id===c.id),R=G||A;if(R){const z=ge(R),y=R.layer,Q=c.layer;y!==Q?y==="top"?(D(Re=>Re.filter(Oe=>Oe.id!==c.id)),$(Re=>[...Re,z])):($(Re=>Re.filter(Oe=>Oe.id!==c.id)),D(Re=>[...Re,z])):Q==="top"?D(Re=>Re.map(Oe=>Oe.id===c.id?z:Oe)):$(Re=>Re.map(Oe=>Oe.id===c.id?z:Oe))}else if(console.warn(`Component ${c.id} not found in either layer array`),c.layer==="top"){const z=d.find(y=>y.id===c.id);if(z){const y=ge(z);$(Q=>Q.filter(Re=>Re.id!==c.id)),D(Q=>[...Q,y])}}else{const z=b.find(y=>y.id===c.id);if(z){const y=ge(z);D(Q=>Q.filter(Re=>Re.id!==c.id)),$(Q=>[...Q,y])}}u(null),ye(null)};return i.jsxs("div",{"data-component-editor-dialog":!0,onClick:G=>{if(Se&&Se.componentId===ae.id){const A=G.target;(A.tagName==="BUTTON"||A.tagName==="INPUT"||A.closest("button")||A.closest("input"))&&G.stopPropagation()}},style:{position:"fixed",top:g?`${g.y}px`:"90px",left:g?`${g.x}px`:`${window.innerWidth-280}px`,transform:"none",background:Se&&Se.componentId===ae.id?"rgba(255, 255, 255, 0.95)":"#fff",border:"1px solid #0b5fff",borderRadius:4,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"175px",maxWidth:"250px",maxHeight:"40vh",display:"flex",flexDirection:"column",pointerEvents:"auto",cursor:ue?"grabbing":"default"},children:[i.jsxs("div",{onMouseDown:G=>{const A=G.target;A.tagName==="BUTTON"||A.tagName==="INPUT"||A.closest("button")||A.closest("input")||g&&(Ae({x:G.clientX-g.x,y:G.clientY-g.y}),ve(!0),G.preventDefault())},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:ue?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[i.jsx("h3",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Component Properties"}),i.jsx("button",{onClick:()=>{u(null),ye(null)},style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"6px 20px 6px 6px",overflowY:"auto",flex:1,minHeight:0},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Type:"}),i.jsx("div",{style:{flex:1,padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:Md(ae.componentType)})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-layer-${ae.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Layer:"}),i.jsxs("select",{id:`component-layer-${ae.id}`,name:`component-layer-${ae.id}`,value:c.layer,onChange:G=>u({...c,layer:G.target.value}),disabled:le,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:le?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"top",children:"Top"}),i.jsx("option",{value:"bottom",children:"Bottom"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-orientation-${ae.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Orientation:"}),i.jsxs("select",{id:`component-orientation-${ae.id}`,name:`component-orientation-${ae.id}`,value:c.orientation??0,onChange:G=>{const A=parseInt(G.target.value)||0;if(u({...c,orientation:A}),!le){const z=(c.layer==="top"?b:d).find(y=>y.id===c.id);if(z){const y={...z,orientation:A};c.layer==="top"?D(Q=>Q.map(Re=>Re.id===c.id?y:Re)):$(Q=>Q.map(Re=>Re.id===c.id?y:Re))}}},disabled:le,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:le?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"0",children:"0"}),i.jsx("option",{value:"90",children:"90"}),i.jsx("option",{value:"180",children:"180"}),i.jsx("option",{value:"270",children:"270"})]})]}),i.jsx(Sx,{component:ae,componentEditor:c,setComponentEditor:u,areComponentsLocked:le,componentsTop:b,componentsBottom:d,setComponentsTop:D,setComponentsBottom:$}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginTop:"4px",paddingTop:"4px",borderTop:"1px solid #e0e0e0"},children:[i.jsx("label",{htmlFor:`component-designator-${ae.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Designator:"}),i.jsx("input",{id:`component-designator-${ae.id}`,name:`component-designator-${ae.id}`,type:"text",value:c.designator||"",onChange:G=>{const A=G.target.value,R=A.length>0?A.charAt(0).toUpperCase():c.abbreviation;u({...c,designator:A,abbreviation:R})},disabled:le,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",fontFamily:"monospace",textTransform:"uppercase",opacity:le?.6:1},placeholder:"e.g., U2, R7, C1"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-description-${ae.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Description:"}),i.jsx("input",{id:`component-description-${ae.id}`,name:`component-description-${ae.id}`,type:"text",value:c.description||"",onChange:G=>{u({...c,description:G.target.value})},disabled:le,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:le?.6:1},placeholder:ae.componentType==="IntegratedCircuit"?"e.g., Dual Op-Amp":"e.g., Op Amp OP07"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-notes-${ae.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Notes:"}),i.jsx("input",{id:`component-notes-${ae.id}`,name:`component-notes-${ae.id}`,type:"text",readOnly:!0,value:ae.notes||"",onClick:()=>{le||(Me(new Set([ae.id])),Ie(!0))},disabled:le,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:le?.6:1,cursor:le?"not-allowed":"pointer",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},placeholder:"Click to edit notes...",title:ae.notes||"Click to edit notes..."})]}),ae.componentType!=="IntegratedCircuit"&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-pincount-${ae.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Pin Count:"}),i.jsx("input",{id:`component-pincount-${ae.id}`,name:`component-pincount-${ae.id}`,type:"number",min:"1",value:c.pinCount,onChange:G=>{const A=Math.max(1,parseInt(G.target.value)||1);u({...c,pinCount:A})},onBlur:G=>{if(le){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const A=Math.max(1,parseInt(G.target.value)||1),z=(c.layer==="top"?b:d).find(y=>y.id===c.id);if(z&&A!==z.pinCount){const y=z.pinConnections||[],Q=new Array(A).fill("").map((Ee,se)=>se<y.length?y[se]:""),Re=z.pinPolarities||[],Oe=z.pinPolarities?new Array(A).fill("").map((Ee,se)=>se<Re.length?Re[se]:""):void 0,fe={...z,pinCount:A,pinConnections:Q,...Oe!==void 0&&{pinPolarities:Oe}};c.layer==="top"?D(Ee=>Ee.map(se=>se.id===c.id?fe:se)):$(Ee=>Ee.map(se=>se.id===c.id?fe:se)),u({...c,pinCount:A})}},disabled:le,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:le?.6:1}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-x-${ae.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"X:"}),i.jsx("input",{id:`component-x-${ae.id}`,name:`component-x-${ae.id}`,type:"number",value:c.x.toFixed(2),onChange:G=>{const A=parseFloat(G.target.value)||0;u({...c,x:A})},disabled:le,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:le?.6:1}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-y-${ae.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Y:"}),i.jsx("input",{id:`component-y-${ae.id}`,name:`component-y-${ae.id}`,type:"number",value:c.y.toFixed(2),onChange:G=>{const A=parseFloat(G.target.value)||0;u({...c,y:A})},disabled:le,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:le?.6:1}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-manufacturer-${ae.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Manufacturer:"}),i.jsx("input",{id:`component-manufacturer-${ae.id}`,name:`component-manufacturer-${ae.id}`,type:"text",value:c.manufacturer,onChange:G=>u({...c,manufacturer:G.target.value}),disabled:le,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:le?.6:1}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-partnumber-${ae.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Part Number:"}),i.jsx("input",{id:`component-partnumber-${ae.id}`,name:`component-partnumber-${ae.id}`,type:"text",value:c.partNumber,onChange:G=>u({...c,partNumber:G.target.value}),disabled:le,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#666",opacity:le?.6:1}})]}),i.jsxs("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid #e0e0e0"},children:[i.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"2px"},children:"Pin Connections:"}),Se&&Se.componentId===ae.id&&i.jsxs("div",{style:{padding:"2px 3px",background:"#fff3cd",border:"1px solid #ffc107",borderRadius:2,marginBottom:"2px",fontSize:"8px",color:"#856404"},children:["Pin ",Se.pinIndex+1," selected. Click on a via or pad to connect."]}),(()=>{const G=ae.componentType==="Electrolytic Capacitor"||ae.componentType==="Diode"||ae.componentType==="Battery"||ae.componentType==="ZenerDiode",A=ae.componentType==="Capacitor"&&"dielectric"in ae&&ae.dielectric==="Tantalum",R=G||A;return i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"8px",marginTop:"2px"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{borderBottom:"1px solid #ddd",background:"#f5f5f5"},children:[i.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"8px",color:"#333",width:"20px"}}),i.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"8px",color:"#333",width:"40px"},children:"Pin"}),R&&i.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"8px",color:"#333",width:"50px"},children:"Polarity"}),i.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"8px",color:"#333"},children:"Node ID"})]})}),i.jsx("tbody",{children:Array.from({length:c.pinCount},(z,y)=>{const Re=(c.layer==="top"?b:d).find(se=>se.id===c.id),Oe=Re?.pinConnections&&Re.pinConnections.length>y?Re.pinConnections[y]:"",fe=Re?.pinPolarities&&Re.pinPolarities.length>y&&Re.pinPolarities[y]||"",Ee=Se&&Se.componentId===ae.id&&Se.pinIndex===y;return i.jsxs("tr",{style:{cursor:le?"not-allowed":"pointer",background:Ee?"#e6f0ff":Oe?"#d4edda":"#fff",borderBottom:"1px solid #eee"},onClick:se=>{if(se.target.tagName!=="SELECT"){if(le){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}ye(Ee?null:{componentId:ae.id,pinIndex:y})}},title:Oe?`Connected to: ${Oe}`:"Select this pin, then click on a via or pad to connect",children:[i.jsx("td",{style:{padding:"2px 4px",textAlign:"center"},children:i.jsx("input",{id:`pin-radio-${ae.id}-${y}`,name:`pin-radio-${ae.id}`,type:"radio",checked:!!Ee,onChange:()=>{if(le){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}ye(Ee?null:{componentId:ae.id,pinIndex:y})},disabled:le,style:{margin:0,cursor:le?"not-allowed":"pointer",opacity:le?.6:1,width:"10px",height:"10px"}})}),i.jsx("td",{style:{padding:"2px 4px",color:"#333",fontWeight:Ee?600:400,fontFamily:"monospace"},children:y+1}),R&&i.jsx("td",{style:{padding:"2px 4px",textAlign:"center"},children:i.jsxs("select",{value:fe??"",onChange:se=>{if(le){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const _=se.target.value,W=(c.layer==="top"?b:d).find(Te=>Te.id===c.id);if(W){const F=[...W.pinPolarities||new Array(W.pinCount).fill("")];for(;F.length<W.pinCount;)F.push("");F[y]=_;const C={...W,pinPolarities:F};c.layer==="top"?D(M=>M.map(H=>H.id===c.id?C:H)):$(M=>M.map(H=>H.id===c.id?C:H))}},disabled:le,onClick:se=>se.stopPropagation(),onFocus:se=>se.stopPropagation(),style:{padding:"1px 2px",fontSize:"8px",border:"1px solid #ddd",borderRadius:2,background:"#fff",cursor:le?"not-allowed":"pointer",opacity:le?.6:1,width:"100%",fontFamily:"monospace",fontWeight:600},children:[i.jsx("option",{value:"",children:"-"}),i.jsx("option",{value:"+",children:"+"}),i.jsx("option",{value:"-",children:"-"})]},`polarity-${ae.id}-${y}-${fe}`)}),i.jsx("td",{style:{padding:"2px 4px",color:Oe?"#28a745":"#999",fontWeight:Oe?600:400,fontFamily:"monospace"},children:Oe||"-"})]},y)})})]})})()]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"6px",padding:"6px",borderTop:"1px solid #e0e0e0",flexShrink:0},children:[i.jsx("button",{onClick:()=>{u(null),ye(null)},disabled:le,style:{padding:"2px 5px",background:le?"#f5f5f5":"#fff",color:le?"#999":"#333",border:"1px solid #ddd",borderRadius:2,cursor:le?"not-allowed":"pointer",fontSize:"10px",opacity:le?.6:1},children:"Cancel"}),i.jsx("button",{onClick:U,disabled:le,style:{padding:"2px 5px",background:le?"#f5f5f5":"#0b5fff",color:le?"#999":"#fff",border:"1px solid #ddd",borderRadius:2,cursor:le?"not-allowed":"pointer",fontSize:"10px",opacity:le?.6:1},children:"Save"})]})]})};function jx(){const[c,u]=w.useState([]),[b,d]=w.useState(!1),[D,$]=w.useState([]),[Se,ye]=w.useState(null),[g,I]=w.useState("trace"),[ue,ve]=w.useState("top"),je=w.useRef([]),Ae=w.useRef(0),le=w.useRef(!1),Me=w.useCallback(()=>{d(!0),$([]),je.current=[]},[]),Ie=w.useCallback(()=>{d(!1),$([]),je.current=[]},[]),ae=w.useCallback(ge=>{$(U=>[...U,ge]),je.current=[...je.current,ge]},[]),Fe=w.useCallback(ge=>{u(U=>[...U,ge]),$([]),je.current=[]},[]);return{drawingStrokes:c,setDrawingStrokes:u,isDrawing:b,setIsDrawing:d,currentStroke:D,setCurrentStroke:$,tracePreviewMousePos:Se,setTracePreviewMousePos:ye,drawingMode:g,setDrawingMode:I,selectedDrawingLayer:ue,setSelectedDrawingLayer:ve,currentStrokeRef:je,lastTraceClickTimeRef:Ae,isDoubleClickingTraceRef:le,startDrawing:Me,stopDrawing:Ie,addPointToStroke:ae,finishStroke:Fe}}function Cx(){const[c,u]=w.useState(new Set),[b,d]=w.useState(!1),[D,$]=w.useState(new Set),[Se,ye]=w.useState(new Set),[g,I]=w.useState(new Set),ue=w.useCallback(()=>{u(new Set),$(new Set),ye(new Set),I(new Set)},[]),ve=w.useCallback((le,Me="stroke")=>{Me==="stroke"?u(Ie=>new Set([...Ie,le])):Me==="component"?$(Ie=>new Set([...Ie,le])):Me==="power"?ye(Ie=>new Set([...Ie,le])):Me==="ground"&&I(Ie=>new Set([...Ie,le]))},[]),je=w.useCallback((le,Me="stroke")=>{Me==="stroke"?u(Ie=>{const ae=new Set(Ie);return ae.delete(le),ae}):Me==="component"?$(Ie=>{const ae=new Set(Ie);return ae.delete(le),ae}):Me==="power"?ye(Ie=>{const ae=new Set(Ie);return ae.delete(le),ae}):Me==="ground"&&I(Ie=>{const ae=new Set(Ie);return ae.delete(le),ae})},[]),Ae=w.useCallback((le,Me="stroke")=>{Me==="stroke"?u(le):Me==="component"?$(le):Me==="power"?ye(le):Me==="ground"&&I(le)},[]);return{selectedIds:c,setSelectedIds:u,isSelecting:b,setIsSelecting:d,selectedComponentIds:D,setSelectedComponentIds:$,selectedPowerIds:Se,setSelectedPowerIds:ye,selectedGroundIds:g,setSelectedGroundIds:I,clearSelection:ue,addToSelection:ve,removeFromSelection:je,setSelection:Ae}}function zx(){const[c,u]=w.useState(null),[b,d]=w.useState(!1),[D,$]=w.useState(null),[Se,ye]=w.useState("nudge"),g=w.useCallback((ue,ve)=>{u(ue),d(!0),$(ve)},[]),I=w.useCallback(()=>{d(!1),u(null),$(null)},[]);return{selectedImageForTransform:c,setSelectedImageForTransform:u,isTransforming:b,setIsTransforming:d,transformStartPos:D,setTransformStartPos:$,transformMode:Se,setTransformMode:ye,startTransform:g,stopTransform:I}}function kx(){const[c,u]=w.useState(null),[b,d]=w.useState(null),[D,$]=w.useState("overlay"),[Se,ye]=w.useState(50),[g,I]=w.useState(!1),[ue,ve]=w.useState(2e3),[je,Ae]=w.useState(!1),[le,Me]=w.useState(!1),[Ie,ae]=w.useState(!1),Fe=w.useCallback(G=>{u(G)},[]),ge=w.useCallback(G=>{d(G)},[]),U=w.useCallback(()=>{u(null),d(null)},[]);return{topImage:c,setTopImage:u,bottomImage:b,setBottomImage:d,currentView:D,setCurrentView:$,transparency:Se,setTransparency:ye,isTransparencyCycling:g,setIsTransparencyCycling:I,transparencyCycleSpeed:ue,setTransparencyCycleSpeed:ve,isGrayscale:je,setIsGrayscale:Ae,isBlackAndWhiteEdges:le,setIsBlackAndWhiteEdges:Me,isBlackAndWhiteInverted:Ie,setIsBlackAndWhiteInverted:ae,loadTopImage:Fe,loadBottomImage:ge,clearImages:U}}function Rx(){const[c,u]=w.useState(1),[b,d]=w.useState({x:0,y:0}),[D,$]=w.useState(!1),[Se,ye]=w.useState(!1),g=w.useCallback(()=>{u(1),d({x:0,y:0})},[]),I=w.useCallback((le=1.2)=>{u(Me=>Me*le)},[]),ue=w.useCallback((le=1.2)=>{u(Me=>Me/le)},[]),ve=w.useCallback(le=>{u(le)},[]),je=w.useCallback((le,Me)=>{d(Ie=>({x:Ie.x+le,y:Ie.y+Me}))},[]),Ae=w.useCallback((le,Me)=>{d({x:le,y:Me})},[]);return{viewScale:c,setViewScale:u,viewPan:b,setViewPan:d,isShiftConstrained:D,setIsShiftConstrained:$,showBothLayers:Se,setShowBothLayers:ye,resetView:g,zoomIn:I,zoomOut:ue,setZoom:ve,pan:je,setPan:Ae}}function Rt(c,u,b,d){if(u==="power"){const $=c[u]||"";return typeof $=="string"&&$.trim()!==""?{value:$.replace(/W$/i,"").trim(),unit:"W"}:{value:"",unit:"W"}}if(c[u]!==void 0||c[b]!==void 0)return{value:c[u]||"",unit:c[b]||d};const D=c[u]||"";return typeof D=="string"&&D.trim()!==""?Dx(D):{value:"",unit:d}}function Dx(c){if(!c||c.trim()==="")return{value:"",unit:""};const u=c.trim(),b=u.match(/^([\d]+\/[\d]+)\s*([a-zA-ZuW]+)?$/);if(b)return{value:b[1],unit:b[2]||""};const d=u.match(/^([\d.]+)\s*([a-zA-ZuW]+)?$/);return d?{value:d[1],unit:d[2]||""}:{value:u,unit:""}}function Ax(){const[c,u]=w.useState([]),[b,d]=w.useState([]),[D,$]=w.useState(null),[Se,ye]=w.useState(null),[g,I]=w.useState(null),[ue,ve]=w.useState(!1),[je,Ae]=w.useState(null),le=w.useCallback((ge,U)=>{U==="top"?u(G=>[...G,ge]):d(G=>[...G,ge])},[]),Me=w.useCallback((ge,U,G)=>{G==="top"?u(A=>A.map(R=>R.id===ge?{...R,...U}:R)):d(A=>A.map(R=>R.id===ge?{...R,...U}:R))},[]),Ie=w.useCallback((ge,U)=>{U==="top"?u(G=>G.filter(A=>A.id!==ge)):d(G=>G.filter(A=>A.id!==ge))},[]),ae=w.useCallback((ge,U)=>{const G=ge.designator||"",A=ge.abbreviation||(G.length>0?G.charAt(0).toUpperCase():""),R={visible:!0,layer:U,id:ge.id,designator:G,abbreviation:A,manufacturer:"manufacturer"in ge&&ge.manufacturer||"",partNumber:"partNumber"in ge&&ge.partNumber||"",pinCount:ge.pinCount,x:ge.x,y:ge.y,orientation:ge.orientation??0,description:ge.description||""};if(ge.componentType==="Resistor"){const z=ge,y=Rt(z,"resistance","resistanceUnit",Ye("resistance"));R.resistance=y.value,R.resistanceUnit=y.unit;const Q=Rt(z,"power","powerUnit","W");R.power=Q.value||"1/4",R.tolerance=z.tolerance||"5%"}else if(ge.componentType==="Capacitor"){const z=ge,y=Rt(z,"capacitance","capacitanceUnit",Ye("capacitance"));R.capacitance=y.value,R.capacitanceUnit=y.unit;const Q=Rt(z,"voltage","voltageUnit",Ye("voltage"));R.voltage=Q.value,R.voltageUnit=Q.unit,R.tolerance=z.tolerance||"10%",R.dielectric=z.dielectric||"Ceramic"}else if(ge.componentType==="Electrolytic Capacitor"){const z=ge,y=Rt(z,"capacitance","capacitanceUnit",Ye("capacitance"));R.capacitance=y.value,R.capacitanceUnit=y.unit;const Q=Rt(z,"voltage","voltageUnit",Ye("voltage"));R.voltage=Q.value,R.voltageUnit=Q.unit,R.tolerance=z.tolerance||"20%",R.polarityCapacitor=z.polarity||"Positive";const Re=Rt(z,"esr","esrUnit",Ye("esr"));R.esr=Re.value,R.esrUnit=Re.unit,R.temperature=z.temperature||""}else if(ge.componentType==="Film Capacitor"){const z=ge,y=Rt(z,"capacitance","capacitanceUnit",Ye("capacitance"));R.capacitance=y.value,R.capacitanceUnit=y.unit;const Q=Rt(z,"voltage","voltageUnit",Ye("voltage"));R.voltage=Q.value,R.voltageUnit=Q.unit,R.tolerance=z.tolerance||"10%",R.filmType=z.filmType||"Polyester"}else if(ge.componentType==="Diode"){const z=ge;R.diodeType=z.diodeType||"Standard";const y=Rt(z,"voltage","voltageUnit",Ye("voltage"));R.voltage=y.value,R.voltageUnit=y.unit;const Q=Rt(z,"current","currentUnit",Ye("current"));R.current=Q.value,R.currentUnit=Q.unit,R.ledColor=z.ledColor||""}else if(ge.componentType==="Battery"){const z=ge,y=Rt(z,"voltage","voltageUnit",Ye("voltage"));R.voltage=y.value,R.voltageUnit=y.unit;const Q=Rt(z,"capacity","capacityUnit",Ye("capacity"));R.capacity=Q.value,R.capacityUnit=Q.unit,R.chemistry=z.chemistry||"Li-ion"}else if(ge.componentType==="Fuse"){const z=ge,y=Rt(z,"current","currentUnit",Ye("current"));R.current=y.value,R.currentUnit=y.unit;const Q=Rt(z,"voltage","voltageUnit",Ye("voltage"));R.voltage=Q.value,R.voltageUnit=Q.unit,R.fuseType=z.fuseType||"Fast-blow"}else if(ge.componentType==="FerriteBead"){const z=ge,y=Rt(z,"impedance","impedanceUnit",Ye("impedance"));R.impedance=y.value,R.impedanceUnit=y.unit;const Q=Rt(z,"current","currentUnit",Ye("current"));R.current=Q.value,R.currentUnit=Q.unit}else if(ge.componentType==="Connector"){const z=ge;R.connectorType=z.connectorType||"",R.gender=z.gender||"N/A"}else if(ge.componentType==="Jumper"){const z=ge;R.positions=z.positions||3}else if(ge.componentType==="Relay"){const z=ge,y=Rt(z,"coilVoltage","coilVoltageUnit",Ye("coilVoltage"));R.coilVoltage=y.value,R.coilVoltageUnit=y.unit,R.contactType=z.contactType||"SPST";const Q=Rt(z,"current","currentUnit",Ye("current"));R.current=Q.value,R.currentUnit=Q.unit}else if(ge.componentType==="Inductor"){const z=ge,y=Rt(z,"inductance","inductanceUnit",Ye("inductance"));R.inductance=y.value,R.inductanceUnit=y.unit;const Q=Rt(z,"current","currentUnit",Ye("current"));R.current=Q.value,R.currentUnit=Q.unit;const Re=Rt(z,"resistance","resistanceUnit",Ye("resistance"));R.resistance=Re.value,R.resistanceUnit=Re.unit}else if(ge.componentType==="Speaker"){const z=ge,y=Rt(z,"impedance","impedanceUnit",Ye("impedance"));R.impedance=y.value,R.impedanceUnit=y.unit;const Q=Rt(z,"power","powerUnit","W");R.power=Q.value||"1"}else if(ge.componentType==="Motor"){const z=ge;R.motorType=z.motorType||"DC";const y=Rt(z,"voltage","voltageUnit",Ye("voltage"));R.voltage=y.value,R.voltageUnit=y.unit;const Q=Rt(z,"current","currentUnit",Ye("current"));R.current=Q.value,R.currentUnit=Q.unit}else if(ge.componentType==="PowerSupply"){const z=ge,y=Rt(z,"inputVoltage","inputVoltageUnit",Ye("inputVoltage"));R.inputVoltage=y.value,R.inputVoltageUnit=y.unit;const Q=Rt(z,"outputVoltage","outputVoltageUnit",Ye("outputVoltage"));R.outputVoltage=Q.value,R.outputVoltageUnit=Q.unit;const Re=Rt(z,"current","currentUnit",Ye("current"));R.current=Re.value,R.currentUnit=Re.unit}else if(ge.componentType==="Transistor"){const z=ge;R.transistorType=z.transistorType||"BJT",R.polarity=z.polarity||"NPN";const y=Rt(z,"voltage","voltageUnit",Ye("voltage"));R.voltage=y.value,R.voltageUnit=y.unit;const Q=Rt(z,"current","currentUnit",Ye("current"));R.current=Q.value,R.currentUnit=Q.unit}else if(ge.componentType==="ResistorNetwork"){const z=ge,y=Rt(z,"resistance","resistanceUnit",Ye("resistance"));R.resistance=y.value,R.resistanceUnit=y.unit,R.configuration=z.configuration||""}else if(ge.componentType==="Thermistor"){const z=ge,y=Rt(z,"resistance","resistanceUnit",Ye("resistance"));R.resistance=y.value,R.resistanceUnit=y.unit,R.thermistorType=z.thermistorType||"NTC",R.beta=z.beta||""}else if(ge.componentType==="Switch"){const z=ge;R.switchType=z.switchType||"Toggle";const y=Rt(z,"current","currentUnit",Ye("current"));R.current=y.value,R.currentUnit=y.unit;const Q=Rt(z,"voltage","voltageUnit",Ye("voltage"));R.voltage=Q.value,R.voltageUnit=Q.unit}else if(ge.componentType==="Transformer"){const z=ge,y=Rt(z,"primaryVoltage","primaryVoltageUnit",Ye("primaryVoltage"));R.primaryVoltage=y.value,R.primaryVoltageUnit=y.unit;const Q=Rt(z,"secondaryVoltage","secondaryVoltageUnit",Ye("secondaryVoltage"));R.secondaryVoltage=Q.value,R.secondaryVoltageUnit=Q.unit;const Re=Rt(z,"power","powerUnit",Ye("power"));R.power=Re.value||"1",R.turns=z.turns||""}else if(ge.componentType==="TestPoint"){const z=ge;R.signal=z.signal||""}else if(ge.componentType==="IntegratedCircuit"){const z=ge;R.description=z.description||ge.designator||"",R.datasheet=z.datasheet||"",R.icType=z.icType||"Op-Amp"}else if(ge.componentType==="VacuumTube"){const z=ge;R.tubeType=z.tubeType||""}else if(ge.componentType==="VariableResistor"){const z=ge;R.vrType=z.vrType||"Potentiometer";const y=Rt(z,"resistance","resistanceUnit",Ye("resistance"));R.resistance=y.value,R.resistanceUnit=y.unit;const Q=Rt(z,"power","powerUnit",Ye("power"));R.power=Q.value||"1/4",R.taper=z.taper||""}else if(ge.componentType==="Crystal"){const z=ge;R.frequency=z.frequency||"",R.loadCapacitance=z.loadCapacitance||"",R.tolerance=z.tolerance||""}else if(ge.componentType==="ZenerDiode"){const z=ge,y=Rt(z,"voltage","voltageUnit",Ye("voltage"));R.voltage=y.value,R.voltageUnit=y.unit;const Q=Rt(z,"power","powerUnit",Ye("power"));R.power=Q.value||"1/4",R.tolerance=z.tolerance||"5%"}$(R)},[]),Fe=w.useCallback(()=>{$(null),ye(null)},[]);return{componentsTop:c,setComponentsTop:u,componentsBottom:b,setComponentsBottom:d,componentEditor:D,setComponentEditor:$,connectingPin:Se,setConnectingPin:ye,componentDialogPosition:g,setComponentDialogPosition:I,isDraggingDialog:ue,setIsDraggingDialog:ve,dialogDragOffset:je,setDialogDragOffset:Ae,addComponent:le,updateComponent:Me,removeComponent:Ie,openComponentEditor:ae,closeComponentEditor:Fe}}function Nx(){const[c,u]=w.useState([]),[b,d]=w.useState(()=>[{id:"groundbus-circuit",name:"GND",color:"#000000"},{id:"groundbus-earth",name:"Earth Ground",color:"#333333"}]),[D,$]=w.useState([]),[Se,ye]=w.useState([]),[g,I]=w.useState(null),[ue,ve]=w.useState(null),je=w.useCallback(A=>{u(R=>[...R,A])},[]),Ae=w.useCallback((A,R)=>{u(z=>z.map(y=>y.id===A?{...y,...R}:y))},[]),le=w.useCallback(A=>{u(R=>R.filter(z=>z.id!==A)),$(R=>R.filter(z=>z.powerBusId!==A))},[]),Me=w.useCallback(A=>{$(R=>[...R,A])},[]),Ie=w.useCallback(A=>{$(R=>R.filter(z=>z.id!==A))},[]),ae=w.useCallback(A=>{ye(R=>[...R,A])},[]),Fe=w.useCallback(A=>{ye(R=>R.filter(z=>z.id!==A))},[]),ge=w.useCallback(A=>{d(R=>[...R,A])},[]),U=w.useCallback((A,R)=>{d(z=>z.map(y=>y.id===A?{...y,...R}:y))},[]),G=w.useCallback(A=>{d(R=>R.filter(z=>z.id!==A)),ye(R=>R.filter(z=>z.groundBusId===A))},[]);return{powerBuses:c,setPowerBuses:u,groundBuses:b,setGroundBuses:d,powerSymbols:D,setPowerSymbols:$,groundSymbols:Se,setGroundSymbols:ye,powerEditor:g,setPowerEditor:I,groundEditor:ue,setGroundEditor:ve,addPowerBus:je,updatePowerBus:Ae,removePowerBus:le,addPowerSymbol:Me,removePowerSymbol:Ie,addGroundSymbol:ae,removeGroundSymbol:Fe,addGroundBus:ge,updateGroundBus:U,removeGroundBus:G}}const Dt={brushColor:"#008080",brushSize:6,topTraceColor:"#AA4499",bottomTraceColor:"#F781BF",topTraceSize:6,bottomTraceSize:6,viaSize:18,viaColor:"#ff0000",topPadColor:"#0072B2",bottomPadColor:"#56B4E9",topPadSize:18,bottomPadSize:18,topTestPointColor:"#FFFF00",bottomTestPointColor:"#FFFF00",topTestPointSize:18,bottomTestPointSize:18,topComponentColor:"#8C564B",bottomComponentColor:"#9C755F",topComponentSize:18,bottomComponentSize:18,componentConnectionColor:"#E69F00",componentConnectionSize:3};function Mx(){const[c,u]=w.useState(Dt.brushColor),[b,d]=w.useState(Dt.brushSize),[D,$]=w.useState(Dt.topTraceColor),[Se,ye]=w.useState(Dt.bottomTraceColor),[g,I]=w.useState(Dt.topTraceSize),[ue,ve]=w.useState(Dt.bottomTraceSize),[je,Ae]=w.useState(Dt.topPadColor),[le,Me]=w.useState(Dt.bottomPadColor),[Ie,ae]=w.useState(Dt.topPadSize),[Fe,ge]=w.useState(Dt.bottomPadSize),[U,G]=w.useState(Dt.topTestPointColor),[A,R]=w.useState(Dt.bottomTestPointColor),[z,y]=w.useState(Dt.topTestPointSize),[Q,Re]=w.useState(Dt.bottomTestPointSize),[Oe,fe]=w.useState(Dt.topComponentColor),[Ee,se]=w.useState(Dt.bottomComponentColor),[_,O]=w.useState(Dt.topComponentSize),[W,Te]=w.useState(Dt.bottomComponentSize),[F,C]=w.useState(Dt.componentConnectionColor),[M,H]=w.useState(Dt.componentConnectionSize),he=w.useCallback(()=>{u(Dt.brushColor),d(Dt.brushSize),$(Dt.topTraceColor),ye(Dt.bottomTraceColor),I(Dt.topTraceSize),ve(Dt.bottomTraceSize),Ae(Dt.topPadColor),Me(Dt.bottomPadColor),ae(Dt.topPadSize),ge(Dt.bottomPadSize),G(Dt.topTestPointColor),R(Dt.bottomTestPointColor),y(Dt.topTestPointSize),Re(Dt.bottomTestPointSize),fe(Dt.topComponentColor),se(Dt.bottomComponentColor),O(Dt.topComponentSize),Te(Dt.bottomComponentSize),C(Dt.componentConnectionColor),H(Dt.componentConnectionSize)},[]),We=w.useCallback(ce=>{ce.brushColor!==void 0&&u(ce.brushColor),ce.brushSize!==void 0&&d(ce.brushSize),ce.topTraceColor!==void 0&&$(ce.topTraceColor),ce.bottomTraceColor!==void 0&&ye(ce.bottomTraceColor),ce.topTraceSize!==void 0&&I(ce.topTraceSize),ce.bottomTraceSize!==void 0&&ve(ce.bottomTraceSize),ce.topPadColor!==void 0&&Ae(ce.topPadColor),ce.bottomPadColor!==void 0&&Me(ce.bottomPadColor),ce.topPadSize!==void 0&&ae(ce.topPadSize),ce.bottomPadSize!==void 0&&ge(ce.bottomPadSize),ce.topTestPointColor!==void 0&&G(ce.topTestPointColor),ce.bottomTestPointColor!==void 0&&R(ce.bottomTestPointColor),ce.topTestPointSize!==void 0&&y(ce.topTestPointSize),ce.bottomTestPointSize!==void 0&&Re(ce.bottomTestPointSize),ce.topComponentColor!==void 0&&fe(ce.topComponentColor),ce.bottomComponentColor!==void 0&&se(ce.bottomComponentColor),ce.topComponentSize!==void 0&&O(ce.topComponentSize),ce.bottomComponentSize!==void 0&&Te(ce.bottomComponentSize),ce.componentConnectionColor!==void 0&&C(ce.componentConnectionColor),ce.componentConnectionSize!==void 0&&H(ce.componentConnectionSize)},[]),et=w.useCallback((ce,en,Hn)=>{},[]),it=w.useCallback((ce,en,Hn)=>{},[]),on=w.useCallback(()=>({brushColor:c,brushSize:b,topTraceColor:D,bottomTraceColor:Se,topTraceSize:g,bottomTraceSize:ue,viaSize:Dt.viaSize,viaColor:Dt.viaColor,topPadColor:je,bottomPadColor:le,topPadSize:Ie,bottomPadSize:Fe,topTestPointColor:U,bottomTestPointColor:A,topTestPointSize:z,bottomTestPointSize:Q,topComponentColor:Oe,bottomComponentColor:Ee,topComponentSize:_,bottomComponentSize:W,componentConnectionColor:F,componentConnectionSize:M}),[c,b,D,Se,g,ue,je,le,Ie,Fe,U,A,z,Q,Oe,Ee,_,W,F,M]);return{brushColor:c,setBrushColor:u,brushSize:b,setBrushSize:d,topTraceColor:D,setTopTraceColor:$,bottomTraceColor:Se,setBottomTraceColor:ye,topTraceSize:g,setTopTraceSize:I,bottomTraceSize:ue,setBottomTraceSize:ve,topPadColor:je,setTopPadColor:Ae,bottomPadColor:le,setBottomPadColor:Me,topPadSize:Ie,setTopPadSize:ae,bottomPadSize:Fe,setBottomPadSize:ge,topTestPointColor:U,setTopTestPointColor:G,bottomTestPointColor:A,setBottomTestPointColor:R,topTestPointSize:z,setTopTestPointSize:y,bottomTestPointSize:Q,setBottomTestPointSize:Re,topComponentColor:Oe,setTopComponentColor:fe,bottomComponentColor:Ee,setBottomComponentColor:se,topComponentSize:_,setTopComponentSize:O,bottomComponentSize:W,setBottomComponentSize:Te,componentConnectionColor:F,setComponentConnectionColor:C,componentConnectionSize:M,setComponentConnectionSize:H,resetToDefaults:he,loadFromProject:We,getCurrentSettings:on,saveDefaultSize:et,saveDefaultColor:it}}function Ux(c,u,b,d,D,$,Se,ye,g,I,ue,ve,je,Ae,le,Me,Ie,ae,Fe,ge,U,G,A,R,z){const[y,Q]=w.useState(()=>c()),Re=w.useRef(null),Oe=w.useRef(d),fe=w.useRef(D),Ee=w.useCallback(O=>u==="draw"&&b==="trace"?O.get("trace"):u==="draw"&&b==="via"?O.get("via"):u==="draw"&&b==="pad"?O.get("pad"):u==="component"?O.get("component"):u==="power"?O.get("power"):u==="ground"?O.get("ground"):null,[u,b]);w.useEffect(()=>{Q(O=>{const W=Ee(O),Te=W?.id||null,F=Re.current,C=new Map(O);if(F&&F!==Te){const M=O.get(F);M&&C.set(F,{...M,settings:{color:Oe.current,size:fe.current}})}if(W&&Te!==F)if(u==="draw"&&b==="trace"){const M=G||"top",H=M==="top"?$:Se,he=M==="top"?ye:g;Oe.current=H,fe.current=he,C.set("trace",{...W,settings:{color:H,size:he}})}else if(u==="draw"&&b==="pad"){const M=A||"top",H=M==="top"?I:ue,he=M==="top"?ve:je;Oe.current=H,fe.current=he,C.set("pad",{...W,settings:{color:H,size:he}})}else if(u==="component"){const M=z||"top",H=M==="top"?ae:Fe,he=M==="top"?ge:U;Oe.current=H,fe.current=he,C.set("component",{...W,settings:{color:H,size:he}})}else Oe.current=W.settings.color,fe.current=W.settings.size;return Re.current=Te,C})},[u,b,d,D,$,Se,ye,g,I,ue,ve,je,ae,Fe,ge,U,G,A,z,Ee]);const se=w.useCallback((O,W)=>{Q(Te=>{const F=new Map(Te),C=F.get(O);return C&&F.set(O,{...C,settings:W}),F})},[]),_=w.useCallback((O,W,Te)=>{Q(F=>{const C=new Map(F),M=C.get(O);if(M){const H=new Map(M.layerSettings);H.set(W,Te),C.set(O,{...M,layerSettings:H})}return C})},[]);return{toolRegistry:y,setToolRegistry:Q,updateToolSettings:se,updateToolLayerSettings:_,getCurrentToolDef:Ee}}function Bx(c){const{currentTool:u,drawingMode:b,traceToolLayer:d,padToolLayer:D,testPointToolLayer:$,componentToolLayer:Se}=c,[ye,g]=w.useState(0),I=w.useCallback(()=>u==="draw"&&b==="via"?"via":u==="draw"&&b==="pad"?D==="bottom"?"padBottom":"padTop":u==="draw"&&b==="testPoint"?$==="bottom"?"testPointBottom":"testPointTop":u==="draw"&&b==="trace"?d==="bottom"?"traceBottom":"traceTop":u==="component"?Se==="bottom"?"componentBottom":"componentTop":u==="power"?"power":u==="ground"?"ground":null,[u,b,D,$,d,Se]),ue=w.useCallback(()=>{const le=I();if(le){const Me=yt.get(le);return{currentTool:u,drawingMode:b,layer:u==="draw"&&b==="pad"?D||"top":u==="draw"&&b==="testPoint"?$||"top":u==="draw"&&b==="trace"?d||"top":u==="component"?Se||"top":void 0,toolInstanceId:le,color:Me.color,size:Me.size}}return{currentTool:u,drawingMode:b,layer:void 0,toolInstanceId:null,color:"#000000",size:10}},[u,b,D,$,d,Se,I]);w.useEffect(()=>{const le=I();return le?yt.subscribe(le,()=>{g(Ie=>Ie+1)}):void 0},[I]);const ve=ue(),je=w.useCallback(le=>{const Me=I();Me&&yt.setColor(Me,le)},[I]),Ae=w.useCallback(le=>{const Me=I();Me&&yt.setSize(Me,le)},[I]);return{toolState:ve,setColor:je,setSize:Ae,getCurrentToolInstanceId:I}}function Px(){const[c,u]=w.useState(!1),[b,d]=w.useState(!1),[D,$]=w.useState(!1),[Se,ye]=w.useState(!1),[g,I]=w.useState(!1),[ue,ve]=w.useState(!1),[je,Ae]=w.useState(!1),[le,Me]=w.useState(!1),Ie=w.useCallback(()=>{u(!0),d(!0),$(!0),ye(!0),I(!0),ve(!0),Ae(!0),Me(!0)},[]),ae=w.useCallback(()=>{u(!1),d(!1),$(!1),ye(!1),I(!1),ve(!1),Ae(!1),Me(!1)},[]);return{areImagesLocked:c,setAreImagesLocked:u,areViasLocked:b,setAreViasLocked:d,arePadsLocked:D,setArePadsLocked:$,areTestPointsLocked:Se,setAreTestPointsLocked:ye,areTracesLocked:g,setAreTracesLocked:I,areComponentsLocked:ue,setAreComponentsLocked:ve,areGroundNodesLocked:je,setAreGroundNodesLocked:Ae,arePowerNodesLocked:le,setArePowerNodesLocked:Me,lockAll:Ie,unlockAll:ae}}function Ox(){const[c,u]=w.useState(null),[b,d]=w.useState({visible:!1,size:6}),[D,$]=w.useState({visible:!1,interval:5}),[Se,ye]=w.useState({visible:!1,source:null,interval:5}),[g,I]=w.useState({visible:!1,text:""}),[ue,ve]=w.useState({visible:!1,title:"",message:""}),[je,Ae]=w.useState({visible:!1}),[le,Me]=w.useState({visible:!1}),[Ie,ae]=w.useState({visible:!1,projectName:"",locationPath:"",locationHandle:null}),[Fe,ge]=w.useState({visible:!1,filename:"",locationPath:"",locationHandle:null}),[U,G]=w.useState(!1),[A,R]=w.useState(!0),[z,y]=w.useState(!1);return{openMenu:c,setOpenMenu:u,setSizeDialog:b,setSetSizeDialog:d,autoSaveDialog:D,setAutoSaveDialog:$,autoSavePromptDialog:Se,setAutoSavePromptDialog:ye,debugDialog:g,setDebugDialog:I,errorDialog:ue,setErrorDialog:ve,newProjectDialog:je,setNewProjectDialog:Ae,openProjectDialog:le,setOpenProjectDialog:Me,newProjectSetupDialog:Ie,setNewProjectSetupDialog:ae,saveAsDialog:Fe,setSaveAsDialog:ge,showColorPicker:U,setShowColorPicker:G,showWelcomeDialog:A,setShowWelcomeDialog:R,transformImagesDialogVisible:z,setTransformImagesDialogVisible:y}}function _x(){const[c,u]=w.useState(!1),[b,d]=w.useState(1),[D,$]=w.useState(null),[Se,ye]=w.useState(""),[g,I]=w.useState(""),[ue,ve]=w.useState(null),[je,Ae]=w.useState("pcb_project"),[le,Me]=w.useState([]),[Ie,ae]=w.useState(-1),Fe=w.useRef(null),ge=w.useRef(!1),U=w.useRef(!1);return{autoSaveEnabled:c,setAutoSaveEnabled:u,autoSaveInterval:b,setAutoSaveInterval:d,autoSaveDirHandle:D,setAutoSaveDirHandle:$,autoSaveBaseName:Se,setAutoSaveBaseName:ye,currentProjectFilePath:g,setCurrentProjectFilePath:I,projectDirHandle:ue,setProjectDirHandle:ve,projectName:je,setProjectName:Ae,autoSaveFileHistory:le,setAutoSaveFileHistory:Me,currentFileIndex:Ie,setCurrentFileIndex:ae,autoSaveIntervalRef:Fe,hasChangesSinceLastAutoSaveRef:ge,prevAutoSaveEnabledRef:U}}function Hx(){const u=kx(),{topImage:b,setTopImage:d,bottomImage:D,setBottomImage:$,currentView:Se,setCurrentView:ye,transparency:g,setTransparency:I,isTransparencyCycling:ue,setIsTransparencyCycling:ve,transparencyCycleSpeed:je,setTransparencyCycleSpeed:Ae,isGrayscale:le,setIsGrayscale:Me,isBlackAndWhiteEdges:Ie,setIsBlackAndWhiteEdges:ae,isBlackAndWhiteInverted:Fe,setIsBlackAndWhiteInverted:ge}=u,[U,G]=w.useState("none"),A=Mx(),{brushColor:R,setBrushColor:z,brushSize:y,setBrushSize:Q,topTraceColor:Re,setTopTraceColor:Oe,bottomTraceColor:fe,setBottomTraceColor:Ee,topTraceSize:se,setTopTraceSize:_,bottomTraceSize:O,setBottomTraceSize:W,topPadColor:Te,setTopPadColor:F,bottomPadColor:C,setBottomPadColor:M,topPadSize:H,setTopPadSize:he,bottomPadSize:We,setBottomPadSize:et,topTestPointColor:it,setTopTestPointColor:on,bottomTestPointColor:ce,setBottomTestPointColor:en,topTestPointSize:Hn,setTopTestPointSize:El,bottomTestPointSize:Ni,setBottomTestPointSize:Mi,topComponentColor:Xn,setTopComponentColor:Ui,bottomComponentColor:si,setBottomComponentColor:wl,topComponentSize:bi,setTopComponentSize:Tl,bottomComponentSize:vi,setBottomComponentSize:ha,componentConnectionColor:us,setComponentConnectionColor:mi,componentConnectionSize:fs,setComponentConnectionSize:Vr,saveDefaultSize:qe,saveDefaultColor:mt}=A,Hc=jx(),{drawingStrokes:$e,setDrawingStrokes:It,isDrawing:ga,setIsDrawing:Xi,currentStroke:pt,setCurrentStroke:hn,tracePreviewMousePos:Rn,setTracePreviewMousePos:jl,drawingMode:De,setDrawingMode:nl,selectedDrawingLayer:ct,setSelectedDrawingLayer:cn,currentStrokeRef:il,lastTraceClickTimeRef:Cl,isDoubleClickingTraceRef:Vl}=Hc,Ea=zx(),{selectedImageForTransform:Ht,setSelectedImageForTransform:xa,isTransforming:Va,setIsTransforming:Gi,transformStartPos:ps,setTransformStartPos:qi,transformMode:Il,setTransformMode:hs}=Ea,ar=Rx(),{viewScale:Ve,setViewScale:ll,viewPan:At,setViewPan:Tn,isShiftConstrained:Fn,setIsShiftConstrained:ri,showBothLayers:Ia,setShowBothLayers:gs}=ar,[Bt,Wa]=w.useState("top"),[Zt,Wl]=w.useState("top"),[Xt,zl]=w.useState("top"),[tn,Fl]=w.useState("top"),al=Pe.useRef("top"),jn=Pe.useRef("top"),Fa=Pe.useRef("top"),$a=Pe.useRef("top");Pe.useEffect(()=>{al.current=Bt},[Bt]),Pe.useEffect(()=>{jn.current=Zt},[Zt]),Pe.useEffect(()=>{Fa.current=Xt},[Xt]),Pe.useEffect(()=>{$a.current=tn},[tn]);const ya=Bx({currentTool:U,drawingMode:De,traceToolLayer:Bt,padToolLayer:Zt,testPointToolLayer:Xt,componentToolLayer:tn}),{toolState:Cn}=ya,Ir=Ux(cx,U,De,R,y,Re,fe,se,O,Te,C,H,We,it,ce,Hn,Ni,Xn,si,bi,vi,Bt,Zt,Xt,tn),{toolRegistry:bt,setToolRegistry:Wt,getCurrentToolDef:La,updateToolSettings:An,updateToolLayerSettings:gn}=Ir,ol=Pe.useRef(null),xn=Pe.useRef(R),Bi=Pe.useRef(y);Pe.useEffect(()=>{Wt(a=>{const r=La(a),f=r?.id||null,m=ol.current,x=new Map(a);if(m&&m!==f){const S=a.get(m);S&&x.set(m,{...S,settings:{color:xn.current,size:Bi.current}})}if(r&&f!==m)if(U==="draw"&&De==="trace"){const S=Bt||"top",p=S==="top"?Re:fe,v=S==="top"?se:O;z(p),Q(v),xn.current=p,Bi.current=v;const T=new Map(r.layerSettings);T.set("top",{color:Re,size:se}),T.set("bottom",{color:fe,size:O}),x.set("trace",{...r,settings:{color:p,size:v},layerSettings:T})}else if(U==="draw"&&De==="pad"){const S=Zt||"top",p=S==="top"?Te:C,v=S==="top"?H:We;z(p),Q(v),xn.current=p,Bi.current=v;const T=new Map(r.layerSettings);T.set("top",{color:Te,size:H}),T.set("bottom",{color:C,size:We}),x.set("pad",{...r,settings:{color:p,size:v},layerSettings:T})}else if(U==="draw"&&De==="testPoint"){const S=Xt||"top",p=S==="top"?it:ce,v=S==="top"?Hn:Ni;z(p),Q(v),xn.current=p,Bi.current=v;const T=new Map(r.layerSettings);T.set("top",{color:it,size:Hn}),T.set("bottom",{color:ce,size:Ni}),x.set("testPoint",{...r,settings:{color:p,size:v},layerSettings:T})}else if(U==="component"){const S=tn||"top",p=S==="top"?Xn:si,v=S==="top"?bi:vi;z(p),Q(v),xn.current=p,Bi.current=v;const T=new Map(r.layerSettings);T.set("top",{color:Xn,size:bi}),T.set("bottom",{color:si,size:vi}),x.set("component",{...r,settings:{color:p,size:v},layerSettings:T})}else{const S=r.settings;z(S.color),Q(S.size),xn.current=S.color,Bi.current=S.size}return ol.current=f,x})},[U,De,La,Re,fe,se,O,Te,C,H,We,it,ce,Hn,Ni,Xt,Xn,si,bi,vi]),Pe.useEffect(()=>{const a=bt.get("trace");if(a){const x=a.layerSettings.get("top"),S=a.layerSettings.get("bottom");x&&(Oe(x.color),_(x.size)),S&&(Ee(S.color),W(S.size))}const r=bt.get("pad");if(r){const x=r.layerSettings.get("top"),S=r.layerSettings.get("bottom");x&&(F(x.color),he(x.size)),S&&(M(S.color),et(S.size))}const f=bt.get("testPoint");if(f){const x=f.layerSettings.get("top"),S=f.layerSettings.get("bottom");x&&(on(x.color),El(x.size)),S&&(en(S.color),Mi(S.size))}const m=bt.get("component");if(m){const x=m.layerSettings.get("top"),S=m.layerSettings.get("bottom");x&&(Ui(x.color),Tl(x.size)),S&&(wl(S.color),ha(S.size))}},[]),Pe.useEffect(()=>{Wt(a=>{const r=new Map(a),f=a.get("trace");if(f){const v=new Map(f.layerSettings);v.set("top",{color:Re,size:se}),v.set("bottom",{color:fe,size:O}),r.set("trace",{...f,layerSettings:v})}const m=a.get("pad");if(m){const v=new Map(m.layerSettings);v.set("top",{color:Te,size:H}),v.set("bottom",{color:C,size:We}),r.set("pad",{...m,layerSettings:v})}const x=a.get("testPoint");if(x){const v=new Map(x.layerSettings);v.set("top",{color:it,size:Hn}),v.set("bottom",{color:ce,size:Ni}),r.set("testPoint",{...x,layerSettings:v})}const S=a.get("component");if(S){const v=new Map(S.layerSettings);v.set("top",{color:Xn,size:bi}),v.set("bottom",{color:si,size:vi}),r.set("component",{...S,layerSettings:v})}const p=a.get("componentConnection");return p&&r.set("componentConnection",{...p,settings:{color:us,size:fs}}),r})},[Re,fe,se,O,Te,C,H,We,it,ce,Hn,Ni,Xn,si,bi,vi,us,fs,Wt]),Pe.useEffect(()=>{Wt(a=>{const r=La(a);if(r)if(U==="draw"&&De==="trace"){const f=Bt||"top";f==="top"?(Oe(R),_(y),mt("trace",R,"top"),qe("trace",y,"top")):(Ee(R),W(y),mt("trace",R,"bottom"),qe("trace",y,"bottom"));const m=new Map(a),x=new Map(r.layerSettings);return x.set(f,{color:R,size:y}),m.set(r.id,{...r,layerSettings:x,settings:{color:R,size:y}}),xn.current=R,Bi.current=y,m}else if(U==="draw"&&De==="pad"){const f=Zt||"top";f==="top"?(F(R),he(y),mt("pad",R,"top"),qe("pad",y,"top")):(M(R),et(y),mt("pad",R,"bottom"),qe("pad",y,"bottom"));const m=new Map(a),x=new Map(r.layerSettings);return x.set(f,{color:R,size:y}),m.set(r.id,{...r,layerSettings:x,settings:{color:R,size:y}}),xn.current=R,Bi.current=y,m}else if(U==="draw"&&De==="testPoint"){const f=Xt||"top";f==="top"?(on(R),El(y),mt("testPoint",R,"top"),qe("testPoint",y,"top")):(en(R),Mi(y),mt("testPoint",R,"bottom"),qe("testPoint",y,"bottom"));const m=new Map(a),x=new Map(r.layerSettings);return x.set(f,{color:R,size:y}),m.set(r.id,{...r,layerSettings:x,settings:{color:R,size:y}}),xn.current=R,Bi.current=y,m}else if(U==="component"){const f=tn||"top";f==="top"?(Ui(R),Tl(y),mt("component",R,"top"),qe("component",y,"top")):(wl(R),ha(y),mt("component",R,"bottom"),qe("component",y,"bottom"));const m=new Map(a),x=new Map(r.layerSettings);return x.set(f,{color:R,size:y}),m.set(r.id,{...r,layerSettings:x,settings:{color:R,size:y}}),xn.current=R,Bi.current=y,m}else{const f=new Map(a);return f.set(r.id,{...r,settings:{color:R,size:y}}),xn.current=R,Bi.current=y,f}return a})},[R,y,U,De,Bt,Zt,Xt,tn,La,mt,qe,Oc,Oe,Ee,_,W,F,M,he,et,on,en,El,Mi,Ui,wl,Tl,ha]),Pe.useEffect(()=>{U==="power"?(ro(!0),Ds(null)):(ro(!1),Ds(null))},[U]),Pe.useEffect(()=>{U==="ground"?(uo(!0),Fo(null)):(uo(!1),Fo(null))},[U]),Pe.useEffect(()=>{Na(U==="draw"&&De==="trace")},[U,De]),Pe.useEffect(()=>{tl(U==="draw"&&De==="pad")},[U,De]),Pe.useEffect(()=>{qo(U==="draw"&&De==="testPoint")},[U,De]),Pe.useEffect(()=>{Cn.toolInstanceId&&(z(Cn.color),Q(Cn.size))},[Cn.toolInstanceId,Cn.color,Cn.size,z,Q,U,De]);const[or,Jn]=w.useState(void 0),[,xs]=w.useState([]),[,zo]=w.useState([]),[,Ya]=w.useState([]),[,Ne]=w.useState([]),[$n,ys]=w.useState([]),[Wr,ci]=w.useState([]),[Ec,Fr]=w.useState([]),[ko,Vc]=w.useState([]),Ln=w.useRef(null),Bd=Cx(),{selectedIds:jt,setSelectedIds:Ct,isSelecting:$r,setIsSelecting:Ro,selectedComponentIds:at,setSelectedComponentIds:St,selectedPowerIds:Ut,setSelectedPowerIds:ht,selectedGroundIds:Nt,setSelectedGroundIds:zt}=Bd,Ic=Ax(),{componentsTop:kt,setComponentsTop:dn,componentsBottom:gt,setComponentsBottom:zn,componentEditor:$l,setComponentEditor:Ll,connectingPin:di,setConnectingPin:ba,componentDialogPosition:Yl,setComponentDialogPosition:va,isDraggingDialog:bs,setIsDraggingDialog:Wc,dialogDragOffset:Gn,setDialogDragOffset:Xa,openComponentEditor:sr}=Ic,rr=Nx(),{powerBuses:ut,setPowerBuses:ui,groundBuses:Yn,setGroundBuses:Pi,powerSymbols:Lr,setPowerSymbols:Si,groundSymbols:Au,setGroundSymbols:Zi,powerEditor:Qi,setPowerEditor:ma}=rr,Nu=Px(),{areImagesLocked:wi,setAreImagesLocked:Do,areViasLocked:fi,setAreViasLocked:vs,arePadsLocked:Oi,setArePadsLocked:cr,areTestPointsLocked:Sa,setAreTestPointsLocked:Fc,areTracesLocked:pi,setAreTracesLocked:Ga,areComponentsLocked:_i,setAreComponentsLocked:ms,areGroundNodesLocked:Hi,setAreGroundNodesLocked:qa,arePowerNodesLocked:Dn,setArePowerNodesLocked:Ss}=Nu,Mu=Ox(),{openMenu:Uu,setOpenMenu:dr,setSizeDialog:Ao,setSetSizeDialog:Za,autoSaveDialog:Yr,setAutoSaveDialog:Xl,autoSavePromptDialog:Qa,setAutoSavePromptDialog:hi,debugDialog:ws,setDebugDialog:Ka,errorDialog:Xr,setErrorDialog:No,newProjectDialog:Gr,setNewProjectDialog:Ja,openProjectDialog:eo,setOpenProjectDialog:Ts,newProjectSetupDialog:nn,setNewProjectSetupDialog:Mo,saveAsDialog:yn,setSaveAsDialog:to,showColorPicker:Uo,setShowColorPicker:Gl,transformImagesDialogVisible:Bu,setTransformImagesDialogVisible:js}=Mu,Pd=_x(),{autoSaveEnabled:Ei,setAutoSaveEnabled:Vi,autoSaveInterval:wa,setAutoSaveInterval:kl,autoSaveDirHandle:Ta,setAutoSaveDirHandle:ja,autoSaveBaseName:no,setAutoSaveBaseName:Rl,currentProjectFilePath:qr,setCurrentProjectFilePath:Ii,projectDirHandle:qn,setProjectDirHandle:Nn,projectName:En,setProjectName:sl,autoSaveFileHistory:Od,setAutoSaveFileHistory:io,currentFileIndex:$c,setCurrentFileIndex:Cs,autoSaveIntervalRef:ln,hasChangesSinceLastAutoSaveRef:Ti,prevAutoSaveEnabledRef:ur}=Pd,zs=w.useRef(null),Zr=w.useRef(null),Qr=w.useRef(null),ql=w.useRef(null),Ca=w.useRef(null),Bo=w.useRef(null),Lc=w.useRef(null),[Ki,ks]=w.useState(!1),lo=w.useRef(null),Po=w.useRef(null),[fr,Kr]=w.useState(!1),[pr,Oo]=w.useState({}),[Yc,rl]=w.useState(!1),bn=w.useRef(null),[_o,Ji]=w.useState(!1),[Zl,za]=w.useState(null),[Ho,ka]=w.useState(null),[ao,Eo]=w.useState({width:960,height:600}),hr=w.useRef(null),gr=w.useRef(null),Vo=w.useRef(null),Pu=w.useRef(null),gi=w.useRef(null),xr=w.useRef(null),Ql=w.useRef(null),Xc=w.useRef(null),yr=w.useRef(null),[Kl,Jl]=w.useState(!0),[br,ea]=w.useState(!0),[ji,ei]=w.useState(!0),[ti,Dl]=w.useState(!0),[Ci,ta]=w.useState(!0),[Mn,ni]=w.useState(!0),[Zn,zi]=w.useState(!0),[ii,cl]=w.useState(!0),[Ra,Rs]=w.useState(!0),[dl,oo]=w.useState(!0),[un,Lt]=w.useState(!0),[wt,el]=w.useState(!0),Ke=Lr,dt=Au,[so,Io]=w.useState(!1),[vr,na]=w.useState(null),[Da,ro]=w.useState(!1),[co,Ds]=w.useState(null),[Wo,Wi]=w.useState(!1),[ia,Al]=w.useState(null),[mr,uo]=w.useState(!1),[Nl,Fo]=w.useState(null),[ul,On]=w.useState(!0),[Aa,$o]=w.useState(!1),[Ou,Sr]=w.useState(!1),Lo=w.useRef({}),[an,fo]=w.useState(!0),[la,aa]=w.useState(!0),[Fi,oa]=w.useState(null),[po,_d]=w.useState(!1),[wr,Hd]=w.useState(null),[Jr,$i]=w.useState(!1),[ho,Yo]=w.useState(null),[ec,Xo]=w.useState(!1),[As,Tr]=w.useState(null),[go,Ns]=w.useState([]),[tc,sa]=w.useState(!1),[fl,Ms]=w.useState(null),[nc,xo]=w.useState(!1),[yo,Us]=w.useState(null),[jr,Bs]=w.useState(null),[Ed,ra]=w.useState(!1);Pe.useEffect(()=>{ut.length===0&&ui([{id:"default-3v3",name:"+3.3V",voltage:"+3.3VDC",color:"#ff6600"},{id:"default-5v",name:"+5V",voltage:"+5VDC",color:"#ff0000"}])},[ut.length,ui]);const Ml=w.useCallback((a,r)=>{const f=Ke.find(x=>x.pointId===a);if(f){const x=r.find(p=>p.id===f.powerBusId);return`Via (${x?x.voltage:f.type||"Power Node"})`}const m=dt.find(x=>x.pointId===a);return m?`Via (${m.type||"Ground"})`:"Via (Signal)"},[Ke,dt]),li=w.useCallback((a,r)=>{const f=Ke.find(x=>x.pointId===a);if(f){const x=r.find(p=>p.id===f.powerBusId);return`Pad (${x?x.voltage:f.type||"Power Node"})`}const m=dt.find(x=>x.pointId===a);return m?`Pad (${m.type||"Ground"})`:"Pad (Signal)"},[Ke,dt]),Ul=w.useCallback((a,r)=>{const f=Ke.find(x=>x.pointId===a);if(f){const x=r.find(p=>p.id===f.powerBusId);return`Test Point (${x?x.voltage:f.type||"Power Node"})`}const m=dt.find(x=>x.pointId===a);return m?`Test Point (${m.type||"Ground"})`:"Test Point (Signal)"},[Ke,dt]),Gc=w.useCallback(()=>{const a=$e.filter(r=>r.type==="via").map(r=>r.id);Ct(new Set(a)),St(new Set),ht(new Set),zt(new Set)},[$e,Ct,St,ht,zt]),bo=w.useCallback(()=>{const a=$e.filter(r=>r.type==="trace").map(r=>r.id);Ct(new Set(a)),St(new Set),ht(new Set),zt(new Set)},[$e,Ct,St,ht,zt]),vo=w.useCallback(()=>{const a=$e.filter(r=>r.type==="pad").map(r=>r.id);Ct(new Set(a)),St(new Set),ht(new Set),zt(new Set)},[$e,Ct,St,ht,zt]),Cr=w.useCallback(()=>{const a=[...kt,...gt].map(r=>r.id);St(new Set(a)),Ct(new Set),ht(new Set),zt(new Set)},[kt,gt,St,Ct,ht,zt]),qc=w.useCallback(()=>{const a=[...kt,...gt].filter(r=>{const f=r.pinConnections||[];return!(f.length>0&&f.length===r.pinCount&&f.every(x=>x&&x.trim()!==""))}).map(r=>r.id);St(new Set(a)),Ct(new Set),ht(new Set),zt(new Set),Ka({visible:!0,text:""})},[kt,gt,St,Ct,ht,zt,Ka]),Zc=w.useCallback((a,r,f)=>{const m=Ln.current;if(!m)return;const x=m.width-80,S=m.height-80,p=x/2,v=S/2,T=p-r*Ve,k=v-f*Ve;Tn({x:T,y:k}),St(new Set([a])),Ct(new Set),ht(new Set),zt(new Set)},[Ve,Tn,St,Ct,ht,zt]),zr=Pe.useMemo(()=>{const a=new Set(Ke.map(f=>f.powerBusId).filter(f=>typeof f=="string"&&f.length>0)),r=ut.filter(f=>a.has(f.id)).map(f=>f.name);return Array.from(new Set(r)).sort()},[Ke,ut]),kr=Pe.useMemo(()=>{const a=new Set(dt.map(f=>f.groundBusId).filter(f=>typeof f=="string"&&f.length>0)),r=Yn.filter(f=>a.has(f.id)).map(f=>f.name);return Array.from(new Set(r)).sort()},[dt,Yn]),Vd=w.useCallback(()=>{const a=Ke.map(r=>r.id);ht(new Set(a)),Ct(new Set),St(new Set),zt(new Set)},[Ke,ht,Ct,St,zt]),Id=w.useCallback(()=>{const a=dt.map(r=>r.id);zt(new Set(a)),Ct(new Set),St(new Set),ht(new Set)},[dt,zt,Ct,St,ht]),Ps=w.useCallback(a=>{const r=ut.filter(m=>m.name===a).map(m=>m.id);if(r.length===0)return;const f=Ke.filter(m=>m.powerBusId&&r.includes(m.powerBusId)).map(m=>m.id);ht(new Set(f)),Ct(new Set),St(new Set),zt(new Set)},[ut,Ke,ht,Ct,St,zt]),ic=w.useCallback(a=>{const r=Yn.filter(m=>m.name===a).map(m=>m.id);if(r.length===0)return;const f=dt.filter(m=>m.groundBusId&&r.includes(m.groundBusId)).map(m=>m.id);zt(new Set(f)),Ct(new Set),St(new Set),ht(new Set)},[Yn,dt,zt,Ct,St,ht]);w.useCallback(a=>{switch(a.componentType){case"Resistor":case"ResistorNetwork":case"Thermistor":case"VariableResistor":if("resistance"in a&&a.resistance&&"resistanceUnit"in a&&a.resistanceUnit)return`${a.resistance} ${a.resistanceUnit}`;break;case"Capacitor":case"Electrolytic Capacitor":case"Film Capacitor":if("capacitance"in a&&a.capacitance&&"capacitanceUnit"in a&&a.capacitanceUnit)return`${a.capacitance} ${a.capacitanceUnit}`;break;case"Inductor":if("inductance"in a&&a.inductance&&"inductanceUnit"in a&&a.inductanceUnit)return`${a.inductance} ${a.inductanceUnit}`;break;case"Battery":if("voltage"in a&&a.voltage&&"voltageUnit"in a&&a.voltageUnit)return`${a.voltage} ${a.voltageUnit}`;break;case"Diode":case"ZenerDiode":if("voltage"in a&&a.voltage&&"voltageUnit"in a&&a.voltageUnit)return`${a.voltage} ${a.voltageUnit}`;break;case"Fuse":if("current"in a&&a.current&&"currentUnit"in a&&a.currentUnit)return`${a.current} ${a.currentUnit}`;break;case"FerriteBead":if("impedance"in a&&a.impedance&&"impedanceUnit"in a&&a.impedanceUnit)return`${a.impedance} ${a.impedanceUnit}`;break;case"Relay":if("coilVoltage"in a&&a.coilVoltage&&"coilVoltageUnit"in a&&a.coilVoltageUnit)return`${a.coilVoltage} ${a.coilVoltageUnit}`;break;case"Speaker":if("impedance"in a&&a.impedance&&"impedanceUnit"in a&&a.impedanceUnit)return`${a.impedance} ${a.impedanceUnit}`;break;case"Motor":if("voltage"in a&&a.voltage&&"voltageUnit"in a&&a.voltageUnit)return`${a.voltage} ${a.voltageUnit}`;break;case"PowerSupply":if("outputVoltage"in a&&a.outputVoltage&&"outputVoltageUnit"in a&&a.outputVoltageUnit)return`${a.outputVoltage} ${a.outputVoltageUnit}`;break;case"Transistor":if("partNumber"in a&&a.partNumber)return a.partNumber;break;case"IntegratedCircuit":if("partNumber"in a&&a.partNumber)return a.partNumber;break}return null},[]);const Wd=w.useCallback(a=>{const r=[];switch(a.componentType){case"Capacitor":case"Electrolytic Capacitor":case"Film Capacitor":"capacitance"in a&&a.capacitance&&"capacitanceUnit"in a&&a.capacitanceUnit&&r.push(`Capacitance: ${a.capacitance} ${a.capacitanceUnit}`),"voltage"in a&&a.voltage&&"voltageUnit"in a&&a.voltageUnit&&r.push(`Voltage: ${a.voltage} ${a.voltageUnit}`),"dielectric"in a&&a.dielectric&&r.push(`Dielectric: ${a.dielectric}`);break;case"Resistor":case"ResistorNetwork":case"Thermistor":"resistance"in a&&a.resistance&&"resistanceUnit"in a&&a.resistanceUnit&&r.push(`Resistance: ${a.resistance} ${a.resistanceUnit}`),"power"in a&&a.power&&r.push(`Power: ${a.power}`),"tolerance"in a&&a.tolerance&&r.push(`Tolerance: ${a.tolerance}`);break;case"VariableResistor":"resistance"in a&&a.resistance&&"resistanceUnit"in a&&a.resistanceUnit&&r.push(`Resistance: ${a.resistance} ${a.resistanceUnit}`),"vrType"in a&&a.vrType&&r.push(`Type: ${a.vrType}`),"power"in a&&a.power&&r.push(`Power: ${a.power}`),"taper"in a&&a.taper&&r.push(`Taper: ${a.taper}`);break;case"Inductor":"inductance"in a&&a.inductance&&"inductanceUnit"in a&&a.inductanceUnit&&r.push(`Inductance: ${a.inductance} ${a.inductanceUnit}`),"current"in a&&a.current&&"currentUnit"in a&&a.currentUnit&&r.push(`Current: ${a.current} ${a.currentUnit}`),"tolerance"in a&&a.tolerance&&r.push(`Tolerance: ${a.tolerance}`);break;case"Battery":"voltage"in a&&a.voltage&&"voltageUnit"in a&&a.voltageUnit&&r.push(`Voltage: ${a.voltage} ${a.voltageUnit}`),"capacity"in a&&a.capacity&&"capacityUnit"in a&&a.capacityUnit&&r.push(`Capacity: ${a.capacity} ${a.capacityUnit}`);break;case"Diode":"voltage"in a&&a.voltage&&"voltageUnit"in a&&a.voltageUnit&&r.push(`Voltage: ${a.voltage} ${a.voltageUnit}`),"current"in a&&a.current&&"currentUnit"in a&&a.currentUnit&&r.push(`Current: ${a.current} ${a.currentUnit}`);break;case"ZenerDiode":"voltage"in a&&a.voltage&&"voltageUnit"in a&&a.voltageUnit&&r.push(`Voltage: ${a.voltage} ${a.voltageUnit}`),"power"in a&&a.power&&r.push(`Power: ${a.power}`),"tolerance"in a&&a.tolerance&&r.push(`Tolerance: ${a.tolerance}`);break;case"Fuse":"current"in a&&a.current&&"currentUnit"in a&&a.currentUnit&&r.push(`Current: ${a.current} ${a.currentUnit}`),"voltage"in a&&a.voltage&&"voltageUnit"in a&&a.voltageUnit&&r.push(`Voltage: ${a.voltage} ${a.voltageUnit}`);break;case"FerriteBead":"impedance"in a&&a.impedance&&"impedanceUnit"in a&&a.impedanceUnit&&r.push(`Impedance: ${a.impedance} ${a.impedanceUnit}`),"current"in a&&a.current&&"currentUnit"in a&&a.currentUnit&&r.push(`Current: ${a.current} ${a.currentUnit}`);break;case"Relay":"coilVoltage"in a&&a.coilVoltage&&"coilVoltageUnit"in a&&a.coilVoltageUnit&&r.push(`Coil Voltage: ${a.coilVoltage} ${a.coilVoltageUnit}`),"contactRating"in a&&a.contactRating&&r.push(`Contact Rating: ${a.contactRating}`);break;case"Speaker":"impedance"in a&&a.impedance&&"impedanceUnit"in a&&a.impedanceUnit&&r.push(`Impedance: ${a.impedance} ${a.impedanceUnit}`),"power"in a&&a.power&&r.push(`Power: ${a.power}`);break;case"Motor":"voltage"in a&&a.voltage&&"voltageUnit"in a&&a.voltageUnit&&r.push(`Voltage: ${a.voltage} ${a.voltageUnit}`),"speed"in a&&a.speed&&"speedUnit"in a&&a.speedUnit&&r.push(`Speed: ${a.speed} ${a.speedUnit}`);break;case"PowerSupply":"outputVoltage"in a&&a.outputVoltage&&"outputVoltageUnit"in a&&a.outputVoltageUnit&&r.push(`Output Voltage: ${a.outputVoltage} ${a.outputVoltageUnit}`),"outputCurrent"in a&&a.outputCurrent&&"outputCurrentUnit"in a&&a.outputCurrentUnit&&r.push(`Output Current: ${a.outputCurrent} ${a.outputCurrentUnit}`);break;case"Transistor":"partNumber"in a&&a.partNumber&&r.push(`Part Number: ${a.partNumber}`),"transistorType"in a&&a.transistorType&&r.push(`Type: ${a.transistorType}`);break;case"Crystal":"frequency"in a&&a.frequency&&r.push(`Frequency: ${a.frequency}`),"loadCapacitance"in a&&a.loadCapacitance&&r.push(`Load Capacitance: ${a.loadCapacitance}`),"tolerance"in a&&a.tolerance&&r.push(`Tolerance: ${a.tolerance}`);break;case"VacuumTube":"tubeType"in a&&a.tubeType&&r.push(`Tube Type: ${a.tubeType}`),"partNumber"in a&&a.partNumber&&r.push(`Part Number: ${a.partNumber}`);break}return r},[]),[Go,Na]=w.useState(!1),Qn=w.useRef(null),[ki,tl]=w.useState(!1),[Rr,qo]=w.useState(!1),pl=w.useRef(null),ai=w.useRef(null),kn=w.useRef(null),Zo=w.useRef(null),[hl,st]=w.useState(!1),[Ft,vn]=w.useState(!1),[Ri,mo]=w.useState(null),[Qo,lc]=w.useState(new Set),Os=w.useRef(null),gl=w.useRef(null),ac=w.useRef(null),mn=w.useRef(null),_s=w.useRef(null),Dr=w.useRef(null),oc=w.useRef(null),sc=w.useRef(null),[_u,rc]=w.useState(null),[xl,cc]=w.useState(!1),[Vn,Un]=w.useState(null),[Bl,Ko]=w.useState(null),Ar=w.useCallback(async(a,r)=>{try{const f=await createImageBitmap(a),m=URL.createObjectURL(a),x=await new Promise((N,Z)=>{const re=new FileReader;re.onload=()=>N(re.result),re.onerror=Z,re.readAsDataURL(a)}),S=Ln.current;let p=0,v=0;if(S){const N=S.width-80,Z=S.height-80,re=N/2,Y=Z/2;p=(re-At.x)/Ve,v=(Y-At.y)/Ve}const T=a.name,k={url:m,name:a.name,width:f.width,height:f.height,dataUrl:x,filePath:T,x:p,y:v,scale:1,rotation:0,flipX:!1,flipY:!1,skewX:0,skewY:0,keystoneV:0,keystoneH:0,bitmap:f};r==="top"?d(k):$(k)}catch(f){console.error("Failed to load image",f)}},[At.x,At.y,Ve,b,D]),Qc=w.useCallback(a=>{a.stopPropagation(),a.preventDefault();const r=Ln.current;if(!r)return;document.activeElement!==r&&r.focus();const f=r.getBoundingClientRect(),m=r.width/f.width,x=r.height/f.height,S=a.nativeEvent.offsetX,p=a.nativeEvent.offsetY,v=typeof S=="number"?S:a.clientX-f.left,T=typeof p=="number"?p:a.clientY-f.top,k=v*m,N=T*x,Z=k-40,re=N-40,Y=(Z-At.x)/Ve,J=(re-At.y)/Ve;if(U==="center"){rl(!0),bn.current&&clearTimeout(bn.current),bn.current=setTimeout(()=>{rl(!1),G("select"),Jn(void 0)},2e3);return}if(U==="select"){if(di){let B=1/0,pe=null,te=null;const ke=Math.max(6/Ve,4),Ze=[...kt,...gt].find(Le=>Le.id===di.componentId)?.layer||"top";for(const Le of $e)if((Le.type==="via"||Le.type==="pad")&&Le.points.length>0){if(Le.type==="pad"&&(Le.layer||"top")!==Ze)continue;const ot=Le.points[0],Xe=Math.max(1,Le.size/2),xt=Math.hypot(ot.x-Y,ot.y-J),nt=Math.max(Xe,ke);xt<=nt&&xt<B&&(B=xt,pe=ot.id??null,te=Le)}if(te?(console.log(`
[PIN CONNECTION] Found via!`),console.log(`  Stroke ID: ${te.id}`),console.log(`  Point ID: ${pe}`),console.log(`  Point coordinates: x=${te.points[0].x.toFixed(2)}, y=${te.points[0].y.toFixed(2)}`),console.log(`  Click coordinates: x=${Y.toFixed(2)}, y=${J.toFixed(2)}`),console.log(`  Distance: ${B.toFixed(2)}`),console.log(`  Via size: ${te.size}, radius: ${Math.max(1,te.size/2)}`)):(console.log(`
[PIN CONNECTION] No via found!`),console.log(`  Click coordinates: x=${Y.toFixed(2)}, y=${J.toFixed(2)}`),console.log(`  Hit tolerance: ${ke.toFixed(2)}`),console.log(`  Total vias in drawingStrokes: ${$e.filter(Le=>Le.type==="via").length}`)),pe!=null){console.log(`
[PIN CONNECTION] Proceeding with connection...`),console.log(`  bestPointId is valid: ${pe} (type: ${typeof pe})`);const Le=String(pe),ot=di.pinIndex,Xe=di.componentId;console.log(`
=== PIN CONNECTION START ===`),console.log(`Connecting pin ${ot} (Pin ${ot+1}) of component ${Xe} to point ID ${Le}`);const xt=kt.find(Be=>Be.id===Xe),nt=gt.find(Be=>Be.id===Xe);xt?(console.log("Component found in TOP layer"),dn(Be=>{const Je=Be.find(vt=>vt.id===Xe);if(!Je)return console.error(`Component ${Xe} not found in TOP layer during update!`),Be;console.log("BEFORE update: pinConnections =",Je.pinConnections);const Yt=Je.pinConnections||[],Qt=Yt.length>0?[...Yt]:new Array(Je.pinCount).fill("");let Kt;if(Qt.length!==Je.pinCount){Kt=new Array(Je.pinCount).fill("");for(let vt=0;vt<Math.min(Qt.length,Je.pinCount);vt++)Kt[vt]=Qt[vt]||""}else Kt=[...Qt];Kt[ot]=Le,console.log(`Updating pin ${ot} with value: ${Le}`),console.log("New pinConnections array:",Kt);const Sn=Be.map(vt=>vt.id===Xe?{...vt,pinConnections:Kt}:vt),ft=Sn.find(vt=>vt.id===Xe);return console.log("AFTER update: pinConnections =",ft?.pinConnections),console.log(`Pin ${ot} value: ${ft?.pinConnections[ot]}`),console.log(`=== PIN CONNECTION COMPLETE (TOP) ===
`),Sn})):nt?(console.log("Component found in BOTTOM layer"),zn(Be=>{const Je=Be.find(vt=>vt.id===Xe);if(!Je)return console.error(`Component ${Xe} not found in BOTTOM layer during update!`),Be;console.log("BEFORE update: pinConnections =",Je.pinConnections);const Yt=Je.pinConnections||[],Qt=Yt.length>0?[...Yt]:new Array(Je.pinCount).fill("");let Kt;if(Qt.length!==Je.pinCount){Kt=new Array(Je.pinCount).fill("");for(let vt=0;vt<Math.min(Qt.length,Je.pinCount);vt++)Kt[vt]=Qt[vt]||""}else Kt=[...Qt];Kt[ot]=Le,console.log(`Updating pin ${ot} with value: ${Le}`),console.log("New pinConnections array:",Kt);const Sn=Be.map(vt=>vt.id===Xe?{...vt,pinConnections:Kt}:vt),ft=Sn.find(vt=>vt.id===Xe);return console.log("AFTER update: pinConnections =",ft?.pinConnections),console.log(`Pin ${ot} value: ${ft?.pinConnections[ot]}`),console.log(`=== PIN CONNECTION COMPLETE (BOTTOM) ===
`),Sn})):(console.error(`Component ${Xe} not found in either TOP or BOTTOM layer!`),console.log("Available TOP components:",kt.map(Be=>Be.id)),console.log("Available BOTTOM components:",gt.map(Be=>Be.id))),setTimeout(()=>{ba(null)},0);return}else ba(null)}const L=10,K=(()=>{for(const B of kt)if(Y>=B.x-L&&Y<=B.x+L&&J>=B.y-L&&J<=B.y+L)return{layer:"top",comp:B};for(const B of gt)if(Y>=B.x-L&&Y<=B.x+L&&J>=B.y-L&&J<=B.y+L)return{layer:"bottom",comp:B};return null})();if(K){const{comp:B}=K;a.shiftKey?St(pe=>{const te=new Set(pe);return te.has(B.id)?te.delete(B.id):te.add(B.id),te}):(St(new Set([B.id])),Ct(new Set),ht(new Set),zt(new Set));return}const q=Math.max(6/Ve,4);let xe=null;for(const B of Ke){const pe=Math.max(6,B.size/2),te=pe*.8,ke=pe+te,_e=Math.hypot(B.x-Y,B.y-J),Ze=Math.abs(Y-B.x)<=q&&Math.abs(J-B.y)<=ke,Le=Math.abs(J-B.y)<=q&&Math.abs(Y-B.x)<=ke;if(_e<=Math.max(pe,q)||Ze||Le){xe=B;break}}if(xe){a.shiftKey?ht(B=>{const pe=new Set(B);return pe.has(xe.id)?pe.delete(xe.id):pe.add(xe.id),pe}):(ht(new Set([xe.id])),Ct(new Set),St(new Set),zt(new Set));return}let Ce=null;for(const B of dt){const pe=Math.max(6,(B.size||18)/2),te=pe*.8,ke=pe+te,_e=Math.hypot(B.x-Y,B.y-J),Ze=Math.abs(Y-B.x)<=q&&Math.abs(J-B.y)<=ke,Le=Math.abs(J-B.y)<=q&&Math.abs(Y-B.x)<=ke;if(_e<=Math.max(pe,q)||Ze||Le){Ce=B;break}}if(Ce){a.shiftKey?zt(B=>{const pe=new Set(B);return pe.has(Ce.id)?pe.delete(Ce.id):pe.add(Ce.id),pe}):(zt(new Set([Ce.id])),Ct(new Set),St(new Set),ht(new Set));return}const oe=Math.max(6/Ve,4/Ve),Ue=Math.max(oe,.5);let E=null;for(const B of $e)if((B.type==="via"||B.type==="pad"||B.type==="testPoint")&&B.points.length>0){let pe=!1;if(B.type==="via"?pe=ji:B.type==="pad"?pe=(B.layer||"top")==="top"?Mn:Zn:B.type==="testPoint"&&(pe=(B.layer||"top")==="top"?ii:Ra),!pe)continue;const te=B.points[0],ke=Math.max(1,B.size/2);if(Math.hypot(te.x-Y,te.y-J)<=Math.max(ke,Ue)){E=B;break}}if(E){a.shiftKey?Ct(B=>{const pe=new Set(B);return pe.has(E.id)?pe.delete(E.id):pe.add(E.id),pe}):(Ct(new Set([E.id])),St(new Set),ht(new Set),zt(new Set));return}a.shiftKey||(Ct(new Set),St(new Set),ht(new Set),zt(new Set)),Ro(!0),Un({x:Y,y:J,shiftKey:a.shiftKey}),Ko({x:Y,y:J,width:0,height:0});return}else if(U==="magnify"){const L=a.shiftKey?.5:2,K=Math.max(.25,Math.min(8,Ve*L)),q=Z-K*Y,xe=re-K*J;ll(K),Tn({x:q,y:xe});return}else if(U==="pan"){lo.current={startCX:Z,startCY:re,panX:At.x,panY:At.y},Po.current={startClientX:a.clientX,startClientY:a.clientY,panX:At.x,panY:At.y},ks(!0);return}else if(U==="draw"){const L=(xe,Ce)=>{let ze=1/0,oe=null;const Ue=10/Ve,E=Ve>20?Math.max(Ue,1e-4):Ve>10?Math.max(Ue,.001):Math.max(Ue,.01);for(const te of $e)if(te.type==="via"){const ke=te.points[0],_e=Math.hypot(ke.x-xe,ke.y-Ce);_e<=E&&_e<ze&&(ze=_e,oe=ke)}else if(te.type==="pad"){const ke=te.points[0],_e=Math.hypot(ke.x-xe,ke.y-Ce);_e<=E&&_e<ze&&(ze=_e,oe=ke)}for(const te of Ke)if(te.pointId!==void 0){const ke=Math.hypot(te.x-xe,te.y-Ce);ke<=E&&ke<ze&&(ze=ke,oe={x:te.x,y:te.y,id:te.pointId})}for(const te of dt)if(te.pointId!==void 0){const ke=Math.hypot(te.x-xe,te.y-Ce);ke<=E&&ke<ze&&(ze=ke,oe={x:te.x,y:te.y,id:te.pointId})}const pe=_t(oe??{x:xe,y:Ce});return{x:pe.x,y:pe.y,nodeId:oe?.id}};if(De==="via"){const xe=yt.get("via"),Ce=xe.color,ze=xe.size,He=xl?{x:_t({x:Y,y:J}).x,y:_t({x:Y,y:J}).y}:((te,ke)=>{let _e=1/0,Ze=null;const ot=10/Ve,Xe=Ve>10?Math.max(ot,.001):Math.max(ot,.01);for(const Be of $e)if(Be.type==="via"||Be.type==="pad"){const Je=Be.points[0],Yt=Math.hypot(Je.x-te,Je.y-ke);Yt<=Xe&&Yt<_e&&(_e=Yt,Ze=Je)}for(const Be of Ke)if(Be.pointId!==void 0){const Je=Math.hypot(Be.x-te,Be.y-ke);Je<=Xe&&Je<_e&&(_e=Je,Ze={x:Be.x,y:Be.y,id:Be.pointId})}for(const Be of dt)if(Be.pointId!==void 0){const Je=Math.hypot(Be.x-te,Be.y-ke);Je<=Xe&&Je<_e&&(_e=Je,Ze={x:Be.x,y:Be.y,id:Be.pointId})}const nt=_t(Ze??{x:te,y:ke});return{x:nt.x,y:nt.y,nodeId:Ze?.id}})(Y,J),Ue=He.nodeId??Yi(),E=Ml(Ue,ut),B={id:Ue,x:He.x,y:He.y},pe={id:`${Date.now()}-via`,points:[B],color:Ce,size:ze,layer:ct,type:"via",viaType:E};It(te=>[...te,pe]),ct==="top"?xs(te=>[...te,pe.id]):zo(te=>[...te,pe.id]);return}if(De==="pad"){if(!Zt)return;const Ce=xl?{x:_t({x:Y,y:J}).x,y:_t({x:Y,y:J}).y}:((pe,te)=>{let ke=1/0,_e=null;const Le=10/Ve,ot=Ve>10?Math.max(Le,.001):Math.max(Le,.01);for(const nt of $e)if(nt.type==="via"||nt.type==="pad"||nt.type==="testPoint"){const Be=nt.points[0],Je=Math.hypot(Be.x-pe,Be.y-te);Je<=ot&&Je<ke&&(ke=Je,_e=Be)}for(const nt of Ke)if(nt.pointId!==void 0){const Be=Math.hypot(nt.x-pe,nt.y-te);Be<=ot&&Be<ke&&(ke=Be,_e={x:nt.x,y:nt.y,id:nt.pointId})}for(const nt of dt)if(nt.pointId!==void 0){const Be=Math.hypot(nt.x-pe,nt.y-te);Be<=ot&&Be<ke&&(ke=Be,_e={x:nt.x,y:nt.y,id:nt.pointId})}const xt=_t(_e??{x:pe,y:te});return{x:xt.x,y:xt.y,nodeId:_e?.id}})(Y,J),ze=Ce.nodeId??Yi(),oe=li(ze,ut),He=R||(Zt==="top"?Te:C),Ue=y||(Zt==="top"?H:We),E={id:ze,x:Ce.x,y:Ce.y},B={id:`${Date.now()}-pad`,points:[E],color:He,size:Ue,layer:Zt,type:"pad",padType:oe};It(pe=>[...pe,B]);return}if(De==="testPoint"){if(!Xt)return;const Ce=xl?{x:_t({x:Y,y:J}).x,y:_t({x:Y,y:J}).y}:((te,ke)=>{let _e=1/0,Ze=null;const Le=15;for(const xt of $e)if(xt.type==="via"||xt.type==="pad"||xt.type==="testPoint"){const nt=xt.points[0],Be=Math.hypot(nt.x-te,nt.y-ke);Be<=Le&&Be<_e&&(_e=Be,Ze=nt)}for(const xt of Ke)if(xt.pointId!==void 0){const nt=Math.hypot(xt.x-te,xt.y-ke);nt<=Le&&nt<_e&&(_e=nt,Ze={x:xt.x,y:xt.y,id:xt.pointId})}for(const xt of dt)if(xt.pointId!==void 0){const nt=Math.hypot(xt.x-te,xt.y-ke);nt<=Le&&nt<_e&&(_e=nt,Ze={x:xt.x,y:xt.y,id:xt.pointId})}const Xe=_t(Ze??{x:te,y:ke});return{x:Xe.x,y:Xe.y,nodeId:Ze?.id}})(Y,J),ze=Ce.nodeId??Yi(),oe=Ul(ze,ut),He=oe.includes("Power")?"power":oe.includes("Ground")?"ground":oe.includes("Signal")?"signal":"unknown",Ue=_t({x:Ce.x,y:Ce.y}),E=R||(Xt==="top"?it:ce),B=y||(Xt==="top"?Hn:Ni),pe={id:`${Date.now()}-testPoint`,points:[{id:ze,x:Ue.x,y:Ue.y}],color:E,size:B,layer:Xt,type:"testPoint",testPointType:He};It(te=>[...te,pe]);return}if(Vl.current)return;const K=De==="trace"&&!xl?L(Y,J):{x:_t({x:Y,y:J}).x,y:_t({x:Y,y:J}).y},q=K.nodeId!==void 0?{id:K.nodeId,x:K.x,y:K.y}:{x:K.x,y:K.y};hn(xe=>xe.length===0?[q]:[...xe,q]),Cl.current=Date.now(),jl(null),Xi(!1),ri(!1)}else if(U==="erase"){if($e.some(K=>K.layer===ct&&(K.type==="via"&&fi||K.type==="pad"&&Oi||K.type==="testPoint"&&Sa||K.type==="trace"&&pi))){const K=[];fi&&$e.some(q=>q.layer===ct&&q.type==="via")&&K.push("vias"),Oi&&$e.some(q=>q.layer===ct&&q.type==="pad")&&K.push("pads"),Sa&&$e.some(q=>q.layer===ct&&q.type==="testPoint")&&K.push("test points"),pi&&$e.some(q=>q.layer===ct&&q.type==="trace")&&K.push("traces"),K.length>0&&alert(`Cannot erase: ${K.join(", ")} are locked on the ${ct} layer. Unlock them to erase.`)}Xi(!0),hn([{id:Yi(),x:Y,y:J}]),console.log("Starting erase at:",Y,J,"selectedDrawingLayer:",ct,"total strokes:",$e.length)}else if(U==="transform"&&Ht){if(wi){alert("Cannot transform: Images are locked. Unlock images to transform them.");return}Gi(!0),qi({x:Y,y:J})}else if(U==="component"){if(!Ri)return;const L=_t({x:Y,y:J}),K=R||(tn==="top"?Xn:si),q=y||(tn==="top"?bi:vi),xe=[...kt,...gt];let Ce;Aa?Ce=Nd():Ce={...Lo.current};const ze=nx(Ri,tn,L.x,L.y,K,q,xe,Ce,ul);if(ze.abbreviation=_f(Ri),ul&&ze.designator){const oe=Ru(Ri),He=ze.designator.match(new RegExp(`^${oe.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(\\d+)$`));if(He){const Ue=parseInt(He[1],10);if(Aa){const E=Nd();ax(oe,Ue,E)}else Lo.current[oe]=Math.max(Lo.current[oe]||0,Ue)}}tn==="top"?(oo(!0),dn(oe=>[...oe,ze])):(Lt(!0),zn(oe=>[...oe,ze]));return}else if(U==="power"){if(!co)return;const K=xl?{x:_t({x:Y,y:J}).x,y:_t({x:Y,y:J}).y}:((xe,Ce)=>{let ze=1/0,oe=null;const Ue=10/Ve,E=Ve>20?Math.max(Ue,1e-4):Ve>10?Math.max(Ue,.001):Math.max(Ue,.01);for(const te of $e)if(te.type==="via"||te.type==="pad"){const ke=te.points[0],_e=Math.hypot(ke.x-xe,ke.y-Ce);_e<=E&&_e<ze&&(ze=_e,oe=ke)}else if(te.type==="trace")for(const ke of te.points){const _e=Math.hypot(ke.x-xe,ke.y-Ce);_e<=E&&_e<ze&&(ze=_e,oe=ke)}const pe=_t(oe??{x:xe,y:Ce});return{x:pe.x,y:pe.y,nodeId:oe?.id}})(Y,J),q=ut.find(xe=>xe.id===co);if(q){const xe=K.nodeId??Yi(),Ce=`${q.voltage} Power Node`;if(dt.find(He=>He.pointId===xe)){No({visible:!0,title:"Node ID Conflict",message:`Cannot place power node: A ground node already exists at this Node ID (${xe}). Power and ground nodes cannot share the same Node ID.`});return}const oe={id:`power-${Date.now()}-${Math.random()}`,x:K.x,y:K.y,color:"#ff0000",size:y,powerBusId:q.id,layer:ct,type:Ce,pointId:xe};if(Si(He=>[...He,oe]),K.nodeId!==void 0){const He=Ml(K.nodeId,ut),Ue=li(K.nodeId,ut),E=Ul(K.nodeId,ut),B=E.includes("Power")?"power":E.includes("Ground")?"ground":E.includes("Signal")?"signal":"unknown";It(pe=>pe.map(te=>te.type==="via"&&te.points.length>0&&te.points[0].id===K.nodeId?{...te,viaType:He}:te.type==="pad"&&te.points.length>0&&te.points[0].id===K.nodeId?{...te,padType:Ue}:te.type==="testPoint"&&te.points.length>0&&te.points[0].id===K.nodeId?{...te,testPointType:B}:te))}}return}else if(U==="ground"){if(Nl===null){if(Yn.length===0){No({visible:!0,title:"No Ground Bus",message:"No ground buses are defined. Please create a ground bus first using Tools  Manage Ground Buses."});return}uo(!0);return}const L=Yn.find(K=>K.id===Nl);if(L){const q=xl?{x:_t({x:Y,y:J}).x,y:_t({x:Y,y:J}).y}:((He,Ue)=>{let E=1/0,B=null;const te=10/Ve,ke=Ve>20?Math.max(te,1e-4):Ve>10?Math.max(te,.001):Math.max(te,.01);for(const Le of $e)if(Le.type==="via"||Le.type==="pad"){const ot=Le.points[0],Xe=Math.hypot(ot.x-He,ot.y-Ue);Xe<=ke&&Xe<E&&(E=Xe,B=ot)}else if(Le.type==="trace")for(const ot of Le.points){const Xe=Math.hypot(ot.x-He,ot.y-Ue);Xe<=ke&&Xe<E&&(E=Xe,B=ot)}const Ze=_t(B??{x:He,y:Ue});return{x:Ze.x,y:Ze.y,nodeId:B?.id}})(Y,J),xe=q.nodeId??Yi(),Ce=`${L.name} Ground Node`,ze=Ke.find(He=>He.pointId===xe);if(ze){No({visible:!0,title:"Node ID Conflict",message:`Cannot place ground node: A power node (${ze.type||"Power Node"}) already exists at this Node ID (${xe}). Power and ground nodes cannot share the same Node ID.`});return}const oe={id:`gnd-${Date.now()}-${Math.random().toString(36).slice(2,6)}`,x:q.x,y:q.y,color:L.color,size:y||bt.get("ground")?.settings.size||18,groundBusId:L.id,layer:ct,type:Ce,pointId:xe};if(Zi(He=>[...He,oe]),q.nodeId!==void 0){const He=Ml(q.nodeId,ut),Ue=li(q.nodeId,ut);It(E=>E.map(B=>B.type==="via"&&B.points.length>0&&B.points[0].id===q.nodeId?{...B,viaType:He}:B.type==="pad"&&B.points.length>0&&B.points[0].id===q.nodeId?{...B,padType:Ue}:B))}}return}},[U,Ht,y,R,De,ct,$e,Ve,At.x,At.y,xl,co,Nl,ut,Yn,Ri,bt,Zt,Bt,Xt,Ke,dt,Ml,li,Ul,ji,Mn,Zn]),Ma=w.useCallback(a=>{if(U!=="magnify")return;a.preventDefault();const r=Ln.current;if(!r)return;const f=r.getBoundingClientRect(),m=r.width/f.width,x=r.height/f.height,S=a.nativeEvent.offsetX,p=a.nativeEvent.offsetY,v=typeof S=="number"?S:a.clientX-f.left,T=typeof p=="number"?p:a.clientY-f.top,k=v*m,N=T*x,Z=(k-40-At.x)/Ve,re=(N-40-At.y)/Ve,Y=1.2,J=1/Y,L=a.deltaY<0?Y:J,K=Math.max(.25,Math.min(8,Ve*L)),q=k-40-K*Z,xe=N-40-K*re;ll(K),Tn({x:q,y:xe})},[U,Ve,At.x,At.y]),dc=w.useCallback(a=>{if(U==="draw"&&De==="trace"){Vl.current=!0;let q=pt;if(q.length>1){const xe=[q[0]];for(let Ce=1;Ce<q.length;Ce++){const ze=xe[xe.length-1],oe=q[Ce];(Math.abs(ze.x-oe.x)>.001||Math.abs(ze.y-oe.y)>.001)&&xe.push(oe)}q=xe}if(q.length>=1){const xe=Bt||"top",Ce=xe==="top"?"traceTop":"traceBottom",ze=yt.get(Ce),oe={id:`${Date.now()}-trace`,points:q,color:ze.color,size:ze.size,layer:xe,type:"trace"};It(He=>[...He,oe]),xe==="top"?Ya(He=>[...He,oe.id]):Ne(He=>[...He,oe.id]),hn([]),jl(null),setTimeout(()=>{Vl.current=!1},300);return}}const r=Ln.current;if(!r)return;const f=r.getBoundingClientRect(),m=r.width/f.width,x=r.height/f.height,S=a.nativeEvent.offsetX,p=a.nativeEvent.offsetY,v=typeof S=="number"?S:a.clientX-f.left,T=typeof p=="number"?p:a.clientY-f.top,k=v*m,N=T*x,Z=k-40,re=N-40,Y=(Z-At.x)/Ve,J=(re-At.y)/Ve,L=Math.max(8/Ve,4),K=(()=>{for(const q of $e)if(q.type==="testPoint"&&q.points.length>0){const xe=q.points[0],Ce=Math.hypot(xe.x-Y,xe.y-J),ze=(q.size||18)/2;if(Ce<=ze+L)return q}return null})();if(K){Ct(new Set([K.id])),St(new Set),ht(new Set),zt(new Set),$i(!0);return}if(U==="select"||U==="component"){const xe=(()=>{for(const oe of kt)if(Y>=oe.x-10&&Y<=oe.x+10&&J>=oe.y-10&&J<=oe.y+10)return{layer:"top",comp:oe};for(const oe of gt)if(Y>=oe.x-10&&Y<=oe.x+10&&J>=oe.y-10&&J<=oe.y+10)return{layer:"bottom",comp:oe};return null})(),Ce=Math.max(6/Ve,4);let ze=null;for(const oe of Ke){const He=Math.max(6,oe.size/2),Ue=He*.8,E=He+Ue,B=Math.hypot(oe.x-Y,oe.y-J),pe=Math.abs(Y-oe.x)<=Ce&&Math.abs(J-oe.y)<=E,te=Math.abs(J-oe.y)<=Ce&&Math.abs(Y-oe.x)<=E;if(B<=Math.max(He,Ce)||pe||te){ze=oe;break}}if(ze){ht(new Set([ze.id])),ma({visible:!0,id:ze.id,layer:ze.layer,x:ze.x,y:ze.y,size:ze.size,color:ze.color,powerBusId:ze.powerBusId});return}if(xe){const{layer:oe,comp:He}=xe;sr(He,oe)}}},[U,De,R,y,ct,kt,gt,Ke,Ve,At.x,At.y,Ri,hl,xl,$e,Ht,Ki,_u,di,bt,pt,Bt,Re,fe,se,O,$i,Ct,St,ht,zt,sr]),Hs=w.useCallback(()=>{const a=il.current;if(U==="draw"&&De==="trace"&&a.length>=2){let r=[a[0]];for(let p=1;p<a.length;p++){const v=r[r.length-1],T=a[p];(Math.abs(v.x-T.x)>.001||Math.abs(v.y-T.y)>.001)&&r.push(T)}const f=Bt||"top",m=f==="top"?"traceTop":"traceBottom",x=yt.get(m),S={id:`${Date.now()}-trace`,points:r,color:x.color,size:x.size,layer:f,type:"trace"};It(p=>[...p,S]),f==="top"?Ya(p=>[...p,S.id]):Ne(p=>[...p,S.id]),hn([]),jl(null)}else if(U==="draw"&&De==="trace"&&a.length===1){const r=Bt||"top",f=r==="top"?"traceTop":"traceBottom",m=yt.get(f),x={id:`${Date.now()}-trace-dot`,points:a,color:m.color,size:m.size,layer:r,type:"trace"};It(S=>[...S,x]),r==="top"?Ya(S=>[...S,x.id]):Ne(S=>[...S,x.id]),hn([])}},[U,De,Bt,Re,fe,se,O,It]),uc=w.useCallback((a,r,f)=>{const m=r-a.x,x=f-a.y;if(m===0&&x===0)return{x:r,y:f};const p=(Math.atan2(x,m)*180/Math.PI%180+180)%180,v=[0,45,90];let T=0,k=1e9;for(const N of v){const Z=Math.abs(p-N);Z<k&&(k=Z,T=N)}if(T===0)return{x:r,y:a.y};if(T===90)return{x:a.x,y:f};{const N=Math.min(Math.abs(m),Math.abs(x)),Z=m>=0?1:-1,re=x>=0?1:-1;return{x:a.x+Z*N,y:a.y+re*N}}},[]),Fd=w.useCallback(a=>{const r=Ln.current?.getBoundingClientRect();if(!r)return;const f=a.clientX-r.left,m=a.clientY-r.top,x=Ln.current,S=x.width/r.width,p=x.height/r.height,v=f*S,T=m*p,k=v-40,N=T-40,Z=(k-At.x)/Ve,re=(N-At.y)/Ve;if(U==="draw"&&De==="trace"&&pt.length>0){const J=xl?{x:_t({x:Z,y:re}).x,y:_t({x:Z,y:re}).y}:((L,K)=>{let q=1/0,xe=null;const ze=10/Ve,oe=Ve>20?Math.max(ze,1e-4):Ve>10?Math.max(ze,.001):Math.max(ze,.01);for(const E of $e)if(E.type==="via"){const B=E.points[0],pe=Math.hypot(B.x-L,B.y-K);pe<=oe&&pe<q&&(q=pe,xe=B)}else if(E.type==="pad"){const B=E.points[0],pe=Math.hypot(B.x-L,B.y-K);pe<=oe&&pe<q&&(q=pe,xe=B)}for(const E of Ke)if(E.pointId!==void 0){const B=Math.hypot(E.x-L,E.y-K);B<=oe&&B<q&&(q=B,xe={x:E.x,y:E.y,id:E.pointId})}for(const E of dt)if(E.pointId!==void 0){const B=Math.hypot(E.x-L,E.y-K);B<=oe&&B<q&&(q=B,xe={x:E.x,y:E.y,id:E.pointId})}const Ue=_t(xe??{x:L,y:K});return{x:Ue.x,y:Ue.y,nodeId:xe?.id}})(Z,re);jl({x:J.x,y:J.y})}else jl(null);if(_o){const J=(()=>{for(const L of kt)if(Z>=L.x-10&&Z<=L.x+10&&re>=L.y-10&&re<=L.y+10)return{layer:"top",comp:L};for(const L of gt)if(Z>=L.x-10&&Z<=L.x+10&&re>=L.y-10&&re<=L.y+10)return{layer:"bottom",comp:L};return null})();if(J)za({component:J.comp,layer:J.layer,x:a.clientX,y:a.clientY}),ka(null);else{za(null);const L=Math.max(8/Ve,4),K=(()=>{for(const q of $e)if(q.type==="testPoint"&&q.points.length>0){const xe=q.points[0],Ce=Math.hypot(xe.x-Z,xe.y-re),ze=(q.size||18)/2;if(Ce<=ze+L)return q}return null})();ka(K?{stroke:K,x:a.clientX,y:a.clientY}:null)}}else za(null),ka(null);if(U==="select"&&$r&&Vn){const Y=Vn.x,J=Vn.y;Ko({x:Math.min(Y,Z),y:Math.min(J,re),width:Math.abs(Z-Y),height:Math.abs(re-J)})}else if(U==="pan"&&Ki&&lo.current){const{startCX:Y,startCY:J,panX:L,panY:K}=lo.current,q=k-Y,xe=N-J;Tn({x:L+q,y:K+xe})}else if(ga&&pt.length>0){if(U==="draw")if(Fn){const Y=pt[0],J=uc(Y,Z,re),L=_t(J),K={id:Yi(),x:L.x,y:L.y};hn([Y,K])}else{const Y=_t({x:Z,y:re});hn(J=>[...J,{id:Yi(),x:Y.x,y:Y.y}])}else if(U==="erase"&&(hn(Y=>[...Y,{id:Yi(),x:Z,y:re}]),It(Y=>{const J=Y.filter(K=>{if(K.type==="via"&&fi||K.type==="pad"&&Oi||K.type==="testPoint"&&Sa||K.type==="trace"&&pi||K.layer!==ct)return!0;const q=y/2,xe=Z-q,Ce=Z+q,ze=re-q,oe=re+q,He=(B,pe)=>B>=xe&&B<=Ce&&pe>=ze&&pe<=oe,Ue=(B,pe,te,ke)=>{const xt=(Sn,ft)=>{let vt=0;return Sn<xe?vt|=1:Sn>Ce&&(vt|=2),ft<ze?vt|=4:ft>oe&&(vt|=8),vt};let nt=B,Be=pe,Je=te,Yt=ke,Qt=xt(nt,Be),Kt=xt(Je,Yt);for(;;){if((Qt|Kt)===0)return!0;if((Qt&Kt)!==0)return!1;const Sn=Qt!==0?Qt:Kt;let ft=0,vt=0;Sn&8?(ft=nt+(Je-nt)*(oe-Be)/(Yt-Be),vt=oe):Sn&4?(ft=nt+(Je-nt)*(ze-Be)/(Yt-Be),vt=ze):Sn&2?(vt=Be+(Yt-Be)*(Ce-nt)/(Je-nt),ft=Ce):(vt=Be+(Yt-Be)*(xe-nt)/(Je-nt),ft=xe),Sn===Qt?(nt=ft,Be=vt,Qt=xt(nt,Be)):(Je=ft,Yt=vt,Kt=xt(Je,Yt))}};let E=!1;if(K.points.length===1){const B=K.points[0];E=He(B.x,B.y)}else for(let B=0;B<K.points.length-1;B++){const pe=K.points[B],te=K.points[B+1];if(Ue(pe.x,pe.y,te.x,te.y)){E=!0;break}}return E&&console.log("Erasing stroke at position:",Z,re,"brushSize:",y,"selectedLayer:",ct),!E});console.log("Strokes before:",Y.length,"after:",J.length);const L=new Set(J.map(K=>K.id));return xs(K=>K.filter(q=>L.has(q))),zo(K=>K.filter(q=>L.has(q))),Ya(K=>K.filter(q=>L.has(q))),Ne(K=>K.filter(q=>L.has(q))),J}),Dn||Si(Y=>{const J=y/2,L=Z-J,K=Z+J,q=re-J,xe=re+J,Ce=ze=>{const oe=ze.size/2,He=ze.x-oe,Ue=ze.x+oe,E=ze.y-oe,B=ze.y+oe;return!(K<He||L>Ue||xe<E||q>B)};return Y.filter(ze=>!Ce(ze))}),Hi||Zi(Y=>{const J=y/2,L=Z-J,K=Z+J,q=re-J,xe=re+J,Ce=oe=>{const He=Math.max(6,(oe.size||18)/2),Ue=He*.8,E=He+Ue,B=oe.x-E,pe=oe.x+E,te=oe.y-E,ke=oe.y+E;return!(K<B||L>pe||xe<te||q>ke)};return Y.filter(oe=>!Ce(oe))}),!_i)){const Y=y/2,J=Z-Y,L=Z+Y,K=re-Y,q=re+Y,xe=Ce=>{const oe=(Ce.size||18)/2,He=Ce.x-oe,Ue=Ce.x+oe,E=Ce.y-oe,B=Ce.y+oe;return!(L<He||J>Ue||q<E||K>B)};dn(Ce=>Ce.filter(ze=>!xe(ze))),zn(Ce=>Ce.filter(ze=>!xe(ze)))}}else if(Va&&ps&&Ht){if(wi){Gi(!1),qi(null);return}const Y=Z-ps.x,J=re-ps.y;if(Ht==="top"){b&&d(L=>L?{...L,x:L.x+Y,y:L.y+J}:null),qi({x:Z,y:re});return}if(Ht==="bottom"){D&&$(L=>L?{...L,x:L.x+Y,y:L.y+J}:null),qi({x:Z,y:re});return}if(Ht==="both"){b&&d(L=>L?{...L,x:L.x+Y,y:L.y+J}:null),D&&$(L=>L?{...L,x:L.x+Y,y:L.y+J}:null),qi({x:Z,y:re});return}}},[ga,pt,U,y,Va,ps,Ht,b,D,Fn,uc,ct,It,Ve,At.x,At.y,$r,Vn,wi,fi,Oi,pi,Dn,Hi,kt,gt,dn,zn,_o,za,xl,$e,Ke,dt,pt,De,Rn,jl,Ki,lo,Tn,40,At,Yi,_t,G,rl]),Kc=w.useCallback(()=>{if(U==="select"&&$r){const a=Bl,r=Vn;if(Ro(!1),Un(null),Ko(null),a&&r){const x=Math.max(3,5/Ve),S=a.width<x&&a.height<x,p=(E,B)=>{const pe=a.x,te=a.y,ke=a.x+a.width,_e=a.y+a.height;return E>=pe&&E<=ke&&B>=te&&B<=_e},v=(E,B,pe,te,ke,_e,Ze,Le)=>{const Je=(Oa,da)=>{let xi=0;return Oa<ke?xi|=1:Oa>Ze&&(xi|=2),da<_e?xi|=4:da>Le&&(xi|=8),xi};let Yt=E,Qt=B,Kt=pe,Sn=te,ft=Je(Yt,Qt),vt=Je(Kt,Sn);for(;;){if((ft|vt)===0)return!0;if((ft&vt)!==0)return!1;const Oa=ft!==0?ft:vt;let da=0,xi=0;Oa&8?(da=Yt+(Kt-Yt)*(Le-Qt)/(Sn-Qt),xi=Le):Oa&4?(da=Yt+(Kt-Yt)*(_e-Qt)/(Sn-Qt),xi=_e):Oa&2?(xi=Qt+(Sn-Qt)*(Ze-Yt)/(Kt-Yt),da=Ze):(xi=Qt+(Sn-Qt)*(ke-Yt)/(Kt-Yt),da=ke),Oa===ft?(Yt=da,Qt=xi,ft=Je(Yt,Qt)):(Kt=da,Sn=xi,vt=Je(Kt,Sn))}},T=a.x,k=a.y,N=a.x+a.width,Z=a.y+a.height,Y=Math.max(6/Ve,4/Ve,.5),J=(E,B,pe,te,ke,_e)=>{const Ze=ke-pe,Le=_e-te;if(Ze===0&&Le===0)return Math.hypot(E-pe,B-te);const ot=Math.max(0,Math.min(1,((E-pe)*Ze+(B-te)*Le)/(Ze*Ze+Le*Le))),Xe=pe+ot*Ze,xt=te+ot*Le;return Math.hypot(E-Xe,B-xt)},L=r?.shiftKey===!0,K=new Set(L?Array.from(jt):[]),q=new Set(L?Array.from(at):[]),xe=new Set(L?Array.from(Ut):[]),Ce=new Set(L?Array.from(Nt):[]),ze=r?.hitStrokeId;if(ze){const E=$e.find(B=>B.id===ze);if(E){let B=!1;if(E.type==="via"||E.type==="pad"?B=ji:B=E.layer==="top"?ti:Ci,B){L?Ct(pe=>{const te=new Set(pe);return te.has(ze)?te.delete(ze):te.add(ze),te}):(Ct(new Set([ze])),St(new Set),ht(new Set),zt(new Set));return}}}if(S){let E=null;for(const B of $e){let pe=!1;if(B.type==="via"?pe=ji:B.type==="pad"?pe=(B.layer||"top")==="top"?Mn:Zn:B.type==="testPoint"?pe=(B.layer||"top")==="top"?ii:Ra:B.type==="trace"?pe=B.layer==="top"?ti:Ci:pe=!1,!pe)continue;let te=1/0;if(B.type==="via"||B.type==="pad"||B.type==="testPoint"){const ke=B.points[0],_e=Math.max(1,B.size/2);te=Math.hypot(ke.x-r.x,ke.y-r.y);const Le=Math.max(6/Ve,4/Ve,.5);te<=Math.max(_e,Le)&&(!E||te<E.dist)&&(E={id:B.id,dist:te})}else for(let ke=0;ke<B.points.length-1;ke++){const _e=B.points[ke],Ze=B.points[ke+1],Le=J(r.x,r.y,_e.x,_e.y,Ze.x,Ze.y);if(Le<=Math.max(Y,B.size/2)){(!E||Le<E.dist)&&(E={id:B.id,dist:Le});break}}}E&&(L&&K.has(E.id)?K.delete(E.id):K.add(E.id))}else for(const E of $e){let B=!1;if(E.type==="via"?B=ji:E.type==="pad"?B=(E.layer||"top")==="top"?Mn:Zn:E.type==="testPoint"?B=(E.layer||"top")==="top"?ii:Ra:E.type==="trace"?B=E.layer==="top"?ti:Ci:B=!1,!B)continue;let pe=!1;if(E.type==="via"||E.type==="pad"||E.type==="testPoint"){const te=E.points[0];pe=p(te.x,te.y)}else for(let te=0;te<E.points.length-1;te++){const ke=E.points[te],_e=E.points[te+1];if(v(ke.x,ke.y,_e.x,_e.y,T,k,N,Z)||p(ke.x,ke.y)&&p(_e.x,_e.y)){pe=!0;break}}pe&&(L&&K.has(E.id)?K.delete(E.id):K.add(E.id))}const oe=E=>{const pe=Math.max(10,E.size||18)/2;return E.x-pe<=N&&E.x+pe>=T&&E.y-pe<=Z&&E.y+pe>=k};if(S){const E=B=>{const te=Math.max(10,B.size||18)/2;return r.x>=B.x-te&&r.x<=B.x+te&&r.y>=B.y-te&&r.y<=B.y+te};dl&&kt.forEach(B=>{E(B)&&(L&&q.has(B.id)?q.delete(B.id):q.add(B.id))}),un&&gt.forEach(B=>{E(B)&&(L&&q.has(B.id)?q.delete(B.id):q.add(B.id))})}else dl&&kt.forEach(E=>{oe(E)&&(L&&q.has(E.id)?q.delete(E.id):q.add(E.id))}),un&&gt.forEach(E=>{oe(E)&&(L&&q.has(E.id)?q.delete(E.id):q.add(E.id))});const He=E=>{const B=Math.max(6,E.size/2),pe=B*.8,te=B+pe;return E.x-te<=N&&E.x+te>=T&&E.y-te<=Z&&E.y+te>=k};if(wt)if(S){let E=null;for(const B of Ke){const pe=Math.max(6,B.size/2),te=pe*.8,ke=pe+te,_e=Math.hypot(B.x-r.x,B.y-r.y),Ze=Math.abs(r.x-B.x)<=Y&&Math.abs(r.y-B.y)<=ke,Le=Math.abs(r.y-B.y)<=Y&&Math.abs(r.x-B.x)<=ke;if(_e<=Math.max(pe,Y)||Ze||Le){const Xe=Math.min(_e,Math.abs(r.x-B.x)+Math.abs(r.y-B.y));(!E||Xe<E.dist)&&(E={id:B.id,dist:Xe})}}E&&(L&&xe.has(E.id)?xe.delete(E.id):xe.add(E.id))}else Ke.forEach(E=>{He(E)&&(L&&xe.has(E.id)?xe.delete(E.id):xe.add(E.id))});const Ue=E=>{const B=Math.max(6,(E.size||18)/2),pe=B*.8,te=B+pe;return E.x-te<=N&&E.x+te>=T&&E.y-te<=Z&&E.y+te>=k};if(an)if(S){let E=null;for(const B of dt){const pe=Math.max(6,(B.size||18)/2),te=pe*.8,ke=pe+te,_e=Math.hypot(B.x-r.x,B.y-r.y),Ze=Math.abs(r.x-B.x)<=Y&&Math.abs(r.y-B.y)<=ke,Le=Math.abs(r.y-B.y)<=Y&&Math.abs(r.x-B.x)<=ke;if(_e<=Math.max(pe,Y)||Ze||Le){const Xe=Math.min(_e,Math.abs(r.x-B.x)+Math.abs(r.y-B.y));(!E||Xe<E.dist)&&(E={id:B.id,dist:Xe})}}E&&(L&&Ce.has(E.id)?Ce.delete(E.id):Ce.add(E.id))}else dt.forEach(E=>{Ue(E)&&(L&&Ce.has(E.id)?Ce.delete(E.id):Ce.add(E.id))});Ct(K),St(q),ht(xe),zt(Ce)}}if(ga&&pt.length>0){if(U==="draw"&&De!=="trace"){const a={id:Date.now().toString(),points:pt,color:R,size:y,layer:ct,type:"trace"};It(r=>[...r,a]),ct==="top"?Ya(r=>[...r,a.id]):Ne(r=>[...r,a.id])}hn([])}Ki&&(ks(!1),lo.current=null,Po.current=null),Xi(!1),Gi(!1),qi(null),ri(!1)},[ga,pt,U,R,y,ct,Bl,Vn,$r,$e,Ve,fr,jt,Ke,dt,kt,gt,at,Ut,Nt,ji,ti,Ci,dl,un,wt,an]);Pe.useEffect(()=>{if(!(U==="pan"&&Ki&&Po.current))return;const a=f=>{const m=Ln.current;if(!m)return;const x=m.getBoundingClientRect(),S=m.width/x.width,p=m.height/x.height,{startClientX:v,startClientY:T,panX:k,panY:N}=Po.current,Z=(f.clientX-v)*S,re=(f.clientY-T)*p;Tn({x:k+Z,y:N+re})},r=()=>{ks(!1),lo.current=null,Po.current=null,window.removeEventListener("mousemove",a,!0),window.removeEventListener("mouseup",r,!0)};return window.addEventListener("mousemove",a,!0),window.addEventListener("mouseup",r,!0),()=>{window.removeEventListener("mousemove",a,!0),window.removeEventListener("mouseup",r,!0)}},[U,Ki]);const Es=w.useCallback(()=>{const a=Ln.current;if(!a)return;const r=a.getContext("2d");if(!r)return;r.clearRect(0,0,a.width,a.height),r.save(),r.beginPath(),r.rect(40,40,a.width-80,a.height-80),r.clip(),r.translate(40,40);const f=(S,p)=>{const v=S.width,T=S.height,k=document.createElement("canvas");k.width=v,k.height=T;const N=k.getContext("2d");if(!N)return k;N.drawImage(S,0,0,v,T);const re=N.getImageData(0,0,v,T).data,Y=new Uint8ClampedArray(v*T);for(let oe=0;oe<v*T;oe++){const He=re[oe*4+0],Ue=re[oe*4+1],E=re[oe*4+2];Y[oe]=Math.round(.299*He+.587*Ue+.114*E)}const J=[-1,0,1,-2,0,2,-1,0,1],L=[-1,-2,-1,0,0,0,1,2,1],K=new Float32Array(v*T);for(let oe=1;oe<T-1;oe++)for(let He=1;He<v-1;He++){let Ue=0,E=0,B=0;for(let te=-1;te<=1;te++)for(let ke=-1;ke<=1;ke++){const _e=He+ke,Ze=oe+te,Le=Y[Ze*v+_e];Ue+=Le*J[B],E+=Le*L[B],B++}const pe=Math.sqrt(Ue*Ue+E*E);K[oe*v+He]=pe}let q=0;for(let oe=0;oe<K.length;oe++)K[oe]>q&&(q=K[oe]);const xe=N.createImageData(v,T),Ce=xe.data,ze=.2;for(let oe=0;oe<v*T;oe++){const Ue=(q>0?K[oe]/q:0)>=ze?255:0,E=p?255-Ue:Ue;Ce[oe*4+0]=E,Ce[oe*4+1]=E,Ce[oe*4+2]=E,Ce[oe*4+3]=255}return N.putImageData(xe,0,0),k},m=(S,p,v,T,k,N,Z,re)=>{const Y=document.createElement("canvas");Y.width=v,Y.height=T;const J=Y.getContext("2d",{willReadFrequently:!0});J.clearRect(0,0,v,T),J.drawImage(p,0,0,v,T);let L=Y;if(Math.abs(k)>1e-6){const K=Math.tan(k),q=Math.max(.2,1-K),xe=Math.max(.2,1+K),Ce=Math.max(q,xe),ze=Math.max(1,Math.ceil(v*Ce)),oe=document.createElement("canvas");oe.width=ze,oe.height=T;const He=oe.getContext("2d",{willReadFrequently:!0});He.clearRect(0,0,ze,T);for(let Ue=0;Ue<T;Ue++){const E=T<=1?0:Ue/(T-1),B=q*(1-E)+xe*E,pe=Math.max(1,v*B),te=(ze-pe)/2;He.drawImage(L,0,Ue,v,1,te,Ue,pe,1)}L=oe}if(Math.abs(N)>1e-6){const K=Math.tan(N),q=Math.max(.2,1-K),xe=Math.max(.2,1+K),Ce=Math.max(q,xe),ze=Math.max(1,Math.ceil(T*Ce)),oe=document.createElement("canvas");oe.width=L.width,oe.height=ze;const He=oe.getContext("2d",{willReadFrequently:!0});He.clearRect(0,0,oe.width,ze);for(let Ue=0;Ue<L.width;Ue++){const E=L.width<=1?0:Ue/(L.width-1),B=q*(1-E)+xe*E,pe=Math.max(1,T*B),te=(ze-pe)/2;He.drawImage(L,Ue,0,1,L.height,Ue,te,1,pe)}L=oe}S.drawImage(L,-Z/2,-re/2,Z,re)};r.translate(At.x,At.y),r.scale(Ve,Ve);{const S=Kl&&br;if(b&&b.bitmap&&Kl){const p=b.bitmap;r.save(),r.globalAlpha=1;const v=[];if(b.brightness!==void 0&&b.brightness!==100&&v.push(`brightness(${b.brightness}%)`),b.contrast!==void 0&&b.contrast!==100&&v.push(`contrast(${b.contrast}%)`),le&&!Ie&&v.push("grayscale(100%)"),r.filter=v.length>0?v.join(" "):"none",r.translate(b.x,b.y),r.rotate(b.rotation*Math.PI/180),b.skewX||b.skewY){const Z=Math.tan(b.skewX||0),re=Math.tan(b.skewY||0);r.transform(1,re,Z,1,0,0)}r.scale(b.scale*(b.flipX?-1:1),b.scale*(b.flipY?-1:1));const T=p.width*1,k=p.height*1,N=Ie?f(p,Fe):p;b.keystoneV&&Math.abs(b.keystoneV)>1e-6||b.keystoneH&&Math.abs(b.keystoneH)>1e-6?m(r,N,p.width,p.height,b.keystoneV||0,b.keystoneH||0,T,k):r.drawImage(N,-T/2,-k/2,T,k),r.restore()}if(D&&D.bitmap&&br){const p=D.bitmap;r.save(),r.globalAlpha=S?g/100:1;const v=[];if(D.brightness!==void 0&&D.brightness!==100&&v.push(`brightness(${D.brightness}%)`),D.contrast!==void 0&&D.contrast!==100&&v.push(`contrast(${D.contrast}%)`),le&&!Ie&&v.push("grayscale(100%)"),r.filter=v.length>0?v.join(" "):"none",r.translate(D.x,D.y),r.rotate(D.rotation*Math.PI/180),D.skewX||D.skewY){const Z=Math.tan(D.skewX||0),re=Math.tan(D.skewY||0);r.transform(1,re,Z,1,0,0)}r.scale(D.scale*(D.flipX?-1:1),D.scale*(D.flipY?-1:1));const T=p.width*1,k=p.height*1,N=Ie?f(p,Fe):p;D.keystoneV&&Math.abs(D.keystoneV)>1e-6||D.keystoneH&&Math.abs(D.keystoneH)>1e-6?m(r,N,p.width,p.height,D.keystoneV||0,D.keystoneH||0,T,k):r.drawImage(N,-T/2,-k/2,T,k),r.restore()}}if($d(r),wt&&Ke.length>0){const S=p=>{r.save();const v=ut.find(re=>re.id===p.powerBusId),T=Ut.has(p.id),k="#ff0000";r.strokeStyle=k,r.lineWidth=Math.max(1,(T?3:2)/Math.max(Ve,.001)),r.lineCap="round";const N=Math.max(6,p.size/2),Z=N*.8;T&&(r.strokeStyle="#0066ff",r.lineWidth=Math.max(1,4/Math.max(Ve,.001)),r.beginPath(),r.arc(p.x,p.y,N+Z+3,0,Math.PI*2),r.stroke()),r.strokeStyle=k,r.lineWidth=Math.max(1,(T?3:2)/Math.max(Ve,.001)),r.beginPath(),r.arc(p.x,p.y,N,0,Math.PI*2),r.stroke(),r.beginPath(),r.moveTo(p.x,p.y-N-Z),r.lineTo(p.x,p.y+N+Z),r.stroke(),r.beginPath(),r.moveTo(p.x-N-Z,p.y),r.lineTo(p.x+N+Z,p.y),r.stroke(),v&&(r.fillStyle=k,r.font=`${Math.max(10,N*.8)}px sans-serif`,r.textAlign="center",r.textBaseline="middle",r.fillText(v.voltage,p.x,p.y+N+Z+12)),r.restore()};Ke.forEach(S)}if(an&&dt.length>0){const S=p=>{r.save();const v=Nt.has(p.id),T=p.color||"#000000";if(p.groundBusId==="groundbus-earth"){const N=Math.max(6,p.size||18),Z=N*.9,re=N*.24,Y=N*1.6;r.strokeStyle=T,r.lineWidth=Math.max(1,(v?3:2)/Math.max(Ve,.001)),r.lineCap="round",v&&(r.strokeStyle="#0066ff",r.lineWidth=Math.max(1,4/Math.max(Ve,.001)),r.setLineDash([5,5]),r.strokeRect(p.x-Y/2-3,p.y-3,Y+6,Z+re*2+6),r.setLineDash([])),r.strokeStyle=T,r.lineWidth=Math.max(1,(v?3:2)/Math.max(Ve,.001)),r.beginPath(),r.moveTo(p.x,p.y),r.lineTo(p.x,p.y+Z),r.stroke();for(let J=0;J<3;J++){const L=p.y+Z+J*re,K=Y*(1-J*.25);r.beginPath(),r.moveTo(p.x-K/2,L),r.lineTo(p.x+K/2,L),r.stroke()}}else{const N=Math.max(6,(p.size||18)/2),Z=N*.8;v&&(r.strokeStyle="#0066ff",r.lineWidth=Math.max(1,4/Math.max(Ve,.001)),r.beginPath(),r.arc(p.x,p.y,N+Z+3,0,Math.PI*2),r.stroke()),r.strokeStyle=T,r.lineWidth=Math.max(1,(v?3:2)/Math.max(Ve,.001)),r.beginPath(),r.arc(p.x,p.y,N,0,Math.PI*2),r.stroke(),r.beginPath(),r.moveTo(p.x,p.y-N-Z),r.lineTo(p.x,p.y+N+Z),r.stroke(),r.beginPath(),r.moveTo(p.x-N-Z,p.y),r.lineTo(p.x+N+Z,p.y),r.stroke()}r.restore()};dt.forEach(S)}const x=S=>{const p=Math.max(10,S.size||18),v=p/2;r.save(),r.strokeStyle=S.color||"#111",r.lineWidth=Math.max(1,2/Math.max(Ve,.001));const T=S.pinConnections||[],k=T.length>0&&T.length===S.pinCount&&T.every(re=>re&&re.trim()!=="");r.fillStyle=k?"rgba(178, 223, 138, 0.85)":"rgba(255,255,255,0.85)",r.beginPath(),r.rect(S.x-v,S.y-v,p,p),r.fill(),r.stroke();const N=S.designator?.trim()||"";if(N){r.fillStyle=S.color||"#111";const re=Math.max(6,p*.35),Y=p*.9;let J=re;r.font=`bold ${J}px sans-serif`;const L=r.measureText(N);L.width>Y&&(J=Y/L.width*J,J=Math.max(6,J),r.font=`bold ${J}px sans-serif`),r.textAlign="center",r.textBaseline="middle",r.fillText(N,S.x,S.y)}at.has(S.id)&&(r.setLineDash([4,3]),r.strokeStyle="#00bfff",r.lineWidth=1.5,r.strokeRect(S.x-v-3,S.y-v-3,p+6,p+6),r.setLineDash([])),r.restore()};if(la){const S=v=>{const T=parseInt(v,10);if(isNaN(T))return null;for(const k of $e)if((k.type==="via"||k.type==="pad"||k.type==="testPoint")&&k.points.length>0){const N=k.points[0];if(N.id===T)return{x:N.x,y:N.y}}for(const k of $e)if(k.type==="trace"){for(const N of k.points)if(N.id===T)return{x:N.x,y:N.y}}for(const k of Ke)if(k.pointId===T)return{x:k.x,y:k.y};for(const k of dt)if(k.pointId===T)return{x:k.x,y:k.y};return null},p=v=>{const T=v.pinConnections||[],k=v.componentType==="Electrolytic Capacitor"||v.componentType==="Diode"||v.componentType==="Battery"||v.componentType==="ZenerDiode",N=v.componentType==="Capacitor"&&"dielectric"in v&&v.dielectric==="Tantalum",Z=(k||N)&&v.pinPolarities,re=new Map;for(let Y=0;Y<T.length;Y++){const J=T[Y];if(J&&J.trim()!==""){const L=J.trim(),K=!!(Z&&v.pinPolarities&&Y<v.pinPolarities.length&&v.pinPolarities[Y]==="-"),q=re.get(L);q!==void 0?re.set(L,q||K):re.set(L,K)}}for(const[Y,J]of re){const L=S(Y);if(L){const K={x:v.x,y:v.y};r.save(),r.strokeStyle=J?"rgba(0, 0, 0, 0.8)":us,r.lineWidth=Math.max(1,fs/Math.max(Ve,.001)),r.beginPath(),r.moveTo(K.x,K.y),r.lineTo(L.x,L.y),r.stroke(),r.restore()}}};dl&&kt.forEach(p),un&&gt.forEach(p)}if(dl&&kt.forEach(x),un&&gt.forEach(x),U==="select"&&Bl){r.save();const S=Math.max(2,6/Math.max(1e-4,Ve));r.strokeStyle="#00bfff",r.fillStyle="rgba(0, 191, 255, 0.15)",r.lineWidth=Math.max(1,1.5/Math.max(1e-4,Ve)),r.setLineDash([S,S]),r.beginPath(),r.rect(Bl.x,Bl.y,Bl.width,Bl.height),r.fill(),r.stroke(),r.setLineDash([]),r.restore()}r.restore()},[b,D,g,$e,pt,ga,U,R,y,le,Ie,Fe,Ht,ct,Ve,At.x,At.y,Kl,br,ji,ti,Ci,Mn,Zn,ii,Ra,dl,un,kt,gt,wt,Ke,an,dt,la,Bl,jt,at,Ut,Nt,Bt,Re,fe,se,O,De,Rn,wi,us,fs]);Pe.useEffect(()=>{const a=()=>{const r=Ca.current;if(!r)return;const f=1.6,m=244,x=12,S=12,p=r.clientWidth-m-x,v=r.clientHeight-S,T=Math.floor(v*f),k=Math.floor(p/f);let N,Z;T<=p?(N=T,Z=v):(N=p,Z=k),N=Math.max(600,N),Z=Math.max(375,Z),Eo(re=>{if(re.width!==N||re.height!==Z){const Y=re.width-80,J=re.height-80,L=N-80,K=Z-80,q=Y>0?L/Y:1,xe=J>0?K/J:1;Tn(Ce=>({x:Ce.x*q,y:Ce.y*xe}))}return re.width===N&&re.height===Z?re:{width:N,height:Z}})};return a(),window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[Tn]),Pe.useEffect(()=>{wi&&(Va&&(Gi(!1),qi(null)),xa(null))},[wi,Va,Gi,qi,xa]);const $d=w.useCallback(a=>{if($e.forEach(r=>{if(r.type==="via"||r.type==="pad"||r.type==="testPoint"||r.testPointType!==void 0||r.type!=="trace")return;let f=!1;if(r.layer==="top"?f=ti:r.layer==="bottom"&&(f=Ci),!!f)if(r.points.length===1){const m=r.points[0],x=Math.max(.5,r.size/2);jt.has(r.id)&&(a.strokeStyle="#00bfff",a.lineWidth=2,a.setLineDash([4,3]),a.beginPath(),a.arc(m.x,m.y,x+3,0,Math.PI*2),a.stroke(),a.setLineDash([])),a.fillStyle=r.color,a.beginPath(),a.arc(m.x,m.y,x,0,Math.PI*2),a.fill()}else{jt.has(r.id)&&(a.strokeStyle="#00bfff",a.lineWidth=r.size+4,a.lineCap="round",a.lineJoin="round",a.globalAlpha=.6,a.beginPath(),r.points.forEach((m,x)=>{x===0?a.moveTo(m.x,m.y):a.lineTo(m.x,m.y)}),a.stroke(),a.globalAlpha=1),a.strokeStyle=r.color,a.lineWidth=r.size,a.lineCap="round",a.lineJoin="round",a.globalAlpha=1,a.beginPath(),r.points.forEach((m,x)=>{x===0?a.moveTo(m.x,m.y):a.lineTo(m.x,m.y)}),a.stroke();for(const m of r.points)a.beginPath(),a.arc(m.x,m.y,r.size/2,0,Math.PI*2),a.fill()}}),$e.forEach(r=>{if(r.type==="via"){if(!ji)return}else if(r.type==="pad"){const m=r.layer||"top";if(m==="top"&&!Mn||m==="bottom"&&!Zn)return}else if(r.type==="testPoint"){const m=r.layer||"top";if(m==="top"&&!ii||m==="bottom"&&!Ra)return}else return;const f=r.points[0];if(jt.has(r.id)){if(r.type==="via"){const m=Math.max(.5,r.size/2)+3;a.strokeStyle="#00bfff",a.lineWidth=2,a.setLineDash([4,3]),a.beginPath(),a.arc(f.x,f.y,m,0,Math.PI*2),a.stroke(),a.setLineDash([])}else if(r.type==="pad"){const m=Math.max(.5,r.size/2)+3;a.strokeStyle="#00bfff",a.lineWidth=2,a.setLineDash([4,3]),a.strokeRect(f.x-m,f.y-m,r.size+6,r.size+6),a.setLineDash([])}else if(r.type==="testPoint"){const m=Math.max(.5,r.size/2)+3;a.strokeStyle="#00bfff",a.lineWidth=2,a.setLineDash([4,3]),a.beginPath(),a.moveTo(f.x,f.y-m),a.lineTo(f.x+m,f.y),a.lineTo(f.x,f.y+m),a.lineTo(f.x-m,f.y),a.closePath(),a.stroke(),a.setLineDash([])}}if(r.type==="via"){const m=Math.max(.5,r.size/2),x=m*.5,S=m*.7;a.fillStyle=r.color,a.beginPath(),a.arc(f.x,f.y,m,0,Math.PI*2),a.arc(f.x,f.y,x,0,Math.PI*2),a.fill("evenodd"),a.strokeStyle="#808080",a.lineWidth=1,a.beginPath(),a.moveTo(f.x-S,f.y),a.lineTo(f.x+S,f.y),a.stroke(),a.beginPath(),a.moveTo(f.x,f.y-S),a.lineTo(f.x,f.y+S),a.stroke()}else if(r.type==="pad"){const m=Math.max(.5,r.size/2),x=r.size,S=x*.5,p=m*.7;a.fillStyle=r.color,a.beginPath(),a.rect(f.x-m,f.y-m,x,x),a.rect(f.x-S/2,f.y-S/2,S,S),a.fill("evenodd"),a.strokeStyle="#808080",a.lineWidth=1,a.beginPath(),a.moveTo(f.x-p,f.y),a.lineTo(f.x+p,f.y),a.stroke(),a.beginPath(),a.moveTo(f.x,f.y-p),a.lineTo(f.x,f.y+p),a.stroke()}else if(r.type==="testPoint"){const m=Math.max(.5,r.size/2),x=m*.7;a.fillStyle=r.color||"#FFFF00",a.strokeStyle="#000000",a.lineWidth=2,a.beginPath(),a.moveTo(f.x,f.y-m),a.lineTo(f.x+m,f.y),a.lineTo(f.x,f.y+m),a.lineTo(f.x-m,f.y),a.closePath(),a.fill(),a.stroke(),a.strokeStyle="#808080",a.lineWidth=1,a.beginPath(),a.moveTo(f.x-x,f.y),a.lineTo(f.x+x,f.y),a.stroke(),a.beginPath(),a.moveTo(f.x,f.y-x),a.lineTo(f.x,f.y+x),a.stroke()}}),pt.length>0){const r=ct;let f=!0;if(U==="draw"&&(De==="via"?f=ji:f=r==="top"?ti:Ci),f)if(U==="draw")if(De==="via"){const m=pt[pt.length-1],x=Math.max(.5,y/2),S=x*.5,p=x*.7;a.fillStyle=R,a.beginPath(),a.arc(m.x,m.y,x,0,Math.PI*2),a.arc(m.x,m.y,S,0,Math.PI*2),a.fill("evenodd"),a.strokeStyle="#808080",a.lineWidth=1,a.beginPath(),a.moveTo(m.x-p,m.y),a.lineTo(m.x+p,m.y),a.stroke(),a.beginPath(),a.moveTo(m.x,m.y-p),a.lineTo(m.x,m.y+p),a.stroke()}else if(De==="pad"){const m=pt[pt.length-1],x=Math.max(.5,y/2),S=y,p=S*.5,v=x*.7;a.fillStyle=R,a.beginPath(),a.rect(m.x-x,m.y-x,S,S),a.rect(m.x-p/2,m.y-p/2,p,p),a.fill("evenodd"),a.strokeStyle="#808080",a.lineWidth=1,a.beginPath(),a.moveTo(m.x-v,m.y),a.lineTo(m.x+v,m.y),a.stroke(),a.beginPath(),a.moveTo(m.x,m.y-v),a.lineTo(m.x,m.y+v),a.stroke()}else if(De==="testPoint"){const m=pt[pt.length-1],x=Math.max(.5,y/2),S=x*.7;a.fillStyle=R,a.beginPath(),a.moveTo(m.x,m.y-x),a.lineTo(m.x+x,m.y),a.lineTo(m.x,m.y+x),a.lineTo(m.x-x,m.y),a.closePath(),a.fill(),a.strokeStyle="#808080",a.lineWidth=1,a.beginPath(),a.moveTo(m.x-S,m.y),a.lineTo(m.x+S,m.y),a.stroke(),a.beginPath(),a.moveTo(m.x,m.y-S),a.lineTo(m.x,m.y+S),a.stroke()}else{const m=Bt||"top",x=m==="top"?Re:fe,S=m==="top"?se:O;if(pt.length===1){const p=pt[0],v=Math.max(.5,S/2);a.fillStyle=x,a.beginPath(),a.arc(p.x,p.y,v,0,Math.PI*2),a.fill(),Rn&&(a.strokeStyle=x,a.lineWidth=S,a.lineCap="round",a.lineJoin="round",a.globalAlpha=.6,a.beginPath(),a.moveTo(p.x,p.y),a.lineTo(Rn.x,Rn.y),a.stroke(),a.globalAlpha=1)}else if(a.strokeStyle=x,a.lineWidth=S,a.lineCap="round",a.lineJoin="round",a.globalAlpha=1,a.beginPath(),pt.forEach((p,v)=>{v===0?a.moveTo(p.x,p.y):a.lineTo(p.x,p.y)}),a.stroke(),Rn&&pt.length>0){const p=pt[pt.length-1];a.globalAlpha=.6,a.beginPath(),a.moveTo(p.x,p.y),a.lineTo(Rn.x,Rn.y),a.stroke(),a.globalAlpha=1}}else U==="erase"&&(a.strokeStyle="rgba(255, 0, 0, 0.5)",a.lineWidth=y,a.lineCap="round",a.lineJoin="round",a.globalAlpha=.5,a.beginPath(),pt.forEach((m,x)=>{x===0?a.moveTo(m.x,m.y):a.lineTo(m.x,m.y)}),a.stroke())}},[$e,jt,ti,Ci,ji,Mn,Zn,ii,Ra,pt,U,De,R,y,ct,Bt,Re,fe,se,O,Rn]),fc=w.useCallback((a,r)=>{if(wi){alert("Cannot transform: Images are locked. Unlock images to transform them.");return}a==="top"&&b?d(f=>f?{...f,...r}:null):a==="bottom"&&D?$(f=>f?{...f,...r}:null):a==="both"&&(b&&d(f=>f?{...f,...r}:null),D&&$(f=>f?{...f,...r}:null))},[b,D,wi]),Jc=w.useCallback(()=>{Ht&&(fc(Ht,{x:0,y:0,scale:1,rotation:0,flipX:!1,flipY:!1,skewX:0,skewY:0,keystoneV:0,keystoneH:0,brightness:100,contrast:100}),Me(!1),ae(!1),ge(!1))},[fc,Ht]),Nr=w.useCallback(()=>{if(jt.size>0||at.size>0||Ut.size>0||Nt.size>0){if(jt.size>0){const a=$e.filter(x=>jt.has(x.id)),r=fi&&a.some(x=>x.type==="via"),f=pi&&a.some(x=>x.type==="trace"),m=Oi&&a.some(x=>x.type==="pad");if(r){alert("Cannot change size: Vias are locked. Unlock vias to change their size.");return}if(f){alert("Cannot change size: Traces are locked. Unlock traces to change their size.");return}if(m){alert("Cannot change size: Pads are locked. Unlock pads to change their size.");return}}if(at.size>0&&_i){alert("Cannot change size: Components are locked. Unlock components to change their size.");return}if(Ut.size>0&&Dn){alert("Cannot change size: Power nodes are locked. Unlock power nodes to change their size.");return}if(Nt.size>0&&Hi){alert("Cannot change size: Ground nodes are locked. Unlock ground nodes to change their size.");return}if(It(a=>a.map(r=>{if(jt.has(r.id)){const f=r.size+1;return r.type==="via"?qe("via",f):r.type==="pad"?qe("pad",f):r.type==="trace"&&qe("trace",f,r.layer),{...r,size:f}}return r})),at.size>0){const a=(at.size>0&&kt.find(r=>at.has(r.id))?.size||18)+1;qe("component",a),dn(r=>r.map(f=>at.has(f.id)?{...f,size:(f.size||18)+1}:f)),zn(r=>r.map(f=>at.has(f.id)?{...f,size:(f.size||18)+1}:f))}if(Ut.size>0){const a=(Ke.find(r=>Ut.has(r.id))?.size||18)+1;qe("power",a),Si(r=>r.map(f=>Ut.has(f.id)?{...f,size:f.size+1}:f))}if(Nt.size>0){const a=(dt.find(r=>Nt.has(r.id))?.size||18)+1;qe("ground",a),Zi(r=>r.map(f=>Nt.has(f.id)?{...f,size:(f.size||18)+1}:f))}}else{let a=null;if(U==="draw"&&De==="via"?a="via":U==="draw"&&De==="pad"?a=jn.current==="bottom"?"padBottom":"padTop":U==="draw"&&De==="testPoint"?a=Fa.current==="bottom"?"testPointBottom":"testPointTop":U==="draw"&&De==="trace"?a=al.current==="bottom"?"traceBottom":"traceTop":U==="component"?a=$a.current==="bottom"?"componentBottom":"componentTop":U==="power"?a="power":U==="ground"&&(a="ground"),a){const r=yt.get(a),f=Math.min(40,r.size+1);yt.setSize(a,f)}}},[jt,at,Ut,Nt,$e,fi,pi,Oi,Sa,_i,Dn,Hi,U,De,qe]),pc=w.useCallback(()=>{if(jt.size>0||at.size>0||Ut.size>0||Nt.size>0){if(jt.size>0){const a=$e.filter(S=>jt.has(S.id)),r=fi&&a.some(S=>S.type==="via"),f=pi&&a.some(S=>S.type==="trace"),m=Oi&&a.some(S=>S.type==="pad"),x=Sa&&a.some(S=>S.type==="testPoint");if(r){alert("Cannot change size: Vias are locked. Unlock vias to change their size.");return}if(f){alert("Cannot change size: Traces are locked. Unlock traces to change their size.");return}if(m){alert("Cannot change size: Pads are locked. Unlock pads to change their size.");return}if(x){alert("Cannot change size: Test Points are locked. Unlock test points to change their size.");return}}if(at.size>0&&_i){alert("Cannot change size: Components are locked. Unlock components to change their size.");return}if(Ut.size>0&&Dn){alert("Cannot change size: Power nodes are locked. Unlock power nodes to change their size.");return}if(Nt.size>0&&Hi){alert("Cannot change size: Ground nodes are locked. Unlock ground nodes to change their size.");return}if(It(a=>a.map(r=>{if(jt.has(r.id)){const f=Math.max(1,r.size-1);return r.type==="via"?qe("via",f):r.type==="pad"?qe("pad",f,r.layer):r.type==="testPoint"?qe("testPoint",f,r.layer):r.type==="trace"&&qe("trace",f,r.layer),{...r,size:f}}return r})),at.size>0){const a=Math.max(1,(kt.find(r=>at.has(r.id))?.size||18)-1);qe("component",a),dn(r=>r.map(f=>at.has(f.id)?{...f,size:Math.max(1,(f.size||18)-1)}:f)),zn(r=>r.map(f=>at.has(f.id)?{...f,size:Math.max(1,(f.size||18)-1)}:f))}if(Ut.size>0){const a=Math.max(1,(Ke.find(r=>Ut.has(r.id))?.size||18)-1);qe("power",a),Si(r=>r.map(f=>Ut.has(f.id)?{...f,size:Math.max(1,f.size-1)}:f))}if(Nt.size>0){const a=Math.max(1,(dt.find(r=>Nt.has(r.id))?.size||18)-1);qe("ground",a),Zi(r=>r.map(f=>Nt.has(f.id)?{...f,size:Math.max(1,(f.size||18)-1)}:f))}}else{let a=null;if(U==="draw"&&De==="via"?a="via":U==="draw"&&De==="pad"?a=(ct||Zt||"top")==="bottom"?"padBottom":"padTop":U==="draw"&&De==="testPoint"?a=(ct||Xt||"top")==="bottom"?"testPointBottom":"testPointTop":U==="draw"&&De==="trace"?a=(ct||Bt||"top")==="bottom"?"traceBottom":"traceTop":U==="component"?a=(ct||tn||"top")==="bottom"?"componentBottom":"componentTop":U==="power"?a="power":U==="ground"&&(a="ground"),a){const r=yt.get(a),f=Math.max(1,r.size-1);yt.setSize(a,f)}}},[jt,at,Ut,Nt,$e,fi,pi,Oi,Sa,_i,Dn,Hi,U,De,ct,Zt,Xt,Bt,tn,qe]),Ld=w.useCallback(()=>{const a=Ao.size;if(jt.size>0||at.size>0||Ut.size>0||Nt.size>0){if(jt.size>0){const r=$e.filter(p=>jt.has(p.id)),f=fi&&r.some(p=>p.type==="via"),m=Oi&&r.some(p=>p.type==="pad"),x=pi&&r.some(p=>p.type==="trace"),S=Sa&&r.some(p=>p.type==="testPoint");if(f||m||x||S){alert("Cannot change size: selected items are locked.");return}}if(at.size>0&&_i){alert("Cannot change size: selected components are locked.");return}if(Ut.size>0&&Dn){alert("Cannot change size: selected power nodes are locked.");return}if(Nt.size>0&&Hi){alert("Cannot change size: selected ground nodes are locked.");return}It(r=>r.map(f=>jt.has(f.id)?(f.type==="via"?(qe("via",a),Wt(m=>{const x=new Map(m),S=x.get("via");return S&&x.set("via",{...S,settings:{...S.settings,size:a}}),x})):f.type==="pad"?(qe("pad",a,f.layer),Wt(m=>{const x=new Map(m),S=x.get("pad");if(S){const p=new Map(S.layerSettings);p.set(f.layer,{...p.get(f.layer)||{color:S.settings.color,size:a},size:a}),x.set("pad",{...S,layerSettings:p})}return x})):f.type==="testPoint"?(qe("testPoint",a,f.layer),Wt(m=>{const x=new Map(m),S=x.get("testPoint");if(S){const p=new Map(S.layerSettings);p.set(f.layer,{...p.get(f.layer)||{color:S.settings.color,size:a},size:a}),x.set("testPoint",{...S,layerSettings:p})}return x})):f.type==="trace"&&qe("trace",a,f.layer),{...f,size:a}):f)),at.size>0&&(qe("component",a),dn(r=>r.map(f=>at.has(f.id)?{...f,size:a}:f)),zn(r=>r.map(f=>at.has(f.id)?{...f,size:a}:f))),Ut.size>0&&(qe("power",a),Si(r=>r.map(f=>Ut.has(f.id)?{...f,size:a}:f))),Nt.size>0&&(qe("ground",a),Zi(r=>r.map(f=>Nt.has(f.id)?{...f,size:a}:f)))}else Q(a),U==="draw"&&De==="trace"?ct==="top"?(_(a),qe("trace",a,"top")):(W(a),qe("trace",a,"bottom")):U==="draw"&&De==="via"?qe("via",a):U==="draw"&&De==="pad"?qe("pad",a,ct):U==="draw"&&De==="testPoint"?qe("testPoint",a,ct):qe(U==="component"?"component":U==="power"?"power":U==="ground"?"ground":"brush",a);Za({visible:!1,size:6})},[Ao.size,jt,at,Ut,Nt,$e,fi,pi,_i,Dn,Hi,U,De,ct,qe,bt,Wt]),ed=w.useCallback(()=>{hi({visible:!1,source:null,interval:5})},[]),td=w.useCallback(async(a,r=!1)=>{if(a===null){Vi(!1),kl(null),ln.current&&(clearInterval(ln.current),ln.current=null),Xl({visible:!1,interval:5}),r&&hi({visible:!1,source:null,interval:5}),console.log("Auto save: Disabled");return}if(!En){alert("Please create a new project (File -> New Project) or open an existing project (File -> Open Project) first.");return}let f=qn;if(!f){const p=window;if(typeof p.showDirectoryPicker=="function")try{f=await p.showDirectoryPicker(),Nn(f)}catch(v){v?.name!=="AbortError"&&(console.error("Failed to get directory:",v),alert("Failed to select project directory."));return}else{alert("Directory picker is not supported in this browser. Auto-save requires a directory handle.");return}}ja(f);const m=En.replace(/\.json$/i,""),S=Pc(m).replace(/[^a-zA-Z0-9_-]/g,"_");Rl(S),Ua.current=f,Pl.current=S,kl(a),Vi(!0),Ti.current=!0,Xl({visible:!1,interval:5}),r&&hi({visible:!1,source:null,interval:5}),setTimeout(()=>{console.log(`Auto save: Enabled with interval ${a} minutes`),Qr.current&&Qr.current()},200)},[En,qn,Vi,kl,ja,Rl,Xl,hi,Nn]),Vs=w.useCallback(()=>{G("select"),Ct(new Set),St(new Set),ht(new Set),zt(new Set)},[Ct,St,ht,zt]),Mr=w.useCallback(a=>{if(a.key==="Escape"){const x=document.activeElement;if(x&&(x.tagName==="INPUT"&&x.type==="checkbox"||x.tagName==="INPUT"&&x.type==="radio")){x.blur(),a.preventDefault(),a.stopPropagation();return}}const r=document.activeElement;if(r&&(r.tagName==="INPUT"&&r.type!=="checkbox"&&r.type!=="radio"||r.tagName==="TEXTAREA"||r.isContentEditable)||wo.current>0&&a.key!=="z"&&a.key!=="Z")return;const m=parseInt(a.key);if(!isNaN(m)&&m>=0&&m<=9){if(a.preventDefault(),a.stopPropagation(),U==="center"&&Yc){bn.current&&(clearTimeout(bn.current),bn.current=null);const S=Ln.current;if(S){const p=S.width-80,v=S.height-80,T=p/2,k=v/2,N=(T-At.x)/Ve,Z=(k-At.y)/Ve;Oo(re=>({...re,[m]:{x:N,y:Z,zoom:Ve}}))}rl(!1),G("select"),Jn(void 0);return}const x=pr[m];if(x){ll(x.zoom);const S=Ln.current;let p=0,v=0;if(S){const T=S.width-80,k=S.height-80,N=T/2,Z=k/2;p=N-x.x*x.zoom,v=Z-x.y*x.zoom}Tn({x:p,y:v})}return}if(a.key==="+"||a.key==="="){a.preventDefault(),a.stopPropagation(),Nr();return}if(a.key==="-"||a.key==="_"){a.preventDefault(),a.stopPropagation(),pc();return}if((a.key==="ArrowUp"||a.key==="ArrowDown"||a.key==="ArrowLeft"||a.key==="ArrowRight")&&at.size>0){a.preventDefault(),a.stopPropagation();const x=a.shiftKey?10:1;let S=0,p=0;a.key==="ArrowUp"?p=-x:a.key==="ArrowDown"?p=x:a.key==="ArrowLeft"?S=-x:a.key==="ArrowRight"&&(S=x);for(const v of at){const T=kt.find(k=>k.id===v);if(T){const k=T.x+S,N=T.y+p,Z=_t({x:k,y:N});dn(re=>re.map(Y=>Y.id===v?{...Y,x:Z.x,y:Z.y}:Y))}else{const k=gt.find(N=>N.id===v);if(k){const N=k.x+S,Z=k.y+p,re=_t({x:N,y:Z});zn(Y=>Y.map(J=>J.id===v?{...J,x:re.x,y:re.y}:J))}}}return}if((a.key==="I"||a.key==="i")&&!a.ctrlKey&&!a.shiftKey&&!a.altKey){const x=document.activeElement;if(!!x&&(x.tagName==="INPUT"&&x.type!=="range"&&x.type!=="checkbox"&&x.type!=="radio"||x.tagName==="TEXTAREA"||x.isContentEditable))return;a.preventDefault(),a.stopPropagation();const p=[];jt.size>0,jt.size===0&&at.size===0&&Ut.size===0&&Nt.size===0&&p.push(`
No objects selected.`);const v=p.join(`
`);console.log(v),Ka({visible:!0,text:v});return}if((a.key==="N"||a.key==="n")&&!a.ctrlKey&&!a.shiftKey&&!a.altKey){const x=document.activeElement;if(!!x&&(x.tagName==="INPUT"&&x.type!=="range"&&x.type!=="checkbox"&&x.type!=="radio"||x.tagName==="TEXTAREA"||x.isContentEditable))return;a.preventDefault(),a.stopPropagation(),$i(!0);return}if((a.key==="L"||a.key==="l")&&!a.ctrlKey&&!a.shiftKey&&!a.altKey){const x=document.activeElement;if(!!x&&(x.tagName==="INPUT"&&x.type!=="range"&&x.type!=="checkbox"&&x.type!=="radio"||x.tagName==="TEXTAREA"||x.isContentEditable))return;a.preventDefault(),a.stopPropagation(),id();return}if(a.key==="O"||a.key==="o"){const x=document.activeElement;if(!!x&&(x.tagName==="INPUT"&&x.type!=="range"&&x.type!=="checkbox"&&x.type!=="radio"||x.tagName==="TEXTAREA"||x.isContentEditable))return;a.preventDefault(),a.stopPropagation();const p=pr[0];if(p){ll(p.zoom);const v=Ln.current;let T=0,k=0;if(v){const N=v.width-80,Z=v.height-80,re=N/2,Y=Z/2;T=re-p.x*p.zoom,k=Y-p.y*p.zoom}Tn({x:T,y:k})}else{ll(1);const v=Ln.current;let T=0,k=0;if(v){const N=v.width-80,Z=v.height-80,re=N/2,Y=Z/2;T=re,k=Y}document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),Tn({x:T,y:k})}ye("overlay"),Ct(new Set),St(new Set),ht(new Set),zt(new Set),G("select");return}if((a.key==="Alt"||a.altKey)&&(cc(!0),Ji(!0)),a.key==="Escape"){a.preventDefault(),a.stopPropagation(),Vs(),Na(!1),tl(!1),qo(!1),vn(!1),st(!1),ro(!1),Gl(!1),rc(null);return}if(a.key==="Enter"&&U==="draw"&&De==="trace"){Hs();return}if((a.key==="Delete"||a.key==="Backspace")&&(jt.size>0||at.size>0||Ut.size>0||Nt.size>0)){if(a.preventDefault(),a.stopPropagation(),jt.size>0){const x=$e.filter(k=>jt.has(k.id)),S=fi&&x.some(k=>k.type==="via"),p=pi&&x.some(k=>k.type==="trace"),v=Oi&&x.some(k=>k.type==="pad"),T=Sa&&x.some(k=>k.type==="testPoint");S?alert("Cannot delete: Vias are locked. Unlock vias to delete them."):p?alert("Cannot delete: Traces are locked. Unlock traces to delete them."):v?alert("Cannot delete: Pads are locked. Unlock pads to delete them."):T?alert("Cannot delete: Test points are locked. Unlock test points to delete them."):(It(k=>k.filter(N=>!jt.has(N.id))),Ct(new Set))}at.size>0&&(_i?alert("Cannot delete: Components are locked. Unlock components to delete them."):(dn(x=>x.filter(S=>!at.has(S.id))),zn(x=>x.filter(S=>!at.has(S.id))),St(new Set))),Ut.size>0&&(Dn?alert("Cannot delete: Power nodes are locked. Unlock power nodes to delete them."):(Si(x=>x.filter(S=>!Ut.has(S.id))),ht(new Set))),Nt.size>0&&(Hi?alert("Cannot delete: Ground nodes are locked. Unlock ground nodes to delete them."):(Zi(x=>x.filter(S=>!Nt.has(S.id))),zt(new Set)));return}if((U==="draw"||U==="erase"||U==="power"||U==="ground")&&(a.key==="z"||a.key==="Z")&&a.ctrlKey&&!a.shiftKey&&!a.altKey){if(a.preventDefault(),a.stopPropagation(),U==="power"){Si(x=>x.length===0?x:x.slice(0,-1));return}if(U==="ground"){Zi(x=>x.length===0?x:x.slice(0,-1));return}if(U==="draw"&&De==="trace"){const x=pt,S=il.current,p=x.length>0?x:S;if(p.length>0){p.length>1?hn(v=>v.slice(0,-1)):hn([]);return}It(v=>{for(let T=v.length-1;T>=0;T--){const k=v[T];if(k.type==="trace"&&k.layer===ct&&k.points.length>=2)if(k.points.length>2){const N=k.points.slice(0,-1);return hn(N),[...v.slice(0,T),...v.slice(T+1)]}else return[...v.slice(0,T),...v.slice(T+1)]}return v});return}if(ga&&pt.length>0){hn([]);return}U==="draw"&&(De==="via"||De==="pad"||De==="testPoint")&&It(x=>{for(let S=x.length-1;S>=0;S--){const p=x[S];if(p.layer===ct&&p.type===De)return[...x.slice(0,S),...x.slice(S+1)]}return x});return}if(!a.ctrlKey&&!a.altKey){const x=document.activeElement;if(!(!!x&&(x.tagName==="INPUT"&&x.type!=="range"&&x.type!=="checkbox"&&x.type!=="radio"||x.tagName==="TEXTAREA"||x.isContentEditable)))switch(a.key){case"s":case"S":a.preventDefault(),Vs();return;case"b":case"B":a.preventDefault(),G("power");return;case"g":case"G":a.preventDefault(),G("ground");return;case"v":case"V":a.preventDefault(),nl("via"),G("draw");return;case"p":case"P":a.preventDefault(),nl("pad"),G("draw"),cn(Zt||"top");return;case"y":case"Y":a.preventDefault(),nl("testPoint"),G("draw"),cn(Xt||"top");return;case"t":case"T":a.preventDefault(),nl("trace"),G("draw"),cn(Bt||"top");return;case"c":case"C":a.preventDefault(),G("component"),vn(!0),st(!1),mo(null);return;case"e":case"E":a.preventDefault(),G("erase");return;case"h":case"H":a.preventDefault(),G("pan");return;case"x":case"X":a.preventDefault(),G("center"),rl(!0),bn.current&&clearTimeout(bn.current),bn.current=setTimeout(()=>{rl(!1),G("select"),Jn(void 0)},2e3);return;case"z":case"Z":if(!a.ctrlKey){a.preventDefault(),Kr(!1),G("magnify");return}break}}if(U==="transform"&&Ht){if(!(a.key==="ArrowLeft"||a.key==="ArrowRight"||a.key==="ArrowUp"||a.key==="ArrowDown"))return;a.preventDefault(),a.stopPropagation();const S=document.activeElement;if(S&&S.tagName==="INPUT"){const p=S;p.type==="radio"&&p.blur()}if(wi)return;if(Il==="nudge"){let p=0,v=0;switch(a.key){case"ArrowLeft":p=-1;break;case"ArrowRight":p=1;break;case"ArrowUp":v=-1;break;case"ArrowDown":v=1;break;default:return}Ht==="top"&&b?d(T=>T?{...T,x:T.x+p,y:T.y+v}:null):Ht==="bottom"&&D?$(T=>T?{...T,x:T.x+p,y:T.y+v}:null):Ht==="both"&&(b&&d(T=>T?{...T,x:T.x+p,y:T.y+v}:null),D&&$(T=>T?{...T,x:T.x+p,y:T.y+v}:null))}else if(Il==="scale"){let p=0;switch(a.key){case"ArrowUp":p=.01;break;case"ArrowDown":p=-.01;break;case"ArrowRight":p=.001;break;case"ArrowLeft":p=-.001;break;default:return}if(Ht==="top"){b&&d(v=>v?{...v,scale:Math.max(.1,Math.min(3,v.scale+p))}:null);return}if(Ht==="bottom"){D&&$(v=>v?{...v,scale:Math.max(.1,Math.min(3,v.scale+p))}:null);return}if(Ht==="both"){b&&d(v=>v?{...v,scale:Math.max(.1,Math.min(3,v.scale+p))}:null),D&&$(v=>v?{...v,scale:Math.max(.1,Math.min(3,v.scale+p))}:null);return}}else if(Il==="rotate"){let p=0;switch(a.key){case"ArrowUp":p=1;break;case"ArrowDown":p=-1;break;case"ArrowRight":p=.1;break;case"ArrowLeft":p=-.1;break;default:return}if(Ht==="top"){b&&d(v=>v?{...v,rotation:v.rotation+p}:null);return}if(Ht==="bottom"){D&&$(v=>v?{...v,rotation:v.rotation+p}:null);return}if(Ht==="both"){b&&d(v=>v?{...v,rotation:v.rotation+p}:null),D&&$(v=>v?{...v,rotation:v.rotation+p}:null);return}}else if(Il==="slant"){let p=0,v=0;switch(a.key){case"ArrowUp":v=-.5;break;case"ArrowDown":v=.5;break;case"ArrowLeft":p=-.5;break;case"ArrowRight":p=.5;break}if(p!==0||v!==0){const T=N=>N*Math.PI/180,k=N=>Math.max(-.7,Math.min(.7,N));if(Ht==="top"){b&&d(N=>N?{...N,skewX:k((N.skewX||0)+T(p)),skewY:k((N.skewY||0)+T(v))}:null);return}if(Ht==="bottom"){D&&$(N=>N?{...N,skewX:k((N.skewX||0)+T(p)),skewY:k((N.skewY||0)+T(v))}:null);return}if(Ht==="both"){b&&d(N=>N?{...N,skewX:k((N.skewX||0)+T(p)),skewY:k((N.skewY||0)+T(v))}:null),D&&$(N=>N?{...N,skewX:k((N.skewX||0)+T(p)),skewY:k((N.skewY||0)+T(v))}:null);return}}}else if(Il==="keystone"){let p=0,v=0;switch(a.key){case"ArrowUp":v=-.5;break;case"ArrowDown":v=.5;break;case"ArrowLeft":p=-.5;break;case"ArrowRight":p=.5;break}if(p!==0||v!==0){const T=N=>N*Math.PI/180,k=N=>Math.max(-.35,Math.min(.35,N));if(Ht==="top"){b&&d(N=>N?{...N,keystoneH:k((N.keystoneH||0)+T(p)),keystoneV:k((N.keystoneV||0)+T(v))}:null);return}if(Ht==="bottom"){D&&$(N=>N?{...N,keystoneH:k((N.keystoneH||0)+T(p)),keystoneV:k((N.keystoneV||0)+T(v))}:null);return}if(Ht==="both"){b&&d(N=>N?{...N,keystoneH:k((N.keystoneH||0)+T(p)),keystoneV:k((N.keystoneV||0)+T(v))}:null),D&&$(N=>N?{...N,keystoneH:k((N.keystoneH||0)+T(p)),keystoneV:k((N.keystoneV||0)+T(v))}:null);return}}}}else{const x=a.target;if(x.tagName==="INPUT"&&x.type==="range"){const S=x,p=Number(S.value),v=Number(S.min),T=Number(S.max),k=Number(S.step)||1;switch(a.key){case"ArrowLeft":a.preventDefault();const N=Math.max(v,p-k);S.value=N.toString(),S.dispatchEvent(new Event("input",{bubbles:!0}));break;case"ArrowRight":a.preventDefault();const Z=Math.min(T,p+k);S.value=Z.toString(),S.dispatchEvent(new Event("input",{bubbles:!0}));break}}}},[U,Ht,Il,b,D,jt,at,Ut,Nt,$e,kt,gt,Ke,dt,ut,De,Hs,Bt,Re,fe,se,O,Vs,dn,zn]);Pe.useEffect(()=>{U!=="transform"&&xa(null)},[U]),Pe.useEffect(()=>{window.addEventListener("keydown",Mr,!0);const a=r=>{r.key==="Alt"&&(cc(!1),Ji(!1),za(null))};return window.addEventListener("keyup",a,!0),()=>{window.removeEventListener("keydown",Mr,!0),window.removeEventListener("keyup",a,!0)}},[Mr,Ut,Nt,Dn,Dn,Ke,dt,Nr,pc,Vs,at,kt,gt,dn,zn,pr,Yc,U]);const Is=w.useCallback(()=>{Lo.current={},Oe("#AA4499"),Ee("#F781BF"),_(6),W(6),mt("trace","#AA4499","top"),mt("trace","#F781BF","bottom"),qe("trace",6,"top"),qe("trace",6,"bottom"),F("#0072B2"),M("#56B4E9"),he(18),et(18),mt("pad","#0072B2","top"),mt("pad","#56B4E9","bottom"),qe("pad",18,"top"),qe("pad",18,"bottom"),Ui("#6A3D9A"),wl("#9467BD"),Tl(18),ha(18),mt("component","#6A3D9A","top"),mt("component","#9467BD","bottom"),qe("component",18,"top"),qe("component",18,"bottom"),Wa("top"),z("#AA4499"),Q(6),ui([{id:"powerbus-1",name:"+3V3",voltage:"+3.3",color:"#ff0000"},{id:"powerbus-2",name:"+5V",voltage:"+5.0",color:"#ff0000"}]),Pi([{id:"groundbus-circuit",name:"GND",color:"#000000"},{id:"groundbus-earth",name:"Earth Ground",color:"#333333"}]),qe("power",18),qe("ground",18),Do(!1),vs(!1),Ga(!1),ms(!1),qa(!1),Ss(!1),cn("top"),G("select"),I(50),ve(!1),ye("overlay"),Dd(1)},[mt,qe]),Ur=w.useCallback(()=>{Nn(null),ja(null),To&&(To.current=null),Ua&&(Ua.current=null),Ii(""),sl("pcb_project"),Vi(!1),kl(null),Rl(""),io([]),Cs(-1),Pl&&(Pl.current=""),Ti.current=!1,ln.current&&(clearInterval(ln.current),ln.current=null),d(null),$(null),It([]),ys([]),ci([]),Fr([]),Vc([]),hn([]),il.current=[],dn([]),zn([]),Ll(null),ba(null),Si([]),Zi([]),ma(null),ui([{id:"powerbus-1",name:"+3V3",voltage:"+3.3",color:"#ff0000"},{id:"powerbus-2",name:"+5V",voltage:"+5.0",color:"#ff0000"}]),Pi([{id:"groundbus-circuit",name:"GND",color:"#000000"},{id:"groundbus-earth",name:"Earth Ground",color:"#333333"}]),Ct(new Set),St(new Set),ht(new Set),zt(new Set),Ro(!1),Ns([]),ye("overlay"),ll(1),Tn({x:0,y:0}),gs(!0),cn("top"),Oo({}),rl(!1),bn.current&&(clearTimeout(bn.current),bn.current=null),xa(null),Gi(!1),qi(null),hs("nudge"),Me(!1),ae(!1),ge(!1),I(50),ve(!1),Ae(2e3),Do(!1),vs(!1),cr(!1),Fc(!1),Ga(!1),ms(!1),qa(!1),Ss(!1),Jl(!0),ea(!0),ei(!0),Dl(!0),ta(!0),ni(!0),zi(!0),cl(!0),Rs(!0),oo(!0),Lt(!0),el(!0),fo(!0),aa(!0),G("select"),nl("trace"),Wa("top"),Wl("top"),zl("top"),Fl("top"),al.current="top",jn.current="top",Fa.current="top",$a.current="top",Lo.current={},On(!0),$o(!1),Dd(1),dr(null),Ka({visible:!1,text:""}),No({visible:!1,title:"",message:""}),Ja({visible:!1}),Ts({visible:!1}),Mo({visible:!1,projectName:"",locationPath:"",locationHandle:null}),to({visible:!1,filename:"",locationPath:"",locationHandle:null}),Xl({visible:!1,interval:null}),hi({visible:!1,source:"new",interval:5}),Gl(!1),Io(!1),Wi(!1),Sr(!1),ra(!1),$i(!1),sa(!1),js(!1),Bs(null),za(null),ka(null),ks(!1),lo.current=null,Po.current=null,Xi(!1),jl(null),Cl.current=0,Vl.current=!1,console.log("Project closed: All state cleared and browser permissions released")},[Nn,ja,Ii,sl,Vi,kl,Rl,io,Cs,d,$,It,hn,ys,ci,Fr,Vc,dn,zn,Ll,ba,Si,Zi,ma,ui,Pi,Ct,St,ht,zt,Ro,Ns,ye,ll,Tn,gs,cn,Oo,rl,xa,Gi,qi,hs,Me,ae,ge,I,ve,Ae,Do,vs,cr,Fc,Ga,ms,qa,Ss,Jl,ea,ei,Dl,ta,ni,zi,cl,Rs,oo,Lt,el,fo,aa,G,nl,Wa,Wl,zl,Fl,On,$o,dr,Ka,No,Ja,Mo,to,Xl,hi,Gl,Io,Wi,Sr,ra,$i,sa,Bs,za,ka,ks,Xi,jl]),So=w.useCallback(()=>{Is(),setTimeout(()=>{ll(1);const a=Ln.current,r=Ca.current;let f=0,m=0;if(a&&r){const x=a.getBoundingClientRect(),S=r.getBoundingClientRect(),p=a.width-80,v=a.height-80,N=60+168+6,Z=x.left-S.left,re=N-Z,Y=x.width-Math.max(0,re),J=re+Y/2,L=x.height/2,K=p/2,q=v/2,xe=x.width/a.width,Ce=x.height/a.height,ze=J/xe,oe=L/Ce,He=ze-40,Ue=oe-40;f=He-K,m=Ue-q}document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),Tn({x:f,y:m}),Ct(new Set),St(new Set),ht(new Set),zt(new Set)},100)},[Is]);Pe.useEffect(()=>{So()},[]),Pe.useEffect(()=>{if(!ws.visible)return;const a=[];jt.size>0,jt.size===0&&at.size===0&&Ut.size===0&&Nt.size===0&&a.push(`
No objects selected.`);const r=a.join(`
`);Ka(f=>({...f,text:r}))},[ws.visible,jt,at,Ut,Nt,$e,kt,gt,Ke,dt,ut]),Pe.useEffect(()=>{const a=r=>{const f=Ln.current;if(f&&!(gl.current&&gl.current.contains(r.target))&&!(r.target instanceof Node&&f.contains(r.target))){if(Hs(),Go){const m=Qn.current;(!m||!(r.target instanceof Node)||!m.contains(r.target))&&Na(!1)}if(Ft){const m=gl.current;(!m||!(r.target instanceof Node)||!m.contains(r.target))&&(vn(!1),G("select"))}if(hl){const m=Os.current;(!m||!(r.target instanceof Node)||!m.contains(r.target))&&(st(!1),rc(null))}if(Uo){const m=yr.current;!r.target?.closest('button[title="Color Picker"]')&&(!m||!(r.target instanceof Node)||!m.contains(r.target))&&Gl(!1)}}};return document.addEventListener("mousedown",a,!0),()=>document.removeEventListener("mousedown",a,!0)},[Hs,Go,ki,Ft,hl,Uo]);const Jo=a=>{if(!a.current)return{top:0,left:0};const r=a.current.getBoundingClientRect(),f=Ca.current?.getBoundingClientRect();return f?{top:r.top-f.top,left:r.left-f.left+r.width+4}:{top:0,left:0}},hc=w.useCallback(()=>{Qn.current&&ac.current&&requestAnimationFrame(()=>{if(Qn.current&&ac.current){const a=Jo(ac);Qn.current.style.top=`${a.top}px`,Qn.current.style.left=`${a.left}px`}})},[]),nd=w.useCallback(()=>{pl.current&&mn.current&&requestAnimationFrame(()=>{if(pl.current&&mn.current){const a=Jo(mn);pl.current.style.top=`${a.top}px`,pl.current.style.left=`${a.left}px`}})},[]),gc=w.useCallback(()=>{ai.current&&_s.current&&requestAnimationFrame(()=>{if(ai.current&&_s.current){const a=Jo(_s);ai.current.style.top=`${a.top}px`,ai.current.style.left=`${a.left}px`}})},[]);Pe.useEffect(()=>{Go&&hc()},[Go,hc]),Pe.useEffect(()=>{ki&&nd()},[ki,nd]),Pe.useEffect(()=>{Rr&&gc()},[Rr,gc]),Pe.useEffect(()=>{if(Ft&&gl.current&&Dr.current){const a=Jo(Dr);gl.current.style.top=`${a.top}px`,gl.current.style.left=`${a.left}px`}},[Ft]),Pe.useEffect(()=>{if(Da&&kn.current&&oc.current){const a=Jo(oc);kn.current.style.top=`${a.top}px`,kn.current.style.left=`${a.left}px`}},[Da]),Pe.useEffect(()=>{if(mr&&Zo.current&&sc.current){const a=Jo(sc);Zo.current.style.top=`${a.top}px`,Zo.current.style.left=`${a.left}px`}},[mr]),Pe.useEffect(()=>{const a=r=>{if(!di)return;const f=document.querySelector("[data-component-editor-dialog]");if(f&&r.target instanceof Node&&f.contains(r.target)){const Ue=r.target;if(Ue.tagName==="BUTTON"||Ue.tagName==="INPUT"||Ue.closest("button")||Ue.closest("input"))return}const m=Ln.current;if(!m)return;const x=m.getBoundingClientRect(),S=r.clientX,p=r.clientY;if(S<x.left||S>x.right||p<x.top||p>x.bottom)return;const v=m.width/x.width,T=m.height/x.height,k=S-x.left,N=p-x.top,Z=k*v,re=N*T,Y=Z-40,J=re-40,L=(Y-At.x)/Ve,K=(J-At.y)/Ve;let q=1/0,xe=null,Ce=null;const ze=Math.max(6/Ve,4),He=[...kt,...gt].find(Ue=>Ue.id===di.componentId)?.layer||"top";for(const Ue of $e)if((Ue.type==="via"||Ue.type==="pad")&&Ue.points.length>0){if(Ue.type==="pad"&&(Ue.layer||"top")!==He)continue;const E=Ue.points[0],B=Math.max(1,Ue.size/2),pe=Math.hypot(E.x-L,E.y-K),te=Math.max(B,ze);pe<=te&&pe<q&&(q=pe,xe=E.id??null,Ce=Ue)}if(xe!=null&&Ce){console.log(`
[PIN CONNECTION - DOCUMENT HANDLER] Found via!`),console.log(`  Point ID: ${xe}`),console.log(`  Connecting pin ${di.pinIndex+1} of component ${di.componentId}`);const Ue=String(xe),E=di.pinIndex,B=di.componentId,pe=kt.find(ke=>ke.id===B),te=gt.find(ke=>ke.id===B);if(pe){const ke=$e;dn(_e=>{const Ze=_e.find(Be=>Be.id===B);if(!Ze)return _e;const Le=Ze.pinConnections||[],ot=Le.length>0?[...Le]:new Array(Ze.pinCount).fill("");let Xe;if(ot.length!==Ze.pinCount){Xe=new Array(Ze.pinCount).fill("");for(let Be=0;Be<Math.min(ot.length,Ze.pinCount);Be++)Xe[Be]=ot[Be]||""}else Xe=[...ot];Xe[E]=Ue,console.log(`Updated pin ${E} with value: ${Ue}`),console.log("New pinConnections:",Xe);const xt=_e.find(Be=>Be.id===B),nt=xt?Hf(xt,Xe,ke):null;return _e.map(Be=>{if(Be.id===B){const Je={...Be,pinConnections:Xe};return nt&&(Je.pinPolarities=nt),Je}return Be})})}else if(te){const ke=$e;zn(_e=>{const Ze=_e.find(Be=>Be.id===B);if(!Ze)return _e;const Le=Ze.pinConnections||[],ot=Le.length>0?[...Le]:new Array(Ze.pinCount).fill("");let Xe;if(ot.length!==Ze.pinCount){Xe=new Array(Ze.pinCount).fill("");for(let Be=0;Be<Math.min(ot.length,Ze.pinCount);Be++)Xe[Be]=ot[Be]||""}else Xe=[...ot];Xe[E]=Ue,console.log(`Updated pin ${E} with value: ${Ue}`),console.log("New pinConnections:",Xe);const xt=_e.find(Be=>Be.id===B),nt=xt?Hf(xt,Xe,ke):null;return _e.map(Be=>{if(Be.id===B){const Je={...Be,pinConnections:Xe};return nt&&(Je.pinPolarities=nt),Je}return Be})})}setTimeout(()=>{ba(null)},0)}else console.log("[PIN CONNECTION - DOCUMENT HANDLER] No via found at click location")};if(di)return document.addEventListener("mousedown",a,!0),()=>document.removeEventListener("mousedown",a,!0)},[di,kt,gt,$e,Ve,At.x,At.y]);const In=w.useCallback((a,r,f,m)=>{const x=window.innerWidth,S=window.innerHeight,p=10;let v=Math.max(p,Math.min(a,x-f-p)),T=Math.max(p,Math.min(r,S-m-p));return{x:v,y:T}},[]);Pe.useEffect(()=>{if(!bs)return;const a=f=>{if(!Gn)return;const m={x:f.clientX-Gn.x,y:f.clientY-Gn.y},x=In(m.x,m.y,250,window.innerHeight*.4);va(x),localStorage.setItem("componentDialogPosition",JSON.stringify(x))},r=()=>{Wc(!1),Xa(null)};return document.addEventListener("mousemove",a),document.addEventListener("mouseup",r),()=>{document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",r)}},[bs,Gn,In]),Pe.useEffect(()=>{if(!po)return;const a=f=>{if(!wr)return;const m={x:f.clientX-wr.x,y:f.clientY-wr.y},x=In(m.x,m.y,250,window.innerHeight*.4);oa(x),localStorage.setItem("detailedInfoDialogPosition",JSON.stringify(x))},r=()=>{_d(!1),Hd(null)};return document.addEventListener("mousemove",a),document.addEventListener("mouseup",r),()=>{document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",r)}},[po,wr,In]),Pe.useEffect(()=>{if(!ec)return;const a=f=>{if(!As)return;const m={x:f.clientX-As.x,y:f.clientY-As.y};Yo(m),localStorage.setItem("notesDialogPosition",JSON.stringify(m))},r=()=>{Xo(!1),Tr(null)};return document.addEventListener("mousemove",a),document.addEventListener("mouseup",r),()=>{document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",r)}},[ec,As]),Pe.useEffect(()=>{if(Jr&&ho===null){const a=localStorage.getItem("notesDialogPosition");if(a)try{const r=JSON.parse(a);Yo(r)}catch{Yo({x:window.innerWidth-550,y:100})}else Yo({x:window.innerWidth-550,y:100})}},[Jr,ho]),Pe.useEffect(()=>{if(!nc)return;const a=f=>{if(!yo)return;const m={x:f.clientX-yo.x,y:f.clientY-yo.y};Ms(m),localStorage.setItem("projectNotesDialogPosition",JSON.stringify(m))},r=()=>{xo(!1),Us(null)};return document.addEventListener("mousemove",a),document.addEventListener("mouseup",r),()=>{document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",r)}},[nc,yo]),Pe.useEffect(()=>{if(tc&&fl===null){const a=localStorage.getItem("projectNotesDialogPosition");if(a)try{const r=JSON.parse(a);Ms(r)}catch{Ms({x:100,y:100})}else Ms({x:100,y:100})}},[tc,fl]);const id=w.useCallback(()=>{sa(!0)},[]);Pe.useEffect(()=>{if($l&&$l.visible&&Yl===null){const a=localStorage.getItem("componentDialogPosition");let r;if(a)try{const f=JSON.parse(a);r=In(f.x,f.y,250,window.innerHeight*.4),va(r)}catch{r=In(window.innerWidth-280,90,250,window.innerHeight*.4),va(r)}else r=In(window.innerWidth-280,90,250,window.innerHeight*.4),va(r)}else!$l||$l.visible},[$l,Yl,In]),Pe.useEffect(()=>{if(ws.visible&&Fi===null){const a=localStorage.getItem("detailedInfoDialogPosition");let r;if(a)try{const f=JSON.parse(a);r=In(f.x,f.y,400,window.innerHeight*.8),oa(r)}catch{r=In(window.innerWidth-450,90,400,window.innerHeight*.8),oa(r)}else r=In(window.innerWidth-450,90,400,window.innerHeight*.8),oa(r)}else ws.visible},[ws.visible,Fi,In]),Pe.useEffect(()=>{const a=()=>{if(Yl){const r=In(Yl.x,Yl.y,250,window.innerHeight*.4);(r.x!==Yl.x||r.y!==Yl.y)&&(va(r),localStorage.setItem("componentDialogPosition",JSON.stringify(r)))}if(Fi){const r=In(Fi.x,Fi.y,400,window.innerHeight*.8);(r.x!==Fi.x||r.y!==Fi.y)&&(oa(r),localStorage.setItem("detailedInfoDialogPosition",JSON.stringify(r)))}};return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[Yl,Fi,In]);const xc=w.useCallback(a=>{switch(a){case"transparency":I(50);break;case"brushSize":Q(3);break}},[]),Br=Pe.useRef(je);Pe.useEffect(()=>{Br.current=je},[je]),Pe.useEffect(()=>{if(ue){Lc.current=performance.now(),I(0);const a=r=>{const f=Lc.current||r,m=Br.current,x=(r-f)%m/m,S=1-Math.abs(1-2*x);I(Math.round(S*100)),Bo.current=requestAnimationFrame(a)};Bo.current=requestAnimationFrame(a)}return()=>{Bo.current&&(cancelAnimationFrame(Bo.current),Bo.current=null)}},[ue]),Pe.useEffect(()=>{if(U==="center"){Jn(ox());return}const a=U==="erase"?"erase":U==="magnify"?"magnify":U==="ground"?"ground":U==="power"?"power":U==="component"?"component":U==="draw"?De==="via"?"via":De==="pad"?"pad":De==="testPoint"?"testPoint":"trace":"default";if(a==="default"){Jn(void 0);return}const r=Math.max(1,Ve),f=a==="magnify"?18:Math.max(a==="component"?16:a==="power"||a==="ground"?12:6,Math.round(y*r)),x=f+4*2+(a==="magnify"?8:0),S=document.createElement("canvas");S.width=x,S.height=x;const p=S.getContext("2d");if(!p){Jn(void 0);return}const v=x/2,T=x/2,k=f/2;if(p.clearRect(0,0,x,x),a==="via"){const Z=k,re=k*.5,Y=k*.7,L=yt.get("via").color;p.fillStyle=L,p.beginPath(),p.arc(v,T,Z,0,Math.PI*2),p.arc(v,T,re,0,Math.PI*2),p.fill("evenodd"),p.strokeStyle="#808080",p.lineWidth=1,p.beginPath(),p.moveTo(v-Y,T),p.lineTo(v+Y,T),p.stroke(),p.beginPath(),p.moveTo(v,T-Y),p.lineTo(v,T+Y),p.stroke()}else if(a==="pad"){const Z=Zt==="top"?"padTop":"padBottom",re=yt.get(Z),Y=re.color,L=Math.max(6,Math.round(re.size*r))/2,K=L*2,q=K*.5,xe=L*.7;p.fillStyle=Y,p.beginPath(),p.rect(v-L,T-L,K,K),p.rect(v-q/2,T-q/2,q,q),p.fill("evenodd"),p.strokeStyle="#808080",p.lineWidth=1,p.beginPath(),p.moveTo(v-xe,T),p.lineTo(v+xe,T),p.stroke(),p.beginPath(),p.moveTo(v,T-xe),p.lineTo(v,T+xe),p.stroke()}else if(a==="trace"){const Z=Bt==="top"?"traceTop":"traceBottom",Y=yt.get(Z).color;p.fillStyle=Y,p.beginPath(),p.arc(v,T,k,0,Math.PI*2),p.fill()}else if(a==="testPoint"){const Z=Xt==="top"?"testPointTop":"testPointBottom",re=yt.get(Z);Jn(sx(re.size));return}else if(a==="erase"){const Z=Math.max(y*.75,8),re=Math.max(y*.5,6),Y=Math.max(y*.2,2);p.save(),p.translate(v,T),p.rotate(-35*Math.PI/180),p.fillStyle="#f5a3b3",p.strokeStyle="#111",p.lineWidth=1.5;const J=1.5,L=-Z/2,K=-re/2;p.beginPath(),p.moveTo(L+J,K),p.lineTo(L+Z-J,K),p.quadraticCurveTo(L+Z,K,L+Z,K+J),p.lineTo(L+Z,K+re-J),p.quadraticCurveTo(L+Z,K+re,L+Z-J,K+re),p.lineTo(L+J,K+re),p.quadraticCurveTo(L,K+re,L,K+re-J),p.lineTo(L,K+J),p.quadraticCurveTo(L,K,L+J,K),p.closePath(),p.fill(),p.stroke(),p.fillStyle="#f18ea4",p.beginPath(),p.rect(-Z/2,re/2-Y,Z,Y),p.fill(),p.restore()}else if(a==="magnify"){const Z=k;p.strokeStyle="#111",p.lineWidth=2,p.beginPath(),p.arc(v-2,T-2,Z,0,Math.PI*2),p.stroke();const re=v+Z*.6,Y=T+Z*.6,J=re+6,L=Y+6;p.beginPath(),p.moveTo(re,Y),p.lineTo(J,L),p.stroke(),p.beginPath(),p.moveTo(v-6,T-2),p.lineTo(v+2,T-2),p.stroke(),fr||(p.beginPath(),p.moveTo(v-2,T-6),p.lineTo(v-2,T+2),p.stroke())}else if(a==="ground"){const Z=yt.get("ground");if(p.strokeStyle=Z.color,p.lineWidth=2,p.lineCap="round",Nl==="groundbus-earth"){const Y=k*1.5,J=Y*.9,L=Y*.24,K=Y*1.6;p.beginPath(),p.moveTo(v,T-J/2),p.lineTo(v,T+J/2),p.stroke();for(let q=0;q<3;q++){const xe=T+J/2+q*L,Ce=K*(1-q*.25);p.beginPath(),p.moveTo(v-Ce/2,xe),p.lineTo(v+Ce/2,xe),p.stroke()}}else{const Y=k*.8;p.beginPath(),p.arc(v,T,k,0,Math.PI*2),p.stroke(),p.beginPath(),p.moveTo(v,T-k-Y),p.lineTo(v,T+k+Y),p.stroke(),p.beginPath(),p.moveTo(v-k-Y,T),p.lineTo(v+k+Y,T),p.stroke()}}else if(a==="power"){const Z=yt.get("power");p.strokeStyle=Z.color,p.lineWidth=2,p.lineCap="round";const re=k*.8;p.beginPath(),p.arc(v,T,k,0,Math.PI*2),p.stroke(),p.beginPath(),p.moveTo(v,T-k-re),p.lineTo(v,T+k+re),p.stroke(),p.beginPath(),p.moveTo(v-k-re,T),p.lineTo(v+k+re,T),p.stroke()}else if(a==="component"){const re=(tn||"top")==="top"?"componentTop":"componentBottom",J=yt.get(re).color,L=f,K=L/2;p.strokeStyle=J,p.lineWidth=2,p.fillStyle="rgba(255,255,255,0.9)",p.beginPath(),p.rect(v-K,T-K,L,L),p.fill(),p.stroke();const q=Ri?_f(Ri):"?";p.fillStyle=J,p.font=`bold ${Math.max(8,L*.35)}px sans-serif`,p.textAlign="center",p.textBaseline="middle",p.fillText(q,v,T)}const N=`url(${S.toDataURL()}) ${Math.round(v)} ${Math.round(T)}, crosshair`;Jn(N)},[U,De,R,y,Ve,fr,Ri,co,Nl,ut,bt,Bt,Zt,Xt,tn,Cn.toolInstanceId,Cn.color,Cn.size]),Pe.useEffect(()=>{Es()},[Es]),Pe.useEffect(()=>{Es()},[ao.width,ao.height]),Pe.useEffect(()=>{jt.size===0&&U==="draw"&&De==="trace"&&y>=1&&(ct==="top"?_(y):W(y))},[y,U,De,ct,jt]),Pe.useEffect(()=>{It(a=>a.map(r=>{if(r.type==="via"&&r.points.length>0&&r.points[0].id!==void 0){const f=r.points[0].id,m=Ml(f,ut);if(r.viaType!==m)return{...r,viaType:m}}else if(r.type==="pad"&&r.points.length>0&&r.points[0].id!==void 0){const f=r.points[0].id,m=li(f,ut);if(r.padType!==m)return{...r,padType:m}}else if(r.type==="testPoint"&&r.points.length>0&&r.points[0].id!==void 0){const f=r.points[0].id,m=Ul(f,ut),x=m.includes("Power")?"power":m.includes("Ground")?"ground":m.includes("Signal")?"signal":"unknown";if(r.testPointType!==x)return{...r,testPointType:x}}return r}))},[Ke,dt,ut,Ml,li,Ul]);const Yd=w.useCallback(()=>{const a=Ln.current;if(!a)return;const r=a.toDataURL("image/png"),f=window.open("","_blank");if(!f){alert("Please allow popups to print the canvas.");return}f.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>PCB Drawing</title>
          <style>
            @media print {
              @page {
                margin: 0;
                size: auto;
              }
              body {
                margin: 0;
                padding: 0;
              }
            }
            body {
              margin: 0;
              padding: 20px;
              display: flex;
              justify-content: center;
              align-items: center;
              background: white;
            }
            img {
              max-width: 100%;
              height: auto;
              display: block;
            }
          </style>
        </head>
        <body>
          <img src="${r}" alt="PCB Drawing" onload="window.setTimeout(function() { window.print(); }, 250);" />
        </body>
      </html>
    `),f.document.close()},[]);Pe.useEffect(()=>{const a=f=>{f.key==="Shift"&&Kr(!0)},r=f=>{f.key==="Shift"&&Kr(!1)};return window.addEventListener("keydown",a),window.addEventListener("keyup",r),()=>{window.removeEventListener("keydown",a),window.removeEventListener("keyup",r)}},[]);const yc=w.useCallback(a=>{if(a.size===0)return;const r=Array.from(a).map(f=>String(f));It(f=>f.map(m=>{if(m.type==="trace"){const x=m.points.filter(S=>S.id===void 0?!0:!a.has(S.id));return x.length<2?null:{...m,points:x}}return m}).filter(m=>m!==null)),dn(f=>f.map(m=>{const x=m.pinConnections||[];if(x.some(p=>p&&r.includes(p))){const p=x.map(v=>v&&r.includes(v)?"":v);return{...m,pinConnections:p}}return m})),zn(f=>f.map(m=>{const x=m.pinConnections||[];if(x.some(p=>p&&r.includes(p))){const p=x.map(v=>v&&r.includes(v)?"":v);return{...m,pinConnections:p}}return m}))},[It,dn,zn]),Xd=w.useRef(new Set);Pe.useEffect(()=>{const a=new Set;for(const f of $e)if((f.type==="via"||f.type==="pad")&&f.points.length>0){const m=f.points[0].id;m!==void 0&&a.add(m)}const r=new Set;for(const f of Xd.current)a.has(f)||r.add(f);r.size>0&&yc(r),Xd.current=a},[$e,yc]),Pe.useEffect(()=>{It(a=>a.map(r=>{if(r.type==="via"&&r.points.length>0&&r.points[0].id!==void 0){const f=r.points[0].id,m=Ml(f,ut);if(r.viaType!==m)return{...r,viaType:m}}else if(r.type==="pad"&&r.points.length>0&&r.points[0].id!==void 0){const f=r.points[0].id,m=li(f,ut);if(r.padType!==m)return{...r,padType:m}}else if(r.type==="testPoint"&&r.points.length>0&&r.points[0].id!==void 0){const f=r.points[0].id,m=Ul(f,ut),x=m.includes("Power")?"power":m.includes("Ground")?"ground":m.includes("Signal")?"signal":"unknown";if(r.testPointType!==x)return{...r,testPointType:x}}return r}))},[Ke,dt,ut,Ml,li,Ul]),Pe.useEffect(()=>{const a=r=>{xr.current&&(xr.current.contains(r.target)||dr(null))};return document.addEventListener("click",a),()=>document.removeEventListener("click",a)},[]),Pe.useEffect(()=>{const a=(r,f)=>{const m=r.current;if(!m)return;const x=m.getContext("2d");if(!x)return;const S=m.width,p=m.height;if(x.clearRect(0,0,S,p),x.fillStyle="#fff",x.fillRect(0,0,S,p),f?.bitmap){const v=f.bitmap,T=Math.min(S/v.width,p/v.height),k=Math.max(1,Math.floor(v.width*T)),N=Math.max(1,Math.floor(v.height*T)),Z=Math.floor((S-k)/2),re=Math.floor((p-N)/2);x.drawImage(v,Z,re,k,N)}x.strokeStyle="#ddd",x.lineWidth=1,x.strokeRect(.5,.5,S-1,p-1)};a(Ql,b),a(Xc,D)},[b,D]),Pe.useEffect(()=>{const a=[],r=[],f=[],m=[];for(const x of $e)if(x.type==="via"&&x.points.length>=1){const S=x.points[0],p={id:x.id,pointId:S.id,x:S.x,y:S.y,size:x.size,color:x.color};a.push(p)}else if(x.type==="pad"&&x.points.length>=1){const S=x.points[0],p={id:x.id,pointId:S.id,x:S.x,y:S.y,size:x.size,color:x.color,layer:x.layer||"top"};r.push(p)}else if(x.type==="trace"&&x.points.length>=2)for(let S=0;S<x.points.length-1;S++){const p=x.points[S],v=x.points[S+1],T={id:x.id,startPointId:p.id,endPointId:v.id,x1:p.x,y1:p.y,x2:v.x,y2:v.y,size:x.size,color:x.color};x.layer==="top"?f.push(T):m.push(T)}ys(a),ci(r),Fr(f),Vc(m)},[$e]);const Pr=w.useRef($e);Pr.current=$e;const ca=w.useCallback(()=>{const r=new Date().toISOString(),f=rx();return{project:{version:1,fileType:"PCB_REVERSE_ENGINEERING_AUTOSAVE",savedAt:r,view:{currentView:Se,viewScale:Ve,viewPan:At,showBothLayers:Ia,selectedDrawingLayer:ct},images:{top:b?{name:b.name,width:b.width,height:b.height,filePath:b.filePath||b.name,dataUrl:b.dataUrl,x:b.x,y:b.y,scale:b.scale,rotation:b.rotation,flipX:b.flipX,flipY:b.flipY,skewX:b.skewX,skewY:b.skewY,keystoneV:b.keystoneV,keystoneH:b.keystoneH,brightness:b.brightness??100,contrast:b.contrast??100}:null,bottom:D?{name:D.name,width:D.width,height:D.height,filePath:D.filePath||D.name,dataUrl:D.dataUrl,x:D.x,y:D.y,scale:D.scale,rotation:D.rotation,flipX:D.flipX,flipY:D.flipY,skewX:D.skewX,skewY:D.skewY,keystoneV:D.keystoneV,keystoneH:D.keystoneH,brightness:D.brightness??100,contrast:D.contrast??100}:null},projectDirectoryName:To.current?To.current.name||null:qn&&qn.name||null,drawing:{drawingStrokes:Pr.current.filter(x=>!(x.type==="trace"&&x.points.length<2)),vias:$n,tracesTop:Ec,tracesBottom:ko,componentsTop:kt,componentsBottom:gt,grounds:dt,powers:Ke},powerBuses:ut,groundBuses:Yn,pointIdCounter:jh(),designatorCounters:Nd(),autoAssignDesignators:ul,useGlobalDesignatorCounters:Aa,traceColors:{top:bt.get("trace")?.layerSettings.get("top")?.color||Re,bottom:bt.get("trace")?.layerSettings.get("bottom")?.color||fe},traceSizes:{top:bt.get("trace")?.layerSettings.get("top")?.size||se,bottom:bt.get("trace")?.layerSettings.get("bottom")?.size||O},padColors:{top:bt.get("pad")?.layerSettings.get("top")?.color||Te,bottom:bt.get("pad")?.layerSettings.get("bottom")?.color||C},padSizes:{top:bt.get("pad")?.layerSettings.get("top")?.size||H,bottom:bt.get("pad")?.layerSettings.get("bottom")?.size||We},componentColors:{top:bt.get("component")?.layerSettings.get("top")?.color||Xn,bottom:bt.get("component")?.layerSettings.get("bottom")?.color||si},componentSizes:{top:bt.get("component")?.layerSettings.get("top")?.size||bi,bottom:bt.get("component")?.layerSettings.get("bottom")?.size||vi},traceToolLayer:Bt,toolSettings:{trace:bt.get("trace")?.settings||{color:"#ff0000",size:6},via:bt.get("via")?.settings||{color:"#ff0000",size:18},pad:bt.get("pad")?.settings||{color:"#ff0000",size:18},component:bt.get("component")?.settings||{color:"#ff0000",size:18},ground:bt.get("ground")?.settings||{color:"#000000",size:18},power:bt.get("power")?.settings||{color:"#ff0000",size:18},erase:bt.get("erase")?.settings||{color:"#f5a3b3",size:18}},locks:{areImagesLocked:wi,areViasLocked:fi,arePadsLocked:Oi,areTracesLocked:pi,areComponentsLocked:_i,areGroundNodesLocked:Hi,arePowerNodesLocked:Dn},visibility:{showViasLayer:ji,showTopPadsLayer:Mn,showBottomPadsLayer:Zn,showTopTracesLayer:ti,showBottomTracesLayer:Ci,showTopComponents:dl,showBottomComponents:un,showPowerLayer:wt,showGroundLayer:an,showConnectionsLayer:la},autoSave:{enabled:Ei,interval:wa,baseName:no},projectInfo:{name:En},projectNotes:go,homeViews:pr,toolInstances:yt.getAll()},timestamp:f}},[Se,Ve,At,Ia,ct,b,D,$e,$n,Ec,ko,kt,gt,dt,bt,wi,fi,Oi,pi,_i,Hi,Dn,ut,Yn,jh,Re,fe,se,O,Te,C,H,We,Xn,si,bi,vi,Bt,Ei,wa,no,En,ji,Mn,Zn,ti,Ci,dl,un,wt,an,la,ul,Aa,go,pr]),ld=w.useRef(ca);ld.current=ca;const Ua=w.useRef(Ta);Ua.current=Ta;const Pl=w.useRef(no);Pl.current=no;const bc=w.useRef(Ii);bc.current=Ii;const ad=w.useRef(qr);ad.current=qr;const Di=w.useRef([]);Di.current=Od;const wo=w.useRef(-1);wo.current=$c;const To=w.useRef(null),vc=w.useRef(!1);Pe.useEffect(()=>{vc.current||(To.current=qn)},[qn]);const od=w.useCallback(async()=>{console.log("Auto save: performAutoSave called");let a=To.current,r=Pl.current;if(console.log(`Auto save: projectDirHandle=${a?`set (${a.name})`:"missing"}, baseName=${r||"missing"}`),!a||!r){console.warn(`Auto save: Missing project directory handle (${!a}) or base name (${!r}). Please create a new project or open an existing project first.`),Vi(!1),ln.current&&(clearInterval(ln.current),ln.current=null);return}if(!Ti.current){console.log("Auto save: Skipping - no changes since last save");return}const f=Pr.current,m=f.filter(N=>N.type==="trace"&&N.points.length<2);if(m.length>0){console.log(`Auto save: Cleaning up ${m.length} single-point trace(s) before save`),m.forEach(Z=>console.log(`  - Removing single-point trace ${Z.id}`));const N=f.filter(Z=>!(Z.type==="trace"&&Z.points.length<2));It(N),Pr.current=N}console.log("Auto save: Starting save...");const{project:x,timestamp:S}=ld.current(),v=`${Pc(r)}_${S}.json`,T=JSON.stringify(x,null,2),k=new Blob([T],{type:"application/json"});try{let N;try{N=await a.getDirectoryHandle("history",{create:!0})}catch(L){console.error("Failed to get/create history directory:",L);return}try{const L=[],K=ad.current;for await(const q of a.keys())try{if(q==="history"||q===v)continue;const Ce=await(await a.getFileHandle(q)).getFile();if(!q.endsWith(".json"))continue;const ze=await Ce.text();try{const oe=JSON.parse(ze);if(oe.version&&(oe.fileType==="PCB_REVERSE_ENGINEERING_AUTOSAVE"||!oe.fileType)){L.push(q);const He=oe.fileType?"auto-saved":"manually saved/opened";console.log(`Auto save: Found PCB project file in root: ${q} (${He}${q===K?" - this is the opened file":""})`)}}catch{continue}}catch{continue}for(const q of L)try{const ze=await(await(await a.getFileHandle(q)).getFile()).text(),He=await(await N.getFileHandle(q,{create:!0})).createWritable();await He.write(new Blob([ze],{type:"application/json"})),await He.close(),await a.removeEntry(q),console.log(`Auto save: Moved ${q} from root to history/`)}catch(xe){console.warn(`Auto save: Failed to move ${q} to history:`,xe)}}catch(L){console.warn("Auto save: Error checking for old files in root:",L)}const re=await(await a.getFileHandle(v,{create:!0})).createWritable();await re.write(k),await re.close(),console.log(`Auto save: Successfully saved ${v} to root directory`),bc.current(v);const Y=Di.current,J=[v,...Y.filter(L=>L!==v)].sort((L,K)=>K.localeCompare(L));io(J),Di.current=J,Cs(0),wo.current=0,Ti.current=!1}catch(N){console.error("Auto save failed:",N)}},[]);Qr.current=od;const es=w.useCallback(async()=>{const{project:a}=ca(),r=JSON.stringify(a,null,2),f=new Blob([r],{type:"application/json"});if(qn&&En)try{let k=null;try{k=await qn.getDirectoryHandle("history",{create:!0})}catch(K){console.error("Failed to get/create history directory:",K),k=null}const N=En.replace(/\.json$/i,""),Z=Pc(N),{timestamp:re}=ca(),Y=`${Z}_${re}.json`;if(k)try{const K=[];for await(const q of qn.keys())try{if(q==="history"||q===Y)continue;const Ce=await(await qn.getFileHandle(q)).getFile();if(!q.endsWith(".json"))continue;const ze=await Ce.text();try{JSON.parse(ze).version&&(K.push(q),console.log(`Save: Found PCB project file in root: ${q}`))}catch{continue}}catch{continue}for(const q of K)try{const ze=await(await(await qn.getFileHandle(q)).getFile()).text(),He=await(await k.getFileHandle(q,{create:!0})).createWritable();await He.write(new Blob([ze],{type:"application/json"})),await He.close(),await qn.removeEntry(q),console.log(`Save: Moved ${q} from root to history/`)}catch(xe){console.warn(`Save: Failed to move ${q} to history:`,xe)}}catch(K){console.warn("Save: Error checking for old files in root:",K)}const L=await(await qn.getFileHandle(Y,{create:!0})).createWritable();await L.write(f),await L.close(),Ii(Y),console.log(`Project saved: ${En}/${Y}`);return}catch(k){console.error("Failed to save to project directory:",k),Nn(null)}if(En&&!qn){const k=window;if(typeof k.showDirectoryPicker=="function")try{const N=await k.showDirectoryPicker();Nn(N);const Z=`${En}.json`,Y=await(await N.getFileHandle(Z,{create:!0})).createWritable();await Y.write(f),await Y.close(),Ii(Z),console.log(`Project saved: ${Z} in selected directory`);return}catch(N){N?.name!=="AbortError"&&console.error("Failed to get directory:",N)}}const m=k=>String(k).padStart(2,"0"),x=new Date,p=`pcb_project_${`${x.getFullYear()}_${m(x.getMonth()+1)}_${m(x.getDate())}_${m(x.getHours())}_${m(x.getMinutes())}_${m(x.getSeconds())}`}.json`,v=window;if(typeof v.showSaveFilePicker=="function")try{const k=await v.showSaveFilePicker({suggestedName:p,types:[{description:"PCB Project",accept:{"application/json":[".json"]}}]}),N=await k.createWritable();await N.write(f),await N.close();const Z=k.name;try{const J=await k.getFile();Ii(J.name)}catch{Ii(Z)}const Y=Z.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_");Y&&sl(Y);try{const J=k.name.replace(/\.json$/i,""),K=Pc(J).replace(/[^a-zA-Z0-9_-]/g,"_");Rl(K),Ta||console.log("Auto save: Directory handle not set. Will prompt on first auto save.")}catch(J){console.warn("Could not set up auto save for new file:",J)}return}catch(k){if(k?.name==="AbortError")return;console.warn("showSaveFilePicker failed, falling back to download",k)}const T=document.createElement("a");T.href=URL.createObjectURL(f),T.download=p,document.body.appendChild(T),T.click(),setTimeout(()=>{URL.revokeObjectURL(T.href),document.body.removeChild(T)},0)},[ca]);Pe.useEffect(()=>{ln.current&&(clearInterval(ln.current),ln.current=null);const a=ur.current;if(ur.current=Ei,Ei&&wa){const r=wa*60*1e3;Ta&&no?(console.log(`Auto save: Setting up interval for ${wa} minute(s) (${r}ms)`),a||(Ti.current=!0,setTimeout(()=>{od()},100)),ln.current&&(clearInterval(ln.current),ln.current=null),ln.current=window.setInterval(()=>{console.log("Auto save: Interval triggered, calling performAutoSave..."),console.log(`  - hasChangesSinceLastAutoSave: ${Ti.current}`),console.log(`  - dirHandle: ${Ua.current?"set":"missing"}`),console.log(`  - baseName: ${Pl.current||"missing"}`),od()},r),console.log(`Auto save: Interval set up for ${r}ms (${wa} minutes)`),console.log(`  - Directory handle: ${Ta?"set":"missing"}`),console.log(`  - Base name: ${no||"missing"}`)):(console.warn(`Auto save: Cannot set up interval - missing directory handle (${!Ta}) or base name (${!no}). Disabling auto save.`),Vi(!1),ln.current&&(clearInterval(ln.current),ln.current=null))}else Ei||(ur.current=!1);return()=>{ln.current&&(clearInterval(ln.current),ln.current=null)}},[Ei,wa,Ta,no]);const Ws=w.useRef(!1);Pe.useEffect(()=>{if(!Ei){Ws.current=!1;return}if(Ws.current){Ws.current=!1,console.log("Auto save: Skipping change tracking on first run after enable (initial save handled separately)");return}Ti.current=!0,console.log("Auto save: Change detected, marking for save",{topImage:!!b,bottomImage:!!D,drawingStrokesCount:$e.length,componentsTopCount:kt.length,componentsBottomCount:gt.length,powersCount:Ke.length,groundsCount:dt.length,powerBusesCount:ut.length,projectNotesCount:go.length,areImagesLocked:wi,areViasLocked:fi,areTracesLocked:pi,areComponentsLocked:_i,areGroundNodesLocked:Hi,arePowerNodesLocked:Dn})},[b,D,$e,kt,gt,Ke,dt,ut,go,Re,fe,se,O,wi,fi,pi,_i,Hi,Dn,Ei]),Pe.useEffect(()=>{Ei?(Ws.current=!0,console.log("Auto save: Enabled, marking first run")):Ws.current=!1},[Ei]),Pe.useEffect(()=>{Ei||(Ti.current=!1)},[Ei]);const mc=w.useCallback(()=>!!(b||D||$e.length>0||kt.length>0||gt.length>0||Ke.length>0||dt.length>0),[b,D,$e,kt,gt,Ke,dt]),ts=w.useCallback(()=>{Mo({visible:!0,projectName:"",locationPath:"",locationHandle:null})},[]),Gd=w.useCallback(async()=>{const a=window;if(typeof a.showDirectoryPicker=="function")try{const r=await a.showDirectoryPicker();Mo(f=>({...f,locationHandle:r,locationPath:r.name||"Selected folder"}))}catch(r){r?.name!=="AbortError"&&(console.error("Failed to get directory:",r),alert("Failed to select location directory."))}else alert("Directory picker is not supported in this browser. Please use a modern browser like Chrome or Edge.")},[]),sd=w.useCallback(async()=>{const a=nn.projectName.trim();if(!a){alert("Please enter a project name.");return}const r=a.replace(/[^a-zA-Z0-9_-]/g,"_")||"pcb_project";if(!nn.locationHandle){alert("Please select a location for the project.");return}const f=nn.locationHandle;let m,x;if(f.name===r)m=f,x=f;else{x=f;try{m=await x.getDirectoryHandle(r,{create:!0})}catch(S){console.error("Failed to create project folder:",S),alert(`Failed to create project folder "${r}". See console for details.`);return}}Ur(),Mo({visible:!1,projectName:"",locationPath:"",locationHandle:null}),sl(r),Nn(m),Is();try{const{project:S,timestamp:p}=ca(),T=`${Pc(r)}_${p}.json`,k=JSON.stringify(S,null,2),N=new Blob([k],{type:"application/json"}),re=await(await m.getFileHandle(T,{create:!0})).createWritable();await re.write(N),await re.close(),Ii(T),console.log(`New project created: ${r}/${T}`),hi({visible:!0,source:"new",interval:5})}catch(S){console.error("Failed to save new project:",S),alert("Failed to save new project file. See console for details.")}},[Is,ca,nn,Ur]),rd=w.useCallback(()=>{Mo({visible:!1,projectName:"",locationPath:"",locationHandle:null})},[]),Hu=w.useCallback(()=>{const a=En?`${En}.json`:"";to({visible:!0,filename:a,locationPath:"",locationHandle:null}),setTimeout(()=>{if(gi.current?.focus(),gi.current&&a){const r=a.replace(/\.json$/i,"");gi.current.setSelectionRange(0,r.length)}},100)},[En]),qd=w.useCallback(async()=>{const a=window;if(typeof a.showDirectoryPicker=="function")try{const r=await a.showDirectoryPicker();to(f=>({...f,locationHandle:r,locationPath:r.name||"Selected folder"}))}catch(r){r?.name!=="AbortError"&&(console.error("Failed to get directory:",r),alert("Failed to select location directory."))}else alert("Directory picker is not supported in this browser. Please use a modern browser that supports the File System Access API.")},[]),Fs=w.useCallback(async()=>{const a=yn.filename.trim();if(!a){alert("Please enter a file name.");return}const f=(a.endsWith(".json")?a:`${a}.json`).replace(/[^a-zA-Z0-9_.-]/g,"_");if(!yn.locationHandle){alert("Please select a location for the file.");return}const m=yn.locationHandle;try{const{project:x}=ca(),S=JSON.stringify(x,null,2),p=new Blob([S],{type:"application/json"}),T=await(await m.getFileHandle(f,{create:!0})).createWritable();await T.write(p),await T.close(),Ii(f);const k=f.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_");k&&sl(k),Nn(m),to({visible:!1,filename:"",locationPath:"",locationHandle:null}),dr(null),console.log(`Project saved as: ${f} in selected directory`)}catch(x){console.error("Failed to save project:",x),alert(`Failed to save project file "${f}". See console for details.`)}},[yn,ca]),Or=w.useCallback(()=>{to({visible:!1,filename:"",locationPath:"",locationHandle:null})},[]),$s=w.useCallback(async()=>{Ja({visible:!1}),await es(),ts(),So()},[es,ts,So]),Zd=w.useCallback(()=>{Ja({visible:!1}),ts(),So()},[ts,So]),cd=w.useCallback(()=>{Ja({visible:!1})},[]);Pe.useEffect(()=>{if(Gr.visible){setTimeout(()=>{gr.current?.focus()},0);const a=r=>{r.key==="Enter"?(r.preventDefault(),$s()):r.key==="Escape"&&(r.preventDefault(),Ja({visible:!1}))};return window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)}}},[Gr.visible,$s]);const Ba=w.useCallback(async a=>{try{if(a.toolInstances?yt.initializeFromProject(a):yt.initialize(),a.projectInfo&&a.projectInfo.name&&sl(a.projectInfo.name),a.view&&(a.view.currentView&&ye(a.view.currentView),a.view.viewScale!=null&&ll(a.view.viewScale),a.view.viewPan&&Tn(a.view.viewPan),a.view.showBothLayers!=null&&gs(a.view.showBothLayers),a.view.selectedDrawingLayer&&cn(a.view.selectedDrawingLayer)),a.homeViews?Oo(a.homeViews):a.savedCenterLocation?Oo({0:a.savedCenterLocation}):Oo({}),a.projectNotes&&Array.isArray(a.projectNotes)?Ns(a.projectNotes):Ns([]),a.traceColors&&(a.traceColors.top&&(Oe(a.traceColors.top),mt("trace",a.traceColors.top,"top")),a.traceColors.bottom&&(Ee(a.traceColors.bottom),mt("trace",a.traceColors.bottom,"bottom"))),a.traceSizes){const S=a.traceSizes.top!=null&&a.traceSizes.top>0?a.traceSizes.top:6;let p=a.traceSizes.bottom!=null&&a.traceSizes.bottom>0?a.traceSizes.bottom:6;p<6&&(p=6),_(S),W(p),qe("trace",S,"top"),qe("trace",p,"bottom")}else _(6),W(6);if(a.padColors&&(a.padColors.top&&(F(a.padColors.top),mt("pad",a.padColors.top,"top")),a.padColors.bottom&&(M(a.padColors.bottom),mt("pad",a.padColors.bottom,"bottom"))),a.padSizes){const S=a.padSizes.top!=null&&a.padSizes.top>0?a.padSizes.top:18,p=a.padSizes.bottom!=null&&a.padSizes.bottom>0?a.padSizes.bottom:18;he(S),et(p),qe("pad",S,"top"),qe("pad",p,"bottom")}if(a.componentColors&&(a.componentColors.top&&(Ui(a.componentColors.top),mt("component",a.componentColors.top,"top")),a.componentColors.bottom&&(wl(a.componentColors.bottom),mt("component",a.componentColors.bottom,"bottom"))),a.componentSizes){const S=a.componentSizes.top!=null&&a.componentSizes.top>0?a.componentSizes.top:18,p=a.componentSizes.bottom!=null&&a.componentSizes.bottom>0?a.componentSizes.bottom:18;Tl(S),ha(p),qe("component",S,"top"),qe("component",p,"bottom")}if(a.traceToolLayer&&(Wa(a.traceToolLayer),U==="draw"&&De==="trace")){const S=a.traceToolLayer;z(S==="top"?a.traceColors?.top||Re:a.traceColors?.bottom||fe);const p=a.traceSizes?.top!=null&&a.traceSizes.top>0?a.traceSizes.top:6;let v=a.traceSizes?.bottom!=null&&a.traceSizes.bottom>0?a.traceSizes.bottom:6;v<6&&(v=6),Q(S==="top"?p:v)}a.toolSettings&&Wt(S=>{const p=new Map(S);if(a.toolSettings.trace){const T=p.get("trace");if(T){const k={...T,settings:a.toolSettings.trace},N=new Map(T.layerSettings);a.traceSizes&&a.traceColors&&(N.set("top",{color:a.traceColors.top||T.layerSettings.get("top")?.color||"#AA4499",size:a.traceSizes.top||T.layerSettings.get("top")?.size||6}),N.set("bottom",{color:a.traceColors.bottom||T.layerSettings.get("bottom")?.color||"#F781BF",size:a.traceSizes.bottom||T.layerSettings.get("bottom")?.size||6})),p.set("trace",{...k,layerSettings:N})}}if(a.toolSettings.via){const T=p.get("via");T&&p.set("via",{...T,settings:a.toolSettings.via})}if(a.toolSettings.pad){const T=p.get("pad");if(T){const k={...T,settings:a.toolSettings.pad},N=new Map(T.layerSettings);a.padSizes&&a.padColors&&(N.set("top",{color:a.padColors.top||T.layerSettings.get("top")?.color||"#0072B2",size:a.padSizes.top||T.layerSettings.get("top")?.size||18}),N.set("bottom",{color:a.padColors.bottom||T.layerSettings.get("bottom")?.color||"#56B4E9",size:a.padSizes.bottom||T.layerSettings.get("bottom")?.size||18})),p.set("pad",{...k,layerSettings:N})}}if(a.toolSettings.component){const T=p.get("component");if(T){const k={...T,settings:a.toolSettings.component},N=new Map(T.layerSettings);a.componentSizes&&a.componentColors&&(N.set("top",{color:a.componentColors.top||T.layerSettings.get("top")?.color||"#6A3D9A",size:a.componentSizes.top||T.layerSettings.get("top")?.size||18}),N.set("bottom",{color:a.componentColors.bottom||T.layerSettings.get("bottom")?.color||"#9467BD",size:a.componentSizes.bottom||T.layerSettings.get("bottom")?.size||18})),p.set("component",{...k,layerSettings:N})}}if(a.toolSettings.ground){const T=p.get("ground");T&&p.set("ground",{...T,settings:a.toolSettings.ground})}if(a.toolSettings.power){const T=p.get("power");T&&p.set("power",{...T,settings:a.toolSettings.power})}if(a.toolSettings.erase){const T=p.get("erase");T&&p.set("erase",{...T,settings:a.toolSettings.erase})}const v=U==="draw"&&De==="trace"?p.get("trace"):U==="draw"&&De==="via"?p.get("via"):U==="draw"&&De==="pad"?p.get("pad"):U==="component"?p.get("component"):U==="power"?p.get("power"):U==="ground"?p.get("ground"):null;if(v)if(U==="draw"&&De==="trace"){const T=Bt||"top",k=v.layerSettings.get(T);k?(z(k.color),Q(k.size),T==="top"?(Oe(k.color),_(k.size)):(Ee(k.color),W(k.size))):(z(v.settings.color),Q(v.settings.size))}else if(U==="draw"&&De==="pad"){const T=Zt||"top",k=v.layerSettings.get(T);k?(z(k.color),Q(k.size),T==="top"?(F(k.color),he(k.size)):(M(k.color),et(k.size))):(z(v.settings.color),Q(v.settings.size))}else if(U==="component"){const T=tn||"top",k=v.layerSettings.get(T);k?(z(k.color),Q(k.size),T==="top"?(Ui(k.color),Tl(k.size)):(wl(k.color),ha(k.size))):(z(v.settings.color),Q(v.settings.size))}else z(v.settings.color),Q(v.settings.size);return p});const r=async(S,p)=>{if(!S)return null;let v=null,T="",k=S.filePath||S.name;if(k&&p)try{const Z=await(await p.getFileHandle(k)).getFile();v=await createImageBitmap(Z),T=URL.createObjectURL(Z),console.log(`Loaded image from file path: ${k}`)}catch(N){console.warn(`Failed to load image from file path ${k}, falling back to dataUrl:`,N)}if(!v&&S.dataUrl)try{const N=await(await fetch(S.dataUrl)).blob();v=await createImageBitmap(N),T=S.dataUrl,console.log("Loaded image from dataUrl (backward compatibility)")}catch(N){console.error("Failed to load image from dataUrl:",N)}return v?{url:T,name:S.name??"image",width:S.width??v.width,height:S.height??v.height,dataUrl:S.dataUrl,filePath:k,x:S.x??0,y:S.y??0,scale:S.scale??1,rotation:S.rotation??0,flipX:!!S.flipX,flipY:!!S.flipY,skewX:S.skewX??0,skewY:S.skewY??0,keystoneV:S.keystoneV??0,keystoneH:S.keystoneH??0,brightness:S.brightness??100,contrast:S.contrast??100,bitmap:v}:(console.warn("Could not load image bitmap"),null)},f=await r(a.images?.top,qn),m=await r(a.images?.bottom,qn);if(d(f),$(m),a.pointIdCounter&&typeof a.pointIdCounter=="number")Dd(a.pointIdCounter);else{let S=0;if(a.drawing?.drawingStrokes){for(const v of a.drawing.drawingStrokes)if(v.points)for(const T of v.points)T.id&&typeof T.id=="number"&&T.id>S&&(S=T.id)}const p=[...a.drawing?.componentsTop||[],...a.drawing?.componentsBottom||[]];for(const v of p)if(v.pinConnections){for(const T of v.pinConnections)if(T){const k=parseInt(T.trim(),10);!isNaN(k)&&k>S&&(S=k)}}if(a.drawing?.powers)for(const v of a.drawing.powers)v.pointId&&typeof v.pointId=="number"&&v.pointId>S&&(S=v.pointId);if(a.drawing?.grounds)for(const v of a.drawing.grounds)v.pointId&&typeof v.pointId=="number"&&v.pointId>S&&(S=v.pointId);Dd(S+1)}if(a.locks&&(typeof a.locks.areImagesLocked=="boolean"?Do(a.locks.areImagesLocked):typeof a.locks.isImagesLocked=="boolean"&&Do(a.locks.isImagesLocked),typeof a.locks.areViasLocked=="boolean"&&vs(a.locks.areViasLocked),typeof a.locks.arePadsLocked=="boolean"&&cr(a.locks.arePadsLocked),typeof a.locks.areTracesLocked=="boolean"&&Ga(a.locks.areTracesLocked),typeof a.locks.areComponentsLocked=="boolean"&&ms(a.locks.areComponentsLocked),typeof a.locks.areGroundNodesLocked=="boolean"?qa(a.locks.areGroundNodesLocked):typeof a.locks.isGroundLocked=="boolean"&&qa(a.locks.isGroundLocked),typeof a.locks.arePowerNodesLocked=="boolean"&&Ss(a.locks.arePowerNodesLocked)),a.visibility&&(typeof a.visibility.showViasLayer=="boolean"&&ei(a.visibility.showViasLayer),typeof a.visibility.showTopPadsLayer=="boolean"&&ni(a.visibility.showTopPadsLayer),typeof a.visibility.showBottomPadsLayer=="boolean"&&zi(a.visibility.showBottomPadsLayer),typeof a.visibility.showTopTracesLayer=="boolean"&&Dl(a.visibility.showTopTracesLayer),typeof a.visibility.showBottomTracesLayer=="boolean"&&ta(a.visibility.showBottomTracesLayer),typeof a.visibility.showTopComponents=="boolean"&&oo(a.visibility.showTopComponents),typeof a.visibility.showBottomComponents=="boolean"&&Lt(a.visibility.showBottomComponents),typeof a.visibility.showPowerLayer=="boolean"&&el(a.visibility.showPowerLayer),typeof a.visibility.showGroundLayer=="boolean"&&fo(a.visibility.showGroundLayer),typeof a.visibility.showConnectionsLayer=="boolean"&&aa(a.visibility.showConnectionsLayer)),a.autoSave?(typeof a.autoSave.enabled=="boolean"&&Vi(a.autoSave.enabled),typeof a.autoSave.interval=="number"&&kl(a.autoSave.interval),typeof a.autoSave.baseName=="string"&&a.autoSave.baseName?(Rl(a.autoSave.baseName),Pl.current=a.autoSave.baseName,a.autoSave.enabled&&!Ta&&(console.log("Auto save: Directory handle not available after page reload (expected). Auto save disabled. Use File -> Auto Save -> Enable to re-enable."),Vi(!1),kl(null))):a.autoSave.enabled&&(console.warn("Auto save was enabled in project file but base name is missing. Disabling auto save."),Vi(!1),kl(null),Rl(""),Pl.current="")):(Vi(!1),kl(null),ja(null),Rl(""),Ua.current=null,Pl.current="",ln.current&&(clearInterval(ln.current),ln.current=null)),a.drawing?.drawingStrokes&&Array.isArray(a.drawing.drawingStrokes)){const S=a.drawing.drawingStrokes.map(p=>({...p,points:p.points.map(v=>({...v,..._t(v)}))})).filter(p=>!(p.type==="trace"&&p.points.length<2));It(S)}else{const S=[],p=(k,N)=>{const Z=_t({x:k.x,y:k.y});S.push({id:k.id||`${Date.now()}-via-${Math.random()}`,points:[{id:k.pointId||Yi(),x:Z.x,y:Z.y}],color:k.color,size:k.size,layer:N,type:"via"})},v=(k,N)=>{const Z=_t({x:k.x1,y:k.y1}),re=_t({x:k.x2,y:k.y2});S.push({id:k.id||`${Date.now()}-trace-${Math.random()}`,points:[{id:k.startPointId||Yi(),x:Z.x,y:Z.y},{id:k.endPointId||Yi(),x:re.x,y:re.y}],color:k.color,size:k.size,layer:N,type:"trace"})};a.drawing?.vias?a.drawing.vias.forEach(k=>p(k,"top")):((a.drawing?.viasTop??[]).forEach(k=>p(k,"top")),(a.drawing?.viasBottom??[]).forEach(k=>p(k,"bottom"))),(a.drawing?.tracesTop??[]).forEach(k=>v(k,"top")),(a.drawing?.tracesBottom??[]).forEach(k=>v(k,"bottom"));const T=S.filter(k=>!(k.type==="trace"&&k.points.length<2));It(T)}if(a.drawing?.componentsTop){const S=a.drawing.componentsTop.map(p=>{const v=_t({x:p.x,y:p.y});return{...p,x:v.x,y:v.y,layer:p.layer||"top",pinConnections:p.pinConnections||new Array(p.pinCount||0).fill("")}});dn(S)}if(a.drawing?.componentsBottom){const S=a.drawing.componentsBottom.map(p=>{const v=_t({x:p.x,y:p.y});return{...p,x:v.x,y:v.y,layer:p.layer||"bottom",pinConnections:p.pinConnections||new Array(p.pinCount||0).fill("")}});zn(S)}if(a.designatorCounters&&typeof a.designatorCounters=="object"){const S=a.designatorCounters;}else{const S=[...a.drawing?.componentsTop||[],...a.drawing?.componentsBottom||[]],p={};for(const v of S)if(v.designator&&v.designator.trim()){const T=Ru(v.componentType),k=v.designator.match(new RegExp(`^${T.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(\\d+)$`));if(k){const N=parseInt(k[1],10);(!p[T]||N>p[T])&&(p[T]=N)}}Lo.current=p}if(typeof a.autoAssignDesignators=="boolean"&&On(a.autoAssignDesignators),typeof a.useGlobalDesignatorCounters=="boolean"?$o(a.useGlobalDesignatorCounters):$o(!1),Lo.current={},a.drawing?.grounds){const p=a.drawing.grounds.map(v=>{const T=v.pointId||Yi(),k=_t({x:v.x,y:v.y});return{...v,pointId:T,x:k.x,y:k.y}}).filter(v=>{const T=v.y>=0&&v.x>=0&&typeof v.x=="number"&&typeof v.y=="number"&&!isNaN(v.x)&&!isNaN(v.y)&&isFinite(v.x)&&isFinite(v.y);return T||console.warn(`Filtered out invalid ground symbol at (${v.x}, ${v.y}) - likely in border area or invalid coordinates`),T});Zi(p)}let x;if(a.powerBuses&&Array.isArray(a.powerBuses)&&a.powerBuses.length>0?(x=a.powerBuses,ui(x)):(x=[{id:"powerbus-1",name:"+3V3",voltage:"+3.3",color:"#ff0000"},{id:"powerbus-2",name:"+5V",voltage:"+5.0",color:"#ff0000"}],ui(x)),a.groundBuses&&Array.isArray(a.groundBuses)&&a.groundBuses.length>0){const S=a.groundBuses.map(p=>{const{value:v,...T}=p;return T});Pi(S)}else Pi([{id:"groundbus-circuit",name:"GND",color:"#000000"},{id:"groundbus-earth",name:"Earth Ground",color:"#333333"}]);if(a.drawing?.powers){const p=a.drawing.powers.map(v=>{const T=v.pointId||Yi(),k=_t({x:v.x,y:v.y});return v.powerBusId?{...v,pointId:T,x:k.x,y:k.y,layer:v.layer||"top"}:{...v,pointId:T,x:k.x,y:k.y,powerBusId:x.length>0?x[0].id:"default-5v",layer:v.layer||"top"}}).filter(v=>{const T=v.y>=0&&v.x>=0&&typeof v.x=="number"&&typeof v.y=="number"&&!isNaN(v.x)&&!isNaN(v.y)&&isFinite(v.x)&&isFinite(v.y);return T||console.warn(`Filtered out invalid power node at (${v.x}, ${v.y}) - likely in border area or invalid coordinates`),T});Si(p)}Ti.current=!1}catch(r){console.error("Failed to open project",r),alert("Failed to open project file. See console for details.")}},[U,De,qn,d,$,Dd,Do,vs,cr,Ga,ms,qa,Ss,ei,ni,zi,Dl,ta,oo,Lt,el,fo,aa,Vi,kl,ja,Rl,It,dn,zn,Zi,ui,Pi,Si,Yi,_t,Ru,ix,Nd,On,$o]),ns=w.useCallback(async()=>{},[qr]),Ls=w.useCallback(async a=>{const r=Ua.current;if(!r){console.warn("Cannot load file: no directory handle");return}try{const m=await(await r.getFileHandle(a)).getFile();if(m.size===0){console.warn(`File ${a} is empty, skipping`);const k=Di.current.filter(N=>N!==a);io(k),Di.current=k;return}const x=await m.text();if(!x||x.trim().length===0){console.warn(`File ${a} contains no data, skipping`);const k=Di.current.filter(N=>N!==a);io(k),Di.current=k;return}let S;try{S=JSON.parse(x)}catch(T){console.error(`Failed to parse JSON from file ${a}:`,T);const N=Di.current.filter(Z=>Z!==a);io(N),Di.current=N,await ns();return}Is(),ll(1),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),Ct(new Set),St(new Set),ht(new Set),zt(new Set),So(),await Ba(S),Ii(a);const v=Di.current.indexOf(a);v>=0?(Cs(v),wo.current=v):await ns(),Ti.current=!1}catch(f){console.error("Failed to load file from history:",f);const m=Di.current;if(m.includes(a)){const x=m.filter(S=>S!==a);io(x),Di.current=x,await ns()}}},[Ba,ns,So]);w.useCallback(async()=>{const a=wo.current,r=Di.current;if(a>=0&&a<r.length-1){const f=a+1,m=r[f];m&&await Ls(m)}},[Ls]),w.useCallback(async()=>{const a=wo.current,r=Di.current;if(a<=0||a>=r.length||r.length===0){console.warn("Cannot navigate to newer file: index is",a,"history length is",r.length);return}if(a>0&&a<r.length&&r.length>0){const f=a-1;if(f>=0&&f<r.length){const m=r[f];m?await Ls(m):(console.warn("No newer file found at index",f),await ns())}else console.warn("Cannot navigate to newer file: prevIndex",f,"is out of bounds")}},[Ls,ns]),Pe.useEffect(()=>{il.current=pt},[pt]);const Sc=Pe.useRef(De),_r=Pe.useRef(ct);Pe.useEffect(()=>{const a=De!==Sc.current;if(U==="draw"&&Sc.current==="trace"&&a){if(il.current.length>=2){const r={id:`${Date.now()}-trace-autofinalize`,points:il.current,color:R,size:y,layer:_r.current,type:"trace"};It(f=>[...f,r]),_r.current==="top"?Ya(f=>[...f,r.id]):Ne(f=>[...f,r.id])}hn([]),Xi(!1)}Sc.current=De,_r.current=ct},[De,ct,U,R,y]);const wc=Pe.useMemo(()=>["#000000","#3C3C3C","#7F7F7F","#BFBFBF","#0072B2","#56B4E9","#00BFC4","#332288","#1F77B4","#A6CEE3","#17BECF","#6A3D9A","#009E73","#B3DE69","#E69F00","#F0E442","#2CA02C","#B2DF8A","#BCBD22","#FFED6F","#E15759","#D62728","#FB9A99","#CC79A7","#AA4499","#F781BF","#9467BD","#CAB2D6","#9C755F","#8C564B","#FF7F0E","#FFFFFF"],[]);Pe.useEffect(()=>{Es()},[$e]),Pe.useEffect(()=>{Es()},[kt,gt,dt,an]);const tt=$c>0,is=w.useCallback(async()=>{const a=window;if(typeof a.showOpenFilePicker=="function")try{const[r]=await a.showOpenFilePicker({multiple:!1}),f=await r.getFile();if(!f.name.toLowerCase().endsWith(".json")){alert("Please select a .json project file.");return}Ur(),Ii(f.name);const m=await f.text(),x=JSON.parse(m);vc.current=!0;let S=null;try{if(typeof r.getParent=="function")S=await r.getParent();else{console.warn("getParent() not available. Prompting user for directory access...");const T=window;if(typeof T.showDirectoryPicker=="function")S=await T.showDirectoryPicker({startIn:"documents"});else throw new Error("Directory picker not available in this browser")}if(S)try{if((await(await S.getFileHandle(f.name)).getFile()).name!==f.name)throw new Error("Directory verification failed: file name mismatch")}catch(T){throw console.error("Directory verification failed:",T),console.error("The selected directory might not contain the opened file"),new Error("Directory verification failed - selected directory does not contain the opened file")}Nn(S),To.current=S}catch(T){console.error("Failed to get directory handle from file handle:",T)}finally{setTimeout(()=>{vc.current=!1},1e3)}const p=x.autoSave?.enabled===!0;await Ba(x);let v;if(x.projectInfo?.name?v=x.projectInfo.name:(v=f.name.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_")||"pcb_project",sl(v)),En||sl(v),p&&S){const T=v.replace(/\.json$/i,""),N=Pc(T).replace(/[^a-zA-Z0-9_-]/g,"_");ja(S),Rl(N),Ua.current=S,Pl.current=N,ln.current&&(clearInterval(ln.current),ln.current=null)}setTimeout(()=>{hi({visible:!0,source:"open",interval:5})},100)}catch(r){if(r?.name==="AbortError")return;console.warn("showOpenFilePicker failed, falling back to input",r),ql.current?.click()}else ql.current?.click()},[Ba,En,Ii,sl,Nn,hi,Ei,ja,Rl,Ur]),Pa=w.useCallback(async()=>{Ts({visible:!1}),await es(),await is()},[es,is]),Qd=w.useCallback(async()=>{Ts({visible:!1}),await is()},[is]),dd=w.useCallback(()=>{Ts({visible:!1})},[]);Pe.useEffect(()=>{if(eo.visible){setTimeout(()=>{Vo.current?.focus()},0);const a=r=>{r.key==="Enter"?(r.preventDefault(),Pa()):r.key==="Escape"&&(r.preventDefault(),Ts({visible:!1}))};return window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)}}},[eo.visible,Pa]);const Kd=w.useCallback(async()=>{mc()?Ts({visible:!0}):await is()},[mc,is]);return i.jsxs("div",{className:"app",children:[i.jsx("header",{className:"app-header",children:i.jsx("h1",{children:" PCB Reverse Engineering Tool (v2.3)"})}),i.jsx(px,{openMenu:Uu,setOpenMenu:dr,isReadOnlyMode:tt,currentProjectFilePath:qr,isProjectActive:!!qn,onNewProject:ts,onOpenProject:Kd,onSaveProject:es,onSaveAs:Hu,onPrint:Yd,hasUnsavedChanges:mc,setNewProjectDialog:Ja,setAutoSaveDialog:Xl,topImage:b,bottomImage:D,setCurrentTool:G,resetImageTransform:Jc,areImagesLocked:wi,setAreImagesLocked:Do,onEnterBoardDimensions:()=>ra(!0),fileInputTopRef:zs,fileInputBottomRef:Zr,openProjectRef:ql,increaseSize:Nr,decreaseSize:pc,brushSize:y,drawingStrokes:$e,selectedIds:jt,selectedComponentIds:at,selectedPowerIds:Ut,selectedGroundIds:Nt,componentsTop:kt,componentsBottom:gt,powers:Ke,grounds:dt,powerNodeNames:zr,groundNodeNames:kr,setSetSizeDialog:Za,areViasLocked:fi,setAreViasLocked:vs,arePadsLocked:Oi,setArePadsLocked:cr,areTestPointsLocked:Sa,setAreTestPointsLocked:Fc,areTracesLocked:pi,setAreTracesLocked:Ga,areComponentsLocked:_i,setAreComponentsLocked:ms,areGroundNodesLocked:Hi,setAreGroundNodesLocked:qa,arePowerNodesLocked:Dn,setArePowerNodesLocked:Ss,setSelectedIds:Ct,setSelectedComponentIds:St,setSelectedPowerIds:ht,setSelectedGroundIds:zt,selectAllVias:Gc,selectAllTraces:bo,selectAllPads:vo,selectAllComponents:Cr,selectDisconnectedComponents:qc,selectAllPowerNodes:Vd,selectAllGroundNodes:Id,selectPowerNodesByName:Ps,selectGroundNodesByName:ic,setShowPowerBusManager:Io,setShowGroundBusManager:Wi,setShowDesignatorManager:Sr,toolRegistry:bt,updateToolSettings:An,updateToolLayerSettings:gn,setBrushSize:Q,setBrushColor:z,saveToolSettings:zh,saveToolLayerSettings:Oc,colorPalette:wc,currentTool:U,drawingMode:De,traceToolLayer:Bt,padToolLayer:Zt,testPointToolLayer:Xt,componentToolLayer:tn,setTopTraceSize:_,setBottomTraceSize:W,setTopPadSize:he,setBottomPadSize:et,setTopTestPointSize:El,setBottomTestPointSize:Mi,setTopComponentSize:Tl,setBottomComponentSize:ha,setComponentConnectionSize:Vr,topTraceColor:Re,bottomTraceColor:fe,topPadColor:Te,bottomPadColor:C,topTestPointColor:it,bottomTestPointColor:ce,topComponentColor:Xn,bottomComponentColor:si,setTopTraceColor:Oe,setBottomTraceColor:Ee,setTopPadColor:F,setBottomPadColor:M,setTopTestPointColor:on,setBottomTestPointColor:en,setTopComponentColor:Ui,setBottomComponentColor:wl,setComponentConnectionColor:mi,saveDefaultSize:qe,saveDefaultColor:mt,menuBarRef:xr,onOpenProjectNotes:id,onOpenTransformImages:()=>js(!0)}),i.jsx("div",{style:{display:"block",padding:0,margin:0,width:"100vw",height:"calc(100vh - 70px)",boxSizing:"border-box",position:"relative"},children:i.jsxs("div",{ref:Ca,style:{position:"relative",width:"100%",height:"100%",margin:0,padding:0,boxSizing:"border-box",background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",borderRadius:"16px",overflow:"hidden"},children:[i.jsxs("div",{style:{position:"absolute",top:6,left:6,bottom:6,width:46,display:"flex",flexDirection:"column",gap:8,padding:"6px 3px",background:"rgba(250,250,255,0.95)",borderRadius:8,border:"1px solid #ddd",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:20},children:[i.jsxs("button",{onClick:()=>{tt||Vs()},onMouseDown:a=>a.currentTarget.blur(),disabled:tt,title:"Select (S)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:U==="select"?"2px solid #000":"1px solid #ddd",background:U==="select"?"#e6f0ff":"#fff",color:tt?"#999":"#222",outline:"none",cursor:tt?"not-allowed":"pointer",opacity:tt?.5:1},children:[i.jsx(Xg,{size:14}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"S"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),i.jsxs("button",{onClick:()=>{tt||(console.log("Via tool clicked"),nl("via"),G("draw"))},disabled:tt,title:"Draw Vias (V)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:U==="draw"&&De==="via"?"2px solid #000":"1px solid #ddd",background:U==="draw"&&De==="via"?"#e6f0ff":"#fff",color:tt?"#999":"#222",cursor:tt?"not-allowed":"pointer",opacity:tt?.5:1},children:[i.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const a=yt.get("via").color;return i.jsxs(i.Fragment,{children:[i.jsx("circle",{cx:"12",cy:"12",r:"8",fill:"none",stroke:a,strokeWidth:"3"}),i.jsx("circle",{cx:"12",cy:"12",r:"4",fill:a})]})})()}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"V"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:yt.get("via").size})]})]}),i.jsxs("button",{ref:mn,onClick:()=>{tt||(console.log("Pad tool clicked"),nl("pad"),G("draw"),tl(!0),cn(Zt||"top"),setTimeout(()=>nd(),0))},disabled:tt,title:"Draw Pads (P)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:U==="draw"&&De==="pad"?"2px solid #000":"1px solid #ddd",background:U==="draw"&&De==="pad"?"#e6f0ff":"#fff",color:tt?"#999":"#222",cursor:tt?"not-allowed":"pointer",opacity:tt?.5:1},children:[i.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const r=(Zt||"top")==="top"?"padTop":"padBottom",f=yt.get(r).color,m=14,x=(24-m)/2,S=(24-m)/2;return i.jsx("rect",{x,y:S,width:m,height:m,fill:f})})()}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"P"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{if(U==="draw"&&De==="pad"&&Cn.toolInstanceId&&(Cn.toolInstanceId==="padTop"||Cn.toolInstanceId==="padBottom"))return Cn.size;const a=Zt==="top"?"padTop":"padBottom";return yt.get(a).size})()})]})]}),i.jsxs("button",{ref:_s,onClick:()=>{tt||(console.log("Test Point tool clicked"),nl("testPoint"),G("draw"),qo(!0),cn(Xt||"top"),setTimeout(()=>gc(),0))},disabled:tt,title:"Draw Test Points (Y)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:U==="draw"&&De==="testPoint"?"2px solid #000":"1px solid #ddd",background:U==="draw"&&De==="testPoint"?"#e6f0ff":"#fff",color:tt?"#999":"#222",cursor:tt?"not-allowed":"pointer",opacity:tt?.5:1},children:[i.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const r=(Xt||"top")==="top"?"testPointTop":"testPointBottom",f=yt.get(r).color,m=14,x=12,S=12;return i.jsx("path",{d:`M ${x} ${S-m/2} L ${x+m/2} ${S} L ${x} ${S+m/2} L ${x-m/2} ${S} Z`,fill:f,stroke:"#000",strokeWidth:"1.5"})})()}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"Y"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{if(U==="draw"&&De==="testPoint"&&Cn.toolInstanceId&&(Cn.toolInstanceId==="testPointTop"||Cn.toolInstanceId==="testPointBottom"))return Cn.size;const a=Xt==="top"?"testPointTop":"testPointBottom";return yt.get(a).size})()})]})]}),i.jsxs("button",{ref:ac,onClick:()=>{tt||(console.log("Trace tool clicked"),nl("trace"),G("draw"),Na(!0),cn(Bt||"top"),setTimeout(()=>hc(),0))},disabled:tt,title:"Draw Traces (T)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:U==="draw"&&De==="trace"?"2px solid #000":"1px solid #ddd",background:U==="draw"&&De==="trace"?"#e6f0ff":"#fff",color:tt?"#999":"#222",cursor:tt?"not-allowed":"pointer",opacity:tt?.5:1},children:[i.jsx(qg,{size:14,color:(()=>{const r=(Bt||"top")==="top"?"traceTop":"traceBottom";return yt.get(r).color})()}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"T"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{const a=Bt==="top"?"traceTop":"traceBottom";return yt.get(a).size})()})]})]}),i.jsxs("button",{ref:Dr,onClick:()=>{tt||(console.log("Component tool clicked"),G("component"),vn(!0),st(!1),mo(null))},disabled:tt,title:"Draw Component (C)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:U==="component"?"2px solid #000":"1px solid #ddd",background:U==="component"?"#e6f0ff":"#fff",color:tt?"#999":"#222",cursor:tt?"not-allowed":"pointer",opacity:tt?.5:1},children:[(()=>{const r=(tn||"top")==="top"?"componentTop":"componentBottom",f=yt.get(r).color;return Ri?i.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[i.jsx("rect",{x:"4",y:"4",width:"16",height:"16",fill:"rgba(255,255,255,0.9)",stroke:f,strokeWidth:"1.5"}),i.jsx("text",{x:"12",y:"14",textAnchor:"middle",fontSize:"7",fill:f,fontWeight:"bold",fontFamily:"monospace",children:_f(Ri)})]}):i.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[i.jsx("rect",{x:"5",y:"3",width:"14",height:"7",fill:f,stroke:f,strokeWidth:"0.5"}),i.jsxs("g",{stroke:f,fill:"none",strokeWidth:"1.5",children:[i.jsx("rect",{x:"5",y:"10",width:"14",height:"4",rx:"1.2"}),i.jsx("path",{d:"M7 14 v4 M10 14 v4 M13 14 v4 M16 14 v4",stroke:f})]})]})})(),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"C"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{const a=tn==="top"?"componentTop":"componentBottom";return yt.get(a).size})()})]})]}),i.jsxs("button",{ref:oc,onClick:()=>{tt||(console.log("Power tool clicked"),G("power"))},disabled:tt,title:"Draw Power (B)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:U==="power"?"2px solid #000":"1px solid #ddd",background:U==="power"?"#e6f0ff":"#fff",color:tt?"#999":"#222",cursor:tt?"not-allowed":"pointer",opacity:tt?.5:1},children:[i.jsx("span",{style:{color:yt.get("power").color,fontSize:"18px",fontWeight:"bold",lineHeight:1,flexShrink:0},children:"V"}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"B"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:yt.get("power").size})]})]}),i.jsxs("button",{ref:sc,onClick:()=>{tt||(console.log("Ground tool clicked"),G("ground"))},disabled:tt,title:"Draw Ground (G)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:U==="ground"?"2px solid #000":"1px solid #ddd",background:U==="ground"?"#e6f0ff":"#fff",color:tt?"#999":"#222",cursor:tt?"not-allowed":"pointer",opacity:tt?.5:1},children:[i.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 20","aria-hidden":"true",style:{overflow:"visible",flexShrink:0},children:i.jsxs("g",{stroke:yt.get("ground").color,strokeWidth:"2",strokeLinecap:"round",children:[i.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"10"}),i.jsx("line",{x1:"5",y1:"10",x2:"19",y2:"10"}),i.jsx("line",{x1:"7",y1:"13",x2:"17",y2:"13"}),i.jsx("line",{x1:"9.5",y1:"16",x2:"14.5",y2:"16"})]})}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"G"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:yt.get("ground").size})]})]}),i.jsx("div",{style:{height:72}}),i.jsxs("button",{onClick:()=>{tt||G(a=>a==="pan"?"draw":"pan")},disabled:tt,title:"Move (H)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:6,padding:"4px 6px",borderRadius:6,border:U==="pan"?"2px solid #000":"1px solid #ddd",background:U==="pan"?"#e6f0ff":"#fff",color:tt?"#999":"#222",cursor:tt?"not-allowed":"pointer",opacity:tt?.5:1},children:[i.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:i.jsxs("g",{stroke:"#111",fill:"none",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("path",{d:"M8 11v-4c0-.8.6-1.3 1.3-1.3S11 6.2 11 7v4"}),i.jsx("path",{d:"M11 11V6.5c0-.8.6-1.3 1.3-1.3S14 5.7 14 6.5V11"}),i.jsx("path",{d:"M14 11V7.2c0-.8.6-1.3 1.3-1.3.7 0 1.3.5 1.3 1.3V12c1 .6 1.6 1.5 1.6 2.7A4.3 4.3 0 0 1 14 19H9.2A4.2 4.2 0 0 1 5 14.8V11c0-.6.4-1 .9-1 .6 0 1 .4 1 1v2"})]})}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"H"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),i.jsxs("button",{onClick:()=>{Kr(!1),G(a=>a==="magnify"?"draw":"magnify")},title:`${fr?"Zoom Out":"Zoom In"} (Z)`,style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:U==="magnify"?"2px solid #000":"1px solid #ddd",background:U==="magnify"?"#e6f0ff":"#fff",color:"#222",cursor:"pointer"},children:[i.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[i.jsx("circle",{cx:"10",cy:"10",r:"7.5",fill:"none",stroke:"#111",strokeWidth:"2"}),i.jsx("line",{x1:"15.5",y1:"15.5",x2:"21",y2:"21",stroke:"#111",strokeWidth:"2",strokeLinecap:"round"}),fr?i.jsx("line",{x1:"6.5",y1:"10",x2:"13.5",y2:"10",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"}):i.jsxs(i.Fragment,{children:[i.jsx("line",{x1:"6.5",y1:"10",x2:"13.5",y2:"10",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"}),i.jsx("line",{x1:"10",y1:"6.5",x2:"10",y2:"13.5",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"})]})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"Z"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),i.jsxs("button",{onClick:()=>{tt||(G("center"),rl(!0),bn.current&&clearTimeout(bn.current),bn.current=setTimeout(()=>{rl(!1),G("select"),Jn(void 0)},2e3))},disabled:tt,title:"Set View (X) - Press 0-9 to Set View",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:U==="center"?"2px solid #000":"1px solid #ddd",background:U==="center"?"#e6f0ff":"#fff",color:tt?"#999":"#222",cursor:tt?"not-allowed":"pointer",opacity:tt?.5:1},children:[i.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[i.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"10",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),i.jsx("line",{x1:"12",y1:"14",x2:"12",y2:"22",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),i.jsx("line",{x1:"2",y1:"12",x2:"10",y2:"12",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),i.jsx("line",{x1:"14",y1:"12",x2:"22",y2:"12",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"X"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onClick:()=>{tt||Gl(a=>!a)},disabled:tt,title:"Color Picker",style:{width:32,height:32,display:"grid",placeItems:"center",borderRadius:6,border:"1px solid #ddd",background:"#fff",cursor:tt?"not-allowed":"pointer",opacity:tt?.5:1},children:i.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 16 16","aria-hidden":"true",children:[i.jsx("rect",{x:"0",y:"0",width:"3.5",height:"3.5",fill:"#9E9E9E",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"4",y:"0",width:"3.5",height:"3.5",fill:"#0072B2",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"8",y:"0",width:"3.5",height:"3.5",fill:"#56B4E9",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"12",y:"0",width:"3.5",height:"3.5",fill:"#00BFC4",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"0",y:"4",width:"3.5",height:"3.5",fill:"#6A3D9A",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"4",y:"4",width:"3.5",height:"3.5",fill:"#2CA02C",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"8",y:"4",width:"3.5",height:"3.5",fill:"#7FC97F",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"12",y:"4",width:"3.5",height:"3.5",fill:"#FF7F0E",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"0",y:"8",width:"3.5",height:"3.5",fill:"#FFD700",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"4",y:"8",width:"3.5",height:"3.5",fill:"#FF6B6B",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"8",y:"8",width:"3.5",height:"3.5",fill:"#E74C3C",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"12",y:"8",width:"3.5",height:"3.5",fill:"#FFB6C1",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"0",y:"12",width:"3.5",height:"3.5",fill:"#DDA0DD",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"4",y:"12",width:"3.5",height:"3.5",fill:"#8B4513",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"8",y:"12",width:"3.5",height:"3.5",fill:"#A0522D",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"12",y:"12",width:"3.5",height:"3.5",fill:"#FF4500",stroke:"#ccc",strokeWidth:"0.3"})]})}),Uo&&i.jsx("div",{ref:yr,style:{position:"absolute",left:42,top:0,padding:8,background:"#fff",border:"1px solid #ddd",borderRadius:6,boxShadow:"0 8px 18px rgba(0,0,0,0.18)",zIndex:50},children:i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(8, 22px)",gap:4},children:wc.map(a=>i.jsx("div",{onClick:()=>{z(a),Gl(!1);try{let f=null;U==="draw"&&De==="via"?f="via":U==="draw"&&De==="pad"?f=(Zt||"top")==="bottom"?"padBottom":"padTop":U==="draw"&&De==="testPoint"?f=(Xt||"top")==="bottom"?"testPointBottom":"testPointTop":U==="draw"&&De==="trace"?f=(Bt||"top")==="bottom"?"traceBottom":"traceTop":U==="component"?f=(tn||"top")==="bottom"?"componentBottom":"componentTop":U==="power"?f="power":U==="ground"&&(f="ground"),f&&yt.setColor(f,a)}catch(f){console.error("Error updating tool instance color:",f)}const r=La(bt);if(r)if(U==="draw"&&De==="trace"){const f=Bt||"top",x=r.layerSettings.get(f)?.size||r.settings.size,S={color:a,size:x};gn(r.id,f,S),Oc(r.id),f==="top"?(Oe(a),mt("trace",a,"top")):(Ee(a),mt("trace",a,"bottom"))}else if(U==="draw"&&De==="pad"){const f=Zt||"top",x=r.layerSettings.get(f)?.size||r.settings.size,S={color:a,size:x};gn(r.id,f,S),Oc(r.id),f==="top"?(F(a),mt("pad",a,"top")):(M(a),mt("pad",a,"bottom"))}else if(U==="draw"&&De==="testPoint"){const f=Xt||"top",x=r.layerSettings.get(f)?.size||r.settings.size,S={color:a,size:x};gn(r.id,f,S),Oc(r.id),f==="top"?(on(a),mt("testPoint",a,"top")):(en(a),mt("testPoint",a,"bottom"))}else if(U==="component"){const f=tn||"top",x=r.layerSettings.get(f)?.size||r.settings.size,S={color:a,size:x};gn(r.id,f,S),Oc(r.id),f==="top"?(Ui(a),mt("component",a,"top")):(wl(a),mt("component",a,"bottom"))}else{const f={...r.settings,color:a};An(r.id,f),zh(r.id,a,r.settings.size),U==="draw"&&De==="via"&&mt("via",a)}mt("brush",a),jt.size>0&&It(f=>f.map(m=>jt.has(m.id)?(m.type==="via"?(mt("via",a),Wt(x=>{const S=new Map(x),p=S.get("via");return p&&S.set("via",{...p,settings:{...p.settings,color:a}}),S})):m.type==="pad"?(mt("pad",a),Wt(x=>{const S=new Map(x),p=S.get("pad");return p&&S.set("pad",{...p,settings:{...p.settings,color:a}}),S})):m.type==="trace"&&mt("trace",a,m.layer),{...m,color:a}):m)),at.size>0&&(mt("component",a),dn(f=>f.map(m=>at.has(m.id)?{...m,color:a}:m)),zn(f=>f.map(m=>at.has(m.id)?{...m,color:a}:m))),Ut.size>0&&Si(f=>f.map(m=>Ut.has(m.id)?{...m,color:a}:m)),Nt.size>0&&Zi(f=>f.map(m=>Nt.has(m.id)?{...m,color:a}:m))},title:a,style:{width:22,height:22,backgroundColor:a,border:a===R?"2px solid #333":"1px solid #ccc",cursor:"pointer"}},a))})})]})]}),U==="draw"&&De==="trace"&&Go&&i.jsxs("div",{ref:Qn,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[i.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[i.jsx("input",{type:"radio",name:"traceToolLayer",checked:Bt==="top",onChange:()=>{console.log("Trace tool Top clicked"),al.current="top",Wa("top"),cn("top"),z(Re),Q(se),Wt(a=>{const r=new Map(a),f=r.get("trace");return f&&r.set("trace",{...f,settings:{color:Re,size:se}}),r}),Na(!1),Jl(!0)}}),i.jsx("span",{children:"Top"})]}),i.jsxs("label",{className:"radio-label",children:[i.jsx("input",{type:"radio",name:"traceToolLayer",checked:Bt==="bottom",onChange:()=>{console.log("Trace tool Bottom clicked"),al.current="bottom",Wa("bottom"),cn("bottom"),z(fe),Q(O),Wt(a=>{const r=new Map(a),f=r.get("trace");return f&&r.set("trace",{...f,settings:{color:fe,size:O}}),r}),Na(!1),ea(!0)}}),i.jsx("span",{children:"Bottom"})]})]}),U==="draw"&&De==="pad"&&ki&&i.jsxs("div",{ref:pl,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[i.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[i.jsx("input",{type:"radio",name:"padToolLayer",checked:Zt==="top",onChange:()=>{console.log("Pad tool Top clicked"),jn.current="top",Wl("top"),cn("top");const a=yt.get("padTop");z(a.color),Q(a.size),Wt(r=>{const f=new Map(r),m=f.get("pad");return m&&f.set("pad",{...m,settings:{color:a.color,size:a.size}}),f}),tl(!1),Jl(!0)}}),i.jsx("span",{children:"Top"})]}),i.jsxs("label",{className:"radio-label",children:[i.jsx("input",{type:"radio",name:"padToolLayer",checked:Zt==="bottom",onChange:()=>{console.log("Pad tool Bottom clicked"),jn.current="bottom",Wl("bottom"),cn("bottom");const a=yt.get("padBottom");z(a.color),Q(a.size),Wt(r=>{const f=new Map(r),m=f.get("pad");return m&&f.set("pad",{...m,settings:{color:a.color,size:a.size}}),f}),tl(!1),ea(!0)}}),i.jsx("span",{children:"Bottom"})]})]}),U==="draw"&&De==="testPoint"&&Rr&&i.jsxs("div",{ref:ai,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[i.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[i.jsx("input",{type:"radio",name:"testPointToolLayer",checked:Xt==="top",onChange:()=>{console.log("Test Point tool Top clicked"),Fa.current="top",zl("top"),cn("top"),z(it),Q(Hn),Wt(a=>{const r=new Map(a),f=r.get("testPoint");return f&&r.set("testPoint",{...f,settings:{color:it,size:Hn}}),r}),qo(!1),Jl(!0)}}),i.jsx("span",{children:"Top"})]}),i.jsxs("label",{className:"radio-label",children:[i.jsx("input",{type:"radio",name:"testPointToolLayer",checked:Xt==="bottom",onChange:()=>{console.log("Test Point tool Bottom clicked"),Fa.current="bottom",zl("bottom"),cn("bottom"),z(ce),Q(Ni),Wt(a=>{const r=new Map(a),f=r.get("testPoint");return f&&r.set("testPoint",{...f,settings:{color:ce,size:Ni}}),r}),qo(!1),ea(!0)}}),i.jsx("span",{children:"Bottom"})]})]}),Da&&U==="power"&&i.jsxs("div",{ref:kn,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25,minWidth:"200px"},children:[i.jsx("div",{style:{marginBottom:"4px",fontWeight:600,fontSize:"12px",color:"#333"},children:"Select Power Bus:"}),ut.length===0?i.jsx("div",{style:{padding:"8px",color:"#666",fontSize:"12px"},children:"No power buses defined. Use Tools  Manage Power Buses to add one."}):[...ut].sort((a,r)=>{const f=S=>{const p=S.match(/([+-]?)(\d+\.?\d*)/);if(p){const v=p[1]||"+",T=parseFloat(p[2]);return{absValue:Math.abs(T),isNegative:v==="-",original:S}}return{absValue:1/0,isNegative:!1,original:S}},m=f(a.voltage),x=f(r.voltage);return m.absValue!==x.absValue?m.absValue-x.absValue:m.isNegative!==x.isNegative?m.isNegative?-1:1:0}).map(a=>i.jsx("button",{onClick:r=>{r.preventDefault(),r.stopPropagation(),Ds(a.id),ro(!1)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#222"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("div",{style:{width:16,height:16,borderRadius:"50%",background:a.color,border:"1px solid #ccc"}}),i.jsxs("div",{children:[i.jsx("div",{style:{fontWeight:600,fontSize:"13px"},children:a.name}),i.jsx("div",{style:{fontSize:"11px",color:"#666"},children:a.voltage})]})]})},a.id)),i.jsx("div",{style:{height:1,background:"#ddd",margin:"4px 0"}}),i.jsx("button",{onClick:a=>{a.preventDefault(),a.stopPropagation(),ro(!1),Io(!0)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"11px"},children:"Manage Power Buses"}),i.jsx("button",{onClick:a=>{a.preventDefault(),a.stopPropagation(),ro(!1),Ds(null),G("select")},style:{display:"block",width:"100%",textAlign:"center",padding:"4px 6px",marginTop:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#666",fontSize:"11px"},children:"Cancel"})]}),mr&&U==="ground"&&i.jsxs("div",{ref:Zo,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25,minWidth:"200px"},children:[i.jsx("div",{style:{marginBottom:"4px",fontWeight:600,fontSize:"12px",color:"#333"},children:"Select Ground Bus:"}),Yn.length===0?i.jsx("div",{style:{padding:"8px",color:"#666",fontSize:"12px"},children:"No ground buses defined. Use Tools  Manage Ground Buses to add one."}):[...Yn].sort((a,r)=>a.name.localeCompare(r.name)).map(a=>{const r=a.id==="groundbus-earth",f=Nl===a.id;return i.jsx("button",{onClick:m=>{m.preventDefault(),m.stopPropagation(),Fo(a.id),uo(!1)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:f?"#e0e0e0":"#f5f5f5",border:f?"2px solid #000":"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#222"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("div",{style:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:r?i.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",style:{display:"block"},children:[i.jsx("line",{x1:"10",y1:"2",x2:"10",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),i.jsx("line",{x1:"4",y1:"10",x2:"16",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),i.jsx("line",{x1:"5",y1:"12.5",x2:"15",y2:"12.5",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),i.jsx("line",{x1:"6",y1:"15",x2:"14",y2:"15",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"})]}):i.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",style:{display:"block"},children:[i.jsx("circle",{cx:"10",cy:"10",r:"6",fill:"none",stroke:"#000",strokeWidth:"2"}),i.jsx("line",{x1:"10",y1:"2",x2:"10",y2:"18",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),i.jsx("line",{x1:"2",y1:"10",x2:"18",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"})]})}),i.jsx("div",{children:i.jsx("div",{style:{fontWeight:600,fontSize:"13px"},children:a.name})})]})},a.id)}),i.jsx("div",{style:{height:1,background:"#ddd",margin:"4px 0"}}),i.jsx("button",{onClick:a=>{a.preventDefault(),a.stopPropagation(),uo(!1),Wi(!0)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"11px"},children:"Manage Ground Buses"}),i.jsx("button",{onClick:a=>{a.preventDefault(),a.stopPropagation(),uo(!1),Fo(null),G("select")},style:{display:"block",width:"100%",textAlign:"center",padding:"4px 6px",marginTop:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#666",fontSize:"11px"},children:"Cancel"})]}),U==="component"&&Ft&&i.jsxs("div",{ref:gl,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[i.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[i.jsx("input",{type:"radio",name:"componentToolLayer",checked:ct==="top",onClick:()=>{console.log("Component tool Top clicked"),$a.current="top",Fl("top"),cn("top"),z(Xn),Q(bi),Wt(a=>{const r=new Map(a),f=r.get("component");return f&&r.set("component",{...f,settings:{color:Xn,size:bi}}),r}),vn(!1),Jl(!0),st(!0)}}),i.jsx("span",{children:"Top"})]}),i.jsxs("label",{className:"radio-label",children:[i.jsx("input",{type:"radio",name:"componentToolLayer",checked:ct==="bottom",onClick:()=>{console.log("Component tool Bottom clicked"),$a.current="bottom",Fl("bottom"),cn("bottom"),z(si),Q(vi),Wt(a=>{const r=new Map(a),f=r.get("component");return f&&r.set("component",{...f,settings:{color:si,size:vi}}),r}),vn(!1),ea(!0),st(!0)}}),i.jsx("span",{children:"Bottom"})]})]}),U==="component"&&hl&&i.jsxs("div",{ref:Os,style:{position:"absolute",top:44,left:52,padding:"8px",background:"#fff",border:"1px solid #ddd",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:26,maxHeight:"500px",overflowY:"auto",minWidth:"250px",maxWidth:"350px"},children:[i.jsx("div",{style:{marginBottom:"8px",fontWeight:600,fontSize:"13px",color:"#333",borderBottom:"1px solid #eee",paddingBottom:"6px"},children:"Select Component Type:"}),Object.entries(Jg).map(([a,r])=>{const f=Qo.has(a);return i.jsxs("div",{style:{marginBottom:"4px"},children:[i.jsxs("button",{onClick:m=>{m.preventDefault(),m.stopPropagation(),lc(x=>{const S=new Set(x);return S.has(a)?S.delete(a):S.add(a),S})},style:{display:"flex",alignItems:"center",width:"100%",textAlign:"left",padding:"6px 8px",background:f?"#f0f0f0":"#fff",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",fontSize:"12px",fontWeight:600,color:"#333"},children:[i.jsx("span",{style:{marginRight:"6px",fontSize:"10px"},children:f?"":""}),a]}),f&&i.jsx("div",{style:{marginLeft:"12px",marginTop:"2px",marginBottom:"4px"},children:Object.entries(r).map(([m,x])=>i.jsxs("div",{style:{marginBottom:"2px"},children:[i.jsxs("div",{style:{fontSize:"11px",fontWeight:500,color:"#666",padding:"2px 4px",marginBottom:"2px"},children:[m,":"]}),x.map(S=>{const p=Ud[S];return p?i.jsxs("button",{onClick:v=>{v.preventDefault(),v.stopPropagation(),mo(S),st(!1)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 8px 4px 16px",marginBottom:"2px",background:Ri===S?"#e6f0ff":"#fff",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",fontSize:"11px",color:"#333"},children:[p.prefix.join(", ")," - ",Md(S)]},S):null})]},m))})]},a)}),i.jsx("button",{onClick:a=>{a.preventDefault(),a.stopPropagation(),st(!1),G("select")},style:{display:"block",width:"100%",textAlign:"center",padding:"6px 10px",marginTop:"8px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#222"},children:"Cancel"})]}),i.jsxs("div",{style:{position:"absolute",top:6,left:60,bottom:6,width:168,padding:6,display:"flex",flexDirection:"column",gap:2,background:"rgba(250,250,255,0.95)",borderRadius:8,border:"1px solid #ddd",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:3},children:[i.jsx("div",{style:{fontSize:11,fontWeight:700,color:"#333",marginBottom:2},children:"Layers"}),i.jsxs("div",{onClick:()=>cn("top"),title:"Top layer",style:{cursor:"pointer",padding:2,borderRadius:4,border:Ht==="top"?"2px solid #0b5fff":"1px solid #ddd",background:"#fff"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:2},children:[i.jsx("div",{style:{fontSize:10,color:"#444",fontWeight:600},children:"Top Image"}),i.jsx("label",{className:"radio-label",style:{margin:0},children:i.jsx("input",{type:"checkbox",checked:Kl,onChange:a=>Jl(a.target.checked)})})]}),i.jsx("canvas",{ref:Ql,width:60,height:40,style:{width:"60px",height:"40px"}})]}),i.jsxs("div",{onClick:()=>cn("bottom"),title:"Bottom layer",style:{cursor:"pointer",padding:2,borderRadius:4,border:Ht==="bottom"?"2px solid #0b5fff":"1px solid #ddd",background:"#fff"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:2},children:[i.jsx("div",{style:{fontSize:10,color:"#444",fontWeight:600},children:"Bottom Image"}),i.jsx("label",{className:"radio-label",style:{margin:0},children:i.jsx("input",{type:"checkbox",checked:br,onChange:a=>ea(a.target.checked)})})]}),i.jsx("canvas",{ref:Xc,width:60,height:40,style:{width:"60px",height:"40px"}})]}),i.jsx("div",{style:{height:1,background:"#e9e9ef",margin:"2px 0"}}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:ji,onChange:a=>ei(a.target.checked)}),i.jsx("span",{children:"Vias"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:Mn,onChange:a=>ni(a.target.checked)}),i.jsx("span",{children:"Pads (Top)"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:ii,onChange:a=>cl(a.target.checked)}),i.jsx("span",{children:"Test Points (Top)"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:ti,onChange:a=>Dl(a.target.checked)}),i.jsx("span",{children:"Traces (Top)"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:dl,onChange:a=>oo(a.target.checked)}),i.jsx("span",{children:"Components (Top)"})]}),i.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:Zn,onChange:a=>zi(a.target.checked)}),i.jsx("span",{children:"Pads (Bottom)"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:Ra,onChange:a=>Rs(a.target.checked)}),i.jsx("span",{children:"Test Points (Bottom)"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:Ci,onChange:a=>ta(a.target.checked)}),i.jsx("span",{children:"Traces (Bottom)"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:un,onChange:a=>Lt(a.target.checked)}),i.jsx("span",{children:"Components (Bottom)"})]}),i.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:wt,onChange:a=>el(a.target.checked)}),i.jsx("span",{children:"Power"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:an,onChange:a=>fo(a.target.checked)}),i.jsx("span",{children:"Ground"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:la,onChange:a=>aa(a.target.checked)}),i.jsx("span",{children:"Connections"})]}),i.jsx("div",{style:{height:1,background:"#e9e9ef",margin:"2px 0"}}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:ji&&Mn&&Zn&&ii&&Ra&&ti&&Ci&&dl&&un&&wt&&an&&la,onChange:a=>{const r=a.target.checked;ei(r),ni(r),zi(r),cl(r),Rs(r),Dl(r),ta(r),oo(r),Lt(r),el(r),fo(r),aa(r)}}),i.jsx("span",{style:{fontWeight:600,fontSize:11},children:"Select All Layers"})]}),i.jsxs("div",{style:{marginTop:6},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i.jsxs("label",{style:{fontSize:10,color:"#333"},children:["Transparency: ",g,"%"]}),i.jsxs("label",{className:"radio-label",style:{margin:0},children:[i.jsx("input",{type:"checkbox",checked:ue,onChange:a=>{const r=a.target.checked;r?(Jl(!0),ea(!0)):(I(50),G("select")),ve(r)}}),i.jsx("span",{style:{marginLeft:6,fontSize:10},children:"Cycle"})]})]}),i.jsx("input",{type:"range",min:"0",max:"100",value:g,onChange:a=>I(Number(a.target.value)),onDoubleClick:()=>xc("transparency"),className:"slider",style:{width:"100%",marginTop:3}}),ue&&i.jsxs("div",{style:{marginTop:6},children:[i.jsxs("label",{style:{fontSize:10,color:"#333"},children:["Cycle Speed: ",(je/1e3).toFixed(1),"s"]}),i.jsx("input",{type:"range",min:"500",max:"8000",step:"100",value:8500-je,onChange:a=>Ae(8500-Number(a.target.value)),onDoubleClick:()=>Ae(2e3),className:"slider",style:{width:"100%",marginTop:3}})]})]})]}),i.jsx(hx,{visible:!b&&!D}),i.jsx("canvas",{ref:Ln,width:ao.width,height:ao.height,tabIndex:0,onMouseDown:Qc,onMouseMove:Fd,onMouseUp:Kc,onMouseLeave:Kc,onWheel:Ma,onDoubleClick:dc,className:`pcb-canvas ${U==="transform"?"transform-cursor":U==="draw"?"draw-cursor":U==="erase"?"erase-cursor":"default-cursor"}`,style:{position:"absolute",left:"244px",top:"6px",...or?{cursor:or}:U==="pan"?{cursor:Ki?"grabbing":"grab"}:{},width:`${ao.width}px`,height:`${ao.height}px`,maxHeight:"none",aspectRatio:"auto",border:"none"}}),i.jsx(Tx,{componentEditor:$l,setComponentEditor:Ll,componentsTop:kt,componentsBottom:gt,setComponentsTop:dn,setComponentsBottom:zn,connectingPin:di,setConnectingPin:ba,componentDialogPosition:Yl,setComponentDialogPosition:va,isDraggingDialog:bs,setIsDraggingDialog:Wc,dialogDragOffset:Gn,setDialogDragOffset:Xa,areComponentsLocked:_i,setSelectedComponentIds:St,setNotesDialogVisible:$i}),Zl&&_o&&(()=>{const a=Zl.component,r=Zl.layer;if(!a)return null;const f=a.componentType||"Component",m=a.componentType==="IntegratedCircuit"&&"icType"in a?a.icType:null,x=Wd(a);return i.jsxs("div",{style:{position:"fixed",left:`${Zl.x+10}px`,top:`${Zl.y+10}px`,background:"rgba(0, 0, 0, 0.85)",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:"12px",lineHeight:"1.4",zIndex:1e4,pointerEvents:"none",width:"max-content",maxWidth:"400px",minWidth:"150px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)",wordWrap:"break-word",overflowWrap:"break-word"},children:[i.jsx("div",{style:{fontWeight:600,marginBottom:"4px"},children:Md(f)}),i.jsxs("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:["Layer: ",r==="top"?"Top":"Bottom"]}),m&&i.jsxs("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:["IC Type: ",m]}),x.length>0&&i.jsx("div",{style:{marginBottom:"4px"},children:x.map((S,p)=>i.jsx("div",{style:{color:"#e0e0e0",fontSize:"11px",marginBottom:"2px"},children:S},p))}),a.description&&i.jsx("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:a.description}),a.notes&&i.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid rgba(255,255,255,0.2)",fontSize:"11px",color:"#d0d0d0",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:a.notes})]})})(),Ho&&_o&&(()=>{const a=Ho.stroke;return a.notes?i.jsxs("div",{style:{position:"fixed",left:`${Ho.x+10}px`,top:`${Ho.y+10}px`,background:"rgba(0, 0, 0, 0.85)",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:"12px",lineHeight:"1.4",zIndex:1e4,pointerEvents:"none",width:"max-content",maxWidth:"400px",minWidth:"150px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)",wordWrap:"break-word",overflowWrap:"break-word"},children:[i.jsx("div",{style:{fontWeight:600,marginBottom:"4px"},children:"Test Point"}),i.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid rgba(255,255,255,0.2)",fontSize:"11px",color:"#d0d0d0",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:a.notes})]}):null})(),Qi&&Qi.visible&&(()=>{if(!Ke.find(f=>f.id===Qi.id))return null;const r=ut.find(f=>f.id===Qi.powerBusId);return i.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#fff",border:"1px solid #0b5fff",borderRadius:4,padding:"6px",boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"175px",maxWidth:"250px",maxHeight:"40vh",overflowY:"auto",pointerEvents:"auto"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"5px"},children:[i.jsx("h3",{style:{margin:0,fontSize:"12px",color:"#333",fontWeight:600},children:"Power Properties"}),i.jsx("button",{onClick:()=>ma(null),style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#666",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Power Bus:"}),i.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:r?`${r.name} (${r.voltage})`:"Unknown"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:`power-layer-${Qi.id}`,style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Layer:"}),i.jsxs("select",{id:`power-layer-${Qi.id}`,name:`power-layer-${Qi.id}`,value:Qi.layer,onChange:f=>ma({...Qi,layer:f.target.value}),disabled:Dn,style:{width:"100%",padding:"2px 3px",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",opacity:Dn?.6:1},children:[i.jsx("option",{value:"top",children:"Top"}),i.jsx("option",{value:"bottom",children:"Bottom"})]})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"X:"}),i.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:Qi.x.toFixed(2)})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Y:"}),i.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:Qi.y.toFixed(2)})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"3px",marginTop:"6px"},children:[i.jsx("button",{onClick:()=>ma(null),style:{padding:"2px 5px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,cursor:"pointer",fontSize:"10px",color:"#333"},children:"Cancel"}),i.jsx("button",{onClick:()=>{Dn||(Si(f=>f.map(m=>m.id===Qi.id?{...m,layer:Qi.layer}:m)),ma(null))},disabled:Dn,style:{padding:"2px 5px",background:Dn?"#f5f5f5":"#0b5fff",color:Dn?"#999":"#fff",border:"1px solid #ddd",borderRadius:2,cursor:Dn?"not-allowed":"pointer",fontSize:"10px"},children:"Save"})]})]})})(),!b&&!D&&i.jsx("div",{className:"placeholder"})]})}),so&&i.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#fff",border:"1px solid #ddd",borderRadius:6,padding:"8px",zIndex:1e3,minWidth:"280px",maxWidth:"320px",maxHeight:"80vh",overflowY:"auto",boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[i.jsx("h2",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#222"},children:"Manage Power Buses"}),i.jsx("button",{onClick:()=>Io(!1),style:{background:"transparent",border:"none",fontSize:"18px",cursor:"pointer",color:"#666",padding:0,width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsx("div",{style:{marginBottom:"12px"},children:(()=>{const a=ut.filter(x=>x.id!==vr),r=ut.find(x=>x.id===vr),f=[...a].sort((x,S)=>{const p=k=>{const N=k.match(/([+-]?)(\d+\.?\d*)/);if(N){const Z=N[1]||"+",re=parseFloat(N[2]);return{absValue:Math.abs(re),isNegative:Z==="-",original:k}}return{absValue:1/0,isNegative:!1,original:k}},v=p(x.voltage),T=p(S.voltage);return v.absValue!==T.absValue?v.absValue-T.absValue:v.isNegative!==T.isNegative?v.isNegative?-1:1:0});return(r?[...f,r]:f).map(x=>{const S=ut.findIndex(T=>T.id===x.id),p=ut.some(T=>T.name===x.name&&T.id!==x.id),v=ut.some(T=>T.voltage===x.voltage&&T.id!==x.id);return i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",padding:"4px",marginBottom:"4px",background:"#f9f9f9",borderRadius:4,border:"1px solid #e0e0e0"},children:[i.jsx("div",{style:{width:16,height:16,borderRadius:"50%",background:x.color,border:"1px solid #ccc",flexShrink:0}}),i.jsxs("div",{style:{flex:1,minWidth:0,display:"flex",flexDirection:"column",gap:"4px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("div",{style:{fontSize:"10px",color:"#666",width:"40px",flexShrink:0},children:"Name"}),i.jsx("input",{type:"text",value:x.name,onChange:T=>{const k=[...ut];k[S]={...x,name:T.target.value},ui(k)},onFocus:()=>{na(x.id)},placeholder:"e.g., +3V3, -3V3",style:{flex:1,padding:"2px 4px",border:p?"1px solid #ff0000":"1px solid #ccc",borderRadius:3,fontSize:"11px"}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("div",{style:{fontSize:"10px",color:"#666",width:"40px",flexShrink:0},children:"Value"}),i.jsx("input",{type:"text",inputMode:"decimal",value:x.voltage,onChange:T=>{const k=T.target.value;if(k===""||/^[+-]?\d*\.?\d*$/.test(k)){const N=[...ut];N[S]={...x,voltage:k},ui(N)}},onBlur:T=>{const k=T.target.value.trim();if(k===""){vr===x.id&&na(null);return}const N=parseFloat(k);if(!isNaN(N)){const Z=N>=0?"+":"-",re=Math.abs(N),Y=`${Z}${re.toFixed(1).replace(/\.?0+$/,"")}`,J=[...ut];J[S]={...x,voltage:Y},ui(J),vr===x.id&&na(null)}},onFocus:()=>{na(x.id)},placeholder:"e.g., +3.3, -3.3",style:{flex:1,padding:"2px 4px",border:v?"1px solid #ff0000":"1px solid #ccc",borderRadius:3,fontSize:"11px"}})]})]}),i.jsx("input",{type:"color",value:x.color,onChange:T=>{const k=[...ut];k[S]={...x,color:T.target.value},ui(k)},style:{width:"28px",height:"28px",border:"1px solid #ccc",borderRadius:3,cursor:"pointer",flexShrink:0}}),i.jsx("button",{onClick:()=>{const T=Ke.filter(k=>k.powerBusId===x.id);if(T.length>0){alert(`Cannot delete: ${T.length} power node(s) are using this bus. Remove or reassign them first.`);return}ui(k=>k.filter(N=>N.id!==x.id))},style:{padding:"3px 6px",background:"#e0e0e0",color:"#333",border:"1px solid #ccc",borderRadius:3,cursor:"pointer",fontSize:"10px",flexShrink:0},children:"Delete"})]},x.id)})})()}),i.jsx("button",{onClick:()=>{const a={id:`powerbus-${Date.now()}-${Math.random()}`,name:"New Power Bus",voltage:"+0.0",color:"#ff0000"};ui(r=>[...r,a]),na(a.id)},style:{width:"100%",padding:"4px 8px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:4,cursor:"pointer",fontSize:"11px",marginBottom:"6px"},children:"+ Add Power Bus"}),i.jsx("button",{onClick:()=>Io(!1),style:{width:"100%",padding:"4px 8px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:4,cursor:"pointer",fontSize:"11px"},children:"Close"})]}),Wo&&i.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#fff",border:"1px solid #ddd",borderRadius:6,padding:"8px",zIndex:1e3,minWidth:"280px",maxWidth:"320px",maxHeight:"80vh",overflowY:"auto",boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[i.jsx("h2",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#222"},children:"Manage Ground Buses"}),i.jsx("button",{onClick:()=>Wi(!1),style:{background:"transparent",border:"none",fontSize:"18px",cursor:"pointer",color:"#666",padding:0,width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsx("div",{style:{marginBottom:"12px"},children:(()=>{const a=Yn.filter(x=>x.id!==ia),r=Yn.find(x=>x.id===ia),f=[...a].sort((x,S)=>x.name.localeCompare(S.name));return(r?[...f,r]:f).map(x=>{const S=Yn.findIndex(v=>v.id===x.id),p=Yn.some(v=>v.name===x.name&&v.id!==x.id);return i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",padding:"4px",marginBottom:"4px",background:"#f9f9f9",borderRadius:4,border:"1px solid #e0e0e0"},children:[i.jsx("div",{style:{width:16,height:16,borderRadius:"50%",background:x.color,border:"1px solid #ccc",flexShrink:0}}),i.jsx("div",{style:{flex:1,minWidth:0},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("div",{style:{fontSize:"10px",color:"#666",width:"40px",flexShrink:0},children:"Name"}),i.jsx("input",{type:"text",value:x.name,onChange:v=>{const T=[...Yn];T[S]={...x,name:v.target.value},Pi(T)},onFocus:()=>{Al(x.id)},onBlur:()=>{ia===x.id&&Al(null)},placeholder:"e.g., GND, Earth",style:{flex:1,padding:"2px 4px",border:p?"1px solid #ff0000":"1px solid #ccc",borderRadius:3,fontSize:"11px"}})]})}),i.jsx("input",{type:"color",value:x.color,onChange:v=>{const T=[...Yn];T[S]={...x,color:v.target.value},Pi(T)},style:{width:"28px",height:"28px",border:"1px solid #ccc",borderRadius:3,cursor:"pointer",flexShrink:0}}),i.jsx("button",{onClick:()=>{const v=dt.filter(T=>T.groundBusId===x.id);if(v.length>0){alert(`Cannot delete: ${v.length} ground node(s) are using this bus. Remove or reassign them first.`);return}Pi(T=>T.filter(k=>k.id!==x.id))},style:{padding:"3px 6px",background:"#e0e0e0",color:"#333",border:"1px solid #ccc",borderRadius:3,cursor:"pointer",fontSize:"10px",flexShrink:0},children:"Delete"})]},x.id)})})()}),i.jsx("button",{onClick:()=>{const a={id:`groundbus-${Date.now()}-${Math.random()}`,name:"New Ground Bus",color:"#000000"};Pi(r=>[...r,a]),Al(a.id)},style:{width:"100%",padding:"4px 8px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:4,cursor:"pointer",fontSize:"11px",marginBottom:"6px"},children:"+ Add Ground Bus"}),i.jsx("button",{onClick:()=>Wi(!1),style:{width:"100%",padding:"4px 8px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:4,cursor:"pointer",fontSize:"11px"},children:"Close"})]}),Ou&&i.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#fff",border:"1px solid #ddd",borderRadius:6,padding:"16px",zIndex:1e3,minWidth:"300px",maxWidth:"400px",boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[i.jsx("h2",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#222"},children:"Manage Designators"}),i.jsx("button",{onClick:()=>Sr(!1),style:{background:"transparent",border:"none",fontSize:"18px",cursor:"pointer",color:"#666",padding:0,width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:"13px",color:"#333",marginBottom:"12px"},children:[i.jsx("input",{type:"checkbox",checked:ul,onChange:a=>{const r=a.target.checked;On(r)},style:{width:"16px",height:"16px",cursor:"pointer"}}),i.jsx("span",{children:"Automatically assign designators"})]}),i.jsx("div",{style:{marginTop:"8px",padding:"8px",background:"#f5f5f5",borderRadius:4,fontSize:"11px",color:"#666",lineHeight:"1.4",marginBottom:"12px"},children:ul?i.jsx("div",{children:"When enabled, new components automatically receive sequential designators (e.g., C1, C2, C3 for Capacitors; R1, R2, R3 for Resistors)."}):i.jsx("div",{children:"When disabled, you must manually assign designators to each component. The designator field will be empty when components are created."})}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:"13px",color:"#333"},children:[i.jsx("input",{type:"checkbox",checked:Aa,onChange:a=>{const r=a.target.checked;$o(r)},style:{width:"16px",height:"16px",cursor:"pointer"}}),i.jsx("span",{children:"Use global designator counters"})]}),i.jsx("div",{style:{marginTop:"8px",padding:"8px",background:"#f5f5f5",borderRadius:4,fontSize:"11px",color:"#666",lineHeight:"1.4"},children:Aa?i.jsx("div",{children:"When ON, designators continue from global counters across all projects. New components start with the next value from the global counter (e.g., if global counter is C10, new capacitor will be C11)."}):i.jsx("div",{children:"When OFF (default), designators start at 1 for each project. Each project maintains its own independent designator sequence (e.g., C1, C2, C3...)."})})]}),i.jsx("button",{onClick:()=>Sr(!1),style:{width:"100%",padding:"6px 12px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:4,cursor:"pointer",fontSize:"12px"},children:"Close"})]}),i.jsx("input",{ref:zs,type:"file",accept:"image/*",style:{display:"none"},onChange:a=>{const r=a.target.files?.[0];r&&Ar(r,"top"),a.target.value=""}}),i.jsx("input",{ref:Zr,type:"file",accept:"image/*",style:{display:"none"},onChange:a=>{const r=a.target.files?.[0];r&&Ar(r,"bottom"),a.target.value=""}}),i.jsx("input",{ref:ql,type:"file",accept:".json,application/json",style:{display:"none"},onChange:async a=>{const r=a.target.files?.[0];if(r)try{Ii(r.name);const f=await r.text(),m=JSON.parse(f);await Ba(m);let x;m.projectInfo?.name?x=m.projectInfo.name:(x=r.name.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_")||"pcb_project",sl(x)),En||sl(x),setTimeout(()=>{hi({visible:!0,source:"open",interval:5})},100)}catch(f){console.error("Failed to open project",f),alert("Failed to open project file. See console for details.")}a.target.value=""}}),i.jsx(xx,{visible:ws.visible,selectedIds:jt,selectedComponentIds:at,selectedPowerIds:Ut,selectedGroundIds:Nt,drawingStrokes:$e,componentsTop:kt,componentsBottom:gt,powers:Ke,grounds:dt,powerBuses:ut,onClose:()=>{Ka({visible:!1,text:""})},setComponentsTop:dn,setComponentsBottom:zn,determineViaType:Ml,determinePadType:li,determineTestPointType:Ul,onFindComponent:Zc,onOpenNotesDialog:()=>$i(!0),position:Fi,isDragging:po,onDragStart:a=>{Fi&&(Hd({x:a.clientX-Fi.x,y:a.clientY-Fi.y}),_d(!0),a.preventDefault())}}),i.jsx(yx,{visible:Jr,selectedIds:jt,selectedComponentIds:at,selectedPowerIds:Ut,selectedGroundIds:Nt,drawingStrokes:$e,componentsTop:kt,componentsBottom:gt,powers:Ke,grounds:dt,powerBuses:ut,onClose:()=>{$i(!1)},setComponentsTop:dn,setComponentsBottom:zn,setDrawingStrokes:It,setPowerSymbols:Si,setGroundSymbols:Zi,determineViaType:Ml,determinePadType:li,determineTestPointType:Ul,position:ho,isDragging:ec,onDragStart:a=>{ho&&(Tr({x:a.clientX-ho.x,y:a.clientY-ho.y}),Xo(!0),a.preventDefault())}}),i.jsx(bx,{visible:tc,projectNotes:go,setProjectNotes:Ns,onClose:()=>{sa(!1)},position:fl,isDragging:nc,onDragStart:a=>{fl?(Us({x:a.clientX-fl.x,y:a.clientY-fl.y}),xo(!0),a.preventDefault()):(Ms({x:a.clientX-300,y:a.clientY-200}),Us({x:300,y:200}),xo(!0),a.preventDefault())}}),Gr.visible&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001},onClick:a=>{a.target===a.currentTarget&&cd()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:a=>a.stopPropagation(),children:[i.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"New Project"}),i.jsx("p",{style:{margin:"0 0 24px 0",fontSize:"14px",color:"#e0e0e0",lineHeight:"1.5"},children:"You have unsaved changes. Do you want to save your project before creating a new one?"}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[i.jsx("button",{onClick:cd,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:Zd,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"No"}),i.jsx("button",{ref:gr,onClick:$s,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},autoFocus:!0,children:"Yes"})]})]})}),eo.visible&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001},onClick:a=>{a.target===a.currentTarget&&dd()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:a=>a.stopPropagation(),children:[i.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Open Project"}),i.jsx("p",{style:{margin:"0 0 24px 0",fontSize:"14px",color:"#e0e0e0",lineHeight:"1.5"},children:"You have unsaved changes. Do you want to save your project before opening another one?"}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[i.jsx("button",{onClick:dd,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:Qd,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"No"}),i.jsx("button",{ref:Vo,onClick:Pa,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},autoFocus:!0,children:"Yes"})]})]})}),nn.visible&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10002},onClick:a=>{a.target===a.currentTarget&&rd()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:a=>a.stopPropagation(),children:[i.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"New Project"}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Project Name:"}),i.jsx("input",{ref:Pu,type:"text",value:nn.projectName,onChange:a=>{Mo(r=>({...r,projectName:a.target.value}))},onKeyDown:a=>{a.key==="Enter"?(a.preventDefault(),sd()):a.key==="Escape"&&(a.preventDefault(),rd())},style:{width:"100%",padding:"8px 12px",marginBottom:"8px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},placeholder:"e.g., my_pcb_project",autoFocus:!0}),nn.projectName&&(()=>{const a=nn.projectName.match(/[^a-zA-Z0-9_-]/g);if(a){const r=[...new Set(a)];return i.jsxs("div",{style:{marginBottom:"12px",padding:"6px 10px",background:"#3a1f1f",border:"1px solid #a44",borderRadius:4,fontSize:"12px",color:"#ffaaaa"},children:["Invalid characters: ",r.map(f=>`"${f}"`).join(", "),". Only letters, numbers, underscore (_), and hyphen (-) are allowed."]})}return null})(),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Location:"}),i.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[i.jsx("input",{type:"text",value:nn.locationPath||"Not selected",readOnly:!0,style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:nn.locationPath?"#f2f2f2":"#888",fontSize:"14px",cursor:"not-allowed"},placeholder:"Select a location..."}),i.jsx("button",{onClick:Gd,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500,whiteSpace:"nowrap"},children:"Browse..."})]}),nn.projectName&&nn.locationPath&&i.jsxs("div",{style:{marginBottom:"20px",padding:"8px 12px",background:"#1a1a1f",border:"1px solid #333",borderRadius:6,fontSize:"12px",color:"#aaa",fontFamily:"monospace"},children:[i.jsx("div",{style:{marginBottom:"4px",color:"#888"},children:"Project will be created at:"}),i.jsx("div",{style:{color:"#4CAF50"},children:(()=>{if(!nn.projectName||!nn.locationPath)return"";const r=nn.projectName.trim().replace(/[^a-zA-Z0-9_-]/g,"_")||"pcb_project",f=`${r}.json`;return nn.locationPath===r?`${nn.locationPath}/${f}`:`${nn.locationPath}/${r}/${f}`})()})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[i.jsx("button",{onClick:rd,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:sd,disabled:!nn.projectName.trim()||!nn.locationHandle,style:{padding:"8px 16px",background:!nn.projectName.trim()||!nn.locationHandle?"#555":"#4CAF50",color:"#fff",border:"1px solid "+(!nn.projectName.trim()||!nn.locationHandle?"#666":"#45a049"),borderRadius:6,cursor:!nn.projectName.trim()||!nn.locationHandle?"not-allowed":"pointer",fontSize:"14px",fontWeight:600,opacity:!nn.projectName.trim()||!nn.locationHandle?.6:1},children:"Create"})]})]})}),yn.visible&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10002},onClick:a=>{a.target===a.currentTarget&&Or()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:a=>a.stopPropagation(),children:[i.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Save As"}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"File Name:"}),i.jsx("input",{ref:gi,type:"text",value:yn.filename,onChange:a=>{to(r=>({...r,filename:a.target.value}))},onKeyDown:a=>{a.key==="Enter"?(a.preventDefault(),Fs()):a.key==="Escape"&&(a.preventDefault(),Or())},style:{width:"100%",padding:"8px 12px",marginBottom:"8px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},placeholder:"e.g., my_project.json",autoFocus:!0}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Location:"}),i.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[i.jsx("input",{type:"text",value:yn.locationPath||"Not selected",readOnly:!0,style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:yn.locationPath?"#f2f2f2":"#888",fontSize:"14px",cursor:"not-allowed"},placeholder:"Select a location..."}),i.jsx("button",{onClick:qd,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500,whiteSpace:"nowrap"},children:"Browse..."})]}),yn.filename&&yn.locationPath&&i.jsxs("div",{style:{marginBottom:"20px",padding:"8px 12px",background:"#1a1a1f",border:"1px solid #333",borderRadius:6,fontSize:"12px",color:"#aaa",fontFamily:"monospace"},children:[i.jsx("div",{style:{marginBottom:"4px",color:"#888"},children:"File will be saved at:"}),i.jsxs("div",{style:{color:"#4CAF50"},children:[yn.locationPath,"/",yn.filename.endsWith(".json")?yn.filename:`${yn.filename}.json`]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[i.jsx("button",{onClick:Or,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:Fs,disabled:!yn.filename.trim()||!yn.locationHandle,style:{padding:"8px 16px",background:!yn.filename.trim()||!yn.locationHandle?"#555":"#4CAF50",color:"#fff",border:"1px solid "+(!yn.filename.trim()||!yn.locationHandle?"#666":"#45a049"),borderRadius:6,cursor:!yn.filename.trim()||!yn.locationHandle?"not-allowed":"pointer",fontSize:"14px",fontWeight:600,opacity:!yn.filename.trim()||!yn.locationHandle?.6:1},children:"Save"})]})]})}),i.jsx(gx,{visible:Xr.visible,title:Xr.title,message:Xr.message,onClose:()=>No({visible:!1,title:"",message:""})}),i.jsx(vx,{visible:Ed,dimensions:jr,onSave:a=>{Bs(a)},onClose:()=>ra(!1)}),i.jsx(mx,{visible:Bu,onClose:()=>js(!1),topImage:b,bottomImage:D,selectedImageForTransform:Ht,setSelectedImageForTransform:xa,transformMode:Il,setTransformMode:hs,updateImageTransform:fc,resetImageTransform:Jc,setCurrentTool:G,isGrayscale:le,setIsGrayscale:Me,isBlackAndWhiteEdges:Ie,setIsBlackAndWhiteEdges:ae,isBlackAndWhiteInverted:Fe,setIsBlackAndWhiteInverted:ge,areImagesLocked:wi}),Ao.visible&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10003},onClick:a=>{a.target===a.currentTarget&&Za({visible:!1,size:6})},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:a=>a.stopPropagation(),children:[i.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Set Size"}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Size (pixels):"}),i.jsx("input",{ref:hr,type:"number",min:"1",max:"99",value:Ao.size,onChange:a=>{const r=parseInt(a.target.value)||1,f=Math.max(1,Math.min(99,r));Za(m=>({...m,size:f}))},onKeyDown:a=>{if(a.key==="Enter"?Ld():a.key==="Escape"&&Za({visible:!1,size:6}),a.key.length===1&&/[0-9]/.test(a.key)){const r=Ao.size.toString();r.length>=2&&hr.current?.selectionStart===hr.current?.selectionEnd&&hr.current?.selectionStart===r.length&&a.preventDefault()}},onInput:a=>{const r=a.target,f=r.value;if(f.length>2){r.value=f.slice(0,2);const m=parseInt(r.value)||1;Za(x=>({...x,size:Math.max(1,Math.min(99,m))}))}},style:{width:"100%",padding:"8px 12px",marginBottom:"16px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Or select from list:"}),i.jsxs("select",{value:[2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32].includes(Ao.size)?Ao.size:"",onChange:a=>{const r=parseInt(a.target.value);!isNaN(r)&&r>0&&Za(f=>({...f,size:r}))},style:{width:"100%",padding:"8px 12px",marginBottom:"20px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},children:[i.jsx("option",{value:"",style:{background:"#1f1f24",color:"#f2f2f2"},children:"-- Select --"}),[2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32].map(a=>i.jsxs("option",{value:a,style:{background:"#1f1f24",color:"#f2f2f2"},children:[a," pixels"]},a))]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[i.jsx("button",{onClick:()=>Za({visible:!1,size:6}),style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:Ld,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Apply"})]})]})}),Yr.visible&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10003},onClick:a=>{a.target===a.currentTarget&&Xl({visible:!1,interval:5})},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:a=>a.stopPropagation(),children:[i.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Auto Save"}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Select time interval:"}),i.jsxs("select",{value:Yr.interval===null?"disable":(Yr.interval||5).toString(),onChange:a=>{const r=a.target.value;if(r==="disable")Xl({visible:!0,interval:null});else{const f=parseFloat(r);!isNaN(f)&&f>0&&Xl({visible:!0,interval:f})}},style:{width:"100%",padding:"8px 12px",marginBottom:"20px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0,children:[i.jsx("option",{value:"1",style:{background:"#1f1f24",color:"#f2f2f2"},children:"1 minute"}),i.jsx("option",{value:"5",style:{background:"#1f1f24",color:"#f2f2f2"},children:"5 minutes"}),i.jsx("option",{value:"10",style:{background:"#1f1f24",color:"#f2f2f2"},children:"10 minutes"}),i.jsx("option",{value:"20",style:{background:"#1f1f24",color:"#f2f2f2"},children:"20 minutes"}),i.jsx("option",{value:"30",style:{background:"#1f1f24",color:"#f2f2f2"},children:"30 minutes"}),i.jsx("option",{value:"disable",style:{background:"#1f1f24",color:"#f2f2f2"},children:"Disable"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[i.jsx("button",{onClick:()=>Xl({visible:!1,interval:5}),style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:()=>td(Yr.interval,!1),style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Apply"})]})]})}),Qa.visible&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:a=>{a.target===a.currentTarget&&ed()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:a=>a.stopPropagation(),children:[i.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Enable Auto Save?"}),i.jsx("p",{style:{margin:"0 0 20px 0",fontSize:"14px",color:"#e0e0e0",lineHeight:"1.5"},children:"We recommend enabling Auto Save to automatically save your project at regular intervals. This helps protect your work from accidental loss."}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Select time interval:"}),i.jsxs("select",{value:Qa.interval===null?"disable":(Qa.interval||5).toString(),onChange:a=>{const r=a.target.value;if(r==="disable")hi({...Qa,interval:null});else{const f=parseFloat(r);!isNaN(f)&&f>0&&hi({...Qa,interval:f})}},style:{width:"100%",padding:"8px 12px",marginBottom:"24px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0,children:[i.jsx("option",{value:"1",style:{background:"#1f1f24",color:"#f2f2f2"},children:"1 minute"}),i.jsx("option",{value:"5",style:{background:"#1f1f24",color:"#f2f2f2"},children:"5 minutes"}),i.jsx("option",{value:"10",style:{background:"#1f1f24",color:"#f2f2f2"},children:"10 minutes"}),i.jsx("option",{value:"20",style:{background:"#1f1f24",color:"#f2f2f2"},children:"20 minutes"}),i.jsx("option",{value:"30",style:{background:"#1f1f24",color:"#f2f2f2"},children:"30 minutes"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[i.jsx("button",{onClick:ed,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Skip"}),i.jsx("button",{onClick:()=>td(Qa.interval,!0),style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Enable Auto Save"})]})]})}),i.jsx("div",{style:{position:"fixed",bottom:8,right:8,zIndex:100},children:i.jsxs("button",{onClick:()=>{window.open("https://github.com/sponsors/pgiacalo","_blank","noopener,noreferrer")},style:{display:"flex",alignItems:"center",gap:6,padding:"6px 12px",background:"linear-gradient(180deg, #f6f8fa 0%, #ebecef 100%)",border:"1px solid rgba(27, 31, 36, 0.15)",borderRadius:6,cursor:"pointer",fontSize:12,fontWeight:500,color:"#24292f",boxShadow:"0 1px 0 rgba(27, 31, 36, 0.04)",transition:"background 0.2s"},onMouseEnter:a=>{a.currentTarget.style.background="linear-gradient(180deg, #f3f4f6 0%, #e5e6e9 100%)"},onMouseLeave:a=>{a.currentTarget.style.background="linear-gradient(180deg, #f6f8fa 0%, #ebecef 100%)"},title:"Support this project on GitHub Sponsors",children:[i.jsx("svg",{height:"16",width:"16",viewBox:"0 0 16 16",fill:"#bf3989","aria-hidden":"true",children:i.jsx("path",{d:"M4.25 2.5c-1.336 0-2.75 1.164-2.75 3 0 2.15 1.58 4.144 3.365 5.682A20.565 20.565 0 008 13.393a20.561 20.561 0 003.135-2.211C12.92 9.644 14.5 7.65 14.5 5.5c0-1.836-1.414-3-2.75-3-1.373 0-2.609.986-3.029 2.456a.749.749 0 01-1.442 0C6.859 3.486 5.623 2.5 4.25 2.5z"})}),"Sponsor"]})})]})}Vg.createRoot(document.getElementById("root")).render(i.jsx(w.StrictMode,{children:i.jsx(Hx,{})}));

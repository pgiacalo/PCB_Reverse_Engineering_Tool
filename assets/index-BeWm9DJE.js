(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))s(c);new MutationObserver(c=>{for(const d of c)if(d.type==="childList")for(const v of d.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&s(v)}).observe(document,{childList:!0,subtree:!0});function o(c){const d={};return c.integrity&&(d.integrity=c.integrity),c.referrerPolicy&&(d.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?d.credentials="include":c.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function s(c){if(c.ep)return;c.ep=!0;const d=o(c);fetch(c.href,d)}})();var ww=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bm(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Gh={exports:{}},Bf={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i1;function Em(){if(i1)return Bf;i1=1;var i=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function o(s,c,d){var v=null;if(d!==void 0&&(v=""+d),c.key!==void 0&&(v=""+c.key),"key"in c){d={};for(var p in c)p!=="key"&&(d[p]=c[p])}else d=c;return c=d.ref,{$$typeof:i,type:s,key:v,ref:c!==void 0?c:null,props:d}}return Bf.Fragment=r,Bf.jsx=o,Bf.jsxs=o,Bf}var r1;function Om(){return r1||(r1=1,Gh.exports=Em()),Gh.exports}var n=Om(),Xh={exports:{}},gi={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a1;function Fm(){if(a1)return gi;a1=1;var i=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),d=Symbol.for("react.consumer"),v=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),E=Symbol.iterator;function T(C){return C===null||typeof C!="object"?null:(C=E&&C[E]||C["@@iterator"],typeof C=="function"?C:null)}var K={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},D=Object.assign,ee={};function w(C,z,G){this.props=C,this.context=z,this.refs=ee,this.updater=G||K}w.prototype.isReactComponent={},w.prototype.setState=function(C,z){if(typeof C!="object"&&typeof C!="function"&&C!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,C,z,"setState")},w.prototype.forceUpdate=function(C){this.updater.enqueueForceUpdate(this,C,"forceUpdate")};function Se(){}Se.prototype=w.prototype;function $(C,z,G){this.props=C,this.context=z,this.refs=ee,this.updater=G||K}var H=$.prototype=new Se;H.constructor=$,D(H,w.prototype),H.isPureReactComponent=!0;var ae=Array.isArray;function I(){}var oe={H:null,A:null,T:null,S:null},pe=Object.prototype.hasOwnProperty;function Y(C,z,G){var V=G.ref;return{$$typeof:i,type:C,key:z,ref:V!==void 0?V:null,props:G}}function X(C,z){return Y(C.type,z,C.props)}function F(C){return typeof C=="object"&&C!==null&&C.$$typeof===i}function R(C){var z={"=":"=0",":":"=2"};return"$"+C.replace(/[=:]/g,function(G){return z[G]})}var U=/\/+/g;function O(C,z){return typeof C=="object"&&C!==null&&C.key!=null?R(""+C.key):z.toString(36)}function _e(C){switch(C.status){case"fulfilled":return C.value;case"rejected":throw C.reason;default:switch(typeof C.status=="string"?C.then(I,I):(C.status="pending",C.then(function(z){C.status==="pending"&&(C.status="fulfilled",C.value=z)},function(z){C.status==="pending"&&(C.status="rejected",C.reason=z)})),C.status){case"fulfilled":return C.value;case"rejected":throw C.reason}}throw C}function ce(C,z,G,V,ie){var he=typeof C;(he==="undefined"||he==="boolean")&&(C=null);var re=!1;if(C===null)re=!0;else switch(he){case"bigint":case"string":case"number":re=!0;break;case"object":switch(C.$$typeof){case i:case r:re=!0;break;case S:return re=C._init,ce(re(C._payload),z,G,V,ie)}}if(re)return ie=ie(C),re=V===""?"."+O(C,0):V,ae(ie)?(G="",re!=null&&(G=re.replace(U,"$&/")+"/"),ce(ie,z,G,"",function(Ue){return Ue})):ie!=null&&(F(ie)&&(ie=X(ie,G+(ie.key==null||C&&C.key===ie.key?"":(""+ie.key).replace(U,"$&/")+"/")+re)),z.push(ie)),1;re=0;var Le=V===""?".":V+":";if(ae(C))for(var Re=0;Re<C.length;Re++)V=C[Re],he=Le+O(V,Re),re+=ce(V,z,G,he,ie);else if(Re=T(C),typeof Re=="function")for(C=Re.call(C),Re=0;!(V=C.next()).done;)V=V.value,he=Le+O(V,Re++),re+=ce(V,z,G,he,ie);else if(he==="object"){if(typeof C.then=="function")return ce(_e(C),z,G,V,ie);throw z=String(C),Error("Objects are not valid as a React child (found: "+(z==="[object Object]"?"object with keys {"+Object.keys(C).join(", ")+"}":z)+"). If you meant to render a collection of children, use an array instead.")}return re}function xe(C,z,G){if(C==null)return C;var V=[],ie=0;return ce(C,V,"","",function(he){return z.call(G,he,ie++)}),V}function fe(C){if(C._status===-1){var z=C._result;z=z(),z.then(function(G){(C._status===0||C._status===-1)&&(C._status=1,C._result=G)},function(G){(C._status===0||C._status===-1)&&(C._status=2,C._result=G)}),C._status===-1&&(C._status=0,C._result=z)}if(C._status===1)return C._result.default;throw C._result}var ke=typeof reportError=="function"?reportError:function(C){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof C=="object"&&C!==null&&typeof C.message=="string"?String(C.message):String(C),error:C});if(!window.dispatchEvent(z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",C);return}console.error(C)},de={map:xe,forEach:function(C,z,G){xe(C,function(){z.apply(this,arguments)},G)},count:function(C){var z=0;return xe(C,function(){z++}),z},toArray:function(C){return xe(C,function(z){return z})||[]},only:function(C){if(!F(C))throw Error("React.Children.only expected to receive a single React element child.");return C}};return gi.Activity=_,gi.Children=de,gi.Component=w,gi.Fragment=o,gi.Profiler=c,gi.PureComponent=$,gi.StrictMode=s,gi.Suspense=g,gi.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=oe,gi.__COMPILER_RUNTIME={__proto__:null,c:function(C){return oe.H.useMemoCache(C)}},gi.cache=function(C){return function(){return C.apply(null,arguments)}},gi.cacheSignal=function(){return null},gi.cloneElement=function(C,z,G){if(C==null)throw Error("The argument must be a React element, but you passed "+C+".");var V=D({},C.props),ie=C.key;if(z!=null)for(he in z.key!==void 0&&(ie=""+z.key),z)!pe.call(z,he)||he==="key"||he==="__self"||he==="__source"||he==="ref"&&z.ref===void 0||(V[he]=z[he]);var he=arguments.length-2;if(he===1)V.children=G;else if(1<he){for(var re=Array(he),Le=0;Le<he;Le++)re[Le]=arguments[Le+2];V.children=re}return Y(C.type,ie,V)},gi.createContext=function(C){return C={$$typeof:v,_currentValue:C,_currentValue2:C,_threadCount:0,Provider:null,Consumer:null},C.Provider=C,C.Consumer={$$typeof:d,_context:C},C},gi.createElement=function(C,z,G){var V,ie={},he=null;if(z!=null)for(V in z.key!==void 0&&(he=""+z.key),z)pe.call(z,V)&&V!=="key"&&V!=="__self"&&V!=="__source"&&(ie[V]=z[V]);var re=arguments.length-2;if(re===1)ie.children=G;else if(1<re){for(var Le=Array(re),Re=0;Re<re;Re++)Le[Re]=arguments[Re+2];ie.children=Le}if(C&&C.defaultProps)for(V in re=C.defaultProps,re)ie[V]===void 0&&(ie[V]=re[V]);return Y(C,he,ie)},gi.createRef=function(){return{current:null}},gi.forwardRef=function(C){return{$$typeof:p,render:C}},gi.isValidElement=F,gi.lazy=function(C){return{$$typeof:S,_payload:{_status:-1,_result:C},_init:fe}},gi.memo=function(C,z){return{$$typeof:m,type:C,compare:z===void 0?null:z}},gi.startTransition=function(C){var z=oe.T,G={};oe.T=G;try{var V=C(),ie=oe.S;ie!==null&&ie(G,V),typeof V=="object"&&V!==null&&typeof V.then=="function"&&V.then(I,ke)}catch(he){ke(he)}finally{z!==null&&G.types!==null&&(z.types=G.types),oe.T=z}},gi.unstable_useCacheRefresh=function(){return oe.H.useCacheRefresh()},gi.use=function(C){return oe.H.use(C)},gi.useActionState=function(C,z,G){return oe.H.useActionState(C,z,G)},gi.useCallback=function(C,z){return oe.H.useCallback(C,z)},gi.useContext=function(C){return oe.H.useContext(C)},gi.useDebugValue=function(){},gi.useDeferredValue=function(C,z){return oe.H.useDeferredValue(C,z)},gi.useEffect=function(C,z){return oe.H.useEffect(C,z)},gi.useEffectEvent=function(C){return oe.H.useEffectEvent(C)},gi.useId=function(){return oe.H.useId()},gi.useImperativeHandle=function(C,z,G){return oe.H.useImperativeHandle(C,z,G)},gi.useInsertionEffect=function(C,z){return oe.H.useInsertionEffect(C,z)},gi.useLayoutEffect=function(C,z){return oe.H.useLayoutEffect(C,z)},gi.useMemo=function(C,z){return oe.H.useMemo(C,z)},gi.useOptimistic=function(C,z){return oe.H.useOptimistic(C,z)},gi.useReducer=function(C,z,G){return oe.H.useReducer(C,z,G)},gi.useRef=function(C){return oe.H.useRef(C)},gi.useState=function(C){return oe.H.useState(C)},gi.useSyncExternalStore=function(C,z,G){return oe.H.useSyncExternalStore(C,z,G)},gi.useTransition=function(){return oe.H.useTransition()},gi.version="19.2.0",gi}var o1;function Wg(){return o1||(o1=1,Xh.exports=Fm()),Xh.exports}var L=Wg();const Pt=Bm(L);var Kh={exports:{}},Ef={},Zh={exports:{}},Jh={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s1;function Um(){return s1||(s1=1,(function(i){function r(ce,xe){var fe=ce.length;ce.push(xe);e:for(;0<fe;){var ke=fe-1>>>1,de=ce[ke];if(0<c(de,xe))ce[ke]=xe,ce[fe]=de,fe=ke;else break e}}function o(ce){return ce.length===0?null:ce[0]}function s(ce){if(ce.length===0)return null;var xe=ce[0],fe=ce.pop();if(fe!==xe){ce[0]=fe;e:for(var ke=0,de=ce.length,C=de>>>1;ke<C;){var z=2*(ke+1)-1,G=ce[z],V=z+1,ie=ce[V];if(0>c(G,fe))V<de&&0>c(ie,G)?(ce[ke]=ie,ce[V]=fe,ke=V):(ce[ke]=G,ce[z]=fe,ke=z);else if(V<de&&0>c(ie,fe))ce[ke]=ie,ce[V]=fe,ke=V;else break e}}return xe}function c(ce,xe){var fe=ce.sortIndex-xe.sortIndex;return fe!==0?fe:ce.id-xe.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var d=performance;i.unstable_now=function(){return d.now()}}else{var v=Date,p=v.now();i.unstable_now=function(){return v.now()-p}}var g=[],m=[],S=1,_=null,E=3,T=!1,K=!1,D=!1,ee=!1,w=typeof setTimeout=="function"?setTimeout:null,Se=typeof clearTimeout=="function"?clearTimeout:null,$=typeof setImmediate<"u"?setImmediate:null;function H(ce){for(var xe=o(m);xe!==null;){if(xe.callback===null)s(m);else if(xe.startTime<=ce)s(m),xe.sortIndex=xe.expirationTime,r(g,xe);else break;xe=o(m)}}function ae(ce){if(D=!1,H(ce),!K)if(o(g)!==null)K=!0,I||(I=!0,R());else{var xe=o(m);xe!==null&&_e(ae,xe.startTime-ce)}}var I=!1,oe=-1,pe=5,Y=-1;function X(){return ee?!0:!(i.unstable_now()-Y<pe)}function F(){if(ee=!1,I){var ce=i.unstable_now();Y=ce;var xe=!0;try{e:{K=!1,D&&(D=!1,Se(oe),oe=-1),T=!0;var fe=E;try{t:{for(H(ce),_=o(g);_!==null&&!(_.expirationTime>ce&&X());){var ke=_.callback;if(typeof ke=="function"){_.callback=null,E=_.priorityLevel;var de=ke(_.expirationTime<=ce);if(ce=i.unstable_now(),typeof de=="function"){_.callback=de,H(ce),xe=!0;break t}_===o(g)&&s(g),H(ce)}else s(g);_=o(g)}if(_!==null)xe=!0;else{var C=o(m);C!==null&&_e(ae,C.startTime-ce),xe=!1}}break e}finally{_=null,E=fe,T=!1}xe=void 0}}finally{xe?R():I=!1}}}var R;if(typeof $=="function")R=function(){$(F)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,O=U.port2;U.port1.onmessage=F,R=function(){O.postMessage(null)}}else R=function(){w(F,0)};function _e(ce,xe){oe=w(function(){ce(i.unstable_now())},xe)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(ce){ce.callback=null},i.unstable_forceFrameRate=function(ce){0>ce||125<ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):pe=0<ce?Math.floor(1e3/ce):5},i.unstable_getCurrentPriorityLevel=function(){return E},i.unstable_next=function(ce){switch(E){case 1:case 2:case 3:var xe=3;break;default:xe=E}var fe=E;E=xe;try{return ce()}finally{E=fe}},i.unstable_requestPaint=function(){ee=!0},i.unstable_runWithPriority=function(ce,xe){switch(ce){case 1:case 2:case 3:case 4:case 5:break;default:ce=3}var fe=E;E=ce;try{return xe()}finally{E=fe}},i.unstable_scheduleCallback=function(ce,xe,fe){var ke=i.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?ke+fe:ke):fe=ke,ce){case 1:var de=-1;break;case 2:de=250;break;case 5:de=1073741823;break;case 4:de=1e4;break;default:de=5e3}return de=fe+de,ce={id:S++,callback:xe,priorityLevel:ce,startTime:fe,expirationTime:de,sortIndex:-1},fe>ke?(ce.sortIndex=fe,r(m,ce),o(g)===null&&ce===o(m)&&(D?(Se(oe),oe=-1):D=!0,_e(ae,fe-ke))):(ce.sortIndex=de,r(g,ce),K||T||(K=!0,I||(I=!0,R()))),ce},i.unstable_shouldYield=X,i.unstable_wrapCallback=function(ce){var xe=E;return function(){var fe=E;E=xe;try{return ce.apply(this,arguments)}finally{E=fe}}}})(Jh)),Jh}var l1;function qm(){return l1||(l1=1,Zh.exports=Um()),Zh.exports}var Qh={exports:{}},js={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c1;function Vm(){if(c1)return js;c1=1;var i=Wg();function r(g){var m="https://react.dev/errors/"+g;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var S=2;S<arguments.length;S++)m+="&args[]="+encodeURIComponent(arguments[S])}return"Minified React error #"+g+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(){}var s={d:{f:o,r:function(){throw Error(r(522))},D:o,C:o,L:o,m:o,X:o,S:o,M:o},p:0,findDOMNode:null},c=Symbol.for("react.portal");function d(g,m,S){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:_==null?null:""+_,children:g,containerInfo:m,implementation:S}}var v=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,m){if(g==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return js.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,js.createPortal=function(g,m){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(r(299));return d(g,m,null,S)},js.flushSync=function(g){var m=v.T,S=s.p;try{if(v.T=null,s.p=2,g)return g()}finally{v.T=m,s.p=S,s.d.f()}},js.preconnect=function(g,m){typeof g=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,s.d.C(g,m))},js.prefetchDNS=function(g){typeof g=="string"&&s.d.D(g)},js.preinit=function(g,m){if(typeof g=="string"&&m&&typeof m.as=="string"){var S=m.as,_=p(S,m.crossOrigin),E=typeof m.integrity=="string"?m.integrity:void 0,T=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;S==="style"?s.d.S(g,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:_,integrity:E,fetchPriority:T}):S==="script"&&s.d.X(g,{crossOrigin:_,integrity:E,fetchPriority:T,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},js.preinitModule=function(g,m){if(typeof g=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var S=p(m.as,m.crossOrigin);s.d.M(g,{crossOrigin:S,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&s.d.M(g)},js.preload=function(g,m){if(typeof g=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var S=m.as,_=p(S,m.crossOrigin);s.d.L(g,S,{crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},js.preloadModule=function(g,m){if(typeof g=="string")if(m){var S=p(m.as,m.crossOrigin);s.d.m(g,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:S,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else s.d.m(g)},js.requestFormReset=function(g){s.d.r(g)},js.unstable_batchedUpdates=function(g,m){return g(m)},js.useFormState=function(g,m,S){return v.H.useFormState(g,m,S)},js.useFormStatus=function(){return v.H.useHostTransitionStatus()},js.version="19.2.0",js}var u1;function Hm(){if(u1)return Qh.exports;u1=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(r){console.error(r)}}return i(),Qh.exports=Vm(),Qh.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var d1;function Wm(){if(d1)return Ef;d1=1;var i=qm(),r=Wg(),o=Hm();function s(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function c(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function d(e){var t=e,a=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(a=t.return),e=t.return;while(e)}return t.tag===3?a:null}function v(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function g(e){if(d(e)!==e)throw Error(s(188))}function m(e){var t=e.alternate;if(!t){if(t=d(e),t===null)throw Error(s(188));return t!==e?null:e}for(var a=e,u=t;;){var h=a.return;if(h===null)break;var b=h.alternate;if(b===null){if(u=h.return,u!==null){a=u;continue}break}if(h.child===b.child){for(b=h.child;b;){if(b===a)return g(h),e;if(b===u)return g(h),t;b=b.sibling}throw Error(s(188))}if(a.return!==u.return)a=h,u=b;else{for(var M=!1,ue=h.child;ue;){if(ue===a){M=!0,a=h,u=b;break}if(ue===u){M=!0,u=h,a=b;break}ue=ue.sibling}if(!M){for(ue=b.child;ue;){if(ue===a){M=!0,a=b,u=h;break}if(ue===u){M=!0,u=b,a=h;break}ue=ue.sibling}if(!M)throw Error(s(189))}}if(a.alternate!==u)throw Error(s(190))}if(a.tag!==3)throw Error(s(188));return a.stateNode.current===a?e:t}function S(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=S(e),t!==null)return t;e=e.sibling}return null}var _=Object.assign,E=Symbol.for("react.element"),T=Symbol.for("react.transitional.element"),K=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),ee=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),Se=Symbol.for("react.consumer"),$=Symbol.for("react.context"),H=Symbol.for("react.forward_ref"),ae=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),oe=Symbol.for("react.memo"),pe=Symbol.for("react.lazy"),Y=Symbol.for("react.activity"),X=Symbol.for("react.memo_cache_sentinel"),F=Symbol.iterator;function R(e){return e===null||typeof e!="object"?null:(e=F&&e[F]||e["@@iterator"],typeof e=="function"?e:null)}var U=Symbol.for("react.client.reference");function O(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===U?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case D:return"Fragment";case w:return"Profiler";case ee:return"StrictMode";case ae:return"Suspense";case I:return"SuspenseList";case Y:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case K:return"Portal";case $:return e.displayName||"Context";case Se:return(e._context.displayName||"Context")+".Consumer";case H:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case oe:return t=e.displayName||null,t!==null?t:O(e.type)||"Memo";case pe:t=e._payload,e=e._init;try{return O(e(t))}catch{}}return null}var _e=Array.isArray,ce=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,xe=o.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,fe={pending:!1,data:null,method:null,action:null},ke=[],de=-1;function C(e){return{current:e}}function z(e){0>de||(e.current=ke[de],ke[de]=null,de--)}function G(e,t){de++,ke[de]=e.current,e.current=t}var V=C(null),ie=C(null),he=C(null),re=C(null);function Le(e,t){switch(G(he,t),G(ie,e),G(V,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?k0(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=k0(t),e=N0(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}z(V),G(V,e)}function Re(){z(V),z(ie),z(he)}function Ue(e){e.memoizedState!==null&&G(re,e);var t=V.current,a=N0(t,e.type);t!==a&&(G(ie,e),G(V,a))}function et(e){ie.current===e&&(z(V),z(ie)),re.current===e&&(z(re),Df._currentValue=fe)}var ot,Ct;function Ot(e){if(ot===void 0)try{throw Error()}catch(a){var t=a.stack.trim().match(/\n( *(at )?)/);ot=t&&t[1]||"",Ct=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ot+e+Ct}var se=!1;function kt(e,t){if(!e||se)return"";se=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(t){var zt=function(){throw Error()};if(Object.defineProperty(zt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(zt,[])}catch(dt){var at=dt}Reflect.construct(e,[],zt)}else{try{zt.call()}catch(dt){at=dt}e.call(zt.prototype)}}else{try{throw Error()}catch(dt){at=dt}(zt=e())&&typeof zt.catch=="function"&&zt.catch(function(){})}}catch(dt){if(dt&&at&&typeof dt.stack=="string")return[dt.stack,at.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var h=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");h&&h.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var b=u.DetermineComponentFrameRoot(),M=b[0],ue=b[1];if(M&&ue){var Be=M.split(`
`),it=ue.split(`
`);for(h=u=0;u<Be.length&&!Be[u].includes("DetermineComponentFrameRoot");)u++;for(;h<it.length&&!it[h].includes("DetermineComponentFrameRoot");)h++;if(u===Be.length||h===it.length)for(u=Be.length-1,h=it.length-1;1<=u&&0<=h&&Be[u]!==it[h];)h--;for(;1<=u&&0<=h;u--,h--)if(Be[u]!==it[h]){if(u!==1||h!==1)do if(u--,h--,0>h||Be[u]!==it[h]){var St=`
`+Be[u].replace(" at new "," at ");return e.displayName&&St.includes("<anonymous>")&&(St=St.replace("<anonymous>",e.displayName)),St}while(1<=u&&0<=h);break}}}finally{se=!1,Error.prepareStackTrace=a}return(a=e?e.displayName||e.name:"")?Ot(a):""}function Jt(e,t){switch(e.tag){case 26:case 27:case 5:return Ot(e.type);case 16:return Ot("Lazy");case 13:return e.child!==t&&t!==null?Ot("Suspense Fallback"):Ot("Suspense");case 19:return Ot("SuspenseList");case 0:case 15:return kt(e.type,!1);case 11:return kt(e.type.render,!1);case 1:return kt(e.type,!0);case 31:return Ot("Activity");default:return""}}function Wt(e){try{var t="",a=null;do t+=Jt(e,a),a=e,e=e.return;while(e);return t}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var ht=Object.prototype.hasOwnProperty,Xe=i.unstable_scheduleCallback,Ut=i.unstable_cancelCallback,an=i.unstable_shouldYield,Ht=i.unstable_requestPaint,Nn=i.unstable_now,zn=i.unstable_getCurrentPriorityLevel,Ee=i.unstable_ImmediatePriority,Ne=i.unstable_UserBlockingPriority,Mt=i.unstable_NormalPriority,ct=i.unstable_LowPriority,_t=i.unstable_IdlePriority,Ze=i.log,jt=i.unstable_setDisableYieldValue,en=null,Qe=null;function At(e){if(typeof Ze=="function"&&jt(e),Qe&&typeof Qe.setStrictMode=="function")try{Qe.setStrictMode(en,e)}catch{}}var un=Math.clz32?Math.clz32:Qt,xn=Math.log,Kt=Math.LN2;function Qt(e){return e>>>=0,e===0?32:31-(xn(e)/Kt|0)|0}var hn=256,Xn=262144,rt=4194304;function ln(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Lt(e,t,a){var u=e.pendingLanes;if(u===0)return 0;var h=0,b=e.suspendedLanes,M=e.pingedLanes;e=e.warmLanes;var ue=u&134217727;return ue!==0?(u=ue&~b,u!==0?h=ln(u):(M&=ue,M!==0?h=ln(M):a||(a=ue&~e,a!==0&&(h=ln(a))))):(ue=u&~b,ue!==0?h=ln(ue):M!==0?h=ln(M):a||(a=u&~e,a!==0&&(h=ln(a)))),h===0?0:t!==0&&t!==h&&(t&b)===0&&(b=h&-h,a=t&-t,b>=a||b===32&&(a&4194048)!==0)?t:h}function Zn(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function In(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wr(){var e=rt;return rt<<=1,(rt&62914560)===0&&(rt=4194304),e}function Zi(e){for(var t=[],a=0;31>a;a++)t.push(e);return t}function Yt(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function jn(e,t,a,u,h,b){var M=e.pendingLanes;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=a,e.entangledLanes&=a,e.errorRecoveryDisabledLanes&=a,e.shellSuspendCounter=0;var ue=e.entanglements,Be=e.expirationTimes,it=e.hiddenUpdates;for(a=M&~a;0<a;){var St=31-un(a),zt=1<<St;ue[St]=0,Be[St]=-1;var at=it[St];if(at!==null)for(it[St]=null,St=0;St<at.length;St++){var dt=at[St];dt!==null&&(dt.lane&=-536870913)}a&=~zt}u!==0&&ci(e,u,0),b!==0&&h===0&&e.tag!==0&&(e.suspendedLanes|=b&~(M&~t))}function ci(e,t,a){e.pendingLanes|=t,e.suspendedLanes&=~t;var u=31-un(t);e.entangledLanes|=t,e.entanglements[u]=e.entanglements[u]|1073741824|a&261930}function Et(e,t){var a=e.entangledLanes|=t;for(e=e.entanglements;a;){var u=31-un(a),h=1<<u;h&t|e[u]&t&&(e[u]|=t),a&=~h}}function Bt(e,t){var a=t&-t;return a=(a&42)!==0?1:Zt(a),(a&(e.suspendedLanes|t))!==0?0:a}function Zt(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function on(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Wn(){var e=xe.p;return e!==0?e:(e=window.event,e===void 0?32:K0(e.type))}function qi(e,t){var a=xe.p;try{return xe.p=e,t()}finally{xe.p=a}}var Sr=Math.random().toString(36).slice(2),yt="__reactFiber$"+Sr,si="__reactProps$"+Sr,On="__reactContainer$"+Sr,Ri="__reactEvents$"+Sr,Ei="__reactListeners$"+Sr,bo="__reactHandles$"+Sr,ya="__reactResources$"+Sr,Rr="__reactMarker$"+Sr;function Ys(e){delete e[yt],delete e[si],delete e[Ri],delete e[Ei],delete e[bo]}function Jo(e){var t=e[yt];if(t)return t;for(var a=e.parentNode;a;){if(t=a[On]||a[yt]){if(a=t.alternate,t.child!==null||a!==null&&a.child!==null)for(e=L0(e);e!==null;){if(a=e[yt])return a;e=L0(e)}return t}e=a,a=e.parentNode}return null}function Qo(e){if(e=e[yt]||e[On]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function ol(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(s(33))}function es(e){var t=e[ya];return t||(t=e[ya]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function jr(e){e[Rr]=!0}var Gs=new Set,Jn={};function ma(e,t){di(e,t),di(e+"Capture",t)}function di(e,t){for(Jn[e]=t,e=0;e<t.length;e++)Gs.add(t[e])}var As=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Di={},zs={};function ir(e){return ht.call(zs,e)?!0:ht.call(Di,e)?!1:As.test(e)?zs[e]=!0:(Di[e]=!0,!1)}function Na(e,t,a){if(ir(t))if(a===null)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var u=t.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+a)}}function vo(e,t,a){if(a===null)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+a)}}function Ha(e,t,a,u){if(u===null)e.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(a);return}e.setAttributeNS(t,a,""+u)}}function Ti(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Oo(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function hs(e,t,a){var u=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var h=u.get,b=u.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return h.call(this)},set:function(M){a=""+M,b.call(this,M)}}),Object.defineProperty(e,t,{enumerable:u.enumerable}),{getValue:function(){return a},setValue:function(M){a=""+M},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Tr(e){if(!e._valueTracker){var t=Oo(e)?"checked":"value";e._valueTracker=hs(e,t,""+e[t])}}function oo(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var a=t.getValue(),u="";return e&&(u=Oo(e)?e.checked?"true":"false":e.value),e=u,e!==a?(t.setValue(e),!0):!1}function vn(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var wi=/[\n"\\]/g;function ui(e){return e.replace(wi,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function Dr(e,t,a,u,h,b,M,ue){e.name="",M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"?e.type=M:e.removeAttribute("type"),t!=null?M==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Ti(t)):e.value!==""+Ti(t)&&(e.value=""+Ti(t)):M!=="submit"&&M!=="reset"||e.removeAttribute("value"),t!=null?sl(e,M,Ti(t)):a!=null?sl(e,M,Ti(a)):u!=null&&e.removeAttribute("value"),h==null&&b!=null&&(e.defaultChecked=!!b),h!=null&&(e.checked=h&&typeof h!="function"&&typeof h!="symbol"),ue!=null&&typeof ue!="function"&&typeof ue!="symbol"&&typeof ue!="boolean"?e.name=""+Ti(ue):e.removeAttribute("name")}function Xs(e,t,a,u,h,b,M,ue){if(b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(e.type=b),t!=null||a!=null){if(!(b!=="submit"&&b!=="reset"||t!=null)){Tr(e);return}a=a!=null?""+Ti(a):"",t=t!=null?""+Ti(t):a,ue||t===e.value||(e.value=t),e.defaultValue=t}u=u??h,u=typeof u!="function"&&typeof u!="symbol"&&!!u,e.checked=ue?e.checked:!!u,e.defaultChecked=!!u,M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"&&(e.name=M),Tr(e)}function sl(e,t,a){t==="number"&&vn(e.ownerDocument)===e||e.defaultValue===""+a||(e.defaultValue=""+a)}function dr(e,t,a,u){if(e=e.options,t){t={};for(var h=0;h<a.length;h++)t["$"+a[h]]=!0;for(a=0;a<e.length;a++)h=t.hasOwnProperty("$"+e[a].value),e[a].selected!==h&&(e[a].selected=h),h&&u&&(e[a].defaultSelected=!0)}else{for(a=""+Ti(a),t=null,h=0;h<e.length;h++){if(e[h].value===a){e[h].selected=!0,u&&(e[h].defaultSelected=!0);return}t!==null||e[h].disabled||(t=e[h])}t!==null&&(t.selected=!0)}}function Aa(e,t,a){if(t!=null&&(t=""+Ti(t),t!==e.value&&(e.value=t),a==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=a!=null?""+Ti(a):""}function Ps(e,t,a,u){if(t==null){if(u!=null){if(a!=null)throw Error(s(92));if(_e(u)){if(1<u.length)throw Error(s(93));u=u[0]}a=u}a==null&&(a=""),t=a}a=Ti(t),e.defaultValue=a,u=e.textContent,u===a&&u!==""&&u!==null&&(e.value=u),Tr(e)}function wo(e,t){if(t){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=t;return}}e.textContent=t}var Ks=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function So(e,t,a){var u=t.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?u?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":u?e.setProperty(t,a):typeof a!="number"||a===0||Ks.has(t)?t==="float"?e.cssFloat=a:e[t]=(""+a).trim():e[t]=a+"px"}function Ft(e,t,a){if(t!=null&&typeof t!="object")throw Error(s(62));if(e=e.style,a!=null){for(var u in a)!a.hasOwnProperty(u)||t!=null&&t.hasOwnProperty(u)||(u.indexOf("--")===0?e.setProperty(u,""):u==="float"?e.cssFloat="":e[u]="");for(var h in t)u=t[h],t.hasOwnProperty(h)&&a[h]!==u&&So(e,h,u)}else for(var b in t)t.hasOwnProperty(b)&&So(e,b,t[b])}function br(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var za=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Fo=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function rr(e){return Fo.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function ba(){}var jo=null;function To(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ll=null,qn=null;function Ec(e){var t=Qo(e);if(t&&(e=t.stateNode)){var a=e[si]||null;e:switch(e=t.stateNode,t.type){case"input":if(Dr(e,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),t=a.name,a.type==="radio"&&t!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+ui(""+t)+'"][type="radio"]'),t=0;t<a.length;t++){var u=a[t];if(u!==e&&u.form===e.form){var h=u[si]||null;if(!h)throw Error(s(90));Dr(u,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name)}}for(t=0;t<a.length;t++)u=a[t],u.form===e.form&&oo(u)}break e;case"textarea":Aa(e,a.value,a.defaultValue);break e;case"select":t=a.value,t!=null&&dr(e,!!a.multiple,t,!1)}}}var $l=!1;function Lr(e,t,a){if($l)return e(t,a);$l=!0;try{var u=e(t);return u}finally{if($l=!1,(ll!==null||qn!==null)&&(fs(),ll&&(t=ll,e=qn,qn=ll=null,Ec(t),e)))for(t=0;t<e.length;t++)Ec(e[t])}}function zi(e,t){var a=e.stateNode;if(a===null)return null;var u=a[si]||null;if(u===null)return null;a=u[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(e=e.type,u=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!u;break e;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(s(231,t,typeof a));return a}var na=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Oc=!1;if(na)try{var ii={};Object.defineProperty(ii,"passive",{get:function(){Oc=!0}}),window.addEventListener("test",ii,ii),window.removeEventListener("test",ii,ii)}catch{Oc=!1}var mn=null,Zs=null,ts=null;function $n(){if(ts)return ts;var e,t=Zs,a=t.length,u,h="value"in mn?mn.value:mn.textContent,b=h.length;for(e=0;e<a&&t[e]===h[e];e++);var M=a-e;for(u=1;u<=M&&t[a-u]===h[b-u];u++);return ts=h.slice(e,1<u?1-u:void 0)}function bn(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function mi(){return!0}function _n(){return!1}function Yn(e){function t(a,u,h,b,M){this._reactName=a,this._targetInst=h,this.type=u,this.nativeEvent=b,this.target=M,this.currentTarget=null;for(var ue in e)e.hasOwnProperty(ue)&&(a=e[ue],this[ue]=a?a(b):b[ue]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?mi:_n,this.isPropagationStopped=_n,this}return _(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=mi)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=mi)},persist:function(){},isPersistent:mi}),t}var Tn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gs=Yn(Tn),tn=_({},Tn,{view:0,detail:0}),Li=Yn(tn),cn,Si,Wa,cl=_({},tn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fn,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Wa&&(Wa&&e.type==="mousemove"?(cn=e.screenX-Wa.screenX,Si=e.screenY-Wa.screenY):Si=cn=0,Wa=e),cn)},movementY:function(e){return"movementY"in e?e.movementY:Si}}),Pa=Yn(cl),Uo=_({},cl,{dataTransfer:0}),$a=Yn(Uo),ul=_({},tn,{relatedTarget:0}),_s=Yn(ul),Fc=_({},Tn,{animationName:0,elapsedTime:0,pseudoElement:0}),j=Yn(Fc),W=_({},Tn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ze=Yn(W),Oe=_({},Tn,{data:0}),Ie=Yn(Oe),bt={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gt={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Gt(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=dn[e])?!!t[e]:!1}function fn(){return Gt}var wn=_({},tn,{key:function(e){if(e.key){var t=bt[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=bn(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?gt[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fn,charCode:function(e){return e.type==="keypress"?bn(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?bn(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Fn=Yn(wn),Mi=_({},cl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),fr=Yn(Mi),vr=_({},tn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fn}),Ji=Yn(vr),ia=_({},Tn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Gr=Yn(ia),dl=_({},cl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Cr=Yn(dl),qo=_({},Tn,{newState:0,oldState:0}),da=Yn(qo),Rs=[9,13,27,32],Xr=na&&"CompositionEvent"in window,Co=null;na&&"documentMode"in document&&(Co=document.documentMode);var ko=na&&"TextEvent"in window&&!Co,Ds=na&&(!Xr||Co&&8<Co&&11>=Co),Vi=" ",ns=!1;function Kr(e,t){switch(e){case"keyup":return Rs.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ls(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Vr=!1;function fa(e,t){switch(e){case"compositionend":return Ls(t);case"keypress":return t.which!==32?null:(ns=!0,Vi);case"textInput":return e=t.data,e===Vi&&ns?null:e;default:return null}}function Qi(e,t){if(Vr)return e==="compositionend"||!Xr&&Kr(e,t)?(e=$n(),ts=Zs=mn=null,Vr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ds&&t.locale!=="ko"?null:t.data;default:return null}}var Ms={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Uc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Ms[e.type]:t==="textarea"}function is(e,t,a,u){ll?qn?qn.push(u):qn=[u]:ll=u,t=Ap(t,"onChange"),0<t.length&&(a=new gs("onChange","change",null,a,u),e.push({event:a,listeners:t}))}var No=null,xs=null;function Al(e){v0(e,0)}function rs(e){var t=ol(e);if(oo(t))return e}function Ao(e,t){if(e==="change")return t}var Ya=!1;if(na){var kr;if(na){var zo="oninput"in document;if(!zo){var so=document.createElement("div");so.setAttribute("oninput","return;"),zo=typeof so.oninput=="function"}kr=zo}else kr=!1;Ya=kr&&(!document.documentMode||9<document.documentMode)}function Is(){No&&(No.detachEvent("onpropertychange",Bs),xs=No=null)}function Bs(e){if(e.propertyName==="value"&&rs(xs)){var t=[];is(t,xs,e,To(e)),Lr(Al,t)}}function zl(e,t,a){e==="focusin"?(Is(),No=t,xs=a,No.attachEvent("onpropertychange",Bs)):e==="focusout"&&Is()}function pr(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return rs(xs)}function bc(e,t){if(e==="click")return rs(t)}function Po(e,t){if(e==="input"||e==="change")return rs(t)}function Ci(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Hr=typeof Object.is=="function"?Object.is:Ci;function Yi(e,t){if(Hr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var a=Object.keys(e),u=Object.keys(t);if(a.length!==u.length)return!1;for(u=0;u<a.length;u++){var h=a[u];if(!ht.call(t,h)||!Hr(e[h],t[h]))return!1}return!0}function Es(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Pl(e,t){var a=Es(e);e=0;for(var u;a;){if(a.nodeType===3){if(u=e+a.textContent.length,e<=t&&u>=t)return{node:a,offset:t-e};e=u}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Es(a)}}function Vo(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Vo(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function fl(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=vn(e.document);t instanceof e.HTMLIFrameElement;){try{var a=typeof t.contentWindow.location.href=="string"}catch{a=!1}if(a)e=t.contentWindow;else break;t=vn(e.document)}return t}function ys(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var Yl=na&&"documentMode"in document&&11>=document.documentMode,as=null,Ga=null,_a=null,_o=!1;function ki(e,t,a){var u=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;_o||as==null||as!==vn(u)||(u=as,"selectionStart"in u&&ys(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),_a&&Yi(_a,u)||(_a=u,u=Ap(Ga,"onSelect"),0<u.length&&(t=new gs("onSelect","select",null,t,a),e.push({event:t,listeners:u}),t.target=as)))}function ri(e,t){var a={};return a[e.toLowerCase()]=t.toLowerCase(),a["Webkit"+e]="webkit"+t,a["Moz"+e]="moz"+t,a}var lr={animationend:ri("Animation","AnimationEnd"),animationiteration:ri("Animation","AnimationIteration"),animationstart:ri("Animation","AnimationStart"),transitionrun:ri("Transition","TransitionRun"),transitionstart:ri("Transition","TransitionStart"),transitioncancel:ri("Transition","TransitionCancel"),transitionend:ri("Transition","TransitionEnd")},Mr={},Js={};na&&(Js=document.createElement("div").style,"AnimationEvent"in window||(delete lr.animationend.animation,delete lr.animationiteration.animation,delete lr.animationstart.animation),"TransitionEvent"in window||delete lr.transitionend.transition);function ms(e){if(Mr[e])return Mr[e];if(!lr[e])return e;var t=lr[e],a;for(a in t)if(t.hasOwnProperty(a)&&a in Js)return Mr[e]=t[a];return e}var Gl=ms("animationend"),vc=ms("animationiteration"),Hu=ms("animationstart"),yd=ms("transitionrun"),md=ms("transitionstart"),bd=ms("transitioncancel"),Xa=ms("transitionend"),Ho=new Map,Wo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Wo.push("scrollEnd");function ra(e,t){Ho.set(e,t),ma(t,[e])}var os=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},pa=[],$o=0,Ro=0;function _l(){for(var e=$o,t=Ro=$o=0;t<e;){var a=pa[t];pa[t++]=null;var u=pa[t];pa[t++]=null;var h=pa[t];pa[t++]=null;var b=pa[t];if(pa[t++]=null,u!==null&&h!==null){var M=u.pending;M===null?h.next=h:(h.next=M.next,M.next=h),u.pending=h}b!==0&&oa(a,h,b)}}function aa(e,t,a,u){pa[$o++]=e,pa[$o++]=t,pa[$o++]=a,pa[$o++]=u,Ro|=u,e.lanes|=u,e=e.alternate,e!==null&&(e.lanes|=u)}function Pi(e,t,a,u){return aa(e,t,a,u),hr(e)}function va(e,t){return aa(e,null,null,t),hr(e)}function oa(e,t,a){e.lanes|=a;var u=e.alternate;u!==null&&(u.lanes|=a);for(var h=!1,b=e.return;b!==null;)b.childLanes|=a,u=b.alternate,u!==null&&(u.childLanes|=a),b.tag===22&&(e=b.stateNode,e===null||e._visibility&1||(h=!0)),e=b,b=b.return;return e.tag===3?(b=e.stateNode,h&&t!==null&&(h=31-un(a),e=b.hiddenUpdates,u=e[h],u===null?e[h]=[t]:u.push(t),t.lane=a|536870912),b):null}function hr(e){if(50<It)throw It=0,Dn=null,Error(s(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Ka={};function Qs(e,t,a,u){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Za(e,t,a,u){return new Qs(e,t,a,u)}function Xl(e){return e=e.prototype,!(!e||!e.isReactComponent)}function bi(e,t){var a=e.alternate;return a===null?(a=Za(e.tag,t,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=t,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&65011712,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,t=e.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a.refCleanup=e.refCleanup,a}function Ra(e,t){e.flags&=65011714;var a=e.alternate;return a===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=a.childLanes,e.lanes=a.lanes,e.child=a.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,e.type=a.type,t=a.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Rl(e,t,a,u,h,b){var M=0;if(u=e,typeof e=="function")Xl(e)&&(M=1);else if(typeof e=="string")M=Cm(e,a,V.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case Y:return e=Za(31,a,t,h),e.elementType=Y,e.lanes=b,e;case D:return pl(a.children,h,b,t);case ee:M=8,h|=24;break;case w:return e=Za(12,a,t,h|2),e.elementType=w,e.lanes=b,e;case ae:return e=Za(13,a,t,h),e.elementType=ae,e.lanes=b,e;case I:return e=Za(19,a,t,h),e.elementType=I,e.lanes=b,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case $:M=10;break e;case Se:M=9;break e;case H:M=11;break e;case oe:M=14;break e;case pe:M=16,u=null;break e}M=29,a=Error(s(130,e===null?"null":typeof e,"")),u=null}return t=Za(M,a,t,h),t.elementType=e,t.type=u,t.lanes=b,t}function pl(e,t,a,u){return e=Za(7,e,u,t),e.lanes=a,e}function wc(e,t,a){return e=Za(6,e,null,t),e.lanes=a,e}function Sc(e){var t=Za(18,null,null,0);return t.stateNode=e,t}function hl(e,t,a){return t=Za(4,e.children!==null?e.children:[],e.key,t),t.lanes=a,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var jc=new WeakMap;function lo(e,t){if(typeof e=="object"&&e!==null){var a=jc.get(e);return a!==void 0?a:(t={value:e,source:t,stack:Wt(t)},jc.set(e,t),t)}return{value:e,source:t,stack:Wt(t)}}var Kl=[],ss=0,Dl=null,Os=0,Ja=[],Do=0,Fs=null,Da=1,La="";function Yo(e,t){Kl[ss++]=Os,Kl[ss++]=Dl,Dl=e,Os=t}function Us(e,t,a){Ja[Do++]=Da,Ja[Do++]=La,Ja[Do++]=Fs,Fs=e;var u=Da;e=La;var h=32-un(u)-1;u&=~(1<<h),a+=1;var b=32-un(t)+h;if(30<b){var M=h-h%5;b=(u&(1<<M)-1).toString(32),u>>=M,h-=M,Da=1<<32-un(t)+h|a<<h|u,La=b+e}else Da=1<<b|a<<h|u,La=e}function hu(e){e.return!==null&&(Yo(e,1),Us(e,1,0))}function Ma(e){for(;e===Dl;)Dl=Kl[--ss],Kl[ss]=null,Os=Kl[--ss],Kl[ss]=null;for(;e===Fs;)Fs=Ja[--Do],Ja[Do]=null,La=Ja[--Do],Ja[Do]=null,Da=Ja[--Do],Ja[Do]=null}function qc(e,t){Ja[Do++]=Da,Ja[Do++]=La,Ja[Do++]=Fs,Da=t.id,La=t.overflow,Fs=e}var Ia=null,er=null,fi=!1,Ba=null,gr=!1,wa=Error(s(519));function Ll(e){var t=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Jl(lo(t,e)),wa}function gu(e){var t=e.stateNode,a=e.type,u=e.memoizedProps;switch(t[yt]=e,t[si]=u,a){case"dialog":$i("cancel",t),$i("close",t);break;case"iframe":case"object":case"embed":$i("load",t);break;case"video":case"audio":for(a=0;a<Af.length;a++)$i(Af[a],t);break;case"source":$i("error",t);break;case"img":case"image":case"link":$i("error",t),$i("load",t);break;case"details":$i("toggle",t);break;case"input":$i("invalid",t),Xs(t,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":$i("invalid",t);break;case"textarea":$i("invalid",t),Ps(t,u.value,u.defaultValue,u.children)}a=u.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||t.textContent===""+a||u.suppressHydrationWarning===!0||T0(t.textContent,a)?(u.popover!=null&&($i("beforetoggle",t),$i("toggle",t)),u.onScroll!=null&&$i("scroll",t),u.onScrollEnd!=null&&$i("scrollend",t),u.onClick!=null&&(t.onclick=ba),t=!0):t=!1,t||Ll(e,!0)}function el(e){for(Ia=e.return;Ia;)switch(Ia.tag){case 5:case 31:case 13:gr=!1;return;case 27:case 3:gr=!0;return;default:Ia=Ia.return}}function Qa(e){if(e!==Ia)return!1;if(!fi)return el(e),fi=!0,!1;var t=e.tag,a;if((a=t!==3&&t!==27)&&((a=t===5)&&(a=e.type,a=!(a!=="form"&&a!=="button")||Dh(e.type,e.memoizedProps)),a=!a),a&&er&&Ll(e),el(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));er=D0(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));er=D0(e)}else t===27?(t=er,Du(e.type)?(e=Eh,Eh=null,er=e):er=t):er=Ia?Ul(e.stateNode.nextSibling):null;return!0}function Zl(){er=Ia=null,fi=!1}function Vc(){var e=Ba;return e!==null&&(qt===null?qt=e:qt.push.apply(qt,e),Ba=null),e}function Jl(e){Ba===null?Ba=[e]:Ba.push(e)}var Hc=C(null),gl=null,eo=null;function Zr(e,t,a){G(Hc,t._currentValue),t._currentValue=a}function Sa(e){e._currentValue=Hc.current,z(Hc)}function ha(e,t,a){for(;e!==null;){var u=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,u!==null&&(u.childLanes|=t)):u!==null&&(u.childLanes&t)!==t&&(u.childLanes|=t),e===a)break;e=e.return}}function Ql(e,t,a,u){var h=e.child;for(h!==null&&(h.return=e);h!==null;){var b=h.dependencies;if(b!==null){var M=h.child;b=b.firstContext;e:for(;b!==null;){var ue=b;b=h;for(var Be=0;Be<t.length;Be++)if(ue.context===t[Be]){b.lanes|=a,ue=b.alternate,ue!==null&&(ue.lanes|=a),ha(b.return,a,e),u||(M=null);break e}b=ue.next}}else if(h.tag===18){if(M=h.return,M===null)throw Error(s(341));M.lanes|=a,b=M.alternate,b!==null&&(b.lanes|=a),ha(M,a,e),M=null}else M=h.child;if(M!==null)M.return=h;else for(M=h;M!==null;){if(M===e){M=null;break}if(h=M.sibling,h!==null){h.return=M.return,M=h;break}M=M.return}h=M}}function xl(e,t,a,u){e=null;for(var h=t,b=!1;h!==null;){if(!b){if((h.flags&524288)!==0)b=!0;else if((h.flags&262144)!==0)break}if(h.tag===10){var M=h.alternate;if(M===null)throw Error(s(387));if(M=M.memoizedProps,M!==null){var ue=h.type;Hr(h.pendingProps.value,M.value)||(e!==null?e.push(ue):e=[ue])}}else if(h===re.current){if(M=h.alternate,M===null)throw Error(s(387));M.memoizedState.memoizedState!==h.memoizedState.memoizedState&&(e!==null?e.push(Df):e=[Df])}h=h.return}e!==null&&Ql(t,e,a,u),t.flags|=262144}function sa(e){for(e=e.firstContext;e!==null;){if(!Hr(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ea(e){gl=e,eo=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Gi(e){return to(gl,e)}function Go(e,t){return gl===null&&Ea(e),to(e,t)}function to(e,t){var a=t._currentValue;if(t={context:t,memoizedValue:a,next:null},eo===null){if(e===null)throw Error(s(308));eo=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else eo=eo.next=t;return a}var qs=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(a,u){e.push(u)}};this.abort=function(){t.aborted=!0,e.forEach(function(a){return a()})}},Lo=i.unstable_scheduleCallback,Vs=i.unstable_NormalPriority,Ii={$$typeof:$,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function co(){return{controller:new qs,data:new Map,refCount:0}}function uo(e){e.refCount--,e.refCount===0&&Lo(Vs,function(){e.controller.abort()})}var ls=null,Mo=0,f=0,x=null;function k(e,t){if(ls===null){var a=ls=[];Mo=0,f=Th(),x={status:"pending",value:void 0,then:function(u){a.push(u)}}}return Mo++,t.then(P,P),t}function P(){if(--Mo===0&&ls!==null){x!==null&&(x.status="fulfilled");var e=ls;ls=null,f=0,x=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function q(e,t){var a=[],u={status:"pending",value:null,reason:null,then:function(h){a.push(h)}};return e.then(function(){u.status="fulfilled",u.value=t;for(var h=0;h<a.length;h++)(0,a[h])(t)},function(h){for(u.status="rejected",u.reason=h,h=0;h<a.length;h++)(0,a[h])(void 0)}),u}var Z=ce.S;ce.S=function(e,t){We=Nn(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&k(e,t),Z!==null&&Z(e,t)};var Q=C(null);function J(){var e=Q.current;return e!==null?e:je.pooledCache}function te(e,t){t===null?G(Q,Q.current):G(Q,t.pool)}function Pe(){var e=J();return e===null?null:{parent:Ii._currentValue,pool:e}}var Fe=Error(s(460)),tt=Error(s(474)),Ae=Error(s(542)),Ve={then:function(){}};function Ke(e){return e=e.status,e==="fulfilled"||e==="rejected"}function ft(e,t,a){switch(a=e[a],a===void 0?e.push(t):a!==t&&(t.then(ba,ba),t=a),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Dt(e),e;default:if(typeof t.status=="string")t.then(ba,ba);else{if(e=je,e!==null&&100<e.shellSuspendCounter)throw Error(s(482));e=t,e.status="pending",e.then(function(u){if(t.status==="pending"){var h=t;h.status="fulfilled",h.value=u}},function(u){if(t.status==="pending"){var h=t;h.status="rejected",h.reason=u}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Dt(e),e}throw mt=t,Fe}}function Je(e){try{var t=e._init;return t(e._payload)}catch(a){throw a!==null&&typeof a=="object"&&typeof a.then=="function"?(mt=a,Fe):a}}var mt=null;function wt(){if(mt===null)throw Error(s(459));var e=mt;return mt=null,e}function Dt(e){if(e===Fe||e===Ae)throw Error(s(483))}var vt=null,sn=0;function nn(e){var t=sn;return sn+=1,vt===null&&(vt=[]),ft(vt,e,t)}function ti(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Xt(e,t){throw t.$$typeof===E?Error(s(525)):(e=Object.prototype.toString.call(t),Error(s(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Cn(e){function t(Ge,qe){if(e){var nt=Ge.deletions;nt===null?(Ge.deletions=[qe],Ge.flags|=16):nt.push(qe)}}function a(Ge,qe){if(!e)return null;for(;qe!==null;)t(Ge,qe),qe=qe.sibling;return null}function u(Ge){for(var qe=new Map;Ge!==null;)Ge.key!==null?qe.set(Ge.key,Ge):qe.set(Ge.index,Ge),Ge=Ge.sibling;return qe}function h(Ge,qe){return Ge=bi(Ge,qe),Ge.index=0,Ge.sibling=null,Ge}function b(Ge,qe,nt){return Ge.index=nt,e?(nt=Ge.alternate,nt!==null?(nt=nt.index,nt<qe?(Ge.flags|=67108866,qe):nt):(Ge.flags|=67108866,qe)):(Ge.flags|=1048576,qe)}function M(Ge){return e&&Ge.alternate===null&&(Ge.flags|=67108866),Ge}function ue(Ge,qe,nt,Tt){return qe===null||qe.tag!==6?(qe=wc(nt,Ge.mode,Tt),qe.return=Ge,qe):(qe=h(qe,nt),qe.return=Ge,qe)}function Be(Ge,qe,nt,Tt){var Gn=nt.type;return Gn===D?St(Ge,qe,nt.props.children,Tt,nt.key):qe!==null&&(qe.elementType===Gn||typeof Gn=="object"&&Gn!==null&&Gn.$$typeof===pe&&Je(Gn)===qe.type)?(qe=h(qe,nt.props),ti(qe,nt),qe.return=Ge,qe):(qe=Rl(nt.type,nt.key,nt.props,null,Ge.mode,Tt),ti(qe,nt),qe.return=Ge,qe)}function it(Ge,qe,nt,Tt){return qe===null||qe.tag!==4||qe.stateNode.containerInfo!==nt.containerInfo||qe.stateNode.implementation!==nt.implementation?(qe=hl(nt,Ge.mode,Tt),qe.return=Ge,qe):(qe=h(qe,nt.children||[]),qe.return=Ge,qe)}function St(Ge,qe,nt,Tt,Gn){return qe===null||qe.tag!==7?(qe=pl(nt,Ge.mode,Tt,Gn),qe.return=Ge,qe):(qe=h(qe,nt),qe.return=Ge,qe)}function zt(Ge,qe,nt){if(typeof qe=="string"&&qe!==""||typeof qe=="number"||typeof qe=="bigint")return qe=wc(""+qe,Ge.mode,nt),qe.return=Ge,qe;if(typeof qe=="object"&&qe!==null){switch(qe.$$typeof){case T:return nt=Rl(qe.type,qe.key,qe.props,null,Ge.mode,nt),ti(nt,qe),nt.return=Ge,nt;case K:return qe=hl(qe,Ge.mode,nt),qe.return=Ge,qe;case pe:return qe=Je(qe),zt(Ge,qe,nt)}if(_e(qe)||R(qe))return qe=pl(qe,Ge.mode,nt,null),qe.return=Ge,qe;if(typeof qe.then=="function")return zt(Ge,nn(qe),nt);if(qe.$$typeof===$)return zt(Ge,Go(Ge,qe),nt);Xt(Ge,qe)}return null}function at(Ge,qe,nt,Tt){var Gn=qe!==null?qe.key:null;if(typeof nt=="string"&&nt!==""||typeof nt=="number"||typeof nt=="bigint")return Gn!==null?null:ue(Ge,qe,""+nt,Tt);if(typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case T:return nt.key===Gn?Be(Ge,qe,nt,Tt):null;case K:return nt.key===Gn?it(Ge,qe,nt,Tt):null;case pe:return nt=Je(nt),at(Ge,qe,nt,Tt)}if(_e(nt)||R(nt))return Gn!==null?null:St(Ge,qe,nt,Tt,null);if(typeof nt.then=="function")return at(Ge,qe,nn(nt),Tt);if(nt.$$typeof===$)return at(Ge,qe,Go(Ge,nt),Tt);Xt(Ge,nt)}return null}function dt(Ge,qe,nt,Tt,Gn){if(typeof Tt=="string"&&Tt!==""||typeof Tt=="number"||typeof Tt=="bigint")return Ge=Ge.get(nt)||null,ue(qe,Ge,""+Tt,Gn);if(typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case T:return Ge=Ge.get(Tt.key===null?nt:Tt.key)||null,Be(qe,Ge,Tt,Gn);case K:return Ge=Ge.get(Tt.key===null?nt:Tt.key)||null,it(qe,Ge,Tt,Gn);case pe:return Tt=Je(Tt),dt(Ge,qe,nt,Tt,Gn)}if(_e(Tt)||R(Tt))return Ge=Ge.get(nt)||null,St(qe,Ge,Tt,Gn,null);if(typeof Tt.then=="function")return dt(Ge,qe,nt,nn(Tt),Gn);if(Tt.$$typeof===$)return dt(Ge,qe,nt,Go(qe,Tt),Gn);Xt(qe,Tt)}return null}function kn(Ge,qe,nt,Tt){for(var Gn=null,cr=null,Ln=qe,Ai=qe=0,Ki=null;Ln!==null&&Ai<nt.length;Ai++){Ln.index>Ai?(Ki=Ln,Ln=null):Ki=Ln.sibling;var ur=at(Ge,Ln,nt[Ai],Tt);if(ur===null){Ln===null&&(Ln=Ki);break}e&&Ln&&ur.alternate===null&&t(Ge,Ln),qe=b(ur,qe,Ai),cr===null?Gn=ur:cr.sibling=ur,cr=ur,Ln=Ki}if(Ai===nt.length)return a(Ge,Ln),fi&&Yo(Ge,Ai),Gn;if(Ln===null){for(;Ai<nt.length;Ai++)Ln=zt(Ge,nt[Ai],Tt),Ln!==null&&(qe=b(Ln,qe,Ai),cr===null?Gn=Ln:cr.sibling=Ln,cr=Ln);return fi&&Yo(Ge,Ai),Gn}for(Ln=u(Ln);Ai<nt.length;Ai++)Ki=dt(Ln,Ge,Ai,nt[Ai],Tt),Ki!==null&&(e&&Ki.alternate!==null&&Ln.delete(Ki.key===null?Ai:Ki.key),qe=b(Ki,qe,Ai),cr===null?Gn=Ki:cr.sibling=Ki,cr=Ki);return e&&Ln.forEach(function(Eu){return t(Ge,Eu)}),fi&&Yo(Ge,Ai),Gn}function ei(Ge,qe,nt,Tt){if(nt==null)throw Error(s(151));for(var Gn=null,cr=null,Ln=qe,Ai=qe=0,Ki=null,ur=nt.next();Ln!==null&&!ur.done;Ai++,ur=nt.next()){Ln.index>Ai?(Ki=Ln,Ln=null):Ki=Ln.sibling;var Eu=at(Ge,Ln,ur.value,Tt);if(Eu===null){Ln===null&&(Ln=Ki);break}e&&Ln&&Eu.alternate===null&&t(Ge,Ln),qe=b(Eu,qe,Ai),cr===null?Gn=Eu:cr.sibling=Eu,cr=Eu,Ln=Ki}if(ur.done)return a(Ge,Ln),fi&&Yo(Ge,Ai),Gn;if(Ln===null){for(;!ur.done;Ai++,ur=nt.next())ur=zt(Ge,ur.value,Tt),ur!==null&&(qe=b(ur,qe,Ai),cr===null?Gn=ur:cr.sibling=ur,cr=ur);return fi&&Yo(Ge,Ai),Gn}for(Ln=u(Ln);!ur.done;Ai++,ur=nt.next())ur=dt(Ln,Ge,Ai,ur.value,Tt),ur!==null&&(e&&ur.alternate!==null&&Ln.delete(ur.key===null?Ai:ur.key),qe=b(ur,qe,Ai),cr===null?Gn=ur:cr.sibling=ur,cr=ur);return e&&Ln.forEach(function(Im){return t(Ge,Im)}),fi&&Yo(Ge,Ai),Gn}function qr(Ge,qe,nt,Tt){if(typeof nt=="object"&&nt!==null&&nt.type===D&&nt.key===null&&(nt=nt.props.children),typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case T:e:{for(var Gn=nt.key;qe!==null;){if(qe.key===Gn){if(Gn=nt.type,Gn===D){if(qe.tag===7){a(Ge,qe.sibling),Tt=h(qe,nt.props.children),Tt.return=Ge,Ge=Tt;break e}}else if(qe.elementType===Gn||typeof Gn=="object"&&Gn!==null&&Gn.$$typeof===pe&&Je(Gn)===qe.type){a(Ge,qe.sibling),Tt=h(qe,nt.props),ti(Tt,nt),Tt.return=Ge,Ge=Tt;break e}a(Ge,qe);break}else t(Ge,qe);qe=qe.sibling}nt.type===D?(Tt=pl(nt.props.children,Ge.mode,Tt,nt.key),Tt.return=Ge,Ge=Tt):(Tt=Rl(nt.type,nt.key,nt.props,null,Ge.mode,Tt),ti(Tt,nt),Tt.return=Ge,Ge=Tt)}return M(Ge);case K:e:{for(Gn=nt.key;qe!==null;){if(qe.key===Gn)if(qe.tag===4&&qe.stateNode.containerInfo===nt.containerInfo&&qe.stateNode.implementation===nt.implementation){a(Ge,qe.sibling),Tt=h(qe,nt.children||[]),Tt.return=Ge,Ge=Tt;break e}else{a(Ge,qe);break}else t(Ge,qe);qe=qe.sibling}Tt=hl(nt,Ge.mode,Tt),Tt.return=Ge,Ge=Tt}return M(Ge);case pe:return nt=Je(nt),qr(Ge,qe,nt,Tt)}if(_e(nt))return kn(Ge,qe,nt,Tt);if(R(nt)){if(Gn=R(nt),typeof Gn!="function")throw Error(s(150));return nt=Gn.call(nt),ei(Ge,qe,nt,Tt)}if(typeof nt.then=="function")return qr(Ge,qe,nn(nt),Tt);if(nt.$$typeof===$)return qr(Ge,qe,Go(Ge,nt),Tt);Xt(Ge,nt)}return typeof nt=="string"&&nt!==""||typeof nt=="number"||typeof nt=="bigint"?(nt=""+nt,qe!==null&&qe.tag===6?(a(Ge,qe.sibling),Tt=h(qe,nt),Tt.return=Ge,Ge=Tt):(a(Ge,qe),Tt=wc(nt,Ge.mode,Tt),Tt.return=Ge,Ge=Tt),M(Ge)):a(Ge,qe)}return function(Ge,qe,nt,Tt){try{sn=0;var Gn=qr(Ge,qe,nt,Tt);return vt=null,Gn}catch(Ln){if(Ln===Fe||Ln===Ae)throw Ln;var cr=Za(29,Ln,null,Ge.mode);return cr.lanes=Tt,cr.return=Ge,cr}finally{}}}var Nr=Cn(!0),ni=Cn(!1),gn=!1;function $t(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ar(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function yn(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Un(e,t,a){var u=e.updateQueue;if(u===null)return null;if(u=u.shared,(A&2)!==0){var h=u.pending;return h===null?t.next=t:(t.next=h.next,h.next=t),u.pending=t,t=hr(e),oa(e,null,a),t}return aa(e,u,t,a),hr(e)}function Bi(e,t,a){if(t=t.updateQueue,t!==null&&(t=t.shared,(a&4194048)!==0)){var u=t.lanes;u&=e.pendingLanes,a|=u,t.lanes=a,Et(e,a)}}function Ir(e,t){var a=e.updateQueue,u=e.alternate;if(u!==null&&(u=u.updateQueue,a===u)){var h=null,b=null;if(a=a.firstBaseUpdate,a!==null){do{var M={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};b===null?h=b=M:b=b.next=M,a=a.next}while(a!==null);b===null?h=b=t:b=b.next=t}else h=b=t;a={baseState:u.baseState,firstBaseUpdate:h,lastBaseUpdate:b,shared:u.shared,callbacks:u.callbacks},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=t:e.next=t,a.lastBaseUpdate=t}var la=!1;function Hi(){if(la){var e=x;if(e!==null)throw e}}function zr(e,t,a,u){la=!1;var h=e.updateQueue;gn=!1;var b=h.firstBaseUpdate,M=h.lastBaseUpdate,ue=h.shared.pending;if(ue!==null){h.shared.pending=null;var Be=ue,it=Be.next;Be.next=null,M===null?b=it:M.next=it,M=Be;var St=e.alternate;St!==null&&(St=St.updateQueue,ue=St.lastBaseUpdate,ue!==M&&(ue===null?St.firstBaseUpdate=it:ue.next=it,St.lastBaseUpdate=Be))}if(b!==null){var zt=h.baseState;M=0,St=it=Be=null,ue=b;do{var at=ue.lane&-536870913,dt=at!==ue.lane;if(dt?(Te&at)===at:(u&at)===at){at!==0&&at===f&&(la=!0),St!==null&&(St=St.next={lane:0,tag:ue.tag,payload:ue.payload,callback:null,next:null});e:{var kn=e,ei=ue;at=t;var qr=a;switch(ei.tag){case 1:if(kn=ei.payload,typeof kn=="function"){zt=kn.call(qr,zt,at);break e}zt=kn;break e;case 3:kn.flags=kn.flags&-65537|128;case 0:if(kn=ei.payload,at=typeof kn=="function"?kn.call(qr,zt,at):kn,at==null)break e;zt=_({},zt,at);break e;case 2:gn=!0}}at=ue.callback,at!==null&&(e.flags|=64,dt&&(e.flags|=8192),dt=h.callbacks,dt===null?h.callbacks=[at]:dt.push(at))}else dt={lane:at,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null},St===null?(it=St=dt,Be=zt):St=St.next=dt,M|=at;if(ue=ue.next,ue===null){if(ue=h.shared.pending,ue===null)break;dt=ue,ue=dt.next,dt.next=null,h.lastBaseUpdate=dt,h.shared.pending=null}}while(!0);St===null&&(Be=zt),h.baseState=Be,h.firstBaseUpdate=it,h.lastBaseUpdate=St,b===null&&(h.shared.lanes=0),De|=M,e.lanes=M,e.memoizedState=zt}}function fo(e,t){if(typeof e!="function")throw Error(s(191,e));e.call(t)}function Jr(e,t){var a=e.callbacks;if(a!==null)for(e.callbacks=null,e=0;e<a.length;e++)fo(a[e],t)}var Qn=C(null),ai=C(0);function _i(e,t){e=me,G(ai,e),G(Qn,t),me=e|t.baseLanes}function pi(){G(ai,me),G(Qn,Qn.current)}function xr(){me=ai.current,z(Qn),z(ai)}var yr=C(null),Oi=null;function Xi(e){var t=e.alternate;G(Fi,Fi.current&1),G(yr,e),Oi===null&&(t===null||Qn.current!==null||t.memoizedState!==null)&&(Oi=e)}function Wi(e){G(Fi,Fi.current),G(yr,e),Oi===null&&(Oi=e)}function Qr(e){e.tag===22?(G(Fi,Fi.current),G(yr,e),Oi===null&&(Oi=e)):ca()}function ca(){G(Fi,Fi.current),G(yr,yr.current)}function ar(e){z(yr),Oi===e&&(Oi=null),z(Fi)}var Fi=C(0);function Oa(e){for(var t=e;t!==null;){if(t.tag===13){var a=t.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||Ih(a)||Bh(a)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var sr=0,Pn=null,Mn=null,Ui=null,Io=!1,Bo=!1,po=!1,Br=0,bs=0,tl=null,ec=0;function tr(){throw Error(s(321))}function tc(e,t){if(t===null)return!1;for(var a=0;a<t.length&&a<e.length;a++)if(!Hr(e[a],t[a]))return!1;return!0}function Wc(e,t,a,u,h,b){return sr=b,Pn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ce.H=e===null||e.memoizedState===null?jd:hf,po=!1,b=a(u,h),po=!1,Bo&&(b=vs(t,a,u,h)),Tc(e),b}function Tc(e){ce.H=Ss;var t=Mn!==null&&Mn.next!==null;if(sr=0,Ui=Mn=Pn=null,Io=!1,bs=0,tl=null,t)throw Error(s(300));e===null||mr||(e=e.dependencies,e!==null&&sa(e)&&(mr=!0))}function vs(e,t,a,u){Pn=e;var h=0;do{if(Bo&&(tl=null),bs=0,Bo=!1,25<=h)throw Error(s(301));if(h+=1,Ui=Mn=null,e.updateQueue!=null){var b=e.updateQueue;b.lastEffect=null,b.events=null,b.stores=null,b.memoCache!=null&&(b.memoCache.index=0)}ce.H=sp,b=t(a,u)}while(Bo);return b}function Wu(){var e=ce.H,t=e.useState()[0];return t=typeof t.then=="function"?Hs(t):t,e=e.useState()[0],(Mn!==null?Mn.memoizedState:null)!==e&&(Pn.flags|=1024),t}function $c(){var e=Br!==0;return Br=0,e}function xu(e,t,a){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a}function yl(e){if(Io){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Io=!1}sr=0,Ui=Mn=Pn=null,Bo=!1,bs=Br=0,tl=null}function ea(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ui===null?Pn.memoizedState=Ui=e:Ui=Ui.next=e,Ui}function Er(){if(Mn===null){var e=Pn.alternate;e=e!==null?e.memoizedState:null}else e=Mn.next;var t=Ui===null?Pn.memoizedState:Ui.next;if(t!==null)Ui=t,Mn=e;else{if(e===null)throw Pn.alternate===null?Error(s(467)):Error(s(310));Mn=e,e={memoizedState:Mn.memoizedState,baseState:Mn.baseState,baseQueue:Mn.baseQueue,queue:Mn.queue,next:null},Ui===null?Pn.memoizedState=Ui=e:Ui=Ui.next=e}return Ui}function nc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Hs(e){var t=bs;return bs+=1,tl===null&&(tl=[]),e=ft(tl,e,t),t=Pn,(Ui===null?t.memoizedState:Ui.next)===null&&(t=t.alternate,ce.H=t===null||t.memoizedState===null?jd:hf),e}function Ml(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Hs(e);if(e.$$typeof===$)return Gi(e)}throw Error(s(438,String(e)))}function ic(e){var t=null,a=Pn.updateQueue;if(a!==null&&(t=a.memoCache),t==null){var u=Pn.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(t={data:u.data.map(function(h){return h.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),a===null&&(a=nc(),Pn.updateQueue=a),a.memoCache=t,a=t.data[t.index],a===void 0)for(a=t.data[t.index]=Array(e),u=0;u<e;u++)a[u]=X;return t.index++,a}function ho(e,t){return typeof t=="function"?t(e):t}function Cc(e){var t=Er();return nl(t,Mn,e)}function nl(e,t,a){var u=e.queue;if(u===null)throw Error(s(311));u.lastRenderedReducer=a;var h=e.baseQueue,b=u.pending;if(b!==null){if(h!==null){var M=h.next;h.next=b.next,b.next=M}t.baseQueue=h=b,u.pending=null}if(b=e.baseState,h===null)e.memoizedState=b;else{t=h.next;var ue=M=null,Be=null,it=t,St=!1;do{var zt=it.lane&-536870913;if(zt!==it.lane?(Te&zt)===zt:(sr&zt)===zt){var at=it.revertLane;if(at===0)Be!==null&&(Be=Be.next={lane:0,revertLane:0,gesture:null,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null}),zt===f&&(St=!0);else if((sr&at)===at){it=it.next,at===f&&(St=!0);continue}else zt={lane:0,revertLane:it.revertLane,gesture:null,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null},Be===null?(ue=Be=zt,M=b):Be=Be.next=zt,Pn.lanes|=at,De|=at;zt=it.action,po&&a(b,zt),b=it.hasEagerState?it.eagerState:a(b,zt)}else at={lane:zt,revertLane:it.revertLane,gesture:it.gesture,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null},Be===null?(ue=Be=at,M=b):Be=Be.next=at,Pn.lanes|=zt,De|=zt;it=it.next}while(it!==null&&it!==t);if(Be===null?M=b:Be.next=ue,!Hr(b,e.memoizedState)&&(mr=!0,St&&(a=x,a!==null)))throw a;e.memoizedState=b,e.baseState=M,e.baseQueue=Be,u.lastRenderedState=b}return h===null&&(u.lanes=0),[e.memoizedState,u.dispatch]}function Yc(e){var t=Er(),a=t.queue;if(a===null)throw Error(s(311));a.lastRenderedReducer=e;var u=a.dispatch,h=a.pending,b=t.memoizedState;if(h!==null){a.pending=null;var M=h=h.next;do b=e(b,M.action),M=M.next;while(M!==h);Hr(b,t.memoizedState)||(mr=!0),t.memoizedState=b,t.baseQueue===null&&(t.baseState=b),a.lastRenderedState=b}return[b,u]}function Gc(e,t,a){var u=Pn,h=Er(),b=fi;if(b){if(a===void 0)throw Error(s(407));a=a()}else a=t();var M=!Hr((Mn||h).memoizedState,a);if(M&&(h.memoizedState=a,mr=!0),h=h.queue,wd(Il.bind(null,u,h,e),[e]),h.getSnapshot!==t||M||Ui!==null&&Ui.memoizedState.tag&1){if(u.flags|=2048,oc(9,{destroy:void 0},yu.bind(null,u,h,a,t),null),je===null)throw Error(s(349));b||(sr&127)!==0||ws(u,t,a)}return a}function ws(e,t,a){e.flags|=16384,e={getSnapshot:t,value:a},t=Pn.updateQueue,t===null?(t=nc(),Pn.updateQueue=t,t.stores=[e]):(a=t.stores,a===null?t.stores=[e]:a.push(e))}function yu(e,t,a,u){t.value=a,t.getSnapshot=u,mu(t)&&bu(e)}function Il(e,t,a){return a(function(){mu(t)&&bu(e)})}function mu(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!Hr(e,a)}catch{return!0}}function bu(e){var t=va(e,2);t!==null&&Ni(t,e,2)}function ml(e){var t=ea();if(typeof e=="function"){var a=e;if(e=a(),po){At(!0);try{a()}finally{At(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ho,lastRenderedState:e},t}function Xc(e,t,a,u){return e.baseState=a,nl(e,Mn,typeof u=="function"?u:ho)}function Kc(e,t,a,u,h){if(Qc(e))throw Error(s(485));if(e=t.action,e!==null){var b={payload:h,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(M){b.listeners.push(M)}};ce.T!==null?a(!0):b.isTransition=!1,u(b),a=t.pending,a===null?(b.next=t.pending=b,rc(t,b)):(b.next=a.next,t.pending=a.next=b)}}function rc(e,t){var a=t.action,u=t.payload,h=e.state;if(t.isTransition){var b=ce.T,M={};ce.T=M;try{var ue=a(h,u),Be=ce.S;Be!==null&&Be(M,ue),kc(e,t,ue)}catch(it){ac(e,t,it)}finally{b!==null&&M.types!==null&&(b.types=M.types),ce.T=b}}else try{b=a(h,u),kc(e,t,b)}catch(it){ac(e,t,it)}}function kc(e,t,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(u){Nc(e,t,u)},function(u){return ac(e,t,u)}):Nc(e,t,a)}function Nc(e,t,a){t.status="fulfilled",t.value=a,Ac(t),e.state=a,t=e.pending,t!==null&&(a=t.next,a===t?e.pending=null:(a=a.next,t.next=a,rc(e,a)))}function ac(e,t,a){var u=e.pending;if(e.pending=null,u!==null){u=u.next;do t.status="rejected",t.reason=a,Ac(t),t=t.next;while(t!==u)}e.action=null}function Ac(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Zc(e,t){return t}function cs(e,t){if(fi){var a=je.formState;if(a!==null){e:{var u=Pn;if(fi){if(er){t:{for(var h=er,b=gr;h.nodeType!==8;){if(!b){h=null;break t}if(h=Ul(h.nextSibling),h===null){h=null;break t}}b=h.data,h=b==="F!"||b==="F"?h:null}if(h){er=Ul(h.nextSibling),u=h.data==="F!";break e}}Ll(u)}u=!1}u&&(t=a[0])}}return a=ea(),a.memoizedState=a.baseState=t,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zc,lastRenderedState:t},a.queue=u,a=ju.bind(null,Pn,u),u.dispatch=a,u=ml(!1),b=Tu.bind(null,Pn,!1,u.queue),u=ea(),h={state:t,dispatch:null,action:e,pending:null},u.queue=h,a=Kc.bind(null,Pn,h,b,a),h.dispatch=a,u.memoizedState=e,[t,a,!1]}function Fa(e){var t=Er();return Ua(t,Mn,e)}function Ua(e,t,a){if(t=nl(e,t,Zc)[0],e=Cc(ho)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var u=Hs(t)}catch(M){throw M===Fe?Ae:M}else u=t;t=Er();var h=t.queue,b=h.dispatch;return a!==t.memoizedState&&(Pn.flags|=2048,oc(9,{destroy:void 0},us.bind(null,h,a),null)),[u,b,e]}function us(e,t){e.action=t}function vu(e){var t=Er(),a=Mn;if(a!==null)return Ua(t,a,e);Er(),t=t.memoizedState,a=Er();var u=a.queue.dispatch;return a.memoizedState=e,[t,u,!1]}function oc(e,t,a,u){return e={tag:e,create:a,deps:u,inst:t,next:null},t=Pn.updateQueue,t===null&&(t=nc(),Pn.updateQueue=t),a=t.lastEffect,a===null?t.lastEffect=e.next=e:(u=a.next,a.next=e,e.next=u,t.lastEffect=e),e}function vd(){return Er().memoizedState}function zc(e,t,a,u){var h=ea();Pn.flags|=e,h.memoizedState=oc(1|t,{destroy:void 0},a,u===void 0?null:u)}function Pc(e,t,a,u){var h=Er();u=u===void 0?null:u;var b=h.memoizedState.inst;Mn!==null&&u!==null&&tc(u,Mn.memoizedState.deps)?h.memoizedState=oc(t,b,a,u):(Pn.flags|=e,h.memoizedState=oc(1|t,b,a,u))}function Zf(e,t){zc(8390656,8,e,t)}function wd(e,t){Pc(2048,8,e,t)}function Jf(e){Pn.flags|=4;var t=Pn.updateQueue;if(t===null)t=nc(),Pn.updateQueue=t,t.events=[e];else{var a=t.events;a===null?t.events=[e]:a.push(e)}}function bl(e){var t=Er().memoizedState;return Jf({ref:t,nextImpl:e}),function(){if((A&2)!==0)throw Error(s(440));return t.impl.apply(void 0,arguments)}}function cf(e,t){return Pc(4,2,e,t)}function Qf(e,t){return Pc(4,4,e,t)}function ep(e,t){if(typeof t=="function"){e=e();var a=t(e);return function(){typeof a=="function"?a():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function tp(e,t,a){a=a!=null?a.concat([e]):null,Pc(4,4,ep.bind(null,t,e),a)}function uf(){}function np(e,t){var a=Er();t=t===void 0?null:t;var u=a.memoizedState;return t!==null&&tc(t,u[1])?u[0]:(a.memoizedState=[e,t],e)}function ip(e,t){var a=Er();t=t===void 0?null:t;var u=a.memoizedState;if(t!==null&&tc(t,u[1]))return u[0];if(u=e(),po){At(!0);try{e()}finally{At(!1)}}return a.memoizedState=[u,t],u}function df(e,t,a){return a===void 0||(sr&1073741824)!==0&&(Te&261930)===0?e.memoizedState=t:(e.memoizedState=a,e=Wr(),Pn.lanes|=e,De|=e,a)}function rp(e,t,a,u){return Hr(a,t)?a:Qn.current!==null?(e=df(e,a,u),Hr(e,t)||(mr=!0),e):(sr&42)===0||(sr&1073741824)!==0&&(Te&261930)===0?(mr=!0,e.memoizedState=a):(e=Wr(),Pn.lanes|=e,De|=e,t)}function ap(e,t,a,u,h){var b=xe.p;xe.p=b!==0&&8>b?b:8;var M=ce.T,ue={};ce.T=ue,Tu(e,!1,t,a);try{var Be=h(),it=ce.S;if(it!==null&&it(ue,Be),Be!==null&&typeof Be=="object"&&typeof Be.then=="function"){var St=q(Be,u);sc(e,t,St,vi(e))}else sc(e,t,u,vi(e))}catch(zt){sc(e,t,{then:function(){},status:"rejected",reason:zt},vi())}finally{xe.p=b,M!==null&&ue.types!==null&&(M.types=ue.types),ce.T=M}}function xh(){}function ff(e,t,a,u){if(e.tag!==5)throw Error(s(476));var h=wu(e).queue;ap(e,h,t,fe,a===null?xh:function(){return Jc(e),a(u)})}function wu(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:fe,baseState:fe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ho,lastRenderedState:fe},next:null};var a={};return t.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ho,lastRenderedState:a},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function Jc(e){var t=wu(e);t.next===null&&(t=e.alternate.memoizedState),sc(e,t.next.queue,{},vi())}function _c(){return Gi(Df)}function $u(){return Er().memoizedState}function Su(){return Er().memoizedState}function pf(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var a=vi();e=yn(a);var u=Un(t,e,a);u!==null&&(Ni(u,t,a),Bi(u,t,a)),t={cache:co()},e.payload=t;return}t=t.return}}function Yu(e,t,a){var u=vi();a={lane:u,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},Qc(e)?op(t,a):(a=Pi(e,t,a,u),a!==null&&(Ni(a,e,u),Sd(a,t,u)))}function ju(e,t,a){var u=vi();sc(e,t,a,u)}function sc(e,t,a,u){var h={lane:u,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null};if(Qc(e))op(t,h);else{var b=e.alternate;if(e.lanes===0&&(b===null||b.lanes===0)&&(b=t.lastRenderedReducer,b!==null))try{var M=t.lastRenderedState,ue=b(M,a);if(h.hasEagerState=!0,h.eagerState=ue,Hr(ue,M))return aa(e,t,h,0),je===null&&_l(),!1}catch{}finally{}if(a=Pi(e,t,h,u),a!==null)return Ni(a,e,u),Sd(a,t,u),!0}return!1}function Tu(e,t,a,u){if(u={lane:2,revertLane:Th(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Qc(e)){if(t)throw Error(s(479))}else t=Pi(e,a,u,2),t!==null&&Ni(t,e,2)}function Qc(e){var t=e.alternate;return e===Pn||t!==null&&t===Pn}function op(e,t){Bo=Io=!0;var a=e.pending;a===null?t.next=t:(t.next=a.next,a.next=t),e.pending=t}function Sd(e,t,a){if((a&4194048)!==0){var u=t.lanes;u&=e.pendingLanes,a|=u,t.lanes=a,Et(e,a)}}var Ss={readContext:Gi,use:Ml,useCallback:tr,useContext:tr,useEffect:tr,useImperativeHandle:tr,useLayoutEffect:tr,useInsertionEffect:tr,useMemo:tr,useReducer:tr,useRef:tr,useState:tr,useDebugValue:tr,useDeferredValue:tr,useTransition:tr,useSyncExternalStore:tr,useId:tr,useHostTransitionStatus:tr,useFormState:tr,useActionState:tr,useOptimistic:tr,useMemoCache:tr,useCacheRefresh:tr};Ss.useEffectEvent=tr;var jd={readContext:Gi,use:Ml,useCallback:function(e,t){return ea().memoizedState=[e,t===void 0?null:t],e},useContext:Gi,useEffect:Zf,useImperativeHandle:function(e,t,a){a=a!=null?a.concat([e]):null,zc(4194308,4,ep.bind(null,t,e),a)},useLayoutEffect:function(e,t){return zc(4194308,4,e,t)},useInsertionEffect:function(e,t){zc(4,2,e,t)},useMemo:function(e,t){var a=ea();t=t===void 0?null:t;var u=e();if(po){At(!0);try{e()}finally{At(!1)}}return a.memoizedState=[u,t],u},useReducer:function(e,t,a){var u=ea();if(a!==void 0){var h=a(t);if(po){At(!0);try{a(t)}finally{At(!1)}}}else h=t;return u.memoizedState=u.baseState=h,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:h},u.queue=e,e=e.dispatch=Yu.bind(null,Pn,e),[u.memoizedState,e]},useRef:function(e){var t=ea();return e={current:e},t.memoizedState=e},useState:function(e){e=ml(e);var t=e.queue,a=ju.bind(null,Pn,t);return t.dispatch=a,[e.memoizedState,a]},useDebugValue:uf,useDeferredValue:function(e,t){var a=ea();return df(a,e,t)},useTransition:function(){var e=ml(!1);return e=ap.bind(null,Pn,e.queue,!0,!1),ea().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,a){var u=Pn,h=ea();if(fi){if(a===void 0)throw Error(s(407));a=a()}else{if(a=t(),je===null)throw Error(s(349));(Te&127)!==0||ws(u,t,a)}h.memoizedState=a;var b={value:a,getSnapshot:t};return h.queue=b,Zf(Il.bind(null,u,b,e),[e]),u.flags|=2048,oc(9,{destroy:void 0},yu.bind(null,u,b,a,t),null),a},useId:function(){var e=ea(),t=je.identifierPrefix;if(fi){var a=La,u=Da;a=(u&~(1<<32-un(u)-1)).toString(32)+a,t="_"+t+"R_"+a,a=Br++,0<a&&(t+="H"+a.toString(32)),t+="_"}else a=ec++,t="_"+t+"r_"+a.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:_c,useFormState:cs,useActionState:cs,useOptimistic:function(e){var t=ea();t.memoizedState=t.baseState=e;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=a,t=Tu.bind(null,Pn,!0,a),a.dispatch=t,[e,t]},useMemoCache:ic,useCacheRefresh:function(){return ea().memoizedState=pf.bind(null,Pn)},useEffectEvent:function(e){var t=ea(),a={impl:e};return t.memoizedState=a,function(){if((A&2)!==0)throw Error(s(440));return a.impl.apply(void 0,arguments)}}},hf={readContext:Gi,use:Ml,useCallback:np,useContext:Gi,useEffect:wd,useImperativeHandle:tp,useInsertionEffect:cf,useLayoutEffect:Qf,useMemo:ip,useReducer:Cc,useRef:vd,useState:function(){return Cc(ho)},useDebugValue:uf,useDeferredValue:function(e,t){var a=Er();return rp(a,Mn.memoizedState,e,t)},useTransition:function(){var e=Cc(ho)[0],t=Er().memoizedState;return[typeof e=="boolean"?e:Hs(e),t]},useSyncExternalStore:Gc,useId:$u,useHostTransitionStatus:_c,useFormState:Fa,useActionState:Fa,useOptimistic:function(e,t){var a=Er();return Xc(a,Mn,e,t)},useMemoCache:ic,useCacheRefresh:Su};hf.useEffectEvent=bl;var sp={readContext:Gi,use:Ml,useCallback:np,useContext:Gi,useEffect:wd,useImperativeHandle:tp,useInsertionEffect:cf,useLayoutEffect:Qf,useMemo:ip,useReducer:Yc,useRef:vd,useState:function(){return Yc(ho)},useDebugValue:uf,useDeferredValue:function(e,t){var a=Er();return Mn===null?df(a,e,t):rp(a,Mn.memoizedState,e,t)},useTransition:function(){var e=Yc(ho)[0],t=Er().memoizedState;return[typeof e=="boolean"?e:Hs(e),t]},useSyncExternalStore:Gc,useId:$u,useHostTransitionStatus:_c,useFormState:vu,useActionState:vu,useOptimistic:function(e,t){var a=Er();return Mn!==null?Xc(a,Mn,e,t):(a.baseState=e,[e,a.queue.dispatch])},useMemoCache:ic,useCacheRefresh:Su};sp.useEffectEvent=bl;function Bl(e,t,a,u){t=e.memoizedState,a=a(u,t),a=a==null?t:_({},t,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var gf={enqueueSetState:function(e,t,a){e=e._reactInternals;var u=vi(),h=yn(u);h.payload=t,a!=null&&(h.callback=a),t=Un(e,h,u),t!==null&&(Ni(t,e,u),Bi(t,e,u))},enqueueReplaceState:function(e,t,a){e=e._reactInternals;var u=vi(),h=yn(u);h.tag=1,h.payload=t,a!=null&&(h.callback=a),t=Un(e,h,u),t!==null&&(Ni(t,e,u),Bi(t,e,u))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var a=vi(),u=yn(a);u.tag=2,t!=null&&(u.callback=t),t=Un(e,u,a),t!==null&&(Ni(t,e,a),Bi(t,e,a))}};function Td(e,t,a,u,h,b,M){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(u,b,M):t.prototype&&t.prototype.isPureReactComponent?!Yi(a,u)||!Yi(h,b):!0}function xf(e,t,a,u){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(a,u),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(a,u),t.state!==e&&gf.enqueueReplaceState(t,t.state,null)}function lc(e,t){var a=t;if("ref"in t){a={};for(var u in t)u!=="ref"&&(a[u]=t[u])}if(e=e.defaultProps){a===t&&(a=_({},a));for(var h in e)a[h]===void 0&&(a[h]=e[h])}return a}function Gu(e){os(e)}function Xu(e){console.error(e)}function Ku(e){os(e)}function Cd(e,t){try{var a=e.onUncaughtError;a(t.value,{componentStack:t.stack})}catch(u){setTimeout(function(){throw u})}}function kd(e,t,a){try{var u=e.onCaughtError;u(a.value,{componentStack:a.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(h){setTimeout(function(){throw h})}}function Zu(e,t,a){return a=yn(a),a.tag=3,a.payload={element:null},a.callback=function(){Cd(e,t)},a}function lp(e){return e=yn(e),e.tag=3,e}function cp(e,t,a,u){var h=a.type.getDerivedStateFromError;if(typeof h=="function"){var b=u.value;e.payload=function(){return h(b)},e.callback=function(){kd(t,a,u)}}var M=a.stateNode;M!==null&&typeof M.componentDidCatch=="function"&&(e.callback=function(){kd(t,a,u),typeof h!="function"&&(Rt===null?Rt=new Set([this]):Rt.add(this));var ue=u.stack;this.componentDidCatch(u.value,{componentStack:ue!==null?ue:""})})}function Ws(e,t,a,u,h){if(a.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(t=a.alternate,t!==null&&xl(t,a,h,!0),a=yr.current,a!==null){switch(a.tag){case 31:case 13:return Oi===null?Sp():a.alternate===null&&Me===0&&(Me=3),a.flags&=-257,a.flags|=65536,a.lanes=h,u===Ve?a.flags|=16384:(t=a.updateQueue,t===null?a.updateQueue=new Set([u]):t.add(u),wh(e,u,h)),!1;case 22:return a.flags|=65536,u===Ve?a.flags|=16384:(t=a.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([u])},a.updateQueue=t):(a=t.retryQueue,a===null?t.retryQueue=new Set([u]):a.add(u)),wh(e,u,h)),!1}throw Error(s(435,a.tag))}return wh(e,u,h),Sp(),!1}if(fi)return t=yr.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=h,u!==wa&&(e=Error(s(422),{cause:u}),Jl(lo(e,a)))):(u!==wa&&(t=Error(s(423),{cause:u}),Jl(lo(t,a))),e=e.current.alternate,e.flags|=65536,h&=-h,e.lanes|=h,u=lo(u,a),h=Zu(e.stateNode,u,h),Ir(e,h),Me!==4&&(Me=2)),!1;var b=Error(s(520),{cause:u});if(b=lo(b,a),st===null?st=[b]:st.push(b),Me!==4&&(Me=2),t===null)return!0;u=lo(u,a),a=t;do{switch(a.tag){case 3:return a.flags|=65536,e=h&-h,a.lanes|=e,e=Zu(a.stateNode,u,e),Ir(a,e),!1;case 1:if(t=a.type,b=a.stateNode,(a.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Rt===null||!Rt.has(b))))return a.flags|=65536,h&=-h,a.lanes|=h,h=lp(h),cp(h,e,a,u),Ir(a,h),!1}a=a.return}while(a!==null);return!1}var yf=Error(s(461)),mr=!1;function go(e,t,a,u){t.child=e===null?ni(t,null,a,u):Nr(t,e.child,a,u)}function eu(e,t,a,u,h){a=a.render;var b=t.ref;if("ref"in u){var M={};for(var ue in u)ue!=="ref"&&(M[ue]=u[ue])}else M=u;return Ea(t),u=Wc(e,t,a,M,b,h),ue=$c(),e!==null&&!mr?(xu(e,t,h),ds(e,t,h)):(fi&&ue&&hu(t),t.flags|=1,go(e,t,u,h),t.child)}function mf(e,t,a,u,h){if(e===null){var b=a.type;return typeof b=="function"&&!Xl(b)&&b.defaultProps===void 0&&a.compare===null?(t.tag=15,t.type=b,cc(e,t,b,u,h)):(e=Rl(a.type,null,u,t,t.mode,h),e.ref=t.ref,e.return=t,t.child=e)}if(b=e.child,!iu(e,h)){var M=b.memoizedProps;if(a=a.compare,a=a!==null?a:Yi,a(M,u)&&e.ref===t.ref)return ds(e,t,h)}return t.flags|=1,e=bi(b,u),e.ref=t.ref,e.return=t,t.child=e}function cc(e,t,a,u,h){if(e!==null){var b=e.memoizedProps;if(Yi(b,u)&&e.ref===t.ref)if(mr=!1,t.pendingProps=u=b,iu(e,h))(e.flags&131072)!==0&&(mr=!0);else return t.lanes=e.lanes,ds(e,t,h)}return zd(e,t,a,u,h)}function Nd(e,t,a,u){var h=u.children,b=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((t.flags&128)!==0){if(b=b!==null?b.baseLanes|a:a,e!==null){for(u=t.child=e.child,h=0;u!==null;)h=h|u.lanes|u.childLanes,u=u.sibling;u=h&~b}else u=0,t.child=null;return bf(e,t,b,a,u)}if((a&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&te(t,b!==null?b.cachePool:null),b!==null?_i(t,b):pi(),Qr(t);else return u=t.lanes=536870912,bf(e,t,b!==null?b.baseLanes|a:a,a,u)}else b!==null?(te(t,b.cachePool),_i(t,b),ca(),t.memoizedState=null):(e!==null&&te(t,null),pi(),ca());return go(e,t,h,a),t.child}function Cu(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function bf(e,t,a,u,h){var b=J();return b=b===null?null:{parent:Ii._currentValue,pool:b},t.memoizedState={baseLanes:a,cachePool:b},e!==null&&te(t,null),pi(),Qr(t),e!==null&&xl(e,t,u,!0),t.childLanes=h,null}function Ad(e,t){return t=Rd({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function up(e,t,a){return Nr(t,e.child,null,a),e=Ad(t,t.pendingProps),e.flags|=2,ar(t),t.memoizedState=null,e}function yh(e,t,a){var u=t.pendingProps,h=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(fi){if(u.mode==="hidden")return e=Ad(t,u),t.lanes=536870912,Cu(null,e);if(Wi(t),(e=er)?(e=R0(e,gr),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Fs!==null?{id:Da,overflow:La}:null,retryLane:536870912,hydrationErrors:null},a=Sc(e),a.return=t,t.child=a,Ia=t,er=null)):e=null,e===null)throw Ll(t);return t.lanes=536870912,null}return Ad(t,u)}var b=e.memoizedState;if(b!==null){var M=b.dehydrated;if(Wi(t),h)if(t.flags&256)t.flags&=-257,t=up(e,t,a);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(s(558));else if(mr||xl(e,t,a,!1),h=(a&e.childLanes)!==0,mr||h){if(u=je,u!==null&&(M=Bt(u,a),M!==0&&M!==b.retryLane))throw b.retryLane=M,va(e,M),Ni(u,e,M),yf;Sp(),t=up(e,t,a)}else e=b.treeContext,er=Ul(M.nextSibling),Ia=t,fi=!0,Ba=null,gr=!1,e!==null&&qc(t,e),t=Ad(t,u),t.flags|=4096;return t}return e=bi(e.child,{mode:u.mode,children:u.children}),e.ref=t.ref,t.child=e,e.return=t,e}function tu(e,t){var a=t.ref;if(a===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(s(284));(e===null||e.ref!==a)&&(t.flags|=4194816)}}function zd(e,t,a,u,h){return Ea(t),a=Wc(e,t,a,u,void 0,h),u=$c(),e!==null&&!mr?(xu(e,t,h),ds(e,t,h)):(fi&&u&&hu(t),t.flags|=1,go(e,t,a,h),t.child)}function dp(e,t,a,u,h,b){return Ea(t),t.updateQueue=null,a=vs(t,u,a,h),Tc(e),u=$c(),e!==null&&!mr?(xu(e,t,b),ds(e,t,b)):(fi&&u&&hu(t),t.flags|=1,go(e,t,a,b),t.child)}function vf(e,t,a,u,h){if(Ea(t),t.stateNode===null){var b=Ka,M=a.contextType;typeof M=="object"&&M!==null&&(b=Gi(M)),b=new a(u,b),t.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=gf,t.stateNode=b,b._reactInternals=t,b=t.stateNode,b.props=u,b.state=t.memoizedState,b.refs={},$t(t),M=a.contextType,b.context=typeof M=="object"&&M!==null?Gi(M):Ka,b.state=t.memoizedState,M=a.getDerivedStateFromProps,typeof M=="function"&&(Bl(t,a,M,u),b.state=t.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(M=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),M!==b.state&&gf.enqueueReplaceState(b,b.state,null),zr(t,u,b,h),Hi(),b.state=t.memoizedState),typeof b.componentDidMount=="function"&&(t.flags|=4194308),u=!0}else if(e===null){b=t.stateNode;var ue=t.memoizedProps,Be=lc(a,ue);b.props=Be;var it=b.context,St=a.contextType;M=Ka,typeof St=="object"&&St!==null&&(M=Gi(St));var zt=a.getDerivedStateFromProps;St=typeof zt=="function"||typeof b.getSnapshotBeforeUpdate=="function",ue=t.pendingProps!==ue,St||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(ue||it!==M)&&xf(t,b,u,M),gn=!1;var at=t.memoizedState;b.state=at,zr(t,u,b,h),Hi(),it=t.memoizedState,ue||at!==it||gn?(typeof zt=="function"&&(Bl(t,a,zt,u),it=t.memoizedState),(Be=gn||Td(t,a,Be,u,at,it,M))?(St||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(t.flags|=4194308)):(typeof b.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=u,t.memoizedState=it),b.props=u,b.state=it,b.context=M,u=Be):(typeof b.componentDidMount=="function"&&(t.flags|=4194308),u=!1)}else{b=t.stateNode,Ar(e,t),M=t.memoizedProps,St=lc(a,M),b.props=St,zt=t.pendingProps,at=b.context,it=a.contextType,Be=Ka,typeof it=="object"&&it!==null&&(Be=Gi(it)),ue=a.getDerivedStateFromProps,(it=typeof ue=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(M!==zt||at!==Be)&&xf(t,b,u,Be),gn=!1,at=t.memoizedState,b.state=at,zr(t,u,b,h),Hi();var dt=t.memoizedState;M!==zt||at!==dt||gn||e!==null&&e.dependencies!==null&&sa(e.dependencies)?(typeof ue=="function"&&(Bl(t,a,ue,u),dt=t.memoizedState),(St=gn||Td(t,a,St,u,at,dt,Be)||e!==null&&e.dependencies!==null&&sa(e.dependencies))?(it||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(u,dt,Be),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(u,dt,Be)),typeof b.componentDidUpdate=="function"&&(t.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof b.componentDidUpdate!="function"||M===e.memoizedProps&&at===e.memoizedState||(t.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||M===e.memoizedProps&&at===e.memoizedState||(t.flags|=1024),t.memoizedProps=u,t.memoizedState=dt),b.props=u,b.state=dt,b.context=Be,u=St):(typeof b.componentDidUpdate!="function"||M===e.memoizedProps&&at===e.memoizedState||(t.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||M===e.memoizedProps&&at===e.memoizedState||(t.flags|=1024),u=!1)}return b=u,tu(e,t),u=(t.flags&128)!==0,b||u?(b=t.stateNode,a=u&&typeof a.getDerivedStateFromError!="function"?null:b.render(),t.flags|=1,e!==null&&u?(t.child=Nr(t,e.child,null,h),t.child=Nr(t,null,a,h)):go(e,t,a,h),t.memoizedState=b.state,e=t.child):e=ds(e,t,h),e}function ku(e,t,a,u){return Zl(),t.flags|=256,go(e,t,a,u),t.child}var wf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ju(e){return{baseLanes:e,cachePool:Pe()}}function Pd(e,t,a){return e=e!==null?e.childLanes&~a:0,t&&(e|=pt),e}function _d(e,t,a){var u=t.pendingProps,h=!1,b=(t.flags&128)!==0,M;if((M=b)||(M=e!==null&&e.memoizedState===null?!1:(Fi.current&2)!==0),M&&(h=!0,t.flags&=-129),M=(t.flags&32)!==0,t.flags&=-33,e===null){if(fi){if(h?Xi(t):ca(),(e=er)?(e=R0(e,gr),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Fs!==null?{id:Da,overflow:La}:null,retryLane:536870912,hydrationErrors:null},a=Sc(e),a.return=t,t.child=a,Ia=t,er=null)):e=null,e===null)throw Ll(t);return Bh(e)?t.lanes=32:t.lanes=536870912,null}var ue=u.children;return u=u.fallback,h?(ca(),h=t.mode,ue=Rd({mode:"hidden",children:ue},h),u=pl(u,h,a,null),ue.return=t,u.return=t,ue.sibling=u,t.child=ue,u=t.child,u.memoizedState=Ju(a),u.childLanes=Pd(e,M,a),t.memoizedState=wf,Cu(null,u)):(Xi(t),Qu(t,ue))}var Be=e.memoizedState;if(Be!==null&&(ue=Be.dehydrated,ue!==null)){if(b)t.flags&256?(Xi(t),t.flags&=-257,t=Sf(e,t,a)):t.memoizedState!==null?(ca(),t.child=e.child,t.flags|=128,t=null):(ca(),ue=u.fallback,h=t.mode,u=Rd({mode:"visible",children:u.children},h),ue=pl(ue,h,a,null),ue.flags|=2,u.return=t,ue.return=t,u.sibling=ue,t.child=u,Nr(t,e.child,null,a),u=t.child,u.memoizedState=Ju(a),u.childLanes=Pd(e,M,a),t.memoizedState=wf,t=Cu(null,u));else if(Xi(t),Bh(ue)){if(M=ue.nextSibling&&ue.nextSibling.dataset,M)var it=M.dgst;M=it,u=Error(s(419)),u.stack="",u.digest=M,Jl({value:u,source:null,stack:null}),t=Sf(e,t,a)}else if(mr||xl(e,t,a,!1),M=(a&e.childLanes)!==0,mr||M){if(M=je,M!==null&&(u=Bt(M,a),u!==0&&u!==Be.retryLane))throw Be.retryLane=u,va(e,u),Ni(M,e,u),yf;Ih(ue)||Sp(),t=Sf(e,t,a)}else Ih(ue)?(t.flags|=192,t.child=e.child,t=null):(e=Be.treeContext,er=Ul(ue.nextSibling),Ia=t,fi=!0,Ba=null,gr=!1,e!==null&&qc(t,e),t=Qu(t,u.children),t.flags|=4096);return t}return h?(ca(),ue=u.fallback,h=t.mode,Be=e.child,it=Be.sibling,u=bi(Be,{mode:"hidden",children:u.children}),u.subtreeFlags=Be.subtreeFlags&65011712,it!==null?ue=bi(it,ue):(ue=pl(ue,h,a,null),ue.flags|=2),ue.return=t,u.return=t,u.sibling=ue,t.child=u,Cu(null,u),u=t.child,ue=e.child.memoizedState,ue===null?ue=Ju(a):(h=ue.cachePool,h!==null?(Be=Ii._currentValue,h=h.parent!==Be?{parent:Be,pool:Be}:h):h=Pe(),ue={baseLanes:ue.baseLanes|a,cachePool:h}),u.memoizedState=ue,u.childLanes=Pd(e,M,a),t.memoizedState=wf,Cu(e.child,u)):(Xi(t),a=e.child,e=a.sibling,a=bi(a,{mode:"visible",children:u.children}),a.return=t,a.sibling=null,e!==null&&(M=t.deletions,M===null?(t.deletions=[e],t.flags|=16):M.push(e)),t.child=a,t.memoizedState=null,a)}function Qu(e,t){return t=Rd({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function Rd(e,t){return e=Za(22,e,null,t),e.lanes=0,e}function Sf(e,t,a){return Nr(t,e.child,null,a),e=Qu(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function jf(e,t,a){e.lanes|=t;var u=e.alternate;u!==null&&(u.lanes|=t),ha(e.return,t,a)}function nu(e,t,a,u,h,b){var M=e.memoizedState;M===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:u,tail:a,tailMode:h,treeForkCount:b}:(M.isBackwards=t,M.rendering=null,M.renderingStartTime=0,M.last=u,M.tail=a,M.tailMode=h,M.treeForkCount=b)}function Dd(e,t,a){var u=t.pendingProps,h=u.revealOrder,b=u.tail;u=u.children;var M=Fi.current,ue=(M&2)!==0;if(ue?(M=M&1|2,t.flags|=128):M&=1,G(Fi,M),go(e,t,u,a),u=fi?Os:0,!ue&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&jf(e,a,t);else if(e.tag===19)jf(e,a,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(h){case"forwards":for(a=t.child,h=null;a!==null;)e=a.alternate,e!==null&&Oa(e)===null&&(h=a),a=a.sibling;a=h,a===null?(h=t.child,t.child=null):(h=a.sibling,a.sibling=null),nu(t,!1,h,a,b,u);break;case"backwards":case"unstable_legacy-backwards":for(a=null,h=t.child,t.child=null;h!==null;){if(e=h.alternate,e!==null&&Oa(e)===null){t.child=h;break}e=h.sibling,h.sibling=a,a=h,h=e}nu(t,!0,a,null,b,u);break;case"together":nu(t,!1,null,null,void 0,u);break;default:t.memoizedState=null}return t.child}function ds(e,t,a){if(e!==null&&(t.dependencies=e.dependencies),De|=t.lanes,(a&t.childLanes)===0)if(e!==null){if(xl(e,t,a,!1),(a&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(s(153));if(t.child!==null){for(e=t.child,a=bi(e,e.pendingProps),t.child=a,a.return=t;e.sibling!==null;)e=e.sibling,a=a.sibling=bi(e,e.pendingProps),a.return=t;a.sibling=null}return t.child}function iu(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&sa(e)))}function uc(e,t,a){switch(t.tag){case 3:Le(t,t.stateNode.containerInfo),Zr(t,Ii,e.memoizedState.cache),Zl();break;case 27:case 5:Ue(t);break;case 4:Le(t,t.stateNode.containerInfo);break;case 10:Zr(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,Wi(t),null;break;case 13:var u=t.memoizedState;if(u!==null)return u.dehydrated!==null?(Xi(t),t.flags|=128,null):(a&t.child.childLanes)!==0?_d(e,t,a):(Xi(t),e=ds(e,t,a),e!==null?e.sibling:null);Xi(t);break;case 19:var h=(e.flags&128)!==0;if(u=(a&t.childLanes)!==0,u||(xl(e,t,a,!1),u=(a&t.childLanes)!==0),h){if(u)return Dd(e,t,a);t.flags|=128}if(h=t.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),G(Fi,Fi.current),u)break;return null;case 22:return t.lanes=0,Nd(e,t,a,t.pendingProps);case 24:Zr(t,Ii,e.memoizedState.cache)}return ds(e,t,a)}function Nu(e,t,a){if(e!==null)if(e.memoizedProps!==t.pendingProps)mr=!0;else{if(!iu(e,a)&&(t.flags&128)===0)return mr=!1,uc(e,t,a);mr=(e.flags&131072)!==0}else mr=!1,fi&&(t.flags&1048576)!==0&&Us(t,Os,t.index);switch(t.lanes=0,t.tag){case 16:e:{var u=t.pendingProps;if(e=Je(t.elementType),t.type=e,typeof e=="function")Xl(e)?(u=lc(e,u),t.tag=1,t=vf(null,t,e,u,a)):(t.tag=0,t=zd(null,t,e,u,a));else{if(e!=null){var h=e.$$typeof;if(h===H){t.tag=11,t=eu(null,t,e,u,a);break e}else if(h===oe){t.tag=14,t=mf(null,t,e,u,a);break e}}throw t=O(e)||e,Error(s(306,t,""))}}return t;case 0:return zd(e,t,t.type,t.pendingProps,a);case 1:return u=t.type,h=lc(u,t.pendingProps),vf(e,t,u,h,a);case 3:e:{if(Le(t,t.stateNode.containerInfo),e===null)throw Error(s(387));u=t.pendingProps;var b=t.memoizedState;h=b.element,Ar(e,t),zr(t,u,null,a);var M=t.memoizedState;if(u=M.cache,Zr(t,Ii,u),u!==b.cache&&Ql(t,[Ii],a,!0),Hi(),u=M.element,b.isDehydrated)if(b={element:u,isDehydrated:!1,cache:M.cache},t.updateQueue.baseState=b,t.memoizedState=b,t.flags&256){t=ku(e,t,u,a);break e}else if(u!==h){h=lo(Error(s(424)),t),Jl(h),t=ku(e,t,u,a);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(er=Ul(e.firstChild),Ia=t,fi=!0,Ba=null,gr=!0,a=ni(t,null,u,a),t.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling}else{if(Zl(),u===h){t=ds(e,t,a);break e}go(e,t,u,a)}t=t.child}return t;case 26:return tu(e,t),e===null?(a=E0(t.type,null,t.pendingProps,null))?t.memoizedState=a:fi||(a=t.type,e=t.pendingProps,u=zp(he.current).createElement(a),u[yt]=t,u[si]=e,ps(u,a,e),jr(u),t.stateNode=u):t.memoizedState=E0(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Ue(t),e===null&&fi&&(u=t.stateNode=M0(t.type,t.pendingProps,he.current),Ia=t,gr=!0,h=er,Du(t.type)?(Eh=h,er=Ul(u.firstChild)):er=h),go(e,t,t.pendingProps.children,a),tu(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&fi&&((h=u=er)&&(u=fm(u,t.type,t.pendingProps,gr),u!==null?(t.stateNode=u,Ia=t,er=Ul(u.firstChild),gr=!1,h=!0):h=!1),h||Ll(t)),Ue(t),h=t.type,b=t.pendingProps,M=e!==null?e.memoizedProps:null,u=b.children,Dh(h,b)?u=null:M!==null&&Dh(h,M)&&(t.flags|=32),t.memoizedState!==null&&(h=Wc(e,t,Wu,null,null,a),Df._currentValue=h),tu(e,t),go(e,t,u,a),t.child;case 6:return e===null&&fi&&((e=a=er)&&(a=pm(a,t.pendingProps,gr),a!==null?(t.stateNode=a,Ia=t,er=null,e=!0):e=!1),e||Ll(t)),null;case 13:return _d(e,t,a);case 4:return Le(t,t.stateNode.containerInfo),u=t.pendingProps,e===null?t.child=Nr(t,null,u,a):go(e,t,u,a),t.child;case 11:return eu(e,t,t.type,t.pendingProps,a);case 7:return go(e,t,t.pendingProps,a),t.child;case 8:return go(e,t,t.pendingProps.children,a),t.child;case 12:return go(e,t,t.pendingProps.children,a),t.child;case 10:return u=t.pendingProps,Zr(t,t.type,u.value),go(e,t,u.children,a),t.child;case 9:return h=t.type._context,u=t.pendingProps.children,Ea(t),h=Gi(h),u=u(h),t.flags|=1,go(e,t,u,a),t.child;case 14:return mf(e,t,t.type,t.pendingProps,a);case 15:return cc(e,t,t.type,t.pendingProps,a);case 19:return Dd(e,t,a);case 31:return yh(e,t,a);case 22:return Nd(e,t,a,t.pendingProps);case 24:return Ea(t),u=Gi(Ii),e===null?(h=J(),h===null&&(h=je,b=co(),h.pooledCache=b,b.refCount++,b!==null&&(h.pooledCacheLanes|=a),h=b),t.memoizedState={parent:u,cache:h},$t(t),Zr(t,Ii,h)):((e.lanes&a)!==0&&(Ar(e,t),zr(t,null,null,a),Hi()),h=e.memoizedState,b=t.memoizedState,h.parent!==u?(h={parent:u,cache:u},t.memoizedState=h,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=h),Zr(t,Ii,u)):(u=b.cache,Zr(t,Ii,u),u!==h.cache&&Ql(t,[Ii],a,!0))),go(e,t,t.pendingProps.children,a),t.child;case 29:throw t.pendingProps}throw Error(s(156,t.tag))}function vl(e){e.flags|=4}function ed(e,t,a,u,h){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(h&335544128)===h)if(e.stateNode.complete)e.flags|=8192;else if(e0())e.flags|=8192;else throw mt=Ve,tt}else e.flags&=-16777217}function Ld(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!V0(t))if(e0())e.flags|=8192;else throw mt=Ve,tt}function xo(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?wr():536870912,e.lanes|=t,Nt|=t)}function ru(e,t){if(!fi)switch(e.tailMode){case"hidden":t=e.tail;for(var a=null;t!==null;)t.alternate!==null&&(a=t),t=t.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var u=null;a!==null;)a.alternate!==null&&(u=a),a=a.sibling;u===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:u.sibling=null}}function Or(e){var t=e.alternate!==null&&e.alternate.child===e.child,a=0,u=0;if(t)for(var h=e.child;h!==null;)a|=h.lanes|h.childLanes,u|=h.subtreeFlags&65011712,u|=h.flags&65011712,h.return=e,h=h.sibling;else for(h=e.child;h!==null;)a|=h.lanes|h.childLanes,u|=h.subtreeFlags,u|=h.flags,h.return=e,h=h.sibling;return e.subtreeFlags|=u,e.childLanes=a,t}function mh(e,t,a){var u=t.pendingProps;switch(Ma(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Or(t),null;case 1:return Or(t),null;case 3:return a=t.stateNode,u=null,e!==null&&(u=e.memoizedState.cache),t.memoizedState.cache!==u&&(t.flags|=2048),Sa(Ii),Re(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(Qa(t)?vl(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Vc())),Or(t),null;case 26:var h=t.type,b=t.memoizedState;return e===null?(vl(t),b!==null?(Or(t),Ld(t,b)):(Or(t),ed(t,h,null,u,a))):b?b!==e.memoizedState?(vl(t),Or(t),Ld(t,b)):(Or(t),t.flags&=-16777217):(e=e.memoizedProps,e!==u&&vl(t),Or(t),ed(t,h,e,u,a)),null;case 27:if(et(t),a=he.current,h=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==u&&vl(t);else{if(!u){if(t.stateNode===null)throw Error(s(166));return Or(t),null}e=V.current,Qa(t)?gu(t):(e=M0(h,u,a),t.stateNode=e,vl(t))}return Or(t),null;case 5:if(et(t),h=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==u&&vl(t);else{if(!u){if(t.stateNode===null)throw Error(s(166));return Or(t),null}if(b=V.current,Qa(t))gu(t);else{var M=zp(he.current);switch(b){case 1:b=M.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:b=M.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":b=M.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":b=M.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":b=M.createElement("div"),b.innerHTML="<script><\/script>",b=b.removeChild(b.firstChild);break;case"select":b=typeof u.is=="string"?M.createElement("select",{is:u.is}):M.createElement("select"),u.multiple?b.multiple=!0:u.size&&(b.size=u.size);break;default:b=typeof u.is=="string"?M.createElement(h,{is:u.is}):M.createElement(h)}}b[yt]=t,b[si]=u;e:for(M=t.child;M!==null;){if(M.tag===5||M.tag===6)b.appendChild(M.stateNode);else if(M.tag!==4&&M.tag!==27&&M.child!==null){M.child.return=M,M=M.child;continue}if(M===t)break e;for(;M.sibling===null;){if(M.return===null||M.return===t)break e;M=M.return}M.sibling.return=M.return,M=M.sibling}t.stateNode=b;e:switch(ps(b,h,u),h){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&vl(t)}}return Or(t),ed(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,a),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==u&&vl(t);else{if(typeof u!="string"&&t.stateNode===null)throw Error(s(166));if(e=he.current,Qa(t)){if(e=t.stateNode,a=t.memoizedProps,u=null,h=Ia,h!==null)switch(h.tag){case 27:case 5:u=h.memoizedProps}e[yt]=t,e=!!(e.nodeValue===a||u!==null&&u.suppressHydrationWarning===!0||T0(e.nodeValue,a)),e||Ll(t,!0)}else e=zp(e).createTextNode(u),e[yt]=t,t.stateNode=e}return Or(t),null;case 31:if(a=t.memoizedState,e===null||e.memoizedState!==null){if(u=Qa(t),a!==null){if(e===null){if(!u)throw Error(s(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(557));e[yt]=t}else Zl(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Or(t),e=!1}else a=Vc(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=a),e=!0;if(!e)return t.flags&256?(ar(t),t):(ar(t),null);if((t.flags&128)!==0)throw Error(s(558))}return Or(t),null;case 13:if(u=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(h=Qa(t),u!==null&&u.dehydrated!==null){if(e===null){if(!h)throw Error(s(318));if(h=t.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(s(317));h[yt]=t}else Zl(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Or(t),h=!1}else h=Vc(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=h),h=!0;if(!h)return t.flags&256?(ar(t),t):(ar(t),null)}return ar(t),(t.flags&128)!==0?(t.lanes=a,t):(a=u!==null,e=e!==null&&e.memoizedState!==null,a&&(u=t.child,h=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(h=u.alternate.memoizedState.cachePool.pool),b=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(b=u.memoizedState.cachePool.pool),b!==h&&(u.flags|=2048)),a!==e&&a&&(t.child.flags|=8192),xo(t,t.updateQueue),Or(t),null);case 4:return Re(),e===null&&Ah(t.stateNode.containerInfo),Or(t),null;case 10:return Sa(t.type),Or(t),null;case 19:if(z(Fi),u=t.memoizedState,u===null)return Or(t),null;if(h=(t.flags&128)!==0,b=u.rendering,b===null)if(h)ru(u,!1);else{if(Me!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(b=Oa(e),b!==null){for(t.flags|=128,ru(u,!1),e=b.updateQueue,t.updateQueue=e,xo(t,e),t.subtreeFlags=0,e=a,a=t.child;a!==null;)Ra(a,e),a=a.sibling;return G(Fi,Fi.current&1|2),fi&&Yo(t,u.treeForkCount),t.child}e=e.sibling}u.tail!==null&&Nn()>lt&&(t.flags|=128,h=!0,ru(u,!1),t.lanes=4194304)}else{if(!h)if(e=Oa(b),e!==null){if(t.flags|=128,h=!0,e=e.updateQueue,t.updateQueue=e,xo(t,e),ru(u,!0),u.tail===null&&u.tailMode==="hidden"&&!b.alternate&&!fi)return Or(t),null}else 2*Nn()-u.renderingStartTime>lt&&a!==536870912&&(t.flags|=128,h=!0,ru(u,!1),t.lanes=4194304);u.isBackwards?(b.sibling=t.child,t.child=b):(e=u.last,e!==null?e.sibling=b:t.child=b,u.last=b)}return u.tail!==null?(e=u.tail,u.rendering=e,u.tail=e.sibling,u.renderingStartTime=Nn(),e.sibling=null,a=Fi.current,G(Fi,h?a&1|2:a&1),fi&&Yo(t,u.treeForkCount),e):(Or(t),null);case 22:case 23:return ar(t),xr(),u=t.memoizedState!==null,e!==null?e.memoizedState!==null!==u&&(t.flags|=8192):u&&(t.flags|=8192),u?(a&536870912)!==0&&(t.flags&128)===0&&(Or(t),t.subtreeFlags&6&&(t.flags|=8192)):Or(t),a=t.updateQueue,a!==null&&xo(t,a.retryQueue),a=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),u=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(u=t.memoizedState.cachePool.pool),u!==a&&(t.flags|=2048),e!==null&&z(Q),null;case 24:return a=null,e!==null&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),Sa(Ii),Or(t),null;case 25:return null;case 30:return null}throw Error(s(156,t.tag))}function fp(e,t){switch(Ma(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Sa(Ii),Re(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return et(t),null;case 31:if(t.memoizedState!==null){if(ar(t),t.alternate===null)throw Error(s(340));Zl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(ar(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(s(340));Zl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return z(Fi),null;case 4:return Re(),null;case 10:return Sa(t.type),null;case 22:case 23:return ar(t),xr(),e!==null&&z(Q),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Sa(Ii),null;case 25:return null;default:return null}}function pp(e,t){switch(Ma(t),t.tag){case 3:Sa(Ii),Re();break;case 26:case 27:case 5:et(t);break;case 4:Re();break;case 31:t.memoizedState!==null&&ar(t);break;case 13:ar(t);break;case 19:z(Fi);break;case 10:Sa(t.type);break;case 22:case 23:ar(t),xr(),e!==null&&z(Q);break;case 24:Sa(Ii)}}function Au(e,t){try{var a=t.updateQueue,u=a!==null?a.lastEffect:null;if(u!==null){var h=u.next;a=h;do{if((a.tag&e)===e){u=void 0;var b=a.create,M=a.inst;u=b(),M.destroy=u}a=a.next}while(a!==h)}}catch(ue){Pr(t,t.return,ue)}}function dc(e,t,a){try{var u=t.updateQueue,h=u!==null?u.lastEffect:null;if(h!==null){var b=h.next;u=b;do{if((u.tag&e)===e){var M=u.inst,ue=M.destroy;if(ue!==void 0){M.destroy=void 0,h=t;var Be=a,it=ue;try{it()}catch(St){Pr(h,Be,St)}}}u=u.next}while(u!==b)}}catch(St){Pr(t,t.return,St)}}function td(e){var t=e.updateQueue;if(t!==null){var a=e.stateNode;try{Jr(t,a)}catch(u){Pr(e,e.return,u)}}}function El(e,t,a){a.props=lc(e.type,e.memoizedProps),a.state=e.memoizedState;try{a.componentWillUnmount()}catch(u){Pr(e,t,u)}}function zu(e,t){try{var a=e.ref;if(a!==null){switch(e.tag){case 26:case 27:case 5:var u=e.stateNode;break;case 30:u=e.stateNode;break;default:u=e.stateNode}typeof a=="function"?e.refCleanup=a(u):a.current=u}}catch(h){Pr(e,t,h)}}function no(e,t){var a=e.ref,u=e.refCleanup;if(a!==null)if(typeof u=="function")try{u()}catch(h){Pr(e,t,h)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(h){Pr(e,t,h)}else a.current=null}function wl(e){var t=e.type,a=e.memoizedProps,u=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":a.autoFocus&&u.focus();break e;case"img":a.src?u.src=a.src:a.srcSet&&(u.srcset=a.srcSet)}}catch(h){Pr(e,e.return,h)}}function Md(e,t,a){try{var u=e.stateNode;om(u,e.type,a,t),u[si]=t}catch(h){Pr(e,e.return,h)}}function Tf(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Du(e.type)||e.tag===4}function Xo(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Tf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Du(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Rc(e,t,a){var u=e.tag;if(u===5||u===6)e=e.stateNode,t?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(e,t):(t=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,t.appendChild(e),a=a._reactRootContainer,a!=null||t.onclick!==null||(t.onclick=ba));else if(u!==4&&(u===27&&Du(e.type)&&(a=e.stateNode,t=null),e=e.child,e!==null))for(Rc(e,t,a),e=e.sibling;e!==null;)Rc(e,t,a),e=e.sibling}function Ol(e,t,a){var u=e.tag;if(u===5||u===6)e=e.stateNode,t?a.insertBefore(e,t):a.appendChild(e);else if(u!==4&&(u===27&&Du(e.type)&&(a=e.stateNode),e=e.child,e!==null))for(Ol(e,t,a),e=e.sibling;e!==null;)Ol(e,t,a),e=e.sibling}function nd(e){var t=e.stateNode,a=e.memoizedProps;try{for(var u=e.type,h=t.attributes;h.length;)t.removeAttributeNode(h[0]);ps(t,u,a),t[yt]=e,t[si]=a}catch(b){Pr(e,e.return,b)}}var Sl=!1,ta=!1,Id=!1,hp=typeof WeakSet=="function"?WeakSet:Set,ja=null;function Bd(e,t){if(e=e.containerInfo,_h=Ip,e=fl(e),ys(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{a=(a=e.ownerDocument)&&a.defaultView||window;var u=a.getSelection&&a.getSelection();if(u&&u.rangeCount!==0){a=u.anchorNode;var h=u.anchorOffset,b=u.focusNode;u=u.focusOffset;try{a.nodeType,b.nodeType}catch{a=null;break e}var M=0,ue=-1,Be=-1,it=0,St=0,zt=e,at=null;t:for(;;){for(var dt;zt!==a||h!==0&&zt.nodeType!==3||(ue=M+h),zt!==b||u!==0&&zt.nodeType!==3||(Be=M+u),zt.nodeType===3&&(M+=zt.nodeValue.length),(dt=zt.firstChild)!==null;)at=zt,zt=dt;for(;;){if(zt===e)break t;if(at===a&&++it===h&&(ue=M),at===b&&++St===u&&(Be=M),(dt=zt.nextSibling)!==null)break;zt=at,at=zt.parentNode}zt=dt}a=ue===-1||Be===-1?null:{start:ue,end:Be}}else a=null}a=a||{start:0,end:0}}else a=null;for(Rh={focusedElem:e,selectionRange:a},Ip=!1,ja=t;ja!==null;)if(t=ja,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ja=e;else for(;ja!==null;){switch(t=ja,b=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(a=0;a<e.length;a++)h=e[a],h.ref.impl=h.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&b!==null){e=void 0,a=t,h=b.memoizedProps,b=b.memoizedState,u=a.stateNode;try{var kn=lc(a.type,h);e=u.getSnapshotBeforeUpdate(kn,b),u.__reactInternalSnapshotBeforeUpdate=e}catch(ei){Pr(a,a.return,ei)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,a=e.nodeType,a===9)Mh(e);else if(a===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Mh(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(s(163))}if(e=t.sibling,e!==null){e.return=t.return,ja=e;break}ja=t.return}}function gp(e,t,a){var u=a.flags;switch(a.tag){case 0:case 11:case 15:il(e,a),u&4&&Au(5,a);break;case 1:if(il(e,a),u&4)if(e=a.stateNode,t===null)try{e.componentDidMount()}catch(M){Pr(a,a.return,M)}else{var h=lc(a.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(h,t,e.__reactInternalSnapshotBeforeUpdate)}catch(M){Pr(a,a.return,M)}}u&64&&td(a),u&512&&zu(a,a.return);break;case 3:if(il(e,a),u&64&&(e=a.updateQueue,e!==null)){if(t=null,a.child!==null)switch(a.child.tag){case 27:case 5:t=a.child.stateNode;break;case 1:t=a.child.stateNode}try{Jr(e,t)}catch(M){Pr(a,a.return,M)}}break;case 27:t===null&&u&4&&nd(a);case 26:case 5:il(e,a),t===null&&u&4&&wl(a),u&512&&zu(a,a.return);break;case 12:il(e,a);break;case 31:il(e,a),u&4&&Ed(e,a);break;case 13:il(e,a),u&4&&yp(e,a),u&64&&(e=a.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(a=Gy.bind(null,a),hm(e,a))));break;case 22:if(u=a.memoizedState!==null||Sl,!u){t=t!==null&&t.memoizedState!==null||ta,h=Sl;var b=ta;Sl=u,(ta=t)&&!b?pc(e,a,(a.subtreeFlags&8772)!==0):il(e,a),Sl=h,ta=b}break;case 30:break;default:il(e,a)}}function xp(e){var t=e.alternate;t!==null&&(e.alternate=null,xp(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Ys(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Fr=null,yo=!1;function fc(e,t,a){for(a=a.child;a!==null;)Cf(e,t,a),a=a.sibling}function Cf(e,t,a){if(Qe&&typeof Qe.onCommitFiberUnmount=="function")try{Qe.onCommitFiberUnmount(en,a)}catch{}switch(a.tag){case 26:ta||no(a,t),fc(e,t,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:ta||no(a,t);var u=Fr,h=yo;Du(a.type)&&(Fr=a.stateNode,yo=!1),fc(e,t,a),Pf(a.stateNode),Fr=u,yo=h;break;case 5:ta||no(a,t);case 6:if(u=Fr,h=yo,Fr=null,fc(e,t,a),Fr=u,yo=h,Fr!==null)if(yo)try{(Fr.nodeType===9?Fr.body:Fr.nodeName==="HTML"?Fr.ownerDocument.body:Fr).removeChild(a.stateNode)}catch(b){Pr(a,t,b)}else try{Fr.removeChild(a.stateNode)}catch(b){Pr(a,t,b)}break;case 18:Fr!==null&&(yo?(e=Fr,P0(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,a.stateNode),Wd(e)):P0(Fr,a.stateNode));break;case 4:u=Fr,h=yo,Fr=a.stateNode.containerInfo,yo=!0,fc(e,t,a),Fr=u,yo=h;break;case 0:case 11:case 14:case 15:dc(2,a,t),ta||dc(4,a,t),fc(e,t,a);break;case 1:ta||(no(a,t),u=a.stateNode,typeof u.componentWillUnmount=="function"&&El(a,t,u)),fc(e,t,a);break;case 21:fc(e,t,a);break;case 22:ta=(u=ta)||a.memoizedState!==null,fc(e,t,a),ta=u;break;default:fc(e,t,a)}}function Ed(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Wd(e)}catch(a){Pr(t,t.return,a)}}}function yp(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Wd(e)}catch(a){Pr(t,t.return,a)}}function mp(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new hp),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new hp),t;default:throw Error(s(435,e.tag))}}function Pu(e,t){var a=mp(e);t.forEach(function(u){if(!a.has(u)){a.add(u);var h=Xy.bind(null,e,u);u.then(h,h)}})}function Ko(e,t){var a=t.deletions;if(a!==null)for(var u=0;u<a.length;u++){var h=a[u],b=e,M=t,ue=M;e:for(;ue!==null;){switch(ue.tag){case 27:if(Du(ue.type)){Fr=ue.stateNode,yo=!1;break e}break;case 5:Fr=ue.stateNode,yo=!1;break e;case 3:case 4:Fr=ue.stateNode.containerInfo,yo=!0;break e}ue=ue.return}if(Fr===null)throw Error(s(160));Cf(b,M,h),Fr=null,yo=!1,b=h.alternate,b!==null&&(b.return=null),h.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)bp(t,e),t=t.sibling}var jl=null;function bp(e,t){var a=e.alternate,u=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Ko(t,e),qa(e),u&4&&(dc(3,e,e.return),Au(3,e),dc(5,e,e.return));break;case 1:Ko(t,e),qa(e),u&512&&(ta||a===null||no(a,a.return)),u&64&&Sl&&(e=e.updateQueue,e!==null&&(u=e.callbacks,u!==null&&(a=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=a===null?u:a.concat(u))));break;case 26:var h=jl;if(Ko(t,e),qa(e),u&512&&(ta||a===null||no(a,a.return)),u&4){var b=a!==null?a.memoizedState:null;if(u=e.memoizedState,a===null)if(u===null)if(e.stateNode===null){e:{u=e.type,a=e.memoizedProps,h=h.ownerDocument||h;t:switch(u){case"title":b=h.getElementsByTagName("title")[0],(!b||b[Rr]||b[yt]||b.namespaceURI==="http://www.w3.org/2000/svg"||b.hasAttribute("itemprop"))&&(b=h.createElement(u),h.head.insertBefore(b,h.querySelector("head > title"))),ps(b,u,a),b[yt]=e,jr(b),u=b;break e;case"link":var M=U0("link","href",h).get(u+(a.href||""));if(M){for(var ue=0;ue<M.length;ue++)if(b=M[ue],b.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&b.getAttribute("rel")===(a.rel==null?null:a.rel)&&b.getAttribute("title")===(a.title==null?null:a.title)&&b.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){M.splice(ue,1);break t}}b=h.createElement(u),ps(b,u,a),h.head.appendChild(b);break;case"meta":if(M=U0("meta","content",h).get(u+(a.content||""))){for(ue=0;ue<M.length;ue++)if(b=M[ue],b.getAttribute("content")===(a.content==null?null:""+a.content)&&b.getAttribute("name")===(a.name==null?null:a.name)&&b.getAttribute("property")===(a.property==null?null:a.property)&&b.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&b.getAttribute("charset")===(a.charSet==null?null:a.charSet)){M.splice(ue,1);break t}}b=h.createElement(u),ps(b,u,a),h.head.appendChild(b);break;default:throw Error(s(468,u))}b[yt]=e,jr(b),u=b}e.stateNode=u}else q0(h,e.type,e.stateNode);else e.stateNode=F0(h,u,e.memoizedProps);else b!==u?(b===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):b.count--,u===null?q0(h,e.type,e.stateNode):F0(h,u,e.memoizedProps)):u===null&&e.stateNode!==null&&Md(e,e.memoizedProps,a.memoizedProps)}break;case 27:Ko(t,e),qa(e),u&512&&(ta||a===null||no(a,a.return)),a!==null&&u&4&&Md(e,e.memoizedProps,a.memoizedProps);break;case 5:if(Ko(t,e),qa(e),u&512&&(ta||a===null||no(a,a.return)),e.flags&32){h=e.stateNode;try{wo(h,"")}catch(kn){Pr(e,e.return,kn)}}u&4&&e.stateNode!=null&&(h=e.memoizedProps,Md(e,h,a!==null?a.memoizedProps:h)),u&1024&&(Id=!0);break;case 6:if(Ko(t,e),qa(e),u&4){if(e.stateNode===null)throw Error(s(162));u=e.memoizedProps,a=e.stateNode;try{a.nodeValue=u}catch(kn){Pr(e,e.return,kn)}}break;case 3:if(Rp=null,h=jl,jl=Pp(t.containerInfo),Ko(t,e),jl=h,qa(e),u&4&&a!==null&&a.memoizedState.isDehydrated)try{Wd(t.containerInfo)}catch(kn){Pr(e,e.return,kn)}Id&&(Id=!1,au(e));break;case 4:u=jl,jl=Pp(e.stateNode.containerInfo),Ko(t,e),qa(e),jl=u;break;case 12:Ko(t,e),qa(e);break;case 31:Ko(t,e),qa(e),u&4&&(u=e.updateQueue,u!==null&&(e.updateQueue=null,Pu(e,u)));break;case 13:Ko(t,e),qa(e),e.child.flags&8192&&e.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(Ye=Nn()),u&4&&(u=e.updateQueue,u!==null&&(e.updateQueue=null,Pu(e,u)));break;case 22:h=e.memoizedState!==null;var Be=a!==null&&a.memoizedState!==null,it=Sl,St=ta;if(Sl=it||h,ta=St||Be,Ko(t,e),ta=St,Sl=it,qa(e),u&8192)e:for(t=e.stateNode,t._visibility=h?t._visibility&-2:t._visibility|1,h&&(a===null||Be||Sl||ta||ou(e)),a=null,t=e;;){if(t.tag===5||t.tag===26){if(a===null){Be=a=t;try{if(b=Be.stateNode,h)M=b.style,typeof M.setProperty=="function"?M.setProperty("display","none","important"):M.display="none";else{ue=Be.stateNode;var zt=Be.memoizedProps.style,at=zt!=null&&zt.hasOwnProperty("display")?zt.display:null;ue.style.display=at==null||typeof at=="boolean"?"":(""+at).trim()}}catch(kn){Pr(Be,Be.return,kn)}}}else if(t.tag===6){if(a===null){Be=t;try{Be.stateNode.nodeValue=h?"":Be.memoizedProps}catch(kn){Pr(Be,Be.return,kn)}}}else if(t.tag===18){if(a===null){Be=t;try{var dt=Be.stateNode;h?_0(dt,!0):_0(Be.stateNode,!1)}catch(kn){Pr(Be,Be.return,kn)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;a===t&&(a=null),t=t.return}a===t&&(a=null),t.sibling.return=t.return,t=t.sibling}u&4&&(u=e.updateQueue,u!==null&&(a=u.retryQueue,a!==null&&(u.retryQueue=null,Pu(e,a))));break;case 19:Ko(t,e),qa(e),u&4&&(u=e.updateQueue,u!==null&&(e.updateQueue=null,Pu(e,u)));break;case 30:break;case 21:break;default:Ko(t,e),qa(e)}}function qa(e){var t=e.flags;if(t&2){try{for(var a,u=e.return;u!==null;){if(Tf(u)){a=u;break}u=u.return}if(a==null)throw Error(s(160));switch(a.tag){case 27:var h=a.stateNode,b=Xo(e);Ol(e,b,h);break;case 5:var M=a.stateNode;a.flags&32&&(wo(M,""),a.flags&=-33);var ue=Xo(e);Ol(e,ue,M);break;case 3:case 4:var Be=a.stateNode.containerInfo,it=Xo(e);Rc(e,it,Be);break;default:throw Error(s(161))}}catch(St){Pr(e,e.return,St)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function au(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;au(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function il(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)gp(e,t.alternate,t),t=t.sibling}function ou(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:dc(4,t,t.return),ou(t);break;case 1:no(t,t.return);var a=t.stateNode;typeof a.componentWillUnmount=="function"&&El(t,t.return,a),ou(t);break;case 27:Pf(t.stateNode);case 26:case 5:no(t,t.return),ou(t);break;case 22:t.memoizedState===null&&ou(t);break;case 30:ou(t);break;default:ou(t)}e=e.sibling}}function pc(e,t,a){for(a=a&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var u=t.alternate,h=e,b=t,M=b.flags;switch(b.tag){case 0:case 11:case 15:pc(h,b,a),Au(4,b);break;case 1:if(pc(h,b,a),u=b,h=u.stateNode,typeof h.componentDidMount=="function")try{h.componentDidMount()}catch(it){Pr(u,u.return,it)}if(u=b,h=u.updateQueue,h!==null){var ue=u.stateNode;try{var Be=h.shared.hiddenCallbacks;if(Be!==null)for(h.shared.hiddenCallbacks=null,h=0;h<Be.length;h++)fo(Be[h],ue)}catch(it){Pr(u,u.return,it)}}a&&M&64&&td(b),zu(b,b.return);break;case 27:nd(b);case 26:case 5:pc(h,b,a),a&&u===null&&M&4&&wl(b),zu(b,b.return);break;case 12:pc(h,b,a);break;case 31:pc(h,b,a),a&&M&4&&Ed(h,b);break;case 13:pc(h,b,a),a&&M&4&&yp(h,b);break;case 22:b.memoizedState===null&&pc(h,b,a),zu(b,b.return);break;case 30:break;default:pc(h,b,a)}t=t.sibling}}function id(e,t){var a=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==a&&(e!=null&&e.refCount++,a!=null&&uo(a))}function rd(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&uo(e))}function rl(e,t,a,u){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)kf(e,t,a,u),t=t.sibling}function kf(e,t,a,u){var h=t.flags;switch(t.tag){case 0:case 11:case 15:rl(e,t,a,u),h&2048&&Au(9,t);break;case 1:rl(e,t,a,u);break;case 3:rl(e,t,a,u),h&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&uo(e)));break;case 12:if(h&2048){rl(e,t,a,u),e=t.stateNode;try{var b=t.memoizedProps,M=b.id,ue=b.onPostCommit;typeof ue=="function"&&ue(M,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(Be){Pr(t,t.return,Be)}}else rl(e,t,a,u);break;case 31:rl(e,t,a,u);break;case 13:rl(e,t,a,u);break;case 23:break;case 22:b=t.stateNode,M=t.alternate,t.memoizedState!==null?b._visibility&2?rl(e,t,a,u):Fl(e,t):b._visibility&2?rl(e,t,a,u):(b._visibility|=2,rn(e,t,a,u,(t.subtreeFlags&10256)!==0||!1)),h&2048&&id(M,t);break;case 24:rl(e,t,a,u),h&2048&&rd(t.alternate,t);break;default:rl(e,t,a,u)}}function rn(e,t,a,u,h){for(h=h&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var b=e,M=t,ue=a,Be=u,it=M.flags;switch(M.tag){case 0:case 11:case 15:rn(b,M,ue,Be,h),Au(8,M);break;case 23:break;case 22:var St=M.stateNode;M.memoizedState!==null?St._visibility&2?rn(b,M,ue,Be,h):Fl(b,M):(St._visibility|=2,rn(b,M,ue,Be,h)),h&&it&2048&&id(M.alternate,M);break;case 24:rn(b,M,ue,Be,h),h&&it&2048&&rd(M.alternate,M);break;default:rn(b,M,ue,Be,h)}t=t.sibling}}function Fl(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var a=e,u=t,h=u.flags;switch(u.tag){case 22:Fl(a,u),h&2048&&id(u.alternate,u);break;case 24:Fl(a,u),h&2048&&rd(u.alternate,u);break;default:Fl(a,u)}t=t.sibling}}var su=8192;function _u(e,t,a){if(e.subtreeFlags&su)for(e=e.child;e!==null;)vp(e,t,a),e=e.sibling}function vp(e,t,a){switch(e.tag){case 26:_u(e,t,a),e.flags&su&&e.memoizedState!==null&&km(a,jl,e.memoizedState,e.memoizedProps);break;case 5:_u(e,t,a);break;case 3:case 4:var u=jl;jl=Pp(e.stateNode.containerInfo),_u(e,t,a),jl=u;break;case 22:e.memoizedState===null&&(u=e.alternate,u!==null&&u.memoizedState!==null?(u=su,su=16777216,_u(e,t,a),su=u):_u(e,t,a));break;default:_u(e,t,a)}}function wp(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function l(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var a=0;a<t.length;a++){var u=t[a];ja=u,B(u,e)}wp(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)y(e),e=e.sibling}function y(e){switch(e.tag){case 0:case 11:case 15:l(e),e.flags&2048&&dc(9,e,e.return);break;case 3:l(e);break;case 12:l(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,N(e)):l(e);break;default:l(e)}}function N(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var a=0;a<t.length;a++){var u=t[a];ja=u,B(u,e)}wp(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:dc(8,t,t.return),N(t);break;case 22:a=t.stateNode,a._visibility&2&&(a._visibility&=-3,N(t));break;default:N(t)}e=e.sibling}}function B(e,t){for(;ja!==null;){var a=ja;switch(a.tag){case 0:case 11:case 15:dc(8,a,t);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var u=a.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:uo(a.memoizedState.cache)}if(u=a.child,u!==null)u.return=a,ja=u;else e:for(a=e;ja!==null;){u=ja;var h=u.sibling,b=u.return;if(xp(u),u===a){ja=null;break e}if(h!==null){h.return=b,ja=h;break e}ja=b}}}var le={getCacheForType:function(e){var t=Gi(Ii),a=t.data.get(e);return a===void 0&&(a=e(),t.data.set(e,a)),a},cacheSignal:function(){return Gi(Ii).controller.signal}},ge=typeof WeakMap=="function"?WeakMap:Map,A=0,je=null,ne=null,Te=0,ve=0,Ce=null,ye=!1,we=!1,be=!1,me=0,Me=0,De=0,He=0,xt=0,pt=0,Nt=0,st=null,qt=null,$e=!1,Ye=0,We=0,lt=1/0,ut=null,Rt=null,Vt=0,Sn=null,Vn=null,Rn=0,Kn=0,hi=null,Bn=null,It=0,Dn=null;function vi(){return(A&2)!==0&&Te!==0?Te&-Te:ce.T!==null?Th():Wn()}function Wr(){if(pt===0)if((Te&536870912)===0||fi){var e=Xn;Xn<<=1,(Xn&3932160)===0&&(Xn=262144),pt=e}else pt=536870912;return e=yr.current,e!==null&&(e.flags|=32),pt}function Ni(e,t,a){(e===je&&(ve===2||ve===9)||e.cancelPendingCommit!==null)&&(Od(e,0),mo(e,Te,pt,!1)),Yt(e,a),((A&2)===0||e!==je)&&(e===je&&((A&2)===0&&(He|=a),Me===4&&mo(e,Te,pt,!1)),Dc(e))}function Ta(e,t,a){if((A&6)!==0)throw Error(s(327));var u=!a&&(t&127)===0&&(t&e.expiredLanes)===0||Zn(e,t),h=u?Wy(e,t):vh(e,t,!0),b=u;do{if(h===0){we&&!u&&mo(e,t,0,!1);break}else{if(a=e.current.alternate,b&&!oi(a)){h=vh(e,t,!1),b=!1;continue}if(h===2){if(b=t,e.errorRecoveryDisabledLanes&b)var M=0;else M=e.pendingLanes&-536870913,M=M!==0?M:M&536870912?536870912:0;if(M!==0){t=M;e:{var ue=e;h=st;var Be=ue.current.memoizedState.isDehydrated;if(Be&&(Od(ue,M).flags|=256),M=vh(ue,M,!1),M!==2){if(be&&!Be){ue.errorRecoveryDisabledLanes|=b,He|=b,h=4;break e}b=qt,qt=h,b!==null&&(qt===null?qt=b:qt.push.apply(qt,b))}h=M}if(b=!1,h!==2)continue}}if(h===1){Od(e,0),mo(e,t,0,!0);break}e:{switch(u=e,b=h,b){case 0:case 1:throw Error(s(345));case 4:if((t&4194048)!==t)break;case 6:mo(u,t,pt,!ye);break e;case 2:qt=null;break;case 3:case 5:break;default:throw Error(s(329))}if((t&62914560)===t&&(h=Ye+300-Nn(),10<h)){if(mo(u,t,pt,!ye),Lt(u,0,!0)!==0)break e;Rn=t,u.timeoutHandle=A0(Ca.bind(null,u,a,qt,ut,$e,t,pt,He,Nt,ye,b,"Throttled",-0,0),h);break e}Ca(u,a,qt,ut,$e,t,pt,He,Nt,ye,b,null,-0,0)}}break}while(!0);Dc(e)}function Ca(e,t,a,u,h,b,M,ue,Be,it,St,zt,at,dt){if(e.timeoutHandle=-1,zt=t.subtreeFlags,zt&8192||(zt&16785408)===16785408){zt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ba},vp(t,b,zt);var kn=(b&62914560)===b?Ye-Nn():(b&4194048)===b?We-Nn():0;if(kn=Nm(zt,kn),kn!==null){Rn=b,e.cancelPendingCommit=kn(o0.bind(null,e,t,b,a,u,h,M,ue,Be,St,zt,null,at,dt)),mo(e,b,M,!it);return}}o0(e,t,b,a,u,h,M,ue,Be)}function oi(e){for(var t=e;;){var a=t.tag;if((a===0||a===11||a===15)&&t.flags&16384&&(a=t.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var u=0;u<a.length;u++){var h=a[u],b=h.getSnapshot;h=h.value;try{if(!Hr(b(),h))return!1}catch{return!1}}if(a=t.child,t.subtreeFlags&16384&&a!==null)a.return=t,t=a;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function mo(e,t,a,u){t&=~xt,t&=~He,e.suspendedLanes|=t,e.pingedLanes&=~t,u&&(e.warmLanes|=t),u=e.expirationTimes;for(var h=t;0<h;){var b=31-un(h),M=1<<b;u[b]=-1,h&=~M}a!==0&&ci(e,a,t)}function fs(){return(A&6)===0?(Nf(0),!1):!0}function bh(){if(ne!==null){if(ve===0)var e=ne.return;else e=ne,eo=gl=null,yl(e),vt=null,sn=0,e=ne;for(;e!==null;)pp(e.alternate,e),e=e.return;ne=null}}function Od(e,t){var a=e.timeoutHandle;a!==-1&&(e.timeoutHandle=-1,cm(a)),a=e.cancelPendingCommit,a!==null&&(e.cancelPendingCommit=null,a()),Rn=0,bh(),je=e,ne=a=bi(e.current,null),Te=t,ve=0,Ce=null,ye=!1,we=Zn(e,t),be=!1,Nt=pt=xt=He=De=Me=0,qt=st=null,$e=!1,(t&8)!==0&&(t|=t&32);var u=e.entangledLanes;if(u!==0)for(e=e.entanglements,u&=t;0<u;){var h=31-un(u),b=1<<h;t|=e[h],u&=~b}return me=t,_l(),a}function Qg(e,t){Pn=null,ce.H=Ss,t===Fe||t===Ae?(t=wt(),ve=3):t===tt?(t=wt(),ve=4):ve=t===yf?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Ce=t,ne===null&&(Me=1,Cd(e,lo(t,e.current)))}function e0(){var e=yr.current;return e===null?!0:(Te&4194048)===Te?Oi===null:(Te&62914560)===Te||(Te&536870912)!==0?e===Oi:!1}function t0(){var e=ce.H;return ce.H=Ss,e===null?Ss:e}function n0(){var e=ce.A;return ce.A=le,e}function Sp(){Me=4,ye||(Te&4194048)!==Te&&yr.current!==null||(we=!0),(De&134217727)===0&&(He&134217727)===0||je===null||mo(je,Te,pt,!1)}function vh(e,t,a){var u=A;A|=2;var h=t0(),b=n0();(je!==e||Te!==t)&&(ut=null,Od(e,t)),t=!1;var M=Me;e:do try{if(ve!==0&&ne!==null){var ue=ne,Be=Ce;switch(ve){case 8:bh(),M=6;break e;case 3:case 2:case 9:case 6:yr.current===null&&(t=!0);var it=ve;if(ve=0,Ce=null,Fd(e,ue,Be,it),a&&we){M=0;break e}break;default:it=ve,ve=0,Ce=null,Fd(e,ue,Be,it)}}Hy(),M=Me;break}catch(St){Qg(e,St)}while(!0);return t&&e.shellSuspendCounter++,eo=gl=null,A=u,ce.H=h,ce.A=b,ne===null&&(je=null,Te=0,_l()),M}function Hy(){for(;ne!==null;)i0(ne)}function Wy(e,t){var a=A;A|=2;var u=t0(),h=n0();je!==e||Te!==t?(ut=null,lt=Nn()+500,Od(e,t)):we=Zn(e,t);e:do try{if(ve!==0&&ne!==null){t=ne;var b=Ce;t:switch(ve){case 1:ve=0,Ce=null,Fd(e,t,b,1);break;case 2:case 9:if(Ke(b)){ve=0,Ce=null,r0(t);break}t=function(){ve!==2&&ve!==9||je!==e||(ve=7),Dc(e)},b.then(t,t);break e;case 3:ve=7;break e;case 4:ve=5;break e;case 7:Ke(b)?(ve=0,Ce=null,r0(t)):(ve=0,Ce=null,Fd(e,t,b,7));break;case 5:var M=null;switch(ne.tag){case 26:M=ne.memoizedState;case 5:case 27:var ue=ne;if(M?V0(M):ue.stateNode.complete){ve=0,Ce=null;var Be=ue.sibling;if(Be!==null)ne=Be;else{var it=ue.return;it!==null?(ne=it,jp(it)):ne=null}break t}}ve=0,Ce=null,Fd(e,t,b,5);break;case 6:ve=0,Ce=null,Fd(e,t,b,6);break;case 8:bh(),Me=6;break e;default:throw Error(s(462))}}$y();break}catch(St){Qg(e,St)}while(!0);return eo=gl=null,ce.H=u,ce.A=h,A=a,ne!==null?0:(je=null,Te=0,_l(),Me)}function $y(){for(;ne!==null&&!an();)i0(ne)}function i0(e){var t=Nu(e.alternate,e,me);e.memoizedProps=e.pendingProps,t===null?jp(e):ne=t}function r0(e){var t=e,a=t.alternate;switch(t.tag){case 15:case 0:t=dp(a,t,t.pendingProps,t.type,void 0,Te);break;case 11:t=dp(a,t,t.pendingProps,t.type.render,t.ref,Te);break;case 5:yl(t);default:pp(a,t),t=ne=Ra(t,me),t=Nu(a,t,me)}e.memoizedProps=e.pendingProps,t===null?jp(e):ne=t}function Fd(e,t,a,u){eo=gl=null,yl(t),vt=null,sn=0;var h=t.return;try{if(Ws(e,h,t,a,Te)){Me=1,Cd(e,lo(a,e.current)),ne=null;return}}catch(b){if(h!==null)throw ne=h,b;Me=1,Cd(e,lo(a,e.current)),ne=null;return}t.flags&32768?(fi||u===1?e=!0:we||(Te&536870912)!==0?e=!1:(ye=e=!0,(u===2||u===9||u===3||u===6)&&(u=yr.current,u!==null&&u.tag===13&&(u.flags|=16384))),a0(t,e)):jp(t)}function jp(e){var t=e;do{if((t.flags&32768)!==0){a0(t,ye);return}e=t.return;var a=mh(t.alternate,t,me);if(a!==null){ne=a;return}if(t=t.sibling,t!==null){ne=t;return}ne=t=e}while(t!==null);Me===0&&(Me=5)}function a0(e,t){do{var a=fp(e.alternate,e);if(a!==null){a.flags&=32767,ne=a;return}if(a=e.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!t&&(e=e.sibling,e!==null)){ne=e;return}ne=e=a}while(e!==null);Me=6,ne=null}function o0(e,t,a,u,h,b,M,ue,Be){e.cancelPendingCommit=null;do Tp();while(Vt!==0);if((A&6)!==0)throw Error(s(327));if(t!==null){if(t===e.current)throw Error(s(177));if(b=t.lanes|t.childLanes,b|=Ro,jn(e,a,b,M,ue,Be),e===je&&(ne=je=null,Te=0),Vn=t,Sn=e,Rn=a,Kn=b,hi=h,Bn=u,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Ky(Mt,function(){return d0(),null})):(e.callbackNode=null,e.callbackPriority=0),u=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||u){u=ce.T,ce.T=null,h=xe.p,xe.p=2,M=A,A|=4;try{Bd(e,t,a)}finally{A=M,xe.p=h,ce.T=u}}Vt=1,s0(),l0(),c0()}}function s0(){if(Vt===1){Vt=0;var e=Sn,t=Vn,a=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||a){a=ce.T,ce.T=null;var u=xe.p;xe.p=2;var h=A;A|=4;try{bp(t,e);var b=Rh,M=fl(e.containerInfo),ue=b.focusedElem,Be=b.selectionRange;if(M!==ue&&ue&&ue.ownerDocument&&Vo(ue.ownerDocument.documentElement,ue)){if(Be!==null&&ys(ue)){var it=Be.start,St=Be.end;if(St===void 0&&(St=it),"selectionStart"in ue)ue.selectionStart=it,ue.selectionEnd=Math.min(St,ue.value.length);else{var zt=ue.ownerDocument||document,at=zt&&zt.defaultView||window;if(at.getSelection){var dt=at.getSelection(),kn=ue.textContent.length,ei=Math.min(Be.start,kn),qr=Be.end===void 0?ei:Math.min(Be.end,kn);!dt.extend&&ei>qr&&(M=qr,qr=ei,ei=M);var Ge=Pl(ue,ei),qe=Pl(ue,qr);if(Ge&&qe&&(dt.rangeCount!==1||dt.anchorNode!==Ge.node||dt.anchorOffset!==Ge.offset||dt.focusNode!==qe.node||dt.focusOffset!==qe.offset)){var nt=zt.createRange();nt.setStart(Ge.node,Ge.offset),dt.removeAllRanges(),ei>qr?(dt.addRange(nt),dt.extend(qe.node,qe.offset)):(nt.setEnd(qe.node,qe.offset),dt.addRange(nt))}}}}for(zt=[],dt=ue;dt=dt.parentNode;)dt.nodeType===1&&zt.push({element:dt,left:dt.scrollLeft,top:dt.scrollTop});for(typeof ue.focus=="function"&&ue.focus(),ue=0;ue<zt.length;ue++){var Tt=zt[ue];Tt.element.scrollLeft=Tt.left,Tt.element.scrollTop=Tt.top}}Ip=!!_h,Rh=_h=null}finally{A=h,xe.p=u,ce.T=a}}e.current=t,Vt=2}}function l0(){if(Vt===2){Vt=0;var e=Sn,t=Vn,a=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||a){a=ce.T,ce.T=null;var u=xe.p;xe.p=2;var h=A;A|=4;try{gp(e,t.alternate,t)}finally{A=h,xe.p=u,ce.T=a}}Vt=3}}function c0(){if(Vt===4||Vt===3){Vt=0,Ht();var e=Sn,t=Vn,a=Rn,u=Bn;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Vt=5:(Vt=0,Vn=Sn=null,u0(e,e.pendingLanes));var h=e.pendingLanes;if(h===0&&(Rt=null),on(a),t=t.stateNode,Qe&&typeof Qe.onCommitFiberRoot=="function")try{Qe.onCommitFiberRoot(en,t,void 0,(t.current.flags&128)===128)}catch{}if(u!==null){t=ce.T,h=xe.p,xe.p=2,ce.T=null;try{for(var b=e.onRecoverableError,M=0;M<u.length;M++){var ue=u[M];b(ue.value,{componentStack:ue.stack})}}finally{ce.T=t,xe.p=h}}(Rn&3)!==0&&Tp(),Dc(e),h=e.pendingLanes,(a&261930)!==0&&(h&42)!==0?e===Dn?It++:(It=0,Dn=e):It=0,Nf(0)}}function u0(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,uo(t)))}function Tp(){return s0(),l0(),c0(),d0()}function d0(){if(Vt!==5)return!1;var e=Sn,t=Kn;Kn=0;var a=on(Rn),u=ce.T,h=xe.p;try{xe.p=32>a?32:a,ce.T=null,a=hi,hi=null;var b=Sn,M=Rn;if(Vt=0,Vn=Sn=null,Rn=0,(A&6)!==0)throw Error(s(331));var ue=A;if(A|=4,y(b.current),kf(b,b.current,M,a),A=ue,Nf(0,!1),Qe&&typeof Qe.onPostCommitFiberRoot=="function")try{Qe.onPostCommitFiberRoot(en,b)}catch{}return!0}finally{xe.p=h,ce.T=u,u0(e,t)}}function f0(e,t,a){t=lo(a,t),t=Zu(e.stateNode,t,2),e=Un(e,t,2),e!==null&&(Yt(e,2),Dc(e))}function Pr(e,t,a){if(e.tag===3)f0(e,e,a);else for(;t!==null;){if(t.tag===3){f0(t,e,a);break}else if(t.tag===1){var u=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Rt===null||!Rt.has(u))){e=lo(a,e),a=lp(2),u=Un(t,a,2),u!==null&&(cp(a,u,t,e),Yt(u,2),Dc(u));break}}t=t.return}}function wh(e,t,a){var u=e.pingCache;if(u===null){u=e.pingCache=new ge;var h=new Set;u.set(t,h)}else h=u.get(t),h===void 0&&(h=new Set,u.set(t,h));h.has(a)||(be=!0,h.add(a),e=Yy.bind(null,e,t,a),t.then(e,e))}function Yy(e,t,a){var u=e.pingCache;u!==null&&u.delete(t),e.pingedLanes|=e.suspendedLanes&a,e.warmLanes&=~a,je===e&&(Te&a)===a&&(Me===4||Me===3&&(Te&62914560)===Te&&300>Nn()-Ye?(A&2)===0&&Od(e,0):xt|=a,Nt===Te&&(Nt=0)),Dc(e)}function p0(e,t){t===0&&(t=wr()),e=va(e,t),e!==null&&(Yt(e,t),Dc(e))}function Gy(e){var t=e.memoizedState,a=0;t!==null&&(a=t.retryLane),p0(e,a)}function Xy(e,t){var a=0;switch(e.tag){case 31:case 13:var u=e.stateNode,h=e.memoizedState;h!==null&&(a=h.retryLane);break;case 19:u=e.stateNode;break;case 22:u=e.stateNode._retryCache;break;default:throw Error(s(314))}u!==null&&u.delete(t),p0(e,a)}function Ky(e,t){return Xe(e,t)}var Cp=null,Ud=null,Sh=!1,kp=!1,jh=!1,Ru=0;function Dc(e){e!==Ud&&e.next===null&&(Ud===null?Cp=Ud=e:Ud=Ud.next=e),kp=!0,Sh||(Sh=!0,Jy())}function Nf(e,t){if(!jh&&kp){jh=!0;do for(var a=!1,u=Cp;u!==null;){if(e!==0){var h=u.pendingLanes;if(h===0)var b=0;else{var M=u.suspendedLanes,ue=u.pingedLanes;b=(1<<31-un(42|e)+1)-1,b&=h&~(M&~ue),b=b&201326741?b&201326741|1:b?b|2:0}b!==0&&(a=!0,y0(u,b))}else b=Te,b=Lt(u,u===je?b:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(b&3)===0||Zn(u,b)||(a=!0,y0(u,b));u=u.next}while(a);jh=!1}}function Zy(){h0()}function h0(){kp=Sh=!1;var e=0;Ru!==0&&lm()&&(e=Ru);for(var t=Nn(),a=null,u=Cp;u!==null;){var h=u.next,b=g0(u,t);b===0?(u.next=null,a===null?Cp=h:a.next=h,h===null&&(Ud=a)):(a=u,(e!==0||(b&3)!==0)&&(kp=!0)),u=h}Vt!==0&&Vt!==5||Nf(e),Ru!==0&&(Ru=0)}function g0(e,t){for(var a=e.suspendedLanes,u=e.pingedLanes,h=e.expirationTimes,b=e.pendingLanes&-62914561;0<b;){var M=31-un(b),ue=1<<M,Be=h[M];Be===-1?((ue&a)===0||(ue&u)!==0)&&(h[M]=In(ue,t)):Be<=t&&(e.expiredLanes|=ue),b&=~ue}if(t=je,a=Te,a=Lt(e,e===t?a:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),u=e.callbackNode,a===0||e===t&&(ve===2||ve===9)||e.cancelPendingCommit!==null)return u!==null&&u!==null&&Ut(u),e.callbackNode=null,e.callbackPriority=0;if((a&3)===0||Zn(e,a)){if(t=a&-a,t===e.callbackPriority)return t;switch(u!==null&&Ut(u),on(a)){case 2:case 8:a=Ne;break;case 32:a=Mt;break;case 268435456:a=_t;break;default:a=Mt}return u=x0.bind(null,e),a=Xe(a,u),e.callbackPriority=t,e.callbackNode=a,t}return u!==null&&u!==null&&Ut(u),e.callbackPriority=2,e.callbackNode=null,2}function x0(e,t){if(Vt!==0&&Vt!==5)return e.callbackNode=null,e.callbackPriority=0,null;var a=e.callbackNode;if(Tp()&&e.callbackNode!==a)return null;var u=Te;return u=Lt(e,e===je?u:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),u===0?null:(Ta(e,u,t),g0(e,Nn()),e.callbackNode!=null&&e.callbackNode===a?x0.bind(null,e):null)}function y0(e,t){if(Tp())return null;Ta(e,t,!0)}function Jy(){um(function(){(A&6)!==0?Xe(Ee,Zy):h0()})}function Th(){if(Ru===0){var e=f;e===0&&(e=hn,hn<<=1,(hn&261888)===0&&(hn=256)),Ru=e}return Ru}function m0(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:rr(""+e)}function b0(e,t){var a=t.ownerDocument.createElement("input");return a.name=t.name,a.value=t.value,e.id&&a.setAttribute("form",e.id),t.parentNode.insertBefore(a,t),e=new FormData(e),a.parentNode.removeChild(a),e}function Qy(e,t,a,u,h){if(t==="submit"&&a&&a.stateNode===h){var b=m0((h[si]||null).action),M=u.submitter;M&&(t=(t=M[si]||null)?m0(t.formAction):M.getAttribute("formAction"),t!==null&&(b=t,M=null));var ue=new gs("action","action",null,u,h);e.push({event:ue,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Ru!==0){var Be=M?b0(h,M):new FormData(h);ff(a,{pending:!0,data:Be,method:h.method,action:b},null,Be)}}else typeof b=="function"&&(ue.preventDefault(),Be=M?b0(h,M):new FormData(h),ff(a,{pending:!0,data:Be,method:h.method,action:b},b,Be))},currentTarget:h}]})}}for(var Ch=0;Ch<Wo.length;Ch++){var kh=Wo[Ch],em=kh.toLowerCase(),tm=kh[0].toUpperCase()+kh.slice(1);ra(em,"on"+tm)}ra(Gl,"onAnimationEnd"),ra(vc,"onAnimationIteration"),ra(Hu,"onAnimationStart"),ra("dblclick","onDoubleClick"),ra("focusin","onFocus"),ra("focusout","onBlur"),ra(yd,"onTransitionRun"),ra(md,"onTransitionStart"),ra(bd,"onTransitionCancel"),ra(Xa,"onTransitionEnd"),di("onMouseEnter",["mouseout","mouseover"]),di("onMouseLeave",["mouseout","mouseover"]),di("onPointerEnter",["pointerout","pointerover"]),di("onPointerLeave",["pointerout","pointerover"]),ma("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ma("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ma("onBeforeInput",["compositionend","keypress","textInput","paste"]),ma("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ma("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ma("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Af="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),nm=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Af));function v0(e,t){t=(t&4)!==0;for(var a=0;a<e.length;a++){var u=e[a],h=u.event;u=u.listeners;e:{var b=void 0;if(t)for(var M=u.length-1;0<=M;M--){var ue=u[M],Be=ue.instance,it=ue.currentTarget;if(ue=ue.listener,Be!==b&&h.isPropagationStopped())break e;b=ue,h.currentTarget=it;try{b(h)}catch(St){os(St)}h.currentTarget=null,b=Be}else for(M=0;M<u.length;M++){if(ue=u[M],Be=ue.instance,it=ue.currentTarget,ue=ue.listener,Be!==b&&h.isPropagationStopped())break e;b=ue,h.currentTarget=it;try{b(h)}catch(St){os(St)}h.currentTarget=null,b=Be}}}}function $i(e,t){var a=t[Ri];a===void 0&&(a=t[Ri]=new Set);var u=e+"__bubble";a.has(u)||(w0(t,e,2,!1),a.add(u))}function Nh(e,t,a){var u=0;t&&(u|=4),w0(a,e,u,t)}var Np="_reactListening"+Math.random().toString(36).slice(2);function Ah(e){if(!e[Np]){e[Np]=!0,Gs.forEach(function(a){a!=="selectionchange"&&(nm.has(a)||Nh(a,!1,e),Nh(a,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Np]||(t[Np]=!0,Nh("selectionchange",!1,t))}}function w0(e,t,a,u){switch(K0(t)){case 2:var h=Pm;break;case 8:h=_m;break;default:h=Vh}a=h.bind(null,t,a,e),h=void 0,!Oc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(h=!0),u?h!==void 0?e.addEventListener(t,a,{capture:!0,passive:h}):e.addEventListener(t,a,!0):h!==void 0?e.addEventListener(t,a,{passive:h}):e.addEventListener(t,a,!1)}function zh(e,t,a,u,h){var b=u;if((t&1)===0&&(t&2)===0&&u!==null)e:for(;;){if(u===null)return;var M=u.tag;if(M===3||M===4){var ue=u.stateNode.containerInfo;if(ue===h)break;if(M===4)for(M=u.return;M!==null;){var Be=M.tag;if((Be===3||Be===4)&&M.stateNode.containerInfo===h)return;M=M.return}for(;ue!==null;){if(M=Jo(ue),M===null)return;if(Be=M.tag,Be===5||Be===6||Be===26||Be===27){u=b=M;continue e}ue=ue.parentNode}}u=u.return}Lr(function(){var it=b,St=To(a),zt=[];e:{var at=Ho.get(e);if(at!==void 0){var dt=gs,kn=e;switch(e){case"keypress":if(bn(a)===0)break e;case"keydown":case"keyup":dt=Fn;break;case"focusin":kn="focus",dt=_s;break;case"focusout":kn="blur",dt=_s;break;case"beforeblur":case"afterblur":dt=_s;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":dt=Pa;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":dt=$a;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":dt=Ji;break;case Gl:case vc:case Hu:dt=j;break;case Xa:dt=Gr;break;case"scroll":case"scrollend":dt=Li;break;case"wheel":dt=Cr;break;case"copy":case"cut":case"paste":dt=ze;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":dt=fr;break;case"toggle":case"beforetoggle":dt=da}var ei=(t&4)!==0,qr=!ei&&(e==="scroll"||e==="scrollend"),Ge=ei?at!==null?at+"Capture":null:at;ei=[];for(var qe=it,nt;qe!==null;){var Tt=qe;if(nt=Tt.stateNode,Tt=Tt.tag,Tt!==5&&Tt!==26&&Tt!==27||nt===null||Ge===null||(Tt=zi(qe,Ge),Tt!=null&&ei.push(zf(qe,Tt,nt))),qr)break;qe=qe.return}0<ei.length&&(at=new dt(at,kn,null,a,St),zt.push({event:at,listeners:ei}))}}if((t&7)===0){e:{if(at=e==="mouseover"||e==="pointerover",dt=e==="mouseout"||e==="pointerout",at&&a!==jo&&(kn=a.relatedTarget||a.fromElement)&&(Jo(kn)||kn[On]))break e;if((dt||at)&&(at=St.window===St?St:(at=St.ownerDocument)?at.defaultView||at.parentWindow:window,dt?(kn=a.relatedTarget||a.toElement,dt=it,kn=kn?Jo(kn):null,kn!==null&&(qr=d(kn),ei=kn.tag,kn!==qr||ei!==5&&ei!==27&&ei!==6)&&(kn=null)):(dt=null,kn=it),dt!==kn)){if(ei=Pa,Tt="onMouseLeave",Ge="onMouseEnter",qe="mouse",(e==="pointerout"||e==="pointerover")&&(ei=fr,Tt="onPointerLeave",Ge="onPointerEnter",qe="pointer"),qr=dt==null?at:ol(dt),nt=kn==null?at:ol(kn),at=new ei(Tt,qe+"leave",dt,a,St),at.target=qr,at.relatedTarget=nt,Tt=null,Jo(St)===it&&(ei=new ei(Ge,qe+"enter",kn,a,St),ei.target=nt,ei.relatedTarget=qr,Tt=ei),qr=Tt,dt&&kn)t:{for(ei=im,Ge=dt,qe=kn,nt=0,Tt=Ge;Tt;Tt=ei(Tt))nt++;Tt=0;for(var Gn=qe;Gn;Gn=ei(Gn))Tt++;for(;0<nt-Tt;)Ge=ei(Ge),nt--;for(;0<Tt-nt;)qe=ei(qe),Tt--;for(;nt--;){if(Ge===qe||qe!==null&&Ge===qe.alternate){ei=Ge;break t}Ge=ei(Ge),qe=ei(qe)}ei=null}else ei=null;dt!==null&&S0(zt,at,dt,ei,!1),kn!==null&&qr!==null&&S0(zt,qr,kn,ei,!0)}}e:{if(at=it?ol(it):window,dt=at.nodeName&&at.nodeName.toLowerCase(),dt==="select"||dt==="input"&&at.type==="file")var cr=Ao;else if(Uc(at))if(Ya)cr=Po;else{cr=pr;var Ln=zl}else dt=at.nodeName,!dt||dt.toLowerCase()!=="input"||at.type!=="checkbox"&&at.type!=="radio"?it&&br(it.elementType)&&(cr=Ao):cr=bc;if(cr&&(cr=cr(e,it))){is(zt,cr,a,St);break e}Ln&&Ln(e,at,it),e==="focusout"&&it&&at.type==="number"&&it.memoizedProps.value!=null&&sl(at,"number",at.value)}switch(Ln=it?ol(it):window,e){case"focusin":(Uc(Ln)||Ln.contentEditable==="true")&&(as=Ln,Ga=it,_a=null);break;case"focusout":_a=Ga=as=null;break;case"mousedown":_o=!0;break;case"contextmenu":case"mouseup":case"dragend":_o=!1,ki(zt,a,St);break;case"selectionchange":if(Yl)break;case"keydown":case"keyup":ki(zt,a,St)}var Ai;if(Xr)e:{switch(e){case"compositionstart":var Ki="onCompositionStart";break e;case"compositionend":Ki="onCompositionEnd";break e;case"compositionupdate":Ki="onCompositionUpdate";break e}Ki=void 0}else Vr?Kr(e,a)&&(Ki="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(Ki="onCompositionStart");Ki&&(Ds&&a.locale!=="ko"&&(Vr||Ki!=="onCompositionStart"?Ki==="onCompositionEnd"&&Vr&&(Ai=$n()):(mn=St,Zs="value"in mn?mn.value:mn.textContent,Vr=!0)),Ln=Ap(it,Ki),0<Ln.length&&(Ki=new Ie(Ki,e,null,a,St),zt.push({event:Ki,listeners:Ln}),Ai?Ki.data=Ai:(Ai=Ls(a),Ai!==null&&(Ki.data=Ai)))),(Ai=ko?fa(e,a):Qi(e,a))&&(Ki=Ap(it,"onBeforeInput"),0<Ki.length&&(Ln=new Ie("onBeforeInput","beforeinput",null,a,St),zt.push({event:Ln,listeners:Ki}),Ln.data=Ai)),Qy(zt,e,it,a,St)}v0(zt,t)})}function zf(e,t,a){return{instance:e,listener:t,currentTarget:a}}function Ap(e,t){for(var a=t+"Capture",u=[];e!==null;){var h=e,b=h.stateNode;if(h=h.tag,h!==5&&h!==26&&h!==27||b===null||(h=zi(e,a),h!=null&&u.unshift(zf(e,h,b)),h=zi(e,t),h!=null&&u.push(zf(e,h,b))),e.tag===3)return u;e=e.return}return[]}function im(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function S0(e,t,a,u,h){for(var b=t._reactName,M=[];a!==null&&a!==u;){var ue=a,Be=ue.alternate,it=ue.stateNode;if(ue=ue.tag,Be!==null&&Be===u)break;ue!==5&&ue!==26&&ue!==27||it===null||(Be=it,h?(it=zi(a,b),it!=null&&M.unshift(zf(a,it,Be))):h||(it=zi(a,b),it!=null&&M.push(zf(a,it,Be)))),a=a.return}M.length!==0&&e.push({event:t,listeners:M})}var rm=/\r\n?/g,am=/\u0000|\uFFFD/g;function j0(e){return(typeof e=="string"?e:""+e).replace(rm,`
`).replace(am,"")}function T0(e,t){return t=j0(t),j0(e)===t}function Ur(e,t,a,u,h,b){switch(a){case"children":typeof u=="string"?t==="body"||t==="textarea"&&u===""||wo(e,u):(typeof u=="number"||typeof u=="bigint")&&t!=="body"&&wo(e,""+u);break;case"className":vo(e,"class",u);break;case"tabIndex":vo(e,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":vo(e,a,u);break;case"style":Ft(e,u,b);break;case"data":if(t!=="object"){vo(e,"data",u);break}case"src":case"href":if(u===""&&(t!=="a"||a!=="href")){e.removeAttribute(a);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){e.removeAttribute(a);break}u=rr(""+u),e.setAttribute(a,u);break;case"action":case"formAction":if(typeof u=="function"){e.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof b=="function"&&(a==="formAction"?(t!=="input"&&Ur(e,t,"name",h.name,h,null),Ur(e,t,"formEncType",h.formEncType,h,null),Ur(e,t,"formMethod",h.formMethod,h,null),Ur(e,t,"formTarget",h.formTarget,h,null)):(Ur(e,t,"encType",h.encType,h,null),Ur(e,t,"method",h.method,h,null),Ur(e,t,"target",h.target,h,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){e.removeAttribute(a);break}u=rr(""+u),e.setAttribute(a,u);break;case"onClick":u!=null&&(e.onclick=ba);break;case"onScroll":u!=null&&$i("scroll",e);break;case"onScrollEnd":u!=null&&$i("scrollend",e);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(s(61));if(a=u.__html,a!=null){if(h.children!=null)throw Error(s(60));e.innerHTML=a}}break;case"multiple":e.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":e.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){e.removeAttribute("xlink:href");break}a=rr(""+u),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?e.setAttribute(a,""+u):e.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?e.setAttribute(a,""):e.removeAttribute(a);break;case"capture":case"download":u===!0?e.setAttribute(a,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?e.setAttribute(a,u):e.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?e.setAttribute(a,u):e.removeAttribute(a);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?e.removeAttribute(a):e.setAttribute(a,u);break;case"popover":$i("beforetoggle",e),$i("toggle",e),Na(e,"popover",u);break;case"xlinkActuate":Ha(e,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Ha(e,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Ha(e,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Ha(e,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Ha(e,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Ha(e,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Ha(e,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Ha(e,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Ha(e,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Na(e,"is",u);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=za.get(a)||a,Na(e,a,u))}}function Ph(e,t,a,u,h,b){switch(a){case"style":Ft(e,u,b);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(s(61));if(a=u.__html,a!=null){if(h.children!=null)throw Error(s(60));e.innerHTML=a}}break;case"children":typeof u=="string"?wo(e,u):(typeof u=="number"||typeof u=="bigint")&&wo(e,""+u);break;case"onScroll":u!=null&&$i("scroll",e);break;case"onScrollEnd":u!=null&&$i("scrollend",e);break;case"onClick":u!=null&&(e.onclick=ba);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Jn.hasOwnProperty(a))e:{if(a[0]==="o"&&a[1]==="n"&&(h=a.endsWith("Capture"),t=a.slice(2,h?a.length-7:void 0),b=e[si]||null,b=b!=null?b[a]:null,typeof b=="function"&&e.removeEventListener(t,b,h),typeof u=="function")){typeof b!="function"&&b!==null&&(a in e?e[a]=null:e.hasAttribute(a)&&e.removeAttribute(a)),e.addEventListener(t,u,h);break e}a in e?e[a]=u:u===!0?e.setAttribute(a,""):Na(e,a,u)}}}function ps(e,t,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":$i("error",e),$i("load",e);var u=!1,h=!1,b;for(b in a)if(a.hasOwnProperty(b)){var M=a[b];if(M!=null)switch(b){case"src":u=!0;break;case"srcSet":h=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:Ur(e,t,b,M,a,null)}}h&&Ur(e,t,"srcSet",a.srcSet,a,null),u&&Ur(e,t,"src",a.src,a,null);return;case"input":$i("invalid",e);var ue=b=M=h=null,Be=null,it=null;for(u in a)if(a.hasOwnProperty(u)){var St=a[u];if(St!=null)switch(u){case"name":h=St;break;case"type":M=St;break;case"checked":Be=St;break;case"defaultChecked":it=St;break;case"value":b=St;break;case"defaultValue":ue=St;break;case"children":case"dangerouslySetInnerHTML":if(St!=null)throw Error(s(137,t));break;default:Ur(e,t,u,St,a,null)}}Xs(e,b,ue,Be,it,M,h,!1);return;case"select":$i("invalid",e),u=M=b=null;for(h in a)if(a.hasOwnProperty(h)&&(ue=a[h],ue!=null))switch(h){case"value":b=ue;break;case"defaultValue":M=ue;break;case"multiple":u=ue;default:Ur(e,t,h,ue,a,null)}t=b,a=M,e.multiple=!!u,t!=null?dr(e,!!u,t,!1):a!=null&&dr(e,!!u,a,!0);return;case"textarea":$i("invalid",e),b=h=u=null;for(M in a)if(a.hasOwnProperty(M)&&(ue=a[M],ue!=null))switch(M){case"value":u=ue;break;case"defaultValue":h=ue;break;case"children":b=ue;break;case"dangerouslySetInnerHTML":if(ue!=null)throw Error(s(91));break;default:Ur(e,t,M,ue,a,null)}Ps(e,u,h,b);return;case"option":for(Be in a)if(a.hasOwnProperty(Be)&&(u=a[Be],u!=null))switch(Be){case"selected":e.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:Ur(e,t,Be,u,a,null)}return;case"dialog":$i("beforetoggle",e),$i("toggle",e),$i("cancel",e),$i("close",e);break;case"iframe":case"object":$i("load",e);break;case"video":case"audio":for(u=0;u<Af.length;u++)$i(Af[u],e);break;case"image":$i("error",e),$i("load",e);break;case"details":$i("toggle",e);break;case"embed":case"source":case"link":$i("error",e),$i("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(it in a)if(a.hasOwnProperty(it)&&(u=a[it],u!=null))switch(it){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:Ur(e,t,it,u,a,null)}return;default:if(br(t)){for(St in a)a.hasOwnProperty(St)&&(u=a[St],u!==void 0&&Ph(e,t,St,u,a,void 0));return}}for(ue in a)a.hasOwnProperty(ue)&&(u=a[ue],u!=null&&Ur(e,t,ue,u,a,null))}function om(e,t,a,u){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var h=null,b=null,M=null,ue=null,Be=null,it=null,St=null;for(dt in a){var zt=a[dt];if(a.hasOwnProperty(dt)&&zt!=null)switch(dt){case"checked":break;case"value":break;case"defaultValue":Be=zt;default:u.hasOwnProperty(dt)||Ur(e,t,dt,null,u,zt)}}for(var at in u){var dt=u[at];if(zt=a[at],u.hasOwnProperty(at)&&(dt!=null||zt!=null))switch(at){case"type":b=dt;break;case"name":h=dt;break;case"checked":it=dt;break;case"defaultChecked":St=dt;break;case"value":M=dt;break;case"defaultValue":ue=dt;break;case"children":case"dangerouslySetInnerHTML":if(dt!=null)throw Error(s(137,t));break;default:dt!==zt&&Ur(e,t,at,dt,u,zt)}}Dr(e,M,ue,Be,it,St,b,h);return;case"select":dt=M=ue=at=null;for(b in a)if(Be=a[b],a.hasOwnProperty(b)&&Be!=null)switch(b){case"value":break;case"multiple":dt=Be;default:u.hasOwnProperty(b)||Ur(e,t,b,null,u,Be)}for(h in u)if(b=u[h],Be=a[h],u.hasOwnProperty(h)&&(b!=null||Be!=null))switch(h){case"value":at=b;break;case"defaultValue":ue=b;break;case"multiple":M=b;default:b!==Be&&Ur(e,t,h,b,u,Be)}t=ue,a=M,u=dt,at!=null?dr(e,!!a,at,!1):!!u!=!!a&&(t!=null?dr(e,!!a,t,!0):dr(e,!!a,a?[]:"",!1));return;case"textarea":dt=at=null;for(ue in a)if(h=a[ue],a.hasOwnProperty(ue)&&h!=null&&!u.hasOwnProperty(ue))switch(ue){case"value":break;case"children":break;default:Ur(e,t,ue,null,u,h)}for(M in u)if(h=u[M],b=a[M],u.hasOwnProperty(M)&&(h!=null||b!=null))switch(M){case"value":at=h;break;case"defaultValue":dt=h;break;case"children":break;case"dangerouslySetInnerHTML":if(h!=null)throw Error(s(91));break;default:h!==b&&Ur(e,t,M,h,u,b)}Aa(e,at,dt);return;case"option":for(var kn in a)if(at=a[kn],a.hasOwnProperty(kn)&&at!=null&&!u.hasOwnProperty(kn))switch(kn){case"selected":e.selected=!1;break;default:Ur(e,t,kn,null,u,at)}for(Be in u)if(at=u[Be],dt=a[Be],u.hasOwnProperty(Be)&&at!==dt&&(at!=null||dt!=null))switch(Be){case"selected":e.selected=at&&typeof at!="function"&&typeof at!="symbol";break;default:Ur(e,t,Be,at,u,dt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ei in a)at=a[ei],a.hasOwnProperty(ei)&&at!=null&&!u.hasOwnProperty(ei)&&Ur(e,t,ei,null,u,at);for(it in u)if(at=u[it],dt=a[it],u.hasOwnProperty(it)&&at!==dt&&(at!=null||dt!=null))switch(it){case"children":case"dangerouslySetInnerHTML":if(at!=null)throw Error(s(137,t));break;default:Ur(e,t,it,at,u,dt)}return;default:if(br(t)){for(var qr in a)at=a[qr],a.hasOwnProperty(qr)&&at!==void 0&&!u.hasOwnProperty(qr)&&Ph(e,t,qr,void 0,u,at);for(St in u)at=u[St],dt=a[St],!u.hasOwnProperty(St)||at===dt||at===void 0&&dt===void 0||Ph(e,t,St,at,u,dt);return}}for(var Ge in a)at=a[Ge],a.hasOwnProperty(Ge)&&at!=null&&!u.hasOwnProperty(Ge)&&Ur(e,t,Ge,null,u,at);for(zt in u)at=u[zt],dt=a[zt],!u.hasOwnProperty(zt)||at===dt||at==null&&dt==null||Ur(e,t,zt,at,u,dt)}function C0(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function sm(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,a=performance.getEntriesByType("resource"),u=0;u<a.length;u++){var h=a[u],b=h.transferSize,M=h.initiatorType,ue=h.duration;if(b&&ue&&C0(M)){for(M=0,ue=h.responseEnd,u+=1;u<a.length;u++){var Be=a[u],it=Be.startTime;if(it>ue)break;var St=Be.transferSize,zt=Be.initiatorType;St&&C0(zt)&&(Be=Be.responseEnd,M+=St*(Be<ue?1:(ue-it)/(Be-it)))}if(--u,t+=8*(b+M)/(h.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var _h=null,Rh=null;function zp(e){return e.nodeType===9?e:e.ownerDocument}function k0(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function N0(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Dh(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Lh=null;function lm(){var e=window.event;return e&&e.type==="popstate"?e===Lh?!1:(Lh=e,!0):(Lh=null,!1)}var A0=typeof setTimeout=="function"?setTimeout:void 0,cm=typeof clearTimeout=="function"?clearTimeout:void 0,z0=typeof Promise=="function"?Promise:void 0,um=typeof queueMicrotask=="function"?queueMicrotask:typeof z0<"u"?function(e){return z0.resolve(null).then(e).catch(dm)}:A0;function dm(e){setTimeout(function(){throw e})}function Du(e){return e==="head"}function P0(e,t){var a=t,u=0;do{var h=a.nextSibling;if(e.removeChild(a),h&&h.nodeType===8)if(a=h.data,a==="/$"||a==="/&"){if(u===0){e.removeChild(h),Wd(t);return}u--}else if(a==="$"||a==="$?"||a==="$~"||a==="$!"||a==="&")u++;else if(a==="html")Pf(e.ownerDocument.documentElement);else if(a==="head"){a=e.ownerDocument.head,Pf(a);for(var b=a.firstChild;b;){var M=b.nextSibling,ue=b.nodeName;b[Rr]||ue==="SCRIPT"||ue==="STYLE"||ue==="LINK"&&b.rel.toLowerCase()==="stylesheet"||a.removeChild(b),b=M}}else a==="body"&&Pf(e.ownerDocument.body);a=h}while(a);Wd(t)}function _0(e,t){var a=e;e=0;do{var u=a.nextSibling;if(a.nodeType===1?t?(a._stashedDisplay=a.style.display,a.style.display="none"):(a.style.display=a._stashedDisplay||"",a.getAttribute("style")===""&&a.removeAttribute("style")):a.nodeType===3&&(t?(a._stashedText=a.nodeValue,a.nodeValue=""):a.nodeValue=a._stashedText||""),u&&u.nodeType===8)if(a=u.data,a==="/$"){if(e===0)break;e--}else a!=="$"&&a!=="$?"&&a!=="$~"&&a!=="$!"||e++;a=u}while(a)}function Mh(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var a=t;switch(t=t.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":Mh(a),Ys(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}e.removeChild(a)}}function fm(e,t,a,u){for(;e.nodeType===1;){var h=a;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!u&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(u){if(!e[Rr])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(b=e.getAttribute("rel"),b==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(b!==h.rel||e.getAttribute("href")!==(h.href==null||h.href===""?null:h.href)||e.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin)||e.getAttribute("title")!==(h.title==null?null:h.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(b=e.getAttribute("src"),(b!==(h.src==null?null:h.src)||e.getAttribute("type")!==(h.type==null?null:h.type)||e.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin))&&b&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var b=h.name==null?null:""+h.name;if(h.type==="hidden"&&e.getAttribute("name")===b)return e}else return e;if(e=Ul(e.nextSibling),e===null)break}return null}function pm(e,t,a){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!a||(e=Ul(e.nextSibling),e===null))return null;return e}function R0(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=Ul(e.nextSibling),e===null))return null;return e}function Ih(e){return e.data==="$?"||e.data==="$~"}function Bh(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function hm(e,t){var a=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||a.readyState!=="loading")t();else{var u=function(){t(),a.removeEventListener("DOMContentLoaded",u)};a.addEventListener("DOMContentLoaded",u),e._reactRetry=u}}function Ul(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var Eh=null;function D0(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"||a==="/&"){if(t===0)return Ul(e.nextSibling);t--}else a!=="$"&&a!=="$!"&&a!=="$?"&&a!=="$~"&&a!=="&"||t++}e=e.nextSibling}return null}function L0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"){if(t===0)return e;t--}else a!=="/$"&&a!=="/&"||t++}e=e.previousSibling}return null}function M0(e,t,a){switch(t=zp(a),e){case"html":if(e=t.documentElement,!e)throw Error(s(452));return e;case"head":if(e=t.head,!e)throw Error(s(453));return e;case"body":if(e=t.body,!e)throw Error(s(454));return e;default:throw Error(s(451))}}function Pf(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Ys(e)}var ql=new Map,I0=new Set;function Pp(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var lu=xe.d;xe.d={f:gm,r:xm,D:ym,C:mm,L:bm,m:vm,X:Sm,S:wm,M:jm};function gm(){var e=lu.f(),t=fs();return e||t}function xm(e){var t=Qo(e);t!==null&&t.tag===5&&t.type==="form"?Jc(t):lu.r(e)}var qd=typeof document>"u"?null:document;function B0(e,t,a){var u=qd;if(u&&typeof t=="string"&&t){var h=ui(t);h='link[rel="'+e+'"][href="'+h+'"]',typeof a=="string"&&(h+='[crossorigin="'+a+'"]'),I0.has(h)||(I0.add(h),e={rel:e,crossOrigin:a,href:t},u.querySelector(h)===null&&(t=u.createElement("link"),ps(t,"link",e),jr(t),u.head.appendChild(t)))}}function ym(e){lu.D(e),B0("dns-prefetch",e,null)}function mm(e,t){lu.C(e,t),B0("preconnect",e,t)}function bm(e,t,a){lu.L(e,t,a);var u=qd;if(u&&e&&t){var h='link[rel="preload"][as="'+ui(t)+'"]';t==="image"&&a&&a.imageSrcSet?(h+='[imagesrcset="'+ui(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(h+='[imagesizes="'+ui(a.imageSizes)+'"]')):h+='[href="'+ui(e)+'"]';var b=h;switch(t){case"style":b=Vd(e);break;case"script":b=Hd(e)}ql.has(b)||(e=_({rel:"preload",href:t==="image"&&a&&a.imageSrcSet?void 0:e,as:t},a),ql.set(b,e),u.querySelector(h)!==null||t==="style"&&u.querySelector(_f(b))||t==="script"&&u.querySelector(Rf(b))||(t=u.createElement("link"),ps(t,"link",e),jr(t),u.head.appendChild(t)))}}function vm(e,t){lu.m(e,t);var a=qd;if(a&&e){var u=t&&typeof t.as=="string"?t.as:"script",h='link[rel="modulepreload"][as="'+ui(u)+'"][href="'+ui(e)+'"]',b=h;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":b=Hd(e)}if(!ql.has(b)&&(e=_({rel:"modulepreload",href:e},t),ql.set(b,e),a.querySelector(h)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(Rf(b)))return}u=a.createElement("link"),ps(u,"link",e),jr(u),a.head.appendChild(u)}}}function wm(e,t,a){lu.S(e,t,a);var u=qd;if(u&&e){var h=es(u).hoistableStyles,b=Vd(e);t=t||"default";var M=h.get(b);if(!M){var ue={loading:0,preload:null};if(M=u.querySelector(_f(b)))ue.loading=5;else{e=_({rel:"stylesheet",href:e,"data-precedence":t},a),(a=ql.get(b))&&Oh(e,a);var Be=M=u.createElement("link");jr(Be),ps(Be,"link",e),Be._p=new Promise(function(it,St){Be.onload=it,Be.onerror=St}),Be.addEventListener("load",function(){ue.loading|=1}),Be.addEventListener("error",function(){ue.loading|=2}),ue.loading|=4,_p(M,t,u)}M={type:"stylesheet",instance:M,count:1,state:ue},h.set(b,M)}}}function Sm(e,t){lu.X(e,t);var a=qd;if(a&&e){var u=es(a).hoistableScripts,h=Hd(e),b=u.get(h);b||(b=a.querySelector(Rf(h)),b||(e=_({src:e,async:!0},t),(t=ql.get(h))&&Fh(e,t),b=a.createElement("script"),jr(b),ps(b,"link",e),a.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},u.set(h,b))}}function jm(e,t){lu.M(e,t);var a=qd;if(a&&e){var u=es(a).hoistableScripts,h=Hd(e),b=u.get(h);b||(b=a.querySelector(Rf(h)),b||(e=_({src:e,async:!0,type:"module"},t),(t=ql.get(h))&&Fh(e,t),b=a.createElement("script"),jr(b),ps(b,"link",e),a.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},u.set(h,b))}}function E0(e,t,a,u){var h=(h=he.current)?Pp(h):null;if(!h)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(t=Vd(a.href),a=es(h).hoistableStyles,u=a.get(t),u||(u={type:"style",instance:null,count:0,state:null},a.set(t,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){e=Vd(a.href);var b=es(h).hoistableStyles,M=b.get(e);if(M||(h=h.ownerDocument||h,M={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},b.set(e,M),(b=h.querySelector(_f(e)))&&!b._p&&(M.instance=b,M.state.loading=5),ql.has(e)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},ql.set(e,a),b||Tm(h,e,a,M.state))),t&&u===null)throw Error(s(528,""));return M}if(t&&u!==null)throw Error(s(529,""));return null;case"script":return t=a.async,a=a.src,typeof a=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Hd(a),a=es(h).hoistableScripts,u=a.get(t),u||(u={type:"script",instance:null,count:0,state:null},a.set(t,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function Vd(e){return'href="'+ui(e)+'"'}function _f(e){return'link[rel="stylesheet"]['+e+"]"}function O0(e){return _({},e,{"data-precedence":e.precedence,precedence:null})}function Tm(e,t,a,u){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?u.loading=1:(t=e.createElement("link"),u.preload=t,t.addEventListener("load",function(){return u.loading|=1}),t.addEventListener("error",function(){return u.loading|=2}),ps(t,"link",a),jr(t),e.head.appendChild(t))}function Hd(e){return'[src="'+ui(e)+'"]'}function Rf(e){return"script[async]"+e}function F0(e,t,a){if(t.count++,t.instance===null)switch(t.type){case"style":var u=e.querySelector('style[data-href~="'+ui(a.href)+'"]');if(u)return t.instance=u,jr(u),u;var h=_({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return u=(e.ownerDocument||e).createElement("style"),jr(u),ps(u,"style",h),_p(u,a.precedence,e),t.instance=u;case"stylesheet":h=Vd(a.href);var b=e.querySelector(_f(h));if(b)return t.state.loading|=4,t.instance=b,jr(b),b;u=O0(a),(h=ql.get(h))&&Oh(u,h),b=(e.ownerDocument||e).createElement("link"),jr(b);var M=b;return M._p=new Promise(function(ue,Be){M.onload=ue,M.onerror=Be}),ps(b,"link",u),t.state.loading|=4,_p(b,a.precedence,e),t.instance=b;case"script":return b=Hd(a.src),(h=e.querySelector(Rf(b)))?(t.instance=h,jr(h),h):(u=a,(h=ql.get(b))&&(u=_({},a),Fh(u,h)),e=e.ownerDocument||e,h=e.createElement("script"),jr(h),ps(h,"link",u),e.head.appendChild(h),t.instance=h);case"void":return null;default:throw Error(s(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(u=t.instance,t.state.loading|=4,_p(u,a.precedence,e));return t.instance}function _p(e,t,a){for(var u=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),h=u.length?u[u.length-1]:null,b=h,M=0;M<u.length;M++){var ue=u[M];if(ue.dataset.precedence===t)b=ue;else if(b!==h)break}b?b.parentNode.insertBefore(e,b.nextSibling):(t=a.nodeType===9?a.head:a,t.insertBefore(e,t.firstChild))}function Oh(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Fh(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var Rp=null;function U0(e,t,a){if(Rp===null){var u=new Map,h=Rp=new Map;h.set(a,u)}else h=Rp,u=h.get(a),u||(u=new Map,h.set(a,u));if(u.has(e))return u;for(u.set(e,null),a=a.getElementsByTagName(e),h=0;h<a.length;h++){var b=a[h];if(!(b[Rr]||b[yt]||e==="link"&&b.getAttribute("rel")==="stylesheet")&&b.namespaceURI!=="http://www.w3.org/2000/svg"){var M=b.getAttribute(t)||"";M=e+M;var ue=u.get(M);ue?ue.push(b):u.set(M,[b])}}return u}function q0(e,t,a){e=e.ownerDocument||e,e.head.insertBefore(a,t==="title"?e.querySelector("head > title"):null)}function Cm(e,t,a){if(a===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function V0(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function km(e,t,a,u){if(a.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var h=Vd(u.href),b=t.querySelector(_f(h));if(b){t=b._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=Dp.bind(e),t.then(e,e)),a.state.loading|=4,a.instance=b,jr(b);return}b=t.ownerDocument||t,u=O0(u),(h=ql.get(h))&&Oh(u,h),b=b.createElement("link"),jr(b);var M=b;M._p=new Promise(function(ue,Be){M.onload=ue,M.onerror=Be}),ps(b,"link",u),a.instance=b}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(a,t),(t=a.state.preload)&&(a.state.loading&3)===0&&(e.count++,a=Dp.bind(e),t.addEventListener("load",a),t.addEventListener("error",a))}}var Uh=0;function Nm(e,t){return e.stylesheets&&e.count===0&&Mp(e,e.stylesheets),0<e.count||0<e.imgCount?function(a){var u=setTimeout(function(){if(e.stylesheets&&Mp(e,e.stylesheets),e.unsuspend){var b=e.unsuspend;e.unsuspend=null,b()}},6e4+t);0<e.imgBytes&&Uh===0&&(Uh=62500*sm());var h=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Mp(e,e.stylesheets),e.unsuspend)){var b=e.unsuspend;e.unsuspend=null,b()}},(e.imgBytes>Uh?50:800)+t);return e.unsuspend=a,function(){e.unsuspend=null,clearTimeout(u),clearTimeout(h)}}:null}function Dp(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Mp(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Lp=null;function Mp(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Lp=new Map,t.forEach(Am,e),Lp=null,Dp.call(e))}function Am(e,t){if(!(t.state.loading&4)){var a=Lp.get(e);if(a)var u=a.get(null);else{a=new Map,Lp.set(e,a);for(var h=e.querySelectorAll("link[data-precedence],style[data-precedence]"),b=0;b<h.length;b++){var M=h[b];(M.nodeName==="LINK"||M.getAttribute("media")!=="not all")&&(a.set(M.dataset.precedence,M),u=M)}u&&a.set(null,u)}h=t.instance,M=h.getAttribute("data-precedence"),b=a.get(M)||u,b===u&&a.set(null,h),a.set(M,h),this.count++,u=Dp.bind(this),h.addEventListener("load",u),h.addEventListener("error",u),b?b.parentNode.insertBefore(h,b.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(h,e.firstChild)),t.state.loading|=4}}var Df={$$typeof:$,Provider:null,Consumer:null,_currentValue:fe,_currentValue2:fe,_threadCount:0};function zm(e,t,a,u,h,b,M,ue,Be){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Zi(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zi(0),this.hiddenUpdates=Zi(null),this.identifierPrefix=u,this.onUncaughtError=h,this.onCaughtError=b,this.onRecoverableError=M,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Be,this.incompleteTransitions=new Map}function H0(e,t,a,u,h,b,M,ue,Be,it,St,zt){return e=new zm(e,t,a,M,Be,it,St,zt,ue),t=1,b===!0&&(t|=24),b=Za(3,null,null,t),e.current=b,b.stateNode=e,t=co(),t.refCount++,e.pooledCache=t,t.refCount++,b.memoizedState={element:u,isDehydrated:a,cache:t},$t(b),e}function W0(e){return e?(e=Ka,e):Ka}function $0(e,t,a,u,h,b){h=W0(h),u.context===null?u.context=h:u.pendingContext=h,u=yn(t),u.payload={element:a},b=b===void 0?null:b,b!==null&&(u.callback=b),a=Un(e,u,t),a!==null&&(Ni(a,e,t),Bi(a,e,t))}function Y0(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<t?a:t}}function qh(e,t){Y0(e,t),(e=e.alternate)&&Y0(e,t)}function G0(e){if(e.tag===13||e.tag===31){var t=va(e,67108864);t!==null&&Ni(t,e,67108864),qh(e,67108864)}}function X0(e){if(e.tag===13||e.tag===31){var t=vi();t=Zt(t);var a=va(e,t);a!==null&&Ni(a,e,t),qh(e,t)}}var Ip=!0;function Pm(e,t,a,u){var h=ce.T;ce.T=null;var b=xe.p;try{xe.p=2,Vh(e,t,a,u)}finally{xe.p=b,ce.T=h}}function _m(e,t,a,u){var h=ce.T;ce.T=null;var b=xe.p;try{xe.p=8,Vh(e,t,a,u)}finally{xe.p=b,ce.T=h}}function Vh(e,t,a,u){if(Ip){var h=Hh(u);if(h===null)zh(e,t,u,Bp,a),Z0(e,u);else if(Dm(h,e,t,a,u))u.stopPropagation();else if(Z0(e,u),t&4&&-1<Rm.indexOf(e)){for(;h!==null;){var b=Qo(h);if(b!==null)switch(b.tag){case 3:if(b=b.stateNode,b.current.memoizedState.isDehydrated){var M=ln(b.pendingLanes);if(M!==0){var ue=b;for(ue.pendingLanes|=2,ue.entangledLanes|=2;M;){var Be=1<<31-un(M);ue.entanglements[1]|=Be,M&=~Be}Dc(b),(A&6)===0&&(lt=Nn()+500,Nf(0))}}break;case 31:case 13:ue=va(b,2),ue!==null&&Ni(ue,b,2),fs(),qh(b,2)}if(b=Hh(u),b===null&&zh(e,t,u,Bp,a),b===h)break;h=b}h!==null&&u.stopPropagation()}else zh(e,t,u,null,a)}}function Hh(e){return e=To(e),Wh(e)}var Bp=null;function Wh(e){if(Bp=null,e=Jo(e),e!==null){var t=d(e);if(t===null)e=null;else{var a=t.tag;if(a===13){if(e=v(t),e!==null)return e;e=null}else if(a===31){if(e=p(t),e!==null)return e;e=null}else if(a===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Bp=e,null}function K0(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(zn()){case Ee:return 2;case Ne:return 8;case Mt:case ct:return 32;case _t:return 268435456;default:return 32}default:return 32}}var $h=!1,Lu=null,Mu=null,Iu=null,Lf=new Map,Mf=new Map,Bu=[],Rm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Z0(e,t){switch(e){case"focusin":case"focusout":Lu=null;break;case"dragenter":case"dragleave":Mu=null;break;case"mouseover":case"mouseout":Iu=null;break;case"pointerover":case"pointerout":Lf.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mf.delete(t.pointerId)}}function If(e,t,a,u,h,b){return e===null||e.nativeEvent!==b?(e={blockedOn:t,domEventName:a,eventSystemFlags:u,nativeEvent:b,targetContainers:[h]},t!==null&&(t=Qo(t),t!==null&&G0(t)),e):(e.eventSystemFlags|=u,t=e.targetContainers,h!==null&&t.indexOf(h)===-1&&t.push(h),e)}function Dm(e,t,a,u,h){switch(t){case"focusin":return Lu=If(Lu,e,t,a,u,h),!0;case"dragenter":return Mu=If(Mu,e,t,a,u,h),!0;case"mouseover":return Iu=If(Iu,e,t,a,u,h),!0;case"pointerover":var b=h.pointerId;return Lf.set(b,If(Lf.get(b)||null,e,t,a,u,h)),!0;case"gotpointercapture":return b=h.pointerId,Mf.set(b,If(Mf.get(b)||null,e,t,a,u,h)),!0}return!1}function J0(e){var t=Jo(e.target);if(t!==null){var a=d(t);if(a!==null){if(t=a.tag,t===13){if(t=v(a),t!==null){e.blockedOn=t,qi(e.priority,function(){X0(a)});return}}else if(t===31){if(t=p(a),t!==null){e.blockedOn=t,qi(e.priority,function(){X0(a)});return}}else if(t===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ep(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var a=Hh(e.nativeEvent);if(a===null){a=e.nativeEvent;var u=new a.constructor(a.type,a);jo=u,a.target.dispatchEvent(u),jo=null}else return t=Qo(a),t!==null&&G0(t),e.blockedOn=a,!1;t.shift()}return!0}function Q0(e,t,a){Ep(e)&&a.delete(t)}function Lm(){$h=!1,Lu!==null&&Ep(Lu)&&(Lu=null),Mu!==null&&Ep(Mu)&&(Mu=null),Iu!==null&&Ep(Iu)&&(Iu=null),Lf.forEach(Q0),Mf.forEach(Q0)}function Op(e,t){e.blockedOn===t&&(e.blockedOn=null,$h||($h=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Lm)))}var Fp=null;function e1(e){Fp!==e&&(Fp=e,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){Fp===e&&(Fp=null);for(var t=0;t<e.length;t+=3){var a=e[t],u=e[t+1],h=e[t+2];if(typeof u!="function"){if(Wh(u||a)===null)continue;break}var b=Qo(a);b!==null&&(e.splice(t,3),t-=3,ff(b,{pending:!0,data:h,method:a.method,action:u},u,h))}}))}function Wd(e){function t(Be){return Op(Be,e)}Lu!==null&&Op(Lu,e),Mu!==null&&Op(Mu,e),Iu!==null&&Op(Iu,e),Lf.forEach(t),Mf.forEach(t);for(var a=0;a<Bu.length;a++){var u=Bu[a];u.blockedOn===e&&(u.blockedOn=null)}for(;0<Bu.length&&(a=Bu[0],a.blockedOn===null);)J0(a),a.blockedOn===null&&Bu.shift();if(a=(e.ownerDocument||e).$$reactFormReplay,a!=null)for(u=0;u<a.length;u+=3){var h=a[u],b=a[u+1],M=h[si]||null;if(typeof b=="function")M||e1(a);else if(M){var ue=null;if(b&&b.hasAttribute("formAction")){if(h=b,M=b[si]||null)ue=M.formAction;else if(Wh(h)!==null)continue}else ue=M.action;typeof ue=="function"?a[u+1]=ue:(a.splice(u,3),u-=3),e1(a)}}}function t1(){function e(b){b.canIntercept&&b.info==="react-transition"&&b.intercept({handler:function(){return new Promise(function(M){return h=M})},focusReset:"manual",scroll:"manual"})}function t(){h!==null&&(h(),h=null),u||setTimeout(a,20)}function a(){if(!u&&!navigation.transition){var b=navigation.currentEntry;b&&b.url!=null&&navigation.navigate(b.url,{state:b.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,h=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(a,100),function(){u=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),h!==null&&(h(),h=null)}}}function Yh(e){this._internalRoot=e}Up.prototype.render=Yh.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(s(409));var a=t.current,u=vi();$0(a,u,e,t,null,null)},Up.prototype.unmount=Yh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;$0(e.current,2,null,e,null,null),fs(),t[On]=null}};function Up(e){this._internalRoot=e}Up.prototype.unstable_scheduleHydration=function(e){if(e){var t=Wn();e={blockedOn:null,target:e,priority:t};for(var a=0;a<Bu.length&&t!==0&&t<Bu[a].priority;a++);Bu.splice(a,0,e),a===0&&J0(e)}};var n1=r.version;if(n1!=="19.2.0")throw Error(s(527,n1,"19.2.0"));xe.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(s(188)):(e=Object.keys(e).join(","),Error(s(268,e)));return e=m(t),e=e!==null?S(e):null,e=e===null?null:e.stateNode,e};var Mm={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:ce,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qp.isDisabled&&qp.supportsFiber)try{en=qp.inject(Mm),Qe=qp}catch{}}return Ef.createRoot=function(e,t){if(!c(e))throw Error(s(299));var a=!1,u="",h=Gu,b=Xu,M=Ku;return t!=null&&(t.unstable_strictMode===!0&&(a=!0),t.identifierPrefix!==void 0&&(u=t.identifierPrefix),t.onUncaughtError!==void 0&&(h=t.onUncaughtError),t.onCaughtError!==void 0&&(b=t.onCaughtError),t.onRecoverableError!==void 0&&(M=t.onRecoverableError)),t=H0(e,1,!1,null,null,a,u,null,h,b,M,t1),e[On]=t.current,Ah(e),new Yh(t)},Ef.hydrateRoot=function(e,t,a){if(!c(e))throw Error(s(299));var u=!1,h="",b=Gu,M=Xu,ue=Ku,Be=null;return a!=null&&(a.unstable_strictMode===!0&&(u=!0),a.identifierPrefix!==void 0&&(h=a.identifierPrefix),a.onUncaughtError!==void 0&&(b=a.onUncaughtError),a.onCaughtError!==void 0&&(M=a.onCaughtError),a.onRecoverableError!==void 0&&(ue=a.onRecoverableError),a.formState!==void 0&&(Be=a.formState)),t=H0(e,1,!0,t,a??null,u,h,Be,b,M,ue,t1),t.context=W0(null),a=t.current,u=vi(),u=Zt(u),h=yn(u),h.callback=null,Un(a,h,u),a=u,t.current.lanes=a,Yt(t,a),Dc(t),e[On]=t.current,Ah(e),new Up(t)},Ef.version="19.2.0",Ef}var f1;function $m(){if(f1)return Kh.exports;f1=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(r){console.error(r)}}return i(),Kh.exports=Wm(),Kh.exports}var Ym=$m();/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gm=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Xm=i=>i.replace(/^([A-Z])|[\s-_]+(\w)/g,(r,o,s)=>s?s.toUpperCase():o.toLowerCase()),p1=i=>{const r=Xm(i);return r.charAt(0).toUpperCase()+r.slice(1)},Ux=(...i)=>i.filter((r,o,s)=>!!r&&r.trim()!==""&&s.indexOf(r)===o).join(" ").trim(),Km=i=>{for(const r in i)if(r.startsWith("aria-")||r==="role"||r==="title")return!0};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Zm={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jm=L.forwardRef(({color:i="currentColor",size:r=24,strokeWidth:o=2,absoluteStrokeWidth:s,className:c="",children:d,iconNode:v,...p},g)=>L.createElement("svg",{ref:g,...Zm,width:r,height:r,stroke:i,strokeWidth:s?Number(o)*24/Number(r):o,className:Ux("lucide",c),...!d&&!Km(p)&&{"aria-hidden":"true"},...p},[...v.map(([m,S])=>L.createElement(m,S)),...Array.isArray(d)?d:[d]]));/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qx=(i,r)=>{const o=L.forwardRef(({className:s,...c},d)=>L.createElement(Jm,{ref:d,iconNode:r,className:Ux(`lucide-${Gm(p1(i))}`,`lucide-${i}`,s),...c}));return o.displayName=p1(i),o};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qm=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],e2=qx("mouse-pointer",Qm);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t2=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],n2=qx("pen-line",t2),i2=JSON.parse('[{"category":"Capacitors","subcategory":"General","type":"Capacitor","displayName":"Capacitor","description":"General purpose capacitor","searchText":"capacitor general","designator":"C","defaultPins":2,"properties":{"capacitorType":"General"},"fields":[{"name":"capacitance","label":"Capacitance","type":"number","units":["pF","nF","F","mF","F"],"defaultUnit":"F","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"tolerance","label":"Tolerance","type":"string","required":false},{"name":"dielectric","label":"Dielectric","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Capacitors","subcategory":"Electrolytic","type":"Capacitor","displayName":"Electrolytic","description":"Electrolytic capacitor","searchText":"electrolytic capacitor","designator":"CE","defaultPins":2,"properties":{"capacitorType":"Electrolytic","polarized":true},"fields":[{"name":"capacitance","label":"Capacitance","type":"number","units":["pF","nF","F","mF","F"],"defaultUnit":"F","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"tolerance","label":"Tolerance","type":"string","defaultValue":"20%","required":false},{"name":"esr","label":"ESR","type":"number","units":["m",""],"defaultUnit":"","required":false},{"name":"temperature","label":"Temperature Range","type":"string","required":false},{"name":"ripple","label":"Ripple Current","type":"number","units":["mA","A"],"defaultUnit":"mA","required":false},{"name":"leakageCurrent","label":"Leakage Current","type":"number","units":["A","mA"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Capacitors","subcategory":"Film","type":"Capacitor","displayName":"Film","description":"Film capacitor","searchText":"film capacitor","designator":"CF","defaultPins":2,"properties":{"capacitorType":"Film"},"fields":[{"name":"capacitance","label":"Capacitance","type":"number","units":["pF","nF","F","mF","F"],"defaultUnit":"nF","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"tolerance","label":"Tolerance","type":"string","defaultValue":"10%","required":false},{"name":"filmType","label":"Film Type","type":"enum","enumValues":["Polyester","Polypropylene","Polyethylene","Polystyrene","Teflon"],"defaultValue":"Polyester","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Capacitors","subcategory":"Tantalum","type":"Capacitor","displayName":"Tantalum","description":"Tantalum capacitor","searchText":"tantalum capacitor","designator":"C","defaultPins":2,"properties":{"capacitorType":"Tantalum","dielectric":"Tantalum","polarized":true},"fields":[{"name":"capacitance","label":"Capacitance","type":"number","units":["pF","nF","F","mF","F"],"defaultUnit":"F","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"tolerance","label":"Tolerance","type":"string","required":false},{"name":"esr","label":"ESR","type":"number","units":["m",""],"defaultUnit":"","required":false},{"name":"leakageCurrent","label":"Leakage Current","type":"number","units":["A","mA"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Diodes","subcategory":"Standard","type":"Diode","displayName":"Diode","description":"Standard diode","searchText":"diode standard","designator":"D","defaultPins":2,"subtype":"Standard","properties":{"diodeType":"Standard","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"Zener","type":"Diode","displayName":"Zener","description":"Zener diode","searchText":"zener diode","designator":"Z","defaultPins":2,"subtype":"Zener","properties":{"diodeType":"Zener","polarized":true},"fields":[{"name":"voltage","label":"Zener Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"mA","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"LED","type":"Diode","displayName":"LED","description":"LED diode","searchText":"led diode","designator":"LED","defaultPins":2,"subtype":"LED","properties":{"diodeType":"LED","polarized":true},"fields":[{"name":"voltage","label":"Forward Voltage","type":"number","units":["mV","V"],"defaultUnit":"V","required":false},{"name":"current","label":"Forward Current","type":"number","units":["mA","A"],"defaultUnit":"mA","required":false},{"name":"ledColor","label":"Color","type":"string","required":false},{"name":"wavelength","label":"Wavelength","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"Schottky","type":"Diode","displayName":"Schottky","description":"Schottky diode","searchText":"schottky diode","designator":"D","defaultPins":2,"subtype":"Schottky","properties":{"diodeType":"Schottky","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"Infrared","type":"Diode","displayName":"Infrared","description":"Infrared diode","searchText":"infrared diode","designator":"IR","defaultPins":2,"subtype":"Infrared","properties":{"diodeType":"Infrared","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["mA","A"],"defaultUnit":"mA","required":false},{"name":"wavelength","label":"Wavelength","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"Photodiode","type":"Diode","displayName":"Photodiode","description":"Photodiode","searchText":"photodiode diode","designator":"PD","defaultPins":2,"subtype":"Photodiode","properties":{"diodeType":"Photodiode","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"wavelength","label":"Wavelength","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Resistors","subcategory":"Standard","type":"Resistor","displayName":"Resistor","description":"Standard resistor","searchText":"resistor standard","designator":"R","defaultPins":2,"properties":{"resistorType":"Standard"},"fields":[{"name":"resistance","label":"Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"tolerance","label":"Tolerance","type":"string","defaultValue":"5%","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Resistors","subcategory":"Network","type":"Resistor","displayName":"Resistor Network","description":"Resistor network","searchText":"resistor network","designator":"RN","defaultPins":8,"properties":{"resistorType":"Network"},"fields":[{"name":"resistance","label":"Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"configuration","label":"Configuration","type":"enum","enumValues":["Isolated","Bussed","Dual Terminator"],"defaultValue":"Isolated","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Resistors","subcategory":"Thermistor","type":"Resistor","displayName":"Thermistor","description":"Thermistor resistor","searchText":"thermistor resistor","designator":"RT","defaultPins":2,"properties":{"resistorType":"Thermistor"},"fields":[{"name":"resistance","label":"Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"thermistorType","label":"Thermistor Type","type":"enum","enumValues":["NTC","PTC"],"defaultValue":"NTC","required":false},{"name":"beta","label":"Beta Value","type":"number","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Resistors","subcategory":"Variable","type":"Resistor","displayName":"Variable Resistor","description":"Variable resistor","searchText":"variable resistor","designator":"VR","defaultPins":3,"subtype":"Potentiometer","properties":{"resistorType":"Variable","vrType":"Potentiometer"},"fields":[{"name":"resistance","label":"Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"taper","label":"Taper","type":"enum","enumValues":["Linear","Logarithmic"],"defaultValue":"Linear","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Resistors","subcategory":"Varistor","type":"Resistor","displayName":"Varistor","description":"Varistor resistor","searchText":"varistor resistor","designator":"RV","defaultPins":3,"subtype":"Varistor","properties":{"resistorType":"Variable","vrType":"Varistor"},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"BJT","type":"Semiconductor","displayName":"Transistor, BJT NPN","description":"Bipolar Junction Transistor NPN (Collector, Base, Emitter)","searchText":"bjt transistor bipolar junction base emitter collector npn","designator":"Q","defaultPins":3,"properties":{"semiconductorType":"Transistor","transistorType":"BJT","pinNames":["Collector","Base","Emitter"]},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"BJT PNP","type":"Semiconductor","displayName":"Transistor, BJT PNP","description":"Bipolar Junction Transistor PNP (Emitter, Base, Collector)","searchText":"bjt transistor bipolar junction base emitter collector pnp","designator":"Q","defaultPins":3,"properties":{"semiconductorType":"Transistor","transistorType":"BJT","pinNames":["Emitter","Base","Collector"]},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"MOSFET","type":"Semiconductor","displayName":"Transistor, MOSFET, N-Channel","description":"Metal-Oxide-Semiconductor Field-Effect Transistor N-Channel (Source, Gate, Drain)","searchText":"mosfet transistor metal oxide semiconductor field effect source gate drain n-channel","designator":"Q","defaultPins":3,"properties":{"semiconductorType":"Transistor","transistorType":"MOSFET","pinNames":["Source","Drain","Gate"]},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"MOSFET P-Channel","type":"Semiconductor","displayName":"Transistor, MOSFET, P-Channel","description":"Metal-Oxide-Semiconductor Field-Effect Transistor P-Channel (Source, Gate, Drain)","searchText":"mosfet transistor metal oxide semiconductor field effect source gate drain p-channel","designator":"Q","defaultPins":3,"properties":{"semiconductorType":"Transistor","transistorType":"MOSFET","pinNames":["Source","Drain","Gate"]},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"JFET","type":"Semiconductor","displayName":"Transistor, JFET","description":"Junction Field-Effect Transistor (Source, Gate, Drain)","searchText":"jfet transistor junction field effect source gate drain n-channel p-channel","designator":"Q","defaultPins":3,"properties":{"semiconductorType":"Transistor","transistorType":"JFET","pinNames":["Source","Gate","Drain"]},"fields":[{"name":"polarity","label":"Polarity","type":"enum","enumValues":["N-Channel","P-Channel"],"defaultValue":"N-Channel","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"Single Op Amp","type":"Semiconductor","displayName":"Op Amp, Single","description":"Single operational amplifier","searchText":"single op amp operational amplifier opamp","designator":"U","defaultPins":5,"properties":{"semiconductorType":"OpAmp","pinNames":["V+","V-","input+","input-","output"]},"fields":[{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"packageType","label":"Package Type","type":"enum","enumValues":["SOT-23-5","SC70-5","Other"],"defaultValue":"SOT-23-5","required":false},{"name":"voltage","label":"Supply Voltage","type":"number","units":["V","mV"],"defaultUnit":"V","required":false},{"name":"description","label":"Description","type":"string","required":false},{"name":"datasheet","label":"Datasheet URL","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"Dual Op Amp","type":"Semiconductor","displayName":"Op Amp, Dual","description":"Dual operational amplifier","searchText":"dual op amp operational amplifier opamp","designator":"U","defaultPins":8,"properties":{"semiconductorType":"OpAmp","pinNames":["Output 1","Input 1-","Input 1+","VEE / GND","Input 2+","Input 2-","Output 2","VCC / V+"]},"fields":[{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"packageType","label":"Package Type","type":"enum","enumValues":["DIP-8","SOIC-8","DIP-14","SOIC-14","SOT-23-5","Other"],"defaultValue":"DIP-8","required":false},{"name":"voltage","label":"Supply Voltage","type":"number","units":["V","mV"],"defaultUnit":"V","required":false},{"name":"description","label":"Description","type":"string","required":false},{"name":"datasheet","label":"Datasheet URL","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"Quad Op Amp","type":"Semiconductor","displayName":"Op Amp, Quad","description":"Quad operational amplifier","searchText":"quad op amp operational amplifier opamp","designator":"U","defaultPins":14,"properties":{"semiconductorType":"OpAmp","pinNames":["1OUT","1IN-","1IN+","VCC+","2IN+","2IN-","2OUT","3OUT","3IN-","3IN+","VCC-","4IN+","4IN-","4OUT"]},"fields":[{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"packageType","label":"Package Type","type":"enum","enumValues":["DIP-14","SOIC-14","TSSOP-14","Other"],"defaultValue":"DIP-14","required":false},{"name":"voltage","label":"Supply Voltage","type":"number","units":["V","mV"],"defaultUnit":"V","required":false},{"name":"description","label":"Description","type":"string","required":false},{"name":"datasheet","label":"Datasheet URL","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"Integrated Circuit","type":"Semiconductor","displayName":"Integrated Circuit","description":"Integrated circuit","searchText":"integrated circuit semiconductor ic","designator":"U","defaultPins":8,"fixedPinCount":false,"properties":{"semiconductorType":"IntegratedCircuit","pinNames":["CHIP_DEPENDENT"]},"fields":[{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"icType","label":"IC Type","type":"string","required":false},{"name":"packageType","label":"Package Type","type":"enum","enumValues":["DIP","SOIC","QFP","LQFP","TQFP","BGA","SSOP","TSOP","Various","Other"],"required":false},{"name":"description","label":"Description","type":"string","required":false},{"name":"datasheet","label":"Datasheet URL","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Passive Components","subcategory":"Inductor","type":"Inductor","displayName":"Inductor","description":"Inductor","searchText":"inductor","designator":"L","defaultPins":2,"properties":{"passiveType":"Inductor"},"fields":[{"name":"inductance","label":"Inductance","type":"number","units":["nH","H","mH","H"],"defaultUnit":"H","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"resistance","label":"DC Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Passive Components","subcategory":"Ferrite Bead","type":"FerriteBead","displayName":"Ferrite Bead","description":"Ferrite bead","searchText":"ferrite bead passive","designator":"FB","defaultPins":2,"properties":{"passiveType":"FerriteBead"},"fields":[{"name":"impedance","label":"Impedance","type":"number","units":["","m","k"],"defaultUnit":"","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Passive Components","subcategory":"Crystal","type":"Crystal","displayName":"Crystal","description":"Crystal oscillator","searchText":"crystal oscillator passive","designator":"X","defaultPins":2,"properties":{"passiveType":"Crystal"},"fields":[{"name":"frequency","label":"Frequency","type":"string","required":false},{"name":"loadCapacitance","label":"Load Capacitance","type":"string","required":false},{"name":"tolerance","label":"Tolerance","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Power & Energy","subcategory":"Battery","type":"PowerEnergy","displayName":"Battery","description":"Battery or battery holder","searchText":"battery power energy","designator":"B","defaultPins":2,"properties":{"powerType":"Battery","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"capacity","label":"Capacity","type":"number","units":["mAh","Ah"],"defaultUnit":"mAh","required":false},{"name":"chemistry","label":"Chemistry","type":"enum","enumValues":["Li-ion","Alkaline","NiMH","NiCd","Lead-acid"],"required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Power & Energy","subcategory":"Power Supply","type":"PowerEnergy","displayName":"Power Supply","description":"Power supply","searchText":"power supply energy","designator":"PS","defaultPins":4,"properties":{"powerType":"PowerSupply"},"fields":[{"name":"inputVoltage","label":"Input Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"outputVoltage","label":"Output Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"efficiency","label":"Efficiency","type":"number","required":false},{"name":"ripple","label":"Ripple","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Power & Energy","subcategory":"Fuse","type":"PowerEnergy","displayName":"Fuse","description":"Fuse","searchText":"fuse power energy","designator":"F","defaultPins":2,"properties":{"powerType":"Fuse"},"fields":[{"name":"current","label":"Current Rating","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"fuseType","label":"Fuse Type","type":"enum","enumValues":["Fast-blow","Slow-blow","Time-delay"],"defaultValue":"Fast-blow","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Connectors & Switches","subcategory":"Connector","type":"Connector","displayName":"Connector","description":"Connector","searchText":"connector","designator":"J","defaultPins":4,"properties":{"connectorType":"Connector"},"fields":[{"name":"connectorType","label":"Connector Type","type":"string","required":false},{"name":"gender","label":"Gender","type":"enum","enumValues":["Male","Female","N/A"],"defaultValue":"N/A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Connectors & Switches","subcategory":"Jumper","type":"Jumper","displayName":"Jumper","description":"Jumper link","searchText":"jumper link","designator":"JP","defaultPins":3,"properties":{"connectorType":"Jumper"},"fields":[{"name":"positions","label":"Positions","type":"number","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Connectors & Switches","subcategory":"Switch","type":"Switch","displayName":"Switch","description":"Switch","searchText":"switch","designator":"S","defaultPins":2,"properties":{"switchType":"Switch"},"fields":[{"name":"switchType","label":"Switch Type","type":"string","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Connectors & Switches","subcategory":"Relay","type":"Relay","displayName":"Relay","description":"Relay or contactor","searchText":"relay contactor","designator":"K","defaultPins":5,"properties":{"switchType":"Relay"},"fields":[{"name":"coilVoltage","label":"Coil Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"contactType","label":"Contact Type","type":"string","required":false},{"name":"current","label":"Contact Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Other","subcategory":"Transformer","type":"Transformer","displayName":"Transformer","description":"Transformer","searchText":"transformer","designator":"TR","defaultPins":4,"fields":[{"name":"primaryVoltage","label":"Primary Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"secondaryVoltage","label":"Secondary Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"turns","label":"Turns Ratio","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Speaker","type":"Speaker","displayName":"Speaker","description":"Loudspeaker or buzzer","searchText":"speaker loudspeaker buzzer","designator":"LS","defaultPins":2,"fields":[{"name":"impedance","label":"Impedance","type":"number","units":["","m","k"],"defaultUnit":"","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Motor","type":"Motor","displayName":"Motor","description":"Motor","searchText":"motor","designator":"M","defaultPins":2,"fields":[{"name":"motorType","label":"Motor Type","type":"string","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Test Point","type":"TestPoint","displayName":"Test Point","description":"Test point","searchText":"test point","designator":"TP","defaultPins":1,"fields":[{"name":"signal","label":"Signal","type":"string","required":false}]},{"category":"Other","subcategory":"Vacuum Tube","type":"VacuumTube","displayName":"Vacuum Tube","description":"Vacuum tube","searchText":"vacuum tube","designator":"V","defaultPins":5,"fields":[{"name":"tubeType","label":"Tube Type","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Attenuator","type":"GenericComponent","displayName":"Attenuator","description":"Attenuator or isolator","searchText":"attenuator isolator component","designator":"AT","defaultPins":2,"subtype":"Attenuator","fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Circuit Breaker","type":"GenericComponent","displayName":"Circuit Breaker","description":"Circuit breaker","searchText":"circuit breaker component","designator":"CB","defaultPins":2,"subtype":"CircuitBreaker","fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Thermocouple","type":"GenericComponent","displayName":"Thermocouple","description":"Thermocouple","searchText":"thermocouple component","designator":"TC","defaultPins":2,"subtype":"Thermocouple","fields":[{"name":"model","label":"Model","type":"string","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Tuner","type":"GenericComponent","displayName":"Tuner","description":"Tuner","searchText":"tuner component","designator":"TUN","defaultPins":2,"subtype":"Tuner","fields":[{"name":"frequency","label":"Frequency","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]}]'),ph={components:i2},r2=["#FFFFFF","#BFBFBF","#7F7F7F","#3C3C3C","#000000","#A6CEE3","#56B4E9","#17BECF","#00BFC4","#1F77B4","#0072B2","#332288","#B2DF8A","#B3DE69","#2CA02C","#009E73","#FFED6F","#F0E442","#BCBD22","#E69F00","#FF7F0E","#FB9A99","#F781BF","#E15759","#D62728","#CAB2D6","#CC79A7","#AA4499","#6A3D9A","#9467BD","#9C755F","#8C564B"],eg="#2CA02C",a2="#F0E442",o2="#00BFC4",tg="#000000",s2="#00008b",ng="#FF0000",$g={DEFAULT_SIZE:18},Hf={};ph.components.forEach(i=>{const r=i.type,o=i.designator;if(!Hf[r])Hf[r]={prefix:[o],defaultPins:i.defaultPins};else{const s=Hf[r],c=[...new Set([...s.prefix,o])];Hf[r]={prefix:c,defaultPins:s.defaultPins}}});const Yg=Hf,$d={};ph.components.forEach(i=>{if($d[i.category]||($d[i.category]={}),!$d[i.category][i.subcategory])$d[i.category][i.subcategory]=[i.type];else{const r=$d[i.category][i.subcategory];r.includes(i.type)||($d[i.category][i.subcategory]=[...r,i.type])}});const ig={DEFAULT_SIZE:18},Vx={resistance:{validUnits:["","m","k","M"],defaultUnit:""},capacitance:{validUnits:["pF","nF","F","mF","F"],defaultUnit:"F"},voltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},current:{validUnits:["A","mA","A"],defaultUnit:"A"},power:{validUnits:["W","mW","kW"],defaultUnit:"W"},inductance:{validUnits:["nH","H","mH","H"],defaultUnit:"H"},impedance:{validUnits:["","m","k"],defaultUnit:""},capacity:{validUnits:["mAh","Ah"],defaultUnit:"mAh"},inputVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},outputVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},coilVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},primaryVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},secondaryVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},esr:{validUnits:["m",""],defaultUnit:""}};function nr(i){return Vx[i]?.validUnits||[]}function pn(i){return Vx[i]?.defaultUnit||""}function kl(i){return i.includes(" ")?i:i.replace(/([a-z])([A-Z])/g,"$1 $2")}const Eo=Math.PI*2;function Hx(i){return(i%360+360)%360}function pu(i){return i*Math.PI/180}function l2(i){return i*180/Math.PI}function _g(i,r){return Hx(i+r)}function lh(i){return Math.tan(i)}function c2(i){return Math.cos(i)}function u2(i){return Math.sin(i)}function d2(i,r){return Math.atan2(i,r)}function f2(i,r){return l2(d2(r,i))}function Rg(i,r){const{x:o,y:s,rotation:c=0,scale:d=1,flipX:v=!1,flipY:p=!1,skewX:g=0,skewY:m=0}=r;if(i.translate(o,s),c!==0&&i.rotate(pu(c)),g!==0||m!==0){const E=lh(g),T=lh(m);i.transform(1,T,E,1,0,0)}const S=d*(v?-1:1),_=d*(p?-1:1);(S!==1||_!==1)&&i.scale(S,_)}function h1(i,r,o,s=0,c=!1,d=!1){Rg(i,{x:r,y:o,rotation:s,flipX:c,flipY:d})}function Wx(i,r,o){const s=pu(o),c=c2(s),d=u2(s);return{x:i*c-r*d,y:i*d+r*c}}function p2(i,r=0,o=!1){o&&i.scale(-1,1),r!==0&&i.rotate(pu(r))}function h2(i,r=0,o=!1){const s=Hx(r),c=s===90||s===270;o&&i.scale(-1,1),r!==0&&i.rotate(pu(-r)),o&&c&&i.rotate(pu(180))}function g1(i,r,o,s=0,c=!1){let d=i/o,v=r/o;if(s!==0){const p=Wx(d,v,-s);d=p.x,v=p.y}return c&&(d=-d),{x:d,y:v}}function Of(i,r,o,s,c=0,d=!1){let v=i-o.x,p=r-o.y;if(v=v/s,p=p/s,d&&(v=-v),c!==0){const g=Wx(v,p,-c);v=g.x,p=g.y}return{x:v,y:p}}function g2(i,r=.4){if(i.startsWith("#")){const s=i.slice(1),c=parseInt(s.slice(0,2),16),d=parseInt(s.slice(2,4),16),v=parseInt(s.slice(4,6),16),p=Math.max(0,Math.floor(c*(1-r))),g=Math.max(0,Math.floor(d*(1-r))),m=Math.max(0,Math.floor(v*(1-r)));return`#${p.toString(16).padStart(2,"0")}${g.toString(16).padStart(2,"0")}${m.toString(16).padStart(2,"0")}`}const o=i.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*[\d.]+)?\)/);if(o){const s=parseInt(o[1],10),c=parseInt(o[2],10),d=parseInt(o[3],10),v=o[4]?o[4].trim():"",p=Math.max(0,Math.floor(s*(1-r))),g=Math.max(0,Math.floor(c*(1-r))),m=Math.max(0,Math.floor(d*(1-r)));return i.includes("rgba")?`rgba(${p}, ${g}, ${m}${v?`, ${v}`:", 1"})`:`rgb(${p}, ${g}, ${m})`}return i}let $s=1;const Hl=new Set;function hc(){const i=$s;if($s++,Hl.has(i)){for(console.error(`CRITICAL ERROR: Duplicate Node ID ${i} would be allocated!`),console.error(`Current counter: ${$s}, Allocated IDs count: ${Hl.size}`);Hl.has($s);)$s++;const r=$s;return $s++,Hl.add(r),console.error(`Recovered by allocating ID ${r} instead`),r}return Hl.add(i),i}function Vp(i){i<1&&(console.warn(`setPointIdCounter called with invalid value ${i}, using 1`),i=1),$s=i,Hl.clear()}function rg(){return $s}function x1(){$s=1,Hl.clear()}function ag(i){i>0&&(Hl.add(i),i>=$s&&($s=i+1))}function Hp(i){if(i>0&&Hl.has(i))if(Hl.delete(i),Hl.size>0){const r=Math.max(...Array.from(Hl));r<$s&&($s=Math.max(1,r+1))}else $s=1}function $x(i="id"){return`${i}-${Date.now()}-${Math.random().toString(36).slice(2,11)}`}function y1(i){return Math.round(i*1e4)/1e4}function or(i){return{x:y1(i.x),y:y1(i.y)}}const qu=ph.components;qu.map(i=>({designator:i.designator,componentType:i.description}));function Cl(i){if(!i)return;const r=i.componentDefinitionKey;if(r){const s=qu.find(c=>`${c.category}:${c.subcategory}:${c.type}`===r);if(s)return s}if(typeof i.designator=="string"&&i.designator.trim()!==""){const s=i.designator.trim().match(/^[A-Za-z]+/),c=s?s[0]:null;if(c){const d=qu.find(v=>Array.isArray(v.designators)&&v.designators.includes(c));if(d)return d}}const o=i.componentType==="Electrolytic Capacitor"||i.componentType==="Film Capacitor"?"Capacitor":i.componentType;return qu.find(s=>{if(s.type!==o)return!1;if(s.category==="Capacitors"){const c=i.capacitorType||i.dielectric;return!!(c&&s.properties?.capacitorType===c||!c)}if(s.category==="Diodes"){const c=i.diodeType;return!!(c&&s.properties?.diodeType===c||!s.properties?.diodeType)}if(s.category==="Resistors"){const c=i.resistorType,d=i.vrType;return!!(c&&s.properties?.resistorType===c||d&&s.properties?.vrType===d||!s.properties?.resistorType&&!s.properties?.vrType)}if(s.category==="Semiconductors"){const c=i.semiconductorType;return!!(c&&s.properties?.semiconductorType===c||!s.properties?.semiconductorType)}if(s.category==="Passive Components"){const c=i.passiveType;return!!(c&&s.properties?.passiveType===c||!s.properties?.passiveType)}if(s.category==="Power & Energy"){const c=i.powerType;return!!(c&&s.properties?.powerType===c||!s.properties?.powerType)}if(s.category==="Connectors & Switches"){const c=i.connectorType,d=i.switchType;return!!(c&&s.properties?.connectorType===c||d&&s.properties?.switchType===d||!s.properties?.connectorType&&!s.properties?.switchType)}if(i.componentType==="GenericComponent"){const c=i.genericType;return!!(c&&s.subtype===c)}return!0})}function og(i){return(Yg[i]?.prefix||["?"])[0]}function Xf(i){return Cl(i)?.properties?.polarized===!0}function Dg(i,r,o){if(!Xf(i)||i.pinCount!==2||!(r.length===2&&r[0]&&r[0].trim()!==""&&r[1]&&r[1].trim()!==""))return null;const c=S=>{const _=parseInt(S,10);if(isNaN(_))return null;for(const E of o)if((E.type==="via"||E.type==="pad")&&E.points.length>0){const T=E.points[0];if(T.id===_)return{x:T.x,y:T.y}}return null},d=c(r[0]),v=c(r[1]);if(!d||!v)return null;const p=Math.hypot(i.x-d.x,i.y-d.y),g=Math.hypot(i.x-v.x,i.y-v.y),m=["",""];return p<g?(m[0]="-",m[1]="+"):(m[0]="+",m[1]="-"),m}function Ff(){return{}}function x2(i){}function y2(i,r,o){let s=0;for(const d of r)if(d.designator){const v=d.designator.match(new RegExp(`^${i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(\\d+)$`));if(v){const p=parseInt(v[1],10);p>s&&(s=p)}}const c=o[i]||0;return Math.max(s,c)+1}function m1(i,r,o){const s={...o};return s[i]=Math.max(s[i]||0,r),s}function m2(i){if(i.designator&&i.designator.trim()!=="")return i.designator.trim();switch(i.baseType){case"Capacitor":return"C";case"Diode":return"D";case"Resistor":return"R";case"Semiconductor":return"Q";case"Passive":return"L";case"PowerEnergy":return"PS";case"Connector":return"J";case"Switch":return"S";case"Transformer":return"T";case"Other":default:return"?"}}function b2(i,r,o){let s=0;for(const v of r){if(!v.designator||!v.designator.startsWith(i))continue;const p=parseInt(v.designator.slice(i.length),10);!isNaN(p)&&p>s&&(s=p)}const d=(o[i]??s)+1;return o[i]=d,d}function v2(i,r,o){const s=m2(i),c=b2(s,r,o);return`${s}${c}`}function w2(i){const{definition:r,layer:o,x:s,y:c,color:d,size:v,designator:p,existingComponents:g=[],counters:m={}}=i,S=v&&v>0?v:$g.DEFAULT_SIZE,_=p||v2(r,g,m),E={id:$x("comp"),componentType:r.type,designator:_,layer:o,x:s,y:c,color:d,size:S,pinCount:r.defaultPins,pinConnections:new Array(r.defaultPins).fill(""),pinPolarities:void 0,notes:null,orientation:0,flipX:!1,flipY:!1,description:r.description};if(E.componentDefinitionKey=r.key,r.properties&&Object.assign(E,r.properties),r.properties?.pinNames&&Array.isArray(r.properties.pinNames)){const T=r.properties.pinNames;T.includes("CHIP_DEPENDENT")?E.pinNames=new Array(E.pinCount).fill(""):E.pinNames=new Array(E.pinCount).fill("").map((D,ee)=>ee<T.length?T[ee]:"")}return r.fields&&r.fields.length>0&&r.fields.forEach(T=>{T.defaultValue!==void 0&&T.defaultValue!==""&&(E[T.name]=T.defaultValue),T.units&&T.defaultUnit&&(E[`${T.name}Unit`]=T.defaultUnit)}),E}function S2(){const i=document.createElement("canvas"),r=24;i.width=r,i.height=r;const o=i.getContext("2d");o.strokeStyle="#000",o.lineWidth=3,o.lineCap="round";const s=r/2,c=8;return o.beginPath(),o.moveTo(s,s-c),o.lineTo(s,s-2),o.moveTo(s,s+2),o.lineTo(s,s+c),o.moveTo(s-c,s),o.lineTo(s-2,s),o.moveTo(s+2,s),o.lineTo(s+c,s),o.stroke(),`url(${i.toDataURL()}) ${s} ${s}, crosshair`}function j2(i){const r=document.createElement("canvas"),o=Math.max(12,Math.min(i,32)),c=o+4*2;r.width=c,r.height=c;const d=r.getContext("2d"),v=c/2,p=c/2,g=o/2;return d.fillStyle="#FFFF00",d.strokeStyle="#000000",d.lineWidth=2,d.beginPath(),d.moveTo(v,p-g),d.lineTo(v+g,p),d.lineTo(v,p+g),d.lineTo(v-g,p),d.closePath(),d.fill(),d.stroke(),`url(${r.toDataURL()}) ${v} ${p}, crosshair`}function b1(){const i=new Date,r=i.getFullYear(),o=String(i.getMonth()+1).padStart(2,"0"),s=String(i.getDate()).padStart(2,"0"),c=String(i.getHours()).padStart(2,"0"),d=String(i.getMinutes()).padStart(2,"0"),v=String(i.getSeconds()).padStart(2,"0");return`${r}_${o}_${s}-${c}-${d}-${v}`}function ad(i){let r=i.replace(/\.json$/i,""),o="";for(;o!==r;)o=r,r=r.replace(/_\d{4}_\d{2}_\d{2}-\d{2}-\d{2}-\d{2}$/,""),r=r.replace(/_\d{4}_\d{2}_\d{2}_\d{2}_\d{2}_\d{2}$/,"");return r}function xi(i,r,o,s){if(r==="power"){const d=i[r]||"";return typeof d=="string"&&d.trim()!==""?{value:d.replace(/W$/i,"").trim(),unit:"W"}:{value:"",unit:"W"}}if(i[r]!==void 0||i[o]!==void 0)return{value:i[r]||"",unit:i[o]||s};const c=i[r]||"";return typeof c=="string"&&c.trim()!==""?Yx(c):{value:"",unit:s}}function Yx(i){if(!i||i.trim()==="")return{value:"",unit:""};const r=i.trim(),o=r.match(/^([\d]+\/[\d]+)\s*([a-zA-ZuW]+)?$/);if(o)return{value:o[1],unit:o[2]||""};const s=r.match(/^([\d.]+)\s*([a-zA-ZuW]+)?$/);return s?{value:s[1],unit:s[2]||""}:{value:r,unit:""}}function od(i,r){return!i||i.trim()===""?"":!r||r.trim()===""?i.trim():`${i.trim()}${r.trim()}`}function T2(){const[i,r]=L.useState([]),[o,s]=L.useState([]),[c,d]=L.useState(null),[v,p]=L.useState(null),[g,m]=L.useState(null),[S,_]=L.useState(!1),[E,T]=L.useState(null),K=L.useCallback(($,H)=>{H==="top"?r(ae=>[...ae,$]):s(ae=>[...ae,$])},[]),D=L.useCallback(($,H,ae)=>{ae==="top"?r(I=>I.map(oe=>oe.id===$?{...oe,...H}:oe)):s(I=>I.map(oe=>oe.id===$?{...oe,...H}:oe))},[]),ee=L.useCallback(($,H)=>{H==="top"?r(ae=>ae.filter(I=>I.id!==$)):s(ae=>ae.filter(I=>I.id!==$))},[]),w=L.useCallback(($,H)=>{if(!$){console.error("[openComponentEditor] Component is null or undefined");return}if(!$.id||typeof $.id!="string"){console.error("[openComponentEditor] Component missing valid id property:",{component:$});return}const ae=$.id;if(!$.componentType||typeof $.componentType!="string"){console.error("[openComponentEditor] Component missing valid componentType property:",{componentId:ae,component:$});return}const I=$.componentType;if(typeof $.pinCount!="number"||$.pinCount<0){console.error("[openComponentEditor] Component missing valid pinCount property:",{componentId:ae,componentType:I,pinCount:$.pinCount,component:$});return}if(H!=="top"&&H!=="bottom"){console.error("[openComponentEditor] Invalid layer parameter:",{layer:H,componentId:$.id});return}const oe=$.designator||"",pe=$.abbreviation||(oe.length>0?oe.charAt(0).toUpperCase():""),Y=$.componentType,X={visible:!0,layer:H,id:$.id,designator:oe,abbreviation:pe,manufacturer:"manufacturer"in $&&$.manufacturer||"",partNumber:"partNumber"in $&&$.partNumber||"",pinCount:$.pinCount,x:$.x,y:$.y,orientation:$.orientation??0,description:$.description||"",datasheet:$.datasheet||"",componentDefinitionKey:$.componentDefinitionKey||""};if(Y==="Resistor"){const R=$,U=xi(R,"resistance","resistanceUnit",pn("resistance"));X.resistance=U.value,X.resistanceUnit=U.unit;const O=xi(R,"power","powerUnit","W");X.power=O.value||"1/4",X.tolerance=R.tolerance||"5%"}else if(Y==="Capacitor"){const R=$,U=xi(R,"capacitance","capacitanceUnit",pn("capacitance"));X.capacitance=U.value,X.capacitanceUnit=U.unit;const O=xi(R,"voltage","voltageUnit",pn("voltage"));X.voltage=O.value,X.voltageUnit=O.unit,X.tolerance=R.tolerance||"10%",X.dielectric=R.dielectric||"Ceramic"}else if(Y==="Electrolytic Capacitor"){const R=$,U=xi(R,"capacitance","capacitanceUnit",pn("capacitance"));X.capacitance=U.value,X.capacitanceUnit=U.unit;const O=xi(R,"voltage","voltageUnit",pn("voltage"));X.voltage=O.value,X.voltageUnit=O.unit,X.tolerance=R.tolerance||"20%",X.polarized=R.polarized!==void 0?R.polarized:!0;const _e=xi(R,"esr","esrUnit",pn("esr"));X.esr=_e.value,X.esrUnit=_e.unit,X.temperature=R.temperature||""}else if(Y==="Film Capacitor"){const R=$,U=xi(R,"capacitance","capacitanceUnit",pn("capacitance"));X.capacitance=U.value,X.capacitanceUnit=U.unit;const O=xi(R,"voltage","voltageUnit",pn("voltage"));X.voltage=O.value,X.voltageUnit=O.unit,X.tolerance=R.tolerance||"10%",X.filmType=R.filmType||"Polyester"}else if(Y==="Diode"){const R=$;X.diodeType=R.diodeType||"Standard";const U=xi(R,"voltage","voltageUnit",pn("voltage"));X.voltage=U.value,X.voltageUnit=U.unit;const O=xi(R,"current","currentUnit",pn("current"));X.current=O.value,X.currentUnit=O.unit,X.ledColor=R.ledColor||""}else if(Y==="Battery"){const R=$,U=xi(R,"voltage","voltageUnit",pn("voltage"));X.voltage=U.value,X.voltageUnit=U.unit;const O=xi(R,"capacity","capacityUnit",pn("capacity"));X.capacity=O.value,X.capacityUnit=O.unit,X.chemistry=R.chemistry||"Li-ion"}else if(Y==="Fuse"){const R=$,U=xi(R,"current","currentUnit",pn("current"));X.current=U.value,X.currentUnit=U.unit;const O=xi(R,"voltage","voltageUnit",pn("voltage"));X.voltage=O.value,X.voltageUnit=O.unit,X.fuseType=R.fuseType||"Fast-blow"}else if(Y==="FerriteBead"){const R=$,U=xi(R,"impedance","impedanceUnit",pn("impedance"));X.impedance=U.value,X.impedanceUnit=U.unit;const O=xi(R,"current","currentUnit",pn("current"));X.current=O.value,X.currentUnit=O.unit}else if(Y==="Connector"){const R=$;X.connectorType=R.connectorType||"",X.gender=R.gender||"N/A"}else if(Y==="Jumper"){const R=$;X.positions=R.positions||3}else if(Y==="Relay"){const R=$,U=xi(R,"coilVoltage","coilVoltageUnit",pn("coilVoltage"));X.coilVoltage=U.value,X.coilVoltageUnit=U.unit,X.contactType=R.contactType||"SPST";const O=xi(R,"current","currentUnit",pn("current"));X.current=O.value,X.currentUnit=O.unit}else if(Y==="Inductor"){const R=$,U=xi(R,"inductance","inductanceUnit",pn("inductance"));X.inductance=U.value,X.inductanceUnit=U.unit;const O=xi(R,"current","currentUnit",pn("current"));X.current=O.value,X.currentUnit=O.unit;const _e=xi(R,"resistance","resistanceUnit",pn("resistance"));X.resistance=_e.value,X.resistanceUnit=_e.unit}else if(Y==="Speaker"){const R=$,U=xi(R,"impedance","impedanceUnit",pn("impedance"));X.impedance=U.value,X.impedanceUnit=U.unit;const O=xi(R,"power","powerUnit","W");X.power=O.value||"1"}else if(Y==="Motor"){const R=$;X.motorType=R.motorType||"DC";const U=xi(R,"voltage","voltageUnit",pn("voltage"));X.voltage=U.value,X.voltageUnit=U.unit;const O=xi(R,"current","currentUnit",pn("current"));X.current=O.value,X.currentUnit=O.unit}else if(Y==="PowerSupply"){const R=$,U=xi(R,"inputVoltage","inputVoltageUnit",pn("inputVoltage"));X.inputVoltage=U.value,X.inputVoltageUnit=U.unit;const O=xi(R,"outputVoltage","outputVoltageUnit",pn("outputVoltage"));X.outputVoltage=O.value,X.outputVoltageUnit=O.unit;const _e=xi(R,"current","currentUnit",pn("current"));X.current=_e.value,X.currentUnit=_e.unit}else if(Y==="Transistor"){const R=$;X.transistorType=R.transistorType||"BJT",X.polarity=R.polarity||"NPN";const U=xi(R,"voltage","voltageUnit",pn("voltage"));X.voltage=U.value,X.voltageUnit=U.unit;const O=xi(R,"current","currentUnit",pn("current"));X.current=O.value,X.currentUnit=O.unit}else if(Y==="ResistorNetwork"){const R=$,U=xi(R,"resistance","resistanceUnit",pn("resistance"));X.resistance=U.value,X.resistanceUnit=U.unit,X.configuration=R.configuration||""}else if(Y==="Thermistor"){const R=$,U=xi(R,"resistance","resistanceUnit",pn("resistance"));X.resistance=U.value,X.resistanceUnit=U.unit,X.thermistorType=R.thermistorType||"NTC",X.beta=R.beta||""}else if(Y==="Switch"){const R=$;X.switchType=R.switchType||"Toggle";const U=xi(R,"current","currentUnit",pn("current"));X.current=U.value,X.currentUnit=U.unit;const O=xi(R,"voltage","voltageUnit",pn("voltage"));X.voltage=O.value,X.voltageUnit=O.unit}else if(Y==="Transformer"){const R=$,U=xi(R,"primaryVoltage","primaryVoltageUnit",pn("primaryVoltage"));X.primaryVoltage=U.value,X.primaryVoltageUnit=U.unit;const O=xi(R,"secondaryVoltage","secondaryVoltageUnit",pn("secondaryVoltage"));X.secondaryVoltage=O.value,X.secondaryVoltageUnit=O.unit;const _e=xi(R,"power","powerUnit",pn("power"));X.power=_e.value||"1",X.turns=R.turns||""}else if(Y==="TestPoint"){const R=$;X.signal=R.signal||""}else if(Y==="IntegratedCircuit"||Y==="Semiconductor"){const R=$;X.description=R.description||$.designator||"",X.datasheet=R.datasheet||"",X.datasheetFileName=R.datasheetFileName||void 0,X.manufacturer=R.manufacturer||"",X.partNumber=R.partNumber||"",X.operatingTemperature=R.operatingTemperature||"",X.packageType=R.packageType||"",console.log("[useComponents] Loading IC component - datasheet from component:",R.datasheet,"editor datasheet:",X.datasheet,"datasheetFileName:",R.datasheetFileName),X.icType=R.icType||"Op-Amp"}else if(Y==="VacuumTube"){const R=$;X.tubeType=R.tubeType||""}else if(Y==="VariableResistor"){const R=$;X.vrType=R.vrType||"Potentiometer";const U=xi(R,"resistance","resistanceUnit",pn("resistance"));X.resistance=U.value,X.resistanceUnit=U.unit;const O=xi(R,"power","powerUnit",pn("power"));X.power=O.value||"1/4",X.taper=R.taper||""}else if(Y==="Crystal"){const R=$;X.frequency=R.frequency||"",X.loadCapacitance=R.loadCapacitance||"",X.tolerance=R.tolerance||""}else if(Y==="Diode"){const R=$;X.diodeType=R.diodeType||"Standard";const U=xi(R,"voltage","voltageUnit",pn("voltage"));X.voltage=U.value,X.voltageUnit=U.unit;const O=xi(R,"current","currentUnit",pn("current"));X.current=O.value,X.currentUnit=O.unit,X.ledColor=R.ledColor||""}else if(Y==="GenericComponent"){const R=$;X.genericType=R.genericType||"Attenuator";const U=xi(R,"voltage","voltageUnit",pn("voltage"));X.voltage=U.value,X.voltageUnit=U.unit;const O=xi(R,"current","currentUnit",pn("current"));X.current=O.value,X.currentUnit=O.unit,X.power=R.power||"",X.frequency=R.frequency||"",X.model=R.model||""}const F=$.componentDefinitionKey;if(F){const R=qu.find(U=>`${U.category}:${U.subcategory}:${U.type}`===F);R&&(X.componentDefinition=R,X.componentDefinitionKey=F)}d(X)},[]),Se=L.useCallback(()=>{d(null),p(null)},[]);return{componentsTop:i,setComponentsTop:r,componentsBottom:o,setComponentsBottom:s,componentEditor:c,setComponentEditor:d,connectingPin:v,setConnectingPin:p,componentDialogPosition:g,setComponentDialogPosition:m,isDraggingDialog:S,setIsDraggingDialog:_,dialogDragOffset:E,setDialogDragOffset:T,addComponent:K,updateComponent:D,removeComponent:ee,openComponentEditor:w,closeComponentEditor:Se}}function sd(i){return{resistance:"",capacitance:"F",inductance:"H",voltage:"V",current:"A",power:"W",impedance:"",capacity:"mAh",esr:"",coilVoltage:"V",inputVoltage:"V",outputVoltage:"V"}[i]||""}function ld(i,r,o,s){if(r==="power"){const d=i[r]||"";return typeof d=="string"&&d.trim()!==""?{value:d.replace(/W$/i,"").trim(),unit:"W"}:{value:"",unit:"W"}}if(i[r]!==void 0||i[o]!==void 0)return{value:i[r]||"",unit:i[o]||s};const c=i[r]||"";return typeof c=="string"&&c.trim()!==""?Yx(c):{value:"",unit:s}}function C2(i){if((i.componentType==="Resistor"||i.componentType==="ResistorNetwork"||i.componentType==="Thermistor"||i.componentType==="VariableResistor")&&"resistance"in i){const{value:s,unit:c}=ld(i,"resistance","resistanceUnit",sd("resistance"));if(s&&s.trim()!=="")return od(s,c)}if((i.componentType==="Capacitor"||i.componentType==="Electrolytic Capacitor"||i.componentType==="Film Capacitor")&&"capacitance"in i){const{value:s,unit:c}=ld(i,"capacitance","capacitanceUnit",sd("capacitance"));if(s&&s.trim()!=="")return od(s,c)}if(i.componentType==="Inductor"&&"inductance"in i){const{value:s,unit:c}=ld(i,"inductance","inductanceUnit",sd("inductance"));if(s&&s.trim()!=="")return od(s,c)}if(i.componentType==="Fuse"&&"current"in i){const{value:s,unit:c}=ld(i,"current","currentUnit",sd("current"));if(s&&s.trim()!=="")return od(s,c)}if(i.componentType==="Battery"){const{value:s,unit:c}=ld(i,"capacity","capacityUnit",sd("capacity"));if(s&&s.trim()!=="")return od(s,c);const{value:d,unit:v}=ld(i,"voltage","voltageUnit",sd("voltage"));if(d&&d.trim()!=="")return od(d,v)}if(i.componentType==="PowerSupply"){const{value:s,unit:c}=ld(i,"outputVoltage","outputVoltageUnit",sd("voltage"));if(s&&s.trim()!=="")return od(s,c)}const r=i.partName?.trim();if(r&&r!=="")return r;const o=i.partNumber?.trim();return o&&o!==""?o:kl(i.componentType)}function k2(i,r,o){const s=[...i,...r],c=s.length,d=new Map;for(const p of s){const g=kl(p.componentType),m=C2(p),S=`${g}|${m}`;if(!d.has(S)){const E=i.some(D=>D.id===p.id),T=r.some(D=>D.id===p.id),K=E&&T?"both":E?"top":"bottom";d.set(S,{componentType:g,value:m,quantity:0,designators:[],packageType:p.packageType,manufacturer:p.manufacturer,partNumber:p.partNumber,description:p.description,notes:p.notes,datasheet:p.datasheet,layer:K})}const _=d.get(S);_.quantity++,p.designator&&p.designator.trim()!==""&&_.designators.push(p.designator.trim())}const v=Array.from(d.values()).sort((p,g)=>p.componentType!==g.componentType?p.componentType.localeCompare(g.componentType):p.value.localeCompare(g.value));return{version:"1.0",exportedAt:new Date().toISOString(),projectName:o,totalComponents:c,uniqueComponents:v.length,items:v}}const N2="modulepreload",A2=function(i){return"/PCB_Reverse_Engineering_Tool/"+i},v1={},sg=function(r,o,s){let c=Promise.resolve();if(o&&o.length>0){let g=function(m){return Promise.all(m.map(S=>Promise.resolve(S).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};document.getElementsByTagName("link");const v=document.querySelector("meta[property=csp-nonce]"),p=v?.nonce||v?.getAttribute("nonce");c=g(o.map(m=>{if(m=A2(m),m in v1)return;v1[m]=!0;const S=m.endsWith(".css"),_=S?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${_}`))return;const E=document.createElement("link");if(E.rel=S?"stylesheet":N2,S||(E.as="script"),E.crossOrigin="",E.href=m,p&&E.setAttribute("nonce",p),document.head.appendChild(E),S)return new Promise((T,K)=>{E.addEventListener("load",T),E.addEventListener("error",()=>K(new Error(`Unable to preload CSS for ${m}`)))})}))}function d(v){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=v,window.dispatchEvent(p),!p.defaultPrevented)throw v}return c.then(v=>{for(const p of v||[])p.status==="rejected"&&d(p.reason);return r().catch(d)})};function _r(i){"@babel/helpers - typeof";return _r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},_r(i)}var xc=Uint8Array,Nl=Uint16Array,Gg=Int32Array,Xg=new xc([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Kg=new xc([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),w1=new xc([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Gx=function(i,r){for(var o=new Nl(31),s=0;s<31;++s)o[s]=r+=1<<i[s-1];for(var c=new Gg(o[30]),s=1;s<30;++s)for(var d=o[s];d<o[s+1];++d)c[d]=d-o[s]<<5|s;return{b:o,r:c}},Xx=Gx(Xg,2),z2=Xx.b,Lg=Xx.r;z2[28]=258,Lg[258]=28;var P2=Gx(Kg,0),S1=P2.r,Mg=new Nl(32768);for(var ua=0;ua<32768;++ua){var Ou=(ua&43690)>>1|(ua&21845)<<1;Ou=(Ou&52428)>>2|(Ou&13107)<<2,Ou=(Ou&61680)>>4|(Ou&3855)<<4,Mg[ua]=((Ou&65280)>>8|(Ou&255)<<8)>>1}var Wf=(function(i,r,o){for(var s=i.length,c=0,d=new Nl(r);c<s;++c)i[c]&&++d[i[c]-1];var v=new Nl(r);for(c=1;c<r;++c)v[c]=v[c-1]+d[c-1]<<1;var p;if(o){p=new Nl(1<<r);var g=15-r;for(c=0;c<s;++c)if(i[c])for(var m=c<<4|i[c],S=r-i[c],_=v[i[c]-1]++<<S,E=_|(1<<S)-1;_<=E;++_)p[Mg[_]>>g]=m}else for(p=new Nl(s),c=0;c<s;++c)i[c]&&(p[c]=Mg[v[i[c]-1]++]>>15-i[c]);return p}),pd=new xc(288);for(var ua=0;ua<144;++ua)pd[ua]=8;for(var ua=144;ua<256;++ua)pd[ua]=9;for(var ua=256;ua<280;++ua)pd[ua]=7;for(var ua=280;ua<288;++ua)pd[ua]=8;var ch=new xc(32);for(var ua=0;ua<32;++ua)ch[ua]=5;var _2=Wf(pd,9,0),R2=Wf(ch,5,0),Kx=function(i){return(i+7)/8|0},D2=function(i,r,o){return(o==null||o>i.length)&&(o=i.length),new xc(i.subarray(r,o))},cu=function(i,r,o){o<<=r&7;var s=r/8|0;i[s]|=o,i[s+1]|=o>>8},Uf=function(i,r,o){o<<=r&7;var s=r/8|0;i[s]|=o,i[s+1]|=o>>8,i[s+2]|=o>>16},lg=function(i,r){for(var o=[],s=0;s<i.length;++s)i[s]&&o.push({s,f:i[s]});var c=o.length,d=o.slice();if(!c)return{t:Jx,l:0};if(c==1){var v=new xc(o[0].s+1);return v[o[0].s]=1,{t:v,l:1}}o.sort(function(ae,I){return ae.f-I.f}),o.push({s:-1,f:25001});var p=o[0],g=o[1],m=0,S=1,_=2;for(o[0]={s:-1,f:p.f+g.f,l:p,r:g};S!=c-1;)p=o[o[m].f<o[_].f?m++:_++],g=o[m!=S&&o[m].f<o[_].f?m++:_++],o[S++]={s:-1,f:p.f+g.f,l:p,r:g};for(var E=d[0].s,s=1;s<c;++s)d[s].s>E&&(E=d[s].s);var T=new Nl(E+1),K=Ig(o[S-1],T,0);if(K>r){var s=0,D=0,ee=K-r,w=1<<ee;for(d.sort(function(I,oe){return T[oe.s]-T[I.s]||I.f-oe.f});s<c;++s){var Se=d[s].s;if(T[Se]>r)D+=w-(1<<K-T[Se]),T[Se]=r;else break}for(D>>=ee;D>0;){var $=d[s].s;T[$]<r?D-=1<<r-T[$]++-1:++s}for(;s>=0&&D;--s){var H=d[s].s;T[H]==r&&(--T[H],++D)}K=r}return{t:new xc(T),l:K}},Ig=function(i,r,o){return i.s==-1?Math.max(Ig(i.l,r,o+1),Ig(i.r,r,o+1)):r[i.s]=o},j1=function(i){for(var r=i.length;r&&!i[--r];);for(var o=new Nl(++r),s=0,c=i[0],d=1,v=function(g){o[s++]=g},p=1;p<=r;++p)if(i[p]==c&&p!=r)++d;else{if(!c&&d>2){for(;d>138;d-=138)v(32754);d>2&&(v(d>10?d-11<<5|28690:d-3<<5|12305),d=0)}else if(d>3){for(v(c),--d;d>6;d-=6)v(8304);d>2&&(v(d-3<<5|8208),d=0)}for(;d--;)v(c);d=1,c=i[p]}return{c:o.subarray(0,s),n:r}},qf=function(i,r){for(var o=0,s=0;s<r.length;++s)o+=i[s]*r[s];return o},Zx=function(i,r,o){var s=o.length,c=Kx(r+2);i[c]=s&255,i[c+1]=s>>8,i[c+2]=i[c]^255,i[c+3]=i[c+1]^255;for(var d=0;d<s;++d)i[c+d+4]=o[d];return(c+4+s)*8},T1=function(i,r,o,s,c,d,v,p,g,m,S){cu(r,S++,o),++c[256];for(var _=lg(c,15),E=_.t,T=_.l,K=lg(d,15),D=K.t,ee=K.l,w=j1(E),Se=w.c,$=w.n,H=j1(D),ae=H.c,I=H.n,oe=new Nl(19),pe=0;pe<Se.length;++pe)++oe[Se[pe]&31];for(var pe=0;pe<ae.length;++pe)++oe[ae[pe]&31];for(var Y=lg(oe,7),X=Y.t,F=Y.l,R=19;R>4&&!X[w1[R-1]];--R);var U=m+5<<3,O=qf(c,pd)+qf(d,ch)+v,_e=qf(c,E)+qf(d,D)+v+14+3*R+qf(oe,X)+2*oe[16]+3*oe[17]+7*oe[18];if(g>=0&&U<=O&&U<=_e)return Zx(r,S,i.subarray(g,g+m));var ce,xe,fe,ke;if(cu(r,S,1+(_e<O)),S+=2,_e<O){ce=Wf(E,T,0),xe=E,fe=Wf(D,ee,0),ke=D;var de=Wf(X,F,0);cu(r,S,$-257),cu(r,S+5,I-1),cu(r,S+10,R-4),S+=14;for(var pe=0;pe<R;++pe)cu(r,S+3*pe,X[w1[pe]]);S+=3*R;for(var C=[Se,ae],z=0;z<2;++z)for(var G=C[z],pe=0;pe<G.length;++pe){var V=G[pe]&31;cu(r,S,de[V]),S+=X[V],V>15&&(cu(r,S,G[pe]>>5&127),S+=G[pe]>>12)}}else ce=_2,xe=pd,fe=R2,ke=ch;for(var pe=0;pe<p;++pe){var ie=s[pe];if(ie>255){var V=ie>>18&31;Uf(r,S,ce[V+257]),S+=xe[V+257],V>7&&(cu(r,S,ie>>23&31),S+=Xg[V]);var he=ie&31;Uf(r,S,fe[he]),S+=ke[he],he>3&&(Uf(r,S,ie>>5&8191),S+=Kg[he])}else Uf(r,S,ce[ie]),S+=xe[ie]}return Uf(r,S,ce[256]),S+xe[256]},L2=new Gg([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Jx=new xc(0),M2=function(i,r,o,s,c,d){var v=d.z||i.length,p=new xc(s+v+5*(1+Math.ceil(v/7e3))+c),g=p.subarray(s,p.length-c),m=d.l,S=(d.r||0)&7;if(r){S&&(g[0]=d.r>>3);for(var _=L2[r-1],E=_>>13,T=_&8191,K=(1<<o)-1,D=d.p||new Nl(32768),ee=d.h||new Nl(K+1),w=Math.ceil(o/3),Se=2*w,$=function(Ot){return(i[Ot]^i[Ot+1]<<w^i[Ot+2]<<Se)&K},H=new Gg(25e3),ae=new Nl(288),I=new Nl(32),oe=0,pe=0,Y=d.i||0,X=0,F=d.w||0,R=0;Y+2<v;++Y){var U=$(Y),O=Y&32767,_e=ee[U];if(D[O]=_e,ee[U]=O,F<=Y){var ce=v-Y;if((oe>7e3||X>24576)&&(ce>423||!m)){S=T1(i,g,0,H,ae,I,pe,X,R,Y-R,S),X=oe=pe=0,R=Y;for(var xe=0;xe<286;++xe)ae[xe]=0;for(var xe=0;xe<30;++xe)I[xe]=0}var fe=2,ke=0,de=T,C=O-_e&32767;if(ce>2&&U==$(Y-C))for(var z=Math.min(E,ce)-1,G=Math.min(32767,Y),V=Math.min(258,ce);C<=G&&--de&&O!=_e;){if(i[Y+fe]==i[Y+fe-C]){for(var ie=0;ie<V&&i[Y+ie]==i[Y+ie-C];++ie);if(ie>fe){if(fe=ie,ke=C,ie>z)break;for(var he=Math.min(C,ie-2),re=0,xe=0;xe<he;++xe){var Le=Y-C+xe&32767,Re=D[Le],Ue=Le-Re&32767;Ue>re&&(re=Ue,_e=Le)}}}O=_e,_e=D[O],C+=O-_e&32767}if(ke){H[X++]=268435456|Lg[fe]<<18|S1[ke];var et=Lg[fe]&31,ot=S1[ke]&31;pe+=Xg[et]+Kg[ot],++ae[257+et],++I[ot],F=Y+fe,++oe}else H[X++]=i[Y],++ae[i[Y]]}}for(Y=Math.max(Y,F);Y<v;++Y)H[X++]=i[Y],++ae[i[Y]];S=T1(i,g,m,H,ae,I,pe,X,R,Y-R,S),m||(d.r=S&7|g[S/8|0]<<3,S-=7,d.h=ee,d.p=D,d.i=Y,d.w=F)}else{for(var Y=d.w||0;Y<v+m;Y+=65535){var Ct=Y+65535;Ct>=v&&(g[S/8|0]=m,Ct=v),S=Zx(g,S+1,i.subarray(Y,Ct))}d.i=v}return D2(p,0,s+Kx(S)+c)},Qx=function(){var i=1,r=0;return{p:function(o){for(var s=i,c=r,d=o.length|0,v=0;v!=d;){for(var p=Math.min(v+2655,d);v<p;++v)c+=s+=o[v];s=(s&65535)+15*(s>>16),c=(c&65535)+15*(c>>16)}i=s,r=c},d:function(){return i%=65521,r%=65521,(i&255)<<24|(i&65280)<<8|(r&255)<<8|r>>8}}},I2=function(i,r,o,s,c){if(!c&&(c={l:1},r.dictionary)){var d=r.dictionary.subarray(-32768),v=new xc(d.length+i.length);v.set(d),v.set(i,d.length),i=v,c.w=d.length}return M2(i,r.level==null?6:r.level,r.mem==null?c.l?Math.ceil(Math.max(8,Math.min(13,Math.log(i.length)))*1.5):20:12+r.mem,o,s,c)},ey=function(i,r,o){for(;o;++r)i[r]=o,o>>>=8},B2=function(i,r){var o=r.level,s=o==0?0:o<6?1:o==9?3:2;if(i[0]=120,i[1]=s<<6|(r.dictionary&&32),i[1]|=31-(i[0]<<8|i[1])%31,r.dictionary){var c=Qx();c.p(r.dictionary),ey(i,2,c.d())}};function Bg(i,r){r||(r={});var o=Qx();o.p(i);var s=I2(i,r,r.dictionary?6:2,4);return B2(s,r),ey(s,s.length-4,o.d()),s}var E2=typeof TextDecoder<"u"&&new TextDecoder,O2=0;try{E2.decode(Jx,{stream:!0}),O2=1}catch{}function F2(i){if(Array.isArray(i))return i}function U2(i,r){var o=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(o!=null){var s,c,d,v,p=[],g=!0,m=!1;try{if(d=(o=o.call(i)).next,r!==0)for(;!(g=(s=d.call(o)).done)&&(p.push(s.value),p.length!==r);g=!0);}catch(S){m=!0,c=S}finally{try{if(!g&&o.return!=null&&(v=o.return(),Object(v)!==v))return}finally{if(m)throw c}}return p}}function C1(i,r){(r==null||r>i.length)&&(r=i.length);for(var o=0,s=Array(r);o<r;o++)s[o]=i[o];return s}function q2(i,r){if(i){if(typeof i=="string")return C1(i,r);var o={}.toString.call(i).slice(8,-1);return o==="Object"&&i.constructor&&(o=i.constructor.name),o==="Map"||o==="Set"?Array.from(i):o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?C1(i,r):void 0}}function V2(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k1(i,r){return F2(i)||U2(i,r)||q2(i,r)||V2()}function N1(i,r="utf8"){return new TextDecoder(r).decode(i)}const H2=new TextEncoder;function W2(i){return H2.encode(i)}const $2=1024*8,Y2=(()=>{const i=new Uint8Array(4),r=new Uint32Array(i.buffer);return!((r[0]=1)&i[0])})(),cg={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class Zg{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(r=$2,o={}){let s=!1;typeof r=="number"?r=new ArrayBuffer(r):(s=!0,this.lastWrittenByte=r.byteLength);const c=o.offset?o.offset>>>0:0,d=r.byteLength-c;let v=c;(ArrayBuffer.isView(r)||r instanceof Zg)&&(r.byteLength!==r.buffer.byteLength&&(v=r.byteOffset+c),r=r.buffer),s?this.lastWrittenByte=d:this.lastWrittenByte=0,this.buffer=r,this.length=d,this.byteLength=d,this.byteOffset=v,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,v,d),this._mark=0,this._marks=[]}available(r=1){return this.offset+r<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(r=1){return this.offset+=r,this}back(r=1){return this.offset-=r,this}seek(r){return this.offset=r,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const r=this._marks.pop();if(r===void 0)throw new Error("Mark stack empty");return this.seek(r),this}rewind(){return this.offset=0,this}ensureAvailable(r=1){if(!this.available(r)){const s=(this.offset+r)*2,c=new Uint8Array(s);c.set(new Uint8Array(this.buffer)),this.buffer=c.buffer,this.length=s,this.byteLength=s,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(r=1){return this.readArray(r,"uint8")}readArray(r,o){const s=cg[o].BYTES_PER_ELEMENT*r,c=this.byteOffset+this.offset,d=this.buffer.slice(c,c+s);if(this.littleEndian===Y2&&o!=="uint8"&&o!=="int8"){const p=new Uint8Array(this.buffer.slice(c,c+s));p.reverse();const g=new cg[o](p.buffer);return this.offset+=s,g.reverse(),g}const v=new cg[o](d);return this.offset+=s,v}readInt16(){const r=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,r}readUint16(){const r=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,r}readInt32(){const r=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,r}readUint32(){const r=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,r}readFloat32(){const r=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,r}readFloat64(){const r=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,r}readBigInt64(){const r=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,r}readBigUint64(){const r=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,r}readChar(){return String.fromCharCode(this.readInt8())}readChars(r=1){let o="";for(let s=0;s<r;s++)o+=this.readChar();return o}readUtf8(r=1){return N1(this.readBytes(r))}decodeText(r=1,o="utf8"){return N1(this.readBytes(r),o)}writeBoolean(r){return this.writeUint8(r?255:0),this}writeInt8(r){return this.ensureAvailable(1),this._data.setInt8(this.offset++,r),this._updateLastWrittenByte(),this}writeUint8(r){return this.ensureAvailable(1),this._data.setUint8(this.offset++,r),this._updateLastWrittenByte(),this}writeByte(r){return this.writeUint8(r)}writeBytes(r){this.ensureAvailable(r.length);for(let o=0;o<r.length;o++)this._data.setUint8(this.offset++,r[o]);return this._updateLastWrittenByte(),this}writeInt16(r){return this.ensureAvailable(2),this._data.setInt16(this.offset,r,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(r){return this.ensureAvailable(2),this._data.setUint16(this.offset,r,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(r){return this.ensureAvailable(4),this._data.setInt32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(r){return this.ensureAvailable(4),this._data.setUint32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(r){return this.ensureAvailable(4),this._data.setFloat32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(r){return this.ensureAvailable(8),this._data.setFloat64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(r){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(r){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(r){return this.writeUint8(r.charCodeAt(0))}writeChars(r){for(let o=0;o<r.length;o++)this.writeUint8(r.charCodeAt(o));return this}writeUtf8(r){return this.writeBytes(W2(r))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function lf(i){let r=i.length;for(;--r>=0;)i[r]=0}const G2=3,X2=258,ty=29,K2=256,Z2=K2+1+ty,ny=30,J2=512,Q2=new Array((Z2+2)*2);lf(Q2);const eb=new Array(ny*2);lf(eb);const tb=new Array(J2);lf(tb);const nb=new Array(X2-G2+1);lf(nb);const ib=new Array(ty);lf(ib);const rb=new Array(ny);lf(rb);const ab=(i,r,o,s)=>{let c=i&65535|0,d=i>>>16&65535|0,v=0;for(;o!==0;){v=o>2e3?2e3:o,o-=v;do c=c+r[s++]|0,d=d+c|0;while(--v);c%=65521,d%=65521}return c|d<<16|0};var Eg=ab;const ob=()=>{let i,r=[];for(var o=0;o<256;o++){i=o;for(var s=0;s<8;s++)i=i&1?3988292384^i>>>1:i>>>1;r[o]=i}return r},sb=new Uint32Array(ob()),lb=(i,r,o,s)=>{const c=sb,d=s+o;i^=-1;for(let v=s;v<d;v++)i=i>>>8^c[(i^r[v])&255];return i^-1};var Lc=lb,Og={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},iy={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const cb=(i,r)=>Object.prototype.hasOwnProperty.call(i,r);var ub=function(i){const r=Array.prototype.slice.call(arguments,1);for(;r.length;){const o=r.shift();if(o){if(typeof o!="object")throw new TypeError(o+"must be non-object");for(const s in o)cb(o,s)&&(i[s]=o[s])}}return i},db=i=>{let r=0;for(let s=0,c=i.length;s<c;s++)r+=i[s].length;const o=new Uint8Array(r);for(let s=0,c=0,d=i.length;s<d;s++){let v=i[s];o.set(v,c),c+=v.length}return o},ry={assign:ub,flattenChunks:db};let ay=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{ay=!1}const Yf=new Uint8Array(256);for(let i=0;i<256;i++)Yf[i]=i>=252?6:i>=248?5:i>=240?4:i>=224?3:i>=192?2:1;Yf[254]=Yf[254]=1;var fb=i=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(i);let r,o,s,c,d,v=i.length,p=0;for(c=0;c<v;c++)o=i.charCodeAt(c),(o&64512)===55296&&c+1<v&&(s=i.charCodeAt(c+1),(s&64512)===56320&&(o=65536+(o-55296<<10)+(s-56320),c++)),p+=o<128?1:o<2048?2:o<65536?3:4;for(r=new Uint8Array(p),d=0,c=0;d<p;c++)o=i.charCodeAt(c),(o&64512)===55296&&c+1<v&&(s=i.charCodeAt(c+1),(s&64512)===56320&&(o=65536+(o-55296<<10)+(s-56320),c++)),o<128?r[d++]=o:o<2048?(r[d++]=192|o>>>6,r[d++]=128|o&63):o<65536?(r[d++]=224|o>>>12,r[d++]=128|o>>>6&63,r[d++]=128|o&63):(r[d++]=240|o>>>18,r[d++]=128|o>>>12&63,r[d++]=128|o>>>6&63,r[d++]=128|o&63);return r};const pb=(i,r)=>{if(r<65534&&i.subarray&&ay)return String.fromCharCode.apply(null,i.length===r?i:i.subarray(0,r));let o="";for(let s=0;s<r;s++)o+=String.fromCharCode(i[s]);return o};var hb=(i,r)=>{const o=r||i.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(i.subarray(0,r));let s,c;const d=new Array(o*2);for(c=0,s=0;s<o;){let v=i[s++];if(v<128){d[c++]=v;continue}let p=Yf[v];if(p>4){d[c++]=65533,s+=p-1;continue}for(v&=p===2?31:p===3?15:7;p>1&&s<o;)v=v<<6|i[s++]&63,p--;if(p>1){d[c++]=65533;continue}v<65536?d[c++]=v:(v-=65536,d[c++]=55296|v>>10&1023,d[c++]=56320|v&1023)}return pb(d,c)},gb=(i,r)=>{r=r||i.length,r>i.length&&(r=i.length);let o=r-1;for(;o>=0&&(i[o]&192)===128;)o--;return o<0||o===0?r:o+Yf[i[o]]>r?o:r},Fg={string2buf:fb,buf2string:hb,utf8border:gb};function xb(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var yb=xb;const Wp=16209,mb=16191;var bb=function(r,o){let s,c,d,v,p,g,m,S,_,E,T,K,D,ee,w,Se,$,H,ae,I,oe,pe,Y,X;const F=r.state;s=r.next_in,Y=r.input,c=s+(r.avail_in-5),d=r.next_out,X=r.output,v=d-(o-r.avail_out),p=d+(r.avail_out-257),g=F.dmax,m=F.wsize,S=F.whave,_=F.wnext,E=F.window,T=F.hold,K=F.bits,D=F.lencode,ee=F.distcode,w=(1<<F.lenbits)-1,Se=(1<<F.distbits)-1;e:do{K<15&&(T+=Y[s++]<<K,K+=8,T+=Y[s++]<<K,K+=8),$=D[T&w];t:for(;;){if(H=$>>>24,T>>>=H,K-=H,H=$>>>16&255,H===0)X[d++]=$&65535;else if(H&16){ae=$&65535,H&=15,H&&(K<H&&(T+=Y[s++]<<K,K+=8),ae+=T&(1<<H)-1,T>>>=H,K-=H),K<15&&(T+=Y[s++]<<K,K+=8,T+=Y[s++]<<K,K+=8),$=ee[T&Se];n:for(;;){if(H=$>>>24,T>>>=H,K-=H,H=$>>>16&255,H&16){if(I=$&65535,H&=15,K<H&&(T+=Y[s++]<<K,K+=8,K<H&&(T+=Y[s++]<<K,K+=8)),I+=T&(1<<H)-1,I>g){r.msg="invalid distance too far back",F.mode=Wp;break e}if(T>>>=H,K-=H,H=d-v,I>H){if(H=I-H,H>S&&F.sane){r.msg="invalid distance too far back",F.mode=Wp;break e}if(oe=0,pe=E,_===0){if(oe+=m-H,H<ae){ae-=H;do X[d++]=E[oe++];while(--H);oe=d-I,pe=X}}else if(_<H){if(oe+=m+_-H,H-=_,H<ae){ae-=H;do X[d++]=E[oe++];while(--H);if(oe=0,_<ae){H=_,ae-=H;do X[d++]=E[oe++];while(--H);oe=d-I,pe=X}}}else if(oe+=_-H,H<ae){ae-=H;do X[d++]=E[oe++];while(--H);oe=d-I,pe=X}for(;ae>2;)X[d++]=pe[oe++],X[d++]=pe[oe++],X[d++]=pe[oe++],ae-=3;ae&&(X[d++]=pe[oe++],ae>1&&(X[d++]=pe[oe++]))}else{oe=d-I;do X[d++]=X[oe++],X[d++]=X[oe++],X[d++]=X[oe++],ae-=3;while(ae>2);ae&&(X[d++]=X[oe++],ae>1&&(X[d++]=X[oe++]))}}else if((H&64)===0){$=ee[($&65535)+(T&(1<<H)-1)];continue n}else{r.msg="invalid distance code",F.mode=Wp;break e}break}}else if((H&64)===0){$=D[($&65535)+(T&(1<<H)-1)];continue t}else if(H&32){F.mode=mb;break e}else{r.msg="invalid literal/length code",F.mode=Wp;break e}break}}while(s<c&&d<p);ae=K>>3,s-=ae,K-=ae<<3,T&=(1<<K)-1,r.next_in=s,r.next_out=d,r.avail_in=s<c?5+(c-s):5-(s-c),r.avail_out=d<p?257+(p-d):257-(d-p),F.hold=T,F.bits=K};const Yd=15,A1=852,z1=592,P1=0,ug=1,_1=2,vb=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),wb=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Sb=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),jb=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Tb=(i,r,o,s,c,d,v,p)=>{const g=p.bits;let m=0,S=0,_=0,E=0,T=0,K=0,D=0,ee=0,w=0,Se=0,$,H,ae,I,oe,pe=null,Y;const X=new Uint16Array(Yd+1),F=new Uint16Array(Yd+1);let R=null,U,O,_e;for(m=0;m<=Yd;m++)X[m]=0;for(S=0;S<s;S++)X[r[o+S]]++;for(T=g,E=Yd;E>=1&&X[E]===0;E--);if(T>E&&(T=E),E===0)return c[d++]=1<<24|64<<16|0,c[d++]=1<<24|64<<16|0,p.bits=1,0;for(_=1;_<E&&X[_]===0;_++);for(T<_&&(T=_),ee=1,m=1;m<=Yd;m++)if(ee<<=1,ee-=X[m],ee<0)return-1;if(ee>0&&(i===P1||E!==1))return-1;for(F[1]=0,m=1;m<Yd;m++)F[m+1]=F[m]+X[m];for(S=0;S<s;S++)r[o+S]!==0&&(v[F[r[o+S]]++]=S);if(i===P1?(pe=R=v,Y=20):i===ug?(pe=vb,R=wb,Y=257):(pe=Sb,R=jb,Y=0),Se=0,S=0,m=_,oe=d,K=T,D=0,ae=-1,w=1<<T,I=w-1,i===ug&&w>A1||i===_1&&w>z1)return 1;for(;;){U=m-D,v[S]+1<Y?(O=0,_e=v[S]):v[S]>=Y?(O=R[v[S]-Y],_e=pe[v[S]-Y]):(O=96,_e=0),$=1<<m-D,H=1<<K,_=H;do H-=$,c[oe+(Se>>D)+H]=U<<24|O<<16|_e|0;while(H!==0);for($=1<<m-1;Se&$;)$>>=1;if($!==0?(Se&=$-1,Se+=$):Se=0,S++,--X[m]===0){if(m===E)break;m=r[o+v[S]]}if(m>T&&(Se&I)!==ae){for(D===0&&(D=T),oe+=_,K=m-D,ee=1<<K;K+D<E&&(ee-=X[K+D],!(ee<=0));)K++,ee<<=1;if(w+=1<<K,i===ug&&w>A1||i===_1&&w>z1)return 1;ae=Se&I,c[ae]=T<<24|K<<16|oe-d|0}}return Se!==0&&(c[oe+Se]=m-D<<24|64<<16|0),p.bits=T,0};var $f=Tb;const Cb=0,oy=1,sy=2,{Z_FINISH:R1,Z_BLOCK:kb,Z_TREES:$p,Z_OK:hd,Z_STREAM_END:Nb,Z_NEED_DICT:Ab,Z_STREAM_ERROR:Wl,Z_DATA_ERROR:ly,Z_MEM_ERROR:cy,Z_BUF_ERROR:zb,Z_DEFLATED:D1}=iy,hh=16180,L1=16181,M1=16182,I1=16183,B1=16184,E1=16185,O1=16186,F1=16187,U1=16188,q1=16189,uh=16190,uu=16191,dg=16192,V1=16193,fg=16194,H1=16195,W1=16196,$1=16197,Y1=16198,Yp=16199,Gp=16200,G1=16201,X1=16202,K1=16203,Z1=16204,J1=16205,pg=16206,Q1=16207,ex=16208,ga=16209,uy=16210,dy=16211,Pb=852,_b=592,Rb=15,Db=Rb,tx=i=>(i>>>24&255)+(i>>>8&65280)+((i&65280)<<8)+((i&255)<<24);function Lb(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const gd=i=>{if(!i)return 1;const r=i.state;return!r||r.strm!==i||r.mode<hh||r.mode>dy?1:0},fy=i=>{if(gd(i))return Wl;const r=i.state;return i.total_in=i.total_out=r.total=0,i.msg="",r.wrap&&(i.adler=r.wrap&1),r.mode=hh,r.last=0,r.havedict=0,r.flags=-1,r.dmax=32768,r.head=null,r.hold=0,r.bits=0,r.lencode=r.lendyn=new Int32Array(Pb),r.distcode=r.distdyn=new Int32Array(_b),r.sane=1,r.back=-1,hd},py=i=>{if(gd(i))return Wl;const r=i.state;return r.wsize=0,r.whave=0,r.wnext=0,fy(i)},hy=(i,r)=>{let o;if(gd(i))return Wl;const s=i.state;return r<0?(o=0,r=-r):(o=(r>>4)+5,r<48&&(r&=15)),r&&(r<8||r>15)?Wl:(s.window!==null&&s.wbits!==r&&(s.window=null),s.wrap=o,s.wbits=r,py(i))},gy=(i,r)=>{if(!i)return Wl;const o=new Lb;i.state=o,o.strm=i,o.window=null,o.mode=hh;const s=hy(i,r);return s!==hd&&(i.state=null),s},Mb=i=>gy(i,Db);let nx=!0,hg,gg;const Ib=i=>{if(nx){hg=new Int32Array(512),gg=new Int32Array(32);let r=0;for(;r<144;)i.lens[r++]=8;for(;r<256;)i.lens[r++]=9;for(;r<280;)i.lens[r++]=7;for(;r<288;)i.lens[r++]=8;for($f(oy,i.lens,0,288,hg,0,i.work,{bits:9}),r=0;r<32;)i.lens[r++]=5;$f(sy,i.lens,0,32,gg,0,i.work,{bits:5}),nx=!1}i.lencode=hg,i.lenbits=9,i.distcode=gg,i.distbits=5},xy=(i,r,o,s)=>{let c;const d=i.state;return d.window===null&&(d.wsize=1<<d.wbits,d.wnext=0,d.whave=0,d.window=new Uint8Array(d.wsize)),s>=d.wsize?(d.window.set(r.subarray(o-d.wsize,o),0),d.wnext=0,d.whave=d.wsize):(c=d.wsize-d.wnext,c>s&&(c=s),d.window.set(r.subarray(o-s,o-s+c),d.wnext),s-=c,s?(d.window.set(r.subarray(o-s,o),0),d.wnext=s,d.whave=d.wsize):(d.wnext+=c,d.wnext===d.wsize&&(d.wnext=0),d.whave<d.wsize&&(d.whave+=c))),0},Bb=(i,r)=>{let o,s,c,d,v,p,g,m,S,_,E,T,K,D,ee=0,w,Se,$,H,ae,I,oe,pe;const Y=new Uint8Array(4);let X,F;const R=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(gd(i)||!i.output||!i.input&&i.avail_in!==0)return Wl;o=i.state,o.mode===uu&&(o.mode=dg),v=i.next_out,c=i.output,g=i.avail_out,d=i.next_in,s=i.input,p=i.avail_in,m=o.hold,S=o.bits,_=p,E=g,pe=hd;e:for(;;)switch(o.mode){case hh:if(o.wrap===0){o.mode=dg;break}for(;S<16;){if(p===0)break e;p--,m+=s[d++]<<S,S+=8}if(o.wrap&2&&m===35615){o.wbits===0&&(o.wbits=15),o.check=0,Y[0]=m&255,Y[1]=m>>>8&255,o.check=Lc(o.check,Y,2,0),m=0,S=0,o.mode=L1;break}if(o.head&&(o.head.done=!1),!(o.wrap&1)||(((m&255)<<8)+(m>>8))%31){i.msg="incorrect header check",o.mode=ga;break}if((m&15)!==D1){i.msg="unknown compression method",o.mode=ga;break}if(m>>>=4,S-=4,oe=(m&15)+8,o.wbits===0&&(o.wbits=oe),oe>15||oe>o.wbits){i.msg="invalid window size",o.mode=ga;break}o.dmax=1<<o.wbits,o.flags=0,i.adler=o.check=1,o.mode=m&512?q1:uu,m=0,S=0;break;case L1:for(;S<16;){if(p===0)break e;p--,m+=s[d++]<<S,S+=8}if(o.flags=m,(o.flags&255)!==D1){i.msg="unknown compression method",o.mode=ga;break}if(o.flags&57344){i.msg="unknown header flags set",o.mode=ga;break}o.head&&(o.head.text=m>>8&1),o.flags&512&&o.wrap&4&&(Y[0]=m&255,Y[1]=m>>>8&255,o.check=Lc(o.check,Y,2,0)),m=0,S=0,o.mode=M1;case M1:for(;S<32;){if(p===0)break e;p--,m+=s[d++]<<S,S+=8}o.head&&(o.head.time=m),o.flags&512&&o.wrap&4&&(Y[0]=m&255,Y[1]=m>>>8&255,Y[2]=m>>>16&255,Y[3]=m>>>24&255,o.check=Lc(o.check,Y,4,0)),m=0,S=0,o.mode=I1;case I1:for(;S<16;){if(p===0)break e;p--,m+=s[d++]<<S,S+=8}o.head&&(o.head.xflags=m&255,o.head.os=m>>8),o.flags&512&&o.wrap&4&&(Y[0]=m&255,Y[1]=m>>>8&255,o.check=Lc(o.check,Y,2,0)),m=0,S=0,o.mode=B1;case B1:if(o.flags&1024){for(;S<16;){if(p===0)break e;p--,m+=s[d++]<<S,S+=8}o.length=m,o.head&&(o.head.extra_len=m),o.flags&512&&o.wrap&4&&(Y[0]=m&255,Y[1]=m>>>8&255,o.check=Lc(o.check,Y,2,0)),m=0,S=0}else o.head&&(o.head.extra=null);o.mode=E1;case E1:if(o.flags&1024&&(T=o.length,T>p&&(T=p),T&&(o.head&&(oe=o.head.extra_len-o.length,o.head.extra||(o.head.extra=new Uint8Array(o.head.extra_len)),o.head.extra.set(s.subarray(d,d+T),oe)),o.flags&512&&o.wrap&4&&(o.check=Lc(o.check,s,T,d)),p-=T,d+=T,o.length-=T),o.length))break e;o.length=0,o.mode=O1;case O1:if(o.flags&2048){if(p===0)break e;T=0;do oe=s[d+T++],o.head&&oe&&o.length<65536&&(o.head.name+=String.fromCharCode(oe));while(oe&&T<p);if(o.flags&512&&o.wrap&4&&(o.check=Lc(o.check,s,T,d)),p-=T,d+=T,oe)break e}else o.head&&(o.head.name=null);o.length=0,o.mode=F1;case F1:if(o.flags&4096){if(p===0)break e;T=0;do oe=s[d+T++],o.head&&oe&&o.length<65536&&(o.head.comment+=String.fromCharCode(oe));while(oe&&T<p);if(o.flags&512&&o.wrap&4&&(o.check=Lc(o.check,s,T,d)),p-=T,d+=T,oe)break e}else o.head&&(o.head.comment=null);o.mode=U1;case U1:if(o.flags&512){for(;S<16;){if(p===0)break e;p--,m+=s[d++]<<S,S+=8}if(o.wrap&4&&m!==(o.check&65535)){i.msg="header crc mismatch",o.mode=ga;break}m=0,S=0}o.head&&(o.head.hcrc=o.flags>>9&1,o.head.done=!0),i.adler=o.check=0,o.mode=uu;break;case q1:for(;S<32;){if(p===0)break e;p--,m+=s[d++]<<S,S+=8}i.adler=o.check=tx(m),m=0,S=0,o.mode=uh;case uh:if(o.havedict===0)return i.next_out=v,i.avail_out=g,i.next_in=d,i.avail_in=p,o.hold=m,o.bits=S,Ab;i.adler=o.check=1,o.mode=uu;case uu:if(r===kb||r===$p)break e;case dg:if(o.last){m>>>=S&7,S-=S&7,o.mode=pg;break}for(;S<3;){if(p===0)break e;p--,m+=s[d++]<<S,S+=8}switch(o.last=m&1,m>>>=1,S-=1,m&3){case 0:o.mode=V1;break;case 1:if(Ib(o),o.mode=Yp,r===$p){m>>>=2,S-=2;break e}break;case 2:o.mode=W1;break;case 3:i.msg="invalid block type",o.mode=ga}m>>>=2,S-=2;break;case V1:for(m>>>=S&7,S-=S&7;S<32;){if(p===0)break e;p--,m+=s[d++]<<S,S+=8}if((m&65535)!==(m>>>16^65535)){i.msg="invalid stored block lengths",o.mode=ga;break}if(o.length=m&65535,m=0,S=0,o.mode=fg,r===$p)break e;case fg:o.mode=H1;case H1:if(T=o.length,T){if(T>p&&(T=p),T>g&&(T=g),T===0)break e;c.set(s.subarray(d,d+T),v),p-=T,d+=T,g-=T,v+=T,o.length-=T;break}o.mode=uu;break;case W1:for(;S<14;){if(p===0)break e;p--,m+=s[d++]<<S,S+=8}if(o.nlen=(m&31)+257,m>>>=5,S-=5,o.ndist=(m&31)+1,m>>>=5,S-=5,o.ncode=(m&15)+4,m>>>=4,S-=4,o.nlen>286||o.ndist>30){i.msg="too many length or distance symbols",o.mode=ga;break}o.have=0,o.mode=$1;case $1:for(;o.have<o.ncode;){for(;S<3;){if(p===0)break e;p--,m+=s[d++]<<S,S+=8}o.lens[R[o.have++]]=m&7,m>>>=3,S-=3}for(;o.have<19;)o.lens[R[o.have++]]=0;if(o.lencode=o.lendyn,o.lenbits=7,X={bits:o.lenbits},pe=$f(Cb,o.lens,0,19,o.lencode,0,o.work,X),o.lenbits=X.bits,pe){i.msg="invalid code lengths set",o.mode=ga;break}o.have=0,o.mode=Y1;case Y1:for(;o.have<o.nlen+o.ndist;){for(;ee=o.lencode[m&(1<<o.lenbits)-1],w=ee>>>24,Se=ee>>>16&255,$=ee&65535,!(w<=S);){if(p===0)break e;p--,m+=s[d++]<<S,S+=8}if($<16)m>>>=w,S-=w,o.lens[o.have++]=$;else{if($===16){for(F=w+2;S<F;){if(p===0)break e;p--,m+=s[d++]<<S,S+=8}if(m>>>=w,S-=w,o.have===0){i.msg="invalid bit length repeat",o.mode=ga;break}oe=o.lens[o.have-1],T=3+(m&3),m>>>=2,S-=2}else if($===17){for(F=w+3;S<F;){if(p===0)break e;p--,m+=s[d++]<<S,S+=8}m>>>=w,S-=w,oe=0,T=3+(m&7),m>>>=3,S-=3}else{for(F=w+7;S<F;){if(p===0)break e;p--,m+=s[d++]<<S,S+=8}m>>>=w,S-=w,oe=0,T=11+(m&127),m>>>=7,S-=7}if(o.have+T>o.nlen+o.ndist){i.msg="invalid bit length repeat",o.mode=ga;break}for(;T--;)o.lens[o.have++]=oe}}if(o.mode===ga)break;if(o.lens[256]===0){i.msg="invalid code -- missing end-of-block",o.mode=ga;break}if(o.lenbits=9,X={bits:o.lenbits},pe=$f(oy,o.lens,0,o.nlen,o.lencode,0,o.work,X),o.lenbits=X.bits,pe){i.msg="invalid literal/lengths set",o.mode=ga;break}if(o.distbits=6,o.distcode=o.distdyn,X={bits:o.distbits},pe=$f(sy,o.lens,o.nlen,o.ndist,o.distcode,0,o.work,X),o.distbits=X.bits,pe){i.msg="invalid distances set",o.mode=ga;break}if(o.mode=Yp,r===$p)break e;case Yp:o.mode=Gp;case Gp:if(p>=6&&g>=258){i.next_out=v,i.avail_out=g,i.next_in=d,i.avail_in=p,o.hold=m,o.bits=S,bb(i,E),v=i.next_out,c=i.output,g=i.avail_out,d=i.next_in,s=i.input,p=i.avail_in,m=o.hold,S=o.bits,o.mode===uu&&(o.back=-1);break}for(o.back=0;ee=o.lencode[m&(1<<o.lenbits)-1],w=ee>>>24,Se=ee>>>16&255,$=ee&65535,!(w<=S);){if(p===0)break e;p--,m+=s[d++]<<S,S+=8}if(Se&&(Se&240)===0){for(H=w,ae=Se,I=$;ee=o.lencode[I+((m&(1<<H+ae)-1)>>H)],w=ee>>>24,Se=ee>>>16&255,$=ee&65535,!(H+w<=S);){if(p===0)break e;p--,m+=s[d++]<<S,S+=8}m>>>=H,S-=H,o.back+=H}if(m>>>=w,S-=w,o.back+=w,o.length=$,Se===0){o.mode=J1;break}if(Se&32){o.back=-1,o.mode=uu;break}if(Se&64){i.msg="invalid literal/length code",o.mode=ga;break}o.extra=Se&15,o.mode=G1;case G1:if(o.extra){for(F=o.extra;S<F;){if(p===0)break e;p--,m+=s[d++]<<S,S+=8}o.length+=m&(1<<o.extra)-1,m>>>=o.extra,S-=o.extra,o.back+=o.extra}o.was=o.length,o.mode=X1;case X1:for(;ee=o.distcode[m&(1<<o.distbits)-1],w=ee>>>24,Se=ee>>>16&255,$=ee&65535,!(w<=S);){if(p===0)break e;p--,m+=s[d++]<<S,S+=8}if((Se&240)===0){for(H=w,ae=Se,I=$;ee=o.distcode[I+((m&(1<<H+ae)-1)>>H)],w=ee>>>24,Se=ee>>>16&255,$=ee&65535,!(H+w<=S);){if(p===0)break e;p--,m+=s[d++]<<S,S+=8}m>>>=H,S-=H,o.back+=H}if(m>>>=w,S-=w,o.back+=w,Se&64){i.msg="invalid distance code",o.mode=ga;break}o.offset=$,o.extra=Se&15,o.mode=K1;case K1:if(o.extra){for(F=o.extra;S<F;){if(p===0)break e;p--,m+=s[d++]<<S,S+=8}o.offset+=m&(1<<o.extra)-1,m>>>=o.extra,S-=o.extra,o.back+=o.extra}if(o.offset>o.dmax){i.msg="invalid distance too far back",o.mode=ga;break}o.mode=Z1;case Z1:if(g===0)break e;if(T=E-g,o.offset>T){if(T=o.offset-T,T>o.whave&&o.sane){i.msg="invalid distance too far back",o.mode=ga;break}T>o.wnext?(T-=o.wnext,K=o.wsize-T):K=o.wnext-T,T>o.length&&(T=o.length),D=o.window}else D=c,K=v-o.offset,T=o.length;T>g&&(T=g),g-=T,o.length-=T;do c[v++]=D[K++];while(--T);o.length===0&&(o.mode=Gp);break;case J1:if(g===0)break e;c[v++]=o.length,g--,o.mode=Gp;break;case pg:if(o.wrap){for(;S<32;){if(p===0)break e;p--,m|=s[d++]<<S,S+=8}if(E-=g,i.total_out+=E,o.total+=E,o.wrap&4&&E&&(i.adler=o.check=o.flags?Lc(o.check,c,E,v-E):Eg(o.check,c,E,v-E)),E=g,o.wrap&4&&(o.flags?m:tx(m))!==o.check){i.msg="incorrect data check",o.mode=ga;break}m=0,S=0}o.mode=Q1;case Q1:if(o.wrap&&o.flags){for(;S<32;){if(p===0)break e;p--,m+=s[d++]<<S,S+=8}if(o.wrap&4&&m!==(o.total&4294967295)){i.msg="incorrect length check",o.mode=ga;break}m=0,S=0}o.mode=ex;case ex:pe=Nb;break e;case ga:pe=ly;break e;case uy:return cy;case dy:default:return Wl}return i.next_out=v,i.avail_out=g,i.next_in=d,i.avail_in=p,o.hold=m,o.bits=S,(o.wsize||E!==i.avail_out&&o.mode<ga&&(o.mode<pg||r!==R1))&&xy(i,i.output,i.next_out,E-i.avail_out),_-=i.avail_in,E-=i.avail_out,i.total_in+=_,i.total_out+=E,o.total+=E,o.wrap&4&&E&&(i.adler=o.check=o.flags?Lc(o.check,c,E,i.next_out-E):Eg(o.check,c,E,i.next_out-E)),i.data_type=o.bits+(o.last?64:0)+(o.mode===uu?128:0)+(o.mode===Yp||o.mode===fg?256:0),(_===0&&E===0||r===R1)&&pe===hd&&(pe=zb),pe},Eb=i=>{if(gd(i))return Wl;let r=i.state;return r.window&&(r.window=null),i.state=null,hd},Ob=(i,r)=>{if(gd(i))return Wl;const o=i.state;return(o.wrap&2)===0?Wl:(o.head=r,r.done=!1,hd)},Fb=(i,r)=>{const o=r.length;let s,c,d;return gd(i)||(s=i.state,s.wrap!==0&&s.mode!==uh)?Wl:s.mode===uh&&(c=1,c=Eg(c,r,o,0),c!==s.check)?ly:(d=xy(i,r,o,o),d?(s.mode=uy,cy):(s.havedict=1,hd))};var Ub=py,qb=hy,Vb=fy,Hb=Mb,Wb=gy,$b=Bb,Yb=Eb,Gb=Ob,Xb=Fb,Kb="pako inflate (from Nodeca project)",fu={inflateReset:Ub,inflateReset2:qb,inflateResetKeep:Vb,inflateInit:Hb,inflateInit2:Wb,inflate:$b,inflateEnd:Yb,inflateGetHeader:Gb,inflateSetDictionary:Xb,inflateInfo:Kb};function Zb(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Jb=Zb;const yy=Object.prototype.toString,{Z_NO_FLUSH:Qb,Z_FINISH:e5,Z_OK:Gf,Z_STREAM_END:xg,Z_NEED_DICT:yg,Z_STREAM_ERROR:t5,Z_DATA_ERROR:ix,Z_MEM_ERROR:n5}=iy;function Kf(i){this.options=ry.assign({chunkSize:1024*64,windowBits:15,to:""},i||{});const r=this.options;r.raw&&r.windowBits>=0&&r.windowBits<16&&(r.windowBits=-r.windowBits,r.windowBits===0&&(r.windowBits=-15)),r.windowBits>=0&&r.windowBits<16&&!(i&&i.windowBits)&&(r.windowBits+=32),r.windowBits>15&&r.windowBits<48&&(r.windowBits&15)===0&&(r.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new yb,this.strm.avail_out=0;let o=fu.inflateInit2(this.strm,r.windowBits);if(o!==Gf)throw new Error(Og[o]);if(this.header=new Jb,fu.inflateGetHeader(this.strm,this.header),r.dictionary&&(typeof r.dictionary=="string"?r.dictionary=Fg.string2buf(r.dictionary):yy.call(r.dictionary)==="[object ArrayBuffer]"&&(r.dictionary=new Uint8Array(r.dictionary)),r.raw&&(o=fu.inflateSetDictionary(this.strm,r.dictionary),o!==Gf)))throw new Error(Og[o])}Kf.prototype.push=function(i,r){const o=this.strm,s=this.options.chunkSize,c=this.options.dictionary;let d,v,p;if(this.ended)return!1;for(r===~~r?v=r:v=r===!0?e5:Qb,yy.call(i)==="[object ArrayBuffer]"?o.input=new Uint8Array(i):o.input=i,o.next_in=0,o.avail_in=o.input.length;;){for(o.avail_out===0&&(o.output=new Uint8Array(s),o.next_out=0,o.avail_out=s),d=fu.inflate(o,v),d===yg&&c&&(d=fu.inflateSetDictionary(o,c),d===Gf?d=fu.inflate(o,v):d===ix&&(d=yg));o.avail_in>0&&d===xg&&o.state.wrap>0&&i[o.next_in]!==0;)fu.inflateReset(o),d=fu.inflate(o,v);switch(d){case t5:case ix:case yg:case n5:return this.onEnd(d),this.ended=!0,!1}if(p=o.avail_out,o.next_out&&(o.avail_out===0||d===xg))if(this.options.to==="string"){let g=Fg.utf8border(o.output,o.next_out),m=o.next_out-g,S=Fg.buf2string(o.output,g);o.next_out=m,o.avail_out=s-m,m&&o.output.set(o.output.subarray(g,g+m),0),this.onData(S)}else this.onData(o.output.length===o.next_out?o.output:o.output.subarray(0,o.next_out));if(!(d===Gf&&p===0)){if(d===xg)return d=fu.inflateEnd(this.strm),this.onEnd(d),this.ended=!0,!0;if(o.avail_in===0)break}}return!0};Kf.prototype.onData=function(i){this.chunks.push(i)};Kf.prototype.onEnd=function(i){i===Gf&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=ry.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};function i5(i,r){const o=new Kf(r);if(o.push(i),o.err)throw o.msg||Og[o.err];return o.result}var r5=Kf,a5=i5,o5={Inflate:r5,inflate:a5};const{Inflate:s5,inflate:l5}=o5;var rx=s5,c5=l5;const my=[];for(let i=0;i<256;i++){let r=i;for(let o=0;o<8;o++)r&1?r=3988292384^r>>>1:r=r>>>1;my[i]=r}const ax=4294967295;function u5(i,r,o){let s=i;for(let c=0;c<o;c++)s=my[(s^r[c])&255]^s>>>8;return s}function d5(i,r){return(u5(ax,i,r)^ax)>>>0}function ox(i,r,o){const s=i.readUint32(),c=d5(new Uint8Array(i.buffer,i.byteOffset+i.offset-r-4,r),r);if(c!==s)throw new Error(`CRC mismatch for chunk ${o}. Expected ${s}, found ${c}`)}function by(i,r,o){for(let s=0;s<o;s++)r[s]=i[s]}function vy(i,r,o,s){let c=0;for(;c<s;c++)r[c]=i[c];for(;c<o;c++)r[c]=i[c]+r[c-s]&255}function wy(i,r,o,s){let c=0;if(o.length===0)for(;c<s;c++)r[c]=i[c];else for(;c<s;c++)r[c]=i[c]+o[c]&255}function Sy(i,r,o,s,c){let d=0;if(o.length===0){for(;d<c;d++)r[d]=i[d];for(;d<s;d++)r[d]=i[d]+(r[d-c]>>1)&255}else{for(;d<c;d++)r[d]=i[d]+(o[d]>>1)&255;for(;d<s;d++)r[d]=i[d]+(r[d-c]+o[d]>>1)&255}}function jy(i,r,o,s,c){let d=0;if(o.length===0){for(;d<c;d++)r[d]=i[d];for(;d<s;d++)r[d]=i[d]+r[d-c]&255}else{for(;d<c;d++)r[d]=i[d]+o[d]&255;for(;d<s;d++)r[d]=i[d]+f5(r[d-c],o[d],o[d-c])&255}}function f5(i,r,o){const s=i+r-o,c=Math.abs(s-i),d=Math.abs(s-r),v=Math.abs(s-o);return c<=d&&c<=v?i:d<=v?r:o}function p5(i,r,o,s,c,d){switch(i){case 0:by(r,o,c);break;case 1:vy(r,o,c,d);break;case 2:wy(r,o,s,c);break;case 3:Sy(r,o,s,c,d);break;case 4:jy(r,o,s,c,d);break;default:throw new Error(`Unsupported filter: ${i}`)}}const h5=new Uint16Array([255]),g5=new Uint8Array(h5.buffer),x5=g5[0]===255;function y5(i){const{data:r,width:o,height:s,channels:c,depth:d}=i,v=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],p=Math.ceil(d/8)*c,g=new Uint8Array(s*o*p);let m=0;for(let S=0;S<7;S++){const _=v[S],E=Math.ceil((o-_.x)/_.xStep),T=Math.ceil((s-_.y)/_.yStep);if(E<=0||T<=0)continue;const K=E*p,D=new Uint8Array(K);for(let ee=0;ee<T;ee++){const w=r[m++],Se=r.subarray(m,m+K);m+=K;const $=new Uint8Array(K);p5(w,Se,$,D,K,p),D.set($);for(let H=0;H<E;H++){const ae=_.x+H*_.xStep,I=_.y+ee*_.yStep;if(!(ae>=o||I>=s))for(let oe=0;oe<p;oe++)g[(I*o+ae)*p+oe]=$[H*p+oe]}}}if(d===16){const S=new Uint16Array(g.buffer);if(x5)for(let _=0;_<S.length;_++)S[_]=m5(S[_]);return S}else return g}function m5(i){return(i&255)<<8|i>>8&255}const b5=new Uint16Array([255]),v5=new Uint8Array(b5.buffer),w5=v5[0]===255,S5=new Uint8Array(0);function sx(i){const{data:r,width:o,height:s,channels:c,depth:d}=i,v=Math.ceil(d/8)*c,p=Math.ceil(d/8*c*o),g=new Uint8Array(s*p);let m=S5,S=0,_,E;for(let T=0;T<s;T++){switch(_=r.subarray(S+1,S+1+p),E=g.subarray(T*p,(T+1)*p),r[S]){case 0:by(_,E,p);break;case 1:vy(_,E,p,v);break;case 2:wy(_,E,m,p);break;case 3:Sy(_,E,m,p,v);break;case 4:jy(_,E,m,p,v);break;default:throw new Error(`Unsupported filter: ${r[S]}`)}m=E,S+=p+1}if(d===16){const T=new Uint16Array(g.buffer);if(w5)for(let K=0;K<T.length;K++)T[K]=j5(T[K]);return T}else return g}function j5(i){return(i&255)<<8|i>>8&255}const nh=Uint8Array.of(137,80,78,71,13,10,26,10);function lx(i){if(!T5(i.readBytes(nh.length)))throw new Error("wrong PNG signature")}function T5(i){if(i.length<nh.length)return!1;for(let r=0;r<nh.length;r++)if(i[r]!==nh[r])return!1;return!0}const C5="tEXt",k5=0,Ty=new TextDecoder("latin1");function N5(i){if(z5(i),i.length===0||i.length>79)throw new Error("keyword length must be between 1 and 79")}const A5=/^[\u0000-\u00FF]*$/;function z5(i){if(!A5.test(i))throw new Error("invalid latin1 text")}function P5(i,r,o){const s=Cy(r);i[s]=_5(r,o-s.length-1)}function Cy(i){for(i.mark();i.readByte()!==k5;);const r=i.offset;i.reset();const o=Ty.decode(i.readBytes(r-i.offset-1));return i.skip(1),N5(o),o}function _5(i,r){return Ty.decode(i.readBytes(r))}const Tl={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},mg={UNKNOWN:-1,DEFLATE:0},cx={UNKNOWN:-1,ADAPTIVE:0},bg={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Xp={NONE:0,BACKGROUND:1,PREVIOUS:2},vg={SOURCE:0,OVER:1};class R5 extends Zg{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(r,o={}){super(r);const{checkCrc:s=!1}=o;this._checkCrc=s,this._inflator=new rx,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=mg.UNKNOWN,this._filterMethod=cx.UNKNOWN,this._interlaceMethod=bg.UNKNOWN,this._colorType=Tl.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(lx(this);!this._end;){const r=this.readUint32(),o=this.readChars(4);this.decodeChunk(r,o)}return this.decodeImage(),this._png}decodeApng(){for(lx(this);!this._end;){const r=this.readUint32(),o=this.readChars(4);this.decodeApngChunk(r,o)}return this.decodeApngImage(),this._apng}decodeChunk(r,o){const s=this.offset;switch(o){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case C5:P5(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${o}`);this._checkCrc?ox(this,r+4,o):this.skip(4)}decodeApngChunk(r,o){const s=this.offset;switch(o!=="fdAT"&&o!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),o){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,o),this.offset=s+r;break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${o}`);this._checkCrc?ox(this,r+4,o):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=D5(this.readUint8());const o=this.readUint8();this._colorType=o;let s;switch(o){case Tl.GREYSCALE:s=1;break;case Tl.TRUECOLOUR:s=3;break;case Tl.INDEXED_COLOUR:s=1;break;case Tl.GREYSCALE_ALPHA:s=2;break;case Tl.TRUECOLOUR_ALPHA:s=4;break;case Tl.UNKNOWN:default:throw new Error(`Unknown color type: ${o}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==mg.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const o=r/3;this._hasPalette=!0;const s=[];this._palette=s;for(let c=0;c<o;c++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const o=r,s=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,s,o)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let o=r,s=this.offset+this.byteOffset;if(s+=4,o-=4,this._inflator.push(new Uint8Array(this.buffer,s,o)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case Tl.GREYSCALE:case Tl.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let o=0;o<r/2;o++)this._transparency[o]=this.readUint16();break}case Tl.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let o=0;for(;o<r;o++){const s=this.readByte();this._palette[o].push(s)}for(;o<this._palette.length;o++)this._palette[o].push(255);break}case Tl.UNKNOWN:case Tl.GREYSCALE_ALPHA:case Tl.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const o=Cy(this),s=this.readUint8();if(s!==mg.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const c=this.readBytes(r-o.length-2);this._png.iccEmbeddedProfile={name:o,profile:c5(c)}}decodepHYs(){const r=this.readUint32(),o=this.readUint32(),s=this.readByte();this._png.resolution={x:r,y:o,unit:s}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const o={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},s=this._frames.at(r);if(s){if(s.data=sx({data:s.data,width:s.width,height:s.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||s.xOffset===0&&s.yOffset===0&&s.width===this._png.width&&s.height===this._png.height)o.data=s.data;else{const c=this._apng.frames.at(r-1);this.disposeFrame(s,c,o),this.addFrameDataToCanvas(o,s)}this._apng.frames.push(o)}}return this._apng}disposeFrame(r,o,s){switch(r.disposeOp){case Xp.NONE:break;case Xp.BACKGROUND:for(let c=0;c<this._png.height;c++)for(let d=0;d<this._png.width;d++){const v=(c*r.width+d)*this._png.channels;for(let p=0;p<this._png.channels;p++)s.data[v+p]=0}break;case Xp.PREVIOUS:s.data.set(o.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,o){const s=1<<this._png.depth,c=(d,v)=>{const p=((d+o.yOffset)*this._png.width+o.xOffset+v)*this._png.channels,g=(d*o.width+v)*this._png.channels;return{index:p,frameIndex:g}};switch(o.blendOp){case vg.SOURCE:for(let d=0;d<o.height;d++)for(let v=0;v<o.width;v++){const{index:p,frameIndex:g}=c(d,v);for(let m=0;m<this._png.channels;m++)r.data[p+m]=o.data[g+m]}break;case vg.OVER:for(let d=0;d<o.height;d++)for(let v=0;v<o.width;v++){const{index:p,frameIndex:g}=c(d,v);for(let m=0;m<this._png.channels;m++){const S=o.data[g+this._png.channels-1]/s,_=m%(this._png.channels-1)===0?1:o.data[g+m],E=Math.floor(S*_+(1-S)*r.data[p+m]);r.data[p+m]+=E}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==cx.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===bg.NO_INTERLACE)this._png.data=sx({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===bg.ADAM7)this._png.data=y5({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,o=this._frames.at(-1);o?o.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Xp.NONE,blendOp:vg.SOURCE,data:r}),this._inflator=new rx,this._writingDataChunks=!1}}function D5(i){if(i!==1&&i!==2&&i!==4&&i!==8&&i!==16)throw new Error(`invalid bit depth: ${i}`);return i}var ux;(function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.METRE=1]="METRE"})(ux||(ux={}));function L5(i,r){return new R5(i,r).decode()}var li=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function wg(){li.console&&typeof li.console.log=="function"&&li.console.log.apply(li.console,arguments)}var Yr={log:wg,warn:function(i){li.console&&(typeof li.console.warn=="function"?li.console.warn.apply(li.console,arguments):wg.call(null,arguments))},error:function(i){li.console&&(typeof li.console.error=="function"?li.console.error.apply(li.console,arguments):wg(i))}};function Sg(i,r,o){var s=new XMLHttpRequest;s.open("GET",i),s.responseType="blob",s.onload=function(){ud(s.response,r,o)},s.onerror=function(){Yr.error("could not download file")},s.send()}function dx(i){var r=new XMLHttpRequest;r.open("HEAD",i,!1);try{r.send()}catch{}return r.status>=200&&r.status<=299}function Kp(i){try{i.dispatchEvent(new MouseEvent("click"))}catch{var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),i.dispatchEvent(r)}}var ud=li.saveAs||((typeof window>"u"?"undefined":_r(window))!=="object"||window!==li?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(i,r,o){var s=li.URL||li.webkitURL,c=document.createElement("a");r=r||i.name||"download",c.download=r,c.rel="noopener",typeof i=="string"?(c.href=i,c.origin!==location.origin?dx(c.href)?Sg(i,r,o):Kp(c,c.target="_blank"):Kp(c)):(c.href=s.createObjectURL(i),setTimeout(function(){s.revokeObjectURL(c.href)},4e4),setTimeout(function(){Kp(c)},0))}:"msSaveOrOpenBlob"in navigator?function(i,r,o){if(r=r||i.name||"download",typeof i=="string")if(dx(i))Sg(i,r,o);else{var s=document.createElement("a");s.href=i,s.target="_blank",setTimeout(function(){Kp(s)})}else navigator.msSaveOrOpenBlob((function(c,d){return d===void 0?d={autoBom:!1}:_r(d)!=="object"&&(Yr.warn("Deprecated: Expected third argument to be a object"),d={autoBom:!d}),d.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c})(i,o),r)}:function(i,r,o,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),typeof i=="string")return Sg(i,r,o);var c=i.type==="application/octet-stream",d=/constructor/i.test(li.HTMLElement)||li.safari,v=/CriOS\/[\d]+/.test(navigator.userAgent);if((v||c&&d)&&(typeof FileReader>"u"?"undefined":_r(FileReader))==="object"){var p=new FileReader;p.onloadend=function(){var S=p.result;S=v?S:S.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=S:location=S,s=null},p.readAsDataURL(i)}else{var g=li.URL||li.webkitURL,m=g.createObjectURL(i);s?s.location=m:location.href=m,s=null,setTimeout(function(){g.revokeObjectURL(m)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function ky(i){var r;i=i||"",this.ok=!1,i.charAt(0)=="#"&&(i=i.substr(1,6)),i={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[i=(i=i.replace(/ /g,"")).toLowerCase()]||i;for(var o=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(p){return[parseInt(p[1]),parseInt(p[2]),parseInt(p[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(p){return[parseInt(p[1],16),parseInt(p[2],16),parseInt(p[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(p){return[parseInt(p[1]+p[1],16),parseInt(p[2]+p[2],16),parseInt(p[3]+p[3],16)]}}],s=0;s<o.length;s++){var c=o[s].re,d=o[s].process,v=c.exec(i);v&&(r=d(v),this.r=r[0],this.g=r[1],this.b=r[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var p=this.r.toString(16),g=this.g.toString(16),m=this.b.toString(16);return p.length==1&&(p="0"+p),g.length==1&&(g="0"+g),m.length==1&&(m="0"+m),"#"+p+g+m}}var ih=li.atob.bind(li),fx=li.btoa.bind(li);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function jg(i,r){var o=i[0],s=i[1],c=i[2],d=i[3];o=Ts(o,s,c,d,r[0],7,-680876936),d=Ts(d,o,s,c,r[1],12,-389564586),c=Ts(c,d,o,s,r[2],17,606105819),s=Ts(s,c,d,o,r[3],22,-1044525330),o=Ts(o,s,c,d,r[4],7,-176418897),d=Ts(d,o,s,c,r[5],12,1200080426),c=Ts(c,d,o,s,r[6],17,-1473231341),s=Ts(s,c,d,o,r[7],22,-45705983),o=Ts(o,s,c,d,r[8],7,1770035416),d=Ts(d,o,s,c,r[9],12,-1958414417),c=Ts(c,d,o,s,r[10],17,-42063),s=Ts(s,c,d,o,r[11],22,-1990404162),o=Ts(o,s,c,d,r[12],7,1804603682),d=Ts(d,o,s,c,r[13],12,-40341101),c=Ts(c,d,o,s,r[14],17,-1502002290),o=Cs(o,s=Ts(s,c,d,o,r[15],22,1236535329),c,d,r[1],5,-165796510),d=Cs(d,o,s,c,r[6],9,-1069501632),c=Cs(c,d,o,s,r[11],14,643717713),s=Cs(s,c,d,o,r[0],20,-373897302),o=Cs(o,s,c,d,r[5],5,-701558691),d=Cs(d,o,s,c,r[10],9,38016083),c=Cs(c,d,o,s,r[15],14,-660478335),s=Cs(s,c,d,o,r[4],20,-405537848),o=Cs(o,s,c,d,r[9],5,568446438),d=Cs(d,o,s,c,r[14],9,-1019803690),c=Cs(c,d,o,s,r[3],14,-187363961),s=Cs(s,c,d,o,r[8],20,1163531501),o=Cs(o,s,c,d,r[13],5,-1444681467),d=Cs(d,o,s,c,r[2],9,-51403784),c=Cs(c,d,o,s,r[7],14,1735328473),o=ks(o,s=Cs(s,c,d,o,r[12],20,-1926607734),c,d,r[5],4,-378558),d=ks(d,o,s,c,r[8],11,-2022574463),c=ks(c,d,o,s,r[11],16,1839030562),s=ks(s,c,d,o,r[14],23,-35309556),o=ks(o,s,c,d,r[1],4,-1530992060),d=ks(d,o,s,c,r[4],11,1272893353),c=ks(c,d,o,s,r[7],16,-155497632),s=ks(s,c,d,o,r[10],23,-1094730640),o=ks(o,s,c,d,r[13],4,681279174),d=ks(d,o,s,c,r[0],11,-358537222),c=ks(c,d,o,s,r[3],16,-722521979),s=ks(s,c,d,o,r[6],23,76029189),o=ks(o,s,c,d,r[9],4,-640364487),d=ks(d,o,s,c,r[12],11,-421815835),c=ks(c,d,o,s,r[15],16,530742520),o=Ns(o,s=ks(s,c,d,o,r[2],23,-995338651),c,d,r[0],6,-198630844),d=Ns(d,o,s,c,r[7],10,1126891415),c=Ns(c,d,o,s,r[14],15,-1416354905),s=Ns(s,c,d,o,r[5],21,-57434055),o=Ns(o,s,c,d,r[12],6,1700485571),d=Ns(d,o,s,c,r[3],10,-1894986606),c=Ns(c,d,o,s,r[10],15,-1051523),s=Ns(s,c,d,o,r[1],21,-2054922799),o=Ns(o,s,c,d,r[8],6,1873313359),d=Ns(d,o,s,c,r[15],10,-30611744),c=Ns(c,d,o,s,r[6],15,-1560198380),s=Ns(s,c,d,o,r[13],21,1309151649),o=Ns(o,s,c,d,r[4],6,-145523070),d=Ns(d,o,s,c,r[11],10,-1120210379),c=Ns(c,d,o,s,r[2],15,718787259),s=Ns(s,c,d,o,r[9],21,-343485551),i[0]=Uu(o,i[0]),i[1]=Uu(s,i[1]),i[2]=Uu(c,i[2]),i[3]=Uu(d,i[3])}function gh(i,r,o,s,c,d){return r=Uu(Uu(r,i),Uu(s,d)),Uu(r<<c|r>>>32-c,o)}function Ts(i,r,o,s,c,d,v){return gh(r&o|~r&s,i,r,c,d,v)}function Cs(i,r,o,s,c,d,v){return gh(r&s|o&~s,i,r,c,d,v)}function ks(i,r,o,s,c,d,v){return gh(r^o^s,i,r,c,d,v)}function Ns(i,r,o,s,c,d,v){return gh(o^(r|~s),i,r,c,d,v)}function Ny(i){var r,o=i.length,s=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=i.length;r+=64)jg(s,M5(i.substring(r-64,r)));i=i.substring(r-64);var c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<i.length;r++)c[r>>2]|=i.charCodeAt(r)<<(r%4<<3);if(c[r>>2]|=128<<(r%4<<3),r>55)for(jg(s,c),r=0;r<16;r++)c[r]=0;return c[14]=8*o,jg(s,c),s}function M5(i){var r,o=[];for(r=0;r<64;r+=4)o[r>>2]=i.charCodeAt(r)+(i.charCodeAt(r+1)<<8)+(i.charCodeAt(r+2)<<16)+(i.charCodeAt(r+3)<<24);return o}var px="0123456789abcdef".split("");function I5(i){for(var r="",o=0;o<4;o++)r+=px[i>>8*o+4&15]+px[i>>8*o&15];return r}function B5(i){return String.fromCharCode(255&i,(65280&i)>>8,(16711680&i)>>16,(4278190080&i)>>24)}function Ug(i){return Ny(i).map(B5).join("")}var E5=(function(i){for(var r=0;r<i.length;r++)i[r]=I5(i[r]);return i.join("")})(Ny("hello"))!="5d41402abc4b2a76b9719d911017c592";function Uu(i,r){if(E5){var o=(65535&i)+(65535&r);return(i>>16)+(r>>16)+(o>>16)<<16|65535&o}return i+r&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function qg(i,r){var o,s,c,d;if(i!==o){for(var v=(c=i,d=1+(256/i.length|0),new Array(d+1).join(c)),p=[],g=0;g<256;g++)p[g]=g;var m=0;for(g=0;g<256;g++){var S=p[g];m=(m+S+v.charCodeAt(g))%256,p[g]=p[m],p[m]=S}o=i,s=p}else p=s;var _=r.length,E=0,T=0,K="";for(g=0;g<_;g++)T=(T+(S=p[E=(E+1)%256]))%256,p[E]=p[T],p[T]=S,v=p[(p[E]+p[T])%256],K+=String.fromCharCode(r.charCodeAt(g)^v);return K}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var hx={print:4,modify:8,copy:16,"annot-forms":32};function Jd(i,r,o,s){this.v=1,this.r=2;var c=192;i.forEach(function(p){if(hx.perm!==void 0)throw new Error("Invalid permission: "+p);c+=hx[p]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var d=(r+this.padding).substr(0,32),v=(o+this.padding).substr(0,32);this.O=this.processOwnerPassword(d,v),this.P=-(1+(255^c)),this.encryptionKey=Ug(d+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(s)).substr(0,5),this.U=qg(this.encryptionKey,this.padding)}function Qd(i){if(/[^\u0000-\u00ff]/.test(i))throw new Error("Invalid PDF Name Object: "+i+", Only accept ASCII characters.");for(var r="",o=i.length,s=0;s<o;s++){var c=i.charCodeAt(s);r+=c<33||c===35||c===37||c===40||c===41||c===47||c===60||c===62||c===91||c===93||c===123||c===125||c>126?"#"+("0"+c.toString(16)).slice(-2):i[s]}return r}function gx(i){if(_r(i)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var r={};this.subscribe=function(o,s,c){if(c=c||!1,typeof o!="string"||typeof s!="function"||typeof c!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");r.hasOwnProperty(o)||(r[o]={});var d=Math.random().toString(35);return r[o][d]=[s,!!c],d},this.unsubscribe=function(o){for(var s in r)if(r[s][o])return delete r[s][o],Object.keys(r[s]).length===0&&delete r[s],!0;return!1},this.publish=function(o){if(r.hasOwnProperty(o)){var s=Array.prototype.slice.call(arguments,1),c=[];for(var d in r[o]){var v=r[o][d];try{v[0].apply(i,s)}catch(p){li.console&&Yr.error("jsPDF PubSub Error",p.message,p)}v[1]&&c.push(d)}c.length&&c.forEach(this.unsubscribe)}},this.getTopics=function(){return r}}function dh(i){if(!(this instanceof dh))return new dh(i);var r="opacity,stroke-opacity".split(",");for(var o in i)i.hasOwnProperty(o)&&r.indexOf(o)>=0&&(this[o]=i[o]);this.id="",this.objectNumber=-1}function Ay(i,r){this.gState=i,this.matrix=r,this.id="",this.objectNumber=-1}function dd(i,r,o,s,c){if(!(this instanceof dd))return new dd(i,r,o,s,c);this.type=i==="axial"?2:3,this.coords=r,this.colors=o,Ay.call(this,s,c)}function ef(i,r,o,s,c){if(!(this instanceof ef))return new ef(i,r,o,s,c);this.boundingBox=i,this.xStep=r,this.yStep=o,this.stream="",this.cloneIndex=0,Ay.call(this,s,c)}function En(i){var r,o=typeof arguments[0]=="string"?arguments[0]:"p",s=arguments[1],c=arguments[2],d=arguments[3],v=[],p=1,g=16,m="S",S=null;_r(i=i||{})==="object"&&(o=i.orientation,s=i.unit||s,c=i.format||c,d=i.compress||i.compressPdf||d,(S=i.encryption||null)!==null&&(S.userPassword=S.userPassword||"",S.ownerPassword=S.ownerPassword||"",S.userPermissions=S.userPermissions||[]),p=typeof i.userUnit=="number"?Math.abs(i.userUnit):1,i.precision!==void 0&&(r=i.precision),i.floatPrecision!==void 0&&(g=i.floatPrecision),m=i.defaultPathOperation||"S"),v=i.filters||(d===!0?["FlateEncode"]:v),s=s||"mm",o=(""+(o||"P")).toLowerCase();var _=i.putOnlyUsedFonts||!1,E={},T={internal:{},__private__:{}};T.__private__.PubSub=gx;var K="1.3",D=T.__private__.getPdfVersion=function(){return K};T.__private__.setPdfVersion=function(j){K=j};var ee={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};T.__private__.getPageFormats=function(){return ee};var w=T.__private__.getPageFormat=function(j){return ee[j]};c=c||"a4";var Se="compat",$="advanced",H=Se;function ae(){this.saveGraphicsState(),se(new Yt(_t,0,0,-_t,0,_s()*_t).toString()+" cm"),this.setFontSize(this.getFontSize()/_t),m="n",H=$}function I(){this.restoreGraphicsState(),m="S",H=Se}var oe=T.__private__.combineFontStyleAndFontWeight=function(j,W){if(j=="bold"&&W=="normal"||j=="bold"&&W==400||j=="normal"&&W=="italic"||j=="bold"&&W=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return W&&(j=W==400||W==="normal"?j==="italic"?"italic":"normal":W!=700&&W!=="bold"||j!=="normal"?(W==700?"bold":W)+""+j:"bold"),j};T.advancedAPI=function(j){var W=H===Se;return W&&ae.call(this),typeof j!="function"||(j(this),W&&I.call(this)),this},T.compatAPI=function(j){var W=H===$;return W&&I.call(this),typeof j!="function"||(j(this),W&&ae.call(this)),this},T.isAdvancedAPI=function(){return H===$};var pe,Y=function(j){if(H!==$)throw new Error(j+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},X=T.roundToPrecision=T.__private__.roundToPrecision=function(j,W){var ze=r||W;if(isNaN(j)||isNaN(ze))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return j.toFixed(ze).replace(/0+$/,"")};pe=T.hpf=T.__private__.hpf=typeof g=="number"?function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.hpf");return X(j,g)}:g==="smart"?function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.hpf");return X(j,j>-1&&j<1?16:5)}:function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.hpf");return X(j,16)};var F=T.f2=T.__private__.f2=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.f2");return X(j,2)},R=T.__private__.f3=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.f3");return X(j,3)},U=T.scale=T.__private__.scale=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.scale");return H===Se?j*_t:H===$?j:void 0},O=function(j){return U((function(W){return H===Se?_s()-W:H===$?W:void 0})(j))};T.__private__.setPrecision=T.setPrecision=function(j){typeof parseInt(j,10)=="number"&&(r=parseInt(j,10))};var _e,ce="00000000000000000000000000000000",xe=T.__private__.getFileId=function(){return ce},fe=T.__private__.setFileId=function(j){return ce=j!==void 0&&/^[a-fA-F0-9]{32}$/.test(j)?j.toUpperCase():ce.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),S!==null&&(wi=new Jd(S.userPermissions,S.userPassword,S.ownerPassword,ce)),ce};T.setFileId=function(j){return fe(j),this},T.getFileId=function(){return xe()};var ke=T.__private__.convertDateToPDFDate=function(j){var W=j.getTimezoneOffset(),ze=W<0?"+":"-",Oe=Math.floor(Math.abs(W/60)),Ie=Math.abs(W%60),bt=[ze,V(Oe),"'",V(Ie),"'"].join("");return["D:",j.getFullYear(),V(j.getMonth()+1),V(j.getDate()),V(j.getHours()),V(j.getMinutes()),V(j.getSeconds()),bt].join("")},de=T.__private__.convertPDFDateToDate=function(j){var W=parseInt(j.substr(2,4),10),ze=parseInt(j.substr(6,2),10)-1,Oe=parseInt(j.substr(8,2),10),Ie=parseInt(j.substr(10,2),10),bt=parseInt(j.substr(12,2),10),gt=parseInt(j.substr(14,2),10);return new Date(W,ze,Oe,Ie,bt,gt,0)},C=T.__private__.setCreationDate=function(j){var W;if(j===void 0&&(j=new Date),j instanceof Date)W=ke(j);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(j))throw new Error("Invalid argument passed to jsPDF.setCreationDate");W=j}return _e=W},z=T.__private__.getCreationDate=function(j){var W=_e;return j==="jsDate"&&(W=de(_e)),W};T.setCreationDate=function(j){return C(j),this},T.getCreationDate=function(j){return z(j)};var G,V=T.__private__.padd2=function(j){return("0"+parseInt(j)).slice(-2)},ie=T.__private__.padd2Hex=function(j){return("00"+(j=j.toString())).substr(j.length)},he=0,re=[],Le=[],Re=0,Ue=[],et=[],ot=!1,Ct=Le;T.__private__.setCustomOutputDestination=function(j){ot=!0,Ct=j};var Ot=function(j){ot||(Ct=j)};T.__private__.resetCustomOutputDestination=function(){ot=!1,Ct=Le};var se=T.__private__.out=function(j){return j=j.toString(),Re+=j.length+1,Ct.push(j),Ct},kt=T.__private__.write=function(j){return se(arguments.length===1?j.toString():Array.prototype.join.call(arguments," "))},Jt=T.__private__.getArrayBuffer=function(j){for(var W=j.length,ze=new ArrayBuffer(W),Oe=new Uint8Array(ze);W--;)Oe[W]=j.charCodeAt(W);return ze},Wt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];T.__private__.getStandardFonts=function(){return Wt};var ht=i.fontSize||16;T.__private__.setFontSize=T.setFontSize=function(j){return ht=H===$?j/_t:j,this};var Xe,Ut=T.__private__.getFontSize=T.getFontSize=function(){return H===Se?ht:ht*_t},an=i.R2L||!1;T.__private__.setR2L=T.setR2L=function(j){return an=j,this},T.__private__.getR2L=T.getR2L=function(){return an};var Ht,Nn=T.__private__.setZoomMode=function(j){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(j))Xe=j;else if(isNaN(j)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(j)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+j+'" is not recognized.');Xe=j}else Xe=parseInt(j,10)};T.__private__.getZoomMode=function(){return Xe};var zn,Ee=T.__private__.setPageMode=function(j){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(j)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+j+'" is not recognized.');Ht=j};T.__private__.getPageMode=function(){return Ht};var Ne=T.__private__.setLayoutMode=function(j){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(j)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+j+'" is not recognized.');zn=j};T.__private__.getLayoutMode=function(){return zn},T.__private__.setDisplayMode=T.setDisplayMode=function(j,W,ze){return Nn(j),Ne(W),Ee(ze),this};var Mt={title:"",subject:"",author:"",keywords:"",creator:""};T.__private__.getDocumentProperty=function(j){if(Object.keys(Mt).indexOf(j)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Mt[j]},T.__private__.getDocumentProperties=function(){return Mt},T.__private__.setDocumentProperties=T.setProperties=T.setDocumentProperties=function(j){for(var W in Mt)Mt.hasOwnProperty(W)&&j[W]&&(Mt[W]=j[W]);return this},T.__private__.setDocumentProperty=function(j,W){if(Object.keys(Mt).indexOf(j)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Mt[j]=W};var ct,_t,Ze,jt,en,Qe={},At={},un=[],xn={},Kt={},Qt={},hn={},Xn=null,rt=0,ln=[],Lt=new gx(T),Zn=i.hotfixes||[],In={},wr={},Zi=[],Yt=function j(W,ze,Oe,Ie,bt,gt){if(!(this instanceof j))return new j(W,ze,Oe,Ie,bt,gt);isNaN(W)&&(W=1),isNaN(ze)&&(ze=0),isNaN(Oe)&&(Oe=0),isNaN(Ie)&&(Ie=1),isNaN(bt)&&(bt=0),isNaN(gt)&&(gt=0),this._matrix=[W,ze,Oe,Ie,bt,gt]};Object.defineProperty(Yt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(j){this._matrix[0]=j}}),Object.defineProperty(Yt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(j){this._matrix[1]=j}}),Object.defineProperty(Yt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(j){this._matrix[2]=j}}),Object.defineProperty(Yt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(j){this._matrix[3]=j}}),Object.defineProperty(Yt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(j){this._matrix[4]=j}}),Object.defineProperty(Yt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(j){this._matrix[5]=j}}),Object.defineProperty(Yt.prototype,"a",{get:function(){return this._matrix[0]},set:function(j){this._matrix[0]=j}}),Object.defineProperty(Yt.prototype,"b",{get:function(){return this._matrix[1]},set:function(j){this._matrix[1]=j}}),Object.defineProperty(Yt.prototype,"c",{get:function(){return this._matrix[2]},set:function(j){this._matrix[2]=j}}),Object.defineProperty(Yt.prototype,"d",{get:function(){return this._matrix[3]},set:function(j){this._matrix[3]=j}}),Object.defineProperty(Yt.prototype,"e",{get:function(){return this._matrix[4]},set:function(j){this._matrix[4]=j}}),Object.defineProperty(Yt.prototype,"f",{get:function(){return this._matrix[5]},set:function(j){this._matrix[5]=j}}),Object.defineProperty(Yt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Yt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Yt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Yt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Yt.prototype.join=function(j){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(pe).join(j)},Yt.prototype.multiply=function(j){var W=j.sx*this.sx+j.shy*this.shx,ze=j.sx*this.shy+j.shy*this.sy,Oe=j.shx*this.sx+j.sy*this.shx,Ie=j.shx*this.shy+j.sy*this.sy,bt=j.tx*this.sx+j.ty*this.shx+this.tx,gt=j.tx*this.shy+j.ty*this.sy+this.ty;return new Yt(W,ze,Oe,Ie,bt,gt)},Yt.prototype.decompose=function(){var j=this.sx,W=this.shy,ze=this.shx,Oe=this.sy,Ie=this.tx,bt=this.ty,gt=Math.sqrt(j*j+W*W),dn=(j/=gt)*ze+(W/=gt)*Oe;ze-=j*dn,Oe-=W*dn;var Gt=Math.sqrt(ze*ze+Oe*Oe);return dn/=Gt,j*(Oe/=Gt)<W*(ze/=Gt)&&(j=-j,W=-W,dn=-dn,gt=-gt),{scale:new Yt(gt,0,0,Gt,0,0),translate:new Yt(1,0,0,1,Ie,bt),rotate:new Yt(j,W,-W,j,0,0),skew:new Yt(1,0,dn,1,0,0)}},Yt.prototype.toString=function(j){return this.join(" ")},Yt.prototype.inversed=function(){var j=this.sx,W=this.shy,ze=this.shx,Oe=this.sy,Ie=this.tx,bt=this.ty,gt=1/(j*Oe-W*ze),dn=Oe*gt,Gt=-W*gt,fn=-ze*gt,wn=j*gt;return new Yt(dn,Gt,fn,wn,-dn*Ie-fn*bt,-Gt*Ie-wn*bt)},Yt.prototype.applyToPoint=function(j){var W=j.x*this.sx+j.y*this.shx+this.tx,ze=j.x*this.shy+j.y*this.sy+this.ty;return new gs(W,ze)},Yt.prototype.applyToRectangle=function(j){var W=this.applyToPoint(j),ze=this.applyToPoint(new gs(j.x+j.w,j.y+j.h));return new tn(W.x,W.y,ze.x-W.x,ze.y-W.y)},Yt.prototype.clone=function(){var j=this.sx,W=this.shy,ze=this.shx,Oe=this.sy,Ie=this.tx,bt=this.ty;return new Yt(j,W,ze,Oe,Ie,bt)},T.Matrix=Yt;var jn=T.matrixMult=function(j,W){return W.multiply(j)},ci=new Yt(1,0,0,1,0,0);T.unitMatrix=T.identityMatrix=ci;var Et=function(j,W){if(!Kt[j]){var ze=(W instanceof dd?"Sh":"P")+(Object.keys(xn).length+1).toString(10);W.id=ze,Kt[j]=ze,xn[ze]=W,Lt.publish("addPattern",W)}};T.ShadingPattern=dd,T.TilingPattern=ef,T.addShadingPattern=function(j,W){return Y("addShadingPattern()"),Et(j,W),this},T.beginTilingPattern=function(j){Y("beginTilingPattern()"),cn(j.boundingBox[0],j.boundingBox[1],j.boundingBox[2]-j.boundingBox[0],j.boundingBox[3]-j.boundingBox[1],j.matrix)},T.endTilingPattern=function(j,W){Y("endTilingPattern()"),W.stream=et[G].join(`
`),Et(j,W),Lt.publish("endTilingPattern",W),Zi.pop().restore()};var Bt,Zt=T.__private__.newObject=function(){var j=on();return Wn(j,!0),j},on=T.__private__.newObjectDeferred=function(){return he++,re[he]=function(){return Re},he},Wn=function(j,W){return W=typeof W=="boolean"&&W,re[j]=Re,W&&se(j+" 0 obj"),j},qi=T.__private__.newAdditionalObject=function(){var j={objId:on(),content:""};return Ue.push(j),j},Sr=on(),yt=on(),si=T.__private__.decodeColorString=function(j){var W=j.split(" ");if(W.length!==2||W[1]!=="g"&&W[1]!=="G")W.length!==5||W[4]!=="k"&&W[4]!=="K"||(W=[(1-W[0])*(1-W[3]),(1-W[1])*(1-W[3]),(1-W[2])*(1-W[3]),"r"]);else{var ze=parseFloat(W[0]);W=[ze,ze,ze,"r"]}for(var Oe="#",Ie=0;Ie<3;Ie++)Oe+=("0"+Math.floor(255*parseFloat(W[Ie])).toString(16)).slice(-2);return Oe},On=T.__private__.encodeColorString=function(j){var W;typeof j=="string"&&(j={ch1:j});var ze=j.ch1,Oe=j.ch2,Ie=j.ch3,bt=j.ch4,gt=j.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ze=="string"&&ze.charAt(0)!=="#"){var dn=new ky(ze);if(dn.ok)ze=dn.toHex();else if(!/^\d*\.?\d*$/.test(ze))throw new Error('Invalid color "'+ze+'" passed to jsPDF.encodeColorString.')}if(typeof ze=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ze)&&(ze="#"+ze[1]+ze[1]+ze[2]+ze[2]+ze[3]+ze[3]),typeof ze=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ze)){var Gt=parseInt(ze.substr(1),16);ze=Gt>>16&255,Oe=Gt>>8&255,Ie=255&Gt}if(Oe===void 0||bt===void 0&&ze===Oe&&Oe===Ie)W=typeof ze=="string"?ze+" "+gt[0]:j.precision===2?F(ze/255)+" "+gt[0]:R(ze/255)+" "+gt[0];else if(bt===void 0||_r(bt)==="object"){if(bt&&!isNaN(bt.a)&&bt.a===0)return["1.","1.","1.",gt[1]].join(" ");W=typeof ze=="string"?[ze,Oe,Ie,gt[1]].join(" "):j.precision===2?[F(ze/255),F(Oe/255),F(Ie/255),gt[1]].join(" "):[R(ze/255),R(Oe/255),R(Ie/255),gt[1]].join(" ")}else W=typeof ze=="string"?[ze,Oe,Ie,bt,gt[2]].join(" "):j.precision===2?[F(ze),F(Oe),F(Ie),F(bt),gt[2]].join(" "):[R(ze),R(Oe),R(Ie),R(bt),gt[2]].join(" ");return W},Ri=T.__private__.getFilters=function(){return v},Ei=T.__private__.putStream=function(j){var W=(j=j||{}).data||"",ze=j.filters||Ri(),Oe=j.alreadyAppliedFilters||[],Ie=j.addLength1||!1,bt=W.length,gt=j.objectId,dn=function(Ji){return Ji};if(S!==null&&gt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");S!==null&&(dn=wi.encryptor(gt,0));var Gt={};ze===!0&&(ze=["FlateEncode"]);var fn=j.additionalKeyValues||[],wn=(Gt=En.API.processDataByFilters!==void 0?En.API.processDataByFilters(W,ze):{data:W,reverseChain:[]}).reverseChain+(Array.isArray(Oe)?Oe.join(" "):Oe.toString());if(Gt.data.length!==0&&(fn.push({key:"Length",value:Gt.data.length}),Ie===!0&&fn.push({key:"Length1",value:bt})),wn.length!=0)if(wn.split("/").length-1==1)fn.push({key:"Filter",value:wn});else{fn.push({key:"Filter",value:"["+wn+"]"});for(var Fn=0;Fn<fn.length;Fn+=1)if(fn[Fn].key==="DecodeParms"){for(var Mi=[],fr=0;fr<Gt.reverseChain.split("/").length-1;fr+=1)Mi.push("null");Mi.push(fn[Fn].value),fn[Fn].value="["+Mi.join(" ")+"]"}}se("<<");for(var vr=0;vr<fn.length;vr++)se("/"+fn[vr].key+" "+fn[vr].value);se(">>"),Gt.data.length!==0&&(se("stream"),se(dn(Gt.data)),se("endstream"))},bo=T.__private__.putPage=function(j){var W=j.number,ze=j.data,Oe=j.objId,Ie=j.contentsObjId;Wn(Oe,!0),se("<</Type /Page"),se("/Parent "+j.rootDictionaryObjId+" 0 R"),se("/Resources "+j.resourceDictionaryObjId+" 0 R"),se("/MediaBox ["+parseFloat(pe(j.mediaBox.bottomLeftX))+" "+parseFloat(pe(j.mediaBox.bottomLeftY))+" "+pe(j.mediaBox.topRightX)+" "+pe(j.mediaBox.topRightY)+"]"),j.cropBox!==null&&se("/CropBox ["+pe(j.cropBox.bottomLeftX)+" "+pe(j.cropBox.bottomLeftY)+" "+pe(j.cropBox.topRightX)+" "+pe(j.cropBox.topRightY)+"]"),j.bleedBox!==null&&se("/BleedBox ["+pe(j.bleedBox.bottomLeftX)+" "+pe(j.bleedBox.bottomLeftY)+" "+pe(j.bleedBox.topRightX)+" "+pe(j.bleedBox.topRightY)+"]"),j.trimBox!==null&&se("/TrimBox ["+pe(j.trimBox.bottomLeftX)+" "+pe(j.trimBox.bottomLeftY)+" "+pe(j.trimBox.topRightX)+" "+pe(j.trimBox.topRightY)+"]"),j.artBox!==null&&se("/ArtBox ["+pe(j.artBox.bottomLeftX)+" "+pe(j.artBox.bottomLeftY)+" "+pe(j.artBox.topRightX)+" "+pe(j.artBox.topRightY)+"]"),typeof j.userUnit=="number"&&j.userUnit!==1&&se("/UserUnit "+j.userUnit),Lt.publish("putPage",{objId:Oe,pageContext:ln[W],pageNumber:W,page:ze}),se("/Contents "+Ie+" 0 R"),se(">>"),se("endobj");var bt=ze.join(`
`);return H===$&&(bt+=`
Q`),Wn(Ie,!0),Ei({data:bt,filters:Ri(),objectId:Ie}),se("endobj"),Oe},ya=T.__private__.putPages=function(){var j,W,ze=[];for(j=1;j<=rt;j++)ln[j].objId=on(),ln[j].contentsObjId=on();for(j=1;j<=rt;j++)ze.push(bo({number:j,data:et[j],objId:ln[j].objId,contentsObjId:ln[j].contentsObjId,mediaBox:ln[j].mediaBox,cropBox:ln[j].cropBox,bleedBox:ln[j].bleedBox,trimBox:ln[j].trimBox,artBox:ln[j].artBox,userUnit:ln[j].userUnit,rootDictionaryObjId:Sr,resourceDictionaryObjId:yt}));Wn(Sr,!0),se("<</Type /Pages");var Oe="/Kids [";for(W=0;W<rt;W++)Oe+=ze[W]+" 0 R ";se(Oe+"]"),se("/Count "+rt),se(">>"),se("endobj"),Lt.publish("postPutPages")},Rr=function(j){Lt.publish("putFont",{font:j,out:se,newObject:Zt,putStream:Ei}),j.isAlreadyPutted!==!0&&(j.objectNumber=Zt(),se("<<"),se("/Type /Font"),se("/BaseFont /"+Qd(j.postScriptName)),se("/Subtype /Type1"),typeof j.encoding=="string"&&se("/Encoding /"+j.encoding),se("/FirstChar 32"),se("/LastChar 255"),se(">>"),se("endobj"))},Ys=function(j){j.objectNumber=Zt();var W=[];W.push({key:"Type",value:"/XObject"}),W.push({key:"Subtype",value:"/Form"}),W.push({key:"BBox",value:"["+[pe(j.x),pe(j.y),pe(j.x+j.width),pe(j.y+j.height)].join(" ")+"]"}),W.push({key:"Matrix",value:"["+j.matrix.toString()+"]"});var ze=j.pages[1].join(`
`);Ei({data:ze,additionalKeyValues:W,objectId:j.objectNumber}),se("endobj")},Jo=function(j,W){W||(W=21);var ze=Zt(),Oe=(function(gt,dn){var Gt,fn=[],wn=1/(dn-1);for(Gt=0;Gt<1;Gt+=wn)fn.push(Gt);if(fn.push(1),gt[0].offset!=0){var Fn={offset:0,color:gt[0].color};gt.unshift(Fn)}if(gt[gt.length-1].offset!=1){var Mi={offset:1,color:gt[gt.length-1].color};gt.push(Mi)}for(var fr="",vr=0,Ji=0;Ji<fn.length;Ji++){for(Gt=fn[Ji];Gt>gt[vr+1].offset;)vr++;var ia=gt[vr].offset,Gr=(Gt-ia)/(gt[vr+1].offset-ia),dl=gt[vr].color,Cr=gt[vr+1].color;fr+=ie(Math.round((1-Gr)*dl[0]+Gr*Cr[0]).toString(16))+ie(Math.round((1-Gr)*dl[1]+Gr*Cr[1]).toString(16))+ie(Math.round((1-Gr)*dl[2]+Gr*Cr[2]).toString(16))}return fr.trim()})(j.colors,W),Ie=[];Ie.push({key:"FunctionType",value:"0"}),Ie.push({key:"Domain",value:"[0.0 1.0]"}),Ie.push({key:"Size",value:"["+W+"]"}),Ie.push({key:"BitsPerSample",value:"8"}),Ie.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ie.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ei({data:Oe,additionalKeyValues:Ie,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ze}),se("endobj"),j.objectNumber=Zt(),se("<< /ShadingType "+j.type),se("/ColorSpace /DeviceRGB");var bt="/Coords ["+pe(parseFloat(j.coords[0]))+" "+pe(parseFloat(j.coords[1]))+" ";j.type===2?bt+=pe(parseFloat(j.coords[2]))+" "+pe(parseFloat(j.coords[3])):bt+=pe(parseFloat(j.coords[2]))+" "+pe(parseFloat(j.coords[3]))+" "+pe(parseFloat(j.coords[4]))+" "+pe(parseFloat(j.coords[5])),se(bt+="]"),j.matrix&&se("/Matrix ["+j.matrix.toString()+"]"),se("/Function "+ze+" 0 R"),se("/Extend [true true]"),se(">>"),se("endobj")},Qo=function(j,W){var ze=on(),Oe=Zt();W.push({resourcesOid:ze,objectOid:Oe}),j.objectNumber=Oe;var Ie=[];Ie.push({key:"Type",value:"/Pattern"}),Ie.push({key:"PatternType",value:"1"}),Ie.push({key:"PaintType",value:"1"}),Ie.push({key:"TilingType",value:"1"}),Ie.push({key:"BBox",value:"["+j.boundingBox.map(pe).join(" ")+"]"}),Ie.push({key:"XStep",value:pe(j.xStep)}),Ie.push({key:"YStep",value:pe(j.yStep)}),Ie.push({key:"Resources",value:ze+" 0 R"}),j.matrix&&Ie.push({key:"Matrix",value:"["+j.matrix.toString()+"]"}),Ei({data:j.stream,additionalKeyValues:Ie,objectId:j.objectNumber}),se("endobj")},ol=function(j){for(var W in j.objectNumber=Zt(),se("<<"),j)switch(W){case"opacity":se("/ca "+F(j[W]));break;case"stroke-opacity":se("/CA "+F(j[W]))}se(">>"),se("endobj")},es=function(j){Wn(j.resourcesOid,!0),se("<<"),se("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var W in se("/Font <<"),Qe)Qe.hasOwnProperty(W)&&(_===!1||_===!0&&E.hasOwnProperty(W))&&se("/"+W+" "+Qe[W].objectNumber+" 0 R");se(">>")})(),(function(){if(Object.keys(xn).length>0){for(var W in se("/Shading <<"),xn)xn.hasOwnProperty(W)&&xn[W]instanceof dd&&xn[W].objectNumber>=0&&se("/"+W+" "+xn[W].objectNumber+" 0 R");Lt.publish("putShadingPatternDict"),se(">>")}})(),(function(W){if(Object.keys(xn).length>0){for(var ze in se("/Pattern <<"),xn)xn.hasOwnProperty(ze)&&xn[ze]instanceof T.TilingPattern&&xn[ze].objectNumber>=0&&xn[ze].objectNumber<W&&se("/"+ze+" "+xn[ze].objectNumber+" 0 R");Lt.publish("putTilingPatternDict"),se(">>")}})(j.objectOid),(function(){if(Object.keys(Qt).length>0){var W;for(W in se("/ExtGState <<"),Qt)Qt.hasOwnProperty(W)&&Qt[W].objectNumber>=0&&se("/"+W+" "+Qt[W].objectNumber+" 0 R");Lt.publish("putGStateDict"),se(">>")}})(),(function(){for(var W in se("/XObject <<"),In)In.hasOwnProperty(W)&&In[W].objectNumber>=0&&se("/"+W+" "+In[W].objectNumber+" 0 R");Lt.publish("putXobjectDict"),se(">>")})(),se(">>"),se("endobj")},jr=function(j){At[j.fontName]=At[j.fontName]||{},At[j.fontName][j.fontStyle]=j.id},Gs=function(j,W,ze,Oe,Ie){var bt={id:"F"+(Object.keys(Qe).length+1).toString(10),postScriptName:j,fontName:W,fontStyle:ze,encoding:Oe,isStandardFont:Ie||!1,metadata:{}};return Lt.publish("addFont",{font:bt,instance:this}),Qe[bt.id]=bt,jr(bt),bt.id},Jn=T.__private__.pdfEscape=T.pdfEscape=function(j,W){return(function(ze,Oe){var Ie,bt,gt,dn,Gt,fn,wn,Fn,Mi;if(gt=(Oe=Oe||{}).sourceEncoding||"Unicode",Gt=Oe.outputEncoding,(Oe.autoencode||Gt)&&Qe[ct].metadata&&Qe[ct].metadata[gt]&&Qe[ct].metadata[gt].encoding&&(dn=Qe[ct].metadata[gt].encoding,!Gt&&Qe[ct].encoding&&(Gt=Qe[ct].encoding),!Gt&&dn.codePages&&(Gt=dn.codePages[0]),typeof Gt=="string"&&(Gt=dn[Gt]),Gt)){for(wn=!1,fn=[],Ie=0,bt=ze.length;Ie<bt;Ie++)(Fn=Gt[ze.charCodeAt(Ie)])?fn.push(String.fromCharCode(Fn)):fn.push(ze[Ie]),fn[Ie].charCodeAt(0)>>8&&(wn=!0);ze=fn.join("")}for(Ie=ze.length;wn===void 0&&Ie!==0;)ze.charCodeAt(Ie-1)>>8&&(wn=!0),Ie--;if(!wn)return ze;for(fn=Oe.noBOM?[]:[254,255],Ie=0,bt=ze.length;Ie<bt;Ie++){if((Mi=(Fn=ze.charCodeAt(Ie))>>8)>>8)throw new Error("Character at position "+Ie+" of string '"+ze+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");fn.push(Mi),fn.push(Fn-(Mi<<8))}return String.fromCharCode.apply(void 0,fn)})(j,W).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ma=T.__private__.beginPage=function(j){et[++rt]=[],ln[rt]={objId:0,contentsObjId:0,userUnit:Number(p),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(j[0]),topRightY:Number(j[1])}},Di(rt),Ot(et[G])},di=function(j,W){var ze,Oe,Ie;switch(o=W||o,typeof j=="string"&&(ze=w(j.toLowerCase()),Array.isArray(ze)&&(Oe=ze[0],Ie=ze[1])),Array.isArray(j)&&(Oe=j[0]*_t,Ie=j[1]*_t),isNaN(Oe)&&(Oe=c[0],Ie=c[1]),(Oe>14400||Ie>14400)&&(Yr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Oe=Math.min(14400,Oe),Ie=Math.min(14400,Ie)),c=[Oe,Ie],o.substr(0,1)){case"l":Ie>Oe&&(c=[Ie,Oe]);break;case"p":Oe>Ie&&(c=[Ie,Oe])}ma(c),qn(To),se(mn),_n!==0&&se(_n+" J"),Yn!==0&&se(Yn+" j"),Lt.publish("addPage",{pageNumber:rt})},As=function(j){j>0&&j<=rt&&(et.splice(j,1),ln.splice(j,1),rt--,G>rt&&(G=rt),this.setPage(G))},Di=function(j){j>0&&j<=rt&&(G=j)},zs=T.__private__.getNumberOfPages=T.getNumberOfPages=function(){return et.length-1},ir=function(j,W,ze){var Oe,Ie=void 0;return ze=ze||{},j=j!==void 0?j:Qe[ct].fontName,W=W!==void 0?W:Qe[ct].fontStyle,Oe=j.toLowerCase(),At[Oe]!==void 0&&At[Oe][W]!==void 0?Ie=At[Oe][W]:At[j]!==void 0&&At[j][W]!==void 0?Ie=At[j][W]:ze.disableWarning===!1&&Yr.warn("Unable to look up font label for font '"+j+"', '"+W+"'. Refer to getFontList() for available fonts."),Ie||ze.noFallback||(Ie=At.times[W])==null&&(Ie=At.times.normal),Ie},Na=T.__private__.putInfo=function(){var j=Zt(),W=function(Oe){return Oe};for(var ze in S!==null&&(W=wi.encryptor(j,0)),se("<<"),se("/Producer ("+Jn(W("jsPDF "+En.version))+")"),Mt)Mt.hasOwnProperty(ze)&&Mt[ze]&&se("/"+ze.substr(0,1).toUpperCase()+ze.substr(1)+" ("+Jn(W(Mt[ze]))+")");se("/CreationDate ("+Jn(W(_e))+")"),se(">>"),se("endobj")},vo=T.__private__.putCatalog=function(j){var W=(j=j||{}).rootDictionaryObjId||Sr;switch(Zt(),se("<<"),se("/Type /Catalog"),se("/Pages "+W+" 0 R"),Xe||(Xe="fullwidth"),Xe){case"fullwidth":se("/OpenAction [3 0 R /FitH null]");break;case"fullheight":se("/OpenAction [3 0 R /FitV null]");break;case"fullpage":se("/OpenAction [3 0 R /Fit]");break;case"original":se("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ze=""+Xe;ze.substr(ze.length-1)==="%"&&(Xe=parseInt(Xe)/100),typeof Xe=="number"&&se("/OpenAction [3 0 R /XYZ null null "+F(Xe)+"]")}switch(zn||(zn="continuous"),zn){case"continuous":se("/PageLayout /OneColumn");break;case"single":se("/PageLayout /SinglePage");break;case"two":case"twoleft":se("/PageLayout /TwoColumnLeft");break;case"tworight":se("/PageLayout /TwoColumnRight")}Ht&&se("/PageMode /"+Ht),Lt.publish("putCatalog"),se(">>"),se("endobj")},Ha=T.__private__.putTrailer=function(){se("trailer"),se("<<"),se("/Size "+(he+1)),se("/Root "+he+" 0 R"),se("/Info "+(he-1)+" 0 R"),S!==null&&se("/Encrypt "+wi.oid+" 0 R"),se("/ID [ <"+ce+"> <"+ce+"> ]"),se(">>")},Ti=T.__private__.putHeader=function(){se("%PDF-"+K),se("%")},Oo=T.__private__.putXRef=function(){var j="0000000000";se("xref"),se("0 "+(he+1)),se("0000000000 65535 f ");for(var W=1;W<=he;W++)typeof re[W]=="function"?se((j+re[W]()).slice(-10)+" 00000 n "):re[W]!==void 0?se((j+re[W]).slice(-10)+" 00000 n "):se("0000000000 00000 n ")},hs=T.__private__.buildDocument=function(){var j;he=0,Re=0,Le=[],re=[],Ue=[],Sr=on(),yt=on(),Ot(Le),Lt.publish("buildDocument"),Ti(),ya(),(function(){Lt.publish("putAdditionalObjects");for(var ze=0;ze<Ue.length;ze++){var Oe=Ue[ze];Wn(Oe.objId,!0),se(Oe.content),se("endobj")}Lt.publish("postPutAdditionalObjects")})(),j=[],(function(){for(var ze in Qe)Qe.hasOwnProperty(ze)&&(_===!1||_===!0&&E.hasOwnProperty(ze))&&Rr(Qe[ze])})(),(function(){var ze;for(ze in Qt)Qt.hasOwnProperty(ze)&&ol(Qt[ze])})(),(function(){for(var ze in In)In.hasOwnProperty(ze)&&Ys(In[ze])})(),(function(ze){var Oe;for(Oe in xn)xn.hasOwnProperty(Oe)&&(xn[Oe]instanceof dd?Jo(xn[Oe]):xn[Oe]instanceof ef&&Qo(xn[Oe],ze))})(j),Lt.publish("putResources"),j.forEach(es),es({resourcesOid:yt,objectOid:Number.MAX_SAFE_INTEGER}),Lt.publish("postPutResources"),S!==null&&(wi.oid=Zt(),se("<<"),se("/Filter /Standard"),se("/V "+wi.v),se("/R "+wi.r),se("/U <"+wi.toHexString(wi.U)+">"),se("/O <"+wi.toHexString(wi.O)+">"),se("/P "+wi.P),se(">>"),se("endobj")),Na(),vo();var W=Re;return Oo(),Ha(),se("startxref"),se(""+W),se("%%EOF"),Ot(et[G]),Le.join(`
`)},Tr=T.__private__.getBlob=function(j){return new Blob([Jt(j)],{type:"application/pdf"})},oo=T.output=T.__private__.output=(Bt=function(j,W){switch(typeof(W=W||{})=="string"?W={filename:W}:W.filename=W.filename||"generated.pdf",j){case void 0:return hs();case"save":T.save(W.filename);break;case"arraybuffer":return Jt(hs());case"blob":return Tr(hs());case"bloburi":case"bloburl":if(li.URL!==void 0&&typeof li.URL.createObjectURL=="function")return li.URL&&li.URL.createObjectURL(Tr(hs()))||void 0;Yr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ze="",Oe=hs();try{ze=fx(Oe)}catch{ze=fx(unescape(encodeURIComponent(Oe)))}return"data:application/pdf;filename="+W.filename+";base64,"+ze;case"pdfobjectnewwindow":if(Object.prototype.toString.call(li)==="[object Window]"){var Ie="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",bt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';W.pdfObjectUrl&&(Ie=W.pdfObjectUrl,bt="");var gt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ie+'"'+bt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(W)+");<\/script></body></html>",dn=li.open();return dn!==null&&dn.document.write(gt),dn}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(li)==="[object Window]"){var Gt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(W.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+W.filename+'" width="500px" height="400px" /></body></html>',fn=li.open();if(fn!==null){fn.document.write(Gt);var wn=this;fn.document.documentElement.querySelector("#pdfViewer").onload=function(){fn.document.title=W.filename,fn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(wn.output("bloburl"))}}return fn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(li)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Fn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",W)+'"></iframe></body></html>',Mi=li.open();if(Mi!==null&&(Mi.document.write(Fn),Mi.document.title=W.filename),Mi||typeof safari>"u")return Mi;break;case"datauri":case"dataurl":return li.document.location.href=this.output("datauristring",W);default:return null}},Bt.foo=function(){try{return Bt.apply(this,arguments)}catch(ze){var j=ze.stack||"";~j.indexOf(" at ")&&(j=j.split(" at ")[1]);var W="Error in function "+j.split(`
`)[0].split("<")[0]+": "+ze.message;if(!li.console)throw new Error(W);li.console.error(W,ze),li.alert&&alert(W)}},Bt.foo.bar=Bt,Bt.foo),vn=function(j){return Array.isArray(Zn)===!0&&Zn.indexOf(j)>-1};switch(s){case"pt":_t=1;break;case"mm":_t=72/25.4;break;case"cm":_t=72/2.54;break;case"in":_t=72;break;case"px":_t=vn("px_scaling")==1?.75:96/72;break;case"pc":case"em":_t=12;break;case"ex":_t=6;break;default:if(typeof s!="number")throw new Error("Invalid unit: "+s);_t=s}var wi=null;C(),fe();var ui=T.__private__.getPageInfo=T.getPageInfo=function(j){if(isNaN(j)||j%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:ln[j].objId,pageNumber:j,pageContext:ln[j]}},Dr=T.__private__.getPageInfoByObjId=function(j){if(isNaN(j)||j%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var W in ln)if(ln[W].objId===j)break;return ui(W)},Xs=T.__private__.getCurrentPageInfo=T.getCurrentPageInfo=function(){return{objId:ln[G].objId,pageNumber:G,pageContext:ln[G]}};T.addPage=function(){return di.apply(this,arguments),this},T.setPage=function(){return Di.apply(this,arguments),Ot.call(this,et[G]),this},T.insertPage=function(j){return this.addPage(),this.movePage(G,j),this},T.movePage=function(j,W){var ze,Oe;if(j>W){ze=et[j],Oe=ln[j];for(var Ie=j;Ie>W;Ie--)et[Ie]=et[Ie-1],ln[Ie]=ln[Ie-1];et[W]=ze,ln[W]=Oe,this.setPage(W)}else if(j<W){ze=et[j],Oe=ln[j];for(var bt=j;bt<W;bt++)et[bt]=et[bt+1],ln[bt]=ln[bt+1];et[W]=ze,ln[W]=Oe,this.setPage(W)}return this},T.deletePage=function(){return As.apply(this,arguments),this},T.__private__.text=T.text=function(j,W,ze,Oe,Ie){var bt,gt,dn,Gt,fn,wn,Fn,Mi,fr,vr=(Oe=Oe||{}).scope||this;if(typeof j=="number"&&typeof W=="number"&&(typeof ze=="string"||Array.isArray(ze))){var Ji=ze;ze=W,W=j,j=Ji}if(arguments[3]instanceof Yt==0?(dn=arguments[4],Gt=arguments[5],_r(Fn=arguments[3])==="object"&&Fn!==null||(typeof dn=="string"&&(Gt=dn,dn=null),typeof Fn=="string"&&(Gt=Fn,Fn=null),typeof Fn=="number"&&(dn=Fn,Fn=null),Oe={flags:Fn,angle:dn,align:Gt})):(Y("The transform parameter of text() with a Matrix value"),fr=Ie),isNaN(W)||isNaN(ze)||j==null)throw new Error("Invalid arguments passed to jsPDF.text");if(j.length===0)return vr;var ia,Gr="",dl=typeof Oe.lineHeightFactor=="number"?Oe.lineHeightFactor:jo,Cr=vr.internal.scaleFactor;function qo(ki){return ki=ki.split("	").join(Array(Oe.TabLen||9).join(" ")),Jn(ki,Fn)}function da(ki){for(var ri,lr=ki.concat(),Mr=[],Js=lr.length;Js--;)typeof(ri=lr.shift())=="string"?Mr.push(ri):Array.isArray(ki)&&(ri.length===1||ri[1]===void 0&&ri[2]===void 0)?Mr.push(ri[0]):Mr.push([ri[0],ri[1],ri[2]]);return Mr}function Rs(ki,ri){var lr;if(typeof ki=="string")lr=ri(ki)[0];else if(Array.isArray(ki)){for(var Mr,Js,ms=ki.concat(),Gl=[],vc=ms.length;vc--;)typeof(Mr=ms.shift())=="string"?Gl.push(ri(Mr)[0]):Array.isArray(Mr)&&typeof Mr[0]=="string"&&(Js=ri(Mr[0],Mr[1],Mr[2]),Gl.push([Js[0],Js[1],Js[2]]));lr=Gl}return lr}var Xr=!1,Co=!0;if(typeof j=="string")Xr=!0;else if(Array.isArray(j)){var ko=j.concat();gt=[];for(var Ds,Vi=ko.length;Vi--;)(typeof(Ds=ko.shift())!="string"||Array.isArray(Ds)&&typeof Ds[0]!="string")&&(Co=!1);Xr=Co}if(Xr===!1)throw new Error('Type of text must be string or Array. "'+j+'" is not recognized.');typeof j=="string"&&(j=j.match(/[\r?\n]/)?j.split(/\r\n|\r|\n/g):[j]);var ns=ht/vr.internal.scaleFactor,Kr=ns*(dl-1);switch(Oe.baseline){case"bottom":ze-=Kr;break;case"top":ze+=ns-Kr;break;case"hanging":ze+=ns-2*Kr;break;case"middle":ze+=ns/2-Kr}if((wn=Oe.maxWidth||0)>0&&(typeof j=="string"?j=vr.splitTextToSize(j,wn):Object.prototype.toString.call(j)==="[object Array]"&&(j=j.reduce(function(ki,ri){return ki.concat(vr.splitTextToSize(ri,wn))},[]))),bt={text:j,x:W,y:ze,options:Oe,mutex:{pdfEscape:Jn,activeFontKey:ct,fonts:Qe,activeFontSize:ht}},Lt.publish("preProcessText",bt),j=bt.text,dn=(Oe=bt.options).angle,fr instanceof Yt==0&&dn&&typeof dn=="number"){dn*=Math.PI/180,Oe.rotationDirection===0&&(dn=-dn),H===$&&(dn=-dn);var Ls=Math.cos(dn),Vr=Math.sin(dn);fr=new Yt(Ls,Vr,-Vr,Ls,0,0)}else dn&&dn instanceof Yt&&(fr=dn);H!==$||fr||(fr=ci),(fn=Oe.charSpace||bn)!==void 0&&(Gr+=pe(U(fn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Mi=Oe.horizontalScale)!==void 0&&(Gr+=pe(100*Mi)+` Tz
`),Oe.lang;var fa=-1,Qi=Oe.renderingMode!==void 0?Oe.renderingMode:Oe.stroke,Ms=vr.internal.getCurrentPageInfo().pageContext;switch(Qi){case 0:case!1:case"fill":fa=0;break;case 1:case!0:case"stroke":fa=1;break;case 2:case"fillThenStroke":fa=2;break;case 3:case"invisible":fa=3;break;case 4:case"fillAndAddForClipping":fa=4;break;case 5:case"strokeAndAddPathForClipping":fa=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":fa=6;break;case 7:case"addToPathForClipping":fa=7}var Uc=Ms.usedRenderingMode!==void 0?Ms.usedRenderingMode:-1;fa!==-1?Gr+=fa+` Tr
`:Uc!==-1&&(Gr+=`0 Tr
`),fa!==-1&&(Ms.usedRenderingMode=fa),Gt=Oe.align||"left";var is,No=ht*dl,xs=vr.internal.pageSize.getWidth(),Al=Qe[ct];fn=Oe.charSpace||bn,wn=Oe.maxWidth||0,Fn=Object.assign({autoencode:!0,noBOM:!0},Oe.flags);var rs=[],Ao=function(ki){return vr.getStringUnitWidth(ki,{font:Al,charSpace:fn,fontSize:ht,doKerning:!1})*ht/Cr};if(Object.prototype.toString.call(j)==="[object Array]"){var Ya;gt=da(j),Gt!=="left"&&(is=gt.map(Ao));var kr,zo=0;if(Gt==="right"){W-=is[0],j=[],Vi=gt.length;for(var so=0;so<Vi;so++)so===0?(kr=zi(W),Ya=na(ze)):(kr=U(zo-is[so]),Ya=-No),j.push([gt[so],kr,Ya]),zo=is[so]}else if(Gt==="center"){W-=is[0]/2,j=[],Vi=gt.length;for(var Is=0;Is<Vi;Is++)Is===0?(kr=zi(W),Ya=na(ze)):(kr=U((zo-is[Is])/2),Ya=-No),j.push([gt[Is],kr,Ya]),zo=is[Is]}else if(Gt==="left"){j=[],Vi=gt.length;for(var Bs=0;Bs<Vi;Bs++)j.push(gt[Bs])}else if(Gt==="justify"&&Al.encoding==="Identity-H"){j=[],Vi=gt.length,wn=wn!==0?wn:xs;for(var zl=0,pr=0;pr<Vi;pr++)if(Ya=pr===0?na(ze):-No,kr=pr===0?zi(W):zl,pr<Vi-1){var bc=U((wn-is[pr])/(gt[pr].split(" ").length-1)),Po=gt[pr].split(" ");j.push([Po[0]+" ",kr,Ya]),zl=0;for(var Ci=1;Ci<Po.length;Ci++){var Hr=(Ao(Po[Ci-1]+" "+Po[Ci])-Ao(Po[Ci]))*Cr+bc;Ci==Po.length-1?j.push([Po[Ci],Hr,0]):j.push([Po[Ci]+" ",Hr,0]),zl-=Hr}}else j.push([gt[pr],kr,Ya]);j.push(["",zl,0])}else{if(Gt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(j=[],Vi=gt.length,wn=wn!==0?wn:xs,pr=0;pr<Vi;pr++){Ya=pr===0?na(ze):-No,kr=pr===0?zi(W):0;var Yi=gt[pr].split(" ").length-1,Es=Yi>0?(wn-is[pr])/Yi:0;pr<Vi-1?rs.push(pe(U(Es))):rs.push(0),j.push([gt[pr],kr,Ya])}}}(typeof Oe.R2L=="boolean"?Oe.R2L:an)===!0&&(j=Rs(j,function(ki,ri,lr){return[ki.split("").reverse().join(""),ri,lr]})),bt={text:j,x:W,y:ze,options:Oe,mutex:{pdfEscape:Jn,activeFontKey:ct,fonts:Qe,activeFontSize:ht}},Lt.publish("postProcessText",bt),j=bt.text,ia=bt.mutex.isHex||!1;var Pl=Qe[ct].encoding;Pl!=="WinAnsiEncoding"&&Pl!=="StandardEncoding"||(j=Rs(j,function(ki,ri,lr){return[qo(ki),ri,lr]})),gt=da(j),j=[];for(var Vo,fl,ys,Yl=Array.isArray(gt[0])?1:0,as="",Ga=function(ki,ri,lr){var Mr="";return lr instanceof Yt?(lr=typeof Oe.angle=="number"?jn(lr,new Yt(1,0,0,1,ki,ri)):jn(new Yt(1,0,0,1,ki,ri),lr),H===$&&(lr=jn(new Yt(1,0,0,-1,0,0),lr)),Mr=lr.join(" ")+` Tm
`):Mr=pe(ki)+" "+pe(ri)+` Td
`,Mr},_a=0;_a<gt.length;_a++){switch(as="",Yl){case 1:ys=(ia?"<":"(")+gt[_a][0]+(ia?">":")"),Vo=parseFloat(gt[_a][1]),fl=parseFloat(gt[_a][2]);break;case 0:ys=(ia?"<":"(")+gt[_a]+(ia?">":")"),Vo=zi(W),fl=na(ze)}rs!==void 0&&rs[_a]!==void 0&&(as=rs[_a]+` Tw
`),_a===0?j.push(as+Ga(Vo,fl,fr)+ys):Yl===0?j.push(as+ys):Yl===1&&j.push(as+Ga(Vo,fl,fr)+ys)}j=Yl===0?j.join(` Tj
T* `):j.join(` Tj
`),j+=` Tj
`;var _o=`BT
/`;return _o+=ct+" "+ht+` Tf
`,_o+=pe(ht*dl)+` TL
`,_o+=ts+`
`,_o+=Gr,_o+=j,se(_o+="ET"),E[ct]=!0,vr};var sl=T.__private__.clip=T.clip=function(j){return se(j==="evenodd"?"W*":"W"),this};T.clipEvenOdd=function(){return sl("evenodd")},T.__private__.discardPath=T.discardPath=function(){return se("n"),this};var dr=T.__private__.isValidStyle=function(j){var W=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(j)!==-1&&(W=!0),W};T.__private__.setDefaultPathOperation=T.setDefaultPathOperation=function(j){return dr(j)&&(m=j),this};var Aa=T.__private__.getStyle=T.getStyle=function(j){var W=m;switch(j){case"D":case"S":W="S";break;case"F":W="f";break;case"FD":case"DF":W="B";break;case"f":case"f*":case"B":case"B*":W=j}return W},Ps=T.close=function(){return se("h"),this};T.stroke=function(){return se("S"),this},T.fill=function(j){return wo("f",j),this},T.fillEvenOdd=function(j){return wo("f*",j),this},T.fillStroke=function(j){return wo("B",j),this},T.fillStrokeEvenOdd=function(j){return wo("B*",j),this};var wo=function(j,W){_r(W)==="object"?Ft(W,j):se(j)},Ks=function(j){j===null||H===$&&j===void 0||(j=Aa(j),se(j))};function So(j,W,ze,Oe,Ie){var bt=new ef(W||this.boundingBox,ze||this.xStep,Oe||this.yStep,this.gState,Ie||this.matrix);bt.stream=this.stream;var gt=j+"$$"+this.cloneIndex+++"$$";return Et(gt,bt),bt}var Ft=function(j,W){var ze=Kt[j.key],Oe=xn[ze];if(Oe instanceof dd)se("q"),se(br(W)),Oe.gState&&T.setGState(Oe.gState),se(j.matrix.toString()+" cm"),se("/"+ze+" sh"),se("Q");else if(Oe instanceof ef){var Ie=new Yt(1,0,0,-1,0,_s());j.matrix&&(Ie=Ie.multiply(j.matrix||ci),ze=So.call(Oe,j.key,j.boundingBox,j.xStep,j.yStep,Ie).id),se("q"),se("/Pattern cs"),se("/"+ze+" scn"),Oe.gState&&T.setGState(Oe.gState),se(W),se("Q")}},br=function(j){switch(j){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},za=T.moveTo=function(j,W){return se(pe(U(j))+" "+pe(O(W))+" m"),this},Fo=T.lineTo=function(j,W){return se(pe(U(j))+" "+pe(O(W))+" l"),this},rr=T.curveTo=function(j,W,ze,Oe,Ie,bt){return se([pe(U(j)),pe(O(W)),pe(U(ze)),pe(O(Oe)),pe(U(Ie)),pe(O(bt)),"c"].join(" ")),this};T.__private__.line=T.line=function(j,W,ze,Oe,Ie){if(isNaN(j)||isNaN(W)||isNaN(ze)||isNaN(Oe)||!dr(Ie))throw new Error("Invalid arguments passed to jsPDF.line");return H===Se?this.lines([[ze-j,Oe-W]],j,W,[1,1],Ie||"S"):this.lines([[ze-j,Oe-W]],j,W,[1,1]).stroke()},T.__private__.lines=T.lines=function(j,W,ze,Oe,Ie,bt){var gt,dn,Gt,fn,wn,Fn,Mi,fr,vr,Ji,ia,Gr;if(typeof j=="number"&&(Gr=ze,ze=W,W=j,j=Gr),Oe=Oe||[1,1],bt=bt||!1,isNaN(W)||isNaN(ze)||!Array.isArray(j)||!Array.isArray(Oe)||!dr(Ie)||typeof bt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(za(W,ze),gt=Oe[0],dn=Oe[1],fn=j.length,Ji=W,ia=ze,Gt=0;Gt<fn;Gt++)(wn=j[Gt]).length===2?(Ji=wn[0]*gt+Ji,ia=wn[1]*dn+ia,Fo(Ji,ia)):(Fn=wn[0]*gt+Ji,Mi=wn[1]*dn+ia,fr=wn[2]*gt+Ji,vr=wn[3]*dn+ia,Ji=wn[4]*gt+Ji,ia=wn[5]*dn+ia,rr(Fn,Mi,fr,vr,Ji,ia));return bt&&Ps(),Ks(Ie),this},T.path=function(j){for(var W=0;W<j.length;W++){var ze=j[W],Oe=ze.c;switch(ze.op){case"m":za(Oe[0],Oe[1]);break;case"l":Fo(Oe[0],Oe[1]);break;case"c":rr.apply(this,Oe);break;case"h":Ps()}}return this},T.__private__.rect=T.rect=function(j,W,ze,Oe,Ie){if(isNaN(j)||isNaN(W)||isNaN(ze)||isNaN(Oe)||!dr(Ie))throw new Error("Invalid arguments passed to jsPDF.rect");return H===Se&&(Oe=-Oe),se([pe(U(j)),pe(O(W)),pe(U(ze)),pe(U(Oe)),"re"].join(" ")),Ks(Ie),this},T.__private__.triangle=T.triangle=function(j,W,ze,Oe,Ie,bt,gt){if(isNaN(j)||isNaN(W)||isNaN(ze)||isNaN(Oe)||isNaN(Ie)||isNaN(bt)||!dr(gt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ze-j,Oe-W],[Ie-ze,bt-Oe],[j-Ie,W-bt]],j,W,[1,1],gt,!0),this},T.__private__.roundedRect=T.roundedRect=function(j,W,ze,Oe,Ie,bt,gt){if(isNaN(j)||isNaN(W)||isNaN(ze)||isNaN(Oe)||isNaN(Ie)||isNaN(bt)||!dr(gt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var dn=4/3*(Math.SQRT2-1);return Ie=Math.min(Ie,.5*ze),bt=Math.min(bt,.5*Oe),this.lines([[ze-2*Ie,0],[Ie*dn,0,Ie,bt-bt*dn,Ie,bt],[0,Oe-2*bt],[0,bt*dn,-Ie*dn,bt,-Ie,bt],[2*Ie-ze,0],[-Ie*dn,0,-Ie,-bt*dn,-Ie,-bt],[0,2*bt-Oe],[0,-bt*dn,Ie*dn,-bt,Ie,-bt]],j+Ie,W,[1,1],gt,!0),this},T.__private__.ellipse=T.ellipse=function(j,W,ze,Oe,Ie){if(isNaN(j)||isNaN(W)||isNaN(ze)||isNaN(Oe)||!dr(Ie))throw new Error("Invalid arguments passed to jsPDF.ellipse");var bt=4/3*(Math.SQRT2-1)*ze,gt=4/3*(Math.SQRT2-1)*Oe;return za(j+ze,W),rr(j+ze,W-gt,j+bt,W-Oe,j,W-Oe),rr(j-bt,W-Oe,j-ze,W-gt,j-ze,W),rr(j-ze,W+gt,j-bt,W+Oe,j,W+Oe),rr(j+bt,W+Oe,j+ze,W+gt,j+ze,W),Ks(Ie),this},T.__private__.circle=T.circle=function(j,W,ze,Oe){if(isNaN(j)||isNaN(W)||isNaN(ze)||!dr(Oe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(j,W,ze,ze,Oe)},T.setFont=function(j,W,ze){return ze&&(W=oe(W,ze)),ct=ir(j,W,{disableWarning:!1}),this};var ba=T.__private__.getFont=T.getFont=function(){return Qe[ir.apply(T,arguments)]};T.__private__.getFontList=T.getFontList=function(){var j,W,ze={};for(j in At)if(At.hasOwnProperty(j))for(W in ze[j]=[],At[j])At[j].hasOwnProperty(W)&&ze[j].push(W);return ze},T.addFont=function(j,W,ze,Oe,Ie){var bt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&bt.indexOf(arguments[3])!==-1?Ie=arguments[3]:arguments[3]&&bt.indexOf(arguments[3])==-1&&(ze=oe(ze,Oe)),Gs.call(this,j,W,ze,Ie=Ie||"Identity-H")};var jo,To=i.lineWidth||.200025,ll=T.__private__.getLineWidth=T.getLineWidth=function(){return To},qn=T.__private__.setLineWidth=T.setLineWidth=function(j){return To=j,se(pe(U(j))+" w"),this};T.__private__.setLineDash=En.API.setLineDash=En.API.setLineDashPattern=function(j,W){if(j=j||[],W=W||0,isNaN(W)||!Array.isArray(j))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return j=j.map(function(ze){return pe(U(ze))}).join(" "),W=pe(U(W)),se("["+j+"] "+W+" d"),this};var Ec=T.__private__.getLineHeight=T.getLineHeight=function(){return ht*jo};T.__private__.getLineHeight=T.getLineHeight=function(){return ht*jo};var $l=T.__private__.setLineHeightFactor=T.setLineHeightFactor=function(j){return typeof(j=j||1.15)=="number"&&(jo=j),this},Lr=T.__private__.getLineHeightFactor=T.getLineHeightFactor=function(){return jo};$l(i.lineHeight);var zi=T.__private__.getHorizontalCoordinate=function(j){return U(j)},na=T.__private__.getVerticalCoordinate=function(j){return H===$?j:ln[G].mediaBox.topRightY-ln[G].mediaBox.bottomLeftY-U(j)},Oc=T.__private__.getHorizontalCoordinateString=T.getHorizontalCoordinateString=function(j){return pe(zi(j))},ii=T.__private__.getVerticalCoordinateString=T.getVerticalCoordinateString=function(j){return pe(na(j))},mn=i.strokeColor||"0 G";T.__private__.getStrokeColor=T.getDrawColor=function(){return si(mn)},T.__private__.setStrokeColor=T.setDrawColor=function(j,W,ze,Oe){return mn=On({ch1:j,ch2:W,ch3:ze,ch4:Oe,pdfColorType:"draw",precision:2}),se(mn),this};var Zs=i.fillColor||"0 g";T.__private__.getFillColor=T.getFillColor=function(){return si(Zs)},T.__private__.setFillColor=T.setFillColor=function(j,W,ze,Oe){return Zs=On({ch1:j,ch2:W,ch3:ze,ch4:Oe,pdfColorType:"fill",precision:2}),se(Zs),this};var ts=i.textColor||"0 g",$n=T.__private__.getTextColor=T.getTextColor=function(){return si(ts)};T.__private__.setTextColor=T.setTextColor=function(j,W,ze,Oe){return ts=On({ch1:j,ch2:W,ch3:ze,ch4:Oe,pdfColorType:"text",precision:3}),this};var bn=i.charSpace,mi=T.__private__.getCharSpace=T.getCharSpace=function(){return parseFloat(bn||0)};T.__private__.setCharSpace=T.setCharSpace=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return bn=j,this};var _n=0;T.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},T.__private__.setLineCap=T.setLineCap=function(j){var W=T.CapJoinStyles[j];if(W===void 0)throw new Error("Line cap style of '"+j+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return _n=W,se(W+" J"),this};var Yn=0;T.__private__.setLineJoin=T.setLineJoin=function(j){var W=T.CapJoinStyles[j];if(W===void 0)throw new Error("Line join style of '"+j+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Yn=W,se(W+" j"),this},T.__private__.setLineMiterLimit=T.__private__.setMiterLimit=T.setLineMiterLimit=T.setMiterLimit=function(j){if(j=j||0,isNaN(j))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return se(pe(U(j))+" M"),this},T.GState=dh,T.setGState=function(j){(j=typeof j=="string"?Qt[hn[j]]:Tn(null,j)).equals(Xn)||(se("/"+j.id+" gs"),Xn=j)};var Tn=function(j,W){if(!j||!hn[j]){var ze=!1;for(var Oe in Qt)if(Qt.hasOwnProperty(Oe)&&Qt[Oe].equals(W)){ze=!0;break}if(ze)W=Qt[Oe];else{var Ie="GS"+(Object.keys(Qt).length+1).toString(10);Qt[Ie]=W,W.id=Ie}return j&&(hn[j]=W.id),Lt.publish("addGState",W),W}};T.addGState=function(j,W){return Tn(j,W),this},T.saveGraphicsState=function(){return se("q"),un.push({key:ct,size:ht,color:ts}),this},T.restoreGraphicsState=function(){se("Q");var j=un.pop();return ct=j.key,ht=j.size,ts=j.color,Xn=null,this},T.setCurrentTransformationMatrix=function(j){return se(j.toString()+" cm"),this},T.comment=function(j){return se("#"+j),this};var gs=function(j,W){var ze=j||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ze},set:function(bt){isNaN(bt)||(ze=parseFloat(bt))}});var Oe=W||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Oe},set:function(bt){isNaN(bt)||(Oe=parseFloat(bt))}});var Ie="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ie},set:function(bt){Ie=bt.toString()}}),this},tn=function(j,W,ze,Oe){gs.call(this,j,W),this.type="rect";var Ie=ze||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ie},set:function(gt){isNaN(gt)||(Ie=parseFloat(gt))}});var bt=Oe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return bt},set:function(gt){isNaN(gt)||(bt=parseFloat(gt))}}),this},Li=function(){this.page=rt,this.currentPage=G,this.pages=et.slice(0),this.pagesContext=ln.slice(0),this.x=Ze,this.y=jt,this.matrix=en,this.width=Wa(G),this.height=Pa(G),this.outputDestination=Ct,this.id="",this.objectNumber=-1};Li.prototype.restore=function(){rt=this.page,G=this.currentPage,ln=this.pagesContext,et=this.pages,Ze=this.x,jt=this.y,en=this.matrix,cl(G,this.width),Uo(G,this.height),Ct=this.outputDestination};var cn=function(j,W,ze,Oe,Ie){Zi.push(new Li),rt=G=0,et=[],Ze=j,jt=W,en=Ie,ma([ze,Oe])};for(var Si in T.beginFormObject=function(j,W,ze,Oe,Ie){return cn(j,W,ze,Oe,Ie),this},T.endFormObject=function(j){return(function(W){if(wr[W])Zi.pop().restore();else{var ze=new Li,Oe="Xo"+(Object.keys(In).length+1).toString(10);ze.id=Oe,wr[W]=Oe,In[Oe]=ze,Lt.publish("addFormObject",ze),Zi.pop().restore()}})(j),this},T.doFormObject=function(j,W){var ze=In[wr[j]];return se("q"),se(W.toString()+" cm"),se("/"+ze.id+" Do"),se("Q"),this},T.getFormObject=function(j){var W=In[wr[j]];return{x:W.x,y:W.y,width:W.width,height:W.height,matrix:W.matrix}},T.save=function(j,W){return j=j||"generated.pdf",(W=W||{}).returnPromise=W.returnPromise||!1,W.returnPromise===!1?(ud(Tr(hs()),j),typeof ud.unload=="function"&&li.setTimeout&&setTimeout(ud.unload,911),this):new Promise(function(ze,Oe){try{var Ie=ud(Tr(hs()),j);typeof ud.unload=="function"&&li.setTimeout&&setTimeout(ud.unload,911),ze(Ie)}catch(bt){Oe(bt.message)}})},En.API)En.API.hasOwnProperty(Si)&&(Si==="events"&&En.API.events.length?(function(j,W){var ze,Oe,Ie;for(Ie=W.length-1;Ie!==-1;Ie--)ze=W[Ie][0],Oe=W[Ie][1],j.subscribe.apply(j,[ze].concat(typeof Oe=="function"?[Oe]:Oe))})(Lt,En.API.events):T[Si]=En.API[Si]);function Wa(j){return ln[j].mediaBox.topRightX-ln[j].mediaBox.bottomLeftX}function cl(j,W){ln[j].mediaBox.topRightX=W+ln[j].mediaBox.bottomLeftX}function Pa(j){return ln[j].mediaBox.topRightY-ln[j].mediaBox.bottomLeftY}function Uo(j,W){ln[j].mediaBox.topRightY=W+ln[j].mediaBox.bottomLeftY}var $a=T.getPageWidth=function(j){return Wa(j=j||G)/_t},ul=T.setPageWidth=function(j,W){cl(j,W*_t)},_s=T.getPageHeight=function(j){return Pa(j=j||G)/_t},Fc=T.setPageHeight=function(j,W){Uo(j,W*_t)};return T.internal={pdfEscape:Jn,getStyle:Aa,getFont:ba,getFontSize:Ut,getCharSpace:mi,getTextColor:$n,getLineHeight:Ec,getLineHeightFactor:Lr,getLineWidth:ll,write:kt,getHorizontalCoordinate:zi,getVerticalCoordinate:na,getCoordinateString:Oc,getVerticalCoordinateString:ii,collections:{},newObject:Zt,newAdditionalObject:qi,newObjectDeferred:on,newObjectDeferredBegin:Wn,getFilters:Ri,putStream:Ei,events:Lt,scaleFactor:_t,pageSize:{getWidth:function(){return $a(G)},setWidth:function(j){ul(G,j)},getHeight:function(){return _s(G)},setHeight:function(j){Fc(G,j)}},encryptionOptions:S,encryption:wi,getEncryptor:function(j){return S!==null?wi.encryptor(j,0):function(W){return W}},output:oo,getNumberOfPages:zs,get pages(){return et},out:se,f2:F,f3:R,getPageInfo:ui,getPageInfoByObjId:Dr,getCurrentPageInfo:Xs,getPDFVersion:D,Point:gs,Rectangle:tn,Matrix:Yt,hasHotfix:vn},Object.defineProperty(T.internal.pageSize,"width",{get:function(){return $a(G)},set:function(j){ul(G,j)},enumerable:!0,configurable:!0}),Object.defineProperty(T.internal.pageSize,"height",{get:function(){return _s(G)},set:function(j){Fc(G,j)},enumerable:!0,configurable:!0}),(function(j){for(var W=0,ze=Wt.length;W<ze;W++){var Oe=Gs.call(this,j[W][0],j[W][1],j[W][2],Wt[W][3],!0);_===!1&&(E[Oe]=!0);var Ie=j[W][0].split("-");jr({id:Oe,fontName:Ie[0],fontStyle:Ie[1]||""})}Lt.publish("addFonts",{fonts:Qe,dictionary:At})}).call(T,Wt),ct="F1",di(c,o),Lt.publish("initialized"),T}Jd.prototype.lsbFirstWord=function(i){return String.fromCharCode(255&i,i>>8&255,i>>16&255,i>>24&255)},Jd.prototype.toHexString=function(i){return i.split("").map(function(r){return("0"+(255&r.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Jd.prototype.hexToBytes=function(i){for(var r=[],o=0;o<i.length;o+=2)r.push(String.fromCharCode(parseInt(i.substr(o,2),16)));return r.join("")},Jd.prototype.processOwnerPassword=function(i,r){return qg(Ug(r).substr(0,5),i)},Jd.prototype.encryptor=function(i,r){var o=Ug(this.encryptionKey+String.fromCharCode(255&i,i>>8&255,i>>16&255,255&r,r>>8&255)).substr(0,10);return function(s){return qg(o,s)}},dh.prototype.equals=function(i){var r,o="id,objectNumber,equals";if(!i||_r(i)!==_r(this))return!1;var s=0;for(r in this)if(!(o.indexOf(r)>=0)){if(this.hasOwnProperty(r)&&!i.hasOwnProperty(r)||this[r]!==i[r])return!1;s++}for(r in i)i.hasOwnProperty(r)&&o.indexOf(r)<0&&s--;return s===0},En.API={events:[]},En.version="3.0.4";var Va=En.API,Jg=1,xd=function(i){return i.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Gd=function(i){return i.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},yi=function(i){return i.toFixed(2)},Fu=function(i){return i.toFixed(5)};Va.__acroform__={};var al=function(i,r){i.prototype=Object.create(r.prototype),i.prototype.constructor=i},xx=function(i){return i*Jg},Mc=function(i){var r=new Py,o=An.internal.getHeight(i)||0,s=An.internal.getWidth(i)||0;return r.BBox=[0,0,Number(yi(s)),Number(yi(o))],r},O5=Va.__acroform__.setBit=function(i,r){if(i=i||0,r=r||0,isNaN(i)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return i|1<<r},F5=Va.__acroform__.clearBit=function(i,r){if(i=i||0,r=r||0,isNaN(i)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return i&~(1<<r)},U5=Va.__acroform__.getBit=function(i,r){if(isNaN(i)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return i&1<<r?1:0},io=Va.__acroform__.getBitForPdf=function(i,r){if(isNaN(i)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return U5(i,r-1)},ro=Va.__acroform__.setBitForPdf=function(i,r){if(isNaN(i)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return O5(i,r-1)},ao=Va.__acroform__.clearBitForPdf=function(i,r){if(isNaN(i)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return F5(i,r-1)},q5=Va.__acroform__.calculateCoordinates=function(i,r){var o=r.internal.getHorizontalCoordinate,s=r.internal.getVerticalCoordinate,c=i[0],d=i[1],v=i[2],p=i[3],g={};return g.lowerLeft_X=o(c)||0,g.lowerLeft_Y=s(d+p)||0,g.upperRight_X=o(c+v)||0,g.upperRight_Y=s(d)||0,[Number(yi(g.lowerLeft_X)),Number(yi(g.lowerLeft_Y)),Number(yi(g.upperRight_X)),Number(yi(g.upperRight_Y))]},V5=function(i){if(i.appearanceStreamContent)return i.appearanceStreamContent;if(i.V||i.DV){var r=[],o=i._V||i.DV,s=Vg(i,o),c=i.scope.internal.getFont(i.fontName,i.fontStyle).id;r.push("/Tx BMC"),r.push("q"),r.push("BT"),r.push(i.scope.__private__.encodeColorString(i.color)),r.push("/"+c+" "+yi(s.fontSize)+" Tf"),r.push("1 0 0 1 0 0 Tm"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC");var d=Mc(i);return d.scope=i.scope,d.stream=r.join(`
`),d}},Vg=function(i,r){var o=i.fontSize===0?i.maxFontSize:i.fontSize,s={text:"",fontSize:""},c=(r=(r=r.substr(0,1)=="("?r.substr(1):r).substr(r.length-1)==")"?r.substr(0,r.length-1):r).split(" ");c=i.multiline?c.map(function(F){return F.split(`
`)}):c.map(function(F){return[F]});var d=o,v=An.internal.getHeight(i)||0;v=v<0?-v:v;var p=An.internal.getWidth(i)||0;p=p<0?-p:p;var g=function(F,R,U){if(F+1<c.length){var O=R+" "+c[F+1][0];return Zp(O,i,U).width<=p-4}return!1};d++;e:for(;d>0;){r="",d--;var m,S,_=Zp("3",i,d).height,E=i.multiline?v-d:(v-_)/2,T=E+=2,K=0,D=0,ee=0;if(d<=0){r=`(...) Tj
`,r+="% Width of Text: "+Zp(r,i,d=12).width+", FieldWidth:"+p+`
`;break}for(var w="",Se=0,$=0;$<c.length;$++)if(c.hasOwnProperty($)){var H=!1;if(c[$].length!==1&&ee!==c[$].length-1){if((_+2)*(Se+2)+2>v)continue e;w+=c[$][ee],H=!0,D=$,$--}else{w=(w+=c[$][ee]+" ").substr(w.length-1)==" "?w.substr(0,w.length-1):w;var ae=parseInt($),I=g(ae,w,d),oe=$>=c.length-1;if(I&&!oe){w+=" ",ee=0;continue}if(I||oe){if(oe)D=ae;else if(i.multiline&&(_+2)*(Se+2)+2>v)continue e}else{if(!i.multiline||(_+2)*(Se+2)+2>v)continue e;D=ae}}for(var pe="",Y=K;Y<=D;Y++){var X=c[Y];if(i.multiline){if(Y===D){pe+=X[ee]+" ",ee=(ee+1)%X.length;continue}if(Y===K){pe+=X[X.length-1]+" ";continue}}pe+=X[0]+" "}switch(pe=pe.substr(pe.length-1)==" "?pe.substr(0,pe.length-1):pe,S=Zp(pe,i,d).width,i.textAlign){case"right":m=p-S-2;break;case"center":m=(p-S)/2;break;default:m=2}r+=yi(m)+" "+yi(T)+` Td
`,r+="("+xd(pe)+`) Tj
`,r+=-yi(m)+` 0 Td
`,T=-(d+2),S=0,K=H?D:D+1,Se++,w=""}break}return s.text=r,s.fontSize=d,s},Zp=function(i,r,o){var s=r.scope.internal.getFont(r.fontName,r.fontStyle),c=r.scope.getStringUnitWidth(i,{font:s,fontSize:parseFloat(o),charSpace:0})*parseFloat(o);return{height:r.scope.getStringUnitWidth("3",{font:s,fontSize:parseFloat(o),charSpace:0})*parseFloat(o)*1.5,width:c}},H5={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},W5=function(i,r){var o={type:"reference",object:i};r.internal.getPageInfo(i.page).pageContext.annotations.find(function(s){return s.type===o.type&&s.object===o.object})===void 0&&r.internal.getPageInfo(i.page).pageContext.annotations.push(o)},$5=function(i,r){if(r.scope=i,i.internal!==void 0&&(i.internal.acroformPlugin===void 0||i.internal.acroformPlugin.isInitialized===!1)){if(yc.FieldNum=0,i.internal.acroformPlugin=JSON.parse(JSON.stringify(H5)),i.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Jg=i.internal.scaleFactor,i.internal.acroformPlugin.acroFormDictionaryRoot=new _y,i.internal.acroformPlugin.acroFormDictionaryRoot.scope=i,i.internal.acroformPlugin.acroFormDictionaryRoot._eventID=i.internal.events.subscribe("postPutResources",function(){(function(o){o.internal.events.unsubscribe(o.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete o.internal.acroformPlugin.acroFormDictionaryRoot._eventID,o.internal.acroformPlugin.printedOut=!0})(i)}),i.internal.events.subscribe("buildDocument",function(){(function(o){o.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var s=o.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var c in s)if(s.hasOwnProperty(c)){var d=s[c];d.objId=void 0,d.hasAnnotation&&W5(d,o)}})(i)}),i.internal.events.subscribe("putCatalog",function(){(function(o){if(o.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");o.internal.write("/AcroForm "+o.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(i)}),i.internal.events.subscribe("postPutPages",function(o){(function(s,c){var d=!s;for(var v in s||(c.internal.newObjectDeferredBegin(c.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),c.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),s=s||c.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(s.hasOwnProperty(v)){var p=s[v],g=[],m=p.Rect;if(p.Rect&&(p.Rect=q5(p.Rect,c)),c.internal.newObjectDeferredBegin(p.objId,!0),p.DA=An.createDefaultAppearanceStream(p),_r(p)==="object"&&typeof p.getKeyValueListForStream=="function"&&(g=p.getKeyValueListForStream()),p.Rect=m,p.hasAppearanceStream&&!p.appearanceStreamContent){var S=V5(p);g.push({key:"AP",value:"<</N "+S+">>"}),c.internal.acroformPlugin.xForms.push(S)}if(p.appearanceStreamContent){var _="";for(var E in p.appearanceStreamContent)if(p.appearanceStreamContent.hasOwnProperty(E)){var T=p.appearanceStreamContent[E];if(_+="/"+E+" ",_+="<<",Object.keys(T).length>=1||Array.isArray(T)){for(var v in T)if(T.hasOwnProperty(v)){var K=T[v];typeof K=="function"&&(K=K.call(c,p)),_+="/"+v+" "+K+" ",c.internal.acroformPlugin.xForms.indexOf(K)>=0||c.internal.acroformPlugin.xForms.push(K)}}else typeof(K=T)=="function"&&(K=K.call(c,p)),_+="/"+v+" "+K,c.internal.acroformPlugin.xForms.indexOf(K)>=0||c.internal.acroformPlugin.xForms.push(K);_+=">>"}g.push({key:"AP",value:`<<
`+_+">>"})}c.internal.putStream({additionalKeyValues:g,objectId:p.objId}),c.internal.out("endobj")}d&&(function(D,ee){for(var w in D)if(D.hasOwnProperty(w)){var Se=w,$=D[w];ee.internal.newObjectDeferredBegin($.objId,!0),_r($)==="object"&&typeof $.putStream=="function"&&$.putStream(),delete D[Se]}})(c.internal.acroformPlugin.xForms,c)})(o,i)}),i.internal.acroformPlugin.isInitialized=!0}},zy=Va.__acroform__.arrayToPdfArray=function(i,r,o){var s=function(v){return v};if(Array.isArray(i)){for(var c="[",d=0;d<i.length;d++)switch(d!==0&&(c+=" "),_r(i[d])){case"boolean":case"number":case"object":c+=i[d].toString();break;case"string":i[d].substr(0,1)!=="/"?(r!==void 0&&o&&(s=o.internal.getEncryptor(r)),c+="("+xd(s(i[d].toString()))+")"):c+=i[d].toString()}return c+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Tg=function(i,r,o){var s=function(c){return c};return r!==void 0&&o&&(s=o.internal.getEncryptor(r)),(i=i||"").toString(),"("+xd(s(i))+")"},Ic=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(i){this._objId=i}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Ic.prototype.toString=function(){return this.objId+" 0 R"},Ic.prototype.putStream=function(){var i=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:i,objectId:this.objId}),this.scope.internal.out("endobj")},Ic.prototype.getKeyValueListForStream=function(){var i=[],r=Object.getOwnPropertyNames(this).filter(function(d){return d!="content"&&d!="appearanceStreamContent"&&d!="scope"&&d!="objId"&&d.substring(0,1)!="_"});for(var o in r)if(Object.getOwnPropertyDescriptor(this,r[o]).configurable===!1){var s=r[o],c=this[s];c&&(Array.isArray(c)?i.push({key:s,value:zy(c,this.objId,this.scope)}):c instanceof Ic?(c.scope=this.scope,i.push({key:s,value:c.objId+" 0 R"})):typeof c!="function"&&i.push({key:s,value:c}))}return i};var Py=function(){Ic.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var i,r=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return r},set:function(o){r=o}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(o){i=o.trim()},get:function(){return i||null}})};al(Py,Ic);var _y=function(){Ic.call(this);var i,r=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return r.length>0?r:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return r}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(i){var o=function(s){return s};return this.scope&&(o=this.scope.internal.getEncryptor(this.objId)),"("+xd(o(i))+")"}},set:function(o){i=o}})};al(_y,Ic);var yc=function i(){Ic.call(this);var r=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return r},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute F supplied.');r=w}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!io(r,3)},set:function(w){w?this.F=ro(r,3):this.F=ao(r,3)}});var o=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return o},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute Ff supplied.');o=w}});var s=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(s.length!==0)return s},set:function(w){s=w!==void 0?w:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[0])?0:s[0]},set:function(w){s[0]=w}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[1])?0:s[1]},set:function(w){s[1]=w}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[2])?0:s[2]},set:function(w){s[2]=w}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[3])?0:s[3]},set:function(w){s[3]=w}});var c="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return c},set:function(w){switch(w){case"/Btn":case"/Tx":case"/Ch":case"/Sig":c=w;break;default:throw new Error('Invalid value "'+w+'" for attribute FT supplied.')}}});var d=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!d||d.length<1){if(this instanceof fh)return;d="FieldObject"+i.FieldNum++}var w=function(Se){return Se};return this.scope&&(w=this.scope.internal.getEncryptor(this.objId)),"("+xd(w(d))+")"},set:function(w){d=w.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return d},set:function(w){d=w}});var v="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return v},set:function(w){v=w}});var p="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return p},set:function(w){p=w}});var g=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return g},set:function(w){g=w}});var m=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return m===void 0?50/Jg:m},set:function(w){m=w}});var S="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return S},set:function(w){S=w}});var _="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!_||this instanceof fh||this instanceof fd))return Tg(_,this.objId,this.scope)},set:function(w){w=w.toString(),_=w}});var E=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(E)return this instanceof Zo==0?Tg(E,this.objId,this.scope):E},set:function(w){w=w.toString(),E=this instanceof Zo==0?w.substr(0,1)==="("?Gd(w.substr(1,w.length-2)):Gd(w):w}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Zo==1?Gd(E.substr(1,E.length-1)):E},set:function(w){w=w.toString(),E=this instanceof Zo==1?"/"+w:w}});var T=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(T)return T},set:function(w){this.V=w}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(T)return this instanceof Zo==0?Tg(T,this.objId,this.scope):T},set:function(w){w=w.toString(),T=this instanceof Zo==0?w.substr(0,1)==="("?Gd(w.substr(1,w.length-2)):Gd(w):w}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Zo==1?Gd(T.substr(1,T.length-1)):T},set:function(w){w=w.toString(),T=this instanceof Zo==1?"/"+w:w}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var K,D=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return D},set:function(w){w=!!w,D=w}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(K)return K},set:function(w){K=w}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!io(this.Ff,1)},set:function(w){w?this.Ff=ro(this.Ff,1):this.Ff=ao(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!io(this.Ff,2)},set:function(w){w?this.Ff=ro(this.Ff,2):this.Ff=ao(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!io(this.Ff,3)},set:function(w){w?this.Ff=ro(this.Ff,3):this.Ff=ao(this.Ff,3)}});var ee=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(ee!==null)return ee},set:function(w){if([0,1,2].indexOf(w)===-1)throw new Error('Invalid value "'+w+'" for attribute Q supplied.');ee=w}}),Object.defineProperty(this,"textAlign",{get:function(){var w;switch(ee){case 0:default:w="left";break;case 1:w="center";break;case 2:w="right"}return w},configurable:!0,enumerable:!0,set:function(w){switch(w){case"right":case 2:ee=2;break;case"center":case 1:ee=1;break;default:ee=0}}})};al(yc,Ic);var nf=function(){yc.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var i=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return i},set:function(o){i=o}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return i},set:function(o){i=o}});var r=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return zy(r,this.objId,this.scope)},set:function(o){var s,c;c=[],typeof(s=o)=="string"&&(c=(function(d,v,p){p||(p=1);for(var g,m=[];g=v.exec(d);)m.push(g[p]);return m})(s,/\((.*?)\)/g)),r=c}}),this.getOptions=function(){return r},this.setOptions=function(o){r=o,this.sort&&r.sort()},this.addOption=function(o){o=(o=o||"").toString(),r.push(o),this.sort&&r.sort()},this.removeOption=function(o,s){for(s=s||!1,o=(o=o||"").toString();r.indexOf(o)!==-1&&(r.splice(r.indexOf(o),1),s!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!io(this.Ff,18)},set:function(o){o?this.Ff=ro(this.Ff,18):this.Ff=ao(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!io(this.Ff,19)},set:function(o){this.combo===!0&&(o?this.Ff=ro(this.Ff,19):this.Ff=ao(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!io(this.Ff,20)},set:function(o){o?(this.Ff=ro(this.Ff,20),r.sort()):this.Ff=ao(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!io(this.Ff,22)},set:function(o){o?this.Ff=ro(this.Ff,22):this.Ff=ao(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!io(this.Ff,23)},set:function(o){o?this.Ff=ro(this.Ff,23):this.Ff=ao(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!io(this.Ff,27)},set:function(o){o?this.Ff=ro(this.Ff,27):this.Ff=ao(this.Ff,27)}}),this.hasAppearanceStream=!1};al(nf,yc);var rf=function(){nf.call(this),this.fontName="helvetica",this.combo=!1};al(rf,nf);var af=function(){rf.call(this),this.combo=!0};al(af,rf);var rh=function(){af.call(this),this.edit=!0};al(rh,af);var Zo=function(){yc.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!io(this.Ff,15)},set:function(o){o?this.Ff=ro(this.Ff,15):this.Ff=ao(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!io(this.Ff,16)},set:function(o){o?this.Ff=ro(this.Ff,16):this.Ff=ao(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!io(this.Ff,17)},set:function(o){o?this.Ff=ro(this.Ff,17):this.Ff=ao(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!io(this.Ff,26)},set:function(o){o?this.Ff=ro(this.Ff,26):this.Ff=ao(this.Ff,26)}});var i,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var o=function(d){return d};if(this.scope&&(o=this.scope.internal.getEncryptor(this.objId)),Object.keys(r).length!==0){var s,c=[];for(s in c.push("<<"),r)c.push("/"+s+" ("+xd(o(r[s]))+")");return c.push(">>"),c.join(`
`)}},set:function(o){_r(o)==="object"&&(r=o)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(o){typeof o=="string"&&(r.CA=o)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return i},set:function(o){i=o}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return i.substr(1,i.length-1)},set:function(o){i="/"+o}})};al(Zo,yc);var ah=function(){Zo.call(this),this.pushButton=!0};al(ah,Zo);var of=function(){Zo.call(this),this.radio=!0,this.pushButton=!1;var i=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return i},set:function(r){i=r!==void 0?r:[]}})};al(of,Zo);var fh=function(){var i,r;yc.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return i},set:function(c){i=c}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return r},set:function(c){r=c}});var o,s={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var c=function(p){return p};this.scope&&(c=this.scope.internal.getEncryptor(this.objId));var d,v=[];for(d in v.push("<<"),s)v.push("/"+d+" ("+xd(c(s[d]))+")");return v.push(">>"),v.join(`
`)},set:function(c){_r(c)==="object"&&(s=c)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return s.CA||""},set:function(c){typeof c=="string"&&(s.CA=c)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return o},set:function(c){o=c}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return o.substr(1,o.length-1)},set:function(c){o="/"+c}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=An.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};al(fh,yc),of.prototype.setAppearance=function(i){if(!("createAppearanceStream"in i)||!("getCA"in i))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var r in this.Kids)if(this.Kids.hasOwnProperty(r)){var o=this.Kids[r];o.appearanceStreamContent=i.createAppearanceStream(o.optionName),o.caption=i.getCA()}},of.prototype.createOption=function(i){var r=new fh;return r.Parent=this,r.optionName=i,this.Kids.push(r),Y5.call(this.scope,r),r};var oh=function(){Zo.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=An.CheckBox.createAppearanceStream()};al(oh,Zo);var fd=function(){yc.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!io(this.Ff,13)},set:function(r){r?this.Ff=ro(this.Ff,13):this.Ff=ao(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!io(this.Ff,21)},set:function(r){r?this.Ff=ro(this.Ff,21):this.Ff=ao(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!io(this.Ff,23)},set:function(r){r?this.Ff=ro(this.Ff,23):this.Ff=ao(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!io(this.Ff,24)},set:function(r){r?this.Ff=ro(this.Ff,24):this.Ff=ao(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!io(this.Ff,25)},set:function(r){r?this.Ff=ro(this.Ff,25):this.Ff=ao(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!io(this.Ff,26)},set:function(r){r?this.Ff=ro(this.Ff,26):this.Ff=ao(this.Ff,26)}});var i=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return i},set:function(r){i=r}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return i},set:function(r){Number.isInteger(r)&&(i=r)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};al(fd,yc);var sh=function(){fd.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!io(this.Ff,14)},set:function(i){i?this.Ff=ro(this.Ff,14):this.Ff=ao(this.Ff,14)}}),this.password=!0};al(sh,fd);var An={CheckBox:{createAppearanceStream:function(){return{N:{On:An.CheckBox.YesNormal},D:{On:An.CheckBox.YesPushDown,Off:An.CheckBox.OffPushDown}}},YesPushDown:function(i){var r=Mc(i);r.scope=i.scope;var o=[],s=i.scope.internal.getFont(i.fontName,i.fontStyle).id,c=i.scope.__private__.encodeColorString(i.color),d=Vg(i,i.caption);return o.push("0.749023 g"),o.push("0 0 "+yi(An.internal.getWidth(i))+" "+yi(An.internal.getHeight(i))+" re"),o.push("f"),o.push("BMC"),o.push("q"),o.push("0 0 1 rg"),o.push("/"+s+" "+yi(d.fontSize)+" Tf "+c),o.push("BT"),o.push(d.text),o.push("ET"),o.push("Q"),o.push("EMC"),r.stream=o.join(`
`),r},YesNormal:function(i){var r=Mc(i);r.scope=i.scope;var o=i.scope.internal.getFont(i.fontName,i.fontStyle).id,s=i.scope.__private__.encodeColorString(i.color),c=[],d=An.internal.getHeight(i),v=An.internal.getWidth(i),p=Vg(i,i.caption);return c.push("1 g"),c.push("0 0 "+yi(v)+" "+yi(d)+" re"),c.push("f"),c.push("q"),c.push("0 0 1 rg"),c.push("0 0 "+yi(v-1)+" "+yi(d-1)+" re"),c.push("W"),c.push("n"),c.push("0 g"),c.push("BT"),c.push("/"+o+" "+yi(p.fontSize)+" Tf "+s),c.push(p.text),c.push("ET"),c.push("Q"),r.stream=c.join(`
`),r},OffPushDown:function(i){var r=Mc(i);r.scope=i.scope;var o=[];return o.push("0.749023 g"),o.push("0 0 "+yi(An.internal.getWidth(i))+" "+yi(An.internal.getHeight(i))+" re"),o.push("f"),r.stream=o.join(`
`),r}},RadioButton:{Circle:{createAppearanceStream:function(i){var r={D:{Off:An.RadioButton.Circle.OffPushDown},N:{}};return r.N[i]=An.RadioButton.Circle.YesNormal,r.D[i]=An.RadioButton.Circle.YesPushDown,r},getCA:function(){return"l"},YesNormal:function(i){var r=Mc(i);r.scope=i.scope;var o=[],s=An.internal.getWidth(i)<=An.internal.getHeight(i)?An.internal.getWidth(i)/4:An.internal.getHeight(i)/4;s=Number((.9*s).toFixed(5));var c=An.internal.Bezier_C,d=Number((s*c).toFixed(5));return o.push("q"),o.push("1 0 0 1 "+Fu(An.internal.getWidth(i)/2)+" "+Fu(An.internal.getHeight(i)/2)+" cm"),o.push(s+" 0 m"),o.push(s+" "+d+" "+d+" "+s+" 0 "+s+" c"),o.push("-"+d+" "+s+" -"+s+" "+d+" -"+s+" 0 c"),o.push("-"+s+" -"+d+" -"+d+" -"+s+" 0 -"+s+" c"),o.push(d+" -"+s+" "+s+" -"+d+" "+s+" 0 c"),o.push("f"),o.push("Q"),r.stream=o.join(`
`),r},YesPushDown:function(i){var r=Mc(i);r.scope=i.scope;var o=[],s=An.internal.getWidth(i)<=An.internal.getHeight(i)?An.internal.getWidth(i)/4:An.internal.getHeight(i)/4;s=Number((.9*s).toFixed(5));var c=Number((2*s).toFixed(5)),d=Number((c*An.internal.Bezier_C).toFixed(5)),v=Number((s*An.internal.Bezier_C).toFixed(5));return o.push("0.749023 g"),o.push("q"),o.push("1 0 0 1 "+Fu(An.internal.getWidth(i)/2)+" "+Fu(An.internal.getHeight(i)/2)+" cm"),o.push(c+" 0 m"),o.push(c+" "+d+" "+d+" "+c+" 0 "+c+" c"),o.push("-"+d+" "+c+" -"+c+" "+d+" -"+c+" 0 c"),o.push("-"+c+" -"+d+" -"+d+" -"+c+" 0 -"+c+" c"),o.push(d+" -"+c+" "+c+" -"+d+" "+c+" 0 c"),o.push("f"),o.push("Q"),o.push("0 g"),o.push("q"),o.push("1 0 0 1 "+Fu(An.internal.getWidth(i)/2)+" "+Fu(An.internal.getHeight(i)/2)+" cm"),o.push(s+" 0 m"),o.push(s+" "+v+" "+v+" "+s+" 0 "+s+" c"),o.push("-"+v+" "+s+" -"+s+" "+v+" -"+s+" 0 c"),o.push("-"+s+" -"+v+" -"+v+" -"+s+" 0 -"+s+" c"),o.push(v+" -"+s+" "+s+" -"+v+" "+s+" 0 c"),o.push("f"),o.push("Q"),r.stream=o.join(`
`),r},OffPushDown:function(i){var r=Mc(i);r.scope=i.scope;var o=[],s=An.internal.getWidth(i)<=An.internal.getHeight(i)?An.internal.getWidth(i)/4:An.internal.getHeight(i)/4;s=Number((.9*s).toFixed(5));var c=Number((2*s).toFixed(5)),d=Number((c*An.internal.Bezier_C).toFixed(5));return o.push("0.749023 g"),o.push("q"),o.push("1 0 0 1 "+Fu(An.internal.getWidth(i)/2)+" "+Fu(An.internal.getHeight(i)/2)+" cm"),o.push(c+" 0 m"),o.push(c+" "+d+" "+d+" "+c+" 0 "+c+" c"),o.push("-"+d+" "+c+" -"+c+" "+d+" -"+c+" 0 c"),o.push("-"+c+" -"+d+" -"+d+" -"+c+" 0 -"+c+" c"),o.push(d+" -"+c+" "+c+" -"+d+" "+c+" 0 c"),o.push("f"),o.push("Q"),r.stream=o.join(`
`),r}},Cross:{createAppearanceStream:function(i){var r={D:{Off:An.RadioButton.Cross.OffPushDown},N:{}};return r.N[i]=An.RadioButton.Cross.YesNormal,r.D[i]=An.RadioButton.Cross.YesPushDown,r},getCA:function(){return"8"},YesNormal:function(i){var r=Mc(i);r.scope=i.scope;var o=[],s=An.internal.calculateCross(i);return o.push("q"),o.push("1 1 "+yi(An.internal.getWidth(i)-2)+" "+yi(An.internal.getHeight(i)-2)+" re"),o.push("W"),o.push("n"),o.push(yi(s.x1.x)+" "+yi(s.x1.y)+" m"),o.push(yi(s.x2.x)+" "+yi(s.x2.y)+" l"),o.push(yi(s.x4.x)+" "+yi(s.x4.y)+" m"),o.push(yi(s.x3.x)+" "+yi(s.x3.y)+" l"),o.push("s"),o.push("Q"),r.stream=o.join(`
`),r},YesPushDown:function(i){var r=Mc(i);r.scope=i.scope;var o=An.internal.calculateCross(i),s=[];return s.push("0.749023 g"),s.push("0 0 "+yi(An.internal.getWidth(i))+" "+yi(An.internal.getHeight(i))+" re"),s.push("f"),s.push("q"),s.push("1 1 "+yi(An.internal.getWidth(i)-2)+" "+yi(An.internal.getHeight(i)-2)+" re"),s.push("W"),s.push("n"),s.push(yi(o.x1.x)+" "+yi(o.x1.y)+" m"),s.push(yi(o.x2.x)+" "+yi(o.x2.y)+" l"),s.push(yi(o.x4.x)+" "+yi(o.x4.y)+" m"),s.push(yi(o.x3.x)+" "+yi(o.x3.y)+" l"),s.push("s"),s.push("Q"),r.stream=s.join(`
`),r},OffPushDown:function(i){var r=Mc(i);r.scope=i.scope;var o=[];return o.push("0.749023 g"),o.push("0 0 "+yi(An.internal.getWidth(i))+" "+yi(An.internal.getHeight(i))+" re"),o.push("f"),r.stream=o.join(`
`),r}}},createDefaultAppearanceStream:function(i){var r=i.scope.internal.getFont(i.fontName,i.fontStyle).id,o=i.scope.__private__.encodeColorString(i.color);return"/"+r+" "+i.fontSize+" Tf "+o}};An.internal={Bezier_C:.551915024494,calculateCross:function(i){var r=An.internal.getWidth(i),o=An.internal.getHeight(i),s=Math.min(r,o);return{x1:{x:(r-s)/2,y:(o-s)/2+s},x2:{x:(r-s)/2+s,y:(o-s)/2},x3:{x:(r-s)/2,y:(o-s)/2},x4:{x:(r-s)/2+s,y:(o-s)/2+s}}}},An.internal.getWidth=function(i){var r=0;return _r(i)==="object"&&(r=xx(i.Rect[2])),r},An.internal.getHeight=function(i){var r=0;return _r(i)==="object"&&(r=xx(i.Rect[3])),r};var Y5=Va.addField=function(i){if($5(this,i),!(i instanceof yc))throw new Error("Invalid argument passed to jsPDF.addField.");var r;return(r=i).scope.internal.acroformPlugin.printedOut&&(r.scope.internal.acroformPlugin.printedOut=!1,r.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),r.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(r),i.page=i.scope.internal.getCurrentPageInfo().pageNumber,this};Va.AcroFormChoiceField=nf,Va.AcroFormListBox=rf,Va.AcroFormComboBox=af,Va.AcroFormEditBox=rh,Va.AcroFormButton=Zo,Va.AcroFormPushButton=ah,Va.AcroFormRadioButton=of,Va.AcroFormCheckBox=oh,Va.AcroFormTextField=fd,Va.AcroFormPasswordField=sh,Va.AcroFormAppearance=An,Va.AcroForm={ChoiceField:nf,ListBox:rf,ComboBox:af,EditBox:rh,Button:Zo,PushButton:ah,RadioButton:of,CheckBox:oh,TextField:fd,PasswordField:sh,Appearance:An},En.AcroForm={ChoiceField:nf,ListBox:rf,ComboBox:af,EditBox:rh,Button:Zo,PushButton:ah,RadioButton:of,CheckBox:oh,TextField:fd,PasswordField:sh,Appearance:An};En.AcroForm;function Ry(i){return i.reduce(function(r,o,s){return r[o]=s,r},{})}(function(i){var r="addImage_";i.__addimage__={};var o="UNKNOWN",s={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},c=i.__addimage__.getImageFileTypeByImageData=function(F,R){var U,O,_e,ce,xe,fe=o;if((R=R||o)==="RGBA"||F.data!==void 0&&F.data instanceof Uint8ClampedArray&&"height"in F&&"width"in F)return"RGBA";if(I(F))for(xe in s)for(_e=s[xe],U=0;U<_e.length;U+=1){for(ce=!0,O=0;O<_e[U].length;O+=1)if(_e[U][O]!==void 0&&_e[U][O]!==F[O]){ce=!1;break}if(ce===!0){fe=xe;break}}else for(xe in s)for(_e=s[xe],U=0;U<_e.length;U+=1){for(ce=!0,O=0;O<_e[U].length;O+=1)if(_e[U][O]!==void 0&&_e[U][O]!==F.charCodeAt(O)){ce=!1;break}if(ce===!0){fe=xe;break}}return fe===o&&R!==o&&(fe=R),fe},d=function F(R){for(var U=this.internal.write,O=this.internal.putStream,_e=(0,this.internal.getFilters)();_e.indexOf("FlateEncode")!==-1;)_e.splice(_e.indexOf("FlateEncode"),1);R.objectId=this.internal.newObject();var ce=[];if(ce.push({key:"Type",value:"/XObject"}),ce.push({key:"Subtype",value:"/Image"}),ce.push({key:"Width",value:R.width}),ce.push({key:"Height",value:R.height}),R.colorSpace===w.INDEXED?ce.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(R.palette.length/3-1)+" "+("sMask"in R&&R.sMask!==void 0?R.objectId+2:R.objectId+1)+" 0 R]"}):(ce.push({key:"ColorSpace",value:"/"+R.colorSpace}),R.colorSpace===w.DEVICE_CMYK&&ce.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ce.push({key:"BitsPerComponent",value:R.bitsPerComponent}),"decodeParameters"in R&&R.decodeParameters!==void 0&&ce.push({key:"DecodeParms",value:"<<"+R.decodeParameters+">>"}),"transparency"in R&&Array.isArray(R.transparency)&&R.transparency.length>0){for(var xe="",fe=0,ke=R.transparency.length;fe<ke;fe++)xe+=R.transparency[fe]+" "+R.transparency[fe]+" ";ce.push({key:"Mask",value:"["+xe+"]"})}R.sMask!==void 0&&ce.push({key:"SMask",value:R.objectId+1+" 0 R"});var de=R.filter!==void 0?["/"+R.filter]:void 0;if(O({data:R.data,additionalKeyValues:ce,alreadyAppliedFilters:de,objectId:R.objectId}),U("endobj"),"sMask"in R&&R.sMask!==void 0){var C,z=(C=R.sMaskBitsPerComponent)!==null&&C!==void 0?C:R.bitsPerComponent,G={width:R.width,height:R.height,colorSpace:"DeviceGray",bitsPerComponent:z,data:R.sMask};"filter"in R&&(G.decodeParameters="/Predictor ".concat(R.predictor," /Colors 1 /BitsPerComponent ").concat(z," /Columns ").concat(R.width),G.filter=R.filter),F.call(this,G)}if(R.colorSpace===w.INDEXED){var V=this.internal.newObject();O({data:pe(new Uint8Array(R.palette)),objectId:V}),U("endobj")}},v=function(){var F=this.internal.collections[r+"images"];for(var R in F)d.call(this,F[R])},p=function(){var F,R=this.internal.collections[r+"images"],U=this.internal.write;for(var O in R)U("/I"+(F=R[O]).index,F.objectId,"0","R")},g=function(){this.internal.collections[r+"images"]||(this.internal.collections[r+"images"]={},this.internal.events.subscribe("putResources",v),this.internal.events.subscribe("putXobjectDict",p))},m=function(){var F=this.internal.collections[r+"images"];return g.call(this),F},S=function(){return Object.keys(this.internal.collections[r+"images"]).length},_=function(F){return typeof i["process"+F.toUpperCase()]=="function"},E=function(F){return _r(F)==="object"&&F.nodeType===1},T=function(F,R){if(F.nodeName==="IMG"&&F.hasAttribute("src")){var U=""+F.getAttribute("src");if(U.indexOf("data:image/")===0)return ih(unescape(U).split("base64,").pop());var O=i.loadFile(U,!0);if(O!==void 0)return O}if(F.nodeName==="CANVAS"){if(F.width===0||F.height===0)throw new Error("Given canvas must have data. Canvas width: "+F.width+", height: "+F.height);var _e;switch(R){case"PNG":_e="image/png";break;case"WEBP":_e="image/webp";break;default:_e="image/jpeg"}return ih(F.toDataURL(_e,1).split("base64,").pop())}},K=function(F){var R=this.internal.collections[r+"images"];if(R){for(var U in R)if(F===R[U].alias)return R[U]}},D=function(F,R,U){return F||R||(F=-96,R=-96),F<0&&(F=-1*U.width*72/F/this.internal.scaleFactor),R<0&&(R=-1*U.height*72/R/this.internal.scaleFactor),F===0&&(F=R*U.width/U.height),R===0&&(R=F*U.height/U.width),[F,R]},ee=function(F,R,U,O,_e,ce){var xe=D.call(this,U,O,_e),fe=this.internal.getCoordinateString,ke=this.internal.getVerticalCoordinateString,de=m.call(this);if(U=xe[0],O=xe[1],de[_e.index]=_e,ce){ce*=Math.PI/180;var C=Math.cos(ce),z=Math.sin(ce),G=function(ie){return ie.toFixed(4)},V=[G(C),G(z),G(-1*z),G(C),0,0,"cm"]}this.internal.write("q"),ce?(this.internal.write([1,"0","0",1,fe(F),ke(R+O),"cm"].join(" ")),this.internal.write(V.join(" ")),this.internal.write([fe(U),"0","0",fe(O),"0","0","cm"].join(" "))):this.internal.write([fe(U),"0","0",fe(O),fe(F),ke(R+O),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+_e.index+" Do"),this.internal.write("Q")},w=i.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};i.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var Se=i.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},$=i.__addimage__.sHashCode=function(F){var R,U,O=0;if(typeof F=="string")for(U=F.length,R=0;R<U;R++)O=(O<<5)-O+F.charCodeAt(R),O|=0;else if(I(F))for(U=F.byteLength/2,R=0;R<U;R++)O=(O<<5)-O+F[R],O|=0;return O},H=i.__addimage__.validateStringAsBase64=function(F){(F=F||"").toString().trim();var R=!0;return F.length===0&&(R=!1),F.length%4!=0&&(R=!1),/^[A-Za-z0-9+/]+$/.test(F.substr(0,F.length-2))===!1&&(R=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(F.substr(-2))===!1&&(R=!1),R},ae=i.__addimage__.extractImageFromDataUrl=function(F){if(F==null||!(F=F.trim()).startsWith("data:"))return null;var R=F.indexOf(",");return R<0?null:F.substring(0,R).trim().endsWith("base64")?F.substring(R+1):null};i.__addimage__.isArrayBuffer=function(F){return F instanceof ArrayBuffer};var I=i.__addimage__.isArrayBufferView=function(F){return F instanceof Int8Array||F instanceof Uint8Array||F instanceof Uint8ClampedArray||F instanceof Int16Array||F instanceof Uint16Array||F instanceof Int32Array||F instanceof Uint32Array||F instanceof Float32Array||F instanceof Float64Array},oe=i.__addimage__.binaryStringToUint8Array=function(F){for(var R=F.length,U=new Uint8Array(R),O=0;O<R;O++)U[O]=F.charCodeAt(O);return U},pe=i.__addimage__.arrayBufferToBinaryString=function(F){for(var R="",U=I(F)?F:new Uint8Array(F),O=0;O<U.length;O+=8192)R+=String.fromCharCode.apply(null,U.subarray(O,O+8192));return R};i.addImage=function(){var F,R,U,O,_e,ce,xe,fe,ke;if(typeof arguments[1]=="number"?(R=o,U=arguments[1],O=arguments[2],_e=arguments[3],ce=arguments[4],xe=arguments[5],fe=arguments[6],ke=arguments[7]):(R=arguments[1],U=arguments[2],O=arguments[3],_e=arguments[4],ce=arguments[5],xe=arguments[6],fe=arguments[7],ke=arguments[8]),_r(F=arguments[0])==="object"&&!E(F)&&"imageData"in F){var de=F;F=de.imageData,R=de.format||R||o,U=de.x||U||0,O=de.y||O||0,_e=de.w||de.width||_e,ce=de.h||de.height||ce,xe=de.alias||xe,fe=de.compression||fe,ke=de.rotation||de.angle||ke}var C=this.internal.getFilters();if(fe===void 0&&C.indexOf("FlateEncode")!==-1&&(fe="SLOW"),isNaN(U)||isNaN(O))throw new Error("Invalid coordinates passed to jsPDF.addImage");g.call(this);var z=Y.call(this,F,R,xe,fe);return ee.call(this,U,O,_e,ce,z,ke),this};var Y=function(F,R,U,O){var _e,ce,xe;if(typeof F=="string"&&c(F)===o){F=unescape(F);var fe=X(F,!1);(fe!==""||(fe=i.loadFile(F,!0))!==void 0)&&(F=fe)}if(E(F)&&(F=T(F,R)),R=c(F,R),!_(R))throw new Error("addImage does not support files of type '"+R+"', please ensure that a plugin for '"+R+"' support is added.");if(((xe=U)==null||xe.length===0)&&(U=(function(ke){return typeof ke=="string"||I(ke)?$(ke):I(ke.data)?$(ke.data):null})(F)),(_e=K.call(this,U))||(F instanceof Uint8Array||R==="RGBA"||(ce=F,F=oe(F)),_e=this["process"+R.toUpperCase()](F,S.call(this),U,(function(ke){return ke&&typeof ke=="string"&&(ke=ke.toUpperCase()),ke in i.image_compression?ke:Se.NONE})(O),ce)),!_e)throw new Error("An unknown error occurred whilst processing the image.");return _e},X=i.__addimage__.convertBase64ToBinaryString=function(F,R){R=typeof R!="boolean"||R;var U,O="";if(typeof F=="string"){var _e;U=(_e=ae(F))!==null&&_e!==void 0?_e:F;try{O=ih(U)}catch(ce){if(R)throw H(U)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ce.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return O};i.getImageProperties=function(F){var R,U,O="";if(E(F)&&(F=T(F)),typeof F=="string"&&c(F)===o&&((O=X(F,!1))===""&&(O=i.loadFile(F)||""),F=O),U=c(F),!_(U))throw new Error("addImage does not support files of type '"+U+"', please ensure that a plugin for '"+U+"' support is added.");if(F instanceof Uint8Array||(F=oe(F)),!(R=this["process"+U.toUpperCase()](F)))throw new Error("An unknown error occurred whilst processing the image");return R.fileType=U,R}})(En.API),(function(i){var r=function(o){if(o!==void 0&&o!="")return!0};En.API.events.push(["addPage",function(o){this.internal.getPageInfo(o.pageNumber).pageContext.annotations=[]}]),i.events.push(["putPage",function(o){for(var s,c,d,v=this.internal.getCoordinateString,p=this.internal.getVerticalCoordinateString,g=this.internal.getPageInfoByObjId(o.objId),m=o.pageContext.annotations,S=!1,_=0;_<m.length&&!S;_++)switch((s=m[_]).type){case"link":(r(s.options.url)||r(s.options.pageNumber))&&(S=!0);break;case"reference":case"text":case"freetext":S=!0}if(S!=0){this.internal.write("/Annots [");for(var E=0;E<m.length;E++){s=m[E];var T=this.internal.pdfEscape,K=this.internal.getEncryptor(o.objId);switch(s.type){case"reference":this.internal.write(" "+s.object.objId+" 0 R ");break;case"text":var D=this.internal.newAdditionalObject(),ee=this.internal.newAdditionalObject(),w=this.internal.getEncryptor(D.objId),Se=s.title||"Note";d="<</Type /Annot /Subtype /Text "+(c="/Rect ["+v(s.bounds.x)+" "+p(s.bounds.y+s.bounds.h)+" "+v(s.bounds.x+s.bounds.w)+" "+p(s.bounds.y)+"] ")+"/Contents ("+T(w(s.contents))+")",d+=" /Popup "+ee.objId+" 0 R",d+=" /P "+g.objId+" 0 R",d+=" /T ("+T(w(Se))+") >>",D.content=d;var $=D.objId+" 0 R";d="<</Type /Annot /Subtype /Popup "+(c="/Rect ["+v(s.bounds.x+30)+" "+p(s.bounds.y+s.bounds.h)+" "+v(s.bounds.x+s.bounds.w+30)+" "+p(s.bounds.y)+"] ")+" /Parent "+$,s.open&&(d+=" /Open true"),d+=" >>",ee.content=d,this.internal.write(D.objId,"0 R",ee.objId,"0 R");break;case"freetext":c="/Rect ["+v(s.bounds.x)+" "+p(s.bounds.y)+" "+v(s.bounds.x+s.bounds.w)+" "+p(s.bounds.y+s.bounds.h)+"] ";var H=s.color||"#000000";d="<</Type /Annot /Subtype /FreeText "+c+"/Contents ("+T(K(s.contents))+")",d+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+H+")",d+=" /Border [0 0 0]",d+=" >>",this.internal.write(d);break;case"link":if(s.options.name){var ae=this.annotations._nameMap[s.options.name];s.options.pageNumber=ae.page,s.options.top=ae.y}else s.options.top||(s.options.top=0);if(c="/Rect ["+s.finalBounds.x+" "+s.finalBounds.y+" "+s.finalBounds.w+" "+s.finalBounds.h+"] ",d="",s.options.url)d="<</Type /Annot /Subtype /Link "+c+"/Border [0 0 0] /A <</S /URI /URI ("+T(K(s.options.url))+") >>";else if(s.options.pageNumber)switch(d="<</Type /Annot /Subtype /Link "+c+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(s.options.pageNumber).objId+" 0 R",s.options.magFactor=s.options.magFactor||"XYZ",s.options.magFactor){case"Fit":d+=" /Fit]";break;case"FitH":d+=" /FitH "+s.options.top+"]";break;case"FitV":s.options.left=s.options.left||0,d+=" /FitV "+s.options.left+"]";break;default:var I=p(s.options.top);s.options.left=s.options.left||0,s.options.zoom===void 0&&(s.options.zoom=0),d+=" /XYZ "+s.options.left+" "+I+" "+s.options.zoom+"]"}d!=""&&(d+=" >>",this.internal.write(d))}}this.internal.write("]")}}]),i.createAnnotation=function(o){var s=this.internal.getCurrentPageInfo();switch(o.type){case"link":this.link(o.bounds.x,o.bounds.y,o.bounds.w,o.bounds.h,o);break;case"text":case"freetext":s.pageContext.annotations.push(o)}},i.link=function(o,s,c,d,v){var p=this.internal.getCurrentPageInfo(),g=this.internal.getCoordinateString,m=this.internal.getVerticalCoordinateString;p.pageContext.annotations.push({finalBounds:{x:g(o),y:m(s),w:g(o+c),h:m(s+d)},options:v,type:"link"})},i.textWithLink=function(o,s,c,d){var v,p,g=this.getTextWidth(o),m=this.internal.getLineHeight()/this.internal.scaleFactor;if(d.maxWidth!==void 0){p=d.maxWidth;var S=this.splitTextToSize(o,p).length;v=Math.ceil(m*S)}else p=g,v=m;return this.text(o,s,c,d),c+=.2*m,d.align==="center"&&(s-=g/2),d.align==="right"&&(s-=g),this.link(s,c-m,p,v,d),g},i.getTextWidth=function(o){var s=this.internal.getFontSize();return this.getStringUnitWidth(o)*s/this.internal.scaleFactor}})(En.API),(function(i){var r={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},o={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},s={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},c=[1570,1571,1573,1575];i.__arabicParser__={};var d=i.__arabicParser__.isInArabicSubstitutionA=function(D){return r[D.charCodeAt(0)]!==void 0},v=i.__arabicParser__.isArabicLetter=function(D){return typeof D=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(D)},p=i.__arabicParser__.isArabicEndLetter=function(D){return v(D)&&d(D)&&r[D.charCodeAt(0)].length<=2},g=i.__arabicParser__.isArabicAlfLetter=function(D){return v(D)&&c.indexOf(D.charCodeAt(0))>=0};i.__arabicParser__.arabicLetterHasIsolatedForm=function(D){return v(D)&&d(D)&&r[D.charCodeAt(0)].length>=1};var m=i.__arabicParser__.arabicLetterHasFinalForm=function(D){return v(D)&&d(D)&&r[D.charCodeAt(0)].length>=2};i.__arabicParser__.arabicLetterHasInitialForm=function(D){return v(D)&&d(D)&&r[D.charCodeAt(0)].length>=3};var S=i.__arabicParser__.arabicLetterHasMedialForm=function(D){return v(D)&&d(D)&&r[D.charCodeAt(0)].length==4},_=i.__arabicParser__.resolveLigatures=function(D){var ee=0,w=o,Se="",$=0;for(ee=0;ee<D.length;ee+=1)w[D.charCodeAt(ee)]!==void 0?($++,typeof(w=w[D.charCodeAt(ee)])=="number"&&(Se+=String.fromCharCode(w),w=o,$=0),ee===D.length-1&&(w=o,Se+=D.charAt(ee-($-1)),ee-=$-1,$=0)):(w=o,Se+=D.charAt(ee-$),ee-=$,$=0);return Se};i.__arabicParser__.isArabicDiacritic=function(D){return D!==void 0&&s[D.charCodeAt(0)]!==void 0};var E=i.__arabicParser__.getCorrectForm=function(D,ee,w){return v(D)?d(D)===!1?-1:!m(D)||!v(ee)&&!v(w)||!v(w)&&p(ee)||p(D)&&!v(ee)||p(D)&&g(ee)||p(D)&&p(ee)?0:S(D)&&v(ee)&&!p(ee)&&v(w)&&m(w)?3:p(D)||!v(w)?1:2:-1},T=function(D){var ee=0,w=0,Se=0,$="",H="",ae="",I=(D=D||"").split("\\s+"),oe=[];for(ee=0;ee<I.length;ee+=1){for(oe.push(""),w=0;w<I[ee].length;w+=1)$=I[ee][w],H=I[ee][w-1],ae=I[ee][w+1],v($)?(Se=E($,H,ae),oe[ee]+=Se!==-1?String.fromCharCode(r[$.charCodeAt(0)][Se]):$):oe[ee]+=$;oe[ee]=_(oe[ee])}return oe.join(" ")},K=i.__arabicParser__.processArabic=i.processArabic=function(){var D,ee=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,w=[];if(Array.isArray(ee)){var Se=0;for(w=[],Se=0;Se<ee.length;Se+=1)Array.isArray(ee[Se])?w.push([T(ee[Se][0]),ee[Se][1],ee[Se][2]]):w.push([T(ee[Se])]);D=w}else D=T(ee);return typeof arguments[0]=="string"?D:(arguments[0].text=D,arguments[0])};i.events.push(["preProcessText",K])})(En.API),En.API.autoPrint=function(i){var r;return(i=i||{}).variant=i.variant||"non-conform",i.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){r=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+r+" 0 R")})),this},(function(i){var r=function(){var o=void 0;Object.defineProperty(this,"pdf",{get:function(){return o},set:function(p){o=p}});var s=150;Object.defineProperty(this,"width",{get:function(){return s},set:function(p){s=isNaN(p)||Number.isInteger(p)===!1||p<0?150:p,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=s+1)}});var c=300;Object.defineProperty(this,"height",{get:function(){return c},set:function(p){c=isNaN(p)||Number.isInteger(p)===!1||p<0?300:p,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=c+1)}});var d=[];Object.defineProperty(this,"childNodes",{get:function(){return d},set:function(p){d=p}});var v={};Object.defineProperty(this,"style",{get:function(){return v},set:function(p){v=p}}),Object.defineProperty(this,"parentNode",{})};r.prototype.getContext=function(o,s){var c;if((o=o||"2d")!=="2d")return null;for(c in s)this.pdf.context2d.hasOwnProperty(c)&&(this.pdf.context2d[c]=s[c]);return this.pdf.context2d._canvas=this,this.pdf.context2d},r.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},i.events.push(["initialized",function(){this.canvas=new r,this.canvas.pdf=this}])})(En.API),(function(i){var r={left:0,top:0,bottom:0,right:0},o=!1,s=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},r),this.internal.__cell__.margins.width=this.getPageWidth(),c.call(this))},c=function(){this.internal.__cell__.lastCell=new d,this.internal.__cell__.pages=1},d=function(){var g=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return g},set:function(D){g=D}});var m=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return m},set:function(D){m=D}});var S=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return S},set:function(D){S=D}});var _=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return _},set:function(D){_=D}});var E=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return E},set:function(D){E=D}});var T=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return T},set:function(D){T=D}});var K=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return K},set:function(D){K=D}}),this};d.prototype.clone=function(){return new d(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},d.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},i.setHeaderFunction=function(g){return s.call(this),this.internal.__cell__.headerFunction=typeof g=="function"?g:void 0,this},i.getTextDimensions=function(g,m){s.call(this);var S=(m=m||{}).fontSize||this.getFontSize(),_=m.font||this.getFont(),E=m.scaleFactor||this.internal.scaleFactor,T=0,K=0,D=0,ee=this;if(!Array.isArray(g)&&typeof g!="string"){if(typeof g!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");g=String(g)}var w=m.maxWidth;w>0?typeof g=="string"?g=this.splitTextToSize(g,w):Object.prototype.toString.call(g)==="[object Array]"&&(g=g.reduce(function($,H){return $.concat(ee.splitTextToSize(H,w))},[])):g=Array.isArray(g)?g:[g];for(var Se=0;Se<g.length;Se++)T<(D=this.getStringUnitWidth(g[Se],{font:_})*S)&&(T=D);return T!==0&&(K=g.length),{w:T/=E,h:Math.max((K*S*this.getLineHeightFactor()-S*(this.getLineHeightFactor()-1))/E,0)}},i.cellAddPage=function(){s.call(this),this.addPage();var g=this.internal.__cell__.margins||r;return this.internal.__cell__.lastCell=new d(g.left,g.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var v=i.cell=function(){var g;g=arguments[0]instanceof d?arguments[0]:new d(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),s.call(this);var m=this.internal.__cell__.lastCell,S=this.internal.__cell__.padding,_=this.internal.__cell__.margins||r,E=this.internal.__cell__.tableHeaderRow,T=this.internal.__cell__.printHeaders;return m.lineNumber!==void 0&&(m.lineNumber===g.lineNumber?(g.x=(m.x||0)+(m.width||0),g.y=m.y||0):m.y+m.height+g.height+_.bottom>this.getPageHeight()?(this.cellAddPage(),g.y=_.top,T&&E&&(this.printHeaderRow(g.lineNumber,!0),g.y+=E[0].height)):g.y=m.y+m.height||g.y),g.text[0]!==void 0&&(this.rect(g.x,g.y,g.width,g.height,o===!0?"FD":void 0),g.align==="right"?this.text(g.text,g.x+g.width-S,g.y+S,{align:"right",baseline:"top"}):g.align==="center"?this.text(g.text,g.x+g.width/2,g.y+S,{align:"center",baseline:"top",maxWidth:g.width-S-S}):this.text(g.text,g.x+S,g.y+S,{align:"left",baseline:"top",maxWidth:g.width-S-S})),this.internal.__cell__.lastCell=g,this};i.table=function(g,m,S,_,E){if(s.call(this),!S)throw new Error("No data for PDF table.");var T,K,D,ee,w=[],Se=[],$=[],H={},ae={},I=[],oe=[],pe=(E=E||{}).autoSize||!1,Y=E.printHeaders!==!1,X=E.css&&E.css["font-size"]!==void 0?16*E.css["font-size"]:E.fontSize||12,F=E.margins||Object.assign({width:this.getPageWidth()},r),R=typeof E.padding=="number"?E.padding:3,U=E.headerBackgroundColor||"#c8c8c8",O=E.headerTextColor||"#000";if(c.call(this),this.internal.__cell__.printHeaders=Y,this.internal.__cell__.margins=F,this.internal.__cell__.table_font_size=X,this.internal.__cell__.padding=R,this.internal.__cell__.headerBackgroundColor=U,this.internal.__cell__.headerTextColor=O,this.setFontSize(X),_==null)Se=w=Object.keys(S[0]),$=w.map(function(){return"left"});else if(Array.isArray(_)&&_r(_[0])==="object")for(w=_.map(function(de){return de.name}),Se=_.map(function(de){return de.prompt||de.name||""}),$=_.map(function(de){return de.align||"left"}),T=0;T<_.length;T+=1)ae[_[T].name]=.7499990551181103*_[T].width;else Array.isArray(_)&&typeof _[0]=="string"&&(Se=w=_,$=w.map(function(){return"left"}));if(pe||Array.isArray(_)&&typeof _[0]=="string")for(T=0;T<w.length;T+=1){for(H[ee=w[T]]=S.map(function(de){return de[ee]}),this.setFont(void 0,"bold"),I.push(this.getTextDimensions(Se[T],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),K=H[ee],this.setFont(void 0,"normal"),D=0;D<K.length;D+=1)I.push(this.getTextDimensions(K[D],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);ae[ee]=Math.max.apply(null,I)+R+R,I=[]}if(Y){var _e={};for(T=0;T<w.length;T+=1)_e[w[T]]={},_e[w[T]].text=Se[T],_e[w[T]].align=$[T];var ce=p.call(this,_e,ae);oe=w.map(function(de){return new d(g,m,ae[de],ce,_e[de].text,void 0,_e[de].align)}),this.setTableHeaderRow(oe),this.printHeaderRow(1,!1)}var xe=_.reduce(function(de,C){return de[C.name]=C.align,de},{});for(T=0;T<S.length;T+=1){"rowStart"in E&&E.rowStart instanceof Function&&E.rowStart({row:T,data:S[T]},this);var fe=p.call(this,S[T],ae);for(D=0;D<w.length;D+=1){var ke=S[T][w[D]];"cellStart"in E&&E.cellStart instanceof Function&&E.cellStart({row:T,col:D,data:ke},this),v.call(this,new d(g,m,ae[w[D]],fe,ke,T+2,xe[w[D]]))}}return this.internal.__cell__.table_x=g,this.internal.__cell__.table_y=m,this};var p=function(g,m){var S=this.internal.__cell__.padding,_=this.internal.__cell__.table_font_size,E=this.internal.scaleFactor;return Object.keys(g).map(function(T){var K=g[T];return this.splitTextToSize(K.hasOwnProperty("text")?K.text:K,m[T]-S-S)},this).map(function(T){return this.getLineHeightFactor()*T.length*_/E+S+S},this).reduce(function(T,K){return Math.max(T,K)},0)};i.setTableHeaderRow=function(g){s.call(this),this.internal.__cell__.tableHeaderRow=g},i.printHeaderRow=function(g,m){if(s.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var S;if(o=!0,typeof this.internal.__cell__.headerFunction=="function"){var _=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new d(_[0],_[1],_[2],_[3],void 0,-1)}this.setFont(void 0,"bold");for(var E=[],T=0;T<this.internal.__cell__.tableHeaderRow.length;T+=1){S=this.internal.__cell__.tableHeaderRow[T].clone(),m&&(S.y=this.internal.__cell__.margins.top||0,E.push(S)),S.lineNumber=g;var K=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),v.call(this,S),this.setTextColor(K)}E.length>0&&this.setTableHeaderRow(E),this.setFont(void 0,"normal"),o=!1}})(En.API);var Dy={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Ly=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Hg=Ry(Ly),My=[100,200,300,400,500,600,700,800,900],G5=Ry(My);function Cg(i){var r=i.family.replace(/"|'/g,"").toLowerCase(),o=(function(d){return Dy[d=d||"normal"]?d:"normal"})(i.style),s=(function(d){return d?typeof d=="number"?d>=100&&d<=900&&d%100==0?d:400:/^\d00$/.test(d)?parseInt(d):d==="bold"?700:400:400})(i.weight),c=(function(d){return typeof Hg[d=d||"normal"]=="number"?d:"normal"})(i.stretch);return{family:r,style:o,weight:s,stretch:c,src:i.src||[],ref:i.ref||{name:r,style:[c,o,s].join(" ")}}}function yx(i,r,o,s){var c;for(c=o;c>=0&&c<r.length;c+=s)if(i[r[c]])return i[r[c]];for(c=o;c>=0&&c<r.length;c-=s)if(i[r[c]])return i[r[c]]}var X5={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},mx={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function bx(i){return[i.stretch,i.style,i.weight,i.family].join(" ")}function vx(i){return i.trimLeft()}function K5(i,r){for(var o=0;o<i.length;){if(i.charAt(o)===r)return[i.substring(0,o),i.substring(o+1)];o+=1}return null}function Z5(i){var r=i.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return r===null?null:[r[0],i.substring(r[0].length)]}var Jp,wx,Sx,Xd,Qp,jx,Tx,Cx,kg=["times"];function kx(i,r,o,s,c){var d=4,v=Ax;switch(c){case En.API.image_compression.FAST:d=1,v=Nx;break;case En.API.image_compression.MEDIUM:d=6,v=zx;break;case En.API.image_compression.SLOW:d=9,v=Px}i=(function(g,m,S,_){for(var E,T=g.length/m,K=new Uint8Array(g.length+T),D=[J5,Nx,Ax,zx,Px],ee=0;ee<T;ee+=1){var w=ee*m,Se=g.subarray(w,w+m);if(_)K.set(_(Se,S,E),w+ee);else{for(var $=D.length,H=[],ae=0;ae<$;ae+=1)H[ae]=D[ae](Se,S,E);var I=ev(H.concat());K.set(H[I],w+ee)}E=Se}return K})(i,r,Math.ceil(o*s/8),v);var p=Bg(i,{level:d});return En.API.__addimage__.arrayBufferToBinaryString(p)}function J5(i){var r=Array.apply([],i);return r.unshift(0),r}function Nx(i,r){var o=i.length,s=[];s[0]=1;for(var c=0;c<o;c+=1){var d=i[c-r]||0;s[c+1]=i[c]-d+256&255}return s}function Ax(i,r,o){var s=i.length,c=[];c[0]=2;for(var d=0;d<s;d+=1){var v=o&&o[d]||0;c[d+1]=i[d]-v+256&255}return c}function zx(i,r,o){var s=i.length,c=[];c[0]=3;for(var d=0;d<s;d+=1){var v=i[d-r]||0,p=o&&o[d]||0;c[d+1]=i[d]+256-(v+p>>>1)&255}return c}function Px(i,r,o){var s=i.length,c=[];c[0]=4;for(var d=0;d<s;d+=1){var v=Q5(i[d-r]||0,o&&o[d]||0,o&&o[d-r]||0);c[d+1]=i[d]-v+256&255}return c}function Q5(i,r,o){if(i===r&&r===o)return i;var s=Math.abs(r-o),c=Math.abs(i-o),d=Math.abs(i+r-o-o);return s<=c&&s<=d?i:c<=d?r:o}function ev(i){var r=i.map(function(o){return o.reduce(function(s,c){return s+Math.abs(c)},0)});return r.indexOf(Math.min.apply(null,r))}function Ng(i,r,o){var s=r*o,c=Math.floor(s/8),d=16-(s-8*c+o),v=(1<<o)-1;return Iy(i,c)>>d&v}function _x(i,r,o,s){var c=o*s,d=Math.floor(c/8),v=16-(c-8*d+s),p=(1<<s)-1,g=(r&p)<<v;(function(m,S,_){if(S+1<m.byteLength)m.setUint16(S,_,!1);else{var E=_>>8&255;m.setUint8(S,E)}})(i,d,Iy(i,d)&~(p<<v)&65535|g)}function Iy(i,r){return r+1<i.byteLength?i.getUint16(r,!1):i.getUint8(r)<<8}function tv(i){var r=0;if(i[r++]!==71||i[r++]!==73||i[r++]!==70||i[r++]!==56||(i[r++]+1&253)!=56||i[r++]!==97)throw new Error("Invalid GIF 87a/89a header.");var o=i[r++]|i[r++]<<8,s=i[r++]|i[r++]<<8,c=i[r++],d=c>>7,v=1<<1+(7&c);i[r++],i[r++];var p=null,g=null;d&&(p=r,g=v,r+=3*v);var m=!0,S=[],_=0,E=null,T=0,K=null;for(this.width=o,this.height=s;m&&r<i.length;)switch(i[r++]){case 33:switch(i[r++]){case 255:if(i[r]!==11||i[r+1]==78&&i[r+2]==69&&i[r+3]==84&&i[r+4]==83&&i[r+5]==67&&i[r+6]==65&&i[r+7]==80&&i[r+8]==69&&i[r+9]==50&&i[r+10]==46&&i[r+11]==48&&i[r+12]==3&&i[r+13]==1&&i[r+16]==0)r+=14,K=i[r++]|i[r++]<<8,r++;else for(r+=12;;){if(!((F=i[r++])>=0))throw Error("Invalid block size");if(F===0)break;r+=F}break;case 249:if(i[r++]!==4||i[r+4]!==0)throw new Error("Invalid graphics extension block.");var D=i[r++];_=i[r++]|i[r++]<<8,E=i[r++],1&D||(E=null),T=D>>2&7,r++;break;case 254:for(;;){if(!((F=i[r++])>=0))throw Error("Invalid block size");if(F===0)break;r+=F}break;default:throw new Error("Unknown graphic control label: 0x"+i[r-1].toString(16))}break;case 44:var ee=i[r++]|i[r++]<<8,w=i[r++]|i[r++]<<8,Se=i[r++]|i[r++]<<8,$=i[r++]|i[r++]<<8,H=i[r++],ae=H>>6&1,I=1<<1+(7&H),oe=p,pe=g,Y=!1;H>>7&&(Y=!0,oe=r,pe=I,r+=3*I);var X=r;for(r++;;){var F;if(!((F=i[r++])>=0))throw Error("Invalid block size");if(F===0)break;r+=F}S.push({x:ee,y:w,width:Se,height:$,has_local_palette:Y,palette_offset:oe,palette_size:pe,data_offset:X,data_length:r-X,transparent_index:E,interlaced:!!ae,delay:_,disposal:T});break;case 59:m=!1;break;default:throw new Error("Unknown gif block: 0x"+i[r-1].toString(16))}this.numFrames=function(){return S.length},this.loopCount=function(){return K},this.frameInfo=function(R){if(R<0||R>=S.length)throw new Error("Frame index out of range.");return S[R]},this.decodeAndBlitFrameBGRA=function(R,U){var O=this.frameInfo(R),_e=O.width*O.height,ce=new Uint8Array(_e);Rx(i,O.data_offset,ce,_e);var xe=O.palette_offset,fe=O.transparent_index;fe===null&&(fe=256);var ke=O.width,de=o-ke,C=ke,z=4*(O.y*o+O.x),G=4*((O.y+O.height)*o+O.x),V=z,ie=4*de;O.interlaced===!0&&(ie+=4*o*7);for(var he=8,re=0,Le=ce.length;re<Le;++re){var Re=ce[re];if(C===0&&(C=ke,(V+=ie)>=G&&(ie=4*de+4*o*(he-1),V=z+(ke+de)*(he<<1),he>>=1)),Re===fe)V+=4;else{var Ue=i[xe+3*Re],et=i[xe+3*Re+1],ot=i[xe+3*Re+2];U[V++]=ot,U[V++]=et,U[V++]=Ue,U[V++]=255}--C}},this.decodeAndBlitFrameRGBA=function(R,U){var O=this.frameInfo(R),_e=O.width*O.height,ce=new Uint8Array(_e);Rx(i,O.data_offset,ce,_e);var xe=O.palette_offset,fe=O.transparent_index;fe===null&&(fe=256);var ke=O.width,de=o-ke,C=ke,z=4*(O.y*o+O.x),G=4*((O.y+O.height)*o+O.x),V=z,ie=4*de;O.interlaced===!0&&(ie+=4*o*7);for(var he=8,re=0,Le=ce.length;re<Le;++re){var Re=ce[re];if(C===0&&(C=ke,(V+=ie)>=G&&(ie=4*de+4*o*(he-1),V=z+(ke+de)*(he<<1),he>>=1)),Re===fe)V+=4;else{var Ue=i[xe+3*Re],et=i[xe+3*Re+1],ot=i[xe+3*Re+2];U[V++]=Ue,U[V++]=et,U[V++]=ot,U[V++]=255}--C}}}function Rx(i,r,o,s){for(var c=i[r++],d=1<<c,v=d+1,p=v+1,g=c+1,m=(1<<g)-1,S=0,_=0,E=0,T=i[r++],K=new Int32Array(4096),D=null;;){for(;S<16&&T!==0;)_|=i[r++]<<S,S+=8,T===1?T=i[r++]:--T;if(S<g)break;var ee=_&m;if(_>>=g,S-=g,ee!==d){if(ee===v)break;for(var w=ee<p?ee:D,Se=0,$=w;$>d;)$=K[$]>>8,++Se;var H=$;if(E+Se+(w!==ee?1:0)>s)return void Yr.log("Warning, gif stream longer than expected.");o[E++]=H;var ae=E+=Se;for(w!==ee&&(o[E++]=H),$=w;Se--;)$=K[$],o[--ae]=255&$,$>>=8;D!==null&&p<4096&&(K[p++]=D<<8|H,p>=m+1&&g<12&&(++g,m=m<<1|1)),D=ee}else p=v+1,m=(1<<(g=c+1))-1,D=null}return E!==s&&Yr.log("Warning, gif stream shorter than expected."),o}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Ag(i){var r,o,s,c,d,v=Math.floor,p=new Array(64),g=new Array(64),m=new Array(64),S=new Array(64),_=new Array(65535),E=new Array(65535),T=new Array(64),K=new Array(64),D=[],ee=0,w=7,Se=new Array(64),$=new Array(64),H=new Array(64),ae=new Array(256),I=new Array(2048),oe=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],pe=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],Y=[0,1,2,3,4,5,6,7,8,9,10,11],X=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],F=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],R=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],U=[0,1,2,3,4,5,6,7,8,9,10,11],O=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],_e=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ce(z,G){for(var V=0,ie=0,he=new Array,re=1;re<=16;re++){for(var Le=1;Le<=z[re];Le++)he[G[ie]]=[],he[G[ie]][0]=V,he[G[ie]][1]=re,ie++,V++;V*=2}return he}function xe(z){for(var G=z[0],V=z[1]-1;V>=0;)G&1<<V&&(ee|=1<<w),V--,--w<0&&(ee==255?(fe(255),fe(0)):fe(ee),w=7,ee=0)}function fe(z){D.push(z)}function ke(z){fe(z>>8&255),fe(255&z)}function de(z,G,V,ie,he){for(var re,Le=he[0],Re=he[240],Ue=(function(ht,Xe){var Ut,an,Ht,Nn,zn,Ee,Ne,Mt,ct,_t,Ze=0;for(ct=0;ct<8;++ct){Ut=ht[Ze],an=ht[Ze+1],Ht=ht[Ze+2],Nn=ht[Ze+3],zn=ht[Ze+4],Ee=ht[Ze+5],Ne=ht[Ze+6];var jt=Ut+(Mt=ht[Ze+7]),en=Ut-Mt,Qe=an+Ne,At=an-Ne,un=Ht+Ee,xn=Ht-Ee,Kt=Nn+zn,Qt=Nn-zn,hn=jt+Kt,Xn=jt-Kt,rt=Qe+un,ln=Qe-un;ht[Ze]=hn+rt,ht[Ze+4]=hn-rt;var Lt=.707106781*(ln+Xn);ht[Ze+2]=Xn+Lt,ht[Ze+6]=Xn-Lt;var Zn=.382683433*((hn=Qt+xn)-(ln=At+en)),In=.5411961*hn+Zn,wr=1.306562965*ln+Zn,Zi=.707106781*(rt=xn+At),Yt=en+Zi,jn=en-Zi;ht[Ze+5]=jn+In,ht[Ze+3]=jn-In,ht[Ze+1]=Yt+wr,ht[Ze+7]=Yt-wr,Ze+=8}for(Ze=0,ct=0;ct<8;++ct){Ut=ht[Ze],an=ht[Ze+8],Ht=ht[Ze+16],Nn=ht[Ze+24],zn=ht[Ze+32],Ee=ht[Ze+40],Ne=ht[Ze+48];var ci=Ut+(Mt=ht[Ze+56]),Et=Ut-Mt,Bt=an+Ne,Zt=an-Ne,on=Ht+Ee,Wn=Ht-Ee,qi=Nn+zn,Sr=Nn-zn,yt=ci+qi,si=ci-qi,On=Bt+on,Ri=Bt-on;ht[Ze]=yt+On,ht[Ze+32]=yt-On;var Ei=.707106781*(Ri+si);ht[Ze+16]=si+Ei,ht[Ze+48]=si-Ei;var bo=.382683433*((yt=Sr+Wn)-(Ri=Zt+Et)),ya=.5411961*yt+bo,Rr=1.306562965*Ri+bo,Ys=.707106781*(On=Wn+Zt),Jo=Et+Ys,Qo=Et-Ys;ht[Ze+40]=Qo+ya,ht[Ze+24]=Qo-ya,ht[Ze+8]=Jo+Rr,ht[Ze+56]=Jo-Rr,Ze++}for(ct=0;ct<64;++ct)_t=ht[ct]*Xe[ct],T[ct]=_t>0?_t+.5|0:_t-.5|0;return T})(z,G),et=0;et<64;++et)K[oe[et]]=Ue[et];var ot=K[0]-V;V=K[0],ot==0?xe(ie[0]):(xe(ie[E[re=32767+ot]]),xe(_[re]));for(var Ct=63;Ct>0&&K[Ct]==0;)Ct--;if(Ct==0)return xe(Le),V;for(var Ot,se=1;se<=Ct;){for(var kt=se;K[se]==0&&se<=Ct;)++se;var Jt=se-kt;if(Jt>=16){Ot=Jt>>4;for(var Wt=1;Wt<=Ot;++Wt)xe(Re);Jt&=15}re=32767+K[se],xe(he[(Jt<<4)+E[re]]),xe(_[re]),se++}return Ct!=63&&xe(Le),V}function C(z){z=Math.min(Math.max(z,1),100),d!=z&&((function(G){for(var V=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],ie=0;ie<64;ie++){var he=v((V[ie]*G+50)/100);he=Math.min(Math.max(he,1),255),p[oe[ie]]=he}for(var re=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Le=0;Le<64;Le++){var Re=v((re[Le]*G+50)/100);Re=Math.min(Math.max(Re,1),255),g[oe[Le]]=Re}for(var Ue=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],et=0,ot=0;ot<8;ot++)for(var Ct=0;Ct<8;Ct++)m[et]=1/(p[oe[et]]*Ue[ot]*Ue[Ct]*8),S[et]=1/(g[oe[et]]*Ue[ot]*Ue[Ct]*8),et++})(z<50?Math.floor(5e3/z):Math.floor(200-2*z)),d=z)}this.encode=function(z,G){G&&C(G),D=new Array,ee=0,w=7,ke(65496),ke(65504),ke(16),fe(74),fe(70),fe(73),fe(70),fe(0),fe(1),fe(1),fe(0),ke(1),ke(1),fe(0),fe(0),(function(){ke(65499),ke(132),fe(0);for(var an=0;an<64;an++)fe(p[an]);fe(1);for(var Ht=0;Ht<64;Ht++)fe(g[Ht])})(),(function(an,Ht){ke(65472),ke(17),fe(8),ke(Ht),ke(an),fe(3),fe(1),fe(17),fe(0),fe(2),fe(17),fe(1),fe(3),fe(17),fe(1)})(z.width,z.height),(function(){ke(65476),ke(418),fe(0);for(var an=0;an<16;an++)fe(pe[an+1]);for(var Ht=0;Ht<=11;Ht++)fe(Y[Ht]);fe(16);for(var Nn=0;Nn<16;Nn++)fe(X[Nn+1]);for(var zn=0;zn<=161;zn++)fe(F[zn]);fe(1);for(var Ee=0;Ee<16;Ee++)fe(R[Ee+1]);for(var Ne=0;Ne<=11;Ne++)fe(U[Ne]);fe(17);for(var Mt=0;Mt<16;Mt++)fe(O[Mt+1]);for(var ct=0;ct<=161;ct++)fe(_e[ct])})(),ke(65498),ke(12),fe(3),fe(1),fe(0),fe(2),fe(17),fe(3),fe(17),fe(0),fe(63),fe(0);var V=0,ie=0,he=0;ee=0,w=7,this.encode.displayName="_encode_";for(var re,Le,Re,Ue,et,ot,Ct,Ot,se,kt=z.data,Jt=z.width,Wt=z.height,ht=4*Jt,Xe=0;Xe<Wt;){for(re=0;re<ht;){for(et=ht*Xe+re,Ct=-1,Ot=0,se=0;se<64;se++)ot=et+(Ot=se>>3)*ht+(Ct=4*(7&se)),Xe+Ot>=Wt&&(ot-=ht*(Xe+1+Ot-Wt)),re+Ct>=ht&&(ot-=re+Ct-ht+4),Le=kt[ot++],Re=kt[ot++],Ue=kt[ot++],Se[se]=(I[Le]+I[Re+256|0]+I[Ue+512|0]>>16)-128,$[se]=(I[Le+768|0]+I[Re+1024|0]+I[Ue+1280|0]>>16)-128,H[se]=(I[Le+1280|0]+I[Re+1536|0]+I[Ue+1792|0]>>16)-128;V=de(Se,m,V,r,s),ie=de($,S,ie,o,c),he=de(H,S,he,o,c),re+=32}Xe+=8}if(w>=0){var Ut=[];Ut[1]=w+1,Ut[0]=(1<<w+1)-1,xe(Ut)}return ke(65497),new Uint8Array(D)},i=i||50,(function(){for(var z=String.fromCharCode,G=0;G<256;G++)ae[G]=z(G)})(),r=ce(pe,Y),o=ce(R,U),s=ce(X,F),c=ce(O,_e),(function(){for(var z=1,G=2,V=1;V<=15;V++){for(var ie=z;ie<G;ie++)E[32767+ie]=V,_[32767+ie]=[],_[32767+ie][1]=V,_[32767+ie][0]=ie;for(var he=-(G-1);he<=-z;he++)E[32767+he]=V,_[32767+he]=[],_[32767+he][1]=V,_[32767+he][0]=G-1+he;z<<=1,G<<=1}})(),(function(){for(var z=0;z<256;z++)I[z]=19595*z,I[z+256|0]=38470*z,I[z+512|0]=7471*z+32768,I[z+768|0]=-11059*z,I[z+1024|0]=-21709*z,I[z+1280|0]=32768*z+8421375,I[z+1536|0]=-27439*z,I[z+1792|0]=-5329*z})(),C(i)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function gc(i,r){if(this.pos=0,this.buffer=i,this.datav=new DataView(i.buffer),this.is_with_alpha=!!r,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Dx(i){function r(Y){if(!Y)throw Error("assert :P")}function o(Y,X,F){for(var R=0;4>R;R++)if(Y[X+R]!=F.charCodeAt(R))return!0;return!1}function s(Y,X,F,R,U){for(var O=0;O<U;O++)Y[X+O]=F[R+O]}function c(Y,X,F,R){for(var U=0;U<R;U++)Y[X+U]=F}function d(Y){return new Int32Array(Y)}function v(Y,X){for(var F=[],R=0;R<Y;R++)F.push(new X);return F}function p(Y,X){var F=[];return(function R(U,O,_e){for(var ce=_e[O],xe=0;xe<ce&&(U.push(_e.length>O+1?[]:new X),!(_e.length<O+1));xe++)R(U[xe],O+1,_e)})(F,0,Y),F}var g=function(){var Y=this;function X(f,x){for(var k=1<<x-1>>>0;f&k;)k>>>=1;return k?(f&k-1)+k:f}function F(f,x,k,P,q){r(!(P%k));do f[x+(P-=k)]=q;while(0<P)}function R(f,x,k,P,q){if(r(2328>=q),512>=q)var Z=d(512);else if((Z=d(q))==null)return 0;return(function(Q,J,te,Pe,Fe,tt){var Ae,Ve,Ke=J,ft=1<<te,Je=d(16),mt=d(16);for(r(Fe!=0),r(Pe!=null),r(Q!=null),r(0<te),Ve=0;Ve<Fe;++Ve){if(15<Pe[Ve])return 0;++Je[Pe[Ve]]}if(Je[0]==Fe)return 0;for(mt[1]=0,Ae=1;15>Ae;++Ae){if(Je[Ae]>1<<Ae)return 0;mt[Ae+1]=mt[Ae]+Je[Ae]}for(Ve=0;Ve<Fe;++Ve)Ae=Pe[Ve],0<Pe[Ve]&&(tt[mt[Ae]++]=Ve);if(mt[15]==1)return(Pe=new U).g=0,Pe.value=tt[0],F(Q,Ke,1,ft,Pe),ft;var wt,Dt=-1,vt=ft-1,sn=0,nn=1,ti=1,Xt=1<<te;for(Ve=0,Ae=1,Fe=2;Ae<=te;++Ae,Fe<<=1){if(nn+=ti<<=1,0>(ti-=Je[Ae]))return 0;for(;0<Je[Ae];--Je[Ae])(Pe=new U).g=Ae,Pe.value=tt[Ve++],F(Q,Ke+sn,Fe,Xt,Pe),sn=X(sn,Ae)}for(Ae=te+1,Fe=2;15>=Ae;++Ae,Fe<<=1){if(nn+=ti<<=1,0>(ti-=Je[Ae]))return 0;for(;0<Je[Ae];--Je[Ae]){if(Pe=new U,(sn&vt)!=Dt){for(Ke+=Xt,wt=1<<(Dt=Ae)-te;15>Dt&&!(0>=(wt-=Je[Dt]));)++Dt,wt<<=1;ft+=Xt=1<<(wt=Dt-te),Q[J+(Dt=sn&vt)].g=wt+te,Q[J+Dt].value=Ke-J-Dt}Pe.g=Ae-te,Pe.value=tt[Ve++],F(Q,Ke+(sn>>te),Fe,Xt,Pe),sn=X(sn,Ae)}}return nn!=2*mt[15]-1?0:ft})(f,x,k,P,q,Z)}function U(){this.value=this.g=0}function O(){this.value=this.g=0}function _e(){this.G=v(5,U),this.H=d(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=v(Ao,O)}function ce(f,x,k,P){r(f!=null),r(x!=null),r(2147483648>P),f.Ca=254,f.I=0,f.b=-8,f.Ka=0,f.oa=x,f.pa=k,f.Jd=x,f.Yc=k+P,f.Zc=4<=P?k+P-4+1:k,Le(f)}function xe(f,x){for(var k=0;0<x--;)k|=Ue(f,128)<<x;return k}function fe(f,x){var k=xe(f,x);return Re(f)?-k:k}function ke(f,x,k,P){var q,Z=0;for(r(f!=null),r(x!=null),r(4294967288>P),f.Sb=P,f.Ra=0,f.u=0,f.h=0,4<P&&(P=4),q=0;q<P;++q)Z+=x[k+q]<<8*q;f.Ra=Z,f.bb=P,f.oa=x,f.pa=k}function de(f){for(;8<=f.u&&f.bb<f.Sb;)f.Ra>>>=8,f.Ra+=f.oa[f.pa+f.bb]<<zo-8>>>0,++f.bb,f.u-=8;ie(f)&&(f.h=1,f.u=0)}function C(f,x){if(r(0<=x),!f.h&&x<=kr){var k=V(f)&Ya[x];return f.u+=x,de(f),k}return f.h=1,f.u=0}function z(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function G(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function V(f){return f.Ra>>>(f.u&zo-1)>>>0}function ie(f){return r(f.bb<=f.Sb),f.h||f.bb==f.Sb&&f.u>zo}function he(f,x){f.u=x,f.h=ie(f)}function re(f){f.u>=so&&(r(f.u>=so),de(f))}function Le(f){r(f!=null&&f.oa!=null),f.pa<f.Zc?(f.I=(f.oa[f.pa++]|f.I<<8)>>>0,f.b+=8):(r(f!=null&&f.oa!=null),f.pa<f.Yc?(f.b+=8,f.I=f.oa[f.pa++]|f.I<<8):f.Ka?f.b=0:(f.I<<=8,f.b+=8,f.Ka=1))}function Re(f){return xe(f,1)}function Ue(f,x){var k=f.Ca;0>f.b&&Le(f);var P=f.b,q=k*x>>>8,Z=(f.I>>>P>q)+0;for(Z?(k-=q,f.I-=q+1<<P>>>0):k=q+1,P=k,q=0;256<=P;)q+=8,P>>=8;return P=7^q+Is[P],f.b-=P,f.Ca=(k<<P)-1,Z}function et(f,x,k){f[x+0]=k>>24&255,f[x+1]=k>>16&255,f[x+2]=k>>8&255,f[x+3]=255&k}function ot(f,x){return f[x+0]|f[x+1]<<8}function Ct(f,x){return ot(f,x)|f[x+2]<<16}function Ot(f,x){return ot(f,x)|ot(f,x+2)<<16}function se(f,x){var k=1<<x;return r(f!=null),r(0<x),f.X=d(k),f.X==null?0:(f.Mb=32-x,f.Xa=x,1)}function kt(f,x){r(f!=null),r(x!=null),r(f.Xa==x.Xa),s(x.X,0,f.X,0,1<<x.Xa)}function Jt(){this.X=[],this.Xa=this.Mb=0}function Wt(f,x,k,P){r(k!=null),r(P!=null);var q=k[0],Z=P[0];return q==0&&(q=(f*Z+x/2)/x),Z==0&&(Z=(x*q+f/2)/f),0>=q||0>=Z?0:(k[0]=q,P[0]=Z,1)}function ht(f,x){return f+(1<<x)-1>>>x}function Xe(f,x){return((4278255360&f)+(4278255360&x)>>>0&4278255360)+((16711935&f)+(16711935&x)>>>0&16711935)>>>0}function Ut(f,x){Y[x]=function(k,P,q,Z,Q,J,te){var Pe;for(Pe=0;Pe<Q;++Pe){var Fe=Y[f](J[te+Pe-1],q,Z+Pe);J[te+Pe]=Xe(k[P+Pe],Fe)}}}function an(){this.ud=this.hd=this.jd=0}function Ht(f,x){return((4278124286&(f^x))>>>1)+(f&x)>>>0}function Nn(f){return 0<=f&&256>f?f:0>f?0:255<f?255:void 0}function zn(f,x){return Nn(f+(f-x+.5>>1))}function Ee(f,x,k){return Math.abs(x-k)-Math.abs(f-k)}function Ne(f,x,k,P,q,Z,Q){for(P=Z[Q-1],k=0;k<q;++k)Z[Q+k]=P=Xe(f[x+k],P)}function Mt(f,x,k,P,q){var Z;for(Z=0;Z<k;++Z){var Q=f[x+Z],J=Q>>8&255,te=16711935&(te=(te=16711935&Q)+((J<<16)+J));P[q+Z]=(4278255360&Q)+te>>>0}}function ct(f,x){x.jd=255&f,x.hd=f>>8&255,x.ud=f>>16&255}function _t(f,x,k,P,q,Z){var Q;for(Q=0;Q<P;++Q){var J=x[k+Q],te=J>>>8,Pe=J,Fe=255&(Fe=(Fe=J>>>16)+((f.jd<<24>>24)*(te<<24>>24)>>>5));Pe=255&(Pe=(Pe+=(f.hd<<24>>24)*(te<<24>>24)>>>5)+((f.ud<<24>>24)*(Fe<<24>>24)>>>5)),q[Z+Q]=(4278255360&J)+(Fe<<16)+Pe}}function Ze(f,x,k,P,q){Y[x]=function(Z,Q,J,te,Pe,Fe,tt,Ae,Ve){for(te=tt;te<Ae;++te)for(tt=0;tt<Ve;++tt)Pe[Fe++]=q(J[P(Z[Q++])])},Y[f]=function(Z,Q,J,te,Pe,Fe,tt){var Ae=8>>Z.b,Ve=Z.Ea,Ke=Z.K[0],ft=Z.w;if(8>Ae)for(Z=(1<<Z.b)-1,ft=(1<<Ae)-1;Q<J;++Q){var Je,mt=0;for(Je=0;Je<Ve;++Je)Je&Z||(mt=P(te[Pe++])),Fe[tt++]=q(Ke[mt&ft]),mt>>=Ae}else Y["VP8LMapColor"+k](te,Pe,Ke,ft,Fe,tt,Q,J,Ve)}}function jt(f,x,k,P,q){for(k=x+k;x<k;){var Z=f[x++];P[q++]=Z>>16&255,P[q++]=Z>>8&255,P[q++]=255&Z}}function en(f,x,k,P,q){for(k=x+k;x<k;){var Z=f[x++];P[q++]=Z>>16&255,P[q++]=Z>>8&255,P[q++]=255&Z,P[q++]=Z>>24&255}}function Qe(f,x,k,P,q){for(k=x+k;x<k;){var Z=(Q=f[x++])>>16&240|Q>>12&15,Q=240&Q|Q>>28&15;P[q++]=Z,P[q++]=Q}}function At(f,x,k,P,q){for(k=x+k;x<k;){var Z=(Q=f[x++])>>16&248|Q>>13&7,Q=Q>>5&224|Q>>3&31;P[q++]=Z,P[q++]=Q}}function un(f,x,k,P,q){for(k=x+k;x<k;){var Z=f[x++];P[q++]=255&Z,P[q++]=Z>>8&255,P[q++]=Z>>16&255}}function xn(f,x,k,P,q,Z){if(Z==0)for(k=x+k;x<k;)et(P,((Z=f[x++])[0]>>24|Z[1]>>8&65280|Z[2]<<8&16711680|Z[3]<<24)>>>0),q+=32;else s(P,q,f,x,k)}function Kt(f,x){Y[x][0]=Y[f+"0"],Y[x][1]=Y[f+"1"],Y[x][2]=Y[f+"2"],Y[x][3]=Y[f+"3"],Y[x][4]=Y[f+"4"],Y[x][5]=Y[f+"5"],Y[x][6]=Y[f+"6"],Y[x][7]=Y[f+"7"],Y[x][8]=Y[f+"8"],Y[x][9]=Y[f+"9"],Y[x][10]=Y[f+"10"],Y[x][11]=Y[f+"11"],Y[x][12]=Y[f+"12"],Y[x][13]=Y[f+"13"],Y[x][14]=Y[f+"0"],Y[x][15]=Y[f+"0"]}function Qt(f){return f==wc||f==Sc||f==hl||f==jc}function hn(){this.eb=[],this.size=this.A=this.fb=0}function Xn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function rt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new hn,this.f.kb=new Xn,this.sd=null}function ln(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Lt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Zn(f){return alert("todo:WebPSamplerProcessPlane"),f.T}function In(f,x){var k=f.T,P=x.ba.f.RGBA,q=P.eb,Z=P.fb+f.ka*P.A,Q=Qa[x.ba.S],J=f.y,te=f.O,Pe=f.f,Fe=f.N,tt=f.ea,Ae=f.W,Ve=x.cc,Ke=x.dc,ft=x.Mc,Je=x.Nc,mt=f.ka,wt=f.ka+f.T,Dt=f.U,vt=Dt+1>>1;for(mt==0?Q(J,te,null,null,Pe,Fe,tt,Ae,Pe,Fe,tt,Ae,q,Z,null,null,Dt):(Q(x.ec,x.fc,J,te,Ve,Ke,ft,Je,Pe,Fe,tt,Ae,q,Z-P.A,q,Z,Dt),++k);mt+2<wt;mt+=2)Ve=Pe,Ke=Fe,ft=tt,Je=Ae,Fe+=f.Rc,Ae+=f.Rc,Z+=2*P.A,Q(J,(te+=2*f.fa)-f.fa,J,te,Ve,Ke,ft,Je,Pe,Fe,tt,Ae,q,Z-P.A,q,Z,Dt);return te+=f.fa,f.j+wt<f.o?(s(x.ec,x.fc,J,te,Dt),s(x.cc,x.dc,Pe,Fe,vt),s(x.Mc,x.Nc,tt,Ae,vt),k--):1&wt||Q(J,te,null,null,Pe,Fe,tt,Ae,Pe,Fe,tt,Ae,q,Z+P.A,null,null,Dt),k}function wr(f,x,k){var P=f.F,q=[f.J];if(P!=null){var Z=f.U,Q=x.ba.S,J=Q==Ra||Q==hl;x=x.ba.f.RGBA;var te=[0],Pe=f.ka;te[0]=f.T,f.Kb&&(Pe==0?--te[0]:(--Pe,q[0]-=f.width),f.j+f.ka+f.T==f.o&&(te[0]=f.o-f.j-Pe));var Fe=x.eb;Pe=x.fb+Pe*x.A,f=os(P,q[0],f.width,Z,te,Fe,Pe+(J?0:3),x.A),r(k==te),f&&Qt(Q)&&Wo(Fe,Pe,J,Z,te,x.A)}return 0}function Zi(f){var x=f.ma,k=x.ba.S,P=11>k,q=k==Za||k==bi||k==Ra||k==Rl||k==12||Qt(k);if(x.memory=null,x.Ib=null,x.Jb=null,x.Nd=null,!xs(x.Oa,f,q?11:12))return 0;if(q&&Qt(k)&&da(),f.da)alert("todo:use_scaling");else{if(P){if(x.Ib=Zn,f.Kb){if(k=f.U+1>>1,x.memory=d(f.U+2*k),x.memory==null)return 0;x.ec=x.memory,x.fc=0,x.cc=x.ec,x.dc=x.fc+f.U,x.Mc=x.cc,x.Nc=x.dc+k,x.Ib=In,da()}}else alert("todo:EmitYUV");q&&(x.Jb=wr,P&&Cr())}if(P&&!Ea){for(f=0;256>f;++f)Gi[f]=89858*(f-128)+ha>>Sa,qs[f]=-22014*(f-128)+ha,to[f]=-45773*(f-128),Go[f]=113618*(f-128)+ha>>Sa;for(f=Ql;f<xl;++f)x=76283*(f-16)+ha>>Sa,Lo[f-Ql]=Na(x,255),Vs[f-Ql]=Na(x+8>>4,15);Ea=1}return 1}function Yt(f){var x=f.ma,k=f.U,P=f.T;return r(!(1&f.ka)),0>=k||0>=P?0:(k=x.Ib(f,x),x.Jb!=null&&x.Jb(f,x,k),x.Dc+=k,1)}function jn(f){f.ma.memory=null}function ci(f,x,k,P){return C(f,8)!=47?0:(x[0]=C(f,14)+1,k[0]=C(f,14)+1,P[0]=C(f,1),C(f,3)!=0?0:!f.h)}function Et(f,x){if(4>f)return f+1;var k=f-2>>1;return(2+(1&f)<<k)+C(x,k)+1}function Bt(f,x){return 120<x?x-120:1<=(k=((k=Ja[x-1])>>4)*f+(8-(15&k)))?k:1;var k}function Zt(f,x,k){var P=V(k),q=f[x+=255&P].g-8;return 0<q&&(he(k,k.u+8),P=V(k),x+=f[x].value,x+=P&(1<<q)-1),he(k,k.u+f[x].g),f[x].value}function on(f,x,k){return k.g+=f.g,k.value+=f.value<<x>>>0,r(8>=k.g),f.g}function Wn(f,x,k){var P=f.xc;return r((x=P==0?0:f.vc[f.md*(k>>P)+(x>>P)])<f.Wb),f.Ya[x]}function qi(f,x,k,P){var q=f.ab,Z=f.c*x,Q=f.C;x=Q+x;var J=k,te=P;for(P=f.Ta,k=f.Ua;0<q--;){var Pe=f.gc[q],Fe=Q,tt=x,Ae=J,Ve=te,Ke=(te=P,J=k,Pe.Ea);switch(r(Fe<tt),r(tt<=Pe.nc),Pe.hc){case 2:pr(Ae,Ve,(tt-Fe)*Ke,te,J);break;case 0:var ft=Fe,Je=tt,mt=te,wt=J,Dt=(Xt=Pe).Ea;ft==0&&(Bs(Ae,Ve,null,null,1,mt,wt),Ne(Ae,Ve+1,0,0,Dt-1,mt,wt+1),Ve+=Dt,wt+=Dt,++ft);for(var vt=1<<Xt.b,sn=vt-1,nn=ht(Dt,Xt.b),ti=Xt.K,Xt=Xt.w+(ft>>Xt.b)*nn;ft<Je;){var Cn=ti,Nr=Xt,ni=1;for(zl(Ae,Ve,mt,wt-Dt,1,mt,wt);ni<Dt;){var gn=(ni&~sn)+vt;gn>Dt&&(gn=Dt),(0,Yi[Cn[Nr++]>>8&15])(Ae,Ve+ +ni,mt,wt+ni-Dt,gn-ni,mt,wt+ni),ni=gn}Ve+=Dt,wt+=Dt,++ft&sn||(Xt+=nn)}tt!=Pe.nc&&s(te,J-Ke,te,J+(tt-Fe-1)*Ke,Ke);break;case 1:for(Ke=Ae,Je=Ve,Dt=(Ae=Pe.Ea)-(wt=Ae&~(mt=(Ve=1<<Pe.b)-1)),ft=ht(Ae,Pe.b),vt=Pe.K,Pe=Pe.w+(Fe>>Pe.b)*ft;Fe<tt;){for(sn=vt,nn=Pe,ti=new an,Xt=Je+wt,Cn=Je+Ae;Je<Xt;)ct(sn[nn++],ti),Es(ti,Ke,Je,Ve,te,J),Je+=Ve,J+=Ve;Je<Cn&&(ct(sn[nn++],ti),Es(ti,Ke,Je,Dt,te,J),Je+=Dt,J+=Dt),++Fe&mt||(Pe+=ft)}break;case 3:if(Ae==te&&Ve==J&&0<Pe.b){for(Je=te,Ae=Ke=J+(tt-Fe)*Ke-(wt=(tt-Fe)*ht(Pe.Ea,Pe.b)),Ve=te,mt=J,ft=[],wt=(Dt=wt)-1;0<=wt;--wt)ft[wt]=Ve[mt+wt];for(wt=Dt-1;0<=wt;--wt)Je[Ae+wt]=ft[wt];bc(Pe,Fe,tt,te,Ke,te,J)}else bc(Pe,Fe,tt,Ae,Ve,te,J)}J=P,te=k}te!=k&&s(P,k,J,te,Z)}function Sr(f,x){var k=f.V,P=f.Ba+f.c*f.C,q=x-f.C;if(r(x<=f.l.o),r(16>=q),0<q){var Z=f.l,Q=f.Ta,J=f.Ua,te=Z.width;if(qi(f,q,k,P),q=J=[J],r((k=f.C)<(P=x)),r(Z.v<Z.va),P>Z.o&&(P=Z.o),k<Z.j){var Pe=Z.j-k;k=Z.j,q[0]+=Pe*te}if(k>=P?k=0:(q[0]+=4*Z.v,Z.ka=k-Z.j,Z.U=Z.va-Z.v,Z.T=P-k,k=1),k){if(J=J[0],11>(k=f.ca).S){var Fe=k.f.RGBA,tt=(P=k.S,q=Z.U,Z=Z.T,Pe=Fe.eb,Fe.A),Ae=Z;for(Fe=Fe.fb+f.Ma*Fe.A;0<Ae--;){var Ve=Q,Ke=J,ft=q,Je=Pe,mt=Fe;switch(P){case Qs:Pl(Ve,Ke,ft,Je,mt);break;case Za:Vo(Ve,Ke,ft,Je,mt);break;case wc:Vo(Ve,Ke,ft,Je,mt),Wo(Je,mt,0,ft,1,0);break;case Xl:Yl(Ve,Ke,ft,Je,mt);break;case bi:xn(Ve,Ke,ft,Je,mt,1);break;case Sc:xn(Ve,Ke,ft,Je,mt,1),Wo(Je,mt,0,ft,1,0);break;case Ra:xn(Ve,Ke,ft,Je,mt,0);break;case hl:xn(Ve,Ke,ft,Je,mt,0),Wo(Je,mt,1,ft,1,0);break;case Rl:fl(Ve,Ke,ft,Je,mt);break;case jc:fl(Ve,Ke,ft,Je,mt),ra(Je,mt,ft,1,0);break;case pl:ys(Ve,Ke,ft,Je,mt);break;default:r(0)}J+=te,Fe+=tt}f.Ma+=Z}else alert("todo:EmitRescaledRowsYUVA");r(f.Ma<=k.height)}}f.C=x,r(f.C<=f.i)}function yt(f){var x;if(0<f.ua)return 0;for(x=0;x<f.Wb;++x){var k=f.Ya[x].G,P=f.Ya[x].H;if(0<k[1][P[1]+0].g||0<k[2][P[2]+0].g||0<k[3][P[3]+0].g)return 0}return 1}function si(f,x,k,P,q,Z){if(f.Z!=0){var Q=f.qd,J=f.rd;for(r(el[f.Z]!=null);x<k;++x)el[f.Z](Q,J,P,q,P,q,Z),Q=P,J=q,q+=Z;f.qd=Q,f.rd=J}}function On(f,x){var k=f.l.ma,P=k.Z==0||k.Z==1?f.l.j:f.C;if(P=f.C<P?P:f.C,r(x<=f.l.o),x>P){var q=f.l.width,Z=k.ca,Q=k.tb+q*P,J=f.V,te=f.Ba+f.c*P,Pe=f.gc;r(f.ab==1),r(Pe[0].hc==3),Ci(Pe[0],P,x,J,te,Z,Q),si(k,P,x,Z,Q,q)}f.C=f.Ma=x}function Ri(f,x,k,P,q,Z,Q){var J=f.$/P,te=f.$%P,Pe=f.m,Fe=f.s,tt=k+f.$,Ae=tt;q=k+P*q;var Ve=k+P*Z,Ke=280+Fe.ua,ft=f.Pb?J:16777216,Je=0<Fe.ua?Fe.Wa:null,mt=Fe.wc,wt=tt<Ve?Wn(Fe,te,J):null;r(f.C<Z),r(Ve<=q);var Dt=!1;e:for(;;){for(;Dt||tt<Ve;){var vt=0;if(J>=ft){var sn=tt-k;r((ft=f).Pb),ft.wd=ft.m,ft.xd=sn,0<ft.s.ua&&kt(ft.s.Wa,ft.s.vb),ft=J+Fs}if(te&mt||(wt=Wn(Fe,te,J)),r(wt!=null),wt.Qb&&(x[tt]=wt.qb,Dt=!0),!Dt)if(re(Pe),wt.jc){vt=Pe,sn=x;var nn=tt,ti=wt.pd[V(vt)&Ao-1];r(wt.jc),256>ti.g?(he(vt,vt.u+ti.g),sn[nn]=ti.value,vt=0):(he(vt,vt.u+ti.g-256),r(256<=ti.value),vt=ti.value),vt==0&&(Dt=!0)}else vt=Zt(wt.G[0],wt.H[0],Pe);if(Pe.h)break;if(Dt||256>vt){if(!Dt)if(wt.nd)x[tt]=(wt.qb|vt<<8)>>>0;else{if(re(Pe),Dt=Zt(wt.G[1],wt.H[1],Pe),re(Pe),sn=Zt(wt.G[2],wt.H[2],Pe),nn=Zt(wt.G[3],wt.H[3],Pe),Pe.h)break;x[tt]=(nn<<24|Dt<<16|vt<<8|sn)>>>0}if(Dt=!1,++tt,++te>=P&&(te=0,++J,Q!=null&&J<=Z&&!(J%16)&&Q(f,J),Je!=null))for(;Ae<tt;)vt=x[Ae++],Je.X[(506832829*vt&4294967295)>>>Je.Mb]=vt}else if(280>vt){if(vt=Et(vt-256,Pe),sn=Zt(wt.G[4],wt.H[4],Pe),re(Pe),sn=Bt(P,sn=Et(sn,Pe)),Pe.h)break;if(tt-k<sn||q-tt<vt)break e;for(nn=0;nn<vt;++nn)x[tt+nn]=x[tt+nn-sn];for(tt+=vt,te+=vt;te>=P;)te-=P,++J,Q!=null&&J<=Z&&!(J%16)&&Q(f,J);if(r(tt<=q),te&mt&&(wt=Wn(Fe,te,J)),Je!=null)for(;Ae<tt;)vt=x[Ae++],Je.X[(506832829*vt&4294967295)>>>Je.Mb]=vt}else{if(!(vt<Ke))break e;for(Dt=vt-280,r(Je!=null);Ae<tt;)vt=x[Ae++],Je.X[(506832829*vt&4294967295)>>>Je.Mb]=vt;vt=tt,r(!(Dt>>>(sn=Je).Xa)),x[vt]=sn.X[Dt],Dt=!0}Dt||r(Pe.h==ie(Pe))}if(f.Pb&&Pe.h&&tt<q)r(f.m.h),f.a=5,f.m=f.wd,f.$=f.xd,0<f.s.ua&&kt(f.s.vb,f.s.Wa);else{if(Pe.h)break e;Q?.(f,J>Z?Z:J),f.a=0,f.$=tt-k}return 1}return f.a=3,0}function Ei(f){r(f!=null),f.vc=null,f.yc=null,f.Ya=null;var x=f.Wa;x!=null&&(x.X=null),f.vb=null,r(f!=null)}function bo(){var f=new fn;return f==null?null:(f.a=0,f.xb=gu,Kt("Predictor","VP8LPredictors"),Kt("Predictor","VP8LPredictors_C"),Kt("PredictorAdd","VP8LPredictorsAdd"),Kt("PredictorAdd","VP8LPredictorsAdd_C"),pr=Mt,Es=_t,Pl=jt,Vo=en,fl=Qe,ys=At,Yl=un,Y.VP8LMapColor32b=Po,Y.VP8LMapColor8b=Hr,f)}function ya(f,x,k,P,q){var Z=1,Q=[f],J=[x],te=P.m,Pe=P.s,Fe=null,tt=0;e:for(;;){if(k)for(;Z&&C(te,1);){var Ae=Q,Ve=J,Ke=P,ft=1,Je=Ke.m,mt=Ke.gc[Ke.ab],wt=C(Je,2);if(Ke.Oc&1<<wt)Z=0;else{switch(Ke.Oc|=1<<wt,mt.hc=wt,mt.Ea=Ae[0],mt.nc=Ve[0],mt.K=[null],++Ke.ab,r(4>=Ke.ab),wt){case 0:case 1:mt.b=C(Je,3)+2,ft=ya(ht(mt.Ea,mt.b),ht(mt.nc,mt.b),0,Ke,mt.K),mt.K=mt.K[0];break;case 3:var Dt,vt=C(Je,8)+1,sn=16<vt?0:4<vt?1:2<vt?2:3;if(Ae[0]=ht(mt.Ea,sn),mt.b=sn,Dt=ft=ya(vt,1,0,Ke,mt.K)){var nn,ti=vt,Xt=mt,Cn=1<<(8>>Xt.b),Nr=d(Cn);if(Nr==null)Dt=0;else{var ni=Xt.K[0],gn=Xt.w;for(Nr[0]=Xt.K[0][0],nn=1;nn<1*ti;++nn)Nr[nn]=Xe(ni[gn+nn],Nr[nn-1]);for(;nn<4*Cn;++nn)Nr[nn]=0;Xt.K[0]=null,Xt.K[0]=Nr,Dt=1}}ft=Dt;break;case 2:break;default:r(0)}Z=ft}}if(Q=Q[0],J=J[0],Z&&C(te,1)&&!(Z=1<=(tt=C(te,4))&&11>=tt)){P.a=3;break e}var $t;if($t=Z)t:{var Ar,yn,Un,Bi=P,Ir=Q,la=J,Hi=tt,zr=k,fo=Bi.m,Jr=Bi.s,Qn=[null],ai=1,_i=0,pi=Do[Hi];n:for(;;){if(zr&&C(fo,1)){var xr=C(fo,3)+2,yr=ht(Ir,xr),Oi=ht(la,xr),Xi=yr*Oi;if(!ya(yr,Oi,0,Bi,Qn))break n;for(Qn=Qn[0],Jr.xc=xr,Ar=0;Ar<Xi;++Ar){var Wi=Qn[Ar]>>8&65535;Qn[Ar]=Wi,Wi>=ai&&(ai=Wi+1)}}if(fo.h)break n;for(yn=0;5>yn;++yn){var Qr=ss[yn];!yn&&0<Hi&&(Qr+=1<<Hi),_i<Qr&&(_i=Qr)}var ca=v(ai*pi,U),ar=ai,Fi=v(ar,_e);if(Fi==null)var Oa=null;else r(65536>=ar),Oa=Fi;var sr=d(_i);if(Oa==null||sr==null||ca==null){Bi.a=1;break n}var Pn=ca;for(Ar=Un=0;Ar<ai;++Ar){var Mn=Oa[Ar],Ui=Mn.G,Io=Mn.H,Bo=0,po=1,Br=0;for(yn=0;5>yn;++yn){Qr=ss[yn],Ui[yn]=Pn,Io[yn]=Un,!yn&&0<Hi&&(Qr+=1<<Hi);r:{var bs,tl=Qr,ec=Bi,tr=sr,tc=Pn,Wc=Un,Tc=0,vs=ec.m,Wu=C(vs,1);if(c(tr,0,0,tl),Wu){var $c=C(vs,1)+1,xu=C(vs,1),yl=C(vs,xu==0?1:8);tr[yl]=1,$c==2&&(tr[yl=C(vs,8)]=1);var ea=1}else{var Er=d(19),nc=C(vs,4)+4;if(19<nc){ec.a=3;var Hs=0;break r}for(bs=0;bs<nc;++bs)Er[Os[bs]]=C(vs,3);var Ml=void 0,ic=void 0,ho=ec,Cc=Er,nl=tl,Yc=tr,Gc=0,ws=ho.m,yu=8,Il=v(128,U);i:for(;R(Il,0,7,Cc,19);){if(C(ws,1)){var mu=2+2*C(ws,3);if((Ml=2+C(ws,mu))>nl)break i}else Ml=nl;for(ic=0;ic<nl&&Ml--;){re(ws);var bu=Il[0+(127&V(ws))];he(ws,ws.u+bu.g);var ml=bu.value;if(16>ml)Yc[ic++]=ml,ml!=0&&(yu=ml);else{var Xc=ml==16,Kc=ml-16,rc=Kl[Kc],kc=C(ws,lo[Kc])+rc;if(ic+kc>nl)break i;for(var Nc=Xc?yu:0;0<kc--;)Yc[ic++]=Nc}}Gc=1;break i}Gc||(ho.a=3),ea=Gc}(ea=ea&&!vs.h)&&(Tc=R(tc,Wc,8,tr,tl)),ea&&Tc!=0?Hs=Tc:(ec.a=3,Hs=0)}if(Hs==0)break n;if(po&&Dl[yn]==1&&(po=Pn[Un].g==0),Bo+=Pn[Un].g,Un+=Hs,3>=yn){var ac,Ac=sr[0];for(ac=1;ac<Qr;++ac)sr[ac]>Ac&&(Ac=sr[ac]);Br+=Ac}}if(Mn.nd=po,Mn.Qb=0,po&&(Mn.qb=(Ui[3][Io[3]+0].value<<24|Ui[1][Io[1]+0].value<<16|Ui[2][Io[2]+0].value)>>>0,Bo==0&&256>Ui[0][Io[0]+0].value&&(Mn.Qb=1,Mn.qb+=Ui[0][Io[0]+0].value<<8)),Mn.jc=!Mn.Qb&&6>Br,Mn.jc){var Zc,cs=Mn;for(Zc=0;Zc<Ao;++Zc){var Fa=Zc,Ua=cs.pd[Fa],us=cs.G[0][cs.H[0]+Fa];256<=us.value?(Ua.g=us.g+256,Ua.value=us.value):(Ua.g=0,Ua.value=0,Fa>>=on(us,8,Ua),Fa>>=on(cs.G[1][cs.H[1]+Fa],16,Ua),Fa>>=on(cs.G[2][cs.H[2]+Fa],0,Ua),on(cs.G[3][cs.H[3]+Fa],24,Ua))}}}Jr.vc=Qn,Jr.Wb=ai,Jr.Ya=Oa,Jr.yc=ca,$t=1;break t}$t=0}if(!(Z=$t)){P.a=3;break e}if(0<tt){if(Pe.ua=1<<tt,!se(Pe.Wa,tt)){P.a=1,Z=0;break e}}else Pe.ua=0;var vu=P,oc=Q,vd=J,zc=vu.s,Pc=zc.xc;if(vu.c=oc,vu.i=vd,zc.md=ht(oc,Pc),zc.wc=Pc==0?-1:(1<<Pc)-1,k){P.xb=Ll;break e}if((Fe=d(Q*J))==null){P.a=1,Z=0;break e}Z=(Z=Ri(P,Fe,0,Q,J,J,null))&&!te.h;break e}return Z?(q!=null?q[0]=Fe:(r(Fe==null),r(k)),P.$=0,k||Ei(Pe)):Ei(Pe),Z}function Rr(f,x){var k=f.c*f.i,P=k+x+16*x;return r(f.c<=x),f.V=d(P),f.V==null?(f.Ta=null,f.Ua=0,f.a=1,0):(f.Ta=f.V,f.Ua=f.Ba+k+x,1)}function Ys(f,x){var k=f.C,P=x-k,q=f.V,Z=f.Ba+f.c*k;for(r(x<=f.l.o);0<P;){var Q=16<P?16:P,J=f.l.ma,te=f.l.width,Pe=te*Q,Fe=J.ca,tt=J.tb+te*k,Ae=f.Ta,Ve=f.Ua;qi(f,Q,q,Z),pa(Ae,Ve,Fe,tt,Pe),si(J,k,k+Q,Fe,tt,te),P-=Q,q+=Q*f.c,k+=Q}r(k==x),f.C=f.Ma=x}function Jo(){this.ub=this.yd=this.td=this.Rb=0}function Qo(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function ol(){this.Fb=this.Bb=this.Cb=0,this.Zb=d(4),this.Lb=d(4)}function es(){this.Yb=(function(){var f=[];return(function x(k,P,q){for(var Z=q[P],Q=0;Q<Z&&(k.push(q.length>P+1?[]:0),!(q.length<P+1));Q++)x(k[Q],P+1,q)})(f,0,[3,11]),f})()}function jr(){this.jb=d(3),this.Wc=p([4,8],es),this.Xc=p([4,17],es)}function Gs(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new d(4),this.od=new d(4)}function Jn(){this.ld=this.La=this.dd=this.tc=0}function ma(){this.Na=this.la=0}function di(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function As(){this.ad=d(384),this.Za=0,this.Ob=d(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Di(){this.uc=this.M=this.Nb=0,this.wa=Array(new Jn),this.Y=0,this.ya=Array(new As),this.aa=0,this.l=new vo}function zs(){this.y=d(16),this.f=d(8),this.ea=d(8)}function ir(){this.cb=this.a=0,this.sc="",this.m=new z,this.Od=new Jo,this.Kc=new Qo,this.ed=new Gs,this.Qa=new ol,this.Ic=this.$c=this.Aa=0,this.D=new Di,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=v(8,z),this.ia=0,this.pb=v(4,di),this.Pa=new jr,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new zs),this.Hd=0,this.rb=Array(new ma),this.sb=0,this.wa=Array(new Jn),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new As),this.L=this.aa=0,this.gd=p([4,2],Jn),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Na(f,x){return 0>f?0:f>x?x:f}function vo(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Ha(){var f=new ir;return f!=null&&(f.a=0,f.sc="OK",f.cb=0,f.Xb=0,Yo||(Yo=Tr)),f}function Ti(f,x,k){return f.a==0&&(f.a=x,f.sc=k,f.cb=0),0}function Oo(f,x,k){return 3<=k&&f[x+0]==157&&f[x+1]==1&&f[x+2]==42}function hs(f,x){if(f==null)return 0;if(f.a=0,f.sc="OK",x==null)return Ti(f,2,"null VP8Io passed to VP8GetHeaders()");var k=x.data,P=x.w,q=x.ha;if(4>q)return Ti(f,7,"Truncated header.");var Z=k[P+0]|k[P+1]<<8|k[P+2]<<16,Q=f.Od;if(Q.Rb=!(1&Z),Q.td=Z>>1&7,Q.yd=Z>>4&1,Q.ub=Z>>5,3<Q.td)return Ti(f,3,"Incorrect keyframe parameters.");if(!Q.yd)return Ti(f,4,"Frame not displayable.");P+=3,q-=3;var J=f.Kc;if(Q.Rb){if(7>q)return Ti(f,7,"cannot parse picture header");if(!Oo(k,P,q))return Ti(f,3,"Bad code word");J.c=16383&(k[P+4]<<8|k[P+3]),J.Td=k[P+4]>>6,J.i=16383&(k[P+6]<<8|k[P+5]),J.Ud=k[P+6]>>6,P+=7,q-=7,f.za=J.c+15>>4,f.Ub=J.i+15>>4,x.width=J.c,x.height=J.i,x.Da=0,x.j=0,x.v=0,x.va=x.width,x.o=x.height,x.da=0,x.ib=x.width,x.hb=x.height,x.U=x.width,x.T=x.height,c((Z=f.Pa).jb,0,255,Z.jb.length),r((Z=f.Qa)!=null),Z.Cb=0,Z.Bb=0,Z.Fb=1,c(Z.Zb,0,0,Z.Zb.length),c(Z.Lb,0,0,Z.Lb)}if(Q.ub>q)return Ti(f,7,"bad partition length");ce(Z=f.m,k,P,Q.ub),P+=Q.ub,q-=Q.ub,Q.Rb&&(J.Ld=Re(Z),J.Kd=Re(Z)),J=f.Qa;var te,Pe=f.Pa;if(r(Z!=null),r(J!=null),J.Cb=Re(Z),J.Cb){if(J.Bb=Re(Z),Re(Z)){for(J.Fb=Re(Z),te=0;4>te;++te)J.Zb[te]=Re(Z)?fe(Z,7):0;for(te=0;4>te;++te)J.Lb[te]=Re(Z)?fe(Z,6):0}if(J.Bb)for(te=0;3>te;++te)Pe.jb[te]=Re(Z)?xe(Z,8):255}else J.Bb=0;if(Z.Ka)return Ti(f,3,"cannot parse segment header");if((J=f.ed).zd=Re(Z),J.Tb=xe(Z,6),J.wb=xe(Z,3),J.Pc=Re(Z),J.Pc&&Re(Z)){for(Pe=0;4>Pe;++Pe)Re(Z)&&(J.vd[Pe]=fe(Z,6));for(Pe=0;4>Pe;++Pe)Re(Z)&&(J.od[Pe]=fe(Z,6))}if(f.L=J.Tb==0?0:J.zd?1:2,Z.Ka)return Ti(f,3,"cannot parse filter header");var Fe=q;if(q=te=P,P=te+Fe,J=Fe,f.Xb=(1<<xe(f.m,2))-1,Fe<3*(Pe=f.Xb))k=7;else{for(te+=3*Pe,J-=3*Pe,Fe=0;Fe<Pe;++Fe){var tt=k[q+0]|k[q+1]<<8|k[q+2]<<16;tt>J&&(tt=J),ce(f.Jc[+Fe],k,te,tt),te+=tt,J-=tt,q+=3}ce(f.Jc[+Pe],k,te,J),k=te<P?0:5}if(k!=0)return Ti(f,k,"cannot parse partitions");for(k=xe(te=f.m,7),q=Re(te)?fe(te,4):0,P=Re(te)?fe(te,4):0,J=Re(te)?fe(te,4):0,Pe=Re(te)?fe(te,4):0,te=Re(te)?fe(te,4):0,Fe=f.Qa,tt=0;4>tt;++tt){if(Fe.Cb){var Ae=Fe.Zb[tt];Fe.Fb||(Ae+=k)}else{if(0<tt){f.pb[tt]=f.pb[0];continue}Ae=k}var Ve=f.pb[tt];Ve.Sc[0]=Da[Na(Ae+q,127)],Ve.Sc[1]=La[Na(Ae+0,127)],Ve.Eb[0]=2*Da[Na(Ae+P,127)],Ve.Eb[1]=101581*La[Na(Ae+J,127)]>>16,8>Ve.Eb[1]&&(Ve.Eb[1]=8),Ve.Qc[0]=Da[Na(Ae+Pe,117)],Ve.Qc[1]=La[Na(Ae+te,127)],Ve.lc=Ae+te}if(!Q.Rb)return Ti(f,4,"Not a key frame.");for(Re(Z),Q=f.Pa,k=0;4>k;++k){for(q=0;8>q;++q)for(P=0;3>P;++P)for(J=0;11>J;++J)Pe=Ue(Z,er[k][q][P][J])?xe(Z,8):qc[k][q][P][J],Q.Wc[k][q].Yb[P][J]=Pe;for(q=0;17>q;++q)Q.Xc[k][q]=Q.Wc[k][fi[q]]}return f.kc=Re(Z),f.kc&&(f.Bd=xe(Z,8)),f.cb=1}function Tr(f,x,k,P,q,Z,Q){var J=x[q].Yb[k];for(k=0;16>q;++q){if(!Ue(f,J[k+0]))return q;for(;!Ue(f,J[k+1]);)if(J=x[++q].Yb[0],k=0,q==16)return 16;var te=x[q+1].Yb;if(Ue(f,J[k+2])){var Pe=f,Fe=0;if(Ue(Pe,(Ae=J)[(tt=k)+3]))if(Ue(Pe,Ae[tt+6])){for(J=0,tt=2*(Fe=Ue(Pe,Ae[tt+8]))+(Ae=Ue(Pe,Ae[tt+9+Fe])),Fe=0,Ae=Us[tt];Ae[J];++J)Fe+=Fe+Ue(Pe,Ae[J]);Fe+=3+(8<<tt)}else Ue(Pe,Ae[tt+7])?(Fe=7+2*Ue(Pe,165),Fe+=Ue(Pe,145)):Fe=5+Ue(Pe,159);else Fe=Ue(Pe,Ae[tt+4])?3+Ue(Pe,Ae[tt+5]):2;J=te[2]}else Fe=1,J=te[1];te=Q+hu[q],0>(Pe=f).b&&Le(Pe);var tt,Ae=Pe.b,Ve=(tt=Pe.Ca>>1)-(Pe.I>>Ae)>>31;--Pe.b,Pe.Ca+=Ve,Pe.Ca|=1,Pe.I-=(tt+1&Ve)<<Ae,Z[te]=((Fe^Ve)-Ve)*P[(0<q)+0]}return 16}function oo(f){var x=f.rb[f.sb-1];x.la=0,x.Na=0,c(f.zc,0,0,f.zc.length),f.ja=0}function vn(f,x,k,P,q){q=f[x+k+32*P]+(q>>3),f[x+k+32*P]=-256&q?0>q?0:255:q}function wi(f,x,k,P,q,Z){vn(f,x,0,k,P+q),vn(f,x,1,k,P+Z),vn(f,x,2,k,P-Z),vn(f,x,3,k,P-q)}function ui(f){return(20091*f>>16)+f}function Dr(f,x,k,P){var q,Z=0,Q=d(16);for(q=0;4>q;++q){var J=f[x+0]+f[x+8],te=f[x+0]-f[x+8],Pe=(35468*f[x+4]>>16)-ui(f[x+12]),Fe=ui(f[x+4])+(35468*f[x+12]>>16);Q[Z+0]=J+Fe,Q[Z+1]=te+Pe,Q[Z+2]=te-Pe,Q[Z+3]=J-Fe,Z+=4,x++}for(q=Z=0;4>q;++q)J=(f=Q[Z+0]+4)+Q[Z+8],te=f-Q[Z+8],Pe=(35468*Q[Z+4]>>16)-ui(Q[Z+12]),vn(k,P,0,0,J+(Fe=ui(Q[Z+4])+(35468*Q[Z+12]>>16))),vn(k,P,1,0,te+Pe),vn(k,P,2,0,te-Pe),vn(k,P,3,0,J-Fe),Z++,P+=32}function Xs(f,x,k,P){var q=f[x+0]+4,Z=35468*f[x+4]>>16,Q=ui(f[x+4]),J=35468*f[x+1]>>16;wi(k,P,0,q+Q,f=ui(f[x+1]),J),wi(k,P,1,q+Z,f,J),wi(k,P,2,q-Z,f,J),wi(k,P,3,q-Q,f,J)}function sl(f,x,k,P,q){Dr(f,x,k,P),q&&Dr(f,x+16,k,P+4)}function dr(f,x,k,P){Ga(f,x+0,k,P,1),Ga(f,x+32,k,P+128,1)}function Aa(f,x,k,P){var q;for(f=f[x+0]+4,q=0;4>q;++q)for(x=0;4>x;++x)vn(k,P,x,q,f)}function Ps(f,x,k,P){f[x+0]&&ki(f,x+0,k,P),f[x+16]&&ki(f,x+16,k,P+4),f[x+32]&&ki(f,x+32,k,P+128),f[x+48]&&ki(f,x+48,k,P+128+4)}function wo(f,x,k,P){var q,Z=d(16);for(q=0;4>q;++q){var Q=f[x+0+q]+f[x+12+q],J=f[x+4+q]+f[x+8+q],te=f[x+4+q]-f[x+8+q],Pe=f[x+0+q]-f[x+12+q];Z[0+q]=Q+J,Z[8+q]=Q-J,Z[4+q]=Pe+te,Z[12+q]=Pe-te}for(q=0;4>q;++q)Q=(f=Z[0+4*q]+3)+Z[3+4*q],J=Z[1+4*q]+Z[2+4*q],te=Z[1+4*q]-Z[2+4*q],Pe=f-Z[3+4*q],k[P+0]=Q+J>>3,k[P+16]=Pe+te>>3,k[P+32]=Q-J>>3,k[P+48]=Pe-te>>3,P+=64}function Ks(f,x,k){var P,q=x-32,Z=hr,Q=255-f[q-1];for(P=0;P<k;++P){var J,te=Z,Pe=Q+f[x-1];for(J=0;J<k;++J)f[x+J]=te[Pe+f[q+J]];x+=32}}function So(f,x){Ks(f,x,4)}function Ft(f,x){Ks(f,x,8)}function br(f,x){Ks(f,x,16)}function za(f,x){var k;for(k=0;16>k;++k)s(f,x+32*k,f,x-32,16)}function Fo(f,x){var k;for(k=16;0<k;--k)c(f,x,f[x-1],16),x+=32}function rr(f,x,k){var P;for(P=0;16>P;++P)c(x,k+32*P,f,16)}function ba(f,x){var k,P=16;for(k=0;16>k;++k)P+=f[x-1+32*k]+f[x+k-32];rr(P>>5,f,x)}function jo(f,x){var k,P=8;for(k=0;16>k;++k)P+=f[x-1+32*k];rr(P>>4,f,x)}function To(f,x){var k,P=8;for(k=0;16>k;++k)P+=f[x+k-32];rr(P>>4,f,x)}function ll(f,x){rr(128,f,x)}function qn(f,x,k){return f+2*x+k+2>>2}function Ec(f,x){var k,P=x-32;for(P=new Uint8Array([qn(f[P-1],f[P+0],f[P+1]),qn(f[P+0],f[P+1],f[P+2]),qn(f[P+1],f[P+2],f[P+3]),qn(f[P+2],f[P+3],f[P+4])]),k=0;4>k;++k)s(f,x+32*k,P,0,P.length)}function $l(f,x){var k=f[x-1],P=f[x-1+32],q=f[x-1+64],Z=f[x-1+96];et(f,x+0,16843009*qn(f[x-1-32],k,P)),et(f,x+32,16843009*qn(k,P,q)),et(f,x+64,16843009*qn(P,q,Z)),et(f,x+96,16843009*qn(q,Z,Z))}function Lr(f,x){var k,P=4;for(k=0;4>k;++k)P+=f[x+k-32]+f[x-1+32*k];for(P>>=3,k=0;4>k;++k)c(f,x+32*k,P,4)}function zi(f,x){var k=f[x-1+0],P=f[x-1+32],q=f[x-1+64],Z=f[x-1-32],Q=f[x+0-32],J=f[x+1-32],te=f[x+2-32],Pe=f[x+3-32];f[x+0+96]=qn(P,q,f[x-1+96]),f[x+1+96]=f[x+0+64]=qn(k,P,q),f[x+2+96]=f[x+1+64]=f[x+0+32]=qn(Z,k,P),f[x+3+96]=f[x+2+64]=f[x+1+32]=f[x+0+0]=qn(Q,Z,k),f[x+3+64]=f[x+2+32]=f[x+1+0]=qn(J,Q,Z),f[x+3+32]=f[x+2+0]=qn(te,J,Q),f[x+3+0]=qn(Pe,te,J)}function na(f,x){var k=f[x+1-32],P=f[x+2-32],q=f[x+3-32],Z=f[x+4-32],Q=f[x+5-32],J=f[x+6-32],te=f[x+7-32];f[x+0+0]=qn(f[x+0-32],k,P),f[x+1+0]=f[x+0+32]=qn(k,P,q),f[x+2+0]=f[x+1+32]=f[x+0+64]=qn(P,q,Z),f[x+3+0]=f[x+2+32]=f[x+1+64]=f[x+0+96]=qn(q,Z,Q),f[x+3+32]=f[x+2+64]=f[x+1+96]=qn(Z,Q,J),f[x+3+64]=f[x+2+96]=qn(Q,J,te),f[x+3+96]=qn(J,te,te)}function Oc(f,x){var k=f[x-1+0],P=f[x-1+32],q=f[x-1+64],Z=f[x-1-32],Q=f[x+0-32],J=f[x+1-32],te=f[x+2-32],Pe=f[x+3-32];f[x+0+0]=f[x+1+64]=Z+Q+1>>1,f[x+1+0]=f[x+2+64]=Q+J+1>>1,f[x+2+0]=f[x+3+64]=J+te+1>>1,f[x+3+0]=te+Pe+1>>1,f[x+0+96]=qn(q,P,k),f[x+0+64]=qn(P,k,Z),f[x+0+32]=f[x+1+96]=qn(k,Z,Q),f[x+1+32]=f[x+2+96]=qn(Z,Q,J),f[x+2+32]=f[x+3+96]=qn(Q,J,te),f[x+3+32]=qn(J,te,Pe)}function ii(f,x){var k=f[x+0-32],P=f[x+1-32],q=f[x+2-32],Z=f[x+3-32],Q=f[x+4-32],J=f[x+5-32],te=f[x+6-32],Pe=f[x+7-32];f[x+0+0]=k+P+1>>1,f[x+1+0]=f[x+0+64]=P+q+1>>1,f[x+2+0]=f[x+1+64]=q+Z+1>>1,f[x+3+0]=f[x+2+64]=Z+Q+1>>1,f[x+0+32]=qn(k,P,q),f[x+1+32]=f[x+0+96]=qn(P,q,Z),f[x+2+32]=f[x+1+96]=qn(q,Z,Q),f[x+3+32]=f[x+2+96]=qn(Z,Q,J),f[x+3+64]=qn(Q,J,te),f[x+3+96]=qn(J,te,Pe)}function mn(f,x){var k=f[x-1+0],P=f[x-1+32],q=f[x-1+64],Z=f[x-1+96];f[x+0+0]=k+P+1>>1,f[x+2+0]=f[x+0+32]=P+q+1>>1,f[x+2+32]=f[x+0+64]=q+Z+1>>1,f[x+1+0]=qn(k,P,q),f[x+3+0]=f[x+1+32]=qn(P,q,Z),f[x+3+32]=f[x+1+64]=qn(q,Z,Z),f[x+3+64]=f[x+2+64]=f[x+0+96]=f[x+1+96]=f[x+2+96]=f[x+3+96]=Z}function Zs(f,x){var k=f[x-1+0],P=f[x-1+32],q=f[x-1+64],Z=f[x-1+96],Q=f[x-1-32],J=f[x+0-32],te=f[x+1-32],Pe=f[x+2-32];f[x+0+0]=f[x+2+32]=k+Q+1>>1,f[x+0+32]=f[x+2+64]=P+k+1>>1,f[x+0+64]=f[x+2+96]=q+P+1>>1,f[x+0+96]=Z+q+1>>1,f[x+3+0]=qn(J,te,Pe),f[x+2+0]=qn(Q,J,te),f[x+1+0]=f[x+3+32]=qn(k,Q,J),f[x+1+32]=f[x+3+64]=qn(P,k,Q),f[x+1+64]=f[x+3+96]=qn(q,P,k),f[x+1+96]=qn(Z,q,P)}function ts(f,x){var k;for(k=0;8>k;++k)s(f,x+32*k,f,x-32,8)}function $n(f,x){var k;for(k=0;8>k;++k)c(f,x,f[x-1],8),x+=32}function bn(f,x,k){var P;for(P=0;8>P;++P)c(x,k+32*P,f,8)}function mi(f,x){var k,P=8;for(k=0;8>k;++k)P+=f[x+k-32]+f[x-1+32*k];bn(P>>4,f,x)}function _n(f,x){var k,P=4;for(k=0;8>k;++k)P+=f[x+k-32];bn(P>>3,f,x)}function Yn(f,x){var k,P=4;for(k=0;8>k;++k)P+=f[x-1+32*k];bn(P>>3,f,x)}function Tn(f,x){bn(128,f,x)}function gs(f,x,k){var P=f[x-k],q=f[x+0],Z=3*(q-P)+va[1020+f[x-2*k]-f[x+k]],Q=oa[112+(Z+4>>3)];f[x-k]=hr[255+P+oa[112+(Z+3>>3)]],f[x+0]=hr[255+q-Q]}function tn(f,x,k,P){var q=f[x+0],Z=f[x+k];return Ka[255+f[x-2*k]-f[x-k]]>P||Ka[255+Z-q]>P}function Li(f,x,k,P){return 4*Ka[255+f[x-k]-f[x+0]]+Ka[255+f[x-2*k]-f[x+k]]<=P}function cn(f,x,k,P,q){var Z=f[x-3*k],Q=f[x-2*k],J=f[x-k],te=f[x+0],Pe=f[x+k],Fe=f[x+2*k],tt=f[x+3*k];return 4*Ka[255+J-te]+Ka[255+Q-Pe]>P?0:Ka[255+f[x-4*k]-Z]<=q&&Ka[255+Z-Q]<=q&&Ka[255+Q-J]<=q&&Ka[255+tt-Fe]<=q&&Ka[255+Fe-Pe]<=q&&Ka[255+Pe-te]<=q}function Si(f,x,k,P){var q=2*P+1;for(P=0;16>P;++P)Li(f,x+P,k,q)&&gs(f,x+P,k)}function Wa(f,x,k,P){var q=2*P+1;for(P=0;16>P;++P)Li(f,x+P*k,1,q)&&gs(f,x+P*k,1)}function cl(f,x,k,P){var q;for(q=3;0<q;--q)Si(f,x+=4*k,k,P)}function Pa(f,x,k,P){var q;for(q=3;0<q;--q)Wa(f,x+=4,k,P)}function Uo(f,x,k,P,q,Z,Q,J){for(Z=2*Z+1;0<q--;){if(cn(f,x,k,Z,Q))if(tn(f,x,k,J))gs(f,x,k);else{var te=f,Pe=x,Fe=k,tt=te[Pe-2*Fe],Ae=te[Pe-Fe],Ve=te[Pe+0],Ke=te[Pe+Fe],ft=te[Pe+2*Fe],Je=27*(wt=va[1020+3*(Ve-Ae)+va[1020+tt-Ke]])+63>>7,mt=18*wt+63>>7,wt=9*wt+63>>7;te[Pe-3*Fe]=hr[255+te[Pe-3*Fe]+wt],te[Pe-2*Fe]=hr[255+tt+mt],te[Pe-Fe]=hr[255+Ae+Je],te[Pe+0]=hr[255+Ve-Je],te[Pe+Fe]=hr[255+Ke-mt],te[Pe+2*Fe]=hr[255+ft-wt]}x+=P}}function $a(f,x,k,P,q,Z,Q,J){for(Z=2*Z+1;0<q--;){if(cn(f,x,k,Z,Q))if(tn(f,x,k,J))gs(f,x,k);else{var te=f,Pe=x,Fe=k,tt=te[Pe-Fe],Ae=te[Pe+0],Ve=te[Pe+Fe],Ke=oa[112+(4+(ft=3*(Ae-tt))>>3)],ft=oa[112+(ft+3>>3)],Je=Ke+1>>1;te[Pe-2*Fe]=hr[255+te[Pe-2*Fe]+Je],te[Pe-Fe]=hr[255+tt+ft],te[Pe+0]=hr[255+Ae-Ke],te[Pe+Fe]=hr[255+Ve-Je]}x+=P}}function ul(f,x,k,P,q,Z){Uo(f,x,k,1,16,P,q,Z)}function _s(f,x,k,P,q,Z){Uo(f,x,1,k,16,P,q,Z)}function Fc(f,x,k,P,q,Z){var Q;for(Q=3;0<Q;--Q)$a(f,x+=4*k,k,1,16,P,q,Z)}function j(f,x,k,P,q,Z){var Q;for(Q=3;0<Q;--Q)$a(f,x+=4,1,k,16,P,q,Z)}function W(f,x,k,P,q,Z,Q,J){Uo(f,x,q,1,8,Z,Q,J),Uo(k,P,q,1,8,Z,Q,J)}function ze(f,x,k,P,q,Z,Q,J){Uo(f,x,1,q,8,Z,Q,J),Uo(k,P,1,q,8,Z,Q,J)}function Oe(f,x,k,P,q,Z,Q,J){$a(f,x+4*q,q,1,8,Z,Q,J),$a(k,P+4*q,q,1,8,Z,Q,J)}function Ie(f,x,k,P,q,Z,Q,J){$a(f,x+4,1,q,8,Z,Q,J),$a(k,P+4,1,q,8,Z,Q,J)}function bt(){this.ba=new rt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Lt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function gt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function dn(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Gt(){this.ua=0,this.Wa=new Jt,this.vb=new Jt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new _e,this.yc=new U}function fn(){this.xb=this.a=0,this.l=new vo,this.ca=new rt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new G,this.Pb=0,this.wd=new G,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Gt,this.ab=0,this.gc=v(4,dn),this.Oc=0}function wn(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new vo,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Fn(f,x,k,P,q,Z,Q){for(f=f==null?0:f[x+0],x=0;x<Q;++x)q[Z+x]=f+k[P+x]&255,f=q[Z+x]}function Mi(f,x,k,P,q,Z,Q){var J;if(f==null)Fn(null,null,k,P,q,Z,Q);else for(J=0;J<Q;++J)q[Z+J]=f[x+J]+k[P+J]&255}function fr(f,x,k,P,q,Z,Q){if(f==null)Fn(null,null,k,P,q,Z,Q);else{var J,te=f[x+0],Pe=te,Fe=te;for(J=0;J<Q;++J)Pe=Fe+(te=f[x+J])-Pe,Fe=k[P+J]+(-256&Pe?0>Pe?0:255:Pe)&255,Pe=te,q[Z+J]=Fe}}function vr(f,x,k,P){var q=x.width,Z=x.o;if(r(f!=null&&x!=null),0>k||0>=P||k+P>Z)return null;if(!f.Cc){if(f.ga==null){var Q;if(f.ga=new wn,(Q=f.ga==null)||(Q=x.width*x.o,r(f.Gb.length==0),f.Gb=d(Q),f.Uc=0,f.Gb==null?Q=0:(f.mb=f.Gb,f.nb=f.Uc,f.rc=null,Q=1),Q=!Q),!Q){Q=f.ga;var J=f.Fa,te=f.P,Pe=f.qc,Fe=f.mb,tt=f.nb,Ae=te+1,Ve=Pe-1,Ke=Q.l;if(r(J!=null&&Fe!=null&&x!=null),el[0]=null,el[1]=Fn,el[2]=Mi,el[3]=fr,Q.ca=Fe,Q.tb=tt,Q.c=x.width,Q.i=x.height,r(0<Q.c&&0<Q.i),1>=Pe)x=0;else if(Q.$a=3&J[te+0],Q.Z=J[te+0]>>2&3,Q.Lc=J[te+0]>>4&3,te=J[te+0]>>6&3,0>Q.$a||1<Q.$a||4<=Q.Z||1<Q.Lc||te)x=0;else if(Ke.put=Yt,Ke.ac=Zi,Ke.bc=jn,Ke.ma=Q,Ke.width=x.width,Ke.height=x.height,Ke.Da=x.Da,Ke.v=x.v,Ke.va=x.va,Ke.j=x.j,Ke.o=x.o,Q.$a)e:{r(Q.$a==1),x=bo();t:for(;;){if(x==null){x=0;break e}if(r(Q!=null),Q.mc=x,x.c=Q.c,x.i=Q.i,x.l=Q.l,x.l.ma=Q,x.l.width=Q.c,x.l.height=Q.i,x.a=0,ke(x.m,J,Ae,Ve),!ya(Q.c,Q.i,1,x,null)||(x.ab==1&&x.gc[0].hc==3&&yt(x.s)?(Q.ic=1,J=x.c*x.i,x.Ta=null,x.Ua=0,x.V=d(J),x.Ba=0,x.V==null?(x.a=1,x=0):x=1):(Q.ic=0,x=Rr(x,Q.c)),!x))break t;x=1;break e}Q.mc=null,x=0}else x=Ve>=Q.c*Q.i;Q=!x}if(Q)return null;f.ga.Lc!=1?f.Ga=0:P=Z-k}r(f.ga!=null),r(k+P<=Z);e:{if(x=(J=f.ga).c,Z=J.l.o,J.$a==0){if(Ae=f.rc,Ve=f.Vc,Ke=f.Fa,te=f.P+1+k*x,Pe=f.mb,Fe=f.nb+k*x,r(te<=f.P+f.qc),J.Z!=0)for(r(el[J.Z]!=null),Q=0;Q<P;++Q)el[J.Z](Ae,Ve,Ke,te,Pe,Fe,x),Ae=Pe,Ve=Fe,Fe+=x,te+=x;else for(Q=0;Q<P;++Q)s(Pe,Fe,Ke,te,x),Ae=Pe,Ve=Fe,Fe+=x,te+=x;f.rc=Ae,f.Vc=Ve}else{if(r(J.mc!=null),x=k+P,r((Q=J.mc)!=null),r(x<=Q.i),Q.C>=x)x=1;else if(J.ic||Cr(),J.ic){J=Q.V,Ae=Q.Ba,Ve=Q.c;var ft=Q.i,Je=(Ke=1,te=Q.$/Ve,Pe=Q.$%Ve,Fe=Q.m,tt=Q.s,Q.$),mt=Ve*ft,wt=Ve*x,Dt=tt.wc,vt=Je<wt?Wn(tt,Pe,te):null;r(Je<=mt),r(x<=ft),r(yt(tt));t:for(;;){for(;!Fe.h&&Je<wt;){if(Pe&Dt||(vt=Wn(tt,Pe,te)),r(vt!=null),re(Fe),256>(ft=Zt(vt.G[0],vt.H[0],Fe)))J[Ae+Je]=ft,++Je,++Pe>=Ve&&(Pe=0,++te<=x&&!(te%16)&&On(Q,te));else{if(!(280>ft)){Ke=0;break t}ft=Et(ft-256,Fe);var sn,nn=Zt(vt.G[4],vt.H[4],Fe);if(re(Fe),!(Je>=(nn=Bt(Ve,nn=Et(nn,Fe)))&&mt-Je>=ft)){Ke=0;break t}for(sn=0;sn<ft;++sn)J[Ae+Je+sn]=J[Ae+Je+sn-nn];for(Je+=ft,Pe+=ft;Pe>=Ve;)Pe-=Ve,++te<=x&&!(te%16)&&On(Q,te);Je<wt&&Pe&Dt&&(vt=Wn(tt,Pe,te))}r(Fe.h==ie(Fe))}On(Q,te>x?x:te);break t}!Ke||Fe.h&&Je<mt?(Ke=0,Q.a=Fe.h?5:3):Q.$=Je,x=Ke}else x=Ri(Q,Q.V,Q.Ba,Q.c,Q.i,x,Ys);if(!x){P=0;break e}}k+P>=Z&&(f.Cc=1),P=1}if(!P)return null;if(f.Cc&&((P=f.ga)!=null&&(P.mc=null),f.ga=null,0<f.Ga))return alert("todo:WebPDequantizeLevels"),null}return f.nb+k*q}function Ji(f,x,k,P,q,Z){for(;0<q--;){var Q,J=f,te=x+(k?1:0),Pe=f,Fe=x+(k?0:3);for(Q=0;Q<P;++Q){var tt=Pe[Fe+4*Q];tt!=255&&(tt*=32897,J[te+4*Q+0]=J[te+4*Q+0]*tt>>23,J[te+4*Q+1]=J[te+4*Q+1]*tt>>23,J[te+4*Q+2]=J[te+4*Q+2]*tt>>23)}x+=Z}}function ia(f,x,k,P,q){for(;0<P--;){var Z;for(Z=0;Z<k;++Z){var Q=f[x+2*Z+0],J=15&(Pe=f[x+2*Z+1]),te=4369*J,Pe=(240&Pe|Pe>>4)*te>>16;f[x+2*Z+0]=(240&Q|Q>>4)*te>>16&240|(15&Q|Q<<4)*te>>16>>4&15,f[x+2*Z+1]=240&Pe|J}x+=q}}function Gr(f,x,k,P,q,Z,Q,J){var te,Pe,Fe=255;for(Pe=0;Pe<q;++Pe){for(te=0;te<P;++te){var tt=f[x+te];Z[Q+4*te]=tt,Fe&=tt}x+=k,Q+=J}return Fe!=255}function dl(f,x,k,P,q){var Z;for(Z=0;Z<q;++Z)k[P+Z]=f[x+Z]>>8}function Cr(){Wo=Ji,ra=ia,os=Gr,pa=dl}function qo(f,x,k){Y[f]=function(P,q,Z,Q,J,te,Pe,Fe,tt,Ae,Ve,Ke,ft,Je,mt,wt,Dt){var vt,sn=Dt-1>>1,nn=J[te+0]|Pe[Fe+0]<<16,ti=tt[Ae+0]|Ve[Ke+0]<<16;r(P!=null);var Xt=3*nn+ti+131074>>2;for(x(P[q+0],255&Xt,Xt>>16,ft,Je),Z!=null&&(Xt=3*ti+nn+131074>>2,x(Z[Q+0],255&Xt,Xt>>16,mt,wt)),vt=1;vt<=sn;++vt){var Cn=J[te+vt]|Pe[Fe+vt]<<16,Nr=tt[Ae+vt]|Ve[Ke+vt]<<16,ni=nn+Cn+ti+Nr+524296,gn=ni+2*(Cn+ti)>>3;Xt=gn+nn>>1,nn=(ni=ni+2*(nn+Nr)>>3)+Cn>>1,x(P[q+2*vt-1],255&Xt,Xt>>16,ft,Je+(2*vt-1)*k),x(P[q+2*vt-0],255&nn,nn>>16,ft,Je+(2*vt-0)*k),Z!=null&&(Xt=ni+ti>>1,nn=gn+Nr>>1,x(Z[Q+2*vt-1],255&Xt,Xt>>16,mt,wt+(2*vt-1)*k),x(Z[Q+2*vt+0],255&nn,nn>>16,mt,wt+(2*vt+0)*k)),nn=Cn,ti=Nr}1&Dt||(Xt=3*nn+ti+131074>>2,x(P[q+Dt-1],255&Xt,Xt>>16,ft,Je+(Dt-1)*k),Z!=null&&(Xt=3*ti+nn+131074>>2,x(Z[Q+Dt-1],255&Xt,Xt>>16,mt,wt+(Dt-1)*k)))}}function da(){Qa[Qs]=Zl,Qa[Za]=Jl,Qa[Xl]=Vc,Qa[bi]=Hc,Qa[Ra]=gl,Qa[Rl]=eo,Qa[pl]=Zr,Qa[wc]=Jl,Qa[Sc]=Hc,Qa[hl]=gl,Qa[jc]=eo}function Rs(f){return f&-16384?0>f?0:255:f>>sa}function Xr(f,x){return Rs((19077*f>>8)+(26149*x>>8)-14234)}function Co(f,x,k){return Rs((19077*f>>8)-(6419*x>>8)-(13320*k>>8)+8708)}function ko(f,x){return Rs((19077*f>>8)+(33050*x>>8)-17685)}function Ds(f,x,k,P,q){P[q+0]=Xr(f,k),P[q+1]=Co(f,x,k),P[q+2]=ko(f,x)}function Vi(f,x,k,P,q){P[q+0]=ko(f,x),P[q+1]=Co(f,x,k),P[q+2]=Xr(f,k)}function ns(f,x,k,P,q){var Z=Co(f,x,k);x=Z<<3&224|ko(f,x)>>3,P[q+0]=248&Xr(f,k)|Z>>5,P[q+1]=x}function Kr(f,x,k,P,q){var Z=240&ko(f,x)|15;P[q+0]=240&Xr(f,k)|Co(f,x,k)>>4,P[q+1]=Z}function Ls(f,x,k,P,q){P[q+0]=255,Ds(f,x,k,P,q+1)}function Vr(f,x,k,P,q){Vi(f,x,k,P,q),P[q+3]=255}function fa(f,x,k,P,q){Ds(f,x,k,P,q),P[q+3]=255}function Qi(f,x,k){Y[f]=function(P,q,Z,Q,J,te,Pe,Fe,tt){for(var Ae=Fe+(-2&tt)*k;Fe!=Ae;)x(P[q+0],Z[Q+0],J[te+0],Pe,Fe),x(P[q+1],Z[Q+0],J[te+0],Pe,Fe+k),q+=2,++Q,++te,Fe+=2*k;1&tt&&x(P[q+0],Z[Q+0],J[te+0],Pe,Fe)}}function Ms(f,x,k){return k==0?f==0?x==0?6:5:x==0?4:0:k}function Uc(f,x,k,P,q){switch(f>>>30){case 3:Ga(x,k,P,q,0);break;case 2:_a(x,k,P,q);break;case 1:ki(x,k,P,q)}}function is(f,x){var k,P,q=x.M,Z=x.Nb,Q=f.oc,J=f.pc+40,te=f.oc,Pe=f.pc+584,Fe=f.oc,tt=f.pc+600;for(k=0;16>k;++k)Q[J+32*k-1]=129;for(k=0;8>k;++k)te[Pe+32*k-1]=129,Fe[tt+32*k-1]=129;for(0<q?Q[J-1-32]=te[Pe-1-32]=Fe[tt-1-32]=129:(c(Q,J-32-1,127,21),c(te,Pe-32-1,127,9),c(Fe,tt-32-1,127,9)),P=0;P<f.za;++P){var Ae=x.ya[x.aa+P];if(0<P){for(k=-1;16>k;++k)s(Q,J+32*k-4,Q,J+32*k+12,4);for(k=-1;8>k;++k)s(te,Pe+32*k-4,te,Pe+32*k+4,4),s(Fe,tt+32*k-4,Fe,tt+32*k+4,4)}var Ve=f.Gd,Ke=f.Hd+P,ft=Ae.ad,Je=Ae.Hc;if(0<q&&(s(Q,J-32,Ve[Ke].y,0,16),s(te,Pe-32,Ve[Ke].f,0,8),s(Fe,tt-32,Ve[Ke].ea,0,8)),Ae.Za){var mt=Q,wt=J-32+16;for(0<q&&(P>=f.za-1?c(mt,wt,Ve[Ke].y[15],4):s(mt,wt,Ve[Ke+1].y,0,4)),k=0;4>k;k++)mt[wt+128+k]=mt[wt+256+k]=mt[wt+384+k]=mt[wt+0+k];for(k=0;16>k;++k,Je<<=2)mt=Q,wt=J+Ii[k],gr[Ae.Ob[k]](mt,wt),Uc(Je,ft,16*+k,mt,wt)}else if(mt=Ms(P,q,Ae.Ob[0]),Ba[mt](Q,J),Je!=0)for(k=0;16>k;++k,Je<<=2)Uc(Je,ft,16*+k,Q,J+Ii[k]);for(k=Ae.Gc,mt=Ms(P,q,Ae.Dd),wa[mt](te,Pe),wa[mt](Fe,tt),Je=ft,mt=te,wt=Pe,255&(Ae=0|k)&&(170&Ae?_o(Je,256,mt,wt):ri(Je,256,mt,wt)),Ae=Fe,Je=tt,255&(k>>=8)&&(170&k?_o(ft,320,Ae,Je):ri(ft,320,Ae,Je)),q<f.Ub-1&&(s(Ve[Ke].y,0,Q,J+480,16),s(Ve[Ke].f,0,te,Pe+224,8),s(Ve[Ke].ea,0,Fe,tt+224,8)),k=8*Z*f.B,Ve=f.sa,Ke=f.ta+16*P+16*Z*f.R,ft=f.qa,Ae=f.ra+8*P+k,Je=f.Ha,mt=f.Ia+8*P+k,k=0;16>k;++k)s(Ve,Ke+k*f.R,Q,J+32*k,16);for(k=0;8>k;++k)s(ft,Ae+k*f.B,te,Pe+32*k,8),s(Je,mt+k*f.B,Fe,tt+32*k,8)}}function No(f,x,k,P,q,Z,Q,J,te){var Pe=[0],Fe=[0],tt=0,Ae=te!=null?te.kd:0,Ve=te??new gt;if(f==null||12>k)return 7;Ve.data=f,Ve.w=x,Ve.ha=k,x=[x],k=[k],Ve.gb=[Ve.gb];e:{var Ke=x,ft=k,Je=Ve.gb;if(r(f!=null),r(ft!=null),r(Je!=null),Je[0]=0,12<=ft[0]&&!o(f,Ke[0],"RIFF")){if(o(f,Ke[0]+8,"WEBP")){Je=3;break e}var mt=Ot(f,Ke[0]+4);if(12>mt||4294967286<mt){Je=3;break e}if(Ae&&mt>ft[0]-8){Je=7;break e}Je[0]=mt,Ke[0]+=12,ft[0]-=12}Je=0}if(Je!=0)return Je;for(mt=0<Ve.gb[0],k=k[0];;){e:{var wt=f;ft=x,Je=k;var Dt=Pe,vt=Fe,sn=Ke=[0];if((Xt=tt=[tt])[0]=0,8>Je[0])Je=7;else{if(!o(wt,ft[0],"VP8X")){if(Ot(wt,ft[0]+4)!=10){Je=3;break e}if(18>Je[0]){Je=7;break e}var nn=Ot(wt,ft[0]+8),ti=1+Ct(wt,ft[0]+12);if(2147483648<=ti*(wt=1+Ct(wt,ft[0]+15))){Je=3;break e}sn!=null&&(sn[0]=nn),Dt!=null&&(Dt[0]=ti),vt!=null&&(vt[0]=wt),ft[0]+=18,Je[0]-=18,Xt[0]=1}Je=0}}if(tt=tt[0],Ke=Ke[0],Je!=0)return Je;if(ft=!!(2&Ke),!mt&&tt)return 3;if(Z!=null&&(Z[0]=!!(16&Ke)),Q!=null&&(Q[0]=ft),J!=null&&(J[0]=0),Q=Pe[0],Ke=Fe[0],tt&&ft&&te==null){Je=0;break}if(4>k){Je=7;break}if(mt&&tt||!mt&&!tt&&!o(f,x[0],"ALPH")){k=[k],Ve.na=[Ve.na],Ve.P=[Ve.P],Ve.Sa=[Ve.Sa];e:{nn=f,Je=x,mt=k;var Xt=Ve.gb;Dt=Ve.na,vt=Ve.P,sn=Ve.Sa,ti=22,r(nn!=null),r(mt!=null),wt=Je[0];var Cn=mt[0];for(r(Dt!=null),r(sn!=null),Dt[0]=null,vt[0]=null,sn[0]=0;;){if(Je[0]=wt,mt[0]=Cn,8>Cn){Je=7;break e}var Nr=Ot(nn,wt+4);if(4294967286<Nr){Je=3;break e}var ni=8+Nr+1&-2;if(ti+=ni,0<Xt&&ti>Xt){Je=3;break e}if(!o(nn,wt,"VP8 ")||!o(nn,wt,"VP8L")){Je=0;break e}if(Cn[0]<ni){Je=7;break e}o(nn,wt,"ALPH")||(Dt[0]=nn,vt[0]=wt+8,sn[0]=Nr),wt+=ni,Cn-=ni}}if(k=k[0],Ve.na=Ve.na[0],Ve.P=Ve.P[0],Ve.Sa=Ve.Sa[0],Je!=0)break}k=[k],Ve.Ja=[Ve.Ja],Ve.xa=[Ve.xa];e:if(Xt=f,Je=x,mt=k,Dt=Ve.gb[0],vt=Ve.Ja,sn=Ve.xa,nn=Je[0],wt=!o(Xt,nn,"VP8 "),ti=!o(Xt,nn,"VP8L"),r(Xt!=null),r(mt!=null),r(vt!=null),r(sn!=null),8>mt[0])Je=7;else{if(wt||ti){if(Xt=Ot(Xt,nn+4),12<=Dt&&Xt>Dt-12){Je=3;break e}if(Ae&&Xt>mt[0]-8){Je=7;break e}vt[0]=Xt,Je[0]+=8,mt[0]-=8,sn[0]=ti}else sn[0]=5<=mt[0]&&Xt[nn+0]==47&&!(Xt[nn+4]>>5),vt[0]=mt[0];Je=0}if(k=k[0],Ve.Ja=Ve.Ja[0],Ve.xa=Ve.xa[0],x=x[0],Je!=0)break;if(4294967286<Ve.Ja)return 3;if(J==null||ft||(J[0]=Ve.xa?2:1),Q=[Q],Ke=[Ke],Ve.xa){if(5>k){Je=7;break}J=Q,Ae=Ke,ft=Z,f==null||5>k?f=0:5<=k&&f[x+0]==47&&!(f[x+4]>>5)?(mt=[0],Xt=[0],Dt=[0],ke(vt=new G,f,x,k),ci(vt,mt,Xt,Dt)?(J!=null&&(J[0]=mt[0]),Ae!=null&&(Ae[0]=Xt[0]),ft!=null&&(ft[0]=Dt[0]),f=1):f=0):f=0}else{if(10>k){Je=7;break}J=Ke,f==null||10>k||!Oo(f,x+3,k-3)?f=0:(Ae=f[x+0]|f[x+1]<<8|f[x+2]<<16,ft=16383&(f[x+7]<<8|f[x+6]),f=16383&(f[x+9]<<8|f[x+8]),1&Ae||3<(Ae>>1&7)||!(Ae>>4&1)||Ae>>5>=Ve.Ja||!ft||!f?f=0:(Q&&(Q[0]=ft),J&&(J[0]=f),f=1))}if(!f||(Q=Q[0],Ke=Ke[0],tt&&(Pe[0]!=Q||Fe[0]!=Ke)))return 3;te!=null&&(te[0]=Ve,te.offset=x-te.w,r(4294967286>x-te.w),r(te.offset==te.ha-k));break}return Je==0||Je==7&&tt&&te==null?(Z!=null&&(Z[0]|=Ve.na!=null&&0<Ve.na.length),P!=null&&(P[0]=Q),q!=null&&(q[0]=Ke),0):Je}function xs(f,x,k){var P=x.width,q=x.height,Z=0,Q=0,J=P,te=q;if(x.Da=f!=null&&0<f.Da,x.Da&&(J=f.cd,te=f.bd,Z=f.v,Q=f.j,11>k||(Z&=-2,Q&=-2),0>Z||0>Q||0>=J||0>=te||Z+J>P||Q+te>q))return 0;if(x.v=Z,x.j=Q,x.va=Z+J,x.o=Q+te,x.U=J,x.T=te,x.da=f!=null&&0<f.da,x.da){if(!Wt(J,te,k=[f.ib],Z=[f.hb]))return 0;x.ib=k[0],x.hb=Z[0]}return x.ob=f!=null&&f.ob,x.Kb=f==null||!f.Sd,x.da&&(x.ob=x.ib<3*P/4&&x.hb<3*q/4,x.Kb=0),1}function Al(f){if(f==null)return 2;if(11>f.S){var x=f.f.RGBA;x.fb+=(f.height-1)*x.A,x.A=-x.A}else x=f.f.kb,f=f.height,x.O+=(f-1)*x.fa,x.fa=-x.fa,x.N+=(f-1>>1)*x.Ab,x.Ab=-x.Ab,x.W+=(f-1>>1)*x.Db,x.Db=-x.Db,x.F!=null&&(x.J+=(f-1)*x.lb,x.lb=-x.lb);return 0}function rs(f,x,k,P){if(P==null||0>=f||0>=x)return 2;if(k!=null){if(k.Da){var q=k.cd,Z=k.bd,Q=-2&k.v,J=-2&k.j;if(0>Q||0>J||0>=q||0>=Z||Q+q>f||J+Z>x)return 2;f=q,x=Z}if(k.da){if(!Wt(f,x,q=[k.ib],Z=[k.hb]))return 2;f=q[0],x=Z[0]}}P.width=f,P.height=x;e:{var te=P.width,Pe=P.height;if(f=P.S,0>=te||0>=Pe||!(f>=Qs&&13>f))f=2;else{if(0>=P.Rd&&P.sd==null){Q=Z=q=x=0;var Fe=(J=te*Mo[f])*Pe;if(11>f||(Z=(Pe+1)/2*(x=(te+1)/2),f==12&&(Q=(q=te)*Pe)),(Pe=d(Fe+2*Z+Q))==null){f=1;break e}P.sd=Pe,11>f?((te=P.f.RGBA).eb=Pe,te.fb=0,te.A=J,te.size=Fe):((te=P.f.kb).y=Pe,te.O=0,te.fa=J,te.Fd=Fe,te.f=Pe,te.N=0+Fe,te.Ab=x,te.Cd=Z,te.ea=Pe,te.W=0+Fe+Z,te.Db=x,te.Ed=Z,f==12&&(te.F=Pe,te.J=0+Fe+2*Z),te.Tc=Q,te.lb=q)}if(x=1,q=P.S,Z=P.width,Q=P.height,q>=Qs&&13>q)if(11>q)f=P.f.RGBA,x&=(J=Math.abs(f.A))*(Q-1)+Z<=f.size,x&=J>=Z*Mo[q],x&=f.eb!=null;else{f=P.f.kb,J=(Z+1)/2,Fe=(Q+1)/2,te=Math.abs(f.fa),Pe=Math.abs(f.Ab);var tt=Math.abs(f.Db),Ae=Math.abs(f.lb),Ve=Ae*(Q-1)+Z;x&=te*(Q-1)+Z<=f.Fd,x&=Pe*(Fe-1)+J<=f.Cd,x=(x&=tt*(Fe-1)+J<=f.Ed)&te>=Z&Pe>=J&tt>=J,x&=f.y!=null,x&=f.f!=null,x&=f.ea!=null,q==12&&(x&=Ae>=Z,x&=Ve<=f.Tc,x&=f.F!=null)}else x=0;f=x?0:2}}return f!=0||k!=null&&k.fd&&(f=Al(P)),f}var Ao=64,Ya=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],kr=24,zo=32,so=8,Is=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ut("Predictor0","PredictorAdd0"),Y.Predictor0=function(){return 4278190080},Y.Predictor1=function(f){return f},Y.Predictor2=function(f,x,k){return x[k+0]},Y.Predictor3=function(f,x,k){return x[k+1]},Y.Predictor4=function(f,x,k){return x[k-1]},Y.Predictor5=function(f,x,k){return Ht(Ht(f,x[k+1]),x[k+0])},Y.Predictor6=function(f,x,k){return Ht(f,x[k-1])},Y.Predictor7=function(f,x,k){return Ht(f,x[k+0])},Y.Predictor8=function(f,x,k){return Ht(x[k-1],x[k+0])},Y.Predictor9=function(f,x,k){return Ht(x[k+0],x[k+1])},Y.Predictor10=function(f,x,k){return Ht(Ht(f,x[k-1]),Ht(x[k+0],x[k+1]))},Y.Predictor11=function(f,x,k){var P=x[k+0];return 0>=Ee(P>>24&255,f>>24&255,(x=x[k-1])>>24&255)+Ee(P>>16&255,f>>16&255,x>>16&255)+Ee(P>>8&255,f>>8&255,x>>8&255)+Ee(255&P,255&f,255&x)?P:f},Y.Predictor12=function(f,x,k){var P=x[k+0];return(Nn((f>>24&255)+(P>>24&255)-((x=x[k-1])>>24&255))<<24|Nn((f>>16&255)+(P>>16&255)-(x>>16&255))<<16|Nn((f>>8&255)+(P>>8&255)-(x>>8&255))<<8|Nn((255&f)+(255&P)-(255&x)))>>>0},Y.Predictor13=function(f,x,k){var P=x[k-1];return(zn((f=Ht(f,x[k+0]))>>24&255,P>>24&255)<<24|zn(f>>16&255,P>>16&255)<<16|zn(f>>8&255,P>>8&255)<<8|zn(255&f,255&P))>>>0};var Bs=Y.PredictorAdd0;Y.PredictorAdd1=Ne,Ut("Predictor2","PredictorAdd2"),Ut("Predictor3","PredictorAdd3"),Ut("Predictor4","PredictorAdd4"),Ut("Predictor5","PredictorAdd5"),Ut("Predictor6","PredictorAdd6"),Ut("Predictor7","PredictorAdd7"),Ut("Predictor8","PredictorAdd8"),Ut("Predictor9","PredictorAdd9"),Ut("Predictor10","PredictorAdd10"),Ut("Predictor11","PredictorAdd11"),Ut("Predictor12","PredictorAdd12"),Ut("Predictor13","PredictorAdd13");var zl=Y.PredictorAdd2;Ze("ColorIndexInverseTransform","MapARGB","32b",function(f){return f>>8&255},function(f){return f}),Ze("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(f){return f},function(f){return f>>8&255});var pr,bc=Y.ColorIndexInverseTransform,Po=Y.MapARGB,Ci=Y.VP8LColorIndexInverseTransformAlpha,Hr=Y.MapAlpha,Yi=Y.VP8LPredictorsAdd=[];Yi.length=16,(Y.VP8LPredictors=[]).length=16,(Y.VP8LPredictorsAdd_C=[]).length=16,(Y.VP8LPredictors_C=[]).length=16;var Es,Pl,Vo,fl,ys,Yl,as,Ga,_a,_o,ki,ri,lr,Mr,Js,ms,Gl,vc,Hu,yd,md,bd,Xa,Ho,Wo,ra,os,pa,$o=d(511),Ro=d(2041),_l=d(225),aa=d(767),Pi=0,va=Ro,oa=_l,hr=aa,Ka=$o,Qs=0,Za=1,Xl=2,bi=3,Ra=4,Rl=5,pl=6,wc=7,Sc=8,hl=9,jc=10,lo=[2,3,7],Kl=[3,3,11],ss=[280,256,256,256,40],Dl=[0,1,1,1,0],Os=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Ja=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Do=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Fs=8,Da=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],La=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Yo=null,Us=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],hu=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Ma=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],qc=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Ia=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],er=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],fi=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Ba=[],gr=[],wa=[],Ll=1,gu=2,el=[],Qa=[];qo("UpsampleRgbLinePair",Ds,3),qo("UpsampleBgrLinePair",Vi,3),qo("UpsampleRgbaLinePair",fa,4),qo("UpsampleBgraLinePair",Vr,4),qo("UpsampleArgbLinePair",Ls,4),qo("UpsampleRgba4444LinePair",Kr,2),qo("UpsampleRgb565LinePair",ns,2);var Zl=Y.UpsampleRgbLinePair,Vc=Y.UpsampleBgrLinePair,Jl=Y.UpsampleRgbaLinePair,Hc=Y.UpsampleBgraLinePair,gl=Y.UpsampleArgbLinePair,eo=Y.UpsampleRgba4444LinePair,Zr=Y.UpsampleRgb565LinePair,Sa=16,ha=1<<Sa-1,Ql=-227,xl=482,sa=6,Ea=0,Gi=d(256),Go=d(256),to=d(256),qs=d(256),Lo=d(xl-Ql),Vs=d(xl-Ql);Qi("YuvToRgbRow",Ds,3),Qi("YuvToBgrRow",Vi,3),Qi("YuvToRgbaRow",fa,4),Qi("YuvToBgraRow",Vr,4),Qi("YuvToArgbRow",Ls,4),Qi("YuvToRgba4444Row",Kr,2),Qi("YuvToRgb565Row",ns,2);var Ii=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],co=[0,2,8],uo=[8,7,6,4,4,2,2,2,1,1,1,1],ls=1;this.WebPDecodeRGBA=function(f,x,k,P,q){var Z=Za,Q=new bt,J=new rt;Q.ba=J,J.S=Z,J.width=[J.width],J.height=[J.height];var te=J.width,Pe=J.height,Fe=new ln;if(Fe==null||f==null)var tt=2;else r(Fe!=null),tt=No(f,x,k,Fe.width,Fe.height,Fe.Pd,Fe.Qd,Fe.format,null);if(tt!=0?te=0:(te!=null&&(te[0]=Fe.width[0]),Pe!=null&&(Pe[0]=Fe.height[0]),te=1),te){J.width=J.width[0],J.height=J.height[0],P!=null&&(P[0]=J.width),q!=null&&(q[0]=J.height);e:{if(P=new vo,(q=new gt).data=f,q.w=x,q.ha=k,q.kd=1,x=[0],r(q!=null),((f=No(q.data,q.w,q.ha,null,null,null,x,null,q))==0||f==7)&&x[0]&&(f=4),(x=f)==0){if(r(Q!=null),P.data=q.data,P.w=q.w+q.offset,P.ha=q.ha-q.offset,P.put=Yt,P.ac=Zi,P.bc=jn,P.ma=Q,q.xa){if((f=bo())==null){Q=1;break e}if((function(Ae,Ve){var Ke=[0],ft=[0],Je=[0];t:for(;;){if(Ae==null)return 0;if(Ve==null)return Ae.a=2,0;if(Ae.l=Ve,Ae.a=0,ke(Ae.m,Ve.data,Ve.w,Ve.ha),!ci(Ae.m,Ke,ft,Je)){Ae.a=3;break t}if(Ae.xb=gu,Ve.width=Ke[0],Ve.height=ft[0],!ya(Ke[0],ft[0],1,Ae,null))break t;return 1}return r(Ae.a!=0),0})(f,P)){if(P=(x=rs(P.width,P.height,Q.Oa,Q.ba))==0){t:{P=f;n:for(;;){if(P==null){P=0;break t}if(r(P.s.yc!=null),r(P.s.Ya!=null),r(0<P.s.Wb),r((k=P.l)!=null),r((q=k.ma)!=null),P.xb!=0){if(P.ca=q.ba,P.tb=q.tb,r(P.ca!=null),!xs(q.Oa,k,bi)){P.a=2;break n}if(!Rr(P,k.width)||k.da)break n;if((k.da||Qt(P.ca.S))&&Cr(),11>P.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),P.ca.f.kb.F!=null&&Cr()),P.Pb&&0<P.s.ua&&P.s.vb.X==null&&!se(P.s.vb,P.s.Wa.Xa)){P.a=1;break n}P.xb=0}if(!Ri(P,P.V,P.Ba,P.c,P.i,k.o,Sr))break n;q.Dc=P.Ma,P=1;break t}r(P.a!=0),P=0}P=!P}P&&(x=f.a)}else x=f.a}else{if((f=new Ha)==null){Q=1;break e}if(f.Fa=q.na,f.P=q.P,f.qc=q.Sa,hs(f,P)){if((x=rs(P.width,P.height,Q.Oa,Q.ba))==0){if(f.Aa=0,k=Q.Oa,r((q=f)!=null),k!=null){if(0<(te=0>(te=k.Md)?0:100<te?255:255*te/100)){for(Pe=Fe=0;4>Pe;++Pe)12>(tt=q.pb[Pe]).lc&&(tt.ia=te*uo[0>tt.lc?0:tt.lc]>>3),Fe|=tt.ia;Fe&&(alert("todo:VP8InitRandom"),q.ia=1)}q.Ga=k.Id,100<q.Ga?q.Ga=100:0>q.Ga&&(q.Ga=0)}(function(Ae,Ve){if(Ae==null)return 0;if(Ve==null)return Ti(Ae,2,"NULL VP8Io parameter in VP8Decode().");if(!Ae.cb&&!hs(Ae,Ve))return 0;if(r(Ae.cb),Ve.ac==null||Ve.ac(Ve)){Ve.ob&&(Ae.L=0);var Ke=co[Ae.L];if(Ae.L==2?(Ae.yb=0,Ae.zb=0):(Ae.yb=Ve.v-Ke>>4,Ae.zb=Ve.j-Ke>>4,0>Ae.yb&&(Ae.yb=0),0>Ae.zb&&(Ae.zb=0)),Ae.Va=Ve.o+15+Ke>>4,Ae.Hb=Ve.va+15+Ke>>4,Ae.Hb>Ae.za&&(Ae.Hb=Ae.za),Ae.Va>Ae.Ub&&(Ae.Va=Ae.Ub),0<Ae.L){var ft=Ae.ed;for(Ke=0;4>Ke;++Ke){var Je;if(Ae.Qa.Cb){var mt=Ae.Qa.Lb[Ke];Ae.Qa.Fb||(mt+=ft.Tb)}else mt=ft.Tb;for(Je=0;1>=Je;++Je){var wt=Ae.gd[Ke][Je],Dt=mt;if(ft.Pc&&(Dt+=ft.vd[0],Je&&(Dt+=ft.od[0])),0<(Dt=0>Dt?0:63<Dt?63:Dt)){var vt=Dt;0<ft.wb&&(vt=4<ft.wb?vt>>2:vt>>1)>9-ft.wb&&(vt=9-ft.wb),1>vt&&(vt=1),wt.dd=vt,wt.tc=2*Dt+vt,wt.ld=40<=Dt?2:15<=Dt?1:0}else wt.tc=0;wt.La=Je}}}Ke=0}else Ti(Ae,6,"Frame setup failed"),Ke=Ae.a;if(Ke=Ke==0){if(Ke){Ae.$c=0,0<Ae.Aa||(Ae.Ic=ls);t:{Ke=Ae.Ic,ft=4*(vt=Ae.za);var sn=32*vt,nn=vt+1,ti=0<Ae.L?vt*(0<Ae.Aa?2:1):0,Xt=(Ae.Aa==2?2:1)*vt;if((wt=ft+832+(Je=3*(16*Ke+co[Ae.L])/2*sn)+(mt=Ae.Fa!=null&&0<Ae.Fa.length?Ae.Kc.c*Ae.Kc.i:0))!=wt)Ke=0;else{if(wt>Ae.Vb){if(Ae.Vb=0,Ae.Ec=d(wt),Ae.Fc=0,Ae.Ec==null){Ke=Ti(Ae,1,"no memory during frame initialization.");break t}Ae.Vb=wt}wt=Ae.Ec,Dt=Ae.Fc,Ae.Ac=wt,Ae.Bc=Dt,Dt+=ft,Ae.Gd=v(sn,zs),Ae.Hd=0,Ae.rb=v(nn+1,ma),Ae.sb=1,Ae.wa=ti?v(ti,Jn):null,Ae.Y=0,Ae.D.Nb=0,Ae.D.wa=Ae.wa,Ae.D.Y=Ae.Y,0<Ae.Aa&&(Ae.D.Y+=vt),r(!0),Ae.oc=wt,Ae.pc=Dt,Dt+=832,Ae.ya=v(Xt,As),Ae.aa=0,Ae.D.ya=Ae.ya,Ae.D.aa=Ae.aa,Ae.Aa==2&&(Ae.D.aa+=vt),Ae.R=16*vt,Ae.B=8*vt,vt=(sn=co[Ae.L])*Ae.R,sn=sn/2*Ae.B,Ae.sa=wt,Ae.ta=Dt+vt,Ae.qa=Ae.sa,Ae.ra=Ae.ta+16*Ke*Ae.R+sn,Ae.Ha=Ae.qa,Ae.Ia=Ae.ra+8*Ke*Ae.B+sn,Ae.$c=0,Dt+=Je,Ae.mb=mt?wt:null,Ae.nb=mt?Dt:null,r(Dt+mt<=Ae.Fc+Ae.Vb),oo(Ae),c(Ae.Ac,Ae.Bc,0,ft),Ke=1}}if(Ke){if(Ve.ka=0,Ve.y=Ae.sa,Ve.O=Ae.ta,Ve.f=Ae.qa,Ve.N=Ae.ra,Ve.ea=Ae.Ha,Ve.Vd=Ae.Ia,Ve.fa=Ae.R,Ve.Rc=Ae.B,Ve.F=null,Ve.J=0,!Pi){for(Ke=-255;255>=Ke;++Ke)$o[255+Ke]=0>Ke?-Ke:Ke;for(Ke=-1020;1020>=Ke;++Ke)Ro[1020+Ke]=-128>Ke?-128:127<Ke?127:Ke;for(Ke=-112;112>=Ke;++Ke)_l[112+Ke]=-16>Ke?-16:15<Ke?15:Ke;for(Ke=-255;510>=Ke;++Ke)aa[255+Ke]=0>Ke?0:255<Ke?255:Ke;Pi=1}as=wo,Ga=sl,_o=dr,ki=Aa,ri=Ps,_a=Xs,lr=ul,Mr=_s,Js=W,ms=ze,Gl=Fc,vc=j,Hu=Oe,yd=Ie,md=Si,bd=Wa,Xa=cl,Ho=Pa,gr[0]=Lr,gr[1]=So,gr[2]=Ec,gr[3]=$l,gr[4]=zi,gr[5]=Oc,gr[6]=na,gr[7]=ii,gr[8]=Zs,gr[9]=mn,Ba[0]=ba,Ba[1]=br,Ba[2]=za,Ba[3]=Fo,Ba[4]=jo,Ba[5]=To,Ba[6]=ll,wa[0]=mi,wa[1]=Ft,wa[2]=ts,wa[3]=$n,wa[4]=Yn,wa[5]=_n,wa[6]=Tn,Ke=1}else Ke=0}Ke&&(Ke=(function(Cn,Nr){for(Cn.M=0;Cn.M<Cn.Va;++Cn.M){var ni,gn=Cn.Jc[Cn.M&Cn.Xb],$t=Cn.m,Ar=Cn;for(ni=0;ni<Ar.za;++ni){var yn=$t,Un=Ar,Bi=Un.Ac,Ir=Un.Bc+4*ni,la=Un.zc,Hi=Un.ya[Un.aa+ni];if(Un.Qa.Bb?Hi.$b=Ue(yn,Un.Pa.jb[0])?2+Ue(yn,Un.Pa.jb[2]):Ue(yn,Un.Pa.jb[1]):Hi.$b=0,Un.kc&&(Hi.Ad=Ue(yn,Un.Bd)),Hi.Za=!Ue(yn,145)+0,Hi.Za){var zr=Hi.Ob,fo=0;for(Un=0;4>Un;++Un){var Jr,Qn=la[0+Un];for(Jr=0;4>Jr;++Jr){Qn=Ia[Bi[Ir+Jr]][Qn];for(var ai=Ma[Ue(yn,Qn[0])];0<ai;)ai=Ma[2*ai+Ue(yn,Qn[ai])];Qn=-ai,Bi[Ir+Jr]=Qn}s(zr,fo,Bi,Ir,4),fo+=4,la[0+Un]=Qn}}else Qn=Ue(yn,156)?Ue(yn,128)?1:3:Ue(yn,163)?2:0,Hi.Ob[0]=Qn,c(Bi,Ir,Qn,4),c(la,0,Qn,4);Hi.Dd=Ue(yn,142)?Ue(yn,114)?Ue(yn,183)?1:3:2:0}if(Ar.m.Ka)return Ti(Cn,7,"Premature end-of-partition0 encountered.");for(;Cn.ja<Cn.za;++Cn.ja){if(Ar=gn,yn=($t=Cn).rb[$t.sb-1],Bi=$t.rb[$t.sb+$t.ja],ni=$t.ya[$t.aa+$t.ja],Ir=$t.kc?ni.Ad:0)yn.la=Bi.la=0,ni.Za||(yn.Na=Bi.Na=0),ni.Hc=0,ni.Gc=0,ni.ia=0;else{var _i,pi;if(yn=Bi,Bi=Ar,Ir=$t.Pa.Xc,la=$t.ya[$t.aa+$t.ja],Hi=$t.pb[la.$b],Un=la.ad,zr=0,fo=$t.rb[$t.sb-1],Qn=Jr=0,c(Un,zr,0,384),la.Za)var xr=0,yr=Ir[3];else{ai=d(16);var Oi=yn.Na+fo.Na;if(Oi=Yo(Bi,Ir[1],Oi,Hi.Eb,0,ai,0),yn.Na=fo.Na=(0<Oi)+0,1<Oi)as(ai,0,Un,zr);else{var Xi=ai[0]+3>>3;for(ai=0;256>ai;ai+=16)Un[zr+ai]=Xi}xr=1,yr=Ir[0]}var Wi=15&yn.la,Qr=15&fo.la;for(ai=0;4>ai;++ai){var ca=1&Qr;for(Xi=pi=0;4>Xi;++Xi)Wi=Wi>>1|(ca=(Oi=Yo(Bi,yr,Oi=ca+(1&Wi),Hi.Sc,xr,Un,zr))>xr)<<7,pi=pi<<2|(3<Oi?3:1<Oi?2:Un[zr+0]!=0),zr+=16;Wi>>=4,Qr=Qr>>1|ca<<7,Jr=(Jr<<8|pi)>>>0}for(yr=Wi,xr=Qr>>4,_i=0;4>_i;_i+=2){for(pi=0,Wi=yn.la>>4+_i,Qr=fo.la>>4+_i,ai=0;2>ai;++ai){for(ca=1&Qr,Xi=0;2>Xi;++Xi)Oi=ca+(1&Wi),Wi=Wi>>1|(ca=0<(Oi=Yo(Bi,Ir[2],Oi,Hi.Qc,0,Un,zr)))<<3,pi=pi<<2|(3<Oi?3:1<Oi?2:Un[zr+0]!=0),zr+=16;Wi>>=2,Qr=Qr>>1|ca<<5}Qn|=pi<<4*_i,yr|=Wi<<4<<_i,xr|=(240&Qr)<<_i}yn.la=yr,fo.la=xr,la.Hc=Jr,la.Gc=Qn,la.ia=43690&Qn?0:Hi.ia,Ir=!(Jr|Qn)}if(0<$t.L&&($t.wa[$t.Y+$t.ja]=$t.gd[ni.$b][ni.Za],$t.wa[$t.Y+$t.ja].La|=!Ir),Ar.Ka)return Ti(Cn,7,"Premature end-of-file encountered.")}if(oo(Cn),$t=Nr,Ar=1,ni=(gn=Cn).D,yn=0<gn.L&&gn.M>=gn.zb&&gn.M<=gn.Va,gn.Aa==0)t:{if(ni.M=gn.M,ni.uc=yn,is(gn,ni),Ar=1,ni=(pi=gn.D).Nb,yn=(Qn=co[gn.L])*gn.R,Bi=Qn/2*gn.B,ai=16*ni*gn.R,Xi=8*ni*gn.B,Ir=gn.sa,la=gn.ta-yn+ai,Hi=gn.qa,Un=gn.ra-Bi+Xi,zr=gn.Ha,fo=gn.Ia-Bi+Xi,Qr=(Wi=pi.M)==0,Jr=Wi>=gn.Va-1,gn.Aa==2&&is(gn,pi),pi.uc)for(ca=(Oi=gn).D.M,r(Oi.D.uc),pi=Oi.yb;pi<Oi.Hb;++pi){xr=pi,yr=ca;var ar=(Fi=(Br=Oi).D).Nb;_i=Br.R;var Fi=Fi.wa[Fi.Y+xr],Oa=Br.sa,sr=Br.ta+16*ar*_i+16*xr,Pn=Fi.dd,Mn=Fi.tc;if(Mn!=0)if(r(3<=Mn),Br.L==1)0<xr&&bd(Oa,sr,_i,Mn+4),Fi.La&&Ho(Oa,sr,_i,Mn),0<yr&&md(Oa,sr,_i,Mn+4),Fi.La&&Xa(Oa,sr,_i,Mn);else{var Ui=Br.B,Io=Br.qa,Bo=Br.ra+8*ar*Ui+8*xr,po=Br.Ha,Br=Br.Ia+8*ar*Ui+8*xr;ar=Fi.ld,0<xr&&(Mr(Oa,sr,_i,Mn+4,Pn,ar),ms(Io,Bo,po,Br,Ui,Mn+4,Pn,ar)),Fi.La&&(vc(Oa,sr,_i,Mn,Pn,ar),yd(Io,Bo,po,Br,Ui,Mn,Pn,ar)),0<yr&&(lr(Oa,sr,_i,Mn+4,Pn,ar),Js(Io,Bo,po,Br,Ui,Mn+4,Pn,ar)),Fi.La&&(Gl(Oa,sr,_i,Mn,Pn,ar),Hu(Io,Bo,po,Br,Ui,Mn,Pn,ar))}}if(gn.ia&&alert("todo:DitherRow"),$t.put!=null){if(pi=16*Wi,Wi=16*(Wi+1),Qr?($t.y=gn.sa,$t.O=gn.ta+ai,$t.f=gn.qa,$t.N=gn.ra+Xi,$t.ea=gn.Ha,$t.W=gn.Ia+Xi):(pi-=Qn,$t.y=Ir,$t.O=la,$t.f=Hi,$t.N=Un,$t.ea=zr,$t.W=fo),Jr||(Wi-=Qn),Wi>$t.o&&(Wi=$t.o),$t.F=null,$t.J=null,gn.Fa!=null&&0<gn.Fa.length&&pi<Wi&&($t.J=vr(gn,$t,pi,Wi-pi),$t.F=gn.mb,$t.F==null&&$t.F.length==0)){Ar=Ti(gn,3,"Could not decode alpha data.");break t}pi<$t.j&&(Qn=$t.j-pi,pi=$t.j,r(!(1&Qn)),$t.O+=gn.R*Qn,$t.N+=gn.B*(Qn>>1),$t.W+=gn.B*(Qn>>1),$t.F!=null&&($t.J+=$t.width*Qn)),pi<Wi&&($t.O+=$t.v,$t.N+=$t.v>>1,$t.W+=$t.v>>1,$t.F!=null&&($t.J+=$t.v),$t.ka=pi-$t.j,$t.U=$t.va-$t.v,$t.T=Wi-pi,Ar=$t.put($t))}ni+1!=gn.Ic||Jr||(s(gn.sa,gn.ta-yn,Ir,la+16*gn.R,yn),s(gn.qa,gn.ra-Bi,Hi,Un+8*gn.B,Bi),s(gn.Ha,gn.Ia-Bi,zr,fo+8*gn.B,Bi))}if(!Ar)return Ti(Cn,6,"Output aborted.")}return 1})(Ae,Ve)),Ve.bc!=null&&Ve.bc(Ve),Ke&=1}return Ke?(Ae.cb=0,Ke):0})(f,P)||(x=f.a)}}else x=f.a}x==0&&Q.Oa!=null&&Q.Oa.fd&&(x=Al(Q.ba))}Q=x}Z=Q!=0?null:11>Z?J.f.RGBA.eb:J.f.kb.y}else Z=null;return Z};var Mo=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function m(Y,X){for(var F="",R=0;R<4;R++)F+=String.fromCharCode(Y[X++]);return F}function S(Y,X){return Y[X+0]|Y[X+1]<<8}function _(Y,X){return(Y[X+0]|Y[X+1]<<8|Y[X+2]<<16)>>>0}function E(Y,X){return(Y[X+0]|Y[X+1]<<8|Y[X+2]<<16|Y[X+3]<<24)>>>0}new g;var T=[0],K=[0],D=[],ee=new g,w=i,Se=(function(Y,X){var F={},R=0,U=!1,O=0,_e=0;if(F.frames=[],!(function(z,G){for(var V=0;V<4;V++)if(z[G+V]!="RIFF".charCodeAt(V))return!0;return!1})(Y,X)){for(E(Y,X+=4),X+=8;X<Y.length;){var ce=m(Y,X),xe=E(Y,X+=4);X+=4;var fe=xe+(1&xe);switch(ce){case"VP8 ":case"VP8L":F.frames[R]===void 0&&(F.frames[R]={}),(C=F.frames[R]).src_off=U?_e:X-8,C.src_size=O+xe+8,R++,U&&(U=!1,O=0,_e=0);break;case"VP8X":(C=F.header={}).feature_flags=Y[X];var ke=X+4;C.canvas_width=1+_(Y,ke),ke+=3,C.canvas_height=1+_(Y,ke),ke+=3;break;case"ALPH":U=!0,O=fe+8,_e=X-8;break;case"ANIM":(C=F.header).bgcolor=E(Y,X),ke=X+4,C.loop_count=S(Y,ke),ke+=2;break;case"ANMF":var de,C;(C=F.frames[R]={}).offset_x=2*_(Y,X),X+=3,C.offset_y=2*_(Y,X),X+=3,C.width=1+_(Y,X),X+=3,C.height=1+_(Y,X),X+=3,C.duration=_(Y,X),X+=3,de=Y[X++],C.dispose=1&de,C.blend=de>>1&1}ce!="ANMF"&&(X+=fe)}return F}})(w,0);Se.response=w,Se.rgbaoutput=!0,Se.dataurl=!1;var $=Se.header?Se.header:null,H=Se.frames?Se.frames:null;if($){$.loop_counter=$.loop_count,T=[$.canvas_height],K=[$.canvas_width];for(var ae=0;ae<H.length&&H[ae].blend!=0;ae++);}var I=H[0],oe=ee.WebPDecodeRGBA(w,I.src_off,I.src_size,K,T);I.rgba=oe,I.imgwidth=K[0],I.imgheight=T[0];for(var pe=0;pe<K[0]*T[0]*4;pe++)D[pe]=oe[pe];return this.width=K,this.height=T,this.data=D,this}(function(i){var r,o,s,c,d,v,p,g,m,S=function(z){return z=z||{},this.isStrokeTransparent=z.isStrokeTransparent||!1,this.strokeOpacity=z.strokeOpacity||1,this.strokeStyle=z.strokeStyle||"#000000",this.fillStyle=z.fillStyle||"#000000",this.isFillTransparent=z.isFillTransparent||!1,this.fillOpacity=z.fillOpacity||1,this.font=z.font||"10px sans-serif",this.textBaseline=z.textBaseline||"alphabetic",this.textAlign=z.textAlign||"left",this.lineWidth=z.lineWidth||1,this.lineJoin=z.lineJoin||"miter",this.lineCap=z.lineCap||"butt",this.path=z.path||[],this.transform=z.transform!==void 0?z.transform.clone():new g,this.globalCompositeOperation=z.globalCompositeOperation||"normal",this.globalAlpha=z.globalAlpha||1,this.clip_path=z.clip_path||[],this.currentPoint=z.currentPoint||new v,this.miterLimit=z.miterLimit||10,this.lastPoint=z.lastPoint||new v,this.lineDashOffset=z.lineDashOffset||0,this.lineDash=z.lineDash||[],this.margin=z.margin||[0,0,0,0],this.prevPageLastElemOffset=z.prevPageLastElemOffset||0,this.ignoreClearRect=typeof z.ignoreClearRect!="boolean"||z.ignoreClearRect,this};i.events.push(["initialized",function(){this.context2d=new _(this),r=this.internal.f2,o=this.internal.getCoordinateString,s=this.internal.getVerticalCoordinateString,c=this.internal.getHorizontalCoordinate,d=this.internal.getVerticalCoordinate,v=this.internal.Point,p=this.internal.Rectangle,g=this.internal.Matrix,m=new S}]);var _=function(z){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var G=z;Object.defineProperty(this,"pdf",{get:function(){return G}});var V=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return V},set:function(se){V=!!se}});var ie=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return ie},set:function(se){ie=!!se}});var he=0;Object.defineProperty(this,"posX",{get:function(){return he},set:function(se){isNaN(se)||(he=se)}});var re=0;Object.defineProperty(this,"posY",{get:function(){return re},set:function(se){isNaN(se)||(re=se)}}),Object.defineProperty(this,"margin",{get:function(){return m.margin},set:function(se){var kt;typeof se=="number"?kt=[se,se,se,se]:((kt=new Array(4))[0]=se[0],kt[1]=se.length>=2?se[1]:kt[0],kt[2]=se.length>=3?se[2]:kt[0],kt[3]=se.length>=4?se[3]:kt[1]),m.margin=kt}});var Le=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Le},set:function(se){Le=se}});var Re=0;Object.defineProperty(this,"lastBreak",{get:function(){return Re},set:function(se){Re=se}});var Ue=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Ue},set:function(se){Ue=se}}),Object.defineProperty(this,"ctx",{get:function(){return m},set:function(se){se instanceof S&&(m=se)}}),Object.defineProperty(this,"path",{get:function(){return m.path},set:function(se){m.path=se}});var et=[];Object.defineProperty(this,"ctxStack",{get:function(){return et},set:function(se){et=se}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(se){var kt;kt=E(se),this.ctx.fillStyle=kt.style,this.ctx.isFillTransparent=kt.a===0,this.ctx.fillOpacity=kt.a,this.pdf.setFillColor(kt.r,kt.g,kt.b,{a:kt.a}),this.pdf.setTextColor(kt.r,kt.g,kt.b,{a:kt.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(se){var kt=E(se);this.ctx.strokeStyle=kt.style,this.ctx.isStrokeTransparent=kt.a===0,this.ctx.strokeOpacity=kt.a,kt.a===0?this.pdf.setDrawColor(255,255,255):(kt.a,this.pdf.setDrawColor(kt.r,kt.g,kt.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(se){["butt","round","square"].indexOf(se)!==-1&&(this.ctx.lineCap=se,this.pdf.setLineCap(se))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(se){isNaN(se)||(this.ctx.lineWidth=se,this.pdf.setLineWidth(se))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(se){["bevel","round","miter"].indexOf(se)!==-1&&(this.ctx.lineJoin=se,this.pdf.setLineJoin(se))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(se){isNaN(se)||(this.ctx.miterLimit=se,this.pdf.setMiterLimit(se))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(se){this.ctx.textBaseline=se}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(se){["right","end","center","left","start"].indexOf(se)!==-1&&(this.ctx.textAlign=se)}});var ot=null,Ct=null,Ot=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ot},set:function(se){ot=null,Ct=null,Ot=se}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(se){var kt;if(this.ctx.font=se,(kt=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(se))!==null){var Jt=kt[1];kt[2];var Wt=kt[3],ht=kt[4];kt[5];var Xe=kt[6],Ut=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ht)[2];ht=Math.floor(Ut==="px"?parseFloat(ht)*this.pdf.internal.scaleFactor:Ut==="em"?parseFloat(ht)*this.pdf.getFontSize():parseFloat(ht)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ht);var an=(function(Ze){var jt,en,Qe=[],At=Ze.trim();if(At==="")return kg;if(At in mx)return[mx[At]];for(;At!=="";){switch(en=null,jt=(At=vx(At)).charAt(0)){case'"':case"'":en=K5(At.substring(1),jt);break;default:en=Z5(At)}if(en===null||(Qe.push(en[0]),(At=vx(en[1]))!==""&&At.charAt(0)!==","))return kg;At=At.replace(/^,/,"")}return Qe})(Xe);if(this.fontFaces){var Ht=(function(Ze,jt){var en=Ze.getFontList(),Qe=JSON.stringify(en);if(ot===null||Ct!==Qe){var At=(function(un){var xn=[];return Object.keys(un).forEach(function(Kt){un[Kt].forEach(function(Qt){var hn=null;switch(Qt){case"bold":hn={family:Kt,weight:"bold"};break;case"italic":hn={family:Kt,style:"italic"};break;case"bolditalic":hn={family:Kt,weight:"bold",style:"italic"};break;case"":case"normal":hn={family:Kt}}hn!==null&&(hn.ref={name:Kt,style:Qt},xn.push(hn))})}),xn})(en);ot=(function(un){for(var xn={},Kt=0;Kt<un.length;++Kt){var Qt=Cg(un[Kt]),hn=Qt.family,Xn=Qt.stretch,rt=Qt.style,ln=Qt.weight;xn[hn]=xn[hn]||{},xn[hn][Xn]=xn[hn][Xn]||{},xn[hn][Xn][rt]=xn[hn][Xn][rt]||{},xn[hn][Xn][rt][ln]=Qt}return xn})(At.concat(jt)),Ct=Qe}return ot})(this.pdf,this.fontFaces),Nn=an.map(function(Ze){return{family:Ze,stretch:"normal",weight:Wt,style:Jt}}),zn=(function(Ze,jt,en){for(var Qe=(en=en||{}).defaultFontFamily||"times",At=Object.assign({},X5,en.genericFontFamilies||{}),un=null,xn=null,Kt=0;Kt<jt.length;++Kt)if(At[(un=Cg(jt[Kt])).family]&&(un.family=At[un.family]),Ze.hasOwnProperty(un.family)){xn=Ze[un.family];break}if(!(xn=xn||Ze[Qe]))throw new Error("Could not find a font-family for the rule '"+bx(un)+"' and default family '"+Qe+"'.");if(xn=(function(Qt,hn){if(hn[Qt])return hn[Qt];var Xn=Hg[Qt],rt=Xn<=Hg.normal?-1:1,ln=yx(hn,Ly,Xn,rt);if(!ln)throw new Error("Could not find a matching font-stretch value for "+Qt);return ln})(un.stretch,xn),xn=(function(Qt,hn){if(hn[Qt])return hn[Qt];for(var Xn=Dy[Qt],rt=0;rt<Xn.length;++rt)if(hn[Xn[rt]])return hn[Xn[rt]];throw new Error("Could not find a matching font-style for "+Qt)})(un.style,xn),!(xn=(function(Qt,hn){if(hn[Qt])return hn[Qt];if(Qt===400&&hn[500])return hn[500];if(Qt===500&&hn[400])return hn[400];var Xn=G5[Qt],rt=yx(hn,My,Xn,Qt<400?-1:1);if(!rt)throw new Error("Could not find a matching font-weight for value "+Qt);return rt})(un.weight,xn)))throw new Error("Failed to resolve a font for the rule '"+bx(un)+"'.");return xn})(Ht,Nn);this.pdf.setFont(zn.ref.name,zn.ref.style)}else{var Ee="";(Wt==="bold"||parseInt(Wt,10)>=700||Jt==="bold")&&(Ee="bold"),Jt==="italic"&&(Ee+="italic"),Ee.length===0&&(Ee="normal");for(var Ne="",Mt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},ct=0;ct<an.length;ct++){if(this.pdf.internal.getFont(an[ct],Ee,{noFallback:!0,disableWarning:!0})!==void 0){Ne=an[ct];break}if(Ee==="bolditalic"&&this.pdf.internal.getFont(an[ct],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Ne=an[ct],Ee="bold";else if(this.pdf.internal.getFont(an[ct],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Ne=an[ct],Ee="normal";break}}if(Ne===""){for(var _t=0;_t<an.length;_t++)if(Mt[an[_t]]){Ne=Mt[an[_t]];break}}Ne=Ne===""?"Times":Ne,this.pdf.setFont(Ne,Ee)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(se){this.ctx.globalCompositeOperation=se}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(se){this.ctx.globalAlpha=se}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(se){this.ctx.lineDashOffset=se,C.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(se){this.ctx.lineDash=se,C.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(se){this.ctx.ignoreClearRect=!!se}})};_.prototype.setLineDash=function(z){this.lineDash=z},_.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},_.prototype.fill=function(){H.call(this,"fill",!1)},_.prototype.stroke=function(){H.call(this,"stroke",!1)},_.prototype.beginPath=function(){this.path=[{type:"begin"}]},_.prototype.moveTo=function(z,G){if(isNaN(z)||isNaN(G))throw Yr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var V=this.ctx.transform.applyToPoint(new v(z,G));this.path.push({type:"mt",x:V.x,y:V.y}),this.ctx.lastPoint=new v(z,G)},_.prototype.closePath=function(){var z=new v(0,0),G=0;for(G=this.path.length-1;G!==-1;G--)if(this.path[G].type==="begin"&&_r(this.path[G+1])==="object"&&typeof this.path[G+1].x=="number"){z=new v(this.path[G+1].x,this.path[G+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new v(z.x,z.y)},_.prototype.lineTo=function(z,G){if(isNaN(z)||isNaN(G))throw Yr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var V=this.ctx.transform.applyToPoint(new v(z,G));this.path.push({type:"lt",x:V.x,y:V.y}),this.ctx.lastPoint=new v(V.x,V.y)},_.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),H.call(this,null,!0)},_.prototype.quadraticCurveTo=function(z,G,V,ie){if(isNaN(V)||isNaN(ie)||isNaN(z)||isNaN(G))throw Yr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var he=this.ctx.transform.applyToPoint(new v(V,ie)),re=this.ctx.transform.applyToPoint(new v(z,G));this.path.push({type:"qct",x1:re.x,y1:re.y,x:he.x,y:he.y}),this.ctx.lastPoint=new v(he.x,he.y)},_.prototype.bezierCurveTo=function(z,G,V,ie,he,re){if(isNaN(he)||isNaN(re)||isNaN(z)||isNaN(G)||isNaN(V)||isNaN(ie))throw Yr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Le=this.ctx.transform.applyToPoint(new v(he,re)),Re=this.ctx.transform.applyToPoint(new v(z,G)),Ue=this.ctx.transform.applyToPoint(new v(V,ie));this.path.push({type:"bct",x1:Re.x,y1:Re.y,x2:Ue.x,y2:Ue.y,x:Le.x,y:Le.y}),this.ctx.lastPoint=new v(Le.x,Le.y)},_.prototype.arc=function(z,G,V,ie,he,re){if(isNaN(z)||isNaN(G)||isNaN(V)||isNaN(ie)||isNaN(he))throw Yr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(re=!!re,!this.ctx.transform.isIdentity){var Le=this.ctx.transform.applyToPoint(new v(z,G));z=Le.x,G=Le.y;var Re=this.ctx.transform.applyToPoint(new v(0,V)),Ue=this.ctx.transform.applyToPoint(new v(0,0));V=Math.sqrt(Math.pow(Re.x-Ue.x,2)+Math.pow(Re.y-Ue.y,2))}Math.abs(he-ie)>=2*Math.PI&&(ie=0,he=2*Math.PI),this.path.push({type:"arc",x:z,y:G,radius:V,startAngle:ie,endAngle:he,counterclockwise:re})},_.prototype.arcTo=function(z,G,V,ie,he){throw new Error("arcTo not implemented.")},_.prototype.rect=function(z,G,V,ie){if(isNaN(z)||isNaN(G)||isNaN(V)||isNaN(ie))throw Yr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(z,G),this.lineTo(z+V,G),this.lineTo(z+V,G+ie),this.lineTo(z,G+ie),this.lineTo(z,G),this.lineTo(z+V,G),this.lineTo(z,G)},_.prototype.fillRect=function(z,G,V,ie){if(isNaN(z)||isNaN(G)||isNaN(V)||isNaN(ie))throw Yr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!T.call(this)){var he={};this.lineCap!=="butt"&&(he.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(he.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(z,G,V,ie),this.fill(),he.hasOwnProperty("lineCap")&&(this.lineCap=he.lineCap),he.hasOwnProperty("lineJoin")&&(this.lineJoin=he.lineJoin)}},_.prototype.strokeRect=function(z,G,V,ie){if(isNaN(z)||isNaN(G)||isNaN(V)||isNaN(ie))throw Yr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");K.call(this)||(this.beginPath(),this.rect(z,G,V,ie),this.stroke())},_.prototype.clearRect=function(z,G,V,ie){if(isNaN(z)||isNaN(G)||isNaN(V)||isNaN(ie))throw Yr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(z,G,V,ie))},_.prototype.save=function(z){z=typeof z!="boolean"||z;for(var G=this.pdf.internal.getCurrentPageInfo().pageNumber,V=0;V<this.pdf.internal.getNumberOfPages();V++)this.pdf.setPage(V+1),this.pdf.internal.out("q");if(this.pdf.setPage(G),z){this.ctx.fontSize=this.pdf.internal.getFontSize();var ie=new S(this.ctx);this.ctxStack.push(this.ctx),this.ctx=ie}},_.prototype.restore=function(z){z=typeof z!="boolean"||z;for(var G=this.pdf.internal.getCurrentPageInfo().pageNumber,V=0;V<this.pdf.internal.getNumberOfPages();V++)this.pdf.setPage(V+1),this.pdf.internal.out("Q");this.pdf.setPage(G),z&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},_.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var E=function(z){var G,V,ie,he;if(z.isCanvasGradient===!0&&(z=z.getColor()),!z)return{r:0,g:0,b:0,a:0,style:z};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(z))G=0,V=0,ie=0,he=0;else{var re=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(z);if(re!==null)G=parseInt(re[1]),V=parseInt(re[2]),ie=parseInt(re[3]),he=1;else if((re=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(z))!==null)G=parseInt(re[1]),V=parseInt(re[2]),ie=parseInt(re[3]),he=parseFloat(re[4]);else{if(he=1,typeof z=="string"&&z.charAt(0)!=="#"){var Le=new ky(z);z=Le.ok?Le.toHex():"#000000"}z.length===4?(G=z.substring(1,2),G+=G,V=z.substring(2,3),V+=V,ie=z.substring(3,4),ie+=ie):(G=z.substring(1,3),V=z.substring(3,5),ie=z.substring(5,7)),G=parseInt(G,16),V=parseInt(V,16),ie=parseInt(ie,16)}}return{r:G,g:V,b:ie,a:he,style:z}},T=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},K=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};_.prototype.fillText=function(z,G,V,ie){if(isNaN(G)||isNaN(V)||typeof z!="string")throw Yr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(ie=isNaN(ie)?void 0:ie,!T.call(this)){var he=fe(this.ctx.transform.rotation),re=this.ctx.transform.scaleX;R.call(this,{text:z,x:G,y:V,scale:re,angle:he,align:this.textAlign,maxWidth:ie})}},_.prototype.strokeText=function(z,G,V,ie){if(isNaN(G)||isNaN(V)||typeof z!="string")throw Yr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!K.call(this)){ie=isNaN(ie)?void 0:ie;var he=fe(this.ctx.transform.rotation),re=this.ctx.transform.scaleX;R.call(this,{text:z,x:G,y:V,scale:re,renderingMode:"stroke",angle:he,align:this.textAlign,maxWidth:ie})}},_.prototype.measureText=function(z){if(typeof z!="string")throw Yr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var G=this.pdf,V=this.pdf.internal.scaleFactor,ie=G.internal.getFontSize(),he=G.getStringUnitWidth(z)*ie/G.internal.scaleFactor;return new function(re){var Le=(re=re||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Le}}),this}({width:he*=Math.round(96*V/72*1e4)/1e4})},_.prototype.scale=function(z,G){if(isNaN(z)||isNaN(G))throw Yr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var V=new g(z,0,0,G,0,0);this.ctx.transform=this.ctx.transform.multiply(V)},_.prototype.rotate=function(z){if(isNaN(z))throw Yr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var G=new g(Math.cos(z),Math.sin(z),-Math.sin(z),Math.cos(z),0,0);this.ctx.transform=this.ctx.transform.multiply(G)},_.prototype.translate=function(z,G){if(isNaN(z)||isNaN(G))throw Yr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var V=new g(1,0,0,1,z,G);this.ctx.transform=this.ctx.transform.multiply(V)},_.prototype.transform=function(z,G,V,ie,he,re){if(isNaN(z)||isNaN(G)||isNaN(V)||isNaN(ie)||isNaN(he)||isNaN(re))throw Yr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Le=new g(z,G,V,ie,he,re);this.ctx.transform=this.ctx.transform.multiply(Le)},_.prototype.setTransform=function(z,G,V,ie,he,re){z=isNaN(z)?1:z,G=isNaN(G)?0:G,V=isNaN(V)?0:V,ie=isNaN(ie)?1:ie,he=isNaN(he)?0:he,re=isNaN(re)?0:re,this.ctx.transform=new g(z,G,V,ie,he,re)};var D=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};_.prototype.drawImage=function(z,G,V,ie,he,re,Le,Re,Ue){var et=this.pdf.getImageProperties(z),ot=1,Ct=1,Ot=1,se=1;ie!==void 0&&Re!==void 0&&(Ot=Re/ie,se=Ue/he,ot=et.width/ie*Re/ie,Ct=et.height/he*Ue/he),re===void 0&&(re=G,Le=V,G=0,V=0),ie!==void 0&&Re===void 0&&(Re=ie,Ue=he),ie===void 0&&Re===void 0&&(Re=et.width,Ue=et.height);var kt=this.ctx.transform.decompose(),Jt=fe(kt.rotate.shx),Wt=new g,ht=(Wt=(Wt=(Wt=Wt.multiply(kt.translate)).multiply(kt.skew)).multiply(kt.scale)).applyToRectangle(new p(re-G*Ot,Le-V*se,ie*ot,he*Ct));if(this.autoPaging){for(var Xe,Ut=ee.call(this,ht),an=[],Ht=0;Ht<Ut.length;Ht+=1)an.indexOf(Ut[Ht])===-1&&an.push(Ut[Ht]);$(an);for(var Nn=an[0],zn=an[an.length-1],Ee=Nn;Ee<zn+1;Ee++){this.pdf.setPage(Ee);var Ne=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Mt=Ee===1?this.posY+this.margin[0]:this.margin[0],ct=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],_t=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ze=Ee===1?0:ct+(Ee-2)*_t;if(this.ctx.clip_path.length!==0){var jt=this.path;Xe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=Se(Xe,this.posX+this.margin[3],-Ze+Mt+this.ctx.prevPageLastElemOffset),ae.call(this,"fill",!0),this.path=jt}var en=JSON.parse(JSON.stringify(ht));en=Se([en],this.posX+this.margin[3],-Ze+Mt+this.ctx.prevPageLastElemOffset)[0];var Qe=(Ee>Nn||Ee<zn)&&D.call(this);Qe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ne,_t,null).clip().discardPath()),this.pdf.addImage(z,"JPEG",en.x,en.y,en.w,en.h,null,null,Jt),Qe&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(z,"JPEG",ht.x,ht.y,ht.w,ht.h,null,null,Jt)};var ee=function(z,G,V){var ie=[];G=G||this.pdf.internal.pageSize.width,V=V||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var he=this.posY+this.ctx.prevPageLastElemOffset;switch(z.type){default:case"mt":case"lt":ie.push(Math.floor((z.y+he)/V)+1);break;case"arc":ie.push(Math.floor((z.y+he-z.radius)/V)+1),ie.push(Math.floor((z.y+he+z.radius)/V)+1);break;case"qct":var re=ke(this.ctx.lastPoint.x,this.ctx.lastPoint.y,z.x1,z.y1,z.x,z.y);ie.push(Math.floor((re.y+he)/V)+1),ie.push(Math.floor((re.y+re.h+he)/V)+1);break;case"bct":var Le=de(this.ctx.lastPoint.x,this.ctx.lastPoint.y,z.x1,z.y1,z.x2,z.y2,z.x,z.y);ie.push(Math.floor((Le.y+he)/V)+1),ie.push(Math.floor((Le.y+Le.h+he)/V)+1);break;case"rect":ie.push(Math.floor((z.y+he)/V)+1),ie.push(Math.floor((z.y+z.h+he)/V)+1)}for(var Re=0;Re<ie.length;Re+=1)for(;this.pdf.internal.getNumberOfPages()<ie[Re];)w.call(this);return ie},w=function(){var z=this.fillStyle,G=this.strokeStyle,V=this.font,ie=this.lineCap,he=this.lineWidth,re=this.lineJoin;this.pdf.addPage(),this.fillStyle=z,this.strokeStyle=G,this.font=V,this.lineCap=ie,this.lineWidth=he,this.lineJoin=re},Se=function(z,G,V){for(var ie=0;ie<z.length;ie++)switch(z[ie].type){case"bct":z[ie].x2+=G,z[ie].y2+=V;case"qct":z[ie].x1+=G,z[ie].y1+=V;default:z[ie].x+=G,z[ie].y+=V}return z},$=function(z){return z.sort(function(G,V){return G-V})},H=function(z,G){var V=this.fillStyle,ie=this.strokeStyle,he=this.lineCap,re=this.lineWidth,Le=Math.abs(re*this.ctx.transform.scaleX),Re=this.lineJoin;if(this.autoPaging){for(var Ue,et,ot=JSON.parse(JSON.stringify(this.path)),Ct=JSON.parse(JSON.stringify(this.path)),Ot=[],se=0;se<Ct.length;se++)if(Ct[se].x!==void 0)for(var kt=ee.call(this,Ct[se]),Jt=0;Jt<kt.length;Jt+=1)Ot.indexOf(kt[Jt])===-1&&Ot.push(kt[Jt]);for(var Wt=0;Wt<Ot.length;Wt++)for(;this.pdf.internal.getNumberOfPages()<Ot[Wt];)w.call(this);$(Ot);for(var ht=Ot[0],Xe=Ot[Ot.length-1],Ut=ht;Ut<Xe+1;Ut++){this.pdf.setPage(Ut),this.fillStyle=V,this.strokeStyle=ie,this.lineCap=he,this.lineWidth=Le,this.lineJoin=Re;var an=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ht=Ut===1?this.posY+this.margin[0]:this.margin[0],Nn=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],zn=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ee=Ut===1?0:Nn+(Ut-2)*zn;if(this.ctx.clip_path.length!==0){var Ne=this.path;Ue=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=Se(Ue,this.posX+this.margin[3],-Ee+Ht+this.ctx.prevPageLastElemOffset),ae.call(this,z,!0),this.path=Ne}if(et=JSON.parse(JSON.stringify(ot)),this.path=Se(et,this.posX+this.margin[3],-Ee+Ht+this.ctx.prevPageLastElemOffset),G===!1||Ut===0){var Mt=(Ut>ht||Ut<Xe)&&D.call(this);Mt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],an,zn,null).clip().discardPath()),ae.call(this,z,G),Mt&&this.pdf.restoreGraphicsState()}this.lineWidth=re}this.path=ot}else this.lineWidth=Le,ae.call(this,z,G),this.lineWidth=re},ae=function(z,G){if((z!=="stroke"||G||!K.call(this))&&(z==="stroke"||G||!T.call(this))){for(var V,ie,he=[],re=this.path,Le=0;Le<re.length;Le++){var Re=re[Le];switch(Re.type){case"begin":he.push({begin:!0});break;case"close":he.push({close:!0});break;case"mt":he.push({start:Re,deltas:[],abs:[]});break;case"lt":var Ue=he.length;if(re[Le-1]&&!isNaN(re[Le-1].x)&&(V=[Re.x-re[Le-1].x,Re.y-re[Le-1].y],Ue>0)){for(;Ue>=0;Ue--)if(he[Ue-1].close!==!0&&he[Ue-1].begin!==!0){he[Ue-1].deltas.push(V),he[Ue-1].abs.push(Re);break}}break;case"bct":V=[Re.x1-re[Le-1].x,Re.y1-re[Le-1].y,Re.x2-re[Le-1].x,Re.y2-re[Le-1].y,Re.x-re[Le-1].x,Re.y-re[Le-1].y],he[he.length-1].deltas.push(V);break;case"qct":var et=re[Le-1].x+2/3*(Re.x1-re[Le-1].x),ot=re[Le-1].y+2/3*(Re.y1-re[Le-1].y),Ct=Re.x+2/3*(Re.x1-Re.x),Ot=Re.y+2/3*(Re.y1-Re.y),se=Re.x,kt=Re.y;V=[et-re[Le-1].x,ot-re[Le-1].y,Ct-re[Le-1].x,Ot-re[Le-1].y,se-re[Le-1].x,kt-re[Le-1].y],he[he.length-1].deltas.push(V);break;case"arc":he.push({deltas:[],abs:[],arc:!0}),Array.isArray(he[he.length-1].abs)&&he[he.length-1].abs.push(Re)}}ie=G?null:z==="stroke"?"stroke":"fill";for(var Jt=!1,Wt=0;Wt<he.length;Wt++)if(he[Wt].arc)for(var ht=he[Wt].abs,Xe=0;Xe<ht.length;Xe++){var Ut=ht[Xe];Ut.type==="arc"?pe.call(this,Ut.x,Ut.y,Ut.radius,Ut.startAngle,Ut.endAngle,Ut.counterclockwise,void 0,G,!Jt):U.call(this,Ut.x,Ut.y),Jt=!0}else if(he[Wt].close===!0)this.pdf.internal.out("h"),Jt=!1;else if(he[Wt].begin!==!0){var an=he[Wt].start.x,Ht=he[Wt].start.y;O.call(this,he[Wt].deltas,an,Ht),Jt=!0}ie&&Y.call(this,ie),G&&X.call(this)}},I=function(z){var G=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,V=G*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return z-V;case"top":return z+G-V;case"hanging":return z+G-2*V;case"middle":return z+G/2-V;default:return z}},oe=function(z){return z+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};_.prototype.createLinearGradient=function(){var z=function(){};return z.colorStops=[],z.addColorStop=function(G,V){this.colorStops.push([G,V])},z.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},z.isCanvasGradient=!0,z},_.prototype.createPattern=function(){return this.createLinearGradient()},_.prototype.createRadialGradient=function(){return this.createLinearGradient()};var pe=function(z,G,V,ie,he,re,Le,Re,Ue){for(var et=ce.call(this,V,ie,he,re),ot=0;ot<et.length;ot++){var Ct=et[ot];ot===0&&(Ue?F.call(this,Ct.x1+z,Ct.y1+G):U.call(this,Ct.x1+z,Ct.y1+G)),_e.call(this,z,G,Ct.x2,Ct.y2,Ct.x3,Ct.y3,Ct.x4,Ct.y4)}Re?X.call(this):Y.call(this,Le)},Y=function(z){switch(z){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},X=function(){this.pdf.clip(),this.pdf.discardPath()},F=function(z,G){this.pdf.internal.out(o(z)+" "+s(G)+" m")},R=function(z){var G;switch(z.align){case"right":case"end":G="right";break;case"center":G="center";break;default:G="left"}var V,ie,he,re=this.pdf.getTextDimensions(z.text),Le=I.call(this,z.y),Re=oe.call(this,Le)-re.h,Ue=this.ctx.transform.applyToPoint(new v(z.x,Le));if(this.autoPaging){var et=this.ctx.transform.decompose(),ot=new g;ot=(ot=(ot=ot.multiply(et.translate)).multiply(et.skew)).multiply(et.scale);for(var Ct=this.ctx.transform.applyToRectangle(new p(z.x,Le,re.w,re.h)),Ot=ot.applyToRectangle(new p(z.x,Re,re.w,re.h)),se=ee.call(this,Ot),kt=[],Jt=0;Jt<se.length;Jt+=1)kt.indexOf(se[Jt])===-1&&kt.push(se[Jt]);$(kt);for(var Wt=kt[0],ht=kt[kt.length-1],Xe=Wt;Xe<ht+1;Xe++){this.pdf.setPage(Xe);var Ut=Xe===1?this.posY+this.margin[0]:this.margin[0],an=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ht=this.pdf.internal.pageSize.height-this.margin[2],Nn=Ht-this.margin[0],zn=this.pdf.internal.pageSize.width-this.margin[1],Ee=zn-this.margin[3],Ne=Xe===1?0:an+(Xe-2)*Nn;if(this.ctx.clip_path.length!==0){var Mt=this.path;V=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=Se(V,this.posX+this.margin[3],-1*Ne+Ut),ae.call(this,"fill",!0),this.path=Mt}var ct=Se([JSON.parse(JSON.stringify(Ot))],this.posX+this.margin[3],-Ne+Ut+this.ctx.prevPageLastElemOffset)[0];z.scale>=.01&&(ie=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ie*z.scale),he=this.lineWidth,this.lineWidth=he*z.scale);var _t=this.autoPaging!=="text";if(_t||ct.y+ct.h<=Ht){if(_t||ct.y>=Ut&&ct.x<=zn){var Ze=_t?z.text:this.pdf.splitTextToSize(z.text,z.maxWidth||zn-ct.x)[0],jt=Se([JSON.parse(JSON.stringify(Ct))],this.posX+this.margin[3],-Ne+Ut+this.ctx.prevPageLastElemOffset)[0],en=_t&&(Xe>Wt||Xe<ht)&&D.call(this);en&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ee,Nn,null).clip().discardPath()),this.pdf.text(Ze,jt.x,jt.y,{angle:z.angle,align:G,renderingMode:z.renderingMode}),en&&this.pdf.restoreGraphicsState()}}else ct.y<Ht&&(this.ctx.prevPageLastElemOffset+=Ht-ct.y);z.scale>=.01&&(this.pdf.setFontSize(ie),this.lineWidth=he)}}else z.scale>=.01&&(ie=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ie*z.scale),he=this.lineWidth,this.lineWidth=he*z.scale),this.pdf.text(z.text,Ue.x+this.posX,Ue.y+this.posY,{angle:z.angle,align:G,renderingMode:z.renderingMode,maxWidth:z.maxWidth}),z.scale>=.01&&(this.pdf.setFontSize(ie),this.lineWidth=he)},U=function(z,G,V,ie){V=V||0,ie=ie||0,this.pdf.internal.out(o(z+V)+" "+s(G+ie)+" l")},O=function(z,G,V){return this.pdf.lines(z,G,V,null,null)},_e=function(z,G,V,ie,he,re,Le,Re){this.pdf.internal.out([r(c(V+z)),r(d(ie+G)),r(c(he+z)),r(d(re+G)),r(c(Le+z)),r(d(Re+G)),"c"].join(" "))},ce=function(z,G,V,ie){for(var he=2*Math.PI,re=Math.PI/2;G>V;)G-=he;var Le=Math.abs(V-G);Le<he&&ie&&(Le=he-Le);for(var Re=[],Ue=ie?-1:1,et=G;Le>1e-5;){var ot=et+Ue*Math.min(Le,re);Re.push(xe.call(this,z,et,ot)),Le-=Math.abs(ot-et),et=ot}return Re},xe=function(z,G,V){var ie=(V-G)/2,he=z*Math.cos(ie),re=z*Math.sin(ie),Le=he,Re=-re,Ue=Le*Le+Re*Re,et=Ue+Le*he+Re*re,ot=4/3*(Math.sqrt(2*Ue*et)-et)/(Le*re-Re*he),Ct=Le-ot*Re,Ot=Re+ot*Le,se=Ct,kt=-Ot,Jt=ie+G,Wt=Math.cos(Jt),ht=Math.sin(Jt);return{x1:z*Math.cos(G),y1:z*Math.sin(G),x2:Ct*Wt-Ot*ht,y2:Ct*ht+Ot*Wt,x3:se*Wt-kt*ht,y3:se*ht+kt*Wt,x4:z*Math.cos(V),y4:z*Math.sin(V)}},fe=function(z){return 180*z/Math.PI},ke=function(z,G,V,ie,he,re){var Le=z+.5*(V-z),Re=G+.5*(ie-G),Ue=he+.5*(V-he),et=re+.5*(ie-re),ot=Math.min(z,he,Le,Ue),Ct=Math.max(z,he,Le,Ue),Ot=Math.min(G,re,Re,et),se=Math.max(G,re,Re,et);return new p(ot,Ot,Ct-ot,se-Ot)},de=function(z,G,V,ie,he,re,Le,Re){var Ue,et,ot,Ct,Ot,se,kt,Jt,Wt,ht,Xe,Ut,an,Ht,Nn=V-z,zn=ie-G,Ee=he-V,Ne=re-ie,Mt=Le-he,ct=Re-re;for(et=0;et<41;et++)Wt=(kt=(ot=z+(Ue=et/40)*Nn)+Ue*((Ot=V+Ue*Ee)-ot))+Ue*(Ot+Ue*(he+Ue*Mt-Ot)-kt),ht=(Jt=(Ct=G+Ue*zn)+Ue*((se=ie+Ue*Ne)-Ct))+Ue*(se+Ue*(re+Ue*ct-se)-Jt),et==0?(Xe=Wt,Ut=ht,an=Wt,Ht=ht):(Xe=Math.min(Xe,Wt),Ut=Math.min(Ut,ht),an=Math.max(an,Wt),Ht=Math.max(Ht,ht));return new p(Math.round(Xe),Math.round(Ut),Math.round(an-Xe),Math.round(Ht-Ut))},C=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var z,G,V=(z=this.ctx.lineDash,G=this.ctx.lineDashOffset,JSON.stringify({lineDash:z,lineDashOffset:G}));this.prevLineDash!==V&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=V)}}})(En.API),(function(i){var r=function(v){var p,g,m,S,_,E,T,K,D,ee;for(g=[],m=0,S=(v+=p="\0\0\0\0".slice(v.length%4||4)).length;S>m;m+=4)(_=(v.charCodeAt(m)<<24)+(v.charCodeAt(m+1)<<16)+(v.charCodeAt(m+2)<<8)+v.charCodeAt(m+3))!==0?(E=(_=((_=((_=((_=(_-(ee=_%85))/85)-(D=_%85))/85)-(K=_%85))/85)-(T=_%85))/85)%85,g.push(E+33,T+33,K+33,D+33,ee+33)):g.push(122);return(function(w,Se){for(var $=Se;$>0;$--)w.pop()})(g,p.length),String.fromCharCode.apply(String,g)+"~>"},o=function(v){var p,g,m,S,_,E=String,T="length",K=255,D="charCodeAt",ee="slice",w="replace";for(v[ee](-2),v=v[ee](0,-2)[w](/\s/g,"")[w]("z","!!!!!"),m=[],S=0,_=(v+=p="uuuuu"[ee](v[T]%5||5))[T];_>S;S+=5)g=52200625*(v[D](S)-33)+614125*(v[D](S+1)-33)+7225*(v[D](S+2)-33)+85*(v[D](S+3)-33)+(v[D](S+4)-33),m.push(K&g>>24,K&g>>16,K&g>>8,K&g);return(function(Se,$){for(var H=$;H>0;H--)Se.pop()})(m,p[T]),E.fromCharCode.apply(E,m)},s=function(v){return v.split("").map(function(p){return("0"+p.charCodeAt().toString(16)).slice(-2)}).join("")+">"},c=function(v){var p=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((v=v.replace(/\s/g,"")).indexOf(">")!==-1&&(v=v.substr(0,v.indexOf(">"))),v.length%2&&(v+="0"),p.test(v)===!1)return"";for(var g="",m=0;m<v.length;m+=2)g+=String.fromCharCode("0x"+(v[m]+v[m+1]));return g},d=function(v){for(var p=new Uint8Array(v.length),g=v.length;g--;)p[g]=v.charCodeAt(g);return(p=Bg(p)).reduce(function(m,S){return m+String.fromCharCode(S)},"")};i.processDataByFilters=function(v,p){var g=0,m=v||"",S=[];for(typeof(p=p||[])=="string"&&(p=[p]),g=0;g<p.length;g+=1)switch(p[g]){case"ASCII85Decode":case"/ASCII85Decode":m=o(m),S.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":m=r(m),S.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":m=c(m),S.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":m=s(m),S.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":m=d(m),S.push("/FlateDecode");break;default:throw new Error('The filter: "'+p[g]+'" is not implemented')}return{data:m,reverseChain:S.reverse().join(" ")}}})(En.API),(function(i){i.loadFile=function(r,o,s){return(function(c,d,v){d=d!==!1,v=typeof v=="function"?v:function(){};var p=void 0;try{p=(function(g,m,S){var _=new XMLHttpRequest,E=0,T=function(K){var D=K.length,ee=[],w=String.fromCharCode;for(E=0;E<D;E+=1)ee.push(w(255&K.charCodeAt(E)));return ee.join("")};if(_.open("GET",g,!m),_.overrideMimeType("text/plain; charset=x-user-defined"),m===!1&&(_.onload=function(){_.status===200?S(T(this.responseText)):S(void 0)}),_.send(null),m&&_.status===200)return T(_.responseText)})(c,d,v)}catch{}return p})(r,o,s)},i.loadImageFile=i.loadFile})(En.API),(function(i){function r(){return(li.html2canvas?Promise.resolve(li.html2canvas):sg(()=>import("./html2canvas.esm-B0tyYwQk.js"),[])).catch(function(p){return Promise.reject(new Error("Could not load html2canvas: "+p))}).then(function(p){return p.default?p.default:p})}function o(){return(li.DOMPurify?Promise.resolve(li.DOMPurify):sg(()=>import("./purify.es-B6FQ9oRL.js"),[])).catch(function(p){return Promise.reject(new Error("Could not load dompurify: "+p))}).then(function(p){return p.default?p.default:p})}var s=function(p){var g=_r(p);return g==="undefined"?"undefined":g==="string"||p instanceof String?"string":g==="number"||p instanceof Number?"number":g==="function"||p instanceof Function?"function":p&&p.constructor===Array?"array":p&&p.nodeType===1?"element":g==="object"?"object":"unknown"},c=function(p,g){var m=document.createElement(p);for(var S in g.className&&(m.className=g.className),g.innerHTML&&g.dompurify&&(m.innerHTML=g.dompurify.sanitize(g.innerHTML)),g.style)m.style[S]=g.style[S];return m},d=function p(g,m){for(var S=g.nodeType===3?document.createTextNode(g.nodeValue):g.cloneNode(!1),_=g.firstChild;_;_=_.nextSibling)m!==!0&&_.nodeType===1&&_.nodeName==="SCRIPT"||S.appendChild(p(_,m));return g.nodeType===1&&(g.nodeName==="CANVAS"?(S.width=g.width,S.height=g.height,S.getContext("2d").drawImage(g,0,0)):g.nodeName!=="TEXTAREA"&&g.nodeName!=="SELECT"||(S.value=g.value),S.addEventListener("load",function(){S.scrollTop=g.scrollTop,S.scrollLeft=g.scrollLeft},!0)),S},v=function p(g){var m=Object.assign(p.convert(Promise.resolve()),JSON.parse(JSON.stringify(p.template))),S=p.convert(Promise.resolve(),m);return(S=S.setProgress(1,p,1,[p])).set(g)};(v.prototype=Object.create(Promise.prototype)).constructor=v,v.convert=function(p,g){return p.__proto__=g||v.prototype,p},v.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},v.prototype.from=function(p,g){return this.then(function(){switch(g=g||(function(m){switch(s(m)){case"string":return"string";case"element":return m.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(p),g){case"string":return this.then(o).then(function(m){return this.set({src:c("div",{innerHTML:p,dompurify:m})})});case"element":return this.set({src:p});case"canvas":return this.set({canvas:p});case"img":return this.set({img:p});default:return this.error("Unknown source type.")}})},v.prototype.to=function(p){switch(p){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},v.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var p={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},g=d(this.prop.src,this.opt.html2canvas.javascriptEnabled);g.tagName==="BODY"&&(p.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=c("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=c("div",{className:"html2pdf__container",style:p}),this.prop.container.appendChild(g),this.prop.container.firstChild.appendChild(c("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},v.prototype.toCanvas=function(){var p=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(p).then(r).then(function(g){var m=Object.assign({},this.opt.html2canvas);return delete m.onrendered,g(this.prop.container,m)}).then(function(g){(this.opt.html2canvas.onrendered||function(){})(g),this.prop.canvas=g,document.body.removeChild(this.prop.overlay)})},v.prototype.toContext2d=function(){var p=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(p).then(r).then(function(g){var m=this.opt.jsPDF,S=this.opt.fontFaces,_=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,E=Object.assign({async:!0,allowTaint:!0,scale:_,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete E.onrendered,m.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,m.context2d.posX=this.opt.x,m.context2d.posY=this.opt.y,m.context2d.margin=this.opt.margin,m.context2d.fontFaces=S,S)for(var T=0;T<S.length;++T){var K=S[T],D=K.src.find(function(ee){return ee.format==="truetype"});D&&m.addFont(D.url,K.ref.name,K.ref.style)}return E.windowHeight=E.windowHeight||0,E.windowHeight=E.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):E.windowHeight,m.context2d.save(!0),g(this.prop.container,E)}).then(function(g){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(g),this.prop.canvas=g,document.body.removeChild(this.prop.overlay)})},v.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var p=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=p})},v.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},v.prototype.output=function(p,g,m){return(m=m||"pdf").toLowerCase()==="img"||m.toLowerCase()==="image"?this.outputImg(p,g):this.outputPdf(p,g)},v.prototype.outputPdf=function(p,g){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(p,g)})},v.prototype.outputImg=function(p){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(p){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+p+'" is not supported.'}})},v.prototype.save=function(p){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(p?{filename:p}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},v.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},v.prototype.set=function(p){if(s(p)!=="object")return this;var g=Object.keys(p||{}).map(function(m){if(m in v.template.prop)return function(){this.prop[m]=p[m]};switch(m){case"margin":return this.setMargin.bind(this,p.margin);case"jsPDF":return function(){return this.opt.jsPDF=p.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,p.pageSize);default:return function(){this.opt[m]=p[m]}}},this);return this.then(function(){return this.thenList(g)})},v.prototype.get=function(p,g){return this.then(function(){var m=p in v.template.prop?this.prop[p]:this.opt[p];return g?g(m):m})},v.prototype.setMargin=function(p){return this.then(function(){switch(s(p)){case"number":p=[p,p,p,p];case"array":if(p.length===2&&(p=[p[0],p[1],p[0],p[1]]),p.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=p}).then(this.setPageSize)},v.prototype.setPageSize=function(p){function g(m,S){return Math.floor(m*S/72*96)}return this.then(function(){(p=p||En.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(p.inner={width:p.width-this.opt.margin[1]-this.opt.margin[3],height:p.height-this.opt.margin[0]-this.opt.margin[2]},p.inner.px={width:g(p.inner.width,p.k),height:g(p.inner.height,p.k)},p.inner.ratio=p.inner.height/p.inner.width),this.prop.pageSize=p})},v.prototype.setProgress=function(p,g,m,S){return p!=null&&(this.progress.val=p),g!=null&&(this.progress.state=g),m!=null&&(this.progress.n=m),S!=null&&(this.progress.stack=S),this.progress.ratio=this.progress.val/this.progress.state,this},v.prototype.updateProgress=function(p,g,m,S){return this.setProgress(p?this.progress.val+p:null,g||null,m?this.progress.n+m:null,S?this.progress.stack.concat(S):null)},v.prototype.then=function(p,g){var m=this;return this.thenCore(p,g,function(S,_){return m.updateProgress(null,null,1,[S]),Promise.prototype.then.call(this,function(E){return m.updateProgress(null,S),E}).then(S,_).then(function(E){return m.updateProgress(1),E})})},v.prototype.thenCore=function(p,g,m){m=m||Promise.prototype.then;var S=this;p&&(p=p.bind(S)),g&&(g=g.bind(S));var _=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?S:v.convert(Object.assign({},S),Promise.prototype),E=m.call(_,p,g);return v.convert(E,S.__proto__)},v.prototype.thenExternal=function(p,g){return Promise.prototype.then.call(this,p,g)},v.prototype.thenList=function(p){var g=this;return p.forEach(function(m){g=g.thenCore(m)}),g},v.prototype.catch=function(p){p&&(p=p.bind(this));var g=Promise.prototype.catch.call(this,p);return v.convert(g,this)},v.prototype.catchExternal=function(p){return Promise.prototype.catch.call(this,p)},v.prototype.error=function(p){return this.then(function(){throw new Error(p)})},v.prototype.using=v.prototype.set,v.prototype.saveAs=v.prototype.save,v.prototype.export=v.prototype.output,v.prototype.run=v.prototype.then,En.getPageSize=function(p,g,m){if(_r(p)==="object"){var S=p;p=S.orientation,g=S.unit||g,m=S.format||m}g=g||"mm",m=m||"a4",p=(""+(p||"P")).toLowerCase();var _,E=(""+m).toLowerCase(),T={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(g){case"pt":_=1;break;case"mm":_=72/25.4;break;case"cm":_=72/2.54;break;case"in":_=72;break;case"px":_=.75;break;case"pc":case"em":_=12;break;case"ex":_=6;break;default:throw"Invalid unit: "+g}var K,D=0,ee=0;if(T.hasOwnProperty(E))D=T[E][1]/_,ee=T[E][0]/_;else try{D=m[1],ee=m[0]}catch{throw new Error("Invalid format: "+m)}if(p==="p"||p==="portrait")p="p",ee>D&&(K=ee,ee=D,D=K);else{if(p!=="l"&&p!=="landscape")throw"Invalid orientation: "+p;p="l",D>ee&&(K=ee,ee=D,D=K)}return{width:ee,height:D,unit:g,k:_,orientation:p}},i.html=function(p,g){(g=g||{}).callback=g.callback||function(){},g.html2canvas=g.html2canvas||{},g.html2canvas.canvas=g.html2canvas.canvas||this.canvas,g.jsPDF=g.jsPDF||this,g.fontFaces=g.fontFaces?g.fontFaces.map(Cg):null;var m=new v(g);return g.worker?m:m.from(p).doCallback()}})(En.API),En.API.addJS=function(i){return Sx=i,this.internal.events.subscribe("postPutResources",function(){Jp=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Jp+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),wx=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Sx+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Jp!==void 0&&wx!==void 0&&this.internal.out("/Names <</JavaScript "+Jp+" 0 R>>")}),this},(function(i){var r;i.events.push(["postPutResources",function(){var o=this,s=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var c=o.outline.render().split(/\r\n/),d=0;d<c.length;d++){var v=c[d],p=s.exec(v);if(p!=null){var g=p[1];o.internal.newObjectDeferredBegin(g,!1)}o.internal.write(v)}if(this.outline.createNamedDestinations){var m=this.internal.pages.length,S=[];for(d=0;d<m;d++){var _=o.internal.newObject();S.push(_);var E=o.internal.getPageInfo(d+1);o.internal.write("<< /D["+E.objId+" 0 R /XYZ null null null]>> endobj")}var T=o.internal.newObject();for(o.internal.write("<< /Names [ "),d=0;d<S.length;d++)o.internal.write("(page_"+(d+1)+")"+S[d]+" 0 R");o.internal.write(" ] >>","endobj"),r=o.internal.newObject(),o.internal.write("<< /Dests "+T+" 0 R"),o.internal.write(">>","endobj")}}]),i.events.push(["putCatalog",function(){var o=this;o.outline.root.children.length>0&&(o.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&o.internal.write("/Names "+r+" 0 R"))}]),i.events.push(["initialized",function(){var o=this;o.outline={createNamedDestinations:!1,root:{children:[]}},o.outline.add=function(s,c,d){var v={title:c,options:d,children:[]};return s==null&&(s=this.root),s.children.push(v),v},o.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=o,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},o.outline.genIds_r=function(s){s.id=o.internal.newObjectDeferred();for(var c=0;c<s.children.length;c++)this.genIds_r(s.children[c])},o.outline.renderRoot=function(s){this.objStart(s),this.line("/Type /Outlines"),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1]))),this.line("/Count "+this.count_r({count:0},s)),this.objEnd()},o.outline.renderItems=function(s){for(var c=this.ctx.pdf.internal.getVerticalCoordinateString,d=0;d<s.children.length;d++){var v=s.children[d];this.objStart(v),this.line("/Title "+this.makeString(v.title)),this.line("/Parent "+this.makeRef(s)),d>0&&this.line("/Prev "+this.makeRef(s.children[d-1])),d<s.children.length-1&&this.line("/Next "+this.makeRef(s.children[d+1])),v.children.length>0&&(this.line("/First "+this.makeRef(v.children[0])),this.line("/Last "+this.makeRef(v.children[v.children.length-1])));var p=this.count=this.count_r({count:0},v);if(p>0&&this.line("/Count "+p),v.options&&v.options.pageNumber){var g=o.internal.getPageInfo(v.options.pageNumber);this.line("/Dest ["+g.objId+" 0 R /XYZ 0 "+c(0)+" 0]")}this.objEnd()}for(var m=0;m<s.children.length;m++)this.renderItems(s.children[m])},o.outline.line=function(s){this.ctx.val+=s+`\r
`},o.outline.makeRef=function(s){return s.id+" 0 R"},o.outline.makeString=function(s){return"("+o.internal.pdfEscape(s)+")"},o.outline.objStart=function(s){this.ctx.val+=`\r
`+s.id+` 0 obj\r
<<\r
`},o.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},o.outline.count_r=function(s,c){for(var d=0;d<c.children.length;d++)s.count++,this.count_r(s,c.children[d]);return s.count}}])})(En.API),(function(i){var r=[192,193,194,195,196,197,198,199];i.processJPEG=function(o,s,c,d,v,p){var g,m=this.decode.DCT_DECODE,S=null;if(typeof o=="string"||this.__addimage__.isArrayBuffer(o)||this.__addimage__.isArrayBufferView(o)){switch(o=v||o,o=this.__addimage__.isArrayBuffer(o)?new Uint8Array(o):o,g=(function(_){for(var E,T=256*_.charCodeAt(4)+_.charCodeAt(5),K=_.length,D={width:0,height:0,numcomponents:1},ee=4;ee<K;ee+=2){if(ee+=T,r.indexOf(_.charCodeAt(ee+1))!==-1){E=256*_.charCodeAt(ee+5)+_.charCodeAt(ee+6),D={width:256*_.charCodeAt(ee+7)+_.charCodeAt(ee+8),height:E,numcomponents:_.charCodeAt(ee+9)};break}T=256*_.charCodeAt(ee+2)+_.charCodeAt(ee+3)}return D})(o=this.__addimage__.isArrayBufferView(o)?this.__addimage__.arrayBufferToBinaryString(o):o),g.numcomponents){case 1:p=this.color_spaces.DEVICE_GRAY;break;case 4:p=this.color_spaces.DEVICE_CMYK;break;case 3:p=this.color_spaces.DEVICE_RGB}S={data:o,width:g.width,height:g.height,colorSpace:p,bitsPerComponent:8,filter:m,index:s,alias:c}}return S}})(En.API),En.API.processPNG=function(i,r,o,s){if(this.__addimage__.isArrayBuffer(i)&&(i=new Uint8Array(i)),this.__addimage__.isArrayBufferView(i)){var c,d=L5(i,{checkCrc:!0}),v=d.width,p=d.height,g=d.channels,m=d.palette,S=d.depth;c=m&&g===1?(function(pe){for(var Y=pe.width,X=pe.height,F=pe.data,R=pe.palette,U=pe.depth,O=!1,_e=[],ce=[],xe=void 0,fe=!1,ke=0,de=0;de<R.length;de++){var C=k1(R[de],4),z=C[0],G=C[1],V=C[2],ie=C[3];_e.push(z,G,V),ie!=null&&(ie===0?(ke++,ce.length<1&&ce.push(de)):ie<255&&(fe=!0))}if(fe||ke>1){O=!0,ce=void 0;var he=Y*X;xe=new Uint8Array(he);for(var re=new DataView(F.buffer),Le=0;Le<he;Le++){var Re=Ng(re,Le,U),Ue=k1(R[Re],4)[3];xe[Le]=Ue}}else ke===0&&(ce=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:O?8:void 0,colorBytes:F,alphaBytes:xe,needSMask:O,palette:_e,mask:ce}})(d):g===2||g===4?(function(pe){for(var Y=pe.data,X=pe.width,F=pe.height,R=pe.channels,U=pe.depth,O=R===2?"DeviceGray":"DeviceRGB",_e=R-1,ce=X*F,xe=_e,fe=ce*xe,ke=1*ce,de=Math.ceil(fe*U/8),C=Math.ceil(ke*U/8),z=new Uint8Array(de),G=new Uint8Array(C),V=new DataView(Y.buffer),ie=new DataView(z.buffer),he=new DataView(G.buffer),re=!1,Le=0;Le<ce;Le++){for(var Re=Le*R,Ue=0;Ue<xe;Ue++)_x(ie,Ng(V,Re+Ue,U),Le*xe+Ue,U);var et=Ng(V,Re+xe,U);et<(1<<U)-1&&(re=!0),_x(he,et,1*Le,U)}return{colorSpace:O,colorsPerPixel:_e,sMaskBitsPerComponent:re?U:void 0,colorBytes:z,alphaBytes:G,needSMask:re}})(d):(function(pe){var Y=pe.data,X=pe.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:X,colorsPerPixel:X==="DeviceGray"?1:3,colorBytes:Y instanceof Uint16Array?(function(F){for(var R=F.length,U=new Uint8Array(2*R),O=new DataView(U.buffer,U.byteOffset,U.byteLength),_e=0;_e<R;_e++)O.setUint16(2*_e,F[_e],!1);return U})(Y):Y,needSMask:!1}})(d);var _,E,T,K=c,D=K.colorSpace,ee=K.colorsPerPixel,w=K.sMaskBitsPerComponent,Se=K.colorBytes,$=K.alphaBytes,H=K.needSMask,ae=K.palette,I=K.mask,oe=null;return s!==En.API.image_compression.NONE&&typeof Bg=="function"?(oe=(function(pe){var Y;switch(pe){case En.API.image_compression.FAST:Y=11;break;case En.API.image_compression.MEDIUM:Y=13;break;case En.API.image_compression.SLOW:Y=14;break;default:Y=12}return Y})(s),_=this.decode.FLATE_DECODE,E="/Predictor ".concat(oe," /Colors ").concat(ee," /BitsPerComponent ").concat(S," /Columns ").concat(v),i=kx(Se,Math.ceil(v*ee*S/8),ee,S,s),H&&(T=kx($,Math.ceil(v*w/8),1,w,s))):(_=void 0,E=void 0,i=Se,H&&(T=$)),(this.__addimage__.isArrayBuffer(i)||this.__addimage__.isArrayBufferView(i))&&(i=this.__addimage__.arrayBufferToBinaryString(i)),(T&&this.__addimage__.isArrayBuffer(T)||this.__addimage__.isArrayBufferView(T))&&(T=this.__addimage__.arrayBufferToBinaryString(T)),{alias:o,data:i,index:r,filter:_,decodeParameters:E,transparency:I,palette:ae,sMask:T,predictor:oe,width:v,height:p,bitsPerComponent:S,sMaskBitsPerComponent:w,colorSpace:D}}},(function(i){i.processGIF89A=function(r,o,s,c){var d=new tv(r),v=d.width,p=d.height,g=[];d.decodeAndBlitFrameRGBA(0,g);var m={data:g,width:v,height:p},S=new Ag(100).encode(m,100);return i.processJPEG.call(this,S,o,s,c)},i.processGIF87A=i.processGIF89A})(En.API),gc.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var i=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(i);for(var r=0;r<i;r++){var o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),c=this.datav.getUint8(this.pos++,!0),d=this.datav.getUint8(this.pos++,!0);this.palette[r]={red:c,green:s,blue:o,quad:d}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},gc.prototype.parseBGR=function(){this.pos=this.offset;try{var i="bit"+this.bitPP,r=this.width*this.height*4;this.data=new Uint8Array(r),this[i]()}catch(o){Yr.log("bit decode error:"+o)}},gc.prototype.bit1=function(){var i,r=Math.ceil(this.width/8),o=r%4;for(i=this.height-1;i>=0;i--){for(var s=this.bottom_up?i:this.height-1-i,c=0;c<r;c++)for(var d=this.datav.getUint8(this.pos++,!0),v=s*this.width*4+8*c*4,p=0;p<8&&8*c+p<this.width;p++){var g=this.palette[d>>7-p&1];this.data[v+4*p]=g.blue,this.data[v+4*p+1]=g.green,this.data[v+4*p+2]=g.red,this.data[v+4*p+3]=255}o!==0&&(this.pos+=4-o)}},gc.prototype.bit4=function(){for(var i=Math.ceil(this.width/2),r=i%4,o=this.height-1;o>=0;o--){for(var s=this.bottom_up?o:this.height-1-o,c=0;c<i;c++){var d=this.datav.getUint8(this.pos++,!0),v=s*this.width*4+2*c*4,p=d>>4,g=15&d,m=this.palette[p];if(this.data[v]=m.blue,this.data[v+1]=m.green,this.data[v+2]=m.red,this.data[v+3]=255,2*c+1>=this.width)break;m=this.palette[g],this.data[v+4]=m.blue,this.data[v+4+1]=m.green,this.data[v+4+2]=m.red,this.data[v+4+3]=255}r!==0&&(this.pos+=4-r)}},gc.prototype.bit8=function(){for(var i=this.width%4,r=this.height-1;r>=0;r--){for(var o=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var c=this.datav.getUint8(this.pos++,!0),d=o*this.width*4+4*s;if(c<this.palette.length){var v=this.palette[c];this.data[d]=v.red,this.data[d+1]=v.green,this.data[d+2]=v.blue,this.data[d+3]=255}else this.data[d]=255,this.data[d+1]=255,this.data[d+2]=255,this.data[d+3]=255}i!==0&&(this.pos+=4-i)}},gc.prototype.bit15=function(){for(var i=this.width%3,r=parseInt("11111",2),o=this.height-1;o>=0;o--){for(var s=this.bottom_up?o:this.height-1-o,c=0;c<this.width;c++){var d=this.datav.getUint16(this.pos,!0);this.pos+=2;var v=(d&r)/r*255|0,p=(d>>5&r)/r*255|0,g=(d>>10&r)/r*255|0,m=d>>15?255:0,S=s*this.width*4+4*c;this.data[S]=g,this.data[S+1]=p,this.data[S+2]=v,this.data[S+3]=m}this.pos+=i}},gc.prototype.bit16=function(){for(var i=this.width%3,r=parseInt("11111",2),o=parseInt("111111",2),s=this.height-1;s>=0;s--){for(var c=this.bottom_up?s:this.height-1-s,d=0;d<this.width;d++){var v=this.datav.getUint16(this.pos,!0);this.pos+=2;var p=(v&r)/r*255|0,g=(v>>5&o)/o*255|0,m=(v>>11)/r*255|0,S=c*this.width*4+4*d;this.data[S]=m,this.data[S+1]=g,this.data[S+2]=p,this.data[S+3]=255}this.pos+=i}},gc.prototype.bit24=function(){for(var i=this.height-1;i>=0;i--){for(var r=this.bottom_up?i:this.height-1-i,o=0;o<this.width;o++){var s=this.datav.getUint8(this.pos++,!0),c=this.datav.getUint8(this.pos++,!0),d=this.datav.getUint8(this.pos++,!0),v=r*this.width*4+4*o;this.data[v]=d,this.data[v+1]=c,this.data[v+2]=s,this.data[v+3]=255}this.pos+=this.width%4}},gc.prototype.bit32=function(){for(var i=this.height-1;i>=0;i--)for(var r=this.bottom_up?i:this.height-1-i,o=0;o<this.width;o++){var s=this.datav.getUint8(this.pos++,!0),c=this.datav.getUint8(this.pos++,!0),d=this.datav.getUint8(this.pos++,!0),v=this.datav.getUint8(this.pos++,!0),p=r*this.width*4+4*o;this.data[p]=d,this.data[p+1]=c,this.data[p+2]=s,this.data[p+3]=v}},gc.prototype.getData=function(){return this.data},(function(i){i.processBMP=function(r,o,s,c){var d=new gc(r,!1),v=d.width,p=d.height,g={data:d.getData(),width:v,height:p},m=new Ag(100).encode(g,100);return i.processJPEG.call(this,m,o,s,c)}})(En.API),Dx.prototype.getData=function(){return this.data},(function(i){i.processWEBP=function(r,o,s,c){var d=new Dx(r),v=d.width,p=d.height,g={data:d.getData(),width:v,height:p},m=new Ag(100).encode(g,100);return i.processJPEG.call(this,m,o,s,c)}})(En.API),En.API.processRGBA=function(i,r,o){for(var s=i.data,c=s.length,d=new Uint8Array(c/4*3),v=new Uint8Array(c/4),p=0,g=0,m=0;m<c;m+=4){var S=s[m],_=s[m+1],E=s[m+2],T=s[m+3];d[p++]=S,d[p++]=_,d[p++]=E,v[g++]=T}var K=this.__addimage__.arrayBufferToBinaryString(d);return{alpha:this.__addimage__.arrayBufferToBinaryString(v),data:K,index:r,alias:o,colorSpace:"DeviceRGB",bitsPerComponent:8,width:i.width,height:i.height}},En.API.setLanguage=function(i){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[i]!==void 0&&(this.internal.languageSettings.languageCode=i,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Xd=En.API,Qp=Xd.getCharWidthsArray=function(i,r){var o,s,c=(r=r||{}).font||this.internal.getFont(),d=r.fontSize||this.internal.getFontSize(),v=r.charSpace||this.internal.getCharSpace(),p=r.widths?r.widths:c.metadata.Unicode.widths,g=p.fof?p.fof:1,m=r.kerning?r.kerning:c.metadata.Unicode.kerning,S=m.fof?m.fof:1,_=r.doKerning!==!1,E=0,T=i.length,K=0,D=p[0]||g,ee=[];for(o=0;o<T;o++)s=i.charCodeAt(o),typeof c.metadata.widthOfString=="function"?ee.push((c.metadata.widthOfGlyph(c.metadata.characterToGlyph(s))+v*(1e3/d)||0)/1e3):(E=_&&_r(m[s])==="object"&&!isNaN(parseInt(m[s][K],10))?m[s][K]/S:0,ee.push((p[s]||D)/g+E)),K=s;return ee},jx=Xd.getStringUnitWidth=function(i,r){var o=(r=r||{}).fontSize||this.internal.getFontSize(),s=r.font||this.internal.getFont(),c=r.charSpace||this.internal.getCharSpace();return Xd.processArabic&&(i=Xd.processArabic(i)),typeof s.metadata.widthOfString=="function"?s.metadata.widthOfString(i,o,c)/o:Qp.apply(this,arguments).reduce(function(d,v){return d+v},0)},Tx=function(i,r,o,s){for(var c=[],d=0,v=i.length,p=0;d!==v&&p+r[d]<o;)p+=r[d],d++;c.push(i.slice(0,d));var g=d;for(p=0;d!==v;)p+r[d]>s&&(c.push(i.slice(g,d)),p=0,g=d),p+=r[d],d++;return g!==d&&c.push(i.slice(g,d)),c},Cx=function(i,r,o){o||(o={});var s,c,d,v,p,g,m,S=[],_=[S],E=o.textIndent||0,T=0,K=0,D=i.split(" "),ee=Qp.apply(this,[" ",o])[0];if(g=o.lineIndent===-1?D[0].length+2:o.lineIndent||0){var w=Array(g).join(" "),Se=[];D.map(function(H){(H=H.split(/\s*\n/)).length>1?Se=Se.concat(H.map(function(ae,I){return(I&&ae.length?`
`:"")+ae})):Se.push(H[0])}),D=Se,g=jx.apply(this,[w,o])}for(d=0,v=D.length;d<v;d++){var $=0;if(s=D[d],g&&s[0]==`
`&&(s=s.substr(1),$=1),E+T+(K=(c=Qp.apply(this,[s,o])).reduce(function(H,ae){return H+ae},0))>r||$){if(K>r){for(p=Tx.apply(this,[s,c,r-(E+T),r]),S.push(p.shift()),S=[p.pop()];p.length;)_.push([p.shift()]);K=c.slice(s.length-(S[0]?S[0].length:0)).reduce(function(H,ae){return H+ae},0)}else S=[s];_.push(S),E=K+g,T=ee}else S.push(s),E+=T+K,T=ee}return m=g?function(H,ae){return(ae?w:"")+H.join(" ")}:function(H){return H.join(" ")},_.map(m)},Xd.splitTextToSize=function(i,r,o){var s,c=(o=o||{}).fontSize||this.internal.getFontSize(),d=(function(S){if(S.widths&&S.kerning)return{widths:S.widths,kerning:S.kerning};var _=this.internal.getFont(S.fontName,S.fontStyle),E="Unicode";return _.metadata[E]?{widths:_.metadata[E].widths||{0:1},kerning:_.metadata[E].kerning||{}}:{font:_.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,o);s=Array.isArray(i)?i:String(i).split(/\r?\n/);var v=1*this.internal.scaleFactor*r/c;d.textIndent=o.textIndent?1*o.textIndent*this.internal.scaleFactor/c:0,d.lineIndent=o.lineIndent;var p,g,m=[];for(p=0,g=s.length;p<g;p++)m=m.concat(Cx.apply(this,[s[p],v,d]));return m},(function(i){i.__fontmetrics__=i.__fontmetrics__||{};for(var r="0123456789abcdef",o="klmnopqrstuvwxyz",s={},c={},d=0;d<16;d++)s[o[d]]=r[d],c[r[d]]=o[d];var v=function(E){return"0x"+parseInt(E,10).toString(16)},p=i.__fontmetrics__.compress=function(E){var T,K,D,ee,w=["{"];for(var Se in E){if(T=E[Se],isNaN(parseInt(Se,10))?K="'"+Se+"'":(Se=parseInt(Se,10),K=(K=v(Se).slice(2)).slice(0,-1)+c[K.slice(-1)]),typeof T=="number")T<0?(D=v(T).slice(3),ee="-"):(D=v(T).slice(2),ee=""),D=ee+D.slice(0,-1)+c[D.slice(-1)];else{if(_r(T)!=="object")throw new Error("Don't know what to do with value type "+_r(T)+".");D=p(T)}w.push(K+D)}return w.push("}"),w.join("")},g=i.__fontmetrics__.uncompress=function(E){if(typeof E!="string")throw new Error("Invalid argument passed to uncompress.");for(var T,K,D,ee,w={},Se=1,$=w,H=[],ae="",I="",oe=E.length-1,pe=1;pe<oe;pe+=1)(ee=E[pe])=="'"?T?(D=T.join(""),T=void 0):T=[]:T?T.push(ee):ee=="{"?(H.push([$,D]),$={},D=void 0):ee=="}"?((K=H.pop())[0][K[1]]=$,D=void 0,$=K[0]):ee=="-"?Se=-1:D===void 0?s.hasOwnProperty(ee)?(ae+=s[ee],D=parseInt(ae,16)*Se,Se=1,ae=""):ae+=ee:s.hasOwnProperty(ee)?(I+=s[ee],$[D]=parseInt(I,16)*Se,Se=1,D=void 0,I=""):I+=ee;return w},m={codePages:["WinAnsiEncoding"],WinAnsiEncoding:g("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},S={Unicode:{Courier:m,"Courier-Bold":m,"Courier-BoldOblique":m,"Courier-Oblique":m,Helvetica:m,"Helvetica-Bold":m,"Helvetica-BoldOblique":m,"Helvetica-Oblique":m,"Times-Roman":m,"Times-Bold":m,"Times-BoldItalic":m,"Times-Italic":m}},_={Unicode:{"Courier-Oblique":g("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":g("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":g("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:g("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":g("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":g("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:g("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:g("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":g("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:g("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":g("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":g("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":g("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":g("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};i.events.push(["addFont",function(E){var T=E.font,K=_.Unicode[T.postScriptName];K&&(T.metadata.Unicode={},T.metadata.Unicode.widths=K.widths,T.metadata.Unicode.kerning=K.kerning);var D=S.Unicode[T.postScriptName];D&&(T.metadata.Unicode.encoding=D,T.encoding=D.codePages[0])}])})(En.API),(function(i){var r=function(o){for(var s=o.length,c=new Uint8Array(s),d=0;d<s;d++)c[d]=o.charCodeAt(d);return c};i.API.events.push(["addFont",function(o){var s=void 0,c=o.font,d=o.instance;if(!c.isStandardFont){if(d===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+c.postScriptName+"').");if(typeof(s=d.existsFileInVFS(c.postScriptName)===!1?d.loadFile(c.postScriptName):d.getFileFromVFS(c.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+c.postScriptName+"').");(function(v,p){p=/^\x00\x01\x00\x00/.test(p)?r(p):r(ih(p)),v.metadata=i.API.TTFFont.open(p),v.metadata.Unicode=v.metadata.Unicode||{encoding:{},kerning:{},widths:[]},v.metadata.glyIdsUsed=[0]})(c,s)}}])})(En),En.API.addSvgAsImage=function(i,r,o,s,c,d,v,p){if(isNaN(r)||isNaN(o))throw Yr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(c))throw Yr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var g=document.createElement("canvas");g.width=s,g.height=c;var m=g.getContext("2d");m.fillStyle="#fff",m.fillRect(0,0,g.width,g.height);var S={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},_=this;return(li.canvg?Promise.resolve(li.canvg):sg(()=>import("./index.es-QlmRRugF.js"),[])).catch(function(E){return Promise.reject(new Error("Could not load canvg: "+E))}).then(function(E){return E.default?E.default:E}).then(function(E){return E.fromString(m,i,S)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(E){return E.render(S)}).then(function(){_.addImage(g.toDataURL("image/jpeg",1),r,o,s,c,v,p)})},En.API.putTotalPages=function(i){var r,o=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(r=new RegExp(i,"g"),o=this.internal.getNumberOfPages()):(r=new RegExp(this.pdfEscape16(i,this.internal.getFont()),"g"),o=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var s=1;s<=this.internal.getNumberOfPages();s++)for(var c=0;c<this.internal.pages[s].length;c++)this.internal.pages[s][c]=this.internal.pages[s][c].replace(r,o);return this},En.API.viewerPreferences=function(i,r){var o;i=i||{},r=r||!1;var s,c,d,v={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},p=Object.keys(v),g=[],m=0,S=0,_=0;function E(K,D){var ee,w=!1;for(ee=0;ee<K.length;ee+=1)K[ee]===D&&(w=!0);return w}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(v)),this.internal.viewerpreferences.isSubscribed=!1),o=this.internal.viewerpreferences.configuration,i==="reset"||r===!0){var T=p.length;for(_=0;_<T;_+=1)o[p[_]].value=o[p[_]].defaultValue,o[p[_]].explicitSet=!1}if(_r(i)==="object"){for(c in i)if(d=i[c],E(p,c)&&d!==void 0){if(o[c].type==="boolean"&&typeof d=="boolean")o[c].value=d;else if(o[c].type==="name"&&E(o[c].valueSet,d))o[c].value=d;else if(o[c].type==="integer"&&Number.isInteger(d))o[c].value=d;else if(o[c].type==="array"){for(m=0;m<d.length;m+=1)if(s=!0,d[m].length===1&&typeof d[m][0]=="number")g.push(String(d[m]-1));else if(d[m].length>1){for(S=0;S<d[m].length;S+=1)typeof d[m][S]!="number"&&(s=!1);s===!0&&g.push([d[m][0]-1,d[m][1]-1].join(" "))}o[c].value="["+g.join(" ")+"]"}else o[c].value=o[c].defaultValue;o[c].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var K,D=[];for(K in o)o[K].explicitSet===!0&&(o[K].type==="name"?D.push("/"+K+" /"+o[K].value):D.push("/"+K+" "+o[K].value));D.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+D.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=o,this},(function(i){var r=function(){var s='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',c=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),d=unescape(encodeURIComponent(s)),v=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),p=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),g=unescape(encodeURIComponent("</x:xmpmeta>")),m=d.length+v.length+p.length+c.length+g.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+m+" >>"),this.internal.write("stream"),this.internal.write(c+d+v+p+g),this.internal.write("endstream"),this.internal.write("endobj")},o=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};i.addMetadata=function(s,c){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:s,namespaceuri:c||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",o),this.internal.events.subscribe("postPutResources",r)),this}})(En.API),(function(i){var r=i.API,o=r.pdfEscape16=function(d,v){for(var p,g=v.metadata.Unicode.widths,m=["","0","00","000","0000"],S=[""],_=0,E=d.length;_<E;++_){if(p=v.metadata.characterToGlyph(d.charCodeAt(_)),v.metadata.glyIdsUsed.push(p),v.metadata.toUnicode[p]=d.charCodeAt(_),g.indexOf(p)==-1&&(g.push(p),g.push([parseInt(v.metadata.widthOfGlyph(p),10)])),p=="0")return S.join("");p=p.toString(16),S.push(m[4-p.length],p)}return S.join("")},s=function(d){var v,p,g,m,S,_,E;for(S=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,g=[],_=0,E=(p=Object.keys(d).sort(function(T,K){return T-K})).length;_<E;_++)v=p[_],g.length>=100&&(S+=`
`+g.length+` beginbfchar
`+g.join(`
`)+`
endbfchar`,g=[]),d[v]!==void 0&&d[v]!==null&&typeof d[v].toString=="function"&&(m=("0000"+d[v].toString(16)).slice(-4),v=("0000"+(+v).toString(16)).slice(-4),g.push("<"+v+"><"+m+">"));return g.length&&(S+=`
`+g.length+` beginbfchar
`+g.join(`
`)+`
endbfchar
`),S+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};r.events.push(["putFont",function(d){(function(v){var p=v.font,g=v.out,m=v.newObject,S=v.putStream;if(p.metadata instanceof i.API.TTFFont&&p.encoding==="Identity-H"){for(var _=p.metadata.Unicode.widths,E=p.metadata.subset.encode(p.metadata.glyIdsUsed,1),T="",K=0;K<E.length;K++)T+=String.fromCharCode(E[K]);var D=m();S({data:T,addLength1:!0,objectId:D}),g("endobj");var ee=m();S({data:s(p.metadata.toUnicode),addLength1:!0,objectId:ee}),g("endobj");var w=m();g("<<"),g("/Type /FontDescriptor"),g("/FontName /"+Qd(p.fontName)),g("/FontFile2 "+D+" 0 R"),g("/FontBBox "+i.API.PDFObject.convert(p.metadata.bbox)),g("/Flags "+p.metadata.flags),g("/StemV "+p.metadata.stemV),g("/ItalicAngle "+p.metadata.italicAngle),g("/Ascent "+p.metadata.ascender),g("/Descent "+p.metadata.decender),g("/CapHeight "+p.metadata.capHeight),g(">>"),g("endobj");var Se=m();g("<<"),g("/Type /Font"),g("/BaseFont /"+Qd(p.fontName)),g("/FontDescriptor "+w+" 0 R"),g("/W "+i.API.PDFObject.convert(_)),g("/CIDToGIDMap /Identity"),g("/DW 1000"),g("/Subtype /CIDFontType2"),g("/CIDSystemInfo"),g("<<"),g("/Supplement 0"),g("/Registry (Adobe)"),g("/Ordering ("+p.encoding+")"),g(">>"),g(">>"),g("endobj"),p.objectNumber=m(),g("<<"),g("/Type /Font"),g("/Subtype /Type0"),g("/ToUnicode "+ee+" 0 R"),g("/BaseFont /"+Qd(p.fontName)),g("/Encoding /"+p.encoding),g("/DescendantFonts ["+Se+" 0 R]"),g(">>"),g("endobj"),p.isAlreadyPutted=!0}})(d)}]),r.events.push(["putFont",function(d){(function(v){var p=v.font,g=v.out,m=v.newObject,S=v.putStream;if(p.metadata instanceof i.API.TTFFont&&p.encoding==="WinAnsiEncoding"){for(var _=p.metadata.rawData,E="",T=0;T<_.length;T++)E+=String.fromCharCode(_[T]);var K=m();S({data:E,addLength1:!0,objectId:K}),g("endobj");var D=m();S({data:s(p.metadata.toUnicode),addLength1:!0,objectId:D}),g("endobj");var ee=m();g("<<"),g("/Descent "+p.metadata.decender),g("/CapHeight "+p.metadata.capHeight),g("/StemV "+p.metadata.stemV),g("/Type /FontDescriptor"),g("/FontFile2 "+K+" 0 R"),g("/Flags 96"),g("/FontBBox "+i.API.PDFObject.convert(p.metadata.bbox)),g("/FontName /"+Qd(p.fontName)),g("/ItalicAngle "+p.metadata.italicAngle),g("/Ascent "+p.metadata.ascender),g(">>"),g("endobj"),p.objectNumber=m();for(var w=0;w<p.metadata.hmtx.widths.length;w++)p.metadata.hmtx.widths[w]=parseInt(p.metadata.hmtx.widths[w]*(1e3/p.metadata.head.unitsPerEm));g("<</Subtype/TrueType/Type/Font/ToUnicode "+D+" 0 R/BaseFont/"+Qd(p.fontName)+"/FontDescriptor "+ee+" 0 R/Encoding/"+p.encoding+" /FirstChar 29 /LastChar 255 /Widths "+i.API.PDFObject.convert(p.metadata.hmtx.widths)+">>"),g("endobj"),p.isAlreadyPutted=!0}})(d)}]);var c=function(d){var v,p=d.text||"",g=d.x,m=d.y,S=d.options||{},_=d.mutex||{},E=_.pdfEscape,T=_.activeFontKey,K=_.fonts,D=T,ee="",w=0,Se="",$=K[D].encoding;if(K[D].encoding!=="Identity-H")return{text:p,x:g,y:m,options:S,mutex:_};for(Se=p,D=T,Array.isArray(p)&&(Se=p[0]),w=0;w<Se.length;w+=1)K[D].metadata.hasOwnProperty("cmap")&&(v=K[D].metadata.cmap.unicode.codeMap[Se[w].charCodeAt(0)]),v||Se[w].charCodeAt(0)<256&&K[D].metadata.hasOwnProperty("Unicode")?ee+=Se[w]:ee+="";var H="";return parseInt(D.slice(1))<14||$==="WinAnsiEncoding"?H=E(ee,D).split("").map(function(ae){return ae.charCodeAt(0).toString(16)}).join(""):$==="Identity-H"&&(H=o(ee,K[D])),_.isHex=!0,{text:H,x:g,y:m,options:S,mutex:_}};r.events.push(["postProcessText",function(d){var v=d.text||"",p=[],g={text:v,x:d.x,y:d.y,options:d.options,mutex:d.mutex};if(Array.isArray(v)){var m=0;for(m=0;m<v.length;m+=1)Array.isArray(v[m])&&v[m].length===3?p.push([c(Object.assign({},g,{text:v[m][0]})).text,v[m][1],v[m][2]]):p.push(c(Object.assign({},g,{text:v[m]})).text);d.text=p}else d.text=c(Object.assign({},g,{text:v})).text}])})(En),(function(i){var r=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};i.existsFileInVFS=function(o){return r.call(this),this.internal.vFS[o]!==void 0},i.addFileToVFS=function(o,s){return r.call(this),this.internal.vFS[o]=s,this},i.getFileFromVFS=function(o){return r.call(this),this.internal.vFS[o]!==void 0?this.internal.vFS[o]:null}})(En.API),(function(i){i.__bidiEngine__=i.prototype.__bidiEngine__=function(s){var c,d,v,p,g,m,S,_=r,E=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],T=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],K={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},D={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},ee=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],w=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),Se=!1,$=0;this.__bidiEngine__={};var H=function(F){var R=F.charCodeAt(),U=R>>8,O=D[U];return O!==void 0?_[256*O+(255&R)]:U===252||U===253?"AL":w.test(U)?"L":U===8?"R":"N"},ae=function(F){for(var R,U=0;U<F.length;U++){if((R=H(F.charAt(U)))==="L")return!1;if(R==="R")return!0}return!1},I=function(F,R,U,O){var _e,ce,xe,fe,ke=R[O];switch(ke){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":Se=!1;break;case"N":case"AN":break;case"EN":Se&&(ke="AN");break;case"AL":Se=!0,ke="R";break;case"WS":case"BN":ke="N";break;case"CS":O<1||O+1>=R.length||(_e=U[O-1])!=="EN"&&_e!=="AN"||(ce=R[O+1])!=="EN"&&ce!=="AN"?ke="N":Se&&(ce="AN"),ke=ce===_e?ce:"N";break;case"ES":ke=(_e=O>0?U[O-1]:"B")==="EN"&&O+1<R.length&&R[O+1]==="EN"?"EN":"N";break;case"ET":if(O>0&&U[O-1]==="EN"){ke="EN";break}if(Se){ke="N";break}for(xe=O+1,fe=R.length;xe<fe&&R[xe]==="ET";)xe++;ke=xe<fe&&R[xe]==="EN"?"EN":"N";break;case"NSM":if(v&&!p){for(fe=R.length,xe=O+1;xe<fe&&R[xe]==="NSM";)xe++;if(xe<fe){var de=F[O],C=de>=1425&&de<=2303||de===64286;if(_e=R[xe],C&&(_e==="R"||_e==="AL")){ke="R";break}}}ke=O<1||(_e=R[O-1])==="B"?"N":U[O-1];break;case"B":Se=!1,c=!0,ke=$;break;case"S":d=!0,ke="N"}return ke},oe=function(F,R,U){var O=F.split("");return U&&pe(O,U,{hiLevel:$}),O.reverse(),R&&R.reverse(),O.join("")},pe=function(F,R,U){var O,_e,ce,xe,fe,ke=-1,de=F.length,C=0,z=[],G=$?T:E,V=[];for(Se=!1,c=!1,d=!1,_e=0;_e<de;_e++)V[_e]=H(F[_e]);for(ce=0;ce<de;ce++){if(fe=C,z[ce]=I(F,V,z,ce),O=240&(C=G[fe][K[z[ce]]]),C&=15,R[ce]=xe=G[C][5],O>0)if(O===16){for(_e=ke;_e<ce;_e++)R[_e]=1;ke=-1}else ke=-1;if(G[C][6])ke===-1&&(ke=ce);else if(ke>-1){for(_e=ke;_e<ce;_e++)R[_e]=xe;ke=-1}V[ce]==="B"&&(R[ce]=0),U.hiLevel|=xe}d&&(function(ie,he,re){for(var Le=0;Le<re;Le++)if(ie[Le]==="S"){he[Le]=$;for(var Re=Le-1;Re>=0&&ie[Re]==="WS";Re--)he[Re]=$}})(V,R,de)},Y=function(F,R,U,O,_e){if(!(_e.hiLevel<F)){if(F===1&&$===1&&!c)return R.reverse(),void(U&&U.reverse());for(var ce,xe,fe,ke,de=R.length,C=0;C<de;){if(O[C]>=F){for(fe=C+1;fe<de&&O[fe]>=F;)fe++;for(ke=C,xe=fe-1;ke<xe;ke++,xe--)ce=R[ke],R[ke]=R[xe],R[xe]=ce,U&&(ce=U[ke],U[ke]=U[xe],U[xe]=ce);C=fe}C++}}},X=function(F,R,U){var O=F.split(""),_e={hiLevel:$};return U||(U=[]),pe(O,U,_e),(function(ce,xe,fe){if(fe.hiLevel!==0&&S)for(var ke,de=0;de<ce.length;de++)xe[de]===1&&(ke=ee.indexOf(ce[de]))>=0&&(ce[de]=ee[ke+1])})(O,U,_e),Y(2,O,R,U,_e),Y(1,O,R,U,_e),O.join("")};return this.__bidiEngine__.doBidiReorder=function(F,R,U){if((function(_e,ce){if(ce)for(var xe=0;xe<_e.length;xe++)ce[xe]=xe;p===void 0&&(p=ae(_e)),m===void 0&&(m=ae(_e))})(F,R),v||!g||m)if(v&&g&&p^m)$=p?1:0,F=oe(F,R,U);else if(!v&&g&&m)$=p?1:0,F=X(F,R,U),F=oe(F,R);else if(!v||p||g||m){if(v&&!g&&p^m)F=oe(F,R),p?($=0,F=X(F,R,U)):($=1,F=X(F,R,U),F=oe(F,R));else if(v&&p&&!g&&m)$=1,F=X(F,R,U),F=oe(F,R);else if(!v&&!g&&p^m){var O=S;p?($=1,F=X(F,R,U),$=0,S=!1,F=X(F,R,U),S=O):($=0,F=X(F,R,U),F=oe(F,R),$=1,S=!1,F=X(F,R,U),S=O,F=oe(F,R))}}else $=0,F=X(F,R,U);else $=p?1:0,F=X(F,R,U);return F},this.__bidiEngine__.setOptions=function(F){F&&(v=F.isInputVisual,g=F.isOutputVisual,p=F.isInputRtl,m=F.isOutputRtl,S=F.isSymmetricSwapping)},this.__bidiEngine__.setOptions(s),this.__bidiEngine__};var r=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],o=new i.__bidiEngine__({isInputVisual:!0});i.API.events.push(["postProcessText",function(s){var c=s.text;s.x,s.y;var d=s.options||{};s.mutex,d.lang;var v=[];if(d.isInputVisual=typeof d.isInputVisual!="boolean"||d.isInputVisual,o.setOptions(d),Object.prototype.toString.call(c)==="[object Array]"){var p=0;for(v=[],p=0;p<c.length;p+=1)Object.prototype.toString.call(c[p])==="[object Array]"?v.push([o.doBidiReorder(c[p][0]),c[p][1],c[p][2]]):v.push([o.doBidiReorder(c[p])]);s.text=v}else s.text=o.doBidiReorder(c);o.setOptions({isInputVisual:!0})}])})(En),En.API.TTFFont=(function(){function i(r){var o;if(this.rawData=r,o=this.contents=new Vu(r),this.contents.pos=4,o.readString(4)==="ttcf")throw new Error("TTCF not supported.");o.pos=0,this.parse(),this.subset=new xv(this),this.registerTTF()}return i.open=function(r){return new i(r)},i.prototype.parse=function(){return this.directory=new nv(this.contents),this.head=new rv(this),this.name=new cv(this),this.cmap=new By(this),this.toUnicode={},this.hhea=new av(this),this.maxp=new uv(this),this.hmtx=new dv(this),this.post=new sv(this),this.os2=new ov(this),this.loca=new gv(this),this.glyf=new fv(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},i.prototype.registerTTF=function(){var r,o,s,c,d;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var v,p,g,m;for(m=[],v=0,p=(g=this.bbox).length;v<p;v++)r=g[v],m.push(Math.round(r*this.scaleFactor));return m}).call(this),this.stemV=0,this.post.exists?(s=255&(c=this.post.italic_angle),32768&(o=c>>16)&&(o=-(1+(65535^o))),this.italicAngle=+(o+"."+s)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(d=this.familyClass)===1||d===2||d===3||d===4||d===5||d===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},i.prototype.characterToGlyph=function(r){var o;return((o=this.cmap.unicode)!=null?o.codeMap[r]:void 0)||0},i.prototype.widthOfGlyph=function(r){var o;return o=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(r).advance*o},i.prototype.widthOfString=function(r,o,s){var c,d,v,p;for(v=0,d=0,p=(r=""+r).length;0<=p?d<p:d>p;d=0<=p?++d:--d)c=r.charCodeAt(d),v+=this.widthOfGlyph(this.characterToGlyph(c))+s*(1e3/o)||0;return v*(o/1e3)},i.prototype.lineHeight=function(r,o){var s;return o==null&&(o=!1),s=o?this.lineGap:0,(this.ascender+s-this.decender)/1e3*r},i})();var mc,Vu=(function(){function i(r){this.data=r??[],this.pos=0,this.length=this.data.length}return i.prototype.readByte=function(){return this.data[this.pos++]},i.prototype.writeByte=function(r){return this.data[this.pos++]=r},i.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},i.prototype.writeUInt32=function(r){return this.writeByte(r>>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},i.prototype.readInt32=function(){var r;return(r=this.readUInt32())>=2147483648?r-4294967296:r},i.prototype.writeInt32=function(r){return r<0&&(r+=4294967296),this.writeUInt32(r)},i.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},i.prototype.writeUInt16=function(r){return this.writeByte(r>>8&255),this.writeByte(255&r)},i.prototype.readInt16=function(){var r;return(r=this.readUInt16())>=32768?r-65536:r},i.prototype.writeInt16=function(r){return r<0&&(r+=65536),this.writeUInt16(r)},i.prototype.readString=function(r){var o,s;for(s=[],o=0;0<=r?o<r:o>r;o=0<=r?++o:--o)s[o]=String.fromCharCode(this.readByte());return s.join("")},i.prototype.writeString=function(r){var o,s,c;for(c=[],o=0,s=r.length;0<=s?o<s:o>s;o=0<=s?++o:--o)c.push(this.writeByte(r.charCodeAt(o)));return c},i.prototype.readShort=function(){return this.readInt16()},i.prototype.writeShort=function(r){return this.writeInt16(r)},i.prototype.readLongLong=function(){var r,o,s,c,d,v,p,g;return r=this.readByte(),o=this.readByte(),s=this.readByte(),c=this.readByte(),d=this.readByte(),v=this.readByte(),p=this.readByte(),g=this.readByte(),128&r?-1*(72057594037927940*(255^r)+281474976710656*(255^o)+1099511627776*(255^s)+4294967296*(255^c)+16777216*(255^d)+65536*(255^v)+256*(255^p)+(255^g)+1):72057594037927940*r+281474976710656*o+1099511627776*s+4294967296*c+16777216*d+65536*v+256*p+g},i.prototype.writeLongLong=function(r){var o,s;return o=Math.floor(r/4294967296),s=4294967295&r,this.writeByte(o>>24&255),this.writeByte(o>>16&255),this.writeByte(o>>8&255),this.writeByte(255&o),this.writeByte(s>>24&255),this.writeByte(s>>16&255),this.writeByte(s>>8&255),this.writeByte(255&s)},i.prototype.readInt=function(){return this.readInt32()},i.prototype.writeInt=function(r){return this.writeInt32(r)},i.prototype.read=function(r){var o,s;for(o=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)o.push(this.readByte());return o},i.prototype.write=function(r){var o,s,c,d;for(d=[],s=0,c=r.length;s<c;s++)o=r[s],d.push(this.writeByte(o));return d},i})(),nv=(function(){var i;function r(o){var s,c,d;for(this.scalarType=o.readInt(),this.tableCount=o.readShort(),this.searchRange=o.readShort(),this.entrySelector=o.readShort(),this.rangeShift=o.readShort(),this.tables={},c=0,d=this.tableCount;0<=d?c<d:c>d;c=0<=d?++c:--c)s={tag:o.readString(4),checksum:o.readInt(),offset:o.readInt(),length:o.readInt()},this.tables[s.tag]=s}return r.prototype.encode=function(o){var s,c,d,v,p,g,m,S,_,E,T,K,D;for(D in T=Object.keys(o).length,g=Math.log(2),_=16*Math.floor(Math.log(T)/g),v=Math.floor(_/g),S=16*T-_,(c=new Vu).writeInt(this.scalarType),c.writeShort(T),c.writeShort(_),c.writeShort(v),c.writeShort(S),d=16*T,m=c.pos+d,p=null,K=[],o)for(E=o[D],c.writeString(D),c.writeInt(i(E)),c.writeInt(m),c.writeInt(E.length),K=K.concat(E),D==="head"&&(p=m),m+=E.length;m%4;)K.push(0),m++;return c.write(K),s=2981146554-i(c.data),c.pos=p+8,c.writeUInt32(s),c.data},i=function(o){var s,c,d,v;for(o=Ey.call(o);o.length%4;)o.push(0);for(d=new Vu(o),c=0,s=0,v=o.length;s<v;s=s+=4)c+=d.readUInt32();return 4294967295&c},r})(),iv={}.hasOwnProperty,Bc=function(i,r){for(var o in r)iv.call(r,o)&&(i[o]=r[o]);function s(){this.constructor=i}return s.prototype=r.prototype,i.prototype=new s,i.__super__=r.prototype,i};mc=(function(){function i(r){var o;this.file=r,o=this.file.directory.tables[this.tag],this.exists=!!o,o&&(this.offset=o.offset,this.length=o.length,this.parse(this.file.contents))}return i.prototype.parse=function(){},i.prototype.encode=function(){},i.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},i})();var rv=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Bc(i,mc),i.prototype.tag="head",i.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},i.prototype.encode=function(r){var o;return(o=new Vu).writeInt(this.version),o.writeInt(this.revision),o.writeInt(this.checkSumAdjustment),o.writeInt(this.magicNumber),o.writeShort(this.flags),o.writeShort(this.unitsPerEm),o.writeLongLong(this.created),o.writeLongLong(this.modified),o.writeShort(this.xMin),o.writeShort(this.yMin),o.writeShort(this.xMax),o.writeShort(this.yMax),o.writeShort(this.macStyle),o.writeShort(this.lowestRecPPEM),o.writeShort(this.fontDirectionHint),o.writeShort(r),o.writeShort(this.glyphDataFormat),o.data},i})(),Lx=(function(){function i(r,o){var s,c,d,v,p,g,m,S,_,E,T,K,D,ee,w,Se,$;switch(this.platformID=r.readUInt16(),this.encodingID=r.readShort(),this.offset=o+r.readInt(),_=r.pos,r.pos=this.offset,this.format=r.readUInt16(),this.length=r.readUInt16(),this.language=r.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(g=0;g<256;++g)this.codeMap[g]=r.readByte();break;case 4:for(T=r.readUInt16(),E=T/2,r.pos+=6,d=(function(){var H,ae;for(ae=[],g=H=0;0<=E?H<E:H>E;g=0<=E?++H:--H)ae.push(r.readUInt16());return ae})(),r.pos+=2,D=(function(){var H,ae;for(ae=[],g=H=0;0<=E?H<E:H>E;g=0<=E?++H:--H)ae.push(r.readUInt16());return ae})(),m=(function(){var H,ae;for(ae=[],g=H=0;0<=E?H<E:H>E;g=0<=E?++H:--H)ae.push(r.readUInt16());return ae})(),S=(function(){var H,ae;for(ae=[],g=H=0;0<=E?H<E:H>E;g=0<=E?++H:--H)ae.push(r.readUInt16());return ae})(),c=(this.length-r.pos+this.offset)/2,p=(function(){var H,ae;for(ae=[],g=H=0;0<=c?H<c:H>c;g=0<=c?++H:--H)ae.push(r.readUInt16());return ae})(),g=w=0,$=d.length;w<$;g=++w)for(ee=d[g],s=Se=K=D[g];K<=ee?Se<=ee:Se>=ee;s=K<=ee?++Se:--Se)S[g]===0?v=s+m[g]:(v=p[S[g]/2+(s-K)-(E-g)]||0)!==0&&(v+=m[g]),this.codeMap[s]=65535&v}r.pos=_}return i.encode=function(r,o){var s,c,d,v,p,g,m,S,_,E,T,K,D,ee,w,Se,$,H,ae,I,oe,pe,Y,X,F,R,U,O,_e,ce,xe,fe,ke,de,C,z,G,V,ie,he,re,Le,Re,Ue,et,ot;switch(O=new Vu,v=Object.keys(r).sort(function(Ct,Ot){return Ct-Ot}),o){case"macroman":for(D=0,ee=(function(){var Ct=[];for(K=0;K<256;++K)Ct.push(0);return Ct})(),Se={0:0},d={},_e=0,ke=v.length;_e<ke;_e++)Se[Re=r[c=v[_e]]]==null&&(Se[Re]=++D),d[c]={old:r[c],new:Se[r[c]]},ee[c]=Se[r[c]];return O.writeUInt16(1),O.writeUInt16(0),O.writeUInt32(12),O.writeUInt16(0),O.writeUInt16(262),O.writeUInt16(0),O.write(ee),{charMap:d,subtable:O.data,maxGlyphID:D+1};case"unicode":for(R=[],_=[],$=0,Se={},s={},w=m=null,ce=0,de=v.length;ce<de;ce++)Se[ae=r[c=v[ce]]]==null&&(Se[ae]=++$),s[c]={old:ae,new:Se[ae]},p=Se[ae]-c,w!=null&&p===m||(w&&_.push(w),R.push(c),m=p),w=c;for(w&&_.push(w),_.push(65535),R.push(65535),X=2*(Y=R.length),pe=2*Math.pow(Math.log(Y)/Math.LN2,2),E=Math.log(pe/2)/Math.LN2,oe=2*Y-pe,g=[],I=[],T=[],K=xe=0,C=R.length;xe<C;K=++xe){if(F=R[K],S=_[K],F===65535){g.push(0),I.push(0);break}if(F-(U=s[F].new)>=32768)for(g.push(0),I.push(2*(T.length+Y-K)),c=fe=F;F<=S?fe<=S:fe>=S;c=F<=S?++fe:--fe)T.push(s[c].new);else g.push(U-F),I.push(0)}for(O.writeUInt16(3),O.writeUInt16(1),O.writeUInt32(12),O.writeUInt16(4),O.writeUInt16(16+8*Y+2*T.length),O.writeUInt16(0),O.writeUInt16(X),O.writeUInt16(pe),O.writeUInt16(E),O.writeUInt16(oe),re=0,z=_.length;re<z;re++)c=_[re],O.writeUInt16(c);for(O.writeUInt16(0),Le=0,G=R.length;Le<G;Le++)c=R[Le],O.writeUInt16(c);for(Ue=0,V=g.length;Ue<V;Ue++)p=g[Ue],O.writeUInt16(p);for(et=0,ie=I.length;et<ie;et++)H=I[et],O.writeUInt16(H);for(ot=0,he=T.length;ot<he;ot++)D=T[ot],O.writeUInt16(D);return{charMap:s,subtable:O.data,maxGlyphID:$+1}}},i})(),By=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Bc(i,mc),i.prototype.tag="cmap",i.prototype.parse=function(r){var o,s,c;for(r.pos=this.offset,this.version=r.readUInt16(),c=r.readUInt16(),this.tables=[],this.unicode=null,s=0;0<=c?s<c:s>c;s=0<=c?++s:--s)o=new Lx(r,this.offset),this.tables.push(o),o.isUnicode&&this.unicode==null&&(this.unicode=o);return!0},i.encode=function(r,o){var s,c;return o==null&&(o="macroman"),s=Lx.encode(r,o),(c=new Vu).writeUInt16(0),c.writeUInt16(1),s.table=c.data.concat(s.subtable),s},i})(),av=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Bc(i,mc),i.prototype.tag="hhea",i.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},i})(),ov=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Bc(i,mc),i.prototype.tag="OS/2",i.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=(function(){var o,s;for(s=[],o=0;o<10;++o)s.push(r.readByte());return s})(),this.charRange=(function(){var o,s;for(s=[],o=0;o<4;++o)s.push(r.readInt());return s})(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=(function(){var o,s;for(s=[],o=0;o<2;o=++o)s.push(r.readInt());return s})(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},i})(),sv=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Bc(i,mc),i.prototype.tag="post",i.prototype.parse=function(r){var o,s,c;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:case 196608:break;case 131072:var d;for(s=r.readUInt16(),this.glyphNameIndex=[],d=0;0<=s?d<s:d>s;d=0<=s?++d:--d)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],c=[];r.pos<this.offset+this.length;)o=r.readByte(),c.push(this.names.push(r.readString(o)));return c;case 151552:return s=r.readUInt16(),this.offsets=r.read(s);case 262144:return this.map=(function(){var v,p,g;for(g=[],d=v=0,p=this.file.maxp.numGlyphs;0<=p?v<p:v>p;d=0<=p?++v:--v)g.push(r.readUInt32());return g}).call(this)}},i})(),lv=function(i,r){this.raw=i,this.length=i.length,this.platformID=r.platformID,this.encodingID=r.encodingID,this.languageID=r.languageID},cv=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Bc(i,mc),i.prototype.tag="name",i.prototype.parse=function(r){var o,s,c,d,v,p,g,m,S,_,E;for(r.pos=this.offset,r.readShort(),o=r.readShort(),p=r.readShort(),s=[],d=0;0<=o?d<o:d>o;d=0<=o?++d:--d)s.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+p+r.readShort()});for(g={},d=S=0,_=s.length;S<_;d=++S)c=s[d],r.pos=c.offset,m=r.readString(c.length),v=new lv(m,c),g[E=c.nameID]==null&&(g[E]=[]),g[c.nameID].push(v);this.strings=g,this.copyright=g[0],this.fontFamily=g[1],this.fontSubfamily=g[2],this.uniqueSubfamily=g[3],this.fontName=g[4],this.version=g[5];try{this.postscriptName=g[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=g[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=g[7],this.manufacturer=g[8],this.designer=g[9],this.description=g[10],this.vendorUrl=g[11],this.designerUrl=g[12],this.license=g[13],this.licenseUrl=g[14],this.preferredFamily=g[15],this.preferredSubfamily=g[17],this.compatibleFull=g[18],this.sampleText=g[19]},i})(),uv=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Bc(i,mc),i.prototype.tag="maxp",i.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},i})(),dv=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Bc(i,mc),i.prototype.tag="hmtx",i.prototype.parse=function(r){var o,s,c,d,v,p,g;for(r.pos=this.offset,this.metrics=[],o=0,p=this.file.hhea.numberOfMetrics;0<=p?o<p:o>p;o=0<=p?++o:--o)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(c=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var m,S;for(S=[],o=m=0;0<=c?m<c:m>c;o=0<=c?++m:--m)S.push(r.readInt16());return S})(),this.widths=(function(){var m,S,_,E;for(E=[],m=0,S=(_=this.metrics).length;m<S;m++)d=_[m],E.push(d.advance);return E}).call(this),s=this.widths[this.widths.length-1],g=[],o=v=0;0<=c?v<c:v>c;o=0<=c?++v:--v)g.push(this.widths.push(s));return g},i.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},i})(),Ey=[].slice,fv=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Bc(i,mc),i.prototype.tag="glyf",i.prototype.parse=function(){return this.cache={}},i.prototype.glyphFor=function(r){var o,s,c,d,v,p,g,m,S,_;return r in this.cache?this.cache[r]:(d=this.file.loca,o=this.file.contents,s=d.indexOf(r),(c=d.lengthOf(r))===0?this.cache[r]=null:(o.pos=this.offset+s,v=(p=new Vu(o.read(c))).readShort(),m=p.readShort(),_=p.readShort(),g=p.readShort(),S=p.readShort(),this.cache[r]=v===-1?new hv(p,m,_,g,S):new pv(p,v,m,_,g,S),this.cache[r]))},i.prototype.encode=function(r,o,s){var c,d,v,p,g;for(v=[],d=[],p=0,g=o.length;p<g;p++)c=r[o[p]],d.push(v.length),c&&(v=v.concat(c.encode(s)));return d.push(v.length),{table:v,offsets:d}},i})(),pv=(function(){function i(r,o,s,c,d,v){this.raw=r,this.numberOfContours=o,this.xMin=s,this.yMin=c,this.xMax=d,this.yMax=v,this.compound=!1}return i.prototype.encode=function(){return this.raw.data},i})(),hv=(function(){function i(r,o,s,c,d){var v,p;for(this.raw=r,this.xMin=o,this.yMin=s,this.xMax=c,this.yMax=d,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],v=this.raw;p=v.readShort(),this.glyphOffsets.push(v.pos),this.glyphIDs.push(v.readUInt16()),32&p;)v.pos+=1&p?4:2,128&p?v.pos+=8:64&p?v.pos+=4:8&p&&(v.pos+=2)}return i.prototype.encode=function(){var r,o,s;for(o=new Vu(Ey.call(this.raw.data)),r=0,s=this.glyphIDs.length;r<s;++r)o.pos=this.glyphOffsets[r];return o.data},i})(),gv=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Bc(i,mc),i.prototype.tag="loca",i.prototype.parse=function(r){var o,s;return r.pos=this.offset,o=this.file.head.indexToLocFormat,this.offsets=o===0?(function(){var c,d;for(d=[],s=0,c=this.length;s<c;s+=2)d.push(2*r.readUInt16());return d}).call(this):(function(){var c,d;for(d=[],s=0,c=this.length;s<c;s+=4)d.push(r.readUInt32());return d}).call(this)},i.prototype.indexOf=function(r){return this.offsets[r]},i.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},i.prototype.encode=function(r,o){for(var s=new Uint32Array(this.offsets.length),c=0,d=0,v=0;v<s.length;++v)if(s[v]=c,d<o.length&&o[d]==v){++d,s[v]=c;var p=this.offsets[v],g=this.offsets[v+1]-p;g>0&&(c+=g)}for(var m=new Array(4*s.length),S=0;S<s.length;++S)m[4*S+3]=255&s[S],m[4*S+2]=(65280&s[S])>>8,m[4*S+1]=(16711680&s[S])>>16,m[4*S]=(4278190080&s[S])>>24;return m},i})(),xv=(function(){function i(r){this.font=r,this.subset={},this.unicodes={},this.next=33}return i.prototype.generateCmap=function(){var r,o,s,c,d;for(o in c=this.font.cmap.tables[0].codeMap,r={},d=this.subset)s=d[o],r[o]=c[s];return r},i.prototype.glyphsFor=function(r){var o,s,c,d,v,p,g;for(c={},v=0,p=r.length;v<p;v++)c[d=r[v]]=this.font.glyf.glyphFor(d);for(d in o=[],c)(s=c[d])!=null&&s.compound&&o.push.apply(o,s.glyphIDs);if(o.length>0)for(d in g=this.glyphsFor(o))s=g[d],c[d]=s;return c},i.prototype.encode=function(r,o){var s,c,d,v,p,g,m,S,_,E,T,K,D,ee,w;for(c in s=By.encode(this.generateCmap(),"unicode"),v=this.glyphsFor(r),T={0:0},w=s.charMap)T[(g=w[c]).old]=g.new;for(K in E=s.maxGlyphID,v)K in T||(T[K]=E++);return S=(function(Se){var $,H;for($ in H={},Se)H[Se[$]]=$;return H})(T),_=Object.keys(S).sort(function(Se,$){return Se-$}),D=(function(){var Se,$,H;for(H=[],Se=0,$=_.length;Se<$;Se++)p=_[Se],H.push(S[p]);return H})(),d=this.font.glyf.encode(v,D,T),m=this.font.loca.encode(d.offsets,D),ee={cmap:this.font.cmap.raw(),glyf:d.table,loca:m,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(o)},this.font.os2.exists&&(ee["OS/2"]=this.font.os2.raw()),this.font.directory.encode(ee)},i})();En.API.PDFObject=(function(){var i;function r(){}return i=function(o,s){return(Array(s+1).join("0")+o).slice(-s)},r.convert=function(o){var s,c,d,v;if(Array.isArray(o))return"["+(function(){var p,g,m;for(m=[],p=0,g=o.length;p<g;p++)s=o[p],m.push(r.convert(s));return m})().join(" ")+"]";if(typeof o=="string")return"/"+o;if(o?.isString)return"("+o+")";if(o instanceof Date)return"(D:"+i(o.getUTCFullYear(),4)+i(o.getUTCMonth(),2)+i(o.getUTCDate(),2)+i(o.getUTCHours(),2)+i(o.getUTCMinutes(),2)+i(o.getUTCSeconds(),2)+"Z)";if({}.toString.call(o)==="[object Object]"){for(c in d=["<<"],o)v=o[c],d.push("/"+c+" "+r.convert(v));return d.push(">>"),d.join(`
`)}return""+o},r})();const zg=i=>{const r=Yg[i];return!r||!r.prefix||r.prefix.length<1?"?":r.prefix[0].substring(0,1).toUpperCase()},Vl=(i,r,o)=>({color:r,size:o}),Mx=(i,r,o)=>{},xa=(i,r,o,s)=>({color:o,size:s}),Kd=(i,r,o,s)=>{},yv=()=>{const i=new Map,r={top:"#0072B2",bottom:"#56B4E9"},o={top:18,bottom:18},s={top:"#FFFF00",bottom:"#FFFF00"},c={top:18,bottom:18},d={top:"#AA4499",bottom:"#F781BF"},v={top:6,bottom:6},p={top:"#6A3D9A",bottom:"#9467BD"},g={top:18,bottom:18};return i.set("select",{id:"select",name:"Select",toolType:"select",icon:"",shortcut:"S",tooltip:"Select objects or groups",colorReflective:!1,settings:Vl("select","#ff0000",10),layerSettings:new Map([["top",xa("select","top","#ff0000",10)],["bottom",xa("select","bottom","#ff0000",10)]])}),i.set("via",{id:"via",name:"Via",toolType:"draw",drawingMode:"via",icon:"",shortcut:"V",tooltip:"Place via connection",colorReflective:!0,settings:Vl("via",eg,ig.DEFAULT_SIZE),layerSettings:new Map([["top",xa("via","top",eg,ig.DEFAULT_SIZE)],["bottom",xa("via","bottom",eg,ig.DEFAULT_SIZE)]]),defaultLayer:"top"}),i.set("pad",{id:"pad",name:"Pad",toolType:"draw",drawingMode:"pad",icon:"",shortcut:"P",tooltip:"Place pad connection",colorReflective:!0,settings:Vl("pad",s2,18),layerSettings:new Map([["top",xa("pad","top",r.top,o.top)],["bottom",xa("pad","bottom",r.bottom,o.bottom)]]),defaultLayer:"top"}),i.set("testPoint",{id:"testPoint",name:"Test Point",toolType:"draw",drawingMode:"testPoint",icon:"",shortcut:"Y",tooltip:"Place test point",colorReflective:!0,settings:Vl("testPoint","#FFFF00",18),layerSettings:new Map([["top",xa("testPoint","top",s.top,c.top)],["bottom",xa("testPoint","bottom",s.bottom,c.bottom)]]),defaultLayer:"top"}),i.set("trace",{id:"trace",name:"Trace",toolType:"draw",drawingMode:"trace",icon:"",shortcut:"T",tooltip:"Draw copper traces",colorReflective:!0,settings:Vl("trace",a2,6),layerSettings:new Map([["top",xa("trace","top",d.top,v.top)],["bottom",xa("trace","bottom",d.bottom,v.bottom)]]),defaultLayer:"top"}),i.set("component",{id:"component",name:"Component",toolType:"component",icon:"",shortcut:"C",tooltip:"Place component",colorReflective:!0,settings:Vl("component",o2,$g.DEFAULT_SIZE),layerSettings:new Map([["top",xa("component","top",p.top,g.top)],["bottom",xa("component","bottom",p.bottom,g.bottom)]]),defaultLayer:"top"}),i.set("componentConnection",{id:"componentConnection",name:"Component Connections",toolType:"componentConnection",icon:"",shortcut:"",tooltip:"Component connection lines",colorReflective:!1,settings:Vl("componentConnection","#E69F00",3),layerSettings:new Map([["top",xa("componentConnection","top","#E69F00",3)],["bottom",xa("componentConnection","bottom","#E69F00",3)]])}),i.set("power",{id:"power",name:"Power",toolType:"power",icon:"",shortcut:"B",tooltip:"Place power node",colorReflective:!0,settings:Vl("power",ng,18),layerSettings:new Map([["top",xa("power","top",ng,18)],["bottom",xa("power","bottom",ng,18)]]),defaultLayer:"top"}),i.set("ground",{id:"ground",name:"Ground",toolType:"ground",icon:"",shortcut:"G",tooltip:"Place ground symbol",colorReflective:!0,settings:Vl("ground",tg,18),layerSettings:new Map([["top",xa("ground","top",tg,18)],["bottom",xa("ground","bottom",tg,18)]]),defaultLayer:"top"}),i.set("erase",{id:"erase",name:"Erase",toolType:"erase",icon:"",shortcut:"E",tooltip:"Erase objects",colorReflective:!1,settings:Vl("erase","#f5a3b3",18),layerSettings:new Map([["top",xa("erase","top","#f5a3b3",18)],["bottom",xa("erase","bottom","#f5a3b3",18)]])}),i.set("pan",{id:"pan",name:"Move",toolType:"pan",icon:"",shortcut:"H",tooltip:"Pan the view",colorReflective:!1,settings:Vl("pan","#ff0000",10),layerSettings:new Map([["top",xa("pan","top","#ff0000",10)],["bottom",xa("pan","bottom","#ff0000",10)]])}),i.set("magnify",{id:"magnify",name:"Zoom",toolType:"magnify",icon:"+",shortcut:"M",tooltip:"Magnify",colorReflective:!1,settings:Vl("magnify","#ff0000",10),layerSettings:new Map([["top",xa("magnify","top","#ff0000",10)],["bottom",xa("magnify","bottom","#ff0000",10)]])}),i},Ix={via:{color:"#2CA02C",size:18},padTop:{color:"#0072B2",size:18},padBottom:{color:"#56B4E9",size:18},testPointTop:{color:"#FFFF00",size:18},testPointBottom:{color:"#FFFF00",size:18},traceTop:{color:"#AA4499",size:6},traceBottom:{color:"#F781BF",size:6},componentTop:{color:"#6A3D9A",size:18},componentBottom:{color:"#9467BD",size:18},power:{color:"#ff0000",size:18},ground:{color:"#000000",size:18}},Vf={via:"Via",padTop:"Pad (Top)",padBottom:"Pad (Bottom)",testPointTop:"Test Point (Top)",testPointBottom:"Test Point (Bottom)",traceTop:"Trace (Top)",traceBottom:"Trace (Bottom)",componentTop:"Component (Top)",componentBottom:"Component (Bottom)",power:"Power",ground:"Ground"};class mv{instances=new Map;listeners=new Map;initialize(){for(const r of Object.keys(Ix)){const o=Ix[r];this.instances.set(r,{id:r,name:Vf[r],color:o.color,size:o.size}),this.listeners.set(r,new Set)}}initializeFromProject(r){if(this.initialize(),r?.toolInstances)for(const[o,s]of Object.entries(r.toolInstances))this.instances.has(o)&&this.instances.set(o,s)}get(r){const o=this.instances.get(r);if(!o)throw new Error(`Tool instance ${r} not found`);return o}getColor(r){const o=this.instances.get(r);if(!o)throw new Error(`Tool instance ${r} not found`);const s=Vf[r];return console.log(`${s}, returning color value=${o.color}`),o.color}getSize(r){const o=this.instances.get(r);if(!o)throw new Error(`Tool instance ${r} not found`);const s=Vf[r];return console.log(`${s}, returning size value=${o.size}`),o.size}setColor(r,o){const s=this.instances.get(r);if(s){const c=Vf[r];console.log(`${c}, setting color value=${o}`),s.color=o,this.notifyListeners(r)}}setSize(r,o){const s=this.instances.get(r);if(s){const c=Vf[r];console.log(`${c}, setting size value=${o}`),s.size=o,this.notifyListeners(r)}}getAll(){const r={};for(const[o,s]of this.instances.entries())r[o]=s;return r}subscribe(r,o){const s=this.listeners.get(r);return s?(s.add(o),()=>{s.delete(o)}):()=>{}}notifyListeners(r){const o=this.listeners.get(r);o&&o.forEach(s=>s())}}const Hn=new mv;Hn.initialize();function eh(i,r){switch(i){case"via":return"via";case"pad":return r==="bottom"?"padBottom":"padTop";case"testPoint":return r==="bottom"?"testPointBottom":"testPointTop";case"trace":return r==="bottom"?"traceBottom":"traceTop";case"component":return r==="bottom"?"componentBottom":"componentTop";case"power":return"power";case"ground":return"ground";default:throw new Error(`Unknown tool: ${i}`)}}const bv=({visible:i,toolRegistry:r,currentTool:o,drawingMode:s,traceToolLayer:c,padToolLayer:d,testPointToolLayer:v,componentToolLayer:p,updateToolSettings:g,updateToolLayerSettings:m,setBrushSize:S,saveToolSettings:_,saveToolLayerSettings:E,setTopTraceSize:T,setBottomTraceSize:K,setTopPadSize:D,setBottomPadSize:ee,setTopTestPointSize:w,setBottomTestPointSize:Se,setTopComponentSize:$,setBottomComponentSize:H,setComponentConnectionSize:ae,saveDefaultSize:I,onClose:oe})=>{const[pe,Y]=L.useState({}),X=[{id:"via",name:"Via",instanceId:"via"},{id:"pad",name:"Pad",layer:"top",instanceId:"padTop"},{id:"pad",name:"Pad",layer:"bottom",instanceId:"padBottom"},{id:"testPoint",name:"Test Point",layer:"top",instanceId:"testPointTop"},{id:"testPoint",name:"Test Point",layer:"bottom",instanceId:"testPointBottom"},{id:"trace",name:"Trace",layer:"top",instanceId:"traceTop"},{id:"trace",name:"Trace",layer:"bottom",instanceId:"traceBottom"},{id:"component",name:"Component",layer:"top",instanceId:"componentTop"},{id:"component",name:"Component",layer:"bottom",instanceId:"componentBottom"},{id:"componentConnection",name:"Component Connections"},{id:"power",name:"Power",instanceId:"power"},{id:"ground",name:"Ground",instanceId:"ground"},{id:"erase",name:"Erase"}];L.useEffect(()=>{if(i){const U={};for(const O of X){const _e=O.instanceId||O.id;if(O.instanceId)try{const ce=Hn.get(O.instanceId);U[_e]=ce.size}catch{const ce=r.get(O.id);ce&&(U[_e]=O.layer?ce.layerSettings.get(O.layer)?.size??ce.settings.size??10:ce.settings.size??10)}else{const ce=r.get(O.id);ce&&(U[_e]=ce.settings.size??10)}}Y(U)}},[i]);const F=L.useCallback((U,O,_e,ce)=>{if(!r.get(U)&&U!=="componentConnection")return;const fe=ce||U;Y(de=>({...de,[fe]:O})),["trace","pad","testPoint","component"].includes(U)&&_e&&ce?(Hn.setSize(ce,O),(U==="trace"&&o==="draw"&&s==="trace"||U==="pad"&&o==="draw"&&s==="pad"||U==="testPoint"&&o==="draw"&&s==="testPoint"||U==="component"&&o==="component")&&((U==="trace"?c:U==="pad"?d:U==="testPoint"?v:p)||"top")===_e&&S(O)):ce?(Hn.setSize(ce,O),(U==="via"&&o==="draw"&&s==="via"||U==="power"&&o==="power"||U==="ground"&&o==="ground")&&S(O)):(U==="componentConnection"&&(ae(O),I("componentConnection",O)),U==="erase"&&o==="erase"&&S(O))},[r,o,s,c,d,v,p,S,ae,I]);if(!i)return null;const R=Array.from({length:50},(U,O)=>O+1);return n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:U=>{U.target===U.currentTarget&&oe()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"16px",width:"fit-content",maxWidth:"400px",maxHeight:"85vh",overflowY:"auto",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:U=>U.stopPropagation(),children:[n.jsx("h3",{style:{margin:"0 0 12px 0",color:"#fff",fontSize:"16px",fontWeight:600},children:"Set Tool Size"}),n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:X.map((U,O)=>{if(!r.get(U.id)&&U.id!=="componentConnection")return null;const ce=U.layer?`${U.name} (${U.layer==="top"?"Top":"Bottom"})`:U.name,xe=U.instanceId||U.id,fe=pe[xe]??10;return n.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"6px 10px",background:"#1f1f24",borderRadius:4},children:[n.jsxs("label",{style:{color:"#f2f2f2",fontSize:"13px",width:"140px",flexShrink:0,marginRight:"8px"},children:[ce,":"]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[n.jsx("select",{value:fe,onChange:ke=>{const de=parseInt(ke.target.value,10);F(U.id,de,U.layer,U.instanceId)},style:{width:"50px",padding:"4px 6px",background:"#2b2b31",border:"1px solid #3a3a44",borderRadius:4,color:"#f2f2f2",fontSize:"12px",cursor:"pointer"},children:R.map(ke=>n.jsx("option",{value:ke,style:{background:"#2b2b31",color:"#f2f2f2"},children:ke},ke))}),n.jsx("span",{style:{color:"#f2f2f2",fontSize:"12px"},children:"px"})]})]},`${U.id}-${U.layer||"default"}-${O}`)})}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:n.jsx("button",{onClick:oe,style:{padding:"6px 12px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:600},children:"Close"})})]})})},vv=({visible:i,toolRegistry:r,currentTool:o,drawingMode:s,traceToolLayer:c,padToolLayer:d,testPointToolLayer:v,componentToolLayer:p,updateToolSettings:g,updateToolLayerSettings:m,saveToolSettings:S,saveToolLayerSettings:_,setBrushColor:E,setTopTraceColor:T,setBottomTraceColor:K,setTopPadColor:D,setBottomPadColor:ee,setTopTestPointColor:w,setBottomTestPointColor:Se,setTopComponentColor:$,setBottomComponentColor:H,setComponentConnectionColor:ae,saveDefaultColor:I,colorPalette:oe,onClose:pe})=>{const[Y,X]=Pt.useState(null),[F,R]=Pt.useState(0);if(Pt.useEffect(()=>{const xe=[];return[{id:"via"},{id:"pad",layer:"top"},{id:"pad",layer:"bottom"},{id:"testPoint",layer:"top"},{id:"testPoint",layer:"bottom"},{id:"trace",layer:"top"},{id:"trace",layer:"bottom"},{id:"component",layer:"top"},{id:"component",layer:"bottom"},{id:"power"},{id:"ground"}].forEach(({id:ke,layer:de})=>{try{const C=eh(ke,de),z=Hn.subscribe(C,()=>{R(G=>G+1)});xe.push(z)}catch{}}),()=>{xe.forEach(ke=>ke())}},[]),!i)return null;const U=["pad","testPoint","trace","component"],O=[{id:"via",name:"Via"},{id:"pad",name:"Pad",layer:"top"},{id:"pad",name:"Pad",layer:"bottom"},{id:"testPoint",name:"Test Point",layer:"top"},{id:"testPoint",name:"Test Point",layer:"bottom"},{id:"trace",name:"Trace",layer:"top"},{id:"trace",name:"Trace",layer:"bottom"},{id:"component",name:"Component",layer:"top"},{id:"component",name:"Component",layer:"bottom"},{id:"componentConnection",name:"Component Connections"},{id:"power",name:"Power"},{id:"ground",name:"Ground"},{id:"erase",name:"Erase"}],_e=(xe,fe,ke)=>{if(xe==="componentConnection"){ae(fe),I("componentConnection",fe),X(null);return}if(xe==="erase"){const de=r.get(xe);de&&(g(xe,{...de.settings,color:fe}),S(xe,fe,de.settings.size)),X(null);return}try{let de;ke&&U.includes(xe)?de=eh(xe,ke):de=eh(xe),Hn.setColor(de,fe),(xe==="via"&&o==="draw"&&s==="via"||xe==="trace"&&o==="draw"&&s==="trace"||xe==="pad"&&o==="draw"&&s==="pad"||xe==="testPoint"&&o==="draw"&&s==="testPoint"||xe==="component"&&o==="component"||xe==="power"&&o==="power"||xe==="ground"&&o==="ground")&&(ke&&U.includes(xe)?((xe==="trace"?c:xe==="pad"?d:xe==="testPoint"?v:p)||"top")===ke&&E(fe):E(fe))}catch(de){console.error(`Error updating color for tool ${xe}:`,de);const C=r.get(xe);C&&(ke&&U.includes(xe)?(m(xe,ke,{...C.layerSettings.get(ke),color:fe}),_(xe,ke,fe,C.layerSettings.get(ke)?.size||C.settings.size)):(g(xe,{...C.settings,color:fe}),S(xe,fe,C.settings.size)))}X(null)},ce=(xe,fe)=>{let ke;try{const z=eh(xe,fe);ke=Hn.get(z).color}catch{const z=r.get(xe);if(!z)return null;ke=z.settings.color??"#000000"}const de=fe?`${xe}-${fe}`:xe,C=Y?.toolId===xe&&Y?.layer===fe;return n.jsxs("div",{style:{position:"relative",display:"inline-block",zIndex:10005},children:[n.jsx("button",{className:"color-swatch-button",onClick:z=>{z.stopPropagation(),X(C?null:{toolId:xe,layer:fe})},style:{width:"40px",height:"24px",background:ke,backgroundColor:ke,backgroundImage:"none",border:"1px solid #3a3a44",borderRadius:3,cursor:"pointer",padding:0,margin:0,display:"block","--swatch-color":ke},title:ke},`${de}-button-${ke}-${F}`),C&&n.jsx("div",{onClick:z=>{z.stopPropagation()},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",padding:8,background:"#fff",border:"1px solid #ddd",borderRadius:6,boxShadow:"0 8px 18px rgba(0,0,0,0.18)",zIndex:100},children:n.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(8, 22px)",gap:4},children:oe.map(z=>n.jsx("div",{onClick:()=>_e(xe,z,fe),title:z,style:{width:22,height:22,backgroundColor:z,border:z===ke?"2px solid #333":"1px solid #ccc",cursor:"pointer"}},z))})})]},`${de}-${ke}-${F}`)};return n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:xe=>{xe.target===xe.currentTarget&&(pe(),X(null))},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"16px",width:"fit-content",minWidth:"450px",maxWidth:"600px",maxHeight:"85vh",overflowY:"auto",overflowX:"visible",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:xe=>xe.stopPropagation(),children:[n.jsx("h3",{style:{margin:"0 0 12px 0",color:"#fff",fontSize:"16px",fontWeight:600},children:"Set Tool Color"}),n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:O.map((xe,fe)=>{if(!r.get(xe.id))return null;const de=xe.layer?`${xe.name} (${xe.layer==="top"?"Top":"Bottom"})`:xe.name;return n.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"6px 10px",background:"#1f1f24",borderRadius:4},children:[n.jsxs("label",{style:{color:"#f2f2f2",fontSize:"13px",width:"140px",flexShrink:0,marginRight:"8px"},children:[de,":"]}),ce(xe.id,xe.layer)]},`${xe.id}-${xe.layer||"default"}-${fe}`)})}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:n.jsx("button",{onClick:()=>{pe(),X(null)},style:{padding:"6px 12px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:600},children:"Close"})})]})})},wv=({openMenu:i,setOpenMenu:r,isReadOnlyMode:o,currentProjectFilePath:s,isProjectActive:c,autoSaveEnabled:d,autoSaveInterval:v,hasUnsavedChangesState:p,onNewProject:g,onOpenProject:m,onSaveProject:S,onPrint:_,onExportBOM:E,hasUnsavedChanges:T,bomExportFormat:K,setBomExportFormat:D,setNewProjectDialog:ee,setAutoSaveDialog:w,onShowGeminiSettings:Se,topImage:$,bottomImage:H,setCurrentTool:ae,resetImageTransform:I,areImagesLocked:oe,setAreImagesLocked:pe,onEnterBoardDimensions:Y,fileInputTopRef:X,fileInputBottomRef:F,openProjectRef:R,increaseSize:U,decreaseSize:O,brushSize:_e,drawingStrokes:ce,selectedIds:xe,selectedComponentIds:fe,selectedPowerIds:ke,selectedGroundIds:de,componentsTop:C,componentsBottom:z,powers:G,grounds:V,powerNodeNames:ie,groundNodeNames:he,setSetSizeDialog:re,areViasLocked:Le,setAreViasLocked:Re,arePadsLocked:Ue,setArePadsLocked:et,areTestPointsLocked:ot,setAreTestPointsLocked:Ct,areTracesLocked:Ot,setAreTracesLocked:se,areComponentsLocked:kt,setAreComponentsLocked:Jt,areGroundNodesLocked:Wt,setAreGroundNodesLocked:ht,arePowerNodesLocked:Xe,setArePowerNodesLocked:Ut,showTraceCornerDots:an,setShowTraceCornerDots:Ht,setSelectedIds:Nn,setSelectedComponentIds:zn,setSelectedPowerIds:Ee,setSelectedGroundIds:Ne,selectAllVias:Mt,selectAllTraces:ct,selectAllPads:_t,selectAllComponents:Ze,selectDisconnectedComponents:jt,selectAllComponentConnections:en,selectAllPowerNodes:Qe,selectAllGroundNodes:At,selectPowerNodesByName:un,selectGroundNodesByName:xn,setShowPowerBusManager:Kt,setShowGroundBusManager:Qt,setShowPastMachine:hn,toolRegistry:Xn,updateToolSettings:rt,updateToolLayerSettings:ln,setBrushSize:Lt,setBrushColor:Zn,saveToolSettings:In,saveToolLayerSettings:wr,colorPalette:Zi,currentTool:Yt,drawingMode:jn,traceToolLayer:ci,padToolLayer:Et,testPointToolLayer:Bt,componentToolLayer:Zt,setTopTraceSize:on,setBottomTraceSize:Wn,setTopPadSize:qi,setBottomPadSize:Sr,setTopTestPointSize:yt,setBottomTestPointSize:si,setTopComponentSize:On,setBottomComponentSize:Ri,setComponentConnectionSize:Ei,topTraceColor:bo,bottomTraceColor:ya,topPadColor:Rr,bottomPadColor:Ys,topTestPointColor:Jo,bottomTestPointColor:Qo,topComponentColor:ol,bottomComponentColor:es,setTopTraceColor:jr,setBottomTraceColor:Gs,setTopPadColor:Jn,setBottomPadColor:ma,setTopTestPointColor:di,setBottomTestPointColor:As,setTopComponentColor:Di,setBottomComponentColor:zs,setComponentConnectionColor:ir,saveDefaultSize:Na,saveDefaultColor:vo,menuBarRef:Ha,onOpenProjectNotes:Ti,onOpenTransformImages:Oo,onOpenTransformAll:hs})=>{const[Tr,oo]=Pt.useState(null),vn=Pt.useRef(null),[wi,ui]=Pt.useState(null),Dr=Pt.useRef(null),[Xs,sl]=Pt.useState(!1),[dr,Aa]=Pt.useState(!1),Ps=Ft=>{if(!c){alert("Please create a new project (File  New Project) or open an existing project (File  Open Project) before using this feature."),r(null);return}const br=Ft();br instanceof Promise&&br.catch(za=>{const Fo=za instanceof Error?za.message:String(za);console.error("Error in requireProject action:",za),alert(`An error occurred:

${Fo}

See console for details.`)})},wo=Ft=>{const br=Ft==="power"?ie:he,za=br.length>0,Fo=Ft==="power"?"Select Power Nodes":"Select Ground Nodes";return n.jsxs("div",{onMouseEnter:()=>{vn.current&&(clearTimeout(vn.current),vn.current=null),oo(Ft)},onMouseLeave:()=>{vn.current=window.setTimeout(()=>{oo(rr=>rr===Ft?null:rr)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[n.jsxs("div",{style:{padding:"4px 10px",fontSize:12,color:"#bbb"},children:[Fo," by Name"]}),n.jsxs("button",{onClick:()=>{Ft==="power"?Qe():At(),oo(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:["All ",Ft==="power"?"Power Nodes":"Ground Nodes"]}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),za?br.map(rr=>n.jsx("button",{onClick:()=>{Ft==="power"?un(rr):xn(rr),oo(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:rr},rr)):n.jsxs("div",{style:{padding:"4px 10px",fontSize:12,color:"#bbb"},children:["No ",Ft==="power"?"power":"ground"," nodes available."]})]})},Ks=()=>n.jsxs("div",{onMouseEnter:()=>{Dr.current&&(clearTimeout(Dr.current),Dr.current=null),ui("lock")},onMouseLeave:()=>{Dr.current=window.setTimeout(()=>{ui(Ft=>Ft==="lock"?null:Ft)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[n.jsxs("label",{onClick:Ft=>{Ft.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[n.jsx("input",{type:"checkbox",checked:Le,onChange:()=>{Re(Ft=>!Ft)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),n.jsx("span",{children:"Lock Vias"})]}),n.jsxs("label",{onClick:Ft=>{Ft.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[n.jsx("input",{type:"checkbox",checked:Ue,onChange:()=>{et(Ft=>!Ft)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),n.jsx("span",{children:"Lock Pads"})]}),n.jsxs("label",{onClick:Ft=>{Ft.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[n.jsx("input",{type:"checkbox",checked:ot,onChange:()=>{Ct(Ft=>!Ft)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),n.jsx("span",{children:"Lock Test Points"})]}),n.jsxs("label",{onClick:Ft=>{Ft.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[n.jsx("input",{type:"checkbox",checked:Ot,onChange:()=>{se(Ft=>!Ft)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),n.jsx("span",{children:"Lock Traces"})]}),n.jsxs("label",{onClick:Ft=>{Ft.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[n.jsx("input",{type:"checkbox",checked:kt,onChange:()=>{Jt(Ft=>!Ft)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),n.jsx("span",{children:"Lock Components"})]}),n.jsxs("label",{onClick:Ft=>{Ft.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[n.jsx("input",{type:"checkbox",checked:Wt,onChange:()=>{ht(Ft=>!Ft)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),n.jsx("span",{children:"Lock Ground Node"})]}),n.jsxs("label",{onClick:Ft=>{Ft.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[n.jsx("input",{type:"checkbox",checked:Xe,onChange:()=>{Ut(Ft=>!Ft)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),n.jsx("span",{children:"Lock Power Nodes"})]})]}),So=()=>n.jsxs("div",{onMouseEnter:()=>{Dr.current&&(clearTimeout(Dr.current),Dr.current=null),ui("select")},onMouseLeave:()=>{Dr.current=window.setTimeout(()=>{ui(Ft=>Ft==="select"?null:Ft)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[n.jsx("button",{onClick:()=>{Mt(),ui(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Vias"}),n.jsx("button",{onClick:()=>{ct(),ui(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Traces"}),n.jsx("button",{onClick:()=>{_t(),ui(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Pads"}),n.jsx("button",{onClick:()=>{const Ft=new Set(ce.filter(br=>br.type==="testPoint").map(br=>br.id));Nn(Ft),zn(new Set),Ee(new Set),Ne(new Set),ui(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Test Points"}),n.jsx("button",{onClick:()=>{Ze(),ui(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Components"}),n.jsx("button",{onClick:()=>{en(),ui(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Component Connections"}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onMouseEnter:()=>{vn.current&&(clearTimeout(vn.current),vn.current=null),oo("power")},onMouseLeave:()=>{vn.current=window.setTimeout(()=>{oo(Ft=>Ft==="power"?null:Ft)},200)},onClick:()=>{oo(Ft=>Ft==="power"?null:"power")},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Power Nodes "}),Tr==="power"&&wo("power")]}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onMouseEnter:()=>{vn.current&&(clearTimeout(vn.current),vn.current=null),oo("ground")},onMouseLeave:()=>{vn.current=window.setTimeout(()=>{oo(Ft=>Ft==="ground"?null:Ft)},200)},onClick:()=>{oo(Ft=>Ft==="ground"?null:"ground")},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Ground Nodes "}),Tr==="ground"&&wo("ground")]}),n.jsx("button",{onClick:()=>{jt(),ui(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Disconnected Components"})]});return n.jsxs(n.Fragment,{children:[n.jsxs("div",{ref:Ha,style:{position:"relative",background:"rgba(250,250,255,0.9)",borderBottom:"1px solid #e6e6ef",padding:"6px 12px",display:"flex",gap:16,alignItems:"center",zIndex:3},children:[n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onClick:Ft=>{Ft.stopPropagation(),r(br=>br==="file"?null:"file")},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:i==="file"?"#eef3ff":"#fff",fontWeight:600,color:"#222"},children:"File "}),i==="file"&&n.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:200,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[n.jsx("button",{onClick:()=>{o||(r(null),T()?ee({visible:!0}):g())},disabled:o,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o?"not-allowed":"pointer"},children:"New Project"}),n.jsx("button",{onClick:async()=>{await m(),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Open Project"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{o||Ps(()=>{S(),r(null)})},disabled:o||!c,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o||!c?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o||!c?"not-allowed":"pointer"},children:"Save Project"}),n.jsx("button",{onClick:()=>{o||Ps(()=>{w({visible:!0,interval:5}),r(null)})},disabled:o||!c,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o||!c?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o||!c?"not-allowed":"pointer"},children:"Auto Save"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{hn(!0),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Restore from History"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{Se(),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"AI Settings"}),n.jsx("button",{onClick:async()=>{if(!o){if(!c){alert("Please create a new project (File  New Project) or open an existing project (File  Open Project) before using this feature."),r(null);return}try{await E(),r(null)}catch(Ft){console.error("Error exporting BOM:",Ft)}}},disabled:o||!c,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o||!c?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o||!c?"not-allowed":"pointer"},children:"Export BOM"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{Ps(()=>{_(),r(null)})},disabled:!c,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:c?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:c?"pointer":"not-allowed"},children:"Print"}),n.jsx("button",{onClick:()=>{Ps(()=>{_(),r(null)})},disabled:!c,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:c?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:c?"pointer":"not-allowed"},children:"Printer Settings"})]})]}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onClick:Ft=>{o||(Ft.stopPropagation(),r(br=>br==="transform"?null:"transform"))},disabled:o,style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:i==="transform"?"#eef3ff":"#fff",fontWeight:600,color:o?"#999":"#222",cursor:o?"not-allowed":"pointer",opacity:o?.5:1},children:"Images "}),i==="transform"&&n.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:260,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[n.jsx("button",{onClick:()=>{!o&&!oe&&c&&(X.current?.click(),r(null))},disabled:o||oe||!c,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o||oe||!c?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o||oe||!c?"not-allowed":"pointer"},children:"Load Top PCB"}),n.jsx("button",{onClick:()=>{!o&&!oe&&c&&(F.current?.click(),r(null))},disabled:o||oe||!c,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o||oe||!c?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o||oe||!c?"not-allowed":"pointer"},children:"Load Bottom PCB"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{!oe&&c&&(Y(),r(null))},disabled:oe||!c,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:oe||!c?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:oe||!c?"not-allowed":"pointer"},children:"Enter PCB Dimensions"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{c&&(Oo(),r(null))},disabled:!$&&!H||oe||!c,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:!$&&!H||oe||!c?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:!$&&!H||oe||!c?"not-allowed":"pointer"},children:"Transform Images"}),n.jsx("button",{onClick:()=>{!oe&&c&&(ae("transform"),I(),r(null))},disabled:oe||!$&&!H||!c,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:oe||!$&&!H||!c?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:oe||!$&&!H||!c?"not-allowed":"pointer"},children:"Reset Transform"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{c&&(pe(Ft=>!Ft),r(null))},disabled:!c,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:c?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:c?"pointer":"not-allowed"},children:oe?"Unlock Images ":"Lock Images"})]})]}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onClick:Ft=>{o||(Ft.stopPropagation(),r(br=>br==="tools"?null:"tools"))},disabled:o,style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:i==="tools"?"#eef3ff":"#fff",fontWeight:600,color:o?"#999":"#222",cursor:o?"not-allowed":"pointer",opacity:o?.5:1},children:"Tools "}),i==="tools"&&n.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[n.jsx("button",{onClick:()=>{c&&(hs(),r(null))},disabled:!c,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:c?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:c?"pointer":"not-allowed"},children:"Change Perspective"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:Ft=>{c&&(U(Ft.shiftKey?5:1),r(null))},disabled:!c,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:c?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:c?"pointer":"not-allowed"},children:"Increase Size (+)"}),n.jsx("button",{onClick:Ft=>{c&&(O(Ft.shiftKey?5:1),r(null))},disabled:!c,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:c?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:c?"pointer":"not-allowed"},children:"Decrease Size (-)"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onMouseEnter:()=>{c&&Dr.current&&(clearTimeout(Dr.current),Dr.current=null),c&&ui("lock")},onMouseLeave:()=>{c&&(Dr.current=window.setTimeout(()=>{ui(Ft=>Ft==="lock"?null:Ft)},200))},onClick:()=>{c&&ui(Ft=>Ft==="lock"?null:"lock")},disabled:!c,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:c?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:c?"pointer":"not-allowed"},children:"Lock "}),wi==="lock"&&c&&Ks()]}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onMouseEnter:()=>{c&&Dr.current&&(clearTimeout(Dr.current),Dr.current=null),c&&ui("select")},onMouseLeave:()=>{c&&(Dr.current=window.setTimeout(()=>{ui(Ft=>Ft==="select"?null:Ft)},200))},onClick:()=>{c&&ui(Ft=>Ft==="select"?null:"select")},disabled:!c,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:c?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:c?"pointer":"not-allowed"},children:"Select "}),wi==="select"&&c&&So()]}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{c&&(Ti(),r(null))},disabled:!c,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:c?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:c?"pointer":"not-allowed"},children:"Open Project Notes"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{c&&(sl(!0),r(null))},disabled:!c,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:c?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:c?"pointer":"not-allowed"},children:"Set Tool Sizes"}),n.jsx("button",{onClick:()=>{c&&(Aa(!0),r(null))},disabled:!c,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:c?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:c?"pointer":"not-allowed"},children:"Set Tool Colors"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{c&&(Kt(!0),r(null))},disabled:!c,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:c?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:c?"pointer":"not-allowed"},children:"Manage Power Buses"}),n.jsx("button",{onClick:()=>{c&&(Qt(!0),r(null))},disabled:!c,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:c?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:c?"pointer":"not-allowed"},children:"Manage Ground Buses"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsxs("button",{onClick:()=>{c&&(Ht(!an),r(null))},disabled:!c,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:c?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:c?"pointer":"not-allowed"},children:[an?" ":"   ","Show Trace Corner Dots"]})]})]}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onClick:Ft=>{Ft.stopPropagation(),r(br=>br==="about"?null:"about")},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:i==="about"?"#eef3ff":"#fff",fontWeight:600,color:"#222"},children:"About "}),i==="about"&&n.jsx("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:500,maxWidth:700,maxHeight:"80vh",background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:20,overflowY:"auto",zIndex:100},children:n.jsxs("div",{style:{marginBottom:16},children:[n.jsx("h2",{style:{margin:"0 0 16px 0",color:"#f2f2f2",fontSize:"20px",fontWeight:700},children:"PCB Tracer"}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"About"}),n.jsx("p",{style:{margin:"0 0 12px 0",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:"A specialized tool useful for both reverse engineering and troubleshooting electronics by tracing and documenting circuit connections from PCB images. This application supports typical 2 to 4 layer PCBs and enables comprehensive PCB analysis and documentation."}),n.jsx("p",{style:{margin:"0 0 12px 0",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:"This tool can assist in troubleshooting by tracing circuits, holding contextual notes, comparing test results, and documenting findings during the debugging process."})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Technologies"}),n.jsxs("p",{style:{margin:"0 0 12px 0",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:["Built with ",n.jsx("strong",{children:"TypeScript"})," and ",n.jsx("strong",{children:"React"}),", with ",n.jsx("strong",{children:"Gemini AI"})," integration for intelligent pin name extraction from datasheets. The application runs entirely client-side in the browser, providing a responsive, interactive drawing experience with no backend server requirements."]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Features"}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Via/Pad Placement"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[n.jsxs("li",{children:["Alt/Option+click the Via or Pad tool, or press ",n.jsx("code",{children:"Alt/Option+V"})," or ",n.jsx("code",{children:"Alt/Option+P"})," to open the placement dialog"]}),n.jsx("li",{children:"Place multiple vias or pads in Linear, 2-Sided, or 4-Sided arrangements"}),n.jsx("li",{children:"Automatic counter-clockwise numbering starting from Pin 1"}),n.jsx("li",{children:"Supports chip orientations of 0, 90, 180, or 270"}),n.jsx("li",{children:"Click and drag to define the placement area"}),n.jsx("li",{children:"Tool automatically returns to Select tool after placement"})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Tools & Shortcuts"}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px 16px",fontSize:"13px",color:"#f2f2f2"},children:[n.jsx("div",{children:n.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Select"}),"  ",n.jsx("code",{children:"S"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Via"}),"  ",n.jsx("code",{children:"V"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Pad"}),"  ",n.jsx("code",{children:"P"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Test Point"}),"  ",n.jsx("code",{children:"Y"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Trace"}),"  ",n.jsx("code",{children:"T"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Component"}),"  ",n.jsx("code",{children:"C"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Component Properties"}),"  double-click component"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Resize Icons"}),"  ",n.jsx("code",{children:"+"})," / ",n.jsx("code",{children:"-"})," (",n.jsx("code",{children:"Shift"})," + ",n.jsx("code",{children:"+"})," / ",n.jsx("code",{children:"-"})," = 5x faster)"]})]})}),n.jsx("div",{children:n.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Power"}),"  ",n.jsx("code",{children:"B"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Ground"}),"  ",n.jsx("code",{children:"G"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Move (Pan)"}),"  ",n.jsx("code",{children:"H"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Magnify"}),"  ",n.jsx("code",{children:"M"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Set View"}),"  ",n.jsx("code",{children:"X"})," then ",n.jsx("code",{children:"0-9"})," to save view"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Recall View"}),"  ",n.jsx("code",{children:"0-9"})," to recall saved view"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Default View 0"}),"  ",n.jsx("code",{children:"0"})," to recall default view (origin with all images contained)"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Information Dialog"}),"  ",n.jsx("code",{children:"I"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Notes Dialog"}),"  ",n.jsx("code",{children:"N"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Project Notes / TODO"}),"  ",n.jsx("code",{children:"L"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Undo"}),"  ",n.jsx("code",{children:"Ctrl"})," + ",n.jsx("code",{children:"Z"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Copy Component"}),"  ",n.jsx("code",{children:"Ctrl"})," + ",n.jsx("code",{children:"C"})," / ",n.jsx("code",{children:"Cmd"})," + ",n.jsx("code",{children:"C"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Paste Component"}),"  ",n.jsx("code",{children:"Ctrl"})," + ",n.jsx("code",{children:"V"})," / ",n.jsx("code",{children:"Cmd"})," + ",n.jsx("code",{children:"V"})]})]})})]}),n.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#f2f2f2"},children:[n.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#f2f2f2"},children:"Arrow Keys"}),n.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Move Selected Components"}),"  Arrow keys to nudge selected components (1 unit per press, ",n.jsx("code",{children:"Shift"})," = 10 units)"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Switch Perspective"}),"  ",n.jsx("code",{children:"Shift"})," + ",n.jsx("code",{children:""})," / ",n.jsx("code",{children:""})," or ",n.jsx("code",{children:"Caps Lock"})," + ",n.jsx("code",{children:""})," / ",n.jsx("code",{children:""})," to switch between top/bottom view"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Rotate Perspective"}),"  ",n.jsx("code",{children:"Shift"})," + ",n.jsx("code",{children:""})," / ",n.jsx("code",{children:""})," or ",n.jsx("code",{children:"Caps Lock"})," + ",n.jsx("code",{children:""})," / ",n.jsx("code",{children:""})," to rotate in 90 increments (",n.jsx("code",{children:""})," = counter-clockwise, ",n.jsx("code",{children:""})," = clockwise)"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Image Transformations"}),"  Arrow keys for scaling, rotating, and adjusting image transformations (when image is selected for transform)"]}),n.jsx("li",{children:"Click a slider first, then use arrow keys for precise adjustment"})]})]})]}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px 20px"},children:[n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Image Management"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Load top and bottom PCB images"}),n.jsx("li",{children:"Image alignment and transformation"}),n.jsx("li",{children:"Transform modes: nudge, scale, rotate, slant, keystone"}),n.jsx("li",{children:"Horizontal and vertical flip controls"}),n.jsx("li",{children:"Brightness and contrast controls"}),n.jsx("li",{children:"Grayscale mode"}),n.jsx("li",{children:"Automated transparency slider"}),n.jsx("li",{children:"Board dimensions configuration"})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Drawing Tools"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Draw copper traces (top and bottom layers)"}),n.jsx("li",{children:"Place vias for layer connections"}),n.jsx("li",{children:"Place component pads (SMD and through-hole)"}),n.jsx("li",{children:"Place test points for circuit testing"}),n.jsx("li",{children:"Place and annotate components"}),n.jsx("li",{children:"Place power and ground nodes"}),n.jsx("li",{children:"Erase tool for removing elements"})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Layer Management"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"14 independent layers to manage PCB element types"}),n.jsx("li",{children:"Separate top and bottom layer support"}),n.jsx("li",{children:"Layer-specific color customization"}),n.jsx("li",{children:"Layer-specific size controls"}),n.jsx("li",{children:"Layer visibility toggles"}),n.jsx("li",{children:"Overlay view mode"})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Component Management"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Component placement with pin counts"}),n.jsx("li",{children:"Pin connection tracking"}),n.jsx("li",{children:"Component type classification"}),n.jsx("li",{children:"Designator and value annotation"}),n.jsx("li",{children:"Component editor dialog"}),n.jsx("li",{children:"Find and center component"})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Selection & Locking"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Select individual elements or groups"}),n.jsx("li",{children:"Select all vias, traces, pads, or components"}),n.jsx("li",{children:"Select power/ground nodes by name"}),n.jsx("li",{children:"Select disconnected components"}),n.jsx("li",{children:"Lock/unlock elements by type"}),n.jsx("li",{children:"Image locking for protection"})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Power & Ground"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Multiple voltage power nodes"}),n.jsx("li",{children:"Power bus management"}),n.jsx("li",{children:"Ground node placement"}),n.jsx("li",{children:"Ground bus management"}),n.jsx("li",{children:"Node naming and organization"})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Customization"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Customizable colors per layer"}),n.jsx("li",{children:"Adjustable brush/tool sizes"}),n.jsx("li",{children:"Size presets for common tools"}),n.jsx("li",{children:"Color palette management"}),n.jsx("li",{children:"Tool settings persistence"})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Project Management"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Create, open, and save projects"}),n.jsx("li",{children:"Auto-save with configurable intervals"}),n.jsx("li",{children:"File history automatically saved in history subdirectory when Auto Save is enabled"}),n.jsx("li",{children:"Project Notes / TODO list with spreadsheet-like editing"}),n.jsx("li",{children:"Project file format (JSON)"}),n.jsx("li",{children:"Print functionality"}),n.jsx("li",{children:"Export to KiCad schematic format (future feature, not yet implemented)"})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"View Controls"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Zoom in/out with mouse wheel"}),n.jsx("li",{children:"Pan view with hand tool"}),n.jsx("li",{children:"Zoom to fit"}),n.jsx("li",{children:"View mode switching (top/bottom/overlay)"}),n.jsx("li",{children:"Save up to 10 view locations (X + 0-9)"}),n.jsx("li",{children:"Recall saved views instantly (0-9 keys)"}),n.jsxs("li",{children:["Default View 0: Press ",n.jsx("code",{children:"0"})," to recall the default view showing the origin with all loaded images fully contained within the canvas"]}),n.jsx("li",{children:"Change Perspective (Tools menu) - switch between top/bottom view and rotate all elements"}),n.jsx("li",{children:"Detailed information dialog"})]})]})]})]}),n.jsx("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #444"},children:n.jsxs("p",{style:{margin:"0 0 8px 0",color:"#bbb",fontSize:"12px",lineHeight:"1.5"},children:["Use the ",n.jsx("strong",{children:"File"})," menu to manage projects, the ",n.jsx("strong",{children:"Images"})," menu for image loading and transformation, and the ",n.jsx("strong",{children:"Tools"})," menu for selection, locking, and customization options."]})}),n.jsxs("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #444"},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Future / TODO List"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"A searchable list of common components"}),n.jsx("li",{children:"Output schematics (perhaps as KiCad files)"}),n.jsx("li",{children:"Dynamic layers"}),n.jsx("li",{children:"Create a desktop version of this application using Electron"})]})]})]})})]}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onClick:Ft=>{Ft.stopPropagation(),r(br=>br==="help"?null:"help")},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:i==="help"?"#eef3ff":"#fff",fontWeight:600,color:"#222"},children:"Help "}),i==="help"&&n.jsx("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:500,maxWidth:700,maxHeight:"80vh",background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:20,overflowY:"auto",zIndex:100},children:n.jsxs("div",{style:{marginBottom:16},children:[n.jsx("h2",{style:{margin:"0 0 16px 0",color:"#f2f2f2",fontSize:"20px",fontWeight:700},children:"Help: Typical Usage Steps"}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 1: Create or Open a Project"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"New Project:"})," File  New Project. Choose a project name and location."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Open Project:"})," File  Open Project. Select an existing project file (.json)."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Auto-Save:"})," File  Auto Save  Enable to automatically save your work at regular intervals."]})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 2: Load PCB Images"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Load Top Image:"})," Images  Load Top Image. Select your top-side PCB photo (.png or .jpeg)."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Load Bottom Image:"})," Images  Load Bottom Image. Select your bottom-side PCB photo."]}),n.jsxs("li",{children:["Images are automatically copied to the ",n.jsx("code",{style:{background:"#1f1f24",padding:"2px 4px",borderRadius:3,color:"#fff"},children:"images/"})," subdirectory."]})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 3: Align and Transform Images"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Enter Transform Mode:"})," Images  Transform Images. Select which image (Top or Bottom) to transform."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Transform Operations:"})," Use Move, Nudge, Scale, Rotate, Slant, or Keystone to align images."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Image Adjustments:"})," Adjust brightness, contrast, sharpness, and grayscale as needed."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Flip Images:"})," Use horizontal or vertical flip if your images are mirrored."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Arrow Keys:"})," When transform tool is active, use arrow keys for precise image adjustments."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Move Components:"})," Select components, then use arrow keys to move them (1 unit per press, ",n.jsx("code",{children:"Shift"})," = 10 units for larger steps)."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Change Perspective:"})," Tools  Change Perspective (or press ",n.jsx("code",{children:"E"}),") to switch between top/bottom view or rotate all elements (images, components, traces) together by 90, 180, or 270."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Quick Perspective Switch:"})," Press ",n.jsx("code",{children:"Shift"})," + ",n.jsx("code",{children:""})," / ",n.jsx("code",{children:""})," or ",n.jsx("code",{children:"Caps Lock"})," + ",n.jsx("code",{children:""})," / ",n.jsx("code",{children:""})," to quickly switch between top/bottom view."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Quick Perspective Rotation:"})," Press ",n.jsx("code",{children:"Shift"})," + ",n.jsx("code",{children:""})," / ",n.jsx("code",{children:""})," or ",n.jsx("code",{children:"Caps Lock"})," + ",n.jsx("code",{children:""})," / ",n.jsx("code",{children:""})," to rotate perspective in 90 increments (",n.jsx("code",{children:""})," = counter-clockwise, ",n.jsx("code",{children:""})," = clockwise)."]})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 4: Set Board Dimensions"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Enter Dimensions:"})," Images  Enter Board Dimensions. Specify the actual physical dimensions of your PCB."]}),n.jsx("li",{children:"This helps ensure accurate measurements and scaling for your reverse engineering work."})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 5: Trace Connections"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Place Vias:"})," Click the Via tool (",n.jsx("code",{children:"V"}),") and click on the PCB where vias connect layers."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Place Pads:"})," Click the Pad tool (",n.jsx("code",{children:"P"}),") and mark component pad locations."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Place Multiple Vias/Pads:"})," Alt/Option+click the Via or Pad tool, or press ",n.jsx("code",{children:"Alt/Option+V"})," (vias) or ",n.jsx("code",{children:"Alt/Option+P"})," (pads) to open the placement dialog. Choose arrangement (Linear, 2-Sided, or 4-Sided), number of pins, orientation, and layer. Click and drag on the canvas to define the placement area. Vias/pads are automatically arranged in counter-clockwise order starting from Pin 1."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Place Test Points:"})," Click the Test Point tool (",n.jsx("code",{children:"Y"}),") to mark test points."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Draw Traces:"})," Click the Trace tool (",n.jsx("code",{children:"T"}),"), select Top or Bottom layer, then click to start a trace. Click again to add segments. Press ",n.jsx("code",{children:"Enter"})," or click outside to finish."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Snapping:"})," Traces automatically snap to nearby vias, pads, power nodes, and ground nodes."]})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 6: Place Components"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Place Component:"})," Click the Component tool (",n.jsx("code",{children:"C"}),"), select component type, then click on the PCB."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Edit Component:"})," Double-click a component or select a component and press ",n.jsx("code",{children:"A"})," to open the Component Properties dialog. If multiple components are selected, opens the most recently selected one."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Set Properties:"})," Enter designator (e.g., R1, C2), value, and other component details."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Connect Pins:"})," Click on pads or vias to connect component pins to the circuit."]})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 7: Add Power and Ground Nodes"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Manage Power Buses:"})," Tools  Manage Power Buses to create and configure voltage buses (e.g., +5V, +3.3V)."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Place Power Nodes:"})," Click the Power tool (",n.jsx("code",{children:"B"}),"), select a voltage bus, then click on the PCB."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Manage Ground Buses:"})," Tools  Manage Ground Buses to configure ground connections."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Place Ground Nodes:"})," Click the Ground tool (",n.jsx("code",{children:"G"}),"), select a ground bus, then click on the PCB."]})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 8: Add Notes and Documentation"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Element Notes:"})," Press ",n.jsx("code",{children:"N"})," to open the Notes dialog for selected elements (vias, pads, traces, etc.)."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Project Notes:"})," Press ",n.jsx("code",{children:"L"})," to open Project Notes / TODO list for general project documentation."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Information Dialog:"})," Press ",n.jsx("code",{children:"I"})," to see detailed information about selected elements."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Find Elements:"})," Use the Find button in the Information dialog to center and highlight specific elements."]})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 9: Save Your Work"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Manual Save:"})," File  Save Project to save your work manually."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Auto-Save:"})," If enabled, your project is automatically saved at regular intervals."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"History:"})," Auto-saved versions are stored in the ",n.jsx("code",{style:{background:"#1f1f24",padding:"2px 4px",borderRadius:3,color:"#fff"},children:"history/"})," subdirectory."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Restore from History:"})," File  Restore from History to access previous versions."]})]})]}),n.jsxs("div",{style:{marginBottom:20,paddingTop:16,borderTop:"1px solid #444"},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Keyboard Shortcuts"}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px 16px",fontSize:"13px",color:"#f2f2f2"},children:[n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#f2f2f2"},children:"Drawing Tools"}),n.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Select"}),"  ",n.jsx("code",{children:"S"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Via"}),"  ",n.jsx("code",{children:"V"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Via Pattern"}),"  ",n.jsx("code",{children:"Alt/Option+V"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Pad"}),"  ",n.jsx("code",{children:"P"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Pad Pattern"}),"  ",n.jsx("code",{children:"Alt/Option+P"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Test Point"}),"  ",n.jsx("code",{children:"Y"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Trace"}),"  ",n.jsx("code",{children:"T"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Component"}),"  ",n.jsx("code",{children:"C"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Component Properties"}),"  ",n.jsx("code",{children:"A"})," (opens dialog for selected component)"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Power"}),"  ",n.jsx("code",{children:"B"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Ground"}),"  ",n.jsx("code",{children:"G"})]})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#f2f2f2"},children:"View & Navigation"}),n.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Move (Pan)"}),"  ",n.jsx("code",{children:"H"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Magnify"}),"  ",n.jsx("code",{children:"M"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Set View"}),"  ",n.jsx("code",{children:"X"})," then ",n.jsx("code",{children:"0-9"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Recall View"}),"  ",n.jsx("code",{children:"0-9"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Default View 0"}),"  ",n.jsx("code",{children:"0"})," (origin with all images contained)"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Default View 0"}),"  ",n.jsx("code",{children:"0"})," (origin with all images contained)"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Information"}),"  ",n.jsx("code",{children:"I"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Notes"}),"  ",n.jsx("code",{children:"N"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Project Notes"}),"  ",n.jsx("code",{children:"L"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Undo"}),"  ",n.jsx("code",{children:"Ctrl+Z"})," / ",n.jsx("code",{children:"Cmd+Z"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Copy Component"}),"  ",n.jsx("code",{children:"Ctrl+C"})," / ",n.jsx("code",{children:"Cmd+C"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Paste Component"}),"  ",n.jsx("code",{children:"Ctrl+V"})," / ",n.jsx("code",{children:"Cmd+V"})]})]})]})]}),n.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#f2f2f2"},children:[n.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#f2f2f2"},children:"Arrow Keys"}),n.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Move Selected Components"}),"  Arrow keys to nudge selected components (1 unit per press, ",n.jsx("code",{children:"Shift"})," = 10 units)"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Switch Perspective"}),"  ",n.jsx("code",{children:"Shift"})," + ",n.jsx("code",{children:""})," / ",n.jsx("code",{children:""})," or ",n.jsx("code",{children:"Caps Lock"})," + ",n.jsx("code",{children:""})," / ",n.jsx("code",{children:""})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Rotate Perspective"}),"  ",n.jsx("code",{children:"Shift"})," + ",n.jsx("code",{children:""})," / ",n.jsx("code",{children:""})," or ",n.jsx("code",{children:"Caps Lock"})," + ",n.jsx("code",{children:""})," / ",n.jsx("code",{children:""})," (",n.jsx("code",{children:""})," = counter-clockwise, ",n.jsx("code",{children:""})," = clockwise)"]}),n.jsx("li",{children:"Use arrow keys to adjust image transformations (when transform tool is active)"}),n.jsx("li",{children:"Click a slider first, then use arrow keys for precise adjustment"})]})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Tips & Tricks"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Double-click any slider to reset it to the default value"}),n.jsx("li",{children:"Double-click a component to edit its properties"}),n.jsxs("li",{children:["Hold ",n.jsx("code",{children:"Shift"})," while clicking to add to selection"]}),n.jsxs("li",{children:["Use the Information dialog (",n.jsx("code",{children:"I"}),") to see details about selected elements"]}),n.jsx("li",{children:"Lock layers (Tools  Lock) to prevent accidental modifications"}),n.jsx("li",{children:"Use the Find button in the Information dialog to center elements in view"}),n.jsxs("li",{children:["Save views with ",n.jsx("code",{children:"X"})," + number key for quick navigation"]}),n.jsxs("li",{children:["Use ",n.jsx("code",{children:"+"})," and ",n.jsx("code",{children:"-"})," keys to resize tool icons (",n.jsx("code",{children:"Shift"})," + ",n.jsx("code",{children:"+"})," / ",n.jsx("code",{children:"-"})," changes size 5 times faster)"]})]})]}),n.jsx("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #444"},children:n.jsxs("p",{style:{margin:"0 0 8px 0",color:"#bbb",fontSize:"12px",lineHeight:"1.5"},children:["For more detailed feature information, see the ",n.jsx("strong",{children:"About"})," menu."]})})]})})]}),s&&n.jsxs("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:"8px",paddingLeft:"16px"},children:[n.jsx("div",{style:{fontSize:"12px",color:"#333",fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"40vw"},title:s,children:s}),n.jsx("div",{style:{width:"16px",height:"16px",borderRadius:"50%",border:"1px solid #666",backgroundColor:p?d?"#ffaa00":"#ff0000":"#00ff00",flexShrink:0},title:p?d?`Changes detected  Auto Save: ON  Will be saved automatically every ${v||1} minute${v===1?"":"s"}`:"Changes detected  Auto Save: OFF  You need to save manually (File  Save Project)":"Project saved  No unsaved changes  Auto Save: "+(d?"ON":"OFF")})]})]}),n.jsx(bv,{visible:Xs,toolRegistry:Xn,currentTool:Yt,drawingMode:jn,traceToolLayer:ci,padToolLayer:Et,testPointToolLayer:Bt,componentToolLayer:Zt,updateToolSettings:rt,updateToolLayerSettings:ln,setBrushSize:Lt,saveToolSettings:In,saveToolLayerSettings:wr,setTopTraceSize:on,setBottomTraceSize:Wn,setTopPadSize:qi,setBottomPadSize:Sr,setTopTestPointSize:yt,setBottomTestPointSize:si,setTopComponentSize:On,setBottomComponentSize:Ri,setComponentConnectionSize:Ei,saveDefaultSize:Na,onClose:()=>sl(!1)}),n.jsx(vv,{visible:dr,toolRegistry:Xn,currentTool:Yt,drawingMode:jn,traceToolLayer:ci,padToolLayer:Et,testPointToolLayer:Bt,componentToolLayer:Zt,updateToolSettings:rt,updateToolLayerSettings:ln,saveToolSettings:In,saveToolLayerSettings:wr,setBrushColor:Zn,setTopTraceColor:jr,setBottomTraceColor:Gs,setTopPadColor:Jn,setBottomPadColor:ma,setTopTestPointColor:di,setBottomTestPointColor:As,setTopComponentColor:Di,setBottomComponentColor:zs,setComponentConnectionColor:ir,saveDefaultColor:vo,colorPalette:Zi,onClose:()=>Aa(!1)})]})},Sv=({visible:i,canvasSize:r={width:960,height:600},canvasPosition:o={left:244,top:6},onDismiss:s})=>{const c=L.useRef(null),d=L.useRef(null),[v,p]=L.useState(!0),g=L.useCallback(()=>{c.current&&(c.current.pause(),c.current.src="",c.current.load()),p(!1),s&&s()},[s]);return L.useEffect(()=>{i&&p(!0)},[i]),L.useEffect(()=>{if(!i)return;const m=()=>{g()};return document.addEventListener("click",m,{once:!0}),document.addEventListener("mousedown",m,{once:!0}),()=>{document.removeEventListener("click",m),document.removeEventListener("mousedown",m)}},[i,g]),L.useEffect(()=>{i&&v&&c.current?c.current.play().catch(m=>{console.warn("Video autoplay failed:",m)}):(!i||!v)&&c.current&&c.current&&(c.current.pause(),c.current.src="",c.current.load())},[i,v]),i?n.jsxs("div",{ref:d,style:{position:"absolute",left:0,top:0,right:0,bottom:0,pointerEvents:"none",zIndex:10},children:[v&&n.jsx("video",{ref:c,src:"/PCB_Reverse_Engineering_Tool/SplashLoop.mp4",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,style:{position:"absolute",left:`${o.left}px`,top:`${o.top}px`,width:`${r.width}px`,height:`${r.height}px`,objectFit:"cover",pointerEvents:"none",zIndex:1}}),n.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",padding:"24px 32px",background:"rgba(255, 255, 255, 0.85)",borderRadius:8,border:"2px solid #4CAF50",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",maxWidth:"500px",pointerEvents:"auto",zIndex:2},children:[n.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"#000",marginBottom:"12px"},children:"PCB Tracer: An Electronics Tool"}),n.jsxs("div",{style:{fontSize:"16px",fontWeight:600,color:"#000",marginBottom:"16px",lineHeight:"1.5"},children:["Reverse Engineer, Troubleshoot, Repair, Signal Trace,",n.jsx("br",{}),"Document Test Results"]}),n.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"8px",lineHeight:"1.5",textAlign:"left"},children:"1) Use the File menu to start a new project."}),n.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"8px",lineHeight:"1.5",textAlign:"left"},children:"2) Use the Images menu to load images."}),n.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"12px",lineHeight:"1.5",textAlign:"left"},children:"3) Use the tools to draw vias, traces, components, etc."}),n.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"16px",textAlign:"center",fontStyle:"italic",fontWeight:"bold"},children:"Best viewed in browser's full screen mode."})]})]}):null},jv="https://pcbtracer-staging-bd8cca44225e.herokuapp.com",Bx="09dfbac34888e5197e1ef8a0f77d4fcd7401de3caf09bcc263ff0de709983f867d946c7424aafa7fda5ea8c2b59d56db80519c407e7e6c2ffb8e4b88e7ed76f4",Ex={SIGNUP_OTP:"/auth/signUpOrContinueWithOTP",LOGIN:"/auth/login"},th={TOKEN:"/api/token",GET_USER:"/api/getUser",DELETE_USER:"/api/deleteUser",GET_CUSTOMER:"/api/getCustomer"},Tv={CHECK:"/health/check"},Zd={API_KEY:"X-Starter-Tools-Secret",AUTHORIZATION:"Authorization",CONTENT_TYPE:"Content-Type"},du={ACCESS_TOKEN:"pcbtracer_access_token",REFRESH_TOKEN:"pcbtracer_refresh_token",USER:"pcbtracer_user"},cd=i=>`${jv}${i}`;class tf{static instance=null;isRefreshing=!1;refreshPromise=null;constructor(){}static getInstance(){return tf.instance||(tf.instance=new tf),tf.instance}getAccessToken(){return localStorage.getItem(du.ACCESS_TOKEN)}getRefreshToken(){return localStorage.getItem(du.REFRESH_TOKEN)}getStoredUser(){const r=localStorage.getItem(du.USER);if(r)try{return JSON.parse(r)}catch{return null}return null}setAccessToken(r){localStorage.setItem(du.ACCESS_TOKEN,r)}setRefreshToken(r){localStorage.setItem(du.REFRESH_TOKEN,r)}setUser(r){localStorage.setItem(du.USER,JSON.stringify(r))}clearAuth(){localStorage.removeItem(du.ACCESS_TOKEN),localStorage.removeItem(du.REFRESH_TOKEN),localStorage.removeItem(du.USER)}isLoggedIn(){return this.getRefreshToken()!==null}buildHeaders(r=!1,o=!1){const s={[Zd.CONTENT_TYPE]:"application/json",[Zd.API_KEY]:Bx};if(r){const c=o?this.getRefreshToken():this.getAccessToken();c&&(s[Zd.AUTHORIZATION]=c)}return s}async authenticatedRequest(r,o,s=!0){const c=this.buildHeaders(!0),d=await fetch(r,{...o,headers:{...c,...o.headers}});if(d.status===403&&s){if(await this.refreshAccessToken())return this.authenticatedRequest(r,o,!1);throw new Error("Session expired. Please log in again.")}if(!d.ok){const p=await d.json().catch(()=>({errorMessage:"Request failed"}));throw new Error(p.errorMessage||`Request failed with status ${d.status}`)}const v=await d.text();return v?JSON.parse(v):{}}async refreshAccessToken(){if(this.isRefreshing&&this.refreshPromise)return this.refreshPromise;const r=this.getRefreshToken();if(!r)return!1;this.isRefreshing=!0,this.refreshPromise=this.doRefreshToken(r);try{return await this.refreshPromise}finally{this.isRefreshing=!1,this.refreshPromise=null}}async doRefreshToken(r){try{const o=await fetch(cd(th.TOKEN),{method:"POST",headers:{[Zd.CONTENT_TYPE]:"application/json",[Zd.API_KEY]:Bx,[Zd.AUTHORIZATION]:r}});if(!o.ok)return this.clearAuth(),!1;const s=await o.json();return this.setAccessToken(s.accessToken),!0}catch(o){return console.error("Token refresh failed:",o),this.clearAuth(),!1}}async signUpWithOTP(r){const o=await fetch(cd(Ex.SIGNUP_OTP),{method:"POST",headers:this.buildHeaders(!1),body:JSON.stringify({email:r})});if(!o.ok){let s="Failed to send verification code";try{const c=await o.text();if(c)try{s=JSON.parse(c).errorMessage||s}catch{c.includes("Internal Server Error")?s="Server error. Please try with a valid email address.":s=c}}catch{}throw new Error(s)}}async loginWithOTP(r){const o=await fetch(cd(Ex.LOGIN),{method:"POST",headers:this.buildHeaders(!1),body:JSON.stringify({otp:r})});if(!o.ok){const c=await o.json().catch(()=>({errorMessage:"Invalid or expired OTP"}));throw new Error(c.errorMessage||"Invalid or expired OTP")}const s=await o.json();return this.setAccessToken(s.accessToken),this.setRefreshToken(s.refreshToken),this.setUser(s.user),s}logout(){this.clearAuth()}async getUser(){return this.authenticatedRequest(cd(th.GET_USER),{method:"GET"})}async deleteUser(){const r=await this.authenticatedRequest(cd(th.DELETE_USER),{method:"POST"});return this.clearAuth(),r}async getCustomer(){return this.authenticatedRequest(cd(th.GET_CUSTOMER),{method:"GET"})}async healthCheck(){try{return(await fetch(cd(Tv.CHECK),{method:"GET"})).ok}catch{return!1}}}const sf=()=>tf.getInstance(),Cv=({onAuthSuccess:i})=>{const[r,o]=L.useState("email"),[s,c]=L.useState(""),[d,v]=L.useState(""),[p,g]=L.useState(null),[m,S]=L.useState(!1),[_,E]=L.useState(null),T=L.useRef(null),K=L.useRef(null);L.useEffect(()=>{r==="email"&&T.current?T.current.focus():r==="otp"&&K.current&&K.current.focus()},[r]);const D=L.useCallback(async $=>{$.preventDefault(),g(null),E(null);const H=s.trim().toLowerCase();if(!H){g("Please enter your email address");return}if(!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(H)){g("Please enter a valid email address");return}S(!0);try{await sf().signUpWithOTP(H),E("Check your email for the verification code"),o("otp")}catch(I){g(I instanceof Error?I.message:"Failed to send verification code")}finally{S(!1)}},[s]),ee=L.useCallback(async $=>{$.preventDefault(),g(null),E(null);const H=d.trim();if(!H){g("Please enter the verification code");return}if(!/^\d{6}$/.test(H)){g("Please enter a valid 6-digit code");return}S(!0);try{const I=await sf().loginWithOTP(H);i(I.user)}catch(ae){g(ae instanceof Error?ae.message:"Invalid or expired code")}finally{S(!1)}},[d,i]),w=L.useCallback(()=>{o("email"),v(""),g(null),E(null)},[]),Se=L.useCallback(async()=>{g(null),E(null),S(!0);try{await sf().signUpWithOTP(s.trim().toLowerCase()),E("New verification code sent to your email")}catch($){g($ instanceof Error?$.message:"Failed to resend code")}finally{S(!1)}},[s]);return n.jsxs("div",{style:$r.container,children:[n.jsx("div",{style:$r.background}),n.jsxs("div",{style:$r.card,children:[n.jsxs("div",{style:$r.header,children:[n.jsx("h1",{style:$r.title,children:"PCB Tracer"}),n.jsx("p",{style:$r.subtitle,children:"Reverse Engineer, Troubleshoot, Repair"})]}),_&&n.jsx("div",{style:$r.successMessage,children:_}),p&&n.jsx("div",{style:$r.errorMessage,children:p}),r==="email"&&n.jsxs("form",{onSubmit:D,style:$r.form,children:[n.jsxs("div",{style:$r.inputGroup,children:[n.jsx("label",{style:$r.label,children:"Email Address"}),n.jsx("input",{ref:T,type:"email",value:s,onChange:$=>c($.target.value),placeholder:"you@example.com",style:$r.input,disabled:m,autoComplete:"email"})]}),n.jsx("button",{type:"submit",style:{...$r.button,...m?$r.buttonDisabled:{}},disabled:m,children:m?"Sending...":"Continue with Email"}),n.jsx("p",{style:$r.helpText,children:"We'll send a verification code to your email"})]}),r==="otp"&&n.jsxs("form",{onSubmit:ee,style:$r.form,children:[n.jsxs("div",{style:$r.inputGroup,children:[n.jsx("label",{style:$r.label,children:"Verification Code"}),n.jsx("input",{ref:K,type:"text",value:d,onChange:$=>{const H=$.target.value.replace(/\D/g,"").slice(0,6);v(H)},placeholder:"123456",style:$r.otpInput,disabled:m,autoComplete:"one-time-code",inputMode:"numeric",maxLength:6})]}),n.jsx("button",{type:"submit",style:{...$r.button,...m?$r.buttonDisabled:{}},disabled:m,children:m?"Verifying...":"Verify & Sign In"}),n.jsxs("div",{style:$r.linkRow,children:[n.jsx("button",{type:"button",onClick:w,style:$r.linkButton,disabled:m,children:" Change email"}),n.jsx("button",{type:"button",onClick:Se,style:$r.linkButton,disabled:m,children:"Resend code"})]}),n.jsxs("p",{style:$r.helpText,children:["Enter the 6-digit code sent to ",n.jsx("strong",{children:s})]})]})]}),n.jsx("div",{style:$r.footer,children:n.jsx("p",{style:$r.footerText,children:"By continuing, you agree to PCB Tracer's Terms of Service"})})]})},$r={container:{position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:9999},background:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",zIndex:-1},card:{background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",borderRadius:"16px",padding:"40px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)",border:"2px solid #4CAF50",maxWidth:"420px",width:"90%",textAlign:"center"},header:{marginBottom:"32px"},title:{fontSize:"28px",fontWeight:700,color:"#333",margin:"0 0 8px 0",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},subtitle:{fontSize:"14px",color:"#666",margin:0},form:{display:"flex",flexDirection:"column",gap:"16px"},inputGroup:{textAlign:"left"},label:{display:"block",fontSize:"14px",fontWeight:600,color:"#333",marginBottom:"8px"},input:{width:"100%",padding:"14px 16px",fontSize:"16px",border:"2px solid #e0e0e0",borderRadius:"8px",outline:"none",transition:"border-color 0.2s ease",boxSizing:"border-box",color:"#333",backgroundColor:"#fff"},otpInput:{width:"100%",padding:"14px 16px",fontSize:"24px",fontWeight:600,letterSpacing:"8px",textAlign:"center",border:"2px solid #e0e0e0",borderRadius:"8px",outline:"none",transition:"border-color 0.2s ease",boxSizing:"border-box",color:"#333",backgroundColor:"#fff"},button:{width:"100%",padding:"14px 24px",fontSize:"16px",fontWeight:600,color:"#fff",background:"linear-gradient(135deg, #4CAF50 0%, #45a049 100%)",border:"none",borderRadius:"8px",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 4px 12px rgba(76, 175, 80, 0.3)"},buttonDisabled:{opacity:.6,cursor:"not-allowed",transform:"none"},linkRow:{display:"flex",justifyContent:"space-between",marginTop:"8px"},linkButton:{background:"none",border:"none",color:"#667eea",fontSize:"14px",cursor:"pointer",padding:"4px 8px",textDecoration:"underline",transition:"color 0.2s ease"},helpText:{fontSize:"13px",color:"#888",margin:"8px 0 0 0",lineHeight:1.5},successMessage:{background:"rgba(76, 175, 80, 0.1)",border:"1px solid #4CAF50",borderRadius:"8px",padding:"12px 16px",marginBottom:"16px",color:"#2e7d32",fontSize:"14px"},errorMessage:{background:"rgba(244, 67, 54, 0.1)",border:"1px solid #f44336",borderRadius:"8px",padding:"12px 16px",marginBottom:"16px",color:"#c62828",fontSize:"14px"},footer:{marginTop:"24px"},footerText:{fontSize:"12px",color:"rgba(255, 255, 255, 0.7)",margin:0}},Oy=({visible:i,title:r,message:o,onClose:s})=>i?n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:c=>{c.target===c.currentTarget&&s()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"2px solid #ff4444"},onClick:c=>c.stopPropagation(),children:[n.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",gap:"12px"},children:[n.jsx("div",{style:{fontSize:"24px",color:"#ff4444"},children:""}),n.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:r})]}),n.jsx("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"14px",lineHeight:"1.5"},children:o}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:n.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"OK"})})]})}):null,kv=({visible:i,selectedIds:r,selectedComponentIds:o,selectedPowerIds:s,selectedGroundIds:c,drawingStrokes:d,componentsTop:v,componentsBottom:p,powers:g,grounds:m,powerBuses:S,onClose:_,setComponentsTop:E,setComponentsBottom:T,determineViaType:K,determinePadType:D,determineTestPointType:ee,onFindComponent:w,onFindStroke:Se,onFindPower:$,onFindGround:H,position:ae,isDragging:I,onDragStart:oe,onOpenNotesDialog:pe})=>{const[Y,X]=L.useState({visible:!1,title:"",message:""}),[F,R]=L.useState(()=>{const de=localStorage.getItem("detailedInfoDialogSize");if(de)try{return JSON.parse(de)}catch{return{width:400,height:window.innerHeight*.8}}return{width:400,height:window.innerHeight*.8}}),[U,O]=L.useState(!1),[_e,ce]=L.useState({x:0,y:0,width:0,height:0});L.useEffect(()=>{if(!U)return;const de=z=>{const G=z.clientX-_e.x,V=z.clientY-_e.y,ie=Math.max(300,Math.min(window.innerWidth-20,_e.width+G)),he=Math.max(200,Math.min(window.innerHeight-20,_e.height+V)),re={width:ie,height:he};R(re),localStorage.setItem("detailedInfoDialogSize",JSON.stringify(re))},C=()=>{O(!1)};return document.addEventListener("mousemove",de),document.addEventListener("mouseup",C),()=>{document.removeEventListener("mousemove",de),document.removeEventListener("mouseup",C)}},[U,_e]);const xe=de=>{de.preventDefault(),de.stopPropagation(),O(!0),ce({x:de.clientX,y:de.clientY,width:F.width,height:F.height})};if(!i)return null;const fe=ae?{position:"fixed",left:`${ae.x}px`,top:`${ae.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"300px",width:`${F.width}px`,height:`${F.height}px`,maxHeight:`${window.innerHeight-20}px`,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:I?"grabbing":"default"}:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"flex-start",justifyContent:"flex-end",paddingRight:"20px",paddingTop:"80px",zIndex:1e4,pointerEvents:"none"},ke={padding:"20px",overflow:"auto",flex:1};return n.jsxs("div",{style:fe,children:[n.jsxs("div",{style:{position:"relative",width:"100%",height:"100%",display:"flex",flexDirection:"column",...ae?{}:{backgroundColor:"#fff",borderRadius:8,minWidth:"300px",width:`${F.width}px`,height:`${F.height}px`,maxHeight:`${window.innerHeight-20}px`,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",pointerEvents:"auto"}},children:[n.jsxs("div",{onMouseDown:de=>{const C=de.target;C.tagName==="BUTTON"||C.closest("button")||ae&&oe(de)},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:I?"grabbing":ae?"grab":"default",userSelect:"none",flexShrink:0},children:[n.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Information (I)"}),n.jsx("button",{onClick:_,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),n.jsx("div",{style:ke,children:n.jsxs("div",{style:{margin:0,padding:0,backgroundColor:"#f5f5f5",borderRadius:4,fontSize:"12px",fontFamily:"monospace",maxHeight:"calc(80vh - 100px)",overflow:"auto",color:"#000"},children:[(()=>{const de=d.filter(ie=>r.has(ie.id)).length,C=[...v,...p].filter(ie=>o.has(ie.id)).length,z=g.filter(ie=>s.has(ie.id)).length,G=m.filter(ie=>c.has(ie.id)).length,V=de+C+z+G;return n.jsx("div",{style:{padding:"12px 16px",backgroundColor:V>0?"#e8e8e8":"#fff3cd",borderBottom:"2px solid #ccc",fontSize:"13px",fontWeight:600,color:V>0?"#333":"#856404",marginBottom:"8px"},children:V>0?`${V} Object${V!==1?"s":""} Selected`:"Zero Objects Selected"})})(),o.size>0&&(()=>{const de=d.some(C=>r.has(C.id)&&(C.type==="via"||C.type==="pad"));return[...v,...p].filter(C=>o.has(C.id)).map(C=>{const z=Cl(C),G=z?.fields,V=G&&G.length>0?n.jsx("div",{style:{marginTop:"6px",marginBottom:"6px",padding:"4px 0"},children:G.map(ie=>{const he=C[ie.name];if(he==null||he==="")return null;const re=C[`${ie.name}Unit`],Le=typeof he=="boolean"?he?"Yes":"No":he;return n.jsxs("div",{style:{fontSize:"11px",color:"#444",marginBottom:"2px"},children:[ie.label,": ",Le,re?` ${re}`:""]},ie.name)})}):n.jsx("div",{style:{padding:"6px 0",fontSize:"11px",color:"#856404",background:"#fff3cd",border:"1px solid #ffeeba",borderRadius:4,marginTop:"6px",marginBottom:"6px"},children:"Component definition missing for this instance. Please ensure componentDefinitions.json entry and componentDefinitionKey are set."});return n.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",flexDirection:"column",gap:"4px",padding:"8px 12px",minHeight:"32px"},children:[n.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Category:"}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:z?.category||"N/A"})]})}),n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:z?.displayName?C.componentType==="Capacitor"&&!z.displayName.toLowerCase().includes("capacitor")?`${z.displayName} Capacitor`:z.displayName:C.componentType==="GenericComponent"&&C.genericType?kl(C.genericType):C.componentType==="Diode"&&C.diodeType&&C.diodeType!=="Standard"?kl(C.diodeType):C.componentType==="VariableResistor"&&C.vrType&&C.vrType!=="Potentiometer"?kl(C.vrType):C.componentType==="Capacitor"&&C.dielectric==="Tantalum"?"Tantalum Capacitor":C.componentType==="Capacitor"&&C.capacitorType==="Electrolytic"?"Electrolytic Capacitor":C.componentType==="Capacitor"&&C.capacitorType==="Film"?"Film Capacitor":kl(C.componentType)})]}),w&&n.jsx("button",{onClick:()=>{w(C.id,C.x,C.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:ie=>{ie.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:ie=>{ie.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]})]}),n.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[V,n.jsxs("div",{children:["Layer: ",C.layer]}),C.componentType==="IntegratedCircuit"&&n.jsxs(n.Fragment,{children:[C.description&&n.jsxs("div",{children:["Description: ",C.description]}),C.icType&&n.jsxs("div",{children:["IC Type: ",C.icType]})]}),n.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),n.jsx("input",{type:"text",value:C.notes||"",readOnly:!0,onClick:pe,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[n.jsxs("span",{children:["Designator: ",C.designator||"(empty)"]}),de&&n.jsx("button",{onClick:()=>{const ie=[...v,...p].filter(se=>o.has(se.id)&&se.componentType===C.componentType),he=ie.length,re=d.filter(se=>r.has(se.id)&&se.type==="pad"&&se.points.length>0&&se.points[0].id!==void 0).map(se=>{const kt=se.points[0].id;if(kt===void 0)throw new Error("Unexpected undefined id");return{stroke:se,nodeId:kt}}).sort((se,kt)=>se.nodeId-kt.nodeId),Le=re.length>0?re:d.filter(se=>r.has(se.id)&&se.type==="via"&&se.points.length>0&&se.points[0].id!==void 0).map(se=>{const kt=se.points[0].id;if(kt===void 0)throw new Error("Unexpected undefined id");return{stroke:se,nodeId:kt}}).sort((se,kt)=>se.nodeId-kt.nodeId),Re=Le.length;if(Re===0){console.warn("No vias or pads with Node IDs found in selection");return}const Ue=Math.floor(Re/he);if(Ue===0){console.warn(`Not enough ${re.length>0?"pads":"vias"} (${Re}) for ${he} components`);return}const et=Cl(ie[0]);if(et?.fixedPinCount!==!1){const se=ie[0]?.pinCount??et?.defaultPins??Ue;if(ie.every(Jt=>(Jt.pinCount??et?.defaultPins)===se)||console.warn("Selected components have different pin counts"),Ue!==se){const Jt=re.length>0?"pads":"vias";console.warn(`Cannot change pin count for ${C.componentType}. Expected ${se} ${Jt} per component, but got ${Ue}. This component has a fixed pin count.`),X({visible:!0,title:"Cannot Connect Components",message:`${C.componentType} has a fixed pin count of ${se}. Please select exactly ${se*he} ${Jt} (${se} per component).`});return}}[...ie].sort((se,kt)=>se.id.localeCompare(kt.id)).forEach((se,kt)=>{const Jt=kt*Ue,Wt=Jt+Ue,Xe=Le.slice(Jt,Wt).map(an=>an.nodeId.toString()),Ut=Dg(se,Xe,d);se.layer==="top"?E(an=>an.map(Ht=>{if(Ht.id===se.id){const Nn={...Ht,pinCount:Ue,pinConnections:Xe};if(Ut&&(Nn.pinPolarities=Ut),Ht.pinNames){const zn=Ht.pinNames||[];Nn.pinNames=new Array(Ue).fill("").map((Ee,Ne)=>Ne<zn.length?zn[Ne]:"")}return Nn}return Ht})):T(an=>an.map(Ht=>{if(Ht.id===se.id){const Nn={...Ht,pinCount:Ue,pinConnections:Xe};if(Ut&&(Nn.pinPolarities=Ut),Ht.pinNames){const zn=Ht.pinNames||[];Nn.pinNames=new Array(Ue).fill("").map((Ee,Ne)=>Ne<zn.length?zn[Ne]:"")}return Nn}return Ht}))});const Ot=re.length>0?"pads":"vias";console.log(`Connected ${he} components of type ${C.componentType} to ${Re} ${Ot} (${Ue} pins each)`)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap"},onMouseEnter:ie=>{ie.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:ie=>{ie.currentTarget.style.backgroundColor="#4CAF50"},children:"Connect"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("span",{children:"Color:"}),n.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:C.color,border:"1px solid #ccc",borderRadius:2}}),n.jsx("span",{children:C.color})]}),n.jsxs("div",{children:["Size: ",C.size]}),n.jsxs("div",{children:["Pin Count: ",C.pinCount]}),C.componentType==="Resistor"&&n.jsxs(n.Fragment,{children:[C.resistance&&n.jsxs("div",{children:["Resistance: ",C.resistance]}),C.power&&n.jsxs("div",{children:["Power: ",C.power]}),C.tolerance&&n.jsxs("div",{children:["Tolerance: ",C.tolerance]})]}),C.componentType==="Capacitor"&&n.jsxs(n.Fragment,{children:[C.capacitance&&n.jsxs("div",{children:["Capacitance: ",C.capacitance]}),C.voltage&&n.jsxs("div",{children:["Voltage: ",C.voltage]}),C.dielectric&&n.jsxs("div",{children:["Dielectric: ",C.dielectric]}),C.tolerance&&n.jsxs("div",{children:["Tolerance: ",C.tolerance]})]}),C.componentType==="Electrolytic Capacitor"&&n.jsxs(n.Fragment,{children:[C.capacitance&&n.jsxs("div",{children:["Capacitance: ",C.capacitance]}),C.voltage&&n.jsxs("div",{children:["Voltage: ",C.voltage]}),C.tolerance&&n.jsxs("div",{children:["Tolerance: ",C.tolerance]}),C.polarized!==void 0&&n.jsxs("div",{children:["Polarized: ",C.polarized?"Yes":"No"]}),C.esr&&n.jsxs("div",{children:["ESR: ",C.esr]}),C.temperature&&n.jsxs("div",{children:["Temperature: ",C.temperature]})]}),C.pinConnections&&C.pinConnections.length>0&&(()=>{const ie=Xf(C),he=Cl(C),re=C?.pinNames,Le=he?.properties?.pinNames,Ue=Le&&Le.length>0;return n.jsxs("div",{style:{marginTop:"8px",marginBottom:"8px"},children:[n.jsx("div",{style:{marginBottom:"4px",fontWeight:600},children:"Pin Connections:"}),n.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px",border:"1px solid #ddd"},children:[n.jsx("thead",{children:n.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[n.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Pin #"}),Ue&&n.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Pin Name"}),ie&&n.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Polarity"}),n.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Node ID"})]})}),n.jsx("tbody",{children:C.pinConnections.map((et,ot)=>{const Ct=C.pinPolarities&&C.pinPolarities.length>ot?C.pinPolarities[ot]:"",Ot=re&&ot<re.length?re[ot]:"",se=Le&&ot<Le.length?Le[ot]:"",kt=se==="CHIP_DEPENDENT",Jt=Ot&&Ot.trim()!==""?Ot:kt?"":se;return n.jsxs("tr",{style:{backgroundColor:ot%2===0?"#fff":"#f9f9f9"},children:[n.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:ot+1}),Ue&&n.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd",fontSize:"9px",fontStyle:"italic",color:"#555"},children:Jt||"-"}),ie&&n.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd",textAlign:"center",fontFamily:"monospace",fontWeight:600,color:Ct==="+"?"#d32f2f":Ct==="-"?"#1976d2":"#999"},children:Ct||"-"}),n.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:et||"(not connected)"})]},ot)})})]})]})})(),"manufacturer"in C&&C.manufacturer&&n.jsxs("div",{children:["Manufacturer: ",C.manufacturer]}),"partNumber"in C&&C.partNumber&&n.jsxs("div",{children:["Part Number: ",C.partNumber]}),C.componentType==="Diode"&&n.jsxs(n.Fragment,{children:[C.diodeType&&n.jsxs("div",{children:["Type: ",C.diodeType]}),C.voltage&&n.jsxs("div",{children:["Voltage: ",C.voltage]}),C.current&&n.jsxs("div",{children:["Current: ",C.current]}),C.ledColor&&n.jsxs("div",{children:["LED Color: ",C.ledColor]})]}),C.componentType==="Battery"&&n.jsxs(n.Fragment,{children:[C.voltage&&n.jsxs("div",{children:["Voltage: ",C.voltage]}),C.capacity&&n.jsxs("div",{children:["Capacity: ",C.capacity]}),C.chemistry&&n.jsxs("div",{children:["Chemistry: ",C.chemistry]})]}),C.componentType==="Fuse"&&n.jsxs(n.Fragment,{children:[C.current&&n.jsxs("div",{children:["Current: ",C.current]}),C.voltage&&n.jsxs("div",{children:["Voltage: ",C.voltage]}),C.fuseType&&n.jsxs("div",{children:["Type: ",C.fuseType]})]}),C.componentType==="FerriteBead"&&n.jsxs(n.Fragment,{children:[C.impedance&&n.jsxs("div",{children:["Impedance: ",C.impedance]}),C.current&&n.jsxs("div",{children:["Current: ",C.current]})]}),C.componentType==="Connector"&&n.jsxs(n.Fragment,{children:[C.connectorType&&n.jsxs("div",{children:["Type: ",C.connectorType]}),C.gender&&n.jsxs("div",{children:["Gender: ",C.gender]})]}),C.componentType==="Jumper"&&n.jsx(n.Fragment,{children:C.positions&&n.jsxs("div",{children:["Positions: ",C.positions]})}),C.componentType==="Relay"&&n.jsxs(n.Fragment,{children:[C.coilVoltage&&n.jsxs("div",{children:["Coil Voltage: ",C.coilVoltage]}),C.contactType&&n.jsxs("div",{children:["Contact Type: ",C.contactType]}),C.current&&n.jsxs("div",{children:["Current: ",C.current]})]}),C.componentType==="Inductor"&&n.jsxs(n.Fragment,{children:[C.inductance&&n.jsxs("div",{children:["Inductance: ",C.inductance]}),C.current&&n.jsxs("div",{children:["Current: ",C.current]}),C.resistance&&n.jsxs("div",{children:["DC Resistance: ",C.resistance]})]}),C.componentType==="Speaker"&&n.jsxs(n.Fragment,{children:[C.impedance&&n.jsxs("div",{children:["Impedance: ",C.impedance]}),C.power&&n.jsxs("div",{children:["Power: ",C.power]})]}),C.componentType==="Motor"&&n.jsxs(n.Fragment,{children:[C.motorType&&n.jsxs("div",{children:["Type: ",C.motorType]}),C.voltage&&n.jsxs("div",{children:["Voltage: ",C.voltage]}),C.current&&n.jsxs("div",{children:["Current: ",C.current]})]}),C.componentType==="PowerSupply"&&n.jsxs(n.Fragment,{children:[C.inputVoltage&&n.jsxs("div",{children:["Input Voltage: ",C.inputVoltage]}),C.outputVoltage&&n.jsxs("div",{children:["Output Voltage: ",C.outputVoltage]}),C.current&&n.jsxs("div",{children:["Current: ",C.current]})]}),C.componentType==="Transistor"&&n.jsxs(n.Fragment,{children:[C.transistorType&&n.jsxs("div",{children:["Type: ",C.transistorType]}),C.polarized!==void 0&&n.jsxs("div",{children:["Polarized: ",C.polarized?"Yes":"No"]}),C.voltage&&n.jsxs("div",{children:["Voltage: ",C.voltage]}),C.current&&n.jsxs("div",{children:["Current: ",C.current]})]}),C.componentType==="ResistorNetwork"&&n.jsxs(n.Fragment,{children:[C.resistance&&n.jsxs("div",{children:["Resistance: ",C.resistance]}),C.configuration&&n.jsxs("div",{children:["Configuration: ",C.configuration]})]}),C.componentType==="Thermistor"&&n.jsxs(n.Fragment,{children:[C.resistance&&n.jsxs("div",{children:["Resistance: ",C.resistance]}),C.thermistorType&&n.jsxs("div",{children:["Type: ",C.thermistorType]}),C.beta&&n.jsxs("div",{children:["Beta: ",C.beta]})]}),C.componentType==="Switch"&&n.jsxs(n.Fragment,{children:[C.switchType&&n.jsxs("div",{children:["Type: ",C.switchType]}),C.current&&n.jsxs("div",{children:["Current: ",C.current]}),C.voltage&&n.jsxs("div",{children:["Voltage: ",C.voltage]})]}),C.componentType==="Transformer"&&n.jsxs(n.Fragment,{children:[C.primaryVoltage&&n.jsxs("div",{children:["Primary Voltage: ",C.primaryVoltage]}),C.secondaryVoltage&&n.jsxs("div",{children:["Secondary Voltage: ",C.secondaryVoltage]}),C.power&&n.jsxs("div",{children:["Power: ",C.power]}),C.turns&&n.jsxs("div",{children:["Turns Ratio: ",C.turns]})]}),C.componentType==="TestPoint"&&n.jsx(n.Fragment,{children:C.signal&&n.jsxs("div",{children:["Signal: ",C.signal]})}),C.componentType==="IntegratedCircuit"&&n.jsxs(n.Fragment,{children:[C.datasheet&&(()=>{const ie=C.datasheet.trim(),he=ie.match(/^https?:\/\//)?ie:`https://${ie}`;return n.jsxs("div",{children:["Datasheet URL:"," ",n.jsx("a",{href:he,target:"_blank",rel:"noopener noreferrer",style:{color:"#0066cc",textDecoration:"underline"},children:ie})]})})(),C.datasheetFileName&&(()=>{const he=C.datasheetFileName.split("/").pop();return n.jsxs("div",{children:["Datasheet File:"," ",n.jsxs("span",{style:{color:"#666",fontStyle:"italic"},title:"Re-choose the datasheet file in Component Properties to open it",children:[he," (re-choose file to open)"]})]})})()]}),C.componentType==="VacuumTube"&&n.jsx(n.Fragment,{children:C.tubeType&&n.jsxs("div",{children:["Type: ",C.tubeType]})}),C.componentType==="VariableResistor"&&n.jsxs(n.Fragment,{children:[C.vrType&&n.jsxs("div",{children:["Type: ",C.vrType]}),C.resistance&&n.jsxs("div",{children:["Resistance: ",C.resistance]}),C.power&&n.jsxs("div",{children:["Power: ",C.power]}),C.taper&&n.jsxs("div",{children:["Taper: ",C.taper]})]}),C.componentType==="Crystal"&&n.jsxs(n.Fragment,{children:[C.frequency&&n.jsxs("div",{children:["Frequency: ",C.frequency]}),C.loadCapacitance&&n.jsxs("div",{children:["Load Capacitance: ",C.loadCapacitance]}),C.tolerance&&n.jsxs("div",{children:["Tolerance: ",C.tolerance]})]}),C.componentType==="GenericComponent"&&n.jsxs(n.Fragment,{children:[C.genericType&&n.jsxs("div",{children:["Type: ",C.genericType]}),C.voltage&&n.jsxs("div",{children:["Voltage: ",C.voltage," ",C.voltageUnit||"V"]}),C.current&&n.jsxs("div",{children:["Current: ",C.current," ",C.currentUnit||"A"]}),C.power&&n.jsxs("div",{children:["Power: ",C.power]}),C.frequency&&n.jsxs("div",{children:["Frequency: ",C.frequency]}),C.model&&n.jsxs("div",{children:["Model: ",C.model]})]}),n.jsx("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid #eee",fontSize:"10px",color:"#999"},children:n.jsxs("div",{children:["Position: x=",C.x.toFixed(2),", y=",C.y.toFixed(2)]})})]})]},C.id)})})(),r.size>0&&d.filter(de=>r.has(de.id)&&de.type==="via"&&de.points.length>0).map(de=>{const C=de.points[0],z=de.viaType||(C.id!==void 0?K(C.id,S):"Via");return n.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:z})]}),Se&&n.jsx("button",{onClick:()=>{Se(de.id,C.x,C.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:G=>{G.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:G=>{G.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),n.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[C.id&&n.jsxs("div",{children:["Node ID: ",C.id]}),n.jsx("div",{children:"Layer: Top and Bottom"}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("span",{children:"Color:"}),n.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:de.color,border:"1px solid #ccc",borderRadius:2}}),n.jsx("span",{children:de.color})]}),n.jsxs("div",{children:["Size: ",de.size]}),n.jsxs("div",{children:["Position: x=",C.x.toFixed(2),", y=",C.y.toFixed(2)]}),n.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),n.jsx("input",{type:"text",value:de.notes||"",readOnly:!0,onClick:pe,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},de.id)}),r.size>0&&d.filter(de=>r.has(de.id)&&de.type==="pad"&&de.points.length>0).map(de=>{const C=de.points[0],z=de.padType||(C.id!==void 0?D(C.id,S):"Pad");return n.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:z})]}),Se&&n.jsx("button",{onClick:()=>{Se(de.id,C.x,C.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:G=>{G.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:G=>{G.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),n.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[C.id&&n.jsxs("div",{children:["Node ID: ",C.id]}),n.jsxs("div",{children:["Layer: ",de.layer]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("span",{children:"Color:"}),n.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:de.color,border:"1px solid #ccc",borderRadius:2}}),n.jsx("span",{children:de.color})]}),n.jsxs("div",{children:["Size: ",de.size]}),n.jsxs("div",{children:["Position: x=",C.x.toFixed(2),", y=",C.y.toFixed(2)]}),n.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),n.jsx("input",{type:"text",value:de.notes||"",readOnly:!0,onClick:pe,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},de.id)}),r.size>0&&d.filter(de=>r.has(de.id)&&de.type==="testPoint"&&de.points.length>0).map(de=>{const C=de.points[0],z=C.id!==void 0?ee(C.id,S):"Test Point";return n.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:z})]}),Se&&n.jsx("button",{onClick:()=>{Se(de.id,C.x,C.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:G=>{G.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:G=>{G.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),n.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[C.id&&n.jsxs("div",{children:["Node ID: ",C.id]}),n.jsxs("div",{children:["Layer: ",de.layer]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("span",{children:"Color:"}),n.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:de.color,border:"1px solid #ccc",borderRadius:2}}),n.jsx("span",{children:de.color})]}),n.jsxs("div",{children:["Size: ",de.size]}),n.jsxs("div",{children:["Position: x=",C.x.toFixed(2),", y=",C.y.toFixed(2)]}),n.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),n.jsx("input",{type:"text",value:de.notes||"",readOnly:!0,onClick:pe,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},de.id)}),r.size>0&&d.filter(de=>r.has(de.id)&&de.type==="trace").map(de=>{const C=de.points.length>0?de.points.reduce((G,V)=>G+V.x,0)/de.points.length:0,z=de.points.length>0?de.points.reduce((G,V)=>G+V.y,0)/de.points.length:0;return n.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:de.type||"unknown"})]}),Se&&de.points.length>0&&n.jsx("button",{onClick:()=>{Se(de.id,C,z)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:G=>{G.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:G=>{G.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),n.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[de.points.length>0&&n.jsxs("div",{style:{marginTop:"8px",marginBottom:"8px"},children:[n.jsxs("div",{style:{marginBottom:"4px",fontWeight:600},children:["Points: ",de.points.length]}),n.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px",border:"1px solid #ddd"},children:[n.jsx("thead",{children:n.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[n.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Point #"}),n.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"x"}),n.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"y"}),n.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Node ID"})]})}),n.jsx("tbody",{children:de.points.map((G,V)=>n.jsxs("tr",{style:{backgroundColor:V%2===0?"#fff":"#f9f9f9"},children:[n.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:V}),n.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:G.x.toFixed(2)}),n.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:G.y.toFixed(2)}),n.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:G.id||"(none)"})]},V))})]})]}),n.jsxs("div",{style:{marginTop:"4px"},children:["Layer: ",de.layer]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("span",{children:"Color:"}),n.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:de.color,border:"1px solid #ccc",borderRadius:2}}),n.jsx("span",{children:de.color})]}),n.jsxs("div",{children:["Size: ",de.size]}),n.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),n.jsx("input",{type:"text",value:de.notes||"",readOnly:!0,onClick:pe,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},de.id)}),s.size>0&&g.filter(de=>s.has(de.id)).map(de=>{const C=S.find(z=>z.id===de.powerBusId);return n.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:de.type||(C?`${C.name} Power Node`:"Power Node")})]}),$&&n.jsx("button",{onClick:()=>{$(de.id,de.x,de.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:z=>{z.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:z=>{z.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),n.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[n.jsxs("div",{children:["Node ID: ",de.pointId||"(not assigned)"]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("span",{children:"Color:"}),n.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:de.color,border:"1px solid #ccc",borderRadius:2}}),n.jsx("span",{children:de.color})]}),n.jsxs("div",{children:["Size: ",de.size]}),n.jsxs("div",{children:["Layer: ",de.layer]}),n.jsxs("div",{children:["Power Bus: ",C?.name||de.powerBusId||"(unknown)"]}),n.jsxs("div",{children:["Position: x=",de.x.toFixed(2),", y=",de.y.toFixed(2)]}),n.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),n.jsx("input",{type:"text",value:de.notes||"",readOnly:!0,onClick:pe,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},de.id)}),c.size>0&&m.filter(de=>c.has(de.id)).map(de=>n.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:de.type||"Ground Node"})]}),H&&n.jsx("button",{onClick:()=>{H(de.id,de.x,de.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:C=>{C.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:C=>{C.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),n.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[n.jsxs("div",{children:["Node ID: ",de.pointId||"(not assigned)"]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("span",{children:"Color:"}),n.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:de.color,border:"1px solid #ccc",borderRadius:2}}),n.jsx("span",{children:de.color})]}),n.jsxs("div",{children:["Size: ",de.size]}),n.jsxs("div",{children:["Position: x=",de.x.toFixed(2),", y=",de.y.toFixed(2)]}),n.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),n.jsx("input",{type:"text",value:de.notes||"",readOnly:!0,onClick:pe,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},de.id))]})}),n.jsx("div",{onMouseDown:xe,style:{position:"absolute",bottom:0,right:0,width:"20px",height:"20px",cursor:"nwse-resize",background:"linear-gradient(135deg, transparent 0%, transparent 40%, #ccc 40%, #ccc 45%, transparent 45%, transparent 55%, #ccc 55%, #ccc 60%, transparent 60%)",zIndex:10001},title:"Drag to resize"})]}),n.jsx(Oy,{visible:Y.visible,title:Y.title,message:Y.message,onClose:()=>X({visible:!1,title:"",message:""})})]})},ka=500,Nv=({visible:i,selectedIds:r,selectedComponentIds:o,selectedPowerIds:s,selectedGroundIds:c,drawingStrokes:d,componentsTop:v,componentsBottom:p,powers:g,grounds:m,powerBuses:S,onClose:_,setComponentsTop:E,setComponentsBottom:T,setDrawingStrokes:K,setPowerSymbols:D,setGroundSymbols:ee,determineViaType:w,determinePadType:Se,determineTestPointType:$,position:H,isDragging:ae,onDragStart:I})=>{const[oe,pe]=L.useState(new Map),Y=L.useRef(""),[X,F]=L.useState(()=>{const re=localStorage.getItem("notesDialogSize");if(re)try{return JSON.parse(re)}catch{return{width:400,height:window.innerHeight*.8}}return{width:400,height:window.innerHeight*.8}}),[R,U]=L.useState(!1),[O,_e]=L.useState({x:0,y:0,width:0,height:0}),ce=()=>[...Array.from(r).sort(),...Array.from(o).sort(),...Array.from(s).sort(),...Array.from(c).sort()].join(",");L.useEffect(()=>{if(!i)return;const re=ce();re!==Y.current&&(Y.current=re,pe(Le=>{const Re=new Map;return[...v,...p].filter(Ue=>o.has(Ue.id)).forEach(Ue=>{const et=Le.get(Ue.id);Re.set(Ue.id,et!==void 0?et:Ue.notes||"")}),d.filter(Ue=>r.has(Ue.id)).forEach(Ue=>{const et=Le.get(Ue.id);Re.set(Ue.id,et!==void 0?et:Ue.notes||"")}),g.filter(Ue=>s.has(Ue.id)).forEach(Ue=>{const et=Le.get(Ue.id);Re.set(Ue.id,et!==void 0?et:Ue.notes||"")}),m.filter(Ue=>c.has(Ue.id)).forEach(Ue=>{const et=Le.get(Ue.id);Re.set(Ue.id,et!==void 0?et:Ue.notes||"")}),Re}))},[i,r,o,s,c,d,v,p,g,m]),L.useEffect(()=>{if(!R)return;const re=Re=>{const Ue=Re.clientX-O.x,et=Re.clientY-O.y,ot=Math.max(300,Math.min(window.innerWidth-20,O.width+Ue)),Ct=Math.max(200,Math.min(window.innerHeight-20,O.height+et)),Ot={width:ot,height:Ct};F(Ot),localStorage.setItem("notesDialogSize",JSON.stringify(Ot))},Le=()=>{U(!1)};return document.addEventListener("mousemove",re),document.addEventListener("mouseup",Le),()=>{document.removeEventListener("mousemove",re),document.removeEventListener("mouseup",Le)}},[R,O]);const xe=re=>{re.preventDefault(),re.stopPropagation(),U(!0),_e({x:re.clientX,y:re.clientY,width:X.width,height:X.height})};if(!i)return null;const fe=H?{position:"fixed",left:`${H.x}px`,top:`${H.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"300px",width:`${X.width}px`,height:`${X.height}px`,maxHeight:`${window.innerHeight-20}px`,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:ae?"grabbing":"default"}:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"flex-start",justifyContent:"flex-end",paddingRight:"20px",paddingTop:"80px",zIndex:1e4,pointerEvents:"none"},ke={padding:"20px",overflow:"auto",flex:1},de=d.filter(re=>r.has(re.id)).length,C=[...v,...p].filter(re=>o.has(re.id)).length,z=g.filter(re=>s.has(re.id)).length,G=m.filter(re=>c.has(re.id)).length,V=de+C+z+G,ie=(re,Le)=>{const Re=Le.length>ka?Le.substring(0,ka):Le;pe(Ue=>{const et=new Map(Ue);return et.set(re,Re),et})},he=()=>{E(re=>re.map(Le=>{if(o.has(Le.id)&&oe.has(Le.id)){const Re=oe.get(Le.id)||"";return{...Le,notes:Re.trim()===""?void 0:Re.trim()}}return Le})),T(re=>re.map(Le=>{if(o.has(Le.id)&&oe.has(Le.id)){const Re=oe.get(Le.id)||"";return{...Le,notes:Re.trim()===""?void 0:Re.trim()}}return Le})),K(re=>re.map(Le=>{if(r.has(Le.id)&&oe.has(Le.id)){const Re=oe.get(Le.id)||"";return{...Le,notes:Re.trim()===""?null:Re.trim()}}return Le})),D(re=>re.map(Le=>{if(s.has(Le.id)&&oe.has(Le.id)){const Re=oe.get(Le.id)||"";return{...Le,notes:Re.trim()===""?null:Re.trim()}}return Le})),ee(re=>re.map(Le=>{if(c.has(Le.id)&&oe.has(Le.id)){const Re=oe.get(Le.id)||"";return{...Le,notes:Re.trim()===""?null:Re.trim()}}return Le}))};return n.jsx("div",{style:fe,children:n.jsxs("div",{style:{position:"relative",width:"100%",height:"100%",display:"flex",flexDirection:"column",...H?{}:{backgroundColor:"#fff",borderRadius:8,minWidth:"300px",width:`${X.width}px`,height:`${X.height}px`,maxHeight:`${window.innerHeight-20}px`,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",pointerEvents:"auto"}},children:[n.jsxs("div",{onMouseDown:re=>{const Le=re.target;Le.tagName==="BUTTON"||Le.closest("button")||H&&I(re)},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:ae?"grabbing":H?"grab":"default",userSelect:"none",flexShrink:0},children:[n.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Notes (N)"}),n.jsx("button",{onClick:_,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),n.jsx("div",{style:ke,children:n.jsxs("div",{style:{margin:0,padding:0,backgroundColor:"#f5f5f5",borderRadius:4,fontSize:"12px",fontFamily:"monospace",maxHeight:"calc(80vh - 100px)",overflow:"auto",color:"#000"},children:[n.jsx("div",{style:{padding:"12px 16px",backgroundColor:V>0?"#e8e8e8":"#fff3cd",borderBottom:"2px solid #ccc",fontSize:"13px",fontWeight:600,color:V>0?"#333":"#856404",marginBottom:"8px"},children:V>0?`${V} Object${V!==1?"s":""} Selected`:"Zero Objects Selected"}),V===0?n.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"No objects selected. Select one or more objects to add or edit notes."}):n.jsxs(n.Fragment,{children:[[...v,...p].filter(re=>o.has(re.id)).map(re=>{const Le=oe.get(re.id)||"",Re=Le.length;return n.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),n.jsxs("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:[kl(re.componentType),re.designator&&re.designator.trim()?` (${re.designator.trim()})`:""]})]}),n.jsxs("div",{style:{padding:"8px"},children:[n.jsx("textarea",{value:Le,onChange:Ue=>ie(re.id,Ue.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:ka,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),n.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Re>=ka?"#d32f2f":"#666",textAlign:"right"},children:[Re," / ",ka]})]})]},re.id)}),d.filter(re=>r.has(re.id)&&re.type==="via"&&re.points.length>0).map(re=>{const Le=re.points[0],Re=re.viaType||(Le.id!==void 0?w(Le.id,S):"Via"),Ue=oe.get(re.id)||"",et=Ue.length;return n.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:Re})]}),n.jsxs("div",{style:{padding:"8px"},children:[n.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:Le.id&&n.jsxs("div",{children:["Node ID: ",Le.id]})}),n.jsx("textarea",{value:Ue,onChange:ot=>ie(re.id,ot.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:ka,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),n.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:et>=ka?"#d32f2f":"#666",textAlign:"right"},children:[et," / ",ka]})]})]},re.id)}),d.filter(re=>r.has(re.id)&&re.type==="pad"&&re.points.length>0).map(re=>{const Le=re.points[0],Re=re.padType||(Le.id!==void 0?Se(Le.id,S):"Pad"),Ue=oe.get(re.id)||"",et=Ue.length;return n.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:Re})]}),n.jsxs("div",{style:{padding:"8px"},children:[n.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:Le.id&&n.jsxs("div",{children:["Node ID: ",Le.id]})}),n.jsx("textarea",{value:Ue,onChange:ot=>ie(re.id,ot.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:ka,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),n.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:et>=ka?"#d32f2f":"#666",textAlign:"right"},children:[et," / ",ka]})]})]},re.id)}),d.filter(re=>r.has(re.id)&&re.type==="testPoint"&&re.points.length>0).map(re=>{const Le=re.points[0],Re=Le.id!==void 0?$(Le.id,S):"Test Point",Ue=oe.get(re.id)||"",et=Ue.length;return n.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:Re})]}),n.jsxs("div",{style:{padding:"8px"},children:[n.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:Le.id&&n.jsxs("div",{children:["Node ID: ",Le.id]})}),n.jsx("textarea",{value:Ue,onChange:ot=>ie(re.id,ot.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:ka,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),n.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:et>=ka?"#d32f2f":"#666",textAlign:"right"},children:[et," / ",ka]})]})]},re.id)}),d.filter(re=>r.has(re.id)&&re.type==="trace").map(re=>{const Le=oe.get(re.id)||"",Re=Le.length;return n.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:re.type||"unknown"})]}),n.jsxs("div",{style:{padding:"8px"},children:[n.jsx("textarea",{value:Le,onChange:Ue=>ie(re.id,Ue.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:ka,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),n.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Re>=ka?"#d32f2f":"#666",textAlign:"right"},children:[Re," / ",ka]})]})]},re.id)}),g.filter(re=>s.has(re.id)).map(re=>{const Le=S.find(ot=>ot.id===re.powerBusId),Re=re.type||(Le?`${Le.name} Power Node`:"Power Node"),Ue=oe.get(re.id)||"",et=Ue.length;return n.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:Re})]}),n.jsxs("div",{style:{padding:"8px"},children:[n.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:n.jsxs("div",{children:["Node ID: ",re.pointId||"(not assigned)"]})}),n.jsx("textarea",{value:Ue,onChange:ot=>ie(re.id,ot.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:ka,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),n.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:et>=ka?"#d32f2f":"#666",textAlign:"right"},children:[et," / ",ka]})]})]},re.id)}),m.filter(re=>c.has(re.id)).map(re=>{const Le=re.type||"Ground Node",Re=oe.get(re.id)||"",Ue=Re.length;return n.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:Le})]}),n.jsxs("div",{style:{padding:"8px"},children:[n.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:n.jsxs("div",{children:["Node ID: ",re.pointId||"(not assigned)"]})}),n.jsx("textarea",{value:Re,onChange:et=>ie(re.id,et.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:ka,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),n.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Ue>=ka?"#d32f2f":"#666",textAlign:"right"},children:[Ue," / ",ka]})]})]},re.id)}),n.jsxs("div",{style:{marginTop:"20px",padding:"12px",display:"flex",justifyContent:"flex-end",gap:"8px",borderTop:"1px solid #ddd"},children:[n.jsx("button",{onClick:_,style:{padding:"8px 16px",fontSize:"12px",backgroundColor:"#757575",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500},onMouseEnter:re=>{re.currentTarget.style.backgroundColor="#616161"},onMouseLeave:re=>{re.currentTarget.style.backgroundColor="#757575"},children:"Close"}),n.jsx("button",{onClick:he,style:{padding:"8px 16px",fontSize:"12px",backgroundColor:"#2196F3",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500},onMouseEnter:re=>{re.currentTarget.style.backgroundColor="#1976D2"},onMouseLeave:re=>{re.currentTarget.style.backgroundColor="#2196F3"},children:"Save"})]})]})]})}),n.jsx("div",{onMouseDown:xe,style:{position:"absolute",bottom:0,right:0,width:"20px",height:"20px",cursor:"nwse-resize",background:"linear-gradient(135deg, transparent 0%, transparent 40%, #ccc 40%, #ccc 45%, transparent 45%, transparent 55%, #ccc 55%, #ccc 60%, transparent 60%)",zIndex:10001},title:"Drag to resize"})]})})},Av=({visible:i,projectNotes:r,setProjectNotes:o,onClose:s,position:c,isDragging:d,onDragStart:v})=>{const[p,g]=L.useState([]),[m,S]=L.useState(null),[_,E]=L.useState(null),T=L.useRef(new Map),[K,D]=L.useState({width:Math.min(window.innerWidth*.85,1400),height:window.innerHeight*.7}),[ee,w]=L.useState(!1),[Se,$]=L.useState({x:0,y:0,width:0,height:0}),[H,ae]=L.useState("");L.useEffect(()=>{i&&(g([...r]),S(null),E(null),ae(""))},[i,r]);const I=H.trim()===""?p:p.filter(fe=>{const ke=H.toLowerCase(),de=fe.name.toLowerCase().includes(ke),C=fe.value.toLowerCase().includes(ke);return de||C});L.useEffect(()=>{if(!ee)return;const fe=de=>{const C=de.clientX-Se.x,z=de.clientY-Se.y,G=Math.max(400,Math.min(window.innerWidth-20,Se.width+C)),V=Math.max(300,Math.min(window.innerHeight-20,Se.height+z));D({width:G,height:V})},ke=()=>{w(!1)};return document.addEventListener("mousemove",fe),document.addEventListener("mouseup",ke),()=>{document.removeEventListener("mousemove",fe),document.removeEventListener("mouseup",ke)}},[ee,Se]);const oe=fe=>{fe.preventDefault(),fe.stopPropagation(),w(!0),$({x:fe.clientX,y:fe.clientY,width:K.width,height:K.height})};if(!i)return null;const pe=()=>{const fe={name:"",value:"",checked:!1};g([...p,fe]),S(p.length),E("name")},Y=fe=>{const ke=p.filter((de,C)=>C!==fe);g(ke),m===fe?(S(null),E(null)):m!==null&&m>fe&&S(m-1)},X=()=>{const fe=p.filter(ke=>ke.name.trim()!==""||ke.value.trim()!=="");o(fe),s()},F=()=>{g([...r]),S(null),E(null),s()},R=(fe,ke,de)=>{const C=[...p];C[fe]={...C[fe],[ke]:de},g(C)},U=(fe,ke)=>{const de=[...p];de[fe]={...de[fe],checked:ke},g(de)},O=(fe,ke,de)=>{fe.stopPropagation();const C=fe.currentTarget,z=C.selectionStart,G=C.value.length,V=C.selectionStart!==C.selectionEnd;if(!(fe.key==="Enter"&&fe.altKey)){if(fe.key==="ArrowRight"&&!fe.ctrlKey&&!fe.shiftKey&&!fe.altKey){if(z===G&&!V&&de==="name"){fe.preventDefault();const ie=`${ke}-value`,he=T.current.get(ie);he&&(he.focus(),he.setSelectionRange(0,0))}return}if(fe.key==="ArrowLeft"&&!fe.ctrlKey&&!fe.shiftKey&&!fe.altKey){if(z===0&&!V&&de==="value"){fe.preventDefault();const ie=`${ke}-name`,he=T.current.get(ie);he&&(he.focus(),he.setSelectionRange(he.value.length,he.value.length))}return}if(fe.key==="ArrowDown"&&!fe.ctrlKey&&!fe.shiftKey&&!fe.altKey){if(fe.preventDefault(),ke<p.length-1){const ie=`${ke+1}-${de}`,he=T.current.get(ie);if(he){he.focus();const re=Math.min(z,he.value.length);he.setSelectionRange(re,re)}}else{const ie=p.length;pe(),setTimeout(()=>{const he=`${ie}-${de}`,re=T.current.get(he);re&&(re.focus(),re.setSelectionRange(0,0))},0)}return}if(fe.key==="ArrowUp"&&!fe.ctrlKey&&!fe.shiftKey&&!fe.altKey){if(fe.preventDefault(),ke>0){const ie=`${ke-1}-${de}`,he=T.current.get(ie);if(he){he.focus();const re=Math.min(z,he.value.length);he.setSelectionRange(re,re)}}return}if(fe.key==="Enter"&&!fe.altKey&&!fe.shiftKey){if(fe.preventDefault(),de==="name"){const ie=`${ke}-value`,he=T.current.get(ie);he&&(he.focus(),he.setSelectionRange(0,0))}else if(de==="value")if(ke<p.length-1){const ie=`${ke+1}-name`,he=T.current.get(ie);he&&(he.focus(),he.setSelectionRange(0,0))}else{const ie=p.length;pe(),setTimeout(()=>{const he=`${ie}-name`,re=T.current.get(he);re&&(re.focus(),re.setSelectionRange(0,0))},0)}return}if(fe.key==="Tab"&&!fe.shiftKey){if(fe.preventDefault(),de==="name"){const ie=`${ke}-value`,he=T.current.get(ie);he&&(he.focus(),he.select())}else if(de==="value")if(ke<p.length-1){const ie=`${ke+1}-name`,he=T.current.get(ie);he&&(he.focus(),he.select())}else{const ie=p.length;pe(),setTimeout(()=>{const he=`${ie}-name`,re=T.current.get(he);re&&re.focus()},0)}return}if(fe.key==="Tab"&&fe.shiftKey){if(fe.preventDefault(),de==="value"){const ie=`${ke}-name`,he=T.current.get(ie);he&&(he.focus(),he.select())}else if(de==="name"&&ke>0){const ie=`${ke-1}-value`,he=T.current.get(ie);he&&(he.focus(),he.select())}return}}},_e=(fe,ke)=>{S(fe),E(ke)},ce=()=>{},xe={position:"fixed",top:c?.y??100,left:c?.x??(window.innerWidth-K.width)/2,width:`${K.width}px`,height:`${K.height}px`,backgroundColor:"#fff",borderRadius:8,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:d?"grabbing":"default",overflow:"hidden"};return n.jsxs("div",{style:xe,children:[n.jsxs("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e0e0",background:"#888",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"move",userSelect:"none"},onMouseDown:v,children:[n.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Project Notes / TODO List (L)"}),n.jsx("button",{onClick:F,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:"0 4px",lineHeight:1},title:"Close",children:""})]}),n.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e0e0e0",backgroundColor:"#f5f5f5",display:"flex",gap:"8px",alignItems:"center",flexShrink:0},children:[n.jsx("input",{type:"text",value:H,onChange:fe=>ae(fe.target.value),onKeyDown:fe=>{fe.key==="Enter"&&fe.preventDefault()},placeholder:"Search notes...",style:{flex:1,padding:"6px 12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"13px",color:"#000",background:"#fff",outline:"none"}}),n.jsx("button",{onClick:()=>{H.trim()!==""&&ae("")},style:{padding:"6px 16px",background:H.trim()!==""?"#4CAF50":"#888",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"13px",fontWeight:500,whiteSpace:"nowrap"},children:H.trim()!==""?"Clear":"Search"})]}),n.jsxs("div",{className:"project-notes-content",style:{padding:0,flex:1,overflowY:"auto",overflowX:"hidden",display:"flex",flexDirection:"column",minHeight:0,scrollbarWidth:"thin",scrollbarColor:"#888 #f0f0f0"},children:[n.jsxs("div",{style:{border:"none",borderTop:"1px solid #ccc",borderRadius:0,overflow:"visible",marginBottom:"16px",backgroundColor:"#e0e0e0",flexShrink:0},children:[n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"40px 1fr 3fr auto",backgroundColor:"#e0e0e0",borderBottom:"1px solid #ccc",position:"sticky",top:0,zIndex:10},children:[n.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",display:"flex",alignItems:"center",justifyContent:"center",color:"#000"},children:n.jsx("label",{className:"radio-label",style:{margin:0,cursor:"default"},children:n.jsx("input",{type:"checkbox",disabled:!0,style:{opacity:.5}})})}),n.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",color:"#000"},children:"Item"}),n.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",color:"#000"},children:"Notes"}),n.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",color:"#000"}})]}),n.jsx("div",{children:p.length===0?n.jsx("div",{style:{padding:"24px",textAlign:"center",color:"#999",fontSize:"13px"},children:'No notes. Click "Add Note" to create one.'}):I.length===0?n.jsxs("div",{style:{padding:"24px",textAlign:"center",color:"#999",fontSize:"13px"},children:['No matches found for "',H,'".']}):I.map(fe=>{const ke=p.findIndex(de=>de===fe);return n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"40px 1fr 3fr auto",borderBottom:"1px solid #ccc",backgroundColor:"#fff"},children:[n.jsx("div",{style:{padding:"8px 12px",borderRight:"1px solid #ccc",display:"flex",alignItems:"center",justifyContent:"center"},children:n.jsx("label",{className:"radio-label",style:{margin:0,cursor:"pointer"},children:n.jsx("input",{type:"checkbox",checked:fe.checked||!1,onChange:de=>U(ke,de.target.checked)})})}),n.jsx("div",{style:{padding:"4px",borderRight:"1px solid #ccc"},children:n.jsx("textarea",{ref:de=>{de?T.current.set(`${ke}-name`,de):T.current.delete(`${ke}-name`)},value:fe.name,onChange:de=>R(ke,"name",de.target.value),onFocus:()=>_e(ke,"name"),onBlur:ce,onKeyDown:de=>O(de,ke,"name"),placeholder:"Item name...",rows:1,style:{width:"100%",padding:"4px 6px",border:m===ke&&_==="name"?"2px solid #0b5fff":"1px solid transparent",borderRadius:3,fontSize:"12px",backgroundColor:"#fff",color:"#000",fontFamily:"inherit",resize:"none",minHeight:"24px",lineHeight:"1.4",overflow:"hidden",outline:"none",boxSizing:"border-box"},onInput:de=>{const C=de.target;C.style.height="auto",C.style.height=`${C.scrollHeight}px`}})}),n.jsx("div",{style:{padding:"4px",borderRight:"1px solid #ccc"},children:n.jsx("textarea",{ref:de=>{de?T.current.set(`${ke}-value`,de):T.current.delete(`${ke}-value`)},value:fe.value,onChange:de=>R(ke,"value",de.target.value),onFocus:()=>_e(ke,"value"),onBlur:ce,onKeyDown:de=>O(de,ke,"value"),placeholder:"Notes...",rows:1,style:{width:"100%",padding:"4px 6px",border:m===ke&&_==="value"?"2px solid #0b5fff":"1px solid transparent",borderRadius:3,fontSize:"12px",backgroundColor:"#fff",color:"#000",fontFamily:"inherit",resize:"none",minHeight:"24px",lineHeight:"1.4",overflow:"hidden",outline:"none",boxSizing:"border-box"},onInput:de=>{const C=de.target;C.style.height="auto",C.style.height=`${C.scrollHeight}px`}})}),n.jsx("div",{style:{padding:"8px 12px",display:"flex",alignItems:"center",justifyContent:"center"},children:n.jsx("button",{onClick:()=>Y(ke),style:{background:"#f44336",color:"#fff",border:"none",borderRadius:3,padding:"4px 8px",cursor:"pointer",fontSize:"11px"},title:"Delete note",children:"Delete"})})]},ke)})})]}),n.jsx("div",{style:{padding:"16px",flexShrink:0},children:n.jsx("button",{onClick:pe,style:{background:"#888",color:"#fff",border:"none",borderRadius:4,padding:"8px 16px",cursor:"pointer",fontSize:"12px",fontWeight:500,alignSelf:"flex-start"},children:"+ Add Note"})})]}),n.jsxs("div",{style:{padding:"12px 16px",borderTop:"1px solid #ddd",display:"flex",justifyContent:"flex-end",gap:"8px",flexShrink:0},children:[n.jsx("button",{onClick:F,style:{background:"#f5f5f5",color:"#000",border:"1px solid #ddd",borderRadius:4,padding:"6px 16px",cursor:"pointer",fontSize:"12px"},children:"Cancel"}),n.jsx("button",{onClick:X,style:{background:"#0b5fff",color:"#fff",border:"none",borderRadius:4,padding:"6px 16px",cursor:"pointer",fontSize:"12px",fontWeight:500},children:"Save"})]}),n.jsx("div",{onMouseDown:oe,style:{position:"absolute",bottom:0,right:0,width:"20px",height:"20px",cursor:"nwse-resize",background:"linear-gradient(135deg, transparent 0%, transparent 40%, #ccc 40%, #ccc 45%, transparent 45%, transparent 55%, #ccc 55%, #ccc 60%, transparent 60%)",zIndex:10001},title:"Drag to resize"})]})},zv=({visible:i,drawingStrokes:r,onClose:o,onFindTestPoint:s,position:c,isDragging:d,onDragStart:v,determineTestPointType:p,powerBuses:g})=>{const[m,S]=L.useState("");if(L.useEffect(()=>{i&&S("")},[i]),!i)return null;const _=r.filter(D=>D.type==="testPoint"&&D.points.length>0),E=m.trim()===""?_:_.filter(D=>(D.notes||"").toLowerCase().includes(m.toLowerCase())),T=c?{position:"fixed",left:`${c.x}px`,top:`${c.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"150px",maxWidth:"500px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:d?"grabbing":"default"}:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},K={padding:"20px",overflow:"auto",flex:1};return n.jsxs("div",{style:T,children:[n.jsxs("div",{onMouseDown:D=>{const ee=D.target;ee.tagName==="BUTTON"||ee.closest("button")||c&&v(D)},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:d?"grabbing":c?"grab":"default",userSelect:"none",flexShrink:0},children:[n.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Test Points"}),n.jsx("button",{onClick:o,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),n.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e0e0e0",backgroundColor:"#f5f5f5",display:"flex",gap:"8px",alignItems:"center",flexShrink:0},children:[n.jsx("input",{type:"text",value:m,onChange:D=>S(D.target.value),onKeyDown:D=>{D.key==="Enter"&&D.preventDefault()},placeholder:"Search test point notes...",style:{flex:1,padding:"6px 12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"13px",color:"#000",background:"#fff",outline:"none"}}),n.jsx("button",{onClick:()=>{m.trim()!==""&&S("")},style:{padding:"6px 16px",background:m.trim()!==""?"#4CAF50":"#888",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"13px",fontWeight:500,whiteSpace:"nowrap"},children:m.trim()!==""?"Clear":"Search"})]}),n.jsx("div",{style:K,children:_.length===0?n.jsx("div",{style:{padding:"24px",textAlign:"center",color:"#999",fontSize:"13px"},children:"No test points found."}):E.length===0?n.jsxs("div",{style:{padding:"24px",textAlign:"center",color:"#999",fontSize:"13px"},children:['No matches found for "',m,'".']}):n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:E.map(D=>{const ee=D.points[0],w=ee.id!==void 0?p(ee.id,g):"Test Point",Se=w.includes("(")?w.substring(0,w.indexOf("(")).trim():w;return n.jsxs("div",{style:{padding:"12px",backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[n.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{flexShrink:0},children:n.jsx("path",{d:"M 12 5 L 19 12 L 12 19 L 5 12 Z",fill:"#FFD700",stroke:"#000",strokeWidth:"1.5"})}),n.jsx("div",{style:{fontSize:"12px",fontWeight:500,color:"#000"},children:Se})]}),s&&n.jsx("button",{onClick:()=>{s(D.id,ee.x,ee.y)},style:{padding:"4px 12px",fontSize:"11px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap"},onMouseEnter:$=>{$.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:$=>{$.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),D.notes&&D.notes.trim()!==""?n.jsx("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px",padding:"8px",backgroundColor:"#f5f5f5",borderRadius:"3px",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:D.notes}):n.jsx("div",{style:{fontSize:"11px",color:"#999",fontStyle:"italic",marginTop:"8px"},children:"No notes"}),n.jsxs("div",{style:{fontSize:"10px",color:"#999",marginTop:"8px"},children:["Layer: ",D.layer," | Position: (",ee.x.toFixed(2),", ",ee.y.toFixed(2),")"]})]},D.id)})})})]})},Pv=({visible:i,dimensions:r,onSave:o,onClose:s})=>{const[c,d]=L.useState(""),[v,p]=L.useState(""),[g,m]=L.useState("inches");L.useEffect(()=>{i&&r?(d(r.width.toString()),p(r.height.toString()),m(r.unit)):i&&(d(""),p(""),m("inches"))},[i,r]);const S=()=>{const E=parseFloat(c),T=parseFloat(v);if(isNaN(E)||E<=0){alert("Please enter a valid width greater than 0");return}if(isNaN(T)||T<=0){alert("Please enter a valid height greater than 0");return}o({width:E,height:T,unit:g}),s()},_=()=>{s()};return i?n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:E=>{E.target===E.currentTarget&&_()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"320px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #444"},onClick:E=>E.stopPropagation(),children:[n.jsx("h3",{style:{margin:"0 0 20px 0",color:"#fff",fontSize:"18px",fontWeight:600},children:"Board Dimensions"}),n.jsxs("div",{style:{marginBottom:"16px"},children:[n.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#ddd",fontSize:"14px"},children:"Width"}),n.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[n.jsx("input",{type:"number",step:"0.001",min:"0.001",value:c,onChange:E=>d(E.target.value),style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px"},placeholder:"0.000"}),n.jsxs("select",{value:g,onChange:E=>m(E.target.value),style:{padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px",cursor:"pointer"},children:[n.jsx("option",{value:"inches",children:"inches"}),n.jsx("option",{value:"mm",children:"mm"})]})]})]}),n.jsxs("div",{style:{marginBottom:"20px"},children:[n.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#ddd",fontSize:"14px"},children:"Height"}),n.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[n.jsx("input",{type:"number",step:"0.001",min:"0.001",value:v,onChange:E=>p(E.target.value),style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px"},placeholder:"0.000"}),n.jsxs("select",{value:g,onChange:E=>m(E.target.value),style:{padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px",cursor:"pointer"},children:[n.jsx("option",{value:"inches",children:"inches"}),n.jsx("option",{value:"mm",children:"mm"})]})]})]}),n.jsx("div",{style:{marginBottom:"12px",padding:"10px",background:"#1f1f24",borderRadius:4,fontSize:"12px",color:"#bbb"},children:"This information will be used to convert pixel coordinates to real-world measurements."}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[n.jsx("button",{onClick:_,style:{padding:"8px 16px",background:"#444",color:"#fff",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px"},children:"Cancel"}),n.jsx("button",{onClick:S,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Save"})]})]})}):null},_v=({visible:i,onClose:r,topImage:o,bottomImage:s,selectedImageForTransform:c,setSelectedImageForTransform:d,transformMode:v,setTransformMode:p,updateImageTransform:g,resetImageTransform:m,setCurrentTool:S,isGrayscale:_,setIsGrayscale:E,areImagesLocked:T})=>{const[K,D]=L.useState(null),[ee,w]=L.useState(!1),Se=L.useRef({x:0,y:0}),$=L.useRef(null);L.useEffect(()=>{i&&K===null&&D({x:window.innerWidth-320-20,y:80})},[i,K]),L.useEffect(()=>{i||D(null)},[i]);const H=L.useCallback(V=>{if($.current){const ie=$.current.getBoundingClientRect();Se.current={x:V.clientX-ie.left,y:V.clientY-ie.top},w(!0)}},[]);if(L.useEffect(()=>{if(!ee)return;const V=he=>{const re=he.clientX-Se.current.x,Le=he.clientY-Se.current.y,Re=$.current?.offsetWidth||320,Ue=$.current?.offsetHeight||600,et=Math.max(0,Math.min(re,window.innerWidth-Re)),ot=Math.max(0,Math.min(Le,window.innerHeight-Ue));D({x:et,y:ot})},ie=()=>{w(!1)};return document.addEventListener("mousemove",V),document.addEventListener("mouseup",ie),()=>{document.removeEventListener("mousemove",V),document.removeEventListener("mouseup",ie)}},[ee]),!i)return null;const ae=o!==null,I=s!==null,oe=ae||I,pe=ae&&I,Y=c||(ae?"top":I?"bottom":null),X=()=>Y==="top"&&o?o.brightness??100:Y==="bottom"&&s?s.brightness??100:Y==="both"&&o?o.brightness??100:100,F=()=>Y==="top"&&o?o.contrast??100:Y==="bottom"&&s?s.contrast??100:Y==="both"&&o?o.contrast??100:100,R=X(),U=F(),O=!oe||T,_e=()=>{if(!(!Y||O))if(Y==="both"){const V=!o?.flipX;g("both",{flipX:V})}else{const V=Y==="top"?o?.flipX||!1:s?.flipX||!1;g(Y,{flipX:!V})}},ce=()=>{if(!(!Y||O))if(Y==="both"){const V=!o?.flipY;g("both",{flipY:V})}else{const V=Y==="top"?o?.flipY||!1:s?.flipY||!1;g(Y,{flipY:!V})}},xe=V=>{O||(Y&&d(Y),p(V),S("transform"))},fe=V=>{!Y||O||g(Y,{brightness:V})},ke=V=>{!Y||O||g(Y,{contrast:V})},de=()=>{O||(Y&&d(Y),S("transform"),E(!_))},C=()=>{O||(S("transform"),m())},z=(V,ie=!1)=>({display:"block",width:"100%",textAlign:"left",padding:"8px 12px",color:V?"#666":"#f2f2f2",background:ie?"#3a3a42":"transparent",border:"none",borderRadius:4,cursor:V?"not-allowed":"pointer",fontSize:"13px",transition:"background 0.15s"}),G=(V,ie)=>({display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",color:V?"#666":"#f2f2f2",cursor:V?"not-allowed":"pointer",fontSize:"13px",background:ie?"#3a3a42":"transparent",borderRadius:4,transition:"background 0.15s"});return n.jsxs("div",{ref:$,style:{position:"fixed",top:K?.y??80,left:K?.x??window.innerWidth-340,backgroundColor:"#2b2b31",borderRadius:8,minWidth:"320px",maxWidth:"400px",maxHeight:"calc(100vh - 100px)",overflowY:"auto",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24",zIndex:10001},children:[n.jsxs("div",{onMouseDown:H,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 16px",background:"linear-gradient(to bottom, #3a3a42, #2b2b31)",borderTopLeftRadius:8,borderTopRightRadius:8,borderBottom:"1px solid #1f1f24",cursor:ee?"grabbing":"grab",userSelect:"none"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[n.jsx("span",{style:{color:"#888",fontSize:"14px"},children:""}),n.jsx("h2",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#f2f2f2"},children:"Transform Images"})]}),n.jsx("button",{onClick:r,style:{background:"transparent",border:"none",color:"#888",fontSize:"16px",cursor:"pointer",padding:"2px 6px",lineHeight:1,borderRadius:4},onMouseEnter:V=>{V.currentTarget.style.background="#444",V.currentTarget.style.color="#fff"},onMouseLeave:V=>{V.currentTarget.style.background="transparent",V.currentTarget.style.color="#888"},children:""})]}),n.jsxs("div",{style:{padding:"16px"},children:[n.jsxs("div",{style:{marginBottom:"16px"},children:[n.jsx("div",{style:{fontSize:"12px",color:"#888",marginBottom:"8px",fontWeight:500},children:"Apply to:"}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[n.jsxs("label",{style:G(!ae,Y==="top"),children:[n.jsx("input",{type:"radio",name:"imageSelection",checked:Y==="top",onChange:()=>d("top"),disabled:!ae,style:{accentColor:"#6b9fff"}}),"Top Image",!ae&&n.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(not loaded)"})]}),n.jsxs("label",{style:G(!I,Y==="bottom"),children:[n.jsx("input",{type:"radio",name:"imageSelection",checked:Y==="bottom",onChange:()=>d("bottom"),disabled:!I,style:{accentColor:"#6b9fff"}}),"Bottom Image",!I&&n.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(not loaded)"})]}),n.jsxs("label",{style:G(!pe,Y==="both"),children:[n.jsx("input",{type:"radio",name:"imageSelection",checked:Y==="both",onChange:()=>d("both"),disabled:!pe,style:{accentColor:"#6b9fff"}}),"Both Images",!pe&&n.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(need both)"})]})]})]}),n.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),n.jsxs("div",{style:{marginBottom:"12px"},children:[n.jsx("button",{onClick:_e,disabled:O,style:z(O),onMouseEnter:V=>!O&&(V.currentTarget.style.background="#3a3a42"),onMouseLeave:V=>V.currentTarget.style.background="transparent",children:"Horizontal Flip"}),n.jsx("button",{onClick:ce,disabled:O,style:z(O),onMouseEnter:V=>!O&&(V.currentTarget.style.background="#3a3a42"),onMouseLeave:V=>V.currentTarget.style.background="transparent",children:"Vertical Flip"})]}),n.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),n.jsx("div",{style:{marginBottom:"12px"},children:["nudge","scale","rotate","slant","keystone"].map(V=>n.jsxs("button",{onClick:()=>xe(V),disabled:O,style:z(O,v===V),onMouseEnter:ie=>!O&&v!==V&&(ie.currentTarget.style.background="#3a3a42"),onMouseLeave:ie=>v!==V&&(ie.currentTarget.style.background="transparent"),children:[v===V?" ":"","Mode: ",V.charAt(0).toUpperCase()+V.slice(1)]},V))}),n.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),n.jsxs("div",{style:{marginBottom:"16px"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[n.jsx("label",{style:{color:"#f2f2f2",fontSize:"13px",fontWeight:500},children:"Brightness"}),n.jsxs("span",{style:{color:"#888",fontSize:"12px",minWidth:"45px",textAlign:"right"},children:[R,"%"]})]}),n.jsx("input",{type:"range",min:"0",max:"200",step:"1",value:R,onChange:V=>fe(parseInt(V.target.value,10)),disabled:O,style:{width:"100%",cursor:O?"not-allowed":"pointer",accentColor:"#6b9fff"}})]}),n.jsxs("div",{style:{marginBottom:"16px"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[n.jsx("label",{style:{color:"#f2f2f2",fontSize:"13px",fontWeight:500},children:"Contrast"}),n.jsxs("span",{style:{color:"#888",fontSize:"12px",minWidth:"45px",textAlign:"right"},children:[U,"%"]})]}),n.jsx("input",{type:"range",min:"0",max:"200",step:"1",value:U,onChange:V=>ke(parseInt(V.target.value,10)),disabled:O,style:{width:"100%",cursor:O?"not-allowed":"pointer",accentColor:"#6b9fff"}})]}),n.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),n.jsx("div",{style:{marginBottom:"12px"},children:n.jsxs("button",{onClick:de,disabled:O,style:z(O,_),onMouseEnter:V=>!O&&!_&&(V.currentTarget.style.background="#3a3a42"),onMouseLeave:V=>!_&&(V.currentTarget.style.background="transparent"),children:[_?" ":"","Grayscale Mode"]})}),n.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[n.jsx("button",{onClick:C,disabled:O,style:{padding:"8px 16px",background:O?"#444":"#555",color:O?"#777":"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:O?"not-allowed":"pointer",fontSize:"13px",fontWeight:500},children:"Reset Transform"}),n.jsx("button",{onClick:r,style:{padding:"8px 16px",background:"#4a9eff",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:500},onMouseEnter:V=>V.currentTarget.style.background="#3a8ee6",onMouseLeave:V=>V.currentTarget.style.background="#4a9eff",children:"Close"})]}),T&&n.jsx("div",{style:{marginTop:"12px",padding:"8px 12px",background:"#3d2b2b",border:"1px solid #5a3a3a",borderRadius:4,fontSize:"12px",color:"#e88"},children:" Images are locked. Unlock via Images  Lock Images to make changes."})]})]})},Rv=({visible:i,onClose:r,topImage:o,bottomImage:s,setTopImage:c,setBottomImage:d,componentsTop:v,componentsBottom:p,setComponentsTop:g,setComponentsBottom:m,drawingStrokes:S,setDrawingStrokes:_,powerSymbols:E,groundSymbols:T,setPowerSymbols:K,setGroundSymbols:D,canvasRef:ee,isBottomView:w,setIsBottomView:Se,originalTopFlipX:$,setOriginalTopFlipX:H,originalBottomFlipX:ae,setOriginalBottomFlipX:I,originalTopFlipY:oe,setOriginalTopFlipY:pe,originalBottomFlipY:Y,setOriginalBottomFlipY:X,cameraWorldCenter:F,setCameraWorldCenter:R,viewScale:U,viewRotation:O,setViewRotation:_e,viewFlipX:ce,setViewFlipX:xe,contentBorder:fe,setTransparency:ke})=>{const[de,C]=L.useState(null),[z,G]=L.useState(!1),V=L.useRef({x:0,y:0}),ie=L.useRef(null),he=L.useCallback((ot,Ct,Ot,se)=>{const kt=window.innerWidth,Jt=window.innerHeight,Wt=10,ht=Math.max(Wt,Math.min(ot,kt-Ot-Wt)),Xe=Math.max(Wt,Math.min(Ct,Jt-se-Wt));return{x:ht,y:Xe}},[]);L.useEffect(()=>{if(i&&de===null){const ot=localStorage.getItem("transformAllDialogPosition"),Ct=320,Ot=400,se=20,kt=150;let Jt;if(ot)try{const Wt=JSON.parse(ot);Jt=he(Wt.x,Wt.y,Ct,Ot)}catch{Jt=he(window.innerWidth-Ct-se,kt,Ct,Ot)}else Jt=he(window.innerWidth-Ct-se,kt,Ct,Ot);C(Jt)}},[i,de,he]);const re=L.useCallback(ot=>{if(ie.current){const Ct=ie.current.getBoundingClientRect();V.current={x:ot.clientX-Ct.left,y:ot.clientY-Ct.top},G(!0)}},[]);L.useEffect(()=>{if(!z)return;const ot=Ot=>{const se=Ot.clientX-V.current.x,kt=Ot.clientY-V.current.y,Jt=ie.current?.offsetWidth||320,Wt=ie.current?.offsetHeight||400,ht=he(se,kt,Jt,Wt);C(ht),localStorage.setItem("transformAllDialogPosition",JSON.stringify(ht))},Ct=()=>{G(!1)};return document.addEventListener("mousemove",ot),document.addEventListener("mouseup",Ct),()=>{document.removeEventListener("mousemove",ot),document.removeEventListener("mouseup",Ct)}},[z,he]);const Le=L.useCallback(()=>{w||(xe(!0),Se(!0),ke(100))},[w,xe,Se,ke]),Re=L.useCallback(()=>{w&&(xe(!1),Se(!1),ke(0))},[w,xe,Se,ke]),Ue=L.useCallback(ot=>{_e(Ct=>_g(Ct,ot))},[_e,_g]);if(!i)return null;const et=(ot=!1)=>({display:"block",width:"100%",textAlign:"left",padding:"8px 12px",color:ot?"#999":"#222",background:"transparent",border:"none",borderRadius:4,cursor:ot?"not-allowed":"pointer",fontSize:"13px",transition:"background 0.15s"});return n.jsxs("div",{ref:ie,style:{position:"fixed",top:de?.y??150,left:de?.x??window.innerWidth-340,backgroundColor:"#fff",borderRadius:8,minWidth:"320px",maxWidth:"400px",maxHeight:"calc(100vh - 100px)",overflowY:"auto",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:10001,display:"flex",flexDirection:"column"},children:[n.jsxs("div",{onMouseDown:re,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:z?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[n.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Change Perspective"}),n.jsx("button",{onClick:r,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),n.jsxs("div",{style:{padding:"20px",overflow:"auto",flex:1},children:[n.jsxs("div",{style:{marginBottom:"16px"},children:[n.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"8px",fontWeight:500},children:"View:"}),n.jsx("button",{onClick:w?Re:Le,style:et(!1),onMouseEnter:ot=>ot.currentTarget.style.background="#f0f0f0",onMouseLeave:ot=>ot.currentTarget.style.background="transparent",children:w?"Switch to Top View":"Switch to Bottom View"}),n.jsx("div",{style:{fontSize:"10px",color:"#999",marginTop:"6px",fontStyle:"italic"},children:"Shortcut: Shift-Left/Right Arrow Keys"})]}),n.jsx("div",{style:{height:1,background:"#e0e0e0",margin:"16px 0"}}),n.jsxs("div",{style:{marginBottom:"16px"},children:[n.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"8px",fontWeight:500},children:"Rotate (clockwise):"}),n.jsx("button",{onClick:()=>Ue(90),style:et(),onMouseEnter:ot=>ot.currentTarget.style.background="#f0f0f0",onMouseLeave:ot=>ot.currentTarget.style.background="transparent",children:"Rotate 90"}),n.jsx("button",{onClick:()=>Ue(180),style:et(),onMouseEnter:ot=>ot.currentTarget.style.background="#f0f0f0",onMouseLeave:ot=>ot.currentTarget.style.background="transparent",children:"Rotate 180"}),n.jsx("button",{onClick:()=>Ue(270),style:et(),onMouseEnter:ot=>ot.currentTarget.style.background="#f0f0f0",onMouseLeave:ot=>ot.currentTarget.style.background="transparent",children:"Rotate 270"}),n.jsx("div",{style:{fontSize:"10px",color:"#999",marginTop:"6px",fontStyle:"italic"},children:"Shortcut: Shift-Up/Down Arrow Keys"})]}),n.jsx("div",{style:{height:1,background:"#e0e0e0",margin:"16px 0"}}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:n.jsx("button",{onClick:r,style:{padding:"8px 16px",background:"#4a9eff",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:500},onMouseEnter:ot=>ot.currentTarget.style.background="#3a8ee6",onMouseLeave:ot=>ot.currentTarget.style.background="#4a9eff",children:"Close"})})]})]})},Ox=({visible:i,title:r,message:o,onClose:s,type:c="info",onShowResponse:d})=>{if(!i)return null;const v=c==="success"?"#4CAF50":"#2196F3",p=c==="success"?"#4CAF50":"#2196F3",g=c==="success"?"":"";return n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:m=>{m.target===m.currentTarget&&s()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"90vw",maxHeight:"90vh",width:"600px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:`2px solid ${p}`,display:"flex",flexDirection:"column"},onClick:m=>m.stopPropagation(),children:[n.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",gap:"12px",flexShrink:0},children:[n.jsx("div",{style:{fontSize:"24px",color:v},children:g}),n.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:r})]}),n.jsx("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"14px",lineHeight:"1.5",whiteSpace:"pre-wrap",wordWrap:"break-word",overflowY:"auto",maxHeight:"60vh",paddingRight:"8px",flex:1},children:o}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[d&&n.jsx("button",{onClick:()=>{d(),s()},style:{padding:"8px 16px",background:"#555",color:"#fff",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Show Response"}),n.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"OK"})]})]})})},Dv=({component:i,componentEditor:r,componentDefinition:o,setComponentEditor:s,areComponentsLocked:c,componentsTop:d,componentsBottom:v,setComponentsTop:p,setComponentsBottom:g,uploadedDatasheetFile:m,setUploadedDatasheetFile:S})=>{if(!i||!i.id||!i.componentType||typeof i.pinCount!="number")return console.error("[ComponentTypeFields] Component missing required properties:",{comp:i,hasId:!!i?.id,hasComponentType:!!i?.componentType,componentType:i?.componentType,pinCount:i?.pinCount,pinCountType:typeof i?.pinCount}),null;const E=(o||r?.componentDefinition||Cl(i))?.fields,T=i.componentType,K=T==="IntegratedCircuit"||T==="Semiconductor",D=T==="Semiconductor",ee=T==="IntegratedCircuit";if(E&&E.length>0&&!ee){const w=($,H,ae)=>ae?$==="capacitance"||$==="resistance"||$==="voltage"||$==="current"?"80px":$==="power"||$==="inductance"||$==="impedance"||$==="esr"||$==="ripple"||$==="leakageCurrent"?"70px":"80px":$==="tolerance"||$==="pinCount"?"60px":$==="partNumber"||$==="manufacturer"?"150px":$==="description"||$==="operatingTemperature"?"180px":H==="string"&&!$.includes("Unit")?"150px":"120px",Se=$=>{const H=i.componentType,ae=H==="IntegratedCircuit"||H==="Semiconductor";if(ae&&$.name==="datasheet"||ae&&($.name==="manufacturer"||$.name==="partNumber")||$.name==="description")return null;const I=$.name,oe=`${$.name}Unit`,pe=r[I]??i[I]??$.defaultValue??"",Y=r[oe]??i[oe]??($.units&&$.defaultUnit?$.defaultUnit:""),X=O=>{s({...r,[I]:O})},F=O=>{s({...r,[oe]:O})},R=!!($.units&&$.units.length>0),U=w($.name,$.type,R);return n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[n.jsxs("label",{style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:[$.label,":"]}),$.type==="enum"?n.jsx("select",{value:pe,onChange:O=>X(O.target.value),disabled:c,style:{width:U,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},children:($.enumValues||[]).map(O=>n.jsx("option",{value:O,children:O},O))}):n.jsx("input",{type:"text",value:pe,onChange:O=>X(O.target.value),disabled:c,style:{width:U,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:R?"8px":"0"},placeholder:$.defaultValue!==void 0?String($.defaultValue):""}),R&&$.units&&n.jsx("select",{value:Y||$.defaultUnit||$.units[0],onChange:O=>F(O.target.value),disabled:c,style:{width:"70px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,flexShrink:0},children:$.units.map(O=>n.jsx("option",{value:O,children:O},O))})]},$.name)};if(!D)return n.jsx(n.Fragment,{children:E.map(Se).filter(Boolean)})}return K?n.jsxs(n.Fragment,{children:[i.componentType==="Resistor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-resistance-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),n.jsx("input",{id:`component-resistance-${i.id}`,type:"text",value:r.resistance||"",onChange:w=>s({...r,resistance:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 10"}),n.jsx("select",{value:r.resistanceUnit||pn("resistance"),onChange:w=>s({...r,resistanceUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("resistance").map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-power-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),n.jsxs("select",{id:`component-power-${i.id}`,value:r.power||"1/4",onChange:w=>s({...r,power:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"12px"},children:[n.jsx("option",{value:"1/20",children:"1/20 W"}),n.jsx("option",{value:"1/16",children:"1/16 W"}),n.jsx("option",{value:"1/10",children:"1/10 W"}),n.jsx("option",{value:"1/8",children:"1/8 W"}),n.jsx("option",{value:"1/4",children:"1/4 W"}),n.jsx("option",{value:"1/2",children:"1/2 W"}),n.jsx("option",{value:"1",children:"1 W"}),n.jsx("option",{value:"2",children:"2 W"}),n.jsx("option",{value:"3",children:"3 W"}),n.jsx("option",{value:"5",children:"5 W"}),n.jsx("option",{value:"10",children:"10 W"}),n.jsx("option",{value:"25",children:"25 W"}),n.jsx("option",{value:"50",children:"50 W"}),n.jsx("option",{value:"100",children:"100 W"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-tolerance-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),n.jsxs("select",{id:`component-tolerance-${i.id}`,value:r.tolerance||"5%",onChange:w=>s({...r,tolerance:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"0.05%",children:"0.05%"}),n.jsx("option",{value:"0.1%",children:"0.1%"}),n.jsx("option",{value:"0.25%",children:"0.25%"}),n.jsx("option",{value:"0.5%",children:"0.5%"}),n.jsx("option",{value:"1%",children:"1%"}),n.jsx("option",{value:"2%",children:"2%"}),n.jsx("option",{value:"5%",children:"5%"}),n.jsx("option",{value:"10%",children:"10%"}),n.jsx("option",{value:"20%",children:"20%"})]})]})]}),i.componentType==="Capacitor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-capacitance-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),n.jsx("input",{id:`component-capacitance-${i.id}`,type:"text",value:r.capacitance||"",onChange:w=>s({...r,capacitance:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 100"}),n.jsx("select",{value:r.capacitanceUnit||pn("capacitance"),onChange:w=>s({...r,capacitanceUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("capacitance").map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${i.id}`,type:"text",value:r.voltage||"",onChange:w=>s({...r,voltage:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 50"}),n.jsx("select",{value:r.voltageUnit||pn("voltage"),onChange:w=>s({...r,voltageUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-dielectric-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Dielectric:"}),n.jsxs("select",{id:`component-dielectric-${i.id}`,value:r.dielectric||"Ceramic",onChange:w=>s({...r,dielectric:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Ceramic",children:"Ceramic"}),n.jsx("option",{value:"Tantalum",children:"Tantalum"}),n.jsx("option",{value:"Film",children:"Film"}),n.jsx("option",{value:"Polyester",children:"Polyester"}),n.jsx("option",{value:"Polypropylene",children:"Polypropylene"}),n.jsx("option",{value:"Mica",children:"Mica"}),n.jsx("option",{value:"Paper",children:"Paper"}),n.jsx("option",{value:"Glass",children:"Glass"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-tolerance-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),n.jsxs("select",{id:`component-tolerance-${i.id}`,value:r.tolerance||"10%",onChange:w=>s({...r,tolerance:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"0.5%",children:"0.5%"}),n.jsx("option",{value:"1%",children:"1%"}),n.jsx("option",{value:"2%",children:"2%"}),n.jsx("option",{value:"5%",children:"5%"}),n.jsx("option",{value:"10%",children:"10%"}),n.jsx("option",{value:"20%",children:"20%"})]})]})]}),i.componentType==="Film Capacitor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-capacitance-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),n.jsx("input",{id:`component-capacitance-${i.id}`,type:"text",value:r.capacitance||"",onChange:w=>s({...r,capacitance:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 100"}),n.jsx("select",{value:r.capacitanceUnit||pn("capacitance"),onChange:w=>s({...r,capacitanceUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("capacitance").map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${i.id}`,type:"text",value:r.voltage||"",onChange:w=>s({...r,voltage:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 50"}),n.jsx("select",{value:r.voltageUnit||pn("voltage"),onChange:w=>s({...r,voltageUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-filmtype-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Film Type:"}),n.jsxs("select",{id:`component-filmtype-${i.id}`,value:r.filmType||"Polyester",onChange:w=>s({...r,filmType:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Polyester",children:"Polyester"}),n.jsx("option",{value:"Polypropylene",children:"Polypropylene"}),n.jsx("option",{value:"Polyethylene",children:"Polyethylene"}),n.jsx("option",{value:"Polystyrene",children:"Polystyrene"}),n.jsx("option",{value:"Polycarbonate",children:"Polycarbonate"}),n.jsx("option",{value:"PTFE",children:"PTFE (Teflon)"}),n.jsx("option",{value:"PPS",children:"PPS (Polyphenylene Sulfide)"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-tolerance-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),n.jsxs("select",{id:`component-tolerance-${i.id}`,value:r.tolerance||"10%",onChange:w=>s({...r,tolerance:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"0.5%",children:"0.5%"}),n.jsx("option",{value:"1%",children:"1%"}),n.jsx("option",{value:"2%",children:"2%"}),n.jsx("option",{value:"5%",children:"5%"}),n.jsx("option",{value:"10%",children:"10%"}),n.jsx("option",{value:"20%",children:"20%"})]})]})]}),i.componentType==="Electrolytic Capacitor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-capacitance-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),n.jsx("input",{id:`component-capacitance-${i.id}`,type:"text",value:r.capacitance||"",onChange:w=>s({...r,capacitance:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 100"}),n.jsxs("select",{value:r.capacitanceUnit||"F",onChange:w=>s({...r,capacitanceUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:[n.jsx("option",{value:"pF",children:"pF"}),n.jsx("option",{value:"nF",children:"nF"}),n.jsx("option",{value:"F",children:"F"}),n.jsx("option",{value:"mF",children:"mF"}),n.jsx("option",{value:"F",children:"F"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${i.id}`,type:"text",value:r.voltage||"",onChange:w=>s({...r,voltage:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 25"}),n.jsx("select",{value:r.voltageUnit||pn("voltage"),onChange:w=>s({...r,voltageUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-tolerance-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),n.jsxs("select",{id:`component-tolerance-${i.id}`,value:r.tolerance||"20%",onChange:w=>s({...r,tolerance:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},children:[n.jsx("option",{value:"0.5%",children:"0.5%"}),n.jsx("option",{value:"1%",children:"1%"}),n.jsx("option",{value:"2%",children:"2%"}),n.jsx("option",{value:"5%",children:"5%"}),n.jsx("option",{value:"10%",children:"10%"}),n.jsx("option",{value:"20%",children:"20%"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-polarized-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Polarized:"}),n.jsx("input",{id:`component-polarized-${i.id}`,type:"checkbox",checked:Xf(i),disabled:!0,style:{opacity:.6,cursor:"not-allowed"},title:"Polarized is a fixed property determined by component type"})]})]}),i.componentType==="Inductor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-inductance-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Inductance:"}),n.jsx("input",{id:`component-inductance-${i.id}`,type:"text",value:r.inductance||"",onChange:w=>s({...r,inductance:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 10"}),n.jsx("select",{value:r.inductanceUnit||pn("inductance"),onChange:w=>s({...r,inductanceUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("inductance").map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${i.id}`,type:"text",value:r.current||"",onChange:w=>s({...r,current:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 1"}),n.jsx("select",{value:r.currentUnit||pn("current"),onChange:w=>s({...r,currentUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("current").map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-resistance-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"DC Resistance:"}),n.jsx("input",{id:`component-resistance-${i.id}`,type:"text",value:r.resistance||"",onChange:w=>s({...r,resistance:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 50"}),n.jsx("select",{value:r.resistanceUnit||"",onChange:w=>s({...r,resistanceUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("resistance").map(w=>n.jsx("option",{value:w,children:w},w))})]})]}),i.componentType==="Diode"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-diodetype-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Diode Type:"}),n.jsxs("select",{id:`component-diodetype-${i.id}`,value:r.diodeType||"Standard",onChange:w=>s({...r,diodeType:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Standard",children:"Standard"}),n.jsx("option",{value:"Zener",children:"Zener"}),n.jsx("option",{value:"LED",children:"LED"}),n.jsx("option",{value:"Schottky",children:"Schottky"}),n.jsx("option",{value:"Infrared",children:"Infrared"}),n.jsx("option",{value:"Photodiode",children:"Photodiode"}),n.jsx("option",{value:"Other",children:"Other"})]})]}),r.diodeType==="LED"&&n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-ledcolor-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"LED Color:"}),n.jsxs("select",{id:`component-ledcolor-${i.id}`,value:r.ledColor||"",onChange:w=>s({...r,ledColor:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"",children:"Select..."}),n.jsx("option",{value:"Red",children:"Red"}),n.jsx("option",{value:"Green",children:"Green"}),n.jsx("option",{value:"Blue",children:"Blue"}),n.jsx("option",{value:"Yellow",children:"Yellow"}),n.jsx("option",{value:"Orange",children:"Orange"}),n.jsx("option",{value:"White",children:"White"}),n.jsx("option",{value:"RGB",children:"RGB"}),n.jsx("option",{value:"IR",children:"IR (Infrared)"}),n.jsx("option",{value:"UV",children:"UV (Ultraviolet)"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${i.id}`,type:"text",value:r.voltage||"",onChange:w=>s({...r,voltage:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 50"}),n.jsx("select",{value:r.voltageUnit||pn("voltage"),onChange:w=>s({...r,voltageUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${i.id}`,type:"text",value:r.current||"",onChange:w=>s({...r,current:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 1"}),n.jsx("select",{value:r.currentUnit||pn("current"),onChange:w=>s({...r,currentUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("current").map(w=>n.jsx("option",{value:w,children:w},w))})]})]}),i.componentType==="Battery"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${i.id}`,type:"text",value:r.voltage||"",onChange:w=>s({...r,voltage:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 3.7"}),n.jsx("select",{value:r.voltageUnit||"V",onChange:w=>s({...r,voltageUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-capacity-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacity:"}),n.jsx("input",{id:`component-capacity-${i.id}`,type:"text",value:r.capacity||"",onChange:w=>s({...r,capacity:w.target.value}),disabled:c,style:{width:"120px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 2000mAh"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-chemistry-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Chemistry:"}),n.jsxs("select",{id:`component-chemistry-${i.id}`,value:r.chemistry||"Li-ion",onChange:w=>s({...r,chemistry:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Li-ion",children:"Li-ion"}),n.jsx("option",{value:"LiPo",children:"LiPo"}),n.jsx("option",{value:"NiMH",children:"NiMH"}),n.jsx("option",{value:"NiCd",children:"NiCd"}),n.jsx("option",{value:"Alkaline",children:"Alkaline"}),n.jsx("option",{value:"Lead-Acid",children:"Lead-Acid"}),n.jsx("option",{value:"Lithium",children:"Lithium"}),n.jsx("option",{value:"Zinc-Carbon",children:"Zinc-Carbon"})]})]})]}),i.componentType==="Fuse"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${i.id}`,type:"text",value:r.current||"",onChange:w=>s({...r,current:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 5"}),n.jsx("select",{value:r.currentUnit||"A",onChange:w=>s({...r,currentUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("current").map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${i.id}`,type:"text",value:r.voltage||"",onChange:w=>s({...r,voltage:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 250"}),n.jsx("select",{value:r.voltageUnit||"V",onChange:w=>s({...r,voltageUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-fusetype-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Fuse Type:"}),n.jsxs("select",{id:`component-fusetype-${i.id}`,value:r.fuseType||"Fast-blow",onChange:w=>s({...r,fuseType:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Fast-blow",children:"Fast-blow"}),n.jsx("option",{value:"Slow-blow",children:"Slow-blow"}),n.jsx("option",{value:"Time-delay",children:"Time-delay"}),n.jsx("option",{value:"Resettable",children:"Resettable"}),n.jsx("option",{value:"Cartridge",children:"Cartridge"}),n.jsx("option",{value:"Glass",children:"Glass"}),n.jsx("option",{value:"Ceramic",children:"Ceramic"})]})]})]}),i.componentType==="Relay"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-coilvoltage-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Coil Voltage:"}),n.jsx("input",{id:`component-coilvoltage-${i.id}`,type:"text",value:r.coilVoltage||"",onChange:w=>s({...r,coilVoltage:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 12"}),n.jsx("select",{value:r.coilVoltageUnit||pn("voltage"),onChange:w=>s({...r,coilVoltageUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-contacttype-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Contact Type:"}),n.jsxs("select",{id:`component-contacttype-${i.id}`,value:r.contactType||"SPST",onChange:w=>s({...r,contactType:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"SPST",children:"SPST (Single Pole Single Throw)"}),n.jsx("option",{value:"SPDT",children:"SPDT (Single Pole Double Throw)"}),n.jsx("option",{value:"DPST",children:"DPST (Double Pole Single Throw)"}),n.jsx("option",{value:"DPDT",children:"DPDT (Double Pole Double Throw)"}),n.jsx("option",{value:"3PDT",children:"3PDT (3 Pole Double Throw)"}),n.jsx("option",{value:"4PDT",children:"4PDT (4 Pole Double Throw)"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${i.id}`,type:"text",value:r.current||"",onChange:w=>s({...r,current:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 10"}),n.jsx("select",{value:r.currentUnit||pn("current"),onChange:w=>s({...r,currentUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("current").map(w=>n.jsx("option",{value:w,children:w},w))})]})]}),i.componentType==="Motor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-motortype-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Motor Type:"}),n.jsxs("select",{id:`component-motortype-${i.id}`,value:r.motorType||"DC",onChange:w=>s({...r,motorType:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"DC",children:"DC Motor"}),n.jsx("option",{value:"Stepper",children:"Stepper Motor"}),n.jsx("option",{value:"Servo",children:"Servo Motor"}),n.jsx("option",{value:"Brushless",children:"Brushless DC"}),n.jsx("option",{value:"AC",children:"AC Motor"}),n.jsx("option",{value:"Synchronous",children:"Synchronous"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${i.id}`,type:"text",value:r.voltage||"",onChange:w=>s({...r,voltage:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 12"}),n.jsx("select",{value:r.voltageUnit||pn("voltage"),onChange:w=>s({...r,voltageUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${i.id}`,type:"text",value:r.current||"",onChange:w=>s({...r,current:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 1"}),n.jsx("select",{value:r.currentUnit||pn("current"),onChange:w=>s({...r,currentUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("current").map(w=>n.jsx("option",{value:w,children:w},w))})]})]}),i.componentType==="Switch"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-switchtype-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Switch Type:"}),n.jsxs("select",{id:`component-switchtype-${i.id}`,value:r.switchType||"Toggle",onChange:w=>s({...r,switchType:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Toggle",children:"Toggle"}),n.jsx("option",{value:"Push-button",children:"Push-button"}),n.jsx("option",{value:"Slide",children:"Slide"}),n.jsx("option",{value:"Rotary",children:"Rotary"}),n.jsx("option",{value:"DIP",children:"DIP Switch"}),n.jsx("option",{value:"Momentary",children:"Momentary"}),n.jsx("option",{value:"Latching",children:"Latching"}),n.jsx("option",{value:"Reed",children:"Reed Switch"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${i.id}`,type:"text",value:r.current||"",onChange:w=>s({...r,current:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 5"}),n.jsx("select",{value:r.currentUnit||pn("current"),onChange:w=>s({...r,currentUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("current").map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${i.id}`,type:"text",value:r.voltage||"",onChange:w=>s({...r,voltage:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 250"}),n.jsx("select",{value:r.voltageUnit||pn("voltage"),onChange:w=>s({...r,voltageUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(w=>n.jsx("option",{value:w,children:w},w))})]})]}),i.componentType==="FerriteBead"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-impedance-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Impedance:"}),n.jsx("input",{id:`component-impedance-${i.id}`,type:"text",value:r.impedance||"",onChange:w=>s({...r,impedance:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 100"}),n.jsx("select",{value:r.impedanceUnit||pn("impedance"),onChange:w=>s({...r,impedanceUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("impedance").map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${i.id}`,type:"text",value:r.current||"",onChange:w=>s({...r,current:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 1"}),n.jsx("select",{value:r.currentUnit||pn("current"),onChange:w=>s({...r,currentUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("current").map(w=>n.jsx("option",{value:w,children:w},w))})]})]}),i.componentType==="Connector"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-connectortype-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Connector Type:"}),n.jsx("input",{id:`component-connectortype-${i.id}`,type:"text",value:r.connectorType||"",onChange:w=>s({...r,connectorType:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},placeholder:"e.g., USB-A, HDMI"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-gender-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Gender:"}),n.jsxs("select",{id:`component-gender-${i.id}`,value:r.gender||"N/A",onChange:w=>s({...r,gender:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Male",children:"Male"}),n.jsx("option",{value:"Female",children:"Female"}),n.jsx("option",{value:"N/A",children:"N/A"})]})]})]}),i.componentType==="Jumper"&&n.jsx(n.Fragment,{children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-positions-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Positions:"}),n.jsx("input",{id:`component-positions-${i.id}`,type:"number",min:"2",value:r.positions||3,onChange:w=>s({...r,positions:parseInt(w.target.value)||3}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"}})]})}),i.componentType==="Speaker"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-impedance-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Impedance:"}),n.jsx("input",{id:`component-impedance-${i.id}`,type:"text",value:r.impedance||"",onChange:w=>s({...r,impedance:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 8"}),n.jsx("select",{value:r.impedanceUnit||pn("impedance"),onChange:w=>s({...r,impedanceUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("impedance").map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-power-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),n.jsxs("select",{id:`component-power-${i.id}`,value:r.power||"1/4",onChange:w=>s({...r,power:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"12px"},children:[n.jsx("option",{value:"1/20",children:"1/20 W"}),n.jsx("option",{value:"1/16",children:"1/16 W"}),n.jsx("option",{value:"1/10",children:"1/10 W"}),n.jsx("option",{value:"1/8",children:"1/8 W"}),n.jsx("option",{value:"1/4",children:"1/4 W"}),n.jsx("option",{value:"1/2",children:"1/2 W"}),n.jsx("option",{value:"1",children:"1 W"}),n.jsx("option",{value:"2",children:"2 W"}),n.jsx("option",{value:"3",children:"3 W"}),n.jsx("option",{value:"5",children:"5 W"}),n.jsx("option",{value:"10",children:"10 W"}),n.jsx("option",{value:"25",children:"25 W"}),n.jsx("option",{value:"50",children:"50 W"}),n.jsx("option",{value:"100",children:"100 W"})]})]})]}),i.componentType==="PowerSupply"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-inputvoltage-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Input Voltage:"}),n.jsx("input",{id:`component-inputvoltage-${i.id}`,type:"text",value:r.inputVoltage||"",onChange:w=>s({...r,inputVoltage:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 120"}),n.jsx("select",{value:r.inputVoltageUnit||pn("voltage"),onChange:w=>s({...r,inputVoltageUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-outputvoltage-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Output Voltage:"}),n.jsx("input",{id:`component-outputvoltage-${i.id}`,type:"text",value:r.outputVoltage||"",onChange:w=>s({...r,outputVoltage:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 12"}),n.jsx("select",{value:r.outputVoltageUnit||pn("voltage"),onChange:w=>s({...r,outputVoltageUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${i.id}`,type:"text",value:r.current||"",onChange:w=>s({...r,current:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 1"}),n.jsx("select",{value:r.currentUnit||pn("current"),onChange:w=>s({...r,currentUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("current").map(w=>n.jsx("option",{value:w,children:w},w))})]})]}),i.componentType==="Transistor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-transistortype-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Transistor Type:"}),n.jsxs("select",{id:`component-transistortype-${i.id}`,value:r.transistorType||"BJT",onChange:w=>s({...r,transistorType:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"BJT",children:"BJT (Bipolar Junction Transistor)"}),n.jsx("option",{value:"FET",children:"FET (Field Effect Transistor)"}),n.jsx("option",{value:"MOSFET",children:"MOSFET"}),n.jsx("option",{value:"IGBT",children:"IGBT"}),n.jsx("option",{value:"JFET",children:"JFET"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-polarity-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Polarity:"}),n.jsxs("select",{id:`component-polarity-${i.id}`,value:r.polarity||"NPN",onChange:w=>s({...r,polarity:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"NPN",children:"NPN"}),n.jsx("option",{value:"PNP",children:"PNP"}),n.jsx("option",{value:"N-Channel",children:"N-Channel"}),n.jsx("option",{value:"P-Channel",children:"P-Channel"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${i.id}`,type:"text",value:r.voltage||"",onChange:w=>s({...r,voltage:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 50"}),n.jsx("select",{value:r.voltageUnit||pn("voltage"),onChange:w=>s({...r,voltageUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${i.id}`,type:"text",value:r.current||"",onChange:w=>s({...r,current:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 1"}),n.jsx("select",{value:r.currentUnit||pn("current"),onChange:w=>s({...r,currentUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("current").map(w=>n.jsx("option",{value:w,children:w},w))})]})]}),i.componentType==="ResistorNetwork"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-resistance-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),n.jsx("input",{id:`component-resistance-${i.id}`,type:"text",value:r.resistance||"",onChange:w=>s({...r,resistance:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 10"}),n.jsx("select",{value:r.resistanceUnit||pn("resistance"),onChange:w=>s({...r,resistanceUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("resistance").map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-configuration-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Configuration:"}),n.jsx("input",{id:`component-configuration-${i.id}`,type:"text",value:r.configuration||"",onChange:w=>s({...r,configuration:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},placeholder:"e.g., Isolated, Bussed"})]})]}),i.componentType==="Thermistor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-resistance-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),n.jsx("input",{id:`component-resistance-${i.id}`,type:"text",value:r.resistance||"",onChange:w=>s({...r,resistance:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 10"}),n.jsx("select",{value:r.resistanceUnit||pn("resistance"),onChange:w=>s({...r,resistanceUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("resistance").map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-thermistortype-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Thermistor Type:"}),n.jsxs("select",{id:`component-thermistortype-${i.id}`,value:r.thermistorType||"NTC",onChange:w=>s({...r,thermistorType:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"NTC",children:"NTC (Negative Temperature Coefficient)"}),n.jsx("option",{value:"PTC",children:"PTC (Positive Temperature Coefficient)"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-beta-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Beta ():"}),n.jsx("input",{id:`component-beta-${i.id}`,type:"text",value:r.beta||"",onChange:w=>s({...r,beta:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},placeholder:"e.g., 3950"})]})]}),i.componentType==="Transformer"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-primaryvoltage-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Primary Voltage:"}),n.jsx("input",{id:`component-primaryvoltage-${i.id}`,type:"text",value:r.primaryVoltage||"",onChange:w=>s({...r,primaryVoltage:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 120"}),n.jsx("select",{value:r.primaryVoltageUnit||pn("voltage"),onChange:w=>s({...r,primaryVoltageUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-secondaryvoltage-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Secondary Voltage:"}),n.jsx("input",{id:`component-secondaryvoltage-${i.id}`,type:"text",value:r.secondaryVoltage||"",onChange:w=>s({...r,secondaryVoltage:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 12"}),n.jsx("select",{value:r.secondaryVoltageUnit||pn("voltage"),onChange:w=>s({...r,secondaryVoltageUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-power-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),n.jsxs("select",{id:`component-power-${i.id}`,value:r.power||"1/4",onChange:w=>s({...r,power:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"12px"},children:[n.jsx("option",{value:"1/20",children:"1/20 W"}),n.jsx("option",{value:"1/16",children:"1/16 W"}),n.jsx("option",{value:"1/10",children:"1/10 W"}),n.jsx("option",{value:"1/8",children:"1/8 W"}),n.jsx("option",{value:"1/4",children:"1/4 W"}),n.jsx("option",{value:"1/2",children:"1/2 W"}),n.jsx("option",{value:"1",children:"1 W"}),n.jsx("option",{value:"2",children:"2 W"}),n.jsx("option",{value:"3",children:"3 W"}),n.jsx("option",{value:"5",children:"5 W"}),n.jsx("option",{value:"10",children:"10 W"}),n.jsx("option",{value:"25",children:"25 W"}),n.jsx("option",{value:"50",children:"50 W"}),n.jsx("option",{value:"100",children:"100 W"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-turns-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Turns Ratio:"}),n.jsx("input",{id:`component-turns-${i.id}`,type:"text",value:r.turns||"",onChange:w=>s({...r,turns:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},placeholder:"e.g., 10:1"})]})]}),i.componentType==="TestPoint"&&n.jsx(n.Fragment,{children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-signal-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Signal:"}),n.jsx("input",{id:`component-signal-${i.id}`,type:"text",value:r.signal||"",onChange:w=>s({...r,signal:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},placeholder:"e.g., VCC, GND, CLK"})]})}),(i.componentType==="IntegratedCircuit"||i.componentType==="Semiconductor")&&n.jsxs(n.Fragment,{children:[D&&E&&E.length>0&&(()=>{const w=(I,oe,pe)=>pe?"80px":I==="partNumber"||I==="manufacturer"?"150px":I==="description"||I==="operatingTemperature"?"180px":oe==="string"&&!I.includes("Unit")?"150px":"120px",Se=I=>{if(I.name==="datasheet"||I.name==="description"||I.name==="operatingTemperature"||D&&(I.name==="manufacturer"||I.name==="partNumber")||I.name==="icType"||D&&!I.name)return null;const oe=I.name,pe=`${I.name}Unit`,Y=r[oe]??i[oe]??I.defaultValue??"",X=r[pe]??i[pe]??(I.units&&I.defaultUnit?I.defaultUnit:""),F=_e=>{s({...r,[oe]:_e})},R=_e=>{s({...r,[pe]:_e})},U=!!(I.units&&I.units.length>0),O=w(I.name,I.type,U);return n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[n.jsxs("label",{style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:[I.label,":"]}),I.type==="enum"?n.jsx("select",{value:Y,onChange:_e=>F(_e.target.value),disabled:c,style:{width:O,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},children:(I.enumValues||[]).map(_e=>n.jsx("option",{value:_e,children:_e},_e))}):n.jsx("input",{type:"text",value:Y,onChange:_e=>F(_e.target.value),disabled:c,style:{width:O,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:U?"8px":"0"},placeholder:I.defaultValue!==void 0?String(I.defaultValue):""}),U&&I.units&&n.jsx("select",{value:X||I.defaultUnit||I.units[0],onChange:_e=>R(_e.target.value),disabled:c,style:{width:"70px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,flexShrink:0},children:I.units.map(_e=>n.jsx("option",{value:_e,children:_e},_e))})]},I.name)},$=E.map(Se).filter(Boolean),H=D?n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[n.jsx("label",{htmlFor:`component-ictype-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"IC Type:"}),n.jsxs("select",{id:`component-ictype-${i.id}`,value:r.icType||"Other",onChange:I=>s({...r,icType:I.target.value}),disabled:c,style:{width:"150px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Op-Amp",children:"Op-Amp"}),n.jsx("option",{value:"Microcontroller",children:"Microcontroller"}),n.jsx("option",{value:"Microprocessor",children:"Microprocessor"}),n.jsx("option",{value:"Logic",children:"Logic"}),n.jsx("option",{value:"Memory",children:"Memory"}),n.jsx("option",{value:"Voltage Regulator",children:"Voltage Regulator"}),n.jsx("option",{value:"Timer",children:"Timer"}),n.jsx("option",{value:"ADC",children:"ADC (Analog-to-Digital)"}),n.jsx("option",{value:"DAC",children:"DAC (Digital-to-Analog)"}),n.jsx("option",{value:"Comparator",children:"Comparator"}),n.jsx("option",{value:"Transceiver",children:"Transceiver"}),n.jsx("option",{value:"Driver",children:"Driver"}),n.jsx("option",{value:"Amplifier",children:"Amplifier"}),n.jsx("option",{value:"Other",children:"Other"})]})]},"icType"):null,ae=$.findIndex(I=>I?.key==="manufacturer");return ae>=0&&H?$.splice(ae+1,0,H):H&&$.push(H),$})(),ee&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[n.jsx("label",{htmlFor:`component-ictype-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"IC Type:"}),n.jsxs("select",{id:`component-ictype-${i.id}`,value:r.icType||"Other",onChange:w=>s({...r,icType:w.target.value}),disabled:c,style:{width:"150px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},children:[n.jsx("option",{value:"Op-Amp",children:"Op-Amp"}),n.jsx("option",{value:"Microcontroller",children:"Microcontroller"}),n.jsx("option",{value:"Microprocessor",children:"Microprocessor"}),n.jsx("option",{value:"Logic",children:"Logic"}),n.jsx("option",{value:"Memory",children:"Memory"}),n.jsx("option",{value:"Voltage Regulator",children:"Voltage Regulator"}),n.jsx("option",{value:"Timer",children:"Timer"}),n.jsx("option",{value:"ADC",children:"ADC (Analog-to-Digital)"}),n.jsx("option",{value:"DAC",children:"DAC (Digital-to-Analog)"}),n.jsx("option",{value:"Comparator",children:"Comparator"}),n.jsx("option",{value:"Transceiver",children:"Transceiver"}),n.jsx("option",{value:"Driver",children:"Driver"}),n.jsx("option",{value:"Amplifier",children:"Amplifier"}),n.jsx("option",{value:"Other",children:"Other"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[n.jsx("label",{htmlFor:`component-packagetype-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Package Type:"}),n.jsxs("select",{id:`component-packagetype-${i.id}`,value:r.packageType||"",onChange:w=>s({...r,packageType:w.target.value}),disabled:c,style:{width:"150px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},children:[n.jsx("option",{value:"",children:"-- Select --"}),n.jsx("option",{value:"DIP",children:"DIP"}),n.jsx("option",{value:"PDIP",children:"PDIP"}),n.jsx("option",{value:"SOIC",children:"SOIC"}),n.jsx("option",{value:"QFP",children:"QFP"}),n.jsx("option",{value:"LQFP",children:"LQFP"}),n.jsx("option",{value:"TQFP",children:"TQFP"}),n.jsx("option",{value:"BGA",children:"BGA"}),n.jsx("option",{value:"SSOP",children:"SSOP"}),n.jsx("option",{value:"TSOP",children:"TSOP"}),n.jsx("option",{value:"Various",children:"Various"}),n.jsx("option",{value:"Other",children:"Other"})]})]})]})]}),i.componentType==="VacuumTube"&&n.jsx(n.Fragment,{children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-tubetype-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tube Type:"}),n.jsx("input",{id:`component-tubetype-${i.id}`,type:"text",value:r.tubeType||"",onChange:w=>s({...r,tubeType:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},placeholder:"e.g., 12AX7, 6L6"})]})}),i.componentType==="VariableResistor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-vrtype-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"VR Type:"}),n.jsxs("select",{id:`component-vrtype-${i.id}`,value:r.vrType||"Potentiometer",onChange:w=>s({...r,vrType:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Potentiometer",children:"Potentiometer"}),n.jsx("option",{value:"Rheostat",children:"Rheostat"}),n.jsx("option",{value:"Trimmer",children:"Trimmer"}),n.jsx("option",{value:"Varistor",children:"Varistor"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-resistance-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),n.jsx("input",{id:`component-resistance-${i.id}`,type:"text",value:r.resistance||"",onChange:w=>s({...r,resistance:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 10"}),n.jsx("select",{value:r.resistanceUnit||pn("resistance"),onChange:w=>s({...r,resistanceUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("resistance").map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-power-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),n.jsxs("select",{id:`component-power-${i.id}`,value:r.power||"1/4",onChange:w=>s({...r,power:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"12px"},children:[n.jsx("option",{value:"1/20",children:"1/20 W"}),n.jsx("option",{value:"1/16",children:"1/16 W"}),n.jsx("option",{value:"1/10",children:"1/10 W"}),n.jsx("option",{value:"1/8",children:"1/8 W"}),n.jsx("option",{value:"1/4",children:"1/4 W"}),n.jsx("option",{value:"1/2",children:"1/2 W"}),n.jsx("option",{value:"1",children:"1 W"}),n.jsx("option",{value:"2",children:"2 W"}),n.jsx("option",{value:"3",children:"3 W"}),n.jsx("option",{value:"5",children:"5 W"}),n.jsx("option",{value:"10",children:"10 W"}),n.jsx("option",{value:"25",children:"25 W"}),n.jsx("option",{value:"50",children:"50 W"}),n.jsx("option",{value:"100",children:"100 W"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-taper-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Taper:"}),n.jsxs("select",{id:`component-taper-${i.id}`,value:r.taper||"Linear",onChange:w=>s({...r,taper:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Linear",children:"Linear"}),n.jsx("option",{value:"Logarithmic",children:"Logarithmic"}),n.jsx("option",{value:"Audio",children:"Audio"})]})]})]}),i.componentType==="Crystal"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-frequency-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Frequency:"}),n.jsx("input",{id:`component-frequency-${i.id}`,type:"text",value:r.frequency||"",onChange:w=>s({...r,frequency:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},placeholder:"e.g., 16.000 MHz"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-loadcapacitance-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Load Capacitance:"}),n.jsx("input",{id:`component-loadcapacitance-${i.id}`,type:"text",value:r.loadCapacitance||"",onChange:w=>s({...r,loadCapacitance:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},placeholder:"e.g., 18pF"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-tolerance-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),n.jsxs("select",{id:`component-tolerance-${i.id}`,value:r.tolerance||"10ppm",onChange:w=>s({...r,tolerance:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"10ppm",children:"10ppm"}),n.jsx("option",{value:"20ppm",children:"20ppm"}),n.jsx("option",{value:"30ppm",children:"30ppm"}),n.jsx("option",{value:"50ppm",children:"50ppm"}),n.jsx("option",{value:"100ppm",children:"100ppm"})]})]})]}),i.componentType==="GenericComponent"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-generictype-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Type:"}),n.jsxs("select",{id:`component-generictype-${i.id}`,value:i.genericType||"Attenuator",onChange:w=>s({...r,genericType:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Attenuator",children:"Attenuator"}),n.jsx("option",{value:"CircuitBreaker",children:"Circuit Breaker"}),n.jsx("option",{value:"Thermocouple",children:"Thermocouple"}),n.jsx("option",{value:"Tuner",children:"Tuner"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${i.id}`,type:"text",value:r.voltage||"",onChange:w=>s({...r,voltage:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 50"}),n.jsx("select",{value:r.voltageUnit||pn("voltage"),onChange:w=>s({...r,voltageUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(w=>n.jsx("option",{value:w,children:w},w))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${i.id}`,type:"text",value:r.current||"",onChange:w=>s({...r,current:w.target.value}),disabled:c,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1},placeholder:"e.g., 1"}),n.jsx("select",{value:r.currentUnit||pn("current"),onChange:w=>s({...r,currentUnit:w.target.value}),disabled:c,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,width:"60px",marginRight:"12px"},children:nr("current").map(w=>n.jsx("option",{value:w,children:w},w))})]}),i.genericType==="Tuner"&&n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-frequency-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Frequency:"}),n.jsx("input",{id:`component-frequency-${i.id}`,type:"text",value:r.frequency||"",onChange:w=>s({...r,frequency:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},placeholder:"e.g., 100MHz"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-power-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),n.jsx("input",{id:`component-power-${i.id}`,type:"text",value:r.power||"",onChange:w=>s({...r,power:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},placeholder:"e.g., 1W"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-model-${i.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Model:"}),n.jsx("input",{id:`component-model-${i.id}`,type:"text",value:r.model||"",onChange:w=>s({...r,model:w.target.value}),disabled:c,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:c?.6:1,marginRight:"8px"},placeholder:"Part number or model"})]})]})]}):n.jsx("div",{style:{padding:"8px",background:"#fff3cd",border:"1px solid #ffeeba",borderRadius:4,color:"#856404",marginBottom:"8px",fontSize:"11px"},children:"Component definition missing for this instance. Using legacy fields. Please ensure the component has a definition in componentDefinitions.json and a valid componentDefinitionKey."})},Fy=()=>{if(typeof window<"u"){const i=localStorage.getItem("geminiApiKey");if(i&&i.trim())return i.trim()}return null},Lv=()=>{if(typeof window<"u"){const i=localStorage.getItem("geminiModel");if(i)return i}return"gemini-2.5-flash-lite"},Mv=()=>{const i=Fy(),r=Lv();return i?`https://generativelanguage.googleapis.com/v1/models/${r}:generateContent?key=${i}`:null},Iv=i=>{const r=Yg[i];return!r||!r.prefix||r.prefix.length<1?"?":r.prefix[0].substring(0,1).toUpperCase()},Bv=({componentEditor:i,componentDefinition:r,setComponentEditor:o,componentsTop:s,componentsBottom:c,setComponentsTop:d,setComponentsBottom:v,connectingPin:p,setConnectingPin:g,componentDialogPosition:m,setComponentDialogPosition:S,isDraggingDialog:_,setIsDraggingDialog:E,dialogDragOffset:T,setDialogDragOffset:K,areComponentsLocked:D,setSelectedComponentIds:ee,setNotesDialogVisible:w,projectDirHandle:Se,showGeminiSettingsDialog:$=!1,onGeminiSettingsDialogClose:H,onFindComponent:ae})=>{const[I,oe]=L.useState(!1),[pe,Y]=L.useState(null),[X,F]=L.useState(!1),[R,U]=L.useState(!1),[O,_e]=L.useState(null),[ce,xe]=L.useState(!1),[fe,ke]=L.useState(!1),[de,C]=L.useState(""),[z,G]=L.useState(()=>typeof window<"u"&&localStorage.getItem("geminiApiKey")||""),[V,ie]=L.useState(()=>typeof window<"u"&&localStorage.getItem("geminiModel")||"gemini-2.5-flash-lite"),[he,re]=L.useState(()=>typeof window<"u"?!!localStorage.getItem("geminiApiKey"):!1);L.useEffect(()=>{if($){const Ee=setTimeout(()=>{U(!0)},0);return()=>clearTimeout(Ee)}},[$]),L.useEffect(()=>{typeof window<"u"&&re(!!localStorage.getItem("geminiApiKey")||!!z.trim())},[z]),L.useEffect(()=>{if(i){const Ne=(i.layer==="top"?s:c).find(Mt=>Mt.id===i.id);if(Ne){const Mt=Ne.customGeminiPrompt;C(Mt||"")}}},[i?.id,s,c]);const Le=()=>{z.trim()?(typeof window<"u"&&(localStorage.setItem("geminiApiKey",z.trim()),localStorage.setItem("geminiModel",V)),re(!0),ht({visible:!0,title:"API Key and Model Saved",message:`API key and model (${V}) saved! You can now use the "Extract Datasheet Information" feature.`,type:"success"})):(typeof window<"u"&&(localStorage.removeItem("geminiApiKey"),localStorage.setItem("geminiModel",V)),re(!1),ht({visible:!0,title:"API Key Removed",message:"API key removed. Model preference saved.",type:"info"}))},Re=()=>{typeof window<"u"&&localStorage.removeItem("geminiApiKey"),G(""),re(!1),ht({visible:!0,title:"API Key Removed",message:"API key has been removed from browser localStorage. You will need to enter it again to use AI features.",type:"info"})},Ue=()=>{const Ee=i?.designator?.trim().toUpperCase();if(!Ee)return;const Mt=[...s,...c].filter(_t=>_t.designator?.trim().toUpperCase()===Ee);if(Mt.length===0)return;if(ae&&Mt.length>0){const _t=Mt[0];ae(_t.id,_t.x,_t.y)}const ct=new Set(Mt.map(_t=>_t.id));ee(ct)},et=Ee=>`You are analyzing an electronic component datasheet PDF. Extract pin information, component properties, a datasheet summary, IC type, and pin count, then return the data as a JSON object.

Requirements:
1. Return a JSON object with three sections: "pins", "properties", and "summary"
2. First, determine the total number of pins (pinCount) for this component from the datasheet. This should be a positive integer representing the total number of pins/pads on the component.
3. For pins, extract information for ALL pins found in the datasheet (not just a subset). For each pin, provide:
   - pinNumber: The pin number (1, 2, 3, etc.)
   - pinName: The signal name (e.g., VCC, GND, IN+, OUT, etc.). Use the exact name from the datasheet.
   - pinDescription: A brief description of the pin's function (optional, can be empty string)
4. For component properties, extract the following information if available in the datasheet:
${Ee.map(Ne=>Ne.hasUnits?`   - ${Ne.name}: The ${Ne.label.toLowerCase()} value (as a number) and ${Ne.name}Unit: The unit (one of: ${Ne.units.join(", ")})`:Ne.type==="enum"?`   - ${Ne.name}: The ${Ne.label.toLowerCase()} (as a string)`:`   - ${Ne.name}: The ${Ne.label.toLowerCase()} (as a string or number, depending on the field type)`).join(`
`)}
5. For IC Type (icType), determine the type of integrated circuit from the datasheet. Choose from: "Op-Amp", "Microcontroller", "Microprocessor", "Logic", "Memory", "Voltage Regulator", "Timer", "ADC", "DAC", "Comparator", "Transceiver", "Driver", "Amplifier", or "Other". If it's clearly an op amp, use "Op-Amp". If it's clearly a microcontroller, use "Microcontroller", etc.
6. For Package Type (packageType), determine the package type from the datasheet. Choose from: "DIP", "PDIP", "SOIC", "QFP", "LQFP", "TQFP", "BGA", "SSOP", "TSOP", "Various", or "Other". If multiple package types are mentioned in the datasheet, use "Various". If it's a plastic DIP, use "PDIP". If it's a standard DIP, use "DIP".
7. For pin count (pinCount), determine the total number of pins/pads on the component from the datasheet. This should be a positive integer. Include this in the properties section.
8. For datasheet summary (datasheetSummary), provide a concise summary (2-4 sentences) of the introductory information from the datasheet, including what the component is, its main purpose, and key features mentioned in the introduction or overview section.
9. Only include properties that are actually found in the datasheet - do not make up values
10. For numeric fields with units, extract both the numeric value and the appropriate unit
11. Return ONLY valid JSON, no additional text, explanations, or markdown formatting

Example JSON format:
{
  "pins": [
    {"pinNumber": 1, "pinName": "VCC", "pinDescription": "Power supply positive"},
    {"pinNumber": 2, "pinName": "GND", "pinDescription": "Ground"},
    {"pinNumber": 3, "pinName": "IN+", "pinDescription": "Non-inverting input"},
    {"pinNumber": 4, "pinName": "IN-", "pinDescription": "Inverting input"},
    {"pinNumber": 5, "pinName": "OUT", "pinDescription": "Output"}
  ],
  "properties": {
    "partNumber": "LM358",
    "manufacturer": "Texas Instruments",
    "voltage": 36,
    "voltageUnit": "V",
    "description": "Dual operational amplifier",
    "icType": "Op-Amp",
    "packageType": "PDIP",
    "pinCount": 5
  },
  "summary": {
    "datasheetSummary": "The LM358 is a dual operational amplifier featuring low power consumption and wide supply voltage range. It is designed for single supply operation from 3V to 32V or dual supplies from 1.5V to 16V. The device offers high gain bandwidth product and low input offset voltage."
  }
}

Analyze the attached PDF datasheet and extract the information according to the requirements above.`,[ot,Ct]=L.useState(()=>{const Ee=localStorage.getItem("componentDialogSize");if(Ee)try{return JSON.parse(Ee)}catch{return{width:350,height:window.innerHeight*.4}}return{width:350,height:window.innerHeight*.4}}),[Ot,se]=L.useState(!1),[kt,Jt]=L.useState({x:0,y:0,width:0,height:0}),[Wt,ht]=L.useState({visible:!1,title:"",message:"",type:"info"}),Xe=Pt.useMemo(()=>{if(!i||!i.visible)return null;let Ee=s.find(Ne=>Ne.id===i.id);return Ee||(Ee=c.find(Ne=>Ne.id===i.id)),Ee||null},[i,s,c]);Pt.useEffect(()=>{if(!Xe){Y(null);return}const Ee=Xe.id,Ne=Xe.componentType,Mt=Xe.componentType;if(!Ne){console.error("[ComponentEditor useEffect] Component missing componentType:",{comp:Xe,componentId:Ee}),Y(null);return}if(Ne==="IntegratedCircuit"||Mt==="Semiconductor"){const ct=Xe;Y(null),i&&o({...i,datasheetFileName:ct.datasheetFileName||void 0})}else Y(null)},[Xe?.id,Xe?.componentType,Xe?.datasheetFileName]),L.useEffect(()=>{if(!Ot)return;const Ee=Mt=>{const ct=Mt.clientX-kt.x,_t=Mt.clientY-kt.y,Ze=Math.max(350,Math.min(window.innerWidth-20,kt.width+ct)),jt=Math.max(200,Math.min(window.innerHeight-20,kt.height+_t)),en={width:Ze,height:jt};Ct(en),localStorage.setItem("componentDialogSize",JSON.stringify(en))},Ne=()=>{se(!1)};return document.addEventListener("mousemove",Ee),document.addEventListener("mouseup",Ne),()=>{document.removeEventListener("mousemove",Ee),document.removeEventListener("mouseup",Ne)}},[Ot,kt]);const Ut=Ee=>{Ee.preventDefault(),Ee.stopPropagation(),se(!0),Jt({x:Ee.clientX,y:Ee.clientY,width:ot.width,height:ot.height})};if(!i||!i.visible)return n.jsxs(n.Fragment,{children:[R&&n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10005},onClick:Ee=>{Ee.target===Ee.currentTarget&&(U(!1),H?.())},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"500px",maxWidth:"600px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:Ee=>Ee.stopPropagation(),children:[n.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[n.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:"Google Gemini API Configuration"}),n.jsx("button",{onClick:()=>{U(!1),H?.()},style:{background:"transparent",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:0,width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center"},title:"Close",children:""})]}),n.jsxs("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"14px",lineHeight:"1.6"},children:[n.jsx("p",{style:{margin:"0 0 12px 0",fontWeight:600,color:"#fff"},children:"Benefits of Adding Your API Key:"}),n.jsxs("ul",{style:{margin:"0 0 16px 0",paddingLeft:"20px"},children:[n.jsx("li",{children:"Automatically extract pin names and component properties (voltage, current, temperature, etc.) from datasheet PDFs"}),n.jsx("li",{children:"Get datasheet summary for component notes"}),n.jsx("li",{children:"Save time by avoiding manual data entry"})]}),n.jsx("p",{style:{margin:"0 0 12px 0",fontWeight:600,color:"#fff"},children:"How to Get Your Free API Key:"}),n.jsxs("p",{style:{margin:"0 0 16px 0"},children:["Go to"," ",n.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",style:{color:"#4CAF50",textDecoration:"underline"},children:"Google AI Studio (aistudio.google.com/app/apikey)"}),', sign in with your Google account, and click "Get API key" or "Create API key" in the Dashboard to generate a key for a new or existing Google Cloud project, then copy it and paste it below.']}),n.jsxs("div",{style:{marginBottom:"12px"},children:[n.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#fff",fontSize:"13px",fontWeight:600},children:"Enter Your API Key:"}),n.jsx("input",{type:"password",value:z,onChange:Ee=>G(Ee.target.value),placeholder:"Paste your Gemini API key here",style:{width:"100%",padding:"8px 12px",fontSize:"13px",border:"1px solid #555",borderRadius:"4px",background:"#1f1f24",color:"#fff",boxSizing:"border-box"},autoFocus:!0})]}),n.jsxs("div",{style:{marginBottom:"12px"},children:[n.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#fff",fontSize:"13px",fontWeight:600},children:"Select Gemini Model:"}),n.jsxs("select",{value:V,onChange:Ee=>ie(Ee.target.value),style:{width:"100%",padding:"8px 12px",fontSize:"13px",border:"1px solid #555",borderRadius:"4px",background:"#1f1f24",color:"#fff",boxSizing:"border-box",cursor:"pointer"},children:[n.jsx("option",{value:"gemini-2.5-flash-lite",children:"gemini-2.5-flash-lite (Lightweight, Fast)"}),n.jsx("option",{value:"gemini-2.5-flash",children:"gemini-2.5-flash (Fast, Balanced)"}),n.jsx("option",{value:"gemini-2.5-pro",children:"gemini-2.5-pro (High Quality, Slower)"}),n.jsx("option",{value:"gemini-1.5-flash",children:"gemini-1.5-flash (Legacy Fast)"}),n.jsx("option",{value:"gemini-1.5-pro",children:"gemini-1.5-pro (Legacy High Quality)"})]}),n.jsx("p",{style:{margin:"6px 0 0 0",color:"#aaa",fontSize:"12px",lineHeight:"1.4"},children:"Choose the model based on your needs: Flash models are faster and use fewer tokens, while Pro models provide higher quality responses."})]}),n.jsxs("div",{style:{marginTop:"16px",padding:"12px",background:"#1f1f24",borderRadius:"4px",border:"1px solid #444"},children:[n.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#fff",fontSize:"13px"},children:"Storage & Security Information:"}),n.jsxs("p",{style:{margin:"0 0 8px 0",color:"#ddd",fontSize:"12px",lineHeight:"1.5"},children:["Your API key will be stored in your browser's ",n.jsx("strong",{children:"localStorage"})," under the key ",n.jsx("code",{style:{background:"#2b2b31",padding:"2px 4px",borderRadius:"2px",color:"#4CAF50"},children:"'geminiApiKey'"}),"."]}),n.jsx("p",{style:{margin:"0 0 8px 0",color:"#ffaa00",fontSize:"12px",lineHeight:"1.5",fontWeight:600},children:" Security Warnings:"}),n.jsxs("ul",{style:{margin:"0 0 8px 0",paddingLeft:"20px",color:"#ddd",fontSize:"12px",lineHeight:"1.5"},children:[n.jsx("li",{children:"localStorage is accessible via browser DevTools"}),n.jsx("li",{children:"Do not use on shared or public computers"}),n.jsx("li",{children:"Malicious browser extensions could access your key"}),n.jsx("li",{children:"XSS attacks could potentially read your key"}),n.jsx("li",{children:"The key is stored in plain text (not encrypted)"})]}),n.jsx("p",{style:{margin:"0",color:"#aaa",fontSize:"11px",lineHeight:"1.4",fontStyle:"italic"},children:"For maximum security, consider using API key restrictions in Google Cloud Console and regularly rotating your keys."})]})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"8px"},children:[n.jsx("button",{onClick:Re,disabled:!he,style:{padding:"8px 16px",background:he?"#d32f2f":"#444",color:"#fff",border:"1px solid #666",borderRadius:6,cursor:he?"pointer":"not-allowed",fontSize:"14px",fontWeight:600,opacity:he?1:.5},title:he?"Remove API key from browser localStorage":"No API key stored",children:"Remove API Key"}),n.jsxs("div",{style:{display:"flex",gap:"8px"},children:[n.jsx("button",{onClick:()=>{U(!1),H?.()},style:{padding:"8px 16px",background:"#555",color:"#fff",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Cancel"}),n.jsx("button",{onClick:()=>{Le(),U(!1),H?.()},style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Save API Key"})]})]})]})}),n.jsx(Ox,{visible:Wt.visible,title:Wt.title,message:Wt.message,type:Wt.type,onClose:()=>{ht({visible:!1,title:"",message:"",type:"info"})},onShowResponse:Wt.onShowResponse})]});if(!Xe)return console.error("[ComponentEditor] Component not found:",{componentId:i.id,componentsTopCount:s.length,componentsBottomCount:c.length}),null;if(!Xe.id||!Xe.componentType||typeof Xe.pinCount!="number")return console.error("[ComponentEditor] Component missing required properties:",{componentId:Xe.id,hasComponentType:!!Xe.componentType,componentType:Xe.componentType,pinCount:Xe.pinCount,pinCountType:typeof Xe.pinCount,component:Xe}),null;let an="top";s.find(Ee=>Ee.id===i.id)||(an="bottom"),i.layer!==an&&o({...i,layer:an});const Ht=Ee=>{const Ne={...Ee};console.log("[ComponentEditor] updateComponent - Entry:",{componentId:Ee.id,componentType:Ee.componentType});const Mt=i.designator?.trim()||"";Ne.designator=Mt,Ne.x=i.x,Ne.y=i.y,Ne.layer=i.layer,Ne.orientation=i.orientation??0;const ct=Mt.length>0?Mt.charAt(0).toUpperCase():Iv(Ee.componentType);if(Ne.abbreviation=ct,i.manufacturer!==void 0&&(Ne.manufacturer=i.manufacturer?.trim()||void 0),i.partNumber!==void 0&&(Ne.partNumber=i.partNumber?.trim()||void 0),i.pinCount!==Ee.pinCount){Ne.pinCount=i.pinCount;const _t=Ee.pinConnections||[];if(Ne.pinConnections=new Array(i.pinCount).fill("").map((Ze,jt)=>jt<_t.length?_t[jt]:""),Ee.pinPolarities){const Ze=Ee.pinPolarities||[];Ne.pinPolarities=new Array(i.pinCount).fill("").map((jt,en)=>en<Ze.length?Ze[en]:"")}if(Ee.pinNames){const Ze=Ee.pinNames||[];Ne.pinNames=new Array(i.pinCount).fill("").map((jt,en)=>en<Ze.length?Ze[en]:"")}}else Ne.pinConnections=Ee.pinConnections||[],Ee.pinPolarities&&(Ne.pinPolarities=Ee.pinPolarities),Ee.pinNames&&(Ne.pinNames=Ee.pinNames);return Ee.componentType==="Resistor"?(Ne.resistance=i.resistance||void 0,Ne.resistanceUnit=i.resistanceUnit||void 0,Ne.power=i.power?`${i.power}W`:void 0,Ne.tolerance=i.tolerance||void 0):Ee.componentType==="Capacitor"?(Ne.capacitance=i.capacitance||void 0,Ne.capacitanceUnit=i.capacitanceUnit||void 0,Ne.voltage=i.voltage||void 0,Ne.voltageUnit=i.voltageUnit||void 0,Ne.tolerance=i.tolerance||void 0,Ne.dielectric=i.dielectric||void 0):Ee.componentType==="Electrolytic Capacitor"?(Ne.capacitance=i.capacitance||void 0,Ne.capacitanceUnit=i.capacitanceUnit||void 0,Ne.voltage=i.voltage||void 0,Ne.voltageUnit=i.voltageUnit||void 0,Ne.tolerance=i.tolerance||void 0,Ne.esr=i.esr||void 0,Ne.esrUnit=i.esrUnit||void 0,Ne.temperature=i.temperature||void 0):Ee.componentType==="Film Capacitor"?(Ne.capacitance=i.capacitance||void 0,Ne.capacitanceUnit=i.capacitanceUnit||void 0,Ne.voltage=i.voltage||void 0,Ne.voltageUnit=i.voltageUnit||void 0,Ne.tolerance=i.tolerance||void 0,Ne.filmType=i.filmType||void 0):Ee.componentType==="Diode"?(Ne.diodeType=i.diodeType||Ee.diodeType||"Standard",Ne.voltage=i.voltage||void 0,Ne.voltageUnit=i.voltageUnit||void 0,Ne.current=i.current||void 0,Ne.currentUnit=i.currentUnit||void 0,Ne.ledColor=i.ledColor||void 0):Ee.componentType==="Battery"?(Ne.voltage=i.voltage||void 0,Ne.voltageUnit=i.voltageUnit||void 0,Ne.capacity=i.capacity||void 0,Ne.capacityUnit=i.capacityUnit||void 0,Ne.chemistry=i.chemistry||void 0):Ee.componentType==="Fuse"?(Ne.current=i.current||void 0,Ne.currentUnit=i.currentUnit||void 0,Ne.voltage=i.voltage||void 0,Ne.voltageUnit=i.voltageUnit||void 0,Ne.fuseType=i.fuseType||void 0):Ee.componentType==="FerriteBead"?(Ne.impedance=i.impedance||void 0,Ne.impedanceUnit=i.impedanceUnit||void 0,Ne.current=i.current||void 0,Ne.currentUnit=i.currentUnit||void 0):Ee.componentType==="Connector"?(Ne.connectorType=i.connectorType||void 0,Ne.gender=i.gender||void 0):Ee.componentType==="Jumper"?Ne.positions=i.positions||void 0:Ee.componentType==="Relay"?(Ne.coilVoltage=i.coilVoltage||void 0,Ne.coilVoltageUnit=i.coilVoltageUnit||void 0,Ne.contactType=i.contactType||void 0,Ne.current=i.current||void 0,Ne.currentUnit=i.currentUnit||void 0):Ee.componentType==="Inductor"?(Ne.inductance=i.inductance||void 0,Ne.inductanceUnit=i.inductanceUnit||void 0,Ne.current=i.current||void 0,Ne.currentUnit=i.currentUnit||void 0,Ne.resistance=i.resistance||void 0,Ne.resistanceUnit=i.resistanceUnit||void 0):Ee.componentType==="Speaker"?(Ne.impedance=i.impedance||void 0,Ne.impedanceUnit=i.impedanceUnit||void 0,Ne.power=i.power?`${i.power}W`:void 0):Ee.componentType==="Motor"?(Ne.motorType=i.motorType||void 0,Ne.voltage=i.voltage||void 0,Ne.voltageUnit=i.voltageUnit||void 0,Ne.current=i.current||void 0,Ne.currentUnit=i.currentUnit||void 0):Ee.componentType==="PowerSupply"?(Ne.inputVoltage=i.inputVoltage||void 0,Ne.inputVoltageUnit=i.inputVoltageUnit||void 0,Ne.outputVoltage=i.outputVoltage||void 0,Ne.outputVoltageUnit=i.outputVoltageUnit||void 0,Ne.current=i.current||void 0,Ne.currentUnit=i.currentUnit||void 0):Ee.componentType==="Transistor"?(Ne.transistorType=i.transistorType||void 0,Ne.polarity=i.polarity||void 0,Ne.voltage=i.voltage||void 0,Ne.voltageUnit=i.voltageUnit||void 0,Ne.current=i.current||void 0,Ne.currentUnit=i.currentUnit||void 0):Ee.componentType==="ResistorNetwork"?(Ne.resistance=i.resistance||void 0,Ne.resistanceUnit=i.resistanceUnit||void 0,Ne.configuration=i.configuration||void 0):Ee.componentType==="Thermistor"?(Ne.resistance=i.resistance||void 0,Ne.resistanceUnit=i.resistanceUnit||void 0,Ne.thermistorType=i.thermistorType||void 0,Ne.beta=i.beta||void 0):Ee.componentType==="Switch"?(Ne.switchType=i.switchType||void 0,Ne.current=i.current||void 0,Ne.currentUnit=i.currentUnit||void 0,Ne.voltage=i.voltage||void 0,Ne.voltageUnit=i.voltageUnit||void 0):Ee.componentType==="Transformer"?(Ne.primaryVoltage=i.primaryVoltage||void 0,Ne.primaryVoltageUnit=i.primaryVoltageUnit||void 0,Ne.secondaryVoltage=i.secondaryVoltage||void 0,Ne.secondaryVoltageUnit=i.secondaryVoltageUnit||void 0,Ne.power=i.power?`${i.power}W`:void 0,Ne.turns=i.turns||void 0):Ee.componentType==="TestPoint"?Ne.signal=i.signal||void 0:Ee.componentType==="Film Capacitor"?(Ne.capacitance=i.capacitance||void 0,Ne.capacitanceUnit=i.capacitanceUnit||void 0,Ne.voltage=i.voltage||void 0,Ne.voltageUnit=i.voltageUnit||void 0,Ne.tolerance=i.tolerance||void 0,Ne.filmType=i.filmType||void 0):Ee.componentType==="IntegratedCircuit"||Ee.componentType==="Semiconductor"?(Ne.description=i.description?.trim()||void 0,Ee.componentType==="Semiconductor"&&(Ne.componentType="IntegratedCircuit"),Ne.icType=i.icType||void 0,Ne.manufacturer=i.manufacturer?.trim()||void 0,Ne.partNumber=i.partNumber?.trim()||void 0,Ne.operatingTemperature=i.operatingTemperature?.trim()||void 0,Ne.packageType=i.packageType||void 0,i.datasheetFileName?Ne.datasheetFileName=i.datasheetFileName:Ne.datasheetFileName=void 0):Ne.description=i.description?.trim()||void 0,Ee.componentType==="VacuumTube"?Ne.tubeType=i.tubeType||void 0:Ee.componentType==="VariableResistor"?(Ne.vrType=i.vrType||void 0,Ne.resistance=i.resistance||void 0,Ne.resistanceUnit=i.resistanceUnit||void 0,Ne.power=i.power?`${i.power}W`:void 0,Ne.taper=i.taper||void 0):Ee.componentType==="Crystal"?(Ne.frequency=i.frequency||void 0,Ne.loadCapacitance=i.loadCapacitance||void 0,Ne.tolerance=i.tolerance||void 0):Ee.componentType==="GenericComponent"&&(Ne.genericType=i.genericType||"Attenuator",Ne.voltage=i.voltage||void 0,Ne.voltageUnit=i.voltageUnit||void 0,Ne.current=i.current||void 0,Ne.currentUnit=i.currentUnit||void 0,Ne.power=i.power||void 0,Ne.frequency=i.frequency||void 0,Ne.model=i.model||void 0),Ne},Nn=()=>{if(D){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const Ee=s.find(ct=>ct.id===i.id),Ne=c.find(ct=>ct.id===i.id),Mt=Ee||Ne;if(Mt){Mt.componentType==="IntegratedCircuit"&&console.log("[ComponentEditor] handleSave - Before updateComponent call:",{componentDatasheet:Mt.datasheet,editorDatasheet:i.datasheet,editorDatasheetType:typeof i.datasheet,editorDatasheetLength:i.datasheet?.length,fullEditor:i});const ct=Ht(Mt);Mt.componentType==="IntegratedCircuit"&&console.log("[ComponentEditor] handleSave - After updateComponent call:",{updatedComponentDatasheet:ct.datasheet,updatedComponentDatasheetType:typeof ct.datasheet});const _t=Mt.layer,Ze=i.layer;_t!==Ze?_t==="top"?(d(jt=>jt.filter(en=>en.id!==i.id)),v(jt=>[...jt,ct])):(v(jt=>jt.filter(en=>en.id!==i.id)),d(jt=>[...jt,ct])):Ze==="top"?d(jt=>{const en=jt.map(At=>At.id===i.id?(console.log("[ComponentEditor] Updating component in top array - datasheet:",ct.datasheet),ct):At),Qe=en.find(At=>At.id===i.id);return Qe&&Qe.componentType==="IntegratedCircuit"&&console.log("[ComponentEditor] After state update - component datasheet in array:",Qe.datasheet),en}):v(jt=>{const en=jt.map(At=>At.id===i.id?(console.log("[ComponentEditor] Updating component in bottom array - datasheet:",ct.datasheet),ct):At),Qe=en.find(At=>At.id===i.id);return Qe&&Qe.componentType==="IntegratedCircuit"&&console.log("[ComponentEditor] After state update - component datasheet in array:",Qe.datasheet),en})}else if(console.warn(`Component ${i.id} not found in either layer array`),i.layer==="top"){const ct=c.find(_t=>_t.id===i.id);if(ct){const _t=Ht(ct);v(Ze=>Ze.filter(jt=>jt.id!==i.id)),d(Ze=>[...Ze,_t])}}else{const ct=s.find(_t=>_t.id===i.id);if(ct){const _t=Ht(ct);d(Ze=>Ze.filter(jt=>jt.id!==i.id)),v(Ze=>[...Ze,_t])}}o(null),g(null)},zn=async()=>{const Ee=Fy(),Ne=Mv();if(!Ee||!Ne){U(!0);return}const Mt=Xe?.datasheetFileName;if(!pe&&(!Se||!Mt)){ht({visible:!0,title:"Datasheet Required",message:"Please choose a datasheet file before extracting information.",type:"info"});return}oe(!0);try{let ct,_t;if(pe)ct=await pe.arrayBuffer(),_t=pe.size;else if(Se&&Mt){const Et=Mt.split("/");let Bt=Se;for(let Wn=0;Wn<Et.length-1;Wn++){const qi=Et[Wn];try{Bt=await Bt.getDirectoryHandle(qi)}catch{const yt=qi==="datasheets"?"Datasheets":qi==="Datasheets"?"datasheets":qi;try{Bt=await Bt.getDirectoryHandle(yt)}catch{throw new Error(`Directory '${qi}' not found in project folder.`)}}}const on=await(await Bt.getFileHandle(Et[Et.length-1])).getFile();ct=await on.arrayBuffer(),_t=on.size}else throw new Error("No datasheet file available");const Ze=20*1024*1024;if(_t>Ze){const Et=(_t/1048576).toFixed(2);throw new Error(`PDF file is too large (${Et} MB). Maximum file size is 20 MB. Please use a smaller file or split the datasheet.`)}const jt=await new Promise((Et,Bt)=>{const Zt=new Blob([ct],{type:"application/pdf"}),on=new FileReader;on.onloadend=()=>{const qi=on.result.split(",")[1];if(!qi){Bt(new Error("Failed to extract base64 data from FileReader result"));return}Et(qi)},on.onerror=()=>Bt(new Error("FileReader failed to read PDF file")),on.readAsDataURL(Zt)}),Qe=(i.layer==="top"?s:c).find(Et=>Et.id===i.id);if(!Qe)throw new Error("Component not found");const xn=((r||Cl(Qe))?.fields||[]).filter(Et=>Et.name!=="datasheet").map(Et=>({name:Et.name,label:Et.label,type:Et.type,hasUnits:!!(Et.units&&Et.units.length>0),units:Et.units||[]}));let Kt;const Qt=Qe.customGeminiPrompt;Qt&&Qt.trim()?Kt=Qt:Kt=et(xn);const hn=await fetch(Ne,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:Kt},{inlineData:{mimeType:"application/pdf",data:jt}}]}]})});if(!hn.ok){const Et=await hn.text();let Bt=`Gemini API error: ${hn.status} ${hn.statusText}`;try{const Zt=JSON.parse(Et);if(Zt.error&&Zt.error.message){let on=Zt.error.message;on.length>500&&(on=on.replace(/"([A-Za-z0-9+/]{100,})"/g,(Wn,qi)=>`"[Base64 data truncated - ${qi.length} characters]"`)),Bt+=`.

${on}`}if(Zt.error&&Zt.error.details){let on=JSON.stringify(Zt.error.details,null,2);on=on.replace(/"([A-Za-z0-9+/]{100,})"/g,(Wn,qi)=>`"[Base64 data truncated - ${qi.length} characters]"`),Bt+=`

Details:
${on}`}}catch{Et.length>1e3?Bt+=`.

${Et.substring(0,1e3)}... [truncated]`:Bt+=`.

${Et}`}throw new Error(Bt)}const Xn=await hn.json();let rt="";if(Xn.candidates&&Xn.candidates[0]){if(Xn.candidates[0].finishReason&&Xn.candidates[0].finishReason!=="STOP")throw new Error(`Gemini API response blocked: ${Xn.candidates[0].finishReason}`);if(Xn.candidates[0].content&&Xn.candidates[0].content.parts){const Et=Xn.candidates[0].content.parts;Et&&Et[0]&&Et[0].text&&(rt=Et[0].text.trim())}}if(!rt)throw _e(null),new Error("No response text from Gemini API. The API may have returned an empty response.");_e(rt),rt=rt.replace(/^```[\w]*\n?/gm,"").replace(/\n?```$/gm,"");let Lt;try{Lt=JSON.parse(rt)}catch(Et){throw new Error(`Failed to parse JSON response from Gemini API: ${Et instanceof Error?Et.message:"Unknown error"}`)}if(!Lt||typeof Lt!="object")throw new Error("Invalid JSON response from Gemini API: expected an object");let Zn=i.pinCount;if(Lt.properties&&typeof Lt.properties=="object"&&Lt.properties.pinCount){const Et=parseInt(String(Lt.properties.pinCount),10);!isNaN(Et)&&Et>0&&(Zn=Et)}else if(Lt.pins&&Array.isArray(Lt.pins)){let Et=0;for(const Bt of Lt.pins)if(Bt&&typeof Bt=="object"&&Bt.pinNumber){const Zt=parseInt(String(Bt.pinNumber),10);!isNaN(Zt)&&Zt>Et&&(Et=Zt)}Et>0&&(Zn=Et)}const In=new Array(Zn).fill("");let wr=0;if(Lt.pins&&Array.isArray(Lt.pins)){for(const Et of Lt.pins)if(Et&&typeof Et=="object"&&Et.pinNumber&&Et.pinName){const Bt=parseInt(String(Et.pinNumber),10);!isNaN(Bt)&&Bt>=1&&Bt<=Zn&&(In[Bt-1]=String(Et.pinName).trim(),wr++)}}if(wr===0)throw new Error("Could not parse any pin information from the JSON response.");const Zi={...i};let Yt=0;const jn=[];if(Zn!==i.pinCount&&(Zi.pinCount=Zn,jn.push({label:"Pin Count",value:String(Zn)}),Yt++),Lt.properties&&typeof Lt.properties=="object"){const Et=Lt.properties;for(const Bt of xn)if(Et.hasOwnProperty(Bt.name)){const Zt=Et[Bt.name];if(Zt!=null&&Zt!==""){let on="";if(Bt.hasUnits){Zi[Bt.name]=String(Zt);const Wn=`${Bt.name}Unit`;let qi="";if(Et.hasOwnProperty(Wn)){const Sr=String(Et[Wn]).trim();Bt.units.includes(Sr)?(Zi[Wn]=Sr,qi=Sr):Bt.units.length>0&&(Zi[Wn]=Bt.units[0],qi=Bt.units[0])}else Bt.units.length>0&&(Zi[Wn]=Bt.units[0],qi=Bt.units[0]);on=`${Zt} ${qi}`.trim()}else Zi[Bt.name]=String(Zt),on=String(Zt);jn.push({label:Bt.label,value:on}),Yt++}}if(Et.hasOwnProperty("icType")&&Et.icType){const Bt=String(Et.icType).trim();["Op-Amp","Microcontroller","Microprocessor","Logic","Memory","Voltage Regulator","Timer","ADC","DAC","Comparator","Transceiver","Driver","Amplifier","Other"].includes(Bt)&&(Zi.icType=Bt,jn.push({label:"IC Type",value:Bt}),Yt++)}if(Et.hasOwnProperty("packageType")&&Et.packageType){const Bt=String(Et.packageType).trim(),Zt=["DIP","PDIP","SOIC","QFP","LQFP","TQFP","BGA","SSOP","TSOP","Various","Other"];let on=Bt;if(Bt.toUpperCase()==="PDIP"||Bt.toUpperCase()==="DIP")Bt.includes(",")||Bt.includes(" or ")||Bt.includes(" and ")?on="Various":Bt.toUpperCase().includes("PDIP")?on="PDIP":on="DIP";else if(Zt.includes(Bt))on=Bt;else if(Bt.includes(",")||Bt.includes(" or ")||Bt.includes(" and "))on="Various";else{const Wn=Bt.toUpperCase();Wn.includes("LQFP")?on="LQFP":Wn.includes("TQFP")?on="TQFP":Wn.includes("QFP")?on="QFP":Wn.includes("SOIC")?on="SOIC":Wn.includes("BGA")?on="BGA":Wn.includes("SSOP")?on="SSOP":Wn.includes("TSOP")?on="TSOP":on="Other"}(Zt.includes(on)||on==="Various")&&(Zi.packageType=on,jn.push({label:"Package Type",value:on}),Yt++)}}let ci="";if(Lt.summary&&typeof Lt.summary=="object"&&Lt.summary.datasheetSummary&&(ci=String(Lt.summary.datasheetSummary).trim(),ci)){Zi.notes=ci;const Et=ci.length>100?ci.substring(0,100)+"...":ci;jn.push({label:"Notes",value:Et}),Yt++}if(o(Zi),Qe){const Et=Qe.pinConnections||[],Bt=new Array(Zn).fill("").map((On,Ri)=>Ri<Et.length?Et[Ri]:""),Zt=Qe.pinPolarities||[],on=new Array(Zn).fill("").map((On,Ri)=>Ri<Zt.length?Zt[Ri]:""),Wn=[...In];for(;Wn.length<Zn;)Wn.push("");const qi={...Qe,pinNames:Wn,pinCount:Zn,pinConnections:Bt,pinPolarities:on,...ci&&{notes:ci}};i.layer==="top"?d(On=>On.map(Ri=>Ri.id===i.id?qi:Ri)):v(On=>On.map(Ri=>Ri.id===i.id?qi:Ri));const Sr=In.filter(On=>On.length>0).length;let yt=`Extracted ${Sr} pin name${Sr!==1?"s":""}`;Zn!==i.pinCount&&(yt+=" and pin count"),Yt>0&&(yt+=` and ${Yt} propert${Yt===1?"y":"ies"}`),yt+=" from datasheet.",jn.length>0&&(yt+=`

Extracted Properties:`,jn.forEach(On=>{yt+=`
   ${On.label}: ${On.value}`}));const si=[];In.forEach((On,Ri)=>{On&&On.trim()&&si.push(`Pin ${Ri+1}: ${On.trim()}`)}),si.length>0&&(yt+=`

Pin Names:`,yt+=`
  `+si.join(", ")),ht({visible:!0,title:"Extraction Complete",message:yt,type:"success"}),_e(null)}}catch(ct){console.error("Error fetching pin names:",ct),ht({visible:!0,title:"Extraction Failed",message:`Failed to extract information: ${ct instanceof Error?ct.message:"Unknown error"}. Please enter pin names manually.`,type:"info",onShowResponse:O?()=>xe(!0):void 0})}finally{oe(!1)}};return n.jsxs(n.Fragment,{children:[n.jsx("style",{children:`
        @keyframes heartbeat {
          0%, 100% {
            transform: scale(1);
            box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.8);
          }
          50% {
            transform: scale(1.15);
            box-shadow: 0 0 0 8px rgba(76, 175, 80, 0);
          }
        }
        .fetch-pin-names-pulse {
          animation: heartbeat 0.8s ease-in-out infinite;
        }
      `}),n.jsxs("div",{"data-component-editor-dialog":!0,onClick:Ee=>{if(p&&p.componentId===Xe.id){const Ne=Ee.target;(Ne.tagName==="BUTTON"||Ne.tagName==="INPUT"||Ne.closest("button")||Ne.closest("input"))&&Ee.stopPropagation()}},style:{position:"fixed",top:m?`${m.y}px`:"90px",left:m?`${m.x}px`:`${window.innerWidth-280}px`,transform:"none",background:p&&p.componentId===Xe.id?"rgba(255, 255, 255, 0.95)":"#fff",border:"1px solid #0b5fff",borderRadius:4,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"350px",width:`${ot.width}px`,height:`${ot.height}px`,maxHeight:`${window.innerHeight-20}px`,display:"flex",flexDirection:"column",pointerEvents:"auto",cursor:_?"grabbing":"default"},children:[n.jsxs("div",{onMouseDown:Ee=>{const Ne=Ee.target;Ne.tagName==="BUTTON"||Ne.tagName==="INPUT"||Ne.closest("button")||Ne.closest("input")||m&&(K({x:Ee.clientX-m.x,y:Ee.clientY-m.y}),E(!0),Ee.preventDefault())},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:_?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[n.jsx("h3",{style:{margin:0,fontSize:"13px",color:"#fff",fontWeight:600},children:"Component Properties"}),n.jsx("button",{onClick:()=>{o(null),g(null)},style:{background:"transparent",border:"none",fontSize:"15px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"6px 20px 6px 6px",overflowY:"auto",flex:1,minHeight:0},children:[(()=>{const Ee=r||Cl(Xe);return n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Category:"}),n.jsx("div",{style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"11px",color:"#000"},children:Ee?.category||"N/A"})]})})(),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Type:"}),n.jsx("div",{style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"11px",color:"#000"},children:(()=>{const Ee=r||Cl(Xe);return Ee?.displayName?Xe.componentType==="Capacitor"&&!Ee.displayName.toLowerCase().includes("capacitor")?`${Ee.displayName} Capacitor`:Ee.displayName:Xe.componentType==="GenericComponent"&&Xe.genericType?kl(Xe.genericType):Xe.componentType==="Diode"&&Xe.diodeType&&Xe.diodeType!=="Standard"?kl(Xe.diodeType):Xe.componentType==="VariableResistor"&&Xe.vrType&&Xe.vrType!=="Potentiometer"?kl(Xe.vrType):Xe.componentType==="Capacitor"&&Xe.dielectric==="Tantalum"?"Tantalum Capacitor":Xe.componentType==="Capacitor"&&Xe.capacitorType==="Electrolytic"?"Electrolytic Capacitor":Xe.componentType==="Capacitor"&&Xe.capacitorType==="Film"?"Film Capacitor":kl(Xe.componentType)})()})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-layer-${Xe.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Layer:"}),n.jsxs("select",{id:`component-layer-${Xe.id}`,name:`component-layer-${Xe.id}`,value:i.layer,onChange:Ee=>o({...i,layer:Ee.target.value}),disabled:D,style:{width:"80px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:D?.6:1},children:[n.jsx("option",{value:"top",children:"Top"}),n.jsx("option",{value:"bottom",children:"Bottom"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-designator-${Xe.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Designator:"}),n.jsx("input",{id:`component-designator-${Xe.id}`,name:`component-designator-${Xe.id}`,type:"text",value:i.designator||"",onChange:Ee=>{const Ne=Ee.target.value,Mt=Ne.length>0?Ne.charAt(0).toUpperCase():i.abbreviation;o({...i,designator:Ne,abbreviation:Mt})},disabled:D,style:{width:"80px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",fontFamily:"monospace",textTransform:"uppercase",opacity:D?.6:1},placeholder:"e.g., U2, R7, C1",onKeyDown:Ee=>{Ee.key==="Enter"&&!D&&(Ee.preventDefault(),Ue())}}),n.jsx("button",{onClick:Ue,disabled:D||!i.designator?.trim(),style:{padding:"4px 12px",background:D||!i.designator?.trim()?"#ccc":"linear-gradient(90deg, #7B68EE 0%, #6A5ACD 100%)",color:"#fff",border:"none",borderRadius:"4px",fontSize:"11px",fontWeight:600,cursor:D||!i.designator?.trim()?"not-allowed":"pointer",opacity:D||!i.designator?.trim()?.6:1,textShadow:"0 1px 2px rgba(0, 0, 0, 0.3)",whiteSpace:"nowrap"},title:"Find all components with this designator",children:"Find"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-orientation-${Xe.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Orientation:"}),n.jsxs("select",{id:`component-orientation-${Xe.id}`,name:`component-orientation-${Xe.id}`,value:i.orientation??0,onChange:Ee=>{const Ne=parseInt(Ee.target.value)||0;if(o({...i,orientation:Ne}),!D){const ct=(i.layer==="top"?s:c).find(_t=>_t.id===i.id);if(ct){const _t={...ct,orientation:Ne};i.layer==="top"?d(Ze=>Ze.map(jt=>jt.id===i.id?_t:jt)):v(Ze=>Ze.map(jt=>jt.id===i.id?_t:jt))}}},disabled:D,style:{width:"70px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:D?.6:1},children:[n.jsx("option",{value:"0",children:"0"}),n.jsx("option",{value:"90",children:"90"}),n.jsx("option",{value:"180",children:"180"}),n.jsx("option",{value:"270",children:"270"})]})]}),(Xe.componentType==="IntegratedCircuit"||Xe.componentType==="Semiconductor")&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[n.jsx("label",{htmlFor:`component-datasheet-${Xe.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Datasheet:"}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px",flex:1},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",flexWrap:"wrap",flex:1},children:[n.jsx("input",{id:`component-datasheet-file-${Xe.id}`,type:"file",accept:".pdf",onChange:async Ee=>{const Ne=Ee.target.files?.[0]||null;if(Ne){Y(Ne);let Mt=Ne.name;if(Se)try{let ct;try{ct=await Se.getDirectoryHandle("datasheets",{create:!0})}catch(jt){console.error("Failed to get/create datasheets directory:",jt),ct=Se}const Ze=await(await ct.getFileHandle(Ne.name,{create:!0})).createWritable();await Ze.write(await Ne.arrayBuffer()),await Ze.close(),Mt=ct===Se?Ne.name:`datasheets/${Ne.name}`}catch(ct){console.error("Failed to copy datasheet to project directory:",ct)}o({...i,datasheetFileName:Mt})}else Y(null),o({...i,datasheetFileName:void 0})},disabled:D,style:{position:"absolute",width:"0.1px",height:"0.1px",opacity:0,overflow:"hidden",zIndex:-1}}),n.jsx("label",{htmlFor:`component-datasheet-file-${Xe.id}`,style:{display:"inline-block",padding:"2px 6px",background:D?"#ccc":"#4CAF50",border:"none",borderRadius:2,fontSize:"11px",color:"#fff",cursor:D?"not-allowed":"pointer",opacity:D?.6:1,whiteSpace:"nowrap",flex:"0 0 auto"},children:"Choose File"}),(()=>{const Ee=Xe?.datasheetFileName,Ne=pe?.name||(Ee?Ee.split("/").pop():null),Mt=!!pe;return Ne?Mt?n.jsx("a",{href:"#",onClick:ct=>{ct.preventDefault(),ct.stopPropagation();try{const _t=pe,Ze=URL.createObjectURL(_t),jt=window.open(Ze,"_blank","noopener,noreferrer");if(!jt||jt.closed){URL.revokeObjectURL(Ze);const en=document.createElement("a"),Qe=URL.createObjectURL(_t);en.href=Qe,en.target="_blank",en.rel="noopener noreferrer",document.body.appendChild(en),en.click(),document.body.removeChild(en)}}catch(_t){console.error("Error opening datasheet:",_t),alert("Failed to open datasheet file.")}},style:{fontSize:"11px",color:"#0066cc",whiteSpace:"nowrap",textDecoration:"underline",cursor:"pointer",flex:"0 0 auto"},title:"Click to open PDF in new window",children:Ne}):n.jsxs("span",{style:{fontSize:"11px",color:"#666",flex:"0 0 auto",fontStyle:"italic"},title:"Re-choose the datasheet file to open it",children:[Ne," (re-choose file to open)"]}):n.jsx("span",{style:{fontSize:"11px",color:"#666",flex:"0 0 auto"},children:"No file chosen"})})()]}),n.jsx("div",{style:{display:"flex",alignItems:"center",gap:"4px",marginTop:"4px"},children:n.jsx("button",{onClick:()=>{if(i&&Xe){const Ne=(i.layer==="top"?s:c).find(Mt=>Mt.id===i.id);if(Ne){const _t=((r||Cl(Ne))?.fields||[]).filter(jt=>jt.name!=="datasheet").map(jt=>({name:jt.name,label:jt.label,type:jt.type,hasUnits:!!(jt.units&&jt.units.length>0),units:jt.units||[]})),Ze=Ne.customGeminiPrompt;if(Ze&&Ze.trim())C(Ze);else{const jt=et(_t);C(jt)}}}ke(!0)},disabled:D,style:{padding:"3px 8px",fontSize:"11px",background:D?"#ccc":"#0066cc",color:"#fff",border:"none",borderRadius:"3px",cursor:D?"not-allowed":"pointer",opacity:D?.6:1,fontWeight:600,whiteSpace:"nowrap",transition:"background 0.2s"},title:"View and edit the AI prompt that will be sent to Gemini",children:"View/Edit Prompt"})}),n.jsx("div",{style:{display:"flex",alignItems:"center",gap:"4px",marginTop:"4px"},children:n.jsx("button",{onClick:zn,disabled:I||D,className:I?"fetch-pin-names-pulse":"",style:{padding:"3px 8px",fontSize:"11px",background:D?"#ccc":"#4CAF50",color:"#fff",border:"none",borderRadius:"3px",cursor:I||D?"not-allowed":"pointer",opacity:D?.6:1,fontWeight:600,whiteSpace:"nowrap",transition:"background 0.2s"},children:I?"Extracting...":"Extract Datasheet Information"})})]})]}),(Xe.componentType==="IntegratedCircuit"||Xe.componentType==="Semiconductor")&&n.jsxs(n.Fragment,{children:[n.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid #e0e0e0",fontSize:"11px",fontWeight:600,color:"#000",marginBottom:"4px"},children:"IC Properties:"}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[n.jsx("label",{htmlFor:`component-manufacturer-ic-${Xe.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Manufacturer:"}),n.jsx("input",{id:`component-manufacturer-ic-${Xe.id}`,type:"text",value:i.manufacturer||"",onChange:Ee=>o({...i,manufacturer:Ee.target.value}),disabled:D,style:{width:"150px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:D?.6:1}})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[n.jsx("label",{htmlFor:`component-partnumber-ic-${Xe.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Part Number:"}),n.jsx("input",{id:`component-partnumber-ic-${Xe.id}`,type:"text",value:i.partNumber||"",onChange:Ee=>o({...i,partNumber:Ee.target.value}),disabled:D,style:{width:"150px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:D?.6:1}})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[n.jsx("label",{htmlFor:`component-pincount-ic-${Xe.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Pin Count:"}),n.jsx("input",{id:`component-pincount-ic-${Xe.id}`,name:`component-pincount-ic-${Xe.id}`,type:"number",min:"1",value:i.pinCount,onChange:Ee=>{const Ne=Math.max(1,parseInt(Ee.target.value)||1);o({...i,pinCount:Ne})},onBlur:Ee=>{if(D){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const Ne=Math.max(1,parseInt(Ee.target.value)||1),ct=(i.layer==="top"?s:c).find(_t=>_t.id===i.id);if(ct&&Ne!==ct.pinCount){const _t=ct.pinConnections||[],Ze=new Array(Ne).fill("").map((At,un)=>un<_t.length?_t[un]:""),jt=ct.pinPolarities||[],en=ct.pinPolarities?new Array(Ne).fill("").map((At,un)=>un<jt.length?jt[un]:""):void 0,Qe={...ct,pinCount:Ne,pinConnections:Ze,...en!==void 0&&{pinPolarities:en}};i.layer==="top"?d(At=>At.map(un=>un.id===i.id?Qe:un)):v(At=>At.map(un=>un.id===i.id?Qe:un)),o({...i,pinCount:Ne})}},disabled:D,style:{width:"80px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:D?.6:1}})]})]})]}),n.jsx(Dv,{component:Xe,componentEditor:i,componentDefinition:r,setComponentEditor:o,areComponentsLocked:D,componentsTop:s,componentsBottom:c,uploadedDatasheetFile:pe,setUploadedDatasheetFile:Y,setComponentsTop:d,setComponentsBottom:v}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-description-${Xe.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Description:"}),n.jsx("input",{id:`component-description-${Xe.id}`,name:`component-description-${Xe.id}`,type:"text",value:i.description||"",onChange:Ee=>{o({...i,description:Ee.target.value})},disabled:D,style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:D?.6:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},placeholder:"",title:i.description||""})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-notes-${Xe.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Notes:"}),n.jsx("input",{id:`component-notes-${Xe.id}`,name:`component-notes-${Xe.id}`,type:"text",readOnly:!0,value:Xe.notes||"",onClick:()=>{D||(ee(new Set([Xe.id])),w(!0))},disabled:D,style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:D?.6:1,cursor:D?"not-allowed":"pointer",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},placeholder:"Click to edit notes...",title:Xe.notes||"Click to edit notes..."})]}),(Xe.componentType==="IntegratedCircuit"||Xe.componentType==="Semiconductor")&&n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-operatingTemperature-${Xe.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Operating Temperature:"}),n.jsx("input",{id:`component-operatingTemperature-${Xe.id}`,name:`component-operatingTemperature-${Xe.id}`,type:"text",value:i.operatingTemperature||"",onChange:Ee=>{o({...i,operatingTemperature:Ee.target.value})},disabled:D,style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:D?.6:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},placeholder:"",title:i.operatingTemperature||""})]}),Xe.componentType!=="IntegratedCircuit"&&Xe.componentType!=="Semiconductor"&&n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-pincount-${Xe.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Pin Count:"}),n.jsx("input",{id:`component-pincount-${Xe.id}`,name:`component-pincount-${Xe.id}`,type:"number",min:"1",value:i.pinCount,onChange:Ee=>{const Ne=Math.max(1,parseInt(Ee.target.value)||1);o({...i,pinCount:Ne})},onBlur:Ee=>{if(D){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const Ne=Math.max(1,parseInt(Ee.target.value)||1),ct=(i.layer==="top"?s:c).find(_t=>_t.id===i.id);if(ct&&Ne!==ct.pinCount){const _t=ct.pinConnections||[],Ze=new Array(Ne).fill("").map((At,un)=>un<_t.length?_t[un]:""),jt=ct.pinPolarities||[],en=ct.pinPolarities?new Array(Ne).fill("").map((At,un)=>un<jt.length?jt[un]:""):void 0,Qe={...ct,pinCount:Ne,pinConnections:Ze,...en!==void 0&&{pinPolarities:en}};i.layer==="top"?d(At=>At.map(un=>un.id===i.id?Qe:un)):v(At=>At.map(un=>un.id===i.id?Qe:un)),o({...i,pinCount:Ne})}},disabled:D,style:{width:"60px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:D?.6:1}})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-x-${Xe.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"X:"}),n.jsx("input",{id:`component-x-${Xe.id}`,name:`component-x-${Xe.id}`,type:"number",value:i.x.toFixed(2),onChange:Ee=>{const Ne=parseFloat(Ee.target.value)||0;o({...i,x:Ne})},disabled:D,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:D?.6:1}})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-y-${Xe.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Y:"}),n.jsx("input",{id:`component-y-${Xe.id}`,name:`component-y-${Xe.id}`,type:"number",value:i.y.toFixed(2),onChange:Ee=>{const Ne=parseFloat(Ee.target.value)||0;o({...i,y:Ne})},disabled:D,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:D?.6:1}})]}),n.jsxs("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid #e0e0e0"},children:[n.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:600,color:"#333",marginBottom:"2px"},children:"Pin Connections:"}),p&&p.componentId===Xe.id&&n.jsxs("div",{style:{padding:"2px 3px",background:"#fff3cd",border:"1px solid #ffc107",borderRadius:2,marginBottom:"2px",fontSize:"11px",color:"#856404"},children:["Pin ",p.pinIndex+1," selected. Click on a via or pad to connect."]}),(()=>{const Ee=Xf(Xe),Mt=(i.layer==="top"?s:c).find(xn=>xn.id===i.id),ct=Mt?.pinNames,Ze=(r||Cl(Xe))?.properties?.pinNames,jt=Ze&&Ze.length>0,en=jt&&Ze.includes("CHIP_DEPENDENT"),Qe=jt&&!en,At=en,un=jt;return n.jsx("div",{children:n.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px",marginTop:"2px"},children:[n.jsx("thead",{children:n.jsxs("tr",{style:{borderBottom:"1px solid #ddd",background:"#f5f5f5"},children:[n.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333",width:"20px"}}),n.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333",width:"40px"},children:"Pin"}),un&&n.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333",width:"70px"},children:"Pin Name"}),Ee&&n.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333",width:"50px"},children:"Polarity"}),n.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333"},children:"Node ID"})]})}),n.jsx("tbody",{children:Array.from({length:i.pinCount},(xn,Kt)=>{const Qt=Mt?.pinConnections&&Mt.pinConnections.length>Kt?Mt.pinConnections[Kt]:"",hn=Mt?.pinPolarities&&Mt.pinPolarities.length>Kt&&Mt.pinPolarities[Kt]||"",Xn=ct&&Kt<ct.length?ct[Kt]:"",rt=Ze&&Kt<Ze.length?Ze[Kt]:"",ln=rt==="CHIP_DEPENDENT",Lt=Xn&&Xn.trim()!==""?Xn:ln?"":rt,Zn=p&&p.componentId===Xe.id&&p.pinIndex===Kt;return n.jsxs("tr",{style:{cursor:D?"not-allowed":"pointer",background:Zn?"#e6f0ff":Qt?"#d4edda":"#fff",borderBottom:"1px solid #eee"},onClick:In=>{if(In.target.tagName!=="SELECT"){if(D){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}g(Zn?null:{componentId:Xe.id,pinIndex:Kt})}},title:Qt?`Connected to: ${Qt}`:"Select this pin, then click on a via or pad to connect",children:[n.jsx("td",{style:{padding:"2px 4px",textAlign:"center"},children:n.jsx("input",{id:`pin-radio-${Xe.id}-${Kt}`,name:`pin-radio-${Xe.id}`,type:"radio",checked:!!Zn,onChange:()=>{if(D){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}g(Zn?null:{componentId:Xe.id,pinIndex:Kt})},disabled:D,style:{margin:0,cursor:D?"not-allowed":"pointer",opacity:D?.6:1,width:"10px",height:"10px"}})}),n.jsx("td",{style:{padding:"2px 4px",color:"#333",fontWeight:Zn?600:400,fontFamily:"monospace"},children:Kt+1}),(Qe||At)&&n.jsx("td",{style:{padding:"2px 4px",textAlign:"left"},children:Qe?n.jsx("select",{value:Lt||"",onChange:In=>{if(D){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const wr=In.target.value,Yt=(i.layer==="top"?s:c).find(jn=>jn.id===i.id);if(Yt){const ci=[...Yt.pinNames||(Ze?[...Ze]:[])];for(;ci.length<i.pinCount;)ci.push("");ci[Kt]=wr;const Et={...Yt,pinNames:ci};i.layer==="top"?d(Bt=>Bt.map(Zt=>Zt.id===i.id?Et:Zt)):v(Bt=>Bt.map(Zt=>Zt.id===i.id?Et:Zt))}},disabled:D,onClick:In=>In.stopPropagation(),onFocus:In=>In.stopPropagation(),style:{padding:"2px 4px",fontSize:"11px",border:"1px solid #ddd",borderRadius:2,background:"#fff",color:"#333",cursor:D?"not-allowed":"pointer",opacity:D?.6:1,width:"100%",fontStyle:"italic",minHeight:"18px"},children:Ze&&Ze.length>0?Ze.filter(In=>In!=="CHIP_DEPENDENT").map((In,wr)=>n.jsx("option",{value:In,children:In},wr)):n.jsx("option",{value:"",children:"-"})}):n.jsx("input",{type:"text",value:Lt||"",onChange:In=>{if(D){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const wr=In.target.value,Yt=(i.layer==="top"?s:c).find(jn=>jn.id===i.id);if(Yt){const ci=[...Yt.pinNames||[]];for(;ci.length<i.pinCount;)ci.push("");ci[Kt]=wr;const Et={...Yt,pinNames:ci};i.layer==="top"?d(Bt=>Bt.map(Zt=>Zt.id===i.id?Et:Zt)):v(Bt=>Bt.map(Zt=>Zt.id===i.id?Et:Zt))}},disabled:D,onClick:In=>In.stopPropagation(),onFocus:In=>In.stopPropagation(),placeholder:"Pin name",style:{padding:"1px 2px",fontSize:"11px",border:"1px solid #ddd",borderRadius:2,background:"#fff",color:"#333",width:"100%",opacity:D?.6:1,cursor:D?"not-allowed":"text"}})}),Ee&&n.jsx("td",{style:{padding:"2px 4px",textAlign:"center"},children:Qt?n.jsx("span",{style:{fontFamily:"monospace",fontWeight:600,color:hn==="+"?"#d32f2f":hn==="-"?"#1976d2":"#999"},children:hn||"-"}):n.jsxs("select",{value:hn??"",onChange:In=>{if(D){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const wr=In.target.value,Yt=(i.layer==="top"?s:c).find(jn=>jn.id===i.id);if(Yt){const ci=[...Yt.pinPolarities||new Array(Yt.pinCount).fill("")];for(;ci.length<Yt.pinCount;)ci.push("");ci[Kt]=wr;const Et={...Yt,pinPolarities:ci};i.layer==="top"?d(Bt=>Bt.map(Zt=>Zt.id===i.id?Et:Zt)):v(Bt=>Bt.map(Zt=>Zt.id===i.id?Et:Zt))}},disabled:D,onClick:In=>In.stopPropagation(),onFocus:In=>In.stopPropagation(),style:{padding:"1px 2px",fontSize:"11px",border:"1px solid #ddd",borderRadius:2,background:"#fff",cursor:D?"not-allowed":"pointer",opacity:D?.6:1,width:"100%",fontFamily:"monospace",fontWeight:600},children:[n.jsx("option",{value:"",children:"-"}),n.jsx("option",{value:"+",children:"+"}),n.jsx("option",{value:"-",children:"-"})]},`polarity-${Xe.id}-${Kt}-${hn}`)}),n.jsx("td",{style:{padding:"2px 4px",color:Qt?"#28a745":"#999",fontWeight:Qt?600:400,fontFamily:"monospace"},children:Qt||"-"})]},Kt)})})]})})})()]})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"6px",padding:"6px",paddingRight:"24px",borderTop:"1px solid #e0e0e0",flexShrink:0},children:[n.jsx("button",{onClick:()=>{o(null),g(null)},disabled:D,style:{padding:"2px 5px",background:D?"#f5f5f5":"#fff",color:D?"#999":"#333",border:"1px solid #ddd",borderRadius:2,cursor:D?"not-allowed":"pointer",fontSize:"11px",opacity:D?.6:1},children:"Cancel"}),n.jsx("button",{onClick:Nn,disabled:D,style:{padding:"2px 5px",background:D?"#f5f5f5":"#0b5fff",color:D?"#999":"#fff",border:"1px solid #ddd",borderRadius:2,cursor:D?"not-allowed":"pointer",fontSize:"11px",opacity:D?.6:1},children:"Save"})]}),X&&n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10005},onClick:Ee=>{Ee.target===Ee.currentTarget&&F(!1)},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"600px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:Ee=>Ee.stopPropagation(),children:[n.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[n.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:"How to Get a Google Gemini API Key"}),n.jsx("button",{onClick:()=>F(!1),style:{background:"transparent",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:0,width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center"},title:"Close",children:""})]}),n.jsx("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"14px",lineHeight:"1.6"},children:n.jsxs("p",{style:{margin:"0 0 12px 0"},children:["To get a Google Gemini API key, go to"," ",n.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",style:{color:"#4CAF50",textDecoration:"underline"},children:"Google AI Studio (aistudio.google.com/app/apikey)"}),', sign in with your Google account, and click "Get API key" or "Create API key" in the Dashboard to generate a key for a new or existing Google Cloud project, then copy it and store it securely.']})}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:n.jsx("button",{onClick:()=>F(!1),style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"OK"})})]})}),n.jsx("div",{onMouseDown:Ut,style:{position:"absolute",bottom:0,right:0,width:"20px",height:"20px",cursor:"nwse-resize",background:"linear-gradient(135deg, transparent 0%, transparent 40%, #ccc 40%, #ccc 45%, transparent 45%, transparent 55%, #ccc 55%, #ccc 60%, transparent 60%)",zIndex:1001},title:"Drag to resize"})]}),R&&n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10005},onClick:Ee=>{Ee.target===Ee.currentTarget&&(U(!1),H?.())},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"500px",maxWidth:"600px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:Ee=>Ee.stopPropagation(),children:[n.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[n.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:"Google Gemini API Configuration"}),n.jsx("button",{onClick:()=>U(!1),style:{background:"transparent",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:0,width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center"},title:"Close",children:""})]}),n.jsxs("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"14px",lineHeight:"1.6"},children:[n.jsx("p",{style:{margin:"0 0 12px 0",fontWeight:600,color:"#fff"},children:"Benefits of Adding Your API Key:"}),n.jsxs("ul",{style:{margin:"0 0 16px 0",paddingLeft:"20px"},children:[n.jsx("li",{children:"Automatically extract pin names and component properties (voltage, current, temperature, etc.) from datasheet PDFs"}),n.jsx("li",{children:"Get datasheet summary for component notes"}),n.jsx("li",{children:"Save time by avoiding manual data entry"})]}),n.jsx("p",{style:{margin:"0 0 12px 0",fontWeight:600,color:"#fff"},children:"How to Get Your Free API Key:"}),n.jsxs("p",{style:{margin:"0 0 16px 0"},children:["Go to"," ",n.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",style:{color:"#4CAF50",textDecoration:"underline"},children:"Google AI Studio (aistudio.google.com/app/apikey)"}),', sign in with your Google account, and click "Get API key" or "Create API key" in the Dashboard to generate a key for a new or existing Google Cloud project, then copy it and paste it below.']}),n.jsxs("div",{style:{marginBottom:"12px"},children:[n.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#fff",fontSize:"13px",fontWeight:600},children:"Enter Your API Key:"}),n.jsx("input",{type:"password",value:z,onChange:Ee=>G(Ee.target.value),placeholder:"Paste your Gemini API key here",style:{width:"100%",padding:"8px 12px",fontSize:"13px",border:"1px solid #555",borderRadius:"4px",background:"#1f1f24",color:"#fff",boxSizing:"border-box"},autoFocus:!0})]}),n.jsxs("div",{style:{marginBottom:"12px"},children:[n.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#fff",fontSize:"13px",fontWeight:600},children:"Select Gemini Model:"}),n.jsxs("select",{value:V,onChange:Ee=>ie(Ee.target.value),style:{width:"100%",padding:"8px 12px",fontSize:"13px",border:"1px solid #555",borderRadius:"4px",background:"#1f1f24",color:"#fff",boxSizing:"border-box",cursor:"pointer"},children:[n.jsx("option",{value:"gemini-2.5-flash-lite",children:"gemini-2.5-flash-lite (Lightweight, Fast)"}),n.jsx("option",{value:"gemini-2.5-flash",children:"gemini-2.5-flash (Fast, Balanced)"}),n.jsx("option",{value:"gemini-2.5-pro",children:"gemini-2.5-pro (High Quality, Slower)"}),n.jsx("option",{value:"gemini-1.5-flash",children:"gemini-1.5-flash (Legacy Fast)"}),n.jsx("option",{value:"gemini-1.5-pro",children:"gemini-1.5-pro (Legacy High Quality)"})]}),n.jsx("p",{style:{margin:"6px 0 0 0",color:"#aaa",fontSize:"12px",lineHeight:"1.4"},children:"Choose the model based on your needs: Flash models are faster and use fewer tokens, while Pro models provide higher quality responses."})]}),n.jsxs("div",{style:{marginTop:"16px",padding:"12px",background:"#1f1f24",borderRadius:"4px",border:"1px solid #444"},children:[n.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#fff",fontSize:"13px"},children:"Storage & Security Information:"}),n.jsxs("p",{style:{margin:"0 0 8px 0",color:"#ddd",fontSize:"12px",lineHeight:"1.5"},children:["Your API key will be stored in your browser's ",n.jsx("strong",{children:"localStorage"})," under the key ",n.jsx("code",{style:{background:"#2b2b31",padding:"2px 4px",borderRadius:"2px",color:"#4CAF50"},children:"'geminiApiKey'"}),"."]}),n.jsx("p",{style:{margin:"0 0 8px 0",color:"#ffaa00",fontSize:"12px",lineHeight:"1.5",fontWeight:600},children:" Security Warnings:"}),n.jsxs("ul",{style:{margin:"0 0 8px 0",paddingLeft:"20px",color:"#ddd",fontSize:"12px",lineHeight:"1.5"},children:[n.jsx("li",{children:"localStorage is accessible via browser DevTools"}),n.jsx("li",{children:"Do not use on shared or public computers"}),n.jsx("li",{children:"Malicious browser extensions could access your key"}),n.jsx("li",{children:"XSS attacks could potentially read your key"}),n.jsx("li",{children:"The key is stored in plain text (not encrypted)"})]}),n.jsx("p",{style:{margin:"0",color:"#aaa",fontSize:"11px",lineHeight:"1.4",fontStyle:"italic"},children:"For maximum security, consider using API key restrictions in Google Cloud Console and regularly rotating your keys."})]})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"8px"},children:[n.jsx("button",{onClick:Re,disabled:!he,style:{padding:"8px 16px",background:he?"#d32f2f":"#444",color:"#fff",border:"1px solid #666",borderRadius:6,cursor:he?"pointer":"not-allowed",fontSize:"14px",fontWeight:600,opacity:he?1:.5},title:he?"Remove API key from browser localStorage":"No API key stored",children:"Remove API Key"}),n.jsxs("div",{style:{display:"flex",gap:"8px"},children:[n.jsx("button",{onClick:()=>{U(!1),H?.()},style:{padding:"8px 16px",background:"#555",color:"#fff",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Cancel"}),n.jsx("button",{onClick:()=>{Le(),U(!1),H?.()},style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Save API Key"})]})]})]})}),ce&&O&&n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10006},onClick:Ee=>{Ee.target===Ee.currentTarget&&xe(!1)},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"600px",maxWidth:"90vw",maxHeight:"90vh",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"2px solid #2196F3",display:"flex",flexDirection:"column"},onClick:Ee=>Ee.stopPropagation(),children:[n.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[n.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:"Gemini API Response"}),n.jsx("button",{onClick:()=>{xe(!1),_e(null)},style:{background:"transparent",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:0,width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center"},title:"Close",children:""})]}),n.jsx("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"13px",lineHeight:"1.6",overflow:"auto",flex:1,padding:"12px",background:"#1f1f24",borderRadius:"4px",fontFamily:"monospace",whiteSpace:"pre-wrap",wordBreak:"break-word",maxHeight:"60vh"},children:O}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[n.jsx("button",{onClick:()=>{navigator.clipboard.writeText(O||""),alert("Response copied to clipboard")},style:{padding:"8px 16px",background:"#555",color:"#fff",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Copy to Clipboard"}),n.jsx("button",{onClick:()=>{xe(!1),_e(null)},style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Close"})]})]})}),fe&&n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},onClick:Ee=>{Ee.target===Ee.currentTarget&&ke(!1)},children:n.jsxs("div",{style:{background:"#fff",borderRadius:8,padding:"20px",maxWidth:"90%",maxHeight:"90%",width:"800px",display:"flex",flexDirection:"column",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)"},onClick:Ee=>Ee.stopPropagation(),children:[n.jsxs("div",{style:{marginBottom:"16px"},children:[n.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:"18px",fontWeight:600,color:"#333"},children:"AI Prompt Editor"}),n.jsx("p",{style:{margin:"0",fontSize:"13px",color:"#666",lineHeight:"1.5"},children:'This is the prompt that will be sent to Gemini when you click "Extract Datasheet Information". You can customize it for this component. The prompt will be saved with this component and reloaded when you open it again.'}),n.jsx("p",{style:{margin:"8px 0 0 0",fontSize:"12px",color:"#888",fontStyle:"italic"},children:'Note: The PDF datasheet will be automatically attached to your prompt when extracting information. You can reference it in your prompt as "the attached PDF" or "the datasheet".'})]}),n.jsx("textarea",{value:de,onChange:Ee=>C(Ee.target.value),style:{flex:1,minHeight:"400px",padding:"12px",border:"1px solid #ddd",borderRadius:4,fontSize:"13px",fontFamily:"monospace",resize:"vertical",color:"#000",background:"#fff",lineHeight:"1.5"},placeholder:"Enter your custom prompt here..."}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[n.jsx("button",{onClick:()=>{ke(!1)},style:{padding:"8px 16px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"14px",fontWeight:500},children:"Cancel"}),n.jsx("button",{onClick:()=>{if(i&&Xe){const Ne=(i.layer==="top"?s:c).find(Mt=>Mt.id===i.id);if(Ne){const Mt={...Ne,customGeminiPrompt:de.trim()||void 0};i.layer==="top"?d(ct=>ct.map(_t=>_t.id===i.id?Mt:_t)):v(ct=>ct.map(_t=>_t.id===i.id?Mt:_t)),o({...i,customGeminiPrompt:de.trim()||void 0})}}ke(!1)},style:{padding:"8px 16px",background:"#4CAF50",border:"none",borderRadius:4,cursor:"pointer",color:"#fff",fontSize:"14px",fontWeight:600},children:"Save Prompt"})]})]})}),n.jsx(Ox,{visible:Wt.visible,title:Wt.title,message:Wt.message,type:Wt.type,onClose:()=>{ht({visible:!1,title:"",message:"",type:"info"}),ce||_e(null)},onShowResponse:Wt.onShowResponse})]})};function Ev(i){if(i.baseType)return i.baseType;switch(i.category){case"Capacitors":return"Capacitor";case"Diodes":return"Diode";case"Resistors":return"Resistor";case"Semiconductors":return"Semiconductor";case"Passive Components":return"Passive";case"Power & Energy":return"PowerEnergy";case"Connectors & Switches":return i.type==="Switch"||i.subcategory==="Switch"?"Switch":"Connector";case"Other":return i.type==="Transformer"?"Transformer":"Other";default:return"Other"}}const Ov=ph.components,Fv=Ov.map(i=>{const r=`${i.category}:${i.subcategory}:${i.type}`,o=Ev(i);return{...i,key:r,baseType:o}}),Uy=new Map;Fv.forEach(i=>{Uy.set(i.key,i)});function Uv(i){if(i)return Uy.get(i)}const Pg=i=>{const{category:r,subcategory:o,type:s,designator:c}=i;let d,v;switch(r){case"Capacitors":o==="Electrolytic"?d="Electrolytic Capacitor":o==="Film"?d="Film Capacitor":(d="Capacitor",o==="Tantalum"&&(v="Tantalum"));break;case"Diodes":d="Diode",o==="LED"?v="LED":o==="Infrared"?v="Infrared":o==="Photodiode"?v="Photodiode":o==="Schottky"?v="Schottky":o==="Zener"?v="Zener":v="Standard";break;case"Resistors":o==="Network"?(d="ResistorNetwork",v="Network"):o==="Thermistor"?(d="Thermistor",v="Thermistor"):o==="Variable"?(d="VariableResistor",v="Potentiometer"):o==="Varistor"?(d="VariableResistor",v="Varistor"):d="Resistor";break;case"Semiconductors":o==="BJT"||o==="MOSFET"||o==="JFET"?d="Transistor":d="IntegratedCircuit";break;case"Passive Components":s==="Inductor"?d="Inductor":s==="FerriteBead"?d="FerriteBead":d="Crystal";break;case"Power & Energy":o==="Battery"?d="Battery":o==="Power Supply"?d="PowerSupply":d="Fuse";break;case"Connectors & Switches":o==="Connector"?d="Connector":o==="Jumper"?d="Jumper":o==="Switch"?d="Switch":d="Relay";break;case"Other":o==="Transformer"?d="Transformer":o==="Speaker"?d="Speaker":o==="Motor"?d="Motor":o==="Test Point"?d="TestPoint":o==="Vacuum Tube"?d="VacuumTube":(d="GenericComponent",o==="Attenuator"?v="Attenuator":o==="Circuit Breaker"?v="CircuitBreaker":o==="Thermocouple"?v="Thermocouple":o==="Tuner"&&(v="Tuner"));break;default:d="GenericComponent";break}const p=`${r}:${o}:${s}:${c}`,g=`${r}:${o}:${s}`,m=Uv(g);return{componentType:d,designator:c,subtype:v,uniqueKey:p,componentDefinition:i,dataDrivenDefinition:m}},qy=qu.reduce((i,r)=>(i[r.category]||(i[r.category]=[]),i[r.category].push(r),i),{});Object.values(qy).forEach(i=>{i.sort((r,o)=>r.displayName.localeCompare(o.displayName))});const qv=({visible:i,selectedLayer:r,selectedComponentType:o,selectedComponentKey:s,onLayerChange:c,onComponentTypeChange:d,onClose:v})=>{const[p,g]=L.useState(""),[m,S]=L.useState(null),[_,E]=L.useState(!1),T=L.useRef({x:0,y:0}),K=L.useRef(null),D=L.useRef(null);L.useEffect(()=>{i&&m===null&&S({x:window.innerWidth-400-8,y:130})},[i,m]),L.useEffect(()=>{if(i&&D.current){const ae=setTimeout(()=>{D.current?.focus(),D.current?.select()},100);return()=>clearTimeout(ae)}},[i]);const ee=L.useCallback(ae=>{const I=ae.target;if(!(I.tagName==="BUTTON"||I.tagName==="INPUT"||I.closest("button")||I.closest("input"))&&K.current){const oe=K.current.getBoundingClientRect();T.current={x:ae.clientX-oe.left,y:ae.clientY-oe.top},E(!0),ae.preventDefault()}},[]);L.useEffect(()=>{if(!_)return;const ae=oe=>{const pe=oe.clientX-T.current.x,Y=oe.clientY-T.current.y,X=K.current?.offsetWidth||400,F=K.current?.offsetHeight||600,R=Math.max(0,Math.min(pe,window.innerWidth-X)),U=Math.max(0,Math.min(Y,window.innerHeight-F));S({x:R,y:U})},I=()=>{E(!1)};return document.addEventListener("mousemove",ae),document.addEventListener("mouseup",I),()=>{document.removeEventListener("mousemove",ae),document.removeEventListener("mouseup",I)}},[_]);const w=L.useMemo(()=>{if(!p.trim())return()=>!0;const ae=p.toLowerCase();return I=>!!(I.searchText&&I.searchText.toLowerCase().includes(ae)||I.displayName&&I.displayName.toLowerCase().includes(ae)||I.description&&I.description.toLowerCase().includes(ae)||I.category&&I.category.toLowerCase().includes(ae)||I.subcategory&&I.subcategory.toLowerCase().includes(ae)||I.designator&&I.designator.toLowerCase().includes(ae)||I.type&&I.type.toLowerCase().includes(ae)||I.resolvedTypeName&&I.resolvedTypeName.toLowerCase().includes(ae))},[p]),Se=L.useMemo(()=>p.trim()?qu.filter(ae=>{const I=Pg(ae);return w({category:ae.category,type:I.componentType,subcategory:ae.subcategory,designator:ae.designator,displayName:ae.displayName,description:ae.description,resolvedTypeName:kl(I.componentType),searchText:ae.searchText})}):qu,[p,w]);if(!i)return null;const $={position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"flex-start",justifyContent:"flex-end",zIndex:10005,pointerEvents:"none"},H={padding:"20px",overflow:"auto",flex:1};return n.jsx("div",{style:$,onClick:ae=>ae.stopPropagation(),children:n.jsxs("div",{ref:K,onClick:ae=>ae.stopPropagation(),style:{position:"fixed",top:m?`${m.y}px`:void 0,left:m?`${m.x}px`:void 0,backgroundColor:"#fff",borderRadius:8,minWidth:"300px",maxWidth:"400px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:10005,display:"flex",flexDirection:"column",pointerEvents:"auto",transform:"none"},children:[n.jsxs("div",{onMouseDown:ee,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:_?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[n.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Select Component"}),n.jsx("button",{type:"button",onMouseDown:ae=>{ae.stopPropagation()},onClick:ae=>{ae.stopPropagation(),v()},style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),n.jsxs("div",{style:H,children:[n.jsx("div",{style:{marginBottom:"16px"},onClick:ae=>ae.stopPropagation(),children:n.jsx("input",{ref:D,type:"text",placeholder:"Search by Component Type...",value:p,onChange:ae=>g(ae.target.value),onClick:ae=>ae.stopPropagation(),onMouseDown:ae=>ae.stopPropagation(),style:{width:"100%",padding:"8px 12px",fontSize:"13px",border:"1px solid #ddd",borderRadius:4,color:"#333",backgroundColor:"#fff",boxSizing:"border-box"}})}),n.jsxs("div",{style:{marginBottom:"20px",paddingBottom:"16px",borderBottom:"2px solid #eee"},onClick:ae=>ae.stopPropagation(),children:[n.jsx("div",{style:{marginBottom:"8px",fontSize:"14px",fontWeight:600,color:"#333"},children:"Layer:"}),n.jsxs("div",{style:{display:"flex",gap:"16px"},children:[n.jsxs("label",{onClick:ae=>ae.stopPropagation(),onMouseDown:ae=>ae.stopPropagation(),style:{display:"flex",alignItems:"center",cursor:"pointer",fontSize:"14px",color:"#333"},children:[n.jsx("input",{type:"radio",name:"componentLayer",checked:r==="top",onChange:()=>c("top"),onClick:ae=>ae.stopPropagation(),onMouseDown:ae=>ae.stopPropagation(),style:{marginRight:"8px",width:"20px",height:"20px",cursor:"pointer",accentColor:"#0066cc",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",border:r==="top"?"2px solid #0066cc":"2px solid #999",borderRadius:"50%",backgroundColor:r==="top"?"#0066cc":"transparent",position:"relative"}}),"Top"]}),n.jsxs("label",{onClick:ae=>ae.stopPropagation(),onMouseDown:ae=>ae.stopPropagation(),style:{display:"flex",alignItems:"center",cursor:"pointer",fontSize:"14px",color:"#333"},children:[n.jsx("input",{type:"radio",name:"componentLayer",checked:r==="bottom",onChange:()=>c("bottom"),onClick:ae=>ae.stopPropagation(),onMouseDown:ae=>ae.stopPropagation(),style:{marginRight:"8px",width:"20px",height:"20px",cursor:"pointer",accentColor:"#0066cc",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",border:r==="bottom"?"2px solid #0066cc":"2px solid #999",borderRadius:"50%",backgroundColor:r==="bottom"?"#0066cc":"transparent",position:"relative"}}),"Bottom"]})]})]}),n.jsxs("div",{children:[n.jsx("div",{style:{marginBottom:"12px",fontSize:"14px",fontWeight:600,color:"#333"},children:"Component Type:"}),n.jsx("div",{style:{maxHeight:"calc(80vh - 280px)",overflowY:"auto"},children:p.trim()?Se.length>0?Se.map(ae=>{const I=Pg(ae),oe=I.uniqueKey||`${ae.category}:${ae.subcategory}:${ae.type}:${ae.designator}`,pe=s===oe,Y=`${ae.designator} - ${ae.displayName}`;return n.jsxs("label",{onClick:X=>{X.stopPropagation(),d(I.componentType,oe,I)},onMouseDown:X=>X.stopPropagation(),style:{display:"block",width:"100%",textAlign:"left",padding:"8px 12px",marginBottom:"4px",background:pe?"#e6f0ff":"#fff",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",fontSize:"12px",color:"#333"},children:[n.jsx("input",{type:"radio",name:"componentType-search",checked:pe,onChange:()=>d(I.componentType,oe,I),onClick:X=>X.stopPropagation(),onMouseDown:X=>X.stopPropagation(),style:{marginRight:"10px",width:"20px",height:"20px",cursor:"pointer",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",border:pe?"2px solid #0066cc":"2px solid #999",borderRadius:"50%",backgroundColor:pe?"#0066cc":"transparent",position:"relative",flexShrink:0}}),n.jsx("strong",{children:Y})]},oe)}):n.jsxs("div",{style:{padding:"12px",color:"#666",fontSize:"12px",textAlign:"center"},children:['No matches found for "',p,'"']}):Object.entries(qy).map(([ae,I])=>I.length===0?null:n.jsxs("div",{style:{marginBottom:"12px"},children:[n.jsx("div",{style:{fontSize:"13px",fontWeight:600,color:"#333",padding:"6px 8px",marginBottom:"4px",backgroundColor:"#f5f5f5",borderRadius:4},children:ae}),n.jsx("div",{style:{marginLeft:"8px"},children:I.map(oe=>{const pe=Pg(oe),Y=pe.uniqueKey||`${oe.category}:${oe.subcategory}:${oe.type}:${oe.designator}`,X=s===Y,F=`${oe.designator} - ${oe.displayName}`;return n.jsxs("label",{onClick:R=>{R.stopPropagation(),d(pe.componentType,Y,pe)},onMouseDown:R=>R.stopPropagation(),style:{display:"block",width:"100%",textAlign:"left",padding:"6px 12px",marginBottom:"2px",background:X?"#e6f0ff":"#fff",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",fontSize:"12px",color:"#333"},children:[n.jsx("input",{type:"radio",name:`componentType-${ae}`,checked:X,onChange:()=>d(pe.componentType,Y,pe),onMouseDown:R=>R.stopPropagation(),style:{marginRight:"10px",width:"20px",height:"20px",cursor:"pointer",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",border:X?"2px solid #0066cc":"2px solid #999",borderRadius:"50%",backgroundColor:X?"#0066cc":"transparent",position:"relative",flexShrink:0}}),F]},Y)})})]},ae))})]})]})]})})},Vv=({visible:i,onClose:r,powerBuses:o,setPowerBuses:s,editingPowerBusId:c,setEditingPowerBusId:d,powers:v})=>{const[p,g]=L.useState(null),[m,S]=L.useState(!1),[_,E]=L.useState(null),T=L.useRef(null);L.useEffect(()=>{i&&!p&&g({x:window.innerWidth/2-140,y:window.innerHeight/2-200})},[i,p]),L.useEffect(()=>{if(!m)return;const H=I=>{p&&_&&g({x:I.clientX-_.x,y:I.clientY-_.y})},ae=()=>{S(!1),E(null)};return window.addEventListener("mousemove",H),window.addEventListener("mouseup",ae),()=>{window.removeEventListener("mousemove",H),window.removeEventListener("mouseup",ae)}},[m,p,_]);const K=o.filter(H=>H.id!==c),D=o.find(H=>H.id===c);if(!i)return null;const ee=[...K].sort((H,ae)=>{const I=Y=>{const X=Y.match(/([+-]?)(\d+\.?\d*)/);if(X){const F=X[1]||"+",R=parseFloat(X[2]);return{absValue:Math.abs(R),isNegative:F==="-"}}return{absValue:1/0,isNegative:!1}},oe=I(H.voltage),pe=I(ae.voltage);return oe.absValue!==pe.absValue?oe.absValue-pe.absValue:oe.isNegative!==pe.isNegative?oe.isNegative?-1:1:0}),w=D?[...ee,D]:ee,Se=()=>{const H={id:`powerbus-${Date.now()}-${Math.random()}`,name:"New Power Bus",voltage:"+0.0",color:"#ff0000"};s(ae=>[...ae,H]),d(H.id)},$=H=>{const ae=H.target;ae.tagName==="BUTTON"||ae.tagName==="INPUT"||ae.closest("button")||ae.closest("input")||p&&(E({x:H.clientX-p.x,y:H.clientY-p.y}),S(!0),H.preventDefault())};return n.jsxs("div",{ref:T,style:{position:"fixed",top:p?`${p.y}px`:"50%",left:p?`${p.x}px`:"50%",transform:p?"none":"translate(-50%, -50%)",background:"#fff",border:"1px solid #0b5fff",borderRadius:4,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"280px",maxWidth:"320px",maxHeight:"80vh",display:"flex",flexDirection:"column",cursor:m?"grabbing":"default"},children:[n.jsxs("div",{onMouseDown:$,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:m?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[n.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Manage Power Buses"}),n.jsx("button",{onClick:r,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"6px 20px 6px 6px",overflowY:"auto",flex:1,minHeight:0},children:w.map(H=>{const ae=o.find(Y=>Y.id===H.id)||H,I=o.findIndex(Y=>Y.id===H.id),oe=o.some(Y=>Y.name===ae.name&&Y.id!==H.id),pe=o.some(Y=>Y.voltage===ae.voltage&&Y.id!==H.id);return n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"4px",marginBottom:"4px",background:"#f9f9f9",borderRadius:4,border:"1px solid #e0e0e0"},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsxs("div",{style:{flex:1,minWidth:0,display:"flex",flexDirection:"column",gap:"4px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"50px",flexShrink:0},children:"Name:"}),n.jsx("input",{type:"text",value:ae.name,onChange:Y=>{const X=Y.target.value;if(!o.some(R=>R.name===X&&R.id!==H.id)){const R=[...o];I>=0&&(R[I]={...ae,name:X},s(R))}},placeholder:"e.g., +5VDC",style:{flex:1,padding:"2px 3px",border:oe?"1px solid #ff0000":"1px solid #ddd",borderRadius:2,fontSize:"10px",background:"#f5f5f5",color:"#000"}})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"50px",flexShrink:0},children:"Value:"}),n.jsx("input",{type:"text",inputMode:"decimal",value:ae.voltage,onChange:Y=>{const X=Y.target.value;if(X===""||/^[+-]?\d*\.?\d*$/.test(X)){const F=[...o];I>=0&&(F[I]={...ae,voltage:X},s(F))}},onBlur:Y=>{const X=Y.target.value.trim();if(X==="")return;const F=parseFloat(X);if(!isNaN(F)){const R=F>=0?"+":"-",U=Math.abs(F),O=`${R}${U.toFixed(1).replace(/\.?0+$/,"")}`,_e=[...o];I>=0&&(_e[I]={...ae,voltage:O},s(_e))}},placeholder:"e.g., +5.0",style:{flex:1,padding:"2px 3px",border:pe?"1px solid #ff0000":"1px solid #ddd",borderRadius:2,fontSize:"10px",background:"#f5f5f5",color:"#000"}})]})]}),n.jsx("input",{type:"color",value:ae.color,onChange:Y=>{const X=[...o];I>=0&&(X[I]={...ae,color:Y.target.value},s(X))},style:{width:"24px",height:"24px",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",flexShrink:0},title:"Color"}),n.jsx("button",{onClick:()=>{const Y=v.filter(X=>X.powerBusId===H.id);if(Y.length>0){alert(`Cannot delete: ${Y.length} power node(s) are using this bus. Remove or reassign them first.`);return}s(X=>X.filter(F=>F.id!==H.id))},style:{padding:"2px 6px",background:"#f5f5f5",color:"#333",border:"1px solid #ddd",borderRadius:2,cursor:"pointer",fontSize:"9px",flexShrink:0},children:"Delete"})]})},H.id)})}),n.jsxs("div",{style:{padding:"6px",borderTop:"1px solid #e0e0e0",display:"flex",gap:"4px",flexShrink:0},children:[n.jsx("button",{onClick:Se,style:{flex:1,padding:"4px 8px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",fontSize:"10px"},children:"+ Add Power Bus"}),n.jsx("button",{onClick:r,style:{flex:1,padding:"4px 8px",background:"#0b5fff",color:"#fff",border:"none",borderRadius:2,cursor:"pointer",fontSize:"10px",fontWeight:500},children:"Close"})]})]})},Hv=({visible:i,onClose:r,groundBuses:o,setGroundBuses:s,editingGroundBusId:c,setEditingGroundBusId:d,grounds:v})=>{const[p,g]=L.useState(null),[m,S]=L.useState(!1),[_,E]=L.useState(null),T=L.useRef(null);L.useEffect(()=>{i&&!p&&g({x:window.innerWidth/2-140,y:window.innerHeight/2-200})},[i,p]),L.useEffect(()=>{if(!m)return;const H=I=>{p&&_&&g({x:I.clientX-_.x,y:I.clientY-_.y})},ae=()=>{S(!1),E(null)};return window.addEventListener("mousemove",H),window.addEventListener("mouseup",ae),()=>{window.removeEventListener("mousemove",H),window.removeEventListener("mouseup",ae)}},[m,p,_]);const K=o.filter(H=>H.id!==c),D=o.find(H=>H.id===c);if(!i)return null;const ee=[...K].sort((H,ae)=>H.name.localeCompare(ae.name)),w=D?[...ee,D]:ee,Se=()=>{const H={id:`groundbus-${Date.now()}-${Math.random()}`,name:"New Ground Bus",color:"#000000"};s(ae=>[...ae,H]),d(H.id)},$=H=>{const ae=H.target;ae.tagName==="BUTTON"||ae.tagName==="INPUT"||ae.closest("button")||ae.closest("input")||p&&(E({x:H.clientX-p.x,y:H.clientY-p.y}),S(!0),H.preventDefault())};return n.jsxs("div",{ref:T,style:{position:"fixed",top:p?`${p.y}px`:"50%",left:p?`${p.x}px`:"50%",transform:p?"none":"translate(-50%, -50%)",background:"#fff",border:"1px solid #0b5fff",borderRadius:4,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"280px",maxWidth:"320px",maxHeight:"80vh",display:"flex",flexDirection:"column",cursor:m?"grabbing":"default"},children:[n.jsxs("div",{onMouseDown:$,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:m?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[n.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Manage Ground Buses"}),n.jsx("button",{onClick:r,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"6px 20px 6px 6px",overflowY:"auto",flex:1,minHeight:0},children:w.map(H=>{const ae=o.find(pe=>pe.id===H.id)||H,I=o.findIndex(pe=>pe.id===H.id),oe=o.some(pe=>pe.name===ae.name&&pe.id!==H.id);return n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",padding:"4px",marginBottom:"4px",background:"#f9f9f9",borderRadius:4,border:"1px solid #e0e0e0"},children:[n.jsx("div",{style:{flex:1,minWidth:0},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"50px",flexShrink:0},children:"Name:"}),n.jsx("input",{type:"text",value:ae.name,onChange:pe=>{const Y=pe.target.value;if(!o.some(F=>F.name===Y&&F.id!==H.id)){const F=[...o];I>=0&&(F[I]={...ae,name:Y},s(F))}},placeholder:"e.g., GND, Earth",style:{flex:1,padding:"2px 3px",border:oe?"1px solid #ff0000":"1px solid #ddd",borderRadius:2,fontSize:"10px",background:"#f5f5f5",color:"#000"}})]})}),n.jsx("input",{type:"color",value:ae.color,onChange:pe=>{const Y=[...o];I>=0&&(Y[I]={...ae,color:pe.target.value},s(Y))},style:{width:"24px",height:"24px",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",flexShrink:0},title:"Color"}),n.jsx("button",{onClick:()=>{const pe=v.filter(Y=>Y.groundBusId===H.id);if(pe.length>0){alert(`Cannot delete: ${pe.length} ground node(s) are using this bus. Remove or reassign them first.`);return}s(Y=>Y.filter(X=>X.id!==H.id))},style:{padding:"2px 6px",background:"#f5f5f5",color:"#333",border:"1px solid #ddd",borderRadius:2,cursor:"pointer",fontSize:"9px",flexShrink:0},children:"Delete"})]},H.id)})}),n.jsxs("div",{style:{padding:"6px",borderTop:"1px solid #e0e0e0",display:"flex",gap:"4px",flexShrink:0},children:[n.jsx("button",{onClick:Se,style:{flex:1,padding:"4px 8px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",fontSize:"10px"},children:"+ Add Ground Bus"}),n.jsx("button",{onClick:r,style:{flex:1,padding:"4px 8px",background:"#0b5fff",color:"#fff",border:"none",borderRadius:2,cursor:"pointer",fontSize:"10px",fontWeight:500},children:"Close"})]})]})},Wv=({visible:i,onClose:r,autoAssignDesignators:o,setAutoAssignDesignators:s,useGlobalDesignatorCounters:c,setUseGlobalDesignatorCounters:d})=>i?n.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#fff",border:"1px solid #ddd",borderRadius:6,padding:"16px",zIndex:1e3,minWidth:"300px",maxWidth:"400px",boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[n.jsx("h2",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#222"},children:"Manage Designators"}),n.jsx("button",{onClick:r,style:{background:"transparent",border:"none",fontSize:"18px",cursor:"pointer",color:"#666",padding:0,width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),n.jsxs("div",{style:{marginBottom:"16px"},children:[n.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:"13px",color:"#333",marginBottom:"12px"},children:[n.jsx("input",{type:"checkbox",checked:o,onChange:v=>{s(v.target.checked)},style:{width:"16px",height:"16px",cursor:"pointer"}}),n.jsx("span",{children:"Automatically assign designators"})]}),n.jsx("div",{style:{marginTop:"8px",padding:"8px",background:"#f5f5f5",borderRadius:4,fontSize:"11px",color:"#666",lineHeight:"1.4",marginBottom:"12px"},children:o?n.jsx("div",{children:"When enabled, new components automatically receive sequential designators (e.g., C1, C2, C3 for Capacitors; R1, R2, R3 for Resistors)."}):n.jsx("div",{children:"When disabled, you must manually assign designators to each component. The designator field will be empty when components are created."})}),n.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:"13px",color:"#333"},children:[n.jsx("input",{type:"checkbox",checked:c,onChange:v=>{d(v.target.checked)},style:{width:"16px",height:"16px",cursor:"pointer"}}),n.jsx("span",{children:"Use global designator counters"})]}),n.jsx("div",{style:{marginTop:"8px",padding:"8px",background:"#f5f5f5",borderRadius:4,fontSize:"11px",color:"#666",lineHeight:"1.4"},children:c?n.jsx("div",{children:"When ON, designators continue from global counters across all projects. New components start with the next value from the global counter (e.g., if global counter is C10, new capacitor will be C11)."}):n.jsx("div",{children:"When OFF (default), designators start at 1 for each project. Each project maintains its own independent designator sequence (e.g., C1, C2, C3...)."})})]}),n.jsx("button",{onClick:r,style:{width:"100%",padding:"6px 12px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:4,cursor:"pointer",fontSize:"12px"},children:"Close"})]}):null,Fx=({visible:i,title:r,message:o,onYes:s,onNo:c,onCancel:d,yesButtonRef:v})=>i?n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001},onClick:p=>{p.target===p.currentTarget&&d()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:p=>p.stopPropagation(),children:[n.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:r}),n.jsx("p",{style:{margin:"0 0 24px 0",fontSize:"14px",color:"#e0e0e0",lineHeight:"1.5"},children:o}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[n.jsx("button",{onClick:d,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),n.jsx("button",{onClick:c,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"No"}),n.jsx("button",{ref:v,onClick:s,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},autoFocus:!0,children:"Yes"})]})]})}):null,$v=({visible:i,size:r,onSizeChange:o,onApply:s,onCancel:c})=>{const d=L.useRef(null);if(L.useEffect(()=>{i&&d.current&&(d.current.focus(),d.current.select())},[i]),!i)return null;const v=[2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32];return n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10003},onClick:p=>{p.target===p.currentTarget&&c()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:p=>p.stopPropagation(),children:[n.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Set Size"}),n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Size (pixels):"}),n.jsx("input",{ref:d,type:"number",min:"1",max:"99",value:r,onChange:p=>{const g=parseInt(p.target.value)||1,m=Math.max(1,Math.min(99,g));o(m)},onKeyDown:p=>{if(p.key==="Enter"?s():p.key==="Escape"&&c(),p.key.length===1&&/[0-9]/.test(p.key)){const g=r.toString();g.length>=2&&d.current?.selectionStart===d.current?.selectionEnd&&d.current?.selectionStart===g.length&&p.preventDefault()}},onInput:p=>{const g=p.target,m=g.value;if(m.length>2){g.value=m.slice(0,2);const S=parseInt(g.value)||1;o(Math.max(1,Math.min(99,S)))}},style:{width:"100%",padding:"8px 12px",marginBottom:"16px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0}),n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Or select from list:"}),n.jsxs("select",{value:v.includes(r)?r:"",onChange:p=>{const g=parseInt(p.target.value);!isNaN(g)&&g>0&&o(g)},style:{width:"100%",padding:"8px 12px",marginBottom:"20px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},children:[n.jsx("option",{value:"",style:{background:"#1f1f24",color:"#f2f2f2"},children:"-- Select --"}),v.map(p=>n.jsxs("option",{value:p,style:{background:"#1f1f24",color:"#f2f2f2"},children:[p," pixels"]},p))]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[n.jsx("button",{onClick:c,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),n.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Apply"})]})]})})},Yv=({visible:i,interval:r,onIntervalChange:o,onApply:s,onCancel:c})=>i?n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10003},onClick:d=>{d.target===d.currentTarget&&c()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:d=>d.stopPropagation(),children:[n.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Auto Save"}),n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Select time interval:"}),n.jsxs("select",{value:r===null?"disable":(r||5).toString(),onChange:d=>{const v=d.target.value;if(v==="disable")o(null);else{const p=parseFloat(v);!isNaN(p)&&p>0&&o(p)}},style:{width:"100%",padding:"8px 12px",marginBottom:"20px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0,children:[n.jsx("option",{value:"1",style:{background:"#1f1f24",color:"#f2f2f2"},children:"1 minute"}),n.jsx("option",{value:"5",style:{background:"#1f1f24",color:"#f2f2f2"},children:"5 minutes"}),n.jsx("option",{value:"10",style:{background:"#1f1f24",color:"#f2f2f2"},children:"10 minutes"}),n.jsx("option",{value:"20",style:{background:"#1f1f24",color:"#f2f2f2"},children:"20 minutes"}),n.jsx("option",{value:"30",style:{background:"#1f1f24",color:"#f2f2f2"},children:"30 minutes"}),n.jsx("option",{value:"disable",style:{background:"#1f1f24",color:"#f2f2f2"},children:"Disable"})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[n.jsx("button",{onClick:c,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),n.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Apply"})]})]})}):null,Gv=({visible:i,interval:r,onIntervalChange:o,onEnable:s,onSkip:c})=>i?n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:d=>{d.target===d.currentTarget&&c()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:d=>d.stopPropagation(),children:[n.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Enable Auto Save?"}),n.jsx("p",{style:{margin:"0 0 20px 0",fontSize:"14px",color:"#e0e0e0",lineHeight:"1.5"},children:"We recommend enabling Auto Save to automatically save your project at regular intervals. This helps protect your work from accidental loss."}),n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Select time interval:"}),n.jsxs("select",{value:r===null?"disable":(r||5).toString(),onChange:d=>{const v=d.target.value;if(v==="disable")o(null);else{const p=parseFloat(v);!isNaN(p)&&p>0&&o(p)}},style:{width:"100%",padding:"8px 12px",marginBottom:"24px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0,children:[n.jsx("option",{value:"1",style:{background:"#1f1f24",color:"#f2f2f2"},children:"1 minute"}),n.jsx("option",{value:"5",style:{background:"#1f1f24",color:"#f2f2f2"},children:"5 minutes"}),n.jsx("option",{value:"10",style:{background:"#1f1f24",color:"#f2f2f2"},children:"10 minutes"}),n.jsx("option",{value:"20",style:{background:"#1f1f24",color:"#f2f2f2"},children:"20 minutes"}),n.jsx("option",{value:"30",style:{background:"#1f1f24",color:"#f2f2f2"},children:"30 minutes"})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[n.jsx("button",{onClick:c,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Skip"}),n.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Enable Auto Save"})]})]})}):null,Xv=({visible:i,projectDirHandle:r,onClose:o,onRestore:s,position:c,isDragging:d=!1,onDragStart:v})=>{const[p,g]=L.useState([]),[m,S]=L.useState(!1),[_,E]=L.useState(null),[T,K]=L.useState(null),D=L.useRef(null);L.useEffect(()=>{if(!i||!r){g([]),E(null),K(null);return}(async()=>{S(!0),K(null);try{let ae;try{ae=await r.getDirectoryHandle("history")}catch{g([]),S(!1);return}const I=pe=>{const Y=pe.match(/_(\d{4})_(\d{2})_(\d{2})-(\d{2})-(\d{2})-(\d{2})\.json$/);if(Y){const[,F,R,U,O,_e,ce]=Y;return new Date(parseInt(F),parseInt(R)-1,parseInt(U),parseInt(O),parseInt(_e),parseInt(ce))}const X=pe.match(/_(\d{4})_(\d{2})_(\d{2})_(\d{2})_(\d{2})_(\d{2})\.json$/);if(X){const[,F,R,U,O,_e,ce]=X;return new Date(parseInt(F),parseInt(R)-1,parseInt(U),parseInt(O),parseInt(_e),parseInt(ce))}return null},oe=[];for await(const pe of ae.keys())if(pe.endsWith(".json"))try{const X=await(await ae.getFileHandle(pe)).getFile(),F=I(pe);oe.push({name:pe,lastModified:new Date(X.lastModified),size:X.size,timestamp:F||new Date(X.lastModified)})}catch(Y){console.warn(`Failed to read file ${pe}:`,Y)}oe.sort((pe,Y)=>Y.timestamp.getTime()-pe.timestamp.getTime()),g(oe)}catch(ae){console.error("Failed to load history files:",ae),K("Failed to load history files. Please try again.")}finally{S(!1)}})()},[i,r]);const ee=async()=>{if(_)try{await s(_),o()}catch(H){console.error("Failed to restore file:",H),K("Failed to restore file. Please try again.")}},w=H=>H.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),Se=H=>H<1024?`${H} B`:H<1024*1024?`${(H/1024).toFixed(1)} KB`:`${(H/(1024*1024)).toFixed(1)} MB`;if(!i)return null;const $=c?{position:"fixed",left:`${c.x}px`,top:`${c.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"500px",maxWidth:"700px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:d?"grabbing":"default"}:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"#fff",borderRadius:8,minWidth:"500px",maxWidth:"700px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column"};return n.jsxs("div",{style:$,children:[n.jsxs("div",{onMouseDown:v,style:{backgroundColor:"#f5f5f5",padding:"12px 16px",borderBottom:"1px solid #ddd",borderRadius:"8px 8px 0 0",cursor:d?"grabbing":"move",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsx("h2",{style:{margin:0,fontSize:"16px",fontWeight:600,color:"#000"},children:"PastTime"}),n.jsx("button",{onClick:o,style:{background:"transparent",border:"none",fontSize:"20px",cursor:"pointer",color:"#666",padding:"0 4px",lineHeight:1},title:"Close",children:""})]}),n.jsxs("div",{style:{padding:"16px",display:"flex",flexDirection:"column",flex:1,minHeight:0},children:[T&&n.jsx("div",{style:{padding:"12px",backgroundColor:"#fee",color:"#c00",borderRadius:4,marginBottom:"12px"},children:T}),m?n.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"Loading history files..."}):p.length===0?n.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"No history files found."}):n.jsxs(n.Fragment,{children:[n.jsx("div",{style:{marginBottom:"12px",color:"#333",fontSize:"14px"},children:"Select a file to restore:"}),n.jsx("div",{ref:D,style:{border:"1px solid #ddd",borderRadius:4,overflowY:"auto",maxHeight:"400px",backgroundColor:"#fafafa"},children:p.map((H,ae)=>n.jsxs("div",{onClick:()=>E(H.name),style:{padding:"12px 16px",borderBottom:ae<p.length-1?"1px solid #eee":"none",backgroundColor:_===H.name?"#e6f0ff":"transparent",cursor:"pointer",transition:"background-color 0.1s"},onMouseEnter:I=>{_!==H.name&&(I.currentTarget.style.backgroundColor="#f5f5f5")},onMouseLeave:I=>{_!==H.name&&(I.currentTarget.style.backgroundColor="transparent")},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"4px"},children:[n.jsx("div",{style:{fontWeight:600,color:"#000",fontSize:"13px",wordBreak:"break-word",flex:1},children:H.name}),n.jsx("div",{style:{color:"#666",fontSize:"12px",marginLeft:"12px",whiteSpace:"nowrap"},children:Se(H.size)})]}),n.jsx("div",{style:{color:"#666",fontSize:"12px"},children:w(H.lastModified)})]},H.name))})]})]}),n.jsxs("div",{style:{padding:"12px 16px",borderTop:"1px solid #ddd",display:"flex",justifyContent:"flex-end",gap:"8px"},children:[n.jsx("button",{onClick:o,style:{padding:"6px 16px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"13px"},children:"Cancel"}),n.jsx("button",{onClick:ee,disabled:!_||m,style:{padding:"6px 16px",background:_&&!m?"#0066cc":"#ccc",border:"none",borderRadius:4,cursor:_&&!m?"pointer":"not-allowed",color:"#fff",fontSize:"13px",fontWeight:500},children:"Restore"})]})]})},Kv=()=>n.jsxs("svg",{width:"45",height:"30",viewBox:"0 0 45 30",style:{marginLeft:"8px",flexShrink:0},children:[n.jsx("rect",{x:"8",y:"4",width:"29",height:"14",rx:"2",ry:"2",fill:"#000"}),n.jsx("rect",{x:"10",y:"18",width:"2.5",height:"6",rx:"0.5",fill:"#000"}),n.jsx("rect",{x:"14.5",y:"18",width:"2.5",height:"6",rx:"0.5",fill:"#000"}),n.jsx("rect",{x:"19",y:"18",width:"2.5",height:"6",rx:"0.5",fill:"#000"}),n.jsx("rect",{x:"23.5",y:"18",width:"2.5",height:"6",rx:"0.5",fill:"#000"}),n.jsx("rect",{x:"28",y:"18",width:"2.5",height:"6",rx:"0.5",fill:"#000"}),n.jsx("rect",{x:"32.5",y:"18",width:"2.5",height:"6",rx:"0.5",fill:"#000"})]}),Zv=()=>n.jsxs("svg",{width:"40",height:"30",viewBox:"0 0 40 30",style:{marginLeft:"8px",flexShrink:0},children:[n.jsx("rect",{x:"2",y:"11",width:"5",height:"2.5",rx:"0.5",fill:"#000"}),n.jsx("rect",{x:"2",y:"14.5",width:"5",height:"2.5",rx:"0.5",fill:"#000"}),n.jsx("rect",{x:"2",y:"18",width:"5",height:"2.5",rx:"0.5",fill:"#000"}),n.jsx("rect",{x:"7",y:"6",width:"26",height:"18",rx:"2",ry:"2",fill:"#000"}),n.jsx("rect",{x:"13",y:"10",width:"14",height:"10",rx:"1.5",ry:"1.5",fill:"#fff"}),n.jsx("circle",{cx:"14.5",cy:"11.5",r:"1",fill:"#000"}),n.jsx("rect",{x:"33",y:"11",width:"5",height:"2.5",rx:"0.5",fill:"#000"}),n.jsx("rect",{x:"33",y:"14.5",width:"5",height:"2.5",rx:"0.5",fill:"#000"}),n.jsx("rect",{x:"33",y:"18",width:"5",height:"2.5",rx:"0.5",fill:"#000"})]}),Jv=()=>n.jsxs("svg",{width:"35",height:"35",viewBox:"0 0 35 35",style:{marginLeft:"8px",flexShrink:0},children:[n.jsx("rect",{x:"12",y:"2",width:"2.5",height:"4",rx:"0.5",fill:"#000"}),n.jsx("rect",{x:"16.25",y:"2",width:"2.5",height:"4",rx:"0.5",fill:"#000"}),n.jsx("rect",{x:"20.5",y:"2",width:"2.5",height:"4",rx:"0.5",fill:"#000"}),n.jsx("rect",{x:"2",y:"12",width:"4",height:"2.5",rx:"0.5",fill:"#000"}),n.jsx("rect",{x:"2",y:"16.25",width:"4",height:"2.5",rx:"0.5",fill:"#000"}),n.jsx("rect",{x:"2",y:"20.5",width:"4",height:"2.5",rx:"0.5",fill:"#000"}),n.jsx("rect",{x:"6",y:"6",width:"23",height:"23",fill:"#000"}),n.jsx("rect",{x:"29",y:"12",width:"4",height:"2.5",rx:"0.5",fill:"#000"}),n.jsx("rect",{x:"29",y:"16.25",width:"4",height:"2.5",rx:"0.5",fill:"#000"}),n.jsx("rect",{x:"29",y:"20.5",width:"4",height:"2.5",rx:"0.5",fill:"#000"}),n.jsx("rect",{x:"12",y:"29",width:"2.5",height:"4",rx:"0.5",fill:"#000"}),n.jsx("rect",{x:"16.25",y:"29",width:"2.5",height:"4",rx:"0.5",fill:"#000"}),n.jsx("rect",{x:"20.5",y:"29",width:"2.5",height:"4",rx:"0.5",fill:"#000"})]}),Vy=({rotate:i=0})=>{const s=i!==0?`rotate(${i} 20 20)`:"";return n.jsx("svg",{width:"40",height:"40",viewBox:"0 0 40 40",style:{marginLeft:"8px",flexShrink:0},children:n.jsxs("g",{transform:s,children:[n.jsx("rect",{x:"8",y:"10",width:"24",height:"20",rx:"2",ry:"2",fill:"#555"}),n.jsx("rect",{x:"2",y:"12",width:"6",height:"3",rx:"1",ry:"1",fill:"#555"}),n.jsx("rect",{x:"2",y:"18",width:"6",height:"3",rx:"1",ry:"1",fill:"#555"}),n.jsx("rect",{x:"2",y:"24",width:"6",height:"3",rx:"1",ry:"1",fill:"#555"}),n.jsx("rect",{x:"32",y:"12",width:"6",height:"3",rx:"1",ry:"1",fill:"#555"}),n.jsx("rect",{x:"32",y:"18",width:"6",height:"3",rx:"1",ry:"1",fill:"#555"}),n.jsx("rect",{x:"32",y:"24",width:"6",height:"3",rx:"1",ry:"1",fill:"#555"}),n.jsx("rect",{x:"12",y:"14",width:"16",height:"12",rx:"1.5",ry:"1.5",fill:"#fff"}),n.jsx("circle",{cx:"14",cy:"16",r:"1.5",fill:"#555"})]})})},Qv=()=>n.jsx(Vy,{rotate:0}),ew=()=>n.jsx(Vy,{rotate:90}),tw=({visible:i,isPad:r,onConfirm:o,onClose:s})=>{const[c,d]=L.useState("linear"),[v,p]=L.useState("vertical-edges"),[g,m]=L.useState("8"),[S,_]=L.useState("");L.useEffect(()=>{i&&(d("linear"),p("vertical-edges"),m("8"),_(""))},[i]);const E=(D,ee)=>{const w=D.trim();if(w==="")return{valid:!1,error:"Number of pins is required."};const Se=parseInt(w,10);return isNaN(Se)?{valid:!1,error:"Please enter a valid number."}:Se<1?{valid:!1,error:"Number of pins must be >= 1."}:ee==="linear"?Se!==Math.floor(Se)||Se<=0?{valid:!1,error:"Linear arrangement requires a positive integer."}:{valid:!0,error:"",numPins:Se}:ee==="twoSided"?Se!==Math.floor(Se)||Se<=0?{valid:!1,error:"2-sided arrangement requires a positive integer."}:Se%2!==0?{valid:!1,error:"2-sided components must have an even number of pins."}:{valid:!0,error:"",numPins:Se}:ee==="fourSided"?Se!==Math.floor(Se)||Se<=0?{valid:!1,error:"4-sided arrangement requires a positive integer."}:Se%4!==0?{valid:!1,error:"4-sided components must have a number of pins divisible by 4."}:{valid:!0,error:"",numPins:Se}:{valid:!0,error:"",numPins:Se}},T=D=>{let ee=D===""?"":D.replace(/[^\d]/g,"");m(ee);const w=E(ee,c);w.error?_(w.error):_("")},K=L.useCallback(()=>{const D=E(g,c);if(!D.valid||D.numPins===void 0){_(D.error||"Invalid number of pins.");return}_(""),o({numPins:D.numPins,type:c,...c==="twoSided"?{twoSidedOrientation:v}:{}})},[g,c,v,o]);return L.useEffect(()=>{if(!i)return;const D=ee=>{ee.key==="Enter"&&!ee.shiftKey&&!ee.ctrlKey&&!ee.altKey&&!ee.metaKey&&(ee.preventDefault(),K())};return window.addEventListener("keydown",D),()=>{window.removeEventListener("keydown",D)}},[i,K]),i?n.jsxs(n.Fragment,{children:[n.jsx("style",{children:`
        .number-input-large-spinners::-webkit-inner-spin-button,
        .number-input-large-spinners::-webkit-outer-spin-button {
          opacity: 1;
          height: 20px;
          width: 20px;
          cursor: pointer;
        }
        .number-input-large-spinners::-webkit-inner-spin-button {
          margin-right: 4px;
        }
      `}),n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},onClick:D=>{D.target===D.currentTarget&&s()},children:n.jsxs("div",{style:{backgroundColor:"#fff",padding:"20px",borderRadius:"8px",minWidth:"320px",maxWidth:"380px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},onClick:D=>D.stopPropagation(),children:[n.jsxs("h2",{style:{marginTop:0,marginBottom:"20px",color:"#222",fontSize:"18px"},children:[r?"Pad Pattern":"Via Pattern"," Placement"]}),n.jsxs("div",{style:{marginBottom:"15px"},children:[n.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#222",fontWeight:500},children:"Arrangement:"}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[n.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[n.jsx("input",{type:"radio",value:"linear",checked:c==="linear",onChange:D=>{const ee=D.target.value;d(ee);const w=E(g,ee);w.error?_(w.error):_("")},style:{marginRight:"8px"}}),n.jsx("span",{style:{color:"#222"},children:"Linear (1 side)"}),n.jsx(Kv,{})]}),n.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[n.jsx("input",{type:"radio",value:"twoSided",checked:c==="twoSided",onChange:D=>{const ee=D.target.value;d(ee);const w=E(g,ee);w.error?_(w.error):_("")},style:{marginRight:"8px"}}),n.jsx("span",{style:{color:"#222"},children:"2-Sided"}),n.jsx(Zv,{})]}),n.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[n.jsx("input",{type:"radio",value:"fourSided",checked:c==="fourSided",onChange:D=>{const ee=D.target.value;d(ee);const w=E(g,ee);w.error?_(w.error):_("")},style:{marginRight:"8px"}}),n.jsx("span",{style:{color:"#222"},children:"4-Sided"}),n.jsx(Jv,{})]})]})]}),c==="twoSided"&&n.jsxs("div",{style:{marginBottom:"15px"},children:[n.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#222",fontWeight:500},children:"Orientation:"}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[n.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[n.jsx("input",{type:"radio",value:"vertical-edges",checked:v==="vertical-edges",onChange:D=>p(D.target.value),style:{marginRight:"8px"}}),n.jsxs("span",{style:{color:"#222"},children:["Vertical ",r?"Pads":"Vias"," (left & right)"]}),n.jsx(Qv,{})]}),n.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[n.jsx("input",{type:"radio",value:"horizontal-edges",checked:v==="horizontal-edges",onChange:D=>p(D.target.value),style:{marginRight:"8px"}}),n.jsxs("span",{style:{color:"#222"},children:["Horizontal ",r?"Pads":"Vias"," (top & bottom)"]}),n.jsx(ew,{})]})]})]}),n.jsxs("div",{style:{marginBottom:"15px"},children:[n.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#222",fontWeight:500},children:"Number of Pins:"}),n.jsx("input",{type:"number",min:c==="linear"?1:c==="twoSided"?2:4,step:c==="linear"?1:c==="twoSided"?2:4,value:g,onChange:D=>T(D.target.value),onBlur:()=>{const D=E(g,c);D.valid?_(""):_(D.error)},style:{width:"80px",padding:"6px 24px 6px 6px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px",color:"#000",background:"#fff"},className:"number-input-large-spinners"}),S&&n.jsx("div",{style:{color:"#d32f2f",fontSize:"12px",marginTop:"4px"},children:S})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",marginTop:"20px"},children:[n.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),n.jsx("button",{onClick:K,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"OK"})]})]})})]}):null};function nw(i,r){const o={x:i.x,y:i.y},s={x:r.x,y:r.y},c={x:s.x,y:o.y},d={x:o.x,y:s.y};return{corner1:o,corner2:c,corner3:s,corner4:d}}function iw(i){if(i.numPins<1)throw new Error("Number of pins must be >= 1.");if(i.type==="twoSided"){if(i.numPins%2!==0)throw new Error("2-sided components must have an even number of pins.");if(!i.twoSidedOrientation)throw new Error("Orientation required for 2-sided components.")}if(i.type==="fourSided"&&i.numPins%4!==0)throw new Error("4-sided components must have N divisible by 4.");if(Math.abs(i.point1.x-i.point2.x)<.001||Math.abs(i.point1.y-i.point2.y)<.001)throw new Error("Area must have non-zero width and height.")}function rw(i,r){const o=[],{corner1:s,corner2:c,corner3:d,corner4:v}=r,p=Math.abs(c.x-s.x),g=Math.abs(d.y-c.y);if(p>g){const m=(s.y+v.y)/2,S=Math.min(s.x,c.x),_=Math.max(s.x,c.x),E=_-S,T=i.numPins>1?E/(i.numPins-1):0,K=Math.hypot(s.x-S,s.y-m),D=Math.hypot(s.x-_,s.y-m),ee=K<D;if(i.numPins===1)o.push({pinNumber:1,x:(S+_)/2,y:m});else for(let w=1;w<=i.numPins;w++){const Se=ee?S+(w-1)*T:_-(w-1)*T;o.push({pinNumber:w,x:Se,y:m})}}else{const m=(s.x+c.x)/2,S=Math.min(s.y,c.y),_=Math.max(d.y,v.y),E=_-S,T=i.numPins>1?E/(i.numPins-1):0,K=Math.hypot(s.x-m,s.y-S),D=Math.hypot(s.x-m,s.y-_),ee=K<D;if(i.numPins===1)o.push({pinNumber:1,x:m,y:(S+_)/2});else for(let w=1;w<=i.numPins;w++){const Se=ee?S+(w-1)*T:_-(w-1)*T;o.push({pinNumber:w,x:m,y:Se})}}return o}function aw(i,r){const o=[],{corner1:s,corner2:c,corner3:d,corner4:v}=r,p=i.type==="fourSided"?i.numPins/4:i.numPins/2,g=Math.min(s.x,c.x,d.x,v.x),m=Math.min(s.y,c.y,d.y,v.y),S=Math.abs(s.y-m)<.001,_=Math.abs(s.x-g)<.001,E=S?_?"TopLeft":"TopRight":_?"BottomLeft":"BottomRight",T=Math.max(s.x,c.x,d.x,v.x),K=Math.max(s.y,c.y,d.y,v.y),D=(R,U,O=.001)=>{const _e=[s,c,d,v];for(const ce of _e)if(Math.abs(ce.x-R)<O&&Math.abs(ce.y-U)<O)return ce;return null},ee=D(g,m)||s,w=D(T,m)||c,Se=D(T,K)||d,$=D(g,K)||v,H={start:ee,end:$,name:"Left",direction:"Down"},ae={start:$,end:Se,name:"Bottom",direction:"Right"},I={start:Se,end:w,name:"Right",direction:"Up"},oe={start:w,end:ee,name:"Top",direction:"Left"};let pe;const Y=[];if(E==="TopLeft"?(pe=H,Y.push(H,ae,I,oe)):E==="BottomLeft"?(pe=ae,Y.push(ae,I,oe,H)):E==="BottomRight"?(pe=I,Y.push(I,oe,H,ae)):(pe=oe,Y.push(oe,H,ae,I)),i.type==="twoSided"){if(i.twoSidedOrientation==="vertical-edges"){if(E!=="TopLeft"&&E!=="BottomRight")throw new Error(`Invalid Pin 1 location for Left/Right orientation. Pin 1 is at ${E}, but must be at Top-Left or Bottom-Right.`)}else if(E!=="TopRight"&&E!=="BottomLeft")throw new Error(`Invalid Pin 1 location for Top/Bottom orientation. Pin 1 is at ${E}, but must be at Top-Right or Bottom-Left.`)}const X=[];i.type==="fourSided"?X.push(...Y):i.twoSidedOrientation==="vertical-edges"?pe===H?X.push(H,I):X.push(I,H):pe===oe?X.push(oe,ae):X.push(ae,oe);let F=1;for(const R of X){const U=Math.hypot(R.end.x-R.start.x,R.end.y-R.start.y),O=i.type==="fourSided"?U/(p+1):p>1?U/(p-1):0,_e=[];if(i.type==="fourSided")if(R.direction==="Down")for(let ce=1;ce<=p;ce++)_e.push({x:R.start.x,y:R.start.y+ce*O});else if(R.direction==="Right")for(let ce=1;ce<=p;ce++)_e.push({x:R.start.x+ce*O,y:R.start.y});else if(R.direction==="Up")for(let ce=1;ce<=p;ce++)_e.push({x:R.start.x,y:R.start.y-ce*O});else for(let ce=1;ce<=p;ce++)_e.push({x:R.start.x-ce*O,y:R.start.y});else if(p===1){const ce=(R.start.x+R.end.x)/2,xe=(R.start.y+R.end.y)/2;_e.push({x:ce,y:xe})}else if(R.direction==="Down")for(let ce=0;ce<p;ce++)_e.push({x:R.start.x,y:R.start.y+ce*O});else if(R.direction==="Right")for(let ce=0;ce<p;ce++)_e.push({x:R.start.x+ce*O,y:R.start.y});else if(R.direction==="Up")for(let ce=0;ce<p;ce++)_e.push({x:R.start.x,y:R.start.y-ce*O});else for(let ce=0;ce<p;ce++)_e.push({x:R.start.x-ce*O,y:R.start.y});if(R===pe){let ce=0,xe=1/0;for(let ke=0;ke<_e.length;ke++){const de=Math.hypot(_e[ke].x-s.x,_e[ke].y-s.y);de<xe&&(xe=de,ce=ke)}const fe=Math.hypot(R.start.x-s.x,R.start.y-s.y);if(xe<fe&&ce>0){const ke=_e.slice(0,ce),de=_e.slice(ce);_e.length=0,_e.push(...de,...ke)}}for(const ce of _e)o.push({pinNumber:F++,x:ce.x,y:ce.y})}return o}function ow(i){iw(i);const r=nw(i.point1,i.point2);return i.type==="linear"?rw(i,r):aw(i,r)}function sw(){const[i,r]=L.useState([]),[o,s]=L.useState(!1),[c,d]=L.useState([]),[v,p]=L.useState(null),[g,m]=L.useState("trace"),[S,_]=L.useState("top"),E=L.useRef([]),T=L.useRef(0),K=L.useRef(!1),D=L.useCallback(()=>{s(!0),d([]),E.current=[]},[]),ee=L.useCallback(()=>{s(!1),d([]),E.current=[]},[]),w=L.useCallback($=>{d(H=>[...H,$]),E.current=[...E.current,$]},[]),Se=L.useCallback($=>{r(H=>[...H,$]),d([]),E.current=[]},[]);return{drawingStrokes:i,setDrawingStrokes:r,isDrawing:o,setIsDrawing:s,currentStroke:c,setCurrentStroke:d,tracePreviewMousePos:v,setTracePreviewMousePos:p,drawingMode:g,setDrawingMode:m,selectedDrawingLayer:S,setSelectedDrawingLayer:_,currentStrokeRef:E,lastTraceClickTimeRef:T,isDoubleClickingTraceRef:K,startDrawing:D,stopDrawing:ee,addPointToStroke:w,finishStroke:Se}}function lw(){const[i,r]=L.useState(new Set),[o,s]=L.useState(!1),[c,d]=L.useState(new Set),[v,p]=L.useState(new Set),[g,m]=L.useState(new Set),S=L.useCallback(()=>{r(new Set),d(new Set),p(new Set),m(new Set)},[]),_=L.useCallback((K,D="stroke")=>{D==="stroke"?r(ee=>new Set([...ee,K])):D==="component"?d(ee=>new Set([...ee,K])):D==="power"?p(ee=>new Set([...ee,K])):D==="ground"&&m(ee=>new Set([...ee,K]))},[]),E=L.useCallback((K,D="stroke")=>{D==="stroke"?r(ee=>{const w=new Set(ee);return w.delete(K),w}):D==="component"?d(ee=>{const w=new Set(ee);return w.delete(K),w}):D==="power"?p(ee=>{const w=new Set(ee);return w.delete(K),w}):D==="ground"&&m(ee=>{const w=new Set(ee);return w.delete(K),w})},[]),T=L.useCallback((K,D="stroke")=>{D==="stroke"?r(K):D==="component"?d(K):D==="power"?p(K):D==="ground"&&m(K)},[]);return{selectedIds:i,setSelectedIds:r,isSelecting:o,setIsSelecting:s,selectedComponentIds:c,setSelectedComponentIds:d,selectedPowerIds:v,setSelectedPowerIds:p,selectedGroundIds:g,setSelectedGroundIds:m,clearSelection:S,addToSelection:_,removeFromSelection:E,setSelection:T}}function cw(){const[i,r]=L.useState(null),[o,s]=L.useState(!1),[c,d]=L.useState(null),[v,p]=L.useState("nudge"),g=L.useCallback((S,_)=>{r(S),s(!0),d(_)},[]),m=L.useCallback(()=>{s(!1),r(null),d(null)},[]);return{selectedImageForTransform:i,setSelectedImageForTransform:r,isTransforming:o,setIsTransforming:s,transformStartPos:c,setTransformStartPos:d,transformMode:v,setTransformMode:p,startTransform:g,stopTransform:m}}function uw(){const[i,r]=L.useState(null),[o,s]=L.useState(null),[c,d]=L.useState("overlay"),[v,p]=L.useState(50),[g,m]=L.useState(!1),[S,_]=L.useState(2e3),[E,T]=L.useState(!1),K=L.useCallback(w=>{r(w)},[]),D=L.useCallback(w=>{s(w)},[]),ee=L.useCallback(()=>{r(null),s(null)},[]);return{topImage:i,setTopImage:r,bottomImage:o,setBottomImage:s,currentView:c,setCurrentView:d,transparency:v,setTransparency:p,isTransparencyCycling:g,setIsTransparencyCycling:m,transparencyCycleSpeed:S,setTransparencyCycleSpeed:_,isGrayscale:E,setIsGrayscale:T,loadTopImage:K,loadBottomImage:D,clearImages:ee}}function dw(){const[i,r]=L.useState(1),[o,s]=L.useState({x:0,y:0}),[c,d]=L.useState(0),[v,p]=L.useState(!1),[g,m]=L.useState(!1),[S,_]=L.useState(!1),E=L.useCallback(()=>{r(1),s({x:0,y:0}),d(0),p(!1)},[]),T=L.useCallback(($=1.2)=>{r(H=>H*$)},[]),K=L.useCallback(($=1.2)=>{r(H=>H/$)},[]),D=L.useCallback($=>{r($)},[]),ee=L.useCallback(($,H,ae)=>{const I=$/ae,oe=H/ae;s(pe=>({x:pe.x-I,y:pe.y-oe}))},[]),w=L.useCallback(($,H)=>{s({x:$,y:H})},[]),Se=L.useCallback(($,H)=>({x:$-o.x*i,y:H-o.y*i}),[o,i]);return{viewScale:i,setViewScale:r,cameraWorldCenter:o,setCameraWorldCenter:s,viewRotation:c,setViewRotation:d,viewFlipX:v,setViewFlipX:p,isShiftConstrained:g,setIsShiftConstrained:m,showBothLayers:S,setShowBothLayers:_,resetView:E,zoomIn:T,zoomOut:K,setZoom:D,pan:ee,setCameraCenter:w,getViewPan:Se}}function fw(){const[i,r]=L.useState(()=>[{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),[o,s]=L.useState(()=>[{id:"groundbus-circuit",name:"GND",color:"#000000"}]),[c,d]=L.useState([]),[v,p]=L.useState([]),[g,m]=L.useState(null),[S,_]=L.useState(null),E=L.useCallback(I=>{r(oe=>[...oe,I])},[]),T=L.useCallback((I,oe)=>{r(pe=>pe.map(Y=>Y.id===I?{...Y,...oe}:Y))},[]),K=L.useCallback(I=>{r(oe=>oe.filter(pe=>pe.id!==I)),d(oe=>oe.filter(pe=>pe.powerBusId!==I))},[]),D=L.useCallback(I=>{d(oe=>[...oe,I])},[]),ee=L.useCallback(I=>{d(oe=>oe.filter(pe=>pe.id!==I))},[]),w=L.useCallback(I=>{p(oe=>[...oe,I])},[]),Se=L.useCallback(I=>{p(oe=>oe.filter(pe=>pe.id!==I))},[]),$=L.useCallback(I=>{s(oe=>[...oe,I])},[]),H=L.useCallback((I,oe)=>{s(pe=>pe.map(Y=>Y.id===I?{...Y,...oe}:Y))},[]),ae=L.useCallback(I=>{s(oe=>oe.filter(pe=>pe.id!==I)),p(oe=>oe.filter(pe=>pe.groundBusId===I))},[]);return{powerBuses:i,setPowerBuses:r,groundBuses:o,setGroundBuses:s,powerSymbols:c,setPowerSymbols:d,groundSymbols:v,setGroundSymbols:p,powerEditor:g,setPowerEditor:m,groundEditor:S,setGroundEditor:_,addPowerBus:E,updatePowerBus:T,removePowerBus:K,addPowerSymbol:D,removePowerSymbol:ee,addGroundSymbol:w,removeGroundSymbol:Se,addGroundBus:$,updateGroundBus:H,removeGroundBus:ae}}const ji={brushColor:"#008080",brushSize:6,topTraceColor:"#AA4499",bottomTraceColor:"#F781BF",topTraceSize:6,bottomTraceSize:6,viaSize:18,viaColor:"#ff0000",topPadColor:"#0072B2",bottomPadColor:"#56B4E9",topPadSize:18,bottomPadSize:18,topTestPointColor:"#FFFF00",bottomTestPointColor:"#FFFF00",topTestPointSize:18,bottomTestPointSize:18,topComponentColor:"#8C564B",bottomComponentColor:"#9C755F",topComponentSize:18,bottomComponentSize:18,componentConnectionColor:"#E69F00",componentConnectionSize:3};function pw(){const[i,r]=L.useState(ji.brushColor),[o,s]=L.useState(ji.brushSize),[c,d]=L.useState(ji.topTraceColor),[v,p]=L.useState(ji.bottomTraceColor),[g,m]=L.useState(ji.topTraceSize),[S,_]=L.useState(ji.bottomTraceSize),[E,T]=L.useState(ji.topPadColor),[K,D]=L.useState(ji.bottomPadColor),[ee,w]=L.useState(ji.topPadSize),[Se,$]=L.useState(ji.bottomPadSize),[H,ae]=L.useState(ji.topTestPointColor),[I,oe]=L.useState(ji.bottomTestPointColor),[pe,Y]=L.useState(ji.topTestPointSize),[X,F]=L.useState(ji.bottomTestPointSize),[R,U]=L.useState(ji.topComponentColor),[O,_e]=L.useState(ji.bottomComponentColor),[ce,xe]=L.useState(ji.topComponentSize),[fe,ke]=L.useState(ji.bottomComponentSize),[de,C]=L.useState(ji.componentConnectionColor),[z,G]=L.useState(ji.componentConnectionSize),V=L.useCallback(()=>{r(ji.brushColor),s(ji.brushSize),d(ji.topTraceColor),p(ji.bottomTraceColor),m(ji.topTraceSize),_(ji.bottomTraceSize),T(ji.topPadColor),D(ji.bottomPadColor),w(ji.topPadSize),$(ji.bottomPadSize),ae(ji.topTestPointColor),oe(ji.bottomTestPointColor),Y(ji.topTestPointSize),F(ji.bottomTestPointSize),U(ji.topComponentColor),_e(ji.bottomComponentColor),xe(ji.topComponentSize),ke(ji.bottomComponentSize),C(ji.componentConnectionColor),G(ji.componentConnectionSize)},[]),ie=L.useCallback(Re=>{Re.brushColor!==void 0&&r(Re.brushColor),Re.brushSize!==void 0&&s(Re.brushSize),Re.topTraceColor!==void 0&&d(Re.topTraceColor),Re.bottomTraceColor!==void 0&&p(Re.bottomTraceColor),Re.topTraceSize!==void 0&&m(Re.topTraceSize),Re.bottomTraceSize!==void 0&&_(Re.bottomTraceSize),Re.topPadColor!==void 0&&T(Re.topPadColor),Re.bottomPadColor!==void 0&&D(Re.bottomPadColor),Re.topPadSize!==void 0&&w(Re.topPadSize),Re.bottomPadSize!==void 0&&$(Re.bottomPadSize),Re.topTestPointColor!==void 0&&ae(Re.topTestPointColor),Re.bottomTestPointColor!==void 0&&oe(Re.bottomTestPointColor),Re.topTestPointSize!==void 0&&Y(Re.topTestPointSize),Re.bottomTestPointSize!==void 0&&F(Re.bottomTestPointSize),Re.topComponentColor!==void 0&&U(Re.topComponentColor),Re.bottomComponentColor!==void 0&&_e(Re.bottomComponentColor),Re.topComponentSize!==void 0&&xe(Re.topComponentSize),Re.bottomComponentSize!==void 0&&ke(Re.bottomComponentSize),Re.componentConnectionColor!==void 0&&C(Re.componentConnectionColor),Re.componentConnectionSize!==void 0&&G(Re.componentConnectionSize)},[]),he=L.useCallback((Re,Ue,et)=>{},[]),re=L.useCallback((Re,Ue,et)=>{},[]),Le=L.useCallback(()=>({brushColor:i,brushSize:o,topTraceColor:c,bottomTraceColor:v,topTraceSize:g,bottomTraceSize:S,viaSize:ji.viaSize,viaColor:ji.viaColor,topPadColor:E,bottomPadColor:K,topPadSize:ee,bottomPadSize:Se,topTestPointColor:H,bottomTestPointColor:I,topTestPointSize:pe,bottomTestPointSize:X,topComponentColor:R,bottomComponentColor:O,topComponentSize:ce,bottomComponentSize:fe,componentConnectionColor:de,componentConnectionSize:z}),[i,o,c,v,g,S,E,K,ee,Se,H,I,pe,X,R,O,ce,fe,de,z]);return{brushColor:i,setBrushColor:r,brushSize:o,setBrushSize:s,topTraceColor:c,setTopTraceColor:d,bottomTraceColor:v,setBottomTraceColor:p,topTraceSize:g,setTopTraceSize:m,bottomTraceSize:S,setBottomTraceSize:_,topPadColor:E,setTopPadColor:T,bottomPadColor:K,setBottomPadColor:D,topPadSize:ee,setTopPadSize:w,bottomPadSize:Se,setBottomPadSize:$,topTestPointColor:H,setTopTestPointColor:ae,bottomTestPointColor:I,setBottomTestPointColor:oe,topTestPointSize:pe,setTopTestPointSize:Y,bottomTestPointSize:X,setBottomTestPointSize:F,topComponentColor:R,setTopComponentColor:U,bottomComponentColor:O,setBottomComponentColor:_e,topComponentSize:ce,setTopComponentSize:xe,bottomComponentSize:fe,setBottomComponentSize:ke,componentConnectionColor:de,setComponentConnectionColor:C,componentConnectionSize:z,setComponentConnectionSize:G,resetToDefaults:V,loadFromProject:ie,getCurrentSettings:Le,saveDefaultSize:he,saveDefaultColor:re}}function hw(i,r,o,s,c,d,v,p,g,m,S,_,E,T,K,D,ee,w,Se,$,H,ae,I,oe,pe){const[Y,X]=L.useState(()=>i()),F=L.useRef(null),R=L.useRef(s),U=L.useRef(c),O=L.useCallback(xe=>r==="draw"&&o==="trace"?xe.get("trace"):r==="draw"&&o==="via"?xe.get("via"):r==="draw"&&o==="pad"?xe.get("pad"):r==="component"?xe.get("component"):r==="power"?xe.get("power"):r==="ground"?xe.get("ground"):null,[r,o]);L.useEffect(()=>{X(xe=>{const fe=O(xe),ke=fe?.id||null,de=F.current,C=new Map(xe);if(de&&de!==ke){const z=xe.get(de);z&&C.set(de,{...z,settings:{color:R.current,size:U.current}})}if(fe&&ke!==de)if(r==="draw"&&o==="trace"){const z=ae||"top",G=z==="top"?d:v,V=z==="top"?p:g;R.current=G,U.current=V,C.set("trace",{...fe,settings:{color:G,size:V}})}else if(r==="draw"&&o==="pad"){const z=I||"top",G=z==="top"?m:S,V=z==="top"?_:E;R.current=G,U.current=V,C.set("pad",{...fe,settings:{color:G,size:V}})}else if(r==="component"){const z=pe||"top",G=z==="top"?w:Se,V=z==="top"?$:H;R.current=G,U.current=V,C.set("component",{...fe,settings:{color:G,size:V}})}else R.current=fe.settings.color,U.current=fe.settings.size;return F.current=ke,C})},[r,o,d,v,p,g,m,S,_,E,w,Se,$,H,ae,I,pe,O]);const _e=L.useCallback((xe,fe)=>{X(ke=>{const de=new Map(ke),C=de.get(xe);return C&&de.set(xe,{...C,settings:fe}),de})},[]),ce=L.useCallback((xe,fe,ke)=>{X(de=>{const C=new Map(de),z=C.get(xe);if(z){const G=new Map(z.layerSettings);G.set(fe,ke),C.set(xe,{...z,layerSettings:G})}return C})},[]);return{toolRegistry:Y,setToolRegistry:X,updateToolSettings:_e,updateToolLayerSettings:ce,getCurrentToolDef:O}}function gw(i){const{currentTool:r,drawingMode:o,traceToolLayer:s,padToolLayer:c,testPointToolLayer:d,componentToolLayer:v}=i,[p,g]=L.useState(0),m=L.useCallback(()=>r==="draw"&&o==="via"?"via":r==="draw"&&o==="pad"?c==="bottom"?"padBottom":"padTop":r==="draw"&&o==="testPoint"?d==="bottom"?"testPointBottom":"testPointTop":r==="draw"&&o==="trace"?s==="bottom"?"traceBottom":"traceTop":r==="component"?v==="bottom"?"componentBottom":"componentTop":r==="power"?"power":r==="ground"?"ground":null,[r,o,c,d,s,v]),S=L.useCallback(()=>{const K=m();if(K){const D=Hn.get(K);return{currentTool:r,drawingMode:o,layer:r==="draw"&&o==="pad"?c||"top":r==="draw"&&o==="testPoint"?d||"top":r==="draw"&&o==="trace"?s||"top":r==="component"?v||"top":void 0,toolInstanceId:K,color:D.color,size:D.size}}return{currentTool:r,drawingMode:o,layer:void 0,toolInstanceId:null,color:"#000000",size:10}},[r,o,c,d,s,v,m]);L.useEffect(()=>{const K=m();return K?Hn.subscribe(K,()=>{g(ee=>ee+1)}):void 0},[m]);const _=S(),E=L.useCallback(K=>{const D=m();D&&Hn.setColor(D,K)},[m]),T=L.useCallback(K=>{const D=m();D&&Hn.setSize(D,K)},[m]);return{toolState:_,setColor:E,setSize:T,getCurrentToolInstanceId:m}}function xw(){const[i,r]=L.useState(!1),[o,s]=L.useState(!1),[c,d]=L.useState(!1),[v,p]=L.useState(!1),[g,m]=L.useState(!1),[S,_]=L.useState(!1),[E,T]=L.useState(!1),[K,D]=L.useState(!1),ee=L.useCallback(()=>{r(!0),s(!0),d(!0),p(!0),m(!0),_(!0),T(!0),D(!0)},[]),w=L.useCallback(()=>{r(!1),s(!1),d(!1),p(!1),m(!1),_(!1),T(!1),D(!1)},[]);return{areImagesLocked:i,setAreImagesLocked:r,areViasLocked:o,setAreViasLocked:s,arePadsLocked:c,setArePadsLocked:d,areTestPointsLocked:v,setAreTestPointsLocked:p,areTracesLocked:g,setAreTracesLocked:m,areComponentsLocked:S,setAreComponentsLocked:_,areGroundNodesLocked:E,setAreGroundNodesLocked:T,arePowerNodesLocked:K,setArePowerNodesLocked:D,lockAll:ee,unlockAll:w}}function yw(){const[i,r]=L.useState(null),[o,s]=L.useState({visible:!1,size:6}),[c,d]=L.useState({visible:!1,interval:5}),[v,p]=L.useState({visible:!1,source:null,interval:5}),[g,m]=L.useState({visible:!1,text:""}),[S,_]=L.useState({visible:!1,title:"",message:""}),[E,T]=L.useState({visible:!1}),[K,D]=L.useState({visible:!1}),[ee,w]=L.useState({visible:!1,projectName:"",locationPath:"",locationHandle:null}),[Se,$]=L.useState({visible:!1,filename:"",locationPath:"",locationHandle:null}),[H,ae]=L.useState(!1),[I,oe]=L.useState(!0),[pe,Y]=L.useState(!1);return{openMenu:i,setOpenMenu:r,setSizeDialog:o,setSetSizeDialog:s,autoSaveDialog:c,setAutoSaveDialog:d,autoSavePromptDialog:v,setAutoSavePromptDialog:p,debugDialog:g,setDebugDialog:m,errorDialog:S,setErrorDialog:_,newProjectDialog:E,setNewProjectDialog:T,openProjectDialog:K,setOpenProjectDialog:D,newProjectSetupDialog:ee,setNewProjectSetupDialog:w,saveAsDialog:Se,setSaveAsDialog:$,showColorPicker:H,setShowColorPicker:ae,showWelcomeDialog:I,setShowWelcomeDialog:oe,transformImagesDialogVisible:pe,setTransformImagesDialogVisible:Y}}function mw(){const[i,r]=L.useState(!1),[o,s]=L.useState(1),[c,d]=L.useState(null),[v,p]=L.useState(""),[g,m]=L.useState(""),[S,_]=L.useState(null),[E,T]=L.useState("pcb_project"),[K,D]=L.useState([]),[ee,w]=L.useState(-1),Se=L.useRef(null),$=L.useRef(!1),H=L.useRef(!1);return{autoSaveEnabled:i,setAutoSaveEnabled:r,autoSaveInterval:o,setAutoSaveInterval:s,autoSaveDirHandle:c,setAutoSaveDirHandle:d,autoSaveBaseName:v,setAutoSaveBaseName:p,currentProjectFilePath:g,setCurrentProjectFilePath:m,projectDirHandle:S,setProjectDirHandle:_,projectName:E,setProjectName:T,autoSaveFileHistory:K,setAutoSaveFileHistory:D,currentFileIndex:ee,setCurrentFileIndex:w,autoSaveIntervalRef:Se,hasChangesSinceLastAutoSaveRef:$,prevAutoSaveEnabledRef:H}}function bw(){const[i,r]=L.useState(null),o=L.useRef(!1),s=L.useCallback((p,g,m,S,_)=>{if(o.current)return;const E={drawingStrokes:JSON.parse(JSON.stringify(p)),componentsTop:JSON.parse(JSON.stringify(g)),componentsBottom:JSON.parse(JSON.stringify(m)),powerSymbols:JSON.parse(JSON.stringify(S)),groundSymbols:JSON.parse(JSON.stringify(_))};r(E)},[]),c=L.useCallback(()=>{if(!i)return null;o.current=!0;const p=i;return r(null),setTimeout(()=>{o.current=!1},100),p},[i]),d=i!==null,v=L.useCallback(()=>{r(null)},[]);return{saveSnapshot:s,undo:c,canUndo:d,clearSnapshot:v}}function vw(){const[r,o]=L.useState(()=>sf().isLoggedIn()),[s,c]=L.useState(()=>sf().getStoredUser()),d=L.useCallback(l=>{c(l),o(!0)},[]),v=L.useCallback(()=>{sf().logout(),c(null),o(!1)},[]),p=uw(),{topImage:g,setTopImage:m,bottomImage:S,setBottomImage:_,currentView:E,setCurrentView:T,transparency:K,setTransparency:D,isTransparencyCycling:ee,setIsTransparencyCycling:w,transparencyCycleSpeed:Se,setTransparencyCycleSpeed:$,isGrayscale:H,setIsGrayscale:ae}=p,[I,oe]=L.useState("none"),[pe,Y]=L.useState(()=>{const l=localStorage.getItem("bomExportFormat");return l==="json"||l==="pdf"?l:"pdf"});Pt.useEffect(()=>{localStorage.setItem("bomExportFormat",pe)},[pe]);const X=pw(),{brushColor:F,setBrushColor:R,brushSize:U,setBrushSize:O,topTraceColor:_e,setTopTraceColor:ce,bottomTraceColor:xe,setBottomTraceColor:fe,topTraceSize:ke,setTopTraceSize:de,bottomTraceSize:C,setBottomTraceSize:z,topPadColor:G,setTopPadColor:V,bottomPadColor:ie,setBottomPadColor:he,topPadSize:re,setTopPadSize:Le,bottomPadSize:Re,setBottomPadSize:Ue,topTestPointColor:et,setTopTestPointColor:ot,bottomTestPointColor:Ct,setBottomTestPointColor:Ot,topTestPointSize:se,setTopTestPointSize:kt,bottomTestPointSize:Jt,setBottomTestPointSize:Wt,topComponentColor:ht,setTopComponentColor:Xe,bottomComponentColor:Ut,setBottomComponentColor:an,topComponentSize:Ht,setTopComponentSize:Nn,bottomComponentSize:zn,setBottomComponentSize:Ee,componentConnectionColor:Ne,setComponentConnectionColor:Mt,componentConnectionSize:ct,setComponentConnectionSize:_t,saveDefaultSize:Ze,saveDefaultColor:jt}=X,en=sw(),{drawingStrokes:Qe,setDrawingStrokes:At,isDrawing:un,setIsDrawing:xn,currentStroke:Kt,setCurrentStroke:Qt,tracePreviewMousePos:hn,setTracePreviewMousePos:Xn,drawingMode:rt,setDrawingMode:ln,selectedDrawingLayer:Lt,setSelectedDrawingLayer:Zn,currentStrokeRef:In,lastTraceClickTimeRef:wr,isDoubleClickingTraceRef:Zi}=en,Yt=cw(),{selectedImageForTransform:jn,setSelectedImageForTransform:ci,isTransforming:Et,setIsTransforming:Bt,transformStartPos:Zt,setTransformStartPos:on,transformMode:Wn,setTransformMode:qi}=Yt,Sr=dw(),{viewScale:yt,setViewScale:si,viewRotation:On,setViewRotation:Ri,viewFlipX:Ei,setViewFlipX:bo,cameraWorldCenter:ya,setCameraWorldCenter:Rr,resetView:Ys,isShiftConstrained:Jo,setIsShiftConstrained:Qo,showBothLayers:ol,setShowBothLayers:es,setCameraCenter:jr,getViewPan:Gs}=Sr,[Jn,ma]=L.useState("top"),[di,As]=L.useState("top"),[Di,zs]=L.useState("top"),[ir,Na]=L.useState("top"),vo=Pt.useRef("top"),Ha=Pt.useRef("top"),Ti=Pt.useRef("top"),Oo=Pt.useRef("top");Pt.useEffect(()=>{vo.current=Jn},[Jn]),Pt.useEffect(()=>{Ha.current=di},[di]),Pt.useEffect(()=>{Ti.current=Di},[Di]),Pt.useEffect(()=>{Oo.current=ir},[ir]);const hs=gw({currentTool:I,drawingMode:rt,traceToolLayer:Jn,padToolLayer:di,testPointToolLayer:Di,componentToolLayer:ir}),{toolState:Tr}=hs,oo=hw(yv,I,rt,F,U,_e,xe,ke,C,G,ie,re,Re,et,Ct,se,Jt,ht,Ut,Ht,zn,Jn,di,Di,ir),{toolRegistry:vn,setToolRegistry:wi,getCurrentToolDef:ui,updateToolSettings:Dr,updateToolLayerSettings:Xs}=oo,sl=Pt.useRef(null),dr=Pt.useRef(F),Aa=Pt.useRef(U);Pt.useEffect(()=>{wi(l=>{const y=ui(l),N=y?.id||null,B=sl.current,le=new Map(l);if(B&&B!==N){const ge=l.get(B);ge&&le.set(B,{...ge,settings:{color:dr.current,size:Aa.current}})}if(y&&N!==B)if(I==="draw"&&rt==="trace"){const ge=Jn||"top",A=ge==="top"?_e:xe,je=ge==="top"?ke:C;R(A),O(je),dr.current=A,Aa.current=je;const ne=new Map(y.layerSettings);ne.set("top",{color:_e,size:ke}),ne.set("bottom",{color:xe,size:C}),le.set("trace",{...y,settings:{color:A,size:je},layerSettings:ne})}else if(I==="draw"&&rt==="pad"){const ge=di||"top",A=ge==="top"?G:ie,je=ge==="top"?re:Re;R(A),O(je),dr.current=A,Aa.current=je;const ne=new Map(y.layerSettings);ne.set("top",{color:G,size:re}),ne.set("bottom",{color:ie,size:Re}),le.set("pad",{...y,settings:{color:A,size:je},layerSettings:ne})}else if(I==="draw"&&rt==="testPoint"){const ge=Di||"top",A=ge==="top"?et:Ct,je=ge==="top"?se:Jt;R(A),O(je),dr.current=A,Aa.current=je;const ne=new Map(y.layerSettings);ne.set("top",{color:et,size:se}),ne.set("bottom",{color:Ct,size:Jt}),le.set("testPoint",{...y,settings:{color:A,size:je},layerSettings:ne})}else if(I==="component"){const ge=ir||"top",A=ge==="top"?ht:Ut,je=ge==="top"?Ht:zn;R(A),O(je),dr.current=A,Aa.current=je;const ne=new Map(y.layerSettings);ne.set("top",{color:ht,size:Ht}),ne.set("bottom",{color:Ut,size:zn}),le.set("component",{...y,settings:{color:A,size:je},layerSettings:ne})}else{const ge=y.settings;R(ge.color),O(ge.size),dr.current=ge.color,Aa.current=ge.size}return sl.current=N,le})},[I,rt,ui,_e,xe,ke,C,G,ie,re,Re,et,Ct,se,Jt,Di,ht,Ut,Ht,zn]),Pt.useEffect(()=>{const l=vn.get("trace");if(l){const le=l.layerSettings.get("top"),ge=l.layerSettings.get("bottom");le&&(ce(le.color),de(le.size)),ge&&(fe(ge.color),z(ge.size))}const y=vn.get("pad");if(y){const le=y.layerSettings.get("top"),ge=y.layerSettings.get("bottom");le&&(V(le.color),Le(le.size)),ge&&(he(ge.color),Ue(ge.size))}const N=vn.get("testPoint");if(N){const le=N.layerSettings.get("top"),ge=N.layerSettings.get("bottom");le&&(ot(le.color),kt(le.size)),ge&&(Ot(ge.color),Wt(ge.size))}const B=vn.get("component");if(B){const le=B.layerSettings.get("top"),ge=B.layerSettings.get("bottom");le&&(Xe(le.color),Nn(le.size)),ge&&(an(ge.color),Ee(ge.size))}},[]),Pt.useEffect(()=>{wi(l=>{const y=new Map(l),N=l.get("trace");if(N){const je=new Map(N.layerSettings);je.set("top",{color:_e,size:ke}),je.set("bottom",{color:xe,size:C}),y.set("trace",{...N,layerSettings:je})}const B=l.get("pad");if(B){const je=new Map(B.layerSettings);je.set("top",{color:G,size:re}),je.set("bottom",{color:ie,size:Re}),y.set("pad",{...B,layerSettings:je})}const le=l.get("testPoint");if(le){const je=new Map(le.layerSettings);je.set("top",{color:et,size:se}),je.set("bottom",{color:Ct,size:Jt}),y.set("testPoint",{...le,layerSettings:je})}const ge=l.get("component");if(ge){const je=new Map(ge.layerSettings);je.set("top",{color:ht,size:Ht}),je.set("bottom",{color:Ut,size:zn}),y.set("component",{...ge,layerSettings:je})}const A=l.get("componentConnection");return A&&y.set("componentConnection",{...A,settings:{color:Ne,size:ct}}),y})},[_e,xe,ke,C,G,ie,re,Re,et,Ct,se,Jt,ht,Ut,Ht,zn,Ne,ct,wi]),Pt.useEffect(()=>{wi(l=>{const y=ui(l);if(y)if(I==="draw"&&rt==="trace"){const N=Jn||"top",B=N==="top"?"traceTop":"traceBottom",le=Hn.get(B),ge=le.color,A=le.size;N==="top"?(ce(ge),de(A),jt("trace",ge,"top"),Ze("trace",A,"top")):(fe(ge),z(A),jt("trace",ge,"bottom"),Ze("trace",A,"bottom"));const je=new Map(l),ne=new Map(y.layerSettings);return ne.set(N,{color:ge,size:A}),je.set(y.id,{...y,layerSettings:ne,settings:{color:ge,size:A}}),dr.current=ge,Aa.current=A,je}else if(I==="draw"&&rt==="pad"){const N=di||"top",B=N==="top"?"padTop":"padBottom",le=Hn.get(B),ge=le.color,A=le.size;N==="top"?(V(ge),Le(A),jt("pad",ge,"top"),Ze("pad",A,"top")):(he(ge),Ue(A),jt("pad",ge,"bottom"),Ze("pad",A,"bottom"));const je=new Map(l),ne=new Map(y.layerSettings);return ne.set(N,{color:ge,size:A}),je.set(y.id,{...y,layerSettings:ne,settings:{color:ge,size:A}}),dr.current=ge,Aa.current=A,je}else if(I==="draw"&&rt==="testPoint"){const N=Di||"top",B=N==="top"?"testPointTop":"testPointBottom",le=Hn.get(B),ge=le.color,A=le.size;N==="top"?(ot(ge),kt(A),jt("testPoint",ge,"top"),Ze("testPoint",A,"top")):(Ot(ge),Wt(A),jt("testPoint",ge,"bottom"),Ze("testPoint",A,"bottom"));const je=new Map(l),ne=new Map(y.layerSettings);return ne.set(N,{color:ge,size:A}),je.set(y.id,{...y,layerSettings:ne,settings:{color:ge,size:A}}),dr.current=ge,Aa.current=A,je}else if(I==="component"){const N=ir||"top",B=N==="top"?"componentTop":"componentBottom",le=Hn.get(B),ge=le.color,A=le.size;N==="top"?(Xe(ge),Nn(A),jt("component",ge,"top"),Ze("component",A,"top")):(an(ge),Ee(A),jt("component",ge,"bottom"),Ze("component",A,"bottom"));const je=new Map(l),ne=new Map(y.layerSettings);return ne.set(N,{color:ge,size:A}),je.set(y.id,{...y,layerSettings:ne,settings:{color:ge,size:A}}),dr.current=ge,Aa.current=A,je}else{const N=new Map(l);return N.set(y.id,{...y,settings:{color:F,size:U}}),dr.current=F,Aa.current=U,N}return l})},[F,U,I,rt,Jn,di,Di,ir,ui,jt,Ze,Kd,ce,fe,de,z,V,he,Le,Ue,ot,Ot,kt,Wt,Xe,an,Nn,Ee]),Pt.useEffect(()=>{if(I==="draw"&&rt==="trace"){const l=Jn;Zn(l),R(l==="top"?_e:xe),O(l==="top"?ke:C),l==="top"?(Zr(!0),Go(!0)):(ha(!0),qs(!0)),Jc(!0)}else Jc(!1)},[I,rt,Jn,_e,xe,ke,C]),Pt.useEffect(()=>{if(I==="draw"&&rt==="pad"){const l=di;Zn(l);const y=Hn.get(l==="top"?"padTop":"padBottom");R(y.color),O(y.size),l==="top"?(Zr(!0),Vs(!0)):(ha(!0),co(!0)),Su(!0)}else Su(!1)},[I,rt,di]),Pt.useEffect(()=>{if(I==="draw"&&rt==="testPoint"){const l=Di;Zn(l),R(l==="top"?et:Ct),O(l==="top"?se:Jt),l==="top"?(Zr(!0),ls(!0)):(ha(!0),f(!0)),Yu(!0)}else Yu(!1)},[I,rt,Di,et,Ct,se,Jt]);const[Ps,wo]=L.useState(!1);Pt.useEffect(()=>{if(I==="component"){const l=ir;Zn(l),R(l==="top"?ht:Ut),O(l==="top"?Ht:zn),l==="top"?(Zr(!0),k(!0)):(ha(!0),q(!0)),Ps||Sd(!0)}else Sd(!1),wo(!1)},[I,ir,ht,Ut,Ht,zn,Ps]),Pt.useEffect(()=>{if(I==="component"){const l=ir;Zn(l),R(l==="top"?ht:Ut),O(l==="top"?Ht:zn)}},[ir,I,ht,Ut,Ht,zn]),Pt.useEffect(()=>{Tr.toolInstanceId&&(R(Tr.color),O(Tr.size))},[Tr.toolInstanceId,Tr.color,Tr.size,R,O,I,rt]);const[Ks,So]=L.useState(void 0),[,Ft]=L.useState([]),[,br]=L.useState([]),[,za]=L.useState([]),[,Fo]=L.useState([]),[rr,ba]=L.useState([]),[jo,To]=L.useState([]),[ll,qn]=L.useState([]),[Ec,$l]=L.useState([]),Lr=L.useRef(null),zi=Pt.useMemo(()=>{const l=Lr.current;if(!l)return{x:0,y:0};const y=(l.width-10)/2,N=(l.height-10)/2;return Gs(y,N)},[Lr.current?.width,Lr.current?.height,ya,yt,Gs]),na=Pt.useCallback(l=>{const y=Lr.current;if(!y)return;const N=(y.width-10)/2,B=(y.height-10)/2,le=Gs(N,B),ge=typeof l=="function"?l(le):l,A=(N-ge.x)/yt,je=(B-ge.y)/yt;Rr({x:A,y:je})},[Gs,yt,Rr]),Oc=lw(),{selectedIds:ii,setSelectedIds:mn,isSelecting:Zs,setIsSelecting:ts,selectedComponentIds:$n,setSelectedComponentIds:bn,selectedPowerIds:mi,setSelectedPowerIds:_n,selectedGroundIds:Yn,setSelectedGroundIds:Tn}=Oc,gs=T2(),{componentsTop:tn,setComponentsTop:Li,componentsBottom:cn,setComponentsBottom:Si,componentEditor:Wa,setComponentEditor:cl,connectingPin:Pa,setConnectingPin:Uo,componentDialogPosition:$a,setComponentDialogPosition:ul,isDraggingDialog:_s,setIsDraggingDialog:Fc,dialogDragOffset:j,setDialogDragOffset:W,openComponentEditor:ze}=gs,Oe=fw(),{powerBuses:Ie,setPowerBuses:bt,groundBuses:gt,setGroundBuses:dn,powerSymbols:Gt,setPowerSymbols:fn,groundSymbols:wn,setGroundSymbols:Fn,powerEditor:Mi,setPowerEditor:fr}=Oe,vr=bw(),{saveSnapshot:Ji,undo:ia,clearSnapshot:Gr}=vr;Pt.useEffect(()=>{I==="power"?(yn(!1),Ie.length>1?sn&&Ie.some(y=>y.id===sn)?vt(!1):(vt(!0),sn!==null&&nn(null)):Ie.length===1?(nn(Ie[0].id),vt(!1)):(vt(!0),nn(null))):vt(!1)},[I,Ie]),Pt.useEffect(()=>{I==="ground"?(vt(!1),gt.length>1?Un&&gt.some(y=>y.id===Un)?yn(!1):(yn(!0),Un!==null&&Bi(null)):gt.length===1?(Bi(gt[0].id),yn(!1)):(yn(!0),Bi(null))):yn(!1)},[I,gt]),Pt.useEffect(()=>{I!=="power"&&I!=="ground"&&(vt(!1),yn(!1))},[I]);const dl=xw(),{areImagesLocked:Cr,setAreImagesLocked:qo,areViasLocked:da,setAreViasLocked:Rs,arePadsLocked:Xr,setArePadsLocked:Co,areTestPointsLocked:ko,setAreTestPointsLocked:Ds,areTracesLocked:Vi,setAreTracesLocked:ns,areComponentsLocked:Kr,setAreComponentsLocked:Ls,areGroundNodesLocked:Vr,setAreGroundNodesLocked:fa,arePowerNodesLocked:Qi,setArePowerNodesLocked:Ms}=dl,Uc=yw(),{openMenu:is,setOpenMenu:No,setSizeDialog:xs,setSetSizeDialog:Al,autoSaveDialog:rs,setAutoSaveDialog:Ao,autoSavePromptDialog:Ya,setAutoSavePromptDialog:kr,debugDialog:zo,setDebugDialog:so,errorDialog:Is,setErrorDialog:Bs,newProjectDialog:zl,setNewProjectDialog:pr,openProjectDialog:bc,setOpenProjectDialog:Po,newProjectSetupDialog:Ci,setNewProjectSetupDialog:Hr,saveAsDialog:Yi,setSaveAsDialog:Es,showColorPicker:Pl,setShowColorPicker:Vo,transformImagesDialogVisible:fl,setTransformImagesDialogVisible:ys}=Uc,Yl=mw(),[as,Ga]=L.useState(!1),[_a,_o]=L.useState(!1),[ki,ri]=L.useState(!1),[lr,Mr]=L.useState(null),[Js,ms]=L.useState(null),[Gl,vc]=L.useState(null),[Hu,yd]=L.useState(null),[md,bd]=L.useState(null),{autoSaveEnabled:Xa,setAutoSaveEnabled:Ho,autoSaveInterval:Wo,setAutoSaveInterval:ra,autoSaveDirHandle:os,setAutoSaveDirHandle:pa,autoSaveBaseName:$o,setAutoSaveBaseName:Ro,currentProjectFilePath:_l,setCurrentProjectFilePath:aa,projectDirHandle:Pi,setProjectDirHandle:va,projectName:oa,setProjectName:hr,autoSaveFileHistory:Ka,setAutoSaveFileHistory:Qs,currentFileIndex:Za,setCurrentFileIndex:Xl,autoSaveIntervalRef:bi,hasChangesSinceLastAutoSaveRef:Ra,prevAutoSaveEnabledRef:Rl}=Yl,pl=L.useRef(null),wc=L.useRef(null),Sc=L.useRef(null),hl=L.useRef(null),jc=L.useRef(null),lo=L.useRef(null),Kl=L.useRef(null),[ss,Dl]=L.useState(!1),Os=L.useRef(null),Ja=L.useRef(null),[Do,Fs]=L.useState(!1),[Da,La]=L.useState({}),[Yo,Us]=L.useState(!1),hu=L.useCallback(()=>{const l=Lr.current;if(!l)return null;const y=l.width-10,N=l.height-10;let B=1/0,le=1/0,ge=-1/0,A=-1/0,je=!1;if(g){const Me=g,De=(Me.width||0)/2,He=(Me.height||0)/2;B=Math.min(B,Me.x-De),le=Math.min(le,Me.y-He),ge=Math.max(ge,Me.x+De),A=Math.max(A,Me.y+He),je=!0}if(S){const Me=S,De=(Me.width||0)/2,He=(Me.height||0)/2;B=Math.min(B,Me.x-De),le=Math.min(le,Me.y-He),ge=Math.max(ge,Me.x+De),A=Math.max(A,Me.y+He),je=!0}if(!je)return{pcbReferenceX:0,pcbReferenceY:0,x:0,y:0,zoom:1,viewRotation:0,viewFlipX:!1,isBottomView:!1,transparency:0,showTopImage:!0,showBottomImage:!0,showViasLayer:!0,showTopTracesLayer:!0,showBottomTracesLayer:!0,showTopPadsLayer:!0,showBottomPadsLayer:!0,showTopTestPointsLayer:!0,showBottomTestPointsLayer:!0,showTopComponents:!0,showBottomComponents:!0,showPowerLayer:!0,showGroundLayer:!0,showConnectionsLayer:!0};const ne=ge-B,Te=A-le,ve=.1,Ce=ne*(1+2*ve),ye=Te*(1+2*ve),we=Ce>0?y/Ce:1,be=ye>0?N/ye:1;return{pcbReferenceX:0,pcbReferenceY:0,x:0,y:0,zoom:Math.min(we,be,1),viewRotation:0,viewFlipX:!1,isBottomView:!1,transparency:0,showTopImage:!0,showBottomImage:!0,showViasLayer:!0,showTopTracesLayer:!0,showBottomTracesLayer:!0,showTopPadsLayer:!0,showBottomPadsLayer:!0,showTopTestPointsLayer:!0,showBottomTestPointsLayer:!0,showTopComponents:!0,showBottomComponents:!0,showPowerLayer:!0,showGroundLayer:!0,showConnectionsLayer:!0}},[g,S]);Pt.useEffect(()=>{const l=hu();l&&La(y=>y[0]?y:{...y,0:l})},[g,S,hu]);const Ma=L.useRef(null),[qc,Ia]=L.useState(!1),[er,fi]=L.useState(null),[Ba,gr]=L.useState(null),[wa,Ll]=L.useState({width:960,height:600}),gu=L.useRef(null),el=L.useRef(null),Qa=L.useRef(null),Zl=L.useRef(null),Vc=L.useRef(null),Jl=L.useRef(null),Hc=L.useRef(null),gl=L.useRef(null),[eo,Zr]=L.useState(!0),[Sa,ha]=L.useState(!0),[Ql,xl]=L.useState(!1),[sa,Ea]=L.useState(!0),[Gi,Go]=L.useState(!0),[to,qs]=L.useState(!0),[Lo,Vs]=L.useState(!0),[Ii,co]=L.useState(!0),[uo,ls]=L.useState(!0),[Mo,f]=L.useState(!0),[x,k]=L.useState(!0),[P,q]=L.useState(!0),[Z,Q]=L.useState(!0),J=Gt,te=wn,[Pe,Fe]=L.useState(!1),[tt,Ae]=L.useState(null),[Ve,Ke]=L.useState(!1),[ft,Je]=L.useState(void 0),[mt,wt]=L.useState(!1),[Dt,vt]=L.useState(!1),[sn,nn]=L.useState(null),[ti,Xt]=L.useState(new Set),Cn=L.useCallback(()=>{mn(new Set),bn(new Set),_n(new Set),Tn(new Set),Xt(new Set)},[mn,bn,_n,Tn,Xt]),[Nr,ni]=L.useState(!1),[gn,$t]=L.useState(null),[Ar,yn]=L.useState(!1),[Un,Bi]=L.useState(null),[Ir,la]=L.useState(!0),[Hi,zr]=L.useState(!1),[fo,Jr]=L.useState(!1),Qn=L.useRef({}),[ai,_i]=L.useState(!0),[pi,xr]=L.useState(!0),[yr,Oi]=L.useState(!0),[Xi,Wi]=L.useState(null),[Qr,ca]=L.useState(!1),[ar,Fi]=L.useState(null),[Oa,sr]=L.useState(!1),[Pn,Mn]=L.useState(null),[Ui,Io]=L.useState(!1),[Bo,po]=L.useState(null),[Br,bs]=L.useState([]),[tl,ec]=L.useState(!1),[tr,tc]=L.useState(null),[Wc,Tc]=L.useState(!1),[vs,Wu]=L.useState(null),[$c,xu]=L.useState(!1),[yl,ea]=L.useState(null),[Er,nc]=L.useState(!1),[Hs,Ml]=L.useState(null),[ic,ho]=L.useState(!1),[Cc,nl]=L.useState(!1),[Yc,Gc]=L.useState(null),[ws,yu]=L.useState(!1),[Il,mu]=L.useState(null),[bu,ml]=L.useState(!1),Xc=L.useRef(null),Kc=L.useRef(!1),rc=L.useRef(null),kc=L.useRef(!1),Nc=L.useRef(!1);Pt.useEffect(()=>{Xc.current=Yc},[Yc]),Pt.useEffect(()=>{Kc.current=ws},[ws]),Pt.useEffect(()=>{rc.current=Il},[Il]),Pt.useEffect(()=>{kc.current=bu},[bu]),Pt.useEffect(()=>{Nc.current=Cc},[Cc]);const[ac,Ac]=L.useState(null),[Zc,cs]=L.useState(!1);Pt.useEffect(()=>{Ie.length===0&&bt([{id:"default-3v3",name:"+3.3V",voltage:"+3.3VDC",color:"#ff6600"},{id:"default-5v",name:"+5V",voltage:"+5VDC",color:"#ff0000"}])},[Ie.length,bt]);const Fa=L.useCallback((l,y)=>{const N=J.find(le=>le.pointId===l);if(N){const le=y.find(A=>A.id===N.powerBusId);return`Via (${le?le.voltage:N.type||"Power Node"})`}const B=te.find(le=>le.pointId===l);return B?`Via (${B.type||"Ground"})`:"Via"},[J,te]),Ua=L.useCallback((l,y)=>{const N=J.find(le=>le.pointId===l);if(N){const le=y.find(A=>A.id===N.powerBusId);return`Pad (${le?le.voltage:N.type||"Power Node"})`}const B=te.find(le=>le.pointId===l);return B?`Pad (${B.type||"Ground"})`:"Pad"},[J,te]),us=L.useCallback((l,y)=>{const N=J.find(le=>le.pointId===l);if(N){const le=y.find(A=>A.id===N.powerBusId);return`Test Point (${le?le.voltage:N.type||"Power Node"})`}const B=te.find(le=>le.pointId===l);return B?`Test Point (${B.type||"Ground"})`:"Test Point"},[J,te]),vu=L.useCallback(()=>{const l=Qe.filter(y=>y.type==="via").map(y=>y.id);mn(new Set(l)),bn(new Set),_n(new Set),Tn(new Set),Xt(new Set)},[Qe,mn,bn,_n,Tn]),oc=L.useCallback(()=>{const l=Qe.filter(y=>y.type==="trace").map(y=>y.id);mn(new Set(l)),bn(new Set),_n(new Set),Tn(new Set),Xt(new Set)},[Qe,mn,bn,_n,Tn]),vd=L.useCallback(()=>{const l=Qe.filter(y=>y.type==="pad").map(y=>y.id);mn(new Set(l)),bn(new Set),_n(new Set),Tn(new Set),Xt(new Set)},[Qe,mn,bn,_n,Tn]),zc=L.useCallback(()=>{const l=[...tn,...cn].map(y=>y.id);bn(new Set(l)),mn(new Set),_n(new Set),Tn(new Set),Xt(new Set)},[tn,cn,bn,mn,_n,Tn]),Pc=L.useCallback(()=>{const l=[...tn,...cn].filter(y=>{const N=y.pinConnections||[];return!(N.length>0&&N.length===y.pinCount&&N.every(le=>le&&le.trim()!==""))}).map(y=>y.id);bn(new Set(l)),mn(new Set),_n(new Set),Tn(new Set),Xt(new Set),so({visible:!0,text:""})},[tn,cn,bn,mn,_n,Tn,so]),Zf=L.useCallback(()=>{const l=new Set;let y=0;for(const N of[...tn,...cn]){const B=N.pinConnections||[];for(const le of B)if(le&&le.trim()!==""){const ge=parseInt(le.trim(),10);if(!isNaN(ge)&&ge>0){const A=`${N.id}:${ge}`;l.add(A),y++}}}if(console.log(`Component connections: ${y} connection lines found`),l.size===0){console.log("No component connections found - components may not have pins connected"),alert("No component connections found. Please connect component pins to vias or pads first.");return}Xt(l),mn(new Set),bn(new Set),_n(new Set),Tn(new Set),console.log(`Selected ${l.size} component connection lines`)},[tn,cn,mn,bn,_n,Tn]),wd=L.useCallback(()=>{ki?(bo(!1),ri(!1),D(0)):(bo(!0),ri(!0),D(100))},[ki,bo,ri,D]),Jf=L.useCallback(l=>{Ri(y=>_g(y,l))},[Ri]),bl=L.useCallback((l,y)=>{const N=Lr.current;if(!N)return;const B=N.width-10,le=N.height-10,ge=B/2,A=le/2,je=ge-l*yt,ne=A-y*yt;na({x:je,y:ne})},[yt,na]),cf=L.useCallback((l,y,N)=>{bl(y,N),bn(new Set([l])),mn(new Set),_n(new Set),Tn(new Set),Xt(new Set)},[bl,bn,mn,_n,Tn]),Qf=L.useCallback((l,y,N)=>{bl(y,N),mn(new Set([l])),bn(new Set),_n(new Set),Tn(new Set),Xt(new Set)},[bl,mn,bn,_n,Tn]),ep=L.useCallback((l,y,N)=>{bl(y,N),_n(new Set([l])),mn(new Set),bn(new Set),Tn(new Set),Xt(new Set)},[bl,_n,mn,bn,Tn]),tp=L.useCallback((l,y,N)=>{bl(y,N),Tn(new Set([l])),mn(new Set),bn(new Set),_n(new Set),Xt(new Set)},[bl,Tn,mn,bn,_n]),uf=L.useCallback((l,y,N)=>{bl(y,N),mn(new Set([l])),bn(new Set),_n(new Set),Tn(new Set),Xt(new Set)},[bl,mn,bn,_n,Tn]),np=Pt.useMemo(()=>{const l=new Set(J.map(N=>N.powerBusId).filter(N=>typeof N=="string"&&N.length>0)),y=Ie.filter(N=>l.has(N.id)).map(N=>N.name);return Array.from(new Set(y)).sort()},[J,Ie]),ip=Pt.useMemo(()=>{const l=new Set(te.map(N=>N.groundBusId).filter(N=>typeof N=="string"&&N.length>0)),y=gt.filter(N=>l.has(N.id)).map(N=>N.name);return Array.from(new Set(y)).sort()},[te,gt]),df=L.useCallback(()=>{const l=J.map(y=>y.id);_n(new Set(l)),mn(new Set),bn(new Set),Tn(new Set),Xt(new Set)},[J,_n,mn,bn,Tn]),rp=L.useCallback(()=>{const l=te.map(y=>y.id);Tn(new Set(l)),mn(new Set),bn(new Set),_n(new Set),Xt(new Set)},[te,Tn,mn,bn,_n]),ap=L.useCallback(l=>{const y=Ie.filter(B=>B.name===l).map(B=>B.id);if(y.length===0)return;const N=J.filter(B=>B.powerBusId&&y.includes(B.powerBusId)).map(B=>B.id);_n(new Set(N)),mn(new Set),bn(new Set),Tn(new Set)},[Ie,J,_n,mn,bn,Tn]),xh=L.useCallback(l=>{const y=gt.filter(B=>B.name===l).map(B=>B.id);if(y.length===0)return;const N=te.filter(B=>B.groundBusId&&y.includes(B.groundBusId)).map(B=>B.id);Tn(new Set(N)),mn(new Set),bn(new Set),_n(new Set)},[gt,te,Tn,mn,bn,_n]);L.useCallback(l=>{switch(l.componentType){case"Resistor":case"ResistorNetwork":case"Thermistor":case"VariableResistor":if("resistance"in l&&l.resistance&&"resistanceUnit"in l&&l.resistanceUnit)return`${l.resistance} ${l.resistanceUnit}`;break;case"Capacitor":case"Electrolytic Capacitor":case"Film Capacitor":if("capacitance"in l&&l.capacitance&&"capacitanceUnit"in l&&l.capacitanceUnit)return`${l.capacitance} ${l.capacitanceUnit}`;break;case"Inductor":if("inductance"in l&&l.inductance&&"inductanceUnit"in l&&l.inductanceUnit)return`${l.inductance} ${l.inductanceUnit}`;break;case"Battery":if("voltage"in l&&l.voltage&&"voltageUnit"in l&&l.voltageUnit)return`${l.voltage} ${l.voltageUnit}`;break;case"Diode":if("voltage"in l&&l.voltage&&"voltageUnit"in l&&l.voltageUnit)return`${l.voltage} ${l.voltageUnit}`;break;case"Fuse":if("current"in l&&l.current&&"currentUnit"in l&&l.currentUnit)return`${l.current} ${l.currentUnit}`;break;case"FerriteBead":if("impedance"in l&&l.impedance&&"impedanceUnit"in l&&l.impedanceUnit)return`${l.impedance} ${l.impedanceUnit}`;break;case"Relay":if("coilVoltage"in l&&l.coilVoltage&&"coilVoltageUnit"in l&&l.coilVoltageUnit)return`${l.coilVoltage} ${l.coilVoltageUnit}`;break;case"Speaker":if("impedance"in l&&l.impedance&&"impedanceUnit"in l&&l.impedanceUnit)return`${l.impedance} ${l.impedanceUnit}`;break;case"Motor":if("voltage"in l&&l.voltage&&"voltageUnit"in l&&l.voltageUnit)return`${l.voltage} ${l.voltageUnit}`;break;case"PowerSupply":if("outputVoltage"in l&&l.outputVoltage&&"outputVoltageUnit"in l&&l.outputVoltageUnit)return`${l.outputVoltage} ${l.outputVoltageUnit}`;break;case"Transistor":if("partNumber"in l&&l.partNumber)return l.partNumber;break;case"IntegratedCircuit":if("partNumber"in l&&l.partNumber)return l.partNumber;break}return null},[]);const ff=L.useCallback(l=>{const y=[];switch(l.componentType){case"Capacitor":case"Electrolytic Capacitor":case"Film Capacitor":"capacitance"in l&&l.capacitance&&"capacitanceUnit"in l&&l.capacitanceUnit&&y.push(`Capacitance: ${l.capacitance} ${l.capacitanceUnit}`),"voltage"in l&&l.voltage&&"voltageUnit"in l&&l.voltageUnit&&y.push(`Voltage: ${l.voltage} ${l.voltageUnit}`),"dielectric"in l&&l.dielectric&&y.push(`Dielectric: ${l.dielectric}`);break;case"Resistor":case"ResistorNetwork":case"Thermistor":"resistance"in l&&l.resistance&&"resistanceUnit"in l&&l.resistanceUnit&&y.push(`Resistance: ${l.resistance} ${l.resistanceUnit}`),"power"in l&&l.power&&y.push(`Power: ${l.power}`),"tolerance"in l&&l.tolerance&&y.push(`Tolerance: ${l.tolerance}`);break;case"VariableResistor":"resistance"in l&&l.resistance&&"resistanceUnit"in l&&l.resistanceUnit&&y.push(`Resistance: ${l.resistance} ${l.resistanceUnit}`),"vrType"in l&&l.vrType&&y.push(`Type: ${l.vrType}`),"power"in l&&l.power&&y.push(`Power: ${l.power}`),"taper"in l&&l.taper&&y.push(`Taper: ${l.taper}`);break;case"Inductor":"inductance"in l&&l.inductance&&"inductanceUnit"in l&&l.inductanceUnit&&y.push(`Inductance: ${l.inductance} ${l.inductanceUnit}`),"current"in l&&l.current&&"currentUnit"in l&&l.currentUnit&&y.push(`Current: ${l.current} ${l.currentUnit}`),"tolerance"in l&&l.tolerance&&y.push(`Tolerance: ${l.tolerance}`);break;case"Battery":"voltage"in l&&l.voltage&&"voltageUnit"in l&&l.voltageUnit&&y.push(`Voltage: ${l.voltage} ${l.voltageUnit}`),"capacity"in l&&l.capacity&&"capacityUnit"in l&&l.capacityUnit&&y.push(`Capacity: ${l.capacity} ${l.capacityUnit}`);break;case"Diode":"voltage"in l&&l.voltage&&"voltageUnit"in l&&l.voltageUnit&&y.push(`Voltage: ${l.voltage} ${l.voltageUnit}`),"current"in l&&l.current&&"currentUnit"in l&&l.currentUnit&&y.push(`Current: ${l.current} ${l.currentUnit}`);break;case"Fuse":"current"in l&&l.current&&"currentUnit"in l&&l.currentUnit&&y.push(`Current: ${l.current} ${l.currentUnit}`),"voltage"in l&&l.voltage&&"voltageUnit"in l&&l.voltageUnit&&y.push(`Voltage: ${l.voltage} ${l.voltageUnit}`);break;case"FerriteBead":"impedance"in l&&l.impedance&&"impedanceUnit"in l&&l.impedanceUnit&&y.push(`Impedance: ${l.impedance} ${l.impedanceUnit}`),"current"in l&&l.current&&"currentUnit"in l&&l.currentUnit&&y.push(`Current: ${l.current} ${l.currentUnit}`);break;case"Relay":"coilVoltage"in l&&l.coilVoltage&&"coilVoltageUnit"in l&&l.coilVoltageUnit&&y.push(`Coil Voltage: ${l.coilVoltage} ${l.coilVoltageUnit}`),"contactRating"in l&&l.contactRating&&y.push(`Contact Rating: ${l.contactRating}`);break;case"Speaker":"impedance"in l&&l.impedance&&"impedanceUnit"in l&&l.impedanceUnit&&y.push(`Impedance: ${l.impedance} ${l.impedanceUnit}`),"power"in l&&l.power&&y.push(`Power: ${l.power}`);break;case"Motor":"voltage"in l&&l.voltage&&"voltageUnit"in l&&l.voltageUnit&&y.push(`Voltage: ${l.voltage} ${l.voltageUnit}`),"speed"in l&&l.speed&&"speedUnit"in l&&l.speedUnit&&y.push(`Speed: ${l.speed} ${l.speedUnit}`);break;case"PowerSupply":"outputVoltage"in l&&l.outputVoltage&&"outputVoltageUnit"in l&&l.outputVoltageUnit&&y.push(`Output Voltage: ${l.outputVoltage} ${l.outputVoltageUnit}`),"outputCurrent"in l&&l.outputCurrent&&"outputCurrentUnit"in l&&l.outputCurrentUnit&&y.push(`Output Current: ${l.outputCurrent} ${l.outputCurrentUnit}`);break;case"Transistor":"partNumber"in l&&l.partNumber&&y.push(`Part Number: ${l.partNumber}`),"transistorType"in l&&l.transistorType&&y.push(`Type: ${l.transistorType}`);break;case"Crystal":"frequency"in l&&l.frequency&&y.push(`Frequency: ${l.frequency}`),"loadCapacitance"in l&&l.loadCapacitance&&y.push(`Load Capacitance: ${l.loadCapacitance}`),"tolerance"in l&&l.tolerance&&y.push(`Tolerance: ${l.tolerance}`);break;case"VacuumTube":"tubeType"in l&&l.tubeType&&y.push(`Tube Type: ${l.tubeType}`),"partNumber"in l&&l.partNumber&&y.push(`Part Number: ${l.partNumber}`);break}return y},[]),[wu,Jc]=L.useState(!1),_c=L.useRef(null),[$u,Su]=L.useState(!1),[pf,Yu]=L.useState(!1),ju=L.useRef(null),sc=L.useRef(null),Tu=L.useRef(null),Qc=L.useRef(null),[op,Sd]=L.useState(!1),[Ss,jd]=L.useState(null),[hf,sp]=L.useState(null),[Bl,gf]=L.useState(null),Td=Pt.useRef(null),xf=Pt.useRef(null),lc=Pt.useRef(null),Gu=L.useRef(null),Xu=L.useRef(null),Ku=L.useRef(null),Cd=L.useRef(null),kd=L.useRef(null),Zu=L.useRef(null),[lp,cp]=L.useState(null),[Ws,yf]=L.useState(null),[mr,go]=L.useState(!1),[eu,mf]=L.useState(null),[cc,Nd]=L.useState(null);Pt.useEffect(()=>{xf.current=Bl},[Bl]),Pt.useEffect(()=>{lc.current=Ss},[Ss]);const Cu=L.useCallback(async(l,y)=>{if(!y)throw new Error("No project directory available. Please create or open a project before loading images. The project directory is needed to store image files.");try{let N;try{N=await y.getDirectoryHandle("images",{create:!0})}catch(ge){throw new Error(`Failed to create images directory in project folder. This may be due to insufficient permissions. Please ensure you have write access to the project directory. Error details: ${ge.message}`)}const B=l.name,le=`images/${B}`;try{const A=await(await N.getFileHandle(B,{create:!0})).createWritable();return await A.write(l),await A.close(),console.log(`Image copied to project directory: ${le}`),le}catch(ge){throw new Error(`Failed to copy image file "${B}" to project images directory. The file may be locked by another application, or there may be insufficient disk space. Please try again or check your disk space. Error details: ${ge.message}`)}}catch(N){throw N instanceof Error&&N.message.includes("No project directory")||N instanceof Error&&N.message.includes("Failed to")?N:new Error(`An unexpected error occurred while copying the image to the project directory. This may be due to file system permissions or disk space issues. Please try again. Technical details: ${N.message}`)}},[]),bf=L.useCallback(async(l,y)=>{try{const N=l.name.toLowerCase(),le=[".png",".jpg",".jpeg"].some(be=>N.endsWith(be)),A=["image/png","image/jpeg","image/jpg"].includes(l.type);if(!le&&!A){alert(`Error: Unsupported image format.

The software only accepts PNG and JPEG image files.

File selected: ${l.name}
File type: ${l.type||"unknown"}

Please select a .png, .jpg, or .jpeg image file.`);return}let je;if(Pi)try{je=await Cu(l,Pi)}catch(be){const me=be instanceof Error?be.message:"Unknown error occurred while copying image to project directory.";alert(`Error: ${me}

The image could not be loaded. Please ensure you have a project open and have write permissions to the project directory.`);return}else{if(!confirm(`Warning: No project directory is currently open. The image will be loaded, but you must create or open a project and save it before the image will be stored in the project directory.

Do you want to continue loading the ${y==="top"?"top":"bottom"} image?`))return;je=l.name}const ne=await createImageBitmap(l),Te=URL.createObjectURL(l),ve=Lr.current;let Ce=0,ye=0;ve&&(Ce=ya.x,ye=ya.y);const we={url:Te,name:l.name,width:ne.width,height:ne.height,filePath:je,x:Ce,y:ye,scale:1,rotation:0,flipX:!1,flipY:!1,skewX:0,skewY:0,keystoneV:0,keystoneH:0,bitmap:ne};y==="top"?m(we):_(we)}catch(N){const B=N instanceof Error?N.message:"Unknown error occurred while loading the image.";alert(`Error: Failed to load image file "${l.name}".

${B}

Please ensure the file is a valid image format (PNG, JPEG, etc.) and is not corrupted.`),console.error("Failed to load image",N)}},[ya,yt,Pi,Cu]),Ad=L.useCallback(l=>{l.stopPropagation(),l.preventDefault();const y=Lr.current;if(!y)return;document.activeElement!==y&&y.focus();const N=y.getBoundingClientRect(),B=y.width/N.width,le=y.height/N.height,ge=l.nativeEvent.offsetX,A=l.nativeEvent.offsetY,je=typeof ge=="number"?ge:l.clientX-N.left,ne=typeof A=="number"?A:l.clientY-N.top,Te=je*B,ve=ne*le,Ce=Te-5,ye=ve-5,we=Of(Ce,ye,zi,yt,On,Ei),be=we.x,me=we.y;if(Kc.current&&I==="select"){ml(!0),mu({start:{x:be,y:me},end:{x:be,y:me}});return}if(I==="center"){Us(!0),Ma.current&&clearTimeout(Ma.current),Ma.current=setTimeout(()=>{Us(!1),oe("select"),So(void 0)},2e3);return}if(I==="select"){if(Pa){let We=1/0,lt=null,ut=null;const Rt=Math.max(6/yt,4),Sn=[...tn,...cn].find(Vn=>Vn.id===Pa.componentId)?.layer||"top";for(const Vn of Qe)if((Vn.type==="via"||Vn.type==="pad")&&Vn.points.length>0){if(Vn.type==="pad"&&(Vn.layer||"top")!==Sn)continue;const Rn=Vn.points[0],Kn=Math.max(1,Vn.size/2),hi=Math.hypot(Rn.x-be,Rn.y-me),Bn=Math.max(Kn,Rt);hi<=Bn&&hi<We&&(We=hi,lt=Rn.id??null,ut=Vn)}if(ut?(console.log(`
[PIN CONNECTION] Found via!`),console.log(`  Stroke ID: ${ut.id}`),console.log(`  Point ID: ${lt}`),console.log(`  Point coordinates: x=${ut.points[0].x.toFixed(2)}, y=${ut.points[0].y.toFixed(2)}`),console.log(`  Click coordinates: x=${be.toFixed(2)}, y=${me.toFixed(2)}`),console.log(`  Distance: ${We.toFixed(2)}`),console.log(`  Via size: ${ut.size}, radius: ${Math.max(1,ut.size/2)}`)):(console.log(`
[PIN CONNECTION] No via found!`),console.log(`  Click coordinates: x=${be.toFixed(2)}, y=${me.toFixed(2)}`),console.log(`  Hit tolerance: ${Rt.toFixed(2)}`),console.log(`  Total vias in drawingStrokes: ${Qe.filter(Vn=>Vn.type==="via").length}`)),lt!=null){console.log(`
[PIN CONNECTION] Proceeding with connection...`),console.log(`  bestPointId is valid: ${lt} (type: ${typeof lt})`);const Vn=String(lt),Rn=Pa.pinIndex,Kn=Pa.componentId;console.log(`
=== PIN CONNECTION START ===`),console.log(`Connecting pin ${Rn} (Pin ${Rn+1}) of component ${Kn} to point ID ${Vn}`);const hi=tn.find(It=>It.id===Kn),Bn=cn.find(It=>It.id===Kn);hi?(console.log("Component found in TOP layer"),Li(It=>{const Dn=It.find(oi=>oi.id===Kn);if(!Dn)return console.error(`Component ${Kn} not found in TOP layer during update!`),It;console.log("BEFORE update: pinConnections =",Dn.pinConnections);const vi=Dn.pinConnections||[],Wr=vi.length>0?[...vi]:new Array(Dn.pinCount).fill("");let Ni;if(Wr.length!==Dn.pinCount){Ni=new Array(Dn.pinCount).fill("");for(let oi=0;oi<Math.min(Wr.length,Dn.pinCount);oi++)Ni[oi]=Wr[oi]||""}else Ni=[...Wr];Ni[Rn]=Vn,console.log(`Updating pin ${Rn} with value: ${Vn}`),console.log("New pinConnections array:",Ni);const Ta=It.map(oi=>oi.id===Kn?{...oi,pinConnections:Ni}:oi),Ca=Ta.find(oi=>oi.id===Kn);return console.log("AFTER update: pinConnections =",Ca?.pinConnections),console.log(`Pin ${Rn} value: ${Ca?.pinConnections[Rn]}`),console.log(`=== PIN CONNECTION COMPLETE (TOP) ===
`),Ta})):Bn?(console.log("Component found in BOTTOM layer"),Si(It=>{const Dn=It.find(oi=>oi.id===Kn);if(!Dn)return console.error(`Component ${Kn} not found in BOTTOM layer during update!`),It;console.log("BEFORE update: pinConnections =",Dn.pinConnections);const vi=Dn.pinConnections||[],Wr=vi.length>0?[...vi]:new Array(Dn.pinCount).fill("");let Ni;if(Wr.length!==Dn.pinCount){Ni=new Array(Dn.pinCount).fill("");for(let oi=0;oi<Math.min(Wr.length,Dn.pinCount);oi++)Ni[oi]=Wr[oi]||""}else Ni=[...Wr];Ni[Rn]=Vn,console.log(`Updating pin ${Rn} with value: ${Vn}`),console.log("New pinConnections array:",Ni);const Ta=It.map(oi=>oi.id===Kn?{...oi,pinConnections:Ni}:oi),Ca=Ta.find(oi=>oi.id===Kn);return console.log("AFTER update: pinConnections =",Ca?.pinConnections),console.log(`Pin ${Rn} value: ${Ca?.pinConnections[Rn]}`),console.log(`=== PIN CONNECTION COMPLETE (BOTTOM) ===
`),Ta})):(console.error(`Component ${Kn} not found in either TOP or BOTTOM layer!`),console.log("Available TOP components:",tn.map(It=>It.id)),console.log("Available BOTTOM components:",cn.map(It=>It.id))),setTimeout(()=>{Uo(null)},0);return}else Uo(null)}const Me=10,De=(()=>{for(const We of tn)if(be>=We.x-Me&&be<=We.x+Me&&me>=We.y-Me&&me<=We.y+Me)return{layer:"top",comp:We};for(const We of cn)if(be>=We.x-Me&&be<=We.x+Me&&me>=We.y-Me&&me<=We.y+Me)return{layer:"bottom",comp:We};return null})();if(De){const{comp:We}=De;l.shiftKey?bn(lt=>{const ut=new Set(lt);return ut.has(We.id)?ut.delete(We.id):ut.add(We.id),ut}):(bn(new Set([We.id])),mn(new Set),_n(new Set),Tn(new Set));return}const He=Math.max(6/yt,4);let xt=null;for(const We of J){const lt=Math.max(6,We.size/2),ut=lt*.8,Rt=lt+ut,Vt=Math.hypot(We.x-be,We.y-me),Sn=Math.abs(be-We.x)<=He&&Math.abs(me-We.y)<=Rt,Vn=Math.abs(me-We.y)<=He&&Math.abs(be-We.x)<=Rt;if(Vt<=Math.max(lt,He)||Sn||Vn){xt=We;break}}if(xt){l.shiftKey?_n(We=>{const lt=new Set(We);return lt.has(xt.id)?lt.delete(xt.id):lt.add(xt.id),lt}):(_n(new Set([xt.id])),mn(new Set),bn(new Set),Tn(new Set));return}let pt=null;for(const We of te){const lt=Math.max(6,(We.size||18)/2),ut=lt*.8,Rt=lt+ut,Vt=Math.hypot(We.x-be,We.y-me),Sn=Math.abs(be-We.x)<=He&&Math.abs(me-We.y)<=Rt,Vn=Math.abs(me-We.y)<=He&&Math.abs(be-We.x)<=Rt;if(Vt<=Math.max(lt,He)||Sn||Vn){pt=We;break}}if(pt){l.shiftKey?Tn(We=>{const lt=new Set(We);return lt.has(pt.id)?lt.delete(pt.id):lt.add(pt.id),lt}):(Tn(new Set([pt.id])),mn(new Set),bn(new Set),_n(new Set));return}const st=Math.max(6/yt,4/yt),$e=Math.max(st,.5);let Ye=null;for(const We of Qe)if((We.type==="via"||We.type==="pad"||We.type==="testPoint")&&We.points.length>0){let lt=!1;if(We.type==="via"?lt=sa:We.type==="pad"?lt=(We.layer||"top")==="top"?Lo:Ii:We.type==="testPoint"&&(lt=(We.layer||"top")==="top"?uo:Mo),!lt)continue;const ut=We.points[0],Rt=Math.max(1,We.size/2);if(Math.hypot(ut.x-be,ut.y-me)<=Math.max(Rt,$e)){Ye=We;break}}if(Ye){l.shiftKey?mn(We=>{const lt=new Set(We);return lt.has(Ye.id)?lt.delete(Ye.id):lt.add(Ye.id),lt}):(mn(new Set([Ye.id])),bn(new Set),_n(new Set),Tn(new Set),Xt(new Set));return}l.shiftKey||(mn(new Set),bn(new Set),_n(new Set),Tn(new Set),Xt(new Set)),ts(!0),mf({x:be,y:me,shiftKey:l.shiftKey}),Nd({x:be,y:me,width:0,height:0});return}else if(I==="magnify"){const Me=l.shiftKey?.5:2,De=Math.max(.25,Math.min(8,yt*Me));jr(be,me),si(De);return}else if(I==="pan"){const Me={topImageX:g?.x??0,topImageY:g?.y??0,bottomImageX:S?.x??0,bottomImageY:S?.y??0,componentsTop:Object.fromEntries(tn.map(De=>[De.id,{x:De.x,y:De.y}])),componentsBottom:Object.fromEntries(cn.map(De=>[De.id,{x:De.x,y:De.y}])),powerSymbols:Object.fromEntries(Gt.map(De=>[De.id,{x:De.x,y:De.y}])),groundSymbols:Object.fromEntries(wn.map(De=>[De.id,{x:De.x,y:De.y}])),drawingStrokes:Qe.map(De=>({points:De.points.map(He=>({x:He.x,y:He.y}))})),vias:rr.map(De=>({x:De.x,y:De.y})),pads:jo.map(De=>({x:De.x,y:De.y}))};Os.current={startCX:Ce,startCY:ye,panX:zi.x,panY:zi.y,objectStartPositions:Me},Ja.current={startClientX:l.clientX,startClientY:l.clientY,panX:zi.x,panY:zi.y,objectStartPositions:Me},Dl(!0);return}else if(I==="draw"){const Me=(xt,pt)=>{let Nt=1/0,st=null;const $e=10/yt,Ye=yt>20?Math.max($e,1e-4):yt>10?Math.max($e,.001):Math.max($e,.01);for(const ut of Qe)if(ut.type==="via"){const Rt=ut.points[0],Vt=Math.hypot(Rt.x-xt,Rt.y-pt);Vt<=Ye&&Vt<Nt&&(Nt=Vt,st=Rt)}else if(ut.type==="pad"){const Rt=ut.points[0],Vt=Math.hypot(Rt.x-xt,Rt.y-pt);Vt<=Ye&&Vt<Nt&&(Nt=Vt,st=Rt)}for(const ut of J)if(ut.pointId!==void 0){const Rt=Math.hypot(ut.x-xt,ut.y-pt);Rt<=Ye&&Rt<Nt&&(Nt=Rt,st={x:ut.x,y:ut.y,id:ut.pointId})}for(const ut of te)if(ut.pointId!==void 0){const Rt=Math.hypot(ut.x-xt,ut.y-pt);Rt<=Ye&&Rt<Nt&&(Nt=Rt,st={x:ut.x,y:ut.y,id:ut.pointId})}const lt=or(st??{x:xt,y:pt});return{x:lt.x,y:lt.y,nodeId:st?.id}};if(rt==="via"){const xt=Hn.get("via"),pt=xt.color,Nt=xt.size,qt=mr?{x:or({x:be,y:me}).x,y:or({x:be,y:me}).y}:((ut,Rt)=>{let Vt=1/0,Sn=null;const Rn=10/yt,Kn=yt>10?Math.max(Rn,.001):Math.max(Rn,.01);for(const It of Qe)if(It.type==="via"||It.type==="pad"){const Dn=It.points[0],vi=Math.hypot(Dn.x-ut,Dn.y-Rt);vi<=Kn&&vi<Vt&&(Vt=vi,Sn=Dn)}for(const It of J)if(It.pointId!==void 0){const Dn=Math.hypot(It.x-ut,It.y-Rt);Dn<=Kn&&Dn<Vt&&(Vt=Dn,Sn={x:It.x,y:It.y,id:It.pointId})}for(const It of te)if(It.pointId!==void 0){const Dn=Math.hypot(It.x-ut,It.y-Rt);Dn<=Kn&&Dn<Vt&&(Vt=Dn,Sn={x:It.x,y:It.y,id:It.pointId})}const Bn=or(Sn??{x:ut,y:Rt});return{x:Bn.x,y:Bn.y,nodeId:Sn?.id}})(be,me),$e=qt.nodeId??hc(),Ye=Fa($e,Ie),We={id:$e,x:qt.x,y:qt.y};Ji(Qe,tn,cn,Gt,wn);const lt={id:`${Date.now()}-via`,points:[We],color:pt,size:Nt,layer:Lt,type:"via",viaType:Ye};At(ut=>[...ut,lt]),Lt==="top"?Ft(ut=>[...ut,lt.id]):br(ut=>[...ut,lt.id]);return}if(rt==="pad"){if(!di)return;const pt=mr?{x:or({x:be,y:me}).x,y:or({x:be,y:me}).y}:((lt,ut)=>{let Rt=1/0,Vt=null;const Vn=10/yt,Rn=yt>10?Math.max(Vn,.001):Math.max(Vn,.01);for(const Bn of Qe)if(Bn.type==="via"||Bn.type==="pad"||Bn.type==="testPoint"){const It=Bn.points[0],Dn=Math.hypot(It.x-lt,It.y-ut);Dn<=Rn&&Dn<Rt&&(Rt=Dn,Vt=It)}for(const Bn of J)if(Bn.pointId!==void 0){const It=Math.hypot(Bn.x-lt,Bn.y-ut);It<=Rn&&It<Rt&&(Rt=It,Vt={x:Bn.x,y:Bn.y,id:Bn.pointId})}for(const Bn of te)if(Bn.pointId!==void 0){const It=Math.hypot(Bn.x-lt,Bn.y-ut);It<=Rn&&It<Rt&&(Rt=It,Vt={x:Bn.x,y:Bn.y,id:Bn.pointId})}const hi=or(Vt??{x:lt,y:ut});return{x:hi.x,y:hi.y,nodeId:Vt?.id}})(be,me),Nt=pt.nodeId??hc(),st=Ua(Nt,Ie),qt=F||(di==="top"?G:ie),$e=U||(di==="top"?re:Re),Ye={id:Nt,x:pt.x,y:pt.y};Ji(Qe,tn,cn,Gt,wn);const We={id:`${Date.now()}-pad`,points:[Ye],color:qt,size:$e,layer:di,type:"pad",padType:st};At(lt=>[...lt,We]);return}if(rt==="testPoint"){if(!Di)return;const pt=mr?{x:or({x:be,y:me}).x,y:or({x:be,y:me}).y}:((ut,Rt)=>{let Vt=1/0,Sn=null;const Vn=15;for(const hi of Qe)if(hi.type==="via"||hi.type==="pad"||hi.type==="testPoint"){const Bn=hi.points[0],It=Math.hypot(Bn.x-ut,Bn.y-Rt);It<=Vn&&It<Vt&&(Vt=It,Sn=Bn)}for(const hi of J)if(hi.pointId!==void 0){const Bn=Math.hypot(hi.x-ut,hi.y-Rt);Bn<=Vn&&Bn<Vt&&(Vt=Bn,Sn={x:hi.x,y:hi.y,id:hi.pointId})}for(const hi of te)if(hi.pointId!==void 0){const Bn=Math.hypot(hi.x-ut,hi.y-Rt);Bn<=Vn&&Bn<Vt&&(Vt=Bn,Sn={x:hi.x,y:hi.y,id:hi.pointId})}const Kn=or(Sn??{x:ut,y:Rt});return{x:Kn.x,y:Kn.y,nodeId:Sn?.id}})(be,me),Nt=pt.nodeId??hc(),st=us(Nt,Ie),qt=st.includes("Power")?"power":st.includes("Ground")?"ground":st.includes("Signal")?"signal":"unknown",$e=or({x:pt.x,y:pt.y}),Ye=F||(Di==="top"?et:Ct),We=U||(Di==="top"?se:Jt);Ji(Qe,tn,cn,Gt,wn);const lt={id:`${Date.now()}-testPoint`,points:[{id:Nt,x:$e.x,y:$e.y}],color:Ye,size:We,layer:Di,type:"testPoint",testPointType:qt};At(ut=>[...ut,lt]);return}if(Zi.current)return;const De=rt==="trace"&&!mr?Me(be,me):{x:or({x:be,y:me}).x,y:or({x:be,y:me}).y},He=De.nodeId!==void 0?{id:De.nodeId,x:De.x,y:De.y}:{x:De.x,y:De.y};Qt(xt=>xt.length===0?[He]:[...xt,He]),wr.current=Date.now(),Xn(null),xn(!1),Qo(!1)}else if(I==="erase"){if(Qe.some(De=>De.layer===Lt&&(De.type==="via"&&da||De.type==="pad"&&Xr||De.type==="testPoint"&&ko||De.type==="trace"&&Vi))){const De=[];da&&Qe.some(He=>He.layer===Lt&&He.type==="via")&&De.push("vias"),Xr&&Qe.some(He=>He.layer===Lt&&He.type==="pad")&&De.push("pads"),ko&&Qe.some(He=>He.layer===Lt&&He.type==="testPoint")&&De.push("test points"),Vi&&Qe.some(He=>He.layer===Lt&&He.type==="trace")&&De.push("traces"),De.length>0&&alert(`Cannot erase: ${De.join(", ")} are locked on the ${Lt} layer. Unlock them to erase.`)}xn(!0),Qt([{id:hc(),x:be,y:me}]),console.log("Starting erase at:",be,me,"selectedDrawingLayer:",Lt,"total strokes:",Qe.length)}else if(I==="transform"&&jn){if(Cr){alert("Cannot transform: Images are locked. Unlock images to transform them.");return}Bt(!0),on({x:be,y:me})}else if(I==="component"){if(!lc.current)return;const Me=or({x:be,y:me}),He=(Oo.current||"top")==="top"?"componentTop":"componentBottom",xt=Hn.get(He),pt=xt.color,Nt=xt.size,st=[...tn,...cn];let qt;if(Hi?qt=Ff():qt={...Qn.current},!Oo.current)return;const $e=xf.current?.dataDrivenDefinition;if(!$e){console.error("[Component Creation] Missing dataDrivenDefinition metadata for selected component.");return}let Ye;try{Ye=w2({definition:$e,layer:Oo.current,x:Me.x,y:Me.y,color:pt,size:Nt,existingComponents:st,counters:Ir?qt:{}})}catch(We){console.error("[Component Creation] Error creating component with v2 runtime:",We);return}if(Ye.abbreviation=zg(lc.current),Ir&&Ye.designator){const We=Ye.designator.match(/^([A-Za-z]+)(\d+)$/);if(We){const lt=We[1],ut=parseInt(We[2],10);if(Hi){const Rt=Ff();m1(lt,ut,Rt)}else Qn.current[lt]=Math.max(Qn.current[lt]||0,ut)}}Ji(Qe,tn,cn,Gt,wn),Oo.current==="top"?(k(!0),Li(We=>[...We,Ye])):(q(!0),Si(We=>[...We,Ye]));return}else if(I==="power"){if(!sn)return;const De=mr?{x:or({x:be,y:me}).x,y:or({x:be,y:me}).y}:((xt,pt)=>{let Nt=1/0,st=null;const $e=10/yt,Ye=yt>20?Math.max($e,1e-4):yt>10?Math.max($e,.001):Math.max($e,.01);for(const ut of Qe)if(ut.type==="via"||ut.type==="pad"){const Rt=ut.points[0],Vt=Math.hypot(Rt.x-xt,Rt.y-pt);Vt<=Ye&&Vt<Nt&&(Nt=Vt,st=Rt)}else if(ut.type==="trace")for(const Rt of ut.points){const Vt=Math.hypot(Rt.x-xt,Rt.y-pt);Vt<=Ye&&Vt<Nt&&(Nt=Vt,st=Rt)}const lt=or(st??{x:xt,y:pt});return{x:lt.x,y:lt.y,nodeId:st?.id}})(be,me),He=Ie.find(xt=>xt.id===sn);if(He){const xt=De.nodeId??hc(),pt=`${He.voltage} Power Node`;if(te.find(qt=>qt.pointId===xt)){Bs({visible:!0,title:"Node ID Conflict",message:`Cannot place power node: A ground node already exists at this Node ID (${xt}). Power and ground nodes cannot share the same Node ID.`});return}Ji(Qe,tn,cn,Gt,wn);const st={id:`power-${Date.now()}-${Math.random()}`,x:De.x,y:De.y,color:"#ff0000",size:U,powerBusId:He.id,layer:Lt,type:pt,pointId:xt};if(fn(qt=>[...qt,st]),De.nodeId!==void 0){const qt=Fa(De.nodeId,Ie),$e=Ua(De.nodeId,Ie),Ye=us(De.nodeId,Ie),We=Ye.includes("Power")?"power":Ye.includes("Ground")?"ground":Ye.includes("Signal")?"signal":"unknown";At(lt=>lt.map(ut=>ut.type==="via"&&ut.points.length>0&&ut.points[0].id===De.nodeId?{...ut,viaType:qt}:ut.type==="pad"&&ut.points.length>0&&ut.points[0].id===De.nodeId?{...ut,padType:$e}:ut.type==="testPoint"&&ut.points.length>0&&ut.points[0].id===De.nodeId?{...ut,testPointType:We}:ut))}}return}else if(I==="ground"){if(Un===null){if(gt.length===0){Bs({visible:!0,title:"No Ground Bus",message:"No ground buses are defined. Please create a ground bus first using Tools  Manage Ground Buses."});return}yn(!0);return}const Me=gt.find(De=>De.id===Un);if(Me){const He=mr?{x:or({x:be,y:me}).x,y:or({x:be,y:me}).y}:((qt,$e)=>{let Ye=1/0,We=null;const ut=10/yt,Rt=yt>20?Math.max(ut,1e-4):yt>10?Math.max(ut,.001):Math.max(ut,.01);for(const Vn of Qe)if(Vn.type==="via"||Vn.type==="pad"){const Rn=Vn.points[0],Kn=Math.hypot(Rn.x-qt,Rn.y-$e);Kn<=Rt&&Kn<Ye&&(Ye=Kn,We=Rn)}else if(Vn.type==="trace")for(const Rn of Vn.points){const Kn=Math.hypot(Rn.x-qt,Rn.y-$e);Kn<=Rt&&Kn<Ye&&(Ye=Kn,We=Rn)}const Sn=or(We??{x:qt,y:$e});return{x:Sn.x,y:Sn.y,nodeId:We?.id}})(be,me),xt=He.nodeId??hc(),pt=`${Me.name} Ground Node`,Nt=J.find(qt=>qt.pointId===xt);if(Nt){Bs({visible:!0,title:"Node ID Conflict",message:`Cannot place ground node: A power node (${Nt.type||"Power Node"}) already exists at this Node ID (${xt}). Power and ground nodes cannot share the same Node ID.`});return}Ji(Qe,tn,cn,Gt,wn);const st={id:`gnd-${Date.now()}-${Math.random().toString(36).slice(2,6)}`,x:He.x,y:He.y,color:Me.color,size:U||vn.get("ground")?.settings.size||18,groundBusId:Me.id,layer:Lt,type:pt,pointId:xt};if(Fn(qt=>[...qt,st]),He.nodeId!==void 0){const qt=Fa(He.nodeId,Ie),$e=Ua(He.nodeId,Ie);At(Ye=>Ye.map(We=>We.type==="via"&&We.points.length>0&&We.points[0].id===He.nodeId?{...We,viaType:qt}:We.type==="pad"&&We.points.length>0&&We.points[0].id===He.nodeId?{...We,padType:$e}:We))}}return}},[I,jn,U,F,rt,Lt,Qe,yt,zi.x,zi.y,On,Ei,mr,sn,Un,Ie,gt,Ss,vn,di,Jn,Di,J,te,Fa,Ua,us,sa,Lo,Ii]),up=L.useCallback(l=>{if(I!=="magnify")return;l.preventDefault();const y=Lr.current;if(!y)return;const N=y.getBoundingClientRect(),B=y.width/N.width,le=y.height/N.height,ge=l.nativeEvent.offsetX,A=l.nativeEvent.offsetY,je=typeof ge=="number"?ge:l.clientX-N.left,ne=typeof A=="number"?A:l.clientY-N.top,Te=je*B,ve=ne*le,Ce=Te-5,ye=ve-5,we=Of(Ce,ye,zi,yt,On,Ei),be=we.x,me=we.y,Me=1.2,De=1/Me,He=l.deltaY<0?Me:De,xt=Math.max(.25,Math.min(8,yt*He));jr(be,me),si(xt)},[I,yt,zi.x,zi.y,On,Ei]),yh=L.useCallback(l=>{if(I==="draw"&&rt==="trace"){Zi.current=!0;let He=Kt;if(He.length>1){const xt=[He[0]];for(let pt=1;pt<He.length;pt++){const Nt=xt[xt.length-1],st=He[pt];(Math.abs(Nt.x-st.x)>.001||Math.abs(Nt.y-st.y)>.001)&&xt.push(st)}He=xt}if(He.length>=1){Ji(Qe,tn,cn,Gt,wn);const xt=Jn||"top",pt=xt==="top"?"traceTop":"traceBottom",Nt=Hn.get(pt),st={id:`${Date.now()}-trace`,points:He,color:Nt.color,size:Nt.size,layer:xt,type:"trace"};At(qt=>[...qt,st]),xt==="top"?za(qt=>[...qt,st.id]):Fo(qt=>[...qt,st.id]),Qt([]),Xn(null),setTimeout(()=>{Zi.current=!1},300);return}}const y=Lr.current;if(!y)return;const N=y.getBoundingClientRect(),B=y.width/N.width,le=y.height/N.height,ge=l.nativeEvent.offsetX,A=l.nativeEvent.offsetY,je=typeof ge=="number"?ge:l.clientX-N.left,ne=typeof A=="number"?A:l.clientY-N.top,Te=je*B,ve=ne*le,Ce=Te-5,ye=ve-5,we=Of(Ce,ye,zi,yt,On,Ei),be=we.x,me=we.y,Me=Math.max(8/yt,4),De=(()=>{for(const He of Qe)if(He.type==="testPoint"&&He.points.length>0){const xt=He.points[0],pt=Math.hypot(xt.x-be,xt.y-me),Nt=(He.size||18)/2;if(pt<=Nt+Me)return He}return null})();if(De){mn(new Set([De.id])),bn(new Set),_n(new Set),Tn(new Set),sr(!0);return}if(I==="select"||I==="component"){const xt=(()=>{for(const st of tn)if(be>=st.x-10&&be<=st.x+10&&me>=st.y-10&&me<=st.y+10)return{layer:"top",comp:st};for(const st of cn)if(be>=st.x-10&&be<=st.x+10&&me>=st.y-10&&me<=st.y+10)return{layer:"bottom",comp:st};return null})(),pt=Math.max(6/yt,4);let Nt=null;for(const st of J){const qt=Math.max(6,st.size/2),$e=qt*.8,Ye=qt+$e,We=Math.hypot(st.x-be,st.y-me),lt=Math.abs(be-st.x)<=pt&&Math.abs(me-st.y)<=Ye,ut=Math.abs(me-st.y)<=pt&&Math.abs(be-st.x)<=Ye;if(We<=Math.max(qt,pt)||lt||ut){Nt=st;break}}if(Nt){_n(new Set([Nt.id])),fr({visible:!0,id:Nt.id,layer:Nt.layer,x:Nt.x,y:Nt.y,size:Nt.size,color:Nt.color,powerBusId:Nt.powerBusId});return}if(xt){const{layer:st,comp:qt}=xt;ze(qt,st)}}},[I,rt,F,U,Lt,tn,cn,J,yt,zi.x,zi.y,On,Ei,Ss,mr,Qe,jn,ss,lp,Pa,vn,Kt,Jn,_e,xe,ke,C,sr,mn,bn,_n,Tn,ze]),tu=L.useCallback(()=>{const l=In.current;if(I==="draw"&&rt==="trace"&&l.length>=2){let y=[l[0]];for(let A=1;A<l.length;A++){const je=y[y.length-1],ne=l[A];(Math.abs(je.x-ne.x)>.001||Math.abs(je.y-ne.y)>.001)&&y.push(ne)}const N=Jn||"top",B=N==="top"?"traceTop":"traceBottom",le=Hn.get(B),ge={id:`${Date.now()}-trace`,points:y,color:le.color,size:le.size,layer:N,type:"trace"};Ji(Qe,tn,cn,Gt,wn),At(A=>[...A,ge]),N==="top"?za(A=>[...A,ge.id]):Fo(A=>[...A,ge.id]),Qt([]),Xn(null)}else if(I==="draw"&&rt==="trace"&&l.length===1){const y=Jn||"top",N=y==="top"?"traceTop":"traceBottom",B=Hn.get(N),le={id:`${Date.now()}-trace-dot`,points:l,color:B.color,size:B.size,layer:y,type:"trace"};At(ge=>[...ge,le]),y==="top"?za(ge=>[...ge,le.id]):Fo(ge=>[...ge,le.id]),Qt([])}},[I,rt,Jn,_e,xe,ke,C,At]),zd=L.useCallback((l,y,N)=>{const B=y-l.x,le=N-l.y;if(B===0&&le===0)return{x:y,y:N};const A=(f2(B,le)%180+180)%180,je=[0,45,90];let ne=0,Te=1e9;for(const ve of je){const Ce=Math.abs(A-ve);Ce<Te&&(Te=Ce,ne=ve)}if(ne===0)return{x:y,y:l.y};if(ne===90)return{x:l.x,y:N};{const ve=Math.min(Math.abs(B),Math.abs(le)),Ce=B>=0?1:-1,ye=le>=0?1:-1;return{x:l.x+Ce*ve,y:l.y+ye*ve}}},[]),dp=L.useCallback(l=>{const y=Lr.current?.getBoundingClientRect();if(!y)return;const N=l.clientX-y.left,B=l.clientY-y.top,le=Lr.current,ge=le.width/y.width,A=le.height/y.height,je=N*ge,ne=B*A,Te=je-5,ve=ne-5,Ce=Of(Te,ve,zi,yt,On,Ei),ye=Ce.x,we=Ce.y;if(Mr({x:ye,y:we}),kc.current&&rc.current&&mu({start:rc.current.start,end:{x:ye,y:we}}),I==="draw"&&rt==="trace"&&Kt.length>0){const me=mr?{x:or({x:ye,y:we}).x,y:or({x:ye,y:we}).y}:((Me,De)=>{let He=1/0,xt=null;const Nt=10/yt,st=yt>20?Math.max(Nt,1e-4):yt>10?Math.max(Nt,.001):Math.max(Nt,.01);for(const Ye of Qe)if(Ye.type==="via"){const We=Ye.points[0],lt=Math.hypot(We.x-Me,We.y-De);lt<=st&&lt<He&&(He=lt,xt=We)}else if(Ye.type==="pad"){const We=Ye.points[0],lt=Math.hypot(We.x-Me,We.y-De);lt<=st&&lt<He&&(He=lt,xt=We)}for(const Ye of J)if(Ye.pointId!==void 0){const We=Math.hypot(Ye.x-Me,Ye.y-De);We<=st&&We<He&&(He=We,xt={x:Ye.x,y:Ye.y,id:Ye.pointId})}for(const Ye of te)if(Ye.pointId!==void 0){const We=Math.hypot(Ye.x-Me,Ye.y-De);We<=st&&We<He&&(He=We,xt={x:Ye.x,y:Ye.y,id:Ye.pointId})}const $e=or(xt??{x:Me,y:De});return{x:$e.x,y:$e.y,nodeId:xt?.id}})(ye,we);Xn({x:me.x,y:me.y})}else Xn(null);if(qc){const me=(()=>{for(const Me of tn)if(ye>=Me.x-10&&ye<=Me.x+10&&we>=Me.y-10&&we<=Me.y+10)return{layer:"top",comp:Me};for(const Me of cn)if(ye>=Me.x-10&&ye<=Me.x+10&&we>=Me.y-10&&we<=Me.y+10)return{layer:"bottom",comp:Me};return null})();if(me)fi({component:me.comp,layer:me.layer,x:l.clientX,y:l.clientY}),gr(null);else{fi(null);const Me=Math.max(8/yt,4),De=(()=>{for(const He of Qe)if(He.type==="testPoint"&&He.points.length>0){const xt=He.points[0],pt=Math.hypot(xt.x-ye,xt.y-we),Nt=(He.size||18)/2;if(pt<=Nt+Me)return He}return null})();gr(De?{stroke:De,x:l.clientX,y:l.clientY}:null)}}else fi(null),gr(null);if(I==="select"&&Zs&&eu){const be=eu.x,me=eu.y;Nd({x:Math.min(be,ye),y:Math.min(me,we),width:Math.abs(ye-be),height:Math.abs(we-me)})}else if(I==="pan"&&ss&&Os.current){const{startCX:be,startCY:me,objectStartPositions:Me}=Os.current,De=Te-be,He=ve-me,xt=g1(De,He,yt,On,Ei),pt=xt.x,Nt=xt.y;Me&&(g&&m({...g,x:Me.topImageX+pt,y:Me.topImageY+Nt}),S&&_({...S,x:Me.bottomImageX+pt,y:Me.bottomImageY+Nt}),Li(tn.map(st=>({...st,x:(Me.componentsTop?.[st.id]?.x??st.x)+pt,y:(Me.componentsTop?.[st.id]?.y??st.y)+Nt}))),Si(cn.map(st=>({...st,x:(Me.componentsBottom?.[st.id]?.x??st.x)+pt,y:(Me.componentsBottom?.[st.id]?.y??st.y)+Nt}))),fn(Gt.map(st=>({...st,x:(Me.powerSymbols?.[st.id]?.x??st.x)+pt,y:(Me.powerSymbols?.[st.id]?.y??st.y)+Nt}))),Fn(wn.map(st=>({...st,x:(Me.groundSymbols?.[st.id]?.x??st.x)+pt,y:(Me.groundSymbols?.[st.id]?.y??st.y)+Nt}))),At(Qe.map((st,qt)=>({...st,points:st.points.map(($e,Ye)=>{const We=Me.drawingStrokes?.[qt]?.points?.[Ye];return{...$e,x:(We?.x??$e.x)+pt,y:(We?.y??$e.y)+Nt}})}))),ba(rr.map((st,qt)=>{const $e=Me.vias?.[qt];return{...st,x:($e?.x??st.x)+pt,y:($e?.y??st.y)+Nt}})),To(jo.map((st,qt)=>{const $e=Me.pads?.[qt];return{...st,x:($e?.x??st.x)+pt,y:($e?.y??st.y)+Nt}})))}else if(un&&Kt.length>0){if(I==="draw")if(Jo){const be=Kt[0],me=zd(be,ye,we),Me=or(me),De={id:hc(),x:Me.x,y:Me.y};Qt([be,De])}else{const be=or({x:ye,y:we});Qt(me=>[...me,{id:hc(),x:be.x,y:be.y}])}else if(I==="erase"&&(Qt(be=>[...be,{id:hc(),x:ye,y:we}]),At(be=>{const me=be.filter(De=>{if(De.type==="via"&&da||De.type==="pad"&&Xr||De.type==="testPoint"&&ko||De.type==="trace"&&Vi||De.layer!==Lt)return!0;const He=U/2,xt=ye-He,pt=ye+He,Nt=we-He,st=we+He,qt=(We,lt)=>We>=xt&&We<=pt&&lt>=Nt&&lt<=st,$e=(We,lt,ut,Rt)=>{const hi=(Ta,Ca)=>{let oi=0;return Ta<xt?oi|=1:Ta>pt&&(oi|=2),Ca<Nt?oi|=4:Ca>st&&(oi|=8),oi};let Bn=We,It=lt,Dn=ut,vi=Rt,Wr=hi(Bn,It),Ni=hi(Dn,vi);for(;;){if((Wr|Ni)===0)return!0;if((Wr&Ni)!==0)return!1;const Ta=Wr!==0?Wr:Ni;let Ca=0,oi=0;Ta&8?(Ca=Bn+(Dn-Bn)*(st-It)/(vi-It),oi=st):Ta&4?(Ca=Bn+(Dn-Bn)*(Nt-It)/(vi-It),oi=Nt):Ta&2?(oi=It+(vi-It)*(pt-Bn)/(Dn-Bn),Ca=pt):(oi=It+(vi-It)*(xt-Bn)/(Dn-Bn),Ca=xt),Ta===Wr?(Bn=Ca,It=oi,Wr=hi(Bn,It)):(Dn=Ca,vi=oi,Ni=hi(Dn,vi))}};let Ye=!1;if(De.points.length===1){const We=De.points[0];Ye=qt(We.x,We.y)}else for(let We=0;We<De.points.length-1;We++){const lt=De.points[We],ut=De.points[We+1];if($e(lt.x,lt.y,ut.x,ut.y)){Ye=!0;break}}return Ye&&console.log("Erasing stroke at position:",ye,we,"brushSize:",U,"selectedLayer:",Lt),!Ye});console.log("Strokes before:",be.length,"after:",me.length);const Me=new Set(me.map(De=>De.id));return Ft(De=>De.filter(He=>Me.has(He))),br(De=>De.filter(He=>Me.has(He))),za(De=>De.filter(He=>Me.has(He))),Fo(De=>De.filter(He=>Me.has(He))),me}),Qi||fn(be=>{const me=U/2,Me=ye-me,De=ye+me,He=we-me,xt=we+me,pt=Nt=>{const st=Nt.size/2,qt=Nt.x-st,$e=Nt.x+st,Ye=Nt.y-st,We=Nt.y+st;return!(De<qt||Me>$e||xt<Ye||He>We)};return be.filter(Nt=>!pt(Nt))}),Vr||Fn(be=>{const me=U/2,Me=ye-me,De=ye+me,He=we-me,xt=we+me,pt=st=>{const qt=Math.max(6,(st.size||18)/2),$e=qt*.8,Ye=qt+$e,We=st.x-Ye,lt=st.x+Ye,ut=st.y-Ye,Rt=st.y+Ye;return!(De<We||Me>lt||xt<ut||He>Rt)};return be.filter(st=>!pt(st))}),!Kr)){const be=U/2,me=ye-be,Me=ye+be,De=we-be,He=we+be,xt=pt=>{const st=(pt.size||18)/2,qt=pt.x-st,$e=pt.x+st,Ye=pt.y-st,We=pt.y+st;return!(Me<qt||me>$e||He<Ye||De>We)};Ji(Qe,tn,cn,Gt,wn),Li(pt=>pt.filter(Nt=>!xt(Nt))),Si(pt=>pt.filter(Nt=>!xt(Nt)))}}else if(Et&&Zt&&jn){if(Cr){Bt(!1),on(null);return}const be=ye-Zt.x,me=we-Zt.y;if(jn==="top"){g&&m(Me=>Me?{...Me,x:Me.x+be,y:Me.y+me}:null),on({x:ye,y:we});return}if(jn==="bottom"){S&&_(Me=>Me?{...Me,x:Me.x+be,y:Me.y+me}:null),on({x:ye,y:we});return}if(jn==="both"){g&&m(Me=>Me?{...Me,x:Me.x+be,y:Me.y+me}:null),S&&_(Me=>Me?{...Me,x:Me.x+be,y:Me.y+me}:null),on({x:ye,y:we});return}}},[un,Kt,I,U,Et,Zt,jn,g,S,Jo,zd,Lt,At,yt,zi.x,zi.y,On,Ei,Zs,eu,Cr,da,Xr,Vi,Qi,Vr,tn,cn,Li,Si,qc,fi,mr,Qe,J,te,Kt,rt,hn,Xn,ss,Os,na,5,zi,hc,or,oe,Us,Ji,Gt,wn,Mr]),vf=L.useCallback(()=>{if(Mr(null),Kc.current&&rc.current&&Xc.current&&kc.current){const l=rc.current,y=Xc.current,N=Math.abs(l.end.x-l.start.x),B=Math.abs(l.end.y-l.start.y);if(N>=1&&B>=1)try{const le=ow({numPins:y.numPins,type:y.type,twoSidedOrientation:y.twoSidedOrientation,point1:l.start,point2:l.end}),ge=new Set(Qe.flatMap(ne=>ne.points.map(Te=>Te.id||0).filter(Te=>Te>0))),A=ge.size>0?Math.max(...Array.from(ge))+1:1,je=le.map((ne,Te)=>{const ve=Nc.current?(di||"top")==="top"?"padTop":"padBottom":"via",Ce=Hn.get(ve),ye=A+Te,we=Nc.current&&di||"top";return{id:ye.toString(),type:Nc.current?"pad":"via",points:[{x:ne.x,y:ne.y,id:ye}],size:Ce.size,color:Ce.color,layer:we}});At(ne=>{const Te=[...ne,...je];return Ji(Te,tn,cn,Gt,wn),Te})}catch(le){console.error("IC Placement error:",le),alert(`Error placing ${Nc.current?"pads":"vias"}: ${le instanceof Error?le.message:String(le)}`)}yu(!1),mu(null),Gc(null),ml(!1),Kc.current=!1,rc.current=null,Xc.current=null,kc.current=!1,So(void 0),oe("select");return}if(I==="select"&&Zs){const l=cc,y=eu;if(ts(!1),mf(null),Nd(null),l&&y){const le=Math.max(3,5/yt),ge=l.width<le&&l.height<le,A=($e,Ye)=>{const We=l.x,lt=l.y,ut=l.x+l.width,Rt=l.y+l.height;return $e>=We&&$e<=ut&&Ye>=lt&&Ye<=Rt},je=($e,Ye,We,lt,ut,Rt,Vt,Sn)=>{const It=(oi,mo)=>{let fs=0;return oi<ut?fs|=1:oi>Vt&&(fs|=2),mo<Rt?fs|=4:mo>Sn&&(fs|=8),fs};let Dn=$e,vi=Ye,Wr=We,Ni=lt,Ta=It(Dn,vi),Ca=It(Wr,Ni);for(;;){if((Ta|Ca)===0)return!0;if((Ta&Ca)!==0)return!1;const oi=Ta!==0?Ta:Ca;let mo=0,fs=0;oi&8?(mo=Dn+(Wr-Dn)*(Sn-vi)/(Ni-vi),fs=Sn):oi&4?(mo=Dn+(Wr-Dn)*(Rt-vi)/(Ni-vi),fs=Rt):oi&2?(fs=vi+(Ni-vi)*(Vt-Dn)/(Wr-Dn),mo=Vt):(fs=vi+(Ni-vi)*(ut-Dn)/(Wr-Dn),mo=ut),oi===Ta?(Dn=mo,vi=fs,Ta=It(Dn,vi)):(Wr=mo,Ni=fs,Ca=It(Wr,Ni))}},ne=l.x,Te=l.y,ve=l.x+l.width,Ce=l.y+l.height,we=Math.max(6/yt,4/yt,.5),be=($e,Ye,We,lt,ut,Rt)=>{const Vt=ut-We,Sn=Rt-lt;if(Vt===0&&Sn===0)return Math.hypot($e-We,Ye-lt);const Vn=Math.max(0,Math.min(1,(($e-We)*Vt+(Ye-lt)*Sn)/(Vt*Vt+Sn*Sn))),Rn=We+Vn*Vt,Kn=lt+Vn*Sn;return Math.hypot($e-Rn,Ye-Kn)},me=y?.shiftKey===!0,Me=new Set(me?Array.from(ii):[]),De=new Set(me?Array.from($n):[]),He=new Set(me?Array.from(mi):[]),xt=new Set(me?Array.from(Yn):[]),pt=y?.hitStrokeId;if(pt){const $e=Qe.find(Ye=>Ye.id===pt);if($e){let Ye=!1;if($e.type==="via"||$e.type==="pad"?Ye=sa:Ye=$e.layer==="top"?Gi:to,Ye){me?mn(We=>{const lt=new Set(We);return lt.has(pt)?lt.delete(pt):lt.add(pt),lt}):(mn(new Set([pt])),bn(new Set),_n(new Set),Tn(new Set));return}}}if(ge){let $e=null;for(const Ye of Qe){let We=!1;if(Ye.type==="via"?We=sa:Ye.type==="pad"?We=(Ye.layer||"top")==="top"?Lo:Ii:Ye.type==="testPoint"?We=(Ye.layer||"top")==="top"?uo:Mo:Ye.type==="trace"?We=Ye.layer==="top"?Gi:to:We=!1,!We)continue;let lt=1/0;if(Ye.type==="via"||Ye.type==="pad"||Ye.type==="testPoint"){const ut=Ye.points[0],Rt=Math.max(1,Ye.size/2);lt=Math.hypot(ut.x-y.x,ut.y-y.y);const Sn=Math.max(6/yt,4/yt,.5);lt<=Math.max(Rt,Sn)&&(!$e||lt<$e.dist)&&($e={id:Ye.id,dist:lt})}else for(let ut=0;ut<Ye.points.length-1;ut++){const Rt=Ye.points[ut],Vt=Ye.points[ut+1],Sn=be(y.x,y.y,Rt.x,Rt.y,Vt.x,Vt.y);if(Sn<=Math.max(we,Ye.size/2)){(!$e||Sn<$e.dist)&&($e={id:Ye.id,dist:Sn});break}}}$e&&(me&&Me.has($e.id)?Me.delete($e.id):Me.add($e.id))}else for(const $e of Qe){let Ye=!1;if($e.type==="via"?Ye=sa:$e.type==="pad"?Ye=($e.layer||"top")==="top"?Lo:Ii:$e.type==="testPoint"?Ye=($e.layer||"top")==="top"?uo:Mo:$e.type==="trace"?Ye=$e.layer==="top"?Gi:to:Ye=!1,!Ye)continue;let We=!1;if($e.type==="via"||$e.type==="pad"||$e.type==="testPoint"){const lt=$e.points[0];We=A(lt.x,lt.y)}else for(let lt=0;lt<$e.points.length-1;lt++){const ut=$e.points[lt],Rt=$e.points[lt+1];if(je(ut.x,ut.y,Rt.x,Rt.y,ne,Te,ve,Ce)||A(ut.x,ut.y)&&A(Rt.x,Rt.y)){We=!0;break}}We&&(me&&Me.has($e.id)?Me.delete($e.id):Me.add($e.id))}const Nt=$e=>{const We=Math.max(10,$e.size||18)/2;return $e.x-We<=ve&&$e.x+We>=ne&&$e.y-We<=Ce&&$e.y+We>=Te};if(ge){const $e=Ye=>{const lt=Math.max(10,Ye.size||18)/2;return y.x>=Ye.x-lt&&y.x<=Ye.x+lt&&y.y>=Ye.y-lt&&y.y<=Ye.y+lt};x&&tn.forEach(Ye=>{$e(Ye)&&(me&&De.has(Ye.id)?De.delete(Ye.id):De.add(Ye.id))}),P&&cn.forEach(Ye=>{$e(Ye)&&(me&&De.has(Ye.id)?De.delete(Ye.id):De.add(Ye.id))})}else x&&tn.forEach($e=>{Nt($e)&&(me&&De.has($e.id)?De.delete($e.id):De.add($e.id))}),P&&cn.forEach($e=>{Nt($e)&&(me&&De.has($e.id)?De.delete($e.id):De.add($e.id))});const st=$e=>{const Ye=Math.max(6,$e.size/2),We=Ye*.8,lt=Ye+We;return $e.x-lt<=ve&&$e.x+lt>=ne&&$e.y-lt<=Ce&&$e.y+lt>=Te};if(Z)if(ge){let $e=null;for(const Ye of J){const We=Math.max(6,Ye.size/2),lt=We*.8,ut=We+lt,Rt=Math.hypot(Ye.x-y.x,Ye.y-y.y),Vt=Math.abs(y.x-Ye.x)<=we&&Math.abs(y.y-Ye.y)<=ut,Sn=Math.abs(y.y-Ye.y)<=we&&Math.abs(y.x-Ye.x)<=ut;if(Rt<=Math.max(We,we)||Vt||Sn){const Rn=Math.min(Rt,Math.abs(y.x-Ye.x)+Math.abs(y.y-Ye.y));(!$e||Rn<$e.dist)&&($e={id:Ye.id,dist:Rn})}}$e&&(me&&He.has($e.id)?He.delete($e.id):He.add($e.id))}else J.forEach($e=>{st($e)&&(me&&He.has($e.id)?He.delete($e.id):He.add($e.id))});const qt=$e=>{const Ye=Math.max(6,($e.size||18)/2),We=Ye*.8,lt=Ye+We;return $e.x-lt<=ve&&$e.x+lt>=ne&&$e.y-lt<=Ce&&$e.y+lt>=Te};if(ai)if(ge){let $e=null;for(const Ye of te){const We=Math.max(6,(Ye.size||18)/2),lt=We*.8,ut=We+lt,Rt=Math.hypot(Ye.x-y.x,Ye.y-y.y),Vt=Math.abs(y.x-Ye.x)<=we&&Math.abs(y.y-Ye.y)<=ut,Sn=Math.abs(y.y-Ye.y)<=we&&Math.abs(y.x-Ye.x)<=ut;if(Rt<=Math.max(We,we)||Vt||Sn){const Rn=Math.min(Rt,Math.abs(y.x-Ye.x)+Math.abs(y.y-Ye.y));(!$e||Rn<$e.dist)&&($e={id:Ye.id,dist:Rn})}}$e&&(me&&xt.has($e.id)?xt.delete($e.id):xt.add($e.id))}else te.forEach($e=>{qt($e)&&(me&&xt.has($e.id)?xt.delete($e.id):xt.add($e.id))});mn(Me),bn(De),_n(He),Tn(xt)}}if(un&&Kt.length>0){if(I==="draw"&&rt!=="trace"){const l={id:Date.now().toString(),points:Kt,color:F,size:U,layer:Lt,type:"trace"};At(y=>[...y,l]),Lt==="top"?za(y=>[...y,l.id]):Fo(y=>[...y,l.id])}Qt([])}ss&&(Dl(!1),Os.current=null,Ja.current=null),xn(!1),Bt(!1),on(null),Qo(!1)},[un,Kt,I,F,U,Lt,cc,eu,Zs,Qe,yt,Do,ii,J,te,tn,cn,$n,mi,Yn,sa,Gi,to,x,P,Z,ai,Mr]);Pt.useEffect(()=>{if(!(I==="pan"&&ss&&Ja.current))return;const l=N=>{const B=Lr.current;if(!B)return;const le=B.getBoundingClientRect(),ge=B.width/le.width,A=B.height/le.height,{startClientX:je,startClientY:ne,objectStartPositions:Te}=Ja.current,ve=(N.clientX-je)*ge,Ce=(N.clientY-ne)*A,ye=g1(ve,Ce,yt,On,Ei),we=ye.x,be=ye.y;Te&&(g&&m({...g,x:Te.topImageX+we,y:Te.topImageY+be}),S&&_({...S,x:Te.bottomImageX+we,y:Te.bottomImageY+be}),Li(tn.map(me=>({...me,x:(Te.componentsTop?.[me.id]?.x??me.x)+we,y:(Te.componentsTop?.[me.id]?.y??me.y)+be}))),Si(cn.map(me=>({...me,x:(Te.componentsBottom?.[me.id]?.x??me.x)+we,y:(Te.componentsBottom?.[me.id]?.y??me.y)+be}))),fn(Gt.map(me=>({...me,x:(Te.powerSymbols?.[me.id]?.x??me.x)+we,y:(Te.powerSymbols?.[me.id]?.y??me.y)+be}))),Fn(wn.map(me=>({...me,x:(Te.groundSymbols?.[me.id]?.x??me.x)+we,y:(Te.groundSymbols?.[me.id]?.y??me.y)+be}))),At(Qe.map((me,Me)=>({...me,points:me.points.map((De,He)=>{const xt=Te.drawingStrokes?.[Me]?.points?.[He];return{...De,x:(xt?.x??De.x)+we,y:(xt?.y??De.y)+be}})}))),ba(rr.map((me,Me)=>{const De=Te.vias?.[Me];return{...me,x:(De?.x??me.x)+we,y:(De?.y??me.y)+be}})),To(jo.map((me,Me)=>{const De=Te.pads?.[Me];return{...me,x:(De?.x??me.x)+we,y:(De?.y??me.y)+be}})))},y=()=>{Dl(!1),Os.current=null,Ja.current=null,window.removeEventListener("mousemove",l,!0),window.removeEventListener("mouseup",y,!0)};return window.addEventListener("mousemove",l,!0),window.addEventListener("mouseup",y,!0),()=>{window.removeEventListener("mousemove",l,!0),window.removeEventListener("mouseup",y,!0)}},[I,ss,yt,On,Ei,g,S,tn,cn,Gt,wn,Qe,rr,jo,m,_,Li,Si,fn,Fn,At,ba,To]);const ku=L.useCallback(()=>{const l=Lr.current;if(!l)return;const y=l.getContext("2d");if(!y)return;y.clearRect(0,0,l.width,l.height),y.fillStyle="#000000",y.fillRect(0,0,l.width,l.height),y.fillStyle="#ffffff",y.fillRect(5,5,l.width-10,l.height-10),y.save(),y.beginPath(),y.rect(5,5,l.width-10,l.height-10),y.clip(),y.translate(5,5);const N=(je,ne,Te,ve,Ce,ye,we,be)=>{const me=document.createElement("canvas");me.width=Te,me.height=ve;const Me=me.getContext("2d",{willReadFrequently:!0});Me.clearRect(0,0,Te,ve),Me.drawImage(ne,0,0,Te,ve);let De=me;if(Math.abs(Ce)>1e-6){const He=lh(Ce),xt=Math.max(.2,1-He),pt=Math.max(.2,1+He),Nt=Math.max(xt,pt),st=Math.max(1,Math.ceil(Te*Nt)),qt=document.createElement("canvas");qt.width=st,qt.height=ve;const $e=qt.getContext("2d",{willReadFrequently:!0});$e.clearRect(0,0,st,ve);for(let Ye=0;Ye<ve;Ye++){const We=ve<=1?0:Ye/(ve-1),lt=xt*(1-We)+pt*We,ut=Math.max(1,Te*lt),Rt=(st-ut)/2;$e.drawImage(De,0,Ye,Te,1,Rt,Ye,ut,1)}De=qt}if(Math.abs(ye)>1e-6){const He=lh(ye),xt=Math.max(.2,1-He),pt=Math.max(.2,1+He),Nt=Math.max(xt,pt),st=Math.max(1,Math.ceil(ve*Nt)),qt=document.createElement("canvas");qt.width=De.width,qt.height=st;const $e=qt.getContext("2d",{willReadFrequently:!0});$e.clearRect(0,0,qt.width,st);for(let Ye=0;Ye<De.width;Ye++){const We=De.width<=1?0:Ye/(De.width-1),lt=xt*(1-We)+pt*We,ut=Math.max(1,ve*lt),Rt=(st-ut)/2;$e.drawImage(De,Ye,0,1,De.height,Ye,Rt,1,ut)}De=qt}je.drawImage(De,-we/2,-be/2,we,be)};y.translate(zi.x,zi.y),y.scale(yt,yt),p2(y,On,Ei);{const je=eo&&Sa;if(g&&g.bitmap&&eo){const ne=g.bitmap;y.save(),y.globalAlpha=1;const Te=[];g.brightness!==void 0&&g.brightness!==100&&Te.push(`brightness(${g.brightness}%)`),g.contrast!==void 0&&g.contrast!==100&&Te.push(`contrast(${g.contrast}%)`),H&&Te.push("grayscale(100%)"),y.filter=Te.length>0?Te.join(" "):"none",Rg(y,{x:g.x,y:g.y,rotation:g.rotation||0,scale:g.scale||1,flipX:g.flipX||!1,flipY:g.flipY||!1,skewX:g.skewX||0,skewY:g.skewY||0});const ve=ne.width*1,Ce=ne.height*1,ye=ne;g.keystoneV&&Math.abs(g.keystoneV)>1e-6||g.keystoneH&&Math.abs(g.keystoneH)>1e-6?N(y,ye,ne.width,ne.height,g.keystoneV||0,g.keystoneH||0,ve,Ce):y.drawImage(ye,-ve/2,-Ce/2,ve,Ce),y.restore()}if(S&&S.bitmap&&Sa){const ne=S.bitmap;y.save(),y.globalAlpha=je?K/100:1;const Te=[];S.brightness!==void 0&&S.brightness!==100&&Te.push(`brightness(${S.brightness}%)`),S.contrast!==void 0&&S.contrast!==100&&Te.push(`contrast(${S.contrast}%)`),H&&Te.push("grayscale(100%)"),y.filter=Te.length>0?Te.join(" "):"none",Rg(y,{x:S.x,y:S.y,rotation:S.rotation||0,scale:S.scale||1,flipX:S.flipX||!1,flipY:S.flipY||!1,skewX:S.skewX||0,skewY:S.skewY||0});const ve=ne.width*1,Ce=ne.height*1,ye=ne;S.keystoneV&&Math.abs(S.keystoneV)>1e-6||S.keystoneH&&Math.abs(S.keystoneH)>1e-6?N(y,ye,ne.width,ne.height,S.keystoneV||0,S.keystoneH||0,ve,Ce):y.drawImage(ye,-ve/2,-Ce/2,ve,Ce),y.restore()}}if(wf(y),Z&&J.length>0){const je=ne=>{y.save(),h1(y,ne.x,ne.y,ne.rotation??0,ne.flipX??!1,!1);const Te=Ie.find(be=>be.id===ne.powerBusId),ve=mi.has(ne.id),Ce=Te?.color||"#ff0000";y.strokeStyle=Ce,y.lineWidth=Math.max(1,(ve?3:2)/Math.max(yt,.001)),y.lineCap="round";const ye=Math.max(6,ne.size/2),we=ye*.8;if(ve&&(y.strokeStyle="#0066ff",y.lineWidth=Math.max(1,4/Math.max(yt,.001)),y.beginPath(),y.arc(0,0,ye+we+3,0,Eo),y.stroke()),y.strokeStyle=Ce,y.lineWidth=Math.max(1,(ve?3:2)/Math.max(yt,.001)),y.beginPath(),y.arc(0,0,ye,0,Eo),y.stroke(),y.beginPath(),y.moveTo(0,-ye-we),y.lineTo(0,ye+we),y.stroke(),y.beginPath(),y.moveTo(-ye-we,0),y.lineTo(ye+we,0),y.stroke(),Te){y.fillStyle=Ce;const be=Math.max(10,ye*.8);y.font=`${be}px sans-serif`,y.textAlign="center",y.textBaseline="top",y.fillText(Te.name,0,ye+we+8)}y.restore()};J.forEach(je)}if(ai&&te.length>0){const je=ne=>{y.save(),h1(y,ne.x,ne.y,ne.rotation??0,ne.flipX??!1,!1);const Te=Yn.has(ne.id),ve=gt.find(be=>be.id===ne.groundBusId),Ce=ve?.color||ne.color||"#000000",ye=ne.groundBusId==="groundbus-earth";let we;if(ye){const be=Math.max(6,ne.size||18),me=be*.9,Me=be*.24,De=be*1.6;y.strokeStyle=Ce,y.lineWidth=Math.max(1,(Te?3:2)/Math.max(yt,.001)),y.lineCap="round",Te&&(y.strokeStyle="#0066ff",y.lineWidth=Math.max(1,4/Math.max(yt,.001)),y.setLineDash([5,5]),y.strokeRect(-De/2-3,-3,De+6,me+Me*2+6),y.setLineDash([])),y.strokeStyle=Ce,y.lineWidth=Math.max(1,(Te?3:2)/Math.max(yt,.001)),y.beginPath(),y.moveTo(0,0),y.lineTo(0,me),y.stroke();for(let He=0;He<3;He++){const xt=me+He*Me,pt=De*(1-He*.25);y.beginPath(),y.moveTo(-pt/2,xt),y.lineTo(pt/2,xt),y.stroke()}we=me+Me*2}else{const be=Math.max(6,(ne.size||18)/2),me=be*.8;Te&&(y.strokeStyle="#0066ff",y.lineWidth=Math.max(1,4/Math.max(yt,.001)),y.beginPath(),y.arc(0,0,be+me+3,0,Eo),y.stroke()),y.strokeStyle=Ce,y.lineWidth=Math.max(1,(Te?3:2)/Math.max(yt,.001)),y.beginPath(),y.arc(0,0,be,0,Eo),y.stroke(),y.beginPath(),y.moveTo(0,-be-me),y.lineTo(0,be+me),y.stroke(),y.beginPath(),y.moveTo(-be-me,0),y.lineTo(be+me,0),y.stroke(),we=be+me}if(ve){y.fillStyle=Ce;const be=Math.max(10,(ne.size||18)*.5);y.font=`${be}px sans-serif`,y.textAlign="center",y.textBaseline="top",y.fillText(ve.name,0,we+8)}y.restore()};te.forEach(je)}const B=je=>{const ne=Math.max(10,je.size||18),Te=ne/2;y.save(),y.translate(je.x,je.y),h2(y,On,Ei),je.orientation!==void 0&&je.orientation!==0&&y.rotate(pu(je.orientation)),je.flipX&&y.scale(-1,1),je.flipY&&y.scale(1,-1),y.strokeStyle=je.color||"#111",y.lineWidth=Math.max(1,2/Math.max(yt,.001));const ve=je.pinConnections||[],Ce=ve.length>0&&ve.length===je.pinCount&&ve.every(be=>be&&be.trim()!=="");y.fillStyle=Ce?"rgba(178, 223, 138, 0.85)":"rgba(255,255,255,0.85)",y.beginPath(),y.rect(-Te,-Te,ne,ne),y.fill(),y.stroke();const ye=je.designator?.trim()||"";if(ye){y.fillStyle=je.color||"#111";const be=Math.max(6,ne*.35),me=ne*.9;let Me=be;y.font=`bold ${Me}px sans-serif`;const De=y.measureText(ye);De.width>me&&(Me=me/De.width*Me,Me=Math.max(6,Me),y.font=`bold ${Me}px sans-serif`),y.textAlign="center",y.textBaseline="middle",y.fillText(ye,0,0)}$n.has(je.id)&&(y.setLineDash([4,3]),y.strokeStyle="#00bfff",y.lineWidth=1.5,y.strokeRect(-Te-3,-Te-3,ne+6,ne+6),y.setLineDash([])),y.restore()};if(pi){const je=Te=>{const ve=parseInt(Te,10);if(isNaN(ve))return null;for(const Ce of Qe)if((Ce.type==="via"||Ce.type==="pad"||Ce.type==="testPoint")&&Ce.points.length>0){const ye=Ce.points[0];if(ye.id===ve)return{x:ye.x,y:ye.y}}for(const Ce of Qe)if(Ce.type==="trace"){for(const ye of Ce.points)if(ye.id===ve)return{x:ye.x,y:ye.y}}for(const Ce of J)if(Ce.pointId===ve)return{x:Ce.x,y:Ce.y};for(const Ce of te)if(Ce.pointId===ve)return{x:Ce.x,y:Ce.y};return null},ne=Te=>{const ve=Te.pinConnections||[],Ce=Xf(Te)&&Te.pinPolarities,we=Cl(Te)?.category==="Semiconductors",be=new Map;for(let me=0;me<ve.length;me++){const Me=ve[me];if(Me&&Me.trim()!==""){const De=Me.trim(),He=we&&me===0,xt=!!(Ce&&Te.pinPolarities&&me<Te.pinPolarities.length&&Te.pinPolarities[me]==="-"),pt=be.get(De);pt!==void 0?be.set(De,{isNegative:pt.isNegative||xt,hasPin1:pt.hasPin1||He}):be.set(De,{isNegative:xt,hasPin1:He})}}for(const[me,Me]of be){const{isNegative:De,hasPin1:He}=Me,xt=je(me);if(xt){const pt={x:Te.x,y:Te.y},Nt=parseInt(me,10),st=`${Te.id}:${Nt}`,qt=ti.has(st);y.save(),qt?(y.strokeStyle="#00bfff",y.lineWidth=Math.max(2,ct*1.5/Math.max(yt,.001)),y.setLineDash([4,3])):(De?y.strokeStyle="rgba(0, 0, 0, 0.8)":He?y.strokeStyle=g2(Ne,.4):y.strokeStyle=Ne,y.lineWidth=Math.max(1,ct/Math.max(yt,.001))),y.beginPath(),y.moveTo(pt.x,pt.y),y.lineTo(xt.x,xt.y),y.stroke(),y.setLineDash([]),y.restore()}}};x&&tn.forEach(ne),P&&cn.forEach(ne)}if(x&&tn.forEach(B),P&&cn.forEach(B),ws&&Il){y.save();const je=Il.start,ne=Il.end,Te=Math.min(je.x,ne.x),ve=Math.min(je.y,ne.y),Ce=Math.max(je.x,ne.x),ye=Math.max(je.y,ne.y),we=Ce-Te,be=ye-ve,me=Math.max(2,6/Math.max(1e-4,yt));y.strokeStyle="#ff8800",y.fillStyle="rgba(255, 136, 0, 0.2)",y.lineWidth=Math.max(1,2/Math.max(1e-4,yt)),y.setLineDash([me,me]),y.beginPath(),y.rect(Te,ve,we,be),y.fill(),y.stroke(),y.fillStyle="#ff8800",y.beginPath(),y.arc(je.x,je.y,Math.max(3,6/Math.max(1e-4,yt)),0,Math.PI*2),y.fill(),y.setLineDash([]),y.restore()}if(I==="select"&&cc){y.save();const je=Math.max(2,6/Math.max(1e-4,yt));y.strokeStyle="#00bfff",y.fillStyle="rgba(0, 191, 255, 0.15)",y.lineWidth=Math.max(1,1.5/Math.max(1e-4,yt)),y.setLineDash([je,je]),y.beginPath(),y.rect(cc.x,cc.y,cc.width,cc.height),y.fill(),y.stroke(),y.setLineDash([]),y.restore()}y.save();const le=50,A=2/yt;y.strokeStyle="#FF0000",y.lineWidth=A,y.lineCap="round",y.lineJoin="round",y.beginPath(),y.moveTo(-le,0),y.lineTo(le,0),y.stroke(),y.fillStyle="#FF0000",y.font=`${12/yt}px sans-serif`,y.textAlign="left",y.textBaseline="top",y.fillText("+X",le+2/yt,2/yt),y.textAlign="right",y.fillText("-X",-le-2/yt,2/yt),y.strokeStyle="#0000FF",y.lineWidth=A,y.lineCap="round",y.lineJoin="round",y.beginPath(),y.moveTo(0,-le),y.lineTo(0,le),y.stroke(),y.fillStyle="#0000FF",y.font=`${12/yt}px sans-serif`,y.textAlign="left",y.textBaseline="top",y.fillText("+Y",2/yt,le+2/yt),y.textBaseline="bottom",y.fillText("-Y",2/yt,-le-2/yt),y.restore(),y.restore()},[g,S,K,Qe,Kt,un,I,F,U,H,jn,Lt,yt,zi.x,zi.y,On,Ei,eo,Sa,sa,Gi,to,Lo,Ii,uo,Mo,x,P,tn,cn,Z,J,ai,te,pi,cc,ii,$n,mi,Yn,ti,Jn,_e,xe,ke,C,rt,hn,Cr,Ne,ct,yr,ya,ws,Il]);Pt.useEffect(()=>{const l=()=>{const y=jc.current;if(!y)return;const N=1.6,B=244,le=12,ge=6,A=12,je=y.clientWidth-B-le,ne=y.getBoundingClientRect(),Te=window.innerHeight,ve=ne.top,ye=Te-ve-ge-10,we=Math.min(y.clientHeight-A,ye),be=Math.floor(we*N),me=Math.floor(je/N);let Me,De;be<=je?(Me=be,De=we):(Me=je,De=me),Me=Math.max(600,Me),De=Math.max(375,De),De=Math.max(355,De-20),Ll(He=>{const xt=He.width===0&&He.height===0,pt=He.width!==Me||He.height!==De;return xt&&pt&&setTimeout(()=>{Rr({x:0,y:0})},0),He.width===Me&&He.height===De?He:{width:Me,height:De}})};return l(),window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[na,Rr]),Pt.useEffect(()=>{Cr&&(Et&&(Bt(!1),on(null)),ci(null))},[Cr,Et,Bt,on,ci]);const wf=L.useCallback(l=>{if(Qe.forEach(y=>{if(y.type==="via"||y.type==="pad"||y.type==="testPoint"||y.testPointType!==void 0||y.type!=="trace")return;let N=!1;if(y.layer==="top"?N=Gi:y.layer==="bottom"&&(N=to),!!N){if(y.points.length===1){const B=y.points[0],le=Math.max(.5,y.size/2);ii.has(y.id)&&(l.strokeStyle="#00bfff",l.lineWidth=2,l.setLineDash([4,3]),l.beginPath(),l.arc(B.x,B.y,le+3,0,Eo),l.stroke(),l.setLineDash([])),l.fillStyle=y.color,l.beginPath(),l.arc(B.x,B.y,le,0,Eo),l.fill()}else if(ii.has(y.id)&&(l.strokeStyle="#00bfff",l.lineWidth=y.size+4,l.lineCap="round",l.lineJoin="round",l.globalAlpha=.6,l.beginPath(),y.points.forEach((B,le)=>{le===0?l.moveTo(B.x,B.y):l.lineTo(B.x,B.y)}),l.stroke(),l.globalAlpha=1),l.strokeStyle=y.color,l.lineWidth=y.size,l.lineCap="round",l.lineJoin="round",l.globalAlpha=1,l.beginPath(),y.points.forEach((B,le)=>{le===0?l.moveTo(B.x,B.y):l.lineTo(B.x,B.y)}),l.stroke(),yr){l.fillStyle="#000000";for(const B of y.points)l.beginPath(),l.arc(B.x,B.y,y.size/2,0,Eo),l.fill()}}}),Qe.forEach(y=>{if(y.type==="via"){if(!sa)return}else if(y.type==="pad"){const B=y.layer||"top";if(B==="top"&&!Lo||B==="bottom"&&!Ii)return}else if(y.type==="testPoint"){const B=y.layer||"top";if(B==="top"&&!uo||B==="bottom"&&!Mo)return}else return;const N=y.points[0];if(ii.has(y.id)){if(y.type==="via"){const B=Math.max(.5,y.size/2)+3;l.strokeStyle="#00bfff",l.lineWidth=2,l.setLineDash([4,3]),l.beginPath(),l.arc(N.x,N.y,B,0,Eo),l.stroke(),l.setLineDash([])}else if(y.type==="pad"){const B=Math.max(.5,y.size/2)+3;l.strokeStyle="#00bfff",l.lineWidth=2,l.setLineDash([4,3]),l.strokeRect(N.x-B,N.y-B,y.size+6,y.size+6),l.setLineDash([])}else if(y.type==="testPoint"){const B=Math.max(.5,y.size/2)+3;l.strokeStyle="#00bfff",l.lineWidth=2,l.setLineDash([4,3]),l.beginPath(),l.moveTo(N.x,N.y-B),l.lineTo(N.x+B,N.y),l.lineTo(N.x,N.y+B),l.lineTo(N.x-B,N.y),l.closePath(),l.stroke(),l.setLineDash([])}}if(y.type==="via"){const B=Math.max(.5,y.size/2),le=B*.5,ge=B*.7;l.fillStyle=y.color,l.beginPath(),l.arc(N.x,N.y,B,0,Eo),l.arc(N.x,N.y,le,0,Eo),l.fill("evenodd"),l.strokeStyle="#808080",l.lineWidth=1,l.beginPath(),l.moveTo(N.x-ge,N.y),l.lineTo(N.x+ge,N.y),l.stroke(),l.beginPath(),l.moveTo(N.x,N.y-ge),l.lineTo(N.x,N.y+ge),l.stroke()}else if(y.type==="pad"){const B=Math.max(.5,y.size/2),le=y.size,ge=le*.5,A=B*.7;l.fillStyle=y.color,l.beginPath(),l.rect(N.x-B,N.y-B,le,le),l.rect(N.x-ge/2,N.y-ge/2,ge,ge),l.fill("evenodd"),l.strokeStyle="#808080",l.lineWidth=1,l.beginPath(),l.moveTo(N.x-A,N.y),l.lineTo(N.x+A,N.y),l.stroke(),l.beginPath(),l.moveTo(N.x,N.y-A),l.lineTo(N.x,N.y+A),l.stroke()}else if(y.type==="testPoint"){const B=Math.max(.5,y.size/2),le=B*.7;l.fillStyle=y.color||"#FFFF00",l.strokeStyle="#000000",l.lineWidth=2,l.beginPath(),l.moveTo(N.x,N.y-B),l.lineTo(N.x+B,N.y),l.lineTo(N.x,N.y+B),l.lineTo(N.x-B,N.y),l.closePath(),l.fill(),l.stroke(),l.strokeStyle="#808080",l.lineWidth=1,l.beginPath(),l.moveTo(N.x-le,N.y),l.lineTo(N.x+le,N.y),l.stroke(),l.beginPath(),l.moveTo(N.x,N.y-le),l.lineTo(N.x,N.y+le),l.stroke()}}),Kt.length>0){const y=Lt;let N=!0;if(I==="draw"&&(rt==="via"?N=sa:N=y==="top"?Gi:to),N)if(I==="draw")if(rt==="via"){const B=Kt[Kt.length-1],le=Math.max(.5,U/2),ge=le*.5,A=le*.7;l.fillStyle=F,l.beginPath(),l.arc(B.x,B.y,le,0,Eo),l.arc(B.x,B.y,ge,0,Eo),l.fill("evenodd"),l.strokeStyle="#808080",l.lineWidth=1,l.beginPath(),l.moveTo(B.x-A,B.y),l.lineTo(B.x+A,B.y),l.stroke(),l.beginPath(),l.moveTo(B.x,B.y-A),l.lineTo(B.x,B.y+A),l.stroke()}else if(rt==="pad"){const B=Kt[Kt.length-1],le=Math.max(.5,U/2),ge=U,A=ge*.5,je=le*.7;l.fillStyle=F,l.beginPath(),l.rect(B.x-le,B.y-le,ge,ge),l.rect(B.x-A/2,B.y-A/2,A,A),l.fill("evenodd"),l.strokeStyle="#808080",l.lineWidth=1,l.beginPath(),l.moveTo(B.x-je,B.y),l.lineTo(B.x+je,B.y),l.stroke(),l.beginPath(),l.moveTo(B.x,B.y-je),l.lineTo(B.x,B.y+je),l.stroke()}else if(rt==="testPoint"){const B=Kt[Kt.length-1],le=Math.max(.5,U/2),ge=le*.7;l.fillStyle=F,l.beginPath(),l.moveTo(B.x,B.y-le),l.lineTo(B.x+le,B.y),l.lineTo(B.x,B.y+le),l.lineTo(B.x-le,B.y),l.closePath(),l.fill(),l.strokeStyle="#808080",l.lineWidth=1,l.beginPath(),l.moveTo(B.x-ge,B.y),l.lineTo(B.x+ge,B.y),l.stroke(),l.beginPath(),l.moveTo(B.x,B.y-ge),l.lineTo(B.x,B.y+ge),l.stroke()}else{const B=Jn||"top",le=B==="top"?_e:xe,ge=B==="top"?ke:C;if(Kt.length===1){const A=Kt[0],je=Math.max(.5,ge/2);l.fillStyle=le,l.beginPath(),l.arc(A.x,A.y,je,0,Eo),l.fill(),hn&&(l.strokeStyle=le,l.lineWidth=ge,l.lineCap="round",l.lineJoin="round",l.globalAlpha=.6,l.beginPath(),l.moveTo(A.x,A.y),l.lineTo(hn.x,hn.y),l.stroke(),l.globalAlpha=1)}else if(l.strokeStyle=le,l.lineWidth=ge,l.lineCap="round",l.lineJoin="round",l.globalAlpha=1,l.beginPath(),Kt.forEach((A,je)=>{je===0?l.moveTo(A.x,A.y):l.lineTo(A.x,A.y)}),l.stroke(),hn&&Kt.length>0){const A=Kt[Kt.length-1];l.globalAlpha=.6,l.beginPath(),l.moveTo(A.x,A.y),l.lineTo(hn.x,hn.y),l.stroke(),l.globalAlpha=1}}else I==="erase"&&(l.strokeStyle="rgba(255, 0, 0, 0.5)",l.lineWidth=U,l.lineCap="round",l.lineJoin="round",l.globalAlpha=.5,l.beginPath(),Kt.forEach((B,le)=>{le===0?l.moveTo(B.x,B.y):l.lineTo(B.x,B.y)}),l.stroke())}},[Qe,ii,Gi,to,sa,Lo,Ii,uo,Mo,Kt,I,rt,F,U,Lt,Jn,_e,xe,ke,C,hn,yr]),Ju=L.useCallback((l,y)=>{if(Cr){alert("Cannot transform: Images are locked. Unlock images to transform them.");return}l==="top"&&g?m(N=>N?{...N,...y}:null):l==="bottom"&&S?_(N=>N?{...N,...y}:null):l==="both"&&(g&&m(N=>N?{...N,...y}:null),S&&_(N=>N?{...N,...y}:null))},[g,S,Cr]),Pd=L.useCallback(()=>{jn&&(Ju(jn,{x:0,y:0,scale:1,rotation:0,flipX:!1,flipY:!1,skewX:0,skewY:0,keystoneV:0,keystoneH:0,brightness:100,contrast:100}),ae(!1))},[Ju,jn]),_d=L.useCallback((l=1)=>{if(ii.size>0||$n.size>0||mi.size>0||Yn.size>0){if(ii.size>0){const y=Qe.filter(ge=>ii.has(ge.id)),N=da&&y.some(ge=>ge.type==="via"),B=Vi&&y.some(ge=>ge.type==="trace"),le=Xr&&y.some(ge=>ge.type==="pad");if(N){alert("Cannot change size: Vias are locked. Unlock vias to change their size.");return}if(B){alert("Cannot change size: Traces are locked. Unlock traces to change their size.");return}if(le){alert("Cannot change size: Pads are locked. Unlock pads to change their size.");return}}if($n.size>0&&Kr){alert("Cannot change size: Components are locked. Unlock components to change their size.");return}if(mi.size>0&&Qi){alert("Cannot change size: Power nodes are locked. Unlock power nodes to change their size.");return}if(Yn.size>0&&Vr){alert("Cannot change size: Ground nodes are locked. Unlock ground nodes to change their size.");return}if(At(y=>y.map(N=>{if(ii.has(N.id)){const B=N.size+l;return N.type==="via"?Ze("via",B):N.type==="pad"?Ze("pad",B):N.type==="trace"&&Ze("trace",B,N.layer),{...N,size:B}}return N})),$n.size>0){const y=($n.size>0&&tn.find(N=>$n.has(N.id))?.size||18)+l;Ze("component",y),Li(N=>N.map(B=>$n.has(B.id)?{...B,size:(B.size||18)+l}:B)),Si(N=>N.map(B=>$n.has(B.id)?{...B,size:(B.size||18)+l}:B))}if(mi.size>0){const y=(J.find(N=>mi.has(N.id))?.size||18)+l;Ze("power",y),fn(N=>N.map(B=>mi.has(B.id)?{...B,size:B.size+l}:B))}if(Yn.size>0){const y=(te.find(N=>Yn.has(N.id))?.size||18)+l;Ze("ground",y),Fn(N=>N.map(B=>Yn.has(B.id)?{...B,size:(B.size||18)+l}:B))}}else{let y=null;if(I==="draw"&&rt==="via"?y="via":I==="draw"&&rt==="pad"?y=Ha.current==="bottom"?"padBottom":"padTop":I==="draw"&&rt==="testPoint"?y=Ti.current==="bottom"?"testPointBottom":"testPointTop":I==="draw"&&rt==="trace"?y=vo.current==="bottom"?"traceBottom":"traceTop":I==="component"?y=Oo.current==="bottom"?"componentBottom":"componentTop":I==="power"?y="power":I==="ground"&&(y="ground"),y){const N=Hn.get(y),B=Math.min(40,N.size+l);Hn.setSize(y,B)}}},[ii,$n,mi,Yn,Qe,da,Vi,Xr,ko,Kr,Qi,Vr,I,rt,Ze]),Qu=L.useCallback((l=1)=>{if(ii.size>0||$n.size>0||mi.size>0||Yn.size>0){if(ii.size>0){const y=Qe.filter(A=>ii.has(A.id)),N=da&&y.some(A=>A.type==="via"),B=Vi&&y.some(A=>A.type==="trace"),le=Xr&&y.some(A=>A.type==="pad"),ge=ko&&y.some(A=>A.type==="testPoint");if(N){alert("Cannot change size: Vias are locked. Unlock vias to change their size.");return}if(B){alert("Cannot change size: Traces are locked. Unlock traces to change their size.");return}if(le){alert("Cannot change size: Pads are locked. Unlock pads to change their size.");return}if(ge){alert("Cannot change size: Test Points are locked. Unlock test points to change their size.");return}}if($n.size>0&&Kr){alert("Cannot change size: Components are locked. Unlock components to change their size.");return}if(mi.size>0&&Qi){alert("Cannot change size: Power nodes are locked. Unlock power nodes to change their size.");return}if(Yn.size>0&&Vr){alert("Cannot change size: Ground nodes are locked. Unlock ground nodes to change their size.");return}if(At(y=>y.map(N=>{if(ii.has(N.id)){const B=Math.max(1,N.size-l);return N.type==="via"?Ze("via",B):N.type==="pad"?Ze("pad",B,N.layer):N.type==="testPoint"?Ze("testPoint",B,N.layer):N.type==="trace"&&Ze("trace",B,N.layer),{...N,size:B}}return N})),$n.size>0){const y=Math.max(12,($n.size>0&&tn.find(N=>$n.has(N.id))?.size||18)-l);Ze("component",y),Li(N=>N.map(B=>$n.has(B.id)?{...B,size:Math.max(12,(B.size||18)-l)}:B)),Si(N=>N.map(B=>$n.has(B.id)?{...B,size:Math.max(12,(B.size||18)-l)}:B))}if(mi.size>0){const y=Math.max(12,(J.find(N=>mi.has(N.id))?.size||18)-l);Ze("power",y),fn(N=>N.map(B=>mi.has(B.id)?{...B,size:Math.max(12,B.size-l)}:B))}if(Yn.size>0){const y=Math.max(12,(te.find(N=>Yn.has(N.id))?.size||18)-l);Ze("ground",y),Fn(N=>N.map(B=>Yn.has(B.id)?{...B,size:Math.max(12,(B.size||18)-l)}:B))}}else{let y=null;if(I==="draw"&&rt==="via"?y="via":I==="draw"&&rt==="pad"?y=(Lt||di||"top")==="bottom"?"padBottom":"padTop":I==="draw"&&rt==="testPoint"?y=(Lt||Di||"top")==="bottom"?"testPointBottom":"testPointTop":I==="draw"&&rt==="trace"?y=(Lt||Jn||"top")==="bottom"?"traceBottom":"traceTop":I==="component"?y=(Lt||ir||"top")==="bottom"?"componentBottom":"componentTop":I==="power"?y="power":I==="ground"&&(y="ground"),y){const N=Hn.get(y),B=Math.max(1,N.size-l);Hn.setSize(y,B)}}},[ii,$n,mi,Yn,Qe,da,Vi,Xr,ko,Kr,Qi,Vr,I,rt,Lt,di,Di,Jn,ir,Ze]),Rd=L.useCallback(()=>{const l=xs.size;if(ii.size>0||$n.size>0||mi.size>0||Yn.size>0){if(ii.size>0){const y=Qe.filter(A=>ii.has(A.id)),N=da&&y.some(A=>A.type==="via"),B=Xr&&y.some(A=>A.type==="pad"),le=Vi&&y.some(A=>A.type==="trace"),ge=ko&&y.some(A=>A.type==="testPoint");if(N||B||le||ge){alert("Cannot change size: selected items are locked.");return}}if($n.size>0&&Kr){alert("Cannot change size: selected components are locked.");return}if(mi.size>0&&Qi){alert("Cannot change size: selected power nodes are locked.");return}if(Yn.size>0&&Vr){alert("Cannot change size: selected ground nodes are locked.");return}At(y=>y.map(N=>ii.has(N.id)?(N.type==="via"?(Ze("via",l),wi(B=>{const le=new Map(B),ge=le.get("via");return ge&&le.set("via",{...ge,settings:{...ge.settings,size:l}}),le})):N.type==="pad"?(Ze("pad",l,N.layer),wi(B=>{const le=new Map(B),ge=le.get("pad");if(ge){const A=new Map(ge.layerSettings);A.set(N.layer,{...A.get(N.layer)||{color:ge.settings.color,size:l},size:l}),le.set("pad",{...ge,layerSettings:A})}return le})):N.type==="testPoint"?(Ze("testPoint",l,N.layer),wi(B=>{const le=new Map(B),ge=le.get("testPoint");if(ge){const A=new Map(ge.layerSettings);A.set(N.layer,{...A.get(N.layer)||{color:ge.settings.color,size:l},size:l}),le.set("testPoint",{...ge,layerSettings:A})}return le})):N.type==="trace"&&Ze("trace",l,N.layer),{...N,size:l}):N)),$n.size>0&&(Ze("component",l),Li(y=>y.map(N=>$n.has(N.id)?{...N,size:l}:N)),Si(y=>y.map(N=>$n.has(N.id)?{...N,size:l}:N))),mi.size>0&&(Ze("power",l),fn(y=>y.map(N=>mi.has(N.id)?{...N,size:l}:N))),Yn.size>0&&(Ze("ground",l),Fn(y=>y.map(N=>Yn.has(N.id)?{...N,size:l}:N)))}else O(l),I==="draw"&&rt==="trace"?Lt==="top"?(de(l),Ze("trace",l,"top")):(z(l),Ze("trace",l,"bottom")):I==="draw"&&rt==="via"?Ze("via",l):I==="draw"&&rt==="pad"?Ze("pad",l,Lt):I==="draw"&&rt==="testPoint"?Ze("testPoint",l,Lt):Ze(I==="component"?"component":I==="power"?"power":I==="ground"?"ground":"brush",l);Al({visible:!1,size:6})},[xs.size,ii,$n,mi,Yn,Qe,da,Vi,Kr,Qi,Vr,I,rt,Lt,Ze,vn,wi]),Sf=L.useCallback(()=>{kr({visible:!1,source:null,interval:5})},[]),jf=L.useCallback(async(l,y=!1)=>{if(l===null){Ho(!1),ra(null),bi.current&&(clearInterval(bi.current),bi.current=null),Ao({visible:!1,interval:5}),y&&kr({visible:!1,source:null,interval:5}),console.log("Auto save: Disabled");return}if(!oa){alert("Please create a new project (File -> New Project) or open an existing project (File -> Open Project) first.");return}let N=Pi;if(!N){const A=window;if(typeof A.showDirectoryPicker=="function")try{N=await A.showDirectoryPicker(),va(N)}catch(je){je?.name!=="AbortError"&&(console.error("Failed to get directory:",je),alert("Failed to select project directory."));return}else{alert("Directory picker is not supported in this browser. Auto-save requires a directory handle.");return}}pa(N);const B=oa.replace(/\.json$/i,""),ge=ad(B).replace(/[^a-zA-Z0-9_-]/g,"_");Ro(ge),no.current=N,wl.current=ge,ra(l),Ho(!0),Ra.current=!0,Ao({visible:!1,interval:5}),y&&kr({visible:!1,source:null,interval:5}),setTimeout(()=>{console.log(`Auto save: Enabled with interval ${l} minutes`),Sc.current&&Sc.current()},200)},[oa,Pi,Ho,ra,pa,Ro,Ao,kr,va]),nu=L.useCallback(()=>{Cn(),oe("select")},[Cn]),Dd=L.useCallback(l=>{if(l.key==="Escape"){const A=document.activeElement;if(A&&(A.tagName==="INPUT"&&A.type==="checkbox"||A.tagName==="INPUT"&&A.type==="radio")){A.blur(),l.preventDefault(),l.stopPropagation();return}}const y=document.activeElement;if(y&&(y.tagName==="INPUT"&&y.type!=="checkbox"&&y.type!=="radio"||y.tagName==="TEXTAREA"||y.isContentEditable))return;const N=Rc.current>0;if(N&&l.key!=="m"&&l.key!=="M")return;const B=parseInt(l.key);if(!isNaN(B)&&B>=0&&B<=9){if(l.preventDefault(),l.stopPropagation(),I==="center"&&Yo){if(Ma.current&&(clearTimeout(Ma.current),Ma.current=null),Lr.current){let ne=0,Te=0;g?(ne=g.x,Te=g.y):S&&(ne=S.x,Te=S.y),La(ve=>({...ve,[B]:{pcbReferenceX:ne,pcbReferenceY:Te,x:0,y:0,zoom:yt,viewRotation:On,viewFlipX:Ei,isBottomView:ki,transparency:K,showTopImage:eo,showBottomImage:Sa,showViasLayer:sa,showTopTracesLayer:Gi,showBottomTracesLayer:to,showTopPadsLayer:Lo,showBottomPadsLayer:Ii,showTopTestPointsLayer:uo,showBottomTestPointsLayer:Mo,showTopComponents:x,showBottomComponents:P,showPowerLayer:Z,showGroundLayer:ai,showConnectionsLayer:pi}}))}Us(!1),oe("select"),So(void 0);return}const A=Da[B];if(A){si(A.zoom),Ri(A.viewRotation??0),bo(A.viewFlipX??!1),ri(A.isBottomView??!1),D(A.transparency??50);const je=A.pcbReferenceX??A.x??0,ne=A.pcbReferenceY??A.y??0;let Te=0,ve=0;g?(Te=g.x,ve=g.y):S&&(Te=S.x,ve=S.y);const Ce=je-Te,ye=ne-ve;(Math.abs(Ce)>.001||Math.abs(ye)>.001)&&(g&&m({...g,x:g.x+Ce,y:g.y+ye}),S&&_({...S,x:S.x+Ce,y:S.y+ye}),Li(tn.map(we=>({...we,x:we.x+Ce,y:we.y+ye}))),Si(cn.map(we=>({...we,x:we.x+Ce,y:we.y+ye}))),fn(Gt.map(we=>({...we,x:we.x+Ce,y:we.y+ye}))),Fn(wn.map(we=>({...we,x:we.x+Ce,y:we.y+ye}))),At(Qe.map(we=>({...we,points:we.points.map(be=>({...be,x:be.x+Ce,y:be.y+ye}))}))),ba(rr.map(we=>({...we,x:we.x+Ce,y:we.y+ye}))),To(jo.map(we=>({...we,x:we.x+Ce,y:we.y+ye})))),Rr({x:0,y:0}),Zr(A.showTopImage),ha(A.showBottomImage),Ea(A.showViasLayer),Go(A.showTopTracesLayer),qs(A.showBottomTracesLayer),Vs(A.showTopPadsLayer),co(A.showBottomPadsLayer),ls(A.showTopTestPointsLayer),f(A.showBottomTestPointsLayer),k(A.showTopComponents),q(A.showBottomComponents),Q(A.showPowerLayer),_i(A.showGroundLayer),xr(A.showConnectionsLayer)}return}if(l.key==="+"||l.key==="="){l.preventDefault(),l.stopPropagation(),_d(l.shiftKey?5:1);return}if(l.key==="-"||l.key==="_"){l.preventDefault(),l.stopPropagation(),Qu(l.shiftKey?5:1);return}const le=l.shiftKey||l.getModifierState("CapsLock"),ge=I==="transform"&&jn;if(l.key==="ArrowUp"||l.key==="ArrowDown"||l.key==="ArrowLeft"||l.key==="ArrowRight"){if($n.size>0){l.preventDefault(),l.stopPropagation();const A=l.shiftKey?10:1;let je=0,ne=0;l.key==="ArrowUp"?ne=-A:l.key==="ArrowDown"?ne=A:l.key==="ArrowLeft"?je=-A:l.key==="ArrowRight"&&(je=A);for(const Te of $n){const ve=tn.find(Ce=>Ce.id===Te);if(ve){const Ce=ve.x+je,ye=ve.y+ne,we=or({x:Ce,y:ye});Li(be=>be.map(me=>me.id===Te?{...me,x:we.x,y:we.y}:me))}else{const Ce=cn.find(ye=>ye.id===Te);if(Ce){const ye=Ce.x+je,we=Ce.y+ne,be=or({x:ye,y:we});Si(me=>me.map(Me=>Me.id===Te?{...Me,x:be.x,y:be.y}:Me))}}}return}if(le&&!ge&&$n.size===0){if(l.key==="ArrowUp"||l.key==="ArrowDown"){l.preventDefault(),l.stopPropagation();const A=l.key==="ArrowUp"?-90:90;Jf(A);return}else if(l.key==="ArrowLeft"||l.key==="ArrowRight"){l.preventDefault(),l.stopPropagation(),wd();return}}}if((l.key==="I"||l.key==="i")&&!l.ctrlKey&&!l.shiftKey&&!l.altKey){const A=document.activeElement;if(!!A&&(A.tagName==="INPUT"&&A.type!=="range"&&A.type!=="checkbox"&&A.type!=="radio"||A.tagName==="TEXTAREA"||A.isContentEditable))return;l.preventDefault(),l.stopPropagation();const ne=[];ii.size>0,ii.size===0&&$n.size===0&&mi.size===0&&Yn.size===0&&ne.push(`
No objects selected.`);const Te=ne.join(`
`);console.log(Te),so({visible:!0,text:Te});return}if((l.key==="N"||l.key==="n")&&!l.ctrlKey&&!l.shiftKey&&!l.altKey){const A=document.activeElement;if(!!A&&(A.tagName==="INPUT"&&A.type!=="range"&&A.type!=="checkbox"&&A.type!=="radio"||A.tagName==="TEXTAREA"||A.isContentEditable))return;l.preventDefault(),l.stopPropagation(),sr(!0);return}if((l.key==="L"||l.key==="l")&&!l.ctrlKey&&!l.shiftKey&&!l.altKey){const A=document.activeElement;if(!!A&&(A.tagName==="INPUT"&&A.type!=="range"&&A.type!=="checkbox"&&A.type!=="radio"||A.tagName==="TEXTAREA"||A.isContentEditable))return;l.preventDefault(),l.stopPropagation(),ru();return}if((l.key==="E"||l.key==="e")&&!l.ctrlKey&&!l.shiftKey&&!l.altKey){const A=document.activeElement;if(!!A&&(A.tagName==="INPUT"&&A.type!=="range"&&A.type!=="checkbox"&&A.type!=="radio"||A.tagName==="TEXTAREA"||A.isContentEditable))return;l.preventDefault(),l.stopPropagation(),rn||_o(!0);return}if(l.key==="O"||l.key==="o"){const A=document.activeElement;if(!!A&&(A.tagName==="INPUT"&&A.type!=="range"&&A.type!=="checkbox"&&A.type!=="radio"||A.tagName==="TEXTAREA"||A.isContentEditable))return;l.preventDefault(),l.stopPropagation();const ne=Da[0];if(ne){si(ne.zoom),Ri(ne.viewRotation??0),bo(ne.viewFlipX??!1),ri(ne.isBottomView??!1),D(ne.transparency??50);const Te=ne.pcbReferenceX??ne.x??0,ve=ne.pcbReferenceY??ne.y??0;let Ce=0,ye=0;g?(Ce=g.x,ye=g.y):S&&(Ce=S.x,ye=S.y);const we=Te-Ce,be=ve-ye;(Math.abs(we)>.001||Math.abs(be)>.001)&&(g&&m({...g,x:g.x+we,y:g.y+be}),S&&_({...S,x:S.x+we,y:S.y+be}),Li(tn.map(me=>({...me,x:me.x+we,y:me.y+be}))),Si(cn.map(me=>({...me,x:me.x+we,y:me.y+be}))),fn(Gt.map(me=>({...me,x:me.x+we,y:me.y+be}))),Fn(wn.map(me=>({...me,x:me.x+we,y:me.y+be}))),At(Qe.map(me=>({...me,points:me.points.map(Me=>({...Me,x:Me.x+we,y:Me.y+be}))}))),ba(rr.map(me=>({...me,x:me.x+we,y:me.y+be}))),To(jo.map(me=>({...me,x:me.x+we,y:me.y+be})))),Zr(ne.showTopImage),ha(ne.showBottomImage),Ea(ne.showViasLayer),Go(ne.showTopTracesLayer),qs(ne.showBottomTracesLayer),Vs(ne.showTopPadsLayer),co(ne.showBottomPadsLayer),ls(ne.showTopTestPointsLayer),f(ne.showBottomTestPointsLayer),k(ne.showTopComponents),q(ne.showBottomComponents),Q(ne.showPowerLayer),_i(ne.showGroundLayer),xr(ne.showConnectionsLayer)}else si(1),Ri(0),bo(!1),ri(!1),D(0);Rr({x:0,y:0}),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),T("overlay"),mn(new Set),bn(new Set),_n(new Set),Tn(new Set),oe("select");return}if((l.key==="Alt"||l.altKey)&&(go(!0),Ia(!0)),l.key==="Escape"){l.preventDefault(),l.stopPropagation(),nu(),Jc(!1),Su(!1),Yu(!1),vt(!1),Vo(!1),cp(null);return}if(l.key==="Enter"&&I==="draw"&&rt==="trace"){tu();return}if((l.key==="Delete"||l.key==="Backspace")&&(ii.size>0||$n.size>0||mi.size>0||Yn.size>0)){if(l.preventDefault(),l.stopPropagation(),Ji(Qe,tn,cn,Gt,wn),ii.size>0){const A=Qe.filter(Ce=>ii.has(Ce.id)),je=da&&A.some(Ce=>Ce.type==="via"),ne=Vi&&A.some(Ce=>Ce.type==="trace"),Te=Xr&&A.some(Ce=>Ce.type==="pad"),ve=ko&&A.some(Ce=>Ce.type==="testPoint");je?alert("Cannot delete: Vias are locked. Unlock vias to delete them."):ne?alert("Cannot delete: Traces are locked. Unlock traces to delete them."):Te?alert("Cannot delete: Pads are locked. Unlock pads to delete them."):ve?alert("Cannot delete: Test points are locked. Unlock test points to delete them."):(At(Ce=>Ce.filter(ye=>!ii.has(ye.id))),mn(new Set))}$n.size>0&&(Kr?alert("Cannot delete: Components are locked. Unlock components to delete them."):(Li(A=>A.filter(je=>!$n.has(je.id))),Si(A=>A.filter(je=>!$n.has(je.id))),bn(new Set))),mi.size>0&&(Qi?alert("Cannot delete: Power nodes are locked. Unlock power nodes to delete them."):(fn(A=>A.filter(je=>!mi.has(je.id))),_n(new Set))),Yn.size>0&&(Vr?alert("Cannot delete: Ground nodes are locked. Unlock ground nodes to delete them."):(Fn(A=>A.filter(je=>!Yn.has(je.id))),Tn(new Set)));return}if((l.key==="z"||l.key==="Z")&&(l.ctrlKey||l.metaKey)&&!l.shiftKey&&!l.altKey){const A=document.activeElement;if(!!A&&(A.tagName==="INPUT"&&A.type!=="range"&&A.type!=="checkbox"&&A.type!=="radio"||A.tagName==="TEXTAREA"||A.isContentEditable))return;l.preventDefault(),l.stopPropagation();const ne=ia();if(ne){const Te=new Set(ne.drawingStrokes.map(we=>we.id));for(const we of Qe)if(!Te.has(we.id))for(const be of we.points)be.id&&typeof be.id=="number"&&Hp(be.id);const ve=new Set([...ne.componentsTop.map(we=>we.id),...ne.componentsBottom.map(we=>we.id)]);for(const we of[...tn,...cn])if(!ve.has(we.id)){for(const be of we.pinConnections)if(be&&be.trim()!==""){const me=parseInt(be,10);!isNaN(me)&&me>0&&Hp(me)}}const Ce=new Set(ne.powerSymbols.map(we=>we.id));for(const we of Gt)!Ce.has(we.id)&&we.pointId&&typeof we.pointId=="number"&&Hp(we.pointId);const ye=new Set(ne.groundSymbols.map(we=>we.id));for(const we of wn)!ye.has(we.id)&&we.pointId&&typeof we.pointId=="number"&&Hp(we.pointId);At(ne.drawingStrokes),Li(ne.componentsTop),Si(ne.componentsBottom),fn(ne.powerSymbols),Fn(ne.groundSymbols),Qt([])}return}if((l.key==="c"||l.key==="C")&&(l.ctrlKey||l.metaKey)&&!l.shiftKey&&!l.altKey){const A=document.activeElement;if(!!A&&(A.tagName==="INPUT"&&A.type!=="range"&&A.type!=="checkbox"&&A.type!=="radio"||A.tagName==="TEXTAREA"||A.isContentEditable))return;if($n.size===1){l.preventDefault(),l.stopPropagation();const ne=Array.from($n)[0],Te=[...tn,...cn].find(ve=>ve.id===ne);Te&&(yf(Te),console.log("Component copied:",Te.id,Te.designator))}return}if((l.key==="v"||l.key==="V")&&(l.ctrlKey||l.metaKey)&&!l.shiftKey&&!l.altKey){const A=document.activeElement;if(!!A&&(A.tagName==="INPUT"&&A.type!=="range"&&A.type!=="checkbox"&&A.type!=="radio"||A.tagName==="TEXTAREA"||A.isContentEditable))return;if(Ws&&!Kr){l.preventDefault(),l.stopPropagation();const ne=[...tn,...cn];let Te;Hi?Te=Ff():Te={...Qn.current};let ve;if(Ws.designator){const be=Ws.designator.match(/^([A-Za-z]+)(\d+)$/);be?ve=be[1]:ve=og(Ws.componentType)}else ve=og(Ws.componentType);const Ce=y2(ve,ne,Te),ye=`${ve}${Ce}`;if(Hi){const be=Ff();m1(ve,Ce,be)}else Qn.current[ve]=Math.max(Qn.current[ve]||0,Ce);const we={...Ws,id:$x("comp"),designator:ye,pinConnections:new Array(Ws.pinCount).fill(""),pinPolarities:Ws.pinPolarities?new Array(Ws.pinCount).fill(""):void 0,x:Ws.x+5,y:Ws.y+5};Ws.pinNames&&(we.pinNames=[...Ws.pinNames]),we.layer==="top"?Li(be=>[...be,we]):Si(be=>[...be,we]),Cn(),bn(new Set([we.id])),console.log("Component pasted:",we.id,we.designator)}return}if(l.code==="KeyV"&&l.altKey&&!l.ctrlKey&&!l.shiftKey&&!N){const A=document.activeElement;if(!!A&&(A.tagName==="INPUT"&&A.type!=="range"&&A.type!=="checkbox"&&A.type!=="radio"||A.tagName==="TEXTAREA"||A.isContentEditable))return;l.preventDefault(),l.stopPropagation(),nl(!1),ho(!0);return}if(l.code==="KeyP"&&l.altKey&&!l.ctrlKey&&!l.shiftKey&&!N){const A=document.activeElement;if(!!A&&(A.tagName==="INPUT"&&A.type!=="range"&&A.type!=="checkbox"&&A.type!=="radio"||A.tagName==="TEXTAREA"||A.isContentEditable))return;l.preventDefault(),l.stopPropagation(),nl(!0),ho(!0);return}if((l.key==="a"||l.key==="A")&&!l.ctrlKey&&!l.altKey&&!l.shiftKey&&!N){const A=document.activeElement;if(!!A&&(A.tagName==="INPUT"&&A.type!=="range"&&A.type!=="checkbox"&&A.type!=="radio"||A.tagName==="TEXTAREA"||A.isContentEditable))return;if($n.size>0){l.preventDefault(),l.stopPropagation();const ne=Array.from($n),Te=ne[ne.length-1];let ve=null,Ce=null;ve=tn.find(ye=>ye.id===Te)||null,ve?Ce="top":(ve=cn.find(ye=>ye.id===Te)||null,ve&&(Ce="bottom")),ve&&Ce&&ze(ve,Ce)}return}if(!l.ctrlKey&&!l.altKey){const A=document.activeElement;if(!(!!A&&(A.tagName==="INPUT"&&A.type!=="range"&&A.type!=="checkbox"&&A.type!=="radio"||A.tagName==="TEXTAREA"||A.isContentEditable)))switch(l.key){case"s":case"S":l.preventDefault(),Cn(),nu();return;case"b":case"B":l.preventDefault(),Cn(),Ie.length===1?(nn(Ie[0].id),oe("power"),vt(!1),Q(!0)):Ie.length>1?vt(!0):(vt(!0),oe("power"),Q(!0));return;case"g":case"G":l.preventDefault(),Cn(),gt.length===1?(Bi(gt[0].id),oe("ground"),yn(!1),_i(!0)):gt.length>1?yn(!0):(yn(!0),oe("ground"),_i(!0));return;case"v":case"V":l.preventDefault(),Cn(),ln("via"),oe("draw"),Ea(!0);return;case"p":case"P":l.preventDefault(),Cn(),ln("pad"),oe("draw");return;case"y":case"Y":l.preventDefault(),Cn(),ln("testPoint"),oe("draw");return;case"t":case"T":l.preventDefault(),Cn(),ln("trace"),oe("draw");return;case"c":case"C":l.preventDefault(),Cn(),oe("component"),Td.current?jd(Td.current):jd(null);return;case"e":case"E":l.preventDefault(),Cn(),oe("erase");return;case"h":case"H":l.preventDefault(),Cn(),oe("pan");return;case"x":case"X":l.preventDefault(),Cn(),oe("center"),Us(!0),Ma.current&&clearTimeout(Ma.current),Ma.current=setTimeout(()=>{Us(!1),oe("select"),So(void 0)},2e3);return;case"m":case"M":if(!l.ctrlKey){l.preventDefault(),Cn(),Fs(!1),oe("magnify");return}break}}if(I==="transform"&&jn){if(!(l.key==="ArrowLeft"||l.key==="ArrowRight"||l.key==="ArrowUp"||l.key==="ArrowDown"))return;l.preventDefault(),l.stopPropagation();const je=document.activeElement;if(je&&je.tagName==="INPUT"){const ne=je;ne.type==="radio"&&ne.blur()}if(Cr)return;if(Wn==="nudge"){let ne=0,Te=0;switch(l.key){case"ArrowLeft":ne=-1;break;case"ArrowRight":ne=1;break;case"ArrowUp":Te=-1;break;case"ArrowDown":Te=1;break;default:return}jn==="top"&&g?m(ve=>ve?{...ve,x:ve.x+ne,y:ve.y+Te}:null):jn==="bottom"&&S?_(ve=>ve?{...ve,x:ve.x+ne,y:ve.y+Te}:null):jn==="both"&&(g&&m(ve=>ve?{...ve,x:ve.x+ne,y:ve.y+Te}:null),S&&_(ve=>ve?{...ve,x:ve.x+ne,y:ve.y+Te}:null))}else if(Wn==="scale"){let ne=0;switch(l.key){case"ArrowUp":ne=.01;break;case"ArrowDown":ne=-.01;break;case"ArrowRight":ne=.001;break;case"ArrowLeft":ne=-.001;break;default:return}if(jn==="top"){g&&m(Te=>Te?{...Te,scale:Math.max(.1,Math.min(3,Te.scale+ne))}:null);return}if(jn==="bottom"){S&&_(Te=>Te?{...Te,scale:Math.max(.1,Math.min(3,Te.scale+ne))}:null);return}if(jn==="both"){g&&m(Te=>Te?{...Te,scale:Math.max(.1,Math.min(3,Te.scale+ne))}:null),S&&_(Te=>Te?{...Te,scale:Math.max(.1,Math.min(3,Te.scale+ne))}:null);return}}else if(Wn==="rotate"){let ne=0;switch(l.key){case"ArrowUp":ne=1;break;case"ArrowDown":ne=-1;break;case"ArrowRight":ne=.1;break;case"ArrowLeft":ne=-.1;break;default:return}if(jn==="top"){g&&m(Te=>Te?{...Te,rotation:Te.rotation+ne}:null);return}if(jn==="bottom"){S&&_(Te=>Te?{...Te,rotation:Te.rotation+ne}:null);return}if(jn==="both"){g&&m(Te=>Te?{...Te,rotation:Te.rotation+ne}:null),S&&_(Te=>Te?{...Te,rotation:Te.rotation+ne}:null);return}}else if(Wn==="slant"){let ne=0,Te=0;switch(l.key){case"ArrowUp":Te=-.5;break;case"ArrowDown":Te=.5;break;case"ArrowLeft":ne=-.5;break;case"ArrowRight":ne=.5;break}if(ne!==0||Te!==0){const ve=pu,Ce=ye=>Math.max(-.7,Math.min(.7,ye));if(jn==="top"){g&&m(ye=>ye?{...ye,skewX:Ce((ye.skewX||0)+ve(ne)),skewY:Ce((ye.skewY||0)+ve(Te))}:null);return}if(jn==="bottom"){S&&_(ye=>ye?{...ye,skewX:Ce((ye.skewX||0)+ve(ne)),skewY:Ce((ye.skewY||0)+ve(Te))}:null);return}if(jn==="both"){g&&m(ye=>ye?{...ye,skewX:Ce((ye.skewX||0)+ve(ne)),skewY:Ce((ye.skewY||0)+ve(Te))}:null),S&&_(ye=>ye?{...ye,skewX:Ce((ye.skewX||0)+ve(ne)),skewY:Ce((ye.skewY||0)+ve(Te))}:null);return}}}else if(Wn==="keystone"){let ne=0,Te=0;switch(l.key){case"ArrowUp":Te=-.5;break;case"ArrowDown":Te=.5;break;case"ArrowLeft":ne=-.5;break;case"ArrowRight":ne=.5;break}if(ne!==0||Te!==0){const ve=pu,Ce=ye=>Math.max(-.35,Math.min(.35,ye));if(jn==="top"){g&&m(ye=>ye?{...ye,keystoneH:Ce((ye.keystoneH||0)+ve(ne)),keystoneV:Ce((ye.keystoneV||0)+ve(Te))}:null);return}if(jn==="bottom"){S&&_(ye=>ye?{...ye,keystoneH:Ce((ye.keystoneH||0)+ve(ne)),keystoneV:Ce((ye.keystoneV||0)+ve(Te))}:null);return}if(jn==="both"){g&&m(ye=>ye?{...ye,keystoneH:Ce((ye.keystoneH||0)+ve(ne)),keystoneV:Ce((ye.keystoneV||0)+ve(Te))}:null),S&&_(ye=>ye?{...ye,keystoneH:Ce((ye.keystoneH||0)+ve(ne)),keystoneV:Ce((ye.keystoneV||0)+ve(Te))}:null);return}}}}else{const A=l.target;if(A.tagName==="INPUT"&&A.type==="range"){const je=A,ne=Number(je.value),Te=Number(je.min),ve=Number(je.max),Ce=Number(je.step)||1;switch(l.key){case"ArrowLeft":l.preventDefault();const ye=Math.max(Te,ne-Ce);je.value=ye.toString(),je.dispatchEvent(new Event("input",{bubbles:!0}));break;case"ArrowRight":l.preventDefault();const we=Math.min(ve,ne+Ce);je.value=we.toString(),je.dispatchEvent(new Event("input",{bubbles:!0}));break}}}},[I,jn,Wn,g,S,ii,$n,mi,Yn,Qe,tn,cn,J,te,Ie,rt,tu,Jn,_e,xe,ke,C,nu,Li,Si,ia,At,fn,Fn,Gt,wn,wd,Jf,Da,yt,On,Ei,ki,K,si,Ri,bo,ri,D,m,_,ba,To,Rr,T,mn,bn,_n,Tn,oe,rr,jo,eo,Sa,sa,Gi,to,Lo,Ii,uo,Mo,x,P,Z,ai,pi,Zr,ha,Ea,Go,qs,Vs,co,ls,f,k,q,Q,_i,xr,nl,ho,ze]);Pt.useEffect(()=>{I!=="transform"&&ci(null)},[I]),Pt.useEffect(()=>{window.addEventListener("keydown",Dd,!0);const l=y=>{y.key==="Alt"&&(go(!1),Ia(!1),fi(null))};return window.addEventListener("keyup",l,!0),()=>{window.removeEventListener("keydown",Dd,!0),window.removeEventListener("keyup",l,!0)}},[Dd,mi,Yn,Qi,Qi,J,te,_d,Qu,nu,$n,tn,cn,Li,Si,Da,Yo,I]);const ds=L.useCallback(()=>{Qn.current={},ce("#AA4499"),fe("#F781BF"),de(6),z(6),jt("trace","#AA4499","top"),jt("trace","#F781BF","bottom"),Ze("trace",6,"top"),Ze("trace",6,"bottom"),V("#0072B2"),he("#56B4E9"),Le(18),Ue(18),jt("pad","#0072B2","top"),jt("pad","#56B4E9","bottom"),Ze("pad",18,"top"),Ze("pad",18,"bottom"),Xe("#6A3D9A"),an("#9467BD"),Nn(18),Ee(18),jt("component","#6A3D9A","top"),jt("component","#9467BD","bottom"),Ze("component",18,"top"),Ze("component",18,"bottom"),ma("top"),R("#AA4499"),O(6),bt([{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),dn([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),Ze("power",18),Ze("ground",18),qo(!1),Rs(!1),ns(!1),Ls(!1),fa(!1),Ms(!1),Zn("top"),oe("select"),D(50),w(!1),T("overlay"),x1(),Gr()},[jt,Ze,Gr]),iu=L.useCallback(()=>{va(null),pa(null),Ol&&(Ol.current=null),no&&(no.current=null),aa(""),hr("pcb_project"),Ho(!1),ra(null),Ro(""),Qs([]),Xl(-1),wl&&(wl.current=""),Ra.current=!1,Ga(!1),ri(!1),ms(null),vc(null),bi.current&&(clearInterval(bi.current),bi.current=null),m(null),_(null),Gr(),At([]),ba([]),To([]),qn([]),$l([]),Qt([]),In.current=[],Li([]),Si([]),cl(null),Uo(null),fn([]),Fn([]),fr(null),bt([{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),dn([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),mn(new Set),bn(new Set),_n(new Set),Tn(new Set),ts(!1),bs([]),T("overlay"),si(1),jr(0,0),es(!0),Zn("top"),La({}),Us(!1),Ma.current&&(clearTimeout(Ma.current),Ma.current=null),ci(null),Bt(!1),on(null),qi("nudge"),ae(!1),D(50),w(!1),$(2e3),qo(!1),Rs(!1),Co(!1),Ds(!1),ns(!1),Ls(!1),fa(!1),Ms(!1),Zr(!0),ha(!0),Ea(!0),Go(!0),qs(!0),Vs(!0),co(!0),ls(!0),f(!0),k(!0),q(!0),Q(!0),_i(!0),xr(!0),Oi(!0),oe("select"),ln("trace"),ma("top"),As("top"),zs("top"),Na("top"),vo.current="top",Ha.current="top",Ti.current="top",Oo.current="top",Qn.current={},la(!0),zr(!1),x1(),Hn.initialize(),No(null),so({visible:!1,text:""}),Bs({visible:!1,title:"",message:""}),pr({visible:!1}),Po({visible:!1}),Hr({visible:!1,projectName:"",locationPath:"",locationHandle:null}),Es({visible:!1,filename:"",locationPath:"",locationHandle:null}),Ao({visible:!1,interval:null}),kr({visible:!1,source:"new",interval:5}),Vo(!1),Fe(!1),ni(!1),Jr(!1),cs(!1),sr(!1),ec(!1),ys(!1),Ac(null),fi(null),gr(null),Dl(!1),Os.current=null,Ja.current=null,xn(!1),Xn(null),wr.current=0,Zi.current=!1,console.log("Project closed: All state cleared and browser permissions released")},[va,pa,aa,hr,Ho,ra,Ro,Qs,Xl,m,_,At,Qt,ba,To,qn,$l,Li,Si,cl,Uo,fn,Fn,fr,bt,dn,mn,bn,_n,Tn,ts,bs,T,si,na,es,Zn,La,Us,ci,Bt,on,qi,ae,D,w,$,qo,Rs,Co,Ds,ns,Ls,fa,Ms,Zr,ha,Ea,Go,qs,Vs,co,ls,f,k,q,Q,_i,xr,oe,ln,ma,As,zs,Na,la,zr,No,so,Bs,pr,Hr,Es,Ao,kr,Gr,Vo,Fe,ni,Jr,cs,sr,ec,Ac,fi,gr,Dl,xn,Xn]),uc=L.useCallback(()=>{ds(),setTimeout(()=>{si(1),Rr({x:0,y:0}),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),mn(new Set),bn(new Set),_n(new Set),Tn(new Set)},200)},[ds,si,Rr]);Pt.useEffect(()=>{uc()},[]),Pt.useEffect(()=>{if(!zo.visible)return;const l=[];ii.size>0,ii.size===0&&$n.size===0&&mi.size===0&&Yn.size===0&&l.push(`
No objects selected.`);const y=l.join(`
`);so(N=>({...N,text:y}))},[zo.visible,ii,$n,mi,Yn,Qe,tn,cn,J,te,Ie]),Pt.useEffect(()=>{const l=y=>{const N=Lr.current;if(N&&!(y.target instanceof Node&&N.contains(y.target))){if(tu(),wu){const B=_c.current;(!B||!(y.target instanceof Node)||!B.contains(y.target))&&Jc(!1)}if(Pl){const B=gl.current;!y.target?.closest('button[title="Color Picker"]')&&(!B||!(y.target instanceof Node)||!B.contains(y.target))&&Vo(!1)}}};return document.addEventListener("mousedown",l,!0),()=>document.removeEventListener("mousedown",l,!0)},[tu,wu,$u,Pl]);const Nu=l=>{if(!l.current)return{top:0,left:0};const y=l.current.getBoundingClientRect(),N=jc.current?.getBoundingClientRect();return N?{top:y.top-N.top,left:y.left-N.left+y.width+4}:{top:0,left:0}},vl=L.useCallback(()=>{_c.current&&Gu.current&&requestAnimationFrame(()=>{if(_c.current&&Gu.current){const l=Nu(Gu);_c.current.style.top=`${l.top}px`,_c.current.style.left=`${l.left}px`}})},[]),ed=L.useCallback(()=>{ju.current&&Xu.current&&requestAnimationFrame(()=>{if(ju.current&&Xu.current){const l=Nu(Xu);ju.current.style.top=`${l.top}px`,ju.current.style.left=`${l.left}px`}})},[]),Ld=L.useCallback(()=>{sc.current&&Ku.current&&requestAnimationFrame(()=>{if(sc.current&&Ku.current){const l=Nu(Ku);sc.current.style.top=`${l.top}px`,sc.current.style.left=`${l.left}px`}})},[]);Pt.useEffect(()=>{wu&&vl()},[wu,vl]),Pt.useEffect(()=>{$u&&ed()},[$u,ed]),Pt.useEffect(()=>{pf&&Ld()},[pf,Ld]),Pt.useEffect(()=>{if(Dt&&Tu.current&&kd.current){const l=Nu(kd);Tu.current.style.top=`${l.top}px`,Tu.current.style.left=`${l.left}px`}},[Dt]),Pt.useEffect(()=>{if(Ar&&Qc.current&&Zu.current){const l=Nu(Zu);Qc.current.style.top=`${l.top}px`,Qc.current.style.left=`${l.left}px`}},[Ar]),Pt.useEffect(()=>{const l=y=>{if(!Pa)return;const N=document.querySelector("[data-component-editor-dialog]");if(N&&y.target instanceof Node&&N.contains(y.target)){const $e=y.target;if($e.tagName==="BUTTON"||$e.tagName==="INPUT"||$e.closest("button")||$e.closest("input"))return}const B=Lr.current;if(!B)return;const le=B.getBoundingClientRect(),ge=y.clientX,A=y.clientY;if(ge<le.left||ge>le.right||A<le.top||A>le.bottom)return;const je=B.width/le.width,ne=B.height/le.height,Te=ge-le.left,ve=A-le.top,Ce=Te*je,ye=ve*ne,we=Ce-5,be=ye-5,me=Of(we,be,zi,yt,On,Ei),Me=me.x,De=me.y;let He=1/0,xt=null,pt=null;const Nt=Math.max(6/yt,4),qt=[...tn,...cn].find($e=>$e.id===Pa.componentId)?.layer||"top";for(const $e of Qe)if(($e.type==="via"||$e.type==="pad")&&$e.points.length>0){if($e.type==="pad"&&($e.layer||"top")!==qt)continue;const Ye=$e.points[0],We=Math.max(1,$e.size/2),lt=Math.hypot(Ye.x-Me,Ye.y-De),ut=Math.max(We,Nt);lt<=ut&&lt<He&&(He=lt,xt=Ye.id??null,pt=$e)}if(xt!=null&&pt){console.log(`
[PIN CONNECTION - DOCUMENT HANDLER] Found via!`),console.log(`  Point ID: ${xt}`),console.log(`  Connecting pin ${Pa.pinIndex+1} of component ${Pa.componentId}`);const $e=String(xt),Ye=Pa.pinIndex,We=Pa.componentId,lt=tn.find(Rt=>Rt.id===We),ut=cn.find(Rt=>Rt.id===We);if(lt){const Rt=Qe;Li(Vt=>{const Sn=Vt.find(It=>It.id===We);if(!Sn)return Vt;const Vn=Sn.pinConnections||[],Rn=Vn.length>0?[...Vn]:new Array(Sn.pinCount).fill("");let Kn;if(Rn.length!==Sn.pinCount){Kn=new Array(Sn.pinCount).fill("");for(let It=0;It<Math.min(Rn.length,Sn.pinCount);It++)Kn[It]=Rn[It]||""}else Kn=[...Rn];Kn[Ye]=$e,console.log(`Updated pin ${Ye} with value: ${$e}`),console.log("New pinConnections:",Kn);const hi=Vt.find(It=>It.id===We),Bn=hi?Dg(hi,Kn,Rt):null;return Vt.map(It=>{if(It.id===We){const Dn={...It,pinConnections:Kn};return Bn&&(Dn.pinPolarities=Bn),Dn}return It})})}else if(ut){const Rt=Qe;Si(Vt=>{const Sn=Vt.find(It=>It.id===We);if(!Sn)return Vt;const Vn=Sn.pinConnections||[],Rn=Vn.length>0?[...Vn]:new Array(Sn.pinCount).fill("");let Kn;if(Rn.length!==Sn.pinCount){Kn=new Array(Sn.pinCount).fill("");for(let It=0;It<Math.min(Rn.length,Sn.pinCount);It++)Kn[It]=Rn[It]||""}else Kn=[...Rn];Kn[Ye]=$e,console.log(`Updated pin ${Ye} with value: ${$e}`),console.log("New pinConnections:",Kn);const hi=Vt.find(It=>It.id===We),Bn=hi?Dg(hi,Kn,Rt):null;return Vt.map(It=>{if(It.id===We){const Dn={...It,pinConnections:Kn};return Bn&&(Dn.pinPolarities=Bn),Dn}return It})})}setTimeout(()=>{Uo(null)},0)}else console.log("[PIN CONNECTION - DOCUMENT HANDLER] No via found at click location")};if(Pa)return document.addEventListener("mousedown",l,!0),()=>document.removeEventListener("mousedown",l,!0)},[Pa,tn,cn,Qe,yt,zi.x,zi.y,On,Ei]);const xo=L.useCallback((l,y,N,B)=>{const le=window.innerWidth,ge=window.innerHeight,A=10;let je=Math.max(A,Math.min(l,le-N-A)),ne=Math.max(A,Math.min(y,ge-B-A));return{x:je,y:ne}},[]);Pt.useEffect(()=>{if(!_s)return;const l=N=>{if(!j)return;const B={x:N.clientX-j.x,y:N.clientY-j.y},le=xo(B.x,B.y,250,window.innerHeight*.4);ul(le),localStorage.setItem("componentDialogPosition",JSON.stringify(le))},y=()=>{Fc(!1),W(null)};return document.addEventListener("mousemove",l),document.addEventListener("mouseup",y),()=>{document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",y)}},[_s,j,xo]),Pt.useEffect(()=>{if(!Qr)return;const l=N=>{if(!ar)return;const B={x:N.clientX-ar.x,y:N.clientY-ar.y},le=xo(B.x,B.y,250,window.innerHeight*.4);Wi(le),localStorage.setItem("detailedInfoDialogPosition",JSON.stringify(le))},y=()=>{ca(!1),Fi(null)};return document.addEventListener("mousemove",l),document.addEventListener("mouseup",y),()=>{document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",y)}},[Qr,ar,xo]),Pt.useEffect(()=>{if(!Ui)return;const l=N=>{if(!Bo)return;const B={x:N.clientX-Bo.x,y:N.clientY-Bo.y};Mn(B),localStorage.setItem("notesDialogPosition",JSON.stringify(B))},y=()=>{Io(!1),po(null)};return document.addEventListener("mousemove",l),document.addEventListener("mouseup",y),()=>{document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",y)}},[Ui,Bo]),Pt.useEffect(()=>{if(Oa&&Pn===null){const l=localStorage.getItem("notesDialogPosition");if(l)try{const y=JSON.parse(l);Mn(y)}catch{Mn({x:window.innerWidth-550,y:100})}else Mn({x:window.innerWidth-550,y:100})}},[Oa,Pn]),Pt.useEffect(()=>{if(!Wc)return;const l=N=>{if(!vs)return;const B={x:N.clientX-vs.x,y:N.clientY-vs.y};tc(B),localStorage.setItem("projectNotesDialogPosition",JSON.stringify(B))},y=()=>{Tc(!1),Wu(null)};return document.addEventListener("mousemove",l),document.addEventListener("mouseup",y),()=>{document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",y)}},[Wc,vs]),Pt.useEffect(()=>{if(!Er)return;const l=N=>{if(!Hs)return;const B={x:N.clientX-Hs.x,y:N.clientY-Hs.y};ea(B),localStorage.setItem("testPointsDialogPosition",JSON.stringify(B))},y=()=>{nc(!1),Ml(null)};return document.addEventListener("mousemove",l),document.addEventListener("mouseup",y),()=>{document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",y)}},[Er,Hs]),Pt.useEffect(()=>{if($c&&yl===null){const l=localStorage.getItem("testPointsDialogPosition");if(l)try{const y=JSON.parse(l);ea(y)}catch{ea({x:100,y:100})}else ea({x:100,y:100})}},[$c,yl]),Pt.useEffect(()=>{if(tl&&tr===null){const l=localStorage.getItem("projectNotesDialogPosition");if(l)try{const y=JSON.parse(l);tc(y)}catch{tc({x:100,y:100})}else tc({x:100,y:100})}},[tl,tr]);const ru=L.useCallback(()=>{ec(!0)},[]),Or=L.useCallback(()=>{xu(!0)},[]);Pt.useEffect(()=>{if(Wa&&Wa.visible&&$a===null){const l=localStorage.getItem("componentDialogPosition");let y;if(l)try{const N=JSON.parse(l);y=xo(N.x,N.y,250,window.innerHeight*.4),ul(y)}catch{y=xo(window.innerWidth-280,90,250,window.innerHeight*.4),ul(y)}else y=xo(window.innerWidth-280,90,250,window.innerHeight*.4),ul(y)}else!Wa||Wa.visible},[Wa,$a,xo]),Pt.useEffect(()=>{if(zo.visible&&Xi===null){const l=localStorage.getItem("detailedInfoDialogPosition");let y;if(l)try{const N=JSON.parse(l);y=xo(N.x,N.y,400,window.innerHeight*.8),Wi(y)}catch{y=xo(window.innerWidth-450,90,400,window.innerHeight*.8),Wi(y)}else y=xo(window.innerWidth-450,90,400,window.innerHeight*.8),Wi(y)}else zo.visible},[zo.visible,Xi,xo]),Pt.useEffect(()=>{const l=()=>{if($a){const y=xo($a.x,$a.y,250,window.innerHeight*.4);(y.x!==$a.x||y.y!==$a.y)&&(ul(y),localStorage.setItem("componentDialogPosition",JSON.stringify(y)))}if(Xi){const y=xo(Xi.x,Xi.y,400,window.innerHeight*.8);(y.x!==Xi.x||y.y!==Xi.y)&&(Wi(y),localStorage.setItem("detailedInfoDialogPosition",JSON.stringify(y)))}};return window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[$a,Xi,xo]);const mh=L.useCallback(l=>{switch(l){case"transparency":D(50);break;case"brushSize":O(3);break}},[]),fp=Pt.useRef(Se);Pt.useEffect(()=>{fp.current=Se},[Se]),Pt.useEffect(()=>{if(ee){Kl.current=performance.now(),D(0);const l=y=>{const N=Kl.current||y,B=fp.current,le=(y-N)%B/B,ge=1-Math.abs(1-2*le);D(Math.round(ge*100)),lo.current=requestAnimationFrame(l)};lo.current=requestAnimationFrame(l)}return()=>{lo.current&&(cancelAnimationFrame(lo.current),lo.current=null)}},[ee]),Pt.useEffect(()=>{if(I==="center"){So(S2());return}const l=I==="erase"?"erase":I==="magnify"?"magnify":I==="ground"?"ground":I==="power"?"power":I==="component"?"component":I==="draw"?rt==="via"?"via":rt==="pad"?"pad":rt==="testPoint"?"testPoint":"trace":"default";if(l==="default"){So(void 0);return}const y=yt;let N;if(l==="magnify")N=18;else if(l==="component"){const ye=(ir||"top")==="top"?"componentTop":"componentBottom",be=Hn.get(ye).size||$g.DEFAULT_SIZE;N=Math.max(16,Math.round(be*y))}else if(l==="trace"){const ye=(Jn||"top")==="top"?"traceTop":"traceBottom",be=Hn.get(ye).size||6;N=Math.max(6,Math.round(be*y))}else if(l==="via"){const ye=Hn.get("via").size||6;N=Math.max(6,Math.round(ye*y))}else if(l==="pad"){const ye=(di||"top")==="top"?"padTop":"padBottom",be=Hn.get(ye).size||6;N=Math.max(6,Math.round(be*y))}else if(l==="testPoint"){const ye=(Di||"top")==="top"?"testPointTop":"testPointBottom",be=Hn.get(ye).size||18;N=Math.max(12,Math.round(be*y))}else l==="power"||l==="ground"?N=Math.max(12,Math.round(U*y)):N=Math.max(6,Math.round(U*y));const le=N+4*2+(l==="magnify"?8:0),ge=document.createElement("canvas");ge.width=le,ge.height=le;const A=ge.getContext("2d");if(!A){So(void 0);return}const je=le/2,ne=le/2,Te=N/2;if(A.clearRect(0,0,le,le),l==="via"){const Ce=Te,ye=Te*.5,we=Te*.7,me=Hn.get("via").color;A.fillStyle=me,A.beginPath(),A.arc(je,ne,Ce,0,Eo),A.arc(je,ne,ye,0,Eo),A.fill("evenodd"),A.strokeStyle="#808080",A.lineWidth=1,A.beginPath(),A.moveTo(je-we,ne),A.lineTo(je+we,ne),A.stroke(),A.beginPath(),A.moveTo(je,ne-we),A.lineTo(je,ne+we),A.stroke()}else if(l==="pad"){const Ce=di==="top"?"padTop":"padBottom",we=Hn.get(Ce).color,me=N/2,Me=me*2,De=Me*.5,He=me*.7;A.fillStyle=we,A.beginPath(),A.rect(je-me,ne-me,Me,Me),A.rect(je-De/2,ne-De/2,De,De),A.fill("evenodd"),A.strokeStyle="#808080",A.lineWidth=1,A.beginPath(),A.moveTo(je-He,ne),A.lineTo(je+He,ne),A.stroke(),A.beginPath(),A.moveTo(je,ne-He),A.lineTo(je,ne+He),A.stroke()}else if(l==="trace"){const Ce=Jn==="top"?"traceTop":"traceBottom",we=Hn.get(Ce).color;A.fillStyle=we,A.beginPath(),A.arc(je,ne,Te,0,Eo),A.fill()}else if(l==="testPoint"){So(j2(N));return}else if(l==="erase"){const Ce=U*y,ye=Math.max(Ce*.75,8),we=Math.max(Ce*.5,6),be=Math.max(Ce*.2,2);A.save(),A.translate(je,ne),A.rotate(pu(-35)),A.fillStyle="#f5a3b3",A.strokeStyle="#111",A.lineWidth=1.5;const me=1.5,Me=-ye/2,De=-we/2;A.beginPath(),A.moveTo(Me+me,De),A.lineTo(Me+ye-me,De),A.quadraticCurveTo(Me+ye,De,Me+ye,De+me),A.lineTo(Me+ye,De+we-me),A.quadraticCurveTo(Me+ye,De+we,Me+ye-me,De+we),A.lineTo(Me+me,De+we),A.quadraticCurveTo(Me,De+we,Me,De+we-me),A.lineTo(Me,De+me),A.quadraticCurveTo(Me,De,Me+me,De),A.closePath(),A.fill(),A.stroke(),A.fillStyle="#f18ea4",A.beginPath(),A.rect(-ye/2,we/2-be,ye,be),A.fill(),A.restore()}else if(l==="magnify"){const Ce=Te;A.strokeStyle="#111",A.lineWidth=2,A.beginPath(),A.arc(je-2,ne-2,Ce,0,Eo),A.stroke();const ye=je+Ce*.6,we=ne+Ce*.6,be=ye+6,me=we+6;A.beginPath(),A.moveTo(ye,we),A.lineTo(be,me),A.stroke(),A.beginPath(),A.moveTo(je-6,ne-2),A.lineTo(je+2,ne-2),A.stroke(),Do||(A.beginPath(),A.moveTo(je-2,ne-6),A.lineTo(je-2,ne+2),A.stroke())}else if(l==="ground"){const ye=(Un?gt.find(be=>be.id===Un):null)?.color||"#000000";if(A.strokeStyle=ye,A.lineWidth=2,A.lineCap="round",Un==="groundbus-earth"){const be=Te*1.5,me=be*.9,Me=be*.24,De=be*1.6;A.beginPath(),A.moveTo(je,ne-me/2),A.lineTo(je,ne+me/2),A.stroke();for(let He=0;He<3;He++){const xt=ne+me/2+He*Me,pt=De*(1-He*.25);A.beginPath(),A.moveTo(je-pt/2,xt),A.lineTo(je+pt/2,xt),A.stroke()}}else{const be=Te*.8;A.beginPath(),A.arc(je,ne,Te,0,Eo),A.stroke(),A.beginPath(),A.moveTo(je,ne-Te-be),A.lineTo(je,ne+Te+be),A.stroke(),A.beginPath(),A.moveTo(je-Te-be,ne),A.lineTo(je+Te+be,ne),A.stroke()}}else if(l==="power"){const ye=(sn?Ie.find(be=>be.id===sn):null)?.color||"#ff0000";A.strokeStyle=ye,A.lineWidth=2,A.lineCap="round";const we=Te*.8;A.beginPath(),A.arc(je,ne,Te,0,Eo),A.stroke(),A.beginPath(),A.moveTo(je,ne-Te-we),A.lineTo(je,ne+Te+we),A.stroke(),A.beginPath(),A.moveTo(je-Te-we,ne),A.lineTo(je+Te+we,ne),A.stroke()}else if(l==="component"){const ye=(ir||"top")==="top"?"componentTop":"componentBottom",be=Hn.get(ye).color,me=N,Me=me/2;A.strokeStyle=be,A.lineWidth=2,A.fillStyle="rgba(255,255,255,0.9)",A.beginPath(),A.rect(je-Me,ne-Me,me,me),A.fill(),A.stroke();const De=(()=>{const He=Bl?.dataDrivenDefinition?.designator??Bl?.componentDefinition?.designator??Bl?.designator;return He?He.length<=3?He:He.substring(0,3):Ss?zg(Ss):"?"})();A.fillStyle=be,A.font=`bold ${Math.max(8,me*.35)}px sans-serif`,A.textAlign="center",A.textBaseline="middle",A.fillText(De,je,ne)}const ve=`url(${ge.toDataURL()}) ${Math.round(je)} ${Math.round(ne)}, crosshair`;So(ve)},[I,rt,F,U,yt,Do,Ss,Bl,sn,Un,Ie,gt,vn,Jn,di,Di,ir,Tr.toolInstanceId]),Pt.useEffect(()=>{ku()},[ku]),Pt.useEffect(()=>{ku()},[wa.width,wa.height]),Pt.useEffect(()=>{ii.size===0&&I==="draw"&&rt==="trace"&&U>=1&&(Lt==="top"?de(U):z(U))},[U,I,rt,Lt,ii]),Pt.useEffect(()=>{At(l=>l.map(y=>{if(y.type==="via"&&y.points.length>0&&y.points[0].id!==void 0){const N=y.points[0].id,B=Fa(N,Ie);if(y.viaType!==B)return{...y,viaType:B}}else if(y.type==="pad"&&y.points.length>0&&y.points[0].id!==void 0){const N=y.points[0].id,B=Ua(N,Ie);if(y.padType!==B)return{...y,padType:B}}else if(y.type==="testPoint"&&y.points.length>0&&y.points[0].id!==void 0){const N=y.points[0].id,B=us(N,Ie),le=B.includes("Power")?"power":B.includes("Ground")?"ground":B.includes("Signal")?"signal":"unknown";if(y.testPointType!==le)return{...y,testPointType:le}}return y}))},[J,te,Ie,Fa,Ua,us]);const pp=L.useCallback(()=>{const l=Lr.current;if(!l)return;const y=l.toDataURL("image/png"),N=window.open("","_blank");if(!N){alert("Please allow popups to print the canvas.");return}N.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>PCB Drawing</title>
          <style>
            @media print {
              @page {
                margin: 0;
                size: auto;
              }
              body {
                margin: 0;
                padding: 0;
              }
            }
            body {
              margin: 0;
              padding: 20px;
              display: flex;
              justify-content: center;
              align-items: center;
              background: white;
            }
            img {
              max-width: 100%;
              height: auto;
              display: block;
            }
          </style>
        </head>
        <body>
          <img src="${y}" alt="PCB Drawing" onload="window.setTimeout(function() { window.print(); }, 250);" />
        </body>
      </html>
    `),N.document.close()},[]);Pt.useEffect(()=>{const l=N=>{N.key==="Shift"&&Fs(!0)},y=N=>{N.key==="Shift"&&Fs(!1)};return window.addEventListener("keydown",l),window.addEventListener("keyup",y),()=>{window.removeEventListener("keydown",l),window.removeEventListener("keyup",y)}},[]);const Au=L.useCallback(l=>{if(l.size===0)return;const y=Array.from(l).map(N=>String(N));At(N=>N.map(B=>{if(B.type==="trace"){const le=B.points.filter(ge=>ge.id===void 0?!0:!l.has(ge.id));return le.length<2?null:{...B,points:le}}return B}).filter(B=>B!==null)),Li(N=>N.map(B=>{const le=B.pinConnections||[];if(le.some(A=>A&&y.includes(A))){const A=le.map(je=>je&&y.includes(je)?"":je);return{...B,pinConnections:A}}return B})),Si(N=>N.map(B=>{const le=B.pinConnections||[];if(le.some(A=>A&&y.includes(A))){const A=le.map(je=>je&&y.includes(je)?"":je);return{...B,pinConnections:A}}return B}))},[At,Li,Si]),dc=L.useRef(new Set);Pt.useEffect(()=>{const l=new Set;for(const N of Qe)if((N.type==="via"||N.type==="pad")&&N.points.length>0){const B=N.points[0].id;B!==void 0&&l.add(B)}const y=new Set;for(const N of dc.current)l.has(N)||y.add(N);y.size>0&&Au(y),dc.current=l},[Qe,Au]),Pt.useEffect(()=>{At(l=>l.map(y=>{if(y.type==="via"&&y.points.length>0&&y.points[0].id!==void 0){const N=y.points[0].id,B=Fa(N,Ie);if(y.viaType!==B)return{...y,viaType:B}}else if(y.type==="pad"&&y.points.length>0&&y.points[0].id!==void 0){const N=y.points[0].id,B=Ua(N,Ie);if(y.padType!==B)return{...y,padType:B}}else if(y.type==="testPoint"&&y.points.length>0&&y.points[0].id!==void 0){const N=y.points[0].id,B=us(N,Ie),le=B.includes("Power")?"power":B.includes("Ground")?"ground":B.includes("Signal")?"signal":"unknown";if(y.testPointType!==le)return{...y,testPointType:le}}return y}))},[J,te,Ie,Fa,Ua,us]),Pt.useEffect(()=>{const l=y=>{Vc.current&&(Vc.current.contains(y.target)||No(null))};return document.addEventListener("click",l),()=>document.removeEventListener("click",l)},[]),Pt.useEffect(()=>{const l=(y,N)=>{const B=y.current;if(!B)return;const le=B.getContext("2d");if(!le)return;const ge=B.width,A=B.height;if(le.clearRect(0,0,ge,A),le.fillStyle="#fff",le.fillRect(0,0,ge,A),N?.bitmap){const je=N.bitmap,ne=Math.min(ge/je.width,A/je.height),Te=Math.max(1,Math.floor(je.width*ne)),ve=Math.max(1,Math.floor(je.height*ne)),Ce=Math.floor((ge-Te)/2),ye=Math.floor((A-ve)/2);le.drawImage(je,Ce,ye,Te,ve)}le.strokeStyle="#ddd",le.lineWidth=1,le.strokeRect(.5,.5,ge-1,A-1)};l(Jl,g),l(Hc,S)},[g,S]),Pt.useEffect(()=>{const l=[],y=[],N=[],B=[];for(const le of Qe)if(le.type==="via"&&le.points.length>=1){const ge=le.points[0],A={id:le.id,pointId:ge.id,x:ge.x,y:ge.y,size:le.size,color:le.color};l.push(A)}else if(le.type==="pad"&&le.points.length>=1){const ge=le.points[0],A={id:le.id,pointId:ge.id,x:ge.x,y:ge.y,size:le.size,color:le.color,layer:le.layer||"top"};y.push(A)}else if(le.type==="trace"&&le.points.length>=2)for(let ge=0;ge<le.points.length-1;ge++){const A=le.points[ge],je=le.points[ge+1],ne={id:le.id,startPointId:A.id,endPointId:je.id,x1:A.x,y1:A.y,x2:je.x,y2:je.y,size:le.size,color:le.color};le.layer==="top"?N.push(ne):B.push(ne)}ba(l),To(y),qn(N),$l(B)},[Qe]);const td=L.useRef(Qe);td.current=Qe;const El=L.useCallback(()=>{const y=new Date().toISOString(),N=b1();return{project:{version:1,fileType:"PCB_REVERSE_ENGINEERING_AUTOSAVE",savedAt:y,view:{currentView:E,viewScale:yt,cameraWorldCenter:ya,showBothLayers:ol,selectedDrawingLayer:Lt},images:{top:g?{name:g.name,width:g.width,height:g.height,filePath:g.filePath||g.name,x:g.x,y:g.y,scale:g.scale,rotation:g.rotation,flipX:g.flipX,flipY:g.flipY,skewX:g.skewX,skewY:g.skewY,keystoneV:g.keystoneV,keystoneH:g.keystoneH,brightness:g.brightness??100,contrast:g.contrast??100}:null,bottom:S?{name:S.name,width:S.width,height:S.height,filePath:S.filePath||S.name,x:S.x,y:S.y,scale:S.scale,rotation:S.rotation,flipX:S.flipX,flipY:S.flipY,skewX:S.skewX,skewY:S.skewY,keystoneV:S.keystoneV,keystoneH:S.keystoneH,brightness:S.brightness??100,contrast:S.contrast??100}:null},projectDirectoryName:Ol.current?Ol.current.name||null:Pi&&Pi.name||null,drawing:{drawingStrokes:td.current.filter(le=>!(le.type==="trace"&&le.points.length<2)),vias:rr,tracesTop:ll,tracesBottom:Ec,componentsTop:tn,componentsBottom:cn,grounds:te,powers:J},powerBuses:Ie,groundBuses:gt,pointIdCounter:rg(),designatorCounters:{...Qn.current},autoAssignDesignators:Ir,useGlobalDesignatorCounters:Hi,traceColors:{top:vn.get("trace")?.layerSettings.get("top")?.color||_e,bottom:vn.get("trace")?.layerSettings.get("bottom")?.color||xe},traceSizes:{top:vn.get("trace")?.layerSettings.get("top")?.size||ke,bottom:vn.get("trace")?.layerSettings.get("bottom")?.size||C},padColors:{top:vn.get("pad")?.layerSettings.get("top")?.color||G,bottom:vn.get("pad")?.layerSettings.get("bottom")?.color||ie},padSizes:{top:vn.get("pad")?.layerSettings.get("top")?.size||re,bottom:vn.get("pad")?.layerSettings.get("bottom")?.size||Re},componentColors:{top:vn.get("component")?.layerSettings.get("top")?.color||ht,bottom:vn.get("component")?.layerSettings.get("bottom")?.color||Ut},componentSizes:{top:vn.get("component")?.layerSettings.get("top")?.size||Ht,bottom:vn.get("component")?.layerSettings.get("bottom")?.size||zn},testPointColors:{top:vn.get("testPoint")?.layerSettings.get("top")?.color||et,bottom:vn.get("testPoint")?.layerSettings.get("bottom")?.color||Ct},testPointSizes:{top:vn.get("testPoint")?.layerSettings.get("top")?.size||se,bottom:vn.get("testPoint")?.layerSettings.get("bottom")?.size||Jt},componentConnectionColor:Ne,componentConnectionSize:ct,toolLayerDefaults:{trace:Jn,pad:di,testPoint:Di,component:ir},toolSettings:{trace:vn.get("trace")?.settings||{color:"#ff0000",size:6},via:vn.get("via")?.settings||{color:"#ff0000",size:18},pad:vn.get("pad")?.settings||{color:"#ff0000",size:18},component:vn.get("component")?.settings||{color:"#ff0000",size:18},ground:vn.get("ground")?.settings||{color:"#000000",size:18},power:vn.get("power")?.settings||{color:"#ff0000",size:18},erase:vn.get("erase")?.settings||{color:"#f5a3b3",size:18}},locks:{areImagesLocked:Cr,areViasLocked:da,arePadsLocked:Xr,areTracesLocked:Vi,areComponentsLocked:Kr,areGroundNodesLocked:Vr,arePowerNodesLocked:Qi},visibility:{showViasLayer:sa,showTopPadsLayer:Lo,showBottomPadsLayer:Ii,showTopTracesLayer:Gi,showBottomTracesLayer:to,showTopComponents:x,showBottomComponents:P,showPowerLayer:Z,showGroundLayer:ai,showConnectionsLayer:pi,showTraceCornerDots:yr},autoSave:{enabled:Xa,interval:Wo,baseName:$o},projectInfo:{name:oa},projectNotes:Br,homeViews:Da,toolInstances:Hn.getAll()},timestamp:N}},[E,yt,ya,ol,Lt,g,S,Qe,rr,ll,Ec,tn,cn,te,vn,Cr,da,Xr,Vi,Kr,Vr,Qi,Ie,gt,rg,_e,xe,ke,C,G,ie,re,Re,ht,Ut,Ht,zn,Jn,di,Di,ir,Xa,Wo,$o,oa,sa,Lo,Ii,Gi,to,x,P,Z,ai,pi,Ir,Hi,Br,Da]),zu=L.useRef(El);zu.current=El;const no=L.useRef(os);no.current=os;const wl=L.useRef($o);wl.current=$o;const Md=L.useRef(aa);Md.current=aa;const Tf=L.useRef(_l);Tf.current=_l;const Xo=L.useRef([]);Xo.current=Ka;const Rc=L.useRef(-1);Rc.current=Za;const Ol=L.useRef(null),nd=L.useRef(!1);Pt.useEffect(()=>{nd.current||(Ol.current=Pi)},[Pi]);const Sl=L.useCallback(async()=>{console.log("Auto save: performAutoSave called");let l=no.current||Ol.current,y=wl.current;if(console.log(`Auto save: dirHandle=${l?`set (using ${no.current?"autoSaveDirHandle":"projectDirHandle"})`:"missing"}, baseName=${y||"missing"}`),!l||!y){console.warn(`Auto save: Missing project directory handle (${!l}) or base name (${!y}). Please create a new project or open an existing project first.`),Ho(!1),bi.current&&(clearInterval(bi.current),bi.current=null);return}if(!Ra.current){console.log("Auto save: Skipping - no changes since last save");return}const N=td.current,B=N.filter(ve=>ve.type==="trace"&&ve.points.length<2);if(B.length>0){console.log(`Auto save: Cleaning up ${B.length} single-point trace(s) before save`),B.forEach(Ce=>console.log(`  - Removing single-point trace ${Ce.id}`));const ve=N.filter(Ce=>!(Ce.type==="trace"&&Ce.points.length<2));At(ve),td.current=ve}console.log("Auto save: Starting save...");const{project:le,timestamp:ge}=zu.current(),je=`${ad(y)}_${ge}.json`,ne=JSON.stringify(le,null,2),Te=new Blob([ne],{type:"application/json"});try{let ve;try{ve=await l.getDirectoryHandle("history",{create:!0})}catch(me){console.error("Failed to get/create history directory:",me);return}try{const me=[],Me=Tf.current;for await(const De of l.keys())try{if(De==="history"||De===je)continue;const xt=await(await l.getFileHandle(De)).getFile();if(!De.endsWith(".json"))continue;const pt=await xt.text();try{const Nt=JSON.parse(pt);if(Nt.version&&(Nt.fileType==="PCB_REVERSE_ENGINEERING_AUTOSAVE"||!Nt.fileType)){me.push(De);const st=Nt.fileType?"auto-saved":"manually saved/opened";console.log(`Auto save: Found PCB project file in root: ${De} (${st}${De===Me?" - this is the opened file":""})`)}}catch{continue}}catch{continue}for(const De of me)try{const pt=await(await(await l.getFileHandle(De)).getFile()).text(),st=await(await ve.getFileHandle(De,{create:!0})).createWritable();await st.write(new Blob([pt],{type:"application/json"})),await st.close(),await l.removeEntry(De),console.log(`Auto save: Moved ${De} from root to history/`)}catch(He){console.warn(`Auto save: Failed to move ${De} to history:`,He)}}catch(me){console.warn("Auto save: Error checking for old files in root:",me)}const ye=await(await l.getFileHandle(je,{create:!0})).createWritable();await ye.write(Te),await ye.close(),console.log(`Auto save: Successfully saved ${je} to root directory`),Md.current(je);const we=Xo.current,be=[je,...we.filter(me=>me!==je)].sort((me,Me)=>Me.localeCompare(me));Qs(be),Xo.current=be,Xl(0),Rc.current=0,Ra.current=!1,Ga(!1)}catch(ve){console.error("Auto save failed:",ve)}},[]);Sc.current=Sl;const ta=L.useCallback(async()=>{const{project:l}=El(),y=JSON.stringify(l,null,2),N=new Blob([y],{type:"application/json"});if(Pi&&oa)try{let Te=null;try{Te=await Pi.getDirectoryHandle("history",{create:!0})}catch(Me){console.error("Failed to get/create history directory:",Me),Te=null}const ve=oa.replace(/\.json$/i,""),Ce=ad(ve),{timestamp:ye}=El(),we=`${Ce}_${ye}.json`;if(Te)try{const Me=[];for await(const De of Pi.keys())try{if(De==="history"||De===we)continue;const xt=await(await Pi.getFileHandle(De)).getFile();if(!De.endsWith(".json"))continue;const pt=await xt.text();try{JSON.parse(pt).version&&(Me.push(De),console.log(`Save: Found PCB project file in root: ${De}`))}catch{continue}}catch{continue}for(const De of Me)try{const pt=await(await(await Pi.getFileHandle(De)).getFile()).text(),st=await(await Te.getFileHandle(De,{create:!0})).createWritable();await st.write(new Blob([pt],{type:"application/json"})),await st.close(),await Pi.removeEntry(De),console.log(`Save: Moved ${De} from root to history/`)}catch(He){console.warn(`Save: Failed to move ${De} to history:`,He)}}catch(Me){console.warn("Save: Error checking for old files in root:",Me)}const me=await(await Pi.getFileHandle(we,{create:!0})).createWritable();await me.write(N),await me.close(),aa(we),Ga(!1),Ra.current=!1,console.log(`Project saved successfully: ${oa}/${we}`),alert(`Project saved successfully!

File: ${we}
Location: ${oa}`);return}catch(Te){const ve=Te instanceof Error?Te.message:String(Te);console.error("Failed to save to project directory:",Te),alert(`Failed to save project to directory.

Error: ${ve}

Please try saving again or use Save As...`),va(null)}if(oa&&!Pi){const Te=window;if(typeof Te.showDirectoryPicker=="function")try{const ve=await Te.showDirectoryPicker();va(ve);const Ce=`${oa}.json`,we=await(await ve.getFileHandle(Ce,{create:!0})).createWritable();await we.write(N),await we.close(),aa(Ce),Ga(!1),Ra.current=!1,console.log(`Project saved successfully: ${Ce} in selected directory`),alert(`Project saved successfully!

File: ${Ce}`);return}catch(ve){if(ve?.name!=="AbortError"){const Ce=ve instanceof Error?ve.message:String(ve);console.error("Failed to get directory:",ve),alert(`Failed to select directory.

Error: ${Ce}

Falling back to file picker...`)}}}const B=Te=>String(Te).padStart(2,"0"),le=new Date,A=`pcb_project_${`${le.getFullYear()}_${B(le.getMonth()+1)}_${B(le.getDate())}_${B(le.getHours())}_${B(le.getMinutes())}_${B(le.getSeconds())}`}.json`,je=window;if(typeof je.showSaveFilePicker=="function")try{const Te=await je.showSaveFilePicker({suggestedName:A,types:[{description:"PCB Project",accept:{"application/json":[".json"]}}]}),ve=await Te.createWritable();await ve.write(N),await ve.close();const Ce=Te.name;try{const be=await Te.getFile();aa(be.name)}catch{aa(Ce)}const we=Ce.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_");we&&hr(we);try{const be=Te.name.replace(/\.json$/i,""),Me=ad(be).replace(/[^a-zA-Z0-9_-]/g,"_");Ro(Me),os||console.log("Auto save: Directory handle not set. Will prompt on first auto save.")}catch(be){console.warn("Could not set up auto save for new file:",be)}console.log(`Project saved successfully: ${Ce}`),alert(`Project saved successfully!

File: ${Ce}`);return}catch(Te){if(Te?.name==="AbortError")return;const ve=Te instanceof Error?Te.message:String(Te);console.warn("showSaveFilePicker failed, falling back to download",Te),alert(`File picker unavailable.

Error: ${ve}

Falling back to browser download...`)}const ne=document.createElement("a");ne.href=URL.createObjectURL(N),ne.download=A,document.body.appendChild(ne),ne.click(),setTimeout(()=>{URL.revokeObjectURL(ne.href),document.body.removeChild(ne)},0),console.log(`Project downloaded: ${A}`),alert(`Project downloaded successfully!

File: ${A}

Note: For better project management, use File  New Project or File  Open Project.`)},[El,Pi,oa,aa,va,Ga,hr,Ro,os,ad]),Id=L.useCallback(l=>{const y=new En,N=y.internal.pageSize.getWidth(),B=y.internal.pageSize.getHeight(),le=20;let ge=le;const A=7,je=60;y.setFontSize(18),y.setFont("helvetica","bold"),y.text("Bill of Materials",N/2,ge,{align:"center"}),ge+=A*2,y.setFontSize(10),y.setFont("helvetica","normal"),l.projectName&&(y.text(`Project: ${l.projectName}`,le,ge),ge+=A),y.text(`Exported: ${new Date(l.exportedAt).toLocaleString()}`,le,ge),ge+=A,y.text(`Total Components: ${l.totalComponents} | Unique Components: ${l.uniqueComponents}`,le,ge),ge=je,y.setFontSize(9),y.setFont("helvetica","bold");const ne=[15,50,30,20,25,30,20],Te=["Qty","Component Type","Value","Package","Manufacturer","Part Number","Layer"];let ve=le;return Te.forEach((ye,we)=>{y.text(ye,ve,ge),ve+=ne[we]}),ge+=A,y.setLineWidth(.5),y.line(le,ge,N-le,ge),ge+=A*.5,y.setFont("helvetica","normal"),y.setFontSize(8),l.items.forEach(ye=>{const we=He=>{ge>B-le-A*He&&(y.addPage(),ge=le+A)};we(3),ve=le,[ye.quantity.toString(),ye.componentType,ye.value||"-",ye.packageType||"-",ye.manufacturer||"-",ye.partNumber||"-",ye.layer].forEach((He,xt)=>{const pt=ne[xt]-2,Nt=y.splitTextToSize(He,pt);y.text(Nt[0]||"-",ve,ge),ve+=ne[xt]}),ge+=A*1.2;const me=(ye.notes||"").toString().trim(),Me=ye.datasheet?ye.datasheet.toString().trim():"",De=[];if(me&&De.push(`Notes: ${me}`),Me&&De.push(`Spec Sheet URL: ${Me}`),De.length>0){const He=le+ne[0]+2,xt=N-le-He;De.forEach(pt=>{y.splitTextToSize(pt,xt).forEach(st=>{we(2),y.text(st,He,ge),ge+=A*.9})})}we(1),y.setLineWidth(.2),y.line(le,ge,N-le,ge),ge+=A*.5}),y.output("blob")},[]),hp=L.useCallback(async()=>{if(console.log("handleExportBOM called, format:",pe),!Pi){alert("Please create or open a project before exporting BOM.");return}try{console.log("Generating BOM data...");const l=k2(tn,cn,oa);console.log("BOM data generated:",l),console.log("Creating/getting BOM directory...");let y;try{y=await Pi.getDirectoryHandle("BOM",{create:!0}),console.log("BOM directory obtained")}catch(je){console.error("Failed to get/create BOM directory:",je),alert("Failed to create BOM directory. See console for details.");return}const N=b1();let B,le;if(pe==="pdf")console.log("Generating PDF..."),B=Id(l),le=`BOM_${N}.pdf`;else{console.log("Generating JSON...");const je=JSON.stringify(l,null,2);B=new Blob([je],{type:"application/json"}),le=`BOM_${N}.json`}console.log("Saving file:",le);const A=await(await y.getFileHandle(le,{create:!0})).createWritable();await A.write(B),await A.close(),console.log("BOM file saved successfully"),alert(`BOM exported successfully to ${le} in BOM directory!`)}catch(l){console.error("Failed to export BOM:",l),alert(`Failed to export BOM: ${l instanceof Error?l.message:String(l)}. See console for details.`)}},[Pi,tn,cn,oa,pe,Id]);Pt.useEffect(()=>{bi.current&&(clearInterval(bi.current),bi.current=null);const l=Rl.current;if(Rl.current=Xa,Xa&&Wo){const y=Wo*60*1e3;(os||Pi)&&$o?(console.log(`Auto save: Setting up interval for ${Wo} minute(s) (${y}ms)`),l||(Ra.current=!0,setTimeout(()=>{Sl()},100)),bi.current&&(clearInterval(bi.current),bi.current=null),bi.current=window.setInterval(()=>{console.log("Auto save: Interval triggered, calling performAutoSave..."),console.log(`  - hasChangesSinceLastAutoSave: ${Ra.current}`),console.log(`  - dirHandle: ${no.current?"set":"missing"}`),console.log(`  - baseName: ${wl.current||"missing"}`),Sl()},y),console.log(`Auto save: Interval set up for ${y}ms (${Wo} minutes)`),console.log(`  - Auto save directory handle: ${os?"set":"missing"}`),console.log(`  - Project directory handle: ${Pi?"set":"missing"}`),console.log(`  - Base name: ${$o||"missing"}`)):(console.warn(`Auto save: Cannot set up interval - missing directory handle (autoSaveDirHandle: ${!!os}, projectDirHandle: ${!!Pi}) or base name (${!$o}). Disabling auto save.`),Ho(!1),bi.current&&(clearInterval(bi.current),bi.current=null))}else Xa||(Rl.current=!1);return()=>{bi.current&&(clearInterval(bi.current),bi.current=null)}},[Xa,Wo,os,$o,Pi]);const ja=L.useRef(!1),Bd=L.useRef(!1),[gp,xp]=Pt.useState(0);Pt.useEffect(()=>{const y=Object.keys(Hn.getAll()).map(N=>Hn.subscribe(N,()=>{xp(B=>B+1)}));return()=>y.forEach(N=>N())},[]),Pt.useEffect(()=>{if(Bd.current){console.log("Change tracking: Skipping - project is being loaded");return}if(Xa&&ja.current){ja.current=!1,console.log("Auto save: Skipping change tracking on first run after enable (initial save handled separately)");return}Ra.current=!0,Ga(!0),console.log("Change detected, marking as unsaved",{autoSaveEnabled:Xa,topImage:!!g,bottomImage:!!S,drawingStrokesCount:Qe.length,componentsTopCount:tn.length,componentsBottomCount:cn.length,powersCount:J.length,groundsCount:te.length,powerBusesCount:Ie.length,projectNotesCount:Br.length,areImagesLocked:Cr,areViasLocked:da,areTracesLocked:Vi,areComponentsLocked:Kr,areGroundNodesLocked:Vr,arePowerNodesLocked:Qi})},[g,S,Qe,tn,cn,J,te,Ie,Br,_e,xe,ke,C,Cr,da,Vi,Kr,Vr,Qi,gt,Xa,G,ie,re,Re,ht,Ut,Ht,zn,et,Ct,se,Jt,Ne,ct,Jn,Ir,Hi,Da,vn,gp]),Pt.useEffect(()=>{Xa?(ja.current=!0,console.log("Auto save: Enabled, marking first run")):ja.current=!1},[Xa]),Pt.useEffect(()=>{Xa||(Ra.current=!1)},[Xa]);const Fr=L.useCallback(()=>!!(g||S||Qe.length>0||tn.length>0||cn.length>0||J.length>0||te.length>0),[g,S,Qe,tn,cn,J,te]),yo=L.useCallback(()=>{Hr({visible:!0,projectName:"",locationPath:"",locationHandle:null})},[]),fc=L.useCallback(async()=>{const l=window;if(typeof l.showDirectoryPicker=="function")try{const y=await l.showDirectoryPicker({mode:"readwrite"});Hr(N=>({...N,locationHandle:y,locationPath:y.name||"Selected folder"}))}catch(y){y?.name!=="AbortError"&&(console.error("Failed to get directory:",y),alert("Failed to select location directory."))}else alert("Directory picker is not supported in this browser. Please use a modern browser like Chrome or Edge.")},[]),Cf=L.useCallback(async()=>{const l=Ci.projectName.trim();if(!l){alert("Please enter a project name.");return}const y=l.replace(/[^a-zA-Z0-9_-]/g,"_")||"pcb_project";if(!Ci.locationHandle){alert("Please select a location for the project.");return}const N=Ci.locationHandle;let B,le;if(N.name===y)B=N,le=N;else{le=N;try{B=await le.getDirectoryHandle(y,{create:!0})}catch(ge){console.error("Failed to create project folder:",ge),alert(`Failed to create project folder "${y}". See console for details.`);return}}try{await B.getDirectoryHandle("history",{create:!0}),await B.getDirectoryHandle("images",{create:!0}),await B.getDirectoryHandle("datasheets",{create:!0}),console.log("Created project subdirectories: history, images, datasheets")}catch(ge){console.error("Failed to create project subdirectories:",ge)}iu(),Hr({visible:!1,projectName:"",locationPath:"",locationHandle:null}),hr(y),va(B),ds(),Ys(),ri(!1),D(0);try{const{project:ge,timestamp:A}=El(),ne=`${ad(y)}_${A}.json`,Te=JSON.stringify(ge,null,2),ve=new Blob([Te],{type:"application/json"}),ye=await(await B.getFileHandle(ne,{create:!0})).createWritable();await ye.write(ve),await ye.close(),aa(ne),console.log(`New project created: ${y}/${ne}`),kr({visible:!0,source:"new",interval:5})}catch(ge){console.error("Failed to save new project:",ge),alert("Failed to save new project file. See console for details.")}},[ds,El,Ci,iu,Ys,ri,D]),Ed=L.useCallback(()=>{Hr({visible:!1,projectName:"",locationPath:"",locationHandle:null})},[]),yp=L.useCallback(async()=>{const l=window;if(typeof l.showDirectoryPicker=="function")try{const y=await l.showDirectoryPicker();Es(N=>({...N,locationHandle:y,locationPath:y.name||"Selected folder"}))}catch(y){y?.name!=="AbortError"&&(console.error("Failed to get directory:",y),alert("Failed to select location directory."))}else alert("Directory picker is not supported in this browser. Please use a modern browser that supports the File System Access API.")},[]),mp=L.useCallback(async()=>{const l=Yi.filename.trim();if(!l){alert("Please enter a file name.");return}const N=(l.endsWith(".json")?l:`${l}.json`).replace(/[^a-zA-Z0-9_.-]/g,"_");if(!Yi.locationHandle){alert("Please select a location for the file.");return}const B=Yi.locationHandle;try{const{project:le}=El(),ge=JSON.stringify(le,null,2),A=new Blob([ge],{type:"application/json"}),ne=await(await B.getFileHandle(N,{create:!0})).createWritable();await ne.write(A),await ne.close(),aa(N);const Te=N.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_");Te&&hr(Te),va(B),Ga(!1),Ra.current=!1,Es({visible:!1,filename:"",locationPath:"",locationHandle:null}),No(null),console.log(`Project saved as: ${N} in selected directory`)}catch(le){console.error("Failed to save project:",le),alert(`Failed to save project file "${N}". See console for details.`)}},[Yi,El]),Pu=L.useCallback(()=>{Es({visible:!1,filename:"",locationPath:"",locationHandle:null})},[]),Ko=L.useCallback(async()=>{pr({visible:!1}),await ta(),yo(),uc()},[ta,yo,uc]),jl=L.useCallback(()=>{pr({visible:!1}),yo(),uc()},[yo,uc]),bp=L.useCallback(()=>{pr({visible:!1})},[]);Pt.useEffect(()=>{if(zl.visible){setTimeout(()=>{gu.current?.focus()},0);const l=y=>{y.key==="Enter"?(y.preventDefault(),Ko()):y.key==="Escape"&&(y.preventDefault(),pr({visible:!1}))};return window.addEventListener("keydown",l),()=>{window.removeEventListener("keydown",l)}}},[zl.visible,Ko]);const qa=L.useCallback(async(l,y)=>{Bd.current=!0;try{if(Gr(),l.toolInstances?Hn.initializeFromProject(l):Hn.initialize(),l.projectInfo&&l.projectInfo.name&&hr(l.projectInfo.name),l.view){if(l.view.currentView&&T(l.view.currentView),l.view.viewScale!=null&&si(l.view.viewScale),l.view.cameraWorldCenter)Rr(l.view.cameraWorldCenter);else if(l.view.viewPan){const ve=Lr.current;if(ve){const Ce=(ve.width-10)/2,ye=(ve.height-10)/2,we=l.view.viewScale??1,be=(Ce-l.view.viewPan.x)/we,me=(ye-l.view.viewPan.y)/we;Rr({x:be,y:me})}else Rr({x:0,y:0})}l.view.showBothLayers!=null&&es(l.view.showBothLayers),l.view.selectedDrawingLayer&&Zn(l.view.selectedDrawingLayer)}if(l.homeViews){const ve={};for(const[Ce,ye]of Object.entries(l.homeViews)){const we=parseInt(Ce,10),be=ye;let me=be.pcbReferenceX,Me=be.pcbReferenceY;(me===void 0||Me===void 0)&&(me=be.x??0,Me=be.y??0),be.showTopImage===void 0?ve[we]={pcbReferenceX:me,pcbReferenceY:Me,x:0,y:0,zoom:be.zoom,viewRotation:On,viewFlipX:Ei,isBottomView:ki,transparency:K,showTopImage:eo,showBottomImage:Sa,showViasLayer:sa,showTopTracesLayer:Gi,showBottomTracesLayer:to,showTopPadsLayer:Lo,showBottomPadsLayer:Ii,showTopTestPointsLayer:uo,showBottomTestPointsLayer:Mo,showTopComponents:x,showBottomComponents:P,showPowerLayer:Z,showGroundLayer:ai,showConnectionsLayer:pi}:ve[we]={...be,pcbReferenceX:me,pcbReferenceY:Me,x:0,y:0,viewRotation:be.viewRotation??0,viewFlipX:be.viewFlipX??!1,isBottomView:be.isBottomView??!1,transparency:be.transparency??50}}La(ve)}else La({});if(l.projectNotes&&Array.isArray(l.projectNotes)?bs(l.projectNotes):bs([]),l.traceColors&&(l.traceColors.top&&(ce(l.traceColors.top),jt("trace",l.traceColors.top,"top")),l.traceColors.bottom&&(fe(l.traceColors.bottom),jt("trace",l.traceColors.bottom,"bottom"))),l.traceSizes){const ve=l.traceSizes.top!=null&&l.traceSizes.top>0?l.traceSizes.top:6;let Ce=l.traceSizes.bottom!=null&&l.traceSizes.bottom>0?l.traceSizes.bottom:6;Ce<6&&(Ce=6),de(ve),z(Ce),Ze("trace",ve,"top"),Ze("trace",Ce,"bottom")}else de(6),z(6);if(l.padColors&&(l.padColors.top&&(V(l.padColors.top),jt("pad",l.padColors.top,"top")),l.padColors.bottom&&(he(l.padColors.bottom),jt("pad",l.padColors.bottom,"bottom"))),l.padSizes){const ve=l.padSizes.top!=null&&l.padSizes.top>0?l.padSizes.top:18,Ce=l.padSizes.bottom!=null&&l.padSizes.bottom>0?l.padSizes.bottom:18;Le(ve),Ue(Ce),Ze("pad",ve,"top"),Ze("pad",Ce,"bottom")}if(l.componentColors&&(l.componentColors.top&&(Xe(l.componentColors.top),jt("component",l.componentColors.top,"top")),l.componentColors.bottom&&(an(l.componentColors.bottom),jt("component",l.componentColors.bottom,"bottom"))),l.componentSizes){const ve=l.componentSizes.top!=null&&l.componentSizes.top>0?l.componentSizes.top:18,Ce=l.componentSizes.bottom!=null&&l.componentSizes.bottom>0?l.componentSizes.bottom:18;Nn(ve),Ee(Ce),Ze("component",ve,"top"),Ze("component",Ce,"bottom")}l.toolLayerDefaults?(l.toolLayerDefaults.trace&&ma(l.toolLayerDefaults.trace),l.toolLayerDefaults.pad&&As(l.toolLayerDefaults.pad),l.toolLayerDefaults.testPoint&&zs(l.toolLayerDefaults.testPoint),l.toolLayerDefaults.component&&Na(l.toolLayerDefaults.component)):l.traceToolLayer&&ma(l.traceToolLayer),l.toolSettings&&wi(ve=>{const Ce=new Map(ve);if(l.toolSettings.trace){const we=Ce.get("trace");if(we){const be={...we,settings:l.toolSettings.trace},me=new Map(we.layerSettings);l.traceSizes&&l.traceColors&&(me.set("top",{color:l.traceColors.top||we.layerSettings.get("top")?.color||"#AA4499",size:l.traceSizes.top||we.layerSettings.get("top")?.size||6}),me.set("bottom",{color:l.traceColors.bottom||we.layerSettings.get("bottom")?.color||"#F781BF",size:l.traceSizes.bottom||we.layerSettings.get("bottom")?.size||6})),Ce.set("trace",{...be,layerSettings:me})}}if(l.toolSettings.via){const we=Ce.get("via");we&&Ce.set("via",{...we,settings:l.toolSettings.via})}if(l.toolSettings.pad){const we=Ce.get("pad");if(we){const be={...we,settings:l.toolSettings.pad},me=new Map(we.layerSettings);l.padSizes&&l.padColors&&(me.set("top",{color:l.padColors.top||we.layerSettings.get("top")?.color||"#0072B2",size:l.padSizes.top||we.layerSettings.get("top")?.size||18}),me.set("bottom",{color:l.padColors.bottom||we.layerSettings.get("bottom")?.color||"#56B4E9",size:l.padSizes.bottom||we.layerSettings.get("bottom")?.size||18})),Ce.set("pad",{...be,layerSettings:me})}}if(l.toolSettings.component){const we=Ce.get("component");if(we){const be={...we,settings:l.toolSettings.component},me=new Map(we.layerSettings);l.componentSizes&&l.componentColors&&(me.set("top",{color:l.componentColors.top||we.layerSettings.get("top")?.color||"#6A3D9A",size:l.componentSizes.top||we.layerSettings.get("top")?.size||18}),me.set("bottom",{color:l.componentColors.bottom||we.layerSettings.get("bottom")?.color||"#9467BD",size:l.componentSizes.bottom||we.layerSettings.get("bottom")?.size||18})),Ce.set("component",{...be,layerSettings:me})}}if(l.testPointSizes&&l.testPointColors){ot(l.testPointColors.top||et),Ot(l.testPointColors.bottom||Ct),kt(l.testPointSizes.top||se),Wt(l.testPointSizes.bottom||Jt);const we=Ce.get("testPoint");if(we){const be=new Map(we.layerSettings);be.set("top",{color:l.testPointColors.top||we.layerSettings.get("top")?.color||"#E69F00",size:l.testPointSizes.top||we.layerSettings.get("top")?.size||6}),be.set("bottom",{color:l.testPointColors.bottom||we.layerSettings.get("bottom")?.color||"#F0E442",size:l.testPointSizes.bottom||we.layerSettings.get("bottom")?.size||6}),Ce.set("testPoint",{...we,layerSettings:be})}}if(l.componentConnectionColor!==void 0&&Mt(l.componentConnectionColor),l.componentConnectionSize!==void 0&&_t(l.componentConnectionSize),l.toolSettings.ground){const we=Ce.get("ground");we&&Ce.set("ground",{...we,settings:l.toolSettings.ground})}if(l.toolSettings.power){const we=Ce.get("power");we&&Ce.set("power",{...we,settings:l.toolSettings.power})}if(l.toolSettings.erase){const we=Ce.get("erase");we&&Ce.set("erase",{...we,settings:l.toolSettings.erase})}const ye=I==="draw"&&rt==="trace"?Ce.get("trace"):I==="draw"&&rt==="via"?Ce.get("via"):I==="draw"&&rt==="pad"?Ce.get("pad"):I==="draw"&&rt==="testPoint"?Ce.get("testPoint"):I==="component"?Ce.get("component"):I==="power"?Ce.get("power"):I==="ground"?Ce.get("ground"):null;if(ye)if(I==="draw"&&rt==="trace"){const we=Jn||"top",be=ye.layerSettings.get(we);be?(R(be.color),O(be.size),we==="top"?(ce(be.color),de(be.size)):(fe(be.color),z(be.size))):(R(ye.settings.color),O(ye.settings.size))}else if(I==="draw"&&rt==="pad"){const we=di||"top",be=ye.layerSettings.get(we);be?(R(be.color),O(be.size),we==="top"?(V(be.color),Le(be.size)):(he(be.color),Ue(be.size))):(R(ye.settings.color),O(ye.settings.size))}else if(I==="component"){const we=ir||"top",be=ye.layerSettings.get(we);be?(R(be.color),O(be.size),we==="top"?(Xe(be.color),Nn(be.size)):(an(be.color),Ee(be.size))):(R(ye.settings.color),O(ye.settings.size))}else if(I==="draw"&&rt==="testPoint"){const we=Di||"top",be=ye.layerSettings.get(we);be?(R(be.color),O(be.size),we==="top"?(ot(be.color),kt(be.size)):(Ot(be.color),Wt(be.size))):(R(ye.settings.color),O(ye.settings.size))}else R(ye.settings.color),O(ye.settings.size);return Ce});const N=async(ve,Ce)=>{if(!ve)return null;let ye=null,we="",be=ve.filePath||ve.name;if(!Ce){const me=ve.name||"image";return alert(`Error: Cannot load image "${me}" because no project directory is available.

Please ensure you opened the project file from its project directory. The project directory is required to access the image files stored in the images/ subdirectory.`),null}if(be)try{let me=be;!be.startsWith("images/")&&!be.startsWith("Images/")?me=be:be.startsWith("Images/")?me=be.replace("Images/",""):be.startsWith("images/")&&(me=be.replace("images/",""));let Me;try{Me=await Ce.getDirectoryHandle("images")}catch{try{Me=await Ce.getDirectoryHandle("Images")}catch{throw new Error("Neither 'images' nor 'Images' directory found in project folder.")}}const He=await(await Me.getFileHandle(me)).getFile();ye=await createImageBitmap(He),we=URL.createObjectURL(He),console.log(`Loaded image from file path: images/${me}`),be.startsWith("images/")||(be=`images/${be.replace("Images/","")}`)}catch(me){const Me=me instanceof Error?me.message:"Unknown error",De=ve.name||"image",He=be.startsWith("images/")||be.startsWith("Images/")?be.replace("Images/","images/"):`images/${be}`;return alert(`Error: Failed to load image "${De}" from project directory.

Expected location: ${He}

This may occur if:
- The image file was moved or deleted
- The project directory structure was modified
- File permissions are insufficient

Please ensure the image file exists in the images/ subdirectory of your project folder.

Technical details: ${Me}`),null}else{const me=ve.name||"image";return alert(`Error: Image "${me}" has no file path specified in the project file.

The project file is missing the image file path information. This may indicate the project file is corrupted or was created with an older version of the software.`),null}if(!ye){const me=ve.name||"image";return alert(`Error: Could not create image bitmap for "${me}".

The image file may be corrupted or in an unsupported format. Please ensure the image is a valid PNG, JPEG, or other supported image format.`),null}return{url:we,name:ve.name??"image",width:ve.width??ye.width,height:ve.height??ye.height,filePath:be,x:ve.x??0,y:ve.y??0,scale:ve.scale??1,rotation:ve.rotation??0,flipX:!!ve.flipX,flipY:!!ve.flipY,skewX:ve.skewX??0,skewY:ve.skewY??0,keystoneV:ve.keystoneV??0,keystoneH:ve.keystoneH??0,brightness:ve.brightness??100,contrast:ve.contrast??100,bitmap:ye}},B=y!==void 0?y:Pi,le=await N(l.images?.top,B),ge=await N(l.images?.bottom,B);if(m(le),_(ge),l.pointIdCounter&&typeof l.pointIdCounter=="number"?Vp(l.pointIdCounter):(console.warn("Project file missing pointIdCounter. Starting from 1."),Vp(1)),l.locks&&(typeof l.locks.areImagesLocked=="boolean"&&qo(l.locks.areImagesLocked),typeof l.locks.areViasLocked=="boolean"&&Rs(l.locks.areViasLocked),typeof l.locks.arePadsLocked=="boolean"&&Co(l.locks.arePadsLocked),typeof l.locks.areTracesLocked=="boolean"&&ns(l.locks.areTracesLocked),typeof l.locks.areComponentsLocked=="boolean"&&Ls(l.locks.areComponentsLocked),typeof l.locks.areGroundNodesLocked=="boolean"&&fa(l.locks.areGroundNodesLocked),typeof l.locks.arePowerNodesLocked=="boolean"&&Ms(l.locks.arePowerNodesLocked)),l.visibility&&(typeof l.visibility.showViasLayer=="boolean"&&Ea(l.visibility.showViasLayer),typeof l.visibility.showTopPadsLayer=="boolean"&&Vs(l.visibility.showTopPadsLayer),typeof l.visibility.showBottomPadsLayer=="boolean"&&co(l.visibility.showBottomPadsLayer),typeof l.visibility.showTopTracesLayer=="boolean"&&Go(l.visibility.showTopTracesLayer),typeof l.visibility.showBottomTracesLayer=="boolean"&&qs(l.visibility.showBottomTracesLayer),typeof l.visibility.showTopComponents=="boolean"&&k(l.visibility.showTopComponents),typeof l.visibility.showBottomComponents=="boolean"&&q(l.visibility.showBottomComponents),typeof l.visibility.showPowerLayer=="boolean"&&Q(l.visibility.showPowerLayer),typeof l.visibility.showGroundLayer=="boolean"&&_i(l.visibility.showGroundLayer),typeof l.visibility.showConnectionsLayer=="boolean"&&xr(l.visibility.showConnectionsLayer),typeof l.visibility.showTraceCornerDots=="boolean"&&Oi(l.visibility.showTraceCornerDots)),l.autoSave?(typeof l.autoSave.enabled=="boolean"&&Ho(l.autoSave.enabled),typeof l.autoSave.interval=="number"&&ra(l.autoSave.interval),typeof l.autoSave.baseName=="string"&&l.autoSave.baseName?(Ro(l.autoSave.baseName),wl.current=l.autoSave.baseName,l.autoSave.enabled&&!os&&(console.log("Auto save: Directory handle not available after page reload (expected). Auto save disabled. Use File -> Auto Save -> Enable to re-enable."),Ho(!1),ra(null))):l.autoSave.enabled&&(console.warn("Auto save was enabled in project file but base name is missing. Disabling auto save."),Ho(!1),ra(null),Ro(""),wl.current="")):(Ho(!1),ra(null),pa(null),Ro(""),no.current=null,wl.current="",bi.current&&(clearInterval(bi.current),bi.current=null)),l.drawing?.drawingStrokes&&Array.isArray(l.drawing.drawingStrokes)){const ve=l.drawing.drawingStrokes.map(Ce=>({...Ce,points:Ce.points.map(ye=>({...ye,...or(ye)}))})).filter(Ce=>!(Ce.type==="trace"&&Ce.points.length<2));At(ve);for(const Ce of ve)for(const ye of Ce.points)ye.id&&typeof ye.id=="number"&&ag(ye.id)}else console.warn("Project file missing drawingStrokes. Starting with empty strokes."),At([]);if(l.drawing?.componentsTop){const ve=l.drawing.componentsTop.map(Ce=>{const ye=or({x:Ce.x,y:Ce.y});return{...Ce,x:ye.x,y:ye.y,layer:Ce.layer||"top",pinConnections:Ce.pinConnections||new Array(Ce.pinCount||0).fill("")}});Li(ve)}if(l.drawing?.componentsBottom){const ve=l.drawing.componentsBottom.map(Ce=>{const ye=or({x:Ce.x,y:Ce.y});return{...Ce,x:ye.x,y:ye.y,layer:Ce.layer||"bottom",pinConnections:Ce.pinConnections||new Array(Ce.pinCount||0).fill("")}});Si(ve)}if(l.designatorCounters&&typeof l.designatorCounters=="object"){const ve=l.designatorCounters;Qn.current={...ve}}else Qn.current={};if(typeof l.autoAssignDesignators=="boolean"&&la(l.autoAssignDesignators),typeof l.useGlobalDesignatorCounters=="boolean"?zr(l.useGlobalDesignatorCounters):zr(!1),l.drawing?.grounds){const Ce=l.drawing.grounds.map(ye=>{ye.pointId||console.warn("Ground symbol missing pointId - this may cause issues");const we=or({x:ye.x,y:ye.y});return{...ye,x:we.x,y:we.y}}).filter(ye=>{const we=typeof ye.x=="number"&&typeof ye.y=="number"&&!isNaN(ye.x)&&!isNaN(ye.y)&&isFinite(ye.x)&&isFinite(ye.y);return we||console.warn(`Filtered out invalid ground symbol at (${ye.x}, ${ye.y})`),we});Fn(Ce);for(const ye of Ce)ye.pointId&&typeof ye.pointId=="number"&&ag(ye.pointId)}else Fn([]);let A;if(l.powerBuses&&Array.isArray(l.powerBuses)&&l.powerBuses.length>0?(A=l.powerBuses,bt(A)):(A=[{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}],bt(A)),l.groundBuses&&Array.isArray(l.groundBuses)&&l.groundBuses.length>0?dn(l.groundBuses):dn([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),l.drawing?.powers){const Ce=l.drawing.powers.map(ye=>{ye.pointId||console.warn("Power symbol missing pointId - this may cause issues");const we=or({x:ye.x,y:ye.y});return{...ye,x:we.x,y:we.y}}).filter(ye=>{const we=typeof ye.x=="number"&&typeof ye.y=="number"&&!isNaN(ye.x)&&!isNaN(ye.y)&&isFinite(ye.x)&&isFinite(ye.y);return we||console.warn(`Filtered out invalid power node at (${ye.x}, ${ye.y})`),we});fn(Ce);for(const ye of Ce)ye.pointId&&typeof ye.pointId=="number"&&ag(ye.pointId)}else fn([]);let je=0;if(l.drawing?.drawingStrokes&&Array.isArray(l.drawing.drawingStrokes))for(const ve of l.drawing.drawingStrokes)for(const Ce of ve.points)Ce.id&&typeof Ce.id=="number"&&Ce.id>je&&(je=Ce.id);if(l.drawing?.componentsTop&&Array.isArray(l.drawing.componentsTop)){for(const ve of l.drawing.componentsTop)if(ve.pinConnections&&Array.isArray(ve.pinConnections)){for(const Ce of ve.pinConnections)if(Ce&&typeof Ce=="string"){const ye=parseInt(Ce,10);!isNaN(ye)&&ye>je&&(je=ye)}}}if(l.drawing?.componentsBottom&&Array.isArray(l.drawing.componentsBottom)){for(const ve of l.drawing.componentsBottom)if(ve.pinConnections&&Array.isArray(ve.pinConnections)){for(const Ce of ve.pinConnections)if(Ce&&typeof Ce=="string"){const ye=parseInt(Ce,10);!isNaN(ye)&&ye>je&&(je=ye)}}}if(l.drawing?.grounds&&Array.isArray(l.drawing.grounds))for(const ve of l.drawing.grounds)ve.pointId&&typeof ve.pointId=="number"&&ve.pointId>je&&(je=ve.pointId);if(l.drawing?.powers&&Array.isArray(l.drawing.powers))for(const ve of l.drawing.powers)ve.pointId&&typeof ve.pointId=="number"&&ve.pointId>je&&(je=ve.pointId);const ne=je+1,Te=rg();Te<ne&&(console.warn(`pointIdCounter was ${Te} but max existing ID is ${je}. Correcting to ${ne}.`),Vp(ne)),Ra.current=!1,Ga(!1),ri(!1),setTimeout(()=>{Bd.current=!1},100)}catch(N){console.error("Failed to open project",N),alert("Failed to open project file. See console for details."),Bd.current=!1}},[I,rt,Pi,m,_,Vp,qo,Rs,Co,ns,Ls,fa,Ms,Ea,Vs,co,Go,qs,k,q,Q,_i,xr,Ho,ra,pa,Ro,At,Li,Si,Fn,bt,dn,fn,hc,or,og,x2,Ff,la,zr,Gr]),au=L.useCallback(async()=>{},[_l]),il=L.useCallback(async l=>{const y=no.current;if(!y){console.warn("Cannot load file: no directory handle");return}try{const B=await(await y.getFileHandle(l)).getFile();if(B.size===0){console.warn(`File ${l} is empty, skipping`);const Te=Xo.current.filter(ve=>ve!==l);Qs(Te),Xo.current=Te;return}const le=await B.text();if(!le||le.trim().length===0){console.warn(`File ${l} contains no data, skipping`);const Te=Xo.current.filter(ve=>ve!==l);Qs(Te),Xo.current=Te;return}let ge;try{ge=JSON.parse(le)}catch(ne){console.error(`Failed to parse JSON from file ${l}:`,ne);const ve=Xo.current.filter(Ce=>Ce!==l);Qs(ve),Xo.current=ve,await au();return}ds(),si(1),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),mn(new Set),bn(new Set),_n(new Set),Tn(new Set),uc(),await qa(ge),aa(l);const je=Xo.current.indexOf(l);je>=0?(Xl(je),Rc.current=je):await au(),Ra.current=!1,Ga(!1)}catch(N){console.error("Failed to load file from history:",N);const B=Xo.current;if(B.includes(l)){const le=B.filter(ge=>ge!==l);Qs(le),Xo.current=le,await au()}}},[qa,au,uc]),ou=L.useCallback(async l=>{if(!Pi){console.warn("Cannot restore file: no project directory handle"),alert("No project directory available. Please open or create a project first.");return}try{let y;try{y=await Pi.getDirectoryHandle("history")}catch(A){console.error("History directory not found:",A),alert("History directory not found.");return}const B=await(await y.getFileHandle(l)).getFile();if(B.size===0){alert(`File ${l} is empty.`);return}const le=await B.text();if(!le||le.trim().length===0){alert(`File ${l} contains no data.`);return}let ge;try{ge=JSON.parse(le)}catch(A){console.error(`Failed to parse JSON from file ${l}:`,A),alert(`Failed to parse file ${l}. It may be corrupted.`);return}ds(),si(1),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),mn(new Set),bn(new Set),_n(new Set),Tn(new Set),uc(),await qa(ge),aa(l),Ra.current=!1,console.log(`Successfully restored file: ${l}`)}catch(y){console.error("Failed to restore file from history:",y),alert(`Failed to restore file ${l}. Please try again.`)}},[Pi,qa,mn,bn,_n,Tn,aa,si,ds,uc]);Pt.useEffect(()=>{Ve&&!ft&&Je({x:window.innerWidth/2-300,y:window.innerHeight/2-250})},[Ve,ft]);const pc=L.useCallback(l=>{if(!ft)return;wt(!0);const y=l.clientX-ft.x,N=l.clientY-ft.y,B=ge=>{Je({x:ge.clientX-y,y:ge.clientY-N})},le=()=>{wt(!1),document.removeEventListener("mousemove",B),document.removeEventListener("mouseup",le)};document.addEventListener("mousemove",B),document.addEventListener("mouseup",le)},[ft]);L.useCallback(async()=>{const l=Rc.current,y=Xo.current;if(l>=0&&l<y.length-1){const N=l+1,B=y[N];B&&await il(B)}},[il]),L.useCallback(async()=>{const l=Rc.current,y=Xo.current;if(l<=0||l>=y.length||y.length===0){console.warn("Cannot navigate to newer file: index is",l,"history length is",y.length);return}if(l>0&&l<y.length&&y.length>0){const N=l-1;if(N>=0&&N<y.length){const B=y[N];B?await il(B):(console.warn("No newer file found at index",N),await au())}else console.warn("Cannot navigate to newer file: prevIndex",N,"is out of bounds")}},[il,au]),Pt.useEffect(()=>{In.current=Kt},[Kt]);const id=Pt.useRef(rt),rd=Pt.useRef(Lt);Pt.useEffect(()=>{const l=rt!==id.current;if(I==="draw"&&id.current==="trace"&&l){if(In.current.length>=2){Ji(Qe,tn,cn,Gt,wn);const y={id:`${Date.now()}-trace-autofinalize`,points:In.current,color:F,size:U,layer:rd.current,type:"trace"};At(N=>[...N,y]),rd.current==="top"?za(N=>[...N,y.id]):Fo(N=>[...N,y.id])}Qt([]),xn(!1)}id.current=rt,rd.current=Lt},[rt,Lt,I,F,U]);const rl=Pt.useRef(I);Pt.useEffect(()=>{if(rl.current==="draw"&&I!=="draw"&&rt==="trace"&&In.current.length>=2){const l={id:`${Date.now()}-trace-autofinalize`,points:In.current,color:F,size:U,layer:Lt,type:"trace"};At(y=>[...y,l]),Lt==="top"?za(y=>[...y,l.id]):Fo(y=>[...y,l.id]),Qt([]),xn(!1)}rl.current=I},[I,rt,F,U,Lt]);const kf=Pt.useMemo(()=>r2,[]);Pt.useEffect(()=>{ku()},[Qe]),Pt.useEffect(()=>{ku()},[tn,cn,te,ai]);const rn=Za>0,Fl=L.useCallback(async()=>{const l=window;if(typeof l.showOpenFilePicker=="function")try{const[y]=await l.showOpenFilePicker({multiple:!1}),N=await y.getFile();if(!N.name.toLowerCase().endsWith(".json")){alert("Please select a .json project file.");return}nd.current=!0,iu(),await new Promise(ne=>setTimeout(ne,0)),aa(N.name);const B=await N.text(),le=JSON.parse(B);nd.current=!0;let ge=null;try{if(typeof y.getParent=="function")ge=await y.getParent();else{console.warn("getParent() not available. Prompting user for directory access...");const ne=window;if(typeof ne.showDirectoryPicker=="function")ge=await ne.showDirectoryPicker({startIn:y});else throw new Error("Directory picker not available in this browser")}if(ge)try{if((await(await ge.getFileHandle(N.name)).getFile()).name!==N.name)throw new Error("Directory verification failed: file name mismatch")}catch(ne){throw console.error("Directory verification failed:",ne),console.error("The selected directory might not contain the opened file"),new Error("Directory verification failed - selected directory does not contain the opened file")}if(va(ge),Ol.current=ge,ge)try{await ge.getDirectoryHandle("history",{create:!0}),await ge.getDirectoryHandle("images",{create:!0}),await ge.getDirectoryHandle("datasheets",{create:!0}),console.log("Created/verified project subdirectories: history, images, datasheets")}catch(ne){console.error("Failed to create/verify project subdirectories:",ne)}}catch(ne){console.error("Failed to get directory handle from file handle:",ne)}finally{setTimeout(()=>{nd.current=!1},1e3)}const A=le.autoSave?.enabled===!0;await qa(le,ge);let je;if(le.projectInfo?.name?je=le.projectInfo.name:(je=N.name.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_")||"pcb_project",hr(je)),oa||hr(je),A&&ge){const ne=je.replace(/\.json$/i,""),ve=ad(ne).replace(/[^a-zA-Z0-9_-]/g,"_");pa(ge),Ro(ve),no.current=ge,wl.current=ve,bi.current&&(clearInterval(bi.current),bi.current=null)}setTimeout(()=>{kr({visible:!0,source:"open",interval:5})},100)}catch(y){if(y?.name==="AbortError")return;console.warn("showOpenFilePicker failed, falling back to input",y),hl.current?.click()}else hl.current?.click()},[qa,oa,aa,hr,va,kr,Xa,pa,Ro,iu]),su=L.useCallback(async()=>{Po({visible:!1}),await ta(),await Fl()},[ta,Fl]),_u=L.useCallback(async()=>{Po({visible:!1}),await Fl()},[Fl]),vp=L.useCallback(()=>{Po({visible:!1})},[]);Pt.useEffect(()=>{if(bc.visible){setTimeout(()=>{el.current?.focus()},0);const l=y=>{y.key==="Enter"?(y.preventDefault(),su()):y.key==="Escape"&&(y.preventDefault(),Po({visible:!1}))};return window.addEventListener("keydown",l),()=>{window.removeEventListener("keydown",l)}}},[bc.visible,su]);const wp=L.useCallback(async()=>{Fr()?Po({visible:!0}):await Fl()},[Fr,Fl]);return r?n.jsxs("div",{className:"app",children:[n.jsxs("header",{className:"app-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsx("h1",{children:" PCB Tracer (v3.1)"}),n.jsxs("button",{onClick:v,style:{background:"rgba(255, 255, 255, 0.2)",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"6px",color:"white",padding:"8px 16px",fontSize:"14px",fontWeight:500,cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"6px"},onMouseEnter:l=>{l.currentTarget.style.background="rgba(255, 255, 255, 0.3)"},onMouseLeave:l=>{l.currentTarget.style.background="rgba(255, 255, 255, 0.2)"},title:s?.email?`Logged in as ${s.email}`:"Logout",children:[n.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[n.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),n.jsx("polyline",{points:"16 17 21 12 16 7"}),n.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"Logout"]})]}),n.jsx(wv,{openMenu:is,setOpenMenu:No,isReadOnlyMode:rn,currentProjectFilePath:_l,isProjectActive:!!Pi,autoSaveEnabled:Xa,autoSaveInterval:Wo,hasUnsavedChangesState:as,onNewProject:yo,onOpenProject:wp,onSaveProject:ta,onPrint:pp,onExportBOM:hp,bomExportFormat:pe,setBomExportFormat:Y,hasUnsavedChanges:Fr,setNewProjectDialog:pr,setAutoSaveDialog:Ao,onShowGeminiSettings:()=>xl(!0),topImage:g,bottomImage:S,setCurrentTool:oe,resetImageTransform:Pd,areImagesLocked:Cr,setAreImagesLocked:qo,onEnterBoardDimensions:()=>cs(!0),fileInputTopRef:pl,fileInputBottomRef:wc,openProjectRef:hl,increaseSize:_d,decreaseSize:Qu,brushSize:U,drawingStrokes:Qe,selectedIds:ii,selectedComponentIds:$n,selectedPowerIds:mi,selectedGroundIds:Yn,componentsTop:tn,componentsBottom:cn,powers:J,grounds:te,powerNodeNames:np,groundNodeNames:ip,setSetSizeDialog:Al,areViasLocked:da,setAreViasLocked:Rs,arePadsLocked:Xr,setArePadsLocked:Co,areTestPointsLocked:ko,setAreTestPointsLocked:Ds,areTracesLocked:Vi,setAreTracesLocked:ns,areComponentsLocked:Kr,setAreComponentsLocked:Ls,areGroundNodesLocked:Vr,setAreGroundNodesLocked:fa,arePowerNodesLocked:Qi,setArePowerNodesLocked:Ms,showTraceCornerDots:yr,setShowTraceCornerDots:Oi,setSelectedIds:mn,setSelectedComponentIds:bn,setSelectedPowerIds:_n,setSelectedGroundIds:Tn,selectAllVias:vu,selectAllTraces:oc,selectAllPads:vd,selectAllComponents:zc,selectDisconnectedComponents:Pc,selectAllComponentConnections:Zf,selectAllPowerNodes:df,selectAllGroundNodes:rp,selectPowerNodesByName:ap,selectGroundNodesByName:xh,setShowPowerBusManager:Fe,setShowGroundBusManager:ni,setShowPastMachine:Ke,toolRegistry:vn,updateToolSettings:Dr,updateToolLayerSettings:Xs,setBrushSize:O,setBrushColor:R,saveToolSettings:Mx,saveToolLayerSettings:Kd,colorPalette:kf,currentTool:I,drawingMode:rt,traceToolLayer:Jn,padToolLayer:di,testPointToolLayer:Di,componentToolLayer:ir,setTopTraceSize:de,setBottomTraceSize:z,setTopPadSize:Le,setBottomPadSize:Ue,setTopTestPointSize:kt,setBottomTestPointSize:Wt,setTopComponentSize:Nn,setBottomComponentSize:Ee,setComponentConnectionSize:_t,topTraceColor:_e,bottomTraceColor:xe,topPadColor:G,bottomPadColor:ie,topTestPointColor:et,bottomTestPointColor:Ct,topComponentColor:ht,bottomComponentColor:Ut,setTopTraceColor:ce,setBottomTraceColor:fe,setTopPadColor:V,setBottomPadColor:he,setTopTestPointColor:ot,setBottomTestPointColor:Ot,setTopComponentColor:Xe,setBottomComponentColor:an,setComponentConnectionColor:Mt,saveDefaultSize:Ze,saveDefaultColor:jt,menuBarRef:Vc,onOpenProjectNotes:ru,onOpenTestPoints:Or,onOpenTransformImages:()=>ys(!0),onOpenTransformAll:()=>_o(!0)}),n.jsx("div",{style:{display:"block",padding:0,margin:0,width:"100vw",height:"calc(100vh - 70px)",boxSizing:"border-box",position:"relative"},children:n.jsxs("div",{ref:jc,style:{position:"relative",width:"100%",height:"100%",margin:0,padding:0,boxSizing:"border-box",background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",borderRadius:"16px",overflow:"hidden"},children:[n.jsxs("div",{style:{position:"absolute",top:6,left:6,bottom:6,width:46,display:"flex",flexDirection:"column",gap:8,padding:"6px 3px",background:"rgba(250,250,255,0.95)",borderRadius:8,border:"1px solid #ddd",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:20},children:[n.jsxs("button",{onClick:()=>{rn||nu()},onMouseDown:l=>l.currentTarget.blur(),disabled:rn,title:"Select (S)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:I==="select"?"2px solid #000":"1px solid #ddd",background:I==="select"?"#e6f0ff":"#fff",color:rn?"#999":"#222",outline:"none",cursor:rn?"not-allowed":"pointer",opacity:rn?.5:1},children:[n.jsx(e2,{size:14}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"S"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),n.jsxs("button",{onMouseDown:l=>{if(l.altKey&&!rn){l.preventDefault(),l.stopPropagation(),nl(!1),ho(!0);return}},onClick:l=>{!rn&&!l.altKey&&(console.log("Via tool clicked"),Cn(),ln("via"),oe("draw"),Ea(!0))},disabled:rn,title:"Draw Vias (V), Option+click for Pattern Placement",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:I==="draw"&&rt==="via"?"2px solid #000":"1px solid #ddd",background:I==="draw"&&rt==="via"?"#e6f0ff":"#fff",color:rn?"#999":"#222",cursor:rn?"not-allowed":"pointer",opacity:rn?.5:1},children:[n.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const l=Hn.get("via").color;return n.jsxs(n.Fragment,{children:[n.jsx("circle",{cx:"12",cy:"12",r:"8",fill:"none",stroke:l,strokeWidth:"3"}),n.jsx("circle",{cx:"12",cy:"12",r:"4",fill:l})]})})()}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"V"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:Hn.get("via").size})]})]}),n.jsxs("button",{ref:Xu,onMouseDown:l=>{if(l.altKey&&!rn){l.preventDefault(),l.stopPropagation(),nl(!0),ho(!0);return}},onClick:l=>{!rn&&!l.altKey&&(console.log("Pad tool clicked"),Cn(),ln("pad"),oe("draw"),setTimeout(()=>ed(),0))},disabled:rn,title:"Draw Pads (P), Option+click for Pattern Placement",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:I==="draw"&&rt==="pad"?"2px solid #000":"1px solid #ddd",background:I==="draw"&&rt==="pad"?"#e6f0ff":"#fff",color:rn?"#999":"#222",cursor:rn?"not-allowed":"pointer",opacity:rn?.5:1},children:[n.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const y=di==="top"?"padTop":"padBottom",N=Hn.get(y).color,B=14,le=(24-B)/2,ge=(24-B)/2;return n.jsx("rect",{x:le,y:ge,width:B,height:B,fill:N})})()}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"P"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{if(I==="draw"&&rt==="pad"&&Tr.toolInstanceId&&(Tr.toolInstanceId==="padTop"||Tr.toolInstanceId==="padBottom"))return Tr.size;const l=di==="top"?"padTop":"padBottom";return Hn.get(l).size})()})]})]}),n.jsxs("button",{ref:Ku,onClick:()=>{rn||(console.log("Test Point tool clicked"),Cn(),ln("testPoint"),oe("draw"),setTimeout(()=>Ld(),0))},disabled:rn,title:"Draw Test Points (Y)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:I==="draw"&&rt==="testPoint"?"2px solid #000":"1px solid #ddd",background:I==="draw"&&rt==="testPoint"?"#e6f0ff":"#fff",color:rn?"#999":"#222",cursor:rn?"not-allowed":"pointer",opacity:rn?.5:1},children:[n.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const y=Di==="top"?"testPointTop":"testPointBottom",N=Hn.get(y).color,B=14,le=12,ge=12;return n.jsx("path",{d:`M ${le} ${ge-B/2} L ${le+B/2} ${ge} L ${le} ${ge+B/2} L ${le-B/2} ${ge} Z`,fill:N,stroke:"#000",strokeWidth:"1.5"})})()}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"Y"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{if(I==="draw"&&rt==="testPoint"&&Tr.toolInstanceId&&(Tr.toolInstanceId==="testPointTop"||Tr.toolInstanceId==="testPointBottom"))return Tr.size;const l=Di==="top"?"testPointTop":"testPointBottom";return Hn.get(l).size})()})]})]}),n.jsxs("button",{ref:Gu,onClick:()=>{rn||(console.log("Trace tool clicked"),Cn(),ln("trace"),oe("draw"),setTimeout(()=>vl(),0))},disabled:rn,title:"Draw Traces (T)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:I==="draw"&&rt==="trace"?"2px solid #000":"1px solid #ddd",background:I==="draw"&&rt==="trace"?"#e6f0ff":"#fff",color:rn?"#999":"#222",cursor:rn?"not-allowed":"pointer",opacity:rn?.5:1},children:[n.jsx(n2,{size:14,color:(()=>{const y=Jn==="top"?"traceTop":"traceBottom";return Hn.get(y).color})()}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"T"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{const l=Jn==="top"?"traceTop":"traceBottom";return Hn.get(l).size})()})]})]}),n.jsxs("button",{ref:Cd,onClick:()=>{rn||(console.log("Component tool clicked"),Cn(),oe("component"))},disabled:rn,title:"Draw Component (C)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:I==="component"?"2px solid #000":"1px solid #ddd",background:I==="component"?"#e6f0ff":"#fff",color:rn?"#999":"#222",cursor:rn?"not-allowed":"pointer",opacity:rn?.5:1},children:[(()=>{const y=(ir||"top")==="top"?"componentTop":"componentBottom",N=Hn.get(y).color;return Ss?n.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[n.jsx("rect",{x:"4",y:"4",width:"16",height:"16",fill:"rgba(255,255,255,0.9)",stroke:N,strokeWidth:"1.5"}),n.jsx("text",{x:"12",y:"14",textAnchor:"middle",fontSize:"7",fill:N,fontWeight:"bold",fontFamily:"monospace",children:(()=>{const B=Bl?.componentDefinition?.designator??Bl?.designator;return B?B.length<=3?B:B.substring(0,3):zg(Ss)})()})]}):n.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[n.jsx("rect",{x:"5",y:"3",width:"14",height:"7",fill:N,stroke:N,strokeWidth:"0.5"}),n.jsxs("g",{stroke:N,fill:"none",strokeWidth:"1.5",children:[n.jsx("rect",{x:"5",y:"10",width:"14",height:"4",rx:"1.2"}),n.jsx("path",{d:"M7 14 v4 M10 14 v4 M13 14 v4 M16 14 v4",stroke:N})]})]})})(),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"C"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{const l=ir==="top"?"componentTop":"componentBottom";return Hn.get(l).size})()})]})]}),n.jsxs("button",{ref:kd,onClick:()=>{rn||(console.log("Power tool clicked"),Cn(),yn(!1),Ie.length===1?(nn(Ie[0].id),oe("power"),vt(!1),Q(!0)):Ie.length>1?vt(!0):(vt(!0),oe("power"),Q(!0)))},disabled:rn,title:"Draw Power (B)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:I==="power"?"2px solid #000":"1px solid #ddd",background:I==="power"?"#e6f0ff":"#fff",color:rn?"#999":"#222",cursor:rn?"not-allowed":"pointer",opacity:rn?.5:1},children:[n.jsx("span",{style:{color:(sn?Ie.find(l=>l.id===sn)?.color:null)||"#ff0000",fontSize:"18px",fontWeight:"bold",lineHeight:1,flexShrink:0},children:"V"}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"B"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:Hn.get("power").size})]})]}),n.jsxs("button",{ref:Zu,onClick:()=>{rn||(console.log("Ground tool clicked"),vt(!1),gt.length===1?(Bi(gt[0].id),oe("ground"),yn(!1),_i(!0)):gt.length>1?yn(!0):(yn(!0),oe("ground"),_i(!0)))},disabled:rn,title:"Draw Ground (G)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:I==="ground"?"2px solid #000":"1px solid #ddd",background:I==="ground"?"#e6f0ff":"#fff",color:rn?"#999":"#222",cursor:rn?"not-allowed":"pointer",opacity:rn?.5:1},children:[n.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 20","aria-hidden":"true",style:{overflow:"visible",flexShrink:0},children:n.jsxs("g",{stroke:(Un?gt.find(l=>l.id===Un)?.color:null)||"#000000",strokeWidth:"2",strokeLinecap:"round",children:[n.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"10"}),n.jsx("line",{x1:"5",y1:"10",x2:"19",y2:"10"}),n.jsx("line",{x1:"7",y1:"13",x2:"17",y2:"13"}),n.jsx("line",{x1:"9.5",y1:"16",x2:"14.5",y2:"16"})]})}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"G"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:Hn.get("ground").size})]})]}),n.jsx("div",{style:{height:32}}),n.jsxs("button",{onClick:()=>{rn||(Cn(),oe(l=>l==="pan"?"draw":"pan"))},disabled:rn,title:"Move (H)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:6,padding:"4px 6px",borderRadius:6,border:I==="pan"?"2px solid #000":"1px solid #ddd",background:I==="pan"?"#e6f0ff":"#fff",color:rn?"#999":"#222",cursor:rn?"not-allowed":"pointer",opacity:rn?.5:1},children:[n.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:n.jsxs("g",{stroke:"#111",fill:"none",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round",children:[n.jsx("path",{d:"M8 11v-4c0-.8.6-1.3 1.3-1.3S11 6.2 11 7v4"}),n.jsx("path",{d:"M11 11V6.5c0-.8.6-1.3 1.3-1.3S14 5.7 14 6.5V11"}),n.jsx("path",{d:"M14 11V7.2c0-.8.6-1.3 1.3-1.3.7 0 1.3.5 1.3 1.3V12c1 .6 1.6 1.5 1.6 2.7A4.3 4.3 0 0 1 14 19H9.2A4.2 4.2 0 0 1 5 14.8V11c0-.6.4-1 .9-1 .6 0 1 .4 1 1v2"})]})}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"H"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),n.jsxs("button",{onClick:()=>{Cn(),Fs(!1),oe(l=>l==="magnify"?"draw":"magnify")},title:"Magnify (M)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:I==="magnify"?"2px solid #000":"1px solid #ddd",background:I==="magnify"?"#e6f0ff":"#fff",color:"#222",cursor:"pointer"},children:[n.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[n.jsx("circle",{cx:"10",cy:"10",r:"7.5",fill:"none",stroke:"#111",strokeWidth:"2"}),n.jsx("line",{x1:"15.5",y1:"15.5",x2:"21",y2:"21",stroke:"#111",strokeWidth:"2",strokeLinecap:"round"}),Do?n.jsx("line",{x1:"6.5",y1:"10",x2:"13.5",y2:"10",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"}):n.jsxs(n.Fragment,{children:[n.jsx("line",{x1:"6.5",y1:"10",x2:"13.5",y2:"10",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"}),n.jsx("line",{x1:"10",y1:"6.5",x2:"10",y2:"13.5",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"})]})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"M"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),n.jsxs("button",{onClick:()=>{rn||_o(!0)},disabled:rn,title:"Change Perspective (E) - Open Change Perspective Dialog",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:_a?"2px solid #000":"1px solid #ddd",background:_a?"#e6f0ff":"#fff",color:rn?"#999":"#222",cursor:rn?"not-allowed":"pointer",opacity:rn?.5:1},children:[n.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[n.jsx("ellipse",{cx:"12",cy:"12",rx:"9",ry:"6",fill:"none",stroke:"#111",strokeWidth:"2"}),n.jsx("circle",{cx:"12",cy:"12",r:"4",fill:"none",stroke:"#111",strokeWidth:"2"}),n.jsx("circle",{cx:"11",cy:"11",r:"1.5",fill:"#111",stroke:"none"})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"E"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),n.jsxs("button",{onClick:()=>{rn||(Cn(),oe("center"),Us(!0),Ma.current&&clearTimeout(Ma.current),Ma.current=setTimeout(()=>{Us(!1),oe("select"),So(void 0)},2e3))},disabled:rn,title:"Set View (X) - Press 0-9 to Set View",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:I==="center"?"2px solid #000":"1px solid #ddd",background:I==="center"?"#e6f0ff":"#fff",color:rn?"#999":"#222",cursor:rn?"not-allowed":"pointer",opacity:rn?.5:1},children:[n.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[n.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"10",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),n.jsx("line",{x1:"12",y1:"14",x2:"12",y2:"22",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),n.jsx("line",{x1:"2",y1:"12",x2:"10",y2:"12",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),n.jsx("line",{x1:"14",y1:"12",x2:"22",y2:"12",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"X"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onClick:()=>{rn||Vo(l=>!l)},disabled:rn,title:"Color Picker",style:{width:32,height:32,display:"grid",placeItems:"center",borderRadius:6,border:"1px solid #ddd",background:"#fff",cursor:rn?"not-allowed":"pointer",opacity:rn?.5:1},children:n.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 16 16","aria-hidden":"true",children:[n.jsx("rect",{x:"0",y:"0",width:"3.5",height:"3.5",fill:"#9E9E9E",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"4",y:"0",width:"3.5",height:"3.5",fill:"#0072B2",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"8",y:"0",width:"3.5",height:"3.5",fill:"#56B4E9",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"12",y:"0",width:"3.5",height:"3.5",fill:"#00BFC4",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"0",y:"4",width:"3.5",height:"3.5",fill:"#6A3D9A",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"4",y:"4",width:"3.5",height:"3.5",fill:"#2CA02C",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"8",y:"4",width:"3.5",height:"3.5",fill:"#7FC97F",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"12",y:"4",width:"3.5",height:"3.5",fill:"#FF7F0E",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"0",y:"8",width:"3.5",height:"3.5",fill:"#FFD700",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"4",y:"8",width:"3.5",height:"3.5",fill:"#FF6B6B",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"8",y:"8",width:"3.5",height:"3.5",fill:"#E74C3C",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"12",y:"8",width:"3.5",height:"3.5",fill:"#FFB6C1",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"0",y:"12",width:"3.5",height:"3.5",fill:"#DDA0DD",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"4",y:"12",width:"3.5",height:"3.5",fill:"#8B4513",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"8",y:"12",width:"3.5",height:"3.5",fill:"#A0522D",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"12",y:"12",width:"3.5",height:"3.5",fill:"#FF4500",stroke:"#ccc",strokeWidth:"0.3"})]})}),Pl&&n.jsx("div",{ref:gl,style:{position:"absolute",left:42,top:0,padding:8,background:"#fff",border:"1px solid #ddd",borderRadius:6,boxShadow:"0 8px 18px rgba(0,0,0,0.18)",zIndex:50},children:n.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(8, 22px)",gap:4},children:kf.map(l=>n.jsx("div",{onClick:()=>{R(l),Vo(!1);try{let N=null;I==="draw"&&rt==="via"?N="via":I==="draw"&&rt==="pad"?N=(di||"top")==="bottom"?"padBottom":"padTop":I==="draw"&&rt==="testPoint"?N=(Di||"top")==="bottom"?"testPointBottom":"testPointTop":I==="draw"&&rt==="trace"?N=(Jn||"top")==="bottom"?"traceBottom":"traceTop":I==="component"?N=(ir||"top")==="bottom"?"componentBottom":"componentTop":I==="power"?N="power":I==="ground"&&(N="ground"),N&&Hn.setColor(N,l)}catch(N){console.error("Error updating tool instance color:",N)}const y=ui(vn);if(y)if(I==="draw"&&rt==="trace"){const N=Jn||"top",le=y.layerSettings.get(N)?.size||y.settings.size,ge={color:l,size:le};Xs(y.id,N,ge),Kd(y.id),N==="top"?(ce(l),jt("trace",l,"top")):(fe(l),jt("trace",l,"bottom"))}else if(I==="draw"&&rt==="pad"){const N=di||"top",le=y.layerSettings.get(N)?.size||y.settings.size,ge={color:l,size:le};Xs(y.id,N,ge),Kd(y.id),N==="top"?(V(l),jt("pad",l,"top")):(he(l),jt("pad",l,"bottom"))}else if(I==="draw"&&rt==="testPoint"){const N=Di||"top",le=y.layerSettings.get(N)?.size||y.settings.size,ge={color:l,size:le};Xs(y.id,N,ge),Kd(y.id),N==="top"?(ot(l),jt("testPoint",l,"top")):(Ot(l),jt("testPoint",l,"bottom"))}else if(I==="component"){const N=ir||"top",le=y.layerSettings.get(N)?.size||y.settings.size,ge={color:l,size:le};Xs(y.id,N,ge),Kd(y.id),N==="top"?(Xe(l),jt("component",l,"top")):(an(l),jt("component",l,"bottom"))}else{const N={...y.settings,color:l};Dr(y.id,N),Mx(y.id,l,y.settings.size),I==="draw"&&rt==="via"&&jt("via",l)}jt("brush",l),ii.size>0&&At(N=>N.map(B=>ii.has(B.id)?(B.type==="via"?(jt("via",l),wi(le=>{const ge=new Map(le),A=ge.get("via");return A&&ge.set("via",{...A,settings:{...A.settings,color:l}}),ge})):B.type==="pad"?(jt("pad",l),wi(le=>{const ge=new Map(le),A=ge.get("pad");return A&&ge.set("pad",{...A,settings:{...A.settings,color:l}}),ge})):B.type==="trace"&&jt("trace",l,B.layer),{...B,color:l}):B)),$n.size>0&&(jt("component",l),Li(N=>N.map(B=>$n.has(B.id)?{...B,color:l}:B)),Si(N=>N.map(B=>$n.has(B.id)?{...B,color:l}:B))),mi.size>0&&fn(N=>N.map(B=>mi.has(B.id)?{...B,color:l}:B)),Yn.size>0&&Fn(N=>N.map(B=>Yn.has(B.id)?{...B,color:l}:B))},title:l,style:{width:22,height:22,backgroundColor:l,border:l===F?"2px solid #333":"1px solid #ccc",cursor:"pointer"}},l))})})]}),n.jsx("div",{style:{height:32}}),n.jsx("button",{onClick:()=>{rn||ru()},disabled:rn,title:"Project Notes",style:{width:32,height:32,display:"grid",placeItems:"center",borderRadius:6,border:"1px solid #ddd",background:"#fff",cursor:rn?"not-allowed":"pointer",opacity:rn?.5:1},children:n.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[n.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2",fill:"#fff",stroke:"#FFD700",strokeWidth:"1"}),n.jsx("circle",{cx:"6",cy:"7",r:"1.5",fill:"#000"}),n.jsx("rect",{x:"9",y:"6",width:"8",height:"2",rx:"1",fill:"#000"}),n.jsx("circle",{cx:"6",cy:"11",r:"1.5",fill:"#000"}),n.jsx("rect",{x:"9",y:"10",width:"8",height:"2",rx:"1",fill:"#000"}),n.jsx("circle",{cx:"6",cy:"15",r:"1.5",fill:"#000"}),n.jsx("rect",{x:"9",y:"14",width:"8",height:"2",rx:"1",fill:"#000"}),n.jsx("circle",{cx:"6",cy:"19",r:"1.5",fill:"#000"}),n.jsx("rect",{x:"9",y:"18",width:"8",height:"2",rx:"1",fill:"#000"})]})}),n.jsx("button",{onClick:()=>{rn||Or()},disabled:rn,title:"Test Points",style:{width:32,height:32,display:"grid",placeItems:"center",borderRadius:6,border:"1px solid #ddd",background:"#fff",cursor:rn?"not-allowed":"pointer",opacity:rn?.5:1},children:n.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[n.jsx("rect",{width:"24",height:"24",fill:"#FFD700"}),n.jsx("circle",{cx:"6",cy:"7",r:"1.5",fill:"#000"}),n.jsx("rect",{x:"9",y:"6",width:"8",height:"2",rx:"1",fill:"#000"}),n.jsx("circle",{cx:"6",cy:"11",r:"1.5",fill:"#000"}),n.jsx("rect",{x:"9",y:"10",width:"8",height:"2",rx:"1",fill:"#000"}),n.jsx("circle",{cx:"6",cy:"15",r:"1.5",fill:"#000"}),n.jsx("rect",{x:"9",y:"14",width:"8",height:"2",rx:"1",fill:"#000"}),n.jsx("circle",{cx:"6",cy:"19",r:"1.5",fill:"#000"}),n.jsx("rect",{x:"9",y:"18",width:"8",height:"2",rx:"1",fill:"#000"})]})})]}),I==="draw"&&rt==="trace"&&wu&&n.jsxs("div",{ref:_c,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[n.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[n.jsx("input",{type:"radio",name:"traceToolLayer",checked:Jn==="top",onChange:()=>{console.log("Trace tool Top clicked"),vo.current="top",ma("top"),Zn("top"),R(_e),O(ke),wi(l=>{const y=new Map(l),N=y.get("trace");return N&&y.set("trace",{...N,settings:{color:_e,size:ke}}),y}),Jc(!1),Zr(!0),Go(!0)}}),n.jsx("span",{children:"Top"})]}),n.jsxs("label",{className:"radio-label",children:[n.jsx("input",{type:"radio",name:"traceToolLayer",checked:Jn==="bottom",onChange:()=>{console.log("Trace tool Bottom clicked"),vo.current="bottom",ma("bottom"),Zn("bottom"),R(xe),O(C),wi(l=>{const y=new Map(l),N=y.get("trace");return N&&y.set("trace",{...N,settings:{color:xe,size:C}}),y}),Jc(!1),ha(!0),qs(!0)}}),n.jsx("span",{children:"Bottom"})]})]}),I==="draw"&&rt==="pad"&&$u&&n.jsxs("div",{ref:ju,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[n.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[n.jsx("input",{type:"radio",name:"padToolLayer",checked:di==="top",onChange:()=>{console.log("Pad tool Top clicked"),Ha.current="top",As("top"),Zn("top");const l=Hn.get("padTop");R(l.color),O(l.size),wi(y=>{const N=new Map(y),B=N.get("pad");return B&&N.set("pad",{...B,settings:{color:l.color,size:l.size}}),N}),Su(!1),Zr(!0),Vs(!0)}}),n.jsx("span",{children:"Top"})]}),n.jsxs("label",{className:"radio-label",children:[n.jsx("input",{type:"radio",name:"padToolLayer",checked:di==="bottom",onChange:()=>{console.log("Pad tool Bottom clicked"),Ha.current="bottom",As("bottom"),Zn("bottom");const l=Hn.get("padBottom");R(l.color),O(l.size),wi(y=>{const N=new Map(y),B=N.get("pad");return B&&N.set("pad",{...B,settings:{color:l.color,size:l.size}}),N}),Su(!1),ha(!0),co(!0)}}),n.jsx("span",{children:"Bottom"})]})]}),I==="draw"&&rt==="testPoint"&&pf&&n.jsxs("div",{ref:sc,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[n.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[n.jsx("input",{type:"radio",name:"testPointToolLayer",checked:Di==="top",onChange:()=>{console.log("Test Point tool Top clicked"),Ti.current="top",zs("top"),Zn("top"),R(et),O(se),wi(l=>{const y=new Map(l),N=y.get("testPoint");return N&&y.set("testPoint",{...N,settings:{color:et,size:se}}),y}),Yu(!1),Zr(!0),ls(!0)}}),n.jsx("span",{children:"Top"})]}),n.jsxs("label",{className:"radio-label",children:[n.jsx("input",{type:"radio",name:"testPointToolLayer",checked:Di==="bottom",onChange:()=>{console.log("Test Point tool Bottom clicked"),Ti.current="bottom",zs("bottom"),Zn("bottom"),R(Ct),O(Jt),wi(l=>{const y=new Map(l),N=y.get("testPoint");return N&&y.set("testPoint",{...N,settings:{color:Ct,size:Jt}}),y}),Yu(!1),ha(!0),f(!0)}}),n.jsx("span",{children:"Bottom"})]})]}),Dt&&n.jsxs("div",{ref:Tu,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25,minWidth:"200px"},children:[n.jsx("div",{style:{marginBottom:"4px",fontWeight:600,fontSize:"12px",color:"#333"},children:"Select Power Bus:"}),Ie.length===0?n.jsx("div",{style:{padding:"8px",color:"#666",fontSize:"12px"},children:"No power buses defined. Use Tools  Manage Power Buses to add one."}):[...Ie].sort((l,y)=>{const N=ge=>{const A=ge.match(/([+-]?)(\d+\.?\d*)/);if(A){const je=A[1]||"+",ne=parseFloat(A[2]);return{absValue:Math.abs(ne),isNegative:je==="-",original:ge}}return{absValue:1/0,isNegative:!1,original:ge}},B=N(l.voltage),le=N(y.voltage);return B.absValue!==le.absValue?B.absValue-le.absValue:B.isNegative!==le.isNegative?B.isNegative?-1:1:0}).map(l=>n.jsx("button",{onClick:y=>{y.preventDefault(),y.stopPropagation(),nn(l.id),I!=="power"&&(Cn(),oe("power"),Q(!0)),vt(!1)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#222"},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[n.jsx("div",{style:{width:16,height:16,borderRadius:"50%",background:l.color,border:"1px solid #ccc"}}),n.jsxs("div",{children:[n.jsx("div",{style:{fontWeight:600,fontSize:"13px"},children:l.name}),n.jsx("div",{style:{fontSize:"11px",color:"#666"},children:l.voltage})]})]})},l.id)),n.jsx("div",{style:{height:1,background:"#ddd",margin:"4px 0"}}),n.jsx("button",{onClick:l=>{l.preventDefault(),l.stopPropagation(),vt(!1),Fe(!0)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"11px"},children:"Manage Power Buses"}),n.jsx("button",{onClick:l=>{l.preventDefault(),l.stopPropagation(),vt(!1),nn(null),oe("select")},style:{display:"block",width:"100%",textAlign:"center",padding:"4px 6px",marginTop:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#666",fontSize:"11px"},children:"Cancel"})]}),Ar&&n.jsxs("div",{ref:Qc,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25,minWidth:"200px"},children:[n.jsx("div",{style:{marginBottom:"4px",fontWeight:600,fontSize:"12px",color:"#333"},children:"Select Ground Bus:"}),gt.length===0?n.jsx("div",{style:{padding:"8px",color:"#666",fontSize:"12px"},children:"No ground buses defined. Use Tools  Manage Ground Buses to add one."}):[...gt].sort((l,y)=>l.name.localeCompare(y.name)).map(l=>{const y=l.id==="groundbus-earth",N=Un===l.id;return n.jsx("button",{onClick:B=>{B.preventDefault(),B.stopPropagation(),Bi(l.id),I!=="ground"&&(Cn(),oe("ground"),_i(!0)),yn(!1)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:N?"#e0e0e0":"#f5f5f5",border:N?"2px solid #000":"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#222"},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[n.jsx("div",{style:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:y?n.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",style:{display:"block"},children:[n.jsx("line",{x1:"10",y1:"2",x2:"10",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),n.jsx("line",{x1:"4",y1:"10",x2:"16",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),n.jsx("line",{x1:"5",y1:"12.5",x2:"15",y2:"12.5",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),n.jsx("line",{x1:"6",y1:"15",x2:"14",y2:"15",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"})]}):n.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",style:{display:"block"},children:[n.jsx("circle",{cx:"10",cy:"10",r:"6",fill:"none",stroke:"#000",strokeWidth:"2"}),n.jsx("line",{x1:"10",y1:"2",x2:"10",y2:"18",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),n.jsx("line",{x1:"2",y1:"10",x2:"18",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"})]})}),n.jsx("div",{children:n.jsx("div",{style:{fontWeight:600,fontSize:"13px"},children:l.name})})]})},l.id)}),n.jsx("div",{style:{height:1,background:"#ddd",margin:"4px 0"}}),n.jsx("button",{onClick:l=>{l.preventDefault(),l.stopPropagation(),yn(!1),ni(!0)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"11px"},children:"Manage Ground Buses"}),n.jsx("button",{onClick:l=>{l.preventDefault(),l.stopPropagation(),yn(!1),Bi(null),oe("select")},style:{display:"block",width:"100%",textAlign:"center",padding:"4px 6px",marginTop:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#666",fontSize:"11px"},children:"Cancel"})]}),n.jsxs("div",{style:{position:"absolute",top:6,left:60,bottom:6,width:168,padding:6,display:"flex",flexDirection:"column",gap:2,background:"rgba(250,250,255,0.95)",borderRadius:8,border:"1px solid #ddd",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:3},children:[n.jsx("div",{style:{fontSize:11,fontWeight:700,color:"#333",marginBottom:2},children:"Layers"}),n.jsxs("div",{onClick:()=>Zn("top"),title:"Top layer",style:{cursor:"pointer",padding:2,borderRadius:4,border:jn==="top"?"2px solid #0b5fff":"1px solid #ddd",background:"#fff"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:2},children:[n.jsx("div",{style:{fontSize:10,color:"#444",fontWeight:600},children:"Top Image"}),n.jsx("label",{className:"radio-label",style:{margin:0},children:n.jsx("input",{type:"checkbox",checked:eo,onChange:l=>Zr(l.target.checked)})})]}),n.jsx("canvas",{ref:Jl,width:60,height:40,style:{width:"60px",height:"40px"}})]}),n.jsxs("div",{onClick:()=>Zn("bottom"),title:"Bottom layer",style:{cursor:"pointer",padding:2,borderRadius:4,border:jn==="bottom"?"2px solid #0b5fff":"1px solid #ddd",background:"#fff"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:2},children:[n.jsx("div",{style:{fontSize:10,color:"#444",fontWeight:600},children:"Bottom Image"}),n.jsx("label",{className:"radio-label",style:{margin:0},children:n.jsx("input",{type:"checkbox",checked:Sa,onChange:l=>ha(l.target.checked)})})]}),n.jsx("canvas",{ref:Hc,width:60,height:40,style:{width:"60px",height:"40px"}})]}),n.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:sa,onChange:l=>Ea(l.target.checked)}),n.jsx("span",{children:"Vias"})]}),n.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:Gi,onChange:l=>Go(l.target.checked)}),n.jsx("span",{children:"Traces (Top)"})]}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:x,onChange:l=>k(l.target.checked)}),n.jsx("span",{children:"Components (Top)"})]}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:Lo,onChange:l=>Vs(l.target.checked)}),n.jsx("span",{children:"Pads (Top)"})]}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:uo,onChange:l=>ls(l.target.checked)}),n.jsx("span",{children:"Test Points (Top)"})]}),n.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:to,onChange:l=>qs(l.target.checked)}),n.jsx("span",{children:"Traces (Bottom)"})]}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:P,onChange:l=>q(l.target.checked)}),n.jsx("span",{children:"Components (Bottom)"})]}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:Ii,onChange:l=>co(l.target.checked)}),n.jsx("span",{children:"Pads (Bottom)"})]}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:Mo,onChange:l=>f(l.target.checked)}),n.jsx("span",{children:"Test Points (Bottom)"})]}),n.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:Z,onChange:l=>Q(l.target.checked)}),n.jsx("span",{children:"Power"})]}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:ai,onChange:l=>_i(l.target.checked)}),n.jsx("span",{children:"Ground"})]}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:pi,onChange:l=>xr(l.target.checked)}),n.jsx("span",{children:"Connections"})]}),n.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:sa&&Lo&&Ii&&uo&&Mo&&Gi&&to&&x&&P&&Z&&ai&&pi,onChange:l=>{const y=l.target.checked;Ea(y),Vs(y),co(y),ls(y),f(y),Go(y),qs(y),k(y),q(y),Q(y),_i(y),xr(y)}}),n.jsx("span",{style:{fontWeight:600,fontSize:11},children:"Select All Layers"})]}),n.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),n.jsxs("div",{style:{marginTop:6},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[n.jsxs("label",{style:{fontSize:10,color:"#333"},children:["Transparency: ",K,"%"]}),n.jsxs("label",{className:"radio-label",style:{margin:0},children:[n.jsx("input",{type:"checkbox",checked:ee,onChange:l=>{const y=l.target.checked;y?(Zr(!0),ha(!0)):(D(50),oe("select")),w(y)}}),n.jsx("span",{style:{marginLeft:6,fontSize:10},children:"Cycle"})]})]}),n.jsx("input",{type:"range",min:"0",max:"100",value:K,onChange:l=>D(Number(l.target.value)),onDoubleClick:()=>mh("transparency"),className:"slider",style:{width:"100%",marginTop:3}}),ee&&n.jsxs("div",{style:{marginTop:6},children:[n.jsxs("label",{style:{fontSize:10,color:"#333"},children:["Cycle Speed: ",(Se/1e3).toFixed(1),"s"]}),n.jsx("input",{type:"range",min:"500",max:"8000",step:"100",value:8500-Se,onChange:l=>$(8500-Number(l.target.value)),onDoubleClick:()=>$(2e3),className:"slider",style:{width:"100%",marginTop:3}})]})]})]}),n.jsx(Sv,{visible:!g&&!S,canvasSize:wa,canvasPosition:{left:244,top:6}}),n.jsx("canvas",{ref:Lr,width:wa.width,height:wa.height,tabIndex:0,onMouseDown:Ad,onMouseMove:dp,onMouseUp:vf,onMouseLeave:vf,onWheel:up,onDoubleClick:yh,className:`pcb-canvas ${I==="transform"?"transform-cursor":I==="draw"?"draw-cursor":I==="erase"?"erase-cursor":"default-cursor"}`,style:{position:"absolute",left:"244px",top:"6px",...Ks?{cursor:Ks}:I==="pan"?{cursor:ss?"grabbing":"grab"}:{},width:`${wa.width}px`,height:`${wa.height}px`,maxHeight:"none",aspectRatio:"auto",border:"none"}}),lr&&n.jsxs("div",{style:{position:"absolute",left:`${244+wa.width-120}px`,top:`${6+wa.height+4}px`,fontSize:"11px",fontFamily:"monospace",color:"#333",backgroundColor:"rgba(255, 255, 255, 0.9)",padding:"2px 6px",borderRadius:"3px",border:"1px solid #ccc",pointerEvents:"none",zIndex:1e3},children:["(",lr.x.toFixed(1),"mm, ",lr.y.toFixed(1),"mm)"]}),n.jsx(Bv,{componentEditor:Wa,setComponentEditor:cl,componentsTop:tn,componentsBottom:cn,setComponentsTop:Li,setComponentsBottom:Si,connectingPin:Pa,setConnectingPin:Uo,componentDialogPosition:$a,setComponentDialogPosition:ul,isDraggingDialog:_s,setIsDraggingDialog:Fc,dialogDragOffset:j,setDialogDragOffset:W,areComponentsLocked:Kr,setSelectedComponentIds:bn,setNotesDialogVisible:sr,projectDirHandle:Pi,showGeminiSettingsDialog:Ql,onGeminiSettingsDialogClose:()=>xl(!1),onFindComponent:cf,componentDefinition:Wa?(()=>{const l=tn.find(y=>y.id===Wa.id)||cn.find(y=>y.id===Wa.id);return l?Cl(l):void 0})():void 0}),er&&qc&&(()=>{const l=er.component,y=er.layer;if(!l)return null;const N=l.componentType||"Component",B=l.componentType==="IntegratedCircuit"&&"icType"in l?l.icType:null,le=ff(l),ge=Cl(l),A=ge?.category==="Semiconductors",je=l?.pinNames,ne=ge?.properties?.pinNames,Te=8,ve=8,Ce=200,ye=150,we=10;let be=er.x+Te,me=er.y+ve;return be+Ce+we>window.innerWidth&&(be=er.x-Ce-Te),me+ye+we>window.innerHeight&&(me=er.y-ye-ve),be=Math.max(we,Math.min(be,window.innerWidth-Ce-we)),me=Math.max(we,Math.min(me,window.innerHeight-ye-we)),n.jsxs("div",{style:{position:"fixed",left:`${be}px`,top:`${me}px`,background:"rgba(0, 0, 0, 0.85)",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:"12px",lineHeight:"1.4",zIndex:1e4,pointerEvents:"none",width:"max-content",maxWidth:"400px",minWidth:"150px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)",wordWrap:"break-word",overflowWrap:"break-word"},children:[n.jsx("div",{style:{fontWeight:600,marginBottom:"4px"},children:kl(N)}),n.jsxs("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:["Layer: ",y==="top"?"Top":"Bottom"]}),B&&n.jsxs("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:["IC Type: ",B]}),le.length>0&&n.jsx("div",{style:{marginBottom:"4px"},children:le.map((Me,De)=>n.jsx("div",{style:{color:"#e0e0e0",fontSize:"11px",marginBottom:"2px"},children:Me},De))}),l.description&&n.jsx("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:l.description}),l.notes&&n.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid rgba(255,255,255,0.2)",fontSize:"11px",color:"#d0d0d0",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:l.notes}),A&&l.pinCount>0&&(()=>{const Me=Array.from({length:l.pinCount},(De,He)=>{const xt=l.pinConnections&&l.pinConnections.length>He?l.pinConnections[He]:"",pt=je&&He<je.length?je[He]:"",Nt=ne&&He<ne.length?ne[He]:"",st=Nt==="CHIP_DEPENDENT",qt=pt&&pt.trim()!==""?pt:st?"":Nt;return{pin:He+1,name:qt||"-",nodeId:xt||"-"}});return n.jsxs("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid rgba(255,255,255,0.2)"},children:[n.jsx("div",{style:{fontSize:"11px",fontWeight:600,marginBottom:"4px",color:"#fff"},children:"Pin Connections:"}),n.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px"},children:[n.jsx("thead",{children:n.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.3)"},children:[n.jsx("th",{style:{textAlign:"left",padding:"2px 6px",fontWeight:600,color:"#fff"},children:"Pin"}),n.jsx("th",{style:{textAlign:"left",padding:"2px 6px",fontWeight:600,color:"#fff"},children:"Name"}),n.jsx("th",{style:{textAlign:"left",padding:"2px 6px",fontWeight:600,color:"#fff"},children:"Node ID"})]})}),n.jsx("tbody",{children:Me.map((De,He)=>n.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[n.jsx("td",{style:{padding:"2px 6px",color:"#e0e0e0",fontFamily:"monospace"},children:De.pin}),n.jsx("td",{style:{padding:"2px 6px",color:"#e0e0e0",fontStyle:De.name!=="-"?"italic":"normal"},children:De.name}),n.jsx("td",{style:{padding:"2px 6px",color:"#e0e0e0",fontFamily:"monospace"},children:De.nodeId})]},He))})]})]})})()]})})(),Ba&&qc&&(()=>{const l=Ba.stroke;return l.notes?n.jsxs("div",{style:{position:"fixed",left:`${Ba.x+10}px`,top:`${Ba.y+10}px`,background:"rgba(0, 0, 0, 0.85)",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:"12px",lineHeight:"1.4",zIndex:1e4,pointerEvents:"none",width:"max-content",maxWidth:"400px",minWidth:"150px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)",wordWrap:"break-word",overflowWrap:"break-word"},children:[n.jsx("div",{style:{fontWeight:600,marginBottom:"4px"},children:"Test Point"}),n.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid rgba(255,255,255,0.2)",fontSize:"11px",color:"#d0d0d0",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:l.notes})]}):null})(),Mi&&Mi.visible&&(()=>{if(!J.find(N=>N.id===Mi.id))return null;const y=Ie.find(N=>N.id===Mi.powerBusId);return n.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#fff",border:"1px solid #0b5fff",borderRadius:4,padding:"6px",boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"175px",maxWidth:"250px",maxHeight:"40vh",overflowY:"auto",pointerEvents:"auto"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"5px"},children:[n.jsx("h3",{style:{margin:0,fontSize:"12px",color:"#333",fontWeight:600},children:"Power Properties"}),n.jsx("button",{onClick:()=>fr(null),style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#666",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Power Bus:"}),n.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:y?`${y.name} (${y.voltage})`:"Unknown"})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:`power-layer-${Mi.id}`,style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Layer:"}),n.jsxs("select",{id:`power-layer-${Mi.id}`,name:`power-layer-${Mi.id}`,value:Mi.layer,onChange:N=>fr({...Mi,layer:N.target.value}),disabled:Qi,style:{width:"100%",padding:"2px 3px",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",opacity:Qi?.6:1},children:[n.jsx("option",{value:"top",children:"Top"}),n.jsx("option",{value:"bottom",children:"Bottom"})]})]}),n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"X:"}),n.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:Mi.x.toFixed(2)})]}),n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Y:"}),n.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:Mi.y.toFixed(2)})]})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"3px",marginTop:"6px"},children:[n.jsx("button",{onClick:()=>fr(null),style:{padding:"2px 5px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,cursor:"pointer",fontSize:"10px",color:"#333"},children:"Cancel"}),n.jsx("button",{onClick:()=>{Qi||(fn(N=>N.map(B=>B.id===Mi.id?{...B,layer:Mi.layer}:B)),fr(null))},disabled:Qi,style:{padding:"2px 5px",background:Qi?"#f5f5f5":"#0b5fff",color:Qi?"#999":"#fff",border:"1px solid #ddd",borderRadius:2,cursor:Qi?"not-allowed":"pointer",fontSize:"10px"},children:"Save"})]})]})})(),!g&&!S&&n.jsx("div",{className:"placeholder"})]})}),n.jsx(Vv,{visible:Pe,onClose:()=>Fe(!1),powerBuses:Ie,setPowerBuses:bt,editingPowerBusId:tt,setEditingPowerBusId:Ae,powers:J}),n.jsx(Hv,{visible:Nr,onClose:()=>ni(!1),groundBuses:gt,setGroundBuses:dn,editingGroundBusId:gn,setEditingGroundBusId:$t,grounds:te}),n.jsx(Xv,{visible:Ve,projectDirHandle:Pi,onClose:()=>{Ke(!1),Je(void 0)},onRestore:ou,position:ft,isDragging:mt,onDragStart:pc}),n.jsx(Wv,{visible:fo,onClose:()=>Jr(!1),autoAssignDesignators:Ir,setAutoAssignDesignators:la,useGlobalDesignatorCounters:Hi,setUseGlobalDesignatorCounters:zr}),n.jsx("input",{ref:pl,type:"file",accept:".png,.jpg,.jpeg,image/png,image/jpeg",style:{display:"none"},onChange:l=>{const y=l.target.files?.[0];y&&bf(y,"top"),l.target.value=""}}),n.jsx("input",{ref:wc,type:"file",accept:".png,.jpg,.jpeg,image/png,image/jpeg",style:{display:"none"},onChange:l=>{const y=l.target.files?.[0];y&&bf(y,"bottom"),l.target.value=""}}),n.jsx("input",{ref:hl,type:"file",accept:".json,application/json",style:{display:"none"},onChange:async l=>{const y=l.target.files?.[0];if(y)try{iu(),await new Promise(A=>setTimeout(A,0)),aa(y.name);const N=await y.text(),B=JSON.parse(N);await qa(B,null);let ge;B.projectInfo?.name?ge=B.projectInfo.name:(ge=y.name.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_")||"pcb_project",hr(ge)),oa||hr(ge),setTimeout(()=>{kr({visible:!0,source:"open",interval:5})},100)}catch(N){console.error("Failed to open project",N),alert("Failed to open project file. See console for details.")}l.target.value=""}}),n.jsx(kv,{visible:zo.visible,selectedIds:ii,selectedComponentIds:$n,selectedPowerIds:mi,selectedGroundIds:Yn,drawingStrokes:Qe,componentsTop:tn,componentsBottom:cn,powers:J,grounds:te,powerBuses:Ie,onClose:()=>{so({visible:!1,text:""})},setComponentsTop:Li,setComponentsBottom:Si,determineViaType:Fa,determinePadType:Ua,determineTestPointType:us,onFindComponent:cf,onFindStroke:Qf,onFindPower:ep,onFindGround:tp,onOpenNotesDialog:()=>sr(!0),position:Xi,isDragging:Qr,onDragStart:l=>{Xi&&(Fi({x:l.clientX-Xi.x,y:l.clientY-Xi.y}),ca(!0),l.preventDefault())}}),n.jsx(Nv,{visible:Oa,selectedIds:ii,selectedComponentIds:$n,selectedPowerIds:mi,selectedGroundIds:Yn,drawingStrokes:Qe,componentsTop:tn,componentsBottom:cn,powers:J,grounds:te,powerBuses:Ie,onClose:()=>{sr(!1)},setComponentsTop:Li,setComponentsBottom:Si,setDrawingStrokes:At,setPowerSymbols:fn,setGroundSymbols:Fn,determineViaType:Fa,determinePadType:Ua,determineTestPointType:us,position:Pn,isDragging:Ui,onDragStart:l=>{Pn&&(po({x:l.clientX-Pn.x,y:l.clientY-Pn.y}),Io(!0),l.preventDefault())}}),n.jsx(Av,{visible:tl,projectNotes:Br,setProjectNotes:bs,onClose:()=>{ec(!1)},position:tr,isDragging:Wc,onDragStart:l=>{tr?(Wu({x:l.clientX-tr.x,y:l.clientY-tr.y}),Tc(!0),l.preventDefault()):(tc({x:l.clientX-300,y:l.clientY-200}),Wu({x:300,y:200}),Tc(!0),l.preventDefault())}}),n.jsx(zv,{visible:$c,drawingStrokes:Qe,onClose:()=>{xu(!1)},onFindTestPoint:uf,position:yl,isDragging:Er,onDragStart:l=>{yl?(Ml({x:l.clientX-yl.x,y:l.clientY-yl.y}),nc(!0),l.preventDefault()):(ea({x:l.clientX-300,y:l.clientY-200}),Ml({x:300,y:200}),nc(!0),l.preventDefault())},determineTestPointType:us,powerBuses:Ie}),n.jsx(Fx,{visible:zl.visible,title:"New Project",message:"You have unsaved changes. Do you want to save your project before creating a new one?",onYes:Ko,onNo:jl,onCancel:bp,yesButtonRef:gu}),n.jsx(Fx,{visible:bc.visible,title:"Open Project",message:"You have unsaved changes. Do you want to save your project before opening another one?",onYes:su,onNo:_u,onCancel:vp,yesButtonRef:el}),Ci.visible&&n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10002},onClick:l=>{l.target===l.currentTarget&&Ed()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:l=>l.stopPropagation(),children:[n.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"New Project"}),n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Project Name:"}),n.jsx("input",{ref:Qa,type:"text",value:Ci.projectName,onChange:l=>{Hr(y=>({...y,projectName:l.target.value}))},onKeyDown:l=>{l.key==="Enter"?(l.preventDefault(),Cf()):l.key==="Escape"&&(l.preventDefault(),Ed())},style:{width:"100%",padding:"8px 12px",marginBottom:"8px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},placeholder:"e.g., my_pcb_project",autoFocus:!0}),Ci.projectName&&(()=>{const l=Ci.projectName.match(/[^a-zA-Z0-9_-]/g);if(l){const y=[...new Set(l)];return n.jsxs("div",{style:{marginBottom:"12px",padding:"6px 10px",background:"#3a1f1f",border:"1px solid #a44",borderRadius:4,fontSize:"12px",color:"#ffaaaa"},children:["Invalid characters: ",y.map(N=>`"${N}"`).join(", "),". Only letters, numbers, underscore (_), and hyphen (-) are allowed."]})}return null})(),n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Location:"}),n.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[n.jsx("input",{type:"text",value:Ci.locationPath||"Not selected",readOnly:!0,style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:Ci.locationPath?"#f2f2f2":"#888",fontSize:"14px",cursor:"not-allowed"},placeholder:"Select a location..."}),n.jsx("button",{onClick:fc,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500,whiteSpace:"nowrap"},children:"Browse..."})]}),Ci.projectName&&Ci.locationPath&&n.jsxs("div",{style:{marginBottom:"20px",padding:"8px 12px",background:"#1a1a1f",border:"1px solid #333",borderRadius:6,fontSize:"12px",color:"#aaa",fontFamily:"monospace"},children:[n.jsx("div",{style:{marginBottom:"4px",color:"#888"},children:"Project will be created at:"}),n.jsx("div",{style:{color:"#4CAF50"},children:(()=>{if(!Ci.projectName||!Ci.locationPath)return"";const y=Ci.projectName.trim().replace(/[^a-zA-Z0-9_-]/g,"_")||"pcb_project",N=`${y}.json`;return Ci.locationPath===y?`${Ci.locationPath}/${N}`:`${Ci.locationPath}/${y}/${N}`})()})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[n.jsx("button",{onClick:Ed,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),n.jsx("button",{onClick:Cf,disabled:!Ci.projectName.trim()||!Ci.locationHandle,style:{padding:"8px 16px",background:!Ci.projectName.trim()||!Ci.locationHandle?"#555":"#4CAF50",color:"#fff",border:"1px solid "+(!Ci.projectName.trim()||!Ci.locationHandle?"#666":"#45a049"),borderRadius:6,cursor:!Ci.projectName.trim()||!Ci.locationHandle?"not-allowed":"pointer",fontSize:"14px",fontWeight:600,opacity:!Ci.projectName.trim()||!Ci.locationHandle?.6:1},children:"Create"})]})]})}),Yi.visible&&n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10002},onClick:l=>{l.target===l.currentTarget&&Pu()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:l=>l.stopPropagation(),children:[n.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Save As"}),n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"File Name:"}),n.jsx("input",{ref:Zl,type:"text",value:Yi.filename,onChange:l=>{Es(y=>({...y,filename:l.target.value}))},onKeyDown:l=>{l.key==="Enter"?(l.preventDefault(),mp()):l.key==="Escape"&&(l.preventDefault(),Pu())},style:{width:"100%",padding:"8px 12px",marginBottom:"8px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},placeholder:"e.g., my_project.json",autoFocus:!0}),n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Location:"}),n.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[n.jsx("input",{type:"text",value:Yi.locationPath||"Not selected",readOnly:!0,style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:Yi.locationPath?"#f2f2f2":"#888",fontSize:"14px",cursor:"not-allowed"},placeholder:"Select a location..."}),n.jsx("button",{onClick:yp,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500,whiteSpace:"nowrap"},children:"Browse..."})]}),Yi.filename&&Yi.locationPath&&n.jsxs("div",{style:{marginBottom:"20px",padding:"8px 12px",background:"#1a1a1f",border:"1px solid #333",borderRadius:6,fontSize:"12px",color:"#aaa",fontFamily:"monospace"},children:[n.jsx("div",{style:{marginBottom:"4px",color:"#888"},children:"File will be saved at:"}),n.jsxs("div",{style:{color:"#4CAF50"},children:[Yi.locationPath,"/",Yi.filename.endsWith(".json")?Yi.filename:`${Yi.filename}.json`]})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[n.jsx("button",{onClick:Pu,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),n.jsx("button",{onClick:mp,disabled:!Yi.filename.trim()||!Yi.locationHandle,style:{padding:"8px 16px",background:!Yi.filename.trim()||!Yi.locationHandle?"#555":"#4CAF50",color:"#fff",border:"1px solid "+(!Yi.filename.trim()||!Yi.locationHandle?"#666":"#45a049"),borderRadius:6,cursor:!Yi.filename.trim()||!Yi.locationHandle?"not-allowed":"pointer",fontSize:"14px",fontWeight:600,opacity:!Yi.filename.trim()||!Yi.locationHandle?.6:1},children:"Save"})]})]})}),n.jsx(Oy,{visible:Is.visible,title:Is.title,message:Is.message,onClose:()=>Bs({visible:!1,title:"",message:""})}),n.jsx(Pv,{visible:Zc,dimensions:ac,onSave:l=>{Ac(l)},onClose:()=>cs(!1)}),n.jsx(_v,{visible:fl,onClose:()=>{let l=0,y=0;g?(l=g.x,y=g.y):S&&(l=S.x,y=S.y),La(N=>({...N,0:{pcbReferenceX:l,pcbReferenceY:y,x:0,y:0,zoom:yt,viewRotation:On,viewFlipX:Ei,isBottomView:ki,transparency:K,showTopImage:eo,showBottomImage:Sa,showViasLayer:sa,showTopTracesLayer:Gi,showBottomTracesLayer:to,showTopPadsLayer:Lo,showBottomPadsLayer:Ii,showTopTestPointsLayer:uo,showBottomTestPointsLayer:Mo,showTopComponents:x,showBottomComponents:P,showPowerLayer:Z,showGroundLayer:ai,showConnectionsLayer:pi}})),ys(!1)},topImage:g,bottomImage:S,selectedImageForTransform:jn,setSelectedImageForTransform:ci,transformMode:Wn,setTransformMode:qi,updateImageTransform:Ju,resetImageTransform:Pd,setCurrentTool:oe,isGrayscale:H,setIsGrayscale:ae,areImagesLocked:Cr}),n.jsx(Rv,{visible:_a,onClose:()=>_o(!1),topImage:g,bottomImage:S,setTopImage:m,setBottomImage:_,componentsTop:tn,componentsBottom:cn,setComponentsTop:Li,setComponentsBottom:Si,drawingStrokes:Qe,setDrawingStrokes:At,powerSymbols:J,groundSymbols:te,setPowerSymbols:fn,setGroundSymbols:Fn,canvasRef:Lr,isBottomView:ki,setIsBottomView:ri,originalTopFlipX:Js,setOriginalTopFlipX:ms,originalBottomFlipX:Gl,setOriginalBottomFlipX:vc,originalTopFlipY:Hu,setOriginalTopFlipY:yd,originalBottomFlipY:md,setOriginalBottomFlipY:bd,cameraWorldCenter:ya,setCameraWorldCenter:Rr,viewScale:yt,viewRotation:On,setViewRotation:Ri,viewFlipX:Ei,setViewFlipX:bo,contentBorder:5,setTransparency:D}),n.jsx(qv,{visible:op,selectedLayer:ir,selectedComponentType:Ss,selectedComponentKey:hf,onLayerChange:l=>{Na(l),Oo.current=l,Zn(l),R(l==="top"?ht:Ut),O(l==="top"?Ht:zn),l==="top"?(Zr(!0),k(!0)):(ha(!0),q(!0))},onComponentTypeChange:(l,y,N)=>{jd(l),sp(y),gf(N||null),Td.current=l},onClose:()=>{Sd(!1),wo(!0),oe("select")}}),n.jsx($v,{visible:xs.visible,size:xs.size,onSizeChange:l=>Al(y=>({...y,size:l})),onApply:Rd,onCancel:()=>Al({visible:!1,size:6})}),n.jsx(Yv,{visible:rs.visible,interval:rs.interval,onIntervalChange:l=>Ao({visible:!0,interval:l}),onApply:()=>jf(rs.interval,!1),onCancel:()=>Ao({visible:!1,interval:5})}),n.jsx(Gv,{visible:Ya.visible,interval:Ya.interval,onIntervalChange:l=>kr({...Ya,interval:l}),onEnable:()=>jf(Ya.interval,!0),onSkip:Sf}),n.jsx(tw,{visible:ic,isPad:Cc,onConfirm:l=>{Gc({numPins:l.numPins,type:l.type,twoSidedOrientation:l.twoSidedOrientation,point1:{x:0,y:0},point2:{x:0,y:0}}),yu(!0),oe("select"),ho(!1)},onClose:()=>{ho(!1)}}),n.jsx("div",{style:{position:"fixed",bottom:8,right:8,zIndex:100},children:n.jsxs("button",{onClick:()=>{window.open("https://github.com/sponsors/pgiacalo","_blank","noopener,noreferrer")},style:{display:"flex",alignItems:"center",gap:6,padding:"6px 12px",background:"linear-gradient(180deg, #f6f8fa 0%, #ebecef 100%)",border:"1px solid rgba(27, 31, 36, 0.15)",borderRadius:6,cursor:"pointer",fontSize:12,fontWeight:500,color:"#24292f",boxShadow:"0 1px 0 rgba(27, 31, 36, 0.04)",transition:"background 0.2s"},onMouseEnter:l=>{l.currentTarget.style.background="linear-gradient(180deg, #f3f4f6 0%, #e5e6e9 100%)"},onMouseLeave:l=>{l.currentTarget.style.background="linear-gradient(180deg, #f6f8fa 0%, #ebecef 100%)"},title:"Donate to support this project",children:[n.jsx("svg",{height:"16",width:"16",viewBox:"0 0 16 16",fill:"#bf3989","aria-hidden":"true",children:n.jsx("path",{d:"M4.25 2.5c-1.336 0-2.75 1.164-2.75 3 0 2.15 1.58 4.144 3.365 5.682A20.565 20.565 0 008 13.393a20.561 20.561 0 003.135-2.211C12.92 9.644 14.5 7.65 14.5 5.5c0-1.836-1.414-3-2.75-3-1.373 0-2.609.986-3.029 2.456a.749.749 0 01-1.442 0C6.859 3.486 5.623 2.5 4.25 2.5z"})}),"Donate"]})})]}):n.jsx(Cv,{onAuthSuccess:d})}Ym.createRoot(document.getElementById("root")).render(n.jsx(L.StrictMode,{children:n.jsx(vw,{})}));export{_r as _,ww as c,Bm as g};

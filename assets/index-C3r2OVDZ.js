(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const R of document.querySelectorAll('link[rel="modulepreload"]'))d(R);new MutationObserver(R=>{for(const F of R)if(F.type==="childList")for(const xe of F.addedNodes)xe.tagName==="LINK"&&xe.rel==="modulepreload"&&d(xe)}).observe(document,{childList:!0,subtree:!0});function g(R){const F={};return R.integrity&&(F.integrity=R.integrity),R.referrerPolicy&&(F.referrerPolicy=R.referrerPolicy),R.crossOrigin==="use-credentials"?F.credentials="include":R.crossOrigin==="anonymous"?F.credentials="omit":F.credentials="same-origin",F}function d(R){if(R.ep)return;R.ep=!0;const F=g(R);fetch(R.href,F)}})();function Ug(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var Uf={exports:{}},_d={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xh;function Pg(){if(xh)return _d;xh=1;var c=Symbol.for("react.transitional.element"),u=Symbol.for("react.fragment");function g(d,R,F){var xe=null;if(F!==void 0&&(xe=""+F),R.key!==void 0&&(xe=""+R.key),"key"in R){F={};for(var X in R)X!=="key"&&(F[X]=R[X])}else F=R;return R=F.ref,{$$typeof:c,type:d,key:xe,ref:R!==void 0?R:null,props:F}}return _d.Fragment=u,_d.jsx=g,_d.jsxs=g,_d}var yh;function Og(){return yh||(yh=1,Uf.exports=Pg()),Uf.exports}var n=Og(),Pf={exports:{}},Ct={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bh;function _g(){if(bh)return Ct;bh=1;var c=Symbol.for("react.transitional.element"),u=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),F=Symbol.for("react.consumer"),xe=Symbol.for("react.context"),X=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),V=Symbol.for("react.memo"),de=Symbol.for("react.lazy"),ge=Symbol.for("react.activity"),Te=Symbol.iterator;function Ue(w){return w===null||typeof w!="object"?null:(w=Te&&w[Te]||w["@@iterator"],typeof w=="function"?w:null)}var se={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Re=Object.assign,B={};function te(w,U,$){this.props=w,this.context=U,this.refs=B,this.updater=$||se}te.prototype.isReactComponent={},te.prototype.setState=function(w,U){if(typeof w!="object"&&typeof w!="function"&&w!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,w,U,"setState")},te.prototype.forceUpdate=function(w){this.updater.enqueueForceUpdate(this,w,"forceUpdate")};function $e(){}$e.prototype=te.prototype;function L(w,U,$){this.props=w,this.context=U,this.refs=B,this.updater=$||se}var re=L.prototype=new $e;re.constructor=L,Re(re,te.prototype),re.isPureReactComponent=!0;var N=Array.isArray;function z(){}var D={H:null,A:null,T:null,S:null},P=Object.prototype.hasOwnProperty;function O(w,U,$){var Z=$.ref;return{$$typeof:c,type:w,key:U,ref:Z!==void 0?Z:null,props:$}}function he(w,U){return O(w.type,U,w.props)}function W(w){return typeof w=="object"&&w!==null&&w.$$typeof===c}function j(w){var U={"=":"=0",":":"=2"};return"$"+w.replace(/[=:]/g,function($){return U[$]})}var Se=/\/+/g;function me(w,U){return typeof w=="object"&&w!==null&&w.key!=null?j(""+w.key):U.toString(36)}function ce(w){switch(w.status){case"fulfilled":return w.value;case"rejected":throw w.reason;default:switch(typeof w.status=="string"?w.then(z,z):(w.status="pending",w.then(function(U){w.status==="pending"&&(w.status="fulfilled",w.value=U)},function(U){w.status==="pending"&&(w.status="rejected",w.reason=U)})),w.status){case"fulfilled":return w.value;case"rejected":throw w.reason}}throw w}function H(w,U,$,Z,Ie){var ot=typeof w;(ot==="undefined"||ot==="boolean")&&(w=null);var xt=!1;if(w===null)xt=!0;else switch(ot){case"bigint":case"string":case"number":xt=!0;break;case"object":switch(w.$$typeof){case c:case u:xt=!0;break;case de:return xt=w._init,H(xt(w._payload),U,$,Z,Ie)}}if(xt)return Ie=Ie(w),xt=Z===""?"."+me(w,0):Z,N(Ie)?($="",xt!=null&&($=xt.replace(Se,"$&/")+"/"),H(Ie,U,$,"",function(In){return In})):Ie!=null&&(W(Ie)&&(Ie=he(Ie,$+(Ie.key==null||w&&w.key===Ie.key?"":(""+Ie.key).replace(Se,"$&/")+"/")+xt)),U.push(Ie)),1;xt=0;var Gt=Z===""?".":Z+":";if(N(w))for(var He=0;He<w.length;He++)Z=w[He],ot=Gt+me(Z,He),xt+=H(Z,U,$,ot,Ie);else if(He=Ue(w),typeof He=="function")for(w=He.call(w),He=0;!(Z=w.next()).done;)Z=Z.value,ot=Gt+me(Z,He++),xt+=H(Z,U,$,ot,Ie);else if(ot==="object"){if(typeof w.then=="function")return H(ce(w),U,$,Z,Ie);throw U=String(w),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(w).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.")}return xt}function I(w,U,$){if(w==null)return w;var Z=[],Ie=0;return H(w,Z,"","",function(ot){return U.call($,ot,Ie++)}),Z}function pe(w){if(w._status===-1){var U=w._result;U=U(),U.then(function($){(w._status===0||w._status===-1)&&(w._status=1,w._result=$)},function($){(w._status===0||w._status===-1)&&(w._status=2,w._result=$)}),w._status===-1&&(w._status=0,w._result=U)}if(w._status===1)return w._result.default;throw w._result}var Be=typeof reportError=="function"?reportError:function(w){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var U=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof w=="object"&&w!==null&&typeof w.message=="string"?String(w.message):String(w),error:w});if(!window.dispatchEvent(U))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",w);return}console.error(w)},K={map:I,forEach:function(w,U,$){I(w,function(){U.apply(this,arguments)},$)},count:function(w){var U=0;return I(w,function(){U++}),U},toArray:function(w){return I(w,function(U){return U})||[]},only:function(w){if(!W(w))throw Error("React.Children.only expected to receive a single React element child.");return w}};return Ct.Activity=ge,Ct.Children=K,Ct.Component=te,Ct.Fragment=g,Ct.Profiler=R,Ct.PureComponent=L,Ct.StrictMode=d,Ct.Suspense=p,Ct.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,Ct.__COMPILER_RUNTIME={__proto__:null,c:function(w){return D.H.useMemoCache(w)}},Ct.cache=function(w){return function(){return w.apply(null,arguments)}},Ct.cacheSignal=function(){return null},Ct.cloneElement=function(w,U,$){if(w==null)throw Error("The argument must be a React element, but you passed "+w+".");var Z=Re({},w.props),Ie=w.key;if(U!=null)for(ot in U.key!==void 0&&(Ie=""+U.key),U)!P.call(U,ot)||ot==="key"||ot==="__self"||ot==="__source"||ot==="ref"&&U.ref===void 0||(Z[ot]=U[ot]);var ot=arguments.length-2;if(ot===1)Z.children=$;else if(1<ot){for(var xt=Array(ot),Gt=0;Gt<ot;Gt++)xt[Gt]=arguments[Gt+2];Z.children=xt}return O(w.type,Ie,Z)},Ct.createContext=function(w){return w={$$typeof:xe,_currentValue:w,_currentValue2:w,_threadCount:0,Provider:null,Consumer:null},w.Provider=w,w.Consumer={$$typeof:F,_context:w},w},Ct.createElement=function(w,U,$){var Z,Ie={},ot=null;if(U!=null)for(Z in U.key!==void 0&&(ot=""+U.key),U)P.call(U,Z)&&Z!=="key"&&Z!=="__self"&&Z!=="__source"&&(Ie[Z]=U[Z]);var xt=arguments.length-2;if(xt===1)Ie.children=$;else if(1<xt){for(var Gt=Array(xt),He=0;He<xt;He++)Gt[He]=arguments[He+2];Ie.children=Gt}if(w&&w.defaultProps)for(Z in xt=w.defaultProps,xt)Ie[Z]===void 0&&(Ie[Z]=xt[Z]);return O(w,ot,Ie)},Ct.createRef=function(){return{current:null}},Ct.forwardRef=function(w){return{$$typeof:X,render:w}},Ct.isValidElement=W,Ct.lazy=function(w){return{$$typeof:de,_payload:{_status:-1,_result:w},_init:pe}},Ct.memo=function(w,U){return{$$typeof:V,type:w,compare:U===void 0?null:U}},Ct.startTransition=function(w){var U=D.T,$={};D.T=$;try{var Z=w(),Ie=D.S;Ie!==null&&Ie($,Z),typeof Z=="object"&&Z!==null&&typeof Z.then=="function"&&Z.then(z,Be)}catch(ot){Be(ot)}finally{U!==null&&$.types!==null&&(U.types=$.types),D.T=U}},Ct.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},Ct.use=function(w){return D.H.use(w)},Ct.useActionState=function(w,U,$){return D.H.useActionState(w,U,$)},Ct.useCallback=function(w,U){return D.H.useCallback(w,U)},Ct.useContext=function(w){return D.H.useContext(w)},Ct.useDebugValue=function(){},Ct.useDeferredValue=function(w,U){return D.H.useDeferredValue(w,U)},Ct.useEffect=function(w,U){return D.H.useEffect(w,U)},Ct.useEffectEvent=function(w){return D.H.useEffectEvent(w)},Ct.useId=function(){return D.H.useId()},Ct.useImperativeHandle=function(w,U,$){return D.H.useImperativeHandle(w,U,$)},Ct.useInsertionEffect=function(w,U){return D.H.useInsertionEffect(w,U)},Ct.useLayoutEffect=function(w,U){return D.H.useLayoutEffect(w,U)},Ct.useMemo=function(w,U){return D.H.useMemo(w,U)},Ct.useOptimistic=function(w,U){return D.H.useOptimistic(w,U)},Ct.useReducer=function(w,U,$){return D.H.useReducer(w,U,$)},Ct.useRef=function(w){return D.H.useRef(w)},Ct.useState=function(w){return D.H.useState(w)},Ct.useSyncExternalStore=function(w,U,$){return D.H.useSyncExternalStore(w,U,$)},Ct.useTransition=function(){return D.H.useTransition()},Ct.version="19.2.0",Ct}var mh;function qf(){return mh||(mh=1,Pf.exports=_g()),Pf.exports}var m=qf();const Oe=Ug(m);var Of={exports:{}},Hd={},_f={exports:{}},Hf={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vh;function Hg(){return vh||(vh=1,(function(c){function u(H,I){var pe=H.length;H.push(I);e:for(;0<pe;){var Be=pe-1>>>1,K=H[Be];if(0<R(K,I))H[Be]=I,H[pe]=K,pe=Be;else break e}}function g(H){return H.length===0?null:H[0]}function d(H){if(H.length===0)return null;var I=H[0],pe=H.pop();if(pe!==I){H[0]=pe;e:for(var Be=0,K=H.length,w=K>>>1;Be<w;){var U=2*(Be+1)-1,$=H[U],Z=U+1,Ie=H[Z];if(0>R($,pe))Z<K&&0>R(Ie,$)?(H[Be]=Ie,H[Z]=pe,Be=Z):(H[Be]=$,H[U]=pe,Be=U);else if(Z<K&&0>R(Ie,pe))H[Be]=Ie,H[Z]=pe,Be=Z;else break e}}return I}function R(H,I){var pe=H.sortIndex-I.sortIndex;return pe!==0?pe:H.id-I.id}if(c.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var F=performance;c.unstable_now=function(){return F.now()}}else{var xe=Date,X=xe.now();c.unstable_now=function(){return xe.now()-X}}var p=[],V=[],de=1,ge=null,Te=3,Ue=!1,se=!1,Re=!1,B=!1,te=typeof setTimeout=="function"?setTimeout:null,$e=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;function re(H){for(var I=g(V);I!==null;){if(I.callback===null)d(V);else if(I.startTime<=H)d(V),I.sortIndex=I.expirationTime,u(p,I);else break;I=g(V)}}function N(H){if(Re=!1,re(H),!se)if(g(p)!==null)se=!0,z||(z=!0,j());else{var I=g(V);I!==null&&ce(N,I.startTime-H)}}var z=!1,D=-1,P=5,O=-1;function he(){return B?!0:!(c.unstable_now()-O<P)}function W(){if(B=!1,z){var H=c.unstable_now();O=H;var I=!0;try{e:{se=!1,Re&&(Re=!1,$e(D),D=-1),Ue=!0;var pe=Te;try{t:{for(re(H),ge=g(p);ge!==null&&!(ge.expirationTime>H&&he());){var Be=ge.callback;if(typeof Be=="function"){ge.callback=null,Te=ge.priorityLevel;var K=Be(ge.expirationTime<=H);if(H=c.unstable_now(),typeof K=="function"){ge.callback=K,re(H),I=!0;break t}ge===g(p)&&d(p),re(H)}else d(p);ge=g(p)}if(ge!==null)I=!0;else{var w=g(V);w!==null&&ce(N,w.startTime-H),I=!1}}break e}finally{ge=null,Te=pe,Ue=!1}I=void 0}}finally{I?j():z=!1}}}var j;if(typeof L=="function")j=function(){L(W)};else if(typeof MessageChannel<"u"){var Se=new MessageChannel,me=Se.port2;Se.port1.onmessage=W,j=function(){me.postMessage(null)}}else j=function(){te(W,0)};function ce(H,I){D=te(function(){H(c.unstable_now())},I)}c.unstable_IdlePriority=5,c.unstable_ImmediatePriority=1,c.unstable_LowPriority=4,c.unstable_NormalPriority=3,c.unstable_Profiling=null,c.unstable_UserBlockingPriority=2,c.unstable_cancelCallback=function(H){H.callback=null},c.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<H?Math.floor(1e3/H):5},c.unstable_getCurrentPriorityLevel=function(){return Te},c.unstable_next=function(H){switch(Te){case 1:case 2:case 3:var I=3;break;default:I=Te}var pe=Te;Te=I;try{return H()}finally{Te=pe}},c.unstable_requestPaint=function(){B=!0},c.unstable_runWithPriority=function(H,I){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var pe=Te;Te=H;try{return I()}finally{Te=pe}},c.unstable_scheduleCallback=function(H,I,pe){var Be=c.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?Be+pe:Be):pe=Be,H){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=pe+K,H={id:de++,callback:I,priorityLevel:H,startTime:pe,expirationTime:K,sortIndex:-1},pe>Be?(H.sortIndex=pe,u(V,H),g(p)===null&&H===g(V)&&(Re?($e(D),D=-1):Re=!0,ce(N,pe-Be))):(H.sortIndex=K,u(p,H),se||Ue||(se=!0,z||(z=!0,j()))),H},c.unstable_shouldYield=he,c.unstable_wrapCallback=function(H){var I=Te;return function(){var pe=Te;Te=I;try{return H.apply(this,arguments)}finally{Te=pe}}}})(Hf)),Hf}var Sh;function Eg(){return Sh||(Sh=1,_f.exports=Hg()),_f.exports}var Ef={exports:{}},Fi={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wh;function Ig(){if(wh)return Fi;wh=1;var c=qf();function u(p){var V="https://react.dev/errors/"+p;if(1<arguments.length){V+="?args[]="+encodeURIComponent(arguments[1]);for(var de=2;de<arguments.length;de++)V+="&args[]="+encodeURIComponent(arguments[de])}return"Minified React error #"+p+"; visit "+V+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function g(){}var d={d:{f:g,r:function(){throw Error(u(522))},D:g,C:g,L:g,m:g,X:g,S:g,M:g},p:0,findDOMNode:null},R=Symbol.for("react.portal");function F(p,V,de){var ge=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:R,key:ge==null?null:""+ge,children:p,containerInfo:V,implementation:de}}var xe=c.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function X(p,V){if(p==="font")return"";if(typeof V=="string")return V==="use-credentials"?V:""}return Fi.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=d,Fi.createPortal=function(p,V){var de=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!V||V.nodeType!==1&&V.nodeType!==9&&V.nodeType!==11)throw Error(u(299));return F(p,V,null,de)},Fi.flushSync=function(p){var V=xe.T,de=d.p;try{if(xe.T=null,d.p=2,p)return p()}finally{xe.T=V,d.p=de,d.d.f()}},Fi.preconnect=function(p,V){typeof p=="string"&&(V?(V=V.crossOrigin,V=typeof V=="string"?V==="use-credentials"?V:"":void 0):V=null,d.d.C(p,V))},Fi.prefetchDNS=function(p){typeof p=="string"&&d.d.D(p)},Fi.preinit=function(p,V){if(typeof p=="string"&&V&&typeof V.as=="string"){var de=V.as,ge=X(de,V.crossOrigin),Te=typeof V.integrity=="string"?V.integrity:void 0,Ue=typeof V.fetchPriority=="string"?V.fetchPriority:void 0;de==="style"?d.d.S(p,typeof V.precedence=="string"?V.precedence:void 0,{crossOrigin:ge,integrity:Te,fetchPriority:Ue}):de==="script"&&d.d.X(p,{crossOrigin:ge,integrity:Te,fetchPriority:Ue,nonce:typeof V.nonce=="string"?V.nonce:void 0})}},Fi.preinitModule=function(p,V){if(typeof p=="string")if(typeof V=="object"&&V!==null){if(V.as==null||V.as==="script"){var de=X(V.as,V.crossOrigin);d.d.M(p,{crossOrigin:de,integrity:typeof V.integrity=="string"?V.integrity:void 0,nonce:typeof V.nonce=="string"?V.nonce:void 0})}}else V==null&&d.d.M(p)},Fi.preload=function(p,V){if(typeof p=="string"&&typeof V=="object"&&V!==null&&typeof V.as=="string"){var de=V.as,ge=X(de,V.crossOrigin);d.d.L(p,de,{crossOrigin:ge,integrity:typeof V.integrity=="string"?V.integrity:void 0,nonce:typeof V.nonce=="string"?V.nonce:void 0,type:typeof V.type=="string"?V.type:void 0,fetchPriority:typeof V.fetchPriority=="string"?V.fetchPriority:void 0,referrerPolicy:typeof V.referrerPolicy=="string"?V.referrerPolicy:void 0,imageSrcSet:typeof V.imageSrcSet=="string"?V.imageSrcSet:void 0,imageSizes:typeof V.imageSizes=="string"?V.imageSizes:void 0,media:typeof V.media=="string"?V.media:void 0})}},Fi.preloadModule=function(p,V){if(typeof p=="string")if(V){var de=X(V.as,V.crossOrigin);d.d.m(p,{as:typeof V.as=="string"&&V.as!=="script"?V.as:void 0,crossOrigin:de,integrity:typeof V.integrity=="string"?V.integrity:void 0})}else d.d.m(p)},Fi.requestFormReset=function(p){d.d.r(p)},Fi.unstable_batchedUpdates=function(p,V){return p(V)},Fi.useFormState=function(p,V,de){return xe.H.useFormState(p,V,de)},Fi.useFormStatus=function(){return xe.H.useHostTransitionStatus()},Fi.version="19.2.0",Fi}var jh;function Vg(){if(jh)return Ef.exports;jh=1;function c(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(c)}catch(u){console.error(u)}}return c(),Ef.exports=Ig(),Ef.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Th;function Wg(){if(Th)return Hd;Th=1;var c=Eg(),u=qf(),g=Vg();function d(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var i=2;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function R(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function F(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(i=t.return),e=t.return;while(e)}return t.tag===3?i:null}function xe(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function X(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(F(e)!==e)throw Error(d(188))}function V(e){var t=e.alternate;if(!t){if(t=F(e),t===null)throw Error(d(188));return t!==e?null:e}for(var i=e,l=t;;){var a=i.return;if(a===null)break;var s=a.alternate;if(s===null){if(l=a.return,l!==null){i=l;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===i)return p(a),e;if(s===l)return p(a),t;s=s.sibling}throw Error(d(188))}if(i.return!==l.return)i=a,l=s;else{for(var h=!1,S=a.child;S;){if(S===i){h=!0,i=a,l=s;break}if(S===l){h=!0,l=a,i=s;break}S=S.sibling}if(!h){for(S=s.child;S;){if(S===i){h=!0,i=s,l=a;break}if(S===l){h=!0,l=s,i=a;break}S=S.sibling}if(!h)throw Error(d(189))}}if(i.alternate!==l)throw Error(d(190))}if(i.tag!==3)throw Error(d(188));return i.stateNode.current===i?e:t}function de(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=de(e),t!==null)return t;e=e.sibling}return null}var ge=Object.assign,Te=Symbol.for("react.element"),Ue=Symbol.for("react.transitional.element"),se=Symbol.for("react.portal"),Re=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),te=Symbol.for("react.profiler"),$e=Symbol.for("react.consumer"),L=Symbol.for("react.context"),re=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),he=Symbol.for("react.memo_cache_sentinel"),W=Symbol.iterator;function j(e){return e===null||typeof e!="object"?null:(e=W&&e[W]||e["@@iterator"],typeof e=="function"?e:null)}var Se=Symbol.for("react.client.reference");function me(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===Se?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Re:return"Fragment";case te:return"Profiler";case B:return"StrictMode";case N:return"Suspense";case z:return"SuspenseList";case O:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case se:return"Portal";case L:return e.displayName||"Context";case $e:return(e._context.displayName||"Context")+".Consumer";case re:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case D:return t=e.displayName||null,t!==null?t:me(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return me(e(t))}catch{}}return null}var ce=Array.isArray,H=u.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,I=g.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,pe={pending:!1,data:null,method:null,action:null},Be=[],K=-1;function w(e){return{current:e}}function U(e){0>K||(e.current=Be[K],Be[K]=null,K--)}function $(e,t){K++,Be[K]=e.current,e.current=t}var Z=w(null),Ie=w(null),ot=w(null),xt=w(null);function Gt(e,t){switch($(ot,t),$(Ie,e),$(Z,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Ep(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Ep(t),e=Ip(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}U(Z),$(Z,e)}function He(){U(Z),U(Ie),U(ot)}function In(e){e.memoizedState!==null&&$(xt,e);var t=Z.current,i=Ip(t,e.type);t!==i&&($(Ie,e),$(Z,i))}function Un(e){Ie.current===e&&(U(Z),U(Ie)),xt.current===e&&(U(xt),Bd._currentValue=pe)}var Ui,wi;function pi(e){if(Ui===void 0)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);Ui=t&&t[1]||"",wi=-1<i.stack.indexOf(`
    at`)?" (<anonymous>)":-1<i.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ui+e+wi}var ji=!1;function zl(e,t){if(!e||ji)return"";ji=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var l={DetermineComponentFrameRoot:function(){try{if(t){var ke=function(){throw Error()};if(Object.defineProperty(ke.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ke,[])}catch(ye){var fe=ye}Reflect.construct(e,[],ke)}else{try{ke.call()}catch(ye){fe=ye}e.call(ke.prototype)}}else{try{throw Error()}catch(ye){fe=ye}(ke=e())&&typeof ke.catch=="function"&&ke.catch(function(){})}}catch(ye){if(ye&&fe&&typeof ye.stack=="string")return[ye.stack,fe.stack]}return[null,null]}};l.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var a=Object.getOwnPropertyDescriptor(l.DetermineComponentFrameRoot,"name");a&&a.configurable&&Object.defineProperty(l.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=l.DetermineComponentFrameRoot(),h=s[0],S=s[1];if(h&&S){var E=h.split(`
`),ae=S.split(`
`);for(a=l=0;l<E.length&&!E[l].includes("DetermineComponentFrameRoot");)l++;for(;a<ae.length&&!ae[a].includes("DetermineComponentFrameRoot");)a++;if(l===E.length||a===ae.length)for(l=E.length-1,a=ae.length-1;1<=l&&0<=a&&E[l]!==ae[a];)a--;for(;1<=l&&0<=a;l--,a--)if(E[l]!==ae[a]){if(l!==1||a!==1)do if(l--,a--,0>a||E[l]!==ae[a]){var we=`
`+E[l].replace(" at new "," at ");return e.displayName&&we.includes("<anonymous>")&&(we=we.replace("<anonymous>",e.displayName)),we}while(1<=l&&0<=a);break}}}finally{ji=!1,Error.prepareStackTrace=i}return(i=e?e.displayName||e.name:"")?pi(i):""}function $i(e,t){switch(e.tag){case 26:case 27:case 5:return pi(e.type);case 16:return pi("Lazy");case 13:return e.child!==t&&t!==null?pi("Suspense Fallback"):pi("Suspense");case 19:return pi("SuspenseList");case 0:case 15:return zl(e.type,!1);case 11:return zl(e.type.render,!1);case 1:return zl(e.type,!0);case 31:return pi("Activity");default:return""}}function kl(e){try{var t="",i=null;do t+=$i(e,i),i=e,e=e.return;while(e);return t}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}var Zo=Object.prototype.hasOwnProperty,yr=c.unstable_scheduleCallback,Ko=c.unstable_cancelCallback,$c=c.unstable_shouldYield,Ze=c.unstable_requestPaint,ft=c.unstable_now,Lc=c.unstable_getCurrentPriorityLevel,_e=c.unstable_ImmediatePriority,Pt=c.unstable_UserBlockingPriority,Kl=c.unstable_NormalPriority,jo=c.unstable_LowPriority,Xt=c.unstable_IdlePriority,hi=c.log,Rl=c.unstable_setDisableYieldValue,Pi=null,De=null;function Gn(e){if(typeof hi=="function"&&Rl(e),De&&typeof De.setStrictMode=="function")try{De.setStrictMode(Pi,e)}catch{}}var tt=Math.clz32?Math.clz32:br,Dn=Math.log,Ql=Math.LN2;function br(e){return e>>>=0,e===0?32:31-(Dn(e)/Ql|0)|0}var Jl=256,bs=262144,Mt=4194304;function Ti(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function eo(e,t,i){var l=e.pendingLanes;if(l===0)return 0;var a=0,s=e.suspendedLanes,h=e.pingedLanes;e=e.warmLanes;var S=l&134217727;return S!==0?(l=S&~s,l!==0?a=Ti(l):(h&=S,h!==0?a=Ti(h):i||(i=S&~e,i!==0&&(a=Ti(i))))):(S=l&~s,S!==0?a=Ti(S):h!==0?a=Ti(h):i||(i=l&~e,i!==0&&(a=Ti(i)))),a===0?0:t!==0&&t!==a&&(t&s)===0&&(s=a&-a,i=t&-t,s>=i||s===32&&(i&4194048)!==0)?t:a}function Li(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function _a(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Oi(){var e=Mt;return Mt<<=1,(Mt&62914560)===0&&(Mt=4194304),e}function al(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function to(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Kr(e,t,i,l,a,s){var h=e.pendingLanes;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=i,e.entangledLanes&=i,e.errorRecoveryDisabledLanes&=i,e.shellSuspendCounter=0;var S=e.entanglements,E=e.expirationTimes,ae=e.hiddenUpdates;for(i=h&~i;0<i;){var we=31-tt(i),ke=1<<we;S[we]=0,E[we]=-1;var fe=ae[we];if(fe!==null)for(ae[we]=null,we=0;we<fe.length;we++){var ye=fe[we];ye!==null&&(ye.lane&=-536870913)}i&=~ke}l!==0&&We(e,l,0),s!==0&&a===0&&e.tag!==0&&(e.suspendedLanes|=s&~(h&~t))}function We(e,t,i){e.pendingLanes|=t,e.suspendedLanes&=~t;var l=31-tt(t);e.entangledLanes|=t,e.entanglements[l]=e.entanglements[l]|1073741824|i&261930}function Ci(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var l=31-tt(i),a=1<<l;a&t|e[l]&t&&(e[l]|=t),i&=~a}}function zt(e,t){var i=t&-t;return i=(i&42)!==0?1:Vn(i),(i&(e.suspendedLanes|t))!==0?0:i}function Vn(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function ms(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function mr(){var e=I.p;return e!==0?e:(e=window.event,e===void 0?32:ch(e.type))}function vr(e,t){var i=I.p;try{return I.p=e,t()}finally{I.p=i}}var sl=Math.random().toString(36).slice(2),pt="__reactFiber$"+sl,Pn="__reactProps$"+sl,Ft="__reactContainer$"+sl,Ha="__reactEvents$"+sl,sn="__reactListeners$"+sl,Sr="__reactHandles$"+sl,kn="__reactResources$"+sl,To="__reactMarker$"+sl;function Qo(e){delete e[pt],delete e[Pn],delete e[Ha],delete e[sn],delete e[Sr]}function Dl(e){var t=e[pt];if(t)return t;for(var i=e.parentNode;i;){if(t=i[Ft]||i[pt]){if(i=t.alternate,t.child!==null||i!==null&&i.child!==null)for(e=Xp(e);e!==null;){if(i=e[pt])return i;e=Xp(e)}return t}e=i,i=e.parentNode}return null}function rl(e){if(e=e[pt]||e[Ft]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function Al(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(d(33))}function Jo(e){var t=e[kn];return t||(t=e[kn]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Bt(e){e[To]=!0}var Qr=new Set,Ht={};function rn(e,t){cl(e,t),cl(e+"Capture",t)}function cl(e,t){for(Ht[e]=t,e=0;e<t.length;e++)Qr.add(t[e])}var Jr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ea={},wr={};function Yi(e){return Zo.call(wr,e)?!0:Zo.call(ea,e)?!1:Jr.test(e)?wr[e]=!0:(ea[e]=!0,!1)}function gi(e,t,i){if(Yi(t))if(i===null)e.removeAttribute(t);else{switch(typeof i){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var l=t.toLowerCase().slice(0,5);if(l!=="data-"&&l!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+i)}}function Ea(e,t,i){if(i===null)e.removeAttribute(t);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+i)}}function Wn(e,t,i,l){if(l===null)e.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(i);return}e.setAttributeNS(t,i,""+l)}}function wn(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function xi(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function no(e,t,i){var l=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var a=l.get,s=l.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(h){i=""+h,s.call(this,h)}}),Object.defineProperty(e,t,{enumerable:l.enumerable}),{getValue:function(){return i},setValue:function(h){i=""+h},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function cn(e){if(!e._valueTracker){var t=xi(e)?"checked":"value";e._valueTracker=no(e,t,""+e[t])}}function Fn(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),l="";return e&&(l=xi(e)?e.checked?"true":"false":e.value),e=l,e!==i?(t.setValue(e),!0):!1}function ta(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Yc=/[\n"\\]/g;function yi(e){return e.replace(Yc,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function Ia(e,t,i,l,a,s,h,S){e.name="",h!=null&&typeof h!="function"&&typeof h!="symbol"&&typeof h!="boolean"?e.type=h:e.removeAttribute("type"),t!=null?h==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+wn(t)):e.value!==""+wn(t)&&(e.value=""+wn(t)):h!=="submit"&&h!=="reset"||e.removeAttribute("value"),t!=null?Va(e,h,wn(t)):i!=null?Va(e,h,wn(i)):l!=null&&e.removeAttribute("value"),a==null&&s!=null&&(e.defaultChecked=!!s),a!=null&&(e.checked=a&&typeof a!="function"&&typeof a!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?e.name=""+wn(S):e.removeAttribute("name")}function io(e,t,i,l,a,s,h,S){if(s!=null&&typeof s!="function"&&typeof s!="symbol"&&typeof s!="boolean"&&(e.type=s),t!=null||i!=null){if(!(s!=="submit"&&s!=="reset"||t!=null)){cn(e);return}i=i!=null?""+wn(i):"",t=t!=null?""+wn(t):i,S||t===e.value||(e.value=t),e.defaultValue=t}l=l??a,l=typeof l!="function"&&typeof l!="symbol"&&!!l,e.checked=S?e.checked:!!l,e.defaultChecked=!!l,h!=null&&typeof h!="function"&&typeof h!="symbol"&&typeof h!="boolean"&&(e.name=h),cn(e)}function Va(e,t,i){t==="number"&&ta(e.ownerDocument)===e||e.defaultValue===""+i||(e.defaultValue=""+i)}function lo(e,t,i,l){if(e=e.options,t){t={};for(var a=0;a<i.length;a++)t["$"+i[a]]=!0;for(i=0;i<e.length;i++)a=t.hasOwnProperty("$"+e[i].value),e[i].selected!==a&&(e[i].selected=a),a&&l&&(e[i].defaultSelected=!0)}else{for(i=""+wn(i),t=null,a=0;a<e.length;a++){if(e[a].value===i){e[a].selected=!0,l&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function On(e,t,i){if(t!=null&&(t=""+wn(t),t!==e.value&&(e.value=t),i==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=i!=null?""+wn(i):""}function Ve(e,t,i,l){if(t==null){if(l!=null){if(i!=null)throw Error(d(92));if(ce(l)){if(1<l.length)throw Error(d(93));l=l[0]}i=l}i==null&&(i=""),t=i}i=wn(t),e.defaultValue=i,l=e.textContent,l===i&&l!==""&&l!==null&&(e.value=l),cn(e)}function qe(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=t;return}}e.textContent=t}var ct=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Wa(e,t,i){var l=t.indexOf("--")===0;i==null||typeof i=="boolean"||i===""?l?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":l?e.setProperty(t,i):typeof i!="number"||i===0||ct.has(t)?t==="float"?e.cssFloat=i:e[t]=(""+i).trim():e[t]=i+"px"}function Xi(e,t,i){if(t!=null&&typeof t!="object")throw Error(d(62));if(e=e.style,i!=null){for(var l in i)!i.hasOwnProperty(l)||t!=null&&t.hasOwnProperty(l)||(l.indexOf("--")===0?e.setProperty(l,""):l==="float"?e.cssFloat="":e[l]="");for(var a in t)l=t[a],t.hasOwnProperty(a)&&i[a]!==l&&Wa(e,a,l)}else for(var s in t)t.hasOwnProperty(s)&&Wa(e,s,t[s])}function mt(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Et=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function at(e){return Et.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function jt(){}var ht=null;function Xc(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Je=null,tn=null;function dt(e){var t=rl(e);if(t&&(e=t.stateNode)){var i=e[Pn]||null;e:switch(e=t.stateNode,t.type){case"input":if(Ia(e,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name),t=i.name,i.type==="radio"&&t!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll('input[name="'+yi(""+t)+'"][type="radio"]'),t=0;t<i.length;t++){var l=i[t];if(l!==e&&l.form===e.form){var a=l[Pn]||null;if(!a)throw Error(d(90));Ia(l,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name)}}for(t=0;t<i.length;t++)l=i[t],l.form===e.form&&Fn(l)}break e;case"textarea":On(e,i.value,i.defaultValue);break e;case"select":t=i.value,t!=null&&lo(e,!!i.multiple,t,!1)}}}var bn=!1;function Fa(e,t,i){if(bn)return e(t,i);bn=!0;try{var l=e(t);return l}finally{if(bn=!1,(Je!==null||tn!==null)&&(mu(),Je&&(t=Je,e=tn,tn=Je=null,dt(t),e)))for(t=0;t<e.length;t++)dt(e[t])}}function $a(e,t){var i=e.stateNode;if(i===null)return null;var l=i[Pn]||null;if(l===null)return null;i=l[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(d(231,t,typeof i));return i}var An=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),na=!1;if(An)try{var Gi={};Object.defineProperty(Gi,"passive",{get:function(){na=!0}}),window.addEventListener("test",Gi,Gi),window.removeEventListener("test",Gi,Gi)}catch{na=!1}var qi=null,jr=null,Tr=null;function vs(){if(Tr)return Tr;var e,t=jr,i=t.length,l,a="value"in qi?qi.value:qi.textContent,s=a.length;for(e=0;e<i&&t[e]===a[e];e++);var h=i-e;for(l=1;l<=h&&t[i-l]===a[s-l];l++);return Tr=a.slice(e,1<l?1-l:void 0)}function Cr(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function zr(){return!0}function Fd(){return!1}function Xe(e){function t(i,l,a,s,h){this._reactName=i,this._targetInst=a,this.type=l,this.nativeEvent=s,this.target=h,this.currentTarget=null;for(var S in e)e.hasOwnProperty(S)&&(i=e[S],this[S]=i?i(s):s[S]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?zr:Fd,this.isPropagationStopped=Fd,this}return ge(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=zr)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=zr)},persist:function(){},isPersistent:zr}),t}var zi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qt=Xe(zi),Nl=ge({},zi,{view:0,detail:0}),ki=Xe(Nl),ni,ii,Qn,bi=ge({},Nl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:oa,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Qn&&(Qn&&e.type==="mousemove"?(ni=e.screenX-Qn.screenX,ii=e.screenY-Qn.screenY):ii=ni=0,Qn=e),ni)},movementY:function(e){return"movementY"in e?e.movementY:ii}}),ia=Xe(bi),Fu=ge({},bi,{dataTransfer:0}),dl=Xe(Fu),$d=ge({},Nl,{relatedTarget:0}),la=Xe($d),$u=ge({},zi,{animationName:0,elapsedTime:0,pseudoElement:0}),Ri=Xe($u),Ss=ge({},zi,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),mi=Xe(Ss),ws=ge({},zi,{data:0}),_i=Xe(ws),kr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Co={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Gc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vi(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Gc[e])?!!t[e]:!1}function oa(){return vi}var Hi=ge({},Nl,{key:function(e){if(e.key){var t=kr[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Cr(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Co[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:oa,charCode:function(e){return e.type==="keypress"?Cr(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Cr(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),js=Xe(Hi),Ei=ge({},bi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),La=Xe(Ei),Rn=ge({},Nl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:oa}),Ts=Xe(Rn),Lu=ge({},zi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Yu=Xe(Lu),Rr=ge({},bi,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ec=Xe(Rr),tc=ge({},zi,{newState:0,oldState:0}),qc=Xe(tc),aa=[9,13,27,32],Cs=An&&"CompositionEvent"in window,Di=null;An&&"documentMode"in document&&(Di=document.documentMode);var zs=An&&"TextEvent"in window&&!Di,sa=An&&(!Cs||Di&&8<Di&&11>=Di),nc=" ",Ya=!1;function ic(e,t){switch(e){case"keyup":return aa.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ra(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ca=!1;function ks(e,t){switch(e){case"compositionend":return ra(t);case"keypress":return t.which!==32?null:(Ya=!0,nc);case"textInput":return e=t.data,e===nc&&Ya?null:e;default:return null}}function nn(e,t){if(ca)return e==="compositionend"||!Cs&&ic(e,t)?(e=vs(),Tr=jr=qi=null,ca=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return sa&&t.locale!=="ko"?null:t.data;default:return null}}var Xa={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Xa[e.type]:t==="textarea"}function da(e,t,i,l){Je?tn?tn.push(l):tn=[l]:Je=l,t=zu(t,"onChange"),0<t.length&&(i=new qt("onChange","change",null,i,l),e.push({event:i,listeners:t}))}var Ga=null,oo=null;function Xu(e){Bp(e,0)}function Rs(e){var t=Al(e);if(Fn(t))return e}function Ld(e,t){if(e==="change")return t}var Yd=!1;if(An){var zo;if(An){var li="oninput"in document;if(!li){var Zi=document.createElement("div");Zi.setAttribute("oninput","return;"),li=typeof Zi.oninput=="function"}zo=li}else zo=!1;Yd=zo&&(!document.documentMode||9<document.documentMode)}function ua(){Ga&&(Ga.detachEvent("onpropertychange",Ml),oo=Ga=null)}function Ml(e){if(e.propertyName==="value"&&Rs(oo)){var t=[];da(t,oo,e,Xc(e)),Fa(Xu,t)}}function fa(e,t,i){e==="focusin"?(ua(),Ga=t,oo=i,Ga.attachEvent("onpropertychange",Ml)):e==="focusout"&&ua()}function pa(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Rs(oo)}function ha(e,t){if(e==="click")return Rs(t)}function Bl(e,t){if(e==="input"||e==="change")return Rs(t)}function lc(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ln=typeof Object.is=="function"?Object.is:lc;function on(e,t){if(ln(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var i=Object.keys(e),l=Object.keys(t);if(i.length!==l.length)return!1;for(l=0;l<i.length;l++){var a=i[l];if(!Zo.call(t,a)||!ln(e[a],t[a]))return!1}return!0}function Ul(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function oi(e,t){var i=Ul(e);e=0;for(var l;i;){if(i.nodeType===3){if(l=e+i.textContent.length,e<=t&&l>=t)return{node:i,offset:t-e};e=l}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=Ul(i)}}function ul(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?ul(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Xd(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=ta(e.document);t instanceof e.HTMLIFrameElement;){try{var i=typeof t.contentWindow.location.href=="string"}catch{i=!1}if(i)e=t.contentWindow;else break;t=ta(e.document)}return t}function ko(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var Gd=An&&"documentMode"in document&&11>=document.documentMode,Ro=null,Zt=null,Ai=null,Dr=!1;function Zc(e,t,i){var l=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;Dr||Ro==null||Ro!==ta(l)||(l=Ro,"selectionStart"in l&&ko(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),Ai&&on(Ai,l)||(Ai=l,l=zu(Zt,"onSelect"),0<l.length&&(t=new qt("onSelect","select",null,t,i),e.push({event:t,listeners:l}),t.target=Ro)))}function ga(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var xa={animationend:ga("Animation","AnimationEnd"),animationiteration:ga("Animation","AnimationIteration"),animationstart:ga("Animation","AnimationStart"),transitionrun:ga("Transition","TransitionRun"),transitionstart:ga("Transition","TransitionStart"),transitioncancel:ga("Transition","TransitionCancel"),transitionend:ga("Transition","TransitionEnd")},Ds={},Ar={};An&&(Ar=document.createElement("div").style,"AnimationEvent"in window||(delete xa.animationend.animation,delete xa.animationiteration.animation,delete xa.animationstart.animation),"TransitionEvent"in window||delete xa.transitionend.transition);function Pl(e){if(Ds[e])return Ds[e];if(!xa[e])return e;var t=xa[e],i;for(i in t)if(t.hasOwnProperty(i)&&i in Ar)return Ds[e]=t[i];return e}var Kc=Pl("animationend"),ya=Pl("animationiteration"),As=Pl("animationstart"),qa=Pl("transitionrun"),Ns=Pl("transitionstart"),oc=Pl("transitioncancel"),Nr=Pl("transitionend"),Ms=new Map,Za="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Za.push("scrollEnd");function fl(e,t){Ms.set(e,t),rn(t,[e])}var Ki=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},pn=[],Do=0,ac=0;function ba(){for(var e=Do,t=ac=Do=0;t<e;){var i=pn[t];pn[t++]=null;var l=pn[t];pn[t++]=null;var a=pn[t];pn[t++]=null;var s=pn[t];if(pn[t++]=null,l!==null&&a!==null){var h=l.pending;h===null?a.next=a:(a.next=h.next,h.next=a),l.pending=a}s!==0&&Ka(i,a,s)}}function ao(e,t,i,l){pn[Do++]=e,pn[Do++]=t,pn[Do++]=i,pn[Do++]=l,ac|=l,e.lanes|=l,e=e.alternate,e!==null&&(e.lanes|=l)}function Bs(e,t,i,l){return ao(e,t,i,l),sc(e)}function pl(e,t){return ao(e,null,null,t),sc(e)}function Ka(e,t,i){e.lanes|=i;var l=e.alternate;l!==null&&(l.lanes|=i);for(var a=!1,s=e.return;s!==null;)s.childLanes|=i,l=s.alternate,l!==null&&(l.childLanes|=i),s.tag===22&&(e=s.stateNode,e===null||e._visibility&1||(a=!0)),e=s,s=s.return;return e.tag===3?(s=e.stateNode,a&&t!==null&&(a=31-tt(i),e=s.hiddenUpdates,l=e[a],l===null?e[a]=[t]:l.push(t),t.lane=i|536870912),s):null}function sc(e){if(50<zd)throw zd=0,lf=null,Error(d(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Qa={};function qd(e,t,i,l){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qi(e,t,i,l){return new qd(e,t,i,l)}function Us(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ol(e,t){var i=e.alternate;return i===null?(i=Qi(e.tag,t,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&65011712,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i.refCleanup=e.refCleanup,i}function Qc(e,t){e.flags&=65011714;var i=e.alternate;return i===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=i.childLanes,e.lanes=i.lanes,e.child=i.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=i.memoizedProps,e.memoizedState=i.memoizedState,e.updateQueue=i.updateQueue,e.type=i.type,t=i.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Mr(e,t,i,l,a,s){var h=0;if(l=e,typeof e=="function")Us(e)&&(h=1);else if(typeof e=="string")h=wg(e,i,Z.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case O:return e=Qi(31,i,t,a),e.elementType=O,e.lanes=s,e;case Re:return ma(i.children,a,s,t);case B:h=8,a|=24;break;case te:return e=Qi(12,i,t,a|2),e.elementType=te,e.lanes=s,e;case N:return e=Qi(13,i,t,a),e.elementType=N,e.lanes=s,e;case z:return e=Qi(19,i,t,a),e.elementType=z,e.lanes=s,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case L:h=10;break e;case $e:h=9;break e;case re:h=11;break e;case D:h=14;break e;case P:h=16,l=null;break e}h=29,i=Error(d(130,e===null?"null":typeof e,"")),l=null}return t=Qi(h,i,t,a),t.elementType=e,t.type=l,t.lanes=s,t}function ma(e,t,i,l){return e=Qi(7,e,l,t),e.lanes=i,e}function va(e,t,i){return e=Qi(6,e,null,t),e.lanes=i,e}function _l(e){var t=Qi(18,null,null,0);return t.stateNode=e,t}function Sa(e,t,i){return t=Qi(4,e.children!==null?e.children:[],e.key,t),t.lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Hl=new WeakMap;function dn(e,t){if(typeof e=="object"&&e!==null){var i=Hl.get(e);return i!==void 0?i:(t={value:e,source:t,stack:kl(t)},Hl.set(e,t),t)}return{value:e,source:t,stack:kl(t)}}var Ji=[],qn=0,El=null,Jn=0,Zn=[],jn=0,Ni=null,Nn=1,ai="";function ei(e,t){Ji[qn++]=Jn,Ji[qn++]=El,El=e,Jn=t}function Ja(e,t,i){Zn[jn++]=Nn,Zn[jn++]=ai,Zn[jn++]=Ni,Ni=e;var l=Nn;e=ai;var a=32-tt(l)-1;l&=~(1<<a),i+=1;var s=32-tt(t)+a;if(30<s){var h=a-a%5;s=(l&(1<<h)-1).toString(32),l>>=h,a-=h,Nn=1<<32-tt(t)+a|i<<a|l,ai=s+e}else Nn=1<<s|i<<a|l,ai=e}function hl(e){e.return!==null&&(ei(e,1),Ja(e,1,0))}function wa(e){for(;e===El;)El=Ji[--qn],Ji[qn]=null,Jn=Ji[--qn],Ji[qn]=null;for(;e===Ni;)Ni=Zn[--jn],Zn[jn]=null,ai=Zn[--jn],Zn[jn]=null,Nn=Zn[--jn],Zn[jn]=null}function el(e,t){Zn[jn++]=Nn,Zn[jn++]=ai,Zn[jn++]=Ni,Nn=t.id,ai=t.overflow,Ni=e}var vn=null,Ut=null,wt=!1,si=null,Kn=!1,yt=Error(d(519));function st(e){var t=Error(d(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw _s(dn(t,e)),yt}function Zd(e){var t=e.stateNode,i=e.type,l=e.memoizedProps;switch(t[pt]=e,t[Pn]=l,i){case"dialog":_t("cancel",t),_t("close",t);break;case"iframe":case"object":case"embed":_t("load",t);break;case"video":case"audio":for(i=0;i<Rd.length;i++)_t(Rd[i],t);break;case"source":_t("error",t);break;case"img":case"image":case"link":_t("error",t),_t("load",t);break;case"details":_t("toggle",t);break;case"input":_t("invalid",t),io(t,l.value,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name,!0);break;case"select":_t("invalid",t);break;case"textarea":_t("invalid",t),Ve(t,l.value,l.defaultValue,l.children)}i=l.children,typeof i!="string"&&typeof i!="number"&&typeof i!="bigint"||t.textContent===""+i||l.suppressHydrationWarning===!0||_p(t.textContent,i)?(l.popover!=null&&(_t("beforetoggle",t),_t("toggle",t)),l.onScroll!=null&&_t("scroll",t),l.onScrollEnd!=null&&_t("scrollend",t),l.onClick!=null&&(t.onclick=jt),t=!0):t=!1,t||st(e,!0)}function Ps(e){for(vn=e.return;vn;)switch(vn.tag){case 5:case 31:case 13:Kn=!1;return;case 27:case 3:Kn=!0;return;default:vn=vn.return}}function Os(e){if(e!==vn)return!1;if(!wt)return Ps(e),wt=!0,!1;var t=e.tag,i;if((i=t!==3&&t!==27)&&((i=t===5)&&(i=e.type,i=!(i!=="form"&&i!=="button")||mf(e.type,e.memoizedProps)),i=!i),i&&Ut&&st(e),Ps(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(d(317));Ut=Yp(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(d(317));Ut=Yp(e)}else t===27?(t=Ut,ur(e.type)?(e=Tf,Tf=null,Ut=e):Ut=t):Ut=vn?mo(e.stateNode.nextSibling):null;return!0}function es(){Ut=vn=null,wt=!1}function Br(){var e=si;return e!==null&&(Tl===null?Tl=e:Tl.push.apply(Tl,e),si=null),e}function _s(e){si===null?si=[e]:si.push(e)}var Ao=w(null),No=null,Mo=null;function Bo(e,t,i){$(Ao,t._currentValue),t._currentValue=i}function Il(e){e._currentValue=Ao.current,U(Ao)}function $n(e,t,i){for(;e!==null;){var l=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,l!==null&&(l.childLanes|=t)):l!==null&&(l.childLanes&t)!==t&&(l.childLanes|=t),e===i)break;e=e.return}}function tl(e,t,i,l){var a=e.child;for(a!==null&&(a.return=e);a!==null;){var s=a.dependencies;if(s!==null){var h=a.child;s=s.firstContext;e:for(;s!==null;){var S=s;s=a;for(var E=0;E<t.length;E++)if(S.context===t[E]){s.lanes|=i,S=s.alternate,S!==null&&(S.lanes|=i),$n(s.return,i,e),l||(h=null);break e}s=S.next}}else if(a.tag===18){if(h=a.return,h===null)throw Error(d(341));h.lanes|=i,s=h.alternate,s!==null&&(s.lanes|=i),$n(h,i,e),h=null}else h=a.child;if(h!==null)h.return=a;else for(h=a;h!==null;){if(h===e){h=null;break}if(a=h.sibling,a!==null){a.return=h.return,h=a;break}h=h.return}a=h}}function gl(e,t,i,l){e=null;for(var a=t,s=!1;a!==null;){if(!s){if((a.flags&524288)!==0)s=!0;else if((a.flags&262144)!==0)break}if(a.tag===10){var h=a.alternate;if(h===null)throw Error(d(387));if(h=h.memoizedProps,h!==null){var S=a.type;ln(a.pendingProps.value,h.value)||(e!==null?e.push(S):e=[S])}}else if(a===xt.current){if(h=a.alternate,h===null)throw Error(d(387));h.memoizedState.memoizedState!==a.memoizedState.memoizedState&&(e!==null?e.push(Bd):e=[Bd])}a=a.return}e!==null&&tl(t,e,i,l),t.flags|=262144}function rc(e){for(e=e.firstContext;e!==null;){if(!ln(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Vl(e){No=e,Mo=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function ri(e){return dc(No,e)}function cc(e,t){return No===null&&Vl(e),dc(e,t)}function dc(e,t){var i=t._currentValue;if(t={context:t,memoizedValue:i,next:null},Mo===null){if(e===null)throw Error(d(308));Mo=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Mo=Mo.next=t;return i}var ti=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(i,l){e.push(l)}};this.abort=function(){t.aborted=!0,e.forEach(function(i){return i()})}},nl=c.unstable_scheduleCallback,ts=c.unstable_NormalPriority,Tn={$$typeof:L,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ns(){return{controller:new ti,data:new Map,refCount:0}}function Uo(e){e.refCount--,e.refCount===0&&nl(ts,function(){e.controller.abort()})}var so=null,Jc=0,Po=0,xl=null;function Wl(e,t){if(so===null){var i=so=[];Jc=0,Po=df(),xl={status:"pending",value:void 0,then:function(l){i.push(l)}}}return Jc++,t.then(Oo,Oo),t}function Oo(){if(--Jc===0&&so!==null){xl!==null&&(xl.status="fulfilled");var e=so;so=null,Po=0,xl=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function ja(e,t){var i=[],l={status:"pending",value:null,reason:null,then:function(a){i.push(a)}};return e.then(function(){l.status="fulfilled",l.value=t;for(var a=0;a<i.length;a++)(0,i[a])(t)},function(a){for(l.status="rejected",l.reason=a,a=0;a<i.length;a++)(0,i[a])(void 0)}),l}var _o=H.S;H.S=function(e,t){sp=ft(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&Wl(e,t),_o!==null&&_o(e,t)};var Fl=w(null);function Ur(){var e=Fl.current;return e!==null?e:Sn.pooledCache}function Mi(e,t){t===null?$(Fl,Fl.current):$(Fl,t.pool)}function Hs(){var e=Ur();return e===null?null:{parent:Tn._currentValue,pool:e}}var Ta=Error(d(460)),uc=Error(d(474)),is=Error(d(542)),Pr={then:function(){}};function fc(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Ho(e,t,i){switch(i=e[i],i===void 0?e.push(t):i!==t&&(t.then(jt,jt),t=i),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,ed(e),e;default:if(typeof t.status=="string")t.then(jt,jt);else{if(e=Sn,e!==null&&100<e.shellSuspendCounter)throw Error(d(482));e=t,e.status="pending",e.then(function(l){if(t.status==="pending"){var a=t;a.status="fulfilled",a.value=l}},function(l){if(t.status==="pending"){var a=t;a.status="rejected",a.reason=l}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,ed(e),e}throw ro=t,Ta}}function yl(e){try{var t=e._init;return t(e._payload)}catch(i){throw i!==null&&typeof i=="object"&&typeof i.then=="function"?(ro=i,Ta):i}}var ro=null;function pc(){if(ro===null)throw Error(d(459));var e=ro;return ro=null,e}function ed(e){if(e===Ta||e===is)throw Error(d(483))}var Eo=null,Es=0;function Ca(e){var t=Es;return Es+=1,Eo===null&&(Eo=[]),Ho(Eo,e,t)}function Io(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Is(e,t){throw t.$$typeof===Te?Error(d(525)):(e=Object.prototype.toString.call(t),Error(d(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Or(e){function t(ee,Y){if(e){var oe=ee.deletions;oe===null?(ee.deletions=[Y],ee.flags|=16):oe.push(Y)}}function i(ee,Y){if(!e)return null;for(;Y!==null;)t(ee,Y),Y=Y.sibling;return null}function l(ee){for(var Y=new Map;ee!==null;)ee.key!==null?Y.set(ee.key,ee):Y.set(ee.index,ee),ee=ee.sibling;return Y}function a(ee,Y){return ee=Ol(ee,Y),ee.index=0,ee.sibling=null,ee}function s(ee,Y,oe){return ee.index=oe,e?(oe=ee.alternate,oe!==null?(oe=oe.index,oe<Y?(ee.flags|=67108866,Y):oe):(ee.flags|=67108866,Y)):(ee.flags|=1048576,Y)}function h(ee){return e&&ee.alternate===null&&(ee.flags|=67108866),ee}function S(ee,Y,oe,Ce){return Y===null||Y.tag!==6?(Y=va(oe,ee.mode,Ce),Y.return=ee,Y):(Y=a(Y,oe),Y.return=ee,Y)}function E(ee,Y,oe,Ce){var rt=oe.type;return rt===Re?we(ee,Y,oe.props.children,Ce,oe.key):Y!==null&&(Y.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===P&&yl(rt)===Y.type)?(Y=a(Y,oe.props),Io(Y,oe),Y.return=ee,Y):(Y=Mr(oe.type,oe.key,oe.props,null,ee.mode,Ce),Io(Y,oe),Y.return=ee,Y)}function ae(ee,Y,oe,Ce){return Y===null||Y.tag!==4||Y.stateNode.containerInfo!==oe.containerInfo||Y.stateNode.implementation!==oe.implementation?(Y=Sa(oe,ee.mode,Ce),Y.return=ee,Y):(Y=a(Y,oe.children||[]),Y.return=ee,Y)}function we(ee,Y,oe,Ce,rt){return Y===null||Y.tag!==7?(Y=ma(oe,ee.mode,Ce,rt),Y.return=ee,Y):(Y=a(Y,oe),Y.return=ee,Y)}function ke(ee,Y,oe){if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return Y=va(""+Y,ee.mode,oe),Y.return=ee,Y;if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case Ue:return oe=Mr(Y.type,Y.key,Y.props,null,ee.mode,oe),Io(oe,Y),oe.return=ee,oe;case se:return Y=Sa(Y,ee.mode,oe),Y.return=ee,Y;case P:return Y=yl(Y),ke(ee,Y,oe)}if(ce(Y)||j(Y))return Y=ma(Y,ee.mode,oe,null),Y.return=ee,Y;if(typeof Y.then=="function")return ke(ee,Ca(Y),oe);if(Y.$$typeof===L)return ke(ee,cc(ee,Y),oe);Is(ee,Y)}return null}function fe(ee,Y,oe,Ce){var rt=Y!==null?Y.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return rt!==null?null:S(ee,Y,""+oe,Ce);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case Ue:return oe.key===rt?E(ee,Y,oe,Ce):null;case se:return oe.key===rt?ae(ee,Y,oe,Ce):null;case P:return oe=yl(oe),fe(ee,Y,oe,Ce)}if(ce(oe)||j(oe))return rt!==null?null:we(ee,Y,oe,Ce,null);if(typeof oe.then=="function")return fe(ee,Y,Ca(oe),Ce);if(oe.$$typeof===L)return fe(ee,Y,cc(ee,oe),Ce);Is(ee,oe)}return null}function ye(ee,Y,oe,Ce,rt){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint")return ee=ee.get(oe)||null,S(Y,ee,""+Ce,rt);if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case Ue:return ee=ee.get(Ce.key===null?oe:Ce.key)||null,E(Y,ee,Ce,rt);case se:return ee=ee.get(Ce.key===null?oe:Ce.key)||null,ae(Y,ee,Ce,rt);case P:return Ce=yl(Ce),ye(ee,Y,oe,Ce,rt)}if(ce(Ce)||j(Ce))return ee=ee.get(oe)||null,we(Y,ee,Ce,rt,null);if(typeof Ce.then=="function")return ye(ee,Y,oe,Ca(Ce),rt);if(Ce.$$typeof===L)return ye(ee,Y,oe,cc(Y,Ce),rt);Is(Y,Ce)}return null}function Ge(ee,Y,oe,Ce){for(var rt=null,Kt=null,Qe=Y,Nt=Y=0,Wt=null;Qe!==null&&Nt<oe.length;Nt++){Qe.index>Nt?(Wt=Qe,Qe=null):Wt=Qe.sibling;var Qt=fe(ee,Qe,oe[Nt],Ce);if(Qt===null){Qe===null&&(Qe=Wt);break}e&&Qe&&Qt.alternate===null&&t(ee,Qe),Y=s(Qt,Y,Nt),Kt===null?rt=Qt:Kt.sibling=Qt,Kt=Qt,Qe=Wt}if(Nt===oe.length)return i(ee,Qe),wt&&ei(ee,Nt),rt;if(Qe===null){for(;Nt<oe.length;Nt++)Qe=ke(ee,oe[Nt],Ce),Qe!==null&&(Y=s(Qe,Y,Nt),Kt===null?rt=Qe:Kt.sibling=Qe,Kt=Qe);return wt&&ei(ee,Nt),rt}for(Qe=l(Qe);Nt<oe.length;Nt++)Wt=ye(Qe,ee,Nt,oe[Nt],Ce),Wt!==null&&(e&&Wt.alternate!==null&&Qe.delete(Wt.key===null?Nt:Wt.key),Y=s(Wt,Y,Nt),Kt===null?rt=Wt:Kt.sibling=Wt,Kt=Wt);return e&&Qe.forEach(function(xr){return t(ee,xr)}),wt&&ei(ee,Nt),rt}function bt(ee,Y,oe,Ce){if(oe==null)throw Error(d(151));for(var rt=null,Kt=null,Qe=Y,Nt=Y=0,Wt=null,Qt=oe.next();Qe!==null&&!Qt.done;Nt++,Qt=oe.next()){Qe.index>Nt?(Wt=Qe,Qe=null):Wt=Qe.sibling;var xr=fe(ee,Qe,Qt.value,Ce);if(xr===null){Qe===null&&(Qe=Wt);break}e&&Qe&&xr.alternate===null&&t(ee,Qe),Y=s(xr,Y,Nt),Kt===null?rt=xr:Kt.sibling=xr,Kt=xr,Qe=Wt}if(Qt.done)return i(ee,Qe),wt&&ei(ee,Nt),rt;if(Qe===null){for(;!Qt.done;Nt++,Qt=oe.next())Qt=ke(ee,Qt.value,Ce),Qt!==null&&(Y=s(Qt,Y,Nt),Kt===null?rt=Qt:Kt.sibling=Qt,Kt=Qt);return wt&&ei(ee,Nt),rt}for(Qe=l(Qe);!Qt.done;Nt++,Qt=oe.next())Qt=ye(Qe,ee,Nt,Qt.value,Ce),Qt!==null&&(e&&Qt.alternate!==null&&Qe.delete(Qt.key===null?Nt:Qt.key),Y=s(Qt,Y,Nt),Kt===null?rt=Qt:Kt.sibling=Qt,Kt=Qt);return e&&Qe.forEach(function(Bg){return t(ee,Bg)}),wt&&ei(ee,Nt),rt}function yn(ee,Y,oe,Ce){if(typeof oe=="object"&&oe!==null&&oe.type===Re&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case Ue:e:{for(var rt=oe.key;Y!==null;){if(Y.key===rt){if(rt=oe.type,rt===Re){if(Y.tag===7){i(ee,Y.sibling),Ce=a(Y,oe.props.children),Ce.return=ee,ee=Ce;break e}}else if(Y.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===P&&yl(rt)===Y.type){i(ee,Y.sibling),Ce=a(Y,oe.props),Io(Ce,oe),Ce.return=ee,ee=Ce;break e}i(ee,Y);break}else t(ee,Y);Y=Y.sibling}oe.type===Re?(Ce=ma(oe.props.children,ee.mode,Ce,oe.key),Ce.return=ee,ee=Ce):(Ce=Mr(oe.type,oe.key,oe.props,null,ee.mode,Ce),Io(Ce,oe),Ce.return=ee,ee=Ce)}return h(ee);case se:e:{for(rt=oe.key;Y!==null;){if(Y.key===rt)if(Y.tag===4&&Y.stateNode.containerInfo===oe.containerInfo&&Y.stateNode.implementation===oe.implementation){i(ee,Y.sibling),Ce=a(Y,oe.children||[]),Ce.return=ee,ee=Ce;break e}else{i(ee,Y);break}else t(ee,Y);Y=Y.sibling}Ce=Sa(oe,ee.mode,Ce),Ce.return=ee,ee=Ce}return h(ee);case P:return oe=yl(oe),yn(ee,Y,oe,Ce)}if(ce(oe))return Ge(ee,Y,oe,Ce);if(j(oe)){if(rt=j(oe),typeof rt!="function")throw Error(d(150));return oe=rt.call(oe),bt(ee,Y,oe,Ce)}if(typeof oe.then=="function")return yn(ee,Y,Ca(oe),Ce);if(oe.$$typeof===L)return yn(ee,Y,cc(ee,oe),Ce);Is(ee,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint"?(oe=""+oe,Y!==null&&Y.tag===6?(i(ee,Y.sibling),Ce=a(Y,oe),Ce.return=ee,ee=Ce):(i(ee,Y),Ce=va(oe,ee.mode,Ce),Ce.return=ee,ee=Ce),h(ee)):i(ee,Y)}return function(ee,Y,oe,Ce){try{Es=0;var rt=yn(ee,Y,oe,Ce);return Eo=null,rt}catch(Qe){if(Qe===Ta||Qe===is)throw Qe;var Kt=Qi(29,Qe,null,ee.mode);return Kt.lanes=Ce,Kt.return=ee,Kt}finally{}}}var bl=Or(!0),Vs=Or(!1),co=!1;function _r(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ws(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function uo(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function za(e,t,i){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,(en&2)!==0){var a=l.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),l.pending=t,t=sc(e),Ka(e,null,i),t}return ao(e,l,t,i),sc(e)}function ls(e,t,i){if(t=t.updateQueue,t!==null&&(t=t.shared,(i&4194048)!==0)){var l=t.lanes;l&=e.pendingLanes,i|=l,t.lanes=i,Ci(e,i)}}function td(e,t){var i=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,i===l)){var a=null,s=null;if(i=i.firstBaseUpdate,i!==null){do{var h={lane:i.lane,tag:i.tag,payload:i.payload,callback:null,next:null};s===null?a=s=h:s=s.next=h,i=i.next}while(i!==null);s===null?a=s=t:s=s.next=t}else a=s=t;i={baseState:l.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:l.shared,callbacks:l.callbacks},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}var Fs=!1;function Ii(){if(Fs){var e=xl;if(e!==null)throw e}}function Vi(e,t,i,l){Fs=!1;var a=e.updateQueue;co=!1;var s=a.firstBaseUpdate,h=a.lastBaseUpdate,S=a.shared.pending;if(S!==null){a.shared.pending=null;var E=S,ae=E.next;E.next=null,h===null?s=ae:h.next=ae,h=E;var we=e.alternate;we!==null&&(we=we.updateQueue,S=we.lastBaseUpdate,S!==h&&(S===null?we.firstBaseUpdate=ae:S.next=ae,we.lastBaseUpdate=E))}if(s!==null){var ke=a.baseState;h=0,we=ae=E=null,S=s;do{var fe=S.lane&-536870913,ye=fe!==S.lane;if(ye?(Vt&fe)===fe:(l&fe)===fe){fe!==0&&fe===Po&&(Fs=!0),we!==null&&(we=we.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var Ge=e,bt=S;fe=t;var yn=i;switch(bt.tag){case 1:if(Ge=bt.payload,typeof Ge=="function"){ke=Ge.call(yn,ke,fe);break e}ke=Ge;break e;case 3:Ge.flags=Ge.flags&-65537|128;case 0:if(Ge=bt.payload,fe=typeof Ge=="function"?Ge.call(yn,ke,fe):Ge,fe==null)break e;ke=ge({},ke,fe);break e;case 2:co=!0}}fe=S.callback,fe!==null&&(e.flags|=64,ye&&(e.flags|=8192),ye=a.callbacks,ye===null?a.callbacks=[fe]:ye.push(fe))}else ye={lane:fe,tag:S.tag,payload:S.payload,callback:S.callback,next:null},we===null?(ae=we=ye,E=ke):we=we.next=ye,h|=fe;if(S=S.next,S===null){if(S=a.shared.pending,S===null)break;ye=S,S=ye.next,ye.next=null,a.lastBaseUpdate=ye,a.shared.pending=null}}while(!0);we===null&&(E=ke),a.baseState=E,a.firstBaseUpdate=ae,a.lastBaseUpdate=we,s===null&&(a.shared.lanes=0),ar|=h,e.lanes=h,e.memoizedState=ke}}function fo(e,t){if(typeof e!="function")throw Error(d(191,e));e.call(t)}function Kd(e,t){var i=e.callbacks;if(i!==null)for(e.callbacks=null,e=0;e<i.length;e++)fo(i[e],t)}var $s=w(null),hc=w(0);function Qd(e,t){e=gs,$(hc,e),$($s,t),gs=e|t.baseLanes}function nd(){$(hc,gs),$($s,$s.current)}function id(){gs=hc.current,U($s),U(hc)}var Ln=w(null),ml=null;function ka(e){var t=e.alternate;$(_n,_n.current&1),$(Ln,e),ml===null&&(t===null||$s.current!==null||t.memoizedState!==null)&&(ml=e)}function ld(e){$(_n,_n.current),$(Ln,e),ml===null&&(ml=e)}function Jd(e){e.tag===22?($(_n,_n.current),$(Ln,e),ml===null&&(ml=e)):Ra()}function Ra(){$(_n,_n.current),$(Ln,Ln.current)}function il(e){U(Ln),ml===e&&(ml=null),U(_n)}var _n=w(0);function gc(e){for(var t=e;t!==null;){if(t.tag===13){var i=t.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||wf(i)||jf(i)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Vo=0,Tt=null,an=null,Cn=null,po=!1,$l=!1,ho=!1,Wo=0,os=0,Ll=null,Hr=0;function hn(){throw Error(d(321))}function Ls(e,t){if(t===null)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!ln(e[i],t[i]))return!1;return!0}function Ys(e,t,i,l,a,s){return Vo=s,Tt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,H.H=e===null||e.memoizedState===null?Cc:cs,ho=!1,s=i(l,a),ho=!1,$l&&(s=go(t,i,l,a)),Er(e),s}function Er(e){H.H=Ua;var t=an!==null&&an.next!==null;if(Vo=0,Cn=an=Tt=null,po=!1,os=0,Ll=null,t)throw Error(d(300));e===null||Yn||(e=e.dependencies,e!==null&&rc(e)&&(Yn=!0))}function go(e,t,i,l){Tt=e;var a=0;do{if($l&&(Ll=null),os=0,$l=!1,25<=a)throw Error(d(301));if(a+=1,Cn=an=null,e.updateQueue!=null){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,s.memoCache!=null&&(s.memoCache.index=0)}H.H=er,s=t(i,l)}while($l);return s}function Ir(){var e=H.H,t=e.useState()[0];return t=typeof t.then=="function"?Gs(t):t,e=e.useState()[0],(an!==null?an.memoizedState:null)!==e&&(Tt.flags|=1024),t}function Fo(){var e=Wo!==0;return Wo=0,e}function Wi(e,t,i){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i}function Xs(e){if(po){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}po=!1}Vo=0,Cn=an=Tt=null,$l=!1,os=Wo=0,Ll=null}function ci(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Cn===null?Tt.memoizedState=Cn=e:Cn=Cn.next=e,Cn}function Hn(){if(an===null){var e=Tt.alternate;e=e!==null?e.memoizedState:null}else e=an.next;var t=Cn===null?Tt.memoizedState:Cn.next;if(t!==null)Cn=t,an=e;else{if(e===null)throw Tt.alternate===null?Error(d(467)):Error(d(310));an=e,e={memoizedState:an.memoizedState,baseState:an.baseState,baseQueue:an.baseQueue,queue:an.queue,next:null},Cn===null?Tt.memoizedState=Cn=e:Cn=Cn.next=e}return Cn}function xc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Gs(e){var t=os;return os+=1,Ll===null&&(Ll=[]),e=Ho(Ll,e,t),t=Tt,(Cn===null?t.memoizedState:Cn.next)===null&&(t=t.alternate,H.H=t===null||t.memoizedState===null?Cc:cs),e}function xo(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Gs(e);if(e.$$typeof===L)return ri(e)}throw Error(d(438,String(e)))}function qs(e){var t=null,i=Tt.updateQueue;if(i!==null&&(t=i.memoCache),t==null){var l=Tt.alternate;l!==null&&(l=l.updateQueue,l!==null&&(l=l.memoCache,l!=null&&(t={data:l.data.map(function(a){return a.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),i===null&&(i=xc(),Tt.updateQueue=i),i.memoCache=t,i=t.data[t.index],i===void 0)for(i=t.data[t.index]=Array(e),l=0;l<e;l++)i[l]=he;return t.index++,i}function vl(e,t){return typeof t=="function"?t(e):t}function as(e){var t=Hn();return Vr(t,an,e)}function Vr(e,t,i){var l=e.queue;if(l===null)throw Error(d(311));l.lastRenderedReducer=i;var a=e.baseQueue,s=l.pending;if(s!==null){if(a!==null){var h=a.next;a.next=s.next,s.next=h}t.baseQueue=a=s,l.pending=null}if(s=e.baseState,a===null)e.memoizedState=s;else{t=a.next;var S=h=null,E=null,ae=t,we=!1;do{var ke=ae.lane&-536870913;if(ke!==ae.lane?(Vt&ke)===ke:(Vo&ke)===ke){var fe=ae.revertLane;if(fe===0)E!==null&&(E=E.next={lane:0,revertLane:0,gesture:null,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null}),ke===Po&&(we=!0);else if((Vo&fe)===fe){ae=ae.next,fe===Po&&(we=!0);continue}else ke={lane:0,revertLane:ae.revertLane,gesture:null,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},E===null?(S=E=ke,h=s):E=E.next=ke,Tt.lanes|=fe,ar|=fe;ke=ae.action,ho&&i(s,ke),s=ae.hasEagerState?ae.eagerState:i(s,ke)}else fe={lane:ke,revertLane:ae.revertLane,gesture:ae.gesture,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},E===null?(S=E=fe,h=s):E=E.next=fe,Tt.lanes|=ke,ar|=ke;ae=ae.next}while(ae!==null&&ae!==t);if(E===null?h=s:E.next=S,!ln(s,e.memoizedState)&&(Yn=!0,we&&(i=xl,i!==null)))throw i;e.memoizedState=s,e.baseState=h,e.baseQueue=E,l.lastRenderedState=s}return a===null&&(l.lanes=0),[e.memoizedState,l.dispatch]}function Wr(e){var t=Hn(),i=t.queue;if(i===null)throw Error(d(311));i.lastRenderedReducer=e;var l=i.dispatch,a=i.pending,s=t.memoizedState;if(a!==null){i.pending=null;var h=a=a.next;do s=e(s,h.action),h=h.next;while(h!==a);ln(s,t.memoizedState)||(Yn=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),i.lastRenderedState=s}return[s,l]}function yc(e,t,i){var l=Tt,a=Hn(),s=wt;if(s){if(i===void 0)throw Error(d(407));i=i()}else i=t();var h=!ln((an||a).memoizedState,i);if(h&&(a.memoizedState=i,Yn=!0),a=a.queue,hd(Yl.bind(null,l,a,e),[e]),a.getSnapshot!==t||h||Cn!==null&&Cn.memoizedState.tag&1){if(l.flags|=2048,Da(9,{destroy:void 0},od.bind(null,l,a,i,t),null),Sn===null)throw Error(d(349));s||(Vo&127)!==0||eu(l,t,i)}return i}function eu(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},t=Tt.updateQueue,t===null?(t=xc(),Tt.updateQueue=t,t.stores=[e]):(i=t.stores,i===null?t.stores=[e]:i.push(e))}function od(e,t,i,l){t.value=i,t.getSnapshot=l,ad(t)&&ss(e)}function Yl(e,t,i){return i(function(){ad(t)&&ss(e)})}function ad(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!ln(e,i)}catch{return!0}}function ss(e){var t=pl(e,2);t!==null&&Cl(t,e,2)}function bc(e){var t=ci();if(typeof e=="function"){var i=e;if(e=i(),ho){Gn(!0);try{i()}finally{Gn(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vl,lastRenderedState:e},t}function $o(e,t,i,l){return e.baseState=i,Vr(e,an,typeof l=="function"?l:vl)}function sd(e,t,i,l,a){if(di(e))throw Error(d(485));if(e=t.action,e!==null){var s={payload:a,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(h){s.listeners.push(h)}};H.T!==null?i(!0):s.isTransition=!1,l(s),i=t.pending,i===null?(s.next=t.pending=s,rd(t,s)):(s.next=i.next,t.pending=i.next=s)}}function rd(e,t){var i=t.action,l=t.payload,a=e.state;if(t.isTransition){var s=H.T,h={};H.T=h;try{var S=i(a,l),E=H.S;E!==null&&E(h,S),cd(e,t,S)}catch(ae){dd(e,t,ae)}finally{s!==null&&h.types!==null&&(s.types=h.types),H.T=s}}else try{s=i(a,l),cd(e,t,s)}catch(ae){dd(e,t,ae)}}function cd(e,t,i){i!==null&&typeof i=="object"&&typeof i.then=="function"?i.then(function(l){tu(e,t,l)},function(l){return dd(e,t,l)}):tu(e,t,i)}function tu(e,t,i){t.status="fulfilled",t.value=i,nu(t),e.state=i,t=e.pending,t!==null&&(i=t.next,i===t?e.pending=null:(i=i.next,t.next=i,rd(e,i)))}function dd(e,t,i){var l=e.pending;if(e.pending=null,l!==null){l=l.next;do t.status="rejected",t.reason=i,nu(t),t=t.next;while(t!==l)}e.action=null}function nu(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Fr(e,t){return t}function ud(e,t){if(wt){var i=Sn.formState;if(i!==null){e:{var l=Tt;if(wt){if(Ut){t:{for(var a=Ut,s=Kn;a.nodeType!==8;){if(!s){a=null;break t}if(a=mo(a.nextSibling),a===null){a=null;break t}}s=a.data,a=s==="F!"||s==="F"?a:null}if(a){Ut=mo(a.nextSibling),l=a.data==="F!";break e}}st(l)}l=!1}l&&(t=i[0])}}return i=ci(),i.memoizedState=i.baseState=t,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fr,lastRenderedState:t},i.queue=l,i=Xl.bind(null,Tt,l),l.dispatch=i,l=bc(!1),s=Tc.bind(null,Tt,!1,l.queue),l=ci(),a={state:t,dispatch:null,action:e,pending:null},l.queue=a,i=sd.bind(null,Tt,a,s,i),a.dispatch=i,l.memoizedState=e,[t,i,!1]}function iu(e){var t=Hn();return fd(t,an,e)}function fd(e,t,i){if(t=Vr(e,t,Fr)[0],e=as(vl)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var l=Gs(t)}catch(h){throw h===Ta?is:h}else l=t;t=Hn();var a=t.queue,s=a.dispatch;return i!==t.memoizedState&&(Tt.flags|=2048,Da(9,{destroy:void 0},$r.bind(null,a,i),null)),[l,s,e]}function $r(e,t){e.action=t}function lu(e){var t=Hn(),i=an;if(i!==null)return fd(t,i,e);Hn(),t=t.memoizedState,i=Hn();var l=i.queue.dispatch;return i.memoizedState=e,[t,l,!1]}function Da(e,t,i,l){return e={tag:e,create:i,deps:l,inst:t,next:null},t=Tt.updateQueue,t===null&&(t=xc(),Tt.updateQueue=t),i=t.lastEffect,i===null?t.lastEffect=e.next=e:(l=i.next,i.next=e,e.next=l,t.lastEffect=e),e}function pd(){return Hn().memoizedState}function Zs(e,t,i,l){var a=ci();Tt.flags|=e,a.memoizedState=Da(1|t,{destroy:void 0},i,l===void 0?null:l)}function Ks(e,t,i,l){var a=Hn();l=l===void 0?null:l;var s=a.memoizedState.inst;an!==null&&l!==null&&Ls(l,an.memoizedState.deps)?a.memoizedState=Da(t,s,i,l):(Tt.flags|=e,a.memoizedState=Da(1|t,s,i,l))}function ou(e,t){Zs(8390656,8,e,t)}function hd(e,t){Ks(2048,8,e,t)}function au(e){Tt.flags|=4;var t=Tt.updateQueue;if(t===null)t=xc(),Tt.updateQueue=t,t.events=[e];else{var i=t.events;i===null?t.events=[e]:i.push(e)}}function Qs(e){var t=Hn().memoizedState;return au({ref:t,nextImpl:e}),function(){if((en&2)!==0)throw Error(d(440));return t.impl.apply(void 0,arguments)}}function mc(e,t){return Ks(4,2,e,t)}function Aa(e,t){return Ks(4,4,e,t)}function Lr(e,t){if(typeof t=="function"){e=e();var i=t(e);return function(){typeof i=="function"?i():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function yo(e,t,i){i=i!=null?i.concat([e]):null,Ks(4,4,Lr.bind(null,t,e),i)}function Na(){}function vc(e,t){var i=Hn();t=t===void 0?null:t;var l=i.memoizedState;return t!==null&&Ls(t,l[1])?l[0]:(i.memoizedState=[e,t],e)}function Sc(e,t){var i=Hn();t=t===void 0?null:t;var l=i.memoizedState;if(t!==null&&Ls(t,l[1]))return l[0];if(l=e(),ho){Gn(!0);try{e()}finally{Gn(!1)}}return i.memoizedState=[l,t],l}function Yr(e,t,i){return i===void 0||(Vo&1073741824)!==0&&(Vt&261930)===0?e.memoizedState=t:(e.memoizedState=i,e=cp(),Tt.lanes|=e,ar|=e,i)}function Si(e,t,i,l){return ln(i,t)?i:$s.current!==null?(e=Yr(e,i,l),ln(e,t)||(Yn=!0),e):(Vo&42)===0||(Vo&1073741824)!==0&&(Vt&261930)===0?(Yn=!0,e.memoizedState=i):(e=cp(),Tt.lanes|=e,ar|=e,t)}function gd(e,t,i,l,a){var s=I.p;I.p=s!==0&&8>s?s:8;var h=H.T,S={};H.T=S,Tc(e,!1,t,i);try{var E=a(),ae=H.S;if(ae!==null&&ae(S,E),E!==null&&typeof E=="object"&&typeof E.then=="function"){var we=ja(E,l);Js(e,t,we,Zl(e))}else Js(e,t,l,Zl(e))}catch(ke){Js(e,t,{then:function(){},status:"rejected",reason:ke},Zl())}finally{I.p=s,h!==null&&S.types!==null&&(h.types=S.types),H.T=h}}function Gu(){}function wc(e,t,i,l){if(e.tag!==5)throw Error(d(476));var a=su(e).queue;gd(e,a,t,pe,i===null?Gu:function(){return xd(e),i(l)})}function su(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:pe,baseState:pe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vl,lastRenderedState:pe},next:null};var i={};return t.next={memoizedState:i,baseState:i,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vl,lastRenderedState:i},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function xd(e){var t=su(e);t.next===null&&(t=e.alternate.memoizedState),Js(e,t.next.queue,{},Zl())}function jc(){return ri(Bd)}function Xr(){return Hn().memoizedState}function bo(){return Hn().memoizedState}function ru(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var i=Zl();e=uo(i);var l=za(t,e,i);l!==null&&(Cl(l,t,i),ls(l,t,i)),t={cache:ns()},e.payload=t;return}t=t.return}}function Ma(e,t,i){var l=Zl();i={lane:l,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},di(e)?rs(t,i):(i=Bs(e,t,i,l),i!==null&&(Cl(i,e,l),Ba(i,t,l)))}function Xl(e,t,i){var l=Zl();Js(e,t,i,l)}function Js(e,t,i,l){var a={lane:l,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null};if(di(e))rs(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var h=t.lastRenderedState,S=s(h,i);if(a.hasEagerState=!0,a.eagerState=S,ln(S,h))return ao(e,t,a,0),Sn===null&&ba(),!1}catch{}finally{}if(i=Bs(e,t,a,l),i!==null)return Cl(i,e,l),Ba(i,t,l),!0}return!1}function Tc(e,t,i,l){if(l={lane:2,revertLane:df(),gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},di(e)){if(t)throw Error(d(479))}else t=Bs(e,i,l,2),t!==null&&Cl(t,e,2)}function di(e){var t=e.alternate;return e===Tt||t!==null&&t===Tt}function rs(e,t){$l=po=!0;var i=e.pending;i===null?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function Ba(e,t,i){if((i&4194048)!==0){var l=t.lanes;l&=e.pendingLanes,i|=l,t.lanes=i,Ci(e,i)}}var Ua={readContext:ri,use:xo,useCallback:hn,useContext:hn,useEffect:hn,useImperativeHandle:hn,useLayoutEffect:hn,useInsertionEffect:hn,useMemo:hn,useReducer:hn,useRef:hn,useState:hn,useDebugValue:hn,useDeferredValue:hn,useTransition:hn,useSyncExternalStore:hn,useId:hn,useHostTransitionStatus:hn,useFormState:hn,useActionState:hn,useOptimistic:hn,useMemoCache:hn,useCacheRefresh:hn};Ua.useEffectEvent=hn;var Cc={readContext:ri,use:xo,useCallback:function(e,t){return ci().memoizedState=[e,t===void 0?null:t],e},useContext:ri,useEffect:ou,useImperativeHandle:function(e,t,i){i=i!=null?i.concat([e]):null,Zs(4194308,4,Lr.bind(null,t,e),i)},useLayoutEffect:function(e,t){return Zs(4194308,4,e,t)},useInsertionEffect:function(e,t){Zs(4,2,e,t)},useMemo:function(e,t){var i=ci();t=t===void 0?null:t;var l=e();if(ho){Gn(!0);try{e()}finally{Gn(!1)}}return i.memoizedState=[l,t],l},useReducer:function(e,t,i){var l=ci();if(i!==void 0){var a=i(t);if(ho){Gn(!0);try{i(t)}finally{Gn(!1)}}}else a=t;return l.memoizedState=l.baseState=a,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:a},l.queue=e,e=e.dispatch=Ma.bind(null,Tt,e),[l.memoizedState,e]},useRef:function(e){var t=ci();return e={current:e},t.memoizedState=e},useState:function(e){e=bc(e);var t=e.queue,i=Xl.bind(null,Tt,t);return t.dispatch=i,[e.memoizedState,i]},useDebugValue:Na,useDeferredValue:function(e,t){var i=ci();return Yr(i,e,t)},useTransition:function(){var e=bc(!1);return e=gd.bind(null,Tt,e.queue,!0,!1),ci().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,i){var l=Tt,a=ci();if(wt){if(i===void 0)throw Error(d(407));i=i()}else{if(i=t(),Sn===null)throw Error(d(349));(Vt&127)!==0||eu(l,t,i)}a.memoizedState=i;var s={value:i,getSnapshot:t};return a.queue=s,ou(Yl.bind(null,l,s,e),[e]),l.flags|=2048,Da(9,{destroy:void 0},od.bind(null,l,s,i,t),null),i},useId:function(){var e=ci(),t=Sn.identifierPrefix;if(wt){var i=ai,l=Nn;i=(l&~(1<<32-tt(l)-1)).toString(32)+i,t="_"+t+"R_"+i,i=Wo++,0<i&&(t+="H"+i.toString(32)),t+="_"}else i=Hr++,t="_"+t+"r_"+i.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:jc,useFormState:ud,useActionState:ud,useOptimistic:function(e){var t=ci();t.memoizedState=t.baseState=e;var i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=i,t=Tc.bind(null,Tt,!0,i),i.dispatch=t,[e,t]},useMemoCache:qs,useCacheRefresh:function(){return ci().memoizedState=ru.bind(null,Tt)},useEffectEvent:function(e){var t=ci(),i={impl:e};return t.memoizedState=i,function(){if((en&2)!==0)throw Error(d(440));return i.impl.apply(void 0,arguments)}}},cs={readContext:ri,use:xo,useCallback:vc,useContext:ri,useEffect:hd,useImperativeHandle:yo,useInsertionEffect:mc,useLayoutEffect:Aa,useMemo:Sc,useReducer:as,useRef:pd,useState:function(){return as(vl)},useDebugValue:Na,useDeferredValue:function(e,t){var i=Hn();return Si(i,an.memoizedState,e,t)},useTransition:function(){var e=as(vl)[0],t=Hn().memoizedState;return[typeof e=="boolean"?e:Gs(e),t]},useSyncExternalStore:yc,useId:Xr,useHostTransitionStatus:jc,useFormState:iu,useActionState:iu,useOptimistic:function(e,t){var i=Hn();return $o(i,an,e,t)},useMemoCache:qs,useCacheRefresh:bo};cs.useEffectEvent=Qs;var er={readContext:ri,use:xo,useCallback:vc,useContext:ri,useEffect:hd,useImperativeHandle:yo,useInsertionEffect:mc,useLayoutEffect:Aa,useMemo:Sc,useReducer:Wr,useRef:pd,useState:function(){return Wr(vl)},useDebugValue:Na,useDeferredValue:function(e,t){var i=Hn();return an===null?Yr(i,e,t):Si(i,an.memoizedState,e,t)},useTransition:function(){var e=Wr(vl)[0],t=Hn().memoizedState;return[typeof e=="boolean"?e:Gs(e),t]},useSyncExternalStore:yc,useId:Xr,useHostTransitionStatus:jc,useFormState:lu,useActionState:lu,useOptimistic:function(e,t){var i=Hn();return an!==null?$o(i,an,e,t):(i.baseState=e,[e,i.queue.dispatch])},useMemoCache:qs,useCacheRefresh:bo};er.useEffectEvent=Qs;function Gr(e,t,i,l){t=e.memoizedState,i=i(l,t),i=i==null?t:ge({},t,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var ds={enqueueSetState:function(e,t,i){e=e._reactInternals;var l=Zl(),a=uo(l);a.payload=t,i!=null&&(a.callback=i),t=za(e,a,l),t!==null&&(Cl(t,e,l),ls(t,e,l))},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var l=Zl(),a=uo(l);a.tag=1,a.payload=t,i!=null&&(a.callback=i),t=za(e,a,l),t!==null&&(Cl(t,e,l),ls(t,e,l))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=Zl(),l=uo(i);l.tag=2,t!=null&&(l.callback=t),t=za(e,l,i),t!==null&&(Cl(t,e,i),ls(t,e,i))}};function cu(e,t,i,l,a,s,h){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,s,h):t.prototype&&t.prototype.isPureReactComponent?!on(i,l)||!on(a,s):!0}function yd(e,t,i,l){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(i,l),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(i,l),t.state!==e&&ds.enqueueReplaceState(t,t.state,null)}function Lo(e,t){var i=t;if("ref"in t){i={};for(var l in t)l!=="ref"&&(i[l]=t[l])}if(e=e.defaultProps){i===t&&(i=ge({},i));for(var a in e)i[a]===void 0&&(i[a]=e[a])}return i}function du(e){Ki(e)}function uu(e){console.error(e)}function bd(e){Ki(e)}function tr(e,t){try{var i=e.onUncaughtError;i(t.value,{componentStack:t.stack})}catch(l){setTimeout(function(){throw l})}}function zc(e,t,i){try{var l=e.onCaughtError;l(i.value,{componentStack:i.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(a){setTimeout(function(){throw a})}}function md(e,t,i){return i=uo(i),i.tag=3,i.payload={element:null},i.callback=function(){tr(e,t)},i}function fu(e){return e=uo(e),e.tag=3,e}function Pa(e,t,i,l){var a=i.type.getDerivedStateFromError;if(typeof a=="function"){var s=l.value;e.payload=function(){return a(s)},e.callback=function(){zc(t,i,l)}}var h=i.stateNode;h!==null&&typeof h.componentDidCatch=="function"&&(e.callback=function(){zc(t,i,l),typeof a!="function"&&(sr===null?sr=new Set([this]):sr.add(this));var S=l.stack;this.componentDidCatch(l.value,{componentStack:S!==null?S:""})})}function nr(e,t,i,l,a){if(i.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){if(t=i.alternate,t!==null&&gl(t,i,a,!0),i=Ln.current,i!==null){switch(i.tag){case 31:case 13:return ml===null?vu():i.alternate===null&&Xn===0&&(Xn=3),i.flags&=-257,i.flags|=65536,i.lanes=a,l===Pr?i.flags|=16384:(t=i.updateQueue,t===null?i.updateQueue=new Set([l]):t.add(l),sf(e,l,a)),!1;case 22:return i.flags|=65536,l===Pr?i.flags|=16384:(t=i.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([l])},i.updateQueue=t):(i=t.retryQueue,i===null?t.retryQueue=new Set([l]):i.add(l)),sf(e,l,a)),!1}throw Error(d(435,i.tag))}return sf(e,l,a),vu(),!1}if(wt)return t=Ln.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=a,l!==yt&&(e=Error(d(422),{cause:l}),_s(dn(e,i)))):(l!==yt&&(t=Error(d(423),{cause:l}),_s(dn(t,i))),e=e.current.alternate,e.flags|=65536,a&=-a,e.lanes|=a,l=dn(l,i),a=md(e.stateNode,l,a),td(e,a),Xn!==4&&(Xn=2)),!1;var s=Error(d(520),{cause:l});if(s=dn(s,i),Cd===null?Cd=[s]:Cd.push(s),Xn!==4&&(Xn=2),t===null)return!0;l=dn(l,i),i=t;do{switch(i.tag){case 3:return i.flags|=65536,e=a&-a,i.lanes|=e,e=md(i.stateNode,l,e),td(i,e),!1;case 1:if(t=i.type,s=i.stateNode,(i.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||s!==null&&typeof s.componentDidCatch=="function"&&(sr===null||!sr.has(s))))return i.flags|=65536,a&=-a,i.lanes|=a,a=fu(a),Pa(a,e,i,l),td(i,a),!1}i=i.return}while(i!==null);return!1}var ir=Error(d(461)),Yn=!1;function ui(e,t,i,l){t.child=e===null?Vs(t,null,i,l):bl(t,e.child,i,l)}function kc(e,t,i,l,a){i=i.render;var s=t.ref;if("ref"in l){var h={};for(var S in l)S!=="ref"&&(h[S]=l[S])}else h=l;return Vl(t),l=Ys(e,t,i,h,s,a),S=Fo(),e!==null&&!Yn?(Wi(e,t,a),q(e,t,a)):(wt&&S&&hl(t),t.flags|=1,ui(e,t,l,a),t.child)}function Rc(e,t,i,l,a){if(e===null){var s=i.type;return typeof s=="function"&&!Us(s)&&s.defaultProps===void 0&&i.compare===null?(t.tag=15,t.type=s,vd(e,t,s,l,a)):(e=Mr(i.type,null,l,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!J(e,a)){var h=s.memoizedProps;if(i=i.compare,i=i!==null?i:on,i(h,l)&&e.ref===t.ref)return q(e,t,a)}return t.flags|=1,e=Ol(s,l),e.ref=t.ref,e.return=t,t.child=e}function vd(e,t,i,l,a){if(e!==null){var s=e.memoizedProps;if(on(s,l)&&e.ref===t.ref)if(Yn=!1,t.pendingProps=l=s,J(e,a))(e.flags&131072)!==0&&(Yn=!0);else return t.lanes=e.lanes,q(e,t,a)}return o(e,t,i,l,a)}function Sd(e,t,i,l){var a=l.children,s=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.mode==="hidden"){if((t.flags&128)!==0){if(s=s!==null?s.baseLanes|i:i,e!==null){for(l=t.child=e.child,a=0;l!==null;)a=a|l.lanes|l.childLanes,l=l.sibling;l=a&~s}else l=0,t.child=null;return us(e,t,s,i,l)}if((i&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Mi(t,s!==null?s.cachePool:null),s!==null?Qd(t,s):nd(),Jd(t);else return l=t.lanes=536870912,us(e,t,s!==null?s.baseLanes|i:i,i,l)}else s!==null?(Mi(t,s.cachePool),Qd(t,s),Ra(),t.memoizedState=null):(e!==null&&Mi(t,null),nd(),Ra());return ui(e,t,a,i),t.child}function Ke(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function us(e,t,i,l,a){var s=Ur();return s=s===null?null:{parent:Tn._currentValue,pool:s},t.memoizedState={baseLanes:i,cachePool:s},e!==null&&Mi(t,null),nd(),Jd(t),e!==null&&gl(e,t,l,!0),t.childLanes=a,null}function lr(e,t){return t=k({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function pu(e,t,i){return bl(t,e.child,null,i),e=lr(t,t.pendingProps),e.flags|=2,il(t),t.memoizedState=null,e}function qu(e,t,i){var l=t.pendingProps,a=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(wt){if(l.mode==="hidden")return e=lr(t,l),t.lanes=536870912,Ke(null,e);if(ld(t),(e=Ut)?(e=Lp(e,Kn),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Ni!==null?{id:Nn,overflow:ai}:null,retryLane:536870912,hydrationErrors:null},i=_l(e),i.return=t,t.child=i,vn=t,Ut=null)):e=null,e===null)throw st(t);return t.lanes=536870912,null}return lr(t,l)}var s=e.memoizedState;if(s!==null){var h=s.dehydrated;if(ld(t),a)if(t.flags&256)t.flags&=-257,t=pu(e,t,i);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(d(558));else if(Yn||gl(e,t,i,!1),a=(i&e.childLanes)!==0,Yn||a){if(l=Sn,l!==null&&(h=zt(l,i),h!==0&&h!==s.retryLane))throw s.retryLane=h,pl(e,h),Cl(l,e,h),ir;vu(),t=pu(e,t,i)}else e=s.treeContext,Ut=mo(h.nextSibling),vn=t,wt=!0,si=null,Kn=!1,e!==null&&el(t,e),t=lr(t,l),t.flags|=4096;return t}return e=Ol(e.child,{mode:l.mode,children:l.children}),e.ref=t.ref,t.child=e,e.return=t,e}function Dc(e,t){var i=t.ref;if(i===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof i!="function"&&typeof i!="object")throw Error(d(284));(e===null||e.ref!==i)&&(t.flags|=4194816)}}function o(e,t,i,l,a){return Vl(t),i=Ys(e,t,i,l,void 0,a),l=Fo(),e!==null&&!Yn?(Wi(e,t,a),q(e,t,a)):(wt&&l&&hl(t),t.flags|=1,ui(e,t,i,a),t.child)}function r(e,t,i,l,a,s){return Vl(t),t.updateQueue=null,i=go(t,l,i,a),Er(e),l=Fo(),e!==null&&!Yn?(Wi(e,t,s),q(e,t,s)):(wt&&l&&hl(t),t.flags|=1,ui(e,t,i,s),t.child)}function f(e,t,i,l,a){if(Vl(t),t.stateNode===null){var s=Qa,h=i.contextType;typeof h=="object"&&h!==null&&(s=ri(h)),s=new i(l,s),t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=ds,t.stateNode=s,s._reactInternals=t,s=t.stateNode,s.props=l,s.state=t.memoizedState,s.refs={},_r(t),h=i.contextType,s.context=typeof h=="object"&&h!==null?ri(h):Qa,s.state=t.memoizedState,h=i.getDerivedStateFromProps,typeof h=="function"&&(Gr(t,i,h,l),s.state=t.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(h=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),h!==s.state&&ds.enqueueReplaceState(s,s.state,null),Vi(t,l,s,a),Ii(),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308),l=!0}else if(e===null){s=t.stateNode;var S=t.memoizedProps,E=Lo(i,S);s.props=E;var ae=s.context,we=i.contextType;h=Qa,typeof we=="object"&&we!==null&&(h=ri(we));var ke=i.getDerivedStateFromProps;we=typeof ke=="function"||typeof s.getSnapshotBeforeUpdate=="function",S=t.pendingProps!==S,we||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(S||ae!==h)&&yd(t,s,l,h),co=!1;var fe=t.memoizedState;s.state=fe,Vi(t,l,s,a),Ii(),ae=t.memoizedState,S||fe!==ae||co?(typeof ke=="function"&&(Gr(t,i,ke,l),ae=t.memoizedState),(E=co||cu(t,i,E,l,fe,ae,h))?(we||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=l,t.memoizedState=ae),s.props=l,s.state=ae,s.context=h,l=E):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),l=!1)}else{s=t.stateNode,Ws(e,t),h=t.memoizedProps,we=Lo(i,h),s.props=we,ke=t.pendingProps,fe=s.context,ae=i.contextType,E=Qa,typeof ae=="object"&&ae!==null&&(E=ri(ae)),S=i.getDerivedStateFromProps,(ae=typeof S=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(h!==ke||fe!==E)&&yd(t,s,l,E),co=!1,fe=t.memoizedState,s.state=fe,Vi(t,l,s,a),Ii();var ye=t.memoizedState;h!==ke||fe!==ye||co||e!==null&&e.dependencies!==null&&rc(e.dependencies)?(typeof S=="function"&&(Gr(t,i,S,l),ye=t.memoizedState),(we=co||cu(t,i,we,l,fe,ye,E)||e!==null&&e.dependencies!==null&&rc(e.dependencies))?(ae||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(l,ye,E),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(l,ye,E)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||h===e.memoizedProps&&fe===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||h===e.memoizedProps&&fe===e.memoizedState||(t.flags|=1024),t.memoizedProps=l,t.memoizedState=ye),s.props=l,s.state=ye,s.context=E,l=we):(typeof s.componentDidUpdate!="function"||h===e.memoizedProps&&fe===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||h===e.memoizedProps&&fe===e.memoizedState||(t.flags|=1024),l=!1)}return s=l,Dc(e,t),l=(t.flags&128)!==0,s||l?(s=t.stateNode,i=l&&typeof i.getDerivedStateFromError!="function"?null:s.render(),t.flags|=1,e!==null&&l?(t.child=bl(t,e.child,null,a),t.child=bl(t,null,i,a)):ui(e,t,i,a),t.memoizedState=s.state,e=t.child):e=q(e,t,a),e}function b(e,t,i,l){return es(),t.flags|=256,ui(e,t,i,l),t.child}var y={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function v(e){return{baseLanes:e,cachePool:Hs()}}function x(e,t,i){return e=e!==null?e.childLanes&~i:0,t&&(e|=ql),e}function T(e,t,i){var l=t.pendingProps,a=!1,s=(t.flags&128)!==0,h;if((h=s)||(h=e!==null&&e.memoizedState===null?!1:(_n.current&2)!==0),h&&(a=!0,t.flags&=-129),h=(t.flags&32)!==0,t.flags&=-33,e===null){if(wt){if(a?ka(t):Ra(),(e=Ut)?(e=Lp(e,Kn),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Ni!==null?{id:Nn,overflow:ai}:null,retryLane:536870912,hydrationErrors:null},i=_l(e),i.return=t,t.child=i,vn=t,Ut=null)):e=null,e===null)throw st(t);return jf(e)?t.lanes=32:t.lanes=536870912,null}var S=l.children;return l=l.fallback,a?(Ra(),a=t.mode,S=k({mode:"hidden",children:S},a),l=ma(l,a,i,null),S.return=t,l.return=t,S.sibling=l,t.child=S,l=t.child,l.memoizedState=v(i),l.childLanes=x(e,h,i),t.memoizedState=y,Ke(null,l)):(ka(t),C(t,S))}var E=e.memoizedState;if(E!==null&&(S=E.dehydrated,S!==null)){if(s)t.flags&256?(ka(t),t.flags&=-257,t=A(e,t,i)):t.memoizedState!==null?(Ra(),t.child=e.child,t.flags|=128,t=null):(Ra(),S=l.fallback,a=t.mode,l=k({mode:"visible",children:l.children},a),S=ma(S,a,i,null),S.flags|=2,l.return=t,S.return=t,l.sibling=S,t.child=l,bl(t,e.child,null,i),l=t.child,l.memoizedState=v(i),l.childLanes=x(e,h,i),t.memoizedState=y,t=Ke(null,l));else if(ka(t),jf(S)){if(h=S.nextSibling&&S.nextSibling.dataset,h)var ae=h.dgst;h=ae,l=Error(d(419)),l.stack="",l.digest=h,_s({value:l,source:null,stack:null}),t=A(e,t,i)}else if(Yn||gl(e,t,i,!1),h=(i&e.childLanes)!==0,Yn||h){if(h=Sn,h!==null&&(l=zt(h,i),l!==0&&l!==E.retryLane))throw E.retryLane=l,pl(e,l),Cl(h,e,l),ir;wf(S)||vu(),t=A(e,t,i)}else wf(S)?(t.flags|=192,t.child=e.child,t=null):(e=E.treeContext,Ut=mo(S.nextSibling),vn=t,wt=!0,si=null,Kn=!1,e!==null&&el(t,e),t=C(t,l.children),t.flags|=4096);return t}return a?(Ra(),S=l.fallback,a=t.mode,E=e.child,ae=E.sibling,l=Ol(E,{mode:"hidden",children:l.children}),l.subtreeFlags=E.subtreeFlags&65011712,ae!==null?S=Ol(ae,S):(S=ma(S,a,i,null),S.flags|=2),S.return=t,l.return=t,l.sibling=S,t.child=l,Ke(null,l),l=t.child,S=e.child.memoizedState,S===null?S=v(i):(a=S.cachePool,a!==null?(E=Tn._currentValue,a=a.parent!==E?{parent:E,pool:E}:a):a=Hs(),S={baseLanes:S.baseLanes|i,cachePool:a}),l.memoizedState=S,l.childLanes=x(e,h,i),t.memoizedState=y,Ke(e.child,l)):(ka(t),i=e.child,e=i.sibling,i=Ol(i,{mode:"visible",children:l.children}),i.return=t,i.sibling=null,e!==null&&(h=t.deletions,h===null?(t.deletions=[e],t.flags|=16):h.push(e)),t.child=i,t.memoizedState=null,i)}function C(e,t){return t=k({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function k(e,t){return e=Qi(22,e,null,t),e.lanes=0,e}function A(e,t,i){return bl(t,e.child,null,i),e=C(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function M(e,t,i){e.lanes|=t;var l=e.alternate;l!==null&&(l.lanes|=t),$n(e.return,t,i)}function ie(e,t,i,l,a,s){var h=e.memoizedState;h===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:l,tail:i,tailMode:a,treeForkCount:s}:(h.isBackwards=t,h.rendering=null,h.renderingStartTime=0,h.last=l,h.tail=i,h.tailMode=a,h.treeForkCount=s)}function Q(e,t,i){var l=t.pendingProps,a=l.revealOrder,s=l.tail;l=l.children;var h=_n.current,S=(h&2)!==0;if(S?(h=h&1|2,t.flags|=128):h&=1,$(_n,h),ui(e,t,l,i),l=wt?Jn:0,!S&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&M(e,i,t);else if(e.tag===19)M(e,i,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(a){case"forwards":for(i=t.child,a=null;i!==null;)e=i.alternate,e!==null&&gc(e)===null&&(a=i),i=i.sibling;i=a,i===null?(a=t.child,t.child=null):(a=i.sibling,i.sibling=null),ie(t,!1,a,i,s,l);break;case"backwards":case"unstable_legacy-backwards":for(i=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&gc(e)===null){t.child=a;break}e=a.sibling,a.sibling=i,i=a,a=e}ie(t,!0,i,null,s,l);break;case"together":ie(t,!1,null,null,void 0,l);break;default:t.memoizedState=null}return t.child}function q(e,t,i){if(e!==null&&(t.dependencies=e.dependencies),ar|=t.lanes,(i&t.childLanes)===0)if(e!==null){if(gl(e,t,i,!1),(i&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(d(153));if(t.child!==null){for(e=t.child,i=Ol(e,e.pendingProps),t.child=i,i.return=t;e.sibling!==null;)e=e.sibling,i=i.sibling=Ol(e,e.pendingProps),i.return=t;i.sibling=null}return t.child}function J(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&rc(e)))}function le(e,t,i){switch(t.tag){case 3:Gt(t,t.stateNode.containerInfo),Bo(t,Tn,e.memoizedState.cache),es();break;case 27:case 5:In(t);break;case 4:Gt(t,t.stateNode.containerInfo);break;case 10:Bo(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,ld(t),null;break;case 13:var l=t.memoizedState;if(l!==null)return l.dehydrated!==null?(ka(t),t.flags|=128,null):(i&t.child.childLanes)!==0?T(e,t,i):(ka(t),e=q(e,t,i),e!==null?e.sibling:null);ka(t);break;case 19:var a=(e.flags&128)!==0;if(l=(i&t.childLanes)!==0,l||(gl(e,t,i,!1),l=(i&t.childLanes)!==0),a){if(l)return Q(e,t,i);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),$(_n,_n.current),l)break;return null;case 22:return t.lanes=0,Sd(e,t,i,t.pendingProps);case 24:Bo(t,Tn,e.memoizedState.cache)}return q(e,t,i)}function ne(e,t,i){if(e!==null)if(e.memoizedProps!==t.pendingProps)Yn=!0;else{if(!J(e,i)&&(t.flags&128)===0)return Yn=!1,le(e,t,i);Yn=(e.flags&131072)!==0}else Yn=!1,wt&&(t.flags&1048576)!==0&&Ja(t,Jn,t.index);switch(t.lanes=0,t.tag){case 16:e:{var l=t.pendingProps;if(e=yl(t.elementType),t.type=e,typeof e=="function")Us(e)?(l=Lo(e,l),t.tag=1,t=f(null,t,e,l,i)):(t.tag=0,t=o(null,t,e,l,i));else{if(e!=null){var a=e.$$typeof;if(a===re){t.tag=11,t=kc(null,t,e,l,i);break e}else if(a===D){t.tag=14,t=Rc(null,t,e,l,i);break e}}throw t=me(e)||e,Error(d(306,t,""))}}return t;case 0:return o(e,t,t.type,t.pendingProps,i);case 1:return l=t.type,a=Lo(l,t.pendingProps),f(e,t,l,a,i);case 3:e:{if(Gt(t,t.stateNode.containerInfo),e===null)throw Error(d(387));l=t.pendingProps;var s=t.memoizedState;a=s.element,Ws(e,t),Vi(t,l,null,i);var h=t.memoizedState;if(l=h.cache,Bo(t,Tn,l),l!==s.cache&&tl(t,[Tn],i,!0),Ii(),l=h.element,s.isDehydrated)if(s={element:l,isDehydrated:!1,cache:h.cache},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){t=b(e,t,l,i);break e}else if(l!==a){a=dn(Error(d(424)),t),_s(a),t=b(e,t,l,i);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Ut=mo(e.firstChild),vn=t,wt=!0,si=null,Kn=!0,i=Vs(t,null,l,i),t.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling}else{if(es(),l===a){t=q(e,t,i);break e}ui(e,t,l,i)}t=t.child}return t;case 26:return Dc(e,t),e===null?(i=Kp(t.type,null,t.pendingProps,null))?t.memoizedState=i:wt||(i=t.type,e=t.pendingProps,l=ku(ot.current).createElement(i),l[pt]=t,l[Pn]=e,Bi(l,i,e),Bt(l),t.stateNode=l):t.memoizedState=Kp(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return In(t),e===null&&wt&&(l=t.stateNode=Gp(t.type,t.pendingProps,ot.current),vn=t,Kn=!0,a=Ut,ur(t.type)?(Tf=a,Ut=mo(l.firstChild)):Ut=a),ui(e,t,t.pendingProps.children,i),Dc(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&wt&&((a=l=Ut)&&(l=cg(l,t.type,t.pendingProps,Kn),l!==null?(t.stateNode=l,vn=t,Ut=mo(l.firstChild),Kn=!1,a=!0):a=!1),a||st(t)),In(t),a=t.type,s=t.pendingProps,h=e!==null?e.memoizedProps:null,l=s.children,mf(a,s)?l=null:h!==null&&mf(a,h)&&(t.flags|=32),t.memoizedState!==null&&(a=Ys(e,t,Ir,null,null,i),Bd._currentValue=a),Dc(e,t),ui(e,t,l,i),t.child;case 6:return e===null&&wt&&((e=i=Ut)&&(i=dg(i,t.pendingProps,Kn),i!==null?(t.stateNode=i,vn=t,Ut=null,e=!0):e=!1),e||st(t)),null;case 13:return T(e,t,i);case 4:return Gt(t,t.stateNode.containerInfo),l=t.pendingProps,e===null?t.child=bl(t,null,l,i):ui(e,t,l,i),t.child;case 11:return kc(e,t,t.type,t.pendingProps,i);case 7:return ui(e,t,t.pendingProps,i),t.child;case 8:return ui(e,t,t.pendingProps.children,i),t.child;case 12:return ui(e,t,t.pendingProps.children,i),t.child;case 10:return l=t.pendingProps,Bo(t,t.type,l.value),ui(e,t,l.children,i),t.child;case 9:return a=t.type._context,l=t.pendingProps.children,Vl(t),a=ri(a),l=l(a),t.flags|=1,ui(e,t,l,i),t.child;case 14:return Rc(e,t,t.type,t.pendingProps,i);case 15:return vd(e,t,t.type,t.pendingProps,i);case 19:return Q(e,t,i);case 31:return qu(e,t,i);case 22:return Sd(e,t,i,t.pendingProps);case 24:return Vl(t),l=ri(Tn),e===null?(a=Ur(),a===null&&(a=Sn,s=ns(),a.pooledCache=s,s.refCount++,s!==null&&(a.pooledCacheLanes|=i),a=s),t.memoizedState={parent:l,cache:a},_r(t),Bo(t,Tn,a)):((e.lanes&i)!==0&&(Ws(e,t),Vi(t,null,null,i),Ii()),a=e.memoizedState,s=t.memoizedState,a.parent!==l?(a={parent:l,cache:l},t.memoizedState=a,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=a),Bo(t,Tn,l)):(l=s.cache,Bo(t,Tn,l),l!==a.cache&&tl(t,[Tn],i,!0))),ui(e,t,t.pendingProps.children,i),t.child;case 29:throw t.pendingProps}throw Error(d(156,t.tag))}function be(e){e.flags|=4}function Ae(e,t,i,l,a){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(a&335544128)===a)if(e.stateNode.complete)e.flags|=8192;else if(pp())e.flags|=8192;else throw ro=Pr,uc}else e.flags&=-16777217}function ze(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!nh(t))if(pp())e.flags|=8192;else throw ro=Pr,uc}function je(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?Oi():536870912,e.lanes|=t,Bc|=t)}function Ee(e,t){if(!wt)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function Me(e){var t=e.alternate!==null&&e.alternate.child===e.child,i=0,l=0;if(t)for(var a=e.child;a!==null;)i|=a.lanes|a.childLanes,l|=a.subtreeFlags&65011712,l|=a.flags&65011712,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)i|=a.lanes|a.childLanes,l|=a.subtreeFlags,l|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=l,e.childLanes=i,t}function G(e,t,i){var l=t.pendingProps;switch(wa(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Me(t),null;case 1:return Me(t),null;case 3:return i=t.stateNode,l=null,e!==null&&(l=e.memoizedState.cache),t.memoizedState.cache!==l&&(t.flags|=2048),Il(Tn),He(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(Os(t)?be(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Br())),Me(t),null;case 26:var a=t.type,s=t.memoizedState;return e===null?(be(t),s!==null?(Me(t),ze(t,s)):(Me(t),Ae(t,a,null,l,i))):s?s!==e.memoizedState?(be(t),Me(t),ze(t,s)):(Me(t),t.flags&=-16777217):(e=e.memoizedProps,e!==l&&be(t),Me(t),Ae(t,a,e,l,i)),null;case 27:if(Un(t),i=ot.current,a=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==l&&be(t);else{if(!l){if(t.stateNode===null)throw Error(d(166));return Me(t),null}e=Z.current,Os(t)?Zd(t):(e=Gp(a,l,i),t.stateNode=e,be(t))}return Me(t),null;case 5:if(Un(t),a=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==l&&be(t);else{if(!l){if(t.stateNode===null)throw Error(d(166));return Me(t),null}if(s=Z.current,Os(t))Zd(t);else{var h=ku(ot.current);switch(s){case 1:s=h.createElementNS("http://www.w3.org/2000/svg",a);break;case 2:s=h.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;default:switch(a){case"svg":s=h.createElementNS("http://www.w3.org/2000/svg",a);break;case"math":s=h.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;case"script":s=h.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof l.is=="string"?h.createElement("select",{is:l.is}):h.createElement("select"),l.multiple?s.multiple=!0:l.size&&(s.size=l.size);break;default:s=typeof l.is=="string"?h.createElement(a,{is:l.is}):h.createElement(a)}}s[pt]=t,s[Pn]=l;e:for(h=t.child;h!==null;){if(h.tag===5||h.tag===6)s.appendChild(h.stateNode);else if(h.tag!==4&&h.tag!==27&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}t.stateNode=s;e:switch(Bi(s,a,l),a){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}l&&be(t)}}return Me(t),Ae(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,i),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==l&&be(t);else{if(typeof l!="string"&&t.stateNode===null)throw Error(d(166));if(e=ot.current,Os(t)){if(e=t.stateNode,i=t.memoizedProps,l=null,a=vn,a!==null)switch(a.tag){case 27:case 5:l=a.memoizedProps}e[pt]=t,e=!!(e.nodeValue===i||l!==null&&l.suppressHydrationWarning===!0||_p(e.nodeValue,i)),e||st(t,!0)}else e=ku(e).createTextNode(l),e[pt]=t,t.stateNode=e}return Me(t),null;case 31:if(i=t.memoizedState,e===null||e.memoizedState!==null){if(l=Os(t),i!==null){if(e===null){if(!l)throw Error(d(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(d(557));e[pt]=t}else es(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Me(t),e=!1}else i=Br(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=i),e=!0;if(!e)return t.flags&256?(il(t),t):(il(t),null);if((t.flags&128)!==0)throw Error(d(558))}return Me(t),null;case 13:if(l=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(a=Os(t),l!==null&&l.dehydrated!==null){if(e===null){if(!a)throw Error(d(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(d(317));a[pt]=t}else es(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Me(t),a=!1}else a=Br(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=a),a=!0;if(!a)return t.flags&256?(il(t),t):(il(t),null)}return il(t),(t.flags&128)!==0?(t.lanes=i,t):(i=l!==null,e=e!==null&&e.memoizedState!==null,i&&(l=t.child,a=null,l.alternate!==null&&l.alternate.memoizedState!==null&&l.alternate.memoizedState.cachePool!==null&&(a=l.alternate.memoizedState.cachePool.pool),s=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(s=l.memoizedState.cachePool.pool),s!==a&&(l.flags|=2048)),i!==e&&i&&(t.child.flags|=8192),je(t,t.updateQueue),Me(t),null);case 4:return He(),e===null&&hf(t.stateNode.containerInfo),Me(t),null;case 10:return Il(t.type),Me(t),null;case 19:if(U(_n),l=t.memoizedState,l===null)return Me(t),null;if(a=(t.flags&128)!==0,s=l.rendering,s===null)if(a)Ee(l,!1);else{if(Xn!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(s=gc(e),s!==null){for(t.flags|=128,Ee(l,!1),e=s.updateQueue,t.updateQueue=e,je(t,e),t.subtreeFlags=0,e=i,i=t.child;i!==null;)Qc(i,e),i=i.sibling;return $(_n,_n.current&1|2),wt&&ei(t,l.treeForkCount),t.child}e=e.sibling}l.tail!==null&&ft()>yu&&(t.flags|=128,a=!0,Ee(l,!1),t.lanes=4194304)}else{if(!a)if(e=gc(s),e!==null){if(t.flags|=128,a=!0,e=e.updateQueue,t.updateQueue=e,je(t,e),Ee(l,!0),l.tail===null&&l.tailMode==="hidden"&&!s.alternate&&!wt)return Me(t),null}else 2*ft()-l.renderingStartTime>yu&&i!==536870912&&(t.flags|=128,a=!0,Ee(l,!1),t.lanes=4194304);l.isBackwards?(s.sibling=t.child,t.child=s):(e=l.last,e!==null?e.sibling=s:t.child=s,l.last=s)}return l.tail!==null?(e=l.tail,l.rendering=e,l.tail=e.sibling,l.renderingStartTime=ft(),e.sibling=null,i=_n.current,$(_n,a?i&1|2:i&1),wt&&ei(t,l.treeForkCount),e):(Me(t),null);case 22:case 23:return il(t),id(),l=t.memoizedState!==null,e!==null?e.memoizedState!==null!==l&&(t.flags|=8192):l&&(t.flags|=8192),l?(i&536870912)!==0&&(t.flags&128)===0&&(Me(t),t.subtreeFlags&6&&(t.flags|=8192)):Me(t),i=t.updateQueue,i!==null&&je(t,i.retryQueue),i=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(i=e.memoizedState.cachePool.pool),l=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(l=t.memoizedState.cachePool.pool),l!==i&&(t.flags|=2048),e!==null&&U(Fl),null;case 24:return i=null,e!==null&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),Il(Tn),Me(t),null;case 25:return null;case 30:return null}throw Error(d(156,t.tag))}function _(e,t){switch(wa(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Il(Tn),He(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Un(t),null;case 31:if(t.memoizedState!==null){if(il(t),t.alternate===null)throw Error(d(340));es()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(il(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(d(340));es()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return U(_n),null;case 4:return He(),null;case 10:return Il(t.type),null;case 22:case 23:return il(t),id(),e!==null&&U(Fl),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Il(Tn),null;case 25:return null;default:return null}}function ve(e,t){switch(wa(t),t.tag){case 3:Il(Tn),He();break;case 26:case 27:case 5:Un(t);break;case 4:He();break;case 31:t.memoizedState!==null&&il(t);break;case 13:il(t);break;case 19:U(_n);break;case 10:Il(t.type);break;case 22:case 23:il(t),id(),e!==null&&U(Fl);break;case 24:Il(Tn)}}function ue(e,t){try{var i=t.updateQueue,l=i!==null?i.lastEffect:null;if(l!==null){var a=l.next;i=a;do{if((i.tag&e)===e){l=void 0;var s=i.create,h=i.inst;l=s(),h.destroy=l}i=i.next}while(i!==a)}}catch(S){fn(t,t.return,S)}}function Ne(e,t,i){try{var l=t.updateQueue,a=l!==null?l.lastEffect:null;if(a!==null){var s=a.next;l=s;do{if((l.tag&e)===e){var h=l.inst,S=h.destroy;if(S!==void 0){h.destroy=void 0,a=t;var E=i,ae=S;try{ae()}catch(we){fn(a,E,we)}}}l=l.next}while(l!==s)}}catch(we){fn(t,t.return,we)}}function Fe(e){var t=e.updateQueue;if(t!==null){var i=e.stateNode;try{Kd(t,i)}catch(l){fn(e,e.return,l)}}}function nt(e,t,i){i.props=Lo(e.type,e.memoizedProps),i.state=e.memoizedState;try{i.componentWillUnmount()}catch(l){fn(e,t,l)}}function Ye(e,t){try{var i=e.ref;if(i!==null){switch(e.tag){case 26:case 27:case 5:var l=e.stateNode;break;case 30:l=e.stateNode;break;default:l=e.stateNode}typeof i=="function"?e.refCleanup=i(l):i.current=l}}catch(a){fn(e,t,a)}}function et(e,t){var i=e.ref,l=e.refCleanup;if(i!==null)if(typeof l=="function")try{l()}catch(a){fn(e,t,a)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof i=="function")try{i(null)}catch(a){fn(e,t,a)}else i.current=null}function it(e){var t=e.type,i=e.memoizedProps,l=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":i.autoFocus&&l.focus();break e;case"img":i.src?l.src=i.src:i.srcSet&&(l.srcset=i.srcSet)}}catch(a){fn(e,e.return,a)}}function vt(e,t,i){try{var l=e.stateNode;ig(l,e.type,i,t),l[Pn]=t}catch(a){fn(e,e.return,a)}}function lt(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&ur(e.type)||e.tag===4}function Pe(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||lt(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&ur(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ut(e,t,i){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i).insertBefore(e,t):(t=i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,t.appendChild(e),i=i._reactRootContainer,i!=null||t.onclick!==null||(t.onclick=jt));else if(l!==4&&(l===27&&ur(e.type)&&(i=e.stateNode,t=null),e=e.child,e!==null))for(ut(e,t,i),e=e.sibling;e!==null;)ut(e,t,i),e=e.sibling}function $t(e,t,i){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?i.insertBefore(e,t):i.appendChild(e);else if(l!==4&&(l===27&&ur(e.type)&&(i=e.stateNode),e=e.child,e!==null))for($t(e,t,i),e=e.sibling;e!==null;)$t(e,t,i),e=e.sibling}function Jt(e){var t=e.stateNode,i=e.memoizedProps;try{for(var l=e.type,a=t.attributes;a.length;)t.removeAttributeNode(a[0]);Bi(t,l,i),t[pt]=e,t[Pn]=i}catch(s){fn(e,e.return,s)}}var It=!1,kt=!1,zn=!1,St=typeof WeakSet=="function"?WeakSet:Set,gn=null;function Yo(e,t){if(e=e.containerInfo,yf=Uu,e=Xd(e),ko(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var l=i.getSelection&&i.getSelection();if(l&&l.rangeCount!==0){i=l.anchorNode;var a=l.anchorOffset,s=l.focusNode;l=l.focusOffset;try{i.nodeType,s.nodeType}catch{i=null;break e}var h=0,S=-1,E=-1,ae=0,we=0,ke=e,fe=null;t:for(;;){for(var ye;ke!==i||a!==0&&ke.nodeType!==3||(S=h+a),ke!==s||l!==0&&ke.nodeType!==3||(E=h+l),ke.nodeType===3&&(h+=ke.nodeValue.length),(ye=ke.firstChild)!==null;)fe=ke,ke=ye;for(;;){if(ke===e)break t;if(fe===i&&++ae===a&&(S=h),fe===s&&++we===l&&(E=h),(ye=ke.nextSibling)!==null)break;ke=fe,fe=ke.parentNode}ke=ye}i=S===-1||E===-1?null:{start:S,end:E}}else i=null}i=i||{start:0,end:0}}else i=null;for(bf={focusedElem:e,selectionRange:i},Uu=!1,gn=t;gn!==null;)if(t=gn,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,gn=e;else for(;gn!==null;){switch(t=gn,s=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(i=0;i<e.length;i++)a=e[i],a.ref.impl=a.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&s!==null){e=void 0,i=t,a=s.memoizedProps,s=s.memoizedState,l=i.stateNode;try{var Ge=Lo(i.type,a);e=l.getSnapshotBeforeUpdate(Ge,s),l.__reactInternalSnapshotBeforeUpdate=e}catch(bt){fn(i,i.return,bt)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,i=e.nodeType,i===9)Sf(e);else if(i===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Sf(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(d(163))}if(e=t.sibling,e!==null){e.return=t.return,gn=e;break}gn=t.return}}function ll(e,t,i){var l=i.flags;switch(i.tag){case 0:case 11:case 15:ps(e,i),l&4&&ue(5,i);break;case 1:if(ps(e,i),l&4)if(e=i.stateNode,t===null)try{e.componentDidMount()}catch(h){fn(i,i.return,h)}else{var a=Lo(i.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(a,t,e.__reactInternalSnapshotBeforeUpdate)}catch(h){fn(i,i.return,h)}}l&64&&Fe(i),l&512&&Ye(i,i.return);break;case 3:if(ps(e,i),l&64&&(e=i.updateQueue,e!==null)){if(t=null,i.child!==null)switch(i.child.tag){case 27:case 5:t=i.child.stateNode;break;case 1:t=i.child.stateNode}try{Kd(e,t)}catch(h){fn(i,i.return,h)}}break;case 27:t===null&&l&4&&Jt(i);case 26:case 5:ps(e,i),t===null&&l&4&&it(i),l&512&&Ye(i,i.return);break;case 12:ps(e,i);break;case 31:ps(e,i),l&4&&Qf(e,i);break;case 13:ps(e,i),l&4&&Jf(e,i),l&64&&(e=i.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(i=Lh.bind(null,i),ug(e,i))));break;case 22:if(l=i.memoizedState!==null||It,!l){t=t!==null&&t.memoizedState!==null||kt,a=It;var s=kt;It=l,(kt=t)&&!s?hs(e,i,(i.subtreeFlags&8772)!==0):ps(e,i),It=a,kt=s}break;case 30:break;default:ps(e,i)}}function Zf(e){var t=e.alternate;t!==null&&(e.alternate=null,Zf(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Qo(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Mn=null,Sl=!1;function fs(e,t,i){for(i=i.child;i!==null;)Kf(e,t,i),i=i.sibling}function Kf(e,t,i){if(De&&typeof De.onCommitFiberUnmount=="function")try{De.onCommitFiberUnmount(Pi,i)}catch{}switch(i.tag){case 26:kt||et(i,t),fs(e,t,i),i.memoizedState?i.memoizedState.count--:i.stateNode&&(i=i.stateNode,i.parentNode.removeChild(i));break;case 27:kt||et(i,t);var l=Mn,a=Sl;ur(i.type)&&(Mn=i.stateNode,Sl=!1),fs(e,t,i),Ad(i.stateNode),Mn=l,Sl=a;break;case 5:kt||et(i,t);case 6:if(l=Mn,a=Sl,Mn=null,fs(e,t,i),Mn=l,Sl=a,Mn!==null)if(Sl)try{(Mn.nodeType===9?Mn.body:Mn.nodeName==="HTML"?Mn.ownerDocument.body:Mn).removeChild(i.stateNode)}catch(s){fn(i,t,s)}else try{Mn.removeChild(i.stateNode)}catch(s){fn(i,t,s)}break;case 18:Mn!==null&&(Sl?(e=Mn,Fp(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,i.stateNode),Vc(e)):Fp(Mn,i.stateNode));break;case 4:l=Mn,a=Sl,Mn=i.stateNode.containerInfo,Sl=!0,fs(e,t,i),Mn=l,Sl=a;break;case 0:case 11:case 14:case 15:Ne(2,i,t),kt||Ne(4,i,t),fs(e,t,i);break;case 1:kt||(et(i,t),l=i.stateNode,typeof l.componentWillUnmount=="function"&&nt(i,t,l)),fs(e,t,i);break;case 21:fs(e,t,i);break;case 22:kt=(l=kt)||i.memoizedState!==null,fs(e,t,i),kt=l;break;default:fs(e,t,i)}}function Qf(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Vc(e)}catch(i){fn(t,t.return,i)}}}function Jf(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Vc(e)}catch(i){fn(t,t.return,i)}}function _h(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new St),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new St),t;default:throw Error(d(435,e.tag))}}function hu(e,t){var i=_h(e);t.forEach(function(l){if(!i.has(l)){i.add(l);var a=Yh.bind(null,e,l);l.then(a,a)}})}function wl(e,t){var i=t.deletions;if(i!==null)for(var l=0;l<i.length;l++){var a=i[l],s=e,h=t,S=h;e:for(;S!==null;){switch(S.tag){case 27:if(ur(S.type)){Mn=S.stateNode,Sl=!1;break e}break;case 5:Mn=S.stateNode,Sl=!1;break e;case 3:case 4:Mn=S.stateNode.containerInfo,Sl=!0;break e}S=S.return}if(Mn===null)throw Error(d(160));Kf(s,h,a),Mn=null,Sl=!1,s=a.alternate,s!==null&&(s.return=null),a.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)ep(t,e),t=t.sibling}var Xo=null;function ep(e,t){var i=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:wl(t,e),jl(e),l&4&&(Ne(3,e,e.return),ue(3,e),Ne(5,e,e.return));break;case 1:wl(t,e),jl(e),l&512&&(kt||i===null||et(i,i.return)),l&64&&It&&(e=e.updateQueue,e!==null&&(l=e.callbacks,l!==null&&(i=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=i===null?l:i.concat(l))));break;case 26:var a=Xo;if(wl(t,e),jl(e),l&512&&(kt||i===null||et(i,i.return)),l&4){var s=i!==null?i.memoizedState:null;if(l=e.memoizedState,i===null)if(l===null)if(e.stateNode===null){e:{l=e.type,i=e.memoizedProps,a=a.ownerDocument||a;t:switch(l){case"title":s=a.getElementsByTagName("title")[0],(!s||s[To]||s[pt]||s.namespaceURI==="http://www.w3.org/2000/svg"||s.hasAttribute("itemprop"))&&(s=a.createElement(l),a.head.insertBefore(s,a.querySelector("head > title"))),Bi(s,l,i),s[pt]=e,Bt(s),l=s;break e;case"link":var h=eh("link","href",a).get(l+(i.href||""));if(h){for(var S=0;S<h.length;S++)if(s=h[S],s.getAttribute("href")===(i.href==null||i.href===""?null:i.href)&&s.getAttribute("rel")===(i.rel==null?null:i.rel)&&s.getAttribute("title")===(i.title==null?null:i.title)&&s.getAttribute("crossorigin")===(i.crossOrigin==null?null:i.crossOrigin)){h.splice(S,1);break t}}s=a.createElement(l),Bi(s,l,i),a.head.appendChild(s);break;case"meta":if(h=eh("meta","content",a).get(l+(i.content||""))){for(S=0;S<h.length;S++)if(s=h[S],s.getAttribute("content")===(i.content==null?null:""+i.content)&&s.getAttribute("name")===(i.name==null?null:i.name)&&s.getAttribute("property")===(i.property==null?null:i.property)&&s.getAttribute("http-equiv")===(i.httpEquiv==null?null:i.httpEquiv)&&s.getAttribute("charset")===(i.charSet==null?null:i.charSet)){h.splice(S,1);break t}}s=a.createElement(l),Bi(s,l,i),a.head.appendChild(s);break;default:throw Error(d(468,l))}s[pt]=e,Bt(s),l=s}e.stateNode=l}else th(a,e.type,e.stateNode);else e.stateNode=Jp(a,l,e.memoizedProps);else s!==l?(s===null?i.stateNode!==null&&(i=i.stateNode,i.parentNode.removeChild(i)):s.count--,l===null?th(a,e.type,e.stateNode):Jp(a,l,e.memoizedProps)):l===null&&e.stateNode!==null&&vt(e,e.memoizedProps,i.memoizedProps)}break;case 27:wl(t,e),jl(e),l&512&&(kt||i===null||et(i,i.return)),i!==null&&l&4&&vt(e,e.memoizedProps,i.memoizedProps);break;case 5:if(wl(t,e),jl(e),l&512&&(kt||i===null||et(i,i.return)),e.flags&32){a=e.stateNode;try{qe(a,"")}catch(Ge){fn(e,e.return,Ge)}}l&4&&e.stateNode!=null&&(a=e.memoizedProps,vt(e,a,i!==null?i.memoizedProps:a)),l&1024&&(zn=!0);break;case 6:if(wl(t,e),jl(e),l&4){if(e.stateNode===null)throw Error(d(162));l=e.memoizedProps,i=e.stateNode;try{i.nodeValue=l}catch(Ge){fn(e,e.return,Ge)}}break;case 3:if(Au=null,a=Xo,Xo=Ru(t.containerInfo),wl(t,e),Xo=a,jl(e),l&4&&i!==null&&i.memoizedState.isDehydrated)try{Vc(t.containerInfo)}catch(Ge){fn(e,e.return,Ge)}zn&&(zn=!1,tp(e));break;case 4:l=Xo,Xo=Ru(e.stateNode.containerInfo),wl(t,e),jl(e),Xo=l;break;case 12:wl(t,e),jl(e);break;case 31:wl(t,e),jl(e),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,hu(e,l)));break;case 13:wl(t,e),jl(e),e.child.flags&8192&&e.memoizedState!==null!=(i!==null&&i.memoizedState!==null)&&(xu=ft()),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,hu(e,l)));break;case 22:a=e.memoizedState!==null;var E=i!==null&&i.memoizedState!==null,ae=It,we=kt;if(It=ae||a,kt=we||E,wl(t,e),kt=we,It=ae,jl(e),l&8192)e:for(t=e.stateNode,t._visibility=a?t._visibility&-2:t._visibility|1,a&&(i===null||E||It||kt||qr(e)),i=null,t=e;;){if(t.tag===5||t.tag===26){if(i===null){E=i=t;try{if(s=E.stateNode,a)h=s.style,typeof h.setProperty=="function"?h.setProperty("display","none","important"):h.display="none";else{S=E.stateNode;var ke=E.memoizedProps.style,fe=ke!=null&&ke.hasOwnProperty("display")?ke.display:null;S.style.display=fe==null||typeof fe=="boolean"?"":(""+fe).trim()}}catch(Ge){fn(E,E.return,Ge)}}}else if(t.tag===6){if(i===null){E=t;try{E.stateNode.nodeValue=a?"":E.memoizedProps}catch(Ge){fn(E,E.return,Ge)}}}else if(t.tag===18){if(i===null){E=t;try{var ye=E.stateNode;a?$p(ye,!0):$p(E.stateNode,!1)}catch(Ge){fn(E,E.return,Ge)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;i===t&&(i=null),t=t.return}i===t&&(i=null),t.sibling.return=t.return,t=t.sibling}l&4&&(l=e.updateQueue,l!==null&&(i=l.retryQueue,i!==null&&(l.retryQueue=null,hu(e,i))));break;case 19:wl(t,e),jl(e),l&4&&(l=e.updateQueue,l!==null&&(e.updateQueue=null,hu(e,l)));break;case 30:break;case 21:break;default:wl(t,e),jl(e)}}function jl(e){var t=e.flags;if(t&2){try{for(var i,l=e.return;l!==null;){if(lt(l)){i=l;break}l=l.return}if(i==null)throw Error(d(160));switch(i.tag){case 27:var a=i.stateNode,s=Pe(e);$t(e,s,a);break;case 5:var h=i.stateNode;i.flags&32&&(qe(h,""),i.flags&=-33);var S=Pe(e);$t(e,S,h);break;case 3:case 4:var E=i.stateNode.containerInfo,ae=Pe(e);ut(e,ae,E);break;default:throw Error(d(161))}}catch(we){fn(e,e.return,we)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function tp(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;tp(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function ps(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)ll(e,t.alternate,t),t=t.sibling}function qr(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Ne(4,t,t.return),qr(t);break;case 1:et(t,t.return);var i=t.stateNode;typeof i.componentWillUnmount=="function"&&nt(t,t.return,i),qr(t);break;case 27:Ad(t.stateNode);case 26:case 5:et(t,t.return),qr(t);break;case 22:t.memoizedState===null&&qr(t);break;case 30:qr(t);break;default:qr(t)}e=e.sibling}}function hs(e,t,i){for(i=i&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var l=t.alternate,a=e,s=t,h=s.flags;switch(s.tag){case 0:case 11:case 15:hs(a,s,i),ue(4,s);break;case 1:if(hs(a,s,i),l=s,a=l.stateNode,typeof a.componentDidMount=="function")try{a.componentDidMount()}catch(ae){fn(l,l.return,ae)}if(l=s,a=l.updateQueue,a!==null){var S=l.stateNode;try{var E=a.shared.hiddenCallbacks;if(E!==null)for(a.shared.hiddenCallbacks=null,a=0;a<E.length;a++)fo(E[a],S)}catch(ae){fn(l,l.return,ae)}}i&&h&64&&Fe(s),Ye(s,s.return);break;case 27:Jt(s);case 26:case 5:hs(a,s,i),i&&l===null&&h&4&&it(s),Ye(s,s.return);break;case 12:hs(a,s,i);break;case 31:hs(a,s,i),i&&h&4&&Qf(a,s);break;case 13:hs(a,s,i),i&&h&4&&Jf(a,s);break;case 22:s.memoizedState===null&&hs(a,s,i),Ye(s,s.return);break;case 30:break;default:hs(a,s,i)}t=t.sibling}}function Zu(e,t){var i=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(i=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==i&&(e!=null&&e.refCount++,i!=null&&Uo(i))}function Ku(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Uo(e))}function Go(e,t,i,l){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)np(e,t,i,l),t=t.sibling}function np(e,t,i,l){var a=t.flags;switch(t.tag){case 0:case 11:case 15:Go(e,t,i,l),a&2048&&ue(9,t);break;case 1:Go(e,t,i,l);break;case 3:Go(e,t,i,l),a&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Uo(e)));break;case 12:if(a&2048){Go(e,t,i,l),e=t.stateNode;try{var s=t.memoizedProps,h=s.id,S=s.onPostCommit;typeof S=="function"&&S(h,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(E){fn(t,t.return,E)}}else Go(e,t,i,l);break;case 31:Go(e,t,i,l);break;case 13:Go(e,t,i,l);break;case 23:break;case 22:s=t.stateNode,h=t.alternate,t.memoizedState!==null?s._visibility&2?Go(e,t,i,l):wd(e,t):s._visibility&2?Go(e,t,i,l):(s._visibility|=2,Ac(e,t,i,l,(t.subtreeFlags&10256)!==0||!1)),a&2048&&Zu(h,t);break;case 24:Go(e,t,i,l),a&2048&&Ku(t.alternate,t);break;default:Go(e,t,i,l)}}function Ac(e,t,i,l,a){for(a=a&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var s=e,h=t,S=i,E=l,ae=h.flags;switch(h.tag){case 0:case 11:case 15:Ac(s,h,S,E,a),ue(8,h);break;case 23:break;case 22:var we=h.stateNode;h.memoizedState!==null?we._visibility&2?Ac(s,h,S,E,a):wd(s,h):(we._visibility|=2,Ac(s,h,S,E,a)),a&&ae&2048&&Zu(h.alternate,h);break;case 24:Ac(s,h,S,E,a),a&&ae&2048&&Ku(h.alternate,h);break;default:Ac(s,h,S,E,a)}t=t.sibling}}function wd(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var i=e,l=t,a=l.flags;switch(l.tag){case 22:wd(i,l),a&2048&&Zu(l.alternate,l);break;case 24:wd(i,l),a&2048&&Ku(l.alternate,l);break;default:wd(i,l)}t=t.sibling}}var jd=8192;function Nc(e,t,i){if(e.subtreeFlags&jd)for(e=e.child;e!==null;)ip(e,t,i),e=e.sibling}function ip(e,t,i){switch(e.tag){case 26:Nc(e,t,i),e.flags&jd&&e.memoizedState!==null&&jg(i,Xo,e.memoizedState,e.memoizedProps);break;case 5:Nc(e,t,i);break;case 3:case 4:var l=Xo;Xo=Ru(e.stateNode.containerInfo),Nc(e,t,i),Xo=l;break;case 22:e.memoizedState===null&&(l=e.alternate,l!==null&&l.memoizedState!==null?(l=jd,jd=16777216,Nc(e,t,i),jd=l):Nc(e,t,i));break;default:Nc(e,t,i)}}function lp(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Td(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var i=0;i<t.length;i++){var l=t[i];gn=l,ap(l,e)}lp(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)op(e),e=e.sibling}function op(e){switch(e.tag){case 0:case 11:case 15:Td(e),e.flags&2048&&Ne(9,e,e.return);break;case 3:Td(e);break;case 12:Td(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,gu(e)):Td(e);break;default:Td(e)}}function gu(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var i=0;i<t.length;i++){var l=t[i];gn=l,ap(l,e)}lp(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:Ne(8,t,t.return),gu(t);break;case 22:i=t.stateNode,i._visibility&2&&(i._visibility&=-3,gu(t));break;default:gu(t)}e=e.sibling}}function ap(e,t){for(;gn!==null;){var i=gn;switch(i.tag){case 0:case 11:case 15:Ne(8,i,t);break;case 23:case 22:if(i.memoizedState!==null&&i.memoizedState.cachePool!==null){var l=i.memoizedState.cachePool.pool;l!=null&&l.refCount++}break;case 24:Uo(i.memoizedState.cache)}if(l=i.child,l!==null)l.return=i,gn=l;else e:for(i=e;gn!==null;){l=gn;var a=l.sibling,s=l.return;if(Zf(l),l===i){gn=null;break e}if(a!==null){a.return=s,gn=a;break e}gn=s}}}var Hh={getCacheForType:function(e){var t=ri(Tn),i=t.data.get(e);return i===void 0&&(i=e(),t.data.set(e,i)),i},cacheSignal:function(){return ri(Tn).controller.signal}},Eh=typeof WeakMap=="function"?WeakMap:Map,en=0,Sn=null,Ot=null,Vt=0,un=0,Gl=null,or=!1,Mc=!1,Qu=!1,gs=0,Xn=0,ar=0,Zr=0,Ju=0,ql=0,Bc=0,Cd=null,Tl=null,ef=!1,xu=0,sp=0,yu=1/0,bu=null,sr=null,fi=0,rr=null,Uc=null,xs=0,tf=0,nf=null,rp=null,zd=0,lf=null;function Zl(){return(en&2)!==0&&Vt!==0?Vt&-Vt:H.T!==null?df():mr()}function cp(){if(ql===0)if((Vt&536870912)===0||wt){var e=bs;bs<<=1,(bs&3932160)===0&&(bs=262144),ql=e}else ql=536870912;return e=Ln.current,e!==null&&(e.flags|=32),ql}function Cl(e,t,i){(e===Sn&&(un===2||un===9)||e.cancelPendingCommit!==null)&&(Pc(e,0),cr(e,Vt,ql,!1)),to(e,i),((en&2)===0||e!==Sn)&&(e===Sn&&((en&2)===0&&(Zr|=i),Xn===4&&cr(e,Vt,ql,!1)),Oa(e))}function dp(e,t,i){if((en&6)!==0)throw Error(d(327));var l=!i&&(t&127)===0&&(t&e.expiredLanes)===0||Li(e,t),a=l?Wh(e,t):af(e,t,!0),s=l;do{if(a===0){Mc&&!l&&cr(e,t,0,!1);break}else{if(i=e.current.alternate,s&&!Ih(i)){a=af(e,t,!1),s=!1;continue}if(a===2){if(s=t,e.errorRecoveryDisabledLanes&s)var h=0;else h=e.pendingLanes&-536870913,h=h!==0?h:h&536870912?536870912:0;if(h!==0){t=h;e:{var S=e;a=Cd;var E=S.current.memoizedState.isDehydrated;if(E&&(Pc(S,h).flags|=256),h=af(S,h,!1),h!==2){if(Qu&&!E){S.errorRecoveryDisabledLanes|=s,Zr|=s,a=4;break e}s=Tl,Tl=a,s!==null&&(Tl===null?Tl=s:Tl.push.apply(Tl,s))}a=h}if(s=!1,a!==2)continue}}if(a===1){Pc(e,0),cr(e,t,0,!0);break}e:{switch(l=e,s=a,s){case 0:case 1:throw Error(d(345));case 4:if((t&4194048)!==t)break;case 6:cr(l,t,ql,!or);break e;case 2:Tl=null;break;case 3:case 5:break;default:throw Error(d(329))}if((t&62914560)===t&&(a=xu+300-ft(),10<a)){if(cr(l,t,ql,!or),eo(l,0,!0)!==0)break e;xs=t,l.timeoutHandle=Vp(up.bind(null,l,i,Tl,bu,ef,t,ql,Zr,Bc,or,s,"Throttled",-0,0),a);break e}up(l,i,Tl,bu,ef,t,ql,Zr,Bc,or,s,null,-0,0)}}break}while(!0);Oa(e)}function up(e,t,i,l,a,s,h,S,E,ae,we,ke,fe,ye){if(e.timeoutHandle=-1,ke=t.subtreeFlags,ke&8192||(ke&16785408)===16785408){ke={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:jt},ip(t,s,ke);var Ge=(s&62914560)===s?xu-ft():(s&4194048)===s?sp-ft():0;if(Ge=Tg(ke,Ge),Ge!==null){xs=s,e.cancelPendingCommit=Ge(mp.bind(null,e,t,s,i,l,a,h,S,E,we,ke,null,fe,ye)),cr(e,s,h,!ae);return}}mp(e,t,s,i,l,a,h,S,E)}function Ih(e){for(var t=e;;){var i=t.tag;if((i===0||i===11||i===15)&&t.flags&16384&&(i=t.updateQueue,i!==null&&(i=i.stores,i!==null)))for(var l=0;l<i.length;l++){var a=i[l],s=a.getSnapshot;a=a.value;try{if(!ln(s(),a))return!1}catch{return!1}}if(i=t.child,t.subtreeFlags&16384&&i!==null)i.return=t,t=i;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function cr(e,t,i,l){t&=~Ju,t&=~Zr,e.suspendedLanes|=t,e.pingedLanes&=~t,l&&(e.warmLanes|=t),l=e.expirationTimes;for(var a=t;0<a;){var s=31-tt(a),h=1<<s;l[s]=-1,a&=~h}i!==0&&We(e,i,t)}function mu(){return(en&6)===0?(kd(0),!1):!0}function of(){if(Ot!==null){if(un===0)var e=Ot.return;else e=Ot,Mo=No=null,Xs(e),Eo=null,Es=0,e=Ot;for(;e!==null;)ve(e.alternate,e),e=e.return;Ot=null}}function Pc(e,t){var i=e.timeoutHandle;i!==-1&&(e.timeoutHandle=-1,ag(i)),i=e.cancelPendingCommit,i!==null&&(e.cancelPendingCommit=null,i()),xs=0,of(),Sn=e,Ot=i=Ol(e.current,null),Vt=t,un=0,Gl=null,or=!1,Mc=Li(e,t),Qu=!1,Bc=ql=Ju=Zr=ar=Xn=0,Tl=Cd=null,ef=!1,(t&8)!==0&&(t|=t&32);var l=e.entangledLanes;if(l!==0)for(e=e.entanglements,l&=t;0<l;){var a=31-tt(l),s=1<<a;t|=e[a],l&=~s}return gs=t,ba(),i}function fp(e,t){Tt=null,H.H=Ua,t===Ta||t===is?(t=pc(),un=3):t===uc?(t=pc(),un=4):un=t===ir?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Gl=t,Ot===null&&(Xn=1,tr(e,dn(t,e.current)))}function pp(){var e=Ln.current;return e===null?!0:(Vt&4194048)===Vt?ml===null:(Vt&62914560)===Vt||(Vt&536870912)!==0?e===ml:!1}function hp(){var e=H.H;return H.H=Ua,e===null?Ua:e}function gp(){var e=H.A;return H.A=Hh,e}function vu(){Xn=4,or||(Vt&4194048)!==Vt&&Ln.current!==null||(Mc=!0),(ar&134217727)===0&&(Zr&134217727)===0||Sn===null||cr(Sn,Vt,ql,!1)}function af(e,t,i){var l=en;en|=2;var a=hp(),s=gp();(Sn!==e||Vt!==t)&&(bu=null,Pc(e,t)),t=!1;var h=Xn;e:do try{if(un!==0&&Ot!==null){var S=Ot,E=Gl;switch(un){case 8:of(),h=6;break e;case 3:case 2:case 9:case 6:Ln.current===null&&(t=!0);var ae=un;if(un=0,Gl=null,Oc(e,S,E,ae),i&&Mc){h=0;break e}break;default:ae=un,un=0,Gl=null,Oc(e,S,E,ae)}}Vh(),h=Xn;break}catch(we){fp(e,we)}while(!0);return t&&e.shellSuspendCounter++,Mo=No=null,en=l,H.H=a,H.A=s,Ot===null&&(Sn=null,Vt=0,ba()),h}function Vh(){for(;Ot!==null;)xp(Ot)}function Wh(e,t){var i=en;en|=2;var l=hp(),a=gp();Sn!==e||Vt!==t?(bu=null,yu=ft()+500,Pc(e,t)):Mc=Li(e,t);e:do try{if(un!==0&&Ot!==null){t=Ot;var s=Gl;t:switch(un){case 1:un=0,Gl=null,Oc(e,t,s,1);break;case 2:case 9:if(fc(s)){un=0,Gl=null,yp(t);break}t=function(){un!==2&&un!==9||Sn!==e||(un=7),Oa(e)},s.then(t,t);break e;case 3:un=7;break e;case 4:un=5;break e;case 7:fc(s)?(un=0,Gl=null,yp(t)):(un=0,Gl=null,Oc(e,t,s,7));break;case 5:var h=null;switch(Ot.tag){case 26:h=Ot.memoizedState;case 5:case 27:var S=Ot;if(h?nh(h):S.stateNode.complete){un=0,Gl=null;var E=S.sibling;if(E!==null)Ot=E;else{var ae=S.return;ae!==null?(Ot=ae,Su(ae)):Ot=null}break t}}un=0,Gl=null,Oc(e,t,s,5);break;case 6:un=0,Gl=null,Oc(e,t,s,6);break;case 8:of(),Xn=6;break e;default:throw Error(d(462))}}Fh();break}catch(we){fp(e,we)}while(!0);return Mo=No=null,H.H=l,H.A=a,en=i,Ot!==null?0:(Sn=null,Vt=0,ba(),Xn)}function Fh(){for(;Ot!==null&&!$c();)xp(Ot)}function xp(e){var t=ne(e.alternate,e,gs);e.memoizedProps=e.pendingProps,t===null?Su(e):Ot=t}function yp(e){var t=e,i=t.alternate;switch(t.tag){case 15:case 0:t=r(i,t,t.pendingProps,t.type,void 0,Vt);break;case 11:t=r(i,t,t.pendingProps,t.type.render,t.ref,Vt);break;case 5:Xs(t);default:ve(i,t),t=Ot=Qc(t,gs),t=ne(i,t,gs)}e.memoizedProps=e.pendingProps,t===null?Su(e):Ot=t}function Oc(e,t,i,l){Mo=No=null,Xs(t),Eo=null,Es=0;var a=t.return;try{if(nr(e,a,t,i,Vt)){Xn=1,tr(e,dn(i,e.current)),Ot=null;return}}catch(s){if(a!==null)throw Ot=a,s;Xn=1,tr(e,dn(i,e.current)),Ot=null;return}t.flags&32768?(wt||l===1?e=!0:Mc||(Vt&536870912)!==0?e=!1:(or=e=!0,(l===2||l===9||l===3||l===6)&&(l=Ln.current,l!==null&&l.tag===13&&(l.flags|=16384))),bp(t,e)):Su(t)}function Su(e){var t=e;do{if((t.flags&32768)!==0){bp(t,or);return}e=t.return;var i=G(t.alternate,t,gs);if(i!==null){Ot=i;return}if(t=t.sibling,t!==null){Ot=t;return}Ot=t=e}while(t!==null);Xn===0&&(Xn=5)}function bp(e,t){do{var i=_(e.alternate,e);if(i!==null){i.flags&=32767,Ot=i;return}if(i=e.return,i!==null&&(i.flags|=32768,i.subtreeFlags=0,i.deletions=null),!t&&(e=e.sibling,e!==null)){Ot=e;return}Ot=e=i}while(e!==null);Xn=6,Ot=null}function mp(e,t,i,l,a,s,h,S,E){e.cancelPendingCommit=null;do wu();while(fi!==0);if((en&6)!==0)throw Error(d(327));if(t!==null){if(t===e.current)throw Error(d(177));if(s=t.lanes|t.childLanes,s|=ac,Kr(e,i,s,h,S,E),e===Sn&&(Ot=Sn=null,Vt=0),Uc=t,rr=e,xs=i,tf=s,nf=a,rp=l,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Xh(Kl,function(){return Tp(),null})):(e.callbackNode=null,e.callbackPriority=0),l=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||l){l=H.T,H.T=null,a=I.p,I.p=2,h=en,en|=4;try{Yo(e,t,i)}finally{en=h,I.p=a,H.T=l}}fi=1,vp(),Sp(),wp()}}function vp(){if(fi===1){fi=0;var e=rr,t=Uc,i=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||i){i=H.T,H.T=null;var l=I.p;I.p=2;var a=en;en|=4;try{ep(t,e);var s=bf,h=Xd(e.containerInfo),S=s.focusedElem,E=s.selectionRange;if(h!==S&&S&&S.ownerDocument&&ul(S.ownerDocument.documentElement,S)){if(E!==null&&ko(S)){var ae=E.start,we=E.end;if(we===void 0&&(we=ae),"selectionStart"in S)S.selectionStart=ae,S.selectionEnd=Math.min(we,S.value.length);else{var ke=S.ownerDocument||document,fe=ke&&ke.defaultView||window;if(fe.getSelection){var ye=fe.getSelection(),Ge=S.textContent.length,bt=Math.min(E.start,Ge),yn=E.end===void 0?bt:Math.min(E.end,Ge);!ye.extend&&bt>yn&&(h=yn,yn=bt,bt=h);var ee=oi(S,bt),Y=oi(S,yn);if(ee&&Y&&(ye.rangeCount!==1||ye.anchorNode!==ee.node||ye.anchorOffset!==ee.offset||ye.focusNode!==Y.node||ye.focusOffset!==Y.offset)){var oe=ke.createRange();oe.setStart(ee.node,ee.offset),ye.removeAllRanges(),bt>yn?(ye.addRange(oe),ye.extend(Y.node,Y.offset)):(oe.setEnd(Y.node,Y.offset),ye.addRange(oe))}}}}for(ke=[],ye=S;ye=ye.parentNode;)ye.nodeType===1&&ke.push({element:ye,left:ye.scrollLeft,top:ye.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<ke.length;S++){var Ce=ke[S];Ce.element.scrollLeft=Ce.left,Ce.element.scrollTop=Ce.top}}Uu=!!yf,bf=yf=null}finally{en=a,I.p=l,H.T=i}}e.current=t,fi=2}}function Sp(){if(fi===2){fi=0;var e=rr,t=Uc,i=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||i){i=H.T,H.T=null;var l=I.p;I.p=2;var a=en;en|=4;try{ll(e,t.alternate,t)}finally{en=a,I.p=l,H.T=i}}fi=3}}function wp(){if(fi===4||fi===3){fi=0,Ze();var e=rr,t=Uc,i=xs,l=rp;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?fi=5:(fi=0,Uc=rr=null,jp(e,e.pendingLanes));var a=e.pendingLanes;if(a===0&&(sr=null),ms(i),t=t.stateNode,De&&typeof De.onCommitFiberRoot=="function")try{De.onCommitFiberRoot(Pi,t,void 0,(t.current.flags&128)===128)}catch{}if(l!==null){t=H.T,a=I.p,I.p=2,H.T=null;try{for(var s=e.onRecoverableError,h=0;h<l.length;h++){var S=l[h];s(S.value,{componentStack:S.stack})}}finally{H.T=t,I.p=a}}(xs&3)!==0&&wu(),Oa(e),a=e.pendingLanes,(i&261930)!==0&&(a&42)!==0?e===lf?zd++:(zd=0,lf=e):zd=0,kd(0)}}function jp(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Uo(t)))}function wu(){return vp(),Sp(),wp(),Tp()}function Tp(){if(fi!==5)return!1;var e=rr,t=tf;tf=0;var i=ms(xs),l=H.T,a=I.p;try{I.p=32>i?32:i,H.T=null,i=nf,nf=null;var s=rr,h=xs;if(fi=0,Uc=rr=null,xs=0,(en&6)!==0)throw Error(d(331));var S=en;if(en|=4,op(s.current),np(s,s.current,h,i),en=S,kd(0,!1),De&&typeof De.onPostCommitFiberRoot=="function")try{De.onPostCommitFiberRoot(Pi,s)}catch{}return!0}finally{I.p=a,H.T=l,jp(e,t)}}function Cp(e,t,i){t=dn(i,t),t=md(e.stateNode,t,2),e=za(e,t,2),e!==null&&(to(e,2),Oa(e))}function fn(e,t,i){if(e.tag===3)Cp(e,e,i);else for(;t!==null;){if(t.tag===3){Cp(t,e,i);break}else if(t.tag===1){var l=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(sr===null||!sr.has(l))){e=dn(i,e),i=fu(2),l=za(t,i,2),l!==null&&(Pa(i,l,t,e),to(l,2),Oa(l));break}}t=t.return}}function sf(e,t,i){var l=e.pingCache;if(l===null){l=e.pingCache=new Eh;var a=new Set;l.set(t,a)}else a=l.get(t),a===void 0&&(a=new Set,l.set(t,a));a.has(i)||(Qu=!0,a.add(i),e=$h.bind(null,e,t,i),t.then(e,e))}function $h(e,t,i){var l=e.pingCache;l!==null&&l.delete(t),e.pingedLanes|=e.suspendedLanes&i,e.warmLanes&=~i,Sn===e&&(Vt&i)===i&&(Xn===4||Xn===3&&(Vt&62914560)===Vt&&300>ft()-xu?(en&2)===0&&Pc(e,0):Ju|=i,Bc===Vt&&(Bc=0)),Oa(e)}function zp(e,t){t===0&&(t=Oi()),e=pl(e,t),e!==null&&(to(e,t),Oa(e))}function Lh(e){var t=e.memoizedState,i=0;t!==null&&(i=t.retryLane),zp(e,i)}function Yh(e,t){var i=0;switch(e.tag){case 31:case 13:var l=e.stateNode,a=e.memoizedState;a!==null&&(i=a.retryLane);break;case 19:l=e.stateNode;break;case 22:l=e.stateNode._retryCache;break;default:throw Error(d(314))}l!==null&&l.delete(t),zp(e,i)}function Xh(e,t){return yr(e,t)}var ju=null,_c=null,rf=!1,Tu=!1,cf=!1,dr=0;function Oa(e){e!==_c&&e.next===null&&(_c===null?ju=_c=e:_c=_c.next=e),Tu=!0,rf||(rf=!0,qh())}function kd(e,t){if(!cf&&Tu){cf=!0;do for(var i=!1,l=ju;l!==null;){if(e!==0){var a=l.pendingLanes;if(a===0)var s=0;else{var h=l.suspendedLanes,S=l.pingedLanes;s=(1<<31-tt(42|e)+1)-1,s&=a&~(h&~S),s=s&201326741?s&201326741|1:s?s|2:0}s!==0&&(i=!0,Ap(l,s))}else s=Vt,s=eo(l,l===Sn?s:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),(s&3)===0||Li(l,s)||(i=!0,Ap(l,s));l=l.next}while(i);cf=!1}}function Gh(){kp()}function kp(){Tu=rf=!1;var e=0;dr!==0&&og()&&(e=dr);for(var t=ft(),i=null,l=ju;l!==null;){var a=l.next,s=Rp(l,t);s===0?(l.next=null,i===null?ju=a:i.next=a,a===null&&(_c=i)):(i=l,(e!==0||(s&3)!==0)&&(Tu=!0)),l=a}fi!==0&&fi!==5||kd(e),dr!==0&&(dr=0)}function Rp(e,t){for(var i=e.suspendedLanes,l=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes&-62914561;0<s;){var h=31-tt(s),S=1<<h,E=a[h];E===-1?((S&i)===0||(S&l)!==0)&&(a[h]=_a(S,t)):E<=t&&(e.expiredLanes|=S),s&=~S}if(t=Sn,i=Vt,i=eo(e,e===t?i:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),l=e.callbackNode,i===0||e===t&&(un===2||un===9)||e.cancelPendingCommit!==null)return l!==null&&l!==null&&Ko(l),e.callbackNode=null,e.callbackPriority=0;if((i&3)===0||Li(e,i)){if(t=i&-i,t===e.callbackPriority)return t;switch(l!==null&&Ko(l),ms(i)){case 2:case 8:i=Pt;break;case 32:i=Kl;break;case 268435456:i=Xt;break;default:i=Kl}return l=Dp.bind(null,e),i=yr(i,l),e.callbackPriority=t,e.callbackNode=i,t}return l!==null&&l!==null&&Ko(l),e.callbackPriority=2,e.callbackNode=null,2}function Dp(e,t){if(fi!==0&&fi!==5)return e.callbackNode=null,e.callbackPriority=0,null;var i=e.callbackNode;if(wu()&&e.callbackNode!==i)return null;var l=Vt;return l=eo(e,e===Sn?l:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),l===0?null:(dp(e,l,t),Rp(e,ft()),e.callbackNode!=null&&e.callbackNode===i?Dp.bind(null,e):null)}function Ap(e,t){if(wu())return null;dp(e,t,!0)}function qh(){sg(function(){(en&6)!==0?yr(_e,Gh):kp()})}function df(){if(dr===0){var e=Po;e===0&&(e=Jl,Jl<<=1,(Jl&261888)===0&&(Jl=256)),dr=e}return dr}function Np(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:at(""+e)}function Mp(e,t){var i=t.ownerDocument.createElement("input");return i.name=t.name,i.value=t.value,e.id&&i.setAttribute("form",e.id),t.parentNode.insertBefore(i,t),e=new FormData(e),i.parentNode.removeChild(i),e}function Zh(e,t,i,l,a){if(t==="submit"&&i&&i.stateNode===a){var s=Np((a[Pn]||null).action),h=l.submitter;h&&(t=(t=h[Pn]||null)?Np(t.formAction):h.getAttribute("formAction"),t!==null&&(s=t,h=null));var S=new qt("action","action",null,l,a);e.push({event:S,listeners:[{instance:null,listener:function(){if(l.defaultPrevented){if(dr!==0){var E=h?Mp(a,h):new FormData(a);wc(i,{pending:!0,data:E,method:a.method,action:s},null,E)}}else typeof s=="function"&&(S.preventDefault(),E=h?Mp(a,h):new FormData(a),wc(i,{pending:!0,data:E,method:a.method,action:s},s,E))},currentTarget:a}]})}}for(var uf=0;uf<Za.length;uf++){var ff=Za[uf],Kh=ff.toLowerCase(),Qh=ff[0].toUpperCase()+ff.slice(1);fl(Kh,"on"+Qh)}fl(Kc,"onAnimationEnd"),fl(ya,"onAnimationIteration"),fl(As,"onAnimationStart"),fl("dblclick","onDoubleClick"),fl("focusin","onFocus"),fl("focusout","onBlur"),fl(qa,"onTransitionRun"),fl(Ns,"onTransitionStart"),fl(oc,"onTransitionCancel"),fl(Nr,"onTransitionEnd"),cl("onMouseEnter",["mouseout","mouseover"]),cl("onMouseLeave",["mouseout","mouseover"]),cl("onPointerEnter",["pointerout","pointerover"]),cl("onPointerLeave",["pointerout","pointerover"]),rn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),rn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),rn("onBeforeInput",["compositionend","keypress","textInput","paste"]),rn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),rn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),rn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Jh=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Rd));function Bp(e,t){t=(t&4)!==0;for(var i=0;i<e.length;i++){var l=e[i],a=l.event;l=l.listeners;e:{var s=void 0;if(t)for(var h=l.length-1;0<=h;h--){var S=l[h],E=S.instance,ae=S.currentTarget;if(S=S.listener,E!==s&&a.isPropagationStopped())break e;s=S,a.currentTarget=ae;try{s(a)}catch(we){Ki(we)}a.currentTarget=null,s=E}else for(h=0;h<l.length;h++){if(S=l[h],E=S.instance,ae=S.currentTarget,S=S.listener,E!==s&&a.isPropagationStopped())break e;s=S,a.currentTarget=ae;try{s(a)}catch(we){Ki(we)}a.currentTarget=null,s=E}}}}function _t(e,t){var i=t[Ha];i===void 0&&(i=t[Ha]=new Set);var l=e+"__bubble";i.has(l)||(Up(t,e,2,!1),i.add(l))}function pf(e,t,i){var l=0;t&&(l|=4),Up(i,e,l,t)}var Cu="_reactListening"+Math.random().toString(36).slice(2);function hf(e){if(!e[Cu]){e[Cu]=!0,Qr.forEach(function(i){i!=="selectionchange"&&(Jh.has(i)||pf(i,!1,e),pf(i,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Cu]||(t[Cu]=!0,pf("selectionchange",!1,t))}}function Up(e,t,i,l){switch(ch(t)){case 2:var a=kg;break;case 8:a=Rg;break;default:a=Df}i=a.bind(null,t,i,e),a=void 0,!na||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),l?a!==void 0?e.addEventListener(t,i,{capture:!0,passive:a}):e.addEventListener(t,i,!0):a!==void 0?e.addEventListener(t,i,{passive:a}):e.addEventListener(t,i,!1)}function gf(e,t,i,l,a){var s=l;if((t&1)===0&&(t&2)===0&&l!==null)e:for(;;){if(l===null)return;var h=l.tag;if(h===3||h===4){var S=l.stateNode.containerInfo;if(S===a)break;if(h===4)for(h=l.return;h!==null;){var E=h.tag;if((E===3||E===4)&&h.stateNode.containerInfo===a)return;h=h.return}for(;S!==null;){if(h=Dl(S),h===null)return;if(E=h.tag,E===5||E===6||E===26||E===27){l=s=h;continue e}S=S.parentNode}}l=l.return}Fa(function(){var ae=s,we=Xc(i),ke=[];e:{var fe=Ms.get(e);if(fe!==void 0){var ye=qt,Ge=e;switch(e){case"keypress":if(Cr(i)===0)break e;case"keydown":case"keyup":ye=js;break;case"focusin":Ge="focus",ye=la;break;case"focusout":Ge="blur",ye=la;break;case"beforeblur":case"afterblur":ye=la;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ye=ia;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ye=dl;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ye=Ts;break;case Kc:case ya:case As:ye=Ri;break;case Nr:ye=Yu;break;case"scroll":case"scrollend":ye=ki;break;case"wheel":ye=ec;break;case"copy":case"cut":case"paste":ye=mi;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ye=La;break;case"toggle":case"beforetoggle":ye=qc}var bt=(t&4)!==0,yn=!bt&&(e==="scroll"||e==="scrollend"),ee=bt?fe!==null?fe+"Capture":null:fe;bt=[];for(var Y=ae,oe;Y!==null;){var Ce=Y;if(oe=Ce.stateNode,Ce=Ce.tag,Ce!==5&&Ce!==26&&Ce!==27||oe===null||ee===null||(Ce=$a(Y,ee),Ce!=null&&bt.push(Dd(Y,Ce,oe))),yn)break;Y=Y.return}0<bt.length&&(fe=new ye(fe,Ge,null,i,we),ke.push({event:fe,listeners:bt}))}}if((t&7)===0){e:{if(fe=e==="mouseover"||e==="pointerover",ye=e==="mouseout"||e==="pointerout",fe&&i!==ht&&(Ge=i.relatedTarget||i.fromElement)&&(Dl(Ge)||Ge[Ft]))break e;if((ye||fe)&&(fe=we.window===we?we:(fe=we.ownerDocument)?fe.defaultView||fe.parentWindow:window,ye?(Ge=i.relatedTarget||i.toElement,ye=ae,Ge=Ge?Dl(Ge):null,Ge!==null&&(yn=F(Ge),bt=Ge.tag,Ge!==yn||bt!==5&&bt!==27&&bt!==6)&&(Ge=null)):(ye=null,Ge=ae),ye!==Ge)){if(bt=ia,Ce="onMouseLeave",ee="onMouseEnter",Y="mouse",(e==="pointerout"||e==="pointerover")&&(bt=La,Ce="onPointerLeave",ee="onPointerEnter",Y="pointer"),yn=ye==null?fe:Al(ye),oe=Ge==null?fe:Al(Ge),fe=new bt(Ce,Y+"leave",ye,i,we),fe.target=yn,fe.relatedTarget=oe,Ce=null,Dl(we)===ae&&(bt=new bt(ee,Y+"enter",Ge,i,we),bt.target=oe,bt.relatedTarget=yn,Ce=bt),yn=Ce,ye&&Ge)t:{for(bt=eg,ee=ye,Y=Ge,oe=0,Ce=ee;Ce;Ce=bt(Ce))oe++;Ce=0;for(var rt=Y;rt;rt=bt(rt))Ce++;for(;0<oe-Ce;)ee=bt(ee),oe--;for(;0<Ce-oe;)Y=bt(Y),Ce--;for(;oe--;){if(ee===Y||Y!==null&&ee===Y.alternate){bt=ee;break t}ee=bt(ee),Y=bt(Y)}bt=null}else bt=null;ye!==null&&Pp(ke,fe,ye,bt,!1),Ge!==null&&yn!==null&&Pp(ke,yn,Ge,bt,!0)}}e:{if(fe=ae?Al(ae):window,ye=fe.nodeName&&fe.nodeName.toLowerCase(),ye==="select"||ye==="input"&&fe.type==="file")var Kt=Ld;else if(mn(fe))if(Yd)Kt=Bl;else{Kt=pa;var Qe=fa}else ye=fe.nodeName,!ye||ye.toLowerCase()!=="input"||fe.type!=="checkbox"&&fe.type!=="radio"?ae&&mt(ae.elementType)&&(Kt=Ld):Kt=ha;if(Kt&&(Kt=Kt(e,ae))){da(ke,Kt,i,we);break e}Qe&&Qe(e,fe,ae),e==="focusout"&&ae&&fe.type==="number"&&ae.memoizedProps.value!=null&&Va(fe,"number",fe.value)}switch(Qe=ae?Al(ae):window,e){case"focusin":(mn(Qe)||Qe.contentEditable==="true")&&(Ro=Qe,Zt=ae,Ai=null);break;case"focusout":Ai=Zt=Ro=null;break;case"mousedown":Dr=!0;break;case"contextmenu":case"mouseup":case"dragend":Dr=!1,Zc(ke,i,we);break;case"selectionchange":if(Gd)break;case"keydown":case"keyup":Zc(ke,i,we)}var Nt;if(Cs)e:{switch(e){case"compositionstart":var Wt="onCompositionStart";break e;case"compositionend":Wt="onCompositionEnd";break e;case"compositionupdate":Wt="onCompositionUpdate";break e}Wt=void 0}else ca?ic(e,i)&&(Wt="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(Wt="onCompositionStart");Wt&&(sa&&i.locale!=="ko"&&(ca||Wt!=="onCompositionStart"?Wt==="onCompositionEnd"&&ca&&(Nt=vs()):(qi=we,jr="value"in qi?qi.value:qi.textContent,ca=!0)),Qe=zu(ae,Wt),0<Qe.length&&(Wt=new _i(Wt,e,null,i,we),ke.push({event:Wt,listeners:Qe}),Nt?Wt.data=Nt:(Nt=ra(i),Nt!==null&&(Wt.data=Nt)))),(Nt=zs?ks(e,i):nn(e,i))&&(Wt=zu(ae,"onBeforeInput"),0<Wt.length&&(Qe=new _i("onBeforeInput","beforeinput",null,i,we),ke.push({event:Qe,listeners:Wt}),Qe.data=Nt)),Zh(ke,e,ae,i,we)}Bp(ke,t)})}function Dd(e,t,i){return{instance:e,listener:t,currentTarget:i}}function zu(e,t){for(var i=t+"Capture",l=[];e!==null;){var a=e,s=a.stateNode;if(a=a.tag,a!==5&&a!==26&&a!==27||s===null||(a=$a(e,i),a!=null&&l.unshift(Dd(e,a,s)),a=$a(e,t),a!=null&&l.push(Dd(e,a,s))),e.tag===3)return l;e=e.return}return[]}function eg(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Pp(e,t,i,l,a){for(var s=t._reactName,h=[];i!==null&&i!==l;){var S=i,E=S.alternate,ae=S.stateNode;if(S=S.tag,E!==null&&E===l)break;S!==5&&S!==26&&S!==27||ae===null||(E=ae,a?(ae=$a(i,s),ae!=null&&h.unshift(Dd(i,ae,E))):a||(ae=$a(i,s),ae!=null&&h.push(Dd(i,ae,E)))),i=i.return}h.length!==0&&e.push({event:t,listeners:h})}var tg=/\r\n?/g,ng=/\u0000|\uFFFD/g;function Op(e){return(typeof e=="string"?e:""+e).replace(tg,`
`).replace(ng,"")}function _p(e,t){return t=Op(t),Op(e)===t}function xn(e,t,i,l,a,s){switch(i){case"children":typeof l=="string"?t==="body"||t==="textarea"&&l===""||qe(e,l):(typeof l=="number"||typeof l=="bigint")&&t!=="body"&&qe(e,""+l);break;case"className":Ea(e,"class",l);break;case"tabIndex":Ea(e,"tabindex",l);break;case"dir":case"role":case"viewBox":case"width":case"height":Ea(e,i,l);break;case"style":Xi(e,l,s);break;case"data":if(t!=="object"){Ea(e,"data",l);break}case"src":case"href":if(l===""&&(t!=="a"||i!=="href")){e.removeAttribute(i);break}if(l==null||typeof l=="function"||typeof l=="symbol"||typeof l=="boolean"){e.removeAttribute(i);break}l=at(""+l),e.setAttribute(i,l);break;case"action":case"formAction":if(typeof l=="function"){e.setAttribute(i,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof s=="function"&&(i==="formAction"?(t!=="input"&&xn(e,t,"name",a.name,a,null),xn(e,t,"formEncType",a.formEncType,a,null),xn(e,t,"formMethod",a.formMethod,a,null),xn(e,t,"formTarget",a.formTarget,a,null)):(xn(e,t,"encType",a.encType,a,null),xn(e,t,"method",a.method,a,null),xn(e,t,"target",a.target,a,null)));if(l==null||typeof l=="symbol"||typeof l=="boolean"){e.removeAttribute(i);break}l=at(""+l),e.setAttribute(i,l);break;case"onClick":l!=null&&(e.onclick=jt);break;case"onScroll":l!=null&&_t("scroll",e);break;case"onScrollEnd":l!=null&&_t("scrollend",e);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(d(61));if(i=l.__html,i!=null){if(a.children!=null)throw Error(d(60));e.innerHTML=i}}break;case"multiple":e.multiple=l&&typeof l!="function"&&typeof l!="symbol";break;case"muted":e.muted=l&&typeof l!="function"&&typeof l!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(l==null||typeof l=="function"||typeof l=="boolean"||typeof l=="symbol"){e.removeAttribute("xlink:href");break}i=at(""+l),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",i);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":l!=null&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(i,""+l):e.removeAttribute(i);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":l&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(i,""):e.removeAttribute(i);break;case"capture":case"download":l===!0?e.setAttribute(i,""):l!==!1&&l!=null&&typeof l!="function"&&typeof l!="symbol"?e.setAttribute(i,l):e.removeAttribute(i);break;case"cols":case"rows":case"size":case"span":l!=null&&typeof l!="function"&&typeof l!="symbol"&&!isNaN(l)&&1<=l?e.setAttribute(i,l):e.removeAttribute(i);break;case"rowSpan":case"start":l==null||typeof l=="function"||typeof l=="symbol"||isNaN(l)?e.removeAttribute(i):e.setAttribute(i,l);break;case"popover":_t("beforetoggle",e),_t("toggle",e),gi(e,"popover",l);break;case"xlinkActuate":Wn(e,"http://www.w3.org/1999/xlink","xlink:actuate",l);break;case"xlinkArcrole":Wn(e,"http://www.w3.org/1999/xlink","xlink:arcrole",l);break;case"xlinkRole":Wn(e,"http://www.w3.org/1999/xlink","xlink:role",l);break;case"xlinkShow":Wn(e,"http://www.w3.org/1999/xlink","xlink:show",l);break;case"xlinkTitle":Wn(e,"http://www.w3.org/1999/xlink","xlink:title",l);break;case"xlinkType":Wn(e,"http://www.w3.org/1999/xlink","xlink:type",l);break;case"xmlBase":Wn(e,"http://www.w3.org/XML/1998/namespace","xml:base",l);break;case"xmlLang":Wn(e,"http://www.w3.org/XML/1998/namespace","xml:lang",l);break;case"xmlSpace":Wn(e,"http://www.w3.org/XML/1998/namespace","xml:space",l);break;case"is":gi(e,"is",l);break;case"innerText":case"textContent":break;default:(!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(i=gt.get(i)||i,gi(e,i,l))}}function xf(e,t,i,l,a,s){switch(i){case"style":Xi(e,l,s);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(d(61));if(i=l.__html,i!=null){if(a.children!=null)throw Error(d(60));e.innerHTML=i}}break;case"children":typeof l=="string"?qe(e,l):(typeof l=="number"||typeof l=="bigint")&&qe(e,""+l);break;case"onScroll":l!=null&&_t("scroll",e);break;case"onScrollEnd":l!=null&&_t("scrollend",e);break;case"onClick":l!=null&&(e.onclick=jt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ht.hasOwnProperty(i))e:{if(i[0]==="o"&&i[1]==="n"&&(a=i.endsWith("Capture"),t=i.slice(2,a?i.length-7:void 0),s=e[Pn]||null,s=s!=null?s[i]:null,typeof s=="function"&&e.removeEventListener(t,s,a),typeof l=="function")){typeof s!="function"&&s!==null&&(i in e?e[i]=null:e.hasAttribute(i)&&e.removeAttribute(i)),e.addEventListener(t,l,a);break e}i in e?e[i]=l:l===!0?e.setAttribute(i,""):gi(e,i,l)}}}function Bi(e,t,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":_t("error",e),_t("load",e);var l=!1,a=!1,s;for(s in i)if(i.hasOwnProperty(s)){var h=i[s];if(h!=null)switch(s){case"src":l=!0;break;case"srcSet":a=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(d(137,t));default:xn(e,t,s,h,i,null)}}a&&xn(e,t,"srcSet",i.srcSet,i,null),l&&xn(e,t,"src",i.src,i,null);return;case"input":_t("invalid",e);var S=s=h=a=null,E=null,ae=null;for(l in i)if(i.hasOwnProperty(l)){var we=i[l];if(we!=null)switch(l){case"name":a=we;break;case"type":h=we;break;case"checked":E=we;break;case"defaultChecked":ae=we;break;case"value":s=we;break;case"defaultValue":S=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(d(137,t));break;default:xn(e,t,l,we,i,null)}}io(e,s,S,E,ae,h,a,!1);return;case"select":_t("invalid",e),l=h=s=null;for(a in i)if(i.hasOwnProperty(a)&&(S=i[a],S!=null))switch(a){case"value":s=S;break;case"defaultValue":h=S;break;case"multiple":l=S;default:xn(e,t,a,S,i,null)}t=s,i=h,e.multiple=!!l,t!=null?lo(e,!!l,t,!1):i!=null&&lo(e,!!l,i,!0);return;case"textarea":_t("invalid",e),s=a=l=null;for(h in i)if(i.hasOwnProperty(h)&&(S=i[h],S!=null))switch(h){case"value":l=S;break;case"defaultValue":a=S;break;case"children":s=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(d(91));break;default:xn(e,t,h,S,i,null)}Ve(e,l,a,s);return;case"option":for(E in i)if(i.hasOwnProperty(E)&&(l=i[E],l!=null))switch(E){case"selected":e.selected=l&&typeof l!="function"&&typeof l!="symbol";break;default:xn(e,t,E,l,i,null)}return;case"dialog":_t("beforetoggle",e),_t("toggle",e),_t("cancel",e),_t("close",e);break;case"iframe":case"object":_t("load",e);break;case"video":case"audio":for(l=0;l<Rd.length;l++)_t(Rd[l],e);break;case"image":_t("error",e),_t("load",e);break;case"details":_t("toggle",e);break;case"embed":case"source":case"link":_t("error",e),_t("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ae in i)if(i.hasOwnProperty(ae)&&(l=i[ae],l!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":throw Error(d(137,t));default:xn(e,t,ae,l,i,null)}return;default:if(mt(t)){for(we in i)i.hasOwnProperty(we)&&(l=i[we],l!==void 0&&xf(e,t,we,l,i,void 0));return}}for(S in i)i.hasOwnProperty(S)&&(l=i[S],l!=null&&xn(e,t,S,l,i,null))}function ig(e,t,i,l){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var a=null,s=null,h=null,S=null,E=null,ae=null,we=null;for(ye in i){var ke=i[ye];if(i.hasOwnProperty(ye)&&ke!=null)switch(ye){case"checked":break;case"value":break;case"defaultValue":E=ke;default:l.hasOwnProperty(ye)||xn(e,t,ye,null,l,ke)}}for(var fe in l){var ye=l[fe];if(ke=i[fe],l.hasOwnProperty(fe)&&(ye!=null||ke!=null))switch(fe){case"type":s=ye;break;case"name":a=ye;break;case"checked":ae=ye;break;case"defaultChecked":we=ye;break;case"value":h=ye;break;case"defaultValue":S=ye;break;case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(d(137,t));break;default:ye!==ke&&xn(e,t,fe,ye,l,ke)}}Ia(e,h,S,E,ae,we,s,a);return;case"select":ye=h=S=fe=null;for(s in i)if(E=i[s],i.hasOwnProperty(s)&&E!=null)switch(s){case"value":break;case"multiple":ye=E;default:l.hasOwnProperty(s)||xn(e,t,s,null,l,E)}for(a in l)if(s=l[a],E=i[a],l.hasOwnProperty(a)&&(s!=null||E!=null))switch(a){case"value":fe=s;break;case"defaultValue":S=s;break;case"multiple":h=s;default:s!==E&&xn(e,t,a,s,l,E)}t=S,i=h,l=ye,fe!=null?lo(e,!!i,fe,!1):!!l!=!!i&&(t!=null?lo(e,!!i,t,!0):lo(e,!!i,i?[]:"",!1));return;case"textarea":ye=fe=null;for(S in i)if(a=i[S],i.hasOwnProperty(S)&&a!=null&&!l.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:xn(e,t,S,null,l,a)}for(h in l)if(a=l[h],s=i[h],l.hasOwnProperty(h)&&(a!=null||s!=null))switch(h){case"value":fe=a;break;case"defaultValue":ye=a;break;case"children":break;case"dangerouslySetInnerHTML":if(a!=null)throw Error(d(91));break;default:a!==s&&xn(e,t,h,a,l,s)}On(e,fe,ye);return;case"option":for(var Ge in i)if(fe=i[Ge],i.hasOwnProperty(Ge)&&fe!=null&&!l.hasOwnProperty(Ge))switch(Ge){case"selected":e.selected=!1;break;default:xn(e,t,Ge,null,l,fe)}for(E in l)if(fe=l[E],ye=i[E],l.hasOwnProperty(E)&&fe!==ye&&(fe!=null||ye!=null))switch(E){case"selected":e.selected=fe&&typeof fe!="function"&&typeof fe!="symbol";break;default:xn(e,t,E,fe,l,ye)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var bt in i)fe=i[bt],i.hasOwnProperty(bt)&&fe!=null&&!l.hasOwnProperty(bt)&&xn(e,t,bt,null,l,fe);for(ae in l)if(fe=l[ae],ye=i[ae],l.hasOwnProperty(ae)&&fe!==ye&&(fe!=null||ye!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(d(137,t));break;default:xn(e,t,ae,fe,l,ye)}return;default:if(mt(t)){for(var yn in i)fe=i[yn],i.hasOwnProperty(yn)&&fe!==void 0&&!l.hasOwnProperty(yn)&&xf(e,t,yn,void 0,l,fe);for(we in l)fe=l[we],ye=i[we],!l.hasOwnProperty(we)||fe===ye||fe===void 0&&ye===void 0||xf(e,t,we,fe,l,ye);return}}for(var ee in i)fe=i[ee],i.hasOwnProperty(ee)&&fe!=null&&!l.hasOwnProperty(ee)&&xn(e,t,ee,null,l,fe);for(ke in l)fe=l[ke],ye=i[ke],!l.hasOwnProperty(ke)||fe===ye||fe==null&&ye==null||xn(e,t,ke,fe,l,ye)}function Hp(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function lg(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,i=performance.getEntriesByType("resource"),l=0;l<i.length;l++){var a=i[l],s=a.transferSize,h=a.initiatorType,S=a.duration;if(s&&S&&Hp(h)){for(h=0,S=a.responseEnd,l+=1;l<i.length;l++){var E=i[l],ae=E.startTime;if(ae>S)break;var we=E.transferSize,ke=E.initiatorType;we&&Hp(ke)&&(E=E.responseEnd,h+=we*(E<S?1:(S-ae)/(E-ae)))}if(--l,t+=8*(s+h)/(a.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var yf=null,bf=null;function ku(e){return e.nodeType===9?e:e.ownerDocument}function Ep(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Ip(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function mf(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var vf=null;function og(){var e=window.event;return e&&e.type==="popstate"?e===vf?!1:(vf=e,!0):(vf=null,!1)}var Vp=typeof setTimeout=="function"?setTimeout:void 0,ag=typeof clearTimeout=="function"?clearTimeout:void 0,Wp=typeof Promise=="function"?Promise:void 0,sg=typeof queueMicrotask=="function"?queueMicrotask:typeof Wp<"u"?function(e){return Wp.resolve(null).then(e).catch(rg)}:Vp;function rg(e){setTimeout(function(){throw e})}function ur(e){return e==="head"}function Fp(e,t){var i=t,l=0;do{var a=i.nextSibling;if(e.removeChild(i),a&&a.nodeType===8)if(i=a.data,i==="/$"||i==="/&"){if(l===0){e.removeChild(a),Vc(t);return}l--}else if(i==="$"||i==="$?"||i==="$~"||i==="$!"||i==="&")l++;else if(i==="html")Ad(e.ownerDocument.documentElement);else if(i==="head"){i=e.ownerDocument.head,Ad(i);for(var s=i.firstChild;s;){var h=s.nextSibling,S=s.nodeName;s[To]||S==="SCRIPT"||S==="STYLE"||S==="LINK"&&s.rel.toLowerCase()==="stylesheet"||i.removeChild(s),s=h}}else i==="body"&&Ad(e.ownerDocument.body);i=a}while(i);Vc(t)}function $p(e,t){var i=e;e=0;do{var l=i.nextSibling;if(i.nodeType===1?t?(i._stashedDisplay=i.style.display,i.style.display="none"):(i.style.display=i._stashedDisplay||"",i.getAttribute("style")===""&&i.removeAttribute("style")):i.nodeType===3&&(t?(i._stashedText=i.nodeValue,i.nodeValue=""):i.nodeValue=i._stashedText||""),l&&l.nodeType===8)if(i=l.data,i==="/$"){if(e===0)break;e--}else i!=="$"&&i!=="$?"&&i!=="$~"&&i!=="$!"||e++;i=l}while(i)}function Sf(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var i=t;switch(t=t.nextSibling,i.nodeName){case"HTML":case"HEAD":case"BODY":Sf(i),Qo(i);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(i.rel.toLowerCase()==="stylesheet")continue}e.removeChild(i)}}function cg(e,t,i,l){for(;e.nodeType===1;){var a=i;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!l&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(l){if(!e[To])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(s=e.getAttribute("rel"),s==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(s!==a.rel||e.getAttribute("href")!==(a.href==null||a.href===""?null:a.href)||e.getAttribute("crossorigin")!==(a.crossOrigin==null?null:a.crossOrigin)||e.getAttribute("title")!==(a.title==null?null:a.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(s=e.getAttribute("src"),(s!==(a.src==null?null:a.src)||e.getAttribute("type")!==(a.type==null?null:a.type)||e.getAttribute("crossorigin")!==(a.crossOrigin==null?null:a.crossOrigin))&&s&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var s=a.name==null?null:""+a.name;if(a.type==="hidden"&&e.getAttribute("name")===s)return e}else return e;if(e=mo(e.nextSibling),e===null)break}return null}function dg(e,t,i){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!i||(e=mo(e.nextSibling),e===null))return null;return e}function Lp(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=mo(e.nextSibling),e===null))return null;return e}function wf(e){return e.data==="$?"||e.data==="$~"}function jf(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function ug(e,t){var i=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||i.readyState!=="loading")t();else{var l=function(){t(),i.removeEventListener("DOMContentLoaded",l)};i.addEventListener("DOMContentLoaded",l),e._reactRetry=l}}function mo(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var Tf=null;function Yp(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"||i==="/&"){if(t===0)return mo(e.nextSibling);t--}else i!=="$"&&i!=="$!"&&i!=="$?"&&i!=="$~"&&i!=="&"||t++}e=e.nextSibling}return null}function Xp(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"){if(t===0)return e;t--}else i!=="/$"&&i!=="/&"||t++}e=e.previousSibling}return null}function Gp(e,t,i){switch(t=ku(i),e){case"html":if(e=t.documentElement,!e)throw Error(d(452));return e;case"head":if(e=t.head,!e)throw Error(d(453));return e;case"body":if(e=t.body,!e)throw Error(d(454));return e;default:throw Error(d(451))}}function Ad(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Qo(e)}var vo=new Map,qp=new Set;function Ru(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var ys=I.d;I.d={f:fg,r:pg,D:hg,C:gg,L:xg,m:yg,X:mg,S:bg,M:vg};function fg(){var e=ys.f(),t=mu();return e||t}function pg(e){var t=rl(e);t!==null&&t.tag===5&&t.type==="form"?xd(t):ys.r(e)}var Hc=typeof document>"u"?null:document;function Zp(e,t,i){var l=Hc;if(l&&typeof t=="string"&&t){var a=yi(t);a='link[rel="'+e+'"][href="'+a+'"]',typeof i=="string"&&(a+='[crossorigin="'+i+'"]'),qp.has(a)||(qp.add(a),e={rel:e,crossOrigin:i,href:t},l.querySelector(a)===null&&(t=l.createElement("link"),Bi(t,"link",e),Bt(t),l.head.appendChild(t)))}}function hg(e){ys.D(e),Zp("dns-prefetch",e,null)}function gg(e,t){ys.C(e,t),Zp("preconnect",e,t)}function xg(e,t,i){ys.L(e,t,i);var l=Hc;if(l&&e&&t){var a='link[rel="preload"][as="'+yi(t)+'"]';t==="image"&&i&&i.imageSrcSet?(a+='[imagesrcset="'+yi(i.imageSrcSet)+'"]',typeof i.imageSizes=="string"&&(a+='[imagesizes="'+yi(i.imageSizes)+'"]')):a+='[href="'+yi(e)+'"]';var s=a;switch(t){case"style":s=Ec(e);break;case"script":s=Ic(e)}vo.has(s)||(e=ge({rel:"preload",href:t==="image"&&i&&i.imageSrcSet?void 0:e,as:t},i),vo.set(s,e),l.querySelector(a)!==null||t==="style"&&l.querySelector(Nd(s))||t==="script"&&l.querySelector(Md(s))||(t=l.createElement("link"),Bi(t,"link",e),Bt(t),l.head.appendChild(t)))}}function yg(e,t){ys.m(e,t);var i=Hc;if(i&&e){var l=t&&typeof t.as=="string"?t.as:"script",a='link[rel="modulepreload"][as="'+yi(l)+'"][href="'+yi(e)+'"]',s=a;switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":s=Ic(e)}if(!vo.has(s)&&(e=ge({rel:"modulepreload",href:e},t),vo.set(s,e),i.querySelector(a)===null)){switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(i.querySelector(Md(s)))return}l=i.createElement("link"),Bi(l,"link",e),Bt(l),i.head.appendChild(l)}}}function bg(e,t,i){ys.S(e,t,i);var l=Hc;if(l&&e){var a=Jo(l).hoistableStyles,s=Ec(e);t=t||"default";var h=a.get(s);if(!h){var S={loading:0,preload:null};if(h=l.querySelector(Nd(s)))S.loading=5;else{e=ge({rel:"stylesheet",href:e,"data-precedence":t},i),(i=vo.get(s))&&Cf(e,i);var E=h=l.createElement("link");Bt(E),Bi(E,"link",e),E._p=new Promise(function(ae,we){E.onload=ae,E.onerror=we}),E.addEventListener("load",function(){S.loading|=1}),E.addEventListener("error",function(){S.loading|=2}),S.loading|=4,Du(h,t,l)}h={type:"stylesheet",instance:h,count:1,state:S},a.set(s,h)}}}function mg(e,t){ys.X(e,t);var i=Hc;if(i&&e){var l=Jo(i).hoistableScripts,a=Ic(e),s=l.get(a);s||(s=i.querySelector(Md(a)),s||(e=ge({src:e,async:!0},t),(t=vo.get(a))&&zf(e,t),s=i.createElement("script"),Bt(s),Bi(s,"link",e),i.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},l.set(a,s))}}function vg(e,t){ys.M(e,t);var i=Hc;if(i&&e){var l=Jo(i).hoistableScripts,a=Ic(e),s=l.get(a);s||(s=i.querySelector(Md(a)),s||(e=ge({src:e,async:!0,type:"module"},t),(t=vo.get(a))&&zf(e,t),s=i.createElement("script"),Bt(s),Bi(s,"link",e),i.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},l.set(a,s))}}function Kp(e,t,i,l){var a=(a=ot.current)?Ru(a):null;if(!a)throw Error(d(446));switch(e){case"meta":case"title":return null;case"style":return typeof i.precedence=="string"&&typeof i.href=="string"?(t=Ec(i.href),i=Jo(a).hoistableStyles,l=i.get(t),l||(l={type:"style",instance:null,count:0,state:null},i.set(t,l)),l):{type:"void",instance:null,count:0,state:null};case"link":if(i.rel==="stylesheet"&&typeof i.href=="string"&&typeof i.precedence=="string"){e=Ec(i.href);var s=Jo(a).hoistableStyles,h=s.get(e);if(h||(a=a.ownerDocument||a,h={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},s.set(e,h),(s=a.querySelector(Nd(e)))&&!s._p&&(h.instance=s,h.state.loading=5),vo.has(e)||(i={rel:"preload",as:"style",href:i.href,crossOrigin:i.crossOrigin,integrity:i.integrity,media:i.media,hrefLang:i.hrefLang,referrerPolicy:i.referrerPolicy},vo.set(e,i),s||Sg(a,e,i,h.state))),t&&l===null)throw Error(d(528,""));return h}if(t&&l!==null)throw Error(d(529,""));return null;case"script":return t=i.async,i=i.src,typeof i=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Ic(i),i=Jo(a).hoistableScripts,l=i.get(t),l||(l={type:"script",instance:null,count:0,state:null},i.set(t,l)),l):{type:"void",instance:null,count:0,state:null};default:throw Error(d(444,e))}}function Ec(e){return'href="'+yi(e)+'"'}function Nd(e){return'link[rel="stylesheet"]['+e+"]"}function Qp(e){return ge({},e,{"data-precedence":e.precedence,precedence:null})}function Sg(e,t,i,l){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?l.loading=1:(t=e.createElement("link"),l.preload=t,t.addEventListener("load",function(){return l.loading|=1}),t.addEventListener("error",function(){return l.loading|=2}),Bi(t,"link",i),Bt(t),e.head.appendChild(t))}function Ic(e){return'[src="'+yi(e)+'"]'}function Md(e){return"script[async]"+e}function Jp(e,t,i){if(t.count++,t.instance===null)switch(t.type){case"style":var l=e.querySelector('style[data-href~="'+yi(i.href)+'"]');if(l)return t.instance=l,Bt(l),l;var a=ge({},i,{"data-href":i.href,"data-precedence":i.precedence,href:null,precedence:null});return l=(e.ownerDocument||e).createElement("style"),Bt(l),Bi(l,"style",a),Du(l,i.precedence,e),t.instance=l;case"stylesheet":a=Ec(i.href);var s=e.querySelector(Nd(a));if(s)return t.state.loading|=4,t.instance=s,Bt(s),s;l=Qp(i),(a=vo.get(a))&&Cf(l,a),s=(e.ownerDocument||e).createElement("link"),Bt(s);var h=s;return h._p=new Promise(function(S,E){h.onload=S,h.onerror=E}),Bi(s,"link",l),t.state.loading|=4,Du(s,i.precedence,e),t.instance=s;case"script":return s=Ic(i.src),(a=e.querySelector(Md(s)))?(t.instance=a,Bt(a),a):(l=i,(a=vo.get(s))&&(l=ge({},i),zf(l,a)),e=e.ownerDocument||e,a=e.createElement("script"),Bt(a),Bi(a,"link",l),e.head.appendChild(a),t.instance=a);case"void":return null;default:throw Error(d(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(l=t.instance,t.state.loading|=4,Du(l,i.precedence,e));return t.instance}function Du(e,t,i){for(var l=i.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),a=l.length?l[l.length-1]:null,s=a,h=0;h<l.length;h++){var S=l[h];if(S.dataset.precedence===t)s=S;else if(s!==a)break}s?s.parentNode.insertBefore(e,s.nextSibling):(t=i.nodeType===9?i.head:i,t.insertBefore(e,t.firstChild))}function Cf(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function zf(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var Au=null;function eh(e,t,i){if(Au===null){var l=new Map,a=Au=new Map;a.set(i,l)}else a=Au,l=a.get(i),l||(l=new Map,a.set(i,l));if(l.has(e))return l;for(l.set(e,null),i=i.getElementsByTagName(e),a=0;a<i.length;a++){var s=i[a];if(!(s[To]||s[pt]||e==="link"&&s.getAttribute("rel")==="stylesheet")&&s.namespaceURI!=="http://www.w3.org/2000/svg"){var h=s.getAttribute(t)||"";h=e+h;var S=l.get(h);S?S.push(s):l.set(h,[s])}}return l}function th(e,t,i){e=e.ownerDocument||e,e.head.insertBefore(i,t==="title"?e.querySelector("head > title"):null)}function wg(e,t,i){if(i===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function nh(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function jg(e,t,i,l){if(i.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var a=Ec(l.href),s=t.querySelector(Nd(a));if(s){t=s._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=Nu.bind(e),t.then(e,e)),i.state.loading|=4,i.instance=s,Bt(s);return}s=t.ownerDocument||t,l=Qp(l),(a=vo.get(a))&&Cf(l,a),s=s.createElement("link"),Bt(s);var h=s;h._p=new Promise(function(S,E){h.onload=S,h.onerror=E}),Bi(s,"link",l),i.instance=s}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(i,t),(t=i.state.preload)&&(i.state.loading&3)===0&&(e.count++,i=Nu.bind(e),t.addEventListener("load",i),t.addEventListener("error",i))}}var kf=0;function Tg(e,t){return e.stylesheets&&e.count===0&&Bu(e,e.stylesheets),0<e.count||0<e.imgCount?function(i){var l=setTimeout(function(){if(e.stylesheets&&Bu(e,e.stylesheets),e.unsuspend){var s=e.unsuspend;e.unsuspend=null,s()}},6e4+t);0<e.imgBytes&&kf===0&&(kf=62500*lg());var a=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Bu(e,e.stylesheets),e.unsuspend)){var s=e.unsuspend;e.unsuspend=null,s()}},(e.imgBytes>kf?50:800)+t);return e.unsuspend=i,function(){e.unsuspend=null,clearTimeout(l),clearTimeout(a)}}:null}function Nu(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Bu(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Mu=null;function Bu(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Mu=new Map,t.forEach(Cg,e),Mu=null,Nu.call(e))}function Cg(e,t){if(!(t.state.loading&4)){var i=Mu.get(e);if(i)var l=i.get(null);else{i=new Map,Mu.set(e,i);for(var a=e.querySelectorAll("link[data-precedence],style[data-precedence]"),s=0;s<a.length;s++){var h=a[s];(h.nodeName==="LINK"||h.getAttribute("media")!=="not all")&&(i.set(h.dataset.precedence,h),l=h)}l&&i.set(null,l)}a=t.instance,h=a.getAttribute("data-precedence"),s=i.get(h)||l,s===l&&i.set(null,a),i.set(h,a),this.count++,l=Nu.bind(this),a.addEventListener("load",l),a.addEventListener("error",l),s?s.parentNode.insertBefore(a,s.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(a,e.firstChild)),t.state.loading|=4}}var Bd={$$typeof:L,Provider:null,Consumer:null,_currentValue:pe,_currentValue2:pe,_threadCount:0};function zg(e,t,i,l,a,s,h,S,E){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=al(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=al(0),this.hiddenUpdates=al(null),this.identifierPrefix=l,this.onUncaughtError=a,this.onCaughtError=s,this.onRecoverableError=h,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=E,this.incompleteTransitions=new Map}function ih(e,t,i,l,a,s,h,S,E,ae,we,ke){return e=new zg(e,t,i,h,E,ae,we,ke,S),t=1,s===!0&&(t|=24),s=Qi(3,null,null,t),e.current=s,s.stateNode=e,t=ns(),t.refCount++,e.pooledCache=t,t.refCount++,s.memoizedState={element:l,isDehydrated:i,cache:t},_r(s),e}function lh(e){return e?(e=Qa,e):Qa}function oh(e,t,i,l,a,s){a=lh(a),l.context===null?l.context=a:l.pendingContext=a,l=uo(t),l.payload={element:i},s=s===void 0?null:s,s!==null&&(l.callback=s),i=za(e,l,t),i!==null&&(Cl(i,e,t),ls(i,e,t))}function ah(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<t?i:t}}function Rf(e,t){ah(e,t),(e=e.alternate)&&ah(e,t)}function sh(e){if(e.tag===13||e.tag===31){var t=pl(e,67108864);t!==null&&Cl(t,e,67108864),Rf(e,67108864)}}function rh(e){if(e.tag===13||e.tag===31){var t=Zl();t=Vn(t);var i=pl(e,t);i!==null&&Cl(i,e,t),Rf(e,t)}}var Uu=!0;function kg(e,t,i,l){var a=H.T;H.T=null;var s=I.p;try{I.p=2,Df(e,t,i,l)}finally{I.p=s,H.T=a}}function Rg(e,t,i,l){var a=H.T;H.T=null;var s=I.p;try{I.p=8,Df(e,t,i,l)}finally{I.p=s,H.T=a}}function Df(e,t,i,l){if(Uu){var a=Af(l);if(a===null)gf(e,t,l,Pu,i),dh(e,l);else if(Ag(a,e,t,i,l))l.stopPropagation();else if(dh(e,l),t&4&&-1<Dg.indexOf(e)){for(;a!==null;){var s=rl(a);if(s!==null)switch(s.tag){case 3:if(s=s.stateNode,s.current.memoizedState.isDehydrated){var h=Ti(s.pendingLanes);if(h!==0){var S=s;for(S.pendingLanes|=2,S.entangledLanes|=2;h;){var E=1<<31-tt(h);S.entanglements[1]|=E,h&=~E}Oa(s),(en&6)===0&&(yu=ft()+500,kd(0))}}break;case 31:case 13:S=pl(s,2),S!==null&&Cl(S,s,2),mu(),Rf(s,2)}if(s=Af(l),s===null&&gf(e,t,l,Pu,i),s===a)break;a=s}a!==null&&l.stopPropagation()}else gf(e,t,l,null,i)}}function Af(e){return e=Xc(e),Nf(e)}var Pu=null;function Nf(e){if(Pu=null,e=Dl(e),e!==null){var t=F(e);if(t===null)e=null;else{var i=t.tag;if(i===13){if(e=xe(t),e!==null)return e;e=null}else if(i===31){if(e=X(t),e!==null)return e;e=null}else if(i===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Pu=e,null}function ch(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Lc()){case _e:return 2;case Pt:return 8;case Kl:case jo:return 32;case Xt:return 268435456;default:return 32}default:return 32}}var Mf=!1,fr=null,pr=null,hr=null,Ud=new Map,Pd=new Map,gr=[],Dg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function dh(e,t){switch(e){case"focusin":case"focusout":fr=null;break;case"dragenter":case"dragleave":pr=null;break;case"mouseover":case"mouseout":hr=null;break;case"pointerover":case"pointerout":Ud.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pd.delete(t.pointerId)}}function Od(e,t,i,l,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:i,eventSystemFlags:l,nativeEvent:s,targetContainers:[a]},t!==null&&(t=rl(t),t!==null&&sh(t)),e):(e.eventSystemFlags|=l,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function Ag(e,t,i,l,a){switch(t){case"focusin":return fr=Od(fr,e,t,i,l,a),!0;case"dragenter":return pr=Od(pr,e,t,i,l,a),!0;case"mouseover":return hr=Od(hr,e,t,i,l,a),!0;case"pointerover":var s=a.pointerId;return Ud.set(s,Od(Ud.get(s)||null,e,t,i,l,a)),!0;case"gotpointercapture":return s=a.pointerId,Pd.set(s,Od(Pd.get(s)||null,e,t,i,l,a)),!0}return!1}function uh(e){var t=Dl(e.target);if(t!==null){var i=F(t);if(i!==null){if(t=i.tag,t===13){if(t=xe(i),t!==null){e.blockedOn=t,vr(e.priority,function(){rh(i)});return}}else if(t===31){if(t=X(i),t!==null){e.blockedOn=t,vr(e.priority,function(){rh(i)});return}}else if(t===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ou(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var i=Af(e.nativeEvent);if(i===null){i=e.nativeEvent;var l=new i.constructor(i.type,i);ht=l,i.target.dispatchEvent(l),ht=null}else return t=rl(i),t!==null&&sh(t),e.blockedOn=i,!1;t.shift()}return!0}function fh(e,t,i){Ou(e)&&i.delete(t)}function Ng(){Mf=!1,fr!==null&&Ou(fr)&&(fr=null),pr!==null&&Ou(pr)&&(pr=null),hr!==null&&Ou(hr)&&(hr=null),Ud.forEach(fh),Pd.forEach(fh)}function _u(e,t){e.blockedOn===t&&(e.blockedOn=null,Mf||(Mf=!0,c.unstable_scheduleCallback(c.unstable_NormalPriority,Ng)))}var Hu=null;function ph(e){Hu!==e&&(Hu=e,c.unstable_scheduleCallback(c.unstable_NormalPriority,function(){Hu===e&&(Hu=null);for(var t=0;t<e.length;t+=3){var i=e[t],l=e[t+1],a=e[t+2];if(typeof l!="function"){if(Nf(l||i)===null)continue;break}var s=rl(i);s!==null&&(e.splice(t,3),t-=3,wc(s,{pending:!0,data:a,method:i.method,action:l},l,a))}}))}function Vc(e){function t(E){return _u(E,e)}fr!==null&&_u(fr,e),pr!==null&&_u(pr,e),hr!==null&&_u(hr,e),Ud.forEach(t),Pd.forEach(t);for(var i=0;i<gr.length;i++){var l=gr[i];l.blockedOn===e&&(l.blockedOn=null)}for(;0<gr.length&&(i=gr[0],i.blockedOn===null);)uh(i),i.blockedOn===null&&gr.shift();if(i=(e.ownerDocument||e).$$reactFormReplay,i!=null)for(l=0;l<i.length;l+=3){var a=i[l],s=i[l+1],h=a[Pn]||null;if(typeof s=="function")h||ph(i);else if(h){var S=null;if(s&&s.hasAttribute("formAction")){if(a=s,h=s[Pn]||null)S=h.formAction;else if(Nf(a)!==null)continue}else S=h.action;typeof S=="function"?i[l+1]=S:(i.splice(l,3),l-=3),ph(i)}}}function hh(){function e(s){s.canIntercept&&s.info==="react-transition"&&s.intercept({handler:function(){return new Promise(function(h){return a=h})},focusReset:"manual",scroll:"manual"})}function t(){a!==null&&(a(),a=null),l||setTimeout(i,20)}function i(){if(!l&&!navigation.transition){var s=navigation.currentEntry;s&&s.url!=null&&navigation.navigate(s.url,{state:s.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var l=!1,a=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(i,100),function(){l=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),a!==null&&(a(),a=null)}}}function Bf(e){this._internalRoot=e}Eu.prototype.render=Bf.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(d(409));var i=t.current,l=Zl();oh(i,l,e,t,null,null)},Eu.prototype.unmount=Bf.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;oh(e.current,2,null,e,null,null),mu(),t[Ft]=null}};function Eu(e){this._internalRoot=e}Eu.prototype.unstable_scheduleHydration=function(e){if(e){var t=mr();e={blockedOn:null,target:e,priority:t};for(var i=0;i<gr.length&&t!==0&&t<gr[i].priority;i++);gr.splice(i,0,e),i===0&&uh(e)}};var gh=u.version;if(gh!=="19.2.0")throw Error(d(527,gh,"19.2.0"));I.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(d(188)):(e=Object.keys(e).join(","),Error(d(268,e)));return e=V(t),e=e!==null?de(e):null,e=e===null?null:e.stateNode,e};var Mg={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:H,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Iu.isDisabled&&Iu.supportsFiber)try{Pi=Iu.inject(Mg),De=Iu}catch{}}return Hd.createRoot=function(e,t){if(!R(e))throw Error(d(299));var i=!1,l="",a=du,s=uu,h=bd;return t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(l=t.identifierPrefix),t.onUncaughtError!==void 0&&(a=t.onUncaughtError),t.onCaughtError!==void 0&&(s=t.onCaughtError),t.onRecoverableError!==void 0&&(h=t.onRecoverableError)),t=ih(e,1,!1,null,null,i,l,null,a,s,h,hh),e[Ft]=t.current,hf(e),new Bf(t)},Hd.hydrateRoot=function(e,t,i){if(!R(e))throw Error(d(299));var l=!1,a="",s=du,h=uu,S=bd,E=null;return i!=null&&(i.unstable_strictMode===!0&&(l=!0),i.identifierPrefix!==void 0&&(a=i.identifierPrefix),i.onUncaughtError!==void 0&&(s=i.onUncaughtError),i.onCaughtError!==void 0&&(h=i.onCaughtError),i.onRecoverableError!==void 0&&(S=i.onRecoverableError),i.formState!==void 0&&(E=i.formState)),t=ih(e,1,!0,t,i??null,l,a,E,s,h,S,hh),t.context=lh(null),i=t.current,l=Zl(),l=Vn(l),a=uo(l),a.callback=null,za(i,a,l),i=l,t.current.lanes=i,to(t,i),Oa(t),e[Ft]=t.current,hf(e),new Eu(t)},Hd.version="19.2.0",Hd}var Ch;function Fg(){if(Ch)return Of.exports;Ch=1;function c(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(c)}catch(u){console.error(u)}}return c(),Of.exports=Wg(),Of.exports}var $g=Fg();/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lg=c=>c.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Yg=c=>c.replace(/^([A-Z])|[\s-_]+(\w)/g,(u,g,d)=>d?d.toUpperCase():g.toLowerCase()),zh=c=>{const u=Yg(c);return u.charAt(0).toUpperCase()+u.slice(1)},Bh=(...c)=>c.filter((u,g,d)=>!!u&&u.trim()!==""&&d.indexOf(u)===g).join(" ").trim(),Xg=c=>{for(const u in c)if(u.startsWith("aria-")||u==="role"||u==="title")return!0};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Gg={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qg=m.forwardRef(({color:c="currentColor",size:u=24,strokeWidth:g=2,absoluteStrokeWidth:d,className:R="",children:F,iconNode:xe,...X},p)=>m.createElement("svg",{ref:p,...Gg,width:u,height:u,stroke:c,strokeWidth:d?Number(g)*24/Number(u):g,className:Bh("lucide",R),...!F&&!Xg(X)&&{"aria-hidden":"true"},...X},[...xe.map(([V,de])=>m.createElement(V,de)),...Array.isArray(F)?F:[F]]));/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uh=(c,u)=>{const g=m.forwardRef(({className:d,...R},F)=>m.createElement(qg,{ref:F,iconNode:u,className:Bh(`lucide-${Lg(zh(c))}`,`lucide-${c}`,d),...R}));return g.displayName=zh(c),g};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zg=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],Kg=Uh("mouse-pointer",Zg);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qg=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Jg=Uh("pen-line",Qg),If="#2CA02C",ex="#F0E442",tx="#00BFC4",Vf="#000000",nx="#00008b",Wf="#FF0000",Ph={DEFAULT_SIZE:18},Wd={Battery:{prefix:["B","BT"],defaultPins:2},Capacitor:{prefix:["C"],defaultPins:2},"Electrolytic Capacitor":{prefix:["C","CE"],defaultPins:2},"Film Capacitor":{prefix:["C","CF"],defaultPins:2},Diode:{prefix:["D","CR"],defaultPins:2},Fuse:{prefix:["F"],defaultPins:2},FerriteBead:{prefix:["FB"],defaultPins:2},Connector:{prefix:["J","P"],defaultPins:4},Jumper:{prefix:["JP"],defaultPins:3},Relay:{prefix:["K"],defaultPins:5},Inductor:{prefix:["L"],defaultPins:2},Speaker:{prefix:["LS"],defaultPins:2},Motor:{prefix:["M"],defaultPins:2},PowerSupply:{prefix:["PS"],defaultPins:4},Transistor:{prefix:["Q"],defaultPins:3},Resistor:{prefix:["R"],defaultPins:2},ResistorNetwork:{prefix:["RN"],defaultPins:8},Thermistor:{prefix:["RT"],defaultPins:2},Switch:{prefix:["S","SW"],defaultPins:2},Transformer:{prefix:["T"],defaultPins:4},TestPoint:{prefix:["TP"],defaultPins:1},IntegratedCircuit:{prefix:["U","IC"],defaultPins:8},VacuumTube:{prefix:["V"],defaultPins:5},VariableResistor:{prefix:["VR"],defaultPins:3},Crystal:{prefix:["X","XTAL","Y"],defaultPins:2},ZenerDiode:{prefix:["Z"],defaultPins:2}},ix={Capacitors:{General:["Capacitor"],Electrolytic:["Electrolytic Capacitor"],Film:["Film Capacitor"],Tantalum:["Capacitor"]},Diodes:{Standard:["Diode"],Zener:["ZenerDiode"],LED:["Diode"],Schottky:["Diode"]},Resistors:{Standard:["Resistor"],Network:["ResistorNetwork"],Thermistor:["Thermistor"],Variable:["VariableResistor"]},Semiconductors:{Transistor:["Transistor"],"Integrated Circuit":["IntegratedCircuit"]},"Passive Components":{Inductor:["Inductor"],"Ferrite Bead":["FerriteBead"],Crystal:["Crystal"]},"Power & Energy":{Battery:["Battery"],"Power Supply":["PowerSupply"],Fuse:["Fuse"]},"Connectors & Switches":{Connector:["Connector"],Jumper:["Jumper"],Switch:["Switch"],Relay:["Relay"]},Other:{Transformer:["Transformer"],Speaker:["Speaker"],Motor:["Motor"],"Test Point":["TestPoint"],"Vacuum Tube":["VacuumTube"]}},Ff={DEFAULT_SIZE:18},Oh={resistance:{validUnits:["","m","k","M"],defaultUnit:""},capacitance:{validUnits:["pF","nF","F","mF","F"],defaultUnit:"F"},voltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},current:{validUnits:["A","mA","A"],defaultUnit:"A"},power:{validUnits:["W","mW","kW"],defaultUnit:"W"},inductance:{validUnits:["nH","H","mH","H"],defaultUnit:"H"},impedance:{validUnits:["","m","k"],defaultUnit:""},capacity:{validUnits:["mAh","Ah"],defaultUnit:"mAh"},inputVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},outputVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},coilVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},primaryVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},secondaryVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},esr:{validUnits:["m",""],defaultUnit:""}};function Lt(c){return Oh[c]?.validUnits||[]}function Le(c){return Oh[c]?.defaultUnit||""}function Vd(c){return c.includes(" ")?c:c.replace(/([a-z])([A-Z])/g,"$1 $2")}let ol=1;const wo=new Set;function qo(){const c=ol;if(ol++,wo.has(c)){for(console.error(`CRITICAL ERROR: Duplicate Node ID ${c} would be allocated!`),console.error(`Current counter: ${ol}, Allocated IDs count: ${wo.size}`);wo.has(ol);)ol++;const u=ol;return ol++,wo.add(u),console.error(`Recovered by allocating ID ${u} instead`),u}return wo.add(c),c}function $f(c){c<1&&(console.warn(`setPointIdCounter called with invalid value ${c}, using 1`),c=1),ol=c,wo.clear()}function kh(){return ol}function Rh(){ol=1,wo.clear()}function Lf(c){c>0&&(wo.add(c),c>=ol&&(ol=c+1))}function Vu(c){if(c>0&&wo.has(c))if(wo.delete(c),wo.size>0){const u=Math.max(...Array.from(wo));u<ol&&(ol=Math.max(1,u+1))}else ol=1}function lx(c="id"){return`${c}-${Date.now()}-${Math.random().toString(36).slice(2,11)}`}function Dh(c){return Math.round(c*1e4)/1e4}function Yt(c){return{x:Dh(c.x),y:Dh(c.y)}}function ox(c){return Wd[c]?.defaultPins||2}function Xf(c){return(Wd[c]?.prefix||["?"])[0]}function ax(c,u,g,d,R,F=Ph.DEFAULT_SIZE,xe=[],X=Id(),p=!0){let V="";if(p){const Te=Xf(c),Ue=rx(Te,xe,X);V=`${Te}${Ue}`}const de={id:lx("comp"),componentType:c,designator:V,layer:u,x:g,y:d,color:R,size:F,pinCount:ox(c),pinConnections:[],orientation:0};switch(de.pinConnections=new Array(de.pinCount).fill(""),(c==="Electrolytic Capacitor"||c==="Diode"||c==="Battery"||c==="ZenerDiode")&&(de.pinPolarities=new Array(de.pinCount).fill("")),c){case"Battery":return{...de,componentType:"Battery"};case"Capacitor":return{...de,componentType:"Capacitor"};case"Electrolytic Capacitor":return{...de,componentType:"Electrolytic Capacitor",polarity:"Positive"};case"Film Capacitor":return{...de,componentType:"Film Capacitor",filmType:"Polyester"};case"Diode":return{...de,componentType:"Diode",diodeType:"Standard"};case"Fuse":return{...de,componentType:"Fuse"};case"FerriteBead":return{...de,componentType:"FerriteBead"};case"Connector":return{...de,componentType:"Connector",gender:"N/A"};case"Jumper":return{...de,componentType:"Jumper"};case"Relay":return{...de,componentType:"Relay"};case"Inductor":return{...de,componentType:"Inductor"};case"Speaker":return{...de,componentType:"Speaker"};case"Motor":return{...de,componentType:"Motor"};case"PowerSupply":return{...de,componentType:"PowerSupply"};case"Transistor":return{...de,componentType:"Transistor",transistorType:"BJT"};case"Resistor":return{...de,componentType:"Resistor"};case"ResistorNetwork":return{...de,componentType:"ResistorNetwork"};case"Thermistor":return{...de,componentType:"Thermistor",thermistorType:"NTC"};case"Switch":return{...de,componentType:"Switch"};case"Transformer":return{...de,componentType:"Transformer"};case"TestPoint":return{...de,componentType:"TestPoint"};case"IntegratedCircuit":return{...de,componentType:"IntegratedCircuit"};case"VacuumTube":return{...de,componentType:"VacuumTube"};case"VariableResistor":return{...de,componentType:"VariableResistor",vrType:"Potentiometer"};case"Crystal":return{...de,componentType:"Crystal"};case"ZenerDiode":return{...de,componentType:"ZenerDiode"};default:return{...de,componentType:"Resistor"}}}function Gf(c,u,g){const d=c.componentType==="Electrolytic Capacitor"||c.componentType==="Diode"||c.componentType==="Battery"||c.componentType==="ZenerDiode",R=c.componentType==="Capacitor"&&"dielectric"in c&&c.dielectric==="Tantalum";if(!(d||R)||c.pinCount!==2||!(u.length===2&&u[0]&&u[0].trim()!==""&&u[1]&&u[1].trim()!==""))return null;const xe=Te=>{const Ue=parseInt(Te,10);if(isNaN(Ue))return null;for(const se of g)if((se.type==="via"||se.type==="pad")&&se.points.length>0){const Re=se.points[0];if(Re.id===Ue)return{x:Re.x,y:Re.y}}return null},X=xe(u[0]),p=xe(u[1]);if(!X||!p)return null;const V=Math.hypot(c.x-X.x,c.y-X.y),de=Math.hypot(c.x-p.x,c.y-p.y),ge=["",""];return V<de?(ge[0]="-",ge[1]="+"):(ge[0]="+",ge[1]="-"),ge}function Id(){return{}}function sx(c){}function rx(c,u,g){let d=0;for(const F of u)if(F.designator){const xe=F.designator.match(new RegExp(`^${c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(\\d+)$`));if(xe){const X=parseInt(xe[1],10);X>d&&(d=X)}}const R=g[c]||0;return Math.max(d,R)+1}function cx(c,u,g){const d={...g};return d[c]=Math.max(d[c]||0,u),d}function dx(){const c=document.createElement("canvas"),u=24;c.width=u,c.height=u;const g=c.getContext("2d");g.strokeStyle="#000",g.lineWidth=3,g.lineCap="round";const d=u/2,R=8;return g.beginPath(),g.moveTo(d,d-R),g.lineTo(d,d-2),g.moveTo(d,d+2),g.lineTo(d,d+R),g.moveTo(d-R,d),g.lineTo(d-2,d),g.moveTo(d+2,d),g.lineTo(d+R,d),g.stroke(),`url(${c.toDataURL()}) ${d} ${d}, crosshair`}function ux(c){const u=document.createElement("canvas"),g=Math.max(12,Math.min(c,32)),R=g+4*2;u.width=R,u.height=R;const F=u.getContext("2d"),xe=R/2,X=R/2,p=g/2;return F.fillStyle="#FFFF00",F.strokeStyle="#000000",F.lineWidth=2,F.beginPath(),F.moveTo(xe,X-p),F.lineTo(xe+p,X),F.lineTo(xe,X+p),F.lineTo(xe-p,X),F.closePath(),F.fill(),F.stroke(),`url(${u.toDataURL()}) ${xe} ${X}, crosshair`}function fx(){const c=new Date,u=c.getFullYear(),g=String(c.getMonth()+1).padStart(2,"0"),d=String(c.getDate()).padStart(2,"0"),R=String(c.getHours()).padStart(2,"0"),F=String(c.getMinutes()).padStart(2,"0"),xe=String(c.getSeconds()).padStart(2,"0");return`${u}_${g}_${d}-${R}-${F}-${xe}`}function Wc(c){let u=c.replace(/\.json$/i,""),g="";for(;g!==u;)g=u,u=u.replace(/_\d{4}_\d{2}_\d{2}-\d{2}-\d{2}-\d{2}$/,""),u=u.replace(/_\d{4}_\d{2}_\d{2}_\d{2}_\d{2}_\d{2}$/,"");return u}const Yf=c=>{const u=Wd[c];return!u||!u.prefix||u.prefix.length<1?"?":u.prefix[0].substring(0,1).toUpperCase()},So=(c,u,g)=>({color:u,size:g}),Ah=(c,u,g)=>{},Bn=(c,u,g,d)=>({color:g,size:d}),Fc=(c,u,g,d)=>{},px=()=>{const c=new Map,u={top:"#0072B2",bottom:"#56B4E9"},g={top:18,bottom:18},d={top:"#FFFF00",bottom:"#FFFF00"},R={top:18,bottom:18},F={top:"#AA4499",bottom:"#F781BF"},xe={top:6,bottom:6},X={top:"#6A3D9A",bottom:"#9467BD"},p={top:18,bottom:18};return c.set("select",{id:"select",name:"Select",toolType:"select",icon:"",shortcut:"S",tooltip:"Select objects or groups",colorReflective:!1,settings:So("select","#ff0000",10),layerSettings:new Map([["top",Bn("select","top","#ff0000",10)],["bottom",Bn("select","bottom","#ff0000",10)]])}),c.set("via",{id:"via",name:"Via",toolType:"draw",drawingMode:"via",icon:"",shortcut:"V",tooltip:"Place via connection",colorReflective:!0,settings:So("via",If,Ff.DEFAULT_SIZE),layerSettings:new Map([["top",Bn("via","top",If,Ff.DEFAULT_SIZE)],["bottom",Bn("via","bottom",If,Ff.DEFAULT_SIZE)]]),defaultLayer:"top"}),c.set("pad",{id:"pad",name:"Pad",toolType:"draw",drawingMode:"pad",icon:"",shortcut:"P",tooltip:"Place pad connection",colorReflective:!0,settings:So("pad",nx,18),layerSettings:new Map([["top",Bn("pad","top",u.top,g.top)],["bottom",Bn("pad","bottom",u.bottom,g.bottom)]]),defaultLayer:"top"}),c.set("testPoint",{id:"testPoint",name:"Test Point",toolType:"draw",drawingMode:"testPoint",icon:"",shortcut:"Y",tooltip:"Place test point",colorReflective:!0,settings:So("testPoint","#FFFF00",18),layerSettings:new Map([["top",Bn("testPoint","top",d.top,R.top)],["bottom",Bn("testPoint","bottom",d.bottom,R.bottom)]]),defaultLayer:"top"}),c.set("trace",{id:"trace",name:"Trace",toolType:"draw",drawingMode:"trace",icon:"",shortcut:"T",tooltip:"Draw copper traces",colorReflective:!0,settings:So("trace",ex,6),layerSettings:new Map([["top",Bn("trace","top",F.top,xe.top)],["bottom",Bn("trace","bottom",F.bottom,xe.bottom)]]),defaultLayer:"top"}),c.set("component",{id:"component",name:"Component",toolType:"component",icon:"",shortcut:"C",tooltip:"Place component",colorReflective:!0,settings:So("component",tx,Ph.DEFAULT_SIZE),layerSettings:new Map([["top",Bn("component","top",X.top,p.top)],["bottom",Bn("component","bottom",X.bottom,p.bottom)]]),defaultLayer:"top"}),c.set("componentConnection",{id:"componentConnection",name:"Component Connections",toolType:"componentConnection",icon:"",shortcut:"",tooltip:"Component connection lines",colorReflective:!1,settings:So("componentConnection","#E69F00",3),layerSettings:new Map([["top",Bn("componentConnection","top","#E69F00",3)],["bottom",Bn("componentConnection","bottom","#E69F00",3)]])}),c.set("power",{id:"power",name:"Power",toolType:"power",icon:"",shortcut:"B",tooltip:"Place power node",colorReflective:!0,settings:So("power",Wf,18),layerSettings:new Map([["top",Bn("power","top",Wf,18)],["bottom",Bn("power","bottom",Wf,18)]]),defaultLayer:"top"}),c.set("ground",{id:"ground",name:"Ground",toolType:"ground",icon:"",shortcut:"G",tooltip:"Place ground symbol",colorReflective:!0,settings:So("ground",Vf,18),layerSettings:new Map([["top",Bn("ground","top",Vf,18)],["bottom",Bn("ground","bottom",Vf,18)]]),defaultLayer:"top"}),c.set("erase",{id:"erase",name:"Erase",toolType:"erase",icon:"",shortcut:"E",tooltip:"Erase objects",colorReflective:!1,settings:So("erase","#f5a3b3",18),layerSettings:new Map([["top",Bn("erase","top","#f5a3b3",18)],["bottom",Bn("erase","bottom","#f5a3b3",18)]])}),c.set("pan",{id:"pan",name:"Move",toolType:"pan",icon:"",shortcut:"H",tooltip:"Pan the view",colorReflective:!1,settings:So("pan","#ff0000",10),layerSettings:new Map([["top",Bn("pan","top","#ff0000",10)],["bottom",Bn("pan","bottom","#ff0000",10)]])}),c.set("magnify",{id:"magnify",name:"Zoom",toolType:"magnify",icon:"+",shortcut:"M",tooltip:"Magnify",colorReflective:!1,settings:So("magnify","#ff0000",10),layerSettings:new Map([["top",Bn("magnify","top","#ff0000",10)],["bottom",Bn("magnify","bottom","#ff0000",10)]])}),c},Nh={via:{color:"#2CA02C",size:18},padTop:{color:"#0072B2",size:18},padBottom:{color:"#56B4E9",size:18},testPointTop:{color:"#FFFF00",size:18},testPointBottom:{color:"#FFFF00",size:18},traceTop:{color:"#AA4499",size:6},traceBottom:{color:"#F781BF",size:6},componentTop:{color:"#6A3D9A",size:18},componentBottom:{color:"#9467BD",size:18},power:{color:"#ff0000",size:18},ground:{color:"#000000",size:18}},Ed={via:"Via",padTop:"Pad (Top)",padBottom:"Pad (Bottom)",testPointTop:"Test Point (Top)",testPointBottom:"Test Point (Bottom)",traceTop:"Trace (Top)",traceBottom:"Trace (Bottom)",componentTop:"Component (Top)",componentBottom:"Component (Bottom)",power:"Power",ground:"Ground"};class hx{instances=new Map;listeners=new Map;initialize(){for(const u of Object.keys(Nh)){const g=Nh[u];this.instances.set(u,{id:u,name:Ed[u],color:g.color,size:g.size}),this.listeners.set(u,new Set)}}initializeFromProject(u){if(this.initialize(),u?.toolInstances)for(const[g,d]of Object.entries(u.toolInstances))this.instances.has(g)&&this.instances.set(g,d)}get(u){const g=this.instances.get(u);if(!g)throw new Error(`Tool instance ${u} not found`);return g}getColor(u){const g=this.instances.get(u);if(!g)throw new Error(`Tool instance ${u} not found`);const d=Ed[u];return console.log(`${d}, returning color value=${g.color}`),g.color}getSize(u){const g=this.instances.get(u);if(!g)throw new Error(`Tool instance ${u} not found`);const d=Ed[u];return console.log(`${d}, returning size value=${g.size}`),g.size}setColor(u,g){const d=this.instances.get(u);if(d){const R=Ed[u];console.log(`${R}, setting color value=${g}`),d.color=g,this.notifyListeners(u)}}setSize(u,g){const d=this.instances.get(u);if(d){const R=Ed[u];console.log(`${R}, setting size value=${g}`),d.size=g,this.notifyListeners(u)}}getAll(){const u={};for(const[g,d]of this.instances.entries())u[g]=d;return u}subscribe(u,g){const d=this.listeners.get(u);return d?(d.add(g),()=>{d.delete(g)}):()=>{}}notifyListeners(u){const g=this.listeners.get(u);g&&g.forEach(d=>d())}}const At=new hx;At.initialize();function Wu(c,u){switch(c){case"via":return"via";case"pad":return u==="bottom"?"padBottom":"padTop";case"testPoint":return u==="bottom"?"testPointBottom":"testPointTop";case"trace":return u==="bottom"?"traceBottom":"traceTop";case"component":return u==="bottom"?"componentBottom":"componentTop";case"power":return"power";case"ground":return"ground";default:throw new Error(`Unknown tool: ${c}`)}}const gx=({visible:c,toolRegistry:u,currentTool:g,drawingMode:d,traceToolLayer:R,padToolLayer:F,testPointToolLayer:xe,componentToolLayer:X,updateToolSettings:p,updateToolLayerSettings:V,setBrushSize:de,saveToolSettings:ge,saveToolLayerSettings:Te,setTopTraceSize:Ue,setBottomTraceSize:se,setTopPadSize:Re,setBottomPadSize:B,setTopTestPointSize:te,setBottomTestPointSize:$e,setTopComponentSize:L,setBottomComponentSize:re,setComponentConnectionSize:N,saveDefaultSize:z,onClose:D})=>{const[P,O]=m.useState({}),he=[{id:"via",name:"Via",instanceId:"via"},{id:"pad",name:"Pad",layer:"top",instanceId:"padTop"},{id:"pad",name:"Pad",layer:"bottom",instanceId:"padBottom"},{id:"testPoint",name:"Test Point",layer:"top",instanceId:"testPointTop"},{id:"testPoint",name:"Test Point",layer:"bottom",instanceId:"testPointBottom"},{id:"trace",name:"Trace",layer:"top",instanceId:"traceTop"},{id:"trace",name:"Trace",layer:"bottom",instanceId:"traceBottom"},{id:"component",name:"Component",layer:"top",instanceId:"componentTop"},{id:"component",name:"Component",layer:"bottom",instanceId:"componentBottom"},{id:"componentConnection",name:"Component Connections"},{id:"power",name:"Power",instanceId:"power"},{id:"ground",name:"Ground",instanceId:"ground"},{id:"erase",name:"Erase"}];m.useEffect(()=>{if(c){const Se={};for(const me of he){const ce=me.instanceId||me.id;if(me.instanceId)try{const H=At.get(me.instanceId);Se[ce]=H.size}catch{const H=u.get(me.id);H&&(Se[ce]=me.layer?H.layerSettings.get(me.layer)?.size??H.settings.size??10:H.settings.size??10)}else{const H=u.get(me.id);H&&(Se[ce]=H.settings.size??10)}}O(Se)}},[c]);const W=m.useCallback((Se,me,ce,H)=>{if(!u.get(Se)&&Se!=="componentConnection")return;const pe=H||Se;O(K=>({...K,[pe]:me})),["trace","pad","testPoint","component"].includes(Se)&&ce&&H?(At.setSize(H,me),(Se==="trace"&&g==="draw"&&d==="trace"||Se==="pad"&&g==="draw"&&d==="pad"||Se==="testPoint"&&g==="draw"&&d==="testPoint"||Se==="component"&&g==="component")&&((Se==="trace"?R:Se==="pad"?F:Se==="testPoint"?xe:X)||"top")===ce&&de(me)):H?(At.setSize(H,me),(Se==="via"&&g==="draw"&&d==="via"||Se==="power"&&g==="power"||Se==="ground"&&g==="ground")&&de(me)):(Se==="componentConnection"&&(N(me),z("componentConnection",me)),Se==="erase"&&g==="erase"&&de(me))},[u,g,d,R,F,xe,X,de,N,z]);if(!c)return null;const j=Array.from({length:50},(Se,me)=>me+1);return n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:Se=>{Se.target===Se.currentTarget&&D()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"16px",width:"fit-content",maxWidth:"400px",maxHeight:"70vh",overflowY:"auto",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:Se=>Se.stopPropagation(),children:[n.jsx("h3",{style:{margin:"0 0 12px 0",color:"#fff",fontSize:"16px",fontWeight:600},children:"Set Tool Size"}),n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:he.map((Se,me)=>{if(!u.get(Se.id)&&Se.id!=="componentConnection")return null;const H=Se.layer?`${Se.name} (${Se.layer==="top"?"Top":"Bottom"})`:Se.name,I=Se.instanceId||Se.id,pe=P[I]??10;return n.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"6px 10px",background:"#1f1f24",borderRadius:4},children:[n.jsxs("label",{style:{color:"#f2f2f2",fontSize:"13px",width:"140px",flexShrink:0,marginRight:"8px"},children:[H,":"]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[n.jsx("select",{value:pe,onChange:Be=>{const K=parseInt(Be.target.value,10);W(Se.id,K,Se.layer,Se.instanceId)},style:{width:"50px",padding:"4px 6px",background:"#2b2b31",border:"1px solid #3a3a44",borderRadius:4,color:"#f2f2f2",fontSize:"12px",cursor:"pointer"},children:j.map(Be=>n.jsx("option",{value:Be,style:{background:"#2b2b31",color:"#f2f2f2"},children:Be},Be))}),n.jsx("span",{style:{color:"#f2f2f2",fontSize:"12px"},children:"px"})]})]},`${Se.id}-${Se.layer||"default"}-${me}`)})}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:n.jsx("button",{onClick:D,style:{padding:"6px 12px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:600},children:"Close"})})]})})},xx=({visible:c,toolRegistry:u,currentTool:g,drawingMode:d,traceToolLayer:R,padToolLayer:F,testPointToolLayer:xe,componentToolLayer:X,updateToolSettings:p,updateToolLayerSettings:V,saveToolSettings:de,saveToolLayerSettings:ge,setBrushColor:Te,setTopTraceColor:Ue,setBottomTraceColor:se,setTopPadColor:Re,setBottomPadColor:B,setTopTestPointColor:te,setBottomTestPointColor:$e,setTopComponentColor:L,setBottomComponentColor:re,setComponentConnectionColor:N,saveDefaultColor:z,colorPalette:D,onClose:P})=>{const[O,he]=Oe.useState(null),[W,j]=Oe.useState(0);if(Oe.useEffect(()=>{const I=[];return[{id:"via"},{id:"pad",layer:"top"},{id:"pad",layer:"bottom"},{id:"testPoint",layer:"top"},{id:"testPoint",layer:"bottom"},{id:"trace",layer:"top"},{id:"trace",layer:"bottom"},{id:"component",layer:"top"},{id:"component",layer:"bottom"},{id:"power"},{id:"ground"}].forEach(({id:Be,layer:K})=>{try{const w=Wu(Be,K),U=At.subscribe(w,()=>{j($=>$+1)});I.push(U)}catch{}}),()=>{I.forEach(Be=>Be())}},[]),!c)return null;const Se=["pad","testPoint","trace","component"],me=[{id:"via",name:"Via"},{id:"pad",name:"Pad",layer:"top"},{id:"pad",name:"Pad",layer:"bottom"},{id:"testPoint",name:"Test Point",layer:"top"},{id:"testPoint",name:"Test Point",layer:"bottom"},{id:"trace",name:"Trace",layer:"top"},{id:"trace",name:"Trace",layer:"bottom"},{id:"component",name:"Component",layer:"top"},{id:"component",name:"Component",layer:"bottom"},{id:"componentConnection",name:"Component Connections"},{id:"power",name:"Power"},{id:"ground",name:"Ground"},{id:"erase",name:"Erase"}],ce=(I,pe,Be)=>{if(I==="componentConnection"){N(pe),z("componentConnection",pe),he(null);return}if(I==="erase"){const K=u.get(I);K&&(p(I,{...K.settings,color:pe}),de(I,pe,K.settings.size)),he(null);return}try{let K;Be&&Se.includes(I)?K=Wu(I,Be):K=Wu(I),At.setColor(K,pe),(I==="via"&&g==="draw"&&d==="via"||I==="trace"&&g==="draw"&&d==="trace"||I==="pad"&&g==="draw"&&d==="pad"||I==="testPoint"&&g==="draw"&&d==="testPoint"||I==="component"&&g==="component"||I==="power"&&g==="power"||I==="ground"&&g==="ground")&&(Be&&Se.includes(I)?((I==="trace"?R:I==="pad"?F:I==="testPoint"?xe:X)||"top")===Be&&Te(pe):Te(pe))}catch(K){console.error(`Error updating color for tool ${I}:`,K);const w=u.get(I);w&&(Be&&Se.includes(I)?(V(I,Be,{...w.layerSettings.get(Be),color:pe}),ge(I,Be,pe,w.layerSettings.get(Be)?.size||w.settings.size)):(p(I,{...w.settings,color:pe}),de(I,pe,w.settings.size)))}he(null)},H=(I,pe)=>{let Be;try{const U=Wu(I,pe);Be=At.get(U).color}catch{const U=u.get(I);if(!U)return null;Be=U.settings.color??"#000000"}const K=pe?`${I}-${pe}`:I,w=O?.toolId===I&&O?.layer===pe;return n.jsxs("div",{style:{position:"relative",display:"inline-block",zIndex:10005},children:[n.jsx("button",{className:"color-swatch-button",onClick:U=>{U.stopPropagation(),he(w?null:{toolId:I,layer:pe})},style:{width:"40px",height:"24px",background:Be,backgroundColor:Be,backgroundImage:"none",border:"1px solid #3a3a44",borderRadius:3,cursor:"pointer",padding:0,margin:0,display:"block","--swatch-color":Be},title:Be},`${K}-button-${Be}-${W}`),w&&n.jsx("div",{onClick:U=>{U.stopPropagation()},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",padding:8,background:"#fff",border:"1px solid #ddd",borderRadius:6,boxShadow:"0 8px 18px rgba(0,0,0,0.18)",zIndex:100},children:n.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(8, 22px)",gap:4},children:D.map(U=>n.jsx("div",{onClick:()=>ce(I,U,pe),title:U,style:{width:22,height:22,backgroundColor:U,border:U===Be?"2px solid #333":"1px solid #ccc",cursor:"pointer"}},U))})})]},`${K}-${Be}-${W}`)};return n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:I=>{I.target===I.currentTarget&&(P(),he(null))},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"16px",width:"fit-content",minWidth:"450px",maxWidth:"600px",maxHeight:"70vh",overflowY:"auto",overflowX:"visible",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:I=>I.stopPropagation(),children:[n.jsx("h3",{style:{margin:"0 0 12px 0",color:"#fff",fontSize:"16px",fontWeight:600},children:"Set Tool Color"}),n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:me.map((I,pe)=>{if(!u.get(I.id))return null;const K=I.layer?`${I.name} (${I.layer==="top"?"Top":"Bottom"})`:I.name;return n.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"6px 10px",background:"#1f1f24",borderRadius:4},children:[n.jsxs("label",{style:{color:"#f2f2f2",fontSize:"13px",width:"140px",flexShrink:0,marginRight:"8px"},children:[K,":"]}),H(I.id,I.layer)]},`${I.id}-${I.layer||"default"}-${pe}`)})}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:n.jsx("button",{onClick:()=>{P(),he(null)},style:{padding:"6px 12px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:600},children:"Close"})})]})})},yx=({openMenu:c,setOpenMenu:u,isReadOnlyMode:g,currentProjectFilePath:d,isProjectActive:R,autoSaveEnabled:F,autoSaveIndicatorActive:xe,onNewProject:X,onOpenProject:p,onSaveProject:V,onSaveAs:de,onPrint:ge,hasUnsavedChanges:Te,setNewProjectDialog:Ue,setAutoSaveDialog:se,topImage:Re,bottomImage:B,setCurrentTool:te,resetImageTransform:$e,areImagesLocked:L,setAreImagesLocked:re,onEnterBoardDimensions:N,fileInputTopRef:z,fileInputBottomRef:D,openProjectRef:P,increaseSize:O,decreaseSize:he,brushSize:W,drawingStrokes:j,selectedIds:Se,selectedComponentIds:me,selectedPowerIds:ce,selectedGroundIds:H,componentsTop:I,componentsBottom:pe,powers:Be,grounds:K,powerNodeNames:w,groundNodeNames:U,setSetSizeDialog:$,areViasLocked:Z,setAreViasLocked:Ie,arePadsLocked:ot,setArePadsLocked:xt,areTestPointsLocked:Gt,setAreTestPointsLocked:He,areTracesLocked:In,setAreTracesLocked:Un,areComponentsLocked:Ui,setAreComponentsLocked:wi,areGroundNodesLocked:pi,setAreGroundNodesLocked:ji,arePowerNodesLocked:zl,setArePowerNodesLocked:$i,showTraceCornerDots:kl,setShowTraceCornerDots:Zo,setSelectedIds:yr,setSelectedComponentIds:Ko,setSelectedPowerIds:$c,setSelectedGroundIds:Ze,selectAllVias:ft,selectAllTraces:Lc,selectAllPads:_e,selectAllComponents:Pt,selectDisconnectedComponents:Kl,selectAllComponentConnections:jo,selectAllPowerNodes:Xt,selectAllGroundNodes:hi,selectPowerNodesByName:Rl,selectGroundNodesByName:Pi,setShowPowerBusManager:De,setShowGroundBusManager:Gn,setShowDesignatorManager:tt,setShowPastMachine:Dn,toolRegistry:Ql,updateToolSettings:br,updateToolLayerSettings:Jl,setBrushSize:bs,setBrushColor:Mt,saveToolSettings:Ti,saveToolLayerSettings:eo,colorPalette:Li,currentTool:_a,drawingMode:Oi,traceToolLayer:al,padToolLayer:to,testPointToolLayer:Kr,componentToolLayer:We,setTopTraceSize:Ci,setBottomTraceSize:zt,setTopPadSize:Vn,setBottomPadSize:ms,setTopTestPointSize:mr,setBottomTestPointSize:vr,setTopComponentSize:sl,setBottomComponentSize:pt,setComponentConnectionSize:Pn,topTraceColor:Ft,bottomTraceColor:Ha,topPadColor:sn,bottomPadColor:Sr,topTestPointColor:kn,bottomTestPointColor:To,topComponentColor:Qo,bottomComponentColor:Dl,setTopTraceColor:rl,setBottomTraceColor:Al,setTopPadColor:Jo,setBottomPadColor:Bt,setTopTestPointColor:Qr,setBottomTestPointColor:Ht,setTopComponentColor:rn,setBottomComponentColor:cl,setComponentConnectionColor:Jr,saveDefaultSize:ea,saveDefaultColor:wr,menuBarRef:Yi,onOpenProjectNotes:gi,onOpenTransformImages:Ea})=>{const[Wn,wn]=Oe.useState(null),xi=Oe.useRef(null),[no,cn]=Oe.useState(null),Fn=Oe.useRef(null),[ta,Yc]=Oe.useState(!1),[yi,Ia]=Oe.useState(!1),io=Ve=>{if(!R){alert("Please create a new project (File  New Project) or open an existing project (File  Open Project) before using this feature."),u(null);return}Ve()},Va=Ve=>{const qe=Ve==="power"?w:U,ct=qe.length>0,Wa=Ve==="power"?"Select Power Nodes":"Select Ground Nodes";return n.jsxs("div",{onMouseEnter:()=>{xi.current&&(clearTimeout(xi.current),xi.current=null),wn(Ve)},onMouseLeave:()=>{xi.current=window.setTimeout(()=>{wn(Xi=>Xi===Ve?null:Xi)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[n.jsxs("div",{style:{padding:"4px 10px",fontSize:12,color:"#bbb"},children:[Wa," by Name"]}),n.jsxs("button",{onClick:()=>{Ve==="power"?Xt():hi(),wn(null),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:["All ",Ve==="power"?"Power Nodes":"Ground Nodes"]}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),ct?qe.map(Xi=>n.jsx("button",{onClick:()=>{Ve==="power"?Rl(Xi):Pi(Xi),wn(null),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:Xi},Xi)):n.jsxs("div",{style:{padding:"4px 10px",fontSize:12,color:"#bbb"},children:["No ",Ve==="power"?"power":"ground"," nodes available."]})]})},lo=()=>n.jsxs("div",{onMouseEnter:()=>{Fn.current&&(clearTimeout(Fn.current),Fn.current=null),cn("lock")},onMouseLeave:()=>{Fn.current=window.setTimeout(()=>{cn(Ve=>Ve==="lock"?null:Ve)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[n.jsxs("label",{onClick:Ve=>{Ve.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[n.jsx("input",{type:"checkbox",checked:Z,onChange:()=>{Ie(Ve=>!Ve)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),n.jsx("span",{children:"Lock Vias"})]}),n.jsxs("label",{onClick:Ve=>{Ve.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[n.jsx("input",{type:"checkbox",checked:ot,onChange:()=>{xt(Ve=>!Ve)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),n.jsx("span",{children:"Lock Pads"})]}),n.jsxs("label",{onClick:Ve=>{Ve.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[n.jsx("input",{type:"checkbox",checked:Gt,onChange:()=>{He(Ve=>!Ve)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),n.jsx("span",{children:"Lock Test Points"})]}),n.jsxs("label",{onClick:Ve=>{Ve.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[n.jsx("input",{type:"checkbox",checked:In,onChange:()=>{Un(Ve=>!Ve)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),n.jsx("span",{children:"Lock Traces"})]}),n.jsxs("label",{onClick:Ve=>{Ve.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[n.jsx("input",{type:"checkbox",checked:Ui,onChange:()=>{wi(Ve=>!Ve)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),n.jsx("span",{children:"Lock Components"})]}),n.jsxs("label",{onClick:Ve=>{Ve.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[n.jsx("input",{type:"checkbox",checked:pi,onChange:()=>{ji(Ve=>!Ve)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),n.jsx("span",{children:"Lock Ground Node"})]}),n.jsxs("label",{onClick:Ve=>{Ve.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[n.jsx("input",{type:"checkbox",checked:zl,onChange:()=>{$i(Ve=>!Ve)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),n.jsx("span",{children:"Lock Power Nodes"})]})]}),On=()=>n.jsxs("div",{onMouseEnter:()=>{Fn.current&&(clearTimeout(Fn.current),Fn.current=null),cn("select")},onMouseLeave:()=>{Fn.current=window.setTimeout(()=>{cn(Ve=>Ve==="select"?null:Ve)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[n.jsx("button",{onClick:()=>{ft(),cn(null),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Vias"}),n.jsx("button",{onClick:()=>{Lc(),cn(null),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Traces"}),n.jsx("button",{onClick:()=>{_e(),cn(null),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Pads"}),n.jsx("button",{onClick:()=>{const Ve=new Set(j.filter(qe=>qe.type==="testPoint").map(qe=>qe.id));yr(Ve),Ko(new Set),$c(new Set),Ze(new Set),cn(null),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Test Points"}),n.jsx("button",{onClick:()=>{Pt(),cn(null),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Components"}),n.jsx("button",{onClick:()=>{jo(),cn(null),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Component Connections"}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onMouseEnter:()=>{xi.current&&(clearTimeout(xi.current),xi.current=null),wn("power")},onMouseLeave:()=>{xi.current=window.setTimeout(()=>{wn(Ve=>Ve==="power"?null:Ve)},200)},onClick:()=>{wn(Ve=>Ve==="power"?null:"power")},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Power Nodes "}),Wn==="power"&&Va("power")]}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onMouseEnter:()=>{xi.current&&(clearTimeout(xi.current),xi.current=null),wn("ground")},onMouseLeave:()=>{xi.current=window.setTimeout(()=>{wn(Ve=>Ve==="ground"?null:Ve)},200)},onClick:()=>{wn(Ve=>Ve==="ground"?null:"ground")},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Ground Nodes "}),Wn==="ground"&&Va("ground")]}),n.jsx("button",{onClick:()=>{Kl(),cn(null),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Disconnected Components"})]});return n.jsxs(n.Fragment,{children:[n.jsxs("div",{ref:Yi,style:{position:"relative",background:"rgba(250,250,255,0.9)",borderBottom:"1px solid #e6e6ef",padding:"6px 12px",display:"flex",gap:16,alignItems:"center",zIndex:3},children:[n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onClick:Ve=>{Ve.stopPropagation(),u(qe=>qe==="file"?null:"file")},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:c==="file"?"#eef3ff":"#fff",fontWeight:600,color:"#222"},children:"File "}),c==="file"&&n.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:200,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[n.jsx("button",{onClick:()=>{g||(u(null),Te()?Ue({visible:!0}):X())},disabled:g,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:g?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:g?"not-allowed":"pointer"},children:"New Project"}),n.jsx("button",{onClick:async()=>{await p(),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Open Project"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{g||io(()=>{V(),u(null)})},disabled:g||!R,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:g||!R?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:g||!R?"not-allowed":"pointer"},children:"Save Project"}),n.jsx("button",{onClick:()=>{g||io(()=>{de(),u(null)})},disabled:g||!R,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:g||!R?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:g||!R?"not-allowed":"pointer"},children:"Save As"}),n.jsx("button",{onClick:()=>{g||io(()=>{se({visible:!0,interval:5}),u(null)})},disabled:g||!R,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:g||!R?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:g||!R?"not-allowed":"pointer"},children:"Auto Save"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{io(()=>{ge(),u(null)})},disabled:!R,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:R?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:R?"pointer":"not-allowed"},children:"Print"}),n.jsx("button",{onClick:()=>{io(()=>{ge(),u(null)})},disabled:!R,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:R?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:R?"pointer":"not-allowed"},children:"Printer Settings"})]})]}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onClick:Ve=>{if(!g){if(!R){alert("Please create a new project (File  New Project) or open an existing project (File  Open Project) before using this feature.");return}Ve.stopPropagation(),u(qe=>qe==="transform"?null:"transform")}},disabled:g||!R,style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:c==="transform"?"#eef3ff":"#fff",fontWeight:600,color:g||!R?"#999":"#222",cursor:g||!R?"not-allowed":"pointer",opacity:g||!R?.5:1},children:"Images "}),c==="transform"&&n.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:260,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[n.jsx("button",{onClick:()=>{!g&&!L&&(z.current?.click(),u(null))},disabled:g||L,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:g||L?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:g||L?"not-allowed":"pointer"},children:"Load Top PCB"}),n.jsx("button",{onClick:()=>{!g&&!L&&(D.current?.click(),u(null))},disabled:g||L,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:g||L?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:g||L?"not-allowed":"pointer"},children:"Load Bottom PCB"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{L||(N(),u(null))},disabled:L,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:L?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:L?"not-allowed":"pointer"},children:"Enter PCB Dimensions"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{Ea(),u(null)},disabled:!Re&&!B||L,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:!Re&&!B||L?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:!Re&&!B||L?"not-allowed":"pointer"},children:"Transform Images"}),n.jsx("button",{onClick:()=>{L||(te("transform"),$e(),u(null))},disabled:L||!Re&&!B,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:L||!Re&&!B?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:L||!Re&&!B?"not-allowed":"pointer"},children:"Reset Transform"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{re(Ve=>!Ve),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:L?"Unlock Images ":"Lock Images"})]})]}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onClick:Ve=>{if(!g){if(!R){alert("Please create a new project (File  New Project) or open an existing project (File  Open Project) before using this feature.");return}Ve.stopPropagation(),u(qe=>qe==="tools"?null:"tools")}},disabled:g||!R,style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:c==="tools"?"#eef3ff":"#fff",fontWeight:600,color:g||!R?"#999":"#222",cursor:g||!R?"not-allowed":"pointer",opacity:g||!R?.5:1},children:"Tools "}),c==="tools"&&n.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[n.jsx("button",{onClick:()=>{O(),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Increase Size (+)"}),n.jsx("button",{onClick:()=>{he(),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Decrease Size (-)"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{Yc(!0),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Set Tool Size"}),n.jsx("button",{onClick:()=>{Ia(!0),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Set Tool Color"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onMouseEnter:()=>{Fn.current&&(clearTimeout(Fn.current),Fn.current=null),cn("lock")},onMouseLeave:()=>{Fn.current=window.setTimeout(()=>{cn(Ve=>Ve==="lock"?null:Ve)},200)},onClick:()=>{cn(Ve=>Ve==="lock"?null:"lock")},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Lock "}),no==="lock"&&lo()]}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onMouseEnter:()=>{Fn.current&&(clearTimeout(Fn.current),Fn.current=null),cn("select")},onMouseLeave:()=>{Fn.current=window.setTimeout(()=>{cn(Ve=>Ve==="select"?null:Ve)},200)},onClick:()=>{cn(Ve=>Ve==="select"?null:"select")},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Select "}),no==="select"&&On()]}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{gi(),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Project Notes"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{De(!0),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Manage Power Buses"}),n.jsx("button",{onClick:()=>{Gn(!0),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Manage Ground Buses"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{tt(!0),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Manage Designators"}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsxs("button",{onClick:()=>{Zo(!kl),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:[kl?" ":"   ","Show Trace Corner Dots"]}),n.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),n.jsx("button",{onClick:()=>{Dn(!0),u(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Restore from History"})]})]}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onClick:Ve=>{Ve.stopPropagation(),u(qe=>qe==="about"?null:"about")},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:c==="about"?"#eef3ff":"#fff",fontWeight:600,color:"#222"},children:"About "}),c==="about"&&n.jsx("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:500,maxWidth:700,maxHeight:"80vh",background:"#fff",border:"1px solid #ccc",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:20,overflowY:"auto",zIndex:100},children:n.jsxs("div",{style:{marginBottom:16},children:[n.jsx("h2",{style:{margin:"0 0 16px 0",color:"#000",fontSize:"20px",fontWeight:700},children:"Worms: An Electronics Tool"}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"About"}),n.jsx("p",{style:{margin:"0 0 12px 0",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:"A specialized tool useful for both reverse engineering and troubleshooting electronics by tracing and documenting circuit connections from PCB images. This application supports typical 2 to 4 layer PCBs and enables comprehensive PCB analysis and documentation."}),n.jsx("p",{style:{margin:"0 0 12px 0",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:"This tool can assist in troubleshooting by tracing circuits, holding contextual notes, comparing test results, and documenting findings during the debugging process."})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Technology"}),n.jsx("p",{style:{margin:"0 0 12px 0",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:"The application runs entirely client-side in the browser, to provide a responsive, interactive drawing experience with no backend server requirements."})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Features"}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Tools & Shortcuts"}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px 16px",fontSize:"13px",color:"#222"},children:[n.jsx("div",{children:n.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Select"}),"  ",n.jsx("code",{children:"S"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Via"}),"  ",n.jsx("code",{children:"V"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Pad"}),"  ",n.jsx("code",{children:"P"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Test Point"}),"  ",n.jsx("code",{children:"Y"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Trace"}),"  ",n.jsx("code",{children:"T"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Component"}),"  ",n.jsx("code",{children:"C"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Component Properties"}),"  double-click component"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Resize Icons"}),"  ",n.jsx("code",{children:"+"})," / ",n.jsx("code",{children:"-"})]})]})}),n.jsx("div",{children:n.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Power"}),"  ",n.jsx("code",{children:"B"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Ground"}),"  ",n.jsx("code",{children:"G"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Move (Pan)"}),"  ",n.jsx("code",{children:"H"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Magnify"}),"  ",n.jsx("code",{children:"M"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Set View"}),"  ",n.jsx("code",{children:"X"})," then ",n.jsx("code",{children:"0-9"})," to save view"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Recall View"}),"  ",n.jsx("code",{children:"0-9"})," to recall saved view"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Information Dialog"}),"  ",n.jsx("code",{children:"I"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Notes Dialog"}),"  ",n.jsx("code",{children:"N"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Project Notes / TODO"}),"  ",n.jsx("code",{children:"L"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Undo"}),"  ",n.jsx("code",{children:"Ctrl"})," + ",n.jsx("code",{children:"Z"})]})]})})]}),n.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#222"},children:[n.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600},children:"Arrow Keys"}),n.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Image Transformations"}),"  Arrow keys for scaling, rotating, and adjusting image transformations (when image is selected for transform)"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Move Selected Components"}),"  Arrow keys to nudge selected components"]})]})]})]}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px 20px"},children:[n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Image Management"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Load top and bottom PCB images"}),n.jsx("li",{children:"Image alignment and transformation"}),n.jsx("li",{children:"Transform modes: nudge, scale, rotate, slant, keystone"}),n.jsx("li",{children:"Horizontal and vertical flip controls"}),n.jsx("li",{children:"Brightness and contrast controls"}),n.jsx("li",{children:"Grayscale mode"}),n.jsx("li",{children:"Automated transparency slider"}),n.jsx("li",{children:"Board dimensions configuration"})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Drawing Tools"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Draw copper traces (top and bottom layers)"}),n.jsx("li",{children:"Place vias for layer connections"}),n.jsx("li",{children:"Place component pads (SMD and through-hole)"}),n.jsx("li",{children:"Place test points for circuit testing"}),n.jsx("li",{children:"Place and annotate components"}),n.jsx("li",{children:"Place power and ground nodes"}),n.jsx("li",{children:"Erase tool for removing elements"})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Layer Management"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"14 independent layers to manage PCB element types"}),n.jsx("li",{children:"Separate top and bottom layer support"}),n.jsx("li",{children:"Layer-specific color customization"}),n.jsx("li",{children:"Layer-specific size controls"}),n.jsx("li",{children:"Layer visibility toggles"}),n.jsx("li",{children:"Overlay view mode"})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Component Management"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Component placement with pin counts"}),n.jsx("li",{children:"Pin connection tracking"}),n.jsx("li",{children:"Component type classification"}),n.jsx("li",{children:"Designator and value annotation"}),n.jsx("li",{children:"Component editor dialog"}),n.jsx("li",{children:"Find and center component"})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Selection & Locking"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Select individual elements or groups"}),n.jsx("li",{children:"Select all vias, traces, pads, or components"}),n.jsx("li",{children:"Select power/ground nodes by name"}),n.jsx("li",{children:"Select disconnected components"}),n.jsx("li",{children:"Lock/unlock elements by type"}),n.jsx("li",{children:"Image locking for protection"})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Power & Ground"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Multiple voltage power nodes"}),n.jsx("li",{children:"Power bus management"}),n.jsx("li",{children:"Ground node placement"}),n.jsx("li",{children:"Ground bus management"}),n.jsx("li",{children:"Node naming and organization"})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Customization"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Customizable colors per layer"}),n.jsx("li",{children:"Adjustable brush/tool sizes"}),n.jsx("li",{children:"Size presets for common tools"}),n.jsx("li",{children:"Color palette management"}),n.jsx("li",{children:"Tool settings persistence"})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"Project Management"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Create, open, and save projects"}),n.jsx("li",{children:"Auto-save with configurable intervals"}),n.jsx("li",{children:"File history automatically saved in history subdirectory when Auto Save is enabled"}),n.jsx("li",{children:"Project Notes / TODO list with spreadsheet-like editing"}),n.jsx("li",{children:"Project file format (JSON)"}),n.jsx("li",{children:"Print functionality"}),n.jsx("li",{children:"Export to KiCad schematic format (future feature, not yet implemented)"})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",color:"#222",fontSize:"14px",fontWeight:600},children:"View Controls"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Zoom in/out with mouse wheel"}),n.jsx("li",{children:"Pan view with hand tool"}),n.jsx("li",{children:"Zoom to fit"}),n.jsx("li",{children:"View mode switching (top/bottom/overlay)"}),n.jsx("li",{children:"Save up to 10 view locations (X + 0-9)"}),n.jsx("li",{children:"Recall saved views instantly (0-9 keys)"}),n.jsx("li",{children:"Detailed information dialog"})]})]})]})]}),n.jsx("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #ddd"},children:n.jsxs("p",{style:{margin:"0 0 8px 0",color:"#666",fontSize:"12px",lineHeight:"1.5"},children:["Use the ",n.jsx("strong",{children:"File"})," menu to manage projects, the ",n.jsx("strong",{children:"Images"})," menu for image loading and transformation, and the ",n.jsx("strong",{children:"Tools"})," menu for selection, locking, and customization options."]})}),n.jsxs("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #ddd"},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Future / TODO List"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"A searchable list of common components"}),n.jsx("li",{children:"Output schematics (perhaps as KiCad files)"}),n.jsx("li",{children:"Dynamic layers"})]})]})]})})]}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onClick:Ve=>{Ve.stopPropagation(),u(qe=>qe==="help"?null:"help")},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:c==="help"?"#eef3ff":"#fff",fontWeight:600,color:"#222"},children:"Help "}),c==="help"&&n.jsx("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:500,maxWidth:700,maxHeight:"80vh",background:"#fff",border:"1px solid #ccc",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:20,overflowY:"auto",zIndex:100},children:n.jsxs("div",{style:{marginBottom:16},children:[n.jsx("h2",{style:{margin:"0 0 16px 0",color:"#000",fontSize:"20px",fontWeight:700},children:"Help: Typical Usage Steps"}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Step 1: Create or Open a Project"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"New Project:"})," File  New Project. Choose a project name and location."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Open Project:"})," File  Open Project. Select an existing project file (.json)."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Auto-Save:"})," File  Auto Save  Enable to automatically save your work at regular intervals."]})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Step 2: Load PCB Images"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Load Top Image:"})," Images  Load Top Image. Select your top-side PCB photo (.png or .jpeg)."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Load Bottom Image:"})," Images  Load Bottom Image. Select your bottom-side PCB photo."]}),n.jsxs("li",{children:["Images are automatically copied to the ",n.jsx("code",{style:{background:"#1f1f24",padding:"2px 4px",borderRadius:3,color:"#fff"},children:"images/"})," subdirectory."]})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Step 3: Align and Transform Images"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Enter Transform Mode:"})," Images  Transform Images. Select which image (Top or Bottom) to transform."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Transform Operations:"})," Use Move, Nudge, Scale, Rotate, Slant, or Keystone to align images."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Image Adjustments:"})," Adjust brightness, contrast, sharpness, and grayscale as needed."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Flip Images:"})," Use horizontal or vertical flip if your images are mirrored."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Arrow Keys:"})," When transform tool is active, use arrow keys for precise adjustments."]})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Step 4: Set Board Dimensions"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Enter Dimensions:"})," Images  Enter Board Dimensions. Specify the actual physical dimensions of your PCB."]}),n.jsx("li",{children:"This helps ensure accurate measurements and scaling for your reverse engineering work."})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Step 5: Trace Connections"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Place Vias:"})," Click the Via tool (",n.jsx("code",{children:"V"}),") and click on the PCB where vias connect layers."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Place Pads:"})," Click the Pad tool (",n.jsx("code",{children:"P"}),") and mark component pad locations."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Place Test Points:"})," Click the Test Point tool (",n.jsx("code",{children:"Y"}),") to mark test points."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Draw Traces:"})," Click the Trace tool (",n.jsx("code",{children:"T"}),"), select Top or Bottom layer, then click to start a trace. Click again to add segments. Press ",n.jsx("code",{children:"Enter"})," or click outside to finish."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Snapping:"})," Traces automatically snap to nearby vias, pads, power nodes, and ground nodes."]})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Step 6: Place Components"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Place Component:"})," Click the Component tool (",n.jsx("code",{children:"C"}),"), select component type, then click on the PCB."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Edit Component:"})," Double-click a component to open the Component Editor dialog."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Set Properties:"})," Enter designator (e.g., R1, C2), value, and other component details."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Connect Pins:"})," Click on pads or vias to connect component pins to the circuit."]})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Step 7: Add Power and Ground Nodes"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Manage Power Buses:"})," Tools  Manage Power Buses to create and configure voltage buses (e.g., +5V, +3.3V)."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Place Power Nodes:"})," Click the Power tool (",n.jsx("code",{children:"B"}),"), select a voltage bus, then click on the PCB."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Manage Ground Buses:"})," Tools  Manage Ground Buses to configure ground connections."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Place Ground Nodes:"})," Click the Ground tool (",n.jsx("code",{children:"G"}),"), select a ground bus, then click on the PCB."]})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Step 8: Add Notes and Documentation"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Element Notes:"})," Press ",n.jsx("code",{children:"N"})," to open the Notes dialog for selected elements (vias, pads, traces, etc.)."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Project Notes:"})," Press ",n.jsx("code",{children:"L"})," to open Project Notes / TODO list for general project documentation."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Information Dialog:"})," Press ",n.jsx("code",{children:"I"})," to see detailed information about selected elements."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Find Elements:"})," Use the Find button in the Information dialog to center and highlight specific elements."]})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Step 9: Save Your Work"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"14px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Manual Save:"})," File  Save Project to save your work manually."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Auto-Save:"})," If enabled, your project is automatically saved at regular intervals."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"History:"})," Auto-saved versions are stored in the ",n.jsx("code",{style:{background:"#1f1f24",padding:"2px 4px",borderRadius:3,color:"#fff"},children:"history/"})," subdirectory."]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Restore from History:"})," Tools  Restore from History to access previous versions."]})]})]}),n.jsxs("div",{style:{marginBottom:20,paddingTop:16,borderTop:"1px solid #ddd"},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Keyboard Shortcuts"}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px 16px",fontSize:"13px",color:"#222"},children:[n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600},children:"Drawing Tools"}),n.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Select"}),"  ",n.jsx("code",{children:"S"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Via"}),"  ",n.jsx("code",{children:"V"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Pad"}),"  ",n.jsx("code",{children:"P"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Test Point"}),"  ",n.jsx("code",{children:"Y"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Trace"}),"  ",n.jsx("code",{children:"T"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Component"}),"  ",n.jsx("code",{children:"C"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Power"}),"  ",n.jsx("code",{children:"B"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Ground"}),"  ",n.jsx("code",{children:"G"})]})]})]}),n.jsxs("div",{children:[n.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600},children:"View & Navigation"}),n.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Move (Pan)"}),"  ",n.jsx("code",{children:"H"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Magnify"}),"  ",n.jsx("code",{children:"M"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Set View"}),"  ",n.jsx("code",{children:"X"})," then ",n.jsx("code",{children:"0-9"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Recall View"}),"  ",n.jsx("code",{children:"0-9"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Information"}),"  ",n.jsx("code",{children:"I"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Notes"}),"  ",n.jsx("code",{children:"N"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Project Notes"}),"  ",n.jsx("code",{children:"L"})]}),n.jsxs("li",{children:[n.jsx("strong",{children:"Undo"}),"  ",n.jsx("code",{children:"Ctrl+Z"})," / ",n.jsx("code",{children:"Cmd+Z"})]})]})]})]}),n.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#222"},children:[n.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600},children:"Arrow Keys"}),n.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Use arrow keys to adjust image transformations (when transform tool is active)"}),n.jsx("li",{children:"Use arrow keys to nudge selected components"}),n.jsx("li",{children:"Click a slider first, then use arrow keys for precise adjustment"})]})]})]}),n.jsxs("div",{style:{marginBottom:20},children:[n.jsx("h3",{style:{margin:"0 0 10px 0",color:"#000",fontSize:"16px",fontWeight:600},children:"Tips & Tricks"}),n.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#222",fontSize:"13px",lineHeight:"1.6"},children:[n.jsx("li",{children:"Double-click any slider to reset it to the default value"}),n.jsx("li",{children:"Double-click a component to edit its properties"}),n.jsxs("li",{children:["Hold ",n.jsx("code",{children:"Shift"})," while clicking to add to selection"]}),n.jsxs("li",{children:["Use the Information dialog (",n.jsx("code",{children:"I"}),") to see details about selected elements"]}),n.jsx("li",{children:"Lock layers (Tools  Lock) to prevent accidental modifications"}),n.jsx("li",{children:"Use the Find button in the Information dialog to center elements in view"}),n.jsxs("li",{children:["Save views with ",n.jsx("code",{children:"X"})," + number key for quick navigation"]}),n.jsxs("li",{children:["Use ",n.jsx("code",{children:"+"})," and ",n.jsx("code",{children:"-"})," keys to resize tool icons"]})]})]}),n.jsx("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #ddd"},children:n.jsxs("p",{style:{margin:"0 0 8px 0",color:"#666",fontSize:"12px",lineHeight:"1.5"},children:["For more detailed feature information, see the ",n.jsx("strong",{children:"About"})," menu."]})})]})})]}),d&&n.jsxs("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:"8px",paddingLeft:"16px"},children:[n.jsx("div",{style:{fontSize:"12px",color:"#333",fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"40vw"},title:d,children:d}),F&&n.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",border:"1px solid #666",backgroundColor:xe?"#ff0000":"#00ff00",flexShrink:0},title:xe?"Auto-save pending (changes detected)":"Auto-save enabled (no changes)"})]})]}),n.jsx(gx,{visible:ta,toolRegistry:Ql,currentTool:_a,drawingMode:Oi,traceToolLayer:al,padToolLayer:to,testPointToolLayer:Kr,componentToolLayer:We,updateToolSettings:br,updateToolLayerSettings:Jl,setBrushSize:bs,saveToolSettings:Ti,saveToolLayerSettings:eo,setTopTraceSize:Ci,setBottomTraceSize:zt,setTopPadSize:Vn,setBottomPadSize:ms,setTopTestPointSize:mr,setBottomTestPointSize:vr,setTopComponentSize:sl,setBottomComponentSize:pt,setComponentConnectionSize:Pn,saveDefaultSize:ea,onClose:()=>Yc(!1)}),n.jsx(xx,{visible:yi,toolRegistry:Ql,currentTool:_a,drawingMode:Oi,traceToolLayer:al,padToolLayer:to,testPointToolLayer:Kr,componentToolLayer:We,updateToolSettings:br,updateToolLayerSettings:Jl,saveToolSettings:Ti,saveToolLayerSettings:eo,setBrushColor:Mt,setTopTraceColor:rl,setBottomTraceColor:Al,setTopPadColor:Jo,setBottomPadColor:Bt,setTopTestPointColor:Qr,setBottomTestPointColor:Ht,setTopComponentColor:rn,setBottomComponentColor:cl,setComponentConnectionColor:Jr,saveDefaultColor:wr,colorPalette:Li,onClose:()=>Ia(!1)})]})},bx=({visible:c})=>c?n.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",padding:"24px 32px",background:"rgba(255, 255, 255, 0.95)",borderRadius:8,border:"2px solid #4CAF50",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",zIndex:1,maxWidth:"500px"},children:[n.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"#000",marginBottom:"12px"},children:"PCB Reverse Engineering Tool"}),n.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"#000",marginBottom:"16px",lineHeight:"1.5"},children:"Supports Typical 4-Layer PCBs"}),n.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"8px",lineHeight:"1.5",textAlign:"left"},children:"1) Use the File menu to start a new project."}),n.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"8px",lineHeight:"1.5",textAlign:"left"},children:"2) Use the Images menu to load PCB photos."}),n.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"12px",lineHeight:"1.5",textAlign:"left"},children:"3) Use the tools to draw vias, pads, traces, etc."}),n.jsx("div",{style:{fontSize:"13px",color:"#555",marginTop:"16px",lineHeight:"1.5",textAlign:"left",fontWeight:"bold"},children:"Best viewed in browser's Full Screen Mode"})]}):null,mx=({visible:c,title:u,message:g,onClose:d})=>c?n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:R=>{R.target===R.currentTarget&&d()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"2px solid #ff4444"},onClick:R=>R.stopPropagation(),children:[n.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",gap:"12px"},children:[n.jsx("div",{style:{fontSize:"24px",color:"#ff4444"},children:""}),n.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:u})]}),n.jsx("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"14px",lineHeight:"1.5"},children:g}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:n.jsx("button",{onClick:d,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"OK"})})]})}):null,vx=({visible:c,selectedIds:u,selectedComponentIds:g,selectedPowerIds:d,selectedGroundIds:R,drawingStrokes:F,componentsTop:xe,componentsBottom:X,powers:p,grounds:V,powerBuses:de,onClose:ge,setComponentsTop:Te,setComponentsBottom:Ue,determineViaType:se,determinePadType:Re,determineTestPointType:B,onFindComponent:te,onFindStroke:$e,onFindPower:L,onFindGround:re,position:N,isDragging:z,onDragStart:D,onOpenNotesDialog:P})=>{if(!c)return null;const O=N?{position:"fixed",left:`${N.x}px`,top:`${N.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"150px",maxWidth:"400px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:z?"grabbing":"default"}:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"flex-start",justifyContent:"flex-end",paddingRight:"20px",paddingTop:"80px",zIndex:1e4,pointerEvents:"none"},he={padding:"20px",overflow:"auto",flex:1};return n.jsxs("div",{style:O,children:[n.jsxs("div",{onMouseDown:W=>{const j=W.target;j.tagName==="BUTTON"||j.closest("button")||N&&D(W)},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:z?"grabbing":N?"grab":"default",userSelect:"none",flexShrink:0},children:[n.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Information (I)"}),n.jsx("button",{onClick:ge,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),n.jsx("div",{style:he,children:n.jsxs("div",{style:{margin:0,padding:0,backgroundColor:"#f5f5f5",borderRadius:4,fontSize:"12px",fontFamily:"monospace",maxHeight:"calc(80vh - 100px)",overflow:"auto",color:"#000"},children:[(()=>{const W=F.filter(H=>u.has(H.id)).length,j=[...xe,...X].filter(H=>g.has(H.id)).length,Se=p.filter(H=>d.has(H.id)).length,me=V.filter(H=>R.has(H.id)).length,ce=W+j+Se+me;return n.jsx("div",{style:{padding:"12px 16px",backgroundColor:ce>0?"#e8e8e8":"#fff3cd",borderBottom:"2px solid #ccc",fontSize:"13px",fontWeight:600,color:ce>0?"#333":"#856404",marginBottom:"8px"},children:ce>0?`${ce} Object${ce!==1?"s":""} Selected`:"Zero Objects Selected"})})(),g.size>0&&(()=>{const W=F.some(j=>u.has(j.id)&&(j.type==="via"||j.type==="pad"));return[...xe,...X].filter(j=>g.has(j.id)).map(j=>n.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:Vd(j.componentType)})]}),te&&n.jsx("button",{onClick:()=>{te(j.id,j.x,j.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:Se=>{Se.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:Se=>{Se.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),n.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[n.jsxs("div",{children:["Layer: ",j.layer]}),j.componentType==="IntegratedCircuit"&&n.jsxs(n.Fragment,{children:[j.description&&n.jsxs("div",{children:["Description: ",j.description]}),j.icType&&n.jsxs("div",{children:["IC Type: ",j.icType]})]}),n.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),n.jsx("input",{type:"text",value:j.notes||"",readOnly:!0,onClick:P,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[n.jsxs("span",{children:["Designator: ",j.designator||"(empty)"]}),W&&n.jsx("button",{onClick:()=>{const Se=[...xe,...X].filter(w=>g.has(w.id)&&w.componentType===j.componentType),me=Se.length,ce=F.filter(w=>u.has(w.id)&&w.type==="pad"&&w.points.length>0&&w.points[0].id!==void 0).map(w=>{const U=w.points[0].id;if(U===void 0)throw new Error("Unexpected undefined id");return{stroke:w,nodeId:U}}).sort((w,U)=>w.nodeId-U.nodeId),H=ce.length>0?ce:F.filter(w=>u.has(w.id)&&w.type==="via"&&w.points.length>0&&w.points[0].id!==void 0).map(w=>{const U=w.points[0].id;if(U===void 0)throw new Error("Unexpected undefined id");return{stroke:w,nodeId:U}}).sort((w,U)=>w.nodeId-U.nodeId),I=H.length;if(I===0){console.warn("No vias or pads with Node IDs found in selection");return}const pe=Math.floor(I/me);if(pe===0){console.warn(`Not enough ${ce.length>0?"pads":"vias"} (${I}) for ${me} components`);return}[...Se].sort((w,U)=>w.id.localeCompare(U.id)).forEach((w,U)=>{const $=U*pe,Z=$+pe,ot=H.slice($,Z).map(Gt=>Gt.nodeId.toString()),xt=Gf(w,ot,F);w.layer==="top"?Te(Gt=>Gt.map(He=>{if(He.id===w.id){const In={...He,pinCount:pe,pinConnections:ot};return xt&&(In.pinPolarities=xt),In}return He})):Ue(Gt=>Gt.map(He=>{if(He.id===w.id){const In={...He,pinCount:pe,pinConnections:ot};return xt&&(In.pinPolarities=xt),In}return He}))});const K=ce.length>0?"pads":"vias";console.log(`Connected ${me} components of type ${j.componentType} to ${I} ${K} (${pe} pins each)`)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap"},onMouseEnter:Se=>{Se.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:Se=>{Se.currentTarget.style.backgroundColor="#4CAF50"},children:"Connect"})]}),n.jsxs("div",{children:["Abbreviation: ",j.abbreviation||"(empty)"]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("span",{children:"Color:"}),n.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:j.color,border:"1px solid #ccc",borderRadius:2}}),n.jsx("span",{children:j.color})]}),n.jsxs("div",{children:["Size: ",j.size]}),n.jsxs("div",{children:["Pin Count: ",j.pinCount]}),j.componentType==="Resistor"&&n.jsxs(n.Fragment,{children:[j.resistance&&n.jsxs("div",{children:["Resistance: ",j.resistance]}),j.power&&n.jsxs("div",{children:["Power: ",j.power]}),j.tolerance&&n.jsxs("div",{children:["Tolerance: ",j.tolerance]})]}),j.componentType==="Capacitor"&&n.jsxs(n.Fragment,{children:[j.capacitance&&n.jsxs("div",{children:["Capacitance: ",j.capacitance]}),j.voltage&&n.jsxs("div",{children:["Voltage: ",j.voltage]}),j.dielectric&&n.jsxs("div",{children:["Dielectric: ",j.dielectric]}),j.tolerance&&n.jsxs("div",{children:["Tolerance: ",j.tolerance]})]}),j.componentType==="Electrolytic Capacitor"&&n.jsxs(n.Fragment,{children:[j.capacitance&&n.jsxs("div",{children:["Capacitance: ",j.capacitance]}),j.voltage&&n.jsxs("div",{children:["Voltage: ",j.voltage]}),j.tolerance&&n.jsxs("div",{children:["Tolerance: ",j.tolerance]}),j.polarity&&n.jsxs("div",{children:["Polarity: ",j.polarity]}),j.esr&&n.jsxs("div",{children:["ESR: ",j.esr]}),j.temperature&&n.jsxs("div",{children:["Temperature: ",j.temperature]})]}),j.pinConnections&&j.pinConnections.length>0&&(()=>{const Se=j.componentType==="Electrolytic Capacitor"||j.componentType==="Diode"||j.componentType==="Battery"||j.componentType==="ZenerDiode",me=j.componentType==="Capacitor"&&"dielectric"in j&&j.dielectric==="Tantalum",ce=Se||me;return n.jsxs("div",{style:{marginTop:"8px",marginBottom:"8px"},children:[n.jsx("div",{style:{marginBottom:"4px",fontWeight:600},children:"Pin Connections:"}),n.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px",border:"1px solid #ddd"},children:[n.jsx("thead",{children:n.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[n.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Pin #"}),ce&&n.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Polarity"}),n.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Node ID"})]})}),n.jsx("tbody",{children:j.pinConnections.map((H,I)=>{const pe=j.pinPolarities&&j.pinPolarities.length>I?j.pinPolarities[I]:"";return n.jsxs("tr",{style:{backgroundColor:I%2===0?"#fff":"#f9f9f9"},children:[n.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:I+1}),ce&&n.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd",textAlign:"center",fontFamily:"monospace",fontWeight:600,color:pe==="+"?"#d32f2f":pe==="-"?"#1976d2":"#999"},children:pe||"-"}),n.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:H||"(not connected)"})]},I)})})]})]})})(),"manufacturer"in j&&j.manufacturer&&n.jsxs("div",{children:["Manufacturer: ",j.manufacturer]}),"partNumber"in j&&j.partNumber&&n.jsxs("div",{children:["Part Number: ",j.partNumber]}),j.componentType==="Diode"&&n.jsxs(n.Fragment,{children:[j.diodeType&&n.jsxs("div",{children:["Type: ",j.diodeType]}),j.voltage&&n.jsxs("div",{children:["Voltage: ",j.voltage]}),j.current&&n.jsxs("div",{children:["Current: ",j.current]}),j.ledColor&&n.jsxs("div",{children:["LED Color: ",j.ledColor]})]}),j.componentType==="Battery"&&n.jsxs(n.Fragment,{children:[j.voltage&&n.jsxs("div",{children:["Voltage: ",j.voltage]}),j.capacity&&n.jsxs("div",{children:["Capacity: ",j.capacity]}),j.chemistry&&n.jsxs("div",{children:["Chemistry: ",j.chemistry]})]}),j.componentType==="Fuse"&&n.jsxs(n.Fragment,{children:[j.current&&n.jsxs("div",{children:["Current: ",j.current]}),j.voltage&&n.jsxs("div",{children:["Voltage: ",j.voltage]}),j.fuseType&&n.jsxs("div",{children:["Type: ",j.fuseType]})]}),j.componentType==="FerriteBead"&&n.jsxs(n.Fragment,{children:[j.impedance&&n.jsxs("div",{children:["Impedance: ",j.impedance]}),j.current&&n.jsxs("div",{children:["Current: ",j.current]})]}),j.componentType==="Connector"&&n.jsxs(n.Fragment,{children:[j.connectorType&&n.jsxs("div",{children:["Type: ",j.connectorType]}),j.gender&&n.jsxs("div",{children:["Gender: ",j.gender]})]}),j.componentType==="Jumper"&&n.jsx(n.Fragment,{children:j.positions&&n.jsxs("div",{children:["Positions: ",j.positions]})}),j.componentType==="Relay"&&n.jsxs(n.Fragment,{children:[j.coilVoltage&&n.jsxs("div",{children:["Coil Voltage: ",j.coilVoltage]}),j.contactType&&n.jsxs("div",{children:["Contact Type: ",j.contactType]}),j.current&&n.jsxs("div",{children:["Current: ",j.current]})]}),j.componentType==="Inductor"&&n.jsxs(n.Fragment,{children:[j.inductance&&n.jsxs("div",{children:["Inductance: ",j.inductance]}),j.current&&n.jsxs("div",{children:["Current: ",j.current]}),j.resistance&&n.jsxs("div",{children:["DC Resistance: ",j.resistance]})]}),j.componentType==="Speaker"&&n.jsxs(n.Fragment,{children:[j.impedance&&n.jsxs("div",{children:["Impedance: ",j.impedance]}),j.power&&n.jsxs("div",{children:["Power: ",j.power]})]}),j.componentType==="Motor"&&n.jsxs(n.Fragment,{children:[j.motorType&&n.jsxs("div",{children:["Type: ",j.motorType]}),j.voltage&&n.jsxs("div",{children:["Voltage: ",j.voltage]}),j.current&&n.jsxs("div",{children:["Current: ",j.current]})]}),j.componentType==="PowerSupply"&&n.jsxs(n.Fragment,{children:[j.inputVoltage&&n.jsxs("div",{children:["Input Voltage: ",j.inputVoltage]}),j.outputVoltage&&n.jsxs("div",{children:["Output Voltage: ",j.outputVoltage]}),j.current&&n.jsxs("div",{children:["Current: ",j.current]})]}),j.componentType==="Transistor"&&n.jsxs(n.Fragment,{children:[j.transistorType&&n.jsxs("div",{children:["Type: ",j.transistorType]}),j.polarity&&n.jsxs("div",{children:["Polarity: ",j.polarity]}),j.voltage&&n.jsxs("div",{children:["Voltage: ",j.voltage]}),j.current&&n.jsxs("div",{children:["Current: ",j.current]})]}),j.componentType==="ResistorNetwork"&&n.jsxs(n.Fragment,{children:[j.resistance&&n.jsxs("div",{children:["Resistance: ",j.resistance]}),j.configuration&&n.jsxs("div",{children:["Configuration: ",j.configuration]})]}),j.componentType==="Thermistor"&&n.jsxs(n.Fragment,{children:[j.resistance&&n.jsxs("div",{children:["Resistance: ",j.resistance]}),j.thermistorType&&n.jsxs("div",{children:["Type: ",j.thermistorType]}),j.beta&&n.jsxs("div",{children:["Beta: ",j.beta]})]}),j.componentType==="Switch"&&n.jsxs(n.Fragment,{children:[j.switchType&&n.jsxs("div",{children:["Type: ",j.switchType]}),j.current&&n.jsxs("div",{children:["Current: ",j.current]}),j.voltage&&n.jsxs("div",{children:["Voltage: ",j.voltage]})]}),j.componentType==="Transformer"&&n.jsxs(n.Fragment,{children:[j.primaryVoltage&&n.jsxs("div",{children:["Primary Voltage: ",j.primaryVoltage]}),j.secondaryVoltage&&n.jsxs("div",{children:["Secondary Voltage: ",j.secondaryVoltage]}),j.power&&n.jsxs("div",{children:["Power: ",j.power]}),j.turns&&n.jsxs("div",{children:["Turns Ratio: ",j.turns]})]}),j.componentType==="TestPoint"&&n.jsx(n.Fragment,{children:j.signal&&n.jsxs("div",{children:["Signal: ",j.signal]})}),j.componentType==="IntegratedCircuit"&&n.jsx(n.Fragment,{children:j.datasheet&&n.jsxs("div",{children:["Datasheet: ",n.jsx("a",{href:j.datasheet,target:"_blank",rel:"noopener noreferrer",children:j.datasheet})]})}),j.componentType==="VacuumTube"&&n.jsx(n.Fragment,{children:j.tubeType&&n.jsxs("div",{children:["Type: ",j.tubeType]})}),j.componentType==="VariableResistor"&&n.jsxs(n.Fragment,{children:[j.vrType&&n.jsxs("div",{children:["Type: ",j.vrType]}),j.resistance&&n.jsxs("div",{children:["Resistance: ",j.resistance]}),j.power&&n.jsxs("div",{children:["Power: ",j.power]}),j.taper&&n.jsxs("div",{children:["Taper: ",j.taper]})]}),j.componentType==="Crystal"&&n.jsxs(n.Fragment,{children:[j.frequency&&n.jsxs("div",{children:["Frequency: ",j.frequency]}),j.loadCapacitance&&n.jsxs("div",{children:["Load Capacitance: ",j.loadCapacitance]}),j.tolerance&&n.jsxs("div",{children:["Tolerance: ",j.tolerance]})]}),j.componentType==="ZenerDiode"&&n.jsxs(n.Fragment,{children:[j.voltage&&n.jsxs("div",{children:["Zener Voltage: ",j.voltage]}),j.power&&n.jsxs("div",{children:["Power: ",j.power]}),j.tolerance&&n.jsxs("div",{children:["Tolerance: ",j.tolerance]})]}),n.jsx("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid #eee",fontSize:"10px",color:"#999"},children:n.jsxs("div",{children:["Position: x=",j.x.toFixed(2),", y=",j.y.toFixed(2)]})})]})]},j.id))})(),u.size>0&&F.filter(W=>u.has(W.id)&&W.type==="via"&&W.points.length>0).map(W=>{const j=W.points[0],Se=W.viaType||(j.id!==void 0?se(j.id,de):"Via");return n.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:Se})]}),$e&&n.jsx("button",{onClick:()=>{$e(W.id,j.x,j.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:me=>{me.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:me=>{me.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),n.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[j.id&&n.jsxs("div",{children:["Node ID: ",j.id]}),n.jsx("div",{children:"Layer: Top and Bottom"}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("span",{children:"Color:"}),n.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:W.color,border:"1px solid #ccc",borderRadius:2}}),n.jsx("span",{children:W.color})]}),n.jsxs("div",{children:["Size: ",W.size]}),n.jsxs("div",{children:["Position: x=",j.x.toFixed(2),", y=",j.y.toFixed(2)]}),n.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),n.jsx("input",{type:"text",value:W.notes||"",readOnly:!0,onClick:P,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},W.id)}),u.size>0&&F.filter(W=>u.has(W.id)&&W.type==="pad"&&W.points.length>0).map(W=>{const j=W.points[0],Se=W.padType||(j.id!==void 0?Re(j.id,de):"Pad");return n.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:Se})]}),$e&&n.jsx("button",{onClick:()=>{$e(W.id,j.x,j.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:me=>{me.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:me=>{me.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),n.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[j.id&&n.jsxs("div",{children:["Node ID: ",j.id]}),n.jsxs("div",{children:["Layer: ",W.layer]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("span",{children:"Color:"}),n.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:W.color,border:"1px solid #ccc",borderRadius:2}}),n.jsx("span",{children:W.color})]}),n.jsxs("div",{children:["Size: ",W.size]}),n.jsxs("div",{children:["Position: x=",j.x.toFixed(2),", y=",j.y.toFixed(2)]}),n.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),n.jsx("input",{type:"text",value:W.notes||"",readOnly:!0,onClick:P,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},W.id)}),u.size>0&&F.filter(W=>u.has(W.id)&&W.type==="testPoint"&&W.points.length>0).map(W=>{const j=W.points[0],Se=j.id!==void 0?B(j.id,de):"Test Point";return n.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:Se})]}),$e&&n.jsx("button",{onClick:()=>{$e(W.id,j.x,j.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:me=>{me.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:me=>{me.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),n.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[j.id&&n.jsxs("div",{children:["Node ID: ",j.id]}),n.jsxs("div",{children:["Layer: ",W.layer]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("span",{children:"Color:"}),n.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:W.color,border:"1px solid #ccc",borderRadius:2}}),n.jsx("span",{children:W.color})]}),n.jsxs("div",{children:["Size: ",W.size]}),n.jsxs("div",{children:["Position: x=",j.x.toFixed(2),", y=",j.y.toFixed(2)]}),n.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),n.jsx("input",{type:"text",value:W.notes||"",readOnly:!0,onClick:P,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},W.id)}),u.size>0&&F.filter(W=>u.has(W.id)&&W.type==="trace").map(W=>{const j=W.points.length>0?W.points.reduce((me,ce)=>me+ce.x,0)/W.points.length:0,Se=W.points.length>0?W.points.reduce((me,ce)=>me+ce.y,0)/W.points.length:0;return n.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:W.type||"unknown"})]}),$e&&W.points.length>0&&n.jsx("button",{onClick:()=>{$e(W.id,j,Se)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:me=>{me.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:me=>{me.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),n.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[W.points.length>0&&n.jsxs("div",{style:{marginTop:"8px",marginBottom:"8px"},children:[n.jsxs("div",{style:{marginBottom:"4px",fontWeight:600},children:["Points: ",W.points.length]}),n.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px",border:"1px solid #ddd"},children:[n.jsx("thead",{children:n.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[n.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Point #"}),n.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"x"}),n.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"y"}),n.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Node ID"})]})}),n.jsx("tbody",{children:W.points.map((me,ce)=>n.jsxs("tr",{style:{backgroundColor:ce%2===0?"#fff":"#f9f9f9"},children:[n.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:ce}),n.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:me.x.toFixed(2)}),n.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:me.y.toFixed(2)}),n.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:me.id||"(none)"})]},ce))})]})]}),n.jsxs("div",{style:{marginTop:"4px"},children:["Layer: ",W.layer]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("span",{children:"Color:"}),n.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:W.color,border:"1px solid #ccc",borderRadius:2}}),n.jsx("span",{children:W.color})]}),n.jsxs("div",{children:["Size: ",W.size]}),n.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),n.jsx("input",{type:"text",value:W.notes||"",readOnly:!0,onClick:P,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},W.id)}),d.size>0&&p.filter(W=>d.has(W.id)).map(W=>{const j=de.find(Se=>Se.id===W.powerBusId);return n.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:W.type||(j?`${j.name} Power Node`:"Power Node")})]}),L&&n.jsx("button",{onClick:()=>{L(W.id,W.x,W.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:Se=>{Se.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:Se=>{Se.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),n.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[n.jsxs("div",{children:["Node ID: ",W.pointId||"(not assigned)"]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("span",{children:"Color:"}),n.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:W.color,border:"1px solid #ccc",borderRadius:2}}),n.jsx("span",{children:W.color})]}),n.jsxs("div",{children:["Size: ",W.size]}),n.jsxs("div",{children:["Layer: ",W.layer]}),n.jsxs("div",{children:["Power Bus: ",j?.name||W.powerBusId||"(unknown)"]}),n.jsxs("div",{children:["Position: x=",W.x.toFixed(2),", y=",W.y.toFixed(2)]}),n.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),n.jsx("input",{type:"text",value:W.notes||"",readOnly:!0,onClick:P,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},W.id)}),R.size>0&&V.filter(W=>R.has(W.id)).map(W=>n.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:W.type||"Ground Node"})]}),re&&n.jsx("button",{onClick:()=>{re(W.id,W.x,W.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:j=>{j.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:j=>{j.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),n.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[n.jsxs("div",{children:["Node ID: ",W.pointId||"(not assigned)"]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("span",{children:"Color:"}),n.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:W.color,border:"1px solid #ccc",borderRadius:2}}),n.jsx("span",{children:W.color})]}),n.jsxs("div",{children:["Size: ",W.size]}),n.jsxs("div",{children:["Position: x=",W.x.toFixed(2),", y=",W.y.toFixed(2)]}),n.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),n.jsx("input",{type:"text",value:W.notes||"",readOnly:!0,onClick:P,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},W.id))]})})]})},En=200,Sx=({visible:c,selectedIds:u,selectedComponentIds:g,selectedPowerIds:d,selectedGroundIds:R,drawingStrokes:F,componentsTop:xe,componentsBottom:X,powers:p,grounds:V,powerBuses:de,onClose:ge,setComponentsTop:Te,setComponentsBottom:Ue,setDrawingStrokes:se,setPowerSymbols:Re,setGroundSymbols:B,determineViaType:te,determinePadType:$e,determineTestPointType:L,position:re,isDragging:N,onDragStart:z})=>{const[D,P]=m.useState(new Map),O=m.useRef(""),he=()=>[...Array.from(u).sort(),...Array.from(g).sort(),...Array.from(d).sort(),...Array.from(R).sort()].join(",");if(m.useEffect(()=>{if(!c)return;const K=he();K!==O.current&&(O.current=K,P(w=>{const U=new Map;return[...xe,...X].filter($=>g.has($.id)).forEach($=>{const Z=w.get($.id);U.set($.id,Z!==void 0?Z:$.notes||"")}),F.filter($=>u.has($.id)).forEach($=>{const Z=w.get($.id);U.set($.id,Z!==void 0?Z:$.notes||"")}),p.filter($=>d.has($.id)).forEach($=>{const Z=w.get($.id);U.set($.id,Z!==void 0?Z:$.notes||"")}),V.filter($=>R.has($.id)).forEach($=>{const Z=w.get($.id);U.set($.id,Z!==void 0?Z:$.notes||"")}),U}))},[c,u,g,d,R,F,xe,X,p,V]),!c)return null;const W=re?{position:"fixed",left:`${re.x}px`,top:`${re.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"150px",maxWidth:"400px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:N?"grabbing":"default"}:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"flex-start",justifyContent:"flex-end",paddingRight:"20px",paddingTop:"80px",zIndex:1e4,pointerEvents:"none"},j={padding:"20px",overflow:"auto",flex:1},Se=F.filter(K=>u.has(K.id)).length,me=[...xe,...X].filter(K=>g.has(K.id)).length,ce=p.filter(K=>d.has(K.id)).length,H=V.filter(K=>R.has(K.id)).length,I=Se+me+ce+H,pe=(K,w)=>{const U=w.length>En?w.substring(0,En):w;P($=>{const Z=new Map($);return Z.set(K,U),Z})},Be=()=>{Te(K=>K.map(w=>{if(g.has(w.id)&&D.has(w.id)){const U=D.get(w.id)||"";return{...w,notes:U.trim()===""?null:U.trim()}}return w})),Ue(K=>K.map(w=>{if(g.has(w.id)&&D.has(w.id)){const U=D.get(w.id)||"";return{...w,notes:U.trim()===""?null:U.trim()}}return w})),se(K=>K.map(w=>{if(u.has(w.id)&&D.has(w.id)){const U=D.get(w.id)||"";return{...w,notes:U.trim()===""?null:U.trim()}}return w})),Re(K=>K.map(w=>{if(d.has(w.id)&&D.has(w.id)){const U=D.get(w.id)||"";return{...w,notes:U.trim()===""?null:U.trim()}}return w})),B(K=>K.map(w=>{if(R.has(w.id)&&D.has(w.id)){const U=D.get(w.id)||"";return{...w,notes:U.trim()===""?null:U.trim()}}return w}))};return n.jsxs("div",{style:W,children:[n.jsxs("div",{onMouseDown:K=>{const w=K.target;w.tagName==="BUTTON"||w.closest("button")||re&&z(K)},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:N?"grabbing":re?"grab":"default",userSelect:"none",flexShrink:0},children:[n.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Notes (N)"}),n.jsx("button",{onClick:ge,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),n.jsx("div",{style:j,children:n.jsxs("div",{style:{margin:0,padding:0,backgroundColor:"#f5f5f5",borderRadius:4,fontSize:"12px",fontFamily:"monospace",maxHeight:"calc(80vh - 100px)",overflow:"auto",color:"#000"},children:[n.jsx("div",{style:{padding:"12px 16px",backgroundColor:I>0?"#e8e8e8":"#fff3cd",borderBottom:"2px solid #ccc",fontSize:"13px",fontWeight:600,color:I>0?"#333":"#856404",marginBottom:"8px"},children:I>0?`${I} Object${I!==1?"s":""} Selected`:"Zero Objects Selected"}),I===0?n.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"No objects selected. Select one or more objects to add or edit notes."}):n.jsxs(n.Fragment,{children:[[...xe,...X].filter(K=>g.has(K.id)).map(K=>{const w=D.get(K.id)||"",U=w.length;return n.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),n.jsxs("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:[Vd(K.componentType),K.designator&&K.designator.trim()?` (${K.designator.trim()})`:""]})]}),n.jsxs("div",{style:{padding:"8px"},children:[n.jsx("textarea",{value:w,onChange:$=>pe(K.id,$.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:En,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),n.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:U>=En?"#d32f2f":"#666",textAlign:"right"},children:[U," / ",En]})]})]},K.id)}),F.filter(K=>u.has(K.id)&&K.type==="via"&&K.points.length>0).map(K=>{const w=K.points[0],U=K.viaType||(w.id!==void 0?te(w.id,de):"Via"),$=D.get(K.id)||"",Z=$.length;return n.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:U})]}),n.jsxs("div",{style:{padding:"8px"},children:[n.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:w.id&&n.jsxs("div",{children:["Node ID: ",w.id]})}),n.jsx("textarea",{value:$,onChange:Ie=>pe(K.id,Ie.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:En,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),n.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Z>=En?"#d32f2f":"#666",textAlign:"right"},children:[Z," / ",En]})]})]},K.id)}),F.filter(K=>u.has(K.id)&&K.type==="pad"&&K.points.length>0).map(K=>{const w=K.points[0],U=K.padType||(w.id!==void 0?$e(w.id,de):"Pad"),$=D.get(K.id)||"",Z=$.length;return n.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:U})]}),n.jsxs("div",{style:{padding:"8px"},children:[n.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:w.id&&n.jsxs("div",{children:["Node ID: ",w.id]})}),n.jsx("textarea",{value:$,onChange:Ie=>pe(K.id,Ie.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:En,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),n.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Z>=En?"#d32f2f":"#666",textAlign:"right"},children:[Z," / ",En]})]})]},K.id)}),F.filter(K=>u.has(K.id)&&K.type==="testPoint"&&K.points.length>0).map(K=>{const w=K.points[0],U=w.id!==void 0?L(w.id,de):"Test Point",$=D.get(K.id)||"",Z=$.length;return n.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:U})]}),n.jsxs("div",{style:{padding:"8px"},children:[n.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:w.id&&n.jsxs("div",{children:["Node ID: ",w.id]})}),n.jsx("textarea",{value:$,onChange:Ie=>pe(K.id,Ie.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:En,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),n.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Z>=En?"#d32f2f":"#666",textAlign:"right"},children:[Z," / ",En]})]})]},K.id)}),F.filter(K=>u.has(K.id)&&K.type==="trace").map(K=>{const w=D.get(K.id)||"",U=w.length;return n.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:K.type||"unknown"})]}),n.jsxs("div",{style:{padding:"8px"},children:[n.jsx("textarea",{value:w,onChange:$=>pe(K.id,$.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:En,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),n.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:U>=En?"#d32f2f":"#666",textAlign:"right"},children:[U," / ",En]})]})]},K.id)}),p.filter(K=>d.has(K.id)).map(K=>{const w=de.find(Ie=>Ie.id===K.powerBusId),U=K.type||(w?`${w.name} Power Node`:"Power Node"),$=D.get(K.id)||"",Z=$.length;return n.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:U})]}),n.jsxs("div",{style:{padding:"8px"},children:[n.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:n.jsxs("div",{children:["Node ID: ",K.pointId||"(not assigned)"]})}),n.jsx("textarea",{value:$,onChange:Ie=>pe(K.id,Ie.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:En,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),n.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Z>=En?"#d32f2f":"#666",textAlign:"right"},children:[Z," / ",En]})]})]},K.id)}),V.filter(K=>R.has(K.id)).map(K=>{const w=K.type||"Ground Node",U=D.get(K.id)||"",$=U.length;return n.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[n.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[n.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),n.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:w})]}),n.jsxs("div",{style:{padding:"8px"},children:[n.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:n.jsxs("div",{children:["Node ID: ",K.pointId||"(not assigned)"]})}),n.jsx("textarea",{value:U,onChange:Z=>pe(K.id,Z.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:En,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),n.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:$>=En?"#d32f2f":"#666",textAlign:"right"},children:[$," / ",En]})]})]},K.id)}),n.jsxs("div",{style:{marginTop:"20px",padding:"12px",display:"flex",justifyContent:"flex-end",gap:"8px",borderTop:"1px solid #ddd"},children:[n.jsx("button",{onClick:ge,style:{padding:"8px 16px",fontSize:"12px",backgroundColor:"#757575",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500},onMouseEnter:K=>{K.currentTarget.style.backgroundColor="#616161"},onMouseLeave:K=>{K.currentTarget.style.backgroundColor="#757575"},children:"Close"}),n.jsx("button",{onClick:Be,style:{padding:"8px 16px",fontSize:"12px",backgroundColor:"#2196F3",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500},onMouseEnter:K=>{K.currentTarget.style.backgroundColor="#1976D2"},onMouseLeave:K=>{K.currentTarget.style.backgroundColor="#2196F3"},children:"Save"})]})]})]})})]})},wx=({visible:c,projectNotes:u,setProjectNotes:g,onClose:d,position:R,isDragging:F,onDragStart:xe})=>{const[X,p]=m.useState([]),[V,de]=m.useState(null),[ge,Te]=m.useState(null),Ue=m.useRef(new Map),[se,Re]=m.useState({width:Math.min(window.innerWidth*.85,1400),height:window.innerHeight*.7}),[B,te]=m.useState(!1),[$e,L]=m.useState({x:0,y:0,width:0,height:0});m.useEffect(()=>{c&&(p([...u]),de(null),Te(null))},[c,u]),m.useEffect(()=>{if(!B)return;const ce=I=>{const pe=I.clientX-$e.x,Be=I.clientY-$e.y,K=Math.max(400,Math.min(window.innerWidth-20,$e.width+pe)),w=Math.max(300,Math.min(window.innerHeight-20,$e.height+Be));Re({width:K,height:w})},H=()=>{te(!1)};return document.addEventListener("mousemove",ce),document.addEventListener("mouseup",H),()=>{document.removeEventListener("mousemove",ce),document.removeEventListener("mouseup",H)}},[B,$e]);const re=ce=>{ce.preventDefault(),ce.stopPropagation(),te(!0),L({x:ce.clientX,y:ce.clientY,width:se.width,height:se.height})};if(!c)return null;const N=()=>{const ce={name:"",value:"",checked:!1};p([...X,ce]),de(X.length),Te("name")},z=ce=>{const H=X.filter((I,pe)=>pe!==ce);p(H),V===ce?(de(null),Te(null)):V!==null&&V>ce&&de(V-1)},D=()=>{const ce=X.filter(H=>H.name.trim()!==""||H.value.trim()!=="");g(ce),d()},P=()=>{p([...u]),de(null),Te(null),d()},O=(ce,H,I)=>{const pe=[...X];pe[ce]={...pe[ce],[H]:I},p(pe)},he=(ce,H)=>{const I=[...X];I[ce]={...I[ce],checked:H},p(I)},W=(ce,H,I)=>{ce.stopPropagation();const pe=ce.currentTarget,Be=pe.selectionStart,K=pe.value.length,w=pe.selectionStart!==pe.selectionEnd;if(!(ce.key==="Enter"&&ce.altKey)){if(ce.key==="ArrowRight"&&!ce.ctrlKey&&!ce.shiftKey&&!ce.altKey){if(Be===K&&!w&&I==="name"){ce.preventDefault();const U=`${H}-value`,$=Ue.current.get(U);$&&($.focus(),$.setSelectionRange(0,0))}return}if(ce.key==="ArrowLeft"&&!ce.ctrlKey&&!ce.shiftKey&&!ce.altKey){if(Be===0&&!w&&I==="value"){ce.preventDefault();const U=`${H}-name`,$=Ue.current.get(U);$&&($.focus(),$.setSelectionRange($.value.length,$.value.length))}return}if(ce.key==="ArrowDown"&&!ce.ctrlKey&&!ce.shiftKey&&!ce.altKey){if(ce.preventDefault(),H<X.length-1){const U=`${H+1}-${I}`,$=Ue.current.get(U);if($){$.focus();const Z=Math.min(Be,$.value.length);$.setSelectionRange(Z,Z)}}else{const U=X.length;N(),setTimeout(()=>{const $=`${U}-${I}`,Z=Ue.current.get($);Z&&(Z.focus(),Z.setSelectionRange(0,0))},0)}return}if(ce.key==="ArrowUp"&&!ce.ctrlKey&&!ce.shiftKey&&!ce.altKey){if(ce.preventDefault(),H>0){const U=`${H-1}-${I}`,$=Ue.current.get(U);if($){$.focus();const Z=Math.min(Be,$.value.length);$.setSelectionRange(Z,Z)}}return}if(ce.key==="Enter"&&!ce.altKey&&!ce.shiftKey){if(ce.preventDefault(),I==="name"){const U=`${H}-value`,$=Ue.current.get(U);$&&($.focus(),$.setSelectionRange(0,0))}else if(I==="value")if(H<X.length-1){const U=`${H+1}-name`,$=Ue.current.get(U);$&&($.focus(),$.setSelectionRange(0,0))}else{const U=X.length;N(),setTimeout(()=>{const $=`${U}-name`,Z=Ue.current.get($);Z&&(Z.focus(),Z.setSelectionRange(0,0))},0)}return}if(ce.key==="Tab"&&!ce.shiftKey){if(ce.preventDefault(),I==="name"){const U=`${H}-value`,$=Ue.current.get(U);$&&($.focus(),$.select())}else if(I==="value")if(H<X.length-1){const U=`${H+1}-name`,$=Ue.current.get(U);$&&($.focus(),$.select())}else{const U=X.length;N(),setTimeout(()=>{const $=`${U}-name`,Z=Ue.current.get($);Z&&Z.focus()},0)}return}if(ce.key==="Tab"&&ce.shiftKey){if(ce.preventDefault(),I==="value"){const U=`${H}-name`,$=Ue.current.get(U);$&&($.focus(),$.select())}else if(I==="name"&&H>0){const U=`${H-1}-value`,$=Ue.current.get(U);$&&($.focus(),$.select())}return}}},j=(ce,H)=>{de(ce),Te(H)},Se=()=>{},me={position:"fixed",top:R?.y??100,left:R?.x??(window.innerWidth-se.width)/2,width:`${se.width}px`,height:`${se.height}px`,backgroundColor:"#fff",borderRadius:8,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:F?"grabbing":"default",overflow:"hidden"};return n.jsxs("div",{style:me,children:[n.jsxs("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e0e0",background:"#888",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"move",userSelect:"none"},onMouseDown:xe,children:[n.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Project Notes / TODO List (L)"}),n.jsx("button",{onClick:P,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:"0 4px",lineHeight:1},title:"Close",children:""})]}),n.jsxs("div",{className:"project-notes-content",style:{padding:0,flex:1,overflowY:"auto",overflowX:"hidden",display:"flex",flexDirection:"column",minHeight:0,scrollbarWidth:"thin",scrollbarColor:"#888 #f0f0f0"},children:[n.jsxs("div",{style:{border:"none",borderTop:"1px solid #ccc",borderRadius:0,overflow:"visible",marginBottom:"16px",backgroundColor:"#e0e0e0",flexShrink:0},children:[n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"40px 1fr 3fr auto",backgroundColor:"#e0e0e0",borderBottom:"1px solid #ccc",position:"sticky",top:0,zIndex:10},children:[n.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",display:"flex",alignItems:"center",justifyContent:"center",color:"#000"},children:n.jsx("label",{className:"radio-label",style:{margin:0,cursor:"default"},children:n.jsx("input",{type:"checkbox",disabled:!0,style:{opacity:.5}})})}),n.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",color:"#000"},children:"Item"}),n.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",color:"#000"},children:"Notes"}),n.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",color:"#000"}})]}),n.jsx("div",{children:X.length===0?n.jsx("div",{style:{padding:"24px",textAlign:"center",color:"#999",fontSize:"13px"},children:'No notes. Click "Add Note" to create one.'}):X.map((ce,H)=>n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"40px 1fr 3fr auto",borderBottom:"1px solid #ccc",backgroundColor:"#fff"},children:[n.jsx("div",{style:{padding:"8px 12px",borderRight:"1px solid #ccc",display:"flex",alignItems:"center",justifyContent:"center"},children:n.jsx("label",{className:"radio-label",style:{margin:0,cursor:"pointer"},children:n.jsx("input",{type:"checkbox",checked:ce.checked||!1,onChange:I=>he(H,I.target.checked)})})}),n.jsx("div",{style:{padding:"4px",borderRight:"1px solid #ccc"},children:n.jsx("textarea",{ref:I=>{I?Ue.current.set(`${H}-name`,I):Ue.current.delete(`${H}-name`)},value:ce.name,onChange:I=>O(H,"name",I.target.value),onFocus:()=>j(H,"name"),onBlur:Se,onKeyDown:I=>W(I,H,"name"),placeholder:"Item name...",rows:1,style:{width:"100%",padding:"4px 6px",border:V===H&&ge==="name"?"2px solid #0b5fff":"1px solid transparent",borderRadius:3,fontSize:"12px",backgroundColor:"#fff",color:"#000",fontFamily:"inherit",resize:"none",minHeight:"24px",lineHeight:"1.4",overflow:"hidden",outline:"none",boxSizing:"border-box"},onInput:I=>{const pe=I.target;pe.style.height="auto",pe.style.height=`${pe.scrollHeight}px`}})}),n.jsx("div",{style:{padding:"4px",borderRight:"1px solid #ccc"},children:n.jsx("textarea",{ref:I=>{I?Ue.current.set(`${H}-value`,I):Ue.current.delete(`${H}-value`)},value:ce.value,onChange:I=>O(H,"value",I.target.value),onFocus:()=>j(H,"value"),onBlur:Se,onKeyDown:I=>W(I,H,"value"),placeholder:"Notes...",rows:1,style:{width:"100%",padding:"4px 6px",border:V===H&&ge==="value"?"2px solid #0b5fff":"1px solid transparent",borderRadius:3,fontSize:"12px",backgroundColor:"#fff",color:"#000",fontFamily:"inherit",resize:"none",minHeight:"24px",lineHeight:"1.4",overflow:"hidden",outline:"none",boxSizing:"border-box"},onInput:I=>{const pe=I.target;pe.style.height="auto",pe.style.height=`${pe.scrollHeight}px`}})}),n.jsx("div",{style:{padding:"8px 12px",display:"flex",alignItems:"center",justifyContent:"center"},children:n.jsx("button",{onClick:()=>z(H),style:{background:"#f44336",color:"#fff",border:"none",borderRadius:3,padding:"4px 8px",cursor:"pointer",fontSize:"11px"},title:"Delete note",children:"Delete"})})]},H))})]}),n.jsx("div",{style:{padding:"16px",flexShrink:0},children:n.jsx("button",{onClick:N,style:{background:"#888",color:"#fff",border:"none",borderRadius:4,padding:"8px 16px",cursor:"pointer",fontSize:"12px",fontWeight:500,alignSelf:"flex-start"},children:"+ Add Note"})})]}),n.jsxs("div",{style:{padding:"12px 16px",borderTop:"1px solid #ddd",display:"flex",justifyContent:"flex-end",gap:"8px",flexShrink:0},children:[n.jsx("button",{onClick:P,style:{background:"#f5f5f5",color:"#000",border:"1px solid #ddd",borderRadius:4,padding:"6px 16px",cursor:"pointer",fontSize:"12px"},children:"Cancel"}),n.jsx("button",{onClick:D,style:{background:"#0b5fff",color:"#fff",border:"none",borderRadius:4,padding:"6px 16px",cursor:"pointer",fontSize:"12px",fontWeight:500},children:"Save"})]}),n.jsx("div",{onMouseDown:re,style:{position:"absolute",bottom:0,right:0,width:"20px",height:"20px",cursor:"nwse-resize",background:"linear-gradient(135deg, transparent 0%, transparent 40%, #ccc 40%, #ccc 45%, transparent 45%, transparent 55%, #ccc 55%, #ccc 60%, transparent 60%)",zIndex:10001},title:"Drag to resize"})]})},jx=({visible:c,dimensions:u,onSave:g,onClose:d})=>{const[R,F]=m.useState(""),[xe,X]=m.useState(""),[p,V]=m.useState("inches");m.useEffect(()=>{c&&u?(F(u.width.toString()),X(u.height.toString()),V(u.unit)):c&&(F(""),X(""),V("inches"))},[c,u]);const de=()=>{const Te=parseFloat(R),Ue=parseFloat(xe);if(isNaN(Te)||Te<=0){alert("Please enter a valid width greater than 0");return}if(isNaN(Ue)||Ue<=0){alert("Please enter a valid height greater than 0");return}g({width:Te,height:Ue,unit:p}),d()},ge=()=>{d()};return c?n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:Te=>{Te.target===Te.currentTarget&&ge()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"320px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #444"},onClick:Te=>Te.stopPropagation(),children:[n.jsx("h3",{style:{margin:"0 0 20px 0",color:"#fff",fontSize:"18px",fontWeight:600},children:"Board Dimensions"}),n.jsxs("div",{style:{marginBottom:"16px"},children:[n.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#ddd",fontSize:"14px"},children:"Width"}),n.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[n.jsx("input",{type:"number",step:"0.001",min:"0.001",value:R,onChange:Te=>F(Te.target.value),style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px"},placeholder:"0.000"}),n.jsxs("select",{value:p,onChange:Te=>V(Te.target.value),style:{padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px",cursor:"pointer"},children:[n.jsx("option",{value:"inches",children:"inches"}),n.jsx("option",{value:"mm",children:"mm"})]})]})]}),n.jsxs("div",{style:{marginBottom:"20px"},children:[n.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#ddd",fontSize:"14px"},children:"Height"}),n.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[n.jsx("input",{type:"number",step:"0.001",min:"0.001",value:xe,onChange:Te=>X(Te.target.value),style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px"},placeholder:"0.000"}),n.jsxs("select",{value:p,onChange:Te=>V(Te.target.value),style:{padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px",cursor:"pointer"},children:[n.jsx("option",{value:"inches",children:"inches"}),n.jsx("option",{value:"mm",children:"mm"})]})]})]}),n.jsx("div",{style:{marginBottom:"12px",padding:"10px",background:"#1f1f24",borderRadius:4,fontSize:"12px",color:"#bbb"},children:"This information will be used to convert pixel coordinates to real-world measurements."}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[n.jsx("button",{onClick:ge,style:{padding:"8px 16px",background:"#444",color:"#fff",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px"},children:"Cancel"}),n.jsx("button",{onClick:de,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Save"})]})]})}):null},Tx=({visible:c,onClose:u,topImage:g,bottomImage:d,selectedImageForTransform:R,setSelectedImageForTransform:F,transformMode:xe,setTransformMode:X,updateImageTransform:p,resetImageTransform:V,setCurrentTool:de,isGrayscale:ge,setIsGrayscale:Te,areImagesLocked:Ue})=>{const[se,Re]=m.useState(null),[B,te]=m.useState(!1),$e=m.useRef({x:0,y:0}),L=m.useRef(null);m.useEffect(()=>{c&&se===null&&Re({x:window.innerWidth-320-20,y:80})},[c,se]),m.useEffect(()=>{c||Re(null)},[c]);const re=m.useCallback(Z=>{if(L.current){const Ie=L.current.getBoundingClientRect();$e.current={x:Z.clientX-Ie.left,y:Z.clientY-Ie.top},te(!0)}},[]);if(m.useEffect(()=>{if(!B)return;const Z=ot=>{const xt=ot.clientX-$e.current.x,Gt=ot.clientY-$e.current.y,He=L.current?.offsetWidth||320,In=L.current?.offsetHeight||600,Un=Math.max(0,Math.min(xt,window.innerWidth-He)),Ui=Math.max(0,Math.min(Gt,window.innerHeight-In));Re({x:Un,y:Ui})},Ie=()=>{te(!1)};return document.addEventListener("mousemove",Z),document.addEventListener("mouseup",Ie),()=>{document.removeEventListener("mousemove",Z),document.removeEventListener("mouseup",Ie)}},[B]),!c)return null;const N=g!==null,z=d!==null,D=N||z,P=N&&z,O=R||(N?"top":z?"bottom":null),he=()=>O==="top"&&g?g.brightness??100:O==="bottom"&&d?d.brightness??100:O==="both"&&g?g.brightness??100:100,W=()=>O==="top"&&g?g.contrast??100:O==="bottom"&&d?d.contrast??100:O==="both"&&g?g.contrast??100:100,j=he(),Se=W(),me=!D||Ue,ce=()=>{if(!(!O||me))if(O==="both"){const Z=!g?.flipX;p("both",{flipX:Z})}else{const Z=O==="top"?g?.flipX||!1:d?.flipX||!1;p(O,{flipX:!Z})}},H=()=>{if(!(!O||me))if(O==="both"){const Z=!g?.flipY;p("both",{flipY:Z})}else{const Z=O==="top"?g?.flipY||!1:d?.flipY||!1;p(O,{flipY:!Z})}},I=Z=>{me||(O&&F(O),X(Z),de("transform"))},pe=Z=>{!O||me||p(O,{brightness:Z})},Be=Z=>{!O||me||p(O,{contrast:Z})},K=()=>{me||(O&&F(O),de("transform"),Te(!ge))},w=()=>{me||(de("transform"),V())},U=(Z,Ie=!1)=>({display:"block",width:"100%",textAlign:"left",padding:"8px 12px",color:Z?"#666":"#f2f2f2",background:Ie?"#3a3a42":"transparent",border:"none",borderRadius:4,cursor:Z?"not-allowed":"pointer",fontSize:"13px",transition:"background 0.15s"}),$=(Z,Ie)=>({display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",color:Z?"#666":"#f2f2f2",cursor:Z?"not-allowed":"pointer",fontSize:"13px",background:Ie?"#3a3a42":"transparent",borderRadius:4,transition:"background 0.15s"});return n.jsxs("div",{ref:L,style:{position:"fixed",top:se?.y??80,left:se?.x??window.innerWidth-340,backgroundColor:"#2b2b31",borderRadius:8,minWidth:"320px",maxWidth:"400px",maxHeight:"calc(100vh - 100px)",overflowY:"auto",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24",zIndex:10001},children:[n.jsxs("div",{onMouseDown:re,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 16px",background:"linear-gradient(to bottom, #3a3a42, #2b2b31)",borderTopLeftRadius:8,borderTopRightRadius:8,borderBottom:"1px solid #1f1f24",cursor:B?"grabbing":"grab",userSelect:"none"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[n.jsx("span",{style:{color:"#888",fontSize:"14px"},children:""}),n.jsx("h2",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#f2f2f2"},children:"Transform Images"})]}),n.jsx("button",{onClick:u,style:{background:"transparent",border:"none",color:"#888",fontSize:"16px",cursor:"pointer",padding:"2px 6px",lineHeight:1,borderRadius:4},onMouseEnter:Z=>{Z.currentTarget.style.background="#444",Z.currentTarget.style.color="#fff"},onMouseLeave:Z=>{Z.currentTarget.style.background="transparent",Z.currentTarget.style.color="#888"},children:""})]}),n.jsxs("div",{style:{padding:"16px"},children:[n.jsxs("div",{style:{marginBottom:"16px"},children:[n.jsx("div",{style:{fontSize:"12px",color:"#888",marginBottom:"8px",fontWeight:500},children:"Apply to:"}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[n.jsxs("label",{style:$(!N,O==="top"),children:[n.jsx("input",{type:"radio",name:"imageSelection",checked:O==="top",onChange:()=>F("top"),disabled:!N,style:{accentColor:"#6b9fff"}}),"Top Image",!N&&n.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(not loaded)"})]}),n.jsxs("label",{style:$(!z,O==="bottom"),children:[n.jsx("input",{type:"radio",name:"imageSelection",checked:O==="bottom",onChange:()=>F("bottom"),disabled:!z,style:{accentColor:"#6b9fff"}}),"Bottom Image",!z&&n.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(not loaded)"})]}),n.jsxs("label",{style:$(!P,O==="both"),children:[n.jsx("input",{type:"radio",name:"imageSelection",checked:O==="both",onChange:()=>F("both"),disabled:!P,style:{accentColor:"#6b9fff"}}),"Both Images",!P&&n.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(need both)"})]})]})]}),n.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),n.jsxs("div",{style:{marginBottom:"12px"},children:[n.jsx("button",{onClick:ce,disabled:me,style:U(me),onMouseEnter:Z=>!me&&(Z.currentTarget.style.background="#3a3a42"),onMouseLeave:Z=>Z.currentTarget.style.background="transparent",children:"Horizontal Flip"}),n.jsx("button",{onClick:H,disabled:me,style:U(me),onMouseEnter:Z=>!me&&(Z.currentTarget.style.background="#3a3a42"),onMouseLeave:Z=>Z.currentTarget.style.background="transparent",children:"Vertical Flip"})]}),n.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),n.jsx("div",{style:{marginBottom:"12px"},children:["nudge","scale","rotate","slant","keystone"].map(Z=>n.jsxs("button",{onClick:()=>I(Z),disabled:me,style:U(me,xe===Z),onMouseEnter:Ie=>!me&&xe!==Z&&(Ie.currentTarget.style.background="#3a3a42"),onMouseLeave:Ie=>xe!==Z&&(Ie.currentTarget.style.background="transparent"),children:[xe===Z?" ":"","Mode: ",Z.charAt(0).toUpperCase()+Z.slice(1)]},Z))}),n.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),n.jsxs("div",{style:{marginBottom:"16px"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[n.jsx("label",{style:{color:"#f2f2f2",fontSize:"13px",fontWeight:500},children:"Brightness"}),n.jsxs("span",{style:{color:"#888",fontSize:"12px",minWidth:"45px",textAlign:"right"},children:[j,"%"]})]}),n.jsx("input",{type:"range",min:"0",max:"200",step:"1",value:j,onChange:Z=>pe(parseInt(Z.target.value,10)),disabled:me,style:{width:"100%",cursor:me?"not-allowed":"pointer",accentColor:"#6b9fff"}})]}),n.jsxs("div",{style:{marginBottom:"16px"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[n.jsx("label",{style:{color:"#f2f2f2",fontSize:"13px",fontWeight:500},children:"Contrast"}),n.jsxs("span",{style:{color:"#888",fontSize:"12px",minWidth:"45px",textAlign:"right"},children:[Se,"%"]})]}),n.jsx("input",{type:"range",min:"0",max:"200",step:"1",value:Se,onChange:Z=>Be(parseInt(Z.target.value,10)),disabled:me,style:{width:"100%",cursor:me?"not-allowed":"pointer",accentColor:"#6b9fff"}})]}),n.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),n.jsx("div",{style:{marginBottom:"12px"},children:n.jsxs("button",{onClick:K,disabled:me,style:U(me,ge),onMouseEnter:Z=>!me&&!ge&&(Z.currentTarget.style.background="#3a3a42"),onMouseLeave:Z=>!ge&&(Z.currentTarget.style.background="transparent"),children:[ge?" ":"","Grayscale Mode"]})}),n.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[n.jsx("button",{onClick:w,disabled:me,style:{padding:"8px 16px",background:me?"#444":"#555",color:me?"#777":"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:me?"not-allowed":"pointer",fontSize:"13px",fontWeight:500},children:"Reset Transform"}),n.jsx("button",{onClick:u,style:{padding:"8px 16px",background:"#4a9eff",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:500},onMouseEnter:Z=>Z.currentTarget.style.background="#3a8ee6",onMouseLeave:Z=>Z.currentTarget.style.background="#4a9eff",children:"Close"})]}),Ue&&n.jsx("div",{style:{marginTop:"12px",padding:"8px 12px",background:"#3d2b2b",border:"1px solid #5a3a3a",borderRadius:4,fontSize:"12px",color:"#e88"},children:" Images are locked. Unlock via Images  Lock Images to make changes."})]})]})},Cx=({component:c,componentEditor:u,setComponentEditor:g,areComponentsLocked:d,componentsTop:R,componentsBottom:F,setComponentsTop:xe,setComponentsBottom:X})=>n.jsxs(n.Fragment,{children:[c.componentType==="Resistor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-resistance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),n.jsx("input",{id:`component-resistance-${c.id}`,type:"text",value:u.resistance||"",onChange:p=>g({...u,resistance:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 10"}),n.jsx("select",{value:u.resistanceUnit||Le("resistance"),onChange:p=>g({...u,resistanceUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("resistance").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-power-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),n.jsxs("select",{id:`component-power-${c.id}`,value:u.power||"1/4",onChange:p=>g({...u,power:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"12px"},children:[n.jsx("option",{value:"1/20",children:"1/20 W"}),n.jsx("option",{value:"1/16",children:"1/16 W"}),n.jsx("option",{value:"1/10",children:"1/10 W"}),n.jsx("option",{value:"1/8",children:"1/8 W"}),n.jsx("option",{value:"1/4",children:"1/4 W"}),n.jsx("option",{value:"1/2",children:"1/2 W"}),n.jsx("option",{value:"1",children:"1 W"}),n.jsx("option",{value:"2",children:"2 W"}),n.jsx("option",{value:"3",children:"3 W"}),n.jsx("option",{value:"5",children:"5 W"}),n.jsx("option",{value:"10",children:"10 W"}),n.jsx("option",{value:"25",children:"25 W"}),n.jsx("option",{value:"50",children:"50 W"}),n.jsx("option",{value:"100",children:"100 W"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-tolerance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),n.jsxs("select",{id:`component-tolerance-${c.id}`,value:u.tolerance||"5%",onChange:p=>g({...u,tolerance:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"0.05%",children:"0.05%"}),n.jsx("option",{value:"0.1%",children:"0.1%"}),n.jsx("option",{value:"0.25%",children:"0.25%"}),n.jsx("option",{value:"0.5%",children:"0.5%"}),n.jsx("option",{value:"1%",children:"1%"}),n.jsx("option",{value:"2%",children:"2%"}),n.jsx("option",{value:"5%",children:"5%"}),n.jsx("option",{value:"10%",children:"10%"}),n.jsx("option",{value:"20%",children:"20%"})]})]})]}),c.componentType==="Capacitor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-capacitance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),n.jsx("input",{id:`component-capacitance-${c.id}`,type:"text",value:u.capacitance||"",onChange:p=>g({...u,capacitance:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 100"}),n.jsx("select",{value:u.capacitanceUnit||Le("capacitance"),onChange:p=>g({...u,capacitanceUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("capacitance").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:p=>g({...u,voltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 50"}),n.jsx("select",{value:u.voltageUnit||Le("voltage"),onChange:p=>g({...u,voltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-dielectric-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Dielectric:"}),n.jsxs("select",{id:`component-dielectric-${c.id}`,value:u.dielectric||"Ceramic",onChange:p=>g({...u,dielectric:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Ceramic",children:"Ceramic"}),n.jsx("option",{value:"Tantalum",children:"Tantalum"}),n.jsx("option",{value:"Film",children:"Film"}),n.jsx("option",{value:"Polyester",children:"Polyester"}),n.jsx("option",{value:"Polypropylene",children:"Polypropylene"}),n.jsx("option",{value:"Mica",children:"Mica"}),n.jsx("option",{value:"Paper",children:"Paper"}),n.jsx("option",{value:"Glass",children:"Glass"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-tolerance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),n.jsxs("select",{id:`component-tolerance-${c.id}`,value:u.tolerance||"10%",onChange:p=>g({...u,tolerance:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"0.5%",children:"0.5%"}),n.jsx("option",{value:"1%",children:"1%"}),n.jsx("option",{value:"2%",children:"2%"}),n.jsx("option",{value:"5%",children:"5%"}),n.jsx("option",{value:"10%",children:"10%"}),n.jsx("option",{value:"20%",children:"20%"})]})]})]}),c.componentType==="Film Capacitor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-capacitance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),n.jsx("input",{id:`component-capacitance-${c.id}`,type:"text",value:u.capacitance||"",onChange:p=>g({...u,capacitance:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 100"}),n.jsx("select",{value:u.capacitanceUnit||Le("capacitance"),onChange:p=>g({...u,capacitanceUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("capacitance").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:p=>g({...u,voltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 50"}),n.jsx("select",{value:u.voltageUnit||Le("voltage"),onChange:p=>g({...u,voltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-filmtype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Film Type:"}),n.jsxs("select",{id:`component-filmtype-${c.id}`,value:u.filmType||"Polyester",onChange:p=>g({...u,filmType:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Polyester",children:"Polyester"}),n.jsx("option",{value:"Polypropylene",children:"Polypropylene"}),n.jsx("option",{value:"Polyethylene",children:"Polyethylene"}),n.jsx("option",{value:"Polystyrene",children:"Polystyrene"}),n.jsx("option",{value:"Polycarbonate",children:"Polycarbonate"}),n.jsx("option",{value:"PTFE",children:"PTFE (Teflon)"}),n.jsx("option",{value:"PPS",children:"PPS (Polyphenylene Sulfide)"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-tolerance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),n.jsxs("select",{id:`component-tolerance-${c.id}`,value:u.tolerance||"10%",onChange:p=>g({...u,tolerance:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"0.5%",children:"0.5%"}),n.jsx("option",{value:"1%",children:"1%"}),n.jsx("option",{value:"2%",children:"2%"}),n.jsx("option",{value:"5%",children:"5%"}),n.jsx("option",{value:"10%",children:"10%"}),n.jsx("option",{value:"20%",children:"20%"})]})]})]}),c.componentType==="Electrolytic Capacitor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-capacitance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),n.jsx("input",{id:`component-capacitance-${c.id}`,type:"text",value:u.capacitance||"",onChange:p=>g({...u,capacitance:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 100"}),n.jsxs("select",{value:u.capacitanceUnit||"F",onChange:p=>g({...u,capacitanceUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:[n.jsx("option",{value:"pF",children:"pF"}),n.jsx("option",{value:"nF",children:"nF"}),n.jsx("option",{value:"F",children:"F"}),n.jsx("option",{value:"mF",children:"mF"}),n.jsx("option",{value:"F",children:"F"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:p=>g({...u,voltage:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 25"}),n.jsx("select",{value:u.voltageUnit||Le("voltage"),onChange:p=>g({...u,voltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-tolerance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),n.jsxs("select",{id:`component-tolerance-${c.id}`,value:u.tolerance||"20%",onChange:p=>g({...u,tolerance:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},children:[n.jsx("option",{value:"0.5%",children:"0.5%"}),n.jsx("option",{value:"1%",children:"1%"}),n.jsx("option",{value:"2%",children:"2%"}),n.jsx("option",{value:"5%",children:"5%"}),n.jsx("option",{value:"10%",children:"10%"}),n.jsx("option",{value:"20%",children:"20%"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-polarity-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Polarity:"}),n.jsxs("select",{id:`component-polarity-${c.id}`,value:u.polarityCapacitor||c.polarity||"Positive",onChange:p=>g({...u,polarityCapacitor:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Positive",children:"Positive"}),n.jsx("option",{value:"Negative",children:"Negative"})]})]})]}),c.componentType==="Inductor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-inductance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Inductance:"}),n.jsx("input",{id:`component-inductance-${c.id}`,type:"text",value:u.inductance||"",onChange:p=>g({...u,inductance:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 10"}),n.jsx("select",{value:u.inductanceUnit||Le("inductance"),onChange:p=>g({...u,inductanceUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("inductance").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:p=>g({...u,current:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 1"}),n.jsx("select",{value:u.currentUnit||Le("current"),onChange:p=>g({...u,currentUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("current").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-resistance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"DC Resistance:"}),n.jsx("input",{id:`component-resistance-${c.id}`,type:"text",value:u.resistance||"",onChange:p=>g({...u,resistance:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 50"}),n.jsx("select",{value:u.resistanceUnit||"",onChange:p=>g({...u,resistanceUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("resistance").map(p=>n.jsx("option",{value:p,children:p},p))})]})]}),c.componentType==="Diode"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-diodetype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Diode Type:"}),n.jsxs("select",{id:`component-diodetype-${c.id}`,value:u.diodeType||"Standard",onChange:p=>g({...u,diodeType:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Standard",children:"Standard"}),n.jsx("option",{value:"Zener",children:"Zener"}),n.jsx("option",{value:"LED",children:"LED"}),n.jsx("option",{value:"Schottky",children:"Schottky"}),n.jsx("option",{value:"Other",children:"Other"})]})]}),u.diodeType==="LED"&&n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-ledcolor-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"LED Color:"}),n.jsxs("select",{id:`component-ledcolor-${c.id}`,value:u.ledColor||"",onChange:p=>g({...u,ledColor:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"",children:"Select..."}),n.jsx("option",{value:"Red",children:"Red"}),n.jsx("option",{value:"Green",children:"Green"}),n.jsx("option",{value:"Blue",children:"Blue"}),n.jsx("option",{value:"Yellow",children:"Yellow"}),n.jsx("option",{value:"Orange",children:"Orange"}),n.jsx("option",{value:"White",children:"White"}),n.jsx("option",{value:"RGB",children:"RGB"}),n.jsx("option",{value:"IR",children:"IR (Infrared)"}),n.jsx("option",{value:"UV",children:"UV (Ultraviolet)"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:p=>g({...u,voltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 50"}),n.jsx("select",{value:u.voltageUnit||Le("voltage"),onChange:p=>g({...u,voltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:p=>g({...u,current:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 1"}),n.jsx("select",{value:u.currentUnit||Le("current"),onChange:p=>g({...u,currentUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("current").map(p=>n.jsx("option",{value:p,children:p},p))})]})]}),c.componentType==="Battery"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:p=>g({...u,voltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 3.7"}),n.jsx("select",{value:u.voltageUnit||"V",onChange:p=>g({...u,voltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-capacity-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacity:"}),n.jsx("input",{id:`component-capacity-${c.id}`,type:"text",value:u.capacity||"",onChange:p=>g({...u,capacity:p.target.value}),disabled:d,style:{width:"120px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 2000mAh"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-chemistry-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Chemistry:"}),n.jsxs("select",{id:`component-chemistry-${c.id}`,value:u.chemistry||"Li-ion",onChange:p=>g({...u,chemistry:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Li-ion",children:"Li-ion"}),n.jsx("option",{value:"LiPo",children:"LiPo"}),n.jsx("option",{value:"NiMH",children:"NiMH"}),n.jsx("option",{value:"NiCd",children:"NiCd"}),n.jsx("option",{value:"Alkaline",children:"Alkaline"}),n.jsx("option",{value:"Lead-Acid",children:"Lead-Acid"}),n.jsx("option",{value:"Lithium",children:"Lithium"}),n.jsx("option",{value:"Zinc-Carbon",children:"Zinc-Carbon"})]})]})]}),c.componentType==="Fuse"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:p=>g({...u,current:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 5"}),n.jsx("select",{value:u.currentUnit||"A",onChange:p=>g({...u,currentUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("current").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:p=>g({...u,voltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 250"}),n.jsx("select",{value:u.voltageUnit||"V",onChange:p=>g({...u,voltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-fusetype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Fuse Type:"}),n.jsxs("select",{id:`component-fusetype-${c.id}`,value:u.fuseType||"Fast-blow",onChange:p=>g({...u,fuseType:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Fast-blow",children:"Fast-blow"}),n.jsx("option",{value:"Slow-blow",children:"Slow-blow"}),n.jsx("option",{value:"Time-delay",children:"Time-delay"}),n.jsx("option",{value:"Resettable",children:"Resettable"}),n.jsx("option",{value:"Cartridge",children:"Cartridge"}),n.jsx("option",{value:"Glass",children:"Glass"}),n.jsx("option",{value:"Ceramic",children:"Ceramic"})]})]})]}),c.componentType==="Relay"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-coilvoltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Coil Voltage:"}),n.jsx("input",{id:`component-coilvoltage-${c.id}`,type:"text",value:u.coilVoltage||"",onChange:p=>g({...u,coilVoltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 12"}),n.jsx("select",{value:u.coilVoltageUnit||Le("voltage"),onChange:p=>g({...u,coilVoltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-contacttype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Contact Type:"}),n.jsxs("select",{id:`component-contacttype-${c.id}`,value:u.contactType||"SPST",onChange:p=>g({...u,contactType:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"SPST",children:"SPST (Single Pole Single Throw)"}),n.jsx("option",{value:"SPDT",children:"SPDT (Single Pole Double Throw)"}),n.jsx("option",{value:"DPST",children:"DPST (Double Pole Single Throw)"}),n.jsx("option",{value:"DPDT",children:"DPDT (Double Pole Double Throw)"}),n.jsx("option",{value:"3PDT",children:"3PDT (3 Pole Double Throw)"}),n.jsx("option",{value:"4PDT",children:"4PDT (4 Pole Double Throw)"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:p=>g({...u,current:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 10"}),n.jsx("select",{value:u.currentUnit||Le("current"),onChange:p=>g({...u,currentUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("current").map(p=>n.jsx("option",{value:p,children:p},p))})]})]}),c.componentType==="Motor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-motortype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Motor Type:"}),n.jsxs("select",{id:`component-motortype-${c.id}`,value:u.motorType||"DC",onChange:p=>g({...u,motorType:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"DC",children:"DC Motor"}),n.jsx("option",{value:"Stepper",children:"Stepper Motor"}),n.jsx("option",{value:"Servo",children:"Servo Motor"}),n.jsx("option",{value:"Brushless",children:"Brushless DC"}),n.jsx("option",{value:"AC",children:"AC Motor"}),n.jsx("option",{value:"Synchronous",children:"Synchronous"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:p=>g({...u,voltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 12"}),n.jsx("select",{value:u.voltageUnit||Le("voltage"),onChange:p=>g({...u,voltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:p=>g({...u,current:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 1"}),n.jsx("select",{value:u.currentUnit||Le("current"),onChange:p=>g({...u,currentUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("current").map(p=>n.jsx("option",{value:p,children:p},p))})]})]}),c.componentType==="Switch"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-switchtype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Switch Type:"}),n.jsxs("select",{id:`component-switchtype-${c.id}`,value:u.switchType||"Toggle",onChange:p=>g({...u,switchType:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Toggle",children:"Toggle"}),n.jsx("option",{value:"Push-button",children:"Push-button"}),n.jsx("option",{value:"Slide",children:"Slide"}),n.jsx("option",{value:"Rotary",children:"Rotary"}),n.jsx("option",{value:"DIP",children:"DIP Switch"}),n.jsx("option",{value:"Momentary",children:"Momentary"}),n.jsx("option",{value:"Latching",children:"Latching"}),n.jsx("option",{value:"Reed",children:"Reed Switch"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:p=>g({...u,current:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 5"}),n.jsx("select",{value:u.currentUnit||Le("current"),onChange:p=>g({...u,currentUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("current").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:p=>g({...u,voltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 250"}),n.jsx("select",{value:u.voltageUnit||Le("voltage"),onChange:p=>g({...u,voltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]})]}),c.componentType==="FerriteBead"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-impedance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Impedance:"}),n.jsx("input",{id:`component-impedance-${c.id}`,type:"text",value:u.impedance||"",onChange:p=>g({...u,impedance:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 100"}),n.jsx("select",{value:u.impedanceUnit||Le("impedance"),onChange:p=>g({...u,impedanceUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("impedance").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:p=>g({...u,current:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 1"}),n.jsx("select",{value:u.currentUnit||Le("current"),onChange:p=>g({...u,currentUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("current").map(p=>n.jsx("option",{value:p,children:p},p))})]})]}),c.componentType==="Connector"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-connectortype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Connector Type:"}),n.jsx("input",{id:`component-connectortype-${c.id}`,type:"text",value:u.connectorType||"",onChange:p=>g({...u,connectorType:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},placeholder:"e.g., USB-A, HDMI"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-gender-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Gender:"}),n.jsxs("select",{id:`component-gender-${c.id}`,value:u.gender||"N/A",onChange:p=>g({...u,gender:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Male",children:"Male"}),n.jsx("option",{value:"Female",children:"Female"}),n.jsx("option",{value:"N/A",children:"N/A"})]})]})]}),c.componentType==="Jumper"&&n.jsx(n.Fragment,{children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-positions-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Positions:"}),n.jsx("input",{id:`component-positions-${c.id}`,type:"number",min:"2",value:u.positions||3,onChange:p=>g({...u,positions:parseInt(p.target.value)||3}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"}})]})}),c.componentType==="Speaker"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-impedance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Impedance:"}),n.jsx("input",{id:`component-impedance-${c.id}`,type:"text",value:u.impedance||"",onChange:p=>g({...u,impedance:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 8"}),n.jsx("select",{value:u.impedanceUnit||Le("impedance"),onChange:p=>g({...u,impedanceUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("impedance").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-power-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),n.jsxs("select",{id:`component-power-${c.id}`,value:u.power||"1/4",onChange:p=>g({...u,power:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"12px"},children:[n.jsx("option",{value:"1/20",children:"1/20 W"}),n.jsx("option",{value:"1/16",children:"1/16 W"}),n.jsx("option",{value:"1/10",children:"1/10 W"}),n.jsx("option",{value:"1/8",children:"1/8 W"}),n.jsx("option",{value:"1/4",children:"1/4 W"}),n.jsx("option",{value:"1/2",children:"1/2 W"}),n.jsx("option",{value:"1",children:"1 W"}),n.jsx("option",{value:"2",children:"2 W"}),n.jsx("option",{value:"3",children:"3 W"}),n.jsx("option",{value:"5",children:"5 W"}),n.jsx("option",{value:"10",children:"10 W"}),n.jsx("option",{value:"25",children:"25 W"}),n.jsx("option",{value:"50",children:"50 W"}),n.jsx("option",{value:"100",children:"100 W"})]})]})]}),c.componentType==="PowerSupply"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-inputvoltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Input Voltage:"}),n.jsx("input",{id:`component-inputvoltage-${c.id}`,type:"text",value:u.inputVoltage||"",onChange:p=>g({...u,inputVoltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 120"}),n.jsx("select",{value:u.inputVoltageUnit||Le("voltage"),onChange:p=>g({...u,inputVoltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-outputvoltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Output Voltage:"}),n.jsx("input",{id:`component-outputvoltage-${c.id}`,type:"text",value:u.outputVoltage||"",onChange:p=>g({...u,outputVoltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 12"}),n.jsx("select",{value:u.outputVoltageUnit||Le("voltage"),onChange:p=>g({...u,outputVoltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:p=>g({...u,current:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 1"}),n.jsx("select",{value:u.currentUnit||Le("current"),onChange:p=>g({...u,currentUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("current").map(p=>n.jsx("option",{value:p,children:p},p))})]})]}),c.componentType==="Transistor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-transistortype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Transistor Type:"}),n.jsxs("select",{id:`component-transistortype-${c.id}`,value:u.transistorType||"BJT",onChange:p=>g({...u,transistorType:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"BJT",children:"BJT (Bipolar Junction Transistor)"}),n.jsx("option",{value:"FET",children:"FET (Field Effect Transistor)"}),n.jsx("option",{value:"MOSFET",children:"MOSFET"}),n.jsx("option",{value:"IGBT",children:"IGBT"}),n.jsx("option",{value:"JFET",children:"JFET"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-polarity-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Polarity:"}),n.jsxs("select",{id:`component-polarity-${c.id}`,value:u.polarity||"NPN",onChange:p=>g({...u,polarity:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"NPN",children:"NPN"}),n.jsx("option",{value:"PNP",children:"PNP"}),n.jsx("option",{value:"N-Channel",children:"N-Channel"}),n.jsx("option",{value:"P-Channel",children:"P-Channel"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),n.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:p=>g({...u,voltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 50"}),n.jsx("select",{value:u.voltageUnit||Le("voltage"),onChange:p=>g({...u,voltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-current-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),n.jsx("input",{id:`component-current-${c.id}`,type:"text",value:u.current||"",onChange:p=>g({...u,current:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 1"}),n.jsx("select",{value:u.currentUnit||Le("current"),onChange:p=>g({...u,currentUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("current").map(p=>n.jsx("option",{value:p,children:p},p))})]})]}),c.componentType==="ResistorNetwork"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-resistance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),n.jsx("input",{id:`component-resistance-${c.id}`,type:"text",value:u.resistance||"",onChange:p=>g({...u,resistance:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 10"}),n.jsx("select",{value:u.resistanceUnit||Le("resistance"),onChange:p=>g({...u,resistanceUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("resistance").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-configuration-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Configuration:"}),n.jsx("input",{id:`component-configuration-${c.id}`,type:"text",value:u.configuration||"",onChange:p=>g({...u,configuration:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},placeholder:"e.g., Isolated, Bussed"})]})]}),c.componentType==="Thermistor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-resistance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),n.jsx("input",{id:`component-resistance-${c.id}`,type:"text",value:u.resistance||"",onChange:p=>g({...u,resistance:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 10"}),n.jsx("select",{value:u.resistanceUnit||Le("resistance"),onChange:p=>g({...u,resistanceUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("resistance").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-thermistortype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Thermistor Type:"}),n.jsxs("select",{id:`component-thermistortype-${c.id}`,value:u.thermistorType||"NTC",onChange:p=>g({...u,thermistorType:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"NTC",children:"NTC (Negative Temperature Coefficient)"}),n.jsx("option",{value:"PTC",children:"PTC (Positive Temperature Coefficient)"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-beta-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Beta ():"}),n.jsx("input",{id:`component-beta-${c.id}`,type:"text",value:u.beta||"",onChange:p=>g({...u,beta:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},placeholder:"e.g., 3950"})]})]}),c.componentType==="Transformer"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-primaryvoltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Primary Voltage:"}),n.jsx("input",{id:`component-primaryvoltage-${c.id}`,type:"text",value:u.primaryVoltage||"",onChange:p=>g({...u,primaryVoltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 120"}),n.jsx("select",{value:u.primaryVoltageUnit||Le("voltage"),onChange:p=>g({...u,primaryVoltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-secondaryvoltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Secondary Voltage:"}),n.jsx("input",{id:`component-secondaryvoltage-${c.id}`,type:"text",value:u.secondaryVoltage||"",onChange:p=>g({...u,secondaryVoltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 12"}),n.jsx("select",{value:u.secondaryVoltageUnit||Le("voltage"),onChange:p=>g({...u,secondaryVoltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-power-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),n.jsxs("select",{id:`component-power-${c.id}`,value:u.power||"1/4",onChange:p=>g({...u,power:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"12px"},children:[n.jsx("option",{value:"1/20",children:"1/20 W"}),n.jsx("option",{value:"1/16",children:"1/16 W"}),n.jsx("option",{value:"1/10",children:"1/10 W"}),n.jsx("option",{value:"1/8",children:"1/8 W"}),n.jsx("option",{value:"1/4",children:"1/4 W"}),n.jsx("option",{value:"1/2",children:"1/2 W"}),n.jsx("option",{value:"1",children:"1 W"}),n.jsx("option",{value:"2",children:"2 W"}),n.jsx("option",{value:"3",children:"3 W"}),n.jsx("option",{value:"5",children:"5 W"}),n.jsx("option",{value:"10",children:"10 W"}),n.jsx("option",{value:"25",children:"25 W"}),n.jsx("option",{value:"50",children:"50 W"}),n.jsx("option",{value:"100",children:"100 W"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-turns-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Turns Ratio:"}),n.jsx("input",{id:`component-turns-${c.id}`,type:"text",value:u.turns||"",onChange:p=>g({...u,turns:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},placeholder:"e.g., 10:1"})]})]}),c.componentType==="TestPoint"&&n.jsx(n.Fragment,{children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-signal-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Signal:"}),n.jsx("input",{id:`component-signal-${c.id}`,type:"text",value:u.signal||"",onChange:p=>g({...u,signal:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},placeholder:"e.g., VCC, GND, CLK"})]})}),c.componentType==="IntegratedCircuit"&&n.jsxs(n.Fragment,{children:[n.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid #e0e0e0",fontSize:"9px",fontWeight:600,color:"#000"},children:"IC Properties:"}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-ictype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"IC Type:"}),n.jsxs("select",{id:`component-ictype-${c.id}`,value:u.icType||"Op-Amp",onChange:p=>g({...u,icType:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Op-Amp",children:"Op-Amp"}),n.jsx("option",{value:"Microcontroller",children:"Microcontroller"}),n.jsx("option",{value:"Microprocessor",children:"Microprocessor"}),n.jsx("option",{value:"Logic",children:"Logic"}),n.jsx("option",{value:"Memory",children:"Memory"}),n.jsx("option",{value:"Voltage Regulator",children:"Voltage Regulator"}),n.jsx("option",{value:"Timer",children:"Timer"}),n.jsx("option",{value:"ADC",children:"ADC (Analog-to-Digital)"}),n.jsx("option",{value:"DAC",children:"DAC (Digital-to-Analog)"}),n.jsx("option",{value:"Comparator",children:"Comparator"}),n.jsx("option",{value:"Transceiver",children:"Transceiver"}),n.jsx("option",{value:"Driver",children:"Driver"}),n.jsx("option",{value:"Amplifier",children:"Amplifier"}),n.jsx("option",{value:"Other",children:"Other"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-datasheet-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Datasheet:"}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",flex:1},children:[n.jsx("input",{id:`component-datasheet-${c.id}`,type:"text",value:u.datasheet||"",onChange:p=>g({...u,datasheet:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"URL"}),u.datasheet&&u.datasheet.trim()&&n.jsx("button",{onClick:p=>{p.preventDefault(),p.stopPropagation();const V=u.datasheet.trim(),de=V.match(/^https?:\/\//)?V:`https://${V}`;window.open(de,"_blank","noopener,noreferrer")},style:{background:"transparent",border:"none",cursor:"pointer",padding:"2px",display:"flex",alignItems:"center",justifyContent:"center",opacity:d?.4:1,flexShrink:0},title:"Open URL in new tab",disabled:d,children:n.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{color:"#4a9eff"},children:[n.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),n.jsx("polyline",{points:"15 3 21 3 21 9"}),n.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-pincount-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Pin Count:"}),n.jsx("input",{id:`component-pincount-${c.id}`,name:`component-pincount-${c.id}`,type:"number",min:"1",value:u.pinCount,onChange:p=>{const V=Math.max(1,parseInt(p.target.value)||1);g({...u,pinCount:V})},onBlur:p=>{if(d){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const V=Math.max(1,parseInt(p.target.value)||1),ge=(u.layer==="top"?R:F).find(Te=>Te.id===u.id);if(ge&&V!==ge.pinCount){const Te=ge.pinConnections||[],Ue=new Array(V).fill("").map((te,$e)=>$e<Te.length?Te[$e]:""),se=ge.pinPolarities||[],Re=ge.pinPolarities?new Array(V).fill("").map((te,$e)=>$e<se.length?se[$e]:""):void 0,B={...ge,pinCount:V,pinConnections:Ue,...Re!==void 0&&{pinPolarities:Re}};u.layer==="top"?xe(te=>te.map($e=>$e.id===u.id?B:$e)):X(te=>te.map($e=>$e.id===u.id?B:$e)),g({...u,pinCount:V})}},disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"}})]})]}),c.componentType==="VacuumTube"&&n.jsx(n.Fragment,{children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-tubetype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tube Type:"}),n.jsx("input",{id:`component-tubetype-${c.id}`,type:"text",value:u.tubeType||"",onChange:p=>g({...u,tubeType:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},placeholder:"e.g., 12AX7, 6L6"})]})}),c.componentType==="VariableResistor"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-vrtype-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"VR Type:"}),n.jsxs("select",{id:`component-vrtype-${c.id}`,value:u.vrType||"Potentiometer",onChange:p=>g({...u,vrType:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Potentiometer",children:"Potentiometer"}),n.jsx("option",{value:"Rheostat",children:"Rheostat"}),n.jsx("option",{value:"Trimmer",children:"Trimmer"}),n.jsx("option",{value:"Varistor",children:"Varistor"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-resistance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),n.jsx("input",{id:`component-resistance-${c.id}`,type:"text",value:u.resistance||"",onChange:p=>g({...u,resistance:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 10"}),n.jsx("select",{value:u.resistanceUnit||Le("resistance"),onChange:p=>g({...u,resistanceUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("resistance").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-power-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),n.jsxs("select",{id:`component-power-${c.id}`,value:u.power||"1/4",onChange:p=>g({...u,power:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"12px"},children:[n.jsx("option",{value:"1/20",children:"1/20 W"}),n.jsx("option",{value:"1/16",children:"1/16 W"}),n.jsx("option",{value:"1/10",children:"1/10 W"}),n.jsx("option",{value:"1/8",children:"1/8 W"}),n.jsx("option",{value:"1/4",children:"1/4 W"}),n.jsx("option",{value:"1/2",children:"1/2 W"}),n.jsx("option",{value:"1",children:"1 W"}),n.jsx("option",{value:"2",children:"2 W"}),n.jsx("option",{value:"3",children:"3 W"}),n.jsx("option",{value:"5",children:"5 W"}),n.jsx("option",{value:"10",children:"10 W"}),n.jsx("option",{value:"25",children:"25 W"}),n.jsx("option",{value:"50",children:"50 W"}),n.jsx("option",{value:"100",children:"100 W"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-taper-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Taper:"}),n.jsxs("select",{id:`component-taper-${c.id}`,value:u.taper||"Linear",onChange:p=>g({...u,taper:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"Linear",children:"Linear"}),n.jsx("option",{value:"Logarithmic",children:"Logarithmic"}),n.jsx("option",{value:"Audio",children:"Audio"})]})]})]}),c.componentType==="Crystal"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-frequency-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Frequency:"}),n.jsx("input",{id:`component-frequency-${c.id}`,type:"text",value:u.frequency||"",onChange:p=>g({...u,frequency:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},placeholder:"e.g., 16.000 MHz"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-loadcapacitance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Load Capacitance:"}),n.jsx("input",{id:`component-loadcapacitance-${c.id}`,type:"text",value:u.loadCapacitance||"",onChange:p=>g({...u,loadCapacitance:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},placeholder:"e.g., 18pF"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-tolerance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),n.jsxs("select",{id:`component-tolerance-${c.id}`,value:u.tolerance||"10ppm",onChange:p=>g({...u,tolerance:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"10ppm",children:"10ppm"}),n.jsx("option",{value:"20ppm",children:"20ppm"}),n.jsx("option",{value:"30ppm",children:"30ppm"}),n.jsx("option",{value:"50ppm",children:"50ppm"}),n.jsx("option",{value:"100ppm",children:"100ppm"})]})]})]}),c.componentType==="ZenerDiode"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-voltage-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Zener Voltage:"}),n.jsx("input",{id:`component-voltage-${c.id}`,type:"text",value:u.voltage||"",onChange:p=>g({...u,voltage:p.target.value}),disabled:d,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1},placeholder:"e.g., 5.1"}),n.jsx("select",{value:u.voltageUnit||Le("voltage"),onChange:p=>g({...u,voltageUnit:p.target.value}),disabled:d,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,width:"60px",marginRight:"12px"},children:Lt("voltage").map(p=>n.jsx("option",{value:p,children:p},p))})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-power-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),n.jsxs("select",{id:`component-power-${c.id}`,value:u.power||"1/4",onChange:p=>g({...u,power:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"12px"},children:[n.jsx("option",{value:"1/20",children:"1/20 W"}),n.jsx("option",{value:"1/16",children:"1/16 W"}),n.jsx("option",{value:"1/10",children:"1/10 W"}),n.jsx("option",{value:"1/8",children:"1/8 W"}),n.jsx("option",{value:"1/4",children:"1/4 W"}),n.jsx("option",{value:"1/2",children:"1/2 W"}),n.jsx("option",{value:"1",children:"1 W"}),n.jsx("option",{value:"2",children:"2 W"}),n.jsx("option",{value:"3",children:"3 W"}),n.jsx("option",{value:"5",children:"5 W"}),n.jsx("option",{value:"10",children:"10 W"}),n.jsx("option",{value:"25",children:"25 W"}),n.jsx("option",{value:"50",children:"50 W"}),n.jsx("option",{value:"100",children:"100 W"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-tolerance-${c.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),n.jsxs("select",{id:`component-tolerance-${c.id}`,value:u.tolerance||"5%",onChange:p=>g({...u,tolerance:p.target.value}),disabled:d,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:d?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"0.5%",children:"0.5%"}),n.jsx("option",{value:"1%",children:"1%"}),n.jsx("option",{value:"2%",children:"2%"}),n.jsx("option",{value:"5%",children:"5%"}),n.jsx("option",{value:"10%",children:"10%"}),n.jsx("option",{value:"20%",children:"20%"})]})]})]})]}),zx=c=>{const u=Wd[c];return!u||!u.prefix||u.prefix.length<1?"?":u.prefix[0].substring(0,1).toUpperCase()},kx=({componentEditor:c,setComponentEditor:u,componentsTop:g,componentsBottom:d,setComponentsTop:R,setComponentsBottom:F,connectingPin:xe,setConnectingPin:X,componentDialogPosition:p,setComponentDialogPosition:V,isDraggingDialog:de,setIsDraggingDialog:ge,dialogDragOffset:Te,setDialogDragOffset:Ue,areComponentsLocked:se,setSelectedComponentIds:Re,setNotesDialogVisible:B})=>{if(!c||!c.visible)return null;let te=g.find(N=>N.id===c.id),$e="top";if(te||(te=d.find(N=>N.id===c.id),$e="bottom"),!te)return null;c.layer!==$e&&u({...c,layer:$e});const L=N=>{const z={...N},D=c.designator?.trim()||"";z.designator=D,z.x=c.x,z.y=c.y,z.layer=c.layer,z.orientation=c.orientation??0;const P=D.length>0?D.charAt(0).toUpperCase():zx(N.componentType);if(z.abbreviation=P,"manufacturer"in z&&(z.manufacturer=c.manufacturer?.trim()||void 0),"partNumber"in z&&(z.partNumber=c.partNumber?.trim()||void 0),c.pinCount!==N.pinCount){z.pinCount=c.pinCount;const O=N.pinConnections||[];if(z.pinConnections=new Array(c.pinCount).fill("").map((he,W)=>W<O.length?O[W]:""),N.pinPolarities){const he=N.pinPolarities||[];z.pinPolarities=new Array(c.pinCount).fill("").map((W,j)=>j<he.length?he[j]:"")}}else z.pinConnections=N.pinConnections||[],N.pinPolarities&&(z.pinPolarities=N.pinPolarities);return N.componentType==="Resistor"?(z.resistance=c.resistance||void 0,z.resistanceUnit=c.resistanceUnit||void 0,z.power=c.power?`${c.power}W`:void 0,z.tolerance=c.tolerance||void 0):N.componentType==="Capacitor"?(z.capacitance=c.capacitance||void 0,z.capacitanceUnit=c.capacitanceUnit||void 0,z.voltage=c.voltage||void 0,z.voltageUnit=c.voltageUnit||void 0,z.tolerance=c.tolerance||void 0,z.dielectric=c.dielectric||void 0):N.componentType==="Electrolytic Capacitor"?(z.capacitance=c.capacitance||void 0,z.capacitanceUnit=c.capacitanceUnit||void 0,z.voltage=c.voltage||void 0,z.voltageUnit=c.voltageUnit||void 0,z.tolerance=c.tolerance||void 0,z.polarity=c.polarityCapacitor||void 0,z.esr=c.esr||void 0,z.esrUnit=c.esrUnit||void 0,z.temperature=c.temperature||void 0):N.componentType==="Film Capacitor"?(z.capacitance=c.capacitance||void 0,z.capacitanceUnit=c.capacitanceUnit||void 0,z.voltage=c.voltage||void 0,z.voltageUnit=c.voltageUnit||void 0,z.tolerance=c.tolerance||void 0,z.filmType=c.filmType||void 0):N.componentType==="Diode"?(z.diodeType=c.diodeType||void 0,z.voltage=c.voltage||void 0,z.voltageUnit=c.voltageUnit||void 0,z.current=c.current||void 0,z.currentUnit=c.currentUnit||void 0,z.ledColor=c.ledColor||void 0):N.componentType==="Battery"?(z.voltage=c.voltage||void 0,z.voltageUnit=c.voltageUnit||void 0,z.capacity=c.capacity||void 0,z.capacityUnit=c.capacityUnit||void 0,z.chemistry=c.chemistry||void 0):N.componentType==="Fuse"?(z.current=c.current||void 0,z.currentUnit=c.currentUnit||void 0,z.voltage=c.voltage||void 0,z.voltageUnit=c.voltageUnit||void 0,z.fuseType=c.fuseType||void 0):N.componentType==="FerriteBead"?(z.impedance=c.impedance||void 0,z.impedanceUnit=c.impedanceUnit||void 0,z.current=c.current||void 0,z.currentUnit=c.currentUnit||void 0):N.componentType==="Connector"?(z.connectorType=c.connectorType||void 0,z.gender=c.gender||void 0):N.componentType==="Jumper"?z.positions=c.positions||void 0:N.componentType==="Relay"?(z.coilVoltage=c.coilVoltage||void 0,z.coilVoltageUnit=c.coilVoltageUnit||void 0,z.contactType=c.contactType||void 0,z.current=c.current||void 0,z.currentUnit=c.currentUnit||void 0):N.componentType==="Inductor"?(z.inductance=c.inductance||void 0,z.inductanceUnit=c.inductanceUnit||void 0,z.current=c.current||void 0,z.currentUnit=c.currentUnit||void 0,z.resistance=c.resistance||void 0,z.resistanceUnit=c.resistanceUnit||void 0):N.componentType==="Speaker"?(z.impedance=c.impedance||void 0,z.impedanceUnit=c.impedanceUnit||void 0,z.power=c.power?`${c.power}W`:void 0):N.componentType==="Motor"?(z.motorType=c.motorType||void 0,z.voltage=c.voltage||void 0,z.voltageUnit=c.voltageUnit||void 0,z.current=c.current||void 0,z.currentUnit=c.currentUnit||void 0):N.componentType==="PowerSupply"?(z.inputVoltage=c.inputVoltage||void 0,z.inputVoltageUnit=c.inputVoltageUnit||void 0,z.outputVoltage=c.outputVoltage||void 0,z.outputVoltageUnit=c.outputVoltageUnit||void 0,z.current=c.current||void 0,z.currentUnit=c.currentUnit||void 0):N.componentType==="Transistor"?(z.transistorType=c.transistorType||void 0,z.polarity=c.polarity||void 0,z.voltage=c.voltage||void 0,z.voltageUnit=c.voltageUnit||void 0,z.current=c.current||void 0,z.currentUnit=c.currentUnit||void 0):N.componentType==="ResistorNetwork"?(z.resistance=c.resistance||void 0,z.resistanceUnit=c.resistanceUnit||void 0,z.configuration=c.configuration||void 0):N.componentType==="Thermistor"?(z.resistance=c.resistance||void 0,z.resistanceUnit=c.resistanceUnit||void 0,z.thermistorType=c.thermistorType||void 0,z.beta=c.beta||void 0):N.componentType==="Switch"?(z.switchType=c.switchType||void 0,z.current=c.current||void 0,z.currentUnit=c.currentUnit||void 0,z.voltage=c.voltage||void 0,z.voltageUnit=c.voltageUnit||void 0):N.componentType==="Transformer"?(z.primaryVoltage=c.primaryVoltage||void 0,z.primaryVoltageUnit=c.primaryVoltageUnit||void 0,z.secondaryVoltage=c.secondaryVoltage||void 0,z.secondaryVoltageUnit=c.secondaryVoltageUnit||void 0,z.power=c.power?`${c.power}W`:void 0,z.turns=c.turns||void 0):N.componentType==="TestPoint"?z.signal=c.signal||void 0:N.componentType==="Film Capacitor"?(z.capacitance=c.capacitance||void 0,z.capacitanceUnit=c.capacitanceUnit||void 0,z.voltage=c.voltage||void 0,z.voltageUnit=c.voltageUnit||void 0,z.tolerance=c.tolerance||void 0,z.filmType=c.filmType||void 0):N.componentType==="IntegratedCircuit"?(z.description=c.description?.trim()||void 0,z.datasheet=c.datasheet?.trim()||void 0,z.icType=c.icType||void 0):z.description=c.description?.trim()||void 0,N.componentType==="VacuumTube"?z.tubeType=c.tubeType||void 0:N.componentType==="VariableResistor"?(z.vrType=c.vrType||void 0,z.resistance=c.resistance||void 0,z.resistanceUnit=c.resistanceUnit||void 0,z.power=c.power?`${c.power}W`:void 0,z.taper=c.taper||void 0):N.componentType==="Crystal"?(z.frequency=c.frequency||void 0,z.loadCapacitance=c.loadCapacitance||void 0,z.tolerance=c.tolerance||void 0):N.componentType==="ZenerDiode"&&(z.voltage=c.voltage||void 0,z.voltageUnit=c.voltageUnit||void 0,z.power=c.power?`${c.power}W`:void 0,z.tolerance=c.tolerance||void 0),z},re=()=>{if(se){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const N=g.find(P=>P.id===c.id),z=d.find(P=>P.id===c.id),D=N||z;if(D){const P=L(D),O=D.layer,he=c.layer;O!==he?O==="top"?(R(W=>W.filter(j=>j.id!==c.id)),F(W=>[...W,P])):(F(W=>W.filter(j=>j.id!==c.id)),R(W=>[...W,P])):he==="top"?R(W=>W.map(j=>j.id===c.id?P:j)):F(W=>W.map(j=>j.id===c.id?P:j))}else if(console.warn(`Component ${c.id} not found in either layer array`),c.layer==="top"){const P=d.find(O=>O.id===c.id);if(P){const O=L(P);F(he=>he.filter(W=>W.id!==c.id)),R(he=>[...he,O])}}else{const P=g.find(O=>O.id===c.id);if(P){const O=L(P);R(he=>he.filter(W=>W.id!==c.id)),F(he=>[...he,O])}}u(null),X(null)};return n.jsxs("div",{"data-component-editor-dialog":!0,onClick:N=>{if(xe&&xe.componentId===te.id){const z=N.target;(z.tagName==="BUTTON"||z.tagName==="INPUT"||z.closest("button")||z.closest("input"))&&N.stopPropagation()}},style:{position:"fixed",top:p?`${p.y}px`:"90px",left:p?`${p.x}px`:`${window.innerWidth-280}px`,transform:"none",background:xe&&xe.componentId===te.id?"rgba(255, 255, 255, 0.95)":"#fff",border:"1px solid #0b5fff",borderRadius:4,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"175px",maxWidth:"250px",maxHeight:"40vh",display:"flex",flexDirection:"column",pointerEvents:"auto",cursor:de?"grabbing":"default"},children:[n.jsxs("div",{onMouseDown:N=>{const z=N.target;z.tagName==="BUTTON"||z.tagName==="INPUT"||z.closest("button")||z.closest("input")||p&&(Ue({x:N.clientX-p.x,y:N.clientY-p.y}),ge(!0),N.preventDefault())},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:de?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[n.jsx("h3",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Component Properties"}),n.jsx("button",{onClick:()=>{u(null),X(null)},style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"6px 20px 6px 6px",overflowY:"auto",flex:1,minHeight:0},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Type:"}),n.jsx("div",{style:{flex:1,padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#000"},children:Vd(te.componentType)})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-layer-${te.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Layer:"}),n.jsxs("select",{id:`component-layer-${te.id}`,name:`component-layer-${te.id}`,value:c.layer,onChange:N=>u({...c,layer:N.target.value}),disabled:se,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:se?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"top",children:"Top"}),n.jsx("option",{value:"bottom",children:"Bottom"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-orientation-${te.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Orientation:"}),n.jsxs("select",{id:`component-orientation-${te.id}`,name:`component-orientation-${te.id}`,value:c.orientation??0,onChange:N=>{const z=parseInt(N.target.value)||0;if(u({...c,orientation:z}),!se){const P=(c.layer==="top"?g:d).find(O=>O.id===c.id);if(P){const O={...P,orientation:z};c.layer==="top"?R(he=>he.map(W=>W.id===c.id?O:W)):F(he=>he.map(W=>W.id===c.id?O:W))}}},disabled:se,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:se?.6:1,marginRight:"8px"},children:[n.jsx("option",{value:"0",children:"0"}),n.jsx("option",{value:"90",children:"90"}),n.jsx("option",{value:"180",children:"180"}),n.jsx("option",{value:"270",children:"270"})]})]}),n.jsx(Cx,{component:te,componentEditor:c,setComponentEditor:u,areComponentsLocked:se,componentsTop:g,componentsBottom:d,setComponentsTop:R,setComponentsBottom:F}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginTop:"4px",paddingTop:"4px",borderTop:"1px solid #e0e0e0"},children:[n.jsx("label",{htmlFor:`component-designator-${te.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Designator:"}),n.jsx("input",{id:`component-designator-${te.id}`,name:`component-designator-${te.id}`,type:"text",value:c.designator||"",onChange:N=>{const z=N.target.value,D=z.length>0?z.charAt(0).toUpperCase():c.abbreviation;u({...c,designator:z,abbreviation:D})},disabled:se,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",fontFamily:"monospace",textTransform:"uppercase",opacity:se?.6:1},placeholder:"e.g., U2, R7, C1"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-description-${te.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Description:"}),n.jsx("input",{id:`component-description-${te.id}`,name:`component-description-${te.id}`,type:"text",value:c.description||"",onChange:N=>{u({...c,description:N.target.value})},disabled:se,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:se?.6:1},placeholder:te.componentType==="IntegratedCircuit"?"e.g., Dual Op-Amp":"e.g., Op Amp OP07"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-notes-${te.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Notes:"}),n.jsx("input",{id:`component-notes-${te.id}`,name:`component-notes-${te.id}`,type:"text",readOnly:!0,value:te.notes||"",onClick:()=>{se||(Re(new Set([te.id])),B(!0))},disabled:se,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:se?.6:1,cursor:se?"not-allowed":"pointer",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},placeholder:"Click to edit notes...",title:te.notes||"Click to edit notes..."})]}),te.componentType!=="IntegratedCircuit"&&n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-pincount-${te.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Pin Count:"}),n.jsx("input",{id:`component-pincount-${te.id}`,name:`component-pincount-${te.id}`,type:"number",min:"1",value:c.pinCount,onChange:N=>{const z=Math.max(1,parseInt(N.target.value)||1);u({...c,pinCount:z})},onBlur:N=>{if(se){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const z=Math.max(1,parseInt(N.target.value)||1),P=(c.layer==="top"?g:d).find(O=>O.id===c.id);if(P&&z!==P.pinCount){const O=P.pinConnections||[],he=new Array(z).fill("").map((me,ce)=>ce<O.length?O[ce]:""),W=P.pinPolarities||[],j=P.pinPolarities?new Array(z).fill("").map((me,ce)=>ce<W.length?W[ce]:""):void 0,Se={...P,pinCount:z,pinConnections:he,...j!==void 0&&{pinPolarities:j}};c.layer==="top"?R(me=>me.map(ce=>ce.id===c.id?Se:ce)):F(me=>me.map(ce=>ce.id===c.id?Se:ce)),u({...c,pinCount:z})}},disabled:se,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:se?.6:1}})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-x-${te.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"X:"}),n.jsx("input",{id:`component-x-${te.id}`,name:`component-x-${te.id}`,type:"number",value:c.x.toFixed(2),onChange:N=>{const z=parseFloat(N.target.value)||0;u({...c,x:z})},disabled:se,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:se?.6:1}})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-y-${te.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Y:"}),n.jsx("input",{id:`component-y-${te.id}`,name:`component-y-${te.id}`,type:"number",value:c.y.toFixed(2),onChange:N=>{const z=parseFloat(N.target.value)||0;u({...c,y:z})},disabled:se,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:se?.6:1}})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-manufacturer-${te.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Manufacturer:"}),n.jsx("input",{id:`component-manufacturer-${te.id}`,name:`component-manufacturer-${te.id}`,type:"text",value:c.manufacturer,onChange:N=>u({...c,manufacturer:N.target.value}),disabled:se,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:se?.6:1}})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{htmlFor:`component-partnumber-${te.id}`,style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Part Number:"}),n.jsx("input",{id:`component-partnumber-${te.id}`,name:`component-partnumber-${te.id}`,type:"text",value:c.partNumber,onChange:N=>u({...c,partNumber:N.target.value}),disabled:se,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",color:"#000",opacity:se?.6:1}})]}),n.jsxs("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid #e0e0e0"},children:[n.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"2px"},children:"Pin Connections:"}),xe&&xe.componentId===te.id&&n.jsxs("div",{style:{padding:"2px 3px",background:"#fff3cd",border:"1px solid #ffc107",borderRadius:2,marginBottom:"2px",fontSize:"8px",color:"#856404"},children:["Pin ",xe.pinIndex+1," selected. Click on a via or pad to connect."]}),(()=>{const N=te.componentType==="Electrolytic Capacitor"||te.componentType==="Diode"||te.componentType==="Battery"||te.componentType==="ZenerDiode",z=te.componentType==="Capacitor"&&"dielectric"in te&&te.dielectric==="Tantalum",D=N||z;return n.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"8px",marginTop:"2px"},children:[n.jsx("thead",{children:n.jsxs("tr",{style:{borderBottom:"1px solid #ddd",background:"#f5f5f5"},children:[n.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"8px",color:"#333",width:"20px"}}),n.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"8px",color:"#333",width:"40px"},children:"Pin"}),D&&n.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"8px",color:"#333",width:"50px"},children:"Polarity"}),n.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"8px",color:"#333"},children:"Node ID"})]})}),n.jsx("tbody",{children:Array.from({length:c.pinCount},(P,O)=>{const W=(c.layer==="top"?g:d).find(ce=>ce.id===c.id),j=W?.pinConnections&&W.pinConnections.length>O?W.pinConnections[O]:"",Se=W?.pinPolarities&&W.pinPolarities.length>O&&W.pinPolarities[O]||"",me=xe&&xe.componentId===te.id&&xe.pinIndex===O;return n.jsxs("tr",{style:{cursor:se?"not-allowed":"pointer",background:me?"#e6f0ff":j?"#d4edda":"#fff",borderBottom:"1px solid #eee"},onClick:ce=>{if(ce.target.tagName!=="SELECT"){if(se){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}X(me?null:{componentId:te.id,pinIndex:O})}},title:j?`Connected to: ${j}`:"Select this pin, then click on a via or pad to connect",children:[n.jsx("td",{style:{padding:"2px 4px",textAlign:"center"},children:n.jsx("input",{id:`pin-radio-${te.id}-${O}`,name:`pin-radio-${te.id}`,type:"radio",checked:!!me,onChange:()=>{if(se){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}X(me?null:{componentId:te.id,pinIndex:O})},disabled:se,style:{margin:0,cursor:se?"not-allowed":"pointer",opacity:se?.6:1,width:"10px",height:"10px"}})}),n.jsx("td",{style:{padding:"2px 4px",color:"#333",fontWeight:me?600:400,fontFamily:"monospace"},children:O+1}),D&&n.jsx("td",{style:{padding:"2px 4px",textAlign:"center"},children:n.jsxs("select",{value:Se??"",onChange:ce=>{if(se){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const H=ce.target.value,pe=(c.layer==="top"?g:d).find(Be=>Be.id===c.id);if(pe){const K=[...pe.pinPolarities||new Array(pe.pinCount).fill("")];for(;K.length<pe.pinCount;)K.push("");K[O]=H;const w={...pe,pinPolarities:K};c.layer==="top"?R(U=>U.map($=>$.id===c.id?w:$)):F(U=>U.map($=>$.id===c.id?w:$))}},disabled:se,onClick:ce=>ce.stopPropagation(),onFocus:ce=>ce.stopPropagation(),style:{padding:"1px 2px",fontSize:"8px",border:"1px solid #ddd",borderRadius:2,background:"#fff",cursor:se?"not-allowed":"pointer",opacity:se?.6:1,width:"100%",fontFamily:"monospace",fontWeight:600},children:[n.jsx("option",{value:"",children:"-"}),n.jsx("option",{value:"+",children:"+"}),n.jsx("option",{value:"-",children:"-"})]},`polarity-${te.id}-${O}-${Se}`)}),n.jsx("td",{style:{padding:"2px 4px",color:j?"#28a745":"#999",fontWeight:j?600:400,fontFamily:"monospace"},children:j||"-"})]},O)})})]})})()]})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"6px",padding:"6px",borderTop:"1px solid #e0e0e0",flexShrink:0},children:[n.jsx("button",{onClick:()=>{u(null),X(null)},disabled:se,style:{padding:"2px 5px",background:se?"#f5f5f5":"#fff",color:se?"#999":"#333",border:"1px solid #ddd",borderRadius:2,cursor:se?"not-allowed":"pointer",fontSize:"10px",opacity:se?.6:1},children:"Cancel"}),n.jsx("button",{onClick:re,disabled:se,style:{padding:"2px 5px",background:se?"#f5f5f5":"#0b5fff",color:se?"#999":"#fff",border:"1px solid #ddd",borderRadius:2,cursor:se?"not-allowed":"pointer",fontSize:"10px",opacity:se?.6:1},children:"Save"})]})]})},Rx=({visible:c,onClose:u,powerBuses:g,setPowerBuses:d,editingPowerBusId:R,setEditingPowerBusId:F,powers:xe})=>{const[X,p]=m.useState(null),[V,de]=m.useState(!1),[ge,Te]=m.useState(null),Ue=m.useRef(null);m.useEffect(()=>{c&&!X&&p({x:window.innerWidth/2-140,y:window.innerHeight/2-200})},[c,X]),m.useEffect(()=>{if(!V)return;const re=z=>{X&&ge&&p({x:z.clientX-ge.x,y:z.clientY-ge.y})},N=()=>{de(!1),Te(null)};return window.addEventListener("mousemove",re),window.addEventListener("mouseup",N),()=>{window.removeEventListener("mousemove",re),window.removeEventListener("mouseup",N)}},[V,X,ge]);const se=g.filter(re=>re.id!==R),Re=g.find(re=>re.id===R);if(!c)return null;const B=[...se].sort((re,N)=>{const z=O=>{const he=O.match(/([+-]?)(\d+\.?\d*)/);if(he){const W=he[1]||"+",j=parseFloat(he[2]);return{absValue:Math.abs(j),isNegative:W==="-"}}return{absValue:1/0,isNegative:!1}},D=z(re.voltage),P=z(N.voltage);return D.absValue!==P.absValue?D.absValue-P.absValue:D.isNegative!==P.isNegative?D.isNegative?-1:1:0}),te=Re?[...B,Re]:B,$e=()=>{const re={id:`powerbus-${Date.now()}-${Math.random()}`,name:"New Power Bus",voltage:"+0.0",color:"#ff0000"};d(N=>[...N,re]),F(re.id)},L=re=>{const N=re.target;N.tagName==="BUTTON"||N.tagName==="INPUT"||N.closest("button")||N.closest("input")||X&&(Te({x:re.clientX-X.x,y:re.clientY-X.y}),de(!0),re.preventDefault())};return n.jsxs("div",{ref:Ue,style:{position:"fixed",top:X?`${X.y}px`:"50%",left:X?`${X.x}px`:"50%",transform:X?"none":"translate(-50%, -50%)",background:"#fff",border:"1px solid #0b5fff",borderRadius:4,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"280px",maxWidth:"320px",maxHeight:"80vh",display:"flex",flexDirection:"column",cursor:V?"grabbing":"default"},children:[n.jsxs("div",{onMouseDown:L,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:V?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[n.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Manage Power Buses"}),n.jsx("button",{onClick:u,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"6px 20px 6px 6px",overflowY:"auto",flex:1,minHeight:0},children:te.map(re=>{const N=g.find(O=>O.id===re.id)||re,z=g.findIndex(O=>O.id===re.id),D=g.some(O=>O.name===N.name&&O.id!==re.id),P=g.some(O=>O.voltage===N.voltage&&O.id!==re.id);return n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"4px",marginBottom:"4px",background:"#f9f9f9",borderRadius:4,border:"1px solid #e0e0e0"},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsxs("div",{style:{flex:1,minWidth:0,display:"flex",flexDirection:"column",gap:"4px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"50px",flexShrink:0},children:"Name:"}),n.jsx("input",{type:"text",value:N.name,onChange:O=>{const he=O.target.value;if(!g.some(j=>j.name===he&&j.id!==re.id)){const j=[...g];z>=0&&(j[z]={...N,name:he},d(j))}},placeholder:"e.g., +5VDC",style:{flex:1,padding:"2px 3px",border:D?"1px solid #ff0000":"1px solid #ddd",borderRadius:2,fontSize:"10px",background:"#f5f5f5",color:"#000"}})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"50px",flexShrink:0},children:"Value:"}),n.jsx("input",{type:"text",inputMode:"decimal",value:N.voltage,onChange:O=>{const he=O.target.value;if(he===""||/^[+-]?\d*\.?\d*$/.test(he)){const W=[...g];z>=0&&(W[z]={...N,voltage:he},d(W))}},onBlur:O=>{const he=O.target.value.trim();if(he==="")return;const W=parseFloat(he);if(!isNaN(W)){const j=W>=0?"+":"-",Se=Math.abs(W),me=`${j}${Se.toFixed(1).replace(/\.?0+$/,"")}`,ce=[...g];z>=0&&(ce[z]={...N,voltage:me},d(ce))}},placeholder:"e.g., +5.0",style:{flex:1,padding:"2px 3px",border:P?"1px solid #ff0000":"1px solid #ddd",borderRadius:2,fontSize:"10px",background:"#f5f5f5",color:"#000"}})]})]}),n.jsx("input",{type:"color",value:N.color,onChange:O=>{const he=[...g];z>=0&&(he[z]={...N,color:O.target.value},d(he))},style:{width:"24px",height:"24px",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",flexShrink:0},title:"Color"}),n.jsx("button",{onClick:()=>{const O=xe.filter(he=>he.powerBusId===re.id);if(O.length>0){alert(`Cannot delete: ${O.length} power node(s) are using this bus. Remove or reassign them first.`);return}d(he=>he.filter(W=>W.id!==re.id))},style:{padding:"2px 6px",background:"#f5f5f5",color:"#333",border:"1px solid #ddd",borderRadius:2,cursor:"pointer",fontSize:"9px",flexShrink:0},children:"Delete"})]})},re.id)})}),n.jsxs("div",{style:{padding:"6px",borderTop:"1px solid #e0e0e0",display:"flex",gap:"4px",flexShrink:0},children:[n.jsx("button",{onClick:$e,style:{flex:1,padding:"4px 8px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",fontSize:"10px"},children:"+ Add Power Bus"}),n.jsx("button",{onClick:u,style:{flex:1,padding:"4px 8px",background:"#0b5fff",color:"#fff",border:"none",borderRadius:2,cursor:"pointer",fontSize:"10px",fontWeight:500},children:"Close"})]})]})},Dx=({visible:c,onClose:u,groundBuses:g,setGroundBuses:d,editingGroundBusId:R,setEditingGroundBusId:F,grounds:xe})=>{const[X,p]=m.useState(null),[V,de]=m.useState(!1),[ge,Te]=m.useState(null),Ue=m.useRef(null);m.useEffect(()=>{c&&!X&&p({x:window.innerWidth/2-140,y:window.innerHeight/2-200})},[c,X]),m.useEffect(()=>{if(!V)return;const re=z=>{X&&ge&&p({x:z.clientX-ge.x,y:z.clientY-ge.y})},N=()=>{de(!1),Te(null)};return window.addEventListener("mousemove",re),window.addEventListener("mouseup",N),()=>{window.removeEventListener("mousemove",re),window.removeEventListener("mouseup",N)}},[V,X,ge]);const se=g.filter(re=>re.id!==R),Re=g.find(re=>re.id===R);if(!c)return null;const B=[...se].sort((re,N)=>re.name.localeCompare(N.name)),te=Re?[...B,Re]:B,$e=()=>{const re={id:`groundbus-${Date.now()}-${Math.random()}`,name:"New Ground Bus",color:"#000000"};d(N=>[...N,re]),F(re.id)},L=re=>{const N=re.target;N.tagName==="BUTTON"||N.tagName==="INPUT"||N.closest("button")||N.closest("input")||X&&(Te({x:re.clientX-X.x,y:re.clientY-X.y}),de(!0),re.preventDefault())};return n.jsxs("div",{ref:Ue,style:{position:"fixed",top:X?`${X.y}px`:"50%",left:X?`${X.x}px`:"50%",transform:X?"none":"translate(-50%, -50%)",background:"#fff",border:"1px solid #0b5fff",borderRadius:4,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"280px",maxWidth:"320px",maxHeight:"80vh",display:"flex",flexDirection:"column",cursor:V?"grabbing":"default"},children:[n.jsxs("div",{onMouseDown:L,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:V?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[n.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Manage Ground Buses"}),n.jsx("button",{onClick:u,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"6px 20px 6px 6px",overflowY:"auto",flex:1,minHeight:0},children:te.map(re=>{const N=g.find(P=>P.id===re.id)||re,z=g.findIndex(P=>P.id===re.id),D=g.some(P=>P.name===N.name&&P.id!==re.id);return n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",padding:"4px",marginBottom:"4px",background:"#f9f9f9",borderRadius:4,border:"1px solid #e0e0e0"},children:[n.jsx("div",{style:{flex:1,minWidth:0},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"50px",flexShrink:0},children:"Name:"}),n.jsx("input",{type:"text",value:N.name,onChange:P=>{const O=P.target.value;if(!g.some(W=>W.name===O&&W.id!==re.id)){const W=[...g];z>=0&&(W[z]={...N,name:O},d(W))}},placeholder:"e.g., GND, Earth",style:{flex:1,padding:"2px 3px",border:D?"1px solid #ff0000":"1px solid #ddd",borderRadius:2,fontSize:"10px",background:"#f5f5f5",color:"#000"}})]})}),n.jsx("input",{type:"color",value:N.color,onChange:P=>{const O=[...g];z>=0&&(O[z]={...N,color:P.target.value},d(O))},style:{width:"24px",height:"24px",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",flexShrink:0},title:"Color"}),n.jsx("button",{onClick:()=>{const P=xe.filter(O=>O.groundBusId===re.id);if(P.length>0){alert(`Cannot delete: ${P.length} ground node(s) are using this bus. Remove or reassign them first.`);return}d(O=>O.filter(he=>he.id!==re.id))},style:{padding:"2px 6px",background:"#f5f5f5",color:"#333",border:"1px solid #ddd",borderRadius:2,cursor:"pointer",fontSize:"9px",flexShrink:0},children:"Delete"})]},re.id)})}),n.jsxs("div",{style:{padding:"6px",borderTop:"1px solid #e0e0e0",display:"flex",gap:"4px",flexShrink:0},children:[n.jsx("button",{onClick:$e,style:{flex:1,padding:"4px 8px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",fontSize:"10px"},children:"+ Add Ground Bus"}),n.jsx("button",{onClick:u,style:{flex:1,padding:"4px 8px",background:"#0b5fff",color:"#fff",border:"none",borderRadius:2,cursor:"pointer",fontSize:"10px",fontWeight:500},children:"Close"})]})]})},Ax=({visible:c,onClose:u,autoAssignDesignators:g,setAutoAssignDesignators:d,useGlobalDesignatorCounters:R,setUseGlobalDesignatorCounters:F})=>c?n.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#fff",border:"1px solid #ddd",borderRadius:6,padding:"16px",zIndex:1e3,minWidth:"300px",maxWidth:"400px",boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[n.jsx("h2",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#222"},children:"Manage Designators"}),n.jsx("button",{onClick:u,style:{background:"transparent",border:"none",fontSize:"18px",cursor:"pointer",color:"#666",padding:0,width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),n.jsxs("div",{style:{marginBottom:"16px"},children:[n.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:"13px",color:"#333",marginBottom:"12px"},children:[n.jsx("input",{type:"checkbox",checked:g,onChange:xe=>{d(xe.target.checked)},style:{width:"16px",height:"16px",cursor:"pointer"}}),n.jsx("span",{children:"Automatically assign designators"})]}),n.jsx("div",{style:{marginTop:"8px",padding:"8px",background:"#f5f5f5",borderRadius:4,fontSize:"11px",color:"#666",lineHeight:"1.4",marginBottom:"12px"},children:g?n.jsx("div",{children:"When enabled, new components automatically receive sequential designators (e.g., C1, C2, C3 for Capacitors; R1, R2, R3 for Resistors)."}):n.jsx("div",{children:"When disabled, you must manually assign designators to each component. The designator field will be empty when components are created."})}),n.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:"13px",color:"#333"},children:[n.jsx("input",{type:"checkbox",checked:R,onChange:xe=>{F(xe.target.checked)},style:{width:"16px",height:"16px",cursor:"pointer"}}),n.jsx("span",{children:"Use global designator counters"})]}),n.jsx("div",{style:{marginTop:"8px",padding:"8px",background:"#f5f5f5",borderRadius:4,fontSize:"11px",color:"#666",lineHeight:"1.4"},children:R?n.jsx("div",{children:"When ON, designators continue from global counters across all projects. New components start with the next value from the global counter (e.g., if global counter is C10, new capacitor will be C11)."}):n.jsx("div",{children:"When OFF (default), designators start at 1 for each project. Each project maintains its own independent designator sequence (e.g., C1, C2, C3...)."})})]}),n.jsx("button",{onClick:u,style:{width:"100%",padding:"6px 12px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:4,cursor:"pointer",fontSize:"12px"},children:"Close"})]}):null,Mh=({visible:c,title:u,message:g,onYes:d,onNo:R,onCancel:F,yesButtonRef:xe})=>c?n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001},onClick:X=>{X.target===X.currentTarget&&F()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:X=>X.stopPropagation(),children:[n.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:u}),n.jsx("p",{style:{margin:"0 0 24px 0",fontSize:"14px",color:"#e0e0e0",lineHeight:"1.5"},children:g}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[n.jsx("button",{onClick:F,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),n.jsx("button",{onClick:R,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"No"}),n.jsx("button",{ref:xe,onClick:d,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},autoFocus:!0,children:"Yes"})]})]})}):null,Nx=({visible:c,size:u,onSizeChange:g,onApply:d,onCancel:R})=>{const F=m.useRef(null);if(m.useEffect(()=>{c&&F.current&&(F.current.focus(),F.current.select())},[c]),!c)return null;const xe=[2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32];return n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10003},onClick:X=>{X.target===X.currentTarget&&R()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:X=>X.stopPropagation(),children:[n.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Set Size"}),n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Size (pixels):"}),n.jsx("input",{ref:F,type:"number",min:"1",max:"99",value:u,onChange:X=>{const p=parseInt(X.target.value)||1,V=Math.max(1,Math.min(99,p));g(V)},onKeyDown:X=>{if(X.key==="Enter"?d():X.key==="Escape"&&R(),X.key.length===1&&/[0-9]/.test(X.key)){const p=u.toString();p.length>=2&&F.current?.selectionStart===F.current?.selectionEnd&&F.current?.selectionStart===p.length&&X.preventDefault()}},onInput:X=>{const p=X.target,V=p.value;if(V.length>2){p.value=V.slice(0,2);const de=parseInt(p.value)||1;g(Math.max(1,Math.min(99,de)))}},style:{width:"100%",padding:"8px 12px",marginBottom:"16px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0}),n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Or select from list:"}),n.jsxs("select",{value:xe.includes(u)?u:"",onChange:X=>{const p=parseInt(X.target.value);!isNaN(p)&&p>0&&g(p)},style:{width:"100%",padding:"8px 12px",marginBottom:"20px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},children:[n.jsx("option",{value:"",style:{background:"#1f1f24",color:"#f2f2f2"},children:"-- Select --"}),xe.map(X=>n.jsxs("option",{value:X,style:{background:"#1f1f24",color:"#f2f2f2"},children:[X," pixels"]},X))]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[n.jsx("button",{onClick:R,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),n.jsx("button",{onClick:d,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Apply"})]})]})})},Mx=({visible:c,interval:u,onIntervalChange:g,onApply:d,onCancel:R})=>c?n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10003},onClick:F=>{F.target===F.currentTarget&&R()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:F=>F.stopPropagation(),children:[n.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Auto Save"}),n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Select time interval:"}),n.jsxs("select",{value:u===null?"disable":(u||5).toString(),onChange:F=>{const xe=F.target.value;if(xe==="disable")g(null);else{const X=parseFloat(xe);!isNaN(X)&&X>0&&g(X)}},style:{width:"100%",padding:"8px 12px",marginBottom:"20px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0,children:[n.jsx("option",{value:"1",style:{background:"#1f1f24",color:"#f2f2f2"},children:"1 minute"}),n.jsx("option",{value:"5",style:{background:"#1f1f24",color:"#f2f2f2"},children:"5 minutes"}),n.jsx("option",{value:"10",style:{background:"#1f1f24",color:"#f2f2f2"},children:"10 minutes"}),n.jsx("option",{value:"20",style:{background:"#1f1f24",color:"#f2f2f2"},children:"20 minutes"}),n.jsx("option",{value:"30",style:{background:"#1f1f24",color:"#f2f2f2"},children:"30 minutes"}),n.jsx("option",{value:"disable",style:{background:"#1f1f24",color:"#f2f2f2"},children:"Disable"})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[n.jsx("button",{onClick:R,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),n.jsx("button",{onClick:d,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Apply"})]})]})}):null,Bx=({visible:c,interval:u,onIntervalChange:g,onEnable:d,onSkip:R})=>c?n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:F=>{F.target===F.currentTarget&&R()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:F=>F.stopPropagation(),children:[n.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Enable Auto Save?"}),n.jsx("p",{style:{margin:"0 0 20px 0",fontSize:"14px",color:"#e0e0e0",lineHeight:"1.5"},children:"We recommend enabling Auto Save to automatically save your project at regular intervals. This helps protect your work from accidental loss."}),n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Select time interval:"}),n.jsxs("select",{value:u===null?"disable":(u||5).toString(),onChange:F=>{const xe=F.target.value;if(xe==="disable")g(null);else{const X=parseFloat(xe);!isNaN(X)&&X>0&&g(X)}},style:{width:"100%",padding:"8px 12px",marginBottom:"24px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0,children:[n.jsx("option",{value:"1",style:{background:"#1f1f24",color:"#f2f2f2"},children:"1 minute"}),n.jsx("option",{value:"5",style:{background:"#1f1f24",color:"#f2f2f2"},children:"5 minutes"}),n.jsx("option",{value:"10",style:{background:"#1f1f24",color:"#f2f2f2"},children:"10 minutes"}),n.jsx("option",{value:"20",style:{background:"#1f1f24",color:"#f2f2f2"},children:"20 minutes"}),n.jsx("option",{value:"30",style:{background:"#1f1f24",color:"#f2f2f2"},children:"30 minutes"})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[n.jsx("button",{onClick:R,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Skip"}),n.jsx("button",{onClick:d,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Enable Auto Save"})]})]})}):null,Ux=({visible:c,projectDirHandle:u,onClose:g,onRestore:d,position:R,isDragging:F=!1,onDragStart:xe})=>{const[X,p]=m.useState([]),[V,de]=m.useState(!1),[ge,Te]=m.useState(null),[Ue,se]=m.useState(null),Re=m.useRef(null);m.useEffect(()=>{if(!c||!u){p([]),Te(null),se(null);return}(async()=>{de(!0),se(null);try{let N;try{N=await u.getDirectoryHandle("history")}catch{p([]),de(!1);return}const z=P=>{const O=P.match(/_(\d{4})_(\d{2})_(\d{2})-(\d{2})-(\d{2})-(\d{2})\.json$/);if(O){const[,W,j,Se,me,ce,H]=O;return new Date(parseInt(W),parseInt(j)-1,parseInt(Se),parseInt(me),parseInt(ce),parseInt(H))}const he=P.match(/_(\d{4})_(\d{2})_(\d{2})_(\d{2})_(\d{2})_(\d{2})\.json$/);if(he){const[,W,j,Se,me,ce,H]=he;return new Date(parseInt(W),parseInt(j)-1,parseInt(Se),parseInt(me),parseInt(ce),parseInt(H))}return null},D=[];for await(const P of N.keys())if(P.endsWith(".json"))try{const he=await(await N.getFileHandle(P)).getFile(),W=z(P);D.push({name:P,lastModified:new Date(he.lastModified),size:he.size,timestamp:W||new Date(he.lastModified)})}catch(O){console.warn(`Failed to read file ${P}:`,O)}D.sort((P,O)=>O.timestamp.getTime()-P.timestamp.getTime()),p(D)}catch(N){console.error("Failed to load history files:",N),se("Failed to load history files. Please try again.")}finally{de(!1)}})()},[c,u]);const B=async()=>{if(ge)try{await d(ge),g()}catch(re){console.error("Failed to restore file:",re),se("Failed to restore file. Please try again.")}},te=re=>re.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),$e=re=>re<1024?`${re} B`:re<1024*1024?`${(re/1024).toFixed(1)} KB`:`${(re/(1024*1024)).toFixed(1)} MB`;if(!c)return null;const L=R?{position:"fixed",left:`${R.x}px`,top:`${R.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"500px",maxWidth:"700px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:F?"grabbing":"default"}:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"#fff",borderRadius:8,minWidth:"500px",maxWidth:"700px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column"};return n.jsxs("div",{style:L,children:[n.jsxs("div",{onMouseDown:xe,style:{backgroundColor:"#f5f5f5",padding:"12px 16px",borderBottom:"1px solid #ddd",borderRadius:"8px 8px 0 0",cursor:F?"grabbing":"move",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsx("h2",{style:{margin:0,fontSize:"16px",fontWeight:600,color:"#000"},children:"PastTime"}),n.jsx("button",{onClick:g,style:{background:"transparent",border:"none",fontSize:"20px",cursor:"pointer",color:"#666",padding:"0 4px",lineHeight:1},title:"Close",children:""})]}),n.jsxs("div",{style:{padding:"16px",display:"flex",flexDirection:"column",flex:1,minHeight:0},children:[Ue&&n.jsx("div",{style:{padding:"12px",backgroundColor:"#fee",color:"#c00",borderRadius:4,marginBottom:"12px"},children:Ue}),V?n.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"Loading history files..."}):X.length===0?n.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"No history files found."}):n.jsxs(n.Fragment,{children:[n.jsx("div",{style:{marginBottom:"12px",color:"#333",fontSize:"14px"},children:"Select a file to restore:"}),n.jsx("div",{ref:Re,style:{border:"1px solid #ddd",borderRadius:4,overflowY:"auto",maxHeight:"400px",backgroundColor:"#fafafa"},children:X.map((re,N)=>n.jsxs("div",{onClick:()=>Te(re.name),style:{padding:"12px 16px",borderBottom:N<X.length-1?"1px solid #eee":"none",backgroundColor:ge===re.name?"#e6f0ff":"transparent",cursor:"pointer",transition:"background-color 0.1s"},onMouseEnter:z=>{ge!==re.name&&(z.currentTarget.style.backgroundColor="#f5f5f5")},onMouseLeave:z=>{ge!==re.name&&(z.currentTarget.style.backgroundColor="transparent")},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"4px"},children:[n.jsx("div",{style:{fontWeight:600,color:"#000",fontSize:"13px",wordBreak:"break-word",flex:1},children:re.name}),n.jsx("div",{style:{color:"#666",fontSize:"12px",marginLeft:"12px",whiteSpace:"nowrap"},children:$e(re.size)})]}),n.jsx("div",{style:{color:"#666",fontSize:"12px"},children:te(re.lastModified)})]},re.name))})]})]}),n.jsxs("div",{style:{padding:"12px 16px",borderTop:"1px solid #ddd",display:"flex",justifyContent:"flex-end",gap:"8px"},children:[n.jsx("button",{onClick:g,style:{padding:"6px 16px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"13px"},children:"Cancel"}),n.jsx("button",{onClick:B,disabled:!ge||V,style:{padding:"6px 16px",background:ge&&!V?"#0066cc":"#ccc",border:"none",borderRadius:4,cursor:ge&&!V?"pointer":"not-allowed",color:"#fff",fontSize:"13px",fontWeight:500},children:"Restore"})]})]})};function Px(){const[c,u]=m.useState([]),[g,d]=m.useState(!1),[R,F]=m.useState([]),[xe,X]=m.useState(null),[p,V]=m.useState("trace"),[de,ge]=m.useState("top"),Te=m.useRef([]),Ue=m.useRef(0),se=m.useRef(!1),Re=m.useCallback(()=>{d(!0),F([]),Te.current=[]},[]),B=m.useCallback(()=>{d(!1),F([]),Te.current=[]},[]),te=m.useCallback(L=>{F(re=>[...re,L]),Te.current=[...Te.current,L]},[]),$e=m.useCallback(L=>{u(re=>[...re,L]),F([]),Te.current=[]},[]);return{drawingStrokes:c,setDrawingStrokes:u,isDrawing:g,setIsDrawing:d,currentStroke:R,setCurrentStroke:F,tracePreviewMousePos:xe,setTracePreviewMousePos:X,drawingMode:p,setDrawingMode:V,selectedDrawingLayer:de,setSelectedDrawingLayer:ge,currentStrokeRef:Te,lastTraceClickTimeRef:Ue,isDoubleClickingTraceRef:se,startDrawing:Re,stopDrawing:B,addPointToStroke:te,finishStroke:$e}}function Ox(){const[c,u]=m.useState(new Set),[g,d]=m.useState(!1),[R,F]=m.useState(new Set),[xe,X]=m.useState(new Set),[p,V]=m.useState(new Set),de=m.useCallback(()=>{u(new Set),F(new Set),X(new Set),V(new Set)},[]),ge=m.useCallback((se,Re="stroke")=>{Re==="stroke"?u(B=>new Set([...B,se])):Re==="component"?F(B=>new Set([...B,se])):Re==="power"?X(B=>new Set([...B,se])):Re==="ground"&&V(B=>new Set([...B,se]))},[]),Te=m.useCallback((se,Re="stroke")=>{Re==="stroke"?u(B=>{const te=new Set(B);return te.delete(se),te}):Re==="component"?F(B=>{const te=new Set(B);return te.delete(se),te}):Re==="power"?X(B=>{const te=new Set(B);return te.delete(se),te}):Re==="ground"&&V(B=>{const te=new Set(B);return te.delete(se),te})},[]),Ue=m.useCallback((se,Re="stroke")=>{Re==="stroke"?u(se):Re==="component"?F(se):Re==="power"?X(se):Re==="ground"&&V(se)},[]);return{selectedIds:c,setSelectedIds:u,isSelecting:g,setIsSelecting:d,selectedComponentIds:R,setSelectedComponentIds:F,selectedPowerIds:xe,setSelectedPowerIds:X,selectedGroundIds:p,setSelectedGroundIds:V,clearSelection:de,addToSelection:ge,removeFromSelection:Te,setSelection:Ue}}function _x(){const[c,u]=m.useState(null),[g,d]=m.useState(!1),[R,F]=m.useState(null),[xe,X]=m.useState("nudge"),p=m.useCallback((de,ge)=>{u(de),d(!0),F(ge)},[]),V=m.useCallback(()=>{d(!1),u(null),F(null)},[]);return{selectedImageForTransform:c,setSelectedImageForTransform:u,isTransforming:g,setIsTransforming:d,transformStartPos:R,setTransformStartPos:F,transformMode:xe,setTransformMode:X,startTransform:p,stopTransform:V}}function Hx(){const[c,u]=m.useState(null),[g,d]=m.useState(null),[R,F]=m.useState("overlay"),[xe,X]=m.useState(50),[p,V]=m.useState(!1),[de,ge]=m.useState(2e3),[Te,Ue]=m.useState(!1),se=m.useCallback(te=>{u(te)},[]),Re=m.useCallback(te=>{d(te)},[]),B=m.useCallback(()=>{u(null),d(null)},[]);return{topImage:c,setTopImage:u,bottomImage:g,setBottomImage:d,currentView:R,setCurrentView:F,transparency:xe,setTransparency:X,isTransparencyCycling:p,setIsTransparencyCycling:V,transparencyCycleSpeed:de,setTransparencyCycleSpeed:ge,isGrayscale:Te,setIsGrayscale:Ue,loadTopImage:se,loadBottomImage:Re,clearImages:B}}function Ex(){const[c,u]=m.useState(1),[g,d]=m.useState({x:0,y:0}),[R,F]=m.useState(!1),[xe,X]=m.useState(!1),p=m.useCallback(()=>{u(1),d({x:0,y:0})},[]),V=m.useCallback((se=1.2)=>{u(Re=>Re*se)},[]),de=m.useCallback((se=1.2)=>{u(Re=>Re/se)},[]),ge=m.useCallback(se=>{u(se)},[]),Te=m.useCallback((se,Re)=>{d(B=>({x:B.x+se,y:B.y+Re}))},[]),Ue=m.useCallback((se,Re)=>{d({x:se,y:Re})},[]);return{viewScale:c,setViewScale:u,viewPan:g,setViewPan:d,isShiftConstrained:R,setIsShiftConstrained:F,showBothLayers:xe,setShowBothLayers:X,resetView:p,zoomIn:V,zoomOut:de,setZoom:ge,pan:Te,setPan:Ue}}function Rt(c,u,g,d){if(u==="power"){const F=c[u]||"";return typeof F=="string"&&F.trim()!==""?{value:F.replace(/W$/i,"").trim(),unit:"W"}:{value:"",unit:"W"}}if(c[u]!==void 0||c[g]!==void 0)return{value:c[u]||"",unit:c[g]||d};const R=c[u]||"";return typeof R=="string"&&R.trim()!==""?Ix(R):{value:"",unit:d}}function Ix(c){if(!c||c.trim()==="")return{value:"",unit:""};const u=c.trim(),g=u.match(/^([\d]+\/[\d]+)\s*([a-zA-ZuW]+)?$/);if(g)return{value:g[1],unit:g[2]||""};const d=u.match(/^([\d.]+)\s*([a-zA-ZuW]+)?$/);return d?{value:d[1],unit:d[2]||""}:{value:u,unit:""}}function Vx(){const[c,u]=m.useState([]),[g,d]=m.useState([]),[R,F]=m.useState(null),[xe,X]=m.useState(null),[p,V]=m.useState(null),[de,ge]=m.useState(!1),[Te,Ue]=m.useState(null),se=m.useCallback((L,re)=>{re==="top"?u(N=>[...N,L]):d(N=>[...N,L])},[]),Re=m.useCallback((L,re,N)=>{N==="top"?u(z=>z.map(D=>D.id===L?{...D,...re}:D)):d(z=>z.map(D=>D.id===L?{...D,...re}:D))},[]),B=m.useCallback((L,re)=>{re==="top"?u(N=>N.filter(z=>z.id!==L)):d(N=>N.filter(z=>z.id!==L))},[]),te=m.useCallback((L,re)=>{const N=L.designator||"",z=L.abbreviation||(N.length>0?N.charAt(0).toUpperCase():""),D={visible:!0,layer:re,id:L.id,designator:N,abbreviation:z,manufacturer:"manufacturer"in L&&L.manufacturer||"",partNumber:"partNumber"in L&&L.partNumber||"",pinCount:L.pinCount,x:L.x,y:L.y,orientation:L.orientation??0,description:L.description||""};if(L.componentType==="Resistor"){const P=L,O=Rt(P,"resistance","resistanceUnit",Le("resistance"));D.resistance=O.value,D.resistanceUnit=O.unit;const he=Rt(P,"power","powerUnit","W");D.power=he.value||"1/4",D.tolerance=P.tolerance||"5%"}else if(L.componentType==="Capacitor"){const P=L,O=Rt(P,"capacitance","capacitanceUnit",Le("capacitance"));D.capacitance=O.value,D.capacitanceUnit=O.unit;const he=Rt(P,"voltage","voltageUnit",Le("voltage"));D.voltage=he.value,D.voltageUnit=he.unit,D.tolerance=P.tolerance||"10%",D.dielectric=P.dielectric||"Ceramic"}else if(L.componentType==="Electrolytic Capacitor"){const P=L,O=Rt(P,"capacitance","capacitanceUnit",Le("capacitance"));D.capacitance=O.value,D.capacitanceUnit=O.unit;const he=Rt(P,"voltage","voltageUnit",Le("voltage"));D.voltage=he.value,D.voltageUnit=he.unit,D.tolerance=P.tolerance||"20%",D.polarityCapacitor=P.polarity||"Positive";const W=Rt(P,"esr","esrUnit",Le("esr"));D.esr=W.value,D.esrUnit=W.unit,D.temperature=P.temperature||""}else if(L.componentType==="Film Capacitor"){const P=L,O=Rt(P,"capacitance","capacitanceUnit",Le("capacitance"));D.capacitance=O.value,D.capacitanceUnit=O.unit;const he=Rt(P,"voltage","voltageUnit",Le("voltage"));D.voltage=he.value,D.voltageUnit=he.unit,D.tolerance=P.tolerance||"10%",D.filmType=P.filmType||"Polyester"}else if(L.componentType==="Diode"){const P=L;D.diodeType=P.diodeType||"Standard";const O=Rt(P,"voltage","voltageUnit",Le("voltage"));D.voltage=O.value,D.voltageUnit=O.unit;const he=Rt(P,"current","currentUnit",Le("current"));D.current=he.value,D.currentUnit=he.unit,D.ledColor=P.ledColor||""}else if(L.componentType==="Battery"){const P=L,O=Rt(P,"voltage","voltageUnit",Le("voltage"));D.voltage=O.value,D.voltageUnit=O.unit;const he=Rt(P,"capacity","capacityUnit",Le("capacity"));D.capacity=he.value,D.capacityUnit=he.unit,D.chemistry=P.chemistry||"Li-ion"}else if(L.componentType==="Fuse"){const P=L,O=Rt(P,"current","currentUnit",Le("current"));D.current=O.value,D.currentUnit=O.unit;const he=Rt(P,"voltage","voltageUnit",Le("voltage"));D.voltage=he.value,D.voltageUnit=he.unit,D.fuseType=P.fuseType||"Fast-blow"}else if(L.componentType==="FerriteBead"){const P=L,O=Rt(P,"impedance","impedanceUnit",Le("impedance"));D.impedance=O.value,D.impedanceUnit=O.unit;const he=Rt(P,"current","currentUnit",Le("current"));D.current=he.value,D.currentUnit=he.unit}else if(L.componentType==="Connector"){const P=L;D.connectorType=P.connectorType||"",D.gender=P.gender||"N/A"}else if(L.componentType==="Jumper"){const P=L;D.positions=P.positions||3}else if(L.componentType==="Relay"){const P=L,O=Rt(P,"coilVoltage","coilVoltageUnit",Le("coilVoltage"));D.coilVoltage=O.value,D.coilVoltageUnit=O.unit,D.contactType=P.contactType||"SPST";const he=Rt(P,"current","currentUnit",Le("current"));D.current=he.value,D.currentUnit=he.unit}else if(L.componentType==="Inductor"){const P=L,O=Rt(P,"inductance","inductanceUnit",Le("inductance"));D.inductance=O.value,D.inductanceUnit=O.unit;const he=Rt(P,"current","currentUnit",Le("current"));D.current=he.value,D.currentUnit=he.unit;const W=Rt(P,"resistance","resistanceUnit",Le("resistance"));D.resistance=W.value,D.resistanceUnit=W.unit}else if(L.componentType==="Speaker"){const P=L,O=Rt(P,"impedance","impedanceUnit",Le("impedance"));D.impedance=O.value,D.impedanceUnit=O.unit;const he=Rt(P,"power","powerUnit","W");D.power=he.value||"1"}else if(L.componentType==="Motor"){const P=L;D.motorType=P.motorType||"DC";const O=Rt(P,"voltage","voltageUnit",Le("voltage"));D.voltage=O.value,D.voltageUnit=O.unit;const he=Rt(P,"current","currentUnit",Le("current"));D.current=he.value,D.currentUnit=he.unit}else if(L.componentType==="PowerSupply"){const P=L,O=Rt(P,"inputVoltage","inputVoltageUnit",Le("inputVoltage"));D.inputVoltage=O.value,D.inputVoltageUnit=O.unit;const he=Rt(P,"outputVoltage","outputVoltageUnit",Le("outputVoltage"));D.outputVoltage=he.value,D.outputVoltageUnit=he.unit;const W=Rt(P,"current","currentUnit",Le("current"));D.current=W.value,D.currentUnit=W.unit}else if(L.componentType==="Transistor"){const P=L;D.transistorType=P.transistorType||"BJT",D.polarity=P.polarity||"NPN";const O=Rt(P,"voltage","voltageUnit",Le("voltage"));D.voltage=O.value,D.voltageUnit=O.unit;const he=Rt(P,"current","currentUnit",Le("current"));D.current=he.value,D.currentUnit=he.unit}else if(L.componentType==="ResistorNetwork"){const P=L,O=Rt(P,"resistance","resistanceUnit",Le("resistance"));D.resistance=O.value,D.resistanceUnit=O.unit,D.configuration=P.configuration||""}else if(L.componentType==="Thermistor"){const P=L,O=Rt(P,"resistance","resistanceUnit",Le("resistance"));D.resistance=O.value,D.resistanceUnit=O.unit,D.thermistorType=P.thermistorType||"NTC",D.beta=P.beta||""}else if(L.componentType==="Switch"){const P=L;D.switchType=P.switchType||"Toggle";const O=Rt(P,"current","currentUnit",Le("current"));D.current=O.value,D.currentUnit=O.unit;const he=Rt(P,"voltage","voltageUnit",Le("voltage"));D.voltage=he.value,D.voltageUnit=he.unit}else if(L.componentType==="Transformer"){const P=L,O=Rt(P,"primaryVoltage","primaryVoltageUnit",Le("primaryVoltage"));D.primaryVoltage=O.value,D.primaryVoltageUnit=O.unit;const he=Rt(P,"secondaryVoltage","secondaryVoltageUnit",Le("secondaryVoltage"));D.secondaryVoltage=he.value,D.secondaryVoltageUnit=he.unit;const W=Rt(P,"power","powerUnit",Le("power"));D.power=W.value||"1",D.turns=P.turns||""}else if(L.componentType==="TestPoint"){const P=L;D.signal=P.signal||""}else if(L.componentType==="IntegratedCircuit"){const P=L;D.description=P.description||L.designator||"",D.datasheet=P.datasheet||"",D.icType=P.icType||"Op-Amp"}else if(L.componentType==="VacuumTube"){const P=L;D.tubeType=P.tubeType||""}else if(L.componentType==="VariableResistor"){const P=L;D.vrType=P.vrType||"Potentiometer";const O=Rt(P,"resistance","resistanceUnit",Le("resistance"));D.resistance=O.value,D.resistanceUnit=O.unit;const he=Rt(P,"power","powerUnit",Le("power"));D.power=he.value||"1/4",D.taper=P.taper||""}else if(L.componentType==="Crystal"){const P=L;D.frequency=P.frequency||"",D.loadCapacitance=P.loadCapacitance||"",D.tolerance=P.tolerance||""}else if(L.componentType==="ZenerDiode"){const P=L,O=Rt(P,"voltage","voltageUnit",Le("voltage"));D.voltage=O.value,D.voltageUnit=O.unit;const he=Rt(P,"power","powerUnit",Le("power"));D.power=he.value||"1/4",D.tolerance=P.tolerance||"5%"}F(D)},[]),$e=m.useCallback(()=>{F(null),X(null)},[]);return{componentsTop:c,setComponentsTop:u,componentsBottom:g,setComponentsBottom:d,componentEditor:R,setComponentEditor:F,connectingPin:xe,setConnectingPin:X,componentDialogPosition:p,setComponentDialogPosition:V,isDraggingDialog:de,setIsDraggingDialog:ge,dialogDragOffset:Te,setDialogDragOffset:Ue,addComponent:se,updateComponent:Re,removeComponent:B,openComponentEditor:te,closeComponentEditor:$e}}function Wx(){const[c,u]=m.useState(()=>[{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),[g,d]=m.useState(()=>[{id:"groundbus-circuit",name:"GND",color:"#000000"}]),[R,F]=m.useState([]),[xe,X]=m.useState([]),[p,V]=m.useState(null),[de,ge]=m.useState(null),Te=m.useCallback(z=>{u(D=>[...D,z])},[]),Ue=m.useCallback((z,D)=>{u(P=>P.map(O=>O.id===z?{...O,...D}:O))},[]),se=m.useCallback(z=>{u(D=>D.filter(P=>P.id!==z)),F(D=>D.filter(P=>P.powerBusId!==z))},[]),Re=m.useCallback(z=>{F(D=>[...D,z])},[]),B=m.useCallback(z=>{F(D=>D.filter(P=>P.id!==z))},[]),te=m.useCallback(z=>{X(D=>[...D,z])},[]),$e=m.useCallback(z=>{X(D=>D.filter(P=>P.id!==z))},[]),L=m.useCallback(z=>{d(D=>[...D,z])},[]),re=m.useCallback((z,D)=>{d(P=>P.map(O=>O.id===z?{...O,...D}:O))},[]),N=m.useCallback(z=>{d(D=>D.filter(P=>P.id!==z)),X(D=>D.filter(P=>P.groundBusId===z))},[]);return{powerBuses:c,setPowerBuses:u,groundBuses:g,setGroundBuses:d,powerSymbols:R,setPowerSymbols:F,groundSymbols:xe,setGroundSymbols:X,powerEditor:p,setPowerEditor:V,groundEditor:de,setGroundEditor:ge,addPowerBus:Te,updatePowerBus:Ue,removePowerBus:se,addPowerSymbol:Re,removePowerSymbol:B,addGroundSymbol:te,removeGroundSymbol:$e,addGroundBus:L,updateGroundBus:re,removeGroundBus:N}}const Dt={brushColor:"#008080",brushSize:6,topTraceColor:"#AA4499",bottomTraceColor:"#F781BF",topTraceSize:6,bottomTraceSize:6,viaSize:18,viaColor:"#ff0000",topPadColor:"#0072B2",bottomPadColor:"#56B4E9",topPadSize:18,bottomPadSize:18,topTestPointColor:"#FFFF00",bottomTestPointColor:"#FFFF00",topTestPointSize:18,bottomTestPointSize:18,topComponentColor:"#8C564B",bottomComponentColor:"#9C755F",topComponentSize:18,bottomComponentSize:18,componentConnectionColor:"#E69F00",componentConnectionSize:3};function Fx(){const[c,u]=m.useState(Dt.brushColor),[g,d]=m.useState(Dt.brushSize),[R,F]=m.useState(Dt.topTraceColor),[xe,X]=m.useState(Dt.bottomTraceColor),[p,V]=m.useState(Dt.topTraceSize),[de,ge]=m.useState(Dt.bottomTraceSize),[Te,Ue]=m.useState(Dt.topPadColor),[se,Re]=m.useState(Dt.bottomPadColor),[B,te]=m.useState(Dt.topPadSize),[$e,L]=m.useState(Dt.bottomPadSize),[re,N]=m.useState(Dt.topTestPointColor),[z,D]=m.useState(Dt.bottomTestPointColor),[P,O]=m.useState(Dt.topTestPointSize),[he,W]=m.useState(Dt.bottomTestPointSize),[j,Se]=m.useState(Dt.topComponentColor),[me,ce]=m.useState(Dt.bottomComponentColor),[H,I]=m.useState(Dt.topComponentSize),[pe,Be]=m.useState(Dt.bottomComponentSize),[K,w]=m.useState(Dt.componentConnectionColor),[U,$]=m.useState(Dt.componentConnectionSize),Z=m.useCallback(()=>{u(Dt.brushColor),d(Dt.brushSize),F(Dt.topTraceColor),X(Dt.bottomTraceColor),V(Dt.topTraceSize),ge(Dt.bottomTraceSize),Ue(Dt.topPadColor),Re(Dt.bottomPadColor),te(Dt.topPadSize),L(Dt.bottomPadSize),N(Dt.topTestPointColor),D(Dt.bottomTestPointColor),O(Dt.topTestPointSize),W(Dt.bottomTestPointSize),Se(Dt.topComponentColor),ce(Dt.bottomComponentColor),I(Dt.topComponentSize),Be(Dt.bottomComponentSize),w(Dt.componentConnectionColor),$(Dt.componentConnectionSize)},[]),Ie=m.useCallback(He=>{He.brushColor!==void 0&&u(He.brushColor),He.brushSize!==void 0&&d(He.brushSize),He.topTraceColor!==void 0&&F(He.topTraceColor),He.bottomTraceColor!==void 0&&X(He.bottomTraceColor),He.topTraceSize!==void 0&&V(He.topTraceSize),He.bottomTraceSize!==void 0&&ge(He.bottomTraceSize),He.topPadColor!==void 0&&Ue(He.topPadColor),He.bottomPadColor!==void 0&&Re(He.bottomPadColor),He.topPadSize!==void 0&&te(He.topPadSize),He.bottomPadSize!==void 0&&L(He.bottomPadSize),He.topTestPointColor!==void 0&&N(He.topTestPointColor),He.bottomTestPointColor!==void 0&&D(He.bottomTestPointColor),He.topTestPointSize!==void 0&&O(He.topTestPointSize),He.bottomTestPointSize!==void 0&&W(He.bottomTestPointSize),He.topComponentColor!==void 0&&Se(He.topComponentColor),He.bottomComponentColor!==void 0&&ce(He.bottomComponentColor),He.topComponentSize!==void 0&&I(He.topComponentSize),He.bottomComponentSize!==void 0&&Be(He.bottomComponentSize),He.componentConnectionColor!==void 0&&w(He.componentConnectionColor),He.componentConnectionSize!==void 0&&$(He.componentConnectionSize)},[]),ot=m.useCallback((He,In,Un)=>{},[]),xt=m.useCallback((He,In,Un)=>{},[]),Gt=m.useCallback(()=>({brushColor:c,brushSize:g,topTraceColor:R,bottomTraceColor:xe,topTraceSize:p,bottomTraceSize:de,viaSize:Dt.viaSize,viaColor:Dt.viaColor,topPadColor:Te,bottomPadColor:se,topPadSize:B,bottomPadSize:$e,topTestPointColor:re,bottomTestPointColor:z,topTestPointSize:P,bottomTestPointSize:he,topComponentColor:j,bottomComponentColor:me,topComponentSize:H,bottomComponentSize:pe,componentConnectionColor:K,componentConnectionSize:U}),[c,g,R,xe,p,de,Te,se,B,$e,re,z,P,he,j,me,H,pe,K,U]);return{brushColor:c,setBrushColor:u,brushSize:g,setBrushSize:d,topTraceColor:R,setTopTraceColor:F,bottomTraceColor:xe,setBottomTraceColor:X,topTraceSize:p,setTopTraceSize:V,bottomTraceSize:de,setBottomTraceSize:ge,topPadColor:Te,setTopPadColor:Ue,bottomPadColor:se,setBottomPadColor:Re,topPadSize:B,setTopPadSize:te,bottomPadSize:$e,setBottomPadSize:L,topTestPointColor:re,setTopTestPointColor:N,bottomTestPointColor:z,setBottomTestPointColor:D,topTestPointSize:P,setTopTestPointSize:O,bottomTestPointSize:he,setBottomTestPointSize:W,topComponentColor:j,setTopComponentColor:Se,bottomComponentColor:me,setBottomComponentColor:ce,topComponentSize:H,setTopComponentSize:I,bottomComponentSize:pe,setBottomComponentSize:Be,componentConnectionColor:K,setComponentConnectionColor:w,componentConnectionSize:U,setComponentConnectionSize:$,resetToDefaults:Z,loadFromProject:Ie,getCurrentSettings:Gt,saveDefaultSize:ot,saveDefaultColor:xt}}function $x(c,u,g,d,R,F,xe,X,p,V,de,ge,Te,Ue,se,Re,B,te,$e,L,re,N,z,D,P){const[O,he]=m.useState(()=>c()),W=m.useRef(null),j=m.useRef(d),Se=m.useRef(R),me=m.useCallback(I=>u==="draw"&&g==="trace"?I.get("trace"):u==="draw"&&g==="via"?I.get("via"):u==="draw"&&g==="pad"?I.get("pad"):u==="component"?I.get("component"):u==="power"?I.get("power"):u==="ground"?I.get("ground"):null,[u,g]);m.useEffect(()=>{he(I=>{const pe=me(I),Be=pe?.id||null,K=W.current,w=new Map(I);if(K&&K!==Be){const U=I.get(K);U&&w.set(K,{...U,settings:{color:j.current,size:Se.current}})}if(pe&&Be!==K)if(u==="draw"&&g==="trace"){const U=N||"top",$=U==="top"?F:xe,Z=U==="top"?X:p;j.current=$,Se.current=Z,w.set("trace",{...pe,settings:{color:$,size:Z}})}else if(u==="draw"&&g==="pad"){const U=z||"top",$=U==="top"?V:de,Z=U==="top"?ge:Te;j.current=$,Se.current=Z,w.set("pad",{...pe,settings:{color:$,size:Z}})}else if(u==="component"){const U=P||"top",$=U==="top"?te:$e,Z=U==="top"?L:re;j.current=$,Se.current=Z,w.set("component",{...pe,settings:{color:$,size:Z}})}else j.current=pe.settings.color,Se.current=pe.settings.size;return W.current=Be,w})},[u,g,d,R,F,xe,X,p,V,de,ge,Te,te,$e,L,re,N,z,P,me]);const ce=m.useCallback((I,pe)=>{he(Be=>{const K=new Map(Be),w=K.get(I);return w&&K.set(I,{...w,settings:pe}),K})},[]),H=m.useCallback((I,pe,Be)=>{he(K=>{const w=new Map(K),U=w.get(I);if(U){const $=new Map(U.layerSettings);$.set(pe,Be),w.set(I,{...U,layerSettings:$})}return w})},[]);return{toolRegistry:O,setToolRegistry:he,updateToolSettings:ce,updateToolLayerSettings:H,getCurrentToolDef:me}}function Lx(c){const{currentTool:u,drawingMode:g,traceToolLayer:d,padToolLayer:R,testPointToolLayer:F,componentToolLayer:xe}=c,[X,p]=m.useState(0),V=m.useCallback(()=>u==="draw"&&g==="via"?"via":u==="draw"&&g==="pad"?R==="bottom"?"padBottom":"padTop":u==="draw"&&g==="testPoint"?F==="bottom"?"testPointBottom":"testPointTop":u==="draw"&&g==="trace"?d==="bottom"?"traceBottom":"traceTop":u==="component"?xe==="bottom"?"componentBottom":"componentTop":u==="power"?"power":u==="ground"?"ground":null,[u,g,R,F,d,xe]),de=m.useCallback(()=>{const se=V();if(se){const Re=At.get(se);return{currentTool:u,drawingMode:g,layer:u==="draw"&&g==="pad"?R||"top":u==="draw"&&g==="testPoint"?F||"top":u==="draw"&&g==="trace"?d||"top":u==="component"?xe||"top":void 0,toolInstanceId:se,color:Re.color,size:Re.size}}return{currentTool:u,drawingMode:g,layer:void 0,toolInstanceId:null,color:"#000000",size:10}},[u,g,R,F,d,xe,V]);m.useEffect(()=>{const se=V();return se?At.subscribe(se,()=>{p(B=>B+1)}):void 0},[V]);const ge=de(),Te=m.useCallback(se=>{const Re=V();Re&&At.setColor(Re,se)},[V]),Ue=m.useCallback(se=>{const Re=V();Re&&At.setSize(Re,se)},[V]);return{toolState:ge,setColor:Te,setSize:Ue,getCurrentToolInstanceId:V}}function Yx(){const[c,u]=m.useState(!1),[g,d]=m.useState(!1),[R,F]=m.useState(!1),[xe,X]=m.useState(!1),[p,V]=m.useState(!1),[de,ge]=m.useState(!1),[Te,Ue]=m.useState(!1),[se,Re]=m.useState(!1),B=m.useCallback(()=>{u(!0),d(!0),F(!0),X(!0),V(!0),ge(!0),Ue(!0),Re(!0)},[]),te=m.useCallback(()=>{u(!1),d(!1),F(!1),X(!1),V(!1),ge(!1),Ue(!1),Re(!1)},[]);return{areImagesLocked:c,setAreImagesLocked:u,areViasLocked:g,setAreViasLocked:d,arePadsLocked:R,setArePadsLocked:F,areTestPointsLocked:xe,setAreTestPointsLocked:X,areTracesLocked:p,setAreTracesLocked:V,areComponentsLocked:de,setAreComponentsLocked:ge,areGroundNodesLocked:Te,setAreGroundNodesLocked:Ue,arePowerNodesLocked:se,setArePowerNodesLocked:Re,lockAll:B,unlockAll:te}}function Xx(){const[c,u]=m.useState(null),[g,d]=m.useState({visible:!1,size:6}),[R,F]=m.useState({visible:!1,interval:5}),[xe,X]=m.useState({visible:!1,source:null,interval:5}),[p,V]=m.useState({visible:!1,text:""}),[de,ge]=m.useState({visible:!1,title:"",message:""}),[Te,Ue]=m.useState({visible:!1}),[se,Re]=m.useState({visible:!1}),[B,te]=m.useState({visible:!1,projectName:"",locationPath:"",locationHandle:null}),[$e,L]=m.useState({visible:!1,filename:"",locationPath:"",locationHandle:null}),[re,N]=m.useState(!1),[z,D]=m.useState(!0),[P,O]=m.useState(!1);return{openMenu:c,setOpenMenu:u,setSizeDialog:g,setSetSizeDialog:d,autoSaveDialog:R,setAutoSaveDialog:F,autoSavePromptDialog:xe,setAutoSavePromptDialog:X,debugDialog:p,setDebugDialog:V,errorDialog:de,setErrorDialog:ge,newProjectDialog:Te,setNewProjectDialog:Ue,openProjectDialog:se,setOpenProjectDialog:Re,newProjectSetupDialog:B,setNewProjectSetupDialog:te,saveAsDialog:$e,setSaveAsDialog:L,showColorPicker:re,setShowColorPicker:N,showWelcomeDialog:z,setShowWelcomeDialog:D,transformImagesDialogVisible:P,setTransformImagesDialogVisible:O}}function Gx(){const[c,u]=m.useState(!1),[g,d]=m.useState(1),[R,F]=m.useState(null),[xe,X]=m.useState(""),[p,V]=m.useState(""),[de,ge]=m.useState(null),[Te,Ue]=m.useState("pcb_project"),[se,Re]=m.useState([]),[B,te]=m.useState(-1),$e=m.useRef(null),L=m.useRef(!1),re=m.useRef(!1);return{autoSaveEnabled:c,setAutoSaveEnabled:u,autoSaveInterval:g,setAutoSaveInterval:d,autoSaveDirHandle:R,setAutoSaveDirHandle:F,autoSaveBaseName:xe,setAutoSaveBaseName:X,currentProjectFilePath:p,setCurrentProjectFilePath:V,projectDirHandle:de,setProjectDirHandle:ge,projectName:Te,setProjectName:Ue,autoSaveFileHistory:se,setAutoSaveFileHistory:Re,currentFileIndex:B,setCurrentFileIndex:te,autoSaveIntervalRef:$e,hasChangesSinceLastAutoSaveRef:L,prevAutoSaveEnabledRef:re}}function qx(){const[c,u]=m.useState(null),g=m.useRef(!1),d=m.useCallback((X,p,V,de,ge)=>{if(g.current)return;const Te={drawingStrokes:JSON.parse(JSON.stringify(X)),componentsTop:JSON.parse(JSON.stringify(p)),componentsBottom:JSON.parse(JSON.stringify(V)),powerSymbols:JSON.parse(JSON.stringify(de)),groundSymbols:JSON.parse(JSON.stringify(ge))};u(Te)},[]),R=m.useCallback(()=>{if(!c)return null;g.current=!0;const X=c;return u(null),setTimeout(()=>{g.current=!1},100),X},[c]),F=c!==null,xe=m.useCallback(()=>{u(null)},[]);return{saveSnapshot:d,undo:R,canUndo:F,clearSnapshot:xe}}function Zx(){const u=Hx(),{topImage:g,setTopImage:d,bottomImage:R,setBottomImage:F,currentView:xe,setCurrentView:X,transparency:p,setTransparency:V,isTransparencyCycling:de,setIsTransparencyCycling:ge,transparencyCycleSpeed:Te,setTransparencyCycleSpeed:Ue,isGrayscale:se,setIsGrayscale:Re}=u,[B,te]=m.useState("none"),$e=Fx(),{brushColor:L,setBrushColor:re,brushSize:N,setBrushSize:z,topTraceColor:D,setTopTraceColor:P,bottomTraceColor:O,setBottomTraceColor:he,topTraceSize:W,setTopTraceSize:j,bottomTraceSize:Se,setBottomTraceSize:me,topPadColor:ce,setTopPadColor:H,bottomPadColor:I,setBottomPadColor:pe,topPadSize:Be,setTopPadSize:K,bottomPadSize:w,setBottomPadSize:U,topTestPointColor:$,setTopTestPointColor:Z,bottomTestPointColor:Ie,setBottomTestPointColor:ot,topTestPointSize:xt,setTopTestPointSize:Gt,bottomTestPointSize:He,setBottomTestPointSize:In,topComponentColor:Un,setTopComponentColor:Ui,bottomComponentColor:wi,setBottomComponentColor:pi,topComponentSize:ji,setTopComponentSize:zl,bottomComponentSize:$i,setBottomComponentSize:kl,componentConnectionColor:Zo,setComponentConnectionColor:yr,componentConnectionSize:Ko,setComponentConnectionSize:$c,saveDefaultSize:Ze,saveDefaultColor:ft}=$e,Lc=Px(),{drawingStrokes:_e,setDrawingStrokes:Pt,isDrawing:Kl,setIsDrawing:jo,currentStroke:Xt,setCurrentStroke:hi,tracePreviewMousePos:Rl,setTracePreviewMousePos:Pi,drawingMode:De,setDrawingMode:Gn,selectedDrawingLayer:tt,setSelectedDrawingLayer:Dn,currentStrokeRef:Ql,lastTraceClickTimeRef:br,isDoubleClickingTraceRef:Jl}=Lc,bs=_x(),{selectedImageForTransform:Mt,setSelectedImageForTransform:Ti,isTransforming:eo,setIsTransforming:Li,transformStartPos:_a,setTransformStartPos:Oi,transformMode:al,setTransformMode:to}=bs,Kr=Ex(),{viewScale:We,setViewScale:Ci,viewPan:zt,setViewPan:Vn,isShiftConstrained:ms,setIsShiftConstrained:mr,showBothLayers:vr,setShowBothLayers:sl}=Kr,[pt,Pn]=m.useState("top"),[Ft,Ha]=m.useState("top"),[sn,Sr]=m.useState("top"),[kn,To]=m.useState("top"),Qo=Oe.useRef("top"),Dl=Oe.useRef("top"),rl=Oe.useRef("top"),Al=Oe.useRef("top");Oe.useEffect(()=>{Qo.current=pt},[pt]),Oe.useEffect(()=>{Dl.current=Ft},[Ft]),Oe.useEffect(()=>{rl.current=sn},[sn]),Oe.useEffect(()=>{Al.current=kn},[kn]);const Jo=Lx({currentTool:B,drawingMode:De,traceToolLayer:pt,padToolLayer:Ft,testPointToolLayer:sn,componentToolLayer:kn}),{toolState:Bt}=Jo,Qr=$x(px,B,De,L,N,D,O,W,Se,ce,I,Be,w,$,Ie,xt,He,Un,wi,ji,$i,pt,Ft,sn,kn),{toolRegistry:Ht,setToolRegistry:rn,getCurrentToolDef:cl,updateToolSettings:Jr,updateToolLayerSettings:ea}=Qr,wr=Oe.useRef(null),Yi=Oe.useRef(L),gi=Oe.useRef(N);Oe.useEffect(()=>{rn(o=>{const r=cl(o),f=r?.id||null,b=wr.current,y=new Map(o);if(b&&b!==f){const v=o.get(b);v&&y.set(b,{...v,settings:{color:Yi.current,size:gi.current}})}if(r&&f!==b)if(B==="draw"&&De==="trace"){const v=pt||"top",x=v==="top"?D:O,T=v==="top"?W:Se;re(x),z(T),Yi.current=x,gi.current=T;const C=new Map(r.layerSettings);C.set("top",{color:D,size:W}),C.set("bottom",{color:O,size:Se}),y.set("trace",{...r,settings:{color:x,size:T},layerSettings:C})}else if(B==="draw"&&De==="pad"){const v=Ft||"top",x=v==="top"?ce:I,T=v==="top"?Be:w;re(x),z(T),Yi.current=x,gi.current=T;const C=new Map(r.layerSettings);C.set("top",{color:ce,size:Be}),C.set("bottom",{color:I,size:w}),y.set("pad",{...r,settings:{color:x,size:T},layerSettings:C})}else if(B==="draw"&&De==="testPoint"){const v=sn||"top",x=v==="top"?$:Ie,T=v==="top"?xt:He;re(x),z(T),Yi.current=x,gi.current=T;const C=new Map(r.layerSettings);C.set("top",{color:$,size:xt}),C.set("bottom",{color:Ie,size:He}),y.set("testPoint",{...r,settings:{color:x,size:T},layerSettings:C})}else if(B==="component"){const v=kn||"top",x=v==="top"?Un:wi,T=v==="top"?ji:$i;re(x),z(T),Yi.current=x,gi.current=T;const C=new Map(r.layerSettings);C.set("top",{color:Un,size:ji}),C.set("bottom",{color:wi,size:$i}),y.set("component",{...r,settings:{color:x,size:T},layerSettings:C})}else{const v=r.settings;re(v.color),z(v.size),Yi.current=v.color,gi.current=v.size}return wr.current=f,y})},[B,De,cl,D,O,W,Se,ce,I,Be,w,$,Ie,xt,He,sn,Un,wi,ji,$i]),Oe.useEffect(()=>{const o=Ht.get("trace");if(o){const y=o.layerSettings.get("top"),v=o.layerSettings.get("bottom");y&&(P(y.color),j(y.size)),v&&(he(v.color),me(v.size))}const r=Ht.get("pad");if(r){const y=r.layerSettings.get("top"),v=r.layerSettings.get("bottom");y&&(H(y.color),K(y.size)),v&&(pe(v.color),U(v.size))}const f=Ht.get("testPoint");if(f){const y=f.layerSettings.get("top"),v=f.layerSettings.get("bottom");y&&(Z(y.color),Gt(y.size)),v&&(ot(v.color),In(v.size))}const b=Ht.get("component");if(b){const y=b.layerSettings.get("top"),v=b.layerSettings.get("bottom");y&&(Ui(y.color),zl(y.size)),v&&(pi(v.color),kl(v.size))}},[]),Oe.useEffect(()=>{rn(o=>{const r=new Map(o),f=o.get("trace");if(f){const T=new Map(f.layerSettings);T.set("top",{color:D,size:W}),T.set("bottom",{color:O,size:Se}),r.set("trace",{...f,layerSettings:T})}const b=o.get("pad");if(b){const T=new Map(b.layerSettings);T.set("top",{color:ce,size:Be}),T.set("bottom",{color:I,size:w}),r.set("pad",{...b,layerSettings:T})}const y=o.get("testPoint");if(y){const T=new Map(y.layerSettings);T.set("top",{color:$,size:xt}),T.set("bottom",{color:Ie,size:He}),r.set("testPoint",{...y,layerSettings:T})}const v=o.get("component");if(v){const T=new Map(v.layerSettings);T.set("top",{color:Un,size:ji}),T.set("bottom",{color:wi,size:$i}),r.set("component",{...v,layerSettings:T})}const x=o.get("componentConnection");return x&&r.set("componentConnection",{...x,settings:{color:Zo,size:Ko}}),r})},[D,O,W,Se,ce,I,Be,w,$,Ie,xt,He,Un,wi,ji,$i,Zo,Ko,rn]),Oe.useEffect(()=>{rn(o=>{const r=cl(o);if(r)if(B==="draw"&&De==="trace"){const f=pt||"top";f==="top"?(P(L),j(N),ft("trace",L,"top"),Ze("trace",N,"top")):(he(L),me(N),ft("trace",L,"bottom"),Ze("trace",N,"bottom"));const b=new Map(o),y=new Map(r.layerSettings);return y.set(f,{color:L,size:N}),b.set(r.id,{...r,layerSettings:y,settings:{color:L,size:N}}),Yi.current=L,gi.current=N,b}else if(B==="draw"&&De==="pad"){const f=Ft||"top";f==="top"?(H(L),K(N),ft("pad",L,"top"),Ze("pad",N,"top")):(pe(L),U(N),ft("pad",L,"bottom"),Ze("pad",N,"bottom"));const b=new Map(o),y=new Map(r.layerSettings);return y.set(f,{color:L,size:N}),b.set(r.id,{...r,layerSettings:y,settings:{color:L,size:N}}),Yi.current=L,gi.current=N,b}else if(B==="draw"&&De==="testPoint"){const f=sn||"top";f==="top"?(Z(L),Gt(N),ft("testPoint",L,"top"),Ze("testPoint",N,"top")):(ot(L),In(N),ft("testPoint",L,"bottom"),Ze("testPoint",N,"bottom"));const b=new Map(o),y=new Map(r.layerSettings);return y.set(f,{color:L,size:N}),b.set(r.id,{...r,layerSettings:y,settings:{color:L,size:N}}),Yi.current=L,gi.current=N,b}else if(B==="component"){const f=kn||"top";f==="top"?(Ui(L),zl(N),ft("component",L,"top"),Ze("component",N,"top")):(pi(L),kl(N),ft("component",L,"bottom"),Ze("component",N,"bottom"));const b=new Map(o),y=new Map(r.layerSettings);return y.set(f,{color:L,size:N}),b.set(r.id,{...r,layerSettings:y,settings:{color:L,size:N}}),Yi.current=L,gi.current=N,b}else{const f=new Map(o);return f.set(r.id,{...r,settings:{color:L,size:N}}),Yi.current=L,gi.current=N,f}return o})},[L,N,B,De,pt,Ft,sn,kn,cl,ft,Ze,Fc,P,he,j,me,H,pe,K,U,Z,ot,Gt,In,Ui,pi,zl,kl]),Oe.useEffect(()=>{po(B==="draw"&&De==="trace")},[B,De]),Oe.useEffect(()=>{Wo(B==="draw"&&De==="pad")},[B,De]),Oe.useEffect(()=>{Ll(B==="draw"&&De==="testPoint")},[B,De]),Oe.useEffect(()=>{Bt.toolInstanceId&&(re(Bt.color),z(Bt.size))},[Bt.toolInstanceId,Bt.color,Bt.size,re,z,B,De]);const[Ea,Wn]=m.useState(void 0),[,wn]=m.useState([]),[,xi]=m.useState([]),[,no]=m.useState([]),[,cn]=m.useState([]),[Fn,ta]=m.useState([]),[Yc,yi]=m.useState([]),[Ia,io]=m.useState([]),[Va,lo]=m.useState([]),On=m.useRef(null),Ve=Ox(),{selectedIds:qe,setSelectedIds:ct,isSelecting:Wa,setIsSelecting:Xi,selectedComponentIds:mt,setSelectedComponentIds:gt,selectedPowerIds:Et,setSelectedPowerIds:at,selectedGroundIds:jt,setSelectedGroundIds:ht}=Ve,Xc=Vx(),{componentsTop:Je,setComponentsTop:tn,componentsBottom:dt,setComponentsBottom:bn,componentEditor:Fa,setComponentEditor:$a,connectingPin:An,setConnectingPin:na,componentDialogPosition:Gi,setComponentDialogPosition:qi,isDraggingDialog:jr,setIsDraggingDialog:Tr,dialogDragOffset:vs,setDialogDragOffset:Cr,openComponentEditor:zr}=Xc,Fd=Wx(),{powerBuses:Xe,setPowerBuses:zi,groundBuses:qt,setGroundBuses:Nl,powerSymbols:ki,setPowerSymbols:ni,groundSymbols:ii,setGroundSymbols:Qn,powerEditor:bi,setPowerEditor:ia}=Fd,Fu=qx(),{saveSnapshot:dl,undo:$d,clearSnapshot:la}=Fu;Oe.useEffect(()=>{B==="power"?(ti(!1),Xe.length>1?tl&&Xe.some(r=>r.id===tl)?$n(!1):($n(!0),tl!==null&&gl(null)):Xe.length===1?(gl(Xe[0].id),$n(!1)):($n(!0),gl(null))):$n(!1)},[B,Xe]),Oe.useEffect(()=>{B==="ground"?($n(!1),qt.length>1?nl&&qt.some(r=>r.id===nl)?ti(!1):(ti(!0),nl!==null&&ts(null)):qt.length===1?(ts(qt[0].id),ti(!1)):(ti(!0),ts(null))):ti(!1)},[B,qt]),Oe.useEffect(()=>{B!=="power"&&B!=="ground"&&($n(!1),ti(!1))},[B]);const $u=Yx(),{areImagesLocked:Ri,setAreImagesLocked:Ss,areViasLocked:mi,setAreViasLocked:ws,arePadsLocked:_i,setArePadsLocked:kr,areTestPointsLocked:Co,setAreTestPointsLocked:Gc,areTracesLocked:vi,setAreTracesLocked:oa,areComponentsLocked:Hi,setAreComponentsLocked:js,areGroundNodesLocked:Ei,setAreGroundNodesLocked:La,arePowerNodesLocked:Rn,setArePowerNodesLocked:Ts}=$u,Lu=Xx(),{openMenu:Yu,setOpenMenu:Rr,setSizeDialog:ec,setSetSizeDialog:tc,autoSaveDialog:qc,setAutoSaveDialog:aa,autoSavePromptDialog:Cs,setAutoSavePromptDialog:Di,debugDialog:zs,setDebugDialog:sa,errorDialog:nc,setErrorDialog:Ya,newProjectDialog:ic,setNewProjectDialog:ra,openProjectDialog:ca,setOpenProjectDialog:ks,newProjectSetupDialog:nn,setNewProjectSetupDialog:Xa,saveAsDialog:mn,setSaveAsDialog:da,showColorPicker:Ga,setShowColorPicker:oo,transformImagesDialogVisible:Xu,setTransformImagesDialogVisible:Rs}=Lu,Ld=Gx(),[Yd,zo]=m.useState(!1),{autoSaveEnabled:li,setAutoSaveEnabled:Zi,autoSaveInterval:ua,setAutoSaveInterval:Ml,autoSaveDirHandle:fa,setAutoSaveDirHandle:pa,autoSaveBaseName:ha,setAutoSaveBaseName:Bl,currentProjectFilePath:lc,setCurrentProjectFilePath:ln,projectDirHandle:on,setProjectDirHandle:Ul,projectName:oi,setProjectName:ul,autoSaveFileHistory:Xd,setAutoSaveFileHistory:ko,currentFileIndex:Gd,setCurrentFileIndex:Ro,autoSaveIntervalRef:Zt,hasChangesSinceLastAutoSaveRef:Ai,prevAutoSaveEnabledRef:Dr}=Ld,Zc=m.useRef(null),ga=m.useRef(null),xa=m.useRef(null),Ds=m.useRef(null),Ar=m.useRef(null),Pl=m.useRef(null),Kc=m.useRef(null),[ya,As]=m.useState(!1),qa=m.useRef(null),Ns=m.useRef(null),[oc,Nr]=m.useState(!1),[Ms,Za]=m.useState({}),[fl,Ki]=m.useState(!1),pn=m.useRef(null),[Do,ac]=m.useState(!1),[ba,ao]=m.useState(null),[Bs,pl]=m.useState(null),[Ka,sc]=m.useState({width:960,height:600}),Qa=m.useRef(null),qd=m.useRef(null),Qi=m.useRef(null),Us=m.useRef(null),Ol=m.useRef(null),Qc=m.useRef(null),Mr=m.useRef(null),ma=m.useRef(null),[va,_l]=m.useState(!0),[Sa,Hl]=m.useState(!0),[dn,Ji]=m.useState(!0),[qn,El]=m.useState(!0),[Jn,Zn]=m.useState(!0),[jn,Ni]=m.useState(!0),[Nn,ai]=m.useState(!0),[ei,Ja]=m.useState(!0),[hl,wa]=m.useState(!0),[el,vn]=m.useState(!0),[Ut,wt]=m.useState(!0),[si,Kn]=m.useState(!0),yt=ki,st=ii,[Zd,Ps]=m.useState(!1),[Os,es]=m.useState(null),[Br,_s]=m.useState(!1),[Ao,No]=m.useState(void 0),[Mo,Bo]=m.useState(!1),[Il,$n]=m.useState(!1),[tl,gl]=m.useState(null),[rc,Vl]=m.useState(!1),[ri,cc]=m.useState(null),[dc,ti]=m.useState(!1),[nl,ts]=m.useState(null),[Tn,ns]=m.useState(!0),[Uo,so]=m.useState(!1),[Jc,Po]=m.useState(!1),xl=m.useRef({}),[Wl,Oo]=m.useState(!0),[ja,_o]=m.useState(!0),[Fl,Ur]=m.useState(!0),[Mi,Hs]=m.useState(null),[Ta,uc]=m.useState(!1),[is,Pr]=m.useState(null),[fc,Ho]=m.useState(!1),[yl,ro]=m.useState(null),[pc,ed]=m.useState(!1),[Eo,Es]=m.useState(null),[Ca,Io]=m.useState([]),[Is,Or]=m.useState(!1),[bl,Vs]=m.useState(null),[co,_r]=m.useState(!1),[Ws,uo]=m.useState(null),[za,ls]=m.useState(null),[td,Fs]=m.useState(!1);Oe.useEffect(()=>{Xe.length===0&&zi([{id:"default-3v3",name:"+3.3V",voltage:"+3.3VDC",color:"#ff6600"},{id:"default-5v",name:"+5V",voltage:"+5VDC",color:"#ff0000"}])},[Xe.length,zi]);const Ii=m.useCallback((o,r)=>{const f=yt.find(y=>y.pointId===o);if(f){const y=r.find(x=>x.id===f.powerBusId);return`Via (${y?y.voltage:f.type||"Power Node"})`}const b=st.find(y=>y.pointId===o);return b?`Via (${b.type||"Ground"})`:"Via"},[yt,st]),Vi=m.useCallback((o,r)=>{const f=yt.find(y=>y.pointId===o);if(f){const y=r.find(x=>x.id===f.powerBusId);return`Pad (${y?y.voltage:f.type||"Power Node"})`}const b=st.find(y=>y.pointId===o);return b?`Pad (${b.type||"Ground"})`:"Pad"},[yt,st]),fo=m.useCallback((o,r)=>{const f=yt.find(y=>y.pointId===o);if(f){const y=r.find(x=>x.id===f.powerBusId);return`Test Point (${y?y.voltage:f.type||"Power Node"})`}const b=st.find(y=>y.pointId===o);return b?`Test Point (${b.type||"Ground"})`:"Test Point"},[yt,st]),Kd=m.useCallback(()=>{const o=_e.filter(r=>r.type==="via").map(r=>r.id);ct(new Set(o)),gt(new Set),at(new Set),ht(new Set)},[_e,ct,gt,at,ht]),$s=m.useCallback(()=>{const o=_e.filter(r=>r.type==="trace").map(r=>r.id);ct(new Set(o)),gt(new Set),at(new Set),ht(new Set)},[_e,ct,gt,at,ht]),hc=m.useCallback(()=>{const o=_e.filter(r=>r.type==="pad").map(r=>r.id);ct(new Set(o)),gt(new Set),at(new Set),ht(new Set)},[_e,ct,gt,at,ht]),Qd=m.useCallback(()=>{const o=[...Je,...dt].map(r=>r.id);gt(new Set(o)),ct(new Set),at(new Set),ht(new Set)},[Je,dt,gt,ct,at,ht]),nd=m.useCallback(()=>{const o=[...Je,...dt].filter(r=>{const f=r.pinConnections||[];return!(f.length>0&&f.length===r.pinCount&&f.every(y=>y&&y.trim()!==""))}).map(r=>r.id);gt(new Set(o)),ct(new Set),at(new Set),ht(new Set),sa({visible:!0,text:""})},[Je,dt,gt,ct,at,ht,sa]),id=m.useCallback(()=>{const o=new Set;let r=0,f=0;for(const k of[...Je,...dt]){const A=k.pinConnections||[];r+=k.pinCount||0;for(const M of A)if(M&&M.trim()!==""){const ie=parseInt(M.trim(),10);!isNaN(ie)&&ie>0&&(o.add(ie),f++)}}if(console.log(`Component connections: ${f} pins connected, ${o.size} unique Point IDs`),o.size===0){console.log("No component connections found - components may not have pins connected"),alert("No component connections found. Please connect component pins to vias, pads, or traces first.");return}const b=new Map;for(const k of _e)if(k.type==="trace"&&k.points.length>=2)for(const A of k.points)A&&A.id!==void 0&&A.id!==null&&(b.has(A.id)||b.set(A.id,new Set),b.get(A.id).add(k.id));const y=new Map;for(const k of _e)if((k.type==="via"||k.type==="pad")&&k.points.length>=1){const A=k.points[0]?.id;A!=null&&(y.has(A)||y.set(A,new Set))}for(const k of _e)if(k.type==="trace"&&k.points.length>=2){const A=[];for(const M of k.points)M&&M.id!==void 0&&M.id!==null&&A.push(M.id);for(let M=0;M<A.length;M++)for(let ie=M+1;ie<A.length;ie++){const Q=A[M],q=A[ie];y.has(Q)||y.set(Q,new Set),y.has(q)||y.set(q,new Set),y.get(Q).add(q),y.get(q).add(Q)}}const v=new Set,x=new Set,T=k=>{if(v.has(k))return;v.add(k),x.add(k);const A=y.get(k);if(A)for(const M of A)T(M)};for(const k of o)T(k);const C=new Set;for(const k of x){const A=b.get(k);if(A)for(const M of A)C.add(M)}for(const k of _e)if((k.type==="via"||k.type==="pad")&&k.points.length>=1){const A=k.points[0]?.id;if(A!=null&&o.has(A)){const M=b.get(A);if(M)for(const ie of M)C.add(ie)}}if(console.log(`Found ${C.size} traces connected to components`),console.log(`  - Component Point IDs: ${Array.from(o).slice(0,10).join(", ")}${o.size>10?"...":""}`),console.log(`  - Connected Point IDs: ${x.size} total`),console.log(`  - Traces found: ${Array.from(C).slice(0,5).join(", ")}${C.size>5?"...":""}`),C.size===0){const k=Array.from(o).slice(0,5).join(", ");alert(`No traces found connected to components.

Component Point IDs: ${k}${o.size>5?"...":""}

Make sure:
1. Component pins are connected to vias/pads
2. Traces are drawn and snapped to those same vias/pads
3. When drawing traces, click on the vias/pads to snap (this shares the Point ID)`);return}ct(C),gt(new Set),at(new Set),ht(new Set),console.log(`Selected ${C.size} traces`)},[Je,dt,_e,ct,gt,at,ht]),Ln=m.useCallback((o,r)=>{const f=On.current;if(!f)return;const b=f.width-10,y=f.height-10,v=b/2,x=y/2,T=v-o*We,C=x-r*We;Vn({x:T,y:C})},[We,Vn]),ml=m.useCallback((o,r,f)=>{Ln(r,f),gt(new Set([o])),ct(new Set),at(new Set),ht(new Set)},[Ln,gt,ct,at,ht]),ka=m.useCallback((o,r,f)=>{Ln(r,f),ct(new Set([o])),gt(new Set),at(new Set),ht(new Set)},[Ln,ct,gt,at,ht]),ld=m.useCallback((o,r,f)=>{Ln(r,f),at(new Set([o])),ct(new Set),gt(new Set),ht(new Set)},[Ln,at,ct,gt,ht]),Jd=m.useCallback((o,r,f)=>{Ln(r,f),ht(new Set([o])),ct(new Set),gt(new Set),at(new Set)},[Ln,ht,ct,gt,at]),Ra=Oe.useMemo(()=>{const o=new Set(yt.map(f=>f.powerBusId).filter(f=>typeof f=="string"&&f.length>0)),r=Xe.filter(f=>o.has(f.id)).map(f=>f.name);return Array.from(new Set(r)).sort()},[yt,Xe]),il=Oe.useMemo(()=>{const o=new Set(st.map(f=>f.groundBusId).filter(f=>typeof f=="string"&&f.length>0)),r=qt.filter(f=>o.has(f.id)).map(f=>f.name);return Array.from(new Set(r)).sort()},[st,qt]),_n=m.useCallback(()=>{const o=yt.map(r=>r.id);at(new Set(o)),ct(new Set),gt(new Set),ht(new Set)},[yt,at,ct,gt,ht]),gc=m.useCallback(()=>{const o=st.map(r=>r.id);ht(new Set(o)),ct(new Set),gt(new Set),at(new Set)},[st,ht,ct,gt,at]),Vo=m.useCallback(o=>{const r=Xe.filter(b=>b.name===o).map(b=>b.id);if(r.length===0)return;const f=yt.filter(b=>b.powerBusId&&r.includes(b.powerBusId)).map(b=>b.id);at(new Set(f)),ct(new Set),gt(new Set),ht(new Set)},[Xe,yt,at,ct,gt,ht]),Tt=m.useCallback(o=>{const r=qt.filter(b=>b.name===o).map(b=>b.id);if(r.length===0)return;const f=st.filter(b=>b.groundBusId&&r.includes(b.groundBusId)).map(b=>b.id);ht(new Set(f)),ct(new Set),gt(new Set),at(new Set)},[qt,st,ht,ct,gt,at]);m.useCallback(o=>{switch(o.componentType){case"Resistor":case"ResistorNetwork":case"Thermistor":case"VariableResistor":if("resistance"in o&&o.resistance&&"resistanceUnit"in o&&o.resistanceUnit)return`${o.resistance} ${o.resistanceUnit}`;break;case"Capacitor":case"Electrolytic Capacitor":case"Film Capacitor":if("capacitance"in o&&o.capacitance&&"capacitanceUnit"in o&&o.capacitanceUnit)return`${o.capacitance} ${o.capacitanceUnit}`;break;case"Inductor":if("inductance"in o&&o.inductance&&"inductanceUnit"in o&&o.inductanceUnit)return`${o.inductance} ${o.inductanceUnit}`;break;case"Battery":if("voltage"in o&&o.voltage&&"voltageUnit"in o&&o.voltageUnit)return`${o.voltage} ${o.voltageUnit}`;break;case"Diode":case"ZenerDiode":if("voltage"in o&&o.voltage&&"voltageUnit"in o&&o.voltageUnit)return`${o.voltage} ${o.voltageUnit}`;break;case"Fuse":if("current"in o&&o.current&&"currentUnit"in o&&o.currentUnit)return`${o.current} ${o.currentUnit}`;break;case"FerriteBead":if("impedance"in o&&o.impedance&&"impedanceUnit"in o&&o.impedanceUnit)return`${o.impedance} ${o.impedanceUnit}`;break;case"Relay":if("coilVoltage"in o&&o.coilVoltage&&"coilVoltageUnit"in o&&o.coilVoltageUnit)return`${o.coilVoltage} ${o.coilVoltageUnit}`;break;case"Speaker":if("impedance"in o&&o.impedance&&"impedanceUnit"in o&&o.impedanceUnit)return`${o.impedance} ${o.impedanceUnit}`;break;case"Motor":if("voltage"in o&&o.voltage&&"voltageUnit"in o&&o.voltageUnit)return`${o.voltage} ${o.voltageUnit}`;break;case"PowerSupply":if("outputVoltage"in o&&o.outputVoltage&&"outputVoltageUnit"in o&&o.outputVoltageUnit)return`${o.outputVoltage} ${o.outputVoltageUnit}`;break;case"Transistor":if("partNumber"in o&&o.partNumber)return o.partNumber;break;case"IntegratedCircuit":if("partNumber"in o&&o.partNumber)return o.partNumber;break}return null},[]);const an=m.useCallback(o=>{const r=[];switch(o.componentType){case"Capacitor":case"Electrolytic Capacitor":case"Film Capacitor":"capacitance"in o&&o.capacitance&&"capacitanceUnit"in o&&o.capacitanceUnit&&r.push(`Capacitance: ${o.capacitance} ${o.capacitanceUnit}`),"voltage"in o&&o.voltage&&"voltageUnit"in o&&o.voltageUnit&&r.push(`Voltage: ${o.voltage} ${o.voltageUnit}`),"dielectric"in o&&o.dielectric&&r.push(`Dielectric: ${o.dielectric}`);break;case"Resistor":case"ResistorNetwork":case"Thermistor":"resistance"in o&&o.resistance&&"resistanceUnit"in o&&o.resistanceUnit&&r.push(`Resistance: ${o.resistance} ${o.resistanceUnit}`),"power"in o&&o.power&&r.push(`Power: ${o.power}`),"tolerance"in o&&o.tolerance&&r.push(`Tolerance: ${o.tolerance}`);break;case"VariableResistor":"resistance"in o&&o.resistance&&"resistanceUnit"in o&&o.resistanceUnit&&r.push(`Resistance: ${o.resistance} ${o.resistanceUnit}`),"vrType"in o&&o.vrType&&r.push(`Type: ${o.vrType}`),"power"in o&&o.power&&r.push(`Power: ${o.power}`),"taper"in o&&o.taper&&r.push(`Taper: ${o.taper}`);break;case"Inductor":"inductance"in o&&o.inductance&&"inductanceUnit"in o&&o.inductanceUnit&&r.push(`Inductance: ${o.inductance} ${o.inductanceUnit}`),"current"in o&&o.current&&"currentUnit"in o&&o.currentUnit&&r.push(`Current: ${o.current} ${o.currentUnit}`),"tolerance"in o&&o.tolerance&&r.push(`Tolerance: ${o.tolerance}`);break;case"Battery":"voltage"in o&&o.voltage&&"voltageUnit"in o&&o.voltageUnit&&r.push(`Voltage: ${o.voltage} ${o.voltageUnit}`),"capacity"in o&&o.capacity&&"capacityUnit"in o&&o.capacityUnit&&r.push(`Capacity: ${o.capacity} ${o.capacityUnit}`);break;case"Diode":"voltage"in o&&o.voltage&&"voltageUnit"in o&&o.voltageUnit&&r.push(`Voltage: ${o.voltage} ${o.voltageUnit}`),"current"in o&&o.current&&"currentUnit"in o&&o.currentUnit&&r.push(`Current: ${o.current} ${o.currentUnit}`);break;case"ZenerDiode":"voltage"in o&&o.voltage&&"voltageUnit"in o&&o.voltageUnit&&r.push(`Voltage: ${o.voltage} ${o.voltageUnit}`),"power"in o&&o.power&&r.push(`Power: ${o.power}`),"tolerance"in o&&o.tolerance&&r.push(`Tolerance: ${o.tolerance}`);break;case"Fuse":"current"in o&&o.current&&"currentUnit"in o&&o.currentUnit&&r.push(`Current: ${o.current} ${o.currentUnit}`),"voltage"in o&&o.voltage&&"voltageUnit"in o&&o.voltageUnit&&r.push(`Voltage: ${o.voltage} ${o.voltageUnit}`);break;case"FerriteBead":"impedance"in o&&o.impedance&&"impedanceUnit"in o&&o.impedanceUnit&&r.push(`Impedance: ${o.impedance} ${o.impedanceUnit}`),"current"in o&&o.current&&"currentUnit"in o&&o.currentUnit&&r.push(`Current: ${o.current} ${o.currentUnit}`);break;case"Relay":"coilVoltage"in o&&o.coilVoltage&&"coilVoltageUnit"in o&&o.coilVoltageUnit&&r.push(`Coil Voltage: ${o.coilVoltage} ${o.coilVoltageUnit}`),"contactRating"in o&&o.contactRating&&r.push(`Contact Rating: ${o.contactRating}`);break;case"Speaker":"impedance"in o&&o.impedance&&"impedanceUnit"in o&&o.impedanceUnit&&r.push(`Impedance: ${o.impedance} ${o.impedanceUnit}`),"power"in o&&o.power&&r.push(`Power: ${o.power}`);break;case"Motor":"voltage"in o&&o.voltage&&"voltageUnit"in o&&o.voltageUnit&&r.push(`Voltage: ${o.voltage} ${o.voltageUnit}`),"speed"in o&&o.speed&&"speedUnit"in o&&o.speedUnit&&r.push(`Speed: ${o.speed} ${o.speedUnit}`);break;case"PowerSupply":"outputVoltage"in o&&o.outputVoltage&&"outputVoltageUnit"in o&&o.outputVoltageUnit&&r.push(`Output Voltage: ${o.outputVoltage} ${o.outputVoltageUnit}`),"outputCurrent"in o&&o.outputCurrent&&"outputCurrentUnit"in o&&o.outputCurrentUnit&&r.push(`Output Current: ${o.outputCurrent} ${o.outputCurrentUnit}`);break;case"Transistor":"partNumber"in o&&o.partNumber&&r.push(`Part Number: ${o.partNumber}`),"transistorType"in o&&o.transistorType&&r.push(`Type: ${o.transistorType}`);break;case"Crystal":"frequency"in o&&o.frequency&&r.push(`Frequency: ${o.frequency}`),"loadCapacitance"in o&&o.loadCapacitance&&r.push(`Load Capacitance: ${o.loadCapacitance}`),"tolerance"in o&&o.tolerance&&r.push(`Tolerance: ${o.tolerance}`);break;case"VacuumTube":"tubeType"in o&&o.tubeType&&r.push(`Tube Type: ${o.tubeType}`),"partNumber"in o&&o.partNumber&&r.push(`Part Number: ${o.partNumber}`);break}return r},[]),[Cn,po]=m.useState(!1),$l=m.useRef(null),[ho,Wo]=m.useState(!1),[os,Ll]=m.useState(!1),Hr=m.useRef(null),hn=m.useRef(null),Ls=m.useRef(null),Ys=m.useRef(null),[Er,go]=m.useState(!1),[Ir,Fo]=m.useState(!1),[Wi,Xs]=m.useState(null),ci=Oe.useRef(null),[Hn,xc]=m.useState(new Set),Gs=m.useRef(null),xo=m.useRef(null),qs=m.useRef(null),vl=m.useRef(null),as=m.useRef(null),Vr=m.useRef(null),Wr=m.useRef(null),yc=m.useRef(null),[eu,od]=m.useState(null),[Yl,ad]=m.useState(!1),[ss,bc]=m.useState(null),[$o,sd]=m.useState(null),rd=m.useCallback(async(o,r)=>{if(!r)throw new Error("No project directory available. Please create or open a project before loading images. The project directory is needed to store image files.");try{let f;try{f=await r.getDirectoryHandle("images",{create:!0})}catch(v){throw new Error(`Failed to create images directory in project folder. This may be due to insufficient permissions. Please ensure you have write access to the project directory. Error details: ${v.message}`)}const b=o.name,y=`images/${b}`;try{const x=await(await f.getFileHandle(b,{create:!0})).createWritable();return await x.write(o),await x.close(),console.log(`Image copied to project directory: ${y}`),y}catch(v){throw new Error(`Failed to copy image file "${b}" to project images directory. The file may be locked by another application, or there may be insufficient disk space. Please try again or check your disk space. Error details: ${v.message}`)}}catch(f){throw f instanceof Error&&f.message.includes("No project directory")||f instanceof Error&&f.message.includes("Failed to")?f:new Error(`An unexpected error occurred while copying the image to the project directory. This may be due to file system permissions or disk space issues. Please try again. Technical details: ${f.message}`)}},[]),cd=m.useCallback(async(o,r)=>{try{const f=o.name.toLowerCase(),y=[".png",".jpg",".jpeg"].some(q=>f.endsWith(q)),x=["image/png","image/jpeg","image/jpg"].includes(o.type);if(!y&&!x){alert(`Error: Unsupported image format.

The software only accepts PNG and JPEG image files.

File selected: ${o.name}
File type: ${o.type||"unknown"}

Please select a .png, .jpg, or .jpeg image file.`);return}let T;if(on)try{T=await rd(o,on)}catch(q){const J=q instanceof Error?q.message:"Unknown error occurred while copying image to project directory.";alert(`Error: ${J}

The image could not be loaded. Please ensure you have a project open and have write permissions to the project directory.`);return}else{if(!confirm(`Warning: No project directory is currently open. The image will be loaded, but you must create or open a project and save it before the image will be stored in the project directory.

Do you want to continue loading the ${r==="top"?"top":"bottom"} image?`))return;T=o.name}const C=await createImageBitmap(o),k=URL.createObjectURL(o),A=On.current;let M=0,ie=0;if(A){const q=A.width-10,J=A.height-10,le=q/2,ne=J/2;M=(le-zt.x)/We,ie=(ne-zt.y)/We}const Q={url:k,name:o.name,width:C.width,height:C.height,filePath:T,x:M,y:ie,scale:1,rotation:0,flipX:!1,flipY:!1,skewX:0,skewY:0,keystoneV:0,keystoneH:0,bitmap:C};r==="top"?d(Q):F(Q)}catch(f){const b=f instanceof Error?f.message:"Unknown error occurred while loading the image.";alert(`Error: Failed to load image file "${o.name}".

${b}

Please ensure the file is a valid image format (PNG, JPEG, etc.) and is not corrupted.`),console.error("Failed to load image",f)}},[zt.x,zt.y,We,on,rd]),tu=m.useCallback(o=>{o.stopPropagation(),o.preventDefault();const r=On.current;if(!r)return;document.activeElement!==r&&r.focus();const f=r.getBoundingClientRect(),b=r.width/f.width,y=r.height/f.height,v=o.nativeEvent.offsetX,x=o.nativeEvent.offsetY,T=typeof v=="number"?v:o.clientX-f.left,C=typeof x=="number"?x:o.clientY-f.top,k=T*b,A=C*y,M=k-5,ie=A-5,Q=(M-zt.x)/We,q=(ie-zt.y)/We;if(B==="center"){Ki(!0),pn.current&&clearTimeout(pn.current),pn.current=setTimeout(()=>{Ki(!1),te("select"),Wn(void 0)},2e3);return}if(B==="select"){if(An){let _=1/0,ve=null,ue=null;const Ne=Math.max(6/We,4),nt=[...Je,...dt].find(Ye=>Ye.id===An.componentId)?.layer||"top";for(const Ye of _e)if((Ye.type==="via"||Ye.type==="pad")&&Ye.points.length>0){if(Ye.type==="pad"&&(Ye.layer||"top")!==nt)continue;const et=Ye.points[0],it=Math.max(1,Ye.size/2),vt=Math.hypot(et.x-Q,et.y-q),lt=Math.max(it,Ne);vt<=lt&&vt<_&&(_=vt,ve=et.id??null,ue=Ye)}if(ue?(console.log(`
[PIN CONNECTION] Found via!`),console.log(`  Stroke ID: ${ue.id}`),console.log(`  Point ID: ${ve}`),console.log(`  Point coordinates: x=${ue.points[0].x.toFixed(2)}, y=${ue.points[0].y.toFixed(2)}`),console.log(`  Click coordinates: x=${Q.toFixed(2)}, y=${q.toFixed(2)}`),console.log(`  Distance: ${_.toFixed(2)}`),console.log(`  Via size: ${ue.size}, radius: ${Math.max(1,ue.size/2)}`)):(console.log(`
[PIN CONNECTION] No via found!`),console.log(`  Click coordinates: x=${Q.toFixed(2)}, y=${q.toFixed(2)}`),console.log(`  Hit tolerance: ${Ne.toFixed(2)}`),console.log(`  Total vias in drawingStrokes: ${_e.filter(Ye=>Ye.type==="via").length}`)),ve!=null){console.log(`
[PIN CONNECTION] Proceeding with connection...`),console.log(`  bestPointId is valid: ${ve} (type: ${typeof ve})`);const Ye=String(ve),et=An.pinIndex,it=An.componentId;console.log(`
=== PIN CONNECTION START ===`),console.log(`Connecting pin ${et} (Pin ${et+1}) of component ${it} to point ID ${Ye}`);const vt=Je.find(Pe=>Pe.id===it),lt=dt.find(Pe=>Pe.id===it);vt?(console.log("Component found in TOP layer"),tn(Pe=>{const ut=Pe.find(St=>St.id===it);if(!ut)return console.error(`Component ${it} not found in TOP layer during update!`),Pe;console.log("BEFORE update: pinConnections =",ut.pinConnections);const $t=ut.pinConnections||[],Jt=$t.length>0?[...$t]:new Array(ut.pinCount).fill("");let It;if(Jt.length!==ut.pinCount){It=new Array(ut.pinCount).fill("");for(let St=0;St<Math.min(Jt.length,ut.pinCount);St++)It[St]=Jt[St]||""}else It=[...Jt];It[et]=Ye,console.log(`Updating pin ${et} with value: ${Ye}`),console.log("New pinConnections array:",It);const kt=Pe.map(St=>St.id===it?{...St,pinConnections:It}:St),zn=kt.find(St=>St.id===it);return console.log("AFTER update: pinConnections =",zn?.pinConnections),console.log(`Pin ${et} value: ${zn?.pinConnections[et]}`),console.log(`=== PIN CONNECTION COMPLETE (TOP) ===
`),kt})):lt?(console.log("Component found in BOTTOM layer"),bn(Pe=>{const ut=Pe.find(St=>St.id===it);if(!ut)return console.error(`Component ${it} not found in BOTTOM layer during update!`),Pe;console.log("BEFORE update: pinConnections =",ut.pinConnections);const $t=ut.pinConnections||[],Jt=$t.length>0?[...$t]:new Array(ut.pinCount).fill("");let It;if(Jt.length!==ut.pinCount){It=new Array(ut.pinCount).fill("");for(let St=0;St<Math.min(Jt.length,ut.pinCount);St++)It[St]=Jt[St]||""}else It=[...Jt];It[et]=Ye,console.log(`Updating pin ${et} with value: ${Ye}`),console.log("New pinConnections array:",It);const kt=Pe.map(St=>St.id===it?{...St,pinConnections:It}:St),zn=kt.find(St=>St.id===it);return console.log("AFTER update: pinConnections =",zn?.pinConnections),console.log(`Pin ${et} value: ${zn?.pinConnections[et]}`),console.log(`=== PIN CONNECTION COMPLETE (BOTTOM) ===
`),kt})):(console.error(`Component ${it} not found in either TOP or BOTTOM layer!`),console.log("Available TOP components:",Je.map(Pe=>Pe.id)),console.log("Available BOTTOM components:",dt.map(Pe=>Pe.id))),setTimeout(()=>{na(null)},0);return}else na(null)}const J=10,le=(()=>{for(const _ of Je)if(Q>=_.x-J&&Q<=_.x+J&&q>=_.y-J&&q<=_.y+J)return{layer:"top",comp:_};for(const _ of dt)if(Q>=_.x-J&&Q<=_.x+J&&q>=_.y-J&&q<=_.y+J)return{layer:"bottom",comp:_};return null})();if(le){const{comp:_}=le;o.shiftKey?gt(ve=>{const ue=new Set(ve);return ue.has(_.id)?ue.delete(_.id):ue.add(_.id),ue}):(gt(new Set([_.id])),ct(new Set),at(new Set),ht(new Set));return}const ne=Math.max(6/We,4);let be=null;for(const _ of yt){const ve=Math.max(6,_.size/2),ue=ve*.8,Ne=ve+ue,Fe=Math.hypot(_.x-Q,_.y-q),nt=Math.abs(Q-_.x)<=ne&&Math.abs(q-_.y)<=Ne,Ye=Math.abs(q-_.y)<=ne&&Math.abs(Q-_.x)<=Ne;if(Fe<=Math.max(ve,ne)||nt||Ye){be=_;break}}if(be){o.shiftKey?at(_=>{const ve=new Set(_);return ve.has(be.id)?ve.delete(be.id):ve.add(be.id),ve}):(at(new Set([be.id])),ct(new Set),gt(new Set),ht(new Set));return}let Ae=null;for(const _ of st){const ve=Math.max(6,(_.size||18)/2),ue=ve*.8,Ne=ve+ue,Fe=Math.hypot(_.x-Q,_.y-q),nt=Math.abs(Q-_.x)<=ne&&Math.abs(q-_.y)<=Ne,Ye=Math.abs(q-_.y)<=ne&&Math.abs(Q-_.x)<=Ne;if(Fe<=Math.max(ve,ne)||nt||Ye){Ae=_;break}}if(Ae){o.shiftKey?ht(_=>{const ve=new Set(_);return ve.has(Ae.id)?ve.delete(Ae.id):ve.add(Ae.id),ve}):(ht(new Set([Ae.id])),ct(new Set),gt(new Set),at(new Set));return}const je=Math.max(6/We,4/We),Me=Math.max(je,.5);let G=null;for(const _ of _e)if((_.type==="via"||_.type==="pad"||_.type==="testPoint")&&_.points.length>0){let ve=!1;if(_.type==="via"?ve=dn:_.type==="pad"?ve=(_.layer||"top")==="top"?jn:Nn:_.type==="testPoint"&&(ve=(_.layer||"top")==="top"?ei:hl),!ve)continue;const ue=_.points[0],Ne=Math.max(1,_.size/2);if(Math.hypot(ue.x-Q,ue.y-q)<=Math.max(Ne,Me)){G=_;break}}if(G){o.shiftKey?ct(_=>{const ve=new Set(_);return ve.has(G.id)?ve.delete(G.id):ve.add(G.id),ve}):(ct(new Set([G.id])),gt(new Set),at(new Set),ht(new Set));return}o.shiftKey||(ct(new Set),gt(new Set),at(new Set),ht(new Set)),Xi(!0),bc({x:Q,y:q,shiftKey:o.shiftKey}),sd({x:Q,y:q,width:0,height:0});return}else if(B==="magnify"){const J=o.shiftKey?.5:2,le=Math.max(.25,Math.min(8,We*J)),ne=M-le*Q,be=ie-le*q;Ci(le),Vn({x:ne,y:be});return}else if(B==="pan"){qa.current={startCX:M,startCY:ie,panX:zt.x,panY:zt.y},Ns.current={startClientX:o.clientX,startClientY:o.clientY,panX:zt.x,panY:zt.y},As(!0);return}else if(B==="draw"){const J=(be,Ae)=>{let ze=1/0,je=null;const Me=10/We,G=We>20?Math.max(Me,1e-4):We>10?Math.max(Me,.001):Math.max(Me,.01);for(const ue of _e)if(ue.type==="via"){const Ne=ue.points[0],Fe=Math.hypot(Ne.x-be,Ne.y-Ae);Fe<=G&&Fe<ze&&(ze=Fe,je=Ne)}else if(ue.type==="pad"){const Ne=ue.points[0],Fe=Math.hypot(Ne.x-be,Ne.y-Ae);Fe<=G&&Fe<ze&&(ze=Fe,je=Ne)}for(const ue of yt)if(ue.pointId!==void 0){const Ne=Math.hypot(ue.x-be,ue.y-Ae);Ne<=G&&Ne<ze&&(ze=Ne,je={x:ue.x,y:ue.y,id:ue.pointId})}for(const ue of st)if(ue.pointId!==void 0){const Ne=Math.hypot(ue.x-be,ue.y-Ae);Ne<=G&&Ne<ze&&(ze=Ne,je={x:ue.x,y:ue.y,id:ue.pointId})}const ve=Yt(je??{x:be,y:Ae});return{x:ve.x,y:ve.y,nodeId:je?.id}};if(De==="via"){const be=At.get("via"),Ae=be.color,ze=be.size,Ee=Yl?{x:Yt({x:Q,y:q}).x,y:Yt({x:Q,y:q}).y}:((ue,Ne)=>{let Fe=1/0,nt=null;const et=10/We,it=We>10?Math.max(et,.001):Math.max(et,.01);for(const Pe of _e)if(Pe.type==="via"||Pe.type==="pad"){const ut=Pe.points[0],$t=Math.hypot(ut.x-ue,ut.y-Ne);$t<=it&&$t<Fe&&(Fe=$t,nt=ut)}for(const Pe of yt)if(Pe.pointId!==void 0){const ut=Math.hypot(Pe.x-ue,Pe.y-Ne);ut<=it&&ut<Fe&&(Fe=ut,nt={x:Pe.x,y:Pe.y,id:Pe.pointId})}for(const Pe of st)if(Pe.pointId!==void 0){const ut=Math.hypot(Pe.x-ue,Pe.y-Ne);ut<=it&&ut<Fe&&(Fe=ut,nt={x:Pe.x,y:Pe.y,id:Pe.pointId})}const lt=Yt(nt??{x:ue,y:Ne});return{x:lt.x,y:lt.y,nodeId:nt?.id}})(Q,q),Me=Ee.nodeId??qo(),G=Ii(Me,Xe),_={id:Me,x:Ee.x,y:Ee.y};dl(_e,Je,dt,ki,ii);const ve={id:`${Date.now()}-via`,points:[_],color:Ae,size:ze,layer:tt,type:"via",viaType:G};Pt(ue=>[...ue,ve]),tt==="top"?wn(ue=>[...ue,ve.id]):xi(ue=>[...ue,ve.id]);return}if(De==="pad"){if(!Ft)return;const Ae=Yl?{x:Yt({x:Q,y:q}).x,y:Yt({x:Q,y:q}).y}:((ve,ue)=>{let Ne=1/0,Fe=null;const Ye=10/We,et=We>10?Math.max(Ye,.001):Math.max(Ye,.01);for(const lt of _e)if(lt.type==="via"||lt.type==="pad"||lt.type==="testPoint"){const Pe=lt.points[0],ut=Math.hypot(Pe.x-ve,Pe.y-ue);ut<=et&&ut<Ne&&(Ne=ut,Fe=Pe)}for(const lt of yt)if(lt.pointId!==void 0){const Pe=Math.hypot(lt.x-ve,lt.y-ue);Pe<=et&&Pe<Ne&&(Ne=Pe,Fe={x:lt.x,y:lt.y,id:lt.pointId})}for(const lt of st)if(lt.pointId!==void 0){const Pe=Math.hypot(lt.x-ve,lt.y-ue);Pe<=et&&Pe<Ne&&(Ne=Pe,Fe={x:lt.x,y:lt.y,id:lt.pointId})}const vt=Yt(Fe??{x:ve,y:ue});return{x:vt.x,y:vt.y,nodeId:Fe?.id}})(Q,q),ze=Ae.nodeId??qo(),je=Vi(ze,Xe),Ee=L||(Ft==="top"?ce:I),Me=N||(Ft==="top"?Be:w),G={id:ze,x:Ae.x,y:Ae.y};dl(_e,Je,dt,ki,ii);const _={id:`${Date.now()}-pad`,points:[G],color:Ee,size:Me,layer:Ft,type:"pad",padType:je};Pt(ve=>[...ve,_]);return}if(De==="testPoint"){if(!sn)return;const Ae=Yl?{x:Yt({x:Q,y:q}).x,y:Yt({x:Q,y:q}).y}:((ue,Ne)=>{let Fe=1/0,nt=null;const Ye=15;for(const vt of _e)if(vt.type==="via"||vt.type==="pad"||vt.type==="testPoint"){const lt=vt.points[0],Pe=Math.hypot(lt.x-ue,lt.y-Ne);Pe<=Ye&&Pe<Fe&&(Fe=Pe,nt=lt)}for(const vt of yt)if(vt.pointId!==void 0){const lt=Math.hypot(vt.x-ue,vt.y-Ne);lt<=Ye&&lt<Fe&&(Fe=lt,nt={x:vt.x,y:vt.y,id:vt.pointId})}for(const vt of st)if(vt.pointId!==void 0){const lt=Math.hypot(vt.x-ue,vt.y-Ne);lt<=Ye&&lt<Fe&&(Fe=lt,nt={x:vt.x,y:vt.y,id:vt.pointId})}const it=Yt(nt??{x:ue,y:Ne});return{x:it.x,y:it.y,nodeId:nt?.id}})(Q,q),ze=Ae.nodeId??qo(),je=fo(ze,Xe),Ee=je.includes("Power")?"power":je.includes("Ground")?"ground":je.includes("Signal")?"signal":"unknown",Me=Yt({x:Ae.x,y:Ae.y}),G=L||(sn==="top"?$:Ie),_=N||(sn==="top"?xt:He);dl(_e,Je,dt,ki,ii);const ve={id:`${Date.now()}-testPoint`,points:[{id:ze,x:Me.x,y:Me.y}],color:G,size:_,layer:sn,type:"testPoint",testPointType:Ee};Pt(ue=>[...ue,ve]);return}if(Jl.current)return;const le=De==="trace"&&!Yl?J(Q,q):{x:Yt({x:Q,y:q}).x,y:Yt({x:Q,y:q}).y},ne=le.nodeId!==void 0?{id:le.nodeId,x:le.x,y:le.y}:{x:le.x,y:le.y};hi(be=>be.length===0?[ne]:[...be,ne]),br.current=Date.now(),Pi(null),jo(!1),mr(!1)}else if(B==="erase"){if(_e.some(le=>le.layer===tt&&(le.type==="via"&&mi||le.type==="pad"&&_i||le.type==="testPoint"&&Co||le.type==="trace"&&vi))){const le=[];mi&&_e.some(ne=>ne.layer===tt&&ne.type==="via")&&le.push("vias"),_i&&_e.some(ne=>ne.layer===tt&&ne.type==="pad")&&le.push("pads"),Co&&_e.some(ne=>ne.layer===tt&&ne.type==="testPoint")&&le.push("test points"),vi&&_e.some(ne=>ne.layer===tt&&ne.type==="trace")&&le.push("traces"),le.length>0&&alert(`Cannot erase: ${le.join(", ")} are locked on the ${tt} layer. Unlock them to erase.`)}jo(!0),hi([{id:qo(),x:Q,y:q}]),console.log("Starting erase at:",Q,q,"selectedDrawingLayer:",tt,"total strokes:",_e.length)}else if(B==="transform"&&Mt){if(Ri){alert("Cannot transform: Images are locked. Unlock images to transform them.");return}Li(!0),Oi({x:Q,y:q})}else if(B==="component"){if(!Wi)return;const J=Yt({x:Q,y:q}),le=L||(kn==="top"?Un:wi),ne=N||(kn==="top"?ji:$i),be=[...Je,...dt];let Ae;Uo?Ae=Id():Ae={...xl.current};const ze=ax(Wi,kn,J.x,J.y,le,ne,be,Ae,Tn);if(ze.abbreviation=Yf(Wi),Tn&&ze.designator){const je=Xf(Wi),Ee=ze.designator.match(new RegExp(`^${je.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(\\d+)$`));if(Ee){const Me=parseInt(Ee[1],10);if(Uo){const G=Id();cx(je,Me,G)}else xl.current[je]=Math.max(xl.current[je]||0,Me)}}dl(_e,Je,dt,ki,ii),kn==="top"?(vn(!0),tn(je=>[...je,ze])):(wt(!0),bn(je=>[...je,ze]));return}else if(B==="power"){if(!tl)return;const le=Yl?{x:Yt({x:Q,y:q}).x,y:Yt({x:Q,y:q}).y}:((be,Ae)=>{let ze=1/0,je=null;const Me=10/We,G=We>20?Math.max(Me,1e-4):We>10?Math.max(Me,.001):Math.max(Me,.01);for(const ue of _e)if(ue.type==="via"||ue.type==="pad"){const Ne=ue.points[0],Fe=Math.hypot(Ne.x-be,Ne.y-Ae);Fe<=G&&Fe<ze&&(ze=Fe,je=Ne)}else if(ue.type==="trace")for(const Ne of ue.points){const Fe=Math.hypot(Ne.x-be,Ne.y-Ae);Fe<=G&&Fe<ze&&(ze=Fe,je=Ne)}const ve=Yt(je??{x:be,y:Ae});return{x:ve.x,y:ve.y,nodeId:je?.id}})(Q,q),ne=Xe.find(be=>be.id===tl);if(ne){const be=le.nodeId??qo(),Ae=`${ne.voltage} Power Node`;if(st.find(Ee=>Ee.pointId===be)){Ya({visible:!0,title:"Node ID Conflict",message:`Cannot place power node: A ground node already exists at this Node ID (${be}). Power and ground nodes cannot share the same Node ID.`});return}dl(_e,Je,dt,ki,ii);const je={id:`power-${Date.now()}-${Math.random()}`,x:le.x,y:le.y,color:"#ff0000",size:N,powerBusId:ne.id,layer:tt,type:Ae,pointId:be};if(ni(Ee=>[...Ee,je]),le.nodeId!==void 0){const Ee=Ii(le.nodeId,Xe),Me=Vi(le.nodeId,Xe),G=fo(le.nodeId,Xe),_=G.includes("Power")?"power":G.includes("Ground")?"ground":G.includes("Signal")?"signal":"unknown";Pt(ve=>ve.map(ue=>ue.type==="via"&&ue.points.length>0&&ue.points[0].id===le.nodeId?{...ue,viaType:Ee}:ue.type==="pad"&&ue.points.length>0&&ue.points[0].id===le.nodeId?{...ue,padType:Me}:ue.type==="testPoint"&&ue.points.length>0&&ue.points[0].id===le.nodeId?{...ue,testPointType:_}:ue))}}return}else if(B==="ground"){if(nl===null){if(qt.length===0){Ya({visible:!0,title:"No Ground Bus",message:"No ground buses are defined. Please create a ground bus first using Tools  Manage Ground Buses."});return}ti(!0);return}const J=qt.find(le=>le.id===nl);if(J){const ne=Yl?{x:Yt({x:Q,y:q}).x,y:Yt({x:Q,y:q}).y}:((Ee,Me)=>{let G=1/0,_=null;const ue=10/We,Ne=We>20?Math.max(ue,1e-4):We>10?Math.max(ue,.001):Math.max(ue,.01);for(const Ye of _e)if(Ye.type==="via"||Ye.type==="pad"){const et=Ye.points[0],it=Math.hypot(et.x-Ee,et.y-Me);it<=Ne&&it<G&&(G=it,_=et)}else if(Ye.type==="trace")for(const et of Ye.points){const it=Math.hypot(et.x-Ee,et.y-Me);it<=Ne&&it<G&&(G=it,_=et)}const nt=Yt(_??{x:Ee,y:Me});return{x:nt.x,y:nt.y,nodeId:_?.id}})(Q,q),be=ne.nodeId??qo(),Ae=`${J.name} Ground Node`,ze=yt.find(Ee=>Ee.pointId===be);if(ze){Ya({visible:!0,title:"Node ID Conflict",message:`Cannot place ground node: A power node (${ze.type||"Power Node"}) already exists at this Node ID (${be}). Power and ground nodes cannot share the same Node ID.`});return}dl(_e,Je,dt,ki,ii);const je={id:`gnd-${Date.now()}-${Math.random().toString(36).slice(2,6)}`,x:ne.x,y:ne.y,color:J.color,size:N||Ht.get("ground")?.settings.size||18,groundBusId:J.id,layer:tt,type:Ae,pointId:be};if(Qn(Ee=>[...Ee,je]),ne.nodeId!==void 0){const Ee=Ii(ne.nodeId,Xe),Me=Vi(ne.nodeId,Xe);Pt(G=>G.map(_=>_.type==="via"&&_.points.length>0&&_.points[0].id===ne.nodeId?{..._,viaType:Ee}:_.type==="pad"&&_.points.length>0&&_.points[0].id===ne.nodeId?{..._,padType:Me}:_))}}return}},[B,Mt,N,L,De,tt,_e,We,zt.x,zt.y,Yl,tl,nl,Xe,qt,Wi,Ht,Ft,pt,sn,yt,st,Ii,Vi,fo,dn,jn,Nn]),dd=m.useCallback(o=>{if(B!=="magnify")return;o.preventDefault();const r=On.current;if(!r)return;const f=r.getBoundingClientRect(),b=r.width/f.width,y=r.height/f.height,v=o.nativeEvent.offsetX,x=o.nativeEvent.offsetY,T=typeof v=="number"?v:o.clientX-f.left,C=typeof x=="number"?x:o.clientY-f.top,k=T*b,A=C*y,M=(k-5-zt.x)/We,ie=(A-5-zt.y)/We,Q=1.2,q=1/Q,J=o.deltaY<0?Q:q,le=Math.max(.25,Math.min(8,We*J)),ne=k-5-le*M,be=A-5-le*ie;Ci(le),Vn({x:ne,y:be})},[B,We,zt.x,zt.y]),nu=m.useCallback(o=>{if(B==="draw"&&De==="trace"){Jl.current=!0;let ne=Xt;if(ne.length>1){const be=[ne[0]];for(let Ae=1;Ae<ne.length;Ae++){const ze=be[be.length-1],je=ne[Ae];(Math.abs(ze.x-je.x)>.001||Math.abs(ze.y-je.y)>.001)&&be.push(je)}ne=be}if(ne.length>=1){dl(_e,Je,dt,ki,ii);const be=pt||"top",Ae=be==="top"?"traceTop":"traceBottom",ze=At.get(Ae),je={id:`${Date.now()}-trace`,points:ne,color:ze.color,size:ze.size,layer:be,type:"trace"};Pt(Ee=>[...Ee,je]),be==="top"?no(Ee=>[...Ee,je.id]):cn(Ee=>[...Ee,je.id]),hi([]),Pi(null),setTimeout(()=>{Jl.current=!1},300);return}}const r=On.current;if(!r)return;const f=r.getBoundingClientRect(),b=r.width/f.width,y=r.height/f.height,v=o.nativeEvent.offsetX,x=o.nativeEvent.offsetY,T=typeof v=="number"?v:o.clientX-f.left,C=typeof x=="number"?x:o.clientY-f.top,k=T*b,A=C*y,M=k-5,ie=A-5,Q=(M-zt.x)/We,q=(ie-zt.y)/We,J=Math.max(8/We,4),le=(()=>{for(const ne of _e)if(ne.type==="testPoint"&&ne.points.length>0){const be=ne.points[0],Ae=Math.hypot(be.x-Q,be.y-q),ze=(ne.size||18)/2;if(Ae<=ze+J)return ne}return null})();if(le){ct(new Set([le.id])),gt(new Set),at(new Set),ht(new Set),Ho(!0);return}if(B==="select"||B==="component"){const be=(()=>{for(const je of Je)if(Q>=je.x-10&&Q<=je.x+10&&q>=je.y-10&&q<=je.y+10)return{layer:"top",comp:je};for(const je of dt)if(Q>=je.x-10&&Q<=je.x+10&&q>=je.y-10&&q<=je.y+10)return{layer:"bottom",comp:je};return null})(),Ae=Math.max(6/We,4);let ze=null;for(const je of yt){const Ee=Math.max(6,je.size/2),Me=Ee*.8,G=Ee+Me,_=Math.hypot(je.x-Q,je.y-q),ve=Math.abs(Q-je.x)<=Ae&&Math.abs(q-je.y)<=G,ue=Math.abs(q-je.y)<=Ae&&Math.abs(Q-je.x)<=G;if(_<=Math.max(Ee,Ae)||ve||ue){ze=je;break}}if(ze){at(new Set([ze.id])),ia({visible:!0,id:ze.id,layer:ze.layer,x:ze.x,y:ze.y,size:ze.size,color:ze.color,powerBusId:ze.powerBusId});return}if(be){const{layer:je,comp:Ee}=be;zr(Ee,je)}}},[B,De,L,N,tt,Je,dt,yt,We,zt.x,zt.y,Wi,Er,Yl,_e,Mt,ya,eu,An,Ht,Xt,pt,D,O,W,Se,Ho,ct,gt,at,ht,zr]),Fr=m.useCallback(()=>{const o=Ql.current;if(B==="draw"&&De==="trace"&&o.length>=2){let r=[o[0]];for(let x=1;x<o.length;x++){const T=r[r.length-1],C=o[x];(Math.abs(T.x-C.x)>.001||Math.abs(T.y-C.y)>.001)&&r.push(C)}const f=pt||"top",b=f==="top"?"traceTop":"traceBottom",y=At.get(b),v={id:`${Date.now()}-trace`,points:r,color:y.color,size:y.size,layer:f,type:"trace"};dl(_e,Je,dt,ki,ii),Pt(x=>[...x,v]),f==="top"?no(x=>[...x,v.id]):cn(x=>[...x,v.id]),hi([]),Pi(null)}else if(B==="draw"&&De==="trace"&&o.length===1){const r=pt||"top",f=r==="top"?"traceTop":"traceBottom",b=At.get(f),y={id:`${Date.now()}-trace-dot`,points:o,color:b.color,size:b.size,layer:r,type:"trace"};Pt(v=>[...v,y]),r==="top"?no(v=>[...v,y.id]):cn(v=>[...v,y.id]),hi([])}},[B,De,pt,D,O,W,Se,Pt]),ud=m.useCallback((o,r,f)=>{const b=r-o.x,y=f-o.y;if(b===0&&y===0)return{x:r,y:f};const x=(Math.atan2(y,b)*180/Math.PI%180+180)%180,T=[0,45,90];let C=0,k=1e9;for(const A of T){const M=Math.abs(x-A);M<k&&(k=M,C=A)}if(C===0)return{x:r,y:o.y};if(C===90)return{x:o.x,y:f};{const A=Math.min(Math.abs(b),Math.abs(y)),M=b>=0?1:-1,ie=y>=0?1:-1;return{x:o.x+M*A,y:o.y+ie*A}}},[]),iu=m.useCallback(o=>{const r=On.current?.getBoundingClientRect();if(!r)return;const f=o.clientX-r.left,b=o.clientY-r.top,y=On.current,v=y.width/r.width,x=y.height/r.height,T=f*v,C=b*x,k=T-5,A=C-5,M=(k-zt.x)/We,ie=(A-zt.y)/We;if(B==="draw"&&De==="trace"&&Xt.length>0){const q=Yl?{x:Yt({x:M,y:ie}).x,y:Yt({x:M,y:ie}).y}:((J,le)=>{let ne=1/0,be=null;const ze=10/We,je=We>20?Math.max(ze,1e-4):We>10?Math.max(ze,.001):Math.max(ze,.01);for(const G of _e)if(G.type==="via"){const _=G.points[0],ve=Math.hypot(_.x-J,_.y-le);ve<=je&&ve<ne&&(ne=ve,be=_)}else if(G.type==="pad"){const _=G.points[0],ve=Math.hypot(_.x-J,_.y-le);ve<=je&&ve<ne&&(ne=ve,be=_)}for(const G of yt)if(G.pointId!==void 0){const _=Math.hypot(G.x-J,G.y-le);_<=je&&_<ne&&(ne=_,be={x:G.x,y:G.y,id:G.pointId})}for(const G of st)if(G.pointId!==void 0){const _=Math.hypot(G.x-J,G.y-le);_<=je&&_<ne&&(ne=_,be={x:G.x,y:G.y,id:G.pointId})}const Me=Yt(be??{x:J,y:le});return{x:Me.x,y:Me.y,nodeId:be?.id}})(M,ie);Pi({x:q.x,y:q.y})}else Pi(null);if(Do){const q=(()=>{for(const J of Je)if(M>=J.x-10&&M<=J.x+10&&ie>=J.y-10&&ie<=J.y+10)return{layer:"top",comp:J};for(const J of dt)if(M>=J.x-10&&M<=J.x+10&&ie>=J.y-10&&ie<=J.y+10)return{layer:"bottom",comp:J};return null})();if(q)ao({component:q.comp,layer:q.layer,x:o.clientX,y:o.clientY}),pl(null);else{ao(null);const J=Math.max(8/We,4),le=(()=>{for(const ne of _e)if(ne.type==="testPoint"&&ne.points.length>0){const be=ne.points[0],Ae=Math.hypot(be.x-M,be.y-ie),ze=(ne.size||18)/2;if(Ae<=ze+J)return ne}return null})();pl(le?{stroke:le,x:o.clientX,y:o.clientY}:null)}}else ao(null),pl(null);if(B==="select"&&Wa&&ss){const Q=ss.x,q=ss.y;sd({x:Math.min(Q,M),y:Math.min(q,ie),width:Math.abs(M-Q),height:Math.abs(ie-q)})}else if(B==="pan"&&ya&&qa.current){const{startCX:Q,startCY:q,panX:J,panY:le}=qa.current,ne=k-Q,be=A-q;Vn({x:J+ne,y:le+be})}else if(Kl&&Xt.length>0){if(B==="draw")if(ms){const Q=Xt[0],q=ud(Q,M,ie),J=Yt(q),le={id:qo(),x:J.x,y:J.y};hi([Q,le])}else{const Q=Yt({x:M,y:ie});hi(q=>[...q,{id:qo(),x:Q.x,y:Q.y}])}else if(B==="erase"&&(hi(Q=>[...Q,{id:qo(),x:M,y:ie}]),Pt(Q=>{const q=Q.filter(le=>{if(le.type==="via"&&mi||le.type==="pad"&&_i||le.type==="testPoint"&&Co||le.type==="trace"&&vi||le.layer!==tt)return!0;const ne=N/2,be=M-ne,Ae=M+ne,ze=ie-ne,je=ie+ne,Ee=(_,ve)=>_>=be&&_<=Ae&&ve>=ze&&ve<=je,Me=(_,ve,ue,Ne)=>{const vt=(kt,zn)=>{let St=0;return kt<be?St|=1:kt>Ae&&(St|=2),zn<ze?St|=4:zn>je&&(St|=8),St};let lt=_,Pe=ve,ut=ue,$t=Ne,Jt=vt(lt,Pe),It=vt(ut,$t);for(;;){if((Jt|It)===0)return!0;if((Jt&It)!==0)return!1;const kt=Jt!==0?Jt:It;let zn=0,St=0;kt&8?(zn=lt+(ut-lt)*(je-Pe)/($t-Pe),St=je):kt&4?(zn=lt+(ut-lt)*(ze-Pe)/($t-Pe),St=ze):kt&2?(St=Pe+($t-Pe)*(Ae-lt)/(ut-lt),zn=Ae):(St=Pe+($t-Pe)*(be-lt)/(ut-lt),zn=be),kt===Jt?(lt=zn,Pe=St,Jt=vt(lt,Pe)):(ut=zn,$t=St,It=vt(ut,$t))}};let G=!1;if(le.points.length===1){const _=le.points[0];G=Ee(_.x,_.y)}else for(let _=0;_<le.points.length-1;_++){const ve=le.points[_],ue=le.points[_+1];if(Me(ve.x,ve.y,ue.x,ue.y)){G=!0;break}}return G&&console.log("Erasing stroke at position:",M,ie,"brushSize:",N,"selectedLayer:",tt),!G});console.log("Strokes before:",Q.length,"after:",q.length);const J=new Set(q.map(le=>le.id));return wn(le=>le.filter(ne=>J.has(ne))),xi(le=>le.filter(ne=>J.has(ne))),no(le=>le.filter(ne=>J.has(ne))),cn(le=>le.filter(ne=>J.has(ne))),q}),Rn||ni(Q=>{const q=N/2,J=M-q,le=M+q,ne=ie-q,be=ie+q,Ae=ze=>{const je=ze.size/2,Ee=ze.x-je,Me=ze.x+je,G=ze.y-je,_=ze.y+je;return!(le<Ee||J>Me||be<G||ne>_)};return Q.filter(ze=>!Ae(ze))}),Ei||Qn(Q=>{const q=N/2,J=M-q,le=M+q,ne=ie-q,be=ie+q,Ae=je=>{const Ee=Math.max(6,(je.size||18)/2),Me=Ee*.8,G=Ee+Me,_=je.x-G,ve=je.x+G,ue=je.y-G,Ne=je.y+G;return!(le<_||J>ve||be<ue||ne>Ne)};return Q.filter(je=>!Ae(je))}),!Hi)){const Q=N/2,q=M-Q,J=M+Q,le=ie-Q,ne=ie+Q,be=Ae=>{const je=(Ae.size||18)/2,Ee=Ae.x-je,Me=Ae.x+je,G=Ae.y-je,_=Ae.y+je;return!(J<Ee||q>Me||ne<G||le>_)};dl(_e,Je,dt,ki,ii),tn(Ae=>Ae.filter(ze=>!be(ze))),bn(Ae=>Ae.filter(ze=>!be(ze)))}}else if(eo&&_a&&Mt){if(Ri){Li(!1),Oi(null);return}const Q=M-_a.x,q=ie-_a.y;if(Mt==="top"){g&&d(J=>J?{...J,x:J.x+Q,y:J.y+q}:null),Oi({x:M,y:ie});return}if(Mt==="bottom"){R&&F(J=>J?{...J,x:J.x+Q,y:J.y+q}:null),Oi({x:M,y:ie});return}if(Mt==="both"){g&&d(J=>J?{...J,x:J.x+Q,y:J.y+q}:null),R&&F(J=>J?{...J,x:J.x+Q,y:J.y+q}:null),Oi({x:M,y:ie});return}}},[Kl,Xt,B,N,eo,_a,Mt,g,R,ms,ud,tt,Pt,We,zt.x,zt.y,Wa,ss,Ri,mi,_i,vi,Rn,Ei,Je,dt,tn,bn,Do,ao,Yl,_e,yt,st,Xt,De,Rl,Pi,ya,qa,Vn,5,zt,qo,Yt,te,Ki,dl,ki,ii]),fd=m.useCallback(()=>{if(B==="select"&&Wa){const o=$o,r=ss;if(Xi(!1),bc(null),sd(null),o&&r){const y=Math.max(3,5/We),v=o.width<y&&o.height<y,x=(G,_)=>{const ve=o.x,ue=o.y,Ne=o.x+o.width,Fe=o.y+o.height;return G>=ve&&G<=Ne&&_>=ue&&_<=Fe},T=(G,_,ve,ue,Ne,Fe,nt,Ye)=>{const ut=(gn,Yo)=>{let ll=0;return gn<Ne?ll|=1:gn>nt&&(ll|=2),Yo<Fe?ll|=4:Yo>Ye&&(ll|=8),ll};let $t=G,Jt=_,It=ve,kt=ue,zn=ut($t,Jt),St=ut(It,kt);for(;;){if((zn|St)===0)return!0;if((zn&St)!==0)return!1;const gn=zn!==0?zn:St;let Yo=0,ll=0;gn&8?(Yo=$t+(It-$t)*(Ye-Jt)/(kt-Jt),ll=Ye):gn&4?(Yo=$t+(It-$t)*(Fe-Jt)/(kt-Jt),ll=Fe):gn&2?(ll=Jt+(kt-Jt)*(nt-$t)/(It-$t),Yo=nt):(ll=Jt+(kt-Jt)*(Ne-$t)/(It-$t),Yo=Ne),gn===zn?($t=Yo,Jt=ll,zn=ut($t,Jt)):(It=Yo,kt=ll,St=ut(It,kt))}},C=o.x,k=o.y,A=o.x+o.width,M=o.y+o.height,Q=Math.max(6/We,4/We,.5),q=(G,_,ve,ue,Ne,Fe)=>{const nt=Ne-ve,Ye=Fe-ue;if(nt===0&&Ye===0)return Math.hypot(G-ve,_-ue);const et=Math.max(0,Math.min(1,((G-ve)*nt+(_-ue)*Ye)/(nt*nt+Ye*Ye))),it=ve+et*nt,vt=ue+et*Ye;return Math.hypot(G-it,_-vt)},J=r?.shiftKey===!0,le=new Set(J?Array.from(qe):[]),ne=new Set(J?Array.from(mt):[]),be=new Set(J?Array.from(Et):[]),Ae=new Set(J?Array.from(jt):[]),ze=r?.hitStrokeId;if(ze){const G=_e.find(_=>_.id===ze);if(G){let _=!1;if(G.type==="via"||G.type==="pad"?_=dn:_=G.layer==="top"?qn:Jn,_){J?ct(ve=>{const ue=new Set(ve);return ue.has(ze)?ue.delete(ze):ue.add(ze),ue}):(ct(new Set([ze])),gt(new Set),at(new Set),ht(new Set));return}}}if(v){let G=null;for(const _ of _e){let ve=!1;if(_.type==="via"?ve=dn:_.type==="pad"?ve=(_.layer||"top")==="top"?jn:Nn:_.type==="testPoint"?ve=(_.layer||"top")==="top"?ei:hl:_.type==="trace"?ve=_.layer==="top"?qn:Jn:ve=!1,!ve)continue;let ue=1/0;if(_.type==="via"||_.type==="pad"||_.type==="testPoint"){const Ne=_.points[0],Fe=Math.max(1,_.size/2);ue=Math.hypot(Ne.x-r.x,Ne.y-r.y);const Ye=Math.max(6/We,4/We,.5);ue<=Math.max(Fe,Ye)&&(!G||ue<G.dist)&&(G={id:_.id,dist:ue})}else for(let Ne=0;Ne<_.points.length-1;Ne++){const Fe=_.points[Ne],nt=_.points[Ne+1],Ye=q(r.x,r.y,Fe.x,Fe.y,nt.x,nt.y);if(Ye<=Math.max(Q,_.size/2)){(!G||Ye<G.dist)&&(G={id:_.id,dist:Ye});break}}}G&&(J&&le.has(G.id)?le.delete(G.id):le.add(G.id))}else for(const G of _e){let _=!1;if(G.type==="via"?_=dn:G.type==="pad"?_=(G.layer||"top")==="top"?jn:Nn:G.type==="testPoint"?_=(G.layer||"top")==="top"?ei:hl:G.type==="trace"?_=G.layer==="top"?qn:Jn:_=!1,!_)continue;let ve=!1;if(G.type==="via"||G.type==="pad"||G.type==="testPoint"){const ue=G.points[0];ve=x(ue.x,ue.y)}else for(let ue=0;ue<G.points.length-1;ue++){const Ne=G.points[ue],Fe=G.points[ue+1];if(T(Ne.x,Ne.y,Fe.x,Fe.y,C,k,A,M)||x(Ne.x,Ne.y)&&x(Fe.x,Fe.y)){ve=!0;break}}ve&&(J&&le.has(G.id)?le.delete(G.id):le.add(G.id))}const je=G=>{const ve=Math.max(10,G.size||18)/2;return G.x-ve<=A&&G.x+ve>=C&&G.y-ve<=M&&G.y+ve>=k};if(v){const G=_=>{const ue=Math.max(10,_.size||18)/2;return r.x>=_.x-ue&&r.x<=_.x+ue&&r.y>=_.y-ue&&r.y<=_.y+ue};el&&Je.forEach(_=>{G(_)&&(J&&ne.has(_.id)?ne.delete(_.id):ne.add(_.id))}),Ut&&dt.forEach(_=>{G(_)&&(J&&ne.has(_.id)?ne.delete(_.id):ne.add(_.id))})}else el&&Je.forEach(G=>{je(G)&&(J&&ne.has(G.id)?ne.delete(G.id):ne.add(G.id))}),Ut&&dt.forEach(G=>{je(G)&&(J&&ne.has(G.id)?ne.delete(G.id):ne.add(G.id))});const Ee=G=>{const _=Math.max(6,G.size/2),ve=_*.8,ue=_+ve;return G.x-ue<=A&&G.x+ue>=C&&G.y-ue<=M&&G.y+ue>=k};if(si)if(v){let G=null;for(const _ of yt){const ve=Math.max(6,_.size/2),ue=ve*.8,Ne=ve+ue,Fe=Math.hypot(_.x-r.x,_.y-r.y),nt=Math.abs(r.x-_.x)<=Q&&Math.abs(r.y-_.y)<=Ne,Ye=Math.abs(r.y-_.y)<=Q&&Math.abs(r.x-_.x)<=Ne;if(Fe<=Math.max(ve,Q)||nt||Ye){const it=Math.min(Fe,Math.abs(r.x-_.x)+Math.abs(r.y-_.y));(!G||it<G.dist)&&(G={id:_.id,dist:it})}}G&&(J&&be.has(G.id)?be.delete(G.id):be.add(G.id))}else yt.forEach(G=>{Ee(G)&&(J&&be.has(G.id)?be.delete(G.id):be.add(G.id))});const Me=G=>{const _=Math.max(6,(G.size||18)/2),ve=_*.8,ue=_+ve;return G.x-ue<=A&&G.x+ue>=C&&G.y-ue<=M&&G.y+ue>=k};if(Wl)if(v){let G=null;for(const _ of st){const ve=Math.max(6,(_.size||18)/2),ue=ve*.8,Ne=ve+ue,Fe=Math.hypot(_.x-r.x,_.y-r.y),nt=Math.abs(r.x-_.x)<=Q&&Math.abs(r.y-_.y)<=Ne,Ye=Math.abs(r.y-_.y)<=Q&&Math.abs(r.x-_.x)<=Ne;if(Fe<=Math.max(ve,Q)||nt||Ye){const it=Math.min(Fe,Math.abs(r.x-_.x)+Math.abs(r.y-_.y));(!G||it<G.dist)&&(G={id:_.id,dist:it})}}G&&(J&&Ae.has(G.id)?Ae.delete(G.id):Ae.add(G.id))}else st.forEach(G=>{Me(G)&&(J&&Ae.has(G.id)?Ae.delete(G.id):Ae.add(G.id))});ct(le),gt(ne),at(be),ht(Ae)}}if(Kl&&Xt.length>0){if(B==="draw"&&De!=="trace"){const o={id:Date.now().toString(),points:Xt,color:L,size:N,layer:tt,type:"trace"};Pt(r=>[...r,o]),tt==="top"?no(r=>[...r,o.id]):cn(r=>[...r,o.id])}hi([])}ya&&(As(!1),qa.current=null,Ns.current=null),jo(!1),Li(!1),Oi(null),mr(!1)},[Kl,Xt,B,L,N,tt,$o,ss,Wa,_e,We,oc,qe,yt,st,Je,dt,mt,Et,jt,dn,qn,Jn,el,Ut,si,Wl]);Oe.useEffect(()=>{if(!(B==="pan"&&ya&&Ns.current))return;const o=f=>{const b=On.current;if(!b)return;const y=b.getBoundingClientRect(),v=b.width/y.width,x=b.height/y.height,{startClientX:T,startClientY:C,panX:k,panY:A}=Ns.current,M=(f.clientX-T)*v,ie=(f.clientY-C)*x;Vn({x:k+M,y:A+ie})},r=()=>{As(!1),qa.current=null,Ns.current=null,window.removeEventListener("mousemove",o,!0),window.removeEventListener("mouseup",r,!0)};return window.addEventListener("mousemove",o,!0),window.addEventListener("mouseup",r,!0),()=>{window.removeEventListener("mousemove",o,!0),window.removeEventListener("mouseup",r,!0)}},[B,ya]);const $r=m.useCallback(()=>{const o=On.current;if(!o)return;const r=o.getContext("2d");if(!r)return;r.clearRect(0,0,o.width,o.height),r.fillStyle="#000000",r.fillRect(0,0,o.width,o.height),r.fillStyle="#ffffff",r.fillRect(5,5,o.width-10,o.height-10),r.save(),r.beginPath(),r.rect(5,5,o.width-10,o.height-10),r.clip(),r.translate(5,5);const f=(y,v,x,T,C,k,A,M)=>{const ie=document.createElement("canvas");ie.width=x,ie.height=T;const Q=ie.getContext("2d",{willReadFrequently:!0});Q.clearRect(0,0,x,T),Q.drawImage(v,0,0,x,T);let q=ie;if(Math.abs(C)>1e-6){const J=Math.tan(C),le=Math.max(.2,1-J),ne=Math.max(.2,1+J),be=Math.max(le,ne),Ae=Math.max(1,Math.ceil(x*be)),ze=document.createElement("canvas");ze.width=Ae,ze.height=T;const je=ze.getContext("2d",{willReadFrequently:!0});je.clearRect(0,0,Ae,T);for(let Ee=0;Ee<T;Ee++){const Me=T<=1?0:Ee/(T-1),G=le*(1-Me)+ne*Me,_=Math.max(1,x*G),ve=(Ae-_)/2;je.drawImage(q,0,Ee,x,1,ve,Ee,_,1)}q=ze}if(Math.abs(k)>1e-6){const J=Math.tan(k),le=Math.max(.2,1-J),ne=Math.max(.2,1+J),be=Math.max(le,ne),Ae=Math.max(1,Math.ceil(T*be)),ze=document.createElement("canvas");ze.width=q.width,ze.height=Ae;const je=ze.getContext("2d",{willReadFrequently:!0});je.clearRect(0,0,ze.width,Ae);for(let Ee=0;Ee<q.width;Ee++){const Me=q.width<=1?0:Ee/(q.width-1),G=le*(1-Me)+ne*Me,_=Math.max(1,T*G),ve=(Ae-_)/2;je.drawImage(q,Ee,0,1,q.height,Ee,ve,1,_)}q=ze}y.drawImage(q,-A/2,-M/2,A,M)};r.translate(zt.x,zt.y),r.scale(We,We);{const y=va&&Sa;if(g&&g.bitmap&&va){const v=g.bitmap;r.save(),r.globalAlpha=1;const x=[];if(g.brightness!==void 0&&g.brightness!==100&&x.push(`brightness(${g.brightness}%)`),g.contrast!==void 0&&g.contrast!==100&&x.push(`contrast(${g.contrast}%)`),se&&x.push("grayscale(100%)"),r.filter=x.length>0?x.join(" "):"none",r.translate(g.x,g.y),r.rotate(g.rotation*Math.PI/180),g.skewX||g.skewY){const A=Math.tan(g.skewX||0),M=Math.tan(g.skewY||0);r.transform(1,M,A,1,0,0)}r.scale(g.scale*(g.flipX?-1:1),g.scale*(g.flipY?-1:1));const T=v.width*1,C=v.height*1,k=v;g.keystoneV&&Math.abs(g.keystoneV)>1e-6||g.keystoneH&&Math.abs(g.keystoneH)>1e-6?f(r,k,v.width,v.height,g.keystoneV||0,g.keystoneH||0,T,C):r.drawImage(k,-T/2,-C/2,T,C),r.restore()}if(R&&R.bitmap&&Sa){const v=R.bitmap;r.save(),r.globalAlpha=y?p/100:1;const x=[];if(R.brightness!==void 0&&R.brightness!==100&&x.push(`brightness(${R.brightness}%)`),R.contrast!==void 0&&R.contrast!==100&&x.push(`contrast(${R.contrast}%)`),se&&x.push("grayscale(100%)"),r.filter=x.length>0?x.join(" "):"none",r.translate(R.x,R.y),r.rotate(R.rotation*Math.PI/180),R.skewX||R.skewY){const A=Math.tan(R.skewX||0),M=Math.tan(R.skewY||0);r.transform(1,M,A,1,0,0)}r.scale(R.scale*(R.flipX?-1:1),R.scale*(R.flipY?-1:1));const T=v.width*1,C=v.height*1,k=v;R.keystoneV&&Math.abs(R.keystoneV)>1e-6||R.keystoneH&&Math.abs(R.keystoneH)>1e-6?f(r,k,v.width,v.height,R.keystoneV||0,R.keystoneH||0,T,C):r.drawImage(k,-T/2,-C/2,T,C),r.restore()}}if(lu(r),si&&yt.length>0){const y=v=>{r.save();const x=Xe.find(M=>M.id===v.powerBusId),T=Et.has(v.id),C=x?.color||"#ff0000";r.strokeStyle=C,r.lineWidth=Math.max(1,(T?3:2)/Math.max(We,.001)),r.lineCap="round";const k=Math.max(6,v.size/2),A=k*.8;if(T&&(r.strokeStyle="#0066ff",r.lineWidth=Math.max(1,4/Math.max(We,.001)),r.beginPath(),r.arc(v.x,v.y,k+A+3,0,Math.PI*2),r.stroke()),r.strokeStyle=C,r.lineWidth=Math.max(1,(T?3:2)/Math.max(We,.001)),r.beginPath(),r.arc(v.x,v.y,k,0,Math.PI*2),r.stroke(),r.beginPath(),r.moveTo(v.x,v.y-k-A),r.lineTo(v.x,v.y+k+A),r.stroke(),r.beginPath(),r.moveTo(v.x-k-A,v.y),r.lineTo(v.x+k+A,v.y),r.stroke(),x){r.fillStyle=C;const M=Math.max(10,k*.8);r.font=`${M}px sans-serif`,r.textAlign="center",r.textBaseline="top",r.fillText(x.name,v.x,v.y+k+A+8)}r.restore()};yt.forEach(y)}if(Wl&&st.length>0){const y=v=>{r.save();const x=jt.has(v.id),T=qt.find(M=>M.id===v.groundBusId),C=T?.color||v.color||"#000000",k=v.groundBusId==="groundbus-earth";let A;if(k){const M=Math.max(6,v.size||18),ie=M*.9,Q=M*.24,q=M*1.6;r.strokeStyle=C,r.lineWidth=Math.max(1,(x?3:2)/Math.max(We,.001)),r.lineCap="round",x&&(r.strokeStyle="#0066ff",r.lineWidth=Math.max(1,4/Math.max(We,.001)),r.setLineDash([5,5]),r.strokeRect(v.x-q/2-3,v.y-3,q+6,ie+Q*2+6),r.setLineDash([])),r.strokeStyle=C,r.lineWidth=Math.max(1,(x?3:2)/Math.max(We,.001)),r.beginPath(),r.moveTo(v.x,v.y),r.lineTo(v.x,v.y+ie),r.stroke();for(let J=0;J<3;J++){const le=v.y+ie+J*Q,ne=q*(1-J*.25);r.beginPath(),r.moveTo(v.x-ne/2,le),r.lineTo(v.x+ne/2,le),r.stroke()}A=v.y+ie+Q*2}else{const M=Math.max(6,(v.size||18)/2),ie=M*.8;x&&(r.strokeStyle="#0066ff",r.lineWidth=Math.max(1,4/Math.max(We,.001)),r.beginPath(),r.arc(v.x,v.y,M+ie+3,0,Math.PI*2),r.stroke()),r.strokeStyle=C,r.lineWidth=Math.max(1,(x?3:2)/Math.max(We,.001)),r.beginPath(),r.arc(v.x,v.y,M,0,Math.PI*2),r.stroke(),r.beginPath(),r.moveTo(v.x,v.y-M-ie),r.lineTo(v.x,v.y+M+ie),r.stroke(),r.beginPath(),r.moveTo(v.x-M-ie,v.y),r.lineTo(v.x+M+ie,v.y),r.stroke(),A=v.y+M+ie}if(T){r.fillStyle=C;const M=Math.max(10,(v.size||18)*.5);r.font=`${M}px sans-serif`,r.textAlign="center",r.textBaseline="top",r.fillText(T.name,v.x,A+8)}r.restore()};st.forEach(y)}const b=y=>{const v=Math.max(10,y.size||18),x=v/2;r.save(),r.strokeStyle=y.color||"#111",r.lineWidth=Math.max(1,2/Math.max(We,.001));const T=y.pinConnections||[],C=T.length>0&&T.length===y.pinCount&&T.every(M=>M&&M.trim()!=="");r.fillStyle=C?"rgba(178, 223, 138, 0.85)":"rgba(255,255,255,0.85)",r.beginPath(),r.rect(y.x-x,y.y-x,v,v),r.fill(),r.stroke();const k=y.designator?.trim()||"";if(k){r.fillStyle=y.color||"#111";const M=Math.max(6,v*.35),ie=v*.9;let Q=M;r.font=`bold ${Q}px sans-serif`;const q=r.measureText(k);q.width>ie&&(Q=ie/q.width*Q,Q=Math.max(6,Q),r.font=`bold ${Q}px sans-serif`),r.textAlign="center",r.textBaseline="middle",r.fillText(k,y.x,y.y)}mt.has(y.id)&&(r.setLineDash([4,3]),r.strokeStyle="#00bfff",r.lineWidth=1.5,r.strokeRect(y.x-x-3,y.y-x-3,v+6,v+6),r.setLineDash([])),r.restore()};if(ja){const y=x=>{const T=parseInt(x,10);if(isNaN(T))return null;for(const C of _e)if((C.type==="via"||C.type==="pad"||C.type==="testPoint")&&C.points.length>0){const k=C.points[0];if(k.id===T)return{x:k.x,y:k.y}}for(const C of _e)if(C.type==="trace"){for(const k of C.points)if(k.id===T)return{x:k.x,y:k.y}}for(const C of yt)if(C.pointId===T)return{x:C.x,y:C.y};for(const C of st)if(C.pointId===T)return{x:C.x,y:C.y};return null},v=x=>{const T=x.pinConnections||[],C=x.componentType==="Electrolytic Capacitor"||x.componentType==="Diode"||x.componentType==="Battery"||x.componentType==="ZenerDiode",k=x.componentType==="Capacitor"&&"dielectric"in x&&x.dielectric==="Tantalum",A=(C||k)&&x.pinPolarities,M=new Map;for(let ie=0;ie<T.length;ie++){const Q=T[ie];if(Q&&Q.trim()!==""){const q=Q.trim(),J=!!(A&&x.pinPolarities&&ie<x.pinPolarities.length&&x.pinPolarities[ie]==="-"),le=M.get(q);le!==void 0?M.set(q,le||J):M.set(q,J)}}for(const[ie,Q]of M){const q=y(ie);if(q){const J={x:x.x,y:x.y};r.save(),r.strokeStyle=Q?"rgba(0, 0, 0, 0.8)":Zo,r.lineWidth=Math.max(1,Ko/Math.max(We,.001)),r.beginPath(),r.moveTo(J.x,J.y),r.lineTo(q.x,q.y),r.stroke(),r.restore()}}};el&&Je.forEach(v),Ut&&dt.forEach(v)}if(el&&Je.forEach(b),Ut&&dt.forEach(b),B==="select"&&$o){r.save();const y=Math.max(2,6/Math.max(1e-4,We));r.strokeStyle="#00bfff",r.fillStyle="rgba(0, 191, 255, 0.15)",r.lineWidth=Math.max(1,1.5/Math.max(1e-4,We)),r.setLineDash([y,y]),r.beginPath(),r.rect($o.x,$o.y,$o.width,$o.height),r.fill(),r.stroke(),r.setLineDash([]),r.restore()}r.restore()},[g,R,p,_e,Xt,Kl,B,L,N,se,Mt,tt,We,zt.x,zt.y,va,Sa,dn,qn,Jn,jn,Nn,ei,hl,el,Ut,Je,dt,si,yt,Wl,st,ja,$o,qe,mt,Et,jt,pt,D,O,W,Se,De,Rl,Ri,Zo,Ko,Fl]);Oe.useEffect(()=>{const o=()=>{const r=Ar.current;if(!r)return;const f=1.6,b=244,y=12,v=6,x=12,T=r.clientWidth-b-y,C=r.getBoundingClientRect(),k=window.innerHeight,A=C.top,ie=k-A-v-10,Q=Math.min(r.clientHeight-x,ie),q=Math.floor(Q*f),J=Math.floor(T/f);let le,ne;q<=T?(le=q,ne=Q):(le=T,ne=J),le=Math.max(600,le),ne=Math.max(375,ne),ne=Math.max(355,ne-20),sc(be=>{if(be.width!==le||be.height!==ne){const Ae=be.width-10,ze=be.height-10,je=le-10,Ee=ne-10,Me=Ae>0?je/Ae:1,G=ze>0?Ee/ze:1;Vn(_=>({x:_.x*Me,y:_.y*G}))}return be.width===le&&be.height===ne?be:{width:le,height:ne}})};return o(),window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[Vn]),Oe.useEffect(()=>{Ri&&(eo&&(Li(!1),Oi(null)),Ti(null))},[Ri,eo,Li,Oi,Ti]);const lu=m.useCallback(o=>{if(_e.forEach(r=>{if(r.type==="via"||r.type==="pad"||r.type==="testPoint"||r.testPointType!==void 0||r.type!=="trace")return;let f=!1;if(r.layer==="top"?f=qn:r.layer==="bottom"&&(f=Jn),!!f){if(r.points.length===1){const b=r.points[0],y=Math.max(.5,r.size/2);qe.has(r.id)&&(o.strokeStyle="#00bfff",o.lineWidth=2,o.setLineDash([4,3]),o.beginPath(),o.arc(b.x,b.y,y+3,0,Math.PI*2),o.stroke(),o.setLineDash([])),o.fillStyle=r.color,o.beginPath(),o.arc(b.x,b.y,y,0,Math.PI*2),o.fill()}else if(qe.has(r.id)&&(o.strokeStyle="#00bfff",o.lineWidth=r.size+4,o.lineCap="round",o.lineJoin="round",o.globalAlpha=.6,o.beginPath(),r.points.forEach((b,y)=>{y===0?o.moveTo(b.x,b.y):o.lineTo(b.x,b.y)}),o.stroke(),o.globalAlpha=1),o.strokeStyle=r.color,o.lineWidth=r.size,o.lineCap="round",o.lineJoin="round",o.globalAlpha=1,o.beginPath(),r.points.forEach((b,y)=>{y===0?o.moveTo(b.x,b.y):o.lineTo(b.x,b.y)}),o.stroke(),Fl){o.fillStyle="#000000";for(const b of r.points)o.beginPath(),o.arc(b.x,b.y,r.size/2,0,Math.PI*2),o.fill()}}}),_e.forEach(r=>{if(r.type==="via"){if(!dn)return}else if(r.type==="pad"){const b=r.layer||"top";if(b==="top"&&!jn||b==="bottom"&&!Nn)return}else if(r.type==="testPoint"){const b=r.layer||"top";if(b==="top"&&!ei||b==="bottom"&&!hl)return}else return;const f=r.points[0];if(qe.has(r.id)){if(r.type==="via"){const b=Math.max(.5,r.size/2)+3;o.strokeStyle="#00bfff",o.lineWidth=2,o.setLineDash([4,3]),o.beginPath(),o.arc(f.x,f.y,b,0,Math.PI*2),o.stroke(),o.setLineDash([])}else if(r.type==="pad"){const b=Math.max(.5,r.size/2)+3;o.strokeStyle="#00bfff",o.lineWidth=2,o.setLineDash([4,3]),o.strokeRect(f.x-b,f.y-b,r.size+6,r.size+6),o.setLineDash([])}else if(r.type==="testPoint"){const b=Math.max(.5,r.size/2)+3;o.strokeStyle="#00bfff",o.lineWidth=2,o.setLineDash([4,3]),o.beginPath(),o.moveTo(f.x,f.y-b),o.lineTo(f.x+b,f.y),o.lineTo(f.x,f.y+b),o.lineTo(f.x-b,f.y),o.closePath(),o.stroke(),o.setLineDash([])}}if(r.type==="via"){const b=Math.max(.5,r.size/2),y=b*.5,v=b*.7;o.fillStyle=r.color,o.beginPath(),o.arc(f.x,f.y,b,0,Math.PI*2),o.arc(f.x,f.y,y,0,Math.PI*2),o.fill("evenodd"),o.strokeStyle="#808080",o.lineWidth=1,o.beginPath(),o.moveTo(f.x-v,f.y),o.lineTo(f.x+v,f.y),o.stroke(),o.beginPath(),o.moveTo(f.x,f.y-v),o.lineTo(f.x,f.y+v),o.stroke()}else if(r.type==="pad"){const b=Math.max(.5,r.size/2),y=r.size,v=y*.5,x=b*.7;o.fillStyle=r.color,o.beginPath(),o.rect(f.x-b,f.y-b,y,y),o.rect(f.x-v/2,f.y-v/2,v,v),o.fill("evenodd"),o.strokeStyle="#808080",o.lineWidth=1,o.beginPath(),o.moveTo(f.x-x,f.y),o.lineTo(f.x+x,f.y),o.stroke(),o.beginPath(),o.moveTo(f.x,f.y-x),o.lineTo(f.x,f.y+x),o.stroke()}else if(r.type==="testPoint"){const b=Math.max(.5,r.size/2),y=b*.7;o.fillStyle=r.color||"#FFFF00",o.strokeStyle="#000000",o.lineWidth=2,o.beginPath(),o.moveTo(f.x,f.y-b),o.lineTo(f.x+b,f.y),o.lineTo(f.x,f.y+b),o.lineTo(f.x-b,f.y),o.closePath(),o.fill(),o.stroke(),o.strokeStyle="#808080",o.lineWidth=1,o.beginPath(),o.moveTo(f.x-y,f.y),o.lineTo(f.x+y,f.y),o.stroke(),o.beginPath(),o.moveTo(f.x,f.y-y),o.lineTo(f.x,f.y+y),o.stroke()}}),Xt.length>0){const r=tt;let f=!0;if(B==="draw"&&(De==="via"?f=dn:f=r==="top"?qn:Jn),f)if(B==="draw")if(De==="via"){const b=Xt[Xt.length-1],y=Math.max(.5,N/2),v=y*.5,x=y*.7;o.fillStyle=L,o.beginPath(),o.arc(b.x,b.y,y,0,Math.PI*2),o.arc(b.x,b.y,v,0,Math.PI*2),o.fill("evenodd"),o.strokeStyle="#808080",o.lineWidth=1,o.beginPath(),o.moveTo(b.x-x,b.y),o.lineTo(b.x+x,b.y),o.stroke(),o.beginPath(),o.moveTo(b.x,b.y-x),o.lineTo(b.x,b.y+x),o.stroke()}else if(De==="pad"){const b=Xt[Xt.length-1],y=Math.max(.5,N/2),v=N,x=v*.5,T=y*.7;o.fillStyle=L,o.beginPath(),o.rect(b.x-y,b.y-y,v,v),o.rect(b.x-x/2,b.y-x/2,x,x),o.fill("evenodd"),o.strokeStyle="#808080",o.lineWidth=1,o.beginPath(),o.moveTo(b.x-T,b.y),o.lineTo(b.x+T,b.y),o.stroke(),o.beginPath(),o.moveTo(b.x,b.y-T),o.lineTo(b.x,b.y+T),o.stroke()}else if(De==="testPoint"){const b=Xt[Xt.length-1],y=Math.max(.5,N/2),v=y*.7;o.fillStyle=L,o.beginPath(),o.moveTo(b.x,b.y-y),o.lineTo(b.x+y,b.y),o.lineTo(b.x,b.y+y),o.lineTo(b.x-y,b.y),o.closePath(),o.fill(),o.strokeStyle="#808080",o.lineWidth=1,o.beginPath(),o.moveTo(b.x-v,b.y),o.lineTo(b.x+v,b.y),o.stroke(),o.beginPath(),o.moveTo(b.x,b.y-v),o.lineTo(b.x,b.y+v),o.stroke()}else{const b=pt||"top",y=b==="top"?D:O,v=b==="top"?W:Se;if(Xt.length===1){const x=Xt[0],T=Math.max(.5,v/2);o.fillStyle=y,o.beginPath(),o.arc(x.x,x.y,T,0,Math.PI*2),o.fill(),Rl&&(o.strokeStyle=y,o.lineWidth=v,o.lineCap="round",o.lineJoin="round",o.globalAlpha=.6,o.beginPath(),o.moveTo(x.x,x.y),o.lineTo(Rl.x,Rl.y),o.stroke(),o.globalAlpha=1)}else if(o.strokeStyle=y,o.lineWidth=v,o.lineCap="round",o.lineJoin="round",o.globalAlpha=1,o.beginPath(),Xt.forEach((x,T)=>{T===0?o.moveTo(x.x,x.y):o.lineTo(x.x,x.y)}),o.stroke(),Rl&&Xt.length>0){const x=Xt[Xt.length-1];o.globalAlpha=.6,o.beginPath(),o.moveTo(x.x,x.y),o.lineTo(Rl.x,Rl.y),o.stroke(),o.globalAlpha=1}}else B==="erase"&&(o.strokeStyle="rgba(255, 0, 0, 0.5)",o.lineWidth=N,o.lineCap="round",o.lineJoin="round",o.globalAlpha=.5,o.beginPath(),Xt.forEach((b,y)=>{y===0?o.moveTo(b.x,b.y):o.lineTo(b.x,b.y)}),o.stroke())}},[_e,qe,qn,Jn,dn,jn,Nn,ei,hl,Xt,B,De,L,N,tt,pt,D,O,W,Se,Rl,Fl]),Da=m.useCallback((o,r)=>{if(Ri){alert("Cannot transform: Images are locked. Unlock images to transform them.");return}o==="top"&&g?d(f=>f?{...f,...r}:null):o==="bottom"&&R?F(f=>f?{...f,...r}:null):o==="both"&&(g&&d(f=>f?{...f,...r}:null),R&&F(f=>f?{...f,...r}:null))},[g,R,Ri]),pd=m.useCallback(()=>{Mt&&(Da(Mt,{x:0,y:0,scale:1,rotation:0,flipX:!1,flipY:!1,skewX:0,skewY:0,keystoneV:0,keystoneH:0,brightness:100,contrast:100}),Re(!1))},[Da,Mt]),Zs=m.useCallback(()=>{if(qe.size>0||mt.size>0||Et.size>0||jt.size>0){if(qe.size>0){const o=_e.filter(y=>qe.has(y.id)),r=mi&&o.some(y=>y.type==="via"),f=vi&&o.some(y=>y.type==="trace"),b=_i&&o.some(y=>y.type==="pad");if(r){alert("Cannot change size: Vias are locked. Unlock vias to change their size.");return}if(f){alert("Cannot change size: Traces are locked. Unlock traces to change their size.");return}if(b){alert("Cannot change size: Pads are locked. Unlock pads to change their size.");return}}if(mt.size>0&&Hi){alert("Cannot change size: Components are locked. Unlock components to change their size.");return}if(Et.size>0&&Rn){alert("Cannot change size: Power nodes are locked. Unlock power nodes to change their size.");return}if(jt.size>0&&Ei){alert("Cannot change size: Ground nodes are locked. Unlock ground nodes to change their size.");return}if(Pt(o=>o.map(r=>{if(qe.has(r.id)){const f=r.size+1;return r.type==="via"?Ze("via",f):r.type==="pad"?Ze("pad",f):r.type==="trace"&&Ze("trace",f,r.layer),{...r,size:f}}return r})),mt.size>0){const o=(mt.size>0&&Je.find(r=>mt.has(r.id))?.size||18)+1;Ze("component",o),tn(r=>r.map(f=>mt.has(f.id)?{...f,size:(f.size||18)+1}:f)),bn(r=>r.map(f=>mt.has(f.id)?{...f,size:(f.size||18)+1}:f))}if(Et.size>0){const o=(yt.find(r=>Et.has(r.id))?.size||18)+1;Ze("power",o),ni(r=>r.map(f=>Et.has(f.id)?{...f,size:f.size+1}:f))}if(jt.size>0){const o=(st.find(r=>jt.has(r.id))?.size||18)+1;Ze("ground",o),Qn(r=>r.map(f=>jt.has(f.id)?{...f,size:(f.size||18)+1}:f))}}else{let o=null;if(B==="draw"&&De==="via"?o="via":B==="draw"&&De==="pad"?o=Dl.current==="bottom"?"padBottom":"padTop":B==="draw"&&De==="testPoint"?o=rl.current==="bottom"?"testPointBottom":"testPointTop":B==="draw"&&De==="trace"?o=Qo.current==="bottom"?"traceBottom":"traceTop":B==="component"?o=Al.current==="bottom"?"componentBottom":"componentTop":B==="power"?o="power":B==="ground"&&(o="ground"),o){const r=At.get(o),f=Math.min(40,r.size+1);At.setSize(o,f)}}},[qe,mt,Et,jt,_e,mi,vi,_i,Co,Hi,Rn,Ei,B,De,Ze]),Ks=m.useCallback(()=>{if(qe.size>0||mt.size>0||Et.size>0||jt.size>0){if(qe.size>0){const o=_e.filter(v=>qe.has(v.id)),r=mi&&o.some(v=>v.type==="via"),f=vi&&o.some(v=>v.type==="trace"),b=_i&&o.some(v=>v.type==="pad"),y=Co&&o.some(v=>v.type==="testPoint");if(r){alert("Cannot change size: Vias are locked. Unlock vias to change their size.");return}if(f){alert("Cannot change size: Traces are locked. Unlock traces to change their size.");return}if(b){alert("Cannot change size: Pads are locked. Unlock pads to change their size.");return}if(y){alert("Cannot change size: Test Points are locked. Unlock test points to change their size.");return}}if(mt.size>0&&Hi){alert("Cannot change size: Components are locked. Unlock components to change their size.");return}if(Et.size>0&&Rn){alert("Cannot change size: Power nodes are locked. Unlock power nodes to change their size.");return}if(jt.size>0&&Ei){alert("Cannot change size: Ground nodes are locked. Unlock ground nodes to change their size.");return}if(Pt(o=>o.map(r=>{if(qe.has(r.id)){const f=Math.max(1,r.size-1);return r.type==="via"?Ze("via",f):r.type==="pad"?Ze("pad",f,r.layer):r.type==="testPoint"?Ze("testPoint",f,r.layer):r.type==="trace"&&Ze("trace",f,r.layer),{...r,size:f}}return r})),mt.size>0){const o=Math.max(1,(Je.find(r=>mt.has(r.id))?.size||18)-1);Ze("component",o),tn(r=>r.map(f=>mt.has(f.id)?{...f,size:Math.max(1,(f.size||18)-1)}:f)),bn(r=>r.map(f=>mt.has(f.id)?{...f,size:Math.max(1,(f.size||18)-1)}:f))}if(Et.size>0){const o=Math.max(1,(yt.find(r=>Et.has(r.id))?.size||18)-1);Ze("power",o),ni(r=>r.map(f=>Et.has(f.id)?{...f,size:Math.max(1,f.size-1)}:f))}if(jt.size>0){const o=Math.max(1,(st.find(r=>jt.has(r.id))?.size||18)-1);Ze("ground",o),Qn(r=>r.map(f=>jt.has(f.id)?{...f,size:Math.max(1,(f.size||18)-1)}:f))}}else{let o=null;if(B==="draw"&&De==="via"?o="via":B==="draw"&&De==="pad"?o=(tt||Ft||"top")==="bottom"?"padBottom":"padTop":B==="draw"&&De==="testPoint"?o=(tt||sn||"top")==="bottom"?"testPointBottom":"testPointTop":B==="draw"&&De==="trace"?o=(tt||pt||"top")==="bottom"?"traceBottom":"traceTop":B==="component"?o=(tt||kn||"top")==="bottom"?"componentBottom":"componentTop":B==="power"?o="power":B==="ground"&&(o="ground"),o){const r=At.get(o),f=Math.max(1,r.size-1);At.setSize(o,f)}}},[qe,mt,Et,jt,_e,mi,vi,_i,Co,Hi,Rn,Ei,B,De,tt,Ft,sn,pt,kn,Ze]),ou=m.useCallback(()=>{const o=ec.size;if(qe.size>0||mt.size>0||Et.size>0||jt.size>0){if(qe.size>0){const r=_e.filter(x=>qe.has(x.id)),f=mi&&r.some(x=>x.type==="via"),b=_i&&r.some(x=>x.type==="pad"),y=vi&&r.some(x=>x.type==="trace"),v=Co&&r.some(x=>x.type==="testPoint");if(f||b||y||v){alert("Cannot change size: selected items are locked.");return}}if(mt.size>0&&Hi){alert("Cannot change size: selected components are locked.");return}if(Et.size>0&&Rn){alert("Cannot change size: selected power nodes are locked.");return}if(jt.size>0&&Ei){alert("Cannot change size: selected ground nodes are locked.");return}Pt(r=>r.map(f=>qe.has(f.id)?(f.type==="via"?(Ze("via",o),rn(b=>{const y=new Map(b),v=y.get("via");return v&&y.set("via",{...v,settings:{...v.settings,size:o}}),y})):f.type==="pad"?(Ze("pad",o,f.layer),rn(b=>{const y=new Map(b),v=y.get("pad");if(v){const x=new Map(v.layerSettings);x.set(f.layer,{...x.get(f.layer)||{color:v.settings.color,size:o},size:o}),y.set("pad",{...v,layerSettings:x})}return y})):f.type==="testPoint"?(Ze("testPoint",o,f.layer),rn(b=>{const y=new Map(b),v=y.get("testPoint");if(v){const x=new Map(v.layerSettings);x.set(f.layer,{...x.get(f.layer)||{color:v.settings.color,size:o},size:o}),y.set("testPoint",{...v,layerSettings:x})}return y})):f.type==="trace"&&Ze("trace",o,f.layer),{...f,size:o}):f)),mt.size>0&&(Ze("component",o),tn(r=>r.map(f=>mt.has(f.id)?{...f,size:o}:f)),bn(r=>r.map(f=>mt.has(f.id)?{...f,size:o}:f))),Et.size>0&&(Ze("power",o),ni(r=>r.map(f=>Et.has(f.id)?{...f,size:o}:f))),jt.size>0&&(Ze("ground",o),Qn(r=>r.map(f=>jt.has(f.id)?{...f,size:o}:f)))}else z(o),B==="draw"&&De==="trace"?tt==="top"?(j(o),Ze("trace",o,"top")):(me(o),Ze("trace",o,"bottom")):B==="draw"&&De==="via"?Ze("via",o):B==="draw"&&De==="pad"?Ze("pad",o,tt):B==="draw"&&De==="testPoint"?Ze("testPoint",o,tt):Ze(B==="component"?"component":B==="power"?"power":B==="ground"?"ground":"brush",o);tc({visible:!1,size:6})},[ec.size,qe,mt,Et,jt,_e,mi,vi,Hi,Rn,Ei,B,De,tt,Ze,Ht,rn]),hd=m.useCallback(()=>{Di({visible:!1,source:null,interval:5})},[]),au=m.useCallback(async(o,r=!1)=>{if(o===null){Zi(!1),Ml(null),Zt.current&&(clearInterval(Zt.current),Zt.current=null),aa({visible:!1,interval:5}),r&&Di({visible:!1,source:null,interval:5}),console.log("Auto save: Disabled");return}if(!oi){alert("Please create a new project (File -> New Project) or open an existing project (File -> Open Project) first.");return}let f=on;if(!f){const x=window;if(typeof x.showDirectoryPicker=="function")try{f=await x.showDirectoryPicker(),Ul(f)}catch(T){T?.name!=="AbortError"&&(console.error("Failed to get directory:",T),alert("Failed to select project directory."));return}else{alert("Directory picker is not supported in this browser. Auto-save requires a directory handle.");return}}pa(f);const b=oi.replace(/\.json$/i,""),v=Wc(b).replace(/[^a-zA-Z0-9_-]/g,"_");Bl(v),Ma.current=f,Xl.current=v,Ml(o),Zi(!0),Ai.current=!0,aa({visible:!1,interval:5}),r&&Di({visible:!1,source:null,interval:5}),setTimeout(()=>{console.log(`Auto save: Enabled with interval ${o} minutes`),xa.current&&xa.current()},200)},[oi,on,Zi,Ml,pa,Bl,aa,Di,Ul]),Qs=m.useCallback(()=>{te("select"),ct(new Set),gt(new Set),at(new Set),ht(new Set)},[ct,gt,at,ht]),mc=m.useCallback(o=>{if(o.key==="Escape"){const y=document.activeElement;if(y&&(y.tagName==="INPUT"&&y.type==="checkbox"||y.tagName==="INPUT"&&y.type==="radio")){y.blur(),o.preventDefault(),o.stopPropagation();return}}const r=document.activeElement;if(r&&(r.tagName==="INPUT"&&r.type!=="checkbox"&&r.type!=="radio"||r.tagName==="TEXTAREA"||r.isContentEditable)||rs.current>0&&o.key!=="m"&&o.key!=="M")return;const b=parseInt(o.key);if(!isNaN(b)&&b>=0&&b<=9){if(o.preventDefault(),o.stopPropagation(),B==="center"&&fl){pn.current&&(clearTimeout(pn.current),pn.current=null);const v=On.current;if(v){const x=v.width-10,T=v.height-10,C=x/2,k=T/2,A=(C-zt.x)/We,M=(k-zt.y)/We;Za(ie=>({...ie,[b]:{x:A,y:M,zoom:We,showTopImage:va,showBottomImage:Sa,showViasLayer:dn,showTopTracesLayer:qn,showBottomTracesLayer:Jn,showTopPadsLayer:jn,showBottomPadsLayer:Nn,showTopTestPointsLayer:ei,showBottomTestPointsLayer:hl,showTopComponents:el,showBottomComponents:Ut,showPowerLayer:si,showGroundLayer:Wl,showConnectionsLayer:ja}}))}Ki(!1),te("select"),Wn(void 0);return}const y=Ms[b];if(y){Ci(y.zoom);const v=On.current;let x=0,T=0;if(v){const C=v.width-10,k=v.height-10,A=C/2,M=k/2;x=A-y.x*y.zoom,T=M-y.y*y.zoom}Vn({x,y:T}),_l(y.showTopImage),Hl(y.showBottomImage),Ji(y.showViasLayer),El(y.showTopTracesLayer),Zn(y.showBottomTracesLayer),Ni(y.showTopPadsLayer),ai(y.showBottomPadsLayer),Ja(y.showTopTestPointsLayer),wa(y.showBottomTestPointsLayer),vn(y.showTopComponents),wt(y.showBottomComponents),Kn(y.showPowerLayer),Oo(y.showGroundLayer),_o(y.showConnectionsLayer)}return}if(o.key==="+"||o.key==="="){o.preventDefault(),o.stopPropagation(),Zs();return}if(o.key==="-"||o.key==="_"){o.preventDefault(),o.stopPropagation(),Ks();return}if((o.key==="ArrowUp"||o.key==="ArrowDown"||o.key==="ArrowLeft"||o.key==="ArrowRight")&&mt.size>0){o.preventDefault(),o.stopPropagation();const y=o.shiftKey?10:1;let v=0,x=0;o.key==="ArrowUp"?x=-y:o.key==="ArrowDown"?x=y:o.key==="ArrowLeft"?v=-y:o.key==="ArrowRight"&&(v=y);for(const T of mt){const C=Je.find(k=>k.id===T);if(C){const k=C.x+v,A=C.y+x,M=Yt({x:k,y:A});tn(ie=>ie.map(Q=>Q.id===T?{...Q,x:M.x,y:M.y}:Q))}else{const k=dt.find(A=>A.id===T);if(k){const A=k.x+v,M=k.y+x,ie=Yt({x:A,y:M});bn(Q=>Q.map(q=>q.id===T?{...q,x:ie.x,y:ie.y}:q))}}}return}if((o.key==="I"||o.key==="i")&&!o.ctrlKey&&!o.shiftKey&&!o.altKey){const y=document.activeElement;if(!!y&&(y.tagName==="INPUT"&&y.type!=="range"&&y.type!=="checkbox"&&y.type!=="radio"||y.tagName==="TEXTAREA"||y.isContentEditable))return;o.preventDefault(),o.stopPropagation();const x=[];qe.size>0,qe.size===0&&mt.size===0&&Et.size===0&&jt.size===0&&x.push(`
No objects selected.`);const T=x.join(`
`);console.log(T),sa({visible:!0,text:T});return}if((o.key==="N"||o.key==="n")&&!o.ctrlKey&&!o.shiftKey&&!o.altKey){const y=document.activeElement;if(!!y&&(y.tagName==="INPUT"&&y.type!=="range"&&y.type!=="checkbox"&&y.type!=="radio"||y.tagName==="TEXTAREA"||y.isContentEditable))return;o.preventDefault(),o.stopPropagation(),Ho(!0);return}if((o.key==="L"||o.key==="l")&&!o.ctrlKey&&!o.shiftKey&&!o.altKey){const y=document.activeElement;if(!!y&&(y.tagName==="INPUT"&&y.type!=="range"&&y.type!=="checkbox"&&y.type!=="radio"||y.tagName==="TEXTAREA"||y.isContentEditable))return;o.preventDefault(),o.stopPropagation(),gd();return}if(o.key==="O"||o.key==="o"){const y=document.activeElement;if(!!y&&(y.tagName==="INPUT"&&y.type!=="range"&&y.type!=="checkbox"&&y.type!=="radio"||y.tagName==="TEXTAREA"||y.isContentEditable))return;o.preventDefault(),o.stopPropagation();const x=Ms[0];if(x){Ci(x.zoom);const T=On.current;let C=0,k=0;if(T){const A=T.width-10,M=T.height-10,ie=A/2,Q=M/2;C=ie-x.x*x.zoom,k=Q-x.y*x.zoom}Vn({x:C,y:k}),_l(x.showTopImage),Hl(x.showBottomImage),Ji(x.showViasLayer),El(x.showTopTracesLayer),Zn(x.showBottomTracesLayer),Ni(x.showTopPadsLayer),ai(x.showBottomPadsLayer),Ja(x.showTopTestPointsLayer),wa(x.showBottomTestPointsLayer),vn(x.showTopComponents),wt(x.showBottomComponents),Kn(x.showPowerLayer),Oo(x.showGroundLayer),_o(x.showConnectionsLayer)}else{Ci(1);const T=On.current;let C=0,k=0;if(T){const A=T.width-10,M=T.height-10,ie=A/2,Q=M/2;C=ie,k=Q}document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),Vn({x:C,y:k})}X("overlay"),ct(new Set),gt(new Set),at(new Set),ht(new Set),te("select");return}if((o.key==="Alt"||o.altKey)&&(ad(!0),ac(!0)),o.key==="Escape"){o.preventDefault(),o.stopPropagation(),Qs(),po(!1),Wo(!1),Ll(!1),Fo(!1),go(!1),$n(!1),oo(!1),od(null);return}if(o.key==="Enter"&&B==="draw"&&De==="trace"){Fr();return}if((o.key==="Delete"||o.key==="Backspace")&&(qe.size>0||mt.size>0||Et.size>0||jt.size>0)){if(o.preventDefault(),o.stopPropagation(),dl(_e,Je,dt,ki,ii),qe.size>0){const y=_e.filter(k=>qe.has(k.id)),v=mi&&y.some(k=>k.type==="via"),x=vi&&y.some(k=>k.type==="trace"),T=_i&&y.some(k=>k.type==="pad"),C=Co&&y.some(k=>k.type==="testPoint");v?alert("Cannot delete: Vias are locked. Unlock vias to delete them."):x?alert("Cannot delete: Traces are locked. Unlock traces to delete them."):T?alert("Cannot delete: Pads are locked. Unlock pads to delete them."):C?alert("Cannot delete: Test points are locked. Unlock test points to delete them."):(Pt(k=>k.filter(A=>!qe.has(A.id))),ct(new Set))}mt.size>0&&(Hi?alert("Cannot delete: Components are locked. Unlock components to delete them."):(tn(y=>y.filter(v=>!mt.has(v.id))),bn(y=>y.filter(v=>!mt.has(v.id))),gt(new Set))),Et.size>0&&(Rn?alert("Cannot delete: Power nodes are locked. Unlock power nodes to delete them."):(ni(y=>y.filter(v=>!Et.has(v.id))),at(new Set))),jt.size>0&&(Ei?alert("Cannot delete: Ground nodes are locked. Unlock ground nodes to delete them."):(Qn(y=>y.filter(v=>!jt.has(v.id))),ht(new Set)));return}if((o.key==="z"||o.key==="Z")&&(o.ctrlKey||o.metaKey)&&!o.shiftKey&&!o.altKey){const y=document.activeElement;if(!!y&&(y.tagName==="INPUT"&&y.type!=="range"&&y.type!=="checkbox"&&y.type!=="radio"||y.tagName==="TEXTAREA"||y.isContentEditable))return;o.preventDefault(),o.stopPropagation();const x=$d();if(x){const T=new Set(x.drawingStrokes.map(M=>M.id));for(const M of _e)if(!T.has(M.id))for(const ie of M.points)ie.id&&typeof ie.id=="number"&&Vu(ie.id);const C=new Set([...x.componentsTop.map(M=>M.id),...x.componentsBottom.map(M=>M.id)]);for(const M of[...Je,...dt])if(!C.has(M.id)){for(const ie of M.pinConnections)if(ie&&ie.trim()!==""){const Q=parseInt(ie,10);!isNaN(Q)&&Q>0&&Vu(Q)}}const k=new Set(x.powerSymbols.map(M=>M.id));for(const M of ki)!k.has(M.id)&&M.pointId&&typeof M.pointId=="number"&&Vu(M.pointId);const A=new Set(x.groundSymbols.map(M=>M.id));for(const M of ii)!A.has(M.id)&&M.pointId&&typeof M.pointId=="number"&&Vu(M.pointId);Pt(x.drawingStrokes),tn(x.componentsTop),bn(x.componentsBottom),ni(x.powerSymbols),Qn(x.groundSymbols),hi([])}return}if(!o.ctrlKey&&!o.altKey){const y=document.activeElement;if(!(!!y&&(y.tagName==="INPUT"&&y.type!=="range"&&y.type!=="checkbox"&&y.type!=="radio"||y.tagName==="TEXTAREA"||y.isContentEditable)))switch(o.key){case"s":case"S":o.preventDefault(),Qs();return;case"b":case"B":o.preventDefault(),Xe.length===1?(gl(Xe[0].id),te("power"),$n(!1)):Xe.length>1?$n(!0):($n(!0),te("power"));return;case"g":case"G":o.preventDefault(),qt.length===1?(ts(qt[0].id),te("ground"),ti(!1)):qt.length>1?ti(!0):(ti(!0),te("ground"));return;case"v":case"V":o.preventDefault(),Gn("via"),te("draw");return;case"p":case"P":o.preventDefault(),Gn("pad"),te("draw"),Dn(Ft||"top");return;case"y":case"Y":o.preventDefault(),Gn("testPoint"),te("draw"),Dn(sn||"top");return;case"t":case"T":o.preventDefault(),Gn("trace"),te("draw"),Dn(pt||"top");return;case"c":case"C":o.preventDefault(),te("component"),ci.current?(Xs(ci.current),Fo(!1),go(!1)):(Fo(!0),go(!1),Xs(null));return;case"e":case"E":o.preventDefault(),te("erase");return;case"h":case"H":o.preventDefault(),te("pan");return;case"x":case"X":o.preventDefault(),te("center"),Ki(!0),pn.current&&clearTimeout(pn.current),pn.current=setTimeout(()=>{Ki(!1),te("select"),Wn(void 0)},2e3);return;case"m":case"M":if(!o.ctrlKey){o.preventDefault(),Nr(!1),te("magnify");return}break}}if(B==="transform"&&Mt){if(!(o.key==="ArrowLeft"||o.key==="ArrowRight"||o.key==="ArrowUp"||o.key==="ArrowDown"))return;o.preventDefault(),o.stopPropagation();const v=document.activeElement;if(v&&v.tagName==="INPUT"){const x=v;x.type==="radio"&&x.blur()}if(Ri)return;if(al==="nudge"){let x=0,T=0;switch(o.key){case"ArrowLeft":x=-1;break;case"ArrowRight":x=1;break;case"ArrowUp":T=-1;break;case"ArrowDown":T=1;break;default:return}Mt==="top"&&g?d(C=>C?{...C,x:C.x+x,y:C.y+T}:null):Mt==="bottom"&&R?F(C=>C?{...C,x:C.x+x,y:C.y+T}:null):Mt==="both"&&(g&&d(C=>C?{...C,x:C.x+x,y:C.y+T}:null),R&&F(C=>C?{...C,x:C.x+x,y:C.y+T}:null))}else if(al==="scale"){let x=0;switch(o.key){case"ArrowUp":x=.01;break;case"ArrowDown":x=-.01;break;case"ArrowRight":x=.001;break;case"ArrowLeft":x=-.001;break;default:return}if(Mt==="top"){g&&d(T=>T?{...T,scale:Math.max(.1,Math.min(3,T.scale+x))}:null);return}if(Mt==="bottom"){R&&F(T=>T?{...T,scale:Math.max(.1,Math.min(3,T.scale+x))}:null);return}if(Mt==="both"){g&&d(T=>T?{...T,scale:Math.max(.1,Math.min(3,T.scale+x))}:null),R&&F(T=>T?{...T,scale:Math.max(.1,Math.min(3,T.scale+x))}:null);return}}else if(al==="rotate"){let x=0;switch(o.key){case"ArrowUp":x=1;break;case"ArrowDown":x=-1;break;case"ArrowRight":x=.1;break;case"ArrowLeft":x=-.1;break;default:return}if(Mt==="top"){g&&d(T=>T?{...T,rotation:T.rotation+x}:null);return}if(Mt==="bottom"){R&&F(T=>T?{...T,rotation:T.rotation+x}:null);return}if(Mt==="both"){g&&d(T=>T?{...T,rotation:T.rotation+x}:null),R&&F(T=>T?{...T,rotation:T.rotation+x}:null);return}}else if(al==="slant"){let x=0,T=0;switch(o.key){case"ArrowUp":T=-.5;break;case"ArrowDown":T=.5;break;case"ArrowLeft":x=-.5;break;case"ArrowRight":x=.5;break}if(x!==0||T!==0){const C=A=>A*Math.PI/180,k=A=>Math.max(-.7,Math.min(.7,A));if(Mt==="top"){g&&d(A=>A?{...A,skewX:k((A.skewX||0)+C(x)),skewY:k((A.skewY||0)+C(T))}:null);return}if(Mt==="bottom"){R&&F(A=>A?{...A,skewX:k((A.skewX||0)+C(x)),skewY:k((A.skewY||0)+C(T))}:null);return}if(Mt==="both"){g&&d(A=>A?{...A,skewX:k((A.skewX||0)+C(x)),skewY:k((A.skewY||0)+C(T))}:null),R&&F(A=>A?{...A,skewX:k((A.skewX||0)+C(x)),skewY:k((A.skewY||0)+C(T))}:null);return}}}else if(al==="keystone"){let x=0,T=0;switch(o.key){case"ArrowUp":T=-.5;break;case"ArrowDown":T=.5;break;case"ArrowLeft":x=-.5;break;case"ArrowRight":x=.5;break}if(x!==0||T!==0){const C=A=>A*Math.PI/180,k=A=>Math.max(-.35,Math.min(.35,A));if(Mt==="top"){g&&d(A=>A?{...A,keystoneH:k((A.keystoneH||0)+C(x)),keystoneV:k((A.keystoneV||0)+C(T))}:null);return}if(Mt==="bottom"){R&&F(A=>A?{...A,keystoneH:k((A.keystoneH||0)+C(x)),keystoneV:k((A.keystoneV||0)+C(T))}:null);return}if(Mt==="both"){g&&d(A=>A?{...A,keystoneH:k((A.keystoneH||0)+C(x)),keystoneV:k((A.keystoneV||0)+C(T))}:null),R&&F(A=>A?{...A,keystoneH:k((A.keystoneH||0)+C(x)),keystoneV:k((A.keystoneV||0)+C(T))}:null);return}}}}else{const y=o.target;if(y.tagName==="INPUT"&&y.type==="range"){const v=y,x=Number(v.value),T=Number(v.min),C=Number(v.max),k=Number(v.step)||1;switch(o.key){case"ArrowLeft":o.preventDefault();const A=Math.max(T,x-k);v.value=A.toString(),v.dispatchEvent(new Event("input",{bubbles:!0}));break;case"ArrowRight":o.preventDefault();const M=Math.min(C,x+k);v.value=M.toString(),v.dispatchEvent(new Event("input",{bubbles:!0}));break}}}},[B,Mt,al,g,R,qe,mt,Et,jt,_e,Je,dt,yt,st,Xe,De,Fr,pt,D,O,W,Se,Qs,tn,bn,$d,Pt,ni,Qn,ki,ii]);Oe.useEffect(()=>{B!=="transform"&&Ti(null)},[B]),Oe.useEffect(()=>{window.addEventListener("keydown",mc,!0);const o=r=>{r.key==="Alt"&&(ad(!1),ac(!1),ao(null))};return window.addEventListener("keyup",o,!0),()=>{window.removeEventListener("keydown",mc,!0),window.removeEventListener("keyup",o,!0)}},[mc,Et,jt,Rn,Rn,yt,st,Zs,Ks,Qs,mt,Je,dt,tn,bn,Ms,fl,B]);const Aa=m.useCallback(()=>{xl.current={},P("#AA4499"),he("#F781BF"),j(6),me(6),ft("trace","#AA4499","top"),ft("trace","#F781BF","bottom"),Ze("trace",6,"top"),Ze("trace",6,"bottom"),H("#0072B2"),pe("#56B4E9"),K(18),U(18),ft("pad","#0072B2","top"),ft("pad","#56B4E9","bottom"),Ze("pad",18,"top"),Ze("pad",18,"bottom"),Ui("#6A3D9A"),pi("#9467BD"),zl(18),kl(18),ft("component","#6A3D9A","top"),ft("component","#9467BD","bottom"),Ze("component",18,"top"),Ze("component",18,"bottom"),Pn("top"),re("#AA4499"),z(6),zi([{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),Nl([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),Ze("power",18),Ze("ground",18),Ss(!1),ws(!1),oa(!1),js(!1),La(!1),Ts(!1),Dn("top"),te("select"),V(50),ge(!1),X("overlay"),Rh(),la()},[ft,Ze,la]),Lr=m.useCallback(()=>{Ul(null),pa(null),Ba&&(Ba.current=null),Ma&&(Ma.current=null),ln(""),ul("pcb_project"),Zi(!1),Ml(null),Bl(""),ko([]),Ro(-1),Xl&&(Xl.current=""),Ai.current=!1,zo(!1),Zt.current&&(clearInterval(Zt.current),Zt.current=null),d(null),F(null),la(),Pt([]),ta([]),yi([]),io([]),lo([]),hi([]),Ql.current=[],tn([]),bn([]),$a(null),na(null),ni([]),Qn([]),ia(null),zi([{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),Nl([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),ct(new Set),gt(new Set),at(new Set),ht(new Set),Xi(!1),Io([]),X("overlay"),Ci(1),Vn({x:0,y:0}),sl(!0),Dn("top"),Za({}),Ki(!1),pn.current&&(clearTimeout(pn.current),pn.current=null),Ti(null),Li(!1),Oi(null),to("nudge"),Re(!1),V(50),ge(!1),Ue(2e3),Ss(!1),ws(!1),kr(!1),Gc(!1),oa(!1),js(!1),La(!1),Ts(!1),_l(!0),Hl(!0),Ji(!0),El(!0),Zn(!0),Ni(!0),ai(!0),Ja(!0),wa(!0),vn(!0),wt(!0),Kn(!0),Oo(!0),_o(!0),Ur(!0),te("select"),Gn("trace"),Pn("top"),Ha("top"),Sr("top"),To("top"),Qo.current="top",Dl.current="top",rl.current="top",Al.current="top",xl.current={},ns(!0),so(!1),Rh(),Rr(null),sa({visible:!1,text:""}),Ya({visible:!1,title:"",message:""}),ra({visible:!1}),ks({visible:!1}),Xa({visible:!1,projectName:"",locationPath:"",locationHandle:null}),da({visible:!1,filename:"",locationPath:"",locationHandle:null}),aa({visible:!1,interval:null}),Di({visible:!1,source:"new",interval:5}),oo(!1),Ps(!1),Vl(!1),Po(!1),Fs(!1),Ho(!1),Or(!1),Rs(!1),ls(null),ao(null),pl(null),As(!1),qa.current=null,Ns.current=null,jo(!1),Pi(null),br.current=0,Jl.current=!1,console.log("Project closed: All state cleared and browser permissions released")},[Ul,pa,ln,ul,Zi,Ml,Bl,ko,Ro,d,F,Pt,hi,ta,yi,io,lo,tn,bn,$a,na,ni,Qn,ia,zi,Nl,ct,gt,at,ht,Xi,Io,X,Ci,Vn,sl,Dn,Za,Ki,Ti,Li,Oi,to,Re,V,ge,Ue,Ss,ws,kr,Gc,oa,js,La,Ts,_l,Hl,Ji,El,Zn,Ni,ai,Ja,wa,vn,wt,Kn,Oo,_o,te,Gn,Pn,Ha,Sr,To,ns,so,Rr,sa,Ya,ra,Xa,da,aa,Di,la,oo,Ps,Vl,Po,Fs,Ho,Or,ls,ao,pl,As,jo,Pi]),yo=m.useCallback(()=>{Aa(),setTimeout(()=>{Ci(1);const o=On.current,r=Ar.current;let f=0,b=0;if(o&&r){const y=o.getBoundingClientRect(),v=r.getBoundingClientRect(),x=o.width-10,T=o.height-10,A=60+168+6,M=y.left-v.left,ie=A-M,Q=y.width-Math.max(0,ie),q=ie+Q/2,J=y.height/2,le=x/2,ne=T/2,be=y.width/o.width,Ae=y.height/o.height,ze=q/be,je=J/Ae,Ee=ze-5,Me=je-5;f=Ee-le,b=Me-ne}document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),Vn({x:f,y:b}),ct(new Set),gt(new Set),at(new Set),ht(new Set)},100)},[Aa]);Oe.useEffect(()=>{yo()},[]),Oe.useEffect(()=>{if(!zs.visible)return;const o=[];qe.size>0,qe.size===0&&mt.size===0&&Et.size===0&&jt.size===0&&o.push(`
No objects selected.`);const r=o.join(`
`);sa(f=>({...f,text:r}))},[zs.visible,qe,mt,Et,jt,_e,Je,dt,yt,st,Xe]),Oe.useEffect(()=>{const o=r=>{const f=On.current;if(f&&!(xo.current&&xo.current.contains(r.target))&&!(r.target instanceof Node&&f.contains(r.target))){if(Fr(),Cn){const b=$l.current;(!b||!(r.target instanceof Node)||!b.contains(r.target))&&po(!1)}if(Ir){const b=xo.current;(!b||!(r.target instanceof Node)||!b.contains(r.target))&&(Fo(!1),te("select"))}if(Er){const b=Gs.current;(!b||!(r.target instanceof Node)||!b.contains(r.target))&&(go(!1),od(null))}if(Ga){const b=ma.current;!r.target?.closest('button[title="Color Picker"]')&&(!b||!(r.target instanceof Node)||!b.contains(r.target))&&oo(!1)}}};return document.addEventListener("mousedown",o,!0),()=>document.removeEventListener("mousedown",o,!0)},[Fr,Cn,ho,Ir,Er,Ga]);const Na=o=>{if(!o.current)return{top:0,left:0};const r=o.current.getBoundingClientRect(),f=Ar.current?.getBoundingClientRect();return f?{top:r.top-f.top,left:r.left-f.left+r.width+4}:{top:0,left:0}},vc=m.useCallback(()=>{$l.current&&qs.current&&requestAnimationFrame(()=>{if($l.current&&qs.current){const o=Na(qs);$l.current.style.top=`${o.top}px`,$l.current.style.left=`${o.left}px`}})},[]),Sc=m.useCallback(()=>{Hr.current&&vl.current&&requestAnimationFrame(()=>{if(Hr.current&&vl.current){const o=Na(vl);Hr.current.style.top=`${o.top}px`,Hr.current.style.left=`${o.left}px`}})},[]),Yr=m.useCallback(()=>{hn.current&&as.current&&requestAnimationFrame(()=>{if(hn.current&&as.current){const o=Na(as);hn.current.style.top=`${o.top}px`,hn.current.style.left=`${o.left}px`}})},[]);Oe.useEffect(()=>{Cn&&vc()},[Cn,vc]),Oe.useEffect(()=>{ho&&Sc()},[ho,Sc]),Oe.useEffect(()=>{os&&Yr()},[os,Yr]),Oe.useEffect(()=>{if(Ir&&xo.current&&Vr.current){const o=Na(Vr);xo.current.style.top=`${o.top}px`,xo.current.style.left=`${o.left}px`}},[Ir]),Oe.useEffect(()=>{if(Il&&Ls.current&&Wr.current){const o=Na(Wr);Ls.current.style.top=`${o.top}px`,Ls.current.style.left=`${o.left}px`}},[Il]),Oe.useEffect(()=>{if(dc&&Ys.current&&yc.current){const o=Na(yc);Ys.current.style.top=`${o.top}px`,Ys.current.style.left=`${o.left}px`}},[dc]),Oe.useEffect(()=>{const o=r=>{if(!An)return;const f=document.querySelector("[data-component-editor-dialog]");if(f&&r.target instanceof Node&&f.contains(r.target)){const Me=r.target;if(Me.tagName==="BUTTON"||Me.tagName==="INPUT"||Me.closest("button")||Me.closest("input"))return}const b=On.current;if(!b)return;const y=b.getBoundingClientRect(),v=r.clientX,x=r.clientY;if(v<y.left||v>y.right||x<y.top||x>y.bottom)return;const T=b.width/y.width,C=b.height/y.height,k=v-y.left,A=x-y.top,M=k*T,ie=A*C,Q=M-5,q=ie-5,J=(Q-zt.x)/We,le=(q-zt.y)/We;let ne=1/0,be=null,Ae=null;const ze=Math.max(6/We,4),Ee=[...Je,...dt].find(Me=>Me.id===An.componentId)?.layer||"top";for(const Me of _e)if((Me.type==="via"||Me.type==="pad")&&Me.points.length>0){if(Me.type==="pad"&&(Me.layer||"top")!==Ee)continue;const G=Me.points[0],_=Math.max(1,Me.size/2),ve=Math.hypot(G.x-J,G.y-le),ue=Math.max(_,ze);ve<=ue&&ve<ne&&(ne=ve,be=G.id??null,Ae=Me)}if(be!=null&&Ae){console.log(`
[PIN CONNECTION - DOCUMENT HANDLER] Found via!`),console.log(`  Point ID: ${be}`),console.log(`  Connecting pin ${An.pinIndex+1} of component ${An.componentId}`);const Me=String(be),G=An.pinIndex,_=An.componentId,ve=Je.find(Ne=>Ne.id===_),ue=dt.find(Ne=>Ne.id===_);if(ve){const Ne=_e;tn(Fe=>{const nt=Fe.find(Pe=>Pe.id===_);if(!nt)return Fe;const Ye=nt.pinConnections||[],et=Ye.length>0?[...Ye]:new Array(nt.pinCount).fill("");let it;if(et.length!==nt.pinCount){it=new Array(nt.pinCount).fill("");for(let Pe=0;Pe<Math.min(et.length,nt.pinCount);Pe++)it[Pe]=et[Pe]||""}else it=[...et];it[G]=Me,console.log(`Updated pin ${G} with value: ${Me}`),console.log("New pinConnections:",it);const vt=Fe.find(Pe=>Pe.id===_),lt=vt?Gf(vt,it,Ne):null;return Fe.map(Pe=>{if(Pe.id===_){const ut={...Pe,pinConnections:it};return lt&&(ut.pinPolarities=lt),ut}return Pe})})}else if(ue){const Ne=_e;bn(Fe=>{const nt=Fe.find(Pe=>Pe.id===_);if(!nt)return Fe;const Ye=nt.pinConnections||[],et=Ye.length>0?[...Ye]:new Array(nt.pinCount).fill("");let it;if(et.length!==nt.pinCount){it=new Array(nt.pinCount).fill("");for(let Pe=0;Pe<Math.min(et.length,nt.pinCount);Pe++)it[Pe]=et[Pe]||""}else it=[...et];it[G]=Me,console.log(`Updated pin ${G} with value: ${Me}`),console.log("New pinConnections:",it);const vt=Fe.find(Pe=>Pe.id===_),lt=vt?Gf(vt,it,Ne):null;return Fe.map(Pe=>{if(Pe.id===_){const ut={...Pe,pinConnections:it};return lt&&(ut.pinPolarities=lt),ut}return Pe})})}setTimeout(()=>{na(null)},0)}else console.log("[PIN CONNECTION - DOCUMENT HANDLER] No via found at click location")};if(An)return document.addEventListener("mousedown",o,!0),()=>document.removeEventListener("mousedown",o,!0)},[An,Je,dt,_e,We,zt.x,zt.y]);const Si=m.useCallback((o,r,f,b)=>{const y=window.innerWidth,v=window.innerHeight,x=10;let T=Math.max(x,Math.min(o,y-f-x)),C=Math.max(x,Math.min(r,v-b-x));return{x:T,y:C}},[]);Oe.useEffect(()=>{if(!jr)return;const o=f=>{if(!vs)return;const b={x:f.clientX-vs.x,y:f.clientY-vs.y},y=Si(b.x,b.y,250,window.innerHeight*.4);qi(y),localStorage.setItem("componentDialogPosition",JSON.stringify(y))},r=()=>{Tr(!1),Cr(null)};return document.addEventListener("mousemove",o),document.addEventListener("mouseup",r),()=>{document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",r)}},[jr,vs,Si]),Oe.useEffect(()=>{if(!Ta)return;const o=f=>{if(!is)return;const b={x:f.clientX-is.x,y:f.clientY-is.y},y=Si(b.x,b.y,250,window.innerHeight*.4);Hs(y),localStorage.setItem("detailedInfoDialogPosition",JSON.stringify(y))},r=()=>{uc(!1),Pr(null)};return document.addEventListener("mousemove",o),document.addEventListener("mouseup",r),()=>{document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",r)}},[Ta,is,Si]),Oe.useEffect(()=>{if(!pc)return;const o=f=>{if(!Eo)return;const b={x:f.clientX-Eo.x,y:f.clientY-Eo.y};ro(b),localStorage.setItem("notesDialogPosition",JSON.stringify(b))},r=()=>{ed(!1),Es(null)};return document.addEventListener("mousemove",o),document.addEventListener("mouseup",r),()=>{document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",r)}},[pc,Eo]),Oe.useEffect(()=>{if(fc&&yl===null){const o=localStorage.getItem("notesDialogPosition");if(o)try{const r=JSON.parse(o);ro(r)}catch{ro({x:window.innerWidth-550,y:100})}else ro({x:window.innerWidth-550,y:100})}},[fc,yl]),Oe.useEffect(()=>{if(!co)return;const o=f=>{if(!Ws)return;const b={x:f.clientX-Ws.x,y:f.clientY-Ws.y};Vs(b),localStorage.setItem("projectNotesDialogPosition",JSON.stringify(b))},r=()=>{_r(!1),uo(null)};return document.addEventListener("mousemove",o),document.addEventListener("mouseup",r),()=>{document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",r)}},[co,Ws]),Oe.useEffect(()=>{if(Is&&bl===null){const o=localStorage.getItem("projectNotesDialogPosition");if(o)try{const r=JSON.parse(o);Vs(r)}catch{Vs({x:100,y:100})}else Vs({x:100,y:100})}},[Is,bl]);const gd=m.useCallback(()=>{Or(!0)},[]);Oe.useEffect(()=>{if(Fa&&Fa.visible&&Gi===null){const o=localStorage.getItem("componentDialogPosition");let r;if(o)try{const f=JSON.parse(o);r=Si(f.x,f.y,250,window.innerHeight*.4),qi(r)}catch{r=Si(window.innerWidth-280,90,250,window.innerHeight*.4),qi(r)}else r=Si(window.innerWidth-280,90,250,window.innerHeight*.4),qi(r)}else!Fa||Fa.visible},[Fa,Gi,Si]),Oe.useEffect(()=>{if(zs.visible&&Mi===null){const o=localStorage.getItem("detailedInfoDialogPosition");let r;if(o)try{const f=JSON.parse(o);r=Si(f.x,f.y,400,window.innerHeight*.8),Hs(r)}catch{r=Si(window.innerWidth-450,90,400,window.innerHeight*.8),Hs(r)}else r=Si(window.innerWidth-450,90,400,window.innerHeight*.8),Hs(r)}else zs.visible},[zs.visible,Mi,Si]),Oe.useEffect(()=>{const o=()=>{if(Gi){const r=Si(Gi.x,Gi.y,250,window.innerHeight*.4);(r.x!==Gi.x||r.y!==Gi.y)&&(qi(r),localStorage.setItem("componentDialogPosition",JSON.stringify(r)))}if(Mi){const r=Si(Mi.x,Mi.y,400,window.innerHeight*.8);(r.x!==Mi.x||r.y!==Mi.y)&&(Hs(r),localStorage.setItem("detailedInfoDialogPosition",JSON.stringify(r)))}};return window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[Gi,Mi,Si]);const Gu=m.useCallback(o=>{switch(o){case"transparency":V(50);break;case"brushSize":z(3);break}},[]),wc=Oe.useRef(Te);Oe.useEffect(()=>{wc.current=Te},[Te]),Oe.useEffect(()=>{if(de){Kc.current=performance.now(),V(0);const o=r=>{const f=Kc.current||r,b=wc.current,y=(r-f)%b/b,v=1-Math.abs(1-2*y);V(Math.round(v*100)),Pl.current=requestAnimationFrame(o)};Pl.current=requestAnimationFrame(o)}return()=>{Pl.current&&(cancelAnimationFrame(Pl.current),Pl.current=null)}},[de]),Oe.useEffect(()=>{if(B==="center"){Wn(dx());return}const o=B==="erase"?"erase":B==="magnify"?"magnify":B==="ground"?"ground":B==="power"?"power":B==="component"?"component":B==="draw"?De==="via"?"via":De==="pad"?"pad":De==="testPoint"?"testPoint":"trace":"default";if(o==="default"){Wn(void 0);return}const r=Math.max(1,We),f=o==="magnify"?18:Math.max(o==="component"?16:o==="power"||o==="ground"?12:6,Math.round(N*r)),y=f+4*2+(o==="magnify"?8:0),v=document.createElement("canvas");v.width=y,v.height=y;const x=v.getContext("2d");if(!x){Wn(void 0);return}const T=y/2,C=y/2,k=f/2;if(x.clearRect(0,0,y,y),o==="via"){const M=k,ie=k*.5,Q=k*.7,J=At.get("via").color;x.fillStyle=J,x.beginPath(),x.arc(T,C,M,0,Math.PI*2),x.arc(T,C,ie,0,Math.PI*2),x.fill("evenodd"),x.strokeStyle="#808080",x.lineWidth=1,x.beginPath(),x.moveTo(T-Q,C),x.lineTo(T+Q,C),x.stroke(),x.beginPath(),x.moveTo(T,C-Q),x.lineTo(T,C+Q),x.stroke()}else if(o==="pad"){const M=Ft==="top"?"padTop":"padBottom",ie=At.get(M),Q=ie.color,J=Math.max(6,Math.round(ie.size*r))/2,le=J*2,ne=le*.5,be=J*.7;x.fillStyle=Q,x.beginPath(),x.rect(T-J,C-J,le,le),x.rect(T-ne/2,C-ne/2,ne,ne),x.fill("evenodd"),x.strokeStyle="#808080",x.lineWidth=1,x.beginPath(),x.moveTo(T-be,C),x.lineTo(T+be,C),x.stroke(),x.beginPath(),x.moveTo(T,C-be),x.lineTo(T,C+be),x.stroke()}else if(o==="trace"){const M=pt==="top"?"traceTop":"traceBottom",Q=At.get(M).color;x.fillStyle=Q,x.beginPath(),x.arc(T,C,k,0,Math.PI*2),x.fill()}else if(o==="testPoint"){const M=sn==="top"?"testPointTop":"testPointBottom",ie=At.get(M);Wn(ux(ie.size));return}else if(o==="erase"){const M=Math.max(N*.75,8),ie=Math.max(N*.5,6),Q=Math.max(N*.2,2);x.save(),x.translate(T,C),x.rotate(-35*Math.PI/180),x.fillStyle="#f5a3b3",x.strokeStyle="#111",x.lineWidth=1.5;const q=1.5,J=-M/2,le=-ie/2;x.beginPath(),x.moveTo(J+q,le),x.lineTo(J+M-q,le),x.quadraticCurveTo(J+M,le,J+M,le+q),x.lineTo(J+M,le+ie-q),x.quadraticCurveTo(J+M,le+ie,J+M-q,le+ie),x.lineTo(J+q,le+ie),x.quadraticCurveTo(J,le+ie,J,le+ie-q),x.lineTo(J,le+q),x.quadraticCurveTo(J,le,J+q,le),x.closePath(),x.fill(),x.stroke(),x.fillStyle="#f18ea4",x.beginPath(),x.rect(-M/2,ie/2-Q,M,Q),x.fill(),x.restore()}else if(o==="magnify"){const M=k;x.strokeStyle="#111",x.lineWidth=2,x.beginPath(),x.arc(T-2,C-2,M,0,Math.PI*2),x.stroke();const ie=T+M*.6,Q=C+M*.6,q=ie+6,J=Q+6;x.beginPath(),x.moveTo(ie,Q),x.lineTo(q,J),x.stroke(),x.beginPath(),x.moveTo(T-6,C-2),x.lineTo(T+2,C-2),x.stroke(),oc||(x.beginPath(),x.moveTo(T-2,C-6),x.lineTo(T-2,C+2),x.stroke())}else if(o==="ground"){const ie=(nl?qt.find(q=>q.id===nl):null)?.color||"#000000";if(x.strokeStyle=ie,x.lineWidth=2,x.lineCap="round",nl==="groundbus-earth"){const q=k*1.5,J=q*.9,le=q*.24,ne=q*1.6;x.beginPath(),x.moveTo(T,C-J/2),x.lineTo(T,C+J/2),x.stroke();for(let be=0;be<3;be++){const Ae=C+J/2+be*le,ze=ne*(1-be*.25);x.beginPath(),x.moveTo(T-ze/2,Ae),x.lineTo(T+ze/2,Ae),x.stroke()}}else{const q=k*.8;x.beginPath(),x.arc(T,C,k,0,Math.PI*2),x.stroke(),x.beginPath(),x.moveTo(T,C-k-q),x.lineTo(T,C+k+q),x.stroke(),x.beginPath(),x.moveTo(T-k-q,C),x.lineTo(T+k+q,C),x.stroke()}}else if(o==="power"){const ie=(tl?Xe.find(q=>q.id===tl):null)?.color||"#ff0000";x.strokeStyle=ie,x.lineWidth=2,x.lineCap="round";const Q=k*.8;x.beginPath(),x.arc(T,C,k,0,Math.PI*2),x.stroke(),x.beginPath(),x.moveTo(T,C-k-Q),x.lineTo(T,C+k+Q),x.stroke(),x.beginPath(),x.moveTo(T-k-Q,C),x.lineTo(T+k+Q,C),x.stroke()}else if(o==="component"){const ie=(kn||"top")==="top"?"componentTop":"componentBottom",q=At.get(ie).color,J=f,le=J/2;x.strokeStyle=q,x.lineWidth=2,x.fillStyle="rgba(255,255,255,0.9)",x.beginPath(),x.rect(T-le,C-le,J,J),x.fill(),x.stroke();const ne=Wi?Yf(Wi):"?";x.fillStyle=q,x.font=`bold ${Math.max(8,J*.35)}px sans-serif`,x.textAlign="center",x.textBaseline="middle",x.fillText(ne,T,C)}const A=`url(${v.toDataURL()}) ${Math.round(T)} ${Math.round(C)}, crosshair`;Wn(A)},[B,De,L,N,We,oc,Wi,tl,nl,Xe,qt,Ht,pt,Ft,sn,kn,Bt.toolInstanceId,Bt.color,Bt.size]),Oe.useEffect(()=>{$r()},[$r]),Oe.useEffect(()=>{$r()},[Ka.width,Ka.height]),Oe.useEffect(()=>{qe.size===0&&B==="draw"&&De==="trace"&&N>=1&&(tt==="top"?j(N):me(N))},[N,B,De,tt,qe]),Oe.useEffect(()=>{Pt(o=>o.map(r=>{if(r.type==="via"&&r.points.length>0&&r.points[0].id!==void 0){const f=r.points[0].id,b=Ii(f,Xe);if(r.viaType!==b)return{...r,viaType:b}}else if(r.type==="pad"&&r.points.length>0&&r.points[0].id!==void 0){const f=r.points[0].id,b=Vi(f,Xe);if(r.padType!==b)return{...r,padType:b}}else if(r.type==="testPoint"&&r.points.length>0&&r.points[0].id!==void 0){const f=r.points[0].id,b=fo(f,Xe),y=b.includes("Power")?"power":b.includes("Ground")?"ground":b.includes("Signal")?"signal":"unknown";if(r.testPointType!==y)return{...r,testPointType:y}}return r}))},[yt,st,Xe,Ii,Vi,fo]);const su=m.useCallback(()=>{const o=On.current;if(!o)return;const r=o.toDataURL("image/png"),f=window.open("","_blank");if(!f){alert("Please allow popups to print the canvas.");return}f.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>PCB Drawing</title>
          <style>
            @media print {
              @page {
                margin: 0;
                size: auto;
              }
              body {
                margin: 0;
                padding: 0;
              }
            }
            body {
              margin: 0;
              padding: 20px;
              display: flex;
              justify-content: center;
              align-items: center;
              background: white;
            }
            img {
              max-width: 100%;
              height: auto;
              display: block;
            }
          </style>
        </head>
        <body>
          <img src="${r}" alt="PCB Drawing" onload="window.setTimeout(function() { window.print(); }, 250);" />
        </body>
      </html>
    `),f.document.close()},[]);Oe.useEffect(()=>{const o=f=>{f.key==="Shift"&&Nr(!0)},r=f=>{f.key==="Shift"&&Nr(!1)};return window.addEventListener("keydown",o),window.addEventListener("keyup",r),()=>{window.removeEventListener("keydown",o),window.removeEventListener("keyup",r)}},[]);const xd=m.useCallback(o=>{if(o.size===0)return;const r=Array.from(o).map(f=>String(f));Pt(f=>f.map(b=>{if(b.type==="trace"){const y=b.points.filter(v=>v.id===void 0?!0:!o.has(v.id));return y.length<2?null:{...b,points:y}}return b}).filter(b=>b!==null)),tn(f=>f.map(b=>{const y=b.pinConnections||[];if(y.some(x=>x&&r.includes(x))){const x=y.map(T=>T&&r.includes(T)?"":T);return{...b,pinConnections:x}}return b})),bn(f=>f.map(b=>{const y=b.pinConnections||[];if(y.some(x=>x&&r.includes(x))){const x=y.map(T=>T&&r.includes(T)?"":T);return{...b,pinConnections:x}}return b}))},[Pt,tn,bn]),jc=m.useRef(new Set);Oe.useEffect(()=>{const o=new Set;for(const f of _e)if((f.type==="via"||f.type==="pad")&&f.points.length>0){const b=f.points[0].id;b!==void 0&&o.add(b)}const r=new Set;for(const f of jc.current)o.has(f)||r.add(f);r.size>0&&xd(r),jc.current=o},[_e,xd]),Oe.useEffect(()=>{Pt(o=>o.map(r=>{if(r.type==="via"&&r.points.length>0&&r.points[0].id!==void 0){const f=r.points[0].id,b=Ii(f,Xe);if(r.viaType!==b)return{...r,viaType:b}}else if(r.type==="pad"&&r.points.length>0&&r.points[0].id!==void 0){const f=r.points[0].id,b=Vi(f,Xe);if(r.padType!==b)return{...r,padType:b}}else if(r.type==="testPoint"&&r.points.length>0&&r.points[0].id!==void 0){const f=r.points[0].id,b=fo(f,Xe),y=b.includes("Power")?"power":b.includes("Ground")?"ground":b.includes("Signal")?"signal":"unknown";if(r.testPointType!==y)return{...r,testPointType:y}}return r}))},[yt,st,Xe,Ii,Vi,fo]),Oe.useEffect(()=>{const o=r=>{Ol.current&&(Ol.current.contains(r.target)||Rr(null))};return document.addEventListener("click",o),()=>document.removeEventListener("click",o)},[]),Oe.useEffect(()=>{const o=(r,f)=>{const b=r.current;if(!b)return;const y=b.getContext("2d");if(!y)return;const v=b.width,x=b.height;if(y.clearRect(0,0,v,x),y.fillStyle="#fff",y.fillRect(0,0,v,x),f?.bitmap){const T=f.bitmap,C=Math.min(v/T.width,x/T.height),k=Math.max(1,Math.floor(T.width*C)),A=Math.max(1,Math.floor(T.height*C)),M=Math.floor((v-k)/2),ie=Math.floor((x-A)/2);y.drawImage(T,M,ie,k,A)}y.strokeStyle="#ddd",y.lineWidth=1,y.strokeRect(.5,.5,v-1,x-1)};o(Qc,g),o(Mr,R)},[g,R]),Oe.useEffect(()=>{const o=[],r=[],f=[],b=[];for(const y of _e)if(y.type==="via"&&y.points.length>=1){const v=y.points[0],x={id:y.id,pointId:v.id,x:v.x,y:v.y,size:y.size,color:y.color};o.push(x)}else if(y.type==="pad"&&y.points.length>=1){const v=y.points[0],x={id:y.id,pointId:v.id,x:v.x,y:v.y,size:y.size,color:y.color,layer:y.layer||"top"};r.push(x)}else if(y.type==="trace"&&y.points.length>=2)for(let v=0;v<y.points.length-1;v++){const x=y.points[v],T=y.points[v+1],C={id:y.id,startPointId:x.id,endPointId:T.id,x1:x.x,y1:x.y,x2:T.x,y2:T.y,size:y.size,color:y.color};y.layer==="top"?f.push(C):b.push(C)}ta(o),yi(r),io(f),lo(b)},[_e]);const Xr=m.useRef(_e);Xr.current=_e;const bo=m.useCallback(()=>{const r=new Date().toISOString(),f=fx();return{project:{version:1,fileType:"PCB_REVERSE_ENGINEERING_AUTOSAVE",savedAt:r,view:{currentView:xe,viewScale:We,viewPan:zt,showBothLayers:vr,selectedDrawingLayer:tt},images:{top:g?{name:g.name,width:g.width,height:g.height,filePath:g.filePath||g.name,x:g.x,y:g.y,scale:g.scale,rotation:g.rotation,flipX:g.flipX,flipY:g.flipY,skewX:g.skewX,skewY:g.skewY,keystoneV:g.keystoneV,keystoneH:g.keystoneH,brightness:g.brightness??100,contrast:g.contrast??100}:null,bottom:R?{name:R.name,width:R.width,height:R.height,filePath:R.filePath||R.name,x:R.x,y:R.y,scale:R.scale,rotation:R.rotation,flipX:R.flipX,flipY:R.flipY,skewX:R.skewX,skewY:R.skewY,keystoneV:R.keystoneV,keystoneH:R.keystoneH,brightness:R.brightness??100,contrast:R.contrast??100}:null},projectDirectoryName:Ba.current?Ba.current.name||null:on&&on.name||null,drawing:{drawingStrokes:Xr.current.filter(y=>!(y.type==="trace"&&y.points.length<2)),vias:Fn,tracesTop:Ia,tracesBottom:Va,componentsTop:Je,componentsBottom:dt,grounds:st,powers:yt},powerBuses:Xe,groundBuses:qt,pointIdCounter:kh(),designatorCounters:Id(),autoAssignDesignators:Tn,useGlobalDesignatorCounters:Uo,traceColors:{top:Ht.get("trace")?.layerSettings.get("top")?.color||D,bottom:Ht.get("trace")?.layerSettings.get("bottom")?.color||O},traceSizes:{top:Ht.get("trace")?.layerSettings.get("top")?.size||W,bottom:Ht.get("trace")?.layerSettings.get("bottom")?.size||Se},padColors:{top:Ht.get("pad")?.layerSettings.get("top")?.color||ce,bottom:Ht.get("pad")?.layerSettings.get("bottom")?.color||I},padSizes:{top:Ht.get("pad")?.layerSettings.get("top")?.size||Be,bottom:Ht.get("pad")?.layerSettings.get("bottom")?.size||w},componentColors:{top:Ht.get("component")?.layerSettings.get("top")?.color||Un,bottom:Ht.get("component")?.layerSettings.get("bottom")?.color||wi},componentSizes:{top:Ht.get("component")?.layerSettings.get("top")?.size||ji,bottom:Ht.get("component")?.layerSettings.get("bottom")?.size||$i},traceToolLayer:pt,toolSettings:{trace:Ht.get("trace")?.settings||{color:"#ff0000",size:6},via:Ht.get("via")?.settings||{color:"#ff0000",size:18},pad:Ht.get("pad")?.settings||{color:"#ff0000",size:18},component:Ht.get("component")?.settings||{color:"#ff0000",size:18},ground:Ht.get("ground")?.settings||{color:"#000000",size:18},power:Ht.get("power")?.settings||{color:"#ff0000",size:18},erase:Ht.get("erase")?.settings||{color:"#f5a3b3",size:18}},locks:{areImagesLocked:Ri,areViasLocked:mi,arePadsLocked:_i,areTracesLocked:vi,areComponentsLocked:Hi,areGroundNodesLocked:Ei,arePowerNodesLocked:Rn},visibility:{showViasLayer:dn,showTopPadsLayer:jn,showBottomPadsLayer:Nn,showTopTracesLayer:qn,showBottomTracesLayer:Jn,showTopComponents:el,showBottomComponents:Ut,showPowerLayer:si,showGroundLayer:Wl,showConnectionsLayer:ja,showTraceCornerDots:Fl},autoSave:{enabled:li,interval:ua,baseName:ha},projectInfo:{name:oi},projectNotes:Ca,homeViews:Ms,toolInstances:At.getAll()},timestamp:f}},[xe,We,zt,vr,tt,g,R,_e,Fn,Ia,Va,Je,dt,st,Ht,Ri,mi,_i,vi,Hi,Ei,Rn,Xe,qt,kh,D,O,W,Se,ce,I,Be,w,Un,wi,ji,$i,pt,li,ua,ha,oi,dn,jn,Nn,qn,Jn,el,Ut,si,Wl,ja,Tn,Uo,Ca,Ms]),ru=m.useRef(bo);ru.current=bo;const Ma=m.useRef(fa);Ma.current=fa;const Xl=m.useRef(ha);Xl.current=ha;const Js=m.useRef(ln);Js.current=ln;const Tc=m.useRef(lc);Tc.current=lc;const di=m.useRef([]);di.current=Xd;const rs=m.useRef(-1);rs.current=Gd;const Ba=m.useRef(null),Ua=m.useRef(!1);Oe.useEffect(()=>{Ua.current||(Ba.current=on)},[on]);const Cc=m.useCallback(async()=>{console.log("Auto save: performAutoSave called");let o=Ba.current,r=Xl.current;if(console.log(`Auto save: projectDirHandle=${o?`set (${o.name})`:"missing"}, baseName=${r||"missing"}`),!o||!r){console.warn(`Auto save: Missing project directory handle (${!o}) or base name (${!r}). Please create a new project or open an existing project first.`),Zi(!1),Zt.current&&(clearInterval(Zt.current),Zt.current=null);return}if(!Ai.current){console.log("Auto save: Skipping - no changes since last save");return}const f=Xr.current,b=f.filter(A=>A.type==="trace"&&A.points.length<2);if(b.length>0){console.log(`Auto save: Cleaning up ${b.length} single-point trace(s) before save`),b.forEach(M=>console.log(`  - Removing single-point trace ${M.id}`));const A=f.filter(M=>!(M.type==="trace"&&M.points.length<2));Pt(A),Xr.current=A}console.log("Auto save: Starting save...");const{project:y,timestamp:v}=ru.current(),T=`${Wc(r)}_${v}.json`,C=JSON.stringify(y,null,2),k=new Blob([C],{type:"application/json"});try{let A;try{A=await o.getDirectoryHandle("history",{create:!0})}catch(J){console.error("Failed to get/create history directory:",J);return}try{const J=[],le=Tc.current;for await(const ne of o.keys())try{if(ne==="history"||ne===T)continue;const Ae=await(await o.getFileHandle(ne)).getFile();if(!ne.endsWith(".json"))continue;const ze=await Ae.text();try{const je=JSON.parse(ze);if(je.version&&(je.fileType==="PCB_REVERSE_ENGINEERING_AUTOSAVE"||!je.fileType)){J.push(ne);const Ee=je.fileType?"auto-saved":"manually saved/opened";console.log(`Auto save: Found PCB project file in root: ${ne} (${Ee}${ne===le?" - this is the opened file":""})`)}}catch{continue}}catch{continue}for(const ne of J)try{const ze=await(await(await o.getFileHandle(ne)).getFile()).text(),Ee=await(await A.getFileHandle(ne,{create:!0})).createWritable();await Ee.write(new Blob([ze],{type:"application/json"})),await Ee.close(),await o.removeEntry(ne),console.log(`Auto save: Moved ${ne} from root to history/`)}catch(be){console.warn(`Auto save: Failed to move ${ne} to history:`,be)}}catch(J){console.warn("Auto save: Error checking for old files in root:",J)}const ie=await(await o.getFileHandle(T,{create:!0})).createWritable();await ie.write(k),await ie.close(),console.log(`Auto save: Successfully saved ${T} to root directory`),Js.current(T);const Q=di.current,q=[T,...Q.filter(J=>J!==T)].sort((J,le)=>le.localeCompare(J));ko(q),di.current=q,Ro(0),rs.current=0,Ai.current=!1,zo(!1)}catch(A){console.error("Auto save failed:",A),zo(!1)}},[]);xa.current=Cc;const cs=m.useCallback(async()=>{const{project:o}=bo(),r=JSON.stringify(o,null,2),f=new Blob([r],{type:"application/json"});if(on&&oi)try{let k=null;try{k=await on.getDirectoryHandle("history",{create:!0})}catch(le){console.error("Failed to get/create history directory:",le),k=null}const A=oi.replace(/\.json$/i,""),M=Wc(A),{timestamp:ie}=bo(),Q=`${M}_${ie}.json`;if(k)try{const le=[];for await(const ne of on.keys())try{if(ne==="history"||ne===Q)continue;const Ae=await(await on.getFileHandle(ne)).getFile();if(!ne.endsWith(".json"))continue;const ze=await Ae.text();try{JSON.parse(ze).version&&(le.push(ne),console.log(`Save: Found PCB project file in root: ${ne}`))}catch{continue}}catch{continue}for(const ne of le)try{const ze=await(await(await on.getFileHandle(ne)).getFile()).text(),Ee=await(await k.getFileHandle(ne,{create:!0})).createWritable();await Ee.write(new Blob([ze],{type:"application/json"})),await Ee.close(),await on.removeEntry(ne),console.log(`Save: Moved ${ne} from root to history/`)}catch(be){console.warn(`Save: Failed to move ${ne} to history:`,be)}}catch(le){console.warn("Save: Error checking for old files in root:",le)}const J=await(await on.getFileHandle(Q,{create:!0})).createWritable();await J.write(f),await J.close(),ln(Q),console.log(`Project saved: ${oi}/${Q}`);return}catch(k){console.error("Failed to save to project directory:",k),Ul(null)}if(oi&&!on){const k=window;if(typeof k.showDirectoryPicker=="function")try{const A=await k.showDirectoryPicker();Ul(A);const M=`${oi}.json`,Q=await(await A.getFileHandle(M,{create:!0})).createWritable();await Q.write(f),await Q.close(),ln(M),console.log(`Project saved: ${M} in selected directory`);return}catch(A){A?.name!=="AbortError"&&console.error("Failed to get directory:",A)}}const b=k=>String(k).padStart(2,"0"),y=new Date,x=`pcb_project_${`${y.getFullYear()}_${b(y.getMonth()+1)}_${b(y.getDate())}_${b(y.getHours())}_${b(y.getMinutes())}_${b(y.getSeconds())}`}.json`,T=window;if(typeof T.showSaveFilePicker=="function")try{const k=await T.showSaveFilePicker({suggestedName:x,types:[{description:"PCB Project",accept:{"application/json":[".json"]}}]}),A=await k.createWritable();await A.write(f),await A.close();const M=k.name;try{const q=await k.getFile();ln(q.name)}catch{ln(M)}const Q=M.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_");Q&&ul(Q);try{const q=k.name.replace(/\.json$/i,""),le=Wc(q).replace(/[^a-zA-Z0-9_-]/g,"_");Bl(le),fa||console.log("Auto save: Directory handle not set. Will prompt on first auto save.")}catch(q){console.warn("Could not set up auto save for new file:",q)}return}catch(k){if(k?.name==="AbortError")return;console.warn("showSaveFilePicker failed, falling back to download",k)}const C=document.createElement("a");C.href=URL.createObjectURL(f),C.download=x,document.body.appendChild(C),C.click(),setTimeout(()=>{URL.revokeObjectURL(C.href),document.body.removeChild(C)},0)},[bo]);Oe.useEffect(()=>{Zt.current&&(clearInterval(Zt.current),Zt.current=null);const o=Dr.current;if(Dr.current=li,li&&ua){const r=ua*60*1e3;fa&&ha?(console.log(`Auto save: Setting up interval for ${ua} minute(s) (${r}ms)`),o||(Ai.current=!0,setTimeout(()=>{Cc()},100)),Zt.current&&(clearInterval(Zt.current),Zt.current=null),Zt.current=window.setInterval(()=>{console.log("Auto save: Interval triggered, calling performAutoSave..."),console.log(`  - hasChangesSinceLastAutoSave: ${Ai.current}`),console.log(`  - dirHandle: ${Ma.current?"set":"missing"}`),console.log(`  - baseName: ${Xl.current||"missing"}`),Cc()},r),console.log(`Auto save: Interval set up for ${r}ms (${ua} minutes)`),console.log(`  - Directory handle: ${fa?"set":"missing"}`),console.log(`  - Base name: ${ha||"missing"}`)):(console.warn(`Auto save: Cannot set up interval - missing directory handle (${!fa}) or base name (${!ha}). Disabling auto save.`),Zi(!1),Zt.current&&(clearInterval(Zt.current),Zt.current=null))}else li||(Dr.current=!1);return()=>{Zt.current&&(clearInterval(Zt.current),Zt.current=null)}},[li,ua,fa,ha]);const er=m.useRef(!1);Oe.useEffect(()=>{if(!li){er.current=!1;return}if(er.current){er.current=!1,console.log("Auto save: Skipping change tracking on first run after enable (initial save handled separately)");return}Ai.current=!0,li&&zo(!0),console.log("Auto save: Change detected, marking for save",{topImage:!!g,bottomImage:!!R,drawingStrokesCount:_e.length,componentsTopCount:Je.length,componentsBottomCount:dt.length,powersCount:yt.length,groundsCount:st.length,powerBusesCount:Xe.length,projectNotesCount:Ca.length,areImagesLocked:Ri,areViasLocked:mi,areTracesLocked:vi,areComponentsLocked:Hi,areGroundNodesLocked:Ei,arePowerNodesLocked:Rn})},[g,R,_e,Je,dt,yt,st,Xe,Ca,D,O,W,Se,Ri,mi,vi,Hi,Ei,Rn,li]),Oe.useEffect(()=>{li?(er.current=!0,console.log("Auto save: Enabled, marking first run"),zo(!1)):(er.current=!1,zo(!1))},[li]),Oe.useEffect(()=>{li||(Ai.current=!1)},[li]);const Gr=m.useCallback(()=>!!(g||R||_e.length>0||Je.length>0||dt.length>0||yt.length>0||st.length>0),[g,R,_e,Je,dt,yt,st]),ds=m.useCallback(()=>{Xa({visible:!0,projectName:"",locationPath:"",locationHandle:null})},[]),cu=m.useCallback(async()=>{const o=window;if(typeof o.showDirectoryPicker=="function")try{const r=await o.showDirectoryPicker({mode:"readwrite"});Xa(f=>({...f,locationHandle:r,locationPath:r.name||"Selected folder"}))}catch(r){r?.name!=="AbortError"&&(console.error("Failed to get directory:",r),alert("Failed to select location directory."))}else alert("Directory picker is not supported in this browser. Please use a modern browser like Chrome or Edge.")},[]),yd=m.useCallback(async()=>{const o=nn.projectName.trim();if(!o){alert("Please enter a project name.");return}const r=o.replace(/[^a-zA-Z0-9_-]/g,"_")||"pcb_project";if(!nn.locationHandle){alert("Please select a location for the project.");return}const f=nn.locationHandle;let b,y;if(f.name===r)b=f,y=f;else{y=f;try{b=await y.getDirectoryHandle(r,{create:!0})}catch(v){console.error("Failed to create project folder:",v),alert(`Failed to create project folder "${r}". See console for details.`);return}}Lr(),Xa({visible:!1,projectName:"",locationPath:"",locationHandle:null}),ul(r),Ul(b),Aa();try{const{project:v,timestamp:x}=bo(),C=`${Wc(r)}_${x}.json`,k=JSON.stringify(v,null,2),A=new Blob([k],{type:"application/json"}),ie=await(await b.getFileHandle(C,{create:!0})).createWritable();await ie.write(A),await ie.close(),ln(C),console.log(`New project created: ${r}/${C}`),Di({visible:!0,source:"new",interval:5})}catch(v){console.error("Failed to save new project:",v),alert("Failed to save new project file. See console for details.")}},[Aa,bo,nn,Lr]),Lo=m.useCallback(()=>{Xa({visible:!1,projectName:"",locationPath:"",locationHandle:null})},[]),du=m.useCallback(()=>{const o=oi?`${oi}.json`:"";da({visible:!0,filename:o,locationPath:"",locationHandle:null}),setTimeout(()=>{if(Us.current?.focus(),Us.current&&o){const r=o.replace(/\.json$/i,"");Us.current.setSelectionRange(0,r.length)}},100)},[oi]),uu=m.useCallback(async()=>{const o=window;if(typeof o.showDirectoryPicker=="function")try{const r=await o.showDirectoryPicker();da(f=>({...f,locationHandle:r,locationPath:r.name||"Selected folder"}))}catch(r){r?.name!=="AbortError"&&(console.error("Failed to get directory:",r),alert("Failed to select location directory."))}else alert("Directory picker is not supported in this browser. Please use a modern browser that supports the File System Access API.")},[]),bd=m.useCallback(async()=>{const o=mn.filename.trim();if(!o){alert("Please enter a file name.");return}const f=(o.endsWith(".json")?o:`${o}.json`).replace(/[^a-zA-Z0-9_.-]/g,"_");if(!mn.locationHandle){alert("Please select a location for the file.");return}const b=mn.locationHandle;try{const{project:y}=bo(),v=JSON.stringify(y,null,2),x=new Blob([v],{type:"application/json"}),C=await(await b.getFileHandle(f,{create:!0})).createWritable();await C.write(x),await C.close(),ln(f);const k=f.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_");k&&ul(k),Ul(b),da({visible:!1,filename:"",locationPath:"",locationHandle:null}),Rr(null),console.log(`Project saved as: ${f} in selected directory`)}catch(y){console.error("Failed to save project:",y),alert(`Failed to save project file "${f}". See console for details.`)}},[mn,bo]),tr=m.useCallback(()=>{da({visible:!1,filename:"",locationPath:"",locationHandle:null})},[]),zc=m.useCallback(async()=>{ra({visible:!1}),await cs(),ds(),yo()},[cs,ds,yo]),md=m.useCallback(()=>{ra({visible:!1}),ds(),yo()},[ds,yo]),fu=m.useCallback(()=>{ra({visible:!1})},[]);Oe.useEffect(()=>{if(ic.visible){setTimeout(()=>{Qa.current?.focus()},0);const o=r=>{r.key==="Enter"?(r.preventDefault(),zc()):r.key==="Escape"&&(r.preventDefault(),ra({visible:!1}))};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}}},[ic.visible,zc]);const Pa=m.useCallback(async(o,r)=>{try{if(la(),o.toolInstances?At.initializeFromProject(o):At.initialize(),o.projectInfo&&o.projectInfo.name&&ul(o.projectInfo.name),o.view&&(o.view.currentView&&X(o.view.currentView),o.view.viewScale!=null&&Ci(o.view.viewScale),o.view.viewPan&&Vn(o.view.viewPan),o.view.showBothLayers!=null&&sl(o.view.showBothLayers),o.view.selectedDrawingLayer&&Dn(o.view.selectedDrawingLayer)),o.homeViews){const T={};for(const[C,k]of Object.entries(o.homeViews)){const A=parseInt(C,10),M=k;M.showTopImage===void 0?T[A]={x:M.x,y:M.y,zoom:M.zoom,showTopImage:va,showBottomImage:Sa,showViasLayer:dn,showTopTracesLayer:qn,showBottomTracesLayer:Jn,showTopPadsLayer:jn,showBottomPadsLayer:Nn,showTopTestPointsLayer:ei,showBottomTestPointsLayer:hl,showTopComponents:el,showBottomComponents:Ut,showPowerLayer:si,showGroundLayer:Wl,showConnectionsLayer:ja}:T[A]=M}Za(T)}else Za({});if(o.projectNotes&&Array.isArray(o.projectNotes)?Io(o.projectNotes):Io([]),o.traceColors&&(o.traceColors.top&&(P(o.traceColors.top),ft("trace",o.traceColors.top,"top")),o.traceColors.bottom&&(he(o.traceColors.bottom),ft("trace",o.traceColors.bottom,"bottom"))),o.traceSizes){const T=o.traceSizes.top!=null&&o.traceSizes.top>0?o.traceSizes.top:6;let C=o.traceSizes.bottom!=null&&o.traceSizes.bottom>0?o.traceSizes.bottom:6;C<6&&(C=6),j(T),me(C),Ze("trace",T,"top"),Ze("trace",C,"bottom")}else j(6),me(6);if(o.padColors&&(o.padColors.top&&(H(o.padColors.top),ft("pad",o.padColors.top,"top")),o.padColors.bottom&&(pe(o.padColors.bottom),ft("pad",o.padColors.bottom,"bottom"))),o.padSizes){const T=o.padSizes.top!=null&&o.padSizes.top>0?o.padSizes.top:18,C=o.padSizes.bottom!=null&&o.padSizes.bottom>0?o.padSizes.bottom:18;K(T),U(C),Ze("pad",T,"top"),Ze("pad",C,"bottom")}if(o.componentColors&&(o.componentColors.top&&(Ui(o.componentColors.top),ft("component",o.componentColors.top,"top")),o.componentColors.bottom&&(pi(o.componentColors.bottom),ft("component",o.componentColors.bottom,"bottom"))),o.componentSizes){const T=o.componentSizes.top!=null&&o.componentSizes.top>0?o.componentSizes.top:18,C=o.componentSizes.bottom!=null&&o.componentSizes.bottom>0?o.componentSizes.bottom:18;zl(T),kl(C),Ze("component",T,"top"),Ze("component",C,"bottom")}if(o.traceToolLayer&&(Pn(o.traceToolLayer),B==="draw"&&De==="trace")){const T=o.traceToolLayer;re(T==="top"?o.traceColors?.top||D:o.traceColors?.bottom||O);const C=o.traceSizes?.top!=null&&o.traceSizes.top>0?o.traceSizes.top:6;let k=o.traceSizes?.bottom!=null&&o.traceSizes.bottom>0?o.traceSizes.bottom:6;k<6&&(k=6),z(T==="top"?C:k)}o.toolSettings&&rn(T=>{const C=new Map(T);if(o.toolSettings.trace){const A=C.get("trace");if(A){const M={...A,settings:o.toolSettings.trace},ie=new Map(A.layerSettings);o.traceSizes&&o.traceColors&&(ie.set("top",{color:o.traceColors.top||A.layerSettings.get("top")?.color||"#AA4499",size:o.traceSizes.top||A.layerSettings.get("top")?.size||6}),ie.set("bottom",{color:o.traceColors.bottom||A.layerSettings.get("bottom")?.color||"#F781BF",size:o.traceSizes.bottom||A.layerSettings.get("bottom")?.size||6})),C.set("trace",{...M,layerSettings:ie})}}if(o.toolSettings.via){const A=C.get("via");A&&C.set("via",{...A,settings:o.toolSettings.via})}if(o.toolSettings.pad){const A=C.get("pad");if(A){const M={...A,settings:o.toolSettings.pad},ie=new Map(A.layerSettings);o.padSizes&&o.padColors&&(ie.set("top",{color:o.padColors.top||A.layerSettings.get("top")?.color||"#0072B2",size:o.padSizes.top||A.layerSettings.get("top")?.size||18}),ie.set("bottom",{color:o.padColors.bottom||A.layerSettings.get("bottom")?.color||"#56B4E9",size:o.padSizes.bottom||A.layerSettings.get("bottom")?.size||18})),C.set("pad",{...M,layerSettings:ie})}}if(o.toolSettings.component){const A=C.get("component");if(A){const M={...A,settings:o.toolSettings.component},ie=new Map(A.layerSettings);o.componentSizes&&o.componentColors&&(ie.set("top",{color:o.componentColors.top||A.layerSettings.get("top")?.color||"#6A3D9A",size:o.componentSizes.top||A.layerSettings.get("top")?.size||18}),ie.set("bottom",{color:o.componentColors.bottom||A.layerSettings.get("bottom")?.color||"#9467BD",size:o.componentSizes.bottom||A.layerSettings.get("bottom")?.size||18})),C.set("component",{...M,layerSettings:ie})}}if(o.toolSettings.ground){const A=C.get("ground");A&&C.set("ground",{...A,settings:o.toolSettings.ground})}if(o.toolSettings.power){const A=C.get("power");A&&C.set("power",{...A,settings:o.toolSettings.power})}if(o.toolSettings.erase){const A=C.get("erase");A&&C.set("erase",{...A,settings:o.toolSettings.erase})}const k=B==="draw"&&De==="trace"?C.get("trace"):B==="draw"&&De==="via"?C.get("via"):B==="draw"&&De==="pad"?C.get("pad"):B==="component"?C.get("component"):B==="power"?C.get("power"):B==="ground"?C.get("ground"):null;if(k)if(B==="draw"&&De==="trace"){const A=pt||"top",M=k.layerSettings.get(A);M?(re(M.color),z(M.size),A==="top"?(P(M.color),j(M.size)):(he(M.color),me(M.size))):(re(k.settings.color),z(k.settings.size))}else if(B==="draw"&&De==="pad"){const A=Ft||"top",M=k.layerSettings.get(A);M?(re(M.color),z(M.size),A==="top"?(H(M.color),K(M.size)):(pe(M.color),U(M.size))):(re(k.settings.color),z(k.settings.size))}else if(B==="component"){const A=kn||"top",M=k.layerSettings.get(A);M?(re(M.color),z(M.size),A==="top"?(Ui(M.color),zl(M.size)):(pi(M.color),kl(M.size))):(re(k.settings.color),z(k.settings.size))}else re(k.settings.color),z(k.settings.size);return C});const f=async(T,C)=>{if(!T)return null;let k=null,A="",M=T.filePath||T.name;if(!C){const ie=T.name||"image";return alert(`Error: Cannot load image "${ie}" because no project directory is available.

Please ensure you opened the project file from its project directory. The project directory is required to access the image files stored in the images/ subdirectory.`),null}if(M)try{let ie=M;!M.startsWith("images/")&&!M.startsWith("Images/")?ie=M:M.startsWith("Images/")?ie=M.replace("Images/",""):M.startsWith("images/")&&(ie=M.replace("images/",""));let Q;try{Q=await C.getDirectoryHandle("images")}catch{try{Q=await C.getDirectoryHandle("Images")}catch{throw new Error("Neither 'images' nor 'Images' directory found in project folder.")}}const J=await(await Q.getFileHandle(ie)).getFile();k=await createImageBitmap(J),A=URL.createObjectURL(J),console.log(`Loaded image from file path: images/${ie}`),M.startsWith("images/")||(M=`images/${M.replace("Images/","")}`)}catch(ie){const Q=ie instanceof Error?ie.message:"Unknown error",q=T.name||"image",J=M.startsWith("images/")||M.startsWith("Images/")?M.replace("Images/","images/"):`images/${M}`;return alert(`Error: Failed to load image "${q}" from project directory.

Expected location: ${J}

This may occur if:
- The image file was moved or deleted
- The project directory structure was modified
- File permissions are insufficient

Please ensure the image file exists in the images/ subdirectory of your project folder.

Technical details: ${Q}`),null}else{const ie=T.name||"image";return alert(`Error: Image "${ie}" has no file path specified in the project file.

The project file is missing the image file path information. This may indicate the project file is corrupted or was created with an older version of the software.`),null}if(!k){const ie=T.name||"image";return alert(`Error: Could not create image bitmap for "${ie}".

The image file may be corrupted or in an unsupported format. Please ensure the image is a valid PNG, JPEG, or other supported image format.`),null}return{url:A,name:T.name??"image",width:T.width??k.width,height:T.height??k.height,filePath:M,x:T.x??0,y:T.y??0,scale:T.scale??1,rotation:T.rotation??0,flipX:!!T.flipX,flipY:!!T.flipY,skewX:T.skewX??0,skewY:T.skewY??0,keystoneV:T.keystoneV??0,keystoneH:T.keystoneH??0,brightness:T.brightness??100,contrast:T.contrast??100,bitmap:k}},b=r!==void 0?r:on,y=await f(o.images?.top,b),v=await f(o.images?.bottom,b);if(d(y),F(v),o.pointIdCounter&&typeof o.pointIdCounter=="number"?$f(o.pointIdCounter):(console.warn("Project file missing pointIdCounter. Starting from 1."),$f(1)),o.locks&&(typeof o.locks.areImagesLocked=="boolean"&&Ss(o.locks.areImagesLocked),typeof o.locks.areViasLocked=="boolean"&&ws(o.locks.areViasLocked),typeof o.locks.arePadsLocked=="boolean"&&kr(o.locks.arePadsLocked),typeof o.locks.areTracesLocked=="boolean"&&oa(o.locks.areTracesLocked),typeof o.locks.areComponentsLocked=="boolean"&&js(o.locks.areComponentsLocked),typeof o.locks.areGroundNodesLocked=="boolean"&&La(o.locks.areGroundNodesLocked),typeof o.locks.arePowerNodesLocked=="boolean"&&Ts(o.locks.arePowerNodesLocked)),o.visibility&&(typeof o.visibility.showViasLayer=="boolean"&&Ji(o.visibility.showViasLayer),typeof o.visibility.showTopPadsLayer=="boolean"&&Ni(o.visibility.showTopPadsLayer),typeof o.visibility.showBottomPadsLayer=="boolean"&&ai(o.visibility.showBottomPadsLayer),typeof o.visibility.showTopTracesLayer=="boolean"&&El(o.visibility.showTopTracesLayer),typeof o.visibility.showBottomTracesLayer=="boolean"&&Zn(o.visibility.showBottomTracesLayer),typeof o.visibility.showTopComponents=="boolean"&&vn(o.visibility.showTopComponents),typeof o.visibility.showBottomComponents=="boolean"&&wt(o.visibility.showBottomComponents),typeof o.visibility.showPowerLayer=="boolean"&&Kn(o.visibility.showPowerLayer),typeof o.visibility.showGroundLayer=="boolean"&&Oo(o.visibility.showGroundLayer),typeof o.visibility.showConnectionsLayer=="boolean"&&_o(o.visibility.showConnectionsLayer),typeof o.visibility.showTraceCornerDots=="boolean"&&Ur(o.visibility.showTraceCornerDots)),o.autoSave?(typeof o.autoSave.enabled=="boolean"&&Zi(o.autoSave.enabled),typeof o.autoSave.interval=="number"&&Ml(o.autoSave.interval),typeof o.autoSave.baseName=="string"&&o.autoSave.baseName?(Bl(o.autoSave.baseName),Xl.current=o.autoSave.baseName,o.autoSave.enabled&&!fa&&(console.log("Auto save: Directory handle not available after page reload (expected). Auto save disabled. Use File -> Auto Save -> Enable to re-enable."),Zi(!1),Ml(null))):o.autoSave.enabled&&(console.warn("Auto save was enabled in project file but base name is missing. Disabling auto save."),Zi(!1),Ml(null),Bl(""),Xl.current="")):(Zi(!1),Ml(null),pa(null),Bl(""),Ma.current=null,Xl.current="",Zt.current&&(clearInterval(Zt.current),Zt.current=null)),o.drawing?.drawingStrokes&&Array.isArray(o.drawing.drawingStrokes)){const T=o.drawing.drawingStrokes.map(C=>({...C,points:C.points.map(k=>({...k,...Yt(k)}))})).filter(C=>!(C.type==="trace"&&C.points.length<2));Pt(T);for(const C of T)for(const k of C.points)k.id&&typeof k.id=="number"&&Lf(k.id)}else console.warn("Project file missing drawingStrokes. Starting with empty strokes."),Pt([]);if(o.drawing?.componentsTop){const T=o.drawing.componentsTop.map(C=>{const k=Yt({x:C.x,y:C.y});return{...C,x:k.x,y:k.y,layer:C.layer||"top",pinConnections:C.pinConnections||new Array(C.pinCount||0).fill("")}});tn(T)}if(o.drawing?.componentsBottom){const T=o.drawing.componentsBottom.map(C=>{const k=Yt({x:C.x,y:C.y});return{...C,x:k.x,y:k.y,layer:C.layer||"bottom",pinConnections:C.pinConnections||new Array(C.pinCount||0).fill("")}});bn(T)}if(o.designatorCounters&&typeof o.designatorCounters=="object"){const T=o.designatorCounters;}else xl.current={};if(typeof o.autoAssignDesignators=="boolean"&&ns(o.autoAssignDesignators),typeof o.useGlobalDesignatorCounters=="boolean"?so(o.useGlobalDesignatorCounters):so(!1),xl.current={},o.drawing?.grounds){const C=o.drawing.grounds.map(k=>{k.pointId||console.warn("Ground symbol missing pointId - this may cause issues");const A=Yt({x:k.x,y:k.y});return{...k,x:A.x,y:A.y}}).filter(k=>{const A=k.y>=0&&k.x>=0&&typeof k.x=="number"&&typeof k.y=="number"&&!isNaN(k.x)&&!isNaN(k.y)&&isFinite(k.x)&&isFinite(k.y);return A||console.warn(`Filtered out invalid ground symbol at (${k.x}, ${k.y})`),A});Qn(C);for(const k of C)k.pointId&&typeof k.pointId=="number"&&Lf(k.pointId)}let x;if(o.powerBuses&&Array.isArray(o.powerBuses)&&o.powerBuses.length>0?(x=o.powerBuses,zi(x)):(x=[{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}],zi(x)),o.groundBuses&&Array.isArray(o.groundBuses)&&o.groundBuses.length>0?Nl(o.groundBuses):Nl([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),o.drawing?.powers){const C=o.drawing.powers.map(k=>{k.pointId||console.warn("Power symbol missing pointId - this may cause issues");const A=Yt({x:k.x,y:k.y});return{...k,x:A.x,y:A.y}}).filter(k=>{const A=k.y>=0&&k.x>=0&&typeof k.x=="number"&&typeof k.y=="number"&&!isNaN(k.x)&&!isNaN(k.y)&&isFinite(k.x)&&isFinite(k.y);return A||console.warn(`Filtered out invalid power node at (${k.x}, ${k.y})`),A});ni(C);for(const k of C)k.pointId&&typeof k.pointId=="number"&&Lf(k.pointId)}Ai.current=!1}catch(f){console.error("Failed to open project",f),alert("Failed to open project file. See console for details.")}},[B,De,on,d,F,$f,Ss,ws,kr,oa,js,La,Ts,Ji,Ni,ai,El,Zn,vn,wt,Kn,Oo,_o,Zi,Ml,pa,Bl,Pt,tn,bn,Qn,zi,Nl,ni,qo,Yt,Xf,sx,Id,ns,so,la]),nr=m.useCallback(async()=>{},[lc]),ir=m.useCallback(async o=>{const r=Ma.current;if(!r){console.warn("Cannot load file: no directory handle");return}try{const b=await(await r.getFileHandle(o)).getFile();if(b.size===0){console.warn(`File ${o} is empty, skipping`);const k=di.current.filter(A=>A!==o);ko(k),di.current=k;return}const y=await b.text();if(!y||y.trim().length===0){console.warn(`File ${o} contains no data, skipping`);const k=di.current.filter(A=>A!==o);ko(k),di.current=k;return}let v;try{v=JSON.parse(y)}catch(C){console.error(`Failed to parse JSON from file ${o}:`,C);const A=di.current.filter(M=>M!==o);ko(A),di.current=A,await nr();return}Aa(),Ci(1),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),ct(new Set),gt(new Set),at(new Set),ht(new Set),yo(),await Pa(v),ln(o);const T=di.current.indexOf(o);T>=0?(Ro(T),rs.current=T):await nr(),Ai.current=!1,zo(!1)}catch(f){console.error("Failed to load file from history:",f);const b=di.current;if(b.includes(o)){const y=b.filter(v=>v!==o);ko(y),di.current=y,await nr()}}},[Pa,nr,yo]),Yn=m.useCallback(async o=>{if(!on){console.warn("Cannot restore file: no project directory handle"),alert("No project directory available. Please open or create a project first.");return}try{let r;try{r=await on.getDirectoryHandle("history")}catch(x){console.error("History directory not found:",x),alert("History directory not found.");return}const b=await(await r.getFileHandle(o)).getFile();if(b.size===0){alert(`File ${o} is empty.`);return}const y=await b.text();if(!y||y.trim().length===0){alert(`File ${o} contains no data.`);return}let v;try{v=JSON.parse(y)}catch(x){console.error(`Failed to parse JSON from file ${o}:`,x),alert(`Failed to parse file ${o}. It may be corrupted.`);return}Aa(),Ci(1),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),ct(new Set),gt(new Set),at(new Set),ht(new Set),yo(),await Pa(v),ln(o),Ai.current=!1,console.log(`Successfully restored file: ${o}`)}catch(r){console.error("Failed to restore file from history:",r),alert(`Failed to restore file ${o}. Please try again.`)}},[on,Pa,ct,gt,at,ht,ln,Ci,Aa,yo]);Oe.useEffect(()=>{Br&&!Ao&&No({x:window.innerWidth/2-300,y:window.innerHeight/2-250})},[Br,Ao]);const ui=m.useCallback(o=>{if(!Ao)return;Bo(!0);const r=o.clientX-Ao.x,f=o.clientY-Ao.y,b=v=>{No({x:v.clientX-r,y:v.clientY-f})},y=()=>{Bo(!1),document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",y)};document.addEventListener("mousemove",b),document.addEventListener("mouseup",y)},[Ao]);m.useCallback(async()=>{const o=rs.current,r=di.current;if(o>=0&&o<r.length-1){const f=o+1,b=r[f];b&&await ir(b)}},[ir]),m.useCallback(async()=>{const o=rs.current,r=di.current;if(o<=0||o>=r.length||r.length===0){console.warn("Cannot navigate to newer file: index is",o,"history length is",r.length);return}if(o>0&&o<r.length&&r.length>0){const f=o-1;if(f>=0&&f<r.length){const b=r[f];b?await ir(b):(console.warn("No newer file found at index",f),await nr())}else console.warn("Cannot navigate to newer file: prevIndex",f,"is out of bounds")}},[ir,nr]),Oe.useEffect(()=>{Ql.current=Xt},[Xt]);const kc=Oe.useRef(De),Rc=Oe.useRef(tt);Oe.useEffect(()=>{const o=De!==kc.current;if(B==="draw"&&kc.current==="trace"&&o){if(Ql.current.length>=2){dl(_e,Je,dt,ki,ii);const r={id:`${Date.now()}-trace-autofinalize`,points:Ql.current,color:L,size:N,layer:Rc.current,type:"trace"};Pt(f=>[...f,r]),Rc.current==="top"?no(f=>[...f,r.id]):cn(f=>[...f,r.id])}hi([]),jo(!1)}kc.current=De,Rc.current=tt},[De,tt,B,L,N]);const vd=Oe.useRef(B);Oe.useEffect(()=>{if(vd.current==="draw"&&B!=="draw"&&De==="trace"&&Ql.current.length>=2){const o={id:`${Date.now()}-trace-autofinalize`,points:Ql.current,color:L,size:N,layer:tt,type:"trace"};Pt(r=>[...r,o]),tt==="top"?no(r=>[...r,o.id]):cn(r=>[...r,o.id]),hi([]),jo(!1)}vd.current=B},[B,De,L,N,tt]);const Sd=Oe.useMemo(()=>["#000000","#3C3C3C","#7F7F7F","#BFBFBF","#0072B2","#56B4E9","#00BFC4","#332288","#1F77B4","#A6CEE3","#17BECF","#6A3D9A","#009E73","#B3DE69","#E69F00","#F0E442","#2CA02C","#B2DF8A","#BCBD22","#FFED6F","#E15759","#D62728","#FB9A99","#CC79A7","#AA4499","#F781BF","#9467BD","#CAB2D6","#9C755F","#8C564B","#FF7F0E","#FFFFFF"],[]);Oe.useEffect(()=>{$r()},[_e]),Oe.useEffect(()=>{$r()},[Je,dt,st,Wl]);const Ke=Gd>0,us=m.useCallback(async()=>{const o=window;if(typeof o.showOpenFilePicker=="function")try{const[r]=await o.showOpenFilePicker({multiple:!1}),f=await r.getFile();if(!f.name.toLowerCase().endsWith(".json")){alert("Please select a .json project file.");return}Ua.current=!0,Lr(),await new Promise(C=>setTimeout(C,0)),ln(f.name);const b=await f.text(),y=JSON.parse(b);Ua.current=!0;let v=null;try{if(typeof r.getParent=="function")v=await r.getParent();else{console.warn("getParent() not available. Prompting user for directory access...");const C=window;if(typeof C.showDirectoryPicker=="function")v=await C.showDirectoryPicker({startIn:r});else throw new Error("Directory picker not available in this browser")}if(v)try{if((await(await v.getFileHandle(f.name)).getFile()).name!==f.name)throw new Error("Directory verification failed: file name mismatch")}catch(C){throw console.error("Directory verification failed:",C),console.error("The selected directory might not contain the opened file"),new Error("Directory verification failed - selected directory does not contain the opened file")}Ul(v),Ba.current=v}catch(C){console.error("Failed to get directory handle from file handle:",C)}finally{setTimeout(()=>{Ua.current=!1},1e3)}const x=y.autoSave?.enabled===!0;await Pa(y,v);let T;if(y.projectInfo?.name?T=y.projectInfo.name:(T=f.name.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_")||"pcb_project",ul(T)),oi||ul(T),x&&v){const C=T.replace(/\.json$/i,""),A=Wc(C).replace(/[^a-zA-Z0-9_-]/g,"_");pa(v),Bl(A),Ma.current=v,Xl.current=A,Zt.current&&(clearInterval(Zt.current),Zt.current=null)}setTimeout(()=>{Di({visible:!0,source:"open",interval:5})},100)}catch(r){if(r?.name==="AbortError")return;console.warn("showOpenFilePicker failed, falling back to input",r),Ds.current?.click()}else Ds.current?.click()},[Pa,oi,ln,ul,Ul,Di,li,pa,Bl,Lr]),lr=m.useCallback(async()=>{ks({visible:!1}),await cs(),await us()},[cs,us]),pu=m.useCallback(async()=>{ks({visible:!1}),await us()},[us]),qu=m.useCallback(()=>{ks({visible:!1})},[]);Oe.useEffect(()=>{if(ca.visible){setTimeout(()=>{qd.current?.focus()},0);const o=r=>{r.key==="Enter"?(r.preventDefault(),lr()):r.key==="Escape"&&(r.preventDefault(),ks({visible:!1}))};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}}},[ca.visible,lr]);const Dc=m.useCallback(async()=>{Gr()?ks({visible:!0}):await us()},[Gr,us]);return n.jsxs("div",{className:"app",children:[n.jsx("header",{className:"app-header",children:n.jsx("h1",{children:" Worms: An Electronics Tool (v2.5)"})}),n.jsx(yx,{openMenu:Yu,setOpenMenu:Rr,isReadOnlyMode:Ke,currentProjectFilePath:lc,isProjectActive:!!on,autoSaveEnabled:li,autoSaveIndicatorActive:Yd,onNewProject:ds,onOpenProject:Dc,onSaveProject:cs,onSaveAs:du,onPrint:su,hasUnsavedChanges:Gr,setNewProjectDialog:ra,setAutoSaveDialog:aa,topImage:g,bottomImage:R,setCurrentTool:te,resetImageTransform:pd,areImagesLocked:Ri,setAreImagesLocked:Ss,onEnterBoardDimensions:()=>Fs(!0),fileInputTopRef:Zc,fileInputBottomRef:ga,openProjectRef:Ds,increaseSize:Zs,decreaseSize:Ks,brushSize:N,drawingStrokes:_e,selectedIds:qe,selectedComponentIds:mt,selectedPowerIds:Et,selectedGroundIds:jt,componentsTop:Je,componentsBottom:dt,powers:yt,grounds:st,powerNodeNames:Ra,groundNodeNames:il,setSetSizeDialog:tc,areViasLocked:mi,setAreViasLocked:ws,arePadsLocked:_i,setArePadsLocked:kr,areTestPointsLocked:Co,setAreTestPointsLocked:Gc,areTracesLocked:vi,setAreTracesLocked:oa,areComponentsLocked:Hi,setAreComponentsLocked:js,areGroundNodesLocked:Ei,setAreGroundNodesLocked:La,arePowerNodesLocked:Rn,setArePowerNodesLocked:Ts,showTraceCornerDots:Fl,setShowTraceCornerDots:Ur,setSelectedIds:ct,setSelectedComponentIds:gt,setSelectedPowerIds:at,setSelectedGroundIds:ht,selectAllVias:Kd,selectAllTraces:$s,selectAllPads:hc,selectAllComponents:Qd,selectDisconnectedComponents:nd,selectAllComponentConnections:id,selectAllPowerNodes:_n,selectAllGroundNodes:gc,selectPowerNodesByName:Vo,selectGroundNodesByName:Tt,setShowPowerBusManager:Ps,setShowGroundBusManager:Vl,setShowDesignatorManager:Po,setShowPastMachine:_s,toolRegistry:Ht,updateToolSettings:Jr,updateToolLayerSettings:ea,setBrushSize:z,setBrushColor:re,saveToolSettings:Ah,saveToolLayerSettings:Fc,colorPalette:Sd,currentTool:B,drawingMode:De,traceToolLayer:pt,padToolLayer:Ft,testPointToolLayer:sn,componentToolLayer:kn,setTopTraceSize:j,setBottomTraceSize:me,setTopPadSize:K,setBottomPadSize:U,setTopTestPointSize:Gt,setBottomTestPointSize:In,setTopComponentSize:zl,setBottomComponentSize:kl,setComponentConnectionSize:$c,topTraceColor:D,bottomTraceColor:O,topPadColor:ce,bottomPadColor:I,topTestPointColor:$,bottomTestPointColor:Ie,topComponentColor:Un,bottomComponentColor:wi,setTopTraceColor:P,setBottomTraceColor:he,setTopPadColor:H,setBottomPadColor:pe,setTopTestPointColor:Z,setBottomTestPointColor:ot,setTopComponentColor:Ui,setBottomComponentColor:pi,setComponentConnectionColor:yr,saveDefaultSize:Ze,saveDefaultColor:ft,menuBarRef:Ol,onOpenProjectNotes:gd,onOpenTransformImages:()=>Rs(!0)}),n.jsx("div",{style:{display:"block",padding:0,margin:0,width:"100vw",height:"calc(100vh - 70px)",boxSizing:"border-box",position:"relative"},children:n.jsxs("div",{ref:Ar,style:{position:"relative",width:"100%",height:"100%",margin:0,padding:0,boxSizing:"border-box",background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",borderRadius:"16px",overflow:"hidden"},children:[n.jsxs("div",{style:{position:"absolute",top:6,left:6,bottom:6,width:46,display:"flex",flexDirection:"column",gap:8,padding:"6px 3px",background:"rgba(250,250,255,0.95)",borderRadius:8,border:"1px solid #ddd",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:20},children:[n.jsxs("button",{onClick:()=>{Ke||Qs()},onMouseDown:o=>o.currentTarget.blur(),disabled:Ke,title:"Select (S)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:B==="select"?"2px solid #000":"1px solid #ddd",background:B==="select"?"#e6f0ff":"#fff",color:Ke?"#999":"#222",outline:"none",cursor:Ke?"not-allowed":"pointer",opacity:Ke?.5:1},children:[n.jsx(Kg,{size:14}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"S"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),n.jsxs("button",{onClick:()=>{Ke||(console.log("Via tool clicked"),Gn("via"),te("draw"))},disabled:Ke,title:"Draw Vias (V)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:B==="draw"&&De==="via"?"2px solid #000":"1px solid #ddd",background:B==="draw"&&De==="via"?"#e6f0ff":"#fff",color:Ke?"#999":"#222",cursor:Ke?"not-allowed":"pointer",opacity:Ke?.5:1},children:[n.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const o=At.get("via").color;return n.jsxs(n.Fragment,{children:[n.jsx("circle",{cx:"12",cy:"12",r:"8",fill:"none",stroke:o,strokeWidth:"3"}),n.jsx("circle",{cx:"12",cy:"12",r:"4",fill:o})]})})()}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"V"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:At.get("via").size})]})]}),n.jsxs("button",{ref:vl,onClick:()=>{Ke||(console.log("Pad tool clicked"),Gn("pad"),te("draw"),Wo(!0),Dn(Ft||"top"),setTimeout(()=>Sc(),0))},disabled:Ke,title:"Draw Pads (P)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:B==="draw"&&De==="pad"?"2px solid #000":"1px solid #ddd",background:B==="draw"&&De==="pad"?"#e6f0ff":"#fff",color:Ke?"#999":"#222",cursor:Ke?"not-allowed":"pointer",opacity:Ke?.5:1},children:[n.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const r=(Ft||"top")==="top"?"padTop":"padBottom",f=At.get(r).color,b=14,y=(24-b)/2,v=(24-b)/2;return n.jsx("rect",{x:y,y:v,width:b,height:b,fill:f})})()}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"P"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{if(B==="draw"&&De==="pad"&&Bt.toolInstanceId&&(Bt.toolInstanceId==="padTop"||Bt.toolInstanceId==="padBottom"))return Bt.size;const o=Ft==="top"?"padTop":"padBottom";return At.get(o).size})()})]})]}),n.jsxs("button",{ref:as,onClick:()=>{Ke||(console.log("Test Point tool clicked"),Gn("testPoint"),te("draw"),Ll(!0),Dn(sn||"top"),setTimeout(()=>Yr(),0))},disabled:Ke,title:"Draw Test Points (Y)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:B==="draw"&&De==="testPoint"?"2px solid #000":"1px solid #ddd",background:B==="draw"&&De==="testPoint"?"#e6f0ff":"#fff",color:Ke?"#999":"#222",cursor:Ke?"not-allowed":"pointer",opacity:Ke?.5:1},children:[n.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const r=(sn||"top")==="top"?"testPointTop":"testPointBottom",f=At.get(r).color,b=14,y=12,v=12;return n.jsx("path",{d:`M ${y} ${v-b/2} L ${y+b/2} ${v} L ${y} ${v+b/2} L ${y-b/2} ${v} Z`,fill:f,stroke:"#000",strokeWidth:"1.5"})})()}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"Y"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{if(B==="draw"&&De==="testPoint"&&Bt.toolInstanceId&&(Bt.toolInstanceId==="testPointTop"||Bt.toolInstanceId==="testPointBottom"))return Bt.size;const o=sn==="top"?"testPointTop":"testPointBottom";return At.get(o).size})()})]})]}),n.jsxs("button",{ref:qs,onClick:()=>{Ke||(console.log("Trace tool clicked"),Gn("trace"),te("draw"),po(!0),Dn(pt||"top"),setTimeout(()=>vc(),0))},disabled:Ke,title:"Draw Traces (T)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:B==="draw"&&De==="trace"?"2px solid #000":"1px solid #ddd",background:B==="draw"&&De==="trace"?"#e6f0ff":"#fff",color:Ke?"#999":"#222",cursor:Ke?"not-allowed":"pointer",opacity:Ke?.5:1},children:[n.jsx(Jg,{size:14,color:(()=>{const r=(pt||"top")==="top"?"traceTop":"traceBottom";return At.get(r).color})()}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"T"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{const o=pt==="top"?"traceTop":"traceBottom";return At.get(o).size})()})]})]}),n.jsxs("button",{ref:Vr,onClick:()=>{Ke||(console.log("Component tool clicked"),te("component"),Fo(!0),go(!1),Xs(null))},disabled:Ke,title:"Draw Component (C)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:B==="component"?"2px solid #000":"1px solid #ddd",background:B==="component"?"#e6f0ff":"#fff",color:Ke?"#999":"#222",cursor:Ke?"not-allowed":"pointer",opacity:Ke?.5:1},children:[(()=>{const r=(kn||"top")==="top"?"componentTop":"componentBottom",f=At.get(r).color;return Wi?n.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[n.jsx("rect",{x:"4",y:"4",width:"16",height:"16",fill:"rgba(255,255,255,0.9)",stroke:f,strokeWidth:"1.5"}),n.jsx("text",{x:"12",y:"14",textAnchor:"middle",fontSize:"7",fill:f,fontWeight:"bold",fontFamily:"monospace",children:Yf(Wi)})]}):n.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[n.jsx("rect",{x:"5",y:"3",width:"14",height:"7",fill:f,stroke:f,strokeWidth:"0.5"}),n.jsxs("g",{stroke:f,fill:"none",strokeWidth:"1.5",children:[n.jsx("rect",{x:"5",y:"10",width:"14",height:"4",rx:"1.2"}),n.jsx("path",{d:"M7 14 v4 M10 14 v4 M13 14 v4 M16 14 v4",stroke:f})]})]})})(),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"C"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{const o=kn==="top"?"componentTop":"componentBottom";return At.get(o).size})()})]})]}),n.jsxs("button",{ref:Wr,onClick:()=>{Ke||(console.log("Power tool clicked"),ti(!1),Xe.length===1?(gl(Xe[0].id),te("power"),$n(!1)):Xe.length>1?$n(!0):($n(!0),te("power")))},disabled:Ke,title:"Draw Power (B)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:B==="power"?"2px solid #000":"1px solid #ddd",background:B==="power"?"#e6f0ff":"#fff",color:Ke?"#999":"#222",cursor:Ke?"not-allowed":"pointer",opacity:Ke?.5:1},children:[n.jsx("span",{style:{color:(tl?Xe.find(o=>o.id===tl)?.color:null)||"#ff0000",fontSize:"18px",fontWeight:"bold",lineHeight:1,flexShrink:0},children:"V"}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"B"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:At.get("power").size})]})]}),n.jsxs("button",{ref:yc,onClick:()=>{Ke||(console.log("Ground tool clicked"),$n(!1),qt.length===1?(ts(qt[0].id),te("ground"),ti(!1)):qt.length>1?ti(!0):(ti(!0),te("ground")))},disabled:Ke,title:"Draw Ground (G)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:B==="ground"?"2px solid #000":"1px solid #ddd",background:B==="ground"?"#e6f0ff":"#fff",color:Ke?"#999":"#222",cursor:Ke?"not-allowed":"pointer",opacity:Ke?.5:1},children:[n.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 20","aria-hidden":"true",style:{overflow:"visible",flexShrink:0},children:n.jsxs("g",{stroke:(nl?qt.find(o=>o.id===nl)?.color:null)||"#000000",strokeWidth:"2",strokeLinecap:"round",children:[n.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"10"}),n.jsx("line",{x1:"5",y1:"10",x2:"19",y2:"10"}),n.jsx("line",{x1:"7",y1:"13",x2:"17",y2:"13"}),n.jsx("line",{x1:"9.5",y1:"16",x2:"14.5",y2:"16"})]})}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"G"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:At.get("ground").size})]})]}),n.jsx("div",{style:{height:72}}),n.jsxs("button",{onClick:()=>{Ke||te(o=>o==="pan"?"draw":"pan")},disabled:Ke,title:"Move (H)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:6,padding:"4px 6px",borderRadius:6,border:B==="pan"?"2px solid #000":"1px solid #ddd",background:B==="pan"?"#e6f0ff":"#fff",color:Ke?"#999":"#222",cursor:Ke?"not-allowed":"pointer",opacity:Ke?.5:1},children:[n.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:n.jsxs("g",{stroke:"#111",fill:"none",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round",children:[n.jsx("path",{d:"M8 11v-4c0-.8.6-1.3 1.3-1.3S11 6.2 11 7v4"}),n.jsx("path",{d:"M11 11V6.5c0-.8.6-1.3 1.3-1.3S14 5.7 14 6.5V11"}),n.jsx("path",{d:"M14 11V7.2c0-.8.6-1.3 1.3-1.3.7 0 1.3.5 1.3 1.3V12c1 .6 1.6 1.5 1.6 2.7A4.3 4.3 0 0 1 14 19H9.2A4.2 4.2 0 0 1 5 14.8V11c0-.6.4-1 .9-1 .6 0 1 .4 1 1v2"})]})}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"H"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),n.jsxs("button",{onClick:()=>{Nr(!1),te(o=>o==="magnify"?"draw":"magnify")},title:"Magnify (M)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:B==="magnify"?"2px solid #000":"1px solid #ddd",background:B==="magnify"?"#e6f0ff":"#fff",color:"#222",cursor:"pointer"},children:[n.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[n.jsx("circle",{cx:"10",cy:"10",r:"7.5",fill:"none",stroke:"#111",strokeWidth:"2"}),n.jsx("line",{x1:"15.5",y1:"15.5",x2:"21",y2:"21",stroke:"#111",strokeWidth:"2",strokeLinecap:"round"}),oc?n.jsx("line",{x1:"6.5",y1:"10",x2:"13.5",y2:"10",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"}):n.jsxs(n.Fragment,{children:[n.jsx("line",{x1:"6.5",y1:"10",x2:"13.5",y2:"10",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"}),n.jsx("line",{x1:"10",y1:"6.5",x2:"10",y2:"13.5",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"})]})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"M"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),n.jsxs("button",{onClick:()=>{Ke||(te("center"),Ki(!0),pn.current&&clearTimeout(pn.current),pn.current=setTimeout(()=>{Ki(!1),te("select"),Wn(void 0)},2e3))},disabled:Ke,title:"Set View (X) - Press 0-9 to Set View",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:B==="center"?"2px solid #000":"1px solid #ddd",background:B==="center"?"#e6f0ff":"#fff",color:Ke?"#999":"#222",cursor:Ke?"not-allowed":"pointer",opacity:Ke?.5:1},children:[n.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[n.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"10",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),n.jsx("line",{x1:"12",y1:"14",x2:"12",y2:"22",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),n.jsx("line",{x1:"2",y1:"12",x2:"10",y2:"12",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),n.jsx("line",{x1:"14",y1:"12",x2:"22",y2:"12",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[n.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"X"}),n.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("button",{onClick:()=>{Ke||oo(o=>!o)},disabled:Ke,title:"Color Picker",style:{width:32,height:32,display:"grid",placeItems:"center",borderRadius:6,border:"1px solid #ddd",background:"#fff",cursor:Ke?"not-allowed":"pointer",opacity:Ke?.5:1},children:n.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 16 16","aria-hidden":"true",children:[n.jsx("rect",{x:"0",y:"0",width:"3.5",height:"3.5",fill:"#9E9E9E",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"4",y:"0",width:"3.5",height:"3.5",fill:"#0072B2",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"8",y:"0",width:"3.5",height:"3.5",fill:"#56B4E9",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"12",y:"0",width:"3.5",height:"3.5",fill:"#00BFC4",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"0",y:"4",width:"3.5",height:"3.5",fill:"#6A3D9A",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"4",y:"4",width:"3.5",height:"3.5",fill:"#2CA02C",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"8",y:"4",width:"3.5",height:"3.5",fill:"#7FC97F",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"12",y:"4",width:"3.5",height:"3.5",fill:"#FF7F0E",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"0",y:"8",width:"3.5",height:"3.5",fill:"#FFD700",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"4",y:"8",width:"3.5",height:"3.5",fill:"#FF6B6B",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"8",y:"8",width:"3.5",height:"3.5",fill:"#E74C3C",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"12",y:"8",width:"3.5",height:"3.5",fill:"#FFB6C1",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"0",y:"12",width:"3.5",height:"3.5",fill:"#DDA0DD",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"4",y:"12",width:"3.5",height:"3.5",fill:"#8B4513",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"8",y:"12",width:"3.5",height:"3.5",fill:"#A0522D",stroke:"#ccc",strokeWidth:"0.3"}),n.jsx("rect",{x:"12",y:"12",width:"3.5",height:"3.5",fill:"#FF4500",stroke:"#ccc",strokeWidth:"0.3"})]})}),Ga&&n.jsx("div",{ref:ma,style:{position:"absolute",left:42,top:0,padding:8,background:"#fff",border:"1px solid #ddd",borderRadius:6,boxShadow:"0 8px 18px rgba(0,0,0,0.18)",zIndex:50},children:n.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(8, 22px)",gap:4},children:Sd.map(o=>n.jsx("div",{onClick:()=>{re(o),oo(!1);try{let f=null;B==="draw"&&De==="via"?f="via":B==="draw"&&De==="pad"?f=(Ft||"top")==="bottom"?"padBottom":"padTop":B==="draw"&&De==="testPoint"?f=(sn||"top")==="bottom"?"testPointBottom":"testPointTop":B==="draw"&&De==="trace"?f=(pt||"top")==="bottom"?"traceBottom":"traceTop":B==="component"?f=(kn||"top")==="bottom"?"componentBottom":"componentTop":B==="power"?f="power":B==="ground"&&(f="ground"),f&&At.setColor(f,o)}catch(f){console.error("Error updating tool instance color:",f)}const r=cl(Ht);if(r)if(B==="draw"&&De==="trace"){const f=pt||"top",y=r.layerSettings.get(f)?.size||r.settings.size,v={color:o,size:y};ea(r.id,f,v),Fc(r.id),f==="top"?(P(o),ft("trace",o,"top")):(he(o),ft("trace",o,"bottom"))}else if(B==="draw"&&De==="pad"){const f=Ft||"top",y=r.layerSettings.get(f)?.size||r.settings.size,v={color:o,size:y};ea(r.id,f,v),Fc(r.id),f==="top"?(H(o),ft("pad",o,"top")):(pe(o),ft("pad",o,"bottom"))}else if(B==="draw"&&De==="testPoint"){const f=sn||"top",y=r.layerSettings.get(f)?.size||r.settings.size,v={color:o,size:y};ea(r.id,f,v),Fc(r.id),f==="top"?(Z(o),ft("testPoint",o,"top")):(ot(o),ft("testPoint",o,"bottom"))}else if(B==="component"){const f=kn||"top",y=r.layerSettings.get(f)?.size||r.settings.size,v={color:o,size:y};ea(r.id,f,v),Fc(r.id),f==="top"?(Ui(o),ft("component",o,"top")):(pi(o),ft("component",o,"bottom"))}else{const f={...r.settings,color:o};Jr(r.id,f),Ah(r.id,o,r.settings.size),B==="draw"&&De==="via"&&ft("via",o)}ft("brush",o),qe.size>0&&Pt(f=>f.map(b=>qe.has(b.id)?(b.type==="via"?(ft("via",o),rn(y=>{const v=new Map(y),x=v.get("via");return x&&v.set("via",{...x,settings:{...x.settings,color:o}}),v})):b.type==="pad"?(ft("pad",o),rn(y=>{const v=new Map(y),x=v.get("pad");return x&&v.set("pad",{...x,settings:{...x.settings,color:o}}),v})):b.type==="trace"&&ft("trace",o,b.layer),{...b,color:o}):b)),mt.size>0&&(ft("component",o),tn(f=>f.map(b=>mt.has(b.id)?{...b,color:o}:b)),bn(f=>f.map(b=>mt.has(b.id)?{...b,color:o}:b))),Et.size>0&&ni(f=>f.map(b=>Et.has(b.id)?{...b,color:o}:b)),jt.size>0&&Qn(f=>f.map(b=>jt.has(b.id)?{...b,color:o}:b))},title:o,style:{width:22,height:22,backgroundColor:o,border:o===L?"2px solid #333":"1px solid #ccc",cursor:"pointer"}},o))})})]})]}),B==="draw"&&De==="trace"&&Cn&&n.jsxs("div",{ref:$l,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[n.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[n.jsx("input",{type:"radio",name:"traceToolLayer",checked:pt==="top",onChange:()=>{console.log("Trace tool Top clicked"),Qo.current="top",Pn("top"),Dn("top"),re(D),z(W),rn(o=>{const r=new Map(o),f=r.get("trace");return f&&r.set("trace",{...f,settings:{color:D,size:W}}),r}),po(!1),_l(!0)}}),n.jsx("span",{children:"Top"})]}),n.jsxs("label",{className:"radio-label",children:[n.jsx("input",{type:"radio",name:"traceToolLayer",checked:pt==="bottom",onChange:()=>{console.log("Trace tool Bottom clicked"),Qo.current="bottom",Pn("bottom"),Dn("bottom"),re(O),z(Se),rn(o=>{const r=new Map(o),f=r.get("trace");return f&&r.set("trace",{...f,settings:{color:O,size:Se}}),r}),po(!1),Hl(!0)}}),n.jsx("span",{children:"Bottom"})]})]}),B==="draw"&&De==="pad"&&ho&&n.jsxs("div",{ref:Hr,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[n.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[n.jsx("input",{type:"radio",name:"padToolLayer",checked:Ft==="top",onChange:()=>{console.log("Pad tool Top clicked"),Dl.current="top",Ha("top"),Dn("top");const o=At.get("padTop");re(o.color),z(o.size),rn(r=>{const f=new Map(r),b=f.get("pad");return b&&f.set("pad",{...b,settings:{color:o.color,size:o.size}}),f}),Wo(!1),_l(!0)}}),n.jsx("span",{children:"Top"})]}),n.jsxs("label",{className:"radio-label",children:[n.jsx("input",{type:"radio",name:"padToolLayer",checked:Ft==="bottom",onChange:()=>{console.log("Pad tool Bottom clicked"),Dl.current="bottom",Ha("bottom"),Dn("bottom");const o=At.get("padBottom");re(o.color),z(o.size),rn(r=>{const f=new Map(r),b=f.get("pad");return b&&f.set("pad",{...b,settings:{color:o.color,size:o.size}}),f}),Wo(!1),Hl(!0)}}),n.jsx("span",{children:"Bottom"})]})]}),B==="draw"&&De==="testPoint"&&os&&n.jsxs("div",{ref:hn,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[n.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[n.jsx("input",{type:"radio",name:"testPointToolLayer",checked:sn==="top",onChange:()=>{console.log("Test Point tool Top clicked"),rl.current="top",Sr("top"),Dn("top"),re($),z(xt),rn(o=>{const r=new Map(o),f=r.get("testPoint");return f&&r.set("testPoint",{...f,settings:{color:$,size:xt}}),r}),Ll(!1),_l(!0)}}),n.jsx("span",{children:"Top"})]}),n.jsxs("label",{className:"radio-label",children:[n.jsx("input",{type:"radio",name:"testPointToolLayer",checked:sn==="bottom",onChange:()=>{console.log("Test Point tool Bottom clicked"),rl.current="bottom",Sr("bottom"),Dn("bottom"),re(Ie),z(He),rn(o=>{const r=new Map(o),f=r.get("testPoint");return f&&r.set("testPoint",{...f,settings:{color:Ie,size:He}}),r}),Ll(!1),Hl(!0)}}),n.jsx("span",{children:"Bottom"})]})]}),Il&&n.jsxs("div",{ref:Ls,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25,minWidth:"200px"},children:[n.jsx("div",{style:{marginBottom:"4px",fontWeight:600,fontSize:"12px",color:"#333"},children:"Select Power Bus:"}),Xe.length===0?n.jsx("div",{style:{padding:"8px",color:"#666",fontSize:"12px"},children:"No power buses defined. Use Tools  Manage Power Buses to add one."}):[...Xe].sort((o,r)=>{const f=v=>{const x=v.match(/([+-]?)(\d+\.?\d*)/);if(x){const T=x[1]||"+",C=parseFloat(x[2]);return{absValue:Math.abs(C),isNegative:T==="-",original:v}}return{absValue:1/0,isNegative:!1,original:v}},b=f(o.voltage),y=f(r.voltage);return b.absValue!==y.absValue?b.absValue-y.absValue:b.isNegative!==y.isNegative?b.isNegative?-1:1:0}).map(o=>n.jsx("button",{onClick:r=>{r.preventDefault(),r.stopPropagation(),gl(o.id),B!=="power"&&te("power"),$n(!1)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#222"},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[n.jsx("div",{style:{width:16,height:16,borderRadius:"50%",background:o.color,border:"1px solid #ccc"}}),n.jsxs("div",{children:[n.jsx("div",{style:{fontWeight:600,fontSize:"13px"},children:o.name}),n.jsx("div",{style:{fontSize:"11px",color:"#666"},children:o.voltage})]})]})},o.id)),n.jsx("div",{style:{height:1,background:"#ddd",margin:"4px 0"}}),n.jsx("button",{onClick:o=>{o.preventDefault(),o.stopPropagation(),$n(!1),Ps(!0)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"11px"},children:"Manage Power Buses"}),n.jsx("button",{onClick:o=>{o.preventDefault(),o.stopPropagation(),$n(!1),gl(null),te("select")},style:{display:"block",width:"100%",textAlign:"center",padding:"4px 6px",marginTop:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#666",fontSize:"11px"},children:"Cancel"})]}),dc&&n.jsxs("div",{ref:Ys,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25,minWidth:"200px"},children:[n.jsx("div",{style:{marginBottom:"4px",fontWeight:600,fontSize:"12px",color:"#333"},children:"Select Ground Bus:"}),qt.length===0?n.jsx("div",{style:{padding:"8px",color:"#666",fontSize:"12px"},children:"No ground buses defined. Use Tools  Manage Ground Buses to add one."}):[...qt].sort((o,r)=>o.name.localeCompare(r.name)).map(o=>{const r=o.id==="groundbus-earth",f=nl===o.id;return n.jsx("button",{onClick:b=>{b.preventDefault(),b.stopPropagation(),ts(o.id),B!=="ground"&&te("ground"),ti(!1)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:f?"#e0e0e0":"#f5f5f5",border:f?"2px solid #000":"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#222"},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[n.jsx("div",{style:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:r?n.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",style:{display:"block"},children:[n.jsx("line",{x1:"10",y1:"2",x2:"10",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),n.jsx("line",{x1:"4",y1:"10",x2:"16",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),n.jsx("line",{x1:"5",y1:"12.5",x2:"15",y2:"12.5",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),n.jsx("line",{x1:"6",y1:"15",x2:"14",y2:"15",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"})]}):n.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",style:{display:"block"},children:[n.jsx("circle",{cx:"10",cy:"10",r:"6",fill:"none",stroke:"#000",strokeWidth:"2"}),n.jsx("line",{x1:"10",y1:"2",x2:"10",y2:"18",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),n.jsx("line",{x1:"2",y1:"10",x2:"18",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"})]})}),n.jsx("div",{children:n.jsx("div",{style:{fontWeight:600,fontSize:"13px"},children:o.name})})]})},o.id)}),n.jsx("div",{style:{height:1,background:"#ddd",margin:"4px 0"}}),n.jsx("button",{onClick:o=>{o.preventDefault(),o.stopPropagation(),ti(!1),Vl(!0)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"11px"},children:"Manage Ground Buses"}),n.jsx("button",{onClick:o=>{o.preventDefault(),o.stopPropagation(),ti(!1),ts(null),te("select")},style:{display:"block",width:"100%",textAlign:"center",padding:"4px 6px",marginTop:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#666",fontSize:"11px"},children:"Cancel"})]}),B==="component"&&Ir&&n.jsxs("div",{ref:xo,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[n.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[n.jsx("input",{type:"radio",name:"componentToolLayer",checked:tt==="top",onClick:()=>{console.log("Component tool Top clicked"),Al.current="top",To("top"),Dn("top"),re(Un),z(ji),rn(o=>{const r=new Map(o),f=r.get("component");return f&&r.set("component",{...f,settings:{color:Un,size:ji}}),r}),Fo(!1),_l(!0),go(!0)}}),n.jsx("span",{children:"Top"})]}),n.jsxs("label",{className:"radio-label",children:[n.jsx("input",{type:"radio",name:"componentToolLayer",checked:tt==="bottom",onClick:()=>{console.log("Component tool Bottom clicked"),Al.current="bottom",To("bottom"),Dn("bottom"),re(wi),z($i),rn(o=>{const r=new Map(o),f=r.get("component");return f&&r.set("component",{...f,settings:{color:wi,size:$i}}),r}),Fo(!1),Hl(!0),go(!0)}}),n.jsx("span",{children:"Bottom"})]})]}),B==="component"&&Er&&n.jsxs("div",{ref:Gs,style:{position:"absolute",top:44,left:52,padding:"8px",background:"#fff",border:"1px solid #ddd",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:26,maxHeight:"500px",overflowY:"auto",minWidth:"250px",maxWidth:"350px"},children:[n.jsx("div",{style:{marginBottom:"8px",fontWeight:600,fontSize:"13px",color:"#333",borderBottom:"1px solid #eee",paddingBottom:"6px"},children:"Select Component Type:"}),Object.entries(ix).map(([o,r])=>{const f=Hn.has(o);return n.jsxs("div",{style:{marginBottom:"4px"},children:[n.jsxs("button",{onClick:b=>{b.preventDefault(),b.stopPropagation(),xc(y=>{const v=new Set(y);return v.has(o)?v.delete(o):v.add(o),v})},style:{display:"flex",alignItems:"center",width:"100%",textAlign:"left",padding:"6px 8px",background:f?"#f0f0f0":"#fff",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",fontSize:"12px",fontWeight:600,color:"#333"},children:[n.jsx("span",{style:{marginRight:"6px",fontSize:"10px"},children:f?"":""}),o]}),f&&n.jsx("div",{style:{marginLeft:"12px",marginTop:"2px",marginBottom:"4px"},children:Object.entries(r).map(([b,y])=>n.jsxs("div",{style:{marginBottom:"2px"},children:[n.jsxs("div",{style:{fontSize:"11px",fontWeight:500,color:"#666",padding:"2px 4px",marginBottom:"2px"},children:[b,":"]}),y.map(v=>{const x=Wd[v];return x?n.jsxs("button",{onClick:T=>{T.preventDefault(),T.stopPropagation();const C=v;Xs(C),ci.current=C,go(!1)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 8px 4px 16px",marginBottom:"2px",background:Wi===v?"#e6f0ff":"#fff",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",fontSize:"11px",color:"#333"},children:[x.prefix.join(", ")," - ",Vd(v)]},v):null})]},b))})]},o)}),n.jsx("button",{onClick:o=>{o.preventDefault(),o.stopPropagation(),go(!1),te("select")},style:{display:"block",width:"100%",textAlign:"center",padding:"6px 10px",marginTop:"8px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#222"},children:"Cancel"})]}),n.jsxs("div",{style:{position:"absolute",top:6,left:60,bottom:6,width:168,padding:6,display:"flex",flexDirection:"column",gap:2,background:"rgba(250,250,255,0.95)",borderRadius:8,border:"1px solid #ddd",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:3},children:[n.jsx("div",{style:{fontSize:11,fontWeight:700,color:"#333",marginBottom:2},children:"Layers"}),n.jsxs("div",{onClick:()=>Dn("top"),title:"Top layer",style:{cursor:"pointer",padding:2,borderRadius:4,border:Mt==="top"?"2px solid #0b5fff":"1px solid #ddd",background:"#fff"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:2},children:[n.jsx("div",{style:{fontSize:10,color:"#444",fontWeight:600},children:"Top Image"}),n.jsx("label",{className:"radio-label",style:{margin:0},children:n.jsx("input",{type:"checkbox",checked:va,onChange:o=>_l(o.target.checked)})})]}),n.jsx("canvas",{ref:Qc,width:60,height:40,style:{width:"60px",height:"40px"}})]}),n.jsxs("div",{onClick:()=>Dn("bottom"),title:"Bottom layer",style:{cursor:"pointer",padding:2,borderRadius:4,border:Mt==="bottom"?"2px solid #0b5fff":"1px solid #ddd",background:"#fff"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:2},children:[n.jsx("div",{style:{fontSize:10,color:"#444",fontWeight:600},children:"Bottom Image"}),n.jsx("label",{className:"radio-label",style:{margin:0},children:n.jsx("input",{type:"checkbox",checked:Sa,onChange:o=>Hl(o.target.checked)})})]}),n.jsx("canvas",{ref:Mr,width:60,height:40,style:{width:"60px",height:"40px"}})]}),n.jsx("div",{style:{height:1,background:"#e9e9ef",margin:"2px 0"}}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:dn,onChange:o=>Ji(o.target.checked)}),n.jsx("span",{children:"Vias"})]}),n.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:jn,onChange:o=>Ni(o.target.checked)}),n.jsx("span",{children:"Pads (Top)"})]}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:ei,onChange:o=>Ja(o.target.checked)}),n.jsx("span",{children:"Test Points (Top)"})]}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:qn,onChange:o=>El(o.target.checked)}),n.jsx("span",{children:"Traces (Top)"})]}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:el,onChange:o=>vn(o.target.checked)}),n.jsx("span",{children:"Components (Top)"})]}),n.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:Nn,onChange:o=>ai(o.target.checked)}),n.jsx("span",{children:"Pads (Bottom)"})]}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:hl,onChange:o=>wa(o.target.checked)}),n.jsx("span",{children:"Test Points (Bottom)"})]}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:Jn,onChange:o=>Zn(o.target.checked)}),n.jsx("span",{children:"Traces (Bottom)"})]}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:Ut,onChange:o=>wt(o.target.checked)}),n.jsx("span",{children:"Components (Bottom)"})]}),n.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:si,onChange:o=>Kn(o.target.checked)}),n.jsx("span",{children:"Power"})]}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:Wl,onChange:o=>Oo(o.target.checked)}),n.jsx("span",{children:"Ground"})]}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:ja,onChange:o=>_o(o.target.checked)}),n.jsx("span",{children:"Connections"})]}),n.jsx("div",{style:{height:1,background:"#e9e9ef",margin:"2px 0"}}),n.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:dn&&jn&&Nn&&ei&&hl&&qn&&Jn&&el&&Ut&&si&&Wl&&ja,onChange:o=>{const r=o.target.checked;Ji(r),Ni(r),ai(r),Ja(r),wa(r),El(r),Zn(r),vn(r),wt(r),Kn(r),Oo(r),_o(r)}}),n.jsx("span",{style:{fontWeight:600,fontSize:11},children:"Select All Layers"})]}),n.jsxs("div",{style:{marginTop:6},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[n.jsxs("label",{style:{fontSize:10,color:"#333"},children:["Transparency: ",p,"%"]}),n.jsxs("label",{className:"radio-label",style:{margin:0},children:[n.jsx("input",{type:"checkbox",checked:de,onChange:o=>{const r=o.target.checked;r?(_l(!0),Hl(!0)):(V(50),te("select")),ge(r)}}),n.jsx("span",{style:{marginLeft:6,fontSize:10},children:"Cycle"})]})]}),n.jsx("input",{type:"range",min:"0",max:"100",value:p,onChange:o=>V(Number(o.target.value)),onDoubleClick:()=>Gu("transparency"),className:"slider",style:{width:"100%",marginTop:3}}),de&&n.jsxs("div",{style:{marginTop:6},children:[n.jsxs("label",{style:{fontSize:10,color:"#333"},children:["Cycle Speed: ",(Te/1e3).toFixed(1),"s"]}),n.jsx("input",{type:"range",min:"500",max:"8000",step:"100",value:8500-Te,onChange:o=>Ue(8500-Number(o.target.value)),onDoubleClick:()=>Ue(2e3),className:"slider",style:{width:"100%",marginTop:3}})]})]})]}),n.jsx(bx,{visible:!g&&!R}),n.jsx("canvas",{ref:On,width:Ka.width,height:Ka.height,tabIndex:0,onMouseDown:tu,onMouseMove:iu,onMouseUp:fd,onMouseLeave:fd,onWheel:dd,onDoubleClick:nu,className:`pcb-canvas ${B==="transform"?"transform-cursor":B==="draw"?"draw-cursor":B==="erase"?"erase-cursor":"default-cursor"}`,style:{position:"absolute",left:"244px",top:"6px",...Ea?{cursor:Ea}:B==="pan"?{cursor:ya?"grabbing":"grab"}:{},width:`${Ka.width}px`,height:`${Ka.height}px`,maxHeight:"none",aspectRatio:"auto",border:"none"}}),n.jsx(kx,{componentEditor:Fa,setComponentEditor:$a,componentsTop:Je,componentsBottom:dt,setComponentsTop:tn,setComponentsBottom:bn,connectingPin:An,setConnectingPin:na,componentDialogPosition:Gi,setComponentDialogPosition:qi,isDraggingDialog:jr,setIsDraggingDialog:Tr,dialogDragOffset:vs,setDialogDragOffset:Cr,areComponentsLocked:Hi,setSelectedComponentIds:gt,setNotesDialogVisible:Ho}),ba&&Do&&(()=>{const o=ba.component,r=ba.layer;if(!o)return null;const f=o.componentType||"Component",b=o.componentType==="IntegratedCircuit"&&"icType"in o?o.icType:null,y=an(o);return n.jsxs("div",{style:{position:"fixed",left:`${ba.x+10}px`,top:`${ba.y+10}px`,background:"rgba(0, 0, 0, 0.85)",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:"12px",lineHeight:"1.4",zIndex:1e4,pointerEvents:"none",width:"max-content",maxWidth:"400px",minWidth:"150px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)",wordWrap:"break-word",overflowWrap:"break-word"},children:[n.jsx("div",{style:{fontWeight:600,marginBottom:"4px"},children:Vd(f)}),n.jsxs("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:["Layer: ",r==="top"?"Top":"Bottom"]}),b&&n.jsxs("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:["IC Type: ",b]}),y.length>0&&n.jsx("div",{style:{marginBottom:"4px"},children:y.map((v,x)=>n.jsx("div",{style:{color:"#e0e0e0",fontSize:"11px",marginBottom:"2px"},children:v},x))}),o.description&&n.jsx("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:o.description}),o.notes&&n.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid rgba(255,255,255,0.2)",fontSize:"11px",color:"#d0d0d0",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:o.notes})]})})(),Bs&&Do&&(()=>{const o=Bs.stroke;return o.notes?n.jsxs("div",{style:{position:"fixed",left:`${Bs.x+10}px`,top:`${Bs.y+10}px`,background:"rgba(0, 0, 0, 0.85)",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:"12px",lineHeight:"1.4",zIndex:1e4,pointerEvents:"none",width:"max-content",maxWidth:"400px",minWidth:"150px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)",wordWrap:"break-word",overflowWrap:"break-word"},children:[n.jsx("div",{style:{fontWeight:600,marginBottom:"4px"},children:"Test Point"}),n.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid rgba(255,255,255,0.2)",fontSize:"11px",color:"#d0d0d0",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:o.notes})]}):null})(),bi&&bi.visible&&(()=>{if(!yt.find(f=>f.id===bi.id))return null;const r=Xe.find(f=>f.id===bi.powerBusId);return n.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#fff",border:"1px solid #0b5fff",borderRadius:4,padding:"6px",boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"175px",maxWidth:"250px",maxHeight:"40vh",overflowY:"auto",pointerEvents:"auto"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"5px"},children:[n.jsx("h3",{style:{margin:0,fontSize:"12px",color:"#333",fontWeight:600},children:"Power Properties"}),n.jsx("button",{onClick:()=>ia(null),style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#666",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Power Bus:"}),n.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:r?`${r.name} (${r.voltage})`:"Unknown"})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:`power-layer-${bi.id}`,style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Layer:"}),n.jsxs("select",{id:`power-layer-${bi.id}`,name:`power-layer-${bi.id}`,value:bi.layer,onChange:f=>ia({...bi,layer:f.target.value}),disabled:Rn,style:{width:"100%",padding:"2px 3px",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",opacity:Rn?.6:1},children:[n.jsx("option",{value:"top",children:"Top"}),n.jsx("option",{value:"bottom",children:"Bottom"})]})]}),n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"X:"}),n.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:bi.x.toFixed(2)})]}),n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Y:"}),n.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:bi.y.toFixed(2)})]})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"3px",marginTop:"6px"},children:[n.jsx("button",{onClick:()=>ia(null),style:{padding:"2px 5px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,cursor:"pointer",fontSize:"10px",color:"#333"},children:"Cancel"}),n.jsx("button",{onClick:()=>{Rn||(ni(f=>f.map(b=>b.id===bi.id?{...b,layer:bi.layer}:b)),ia(null))},disabled:Rn,style:{padding:"2px 5px",background:Rn?"#f5f5f5":"#0b5fff",color:Rn?"#999":"#fff",border:"1px solid #ddd",borderRadius:2,cursor:Rn?"not-allowed":"pointer",fontSize:"10px"},children:"Save"})]})]})})(),!g&&!R&&n.jsx("div",{className:"placeholder"})]})}),n.jsx(Rx,{visible:Zd,onClose:()=>Ps(!1),powerBuses:Xe,setPowerBuses:zi,editingPowerBusId:Os,setEditingPowerBusId:es,powers:yt}),n.jsx(Dx,{visible:rc,onClose:()=>Vl(!1),groundBuses:qt,setGroundBuses:Nl,editingGroundBusId:ri,setEditingGroundBusId:cc,grounds:st}),n.jsx(Ux,{visible:Br,projectDirHandle:on,onClose:()=>{_s(!1),No(void 0)},onRestore:Yn,position:Ao,isDragging:Mo,onDragStart:ui}),n.jsx(Ax,{visible:Jc,onClose:()=>Po(!1),autoAssignDesignators:Tn,setAutoAssignDesignators:ns,useGlobalDesignatorCounters:Uo,setUseGlobalDesignatorCounters:so}),n.jsx("input",{ref:Zc,type:"file",accept:".png,.jpg,.jpeg,image/png,image/jpeg",style:{display:"none"},onChange:o=>{const r=o.target.files?.[0];r&&cd(r,"top"),o.target.value=""}}),n.jsx("input",{ref:ga,type:"file",accept:".png,.jpg,.jpeg,image/png,image/jpeg",style:{display:"none"},onChange:o=>{const r=o.target.files?.[0];r&&cd(r,"bottom"),o.target.value=""}}),n.jsx("input",{ref:Ds,type:"file",accept:".json,application/json",style:{display:"none"},onChange:async o=>{const r=o.target.files?.[0];if(r)try{ln(r.name);const f=await r.text(),b=JSON.parse(f);await Pa(b);let y;b.projectInfo?.name?y=b.projectInfo.name:(y=r.name.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_")||"pcb_project",ul(y)),oi||ul(y),setTimeout(()=>{Di({visible:!0,source:"open",interval:5})},100)}catch(f){console.error("Failed to open project",f),alert("Failed to open project file. See console for details.")}o.target.value=""}}),n.jsx(vx,{visible:zs.visible,selectedIds:qe,selectedComponentIds:mt,selectedPowerIds:Et,selectedGroundIds:jt,drawingStrokes:_e,componentsTop:Je,componentsBottom:dt,powers:yt,grounds:st,powerBuses:Xe,onClose:()=>{sa({visible:!1,text:""})},setComponentsTop:tn,setComponentsBottom:bn,determineViaType:Ii,determinePadType:Vi,determineTestPointType:fo,onFindComponent:ml,onFindStroke:ka,onFindPower:ld,onFindGround:Jd,onOpenNotesDialog:()=>Ho(!0),position:Mi,isDragging:Ta,onDragStart:o=>{Mi&&(Pr({x:o.clientX-Mi.x,y:o.clientY-Mi.y}),uc(!0),o.preventDefault())}}),n.jsx(Sx,{visible:fc,selectedIds:qe,selectedComponentIds:mt,selectedPowerIds:Et,selectedGroundIds:jt,drawingStrokes:_e,componentsTop:Je,componentsBottom:dt,powers:yt,grounds:st,powerBuses:Xe,onClose:()=>{Ho(!1)},setComponentsTop:tn,setComponentsBottom:bn,setDrawingStrokes:Pt,setPowerSymbols:ni,setGroundSymbols:Qn,determineViaType:Ii,determinePadType:Vi,determineTestPointType:fo,position:yl,isDragging:pc,onDragStart:o=>{yl&&(Es({x:o.clientX-yl.x,y:o.clientY-yl.y}),ed(!0),o.preventDefault())}}),n.jsx(wx,{visible:Is,projectNotes:Ca,setProjectNotes:Io,onClose:()=>{Or(!1)},position:bl,isDragging:co,onDragStart:o=>{bl?(uo({x:o.clientX-bl.x,y:o.clientY-bl.y}),_r(!0),o.preventDefault()):(Vs({x:o.clientX-300,y:o.clientY-200}),uo({x:300,y:200}),_r(!0),o.preventDefault())}}),n.jsx(Mh,{visible:ic.visible,title:"New Project",message:"You have unsaved changes. Do you want to save your project before creating a new one?",onYes:zc,onNo:md,onCancel:fu,yesButtonRef:Qa}),n.jsx(Mh,{visible:ca.visible,title:"Open Project",message:"You have unsaved changes. Do you want to save your project before opening another one?",onYes:lr,onNo:pu,onCancel:qu,yesButtonRef:qd}),nn.visible&&n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10002},onClick:o=>{o.target===o.currentTarget&&Lo()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:o=>o.stopPropagation(),children:[n.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"New Project"}),n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Project Name:"}),n.jsx("input",{ref:Qi,type:"text",value:nn.projectName,onChange:o=>{Xa(r=>({...r,projectName:o.target.value}))},onKeyDown:o=>{o.key==="Enter"?(o.preventDefault(),yd()):o.key==="Escape"&&(o.preventDefault(),Lo())},style:{width:"100%",padding:"8px 12px",marginBottom:"8px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},placeholder:"e.g., my_pcb_project",autoFocus:!0}),nn.projectName&&(()=>{const o=nn.projectName.match(/[^a-zA-Z0-9_-]/g);if(o){const r=[...new Set(o)];return n.jsxs("div",{style:{marginBottom:"12px",padding:"6px 10px",background:"#3a1f1f",border:"1px solid #a44",borderRadius:4,fontSize:"12px",color:"#ffaaaa"},children:["Invalid characters: ",r.map(f=>`"${f}"`).join(", "),". Only letters, numbers, underscore (_), and hyphen (-) are allowed."]})}return null})(),n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Location:"}),n.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[n.jsx("input",{type:"text",value:nn.locationPath||"Not selected",readOnly:!0,style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:nn.locationPath?"#f2f2f2":"#888",fontSize:"14px",cursor:"not-allowed"},placeholder:"Select a location..."}),n.jsx("button",{onClick:cu,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500,whiteSpace:"nowrap"},children:"Browse..."})]}),nn.projectName&&nn.locationPath&&n.jsxs("div",{style:{marginBottom:"20px",padding:"8px 12px",background:"#1a1a1f",border:"1px solid #333",borderRadius:6,fontSize:"12px",color:"#aaa",fontFamily:"monospace"},children:[n.jsx("div",{style:{marginBottom:"4px",color:"#888"},children:"Project will be created at:"}),n.jsx("div",{style:{color:"#4CAF50"},children:(()=>{if(!nn.projectName||!nn.locationPath)return"";const r=nn.projectName.trim().replace(/[^a-zA-Z0-9_-]/g,"_")||"pcb_project",f=`${r}.json`;return nn.locationPath===r?`${nn.locationPath}/${f}`:`${nn.locationPath}/${r}/${f}`})()})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[n.jsx("button",{onClick:Lo,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),n.jsx("button",{onClick:yd,disabled:!nn.projectName.trim()||!nn.locationHandle,style:{padding:"8px 16px",background:!nn.projectName.trim()||!nn.locationHandle?"#555":"#4CAF50",color:"#fff",border:"1px solid "+(!nn.projectName.trim()||!nn.locationHandle?"#666":"#45a049"),borderRadius:6,cursor:!nn.projectName.trim()||!nn.locationHandle?"not-allowed":"pointer",fontSize:"14px",fontWeight:600,opacity:!nn.projectName.trim()||!nn.locationHandle?.6:1},children:"Create"})]})]})}),mn.visible&&n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10002},onClick:o=>{o.target===o.currentTarget&&tr()},children:n.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:o=>o.stopPropagation(),children:[n.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Save As"}),n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"File Name:"}),n.jsx("input",{ref:Us,type:"text",value:mn.filename,onChange:o=>{da(r=>({...r,filename:o.target.value}))},onKeyDown:o=>{o.key==="Enter"?(o.preventDefault(),bd()):o.key==="Escape"&&(o.preventDefault(),tr())},style:{width:"100%",padding:"8px 12px",marginBottom:"8px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},placeholder:"e.g., my_project.json",autoFocus:!0}),n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Location:"}),n.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[n.jsx("input",{type:"text",value:mn.locationPath||"Not selected",readOnly:!0,style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:mn.locationPath?"#f2f2f2":"#888",fontSize:"14px",cursor:"not-allowed"},placeholder:"Select a location..."}),n.jsx("button",{onClick:uu,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500,whiteSpace:"nowrap"},children:"Browse..."})]}),mn.filename&&mn.locationPath&&n.jsxs("div",{style:{marginBottom:"20px",padding:"8px 12px",background:"#1a1a1f",border:"1px solid #333",borderRadius:6,fontSize:"12px",color:"#aaa",fontFamily:"monospace"},children:[n.jsx("div",{style:{marginBottom:"4px",color:"#888"},children:"File will be saved at:"}),n.jsxs("div",{style:{color:"#4CAF50"},children:[mn.locationPath,"/",mn.filename.endsWith(".json")?mn.filename:`${mn.filename}.json`]})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[n.jsx("button",{onClick:tr,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),n.jsx("button",{onClick:bd,disabled:!mn.filename.trim()||!mn.locationHandle,style:{padding:"8px 16px",background:!mn.filename.trim()||!mn.locationHandle?"#555":"#4CAF50",color:"#fff",border:"1px solid "+(!mn.filename.trim()||!mn.locationHandle?"#666":"#45a049"),borderRadius:6,cursor:!mn.filename.trim()||!mn.locationHandle?"not-allowed":"pointer",fontSize:"14px",fontWeight:600,opacity:!mn.filename.trim()||!mn.locationHandle?.6:1},children:"Save"})]})]})}),n.jsx(mx,{visible:nc.visible,title:nc.title,message:nc.message,onClose:()=>Ya({visible:!1,title:"",message:""})}),n.jsx(jx,{visible:td,dimensions:za,onSave:o=>{ls(o)},onClose:()=>Fs(!1)}),n.jsx(Tx,{visible:Xu,onClose:()=>Rs(!1),topImage:g,bottomImage:R,selectedImageForTransform:Mt,setSelectedImageForTransform:Ti,transformMode:al,setTransformMode:to,updateImageTransform:Da,resetImageTransform:pd,setCurrentTool:te,isGrayscale:se,setIsGrayscale:Re,areImagesLocked:Ri}),n.jsx(Nx,{visible:ec.visible,size:ec.size,onSizeChange:o=>tc(r=>({...r,size:o})),onApply:ou,onCancel:()=>tc({visible:!1,size:6})}),n.jsx(Mx,{visible:qc.visible,interval:qc.interval,onIntervalChange:o=>aa({visible:!0,interval:o}),onApply:()=>au(qc.interval,!1),onCancel:()=>aa({visible:!1,interval:5})}),n.jsx(Bx,{visible:Cs.visible,interval:Cs.interval,onIntervalChange:o=>Di({...Cs,interval:o}),onEnable:()=>au(Cs.interval,!0),onSkip:hd}),n.jsx("div",{style:{position:"fixed",bottom:8,right:8,zIndex:100},children:n.jsxs("button",{onClick:()=>{window.open("https://github.com/sponsors/pgiacalo","_blank","noopener,noreferrer")},style:{display:"flex",alignItems:"center",gap:6,padding:"6px 12px",background:"linear-gradient(180deg, #f6f8fa 0%, #ebecef 100%)",border:"1px solid rgba(27, 31, 36, 0.15)",borderRadius:6,cursor:"pointer",fontSize:12,fontWeight:500,color:"#24292f",boxShadow:"0 1px 0 rgba(27, 31, 36, 0.04)",transition:"background 0.2s"},onMouseEnter:o=>{o.currentTarget.style.background="linear-gradient(180deg, #f3f4f6 0%, #e5e6e9 100%)"},onMouseLeave:o=>{o.currentTarget.style.background="linear-gradient(180deg, #f6f8fa 0%, #ebecef 100%)"},title:"Donate to support this project",children:[n.jsx("svg",{height:"16",width:"16",viewBox:"0 0 16 16",fill:"#bf3989","aria-hidden":"true",children:n.jsx("path",{d:"M4.25 2.5c-1.336 0-2.75 1.164-2.75 3 0 2.15 1.58 4.144 3.365 5.682A20.565 20.565 0 008 13.393a20.561 20.561 0 003.135-2.211C12.92 9.644 14.5 7.65 14.5 5.5c0-1.836-1.414-3-2.75-3-1.373 0-2.609.986-3.029 2.456a.749.749 0 01-1.442 0C6.859 3.486 5.623 2.5 4.25 2.5z"})}),"Donate"]})})]})}$g.createRoot(document.getElementById("root")).render(n.jsx(m.StrictMode,{children:n.jsx(Zx,{})}));

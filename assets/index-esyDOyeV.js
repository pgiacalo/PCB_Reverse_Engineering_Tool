(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const d of l)if(d.type==="childList")for(const b of d.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&s(b)}).observe(document,{childList:!0,subtree:!0});function o(l){const d={};return l.integrity&&(d.integrity=l.integrity),l.referrerPolicy&&(d.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?d.credentials="include":l.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function s(l){if(l.ep)return;l.ep=!0;const d=o(l);fetch(l.href,d)}})();var Zw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qm(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var ag={exports:{}},Hf={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g1;function e2(){if(g1)return Hf;g1=1;var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function o(s,l,d){var b=null;if(d!==void 0&&(b=""+d),l.key!==void 0&&(b=""+l.key),"key"in l){d={};for(var p in l)p!=="key"&&(d[p]=l[p])}else d=l;return l=d.ref,{$$typeof:n,type:s,key:b,ref:l!==void 0?l:null,props:d}}return Hf.Fragment=r,Hf.jsx=o,Hf.jsxs=o,Hf}var y1;function t2(){return y1||(y1=1,ag.exports=e2()),ag.exports}var i=t2(),sg={exports:{}},xi={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var x1;function n2(){if(x1)return xi;x1=1;var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),d=Symbol.for("react.consumer"),b=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),v=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),M=Symbol.iterator;function S(k){return k===null||typeof k!="object"?null:(k=M&&k[M]||k["@@iterator"],typeof k=="function"?k:null)}var U={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,N={};function g(k,A,q){this.props=k,this.context=A,this.refs=N,this.updater=q||U}g.prototype.isReactComponent={},g.prototype.setState=function(k,A){if(typeof k!="object"&&typeof k!="function"&&k!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,k,A,"setState")},g.prototype.forceUpdate=function(k){this.updater.enqueueForceUpdate(this,k,"forceUpdate")};function ae(){}ae.prototype=g.prototype;function V(k,A,q){this.props=k,this.context=A,this.refs=N,this.updater=q||U}var E=V.prototype=new ae;E.constructor=V,_(E,g.prototype),E.isPureReactComponent=!0;var re=Array.isArray;function J(){}var G={H:null,A:null,T:null,S:null},ee=Object.prototype.hasOwnProperty;function F(k,A,q){var W=q.ref;return{$$typeof:n,type:k,key:A,ref:W!==void 0?W:null,props:q}}function $(k,A){return F(k.type,A,k.props)}function H(k){return typeof k=="object"&&k!==null&&k.$$typeof===n}function R(k){var A={"=":"=0",":":"=2"};return"$"+k.replace(/[=:]/g,function(q){return A[q]})}var Z=/\/+/g;function Y(k,A){return typeof k=="object"&&k!==null&&k.key!=null?R(""+k.key):A.toString(36)}function we(k){switch(k.status){case"fulfilled":return k.value;case"rejected":throw k.reason;default:switch(typeof k.status=="string"?k.then(J,J):(k.status="pending",k.then(function(A){k.status==="pending"&&(k.status="fulfilled",k.value=A)},function(A){k.status==="pending"&&(k.status="rejected",k.reason=A)})),k.status){case"fulfilled":return k.value;case"rejected":throw k.reason}}throw k}function te(k,A,q,W,se){var Ce=typeof k;(Ce==="undefined"||Ce==="boolean")&&(k=null);var le=!1;if(k===null)le=!0;else switch(Ce){case"bigint":case"string":case"number":le=!0;break;case"object":switch(k.$$typeof){case n:case r:le=!0;break;case C:return le=k._init,te(le(k._payload),A,q,W,se)}}if(le)return se=se(k),le=W===""?"."+Y(k,0):W,re(se)?(q="",le!=null&&(q=le.replace(Z,"$&/")+"/"),te(se,A,q,"",function(De){return De})):se!=null&&(H(se)&&(se=$(se,q+(se.key==null||k&&k.key===se.key?"":(""+se.key).replace(Z,"$&/")+"/")+le)),A.push(se)),1;le=0;var _e=W===""?".":W+":";if(re(k))for(var be=0;be<k.length;be++)W=k[be],Ce=_e+Y(W,be),le+=te(W,A,q,Ce,se);else if(be=S(k),typeof be=="function")for(k=be.call(k),be=0;!(W=k.next()).done;)W=W.value,Ce=_e+Y(W,be++),le+=te(W,A,q,Ce,se);else if(Ce==="object"){if(typeof k.then=="function")return te(we(k),A,q,W,se);throw A=String(k),Error("Objects are not valid as a React child (found: "+(A==="[object Object]"?"object with keys {"+Object.keys(k).join(", ")+"}":A)+"). If you meant to render a collection of children, use an array instead.")}return le}function de(k,A,q){if(k==null)return k;var W=[],se=0;return te(k,W,"","",function(Ce){return A.call(q,Ce,se++)}),W}function je(k){if(k._status===-1){var A=k._result;A=A(),A.then(function(q){(k._status===0||k._status===-1)&&(k._status=1,k._result=q)},function(q){(k._status===0||k._status===-1)&&(k._status=2,k._result=q)}),k._status===-1&&(k._status=0,k._result=A)}if(k._status===1)return k._result.default;throw k._result}var Ie=typeof reportError=="function"?reportError:function(k){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var A=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof k=="object"&&k!==null&&typeof k.message=="string"?String(k.message):String(k),error:k});if(!window.dispatchEvent(A))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",k);return}console.error(k)},xe={map:de,forEach:function(k,A,q){de(k,function(){A.apply(this,arguments)},q)},count:function(k){var A=0;return de(k,function(){A++}),A},toArray:function(k){return de(k,function(A){return A})||[]},only:function(k){if(!H(k))throw Error("React.Children.only expected to receive a single React element child.");return k}};return xi.Activity=D,xi.Children=xe,xi.Component=g,xi.Fragment=o,xi.Profiler=l,xi.PureComponent=V,xi.StrictMode=s,xi.Suspense=v,xi.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=G,xi.__COMPILER_RUNTIME={__proto__:null,c:function(k){return G.H.useMemoCache(k)}},xi.cache=function(k){return function(){return k.apply(null,arguments)}},xi.cacheSignal=function(){return null},xi.cloneElement=function(k,A,q){if(k==null)throw Error("The argument must be a React element, but you passed "+k+".");var W=_({},k.props),se=k.key;if(A!=null)for(Ce in A.key!==void 0&&(se=""+A.key),A)!ee.call(A,Ce)||Ce==="key"||Ce==="__self"||Ce==="__source"||Ce==="ref"&&A.ref===void 0||(W[Ce]=A[Ce]);var Ce=arguments.length-2;if(Ce===1)W.children=q;else if(1<Ce){for(var le=Array(Ce),_e=0;_e<Ce;_e++)le[_e]=arguments[_e+2];W.children=le}return F(k.type,se,W)},xi.createContext=function(k){return k={$$typeof:b,_currentValue:k,_currentValue2:k,_threadCount:0,Provider:null,Consumer:null},k.Provider=k,k.Consumer={$$typeof:d,_context:k},k},xi.createElement=function(k,A,q){var W,se={},Ce=null;if(A!=null)for(W in A.key!==void 0&&(Ce=""+A.key),A)ee.call(A,W)&&W!=="key"&&W!=="__self"&&W!=="__source"&&(se[W]=A[W]);var le=arguments.length-2;if(le===1)se.children=q;else if(1<le){for(var _e=Array(le),be=0;be<le;be++)_e[be]=arguments[be+2];se.children=_e}if(k&&k.defaultProps)for(W in le=k.defaultProps,le)se[W]===void 0&&(se[W]=le[W]);return F(k,Ce,se)},xi.createRef=function(){return{current:null}},xi.forwardRef=function(k){return{$$typeof:p,render:k}},xi.isValidElement=H,xi.lazy=function(k){return{$$typeof:C,_payload:{_status:-1,_result:k},_init:je}},xi.memo=function(k,A){return{$$typeof:m,type:k,compare:A===void 0?null:A}},xi.startTransition=function(k){var A=G.T,q={};G.T=q;try{var W=k(),se=G.S;se!==null&&se(q,W),typeof W=="object"&&W!==null&&typeof W.then=="function"&&W.then(J,Ie)}catch(Ce){Ie(Ce)}finally{A!==null&&q.types!==null&&(A.types=q.types),G.T=A}},xi.unstable_useCacheRefresh=function(){return G.H.useCacheRefresh()},xi.use=function(k){return G.H.use(k)},xi.useActionState=function(k,A,q){return G.H.useActionState(k,A,q)},xi.useCallback=function(k,A){return G.H.useCallback(k,A)},xi.useContext=function(k){return G.H.useContext(k)},xi.useDebugValue=function(){},xi.useDeferredValue=function(k,A){return G.H.useDeferredValue(k,A)},xi.useEffect=function(k,A){return G.H.useEffect(k,A)},xi.useEffectEvent=function(k){return G.H.useEffectEvent(k)},xi.useId=function(){return G.H.useId()},xi.useImperativeHandle=function(k,A,q){return G.H.useImperativeHandle(k,A,q)},xi.useInsertionEffect=function(k,A){return G.H.useInsertionEffect(k,A)},xi.useLayoutEffect=function(k,A){return G.H.useLayoutEffect(k,A)},xi.useMemo=function(k,A){return G.H.useMemo(k,A)},xi.useOptimistic=function(k,A){return G.H.useOptimistic(k,A)},xi.useReducer=function(k,A,q){return G.H.useReducer(k,A,q)},xi.useRef=function(k){return G.H.useRef(k)},xi.useState=function(k){return G.H.useState(k)},xi.useSyncExternalStore=function(k,A,q){return G.H.useSyncExternalStore(k,A,q)},xi.useTransition=function(){return G.H.useTransition()},xi.version="19.2.0",xi}var m1;function o0(){return m1||(m1=1,sg.exports=n2()),sg.exports}var L=o0();const Pt=Qm(L);var lg={exports:{}},Wf={},cg={exports:{}},ug={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b1;function i2(){return b1||(b1=1,(function(n){function r(te,de){var je=te.length;te.push(de);e:for(;0<je;){var Ie=je-1>>>1,xe=te[Ie];if(0<l(xe,de))te[Ie]=de,te[je]=xe,je=Ie;else break e}}function o(te){return te.length===0?null:te[0]}function s(te){if(te.length===0)return null;var de=te[0],je=te.pop();if(je!==de){te[0]=je;e:for(var Ie=0,xe=te.length,k=xe>>>1;Ie<k;){var A=2*(Ie+1)-1,q=te[A],W=A+1,se=te[W];if(0>l(q,je))W<xe&&0>l(se,q)?(te[Ie]=se,te[W]=je,Ie=W):(te[Ie]=q,te[A]=je,Ie=A);else if(W<xe&&0>l(se,je))te[Ie]=se,te[W]=je,Ie=W;else break e}}return de}function l(te,de){var je=te.sortIndex-de.sortIndex;return je!==0?je:te.id-de.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var d=performance;n.unstable_now=function(){return d.now()}}else{var b=Date,p=b.now();n.unstable_now=function(){return b.now()-p}}var v=[],m=[],C=1,D=null,M=3,S=!1,U=!1,_=!1,N=!1,g=typeof setTimeout=="function"?setTimeout:null,ae=typeof clearTimeout=="function"?clearTimeout:null,V=typeof setImmediate<"u"?setImmediate:null;function E(te){for(var de=o(m);de!==null;){if(de.callback===null)s(m);else if(de.startTime<=te)s(m),de.sortIndex=de.expirationTime,r(v,de);else break;de=o(m)}}function re(te){if(_=!1,E(te),!U)if(o(v)!==null)U=!0,J||(J=!0,R());else{var de=o(m);de!==null&&we(re,de.startTime-te)}}var J=!1,G=-1,ee=5,F=-1;function $(){return N?!0:!(n.unstable_now()-F<ee)}function H(){if(N=!1,J){var te=n.unstable_now();F=te;var de=!0;try{e:{U=!1,_&&(_=!1,ae(G),G=-1),S=!0;var je=M;try{t:{for(E(te),D=o(v);D!==null&&!(D.expirationTime>te&&$());){var Ie=D.callback;if(typeof Ie=="function"){D.callback=null,M=D.priorityLevel;var xe=Ie(D.expirationTime<=te);if(te=n.unstable_now(),typeof xe=="function"){D.callback=xe,E(te),de=!0;break t}D===o(v)&&s(v),E(te)}else s(v);D=o(v)}if(D!==null)de=!0;else{var k=o(m);k!==null&&we(re,k.startTime-te),de=!1}}break e}finally{D=null,M=je,S=!1}de=void 0}}finally{de?R():J=!1}}}var R;if(typeof V=="function")R=function(){V(H)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,Y=Z.port2;Z.port1.onmessage=H,R=function(){Y.postMessage(null)}}else R=function(){g(H,0)};function we(te,de){G=g(function(){te(n.unstable_now())},de)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(te){te.callback=null},n.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ee=0<te?Math.floor(1e3/te):5},n.unstable_getCurrentPriorityLevel=function(){return M},n.unstable_next=function(te){switch(M){case 1:case 2:case 3:var de=3;break;default:de=M}var je=M;M=de;try{return te()}finally{M=je}},n.unstable_requestPaint=function(){N=!0},n.unstable_runWithPriority=function(te,de){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var je=M;M=te;try{return de()}finally{M=je}},n.unstable_scheduleCallback=function(te,de,je){var Ie=n.unstable_now();switch(typeof je=="object"&&je!==null?(je=je.delay,je=typeof je=="number"&&0<je?Ie+je:Ie):je=Ie,te){case 1:var xe=-1;break;case 2:xe=250;break;case 5:xe=1073741823;break;case 4:xe=1e4;break;default:xe=5e3}return xe=je+xe,te={id:C++,callback:de,priorityLevel:te,startTime:je,expirationTime:xe,sortIndex:-1},je>Ie?(te.sortIndex=je,r(m,te),o(v)===null&&te===o(m)&&(_?(ae(G),G=-1):_=!0,we(re,je-Ie))):(te.sortIndex=xe,r(v,te),U||S||(U=!0,J||(J=!0,R()))),te},n.unstable_shouldYield=$,n.unstable_wrapCallback=function(te){var de=M;return function(){var je=M;M=de;try{return te.apply(this,arguments)}finally{M=je}}}})(ug)),ug}var v1;function r2(){return v1||(v1=1,cg.exports=i2()),cg.exports}var dg={exports:{}},qs={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w1;function o2(){if(w1)return qs;w1=1;var n=o0();function r(v){var m="https://react.dev/errors/"+v;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var C=2;C<arguments.length;C++)m+="&args[]="+encodeURIComponent(arguments[C])}return"Minified React error #"+v+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(){}var s={d:{f:o,r:function(){throw Error(r(522))},D:o,C:o,L:o,m:o,X:o,S:o,M:o},p:0,findDOMNode:null},l=Symbol.for("react.portal");function d(v,m,C){var D=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:D==null?null:""+D,children:v,containerInfo:m,implementation:C}}var b=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(v,m){if(v==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return qs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,qs.createPortal=function(v,m){var C=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(r(299));return d(v,m,null,C)},qs.flushSync=function(v){var m=b.T,C=s.p;try{if(b.T=null,s.p=2,v)return v()}finally{b.T=m,s.p=C,s.d.f()}},qs.preconnect=function(v,m){typeof v=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,s.d.C(v,m))},qs.prefetchDNS=function(v){typeof v=="string"&&s.d.D(v)},qs.preinit=function(v,m){if(typeof v=="string"&&m&&typeof m.as=="string"){var C=m.as,D=p(C,m.crossOrigin),M=typeof m.integrity=="string"?m.integrity:void 0,S=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;C==="style"?s.d.S(v,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:D,integrity:M,fetchPriority:S}):C==="script"&&s.d.X(v,{crossOrigin:D,integrity:M,fetchPriority:S,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},qs.preinitModule=function(v,m){if(typeof v=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var C=p(m.as,m.crossOrigin);s.d.M(v,{crossOrigin:C,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&s.d.M(v)},qs.preload=function(v,m){if(typeof v=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var C=m.as,D=p(C,m.crossOrigin);s.d.L(v,C,{crossOrigin:D,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},qs.preloadModule=function(v,m){if(typeof v=="string")if(m){var C=p(m.as,m.crossOrigin);s.d.m(v,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:C,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else s.d.m(v)},qs.requestFormReset=function(v){s.d.r(v)},qs.unstable_batchedUpdates=function(v,m){return v(m)},qs.useFormState=function(v,m,C){return b.H.useFormState(v,m,C)},qs.useFormStatus=function(){return b.H.useHostTransitionStatus()},qs.version="19.2.0",qs}var S1;function a2(){if(S1)return dg.exports;S1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(r){console.error(r)}}return n(),dg.exports=o2(),dg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T1;function s2(){if(T1)return Wf;T1=1;var n=r2(),r=o0(),o=a2();function s(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function d(e){var t=e,a=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(a=t.return),e=t.return;while(e)}return t.tag===3?a:null}function b(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function v(e){if(d(e)!==e)throw Error(s(188))}function m(e){var t=e.alternate;if(!t){if(t=d(e),t===null)throw Error(s(188));return t!==e?null:e}for(var a=e,u=t;;){var h=a.return;if(h===null)break;var w=h.alternate;if(w===null){if(u=h.return,u!==null){a=u;continue}break}if(h.child===w.child){for(w=h.child;w;){if(w===a)return v(h),e;if(w===u)return v(h),t;w=w.sibling}throw Error(s(188))}if(a.return!==u.return)a=h,u=w;else{for(var O=!1,ue=h.child;ue;){if(ue===a){O=!0,a=h,u=w;break}if(ue===u){O=!0,u=h,a=w;break}ue=ue.sibling}if(!O){for(ue=w.child;ue;){if(ue===a){O=!0,a=w,u=h;break}if(ue===u){O=!0,u=w,a=h;break}ue=ue.sibling}if(!O)throw Error(s(189))}}if(a.alternate!==u)throw Error(s(190))}if(a.tag!==3)throw Error(s(188));return a.stateNode.current===a?e:t}function C(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=C(e),t!==null)return t;e=e.sibling}return null}var D=Object.assign,M=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),U=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),ae=Symbol.for("react.consumer"),V=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),re=Symbol.for("react.suspense"),J=Symbol.for("react.suspense_list"),G=Symbol.for("react.memo"),ee=Symbol.for("react.lazy"),F=Symbol.for("react.activity"),$=Symbol.for("react.memo_cache_sentinel"),H=Symbol.iterator;function R(e){return e===null||typeof e!="object"?null:(e=H&&e[H]||e["@@iterator"],typeof e=="function"?e:null)}var Z=Symbol.for("react.client.reference");function Y(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===Z?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case _:return"Fragment";case g:return"Profiler";case N:return"StrictMode";case re:return"Suspense";case J:return"SuspenseList";case F:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case U:return"Portal";case V:return e.displayName||"Context";case ae:return(e._context.displayName||"Context")+".Consumer";case E:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case G:return t=e.displayName||null,t!==null?t:Y(e.type)||"Memo";case ee:t=e._payload,e=e._init;try{return Y(e(t))}catch{}}return null}var we=Array.isArray,te=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,de=o.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,je={pending:!1,data:null,method:null,action:null},Ie=[],xe=-1;function k(e){return{current:e}}function A(e){0>xe||(e.current=Ie[xe],Ie[xe]=null,xe--)}function q(e,t){xe++,Ie[xe]=e.current,e.current=t}var W=k(null),se=k(null),Ce=k(null),le=k(null);function _e(e,t){switch(q(Ce,t),q(se,e),q(W,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?O0(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=O0(t),e=F0(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}A(W),q(W,e)}function be(){A(W),A(se),A(Ce)}function De(e){e.memoizedState!==null&&q(le,e);var t=W.current,a=F0(t,e.type);t!==a&&(q(se,e),q(W,a))}function Ge(e){se.current===e&&(A(W),A(se)),le.current===e&&(A(le),Uf._currentValue=je)}var ot,jt;function Ht(e){if(ot===void 0)try{throw Error()}catch(a){var t=a.stack.trim().match(/\n( *(at )?)/);ot=t&&t[1]||"",jt=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ot+e+jt}var ge=!1;function lt(e,t){if(!e||ge)return"";ge=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(t){var _t=function(){throw Error()};if(Object.defineProperty(_t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_t,[])}catch(ut){var rt=ut}Reflect.construct(e,[],_t)}else{try{_t.call()}catch(ut){rt=ut}e.call(_t.prototype)}}else{try{throw Error()}catch(ut){rt=ut}(_t=e())&&typeof _t.catch=="function"&&_t.catch(function(){})}}catch(ut){if(ut&&rt&&typeof ut.stack=="string")return[ut.stack,rt.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var h=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");h&&h.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=u.DetermineComponentFrameRoot(),O=w[0],ue=w[1];if(O&&ue){var Ue=O.split(`
`),it=ue.split(`
`);for(h=u=0;u<Ue.length&&!Ue[u].includes("DetermineComponentFrameRoot");)u++;for(;h<it.length&&!it[h].includes("DetermineComponentFrameRoot");)h++;if(u===Ue.length||h===it.length)for(u=Ue.length-1,h=it.length-1;1<=u&&0<=h&&Ue[u]!==it[h];)h--;for(;1<=u&&0<=h;u--,h--)if(Ue[u]!==it[h]){if(u!==1||h!==1)do if(u--,h--,0>h||Ue[u]!==it[h]){var St=`
`+Ue[u].replace(" at new "," at ");return e.displayName&&St.includes("<anonymous>")&&(St=St.replace("<anonymous>",e.displayName)),St}while(1<=u&&0<=h);break}}}finally{ge=!1,Error.prepareStackTrace=a}return(a=e?e.displayName||e.name:"")?Ht(a):""}function Yt(e,t){switch(e.tag){case 26:case 27:case 5:return Ht(e.type);case 16:return Ht("Lazy");case 13:return e.child!==t&&t!==null?Ht("Suspense Fallback"):Ht("Suspense");case 19:return Ht("SuspenseList");case 0:case 15:return lt(e.type,!1);case 11:return lt(e.type.render,!1);case 1:return lt(e.type,!0);case 31:return Ht("Activity");default:return""}}function Gt(e){try{var t="",a=null;do t+=Yt(e,a),a=e,e=e.return;while(e);return t}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var xt=Object.prototype.hasOwnProperty,hn=n.unstable_scheduleCallback,Et=n.unstable_cancelCallback,gn=n.unstable_shouldYield,Zt=n.unstable_requestPaint,xn=n.unstable_now,tt=n.unstable_getCurrentPriorityLevel,Rn=n.unstable_ImmediatePriority,Lt=n.unstable_UserBlockingPriority,Wt=n.unstable_NormalPriority,vn=n.unstable_LowPriority,ct=n.unstable_IdlePriority,ye=n.log,ze=n.unstable_setDisableYieldValue,Nt=null,Ke=null;function vt(e){if(typeof ye=="function"&&ze(e),Ke&&typeof Ke.setStrictMode=="function")try{Ke.setStrictMode(Nt,e)}catch{}}var Vt=Math.clz32?Math.clz32:Ft,ht=Math.log,Je=Math.LN2;function Ft(e){return e>>>=0,e===0?32:31-(ht(e)/Je|0)|0}var At=256,Jt=262144,An=4194304;function dn(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function ti(e,t,a){var u=e.pendingLanes;if(u===0)return 0;var h=0,w=e.suspendedLanes,O=e.pingedLanes;e=e.warmLanes;var ue=u&134217727;return ue!==0?(u=ue&~w,u!==0?h=dn(u):(O&=ue,O!==0?h=dn(O):a||(a=ue&~e,a!==0&&(h=dn(a))))):(ue=u&~w,ue!==0?h=dn(ue):O!==0?h=dn(O):a||(a=u&~e,a!==0&&(h=dn(a)))),h===0?0:t!==0&&t!==h&&(t&w)===0&&(w=h&-h,a=t&-t,w>=a||w===32&&(a&4194048)!==0)?t:h}function Tr(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function en(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zi(){var e=An;return An<<=1,(An&62914560)===0&&(An=4194304),e}function Mr(e){for(var t=[],a=0;31>a;a++)t.push(e);return t}function qt(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Zi(e,t,a,u,h,w){var O=e.pendingLanes;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=a,e.entangledLanes&=a,e.errorRecoveryDisabledLanes&=a,e.shellSuspendCounter=0;var ue=e.entanglements,Ue=e.expirationTimes,it=e.hiddenUpdates;for(a=O&~a;0<a;){var St=31-Vt(a),_t=1<<St;ue[St]=0,Ue[St]=-1;var rt=it[St];if(rt!==null)for(it[St]=null,St=0;St<rt.length;St++){var ut=rt[St];ut!==null&&(ut.lane&=-536870913)}a&=~_t}u!==0&&Ji(e,u,0),w!==0&&h===0&&e.tag!==0&&(e.suspendedLanes|=w&~(O&~t))}function Ji(e,t,a){e.pendingLanes|=t,e.suspendedLanes&=~t;var u=31-Vt(t);e.entangledLanes|=t,e.entanglements[u]=e.entanglements[u]|1073741824|a&261930}function Cr(e,t){var a=e.entangledLanes|=t;for(e=e.entanglements;a;){var u=31-Vt(a),h=1<<u;h&t|e[u]&t&&(e[u]|=t),a&=~h}}function jr(e,t){var a=t&-t;return a=(a&42)!==0?1:hi(a),(a&(e.suspendedLanes|t))!==0?0:a}function hi(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function wt(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Wn(){var e=de.p;return e!==0?e:(e=window.event,e===void 0?32:l1(e.type))}function mn(e,t){var a=de.p;try{return de.p=e,t()}finally{de.p=a}}var Ot=Math.random().toString(36).slice(2),Dt="__reactFiber$"+Ot,an="__reactProps$"+Ot,rn="__reactContainer$"+Ot,bn="__reactEvents$"+Ot,ni="__reactListeners$"+Ot,hr="__reactHandles$"+Ot,Di="__reactResources$"+Ot,qi="__reactMarker$"+Ot;function Br(e){delete e[Dt],delete e[an],delete e[bn],delete e[ni],delete e[hr]}function _i(e){var t=e[Dt];if(t)return t;for(var a=e.parentNode;a;){if(t=a[rn]||a[Dt]){if(a=t.alternate,t.child!==null||a!==null&&a.child!==null)for(e=$0(e);e!==null;){if(a=e[Dt])return a;e=$0(e)}return t}e=a,a=e.parentNode}return null}function ar(e){if(e=e[Dt]||e[rn]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function ui(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(s(33))}function zo(e){var t=e[Di];return t||(t=e[Di]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Hn(e){e[qi]=!0}var ys=new Set,di={};function Wo(e,t){Ri(e,t),Ri(e+"Capture",t)}function Ri(e,t){for(di[e]=t,e=0;e<t.length;e++)ys.add(t[e])}var Ds=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ts={},ns={};function xs(e){return xt.call(ns,e)?!0:xt.call(ts,e)?!1:Ds.test(e)?ns[e]=!0:(ts[e]=!0,!1)}function Or(e,t,a){if(xs(t))if(a===null)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var u=t.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+a)}}function Xs(e,t,a){if(a===null)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+a)}}function Nr(e,t,a,u){if(u===null)e.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(a);return}e.setAttributeNS(t,a,""+u)}}function Mi(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function fi(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function gr(e,t,a){var u=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var h=u.get,w=u.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return h.call(this)},set:function(O){a=""+O,w.call(this,O)}}),Object.defineProperty(e,t,{enumerable:u.enumerable}),{getValue:function(){return a},setValue:function(O){a=""+O},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function is(e){if(!e._valueTracker){var t=fi(e)?"checked":"value";e._valueTracker=gr(e,t,""+e[t])}}function Xl(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var a=t.getValue(),u="";return e&&(u=fi(e)?e.checked?"true":"false":e.value),e=u,e!==a?(t.setValue(e),!0):!1}function bo(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var co=/[\n"\\]/g;function Hi(e){return e.replace(co,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function Qo(e,t,a,u,h,w,O,ue){e.name="",O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?e.type=O:e.removeAttribute("type"),t!=null?O==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Mi(t)):e.value!==""+Mi(t)&&(e.value=""+Mi(t)):O!=="submit"&&O!=="reset"||e.removeAttribute("value"),t!=null?ha(e,O,Mi(t)):a!=null?ha(e,O,Mi(a)):u!=null&&e.removeAttribute("value"),h==null&&w!=null&&(e.defaultChecked=!!w),h!=null&&(e.checked=h&&typeof h!="function"&&typeof h!="symbol"),ue!=null&&typeof ue!="function"&&typeof ue!="symbol"&&typeof ue!="boolean"?e.name=""+Mi(ue):e.removeAttribute("name")}function Kl(e,t,a,u,h,w,O,ue){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(e.type=w),t!=null||a!=null){if(!(w!=="submit"&&w!=="reset"||t!=null)){is(e);return}a=a!=null?""+Mi(a):"",t=t!=null?""+Mi(t):a,ue||t===e.value||(e.value=t),e.defaultValue=t}u=u??h,u=typeof u!="function"&&typeof u!="symbol"&&!!u,e.checked=ue?e.checked:!!u,e.defaultChecked=!!u,O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"&&(e.name=O),is(e)}function ha(e,t,a){t==="number"&&bo(e.ownerDocument)===e||e.defaultValue===""+a||(e.defaultValue=""+a)}function yr(e,t,a,u){if(e=e.options,t){t={};for(var h=0;h<a.length;h++)t["$"+a[h]]=!0;for(a=0;a<e.length;a++)h=t.hasOwnProperty("$"+e[a].value),e[a].selected!==h&&(e[a].selected=h),h&&u&&(e[a].defaultSelected=!0)}else{for(a=""+Mi(a),t=null,h=0;h<e.length;h++){if(e[h].value===a){e[h].selected=!0,u&&(e[h].defaultSelected=!0);return}t!==null||e[h].disabled||(t=e[h])}t!==null&&(t.selected=!0)}}function Zl(e,t,a){if(t!=null&&(t=""+Mi(t),t!==e.value&&(e.value=t),a==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=a!=null?""+Mi(a):""}function Hr(e,t,a,u){if(t==null){if(u!=null){if(a!=null)throw Error(s(92));if(we(u)){if(1<u.length)throw Error(s(93));u=u[0]}a=u}a==null&&(a=""),t=a}a=Mi(t),e.defaultValue=a,u=e.textContent,u===a&&u!==""&&u!==null&&(e.value=u),is(e)}function ji(e,t){if(t){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=t;return}}e.textContent=t}var al=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Fa(e,t,a){var u=t.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?u?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":u?e.setProperty(t,a):typeof a!="number"||a===0||al.has(t)?t==="float"?e.cssFloat=a:e[t]=(""+a).trim():e[t]=a+"px"}function $o(e,t,a){if(t!=null&&typeof t!="object")throw Error(s(62));if(e=e.style,a!=null){for(var u in a)!a.hasOwnProperty(u)||t!=null&&t.hasOwnProperty(u)||(u.indexOf("--")===0?e.setProperty(u,""):u==="float"?e.cssFloat="":e[u]="");for(var h in t)u=t[h],t.hasOwnProperty(h)&&a[h]!==u&&Fa(e,h,u)}else for(var w in t)t.hasOwnProperty(w)&&Fa(e,w,t[w])}function ms(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var za=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ea=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Jr(e){return ea.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function xr(){}var bs=null;function Ua(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ks=null,Pn=null;function Tt(e){var t=ar(e);if(t&&(e=t.stateNode)){var a=e[an]||null;e:switch(e=t.stateNode,t.type){case"input":if(Qo(e,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),t=a.name,a.type==="radio"&&t!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+Hi(""+t)+'"][type="radio"]'),t=0;t<a.length;t++){var u=a[t];if(u!==e&&u.form===e.form){var h=u[an]||null;if(!h)throw Error(s(90));Qo(u,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name)}}for(t=0;t<a.length;t++)u=a[t],u.form===e.form&&Xl(u)}break e;case"textarea":Zl(e,a.value,a.defaultValue);break e;case"select":t=a.value,t!=null&&yr(e,!!a.multiple,t,!1)}}}var Zn=!1;function Ea(e,t,a){if(Zn)return e(t,a);Zn=!0;try{var u=e(t);return u}finally{if(Zn=!1,(Ks!==null||Pn!==null)&&(Ao(),Ks&&(t=Ks,e=Pn,Pn=Ks=null,Tt(t),e)))for(t=0;t<e.length;t++)Tt(e[t])}}function ga(e,t){var a=e.stateNode;if(a===null)return null;var u=a[an]||null;if(u===null)return null;a=u[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(e=e.type,u=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!u;break e;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(s(231,t,typeof a));return a}var wn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Cn=!1;if(wn)try{var sl={};Object.defineProperty(sl,"passive",{get:function(){Cn=!0}}),window.addEventListener("test",sl,sl),window.removeEventListener("test",sl,sl)}catch{Cn=!1}var Yo=null,Fn=null,yn=null;function Ni(){if(yn)return yn;var e,t=Fn,a=t.length,u,h="value"in Yo?Yo.value:Yo.textContent,w=h.length;for(e=0;e<a&&t[e]===h[e];e++);var O=a-e;for(u=1;u<=O&&t[a-u]===h[w-u];u++);return yn=h.slice(e,1<u?1-u:void 0)}function pn(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function vi(){return!0}function jn(){return!1}function ta(e){function t(a,u,h,w,O){this._reactName=a,this._targetInst=h,this.type=u,this.nativeEvent=w,this.target=O,this.currentTarget=null;for(var ue in e)e.hasOwnProperty(ue)&&(a=e[ue],this[ue]=a?a(w):w[ue]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?vi:jn,this.isPropagationStopped=jn,this}return D(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=vi)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=vi)},persist:function(){},isPersistent:vi}),t}var Qt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ri=ta(Qt),tn=D({},Qt,{view:0,detail:0}),wi=ta(tn),Va,qa,uo,_a=D({},tn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sn,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==uo&&(uo&&e.type==="mousemove"?(Va=e.screenX-uo.screenX,qa=e.screenY-uo.screenY):qa=Va=0,uo=e),Va)},movementY:function(e){return"movementY"in e?e.movementY:qa}}),vs=ta(_a),rs=D({},_a,{dataTransfer:0}),Zs=ta(rs),eu=D({},tn,{relatedTarget:0}),ws=ta(eu),tu=D({},Qt,{animationName:0,elapsedTime:0,pseudoElement:0}),T=ta(tu),Q=D({},Qt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),fe=ta(Q),Be=D({},Qt,{data:0}),Ve=ta(Be),gt={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},mt={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$t={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Kt(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=$t[e])?!!t[e]:!1}function sn(){return Kt}var Un=D({},tn,{key:function(e){if(e.key){var t=gt[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=pn(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?mt[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sn,charCode:function(e){return e.type==="keypress"?pn(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?pn(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),li=ta(Un),Qr=D({},_a,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Bi=ta(Qr),kr=D({},tn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sn}),Ar=ta(kr),_o=D({},Qt,{propertyName:0,elapsedTime:0,pseudoElement:0}),Qi=ta(_o),ya=D({},_a,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Dr=ta(ya),xa=D({},Qt,{newState:0,oldState:0}),ma=ta(xa),Ss=[9,13,27,32],na=wn&&"CompositionEvent"in window,Da=null;wn&&"documentMode"in document&&(Da=document.documentMode);var fo=wn&&"TextEvent"in window&&!Da,ba=wn&&(!na||Da&&8<Da&&11>=Da),Wi=" ",Ra=!1;function vo(e,t){switch(e){case"keyup":return Ss.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function os(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var $i=!1;function eo(e,t){switch(e){case"compositionend":return os(t);case"keypress":return t.which!==32?null:(Ra=!0,Wi);case"textInput":return e=t.data,e===Wi&&Ra?null:e;default:return null}}function Tl(e,t){if($i)return e==="compositionend"||!na&&vo(e,t)?(e=Ni(),yn=Fn=Yo=null,$i=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ba&&t.locale!=="ko"?null:t.data;default:return null}}var Ic={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Rs(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Ic[e.type]:t==="textarea"}function Ia(e,t,a,u){Ks?Pn?Pn.push(u):Pn=[u]:Ks=u,t=Lp(t,"onChange"),0<t.length&&(a=new ri("onChange","change",null,a,u),e.push({event:a,listeners:t}))}var as=null,Js=null;function Do(e){D0(e,0)}function ss(e){var t=ui(e);if(Xl(t))return e}function po(e,t){if(e==="change")return t}var Go=!1;if(wn){var Wr;if(wn){var Is="oninput"in document;if(!Is){var ia=document.createElement("div");ia.setAttribute("oninput","return;"),Is=typeof ia.oninput=="function"}Wr=Is}else Wr=!1;Go=Wr&&(!document.documentMode||9<document.documentMode)}function Qs(){as&&(as.detachEvent("onpropertychange",Ha),Js=as=null)}function Ha(e){if(e.propertyName==="value"&&ss(Js)){var t=[];Ia(t,Js,e,Ua(e)),Ea(Do,t)}}function Jl(e,t,a){e==="focusin"?(Qs(),as=t,Js=a,as.attachEvent("onpropertychange",Ha)):e==="focusout"&&Qs()}function Jn(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ss(Js)}function Ts(e,t){if(e==="click")return ss(t)}function Oi(e,t){if(e==="input"||e==="change")return ss(t)}function ra(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Xo=typeof Object.is=="function"?Object.is:ra;function va(e,t){if(Xo(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var a=Object.keys(e),u=Object.keys(t);if(a.length!==u.length)return!1;for(u=0;u<a.length;u++){var h=a[u];if(!xt.call(t,h)||!Xo(e[h],t[h]))return!1}return!0}function Lc(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function el(e,t){var a=Lc(e);e=0;for(var u;a;){if(a.nodeType===3){if(u=e+a.textContent.length,e<=t&&u>=t)return{node:a,offset:t-e};e=u}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Lc(a)}}function Cl(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Cl(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function jl(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=bo(e.document);t instanceof e.HTMLIFrameElement;){try{var a=typeof t.contentWindow.location.href=="string"}catch{a=!1}if(a)e=t.contentWindow;else break;t=bo(e.document)}return t}function wo(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var Nl=wn&&"documentMode"in document&&11>=document.documentMode,Ko=null,Wa=null,sr=null,ls=!1;function Ii(e,t,a){var u=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;ls||Ko==null||Ko!==bo(u)||(u=Ko,"selectionStart"in u&&wo(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),sr&&va(sr,u)||(sr=u,u=Lp(Wa,"onSelect"),0<u.length&&(t=new ri("onSelect","select",null,t,a),e.push({event:t,listeners:u}),t.target=Ko)))}function Fi(e,t){var a={};return a[e.toLowerCase()]=t.toLowerCase(),a["Webkit"+e]="webkit"+t,a["Moz"+e]="moz"+t,a}var lr={animationend:Fi("Animation","AnimationEnd"),animationiteration:Fi("Animation","AnimationIteration"),animationstart:Fi("Animation","AnimationStart"),transitionrun:Fi("Transition","TransitionRun"),transitionstart:Fi("Transition","TransitionStart"),transitioncancel:Fi("Transition","TransitionCancel"),transitionend:Fi("Transition","TransitionEnd")},So={},cs={};wn&&(cs=document.createElement("div").style,"AnimationEvent"in window||(delete lr.animationend.animation,delete lr.animationiteration.animation,delete lr.animationstart.animation),"TransitionEvent"in window||delete lr.transitionend.transition);function tl(e){if(So[e])return So[e];if(!lr[e])return e;var t=lr[e],a;for(a in t)if(t.hasOwnProperty(a)&&a in cs)return So[e]=t[a];return e}var bc=tl("animationend"),nu=tl("animationiteration"),Gu=tl("animationstart"),$a=tl("transitionrun"),ho=tl("transitionstart"),kl=tl("transitioncancel"),Ro=tl("transitionend"),Ls=new Map,To="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");To.push("scrollEnd");function Io(e,t){Ls.set(e,t),Wo(t,[e])}var to=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},wa=[],er=0,oi=0;function Rr(){for(var e=er,t=oi=er=0;t<e;){var a=wa[t];wa[t++]=null;var u=wa[t];wa[t++]=null;var h=wa[t];wa[t++]=null;var w=wa[t];if(wa[t++]=null,u!==null&&h!==null){var O=u.pending;O===null?h.next=h:(h.next=O.next,O.next=h),u.pending=h}w!==0&&Ya(a,h,w)}}function no(e,t,a,u){wa[er++]=e,wa[er++]=t,wa[er++]=a,wa[er++]=u,oi|=u,e.lanes|=u,e=e.alternate,e!==null&&(e.lanes|=u)}function Lo(e,t,a,u){return no(e,t,a,u),oa(e)}function ll(e,t){return no(e,null,null,t),oa(e)}function Ya(e,t,a){e.lanes|=a;var u=e.alternate;u!==null&&(u.lanes|=a);for(var h=!1,w=e.return;w!==null;)w.childLanes|=a,u=w.alternate,u!==null&&(u.childLanes|=a),w.tag===22&&(e=w.stateNode,e===null||e._visibility&1||(h=!0)),e=w,w=w.return;return e.tag===3?(w=e.stateNode,h&&t!==null&&(h=31-Vt(a),e=w.hiddenUpdates,u=e[h],u===null?e[h]=[t]:u.push(t),t.lane=a|536870912),w):null}function oa(e){if(50<Vn)throw Vn=0,Gn=null,Error(s(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var $r={};function ki(e,t,a,u){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ti(e,t,a,u){return new ki(e,t,a,u)}function Mc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function dr(e,t){var a=e.alternate;return a===null?(a=Ti(e.tag,t,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=t,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&65011712,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,t=e.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a.refCleanup=e.refCleanup,a}function io(e,t){e.flags&=65011714;var a=e.alternate;return a===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=a.childLanes,e.lanes=a.lanes,e.child=a.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,e.type=a.type,t=a.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function cl(e,t,a,u,h,w){var O=0;if(u=e,typeof e=="function")Mc(e)&&(O=1);else if(typeof e=="string")O=Em(e,a,W.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case F:return e=Ti(31,a,t,h),e.elementType=F,e.lanes=w,e;case _:return ro(a.children,h,w,t);case N:O=8,h|=24;break;case g:return e=Ti(12,a,t,h|2),e.elementType=g,e.lanes=w,e;case re:return e=Ti(13,a,t,h),e.elementType=re,e.lanes=w,e;case J:return e=Ti(19,a,t,h),e.elementType=J,e.lanes=w,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case V:O=10;break e;case ae:O=9;break e;case E:O=11;break e;case G:O=14;break e;case ee:O=16,u=null;break e}O=29,a=Error(s(130,e===null?"null":typeof e,"")),u=null}return t=Ti(O,a,t,h),t.elementType=e,t.type=u,t.lanes=w,t}function ro(e,t,a,u){return e=Ti(7,e,u,t),e.lanes=a,e}function us(e,t,a){return e=Ti(6,e,null,t),e.lanes=a,e}function aa(e){var t=Ti(18,null,null,0);return t.stateNode=e,t}function ul(e,t,a){return t=Ti(4,e.children!==null?e.children:[],e.key,t),t.lanes=a,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var iu=new WeakMap;function Cs(e,t){if(typeof e=="object"&&e!==null){var a=iu.get(e);return a!==void 0?a:(t={value:e,source:t,stack:Gt(t)},iu.set(e,t),t)}return{value:e,source:t,stack:Gt(t)}}var ds=[],dl=0,Bc=null,Al=0,js=[],sa=0,Ga=null,Co=1,Mo="";function La(e,t){ds[dl++]=Al,ds[dl++]=Bc,Bc=e,Al=t}function ru(e,t,a){js[sa++]=Co,js[sa++]=Mo,js[sa++]=Ga,Ga=e;var u=Co;e=Mo;var h=32-Vt(u)-1;u&=~(1<<h),a+=1;var w=32-Vt(t)+h;if(30<w){var O=h-h%5;w=(u&(1<<O)-1).toString(32),u>>=O,h-=O,Co=1<<32-Vt(t)+h|a<<h|u,Mo=w+e}else Co=1<<w|a<<h|u,Mo=e}function Pl(e){e.return!==null&&(La(e,1),ru(e,1,0))}function Ns(e){for(;e===Bc;)Bc=ds[--dl],ds[dl]=null,Al=ds[--dl],ds[dl]=null;for(;e===Ga;)Ga=js[--sa],js[sa]=null,Mo=js[--sa],js[sa]=null,Co=js[--sa],js[sa]=null}function Xu(e,t){js[sa++]=Co,js[sa++]=Mo,js[sa++]=Ga,Co=t.id,Mo=t.overflow,Ga=e}var fr=null,Ir=null,En=!1,la=null,oo=!1,Sa=Error(s(519));function Ta(e){var t=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Fc(Cs(t,e)),Sa}function Oc(e){var t=e.stateNode,a=e.type,u=e.memoizedProps;switch(t[Dt]=e,t[an]=u,a){case"dialog":Vi("cancel",t),Vi("close",t);break;case"iframe":case"object":case"embed":Vi("load",t);break;case"video":case"audio":for(a=0;a<Lf.length;a++)Vi(Lf[a],t);break;case"source":Vi("error",t);break;case"img":case"image":case"link":Vi("error",t),Vi("load",t);break;case"details":Vi("toggle",t);break;case"input":Vi("invalid",t),Kl(t,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":Vi("invalid",t);break;case"textarea":Vi("invalid",t),Hr(t,u.value,u.defaultValue,u.children)}a=u.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||t.textContent===""+a||u.suppressHydrationWarning===!0||M0(t.textContent,a)?(u.popover!=null&&(Vi("beforetoggle",t),Vi("toggle",t)),u.onScroll!=null&&Vi("scroll",t),u.onScrollEnd!=null&&Vi("scrollend",t),u.onClick!=null&&(t.onclick=xr),t=!0):t=!1,t||Ta(e,!0)}function Ca(e){for(fr=e.return;fr;)switch(fr.tag){case 5:case 31:case 13:oo=!1;return;case 27:case 3:oo=!0;return;default:fr=fr.return}}function Fr(e){if(e!==fr)return!1;if(!En)return Ca(e),En=!0,!1;var t=e.tag,a;if((a=t!==3&&t!==27)&&((a=t===5)&&(a=e.type,a=!(a!=="form"&&a!=="button")||Wh(e.type,e.memoizedProps)),a=!a),a&&Ir&&Ta(e),Ca(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));Ir=W0(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));Ir=W0(e)}else t===27?(t=Ir,Iu(e.type)?(e=Kh,Kh=null,Ir=e):Ir=t):Ir=fr?pc(e.stateNode.nextSibling):null;return!0}function vc(){Ir=fr=null,En=!1}function bu(){var e=la;return e!==null&&(dt===null?dt=e:dt.push.apply(dt,e),la=null),e}function Fc(e){la===null?la=[e]:la.push(e)}var vu=k(null),fl=null,nl=null;function zl(e,t,a){q(vu,t._currentValue),t._currentValue=a}function ks(e){e._currentValue=vu.current,A(vu)}function As(e,t,a){for(;e!==null;){var u=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,u!==null&&(u.childLanes|=t)):u!==null&&(u.childLanes&t)!==t&&(u.childLanes|=t),e===a)break;e=e.return}}function Yr(e,t,a,u){var h=e.child;for(h!==null&&(h.return=e);h!==null;){var w=h.dependencies;if(w!==null){var O=h.child;w=w.firstContext;e:for(;w!==null;){var ue=w;w=h;for(var Ue=0;Ue<t.length;Ue++)if(ue.context===t[Ue]){w.lanes|=a,ue=w.alternate,ue!==null&&(ue.lanes|=a),As(w.return,a,e),u||(O=null);break e}w=ue.next}}else if(h.tag===18){if(O=h.return,O===null)throw Error(s(341));O.lanes|=a,w=O.alternate,w!==null&&(w.lanes|=a),As(O,a,e),O=null}else O=h.child;if(O!==null)O.return=h;else for(O=h;O!==null;){if(O===e){O=null;break}if(h=O.sibling,h!==null){h.return=O.return,O=h;break}O=O.return}h=O}}function Xa(e,t,a,u){e=null;for(var h=t,w=!1;h!==null;){if(!w){if((h.flags&524288)!==0)w=!0;else if((h.flags&262144)!==0)break}if(h.tag===10){var O=h.alternate;if(O===null)throw Error(s(387));if(O=O.memoizedProps,O!==null){var ue=h.type;Xo(h.pendingProps.value,O.value)||(e!==null?e.push(ue):e=[ue])}}else if(h===le.current){if(O=h.alternate,O===null)throw Error(s(387));O.memoizedState.memoizedState!==h.memoizedState.memoizedState&&(e!==null?e.push(Uf):e=[Uf])}h=h.return}e!==null&&Yr(t,e,a,u),t.flags|=262144}function jo(e){for(e=e.firstContext;e!==null;){if(!Xo(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ql(e){fl=e,nl=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function ca(e){return Ka(fl,e)}function No(e,t){return fl===null&&Ql(e),Ka(e,t)}function Ka(e,t){var a=t._currentValue;if(t={context:t,memoizedValue:a,next:null},nl===null){if(e===null)throw Error(s(308));nl=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else nl=nl.next=t;return a}var Ma=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(a,u){e.push(u)}};this.abort=function(){t.aborted=!0,e.forEach(function(a){return a()})}},fs=n.unstable_scheduleCallback,Ba=n.unstable_NormalPriority,Li={$$typeof:V,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Bo(){return{controller:new Ma,data:new Map,refCount:0}}function ua(e){e.refCount--,e.refCount===0&&fs(Ba,function(){e.controller.abort()})}var Zo=null,ja=0,f=0,y=null;function j(e,t){if(Zo===null){var a=Zo=[];ja=0,f=Mh(),y={status:"pending",value:void 0,then:function(u){a.push(u)}}}return ja++,t.then(I,I),t}function I(){if(--ja===0&&Zo!==null){y!==null&&(y.status="fulfilled");var e=Zo;Zo=null,f=0,y=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function X(e,t){var a=[],u={status:"pending",value:null,reason:null,then:function(h){a.push(h)}};return e.then(function(){u.status="fulfilled",u.value=t;for(var h=0;h<a.length;h++)(0,a[h])(t)},function(h){for(u.status="rejected",u.reason=h,h=0;h<a.length;h++)(0,a[h])(void 0)}),u}var ie=te.S;te.S=function(e,t){st=xn(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&j(e,t),ie!==null&&ie(e,t)};var oe=k(null);function ce(){var e=oe.current;return e!==null?e:B.pooledCache}function pe(e,t){t===null?q(oe,oe.current):q(oe,t.pool)}function Te(){var e=ce();return e===null?null:{parent:Li._currentValue,pool:e}}var Re=Error(s(460)),Ee=Error(s(474)),ke=Error(s(542)),He={then:function(){}};function Qe(e){return e=e.status,e==="fulfilled"||e==="rejected"}function yt(e,t,a){switch(a=e[a],a===void 0?e.push(t):a!==t&&(t.then(xr,xr),t=a),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Mt(e),e;default:if(typeof t.status=="string")t.then(xr,xr);else{if(e=B,e!==null&&100<e.shellSuspendCounter)throw Error(s(482));e=t,e.status="pending",e.then(function(u){if(t.status==="pending"){var h=t;h.status="fulfilled",h.value=u}},function(u){if(t.status==="pending"){var h=t;h.status="rejected",h.reason=u}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Mt(e),e}throw pt=t,Re}}function et(e){try{var t=e._init;return t(e._payload)}catch(a){throw a!==null&&typeof a=="object"&&typeof a.then=="function"?(pt=a,Re):a}}var pt=null;function bt(){if(pt===null)throw Error(s(459));var e=pt;return pt=null,e}function Mt(e){if(e===Re||e===ke)throw Error(s(483))}var zt=null,Sn=0;function un(e){var t=Sn;return Sn+=1,zt===null&&(zt=[]),yt(zt,e,t)}function Tn(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function nn(e,t){throw t.$$typeof===M?Error(s(525)):(e=Object.prototype.toString.call(t),Error(s(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function pi(e){function t(Xe,We){if(e){var nt=Xe.deletions;nt===null?(Xe.deletions=[We],Xe.flags|=16):nt.push(We)}}function a(Xe,We){if(!e)return null;for(;We!==null;)t(Xe,We),We=We.sibling;return null}function u(Xe){for(var We=new Map;Xe!==null;)Xe.key!==null?We.set(Xe.key,Xe):We.set(Xe.index,Xe),Xe=Xe.sibling;return We}function h(Xe,We){return Xe=dr(Xe,We),Xe.index=0,Xe.sibling=null,Xe}function w(Xe,We,nt){return Xe.index=nt,e?(nt=Xe.alternate,nt!==null?(nt=nt.index,nt<We?(Xe.flags|=67108866,We):nt):(Xe.flags|=67108866,We)):(Xe.flags|=1048576,We)}function O(Xe){return e&&Xe.alternate===null&&(Xe.flags|=67108866),Xe}function ue(Xe,We,nt,kt){return We===null||We.tag!==6?(We=us(nt,Xe.mode,kt),We.return=Xe,We):(We=h(We,nt),We.return=Xe,We)}function Ue(Xe,We,nt,kt){var $n=nt.type;return $n===_?St(Xe,We,nt.props.children,kt,nt.key):We!==null&&(We.elementType===$n||typeof $n=="object"&&$n!==null&&$n.$$typeof===ee&&et($n)===We.type)?(We=h(We,nt.props),Tn(We,nt),We.return=Xe,We):(We=cl(nt.type,nt.key,nt.props,null,Xe.mode,kt),Tn(We,nt),We.return=Xe,We)}function it(Xe,We,nt,kt){return We===null||We.tag!==4||We.stateNode.containerInfo!==nt.containerInfo||We.stateNode.implementation!==nt.implementation?(We=ul(nt,Xe.mode,kt),We.return=Xe,We):(We=h(We,nt.children||[]),We.return=Xe,We)}function St(Xe,We,nt,kt,$n){return We===null||We.tag!==7?(We=ro(nt,Xe.mode,kt,$n),We.return=Xe,We):(We=h(We,nt),We.return=Xe,We)}function _t(Xe,We,nt){if(typeof We=="string"&&We!==""||typeof We=="number"||typeof We=="bigint")return We=us(""+We,Xe.mode,nt),We.return=Xe,We;if(typeof We=="object"&&We!==null){switch(We.$$typeof){case S:return nt=cl(We.type,We.key,We.props,null,Xe.mode,nt),Tn(nt,We),nt.return=Xe,nt;case U:return We=ul(We,Xe.mode,nt),We.return=Xe,We;case ee:return We=et(We),_t(Xe,We,nt)}if(we(We)||R(We))return We=ro(We,Xe.mode,nt,null),We.return=Xe,We;if(typeof We.then=="function")return _t(Xe,un(We),nt);if(We.$$typeof===V)return _t(Xe,No(Xe,We),nt);nn(Xe,We)}return null}function rt(Xe,We,nt,kt){var $n=We!==null?We.key:null;if(typeof nt=="string"&&nt!==""||typeof nt=="number"||typeof nt=="bigint")return $n!==null?null:ue(Xe,We,""+nt,kt);if(typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case S:return nt.key===$n?Ue(Xe,We,nt,kt):null;case U:return nt.key===$n?it(Xe,We,nt,kt):null;case ee:return nt=et(nt),rt(Xe,We,nt,kt)}if(we(nt)||R(nt))return $n!==null?null:St(Xe,We,nt,kt,null);if(typeof nt.then=="function")return rt(Xe,We,un(nt),kt);if(nt.$$typeof===V)return rt(Xe,We,No(Xe,nt),kt);nn(Xe,nt)}return null}function ut(Xe,We,nt,kt,$n){if(typeof kt=="string"&&kt!==""||typeof kt=="number"||typeof kt=="bigint")return Xe=Xe.get(nt)||null,ue(We,Xe,""+kt,$n);if(typeof kt=="object"&&kt!==null){switch(kt.$$typeof){case S:return Xe=Xe.get(kt.key===null?nt:kt.key)||null,Ue(We,Xe,kt,$n);case U:return Xe=Xe.get(kt.key===null?nt:kt.key)||null,it(We,Xe,kt,$n);case ee:return kt=et(kt),ut(Xe,We,nt,kt,$n)}if(we(kt)||R(kt))return Xe=Xe.get(nt)||null,St(We,Xe,kt,$n,null);if(typeof kt.then=="function")return ut(Xe,We,nt,un(kt),$n);if(kt.$$typeof===V)return ut(Xe,We,nt,No(We,kt),$n);nn(We,kt)}return null}function Nn(Xe,We,nt,kt){for(var $n=null,vr=null,Dn=We,Ai=We=0,Ki=null;Dn!==null&&Ai<nt.length;Ai++){Dn.index>Ai?(Ki=Dn,Dn=null):Ki=Dn.sibling;var wr=rt(Xe,Dn,nt[Ai],kt);if(wr===null){Dn===null&&(Dn=Ki);break}e&&Dn&&wr.alternate===null&&t(Xe,Dn),We=w(wr,We,Ai),vr===null?$n=wr:vr.sibling=wr,vr=wr,Dn=Ki}if(Ai===nt.length)return a(Xe,Dn),En&&La(Xe,Ai),$n;if(Dn===null){for(;Ai<nt.length;Ai++)Dn=_t(Xe,nt[Ai],kt),Dn!==null&&(We=w(Dn,We,Ai),vr===null?$n=Dn:vr.sibling=Dn,vr=Dn);return En&&La(Xe,Ai),$n}for(Dn=u(Dn);Ai<nt.length;Ai++)Ki=ut(Dn,Xe,Ai,nt[Ai],kt),Ki!==null&&(e&&Ki.alternate!==null&&Dn.delete(Ki.key===null?Ai:Ki.key),We=w(Ki,We,Ai),vr===null?$n=Ki:vr.sibling=Ki,vr=Ki);return e&&Dn.forEach(function(Fu){return t(Xe,Fu)}),En&&La(Xe,Ai),$n}function ei(Xe,We,nt,kt){if(nt==null)throw Error(s(151));for(var $n=null,vr=null,Dn=We,Ai=We=0,Ki=null,wr=nt.next();Dn!==null&&!wr.done;Ai++,wr=nt.next()){Dn.index>Ai?(Ki=Dn,Dn=null):Ki=Dn.sibling;var Fu=rt(Xe,Dn,wr.value,kt);if(Fu===null){Dn===null&&(Dn=Ki);break}e&&Dn&&Fu.alternate===null&&t(Xe,Dn),We=w(Fu,We,Ai),vr===null?$n=Fu:vr.sibling=Fu,vr=Fu,Dn=Ki}if(wr.done)return a(Xe,Dn),En&&La(Xe,Ai),$n;if(Dn===null){for(;!wr.done;Ai++,wr=nt.next())wr=_t(Xe,wr.value,kt),wr!==null&&(We=w(wr,We,Ai),vr===null?$n=wr:vr.sibling=wr,vr=wr);return En&&La(Xe,Ai),$n}for(Dn=u(Dn);!wr.done;Ai++,wr=nt.next())wr=ut(Dn,Xe,Ai,wr.value,kt),wr!==null&&(e&&wr.alternate!==null&&Dn.delete(wr.key===null?Ai:wr.key),We=w(wr,We,Ai),vr===null?$n=wr:vr.sibling=wr,vr=wr);return e&&Dn.forEach(function(Jm){return t(Xe,Jm)}),En&&La(Xe,Ai),$n}function Zr(Xe,We,nt,kt){if(typeof nt=="object"&&nt!==null&&nt.type===_&&nt.key===null&&(nt=nt.props.children),typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case S:e:{for(var $n=nt.key;We!==null;){if(We.key===$n){if($n=nt.type,$n===_){if(We.tag===7){a(Xe,We.sibling),kt=h(We,nt.props.children),kt.return=Xe,Xe=kt;break e}}else if(We.elementType===$n||typeof $n=="object"&&$n!==null&&$n.$$typeof===ee&&et($n)===We.type){a(Xe,We.sibling),kt=h(We,nt.props),Tn(kt,nt),kt.return=Xe,Xe=kt;break e}a(Xe,We);break}else t(Xe,We);We=We.sibling}nt.type===_?(kt=ro(nt.props.children,Xe.mode,kt,nt.key),kt.return=Xe,Xe=kt):(kt=cl(nt.type,nt.key,nt.props,null,Xe.mode,kt),Tn(kt,nt),kt.return=Xe,Xe=kt)}return O(Xe);case U:e:{for($n=nt.key;We!==null;){if(We.key===$n)if(We.tag===4&&We.stateNode.containerInfo===nt.containerInfo&&We.stateNode.implementation===nt.implementation){a(Xe,We.sibling),kt=h(We,nt.children||[]),kt.return=Xe,Xe=kt;break e}else{a(Xe,We);break}else t(Xe,We);We=We.sibling}kt=ul(nt,Xe.mode,kt),kt.return=Xe,Xe=kt}return O(Xe);case ee:return nt=et(nt),Zr(Xe,We,nt,kt)}if(we(nt))return Nn(Xe,We,nt,kt);if(R(nt)){if($n=R(nt),typeof $n!="function")throw Error(s(150));return nt=$n.call(nt),ei(Xe,We,nt,kt)}if(typeof nt.then=="function")return Zr(Xe,We,un(nt),kt);if(nt.$$typeof===V)return Zr(Xe,We,No(Xe,nt),kt);nn(Xe,nt)}return typeof nt=="string"&&nt!==""||typeof nt=="number"||typeof nt=="bigint"?(nt=""+nt,We!==null&&We.tag===6?(a(Xe,We.sibling),kt=h(We,nt),kt.return=Xe,Xe=kt):(a(Xe,We),kt=us(nt,Xe.mode,kt),kt.return=Xe,Xe=kt),O(Xe)):a(Xe,We)}return function(Xe,We,nt,kt){try{Sn=0;var $n=Zr(Xe,We,nt,kt);return zt=null,$n}catch(Dn){if(Dn===Re||Dn===ke)throw Dn;var vr=Ti(29,Dn,null,Xe.mode);return vr.lanes=kt,vr.return=Xe,vr}finally{}}}var Lr=pi(!0),zn=pi(!1),Ut=!1;function Xt(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function cr(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Yn(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function gi(e,t,a){var u=e.updateQueue;if(u===null)return null;if(u=u.shared,(P&2)!==0){var h=u.pending;return h===null?t.next=t:(t.next=h.next,h.next=t),u.pending=t,t=oa(e),Ya(e,null,a),t}return no(e,u,t,a),oa(e)}function tr(e,t,a){if(t=t.updateQueue,t!==null&&(t=t.shared,(a&4194048)!==0)){var u=t.lanes;u&=e.pendingLanes,a|=u,t.lanes=a,Cr(e,a)}}function Pi(e,t){var a=e.updateQueue,u=e.alternate;if(u!==null&&(u=u.updateQueue,a===u)){var h=null,w=null;if(a=a.firstBaseUpdate,a!==null){do{var O={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};w===null?h=w=O:w=w.next=O,a=a.next}while(a!==null);w===null?h=w=t:w=w.next=t}else h=w=t;a={baseState:u.baseState,firstBaseUpdate:h,lastBaseUpdate:w,shared:u.shared,callbacks:u.callbacks},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=t:e.next=t,a.lastBaseUpdate=t}var pr=!1;function Yi(){if(pr){var e=y;if(e!==null)throw e}}function Ur(e,t,a,u){pr=!1;var h=e.updateQueue;Ut=!1;var w=h.firstBaseUpdate,O=h.lastBaseUpdate,ue=h.shared.pending;if(ue!==null){h.shared.pending=null;var Ue=ue,it=Ue.next;Ue.next=null,O===null?w=it:O.next=it,O=Ue;var St=e.alternate;St!==null&&(St=St.updateQueue,ue=St.lastBaseUpdate,ue!==O&&(ue===null?St.firstBaseUpdate=it:ue.next=it,St.lastBaseUpdate=Ue))}if(w!==null){var _t=h.baseState;O=0,St=it=Ue=null,ue=w;do{var rt=ue.lane&-536870913,ut=rt!==ue.lane;if(ut?(ne&rt)===rt:(u&rt)===rt){rt!==0&&rt===f&&(pr=!0),St!==null&&(St=St.next={lane:0,tag:ue.tag,payload:ue.payload,callback:null,next:null});e:{var Nn=e,ei=ue;rt=t;var Zr=a;switch(ei.tag){case 1:if(Nn=ei.payload,typeof Nn=="function"){_t=Nn.call(Zr,_t,rt);break e}_t=Nn;break e;case 3:Nn.flags=Nn.flags&-65537|128;case 0:if(Nn=ei.payload,rt=typeof Nn=="function"?Nn.call(Zr,_t,rt):Nn,rt==null)break e;_t=D({},_t,rt);break e;case 2:Ut=!0}}rt=ue.callback,rt!==null&&(e.flags|=64,ut&&(e.flags|=8192),ut=h.callbacks,ut===null?h.callbacks=[rt]:ut.push(rt))}else ut={lane:rt,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null},St===null?(it=St=ut,Ue=_t):St=St.next=ut,O|=rt;if(ue=ue.next,ue===null){if(ue=h.shared.pending,ue===null)break;ut=ue,ue=ut.next,ut.next=null,h.lastBaseUpdate=ut,h.shared.pending=null}}while(!0);St===null&&(Ue=_t),h.baseState=Ue,h.firstBaseUpdate=it,h.lastBaseUpdate=St,w===null&&(h.shared.lanes=0),me|=O,e.lanes=O,e.memoizedState=_t}}function ao(e,t){if(typeof e!="function")throw Error(s(191,e));e.call(t)}function Pr(e,t){var a=e.callbacks;if(a!==null)for(e.callbacks=null,e=0;e<a.length;e++)ao(a[e],t)}var ii=k(null),Gi=k(0);function mr(e,t){e=Ae,q(Gi,e),q(ii,t),Ae=e|t.baseLanes}function ai(){q(Gi,Ae),q(ii,ii.current)}function nr(){Ae=Gi.current,A(ii),A(Gi)}var Si=k(null),yi=null;function Xi(e){var t=e.alternate;q(si,si.current&1),q(Si,e),yi===null&&(t===null||ii.current!==null||t.memoizedState!==null)&&(yi=e)}function Ui(e){q(si,si.current),q(Si,e),yi===null&&(yi=e)}function Er(e){e.tag===22?(q(si,si.current),q(Si,e),yi===null&&(yi=e)):go()}function go(){q(si,si.current),q(Si,Si.current)}function zr(e){A(Si),yi===e&&(yi=null),A(si)}var si=k(0);function Oo(e){for(var t=e;t!==null;){if(t.tag===13){var a=t.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||Gh(a)||Xh(a)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Gr=0,Mn=null,In=null,Ei=null,Oa=!1,yo=!1,Fo=!1,so=0,pl=0,_l=null,wc=0;function _r(){throw Error(s(321))}function Sc(e,t){if(t===null)return!1;for(var a=0;a<t.length&&a<e.length;a++)if(!Xo(e[a],t[a]))return!1;return!0}function hl(e,t,a,u,h,w){return Gr=w,Mn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,te.H=e===null||e.memoizedState===null?Nu:lu,Fo=!1,w=a(u,h),Fo=!1,yo&&(w=Za(t,a,u,h)),Uc(e),w}function Uc(e){te.H=Cc;var t=In!==null&&In.next!==null;if(Gr=0,Ei=In=Mn=null,Oa=!1,pl=0,_l=null,t)throw Error(s(300));e===null||da||(e=e.dependencies,e!==null&&jo(e)&&(da=!0))}function Za(e,t,a,u){Mn=e;var h=0;do{if(yo&&(_l=null),pl=0,yo=!1,25<=h)throw Error(s(301));if(h+=1,Ei=In=null,e.updateQueue!=null){var w=e.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}te.H=ed,w=t(a,u)}while(yo);return w}function Ku(){var e=te.H,t=e.useState()[0];return t=typeof t.then=="function"?yl(t):t,e=e.useState()[0],(In!==null?In.memoizedState:null)!==e&&(Mn.flags|=1024),t}function gl(){var e=so!==0;return so=0,e}function ec(e,t,a){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a}function tc(e){if(Oa){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Oa=!1}Gr=0,Ei=In=Mn=null,yo=!1,pl=so=0,_l=null}function Uo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ei===null?Mn.memoizedState=Ei=e:Ei=Ei.next=e,Ei}function Xr(){if(In===null){var e=Mn.alternate;e=e!==null?e.memoizedState:null}else e=In.next;var t=Ei===null?Mn.memoizedState:Ei.next;if(t!==null)Ei=t,In=e;else{if(e===null)throw Mn.alternate===null?Error(s(467)):Error(s(310));In=e,e={memoizedState:In.memoizedState,baseState:In.baseState,baseQueue:In.baseQueue,queue:In.queue,next:null},Ei===null?Mn.memoizedState=Ei=e:Ei=Ei.next=e}return Ei}function nc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function yl(e){var t=pl;return pl+=1,_l===null&&(_l=[]),e=yt(_l,e,t),t=Mn,(Ei===null?t.memoizedState:Ei.next)===null&&(t=t.alternate,te.H=t===null||t.memoizedState===null?Nu:lu),e}function ic(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return yl(e);if(e.$$typeof===V)return ca(e)}throw Error(s(438,String(e)))}function rc(e){var t=null,a=Mn.updateQueue;if(a!==null&&(t=a.memoCache),t==null){var u=Mn.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(t={data:u.data.map(function(h){return h.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),a===null&&(a=nc(),Mn.updateQueue=a),a.memoCache=t,a=t.data[t.index],a===void 0)for(a=t.data[t.index]=Array(e),u=0;u<e;u++)a[u]=$;return t.index++,a}function Ja(e,t){return typeof t=="function"?t(e):t}function oc(e){var t=Xr();return ac(t,In,e)}function ac(e,t,a){var u=e.queue;if(u===null)throw Error(s(311));u.lastRenderedReducer=a;var h=e.baseQueue,w=u.pending;if(w!==null){if(h!==null){var O=h.next;h.next=w.next,w.next=O}t.baseQueue=h=w,u.pending=null}if(w=e.baseState,h===null)e.memoizedState=w;else{t=h.next;var ue=O=null,Ue=null,it=t,St=!1;do{var _t=it.lane&-536870913;if(_t!==it.lane?(ne&_t)===_t:(Gr&_t)===_t){var rt=it.revertLane;if(rt===0)Ue!==null&&(Ue=Ue.next={lane:0,revertLane:0,gesture:null,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null}),_t===f&&(St=!0);else if((Gr&rt)===rt){it=it.next,rt===f&&(St=!0);continue}else _t={lane:0,revertLane:it.revertLane,gesture:null,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null},Ue===null?(ue=Ue=_t,O=w):Ue=Ue.next=_t,Mn.lanes|=rt,me|=rt;_t=it.action,Fo&&a(w,_t),w=it.hasEagerState?it.eagerState:a(w,_t)}else rt={lane:_t,revertLane:it.revertLane,gesture:it.gesture,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null},Ue===null?(ue=Ue=rt,O=w):Ue=Ue.next=rt,Mn.lanes|=_t,me|=_t;it=it.next}while(it!==null&&it!==t);if(Ue===null?O=w:Ue.next=ue,!Xo(w,e.memoizedState)&&(da=!0,St&&(a=y,a!==null)))throw a;e.memoizedState=w,e.baseState=O,e.baseQueue=Ue,u.lastRenderedState=w}return h===null&&(u.lanes=0),[e.memoizedState,u.dispatch]}function Ec(e){var t=Xr(),a=t.queue;if(a===null)throw Error(s(311));a.lastRenderedReducer=e;var u=a.dispatch,h=a.pending,w=t.memoizedState;if(h!==null){a.pending=null;var O=h=h.next;do w=e(w,O.action),O=O.next;while(O!==h);Xo(w,t.memoizedState)||(da=!0),t.memoizedState=w,t.baseQueue===null&&(t.baseState=w),a.lastRenderedState=w}return[w,u]}function Tc(e,t,a){var u=Mn,h=Xr(),w=En;if(w){if(a===void 0)throw Error(s(407));a=a()}else a=t();var O=!Xo((In||h).memoizedState,a);if(O&&(h.memoizedState=a,da=!0),h=h.queue,ml(xl.bind(null,u,h,e),[e]),h.getSnapshot!==t||O||Ei!==null&&Ei.memoizedState.tag&1){if(u.flags|=2048,Bs(9,{destroy:void 0},Zu.bind(null,u,h,a,t),null),B===null)throw Error(s(349));w||(Gr&127)!==0||il(u,t,a)}return a}function il(e,t,a){e.flags|=16384,e={getSnapshot:t,value:a},t=Mn.updateQueue,t===null?(t=nc(),Mn.updateQueue=t,t.stores=[e]):(a=t.stores,a===null?t.stores=[e]:a.push(e))}function Zu(e,t,a,u){t.value=a,t.getSnapshot=u,wu(t)&&sc(e)}function xl(e,t,a){return a(function(){wu(t)&&sc(e)})}function wu(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!Xo(e,a)}catch{return!0}}function sc(e){var t=ll(e,2);t!==null&&Rt(t,e,2)}function Dl(e){var t=Uo();if(typeof e=="function"){var a=e;if(e=a(),Fo){vt(!0);try{a()}finally{vt(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:e},t}function Ju(e,t,a,u){return e.baseState=a,ac(e,In,typeof u=="function"?u:Ja)}function ou(e,t,a,u,h){if(su(e))throw Error(s(485));if(e=t.action,e!==null){var w={payload:h,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(O){w.listeners.push(O)}};te.T!==null?a(!0):w.isTransition=!1,u(w),a=t.pending,a===null?(w.next=t.pending=w,Qu(t,w)):(w.next=a.next,t.pending=a.next=w)}}function Qu(e,t){var a=t.action,u=t.payload,h=e.state;if(t.isTransition){var w=te.T,O={};te.T=O;try{var ue=a(h,u),Ue=te.S;Ue!==null&&Ue(O,ue),lc(e,t,ue)}catch(it){cc(e,t,it)}finally{w!==null&&O.types!==null&&(w.types=O.types),te.T=w}}else try{w=a(h,u),lc(e,t,w)}catch(it){cc(e,t,it)}}function lc(e,t,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(u){Su(e,t,u)},function(u){return cc(e,t,u)}):Su(e,t,a)}function Su(e,t,a){t.status="fulfilled",t.value=a,au(t),e.state=a,t=e.pending,t!==null&&(a=t.next,a===t?e.pending=null:(a=a.next,t.next=a,Qu(e,a)))}function cc(e,t,a){var u=e.pending;if(e.pending=null,u!==null){u=u.next;do t.status="rejected",t.reason=a,au(t),t=t.next;while(t!==u)}e.action=null}function au(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function uc(e,t){return t}function Ps(e,t){if(En){var a=B.formState;if(a!==null){e:{var u=Mn;if(En){if(Ir){t:{for(var h=Ir,w=oo;h.nodeType!==8;){if(!w){h=null;break t}if(h=pc(h.nextSibling),h===null){h=null;break t}}w=h.data,h=w==="F!"||w==="F"?h:null}if(h){Ir=pc(h.nextSibling),u=h.data==="F!";break e}}Ta(u)}u=!1}u&&(t=a[0])}}return a=Uo(),a.memoizedState=a.baseState=t,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:uc,lastRenderedState:t},a.queue=u,a=Cu.bind(null,Mn,u),u.dispatch=a,u=Dl(!1),w=Vc.bind(null,Mn,!1,u.queue),u=Uo(),h={state:t,dispatch:null,action:e,pending:null},u.queue=h,a=ou.bind(null,Mn,h,w,a),h.dispatch=a,u.memoizedState=e,[t,a,!1]}function ps(e){var t=Xr();return Ms(t,In,e)}function Ms(e,t,a){if(t=ac(e,t,uc)[0],e=oc(Ja)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var u=yl(t)}catch(O){throw O===Re?ke:O}else u=t;t=Xr();var h=t.queue,w=h.dispatch;return a!==t.memoizedState&&(Mn.flags|=2048,Bs(9,{destroy:void 0},dc.bind(null,h,a),null)),[u,w,e]}function dc(e,t){e.action=t}function Tu(e){var t=Xr(),a=In;if(a!==null)return Ms(t,a,e);Xr(),t=t.memoizedState,a=Xr();var u=a.queue.dispatch;return a.memoizedState=e,[t,u,!1]}function Bs(e,t,a,u){return e={tag:e,create:a,deps:u,inst:t,next:null},t=Mn.updateQueue,t===null&&(t=nc(),Mn.updateQueue=t),a=t.lastEffect,a===null?t.lastEffect=e.next=e:(u=a.next,a.next=e,e.next=u,t.lastEffect=e),e}function Nd(){return Xr().memoizedState}function Os(e,t,a,u){var h=Uo();Mn.flags|=e,h.memoizedState=Bs(1|t,{destroy:void 0},a,u===void 0?null:u)}function Qa(e,t,a,u){var h=Xr();u=u===void 0?null:u;var w=h.memoizedState.inst;In!==null&&u!==null&&Sc(u,In.memoizedState.deps)?h.memoizedState=Bs(t,w,a,u):(Mn.flags|=e,h.memoizedState=Bs(1|t,w,a,u))}function Rl(e,t){Os(8390656,8,e,t)}function ml(e,t){Qa(2048,8,e,t)}function kh(e){Mn.flags|=4;var t=Mn.updateQueue;if(t===null)t=nc(),Mn.updateQueue=t,t.events=[e];else{var a=t.events;a===null?t.events=[e]:a.push(e)}}function op(e){var t=Xr().memoizedState;return kh({ref:t,nextImpl:e}),function(){if((P&2)!==0)throw Error(s(440));return t.impl.apply(void 0,arguments)}}function ap(e,t){return Qa(4,2,e,t)}function sp(e,t){return Qa(4,4,e,t)}function lp(e,t){if(typeof t=="function"){e=e();var a=t(e);return function(){typeof a=="function"?a():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function cp(e,t,a){a=a!=null?a.concat([e]):null,Qa(4,4,lp.bind(null,t,e),a)}function kd(){}function ff(e,t){var a=Xr();t=t===void 0?null:t;var u=a.memoizedState;return t!==null&&Sc(t,u[1])?u[0]:(a.memoizedState=[e,t],e)}function Il(e,t){var a=Xr();t=t===void 0?null:t;var u=a.memoizedState;if(t!==null&&Sc(t,u[1]))return u[0];if(u=e(),Fo){vt(!0);try{e()}finally{vt(!1)}}return a.memoizedState=[u,t],u}function Ad(e,t,a){return a===void 0||(Gr&1073741824)!==0&&(ne&261930)===0?e.memoizedState=t:(e.memoizedState=a,e=Bn(),Mn.lanes|=e,me|=e,a)}function up(e,t,a,u){return Xo(a,t)?a:ii.current!==null?(e=Ad(e,a,u),Xo(e,t)||(da=!0),e):(Gr&42)===0||(Gr&1073741824)!==0&&(ne&261930)===0?(da=!0,e.memoizedState=a):(e=Bn(),Mn.lanes|=e,me|=e,t)}function dp(e,t,a,u,h){var w=de.p;de.p=w!==0&&8>w?w:8;var O=te.T,ue={};te.T=ue,Vc(e,!1,t,a);try{var Ue=h(),it=te.S;if(it!==null&&it(ue,Ue),Ue!==null&&typeof Ue=="object"&&typeof Ue.then=="function"){var St=X(Ue,u);Ll(e,t,St,Xn(e))}else Ll(e,t,u,Xn(e))}catch(_t){Ll(e,t,{then:function(){},status:"rejected",reason:_t},Xn())}finally{de.p=w,O!==null&&ue.types!==null&&(O.types=ue.types),te.T=O}}function Ah(){}function pf(e,t,a,u){if(e.tag!==5)throw Error(s(476));var h=fp(e).queue;dp(e,h,t,je,a===null?Ah:function(){return pp(e),a(u)})}function fp(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:je,baseState:je,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:je},next:null};var a={};return t.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:a},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function pp(e){var t=fp(e);t.next===null&&(t=e.alternate.memoizedState),Ll(e,t.next.queue,{},Xn())}function hf(){return ca(Uf)}function hp(){return Xr().memoizedState}function gp(){return Xr().memoizedState}function Ph(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var a=Xn();e=Yn(a);var u=gi(t,e,a);u!==null&&(Rt(u,t,a),tr(u,t,a)),t={cache:Bo()},e.payload=t;return}t=t.return}}function zh(e,t,a){var u=Xn();a={lane:u,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},su(e)?ju(t,a):(a=Lo(e,t,a,u),a!==null&&(Rt(a,e,u),Pd(a,t,u)))}function Cu(e,t,a){var u=Xn();Ll(e,t,a,u)}function Ll(e,t,a,u){var h={lane:u,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null};if(su(e))ju(t,h);else{var w=e.alternate;if(e.lanes===0&&(w===null||w.lanes===0)&&(w=t.lastRenderedReducer,w!==null))try{var O=t.lastRenderedState,ue=w(O,a);if(h.hasEagerState=!0,h.eagerState=ue,Xo(ue,O))return no(e,t,h,0),B===null&&Rr(),!1}catch{}finally{}if(a=Lo(e,t,h,u),a!==null)return Rt(a,e,u),Pd(a,t,u),!0}return!1}function Vc(e,t,a,u){if(u={lane:2,revertLane:Mh(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},su(e)){if(t)throw Error(s(479))}else t=Lo(e,a,u,2),t!==null&&Rt(t,e,2)}function su(e){var t=e.alternate;return e===Mn||t!==null&&t===Mn}function ju(e,t){yo=Oa=!0;var a=e.pending;a===null?t.next=t:(t.next=a.next,a.next=t),e.pending=t}function Pd(e,t,a){if((a&4194048)!==0){var u=t.lanes;u&=e.pendingLanes,a|=u,t.lanes=a,Cr(e,a)}}var Cc={readContext:ca,use:ic,useCallback:_r,useContext:_r,useEffect:_r,useImperativeHandle:_r,useLayoutEffect:_r,useInsertionEffect:_r,useMemo:_r,useReducer:_r,useRef:_r,useState:_r,useDebugValue:_r,useDeferredValue:_r,useTransition:_r,useSyncExternalStore:_r,useId:_r,useHostTransitionStatus:_r,useFormState:_r,useActionState:_r,useOptimistic:_r,useMemoCache:_r,useCacheRefresh:_r};Cc.useEffectEvent=_r;var Nu={readContext:ca,use:ic,useCallback:function(e,t){return Uo().memoizedState=[e,t===void 0?null:t],e},useContext:ca,useEffect:Rl,useImperativeHandle:function(e,t,a){a=a!=null?a.concat([e]):null,Os(4194308,4,lp.bind(null,t,e),a)},useLayoutEffect:function(e,t){return Os(4194308,4,e,t)},useInsertionEffect:function(e,t){Os(4,2,e,t)},useMemo:function(e,t){var a=Uo();t=t===void 0?null:t;var u=e();if(Fo){vt(!0);try{e()}finally{vt(!1)}}return a.memoizedState=[u,t],u},useReducer:function(e,t,a){var u=Uo();if(a!==void 0){var h=a(t);if(Fo){vt(!0);try{a(t)}finally{vt(!1)}}}else h=t;return u.memoizedState=u.baseState=h,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:h},u.queue=e,e=e.dispatch=zh.bind(null,Mn,e),[u.memoizedState,e]},useRef:function(e){var t=Uo();return e={current:e},t.memoizedState=e},useState:function(e){e=Dl(e);var t=e.queue,a=Cu.bind(null,Mn,t);return t.dispatch=a,[e.memoizedState,a]},useDebugValue:kd,useDeferredValue:function(e,t){var a=Uo();return Ad(a,e,t)},useTransition:function(){var e=Dl(!1);return e=dp.bind(null,Mn,e.queue,!0,!1),Uo().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,a){var u=Mn,h=Uo();if(En){if(a===void 0)throw Error(s(407));a=a()}else{if(a=t(),B===null)throw Error(s(349));(ne&127)!==0||il(u,t,a)}h.memoizedState=a;var w={value:a,getSnapshot:t};return h.queue=w,Rl(xl.bind(null,u,w,e),[e]),u.flags|=2048,Bs(9,{destroy:void 0},Zu.bind(null,u,w,a,t),null),a},useId:function(){var e=Uo(),t=B.identifierPrefix;if(En){var a=Mo,u=Co;a=(u&~(1<<32-Vt(u)-1)).toString(32)+a,t="_"+t+"R_"+a,a=so++,0<a&&(t+="H"+a.toString(32)),t+="_"}else a=wc++,t="_"+t+"r_"+a.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:hf,useFormState:Ps,useActionState:Ps,useOptimistic:function(e){var t=Uo();t.memoizedState=t.baseState=e;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=a,t=Vc.bind(null,Mn,!0,a),a.dispatch=t,[e,t]},useMemoCache:rc,useCacheRefresh:function(){return Uo().memoizedState=Ph.bind(null,Mn)},useEffectEvent:function(e){var t=Uo(),a={impl:e};return t.memoizedState=a,function(){if((P&2)!==0)throw Error(s(440));return a.impl.apply(void 0,arguments)}}},lu={readContext:ca,use:ic,useCallback:ff,useContext:ca,useEffect:ml,useImperativeHandle:cp,useInsertionEffect:ap,useLayoutEffect:sp,useMemo:Il,useReducer:oc,useRef:Nd,useState:function(){return oc(Ja)},useDebugValue:kd,useDeferredValue:function(e,t){var a=Xr();return up(a,In.memoizedState,e,t)},useTransition:function(){var e=oc(Ja)[0],t=Xr().memoizedState;return[typeof e=="boolean"?e:yl(e),t]},useSyncExternalStore:Tc,useId:hp,useHostTransitionStatus:hf,useFormState:ps,useActionState:ps,useOptimistic:function(e,t){var a=Xr();return Ju(a,In,e,t)},useMemoCache:rc,useCacheRefresh:gp};lu.useEffectEvent=op;var ed={readContext:ca,use:ic,useCallback:ff,useContext:ca,useEffect:ml,useImperativeHandle:cp,useInsertionEffect:ap,useLayoutEffect:sp,useMemo:Il,useReducer:Ec,useRef:Nd,useState:function(){return Ec(Ja)},useDebugValue:kd,useDeferredValue:function(e,t){var a=Xr();return In===null?Ad(a,e,t):up(a,In.memoizedState,e,t)},useTransition:function(){var e=Ec(Ja)[0],t=Xr().memoizedState;return[typeof e=="boolean"?e:yl(e),t]},useSyncExternalStore:Tc,useId:hp,useHostTransitionStatus:hf,useFormState:Tu,useActionState:Tu,useOptimistic:function(e,t){var a=Xr();return In!==null?Ju(a,In,e,t):(a.baseState=e,[e,a.queue.dispatch])},useMemoCache:rc,useCacheRefresh:gp};ed.useEffectEvent=op;function ku(e,t,a,u){t=e.memoizedState,a=a(u,t),a=a==null?t:D({},t,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var gf={enqueueSetState:function(e,t,a){e=e._reactInternals;var u=Xn(),h=Yn(u);h.payload=t,a!=null&&(h.callback=a),t=gi(e,h,u),t!==null&&(Rt(t,e,u),tr(t,e,u))},enqueueReplaceState:function(e,t,a){e=e._reactInternals;var u=Xn(),h=Yn(u);h.tag=1,h.payload=t,a!=null&&(h.callback=a),t=gi(e,h,u),t!==null&&(Rt(t,e,u),tr(t,e,u))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var a=Xn(),u=Yn(a);u.tag=2,t!=null&&(u.callback=t),t=gi(e,u,a),t!==null&&(Rt(t,e,a),tr(t,e,a))}};function zd(e,t,a,u,h,w,O){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(u,w,O):t.prototype&&t.prototype.isPureReactComponent?!va(a,u)||!va(h,w):!0}function Ml(e,t,a,u){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(a,u),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(a,u),t.state!==e&&gf.enqueueReplaceState(t,t.state,null)}function jc(e,t){var a=t;if("ref"in t){a={};for(var u in t)u!=="ref"&&(a[u]=t[u])}if(e=e.defaultProps){a===t&&(a=D({},a));for(var h in e)a[h]===void 0&&(a[h]=e[h])}return a}function yp(e){to(e)}function xp(e){console.error(e)}function Nc(e){to(e)}function _d(e,t){try{var a=e.onUncaughtError;a(t.value,{componentStack:t.stack})}catch(u){setTimeout(function(){throw u})}}function Dd(e,t,a){try{var u=e.onCaughtError;u(a.value,{componentStack:a.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(h){setTimeout(function(){throw h})}}function Rd(e,t,a){return a=Yn(a),a.tag=3,a.payload={element:null},a.callback=function(){_d(e,t)},a}function Id(e){return e=Yn(e),e.tag=3,e}function td(e,t,a,u){var h=a.type.getDerivedStateFromError;if(typeof h=="function"){var w=u.value;e.payload=function(){return h(w)},e.callback=function(){Dd(t,a,u)}}var O=a.stateNode;O!==null&&typeof O.componentDidCatch=="function"&&(e.callback=function(){Dd(t,a,u),typeof h!="function"&&(Ye===null?Ye=new Set([this]):Ye.add(this));var ue=u.stack;this.componentDidCatch(u.value,{componentStack:ue!==null?ue:""})})}function Ld(e,t,a,u,h){if(a.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(t=a.alternate,t!==null&&Xa(t,a,h,!0),a=Si.current,a!==null){switch(a.tag){case 31:case 13:return yi===null?Pp():a.alternate===null&&he===0&&(he=3),a.flags&=-257,a.flags|=65536,a.lanes=h,u===He?a.flags|=16384:(t=a.updateQueue,t===null?a.updateQueue=new Set([u]):t.add(u),Rh(e,u,h)),!1;case 22:return a.flags|=65536,u===He?a.flags|=16384:(t=a.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([u])},a.updateQueue=t):(a=t.retryQueue,a===null?t.retryQueue=new Set([u]):a.add(u)),Rh(e,u,h)),!1}throw Error(s(435,a.tag))}return Rh(e,u,h),Pp(),!1}if(En)return t=Si.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=h,u!==Sa&&(e=Error(s(422),{cause:u}),Fc(Cs(e,a)))):(u!==Sa&&(t=Error(s(423),{cause:u}),Fc(Cs(t,a))),e=e.current.alternate,e.flags|=65536,h&=-h,e.lanes|=h,u=Cs(u,a),h=Rd(e.stateNode,u,h),Pi(e,h),he!==4&&(he=2)),!1;var w=Error(s(520),{cause:u});if(w=Cs(w,a),Ze===null?Ze=[w]:Ze.push(w),he!==4&&(he=2),t===null)return!0;u=Cs(u,a),a=t;do{switch(a.tag){case 3:return a.flags|=65536,e=h&-h,a.lanes|=e,e=Rd(a.stateNode,u,e),Pi(a,e),!1;case 1:if(t=a.type,w=a.stateNode,(a.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Ye===null||!Ye.has(w))))return a.flags|=65536,h&=-h,a.lanes|=h,h=Id(h),td(h,e,a,u),Pi(a,h),!1}a=a.return}while(a!==null);return!1}var Au=Error(s(461)),da=!1;function Na(e,t,a,u){t.child=e===null?zn(t,null,a,u):Lr(t,e.child,a,u)}function Md(e,t,a,u,h){a=a.render;var w=t.ref;if("ref"in u){var O={};for(var ue in u)ue!=="ref"&&(O[ue]=u[ue])}else O=u;return Ql(t),u=hl(e,t,a,O,w,h),ue=gl(),e!==null&&!da?(ec(e,t,h),Fl(e,t,h)):(En&&ue&&Pl(t),t.flags|=1,Na(e,t,u,h),t.child)}function mp(e,t,a,u,h){if(e===null){var w=a.type;return typeof w=="function"&&!Mc(w)&&w.defaultProps===void 0&&a.compare===null?(t.tag=15,t.type=w,bp(e,t,w,u,h)):(e=cl(a.type,null,u,t,t.mode,h),e.ref=t.ref,e.return=t,t.child=e)}if(w=e.child,!sd(e,h)){var O=w.memoizedProps;if(a=a.compare,a=a!==null?a:va,a(O,u)&&e.ref===t.ref)return Fl(e,t,h)}return t.flags|=1,e=dr(w,u),e.ref=t.ref,e.return=t,t.child=e}function bp(e,t,a,u,h){if(e!==null){var w=e.memoizedProps;if(va(w,u)&&e.ref===t.ref)if(da=!1,t.pendingProps=u=w,sd(e,h))(e.flags&131072)!==0&&(da=!0);else return t.lanes=e.lanes,Fl(e,t,h)}return rd(e,t,a,u,h)}function Fs(e,t,a,u){var h=u.children,w=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((t.flags&128)!==0){if(w=w!==null?w.baseLanes|a:a,e!==null){for(u=t.child=e.child,h=0;u!==null;)h=h|u.lanes|u.childLanes,u=u.sibling;u=h&~w}else u=0,t.child=null;return Bl(e,t,w,a,u)}if((a&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&pe(t,w!==null?w.cachePool:null),w!==null?mr(t,w):ai(),Er(t);else return u=t.lanes=536870912,Bl(e,t,w!==null?w.baseLanes|a:a,a,u)}else w!==null?(pe(t,w.cachePool),mr(t,w),go(),t.memoizedState=null):(e!==null&&pe(t,null),ai(),go());return Na(e,t,h,a),t.child}function nd(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Bl(e,t,a,u,h){var w=ce();return w=w===null?null:{parent:Li._currentValue,pool:w},t.memoizedState={baseLanes:a,cachePool:w},e!==null&&pe(t,null),ai(),Er(t),e!==null&&Xa(e,t,u,!0),t.childLanes=h,null}function id(e,t){return t=od({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function cu(e,t,a){return Lr(t,e.child,null,a),e=id(t,t.pendingProps),e.flags|=2,zr(t),t.memoizedState=null,e}function vp(e,t,a){var u=t.pendingProps,h=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(En){if(u.mode==="hidden")return e=id(t,u),t.lanes=536870912,nd(null,e);if(Ui(t),(e=Ir)?(e=H0(e,oo),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Ga!==null?{id:Co,overflow:Mo}:null,retryLane:536870912,hydrationErrors:null},a=aa(e),a.return=t,t.child=a,fr=t,Ir=null)):e=null,e===null)throw Ta(t);return t.lanes=536870912,null}return id(t,u)}var w=e.memoizedState;if(w!==null){var O=w.dehydrated;if(Ui(t),h)if(t.flags&256)t.flags&=-257,t=cu(e,t,a);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(s(558));else if(da||Xa(e,t,a,!1),h=(a&e.childLanes)!==0,da||h){if(u=B,u!==null&&(O=jr(u,a),O!==0&&O!==w.retryLane))throw w.retryLane=O,ll(e,O),Rt(u,e,O),Au;Pp(),t=cu(e,t,a)}else e=w.treeContext,Ir=pc(O.nextSibling),fr=t,En=!0,la=null,oo=!1,e!==null&&Xu(t,e),t=id(t,u),t.flags|=4096;return t}return e=dr(e.child,{mode:u.mode,children:u.children}),e.ref=t.ref,t.child=e,e.return=t,e}function Ol(e,t){var a=t.ref;if(a===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(s(284));(e===null||e.ref!==a)&&(t.flags|=4194816)}}function rd(e,t,a,u,h){return Ql(t),a=hl(e,t,a,u,void 0,h),u=gl(),e!==null&&!da?(ec(e,t,h),Fl(e,t,h)):(En&&u&&Pl(t),t.flags|=1,Na(e,t,a,h),t.child)}function yf(e,t,a,u,h,w){return Ql(t),t.updateQueue=null,a=Za(t,u,a,h),Uc(e),u=gl(),e!==null&&!da?(ec(e,t,w),Fl(e,t,w)):(En&&u&&Pl(t),t.flags|=1,Na(e,t,a,w),t.child)}function xf(e,t,a,u,h){if(Ql(t),t.stateNode===null){var w=$r,O=a.contextType;typeof O=="object"&&O!==null&&(w=ca(O)),w=new a(u,w),t.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=gf,t.stateNode=w,w._reactInternals=t,w=t.stateNode,w.props=u,w.state=t.memoizedState,w.refs={},Xt(t),O=a.contextType,w.context=typeof O=="object"&&O!==null?ca(O):$r,w.state=t.memoizedState,O=a.getDerivedStateFromProps,typeof O=="function"&&(ku(t,a,O,u),w.state=t.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(O=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),O!==w.state&&gf.enqueueReplaceState(w,w.state,null),Ur(t,u,w,h),Yi(),w.state=t.memoizedState),typeof w.componentDidMount=="function"&&(t.flags|=4194308),u=!0}else if(e===null){w=t.stateNode;var ue=t.memoizedProps,Ue=jc(a,ue);w.props=Ue;var it=w.context,St=a.contextType;O=$r,typeof St=="object"&&St!==null&&(O=ca(St));var _t=a.getDerivedStateFromProps;St=typeof _t=="function"||typeof w.getSnapshotBeforeUpdate=="function",ue=t.pendingProps!==ue,St||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(ue||it!==O)&&Ml(t,w,u,O),Ut=!1;var rt=t.memoizedState;w.state=rt,Ur(t,u,w,h),Yi(),it=t.memoizedState,ue||rt!==it||Ut?(typeof _t=="function"&&(ku(t,a,_t,u),it=t.memoizedState),(Ue=Ut||zd(t,a,Ue,u,rt,it,O))?(St||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(t.flags|=4194308)):(typeof w.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=u,t.memoizedState=it),w.props=u,w.state=it,w.context=O,u=Ue):(typeof w.componentDidMount=="function"&&(t.flags|=4194308),u=!1)}else{w=t.stateNode,cr(e,t),O=t.memoizedProps,St=jc(a,O),w.props=St,_t=t.pendingProps,rt=w.context,it=a.contextType,Ue=$r,typeof it=="object"&&it!==null&&(Ue=ca(it)),ue=a.getDerivedStateFromProps,(it=typeof ue=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(O!==_t||rt!==Ue)&&Ml(t,w,u,Ue),Ut=!1,rt=t.memoizedState,w.state=rt,Ur(t,u,w,h),Yi();var ut=t.memoizedState;O!==_t||rt!==ut||Ut||e!==null&&e.dependencies!==null&&jo(e.dependencies)?(typeof ue=="function"&&(ku(t,a,ue,u),ut=t.memoizedState),(St=Ut||zd(t,a,St,u,rt,ut,Ue)||e!==null&&e.dependencies!==null&&jo(e.dependencies))?(it||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(u,ut,Ue),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(u,ut,Ue)),typeof w.componentDidUpdate=="function"&&(t.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof w.componentDidUpdate!="function"||O===e.memoizedProps&&rt===e.memoizedState||(t.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||O===e.memoizedProps&&rt===e.memoizedState||(t.flags|=1024),t.memoizedProps=u,t.memoizedState=ut),w.props=u,w.state=ut,w.context=Ue,u=St):(typeof w.componentDidUpdate!="function"||O===e.memoizedProps&&rt===e.memoizedState||(t.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||O===e.memoizedProps&&rt===e.memoizedState||(t.flags|=1024),u=!1)}return w=u,Ol(e,t),u=(t.flags&128)!==0,w||u?(w=t.stateNode,a=u&&typeof a.getDerivedStateFromError!="function"?null:w.render(),t.flags|=1,e!==null&&u?(t.child=Lr(t,e.child,null,h),t.child=Lr(t,null,a,h)):Na(e,t,a,h),t.memoizedState=w.state,e=t.child):e=Fl(e,t,h),e}function wp(e,t,a,u){return vc(),t.flags|=256,Na(e,t,a,u),t.child}var mf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function bf(e){return{baseLanes:e,cachePool:Te()}}function Pu(e,t,a){return e=e!==null?e.childLanes&~a:0,t&&(e|=Oe),e}function vf(e,t,a){var u=t.pendingProps,h=!1,w=(t.flags&128)!==0,O;if((O=w)||(O=e!==null&&e.memoizedState===null?!1:(si.current&2)!==0),O&&(h=!0,t.flags&=-129),O=(t.flags&32)!==0,t.flags&=-33,e===null){if(En){if(h?Xi(t):go(),(e=Ir)?(e=H0(e,oo),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Ga!==null?{id:Co,overflow:Mo}:null,retryLane:536870912,hydrationErrors:null},a=aa(e),a.return=t,t.child=a,fr=t,Ir=null)):e=null,e===null)throw Ta(t);return Xh(e)?t.lanes=32:t.lanes=536870912,null}var ue=u.children;return u=u.fallback,h?(go(),h=t.mode,ue=od({mode:"hidden",children:ue},h),u=ro(u,h,a,null),ue.return=t,u.return=t,ue.sibling=u,t.child=ue,u=t.child,u.memoizedState=bf(a),u.childLanes=Pu(e,O,a),t.memoizedState=mf,nd(null,u)):(Xi(t),wf(t,ue))}var Ue=e.memoizedState;if(Ue!==null&&(ue=Ue.dehydrated,ue!==null)){if(w)t.flags&256?(Xi(t),t.flags&=-257,t=uu(e,t,a)):t.memoizedState!==null?(go(),t.child=e.child,t.flags|=128,t=null):(go(),ue=u.fallback,h=t.mode,u=od({mode:"visible",children:u.children},h),ue=ro(ue,h,a,null),ue.flags|=2,u.return=t,ue.return=t,u.sibling=ue,t.child=u,Lr(t,e.child,null,a),u=t.child,u.memoizedState=bf(a),u.childLanes=Pu(e,O,a),t.memoizedState=mf,t=nd(null,u));else if(Xi(t),Xh(ue)){if(O=ue.nextSibling&&ue.nextSibling.dataset,O)var it=O.dgst;O=it,u=Error(s(419)),u.stack="",u.digest=O,Fc({value:u,source:null,stack:null}),t=uu(e,t,a)}else if(da||Xa(e,t,a,!1),O=(a&e.childLanes)!==0,da||O){if(O=B,O!==null&&(u=jr(O,a),u!==0&&u!==Ue.retryLane))throw Ue.retryLane=u,ll(e,u),Rt(O,e,u),Au;Gh(ue)||Pp(),t=uu(e,t,a)}else Gh(ue)?(t.flags|=192,t.child=e.child,t=null):(e=Ue.treeContext,Ir=pc(ue.nextSibling),fr=t,En=!0,la=null,oo=!1,e!==null&&Xu(t,e),t=wf(t,u.children),t.flags|=4096);return t}return h?(go(),ue=u.fallback,h=t.mode,Ue=e.child,it=Ue.sibling,u=dr(Ue,{mode:"hidden",children:u.children}),u.subtreeFlags=Ue.subtreeFlags&65011712,it!==null?ue=dr(it,ue):(ue=ro(ue,h,a,null),ue.flags|=2),ue.return=t,u.return=t,u.sibling=ue,t.child=u,nd(null,u),u=t.child,ue=e.child.memoizedState,ue===null?ue=bf(a):(h=ue.cachePool,h!==null?(Ue=Li._currentValue,h=h.parent!==Ue?{parent:Ue,pool:Ue}:h):h=Te(),ue={baseLanes:ue.baseLanes|a,cachePool:h}),u.memoizedState=ue,u.childLanes=Pu(e,O,a),t.memoizedState=mf,nd(e.child,u)):(Xi(t),a=e.child,e=a.sibling,a=dr(a,{mode:"visible",children:u.children}),a.return=t,a.sibling=null,e!==null&&(O=t.deletions,O===null?(t.deletions=[e],t.flags|=16):O.push(e)),t.child=a,t.memoizedState=null,a)}function wf(e,t){return t=od({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function od(e,t){return e=Ti(22,e,null,t),e.lanes=0,e}function uu(e,t,a){return Lr(t,e.child,null,a),e=wf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Sp(e,t,a){e.lanes|=t;var u=e.alternate;u!==null&&(u.lanes|=t),As(e.return,t,a)}function ad(e,t,a,u,h,w){var O=e.memoizedState;O===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:u,tail:a,tailMode:h,treeForkCount:w}:(O.isBackwards=t,O.rendering=null,O.renderingStartTime=0,O.last=u,O.tail=a,O.tailMode=h,O.treeForkCount=w)}function Sf(e,t,a){var u=t.pendingProps,h=u.revealOrder,w=u.tail;u=u.children;var O=si.current,ue=(O&2)!==0;if(ue?(O=O&1|2,t.flags|=128):O&=1,q(si,O),Na(e,t,u,a),u=En?Al:0,!ue&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Sp(e,a,t);else if(e.tag===19)Sp(e,a,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(h){case"forwards":for(a=t.child,h=null;a!==null;)e=a.alternate,e!==null&&Oo(e)===null&&(h=a),a=a.sibling;a=h,a===null?(h=t.child,t.child=null):(h=a.sibling,a.sibling=null),ad(t,!1,h,a,w,u);break;case"backwards":case"unstable_legacy-backwards":for(a=null,h=t.child,t.child=null;h!==null;){if(e=h.alternate,e!==null&&Oo(e)===null){t.child=h;break}e=h.sibling,h.sibling=a,a=h,h=e}ad(t,!0,a,null,w,u);break;case"together":ad(t,!1,null,null,void 0,u);break;default:t.memoizedState=null}return t.child}function Fl(e,t,a){if(e!==null&&(t.dependencies=e.dependencies),me|=t.lanes,(a&t.childLanes)===0)if(e!==null){if(Xa(e,t,a,!1),(a&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(s(153));if(t.child!==null){for(e=t.child,a=dr(e,e.pendingProps),t.child=a,a.return=t;e.sibling!==null;)e=e.sibling,a=a.sibling=dr(e,e.pendingProps),a.return=t;a.sibling=null}return t.child}function sd(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&jo(e)))}function _h(e,t,a){switch(t.tag){case 3:_e(t,t.stateNode.containerInfo),zl(t,Li,e.memoizedState.cache),vc();break;case 27:case 5:De(t);break;case 4:_e(t,t.stateNode.containerInfo);break;case 10:zl(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,Ui(t),null;break;case 13:var u=t.memoizedState;if(u!==null)return u.dehydrated!==null?(Xi(t),t.flags|=128,null):(a&t.child.childLanes)!==0?vf(e,t,a):(Xi(t),e=Fl(e,t,a),e!==null?e.sibling:null);Xi(t);break;case 19:var h=(e.flags&128)!==0;if(u=(a&t.childLanes)!==0,u||(Xa(e,t,a,!1),u=(a&t.childLanes)!==0),h){if(u)return Sf(e,t,a);t.flags|=128}if(h=t.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),q(si,si.current),u)break;return null;case 22:return t.lanes=0,Fs(e,t,a,t.pendingProps);case 24:zl(t,Li,e.memoizedState.cache)}return Fl(e,t,a)}function Tp(e,t,a){if(e!==null)if(e.memoizedProps!==t.pendingProps)da=!0;else{if(!sd(e,a)&&(t.flags&128)===0)return da=!1,_h(e,t,a);da=(e.flags&131072)!==0}else da=!1,En&&(t.flags&1048576)!==0&&ru(t,Al,t.index);switch(t.lanes=0,t.tag){case 16:e:{var u=t.pendingProps;if(e=et(t.elementType),t.type=e,typeof e=="function")Mc(e)?(u=jc(e,u),t.tag=1,t=xf(null,t,e,u,a)):(t.tag=0,t=rd(null,t,e,u,a));else{if(e!=null){var h=e.$$typeof;if(h===E){t.tag=11,t=Md(null,t,e,u,a);break e}else if(h===G){t.tag=14,t=mp(null,t,e,u,a);break e}}throw t=Y(e)||e,Error(s(306,t,""))}}return t;case 0:return rd(e,t,t.type,t.pendingProps,a);case 1:return u=t.type,h=jc(u,t.pendingProps),xf(e,t,u,h,a);case 3:e:{if(_e(t,t.stateNode.containerInfo),e===null)throw Error(s(387));u=t.pendingProps;var w=t.memoizedState;h=w.element,cr(e,t),Ur(t,u,null,a);var O=t.memoizedState;if(u=O.cache,zl(t,Li,u),u!==w.cache&&Yr(t,[Li],a,!0),Yi(),u=O.element,w.isDehydrated)if(w={element:u,isDehydrated:!1,cache:O.cache},t.updateQueue.baseState=w,t.memoizedState=w,t.flags&256){t=wp(e,t,u,a);break e}else if(u!==h){h=Cs(Error(s(424)),t),Fc(h),t=wp(e,t,u,a);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Ir=pc(e.firstChild),fr=t,En=!0,la=null,oo=!0,a=zn(t,null,u,a),t.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling}else{if(vc(),u===h){t=Fl(e,t,a);break e}Na(e,t,u,a)}t=t.child}return t;case 26:return Ol(e,t),e===null?(a=K0(t.type,null,t.pendingProps,null))?t.memoizedState=a:En||(a=t.type,e=t.pendingProps,u=Mp(Ce.current).createElement(a),u[Dt]=t,u[an]=e,zs(u,a,e),Hn(u),t.stateNode=u):t.memoizedState=K0(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return De(t),e===null&&En&&(u=t.stateNode=Y0(t.type,t.pendingProps,Ce.current),fr=t,oo=!0,h=Ir,Iu(t.type)?(Kh=h,Ir=pc(u.firstChild)):Ir=h),Na(e,t,t.pendingProps.children,a),Ol(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&En&&((h=u=Ir)&&(u=Am(u,t.type,t.pendingProps,oo),u!==null?(t.stateNode=u,fr=t,Ir=pc(u.firstChild),oo=!1,h=!0):h=!1),h||Ta(t)),De(t),h=t.type,w=t.pendingProps,O=e!==null?e.memoizedProps:null,u=w.children,Wh(h,w)?u=null:O!==null&&Wh(h,O)&&(t.flags|=32),t.memoizedState!==null&&(h=hl(e,t,Ku,null,null,a),Uf._currentValue=h),Ol(e,t),Na(e,t,u,a),t.child;case 6:return e===null&&En&&((e=a=Ir)&&(a=Pm(a,t.pendingProps,oo),a!==null?(t.stateNode=a,fr=t,Ir=null,e=!0):e=!1),e||Ta(t)),null;case 13:return vf(e,t,a);case 4:return _e(t,t.stateNode.containerInfo),u=t.pendingProps,e===null?t.child=Lr(t,null,u,a):Na(e,t,u,a),t.child;case 11:return Md(e,t,t.type,t.pendingProps,a);case 7:return Na(e,t,t.pendingProps,a),t.child;case 8:return Na(e,t,t.pendingProps.children,a),t.child;case 12:return Na(e,t,t.pendingProps.children,a),t.child;case 10:return u=t.pendingProps,zl(t,t.type,u.value),Na(e,t,u.children,a),t.child;case 9:return h=t.type._context,u=t.pendingProps.children,Ql(t),h=ca(h),u=u(h),t.flags|=1,Na(e,t,u,a),t.child;case 14:return mp(e,t,t.type,t.pendingProps,a);case 15:return bp(e,t,t.type,t.pendingProps,a);case 19:return Sf(e,t,a);case 31:return vp(e,t,a);case 22:return Fs(e,t,a,t.pendingProps);case 24:return Ql(t),u=ca(Li),e===null?(h=ce(),h===null&&(h=B,w=Bo(),h.pooledCache=w,w.refCount++,w!==null&&(h.pooledCacheLanes|=a),h=w),t.memoizedState={parent:u,cache:h},Xt(t),zl(t,Li,h)):((e.lanes&a)!==0&&(cr(e,t),Ur(t,null,null,a),Yi()),h=e.memoizedState,w=t.memoizedState,h.parent!==u?(h={parent:u,cache:u},t.memoizedState=h,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=h),zl(t,Li,u)):(u=w.cache,zl(t,Li,u),u!==h.cache&&Yr(t,[Li],a,!0))),Na(e,t,t.pendingProps.children,a),t.child;case 29:throw t.pendingProps}throw Error(s(156,t.tag))}function Ul(e){e.flags|=4}function du(e,t,a,u,h){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(h&335544128)===h)if(e.stateNode.complete)e.flags|=8192;else if(rl())e.flags|=8192;else throw pt=He,Ee}else e.flags&=-16777217}function Bd(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!t1(t))if(rl())e.flags|=8192;else throw pt=He,Ee}function fc(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?zi():536870912,e.lanes|=t,Fe|=t)}function ld(e,t){if(!En)switch(e.tailMode){case"hidden":t=e.tail;for(var a=null;t!==null;)t.alternate!==null&&(a=t),t=t.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var u=null;a!==null;)a.alternate!==null&&(u=a),a=a.sibling;u===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:u.sibling=null}}function ir(e){var t=e.alternate!==null&&e.alternate.child===e.child,a=0,u=0;if(t)for(var h=e.child;h!==null;)a|=h.lanes|h.childLanes,u|=h.subtreeFlags&65011712,u|=h.flags&65011712,h.return=e,h=h.sibling;else for(h=e.child;h!==null;)a|=h.lanes|h.childLanes,u|=h.subtreeFlags,u|=h.flags,h.return=e,h=h.sibling;return e.subtreeFlags|=u,e.childLanes=a,t}function cd(e,t,a){var u=t.pendingProps;switch(Ns(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ir(t),null;case 1:return ir(t),null;case 3:return a=t.stateNode,u=null,e!==null&&(u=e.memoizedState.cache),t.memoizedState.cache!==u&&(t.flags|=2048),ks(Li),be(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(Fr(t)?Ul(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,bu())),ir(t),null;case 26:var h=t.type,w=t.memoizedState;return e===null?(Ul(t),w!==null?(ir(t),Bd(t,w)):(ir(t),du(t,h,null,u,a))):w?w!==e.memoizedState?(Ul(t),ir(t),Bd(t,w)):(ir(t),t.flags&=-16777217):(e=e.memoizedProps,e!==u&&Ul(t),ir(t),du(t,h,e,u,a)),null;case 27:if(Ge(t),a=Ce.current,h=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==u&&Ul(t);else{if(!u){if(t.stateNode===null)throw Error(s(166));return ir(t),null}e=W.current,Fr(t)?Oc(t):(e=Y0(h,u,a),t.stateNode=e,Ul(t))}return ir(t),null;case 5:if(Ge(t),h=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==u&&Ul(t);else{if(!u){if(t.stateNode===null)throw Error(s(166));return ir(t),null}if(w=W.current,Fr(t))Oc(t);else{var O=Mp(Ce.current);switch(w){case 1:w=O.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:w=O.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":w=O.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":w=O.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":w=O.createElement("div"),w.innerHTML="<script><\/script>",w=w.removeChild(w.firstChild);break;case"select":w=typeof u.is=="string"?O.createElement("select",{is:u.is}):O.createElement("select"),u.multiple?w.multiple=!0:u.size&&(w.size=u.size);break;default:w=typeof u.is=="string"?O.createElement(h,{is:u.is}):O.createElement(h)}}w[Dt]=t,w[an]=u;e:for(O=t.child;O!==null;){if(O.tag===5||O.tag===6)w.appendChild(O.stateNode);else if(O.tag!==4&&O.tag!==27&&O.child!==null){O.child.return=O,O=O.child;continue}if(O===t)break e;for(;O.sibling===null;){if(O.return===null||O.return===t)break e;O=O.return}O.sibling.return=O.return,O=O.sibling}t.stateNode=w;e:switch(zs(w,h,u),h){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&Ul(t)}}return ir(t),du(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,a),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==u&&Ul(t);else{if(typeof u!="string"&&t.stateNode===null)throw Error(s(166));if(e=Ce.current,Fr(t)){if(e=t.stateNode,a=t.memoizedProps,u=null,h=fr,h!==null)switch(h.tag){case 27:case 5:u=h.memoizedProps}e[Dt]=t,e=!!(e.nodeValue===a||u!==null&&u.suppressHydrationWarning===!0||M0(e.nodeValue,a)),e||Ta(t,!0)}else e=Mp(e).createTextNode(u),e[Dt]=t,t.stateNode=e}return ir(t),null;case 31:if(a=t.memoizedState,e===null||e.memoizedState!==null){if(u=Fr(t),a!==null){if(e===null){if(!u)throw Error(s(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(557));e[Dt]=t}else vc(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;ir(t),e=!1}else a=bu(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=a),e=!0;if(!e)return t.flags&256?(zr(t),t):(zr(t),null);if((t.flags&128)!==0)throw Error(s(558))}return ir(t),null;case 13:if(u=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(h=Fr(t),u!==null&&u.dehydrated!==null){if(e===null){if(!h)throw Error(s(318));if(h=t.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(s(317));h[Dt]=t}else vc(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;ir(t),h=!1}else h=bu(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=h),h=!0;if(!h)return t.flags&256?(zr(t),t):(zr(t),null)}return zr(t),(t.flags&128)!==0?(t.lanes=a,t):(a=u!==null,e=e!==null&&e.memoizedState!==null,a&&(u=t.child,h=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(h=u.alternate.memoizedState.cachePool.pool),w=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(w=u.memoizedState.cachePool.pool),w!==h&&(u.flags|=2048)),a!==e&&a&&(t.child.flags|=8192),fc(t,t.updateQueue),ir(t),null);case 4:return be(),e===null&&Uh(t.stateNode.containerInfo),ir(t),null;case 10:return ks(t.type),ir(t),null;case 19:if(A(si),u=t.memoizedState,u===null)return ir(t),null;if(h=(t.flags&128)!==0,w=u.rendering,w===null)if(h)ld(u,!1);else{if(he!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(w=Oo(e),w!==null){for(t.flags|=128,ld(u,!1),e=w.updateQueue,t.updateQueue=e,fc(t,e),t.subtreeFlags=0,e=a,a=t.child;a!==null;)io(a,e),a=a.sibling;return q(si,si.current&1|2),En&&La(t,u.treeForkCount),t.child}e=e.sibling}u.tail!==null&&xn()>cn&&(t.flags|=128,h=!0,ld(u,!1),t.lanes=4194304)}else{if(!h)if(e=Oo(w),e!==null){if(t.flags|=128,h=!0,e=e.updateQueue,t.updateQueue=e,fc(t,e),ld(u,!0),u.tail===null&&u.tailMode==="hidden"&&!w.alternate&&!En)return ir(t),null}else 2*xn()-u.renderingStartTime>cn&&a!==536870912&&(t.flags|=128,h=!0,ld(u,!1),t.lanes=4194304);u.isBackwards?(w.sibling=t.child,t.child=w):(e=u.last,e!==null?e.sibling=w:t.child=w,u.last=w)}return u.tail!==null?(e=u.tail,u.rendering=e,u.tail=e.sibling,u.renderingStartTime=xn(),e.sibling=null,a=si.current,q(si,h?a&1|2:a&1),En&&La(t,u.treeForkCount),e):(ir(t),null);case 22:case 23:return zr(t),nr(),u=t.memoizedState!==null,e!==null?e.memoizedState!==null!==u&&(t.flags|=8192):u&&(t.flags|=8192),u?(a&536870912)!==0&&(t.flags&128)===0&&(ir(t),t.subtreeFlags&6&&(t.flags|=8192)):ir(t),a=t.updateQueue,a!==null&&fc(t,a.retryQueue),a=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),u=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(u=t.memoizedState.cachePool.pool),u!==a&&(t.flags|=2048),e!==null&&A(oe),null;case 24:return a=null,e!==null&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),ks(Li),ir(t),null;case 25:return null;case 30:return null}throw Error(s(156,t.tag))}function Tf(e,t){switch(Ns(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ks(Li),be(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Ge(t),null;case 31:if(t.memoizedState!==null){if(zr(t),t.alternate===null)throw Error(s(340));vc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(zr(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(s(340));vc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return A(si),null;case 4:return be(),null;case 10:return ks(t.type),null;case 22:case 23:return zr(t),nr(),e!==null&&A(oe),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return ks(Li),null;case 25:return null;default:return null}}function Od(e,t){switch(Ns(t),t.tag){case 3:ks(Li),be();break;case 26:case 27:case 5:Ge(t);break;case 4:be();break;case 31:t.memoizedState!==null&&zr(t);break;case 13:zr(t);break;case 19:A(si);break;case 10:ks(t.type);break;case 22:case 23:zr(t),nr(),e!==null&&A(oe);break;case 24:ks(Li)}}function fu(e,t){try{var a=t.updateQueue,u=a!==null?a.lastEffect:null;if(u!==null){var h=u.next;a=h;do{if((a.tag&e)===e){u=void 0;var w=a.create,O=a.inst;u=w(),O.destroy=u}a=a.next}while(a!==h)}}catch(ue){Vr(t,t.return,ue)}}function Eo(e,t,a){try{var u=t.updateQueue,h=u!==null?u.lastEffect:null;if(h!==null){var w=h.next;u=w;do{if((u.tag&e)===e){var O=u.inst,ue=O.destroy;if(ue!==void 0){O.destroy=void 0,h=t;var Ue=a,it=ue;try{it()}catch(St){Vr(h,Ue,St)}}}u=u.next}while(u!==w)}}catch(St){Vr(t,t.return,St)}}function Cf(e){var t=e.updateQueue;if(t!==null){var a=e.stateNode;try{Pr(t,a)}catch(u){Vr(e,e.return,u)}}}function jf(e,t,a){a.props=jc(e.type,e.memoizedProps),a.state=e.memoizedState;try{a.componentWillUnmount()}catch(u){Vr(e,t,u)}}function ud(e,t){try{var a=e.ref;if(a!==null){switch(e.tag){case 26:case 27:case 5:var u=e.stateNode;break;case 30:u=e.stateNode;break;default:u=e.stateNode}typeof a=="function"?e.refCleanup=a(u):a.current=u}}catch(h){Vr(e,t,h)}}function El(e,t){var a=e.ref,u=e.refCleanup;if(a!==null)if(typeof u=="function")try{u()}catch(h){Vr(e,t,h)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(h){Vr(e,t,h)}else a.current=null}function Cp(e){var t=e.type,a=e.memoizedProps,u=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":a.autoFocus&&u.focus();break e;case"img":a.src?u.src=a.src:a.srcSet&&(u.srcset=a.srcSet)}}catch(h){Vr(e,e.return,h)}}function Fd(e,t,a){try{var u=e.stateNode;Sm(u,e.type,a,t),u[an]=t}catch(h){Vr(e,e.return,h)}}function Nf(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Iu(e.type)||e.tag===4}function zu(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Nf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Iu(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Vl(e,t,a){var u=e.tag;if(u===5||u===6)e=e.stateNode,t?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(e,t):(t=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,t.appendChild(e),a=a._reactRootContainer,a!=null||t.onclick!==null||(t.onclick=xr));else if(u!==4&&(u===27&&Iu(e.type)&&(a=e.stateNode,t=null),e=e.child,e!==null))for(Vl(e,t,a),e=e.sibling;e!==null;)Vl(e,t,a),e=e.sibling}function _u(e,t,a){var u=e.tag;if(u===5||u===6)e=e.stateNode,t?a.insertBefore(e,t):a.appendChild(e);else if(u!==4&&(u===27&&Iu(e.type)&&(a=e.stateNode),e=e.child,e!==null))for(_u(e,t,a),e=e.sibling;e!==null;)_u(e,t,a),e=e.sibling}function jp(e){var t=e.stateNode,a=e.memoizedProps;try{for(var u=e.type,h=t.attributes;h.length;)t.removeAttributeNode(h[0]);zs(t,u,a),t[Dt]=e,t[an]=a}catch(w){Vr(e,e.return,w)}}var kc=!1,fa=!1,Ud=!1,dd=typeof WeakSet=="function"?WeakSet:Set,ko=null;function kf(e,t){if(e=e.containerInfo,qh=qp,e=jl(e),wo(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{a=(a=e.ownerDocument)&&a.defaultView||window;var u=a.getSelection&&a.getSelection();if(u&&u.rangeCount!==0){a=u.anchorNode;var h=u.anchorOffset,w=u.focusNode;u=u.focusOffset;try{a.nodeType,w.nodeType}catch{a=null;break e}var O=0,ue=-1,Ue=-1,it=0,St=0,_t=e,rt=null;t:for(;;){for(var ut;_t!==a||h!==0&&_t.nodeType!==3||(ue=O+h),_t!==w||u!==0&&_t.nodeType!==3||(Ue=O+u),_t.nodeType===3&&(O+=_t.nodeValue.length),(ut=_t.firstChild)!==null;)rt=_t,_t=ut;for(;;){if(_t===e)break t;if(rt===a&&++it===h&&(ue=O),rt===w&&++St===u&&(Ue=O),(ut=_t.nextSibling)!==null)break;_t=rt,rt=_t.parentNode}_t=ut}a=ue===-1||Ue===-1?null:{start:ue,end:Ue}}else a=null}a=a||{start:0,end:0}}else a=null;for(Hh={focusedElem:e,selectionRange:a},qp=!1,ko=t;ko!==null;)if(t=ko,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ko=e;else for(;ko!==null;){switch(t=ko,w=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(a=0;a<e.length;a++)h=e[a],h.ref.impl=h.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&w!==null){e=void 0,a=t,h=w.memoizedProps,w=w.memoizedState,u=a.stateNode;try{var Nn=jc(a.type,h);e=u.getSnapshotBeforeUpdate(Nn,w),u.__reactInternalSnapshotBeforeUpdate=e}catch(ei){Vr(a,a.return,ei)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,a=e.nodeType,a===9)Yh(e);else if(a===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Yh(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(s(163))}if(e=t.sibling,e!==null){e.return=t.return,ko=e;break}ko=t.return}}function qc(e,t,a){var u=a.flags;switch(a.tag){case 0:case 11:case 15:ql(e,a),u&4&&fu(5,a);break;case 1:if(ql(e,a),u&4)if(e=a.stateNode,t===null)try{e.componentDidMount()}catch(O){Vr(a,a.return,O)}else{var h=jc(a.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(h,t,e.__reactInternalSnapshotBeforeUpdate)}catch(O){Vr(a,a.return,O)}}u&64&&Cf(a),u&512&&ud(a,a.return);break;case 3:if(ql(e,a),u&64&&(e=a.updateQueue,e!==null)){if(t=null,a.child!==null)switch(a.child.tag){case 27:case 5:t=a.child.stateNode;break;case 1:t=a.child.stateNode}try{Pr(e,t)}catch(O){Vr(a,a.return,O)}}break;case 27:t===null&&u&4&&jp(a);case 26:case 5:ql(e,a),t===null&&u&4&&Cp(a),u&512&&ud(a,a.return);break;case 12:ql(e,a);break;case 31:ql(e,a),u&4&&Np(e,a);break;case 13:ql(e,a),u&4&&kp(e,a),u&64&&(e=a.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(a=um.bind(null,a),zm(e,a))));break;case 22:if(u=a.memoizedState!==null||kc,!u){t=t!==null&&t.memoizedState!==null||fa,h=kc;var w=fa;kc=u,(fa=t)&&!w?Pc(e,a,(a.subtreeFlags&8772)!==0):ql(e,a),kc=h,fa=w}break;case 30:break;default:ql(e,a)}}function Af(e){var t=e.alternate;t!==null&&(e.alternate=null,Af(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Br(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var xo=null,Us=!1;function bl(e,t,a){for(a=a.child;a!==null;)fd(e,t,a),a=a.sibling}function fd(e,t,a){if(Ke&&typeof Ke.onCommitFiberUnmount=="function")try{Ke.onCommitFiberUnmount(Nt,a)}catch{}switch(a.tag){case 26:fa||El(a,t),bl(e,t,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:fa||El(a,t);var u=xo,h=Us;Iu(a.type)&&(xo=a.stateNode,Us=!1),bl(e,t,a),Bf(a.stateNode),xo=u,Us=h;break;case 5:fa||El(a,t);case 6:if(u=xo,h=Us,xo=null,bl(e,t,a),xo=u,Us=h,xo!==null)if(Us)try{(xo.nodeType===9?xo.body:xo.nodeName==="HTML"?xo.ownerDocument.body:xo).removeChild(a.stateNode)}catch(w){Vr(a,t,w)}else try{xo.removeChild(a.stateNode)}catch(w){Vr(a,t,w)}break;case 18:xo!==null&&(Us?(e=xo,V0(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,a.stateNode),Gd(e)):V0(xo,a.stateNode));break;case 4:u=xo,h=Us,xo=a.stateNode.containerInfo,Us=!0,bl(e,t,a),xo=u,Us=h;break;case 0:case 11:case 14:case 15:Eo(2,a,t),fa||Eo(4,a,t),bl(e,t,a);break;case 1:fa||(El(a,t),u=a.stateNode,typeof u.componentWillUnmount=="function"&&jf(a,t,u)),bl(e,t,a);break;case 21:bl(e,t,a);break;case 22:fa=(u=fa)||a.memoizedState!==null,bl(e,t,a),fa=u;break;default:bl(e,t,a)}}function Np(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Gd(e)}catch(a){Vr(t,t.return,a)}}}function kp(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Gd(e)}catch(a){Vr(t,t.return,a)}}function pd(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new dd),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new dd),t;default:throw Error(s(435,e.tag))}}function Hc(e,t){var a=pd(e);t.forEach(function(u){if(!a.has(u)){a.add(u);var h=dm.bind(null,e,u);u.then(h,h)}})}function Es(e,t){var a=t.deletions;if(a!==null)for(var u=0;u<a.length;u++){var h=a[u],w=e,O=t,ue=O;e:for(;ue!==null;){switch(ue.tag){case 27:if(Iu(ue.type)){xo=ue.stateNode,Us=!1;break e}break;case 5:xo=ue.stateNode,Us=!1;break e;case 3:case 4:xo=ue.stateNode.containerInfo,Us=!0;break e}ue=ue.return}if(xo===null)throw Error(s(160));fd(w,O,h),xo=null,Us=!1,w=h.alternate,w!==null&&(w.return=null),h.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)Ed(t,e),t=t.sibling}var vl=null;function Ed(e,t){var a=e.alternate,u=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Es(t,e),Vs(e),u&4&&(Eo(3,e,e.return),fu(3,e),Eo(5,e,e.return));break;case 1:Es(t,e),Vs(e),u&512&&(fa||a===null||El(a,a.return)),u&64&&kc&&(e=e.updateQueue,e!==null&&(u=e.callbacks,u!==null&&(a=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=a===null?u:a.concat(u))));break;case 26:var h=vl;if(Es(t,e),Vs(e),u&512&&(fa||a===null||El(a,a.return)),u&4){var w=a!==null?a.memoizedState:null;if(u=e.memoizedState,a===null)if(u===null)if(e.stateNode===null){e:{u=e.type,a=e.memoizedProps,h=h.ownerDocument||h;t:switch(u){case"title":w=h.getElementsByTagName("title")[0],(!w||w[qi]||w[Dt]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=h.createElement(u),h.head.insertBefore(w,h.querySelector("head > title"))),zs(w,u,a),w[Dt]=e,Hn(w),u=w;break e;case"link":var O=Q0("link","href",h).get(u+(a.href||""));if(O){for(var ue=0;ue<O.length;ue++)if(w=O[ue],w.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&w.getAttribute("rel")===(a.rel==null?null:a.rel)&&w.getAttribute("title")===(a.title==null?null:a.title)&&w.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){O.splice(ue,1);break t}}w=h.createElement(u),zs(w,u,a),h.head.appendChild(w);break;case"meta":if(O=Q0("meta","content",h).get(u+(a.content||""))){for(ue=0;ue<O.length;ue++)if(w=O[ue],w.getAttribute("content")===(a.content==null?null:""+a.content)&&w.getAttribute("name")===(a.name==null?null:a.name)&&w.getAttribute("property")===(a.property==null?null:a.property)&&w.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&w.getAttribute("charset")===(a.charSet==null?null:a.charSet)){O.splice(ue,1);break t}}w=h.createElement(u),zs(w,u,a),h.head.appendChild(w);break;default:throw Error(s(468,u))}w[Dt]=e,Hn(w),u=w}e.stateNode=u}else e1(h,e.type,e.stateNode);else e.stateNode=J0(h,u,e.memoizedProps);else w!==u?(w===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):w.count--,u===null?e1(h,e.type,e.stateNode):J0(h,u,e.memoizedProps)):u===null&&e.stateNode!==null&&Fd(e,e.memoizedProps,a.memoizedProps)}break;case 27:Es(t,e),Vs(e),u&512&&(fa||a===null||El(a,a.return)),a!==null&&u&4&&Fd(e,e.memoizedProps,a.memoizedProps);break;case 5:if(Es(t,e),Vs(e),u&512&&(fa||a===null||El(a,a.return)),e.flags&32){h=e.stateNode;try{ji(h,"")}catch(Nn){Vr(e,e.return,Nn)}}u&4&&e.stateNode!=null&&(h=e.memoizedProps,Fd(e,h,a!==null?a.memoizedProps:h)),u&1024&&(Ud=!0);break;case 6:if(Es(t,e),Vs(e),u&4){if(e.stateNode===null)throw Error(s(162));u=e.memoizedProps,a=e.stateNode;try{a.nodeValue=u}catch(Nn){Vr(e,e.return,Nn)}}break;case 3:if(Fp=null,h=vl,vl=Bp(t.containerInfo),Es(t,e),vl=h,Vs(e),u&4&&a!==null&&a.memoizedState.isDehydrated)try{Gd(t.containerInfo)}catch(Nn){Vr(e,e.return,Nn)}Ud&&(Ud=!1,Pf(e));break;case 4:u=vl,vl=Bp(e.stateNode.containerInfo),Es(t,e),Vs(e),vl=u;break;case 12:Es(t,e),Vs(e);break;case 31:Es(t,e),Vs(e),u&4&&(u=e.updateQueue,u!==null&&(e.updateQueue=null,Hc(e,u)));break;case 13:Es(t,e),Vs(e),e.child.flags&8192&&e.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(It=xn()),u&4&&(u=e.updateQueue,u!==null&&(e.updateQueue=null,Hc(e,u)));break;case 22:h=e.memoizedState!==null;var Ue=a!==null&&a.memoizedState!==null,it=kc,St=fa;if(kc=it||h,fa=St||Ue,Es(t,e),fa=St,kc=it,Vs(e),u&8192)e:for(t=e.stateNode,t._visibility=h?t._visibility&-2:t._visibility|1,h&&(a===null||Ue||kc||fa||Ac(e)),a=null,t=e;;){if(t.tag===5||t.tag===26){if(a===null){Ue=a=t;try{if(w=Ue.stateNode,h)O=w.style,typeof O.setProperty=="function"?O.setProperty("display","none","important"):O.display="none";else{ue=Ue.stateNode;var _t=Ue.memoizedProps.style,rt=_t!=null&&_t.hasOwnProperty("display")?_t.display:null;ue.style.display=rt==null||typeof rt=="boolean"?"":(""+rt).trim()}}catch(Nn){Vr(Ue,Ue.return,Nn)}}}else if(t.tag===6){if(a===null){Ue=t;try{Ue.stateNode.nodeValue=h?"":Ue.memoizedProps}catch(Nn){Vr(Ue,Ue.return,Nn)}}}else if(t.tag===18){if(a===null){Ue=t;try{var ut=Ue.stateNode;h?q0(ut,!0):q0(Ue.stateNode,!1)}catch(Nn){Vr(Ue,Ue.return,Nn)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;a===t&&(a=null),t=t.return}a===t&&(a=null),t.sibling.return=t.return,t=t.sibling}u&4&&(u=e.updateQueue,u!==null&&(a=u.retryQueue,a!==null&&(u.retryQueue=null,Hc(e,a))));break;case 19:Es(t,e),Vs(e),u&4&&(u=e.updateQueue,u!==null&&(e.updateQueue=null,Hc(e,u)));break;case 30:break;case 21:break;default:Es(t,e),Vs(e)}}function Vs(e){var t=e.flags;if(t&2){try{for(var a,u=e.return;u!==null;){if(Nf(u)){a=u;break}u=u.return}if(a==null)throw Error(s(160));switch(a.tag){case 27:var h=a.stateNode,w=zu(e);_u(e,w,h);break;case 5:var O=a.stateNode;a.flags&32&&(ji(O,""),a.flags&=-33);var ue=zu(e);_u(e,ue,O);break;case 3:case 4:var Ue=a.stateNode.containerInfo,it=zu(e);Vl(e,it,Ue);break;default:throw Error(s(161))}}catch(St){Vr(e,e.return,St)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Pf(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;Pf(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function ql(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)qc(e,t.alternate,t),t=t.sibling}function Ac(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Eo(4,t,t.return),Ac(t);break;case 1:El(t,t.return);var a=t.stateNode;typeof a.componentWillUnmount=="function"&&jf(t,t.return,a),Ac(t);break;case 27:Bf(t.stateNode);case 26:case 5:El(t,t.return),Ac(t);break;case 22:t.memoizedState===null&&Ac(t);break;case 30:Ac(t);break;default:Ac(t)}e=e.sibling}}function Pc(e,t,a){for(a=a&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var u=t.alternate,h=e,w=t,O=w.flags;switch(w.tag){case 0:case 11:case 15:Pc(h,w,a),fu(4,w);break;case 1:if(Pc(h,w,a),u=w,h=u.stateNode,typeof h.componentDidMount=="function")try{h.componentDidMount()}catch(it){Vr(u,u.return,it)}if(u=w,h=u.updateQueue,h!==null){var ue=u.stateNode;try{var Ue=h.shared.hiddenCallbacks;if(Ue!==null)for(h.shared.hiddenCallbacks=null,h=0;h<Ue.length;h++)ao(Ue[h],ue)}catch(it){Vr(u,u.return,it)}}a&&O&64&&Cf(w),ud(w,w.return);break;case 27:jp(w);case 26:case 5:Pc(h,w,a),a&&u===null&&O&4&&Cp(w),ud(w,w.return);break;case 12:Pc(h,w,a);break;case 31:Pc(h,w,a),a&&O&4&&Np(h,w);break;case 13:Pc(h,w,a),a&&O&4&&kp(h,w);break;case 22:w.memoizedState===null&&Pc(h,w,a),ud(w,w.return);break;case 30:break;default:Pc(h,w,a)}t=t.sibling}}function zf(e,t){var a=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==a&&(e!=null&&e.refCount++,a!=null&&ua(a))}function Hl(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&ua(e))}function hs(e,t,a,u){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)hd(e,t,a,u),t=t.sibling}function hd(e,t,a,u){var h=t.flags;switch(t.tag){case 0:case 11:case 15:hs(e,t,a,u),h&2048&&fu(9,t);break;case 1:hs(e,t,a,u);break;case 3:hs(e,t,a,u),h&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&ua(e)));break;case 12:if(h&2048){hs(e,t,a,u),e=t.stateNode;try{var w=t.memoizedProps,O=w.id,ue=w.onPostCommit;typeof ue=="function"&&ue(O,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(Ue){Vr(t,t.return,Ue)}}else hs(e,t,a,u);break;case 31:hs(e,t,a,u);break;case 13:hs(e,t,a,u);break;case 23:break;case 22:w=t.stateNode,O=t.alternate,t.memoizedState!==null?w._visibility&2?hs(e,t,a,u):gd(e,t):w._visibility&2?hs(e,t,a,u):(w._visibility|=2,Du(e,t,a,u,(t.subtreeFlags&10256)!==0||!1)),h&2048&&zf(O,t);break;case 24:hs(e,t,a,u),h&2048&&Hl(t.alternate,t);break;default:hs(e,t,a,u)}}function Du(e,t,a,u,h){for(h=h&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var w=e,O=t,ue=a,Ue=u,it=O.flags;switch(O.tag){case 0:case 11:case 15:Du(w,O,ue,Ue,h),fu(8,O);break;case 23:break;case 22:var St=O.stateNode;O.memoizedState!==null?St._visibility&2?Du(w,O,ue,Ue,h):gd(w,O):(St._visibility|=2,Du(w,O,ue,Ue,h)),h&&it&2048&&zf(O.alternate,O);break;case 24:Du(w,O,ue,Ue,h),h&&it&2048&&Hl(O.alternate,O);break;default:Du(w,O,ue,Ue,h)}t=t.sibling}}function gd(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var a=e,u=t,h=u.flags;switch(u.tag){case 22:gd(a,u),h&2048&&zf(u.alternate,u);break;case 24:gd(a,u),h&2048&&Hl(u.alternate,u);break;default:gd(a,u)}t=t.sibling}}var pu=8192;function Wc(e,t,a){if(e.subtreeFlags&pu)for(e=e.child;e!==null;)_f(e,t,a),e=e.sibling}function _f(e,t,a){switch(e.tag){case 26:Wc(e,t,a),e.flags&pu&&e.memoizedState!==null&&Vm(a,vl,e.memoizedState,e.memoizedProps);break;case 5:Wc(e,t,a);break;case 3:case 4:var u=vl;vl=Bp(e.stateNode.containerInfo),Wc(e,t,a),vl=u;break;case 22:e.memoizedState===null&&(u=e.alternate,u!==null&&u.memoizedState!==null?(u=pu,pu=16777216,Wc(e,t,a),pu=u):Wc(e,t,a));break;default:Wc(e,t,a)}}function Df(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function on(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var a=0;a<t.length;a++){var u=t[a];ko=u,Ap(u,e)}Df(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Rf(e),e=e.sibling}function Rf(e){switch(e.tag){case 0:case 11:case 15:on(e),e.flags&2048&&Eo(9,e,e.return);break;case 3:on(e);break;case 12:on(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Vd(e)):on(e);break;default:on(e)}}function Vd(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var a=0;a<t.length;a++){var u=t[a];ko=u,Ap(u,e)}Df(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:Eo(8,t,t.return),Vd(t);break;case 22:a=t.stateNode,a._visibility&2&&(a._visibility&=-3,Vd(t));break;default:Vd(t)}e=e.sibling}}function Ap(e,t){for(;ko!==null;){var a=ko;switch(a.tag){case 0:case 11:case 15:Eo(8,a,t);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var u=a.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:ua(a.memoizedState.cache)}if(u=a.child,u!==null)u.return=a,ko=u;else e:for(a=e;ko!==null;){u=ko;var h=u.sibling,w=u.return;if(Af(u),u===a){ko=null;break e}if(h!==null){h.return=w,ko=h;break e}ko=w}}}var c={getCacheForType:function(e){var t=ca(Li),a=t.data.get(e);return a===void 0&&(a=e(),t.data.set(e,a)),a},cacheSignal:function(){return ca(Li).controller.signal}},x=typeof WeakMap=="function"?WeakMap:Map,P=0,B=null,K=null,ne=0,z=0,Ne=null,ve=!1,Le=!1,Me=!1,Ae=0,he=0,me=0,Se=0,Pe=0,Oe=0,Fe=0,Ze=null,dt=null,Ct=!1,It=0,st=0,cn=1/0,$e=null,Ye=null,qe=0,at=null,ft=null,Bt=0,ln=0,_n=null,Qn=null,Vn=0,Gn=null;function Xn(){return(P&2)!==0&&ne!==0?ne&-ne:te.T!==null?Mh():Wn()}function Bn(){if(Oe===0)if((ne&536870912)===0||En){var e=Jt;Jt<<=1,(Jt&3932160)===0&&(Jt=262144),Oe=e}else Oe=536870912;return e=Si.current,e!==null&&(e.flags|=32),Oe}function Rt(e,t,a){(e===B&&(z===2||z===9)||e.cancelPendingCommit!==null)&&(Kn(e,0),rr(e,ne,Oe,!1)),qt(e,a),((P&2)===0||e!==B)&&(e===B&&((P&2)===0&&(Se|=a),he===4&&rr(e,ne,Oe,!1)),$c(e))}function Ln(e,t,a){if((P&6)!==0)throw Error(s(327));var u=!a&&(t&127)===0&&(t&e.expiredLanes)===0||Tr(e,t),h=u?sm(e,t):Dh(e,t,!0),w=u;do{if(h===0){Le&&!u&&rr(e,t,0,!1);break}else{if(a=e.current.alternate,w&&!mo(a)){h=Dh(e,t,!1),w=!1;continue}if(h===2){if(w=t,e.errorRecoveryDisabledLanes&w)var O=0;else O=e.pendingLanes&-536870913,O=O!==0?O:O&536870912?536870912:0;if(O!==0){t=O;e:{var ue=e;h=Ze;var Ue=ue.current.memoizedState.isDehydrated;if(Ue&&(Kn(ue,O).flags|=256),O=Dh(ue,O,!1),O!==2){if(Me&&!Ue){ue.errorRecoveryDisabledLanes|=w,Se|=w,h=4;break e}w=dt,dt=h,w!==null&&(dt===null?dt=w:dt.push.apply(dt,w))}h=O}if(w=!1,h!==2)continue}}if(h===1){Kn(e,0),rr(e,t,0,!0);break}e:{switch(u=e,w=h,w){case 0:case 1:throw Error(s(345));case 4:if((t&4194048)!==t)break;case 6:rr(u,t,Oe,!ve);break e;case 2:dt=null;break;case 3:case 5:break;default:throw Error(s(329))}if((t&62914560)===t&&(h=It+300-xn(),10<h)){if(rr(u,t,Oe,!ve),ti(u,0,!0)!==0)break e;Bt=t,u.timeoutHandle=U0(br.bind(null,u,a,dt,$e,Ct,t,Oe,Se,Fe,ve,w,"Throttled",-0,0),h);break e}br(u,a,dt,$e,Ct,t,Oe,Se,Fe,ve,w,null,-0,0)}}break}while(!0);$c(e)}function br(e,t,a,u,h,w,O,ue,Ue,it,St,_t,rt,ut){if(e.timeoutHandle=-1,_t=t.subtreeFlags,_t&8192||(_t&16785408)===16785408){_t={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:xr},_f(t,w,_t);var Nn=(w&62914560)===w?It-xn():(w&4194048)===w?st-xn():0;if(Nn=qm(_t,Nn),Nn!==null){Bt=w,e.cancelPendingCommit=Nn(m0.bind(null,e,t,w,a,u,h,O,ue,Ue,St,_t,null,rt,ut)),rr(e,w,O,!it);return}}m0(e,t,w,a,u,h,O,ue,Ue)}function mo(e){for(var t=e;;){var a=t.tag;if((a===0||a===11||a===15)&&t.flags&16384&&(a=t.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var u=0;u<a.length;u++){var h=a[u],w=h.getSnapshot;h=h.value;try{if(!Xo(w(),h))return!1}catch{return!1}}if(a=t.child,t.subtreeFlags&16384&&a!==null)a.return=t,t=a;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function rr(e,t,a,u){t&=~Pe,t&=~Se,e.suspendedLanes|=t,e.pingedLanes&=~t,u&&(e.warmLanes|=t),u=e.expirationTimes;for(var h=t;0<h;){var w=31-Vt(h),O=1<<w;u[w]=-1,h&=~O}a!==0&&Ji(e,a,t)}function Ao(){return(P&6)===0?(If(0),!1):!0}function Vo(){if(K!==null){if(z===0)var e=K.return;else e=K,nl=fl=null,tc(e),zt=null,Sn=0,e=K;for(;e!==null;)Od(e.alternate,e),e=e.return;K=null}}function Kn(e,t){var a=e.timeoutHandle;a!==-1&&(e.timeoutHandle=-1,jm(a)),a=e.cancelPendingCommit,a!==null&&(e.cancelPendingCommit=null,a()),Bt=0,Vo(),B=e,K=a=dr(e.current,null),ne=t,z=0,Ne=null,ve=!1,Le=Tr(e,t),Me=!1,Fe=Oe=Pe=Se=me=he=0,dt=Ze=null,Ct=!1,(t&8)!==0&&(t|=t&32);var u=e.entangledLanes;if(u!==0)for(e=e.entanglements,u&=t;0<u;){var h=31-Vt(u),w=1<<h;t|=e[h],u&=~w}return Ae=t,Rr(),a}function wl(e,t){Mn=null,te.H=Cc,t===Re||t===ke?(t=bt(),z=3):t===Ee?(t=bt(),z=4):z=t===Au?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Ne=t,K===null&&(he=1,_d(e,Cs(t,e.current)))}function rl(){var e=Si.current;return e===null?!0:(ne&4194048)===ne?yi===null:(ne&62914560)===ne||(ne&536870912)!==0?e===yi:!1}function p0(){var e=te.H;return te.H=Cc,e===null?Cc:e}function h0(){var e=te.A;return te.A=c,e}function Pp(){he=4,ve||(ne&4194048)!==ne&&Si.current!==null||(Le=!0),(me&134217727)===0&&(Se&134217727)===0||B===null||rr(B,ne,Oe,!1)}function Dh(e,t,a){var u=P;P|=2;var h=p0(),w=h0();(B!==e||ne!==t)&&($e=null,Kn(e,t)),t=!1;var O=he;e:do try{if(z!==0&&K!==null){var ue=K,Ue=Ne;switch(z){case 8:Vo(),O=6;break e;case 3:case 2:case 9:case 6:Si.current===null&&(t=!0);var it=z;if(z=0,Ne=null,qd(e,ue,Ue,it),a&&Le){O=0;break e}break;default:it=z,z=0,Ne=null,qd(e,ue,Ue,it)}}am(),O=he;break}catch(St){wl(e,St)}while(!0);return t&&e.shellSuspendCounter++,nl=fl=null,P=u,te.H=h,te.A=w,K===null&&(B=null,ne=0,Rr()),O}function am(){for(;K!==null;)g0(K)}function sm(e,t){var a=P;P|=2;var u=p0(),h=h0();B!==e||ne!==t?($e=null,cn=xn()+500,Kn(e,t)):Le=Tr(e,t);e:do try{if(z!==0&&K!==null){t=K;var w=Ne;t:switch(z){case 1:z=0,Ne=null,qd(e,t,w,1);break;case 2:case 9:if(Qe(w)){z=0,Ne=null,y0(t);break}t=function(){z!==2&&z!==9||B!==e||(z=7),$c(e)},w.then(t,t);break e;case 3:z=7;break e;case 4:z=5;break e;case 7:Qe(w)?(z=0,Ne=null,y0(t)):(z=0,Ne=null,qd(e,t,w,7));break;case 5:var O=null;switch(K.tag){case 26:O=K.memoizedState;case 5:case 27:var ue=K;if(O?t1(O):ue.stateNode.complete){z=0,Ne=null;var Ue=ue.sibling;if(Ue!==null)K=Ue;else{var it=ue.return;it!==null?(K=it,zp(it)):K=null}break t}}z=0,Ne=null,qd(e,t,w,5);break;case 6:z=0,Ne=null,qd(e,t,w,6);break;case 8:Vo(),he=6;break e;default:throw Error(s(462))}}lm();break}catch(St){wl(e,St)}while(!0);return nl=fl=null,te.H=u,te.A=h,P=a,K!==null?0:(B=null,ne=0,Rr(),he)}function lm(){for(;K!==null&&!gn();)g0(K)}function g0(e){var t=Tp(e.alternate,e,Ae);e.memoizedProps=e.pendingProps,t===null?zp(e):K=t}function y0(e){var t=e,a=t.alternate;switch(t.tag){case 15:case 0:t=yf(a,t,t.pendingProps,t.type,void 0,ne);break;case 11:t=yf(a,t,t.pendingProps,t.type.render,t.ref,ne);break;case 5:tc(t);default:Od(a,t),t=K=io(t,Ae),t=Tp(a,t,Ae)}e.memoizedProps=e.pendingProps,t===null?zp(e):K=t}function qd(e,t,a,u){nl=fl=null,tc(t),zt=null,Sn=0;var h=t.return;try{if(Ld(e,h,t,a,ne)){he=1,_d(e,Cs(a,e.current)),K=null;return}}catch(w){if(h!==null)throw K=h,w;he=1,_d(e,Cs(a,e.current)),K=null;return}t.flags&32768?(En||u===1?e=!0:Le||(ne&536870912)!==0?e=!1:(ve=e=!0,(u===2||u===9||u===3||u===6)&&(u=Si.current,u!==null&&u.tag===13&&(u.flags|=16384))),x0(t,e)):zp(t)}function zp(e){var t=e;do{if((t.flags&32768)!==0){x0(t,ve);return}e=t.return;var a=cd(t.alternate,t,Ae);if(a!==null){K=a;return}if(t=t.sibling,t!==null){K=t;return}K=t=e}while(t!==null);he===0&&(he=5)}function x0(e,t){do{var a=Tf(e.alternate,e);if(a!==null){a.flags&=32767,K=a;return}if(a=e.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!t&&(e=e.sibling,e!==null)){K=e;return}K=e=a}while(e!==null);he=6,K=null}function m0(e,t,a,u,h,w,O,ue,Ue){e.cancelPendingCommit=null;do _p();while(qe!==0);if((P&6)!==0)throw Error(s(327));if(t!==null){if(t===e.current)throw Error(s(177));if(w=t.lanes|t.childLanes,w|=oi,Zi(e,a,w,O,ue,Ue),e===B&&(K=B=null,ne=0),ft=t,at=e,Bt=a,ln=w,_n=h,Qn=u,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,fm(Wt,function(){return T0(),null})):(e.callbackNode=null,e.callbackPriority=0),u=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||u){u=te.T,te.T=null,h=de.p,de.p=2,O=P,P|=4;try{kf(e,t,a)}finally{P=O,de.p=h,te.T=u}}qe=1,b0(),v0(),w0()}}function b0(){if(qe===1){qe=0;var e=at,t=ft,a=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||a){a=te.T,te.T=null;var u=de.p;de.p=2;var h=P;P|=4;try{Ed(t,e);var w=Hh,O=jl(e.containerInfo),ue=w.focusedElem,Ue=w.selectionRange;if(O!==ue&&ue&&ue.ownerDocument&&Cl(ue.ownerDocument.documentElement,ue)){if(Ue!==null&&wo(ue)){var it=Ue.start,St=Ue.end;if(St===void 0&&(St=it),"selectionStart"in ue)ue.selectionStart=it,ue.selectionEnd=Math.min(St,ue.value.length);else{var _t=ue.ownerDocument||document,rt=_t&&_t.defaultView||window;if(rt.getSelection){var ut=rt.getSelection(),Nn=ue.textContent.length,ei=Math.min(Ue.start,Nn),Zr=Ue.end===void 0?ei:Math.min(Ue.end,Nn);!ut.extend&&ei>Zr&&(O=Zr,Zr=ei,ei=O);var Xe=el(ue,ei),We=el(ue,Zr);if(Xe&&We&&(ut.rangeCount!==1||ut.anchorNode!==Xe.node||ut.anchorOffset!==Xe.offset||ut.focusNode!==We.node||ut.focusOffset!==We.offset)){var nt=_t.createRange();nt.setStart(Xe.node,Xe.offset),ut.removeAllRanges(),ei>Zr?(ut.addRange(nt),ut.extend(We.node,We.offset)):(nt.setEnd(We.node,We.offset),ut.addRange(nt))}}}}for(_t=[],ut=ue;ut=ut.parentNode;)ut.nodeType===1&&_t.push({element:ut,left:ut.scrollLeft,top:ut.scrollTop});for(typeof ue.focus=="function"&&ue.focus(),ue=0;ue<_t.length;ue++){var kt=_t[ue];kt.element.scrollLeft=kt.left,kt.element.scrollTop=kt.top}}qp=!!qh,Hh=qh=null}finally{P=h,de.p=u,te.T=a}}e.current=t,qe=2}}function v0(){if(qe===2){qe=0;var e=at,t=ft,a=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||a){a=te.T,te.T=null;var u=de.p;de.p=2;var h=P;P|=4;try{qc(e,t.alternate,t)}finally{P=h,de.p=u,te.T=a}}qe=3}}function w0(){if(qe===4||qe===3){qe=0,Zt();var e=at,t=ft,a=Bt,u=Qn;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?qe=5:(qe=0,ft=at=null,S0(e,e.pendingLanes));var h=e.pendingLanes;if(h===0&&(Ye=null),wt(a),t=t.stateNode,Ke&&typeof Ke.onCommitFiberRoot=="function")try{Ke.onCommitFiberRoot(Nt,t,void 0,(t.current.flags&128)===128)}catch{}if(u!==null){t=te.T,h=de.p,de.p=2,te.T=null;try{for(var w=e.onRecoverableError,O=0;O<u.length;O++){var ue=u[O];w(ue.value,{componentStack:ue.stack})}}finally{te.T=t,de.p=h}}(Bt&3)!==0&&_p(),$c(e),h=e.pendingLanes,(a&261930)!==0&&(h&42)!==0?e===Gn?Vn++:(Vn=0,Gn=e):Vn=0,If(0)}}function S0(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,ua(t)))}function _p(){return b0(),v0(),w0(),T0()}function T0(){if(qe!==5)return!1;var e=at,t=ln;ln=0;var a=wt(Bt),u=te.T,h=de.p;try{de.p=32>a?32:a,te.T=null,a=_n,_n=null;var w=at,O=Bt;if(qe=0,ft=at=null,Bt=0,(P&6)!==0)throw Error(s(331));var ue=P;if(P|=4,Rf(w.current),hd(w,w.current,O,a),P=ue,If(0,!1),Ke&&typeof Ke.onPostCommitFiberRoot=="function")try{Ke.onPostCommitFiberRoot(Nt,w)}catch{}return!0}finally{de.p=h,te.T=u,S0(e,t)}}function C0(e,t,a){t=Cs(a,t),t=Rd(e.stateNode,t,2),e=gi(e,t,2),e!==null&&(qt(e,2),$c(e))}function Vr(e,t,a){if(e.tag===3)C0(e,e,a);else for(;t!==null;){if(t.tag===3){C0(t,e,a);break}else if(t.tag===1){var u=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Ye===null||!Ye.has(u))){e=Cs(a,e),a=Id(2),u=gi(t,a,2),u!==null&&(td(a,u,t,e),qt(u,2),$c(u));break}}t=t.return}}function Rh(e,t,a){var u=e.pingCache;if(u===null){u=e.pingCache=new x;var h=new Set;u.set(t,h)}else h=u.get(t),h===void 0&&(h=new Set,u.set(t,h));h.has(a)||(Me=!0,h.add(a),e=cm.bind(null,e,t,a),t.then(e,e))}function cm(e,t,a){var u=e.pingCache;u!==null&&u.delete(t),e.pingedLanes|=e.suspendedLanes&a,e.warmLanes&=~a,B===e&&(ne&a)===a&&(he===4||he===3&&(ne&62914560)===ne&&300>xn()-It?(P&2)===0&&Kn(e,0):Pe|=a,Fe===ne&&(Fe=0)),$c(e)}function j0(e,t){t===0&&(t=zi()),e=ll(e,t),e!==null&&(qt(e,t),$c(e))}function um(e){var t=e.memoizedState,a=0;t!==null&&(a=t.retryLane),j0(e,a)}function dm(e,t){var a=0;switch(e.tag){case 31:case 13:var u=e.stateNode,h=e.memoizedState;h!==null&&(a=h.retryLane);break;case 19:u=e.stateNode;break;case 22:u=e.stateNode._retryCache;break;default:throw Error(s(314))}u!==null&&u.delete(t),j0(e,a)}function fm(e,t){return hn(e,t)}var Dp=null,Hd=null,Ih=!1,Rp=!1,Lh=!1,Ru=0;function $c(e){e!==Hd&&e.next===null&&(Hd===null?Dp=Hd=e:Hd=Hd.next=e),Rp=!0,Ih||(Ih=!0,hm())}function If(e,t){if(!Lh&&Rp){Lh=!0;do for(var a=!1,u=Dp;u!==null;){if(e!==0){var h=u.pendingLanes;if(h===0)var w=0;else{var O=u.suspendedLanes,ue=u.pingedLanes;w=(1<<31-Vt(42|e)+1)-1,w&=h&~(O&~ue),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(a=!0,P0(u,w))}else w=ne,w=ti(u,u===B?w:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(w&3)===0||Tr(u,w)||(a=!0,P0(u,w));u=u.next}while(a);Lh=!1}}function pm(){N0()}function N0(){Rp=Ih=!1;var e=0;Ru!==0&&Cm()&&(e=Ru);for(var t=xn(),a=null,u=Dp;u!==null;){var h=u.next,w=k0(u,t);w===0?(u.next=null,a===null?Dp=h:a.next=h,h===null&&(Hd=a)):(a=u,(e!==0||(w&3)!==0)&&(Rp=!0)),u=h}qe!==0&&qe!==5||If(e),Ru!==0&&(Ru=0)}function k0(e,t){for(var a=e.suspendedLanes,u=e.pingedLanes,h=e.expirationTimes,w=e.pendingLanes&-62914561;0<w;){var O=31-Vt(w),ue=1<<O,Ue=h[O];Ue===-1?((ue&a)===0||(ue&u)!==0)&&(h[O]=en(ue,t)):Ue<=t&&(e.expiredLanes|=ue),w&=~ue}if(t=B,a=ne,a=ti(e,e===t?a:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),u=e.callbackNode,a===0||e===t&&(z===2||z===9)||e.cancelPendingCommit!==null)return u!==null&&u!==null&&Et(u),e.callbackNode=null,e.callbackPriority=0;if((a&3)===0||Tr(e,a)){if(t=a&-a,t===e.callbackPriority)return t;switch(u!==null&&Et(u),wt(a)){case 2:case 8:a=Lt;break;case 32:a=Wt;break;case 268435456:a=ct;break;default:a=Wt}return u=A0.bind(null,e),a=hn(a,u),e.callbackPriority=t,e.callbackNode=a,t}return u!==null&&u!==null&&Et(u),e.callbackPriority=2,e.callbackNode=null,2}function A0(e,t){if(qe!==0&&qe!==5)return e.callbackNode=null,e.callbackPriority=0,null;var a=e.callbackNode;if(_p()&&e.callbackNode!==a)return null;var u=ne;return u=ti(e,e===B?u:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),u===0?null:(Ln(e,u,t),k0(e,xn()),e.callbackNode!=null&&e.callbackNode===a?A0.bind(null,e):null)}function P0(e,t){if(_p())return null;Ln(e,t,!0)}function hm(){Nm(function(){(P&6)!==0?hn(Rn,pm):N0()})}function Mh(){if(Ru===0){var e=f;e===0&&(e=At,At<<=1,(At&261888)===0&&(At=256)),Ru=e}return Ru}function z0(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Jr(""+e)}function _0(e,t){var a=t.ownerDocument.createElement("input");return a.name=t.name,a.value=t.value,e.id&&a.setAttribute("form",e.id),t.parentNode.insertBefore(a,t),e=new FormData(e),a.parentNode.removeChild(a),e}function gm(e,t,a,u,h){if(t==="submit"&&a&&a.stateNode===h){var w=z0((h[an]||null).action),O=u.submitter;O&&(t=(t=O[an]||null)?z0(t.formAction):O.getAttribute("formAction"),t!==null&&(w=t,O=null));var ue=new ri("action","action",null,u,h);e.push({event:ue,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Ru!==0){var Ue=O?_0(h,O):new FormData(h);pf(a,{pending:!0,data:Ue,method:h.method,action:w},null,Ue)}}else typeof w=="function"&&(ue.preventDefault(),Ue=O?_0(h,O):new FormData(h),pf(a,{pending:!0,data:Ue,method:h.method,action:w},w,Ue))},currentTarget:h}]})}}for(var Bh=0;Bh<To.length;Bh++){var Oh=To[Bh],ym=Oh.toLowerCase(),xm=Oh[0].toUpperCase()+Oh.slice(1);Io(ym,"on"+xm)}Io(bc,"onAnimationEnd"),Io(nu,"onAnimationIteration"),Io(Gu,"onAnimationStart"),Io("dblclick","onDoubleClick"),Io("focusin","onFocus"),Io("focusout","onBlur"),Io($a,"onTransitionRun"),Io(ho,"onTransitionStart"),Io(kl,"onTransitionCancel"),Io(Ro,"onTransitionEnd"),Ri("onMouseEnter",["mouseout","mouseover"]),Ri("onMouseLeave",["mouseout","mouseover"]),Ri("onPointerEnter",["pointerout","pointerover"]),Ri("onPointerLeave",["pointerout","pointerover"]),Wo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Wo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Wo("onBeforeInput",["compositionend","keypress","textInput","paste"]),Wo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Wo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Wo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mm=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Lf));function D0(e,t){t=(t&4)!==0;for(var a=0;a<e.length;a++){var u=e[a],h=u.event;u=u.listeners;e:{var w=void 0;if(t)for(var O=u.length-1;0<=O;O--){var ue=u[O],Ue=ue.instance,it=ue.currentTarget;if(ue=ue.listener,Ue!==w&&h.isPropagationStopped())break e;w=ue,h.currentTarget=it;try{w(h)}catch(St){to(St)}h.currentTarget=null,w=Ue}else for(O=0;O<u.length;O++){if(ue=u[O],Ue=ue.instance,it=ue.currentTarget,ue=ue.listener,Ue!==w&&h.isPropagationStopped())break e;w=ue,h.currentTarget=it;try{w(h)}catch(St){to(St)}h.currentTarget=null,w=Ue}}}}function Vi(e,t){var a=t[bn];a===void 0&&(a=t[bn]=new Set);var u=e+"__bubble";a.has(u)||(R0(t,e,2,!1),a.add(u))}function Fh(e,t,a){var u=0;t&&(u|=4),R0(a,e,u,t)}var Ip="_reactListening"+Math.random().toString(36).slice(2);function Uh(e){if(!e[Ip]){e[Ip]=!0,ys.forEach(function(a){a!=="selectionchange"&&(mm.has(a)||Fh(a,!1,e),Fh(a,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ip]||(t[Ip]=!0,Fh("selectionchange",!1,t))}}function R0(e,t,a,u){switch(l1(t)){case 2:var h=$m;break;case 8:h=Ym;break;default:h=tg}a=h.bind(null,t,a,e),h=void 0,!Cn||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(h=!0),u?h!==void 0?e.addEventListener(t,a,{capture:!0,passive:h}):e.addEventListener(t,a,!0):h!==void 0?e.addEventListener(t,a,{passive:h}):e.addEventListener(t,a,!1)}function Eh(e,t,a,u,h){var w=u;if((t&1)===0&&(t&2)===0&&u!==null)e:for(;;){if(u===null)return;var O=u.tag;if(O===3||O===4){var ue=u.stateNode.containerInfo;if(ue===h)break;if(O===4)for(O=u.return;O!==null;){var Ue=O.tag;if((Ue===3||Ue===4)&&O.stateNode.containerInfo===h)return;O=O.return}for(;ue!==null;){if(O=_i(ue),O===null)return;if(Ue=O.tag,Ue===5||Ue===6||Ue===26||Ue===27){u=w=O;continue e}ue=ue.parentNode}}u=u.return}Ea(function(){var it=w,St=Ua(a),_t=[];e:{var rt=Ls.get(e);if(rt!==void 0){var ut=ri,Nn=e;switch(e){case"keypress":if(pn(a)===0)break e;case"keydown":case"keyup":ut=li;break;case"focusin":Nn="focus",ut=ws;break;case"focusout":Nn="blur",ut=ws;break;case"beforeblur":case"afterblur":ut=ws;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ut=vs;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ut=Zs;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ut=Ar;break;case bc:case nu:case Gu:ut=T;break;case Ro:ut=Qi;break;case"scroll":case"scrollend":ut=wi;break;case"wheel":ut=Dr;break;case"copy":case"cut":case"paste":ut=fe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ut=Bi;break;case"toggle":case"beforetoggle":ut=ma}var ei=(t&4)!==0,Zr=!ei&&(e==="scroll"||e==="scrollend"),Xe=ei?rt!==null?rt+"Capture":null:rt;ei=[];for(var We=it,nt;We!==null;){var kt=We;if(nt=kt.stateNode,kt=kt.tag,kt!==5&&kt!==26&&kt!==27||nt===null||Xe===null||(kt=ga(We,Xe),kt!=null&&ei.push(Mf(We,kt,nt))),Zr)break;We=We.return}0<ei.length&&(rt=new ut(rt,Nn,null,a,St),_t.push({event:rt,listeners:ei}))}}if((t&7)===0){e:{if(rt=e==="mouseover"||e==="pointerover",ut=e==="mouseout"||e==="pointerout",rt&&a!==bs&&(Nn=a.relatedTarget||a.fromElement)&&(_i(Nn)||Nn[rn]))break e;if((ut||rt)&&(rt=St.window===St?St:(rt=St.ownerDocument)?rt.defaultView||rt.parentWindow:window,ut?(Nn=a.relatedTarget||a.toElement,ut=it,Nn=Nn?_i(Nn):null,Nn!==null&&(Zr=d(Nn),ei=Nn.tag,Nn!==Zr||ei!==5&&ei!==27&&ei!==6)&&(Nn=null)):(ut=null,Nn=it),ut!==Nn)){if(ei=vs,kt="onMouseLeave",Xe="onMouseEnter",We="mouse",(e==="pointerout"||e==="pointerover")&&(ei=Bi,kt="onPointerLeave",Xe="onPointerEnter",We="pointer"),Zr=ut==null?rt:ui(ut),nt=Nn==null?rt:ui(Nn),rt=new ei(kt,We+"leave",ut,a,St),rt.target=Zr,rt.relatedTarget=nt,kt=null,_i(St)===it&&(ei=new ei(Xe,We+"enter",Nn,a,St),ei.target=nt,ei.relatedTarget=Zr,kt=ei),Zr=kt,ut&&Nn)t:{for(ei=bm,Xe=ut,We=Nn,nt=0,kt=Xe;kt;kt=ei(kt))nt++;kt=0;for(var $n=We;$n;$n=ei($n))kt++;for(;0<nt-kt;)Xe=ei(Xe),nt--;for(;0<kt-nt;)We=ei(We),kt--;for(;nt--;){if(Xe===We||We!==null&&Xe===We.alternate){ei=Xe;break t}Xe=ei(Xe),We=ei(We)}ei=null}else ei=null;ut!==null&&I0(_t,rt,ut,ei,!1),Nn!==null&&Zr!==null&&I0(_t,Zr,Nn,ei,!0)}}e:{if(rt=it?ui(it):window,ut=rt.nodeName&&rt.nodeName.toLowerCase(),ut==="select"||ut==="input"&&rt.type==="file")var vr=po;else if(Rs(rt))if(Go)vr=Oi;else{vr=Jn;var Dn=Jl}else ut=rt.nodeName,!ut||ut.toLowerCase()!=="input"||rt.type!=="checkbox"&&rt.type!=="radio"?it&&ms(it.elementType)&&(vr=po):vr=Ts;if(vr&&(vr=vr(e,it))){Ia(_t,vr,a,St);break e}Dn&&Dn(e,rt,it),e==="focusout"&&it&&rt.type==="number"&&it.memoizedProps.value!=null&&ha(rt,"number",rt.value)}switch(Dn=it?ui(it):window,e){case"focusin":(Rs(Dn)||Dn.contentEditable==="true")&&(Ko=Dn,Wa=it,sr=null);break;case"focusout":sr=Wa=Ko=null;break;case"mousedown":ls=!0;break;case"contextmenu":case"mouseup":case"dragend":ls=!1,Ii(_t,a,St);break;case"selectionchange":if(Nl)break;case"keydown":case"keyup":Ii(_t,a,St)}var Ai;if(na)e:{switch(e){case"compositionstart":var Ki="onCompositionStart";break e;case"compositionend":Ki="onCompositionEnd";break e;case"compositionupdate":Ki="onCompositionUpdate";break e}Ki=void 0}else $i?vo(e,a)&&(Ki="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(Ki="onCompositionStart");Ki&&(ba&&a.locale!=="ko"&&($i||Ki!=="onCompositionStart"?Ki==="onCompositionEnd"&&$i&&(Ai=Ni()):(Yo=St,Fn="value"in Yo?Yo.value:Yo.textContent,$i=!0)),Dn=Lp(it,Ki),0<Dn.length&&(Ki=new Ve(Ki,e,null,a,St),_t.push({event:Ki,listeners:Dn}),Ai?Ki.data=Ai:(Ai=os(a),Ai!==null&&(Ki.data=Ai)))),(Ai=fo?eo(e,a):Tl(e,a))&&(Ki=Lp(it,"onBeforeInput"),0<Ki.length&&(Dn=new Ve("onBeforeInput","beforeinput",null,a,St),_t.push({event:Dn,listeners:Ki}),Dn.data=Ai)),gm(_t,e,it,a,St)}D0(_t,t)})}function Mf(e,t,a){return{instance:e,listener:t,currentTarget:a}}function Lp(e,t){for(var a=t+"Capture",u=[];e!==null;){var h=e,w=h.stateNode;if(h=h.tag,h!==5&&h!==26&&h!==27||w===null||(h=ga(e,a),h!=null&&u.unshift(Mf(e,h,w)),h=ga(e,t),h!=null&&u.push(Mf(e,h,w))),e.tag===3)return u;e=e.return}return[]}function bm(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function I0(e,t,a,u,h){for(var w=t._reactName,O=[];a!==null&&a!==u;){var ue=a,Ue=ue.alternate,it=ue.stateNode;if(ue=ue.tag,Ue!==null&&Ue===u)break;ue!==5&&ue!==26&&ue!==27||it===null||(Ue=it,h?(it=ga(a,w),it!=null&&O.unshift(Mf(a,it,Ue))):h||(it=ga(a,w),it!=null&&O.push(Mf(a,it,Ue)))),a=a.return}O.length!==0&&e.push({event:t,listeners:O})}var vm=/\r\n?/g,wm=/\u0000|\uFFFD/g;function L0(e){return(typeof e=="string"?e:""+e).replace(vm,`
`).replace(wm,"")}function M0(e,t){return t=L0(t),L0(e)===t}function Kr(e,t,a,u,h,w){switch(a){case"children":typeof u=="string"?t==="body"||t==="textarea"&&u===""||ji(e,u):(typeof u=="number"||typeof u=="bigint")&&t!=="body"&&ji(e,""+u);break;case"className":Xs(e,"class",u);break;case"tabIndex":Xs(e,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Xs(e,a,u);break;case"style":$o(e,u,w);break;case"data":if(t!=="object"){Xs(e,"data",u);break}case"src":case"href":if(u===""&&(t!=="a"||a!=="href")){e.removeAttribute(a);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){e.removeAttribute(a);break}u=Jr(""+u),e.setAttribute(a,u);break;case"action":case"formAction":if(typeof u=="function"){e.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(a==="formAction"?(t!=="input"&&Kr(e,t,"name",h.name,h,null),Kr(e,t,"formEncType",h.formEncType,h,null),Kr(e,t,"formMethod",h.formMethod,h,null),Kr(e,t,"formTarget",h.formTarget,h,null)):(Kr(e,t,"encType",h.encType,h,null),Kr(e,t,"method",h.method,h,null),Kr(e,t,"target",h.target,h,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){e.removeAttribute(a);break}u=Jr(""+u),e.setAttribute(a,u);break;case"onClick":u!=null&&(e.onclick=xr);break;case"onScroll":u!=null&&Vi("scroll",e);break;case"onScrollEnd":u!=null&&Vi("scrollend",e);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(s(61));if(a=u.__html,a!=null){if(h.children!=null)throw Error(s(60));e.innerHTML=a}}break;case"multiple":e.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":e.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){e.removeAttribute("xlink:href");break}a=Jr(""+u),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?e.setAttribute(a,""+u):e.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?e.setAttribute(a,""):e.removeAttribute(a);break;case"capture":case"download":u===!0?e.setAttribute(a,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?e.setAttribute(a,u):e.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?e.setAttribute(a,u):e.removeAttribute(a);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?e.removeAttribute(a):e.setAttribute(a,u);break;case"popover":Vi("beforetoggle",e),Vi("toggle",e),Or(e,"popover",u);break;case"xlinkActuate":Nr(e,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Nr(e,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Nr(e,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Nr(e,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Nr(e,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Nr(e,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Nr(e,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Nr(e,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Nr(e,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Or(e,"is",u);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=za.get(a)||a,Or(e,a,u))}}function Vh(e,t,a,u,h,w){switch(a){case"style":$o(e,u,w);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(s(61));if(a=u.__html,a!=null){if(h.children!=null)throw Error(s(60));e.innerHTML=a}}break;case"children":typeof u=="string"?ji(e,u):(typeof u=="number"||typeof u=="bigint")&&ji(e,""+u);break;case"onScroll":u!=null&&Vi("scroll",e);break;case"onScrollEnd":u!=null&&Vi("scrollend",e);break;case"onClick":u!=null&&(e.onclick=xr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!di.hasOwnProperty(a))e:{if(a[0]==="o"&&a[1]==="n"&&(h=a.endsWith("Capture"),t=a.slice(2,h?a.length-7:void 0),w=e[an]||null,w=w!=null?w[a]:null,typeof w=="function"&&e.removeEventListener(t,w,h),typeof u=="function")){typeof w!="function"&&w!==null&&(a in e?e[a]=null:e.hasAttribute(a)&&e.removeAttribute(a)),e.addEventListener(t,u,h);break e}a in e?e[a]=u:u===!0?e.setAttribute(a,""):Or(e,a,u)}}}function zs(e,t,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Vi("error",e),Vi("load",e);var u=!1,h=!1,w;for(w in a)if(a.hasOwnProperty(w)){var O=a[w];if(O!=null)switch(w){case"src":u=!0;break;case"srcSet":h=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:Kr(e,t,w,O,a,null)}}h&&Kr(e,t,"srcSet",a.srcSet,a,null),u&&Kr(e,t,"src",a.src,a,null);return;case"input":Vi("invalid",e);var ue=w=O=h=null,Ue=null,it=null;for(u in a)if(a.hasOwnProperty(u)){var St=a[u];if(St!=null)switch(u){case"name":h=St;break;case"type":O=St;break;case"checked":Ue=St;break;case"defaultChecked":it=St;break;case"value":w=St;break;case"defaultValue":ue=St;break;case"children":case"dangerouslySetInnerHTML":if(St!=null)throw Error(s(137,t));break;default:Kr(e,t,u,St,a,null)}}Kl(e,w,ue,Ue,it,O,h,!1);return;case"select":Vi("invalid",e),u=O=w=null;for(h in a)if(a.hasOwnProperty(h)&&(ue=a[h],ue!=null))switch(h){case"value":w=ue;break;case"defaultValue":O=ue;break;case"multiple":u=ue;default:Kr(e,t,h,ue,a,null)}t=w,a=O,e.multiple=!!u,t!=null?yr(e,!!u,t,!1):a!=null&&yr(e,!!u,a,!0);return;case"textarea":Vi("invalid",e),w=h=u=null;for(O in a)if(a.hasOwnProperty(O)&&(ue=a[O],ue!=null))switch(O){case"value":u=ue;break;case"defaultValue":h=ue;break;case"children":w=ue;break;case"dangerouslySetInnerHTML":if(ue!=null)throw Error(s(91));break;default:Kr(e,t,O,ue,a,null)}Hr(e,u,h,w);return;case"option":for(Ue in a)if(a.hasOwnProperty(Ue)&&(u=a[Ue],u!=null))switch(Ue){case"selected":e.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:Kr(e,t,Ue,u,a,null)}return;case"dialog":Vi("beforetoggle",e),Vi("toggle",e),Vi("cancel",e),Vi("close",e);break;case"iframe":case"object":Vi("load",e);break;case"video":case"audio":for(u=0;u<Lf.length;u++)Vi(Lf[u],e);break;case"image":Vi("error",e),Vi("load",e);break;case"details":Vi("toggle",e);break;case"embed":case"source":case"link":Vi("error",e),Vi("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(it in a)if(a.hasOwnProperty(it)&&(u=a[it],u!=null))switch(it){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:Kr(e,t,it,u,a,null)}return;default:if(ms(t)){for(St in a)a.hasOwnProperty(St)&&(u=a[St],u!==void 0&&Vh(e,t,St,u,a,void 0));return}}for(ue in a)a.hasOwnProperty(ue)&&(u=a[ue],u!=null&&Kr(e,t,ue,u,a,null))}function Sm(e,t,a,u){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var h=null,w=null,O=null,ue=null,Ue=null,it=null,St=null;for(ut in a){var _t=a[ut];if(a.hasOwnProperty(ut)&&_t!=null)switch(ut){case"checked":break;case"value":break;case"defaultValue":Ue=_t;default:u.hasOwnProperty(ut)||Kr(e,t,ut,null,u,_t)}}for(var rt in u){var ut=u[rt];if(_t=a[rt],u.hasOwnProperty(rt)&&(ut!=null||_t!=null))switch(rt){case"type":w=ut;break;case"name":h=ut;break;case"checked":it=ut;break;case"defaultChecked":St=ut;break;case"value":O=ut;break;case"defaultValue":ue=ut;break;case"children":case"dangerouslySetInnerHTML":if(ut!=null)throw Error(s(137,t));break;default:ut!==_t&&Kr(e,t,rt,ut,u,_t)}}Qo(e,O,ue,Ue,it,St,w,h);return;case"select":ut=O=ue=rt=null;for(w in a)if(Ue=a[w],a.hasOwnProperty(w)&&Ue!=null)switch(w){case"value":break;case"multiple":ut=Ue;default:u.hasOwnProperty(w)||Kr(e,t,w,null,u,Ue)}for(h in u)if(w=u[h],Ue=a[h],u.hasOwnProperty(h)&&(w!=null||Ue!=null))switch(h){case"value":rt=w;break;case"defaultValue":ue=w;break;case"multiple":O=w;default:w!==Ue&&Kr(e,t,h,w,u,Ue)}t=ue,a=O,u=ut,rt!=null?yr(e,!!a,rt,!1):!!u!=!!a&&(t!=null?yr(e,!!a,t,!0):yr(e,!!a,a?[]:"",!1));return;case"textarea":ut=rt=null;for(ue in a)if(h=a[ue],a.hasOwnProperty(ue)&&h!=null&&!u.hasOwnProperty(ue))switch(ue){case"value":break;case"children":break;default:Kr(e,t,ue,null,u,h)}for(O in u)if(h=u[O],w=a[O],u.hasOwnProperty(O)&&(h!=null||w!=null))switch(O){case"value":rt=h;break;case"defaultValue":ut=h;break;case"children":break;case"dangerouslySetInnerHTML":if(h!=null)throw Error(s(91));break;default:h!==w&&Kr(e,t,O,h,u,w)}Zl(e,rt,ut);return;case"option":for(var Nn in a)if(rt=a[Nn],a.hasOwnProperty(Nn)&&rt!=null&&!u.hasOwnProperty(Nn))switch(Nn){case"selected":e.selected=!1;break;default:Kr(e,t,Nn,null,u,rt)}for(Ue in u)if(rt=u[Ue],ut=a[Ue],u.hasOwnProperty(Ue)&&rt!==ut&&(rt!=null||ut!=null))switch(Ue){case"selected":e.selected=rt&&typeof rt!="function"&&typeof rt!="symbol";break;default:Kr(e,t,Ue,rt,u,ut)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ei in a)rt=a[ei],a.hasOwnProperty(ei)&&rt!=null&&!u.hasOwnProperty(ei)&&Kr(e,t,ei,null,u,rt);for(it in u)if(rt=u[it],ut=a[it],u.hasOwnProperty(it)&&rt!==ut&&(rt!=null||ut!=null))switch(it){case"children":case"dangerouslySetInnerHTML":if(rt!=null)throw Error(s(137,t));break;default:Kr(e,t,it,rt,u,ut)}return;default:if(ms(t)){for(var Zr in a)rt=a[Zr],a.hasOwnProperty(Zr)&&rt!==void 0&&!u.hasOwnProperty(Zr)&&Vh(e,t,Zr,void 0,u,rt);for(St in u)rt=u[St],ut=a[St],!u.hasOwnProperty(St)||rt===ut||rt===void 0&&ut===void 0||Vh(e,t,St,rt,u,ut);return}}for(var Xe in a)rt=a[Xe],a.hasOwnProperty(Xe)&&rt!=null&&!u.hasOwnProperty(Xe)&&Kr(e,t,Xe,null,u,rt);for(_t in u)rt=u[_t],ut=a[_t],!u.hasOwnProperty(_t)||rt===ut||rt==null&&ut==null||Kr(e,t,_t,rt,u,ut)}function B0(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Tm(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,a=performance.getEntriesByType("resource"),u=0;u<a.length;u++){var h=a[u],w=h.transferSize,O=h.initiatorType,ue=h.duration;if(w&&ue&&B0(O)){for(O=0,ue=h.responseEnd,u+=1;u<a.length;u++){var Ue=a[u],it=Ue.startTime;if(it>ue)break;var St=Ue.transferSize,_t=Ue.initiatorType;St&&B0(_t)&&(Ue=Ue.responseEnd,O+=St*(Ue<ue?1:(ue-it)/(Ue-it)))}if(--u,t+=8*(w+O)/(h.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var qh=null,Hh=null;function Mp(e){return e.nodeType===9?e:e.ownerDocument}function O0(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function F0(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Wh(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var $h=null;function Cm(){var e=window.event;return e&&e.type==="popstate"?e===$h?!1:($h=e,!0):($h=null,!1)}var U0=typeof setTimeout=="function"?setTimeout:void 0,jm=typeof clearTimeout=="function"?clearTimeout:void 0,E0=typeof Promise=="function"?Promise:void 0,Nm=typeof queueMicrotask=="function"?queueMicrotask:typeof E0<"u"?function(e){return E0.resolve(null).then(e).catch(km)}:U0;function km(e){setTimeout(function(){throw e})}function Iu(e){return e==="head"}function V0(e,t){var a=t,u=0;do{var h=a.nextSibling;if(e.removeChild(a),h&&h.nodeType===8)if(a=h.data,a==="/$"||a==="/&"){if(u===0){e.removeChild(h),Gd(t);return}u--}else if(a==="$"||a==="$?"||a==="$~"||a==="$!"||a==="&")u++;else if(a==="html")Bf(e.ownerDocument.documentElement);else if(a==="head"){a=e.ownerDocument.head,Bf(a);for(var w=a.firstChild;w;){var O=w.nextSibling,ue=w.nodeName;w[qi]||ue==="SCRIPT"||ue==="STYLE"||ue==="LINK"&&w.rel.toLowerCase()==="stylesheet"||a.removeChild(w),w=O}}else a==="body"&&Bf(e.ownerDocument.body);a=h}while(a);Gd(t)}function q0(e,t){var a=e;e=0;do{var u=a.nextSibling;if(a.nodeType===1?t?(a._stashedDisplay=a.style.display,a.style.display="none"):(a.style.display=a._stashedDisplay||"",a.getAttribute("style")===""&&a.removeAttribute("style")):a.nodeType===3&&(t?(a._stashedText=a.nodeValue,a.nodeValue=""):a.nodeValue=a._stashedText||""),u&&u.nodeType===8)if(a=u.data,a==="/$"){if(e===0)break;e--}else a!=="$"&&a!=="$?"&&a!=="$~"&&a!=="$!"||e++;a=u}while(a)}function Yh(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var a=t;switch(t=t.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":Yh(a),Br(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}e.removeChild(a)}}function Am(e,t,a,u){for(;e.nodeType===1;){var h=a;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!u&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(u){if(!e[qi])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(w=e.getAttribute("rel"),w==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(w!==h.rel||e.getAttribute("href")!==(h.href==null||h.href===""?null:h.href)||e.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin)||e.getAttribute("title")!==(h.title==null?null:h.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(w=e.getAttribute("src"),(w!==(h.src==null?null:h.src)||e.getAttribute("type")!==(h.type==null?null:h.type)||e.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin))&&w&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var w=h.name==null?null:""+h.name;if(h.type==="hidden"&&e.getAttribute("name")===w)return e}else return e;if(e=pc(e.nextSibling),e===null)break}return null}function Pm(e,t,a){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!a||(e=pc(e.nextSibling),e===null))return null;return e}function H0(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=pc(e.nextSibling),e===null))return null;return e}function Gh(e){return e.data==="$?"||e.data==="$~"}function Xh(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function zm(e,t){var a=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||a.readyState!=="loading")t();else{var u=function(){t(),a.removeEventListener("DOMContentLoaded",u)};a.addEventListener("DOMContentLoaded",u),e._reactRetry=u}}function pc(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var Kh=null;function W0(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"||a==="/&"){if(t===0)return pc(e.nextSibling);t--}else a!=="$"&&a!=="$!"&&a!=="$?"&&a!=="$~"&&a!=="&"||t++}e=e.nextSibling}return null}function $0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"){if(t===0)return e;t--}else a!=="/$"&&a!=="/&"||t++}e=e.previousSibling}return null}function Y0(e,t,a){switch(t=Mp(a),e){case"html":if(e=t.documentElement,!e)throw Error(s(452));return e;case"head":if(e=t.head,!e)throw Error(s(453));return e;case"body":if(e=t.body,!e)throw Error(s(454));return e;default:throw Error(s(451))}}function Bf(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Br(e)}var hc=new Map,G0=new Set;function Bp(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var hu=de.d;de.d={f:_m,r:Dm,D:Rm,C:Im,L:Lm,m:Mm,X:Om,S:Bm,M:Fm};function _m(){var e=hu.f(),t=Ao();return e||t}function Dm(e){var t=ar(e);t!==null&&t.tag===5&&t.type==="form"?pp(t):hu.r(e)}var Wd=typeof document>"u"?null:document;function X0(e,t,a){var u=Wd;if(u&&typeof t=="string"&&t){var h=Hi(t);h='link[rel="'+e+'"][href="'+h+'"]',typeof a=="string"&&(h+='[crossorigin="'+a+'"]'),G0.has(h)||(G0.add(h),e={rel:e,crossOrigin:a,href:t},u.querySelector(h)===null&&(t=u.createElement("link"),zs(t,"link",e),Hn(t),u.head.appendChild(t)))}}function Rm(e){hu.D(e),X0("dns-prefetch",e,null)}function Im(e,t){hu.C(e,t),X0("preconnect",e,t)}function Lm(e,t,a){hu.L(e,t,a);var u=Wd;if(u&&e&&t){var h='link[rel="preload"][as="'+Hi(t)+'"]';t==="image"&&a&&a.imageSrcSet?(h+='[imagesrcset="'+Hi(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(h+='[imagesizes="'+Hi(a.imageSizes)+'"]')):h+='[href="'+Hi(e)+'"]';var w=h;switch(t){case"style":w=$d(e);break;case"script":w=Yd(e)}hc.has(w)||(e=D({rel:"preload",href:t==="image"&&a&&a.imageSrcSet?void 0:e,as:t},a),hc.set(w,e),u.querySelector(h)!==null||t==="style"&&u.querySelector(Of(w))||t==="script"&&u.querySelector(Ff(w))||(t=u.createElement("link"),zs(t,"link",e),Hn(t),u.head.appendChild(t)))}}function Mm(e,t){hu.m(e,t);var a=Wd;if(a&&e){var u=t&&typeof t.as=="string"?t.as:"script",h='link[rel="modulepreload"][as="'+Hi(u)+'"][href="'+Hi(e)+'"]',w=h;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=Yd(e)}if(!hc.has(w)&&(e=D({rel:"modulepreload",href:e},t),hc.set(w,e),a.querySelector(h)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(Ff(w)))return}u=a.createElement("link"),zs(u,"link",e),Hn(u),a.head.appendChild(u)}}}function Bm(e,t,a){hu.S(e,t,a);var u=Wd;if(u&&e){var h=zo(u).hoistableStyles,w=$d(e);t=t||"default";var O=h.get(w);if(!O){var ue={loading:0,preload:null};if(O=u.querySelector(Of(w)))ue.loading=5;else{e=D({rel:"stylesheet",href:e,"data-precedence":t},a),(a=hc.get(w))&&Zh(e,a);var Ue=O=u.createElement("link");Hn(Ue),zs(Ue,"link",e),Ue._p=new Promise(function(it,St){Ue.onload=it,Ue.onerror=St}),Ue.addEventListener("load",function(){ue.loading|=1}),Ue.addEventListener("error",function(){ue.loading|=2}),ue.loading|=4,Op(O,t,u)}O={type:"stylesheet",instance:O,count:1,state:ue},h.set(w,O)}}}function Om(e,t){hu.X(e,t);var a=Wd;if(a&&e){var u=zo(a).hoistableScripts,h=Yd(e),w=u.get(h);w||(w=a.querySelector(Ff(h)),w||(e=D({src:e,async:!0},t),(t=hc.get(h))&&Jh(e,t),w=a.createElement("script"),Hn(w),zs(w,"link",e),a.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},u.set(h,w))}}function Fm(e,t){hu.M(e,t);var a=Wd;if(a&&e){var u=zo(a).hoistableScripts,h=Yd(e),w=u.get(h);w||(w=a.querySelector(Ff(h)),w||(e=D({src:e,async:!0,type:"module"},t),(t=hc.get(h))&&Jh(e,t),w=a.createElement("script"),Hn(w),zs(w,"link",e),a.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},u.set(h,w))}}function K0(e,t,a,u){var h=(h=Ce.current)?Bp(h):null;if(!h)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(t=$d(a.href),a=zo(h).hoistableStyles,u=a.get(t),u||(u={type:"style",instance:null,count:0,state:null},a.set(t,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){e=$d(a.href);var w=zo(h).hoistableStyles,O=w.get(e);if(O||(h=h.ownerDocument||h,O={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(e,O),(w=h.querySelector(Of(e)))&&!w._p&&(O.instance=w,O.state.loading=5),hc.has(e)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},hc.set(e,a),w||Um(h,e,a,O.state))),t&&u===null)throw Error(s(528,""));return O}if(t&&u!==null)throw Error(s(529,""));return null;case"script":return t=a.async,a=a.src,typeof a=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Yd(a),a=zo(h).hoistableScripts,u=a.get(t),u||(u={type:"script",instance:null,count:0,state:null},a.set(t,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function $d(e){return'href="'+Hi(e)+'"'}function Of(e){return'link[rel="stylesheet"]['+e+"]"}function Z0(e){return D({},e,{"data-precedence":e.precedence,precedence:null})}function Um(e,t,a,u){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?u.loading=1:(t=e.createElement("link"),u.preload=t,t.addEventListener("load",function(){return u.loading|=1}),t.addEventListener("error",function(){return u.loading|=2}),zs(t,"link",a),Hn(t),e.head.appendChild(t))}function Yd(e){return'[src="'+Hi(e)+'"]'}function Ff(e){return"script[async]"+e}function J0(e,t,a){if(t.count++,t.instance===null)switch(t.type){case"style":var u=e.querySelector('style[data-href~="'+Hi(a.href)+'"]');if(u)return t.instance=u,Hn(u),u;var h=D({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return u=(e.ownerDocument||e).createElement("style"),Hn(u),zs(u,"style",h),Op(u,a.precedence,e),t.instance=u;case"stylesheet":h=$d(a.href);var w=e.querySelector(Of(h));if(w)return t.state.loading|=4,t.instance=w,Hn(w),w;u=Z0(a),(h=hc.get(h))&&Zh(u,h),w=(e.ownerDocument||e).createElement("link"),Hn(w);var O=w;return O._p=new Promise(function(ue,Ue){O.onload=ue,O.onerror=Ue}),zs(w,"link",u),t.state.loading|=4,Op(w,a.precedence,e),t.instance=w;case"script":return w=Yd(a.src),(h=e.querySelector(Ff(w)))?(t.instance=h,Hn(h),h):(u=a,(h=hc.get(w))&&(u=D({},a),Jh(u,h)),e=e.ownerDocument||e,h=e.createElement("script"),Hn(h),zs(h,"link",u),e.head.appendChild(h),t.instance=h);case"void":return null;default:throw Error(s(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(u=t.instance,t.state.loading|=4,Op(u,a.precedence,e));return t.instance}function Op(e,t,a){for(var u=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),h=u.length?u[u.length-1]:null,w=h,O=0;O<u.length;O++){var ue=u[O];if(ue.dataset.precedence===t)w=ue;else if(w!==h)break}w?w.parentNode.insertBefore(e,w.nextSibling):(t=a.nodeType===9?a.head:a,t.insertBefore(e,t.firstChild))}function Zh(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Jh(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var Fp=null;function Q0(e,t,a){if(Fp===null){var u=new Map,h=Fp=new Map;h.set(a,u)}else h=Fp,u=h.get(a),u||(u=new Map,h.set(a,u));if(u.has(e))return u;for(u.set(e,null),a=a.getElementsByTagName(e),h=0;h<a.length;h++){var w=a[h];if(!(w[qi]||w[Dt]||e==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var O=w.getAttribute(t)||"";O=e+O;var ue=u.get(O);ue?ue.push(w):u.set(O,[w])}}return u}function e1(e,t,a){e=e.ownerDocument||e,e.head.insertBefore(a,t==="title"?e.querySelector("head > title"):null)}function Em(e,t,a){if(a===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function t1(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function Vm(e,t,a,u){if(a.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var h=$d(u.href),w=t.querySelector(Of(h));if(w){t=w._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=Up.bind(e),t.then(e,e)),a.state.loading|=4,a.instance=w,Hn(w);return}w=t.ownerDocument||t,u=Z0(u),(h=hc.get(h))&&Zh(u,h),w=w.createElement("link"),Hn(w);var O=w;O._p=new Promise(function(ue,Ue){O.onload=ue,O.onerror=Ue}),zs(w,"link",u),a.instance=w}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(a,t),(t=a.state.preload)&&(a.state.loading&3)===0&&(e.count++,a=Up.bind(e),t.addEventListener("load",a),t.addEventListener("error",a))}}var Qh=0;function qm(e,t){return e.stylesheets&&e.count===0&&Vp(e,e.stylesheets),0<e.count||0<e.imgCount?function(a){var u=setTimeout(function(){if(e.stylesheets&&Vp(e,e.stylesheets),e.unsuspend){var w=e.unsuspend;e.unsuspend=null,w()}},6e4+t);0<e.imgBytes&&Qh===0&&(Qh=62500*Tm());var h=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Vp(e,e.stylesheets),e.unsuspend)){var w=e.unsuspend;e.unsuspend=null,w()}},(e.imgBytes>Qh?50:800)+t);return e.unsuspend=a,function(){e.unsuspend=null,clearTimeout(u),clearTimeout(h)}}:null}function Up(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Vp(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Ep=null;function Vp(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Ep=new Map,t.forEach(Hm,e),Ep=null,Up.call(e))}function Hm(e,t){if(!(t.state.loading&4)){var a=Ep.get(e);if(a)var u=a.get(null);else{a=new Map,Ep.set(e,a);for(var h=e.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<h.length;w++){var O=h[w];(O.nodeName==="LINK"||O.getAttribute("media")!=="not all")&&(a.set(O.dataset.precedence,O),u=O)}u&&a.set(null,u)}h=t.instance,O=h.getAttribute("data-precedence"),w=a.get(O)||u,w===u&&a.set(null,h),a.set(O,h),this.count++,u=Up.bind(this),h.addEventListener("load",u),h.addEventListener("error",u),w?w.parentNode.insertBefore(h,w.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(h,e.firstChild)),t.state.loading|=4}}var Uf={$$typeof:V,Provider:null,Consumer:null,_currentValue:je,_currentValue2:je,_threadCount:0};function Wm(e,t,a,u,h,w,O,ue,Ue){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Mr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Mr(0),this.hiddenUpdates=Mr(null),this.identifierPrefix=u,this.onUncaughtError=h,this.onCaughtError=w,this.onRecoverableError=O,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Ue,this.incompleteTransitions=new Map}function n1(e,t,a,u,h,w,O,ue,Ue,it,St,_t){return e=new Wm(e,t,a,O,Ue,it,St,_t,ue),t=1,w===!0&&(t|=24),w=Ti(3,null,null,t),e.current=w,w.stateNode=e,t=Bo(),t.refCount++,e.pooledCache=t,t.refCount++,w.memoizedState={element:u,isDehydrated:a,cache:t},Xt(w),e}function i1(e){return e?(e=$r,e):$r}function r1(e,t,a,u,h,w){h=i1(h),u.context===null?u.context=h:u.pendingContext=h,u=Yn(t),u.payload={element:a},w=w===void 0?null:w,w!==null&&(u.callback=w),a=gi(e,u,t),a!==null&&(Rt(a,e,t),tr(a,e,t))}function o1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<t?a:t}}function eg(e,t){o1(e,t),(e=e.alternate)&&o1(e,t)}function a1(e){if(e.tag===13||e.tag===31){var t=ll(e,67108864);t!==null&&Rt(t,e,67108864),eg(e,67108864)}}function s1(e){if(e.tag===13||e.tag===31){var t=Xn();t=hi(t);var a=ll(e,t);a!==null&&Rt(a,e,t),eg(e,t)}}var qp=!0;function $m(e,t,a,u){var h=te.T;te.T=null;var w=de.p;try{de.p=2,tg(e,t,a,u)}finally{de.p=w,te.T=h}}function Ym(e,t,a,u){var h=te.T;te.T=null;var w=de.p;try{de.p=8,tg(e,t,a,u)}finally{de.p=w,te.T=h}}function tg(e,t,a,u){if(qp){var h=ng(u);if(h===null)Eh(e,t,u,Hp,a),c1(e,u);else if(Xm(h,e,t,a,u))u.stopPropagation();else if(c1(e,u),t&4&&-1<Gm.indexOf(e)){for(;h!==null;){var w=ar(h);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var O=dn(w.pendingLanes);if(O!==0){var ue=w;for(ue.pendingLanes|=2,ue.entangledLanes|=2;O;){var Ue=1<<31-Vt(O);ue.entanglements[1]|=Ue,O&=~Ue}$c(w),(P&6)===0&&(cn=xn()+500,If(0))}}break;case 31:case 13:ue=ll(w,2),ue!==null&&Rt(ue,w,2),Ao(),eg(w,2)}if(w=ng(u),w===null&&Eh(e,t,u,Hp,a),w===h)break;h=w}h!==null&&u.stopPropagation()}else Eh(e,t,u,null,a)}}function ng(e){return e=Ua(e),ig(e)}var Hp=null;function ig(e){if(Hp=null,e=_i(e),e!==null){var t=d(e);if(t===null)e=null;else{var a=t.tag;if(a===13){if(e=b(t),e!==null)return e;e=null}else if(a===31){if(e=p(t),e!==null)return e;e=null}else if(a===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Hp=e,null}function l1(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(tt()){case Rn:return 2;case Lt:return 8;case Wt:case vn:return 32;case ct:return 268435456;default:return 32}default:return 32}}var rg=!1,Lu=null,Mu=null,Bu=null,Ef=new Map,Vf=new Map,Ou=[],Gm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function c1(e,t){switch(e){case"focusin":case"focusout":Lu=null;break;case"dragenter":case"dragleave":Mu=null;break;case"mouseover":case"mouseout":Bu=null;break;case"pointerover":case"pointerout":Ef.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vf.delete(t.pointerId)}}function qf(e,t,a,u,h,w){return e===null||e.nativeEvent!==w?(e={blockedOn:t,domEventName:a,eventSystemFlags:u,nativeEvent:w,targetContainers:[h]},t!==null&&(t=ar(t),t!==null&&a1(t)),e):(e.eventSystemFlags|=u,t=e.targetContainers,h!==null&&t.indexOf(h)===-1&&t.push(h),e)}function Xm(e,t,a,u,h){switch(t){case"focusin":return Lu=qf(Lu,e,t,a,u,h),!0;case"dragenter":return Mu=qf(Mu,e,t,a,u,h),!0;case"mouseover":return Bu=qf(Bu,e,t,a,u,h),!0;case"pointerover":var w=h.pointerId;return Ef.set(w,qf(Ef.get(w)||null,e,t,a,u,h)),!0;case"gotpointercapture":return w=h.pointerId,Vf.set(w,qf(Vf.get(w)||null,e,t,a,u,h)),!0}return!1}function u1(e){var t=_i(e.target);if(t!==null){var a=d(t);if(a!==null){if(t=a.tag,t===13){if(t=b(a),t!==null){e.blockedOn=t,mn(e.priority,function(){s1(a)});return}}else if(t===31){if(t=p(a),t!==null){e.blockedOn=t,mn(e.priority,function(){s1(a)});return}}else if(t===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Wp(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var a=ng(e.nativeEvent);if(a===null){a=e.nativeEvent;var u=new a.constructor(a.type,a);bs=u,a.target.dispatchEvent(u),bs=null}else return t=ar(a),t!==null&&a1(t),e.blockedOn=a,!1;t.shift()}return!0}function d1(e,t,a){Wp(e)&&a.delete(t)}function Km(){rg=!1,Lu!==null&&Wp(Lu)&&(Lu=null),Mu!==null&&Wp(Mu)&&(Mu=null),Bu!==null&&Wp(Bu)&&(Bu=null),Ef.forEach(d1),Vf.forEach(d1)}function $p(e,t){e.blockedOn===t&&(e.blockedOn=null,rg||(rg=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Km)))}var Yp=null;function f1(e){Yp!==e&&(Yp=e,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Yp===e&&(Yp=null);for(var t=0;t<e.length;t+=3){var a=e[t],u=e[t+1],h=e[t+2];if(typeof u!="function"){if(ig(u||a)===null)continue;break}var w=ar(a);w!==null&&(e.splice(t,3),t-=3,pf(w,{pending:!0,data:h,method:a.method,action:u},u,h))}}))}function Gd(e){function t(Ue){return $p(Ue,e)}Lu!==null&&$p(Lu,e),Mu!==null&&$p(Mu,e),Bu!==null&&$p(Bu,e),Ef.forEach(t),Vf.forEach(t);for(var a=0;a<Ou.length;a++){var u=Ou[a];u.blockedOn===e&&(u.blockedOn=null)}for(;0<Ou.length&&(a=Ou[0],a.blockedOn===null);)u1(a),a.blockedOn===null&&Ou.shift();if(a=(e.ownerDocument||e).$$reactFormReplay,a!=null)for(u=0;u<a.length;u+=3){var h=a[u],w=a[u+1],O=h[an]||null;if(typeof w=="function")O||f1(a);else if(O){var ue=null;if(w&&w.hasAttribute("formAction")){if(h=w,O=w[an]||null)ue=O.formAction;else if(ig(h)!==null)continue}else ue=O.action;typeof ue=="function"?a[u+1]=ue:(a.splice(u,3),u-=3),f1(a)}}}function p1(){function e(w){w.canIntercept&&w.info==="react-transition"&&w.intercept({handler:function(){return new Promise(function(O){return h=O})},focusReset:"manual",scroll:"manual"})}function t(){h!==null&&(h(),h=null),u||setTimeout(a,20)}function a(){if(!u&&!navigation.transition){var w=navigation.currentEntry;w&&w.url!=null&&navigation.navigate(w.url,{state:w.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,h=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(a,100),function(){u=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),h!==null&&(h(),h=null)}}}function og(e){this._internalRoot=e}Gp.prototype.render=og.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(s(409));var a=t.current,u=Xn();r1(a,u,e,t,null,null)},Gp.prototype.unmount=og.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;r1(e.current,2,null,e,null,null),Ao(),t[rn]=null}};function Gp(e){this._internalRoot=e}Gp.prototype.unstable_scheduleHydration=function(e){if(e){var t=Wn();e={blockedOn:null,target:e,priority:t};for(var a=0;a<Ou.length&&t!==0&&t<Ou[a].priority;a++);Ou.splice(a,0,e),a===0&&u1(e)}};var h1=r.version;if(h1!=="19.2.0")throw Error(s(527,h1,"19.2.0"));de.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(s(188)):(e=Object.keys(e).join(","),Error(s(268,e)));return e=m(t),e=e!==null?C(e):null,e=e===null?null:e.stateNode,e};var Zm={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:te,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xp.isDisabled&&Xp.supportsFiber)try{Nt=Xp.inject(Zm),Ke=Xp}catch{}}return Wf.createRoot=function(e,t){if(!l(e))throw Error(s(299));var a=!1,u="",h=yp,w=xp,O=Nc;return t!=null&&(t.unstable_strictMode===!0&&(a=!0),t.identifierPrefix!==void 0&&(u=t.identifierPrefix),t.onUncaughtError!==void 0&&(h=t.onUncaughtError),t.onCaughtError!==void 0&&(w=t.onCaughtError),t.onRecoverableError!==void 0&&(O=t.onRecoverableError)),t=n1(e,1,!1,null,null,a,u,null,h,w,O,p1),e[rn]=t.current,Uh(e),new og(t)},Wf.hydrateRoot=function(e,t,a){if(!l(e))throw Error(s(299));var u=!1,h="",w=yp,O=xp,ue=Nc,Ue=null;return a!=null&&(a.unstable_strictMode===!0&&(u=!0),a.identifierPrefix!==void 0&&(h=a.identifierPrefix),a.onUncaughtError!==void 0&&(w=a.onUncaughtError),a.onCaughtError!==void 0&&(O=a.onCaughtError),a.onRecoverableError!==void 0&&(ue=a.onRecoverableError),a.formState!==void 0&&(Ue=a.formState)),t=n1(e,1,!0,t,a??null,u,h,Ue,w,O,ue,p1),t.context=i1(null),a=t.current,u=Xn(),u=hi(u),h=Yn(u),h.callback=null,gi(a,h,u),a=u,t.current.lanes=a,qt(t,a),$c(t),e[rn]=t.current,Uh(e),new Gp(t)},Wf.version="19.2.0",Wf}var C1;function l2(){if(C1)return lg.exports;C1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(r){console.error(r)}}return n(),lg.exports=s2(),lg.exports}var c2=l2();/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u2=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),d2=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(r,o,s)=>s?s.toUpperCase():o.toLowerCase()),j1=n=>{const r=d2(n);return r.charAt(0).toUpperCase()+r.slice(1)},Jy=(...n)=>n.filter((r,o,s)=>!!r&&r.trim()!==""&&s.indexOf(r)===o).join(" ").trim(),f2=n=>{for(const r in n)if(r.startsWith("aria-")||r==="role"||r==="title")return!0};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var p2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h2=L.forwardRef(({color:n="currentColor",size:r=24,strokeWidth:o=2,absoluteStrokeWidth:s,className:l="",children:d,iconNode:b,...p},v)=>L.createElement("svg",{ref:v,...p2,width:r,height:r,stroke:n,strokeWidth:s?Number(o)*24/Number(r):o,className:Jy("lucide",l),...!d&&!f2(p)&&{"aria-hidden":"true"},...p},[...b.map(([m,C])=>L.createElement(m,C)),...Array.isArray(d)?d:[d]]));/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qy=(n,r)=>{const o=L.forwardRef(({className:s,...l},d)=>L.createElement(h2,{ref:d,iconNode:r,className:Jy(`lucide-${u2(j1(n))}`,`lucide-${n}`,s),...l}));return o.displayName=j1(n),o};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g2=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],y2=Qy("mouse-pointer",g2);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x2=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],m2=Qy("pen-line",x2),b2=JSON.parse('[{"category":"Capacitors","subcategory":"General","type":"Capacitor","displayName":"Capacitor","description":"General purpose capacitor","searchText":"capacitor general","designator":"C","defaultPins":2,"properties":{"capacitorType":"General"},"fields":[{"name":"capacitance","label":"Capacitance","type":"number","units":["pF","nF","F","mF","F"],"defaultUnit":"F","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"tolerance","label":"Tolerance","type":"string","required":false},{"name":"dielectric","label":"Dielectric","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Capacitors","subcategory":"Electrolytic","type":"Capacitor","displayName":"Electrolytic","description":"Electrolytic capacitor","searchText":"electrolytic capacitor","designator":"CE","defaultPins":2,"properties":{"capacitorType":"Electrolytic","polarized":true},"fields":[{"name":"capacitance","label":"Capacitance","type":"number","units":["pF","nF","F","mF","F"],"defaultUnit":"F","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"tolerance","label":"Tolerance","type":"string","defaultValue":"20%","required":false},{"name":"esr","label":"ESR","type":"number","units":["m",""],"defaultUnit":"","required":false},{"name":"temperature","label":"Temperature Range","type":"string","required":false},{"name":"ripple","label":"Ripple Current","type":"number","units":["mA","A"],"defaultUnit":"mA","required":false},{"name":"leakageCurrent","label":"Leakage Current","type":"number","units":["A","mA"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Capacitors","subcategory":"Film","type":"Capacitor","displayName":"Film","description":"Film capacitor","searchText":"film capacitor","designator":"CF","defaultPins":2,"properties":{"capacitorType":"Film"},"fields":[{"name":"capacitance","label":"Capacitance","type":"number","units":["pF","nF","F","mF","F"],"defaultUnit":"nF","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"tolerance","label":"Tolerance","type":"string","defaultValue":"10%","required":false},{"name":"filmType","label":"Film Type","type":"enum","enumValues":["Polyester","Polypropylene","Polyethylene","Polystyrene","Teflon"],"defaultValue":"Polyester","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Capacitors","subcategory":"Tantalum","type":"Capacitor","displayName":"Tantalum","description":"Tantalum capacitor","searchText":"tantalum capacitor","designator":"C","defaultPins":2,"properties":{"capacitorType":"Tantalum","dielectric":"Tantalum","polarized":true},"fields":[{"name":"capacitance","label":"Capacitance","type":"number","units":["pF","nF","F","mF","F"],"defaultUnit":"F","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"tolerance","label":"Tolerance","type":"string","required":false},{"name":"esr","label":"ESR","type":"number","units":["m",""],"defaultUnit":"","required":false},{"name":"leakageCurrent","label":"Leakage Current","type":"number","units":["A","mA"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Diodes","subcategory":"Standard","type":"Diode","displayName":"Diode","description":"Standard diode","searchText":"diode standard","designator":"D","defaultPins":2,"subtype":"Standard","properties":{"diodeType":"Standard","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"Zener","type":"Diode","displayName":"Zener","description":"Zener diode","searchText":"zener diode","designator":"Z","defaultPins":2,"subtype":"Zener","properties":{"diodeType":"Zener","polarized":true},"fields":[{"name":"voltage","label":"Zener Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"mA","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"LED","type":"Diode","displayName":"LED","description":"LED diode","searchText":"led diode","designator":"LED","defaultPins":2,"subtype":"LED","properties":{"diodeType":"LED","polarized":true},"fields":[{"name":"voltage","label":"Forward Voltage","type":"number","units":["mV","V"],"defaultUnit":"V","required":false},{"name":"current","label":"Forward Current","type":"number","units":["mA","A"],"defaultUnit":"mA","required":false},{"name":"ledColor","label":"Color","type":"string","required":false},{"name":"wavelength","label":"Wavelength","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"Schottky","type":"Diode","displayName":"Schottky","description":"Schottky diode","searchText":"schottky diode","designator":"D","defaultPins":2,"subtype":"Schottky","properties":{"diodeType":"Schottky","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"Infrared","type":"Diode","displayName":"Infrared","description":"Infrared diode","searchText":"infrared diode","designator":"IR","defaultPins":2,"subtype":"Infrared","properties":{"diodeType":"Infrared","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["mA","A"],"defaultUnit":"mA","required":false},{"name":"wavelength","label":"Wavelength","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"Photodiode","type":"Diode","displayName":"Photodiode","description":"Photodiode","searchText":"photodiode diode","designator":"PD","defaultPins":2,"subtype":"Photodiode","properties":{"diodeType":"Photodiode","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"wavelength","label":"Wavelength","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Resistors","subcategory":"Standard","type":"Resistor","displayName":"Resistor","description":"Standard resistor","searchText":"resistor standard","designator":"R","defaultPins":2,"properties":{"resistorType":"Standard"},"fields":[{"name":"resistance","label":"Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"tolerance","label":"Tolerance","type":"string","defaultValue":"5%","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Resistors","subcategory":"Network","type":"Resistor","displayName":"Resistor Network","description":"Resistor network","searchText":"resistor network","designator":"RN","defaultPins":8,"properties":{"resistorType":"Network"},"fields":[{"name":"resistance","label":"Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"configuration","label":"Configuration","type":"enum","enumValues":["Isolated","Bussed","Dual Terminator"],"defaultValue":"Isolated","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Resistors","subcategory":"Thermistor","type":"Resistor","displayName":"Thermistor","description":"Thermistor resistor","searchText":"thermistor resistor","designator":"RT","defaultPins":2,"properties":{"resistorType":"Thermistor"},"fields":[{"name":"resistance","label":"Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"thermistorType","label":"Thermistor Type","type":"enum","enumValues":["NTC","PTC"],"defaultValue":"NTC","required":false},{"name":"beta","label":"Beta Value","type":"number","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Resistors","subcategory":"Variable","type":"Resistor","displayName":"Variable Resistor","description":"Variable resistor","searchText":"variable resistor","designator":"VR","defaultPins":3,"subtype":"Potentiometer","properties":{"resistorType":"Variable","vrType":"Potentiometer"},"fields":[{"name":"resistance","label":"Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"taper","label":"Taper","type":"enum","enumValues":["Linear","Logarithmic"],"defaultValue":"Linear","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Resistors","subcategory":"Varistor","type":"Resistor","displayName":"Varistor","description":"Varistor resistor","searchText":"varistor resistor","designator":"RV","defaultPins":3,"subtype":"Varistor","properties":{"resistorType":"Variable","vrType":"Varistor"},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"BJT","type":"Semiconductor","displayName":"Transistor, BJT NPN","description":"Bipolar Junction Transistor NPN (Collector, Base, Emitter)","searchText":"bjt transistor bipolar junction base emitter collector npn","designator":"Q","defaultPins":3,"properties":{"semiconductorType":"Transistor","transistorType":"BJT","pinNames":["Collector","Base","Emitter"]},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"BJT PNP","type":"Semiconductor","displayName":"Transistor, BJT PNP","description":"Bipolar Junction Transistor PNP (Emitter, Base, Collector)","searchText":"bjt transistor bipolar junction base emitter collector pnp","designator":"Q","defaultPins":3,"properties":{"semiconductorType":"Transistor","transistorType":"BJT","pinNames":["Emitter","Base","Collector"]},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"MOSFET","type":"Semiconductor","displayName":"Transistor, MOSFET, N-Channel","description":"Metal-Oxide-Semiconductor Field-Effect Transistor N-Channel (Source, Gate, Drain)","searchText":"mosfet transistor metal oxide semiconductor field effect source gate drain n-channel","designator":"Q","defaultPins":3,"properties":{"semiconductorType":"Transistor","transistorType":"MOSFET","pinNames":["Source","Drain","Gate"]},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"MOSFET P-Channel","type":"Semiconductor","displayName":"Transistor, MOSFET, P-Channel","description":"Metal-Oxide-Semiconductor Field-Effect Transistor P-Channel (Source, Gate, Drain)","searchText":"mosfet transistor metal oxide semiconductor field effect source gate drain p-channel","designator":"Q","defaultPins":3,"properties":{"semiconductorType":"Transistor","transistorType":"MOSFET","pinNames":["Source","Drain","Gate"]},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"JFET","type":"Semiconductor","displayName":"Transistor, JFET","description":"Junction Field-Effect Transistor (Source, Gate, Drain)","searchText":"jfet transistor junction field effect source gate drain n-channel p-channel","designator":"Q","defaultPins":3,"properties":{"semiconductorType":"Transistor","transistorType":"JFET","pinNames":["Source","Gate","Drain"]},"fields":[{"name":"polarity","label":"Polarity","type":"enum","enumValues":["N-Channel","P-Channel"],"defaultValue":"N-Channel","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"Single Op Amp","type":"Semiconductor","displayName":"Op Amp, Single","description":"Single operational amplifier","searchText":"single op amp operational amplifier opamp","designator":"U","defaultPins":5,"properties":{"semiconductorType":"OpAmp","pinNames":["V+","V-","input+","input-","output"]},"fields":[{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"packageType","label":"Package Type","type":"enum","enumValues":["SOT-23-5","SC70-5","Other"],"defaultValue":"SOT-23-5","required":false},{"name":"voltage","label":"Supply Voltage","type":"number","units":["V","mV"],"defaultUnit":"V","required":false},{"name":"description","label":"Description","type":"string","required":false},{"name":"datasheet","label":"Datasheet URL","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"Dual Op Amp","type":"Semiconductor","displayName":"Op Amp, Dual","description":"Dual operational amplifier","searchText":"dual op amp operational amplifier opamp","designator":"U","defaultPins":8,"properties":{"semiconductorType":"OpAmp","pinNames":["Output 1","Input 1-","Input 1+","VEE / GND","Input 2+","Input 2-","Output 2","VCC / V+"]},"fields":[{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"packageType","label":"Package Type","type":"enum","enumValues":["DIP-8","SOIC-8","DIP-14","SOIC-14","SOT-23-5","Other"],"defaultValue":"DIP-8","required":false},{"name":"voltage","label":"Supply Voltage","type":"number","units":["V","mV"],"defaultUnit":"V","required":false},{"name":"description","label":"Description","type":"string","required":false},{"name":"datasheet","label":"Datasheet URL","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"Quad Op Amp","type":"Semiconductor","displayName":"Op Amp, Quad","description":"Quad operational amplifier","searchText":"quad op amp operational amplifier opamp","designator":"U","defaultPins":14,"properties":{"semiconductorType":"OpAmp","pinNames":["1OUT","1IN-","1IN+","VCC+","2IN+","2IN-","2OUT","3OUT","3IN-","3IN+","VCC-","4IN+","4IN-","4OUT"]},"fields":[{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"packageType","label":"Package Type","type":"enum","enumValues":["DIP-14","SOIC-14","TSSOP-14","Other"],"defaultValue":"DIP-14","required":false},{"name":"voltage","label":"Supply Voltage","type":"number","units":["V","mV"],"defaultUnit":"V","required":false},{"name":"description","label":"Description","type":"string","required":false},{"name":"datasheet","label":"Datasheet URL","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"Integrated Circuit","type":"Semiconductor","displayName":"Integrated Circuit","description":"Integrated circuit","searchText":"integrated circuit semiconductor ic","designator":"U","defaultPins":8,"fixedPinCount":false,"properties":{"semiconductorType":"IntegratedCircuit","pinNames":["CHIP_DEPENDENT"]},"fields":[{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"icType","label":"IC Type","type":"string","required":false},{"name":"packageType","label":"Package Type","type":"enum","enumValues":["DIP","SOIC","QFP","LQFP","TQFP","BGA","SSOP","TSOP","Various","Other"],"required":false},{"name":"description","label":"Description","type":"string","required":false},{"name":"datasheet","label":"Datasheet URL","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Passive Components","subcategory":"Inductor","type":"Inductor","displayName":"Inductor","description":"Inductor","searchText":"inductor","designator":"L","defaultPins":2,"properties":{"passiveType":"Inductor"},"fields":[{"name":"inductance","label":"Inductance","type":"number","units":["nH","H","mH","H"],"defaultUnit":"H","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"resistance","label":"DC Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Passive Components","subcategory":"Ferrite Bead","type":"FerriteBead","displayName":"Ferrite Bead","description":"Ferrite bead","searchText":"ferrite bead passive","designator":"FB","defaultPins":2,"properties":{"passiveType":"FerriteBead"},"fields":[{"name":"impedance","label":"Impedance","type":"number","units":["","m","k"],"defaultUnit":"","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Passive Components","subcategory":"Crystal","type":"Crystal","displayName":"Crystal","description":"Crystal oscillator","searchText":"crystal oscillator passive","designator":"X","defaultPins":2,"properties":{"passiveType":"Crystal"},"fields":[{"name":"frequency","label":"Frequency","type":"string","required":false},{"name":"loadCapacitance","label":"Load Capacitance","type":"string","required":false},{"name":"tolerance","label":"Tolerance","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Power & Energy","subcategory":"Battery","type":"PowerEnergy","displayName":"Battery","description":"Battery or battery holder","searchText":"battery power energy","designator":"B","defaultPins":2,"properties":{"powerType":"Battery","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"capacity","label":"Capacity","type":"number","units":["mAh","Ah"],"defaultUnit":"mAh","required":false},{"name":"chemistry","label":"Chemistry","type":"enum","enumValues":["Li-ion","Alkaline","NiMH","NiCd","Lead-acid"],"required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Power & Energy","subcategory":"Power Supply","type":"PowerEnergy","displayName":"Power Supply","description":"Power supply","searchText":"power supply energy","designator":"PS","defaultPins":4,"properties":{"powerType":"PowerSupply"},"fields":[{"name":"inputVoltage","label":"Input Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"outputVoltage","label":"Output Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"efficiency","label":"Efficiency","type":"number","required":false},{"name":"ripple","label":"Ripple","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Power & Energy","subcategory":"Fuse","type":"PowerEnergy","displayName":"Fuse","description":"Fuse","searchText":"fuse power energy","designator":"F","defaultPins":2,"properties":{"powerType":"Fuse"},"fields":[{"name":"current","label":"Current Rating","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"fuseType","label":"Fuse Type","type":"enum","enumValues":["Fast-blow","Slow-blow","Time-delay"],"defaultValue":"Fast-blow","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Connectors & Switches","subcategory":"Connector","type":"Connector","displayName":"Connector","description":"Connector","searchText":"connector","designator":"J","defaultPins":2,"properties":{"connectorType":"Connector"},"fields":[{"name":"connectorType","label":"Connector Type","type":"string","required":false},{"name":"gender","label":"Gender","type":"enum","enumValues":["Male","Female","N/A"],"defaultValue":"N/A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Connectors & Switches","subcategory":"Jumper","type":"Jumper","displayName":"Jumper","description":"Jumper link","searchText":"jumper link","designator":"JP","defaultPins":2,"properties":{"connectorType":"Jumper"},"fields":[{"name":"positions","label":"Positions","type":"number","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Connectors & Switches","subcategory":"Switch","type":"Switch","displayName":"Switch","description":"Switch","searchText":"switch","designator":"S","defaultPins":2,"properties":{"switchType":"Switch"},"fields":[{"name":"switchType","label":"Switch Type","type":"string","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Connectors & Switches","subcategory":"Relay","type":"Relay","displayName":"Relay","description":"Relay or contactor","searchText":"relay contactor","designator":"K","defaultPins":2,"properties":{"switchType":"Relay"},"fields":[{"name":"coilVoltage","label":"Coil Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"contactType","label":"Contact Type","type":"string","required":false},{"name":"current","label":"Contact Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Other","subcategory":"Transformer","type":"Transformer","displayName":"Transformer","description":"Transformer","searchText":"transformer","designator":"TR","defaultPins":4,"fields":[{"name":"primaryVoltage","label":"Primary Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"secondaryVoltage","label":"Secondary Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"turns","label":"Turns Ratio","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Speaker","type":"Speaker","displayName":"Speaker","description":"Loudspeaker or buzzer","searchText":"speaker loudspeaker buzzer","designator":"LS","defaultPins":2,"fields":[{"name":"impedance","label":"Impedance","type":"number","units":["","m","k"],"defaultUnit":"","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Motor","type":"Motor","displayName":"Motor","description":"Motor","searchText":"motor","designator":"M","defaultPins":2,"fields":[{"name":"motorType","label":"Motor Type","type":"string","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Test Point","type":"TestPoint","displayName":"Test Point","description":"Test point","searchText":"test point","designator":"TP","defaultPins":1,"fields":[{"name":"signal","label":"Signal","type":"string","required":false}]},{"category":"Other","subcategory":"Vacuum Tube","type":"VacuumTube","displayName":"Vacuum Tube","description":"Vacuum tube","searchText":"vacuum tube","designator":"V","defaultPins":5,"fields":[{"name":"tubeType","label":"Tube Type","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Attenuator","type":"GenericComponent","displayName":"Attenuator","description":"Attenuator or isolator","searchText":"attenuator isolator component","designator":"AT","defaultPins":2,"subtype":"Attenuator","fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Circuit Breaker","type":"GenericComponent","displayName":"Circuit Breaker","description":"Circuit breaker","searchText":"circuit breaker component","designator":"CB","defaultPins":2,"subtype":"CircuitBreaker","fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Thermocouple","type":"GenericComponent","displayName":"Thermocouple","description":"Thermocouple","searchText":"thermocouple component","designator":"TC","defaultPins":2,"subtype":"Thermocouple","fields":[{"name":"model","label":"Model","type":"string","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Tuner","type":"GenericComponent","displayName":"Tuner","description":"Tuner","searchText":"tuner component","designator":"TUN","defaultPins":2,"subtype":"Tuner","fields":[{"name":"frequency","label":"Frequency","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]}]'),bh={components:b2},v2=["#FFFFFF","#BFBFBF","#7F7F7F","#3C3C3C","#000000","#A6CEE3","#56B4E9","#17BECF","#00BFC4","#1F77B4","#0072B2","#332288","#B2DF8A","#B3DE69","#2CA02C","#009E73","#FFED6F","#F0E442","#BCBD22","#E69F00","#FF7F0E","#FB9A99","#F781BF","#E15759","#D62728","#CAB2D6","#CC79A7","#AA4499","#6A3D9A","#9467BD","#9C755F","#8C564B"],fg="#2CA02C",w2="#F0E442",S2="#00BFC4",pg="#000000",T2="#00008b",hg="#FF0000",a0={DEFAULT_SIZE:18},Zf={};bh.components.forEach(n=>{const r=n.type,o=n.designator;if(!Zf[r])Zf[r]={prefix:[o],defaultPins:n.defaultPins};else{const s=Zf[r],l=[...new Set([...s.prefix,o])];Zf[r]={prefix:l,defaultPins:s.defaultPins}}});const s0=Zf,Xd={};bh.components.forEach(n=>{if(Xd[n.category]||(Xd[n.category]={}),!Xd[n.category][n.subcategory])Xd[n.category][n.subcategory]=[n.type];else{const r=Xd[n.category][n.subcategory];r.includes(n.type)||(Xd[n.category][n.subcategory]=[...r,n.type])}});const gg={DEFAULT_SIZE:18},ex={resistance:{validUnits:["","m","k","M"],defaultUnit:""},capacitance:{validUnits:["pF","nF","F","mF","F"],defaultUnit:"F"},voltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},current:{validUnits:["A","mA","A"],defaultUnit:"A"},power:{validUnits:["W","mW","kW"],defaultUnit:"W"},inductance:{validUnits:["nH","H","mH","H"],defaultUnit:"H"},impedance:{validUnits:["","m","k"],defaultUnit:""},capacity:{validUnits:["mAh","Ah"],defaultUnit:"mAh"},inputVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},outputVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},coilVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},primaryVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},secondaryVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},esr:{validUnits:["m",""],defaultUnit:""}};function or(n){return ex[n]?.validUnits||[]}function fn(n){return ex[n]?.defaultUnit||""}function Yl(n){return n.includes(" ")?n:n.replace(/([a-z])([A-Z])/g,"$1 $2")}const es=Math.PI*2;function tx(n){return(n%360+360)%360}function mu(n){return n*Math.PI/180}function C2(n){return n*180/Math.PI}function qg(n,r){return tx(n+r)}function hh(n){return Math.tan(n)}function j2(n){return Math.cos(n)}function N2(n){return Math.sin(n)}function k2(n,r){return Math.atan2(n,r)}function A2(n,r){return C2(k2(r,n))}function Hg(n,r){const{x:o,y:s,rotation:l=0,scale:d=1,flipX:b=!1,flipY:p=!1,skewX:v=0,skewY:m=0}=r;if(n.translate(o,s),l!==0&&n.rotate(mu(l)),v!==0||m!==0){const M=hh(v),S=hh(m);n.transform(1,S,M,1,0,0)}const C=d*(b?-1:1),D=d*(p?-1:1);(C!==1||D!==1)&&n.scale(C,D)}function N1(n,r,o,s=0,l=!1,d=!1){Hg(n,{x:r,y:o,rotation:s,flipX:l,flipY:d})}function nx(n,r,o){const s=mu(o),l=j2(s),d=N2(s);return{x:n*l-r*d,y:n*d+r*l}}function P2(n,r=0,o=!1){o&&n.scale(-1,1),r!==0&&n.rotate(mu(r))}function z2(n,r=0,o=!1){const s=tx(r),l=s===90||s===270;o&&n.scale(-1,1),r!==0&&n.rotate(mu(-r)),o&&l&&n.rotate(mu(180))}function k1(n,r,o,s=0,l=!1){let d=n/o,b=r/o;if(s!==0){const p=nx(d,b,-s);d=p.x,b=p.y}return l&&(d=-d),{x:d,y:b}}function $f(n,r,o,s,l=0,d=!1){let b=n-o.x,p=r-o.y;if(b=b/s,p=p/s,d&&(b=-b),l!==0){const v=nx(b,p,-l);b=v.x,p=v.y}return{x:b,y:p}}function _2(n,r=.4){if(n.startsWith("#")){const s=n.slice(1),l=parseInt(s.slice(0,2),16),d=parseInt(s.slice(2,4),16),b=parseInt(s.slice(4,6),16),p=Math.max(0,Math.floor(l*(1-r))),v=Math.max(0,Math.floor(d*(1-r))),m=Math.max(0,Math.floor(b*(1-r)));return`#${p.toString(16).padStart(2,"0")}${v.toString(16).padStart(2,"0")}${m.toString(16).padStart(2,"0")}`}const o=n.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*[\d.]+)?\)/);if(o){const s=parseInt(o[1],10),l=parseInt(o[2],10),d=parseInt(o[3],10),b=o[4]?o[4].trim():"",p=Math.max(0,Math.floor(s*(1-r))),v=Math.max(0,Math.floor(l*(1-r))),m=Math.max(0,Math.floor(d*(1-r)));return n.includes("rgba")?`rgba(${p}, ${v}, ${m}${b?`, ${b}`:", 1"})`:`rgb(${p}, ${v}, ${m})`}return n}let ol=1;const xc=new Set;function gc(){const n=ol;if(ol++,xc.has(n)){for(console.error(`CRITICAL ERROR: Duplicate Node ID ${n} would be allocated!`),console.error(`Current counter: ${ol}, Allocated IDs count: ${xc.size}`);xc.has(ol);)ol++;const r=ol;return ol++,xc.add(r),console.error(`Recovered by allocating ID ${r} instead`),r}return xc.add(n),n}function Kp(n){n<1&&(console.warn(`setPointIdCounter called with invalid value ${n}, using 1`),n=1),ol=n,xc.clear()}function yg(){return ol}function Jf(){ol=1,xc.clear()}function xg(n){n>0&&(xc.add(n),n>=ol&&(ol=n+1))}function Zp(n){if(n>0&&xc.has(n))if(xc.delete(n),xc.size>0){const r=Math.max(...Array.from(xc));r<ol&&(ol=Math.max(1,r+1))}else ol=1}function ix(n="id"){return`${n}-${Date.now()}-${Math.random().toString(36).slice(2,11)}`}function A1(n){return Math.round(n*1e4)/1e4}function ur(n){return{x:A1(n.x),y:A1(n.y)}}const $u=bh.components;$u.map(n=>({designator:n.designator,componentType:n.description}));function $l(n){if(!n)return;const r=n.componentDefinitionKey;if(r){const s=$u.find(l=>`${l.category}:${l.subcategory}:${l.type}`===r);if(s)return s}if(typeof n.designator=="string"&&n.designator.trim()!==""){const s=n.designator.trim().match(/^[A-Za-z]+/),l=s?s[0]:null;if(l){const d=$u.find(b=>Array.isArray(b.designators)&&b.designators.includes(l));if(d)return d}}const o=n.componentType==="Electrolytic Capacitor"||n.componentType==="Film Capacitor"?"Capacitor":n.componentType;return $u.find(s=>{if(s.type!==o)return!1;if(s.category==="Capacitors"){const l=n.capacitorType||n.dielectric;return!!(l&&s.properties?.capacitorType===l||!l)}if(s.category==="Diodes"){const l=n.diodeType;return!!(l&&s.properties?.diodeType===l||!s.properties?.diodeType)}if(s.category==="Resistors"){const l=n.resistorType,d=n.vrType;return!!(l&&s.properties?.resistorType===l||d&&s.properties?.vrType===d||!s.properties?.resistorType&&!s.properties?.vrType)}if(s.category==="Semiconductors"){const l=n.semiconductorType;return!!(l&&s.properties?.semiconductorType===l||!s.properties?.semiconductorType)}if(s.category==="Passive Components"){const l=n.passiveType;return!!(l&&s.properties?.passiveType===l||!s.properties?.passiveType)}if(s.category==="Power & Energy"){const l=n.powerType;return!!(l&&s.properties?.powerType===l||!s.properties?.powerType)}if(s.category==="Connectors & Switches"){const l=n.connectorType,d=n.switchType;return!!(l&&s.properties?.connectorType===l||d&&s.properties?.switchType===d||!s.properties?.connectorType&&!s.properties?.switchType)}if(n.componentType==="GenericComponent"){const l=n.genericType;return!!(l&&s.subtype===l)}return!0})}function mg(n){return(s0[n]?.prefix||["?"])[0]}function ip(n){return $l(n)?.properties?.polarized===!0}function Wg(n,r,o){if(!ip(n)||n.pinCount!==2||!(r.length===2&&r[0]&&r[0].trim()!==""&&r[1]&&r[1].trim()!==""))return null;const l=C=>{const D=parseInt(C,10);if(isNaN(D))return null;for(const M of o)if((M.type==="via"||M.type==="pad")&&M.points.length>0){const S=M.points[0];if(S.id===D)return{x:S.x,y:S.y}}return null},d=l(r[0]),b=l(r[1]);if(!d||!b)return null;const p=Math.hypot(n.x-d.x,n.y-d.y),v=Math.hypot(n.x-b.x,n.y-b.y),m=["",""];return p<v?(m[0]="-",m[1]="+"):(m[0]="+",m[1]="-"),m}function Yf(){return{}}function D2(n){}function R2(n,r,o){let s=0;for(const d of r)if(d.designator){const b=d.designator.match(new RegExp(`^${n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(\\d+)$`));if(b){const p=parseInt(b[1],10);p>s&&(s=p)}}const l=o[n]||0;return Math.max(s,l)+1}function P1(n,r,o){const s={...o};return s[n]=Math.max(s[n]||0,r),s}function I2(n){if(n.designator&&n.designator.trim()!=="")return n.designator.trim();switch(n.baseType){case"Capacitor":return"C";case"Diode":return"D";case"Resistor":return"R";case"Semiconductor":return"Q";case"Passive":return"L";case"PowerEnergy":return"PS";case"Connector":return"J";case"Switch":return"S";case"Transformer":return"T";case"Other":default:return"?"}}function L2(n,r,o){let s=0;for(const b of r){if(!b.designator||!b.designator.startsWith(n))continue;const p=parseInt(b.designator.slice(n.length),10);!isNaN(p)&&p>s&&(s=p)}const d=(o[n]??s)+1;return o[n]=d,d}function M2(n,r,o){const s=I2(n),l=L2(s,r,o);return`${s}${l}`}function B2(n){const{definition:r,layer:o,x:s,y:l,color:d,size:b,designator:p,existingComponents:v=[],counters:m={}}=n,C=b&&b>0?b:a0.DEFAULT_SIZE,D=p||M2(r,v,m),M={id:ix("comp"),componentType:r.type,designator:D,layer:o,x:s,y:l,color:d,size:C,pinCount:r.defaultPins,pinConnections:new Array(r.defaultPins).fill(""),pinPolarities:void 0,notes:null,orientation:0,flipX:!1,flipY:!1,description:r.description};if(M.componentDefinitionKey=r.key,r.properties&&Object.assign(M,r.properties),r.properties?.pinNames&&Array.isArray(r.properties.pinNames)){const S=r.properties.pinNames;S.includes("CHIP_DEPENDENT")?M.pinNames=new Array(M.pinCount).fill(""):M.pinNames=new Array(M.pinCount).fill("").map((_,N)=>N<S.length?S[N]:"")}return r.fields&&r.fields.length>0&&r.fields.forEach(S=>{S.defaultValue!==void 0&&S.defaultValue!==""&&(M[S.name]=S.defaultValue),S.units&&S.defaultUnit&&(M[`${S.name}Unit`]=S.defaultUnit)}),M}function O2(){const n=document.createElement("canvas"),r=24;n.width=r,n.height=r;const o=n.getContext("2d");o.strokeStyle="#000",o.lineWidth=3,o.lineCap="round";const s=r/2,l=8;return o.beginPath(),o.moveTo(s,s-l),o.lineTo(s,s-2),o.moveTo(s,s+2),o.lineTo(s,s+l),o.moveTo(s-l,s),o.lineTo(s-2,s),o.moveTo(s+2,s),o.lineTo(s+l,s),o.stroke(),`url(${n.toDataURL()}) ${s} ${s}, crosshair`}function F2(n){const r=document.createElement("canvas"),o=Math.max(12,Math.min(n,32)),l=o+4*2;r.width=l,r.height=l;const d=r.getContext("2d"),b=l/2,p=l/2,v=o/2;return d.fillStyle="#FFFF00",d.strokeStyle="#000000",d.lineWidth=2,d.beginPath(),d.moveTo(b,p-v),d.lineTo(b+v,p),d.lineTo(b,p+v),d.lineTo(b-v,p),d.closePath(),d.fill(),d.stroke(),`url(${r.toDataURL()}) ${b} ${p}, crosshair`}function z1(){const n=new Date,r=n.getFullYear(),o=String(n.getMonth()+1).padStart(2,"0"),s=String(n.getDate()).padStart(2,"0"),l=String(n.getHours()).padStart(2,"0"),d=String(n.getMinutes()).padStart(2,"0"),b=String(n.getSeconds()).padStart(2,"0");return`${r}_${o}_${s}-${l}-${d}-${b}`}function vd(n){let r=n.replace(/\.json$/i,""),o="";for(;o!==r;)o=r,r=r.replace(/_\d{4}_\d{2}_\d{2}-\d{2}-\d{2}-\d{2}$/,""),r=r.replace(/_\d{4}_\d{2}_\d{2}_\d{2}_\d{2}_\d{2}$/,"");return r}const Sr={CONFIG:"aiServiceConfig",API_KEY_PREFIX:"aiApiKey_",MODEL_PREFIX:"aiModel_"},Kd={provider:"gemini",model:"gemini-2.0-flash",apiKeyStorageType:"sessionStorage"},Uu="gemini",rx={id:"gemini",name:"Google Gemini",description:"Google's multimodal AI with native PDF support",models:[{id:"gemini-2.0-flash",name:"Gemini 2.0 Flash",description:"Fast and efficient",supportsPDF:!0},{id:"gemini-2.0-flash-lite",name:"Gemini 2.0 Flash Lite",description:"Lightweight and fast",supportsPDF:!0},{id:"gemini-1.5-flash",name:"Gemini 1.5 Flash",description:"Previous generation flash",supportsPDF:!0},{id:"gemini-1.5-pro",name:"Gemini 1.5 Pro",description:"More capable, slower",supportsPDF:!0}],defaultModel:"gemini-2.0-flash",apiKeyPlaceholder:"AIza...",apiKeyHelpUrl:"https://aistudio.google.com/apikey",supportsPDF:!0};class U2{info=rx;getStorageType(){if(typeof window>"u")return"sessionStorage";const r=localStorage.getItem(Sr.CONFIG);if(r)try{return JSON.parse(r).apiKeyStorageType||"sessionStorage"}catch{return"sessionStorage"}return"sessionStorage"}getStorage(){return this.getStorageType()==="localStorage"?localStorage:sessionStorage}getApiKey(){return typeof window>"u"?null:this.getStorage().getItem(`${Sr.API_KEY_PREFIX}${Uu}`)?.trim()||null}saveApiKey(r,o){if(typeof window>"u")return;sessionStorage.removeItem(`${Sr.API_KEY_PREFIX}${Uu}`),localStorage.removeItem(`${Sr.API_KEY_PREFIX}${Uu}`),(o==="localStorage"?localStorage:sessionStorage).setItem(`${Sr.API_KEY_PREFIX}${Uu}`,r.trim())}removeApiKey(){typeof window>"u"||(sessionStorage.removeItem(`${Sr.API_KEY_PREFIX}${Uu}`),localStorage.removeItem(`${Sr.API_KEY_PREFIX}${Uu}`))}hasApiKey(){return!!this.getApiKey()}getModel(){return typeof window>"u"?this.info.defaultModel:localStorage.getItem(`${Sr.MODEL_PREFIX}${Uu}`)||this.info.defaultModel}saveModel(r){typeof window>"u"||localStorage.setItem(`${Sr.MODEL_PREFIX}${Uu}`,r)}getApiUrl(){const r=this.getApiKey();return r?`https://generativelanguage.googleapis.com/v1/models/${this.getModel()}:generateContent?key=${r}`:null}async extractFromPDF(r){const o=this.getApiUrl();if(!o)return{success:!1,error:"API key not configured"};try{const s=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:r.prompt},{inlineData:{mimeType:r.mimeType||"application/pdf",data:r.pdfBase64}}]}]})});if(!s.ok){const b=await s.text();let p=`Gemini API error: ${s.status} ${s.statusText}`;try{const v=JSON.parse(b);if(v.error?.message){let m=v.error.message;m.length>500&&(m=m.replace(/"([A-Za-z0-9+/]{100,})"/g,(C,D)=>`"[Base64 data truncated - ${D.length} characters]"`)),p+=`.

${m}`}}catch{b.length>1e3?p+=`.

${b.substring(0,1e3)}... [truncated]`:p+=`.

${b}`}return{success:!1,error:p}}const l=await s.json();let d="";if(l.candidates?.[0]){if(l.candidates[0].finishReason&&l.candidates[0].finishReason!=="STOP")return{success:!1,error:`Response blocked: ${l.candidates[0].finishReason}`};const b=l.candidates[0].content?.parts;b?.[0]?.text&&(d=b[0].text.trim())}return d?{success:!0,text:d,rawResponse:l}:{success:!1,error:"No response text from API",rawResponse:l}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Unknown error occurred"}}}}const $g=new U2,Eu="claude",ox={id:"claude",name:"Anthropic Claude",description:"Anthropic's Claude with native PDF support",models:[{id:"claude-sonnet-4-20250514",name:"Claude Sonnet 4",description:"Latest balanced model",supportsPDF:!0},{id:"claude-3-5-sonnet-20241022",name:"Claude 3.5 Sonnet",description:"Fast and intelligent",supportsPDF:!0},{id:"claude-3-5-haiku-20241022",name:"Claude 3.5 Haiku",description:"Fastest model",supportsPDF:!0},{id:"claude-3-opus-20240229",name:"Claude 3 Opus",description:"Most capable",supportsPDF:!0}],defaultModel:"claude-sonnet-4-20250514",apiKeyPlaceholder:"sk-ant-...",apiKeyHelpUrl:"https://console.anthropic.com/settings/keys",supportsPDF:!0};class E2{info=ox;getStorageType(){if(typeof window>"u")return"sessionStorage";const r=localStorage.getItem(Sr.CONFIG);if(r)try{return JSON.parse(r).apiKeyStorageType||"sessionStorage"}catch{return"sessionStorage"}return"sessionStorage"}getStorage(){return this.getStorageType()==="localStorage"?localStorage:sessionStorage}getApiKey(){return typeof window>"u"?null:this.getStorage().getItem(`${Sr.API_KEY_PREFIX}${Eu}`)?.trim()||null}saveApiKey(r,o){if(typeof window>"u")return;sessionStorage.removeItem(`${Sr.API_KEY_PREFIX}${Eu}`),localStorage.removeItem(`${Sr.API_KEY_PREFIX}${Eu}`),(o==="localStorage"?localStorage:sessionStorage).setItem(`${Sr.API_KEY_PREFIX}${Eu}`,r.trim())}removeApiKey(){typeof window>"u"||(sessionStorage.removeItem(`${Sr.API_KEY_PREFIX}${Eu}`),localStorage.removeItem(`${Sr.API_KEY_PREFIX}${Eu}`))}hasApiKey(){return!!this.getApiKey()}getModel(){return typeof window>"u"?this.info.defaultModel:localStorage.getItem(`${Sr.MODEL_PREFIX}${Eu}`)||this.info.defaultModel}saveModel(r){typeof window>"u"||localStorage.setItem(`${Sr.MODEL_PREFIX}${Eu}`,r)}getApiUrl(){return this.getApiKey()?"https://api.anthropic.com/v1/messages":null}async extractFromPDF(r){const o=this.getApiKey(),s=this.getApiUrl();if(!o||!s)return{success:!1,error:"API key not configured"};try{const l=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":o,"anthropic-version":"2023-06-01","anthropic-dangerous-direct-browser-access":"true"},body:JSON.stringify({model:this.getModel(),max_tokens:4096,messages:[{role:"user",content:[{type:"document",source:{type:"base64",media_type:r.mimeType||"application/pdf",data:r.pdfBase64}},{type:"text",text:r.prompt}]}]})});if(!l.ok){const p=await l.text();let v=`Claude API error: ${l.status} ${l.statusText}`;try{const m=JSON.parse(p);m.error?.message&&(v+=`.

${m.error.message}`)}catch{p.length>1e3?v+=`.

${p.substring(0,1e3)}... [truncated]`:v+=`.

${p}`}return{success:!1,error:v}}const d=await l.json();let b="";if(d.content&&Array.isArray(d.content))for(const p of d.content)p.type==="text"&&(b+=p.text);return b?{success:!0,text:b.trim(),rawResponse:d}:{success:!1,error:"No response text from API",rawResponse:d}}catch(l){return{success:!1,error:l instanceof Error?l.message:"Unknown error occurred"}}}}const V2=new E2,Vu="openai",ax={id:"openai",name:"OpenAI ChatGPT",description:"OpenAI's GPT models with PDF support",models:[{id:"gpt-4o",name:"GPT-4o",description:"Most capable multimodal model",supportsPDF:!0},{id:"gpt-4o-mini",name:"GPT-4o Mini",description:"Fast and affordable",supportsPDF:!0},{id:"gpt-4-turbo",name:"GPT-4 Turbo",description:"Previous generation",supportsPDF:!0}],defaultModel:"gpt-4o",apiKeyPlaceholder:"sk-...",apiKeyHelpUrl:"https://platform.openai.com/api-keys",supportsPDF:!0};class q2{info=ax;getStorageType(){if(typeof window>"u")return"sessionStorage";const r=localStorage.getItem(Sr.CONFIG);if(r)try{return JSON.parse(r).apiKeyStorageType||"sessionStorage"}catch{return"sessionStorage"}return"sessionStorage"}getStorage(){return this.getStorageType()==="localStorage"?localStorage:sessionStorage}getApiKey(){return typeof window>"u"?null:this.getStorage().getItem(`${Sr.API_KEY_PREFIX}${Vu}`)?.trim()||null}saveApiKey(r,o){if(typeof window>"u")return;sessionStorage.removeItem(`${Sr.API_KEY_PREFIX}${Vu}`),localStorage.removeItem(`${Sr.API_KEY_PREFIX}${Vu}`),(o==="localStorage"?localStorage:sessionStorage).setItem(`${Sr.API_KEY_PREFIX}${Vu}`,r.trim())}removeApiKey(){typeof window>"u"||(sessionStorage.removeItem(`${Sr.API_KEY_PREFIX}${Vu}`),localStorage.removeItem(`${Sr.API_KEY_PREFIX}${Vu}`))}hasApiKey(){return!!this.getApiKey()}getModel(){return typeof window>"u"?this.info.defaultModel:localStorage.getItem(`${Sr.MODEL_PREFIX}${Vu}`)||this.info.defaultModel}saveModel(r){typeof window>"u"||localStorage.setItem(`${Sr.MODEL_PREFIX}${Vu}`,r)}getApiUrl(){return this.getApiKey()?"https://api.openai.com/v1/chat/completions":null}async extractFromPDF(r){const o=this.getApiKey(),s=this.getApiUrl();if(!o||!s)return{success:!1,error:"API key not configured"};try{const l=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({model:this.getModel(),max_tokens:4096,messages:[{role:"user",content:[{type:"file",file:{filename:"datasheet.pdf",file_data:`data:${r.mimeType||"application/pdf"};base64,${r.pdfBase64}`}},{type:"text",text:r.prompt}]}]})});if(!l.ok){const p=await l.text();let v=`OpenAI API error: ${l.status} ${l.statusText}`;try{const m=JSON.parse(p);m.error?.message&&(v+=`.

${m.error.message}`)}catch{p.length>1e3?v+=`.

${p.substring(0,1e3)}... [truncated]`:v+=`.

${p}`}return{success:!1,error:v}}const d=await l.json();let b="";return d.choices?.[0]?.message?.content&&(b=d.choices[0].message.content),b?{success:!0,text:b.trim(),rawResponse:d}:{success:!1,error:"No response text from API",rawResponse:d}}catch(l){return{success:!1,error:l instanceof Error?l.message:"Unknown error occurred"}}}}const H2=new q2,Yg={gemini:$g,claude:V2,openai:H2},Hs={gemini:rx,claude:ox,openai:ax},_1=["gemini","claude","openai"];function af(){if(typeof window>"u")return Kd;const n=localStorage.getItem(Sr.CONFIG);if(n)try{const r=JSON.parse(n);return{provider:r.provider||Kd.provider,model:r.model||Kd.model,apiKeyStorageType:r.apiKeyStorageType||Kd.apiKeyStorageType}}catch{return Kd}return Kd}function vh(n){if(typeof window>"u")return;const o={...af(),...n};localStorage.setItem(Sr.CONFIG,JSON.stringify(o))}function Yc(){const n=af();return Yg[n.provider]||Yg.gemini}function D1(n){const r=Yg[n];r&&vh({provider:n,model:r.getModel()})}function W2(){return af().apiKeyStorageType}function $2(n){vh({apiKeyStorageType:n})}function sx(){if(typeof window>"u")return;const n=sessionStorage.getItem("geminiApiKey"),r=localStorage.getItem("geminiApiKey"),o=localStorage.getItem("geminiModel"),s=localStorage.getItem(Sr.CONFIG),l=sessionStorage.getItem(`${Sr.API_KEY_PREFIX}gemini`)||localStorage.getItem(`${Sr.API_KEY_PREFIX}gemini`);if((n||r)&&!s&&!l){console.log("Migrating legacy Gemini API key storage to new format...");const d=n?"sessionStorage":"localStorage",b=n||r;vh({provider:"gemini",model:o||"gemini-2.0-flash",apiKeyStorageType:d}),b&&$g.saveApiKey(b,d),o&&$g.saveModel(o),sessionStorage.removeItem("geminiApiKey"),localStorage.removeItem("geminiApiKey"),localStorage.removeItem("geminiModel"),console.log("Migration complete.")}}function mi(n,r,o,s){if(r==="power"){const d=n[r]||"";return typeof d=="string"&&d.trim()!==""?{value:d.replace(/W$/i,"").trim(),unit:"W"}:{value:"",unit:"W"}}if(n[r]!==void 0||n[o]!==void 0)return{value:n[r]!==void 0?String(n[r]):"",unit:n[o]!==void 0?String(n[o]):s};const l=n[r]||"";return typeof l=="string"&&l.trim()!==""?lx(l):{value:"",unit:s}}function lx(n){if(!n||n.trim()==="")return{value:"",unit:""};const r=n.trim(),o=r.match(/^([\d]+\/[\d]+)\s*([a-zA-ZuW]+)?$/);if(o)return{value:o[1],unit:o[2]||""};const s=r.match(/^([\d.]+)\s*([a-zA-ZuW]+)?$/);return s?{value:s[1],unit:s[2]||""}:{value:r,unit:""}}function yd(n,r){return!n||n.trim()===""?"":!r||r.trim()===""?n.trim():`${n.trim()}${r.trim()}`}function Y2(){const[n,r]=L.useState([]),[o,s]=L.useState([]),[l,d]=L.useState(null),[b,p]=L.useState(null),[v,m]=L.useState(null),[C,D]=L.useState(!1),[M,S]=L.useState(null),U=L.useCallback((V,E)=>{E==="top"?r(re=>[...re,V]):s(re=>[...re,V])},[]),_=L.useCallback((V,E,re)=>{re==="top"?r(J=>J.map(G=>G.id===V?{...G,...E}:G)):s(J=>J.map(G=>G.id===V?{...G,...E}:G))},[]),N=L.useCallback((V,E)=>{E==="top"?r(re=>re.filter(J=>J.id!==V)):s(re=>re.filter(J=>J.id!==V))},[]),g=L.useCallback((V,E)=>{if(!V){console.error("[openComponentEditor] Component is null or undefined");return}if(!V.id||typeof V.id!="string"){console.error("[openComponentEditor] Component missing valid id property:",{component:V});return}const re=V.id;if(!V.componentType||typeof V.componentType!="string"){console.error("[openComponentEditor] Component missing valid componentType property:",{componentId:re,component:V});return}const J=V.componentType;if(typeof V.pinCount!="number"||V.pinCount<0){console.error("[openComponentEditor] Component missing valid pinCount property:",{componentId:re,componentType:J,pinCount:V.pinCount,component:V});return}if(E!=="top"&&E!=="bottom"){console.error("[openComponentEditor] Invalid layer parameter:",{layer:E,componentId:V.id});return}const G=V.designator||"",ee=V.abbreviation||(G.length>0?G.charAt(0).toUpperCase():""),F=V.componentType,$={visible:!0,layer:E,id:V.id,designator:G,abbreviation:ee,manufacturer:"manufacturer"in V&&V.manufacturer||"",partNumber:"partNumber"in V&&V.partNumber||"",pinCount:V.pinCount,x:V.x,y:V.y,orientation:V.orientation??0,description:V.description||"",datasheet:V.datasheet||"",componentDefinitionKey:V.componentDefinitionKey||""};if(F==="Resistor"){const R=V;console.log("[openComponentEditor] Resistor - component values:",{resistance:R.resistance,resistanceUnit:R.resistanceUnit,resistanceType:typeof R.resistance});const Z=mi(R,"resistance","resistanceUnit",fn("resistance"));console.log("[openComponentEditor] Resistor - readValueAndUnit result:",Z),$.resistance=Z.value,$.resistanceUnit=Z.unit;const Y=mi(R,"power","powerUnit","W");$.power=Y.value||"1/4",$.tolerance=R.tolerance||"5%"}else if(F==="Capacitor"){const R=V;console.log("[openComponentEditor] Capacitor - component values:",{capacitance:R.capacitance,capacitanceUnit:R.capacitanceUnit,capacitanceType:typeof R.capacitance});const Z=mi(R,"capacitance","capacitanceUnit",fn("capacitance"));console.log("[openComponentEditor] Capacitor - readValueAndUnit result:",Z),$.capacitance=Z.value,$.capacitanceUnit=Z.unit;const Y=mi(R,"voltage","voltageUnit",fn("voltage"));$.voltage=Y.value,$.voltageUnit=Y.unit,$.tolerance=R.tolerance||"10%",$.dielectric=R.dielectric||"Ceramic"}else if(F==="Electrolytic Capacitor"){const R=V,Z=mi(R,"capacitance","capacitanceUnit",fn("capacitance"));$.capacitance=Z.value,$.capacitanceUnit=Z.unit;const Y=mi(R,"voltage","voltageUnit",fn("voltage"));$.voltage=Y.value,$.voltageUnit=Y.unit,$.tolerance=R.tolerance||"20%",$.polarized=R.polarized!==void 0?R.polarized:!0;const we=mi(R,"esr","esrUnit",fn("esr"));$.esr=we.value,$.esrUnit=we.unit,$.temperature=R.temperature||""}else if(F==="Film Capacitor"){const R=V,Z=mi(R,"capacitance","capacitanceUnit",fn("capacitance"));$.capacitance=Z.value,$.capacitanceUnit=Z.unit;const Y=mi(R,"voltage","voltageUnit",fn("voltage"));$.voltage=Y.value,$.voltageUnit=Y.unit,$.tolerance=R.tolerance||"10%",$.filmType=R.filmType||"Polyester"}else if(F==="Diode"){const R=V;$.diodeType=R.diodeType||"Standard";const Z=mi(R,"voltage","voltageUnit",fn("voltage"));$.voltage=Z.value,$.voltageUnit=Z.unit;const Y=mi(R,"current","currentUnit",fn("current"));$.current=Y.value,$.currentUnit=Y.unit,$.ledColor=R.ledColor||""}else if(F==="Battery"){const R=V,Z=mi(R,"voltage","voltageUnit",fn("voltage"));$.voltage=Z.value,$.voltageUnit=Z.unit;const Y=mi(R,"capacity","capacityUnit",fn("capacity"));$.capacity=Y.value,$.capacityUnit=Y.unit,$.chemistry=R.chemistry||"Li-ion"}else if(F==="Fuse"){const R=V,Z=mi(R,"current","currentUnit",fn("current"));$.current=Z.value,$.currentUnit=Z.unit;const Y=mi(R,"voltage","voltageUnit",fn("voltage"));$.voltage=Y.value,$.voltageUnit=Y.unit,$.fuseType=R.fuseType||"Fast-blow"}else if(F==="FerriteBead"){const R=V,Z=mi(R,"impedance","impedanceUnit",fn("impedance"));$.impedance=Z.value,$.impedanceUnit=Z.unit;const Y=mi(R,"current","currentUnit",fn("current"));$.current=Y.value,$.currentUnit=Y.unit}else if(F==="Connector"){const R=V;$.connectorType=R.connectorType||"",$.gender=R.gender||"N/A"}else if(F==="Jumper"){const R=V;$.positions=R.positions||3}else if(F==="Relay"){const R=V,Z=mi(R,"coilVoltage","coilVoltageUnit",fn("coilVoltage"));$.coilVoltage=Z.value,$.coilVoltageUnit=Z.unit,$.contactType=R.contactType||"SPST";const Y=mi(R,"current","currentUnit",fn("current"));$.current=Y.value,$.currentUnit=Y.unit}else if(F==="Inductor"){const R=V,Z=mi(R,"inductance","inductanceUnit",fn("inductance"));$.inductance=Z.value,$.inductanceUnit=Z.unit;const Y=mi(R,"current","currentUnit",fn("current"));$.current=Y.value,$.currentUnit=Y.unit;const we=mi(R,"resistance","resistanceUnit",fn("resistance"));$.resistance=we.value,$.resistanceUnit=we.unit}else if(F==="Speaker"){const R=V,Z=mi(R,"impedance","impedanceUnit",fn("impedance"));$.impedance=Z.value,$.impedanceUnit=Z.unit;const Y=mi(R,"power","powerUnit","W");$.power=Y.value||"1"}else if(F==="Motor"){const R=V;$.motorType=R.motorType||"DC";const Z=mi(R,"voltage","voltageUnit",fn("voltage"));$.voltage=Z.value,$.voltageUnit=Z.unit;const Y=mi(R,"current","currentUnit",fn("current"));$.current=Y.value,$.currentUnit=Y.unit}else if(F==="PowerSupply"){const R=V,Z=mi(R,"inputVoltage","inputVoltageUnit",fn("inputVoltage"));$.inputVoltage=Z.value,$.inputVoltageUnit=Z.unit;const Y=mi(R,"outputVoltage","outputVoltageUnit",fn("outputVoltage"));$.outputVoltage=Y.value,$.outputVoltageUnit=Y.unit;const we=mi(R,"current","currentUnit",fn("current"));$.current=we.value,$.currentUnit=we.unit}else if(F==="Transistor"){const R=V;$.transistorType=R.transistorType||"BJT",$.polarity=R.polarity||"NPN";const Z=mi(R,"voltage","voltageUnit",fn("voltage"));$.voltage=Z.value,$.voltageUnit=Z.unit;const Y=mi(R,"current","currentUnit",fn("current"));$.current=Y.value,$.currentUnit=Y.unit}else if(F==="ResistorNetwork"){const R=V,Z=mi(R,"resistance","resistanceUnit",fn("resistance"));$.resistance=Z.value,$.resistanceUnit=Z.unit,$.configuration=R.configuration||""}else if(F==="Thermistor"){const R=V,Z=mi(R,"resistance","resistanceUnit",fn("resistance"));$.resistance=Z.value,$.resistanceUnit=Z.unit,$.thermistorType=R.thermistorType||"NTC",$.beta=R.beta||""}else if(F==="Switch"){const R=V;$.switchType=R.switchType||"Toggle";const Z=mi(R,"current","currentUnit",fn("current"));$.current=Z.value,$.currentUnit=Z.unit;const Y=mi(R,"voltage","voltageUnit",fn("voltage"));$.voltage=Y.value,$.voltageUnit=Y.unit}else if(F==="Transformer"){const R=V,Z=mi(R,"primaryVoltage","primaryVoltageUnit",fn("primaryVoltage"));$.primaryVoltage=Z.value,$.primaryVoltageUnit=Z.unit;const Y=mi(R,"secondaryVoltage","secondaryVoltageUnit",fn("secondaryVoltage"));$.secondaryVoltage=Y.value,$.secondaryVoltageUnit=Y.unit;const we=mi(R,"power","powerUnit",fn("power"));$.power=we.value||"1",$.turns=R.turns||""}else if(F==="TestPoint"){const R=V;$.signal=R.signal||""}else if(F==="IntegratedCircuit"||F==="Semiconductor"){const R=V;$.description=R.description||V.designator||"",$.datasheet=R.datasheet||"",$.datasheetFileName=R.datasheetFileName||void 0,$.manufacturer=R.manufacturer||"",$.partNumber=R.partNumber||"",$.operatingTemperature=R.operatingTemperature||"",$.packageType=R.packageType||"",console.log("[useComponents] Loading IC component - datasheet from component:",R.datasheet,"editor datasheet:",$.datasheet,"datasheetFileName:",R.datasheetFileName),$.icType=R.icType||"Op-Amp"}else if(F==="VacuumTube"){const R=V;$.tubeType=R.tubeType||""}else if(F==="VariableResistor"){const R=V;$.vrType=R.vrType||"Potentiometer";const Z=mi(R,"resistance","resistanceUnit",fn("resistance"));$.resistance=Z.value,$.resistanceUnit=Z.unit;const Y=mi(R,"power","powerUnit",fn("power"));$.power=Y.value||"1/4",$.taper=R.taper||""}else if(F==="Crystal"){const R=V;$.frequency=R.frequency||"",$.loadCapacitance=R.loadCapacitance||"",$.tolerance=R.tolerance||""}else if(F==="Diode"){const R=V;$.diodeType=R.diodeType||"Standard";const Z=mi(R,"voltage","voltageUnit",fn("voltage"));$.voltage=Z.value,$.voltageUnit=Z.unit;const Y=mi(R,"current","currentUnit",fn("current"));$.current=Y.value,$.currentUnit=Y.unit,$.ledColor=R.ledColor||""}else if(F==="GenericComponent"){const R=V;$.genericType=R.genericType||"Attenuator";const Z=mi(R,"voltage","voltageUnit",fn("voltage"));$.voltage=Z.value,$.voltageUnit=Z.unit;const Y=mi(R,"current","currentUnit",fn("current"));$.current=Y.value,$.currentUnit=Y.unit,$.power=R.power||"",$.frequency=R.frequency||"",$.model=R.model||""}const H=V.componentDefinitionKey;if(H){const R=$u.find(Z=>`${Z.category}:${Z.subcategory}:${Z.type}`===H);R&&($.componentDefinition=R,$.componentDefinitionKey=H)}d($)},[]),ae=L.useCallback(()=>{d(null),p(null)},[]);return{componentsTop:n,setComponentsTop:r,componentsBottom:o,setComponentsBottom:s,componentEditor:l,setComponentEditor:d,connectingPin:b,setConnectingPin:p,componentDialogPosition:v,setComponentDialogPosition:m,isDraggingDialog:C,setIsDraggingDialog:D,dialogDragOffset:M,setDialogDragOffset:S,addComponent:U,updateComponent:_,removeComponent:N,openComponentEditor:g,closeComponentEditor:ae}}class G2{parent=new Map;rank=new Map;find(r){return this.parent.has(r)?(this.parent.get(r)!==r&&this.parent.set(r,this.find(this.parent.get(r))),this.parent.get(r)):(this.parent.set(r,r),this.rank.set(r,0),r)}union(r,o){const s=this.find(r),l=this.find(o);if(s===l)return;const d=this.rank.get(s)||0,b=this.rank.get(l)||0;d<b?this.parent.set(s,l):d>b?this.parent.set(l,s):(this.parent.set(l,s),this.rank.set(s,d+1))}getGroups(){const r=new Map;for(const o of this.parent.keys()){const s=this.find(o);r.has(s)||r.set(s,[]),r.get(s).push(o)}return r}}function X2(n,r){const o=n.pinCount,s=n.size||24,l=s*.8,d=s*.6,b=s*.15,p=d/4,v=Math.ceil(o/2),m=r<v;let C,D;if(m)C=n.x-l/2-b,D=n.y-d/2+d/4+r*p;else{const M=r-v;C=n.x+l/2+b,D=n.y-d/2+d/4+M*p}return{x:Math.round(C),y:Math.round(D)}}function wh(n,r,o,s,l){const d=new Map,b=new Map;let p=1;const v=6,m=(N,g)=>{const ae=Math.round(N*Math.pow(10,v))/Math.pow(10,v),V=Math.round(g*Math.pow(10,v))/Math.pow(10,v);return`${ae},${V}`},C=(N,g,ae,V)=>{const E=m(N,g);if(d.has(E)){const J=d.get(E);if(V){V.componentId&&V.pinIndex!==void 0&&(J.componentId=V.componentId,J.pinIndex=V.pinIndex),V.voltage!==void 0&&(J.voltage=V.voltage),V.powerBusId!==void 0&&(J.powerBusId=V.powerBusId),V.groundBusId!==void 0&&(J.groundBusId=V.groundBusId);for(const G in V)G!=="componentId"&&G!=="pinIndex"&&G!=="voltage"&&G!=="powerBusId"&&G!=="groundBusId"&&(J[G]=V[G]);V.type==="component_pin"||J.type==="component_pin"?J.type="component_pin":V.type&&!J.type&&(J.type=V.type)}return J}const re={id:p++,type:ae,x:N,y:g,...V};return d.set(E,re),re};let D=0;for(const N of n)if(N.type==="via"&&N.points.length>0){const g=N.points[0];C(g.x,g.y,"via");const ae=m(g.x,g.y);g.id!==void 0&&b.set(g.id,ae),D++}console.log(`[Connectivity] Added ${D} vias to coordinate graph`);let M=0;for(const N of n)if(N.type==="trace")for(const g of N.points){C(g.x,g.y,"trace_point");const ae=m(g.x,g.y);g.id!==void 0&&b.set(g.id,ae),M++}console.log(`[Connectivity] Added ${M} trace points to coordinate graph`);for(const N of o){const g=l.find(ae=>ae.id===N.powerBusId);if(C(N.x,N.y,"power",{voltage:g?.voltage||N.type||"UNKNOWN",powerBusId:N.powerBusId}),N.pointId!==void 0){const ae=m(N.x,N.y);b.set(N.pointId,ae)}}for(const N of s){const g=N;if(C(N.x,N.y,"ground",{groundBusId:g.groundBusId}),g.pointId!==void 0){const ae=m(N.x,N.y);b.set(g.pointId,ae)}}const S=new Set;for(const[N]of d)S.add(N);const U=[];let _=0;for(const N of r){const g=N.abbreviation?.trim()||N.designator?.trim()||"UNKNOWN";for(let ae=0;ae<N.pinCount;ae++){const V=N.pinConnections?.[ae];if(V&&V.trim()!==""){const E=parseInt(V.trim(),10);if(!isNaN(E)&&E>0){const re=b.get(E);if(re){const[J,G]=re.split(",").map(Number);C(J,G,"component_pin",{componentId:N.id,pinIndex:ae}),_++,console.log(`[Connectivity] Component ${g} pin ${ae+1}: Connected to point ID ${E} at coord(${J},${G})`)}else{const J=X2(N,ae);C(J.x,J.y,"component_pin",{componentId:N.id,pinIndex:ae});const G=m(J.x,J.y);b.set(E,G),_++,console.warn(`[Connectivity] Component ${g} pin ${ae+1}: Point ID ${E} not in pointIdToCoord, but adding pin at calculated position (${J.x},${J.y}) - may be connected to power/ground`)}}else U.push({compId:N.id,designator:g,pinIndex:ae,pointId:V.trim()}),console.warn(`[Connectivity] Component ${g} pin ${ae+1}: Invalid point ID "${V}" - pin is NOT connected`)}}}if(console.log(`[Connectivity] Added ${_} connected component pins to coordinate graph`),U.length>0){console.warn(`[Connectivity] Found ${U.length} component pins with invalid or missing connections (not added to graph):`);for(const N of U.slice(0,10))console.warn(`  - ${N.designator} pin ${N.pinIndex+1}: point ID "${N.pointId}" not found`)}return d}function Sh(n,r){const o=[],l=(d,b)=>{const p=Math.round(d*Math.pow(10,6))/Math.pow(10,6),v=Math.round(b*Math.pow(10,6))/Math.pow(10,6);return`${p},${v}`};for(const d of n)if(d.type==="trace"&&d.points.length>=2)for(let b=0;b<d.points.length-1;b++){const p=d.points[b],v=d.points[b+1];if(p&&v){const m=l(p.x,p.y),C=l(v.x,v.y);m!==C&&o.push([m,C])}}return o}function K2(n){let r=n.trim();r=r.replace(/\s*(VDC|VAC)\s*$/i,""),r=r.replace(/\s*(DC|AC)\s*$/i,""),r=r.replace(/\s*V\s*$/i,"");const o=r.match(/^([+-])?/),s=o&&o[1]||"+",l=r.match(/(\d+\.?\d*)/);if(!l)return n.trim();let d=l[1];if(d.includes(".")){const b=d.split("."),p=b[0],m=(b[1]||"0").replace(/0+$/,"")||"0";d=`${p}V${m}`}return`${s}${d}V`}function Th(n,r,o=[],s=[]){const l=new G2,d=new Map;let b=1;const p=S=>(d.has(S)||d.set(S,b++),d.get(S));for(const[S,U]of r){const _=p(S),N=p(U);l.union(_,N)}const v=new Map;for(const[S,U]of n)if(U.type==="ground"){const _=U.groundBusId||"default";v.has(_)||v.set(_,[]),v.get(_).push(S),p(S)}for(const[S,U]of v)if(U.length>0){const N=s.find(g=>g.id===S)?.name||(S==="default"?"GND":S);if(U.length>1){const g=p(U[0]);for(let ae=1;ae<U.length;ae++){const V=p(U[ae]);l.union(g,V)}console.log(`[Connectivity] Unified ${U.length} ground nodes with bus "${N}" into a single net (common ground bus)`)}else console.log(`[Connectivity] Found 1 ground node with bus "${N}" (common ground bus)`)}const m=new Map;for(const[S,U]of n)if(U.type==="power"&&U.powerBusId){const _=U.powerBusId;m.has(_)||m.set(_,[]),m.get(_).push(S),p(S)}for(const[S,U]of m)if(U.length>0){const N=o.find(g=>g.id===S)?.name||S;if(U.length>1){const g=p(U[0]);for(let ae=1;ae<U.length;ae++){const V=p(U[ae]);l.union(g,V)}console.log(`[Connectivity] Unified ${U.length} power nodes with bus "${N}" into a single net (common power bus)`)}else console.log(`[Connectivity] Found 1 power node with bus "${N}" (common power bus)`)}for(const S of n.keys())p(S);const C=l.getGroups(),D=new Map,M=new Map;for(const[S,U]of d)M.set(U,S);for(const[S,U]of C){const _=M.get(S);if(!_)continue;const N=U.map(g=>M.get(g)).filter(g=>g!==void 0).map(g=>n.get(g)).filter(g=>g!==void 0);D.set(_,N)}return D}function Ch(n,r){const o=new Map;let s=1;for(const[l,d]of n){if(d.some(v=>v.type==="ground")){o.set(l,"GND");continue}const p=d.filter(v=>v.type==="power");if(p.length>0){const v=p[0].voltage||"UNKNOWN",m=K2(v);o.set(l,m);continue}o.set(l,`N$${s++}`)}return o}function Kc(n,r,o,s){if(r==="power"){const d=n[r]||"";return typeof d=="string"&&d.trim()!==""?{value:d.replace(/W$/i,"").trim(),unit:"W"}:{value:"",unit:"W"}}if(n[r]!==void 0||n[o]!==void 0)return{value:n[r]||"",unit:n[o]||s};const l=n[r]||"";if(typeof l=="string"&&l.trim()!==""){const d=l.trim().match(/^([\d]+\/[\d]+)\s*([a-zA-ZuW]+)?$/);if(d)return{value:d[1],unit:d[2]||""};const b=l.trim().match(/^([\d.]+)\s*([a-zA-ZuW]+)?$/);return b?{value:b[1],unit:b[2]||""}:{value:l.trim(),unit:""}}return{value:"",unit:s}}function Zc(n,r){return!n||n.trim()===""?"":!r||r.trim()===""?n.trim():`${n.trim()}${r.trim()}`}function _s(n){return{resistance:"",capacitance:"F",inductance:"H",voltage:"V",current:"A",power:"W",impedance:"",capacity:"mAh",esr:"",coilVoltage:"V",inputVoltage:"V",outputVoltage:"V"}[n]||""}function cx(n){if(n.componentType==="Resistor"&&"resistance"in n){const{value:s,unit:l}=Kc(n,"resistance","resistanceUnit",_s("resistance"));if(s&&s.trim()!=="")return Zc(s,l)}if(n.componentType==="Capacitor"&&"capacitance"in n){const{value:s,unit:l}=Kc(n,"capacitance","capacitanceUnit",_s("capacitance"));if(s&&s.trim()!=="")return Zc(s,l)}if(n.componentType==="Electrolytic Capacitor"&&"capacitance"in n){const{value:s,unit:l}=Kc(n,"capacitance","capacitanceUnit",_s("capacitance"));if(s&&s.trim()!=="")return Zc(s,l)}if(n.componentType==="Inductor"&&"inductance"in n){const{value:s,unit:l}=Kc(n,"inductance","inductanceUnit",_s("inductance"));if(s&&s.trim()!=="")return Zc(s,l)}const r=n.partName?.trim();if(r&&r!=="")return r;const o=n.partNumber?.trim();return o&&o!==""?o:n.componentType}function ux(n){return n.packageType?n.packageType:{Resistor:"R_0805",Capacitor:"C_0805",Inductor:"L_0805",Diode:"D_SOD-123",Transistor:"TO-92",IntegratedCircuit:"DIP-8"}[n.componentType]||"Unknown"}function Z2(n,r,o,s,l){const d=wh(r,n,o,s,l),b=Sh(r),p=Th(d,b),v=Ch(p),m=new Map;for(const U of n){const _=U.abbreviation?.trim()||U.designator?.trim();_&&m.set(_,U)}const C=[];let D=1;for(const[U,_]of p){const N=v.get(U)||`N$${D}`,g=[];for(const ae of _)if(ae.type==="component_pin"&&ae.componentId&&ae.pinIndex!==void 0){const V=n.find(E=>E.id===ae.componentId);if(V){const E=V.abbreviation?.trim()||V.designator?.trim();E&&g.push({designator:E,pin:(ae.pinIndex||0)+1})}}g.length>0&&C.push({name:N,code:D++,componentPins:g})}C.sort((U,_)=>U.name==="GND"?-1:_.name==="GND"?1:U.name.startsWith("+")||U.name.startsWith("-")?-1:_.name.startsWith("+")||_.name.startsWith("-")?1:U.code-_.code);let M=`(
`;M+=`  (components
`;const S=Array.from(m.keys()).sort();for(const U of S){const _=m.get(U),N=cx(_),g=ux(_);M+=`    (comp (ref ${U})
`,M+=`      (value ${N})
`,M+=`      (footprint ${g})
`,M+=`    )
`}M+=`  )
`,M+=`  (nets
`;for(const U of C){M+=`    (net (code ${U.code}) (name ${U.name})
`;for(const _ of U.componentPins)M+=`      (node (ref ${_.designator}) (pin ${_.pin}))
`;M+=`    )
`}return M+=`  )
`,M+=`)
`,M}function J2(n,r,o,s,l){const d=wh(r,n,o,s,l),b=Sh(r),p=Th(d,b),v=Ch(p),m=new Map;for(const U of n){const _=U.abbreviation?.trim()||U.designator?.trim();_&&m.set(_,U)}const C=new Set;for(const[,U]of p)for(const _ of U)if(_.type==="component_pin"&&_.componentId&&_.pinIndex!==void 0){const N=n.find(g=>g.id===_.componentId);if(N){const g=N.abbreviation?.trim()||N.designator?.trim();g&&C.add(g)}}let D="";D+="[";const M=Array.from(C).sort();for(const U of M){const _=m.get(U);if(!_)continue;const N=_.packageType||ux(_),g=cx(_);D+=`[${U}
`,D+=`${N}
`,D+=`${g}
`,D+=`



`,D+="]"}D+=`]
`,D+=`(
`;let S=1;for(const[U,_]of p){const N=v.get(U)||`N$${S}`,g=[];for(const ae of _)if(ae.type==="component_pin"&&ae.componentId&&ae.pinIndex!==void 0){const V=n.find(E=>E.id===ae.componentId);if(V){const E=V.abbreviation?.trim()||V.designator?.trim();E&&g.push({designator:E,pin:(ae.pinIndex||0)+1})}}if(g.length>0){D+=`(${N}
`;for(const ae of g)D+=`  (${ae.designator}-${ae.pin})
`;D+=`)
`}S++}return D+=`)
`,D}function Q2(n,r,o,s,l){const d=wh(r,n,o,s,l),b=Sh(r),p=Th(d,b),v=Ch(p),m=new Map;for(const V of n){const E=V.abbreviation?.trim()||V.designator?.trim();E&&m.set(E,V)}const C=V=>{switch(V.componentType){case"Resistor":return"R";case"Capacitor":return"C";case"Electrolytic Capacitor":return"C";case"Film Capacitor":return"C";case"Inductor":return"L";case"Diode":return"D";case"Transistor":return"Q";case"IntegratedCircuit":return"X";case"Switch":return"S";case"Battery":return"V";case"Fuse":return"R";case"Jumper":return"R";default:return"X"}},D=V=>{const re=(V.abbreviation?.trim()||V.designator?.trim()||"").match(/\d+/);return re?re[0]:V.id.substring(0,8)},M=V=>{if(V.componentType==="Resistor"&&"resistance"in V){const{value:J,unit:G}=Kc(V,"resistance","resistanceUnit",_s("resistance"));if(J&&J.trim()!=="")return Zc(J,G)}if((V.componentType==="Capacitor"||V.componentType==="Electrolytic Capacitor")&&"capacitance"in V){const{value:J,unit:G}=Kc(V,"capacitance","capacitanceUnit",_s("capacitance"));if(J&&J.trim()!=="")return Zc(J,G)}if(V.componentType==="Inductor"&&"inductance"in V){const{value:J,unit:G}=Kc(V,"inductance","inductanceUnit",_s("inductance"));if(J&&J.trim()!=="")return Zc(J,G)}const E=V.partName?.trim();if(E&&E!=="")return E;const re=V.partNumber?.trim();return re&&re!==""?re:V.componentType},S=new Map;let U=1;for(const[V]of p){const E=v.get(V);if(!E)continue;let re;E==="GND"?re="0":E.startsWith("+")||E.startsWith("-")?re=E.replace(/\s+/g,"").replace(/[^a-zA-Z0-9_+-]/g,"_"):re=`N${U++}`,S.set(V,re)}const _=new Map;for(const[V,E]of S.entries()){const re=v.get(V);re&&(re.startsWith("+")||re.startsWith("-"))&&_.set(re,E)}let N=`* SPICE Netlist
`;N+=`* Generated from PCB Reverse Engineering Tool
*

`;const g=Array.from(m.keys()).sort();for(const V of g){const E=m.get(V),re=C(E),J=M(E),G=[];for(const[F,$]of p){const H=S.get(F);if(H)for(const R of $)R.type==="component_pin"&&R.componentId===E.id&&R.pinIndex!==void 0&&G.push({pinIndex:R.pinIndex,nodeName:H})}G.sort((F,$)=>F.pinIndex-$.pinIndex);const ee=D(E);if(E.componentType==="Switch")G.length>=2&&(N+=`* Switch ${V}: ${E.componentType} - needs manual modeling
`,N+=`* S${ee} ${G[0].nodeName} ${G[1].nodeName} 0 0 SW_MODEL
`);else if(E.componentType==="IntegratedCircuit"){const F=E.partNumber?.trim()||E.partName?.trim()||E.componentType;if(G.length>0){N+=`X${ee}`;for(const $ of G)N+=` ${$.nodeName}`;N+=` ${F}
`,N+=`* Note: Subcircuit definition for ${F} must be provided
`}}else if(E.componentType==="Battery"){const F=M(E);G.length>=2&&(N+=`V${ee} ${G[0].nodeName} ${G[1].nodeName} DC ${F||"5"}
`)}else if(G.length>0){N+=`${re}${ee}`;for(const F of G)N+=` ${F.nodeName}`;J&&J.trim()!==""&&(E.componentType==="Resistor"||E.componentType==="Capacitor"||E.componentType==="Electrolytic Capacitor"||E.componentType==="Film Capacitor"||E.componentType==="Inductor"||E.componentType==="Diode")&&(N+=` ${J}`),N+=`
`}else{const F=E.pinCount||2;N+=`${re}${ee}`;for(let $=0;$<F;$++)N+=` NC${$+1}`;J&&J.trim()!==""&&(N+=` ${J}`),N+=`
`}}const ae=new Set;for(const[V]of p){const E=v.get(V);E&&(E.startsWith("+")||E.startsWith("-"))&&ae.add(E)}if(ae.size>0){N+=`
* Power sources (user should define these)
`;let V=1;for(const E of Array.from(ae).sort()){const re=_.get(E)||E.replace(/\s+/g,"").replace(/[^a-zA-Z0-9_+-]/g,"_"),J=E.match(/[+-]?[\d.]+/),G=J?J[0]:"5";N+=`* V${V++} ${re} 0 DC ${G}
`}}return N+=`
* Simulation commands (uncomment and modify as needed):
`,N+=`* .op                    ; DC operating point
`,N+=`* .tran 1ms 10ms         ; Transient analysis
`,N+=`* .ac dec 10 1 1k        ; AC analysis
`,N+=`
.end
`,N}function eb(n,r,o,s,l,d,b){const p=wh(r,n,o,s,l),v=Sh(r),m=Th(p,v,l,d),C=Ch(m),D=new Map,M=J=>J.componentType==="Jumper"||J.componentType==="Connector"||J.componentType==="Switch",S=new Map;for(const[J,G]of p)if(G.componentId&&G.pinIndex!==void 0){const ee=`${G.componentId}:${G.pinIndex}`;S.set(ee,J)}const U=new Map;for(const[J]of p.keys())U.set(J,new Set);for(const[J,G]of v)U.has(J)&&U.get(J).add(G),U.has(G)&&U.get(G).add(J);const _=(J,G,ee)=>{if(ee.has(J))return;ee.add(J);const F=p.get(J);if(!F)return;if(F.componentId&&F.pinIndex!==void 0){const H=`${F.componentId}:${F.pinIndex}`;D.has(H)||D.set(H,new Set),D.get(H).add(G);const R=n.find(Z=>Z.id===F.componentId);if(R&&M(R))for(let Z=0;Z<R.pinCount;Z++){const Y=`${R.id}:${Z}`;D.has(Y)||D.set(Y,new Set),D.get(Y).add(G);const we=S.get(Y);we&&!ee.has(we)&&_(we,G,ee)}}const $=U.get(J);if($)for(const H of $)_(H,G,ee)};for(const J of l){const G=J.name,ee=new Set;for(const[F,$]of p)$.type==="power"&&$.powerBusId===J.id&&_(F,G,ee)}for(const J of d){const G=J.name,ee=new Set;for(const[F,$]of p)$.type==="ground"&&$.groundBusId===J.id&&_(F,G,ee)}const N=new Map;for(const J of n){const G=J.designator?.trim()||J.abbreviation?.trim();G&&N.set(G,J)}const g=J=>{if(!J||J.trim()==="")return"unknown";const G=J.toUpperCase().trim();return G==="VCC"||G==="VDD"||G.startsWith("VCC")||G.startsWith("VDD")||G==="V+"||G.startsWith("V+")||G==="VP"||G==="VPOS"?"power":G==="GND"||G==="VSS"||G==="V-"||G.startsWith("V-")||G==="VN"||G==="VNEG"||G==="GROUND"?"ground":G.startsWith("IN")||G.startsWith("INPUT")||G.includes("IN+")||G.includes("IN-")||G==="A"||G==="B"||G.startsWith("CLK")||G.startsWith("EN")||G.startsWith("CS")||G.startsWith("CE")?"input":G.startsWith("OUT")||G.startsWith("OUTPUT")||G.includes("OUT+")||G.includes("OUT-")||G==="Y"||G==="Q"||G.startsWith("DO")?"output":"unknown"},ae=[],V=Array.from(N.keys()).sort();for(const J of V){const G=N.get(J),ee=G.partNumber?.trim()||"";let F="";if(G.componentType==="Resistor"&&"resistance"in G){const{value:te,unit:de}=Kc(G,"resistance","resistanceUnit",_s("resistance"));F=te&&te.trim()!==""?Zc(te,de):""}else if((G.componentType==="Capacitor"||G.componentType==="Electrolytic Capacitor"||G.componentType==="Film Capacitor")&&"capacitance"in G){const{value:te,unit:de}=Kc(G,"capacitance","capacitanceUnit",_s("capacitance"));F=te&&te.trim()!==""?Zc(te,de):""}else if(G.componentType==="Inductor"&&"inductance"in G){const{value:te,unit:de}=Kc(G,"inductance","inductanceUnit",_s("inductance"));F=te&&te.trim()!==""?Zc(te,de):""}else ee||(F=G.partName?.trim()||G.componentType);const $=G.packageType?.trim()||G.package?.trim()||G.footprint?.trim()||"",H=G.pinData,R=G.pinNames,Z=G.pinCount||0,Y=[];for(let te=0;te<Z;te++){const de=String(te+1);let je=de;H&&te<H.length&&H[te]?.name?.trim()?je=H[te].name.trim():R&&te<R.length&&R[te]?.trim()&&(je=R[te].trim());let Ie;const xe=H?.[te]?.type?.trim();xe&&xe!==""?Ie=xe:Ie=g(je),Y.push({number:de,name:je,type:Ie})}const we={designator:J,package:$,pins:Y};ee&&(we.part_number=ee),F&&(we.value=F),ae.push(we)}const E=[];for(const[J,G]of m){const ee=C.get(J);if(!ee)continue;const F=[];let $,H;for(const Y of G)if(Y.type==="power"&&Y.powerBusId){const we=l.find(te=>te.id===Y.powerBusId);we&&($=we.name)}else if(Y.type==="ground"&&Y.groundBusId){const we=d.find(te=>te.id===Y.groundBusId);we&&(H=we.name)}for(const Y of G)if(Y.componentId&&Y.pinIndex!==void 0){const we=n.find(te=>te.id===Y.componentId);if(we){const te=we.designator?.trim()||we.abbreviation?.trim();if(te){const de=String(Y.pinIndex+1),je=we.pinData,Ie=we.pinNames;let xe=de;je&&Y.pinIndex<je.length&&je[Y.pinIndex]?.name?.trim()?xe=je[Y.pinIndex].name.trim():Ie&&Y.pinIndex<Ie.length&&Ie[Y.pinIndex]?.trim()&&(xe=Ie[Y.pinIndex].trim());let k;const A=je?.[Y.pinIndex]?.type?.trim();A&&A!==""&&(k=A);const q={component:te,pin_number:de,pin_name:xe};k&&(q.pin_type=k);const W=`${we.id}:${Y.pinIndex}`,se=D.get(W);if(se&&se.size>0)for(const Ce of se){const le=l.find(be=>be.name===Ce),_e=d.find(be=>be.name===Ce);le&&!q.power_bus?q.power_bus=Ce:_e&&!q.ground_bus&&(q.ground_bus=Ce)}if(!q.power_bus&&Y.powerBusId){const Ce=l.find(le=>le.id===Y.powerBusId);Ce&&(q.power_bus=Ce.name)}if(!q.ground_bus&&Y.groundBusId){const Ce=d.find(le=>le.id===Y.groundBusId);Ce&&(q.ground_bus=Ce.name)}!q.power_bus&&$&&(q.power_bus=$),!q.ground_bus&&H&&(q.ground_bus=H),F.push(q)}}}const R=ee.startsWith("+")||ee.startsWith("-"),Z=ee==="GND"||ee.toUpperCase().includes("GROUND");(F.length>0||R||Z)&&E.push({name:ee,connections:F})}E.sort((J,G)=>{if(J.name==="GND")return-1;if(G.name==="GND")return 1;const ee=J.name.startsWith("+")||J.name.startsWith("-"),F=G.name.startsWith("+")||G.name.startsWith("-");if(ee&&!F)return-1;if(!ee&&F)return 1;if(ee&&F){const $=parseFloat(J.name.replace(/[^0-9.-]/g,""))||0,H=parseFloat(G.name.replace(/[^0-9.-]/g,""))||0;if(H!==$)return H-$}return J.name.localeCompare(G.name)});const re={design_info:{name:b||"reversed_pcb",date:new Date().toISOString().split("T")[0]},components:ae,nets:E};return JSON.stringify(re,null,2)}function xd(n,r,o,s){if(r==="power"){const d=n[r]||"";return typeof d=="string"&&d.trim()!==""?{value:d.replace(/W$/i,"").trim(),unit:"W"}:{value:"",unit:"W"}}if(n[r]!==void 0||n[o]!==void 0)return{value:n[r]||"",unit:n[o]||s};const l=n[r]||"";return typeof l=="string"&&l.trim()!==""?lx(l):{value:"",unit:s}}function tb(n){if((n.componentType==="Resistor"||n.componentType==="ResistorNetwork"||n.componentType==="Thermistor"||n.componentType==="VariableResistor")&&"resistance"in n){const{value:s,unit:l}=xd(n,"resistance","resistanceUnit",_s("resistance"));if(s&&s.trim()!=="")return yd(s,l)}if((n.componentType==="Capacitor"||n.componentType==="Electrolytic Capacitor"||n.componentType==="Film Capacitor")&&"capacitance"in n){const{value:s,unit:l}=xd(n,"capacitance","capacitanceUnit",_s("capacitance"));if(s&&s.trim()!=="")return yd(s,l)}if(n.componentType==="Inductor"&&"inductance"in n){const{value:s,unit:l}=xd(n,"inductance","inductanceUnit",_s("inductance"));if(s&&s.trim()!=="")return yd(s,l)}if(n.componentType==="Fuse"&&"current"in n){const{value:s,unit:l}=xd(n,"current","currentUnit",_s("current"));if(s&&s.trim()!=="")return yd(s,l)}if(n.componentType==="Battery"){const{value:s,unit:l}=xd(n,"capacity","capacityUnit",_s("capacity"));if(s&&s.trim()!=="")return yd(s,l);const{value:d,unit:b}=xd(n,"voltage","voltageUnit",_s("voltage"));if(d&&d.trim()!=="")return yd(d,b)}if(n.componentType==="PowerSupply"){const{value:s,unit:l}=xd(n,"outputVoltage","outputVoltageUnit",_s("voltage"));if(s&&s.trim()!=="")return yd(s,l)}const r=n.partName?.trim();if(r&&r!=="")return r;const o=n.partNumber?.trim();return o&&o!==""?o:Yl(n.componentType)}function nb(n,r,o){const s=[...n,...r],l=s.length,d=new Map;for(const p of s){const v=Yl(p.componentType),m=tb(p),C=`${v}|${m}`;if(!d.has(C)){const M=n.some(_=>_.id===p.id),S=r.some(_=>_.id===p.id),U=M&&S?"both":M?"top":"bottom";d.set(C,{componentType:v,value:m,quantity:0,designators:[],packageType:p.packageType,manufacturer:p.manufacturer,partNumber:p.partNumber,description:p.description,notes:p.notes,datasheet:p.datasheet,layer:U})}const D=d.get(C);D.quantity++,p.designator&&p.designator.trim()!==""&&D.designators.push(p.designator.trim())}const b=Array.from(d.values()).sort((p,v)=>p.componentType!==v.componentType?p.componentType.localeCompare(v.componentType):p.value.localeCompare(v.value));return{version:"1.0",exportedAt:new Date().toISOString(),projectName:o,totalComponents:l,uniqueComponents:b.length,items:b}}const R1={via:{color:"#2CA02C",size:18},padTop:{color:"#0072B2",size:18},padBottom:{color:"#56B4E9",size:18},testPointTop:{color:"#FFFF00",size:18},testPointBottom:{color:"#FFFF00",size:18},traceTop:{color:"#AA4499",size:6},traceBottom:{color:"#F781BF",size:6},componentTop:{color:"#6A3D9A",size:18},componentBottom:{color:"#9467BD",size:18},power:{color:"#ff0000",size:18},ground:{color:"#000000",size:18}},Gf={via:"Via",padTop:"Pad (Top)",padBottom:"Pad (Bottom)",testPointTop:"Test Point (Top)",testPointBottom:"Test Point (Bottom)",traceTop:"Trace (Top)",traceBottom:"Trace (Bottom)",componentTop:"Component (Top)",componentBottom:"Component (Bottom)",power:"Power",ground:"Ground"};class ib{instances=new Map;listeners=new Map;initialize(){for(const r of Object.keys(R1)){const o=R1[r];this.instances.set(r,{id:r,name:Gf[r],color:o.color,size:o.size}),this.listeners.set(r,new Set)}}initializeFromProject(r){if(this.initialize(),r?.toolInstances)for(const[o,s]of Object.entries(r.toolInstances))this.instances.has(o)&&this.instances.set(o,s)}get(r){const o=this.instances.get(r);if(!o)throw new Error(`Tool instance ${r} not found`);return o}getColor(r){const o=this.instances.get(r);if(!o)throw new Error(`Tool instance ${r} not found`);const s=Gf[r];return console.log(`${s}, returning color value=${o.color}`),o.color}getSize(r){const o=this.instances.get(r);if(!o)throw new Error(`Tool instance ${r} not found`);const s=Gf[r];return console.log(`${s}, returning size value=${o.size}`),o.size}setColor(r,o){const s=this.instances.get(r);if(s){const l=Gf[r];console.log(`${l}, setting color value=${o}`),s.color=o,this.notifyListeners(r)}}setSize(r,o){const s=this.instances.get(r);if(s){const l=Gf[r];console.log(`${l}, setting size value=${o}`),s.size=o,this.notifyListeners(r)}}getAll(){const r={};for(const[o,s]of this.instances.entries())r[o]=s;return r}subscribe(r,o){const s=this.listeners.get(r);return s?(s.add(o),()=>{s.delete(o)}):()=>{}}notifyListeners(r){const o=this.listeners.get(r);o&&o.forEach(s=>s())}}const On=new ib;On.initialize();function Jp(n,r){switch(n){case"via":return"via";case"pad":return r==="bottom"?"padBottom":"padTop";case"testPoint":return r==="bottom"?"testPointBottom":"testPointTop";case"trace":return r==="bottom"?"traceBottom":"traceTop";case"component":return r==="bottom"?"componentBottom":"componentTop";case"power":return"power";case"ground":return"ground";default:throw new Error(`Unknown tool: ${n}`)}}function rb(n){return()=>{console.log("closeProject: Starting comprehensive state clearing..."),n.setProjectDirHandle(null),n.setAutoSaveDirHandle(null),n.projectDirHandleRef&&(n.projectDirHandleRef.current=null),n.autoSaveDirHandleRef&&(n.autoSaveDirHandleRef.current=null),n.setCurrentProjectFilePath(""),n.setProjectName(""),n.setAutoSaveEnabled(!1),n.setAutoSaveInterval(null),n.setAutoSaveBaseName(""),n.setAutoSaveFileHistory([]),n.setCurrentFileIndex(-1),n.autoSaveBaseNameRef&&(n.autoSaveBaseNameRef.current=""),n.hasChangesSinceLastAutoSaveRef.current=!1,n.setHasUnsavedChangesState(!1),n.setIsBottomView(!1),n.setOriginalTopFlipX(null),n.setOriginalBottomFlipX(null),n.autoSaveIntervalRef.current&&(clearInterval(n.autoSaveIntervalRef.current),n.autoSaveIntervalRef.current=null),n.setTopImage(null),n.setBottomImage(null),n.clearSnapshot(),n.setDrawingStrokes([]),n.setVias([]),n.setPads([]),n.setTracesTop([]),n.setTracesBottom([]),n.setCurrentStroke([]),n.currentStrokeRef.current=[],n.setComponentsTop([]),n.setComponentsBottom([]),n.setComponentEditor(null),n.setConnectingPin(null),n.setPowerSymbols([]),n.setGroundSymbols([]),n.setPowerEditor(null),n.setPowerBuses([{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),n.setGroundBuses([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),n.setSelectedIds(new Set),n.setSelectedComponentIds(new Set),n.setSelectedPowerIds(new Set),n.setSelectedGroundIds(new Set),n.setIsSelecting(!1),n.setProjectNotes([]),n.setProjectMetadata({productName:"",productVersion:"",manufacturer:"",date:new Date().toISOString().split("T")[0]}),n.setCurrentView("overlay"),n.setViewScale(1),n.setCameraCenter(0,0),n.setShowBothLayers(!0),n.setSelectedDrawingLayer("top"),n.setHomeViews({}),n.setIsWaitingForHomeViewKey(!1),n.homeViewTimeoutRef.current&&(clearTimeout(n.homeViewTimeoutRef.current),n.homeViewTimeoutRef.current=null),n.setSelectedImageForTransform(null),n.setIsTransforming(!1),n.setTransformStartPos(null),n.setTransformMode("nudge"),n.setIsGrayscale(!1),n.setTransparency(50),n.setIsTransparencyCycling(!1),n.setTransparencyCycleSpeed(2e3),n.setAreImagesLocked(!1),n.setAreViasLocked(!1),n.setArePadsLocked(!1),n.setAreTestPointsLocked(!1),n.setAreTracesLocked(!1),n.setAreComponentsLocked(!1),n.setAreGroundNodesLocked(!1),n.setArePowerNodesLocked(!1),n.setShowTopImage(!0),n.setShowBottomImage(!0),n.setShowViasLayer(!0),n.setShowTopTracesLayer(!0),n.setShowBottomTracesLayer(!0),n.setShowTopPadsLayer(!0),n.setShowBottomPadsLayer(!0),n.setShowTopTestPointsLayer(!0),n.setShowBottomTestPointsLayer(!0),n.setShowTopComponents(!0),n.setShowBottomComponents(!0),n.setShowPowerLayer(!0),n.setShowGroundLayer(!0),n.setShowConnectionsLayer(!0),n.setShowTraceCornerDots(!0),n.setCurrentTool("select"),n.setDrawingMode("trace"),n.setTraceToolLayer("top"),n.setPadToolLayer("top"),n.setTestPointToolLayer("top"),n.setComponentToolLayer("top"),n.traceToolLayerRef.current="top",n.padToolLayerRef.current="top",n.testPointToolLayerRef.current="top",n.componentToolLayerRef.current="top",n.sessionDesignatorCountersRef.current={},n.setAutoAssignDesignators(!0),n.setUseGlobalDesignatorCounters(!1),Jf(),On.initialize(),n.setOpenMenu(null),n.setDebugDialog({visible:!1,text:""}),n.setErrorDialog({visible:!1,title:"",message:""}),n.setNewProjectDialog({visible:!1}),n.setOpenProjectDialog({visible:!1}),n.setNewProjectSetupDialog({visible:!1,projectName:"",locationPath:"",locationHandle:null}),n.setSaveAsDialog({visible:!1,filename:"",locationPath:"",locationHandle:null}),n.setAutoSaveDialog({visible:!1,interval:null}),n.setAutoSavePromptDialog({visible:!1,source:"new",interval:5}),n.setShowColorPicker(!1),n.setShowPowerBusManager(!1),n.setShowGroundBusManager(!1),n.setShowDesignatorManager(!1),n.setShowBoardDimensionsDialog(!1),n.setNotesDialogVisible(!1),n.setProjectNotesDialogVisible(!1),n.setTransformImagesDialogVisible(!1),n.setTransformAllDialogVisible(!1),n.setBoardDimensions(null),n.setHoverComponent(null),n.setHoverTestPoint(null),n.setIsPanning(!1),n.panStartRef.current=null,n.panClientStartRef.current=null,n.setIsDrawing(!1),n.setTracePreviewMousePos(null),n.lastTraceClickTimeRef.current=0,n.isDoubleClickingTraceRef.current=!1,console.log("closeProject: All state cleared and browser permissions released")}}async function ob(n){console.log("Ensuring project isolation: Starting comprehensive cleanup..."),n(),await new Promise(r=>setTimeout(r,150)),On.initialize(),Jf(),await new Promise(r=>setTimeout(r,50)),console.log("Project isolation complete: All state cleared, safe to proceed with new project")}async function ab(n,r,o,s,l,d,b,p,v,m,C,D,M){const S=n.trim().replace(/[^a-zA-Z0-9_-]/g,"_");if(!S)return{success:!1,error:"Please enter a valid project name."};await o();let U;try{U=await r.getDirectoryHandle(S,{create:!0})}catch(_){return console.error("Failed to create project folder:",_),{success:!1,error:`Failed to create project folder "${S}". See console for details.`}}try{const _=U;if(_.queryPermission&&await _.queryPermission({mode:"readwrite"})!=="granted"&&await _.requestPermission({mode:"readwrite"})!=="granted")return{success:!1,error:"Full access to the project directory is required to create and manage project files."}}catch(_){console.warn("Permission check failed (may not be supported in this browser):",_)}try{await U.getDirectoryHandle("history",{create:!0}),await U.getDirectoryHandle("images",{create:!0}),await U.getDirectoryHandle("datasheets",{create:!0}),await U.getDirectoryHandle("BOM",{create:!0}),await U.getDirectoryHandle("netlists",{create:!0}),console.log("Created project subdirectories: history, images, datasheets, BOM, netlists")}catch(_){console.error("Failed to create project subdirectories:",_)}s(S),l(U),b.current=U,v(),m(),C(!1),D(0);try{const{project:_,timestamp:N}=p(),g=`${S}_${N}.json`,ae=JSON.stringify(_,null,2),V=new Blob([ae],{type:"application/json"}),re=await(await U.getFileHandle(g,{create:!0})).createWritable();return await re.write(V),await re.close(),d(g),console.log(`New project created: ${S}/${g}`),await M(5,S,U,!0),{success:!0,projectDirHandle:U,projectFileName:g,projectName:S}}catch(_){return console.error("Failed to save new project:",_),{success:!1,error:"Failed to save new project file. See console for details."}}}async function I1(n,r,o,s,l,d,b,p,v){const m=window;let C;if(v)C=v;else{if(typeof m.showDirectoryPicker!="function")return{success:!1,error:"Directory picker is not supported in this browser."};try{C=await m.showDirectoryPicker({mode:"readwrite"})}catch(D){if(D?.name==="AbortError")return{success:!1,error:"User cancelled directory selection."};throw D}}try{try{const g=C;if(g.queryPermission&&await g.queryPermission({mode:"readwrite"})!=="granted"&&await g.requestPermission({mode:"readwrite"})!=="granted")return{success:!1,error:"Full access to the project directory is required to open and manage project files."}}catch(g){console.warn("Permission check failed (may not be supported in this browser):",g)}d.current=!0,await n();const D=C.name;let M=null,S=null,U="";try{const g=[],ae=C;for await(const[J,G]of ae.entries())if(G.kind==="file"&&J.toLowerCase().endsWith(".json")&&J.replace(/\.json$/i,"").toLowerCase().startsWith(D.toLowerCase()))try{const F=await G.getFile();g.push({name:J,handle:G,lastModified:F.lastModified})}catch(F){console.warn(`Failed to read file ${J}:`,F)}if(g.length===0)return{success:!1,error:`No project file found in the selected directory that starts with "${D}". Please ensure the project file name starts with the directory name.`};g.sort((J,G)=>G.lastModified-J.lastModified);const V=g[0];M=V.handle,U=V.name;const re=await(await M.getFile()).text();S=JSON.parse(re),o(U),g.length>1?console.log(`Found ${g.length} project files starting with "${D}". Selected most recent: ${U}`):console.log(`Found project file: ${U}`)}catch(g){return console.error("Failed to find or open project file:",g),{success:!1,error:`Failed to open project file: ${g instanceof Error?g.message:String(g)}. See console for details.`}}r(C),l.current=C;try{await C.getDirectoryHandle("history",{create:!0}),await C.getDirectoryHandle("images",{create:!0}),await C.getDirectoryHandle("datasheets",{create:!0}),await C.getDirectoryHandle("BOM",{create:!0}),await C.getDirectoryHandle("netlists",{create:!0}),console.log("Created/verified project subdirectories: history, images, datasheets, BOM, netlists")}catch(g){console.error("Failed to create/verify project subdirectories:",g)}setTimeout(()=>{d.current=!1},1e3),await b(S,C);let _;if(S.projectInfo?.name)_=S.projectInfo.name;else if(_=vd(D).replace(/[^a-zA-Z0-9_-]/g,"_"),!_){const ae=U.replace(/\.json$/i,"");_=vd(ae).replace(/[^a-zA-Z0-9_-]/g,"_")}return _?(s(_),S.autoSave?.enabled===!0&&S.autoSave?.interval?await p(S.autoSave.interval,_,C,!1):await p(5,_,C,!1),{success:!0,projectDirHandle:C,projectFileName:U,projectName:_}):{success:!1,error:"Warning: Could not determine project name. Please ensure the project file or directory has a valid name."}}catch(D){return D?.name==="AbortError"?{success:!1,error:"User cancelled directory selection."}:(console.error("Failed to open project:",D),{success:!1,error:`Failed to open project: ${D instanceof Error?D.message:String(D)}. See console for details.`})}}async function sb(n,r,o,s,l,d,b,p,v,m,C,D,M,S,U){if(console.log("Auto save: performAutoSave called"),!n||!r){console.warn(`Auto save: Missing project directory handle (${!n}) or base name (${!r}). Please create a new project or open an existing project first.`),S(!1),U.current&&(clearInterval(U.current),U.current=null);return}if(!o.current){console.log("Auto save: Skipping - no changes since last save");return}const _=s.current,N=_.filter(G=>G.type==="trace"&&G.points.length<2);if(N.length>0){console.log(`Auto save: Cleaning up ${N.length} single-point trace(s) before save`),N.forEach(ee=>console.log(`  - Removing single-point trace ${ee.id}`));const G=_.filter(ee=>!(ee.type==="trace"&&ee.points.length<2));l(G),s.current=G}console.log("Auto save: Starting save...");const{project:g,timestamp:ae}=d(),E=`${vd(r)}_${ae}.json`,re=JSON.stringify(g,null,2),J=new Blob([re],{type:"application/json"});try{let G;try{G=await n.getDirectoryHandle("history",{create:!0})}catch(R){console.error("Failed to get/create history directory:",R);return}try{const R=[],Z=p.current;for await(const Y of n.keys())try{if(Y==="history"||Y==="images"||Y==="datasheets"||Y==="BOM"||Y==="netlists"||Y===E)continue;const te=await(await n.getFileHandle(Y)).getFile();if(!Y.endsWith(".json"))continue;const de=await te.text();try{const je=JSON.parse(de);if(je.version){R.push(Y);const Ie=je.fileType?"auto-saved":"manually saved/opened";console.log(`Auto save: Found PCB project file in root: ${Y} (${Ie}${Y===Z?" - this is the opened file":""})`)}}catch{continue}}catch{continue}for(const Y of R)try{const de=await(await(await n.getFileHandle(Y)).getFile()).text(),Ie=await(await G.getFileHandle(Y,{create:!0})).createWritable();await Ie.write(new Blob([de],{type:"application/json"})),await Ie.close(),await n.removeEntry(Y),console.log(`Auto save: Moved ${Y} from root to history/`)}catch(we){console.warn(`Auto save: Failed to move ${Y} to history:`,we)}}catch(R){console.warn("Auto save: Error checking for old files in root:",R)}const F=await(await n.getFileHandle(E,{create:!0})).createWritable();await F.write(J),await F.close(),console.log(`Auto save: Successfully saved ${E} to root directory`),b(E),p.current=E;const $=m.current,H=[E,...$.filter(R=>R!==E)].sort((R,Z)=>Z.localeCompare(R));v(H),m.current=H,C(0),D.current=0,o.current=!1,M(!1)}catch(G){console.error("Auto save failed:",G)}}async function Zd(n,r,o,s,l,d,b,p,v,m,C,D,M,S,U,_=!1){if(n===null){s(!1),l(null),m.current&&(clearInterval(m.current),m.current=null),D({visible:!1,interval:5}),_&&M({visible:!1,source:null,interval:5}),console.log("Auto save: Disabled");return}if(!r){console.warn("Auto save: No project name available. Please create a new project or open an existing project first.");return}let N=o;if(!N){const re=window;if(typeof re.showDirectoryPicker=="function")try{N=await re.showDirectoryPicker(),S(N)}catch(J){J?.name!=="AbortError"&&console.error("Failed to get directory:",J);return}else{console.warn("Directory picker is not supported in this browser. Auto-save requires a directory handle.");return}}d(N);const g=r.replace(/\.json$/i,""),V=vd(g).replace(/[^a-zA-Z0-9_-]/g,"_");b(V),p.current=N,v.current=V,m.current&&(clearInterval(m.current),m.current=null),l(n),s(!0),C.current=!0,D({visible:!1,interval:5}),_&&M({visible:!1,source:null,interval:5});const E=n*60*1e3;m.current=setInterval(()=>{U.current&&U.current()},E),setTimeout(()=>{console.log(`Auto save: Enabled with interval ${n} minutes`),U.current&&U.current()},200)}const lb="modulepreload",cb=function(n){return"/PCB_Reverse_Engineering_Tool/"+n},L1={},bg=function(r,o,s){let l=Promise.resolve();if(o&&o.length>0){let v=function(m){return Promise.all(m.map(C=>Promise.resolve(C).then(D=>({status:"fulfilled",value:D}),D=>({status:"rejected",reason:D}))))};document.getElementsByTagName("link");const b=document.querySelector("meta[property=csp-nonce]"),p=b?.nonce||b?.getAttribute("nonce");l=v(o.map(m=>{if(m=cb(m),m in L1)return;L1[m]=!0;const C=m.endsWith(".css"),D=C?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${D}`))return;const M=document.createElement("link");if(M.rel=C?"stylesheet":lb,C||(M.as="script"),M.crossOrigin="",M.href=m,p&&M.setAttribute("nonce",p),document.head.appendChild(M),C)return new Promise((S,U)=>{M.addEventListener("load",S),M.addEventListener("error",()=>U(new Error(`Unable to preload CSS for ${m}`)))})}))}function d(b){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=b,window.dispatchEvent(p),!p.defaultPrevented)throw b}return l.then(b=>{for(const p of b||[])p.status==="rejected"&&d(p.reason);return r().catch(d)})};function qr(n){"@babel/helpers - typeof";return qr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},qr(n)}var _c=Uint8Array,Gl=Uint16Array,l0=Int32Array,c0=new _c([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),u0=new _c([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),M1=new _c([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),dx=function(n,r){for(var o=new Gl(31),s=0;s<31;++s)o[s]=r+=1<<n[s-1];for(var l=new l0(o[30]),s=1;s<30;++s)for(var d=o[s];d<o[s+1];++d)l[d]=d-o[s]<<5|s;return{b:o,r:l}},fx=dx(c0,2),ub=fx.b,Gg=fx.r;ub[28]=258,Gg[258]=28;var db=dx(u0,0),B1=db.r,Xg=new Gl(32768);for(var Po=0;Po<32768;++Po){var qu=(Po&43690)>>1|(Po&21845)<<1;qu=(qu&52428)>>2|(qu&13107)<<2,qu=(qu&61680)>>4|(qu&3855)<<4,Xg[Po]=((qu&65280)>>8|(qu&255)<<8)>>1}var Qf=(function(n,r,o){for(var s=n.length,l=0,d=new Gl(r);l<s;++l)n[l]&&++d[n[l]-1];var b=new Gl(r);for(l=1;l<r;++l)b[l]=b[l-1]+d[l-1]<<1;var p;if(o){p=new Gl(1<<r);var v=15-r;for(l=0;l<s;++l)if(n[l])for(var m=l<<4|n[l],C=r-n[l],D=b[n[l]-1]++<<C,M=D|(1<<C)-1;D<=M;++D)p[Xg[D]>>v]=m}else for(p=new Gl(s),l=0;l<s;++l)n[l]&&(p[l]=Xg[b[n[l]-1]++]>>15-n[l]);return p}),Sd=new _c(288);for(var Po=0;Po<144;++Po)Sd[Po]=8;for(var Po=144;Po<256;++Po)Sd[Po]=9;for(var Po=256;Po<280;++Po)Sd[Po]=7;for(var Po=280;Po<288;++Po)Sd[Po]=8;var gh=new _c(32);for(var Po=0;Po<32;++Po)gh[Po]=5;var fb=Qf(Sd,9,0),pb=Qf(gh,5,0),px=function(n){return(n+7)/8|0},hb=function(n,r,o){return(o==null||o>n.length)&&(o=n.length),new _c(n.subarray(r,o))},gu=function(n,r,o){o<<=r&7;var s=r/8|0;n[s]|=o,n[s+1]|=o>>8},Xf=function(n,r,o){o<<=r&7;var s=r/8|0;n[s]|=o,n[s+1]|=o>>8,n[s+2]|=o>>16},vg=function(n,r){for(var o=[],s=0;s<n.length;++s)n[s]&&o.push({s,f:n[s]});var l=o.length,d=o.slice();if(!l)return{t:gx,l:0};if(l==1){var b=new _c(o[0].s+1);return b[o[0].s]=1,{t:b,l:1}}o.sort(function(re,J){return re.f-J.f}),o.push({s:-1,f:25001});var p=o[0],v=o[1],m=0,C=1,D=2;for(o[0]={s:-1,f:p.f+v.f,l:p,r:v};C!=l-1;)p=o[o[m].f<o[D].f?m++:D++],v=o[m!=C&&o[m].f<o[D].f?m++:D++],o[C++]={s:-1,f:p.f+v.f,l:p,r:v};for(var M=d[0].s,s=1;s<l;++s)d[s].s>M&&(M=d[s].s);var S=new Gl(M+1),U=Kg(o[C-1],S,0);if(U>r){var s=0,_=0,N=U-r,g=1<<N;for(d.sort(function(J,G){return S[G.s]-S[J.s]||J.f-G.f});s<l;++s){var ae=d[s].s;if(S[ae]>r)_+=g-(1<<U-S[ae]),S[ae]=r;else break}for(_>>=N;_>0;){var V=d[s].s;S[V]<r?_-=1<<r-S[V]++-1:++s}for(;s>=0&&_;--s){var E=d[s].s;S[E]==r&&(--S[E],++_)}U=r}return{t:new _c(S),l:U}},Kg=function(n,r,o){return n.s==-1?Math.max(Kg(n.l,r,o+1),Kg(n.r,r,o+1)):r[n.s]=o},O1=function(n){for(var r=n.length;r&&!n[--r];);for(var o=new Gl(++r),s=0,l=n[0],d=1,b=function(v){o[s++]=v},p=1;p<=r;++p)if(n[p]==l&&p!=r)++d;else{if(!l&&d>2){for(;d>138;d-=138)b(32754);d>2&&(b(d>10?d-11<<5|28690:d-3<<5|12305),d=0)}else if(d>3){for(b(l),--d;d>6;d-=6)b(8304);d>2&&(b(d-3<<5|8208),d=0)}for(;d--;)b(l);d=1,l=n[p]}return{c:o.subarray(0,s),n:r}},Kf=function(n,r){for(var o=0,s=0;s<r.length;++s)o+=n[s]*r[s];return o},hx=function(n,r,o){var s=o.length,l=px(r+2);n[l]=s&255,n[l+1]=s>>8,n[l+2]=n[l]^255,n[l+3]=n[l+1]^255;for(var d=0;d<s;++d)n[l+d+4]=o[d];return(l+4+s)*8},F1=function(n,r,o,s,l,d,b,p,v,m,C){gu(r,C++,o),++l[256];for(var D=vg(l,15),M=D.t,S=D.l,U=vg(d,15),_=U.t,N=U.l,g=O1(M),ae=g.c,V=g.n,E=O1(_),re=E.c,J=E.n,G=new Gl(19),ee=0;ee<ae.length;++ee)++G[ae[ee]&31];for(var ee=0;ee<re.length;++ee)++G[re[ee]&31];for(var F=vg(G,7),$=F.t,H=F.l,R=19;R>4&&!$[M1[R-1]];--R);var Z=m+5<<3,Y=Kf(l,Sd)+Kf(d,gh)+b,we=Kf(l,M)+Kf(d,_)+b+14+3*R+Kf(G,$)+2*G[16]+3*G[17]+7*G[18];if(v>=0&&Z<=Y&&Z<=we)return hx(r,C,n.subarray(v,v+m));var te,de,je,Ie;if(gu(r,C,1+(we<Y)),C+=2,we<Y){te=Qf(M,S,0),de=M,je=Qf(_,N,0),Ie=_;var xe=Qf($,H,0);gu(r,C,V-257),gu(r,C+5,J-1),gu(r,C+10,R-4),C+=14;for(var ee=0;ee<R;++ee)gu(r,C+3*ee,$[M1[ee]]);C+=3*R;for(var k=[ae,re],A=0;A<2;++A)for(var q=k[A],ee=0;ee<q.length;++ee){var W=q[ee]&31;gu(r,C,xe[W]),C+=$[W],W>15&&(gu(r,C,q[ee]>>5&127),C+=q[ee]>>12)}}else te=fb,de=Sd,je=pb,Ie=gh;for(var ee=0;ee<p;++ee){var se=s[ee];if(se>255){var W=se>>18&31;Xf(r,C,te[W+257]),C+=de[W+257],W>7&&(gu(r,C,se>>23&31),C+=c0[W]);var Ce=se&31;Xf(r,C,je[Ce]),C+=Ie[Ce],Ce>3&&(Xf(r,C,se>>5&8191),C+=u0[Ce])}else Xf(r,C,te[se]),C+=de[se]}return Xf(r,C,te[256]),C+de[256]},gb=new l0([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),gx=new _c(0),yb=function(n,r,o,s,l,d){var b=d.z||n.length,p=new _c(s+b+5*(1+Math.ceil(b/7e3))+l),v=p.subarray(s,p.length-l),m=d.l,C=(d.r||0)&7;if(r){C&&(v[0]=d.r>>3);for(var D=gb[r-1],M=D>>13,S=D&8191,U=(1<<o)-1,_=d.p||new Gl(32768),N=d.h||new Gl(U+1),g=Math.ceil(o/3),ae=2*g,V=function(Ht){return(n[Ht]^n[Ht+1]<<g^n[Ht+2]<<ae)&U},E=new l0(25e3),re=new Gl(288),J=new Gl(32),G=0,ee=0,F=d.i||0,$=0,H=d.w||0,R=0;F+2<b;++F){var Z=V(F),Y=F&32767,we=N[Z];if(_[Y]=we,N[Z]=Y,H<=F){var te=b-F;if((G>7e3||$>24576)&&(te>423||!m)){C=F1(n,v,0,E,re,J,ee,$,R,F-R,C),$=G=ee=0,R=F;for(var de=0;de<286;++de)re[de]=0;for(var de=0;de<30;++de)J[de]=0}var je=2,Ie=0,xe=S,k=Y-we&32767;if(te>2&&Z==V(F-k))for(var A=Math.min(M,te)-1,q=Math.min(32767,F),W=Math.min(258,te);k<=q&&--xe&&Y!=we;){if(n[F+je]==n[F+je-k]){for(var se=0;se<W&&n[F+se]==n[F+se-k];++se);if(se>je){if(je=se,Ie=k,se>A)break;for(var Ce=Math.min(k,se-2),le=0,de=0;de<Ce;++de){var _e=F-k+de&32767,be=_[_e],De=_e-be&32767;De>le&&(le=De,we=_e)}}}Y=we,we=_[Y],k+=Y-we&32767}if(Ie){E[$++]=268435456|Gg[je]<<18|B1[Ie];var Ge=Gg[je]&31,ot=B1[Ie]&31;ee+=c0[Ge]+u0[ot],++re[257+Ge],++J[ot],H=F+je,++G}else E[$++]=n[F],++re[n[F]]}}for(F=Math.max(F,H);F<b;++F)E[$++]=n[F],++re[n[F]];C=F1(n,v,m,E,re,J,ee,$,R,F-R,C),m||(d.r=C&7|v[C/8|0]<<3,C-=7,d.h=N,d.p=_,d.i=F,d.w=H)}else{for(var F=d.w||0;F<b+m;F+=65535){var jt=F+65535;jt>=b&&(v[C/8|0]=m,jt=b),C=hx(v,C+1,n.subarray(F,jt))}d.i=b}return hb(p,0,s+px(C)+l)},yx=function(){var n=1,r=0;return{p:function(o){for(var s=n,l=r,d=o.length|0,b=0;b!=d;){for(var p=Math.min(b+2655,d);b<p;++b)l+=s+=o[b];s=(s&65535)+15*(s>>16),l=(l&65535)+15*(l>>16)}n=s,r=l},d:function(){return n%=65521,r%=65521,(n&255)<<24|(n&65280)<<8|(r&255)<<8|r>>8}}},xb=function(n,r,o,s,l){if(!l&&(l={l:1},r.dictionary)){var d=r.dictionary.subarray(-32768),b=new _c(d.length+n.length);b.set(d),b.set(n,d.length),n=b,l.w=d.length}return yb(n,r.level==null?6:r.level,r.mem==null?l.l?Math.ceil(Math.max(8,Math.min(13,Math.log(n.length)))*1.5):20:12+r.mem,o,s,l)},xx=function(n,r,o){for(;o;++r)n[r]=o,o>>>=8},mb=function(n,r){var o=r.level,s=o==0?0:o<6?1:o==9?3:2;if(n[0]=120,n[1]=s<<6|(r.dictionary&&32),n[1]|=31-(n[0]<<8|n[1])%31,r.dictionary){var l=yx();l.p(r.dictionary),xx(n,2,l.d())}};function Zg(n,r){r||(r={});var o=yx();o.p(n);var s=xb(n,r,r.dictionary?6:2,4);return mb(s,r),xx(s,s.length-4,o.d()),s}var bb=typeof TextDecoder<"u"&&new TextDecoder,vb=0;try{bb.decode(gx,{stream:!0}),vb=1}catch{}function wb(n){if(Array.isArray(n))return n}function Sb(n,r){var o=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(o!=null){var s,l,d,b,p=[],v=!0,m=!1;try{if(d=(o=o.call(n)).next,r!==0)for(;!(v=(s=d.call(o)).done)&&(p.push(s.value),p.length!==r);v=!0);}catch(C){m=!0,l=C}finally{try{if(!v&&o.return!=null&&(b=o.return(),Object(b)!==b))return}finally{if(m)throw l}}return p}}function U1(n,r){(r==null||r>n.length)&&(r=n.length);for(var o=0,s=Array(r);o<r;o++)s[o]=n[o];return s}function Tb(n,r){if(n){if(typeof n=="string")return U1(n,r);var o={}.toString.call(n).slice(8,-1);return o==="Object"&&n.constructor&&(o=n.constructor.name),o==="Map"||o==="Set"?Array.from(n):o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?U1(n,r):void 0}}function Cb(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E1(n,r){return wb(n)||Sb(n,r)||Tb(n,r)||Cb()}function V1(n,r="utf8"){return new TextDecoder(r).decode(n)}const jb=new TextEncoder;function Nb(n){return jb.encode(n)}const kb=1024*8,Ab=(()=>{const n=new Uint8Array(4),r=new Uint32Array(n.buffer);return!((r[0]=1)&n[0])})(),wg={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class d0{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(r=kb,o={}){let s=!1;typeof r=="number"?r=new ArrayBuffer(r):(s=!0,this.lastWrittenByte=r.byteLength);const l=o.offset?o.offset>>>0:0,d=r.byteLength-l;let b=l;(ArrayBuffer.isView(r)||r instanceof d0)&&(r.byteLength!==r.buffer.byteLength&&(b=r.byteOffset+l),r=r.buffer),s?this.lastWrittenByte=d:this.lastWrittenByte=0,this.buffer=r,this.length=d,this.byteLength=d,this.byteOffset=b,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,b,d),this._mark=0,this._marks=[]}available(r=1){return this.offset+r<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(r=1){return this.offset+=r,this}back(r=1){return this.offset-=r,this}seek(r){return this.offset=r,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const r=this._marks.pop();if(r===void 0)throw new Error("Mark stack empty");return this.seek(r),this}rewind(){return this.offset=0,this}ensureAvailable(r=1){if(!this.available(r)){const s=(this.offset+r)*2,l=new Uint8Array(s);l.set(new Uint8Array(this.buffer)),this.buffer=l.buffer,this.length=s,this.byteLength=s,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(r=1){return this.readArray(r,"uint8")}readArray(r,o){const s=wg[o].BYTES_PER_ELEMENT*r,l=this.byteOffset+this.offset,d=this.buffer.slice(l,l+s);if(this.littleEndian===Ab&&o!=="uint8"&&o!=="int8"){const p=new Uint8Array(this.buffer.slice(l,l+s));p.reverse();const v=new wg[o](p.buffer);return this.offset+=s,v.reverse(),v}const b=new wg[o](d);return this.offset+=s,b}readInt16(){const r=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,r}readUint16(){const r=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,r}readInt32(){const r=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,r}readUint32(){const r=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,r}readFloat32(){const r=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,r}readFloat64(){const r=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,r}readBigInt64(){const r=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,r}readBigUint64(){const r=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,r}readChar(){return String.fromCharCode(this.readInt8())}readChars(r=1){let o="";for(let s=0;s<r;s++)o+=this.readChar();return o}readUtf8(r=1){return V1(this.readBytes(r))}decodeText(r=1,o="utf8"){return V1(this.readBytes(r),o)}writeBoolean(r){return this.writeUint8(r?255:0),this}writeInt8(r){return this.ensureAvailable(1),this._data.setInt8(this.offset++,r),this._updateLastWrittenByte(),this}writeUint8(r){return this.ensureAvailable(1),this._data.setUint8(this.offset++,r),this._updateLastWrittenByte(),this}writeByte(r){return this.writeUint8(r)}writeBytes(r){this.ensureAvailable(r.length);for(let o=0;o<r.length;o++)this._data.setUint8(this.offset++,r[o]);return this._updateLastWrittenByte(),this}writeInt16(r){return this.ensureAvailable(2),this._data.setInt16(this.offset,r,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(r){return this.ensureAvailable(2),this._data.setUint16(this.offset,r,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(r){return this.ensureAvailable(4),this._data.setInt32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(r){return this.ensureAvailable(4),this._data.setUint32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(r){return this.ensureAvailable(4),this._data.setFloat32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(r){return this.ensureAvailable(8),this._data.setFloat64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(r){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(r){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(r){return this.writeUint8(r.charCodeAt(0))}writeChars(r){for(let o=0;o<r.length;o++)this.writeUint8(r.charCodeAt(o));return this}writeUtf8(r){return this.writeBytes(Nb(r))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function df(n){let r=n.length;for(;--r>=0;)n[r]=0}const Pb=3,zb=258,mx=29,_b=256,Db=_b+1+mx,bx=30,Rb=512,Ib=new Array((Db+2)*2);df(Ib);const Lb=new Array(bx*2);df(Lb);const Mb=new Array(Rb);df(Mb);const Bb=new Array(zb-Pb+1);df(Bb);const Ob=new Array(mx);df(Ob);const Fb=new Array(bx);df(Fb);const Ub=(n,r,o,s)=>{let l=n&65535|0,d=n>>>16&65535|0,b=0;for(;o!==0;){b=o>2e3?2e3:o,o-=b;do l=l+r[s++]|0,d=d+l|0;while(--b);l%=65521,d%=65521}return l|d<<16|0};var Jg=Ub;const Eb=()=>{let n,r=[];for(var o=0;o<256;o++){n=o;for(var s=0;s<8;s++)n=n&1?3988292384^n>>>1:n>>>1;r[o]=n}return r},Vb=new Uint32Array(Eb()),qb=(n,r,o,s)=>{const l=Vb,d=s+o;n^=-1;for(let b=s;b<d;b++)n=n>>>8^l[(n^r[b])&255];return n^-1};var Gc=qb,Qg={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},vx={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const Hb=(n,r)=>Object.prototype.hasOwnProperty.call(n,r);var Wb=function(n){const r=Array.prototype.slice.call(arguments,1);for(;r.length;){const o=r.shift();if(o){if(typeof o!="object")throw new TypeError(o+"must be non-object");for(const s in o)Hb(o,s)&&(n[s]=o[s])}}return n},$b=n=>{let r=0;for(let s=0,l=n.length;s<l;s++)r+=n[s].length;const o=new Uint8Array(r);for(let s=0,l=0,d=n.length;s<d;s++){let b=n[s];o.set(b,l),l+=b.length}return o},wx={assign:Wb,flattenChunks:$b};let Sx=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Sx=!1}const tp=new Uint8Array(256);for(let n=0;n<256;n++)tp[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;tp[254]=tp[254]=1;var Yb=n=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(n);let r,o,s,l,d,b=n.length,p=0;for(l=0;l<b;l++)o=n.charCodeAt(l),(o&64512)===55296&&l+1<b&&(s=n.charCodeAt(l+1),(s&64512)===56320&&(o=65536+(o-55296<<10)+(s-56320),l++)),p+=o<128?1:o<2048?2:o<65536?3:4;for(r=new Uint8Array(p),d=0,l=0;d<p;l++)o=n.charCodeAt(l),(o&64512)===55296&&l+1<b&&(s=n.charCodeAt(l+1),(s&64512)===56320&&(o=65536+(o-55296<<10)+(s-56320),l++)),o<128?r[d++]=o:o<2048?(r[d++]=192|o>>>6,r[d++]=128|o&63):o<65536?(r[d++]=224|o>>>12,r[d++]=128|o>>>6&63,r[d++]=128|o&63):(r[d++]=240|o>>>18,r[d++]=128|o>>>12&63,r[d++]=128|o>>>6&63,r[d++]=128|o&63);return r};const Gb=(n,r)=>{if(r<65534&&n.subarray&&Sx)return String.fromCharCode.apply(null,n.length===r?n:n.subarray(0,r));let o="";for(let s=0;s<r;s++)o+=String.fromCharCode(n[s]);return o};var Xb=(n,r)=>{const o=r||n.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(n.subarray(0,r));let s,l;const d=new Array(o*2);for(l=0,s=0;s<o;){let b=n[s++];if(b<128){d[l++]=b;continue}let p=tp[b];if(p>4){d[l++]=65533,s+=p-1;continue}for(b&=p===2?31:p===3?15:7;p>1&&s<o;)b=b<<6|n[s++]&63,p--;if(p>1){d[l++]=65533;continue}b<65536?d[l++]=b:(b-=65536,d[l++]=55296|b>>10&1023,d[l++]=56320|b&1023)}return Gb(d,l)},Kb=(n,r)=>{r=r||n.length,r>n.length&&(r=n.length);let o=r-1;for(;o>=0&&(n[o]&192)===128;)o--;return o<0||o===0?r:o+tp[n[o]]>r?o:r},e0={string2buf:Yb,buf2string:Xb,utf8border:Kb};function Zb(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Jb=Zb;const Qp=16209,Qb=16191;var ev=function(r,o){let s,l,d,b,p,v,m,C,D,M,S,U,_,N,g,ae,V,E,re,J,G,ee,F,$;const H=r.state;s=r.next_in,F=r.input,l=s+(r.avail_in-5),d=r.next_out,$=r.output,b=d-(o-r.avail_out),p=d+(r.avail_out-257),v=H.dmax,m=H.wsize,C=H.whave,D=H.wnext,M=H.window,S=H.hold,U=H.bits,_=H.lencode,N=H.distcode,g=(1<<H.lenbits)-1,ae=(1<<H.distbits)-1;e:do{U<15&&(S+=F[s++]<<U,U+=8,S+=F[s++]<<U,U+=8),V=_[S&g];t:for(;;){if(E=V>>>24,S>>>=E,U-=E,E=V>>>16&255,E===0)$[d++]=V&65535;else if(E&16){re=V&65535,E&=15,E&&(U<E&&(S+=F[s++]<<U,U+=8),re+=S&(1<<E)-1,S>>>=E,U-=E),U<15&&(S+=F[s++]<<U,U+=8,S+=F[s++]<<U,U+=8),V=N[S&ae];n:for(;;){if(E=V>>>24,S>>>=E,U-=E,E=V>>>16&255,E&16){if(J=V&65535,E&=15,U<E&&(S+=F[s++]<<U,U+=8,U<E&&(S+=F[s++]<<U,U+=8)),J+=S&(1<<E)-1,J>v){r.msg="invalid distance too far back",H.mode=Qp;break e}if(S>>>=E,U-=E,E=d-b,J>E){if(E=J-E,E>C&&H.sane){r.msg="invalid distance too far back",H.mode=Qp;break e}if(G=0,ee=M,D===0){if(G+=m-E,E<re){re-=E;do $[d++]=M[G++];while(--E);G=d-J,ee=$}}else if(D<E){if(G+=m+D-E,E-=D,E<re){re-=E;do $[d++]=M[G++];while(--E);if(G=0,D<re){E=D,re-=E;do $[d++]=M[G++];while(--E);G=d-J,ee=$}}}else if(G+=D-E,E<re){re-=E;do $[d++]=M[G++];while(--E);G=d-J,ee=$}for(;re>2;)$[d++]=ee[G++],$[d++]=ee[G++],$[d++]=ee[G++],re-=3;re&&($[d++]=ee[G++],re>1&&($[d++]=ee[G++]))}else{G=d-J;do $[d++]=$[G++],$[d++]=$[G++],$[d++]=$[G++],re-=3;while(re>2);re&&($[d++]=$[G++],re>1&&($[d++]=$[G++]))}}else if((E&64)===0){V=N[(V&65535)+(S&(1<<E)-1)];continue n}else{r.msg="invalid distance code",H.mode=Qp;break e}break}}else if((E&64)===0){V=_[(V&65535)+(S&(1<<E)-1)];continue t}else if(E&32){H.mode=Qb;break e}else{r.msg="invalid literal/length code",H.mode=Qp;break e}break}}while(s<l&&d<p);re=U>>3,s-=re,U-=re<<3,S&=(1<<U)-1,r.next_in=s,r.next_out=d,r.avail_in=s<l?5+(l-s):5-(s-l),r.avail_out=d<p?257+(p-d):257-(d-p),H.hold=S,H.bits=U};const Jd=15,q1=852,H1=592,W1=0,Sg=1,$1=2,tv=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),nv=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),iv=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),rv=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),ov=(n,r,o,s,l,d,b,p)=>{const v=p.bits;let m=0,C=0,D=0,M=0,S=0,U=0,_=0,N=0,g=0,ae=0,V,E,re,J,G,ee=null,F;const $=new Uint16Array(Jd+1),H=new Uint16Array(Jd+1);let R=null,Z,Y,we;for(m=0;m<=Jd;m++)$[m]=0;for(C=0;C<s;C++)$[r[o+C]]++;for(S=v,M=Jd;M>=1&&$[M]===0;M--);if(S>M&&(S=M),M===0)return l[d++]=1<<24|64<<16|0,l[d++]=1<<24|64<<16|0,p.bits=1,0;for(D=1;D<M&&$[D]===0;D++);for(S<D&&(S=D),N=1,m=1;m<=Jd;m++)if(N<<=1,N-=$[m],N<0)return-1;if(N>0&&(n===W1||M!==1))return-1;for(H[1]=0,m=1;m<Jd;m++)H[m+1]=H[m]+$[m];for(C=0;C<s;C++)r[o+C]!==0&&(b[H[r[o+C]]++]=C);if(n===W1?(ee=R=b,F=20):n===Sg?(ee=tv,R=nv,F=257):(ee=iv,R=rv,F=0),ae=0,C=0,m=D,G=d,U=S,_=0,re=-1,g=1<<S,J=g-1,n===Sg&&g>q1||n===$1&&g>H1)return 1;for(;;){Z=m-_,b[C]+1<F?(Y=0,we=b[C]):b[C]>=F?(Y=R[b[C]-F],we=ee[b[C]-F]):(Y=96,we=0),V=1<<m-_,E=1<<U,D=E;do E-=V,l[G+(ae>>_)+E]=Z<<24|Y<<16|we|0;while(E!==0);for(V=1<<m-1;ae&V;)V>>=1;if(V!==0?(ae&=V-1,ae+=V):ae=0,C++,--$[m]===0){if(m===M)break;m=r[o+b[C]]}if(m>S&&(ae&J)!==re){for(_===0&&(_=S),G+=D,U=m-_,N=1<<U;U+_<M&&(N-=$[U+_],!(N<=0));)U++,N<<=1;if(g+=1<<U,n===Sg&&g>q1||n===$1&&g>H1)return 1;re=ae&J,l[re]=S<<24|U<<16|G-d|0}}return ae!==0&&(l[G+ae]=m-_<<24|64<<16|0),p.bits=S,0};var ep=ov;const av=0,Tx=1,Cx=2,{Z_FINISH:Y1,Z_BLOCK:sv,Z_TREES:eh,Z_OK:Td,Z_STREAM_END:lv,Z_NEED_DICT:cv,Z_STREAM_ERROR:mc,Z_DATA_ERROR:jx,Z_MEM_ERROR:Nx,Z_BUF_ERROR:uv,Z_DEFLATED:G1}=vx,jh=16180,X1=16181,K1=16182,Z1=16183,J1=16184,Q1=16185,ey=16186,ty=16187,ny=16188,iy=16189,yh=16190,yu=16191,Tg=16192,ry=16193,Cg=16194,oy=16195,ay=16196,sy=16197,ly=16198,th=16199,nh=16200,cy=16201,uy=16202,dy=16203,fy=16204,py=16205,jg=16206,hy=16207,gy=16208,qo=16209,kx=16210,Ax=16211,dv=852,fv=592,pv=15,hv=pv,yy=n=>(n>>>24&255)+(n>>>8&65280)+((n&65280)<<8)+((n&255)<<24);function gv(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Cd=n=>{if(!n)return 1;const r=n.state;return!r||r.strm!==n||r.mode<jh||r.mode>Ax?1:0},Px=n=>{if(Cd(n))return mc;const r=n.state;return n.total_in=n.total_out=r.total=0,n.msg="",r.wrap&&(n.adler=r.wrap&1),r.mode=jh,r.last=0,r.havedict=0,r.flags=-1,r.dmax=32768,r.head=null,r.hold=0,r.bits=0,r.lencode=r.lendyn=new Int32Array(dv),r.distcode=r.distdyn=new Int32Array(fv),r.sane=1,r.back=-1,Td},zx=n=>{if(Cd(n))return mc;const r=n.state;return r.wsize=0,r.whave=0,r.wnext=0,Px(n)},_x=(n,r)=>{let o;if(Cd(n))return mc;const s=n.state;return r<0?(o=0,r=-r):(o=(r>>4)+5,r<48&&(r&=15)),r&&(r<8||r>15)?mc:(s.window!==null&&s.wbits!==r&&(s.window=null),s.wrap=o,s.wbits=r,zx(n))},Dx=(n,r)=>{if(!n)return mc;const o=new gv;n.state=o,o.strm=n,o.window=null,o.mode=jh;const s=_x(n,r);return s!==Td&&(n.state=null),s},yv=n=>Dx(n,hv);let xy=!0,Ng,kg;const xv=n=>{if(xy){Ng=new Int32Array(512),kg=new Int32Array(32);let r=0;for(;r<144;)n.lens[r++]=8;for(;r<256;)n.lens[r++]=9;for(;r<280;)n.lens[r++]=7;for(;r<288;)n.lens[r++]=8;for(ep(Tx,n.lens,0,288,Ng,0,n.work,{bits:9}),r=0;r<32;)n.lens[r++]=5;ep(Cx,n.lens,0,32,kg,0,n.work,{bits:5}),xy=!1}n.lencode=Ng,n.lenbits=9,n.distcode=kg,n.distbits=5},Rx=(n,r,o,s)=>{let l;const d=n.state;return d.window===null&&(d.wsize=1<<d.wbits,d.wnext=0,d.whave=0,d.window=new Uint8Array(d.wsize)),s>=d.wsize?(d.window.set(r.subarray(o-d.wsize,o),0),d.wnext=0,d.whave=d.wsize):(l=d.wsize-d.wnext,l>s&&(l=s),d.window.set(r.subarray(o-s,o-s+l),d.wnext),s-=l,s?(d.window.set(r.subarray(o-s,o),0),d.wnext=s,d.whave=d.wsize):(d.wnext+=l,d.wnext===d.wsize&&(d.wnext=0),d.whave<d.wsize&&(d.whave+=l))),0},mv=(n,r)=>{let o,s,l,d,b,p,v,m,C,D,M,S,U,_,N=0,g,ae,V,E,re,J,G,ee;const F=new Uint8Array(4);let $,H;const R=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Cd(n)||!n.output||!n.input&&n.avail_in!==0)return mc;o=n.state,o.mode===yu&&(o.mode=Tg),b=n.next_out,l=n.output,v=n.avail_out,d=n.next_in,s=n.input,p=n.avail_in,m=o.hold,C=o.bits,D=p,M=v,ee=Td;e:for(;;)switch(o.mode){case jh:if(o.wrap===0){o.mode=Tg;break}for(;C<16;){if(p===0)break e;p--,m+=s[d++]<<C,C+=8}if(o.wrap&2&&m===35615){o.wbits===0&&(o.wbits=15),o.check=0,F[0]=m&255,F[1]=m>>>8&255,o.check=Gc(o.check,F,2,0),m=0,C=0,o.mode=X1;break}if(o.head&&(o.head.done=!1),!(o.wrap&1)||(((m&255)<<8)+(m>>8))%31){n.msg="incorrect header check",o.mode=qo;break}if((m&15)!==G1){n.msg="unknown compression method",o.mode=qo;break}if(m>>>=4,C-=4,G=(m&15)+8,o.wbits===0&&(o.wbits=G),G>15||G>o.wbits){n.msg="invalid window size",o.mode=qo;break}o.dmax=1<<o.wbits,o.flags=0,n.adler=o.check=1,o.mode=m&512?iy:yu,m=0,C=0;break;case X1:for(;C<16;){if(p===0)break e;p--,m+=s[d++]<<C,C+=8}if(o.flags=m,(o.flags&255)!==G1){n.msg="unknown compression method",o.mode=qo;break}if(o.flags&57344){n.msg="unknown header flags set",o.mode=qo;break}o.head&&(o.head.text=m>>8&1),o.flags&512&&o.wrap&4&&(F[0]=m&255,F[1]=m>>>8&255,o.check=Gc(o.check,F,2,0)),m=0,C=0,o.mode=K1;case K1:for(;C<32;){if(p===0)break e;p--,m+=s[d++]<<C,C+=8}o.head&&(o.head.time=m),o.flags&512&&o.wrap&4&&(F[0]=m&255,F[1]=m>>>8&255,F[2]=m>>>16&255,F[3]=m>>>24&255,o.check=Gc(o.check,F,4,0)),m=0,C=0,o.mode=Z1;case Z1:for(;C<16;){if(p===0)break e;p--,m+=s[d++]<<C,C+=8}o.head&&(o.head.xflags=m&255,o.head.os=m>>8),o.flags&512&&o.wrap&4&&(F[0]=m&255,F[1]=m>>>8&255,o.check=Gc(o.check,F,2,0)),m=0,C=0,o.mode=J1;case J1:if(o.flags&1024){for(;C<16;){if(p===0)break e;p--,m+=s[d++]<<C,C+=8}o.length=m,o.head&&(o.head.extra_len=m),o.flags&512&&o.wrap&4&&(F[0]=m&255,F[1]=m>>>8&255,o.check=Gc(o.check,F,2,0)),m=0,C=0}else o.head&&(o.head.extra=null);o.mode=Q1;case Q1:if(o.flags&1024&&(S=o.length,S>p&&(S=p),S&&(o.head&&(G=o.head.extra_len-o.length,o.head.extra||(o.head.extra=new Uint8Array(o.head.extra_len)),o.head.extra.set(s.subarray(d,d+S),G)),o.flags&512&&o.wrap&4&&(o.check=Gc(o.check,s,S,d)),p-=S,d+=S,o.length-=S),o.length))break e;o.length=0,o.mode=ey;case ey:if(o.flags&2048){if(p===0)break e;S=0;do G=s[d+S++],o.head&&G&&o.length<65536&&(o.head.name+=String.fromCharCode(G));while(G&&S<p);if(o.flags&512&&o.wrap&4&&(o.check=Gc(o.check,s,S,d)),p-=S,d+=S,G)break e}else o.head&&(o.head.name=null);o.length=0,o.mode=ty;case ty:if(o.flags&4096){if(p===0)break e;S=0;do G=s[d+S++],o.head&&G&&o.length<65536&&(o.head.comment+=String.fromCharCode(G));while(G&&S<p);if(o.flags&512&&o.wrap&4&&(o.check=Gc(o.check,s,S,d)),p-=S,d+=S,G)break e}else o.head&&(o.head.comment=null);o.mode=ny;case ny:if(o.flags&512){for(;C<16;){if(p===0)break e;p--,m+=s[d++]<<C,C+=8}if(o.wrap&4&&m!==(o.check&65535)){n.msg="header crc mismatch",o.mode=qo;break}m=0,C=0}o.head&&(o.head.hcrc=o.flags>>9&1,o.head.done=!0),n.adler=o.check=0,o.mode=yu;break;case iy:for(;C<32;){if(p===0)break e;p--,m+=s[d++]<<C,C+=8}n.adler=o.check=yy(m),m=0,C=0,o.mode=yh;case yh:if(o.havedict===0)return n.next_out=b,n.avail_out=v,n.next_in=d,n.avail_in=p,o.hold=m,o.bits=C,cv;n.adler=o.check=1,o.mode=yu;case yu:if(r===sv||r===eh)break e;case Tg:if(o.last){m>>>=C&7,C-=C&7,o.mode=jg;break}for(;C<3;){if(p===0)break e;p--,m+=s[d++]<<C,C+=8}switch(o.last=m&1,m>>>=1,C-=1,m&3){case 0:o.mode=ry;break;case 1:if(xv(o),o.mode=th,r===eh){m>>>=2,C-=2;break e}break;case 2:o.mode=ay;break;case 3:n.msg="invalid block type",o.mode=qo}m>>>=2,C-=2;break;case ry:for(m>>>=C&7,C-=C&7;C<32;){if(p===0)break e;p--,m+=s[d++]<<C,C+=8}if((m&65535)!==(m>>>16^65535)){n.msg="invalid stored block lengths",o.mode=qo;break}if(o.length=m&65535,m=0,C=0,o.mode=Cg,r===eh)break e;case Cg:o.mode=oy;case oy:if(S=o.length,S){if(S>p&&(S=p),S>v&&(S=v),S===0)break e;l.set(s.subarray(d,d+S),b),p-=S,d+=S,v-=S,b+=S,o.length-=S;break}o.mode=yu;break;case ay:for(;C<14;){if(p===0)break e;p--,m+=s[d++]<<C,C+=8}if(o.nlen=(m&31)+257,m>>>=5,C-=5,o.ndist=(m&31)+1,m>>>=5,C-=5,o.ncode=(m&15)+4,m>>>=4,C-=4,o.nlen>286||o.ndist>30){n.msg="too many length or distance symbols",o.mode=qo;break}o.have=0,o.mode=sy;case sy:for(;o.have<o.ncode;){for(;C<3;){if(p===0)break e;p--,m+=s[d++]<<C,C+=8}o.lens[R[o.have++]]=m&7,m>>>=3,C-=3}for(;o.have<19;)o.lens[R[o.have++]]=0;if(o.lencode=o.lendyn,o.lenbits=7,$={bits:o.lenbits},ee=ep(av,o.lens,0,19,o.lencode,0,o.work,$),o.lenbits=$.bits,ee){n.msg="invalid code lengths set",o.mode=qo;break}o.have=0,o.mode=ly;case ly:for(;o.have<o.nlen+o.ndist;){for(;N=o.lencode[m&(1<<o.lenbits)-1],g=N>>>24,ae=N>>>16&255,V=N&65535,!(g<=C);){if(p===0)break e;p--,m+=s[d++]<<C,C+=8}if(V<16)m>>>=g,C-=g,o.lens[o.have++]=V;else{if(V===16){for(H=g+2;C<H;){if(p===0)break e;p--,m+=s[d++]<<C,C+=8}if(m>>>=g,C-=g,o.have===0){n.msg="invalid bit length repeat",o.mode=qo;break}G=o.lens[o.have-1],S=3+(m&3),m>>>=2,C-=2}else if(V===17){for(H=g+3;C<H;){if(p===0)break e;p--,m+=s[d++]<<C,C+=8}m>>>=g,C-=g,G=0,S=3+(m&7),m>>>=3,C-=3}else{for(H=g+7;C<H;){if(p===0)break e;p--,m+=s[d++]<<C,C+=8}m>>>=g,C-=g,G=0,S=11+(m&127),m>>>=7,C-=7}if(o.have+S>o.nlen+o.ndist){n.msg="invalid bit length repeat",o.mode=qo;break}for(;S--;)o.lens[o.have++]=G}}if(o.mode===qo)break;if(o.lens[256]===0){n.msg="invalid code -- missing end-of-block",o.mode=qo;break}if(o.lenbits=9,$={bits:o.lenbits},ee=ep(Tx,o.lens,0,o.nlen,o.lencode,0,o.work,$),o.lenbits=$.bits,ee){n.msg="invalid literal/lengths set",o.mode=qo;break}if(o.distbits=6,o.distcode=o.distdyn,$={bits:o.distbits},ee=ep(Cx,o.lens,o.nlen,o.ndist,o.distcode,0,o.work,$),o.distbits=$.bits,ee){n.msg="invalid distances set",o.mode=qo;break}if(o.mode=th,r===eh)break e;case th:o.mode=nh;case nh:if(p>=6&&v>=258){n.next_out=b,n.avail_out=v,n.next_in=d,n.avail_in=p,o.hold=m,o.bits=C,ev(n,M),b=n.next_out,l=n.output,v=n.avail_out,d=n.next_in,s=n.input,p=n.avail_in,m=o.hold,C=o.bits,o.mode===yu&&(o.back=-1);break}for(o.back=0;N=o.lencode[m&(1<<o.lenbits)-1],g=N>>>24,ae=N>>>16&255,V=N&65535,!(g<=C);){if(p===0)break e;p--,m+=s[d++]<<C,C+=8}if(ae&&(ae&240)===0){for(E=g,re=ae,J=V;N=o.lencode[J+((m&(1<<E+re)-1)>>E)],g=N>>>24,ae=N>>>16&255,V=N&65535,!(E+g<=C);){if(p===0)break e;p--,m+=s[d++]<<C,C+=8}m>>>=E,C-=E,o.back+=E}if(m>>>=g,C-=g,o.back+=g,o.length=V,ae===0){o.mode=py;break}if(ae&32){o.back=-1,o.mode=yu;break}if(ae&64){n.msg="invalid literal/length code",o.mode=qo;break}o.extra=ae&15,o.mode=cy;case cy:if(o.extra){for(H=o.extra;C<H;){if(p===0)break e;p--,m+=s[d++]<<C,C+=8}o.length+=m&(1<<o.extra)-1,m>>>=o.extra,C-=o.extra,o.back+=o.extra}o.was=o.length,o.mode=uy;case uy:for(;N=o.distcode[m&(1<<o.distbits)-1],g=N>>>24,ae=N>>>16&255,V=N&65535,!(g<=C);){if(p===0)break e;p--,m+=s[d++]<<C,C+=8}if((ae&240)===0){for(E=g,re=ae,J=V;N=o.distcode[J+((m&(1<<E+re)-1)>>E)],g=N>>>24,ae=N>>>16&255,V=N&65535,!(E+g<=C);){if(p===0)break e;p--,m+=s[d++]<<C,C+=8}m>>>=E,C-=E,o.back+=E}if(m>>>=g,C-=g,o.back+=g,ae&64){n.msg="invalid distance code",o.mode=qo;break}o.offset=V,o.extra=ae&15,o.mode=dy;case dy:if(o.extra){for(H=o.extra;C<H;){if(p===0)break e;p--,m+=s[d++]<<C,C+=8}o.offset+=m&(1<<o.extra)-1,m>>>=o.extra,C-=o.extra,o.back+=o.extra}if(o.offset>o.dmax){n.msg="invalid distance too far back",o.mode=qo;break}o.mode=fy;case fy:if(v===0)break e;if(S=M-v,o.offset>S){if(S=o.offset-S,S>o.whave&&o.sane){n.msg="invalid distance too far back",o.mode=qo;break}S>o.wnext?(S-=o.wnext,U=o.wsize-S):U=o.wnext-S,S>o.length&&(S=o.length),_=o.window}else _=l,U=b-o.offset,S=o.length;S>v&&(S=v),v-=S,o.length-=S;do l[b++]=_[U++];while(--S);o.length===0&&(o.mode=nh);break;case py:if(v===0)break e;l[b++]=o.length,v--,o.mode=nh;break;case jg:if(o.wrap){for(;C<32;){if(p===0)break e;p--,m|=s[d++]<<C,C+=8}if(M-=v,n.total_out+=M,o.total+=M,o.wrap&4&&M&&(n.adler=o.check=o.flags?Gc(o.check,l,M,b-M):Jg(o.check,l,M,b-M)),M=v,o.wrap&4&&(o.flags?m:yy(m))!==o.check){n.msg="incorrect data check",o.mode=qo;break}m=0,C=0}o.mode=hy;case hy:if(o.wrap&&o.flags){for(;C<32;){if(p===0)break e;p--,m+=s[d++]<<C,C+=8}if(o.wrap&4&&m!==(o.total&4294967295)){n.msg="incorrect length check",o.mode=qo;break}m=0,C=0}o.mode=gy;case gy:ee=lv;break e;case qo:ee=jx;break e;case kx:return Nx;case Ax:default:return mc}return n.next_out=b,n.avail_out=v,n.next_in=d,n.avail_in=p,o.hold=m,o.bits=C,(o.wsize||M!==n.avail_out&&o.mode<qo&&(o.mode<jg||r!==Y1))&&Rx(n,n.output,n.next_out,M-n.avail_out),D-=n.avail_in,M-=n.avail_out,n.total_in+=D,n.total_out+=M,o.total+=M,o.wrap&4&&M&&(n.adler=o.check=o.flags?Gc(o.check,l,M,n.next_out-M):Jg(o.check,l,M,n.next_out-M)),n.data_type=o.bits+(o.last?64:0)+(o.mode===yu?128:0)+(o.mode===th||o.mode===Cg?256:0),(D===0&&M===0||r===Y1)&&ee===Td&&(ee=uv),ee},bv=n=>{if(Cd(n))return mc;let r=n.state;return r.window&&(r.window=null),n.state=null,Td},vv=(n,r)=>{if(Cd(n))return mc;const o=n.state;return(o.wrap&2)===0?mc:(o.head=r,r.done=!1,Td)},wv=(n,r)=>{const o=r.length;let s,l,d;return Cd(n)||(s=n.state,s.wrap!==0&&s.mode!==yh)?mc:s.mode===yh&&(l=1,l=Jg(l,r,o,0),l!==s.check)?jx:(d=Rx(n,r,o,o),d?(s.mode=kx,Nx):(s.havedict=1,Td))};var Sv=zx,Tv=_x,Cv=Px,jv=yv,Nv=Dx,kv=mv,Av=bv,Pv=vv,zv=wv,_v="pako inflate (from Nodeca project)",xu={inflateReset:Sv,inflateReset2:Tv,inflateResetKeep:Cv,inflateInit:jv,inflateInit2:Nv,inflate:kv,inflateEnd:Av,inflateGetHeader:Pv,inflateSetDictionary:zv,inflateInfo:_v};function Dv(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Rv=Dv;const Ix=Object.prototype.toString,{Z_NO_FLUSH:Iv,Z_FINISH:Lv,Z_OK:np,Z_STREAM_END:Ag,Z_NEED_DICT:Pg,Z_STREAM_ERROR:Mv,Z_DATA_ERROR:my,Z_MEM_ERROR:Bv}=vx;function rp(n){this.options=wx.assign({chunkSize:1024*64,windowBits:15,to:""},n||{});const r=this.options;r.raw&&r.windowBits>=0&&r.windowBits<16&&(r.windowBits=-r.windowBits,r.windowBits===0&&(r.windowBits=-15)),r.windowBits>=0&&r.windowBits<16&&!(n&&n.windowBits)&&(r.windowBits+=32),r.windowBits>15&&r.windowBits<48&&(r.windowBits&15)===0&&(r.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Jb,this.strm.avail_out=0;let o=xu.inflateInit2(this.strm,r.windowBits);if(o!==np)throw new Error(Qg[o]);if(this.header=new Rv,xu.inflateGetHeader(this.strm,this.header),r.dictionary&&(typeof r.dictionary=="string"?r.dictionary=e0.string2buf(r.dictionary):Ix.call(r.dictionary)==="[object ArrayBuffer]"&&(r.dictionary=new Uint8Array(r.dictionary)),r.raw&&(o=xu.inflateSetDictionary(this.strm,r.dictionary),o!==np)))throw new Error(Qg[o])}rp.prototype.push=function(n,r){const o=this.strm,s=this.options.chunkSize,l=this.options.dictionary;let d,b,p;if(this.ended)return!1;for(r===~~r?b=r:b=r===!0?Lv:Iv,Ix.call(n)==="[object ArrayBuffer]"?o.input=new Uint8Array(n):o.input=n,o.next_in=0,o.avail_in=o.input.length;;){for(o.avail_out===0&&(o.output=new Uint8Array(s),o.next_out=0,o.avail_out=s),d=xu.inflate(o,b),d===Pg&&l&&(d=xu.inflateSetDictionary(o,l),d===np?d=xu.inflate(o,b):d===my&&(d=Pg));o.avail_in>0&&d===Ag&&o.state.wrap>0&&n[o.next_in]!==0;)xu.inflateReset(o),d=xu.inflate(o,b);switch(d){case Mv:case my:case Pg:case Bv:return this.onEnd(d),this.ended=!0,!1}if(p=o.avail_out,o.next_out&&(o.avail_out===0||d===Ag))if(this.options.to==="string"){let v=e0.utf8border(o.output,o.next_out),m=o.next_out-v,C=e0.buf2string(o.output,v);o.next_out=m,o.avail_out=s-m,m&&o.output.set(o.output.subarray(v,v+m),0),this.onData(C)}else this.onData(o.output.length===o.next_out?o.output:o.output.subarray(0,o.next_out));if(!(d===np&&p===0)){if(d===Ag)return d=xu.inflateEnd(this.strm),this.onEnd(d),this.ended=!0,!0;if(o.avail_in===0)break}}return!0};rp.prototype.onData=function(n){this.chunks.push(n)};rp.prototype.onEnd=function(n){n===np&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=wx.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function Ov(n,r){const o=new rp(r);if(o.push(n),o.err)throw o.msg||Qg[o.err];return o.result}var Fv=rp,Uv=Ov,Ev={Inflate:Fv,inflate:Uv};const{Inflate:Vv,inflate:qv}=Ev;var by=Vv,Hv=qv;const Lx=[];for(let n=0;n<256;n++){let r=n;for(let o=0;o<8;o++)r&1?r=3988292384^r>>>1:r=r>>>1;Lx[n]=r}const vy=4294967295;function Wv(n,r,o){let s=n;for(let l=0;l<o;l++)s=Lx[(s^r[l])&255]^s>>>8;return s}function $v(n,r){return(Wv(vy,n,r)^vy)>>>0}function wy(n,r,o){const s=n.readUint32(),l=$v(new Uint8Array(n.buffer,n.byteOffset+n.offset-r-4,r),r);if(l!==s)throw new Error(`CRC mismatch for chunk ${o}. Expected ${s}, found ${l}`)}function Mx(n,r,o){for(let s=0;s<o;s++)r[s]=n[s]}function Bx(n,r,o,s){let l=0;for(;l<s;l++)r[l]=n[l];for(;l<o;l++)r[l]=n[l]+r[l-s]&255}function Ox(n,r,o,s){let l=0;if(o.length===0)for(;l<s;l++)r[l]=n[l];else for(;l<s;l++)r[l]=n[l]+o[l]&255}function Fx(n,r,o,s,l){let d=0;if(o.length===0){for(;d<l;d++)r[d]=n[d];for(;d<s;d++)r[d]=n[d]+(r[d-l]>>1)&255}else{for(;d<l;d++)r[d]=n[d]+(o[d]>>1)&255;for(;d<s;d++)r[d]=n[d]+(r[d-l]+o[d]>>1)&255}}function Ux(n,r,o,s,l){let d=0;if(o.length===0){for(;d<l;d++)r[d]=n[d];for(;d<s;d++)r[d]=n[d]+r[d-l]&255}else{for(;d<l;d++)r[d]=n[d]+o[d]&255;for(;d<s;d++)r[d]=n[d]+Yv(r[d-l],o[d],o[d-l])&255}}function Yv(n,r,o){const s=n+r-o,l=Math.abs(s-n),d=Math.abs(s-r),b=Math.abs(s-o);return l<=d&&l<=b?n:d<=b?r:o}function Gv(n,r,o,s,l,d){switch(n){case 0:Mx(r,o,l);break;case 1:Bx(r,o,l,d);break;case 2:Ox(r,o,s,l);break;case 3:Fx(r,o,s,l,d);break;case 4:Ux(r,o,s,l,d);break;default:throw new Error(`Unsupported filter: ${n}`)}}const Xv=new Uint16Array([255]),Kv=new Uint8Array(Xv.buffer),Zv=Kv[0]===255;function Jv(n){const{data:r,width:o,height:s,channels:l,depth:d}=n,b=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],p=Math.ceil(d/8)*l,v=new Uint8Array(s*o*p);let m=0;for(let C=0;C<7;C++){const D=b[C],M=Math.ceil((o-D.x)/D.xStep),S=Math.ceil((s-D.y)/D.yStep);if(M<=0||S<=0)continue;const U=M*p,_=new Uint8Array(U);for(let N=0;N<S;N++){const g=r[m++],ae=r.subarray(m,m+U);m+=U;const V=new Uint8Array(U);Gv(g,ae,V,_,U,p),_.set(V);for(let E=0;E<M;E++){const re=D.x+E*D.xStep,J=D.y+N*D.yStep;if(!(re>=o||J>=s))for(let G=0;G<p;G++)v[(J*o+re)*p+G]=V[E*p+G]}}}if(d===16){const C=new Uint16Array(v.buffer);if(Zv)for(let D=0;D<C.length;D++)C[D]=Qv(C[D]);return C}else return v}function Qv(n){return(n&255)<<8|n>>8&255}const e5=new Uint16Array([255]),t5=new Uint8Array(e5.buffer),n5=t5[0]===255,i5=new Uint8Array(0);function Sy(n){const{data:r,width:o,height:s,channels:l,depth:d}=n,b=Math.ceil(d/8)*l,p=Math.ceil(d/8*l*o),v=new Uint8Array(s*p);let m=i5,C=0,D,M;for(let S=0;S<s;S++){switch(D=r.subarray(C+1,C+1+p),M=v.subarray(S*p,(S+1)*p),r[C]){case 0:Mx(D,M,p);break;case 1:Bx(D,M,p,b);break;case 2:Ox(D,M,m,p);break;case 3:Fx(D,M,m,p,b);break;case 4:Ux(D,M,m,p,b);break;default:throw new Error(`Unsupported filter: ${r[C]}`)}m=M,C+=p+1}if(d===16){const S=new Uint16Array(v.buffer);if(n5)for(let U=0;U<S.length;U++)S[U]=r5(S[U]);return S}else return v}function r5(n){return(n&255)<<8|n>>8&255}const lh=Uint8Array.of(137,80,78,71,13,10,26,10);function Ty(n){if(!o5(n.readBytes(lh.length)))throw new Error("wrong PNG signature")}function o5(n){if(n.length<lh.length)return!1;for(let r=0;r<lh.length;r++)if(n[r]!==lh[r])return!1;return!0}const a5="tEXt",s5=0,Ex=new TextDecoder("latin1");function l5(n){if(u5(n),n.length===0||n.length>79)throw new Error("keyword length must be between 1 and 79")}const c5=/^[\u0000-\u00FF]*$/;function u5(n){if(!c5.test(n))throw new Error("invalid latin1 text")}function d5(n,r,o){const s=Vx(r);n[s]=f5(r,o-s.length-1)}function Vx(n){for(n.mark();n.readByte()!==s5;);const r=n.offset;n.reset();const o=Ex.decode(n.readBytes(r-n.offset-1));return n.skip(1),l5(o),o}function f5(n,r){return Ex.decode(n.readBytes(r))}const Wl={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},zg={UNKNOWN:-1,DEFLATE:0},Cy={UNKNOWN:-1,ADAPTIVE:0},_g={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},ih={NONE:0,BACKGROUND:1,PREVIOUS:2},Dg={SOURCE:0,OVER:1};class p5 extends d0{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(r,o={}){super(r);const{checkCrc:s=!1}=o;this._checkCrc=s,this._inflator=new by,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=zg.UNKNOWN,this._filterMethod=Cy.UNKNOWN,this._interlaceMethod=_g.UNKNOWN,this._colorType=Wl.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(Ty(this);!this._end;){const r=this.readUint32(),o=this.readChars(4);this.decodeChunk(r,o)}return this.decodeImage(),this._png}decodeApng(){for(Ty(this);!this._end;){const r=this.readUint32(),o=this.readChars(4);this.decodeApngChunk(r,o)}return this.decodeApngImage(),this._apng}decodeChunk(r,o){const s=this.offset;switch(o){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case a5:d5(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${o}`);this._checkCrc?wy(this,r+4,o):this.skip(4)}decodeApngChunk(r,o){const s=this.offset;switch(o!=="fdAT"&&o!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),o){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,o),this.offset=s+r;break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${o}`);this._checkCrc?wy(this,r+4,o):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=h5(this.readUint8());const o=this.readUint8();this._colorType=o;let s;switch(o){case Wl.GREYSCALE:s=1;break;case Wl.TRUECOLOUR:s=3;break;case Wl.INDEXED_COLOUR:s=1;break;case Wl.GREYSCALE_ALPHA:s=2;break;case Wl.TRUECOLOUR_ALPHA:s=4;break;case Wl.UNKNOWN:default:throw new Error(`Unknown color type: ${o}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==zg.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const o=r/3;this._hasPalette=!0;const s=[];this._palette=s;for(let l=0;l<o;l++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const o=r,s=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,s,o)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let o=r,s=this.offset+this.byteOffset;if(s+=4,o-=4,this._inflator.push(new Uint8Array(this.buffer,s,o)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case Wl.GREYSCALE:case Wl.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let o=0;o<r/2;o++)this._transparency[o]=this.readUint16();break}case Wl.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let o=0;for(;o<r;o++){const s=this.readByte();this._palette[o].push(s)}for(;o<this._palette.length;o++)this._palette[o].push(255);break}case Wl.UNKNOWN:case Wl.GREYSCALE_ALPHA:case Wl.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const o=Vx(this),s=this.readUint8();if(s!==zg.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const l=this.readBytes(r-o.length-2);this._png.iccEmbeddedProfile={name:o,profile:Hv(l)}}decodepHYs(){const r=this.readUint32(),o=this.readUint32(),s=this.readByte();this._png.resolution={x:r,y:o,unit:s}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const o={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},s=this._frames.at(r);if(s){if(s.data=Sy({data:s.data,width:s.width,height:s.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||s.xOffset===0&&s.yOffset===0&&s.width===this._png.width&&s.height===this._png.height)o.data=s.data;else{const l=this._apng.frames.at(r-1);this.disposeFrame(s,l,o),this.addFrameDataToCanvas(o,s)}this._apng.frames.push(o)}}return this._apng}disposeFrame(r,o,s){switch(r.disposeOp){case ih.NONE:break;case ih.BACKGROUND:for(let l=0;l<this._png.height;l++)for(let d=0;d<this._png.width;d++){const b=(l*r.width+d)*this._png.channels;for(let p=0;p<this._png.channels;p++)s.data[b+p]=0}break;case ih.PREVIOUS:s.data.set(o.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,o){const s=1<<this._png.depth,l=(d,b)=>{const p=((d+o.yOffset)*this._png.width+o.xOffset+b)*this._png.channels,v=(d*o.width+b)*this._png.channels;return{index:p,frameIndex:v}};switch(o.blendOp){case Dg.SOURCE:for(let d=0;d<o.height;d++)for(let b=0;b<o.width;b++){const{index:p,frameIndex:v}=l(d,b);for(let m=0;m<this._png.channels;m++)r.data[p+m]=o.data[v+m]}break;case Dg.OVER:for(let d=0;d<o.height;d++)for(let b=0;b<o.width;b++){const{index:p,frameIndex:v}=l(d,b);for(let m=0;m<this._png.channels;m++){const C=o.data[v+this._png.channels-1]/s,D=m%(this._png.channels-1)===0?1:o.data[v+m],M=Math.floor(C*D+(1-C)*r.data[p+m]);r.data[p+m]+=M}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==Cy.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===_g.NO_INTERLACE)this._png.data=Sy({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===_g.ADAM7)this._png.data=Jv({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,o=this._frames.at(-1);o?o.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:ih.NONE,blendOp:Dg.SOURCE,data:r}),this._inflator=new by,this._writingDataChunks=!1}}function h5(n){if(n!==1&&n!==2&&n!==4&&n!==8&&n!==16)throw new Error(`invalid bit depth: ${n}`);return n}var jy;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.METRE=1]="METRE"})(jy||(jy={}));function g5(n,r){return new p5(n,r).decode()}var ci=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function Rg(){ci.console&&typeof ci.console.log=="function"&&ci.console.log.apply(ci.console,arguments)}var lo={log:Rg,warn:function(n){ci.console&&(typeof ci.console.warn=="function"?ci.console.warn.apply(ci.console,arguments):Rg.call(null,arguments))},error:function(n){ci.console&&(typeof ci.console.error=="function"?ci.console.error.apply(ci.console,arguments):Rg(n))}};function Ig(n,r,o){var s=new XMLHttpRequest;s.open("GET",n),s.responseType="blob",s.onload=function(){md(s.response,r,o)},s.onerror=function(){lo.error("could not download file")},s.send()}function Ny(n){var r=new XMLHttpRequest;r.open("HEAD",n,!1);try{r.send()}catch{}return r.status>=200&&r.status<=299}function rh(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(r)}}var md=ci.saveAs||((typeof window>"u"?"undefined":qr(window))!=="object"||window!==ci?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(n,r,o){var s=ci.URL||ci.webkitURL,l=document.createElement("a");r=r||n.name||"download",l.download=r,l.rel="noopener",typeof n=="string"?(l.href=n,l.origin!==location.origin?Ny(l.href)?Ig(n,r,o):rh(l,l.target="_blank"):rh(l)):(l.href=s.createObjectURL(n),setTimeout(function(){s.revokeObjectURL(l.href)},4e4),setTimeout(function(){rh(l)},0))}:"msSaveOrOpenBlob"in navigator?function(n,r,o){if(r=r||n.name||"download",typeof n=="string")if(Ny(n))Ig(n,r,o);else{var s=document.createElement("a");s.href=n,s.target="_blank",setTimeout(function(){rh(s)})}else navigator.msSaveOrOpenBlob((function(l,d){return d===void 0?d={autoBom:!1}:qr(d)!=="object"&&(lo.warn("Deprecated: Expected third argument to be a object"),d={autoBom:!d}),d.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(l.type)?new Blob(["\uFEFF",l],{type:l.type}):l})(n,o),r)}:function(n,r,o,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),typeof n=="string")return Ig(n,r,o);var l=n.type==="application/octet-stream",d=/constructor/i.test(ci.HTMLElement)||ci.safari,b=/CriOS\/[\d]+/.test(navigator.userAgent);if((b||l&&d)&&(typeof FileReader>"u"?"undefined":qr(FileReader))==="object"){var p=new FileReader;p.onloadend=function(){var C=p.result;C=b?C:C.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=C:location=C,s=null},p.readAsDataURL(n)}else{var v=ci.URL||ci.webkitURL,m=v.createObjectURL(n);s?s.location=m:location.href=m,s=null,setTimeout(function(){v.revokeObjectURL(m)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function qx(n){var r;n=n||"",this.ok=!1,n.charAt(0)=="#"&&(n=n.substr(1,6)),n={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[n=(n=n.replace(/ /g,"")).toLowerCase()]||n;for(var o=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(p){return[parseInt(p[1]),parseInt(p[2]),parseInt(p[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(p){return[parseInt(p[1],16),parseInt(p[2],16),parseInt(p[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(p){return[parseInt(p[1]+p[1],16),parseInt(p[2]+p[2],16),parseInt(p[3]+p[3],16)]}}],s=0;s<o.length;s++){var l=o[s].re,d=o[s].process,b=l.exec(n);b&&(r=d(b),this.r=r[0],this.g=r[1],this.b=r[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var p=this.r.toString(16),v=this.g.toString(16),m=this.b.toString(16);return p.length==1&&(p="0"+p),v.length==1&&(v="0"+v),m.length==1&&(m="0"+m),"#"+p+v+m}}var ch=ci.atob.bind(ci),ky=ci.btoa.bind(ci);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Lg(n,r){var o=n[0],s=n[1],l=n[2],d=n[3];o=Ws(o,s,l,d,r[0],7,-680876936),d=Ws(d,o,s,l,r[1],12,-389564586),l=Ws(l,d,o,s,r[2],17,606105819),s=Ws(s,l,d,o,r[3],22,-1044525330),o=Ws(o,s,l,d,r[4],7,-176418897),d=Ws(d,o,s,l,r[5],12,1200080426),l=Ws(l,d,o,s,r[6],17,-1473231341),s=Ws(s,l,d,o,r[7],22,-45705983),o=Ws(o,s,l,d,r[8],7,1770035416),d=Ws(d,o,s,l,r[9],12,-1958414417),l=Ws(l,d,o,s,r[10],17,-42063),s=Ws(s,l,d,o,r[11],22,-1990404162),o=Ws(o,s,l,d,r[12],7,1804603682),d=Ws(d,o,s,l,r[13],12,-40341101),l=Ws(l,d,o,s,r[14],17,-1502002290),o=$s(o,s=Ws(s,l,d,o,r[15],22,1236535329),l,d,r[1],5,-165796510),d=$s(d,o,s,l,r[6],9,-1069501632),l=$s(l,d,o,s,r[11],14,643717713),s=$s(s,l,d,o,r[0],20,-373897302),o=$s(o,s,l,d,r[5],5,-701558691),d=$s(d,o,s,l,r[10],9,38016083),l=$s(l,d,o,s,r[15],14,-660478335),s=$s(s,l,d,o,r[4],20,-405537848),o=$s(o,s,l,d,r[9],5,568446438),d=$s(d,o,s,l,r[14],9,-1019803690),l=$s(l,d,o,s,r[3],14,-187363961),s=$s(s,l,d,o,r[8],20,1163531501),o=$s(o,s,l,d,r[13],5,-1444681467),d=$s(d,o,s,l,r[2],9,-51403784),l=$s(l,d,o,s,r[7],14,1735328473),o=Ys(o,s=$s(s,l,d,o,r[12],20,-1926607734),l,d,r[5],4,-378558),d=Ys(d,o,s,l,r[8],11,-2022574463),l=Ys(l,d,o,s,r[11],16,1839030562),s=Ys(s,l,d,o,r[14],23,-35309556),o=Ys(o,s,l,d,r[1],4,-1530992060),d=Ys(d,o,s,l,r[4],11,1272893353),l=Ys(l,d,o,s,r[7],16,-155497632),s=Ys(s,l,d,o,r[10],23,-1094730640),o=Ys(o,s,l,d,r[13],4,681279174),d=Ys(d,o,s,l,r[0],11,-358537222),l=Ys(l,d,o,s,r[3],16,-722521979),s=Ys(s,l,d,o,r[6],23,76029189),o=Ys(o,s,l,d,r[9],4,-640364487),d=Ys(d,o,s,l,r[12],11,-421815835),l=Ys(l,d,o,s,r[15],16,530742520),o=Gs(o,s=Ys(s,l,d,o,r[2],23,-995338651),l,d,r[0],6,-198630844),d=Gs(d,o,s,l,r[7],10,1126891415),l=Gs(l,d,o,s,r[14],15,-1416354905),s=Gs(s,l,d,o,r[5],21,-57434055),o=Gs(o,s,l,d,r[12],6,1700485571),d=Gs(d,o,s,l,r[3],10,-1894986606),l=Gs(l,d,o,s,r[10],15,-1051523),s=Gs(s,l,d,o,r[1],21,-2054922799),o=Gs(o,s,l,d,r[8],6,1873313359),d=Gs(d,o,s,l,r[15],10,-30611744),l=Gs(l,d,o,s,r[6],15,-1560198380),s=Gs(s,l,d,o,r[13],21,1309151649),o=Gs(o,s,l,d,r[4],6,-145523070),d=Gs(d,o,s,l,r[11],10,-1120210379),l=Gs(l,d,o,s,r[2],15,718787259),s=Gs(s,l,d,o,r[9],21,-343485551),n[0]=Wu(o,n[0]),n[1]=Wu(s,n[1]),n[2]=Wu(l,n[2]),n[3]=Wu(d,n[3])}function Nh(n,r,o,s,l,d){return r=Wu(Wu(r,n),Wu(s,d)),Wu(r<<l|r>>>32-l,o)}function Ws(n,r,o,s,l,d,b){return Nh(r&o|~r&s,n,r,l,d,b)}function $s(n,r,o,s,l,d,b){return Nh(r&s|o&~s,n,r,l,d,b)}function Ys(n,r,o,s,l,d,b){return Nh(r^o^s,n,r,l,d,b)}function Gs(n,r,o,s,l,d,b){return Nh(o^(r|~s),n,r,l,d,b)}function Hx(n){var r,o=n.length,s=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=n.length;r+=64)Lg(s,y5(n.substring(r-64,r)));n=n.substring(r-64);var l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<n.length;r++)l[r>>2]|=n.charCodeAt(r)<<(r%4<<3);if(l[r>>2]|=128<<(r%4<<3),r>55)for(Lg(s,l),r=0;r<16;r++)l[r]=0;return l[14]=8*o,Lg(s,l),s}function y5(n){var r,o=[];for(r=0;r<64;r+=4)o[r>>2]=n.charCodeAt(r)+(n.charCodeAt(r+1)<<8)+(n.charCodeAt(r+2)<<16)+(n.charCodeAt(r+3)<<24);return o}var Ay="0123456789abcdef".split("");function x5(n){for(var r="",o=0;o<4;o++)r+=Ay[n>>8*o+4&15]+Ay[n>>8*o&15];return r}function m5(n){return String.fromCharCode(255&n,(65280&n)>>8,(16711680&n)>>16,(4278190080&n)>>24)}function t0(n){return Hx(n).map(m5).join("")}var b5=(function(n){for(var r=0;r<n.length;r++)n[r]=x5(n[r]);return n.join("")})(Hx("hello"))!="5d41402abc4b2a76b9719d911017c592";function Wu(n,r){if(b5){var o=(65535&n)+(65535&r);return(n>>16)+(r>>16)+(o>>16)<<16|65535&o}return n+r&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function n0(n,r){var o,s,l,d;if(n!==o){for(var b=(l=n,d=1+(256/n.length|0),new Array(d+1).join(l)),p=[],v=0;v<256;v++)p[v]=v;var m=0;for(v=0;v<256;v++){var C=p[v];m=(m+C+b.charCodeAt(v))%256,p[v]=p[m],p[m]=C}o=n,s=p}else p=s;var D=r.length,M=0,S=0,U="";for(v=0;v<D;v++)S=(S+(C=p[M=(M+1)%256]))%256,p[M]=p[S],p[S]=C,b=p[(p[M]+p[S])%256],U+=String.fromCharCode(r.charCodeAt(v)^b);return U}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Py={print:4,modify:8,copy:16,"annot-forms":32};function nf(n,r,o,s){this.v=1,this.r=2;var l=192;n.forEach(function(p){if(Py.perm!==void 0)throw new Error("Invalid permission: "+p);l+=Py[p]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var d=(r+this.padding).substr(0,32),b=(o+this.padding).substr(0,32);this.O=this.processOwnerPassword(d,b),this.P=-(1+(255^l)),this.encryptionKey=t0(d+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(s)).substr(0,5),this.U=n0(this.encryptionKey,this.padding)}function rf(n){if(/[^\u0000-\u00ff]/.test(n))throw new Error("Invalid PDF Name Object: "+n+", Only accept ASCII characters.");for(var r="",o=n.length,s=0;s<o;s++){var l=n.charCodeAt(s);r+=l<33||l===35||l===37||l===40||l===41||l===47||l===60||l===62||l===91||l===93||l===123||l===125||l>126?"#"+("0"+l.toString(16)).slice(-2):n[s]}return r}function zy(n){if(qr(n)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var r={};this.subscribe=function(o,s,l){if(l=l||!1,typeof o!="string"||typeof s!="function"||typeof l!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");r.hasOwnProperty(o)||(r[o]={});var d=Math.random().toString(35);return r[o][d]=[s,!!l],d},this.unsubscribe=function(o){for(var s in r)if(r[s][o])return delete r[s][o],Object.keys(r[s]).length===0&&delete r[s],!0;return!1},this.publish=function(o){if(r.hasOwnProperty(o)){var s=Array.prototype.slice.call(arguments,1),l=[];for(var d in r[o]){var b=r[o][d];try{b[0].apply(n,s)}catch(p){ci.console&&lo.error("jsPDF PubSub Error",p.message,p)}b[1]&&l.push(d)}l.length&&l.forEach(this.unsubscribe)}},this.getTopics=function(){return r}}function xh(n){if(!(this instanceof xh))return new xh(n);var r="opacity,stroke-opacity".split(",");for(var o in n)n.hasOwnProperty(o)&&r.indexOf(o)>=0&&(this[o]=n[o]);this.id="",this.objectNumber=-1}function Wx(n,r){this.gState=n,this.matrix=r,this.id="",this.objectNumber=-1}function bd(n,r,o,s,l){if(!(this instanceof bd))return new bd(n,r,o,s,l);this.type=n==="axial"?2:3,this.coords=r,this.colors=o,Wx.call(this,s,l)}function of(n,r,o,s,l){if(!(this instanceof of))return new of(n,r,o,s,l);this.boundingBox=n,this.xStep=r,this.yStep=o,this.stream="",this.cloneIndex=0,Wx.call(this,s,l)}function qn(n){var r,o=typeof arguments[0]=="string"?arguments[0]:"p",s=arguments[1],l=arguments[2],d=arguments[3],b=[],p=1,v=16,m="S",C=null;qr(n=n||{})==="object"&&(o=n.orientation,s=n.unit||s,l=n.format||l,d=n.compress||n.compressPdf||d,(C=n.encryption||null)!==null&&(C.userPassword=C.userPassword||"",C.ownerPassword=C.ownerPassword||"",C.userPermissions=C.userPermissions||[]),p=typeof n.userUnit=="number"?Math.abs(n.userUnit):1,n.precision!==void 0&&(r=n.precision),n.floatPrecision!==void 0&&(v=n.floatPrecision),m=n.defaultPathOperation||"S"),b=n.filters||(d===!0?["FlateEncode"]:b),s=s||"mm",o=(""+(o||"P")).toLowerCase();var D=n.putOnlyUsedFonts||!1,M={},S={internal:{},__private__:{}};S.__private__.PubSub=zy;var U="1.3",_=S.__private__.getPdfVersion=function(){return U};S.__private__.setPdfVersion=function(T){U=T};var N={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};S.__private__.getPageFormats=function(){return N};var g=S.__private__.getPageFormat=function(T){return N[T]};l=l||"a4";var ae="compat",V="advanced",E=ae;function re(){this.saveGraphicsState(),ge(new qt(ct,0,0,-ct,0,ws()*ct).toString()+" cm"),this.setFontSize(this.getFontSize()/ct),m="n",E=V}function J(){this.restoreGraphicsState(),m="S",E=ae}var G=S.__private__.combineFontStyleAndFontWeight=function(T,Q){if(T=="bold"&&Q=="normal"||T=="bold"&&Q==400||T=="normal"&&Q=="italic"||T=="bold"&&Q=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Q&&(T=Q==400||Q==="normal"?T==="italic"?"italic":"normal":Q!=700&&Q!=="bold"||T!=="normal"?(Q==700?"bold":Q)+""+T:"bold"),T};S.advancedAPI=function(T){var Q=E===ae;return Q&&re.call(this),typeof T!="function"||(T(this),Q&&J.call(this)),this},S.compatAPI=function(T){var Q=E===V;return Q&&J.call(this),typeof T!="function"||(T(this),Q&&re.call(this)),this},S.isAdvancedAPI=function(){return E===V};var ee,F=function(T){if(E!==V)throw new Error(T+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},$=S.roundToPrecision=S.__private__.roundToPrecision=function(T,Q){var fe=r||Q;if(isNaN(T)||isNaN(fe))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return T.toFixed(fe).replace(/0+$/,"")};ee=S.hpf=S.__private__.hpf=typeof v=="number"?function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.hpf");return $(T,v)}:v==="smart"?function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.hpf");return $(T,T>-1&&T<1?16:5)}:function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.hpf");return $(T,16)};var H=S.f2=S.__private__.f2=function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.f2");return $(T,2)},R=S.__private__.f3=function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.f3");return $(T,3)},Z=S.scale=S.__private__.scale=function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.scale");return E===ae?T*ct:E===V?T:void 0},Y=function(T){return Z((function(Q){return E===ae?ws()-Q:E===V?Q:void 0})(T))};S.__private__.setPrecision=S.setPrecision=function(T){typeof parseInt(T,10)=="number"&&(r=parseInt(T,10))};var we,te="00000000000000000000000000000000",de=S.__private__.getFileId=function(){return te},je=S.__private__.setFileId=function(T){return te=T!==void 0&&/^[a-fA-F0-9]{32}$/.test(T)?T.toUpperCase():te.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),C!==null&&(co=new nf(C.userPermissions,C.userPassword,C.ownerPassword,te)),te};S.setFileId=function(T){return je(T),this},S.getFileId=function(){return de()};var Ie=S.__private__.convertDateToPDFDate=function(T){var Q=T.getTimezoneOffset(),fe=Q<0?"+":"-",Be=Math.floor(Math.abs(Q/60)),Ve=Math.abs(Q%60),gt=[fe,W(Be),"'",W(Ve),"'"].join("");return["D:",T.getFullYear(),W(T.getMonth()+1),W(T.getDate()),W(T.getHours()),W(T.getMinutes()),W(T.getSeconds()),gt].join("")},xe=S.__private__.convertPDFDateToDate=function(T){var Q=parseInt(T.substr(2,4),10),fe=parseInt(T.substr(6,2),10)-1,Be=parseInt(T.substr(8,2),10),Ve=parseInt(T.substr(10,2),10),gt=parseInt(T.substr(12,2),10),mt=parseInt(T.substr(14,2),10);return new Date(Q,fe,Be,Ve,gt,mt,0)},k=S.__private__.setCreationDate=function(T){var Q;if(T===void 0&&(T=new Date),T instanceof Date)Q=Ie(T);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(T))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Q=T}return we=Q},A=S.__private__.getCreationDate=function(T){var Q=we;return T==="jsDate"&&(Q=xe(we)),Q};S.setCreationDate=function(T){return k(T),this},S.getCreationDate=function(T){return A(T)};var q,W=S.__private__.padd2=function(T){return("0"+parseInt(T)).slice(-2)},se=S.__private__.padd2Hex=function(T){return("00"+(T=T.toString())).substr(T.length)},Ce=0,le=[],_e=[],be=0,De=[],Ge=[],ot=!1,jt=_e;S.__private__.setCustomOutputDestination=function(T){ot=!0,jt=T};var Ht=function(T){ot||(jt=T)};S.__private__.resetCustomOutputDestination=function(){ot=!1,jt=_e};var ge=S.__private__.out=function(T){return T=T.toString(),be+=T.length+1,jt.push(T),jt},lt=S.__private__.write=function(T){return ge(arguments.length===1?T.toString():Array.prototype.join.call(arguments," "))},Yt=S.__private__.getArrayBuffer=function(T){for(var Q=T.length,fe=new ArrayBuffer(Q),Be=new Uint8Array(fe);Q--;)Be[Q]=T.charCodeAt(Q);return fe},Gt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];S.__private__.getStandardFonts=function(){return Gt};var xt=n.fontSize||16;S.__private__.setFontSize=S.setFontSize=function(T){return xt=E===V?T/ct:T,this};var hn,Et=S.__private__.getFontSize=S.getFontSize=function(){return E===ae?xt:xt*ct},gn=n.R2L||!1;S.__private__.setR2L=S.setR2L=function(T){return gn=T,this},S.__private__.getR2L=S.getR2L=function(){return gn};var Zt,xn=S.__private__.setZoomMode=function(T){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(T))hn=T;else if(isNaN(T)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(T)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+T+'" is not recognized.');hn=T}else hn=parseInt(T,10)};S.__private__.getZoomMode=function(){return hn};var tt,Rn=S.__private__.setPageMode=function(T){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(T)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+T+'" is not recognized.');Zt=T};S.__private__.getPageMode=function(){return Zt};var Lt=S.__private__.setLayoutMode=function(T){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(T)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+T+'" is not recognized.');tt=T};S.__private__.getLayoutMode=function(){return tt},S.__private__.setDisplayMode=S.setDisplayMode=function(T,Q,fe){return xn(T),Lt(Q),Rn(fe),this};var Wt={title:"",subject:"",author:"",keywords:"",creator:""};S.__private__.getDocumentProperty=function(T){if(Object.keys(Wt).indexOf(T)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Wt[T]},S.__private__.getDocumentProperties=function(){return Wt},S.__private__.setDocumentProperties=S.setProperties=S.setDocumentProperties=function(T){for(var Q in Wt)Wt.hasOwnProperty(Q)&&T[Q]&&(Wt[Q]=T[Q]);return this},S.__private__.setDocumentProperty=function(T,Q){if(Object.keys(Wt).indexOf(T)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Wt[T]=Q};var vn,ct,ye,ze,Nt,Ke={},vt={},Vt=[],ht={},Je={},Ft={},At={},Jt=null,An=0,dn=[],ti=new zy(S),Tr=n.hotfixes||[],en={},zi={},Mr=[],qt=function T(Q,fe,Be,Ve,gt,mt){if(!(this instanceof T))return new T(Q,fe,Be,Ve,gt,mt);isNaN(Q)&&(Q=1),isNaN(fe)&&(fe=0),isNaN(Be)&&(Be=0),isNaN(Ve)&&(Ve=1),isNaN(gt)&&(gt=0),isNaN(mt)&&(mt=0),this._matrix=[Q,fe,Be,Ve,gt,mt]};Object.defineProperty(qt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(T){this._matrix[0]=T}}),Object.defineProperty(qt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(T){this._matrix[1]=T}}),Object.defineProperty(qt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(T){this._matrix[2]=T}}),Object.defineProperty(qt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(T){this._matrix[3]=T}}),Object.defineProperty(qt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(T){this._matrix[4]=T}}),Object.defineProperty(qt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(T){this._matrix[5]=T}}),Object.defineProperty(qt.prototype,"a",{get:function(){return this._matrix[0]},set:function(T){this._matrix[0]=T}}),Object.defineProperty(qt.prototype,"b",{get:function(){return this._matrix[1]},set:function(T){this._matrix[1]=T}}),Object.defineProperty(qt.prototype,"c",{get:function(){return this._matrix[2]},set:function(T){this._matrix[2]=T}}),Object.defineProperty(qt.prototype,"d",{get:function(){return this._matrix[3]},set:function(T){this._matrix[3]=T}}),Object.defineProperty(qt.prototype,"e",{get:function(){return this._matrix[4]},set:function(T){this._matrix[4]=T}}),Object.defineProperty(qt.prototype,"f",{get:function(){return this._matrix[5]},set:function(T){this._matrix[5]=T}}),Object.defineProperty(qt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(qt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(qt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(qt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),qt.prototype.join=function(T){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(ee).join(T)},qt.prototype.multiply=function(T){var Q=T.sx*this.sx+T.shy*this.shx,fe=T.sx*this.shy+T.shy*this.sy,Be=T.shx*this.sx+T.sy*this.shx,Ve=T.shx*this.shy+T.sy*this.sy,gt=T.tx*this.sx+T.ty*this.shx+this.tx,mt=T.tx*this.shy+T.ty*this.sy+this.ty;return new qt(Q,fe,Be,Ve,gt,mt)},qt.prototype.decompose=function(){var T=this.sx,Q=this.shy,fe=this.shx,Be=this.sy,Ve=this.tx,gt=this.ty,mt=Math.sqrt(T*T+Q*Q),$t=(T/=mt)*fe+(Q/=mt)*Be;fe-=T*$t,Be-=Q*$t;var Kt=Math.sqrt(fe*fe+Be*Be);return $t/=Kt,T*(Be/=Kt)<Q*(fe/=Kt)&&(T=-T,Q=-Q,$t=-$t,mt=-mt),{scale:new qt(mt,0,0,Kt,0,0),translate:new qt(1,0,0,1,Ve,gt),rotate:new qt(T,Q,-Q,T,0,0),skew:new qt(1,0,$t,1,0,0)}},qt.prototype.toString=function(T){return this.join(" ")},qt.prototype.inversed=function(){var T=this.sx,Q=this.shy,fe=this.shx,Be=this.sy,Ve=this.tx,gt=this.ty,mt=1/(T*Be-Q*fe),$t=Be*mt,Kt=-Q*mt,sn=-fe*mt,Un=T*mt;return new qt($t,Kt,sn,Un,-$t*Ve-sn*gt,-Kt*Ve-Un*gt)},qt.prototype.applyToPoint=function(T){var Q=T.x*this.sx+T.y*this.shx+this.tx,fe=T.x*this.shy+T.y*this.sy+this.ty;return new ri(Q,fe)},qt.prototype.applyToRectangle=function(T){var Q=this.applyToPoint(T),fe=this.applyToPoint(new ri(T.x+T.w,T.y+T.h));return new tn(Q.x,Q.y,fe.x-Q.x,fe.y-Q.y)},qt.prototype.clone=function(){var T=this.sx,Q=this.shy,fe=this.shx,Be=this.sy,Ve=this.tx,gt=this.ty;return new qt(T,Q,fe,Be,Ve,gt)},S.Matrix=qt;var Zi=S.matrixMult=function(T,Q){return Q.multiply(T)},Ji=new qt(1,0,0,1,0,0);S.unitMatrix=S.identityMatrix=Ji;var Cr=function(T,Q){if(!Je[T]){var fe=(Q instanceof bd?"Sh":"P")+(Object.keys(ht).length+1).toString(10);Q.id=fe,Je[T]=fe,ht[fe]=Q,ti.publish("addPattern",Q)}};S.ShadingPattern=bd,S.TilingPattern=of,S.addShadingPattern=function(T,Q){return F("addShadingPattern()"),Cr(T,Q),this},S.beginTilingPattern=function(T){F("beginTilingPattern()"),Va(T.boundingBox[0],T.boundingBox[1],T.boundingBox[2]-T.boundingBox[0],T.boundingBox[3]-T.boundingBox[1],T.matrix)},S.endTilingPattern=function(T,Q){F("endTilingPattern()"),Q.stream=Ge[q].join(`
`),Cr(T,Q),ti.publish("endTilingPattern",Q),Mr.pop().restore()};var jr,hi=S.__private__.newObject=function(){var T=wt();return Wn(T,!0),T},wt=S.__private__.newObjectDeferred=function(){return Ce++,le[Ce]=function(){return be},Ce},Wn=function(T,Q){return Q=typeof Q=="boolean"&&Q,le[T]=be,Q&&ge(T+" 0 obj"),T},mn=S.__private__.newAdditionalObject=function(){var T={objId:wt(),content:""};return De.push(T),T},Ot=wt(),Dt=wt(),an=S.__private__.decodeColorString=function(T){var Q=T.split(" ");if(Q.length!==2||Q[1]!=="g"&&Q[1]!=="G")Q.length!==5||Q[4]!=="k"&&Q[4]!=="K"||(Q=[(1-Q[0])*(1-Q[3]),(1-Q[1])*(1-Q[3]),(1-Q[2])*(1-Q[3]),"r"]);else{var fe=parseFloat(Q[0]);Q=[fe,fe,fe,"r"]}for(var Be="#",Ve=0;Ve<3;Ve++)Be+=("0"+Math.floor(255*parseFloat(Q[Ve])).toString(16)).slice(-2);return Be},rn=S.__private__.encodeColorString=function(T){var Q;typeof T=="string"&&(T={ch1:T});var fe=T.ch1,Be=T.ch2,Ve=T.ch3,gt=T.ch4,mt=T.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof fe=="string"&&fe.charAt(0)!=="#"){var $t=new qx(fe);if($t.ok)fe=$t.toHex();else if(!/^\d*\.?\d*$/.test(fe))throw new Error('Invalid color "'+fe+'" passed to jsPDF.encodeColorString.')}if(typeof fe=="string"&&/^#[0-9A-Fa-f]{3}$/.test(fe)&&(fe="#"+fe[1]+fe[1]+fe[2]+fe[2]+fe[3]+fe[3]),typeof fe=="string"&&/^#[0-9A-Fa-f]{6}$/.test(fe)){var Kt=parseInt(fe.substr(1),16);fe=Kt>>16&255,Be=Kt>>8&255,Ve=255&Kt}if(Be===void 0||gt===void 0&&fe===Be&&Be===Ve)Q=typeof fe=="string"?fe+" "+mt[0]:T.precision===2?H(fe/255)+" "+mt[0]:R(fe/255)+" "+mt[0];else if(gt===void 0||qr(gt)==="object"){if(gt&&!isNaN(gt.a)&&gt.a===0)return["1.","1.","1.",mt[1]].join(" ");Q=typeof fe=="string"?[fe,Be,Ve,mt[1]].join(" "):T.precision===2?[H(fe/255),H(Be/255),H(Ve/255),mt[1]].join(" "):[R(fe/255),R(Be/255),R(Ve/255),mt[1]].join(" ")}else Q=typeof fe=="string"?[fe,Be,Ve,gt,mt[2]].join(" "):T.precision===2?[H(fe),H(Be),H(Ve),H(gt),mt[2]].join(" "):[R(fe),R(Be),R(Ve),R(gt),mt[2]].join(" ");return Q},bn=S.__private__.getFilters=function(){return b},ni=S.__private__.putStream=function(T){var Q=(T=T||{}).data||"",fe=T.filters||bn(),Be=T.alreadyAppliedFilters||[],Ve=T.addLength1||!1,gt=Q.length,mt=T.objectId,$t=function(Ar){return Ar};if(C!==null&&mt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");C!==null&&($t=co.encryptor(mt,0));var Kt={};fe===!0&&(fe=["FlateEncode"]);var sn=T.additionalKeyValues||[],Un=(Kt=qn.API.processDataByFilters!==void 0?qn.API.processDataByFilters(Q,fe):{data:Q,reverseChain:[]}).reverseChain+(Array.isArray(Be)?Be.join(" "):Be.toString());if(Kt.data.length!==0&&(sn.push({key:"Length",value:Kt.data.length}),Ve===!0&&sn.push({key:"Length1",value:gt})),Un.length!=0)if(Un.split("/").length-1==1)sn.push({key:"Filter",value:Un});else{sn.push({key:"Filter",value:"["+Un+"]"});for(var li=0;li<sn.length;li+=1)if(sn[li].key==="DecodeParms"){for(var Qr=[],Bi=0;Bi<Kt.reverseChain.split("/").length-1;Bi+=1)Qr.push("null");Qr.push(sn[li].value),sn[li].value="["+Qr.join(" ")+"]"}}ge("<<");for(var kr=0;kr<sn.length;kr++)ge("/"+sn[kr].key+" "+sn[kr].value);ge(">>"),Kt.data.length!==0&&(ge("stream"),ge($t(Kt.data)),ge("endstream"))},hr=S.__private__.putPage=function(T){var Q=T.number,fe=T.data,Be=T.objId,Ve=T.contentsObjId;Wn(Be,!0),ge("<</Type /Page"),ge("/Parent "+T.rootDictionaryObjId+" 0 R"),ge("/Resources "+T.resourceDictionaryObjId+" 0 R"),ge("/MediaBox ["+parseFloat(ee(T.mediaBox.bottomLeftX))+" "+parseFloat(ee(T.mediaBox.bottomLeftY))+" "+ee(T.mediaBox.topRightX)+" "+ee(T.mediaBox.topRightY)+"]"),T.cropBox!==null&&ge("/CropBox ["+ee(T.cropBox.bottomLeftX)+" "+ee(T.cropBox.bottomLeftY)+" "+ee(T.cropBox.topRightX)+" "+ee(T.cropBox.topRightY)+"]"),T.bleedBox!==null&&ge("/BleedBox ["+ee(T.bleedBox.bottomLeftX)+" "+ee(T.bleedBox.bottomLeftY)+" "+ee(T.bleedBox.topRightX)+" "+ee(T.bleedBox.topRightY)+"]"),T.trimBox!==null&&ge("/TrimBox ["+ee(T.trimBox.bottomLeftX)+" "+ee(T.trimBox.bottomLeftY)+" "+ee(T.trimBox.topRightX)+" "+ee(T.trimBox.topRightY)+"]"),T.artBox!==null&&ge("/ArtBox ["+ee(T.artBox.bottomLeftX)+" "+ee(T.artBox.bottomLeftY)+" "+ee(T.artBox.topRightX)+" "+ee(T.artBox.topRightY)+"]"),typeof T.userUnit=="number"&&T.userUnit!==1&&ge("/UserUnit "+T.userUnit),ti.publish("putPage",{objId:Be,pageContext:dn[Q],pageNumber:Q,page:fe}),ge("/Contents "+Ve+" 0 R"),ge(">>"),ge("endobj");var gt=fe.join(`
`);return E===V&&(gt+=`
Q`),Wn(Ve,!0),ni({data:gt,filters:bn(),objectId:Ve}),ge("endobj"),Be},Di=S.__private__.putPages=function(){var T,Q,fe=[];for(T=1;T<=An;T++)dn[T].objId=wt(),dn[T].contentsObjId=wt();for(T=1;T<=An;T++)fe.push(hr({number:T,data:Ge[T],objId:dn[T].objId,contentsObjId:dn[T].contentsObjId,mediaBox:dn[T].mediaBox,cropBox:dn[T].cropBox,bleedBox:dn[T].bleedBox,trimBox:dn[T].trimBox,artBox:dn[T].artBox,userUnit:dn[T].userUnit,rootDictionaryObjId:Ot,resourceDictionaryObjId:Dt}));Wn(Ot,!0),ge("<</Type /Pages");var Be="/Kids [";for(Q=0;Q<An;Q++)Be+=fe[Q]+" 0 R ";ge(Be+"]"),ge("/Count "+An),ge(">>"),ge("endobj"),ti.publish("postPutPages")},qi=function(T){ti.publish("putFont",{font:T,out:ge,newObject:hi,putStream:ni}),T.isAlreadyPutted!==!0&&(T.objectNumber=hi(),ge("<<"),ge("/Type /Font"),ge("/BaseFont /"+rf(T.postScriptName)),ge("/Subtype /Type1"),typeof T.encoding=="string"&&ge("/Encoding /"+T.encoding),ge("/FirstChar 32"),ge("/LastChar 255"),ge(">>"),ge("endobj"))},Br=function(T){T.objectNumber=hi();var Q=[];Q.push({key:"Type",value:"/XObject"}),Q.push({key:"Subtype",value:"/Form"}),Q.push({key:"BBox",value:"["+[ee(T.x),ee(T.y),ee(T.x+T.width),ee(T.y+T.height)].join(" ")+"]"}),Q.push({key:"Matrix",value:"["+T.matrix.toString()+"]"});var fe=T.pages[1].join(`
`);ni({data:fe,additionalKeyValues:Q,objectId:T.objectNumber}),ge("endobj")},_i=function(T,Q){Q||(Q=21);var fe=hi(),Be=(function(mt,$t){var Kt,sn=[],Un=1/($t-1);for(Kt=0;Kt<1;Kt+=Un)sn.push(Kt);if(sn.push(1),mt[0].offset!=0){var li={offset:0,color:mt[0].color};mt.unshift(li)}if(mt[mt.length-1].offset!=1){var Qr={offset:1,color:mt[mt.length-1].color};mt.push(Qr)}for(var Bi="",kr=0,Ar=0;Ar<sn.length;Ar++){for(Kt=sn[Ar];Kt>mt[kr+1].offset;)kr++;var _o=mt[kr].offset,Qi=(Kt-_o)/(mt[kr+1].offset-_o),ya=mt[kr].color,Dr=mt[kr+1].color;Bi+=se(Math.round((1-Qi)*ya[0]+Qi*Dr[0]).toString(16))+se(Math.round((1-Qi)*ya[1]+Qi*Dr[1]).toString(16))+se(Math.round((1-Qi)*ya[2]+Qi*Dr[2]).toString(16))}return Bi.trim()})(T.colors,Q),Ve=[];Ve.push({key:"FunctionType",value:"0"}),Ve.push({key:"Domain",value:"[0.0 1.0]"}),Ve.push({key:"Size",value:"["+Q+"]"}),Ve.push({key:"BitsPerSample",value:"8"}),Ve.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ve.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ni({data:Be,additionalKeyValues:Ve,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:fe}),ge("endobj"),T.objectNumber=hi(),ge("<< /ShadingType "+T.type),ge("/ColorSpace /DeviceRGB");var gt="/Coords ["+ee(parseFloat(T.coords[0]))+" "+ee(parseFloat(T.coords[1]))+" ";T.type===2?gt+=ee(parseFloat(T.coords[2]))+" "+ee(parseFloat(T.coords[3])):gt+=ee(parseFloat(T.coords[2]))+" "+ee(parseFloat(T.coords[3]))+" "+ee(parseFloat(T.coords[4]))+" "+ee(parseFloat(T.coords[5])),ge(gt+="]"),T.matrix&&ge("/Matrix ["+T.matrix.toString()+"]"),ge("/Function "+fe+" 0 R"),ge("/Extend [true true]"),ge(">>"),ge("endobj")},ar=function(T,Q){var fe=wt(),Be=hi();Q.push({resourcesOid:fe,objectOid:Be}),T.objectNumber=Be;var Ve=[];Ve.push({key:"Type",value:"/Pattern"}),Ve.push({key:"PatternType",value:"1"}),Ve.push({key:"PaintType",value:"1"}),Ve.push({key:"TilingType",value:"1"}),Ve.push({key:"BBox",value:"["+T.boundingBox.map(ee).join(" ")+"]"}),Ve.push({key:"XStep",value:ee(T.xStep)}),Ve.push({key:"YStep",value:ee(T.yStep)}),Ve.push({key:"Resources",value:fe+" 0 R"}),T.matrix&&Ve.push({key:"Matrix",value:"["+T.matrix.toString()+"]"}),ni({data:T.stream,additionalKeyValues:Ve,objectId:T.objectNumber}),ge("endobj")},ui=function(T){for(var Q in T.objectNumber=hi(),ge("<<"),T)switch(Q){case"opacity":ge("/ca "+H(T[Q]));break;case"stroke-opacity":ge("/CA "+H(T[Q]))}ge(">>"),ge("endobj")},zo=function(T){Wn(T.resourcesOid,!0),ge("<<"),ge("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var Q in ge("/Font <<"),Ke)Ke.hasOwnProperty(Q)&&(D===!1||D===!0&&M.hasOwnProperty(Q))&&ge("/"+Q+" "+Ke[Q].objectNumber+" 0 R");ge(">>")})(),(function(){if(Object.keys(ht).length>0){for(var Q in ge("/Shading <<"),ht)ht.hasOwnProperty(Q)&&ht[Q]instanceof bd&&ht[Q].objectNumber>=0&&ge("/"+Q+" "+ht[Q].objectNumber+" 0 R");ti.publish("putShadingPatternDict"),ge(">>")}})(),(function(Q){if(Object.keys(ht).length>0){for(var fe in ge("/Pattern <<"),ht)ht.hasOwnProperty(fe)&&ht[fe]instanceof S.TilingPattern&&ht[fe].objectNumber>=0&&ht[fe].objectNumber<Q&&ge("/"+fe+" "+ht[fe].objectNumber+" 0 R");ti.publish("putTilingPatternDict"),ge(">>")}})(T.objectOid),(function(){if(Object.keys(Ft).length>0){var Q;for(Q in ge("/ExtGState <<"),Ft)Ft.hasOwnProperty(Q)&&Ft[Q].objectNumber>=0&&ge("/"+Q+" "+Ft[Q].objectNumber+" 0 R");ti.publish("putGStateDict"),ge(">>")}})(),(function(){for(var Q in ge("/XObject <<"),en)en.hasOwnProperty(Q)&&en[Q].objectNumber>=0&&ge("/"+Q+" "+en[Q].objectNumber+" 0 R");ti.publish("putXobjectDict"),ge(">>")})(),ge(">>"),ge("endobj")},Hn=function(T){vt[T.fontName]=vt[T.fontName]||{},vt[T.fontName][T.fontStyle]=T.id},ys=function(T,Q,fe,Be,Ve){var gt={id:"F"+(Object.keys(Ke).length+1).toString(10),postScriptName:T,fontName:Q,fontStyle:fe,encoding:Be,isStandardFont:Ve||!1,metadata:{}};return ti.publish("addFont",{font:gt,instance:this}),Ke[gt.id]=gt,Hn(gt),gt.id},di=S.__private__.pdfEscape=S.pdfEscape=function(T,Q){return(function(fe,Be){var Ve,gt,mt,$t,Kt,sn,Un,li,Qr;if(mt=(Be=Be||{}).sourceEncoding||"Unicode",Kt=Be.outputEncoding,(Be.autoencode||Kt)&&Ke[vn].metadata&&Ke[vn].metadata[mt]&&Ke[vn].metadata[mt].encoding&&($t=Ke[vn].metadata[mt].encoding,!Kt&&Ke[vn].encoding&&(Kt=Ke[vn].encoding),!Kt&&$t.codePages&&(Kt=$t.codePages[0]),typeof Kt=="string"&&(Kt=$t[Kt]),Kt)){for(Un=!1,sn=[],Ve=0,gt=fe.length;Ve<gt;Ve++)(li=Kt[fe.charCodeAt(Ve)])?sn.push(String.fromCharCode(li)):sn.push(fe[Ve]),sn[Ve].charCodeAt(0)>>8&&(Un=!0);fe=sn.join("")}for(Ve=fe.length;Un===void 0&&Ve!==0;)fe.charCodeAt(Ve-1)>>8&&(Un=!0),Ve--;if(!Un)return fe;for(sn=Be.noBOM?[]:[254,255],Ve=0,gt=fe.length;Ve<gt;Ve++){if((Qr=(li=fe.charCodeAt(Ve))>>8)>>8)throw new Error("Character at position "+Ve+" of string '"+fe+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");sn.push(Qr),sn.push(li-(Qr<<8))}return String.fromCharCode.apply(void 0,sn)})(T,Q).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Wo=S.__private__.beginPage=function(T){Ge[++An]=[],dn[An]={objId:0,contentsObjId:0,userUnit:Number(p),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(T[0]),topRightY:Number(T[1])}},ts(An),Ht(Ge[q])},Ri=function(T,Q){var fe,Be,Ve;switch(o=Q||o,typeof T=="string"&&(fe=g(T.toLowerCase()),Array.isArray(fe)&&(Be=fe[0],Ve=fe[1])),Array.isArray(T)&&(Be=T[0]*ct,Ve=T[1]*ct),isNaN(Be)&&(Be=l[0],Ve=l[1]),(Be>14400||Ve>14400)&&(lo.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Be=Math.min(14400,Be),Ve=Math.min(14400,Ve)),l=[Be,Ve],o.substr(0,1)){case"l":Ve>Be&&(l=[Ve,Be]);break;case"p":Be>Ve&&(l=[Ve,Be])}Wo(l),Pn(Ua),ge(Yo),jn!==0&&ge(jn+" J"),ta!==0&&ge(ta+" j"),ti.publish("addPage",{pageNumber:An})},Ds=function(T){T>0&&T<=An&&(Ge.splice(T,1),dn.splice(T,1),An--,q>An&&(q=An),this.setPage(q))},ts=function(T){T>0&&T<=An&&(q=T)},ns=S.__private__.getNumberOfPages=S.getNumberOfPages=function(){return Ge.length-1},xs=function(T,Q,fe){var Be,Ve=void 0;return fe=fe||{},T=T!==void 0?T:Ke[vn].fontName,Q=Q!==void 0?Q:Ke[vn].fontStyle,Be=T.toLowerCase(),vt[Be]!==void 0&&vt[Be][Q]!==void 0?Ve=vt[Be][Q]:vt[T]!==void 0&&vt[T][Q]!==void 0?Ve=vt[T][Q]:fe.disableWarning===!1&&lo.warn("Unable to look up font label for font '"+T+"', '"+Q+"'. Refer to getFontList() for available fonts."),Ve||fe.noFallback||(Ve=vt.times[Q])==null&&(Ve=vt.times.normal),Ve},Or=S.__private__.putInfo=function(){var T=hi(),Q=function(Be){return Be};for(var fe in C!==null&&(Q=co.encryptor(T,0)),ge("<<"),ge("/Producer ("+di(Q("jsPDF "+qn.version))+")"),Wt)Wt.hasOwnProperty(fe)&&Wt[fe]&&ge("/"+fe.substr(0,1).toUpperCase()+fe.substr(1)+" ("+di(Q(Wt[fe]))+")");ge("/CreationDate ("+di(Q(we))+")"),ge(">>"),ge("endobj")},Xs=S.__private__.putCatalog=function(T){var Q=(T=T||{}).rootDictionaryObjId||Ot;switch(hi(),ge("<<"),ge("/Type /Catalog"),ge("/Pages "+Q+" 0 R"),hn||(hn="fullwidth"),hn){case"fullwidth":ge("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ge("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ge("/OpenAction [3 0 R /Fit]");break;case"original":ge("/OpenAction [3 0 R /XYZ null null 1]");break;default:var fe=""+hn;fe.substr(fe.length-1)==="%"&&(hn=parseInt(hn)/100),typeof hn=="number"&&ge("/OpenAction [3 0 R /XYZ null null "+H(hn)+"]")}switch(tt||(tt="continuous"),tt){case"continuous":ge("/PageLayout /OneColumn");break;case"single":ge("/PageLayout /SinglePage");break;case"two":case"twoleft":ge("/PageLayout /TwoColumnLeft");break;case"tworight":ge("/PageLayout /TwoColumnRight")}Zt&&ge("/PageMode /"+Zt),ti.publish("putCatalog"),ge(">>"),ge("endobj")},Nr=S.__private__.putTrailer=function(){ge("trailer"),ge("<<"),ge("/Size "+(Ce+1)),ge("/Root "+Ce+" 0 R"),ge("/Info "+(Ce-1)+" 0 R"),C!==null&&ge("/Encrypt "+co.oid+" 0 R"),ge("/ID [ <"+te+"> <"+te+"> ]"),ge(">>")},Mi=S.__private__.putHeader=function(){ge("%PDF-"+U),ge("%")},fi=S.__private__.putXRef=function(){var T="0000000000";ge("xref"),ge("0 "+(Ce+1)),ge("0000000000 65535 f ");for(var Q=1;Q<=Ce;Q++)typeof le[Q]=="function"?ge((T+le[Q]()).slice(-10)+" 00000 n "):le[Q]!==void 0?ge((T+le[Q]).slice(-10)+" 00000 n "):ge("0000000000 00000 n ")},gr=S.__private__.buildDocument=function(){var T;Ce=0,be=0,_e=[],le=[],De=[],Ot=wt(),Dt=wt(),Ht(_e),ti.publish("buildDocument"),Mi(),Di(),(function(){ti.publish("putAdditionalObjects");for(var fe=0;fe<De.length;fe++){var Be=De[fe];Wn(Be.objId,!0),ge(Be.content),ge("endobj")}ti.publish("postPutAdditionalObjects")})(),T=[],(function(){for(var fe in Ke)Ke.hasOwnProperty(fe)&&(D===!1||D===!0&&M.hasOwnProperty(fe))&&qi(Ke[fe])})(),(function(){var fe;for(fe in Ft)Ft.hasOwnProperty(fe)&&ui(Ft[fe])})(),(function(){for(var fe in en)en.hasOwnProperty(fe)&&Br(en[fe])})(),(function(fe){var Be;for(Be in ht)ht.hasOwnProperty(Be)&&(ht[Be]instanceof bd?_i(ht[Be]):ht[Be]instanceof of&&ar(ht[Be],fe))})(T),ti.publish("putResources"),T.forEach(zo),zo({resourcesOid:Dt,objectOid:Number.MAX_SAFE_INTEGER}),ti.publish("postPutResources"),C!==null&&(co.oid=hi(),ge("<<"),ge("/Filter /Standard"),ge("/V "+co.v),ge("/R "+co.r),ge("/U <"+co.toHexString(co.U)+">"),ge("/O <"+co.toHexString(co.O)+">"),ge("/P "+co.P),ge(">>"),ge("endobj")),Or(),Xs();var Q=be;return fi(),Nr(),ge("startxref"),ge(""+Q),ge("%%EOF"),Ht(Ge[q]),_e.join(`
`)},is=S.__private__.getBlob=function(T){return new Blob([Yt(T)],{type:"application/pdf"})},Xl=S.output=S.__private__.output=(jr=function(T,Q){switch(typeof(Q=Q||{})=="string"?Q={filename:Q}:Q.filename=Q.filename||"generated.pdf",T){case void 0:return gr();case"save":S.save(Q.filename);break;case"arraybuffer":return Yt(gr());case"blob":return is(gr());case"bloburi":case"bloburl":if(ci.URL!==void 0&&typeof ci.URL.createObjectURL=="function")return ci.URL&&ci.URL.createObjectURL(is(gr()))||void 0;lo.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var fe="",Be=gr();try{fe=ky(Be)}catch{fe=ky(unescape(encodeURIComponent(Be)))}return"data:application/pdf;filename="+Q.filename+";base64,"+fe;case"pdfobjectnewwindow":if(Object.prototype.toString.call(ci)==="[object Window]"){var Ve="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",gt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Q.pdfObjectUrl&&(Ve=Q.pdfObjectUrl,gt="");var mt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ve+'"'+gt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Q)+");<\/script></body></html>",$t=ci.open();return $t!==null&&$t.document.write(mt),$t}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(ci)==="[object Window]"){var Kt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Q.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Q.filename+'" width="500px" height="400px" /></body></html>',sn=ci.open();if(sn!==null){sn.document.write(Kt);var Un=this;sn.document.documentElement.querySelector("#pdfViewer").onload=function(){sn.document.title=Q.filename,sn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Un.output("bloburl"))}}return sn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(ci)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var li='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Q)+'"></iframe></body></html>',Qr=ci.open();if(Qr!==null&&(Qr.document.write(li),Qr.document.title=Q.filename),Qr||typeof safari>"u")return Qr;break;case"datauri":case"dataurl":return ci.document.location.href=this.output("datauristring",Q);default:return null}},jr.foo=function(){try{return jr.apply(this,arguments)}catch(fe){var T=fe.stack||"";~T.indexOf(" at ")&&(T=T.split(" at ")[1]);var Q="Error in function "+T.split(`
`)[0].split("<")[0]+": "+fe.message;if(!ci.console)throw new Error(Q);ci.console.error(Q,fe),ci.alert&&alert(Q)}},jr.foo.bar=jr,jr.foo),bo=function(T){return Array.isArray(Tr)===!0&&Tr.indexOf(T)>-1};switch(s){case"pt":ct=1;break;case"mm":ct=72/25.4;break;case"cm":ct=72/2.54;break;case"in":ct=72;break;case"px":ct=bo("px_scaling")==1?.75:96/72;break;case"pc":case"em":ct=12;break;case"ex":ct=6;break;default:if(typeof s!="number")throw new Error("Invalid unit: "+s);ct=s}var co=null;k(),je();var Hi=S.__private__.getPageInfo=S.getPageInfo=function(T){if(isNaN(T)||T%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:dn[T].objId,pageNumber:T,pageContext:dn[T]}},Qo=S.__private__.getPageInfoByObjId=function(T){if(isNaN(T)||T%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Q in dn)if(dn[Q].objId===T)break;return Hi(Q)},Kl=S.__private__.getCurrentPageInfo=S.getCurrentPageInfo=function(){return{objId:dn[q].objId,pageNumber:q,pageContext:dn[q]}};S.addPage=function(){return Ri.apply(this,arguments),this},S.setPage=function(){return ts.apply(this,arguments),Ht.call(this,Ge[q]),this},S.insertPage=function(T){return this.addPage(),this.movePage(q,T),this},S.movePage=function(T,Q){var fe,Be;if(T>Q){fe=Ge[T],Be=dn[T];for(var Ve=T;Ve>Q;Ve--)Ge[Ve]=Ge[Ve-1],dn[Ve]=dn[Ve-1];Ge[Q]=fe,dn[Q]=Be,this.setPage(Q)}else if(T<Q){fe=Ge[T],Be=dn[T];for(var gt=T;gt<Q;gt++)Ge[gt]=Ge[gt+1],dn[gt]=dn[gt+1];Ge[Q]=fe,dn[Q]=Be,this.setPage(Q)}return this},S.deletePage=function(){return Ds.apply(this,arguments),this},S.__private__.text=S.text=function(T,Q,fe,Be,Ve){var gt,mt,$t,Kt,sn,Un,li,Qr,Bi,kr=(Be=Be||{}).scope||this;if(typeof T=="number"&&typeof Q=="number"&&(typeof fe=="string"||Array.isArray(fe))){var Ar=fe;fe=Q,Q=T,T=Ar}if(arguments[3]instanceof qt==0?($t=arguments[4],Kt=arguments[5],qr(li=arguments[3])==="object"&&li!==null||(typeof $t=="string"&&(Kt=$t,$t=null),typeof li=="string"&&(Kt=li,li=null),typeof li=="number"&&($t=li,li=null),Be={flags:li,angle:$t,align:Kt})):(F("The transform parameter of text() with a Matrix value"),Bi=Ve),isNaN(Q)||isNaN(fe)||T==null)throw new Error("Invalid arguments passed to jsPDF.text");if(T.length===0)return kr;var _o,Qi="",ya=typeof Be.lineHeightFactor=="number"?Be.lineHeightFactor:bs,Dr=kr.internal.scaleFactor;function xa(Ii){return Ii=Ii.split("	").join(Array(Be.TabLen||9).join(" ")),di(Ii,li)}function ma(Ii){for(var Fi,lr=Ii.concat(),So=[],cs=lr.length;cs--;)typeof(Fi=lr.shift())=="string"?So.push(Fi):Array.isArray(Ii)&&(Fi.length===1||Fi[1]===void 0&&Fi[2]===void 0)?So.push(Fi[0]):So.push([Fi[0],Fi[1],Fi[2]]);return So}function Ss(Ii,Fi){var lr;if(typeof Ii=="string")lr=Fi(Ii)[0];else if(Array.isArray(Ii)){for(var So,cs,tl=Ii.concat(),bc=[],nu=tl.length;nu--;)typeof(So=tl.shift())=="string"?bc.push(Fi(So)[0]):Array.isArray(So)&&typeof So[0]=="string"&&(cs=Fi(So[0],So[1],So[2]),bc.push([cs[0],cs[1],cs[2]]));lr=bc}return lr}var na=!1,Da=!0;if(typeof T=="string")na=!0;else if(Array.isArray(T)){var fo=T.concat();mt=[];for(var ba,Wi=fo.length;Wi--;)(typeof(ba=fo.shift())!="string"||Array.isArray(ba)&&typeof ba[0]!="string")&&(Da=!1);na=Da}if(na===!1)throw new Error('Type of text must be string or Array. "'+T+'" is not recognized.');typeof T=="string"&&(T=T.match(/[\r?\n]/)?T.split(/\r\n|\r|\n/g):[T]);var Ra=xt/kr.internal.scaleFactor,vo=Ra*(ya-1);switch(Be.baseline){case"bottom":fe-=vo;break;case"top":fe+=Ra-vo;break;case"hanging":fe+=Ra-2*vo;break;case"middle":fe+=Ra/2-vo}if((Un=Be.maxWidth||0)>0&&(typeof T=="string"?T=kr.splitTextToSize(T,Un):Object.prototype.toString.call(T)==="[object Array]"&&(T=T.reduce(function(Ii,Fi){return Ii.concat(kr.splitTextToSize(Fi,Un))},[]))),gt={text:T,x:Q,y:fe,options:Be,mutex:{pdfEscape:di,activeFontKey:vn,fonts:Ke,activeFontSize:xt}},ti.publish("preProcessText",gt),T=gt.text,$t=(Be=gt.options).angle,Bi instanceof qt==0&&$t&&typeof $t=="number"){$t*=Math.PI/180,Be.rotationDirection===0&&($t=-$t),E===V&&($t=-$t);var os=Math.cos($t),$i=Math.sin($t);Bi=new qt(os,$i,-$i,os,0,0)}else $t&&$t instanceof qt&&(Bi=$t);E!==V||Bi||(Bi=Ji),(sn=Be.charSpace||pn)!==void 0&&(Qi+=ee(Z(sn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Qr=Be.horizontalScale)!==void 0&&(Qi+=ee(100*Qr)+` Tz
`),Be.lang;var eo=-1,Tl=Be.renderingMode!==void 0?Be.renderingMode:Be.stroke,Ic=kr.internal.getCurrentPageInfo().pageContext;switch(Tl){case 0:case!1:case"fill":eo=0;break;case 1:case!0:case"stroke":eo=1;break;case 2:case"fillThenStroke":eo=2;break;case 3:case"invisible":eo=3;break;case 4:case"fillAndAddForClipping":eo=4;break;case 5:case"strokeAndAddPathForClipping":eo=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":eo=6;break;case 7:case"addToPathForClipping":eo=7}var Rs=Ic.usedRenderingMode!==void 0?Ic.usedRenderingMode:-1;eo!==-1?Qi+=eo+` Tr
`:Rs!==-1&&(Qi+=`0 Tr
`),eo!==-1&&(Ic.usedRenderingMode=eo),Kt=Be.align||"left";var Ia,as=xt*ya,Js=kr.internal.pageSize.getWidth(),Do=Ke[vn];sn=Be.charSpace||pn,Un=Be.maxWidth||0,li=Object.assign({autoencode:!0,noBOM:!0},Be.flags);var ss=[],po=function(Ii){return kr.getStringUnitWidth(Ii,{font:Do,charSpace:sn,fontSize:xt,doKerning:!1})*xt/Dr};if(Object.prototype.toString.call(T)==="[object Array]"){var Go;mt=ma(T),Kt!=="left"&&(Ia=mt.map(po));var Wr,Is=0;if(Kt==="right"){Q-=Ia[0],T=[],Wi=mt.length;for(var ia=0;ia<Wi;ia++)ia===0?(Wr=ga(Q),Go=wn(fe)):(Wr=Z(Is-Ia[ia]),Go=-as),T.push([mt[ia],Wr,Go]),Is=Ia[ia]}else if(Kt==="center"){Q-=Ia[0]/2,T=[],Wi=mt.length;for(var Qs=0;Qs<Wi;Qs++)Qs===0?(Wr=ga(Q),Go=wn(fe)):(Wr=Z((Is-Ia[Qs])/2),Go=-as),T.push([mt[Qs],Wr,Go]),Is=Ia[Qs]}else if(Kt==="left"){T=[],Wi=mt.length;for(var Ha=0;Ha<Wi;Ha++)T.push(mt[Ha])}else if(Kt==="justify"&&Do.encoding==="Identity-H"){T=[],Wi=mt.length,Un=Un!==0?Un:Js;for(var Jl=0,Jn=0;Jn<Wi;Jn++)if(Go=Jn===0?wn(fe):-as,Wr=Jn===0?ga(Q):Jl,Jn<Wi-1){var Ts=Z((Un-Ia[Jn])/(mt[Jn].split(" ").length-1)),Oi=mt[Jn].split(" ");T.push([Oi[0]+" ",Wr,Go]),Jl=0;for(var ra=1;ra<Oi.length;ra++){var Xo=(po(Oi[ra-1]+" "+Oi[ra])-po(Oi[ra]))*Dr+Ts;ra==Oi.length-1?T.push([Oi[ra],Xo,0]):T.push([Oi[ra]+" ",Xo,0]),Jl-=Xo}}else T.push([mt[Jn],Wr,Go]);T.push(["",Jl,0])}else{if(Kt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(T=[],Wi=mt.length,Un=Un!==0?Un:Js,Jn=0;Jn<Wi;Jn++){Go=Jn===0?wn(fe):-as,Wr=Jn===0?ga(Q):0;var va=mt[Jn].split(" ").length-1,Lc=va>0?(Un-Ia[Jn])/va:0;Jn<Wi-1?ss.push(ee(Z(Lc))):ss.push(0),T.push([mt[Jn],Wr,Go])}}}(typeof Be.R2L=="boolean"?Be.R2L:gn)===!0&&(T=Ss(T,function(Ii,Fi,lr){return[Ii.split("").reverse().join(""),Fi,lr]})),gt={text:T,x:Q,y:fe,options:Be,mutex:{pdfEscape:di,activeFontKey:vn,fonts:Ke,activeFontSize:xt}},ti.publish("postProcessText",gt),T=gt.text,_o=gt.mutex.isHex||!1;var el=Ke[vn].encoding;el!=="WinAnsiEncoding"&&el!=="StandardEncoding"||(T=Ss(T,function(Ii,Fi,lr){return[xa(Ii),Fi,lr]})),mt=ma(T),T=[];for(var Cl,jl,wo,Nl=Array.isArray(mt[0])?1:0,Ko="",Wa=function(Ii,Fi,lr){var So="";return lr instanceof qt?(lr=typeof Be.angle=="number"?Zi(lr,new qt(1,0,0,1,Ii,Fi)):Zi(new qt(1,0,0,1,Ii,Fi),lr),E===V&&(lr=Zi(new qt(1,0,0,-1,0,0),lr)),So=lr.join(" ")+` Tm
`):So=ee(Ii)+" "+ee(Fi)+` Td
`,So},sr=0;sr<mt.length;sr++){switch(Ko="",Nl){case 1:wo=(_o?"<":"(")+mt[sr][0]+(_o?">":")"),Cl=parseFloat(mt[sr][1]),jl=parseFloat(mt[sr][2]);break;case 0:wo=(_o?"<":"(")+mt[sr]+(_o?">":")"),Cl=ga(Q),jl=wn(fe)}ss!==void 0&&ss[sr]!==void 0&&(Ko=ss[sr]+` Tw
`),sr===0?T.push(Ko+Wa(Cl,jl,Bi)+wo):Nl===0?T.push(Ko+wo):Nl===1&&T.push(Ko+Wa(Cl,jl,Bi)+wo)}T=Nl===0?T.join(` Tj
T* `):T.join(` Tj
`),T+=` Tj
`;var ls=`BT
/`;return ls+=vn+" "+xt+` Tf
`,ls+=ee(xt*ya)+` TL
`,ls+=yn+`
`,ls+=Qi,ls+=T,ge(ls+="ET"),M[vn]=!0,kr};var ha=S.__private__.clip=S.clip=function(T){return ge(T==="evenodd"?"W*":"W"),this};S.clipEvenOdd=function(){return ha("evenodd")},S.__private__.discardPath=S.discardPath=function(){return ge("n"),this};var yr=S.__private__.isValidStyle=function(T){var Q=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(T)!==-1&&(Q=!0),Q};S.__private__.setDefaultPathOperation=S.setDefaultPathOperation=function(T){return yr(T)&&(m=T),this};var Zl=S.__private__.getStyle=S.getStyle=function(T){var Q=m;switch(T){case"D":case"S":Q="S";break;case"F":Q="f";break;case"FD":case"DF":Q="B";break;case"f":case"f*":case"B":case"B*":Q=T}return Q},Hr=S.close=function(){return ge("h"),this};S.stroke=function(){return ge("S"),this},S.fill=function(T){return ji("f",T),this},S.fillEvenOdd=function(T){return ji("f*",T),this},S.fillStroke=function(T){return ji("B",T),this},S.fillStrokeEvenOdd=function(T){return ji("B*",T),this};var ji=function(T,Q){qr(Q)==="object"?$o(Q,T):ge(T)},al=function(T){T===null||E===V&&T===void 0||(T=Zl(T),ge(T))};function Fa(T,Q,fe,Be,Ve){var gt=new of(Q||this.boundingBox,fe||this.xStep,Be||this.yStep,this.gState,Ve||this.matrix);gt.stream=this.stream;var mt=T+"$$"+this.cloneIndex+++"$$";return Cr(mt,gt),gt}var $o=function(T,Q){var fe=Je[T.key],Be=ht[fe];if(Be instanceof bd)ge("q"),ge(ms(Q)),Be.gState&&S.setGState(Be.gState),ge(T.matrix.toString()+" cm"),ge("/"+fe+" sh"),ge("Q");else if(Be instanceof of){var Ve=new qt(1,0,0,-1,0,ws());T.matrix&&(Ve=Ve.multiply(T.matrix||Ji),fe=Fa.call(Be,T.key,T.boundingBox,T.xStep,T.yStep,Ve).id),ge("q"),ge("/Pattern cs"),ge("/"+fe+" scn"),Be.gState&&S.setGState(Be.gState),ge(Q),ge("Q")}},ms=function(T){switch(T){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},za=S.moveTo=function(T,Q){return ge(ee(Z(T))+" "+ee(Y(Q))+" m"),this},ea=S.lineTo=function(T,Q){return ge(ee(Z(T))+" "+ee(Y(Q))+" l"),this},Jr=S.curveTo=function(T,Q,fe,Be,Ve,gt){return ge([ee(Z(T)),ee(Y(Q)),ee(Z(fe)),ee(Y(Be)),ee(Z(Ve)),ee(Y(gt)),"c"].join(" ")),this};S.__private__.line=S.line=function(T,Q,fe,Be,Ve){if(isNaN(T)||isNaN(Q)||isNaN(fe)||isNaN(Be)||!yr(Ve))throw new Error("Invalid arguments passed to jsPDF.line");return E===ae?this.lines([[fe-T,Be-Q]],T,Q,[1,1],Ve||"S"):this.lines([[fe-T,Be-Q]],T,Q,[1,1]).stroke()},S.__private__.lines=S.lines=function(T,Q,fe,Be,Ve,gt){var mt,$t,Kt,sn,Un,li,Qr,Bi,kr,Ar,_o,Qi;if(typeof T=="number"&&(Qi=fe,fe=Q,Q=T,T=Qi),Be=Be||[1,1],gt=gt||!1,isNaN(Q)||isNaN(fe)||!Array.isArray(T)||!Array.isArray(Be)||!yr(Ve)||typeof gt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(za(Q,fe),mt=Be[0],$t=Be[1],sn=T.length,Ar=Q,_o=fe,Kt=0;Kt<sn;Kt++)(Un=T[Kt]).length===2?(Ar=Un[0]*mt+Ar,_o=Un[1]*$t+_o,ea(Ar,_o)):(li=Un[0]*mt+Ar,Qr=Un[1]*$t+_o,Bi=Un[2]*mt+Ar,kr=Un[3]*$t+_o,Ar=Un[4]*mt+Ar,_o=Un[5]*$t+_o,Jr(li,Qr,Bi,kr,Ar,_o));return gt&&Hr(),al(Ve),this},S.path=function(T){for(var Q=0;Q<T.length;Q++){var fe=T[Q],Be=fe.c;switch(fe.op){case"m":za(Be[0],Be[1]);break;case"l":ea(Be[0],Be[1]);break;case"c":Jr.apply(this,Be);break;case"h":Hr()}}return this},S.__private__.rect=S.rect=function(T,Q,fe,Be,Ve){if(isNaN(T)||isNaN(Q)||isNaN(fe)||isNaN(Be)||!yr(Ve))throw new Error("Invalid arguments passed to jsPDF.rect");return E===ae&&(Be=-Be),ge([ee(Z(T)),ee(Y(Q)),ee(Z(fe)),ee(Z(Be)),"re"].join(" ")),al(Ve),this},S.__private__.triangle=S.triangle=function(T,Q,fe,Be,Ve,gt,mt){if(isNaN(T)||isNaN(Q)||isNaN(fe)||isNaN(Be)||isNaN(Ve)||isNaN(gt)||!yr(mt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[fe-T,Be-Q],[Ve-fe,gt-Be],[T-Ve,Q-gt]],T,Q,[1,1],mt,!0),this},S.__private__.roundedRect=S.roundedRect=function(T,Q,fe,Be,Ve,gt,mt){if(isNaN(T)||isNaN(Q)||isNaN(fe)||isNaN(Be)||isNaN(Ve)||isNaN(gt)||!yr(mt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var $t=4/3*(Math.SQRT2-1);return Ve=Math.min(Ve,.5*fe),gt=Math.min(gt,.5*Be),this.lines([[fe-2*Ve,0],[Ve*$t,0,Ve,gt-gt*$t,Ve,gt],[0,Be-2*gt],[0,gt*$t,-Ve*$t,gt,-Ve,gt],[2*Ve-fe,0],[-Ve*$t,0,-Ve,-gt*$t,-Ve,-gt],[0,2*gt-Be],[0,-gt*$t,Ve*$t,-gt,Ve,-gt]],T+Ve,Q,[1,1],mt,!0),this},S.__private__.ellipse=S.ellipse=function(T,Q,fe,Be,Ve){if(isNaN(T)||isNaN(Q)||isNaN(fe)||isNaN(Be)||!yr(Ve))throw new Error("Invalid arguments passed to jsPDF.ellipse");var gt=4/3*(Math.SQRT2-1)*fe,mt=4/3*(Math.SQRT2-1)*Be;return za(T+fe,Q),Jr(T+fe,Q-mt,T+gt,Q-Be,T,Q-Be),Jr(T-gt,Q-Be,T-fe,Q-mt,T-fe,Q),Jr(T-fe,Q+mt,T-gt,Q+Be,T,Q+Be),Jr(T+gt,Q+Be,T+fe,Q+mt,T+fe,Q),al(Ve),this},S.__private__.circle=S.circle=function(T,Q,fe,Be){if(isNaN(T)||isNaN(Q)||isNaN(fe)||!yr(Be))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(T,Q,fe,fe,Be)},S.setFont=function(T,Q,fe){return fe&&(Q=G(Q,fe)),vn=xs(T,Q,{disableWarning:!1}),this};var xr=S.__private__.getFont=S.getFont=function(){return Ke[xs.apply(S,arguments)]};S.__private__.getFontList=S.getFontList=function(){var T,Q,fe={};for(T in vt)if(vt.hasOwnProperty(T))for(Q in fe[T]=[],vt[T])vt[T].hasOwnProperty(Q)&&fe[T].push(Q);return fe},S.addFont=function(T,Q,fe,Be,Ve){var gt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&gt.indexOf(arguments[3])!==-1?Ve=arguments[3]:arguments[3]&&gt.indexOf(arguments[3])==-1&&(fe=G(fe,Be)),ys.call(this,T,Q,fe,Ve=Ve||"Identity-H")};var bs,Ua=n.lineWidth||.200025,Ks=S.__private__.getLineWidth=S.getLineWidth=function(){return Ua},Pn=S.__private__.setLineWidth=S.setLineWidth=function(T){return Ua=T,ge(ee(Z(T))+" w"),this};S.__private__.setLineDash=qn.API.setLineDash=qn.API.setLineDashPattern=function(T,Q){if(T=T||[],Q=Q||0,isNaN(Q)||!Array.isArray(T))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return T=T.map(function(fe){return ee(Z(fe))}).join(" "),Q=ee(Z(Q)),ge("["+T+"] "+Q+" d"),this};var Tt=S.__private__.getLineHeight=S.getLineHeight=function(){return xt*bs};S.__private__.getLineHeight=S.getLineHeight=function(){return xt*bs};var Zn=S.__private__.setLineHeightFactor=S.setLineHeightFactor=function(T){return typeof(T=T||1.15)=="number"&&(bs=T),this},Ea=S.__private__.getLineHeightFactor=S.getLineHeightFactor=function(){return bs};Zn(n.lineHeight);var ga=S.__private__.getHorizontalCoordinate=function(T){return Z(T)},wn=S.__private__.getVerticalCoordinate=function(T){return E===V?T:dn[q].mediaBox.topRightY-dn[q].mediaBox.bottomLeftY-Z(T)},Cn=S.__private__.getHorizontalCoordinateString=S.getHorizontalCoordinateString=function(T){return ee(ga(T))},sl=S.__private__.getVerticalCoordinateString=S.getVerticalCoordinateString=function(T){return ee(wn(T))},Yo=n.strokeColor||"0 G";S.__private__.getStrokeColor=S.getDrawColor=function(){return an(Yo)},S.__private__.setStrokeColor=S.setDrawColor=function(T,Q,fe,Be){return Yo=rn({ch1:T,ch2:Q,ch3:fe,ch4:Be,pdfColorType:"draw",precision:2}),ge(Yo),this};var Fn=n.fillColor||"0 g";S.__private__.getFillColor=S.getFillColor=function(){return an(Fn)},S.__private__.setFillColor=S.setFillColor=function(T,Q,fe,Be){return Fn=rn({ch1:T,ch2:Q,ch3:fe,ch4:Be,pdfColorType:"fill",precision:2}),ge(Fn),this};var yn=n.textColor||"0 g",Ni=S.__private__.getTextColor=S.getTextColor=function(){return an(yn)};S.__private__.setTextColor=S.setTextColor=function(T,Q,fe,Be){return yn=rn({ch1:T,ch2:Q,ch3:fe,ch4:Be,pdfColorType:"text",precision:3}),this};var pn=n.charSpace,vi=S.__private__.getCharSpace=S.getCharSpace=function(){return parseFloat(pn||0)};S.__private__.setCharSpace=S.setCharSpace=function(T){if(isNaN(T))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return pn=T,this};var jn=0;S.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},S.__private__.setLineCap=S.setLineCap=function(T){var Q=S.CapJoinStyles[T];if(Q===void 0)throw new Error("Line cap style of '"+T+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return jn=Q,ge(Q+" J"),this};var ta=0;S.__private__.setLineJoin=S.setLineJoin=function(T){var Q=S.CapJoinStyles[T];if(Q===void 0)throw new Error("Line join style of '"+T+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ta=Q,ge(Q+" j"),this},S.__private__.setLineMiterLimit=S.__private__.setMiterLimit=S.setLineMiterLimit=S.setMiterLimit=function(T){if(T=T||0,isNaN(T))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ge(ee(Z(T))+" M"),this},S.GState=xh,S.setGState=function(T){(T=typeof T=="string"?Ft[At[T]]:Qt(null,T)).equals(Jt)||(ge("/"+T.id+" gs"),Jt=T)};var Qt=function(T,Q){if(!T||!At[T]){var fe=!1;for(var Be in Ft)if(Ft.hasOwnProperty(Be)&&Ft[Be].equals(Q)){fe=!0;break}if(fe)Q=Ft[Be];else{var Ve="GS"+(Object.keys(Ft).length+1).toString(10);Ft[Ve]=Q,Q.id=Ve}return T&&(At[T]=Q.id),ti.publish("addGState",Q),Q}};S.addGState=function(T,Q){return Qt(T,Q),this},S.saveGraphicsState=function(){return ge("q"),Vt.push({key:vn,size:xt,color:yn}),this},S.restoreGraphicsState=function(){ge("Q");var T=Vt.pop();return vn=T.key,xt=T.size,yn=T.color,Jt=null,this},S.setCurrentTransformationMatrix=function(T){return ge(T.toString()+" cm"),this},S.comment=function(T){return ge("#"+T),this};var ri=function(T,Q){var fe=T||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return fe},set:function(gt){isNaN(gt)||(fe=parseFloat(gt))}});var Be=Q||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Be},set:function(gt){isNaN(gt)||(Be=parseFloat(gt))}});var Ve="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ve},set:function(gt){Ve=gt.toString()}}),this},tn=function(T,Q,fe,Be){ri.call(this,T,Q),this.type="rect";var Ve=fe||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ve},set:function(mt){isNaN(mt)||(Ve=parseFloat(mt))}});var gt=Be||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return gt},set:function(mt){isNaN(mt)||(gt=parseFloat(mt))}}),this},wi=function(){this.page=An,this.currentPage=q,this.pages=Ge.slice(0),this.pagesContext=dn.slice(0),this.x=ye,this.y=ze,this.matrix=Nt,this.width=uo(q),this.height=vs(q),this.outputDestination=jt,this.id="",this.objectNumber=-1};wi.prototype.restore=function(){An=this.page,q=this.currentPage,dn=this.pagesContext,Ge=this.pages,ye=this.x,ze=this.y,Nt=this.matrix,_a(q,this.width),rs(q,this.height),jt=this.outputDestination};var Va=function(T,Q,fe,Be,Ve){Mr.push(new wi),An=q=0,Ge=[],ye=T,ze=Q,Nt=Ve,Wo([fe,Be])};for(var qa in S.beginFormObject=function(T,Q,fe,Be,Ve){return Va(T,Q,fe,Be,Ve),this},S.endFormObject=function(T){return(function(Q){if(zi[Q])Mr.pop().restore();else{var fe=new wi,Be="Xo"+(Object.keys(en).length+1).toString(10);fe.id=Be,zi[Q]=Be,en[Be]=fe,ti.publish("addFormObject",fe),Mr.pop().restore()}})(T),this},S.doFormObject=function(T,Q){var fe=en[zi[T]];return ge("q"),ge(Q.toString()+" cm"),ge("/"+fe.id+" Do"),ge("Q"),this},S.getFormObject=function(T){var Q=en[zi[T]];return{x:Q.x,y:Q.y,width:Q.width,height:Q.height,matrix:Q.matrix}},S.save=function(T,Q){return T=T||"generated.pdf",(Q=Q||{}).returnPromise=Q.returnPromise||!1,Q.returnPromise===!1?(md(is(gr()),T),typeof md.unload=="function"&&ci.setTimeout&&setTimeout(md.unload,911),this):new Promise(function(fe,Be){try{var Ve=md(is(gr()),T);typeof md.unload=="function"&&ci.setTimeout&&setTimeout(md.unload,911),fe(Ve)}catch(gt){Be(gt.message)}})},qn.API)qn.API.hasOwnProperty(qa)&&(qa==="events"&&qn.API.events.length?(function(T,Q){var fe,Be,Ve;for(Ve=Q.length-1;Ve!==-1;Ve--)fe=Q[Ve][0],Be=Q[Ve][1],T.subscribe.apply(T,[fe].concat(typeof Be=="function"?[Be]:Be))})(ti,qn.API.events):S[qa]=qn.API[qa]);function uo(T){return dn[T].mediaBox.topRightX-dn[T].mediaBox.bottomLeftX}function _a(T,Q){dn[T].mediaBox.topRightX=Q+dn[T].mediaBox.bottomLeftX}function vs(T){return dn[T].mediaBox.topRightY-dn[T].mediaBox.bottomLeftY}function rs(T,Q){dn[T].mediaBox.topRightY=Q+dn[T].mediaBox.bottomLeftY}var Zs=S.getPageWidth=function(T){return uo(T=T||q)/ct},eu=S.setPageWidth=function(T,Q){_a(T,Q*ct)},ws=S.getPageHeight=function(T){return vs(T=T||q)/ct},tu=S.setPageHeight=function(T,Q){rs(T,Q*ct)};return S.internal={pdfEscape:di,getStyle:Zl,getFont:xr,getFontSize:Et,getCharSpace:vi,getTextColor:Ni,getLineHeight:Tt,getLineHeightFactor:Ea,getLineWidth:Ks,write:lt,getHorizontalCoordinate:ga,getVerticalCoordinate:wn,getCoordinateString:Cn,getVerticalCoordinateString:sl,collections:{},newObject:hi,newAdditionalObject:mn,newObjectDeferred:wt,newObjectDeferredBegin:Wn,getFilters:bn,putStream:ni,events:ti,scaleFactor:ct,pageSize:{getWidth:function(){return Zs(q)},setWidth:function(T){eu(q,T)},getHeight:function(){return ws(q)},setHeight:function(T){tu(q,T)}},encryptionOptions:C,encryption:co,getEncryptor:function(T){return C!==null?co.encryptor(T,0):function(Q){return Q}},output:Xl,getNumberOfPages:ns,get pages(){return Ge},out:ge,f2:H,f3:R,getPageInfo:Hi,getPageInfoByObjId:Qo,getCurrentPageInfo:Kl,getPDFVersion:_,Point:ri,Rectangle:tn,Matrix:qt,hasHotfix:bo},Object.defineProperty(S.internal.pageSize,"width",{get:function(){return Zs(q)},set:function(T){eu(q,T)},enumerable:!0,configurable:!0}),Object.defineProperty(S.internal.pageSize,"height",{get:function(){return ws(q)},set:function(T){tu(q,T)},enumerable:!0,configurable:!0}),(function(T){for(var Q=0,fe=Gt.length;Q<fe;Q++){var Be=ys.call(this,T[Q][0],T[Q][1],T[Q][2],Gt[Q][3],!0);D===!1&&(M[Be]=!0);var Ve=T[Q][0].split("-");Hn({id:Be,fontName:Ve[0],fontStyle:Ve[1]||""})}ti.publish("addFonts",{fonts:Ke,dictionary:vt})}).call(S,Gt),vn="F1",Ri(l,o),ti.publish("initialized"),S}nf.prototype.lsbFirstWord=function(n){return String.fromCharCode(255&n,n>>8&255,n>>16&255,n>>24&255)},nf.prototype.toHexString=function(n){return n.split("").map(function(r){return("0"+(255&r.charCodeAt(0)).toString(16)).slice(-2)}).join("")},nf.prototype.hexToBytes=function(n){for(var r=[],o=0;o<n.length;o+=2)r.push(String.fromCharCode(parseInt(n.substr(o,2),16)));return r.join("")},nf.prototype.processOwnerPassword=function(n,r){return n0(t0(r).substr(0,5),n)},nf.prototype.encryptor=function(n,r){var o=t0(this.encryptionKey+String.fromCharCode(255&n,n>>8&255,n>>16&255,255&r,r>>8&255)).substr(0,10);return function(s){return n0(o,s)}},xh.prototype.equals=function(n){var r,o="id,objectNumber,equals";if(!n||qr(n)!==qr(this))return!1;var s=0;for(r in this)if(!(o.indexOf(r)>=0)){if(this.hasOwnProperty(r)&&!n.hasOwnProperty(r)||this[r]!==n[r])return!1;s++}for(r in n)n.hasOwnProperty(r)&&o.indexOf(r)<0&&s--;return s===0},qn.API={events:[]},qn.version="3.0.4";var pa=qn.API,f0=1,jd=function(n){return n.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Qd=function(n){return n.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},bi=function(n){return n.toFixed(2)},Hu=function(n){return n.toFixed(5)};pa.__acroform__={};var Sl=function(n,r){n.prototype=Object.create(r.prototype),n.prototype.constructor=n},_y=function(n){return n*f0},Xc=function(n){var r=new Yx,o=kn.internal.getHeight(n)||0,s=kn.internal.getWidth(n)||0;return r.BBox=[0,0,Number(bi(s)),Number(bi(o))],r},v5=pa.__acroform__.setBit=function(n,r){if(n=n||0,r=r||0,isNaN(n)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return n|1<<r},w5=pa.__acroform__.clearBit=function(n,r){if(n=n||0,r=r||0,isNaN(n)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return n&~(1<<r)},S5=pa.__acroform__.getBit=function(n,r){if(isNaN(n)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return n&1<<r?1:0},ka=pa.__acroform__.getBitForPdf=function(n,r){if(isNaN(n)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return S5(n,r-1)},Aa=pa.__acroform__.setBitForPdf=function(n,r){if(isNaN(n)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return v5(n,r-1)},Pa=pa.__acroform__.clearBitForPdf=function(n,r){if(isNaN(n)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return w5(n,r-1)},T5=pa.__acroform__.calculateCoordinates=function(n,r){var o=r.internal.getHorizontalCoordinate,s=r.internal.getVerticalCoordinate,l=n[0],d=n[1],b=n[2],p=n[3],v={};return v.lowerLeft_X=o(l)||0,v.lowerLeft_Y=s(d+p)||0,v.upperRight_X=o(l+b)||0,v.upperRight_Y=s(d)||0,[Number(bi(v.lowerLeft_X)),Number(bi(v.lowerLeft_Y)),Number(bi(v.upperRight_X)),Number(bi(v.upperRight_Y))]},C5=function(n){if(n.appearanceStreamContent)return n.appearanceStreamContent;if(n.V||n.DV){var r=[],o=n._V||n.DV,s=i0(n,o),l=n.scope.internal.getFont(n.fontName,n.fontStyle).id;r.push("/Tx BMC"),r.push("q"),r.push("BT"),r.push(n.scope.__private__.encodeColorString(n.color)),r.push("/"+l+" "+bi(s.fontSize)+" Tf"),r.push("1 0 0 1 0 0 Tm"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC");var d=Xc(n);return d.scope=n.scope,d.stream=r.join(`
`),d}},i0=function(n,r){var o=n.fontSize===0?n.maxFontSize:n.fontSize,s={text:"",fontSize:""},l=(r=(r=r.substr(0,1)=="("?r.substr(1):r).substr(r.length-1)==")"?r.substr(0,r.length-1):r).split(" ");l=n.multiline?l.map(function(H){return H.split(`
`)}):l.map(function(H){return[H]});var d=o,b=kn.internal.getHeight(n)||0;b=b<0?-b:b;var p=kn.internal.getWidth(n)||0;p=p<0?-p:p;var v=function(H,R,Z){if(H+1<l.length){var Y=R+" "+l[H+1][0];return oh(Y,n,Z).width<=p-4}return!1};d++;e:for(;d>0;){r="",d--;var m,C,D=oh("3",n,d).height,M=n.multiline?b-d:(b-D)/2,S=M+=2,U=0,_=0,N=0;if(d<=0){r=`(...) Tj
`,r+="% Width of Text: "+oh(r,n,d=12).width+", FieldWidth:"+p+`
`;break}for(var g="",ae=0,V=0;V<l.length;V++)if(l.hasOwnProperty(V)){var E=!1;if(l[V].length!==1&&N!==l[V].length-1){if((D+2)*(ae+2)+2>b)continue e;g+=l[V][N],E=!0,_=V,V--}else{g=(g+=l[V][N]+" ").substr(g.length-1)==" "?g.substr(0,g.length-1):g;var re=parseInt(V),J=v(re,g,d),G=V>=l.length-1;if(J&&!G){g+=" ",N=0;continue}if(J||G){if(G)_=re;else if(n.multiline&&(D+2)*(ae+2)+2>b)continue e}else{if(!n.multiline||(D+2)*(ae+2)+2>b)continue e;_=re}}for(var ee="",F=U;F<=_;F++){var $=l[F];if(n.multiline){if(F===_){ee+=$[N]+" ",N=(N+1)%$.length;continue}if(F===U){ee+=$[$.length-1]+" ";continue}}ee+=$[0]+" "}switch(ee=ee.substr(ee.length-1)==" "?ee.substr(0,ee.length-1):ee,C=oh(ee,n,d).width,n.textAlign){case"right":m=p-C-2;break;case"center":m=(p-C)/2;break;default:m=2}r+=bi(m)+" "+bi(S)+` Td
`,r+="("+jd(ee)+`) Tj
`,r+=-bi(m)+` 0 Td
`,S=-(d+2),C=0,U=E?_:_+1,ae++,g=""}break}return s.text=r,s.fontSize=d,s},oh=function(n,r,o){var s=r.scope.internal.getFont(r.fontName,r.fontStyle),l=r.scope.getStringUnitWidth(n,{font:s,fontSize:parseFloat(o),charSpace:0})*parseFloat(o);return{height:r.scope.getStringUnitWidth("3",{font:s,fontSize:parseFloat(o),charSpace:0})*parseFloat(o)*1.5,width:l}},j5={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},N5=function(n,r){var o={type:"reference",object:n};r.internal.getPageInfo(n.page).pageContext.annotations.find(function(s){return s.type===o.type&&s.object===o.object})===void 0&&r.internal.getPageInfo(n.page).pageContext.annotations.push(o)},k5=function(n,r){if(r.scope=n,n.internal!==void 0&&(n.internal.acroformPlugin===void 0||n.internal.acroformPlugin.isInitialized===!1)){if(Dc.FieldNum=0,n.internal.acroformPlugin=JSON.parse(JSON.stringify(j5)),n.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");f0=n.internal.scaleFactor,n.internal.acroformPlugin.acroFormDictionaryRoot=new Gx,n.internal.acroformPlugin.acroFormDictionaryRoot.scope=n,n.internal.acroformPlugin.acroFormDictionaryRoot._eventID=n.internal.events.subscribe("postPutResources",function(){(function(o){o.internal.events.unsubscribe(o.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete o.internal.acroformPlugin.acroFormDictionaryRoot._eventID,o.internal.acroformPlugin.printedOut=!0})(n)}),n.internal.events.subscribe("buildDocument",function(){(function(o){o.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var s=o.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var l in s)if(s.hasOwnProperty(l)){var d=s[l];d.objId=void 0,d.hasAnnotation&&N5(d,o)}})(n)}),n.internal.events.subscribe("putCatalog",function(){(function(o){if(o.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");o.internal.write("/AcroForm "+o.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(n)}),n.internal.events.subscribe("postPutPages",function(o){(function(s,l){var d=!s;for(var b in s||(l.internal.newObjectDeferredBegin(l.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),l.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),s=s||l.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(s.hasOwnProperty(b)){var p=s[b],v=[],m=p.Rect;if(p.Rect&&(p.Rect=T5(p.Rect,l)),l.internal.newObjectDeferredBegin(p.objId,!0),p.DA=kn.createDefaultAppearanceStream(p),qr(p)==="object"&&typeof p.getKeyValueListForStream=="function"&&(v=p.getKeyValueListForStream()),p.Rect=m,p.hasAppearanceStream&&!p.appearanceStreamContent){var C=C5(p);v.push({key:"AP",value:"<</N "+C+">>"}),l.internal.acroformPlugin.xForms.push(C)}if(p.appearanceStreamContent){var D="";for(var M in p.appearanceStreamContent)if(p.appearanceStreamContent.hasOwnProperty(M)){var S=p.appearanceStreamContent[M];if(D+="/"+M+" ",D+="<<",Object.keys(S).length>=1||Array.isArray(S)){for(var b in S)if(S.hasOwnProperty(b)){var U=S[b];typeof U=="function"&&(U=U.call(l,p)),D+="/"+b+" "+U+" ",l.internal.acroformPlugin.xForms.indexOf(U)>=0||l.internal.acroformPlugin.xForms.push(U)}}else typeof(U=S)=="function"&&(U=U.call(l,p)),D+="/"+b+" "+U,l.internal.acroformPlugin.xForms.indexOf(U)>=0||l.internal.acroformPlugin.xForms.push(U);D+=">>"}v.push({key:"AP",value:`<<
`+D+">>"})}l.internal.putStream({additionalKeyValues:v,objectId:p.objId}),l.internal.out("endobj")}d&&(function(_,N){for(var g in _)if(_.hasOwnProperty(g)){var ae=g,V=_[g];N.internal.newObjectDeferredBegin(V.objId,!0),qr(V)==="object"&&typeof V.putStream=="function"&&V.putStream(),delete _[ae]}})(l.internal.acroformPlugin.xForms,l)})(o,n)}),n.internal.acroformPlugin.isInitialized=!0}},$x=pa.__acroform__.arrayToPdfArray=function(n,r,o){var s=function(b){return b};if(Array.isArray(n)){for(var l="[",d=0;d<n.length;d++)switch(d!==0&&(l+=" "),qr(n[d])){case"boolean":case"number":case"object":l+=n[d].toString();break;case"string":n[d].substr(0,1)!=="/"?(r!==void 0&&o&&(s=o.internal.getEncryptor(r)),l+="("+jd(s(n[d].toString()))+")"):l+=n[d].toString()}return l+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Mg=function(n,r,o){var s=function(l){return l};return r!==void 0&&o&&(s=o.internal.getEncryptor(r)),(n=n||"").toString(),"("+jd(s(n))+")"},Jc=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(n){this._objId=n}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Jc.prototype.toString=function(){return this.objId+" 0 R"},Jc.prototype.putStream=function(){var n=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:n,objectId:this.objId}),this.scope.internal.out("endobj")},Jc.prototype.getKeyValueListForStream=function(){var n=[],r=Object.getOwnPropertyNames(this).filter(function(d){return d!="content"&&d!="appearanceStreamContent"&&d!="scope"&&d!="objId"&&d.substring(0,1)!="_"});for(var o in r)if(Object.getOwnPropertyDescriptor(this,r[o]).configurable===!1){var s=r[o],l=this[s];l&&(Array.isArray(l)?n.push({key:s,value:$x(l,this.objId,this.scope)}):l instanceof Jc?(l.scope=this.scope,n.push({key:s,value:l.objId+" 0 R"})):typeof l!="function"&&n.push({key:s,value:l}))}return n};var Yx=function(){Jc.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var n,r=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return r},set:function(o){r=o}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(o){n=o.trim()},get:function(){return n||null}})};Sl(Yx,Jc);var Gx=function(){Jc.call(this);var n,r=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return r.length>0?r:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return r}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(n){var o=function(s){return s};return this.scope&&(o=this.scope.internal.getEncryptor(this.objId)),"("+jd(o(n))+")"}},set:function(o){n=o}})};Sl(Gx,Jc);var Dc=function n(){Jc.call(this);var r=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return r},set:function(g){if(isNaN(g))throw new Error('Invalid value "'+g+'" for attribute F supplied.');r=g}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!ka(r,3)},set:function(g){g?this.F=Aa(r,3):this.F=Pa(r,3)}});var o=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return o},set:function(g){if(isNaN(g))throw new Error('Invalid value "'+g+'" for attribute Ff supplied.');o=g}});var s=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(s.length!==0)return s},set:function(g){s=g!==void 0?g:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[0])?0:s[0]},set:function(g){s[0]=g}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[1])?0:s[1]},set:function(g){s[1]=g}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[2])?0:s[2]},set:function(g){s[2]=g}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[3])?0:s[3]},set:function(g){s[3]=g}});var l="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return l},set:function(g){switch(g){case"/Btn":case"/Tx":case"/Ch":case"/Sig":l=g;break;default:throw new Error('Invalid value "'+g+'" for attribute FT supplied.')}}});var d=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!d||d.length<1){if(this instanceof mh)return;d="FieldObject"+n.FieldNum++}var g=function(ae){return ae};return this.scope&&(g=this.scope.internal.getEncryptor(this.objId)),"("+jd(g(d))+")"},set:function(g){d=g.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return d},set:function(g){d=g}});var b="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return b},set:function(g){b=g}});var p="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return p},set:function(g){p=g}});var v=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return v},set:function(g){v=g}});var m=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return m===void 0?50/f0:m},set:function(g){m=g}});var C="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return C},set:function(g){C=g}});var D="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!D||this instanceof mh||this instanceof wd))return Mg(D,this.objId,this.scope)},set:function(g){g=g.toString(),D=g}});var M=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(M)return this instanceof gs==0?Mg(M,this.objId,this.scope):M},set:function(g){g=g.toString(),M=this instanceof gs==0?g.substr(0,1)==="("?Qd(g.substr(1,g.length-2)):Qd(g):g}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof gs==1?Qd(M.substr(1,M.length-1)):M},set:function(g){g=g.toString(),M=this instanceof gs==1?"/"+g:g}});var S=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(S)return S},set:function(g){this.V=g}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(S)return this instanceof gs==0?Mg(S,this.objId,this.scope):S},set:function(g){g=g.toString(),S=this instanceof gs==0?g.substr(0,1)==="("?Qd(g.substr(1,g.length-2)):Qd(g):g}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof gs==1?Qd(S.substr(1,S.length-1)):S},set:function(g){g=g.toString(),S=this instanceof gs==1?"/"+g:g}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var U,_=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return _},set:function(g){g=!!g,_=g}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(U)return U},set:function(g){U=g}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!ka(this.Ff,1)},set:function(g){g?this.Ff=Aa(this.Ff,1):this.Ff=Pa(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!ka(this.Ff,2)},set:function(g){g?this.Ff=Aa(this.Ff,2):this.Ff=Pa(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!ka(this.Ff,3)},set:function(g){g?this.Ff=Aa(this.Ff,3):this.Ff=Pa(this.Ff,3)}});var N=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(N!==null)return N},set:function(g){if([0,1,2].indexOf(g)===-1)throw new Error('Invalid value "'+g+'" for attribute Q supplied.');N=g}}),Object.defineProperty(this,"textAlign",{get:function(){var g;switch(N){case 0:default:g="left";break;case 1:g="center";break;case 2:g="right"}return g},configurable:!0,enumerable:!0,set:function(g){switch(g){case"right":case 2:N=2;break;case"center":case 1:N=1;break;default:N=0}}})};Sl(Dc,Jc);var sf=function(){Dc.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var n=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return n},set:function(o){n=o}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return n},set:function(o){n=o}});var r=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return $x(r,this.objId,this.scope)},set:function(o){var s,l;l=[],typeof(s=o)=="string"&&(l=(function(d,b,p){p||(p=1);for(var v,m=[];v=b.exec(d);)m.push(v[p]);return m})(s,/\((.*?)\)/g)),r=l}}),this.getOptions=function(){return r},this.setOptions=function(o){r=o,this.sort&&r.sort()},this.addOption=function(o){o=(o=o||"").toString(),r.push(o),this.sort&&r.sort()},this.removeOption=function(o,s){for(s=s||!1,o=(o=o||"").toString();r.indexOf(o)!==-1&&(r.splice(r.indexOf(o),1),s!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!ka(this.Ff,18)},set:function(o){o?this.Ff=Aa(this.Ff,18):this.Ff=Pa(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!ka(this.Ff,19)},set:function(o){this.combo===!0&&(o?this.Ff=Aa(this.Ff,19):this.Ff=Pa(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!ka(this.Ff,20)},set:function(o){o?(this.Ff=Aa(this.Ff,20),r.sort()):this.Ff=Pa(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!ka(this.Ff,22)},set:function(o){o?this.Ff=Aa(this.Ff,22):this.Ff=Pa(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ka(this.Ff,23)},set:function(o){o?this.Ff=Aa(this.Ff,23):this.Ff=Pa(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!ka(this.Ff,27)},set:function(o){o?this.Ff=Aa(this.Ff,27):this.Ff=Pa(this.Ff,27)}}),this.hasAppearanceStream=!1};Sl(sf,Dc);var lf=function(){sf.call(this),this.fontName="helvetica",this.combo=!1};Sl(lf,sf);var cf=function(){lf.call(this),this.combo=!0};Sl(cf,lf);var uh=function(){cf.call(this),this.edit=!0};Sl(uh,cf);var gs=function(){Dc.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!ka(this.Ff,15)},set:function(o){o?this.Ff=Aa(this.Ff,15):this.Ff=Pa(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!ka(this.Ff,16)},set:function(o){o?this.Ff=Aa(this.Ff,16):this.Ff=Pa(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!ka(this.Ff,17)},set:function(o){o?this.Ff=Aa(this.Ff,17):this.Ff=Pa(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!ka(this.Ff,26)},set:function(o){o?this.Ff=Aa(this.Ff,26):this.Ff=Pa(this.Ff,26)}});var n,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var o=function(d){return d};if(this.scope&&(o=this.scope.internal.getEncryptor(this.objId)),Object.keys(r).length!==0){var s,l=[];for(s in l.push("<<"),r)l.push("/"+s+" ("+jd(o(r[s]))+")");return l.push(">>"),l.join(`
`)}},set:function(o){qr(o)==="object"&&(r=o)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(o){typeof o=="string"&&(r.CA=o)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(o){n=o}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(o){n="/"+o}})};Sl(gs,Dc);var dh=function(){gs.call(this),this.pushButton=!0};Sl(dh,gs);var uf=function(){gs.call(this),this.radio=!0,this.pushButton=!1;var n=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return n},set:function(r){n=r!==void 0?r:[]}})};Sl(uf,gs);var mh=function(){var n,r;Dc.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return n},set:function(l){n=l}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return r},set:function(l){r=l}});var o,s={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var l=function(p){return p};this.scope&&(l=this.scope.internal.getEncryptor(this.objId));var d,b=[];for(d in b.push("<<"),s)b.push("/"+d+" ("+jd(l(s[d]))+")");return b.push(">>"),b.join(`
`)},set:function(l){qr(l)==="object"&&(s=l)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return s.CA||""},set:function(l){typeof l=="string"&&(s.CA=l)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return o.substr(1,o.length-1)},set:function(l){o="/"+l}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=kn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Sl(mh,Dc),uf.prototype.setAppearance=function(n){if(!("createAppearanceStream"in n)||!("getCA"in n))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var r in this.Kids)if(this.Kids.hasOwnProperty(r)){var o=this.Kids[r];o.appearanceStreamContent=n.createAppearanceStream(o.optionName),o.caption=n.getCA()}},uf.prototype.createOption=function(n){var r=new mh;return r.Parent=this,r.optionName=n,this.Kids.push(r),A5.call(this.scope,r),r};var fh=function(){gs.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=kn.CheckBox.createAppearanceStream()};Sl(fh,gs);var wd=function(){Dc.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!ka(this.Ff,13)},set:function(r){r?this.Ff=Aa(this.Ff,13):this.Ff=Pa(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!ka(this.Ff,21)},set:function(r){r?this.Ff=Aa(this.Ff,21):this.Ff=Pa(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ka(this.Ff,23)},set:function(r){r?this.Ff=Aa(this.Ff,23):this.Ff=Pa(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!ka(this.Ff,24)},set:function(r){r?this.Ff=Aa(this.Ff,24):this.Ff=Pa(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!ka(this.Ff,25)},set:function(r){r?this.Ff=Aa(this.Ff,25):this.Ff=Pa(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!ka(this.Ff,26)},set:function(r){r?this.Ff=Aa(this.Ff,26):this.Ff=Pa(this.Ff,26)}});var n=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return n},set:function(r){n=r}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return n},set:function(r){Number.isInteger(r)&&(n=r)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Sl(wd,Dc);var ph=function(){wd.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!ka(this.Ff,14)},set:function(n){n?this.Ff=Aa(this.Ff,14):this.Ff=Pa(this.Ff,14)}}),this.password=!0};Sl(ph,wd);var kn={CheckBox:{createAppearanceStream:function(){return{N:{On:kn.CheckBox.YesNormal},D:{On:kn.CheckBox.YesPushDown,Off:kn.CheckBox.OffPushDown}}},YesPushDown:function(n){var r=Xc(n);r.scope=n.scope;var o=[],s=n.scope.internal.getFont(n.fontName,n.fontStyle).id,l=n.scope.__private__.encodeColorString(n.color),d=i0(n,n.caption);return o.push("0.749023 g"),o.push("0 0 "+bi(kn.internal.getWidth(n))+" "+bi(kn.internal.getHeight(n))+" re"),o.push("f"),o.push("BMC"),o.push("q"),o.push("0 0 1 rg"),o.push("/"+s+" "+bi(d.fontSize)+" Tf "+l),o.push("BT"),o.push(d.text),o.push("ET"),o.push("Q"),o.push("EMC"),r.stream=o.join(`
`),r},YesNormal:function(n){var r=Xc(n);r.scope=n.scope;var o=n.scope.internal.getFont(n.fontName,n.fontStyle).id,s=n.scope.__private__.encodeColorString(n.color),l=[],d=kn.internal.getHeight(n),b=kn.internal.getWidth(n),p=i0(n,n.caption);return l.push("1 g"),l.push("0 0 "+bi(b)+" "+bi(d)+" re"),l.push("f"),l.push("q"),l.push("0 0 1 rg"),l.push("0 0 "+bi(b-1)+" "+bi(d-1)+" re"),l.push("W"),l.push("n"),l.push("0 g"),l.push("BT"),l.push("/"+o+" "+bi(p.fontSize)+" Tf "+s),l.push(p.text),l.push("ET"),l.push("Q"),r.stream=l.join(`
`),r},OffPushDown:function(n){var r=Xc(n);r.scope=n.scope;var o=[];return o.push("0.749023 g"),o.push("0 0 "+bi(kn.internal.getWidth(n))+" "+bi(kn.internal.getHeight(n))+" re"),o.push("f"),r.stream=o.join(`
`),r}},RadioButton:{Circle:{createAppearanceStream:function(n){var r={D:{Off:kn.RadioButton.Circle.OffPushDown},N:{}};return r.N[n]=kn.RadioButton.Circle.YesNormal,r.D[n]=kn.RadioButton.Circle.YesPushDown,r},getCA:function(){return"l"},YesNormal:function(n){var r=Xc(n);r.scope=n.scope;var o=[],s=kn.internal.getWidth(n)<=kn.internal.getHeight(n)?kn.internal.getWidth(n)/4:kn.internal.getHeight(n)/4;s=Number((.9*s).toFixed(5));var l=kn.internal.Bezier_C,d=Number((s*l).toFixed(5));return o.push("q"),o.push("1 0 0 1 "+Hu(kn.internal.getWidth(n)/2)+" "+Hu(kn.internal.getHeight(n)/2)+" cm"),o.push(s+" 0 m"),o.push(s+" "+d+" "+d+" "+s+" 0 "+s+" c"),o.push("-"+d+" "+s+" -"+s+" "+d+" -"+s+" 0 c"),o.push("-"+s+" -"+d+" -"+d+" -"+s+" 0 -"+s+" c"),o.push(d+" -"+s+" "+s+" -"+d+" "+s+" 0 c"),o.push("f"),o.push("Q"),r.stream=o.join(`
`),r},YesPushDown:function(n){var r=Xc(n);r.scope=n.scope;var o=[],s=kn.internal.getWidth(n)<=kn.internal.getHeight(n)?kn.internal.getWidth(n)/4:kn.internal.getHeight(n)/4;s=Number((.9*s).toFixed(5));var l=Number((2*s).toFixed(5)),d=Number((l*kn.internal.Bezier_C).toFixed(5)),b=Number((s*kn.internal.Bezier_C).toFixed(5));return o.push("0.749023 g"),o.push("q"),o.push("1 0 0 1 "+Hu(kn.internal.getWidth(n)/2)+" "+Hu(kn.internal.getHeight(n)/2)+" cm"),o.push(l+" 0 m"),o.push(l+" "+d+" "+d+" "+l+" 0 "+l+" c"),o.push("-"+d+" "+l+" -"+l+" "+d+" -"+l+" 0 c"),o.push("-"+l+" -"+d+" -"+d+" -"+l+" 0 -"+l+" c"),o.push(d+" -"+l+" "+l+" -"+d+" "+l+" 0 c"),o.push("f"),o.push("Q"),o.push("0 g"),o.push("q"),o.push("1 0 0 1 "+Hu(kn.internal.getWidth(n)/2)+" "+Hu(kn.internal.getHeight(n)/2)+" cm"),o.push(s+" 0 m"),o.push(s+" "+b+" "+b+" "+s+" 0 "+s+" c"),o.push("-"+b+" "+s+" -"+s+" "+b+" -"+s+" 0 c"),o.push("-"+s+" -"+b+" -"+b+" -"+s+" 0 -"+s+" c"),o.push(b+" -"+s+" "+s+" -"+b+" "+s+" 0 c"),o.push("f"),o.push("Q"),r.stream=o.join(`
`),r},OffPushDown:function(n){var r=Xc(n);r.scope=n.scope;var o=[],s=kn.internal.getWidth(n)<=kn.internal.getHeight(n)?kn.internal.getWidth(n)/4:kn.internal.getHeight(n)/4;s=Number((.9*s).toFixed(5));var l=Number((2*s).toFixed(5)),d=Number((l*kn.internal.Bezier_C).toFixed(5));return o.push("0.749023 g"),o.push("q"),o.push("1 0 0 1 "+Hu(kn.internal.getWidth(n)/2)+" "+Hu(kn.internal.getHeight(n)/2)+" cm"),o.push(l+" 0 m"),o.push(l+" "+d+" "+d+" "+l+" 0 "+l+" c"),o.push("-"+d+" "+l+" -"+l+" "+d+" -"+l+" 0 c"),o.push("-"+l+" -"+d+" -"+d+" -"+l+" 0 -"+l+" c"),o.push(d+" -"+l+" "+l+" -"+d+" "+l+" 0 c"),o.push("f"),o.push("Q"),r.stream=o.join(`
`),r}},Cross:{createAppearanceStream:function(n){var r={D:{Off:kn.RadioButton.Cross.OffPushDown},N:{}};return r.N[n]=kn.RadioButton.Cross.YesNormal,r.D[n]=kn.RadioButton.Cross.YesPushDown,r},getCA:function(){return"8"},YesNormal:function(n){var r=Xc(n);r.scope=n.scope;var o=[],s=kn.internal.calculateCross(n);return o.push("q"),o.push("1 1 "+bi(kn.internal.getWidth(n)-2)+" "+bi(kn.internal.getHeight(n)-2)+" re"),o.push("W"),o.push("n"),o.push(bi(s.x1.x)+" "+bi(s.x1.y)+" m"),o.push(bi(s.x2.x)+" "+bi(s.x2.y)+" l"),o.push(bi(s.x4.x)+" "+bi(s.x4.y)+" m"),o.push(bi(s.x3.x)+" "+bi(s.x3.y)+" l"),o.push("s"),o.push("Q"),r.stream=o.join(`
`),r},YesPushDown:function(n){var r=Xc(n);r.scope=n.scope;var o=kn.internal.calculateCross(n),s=[];return s.push("0.749023 g"),s.push("0 0 "+bi(kn.internal.getWidth(n))+" "+bi(kn.internal.getHeight(n))+" re"),s.push("f"),s.push("q"),s.push("1 1 "+bi(kn.internal.getWidth(n)-2)+" "+bi(kn.internal.getHeight(n)-2)+" re"),s.push("W"),s.push("n"),s.push(bi(o.x1.x)+" "+bi(o.x1.y)+" m"),s.push(bi(o.x2.x)+" "+bi(o.x2.y)+" l"),s.push(bi(o.x4.x)+" "+bi(o.x4.y)+" m"),s.push(bi(o.x3.x)+" "+bi(o.x3.y)+" l"),s.push("s"),s.push("Q"),r.stream=s.join(`
`),r},OffPushDown:function(n){var r=Xc(n);r.scope=n.scope;var o=[];return o.push("0.749023 g"),o.push("0 0 "+bi(kn.internal.getWidth(n))+" "+bi(kn.internal.getHeight(n))+" re"),o.push("f"),r.stream=o.join(`
`),r}}},createDefaultAppearanceStream:function(n){var r=n.scope.internal.getFont(n.fontName,n.fontStyle).id,o=n.scope.__private__.encodeColorString(n.color);return"/"+r+" "+n.fontSize+" Tf "+o}};kn.internal={Bezier_C:.551915024494,calculateCross:function(n){var r=kn.internal.getWidth(n),o=kn.internal.getHeight(n),s=Math.min(r,o);return{x1:{x:(r-s)/2,y:(o-s)/2+s},x2:{x:(r-s)/2+s,y:(o-s)/2},x3:{x:(r-s)/2,y:(o-s)/2},x4:{x:(r-s)/2+s,y:(o-s)/2+s}}}},kn.internal.getWidth=function(n){var r=0;return qr(n)==="object"&&(r=_y(n.Rect[2])),r},kn.internal.getHeight=function(n){var r=0;return qr(n)==="object"&&(r=_y(n.Rect[3])),r};var A5=pa.addField=function(n){if(k5(this,n),!(n instanceof Dc))throw new Error("Invalid argument passed to jsPDF.addField.");var r;return(r=n).scope.internal.acroformPlugin.printedOut&&(r.scope.internal.acroformPlugin.printedOut=!1,r.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),r.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(r),n.page=n.scope.internal.getCurrentPageInfo().pageNumber,this};pa.AcroFormChoiceField=sf,pa.AcroFormListBox=lf,pa.AcroFormComboBox=cf,pa.AcroFormEditBox=uh,pa.AcroFormButton=gs,pa.AcroFormPushButton=dh,pa.AcroFormRadioButton=uf,pa.AcroFormCheckBox=fh,pa.AcroFormTextField=wd,pa.AcroFormPasswordField=ph,pa.AcroFormAppearance=kn,pa.AcroForm={ChoiceField:sf,ListBox:lf,ComboBox:cf,EditBox:uh,Button:gs,PushButton:dh,RadioButton:uf,CheckBox:fh,TextField:wd,PasswordField:ph,Appearance:kn},qn.AcroForm={ChoiceField:sf,ListBox:lf,ComboBox:cf,EditBox:uh,Button:gs,PushButton:dh,RadioButton:uf,CheckBox:fh,TextField:wd,PasswordField:ph,Appearance:kn};qn.AcroForm;function Xx(n){return n.reduce(function(r,o,s){return r[o]=s,r},{})}(function(n){var r="addImage_";n.__addimage__={};var o="UNKNOWN",s={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},l=n.__addimage__.getImageFileTypeByImageData=function(H,R){var Z,Y,we,te,de,je=o;if((R=R||o)==="RGBA"||H.data!==void 0&&H.data instanceof Uint8ClampedArray&&"height"in H&&"width"in H)return"RGBA";if(J(H))for(de in s)for(we=s[de],Z=0;Z<we.length;Z+=1){for(te=!0,Y=0;Y<we[Z].length;Y+=1)if(we[Z][Y]!==void 0&&we[Z][Y]!==H[Y]){te=!1;break}if(te===!0){je=de;break}}else for(de in s)for(we=s[de],Z=0;Z<we.length;Z+=1){for(te=!0,Y=0;Y<we[Z].length;Y+=1)if(we[Z][Y]!==void 0&&we[Z][Y]!==H.charCodeAt(Y)){te=!1;break}if(te===!0){je=de;break}}return je===o&&R!==o&&(je=R),je},d=function H(R){for(var Z=this.internal.write,Y=this.internal.putStream,we=(0,this.internal.getFilters)();we.indexOf("FlateEncode")!==-1;)we.splice(we.indexOf("FlateEncode"),1);R.objectId=this.internal.newObject();var te=[];if(te.push({key:"Type",value:"/XObject"}),te.push({key:"Subtype",value:"/Image"}),te.push({key:"Width",value:R.width}),te.push({key:"Height",value:R.height}),R.colorSpace===g.INDEXED?te.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(R.palette.length/3-1)+" "+("sMask"in R&&R.sMask!==void 0?R.objectId+2:R.objectId+1)+" 0 R]"}):(te.push({key:"ColorSpace",value:"/"+R.colorSpace}),R.colorSpace===g.DEVICE_CMYK&&te.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),te.push({key:"BitsPerComponent",value:R.bitsPerComponent}),"decodeParameters"in R&&R.decodeParameters!==void 0&&te.push({key:"DecodeParms",value:"<<"+R.decodeParameters+">>"}),"transparency"in R&&Array.isArray(R.transparency)&&R.transparency.length>0){for(var de="",je=0,Ie=R.transparency.length;je<Ie;je++)de+=R.transparency[je]+" "+R.transparency[je]+" ";te.push({key:"Mask",value:"["+de+"]"})}R.sMask!==void 0&&te.push({key:"SMask",value:R.objectId+1+" 0 R"});var xe=R.filter!==void 0?["/"+R.filter]:void 0;if(Y({data:R.data,additionalKeyValues:te,alreadyAppliedFilters:xe,objectId:R.objectId}),Z("endobj"),"sMask"in R&&R.sMask!==void 0){var k,A=(k=R.sMaskBitsPerComponent)!==null&&k!==void 0?k:R.bitsPerComponent,q={width:R.width,height:R.height,colorSpace:"DeviceGray",bitsPerComponent:A,data:R.sMask};"filter"in R&&(q.decodeParameters="/Predictor ".concat(R.predictor," /Colors 1 /BitsPerComponent ").concat(A," /Columns ").concat(R.width),q.filter=R.filter),H.call(this,q)}if(R.colorSpace===g.INDEXED){var W=this.internal.newObject();Y({data:ee(new Uint8Array(R.palette)),objectId:W}),Z("endobj")}},b=function(){var H=this.internal.collections[r+"images"];for(var R in H)d.call(this,H[R])},p=function(){var H,R=this.internal.collections[r+"images"],Z=this.internal.write;for(var Y in R)Z("/I"+(H=R[Y]).index,H.objectId,"0","R")},v=function(){this.internal.collections[r+"images"]||(this.internal.collections[r+"images"]={},this.internal.events.subscribe("putResources",b),this.internal.events.subscribe("putXobjectDict",p))},m=function(){var H=this.internal.collections[r+"images"];return v.call(this),H},C=function(){return Object.keys(this.internal.collections[r+"images"]).length},D=function(H){return typeof n["process"+H.toUpperCase()]=="function"},M=function(H){return qr(H)==="object"&&H.nodeType===1},S=function(H,R){if(H.nodeName==="IMG"&&H.hasAttribute("src")){var Z=""+H.getAttribute("src");if(Z.indexOf("data:image/")===0)return ch(unescape(Z).split("base64,").pop());var Y=n.loadFile(Z,!0);if(Y!==void 0)return Y}if(H.nodeName==="CANVAS"){if(H.width===0||H.height===0)throw new Error("Given canvas must have data. Canvas width: "+H.width+", height: "+H.height);var we;switch(R){case"PNG":we="image/png";break;case"WEBP":we="image/webp";break;default:we="image/jpeg"}return ch(H.toDataURL(we,1).split("base64,").pop())}},U=function(H){var R=this.internal.collections[r+"images"];if(R){for(var Z in R)if(H===R[Z].alias)return R[Z]}},_=function(H,R,Z){return H||R||(H=-96,R=-96),H<0&&(H=-1*Z.width*72/H/this.internal.scaleFactor),R<0&&(R=-1*Z.height*72/R/this.internal.scaleFactor),H===0&&(H=R*Z.width/Z.height),R===0&&(R=H*Z.height/Z.width),[H,R]},N=function(H,R,Z,Y,we,te){var de=_.call(this,Z,Y,we),je=this.internal.getCoordinateString,Ie=this.internal.getVerticalCoordinateString,xe=m.call(this);if(Z=de[0],Y=de[1],xe[we.index]=we,te){te*=Math.PI/180;var k=Math.cos(te),A=Math.sin(te),q=function(se){return se.toFixed(4)},W=[q(k),q(A),q(-1*A),q(k),0,0,"cm"]}this.internal.write("q"),te?(this.internal.write([1,"0","0",1,je(H),Ie(R+Y),"cm"].join(" ")),this.internal.write(W.join(" ")),this.internal.write([je(Z),"0","0",je(Y),"0","0","cm"].join(" "))):this.internal.write([je(Z),"0","0",je(Y),je(H),Ie(R+Y),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+we.index+" Do"),this.internal.write("Q")},g=n.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};n.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var ae=n.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},V=n.__addimage__.sHashCode=function(H){var R,Z,Y=0;if(typeof H=="string")for(Z=H.length,R=0;R<Z;R++)Y=(Y<<5)-Y+H.charCodeAt(R),Y|=0;else if(J(H))for(Z=H.byteLength/2,R=0;R<Z;R++)Y=(Y<<5)-Y+H[R],Y|=0;return Y},E=n.__addimage__.validateStringAsBase64=function(H){(H=H||"").toString().trim();var R=!0;return H.length===0&&(R=!1),H.length%4!=0&&(R=!1),/^[A-Za-z0-9+/]+$/.test(H.substr(0,H.length-2))===!1&&(R=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(H.substr(-2))===!1&&(R=!1),R},re=n.__addimage__.extractImageFromDataUrl=function(H){if(H==null||!(H=H.trim()).startsWith("data:"))return null;var R=H.indexOf(",");return R<0?null:H.substring(0,R).trim().endsWith("base64")?H.substring(R+1):null};n.__addimage__.isArrayBuffer=function(H){return H instanceof ArrayBuffer};var J=n.__addimage__.isArrayBufferView=function(H){return H instanceof Int8Array||H instanceof Uint8Array||H instanceof Uint8ClampedArray||H instanceof Int16Array||H instanceof Uint16Array||H instanceof Int32Array||H instanceof Uint32Array||H instanceof Float32Array||H instanceof Float64Array},G=n.__addimage__.binaryStringToUint8Array=function(H){for(var R=H.length,Z=new Uint8Array(R),Y=0;Y<R;Y++)Z[Y]=H.charCodeAt(Y);return Z},ee=n.__addimage__.arrayBufferToBinaryString=function(H){for(var R="",Z=J(H)?H:new Uint8Array(H),Y=0;Y<Z.length;Y+=8192)R+=String.fromCharCode.apply(null,Z.subarray(Y,Y+8192));return R};n.addImage=function(){var H,R,Z,Y,we,te,de,je,Ie;if(typeof arguments[1]=="number"?(R=o,Z=arguments[1],Y=arguments[2],we=arguments[3],te=arguments[4],de=arguments[5],je=arguments[6],Ie=arguments[7]):(R=arguments[1],Z=arguments[2],Y=arguments[3],we=arguments[4],te=arguments[5],de=arguments[6],je=arguments[7],Ie=arguments[8]),qr(H=arguments[0])==="object"&&!M(H)&&"imageData"in H){var xe=H;H=xe.imageData,R=xe.format||R||o,Z=xe.x||Z||0,Y=xe.y||Y||0,we=xe.w||xe.width||we,te=xe.h||xe.height||te,de=xe.alias||de,je=xe.compression||je,Ie=xe.rotation||xe.angle||Ie}var k=this.internal.getFilters();if(je===void 0&&k.indexOf("FlateEncode")!==-1&&(je="SLOW"),isNaN(Z)||isNaN(Y))throw new Error("Invalid coordinates passed to jsPDF.addImage");v.call(this);var A=F.call(this,H,R,de,je);return N.call(this,Z,Y,we,te,A,Ie),this};var F=function(H,R,Z,Y){var we,te,de;if(typeof H=="string"&&l(H)===o){H=unescape(H);var je=$(H,!1);(je!==""||(je=n.loadFile(H,!0))!==void 0)&&(H=je)}if(M(H)&&(H=S(H,R)),R=l(H,R),!D(R))throw new Error("addImage does not support files of type '"+R+"', please ensure that a plugin for '"+R+"' support is added.");if(((de=Z)==null||de.length===0)&&(Z=(function(Ie){return typeof Ie=="string"||J(Ie)?V(Ie):J(Ie.data)?V(Ie.data):null})(H)),(we=U.call(this,Z))||(H instanceof Uint8Array||R==="RGBA"||(te=H,H=G(H)),we=this["process"+R.toUpperCase()](H,C.call(this),Z,(function(Ie){return Ie&&typeof Ie=="string"&&(Ie=Ie.toUpperCase()),Ie in n.image_compression?Ie:ae.NONE})(Y),te)),!we)throw new Error("An unknown error occurred whilst processing the image.");return we},$=n.__addimage__.convertBase64ToBinaryString=function(H,R){R=typeof R!="boolean"||R;var Z,Y="";if(typeof H=="string"){var we;Z=(we=re(H))!==null&&we!==void 0?we:H;try{Y=ch(Z)}catch(te){if(R)throw E(Z)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+te.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return Y};n.getImageProperties=function(H){var R,Z,Y="";if(M(H)&&(H=S(H)),typeof H=="string"&&l(H)===o&&((Y=$(H,!1))===""&&(Y=n.loadFile(H)||""),H=Y),Z=l(H),!D(Z))throw new Error("addImage does not support files of type '"+Z+"', please ensure that a plugin for '"+Z+"' support is added.");if(H instanceof Uint8Array||(H=G(H)),!(R=this["process"+Z.toUpperCase()](H)))throw new Error("An unknown error occurred whilst processing the image");return R.fileType=Z,R}})(qn.API),(function(n){var r=function(o){if(o!==void 0&&o!="")return!0};qn.API.events.push(["addPage",function(o){this.internal.getPageInfo(o.pageNumber).pageContext.annotations=[]}]),n.events.push(["putPage",function(o){for(var s,l,d,b=this.internal.getCoordinateString,p=this.internal.getVerticalCoordinateString,v=this.internal.getPageInfoByObjId(o.objId),m=o.pageContext.annotations,C=!1,D=0;D<m.length&&!C;D++)switch((s=m[D]).type){case"link":(r(s.options.url)||r(s.options.pageNumber))&&(C=!0);break;case"reference":case"text":case"freetext":C=!0}if(C!=0){this.internal.write("/Annots [");for(var M=0;M<m.length;M++){s=m[M];var S=this.internal.pdfEscape,U=this.internal.getEncryptor(o.objId);switch(s.type){case"reference":this.internal.write(" "+s.object.objId+" 0 R ");break;case"text":var _=this.internal.newAdditionalObject(),N=this.internal.newAdditionalObject(),g=this.internal.getEncryptor(_.objId),ae=s.title||"Note";d="<</Type /Annot /Subtype /Text "+(l="/Rect ["+b(s.bounds.x)+" "+p(s.bounds.y+s.bounds.h)+" "+b(s.bounds.x+s.bounds.w)+" "+p(s.bounds.y)+"] ")+"/Contents ("+S(g(s.contents))+")",d+=" /Popup "+N.objId+" 0 R",d+=" /P "+v.objId+" 0 R",d+=" /T ("+S(g(ae))+") >>",_.content=d;var V=_.objId+" 0 R";d="<</Type /Annot /Subtype /Popup "+(l="/Rect ["+b(s.bounds.x+30)+" "+p(s.bounds.y+s.bounds.h)+" "+b(s.bounds.x+s.bounds.w+30)+" "+p(s.bounds.y)+"] ")+" /Parent "+V,s.open&&(d+=" /Open true"),d+=" >>",N.content=d,this.internal.write(_.objId,"0 R",N.objId,"0 R");break;case"freetext":l="/Rect ["+b(s.bounds.x)+" "+p(s.bounds.y)+" "+b(s.bounds.x+s.bounds.w)+" "+p(s.bounds.y+s.bounds.h)+"] ";var E=s.color||"#000000";d="<</Type /Annot /Subtype /FreeText "+l+"/Contents ("+S(U(s.contents))+")",d+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+E+")",d+=" /Border [0 0 0]",d+=" >>",this.internal.write(d);break;case"link":if(s.options.name){var re=this.annotations._nameMap[s.options.name];s.options.pageNumber=re.page,s.options.top=re.y}else s.options.top||(s.options.top=0);if(l="/Rect ["+s.finalBounds.x+" "+s.finalBounds.y+" "+s.finalBounds.w+" "+s.finalBounds.h+"] ",d="",s.options.url)d="<</Type /Annot /Subtype /Link "+l+"/Border [0 0 0] /A <</S /URI /URI ("+S(U(s.options.url))+") >>";else if(s.options.pageNumber)switch(d="<</Type /Annot /Subtype /Link "+l+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(s.options.pageNumber).objId+" 0 R",s.options.magFactor=s.options.magFactor||"XYZ",s.options.magFactor){case"Fit":d+=" /Fit]";break;case"FitH":d+=" /FitH "+s.options.top+"]";break;case"FitV":s.options.left=s.options.left||0,d+=" /FitV "+s.options.left+"]";break;default:var J=p(s.options.top);s.options.left=s.options.left||0,s.options.zoom===void 0&&(s.options.zoom=0),d+=" /XYZ "+s.options.left+" "+J+" "+s.options.zoom+"]"}d!=""&&(d+=" >>",this.internal.write(d))}}this.internal.write("]")}}]),n.createAnnotation=function(o){var s=this.internal.getCurrentPageInfo();switch(o.type){case"link":this.link(o.bounds.x,o.bounds.y,o.bounds.w,o.bounds.h,o);break;case"text":case"freetext":s.pageContext.annotations.push(o)}},n.link=function(o,s,l,d,b){var p=this.internal.getCurrentPageInfo(),v=this.internal.getCoordinateString,m=this.internal.getVerticalCoordinateString;p.pageContext.annotations.push({finalBounds:{x:v(o),y:m(s),w:v(o+l),h:m(s+d)},options:b,type:"link"})},n.textWithLink=function(o,s,l,d){var b,p,v=this.getTextWidth(o),m=this.internal.getLineHeight()/this.internal.scaleFactor;if(d.maxWidth!==void 0){p=d.maxWidth;var C=this.splitTextToSize(o,p).length;b=Math.ceil(m*C)}else p=v,b=m;return this.text(o,s,l,d),l+=.2*m,d.align==="center"&&(s-=v/2),d.align==="right"&&(s-=v),this.link(s,l-m,p,b,d),v},n.getTextWidth=function(o){var s=this.internal.getFontSize();return this.getStringUnitWidth(o)*s/this.internal.scaleFactor}})(qn.API),(function(n){var r={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},o={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},s={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},l=[1570,1571,1573,1575];n.__arabicParser__={};var d=n.__arabicParser__.isInArabicSubstitutionA=function(_){return r[_.charCodeAt(0)]!==void 0},b=n.__arabicParser__.isArabicLetter=function(_){return typeof _=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(_)},p=n.__arabicParser__.isArabicEndLetter=function(_){return b(_)&&d(_)&&r[_.charCodeAt(0)].length<=2},v=n.__arabicParser__.isArabicAlfLetter=function(_){return b(_)&&l.indexOf(_.charCodeAt(0))>=0};n.__arabicParser__.arabicLetterHasIsolatedForm=function(_){return b(_)&&d(_)&&r[_.charCodeAt(0)].length>=1};var m=n.__arabicParser__.arabicLetterHasFinalForm=function(_){return b(_)&&d(_)&&r[_.charCodeAt(0)].length>=2};n.__arabicParser__.arabicLetterHasInitialForm=function(_){return b(_)&&d(_)&&r[_.charCodeAt(0)].length>=3};var C=n.__arabicParser__.arabicLetterHasMedialForm=function(_){return b(_)&&d(_)&&r[_.charCodeAt(0)].length==4},D=n.__arabicParser__.resolveLigatures=function(_){var N=0,g=o,ae="",V=0;for(N=0;N<_.length;N+=1)g[_.charCodeAt(N)]!==void 0?(V++,typeof(g=g[_.charCodeAt(N)])=="number"&&(ae+=String.fromCharCode(g),g=o,V=0),N===_.length-1&&(g=o,ae+=_.charAt(N-(V-1)),N-=V-1,V=0)):(g=o,ae+=_.charAt(N-V),N-=V,V=0);return ae};n.__arabicParser__.isArabicDiacritic=function(_){return _!==void 0&&s[_.charCodeAt(0)]!==void 0};var M=n.__arabicParser__.getCorrectForm=function(_,N,g){return b(_)?d(_)===!1?-1:!m(_)||!b(N)&&!b(g)||!b(g)&&p(N)||p(_)&&!b(N)||p(_)&&v(N)||p(_)&&p(N)?0:C(_)&&b(N)&&!p(N)&&b(g)&&m(g)?3:p(_)||!b(g)?1:2:-1},S=function(_){var N=0,g=0,ae=0,V="",E="",re="",J=(_=_||"").split("\\s+"),G=[];for(N=0;N<J.length;N+=1){for(G.push(""),g=0;g<J[N].length;g+=1)V=J[N][g],E=J[N][g-1],re=J[N][g+1],b(V)?(ae=M(V,E,re),G[N]+=ae!==-1?String.fromCharCode(r[V.charCodeAt(0)][ae]):V):G[N]+=V;G[N]=D(G[N])}return G.join(" ")},U=n.__arabicParser__.processArabic=n.processArabic=function(){var _,N=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,g=[];if(Array.isArray(N)){var ae=0;for(g=[],ae=0;ae<N.length;ae+=1)Array.isArray(N[ae])?g.push([S(N[ae][0]),N[ae][1],N[ae][2]]):g.push([S(N[ae])]);_=g}else _=S(N);return typeof arguments[0]=="string"?_:(arguments[0].text=_,arguments[0])};n.events.push(["preProcessText",U])})(qn.API),qn.API.autoPrint=function(n){var r;return(n=n||{}).variant=n.variant||"non-conform",n.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){r=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+r+" 0 R")})),this},(function(n){var r=function(){var o=void 0;Object.defineProperty(this,"pdf",{get:function(){return o},set:function(p){o=p}});var s=150;Object.defineProperty(this,"width",{get:function(){return s},set:function(p){s=isNaN(p)||Number.isInteger(p)===!1||p<0?150:p,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=s+1)}});var l=300;Object.defineProperty(this,"height",{get:function(){return l},set:function(p){l=isNaN(p)||Number.isInteger(p)===!1||p<0?300:p,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=l+1)}});var d=[];Object.defineProperty(this,"childNodes",{get:function(){return d},set:function(p){d=p}});var b={};Object.defineProperty(this,"style",{get:function(){return b},set:function(p){b=p}}),Object.defineProperty(this,"parentNode",{})};r.prototype.getContext=function(o,s){var l;if((o=o||"2d")!=="2d")return null;for(l in s)this.pdf.context2d.hasOwnProperty(l)&&(this.pdf.context2d[l]=s[l]);return this.pdf.context2d._canvas=this,this.pdf.context2d},r.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},n.events.push(["initialized",function(){this.canvas=new r,this.canvas.pdf=this}])})(qn.API),(function(n){var r={left:0,top:0,bottom:0,right:0},o=!1,s=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},r),this.internal.__cell__.margins.width=this.getPageWidth(),l.call(this))},l=function(){this.internal.__cell__.lastCell=new d,this.internal.__cell__.pages=1},d=function(){var v=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return v},set:function(_){v=_}});var m=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return m},set:function(_){m=_}});var C=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return C},set:function(_){C=_}});var D=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return D},set:function(_){D=_}});var M=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return M},set:function(_){M=_}});var S=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return S},set:function(_){S=_}});var U=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return U},set:function(_){U=_}}),this};d.prototype.clone=function(){return new d(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},d.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},n.setHeaderFunction=function(v){return s.call(this),this.internal.__cell__.headerFunction=typeof v=="function"?v:void 0,this},n.getTextDimensions=function(v,m){s.call(this);var C=(m=m||{}).fontSize||this.getFontSize(),D=m.font||this.getFont(),M=m.scaleFactor||this.internal.scaleFactor,S=0,U=0,_=0,N=this;if(!Array.isArray(v)&&typeof v!="string"){if(typeof v!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");v=String(v)}var g=m.maxWidth;g>0?typeof v=="string"?v=this.splitTextToSize(v,g):Object.prototype.toString.call(v)==="[object Array]"&&(v=v.reduce(function(V,E){return V.concat(N.splitTextToSize(E,g))},[])):v=Array.isArray(v)?v:[v];for(var ae=0;ae<v.length;ae++)S<(_=this.getStringUnitWidth(v[ae],{font:D})*C)&&(S=_);return S!==0&&(U=v.length),{w:S/=M,h:Math.max((U*C*this.getLineHeightFactor()-C*(this.getLineHeightFactor()-1))/M,0)}},n.cellAddPage=function(){s.call(this),this.addPage();var v=this.internal.__cell__.margins||r;return this.internal.__cell__.lastCell=new d(v.left,v.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var b=n.cell=function(){var v;v=arguments[0]instanceof d?arguments[0]:new d(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),s.call(this);var m=this.internal.__cell__.lastCell,C=this.internal.__cell__.padding,D=this.internal.__cell__.margins||r,M=this.internal.__cell__.tableHeaderRow,S=this.internal.__cell__.printHeaders;return m.lineNumber!==void 0&&(m.lineNumber===v.lineNumber?(v.x=(m.x||0)+(m.width||0),v.y=m.y||0):m.y+m.height+v.height+D.bottom>this.getPageHeight()?(this.cellAddPage(),v.y=D.top,S&&M&&(this.printHeaderRow(v.lineNumber,!0),v.y+=M[0].height)):v.y=m.y+m.height||v.y),v.text[0]!==void 0&&(this.rect(v.x,v.y,v.width,v.height,o===!0?"FD":void 0),v.align==="right"?this.text(v.text,v.x+v.width-C,v.y+C,{align:"right",baseline:"top"}):v.align==="center"?this.text(v.text,v.x+v.width/2,v.y+C,{align:"center",baseline:"top",maxWidth:v.width-C-C}):this.text(v.text,v.x+C,v.y+C,{align:"left",baseline:"top",maxWidth:v.width-C-C})),this.internal.__cell__.lastCell=v,this};n.table=function(v,m,C,D,M){if(s.call(this),!C)throw new Error("No data for PDF table.");var S,U,_,N,g=[],ae=[],V=[],E={},re={},J=[],G=[],ee=(M=M||{}).autoSize||!1,F=M.printHeaders!==!1,$=M.css&&M.css["font-size"]!==void 0?16*M.css["font-size"]:M.fontSize||12,H=M.margins||Object.assign({width:this.getPageWidth()},r),R=typeof M.padding=="number"?M.padding:3,Z=M.headerBackgroundColor||"#c8c8c8",Y=M.headerTextColor||"#000";if(l.call(this),this.internal.__cell__.printHeaders=F,this.internal.__cell__.margins=H,this.internal.__cell__.table_font_size=$,this.internal.__cell__.padding=R,this.internal.__cell__.headerBackgroundColor=Z,this.internal.__cell__.headerTextColor=Y,this.setFontSize($),D==null)ae=g=Object.keys(C[0]),V=g.map(function(){return"left"});else if(Array.isArray(D)&&qr(D[0])==="object")for(g=D.map(function(xe){return xe.name}),ae=D.map(function(xe){return xe.prompt||xe.name||""}),V=D.map(function(xe){return xe.align||"left"}),S=0;S<D.length;S+=1)re[D[S].name]=.7499990551181103*D[S].width;else Array.isArray(D)&&typeof D[0]=="string"&&(ae=g=D,V=g.map(function(){return"left"}));if(ee||Array.isArray(D)&&typeof D[0]=="string")for(S=0;S<g.length;S+=1){for(E[N=g[S]]=C.map(function(xe){return xe[N]}),this.setFont(void 0,"bold"),J.push(this.getTextDimensions(ae[S],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),U=E[N],this.setFont(void 0,"normal"),_=0;_<U.length;_+=1)J.push(this.getTextDimensions(U[_],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);re[N]=Math.max.apply(null,J)+R+R,J=[]}if(F){var we={};for(S=0;S<g.length;S+=1)we[g[S]]={},we[g[S]].text=ae[S],we[g[S]].align=V[S];var te=p.call(this,we,re);G=g.map(function(xe){return new d(v,m,re[xe],te,we[xe].text,void 0,we[xe].align)}),this.setTableHeaderRow(G),this.printHeaderRow(1,!1)}var de=D.reduce(function(xe,k){return xe[k.name]=k.align,xe},{});for(S=0;S<C.length;S+=1){"rowStart"in M&&M.rowStart instanceof Function&&M.rowStart({row:S,data:C[S]},this);var je=p.call(this,C[S],re);for(_=0;_<g.length;_+=1){var Ie=C[S][g[_]];"cellStart"in M&&M.cellStart instanceof Function&&M.cellStart({row:S,col:_,data:Ie},this),b.call(this,new d(v,m,re[g[_]],je,Ie,S+2,de[g[_]]))}}return this.internal.__cell__.table_x=v,this.internal.__cell__.table_y=m,this};var p=function(v,m){var C=this.internal.__cell__.padding,D=this.internal.__cell__.table_font_size,M=this.internal.scaleFactor;return Object.keys(v).map(function(S){var U=v[S];return this.splitTextToSize(U.hasOwnProperty("text")?U.text:U,m[S]-C-C)},this).map(function(S){return this.getLineHeightFactor()*S.length*D/M+C+C},this).reduce(function(S,U){return Math.max(S,U)},0)};n.setTableHeaderRow=function(v){s.call(this),this.internal.__cell__.tableHeaderRow=v},n.printHeaderRow=function(v,m){if(s.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var C;if(o=!0,typeof this.internal.__cell__.headerFunction=="function"){var D=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new d(D[0],D[1],D[2],D[3],void 0,-1)}this.setFont(void 0,"bold");for(var M=[],S=0;S<this.internal.__cell__.tableHeaderRow.length;S+=1){C=this.internal.__cell__.tableHeaderRow[S].clone(),m&&(C.y=this.internal.__cell__.margins.top||0,M.push(C)),C.lineNumber=v;var U=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),b.call(this,C),this.setTextColor(U)}M.length>0&&this.setTableHeaderRow(M),this.setFont(void 0,"normal"),o=!1}})(qn.API);var Kx={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Zx=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],r0=Xx(Zx),Jx=[100,200,300,400,500,600,700,800,900],P5=Xx(Jx);function Bg(n){var r=n.family.replace(/"|'/g,"").toLowerCase(),o=(function(d){return Kx[d=d||"normal"]?d:"normal"})(n.style),s=(function(d){return d?typeof d=="number"?d>=100&&d<=900&&d%100==0?d:400:/^\d00$/.test(d)?parseInt(d):d==="bold"?700:400:400})(n.weight),l=(function(d){return typeof r0[d=d||"normal"]=="number"?d:"normal"})(n.stretch);return{family:r,style:o,weight:s,stretch:l,src:n.src||[],ref:n.ref||{name:r,style:[l,o,s].join(" ")}}}function Dy(n,r,o,s){var l;for(l=o;l>=0&&l<r.length;l+=s)if(n[r[l]])return n[r[l]];for(l=o;l>=0&&l<r.length;l-=s)if(n[r[l]])return n[r[l]]}var z5={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Ry={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Iy(n){return[n.stretch,n.style,n.weight,n.family].join(" ")}function Ly(n){return n.trimLeft()}function _5(n,r){for(var o=0;o<n.length;){if(n.charAt(o)===r)return[n.substring(0,o),n.substring(o+1)];o+=1}return null}function D5(n){var r=n.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return r===null?null:[r[0],n.substring(r[0].length)]}var ah,My,By,ef,sh,Oy,Fy,Uy,Og=["times"];function Ey(n,r,o,s,l){var d=4,b=qy;switch(l){case qn.API.image_compression.FAST:d=1,b=Vy;break;case qn.API.image_compression.MEDIUM:d=6,b=Hy;break;case qn.API.image_compression.SLOW:d=9,b=Wy}n=(function(v,m,C,D){for(var M,S=v.length/m,U=new Uint8Array(v.length+S),_=[R5,Vy,qy,Hy,Wy],N=0;N<S;N+=1){var g=N*m,ae=v.subarray(g,g+m);if(D)U.set(D(ae,C,M),g+N);else{for(var V=_.length,E=[],re=0;re<V;re+=1)E[re]=_[re](ae,C,M);var J=L5(E.concat());U.set(E[J],g+N)}M=ae}return U})(n,r,Math.ceil(o*s/8),b);var p=Zg(n,{level:d});return qn.API.__addimage__.arrayBufferToBinaryString(p)}function R5(n){var r=Array.apply([],n);return r.unshift(0),r}function Vy(n,r){var o=n.length,s=[];s[0]=1;for(var l=0;l<o;l+=1){var d=n[l-r]||0;s[l+1]=n[l]-d+256&255}return s}function qy(n,r,o){var s=n.length,l=[];l[0]=2;for(var d=0;d<s;d+=1){var b=o&&o[d]||0;l[d+1]=n[d]-b+256&255}return l}function Hy(n,r,o){var s=n.length,l=[];l[0]=3;for(var d=0;d<s;d+=1){var b=n[d-r]||0,p=o&&o[d]||0;l[d+1]=n[d]+256-(b+p>>>1)&255}return l}function Wy(n,r,o){var s=n.length,l=[];l[0]=4;for(var d=0;d<s;d+=1){var b=I5(n[d-r]||0,o&&o[d]||0,o&&o[d-r]||0);l[d+1]=n[d]-b+256&255}return l}function I5(n,r,o){if(n===r&&r===o)return n;var s=Math.abs(r-o),l=Math.abs(n-o),d=Math.abs(n+r-o-o);return s<=l&&s<=d?n:l<=d?r:o}function L5(n){var r=n.map(function(o){return o.reduce(function(s,l){return s+Math.abs(l)},0)});return r.indexOf(Math.min.apply(null,r))}function Fg(n,r,o){var s=r*o,l=Math.floor(s/8),d=16-(s-8*l+o),b=(1<<o)-1;return Qx(n,l)>>d&b}function $y(n,r,o,s){var l=o*s,d=Math.floor(l/8),b=16-(l-8*d+s),p=(1<<s)-1,v=(r&p)<<b;(function(m,C,D){if(C+1<m.byteLength)m.setUint16(C,D,!1);else{var M=D>>8&255;m.setUint8(C,M)}})(n,d,Qx(n,d)&~(p<<b)&65535|v)}function Qx(n,r){return r+1<n.byteLength?n.getUint16(r,!1):n.getUint8(r)<<8}function M5(n){var r=0;if(n[r++]!==71||n[r++]!==73||n[r++]!==70||n[r++]!==56||(n[r++]+1&253)!=56||n[r++]!==97)throw new Error("Invalid GIF 87a/89a header.");var o=n[r++]|n[r++]<<8,s=n[r++]|n[r++]<<8,l=n[r++],d=l>>7,b=1<<1+(7&l);n[r++],n[r++];var p=null,v=null;d&&(p=r,v=b,r+=3*b);var m=!0,C=[],D=0,M=null,S=0,U=null;for(this.width=o,this.height=s;m&&r<n.length;)switch(n[r++]){case 33:switch(n[r++]){case 255:if(n[r]!==11||n[r+1]==78&&n[r+2]==69&&n[r+3]==84&&n[r+4]==83&&n[r+5]==67&&n[r+6]==65&&n[r+7]==80&&n[r+8]==69&&n[r+9]==50&&n[r+10]==46&&n[r+11]==48&&n[r+12]==3&&n[r+13]==1&&n[r+16]==0)r+=14,U=n[r++]|n[r++]<<8,r++;else for(r+=12;;){if(!((H=n[r++])>=0))throw Error("Invalid block size");if(H===0)break;r+=H}break;case 249:if(n[r++]!==4||n[r+4]!==0)throw new Error("Invalid graphics extension block.");var _=n[r++];D=n[r++]|n[r++]<<8,M=n[r++],1&_||(M=null),S=_>>2&7,r++;break;case 254:for(;;){if(!((H=n[r++])>=0))throw Error("Invalid block size");if(H===0)break;r+=H}break;default:throw new Error("Unknown graphic control label: 0x"+n[r-1].toString(16))}break;case 44:var N=n[r++]|n[r++]<<8,g=n[r++]|n[r++]<<8,ae=n[r++]|n[r++]<<8,V=n[r++]|n[r++]<<8,E=n[r++],re=E>>6&1,J=1<<1+(7&E),G=p,ee=v,F=!1;E>>7&&(F=!0,G=r,ee=J,r+=3*J);var $=r;for(r++;;){var H;if(!((H=n[r++])>=0))throw Error("Invalid block size");if(H===0)break;r+=H}C.push({x:N,y:g,width:ae,height:V,has_local_palette:F,palette_offset:G,palette_size:ee,data_offset:$,data_length:r-$,transparent_index:M,interlaced:!!re,delay:D,disposal:S});break;case 59:m=!1;break;default:throw new Error("Unknown gif block: 0x"+n[r-1].toString(16))}this.numFrames=function(){return C.length},this.loopCount=function(){return U},this.frameInfo=function(R){if(R<0||R>=C.length)throw new Error("Frame index out of range.");return C[R]},this.decodeAndBlitFrameBGRA=function(R,Z){var Y=this.frameInfo(R),we=Y.width*Y.height,te=new Uint8Array(we);Yy(n,Y.data_offset,te,we);var de=Y.palette_offset,je=Y.transparent_index;je===null&&(je=256);var Ie=Y.width,xe=o-Ie,k=Ie,A=4*(Y.y*o+Y.x),q=4*((Y.y+Y.height)*o+Y.x),W=A,se=4*xe;Y.interlaced===!0&&(se+=4*o*7);for(var Ce=8,le=0,_e=te.length;le<_e;++le){var be=te[le];if(k===0&&(k=Ie,(W+=se)>=q&&(se=4*xe+4*o*(Ce-1),W=A+(Ie+xe)*(Ce<<1),Ce>>=1)),be===je)W+=4;else{var De=n[de+3*be],Ge=n[de+3*be+1],ot=n[de+3*be+2];Z[W++]=ot,Z[W++]=Ge,Z[W++]=De,Z[W++]=255}--k}},this.decodeAndBlitFrameRGBA=function(R,Z){var Y=this.frameInfo(R),we=Y.width*Y.height,te=new Uint8Array(we);Yy(n,Y.data_offset,te,we);var de=Y.palette_offset,je=Y.transparent_index;je===null&&(je=256);var Ie=Y.width,xe=o-Ie,k=Ie,A=4*(Y.y*o+Y.x),q=4*((Y.y+Y.height)*o+Y.x),W=A,se=4*xe;Y.interlaced===!0&&(se+=4*o*7);for(var Ce=8,le=0,_e=te.length;le<_e;++le){var be=te[le];if(k===0&&(k=Ie,(W+=se)>=q&&(se=4*xe+4*o*(Ce-1),W=A+(Ie+xe)*(Ce<<1),Ce>>=1)),be===je)W+=4;else{var De=n[de+3*be],Ge=n[de+3*be+1],ot=n[de+3*be+2];Z[W++]=De,Z[W++]=Ge,Z[W++]=ot,Z[W++]=255}--k}}}function Yy(n,r,o,s){for(var l=n[r++],d=1<<l,b=d+1,p=b+1,v=l+1,m=(1<<v)-1,C=0,D=0,M=0,S=n[r++],U=new Int32Array(4096),_=null;;){for(;C<16&&S!==0;)D|=n[r++]<<C,C+=8,S===1?S=n[r++]:--S;if(C<v)break;var N=D&m;if(D>>=v,C-=v,N!==d){if(N===b)break;for(var g=N<p?N:_,ae=0,V=g;V>d;)V=U[V]>>8,++ae;var E=V;if(M+ae+(g!==N?1:0)>s)return void lo.log("Warning, gif stream longer than expected.");o[M++]=E;var re=M+=ae;for(g!==N&&(o[M++]=E),V=g;ae--;)V=U[V],o[--re]=255&V,V>>=8;_!==null&&p<4096&&(U[p++]=_<<8|E,p>=m+1&&v<12&&(++v,m=m<<1|1)),_=N}else p=b+1,m=(1<<(v=l+1))-1,_=null}return M!==s&&lo.log("Warning, gif stream shorter than expected."),o}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Ug(n){var r,o,s,l,d,b=Math.floor,p=new Array(64),v=new Array(64),m=new Array(64),C=new Array(64),D=new Array(65535),M=new Array(65535),S=new Array(64),U=new Array(64),_=[],N=0,g=7,ae=new Array(64),V=new Array(64),E=new Array(64),re=new Array(256),J=new Array(2048),G=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],ee=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],F=[0,1,2,3,4,5,6,7,8,9,10,11],$=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],H=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],R=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Z=[0,1,2,3,4,5,6,7,8,9,10,11],Y=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],we=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function te(A,q){for(var W=0,se=0,Ce=new Array,le=1;le<=16;le++){for(var _e=1;_e<=A[le];_e++)Ce[q[se]]=[],Ce[q[se]][0]=W,Ce[q[se]][1]=le,se++,W++;W*=2}return Ce}function de(A){for(var q=A[0],W=A[1]-1;W>=0;)q&1<<W&&(N|=1<<g),W--,--g<0&&(N==255?(je(255),je(0)):je(N),g=7,N=0)}function je(A){_.push(A)}function Ie(A){je(A>>8&255),je(255&A)}function xe(A,q,W,se,Ce){for(var le,_e=Ce[0],be=Ce[240],De=(function(xt,hn){var Et,gn,Zt,xn,tt,Rn,Lt,Wt,vn,ct,ye=0;for(vn=0;vn<8;++vn){Et=xt[ye],gn=xt[ye+1],Zt=xt[ye+2],xn=xt[ye+3],tt=xt[ye+4],Rn=xt[ye+5],Lt=xt[ye+6];var ze=Et+(Wt=xt[ye+7]),Nt=Et-Wt,Ke=gn+Lt,vt=gn-Lt,Vt=Zt+Rn,ht=Zt-Rn,Je=xn+tt,Ft=xn-tt,At=ze+Je,Jt=ze-Je,An=Ke+Vt,dn=Ke-Vt;xt[ye]=At+An,xt[ye+4]=At-An;var ti=.707106781*(dn+Jt);xt[ye+2]=Jt+ti,xt[ye+6]=Jt-ti;var Tr=.382683433*((At=Ft+ht)-(dn=vt+Nt)),en=.5411961*At+Tr,zi=1.306562965*dn+Tr,Mr=.707106781*(An=ht+vt),qt=Nt+Mr,Zi=Nt-Mr;xt[ye+5]=Zi+en,xt[ye+3]=Zi-en,xt[ye+1]=qt+zi,xt[ye+7]=qt-zi,ye+=8}for(ye=0,vn=0;vn<8;++vn){Et=xt[ye],gn=xt[ye+8],Zt=xt[ye+16],xn=xt[ye+24],tt=xt[ye+32],Rn=xt[ye+40],Lt=xt[ye+48];var Ji=Et+(Wt=xt[ye+56]),Cr=Et-Wt,jr=gn+Lt,hi=gn-Lt,wt=Zt+Rn,Wn=Zt-Rn,mn=xn+tt,Ot=xn-tt,Dt=Ji+mn,an=Ji-mn,rn=jr+wt,bn=jr-wt;xt[ye]=Dt+rn,xt[ye+32]=Dt-rn;var ni=.707106781*(bn+an);xt[ye+16]=an+ni,xt[ye+48]=an-ni;var hr=.382683433*((Dt=Ot+Wn)-(bn=hi+Cr)),Di=.5411961*Dt+hr,qi=1.306562965*bn+hr,Br=.707106781*(rn=Wn+hi),_i=Cr+Br,ar=Cr-Br;xt[ye+40]=ar+Di,xt[ye+24]=ar-Di,xt[ye+8]=_i+qi,xt[ye+56]=_i-qi,ye++}for(vn=0;vn<64;++vn)ct=xt[vn]*hn[vn],S[vn]=ct>0?ct+.5|0:ct-.5|0;return S})(A,q),Ge=0;Ge<64;++Ge)U[G[Ge]]=De[Ge];var ot=U[0]-W;W=U[0],ot==0?de(se[0]):(de(se[M[le=32767+ot]]),de(D[le]));for(var jt=63;jt>0&&U[jt]==0;)jt--;if(jt==0)return de(_e),W;for(var Ht,ge=1;ge<=jt;){for(var lt=ge;U[ge]==0&&ge<=jt;)++ge;var Yt=ge-lt;if(Yt>=16){Ht=Yt>>4;for(var Gt=1;Gt<=Ht;++Gt)de(be);Yt&=15}le=32767+U[ge],de(Ce[(Yt<<4)+M[le]]),de(D[le]),ge++}return jt!=63&&de(_e),W}function k(A){A=Math.min(Math.max(A,1),100),d!=A&&((function(q){for(var W=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],se=0;se<64;se++){var Ce=b((W[se]*q+50)/100);Ce=Math.min(Math.max(Ce,1),255),p[G[se]]=Ce}for(var le=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],_e=0;_e<64;_e++){var be=b((le[_e]*q+50)/100);be=Math.min(Math.max(be,1),255),v[G[_e]]=be}for(var De=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ge=0,ot=0;ot<8;ot++)for(var jt=0;jt<8;jt++)m[Ge]=1/(p[G[Ge]]*De[ot]*De[jt]*8),C[Ge]=1/(v[G[Ge]]*De[ot]*De[jt]*8),Ge++})(A<50?Math.floor(5e3/A):Math.floor(200-2*A)),d=A)}this.encode=function(A,q){q&&k(q),_=new Array,N=0,g=7,Ie(65496),Ie(65504),Ie(16),je(74),je(70),je(73),je(70),je(0),je(1),je(1),je(0),Ie(1),Ie(1),je(0),je(0),(function(){Ie(65499),Ie(132),je(0);for(var gn=0;gn<64;gn++)je(p[gn]);je(1);for(var Zt=0;Zt<64;Zt++)je(v[Zt])})(),(function(gn,Zt){Ie(65472),Ie(17),je(8),Ie(Zt),Ie(gn),je(3),je(1),je(17),je(0),je(2),je(17),je(1),je(3),je(17),je(1)})(A.width,A.height),(function(){Ie(65476),Ie(418),je(0);for(var gn=0;gn<16;gn++)je(ee[gn+1]);for(var Zt=0;Zt<=11;Zt++)je(F[Zt]);je(16);for(var xn=0;xn<16;xn++)je($[xn+1]);for(var tt=0;tt<=161;tt++)je(H[tt]);je(1);for(var Rn=0;Rn<16;Rn++)je(R[Rn+1]);for(var Lt=0;Lt<=11;Lt++)je(Z[Lt]);je(17);for(var Wt=0;Wt<16;Wt++)je(Y[Wt+1]);for(var vn=0;vn<=161;vn++)je(we[vn])})(),Ie(65498),Ie(12),je(3),je(1),je(0),je(2),je(17),je(3),je(17),je(0),je(63),je(0);var W=0,se=0,Ce=0;N=0,g=7,this.encode.displayName="_encode_";for(var le,_e,be,De,Ge,ot,jt,Ht,ge,lt=A.data,Yt=A.width,Gt=A.height,xt=4*Yt,hn=0;hn<Gt;){for(le=0;le<xt;){for(Ge=xt*hn+le,jt=-1,Ht=0,ge=0;ge<64;ge++)ot=Ge+(Ht=ge>>3)*xt+(jt=4*(7&ge)),hn+Ht>=Gt&&(ot-=xt*(hn+1+Ht-Gt)),le+jt>=xt&&(ot-=le+jt-xt+4),_e=lt[ot++],be=lt[ot++],De=lt[ot++],ae[ge]=(J[_e]+J[be+256|0]+J[De+512|0]>>16)-128,V[ge]=(J[_e+768|0]+J[be+1024|0]+J[De+1280|0]>>16)-128,E[ge]=(J[_e+1280|0]+J[be+1536|0]+J[De+1792|0]>>16)-128;W=xe(ae,m,W,r,s),se=xe(V,C,se,o,l),Ce=xe(E,C,Ce,o,l),le+=32}hn+=8}if(g>=0){var Et=[];Et[1]=g+1,Et[0]=(1<<g+1)-1,de(Et)}return Ie(65497),new Uint8Array(_)},n=n||50,(function(){for(var A=String.fromCharCode,q=0;q<256;q++)re[q]=A(q)})(),r=te(ee,F),o=te(R,Z),s=te($,H),l=te(Y,we),(function(){for(var A=1,q=2,W=1;W<=15;W++){for(var se=A;se<q;se++)M[32767+se]=W,D[32767+se]=[],D[32767+se][1]=W,D[32767+se][0]=se;for(var Ce=-(q-1);Ce<=-A;Ce++)M[32767+Ce]=W,D[32767+Ce]=[],D[32767+Ce][1]=W,D[32767+Ce][0]=q-1+Ce;A<<=1,q<<=1}})(),(function(){for(var A=0;A<256;A++)J[A]=19595*A,J[A+256|0]=38470*A,J[A+512|0]=7471*A+32768,J[A+768|0]=-11059*A,J[A+1024|0]=-21709*A,J[A+1280|0]=32768*A+8421375,J[A+1536|0]=-27439*A,J[A+1792|0]=-5329*A})(),k(n)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function zc(n,r){if(this.pos=0,this.buffer=n,this.datav=new DataView(n.buffer),this.is_with_alpha=!!r,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Gy(n){function r(F){if(!F)throw Error("assert :P")}function o(F,$,H){for(var R=0;4>R;R++)if(F[$+R]!=H.charCodeAt(R))return!0;return!1}function s(F,$,H,R,Z){for(var Y=0;Y<Z;Y++)F[$+Y]=H[R+Y]}function l(F,$,H,R){for(var Z=0;Z<R;Z++)F[$+Z]=H}function d(F){return new Int32Array(F)}function b(F,$){for(var H=[],R=0;R<F;R++)H.push(new $);return H}function p(F,$){var H=[];return(function R(Z,Y,we){for(var te=we[Y],de=0;de<te&&(Z.push(we.length>Y+1?[]:new $),!(we.length<Y+1));de++)R(Z[de],Y+1,we)})(H,0,F),H}var v=function(){var F=this;function $(f,y){for(var j=1<<y-1>>>0;f&j;)j>>>=1;return j?(f&j-1)+j:f}function H(f,y,j,I,X){r(!(I%j));do f[y+(I-=j)]=X;while(0<I)}function R(f,y,j,I,X){if(r(2328>=X),512>=X)var ie=d(512);else if((ie=d(X))==null)return 0;return(function(oe,ce,pe,Te,Re,Ee){var ke,He,Qe=ce,yt=1<<pe,et=d(16),pt=d(16);for(r(Re!=0),r(Te!=null),r(oe!=null),r(0<pe),He=0;He<Re;++He){if(15<Te[He])return 0;++et[Te[He]]}if(et[0]==Re)return 0;for(pt[1]=0,ke=1;15>ke;++ke){if(et[ke]>1<<ke)return 0;pt[ke+1]=pt[ke]+et[ke]}for(He=0;He<Re;++He)ke=Te[He],0<Te[He]&&(Ee[pt[ke]++]=He);if(pt[15]==1)return(Te=new Z).g=0,Te.value=Ee[0],H(oe,Qe,1,yt,Te),yt;var bt,Mt=-1,zt=yt-1,Sn=0,un=1,Tn=1,nn=1<<pe;for(He=0,ke=1,Re=2;ke<=pe;++ke,Re<<=1){if(un+=Tn<<=1,0>(Tn-=et[ke]))return 0;for(;0<et[ke];--et[ke])(Te=new Z).g=ke,Te.value=Ee[He++],H(oe,Qe+Sn,Re,nn,Te),Sn=$(Sn,ke)}for(ke=pe+1,Re=2;15>=ke;++ke,Re<<=1){if(un+=Tn<<=1,0>(Tn-=et[ke]))return 0;for(;0<et[ke];--et[ke]){if(Te=new Z,(Sn&zt)!=Mt){for(Qe+=nn,bt=1<<(Mt=ke)-pe;15>Mt&&!(0>=(bt-=et[Mt]));)++Mt,bt<<=1;yt+=nn=1<<(bt=Mt-pe),oe[ce+(Mt=Sn&zt)].g=bt+pe,oe[ce+Mt].value=Qe-ce-Mt}Te.g=ke-pe,Te.value=Ee[He++],H(oe,Qe+(Sn>>pe),Re,nn,Te),Sn=$(Sn,ke)}}return un!=2*pt[15]-1?0:yt})(f,y,j,I,X,ie)}function Z(){this.value=this.g=0}function Y(){this.value=this.g=0}function we(){this.G=b(5,Z),this.H=d(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=b(po,Y)}function te(f,y,j,I){r(f!=null),r(y!=null),r(2147483648>I),f.Ca=254,f.I=0,f.b=-8,f.Ka=0,f.oa=y,f.pa=j,f.Jd=y,f.Yc=j+I,f.Zc=4<=I?j+I-4+1:j,_e(f)}function de(f,y){for(var j=0;0<y--;)j|=De(f,128)<<y;return j}function je(f,y){var j=de(f,y);return be(f)?-j:j}function Ie(f,y,j,I){var X,ie=0;for(r(f!=null),r(y!=null),r(4294967288>I),f.Sb=I,f.Ra=0,f.u=0,f.h=0,4<I&&(I=4),X=0;X<I;++X)ie+=y[j+X]<<8*X;f.Ra=ie,f.bb=I,f.oa=y,f.pa=j}function xe(f){for(;8<=f.u&&f.bb<f.Sb;)f.Ra>>>=8,f.Ra+=f.oa[f.pa+f.bb]<<Is-8>>>0,++f.bb,f.u-=8;se(f)&&(f.h=1,f.u=0)}function k(f,y){if(r(0<=y),!f.h&&y<=Wr){var j=W(f)&Go[y];return f.u+=y,xe(f),j}return f.h=1,f.u=0}function A(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function q(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function W(f){return f.Ra>>>(f.u&Is-1)>>>0}function se(f){return r(f.bb<=f.Sb),f.h||f.bb==f.Sb&&f.u>Is}function Ce(f,y){f.u=y,f.h=se(f)}function le(f){f.u>=ia&&(r(f.u>=ia),xe(f))}function _e(f){r(f!=null&&f.oa!=null),f.pa<f.Zc?(f.I=(f.oa[f.pa++]|f.I<<8)>>>0,f.b+=8):(r(f!=null&&f.oa!=null),f.pa<f.Yc?(f.b+=8,f.I=f.oa[f.pa++]|f.I<<8):f.Ka?f.b=0:(f.I<<=8,f.b+=8,f.Ka=1))}function be(f){return de(f,1)}function De(f,y){var j=f.Ca;0>f.b&&_e(f);var I=f.b,X=j*y>>>8,ie=(f.I>>>I>X)+0;for(ie?(j-=X,f.I-=X+1<<I>>>0):j=X+1,I=j,X=0;256<=I;)X+=8,I>>=8;return I=7^X+Qs[I],f.b-=I,f.Ca=(j<<I)-1,ie}function Ge(f,y,j){f[y+0]=j>>24&255,f[y+1]=j>>16&255,f[y+2]=j>>8&255,f[y+3]=255&j}function ot(f,y){return f[y+0]|f[y+1]<<8}function jt(f,y){return ot(f,y)|f[y+2]<<16}function Ht(f,y){return ot(f,y)|ot(f,y+2)<<16}function ge(f,y){var j=1<<y;return r(f!=null),r(0<y),f.X=d(j),f.X==null?0:(f.Mb=32-y,f.Xa=y,1)}function lt(f,y){r(f!=null),r(y!=null),r(f.Xa==y.Xa),s(y.X,0,f.X,0,1<<y.Xa)}function Yt(){this.X=[],this.Xa=this.Mb=0}function Gt(f,y,j,I){r(j!=null),r(I!=null);var X=j[0],ie=I[0];return X==0&&(X=(f*ie+y/2)/y),ie==0&&(ie=(y*X+f/2)/f),0>=X||0>=ie?0:(j[0]=X,I[0]=ie,1)}function xt(f,y){return f+(1<<y)-1>>>y}function hn(f,y){return((4278255360&f)+(4278255360&y)>>>0&4278255360)+((16711935&f)+(16711935&y)>>>0&16711935)>>>0}function Et(f,y){F[y]=function(j,I,X,ie,oe,ce,pe){var Te;for(Te=0;Te<oe;++Te){var Re=F[f](ce[pe+Te-1],X,ie+Te);ce[pe+Te]=hn(j[I+Te],Re)}}}function gn(){this.ud=this.hd=this.jd=0}function Zt(f,y){return((4278124286&(f^y))>>>1)+(f&y)>>>0}function xn(f){return 0<=f&&256>f?f:0>f?0:255<f?255:void 0}function tt(f,y){return xn(f+(f-y+.5>>1))}function Rn(f,y,j){return Math.abs(y-j)-Math.abs(f-j)}function Lt(f,y,j,I,X,ie,oe){for(I=ie[oe-1],j=0;j<X;++j)ie[oe+j]=I=hn(f[y+j],I)}function Wt(f,y,j,I,X){var ie;for(ie=0;ie<j;++ie){var oe=f[y+ie],ce=oe>>8&255,pe=16711935&(pe=(pe=16711935&oe)+((ce<<16)+ce));I[X+ie]=(4278255360&oe)+pe>>>0}}function vn(f,y){y.jd=255&f,y.hd=f>>8&255,y.ud=f>>16&255}function ct(f,y,j,I,X,ie){var oe;for(oe=0;oe<I;++oe){var ce=y[j+oe],pe=ce>>>8,Te=ce,Re=255&(Re=(Re=ce>>>16)+((f.jd<<24>>24)*(pe<<24>>24)>>>5));Te=255&(Te=(Te+=(f.hd<<24>>24)*(pe<<24>>24)>>>5)+((f.ud<<24>>24)*(Re<<24>>24)>>>5)),X[ie+oe]=(4278255360&ce)+(Re<<16)+Te}}function ye(f,y,j,I,X){F[y]=function(ie,oe,ce,pe,Te,Re,Ee,ke,He){for(pe=Ee;pe<ke;++pe)for(Ee=0;Ee<He;++Ee)Te[Re++]=X(ce[I(ie[oe++])])},F[f]=function(ie,oe,ce,pe,Te,Re,Ee){var ke=8>>ie.b,He=ie.Ea,Qe=ie.K[0],yt=ie.w;if(8>ke)for(ie=(1<<ie.b)-1,yt=(1<<ke)-1;oe<ce;++oe){var et,pt=0;for(et=0;et<He;++et)et&ie||(pt=I(pe[Te++])),Re[Ee++]=X(Qe[pt&yt]),pt>>=ke}else F["VP8LMapColor"+j](pe,Te,Qe,yt,Re,Ee,oe,ce,He)}}function ze(f,y,j,I,X){for(j=y+j;y<j;){var ie=f[y++];I[X++]=ie>>16&255,I[X++]=ie>>8&255,I[X++]=255&ie}}function Nt(f,y,j,I,X){for(j=y+j;y<j;){var ie=f[y++];I[X++]=ie>>16&255,I[X++]=ie>>8&255,I[X++]=255&ie,I[X++]=ie>>24&255}}function Ke(f,y,j,I,X){for(j=y+j;y<j;){var ie=(oe=f[y++])>>16&240|oe>>12&15,oe=240&oe|oe>>28&15;I[X++]=ie,I[X++]=oe}}function vt(f,y,j,I,X){for(j=y+j;y<j;){var ie=(oe=f[y++])>>16&248|oe>>13&7,oe=oe>>5&224|oe>>3&31;I[X++]=ie,I[X++]=oe}}function Vt(f,y,j,I,X){for(j=y+j;y<j;){var ie=f[y++];I[X++]=255&ie,I[X++]=ie>>8&255,I[X++]=ie>>16&255}}function ht(f,y,j,I,X,ie){if(ie==0)for(j=y+j;y<j;)Ge(I,((ie=f[y++])[0]>>24|ie[1]>>8&65280|ie[2]<<8&16711680|ie[3]<<24)>>>0),X+=32;else s(I,X,f,y,j)}function Je(f,y){F[y][0]=F[f+"0"],F[y][1]=F[f+"1"],F[y][2]=F[f+"2"],F[y][3]=F[f+"3"],F[y][4]=F[f+"4"],F[y][5]=F[f+"5"],F[y][6]=F[f+"6"],F[y][7]=F[f+"7"],F[y][8]=F[f+"8"],F[y][9]=F[f+"9"],F[y][10]=F[f+"10"],F[y][11]=F[f+"11"],F[y][12]=F[f+"12"],F[y][13]=F[f+"13"],F[y][14]=F[f+"0"],F[y][15]=F[f+"0"]}function Ft(f){return f==us||f==aa||f==ul||f==iu}function At(){this.eb=[],this.size=this.A=this.fb=0}function Jt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function An(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new At,this.f.kb=new Jt,this.sd=null}function dn(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function ti(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Tr(f){return alert("todo:WebPSamplerProcessPlane"),f.T}function en(f,y){var j=f.T,I=y.ba.f.RGBA,X=I.eb,ie=I.fb+f.ka*I.A,oe=Fr[y.ba.S],ce=f.y,pe=f.O,Te=f.f,Re=f.N,Ee=f.ea,ke=f.W,He=y.cc,Qe=y.dc,yt=y.Mc,et=y.Nc,pt=f.ka,bt=f.ka+f.T,Mt=f.U,zt=Mt+1>>1;for(pt==0?oe(ce,pe,null,null,Te,Re,Ee,ke,Te,Re,Ee,ke,X,ie,null,null,Mt):(oe(y.ec,y.fc,ce,pe,He,Qe,yt,et,Te,Re,Ee,ke,X,ie-I.A,X,ie,Mt),++j);pt+2<bt;pt+=2)He=Te,Qe=Re,yt=Ee,et=ke,Re+=f.Rc,ke+=f.Rc,ie+=2*I.A,oe(ce,(pe+=2*f.fa)-f.fa,ce,pe,He,Qe,yt,et,Te,Re,Ee,ke,X,ie-I.A,X,ie,Mt);return pe+=f.fa,f.j+bt<f.o?(s(y.ec,y.fc,ce,pe,Mt),s(y.cc,y.dc,Te,Re,zt),s(y.Mc,y.Nc,Ee,ke,zt),j--):1&bt||oe(ce,pe,null,null,Te,Re,Ee,ke,Te,Re,Ee,ke,X,ie+I.A,null,null,Mt),j}function zi(f,y,j){var I=f.F,X=[f.J];if(I!=null){var ie=f.U,oe=y.ba.S,ce=oe==io||oe==ul;y=y.ba.f.RGBA;var pe=[0],Te=f.ka;pe[0]=f.T,f.Kb&&(Te==0?--pe[0]:(--Te,X[0]-=f.width),f.j+f.ka+f.T==f.o&&(pe[0]=f.o-f.j-Te));var Re=y.eb;Te=y.fb+Te*y.A,f=to(I,X[0],f.width,ie,pe,Re,Te+(ce?0:3),y.A),r(j==pe),f&&Ft(oe)&&To(Re,Te,ce,ie,pe,y.A)}return 0}function Mr(f){var y=f.ma,j=y.ba.S,I=11>j,X=j==Ti||j==dr||j==io||j==cl||j==12||Ft(j);if(y.memory=null,y.Ib=null,y.Jb=null,y.Nd=null,!Js(y.Oa,f,X?11:12))return 0;if(X&&Ft(j)&&ma(),f.da)alert("todo:use_scaling");else{if(I){if(y.Ib=Tr,f.Kb){if(j=f.U+1>>1,y.memory=d(f.U+2*j),y.memory==null)return 0;y.ec=y.memory,y.fc=0,y.cc=y.ec,y.dc=y.fc+f.U,y.Mc=y.cc,y.Nc=y.dc+j,y.Ib=en,ma()}}else alert("todo:EmitYUV");X&&(y.Jb=zi,I&&Dr())}if(I&&!Ql){for(f=0;256>f;++f)ca[f]=89858*(f-128)+As>>ks,Ma[f]=-22014*(f-128)+As,Ka[f]=-45773*(f-128),No[f]=113618*(f-128)+As>>ks;for(f=Yr;f<Xa;++f)y=76283*(f-16)+As>>ks,fs[f-Yr]=Or(y,255),Ba[f-Yr]=Or(y+8>>4,15);Ql=1}return 1}function qt(f){var y=f.ma,j=f.U,I=f.T;return r(!(1&f.ka)),0>=j||0>=I?0:(j=y.Ib(f,y),y.Jb!=null&&y.Jb(f,y,j),y.Dc+=j,1)}function Zi(f){f.ma.memory=null}function Ji(f,y,j,I){return k(f,8)!=47?0:(y[0]=k(f,14)+1,j[0]=k(f,14)+1,I[0]=k(f,1),k(f,3)!=0?0:!f.h)}function Cr(f,y){if(4>f)return f+1;var j=f-2>>1;return(2+(1&f)<<j)+k(y,j)+1}function jr(f,y){return 120<y?y-120:1<=(j=((j=js[y-1])>>4)*f+(8-(15&j)))?j:1;var j}function hi(f,y,j){var I=W(j),X=f[y+=255&I].g-8;return 0<X&&(Ce(j,j.u+8),I=W(j),y+=f[y].value,y+=I&(1<<X)-1),Ce(j,j.u+f[y].g),f[y].value}function wt(f,y,j){return j.g+=f.g,j.value+=f.value<<y>>>0,r(8>=j.g),f.g}function Wn(f,y,j){var I=f.xc;return r((y=I==0?0:f.vc[f.md*(j>>I)+(y>>I)])<f.Wb),f.Ya[y]}function mn(f,y,j,I){var X=f.ab,ie=f.c*y,oe=f.C;y=oe+y;var ce=j,pe=I;for(I=f.Ta,j=f.Ua;0<X--;){var Te=f.gc[X],Re=oe,Ee=y,ke=ce,He=pe,Qe=(pe=I,ce=j,Te.Ea);switch(r(Re<Ee),r(Ee<=Te.nc),Te.hc){case 2:Jn(ke,He,(Ee-Re)*Qe,pe,ce);break;case 0:var yt=Re,et=Ee,pt=pe,bt=ce,Mt=(nn=Te).Ea;yt==0&&(Ha(ke,He,null,null,1,pt,bt),Lt(ke,He+1,0,0,Mt-1,pt,bt+1),He+=Mt,bt+=Mt,++yt);for(var zt=1<<nn.b,Sn=zt-1,un=xt(Mt,nn.b),Tn=nn.K,nn=nn.w+(yt>>nn.b)*un;yt<et;){var pi=Tn,Lr=nn,zn=1;for(Jl(ke,He,pt,bt-Mt,1,pt,bt);zn<Mt;){var Ut=(zn&~Sn)+zt;Ut>Mt&&(Ut=Mt),(0,va[pi[Lr++]>>8&15])(ke,He+ +zn,pt,bt+zn-Mt,Ut-zn,pt,bt+zn),zn=Ut}He+=Mt,bt+=Mt,++yt&Sn||(nn+=un)}Ee!=Te.nc&&s(pe,ce-Qe,pe,ce+(Ee-Re-1)*Qe,Qe);break;case 1:for(Qe=ke,et=He,Mt=(ke=Te.Ea)-(bt=ke&~(pt=(He=1<<Te.b)-1)),yt=xt(ke,Te.b),zt=Te.K,Te=Te.w+(Re>>Te.b)*yt;Re<Ee;){for(Sn=zt,un=Te,Tn=new gn,nn=et+bt,pi=et+ke;et<nn;)vn(Sn[un++],Tn),Lc(Tn,Qe,et,He,pe,ce),et+=He,ce+=He;et<pi&&(vn(Sn[un++],Tn),Lc(Tn,Qe,et,Mt,pe,ce),et+=Mt,ce+=Mt),++Re&pt||(Te+=yt)}break;case 3:if(ke==pe&&He==ce&&0<Te.b){for(et=pe,ke=Qe=ce+(Ee-Re)*Qe-(bt=(Ee-Re)*xt(Te.Ea,Te.b)),He=pe,pt=ce,yt=[],bt=(Mt=bt)-1;0<=bt;--bt)yt[bt]=He[pt+bt];for(bt=Mt-1;0<=bt;--bt)et[ke+bt]=yt[bt];Ts(Te,Re,Ee,pe,Qe,pe,ce)}else Ts(Te,Re,Ee,ke,He,pe,ce)}ce=I,pe=j}pe!=j&&s(I,j,ce,pe,ie)}function Ot(f,y){var j=f.V,I=f.Ba+f.c*f.C,X=y-f.C;if(r(y<=f.l.o),r(16>=X),0<X){var ie=f.l,oe=f.Ta,ce=f.Ua,pe=ie.width;if(mn(f,X,j,I),X=ce=[ce],r((j=f.C)<(I=y)),r(ie.v<ie.va),I>ie.o&&(I=ie.o),j<ie.j){var Te=ie.j-j;j=ie.j,X[0]+=Te*pe}if(j>=I?j=0:(X[0]+=4*ie.v,ie.ka=j-ie.j,ie.U=ie.va-ie.v,ie.T=I-j,j=1),j){if(ce=ce[0],11>(j=f.ca).S){var Re=j.f.RGBA,Ee=(I=j.S,X=ie.U,ie=ie.T,Te=Re.eb,Re.A),ke=ie;for(Re=Re.fb+f.Ma*Re.A;0<ke--;){var He=oe,Qe=ce,yt=X,et=Te,pt=Re;switch(I){case ki:el(He,Qe,yt,et,pt);break;case Ti:Cl(He,Qe,yt,et,pt);break;case us:Cl(He,Qe,yt,et,pt),To(et,pt,0,yt,1,0);break;case Mc:Nl(He,Qe,yt,et,pt);break;case dr:ht(He,Qe,yt,et,pt,1);break;case aa:ht(He,Qe,yt,et,pt,1),To(et,pt,0,yt,1,0);break;case io:ht(He,Qe,yt,et,pt,0);break;case ul:ht(He,Qe,yt,et,pt,0),To(et,pt,1,yt,1,0);break;case cl:jl(He,Qe,yt,et,pt);break;case iu:jl(He,Qe,yt,et,pt),Io(et,pt,yt,1,0);break;case ro:wo(He,Qe,yt,et,pt);break;default:r(0)}ce+=pe,Re+=Ee}f.Ma+=ie}else alert("todo:EmitRescaledRowsYUVA");r(f.Ma<=j.height)}}f.C=y,r(f.C<=f.i)}function Dt(f){var y;if(0<f.ua)return 0;for(y=0;y<f.Wb;++y){var j=f.Ya[y].G,I=f.Ya[y].H;if(0<j[1][I[1]+0].g||0<j[2][I[2]+0].g||0<j[3][I[3]+0].g)return 0}return 1}function an(f,y,j,I,X,ie){if(f.Z!=0){var oe=f.qd,ce=f.rd;for(r(Ca[f.Z]!=null);y<j;++y)Ca[f.Z](oe,ce,I,X,I,X,ie),oe=I,ce=X,X+=ie;f.qd=oe,f.rd=ce}}function rn(f,y){var j=f.l.ma,I=j.Z==0||j.Z==1?f.l.j:f.C;if(I=f.C<I?I:f.C,r(y<=f.l.o),y>I){var X=f.l.width,ie=j.ca,oe=j.tb+X*I,ce=f.V,pe=f.Ba+f.c*I,Te=f.gc;r(f.ab==1),r(Te[0].hc==3),ra(Te[0],I,y,ce,pe,ie,oe),an(j,I,y,ie,oe,X)}f.C=f.Ma=y}function bn(f,y,j,I,X,ie,oe){var ce=f.$/I,pe=f.$%I,Te=f.m,Re=f.s,Ee=j+f.$,ke=Ee;X=j+I*X;var He=j+I*ie,Qe=280+Re.ua,yt=f.Pb?ce:16777216,et=0<Re.ua?Re.Wa:null,pt=Re.wc,bt=Ee<He?Wn(Re,pe,ce):null;r(f.C<ie),r(He<=X);var Mt=!1;e:for(;;){for(;Mt||Ee<He;){var zt=0;if(ce>=yt){var Sn=Ee-j;r((yt=f).Pb),yt.wd=yt.m,yt.xd=Sn,0<yt.s.ua&&lt(yt.s.Wa,yt.s.vb),yt=ce+Ga}if(pe&pt||(bt=Wn(Re,pe,ce)),r(bt!=null),bt.Qb&&(y[Ee]=bt.qb,Mt=!0),!Mt)if(le(Te),bt.jc){zt=Te,Sn=y;var un=Ee,Tn=bt.pd[W(zt)&po-1];r(bt.jc),256>Tn.g?(Ce(zt,zt.u+Tn.g),Sn[un]=Tn.value,zt=0):(Ce(zt,zt.u+Tn.g-256),r(256<=Tn.value),zt=Tn.value),zt==0&&(Mt=!0)}else zt=hi(bt.G[0],bt.H[0],Te);if(Te.h)break;if(Mt||256>zt){if(!Mt)if(bt.nd)y[Ee]=(bt.qb|zt<<8)>>>0;else{if(le(Te),Mt=hi(bt.G[1],bt.H[1],Te),le(Te),Sn=hi(bt.G[2],bt.H[2],Te),un=hi(bt.G[3],bt.H[3],Te),Te.h)break;y[Ee]=(un<<24|Mt<<16|zt<<8|Sn)>>>0}if(Mt=!1,++Ee,++pe>=I&&(pe=0,++ce,oe!=null&&ce<=ie&&!(ce%16)&&oe(f,ce),et!=null))for(;ke<Ee;)zt=y[ke++],et.X[(506832829*zt&4294967295)>>>et.Mb]=zt}else if(280>zt){if(zt=Cr(zt-256,Te),Sn=hi(bt.G[4],bt.H[4],Te),le(Te),Sn=jr(I,Sn=Cr(Sn,Te)),Te.h)break;if(Ee-j<Sn||X-Ee<zt)break e;for(un=0;un<zt;++un)y[Ee+un]=y[Ee+un-Sn];for(Ee+=zt,pe+=zt;pe>=I;)pe-=I,++ce,oe!=null&&ce<=ie&&!(ce%16)&&oe(f,ce);if(r(Ee<=X),pe&pt&&(bt=Wn(Re,pe,ce)),et!=null)for(;ke<Ee;)zt=y[ke++],et.X[(506832829*zt&4294967295)>>>et.Mb]=zt}else{if(!(zt<Qe))break e;for(Mt=zt-280,r(et!=null);ke<Ee;)zt=y[ke++],et.X[(506832829*zt&4294967295)>>>et.Mb]=zt;zt=Ee,r(!(Mt>>>(Sn=et).Xa)),y[zt]=Sn.X[Mt],Mt=!0}Mt||r(Te.h==se(Te))}if(f.Pb&&Te.h&&Ee<X)r(f.m.h),f.a=5,f.m=f.wd,f.$=f.xd,0<f.s.ua&&lt(f.s.vb,f.s.Wa);else{if(Te.h)break e;oe?.(f,ce>ie?ie:ce),f.a=0,f.$=Ee-j}return 1}return f.a=3,0}function ni(f){r(f!=null),f.vc=null,f.yc=null,f.Ya=null;var y=f.Wa;y!=null&&(y.X=null),f.vb=null,r(f!=null)}function hr(){var f=new sn;return f==null?null:(f.a=0,f.xb=Oc,Je("Predictor","VP8LPredictors"),Je("Predictor","VP8LPredictors_C"),Je("PredictorAdd","VP8LPredictorsAdd"),Je("PredictorAdd","VP8LPredictorsAdd_C"),Jn=Wt,Lc=ct,el=ze,Cl=Nt,jl=Ke,wo=vt,Nl=Vt,F.VP8LMapColor32b=Oi,F.VP8LMapColor8b=Xo,f)}function Di(f,y,j,I,X){var ie=1,oe=[f],ce=[y],pe=I.m,Te=I.s,Re=null,Ee=0;e:for(;;){if(j)for(;ie&&k(pe,1);){var ke=oe,He=ce,Qe=I,yt=1,et=Qe.m,pt=Qe.gc[Qe.ab],bt=k(et,2);if(Qe.Oc&1<<bt)ie=0;else{switch(Qe.Oc|=1<<bt,pt.hc=bt,pt.Ea=ke[0],pt.nc=He[0],pt.K=[null],++Qe.ab,r(4>=Qe.ab),bt){case 0:case 1:pt.b=k(et,3)+2,yt=Di(xt(pt.Ea,pt.b),xt(pt.nc,pt.b),0,Qe,pt.K),pt.K=pt.K[0];break;case 3:var Mt,zt=k(et,8)+1,Sn=16<zt?0:4<zt?1:2<zt?2:3;if(ke[0]=xt(pt.Ea,Sn),pt.b=Sn,Mt=yt=Di(zt,1,0,Qe,pt.K)){var un,Tn=zt,nn=pt,pi=1<<(8>>nn.b),Lr=d(pi);if(Lr==null)Mt=0;else{var zn=nn.K[0],Ut=nn.w;for(Lr[0]=nn.K[0][0],un=1;un<1*Tn;++un)Lr[un]=hn(zn[Ut+un],Lr[un-1]);for(;un<4*pi;++un)Lr[un]=0;nn.K[0]=null,nn.K[0]=Lr,Mt=1}}yt=Mt;break;case 2:break;default:r(0)}ie=yt}}if(oe=oe[0],ce=ce[0],ie&&k(pe,1)&&!(ie=1<=(Ee=k(pe,4))&&11>=Ee)){I.a=3;break e}var Xt;if(Xt=ie)t:{var cr,Yn,gi,tr=I,Pi=oe,pr=ce,Yi=Ee,Ur=j,ao=tr.m,Pr=tr.s,ii=[null],Gi=1,mr=0,ai=sa[Yi];n:for(;;){if(Ur&&k(ao,1)){var nr=k(ao,3)+2,Si=xt(Pi,nr),yi=xt(pr,nr),Xi=Si*yi;if(!Di(Si,yi,0,tr,ii))break n;for(ii=ii[0],Pr.xc=nr,cr=0;cr<Xi;++cr){var Ui=ii[cr]>>8&65535;ii[cr]=Ui,Ui>=Gi&&(Gi=Ui+1)}}if(ao.h)break n;for(Yn=0;5>Yn;++Yn){var Er=dl[Yn];!Yn&&0<Yi&&(Er+=1<<Yi),mr<Er&&(mr=Er)}var go=b(Gi*ai,Z),zr=Gi,si=b(zr,we);if(si==null)var Oo=null;else r(65536>=zr),Oo=si;var Gr=d(mr);if(Oo==null||Gr==null||go==null){tr.a=1;break n}var Mn=go;for(cr=gi=0;cr<Gi;++cr){var In=Oo[cr],Ei=In.G,Oa=In.H,yo=0,Fo=1,so=0;for(Yn=0;5>Yn;++Yn){Er=dl[Yn],Ei[Yn]=Mn,Oa[Yn]=gi,!Yn&&0<Yi&&(Er+=1<<Yi);r:{var pl,_l=Er,wc=tr,_r=Gr,Sc=Mn,hl=gi,Uc=0,Za=wc.m,Ku=k(Za,1);if(l(_r,0,0,_l),Ku){var gl=k(Za,1)+1,ec=k(Za,1),tc=k(Za,ec==0?1:8);_r[tc]=1,gl==2&&(_r[tc=k(Za,8)]=1);var Uo=1}else{var Xr=d(19),nc=k(Za,4)+4;if(19<nc){wc.a=3;var yl=0;break r}for(pl=0;pl<nc;++pl)Xr[Al[pl]]=k(Za,3);var ic=void 0,rc=void 0,Ja=wc,oc=Xr,ac=_l,Ec=_r,Tc=0,il=Ja.m,Zu=8,xl=b(128,Z);i:for(;R(xl,0,7,oc,19);){if(k(il,1)){var wu=2+2*k(il,3);if((ic=2+k(il,wu))>ac)break i}else ic=ac;for(rc=0;rc<ac&&ic--;){le(il);var sc=xl[0+(127&W(il))];Ce(il,il.u+sc.g);var Dl=sc.value;if(16>Dl)Ec[rc++]=Dl,Dl!=0&&(Zu=Dl);else{var Ju=Dl==16,ou=Dl-16,Qu=ds[ou],lc=k(il,Cs[ou])+Qu;if(rc+lc>ac)break i;for(var Su=Ju?Zu:0;0<lc--;)Ec[rc++]=Su}}Tc=1;break i}Tc||(Ja.a=3),Uo=Tc}(Uo=Uo&&!Za.h)&&(Uc=R(Sc,hl,8,_r,_l)),Uo&&Uc!=0?yl=Uc:(wc.a=3,yl=0)}if(yl==0)break n;if(Fo&&Bc[Yn]==1&&(Fo=Mn[gi].g==0),yo+=Mn[gi].g,gi+=yl,3>=Yn){var cc,au=Gr[0];for(cc=1;cc<Er;++cc)Gr[cc]>au&&(au=Gr[cc]);so+=au}}if(In.nd=Fo,In.Qb=0,Fo&&(In.qb=(Ei[3][Oa[3]+0].value<<24|Ei[1][Oa[1]+0].value<<16|Ei[2][Oa[2]+0].value)>>>0,yo==0&&256>Ei[0][Oa[0]+0].value&&(In.Qb=1,In.qb+=Ei[0][Oa[0]+0].value<<8)),In.jc=!In.Qb&&6>so,In.jc){var uc,Ps=In;for(uc=0;uc<po;++uc){var ps=uc,Ms=Ps.pd[ps],dc=Ps.G[0][Ps.H[0]+ps];256<=dc.value?(Ms.g=dc.g+256,Ms.value=dc.value):(Ms.g=0,Ms.value=0,ps>>=wt(dc,8,Ms),ps>>=wt(Ps.G[1][Ps.H[1]+ps],16,Ms),ps>>=wt(Ps.G[2][Ps.H[2]+ps],0,Ms),wt(Ps.G[3][Ps.H[3]+ps],24,Ms))}}}Pr.vc=ii,Pr.Wb=Gi,Pr.Ya=Oo,Pr.yc=go,Xt=1;break t}Xt=0}if(!(ie=Xt)){I.a=3;break e}if(0<Ee){if(Te.ua=1<<Ee,!ge(Te.Wa,Ee)){I.a=1,ie=0;break e}}else Te.ua=0;var Tu=I,Bs=oe,Nd=ce,Os=Tu.s,Qa=Os.xc;if(Tu.c=Bs,Tu.i=Nd,Os.md=xt(Bs,Qa),Os.wc=Qa==0?-1:(1<<Qa)-1,j){I.xb=Ta;break e}if((Re=d(oe*ce))==null){I.a=1,ie=0;break e}ie=(ie=bn(I,Re,0,oe,ce,ce,null))&&!pe.h;break e}return ie?(X!=null?X[0]=Re:(r(Re==null),r(j)),I.$=0,j||ni(Te)):ni(Te),ie}function qi(f,y){var j=f.c*f.i,I=j+y+16*y;return r(f.c<=y),f.V=d(I),f.V==null?(f.Ta=null,f.Ua=0,f.a=1,0):(f.Ta=f.V,f.Ua=f.Ba+j+y,1)}function Br(f,y){var j=f.C,I=y-j,X=f.V,ie=f.Ba+f.c*j;for(r(y<=f.l.o);0<I;){var oe=16<I?16:I,ce=f.l.ma,pe=f.l.width,Te=pe*oe,Re=ce.ca,Ee=ce.tb+pe*j,ke=f.Ta,He=f.Ua;mn(f,oe,X,ie),wa(ke,He,Re,Ee,Te),an(ce,j,j+oe,Re,Ee,pe),I-=oe,X+=oe*f.c,j+=oe}r(j==y),f.C=f.Ma=y}function _i(){this.ub=this.yd=this.td=this.Rb=0}function ar(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function ui(){this.Fb=this.Bb=this.Cb=0,this.Zb=d(4),this.Lb=d(4)}function zo(){this.Yb=(function(){var f=[];return(function y(j,I,X){for(var ie=X[I],oe=0;oe<ie&&(j.push(X.length>I+1?[]:0),!(X.length<I+1));oe++)y(j[oe],I+1,X)})(f,0,[3,11]),f})()}function Hn(){this.jb=d(3),this.Wc=p([4,8],zo),this.Xc=p([4,17],zo)}function ys(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new d(4),this.od=new d(4)}function di(){this.ld=this.La=this.dd=this.tc=0}function Wo(){this.Na=this.la=0}function Ri(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ds(){this.ad=d(384),this.Za=0,this.Ob=d(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function ts(){this.uc=this.M=this.Nb=0,this.wa=Array(new di),this.Y=0,this.ya=Array(new Ds),this.aa=0,this.l=new Xs}function ns(){this.y=d(16),this.f=d(8),this.ea=d(8)}function xs(){this.cb=this.a=0,this.sc="",this.m=new A,this.Od=new _i,this.Kc=new ar,this.ed=new ys,this.Qa=new ui,this.Ic=this.$c=this.Aa=0,this.D=new ts,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=b(8,A),this.ia=0,this.pb=b(4,Ri),this.Pa=new Hn,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new ns),this.Hd=0,this.rb=Array(new Wo),this.sb=0,this.wa=Array(new di),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ds),this.L=this.aa=0,this.gd=p([4,2],di),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Or(f,y){return 0>f?0:f>y?y:f}function Xs(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Nr(){var f=new xs;return f!=null&&(f.a=0,f.sc="OK",f.cb=0,f.Xb=0,La||(La=is)),f}function Mi(f,y,j){return f.a==0&&(f.a=y,f.sc=j,f.cb=0),0}function fi(f,y,j){return 3<=j&&f[y+0]==157&&f[y+1]==1&&f[y+2]==42}function gr(f,y){if(f==null)return 0;if(f.a=0,f.sc="OK",y==null)return Mi(f,2,"null VP8Io passed to VP8GetHeaders()");var j=y.data,I=y.w,X=y.ha;if(4>X)return Mi(f,7,"Truncated header.");var ie=j[I+0]|j[I+1]<<8|j[I+2]<<16,oe=f.Od;if(oe.Rb=!(1&ie),oe.td=ie>>1&7,oe.yd=ie>>4&1,oe.ub=ie>>5,3<oe.td)return Mi(f,3,"Incorrect keyframe parameters.");if(!oe.yd)return Mi(f,4,"Frame not displayable.");I+=3,X-=3;var ce=f.Kc;if(oe.Rb){if(7>X)return Mi(f,7,"cannot parse picture header");if(!fi(j,I,X))return Mi(f,3,"Bad code word");ce.c=16383&(j[I+4]<<8|j[I+3]),ce.Td=j[I+4]>>6,ce.i=16383&(j[I+6]<<8|j[I+5]),ce.Ud=j[I+6]>>6,I+=7,X-=7,f.za=ce.c+15>>4,f.Ub=ce.i+15>>4,y.width=ce.c,y.height=ce.i,y.Da=0,y.j=0,y.v=0,y.va=y.width,y.o=y.height,y.da=0,y.ib=y.width,y.hb=y.height,y.U=y.width,y.T=y.height,l((ie=f.Pa).jb,0,255,ie.jb.length),r((ie=f.Qa)!=null),ie.Cb=0,ie.Bb=0,ie.Fb=1,l(ie.Zb,0,0,ie.Zb.length),l(ie.Lb,0,0,ie.Lb)}if(oe.ub>X)return Mi(f,7,"bad partition length");te(ie=f.m,j,I,oe.ub),I+=oe.ub,X-=oe.ub,oe.Rb&&(ce.Ld=be(ie),ce.Kd=be(ie)),ce=f.Qa;var pe,Te=f.Pa;if(r(ie!=null),r(ce!=null),ce.Cb=be(ie),ce.Cb){if(ce.Bb=be(ie),be(ie)){for(ce.Fb=be(ie),pe=0;4>pe;++pe)ce.Zb[pe]=be(ie)?je(ie,7):0;for(pe=0;4>pe;++pe)ce.Lb[pe]=be(ie)?je(ie,6):0}if(ce.Bb)for(pe=0;3>pe;++pe)Te.jb[pe]=be(ie)?de(ie,8):255}else ce.Bb=0;if(ie.Ka)return Mi(f,3,"cannot parse segment header");if((ce=f.ed).zd=be(ie),ce.Tb=de(ie,6),ce.wb=de(ie,3),ce.Pc=be(ie),ce.Pc&&be(ie)){for(Te=0;4>Te;++Te)be(ie)&&(ce.vd[Te]=je(ie,6));for(Te=0;4>Te;++Te)be(ie)&&(ce.od[Te]=je(ie,6))}if(f.L=ce.Tb==0?0:ce.zd?1:2,ie.Ka)return Mi(f,3,"cannot parse filter header");var Re=X;if(X=pe=I,I=pe+Re,ce=Re,f.Xb=(1<<de(f.m,2))-1,Re<3*(Te=f.Xb))j=7;else{for(pe+=3*Te,ce-=3*Te,Re=0;Re<Te;++Re){var Ee=j[X+0]|j[X+1]<<8|j[X+2]<<16;Ee>ce&&(Ee=ce),te(f.Jc[+Re],j,pe,Ee),pe+=Ee,ce-=Ee,X+=3}te(f.Jc[+Te],j,pe,ce),j=pe<I?0:5}if(j!=0)return Mi(f,j,"cannot parse partitions");for(j=de(pe=f.m,7),X=be(pe)?je(pe,4):0,I=be(pe)?je(pe,4):0,ce=be(pe)?je(pe,4):0,Te=be(pe)?je(pe,4):0,pe=be(pe)?je(pe,4):0,Re=f.Qa,Ee=0;4>Ee;++Ee){if(Re.Cb){var ke=Re.Zb[Ee];Re.Fb||(ke+=j)}else{if(0<Ee){f.pb[Ee]=f.pb[0];continue}ke=j}var He=f.pb[Ee];He.Sc[0]=Co[Or(ke+X,127)],He.Sc[1]=Mo[Or(ke+0,127)],He.Eb[0]=2*Co[Or(ke+I,127)],He.Eb[1]=101581*Mo[Or(ke+ce,127)]>>16,8>He.Eb[1]&&(He.Eb[1]=8),He.Qc[0]=Co[Or(ke+Te,117)],He.Qc[1]=Mo[Or(ke+pe,127)],He.lc=ke+pe}if(!oe.Rb)return Mi(f,4,"Not a key frame.");for(be(ie),oe=f.Pa,j=0;4>j;++j){for(X=0;8>X;++X)for(I=0;3>I;++I)for(ce=0;11>ce;++ce)Te=De(ie,Ir[j][X][I][ce])?de(ie,8):Xu[j][X][I][ce],oe.Wc[j][X].Yb[I][ce]=Te;for(X=0;17>X;++X)oe.Xc[j][X]=oe.Wc[j][En[X]]}return f.kc=be(ie),f.kc&&(f.Bd=de(ie,8)),f.cb=1}function is(f,y,j,I,X,ie,oe){var ce=y[X].Yb[j];for(j=0;16>X;++X){if(!De(f,ce[j+0]))return X;for(;!De(f,ce[j+1]);)if(ce=y[++X].Yb[0],j=0,X==16)return 16;var pe=y[X+1].Yb;if(De(f,ce[j+2])){var Te=f,Re=0;if(De(Te,(ke=ce)[(Ee=j)+3]))if(De(Te,ke[Ee+6])){for(ce=0,Ee=2*(Re=De(Te,ke[Ee+8]))+(ke=De(Te,ke[Ee+9+Re])),Re=0,ke=ru[Ee];ke[ce];++ce)Re+=Re+De(Te,ke[ce]);Re+=3+(8<<Ee)}else De(Te,ke[Ee+7])?(Re=7+2*De(Te,165),Re+=De(Te,145)):Re=5+De(Te,159);else Re=De(Te,ke[Ee+4])?3+De(Te,ke[Ee+5]):2;ce=pe[2]}else Re=1,ce=pe[1];pe=oe+Pl[X],0>(Te=f).b&&_e(Te);var Ee,ke=Te.b,He=(Ee=Te.Ca>>1)-(Te.I>>ke)>>31;--Te.b,Te.Ca+=He,Te.Ca|=1,Te.I-=(Ee+1&He)<<ke,ie[pe]=((Re^He)-He)*I[(0<X)+0]}return 16}function Xl(f){var y=f.rb[f.sb-1];y.la=0,y.Na=0,l(f.zc,0,0,f.zc.length),f.ja=0}function bo(f,y,j,I,X){X=f[y+j+32*I]+(X>>3),f[y+j+32*I]=-256&X?0>X?0:255:X}function co(f,y,j,I,X,ie){bo(f,y,0,j,I+X),bo(f,y,1,j,I+ie),bo(f,y,2,j,I-ie),bo(f,y,3,j,I-X)}function Hi(f){return(20091*f>>16)+f}function Qo(f,y,j,I){var X,ie=0,oe=d(16);for(X=0;4>X;++X){var ce=f[y+0]+f[y+8],pe=f[y+0]-f[y+8],Te=(35468*f[y+4]>>16)-Hi(f[y+12]),Re=Hi(f[y+4])+(35468*f[y+12]>>16);oe[ie+0]=ce+Re,oe[ie+1]=pe+Te,oe[ie+2]=pe-Te,oe[ie+3]=ce-Re,ie+=4,y++}for(X=ie=0;4>X;++X)ce=(f=oe[ie+0]+4)+oe[ie+8],pe=f-oe[ie+8],Te=(35468*oe[ie+4]>>16)-Hi(oe[ie+12]),bo(j,I,0,0,ce+(Re=Hi(oe[ie+4])+(35468*oe[ie+12]>>16))),bo(j,I,1,0,pe+Te),bo(j,I,2,0,pe-Te),bo(j,I,3,0,ce-Re),ie++,I+=32}function Kl(f,y,j,I){var X=f[y+0]+4,ie=35468*f[y+4]>>16,oe=Hi(f[y+4]),ce=35468*f[y+1]>>16;co(j,I,0,X+oe,f=Hi(f[y+1]),ce),co(j,I,1,X+ie,f,ce),co(j,I,2,X-ie,f,ce),co(j,I,3,X-oe,f,ce)}function ha(f,y,j,I,X){Qo(f,y,j,I),X&&Qo(f,y+16,j,I+4)}function yr(f,y,j,I){Wa(f,y+0,j,I,1),Wa(f,y+32,j,I+128,1)}function Zl(f,y,j,I){var X;for(f=f[y+0]+4,X=0;4>X;++X)for(y=0;4>y;++y)bo(j,I,y,X,f)}function Hr(f,y,j,I){f[y+0]&&Ii(f,y+0,j,I),f[y+16]&&Ii(f,y+16,j,I+4),f[y+32]&&Ii(f,y+32,j,I+128),f[y+48]&&Ii(f,y+48,j,I+128+4)}function ji(f,y,j,I){var X,ie=d(16);for(X=0;4>X;++X){var oe=f[y+0+X]+f[y+12+X],ce=f[y+4+X]+f[y+8+X],pe=f[y+4+X]-f[y+8+X],Te=f[y+0+X]-f[y+12+X];ie[0+X]=oe+ce,ie[8+X]=oe-ce,ie[4+X]=Te+pe,ie[12+X]=Te-pe}for(X=0;4>X;++X)oe=(f=ie[0+4*X]+3)+ie[3+4*X],ce=ie[1+4*X]+ie[2+4*X],pe=ie[1+4*X]-ie[2+4*X],Te=f-ie[3+4*X],j[I+0]=oe+ce>>3,j[I+16]=Te+pe>>3,j[I+32]=oe-ce>>3,j[I+48]=Te-pe>>3,I+=64}function al(f,y,j){var I,X=y-32,ie=oa,oe=255-f[X-1];for(I=0;I<j;++I){var ce,pe=ie,Te=oe+f[y-1];for(ce=0;ce<j;++ce)f[y+ce]=pe[Te+f[X+ce]];y+=32}}function Fa(f,y){al(f,y,4)}function $o(f,y){al(f,y,8)}function ms(f,y){al(f,y,16)}function za(f,y){var j;for(j=0;16>j;++j)s(f,y+32*j,f,y-32,16)}function ea(f,y){var j;for(j=16;0<j;--j)l(f,y,f[y-1],16),y+=32}function Jr(f,y,j){var I;for(I=0;16>I;++I)l(y,j+32*I,f,16)}function xr(f,y){var j,I=16;for(j=0;16>j;++j)I+=f[y-1+32*j]+f[y+j-32];Jr(I>>5,f,y)}function bs(f,y){var j,I=8;for(j=0;16>j;++j)I+=f[y-1+32*j];Jr(I>>4,f,y)}function Ua(f,y){var j,I=8;for(j=0;16>j;++j)I+=f[y+j-32];Jr(I>>4,f,y)}function Ks(f,y){Jr(128,f,y)}function Pn(f,y,j){return f+2*y+j+2>>2}function Tt(f,y){var j,I=y-32;for(I=new Uint8Array([Pn(f[I-1],f[I+0],f[I+1]),Pn(f[I+0],f[I+1],f[I+2]),Pn(f[I+1],f[I+2],f[I+3]),Pn(f[I+2],f[I+3],f[I+4])]),j=0;4>j;++j)s(f,y+32*j,I,0,I.length)}function Zn(f,y){var j=f[y-1],I=f[y-1+32],X=f[y-1+64],ie=f[y-1+96];Ge(f,y+0,16843009*Pn(f[y-1-32],j,I)),Ge(f,y+32,16843009*Pn(j,I,X)),Ge(f,y+64,16843009*Pn(I,X,ie)),Ge(f,y+96,16843009*Pn(X,ie,ie))}function Ea(f,y){var j,I=4;for(j=0;4>j;++j)I+=f[y+j-32]+f[y-1+32*j];for(I>>=3,j=0;4>j;++j)l(f,y+32*j,I,4)}function ga(f,y){var j=f[y-1+0],I=f[y-1+32],X=f[y-1+64],ie=f[y-1-32],oe=f[y+0-32],ce=f[y+1-32],pe=f[y+2-32],Te=f[y+3-32];f[y+0+96]=Pn(I,X,f[y-1+96]),f[y+1+96]=f[y+0+64]=Pn(j,I,X),f[y+2+96]=f[y+1+64]=f[y+0+32]=Pn(ie,j,I),f[y+3+96]=f[y+2+64]=f[y+1+32]=f[y+0+0]=Pn(oe,ie,j),f[y+3+64]=f[y+2+32]=f[y+1+0]=Pn(ce,oe,ie),f[y+3+32]=f[y+2+0]=Pn(pe,ce,oe),f[y+3+0]=Pn(Te,pe,ce)}function wn(f,y){var j=f[y+1-32],I=f[y+2-32],X=f[y+3-32],ie=f[y+4-32],oe=f[y+5-32],ce=f[y+6-32],pe=f[y+7-32];f[y+0+0]=Pn(f[y+0-32],j,I),f[y+1+0]=f[y+0+32]=Pn(j,I,X),f[y+2+0]=f[y+1+32]=f[y+0+64]=Pn(I,X,ie),f[y+3+0]=f[y+2+32]=f[y+1+64]=f[y+0+96]=Pn(X,ie,oe),f[y+3+32]=f[y+2+64]=f[y+1+96]=Pn(ie,oe,ce),f[y+3+64]=f[y+2+96]=Pn(oe,ce,pe),f[y+3+96]=Pn(ce,pe,pe)}function Cn(f,y){var j=f[y-1+0],I=f[y-1+32],X=f[y-1+64],ie=f[y-1-32],oe=f[y+0-32],ce=f[y+1-32],pe=f[y+2-32],Te=f[y+3-32];f[y+0+0]=f[y+1+64]=ie+oe+1>>1,f[y+1+0]=f[y+2+64]=oe+ce+1>>1,f[y+2+0]=f[y+3+64]=ce+pe+1>>1,f[y+3+0]=pe+Te+1>>1,f[y+0+96]=Pn(X,I,j),f[y+0+64]=Pn(I,j,ie),f[y+0+32]=f[y+1+96]=Pn(j,ie,oe),f[y+1+32]=f[y+2+96]=Pn(ie,oe,ce),f[y+2+32]=f[y+3+96]=Pn(oe,ce,pe),f[y+3+32]=Pn(ce,pe,Te)}function sl(f,y){var j=f[y+0-32],I=f[y+1-32],X=f[y+2-32],ie=f[y+3-32],oe=f[y+4-32],ce=f[y+5-32],pe=f[y+6-32],Te=f[y+7-32];f[y+0+0]=j+I+1>>1,f[y+1+0]=f[y+0+64]=I+X+1>>1,f[y+2+0]=f[y+1+64]=X+ie+1>>1,f[y+3+0]=f[y+2+64]=ie+oe+1>>1,f[y+0+32]=Pn(j,I,X),f[y+1+32]=f[y+0+96]=Pn(I,X,ie),f[y+2+32]=f[y+1+96]=Pn(X,ie,oe),f[y+3+32]=f[y+2+96]=Pn(ie,oe,ce),f[y+3+64]=Pn(oe,ce,pe),f[y+3+96]=Pn(ce,pe,Te)}function Yo(f,y){var j=f[y-1+0],I=f[y-1+32],X=f[y-1+64],ie=f[y-1+96];f[y+0+0]=j+I+1>>1,f[y+2+0]=f[y+0+32]=I+X+1>>1,f[y+2+32]=f[y+0+64]=X+ie+1>>1,f[y+1+0]=Pn(j,I,X),f[y+3+0]=f[y+1+32]=Pn(I,X,ie),f[y+3+32]=f[y+1+64]=Pn(X,ie,ie),f[y+3+64]=f[y+2+64]=f[y+0+96]=f[y+1+96]=f[y+2+96]=f[y+3+96]=ie}function Fn(f,y){var j=f[y-1+0],I=f[y-1+32],X=f[y-1+64],ie=f[y-1+96],oe=f[y-1-32],ce=f[y+0-32],pe=f[y+1-32],Te=f[y+2-32];f[y+0+0]=f[y+2+32]=j+oe+1>>1,f[y+0+32]=f[y+2+64]=I+j+1>>1,f[y+0+64]=f[y+2+96]=X+I+1>>1,f[y+0+96]=ie+X+1>>1,f[y+3+0]=Pn(ce,pe,Te),f[y+2+0]=Pn(oe,ce,pe),f[y+1+0]=f[y+3+32]=Pn(j,oe,ce),f[y+1+32]=f[y+3+64]=Pn(I,j,oe),f[y+1+64]=f[y+3+96]=Pn(X,I,j),f[y+1+96]=Pn(ie,X,I)}function yn(f,y){var j;for(j=0;8>j;++j)s(f,y+32*j,f,y-32,8)}function Ni(f,y){var j;for(j=0;8>j;++j)l(f,y,f[y-1],8),y+=32}function pn(f,y,j){var I;for(I=0;8>I;++I)l(y,j+32*I,f,8)}function vi(f,y){var j,I=8;for(j=0;8>j;++j)I+=f[y+j-32]+f[y-1+32*j];pn(I>>4,f,y)}function jn(f,y){var j,I=4;for(j=0;8>j;++j)I+=f[y+j-32];pn(I>>3,f,y)}function ta(f,y){var j,I=4;for(j=0;8>j;++j)I+=f[y-1+32*j];pn(I>>3,f,y)}function Qt(f,y){pn(128,f,y)}function ri(f,y,j){var I=f[y-j],X=f[y+0],ie=3*(X-I)+ll[1020+f[y-2*j]-f[y+j]],oe=Ya[112+(ie+4>>3)];f[y-j]=oa[255+I+Ya[112+(ie+3>>3)]],f[y+0]=oa[255+X-oe]}function tn(f,y,j,I){var X=f[y+0],ie=f[y+j];return $r[255+f[y-2*j]-f[y-j]]>I||$r[255+ie-X]>I}function wi(f,y,j,I){return 4*$r[255+f[y-j]-f[y+0]]+$r[255+f[y-2*j]-f[y+j]]<=I}function Va(f,y,j,I,X){var ie=f[y-3*j],oe=f[y-2*j],ce=f[y-j],pe=f[y+0],Te=f[y+j],Re=f[y+2*j],Ee=f[y+3*j];return 4*$r[255+ce-pe]+$r[255+oe-Te]>I?0:$r[255+f[y-4*j]-ie]<=X&&$r[255+ie-oe]<=X&&$r[255+oe-ce]<=X&&$r[255+Ee-Re]<=X&&$r[255+Re-Te]<=X&&$r[255+Te-pe]<=X}function qa(f,y,j,I){var X=2*I+1;for(I=0;16>I;++I)wi(f,y+I,j,X)&&ri(f,y+I,j)}function uo(f,y,j,I){var X=2*I+1;for(I=0;16>I;++I)wi(f,y+I*j,1,X)&&ri(f,y+I*j,1)}function _a(f,y,j,I){var X;for(X=3;0<X;--X)qa(f,y+=4*j,j,I)}function vs(f,y,j,I){var X;for(X=3;0<X;--X)uo(f,y+=4,j,I)}function rs(f,y,j,I,X,ie,oe,ce){for(ie=2*ie+1;0<X--;){if(Va(f,y,j,ie,oe))if(tn(f,y,j,ce))ri(f,y,j);else{var pe=f,Te=y,Re=j,Ee=pe[Te-2*Re],ke=pe[Te-Re],He=pe[Te+0],Qe=pe[Te+Re],yt=pe[Te+2*Re],et=27*(bt=ll[1020+3*(He-ke)+ll[1020+Ee-Qe]])+63>>7,pt=18*bt+63>>7,bt=9*bt+63>>7;pe[Te-3*Re]=oa[255+pe[Te-3*Re]+bt],pe[Te-2*Re]=oa[255+Ee+pt],pe[Te-Re]=oa[255+ke+et],pe[Te+0]=oa[255+He-et],pe[Te+Re]=oa[255+Qe-pt],pe[Te+2*Re]=oa[255+yt-bt]}y+=I}}function Zs(f,y,j,I,X,ie,oe,ce){for(ie=2*ie+1;0<X--;){if(Va(f,y,j,ie,oe))if(tn(f,y,j,ce))ri(f,y,j);else{var pe=f,Te=y,Re=j,Ee=pe[Te-Re],ke=pe[Te+0],He=pe[Te+Re],Qe=Ya[112+(4+(yt=3*(ke-Ee))>>3)],yt=Ya[112+(yt+3>>3)],et=Qe+1>>1;pe[Te-2*Re]=oa[255+pe[Te-2*Re]+et],pe[Te-Re]=oa[255+Ee+yt],pe[Te+0]=oa[255+ke-Qe],pe[Te+Re]=oa[255+He-et]}y+=I}}function eu(f,y,j,I,X,ie){rs(f,y,j,1,16,I,X,ie)}function ws(f,y,j,I,X,ie){rs(f,y,1,j,16,I,X,ie)}function tu(f,y,j,I,X,ie){var oe;for(oe=3;0<oe;--oe)Zs(f,y+=4*j,j,1,16,I,X,ie)}function T(f,y,j,I,X,ie){var oe;for(oe=3;0<oe;--oe)Zs(f,y+=4,1,j,16,I,X,ie)}function Q(f,y,j,I,X,ie,oe,ce){rs(f,y,X,1,8,ie,oe,ce),rs(j,I,X,1,8,ie,oe,ce)}function fe(f,y,j,I,X,ie,oe,ce){rs(f,y,1,X,8,ie,oe,ce),rs(j,I,1,X,8,ie,oe,ce)}function Be(f,y,j,I,X,ie,oe,ce){Zs(f,y+4*X,X,1,8,ie,oe,ce),Zs(j,I+4*X,X,1,8,ie,oe,ce)}function Ve(f,y,j,I,X,ie,oe,ce){Zs(f,y+4,1,X,8,ie,oe,ce),Zs(j,I+4,1,X,8,ie,oe,ce)}function gt(){this.ba=new An,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new ti,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function mt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function $t(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Kt(){this.ua=0,this.Wa=new Yt,this.vb=new Yt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new we,this.yc=new Z}function sn(){this.xb=this.a=0,this.l=new Xs,this.ca=new An,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new q,this.Pb=0,this.wd=new q,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Kt,this.ab=0,this.gc=b(4,$t),this.Oc=0}function Un(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Xs,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function li(f,y,j,I,X,ie,oe){for(f=f==null?0:f[y+0],y=0;y<oe;++y)X[ie+y]=f+j[I+y]&255,f=X[ie+y]}function Qr(f,y,j,I,X,ie,oe){var ce;if(f==null)li(null,null,j,I,X,ie,oe);else for(ce=0;ce<oe;++ce)X[ie+ce]=f[y+ce]+j[I+ce]&255}function Bi(f,y,j,I,X,ie,oe){if(f==null)li(null,null,j,I,X,ie,oe);else{var ce,pe=f[y+0],Te=pe,Re=pe;for(ce=0;ce<oe;++ce)Te=Re+(pe=f[y+ce])-Te,Re=j[I+ce]+(-256&Te?0>Te?0:255:Te)&255,Te=pe,X[ie+ce]=Re}}function kr(f,y,j,I){var X=y.width,ie=y.o;if(r(f!=null&&y!=null),0>j||0>=I||j+I>ie)return null;if(!f.Cc){if(f.ga==null){var oe;if(f.ga=new Un,(oe=f.ga==null)||(oe=y.width*y.o,r(f.Gb.length==0),f.Gb=d(oe),f.Uc=0,f.Gb==null?oe=0:(f.mb=f.Gb,f.nb=f.Uc,f.rc=null,oe=1),oe=!oe),!oe){oe=f.ga;var ce=f.Fa,pe=f.P,Te=f.qc,Re=f.mb,Ee=f.nb,ke=pe+1,He=Te-1,Qe=oe.l;if(r(ce!=null&&Re!=null&&y!=null),Ca[0]=null,Ca[1]=li,Ca[2]=Qr,Ca[3]=Bi,oe.ca=Re,oe.tb=Ee,oe.c=y.width,oe.i=y.height,r(0<oe.c&&0<oe.i),1>=Te)y=0;else if(oe.$a=3&ce[pe+0],oe.Z=ce[pe+0]>>2&3,oe.Lc=ce[pe+0]>>4&3,pe=ce[pe+0]>>6&3,0>oe.$a||1<oe.$a||4<=oe.Z||1<oe.Lc||pe)y=0;else if(Qe.put=qt,Qe.ac=Mr,Qe.bc=Zi,Qe.ma=oe,Qe.width=y.width,Qe.height=y.height,Qe.Da=y.Da,Qe.v=y.v,Qe.va=y.va,Qe.j=y.j,Qe.o=y.o,oe.$a)e:{r(oe.$a==1),y=hr();t:for(;;){if(y==null){y=0;break e}if(r(oe!=null),oe.mc=y,y.c=oe.c,y.i=oe.i,y.l=oe.l,y.l.ma=oe,y.l.width=oe.c,y.l.height=oe.i,y.a=0,Ie(y.m,ce,ke,He),!Di(oe.c,oe.i,1,y,null)||(y.ab==1&&y.gc[0].hc==3&&Dt(y.s)?(oe.ic=1,ce=y.c*y.i,y.Ta=null,y.Ua=0,y.V=d(ce),y.Ba=0,y.V==null?(y.a=1,y=0):y=1):(oe.ic=0,y=qi(y,oe.c)),!y))break t;y=1;break e}oe.mc=null,y=0}else y=He>=oe.c*oe.i;oe=!y}if(oe)return null;f.ga.Lc!=1?f.Ga=0:I=ie-j}r(f.ga!=null),r(j+I<=ie);e:{if(y=(ce=f.ga).c,ie=ce.l.o,ce.$a==0){if(ke=f.rc,He=f.Vc,Qe=f.Fa,pe=f.P+1+j*y,Te=f.mb,Re=f.nb+j*y,r(pe<=f.P+f.qc),ce.Z!=0)for(r(Ca[ce.Z]!=null),oe=0;oe<I;++oe)Ca[ce.Z](ke,He,Qe,pe,Te,Re,y),ke=Te,He=Re,Re+=y,pe+=y;else for(oe=0;oe<I;++oe)s(Te,Re,Qe,pe,y),ke=Te,He=Re,Re+=y,pe+=y;f.rc=ke,f.Vc=He}else{if(r(ce.mc!=null),y=j+I,r((oe=ce.mc)!=null),r(y<=oe.i),oe.C>=y)y=1;else if(ce.ic||Dr(),ce.ic){ce=oe.V,ke=oe.Ba,He=oe.c;var yt=oe.i,et=(Qe=1,pe=oe.$/He,Te=oe.$%He,Re=oe.m,Ee=oe.s,oe.$),pt=He*yt,bt=He*y,Mt=Ee.wc,zt=et<bt?Wn(Ee,Te,pe):null;r(et<=pt),r(y<=yt),r(Dt(Ee));t:for(;;){for(;!Re.h&&et<bt;){if(Te&Mt||(zt=Wn(Ee,Te,pe)),r(zt!=null),le(Re),256>(yt=hi(zt.G[0],zt.H[0],Re)))ce[ke+et]=yt,++et,++Te>=He&&(Te=0,++pe<=y&&!(pe%16)&&rn(oe,pe));else{if(!(280>yt)){Qe=0;break t}yt=Cr(yt-256,Re);var Sn,un=hi(zt.G[4],zt.H[4],Re);if(le(Re),!(et>=(un=jr(He,un=Cr(un,Re)))&&pt-et>=yt)){Qe=0;break t}for(Sn=0;Sn<yt;++Sn)ce[ke+et+Sn]=ce[ke+et+Sn-un];for(et+=yt,Te+=yt;Te>=He;)Te-=He,++pe<=y&&!(pe%16)&&rn(oe,pe);et<bt&&Te&Mt&&(zt=Wn(Ee,Te,pe))}r(Re.h==se(Re))}rn(oe,pe>y?y:pe);break t}!Qe||Re.h&&et<pt?(Qe=0,oe.a=Re.h?5:3):oe.$=et,y=Qe}else y=bn(oe,oe.V,oe.Ba,oe.c,oe.i,y,Br);if(!y){I=0;break e}}j+I>=ie&&(f.Cc=1),I=1}if(!I)return null;if(f.Cc&&((I=f.ga)!=null&&(I.mc=null),f.ga=null,0<f.Ga))return alert("todo:WebPDequantizeLevels"),null}return f.nb+j*X}function Ar(f,y,j,I,X,ie){for(;0<X--;){var oe,ce=f,pe=y+(j?1:0),Te=f,Re=y+(j?0:3);for(oe=0;oe<I;++oe){var Ee=Te[Re+4*oe];Ee!=255&&(Ee*=32897,ce[pe+4*oe+0]=ce[pe+4*oe+0]*Ee>>23,ce[pe+4*oe+1]=ce[pe+4*oe+1]*Ee>>23,ce[pe+4*oe+2]=ce[pe+4*oe+2]*Ee>>23)}y+=ie}}function _o(f,y,j,I,X){for(;0<I--;){var ie;for(ie=0;ie<j;++ie){var oe=f[y+2*ie+0],ce=15&(Te=f[y+2*ie+1]),pe=4369*ce,Te=(240&Te|Te>>4)*pe>>16;f[y+2*ie+0]=(240&oe|oe>>4)*pe>>16&240|(15&oe|oe<<4)*pe>>16>>4&15,f[y+2*ie+1]=240&Te|ce}y+=X}}function Qi(f,y,j,I,X,ie,oe,ce){var pe,Te,Re=255;for(Te=0;Te<X;++Te){for(pe=0;pe<I;++pe){var Ee=f[y+pe];ie[oe+4*pe]=Ee,Re&=Ee}y+=j,oe+=ce}return Re!=255}function ya(f,y,j,I,X){var ie;for(ie=0;ie<X;++ie)j[I+ie]=f[y+ie]>>8}function Dr(){To=Ar,Io=_o,to=Qi,wa=ya}function xa(f,y,j){F[f]=function(I,X,ie,oe,ce,pe,Te,Re,Ee,ke,He,Qe,yt,et,pt,bt,Mt){var zt,Sn=Mt-1>>1,un=ce[pe+0]|Te[Re+0]<<16,Tn=Ee[ke+0]|He[Qe+0]<<16;r(I!=null);var nn=3*un+Tn+131074>>2;for(y(I[X+0],255&nn,nn>>16,yt,et),ie!=null&&(nn=3*Tn+un+131074>>2,y(ie[oe+0],255&nn,nn>>16,pt,bt)),zt=1;zt<=Sn;++zt){var pi=ce[pe+zt]|Te[Re+zt]<<16,Lr=Ee[ke+zt]|He[Qe+zt]<<16,zn=un+pi+Tn+Lr+524296,Ut=zn+2*(pi+Tn)>>3;nn=Ut+un>>1,un=(zn=zn+2*(un+Lr)>>3)+pi>>1,y(I[X+2*zt-1],255&nn,nn>>16,yt,et+(2*zt-1)*j),y(I[X+2*zt-0],255&un,un>>16,yt,et+(2*zt-0)*j),ie!=null&&(nn=zn+Tn>>1,un=Ut+Lr>>1,y(ie[oe+2*zt-1],255&nn,nn>>16,pt,bt+(2*zt-1)*j),y(ie[oe+2*zt+0],255&un,un>>16,pt,bt+(2*zt+0)*j)),un=pi,Tn=Lr}1&Mt||(nn=3*un+Tn+131074>>2,y(I[X+Mt-1],255&nn,nn>>16,yt,et+(Mt-1)*j),ie!=null&&(nn=3*Tn+un+131074>>2,y(ie[oe+Mt-1],255&nn,nn>>16,pt,bt+(Mt-1)*j)))}}function ma(){Fr[ki]=vc,Fr[Ti]=Fc,Fr[Mc]=bu,Fr[dr]=vu,Fr[io]=fl,Fr[cl]=nl,Fr[ro]=zl,Fr[us]=Fc,Fr[aa]=vu,Fr[ul]=fl,Fr[iu]=nl}function Ss(f){return f&-16384?0>f?0:255:f>>jo}function na(f,y){return Ss((19077*f>>8)+(26149*y>>8)-14234)}function Da(f,y,j){return Ss((19077*f>>8)-(6419*y>>8)-(13320*j>>8)+8708)}function fo(f,y){return Ss((19077*f>>8)+(33050*y>>8)-17685)}function ba(f,y,j,I,X){I[X+0]=na(f,j),I[X+1]=Da(f,y,j),I[X+2]=fo(f,y)}function Wi(f,y,j,I,X){I[X+0]=fo(f,y),I[X+1]=Da(f,y,j),I[X+2]=na(f,j)}function Ra(f,y,j,I,X){var ie=Da(f,y,j);y=ie<<3&224|fo(f,y)>>3,I[X+0]=248&na(f,j)|ie>>5,I[X+1]=y}function vo(f,y,j,I,X){var ie=240&fo(f,y)|15;I[X+0]=240&na(f,j)|Da(f,y,j)>>4,I[X+1]=ie}function os(f,y,j,I,X){I[X+0]=255,ba(f,y,j,I,X+1)}function $i(f,y,j,I,X){Wi(f,y,j,I,X),I[X+3]=255}function eo(f,y,j,I,X){ba(f,y,j,I,X),I[X+3]=255}function Tl(f,y,j){F[f]=function(I,X,ie,oe,ce,pe,Te,Re,Ee){for(var ke=Re+(-2&Ee)*j;Re!=ke;)y(I[X+0],ie[oe+0],ce[pe+0],Te,Re),y(I[X+1],ie[oe+0],ce[pe+0],Te,Re+j),X+=2,++oe,++pe,Re+=2*j;1&Ee&&y(I[X+0],ie[oe+0],ce[pe+0],Te,Re)}}function Ic(f,y,j){return j==0?f==0?y==0?6:5:y==0?4:0:j}function Rs(f,y,j,I,X){switch(f>>>30){case 3:Wa(y,j,I,X,0);break;case 2:sr(y,j,I,X);break;case 1:Ii(y,j,I,X)}}function Ia(f,y){var j,I,X=y.M,ie=y.Nb,oe=f.oc,ce=f.pc+40,pe=f.oc,Te=f.pc+584,Re=f.oc,Ee=f.pc+600;for(j=0;16>j;++j)oe[ce+32*j-1]=129;for(j=0;8>j;++j)pe[Te+32*j-1]=129,Re[Ee+32*j-1]=129;for(0<X?oe[ce-1-32]=pe[Te-1-32]=Re[Ee-1-32]=129:(l(oe,ce-32-1,127,21),l(pe,Te-32-1,127,9),l(Re,Ee-32-1,127,9)),I=0;I<f.za;++I){var ke=y.ya[y.aa+I];if(0<I){for(j=-1;16>j;++j)s(oe,ce+32*j-4,oe,ce+32*j+12,4);for(j=-1;8>j;++j)s(pe,Te+32*j-4,pe,Te+32*j+4,4),s(Re,Ee+32*j-4,Re,Ee+32*j+4,4)}var He=f.Gd,Qe=f.Hd+I,yt=ke.ad,et=ke.Hc;if(0<X&&(s(oe,ce-32,He[Qe].y,0,16),s(pe,Te-32,He[Qe].f,0,8),s(Re,Ee-32,He[Qe].ea,0,8)),ke.Za){var pt=oe,bt=ce-32+16;for(0<X&&(I>=f.za-1?l(pt,bt,He[Qe].y[15],4):s(pt,bt,He[Qe+1].y,0,4)),j=0;4>j;j++)pt[bt+128+j]=pt[bt+256+j]=pt[bt+384+j]=pt[bt+0+j];for(j=0;16>j;++j,et<<=2)pt=oe,bt=ce+Li[j],oo[ke.Ob[j]](pt,bt),Rs(et,yt,16*+j,pt,bt)}else if(pt=Ic(I,X,ke.Ob[0]),la[pt](oe,ce),et!=0)for(j=0;16>j;++j,et<<=2)Rs(et,yt,16*+j,oe,ce+Li[j]);for(j=ke.Gc,pt=Ic(I,X,ke.Dd),Sa[pt](pe,Te),Sa[pt](Re,Ee),et=yt,pt=pe,bt=Te,255&(ke=0|j)&&(170&ke?ls(et,256,pt,bt):Fi(et,256,pt,bt)),ke=Re,et=Ee,255&(j>>=8)&&(170&j?ls(yt,320,ke,et):Fi(yt,320,ke,et)),X<f.Ub-1&&(s(He[Qe].y,0,oe,ce+480,16),s(He[Qe].f,0,pe,Te+224,8),s(He[Qe].ea,0,Re,Ee+224,8)),j=8*ie*f.B,He=f.sa,Qe=f.ta+16*I+16*ie*f.R,yt=f.qa,ke=f.ra+8*I+j,et=f.Ha,pt=f.Ia+8*I+j,j=0;16>j;++j)s(He,Qe+j*f.R,oe,ce+32*j,16);for(j=0;8>j;++j)s(yt,ke+j*f.B,pe,Te+32*j,8),s(et,pt+j*f.B,Re,Ee+32*j,8)}}function as(f,y,j,I,X,ie,oe,ce,pe){var Te=[0],Re=[0],Ee=0,ke=pe!=null?pe.kd:0,He=pe??new mt;if(f==null||12>j)return 7;He.data=f,He.w=y,He.ha=j,y=[y],j=[j],He.gb=[He.gb];e:{var Qe=y,yt=j,et=He.gb;if(r(f!=null),r(yt!=null),r(et!=null),et[0]=0,12<=yt[0]&&!o(f,Qe[0],"RIFF")){if(o(f,Qe[0]+8,"WEBP")){et=3;break e}var pt=Ht(f,Qe[0]+4);if(12>pt||4294967286<pt){et=3;break e}if(ke&&pt>yt[0]-8){et=7;break e}et[0]=pt,Qe[0]+=12,yt[0]-=12}et=0}if(et!=0)return et;for(pt=0<He.gb[0],j=j[0];;){e:{var bt=f;yt=y,et=j;var Mt=Te,zt=Re,Sn=Qe=[0];if((nn=Ee=[Ee])[0]=0,8>et[0])et=7;else{if(!o(bt,yt[0],"VP8X")){if(Ht(bt,yt[0]+4)!=10){et=3;break e}if(18>et[0]){et=7;break e}var un=Ht(bt,yt[0]+8),Tn=1+jt(bt,yt[0]+12);if(2147483648<=Tn*(bt=1+jt(bt,yt[0]+15))){et=3;break e}Sn!=null&&(Sn[0]=un),Mt!=null&&(Mt[0]=Tn),zt!=null&&(zt[0]=bt),yt[0]+=18,et[0]-=18,nn[0]=1}et=0}}if(Ee=Ee[0],Qe=Qe[0],et!=0)return et;if(yt=!!(2&Qe),!pt&&Ee)return 3;if(ie!=null&&(ie[0]=!!(16&Qe)),oe!=null&&(oe[0]=yt),ce!=null&&(ce[0]=0),oe=Te[0],Qe=Re[0],Ee&&yt&&pe==null){et=0;break}if(4>j){et=7;break}if(pt&&Ee||!pt&&!Ee&&!o(f,y[0],"ALPH")){j=[j],He.na=[He.na],He.P=[He.P],He.Sa=[He.Sa];e:{un=f,et=y,pt=j;var nn=He.gb;Mt=He.na,zt=He.P,Sn=He.Sa,Tn=22,r(un!=null),r(pt!=null),bt=et[0];var pi=pt[0];for(r(Mt!=null),r(Sn!=null),Mt[0]=null,zt[0]=null,Sn[0]=0;;){if(et[0]=bt,pt[0]=pi,8>pi){et=7;break e}var Lr=Ht(un,bt+4);if(4294967286<Lr){et=3;break e}var zn=8+Lr+1&-2;if(Tn+=zn,0<nn&&Tn>nn){et=3;break e}if(!o(un,bt,"VP8 ")||!o(un,bt,"VP8L")){et=0;break e}if(pi[0]<zn){et=7;break e}o(un,bt,"ALPH")||(Mt[0]=un,zt[0]=bt+8,Sn[0]=Lr),bt+=zn,pi-=zn}}if(j=j[0],He.na=He.na[0],He.P=He.P[0],He.Sa=He.Sa[0],et!=0)break}j=[j],He.Ja=[He.Ja],He.xa=[He.xa];e:if(nn=f,et=y,pt=j,Mt=He.gb[0],zt=He.Ja,Sn=He.xa,un=et[0],bt=!o(nn,un,"VP8 "),Tn=!o(nn,un,"VP8L"),r(nn!=null),r(pt!=null),r(zt!=null),r(Sn!=null),8>pt[0])et=7;else{if(bt||Tn){if(nn=Ht(nn,un+4),12<=Mt&&nn>Mt-12){et=3;break e}if(ke&&nn>pt[0]-8){et=7;break e}zt[0]=nn,et[0]+=8,pt[0]-=8,Sn[0]=Tn}else Sn[0]=5<=pt[0]&&nn[un+0]==47&&!(nn[un+4]>>5),zt[0]=pt[0];et=0}if(j=j[0],He.Ja=He.Ja[0],He.xa=He.xa[0],y=y[0],et!=0)break;if(4294967286<He.Ja)return 3;if(ce==null||yt||(ce[0]=He.xa?2:1),oe=[oe],Qe=[Qe],He.xa){if(5>j){et=7;break}ce=oe,ke=Qe,yt=ie,f==null||5>j?f=0:5<=j&&f[y+0]==47&&!(f[y+4]>>5)?(pt=[0],nn=[0],Mt=[0],Ie(zt=new q,f,y,j),Ji(zt,pt,nn,Mt)?(ce!=null&&(ce[0]=pt[0]),ke!=null&&(ke[0]=nn[0]),yt!=null&&(yt[0]=Mt[0]),f=1):f=0):f=0}else{if(10>j){et=7;break}ce=Qe,f==null||10>j||!fi(f,y+3,j-3)?f=0:(ke=f[y+0]|f[y+1]<<8|f[y+2]<<16,yt=16383&(f[y+7]<<8|f[y+6]),f=16383&(f[y+9]<<8|f[y+8]),1&ke||3<(ke>>1&7)||!(ke>>4&1)||ke>>5>=He.Ja||!yt||!f?f=0:(oe&&(oe[0]=yt),ce&&(ce[0]=f),f=1))}if(!f||(oe=oe[0],Qe=Qe[0],Ee&&(Te[0]!=oe||Re[0]!=Qe)))return 3;pe!=null&&(pe[0]=He,pe.offset=y-pe.w,r(4294967286>y-pe.w),r(pe.offset==pe.ha-j));break}return et==0||et==7&&Ee&&pe==null?(ie!=null&&(ie[0]|=He.na!=null&&0<He.na.length),I!=null&&(I[0]=oe),X!=null&&(X[0]=Qe),0):et}function Js(f,y,j){var I=y.width,X=y.height,ie=0,oe=0,ce=I,pe=X;if(y.Da=f!=null&&0<f.Da,y.Da&&(ce=f.cd,pe=f.bd,ie=f.v,oe=f.j,11>j||(ie&=-2,oe&=-2),0>ie||0>oe||0>=ce||0>=pe||ie+ce>I||oe+pe>X))return 0;if(y.v=ie,y.j=oe,y.va=ie+ce,y.o=oe+pe,y.U=ce,y.T=pe,y.da=f!=null&&0<f.da,y.da){if(!Gt(ce,pe,j=[f.ib],ie=[f.hb]))return 0;y.ib=j[0],y.hb=ie[0]}return y.ob=f!=null&&f.ob,y.Kb=f==null||!f.Sd,y.da&&(y.ob=y.ib<3*I/4&&y.hb<3*X/4,y.Kb=0),1}function Do(f){if(f==null)return 2;if(11>f.S){var y=f.f.RGBA;y.fb+=(f.height-1)*y.A,y.A=-y.A}else y=f.f.kb,f=f.height,y.O+=(f-1)*y.fa,y.fa=-y.fa,y.N+=(f-1>>1)*y.Ab,y.Ab=-y.Ab,y.W+=(f-1>>1)*y.Db,y.Db=-y.Db,y.F!=null&&(y.J+=(f-1)*y.lb,y.lb=-y.lb);return 0}function ss(f,y,j,I){if(I==null||0>=f||0>=y)return 2;if(j!=null){if(j.Da){var X=j.cd,ie=j.bd,oe=-2&j.v,ce=-2&j.j;if(0>oe||0>ce||0>=X||0>=ie||oe+X>f||ce+ie>y)return 2;f=X,y=ie}if(j.da){if(!Gt(f,y,X=[j.ib],ie=[j.hb]))return 2;f=X[0],y=ie[0]}}I.width=f,I.height=y;e:{var pe=I.width,Te=I.height;if(f=I.S,0>=pe||0>=Te||!(f>=ki&&13>f))f=2;else{if(0>=I.Rd&&I.sd==null){oe=ie=X=y=0;var Re=(ce=pe*ja[f])*Te;if(11>f||(ie=(Te+1)/2*(y=(pe+1)/2),f==12&&(oe=(X=pe)*Te)),(Te=d(Re+2*ie+oe))==null){f=1;break e}I.sd=Te,11>f?((pe=I.f.RGBA).eb=Te,pe.fb=0,pe.A=ce,pe.size=Re):((pe=I.f.kb).y=Te,pe.O=0,pe.fa=ce,pe.Fd=Re,pe.f=Te,pe.N=0+Re,pe.Ab=y,pe.Cd=ie,pe.ea=Te,pe.W=0+Re+ie,pe.Db=y,pe.Ed=ie,f==12&&(pe.F=Te,pe.J=0+Re+2*ie),pe.Tc=oe,pe.lb=X)}if(y=1,X=I.S,ie=I.width,oe=I.height,X>=ki&&13>X)if(11>X)f=I.f.RGBA,y&=(ce=Math.abs(f.A))*(oe-1)+ie<=f.size,y&=ce>=ie*ja[X],y&=f.eb!=null;else{f=I.f.kb,ce=(ie+1)/2,Re=(oe+1)/2,pe=Math.abs(f.fa),Te=Math.abs(f.Ab);var Ee=Math.abs(f.Db),ke=Math.abs(f.lb),He=ke*(oe-1)+ie;y&=pe*(oe-1)+ie<=f.Fd,y&=Te*(Re-1)+ce<=f.Cd,y=(y&=Ee*(Re-1)+ce<=f.Ed)&pe>=ie&Te>=ce&Ee>=ce,y&=f.y!=null,y&=f.f!=null,y&=f.ea!=null,X==12&&(y&=ke>=ie,y&=He<=f.Tc,y&=f.F!=null)}else y=0;f=y?0:2}}return f!=0||j!=null&&j.fd&&(f=Do(I)),f}var po=64,Go=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Wr=24,Is=32,ia=8,Qs=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Et("Predictor0","PredictorAdd0"),F.Predictor0=function(){return 4278190080},F.Predictor1=function(f){return f},F.Predictor2=function(f,y,j){return y[j+0]},F.Predictor3=function(f,y,j){return y[j+1]},F.Predictor4=function(f,y,j){return y[j-1]},F.Predictor5=function(f,y,j){return Zt(Zt(f,y[j+1]),y[j+0])},F.Predictor6=function(f,y,j){return Zt(f,y[j-1])},F.Predictor7=function(f,y,j){return Zt(f,y[j+0])},F.Predictor8=function(f,y,j){return Zt(y[j-1],y[j+0])},F.Predictor9=function(f,y,j){return Zt(y[j+0],y[j+1])},F.Predictor10=function(f,y,j){return Zt(Zt(f,y[j-1]),Zt(y[j+0],y[j+1]))},F.Predictor11=function(f,y,j){var I=y[j+0];return 0>=Rn(I>>24&255,f>>24&255,(y=y[j-1])>>24&255)+Rn(I>>16&255,f>>16&255,y>>16&255)+Rn(I>>8&255,f>>8&255,y>>8&255)+Rn(255&I,255&f,255&y)?I:f},F.Predictor12=function(f,y,j){var I=y[j+0];return(xn((f>>24&255)+(I>>24&255)-((y=y[j-1])>>24&255))<<24|xn((f>>16&255)+(I>>16&255)-(y>>16&255))<<16|xn((f>>8&255)+(I>>8&255)-(y>>8&255))<<8|xn((255&f)+(255&I)-(255&y)))>>>0},F.Predictor13=function(f,y,j){var I=y[j-1];return(tt((f=Zt(f,y[j+0]))>>24&255,I>>24&255)<<24|tt(f>>16&255,I>>16&255)<<16|tt(f>>8&255,I>>8&255)<<8|tt(255&f,255&I))>>>0};var Ha=F.PredictorAdd0;F.PredictorAdd1=Lt,Et("Predictor2","PredictorAdd2"),Et("Predictor3","PredictorAdd3"),Et("Predictor4","PredictorAdd4"),Et("Predictor5","PredictorAdd5"),Et("Predictor6","PredictorAdd6"),Et("Predictor7","PredictorAdd7"),Et("Predictor8","PredictorAdd8"),Et("Predictor9","PredictorAdd9"),Et("Predictor10","PredictorAdd10"),Et("Predictor11","PredictorAdd11"),Et("Predictor12","PredictorAdd12"),Et("Predictor13","PredictorAdd13");var Jl=F.PredictorAdd2;ye("ColorIndexInverseTransform","MapARGB","32b",function(f){return f>>8&255},function(f){return f}),ye("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(f){return f},function(f){return f>>8&255});var Jn,Ts=F.ColorIndexInverseTransform,Oi=F.MapARGB,ra=F.VP8LColorIndexInverseTransformAlpha,Xo=F.MapAlpha,va=F.VP8LPredictorsAdd=[];va.length=16,(F.VP8LPredictors=[]).length=16,(F.VP8LPredictorsAdd_C=[]).length=16,(F.VP8LPredictors_C=[]).length=16;var Lc,el,Cl,jl,wo,Nl,Ko,Wa,sr,ls,Ii,Fi,lr,So,cs,tl,bc,nu,Gu,$a,ho,kl,Ro,Ls,To,Io,to,wa,er=d(511),oi=d(2041),Rr=d(225),no=d(767),Lo=0,ll=oi,Ya=Rr,oa=no,$r=er,ki=0,Ti=1,Mc=2,dr=3,io=4,cl=5,ro=6,us=7,aa=8,ul=9,iu=10,Cs=[2,3,7],ds=[3,3,11],dl=[280,256,256,256,40],Bc=[0,1,1,1,0],Al=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],js=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],sa=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Ga=8,Co=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Mo=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],La=null,ru=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Pl=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Ns=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Xu=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],fr=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Ir=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],En=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],la=[],oo=[],Sa=[],Ta=1,Oc=2,Ca=[],Fr=[];xa("UpsampleRgbLinePair",ba,3),xa("UpsampleBgrLinePair",Wi,3),xa("UpsampleRgbaLinePair",eo,4),xa("UpsampleBgraLinePair",$i,4),xa("UpsampleArgbLinePair",os,4),xa("UpsampleRgba4444LinePair",vo,2),xa("UpsampleRgb565LinePair",Ra,2);var vc=F.UpsampleRgbLinePair,bu=F.UpsampleBgrLinePair,Fc=F.UpsampleRgbaLinePair,vu=F.UpsampleBgraLinePair,fl=F.UpsampleArgbLinePair,nl=F.UpsampleRgba4444LinePair,zl=F.UpsampleRgb565LinePair,ks=16,As=1<<ks-1,Yr=-227,Xa=482,jo=6,Ql=0,ca=d(256),No=d(256),Ka=d(256),Ma=d(256),fs=d(Xa-Yr),Ba=d(Xa-Yr);Tl("YuvToRgbRow",ba,3),Tl("YuvToBgrRow",Wi,3),Tl("YuvToRgbaRow",eo,4),Tl("YuvToBgraRow",$i,4),Tl("YuvToArgbRow",os,4),Tl("YuvToRgba4444Row",vo,2),Tl("YuvToRgb565Row",Ra,2);var Li=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Bo=[0,2,8],ua=[8,7,6,4,4,2,2,2,1,1,1,1],Zo=1;this.WebPDecodeRGBA=function(f,y,j,I,X){var ie=Ti,oe=new gt,ce=new An;oe.ba=ce,ce.S=ie,ce.width=[ce.width],ce.height=[ce.height];var pe=ce.width,Te=ce.height,Re=new dn;if(Re==null||f==null)var Ee=2;else r(Re!=null),Ee=as(f,y,j,Re.width,Re.height,Re.Pd,Re.Qd,Re.format,null);if(Ee!=0?pe=0:(pe!=null&&(pe[0]=Re.width[0]),Te!=null&&(Te[0]=Re.height[0]),pe=1),pe){ce.width=ce.width[0],ce.height=ce.height[0],I!=null&&(I[0]=ce.width),X!=null&&(X[0]=ce.height);e:{if(I=new Xs,(X=new mt).data=f,X.w=y,X.ha=j,X.kd=1,y=[0],r(X!=null),((f=as(X.data,X.w,X.ha,null,null,null,y,null,X))==0||f==7)&&y[0]&&(f=4),(y=f)==0){if(r(oe!=null),I.data=X.data,I.w=X.w+X.offset,I.ha=X.ha-X.offset,I.put=qt,I.ac=Mr,I.bc=Zi,I.ma=oe,X.xa){if((f=hr())==null){oe=1;break e}if((function(ke,He){var Qe=[0],yt=[0],et=[0];t:for(;;){if(ke==null)return 0;if(He==null)return ke.a=2,0;if(ke.l=He,ke.a=0,Ie(ke.m,He.data,He.w,He.ha),!Ji(ke.m,Qe,yt,et)){ke.a=3;break t}if(ke.xb=Oc,He.width=Qe[0],He.height=yt[0],!Di(Qe[0],yt[0],1,ke,null))break t;return 1}return r(ke.a!=0),0})(f,I)){if(I=(y=ss(I.width,I.height,oe.Oa,oe.ba))==0){t:{I=f;n:for(;;){if(I==null){I=0;break t}if(r(I.s.yc!=null),r(I.s.Ya!=null),r(0<I.s.Wb),r((j=I.l)!=null),r((X=j.ma)!=null),I.xb!=0){if(I.ca=X.ba,I.tb=X.tb,r(I.ca!=null),!Js(X.Oa,j,dr)){I.a=2;break n}if(!qi(I,j.width)||j.da)break n;if((j.da||Ft(I.ca.S))&&Dr(),11>I.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),I.ca.f.kb.F!=null&&Dr()),I.Pb&&0<I.s.ua&&I.s.vb.X==null&&!ge(I.s.vb,I.s.Wa.Xa)){I.a=1;break n}I.xb=0}if(!bn(I,I.V,I.Ba,I.c,I.i,j.o,Ot))break n;X.Dc=I.Ma,I=1;break t}r(I.a!=0),I=0}I=!I}I&&(y=f.a)}else y=f.a}else{if((f=new Nr)==null){oe=1;break e}if(f.Fa=X.na,f.P=X.P,f.qc=X.Sa,gr(f,I)){if((y=ss(I.width,I.height,oe.Oa,oe.ba))==0){if(f.Aa=0,j=oe.Oa,r((X=f)!=null),j!=null){if(0<(pe=0>(pe=j.Md)?0:100<pe?255:255*pe/100)){for(Te=Re=0;4>Te;++Te)12>(Ee=X.pb[Te]).lc&&(Ee.ia=pe*ua[0>Ee.lc?0:Ee.lc]>>3),Re|=Ee.ia;Re&&(alert("todo:VP8InitRandom"),X.ia=1)}X.Ga=j.Id,100<X.Ga?X.Ga=100:0>X.Ga&&(X.Ga=0)}(function(ke,He){if(ke==null)return 0;if(He==null)return Mi(ke,2,"NULL VP8Io parameter in VP8Decode().");if(!ke.cb&&!gr(ke,He))return 0;if(r(ke.cb),He.ac==null||He.ac(He)){He.ob&&(ke.L=0);var Qe=Bo[ke.L];if(ke.L==2?(ke.yb=0,ke.zb=0):(ke.yb=He.v-Qe>>4,ke.zb=He.j-Qe>>4,0>ke.yb&&(ke.yb=0),0>ke.zb&&(ke.zb=0)),ke.Va=He.o+15+Qe>>4,ke.Hb=He.va+15+Qe>>4,ke.Hb>ke.za&&(ke.Hb=ke.za),ke.Va>ke.Ub&&(ke.Va=ke.Ub),0<ke.L){var yt=ke.ed;for(Qe=0;4>Qe;++Qe){var et;if(ke.Qa.Cb){var pt=ke.Qa.Lb[Qe];ke.Qa.Fb||(pt+=yt.Tb)}else pt=yt.Tb;for(et=0;1>=et;++et){var bt=ke.gd[Qe][et],Mt=pt;if(yt.Pc&&(Mt+=yt.vd[0],et&&(Mt+=yt.od[0])),0<(Mt=0>Mt?0:63<Mt?63:Mt)){var zt=Mt;0<yt.wb&&(zt=4<yt.wb?zt>>2:zt>>1)>9-yt.wb&&(zt=9-yt.wb),1>zt&&(zt=1),bt.dd=zt,bt.tc=2*Mt+zt,bt.ld=40<=Mt?2:15<=Mt?1:0}else bt.tc=0;bt.La=et}}}Qe=0}else Mi(ke,6,"Frame setup failed"),Qe=ke.a;if(Qe=Qe==0){if(Qe){ke.$c=0,0<ke.Aa||(ke.Ic=Zo);t:{Qe=ke.Ic,yt=4*(zt=ke.za);var Sn=32*zt,un=zt+1,Tn=0<ke.L?zt*(0<ke.Aa?2:1):0,nn=(ke.Aa==2?2:1)*zt;if((bt=yt+832+(et=3*(16*Qe+Bo[ke.L])/2*Sn)+(pt=ke.Fa!=null&&0<ke.Fa.length?ke.Kc.c*ke.Kc.i:0))!=bt)Qe=0;else{if(bt>ke.Vb){if(ke.Vb=0,ke.Ec=d(bt),ke.Fc=0,ke.Ec==null){Qe=Mi(ke,1,"no memory during frame initialization.");break t}ke.Vb=bt}bt=ke.Ec,Mt=ke.Fc,ke.Ac=bt,ke.Bc=Mt,Mt+=yt,ke.Gd=b(Sn,ns),ke.Hd=0,ke.rb=b(un+1,Wo),ke.sb=1,ke.wa=Tn?b(Tn,di):null,ke.Y=0,ke.D.Nb=0,ke.D.wa=ke.wa,ke.D.Y=ke.Y,0<ke.Aa&&(ke.D.Y+=zt),r(!0),ke.oc=bt,ke.pc=Mt,Mt+=832,ke.ya=b(nn,Ds),ke.aa=0,ke.D.ya=ke.ya,ke.D.aa=ke.aa,ke.Aa==2&&(ke.D.aa+=zt),ke.R=16*zt,ke.B=8*zt,zt=(Sn=Bo[ke.L])*ke.R,Sn=Sn/2*ke.B,ke.sa=bt,ke.ta=Mt+zt,ke.qa=ke.sa,ke.ra=ke.ta+16*Qe*ke.R+Sn,ke.Ha=ke.qa,ke.Ia=ke.ra+8*Qe*ke.B+Sn,ke.$c=0,Mt+=et,ke.mb=pt?bt:null,ke.nb=pt?Mt:null,r(Mt+pt<=ke.Fc+ke.Vb),Xl(ke),l(ke.Ac,ke.Bc,0,yt),Qe=1}}if(Qe){if(He.ka=0,He.y=ke.sa,He.O=ke.ta,He.f=ke.qa,He.N=ke.ra,He.ea=ke.Ha,He.Vd=ke.Ia,He.fa=ke.R,He.Rc=ke.B,He.F=null,He.J=0,!Lo){for(Qe=-255;255>=Qe;++Qe)er[255+Qe]=0>Qe?-Qe:Qe;for(Qe=-1020;1020>=Qe;++Qe)oi[1020+Qe]=-128>Qe?-128:127<Qe?127:Qe;for(Qe=-112;112>=Qe;++Qe)Rr[112+Qe]=-16>Qe?-16:15<Qe?15:Qe;for(Qe=-255;510>=Qe;++Qe)no[255+Qe]=0>Qe?0:255<Qe?255:Qe;Lo=1}Ko=ji,Wa=ha,ls=yr,Ii=Zl,Fi=Hr,sr=Kl,lr=eu,So=ws,cs=Q,tl=fe,bc=tu,nu=T,Gu=Be,$a=Ve,ho=qa,kl=uo,Ro=_a,Ls=vs,oo[0]=Ea,oo[1]=Fa,oo[2]=Tt,oo[3]=Zn,oo[4]=ga,oo[5]=Cn,oo[6]=wn,oo[7]=sl,oo[8]=Fn,oo[9]=Yo,la[0]=xr,la[1]=ms,la[2]=za,la[3]=ea,la[4]=bs,la[5]=Ua,la[6]=Ks,Sa[0]=vi,Sa[1]=$o,Sa[2]=yn,Sa[3]=Ni,Sa[4]=ta,Sa[5]=jn,Sa[6]=Qt,Qe=1}else Qe=0}Qe&&(Qe=(function(pi,Lr){for(pi.M=0;pi.M<pi.Va;++pi.M){var zn,Ut=pi.Jc[pi.M&pi.Xb],Xt=pi.m,cr=pi;for(zn=0;zn<cr.za;++zn){var Yn=Xt,gi=cr,tr=gi.Ac,Pi=gi.Bc+4*zn,pr=gi.zc,Yi=gi.ya[gi.aa+zn];if(gi.Qa.Bb?Yi.$b=De(Yn,gi.Pa.jb[0])?2+De(Yn,gi.Pa.jb[2]):De(Yn,gi.Pa.jb[1]):Yi.$b=0,gi.kc&&(Yi.Ad=De(Yn,gi.Bd)),Yi.Za=!De(Yn,145)+0,Yi.Za){var Ur=Yi.Ob,ao=0;for(gi=0;4>gi;++gi){var Pr,ii=pr[0+gi];for(Pr=0;4>Pr;++Pr){ii=fr[tr[Pi+Pr]][ii];for(var Gi=Ns[De(Yn,ii[0])];0<Gi;)Gi=Ns[2*Gi+De(Yn,ii[Gi])];ii=-Gi,tr[Pi+Pr]=ii}s(Ur,ao,tr,Pi,4),ao+=4,pr[0+gi]=ii}}else ii=De(Yn,156)?De(Yn,128)?1:3:De(Yn,163)?2:0,Yi.Ob[0]=ii,l(tr,Pi,ii,4),l(pr,0,ii,4);Yi.Dd=De(Yn,142)?De(Yn,114)?De(Yn,183)?1:3:2:0}if(cr.m.Ka)return Mi(pi,7,"Premature end-of-partition0 encountered.");for(;pi.ja<pi.za;++pi.ja){if(cr=Ut,Yn=(Xt=pi).rb[Xt.sb-1],tr=Xt.rb[Xt.sb+Xt.ja],zn=Xt.ya[Xt.aa+Xt.ja],Pi=Xt.kc?zn.Ad:0)Yn.la=tr.la=0,zn.Za||(Yn.Na=tr.Na=0),zn.Hc=0,zn.Gc=0,zn.ia=0;else{var mr,ai;if(Yn=tr,tr=cr,Pi=Xt.Pa.Xc,pr=Xt.ya[Xt.aa+Xt.ja],Yi=Xt.pb[pr.$b],gi=pr.ad,Ur=0,ao=Xt.rb[Xt.sb-1],ii=Pr=0,l(gi,Ur,0,384),pr.Za)var nr=0,Si=Pi[3];else{Gi=d(16);var yi=Yn.Na+ao.Na;if(yi=La(tr,Pi[1],yi,Yi.Eb,0,Gi,0),Yn.Na=ao.Na=(0<yi)+0,1<yi)Ko(Gi,0,gi,Ur);else{var Xi=Gi[0]+3>>3;for(Gi=0;256>Gi;Gi+=16)gi[Ur+Gi]=Xi}nr=1,Si=Pi[0]}var Ui=15&Yn.la,Er=15&ao.la;for(Gi=0;4>Gi;++Gi){var go=1&Er;for(Xi=ai=0;4>Xi;++Xi)Ui=Ui>>1|(go=(yi=La(tr,Si,yi=go+(1&Ui),Yi.Sc,nr,gi,Ur))>nr)<<7,ai=ai<<2|(3<yi?3:1<yi?2:gi[Ur+0]!=0),Ur+=16;Ui>>=4,Er=Er>>1|go<<7,Pr=(Pr<<8|ai)>>>0}for(Si=Ui,nr=Er>>4,mr=0;4>mr;mr+=2){for(ai=0,Ui=Yn.la>>4+mr,Er=ao.la>>4+mr,Gi=0;2>Gi;++Gi){for(go=1&Er,Xi=0;2>Xi;++Xi)yi=go+(1&Ui),Ui=Ui>>1|(go=0<(yi=La(tr,Pi[2],yi,Yi.Qc,0,gi,Ur)))<<3,ai=ai<<2|(3<yi?3:1<yi?2:gi[Ur+0]!=0),Ur+=16;Ui>>=2,Er=Er>>1|go<<5}ii|=ai<<4*mr,Si|=Ui<<4<<mr,nr|=(240&Er)<<mr}Yn.la=Si,ao.la=nr,pr.Hc=Pr,pr.Gc=ii,pr.ia=43690&ii?0:Yi.ia,Pi=!(Pr|ii)}if(0<Xt.L&&(Xt.wa[Xt.Y+Xt.ja]=Xt.gd[zn.$b][zn.Za],Xt.wa[Xt.Y+Xt.ja].La|=!Pi),cr.Ka)return Mi(pi,7,"Premature end-of-file encountered.")}if(Xl(pi),Xt=Lr,cr=1,zn=(Ut=pi).D,Yn=0<Ut.L&&Ut.M>=Ut.zb&&Ut.M<=Ut.Va,Ut.Aa==0)t:{if(zn.M=Ut.M,zn.uc=Yn,Ia(Ut,zn),cr=1,zn=(ai=Ut.D).Nb,Yn=(ii=Bo[Ut.L])*Ut.R,tr=ii/2*Ut.B,Gi=16*zn*Ut.R,Xi=8*zn*Ut.B,Pi=Ut.sa,pr=Ut.ta-Yn+Gi,Yi=Ut.qa,gi=Ut.ra-tr+Xi,Ur=Ut.Ha,ao=Ut.Ia-tr+Xi,Er=(Ui=ai.M)==0,Pr=Ui>=Ut.Va-1,Ut.Aa==2&&Ia(Ut,ai),ai.uc)for(go=(yi=Ut).D.M,r(yi.D.uc),ai=yi.yb;ai<yi.Hb;++ai){nr=ai,Si=go;var zr=(si=(so=yi).D).Nb;mr=so.R;var si=si.wa[si.Y+nr],Oo=so.sa,Gr=so.ta+16*zr*mr+16*nr,Mn=si.dd,In=si.tc;if(In!=0)if(r(3<=In),so.L==1)0<nr&&kl(Oo,Gr,mr,In+4),si.La&&Ls(Oo,Gr,mr,In),0<Si&&ho(Oo,Gr,mr,In+4),si.La&&Ro(Oo,Gr,mr,In);else{var Ei=so.B,Oa=so.qa,yo=so.ra+8*zr*Ei+8*nr,Fo=so.Ha,so=so.Ia+8*zr*Ei+8*nr;zr=si.ld,0<nr&&(So(Oo,Gr,mr,In+4,Mn,zr),tl(Oa,yo,Fo,so,Ei,In+4,Mn,zr)),si.La&&(nu(Oo,Gr,mr,In,Mn,zr),$a(Oa,yo,Fo,so,Ei,In,Mn,zr)),0<Si&&(lr(Oo,Gr,mr,In+4,Mn,zr),cs(Oa,yo,Fo,so,Ei,In+4,Mn,zr)),si.La&&(bc(Oo,Gr,mr,In,Mn,zr),Gu(Oa,yo,Fo,so,Ei,In,Mn,zr))}}if(Ut.ia&&alert("todo:DitherRow"),Xt.put!=null){if(ai=16*Ui,Ui=16*(Ui+1),Er?(Xt.y=Ut.sa,Xt.O=Ut.ta+Gi,Xt.f=Ut.qa,Xt.N=Ut.ra+Xi,Xt.ea=Ut.Ha,Xt.W=Ut.Ia+Xi):(ai-=ii,Xt.y=Pi,Xt.O=pr,Xt.f=Yi,Xt.N=gi,Xt.ea=Ur,Xt.W=ao),Pr||(Ui-=ii),Ui>Xt.o&&(Ui=Xt.o),Xt.F=null,Xt.J=null,Ut.Fa!=null&&0<Ut.Fa.length&&ai<Ui&&(Xt.J=kr(Ut,Xt,ai,Ui-ai),Xt.F=Ut.mb,Xt.F==null&&Xt.F.length==0)){cr=Mi(Ut,3,"Could not decode alpha data.");break t}ai<Xt.j&&(ii=Xt.j-ai,ai=Xt.j,r(!(1&ii)),Xt.O+=Ut.R*ii,Xt.N+=Ut.B*(ii>>1),Xt.W+=Ut.B*(ii>>1),Xt.F!=null&&(Xt.J+=Xt.width*ii)),ai<Ui&&(Xt.O+=Xt.v,Xt.N+=Xt.v>>1,Xt.W+=Xt.v>>1,Xt.F!=null&&(Xt.J+=Xt.v),Xt.ka=ai-Xt.j,Xt.U=Xt.va-Xt.v,Xt.T=Ui-ai,cr=Xt.put(Xt))}zn+1!=Ut.Ic||Pr||(s(Ut.sa,Ut.ta-Yn,Pi,pr+16*Ut.R,Yn),s(Ut.qa,Ut.ra-tr,Yi,gi+8*Ut.B,tr),s(Ut.Ha,Ut.Ia-tr,Ur,ao+8*Ut.B,tr))}if(!cr)return Mi(pi,6,"Output aborted.")}return 1})(ke,He)),He.bc!=null&&He.bc(He),Qe&=1}return Qe?(ke.cb=0,Qe):0})(f,I)||(y=f.a)}}else y=f.a}y==0&&oe.Oa!=null&&oe.Oa.fd&&(y=Do(oe.ba))}oe=y}ie=oe!=0?null:11>ie?ce.f.RGBA.eb:ce.f.kb.y}else ie=null;return ie};var ja=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function m(F,$){for(var H="",R=0;R<4;R++)H+=String.fromCharCode(F[$++]);return H}function C(F,$){return F[$+0]|F[$+1]<<8}function D(F,$){return(F[$+0]|F[$+1]<<8|F[$+2]<<16)>>>0}function M(F,$){return(F[$+0]|F[$+1]<<8|F[$+2]<<16|F[$+3]<<24)>>>0}new v;var S=[0],U=[0],_=[],N=new v,g=n,ae=(function(F,$){var H={},R=0,Z=!1,Y=0,we=0;if(H.frames=[],!(function(A,q){for(var W=0;W<4;W++)if(A[q+W]!="RIFF".charCodeAt(W))return!0;return!1})(F,$)){for(M(F,$+=4),$+=8;$<F.length;){var te=m(F,$),de=M(F,$+=4);$+=4;var je=de+(1&de);switch(te){case"VP8 ":case"VP8L":H.frames[R]===void 0&&(H.frames[R]={}),(k=H.frames[R]).src_off=Z?we:$-8,k.src_size=Y+de+8,R++,Z&&(Z=!1,Y=0,we=0);break;case"VP8X":(k=H.header={}).feature_flags=F[$];var Ie=$+4;k.canvas_width=1+D(F,Ie),Ie+=3,k.canvas_height=1+D(F,Ie),Ie+=3;break;case"ALPH":Z=!0,Y=je+8,we=$-8;break;case"ANIM":(k=H.header).bgcolor=M(F,$),Ie=$+4,k.loop_count=C(F,Ie),Ie+=2;break;case"ANMF":var xe,k;(k=H.frames[R]={}).offset_x=2*D(F,$),$+=3,k.offset_y=2*D(F,$),$+=3,k.width=1+D(F,$),$+=3,k.height=1+D(F,$),$+=3,k.duration=D(F,$),$+=3,xe=F[$++],k.dispose=1&xe,k.blend=xe>>1&1}te!="ANMF"&&($+=je)}return H}})(g,0);ae.response=g,ae.rgbaoutput=!0,ae.dataurl=!1;var V=ae.header?ae.header:null,E=ae.frames?ae.frames:null;if(V){V.loop_counter=V.loop_count,S=[V.canvas_height],U=[V.canvas_width];for(var re=0;re<E.length&&E[re].blend!=0;re++);}var J=E[0],G=N.WebPDecodeRGBA(g,J.src_off,J.src_size,U,S);J.rgba=G,J.imgwidth=U[0],J.imgheight=S[0];for(var ee=0;ee<U[0]*S[0]*4;ee++)_[ee]=G[ee];return this.width=U,this.height=S,this.data=_,this}(function(n){var r,o,s,l,d,b,p,v,m,C=function(A){return A=A||{},this.isStrokeTransparent=A.isStrokeTransparent||!1,this.strokeOpacity=A.strokeOpacity||1,this.strokeStyle=A.strokeStyle||"#000000",this.fillStyle=A.fillStyle||"#000000",this.isFillTransparent=A.isFillTransparent||!1,this.fillOpacity=A.fillOpacity||1,this.font=A.font||"10px sans-serif",this.textBaseline=A.textBaseline||"alphabetic",this.textAlign=A.textAlign||"left",this.lineWidth=A.lineWidth||1,this.lineJoin=A.lineJoin||"miter",this.lineCap=A.lineCap||"butt",this.path=A.path||[],this.transform=A.transform!==void 0?A.transform.clone():new v,this.globalCompositeOperation=A.globalCompositeOperation||"normal",this.globalAlpha=A.globalAlpha||1,this.clip_path=A.clip_path||[],this.currentPoint=A.currentPoint||new b,this.miterLimit=A.miterLimit||10,this.lastPoint=A.lastPoint||new b,this.lineDashOffset=A.lineDashOffset||0,this.lineDash=A.lineDash||[],this.margin=A.margin||[0,0,0,0],this.prevPageLastElemOffset=A.prevPageLastElemOffset||0,this.ignoreClearRect=typeof A.ignoreClearRect!="boolean"||A.ignoreClearRect,this};n.events.push(["initialized",function(){this.context2d=new D(this),r=this.internal.f2,o=this.internal.getCoordinateString,s=this.internal.getVerticalCoordinateString,l=this.internal.getHorizontalCoordinate,d=this.internal.getVerticalCoordinate,b=this.internal.Point,p=this.internal.Rectangle,v=this.internal.Matrix,m=new C}]);var D=function(A){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var q=A;Object.defineProperty(this,"pdf",{get:function(){return q}});var W=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return W},set:function(ge){W=!!ge}});var se=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return se},set:function(ge){se=!!ge}});var Ce=0;Object.defineProperty(this,"posX",{get:function(){return Ce},set:function(ge){isNaN(ge)||(Ce=ge)}});var le=0;Object.defineProperty(this,"posY",{get:function(){return le},set:function(ge){isNaN(ge)||(le=ge)}}),Object.defineProperty(this,"margin",{get:function(){return m.margin},set:function(ge){var lt;typeof ge=="number"?lt=[ge,ge,ge,ge]:((lt=new Array(4))[0]=ge[0],lt[1]=ge.length>=2?ge[1]:lt[0],lt[2]=ge.length>=3?ge[2]:lt[0],lt[3]=ge.length>=4?ge[3]:lt[1]),m.margin=lt}});var _e=!1;Object.defineProperty(this,"autoPaging",{get:function(){return _e},set:function(ge){_e=ge}});var be=0;Object.defineProperty(this,"lastBreak",{get:function(){return be},set:function(ge){be=ge}});var De=[];Object.defineProperty(this,"pageBreaks",{get:function(){return De},set:function(ge){De=ge}}),Object.defineProperty(this,"ctx",{get:function(){return m},set:function(ge){ge instanceof C&&(m=ge)}}),Object.defineProperty(this,"path",{get:function(){return m.path},set:function(ge){m.path=ge}});var Ge=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ge},set:function(ge){Ge=ge}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ge){var lt;lt=M(ge),this.ctx.fillStyle=lt.style,this.ctx.isFillTransparent=lt.a===0,this.ctx.fillOpacity=lt.a,this.pdf.setFillColor(lt.r,lt.g,lt.b,{a:lt.a}),this.pdf.setTextColor(lt.r,lt.g,lt.b,{a:lt.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ge){var lt=M(ge);this.ctx.strokeStyle=lt.style,this.ctx.isStrokeTransparent=lt.a===0,this.ctx.strokeOpacity=lt.a,lt.a===0?this.pdf.setDrawColor(255,255,255):(lt.a,this.pdf.setDrawColor(lt.r,lt.g,lt.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ge){["butt","round","square"].indexOf(ge)!==-1&&(this.ctx.lineCap=ge,this.pdf.setLineCap(ge))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ge){isNaN(ge)||(this.ctx.lineWidth=ge,this.pdf.setLineWidth(ge))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ge){["bevel","round","miter"].indexOf(ge)!==-1&&(this.ctx.lineJoin=ge,this.pdf.setLineJoin(ge))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ge){isNaN(ge)||(this.ctx.miterLimit=ge,this.pdf.setMiterLimit(ge))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ge){this.ctx.textBaseline=ge}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ge){["right","end","center","left","start"].indexOf(ge)!==-1&&(this.ctx.textAlign=ge)}});var ot=null,jt=null,Ht=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ht},set:function(ge){ot=null,jt=null,Ht=ge}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ge){var lt;if(this.ctx.font=ge,(lt=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(ge))!==null){var Yt=lt[1];lt[2];var Gt=lt[3],xt=lt[4];lt[5];var hn=lt[6],Et=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(xt)[2];xt=Math.floor(Et==="px"?parseFloat(xt)*this.pdf.internal.scaleFactor:Et==="em"?parseFloat(xt)*this.pdf.getFontSize():parseFloat(xt)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(xt);var gn=(function(ye){var ze,Nt,Ke=[],vt=ye.trim();if(vt==="")return Og;if(vt in Ry)return[Ry[vt]];for(;vt!=="";){switch(Nt=null,ze=(vt=Ly(vt)).charAt(0)){case'"':case"'":Nt=_5(vt.substring(1),ze);break;default:Nt=D5(vt)}if(Nt===null||(Ke.push(Nt[0]),(vt=Ly(Nt[1]))!==""&&vt.charAt(0)!==","))return Og;vt=vt.replace(/^,/,"")}return Ke})(hn);if(this.fontFaces){var Zt=(function(ye,ze){var Nt=ye.getFontList(),Ke=JSON.stringify(Nt);if(ot===null||jt!==Ke){var vt=(function(Vt){var ht=[];return Object.keys(Vt).forEach(function(Je){Vt[Je].forEach(function(Ft){var At=null;switch(Ft){case"bold":At={family:Je,weight:"bold"};break;case"italic":At={family:Je,style:"italic"};break;case"bolditalic":At={family:Je,weight:"bold",style:"italic"};break;case"":case"normal":At={family:Je}}At!==null&&(At.ref={name:Je,style:Ft},ht.push(At))})}),ht})(Nt);ot=(function(Vt){for(var ht={},Je=0;Je<Vt.length;++Je){var Ft=Bg(Vt[Je]),At=Ft.family,Jt=Ft.stretch,An=Ft.style,dn=Ft.weight;ht[At]=ht[At]||{},ht[At][Jt]=ht[At][Jt]||{},ht[At][Jt][An]=ht[At][Jt][An]||{},ht[At][Jt][An][dn]=Ft}return ht})(vt.concat(ze)),jt=Ke}return ot})(this.pdf,this.fontFaces),xn=gn.map(function(ye){return{family:ye,stretch:"normal",weight:Gt,style:Yt}}),tt=(function(ye,ze,Nt){for(var Ke=(Nt=Nt||{}).defaultFontFamily||"times",vt=Object.assign({},z5,Nt.genericFontFamilies||{}),Vt=null,ht=null,Je=0;Je<ze.length;++Je)if(vt[(Vt=Bg(ze[Je])).family]&&(Vt.family=vt[Vt.family]),ye.hasOwnProperty(Vt.family)){ht=ye[Vt.family];break}if(!(ht=ht||ye[Ke]))throw new Error("Could not find a font-family for the rule '"+Iy(Vt)+"' and default family '"+Ke+"'.");if(ht=(function(Ft,At){if(At[Ft])return At[Ft];var Jt=r0[Ft],An=Jt<=r0.normal?-1:1,dn=Dy(At,Zx,Jt,An);if(!dn)throw new Error("Could not find a matching font-stretch value for "+Ft);return dn})(Vt.stretch,ht),ht=(function(Ft,At){if(At[Ft])return At[Ft];for(var Jt=Kx[Ft],An=0;An<Jt.length;++An)if(At[Jt[An]])return At[Jt[An]];throw new Error("Could not find a matching font-style for "+Ft)})(Vt.style,ht),!(ht=(function(Ft,At){if(At[Ft])return At[Ft];if(Ft===400&&At[500])return At[500];if(Ft===500&&At[400])return At[400];var Jt=P5[Ft],An=Dy(At,Jx,Jt,Ft<400?-1:1);if(!An)throw new Error("Could not find a matching font-weight for value "+Ft);return An})(Vt.weight,ht)))throw new Error("Failed to resolve a font for the rule '"+Iy(Vt)+"'.");return ht})(Zt,xn);this.pdf.setFont(tt.ref.name,tt.ref.style)}else{var Rn="";(Gt==="bold"||parseInt(Gt,10)>=700||Yt==="bold")&&(Rn="bold"),Yt==="italic"&&(Rn+="italic"),Rn.length===0&&(Rn="normal");for(var Lt="",Wt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},vn=0;vn<gn.length;vn++){if(this.pdf.internal.getFont(gn[vn],Rn,{noFallback:!0,disableWarning:!0})!==void 0){Lt=gn[vn];break}if(Rn==="bolditalic"&&this.pdf.internal.getFont(gn[vn],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Lt=gn[vn],Rn="bold";else if(this.pdf.internal.getFont(gn[vn],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Lt=gn[vn],Rn="normal";break}}if(Lt===""){for(var ct=0;ct<gn.length;ct++)if(Wt[gn[ct]]){Lt=Wt[gn[ct]];break}}Lt=Lt===""?"Times":Lt,this.pdf.setFont(Lt,Rn)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ge){this.ctx.globalCompositeOperation=ge}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ge){this.ctx.globalAlpha=ge}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ge){this.ctx.lineDashOffset=ge,k.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ge){this.ctx.lineDash=ge,k.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ge){this.ctx.ignoreClearRect=!!ge}})};D.prototype.setLineDash=function(A){this.lineDash=A},D.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},D.prototype.fill=function(){E.call(this,"fill",!1)},D.prototype.stroke=function(){E.call(this,"stroke",!1)},D.prototype.beginPath=function(){this.path=[{type:"begin"}]},D.prototype.moveTo=function(A,q){if(isNaN(A)||isNaN(q))throw lo.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var W=this.ctx.transform.applyToPoint(new b(A,q));this.path.push({type:"mt",x:W.x,y:W.y}),this.ctx.lastPoint=new b(A,q)},D.prototype.closePath=function(){var A=new b(0,0),q=0;for(q=this.path.length-1;q!==-1;q--)if(this.path[q].type==="begin"&&qr(this.path[q+1])==="object"&&typeof this.path[q+1].x=="number"){A=new b(this.path[q+1].x,this.path[q+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new b(A.x,A.y)},D.prototype.lineTo=function(A,q){if(isNaN(A)||isNaN(q))throw lo.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var W=this.ctx.transform.applyToPoint(new b(A,q));this.path.push({type:"lt",x:W.x,y:W.y}),this.ctx.lastPoint=new b(W.x,W.y)},D.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),E.call(this,null,!0)},D.prototype.quadraticCurveTo=function(A,q,W,se){if(isNaN(W)||isNaN(se)||isNaN(A)||isNaN(q))throw lo.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Ce=this.ctx.transform.applyToPoint(new b(W,se)),le=this.ctx.transform.applyToPoint(new b(A,q));this.path.push({type:"qct",x1:le.x,y1:le.y,x:Ce.x,y:Ce.y}),this.ctx.lastPoint=new b(Ce.x,Ce.y)},D.prototype.bezierCurveTo=function(A,q,W,se,Ce,le){if(isNaN(Ce)||isNaN(le)||isNaN(A)||isNaN(q)||isNaN(W)||isNaN(se))throw lo.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var _e=this.ctx.transform.applyToPoint(new b(Ce,le)),be=this.ctx.transform.applyToPoint(new b(A,q)),De=this.ctx.transform.applyToPoint(new b(W,se));this.path.push({type:"bct",x1:be.x,y1:be.y,x2:De.x,y2:De.y,x:_e.x,y:_e.y}),this.ctx.lastPoint=new b(_e.x,_e.y)},D.prototype.arc=function(A,q,W,se,Ce,le){if(isNaN(A)||isNaN(q)||isNaN(W)||isNaN(se)||isNaN(Ce))throw lo.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(le=!!le,!this.ctx.transform.isIdentity){var _e=this.ctx.transform.applyToPoint(new b(A,q));A=_e.x,q=_e.y;var be=this.ctx.transform.applyToPoint(new b(0,W)),De=this.ctx.transform.applyToPoint(new b(0,0));W=Math.sqrt(Math.pow(be.x-De.x,2)+Math.pow(be.y-De.y,2))}Math.abs(Ce-se)>=2*Math.PI&&(se=0,Ce=2*Math.PI),this.path.push({type:"arc",x:A,y:q,radius:W,startAngle:se,endAngle:Ce,counterclockwise:le})},D.prototype.arcTo=function(A,q,W,se,Ce){throw new Error("arcTo not implemented.")},D.prototype.rect=function(A,q,W,se){if(isNaN(A)||isNaN(q)||isNaN(W)||isNaN(se))throw lo.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(A,q),this.lineTo(A+W,q),this.lineTo(A+W,q+se),this.lineTo(A,q+se),this.lineTo(A,q),this.lineTo(A+W,q),this.lineTo(A,q)},D.prototype.fillRect=function(A,q,W,se){if(isNaN(A)||isNaN(q)||isNaN(W)||isNaN(se))throw lo.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!S.call(this)){var Ce={};this.lineCap!=="butt"&&(Ce.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Ce.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(A,q,W,se),this.fill(),Ce.hasOwnProperty("lineCap")&&(this.lineCap=Ce.lineCap),Ce.hasOwnProperty("lineJoin")&&(this.lineJoin=Ce.lineJoin)}},D.prototype.strokeRect=function(A,q,W,se){if(isNaN(A)||isNaN(q)||isNaN(W)||isNaN(se))throw lo.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");U.call(this)||(this.beginPath(),this.rect(A,q,W,se),this.stroke())},D.prototype.clearRect=function(A,q,W,se){if(isNaN(A)||isNaN(q)||isNaN(W)||isNaN(se))throw lo.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(A,q,W,se))},D.prototype.save=function(A){A=typeof A!="boolean"||A;for(var q=this.pdf.internal.getCurrentPageInfo().pageNumber,W=0;W<this.pdf.internal.getNumberOfPages();W++)this.pdf.setPage(W+1),this.pdf.internal.out("q");if(this.pdf.setPage(q),A){this.ctx.fontSize=this.pdf.internal.getFontSize();var se=new C(this.ctx);this.ctxStack.push(this.ctx),this.ctx=se}},D.prototype.restore=function(A){A=typeof A!="boolean"||A;for(var q=this.pdf.internal.getCurrentPageInfo().pageNumber,W=0;W<this.pdf.internal.getNumberOfPages();W++)this.pdf.setPage(W+1),this.pdf.internal.out("Q");this.pdf.setPage(q),A&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},D.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var M=function(A){var q,W,se,Ce;if(A.isCanvasGradient===!0&&(A=A.getColor()),!A)return{r:0,g:0,b:0,a:0,style:A};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(A))q=0,W=0,se=0,Ce=0;else{var le=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(A);if(le!==null)q=parseInt(le[1]),W=parseInt(le[2]),se=parseInt(le[3]),Ce=1;else if((le=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(A))!==null)q=parseInt(le[1]),W=parseInt(le[2]),se=parseInt(le[3]),Ce=parseFloat(le[4]);else{if(Ce=1,typeof A=="string"&&A.charAt(0)!=="#"){var _e=new qx(A);A=_e.ok?_e.toHex():"#000000"}A.length===4?(q=A.substring(1,2),q+=q,W=A.substring(2,3),W+=W,se=A.substring(3,4),se+=se):(q=A.substring(1,3),W=A.substring(3,5),se=A.substring(5,7)),q=parseInt(q,16),W=parseInt(W,16),se=parseInt(se,16)}}return{r:q,g:W,b:se,a:Ce,style:A}},S=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},U=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};D.prototype.fillText=function(A,q,W,se){if(isNaN(q)||isNaN(W)||typeof A!="string")throw lo.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(se=isNaN(se)?void 0:se,!S.call(this)){var Ce=je(this.ctx.transform.rotation),le=this.ctx.transform.scaleX;R.call(this,{text:A,x:q,y:W,scale:le,angle:Ce,align:this.textAlign,maxWidth:se})}},D.prototype.strokeText=function(A,q,W,se){if(isNaN(q)||isNaN(W)||typeof A!="string")throw lo.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!U.call(this)){se=isNaN(se)?void 0:se;var Ce=je(this.ctx.transform.rotation),le=this.ctx.transform.scaleX;R.call(this,{text:A,x:q,y:W,scale:le,renderingMode:"stroke",angle:Ce,align:this.textAlign,maxWidth:se})}},D.prototype.measureText=function(A){if(typeof A!="string")throw lo.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var q=this.pdf,W=this.pdf.internal.scaleFactor,se=q.internal.getFontSize(),Ce=q.getStringUnitWidth(A)*se/q.internal.scaleFactor;return new function(le){var _e=(le=le||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return _e}}),this}({width:Ce*=Math.round(96*W/72*1e4)/1e4})},D.prototype.scale=function(A,q){if(isNaN(A)||isNaN(q))throw lo.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var W=new v(A,0,0,q,0,0);this.ctx.transform=this.ctx.transform.multiply(W)},D.prototype.rotate=function(A){if(isNaN(A))throw lo.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var q=new v(Math.cos(A),Math.sin(A),-Math.sin(A),Math.cos(A),0,0);this.ctx.transform=this.ctx.transform.multiply(q)},D.prototype.translate=function(A,q){if(isNaN(A)||isNaN(q))throw lo.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var W=new v(1,0,0,1,A,q);this.ctx.transform=this.ctx.transform.multiply(W)},D.prototype.transform=function(A,q,W,se,Ce,le){if(isNaN(A)||isNaN(q)||isNaN(W)||isNaN(se)||isNaN(Ce)||isNaN(le))throw lo.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var _e=new v(A,q,W,se,Ce,le);this.ctx.transform=this.ctx.transform.multiply(_e)},D.prototype.setTransform=function(A,q,W,se,Ce,le){A=isNaN(A)?1:A,q=isNaN(q)?0:q,W=isNaN(W)?0:W,se=isNaN(se)?1:se,Ce=isNaN(Ce)?0:Ce,le=isNaN(le)?0:le,this.ctx.transform=new v(A,q,W,se,Ce,le)};var _=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};D.prototype.drawImage=function(A,q,W,se,Ce,le,_e,be,De){var Ge=this.pdf.getImageProperties(A),ot=1,jt=1,Ht=1,ge=1;se!==void 0&&be!==void 0&&(Ht=be/se,ge=De/Ce,ot=Ge.width/se*be/se,jt=Ge.height/Ce*De/Ce),le===void 0&&(le=q,_e=W,q=0,W=0),se!==void 0&&be===void 0&&(be=se,De=Ce),se===void 0&&be===void 0&&(be=Ge.width,De=Ge.height);var lt=this.ctx.transform.decompose(),Yt=je(lt.rotate.shx),Gt=new v,xt=(Gt=(Gt=(Gt=Gt.multiply(lt.translate)).multiply(lt.skew)).multiply(lt.scale)).applyToRectangle(new p(le-q*Ht,_e-W*ge,se*ot,Ce*jt));if(this.autoPaging){for(var hn,Et=N.call(this,xt),gn=[],Zt=0;Zt<Et.length;Zt+=1)gn.indexOf(Et[Zt])===-1&&gn.push(Et[Zt]);V(gn);for(var xn=gn[0],tt=gn[gn.length-1],Rn=xn;Rn<tt+1;Rn++){this.pdf.setPage(Rn);var Lt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Wt=Rn===1?this.posY+this.margin[0]:this.margin[0],vn=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ct=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ye=Rn===1?0:vn+(Rn-2)*ct;if(this.ctx.clip_path.length!==0){var ze=this.path;hn=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=ae(hn,this.posX+this.margin[3],-ye+Wt+this.ctx.prevPageLastElemOffset),re.call(this,"fill",!0),this.path=ze}var Nt=JSON.parse(JSON.stringify(xt));Nt=ae([Nt],this.posX+this.margin[3],-ye+Wt+this.ctx.prevPageLastElemOffset)[0];var Ke=(Rn>xn||Rn<tt)&&_.call(this);Ke&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Lt,ct,null).clip().discardPath()),this.pdf.addImage(A,"JPEG",Nt.x,Nt.y,Nt.w,Nt.h,null,null,Yt),Ke&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(A,"JPEG",xt.x,xt.y,xt.w,xt.h,null,null,Yt)};var N=function(A,q,W){var se=[];q=q||this.pdf.internal.pageSize.width,W=W||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Ce=this.posY+this.ctx.prevPageLastElemOffset;switch(A.type){default:case"mt":case"lt":se.push(Math.floor((A.y+Ce)/W)+1);break;case"arc":se.push(Math.floor((A.y+Ce-A.radius)/W)+1),se.push(Math.floor((A.y+Ce+A.radius)/W)+1);break;case"qct":var le=Ie(this.ctx.lastPoint.x,this.ctx.lastPoint.y,A.x1,A.y1,A.x,A.y);se.push(Math.floor((le.y+Ce)/W)+1),se.push(Math.floor((le.y+le.h+Ce)/W)+1);break;case"bct":var _e=xe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,A.x1,A.y1,A.x2,A.y2,A.x,A.y);se.push(Math.floor((_e.y+Ce)/W)+1),se.push(Math.floor((_e.y+_e.h+Ce)/W)+1);break;case"rect":se.push(Math.floor((A.y+Ce)/W)+1),se.push(Math.floor((A.y+A.h+Ce)/W)+1)}for(var be=0;be<se.length;be+=1)for(;this.pdf.internal.getNumberOfPages()<se[be];)g.call(this);return se},g=function(){var A=this.fillStyle,q=this.strokeStyle,W=this.font,se=this.lineCap,Ce=this.lineWidth,le=this.lineJoin;this.pdf.addPage(),this.fillStyle=A,this.strokeStyle=q,this.font=W,this.lineCap=se,this.lineWidth=Ce,this.lineJoin=le},ae=function(A,q,W){for(var se=0;se<A.length;se++)switch(A[se].type){case"bct":A[se].x2+=q,A[se].y2+=W;case"qct":A[se].x1+=q,A[se].y1+=W;default:A[se].x+=q,A[se].y+=W}return A},V=function(A){return A.sort(function(q,W){return q-W})},E=function(A,q){var W=this.fillStyle,se=this.strokeStyle,Ce=this.lineCap,le=this.lineWidth,_e=Math.abs(le*this.ctx.transform.scaleX),be=this.lineJoin;if(this.autoPaging){for(var De,Ge,ot=JSON.parse(JSON.stringify(this.path)),jt=JSON.parse(JSON.stringify(this.path)),Ht=[],ge=0;ge<jt.length;ge++)if(jt[ge].x!==void 0)for(var lt=N.call(this,jt[ge]),Yt=0;Yt<lt.length;Yt+=1)Ht.indexOf(lt[Yt])===-1&&Ht.push(lt[Yt]);for(var Gt=0;Gt<Ht.length;Gt++)for(;this.pdf.internal.getNumberOfPages()<Ht[Gt];)g.call(this);V(Ht);for(var xt=Ht[0],hn=Ht[Ht.length-1],Et=xt;Et<hn+1;Et++){this.pdf.setPage(Et),this.fillStyle=W,this.strokeStyle=se,this.lineCap=Ce,this.lineWidth=_e,this.lineJoin=be;var gn=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Zt=Et===1?this.posY+this.margin[0]:this.margin[0],xn=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],tt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Rn=Et===1?0:xn+(Et-2)*tt;if(this.ctx.clip_path.length!==0){var Lt=this.path;De=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=ae(De,this.posX+this.margin[3],-Rn+Zt+this.ctx.prevPageLastElemOffset),re.call(this,A,!0),this.path=Lt}if(Ge=JSON.parse(JSON.stringify(ot)),this.path=ae(Ge,this.posX+this.margin[3],-Rn+Zt+this.ctx.prevPageLastElemOffset),q===!1||Et===0){var Wt=(Et>xt||Et<hn)&&_.call(this);Wt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],gn,tt,null).clip().discardPath()),re.call(this,A,q),Wt&&this.pdf.restoreGraphicsState()}this.lineWidth=le}this.path=ot}else this.lineWidth=_e,re.call(this,A,q),this.lineWidth=le},re=function(A,q){if((A!=="stroke"||q||!U.call(this))&&(A==="stroke"||q||!S.call(this))){for(var W,se,Ce=[],le=this.path,_e=0;_e<le.length;_e++){var be=le[_e];switch(be.type){case"begin":Ce.push({begin:!0});break;case"close":Ce.push({close:!0});break;case"mt":Ce.push({start:be,deltas:[],abs:[]});break;case"lt":var De=Ce.length;if(le[_e-1]&&!isNaN(le[_e-1].x)&&(W=[be.x-le[_e-1].x,be.y-le[_e-1].y],De>0)){for(;De>=0;De--)if(Ce[De-1].close!==!0&&Ce[De-1].begin!==!0){Ce[De-1].deltas.push(W),Ce[De-1].abs.push(be);break}}break;case"bct":W=[be.x1-le[_e-1].x,be.y1-le[_e-1].y,be.x2-le[_e-1].x,be.y2-le[_e-1].y,be.x-le[_e-1].x,be.y-le[_e-1].y],Ce[Ce.length-1].deltas.push(W);break;case"qct":var Ge=le[_e-1].x+2/3*(be.x1-le[_e-1].x),ot=le[_e-1].y+2/3*(be.y1-le[_e-1].y),jt=be.x+2/3*(be.x1-be.x),Ht=be.y+2/3*(be.y1-be.y),ge=be.x,lt=be.y;W=[Ge-le[_e-1].x,ot-le[_e-1].y,jt-le[_e-1].x,Ht-le[_e-1].y,ge-le[_e-1].x,lt-le[_e-1].y],Ce[Ce.length-1].deltas.push(W);break;case"arc":Ce.push({deltas:[],abs:[],arc:!0}),Array.isArray(Ce[Ce.length-1].abs)&&Ce[Ce.length-1].abs.push(be)}}se=q?null:A==="stroke"?"stroke":"fill";for(var Yt=!1,Gt=0;Gt<Ce.length;Gt++)if(Ce[Gt].arc)for(var xt=Ce[Gt].abs,hn=0;hn<xt.length;hn++){var Et=xt[hn];Et.type==="arc"?ee.call(this,Et.x,Et.y,Et.radius,Et.startAngle,Et.endAngle,Et.counterclockwise,void 0,q,!Yt):Z.call(this,Et.x,Et.y),Yt=!0}else if(Ce[Gt].close===!0)this.pdf.internal.out("h"),Yt=!1;else if(Ce[Gt].begin!==!0){var gn=Ce[Gt].start.x,Zt=Ce[Gt].start.y;Y.call(this,Ce[Gt].deltas,gn,Zt),Yt=!0}se&&F.call(this,se),q&&$.call(this)}},J=function(A){var q=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,W=q*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return A-W;case"top":return A+q-W;case"hanging":return A+q-2*W;case"middle":return A+q/2-W;default:return A}},G=function(A){return A+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};D.prototype.createLinearGradient=function(){var A=function(){};return A.colorStops=[],A.addColorStop=function(q,W){this.colorStops.push([q,W])},A.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},A.isCanvasGradient=!0,A},D.prototype.createPattern=function(){return this.createLinearGradient()},D.prototype.createRadialGradient=function(){return this.createLinearGradient()};var ee=function(A,q,W,se,Ce,le,_e,be,De){for(var Ge=te.call(this,W,se,Ce,le),ot=0;ot<Ge.length;ot++){var jt=Ge[ot];ot===0&&(De?H.call(this,jt.x1+A,jt.y1+q):Z.call(this,jt.x1+A,jt.y1+q)),we.call(this,A,q,jt.x2,jt.y2,jt.x3,jt.y3,jt.x4,jt.y4)}be?$.call(this):F.call(this,_e)},F=function(A){switch(A){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},$=function(){this.pdf.clip(),this.pdf.discardPath()},H=function(A,q){this.pdf.internal.out(o(A)+" "+s(q)+" m")},R=function(A){var q;switch(A.align){case"right":case"end":q="right";break;case"center":q="center";break;default:q="left"}var W,se,Ce,le=this.pdf.getTextDimensions(A.text),_e=J.call(this,A.y),be=G.call(this,_e)-le.h,De=this.ctx.transform.applyToPoint(new b(A.x,_e));if(this.autoPaging){var Ge=this.ctx.transform.decompose(),ot=new v;ot=(ot=(ot=ot.multiply(Ge.translate)).multiply(Ge.skew)).multiply(Ge.scale);for(var jt=this.ctx.transform.applyToRectangle(new p(A.x,_e,le.w,le.h)),Ht=ot.applyToRectangle(new p(A.x,be,le.w,le.h)),ge=N.call(this,Ht),lt=[],Yt=0;Yt<ge.length;Yt+=1)lt.indexOf(ge[Yt])===-1&&lt.push(ge[Yt]);V(lt);for(var Gt=lt[0],xt=lt[lt.length-1],hn=Gt;hn<xt+1;hn++){this.pdf.setPage(hn);var Et=hn===1?this.posY+this.margin[0]:this.margin[0],gn=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Zt=this.pdf.internal.pageSize.height-this.margin[2],xn=Zt-this.margin[0],tt=this.pdf.internal.pageSize.width-this.margin[1],Rn=tt-this.margin[3],Lt=hn===1?0:gn+(hn-2)*xn;if(this.ctx.clip_path.length!==0){var Wt=this.path;W=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=ae(W,this.posX+this.margin[3],-1*Lt+Et),re.call(this,"fill",!0),this.path=Wt}var vn=ae([JSON.parse(JSON.stringify(Ht))],this.posX+this.margin[3],-Lt+Et+this.ctx.prevPageLastElemOffset)[0];A.scale>=.01&&(se=this.pdf.internal.getFontSize(),this.pdf.setFontSize(se*A.scale),Ce=this.lineWidth,this.lineWidth=Ce*A.scale);var ct=this.autoPaging!=="text";if(ct||vn.y+vn.h<=Zt){if(ct||vn.y>=Et&&vn.x<=tt){var ye=ct?A.text:this.pdf.splitTextToSize(A.text,A.maxWidth||tt-vn.x)[0],ze=ae([JSON.parse(JSON.stringify(jt))],this.posX+this.margin[3],-Lt+Et+this.ctx.prevPageLastElemOffset)[0],Nt=ct&&(hn>Gt||hn<xt)&&_.call(this);Nt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Rn,xn,null).clip().discardPath()),this.pdf.text(ye,ze.x,ze.y,{angle:A.angle,align:q,renderingMode:A.renderingMode}),Nt&&this.pdf.restoreGraphicsState()}}else vn.y<Zt&&(this.ctx.prevPageLastElemOffset+=Zt-vn.y);A.scale>=.01&&(this.pdf.setFontSize(se),this.lineWidth=Ce)}}else A.scale>=.01&&(se=this.pdf.internal.getFontSize(),this.pdf.setFontSize(se*A.scale),Ce=this.lineWidth,this.lineWidth=Ce*A.scale),this.pdf.text(A.text,De.x+this.posX,De.y+this.posY,{angle:A.angle,align:q,renderingMode:A.renderingMode,maxWidth:A.maxWidth}),A.scale>=.01&&(this.pdf.setFontSize(se),this.lineWidth=Ce)},Z=function(A,q,W,se){W=W||0,se=se||0,this.pdf.internal.out(o(A+W)+" "+s(q+se)+" l")},Y=function(A,q,W){return this.pdf.lines(A,q,W,null,null)},we=function(A,q,W,se,Ce,le,_e,be){this.pdf.internal.out([r(l(W+A)),r(d(se+q)),r(l(Ce+A)),r(d(le+q)),r(l(_e+A)),r(d(be+q)),"c"].join(" "))},te=function(A,q,W,se){for(var Ce=2*Math.PI,le=Math.PI/2;q>W;)q-=Ce;var _e=Math.abs(W-q);_e<Ce&&se&&(_e=Ce-_e);for(var be=[],De=se?-1:1,Ge=q;_e>1e-5;){var ot=Ge+De*Math.min(_e,le);be.push(de.call(this,A,Ge,ot)),_e-=Math.abs(ot-Ge),Ge=ot}return be},de=function(A,q,W){var se=(W-q)/2,Ce=A*Math.cos(se),le=A*Math.sin(se),_e=Ce,be=-le,De=_e*_e+be*be,Ge=De+_e*Ce+be*le,ot=4/3*(Math.sqrt(2*De*Ge)-Ge)/(_e*le-be*Ce),jt=_e-ot*be,Ht=be+ot*_e,ge=jt,lt=-Ht,Yt=se+q,Gt=Math.cos(Yt),xt=Math.sin(Yt);return{x1:A*Math.cos(q),y1:A*Math.sin(q),x2:jt*Gt-Ht*xt,y2:jt*xt+Ht*Gt,x3:ge*Gt-lt*xt,y3:ge*xt+lt*Gt,x4:A*Math.cos(W),y4:A*Math.sin(W)}},je=function(A){return 180*A/Math.PI},Ie=function(A,q,W,se,Ce,le){var _e=A+.5*(W-A),be=q+.5*(se-q),De=Ce+.5*(W-Ce),Ge=le+.5*(se-le),ot=Math.min(A,Ce,_e,De),jt=Math.max(A,Ce,_e,De),Ht=Math.min(q,le,be,Ge),ge=Math.max(q,le,be,Ge);return new p(ot,Ht,jt-ot,ge-Ht)},xe=function(A,q,W,se,Ce,le,_e,be){var De,Ge,ot,jt,Ht,ge,lt,Yt,Gt,xt,hn,Et,gn,Zt,xn=W-A,tt=se-q,Rn=Ce-W,Lt=le-se,Wt=_e-Ce,vn=be-le;for(Ge=0;Ge<41;Ge++)Gt=(lt=(ot=A+(De=Ge/40)*xn)+De*((Ht=W+De*Rn)-ot))+De*(Ht+De*(Ce+De*Wt-Ht)-lt),xt=(Yt=(jt=q+De*tt)+De*((ge=se+De*Lt)-jt))+De*(ge+De*(le+De*vn-ge)-Yt),Ge==0?(hn=Gt,Et=xt,gn=Gt,Zt=xt):(hn=Math.min(hn,Gt),Et=Math.min(Et,xt),gn=Math.max(gn,Gt),Zt=Math.max(Zt,xt));return new p(Math.round(hn),Math.round(Et),Math.round(gn-hn),Math.round(Zt-Et))},k=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var A,q,W=(A=this.ctx.lineDash,q=this.ctx.lineDashOffset,JSON.stringify({lineDash:A,lineDashOffset:q}));this.prevLineDash!==W&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=W)}}})(qn.API),(function(n){var r=function(b){var p,v,m,C,D,M,S,U,_,N;for(v=[],m=0,C=(b+=p="\0\0\0\0".slice(b.length%4||4)).length;C>m;m+=4)(D=(b.charCodeAt(m)<<24)+(b.charCodeAt(m+1)<<16)+(b.charCodeAt(m+2)<<8)+b.charCodeAt(m+3))!==0?(M=(D=((D=((D=((D=(D-(N=D%85))/85)-(_=D%85))/85)-(U=D%85))/85)-(S=D%85))/85)%85,v.push(M+33,S+33,U+33,_+33,N+33)):v.push(122);return(function(g,ae){for(var V=ae;V>0;V--)g.pop()})(v,p.length),String.fromCharCode.apply(String,v)+"~>"},o=function(b){var p,v,m,C,D,M=String,S="length",U=255,_="charCodeAt",N="slice",g="replace";for(b[N](-2),b=b[N](0,-2)[g](/\s/g,"")[g]("z","!!!!!"),m=[],C=0,D=(b+=p="uuuuu"[N](b[S]%5||5))[S];D>C;C+=5)v=52200625*(b[_](C)-33)+614125*(b[_](C+1)-33)+7225*(b[_](C+2)-33)+85*(b[_](C+3)-33)+(b[_](C+4)-33),m.push(U&v>>24,U&v>>16,U&v>>8,U&v);return(function(ae,V){for(var E=V;E>0;E--)ae.pop()})(m,p[S]),M.fromCharCode.apply(M,m)},s=function(b){return b.split("").map(function(p){return("0"+p.charCodeAt().toString(16)).slice(-2)}).join("")+">"},l=function(b){var p=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((b=b.replace(/\s/g,"")).indexOf(">")!==-1&&(b=b.substr(0,b.indexOf(">"))),b.length%2&&(b+="0"),p.test(b)===!1)return"";for(var v="",m=0;m<b.length;m+=2)v+=String.fromCharCode("0x"+(b[m]+b[m+1]));return v},d=function(b){for(var p=new Uint8Array(b.length),v=b.length;v--;)p[v]=b.charCodeAt(v);return(p=Zg(p)).reduce(function(m,C){return m+String.fromCharCode(C)},"")};n.processDataByFilters=function(b,p){var v=0,m=b||"",C=[];for(typeof(p=p||[])=="string"&&(p=[p]),v=0;v<p.length;v+=1)switch(p[v]){case"ASCII85Decode":case"/ASCII85Decode":m=o(m),C.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":m=r(m),C.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":m=l(m),C.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":m=s(m),C.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":m=d(m),C.push("/FlateDecode");break;default:throw new Error('The filter: "'+p[v]+'" is not implemented')}return{data:m,reverseChain:C.reverse().join(" ")}}})(qn.API),(function(n){n.loadFile=function(r,o,s){return(function(l,d,b){d=d!==!1,b=typeof b=="function"?b:function(){};var p=void 0;try{p=(function(v,m,C){var D=new XMLHttpRequest,M=0,S=function(U){var _=U.length,N=[],g=String.fromCharCode;for(M=0;M<_;M+=1)N.push(g(255&U.charCodeAt(M)));return N.join("")};if(D.open("GET",v,!m),D.overrideMimeType("text/plain; charset=x-user-defined"),m===!1&&(D.onload=function(){D.status===200?C(S(this.responseText)):C(void 0)}),D.send(null),m&&D.status===200)return S(D.responseText)})(l,d,b)}catch{}return p})(r,o,s)},n.loadImageFile=n.loadFile})(qn.API),(function(n){function r(){return(ci.html2canvas?Promise.resolve(ci.html2canvas):bg(()=>import("./html2canvas.esm-B0tyYwQk.js"),[])).catch(function(p){return Promise.reject(new Error("Could not load html2canvas: "+p))}).then(function(p){return p.default?p.default:p})}function o(){return(ci.DOMPurify?Promise.resolve(ci.DOMPurify):bg(()=>import("./purify.es-B6FQ9oRL.js"),[])).catch(function(p){return Promise.reject(new Error("Could not load dompurify: "+p))}).then(function(p){return p.default?p.default:p})}var s=function(p){var v=qr(p);return v==="undefined"?"undefined":v==="string"||p instanceof String?"string":v==="number"||p instanceof Number?"number":v==="function"||p instanceof Function?"function":p&&p.constructor===Array?"array":p&&p.nodeType===1?"element":v==="object"?"object":"unknown"},l=function(p,v){var m=document.createElement(p);for(var C in v.className&&(m.className=v.className),v.innerHTML&&v.dompurify&&(m.innerHTML=v.dompurify.sanitize(v.innerHTML)),v.style)m.style[C]=v.style[C];return m},d=function p(v,m){for(var C=v.nodeType===3?document.createTextNode(v.nodeValue):v.cloneNode(!1),D=v.firstChild;D;D=D.nextSibling)m!==!0&&D.nodeType===1&&D.nodeName==="SCRIPT"||C.appendChild(p(D,m));return v.nodeType===1&&(v.nodeName==="CANVAS"?(C.width=v.width,C.height=v.height,C.getContext("2d").drawImage(v,0,0)):v.nodeName!=="TEXTAREA"&&v.nodeName!=="SELECT"||(C.value=v.value),C.addEventListener("load",function(){C.scrollTop=v.scrollTop,C.scrollLeft=v.scrollLeft},!0)),C},b=function p(v){var m=Object.assign(p.convert(Promise.resolve()),JSON.parse(JSON.stringify(p.template))),C=p.convert(Promise.resolve(),m);return(C=C.setProgress(1,p,1,[p])).set(v)};(b.prototype=Object.create(Promise.prototype)).constructor=b,b.convert=function(p,v){return p.__proto__=v||b.prototype,p},b.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},b.prototype.from=function(p,v){return this.then(function(){switch(v=v||(function(m){switch(s(m)){case"string":return"string";case"element":return m.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(p),v){case"string":return this.then(o).then(function(m){return this.set({src:l("div",{innerHTML:p,dompurify:m})})});case"element":return this.set({src:p});case"canvas":return this.set({canvas:p});case"img":return this.set({img:p});default:return this.error("Unknown source type.")}})},b.prototype.to=function(p){switch(p){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},b.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var p={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},v=d(this.prop.src,this.opt.html2canvas.javascriptEnabled);v.tagName==="BODY"&&(p.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=l("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=l("div",{className:"html2pdf__container",style:p}),this.prop.container.appendChild(v),this.prop.container.firstChild.appendChild(l("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},b.prototype.toCanvas=function(){var p=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(p).then(r).then(function(v){var m=Object.assign({},this.opt.html2canvas);return delete m.onrendered,v(this.prop.container,m)}).then(function(v){(this.opt.html2canvas.onrendered||function(){})(v),this.prop.canvas=v,document.body.removeChild(this.prop.overlay)})},b.prototype.toContext2d=function(){var p=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(p).then(r).then(function(v){var m=this.opt.jsPDF,C=this.opt.fontFaces,D=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,M=Object.assign({async:!0,allowTaint:!0,scale:D,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete M.onrendered,m.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,m.context2d.posX=this.opt.x,m.context2d.posY=this.opt.y,m.context2d.margin=this.opt.margin,m.context2d.fontFaces=C,C)for(var S=0;S<C.length;++S){var U=C[S],_=U.src.find(function(N){return N.format==="truetype"});_&&m.addFont(_.url,U.ref.name,U.ref.style)}return M.windowHeight=M.windowHeight||0,M.windowHeight=M.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):M.windowHeight,m.context2d.save(!0),v(this.prop.container,M)}).then(function(v){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(v),this.prop.canvas=v,document.body.removeChild(this.prop.overlay)})},b.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var p=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=p})},b.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},b.prototype.output=function(p,v,m){return(m=m||"pdf").toLowerCase()==="img"||m.toLowerCase()==="image"?this.outputImg(p,v):this.outputPdf(p,v)},b.prototype.outputPdf=function(p,v){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(p,v)})},b.prototype.outputImg=function(p){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(p){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+p+'" is not supported.'}})},b.prototype.save=function(p){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(p?{filename:p}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},b.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},b.prototype.set=function(p){if(s(p)!=="object")return this;var v=Object.keys(p||{}).map(function(m){if(m in b.template.prop)return function(){this.prop[m]=p[m]};switch(m){case"margin":return this.setMargin.bind(this,p.margin);case"jsPDF":return function(){return this.opt.jsPDF=p.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,p.pageSize);default:return function(){this.opt[m]=p[m]}}},this);return this.then(function(){return this.thenList(v)})},b.prototype.get=function(p,v){return this.then(function(){var m=p in b.template.prop?this.prop[p]:this.opt[p];return v?v(m):m})},b.prototype.setMargin=function(p){return this.then(function(){switch(s(p)){case"number":p=[p,p,p,p];case"array":if(p.length===2&&(p=[p[0],p[1],p[0],p[1]]),p.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=p}).then(this.setPageSize)},b.prototype.setPageSize=function(p){function v(m,C){return Math.floor(m*C/72*96)}return this.then(function(){(p=p||qn.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(p.inner={width:p.width-this.opt.margin[1]-this.opt.margin[3],height:p.height-this.opt.margin[0]-this.opt.margin[2]},p.inner.px={width:v(p.inner.width,p.k),height:v(p.inner.height,p.k)},p.inner.ratio=p.inner.height/p.inner.width),this.prop.pageSize=p})},b.prototype.setProgress=function(p,v,m,C){return p!=null&&(this.progress.val=p),v!=null&&(this.progress.state=v),m!=null&&(this.progress.n=m),C!=null&&(this.progress.stack=C),this.progress.ratio=this.progress.val/this.progress.state,this},b.prototype.updateProgress=function(p,v,m,C){return this.setProgress(p?this.progress.val+p:null,v||null,m?this.progress.n+m:null,C?this.progress.stack.concat(C):null)},b.prototype.then=function(p,v){var m=this;return this.thenCore(p,v,function(C,D){return m.updateProgress(null,null,1,[C]),Promise.prototype.then.call(this,function(M){return m.updateProgress(null,C),M}).then(C,D).then(function(M){return m.updateProgress(1),M})})},b.prototype.thenCore=function(p,v,m){m=m||Promise.prototype.then;var C=this;p&&(p=p.bind(C)),v&&(v=v.bind(C));var D=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?C:b.convert(Object.assign({},C),Promise.prototype),M=m.call(D,p,v);return b.convert(M,C.__proto__)},b.prototype.thenExternal=function(p,v){return Promise.prototype.then.call(this,p,v)},b.prototype.thenList=function(p){var v=this;return p.forEach(function(m){v=v.thenCore(m)}),v},b.prototype.catch=function(p){p&&(p=p.bind(this));var v=Promise.prototype.catch.call(this,p);return b.convert(v,this)},b.prototype.catchExternal=function(p){return Promise.prototype.catch.call(this,p)},b.prototype.error=function(p){return this.then(function(){throw new Error(p)})},b.prototype.using=b.prototype.set,b.prototype.saveAs=b.prototype.save,b.prototype.export=b.prototype.output,b.prototype.run=b.prototype.then,qn.getPageSize=function(p,v,m){if(qr(p)==="object"){var C=p;p=C.orientation,v=C.unit||v,m=C.format||m}v=v||"mm",m=m||"a4",p=(""+(p||"P")).toLowerCase();var D,M=(""+m).toLowerCase(),S={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(v){case"pt":D=1;break;case"mm":D=72/25.4;break;case"cm":D=72/2.54;break;case"in":D=72;break;case"px":D=.75;break;case"pc":case"em":D=12;break;case"ex":D=6;break;default:throw"Invalid unit: "+v}var U,_=0,N=0;if(S.hasOwnProperty(M))_=S[M][1]/D,N=S[M][0]/D;else try{_=m[1],N=m[0]}catch{throw new Error("Invalid format: "+m)}if(p==="p"||p==="portrait")p="p",N>_&&(U=N,N=_,_=U);else{if(p!=="l"&&p!=="landscape")throw"Invalid orientation: "+p;p="l",_>N&&(U=N,N=_,_=U)}return{width:N,height:_,unit:v,k:D,orientation:p}},n.html=function(p,v){(v=v||{}).callback=v.callback||function(){},v.html2canvas=v.html2canvas||{},v.html2canvas.canvas=v.html2canvas.canvas||this.canvas,v.jsPDF=v.jsPDF||this,v.fontFaces=v.fontFaces?v.fontFaces.map(Bg):null;var m=new b(v);return v.worker?m:m.from(p).doCallback()}})(qn.API),qn.API.addJS=function(n){return By=n,this.internal.events.subscribe("postPutResources",function(){ah=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(ah+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),My=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+By+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){ah!==void 0&&My!==void 0&&this.internal.out("/Names <</JavaScript "+ah+" 0 R>>")}),this},(function(n){var r;n.events.push(["postPutResources",function(){var o=this,s=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var l=o.outline.render().split(/\r\n/),d=0;d<l.length;d++){var b=l[d],p=s.exec(b);if(p!=null){var v=p[1];o.internal.newObjectDeferredBegin(v,!1)}o.internal.write(b)}if(this.outline.createNamedDestinations){var m=this.internal.pages.length,C=[];for(d=0;d<m;d++){var D=o.internal.newObject();C.push(D);var M=o.internal.getPageInfo(d+1);o.internal.write("<< /D["+M.objId+" 0 R /XYZ null null null]>> endobj")}var S=o.internal.newObject();for(o.internal.write("<< /Names [ "),d=0;d<C.length;d++)o.internal.write("(page_"+(d+1)+")"+C[d]+" 0 R");o.internal.write(" ] >>","endobj"),r=o.internal.newObject(),o.internal.write("<< /Dests "+S+" 0 R"),o.internal.write(">>","endobj")}}]),n.events.push(["putCatalog",function(){var o=this;o.outline.root.children.length>0&&(o.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&o.internal.write("/Names "+r+" 0 R"))}]),n.events.push(["initialized",function(){var o=this;o.outline={createNamedDestinations:!1,root:{children:[]}},o.outline.add=function(s,l,d){var b={title:l,options:d,children:[]};return s==null&&(s=this.root),s.children.push(b),b},o.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=o,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},o.outline.genIds_r=function(s){s.id=o.internal.newObjectDeferred();for(var l=0;l<s.children.length;l++)this.genIds_r(s.children[l])},o.outline.renderRoot=function(s){this.objStart(s),this.line("/Type /Outlines"),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1]))),this.line("/Count "+this.count_r({count:0},s)),this.objEnd()},o.outline.renderItems=function(s){for(var l=this.ctx.pdf.internal.getVerticalCoordinateString,d=0;d<s.children.length;d++){var b=s.children[d];this.objStart(b),this.line("/Title "+this.makeString(b.title)),this.line("/Parent "+this.makeRef(s)),d>0&&this.line("/Prev "+this.makeRef(s.children[d-1])),d<s.children.length-1&&this.line("/Next "+this.makeRef(s.children[d+1])),b.children.length>0&&(this.line("/First "+this.makeRef(b.children[0])),this.line("/Last "+this.makeRef(b.children[b.children.length-1])));var p=this.count=this.count_r({count:0},b);if(p>0&&this.line("/Count "+p),b.options&&b.options.pageNumber){var v=o.internal.getPageInfo(b.options.pageNumber);this.line("/Dest ["+v.objId+" 0 R /XYZ 0 "+l(0)+" 0]")}this.objEnd()}for(var m=0;m<s.children.length;m++)this.renderItems(s.children[m])},o.outline.line=function(s){this.ctx.val+=s+`\r
`},o.outline.makeRef=function(s){return s.id+" 0 R"},o.outline.makeString=function(s){return"("+o.internal.pdfEscape(s)+")"},o.outline.objStart=function(s){this.ctx.val+=`\r
`+s.id+` 0 obj\r
<<\r
`},o.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},o.outline.count_r=function(s,l){for(var d=0;d<l.children.length;d++)s.count++,this.count_r(s,l.children[d]);return s.count}}])})(qn.API),(function(n){var r=[192,193,194,195,196,197,198,199];n.processJPEG=function(o,s,l,d,b,p){var v,m=this.decode.DCT_DECODE,C=null;if(typeof o=="string"||this.__addimage__.isArrayBuffer(o)||this.__addimage__.isArrayBufferView(o)){switch(o=b||o,o=this.__addimage__.isArrayBuffer(o)?new Uint8Array(o):o,v=(function(D){for(var M,S=256*D.charCodeAt(4)+D.charCodeAt(5),U=D.length,_={width:0,height:0,numcomponents:1},N=4;N<U;N+=2){if(N+=S,r.indexOf(D.charCodeAt(N+1))!==-1){M=256*D.charCodeAt(N+5)+D.charCodeAt(N+6),_={width:256*D.charCodeAt(N+7)+D.charCodeAt(N+8),height:M,numcomponents:D.charCodeAt(N+9)};break}S=256*D.charCodeAt(N+2)+D.charCodeAt(N+3)}return _})(o=this.__addimage__.isArrayBufferView(o)?this.__addimage__.arrayBufferToBinaryString(o):o),v.numcomponents){case 1:p=this.color_spaces.DEVICE_GRAY;break;case 4:p=this.color_spaces.DEVICE_CMYK;break;case 3:p=this.color_spaces.DEVICE_RGB}C={data:o,width:v.width,height:v.height,colorSpace:p,bitsPerComponent:8,filter:m,index:s,alias:l}}return C}})(qn.API),qn.API.processPNG=function(n,r,o,s){if(this.__addimage__.isArrayBuffer(n)&&(n=new Uint8Array(n)),this.__addimage__.isArrayBufferView(n)){var l,d=g5(n,{checkCrc:!0}),b=d.width,p=d.height,v=d.channels,m=d.palette,C=d.depth;l=m&&v===1?(function(ee){for(var F=ee.width,$=ee.height,H=ee.data,R=ee.palette,Z=ee.depth,Y=!1,we=[],te=[],de=void 0,je=!1,Ie=0,xe=0;xe<R.length;xe++){var k=E1(R[xe],4),A=k[0],q=k[1],W=k[2],se=k[3];we.push(A,q,W),se!=null&&(se===0?(Ie++,te.length<1&&te.push(xe)):se<255&&(je=!0))}if(je||Ie>1){Y=!0,te=void 0;var Ce=F*$;de=new Uint8Array(Ce);for(var le=new DataView(H.buffer),_e=0;_e<Ce;_e++){var be=Fg(le,_e,Z),De=E1(R[be],4)[3];de[_e]=De}}else Ie===0&&(te=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:Y?8:void 0,colorBytes:H,alphaBytes:de,needSMask:Y,palette:we,mask:te}})(d):v===2||v===4?(function(ee){for(var F=ee.data,$=ee.width,H=ee.height,R=ee.channels,Z=ee.depth,Y=R===2?"DeviceGray":"DeviceRGB",we=R-1,te=$*H,de=we,je=te*de,Ie=1*te,xe=Math.ceil(je*Z/8),k=Math.ceil(Ie*Z/8),A=new Uint8Array(xe),q=new Uint8Array(k),W=new DataView(F.buffer),se=new DataView(A.buffer),Ce=new DataView(q.buffer),le=!1,_e=0;_e<te;_e++){for(var be=_e*R,De=0;De<de;De++)$y(se,Fg(W,be+De,Z),_e*de+De,Z);var Ge=Fg(W,be+de,Z);Ge<(1<<Z)-1&&(le=!0),$y(Ce,Ge,1*_e,Z)}return{colorSpace:Y,colorsPerPixel:we,sMaskBitsPerComponent:le?Z:void 0,colorBytes:A,alphaBytes:q,needSMask:le}})(d):(function(ee){var F=ee.data,$=ee.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:$,colorsPerPixel:$==="DeviceGray"?1:3,colorBytes:F instanceof Uint16Array?(function(H){for(var R=H.length,Z=new Uint8Array(2*R),Y=new DataView(Z.buffer,Z.byteOffset,Z.byteLength),we=0;we<R;we++)Y.setUint16(2*we,H[we],!1);return Z})(F):F,needSMask:!1}})(d);var D,M,S,U=l,_=U.colorSpace,N=U.colorsPerPixel,g=U.sMaskBitsPerComponent,ae=U.colorBytes,V=U.alphaBytes,E=U.needSMask,re=U.palette,J=U.mask,G=null;return s!==qn.API.image_compression.NONE&&typeof Zg=="function"?(G=(function(ee){var F;switch(ee){case qn.API.image_compression.FAST:F=11;break;case qn.API.image_compression.MEDIUM:F=13;break;case qn.API.image_compression.SLOW:F=14;break;default:F=12}return F})(s),D=this.decode.FLATE_DECODE,M="/Predictor ".concat(G," /Colors ").concat(N," /BitsPerComponent ").concat(C," /Columns ").concat(b),n=Ey(ae,Math.ceil(b*N*C/8),N,C,s),E&&(S=Ey(V,Math.ceil(b*g/8),1,g,s))):(D=void 0,M=void 0,n=ae,E&&(S=V)),(this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n))&&(n=this.__addimage__.arrayBufferToBinaryString(n)),(S&&this.__addimage__.isArrayBuffer(S)||this.__addimage__.isArrayBufferView(S))&&(S=this.__addimage__.arrayBufferToBinaryString(S)),{alias:o,data:n,index:r,filter:D,decodeParameters:M,transparency:J,palette:re,sMask:S,predictor:G,width:b,height:p,bitsPerComponent:C,sMaskBitsPerComponent:g,colorSpace:_}}},(function(n){n.processGIF89A=function(r,o,s,l){var d=new M5(r),b=d.width,p=d.height,v=[];d.decodeAndBlitFrameRGBA(0,v);var m={data:v,width:b,height:p},C=new Ug(100).encode(m,100);return n.processJPEG.call(this,C,o,s,l)},n.processGIF87A=n.processGIF89A})(qn.API),zc.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var n=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(n);for(var r=0;r<n;r++){var o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),d=this.datav.getUint8(this.pos++,!0);this.palette[r]={red:l,green:s,blue:o,quad:d}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},zc.prototype.parseBGR=function(){this.pos=this.offset;try{var n="bit"+this.bitPP,r=this.width*this.height*4;this.data=new Uint8Array(r),this[n]()}catch(o){lo.log("bit decode error:"+o)}},zc.prototype.bit1=function(){var n,r=Math.ceil(this.width/8),o=r%4;for(n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,l=0;l<r;l++)for(var d=this.datav.getUint8(this.pos++,!0),b=s*this.width*4+8*l*4,p=0;p<8&&8*l+p<this.width;p++){var v=this.palette[d>>7-p&1];this.data[b+4*p]=v.blue,this.data[b+4*p+1]=v.green,this.data[b+4*p+2]=v.red,this.data[b+4*p+3]=255}o!==0&&(this.pos+=4-o)}},zc.prototype.bit4=function(){for(var n=Math.ceil(this.width/2),r=n%4,o=this.height-1;o>=0;o--){for(var s=this.bottom_up?o:this.height-1-o,l=0;l<n;l++){var d=this.datav.getUint8(this.pos++,!0),b=s*this.width*4+2*l*4,p=d>>4,v=15&d,m=this.palette[p];if(this.data[b]=m.blue,this.data[b+1]=m.green,this.data[b+2]=m.red,this.data[b+3]=255,2*l+1>=this.width)break;m=this.palette[v],this.data[b+4]=m.blue,this.data[b+4+1]=m.green,this.data[b+4+2]=m.red,this.data[b+4+3]=255}r!==0&&(this.pos+=4-r)}},zc.prototype.bit8=function(){for(var n=this.width%4,r=this.height-1;r>=0;r--){for(var o=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var l=this.datav.getUint8(this.pos++,!0),d=o*this.width*4+4*s;if(l<this.palette.length){var b=this.palette[l];this.data[d]=b.red,this.data[d+1]=b.green,this.data[d+2]=b.blue,this.data[d+3]=255}else this.data[d]=255,this.data[d+1]=255,this.data[d+2]=255,this.data[d+3]=255}n!==0&&(this.pos+=4-n)}},zc.prototype.bit15=function(){for(var n=this.width%3,r=parseInt("11111",2),o=this.height-1;o>=0;o--){for(var s=this.bottom_up?o:this.height-1-o,l=0;l<this.width;l++){var d=this.datav.getUint16(this.pos,!0);this.pos+=2;var b=(d&r)/r*255|0,p=(d>>5&r)/r*255|0,v=(d>>10&r)/r*255|0,m=d>>15?255:0,C=s*this.width*4+4*l;this.data[C]=v,this.data[C+1]=p,this.data[C+2]=b,this.data[C+3]=m}this.pos+=n}},zc.prototype.bit16=function(){for(var n=this.width%3,r=parseInt("11111",2),o=parseInt("111111",2),s=this.height-1;s>=0;s--){for(var l=this.bottom_up?s:this.height-1-s,d=0;d<this.width;d++){var b=this.datav.getUint16(this.pos,!0);this.pos+=2;var p=(b&r)/r*255|0,v=(b>>5&o)/o*255|0,m=(b>>11)/r*255|0,C=l*this.width*4+4*d;this.data[C]=m,this.data[C+1]=v,this.data[C+2]=p,this.data[C+3]=255}this.pos+=n}},zc.prototype.bit24=function(){for(var n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,o=0;o<this.width;o++){var s=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),d=this.datav.getUint8(this.pos++,!0),b=r*this.width*4+4*o;this.data[b]=d,this.data[b+1]=l,this.data[b+2]=s,this.data[b+3]=255}this.pos+=this.width%4}},zc.prototype.bit32=function(){for(var n=this.height-1;n>=0;n--)for(var r=this.bottom_up?n:this.height-1-n,o=0;o<this.width;o++){var s=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),d=this.datav.getUint8(this.pos++,!0),b=this.datav.getUint8(this.pos++,!0),p=r*this.width*4+4*o;this.data[p]=d,this.data[p+1]=l,this.data[p+2]=s,this.data[p+3]=b}},zc.prototype.getData=function(){return this.data},(function(n){n.processBMP=function(r,o,s,l){var d=new zc(r,!1),b=d.width,p=d.height,v={data:d.getData(),width:b,height:p},m=new Ug(100).encode(v,100);return n.processJPEG.call(this,m,o,s,l)}})(qn.API),Gy.prototype.getData=function(){return this.data},(function(n){n.processWEBP=function(r,o,s,l){var d=new Gy(r),b=d.width,p=d.height,v={data:d.getData(),width:b,height:p},m=new Ug(100).encode(v,100);return n.processJPEG.call(this,m,o,s,l)}})(qn.API),qn.API.processRGBA=function(n,r,o){for(var s=n.data,l=s.length,d=new Uint8Array(l/4*3),b=new Uint8Array(l/4),p=0,v=0,m=0;m<l;m+=4){var C=s[m],D=s[m+1],M=s[m+2],S=s[m+3];d[p++]=C,d[p++]=D,d[p++]=M,b[v++]=S}var U=this.__addimage__.arrayBufferToBinaryString(d);return{alpha:this.__addimage__.arrayBufferToBinaryString(b),data:U,index:r,alias:o,colorSpace:"DeviceRGB",bitsPerComponent:8,width:n.width,height:n.height}},qn.API.setLanguage=function(n){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[n]!==void 0&&(this.internal.languageSettings.languageCode=n,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},ef=qn.API,sh=ef.getCharWidthsArray=function(n,r){var o,s,l=(r=r||{}).font||this.internal.getFont(),d=r.fontSize||this.internal.getFontSize(),b=r.charSpace||this.internal.getCharSpace(),p=r.widths?r.widths:l.metadata.Unicode.widths,v=p.fof?p.fof:1,m=r.kerning?r.kerning:l.metadata.Unicode.kerning,C=m.fof?m.fof:1,D=r.doKerning!==!1,M=0,S=n.length,U=0,_=p[0]||v,N=[];for(o=0;o<S;o++)s=n.charCodeAt(o),typeof l.metadata.widthOfString=="function"?N.push((l.metadata.widthOfGlyph(l.metadata.characterToGlyph(s))+b*(1e3/d)||0)/1e3):(M=D&&qr(m[s])==="object"&&!isNaN(parseInt(m[s][U],10))?m[s][U]/C:0,N.push((p[s]||_)/v+M)),U=s;return N},Oy=ef.getStringUnitWidth=function(n,r){var o=(r=r||{}).fontSize||this.internal.getFontSize(),s=r.font||this.internal.getFont(),l=r.charSpace||this.internal.getCharSpace();return ef.processArabic&&(n=ef.processArabic(n)),typeof s.metadata.widthOfString=="function"?s.metadata.widthOfString(n,o,l)/o:sh.apply(this,arguments).reduce(function(d,b){return d+b},0)},Fy=function(n,r,o,s){for(var l=[],d=0,b=n.length,p=0;d!==b&&p+r[d]<o;)p+=r[d],d++;l.push(n.slice(0,d));var v=d;for(p=0;d!==b;)p+r[d]>s&&(l.push(n.slice(v,d)),p=0,v=d),p+=r[d],d++;return v!==d&&l.push(n.slice(v,d)),l},Uy=function(n,r,o){o||(o={});var s,l,d,b,p,v,m,C=[],D=[C],M=o.textIndent||0,S=0,U=0,_=n.split(" "),N=sh.apply(this,[" ",o])[0];if(v=o.lineIndent===-1?_[0].length+2:o.lineIndent||0){var g=Array(v).join(" "),ae=[];_.map(function(E){(E=E.split(/\s*\n/)).length>1?ae=ae.concat(E.map(function(re,J){return(J&&re.length?`
`:"")+re})):ae.push(E[0])}),_=ae,v=Oy.apply(this,[g,o])}for(d=0,b=_.length;d<b;d++){var V=0;if(s=_[d],v&&s[0]==`
`&&(s=s.substr(1),V=1),M+S+(U=(l=sh.apply(this,[s,o])).reduce(function(E,re){return E+re},0))>r||V){if(U>r){for(p=Fy.apply(this,[s,l,r-(M+S),r]),C.push(p.shift()),C=[p.pop()];p.length;)D.push([p.shift()]);U=l.slice(s.length-(C[0]?C[0].length:0)).reduce(function(E,re){return E+re},0)}else C=[s];D.push(C),M=U+v,S=N}else C.push(s),M+=S+U,S=N}return m=v?function(E,re){return(re?g:"")+E.join(" ")}:function(E){return E.join(" ")},D.map(m)},ef.splitTextToSize=function(n,r,o){var s,l=(o=o||{}).fontSize||this.internal.getFontSize(),d=(function(C){if(C.widths&&C.kerning)return{widths:C.widths,kerning:C.kerning};var D=this.internal.getFont(C.fontName,C.fontStyle),M="Unicode";return D.metadata[M]?{widths:D.metadata[M].widths||{0:1},kerning:D.metadata[M].kerning||{}}:{font:D.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,o);s=Array.isArray(n)?n:String(n).split(/\r?\n/);var b=1*this.internal.scaleFactor*r/l;d.textIndent=o.textIndent?1*o.textIndent*this.internal.scaleFactor/l:0,d.lineIndent=o.lineIndent;var p,v,m=[];for(p=0,v=s.length;p<v;p++)m=m.concat(Uy.apply(this,[s[p],b,d]));return m},(function(n){n.__fontmetrics__=n.__fontmetrics__||{};for(var r="0123456789abcdef",o="klmnopqrstuvwxyz",s={},l={},d=0;d<16;d++)s[o[d]]=r[d],l[r[d]]=o[d];var b=function(M){return"0x"+parseInt(M,10).toString(16)},p=n.__fontmetrics__.compress=function(M){var S,U,_,N,g=["{"];for(var ae in M){if(S=M[ae],isNaN(parseInt(ae,10))?U="'"+ae+"'":(ae=parseInt(ae,10),U=(U=b(ae).slice(2)).slice(0,-1)+l[U.slice(-1)]),typeof S=="number")S<0?(_=b(S).slice(3),N="-"):(_=b(S).slice(2),N=""),_=N+_.slice(0,-1)+l[_.slice(-1)];else{if(qr(S)!=="object")throw new Error("Don't know what to do with value type "+qr(S)+".");_=p(S)}g.push(U+_)}return g.push("}"),g.join("")},v=n.__fontmetrics__.uncompress=function(M){if(typeof M!="string")throw new Error("Invalid argument passed to uncompress.");for(var S,U,_,N,g={},ae=1,V=g,E=[],re="",J="",G=M.length-1,ee=1;ee<G;ee+=1)(N=M[ee])=="'"?S?(_=S.join(""),S=void 0):S=[]:S?S.push(N):N=="{"?(E.push([V,_]),V={},_=void 0):N=="}"?((U=E.pop())[0][U[1]]=V,_=void 0,V=U[0]):N=="-"?ae=-1:_===void 0?s.hasOwnProperty(N)?(re+=s[N],_=parseInt(re,16)*ae,ae=1,re=""):re+=N:s.hasOwnProperty(N)?(J+=s[N],V[_]=parseInt(J,16)*ae,ae=1,_=void 0,J=""):J+=N;return g},m={codePages:["WinAnsiEncoding"],WinAnsiEncoding:v("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},C={Unicode:{Courier:m,"Courier-Bold":m,"Courier-BoldOblique":m,"Courier-Oblique":m,Helvetica:m,"Helvetica-Bold":m,"Helvetica-BoldOblique":m,"Helvetica-Oblique":m,"Times-Roman":m,"Times-Bold":m,"Times-BoldItalic":m,"Times-Italic":m}},D={Unicode:{"Courier-Oblique":v("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":v("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":v("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:v("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":v("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":v("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:v("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:v("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":v("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:v("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":v("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":v("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":v("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":v("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};n.events.push(["addFont",function(M){var S=M.font,U=D.Unicode[S.postScriptName];U&&(S.metadata.Unicode={},S.metadata.Unicode.widths=U.widths,S.metadata.Unicode.kerning=U.kerning);var _=C.Unicode[S.postScriptName];_&&(S.metadata.Unicode.encoding=_,S.encoding=_.codePages[0])}])})(qn.API),(function(n){var r=function(o){for(var s=o.length,l=new Uint8Array(s),d=0;d<s;d++)l[d]=o.charCodeAt(d);return l};n.API.events.push(["addFont",function(o){var s=void 0,l=o.font,d=o.instance;if(!l.isStandardFont){if(d===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+l.postScriptName+"').");if(typeof(s=d.existsFileInVFS(l.postScriptName)===!1?d.loadFile(l.postScriptName):d.getFileFromVFS(l.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+l.postScriptName+"').");(function(b,p){p=/^\x00\x01\x00\x00/.test(p)?r(p):r(ch(p)),b.metadata=n.API.TTFFont.open(p),b.metadata.Unicode=b.metadata.Unicode||{encoding:{},kerning:{},widths:[]},b.metadata.glyIdsUsed=[0]})(l,s)}}])})(qn),qn.API.addSvgAsImage=function(n,r,o,s,l,d,b,p){if(isNaN(r)||isNaN(o))throw lo.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(l))throw lo.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var v=document.createElement("canvas");v.width=s,v.height=l;var m=v.getContext("2d");m.fillStyle="#fff",m.fillRect(0,0,v.width,v.height);var C={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},D=this;return(ci.canvg?Promise.resolve(ci.canvg):bg(()=>import("./index.es-DeJobhbd.js"),[])).catch(function(M){return Promise.reject(new Error("Could not load canvg: "+M))}).then(function(M){return M.default?M.default:M}).then(function(M){return M.fromString(m,n,C)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(M){return M.render(C)}).then(function(){D.addImage(v.toDataURL("image/jpeg",1),r,o,s,l,b,p)})},qn.API.putTotalPages=function(n){var r,o=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(r=new RegExp(n,"g"),o=this.internal.getNumberOfPages()):(r=new RegExp(this.pdfEscape16(n,this.internal.getFont()),"g"),o=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var s=1;s<=this.internal.getNumberOfPages();s++)for(var l=0;l<this.internal.pages[s].length;l++)this.internal.pages[s][l]=this.internal.pages[s][l].replace(r,o);return this},qn.API.viewerPreferences=function(n,r){var o;n=n||{},r=r||!1;var s,l,d,b={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},p=Object.keys(b),v=[],m=0,C=0,D=0;function M(U,_){var N,g=!1;for(N=0;N<U.length;N+=1)U[N]===_&&(g=!0);return g}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(b)),this.internal.viewerpreferences.isSubscribed=!1),o=this.internal.viewerpreferences.configuration,n==="reset"||r===!0){var S=p.length;for(D=0;D<S;D+=1)o[p[D]].value=o[p[D]].defaultValue,o[p[D]].explicitSet=!1}if(qr(n)==="object"){for(l in n)if(d=n[l],M(p,l)&&d!==void 0){if(o[l].type==="boolean"&&typeof d=="boolean")o[l].value=d;else if(o[l].type==="name"&&M(o[l].valueSet,d))o[l].value=d;else if(o[l].type==="integer"&&Number.isInteger(d))o[l].value=d;else if(o[l].type==="array"){for(m=0;m<d.length;m+=1)if(s=!0,d[m].length===1&&typeof d[m][0]=="number")v.push(String(d[m]-1));else if(d[m].length>1){for(C=0;C<d[m].length;C+=1)typeof d[m][C]!="number"&&(s=!1);s===!0&&v.push([d[m][0]-1,d[m][1]-1].join(" "))}o[l].value="["+v.join(" ")+"]"}else o[l].value=o[l].defaultValue;o[l].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var U,_=[];for(U in o)o[U].explicitSet===!0&&(o[U].type==="name"?_.push("/"+U+" /"+o[U].value):_.push("/"+U+" "+o[U].value));_.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+_.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=o,this},(function(n){var r=function(){var s='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',l=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),d=unescape(encodeURIComponent(s)),b=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),p=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),v=unescape(encodeURIComponent("</x:xmpmeta>")),m=d.length+b.length+p.length+l.length+v.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+m+" >>"),this.internal.write("stream"),this.internal.write(l+d+b+p+v),this.internal.write("endstream"),this.internal.write("endobj")},o=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};n.addMetadata=function(s,l){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:s,namespaceuri:l||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",o),this.internal.events.subscribe("postPutResources",r)),this}})(qn.API),(function(n){var r=n.API,o=r.pdfEscape16=function(d,b){for(var p,v=b.metadata.Unicode.widths,m=["","0","00","000","0000"],C=[""],D=0,M=d.length;D<M;++D){if(p=b.metadata.characterToGlyph(d.charCodeAt(D)),b.metadata.glyIdsUsed.push(p),b.metadata.toUnicode[p]=d.charCodeAt(D),v.indexOf(p)==-1&&(v.push(p),v.push([parseInt(b.metadata.widthOfGlyph(p),10)])),p=="0")return C.join("");p=p.toString(16),C.push(m[4-p.length],p)}return C.join("")},s=function(d){var b,p,v,m,C,D,M;for(C=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,v=[],D=0,M=(p=Object.keys(d).sort(function(S,U){return S-U})).length;D<M;D++)b=p[D],v.length>=100&&(C+=`
`+v.length+` beginbfchar
`+v.join(`
`)+`
endbfchar`,v=[]),d[b]!==void 0&&d[b]!==null&&typeof d[b].toString=="function"&&(m=("0000"+d[b].toString(16)).slice(-4),b=("0000"+(+b).toString(16)).slice(-4),v.push("<"+b+"><"+m+">"));return v.length&&(C+=`
`+v.length+` beginbfchar
`+v.join(`
`)+`
endbfchar
`),C+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};r.events.push(["putFont",function(d){(function(b){var p=b.font,v=b.out,m=b.newObject,C=b.putStream;if(p.metadata instanceof n.API.TTFFont&&p.encoding==="Identity-H"){for(var D=p.metadata.Unicode.widths,M=p.metadata.subset.encode(p.metadata.glyIdsUsed,1),S="",U=0;U<M.length;U++)S+=String.fromCharCode(M[U]);var _=m();C({data:S,addLength1:!0,objectId:_}),v("endobj");var N=m();C({data:s(p.metadata.toUnicode),addLength1:!0,objectId:N}),v("endobj");var g=m();v("<<"),v("/Type /FontDescriptor"),v("/FontName /"+rf(p.fontName)),v("/FontFile2 "+_+" 0 R"),v("/FontBBox "+n.API.PDFObject.convert(p.metadata.bbox)),v("/Flags "+p.metadata.flags),v("/StemV "+p.metadata.stemV),v("/ItalicAngle "+p.metadata.italicAngle),v("/Ascent "+p.metadata.ascender),v("/Descent "+p.metadata.decender),v("/CapHeight "+p.metadata.capHeight),v(">>"),v("endobj");var ae=m();v("<<"),v("/Type /Font"),v("/BaseFont /"+rf(p.fontName)),v("/FontDescriptor "+g+" 0 R"),v("/W "+n.API.PDFObject.convert(D)),v("/CIDToGIDMap /Identity"),v("/DW 1000"),v("/Subtype /CIDFontType2"),v("/CIDSystemInfo"),v("<<"),v("/Supplement 0"),v("/Registry (Adobe)"),v("/Ordering ("+p.encoding+")"),v(">>"),v(">>"),v("endobj"),p.objectNumber=m(),v("<<"),v("/Type /Font"),v("/Subtype /Type0"),v("/ToUnicode "+N+" 0 R"),v("/BaseFont /"+rf(p.fontName)),v("/Encoding /"+p.encoding),v("/DescendantFonts ["+ae+" 0 R]"),v(">>"),v("endobj"),p.isAlreadyPutted=!0}})(d)}]),r.events.push(["putFont",function(d){(function(b){var p=b.font,v=b.out,m=b.newObject,C=b.putStream;if(p.metadata instanceof n.API.TTFFont&&p.encoding==="WinAnsiEncoding"){for(var D=p.metadata.rawData,M="",S=0;S<D.length;S++)M+=String.fromCharCode(D[S]);var U=m();C({data:M,addLength1:!0,objectId:U}),v("endobj");var _=m();C({data:s(p.metadata.toUnicode),addLength1:!0,objectId:_}),v("endobj");var N=m();v("<<"),v("/Descent "+p.metadata.decender),v("/CapHeight "+p.metadata.capHeight),v("/StemV "+p.metadata.stemV),v("/Type /FontDescriptor"),v("/FontFile2 "+U+" 0 R"),v("/Flags 96"),v("/FontBBox "+n.API.PDFObject.convert(p.metadata.bbox)),v("/FontName /"+rf(p.fontName)),v("/ItalicAngle "+p.metadata.italicAngle),v("/Ascent "+p.metadata.ascender),v(">>"),v("endobj"),p.objectNumber=m();for(var g=0;g<p.metadata.hmtx.widths.length;g++)p.metadata.hmtx.widths[g]=parseInt(p.metadata.hmtx.widths[g]*(1e3/p.metadata.head.unitsPerEm));v("<</Subtype/TrueType/Type/Font/ToUnicode "+_+" 0 R/BaseFont/"+rf(p.fontName)+"/FontDescriptor "+N+" 0 R/Encoding/"+p.encoding+" /FirstChar 29 /LastChar 255 /Widths "+n.API.PDFObject.convert(p.metadata.hmtx.widths)+">>"),v("endobj"),p.isAlreadyPutted=!0}})(d)}]);var l=function(d){var b,p=d.text||"",v=d.x,m=d.y,C=d.options||{},D=d.mutex||{},M=D.pdfEscape,S=D.activeFontKey,U=D.fonts,_=S,N="",g=0,ae="",V=U[_].encoding;if(U[_].encoding!=="Identity-H")return{text:p,x:v,y:m,options:C,mutex:D};for(ae=p,_=S,Array.isArray(p)&&(ae=p[0]),g=0;g<ae.length;g+=1)U[_].metadata.hasOwnProperty("cmap")&&(b=U[_].metadata.cmap.unicode.codeMap[ae[g].charCodeAt(0)]),b||ae[g].charCodeAt(0)<256&&U[_].metadata.hasOwnProperty("Unicode")?N+=ae[g]:N+="";var E="";return parseInt(_.slice(1))<14||V==="WinAnsiEncoding"?E=M(N,_).split("").map(function(re){return re.charCodeAt(0).toString(16)}).join(""):V==="Identity-H"&&(E=o(N,U[_])),D.isHex=!0,{text:E,x:v,y:m,options:C,mutex:D}};r.events.push(["postProcessText",function(d){var b=d.text||"",p=[],v={text:b,x:d.x,y:d.y,options:d.options,mutex:d.mutex};if(Array.isArray(b)){var m=0;for(m=0;m<b.length;m+=1)Array.isArray(b[m])&&b[m].length===3?p.push([l(Object.assign({},v,{text:b[m][0]})).text,b[m][1],b[m][2]]):p.push(l(Object.assign({},v,{text:b[m]})).text);d.text=p}else d.text=l(Object.assign({},v,{text:b})).text}])})(qn),(function(n){var r=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};n.existsFileInVFS=function(o){return r.call(this),this.internal.vFS[o]!==void 0},n.addFileToVFS=function(o,s){return r.call(this),this.internal.vFS[o]=s,this},n.getFileFromVFS=function(o){return r.call(this),this.internal.vFS[o]!==void 0?this.internal.vFS[o]:null}})(qn.API),(function(n){n.__bidiEngine__=n.prototype.__bidiEngine__=function(s){var l,d,b,p,v,m,C,D=r,M=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],S=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],U={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},_={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},N=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],g=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),ae=!1,V=0;this.__bidiEngine__={};var E=function(H){var R=H.charCodeAt(),Z=R>>8,Y=_[Z];return Y!==void 0?D[256*Y+(255&R)]:Z===252||Z===253?"AL":g.test(Z)?"L":Z===8?"R":"N"},re=function(H){for(var R,Z=0;Z<H.length;Z++){if((R=E(H.charAt(Z)))==="L")return!1;if(R==="R")return!0}return!1},J=function(H,R,Z,Y){var we,te,de,je,Ie=R[Y];switch(Ie){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":ae=!1;break;case"N":case"AN":break;case"EN":ae&&(Ie="AN");break;case"AL":ae=!0,Ie="R";break;case"WS":case"BN":Ie="N";break;case"CS":Y<1||Y+1>=R.length||(we=Z[Y-1])!=="EN"&&we!=="AN"||(te=R[Y+1])!=="EN"&&te!=="AN"?Ie="N":ae&&(te="AN"),Ie=te===we?te:"N";break;case"ES":Ie=(we=Y>0?Z[Y-1]:"B")==="EN"&&Y+1<R.length&&R[Y+1]==="EN"?"EN":"N";break;case"ET":if(Y>0&&Z[Y-1]==="EN"){Ie="EN";break}if(ae){Ie="N";break}for(de=Y+1,je=R.length;de<je&&R[de]==="ET";)de++;Ie=de<je&&R[de]==="EN"?"EN":"N";break;case"NSM":if(b&&!p){for(je=R.length,de=Y+1;de<je&&R[de]==="NSM";)de++;if(de<je){var xe=H[Y],k=xe>=1425&&xe<=2303||xe===64286;if(we=R[de],k&&(we==="R"||we==="AL")){Ie="R";break}}}Ie=Y<1||(we=R[Y-1])==="B"?"N":Z[Y-1];break;case"B":ae=!1,l=!0,Ie=V;break;case"S":d=!0,Ie="N"}return Ie},G=function(H,R,Z){var Y=H.split("");return Z&&ee(Y,Z,{hiLevel:V}),Y.reverse(),R&&R.reverse(),Y.join("")},ee=function(H,R,Z){var Y,we,te,de,je,Ie=-1,xe=H.length,k=0,A=[],q=V?S:M,W=[];for(ae=!1,l=!1,d=!1,we=0;we<xe;we++)W[we]=E(H[we]);for(te=0;te<xe;te++){if(je=k,A[te]=J(H,W,A,te),Y=240&(k=q[je][U[A[te]]]),k&=15,R[te]=de=q[k][5],Y>0)if(Y===16){for(we=Ie;we<te;we++)R[we]=1;Ie=-1}else Ie=-1;if(q[k][6])Ie===-1&&(Ie=te);else if(Ie>-1){for(we=Ie;we<te;we++)R[we]=de;Ie=-1}W[te]==="B"&&(R[te]=0),Z.hiLevel|=de}d&&(function(se,Ce,le){for(var _e=0;_e<le;_e++)if(se[_e]==="S"){Ce[_e]=V;for(var be=_e-1;be>=0&&se[be]==="WS";be--)Ce[be]=V}})(W,R,xe)},F=function(H,R,Z,Y,we){if(!(we.hiLevel<H)){if(H===1&&V===1&&!l)return R.reverse(),void(Z&&Z.reverse());for(var te,de,je,Ie,xe=R.length,k=0;k<xe;){if(Y[k]>=H){for(je=k+1;je<xe&&Y[je]>=H;)je++;for(Ie=k,de=je-1;Ie<de;Ie++,de--)te=R[Ie],R[Ie]=R[de],R[de]=te,Z&&(te=Z[Ie],Z[Ie]=Z[de],Z[de]=te);k=je}k++}}},$=function(H,R,Z){var Y=H.split(""),we={hiLevel:V};return Z||(Z=[]),ee(Y,Z,we),(function(te,de,je){if(je.hiLevel!==0&&C)for(var Ie,xe=0;xe<te.length;xe++)de[xe]===1&&(Ie=N.indexOf(te[xe]))>=0&&(te[xe]=N[Ie+1])})(Y,Z,we),F(2,Y,R,Z,we),F(1,Y,R,Z,we),Y.join("")};return this.__bidiEngine__.doBidiReorder=function(H,R,Z){if((function(we,te){if(te)for(var de=0;de<we.length;de++)te[de]=de;p===void 0&&(p=re(we)),m===void 0&&(m=re(we))})(H,R),b||!v||m)if(b&&v&&p^m)V=p?1:0,H=G(H,R,Z);else if(!b&&v&&m)V=p?1:0,H=$(H,R,Z),H=G(H,R);else if(!b||p||v||m){if(b&&!v&&p^m)H=G(H,R),p?(V=0,H=$(H,R,Z)):(V=1,H=$(H,R,Z),H=G(H,R));else if(b&&p&&!v&&m)V=1,H=$(H,R,Z),H=G(H,R);else if(!b&&!v&&p^m){var Y=C;p?(V=1,H=$(H,R,Z),V=0,C=!1,H=$(H,R,Z),C=Y):(V=0,H=$(H,R,Z),H=G(H,R),V=1,C=!1,H=$(H,R,Z),C=Y,H=G(H,R))}}else V=0,H=$(H,R,Z);else V=p?1:0,H=$(H,R,Z);return H},this.__bidiEngine__.setOptions=function(H){H&&(b=H.isInputVisual,v=H.isOutputVisual,p=H.isInputRtl,m=H.isOutputRtl,C=H.isSymmetricSwapping)},this.__bidiEngine__.setOptions(s),this.__bidiEngine__};var r=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],o=new n.__bidiEngine__({isInputVisual:!0});n.API.events.push(["postProcessText",function(s){var l=s.text;s.x,s.y;var d=s.options||{};s.mutex,d.lang;var b=[];if(d.isInputVisual=typeof d.isInputVisual!="boolean"||d.isInputVisual,o.setOptions(d),Object.prototype.toString.call(l)==="[object Array]"){var p=0;for(b=[],p=0;p<l.length;p+=1)Object.prototype.toString.call(l[p])==="[object Array]"?b.push([o.doBidiReorder(l[p][0]),l[p][1],l[p][2]]):b.push([o.doBidiReorder(l[p])]);s.text=b}else s.text=o.doBidiReorder(l);o.setOptions({isInputVisual:!0})}])})(qn),qn.API.TTFFont=(function(){function n(r){var o;if(this.rawData=r,o=this.contents=new Yu(r),this.contents.pos=4,o.readString(4)==="ttcf")throw new Error("TTCF not supported.");o.pos=0,this.parse(),this.subset=new Z5(this),this.registerTTF()}return n.open=function(r){return new n(r)},n.prototype.parse=function(){return this.directory=new B5(this.contents),this.head=new F5(this),this.name=new H5(this),this.cmap=new em(this),this.toUnicode={},this.hhea=new U5(this),this.maxp=new W5(this),this.hmtx=new $5(this),this.post=new V5(this),this.os2=new E5(this),this.loca=new K5(this),this.glyf=new Y5(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},n.prototype.registerTTF=function(){var r,o,s,l,d;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var b,p,v,m;for(m=[],b=0,p=(v=this.bbox).length;b<p;b++)r=v[b],m.push(Math.round(r*this.scaleFactor));return m}).call(this),this.stemV=0,this.post.exists?(s=255&(l=this.post.italic_angle),32768&(o=l>>16)&&(o=-(1+(65535^o))),this.italicAngle=+(o+"."+s)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(d=this.familyClass)===1||d===2||d===3||d===4||d===5||d===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},n.prototype.characterToGlyph=function(r){var o;return((o=this.cmap.unicode)!=null?o.codeMap[r]:void 0)||0},n.prototype.widthOfGlyph=function(r){var o;return o=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(r).advance*o},n.prototype.widthOfString=function(r,o,s){var l,d,b,p;for(b=0,d=0,p=(r=""+r).length;0<=p?d<p:d>p;d=0<=p?++d:--d)l=r.charCodeAt(d),b+=this.widthOfGlyph(this.characterToGlyph(l))+s*(1e3/o)||0;return b*(o/1e3)},n.prototype.lineHeight=function(r,o){var s;return o==null&&(o=!1),s=o?this.lineGap:0,(this.ascender+s-this.decender)/1e3*r},n})();var Rc,Yu=(function(){function n(r){this.data=r??[],this.pos=0,this.length=this.data.length}return n.prototype.readByte=function(){return this.data[this.pos++]},n.prototype.writeByte=function(r){return this.data[this.pos++]=r},n.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},n.prototype.writeUInt32=function(r){return this.writeByte(r>>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},n.prototype.readInt32=function(){var r;return(r=this.readUInt32())>=2147483648?r-4294967296:r},n.prototype.writeInt32=function(r){return r<0&&(r+=4294967296),this.writeUInt32(r)},n.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},n.prototype.writeUInt16=function(r){return this.writeByte(r>>8&255),this.writeByte(255&r)},n.prototype.readInt16=function(){var r;return(r=this.readUInt16())>=32768?r-65536:r},n.prototype.writeInt16=function(r){return r<0&&(r+=65536),this.writeUInt16(r)},n.prototype.readString=function(r){var o,s;for(s=[],o=0;0<=r?o<r:o>r;o=0<=r?++o:--o)s[o]=String.fromCharCode(this.readByte());return s.join("")},n.prototype.writeString=function(r){var o,s,l;for(l=[],o=0,s=r.length;0<=s?o<s:o>s;o=0<=s?++o:--o)l.push(this.writeByte(r.charCodeAt(o)));return l},n.prototype.readShort=function(){return this.readInt16()},n.prototype.writeShort=function(r){return this.writeInt16(r)},n.prototype.readLongLong=function(){var r,o,s,l,d,b,p,v;return r=this.readByte(),o=this.readByte(),s=this.readByte(),l=this.readByte(),d=this.readByte(),b=this.readByte(),p=this.readByte(),v=this.readByte(),128&r?-1*(72057594037927940*(255^r)+281474976710656*(255^o)+1099511627776*(255^s)+4294967296*(255^l)+16777216*(255^d)+65536*(255^b)+256*(255^p)+(255^v)+1):72057594037927940*r+281474976710656*o+1099511627776*s+4294967296*l+16777216*d+65536*b+256*p+v},n.prototype.writeLongLong=function(r){var o,s;return o=Math.floor(r/4294967296),s=4294967295&r,this.writeByte(o>>24&255),this.writeByte(o>>16&255),this.writeByte(o>>8&255),this.writeByte(255&o),this.writeByte(s>>24&255),this.writeByte(s>>16&255),this.writeByte(s>>8&255),this.writeByte(255&s)},n.prototype.readInt=function(){return this.readInt32()},n.prototype.writeInt=function(r){return this.writeInt32(r)},n.prototype.read=function(r){var o,s;for(o=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)o.push(this.readByte());return o},n.prototype.write=function(r){var o,s,l,d;for(d=[],s=0,l=r.length;s<l;s++)o=r[s],d.push(this.writeByte(o));return d},n})(),B5=(function(){var n;function r(o){var s,l,d;for(this.scalarType=o.readInt(),this.tableCount=o.readShort(),this.searchRange=o.readShort(),this.entrySelector=o.readShort(),this.rangeShift=o.readShort(),this.tables={},l=0,d=this.tableCount;0<=d?l<d:l>d;l=0<=d?++l:--l)s={tag:o.readString(4),checksum:o.readInt(),offset:o.readInt(),length:o.readInt()},this.tables[s.tag]=s}return r.prototype.encode=function(o){var s,l,d,b,p,v,m,C,D,M,S,U,_;for(_ in S=Object.keys(o).length,v=Math.log(2),D=16*Math.floor(Math.log(S)/v),b=Math.floor(D/v),C=16*S-D,(l=new Yu).writeInt(this.scalarType),l.writeShort(S),l.writeShort(D),l.writeShort(b),l.writeShort(C),d=16*S,m=l.pos+d,p=null,U=[],o)for(M=o[_],l.writeString(_),l.writeInt(n(M)),l.writeInt(m),l.writeInt(M.length),U=U.concat(M),_==="head"&&(p=m),m+=M.length;m%4;)U.push(0),m++;return l.write(U),s=2981146554-n(l.data),l.pos=p+8,l.writeUInt32(s),l.data},n=function(o){var s,l,d,b;for(o=tm.call(o);o.length%4;)o.push(0);for(d=new Yu(o),l=0,s=0,b=o.length;s<b;s=s+=4)l+=d.readUInt32();return 4294967295&l},r})(),O5={}.hasOwnProperty,Qc=function(n,r){for(var o in r)O5.call(r,o)&&(n[o]=r[o]);function s(){this.constructor=n}return s.prototype=r.prototype,n.prototype=new s,n.__super__=r.prototype,n};Rc=(function(){function n(r){var o;this.file=r,o=this.file.directory.tables[this.tag],this.exists=!!o,o&&(this.offset=o.offset,this.length=o.length,this.parse(this.file.contents))}return n.prototype.parse=function(){},n.prototype.encode=function(){},n.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},n})();var F5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Qc(n,Rc),n.prototype.tag="head",n.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},n.prototype.encode=function(r){var o;return(o=new Yu).writeInt(this.version),o.writeInt(this.revision),o.writeInt(this.checkSumAdjustment),o.writeInt(this.magicNumber),o.writeShort(this.flags),o.writeShort(this.unitsPerEm),o.writeLongLong(this.created),o.writeLongLong(this.modified),o.writeShort(this.xMin),o.writeShort(this.yMin),o.writeShort(this.xMax),o.writeShort(this.yMax),o.writeShort(this.macStyle),o.writeShort(this.lowestRecPPEM),o.writeShort(this.fontDirectionHint),o.writeShort(r),o.writeShort(this.glyphDataFormat),o.data},n})(),Xy=(function(){function n(r,o){var s,l,d,b,p,v,m,C,D,M,S,U,_,N,g,ae,V;switch(this.platformID=r.readUInt16(),this.encodingID=r.readShort(),this.offset=o+r.readInt(),D=r.pos,r.pos=this.offset,this.format=r.readUInt16(),this.length=r.readUInt16(),this.language=r.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(v=0;v<256;++v)this.codeMap[v]=r.readByte();break;case 4:for(S=r.readUInt16(),M=S/2,r.pos+=6,d=(function(){var E,re;for(re=[],v=E=0;0<=M?E<M:E>M;v=0<=M?++E:--E)re.push(r.readUInt16());return re})(),r.pos+=2,_=(function(){var E,re;for(re=[],v=E=0;0<=M?E<M:E>M;v=0<=M?++E:--E)re.push(r.readUInt16());return re})(),m=(function(){var E,re;for(re=[],v=E=0;0<=M?E<M:E>M;v=0<=M?++E:--E)re.push(r.readUInt16());return re})(),C=(function(){var E,re;for(re=[],v=E=0;0<=M?E<M:E>M;v=0<=M?++E:--E)re.push(r.readUInt16());return re})(),l=(this.length-r.pos+this.offset)/2,p=(function(){var E,re;for(re=[],v=E=0;0<=l?E<l:E>l;v=0<=l?++E:--E)re.push(r.readUInt16());return re})(),v=g=0,V=d.length;g<V;v=++g)for(N=d[v],s=ae=U=_[v];U<=N?ae<=N:ae>=N;s=U<=N?++ae:--ae)C[v]===0?b=s+m[v]:(b=p[C[v]/2+(s-U)-(M-v)]||0)!==0&&(b+=m[v]),this.codeMap[s]=65535&b}r.pos=D}return n.encode=function(r,o){var s,l,d,b,p,v,m,C,D,M,S,U,_,N,g,ae,V,E,re,J,G,ee,F,$,H,R,Z,Y,we,te,de,je,Ie,xe,k,A,q,W,se,Ce,le,_e,be,De,Ge,ot;switch(Y=new Yu,b=Object.keys(r).sort(function(jt,Ht){return jt-Ht}),o){case"macroman":for(_=0,N=(function(){var jt=[];for(U=0;U<256;++U)jt.push(0);return jt})(),ae={0:0},d={},we=0,Ie=b.length;we<Ie;we++)ae[be=r[l=b[we]]]==null&&(ae[be]=++_),d[l]={old:r[l],new:ae[r[l]]},N[l]=ae[r[l]];return Y.writeUInt16(1),Y.writeUInt16(0),Y.writeUInt32(12),Y.writeUInt16(0),Y.writeUInt16(262),Y.writeUInt16(0),Y.write(N),{charMap:d,subtable:Y.data,maxGlyphID:_+1};case"unicode":for(R=[],D=[],V=0,ae={},s={},g=m=null,te=0,xe=b.length;te<xe;te++)ae[re=r[l=b[te]]]==null&&(ae[re]=++V),s[l]={old:re,new:ae[re]},p=ae[re]-l,g!=null&&p===m||(g&&D.push(g),R.push(l),m=p),g=l;for(g&&D.push(g),D.push(65535),R.push(65535),$=2*(F=R.length),ee=2*Math.pow(Math.log(F)/Math.LN2,2),M=Math.log(ee/2)/Math.LN2,G=2*F-ee,v=[],J=[],S=[],U=de=0,k=R.length;de<k;U=++de){if(H=R[U],C=D[U],H===65535){v.push(0),J.push(0);break}if(H-(Z=s[H].new)>=32768)for(v.push(0),J.push(2*(S.length+F-U)),l=je=H;H<=C?je<=C:je>=C;l=H<=C?++je:--je)S.push(s[l].new);else v.push(Z-H),J.push(0)}for(Y.writeUInt16(3),Y.writeUInt16(1),Y.writeUInt32(12),Y.writeUInt16(4),Y.writeUInt16(16+8*F+2*S.length),Y.writeUInt16(0),Y.writeUInt16($),Y.writeUInt16(ee),Y.writeUInt16(M),Y.writeUInt16(G),le=0,A=D.length;le<A;le++)l=D[le],Y.writeUInt16(l);for(Y.writeUInt16(0),_e=0,q=R.length;_e<q;_e++)l=R[_e],Y.writeUInt16(l);for(De=0,W=v.length;De<W;De++)p=v[De],Y.writeUInt16(p);for(Ge=0,se=J.length;Ge<se;Ge++)E=J[Ge],Y.writeUInt16(E);for(ot=0,Ce=S.length;ot<Ce;ot++)_=S[ot],Y.writeUInt16(_);return{charMap:s,subtable:Y.data,maxGlyphID:V+1}}},n})(),em=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Qc(n,Rc),n.prototype.tag="cmap",n.prototype.parse=function(r){var o,s,l;for(r.pos=this.offset,this.version=r.readUInt16(),l=r.readUInt16(),this.tables=[],this.unicode=null,s=0;0<=l?s<l:s>l;s=0<=l?++s:--s)o=new Xy(r,this.offset),this.tables.push(o),o.isUnicode&&this.unicode==null&&(this.unicode=o);return!0},n.encode=function(r,o){var s,l;return o==null&&(o="macroman"),s=Xy.encode(r,o),(l=new Yu).writeUInt16(0),l.writeUInt16(1),s.table=l.data.concat(s.subtable),s},n})(),U5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Qc(n,Rc),n.prototype.tag="hhea",n.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},n})(),E5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Qc(n,Rc),n.prototype.tag="OS/2",n.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=(function(){var o,s;for(s=[],o=0;o<10;++o)s.push(r.readByte());return s})(),this.charRange=(function(){var o,s;for(s=[],o=0;o<4;++o)s.push(r.readInt());return s})(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=(function(){var o,s;for(s=[],o=0;o<2;o=++o)s.push(r.readInt());return s})(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},n})(),V5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Qc(n,Rc),n.prototype.tag="post",n.prototype.parse=function(r){var o,s,l;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:case 196608:break;case 131072:var d;for(s=r.readUInt16(),this.glyphNameIndex=[],d=0;0<=s?d<s:d>s;d=0<=s?++d:--d)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],l=[];r.pos<this.offset+this.length;)o=r.readByte(),l.push(this.names.push(r.readString(o)));return l;case 151552:return s=r.readUInt16(),this.offsets=r.read(s);case 262144:return this.map=(function(){var b,p,v;for(v=[],d=b=0,p=this.file.maxp.numGlyphs;0<=p?b<p:b>p;d=0<=p?++b:--b)v.push(r.readUInt32());return v}).call(this)}},n})(),q5=function(n,r){this.raw=n,this.length=n.length,this.platformID=r.platformID,this.encodingID=r.encodingID,this.languageID=r.languageID},H5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Qc(n,Rc),n.prototype.tag="name",n.prototype.parse=function(r){var o,s,l,d,b,p,v,m,C,D,M;for(r.pos=this.offset,r.readShort(),o=r.readShort(),p=r.readShort(),s=[],d=0;0<=o?d<o:d>o;d=0<=o?++d:--d)s.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+p+r.readShort()});for(v={},d=C=0,D=s.length;C<D;d=++C)l=s[d],r.pos=l.offset,m=r.readString(l.length),b=new q5(m,l),v[M=l.nameID]==null&&(v[M]=[]),v[l.nameID].push(b);this.strings=v,this.copyright=v[0],this.fontFamily=v[1],this.fontSubfamily=v[2],this.uniqueSubfamily=v[3],this.fontName=v[4],this.version=v[5];try{this.postscriptName=v[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=v[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=v[7],this.manufacturer=v[8],this.designer=v[9],this.description=v[10],this.vendorUrl=v[11],this.designerUrl=v[12],this.license=v[13],this.licenseUrl=v[14],this.preferredFamily=v[15],this.preferredSubfamily=v[17],this.compatibleFull=v[18],this.sampleText=v[19]},n})(),W5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Qc(n,Rc),n.prototype.tag="maxp",n.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},n})(),$5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Qc(n,Rc),n.prototype.tag="hmtx",n.prototype.parse=function(r){var o,s,l,d,b,p,v;for(r.pos=this.offset,this.metrics=[],o=0,p=this.file.hhea.numberOfMetrics;0<=p?o<p:o>p;o=0<=p?++o:--o)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(l=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var m,C;for(C=[],o=m=0;0<=l?m<l:m>l;o=0<=l?++m:--m)C.push(r.readInt16());return C})(),this.widths=(function(){var m,C,D,M;for(M=[],m=0,C=(D=this.metrics).length;m<C;m++)d=D[m],M.push(d.advance);return M}).call(this),s=this.widths[this.widths.length-1],v=[],o=b=0;0<=l?b<l:b>l;o=0<=l?++b:--b)v.push(this.widths.push(s));return v},n.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},n})(),tm=[].slice,Y5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Qc(n,Rc),n.prototype.tag="glyf",n.prototype.parse=function(){return this.cache={}},n.prototype.glyphFor=function(r){var o,s,l,d,b,p,v,m,C,D;return r in this.cache?this.cache[r]:(d=this.file.loca,o=this.file.contents,s=d.indexOf(r),(l=d.lengthOf(r))===0?this.cache[r]=null:(o.pos=this.offset+s,b=(p=new Yu(o.read(l))).readShort(),m=p.readShort(),D=p.readShort(),v=p.readShort(),C=p.readShort(),this.cache[r]=b===-1?new X5(p,m,D,v,C):new G5(p,b,m,D,v,C),this.cache[r]))},n.prototype.encode=function(r,o,s){var l,d,b,p,v;for(b=[],d=[],p=0,v=o.length;p<v;p++)l=r[o[p]],d.push(b.length),l&&(b=b.concat(l.encode(s)));return d.push(b.length),{table:b,offsets:d}},n})(),G5=(function(){function n(r,o,s,l,d,b){this.raw=r,this.numberOfContours=o,this.xMin=s,this.yMin=l,this.xMax=d,this.yMax=b,this.compound=!1}return n.prototype.encode=function(){return this.raw.data},n})(),X5=(function(){function n(r,o,s,l,d){var b,p;for(this.raw=r,this.xMin=o,this.yMin=s,this.xMax=l,this.yMax=d,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],b=this.raw;p=b.readShort(),this.glyphOffsets.push(b.pos),this.glyphIDs.push(b.readUInt16()),32&p;)b.pos+=1&p?4:2,128&p?b.pos+=8:64&p?b.pos+=4:8&p&&(b.pos+=2)}return n.prototype.encode=function(){var r,o,s;for(o=new Yu(tm.call(this.raw.data)),r=0,s=this.glyphIDs.length;r<s;++r)o.pos=this.glyphOffsets[r];return o.data},n})(),K5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Qc(n,Rc),n.prototype.tag="loca",n.prototype.parse=function(r){var o,s;return r.pos=this.offset,o=this.file.head.indexToLocFormat,this.offsets=o===0?(function(){var l,d;for(d=[],s=0,l=this.length;s<l;s+=2)d.push(2*r.readUInt16());return d}).call(this):(function(){var l,d;for(d=[],s=0,l=this.length;s<l;s+=4)d.push(r.readUInt32());return d}).call(this)},n.prototype.indexOf=function(r){return this.offsets[r]},n.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},n.prototype.encode=function(r,o){for(var s=new Uint32Array(this.offsets.length),l=0,d=0,b=0;b<s.length;++b)if(s[b]=l,d<o.length&&o[d]==b){++d,s[b]=l;var p=this.offsets[b],v=this.offsets[b+1]-p;v>0&&(l+=v)}for(var m=new Array(4*s.length),C=0;C<s.length;++C)m[4*C+3]=255&s[C],m[4*C+2]=(65280&s[C])>>8,m[4*C+1]=(16711680&s[C])>>16,m[4*C]=(4278190080&s[C])>>24;return m},n})(),Z5=(function(){function n(r){this.font=r,this.subset={},this.unicodes={},this.next=33}return n.prototype.generateCmap=function(){var r,o,s,l,d;for(o in l=this.font.cmap.tables[0].codeMap,r={},d=this.subset)s=d[o],r[o]=l[s];return r},n.prototype.glyphsFor=function(r){var o,s,l,d,b,p,v;for(l={},b=0,p=r.length;b<p;b++)l[d=r[b]]=this.font.glyf.glyphFor(d);for(d in o=[],l)(s=l[d])!=null&&s.compound&&o.push.apply(o,s.glyphIDs);if(o.length>0)for(d in v=this.glyphsFor(o))s=v[d],l[d]=s;return l},n.prototype.encode=function(r,o){var s,l,d,b,p,v,m,C,D,M,S,U,_,N,g;for(l in s=em.encode(this.generateCmap(),"unicode"),b=this.glyphsFor(r),S={0:0},g=s.charMap)S[(v=g[l]).old]=v.new;for(U in M=s.maxGlyphID,b)U in S||(S[U]=M++);return C=(function(ae){var V,E;for(V in E={},ae)E[ae[V]]=V;return E})(S),D=Object.keys(C).sort(function(ae,V){return ae-V}),_=(function(){var ae,V,E;for(E=[],ae=0,V=D.length;ae<V;ae++)p=D[ae],E.push(C[p]);return E})(),d=this.font.glyf.encode(b,_,S),m=this.font.loca.encode(d.offsets,_),N={cmap:this.font.cmap.raw(),glyf:d.table,loca:m,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(o)},this.font.os2.exists&&(N["OS/2"]=this.font.os2.raw()),this.font.directory.encode(N)},n})();qn.API.PDFObject=(function(){var n;function r(){}return n=function(o,s){return(Array(s+1).join("0")+o).slice(-s)},r.convert=function(o){var s,l,d,b;if(Array.isArray(o))return"["+(function(){var p,v,m;for(m=[],p=0,v=o.length;p<v;p++)s=o[p],m.push(r.convert(s));return m})().join(" ")+"]";if(typeof o=="string")return"/"+o;if(o?.isString)return"("+o+")";if(o instanceof Date)return"(D:"+n(o.getUTCFullYear(),4)+n(o.getUTCMonth(),2)+n(o.getUTCDate(),2)+n(o.getUTCHours(),2)+n(o.getUTCMinutes(),2)+n(o.getUTCSeconds(),2)+"Z)";if({}.toString.call(o)==="[object Object]"){for(l in d=["<<"],o)b=o[l],d.push("/"+l+" "+r.convert(b));return d.push(">>"),d.join(`
`)}return""+o},r})();const Eg=n=>{const r=s0[n];return!r||!r.prefix||r.prefix.length<1?"?":r.prefix[0].substring(0,1).toUpperCase()},yc=(n,r,o)=>({color:r,size:o}),Ky=(n,r,o)=>{},Ho=(n,r,o,s)=>({color:o,size:s}),tf=(n,r,o,s)=>{},J5=()=>{const n=new Map,r={top:"#0072B2",bottom:"#56B4E9"},o={top:18,bottom:18},s={top:"#FFFF00",bottom:"#FFFF00"},l={top:18,bottom:18},d={top:"#AA4499",bottom:"#F781BF"},b={top:6,bottom:6},p={top:"#6A3D9A",bottom:"#9467BD"},v={top:18,bottom:18};return n.set("select",{id:"select",name:"Select",toolType:"select",icon:"",shortcut:"S",tooltip:"Select objects or groups",colorReflective:!1,settings:yc("select","#ff0000",10),layerSettings:new Map([["top",Ho("select","top","#ff0000",10)],["bottom",Ho("select","bottom","#ff0000",10)]])}),n.set("via",{id:"via",name:"Via",toolType:"draw",drawingMode:"via",icon:"",shortcut:"V",tooltip:"Place via connection",colorReflective:!0,settings:yc("via",fg,gg.DEFAULT_SIZE),layerSettings:new Map([["top",Ho("via","top",fg,gg.DEFAULT_SIZE)],["bottom",Ho("via","bottom",fg,gg.DEFAULT_SIZE)]]),defaultLayer:"top"}),n.set("pad",{id:"pad",name:"Pad",toolType:"draw",drawingMode:"pad",icon:"",shortcut:"P",tooltip:"Place pad connection",colorReflective:!0,settings:yc("pad",T2,18),layerSettings:new Map([["top",Ho("pad","top",r.top,o.top)],["bottom",Ho("pad","bottom",r.bottom,o.bottom)]]),defaultLayer:"top"}),n.set("testPoint",{id:"testPoint",name:"Test Point",toolType:"draw",drawingMode:"testPoint",icon:"",shortcut:"Y",tooltip:"Place test point",colorReflective:!0,settings:yc("testPoint","#FFFF00",18),layerSettings:new Map([["top",Ho("testPoint","top",s.top,l.top)],["bottom",Ho("testPoint","bottom",s.bottom,l.bottom)]]),defaultLayer:"top"}),n.set("trace",{id:"trace",name:"Trace",toolType:"draw",drawingMode:"trace",icon:"",shortcut:"T",tooltip:"Draw copper traces",colorReflective:!0,settings:yc("trace",w2,6),layerSettings:new Map([["top",Ho("trace","top",d.top,b.top)],["bottom",Ho("trace","bottom",d.bottom,b.bottom)]]),defaultLayer:"top"}),n.set("component",{id:"component",name:"Component",toolType:"component",icon:"",shortcut:"C",tooltip:"Place component",colorReflective:!0,settings:yc("component",S2,a0.DEFAULT_SIZE),layerSettings:new Map([["top",Ho("component","top",p.top,v.top)],["bottom",Ho("component","bottom",p.bottom,v.bottom)]]),defaultLayer:"top"}),n.set("componentConnection",{id:"componentConnection",name:"Component Connections",toolType:"componentConnection",icon:"",shortcut:"",tooltip:"Component connection lines",colorReflective:!1,settings:yc("componentConnection","#E69F00",3),layerSettings:new Map([["top",Ho("componentConnection","top","#E69F00",3)],["bottom",Ho("componentConnection","bottom","#E69F00",3)]])}),n.set("power",{id:"power",name:"Power",toolType:"power",icon:"",shortcut:"B",tooltip:"Place power node",colorReflective:!0,settings:yc("power",hg,18),layerSettings:new Map([["top",Ho("power","top",hg,18)],["bottom",Ho("power","bottom",hg,18)]]),defaultLayer:"top"}),n.set("ground",{id:"ground",name:"Ground",toolType:"ground",icon:"",shortcut:"G",tooltip:"Place ground symbol",colorReflective:!0,settings:yc("ground",pg,18),layerSettings:new Map([["top",Ho("ground","top",pg,18)],["bottom",Ho("ground","bottom",pg,18)]]),defaultLayer:"top"}),n.set("erase",{id:"erase",name:"Erase",toolType:"erase",icon:"",shortcut:"E",tooltip:"Erase objects",colorReflective:!1,settings:yc("erase","#f5a3b3",18),layerSettings:new Map([["top",Ho("erase","top","#f5a3b3",18)],["bottom",Ho("erase","bottom","#f5a3b3",18)]])}),n.set("pan",{id:"pan",name:"Move",toolType:"pan",icon:"",shortcut:"H",tooltip:"Pan the view",colorReflective:!1,settings:yc("pan","#ff0000",10),layerSettings:new Map([["top",Ho("pan","top","#ff0000",10)],["bottom",Ho("pan","bottom","#ff0000",10)]])}),n.set("magnify",{id:"magnify",name:"Zoom",toolType:"magnify",icon:"+",shortcut:"M",tooltip:"Magnify",colorReflective:!1,settings:yc("magnify","#ff0000",10),layerSettings:new Map([["top",Ho("magnify","top","#ff0000",10)],["bottom",Ho("magnify","bottom","#ff0000",10)]])}),n},Q5=({visible:n,toolRegistry:r,currentTool:o,drawingMode:s,traceToolLayer:l,padToolLayer:d,testPointToolLayer:b,componentToolLayer:p,updateToolSettings:v,updateToolLayerSettings:m,setBrushSize:C,saveToolSettings:D,saveToolLayerSettings:M,setTopTraceSize:S,setBottomTraceSize:U,setTopPadSize:_,setBottomPadSize:N,setTopTestPointSize:g,setBottomTestPointSize:ae,setTopComponentSize:V,setBottomComponentSize:E,setComponentConnectionSize:re,saveDefaultSize:J,onClose:G})=>{const[ee,F]=L.useState({}),$=[{id:"via",name:"Via",instanceId:"via"},{id:"pad",name:"Pad",layer:"top",instanceId:"padTop"},{id:"pad",name:"Pad",layer:"bottom",instanceId:"padBottom"},{id:"testPoint",name:"Test Point",layer:"top",instanceId:"testPointTop"},{id:"testPoint",name:"Test Point",layer:"bottom",instanceId:"testPointBottom"},{id:"trace",name:"Trace",layer:"top",instanceId:"traceTop"},{id:"trace",name:"Trace",layer:"bottom",instanceId:"traceBottom"},{id:"component",name:"Component",layer:"top",instanceId:"componentTop"},{id:"component",name:"Component",layer:"bottom",instanceId:"componentBottom"},{id:"componentConnection",name:"Component Connections"},{id:"power",name:"Power",instanceId:"power"},{id:"ground",name:"Ground",instanceId:"ground"},{id:"erase",name:"Erase"}];L.useEffect(()=>{if(n){const Z={};for(const Y of $){const we=Y.instanceId||Y.id;if(Y.instanceId)try{const te=On.get(Y.instanceId);Z[we]=te.size}catch{const te=r.get(Y.id);te&&(Z[we]=Y.layer?te.layerSettings.get(Y.layer)?.size??te.settings.size??10:te.settings.size??10)}else{const te=r.get(Y.id);te&&(Z[we]=te.settings.size??10)}}F(Z)}},[n]);const H=L.useCallback((Z,Y,we,te)=>{if(!r.get(Z)&&Z!=="componentConnection")return;const je=te||Z;F(xe=>({...xe,[je]:Y})),["trace","pad","testPoint","component"].includes(Z)&&we&&te?(On.setSize(te,Y),(Z==="trace"&&o==="draw"&&s==="trace"||Z==="pad"&&o==="draw"&&s==="pad"||Z==="testPoint"&&o==="draw"&&s==="testPoint"||Z==="component"&&o==="component")&&((Z==="trace"?l:Z==="pad"?d:Z==="testPoint"?b:p)||"top")===we&&C(Y)):te?(On.setSize(te,Y),(Z==="via"&&o==="draw"&&s==="via"||Z==="power"&&o==="power"||Z==="ground"&&o==="ground")&&C(Y)):(Z==="componentConnection"&&(re(Y),J("componentConnection",Y)),Z==="erase"&&o==="erase"&&C(Y))},[r,o,s,l,d,b,p,C,re,J]);if(!n)return null;const R=Array.from({length:50},(Z,Y)=>Y+1);return i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:Z=>{Z.target===Z.currentTarget&&G()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"16px",width:"fit-content",maxWidth:"400px",maxHeight:"85vh",overflowY:"auto",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:Z=>Z.stopPropagation(),children:[i.jsx("h3",{style:{margin:"0 0 12px 0",color:"#fff",fontSize:"16px",fontWeight:600},children:"Set Tool Size"}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:$.map((Z,Y)=>{if(!r.get(Z.id)&&Z.id!=="componentConnection")return null;const te=Z.layer?`${Z.name} (${Z.layer==="top"?"Top":"Bottom"})`:Z.name,de=Z.instanceId||Z.id,je=ee[de]??10;return i.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"6px 10px",background:"#1f1f24",borderRadius:4},children:[i.jsxs("label",{style:{color:"#f2f2f2",fontSize:"13px",width:"140px",flexShrink:0,marginRight:"8px"},children:[te,":"]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[i.jsx("select",{value:je,onChange:Ie=>{const xe=parseInt(Ie.target.value,10);H(Z.id,xe,Z.layer,Z.instanceId)},style:{width:"50px",padding:"4px 6px",background:"#2b2b31",border:"1px solid #3a3a44",borderRadius:4,color:"#f2f2f2",fontSize:"12px",cursor:"pointer"},children:R.map(Ie=>i.jsx("option",{value:Ie,style:{background:"#2b2b31",color:"#f2f2f2"},children:Ie},Ie))}),i.jsx("span",{style:{color:"#f2f2f2",fontSize:"12px"},children:"px"})]})]},`${Z.id}-${Z.layer||"default"}-${Y}`)})}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:i.jsx("button",{onClick:G,style:{padding:"6px 12px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:600},children:"Close"})})]})})},ew=({visible:n,toolRegistry:r,currentTool:o,drawingMode:s,traceToolLayer:l,padToolLayer:d,testPointToolLayer:b,componentToolLayer:p,updateToolSettings:v,updateToolLayerSettings:m,saveToolSettings:C,saveToolLayerSettings:D,setBrushColor:M,setTopTraceColor:S,setBottomTraceColor:U,setTopPadColor:_,setBottomPadColor:N,setTopTestPointColor:g,setBottomTestPointColor:ae,setTopComponentColor:V,setBottomComponentColor:E,setComponentConnectionColor:re,saveDefaultColor:J,colorPalette:G,onClose:ee})=>{const[F,$]=Pt.useState(null),[H,R]=Pt.useState(0);if(Pt.useEffect(()=>{const de=[];return[{id:"via"},{id:"pad",layer:"top"},{id:"pad",layer:"bottom"},{id:"testPoint",layer:"top"},{id:"testPoint",layer:"bottom"},{id:"trace",layer:"top"},{id:"trace",layer:"bottom"},{id:"component",layer:"top"},{id:"component",layer:"bottom"},{id:"power"},{id:"ground"}].forEach(({id:Ie,layer:xe})=>{try{const k=Jp(Ie,xe),A=On.subscribe(k,()=>{R(q=>q+1)});de.push(A)}catch{}}),()=>{de.forEach(Ie=>Ie())}},[]),!n)return null;const Z=["pad","testPoint","trace","component"],Y=[{id:"via",name:"Via"},{id:"pad",name:"Pad",layer:"top"},{id:"pad",name:"Pad",layer:"bottom"},{id:"testPoint",name:"Test Point",layer:"top"},{id:"testPoint",name:"Test Point",layer:"bottom"},{id:"trace",name:"Trace",layer:"top"},{id:"trace",name:"Trace",layer:"bottom"},{id:"component",name:"Component",layer:"top"},{id:"component",name:"Component",layer:"bottom"},{id:"componentConnection",name:"Component Connections"},{id:"power",name:"Power"},{id:"ground",name:"Ground"},{id:"erase",name:"Erase"}],we=(de,je,Ie)=>{if(de==="componentConnection"){re(je),J("componentConnection",je),$(null);return}if(de==="erase"){const xe=r.get(de);xe&&(v(de,{...xe.settings,color:je}),C(de,je,xe.settings.size)),$(null);return}try{let xe;Ie&&Z.includes(de)?xe=Jp(de,Ie):xe=Jp(de),On.setColor(xe,je),(de==="via"&&o==="draw"&&s==="via"||de==="trace"&&o==="draw"&&s==="trace"||de==="pad"&&o==="draw"&&s==="pad"||de==="testPoint"&&o==="draw"&&s==="testPoint"||de==="component"&&o==="component"||de==="power"&&o==="power"||de==="ground"&&o==="ground")&&(Ie&&Z.includes(de)?((de==="trace"?l:de==="pad"?d:de==="testPoint"?b:p)||"top")===Ie&&M(je):M(je))}catch(xe){console.error(`Error updating color for tool ${de}:`,xe);const k=r.get(de);k&&(Ie&&Z.includes(de)?(m(de,Ie,{...k.layerSettings.get(Ie),color:je}),D(de,Ie,je,k.layerSettings.get(Ie)?.size||k.settings.size)):(v(de,{...k.settings,color:je}),C(de,je,k.settings.size)))}$(null)},te=(de,je)=>{let Ie;try{const A=Jp(de,je);Ie=On.get(A).color}catch{const A=r.get(de);if(!A)return null;Ie=A.settings.color??"#000000"}const xe=je?`${de}-${je}`:de,k=F?.toolId===de&&F?.layer===je;return i.jsxs("div",{style:{position:"relative",display:"inline-block",zIndex:10005},children:[i.jsx("button",{className:"color-swatch-button",onClick:A=>{A.stopPropagation(),$(k?null:{toolId:de,layer:je})},style:{width:"40px",height:"24px",background:Ie,backgroundColor:Ie,backgroundImage:"none",border:"1px solid #3a3a44",borderRadius:3,cursor:"pointer",padding:0,margin:0,display:"block","--swatch-color":Ie},title:Ie},`${xe}-button-${Ie}-${H}`),k&&i.jsx("div",{onClick:A=>{A.stopPropagation()},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",padding:8,background:"#fff",border:"1px solid #ddd",borderRadius:6,boxShadow:"0 8px 18px rgba(0,0,0,0.18)",zIndex:100},children:i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(8, 22px)",gap:4},children:G.map(A=>i.jsx("div",{onClick:()=>we(de,A,je),title:A,style:{width:22,height:22,backgroundColor:A,border:A===Ie?"2px solid #333":"1px solid #ccc",cursor:"pointer"}},A))})})]},`${xe}-${Ie}-${H}`)};return i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:de=>{de.target===de.currentTarget&&(ee(),$(null))},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"16px",width:"fit-content",minWidth:"450px",maxWidth:"600px",maxHeight:"85vh",overflowY:"auto",overflowX:"visible",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:de=>de.stopPropagation(),children:[i.jsx("h3",{style:{margin:"0 0 12px 0",color:"#fff",fontSize:"16px",fontWeight:600},children:"Set Tool Color"}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:Y.map((de,je)=>{if(!r.get(de.id))return null;const xe=de.layer?`${de.name} (${de.layer==="top"?"Top":"Bottom"})`:de.name;return i.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"6px 10px",background:"#1f1f24",borderRadius:4},children:[i.jsxs("label",{style:{color:"#f2f2f2",fontSize:"13px",width:"140px",flexShrink:0,marginRight:"8px"},children:[xe,":"]}),te(de.id,de.layer)]},`${de.id}-${de.layer||"default"}-${je}`)})}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:i.jsx("button",{onClick:()=>{ee(),$(null)},style:{padding:"6px 12px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:600},children:"Close"})})]})})},tw=({openMenu:n,setOpenMenu:r,isReadOnlyMode:o,currentProjectFilePath:s,isProjectActive:l,autoSaveEnabled:d,autoSaveInterval:b,hasUnsavedChangesState:p,onNewProject:v,onOpenProject:m,onSaveProject:C,onCloseProject:D,onPrint:M,onExportBOM:S,hasUnsavedChanges:U,bomExportFormat:_,setBomExportFormat:N,netlistExportFormat:g,setNetlistExportFormat:ae,onExportNetlist:V,setNewProjectDialog:E,setAutoSaveDialog:re,onShowGeminiSettings:J,topImage:G,bottomImage:ee,setCurrentTool:F,resetImageTransform:$,areImagesLocked:H,setAreImagesLocked:R,onEnterBoardDimensions:Z,fileInputTopRef:Y,fileInputBottomRef:we,openProjectRef:te,increaseSize:de,decreaseSize:je,brushSize:Ie,drawingStrokes:xe,selectedIds:k,selectedComponentIds:A,selectedPowerIds:q,selectedGroundIds:W,componentsTop:se,componentsBottom:Ce,powers:le,grounds:_e,powerNodeNames:be,groundNodeNames:De,setSetSizeDialog:Ge,areViasLocked:ot,setAreViasLocked:jt,arePadsLocked:Ht,setArePadsLocked:ge,areTestPointsLocked:lt,setAreTestPointsLocked:Yt,areTracesLocked:Gt,setAreTracesLocked:xt,areComponentsLocked:hn,setAreComponentsLocked:Et,areGroundNodesLocked:gn,setAreGroundNodesLocked:Zt,arePowerNodesLocked:xn,setArePowerNodesLocked:tt,showTraceCornerDots:Rn,setShowTraceCornerDots:Lt,showCrosshairs:Wt,setShowCrosshairs:vn,setSelectedIds:ct,setSelectedComponentIds:ye,setSelectedPowerIds:ze,setSelectedGroundIds:Nt,selectAllVias:Ke,selectAllTraces:vt,selectAllPads:Vt,selectAllComponents:ht,selectDisconnectedComponents:Je,selectAllComponentConnections:Ft,selectAllPowerNodes:At,selectAllGroundNodes:Jt,selectPowerNodesByName:An,selectGroundNodesByName:dn,setShowPowerBusManager:ti,setShowGroundBusManager:Tr,setShowPastMachine:en,toolRegistry:zi,updateToolSettings:Mr,updateToolLayerSettings:qt,setBrushSize:Zi,setBrushColor:Ji,saveToolSettings:Cr,saveToolLayerSettings:jr,colorPalette:hi,currentTool:wt,drawingMode:Wn,traceToolLayer:mn,padToolLayer:Ot,testPointToolLayer:Dt,componentToolLayer:an,setTopTraceSize:rn,setBottomTraceSize:bn,setTopPadSize:ni,setBottomPadSize:hr,setTopTestPointSize:Di,setBottomTestPointSize:qi,setTopComponentSize:Br,setBottomComponentSize:_i,setComponentConnectionSize:ar,topTraceColor:ui,bottomTraceColor:zo,topPadColor:Hn,bottomPadColor:ys,topTestPointColor:di,bottomTestPointColor:Wo,topComponentColor:Ri,bottomComponentColor:Ds,setTopTraceColor:ts,setBottomTraceColor:ns,setTopPadColor:xs,setBottomPadColor:Or,setTopTestPointColor:Xs,setBottomTestPointColor:Nr,setTopComponentColor:Mi,setBottomComponentColor:fi,setComponentConnectionColor:gr,saveDefaultSize:is,saveDefaultColor:Xl,menuBarRef:bo,onOpenProjectNotes:co,onOpenTransformImages:Hi,onOpenTransformAll:Qo})=>{const[Kl,ha]=Pt.useState(null),yr=Pt.useRef(null),[Zl,Hr]=Pt.useState(null),ji=Pt.useRef(null),[al,Fa]=Pt.useState(!1),$o=Pt.useRef(null),[ms,za]=Pt.useState(!1),[ea,Jr]=Pt.useState(!1),xr=Tt=>{if(!l){alert("Please create a new project (File  New Project) or open an existing project (File  Open Project) before using this feature."),r(null);return}const Zn=Tt();Zn instanceof Promise&&Zn.catch(Ea=>{const ga=Ea instanceof Error?Ea.message:String(Ea);console.error("Error in requireProject action:",Ea),alert(`An error occurred:

${ga}

See console for details.`)})},bs=Tt=>{const Zn=Tt==="power"?be:De,Ea=Zn.length>0,ga=Tt==="power"?"Select Power Nodes":"Select Ground Nodes";return i.jsxs("div",{onMouseEnter:()=>{yr.current&&(clearTimeout(yr.current),yr.current=null),ha(Tt)},onMouseLeave:()=>{yr.current=window.setTimeout(()=>{ha(wn=>wn===Tt?null:wn)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[i.jsxs("div",{style:{padding:"4px 10px",fontSize:12,color:"#bbb"},children:[ga," by Name"]}),i.jsxs("button",{onClick:()=>{Tt==="power"?At():Jt(),ha(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:["All ",Tt==="power"?"Power Nodes":"Ground Nodes"]}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),Ea?Zn.map(wn=>i.jsx("button",{onClick:()=>{Tt==="power"?An(wn):dn(wn),ha(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:wn},wn)):i.jsxs("div",{style:{padding:"4px 10px",fontSize:12,color:"#bbb"},children:["No ",Tt==="power"?"power":"ground"," nodes available."]})]})},Ua=()=>i.jsxs("div",{onMouseEnter:()=>{$o.current&&(clearTimeout($o.current),$o.current=null),Fa(!0)},onMouseLeave:()=>{$o.current=window.setTimeout(()=>{Fa(!1)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:180,background:"#2b2b31",border:"1px solid #555",borderRadius:"4px",padding:"4px 0",zIndex:1001,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)"},children:[i.jsxs("button",{onClick:async()=>{if(!(o||!l)){ae("kicad"),Fa(!1),r(null);try{await V("kicad")}catch(Tt){console.error("Error exporting netlist:",Tt)}}},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 16px",color:o||!l?"#777":g==="kicad"?"#4CAF50":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer",fontWeight:g==="kicad"?"bold":"normal"},children:[g==="kicad"?" ":"","KiCad (.net)"]}),i.jsxs("button",{onClick:async()=>{if(!(o||!l)){ae("protel"),Fa(!1),r(null);try{await V("protel")}catch(Tt){console.error("Error exporting netlist:",Tt)}}},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 16px",color:o||!l?"#777":g==="protel"?"#4CAF50":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer",fontWeight:g==="protel"?"bold":"normal"},children:[g==="protel"?" ":"","Protel (.net)"]}),i.jsxs("button",{onClick:async()=>{if(!(o||!l)){ae("spice"),Fa(!1),r(null);try{await V("spice")}catch(Tt){console.error("Error exporting netlist:",Tt)}}},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 16px",color:o||!l?"#777":g==="spice"?"#4CAF50":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer",fontWeight:g==="spice"?"bold":"normal"},children:[g==="spice"?" ":"","SPICE (.cir)"]}),i.jsxs("button",{onClick:async()=>{if(!(o||!l)){ae("pads"),Fa(!1),r(null);try{await V("pads")}catch(Tt){console.error("Error exporting netlist:",Tt)}}},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 16px",color:o||!l?"#777":g==="pads"?"#4CAF50":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer",fontWeight:g==="pads"?"bold":"normal"},children:[g==="pads"?" ":"","PADS-PCB (.json)"]})]}),Ks=()=>i.jsxs("div",{onMouseEnter:()=>{ji.current&&(clearTimeout(ji.current),ji.current=null),Hr("lock")},onMouseLeave:()=>{ji.current=window.setTimeout(()=>{Hr(Tt=>Tt==="lock"?null:Tt)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[i.jsxs("label",{onClick:Tt=>{Tt.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:ot,onChange:()=>{jt(Tt=>!Tt)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Vias"})]}),i.jsxs("label",{onClick:Tt=>{Tt.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:Ht,onChange:()=>{ge(Tt=>!Tt)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Pads"})]}),i.jsxs("label",{onClick:Tt=>{Tt.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:lt,onChange:()=>{Yt(Tt=>!Tt)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Test Points"})]}),i.jsxs("label",{onClick:Tt=>{Tt.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:Gt,onChange:()=>{xt(Tt=>!Tt)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Traces"})]}),i.jsxs("label",{onClick:Tt=>{Tt.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:hn,onChange:()=>{Et(Tt=>!Tt)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Components"})]}),i.jsxs("label",{onClick:Tt=>{Tt.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:gn,onChange:()=>{Zt(Tt=>!Tt)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Ground Node"})]}),i.jsxs("label",{onClick:Tt=>{Tt.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:xn,onChange:()=>{tt(Tt=>!Tt)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Power Nodes"})]})]}),Pn=()=>i.jsxs("div",{onMouseEnter:()=>{ji.current&&(clearTimeout(ji.current),ji.current=null),Hr("select")},onMouseLeave:()=>{ji.current=window.setTimeout(()=>{Hr(Tt=>Tt==="select"?null:Tt)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[i.jsx("button",{onClick:()=>{Ke(),Hr(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Vias"}),i.jsx("button",{onClick:()=>{vt(),Hr(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Traces"}),i.jsx("button",{onClick:()=>{Vt(),Hr(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Pads"}),i.jsx("button",{onClick:()=>{const Tt=new Set(xe.filter(Zn=>Zn.type==="testPoint").map(Zn=>Zn.id));ct(Tt),ye(new Set),ze(new Set),Nt(new Set),Hr(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Test Points"}),i.jsx("button",{onClick:()=>{ht(),Hr(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Components"}),i.jsx("button",{onClick:()=>{Ft(),Hr(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Component Connections"}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onMouseEnter:()=>{yr.current&&(clearTimeout(yr.current),yr.current=null),ha("power")},onMouseLeave:()=>{yr.current=window.setTimeout(()=>{ha(Tt=>Tt==="power"?null:Tt)},200)},onClick:()=>{ha(Tt=>Tt==="power"?null:"power")},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Power Nodes "}),Kl==="power"&&bs("power")]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onMouseEnter:()=>{yr.current&&(clearTimeout(yr.current),yr.current=null),ha("ground")},onMouseLeave:()=>{yr.current=window.setTimeout(()=>{ha(Tt=>Tt==="ground"?null:Tt)},200)},onClick:()=>{ha(Tt=>Tt==="ground"?null:"ground")},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Ground Nodes "}),Kl==="ground"&&bs("ground")]}),i.jsx("button",{onClick:()=>{Je(),Hr(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Disconnected Components"})]});return i.jsxs(i.Fragment,{children:[i.jsxs("div",{ref:bo,style:{position:"relative",background:"rgba(250,250,255,0.9)",borderBottom:"1px solid #e6e6ef",padding:"6px 12px",display:"flex",gap:16,alignItems:"center",zIndex:3},children:[i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onClick:Tt=>{Tt.stopPropagation(),r(Zn=>Zn==="file"?null:"file")},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:n==="file"?"#eef3ff":"#fff",fontWeight:600,color:"#222"},children:"File "}),n==="file"&&i.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:200,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[i.jsx("button",{onClick:()=>{o||(r(null),U()?E({visible:!0}):v())},disabled:o,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o?"not-allowed":"pointer"},children:"New Project"}),i.jsx("button",{onClick:async()=>{await m(),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Open Project"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{o||xr(()=>{C(),r(null)})},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer"},children:"Save Project"}),i.jsx("button",{onClick:async()=>{!o&&l&&(await D(),r(null))},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer"},children:"Close Project"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{o||xr(()=>{re({visible:!0,interval:5}),r(null)})},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer"},children:"Auto Save"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{l&&(en(!0),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Restore from History"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{J(),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"AI Settings"}),i.jsx("button",{onClick:async()=>{if(!o){if(!l){alert("Please create a new project (File  New Project) or open an existing project (File  Open Project) before using this feature."),r(null);return}try{await S(),r(null)}catch(Tt){console.error("Error exporting BOM:",Tt)}}},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer"},children:"Export BOM"}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onMouseEnter:()=>{l&&$o.current&&(clearTimeout($o.current),$o.current=null),l&&Fa(!0)},onMouseLeave:()=>{l&&($o.current=window.setTimeout(()=>{Fa(!1)},200))},onClick:()=>{if(o||!l){l||(alert("Please create a new project (File  New Project) or open an existing project (File  Open Project) before using this feature."),r(null));return}Fa(Tt=>!Tt)},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer"},children:"Export Netlist "}),al&&l&&Ua()]}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{xr(()=>{M(),r(null)})},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Print"}),i.jsx("button",{onClick:()=>{xr(()=>{M(),r(null)})},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Printer Settings"})]})]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onClick:Tt=>{o||(Tt.stopPropagation(),r(Zn=>Zn==="transform"?null:"transform"))},disabled:o,style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:n==="transform"?"#eef3ff":"#fff",fontWeight:600,color:o?"#999":"#222",cursor:o?"not-allowed":"pointer",opacity:o?.5:1},children:"Images "}),n==="transform"&&i.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:260,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[i.jsx("button",{onClick:()=>{!o&&!H&&l&&(Y.current?.click(),r(null))},disabled:o||H||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o||H||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o||H||!l?"not-allowed":"pointer"},children:"Load Top PCB"}),i.jsx("button",{onClick:()=>{!o&&!H&&l&&(we.current?.click(),r(null))},disabled:o||H||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o||H||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o||H||!l?"not-allowed":"pointer"},children:"Load Bottom PCB"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{!H&&l&&(Z(),r(null))},disabled:H||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:H||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:H||!l?"not-allowed":"pointer"},children:"Enter PCB Dimensions"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{l&&(Hi(),r(null))},disabled:!G&&!ee||H||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:!G&&!ee||H||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:!G&&!ee||H||!l?"not-allowed":"pointer"},children:"Transform Images"}),i.jsx("button",{onClick:()=>{!H&&l&&(F("transform"),$(),r(null))},disabled:H||!G&&!ee||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:H||!G&&!ee||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:H||!G&&!ee||!l?"not-allowed":"pointer"},children:"Reset Transform"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{l&&(R(Tt=>!Tt),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:H?"Unlock Images ":"Lock Images"})]})]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onClick:Tt=>{o||(Tt.stopPropagation(),r(Zn=>Zn==="tools"?null:"tools"))},disabled:o,style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:n==="tools"?"#eef3ff":"#fff",fontWeight:600,color:o?"#999":"#222",cursor:o?"not-allowed":"pointer",opacity:o?.5:1},children:"Tools "}),n==="tools"&&i.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[i.jsx("button",{onClick:()=>{l&&(Qo(),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Change Perspective"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:Tt=>{l&&(de(Tt.shiftKey?5:1),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Increase Size (+)"}),i.jsx("button",{onClick:Tt=>{l&&(je(Tt.shiftKey?5:1),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Decrease Size (-)"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onMouseEnter:()=>{l&&ji.current&&(clearTimeout(ji.current),ji.current=null),l&&Hr("lock")},onMouseLeave:()=>{l&&(ji.current=window.setTimeout(()=>{Hr(Tt=>Tt==="lock"?null:Tt)},200))},onClick:()=>{l&&Hr(Tt=>Tt==="lock"?null:"lock")},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Lock "}),Zl==="lock"&&l&&Ks()]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onMouseEnter:()=>{l&&ji.current&&(clearTimeout(ji.current),ji.current=null),l&&Hr("select")},onMouseLeave:()=>{l&&(ji.current=window.setTimeout(()=>{Hr(Tt=>Tt==="select"?null:Tt)},200))},onClick:()=>{l&&Hr(Tt=>Tt==="select"?null:"select")},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Select "}),Zl==="select"&&l&&Pn()]}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{l&&(co(),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Open Project Notes"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{l&&(za(!0),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Set Tool Sizes"}),i.jsx("button",{onClick:()=>{l&&(Jr(!0),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Set Tool Colors"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{l&&(ti(!0),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Manage Power Buses"}),i.jsx("button",{onClick:()=>{l&&(Tr(!0),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Manage Ground Buses"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsxs("button",{onClick:()=>{l&&(Lt(!Rn),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:[Rn?" ":"   ","Show Trace Corner Dots"]}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsxs("button",{onClick:()=>{l&&(vn(!Wt),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:[Wt?" ":"   ","Show X-Y Axis Crosshairs"]})]})]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onClick:Tt=>{Tt.stopPropagation(),r(Zn=>Zn==="about"?null:"about")},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:n==="about"?"#eef3ff":"#fff",fontWeight:600,color:"#222"},children:"About "}),n==="about"&&i.jsx("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:500,maxWidth:700,maxHeight:"80vh",background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:20,overflowY:"auto",zIndex:100},children:i.jsxs("div",{style:{marginBottom:16},children:[i.jsx("h2",{style:{margin:"0 0 16px 0",color:"#f2f2f2",fontSize:"20px",fontWeight:700},children:"PCBTracer (v3.1)"}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"About"}),i.jsx("p",{style:{margin:"0 0 12px 0",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:"A specialized tool useful for both reverse engineering and troubleshooting printed circuit boards (PCBs) by tracing and documenting circuit connections from photographs. This application supports typical 2 to 4 layer PCBs and enables comprehensive PCB analysis and documentation."}),i.jsx("p",{style:{margin:"0 0 12px 0",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:"This tool can assist in troubleshooting by tracing circuits, holding contextual notes, comparing test results, and documenting findings during the debugging process."})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Technologies"}),i.jsxs("p",{style:{margin:"0 0 12px 0",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:["Built with ",i.jsx("strong",{children:"TypeScript"})," and ",i.jsx("strong",{children:"React"}),", with ",i.jsx("strong",{children:"AI integration"})," for intelligent extraction of electronic component information from datasheets. The application runs entirely client-side in the browser, providing a responsive, interactive drawing experience with no backend server requirements."]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Features"}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Via/Pad Placement"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsxs("li",{children:["Alt/Option+click the Via or Pad tool, or press ",i.jsx("code",{children:"Alt/Option+V"})," or ",i.jsx("code",{children:"Alt/Option+P"})," to open the placement dialog"]}),i.jsx("li",{children:"Place multiple vias or pads in Linear, 2-Sided, or 4-Sided arrangements"}),i.jsx("li",{children:"Automatic counter-clockwise numbering starting from Pin 1"}),i.jsx("li",{children:"Supports chip orientations of 0, 90, 180, or 270"}),i.jsx("li",{children:"Click and drag to define the placement area"}),i.jsx("li",{children:"Tool automatically returns to Select tool after placement"})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Tools & Shortcuts"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px 16px",fontSize:"13px",color:"#f2f2f2"},children:[i.jsx("div",{children:i.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Select"}),"  ",i.jsx("code",{children:"S"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Via"}),"  ",i.jsx("code",{children:"V"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Pad"}),"  ",i.jsx("code",{children:"P"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Test Point"}),"  ",i.jsx("code",{children:"Y"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Trace"}),"  ",i.jsx("code",{children:"T"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Component"}),"  ",i.jsx("code",{children:"C"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Component Properties"}),"  double-click component"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Resize Icons"}),"  ",i.jsx("code",{children:"+"})," / ",i.jsx("code",{children:"-"})," (",i.jsx("code",{children:"Shift"})," + ",i.jsx("code",{children:"+"})," / ",i.jsx("code",{children:"-"})," = 5x faster)"]})]})}),i.jsx("div",{children:i.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Power"}),"  ",i.jsx("code",{children:"B"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Ground"}),"  ",i.jsx("code",{children:"G"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Move (Pan)"}),"  ",i.jsx("code",{children:"H"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Magnify"}),"  ",i.jsx("code",{children:"M"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Set View"}),"  ",i.jsx("code",{children:"X"})," then ",i.jsx("code",{children:"0-9"})," to save view"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Recall View"}),"  ",i.jsx("code",{children:"0-9"})," to recall saved view"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Default View 0"}),"  ",i.jsx("code",{children:"0"})," to recall default view (origin with all images contained)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Information Dialog"}),"  ",i.jsx("code",{children:"I"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Notes Dialog"}),"  ",i.jsx("code",{children:"N"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Project Notes / TODO"}),"  ",i.jsx("code",{children:"L"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Undo"}),"  ",i.jsx("code",{children:"Ctrl"})," + ",i.jsx("code",{children:"Z"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Copy Component"}),"  ",i.jsx("code",{children:"Ctrl"})," + ",i.jsx("code",{children:"C"})," / ",i.jsx("code",{children:"Cmd"})," + ",i.jsx("code",{children:"C"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Paste Component"}),"  ",i.jsx("code",{children:"Ctrl"})," + ",i.jsx("code",{children:"V"})," / ",i.jsx("code",{children:"Cmd"})," + ",i.jsx("code",{children:"V"})]})]})})]}),i.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#f2f2f2"},children:[i.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#f2f2f2"},children:"Arrow Keys"}),i.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Move Selected Components"}),"  Arrow keys to nudge selected components (1 unit per press, ",i.jsx("code",{children:"Shift"})," = 10 units)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Switch Perspective"}),"  ",i.jsx("code",{children:"Shift"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," or ",i.jsx("code",{children:"Caps Lock"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," to switch between top/bottom view"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Rotate Perspective"}),"  ",i.jsx("code",{children:"Shift"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," or ",i.jsx("code",{children:"Caps Lock"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," to rotate in 90 increments (",i.jsx("code",{children:""})," = counter-clockwise, ",i.jsx("code",{children:""})," = clockwise)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Image Transformations"}),"  Arrow keys for scaling, rotating, and adjusting image transformations (when image is selected for transform)"]}),i.jsx("li",{children:"Click a slider first, then use arrow keys for precise adjustment"})]})]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px 20px"},children:[i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Image Management"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Load top and bottom PCB images"}),i.jsx("li",{children:"Image alignment and transformation"}),i.jsx("li",{children:"Transform modes: nudge, scale, rotate, slant, keystone"}),i.jsx("li",{children:"Horizontal and vertical flip controls"}),i.jsx("li",{children:"Brightness and contrast controls"}),i.jsx("li",{children:"Grayscale mode"}),i.jsx("li",{children:"Automated transparency slider"}),i.jsx("li",{children:"Board dimensions configuration"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Drawing Tools"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Draw copper traces (top and bottom layers)"}),i.jsx("li",{children:"Place vias for layer connections"}),i.jsx("li",{children:"Place component pads (SMD and through-hole)"}),i.jsx("li",{children:"Place test points for circuit testing"}),i.jsx("li",{children:"Place and annotate components"}),i.jsx("li",{children:"Place power and ground nodes"}),i.jsx("li",{children:"Erase tool for removing elements"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Layer Management"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"14 independent layers to manage PCB element types"}),i.jsx("li",{children:"Separate top and bottom layer support"}),i.jsx("li",{children:"Layer-specific color customization"}),i.jsx("li",{children:"Layer-specific size controls"}),i.jsx("li",{children:"Layer visibility toggles"}),i.jsx("li",{children:"Overlay view mode"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Component Management"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Component placement with pin counts"}),i.jsx("li",{children:"Pin connection tracking"}),i.jsx("li",{children:"Component type classification"}),i.jsx("li",{children:"Designator and value annotation"}),i.jsx("li",{children:"Component editor dialog"}),i.jsx("li",{children:"Find and center component"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Selection & Locking"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Select individual elements or groups"}),i.jsx("li",{children:"Select all vias, traces, pads, or components"}),i.jsx("li",{children:"Select power/ground nodes by name"}),i.jsx("li",{children:"Select disconnected components"}),i.jsx("li",{children:"Lock/unlock elements by type"}),i.jsx("li",{children:"Image locking for protection"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Power & Ground"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Multiple voltage power nodes"}),i.jsx("li",{children:"Power bus management"}),i.jsx("li",{children:"Ground node placement"}),i.jsx("li",{children:"Ground bus management"}),i.jsx("li",{children:"Node naming and organization"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Customization"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Customizable colors per layer"}),i.jsx("li",{children:"Adjustable brush/tool sizes"}),i.jsx("li",{children:"Size presets for common tools"}),i.jsx("li",{children:"Color palette management"}),i.jsx("li",{children:"Tool settings persistence"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Project Management"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Create, open, and save projects"}),i.jsx("li",{children:"Auto-save with configurable intervals"}),i.jsx("li",{children:"File history automatically saved in history subdirectory when Auto Save is enabled"}),i.jsx("li",{children:"Project Notes / TODO list with spreadsheet-like editing"}),i.jsx("li",{children:"Project file format (JSON)"}),i.jsx("li",{children:"Print functionality"}),i.jsx("li",{children:"Export to KiCad schematic format (future feature, not yet implemented)"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"View Controls"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Zoom in/out with mouse wheel"}),i.jsx("li",{children:"Pan view with hand tool"}),i.jsx("li",{children:"Zoom to fit"}),i.jsx("li",{children:"View mode switching (top/bottom/overlay)"}),i.jsx("li",{children:"Save up to 10 view locations (X + 0-9)"}),i.jsx("li",{children:"Recall saved views instantly (0-9 keys)"}),i.jsxs("li",{children:["Default View 0: Press ",i.jsx("code",{children:"0"})," to recall the default view showing the origin with all loaded images fully contained within the canvas"]}),i.jsx("li",{children:"Change Perspective (Tools menu) - switch between top/bottom view and rotate all elements"}),i.jsx("li",{children:"Detailed information dialog"})]})]})]})]}),i.jsx("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #444"},children:i.jsxs("p",{style:{margin:"0 0 8px 0",color:"#bbb",fontSize:"12px",lineHeight:"1.5"},children:["Use the ",i.jsx("strong",{children:"File"})," menu to manage projects, the ",i.jsx("strong",{children:"Images"})," menu for image loading and transformation, and the ",i.jsx("strong",{children:"Tools"})," menu for selection, locking, and customization options."]})}),i.jsxs("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #444"},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Future / TODO List"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"A searchable list of common components"}),i.jsx("li",{children:"Output schematics (perhaps as KiCad files)"}),i.jsx("li",{children:"Dynamic layers"}),i.jsx("li",{children:"Create a desktop version of this application using Electron"})]})]})]})})]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onClick:Tt=>{Tt.stopPropagation(),r(Zn=>Zn==="help"?null:"help")},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:n==="help"?"#eef3ff":"#fff",fontWeight:600,color:"#222"},children:"Help "}),n==="help"&&i.jsx("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:500,maxWidth:700,maxHeight:"80vh",background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:20,overflowY:"auto",zIndex:100},children:i.jsxs("div",{style:{marginBottom:16},children:[i.jsx("h2",{style:{margin:"0 0 16px 0",color:"#f2f2f2",fontSize:"20px",fontWeight:700},children:"Help: Typical Usage Steps"}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 1: Create or Open a Project"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"New Project:"})," File  New Project. Choose a project name and location."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Open Project:"})," File  Open Project. Select an existing project file (.json)."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Auto-Save:"})," File  Auto Save  Enable to automatically save your work at regular intervals."]})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 2: Load PCB Images"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Load Top Image:"})," Images  Load Top Image. Select your top-side PCB photo (.png or .jpeg)."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Load Bottom Image:"})," Images  Load Bottom Image. Select your bottom-side PCB photo."]}),i.jsxs("li",{children:["Images are automatically copied to the ",i.jsx("code",{style:{background:"#1f1f24",padding:"2px 4px",borderRadius:3,color:"#fff"},children:"images/"})," subdirectory."]})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 3: Align and Transform Images"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Enter Transform Mode:"})," Images  Transform Images. Select which image (Top or Bottom) to transform."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Transform Operations:"})," Use Move, Nudge, Scale, Rotate, Slant, or Keystone to align images."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Image Adjustments:"})," Adjust brightness, contrast, sharpness, and grayscale as needed."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Flip Images:"})," Use horizontal or vertical flip if your images are mirrored."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Arrow Keys:"})," When transform tool is active, use arrow keys for precise image adjustments."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Move Components:"})," Select components, then use arrow keys to move them (1 unit per press, ",i.jsx("code",{children:"Shift"})," = 10 units for larger steps)."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Change Perspective:"})," Tools  Change Perspective (or press ",i.jsx("code",{children:"E"}),") to switch between top/bottom view or rotate all elements (images, components, traces) together by 90, 180, or 270."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Quick Perspective Switch:"})," Press ",i.jsx("code",{children:"Shift"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," or ",i.jsx("code",{children:"Caps Lock"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," to quickly switch between top/bottom view."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Quick Perspective Rotation:"})," Press ",i.jsx("code",{children:"Shift"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," or ",i.jsx("code",{children:"Caps Lock"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," to rotate perspective in 90 increments (",i.jsx("code",{children:""})," = counter-clockwise, ",i.jsx("code",{children:""})," = clockwise)."]})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 4: Set Board Dimensions"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Enter Dimensions:"})," Images  Enter Board Dimensions. Specify the actual physical dimensions of your PCB."]}),i.jsx("li",{children:"This helps ensure accurate measurements and scaling for your reverse engineering work."})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 5: Trace Connections"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Place Vias:"})," Click the Via tool (",i.jsx("code",{children:"V"}),") and click on the PCB where vias connect layers."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Place Pads:"})," Click the Pad tool (",i.jsx("code",{children:"P"}),") and mark component pad locations."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Place Multiple Vias/Pads:"})," Alt/Option+click the Via or Pad tool, or press ",i.jsx("code",{children:"Alt/Option+V"})," (vias) or ",i.jsx("code",{children:"Alt/Option+P"})," (pads) to open the placement dialog. Choose arrangement (Linear, 2-Sided, or 4-Sided), number of pins, orientation, and layer. Click and drag on the canvas to define the placement area. Vias/pads are automatically arranged in counter-clockwise order starting from Pin 1."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Place Test Points:"})," Click the Test Point tool (",i.jsx("code",{children:"Y"}),") to mark test points."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Draw Traces:"})," Click the Trace tool (",i.jsx("code",{children:"T"}),"), select Top or Bottom layer, then click to start a trace. Click again to add segments. Press ",i.jsx("code",{children:"Enter"})," or click outside to finish."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Snapping:"})," Traces automatically snap to nearby vias, pads, power nodes, and ground nodes."]})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 6: Place Components"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Place Component:"})," Click the Component tool (",i.jsx("code",{children:"C"}),"), select component type, then click on the PCB."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Edit Component:"})," Double-click a component or select a component and press ",i.jsx("code",{children:"A"})," to open the Component Properties dialog. If multiple components are selected, opens the most recently selected one."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Set Properties:"})," Enter designator (e.g., R1, C2), value, and other component details."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Connect Pins:"})," Click on pads or vias to connect component pins to the circuit."]})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 7: Add Power and Ground Nodes"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Manage Power Buses:"})," Tools  Manage Power Buses to create and configure voltage buses (e.g., +5V, +3.3V)."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Place Power Nodes:"})," Click the Power tool (",i.jsx("code",{children:"B"}),"), select a voltage bus, then click on the PCB."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Manage Ground Buses:"})," Tools  Manage Ground Buses to configure ground connections."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Place Ground Nodes:"})," Click the Ground tool (",i.jsx("code",{children:"G"}),"), select a ground bus, then click on the PCB."]})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 8: Add Notes and Documentation"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Element Notes:"})," Press ",i.jsx("code",{children:"N"})," to open the Notes dialog for selected elements (vias, pads, traces, etc.)."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Project Notes:"})," Press ",i.jsx("code",{children:"L"})," to open Project Notes / TODO list for general project documentation."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Information Dialog:"})," Press ",i.jsx("code",{children:"I"})," to see detailed information about selected elements."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Find Elements:"})," Use the Find button in the Information dialog to center and highlight specific elements."]})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 9: Save Your Work"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Manual Save:"})," File  Save Project to save your work manually."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Auto-Save:"})," If enabled, your project is automatically saved at regular intervals."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"History:"})," Auto-saved versions are stored in the ",i.jsx("code",{style:{background:"#1f1f24",padding:"2px 4px",borderRadius:3,color:"#fff"},children:"history/"})," subdirectory."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Restore from History:"})," File  Restore from History to access previous versions."]})]})]}),i.jsxs("div",{style:{marginBottom:20,paddingTop:16,borderTop:"1px solid #444"},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Keyboard Shortcuts"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px 16px",fontSize:"13px",color:"#f2f2f2"},children:[i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#f2f2f2"},children:"Drawing Tools"}),i.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Select"}),"  ",i.jsx("code",{children:"S"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Via"}),"  ",i.jsx("code",{children:"V"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Via Pattern"}),"  ",i.jsx("code",{children:"Alt/Option+V"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Pad"}),"  ",i.jsx("code",{children:"P"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Pad Pattern"}),"  ",i.jsx("code",{children:"Alt/Option+P"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Test Point"}),"  ",i.jsx("code",{children:"Y"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Trace"}),"  ",i.jsx("code",{children:"T"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Component"}),"  ",i.jsx("code",{children:"C"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Component Properties"}),"  ",i.jsx("code",{children:"A"})," (opens dialog for selected component)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Power"}),"  ",i.jsx("code",{children:"B"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Ground"}),"  ",i.jsx("code",{children:"G"})]})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#f2f2f2"},children:"View & Navigation"}),i.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Move (Pan)"}),"  ",i.jsx("code",{children:"H"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Magnify"}),"  ",i.jsx("code",{children:"M"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Set View"}),"  ",i.jsx("code",{children:"X"})," then ",i.jsx("code",{children:"0-9"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Recall View"}),"  ",i.jsx("code",{children:"0-9"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Default View 0"}),"  ",i.jsx("code",{children:"0"})," (origin with all images contained)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Default View 0"}),"  ",i.jsx("code",{children:"0"})," (origin with all images contained)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Information"}),"  ",i.jsx("code",{children:"I"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Notes"}),"  ",i.jsx("code",{children:"N"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Project Notes"}),"  ",i.jsx("code",{children:"L"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Undo"}),"  ",i.jsx("code",{children:"Ctrl+Z"})," / ",i.jsx("code",{children:"Cmd+Z"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Copy Component"}),"  ",i.jsx("code",{children:"Ctrl+C"})," / ",i.jsx("code",{children:"Cmd+C"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Paste Component"}),"  ",i.jsx("code",{children:"Ctrl+V"})," / ",i.jsx("code",{children:"Cmd+V"})]})]})]})]}),i.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#f2f2f2"},children:[i.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#f2f2f2"},children:"Arrow Keys"}),i.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Move Selected Components"}),"  Arrow keys to nudge selected components (1 unit per press, ",i.jsx("code",{children:"Shift"})," = 10 units)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Switch Perspective"}),"  ",i.jsx("code",{children:"Shift"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," or ",i.jsx("code",{children:"Caps Lock"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Rotate Perspective"}),"  ",i.jsx("code",{children:"Shift"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," or ",i.jsx("code",{children:"Caps Lock"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," (",i.jsx("code",{children:""})," = counter-clockwise, ",i.jsx("code",{children:""})," = clockwise)"]}),i.jsx("li",{children:"Use arrow keys to adjust image transformations (when transform tool is active)"}),i.jsx("li",{children:"Click a slider first, then use arrow keys for precise adjustment"})]})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Tips & Tricks"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Double-click any slider to reset it to the default value"}),i.jsx("li",{children:"Double-click a component to edit its properties"}),i.jsxs("li",{children:["Hold ",i.jsx("code",{children:"Shift"})," while clicking to add to selection"]}),i.jsxs("li",{children:["Use the Information dialog (",i.jsx("code",{children:"I"}),") to see details about selected elements"]}),i.jsx("li",{children:"Lock layers (Tools  Lock) to prevent accidental modifications"}),i.jsx("li",{children:"Use the Find button in the Information dialog to center elements in view"}),i.jsxs("li",{children:["Save views with ",i.jsx("code",{children:"X"})," + number key for quick navigation"]}),i.jsxs("li",{children:["Use ",i.jsx("code",{children:"+"})," and ",i.jsx("code",{children:"-"})," keys to resize tool icons (",i.jsx("code",{children:"Shift"})," + ",i.jsx("code",{children:"+"})," / ",i.jsx("code",{children:"-"})," changes size 5 times faster)"]})]})]}),i.jsx("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #444"},children:i.jsxs("p",{style:{margin:"0 0 8px 0",color:"#bbb",fontSize:"12px",lineHeight:"1.5"},children:["For more detailed feature information, see the ",i.jsx("strong",{children:"About"})," menu."]})})]})})]}),s&&i.jsxs("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:"8px",paddingLeft:"16px"},children:[i.jsx("div",{style:{fontSize:"12px",color:"#333",fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"40vw"},title:s,children:s}),i.jsx("div",{style:{width:"16px",height:"16px",borderRadius:"50%",border:"1px solid #666",backgroundColor:p?d?"#ffaa00":"#ff0000":"#00ff00",flexShrink:0},title:p?d?`Changes detected  Auto Save: ON  Will be saved automatically every ${b||1} minute${b===1?"":"s"}`:"Changes detected  Auto Save: OFF  You need to save manually (File  Save Project)":"Project saved  No unsaved changes  Auto Save: "+(d?"ON":"OFF")})]})]}),i.jsx(Q5,{visible:ms,toolRegistry:zi,currentTool:wt,drawingMode:Wn,traceToolLayer:mn,padToolLayer:Ot,testPointToolLayer:Dt,componentToolLayer:an,updateToolSettings:Mr,updateToolLayerSettings:qt,setBrushSize:Zi,saveToolSettings:Cr,saveToolLayerSettings:jr,setTopTraceSize:rn,setBottomTraceSize:bn,setTopPadSize:ni,setBottomPadSize:hr,setTopTestPointSize:Di,setBottomTestPointSize:qi,setTopComponentSize:Br,setBottomComponentSize:_i,setComponentConnectionSize:ar,saveDefaultSize:is,onClose:()=>za(!1)}),i.jsx(ew,{visible:ea,toolRegistry:zi,currentTool:wt,drawingMode:Wn,traceToolLayer:mn,padToolLayer:Ot,testPointToolLayer:Dt,componentToolLayer:an,updateToolSettings:Mr,updateToolLayerSettings:qt,saveToolSettings:Cr,saveToolLayerSettings:jr,setBrushColor:Ji,setTopTraceColor:ts,setBottomTraceColor:ns,setTopPadColor:xs,setBottomPadColor:Or,setTopTestPointColor:Xs,setBottomTestPointColor:Nr,setTopComponentColor:Mi,setBottomComponentColor:fi,setComponentConnectionColor:gr,saveDefaultColor:Xl,colorPalette:hi,onClose:()=>Jr(!1)})]})},nw=({visible:n,canvasSize:r={width:960,height:600},canvasPosition:o={left:244,top:6},onDismiss:s})=>{const l=L.useRef(null),d=L.useRef(null),[b,p]=L.useState(!0),v=L.useCallback(()=>{l.current&&(l.current.pause(),l.current.src="",l.current.load()),p(!1),s&&s()},[s]);return L.useEffect(()=>{n&&p(!0)},[n]),L.useEffect(()=>{if(!n)return;const m=()=>{v()};return document.addEventListener("click",m,{once:!0}),document.addEventListener("mousedown",m,{once:!0}),()=>{document.removeEventListener("click",m),document.removeEventListener("mousedown",m)}},[n,v]),L.useEffect(()=>{n&&b&&l.current?l.current.play().catch(m=>{console.warn("Video autoplay failed:",m)}):(!n||!b)&&l.current&&l.current&&(l.current.pause(),l.current.src="",l.current.load())},[n,b]),n?i.jsxs("div",{ref:d,onClick:v,style:{position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"#ffffff",pointerEvents:"auto",zIndex:10},children:[b&&i.jsx("video",{ref:l,src:"/PCB_Reverse_Engineering_Tool/SplashLoop.mp4",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,style:{position:"absolute",left:`${o.left}px`,top:`${o.top}px`,width:`${r.width}px`,height:`${r.height}px`,objectFit:"cover",pointerEvents:"none",zIndex:1}}),i.jsxs("div",{onClick:v,style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",padding:"24px 32px",background:"#ffffff",borderRadius:8,border:"2px solid #4CAF50",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",maxWidth:"500px",pointerEvents:"auto",zIndex:2,cursor:"pointer"},children:[i.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"#000",marginBottom:"12px"},children:"PCB Tracer: An Electronics Tool"}),i.jsxs("div",{style:{fontSize:"16px",fontWeight:600,color:"#000",marginBottom:"16px",lineHeight:"1.5"},children:["Reverse Engineer, Troubleshoot, Trace Signals,",i.jsx("br",{}),"Document Tests, Aid Repairs"]}),i.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"8px",lineHeight:"1.5",textAlign:"left"},children:"1) Use the File menu to start a new project."}),i.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"8px",lineHeight:"1.5",textAlign:"left"},children:"2) Use the Images menu to load images."}),i.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"12px",lineHeight:"1.5",textAlign:"left"},children:"3) Use the tools to draw vias, traces, components, etc."}),i.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"16px",textAlign:"center",fontStyle:"italic",fontWeight:"bold"},children:"Best viewed in browser's full screen mode."})]})]}):null},nm=({visible:n,title:r,message:o,onClose:s})=>n?i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:l=>{l.target===l.currentTarget&&s()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"2px solid #ff4444"},onClick:l=>l.stopPropagation(),children:[i.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",gap:"12px"},children:[i.jsx("div",{style:{fontSize:"24px",color:"#ff4444"},children:""}),i.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:r})]}),i.jsx("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"14px",lineHeight:"1.5"},children:o}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:i.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"OK"})})]})}):null,iw=({visible:n,selectedIds:r,selectedComponentIds:o,selectedPowerIds:s,selectedGroundIds:l,drawingStrokes:d,componentsTop:b,componentsBottom:p,powers:v,grounds:m,powerBuses:C,onClose:D,setComponentsTop:M,setComponentsBottom:S,determineViaType:U,determinePadType:_,determineTestPointType:N,onFindComponent:g,onFindStroke:ae,onFindPower:V,onFindGround:E,position:re,isDragging:J,onDragStart:G,onOpenNotesDialog:ee})=>{const[F,$]=L.useState({visible:!1,title:"",message:""}),[H,R]=L.useState(()=>{const xe=localStorage.getItem("detailedInfoDialogSize");if(xe)try{return JSON.parse(xe)}catch{return{width:400,height:window.innerHeight*.8}}return{width:400,height:window.innerHeight*.8}}),[Z,Y]=L.useState(!1),[we,te]=L.useState({x:0,y:0,width:0,height:0});L.useEffect(()=>{if(!Z)return;const xe=A=>{const q=A.clientX-we.x,W=A.clientY-we.y,se=Math.max(300,Math.min(window.innerWidth-20,we.width+q)),Ce=Math.max(200,Math.min(window.innerHeight-20,we.height+W)),le={width:se,height:Ce};R(le),localStorage.setItem("detailedInfoDialogSize",JSON.stringify(le))},k=()=>{Y(!1)};return document.addEventListener("mousemove",xe),document.addEventListener("mouseup",k),()=>{document.removeEventListener("mousemove",xe),document.removeEventListener("mouseup",k)}},[Z,we]);const de=xe=>{xe.preventDefault(),xe.stopPropagation(),Y(!0),te({x:xe.clientX,y:xe.clientY,width:H.width,height:H.height})};if(!n)return null;const je=re?{position:"fixed",left:`${re.x}px`,top:`${re.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"300px",width:`${H.width}px`,height:`${H.height}px`,maxHeight:`${window.innerHeight-20}px`,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:J?"grabbing":"default"}:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"flex-start",justifyContent:"flex-end",paddingRight:"20px",paddingTop:"80px",zIndex:1e4,pointerEvents:"none"},Ie={padding:"20px",overflow:"auto",flex:1};return i.jsxs("div",{style:je,children:[i.jsxs("div",{style:{position:"relative",width:"100%",height:"100%",display:"flex",flexDirection:"column",...re?{}:{backgroundColor:"#fff",borderRadius:8,minWidth:"300px",width:`${H.width}px`,height:`${H.height}px`,maxHeight:`${window.innerHeight-20}px`,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",pointerEvents:"auto"}},children:[i.jsxs("div",{onMouseDown:xe=>{const k=xe.target;k.tagName==="BUTTON"||k.closest("button")||re&&G(xe)},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:J?"grabbing":re?"grab":"default",userSelect:"none",flexShrink:0},children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Information (I)"}),i.jsx("button",{onClick:D,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsx("div",{style:Ie,children:i.jsxs("div",{style:{margin:0,padding:0,backgroundColor:"#f5f5f5",borderRadius:4,fontSize:"12px",fontFamily:"monospace",maxHeight:"calc(80vh - 100px)",overflow:"auto",color:"#000"},children:[(()=>{const xe=d.filter(se=>r.has(se.id)).length,k=[...b,...p].filter(se=>o.has(se.id)).length,A=v.filter(se=>s.has(se.id)).length,q=m.filter(se=>l.has(se.id)).length,W=xe+k+A+q;return i.jsx("div",{style:{padding:"12px 16px",backgroundColor:W>0?"#e8e8e8":"#fff3cd",borderBottom:"2px solid #ccc",fontSize:"13px",fontWeight:600,color:W>0?"#333":"#856404",marginBottom:"8px"},children:W>0?`${W} Object${W!==1?"s":""} Selected`:"Zero Objects Selected"})})(),o.size>0&&(()=>{const xe=d.some(k=>r.has(k.id)&&(k.type==="via"||k.type==="pad"));return[...b,...p].filter(k=>o.has(k.id)).map(k=>{const A=$l(k),q=A?.fields,W=q&&q.length>0?i.jsx("div",{style:{marginTop:"6px",marginBottom:"6px",padding:"4px 0"},children:q.map(se=>{const Ce=k[se.name];if(Ce==null||Ce==="")return null;const le=k[`${se.name}Unit`],_e=typeof Ce=="boolean"?Ce?"Yes":"No":Ce;return i.jsxs("div",{style:{fontSize:"11px",color:"#444",marginBottom:"2px"},children:[se.label,": ",_e,le?` ${le}`:""]},se.name)})}):i.jsx("div",{style:{padding:"6px 0",fontSize:"11px",color:"#856404",background:"#fff3cd",border:"1px solid #ffeeba",borderRadius:4,marginTop:"6px",marginBottom:"6px"},children:"Component definition missing for this instance. Please ensure componentDefinitions.json entry and componentDefinitionKey are set."});return i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",flexDirection:"column",gap:"4px",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Category:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:A?.category||"N/A"})]})}),i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:A?.displayName?k.componentType==="Capacitor"&&!A.displayName.toLowerCase().includes("capacitor")?`${A.displayName} Capacitor`:A.displayName:k.componentType==="GenericComponent"&&k.genericType?Yl(k.genericType):k.componentType==="Diode"&&k.diodeType&&k.diodeType!=="Standard"?Yl(k.diodeType):k.componentType==="VariableResistor"&&k.vrType&&k.vrType!=="Potentiometer"?Yl(k.vrType):k.componentType==="Capacitor"&&k.dielectric==="Tantalum"?"Tantalum Capacitor":k.componentType==="Capacitor"&&k.capacitorType==="Electrolytic"?"Electrolytic Capacitor":k.componentType==="Capacitor"&&k.capacitorType==="Film"?"Film Capacitor":Yl(k.componentType)})]}),g&&i.jsx("button",{onClick:()=>{g(k.id,k.x,k.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:se=>{se.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:se=>{se.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[W,i.jsxs("div",{children:["Layer: ",k.layer]}),k.componentType==="IntegratedCircuit"&&i.jsxs(i.Fragment,{children:[k.description&&i.jsxs("div",{children:["Description: ",k.description]}),k.icType&&i.jsxs("div",{children:["IC Type: ",k.icType]})]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:k.notes||"",readOnly:!0,onClick:ee,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsxs("span",{children:["Designator: ",k.designator||"(empty)"]}),xe&&i.jsx("button",{onClick:()=>{const se=[...b,...p].filter(lt=>o.has(lt.id)&&lt.componentType===k.componentType),Ce=se.length,le=d.filter(lt=>r.has(lt.id)&&lt.type==="pad"&&lt.points.length>0&&lt.points[0].id!==void 0).map(lt=>{const Yt=lt.points[0].id;if(Yt===void 0)throw new Error("Unexpected undefined id");return{stroke:lt,nodeId:Yt}}).sort((lt,Yt)=>lt.nodeId-Yt.nodeId),_e=le.length>0?le:d.filter(lt=>r.has(lt.id)&&lt.type==="via"&&lt.points.length>0&&lt.points[0].id!==void 0).map(lt=>{const Yt=lt.points[0].id;if(Yt===void 0)throw new Error("Unexpected undefined id");return{stroke:lt,nodeId:Yt}}).sort((lt,Yt)=>lt.nodeId-Yt.nodeId),be=_e.length;if(be===0){console.warn("No vias or pads with Node IDs found in selection");return}const De=Math.floor(be/Ce);if(De===0){console.warn(`Not enough ${le.length>0?"pads":"vias"} (${be}) for ${Ce} components`);return}const Ge=$l(se[0]);if(Ge?.fixedPinCount!==!1){const lt=se[0]?.pinCount??Ge?.defaultPins??De;if(se.every(Gt=>(Gt.pinCount??Ge?.defaultPins)===lt)||console.warn("Selected components have different pin counts"),De!==lt){const Gt=le.length>0?"pads":"vias";console.warn(`Cannot change pin count for ${k.componentType}. Expected ${lt} ${Gt} per component, but got ${De}. This component has a fixed pin count.`),$({visible:!0,title:"Cannot Connect Components",message:`${k.componentType} has a fixed pin count of ${lt}. Please select exactly ${lt*Ce} ${Gt} (${lt} per component).`});return}}const jt=[...se].sort((lt,Yt)=>lt.id.localeCompare(Yt.id)),Ht=d.filter(lt=>r.has(lt.id)&&(lt.type==="via"||lt.type==="pad"));jt.forEach((lt,Yt)=>{const Gt=Yt*De,xt=Gt+De,Et=_e.slice(Gt,xt).map(Zt=>Zt.nodeId.toString()),gn=Wg(lt,Et,Ht);lt.layer==="top"?M(Zt=>Zt.map(xn=>{if(xn.id===lt.id){const tt={...xn,pinCount:De,pinConnections:Et};if(gn&&(tt.pinPolarities=gn),xn.pinNames){const Rn=xn.pinNames||[];tt.pinNames=new Array(De).fill("").map((Lt,Wt)=>Wt<Rn.length?Rn[Wt]:"")}return tt}return xn})):S(Zt=>Zt.map(xn=>{if(xn.id===lt.id){const tt={...xn,pinCount:De,pinConnections:Et};if(gn&&(tt.pinPolarities=gn),xn.pinNames){const Rn=xn.pinNames||[];tt.pinNames=new Array(De).fill("").map((Lt,Wt)=>Wt<Rn.length?Rn[Wt]:"")}return tt}return xn}))});const ge=le.length>0?"pads":"vias";console.log(`Connected ${Ce} components of type ${k.componentType} to ${be} ${ge} (${De} pins each)`)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap"},onMouseEnter:se=>{se.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:se=>{se.currentTarget.style.backgroundColor="#4CAF50"},children:"Connect"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:k.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:k.color})]}),i.jsxs("div",{children:["Size: ",k.size]}),i.jsxs("div",{children:["Pin Count: ",k.pinCount]}),k.componentType==="Resistor"&&i.jsxs(i.Fragment,{children:[k.resistance&&i.jsxs("div",{children:["Resistance: ",k.resistance]}),k.power&&i.jsxs("div",{children:["Power: ",k.power]}),k.tolerance&&i.jsxs("div",{children:["Tolerance: ",k.tolerance]})]}),k.componentType==="Capacitor"&&i.jsxs(i.Fragment,{children:[k.capacitance&&i.jsxs("div",{children:["Capacitance: ",k.capacitance]}),k.voltage&&i.jsxs("div",{children:["Voltage: ",k.voltage]}),k.dielectric&&i.jsxs("div",{children:["Dielectric: ",k.dielectric]}),k.tolerance&&i.jsxs("div",{children:["Tolerance: ",k.tolerance]})]}),k.componentType==="Electrolytic Capacitor"&&i.jsxs(i.Fragment,{children:[k.capacitance&&i.jsxs("div",{children:["Capacitance: ",k.capacitance]}),k.voltage&&i.jsxs("div",{children:["Voltage: ",k.voltage]}),k.tolerance&&i.jsxs("div",{children:["Tolerance: ",k.tolerance]}),k.polarized!==void 0&&i.jsxs("div",{children:["Polarized: ",k.polarized?"Yes":"No"]}),k.esr&&i.jsxs("div",{children:["ESR: ",k.esr]}),k.temperature&&i.jsxs("div",{children:["Temperature: ",k.temperature]})]}),k.pinConnections&&k.pinConnections.length>0&&(()=>{const se=ip(k),Ce=$l(k),le=k?.pinNames,_e=Ce?.properties?.pinNames,De=_e&&_e.length>0;return i.jsxs("div",{style:{marginTop:"8px",marginBottom:"8px"},children:[i.jsx("div",{style:{marginBottom:"4px",fontWeight:600},children:"Pin Connections:"}),i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px",border:"1px solid #ddd"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Pin #"}),De&&i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Pin Name"}),se&&i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Polarity"}),i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Node ID"})]})}),i.jsx("tbody",{children:k.pinConnections.map((Ge,ot)=>{const jt=k.pinPolarities&&k.pinPolarities.length>ot?k.pinPolarities[ot]:"",Ht=le&&ot<le.length?le[ot]:"",ge=_e&&ot<_e.length?_e[ot]:"",lt=ge==="CHIP_DEPENDENT",Yt=Ht&&Ht.trim()!==""?Ht:lt?"":ge;return i.jsxs("tr",{style:{backgroundColor:ot%2===0?"#fff":"#f9f9f9"},children:[i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:ot+1}),De&&i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd",fontSize:"9px",fontStyle:"italic",color:"#555"},children:Yt||"-"}),se&&i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd",textAlign:"center",fontFamily:"monospace",fontWeight:600,color:jt==="+"?"#d32f2f":jt==="-"?"#1976d2":"#999"},children:jt||"-"}),i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:Ge||"(not connected)"})]},ot)})})]})]})})(),"manufacturer"in k&&k.manufacturer&&i.jsxs("div",{children:["Manufacturer: ",k.manufacturer]}),"partNumber"in k&&k.partNumber&&i.jsxs("div",{children:["Part Number: ",k.partNumber]}),k.componentType==="Diode"&&i.jsxs(i.Fragment,{children:[k.diodeType&&i.jsxs("div",{children:["Type: ",k.diodeType]}),k.voltage&&i.jsxs("div",{children:["Voltage: ",k.voltage]}),k.current&&i.jsxs("div",{children:["Current: ",k.current]}),k.ledColor&&i.jsxs("div",{children:["LED Color: ",k.ledColor]})]}),k.componentType==="Battery"&&i.jsxs(i.Fragment,{children:[k.voltage&&i.jsxs("div",{children:["Voltage: ",k.voltage]}),k.capacity&&i.jsxs("div",{children:["Capacity: ",k.capacity]}),k.chemistry&&i.jsxs("div",{children:["Chemistry: ",k.chemistry]})]}),k.componentType==="Fuse"&&i.jsxs(i.Fragment,{children:[k.current&&i.jsxs("div",{children:["Current: ",k.current]}),k.voltage&&i.jsxs("div",{children:["Voltage: ",k.voltage]}),k.fuseType&&i.jsxs("div",{children:["Type: ",k.fuseType]})]}),k.componentType==="FerriteBead"&&i.jsxs(i.Fragment,{children:[k.impedance&&i.jsxs("div",{children:["Impedance: ",k.impedance]}),k.current&&i.jsxs("div",{children:["Current: ",k.current]})]}),k.componentType==="Connector"&&i.jsxs(i.Fragment,{children:[k.connectorType&&i.jsxs("div",{children:["Type: ",k.connectorType]}),k.gender&&i.jsxs("div",{children:["Gender: ",k.gender]})]}),k.componentType==="Jumper"&&i.jsx(i.Fragment,{children:k.positions&&i.jsxs("div",{children:["Positions: ",k.positions]})}),k.componentType==="Relay"&&i.jsxs(i.Fragment,{children:[k.coilVoltage&&i.jsxs("div",{children:["Coil Voltage: ",k.coilVoltage]}),k.contactType&&i.jsxs("div",{children:["Contact Type: ",k.contactType]}),k.current&&i.jsxs("div",{children:["Current: ",k.current]})]}),k.componentType==="Inductor"&&i.jsxs(i.Fragment,{children:[k.inductance&&i.jsxs("div",{children:["Inductance: ",k.inductance]}),k.current&&i.jsxs("div",{children:["Current: ",k.current]}),k.resistance&&i.jsxs("div",{children:["DC Resistance: ",k.resistance]})]}),k.componentType==="Speaker"&&i.jsxs(i.Fragment,{children:[k.impedance&&i.jsxs("div",{children:["Impedance: ",k.impedance]}),k.power&&i.jsxs("div",{children:["Power: ",k.power]})]}),k.componentType==="Motor"&&i.jsxs(i.Fragment,{children:[k.motorType&&i.jsxs("div",{children:["Type: ",k.motorType]}),k.voltage&&i.jsxs("div",{children:["Voltage: ",k.voltage]}),k.current&&i.jsxs("div",{children:["Current: ",k.current]})]}),k.componentType==="PowerSupply"&&i.jsxs(i.Fragment,{children:[k.inputVoltage&&i.jsxs("div",{children:["Input Voltage: ",k.inputVoltage]}),k.outputVoltage&&i.jsxs("div",{children:["Output Voltage: ",k.outputVoltage]}),k.current&&i.jsxs("div",{children:["Current: ",k.current]})]}),k.componentType==="Transistor"&&i.jsxs(i.Fragment,{children:[k.transistorType&&i.jsxs("div",{children:["Type: ",k.transistorType]}),k.polarized!==void 0&&i.jsxs("div",{children:["Polarized: ",k.polarized?"Yes":"No"]}),k.voltage&&i.jsxs("div",{children:["Voltage: ",k.voltage]}),k.current&&i.jsxs("div",{children:["Current: ",k.current]})]}),k.componentType==="ResistorNetwork"&&i.jsxs(i.Fragment,{children:[k.resistance&&i.jsxs("div",{children:["Resistance: ",k.resistance]}),k.configuration&&i.jsxs("div",{children:["Configuration: ",k.configuration]})]}),k.componentType==="Thermistor"&&i.jsxs(i.Fragment,{children:[k.resistance&&i.jsxs("div",{children:["Resistance: ",k.resistance]}),k.thermistorType&&i.jsxs("div",{children:["Type: ",k.thermistorType]}),k.beta&&i.jsxs("div",{children:["Beta: ",k.beta]})]}),k.componentType==="Switch"&&i.jsxs(i.Fragment,{children:[k.switchType&&i.jsxs("div",{children:["Type: ",k.switchType]}),k.current&&i.jsxs("div",{children:["Current: ",k.current]}),k.voltage&&i.jsxs("div",{children:["Voltage: ",k.voltage]})]}),k.componentType==="Transformer"&&i.jsxs(i.Fragment,{children:[k.primaryVoltage&&i.jsxs("div",{children:["Primary Voltage: ",k.primaryVoltage]}),k.secondaryVoltage&&i.jsxs("div",{children:["Secondary Voltage: ",k.secondaryVoltage]}),k.power&&i.jsxs("div",{children:["Power: ",k.power]}),k.turns&&i.jsxs("div",{children:["Turns Ratio: ",k.turns]})]}),k.componentType==="TestPoint"&&i.jsx(i.Fragment,{children:k.signal&&i.jsxs("div",{children:["Signal: ",k.signal]})}),k.componentType==="IntegratedCircuit"&&i.jsxs(i.Fragment,{children:[k.datasheet&&(()=>{const se=k.datasheet.trim(),Ce=se.match(/^https?:\/\//)?se:`https://${se}`;return i.jsxs("div",{children:["Datasheet URL:"," ",i.jsx("a",{href:Ce,target:"_blank",rel:"noopener noreferrer",style:{color:"#0066cc",textDecoration:"underline"},children:se})]})})(),k.datasheetFileName&&(()=>{const Ce=k.datasheetFileName.split("/").pop();return i.jsxs("div",{children:["Datasheet File:"," ",i.jsxs("span",{style:{color:"#666",fontStyle:"italic"},title:"Re-choose the datasheet file in Component Properties to open it",children:[Ce," (re-choose file to open)"]})]})})()]}),k.componentType==="VacuumTube"&&i.jsx(i.Fragment,{children:k.tubeType&&i.jsxs("div",{children:["Type: ",k.tubeType]})}),k.componentType==="VariableResistor"&&i.jsxs(i.Fragment,{children:[k.vrType&&i.jsxs("div",{children:["Type: ",k.vrType]}),k.resistance&&i.jsxs("div",{children:["Resistance: ",k.resistance]}),k.power&&i.jsxs("div",{children:["Power: ",k.power]}),k.taper&&i.jsxs("div",{children:["Taper: ",k.taper]})]}),k.componentType==="Crystal"&&i.jsxs(i.Fragment,{children:[k.frequency&&i.jsxs("div",{children:["Frequency: ",k.frequency]}),k.loadCapacitance&&i.jsxs("div",{children:["Load Capacitance: ",k.loadCapacitance]}),k.tolerance&&i.jsxs("div",{children:["Tolerance: ",k.tolerance]})]}),k.componentType==="GenericComponent"&&i.jsxs(i.Fragment,{children:[k.genericType&&i.jsxs("div",{children:["Type: ",k.genericType]}),k.voltage&&i.jsxs("div",{children:["Voltage: ",k.voltage," ",k.voltageUnit||"V"]}),k.current&&i.jsxs("div",{children:["Current: ",k.current," ",k.currentUnit||"A"]}),k.power&&i.jsxs("div",{children:["Power: ",k.power]}),k.frequency&&i.jsxs("div",{children:["Frequency: ",k.frequency]}),k.model&&i.jsxs("div",{children:["Model: ",k.model]})]}),i.jsx("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid #eee",fontSize:"10px",color:"#999"},children:i.jsxs("div",{children:["Position: x=",k.x.toFixed(2),", y=",k.y.toFixed(2)]})})]})]},k.id)})})(),r.size>0&&d.filter(xe=>r.has(xe.id)&&xe.type==="via"&&xe.points.length>0).map(xe=>{const k=xe.points[0],A=xe.viaType||(k.id!==void 0?U(k.id,C):"Via");return i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:A})]}),ae&&i.jsx("button",{onClick:()=>{ae(xe.id,k.x,k.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:q=>{q.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:q=>{q.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[k.id&&i.jsxs("div",{children:["Node ID: ",k.id]}),i.jsx("div",{children:"Layer: Top and Bottom"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:xe.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:xe.color})]}),i.jsxs("div",{children:["Size: ",xe.size]}),i.jsxs("div",{children:["Position: x=",k.x.toFixed(2),", y=",k.y.toFixed(2)]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:xe.notes||"",readOnly:!0,onClick:ee,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},xe.id)}),r.size>0&&d.filter(xe=>r.has(xe.id)&&xe.type==="pad"&&xe.points.length>0).map(xe=>{const k=xe.points[0],A=xe.padType||(k.id!==void 0?_(k.id,C):"Pad");return i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:A})]}),ae&&i.jsx("button",{onClick:()=>{ae(xe.id,k.x,k.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:q=>{q.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:q=>{q.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[k.id&&i.jsxs("div",{children:["Node ID: ",k.id]}),i.jsxs("div",{children:["Layer: ",xe.layer]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:xe.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:xe.color})]}),i.jsxs("div",{children:["Size: ",xe.size]}),i.jsxs("div",{children:["Position: x=",k.x.toFixed(2),", y=",k.y.toFixed(2)]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:xe.notes||"",readOnly:!0,onClick:ee,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},xe.id)}),r.size>0&&d.filter(xe=>r.has(xe.id)&&xe.type==="testPoint"&&xe.points.length>0).map(xe=>{const k=xe.points[0],A=k.id!==void 0?N(k.id,C):"Test Point";return i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:A})]}),ae&&i.jsx("button",{onClick:()=>{ae(xe.id,k.x,k.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:q=>{q.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:q=>{q.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[k.id&&i.jsxs("div",{children:["Node ID: ",k.id]}),i.jsxs("div",{children:["Layer: ",xe.layer]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:xe.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:xe.color})]}),i.jsxs("div",{children:["Size: ",xe.size]}),i.jsxs("div",{children:["Position: x=",k.x.toFixed(2),", y=",k.y.toFixed(2)]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:xe.notes||"",readOnly:!0,onClick:ee,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},xe.id)}),r.size>0&&d.filter(xe=>r.has(xe.id)&&xe.type==="trace").map(xe=>{const k=xe.points.length>0?xe.points.reduce((q,W)=>q+W.x,0)/xe.points.length:0,A=xe.points.length>0?xe.points.reduce((q,W)=>q+W.y,0)/xe.points.length:0;return i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:xe.type||"unknown"})]}),ae&&xe.points.length>0&&i.jsx("button",{onClick:()=>{ae(xe.id,k,A)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:q=>{q.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:q=>{q.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[xe.points.length>0&&i.jsxs("div",{style:{marginTop:"8px",marginBottom:"8px"},children:[i.jsxs("div",{style:{marginBottom:"4px",fontWeight:600},children:["Points: ",xe.points.length]}),i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px",border:"1px solid #ddd"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Point #"}),i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"x"}),i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"y"}),i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Node ID"})]})}),i.jsx("tbody",{children:xe.points.map((q,W)=>i.jsxs("tr",{style:{backgroundColor:W%2===0?"#fff":"#f9f9f9"},children:[i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:W}),i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:q.x.toFixed(2)}),i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:q.y.toFixed(2)}),i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:q.id||"(none)"})]},W))})]})]}),i.jsxs("div",{style:{marginTop:"4px"},children:["Layer: ",xe.layer]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:xe.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:xe.color})]}),i.jsxs("div",{children:["Size: ",xe.size]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:xe.notes||"",readOnly:!0,onClick:ee,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},xe.id)}),s.size>0&&v.filter(xe=>s.has(xe.id)).map(xe=>{const k=C.find(A=>A.id===xe.powerBusId);return i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:xe.type||(k?`${k.name} Power Node`:"Power Node")})]}),V&&i.jsx("button",{onClick:()=>{V(xe.id,xe.x,xe.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:A=>{A.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:A=>{A.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[i.jsxs("div",{children:["Node ID: ",xe.pointId||"(not assigned)"]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:xe.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:xe.color})]}),i.jsxs("div",{children:["Size: ",xe.size]}),i.jsxs("div",{children:["Layer: ",xe.layer]}),i.jsxs("div",{children:["Power Bus: ",k?.name||xe.powerBusId||"(unknown)"]}),i.jsxs("div",{children:["Position: x=",xe.x.toFixed(2),", y=",xe.y.toFixed(2)]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:xe.notes||"",readOnly:!0,onClick:ee,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},xe.id)}),l.size>0&&m.filter(xe=>l.has(xe.id)).map(xe=>i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:xe.type||"Ground Node"})]}),E&&i.jsx("button",{onClick:()=>{E(xe.id,xe.x,xe.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:k=>{k.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:k=>{k.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[i.jsxs("div",{children:["Node ID: ",xe.pointId||"(not assigned)"]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:xe.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:xe.color})]}),i.jsxs("div",{children:["Size: ",xe.size]}),i.jsxs("div",{children:["Position: x=",xe.x.toFixed(2),", y=",xe.y.toFixed(2)]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:xe.notes||"",readOnly:!0,onClick:ee,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},xe.id))]})}),i.jsx("div",{onMouseDown:de,style:{position:"absolute",bottom:0,right:0,width:"20px",height:"20px",cursor:"nwse-resize",background:"linear-gradient(135deg, transparent 0%, transparent 40%, #ccc 40%, #ccc 45%, transparent 45%, transparent 55%, #ccc 55%, #ccc 60%, transparent 60%)",zIndex:10001},title:"Drag to resize"})]}),i.jsx(nm,{visible:F.visible,title:F.title,message:F.message,onClose:()=>$({visible:!1,title:"",message:""})})]})},Jo=500,rw=({visible:n,selectedIds:r,selectedComponentIds:o,selectedPowerIds:s,selectedGroundIds:l,drawingStrokes:d,componentsTop:b,componentsBottom:p,powers:v,grounds:m,powerBuses:C,onClose:D,setComponentsTop:M,setComponentsBottom:S,setDrawingStrokes:U,setPowerSymbols:_,setGroundSymbols:N,determineViaType:g,determinePadType:ae,determineTestPointType:V,position:E,isDragging:re,onDragStart:J})=>{const[G,ee]=L.useState(new Map),F=L.useRef(""),[$,H]=L.useState(()=>{const le=localStorage.getItem("notesDialogSize");if(le)try{return JSON.parse(le)}catch{return{width:400,height:window.innerHeight*.8}}return{width:400,height:window.innerHeight*.8}}),[R,Z]=L.useState(!1),[Y,we]=L.useState({x:0,y:0,width:0,height:0}),te=()=>[...Array.from(r).sort(),...Array.from(o).sort(),...Array.from(s).sort(),...Array.from(l).sort()].join(",");L.useEffect(()=>{if(!n)return;const le=te();le!==F.current&&(F.current=le,ee(_e=>{const be=new Map;return[...b,...p].filter(De=>o.has(De.id)).forEach(De=>{const Ge=_e.get(De.id);be.set(De.id,Ge!==void 0?Ge:De.notes||"")}),d.filter(De=>r.has(De.id)).forEach(De=>{const Ge=_e.get(De.id);be.set(De.id,Ge!==void 0?Ge:De.notes||"")}),v.filter(De=>s.has(De.id)).forEach(De=>{const Ge=_e.get(De.id);be.set(De.id,Ge!==void 0?Ge:De.notes||"")}),m.filter(De=>l.has(De.id)).forEach(De=>{const Ge=_e.get(De.id);be.set(De.id,Ge!==void 0?Ge:De.notes||"")}),be}))},[n,r,o,s,l,d,b,p,v,m]),L.useEffect(()=>{if(!R)return;const le=be=>{const De=be.clientX-Y.x,Ge=be.clientY-Y.y,ot=Math.max(300,Math.min(window.innerWidth-20,Y.width+De)),jt=Math.max(200,Math.min(window.innerHeight-20,Y.height+Ge)),Ht={width:ot,height:jt};H(Ht),localStorage.setItem("notesDialogSize",JSON.stringify(Ht))},_e=()=>{Z(!1)};return document.addEventListener("mousemove",le),document.addEventListener("mouseup",_e),()=>{document.removeEventListener("mousemove",le),document.removeEventListener("mouseup",_e)}},[R,Y]);const de=le=>{le.preventDefault(),le.stopPropagation(),Z(!0),we({x:le.clientX,y:le.clientY,width:$.width,height:$.height})};if(!n)return null;const je=E?{position:"fixed",left:`${E.x}px`,top:`${E.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"300px",width:`${$.width}px`,height:`${$.height}px`,maxHeight:`${window.innerHeight-20}px`,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:re?"grabbing":"default"}:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"flex-start",justifyContent:"flex-end",paddingRight:"20px",paddingTop:"80px",zIndex:1e4,pointerEvents:"none"},Ie={padding:"20px",overflow:"auto",flex:1},xe=d.filter(le=>r.has(le.id)).length,k=[...b,...p].filter(le=>o.has(le.id)).length,A=v.filter(le=>s.has(le.id)).length,q=m.filter(le=>l.has(le.id)).length,W=xe+k+A+q,se=(le,_e)=>{const be=_e.length>Jo?_e.substring(0,Jo):_e;ee(De=>{const Ge=new Map(De);return Ge.set(le,be),Ge})},Ce=()=>{M(le=>le.map(_e=>{if(o.has(_e.id)&&G.has(_e.id)){const be=G.get(_e.id)||"";return{..._e,notes:be.trim()===""?void 0:be.trim()}}return _e})),S(le=>le.map(_e=>{if(o.has(_e.id)&&G.has(_e.id)){const be=G.get(_e.id)||"";return{..._e,notes:be.trim()===""?void 0:be.trim()}}return _e})),U(le=>le.map(_e=>{if(r.has(_e.id)&&G.has(_e.id)){const be=G.get(_e.id)||"";return{..._e,notes:be.trim()===""?null:be.trim()}}return _e})),_(le=>le.map(_e=>{if(s.has(_e.id)&&G.has(_e.id)){const be=G.get(_e.id)||"";return{..._e,notes:be.trim()===""?null:be.trim()}}return _e})),N(le=>le.map(_e=>{if(l.has(_e.id)&&G.has(_e.id)){const be=G.get(_e.id)||"";return{..._e,notes:be.trim()===""?null:be.trim()}}return _e}))};return i.jsx("div",{style:je,children:i.jsxs("div",{style:{position:"relative",width:"100%",height:"100%",display:"flex",flexDirection:"column",...E?{}:{backgroundColor:"#fff",borderRadius:8,minWidth:"300px",width:`${$.width}px`,height:`${$.height}px`,maxHeight:`${window.innerHeight-20}px`,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",pointerEvents:"auto"}},children:[i.jsxs("div",{onMouseDown:le=>{const _e=le.target;_e.tagName==="BUTTON"||_e.closest("button")||E&&J(le)},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:re?"grabbing":E?"grab":"default",userSelect:"none",flexShrink:0},children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Notes (N)"}),i.jsx("button",{onClick:D,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsx("div",{style:Ie,children:i.jsxs("div",{style:{margin:0,padding:0,backgroundColor:"#f5f5f5",borderRadius:4,fontSize:"12px",fontFamily:"monospace",maxHeight:"calc(80vh - 100px)",overflow:"auto",color:"#000"},children:[i.jsx("div",{style:{padding:"12px 16px",backgroundColor:W>0?"#e8e8e8":"#fff3cd",borderBottom:"2px solid #ccc",fontSize:"13px",fontWeight:600,color:W>0?"#333":"#856404",marginBottom:"8px"},children:W>0?`${W} Object${W!==1?"s":""} Selected`:"Zero Objects Selected"}),W===0?i.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"No objects selected. Select one or more objects to add or edit notes."}):i.jsxs(i.Fragment,{children:[[...b,...p].filter(le=>o.has(le.id)).map(le=>{const _e=G.get(le.id)||"",be=_e.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsxs("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:[Yl(le.componentType),le.designator&&le.designator.trim()?` (${le.designator.trim()})`:""]})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("textarea",{value:_e,onChange:De=>se(le.id,De.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Jo,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:be>=Jo?"#d32f2f":"#666",textAlign:"right"},children:[be," / ",Jo]})]})]},le.id)}),d.filter(le=>r.has(le.id)&&le.type==="via"&&le.points.length>0).map(le=>{const _e=le.points[0],be=le.viaType||(_e.id!==void 0?g(_e.id,C):"Via"),De=G.get(le.id)||"",Ge=De.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:be})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:_e.id&&i.jsxs("div",{children:["Node ID: ",_e.id]})}),i.jsx("textarea",{value:De,onChange:ot=>se(le.id,ot.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Jo,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Ge>=Jo?"#d32f2f":"#666",textAlign:"right"},children:[Ge," / ",Jo]})]})]},le.id)}),d.filter(le=>r.has(le.id)&&le.type==="pad"&&le.points.length>0).map(le=>{const _e=le.points[0],be=le.padType||(_e.id!==void 0?ae(_e.id,C):"Pad"),De=G.get(le.id)||"",Ge=De.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:be})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:_e.id&&i.jsxs("div",{children:["Node ID: ",_e.id]})}),i.jsx("textarea",{value:De,onChange:ot=>se(le.id,ot.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Jo,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Ge>=Jo?"#d32f2f":"#666",textAlign:"right"},children:[Ge," / ",Jo]})]})]},le.id)}),d.filter(le=>r.has(le.id)&&le.type==="testPoint"&&le.points.length>0).map(le=>{const _e=le.points[0],be=_e.id!==void 0?V(_e.id,C):"Test Point",De=G.get(le.id)||"",Ge=De.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:be})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:_e.id&&i.jsxs("div",{children:["Node ID: ",_e.id]})}),i.jsx("textarea",{value:De,onChange:ot=>se(le.id,ot.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Jo,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Ge>=Jo?"#d32f2f":"#666",textAlign:"right"},children:[Ge," / ",Jo]})]})]},le.id)}),d.filter(le=>r.has(le.id)&&le.type==="trace").map(le=>{const _e=G.get(le.id)||"",be=_e.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:le.type||"unknown"})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("textarea",{value:_e,onChange:De=>se(le.id,De.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Jo,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:be>=Jo?"#d32f2f":"#666",textAlign:"right"},children:[be," / ",Jo]})]})]},le.id)}),v.filter(le=>s.has(le.id)).map(le=>{const _e=C.find(ot=>ot.id===le.powerBusId),be=le.type||(_e?`${_e.name} Power Node`:"Power Node"),De=G.get(le.id)||"",Ge=De.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:be})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:i.jsxs("div",{children:["Node ID: ",le.pointId||"(not assigned)"]})}),i.jsx("textarea",{value:De,onChange:ot=>se(le.id,ot.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Jo,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Ge>=Jo?"#d32f2f":"#666",textAlign:"right"},children:[Ge," / ",Jo]})]})]},le.id)}),m.filter(le=>l.has(le.id)).map(le=>{const _e=le.type||"Ground Node",be=G.get(le.id)||"",De=be.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:_e})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:i.jsxs("div",{children:["Node ID: ",le.pointId||"(not assigned)"]})}),i.jsx("textarea",{value:be,onChange:Ge=>se(le.id,Ge.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:Jo,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:De>=Jo?"#d32f2f":"#666",textAlign:"right"},children:[De," / ",Jo]})]})]},le.id)}),i.jsxs("div",{style:{marginTop:"20px",padding:"12px",display:"flex",justifyContent:"flex-end",gap:"8px",borderTop:"1px solid #ddd"},children:[i.jsx("button",{onClick:D,style:{padding:"8px 16px",fontSize:"12px",backgroundColor:"#757575",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500},onMouseEnter:le=>{le.currentTarget.style.backgroundColor="#616161"},onMouseLeave:le=>{le.currentTarget.style.backgroundColor="#757575"},children:"Close"}),i.jsx("button",{onClick:Ce,style:{padding:"8px 16px",fontSize:"12px",backgroundColor:"#2196F3",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500},onMouseEnter:le=>{le.currentTarget.style.backgroundColor="#1976D2"},onMouseLeave:le=>{le.currentTarget.style.backgroundColor="#2196F3"},children:"Save"})]})]})]})}),i.jsx("div",{onMouseDown:de,style:{position:"absolute",bottom:0,right:0,width:"20px",height:"20px",cursor:"nwse-resize",background:"linear-gradient(135deg, transparent 0%, transparent 40%, #ccc 40%, #ccc 45%, transparent 45%, transparent 55%, #ccc 55%, #ccc 60%, transparent 60%)",zIndex:10001},title:"Drag to resize"})]})})},ow=({visible:n,projectNotes:r,setProjectNotes:o,projectMetadata:s,setProjectMetadata:l,onClose:d,position:b,isDragging:p,onDragStart:v})=>{const[m,C]=L.useState([]),[D,M]=L.useState({productName:"",productVersion:"",manufacturer:"",date:new Date().toISOString().split("T")[0]}),[S,U]=L.useState(null),[_,N]=L.useState(null),g=L.useRef(new Map),[ae,V]=L.useState({width:Math.min(window.innerWidth*.85,1400),height:window.innerHeight*.7}),[E,re]=L.useState(!1),[J,G]=L.useState({x:0,y:0,width:0,height:0}),[ee,F]=L.useState("");L.useEffect(()=>{n&&(C([...r]),M({...s}),(!s.date||s.date.trim()==="")&&M(A=>({...A,date:new Date().toISOString().split("T")[0]})),U(null),N(null),F(""))},[n,r,s]);const $=ee.trim()===""?m:m.filter(A=>{const q=ee.toLowerCase(),W=A.name.toLowerCase().includes(q),se=A.value.toLowerCase().includes(q);return W||se});L.useEffect(()=>{if(!E)return;const A=W=>{const se=W.clientX-J.x,Ce=W.clientY-J.y,le=Math.max(400,Math.min(window.innerWidth-20,J.width+se)),_e=Math.max(300,Math.min(window.innerHeight-20,J.height+Ce));V({width:le,height:_e})},q=()=>{re(!1)};return document.addEventListener("mousemove",A),document.addEventListener("mouseup",q),()=>{document.removeEventListener("mousemove",A),document.removeEventListener("mouseup",q)}},[E,J]);const H=A=>{A.preventDefault(),A.stopPropagation(),re(!0),G({x:A.clientX,y:A.clientY,width:ae.width,height:ae.height})};if(!n)return null;const R=()=>{const A={name:"",value:"",checked:!1};C([...m,A]),U(m.length),N("name")},Z=A=>{const q=m.filter((W,se)=>se!==A);C(q),S===A?(U(null),N(null)):S!==null&&S>A&&U(S-1)},Y=()=>{const A=m.filter(q=>q.name.trim()!==""||q.value.trim()!=="");o(A),l(D),d()},we=()=>{C([...r]),M({...s}),U(null),N(null),d()},te=(A,q,W)=>{const se=[...m];se[A]={...se[A],[q]:W},C(se)},de=(A,q)=>{const W=[...m];W[A]={...W[A],checked:q},C(W)},je=(A,q,W)=>{A.stopPropagation();const se=A.currentTarget,Ce=se.selectionStart,le=se.value.length,_e=se.selectionStart!==se.selectionEnd;if(!(A.key==="Enter"&&A.altKey)){if(A.key==="ArrowRight"&&!A.ctrlKey&&!A.shiftKey&&!A.altKey){if(Ce===le&&!_e&&W==="name"){A.preventDefault();const be=`${q}-value`,De=g.current.get(be);De&&(De.focus(),De.setSelectionRange(0,0))}return}if(A.key==="ArrowLeft"&&!A.ctrlKey&&!A.shiftKey&&!A.altKey){if(Ce===0&&!_e&&W==="value"){A.preventDefault();const be=`${q}-name`,De=g.current.get(be);De&&(De.focus(),De.setSelectionRange(De.value.length,De.value.length))}return}if(A.key==="ArrowDown"&&!A.ctrlKey&&!A.shiftKey&&!A.altKey){if(A.preventDefault(),q<m.length-1){const be=`${q+1}-${W}`,De=g.current.get(be);if(De){De.focus();const Ge=Math.min(Ce,De.value.length);De.setSelectionRange(Ge,Ge)}}else{const be=m.length;R(),setTimeout(()=>{const De=`${be}-${W}`,Ge=g.current.get(De);Ge&&(Ge.focus(),Ge.setSelectionRange(0,0))},0)}return}if(A.key==="ArrowUp"&&!A.ctrlKey&&!A.shiftKey&&!A.altKey){if(A.preventDefault(),q>0){const be=`${q-1}-${W}`,De=g.current.get(be);if(De){De.focus();const Ge=Math.min(Ce,De.value.length);De.setSelectionRange(Ge,Ge)}}return}if(A.key==="Enter"&&!A.altKey&&!A.shiftKey){if(A.preventDefault(),W==="name"){const be=`${q}-value`,De=g.current.get(be);De&&(De.focus(),De.setSelectionRange(0,0))}else if(W==="value")if(q<m.length-1){const be=`${q+1}-name`,De=g.current.get(be);De&&(De.focus(),De.setSelectionRange(0,0))}else{const be=m.length;R(),setTimeout(()=>{const De=`${be}-name`,Ge=g.current.get(De);Ge&&(Ge.focus(),Ge.setSelectionRange(0,0))},0)}return}if(A.key==="Tab"&&!A.shiftKey){if(A.preventDefault(),W==="name"){const be=`${q}-value`,De=g.current.get(be);De&&(De.focus(),De.select())}else if(W==="value")if(q<m.length-1){const be=`${q+1}-name`,De=g.current.get(be);De&&(De.focus(),De.select())}else{const be=m.length;R(),setTimeout(()=>{const De=`${be}-name`,Ge=g.current.get(De);Ge&&Ge.focus()},0)}return}if(A.key==="Tab"&&A.shiftKey){if(A.preventDefault(),W==="value"){const be=`${q}-name`,De=g.current.get(be);De&&(De.focus(),De.select())}else if(W==="name"&&q>0){const be=`${q-1}-value`,De=g.current.get(be);De&&(De.focus(),De.select())}return}}},Ie=(A,q)=>{U(A),N(q)},xe=()=>{},k={position:"fixed",top:b?.y??100,left:b?.x??(window.innerWidth-ae.width)/2,width:`${ae.width}px`,height:`${ae.height}px`,backgroundColor:"#fff",borderRadius:8,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:p?"grabbing":"default",overflow:"hidden"};return i.jsxs("div",{style:k,children:[i.jsxs("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e0e0",background:"#888",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"move",userSelect:"none"},onMouseDown:v,children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Project Notes / TODO List (L)"}),i.jsx("button",{onClick:we,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:"0 4px",lineHeight:1},title:"Close",children:""})]}),i.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e0e0e0",backgroundColor:"#f9f9f9",display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr",gap:"12px",alignItems:"center",flexShrink:0},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[i.jsx("label",{style:{fontSize:"11px",fontWeight:600,color:"#333"},children:"Product Name:"}),i.jsx("input",{type:"text",value:D.productName,onChange:A=>M({...D,productName:A.target.value}),placeholder:"Enter product name",style:{padding:"6px 8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"12px",color:"#000",background:"#fff",outline:"none"}})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[i.jsx("label",{style:{fontSize:"11px",fontWeight:600,color:"#333"},children:"Product Version:"}),i.jsx("input",{type:"text",value:D.productVersion,onChange:A=>M({...D,productVersion:A.target.value}),placeholder:"Enter version",style:{padding:"6px 8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"12px",color:"#000",background:"#fff",outline:"none"}})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[i.jsx("label",{style:{fontSize:"11px",fontWeight:600,color:"#333"},children:"Manufacturer:"}),i.jsx("input",{type:"text",value:D.manufacturer,onChange:A=>M({...D,manufacturer:A.target.value}),placeholder:"Enter manufacturer",style:{padding:"6px 8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"12px",color:"#000",background:"#fff",outline:"none"}})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[i.jsx("label",{style:{fontSize:"11px",fontWeight:600,color:"#333"},children:"Date:"}),i.jsx("input",{type:"date",value:D.date,onChange:A=>M({...D,date:A.target.value}),style:{padding:"6px 8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"12px",color:"#000",background:"#fff",outline:"none"}})]})]}),i.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e0e0e0",backgroundColor:"#f5f5f5",display:"flex",gap:"8px",alignItems:"center",flexShrink:0},children:[i.jsx("input",{type:"text",value:ee,onChange:A=>F(A.target.value),onKeyDown:A=>{A.key==="Enter"&&A.preventDefault()},placeholder:"Search notes...",style:{flex:1,padding:"6px 12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"13px",color:"#000",background:"#fff",outline:"none"}}),i.jsx("button",{onClick:()=>{ee.trim()!==""&&F("")},style:{padding:"6px 16px",background:ee.trim()!==""?"#4CAF50":"#888",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"13px",fontWeight:500,whiteSpace:"nowrap"},children:ee.trim()!==""?"Clear":"Search"})]}),i.jsxs("div",{className:"project-notes-content",style:{padding:0,flex:1,overflowY:"auto",overflowX:"hidden",display:"flex",flexDirection:"column",minHeight:0,scrollbarWidth:"thin",scrollbarColor:"#888 #f0f0f0"},children:[i.jsxs("div",{style:{border:"none",borderTop:"1px solid #ccc",borderRadius:0,overflow:"visible",marginBottom:"16px",backgroundColor:"#e0e0e0",flexShrink:0},children:[i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"40px 1fr 3fr auto",backgroundColor:"#e0e0e0",borderBottom:"1px solid #ccc",position:"sticky",top:0,zIndex:10},children:[i.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",display:"flex",alignItems:"center",justifyContent:"center",color:"#000"},children:i.jsx("label",{className:"radio-label",style:{margin:0,cursor:"default"},children:i.jsx("input",{type:"checkbox",disabled:!0,style:{opacity:.5}})})}),i.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",color:"#000"},children:"Item"}),i.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",color:"#000"},children:"Notes"}),i.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",color:"#000"}})]}),i.jsx("div",{children:m.length===0?i.jsx("div",{style:{padding:"24px",textAlign:"center",color:"#999",fontSize:"13px"},children:'No notes. Click "Add Note" to create one.'}):$.length===0?i.jsxs("div",{style:{padding:"24px",textAlign:"center",color:"#999",fontSize:"13px"},children:['No matches found for "',ee,'".']}):$.map(A=>{const q=m.findIndex(W=>W===A);return i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"40px 1fr 3fr auto",borderBottom:"1px solid #ccc",backgroundColor:"#fff"},children:[i.jsx("div",{style:{padding:"8px 12px",borderRight:"1px solid #ccc",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("label",{className:"radio-label",style:{margin:0,cursor:"pointer"},children:i.jsx("input",{type:"checkbox",checked:A.checked||!1,onChange:W=>de(q,W.target.checked)})})}),i.jsx("div",{style:{padding:"4px",borderRight:"1px solid #ccc"},children:i.jsx("textarea",{ref:W=>{W?g.current.set(`${q}-name`,W):g.current.delete(`${q}-name`)},value:A.name,onChange:W=>te(q,"name",W.target.value),onFocus:()=>Ie(q,"name"),onBlur:xe,onKeyDown:W=>je(W,q,"name"),placeholder:"Item name...",rows:1,style:{width:"100%",padding:"4px 6px",border:S===q&&_==="name"?"2px solid #0b5fff":"1px solid transparent",borderRadius:3,fontSize:"12px",backgroundColor:"#fff",color:"#000",fontFamily:"inherit",resize:"none",minHeight:"24px",lineHeight:"1.4",overflow:"hidden",outline:"none",boxSizing:"border-box"},onInput:W=>{const se=W.target;se.style.height="auto",se.style.height=`${se.scrollHeight}px`}})}),i.jsx("div",{style:{padding:"4px",borderRight:"1px solid #ccc"},children:i.jsx("textarea",{ref:W=>{W?g.current.set(`${q}-value`,W):g.current.delete(`${q}-value`)},value:A.value,onChange:W=>te(q,"value",W.target.value),onFocus:()=>Ie(q,"value"),onBlur:xe,onKeyDown:W=>je(W,q,"value"),placeholder:"Notes...",rows:1,style:{width:"100%",padding:"4px 6px",border:S===q&&_==="value"?"2px solid #0b5fff":"1px solid transparent",borderRadius:3,fontSize:"12px",backgroundColor:"#fff",color:"#000",fontFamily:"inherit",resize:"none",minHeight:"24px",lineHeight:"1.4",overflow:"hidden",outline:"none",boxSizing:"border-box"},onInput:W=>{const se=W.target;se.style.height="auto",se.style.height=`${se.scrollHeight}px`}})}),i.jsx("div",{style:{padding:"8px 12px",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("button",{onClick:()=>Z(q),style:{background:"#f44336",color:"#fff",border:"none",borderRadius:3,padding:"4px 8px",cursor:"pointer",fontSize:"11px"},title:"Delete note",children:"Delete"})})]},q)})})]}),i.jsx("div",{style:{padding:"16px",flexShrink:0},children:i.jsx("button",{onClick:R,style:{background:"#888",color:"#fff",border:"none",borderRadius:4,padding:"8px 16px",cursor:"pointer",fontSize:"12px",fontWeight:500,alignSelf:"flex-start"},children:"+ Add Note"})})]}),i.jsxs("div",{style:{padding:"12px 16px",borderTop:"1px solid #ddd",display:"flex",justifyContent:"flex-end",gap:"8px",flexShrink:0},children:[i.jsx("button",{onClick:we,style:{background:"#f5f5f5",color:"#000",border:"1px solid #ddd",borderRadius:4,padding:"6px 16px",cursor:"pointer",fontSize:"12px"},children:"Cancel"}),i.jsx("button",{onClick:Y,style:{background:"#0b5fff",color:"#fff",border:"none",borderRadius:4,padding:"6px 16px",cursor:"pointer",fontSize:"12px",fontWeight:500},children:"Save"})]}),i.jsx("div",{onMouseDown:H,style:{position:"absolute",bottom:0,right:0,width:"20px",height:"20px",cursor:"nwse-resize",background:"linear-gradient(135deg, transparent 0%, transparent 40%, #ccc 40%, #ccc 45%, transparent 45%, transparent 55%, #ccc 55%, #ccc 60%, transparent 60%)",zIndex:10001},title:"Drag to resize"})]})},aw=({visible:n,drawingStrokes:r,onClose:o,onFindTestPoint:s,position:l,isDragging:d,onDragStart:b,determineTestPointType:p,powerBuses:v})=>{const[m,C]=L.useState("");if(L.useEffect(()=>{n&&C("")},[n]),!n)return null;const D=r.filter(_=>_.type==="testPoint"&&_.points.length>0),M=m.trim()===""?D:D.filter(_=>(_.notes||"").toLowerCase().includes(m.toLowerCase())),S=l?{position:"fixed",left:`${l.x}px`,top:`${l.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"150px",maxWidth:"500px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:d?"grabbing":"default"}:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},U={padding:"20px",overflow:"auto",flex:1};return i.jsxs("div",{style:S,children:[i.jsxs("div",{onMouseDown:_=>{const N=_.target;N.tagName==="BUTTON"||N.closest("button")||l&&b(_)},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:d?"grabbing":l?"grab":"default",userSelect:"none",flexShrink:0},children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Test Points"}),i.jsx("button",{onClick:o,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e0e0e0",backgroundColor:"#f5f5f5",display:"flex",gap:"8px",alignItems:"center",flexShrink:0},children:[i.jsx("input",{type:"text",value:m,onChange:_=>C(_.target.value),onKeyDown:_=>{_.key==="Enter"&&_.preventDefault()},placeholder:"Search test point notes...",style:{flex:1,padding:"6px 12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"13px",color:"#000",background:"#fff",outline:"none"}}),i.jsx("button",{onClick:()=>{m.trim()!==""&&C("")},style:{padding:"6px 16px",background:m.trim()!==""?"#4CAF50":"#888",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"13px",fontWeight:500,whiteSpace:"nowrap"},children:m.trim()!==""?"Clear":"Search"})]}),i.jsx("div",{style:U,children:D.length===0?i.jsx("div",{style:{padding:"24px",textAlign:"center",color:"#999",fontSize:"13px"},children:"No test points found."}):M.length===0?i.jsxs("div",{style:{padding:"24px",textAlign:"center",color:"#999",fontSize:"13px"},children:['No matches found for "',m,'".']}):i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:M.map(_=>{const N=_.points[0],g=N.id!==void 0?p(N.id,v):"Test Point",ae=g.includes("(")?g.substring(0,g.indexOf("(")).trim():g;return i.jsxs("div",{style:{padding:"12px",backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{flexShrink:0},children:i.jsx("path",{d:"M 12 5 L 19 12 L 12 19 L 5 12 Z",fill:"#FFD700",stroke:"#000",strokeWidth:"1.5"})}),i.jsx("div",{style:{fontSize:"12px",fontWeight:500,color:"#000"},children:ae})]}),s&&i.jsx("button",{onClick:()=>{s(_.id,N.x,N.y)},style:{padding:"4px 12px",fontSize:"11px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap"},onMouseEnter:V=>{V.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:V=>{V.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),_.notes&&_.notes.trim()!==""?i.jsx("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px",padding:"8px",backgroundColor:"#f5f5f5",borderRadius:"3px",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:_.notes}):i.jsx("div",{style:{fontSize:"11px",color:"#999",fontStyle:"italic",marginTop:"8px"},children:"No notes"}),i.jsxs("div",{style:{fontSize:"10px",color:"#999",marginTop:"8px"},children:["Layer: ",_.layer," | Position: (",N.x.toFixed(2),", ",N.y.toFixed(2),")"]})]},_.id)})})})]})},sw=({visible:n,dimensions:r,onSave:o,onClose:s})=>{const[l,d]=L.useState(""),[b,p]=L.useState(""),[v,m]=L.useState("inches");L.useEffect(()=>{n&&r?(d(r.width.toString()),p(r.height.toString()),m(r.unit)):n&&(d(""),p(""),m("inches"))},[n,r]);const C=()=>{const M=parseFloat(l),S=parseFloat(b);if(isNaN(M)||M<=0){alert("Please enter a valid width greater than 0");return}if(isNaN(S)||S<=0){alert("Please enter a valid height greater than 0");return}o({width:M,height:S,unit:v}),s()},D=()=>{s()};return n?i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:M=>{M.target===M.currentTarget&&D()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"320px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #444"},onClick:M=>M.stopPropagation(),children:[i.jsx("h3",{style:{margin:"0 0 20px 0",color:"#fff",fontSize:"18px",fontWeight:600},children:"Board Dimensions"}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#ddd",fontSize:"14px"},children:"Width"}),i.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[i.jsx("input",{type:"number",step:"0.001",min:"0.001",value:l,onChange:M=>d(M.target.value),style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px"},placeholder:"0.000"}),i.jsxs("select",{value:v,onChange:M=>m(M.target.value),style:{padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px",cursor:"pointer"},children:[i.jsx("option",{value:"inches",children:"inches"}),i.jsx("option",{value:"mm",children:"mm"})]})]})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#ddd",fontSize:"14px"},children:"Height"}),i.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[i.jsx("input",{type:"number",step:"0.001",min:"0.001",value:b,onChange:M=>p(M.target.value),style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px"},placeholder:"0.000"}),i.jsxs("select",{value:v,onChange:M=>m(M.target.value),style:{padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px",cursor:"pointer"},children:[i.jsx("option",{value:"inches",children:"inches"}),i.jsx("option",{value:"mm",children:"mm"})]})]})]}),i.jsx("div",{style:{marginBottom:"12px",padding:"10px",background:"#1f1f24",borderRadius:4,fontSize:"12px",color:"#bbb"},children:"This information will be used to convert pixel coordinates to real-world measurements."}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[i.jsx("button",{onClick:D,style:{padding:"8px 16px",background:"#444",color:"#fff",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px"},children:"Cancel"}),i.jsx("button",{onClick:C,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Save"})]})]})}):null},lw=({visible:n,onClose:r,topImage:o,bottomImage:s,selectedImageForTransform:l,setSelectedImageForTransform:d,transformMode:b,setTransformMode:p,updateImageTransform:v,resetImageTransform:m,setCurrentTool:C,isGrayscale:D,setIsGrayscale:M,areImagesLocked:S})=>{const[U,_]=L.useState(null),[N,g]=L.useState(!1),ae=L.useRef({x:0,y:0}),V=L.useRef(null);L.useEffect(()=>{n&&U===null&&_({x:window.innerWidth-320-20,y:80})},[n,U]),L.useEffect(()=>{n||_(null)},[n]);const E=L.useCallback(W=>{if(V.current){const se=V.current.getBoundingClientRect();ae.current={x:W.clientX-se.left,y:W.clientY-se.top},g(!0)}},[]);if(L.useEffect(()=>{if(!N)return;const W=Ce=>{const le=Ce.clientX-ae.current.x,_e=Ce.clientY-ae.current.y,be=V.current?.offsetWidth||320,De=V.current?.offsetHeight||600,Ge=Math.max(0,Math.min(le,window.innerWidth-be)),ot=Math.max(0,Math.min(_e,window.innerHeight-De));_({x:Ge,y:ot})},se=()=>{g(!1)};return document.addEventListener("mousemove",W),document.addEventListener("mouseup",se),()=>{document.removeEventListener("mousemove",W),document.removeEventListener("mouseup",se)}},[N]),!n)return null;const re=o!==null,J=s!==null,G=re||J,ee=re&&J,F=l||(re?"top":J?"bottom":null),$=()=>F==="top"&&o?o.brightness??100:F==="bottom"&&s?s.brightness??100:F==="both"&&o?o.brightness??100:100,H=()=>F==="top"&&o?o.contrast??100:F==="bottom"&&s?s.contrast??100:F==="both"&&o?o.contrast??100:100,R=$(),Z=H(),Y=!G||S,we=()=>{if(!(!F||Y))if(F==="both"){const W=!o?.flipX;v("both",{flipX:W})}else{const W=F==="top"?o?.flipX||!1:s?.flipX||!1;v(F,{flipX:!W})}},te=()=>{if(!(!F||Y))if(F==="both"){const W=!o?.flipY;v("both",{flipY:W})}else{const W=F==="top"?o?.flipY||!1:s?.flipY||!1;v(F,{flipY:!W})}},de=W=>{Y||(F&&d(F),p(W),C("transform"))},je=W=>{!F||Y||v(F,{brightness:W})},Ie=W=>{!F||Y||v(F,{contrast:W})},xe=()=>{Y||(F&&d(F),C("transform"),M(!D))},k=()=>{Y||(C("transform"),m())},A=(W,se=!1)=>({display:"block",width:"100%",textAlign:"left",padding:"8px 12px",color:W?"#666":"#f2f2f2",background:se?"#3a3a42":"transparent",border:"none",borderRadius:4,cursor:W?"not-allowed":"pointer",fontSize:"13px",transition:"background 0.15s"}),q=(W,se)=>({display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",color:W?"#666":"#f2f2f2",cursor:W?"not-allowed":"pointer",fontSize:"13px",background:se?"#3a3a42":"transparent",borderRadius:4,transition:"background 0.15s"});return i.jsxs("div",{ref:V,style:{position:"fixed",top:U?.y??80,left:U?.x??window.innerWidth-340,backgroundColor:"#2b2b31",borderRadius:8,minWidth:"320px",maxWidth:"400px",maxHeight:"calc(100vh - 100px)",overflowY:"auto",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24",zIndex:10001},children:[i.jsxs("div",{onMouseDown:E,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 16px",background:"linear-gradient(to bottom, #3a3a42, #2b2b31)",borderTopLeftRadius:8,borderTopRightRadius:8,borderBottom:"1px solid #1f1f24",cursor:N?"grabbing":"grab",userSelect:"none"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("span",{style:{color:"#888",fontSize:"14px"},children:""}),i.jsx("h2",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#f2f2f2"},children:"Transform Images"})]}),i.jsx("button",{onClick:r,style:{background:"transparent",border:"none",color:"#888",fontSize:"16px",cursor:"pointer",padding:"2px 6px",lineHeight:1,borderRadius:4},onMouseEnter:W=>{W.currentTarget.style.background="#444",W.currentTarget.style.color="#fff"},onMouseLeave:W=>{W.currentTarget.style.background="transparent",W.currentTarget.style.color="#888"},children:""})]}),i.jsxs("div",{style:{padding:"16px"},children:[i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("div",{style:{fontSize:"12px",color:"#888",marginBottom:"8px",fontWeight:500},children:"Apply to:"}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[i.jsxs("label",{style:q(!re,F==="top"),children:[i.jsx("input",{type:"radio",name:"imageSelection",checked:F==="top",onChange:()=>d("top"),disabled:!re,style:{accentColor:"#6b9fff"}}),"Top Image",!re&&i.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(not loaded)"})]}),i.jsxs("label",{style:q(!J,F==="bottom"),children:[i.jsx("input",{type:"radio",name:"imageSelection",checked:F==="bottom",onChange:()=>d("bottom"),disabled:!J,style:{accentColor:"#6b9fff"}}),"Bottom Image",!J&&i.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(not loaded)"})]}),i.jsxs("label",{style:q(!ee,F==="both"),children:[i.jsx("input",{type:"radio",name:"imageSelection",checked:F==="both",onChange:()=>d("both"),disabled:!ee,style:{accentColor:"#6b9fff"}}),"Both Images",!ee&&i.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(need both)"})]})]})]}),i.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),i.jsxs("div",{style:{marginBottom:"12px"},children:[i.jsx("button",{onClick:we,disabled:Y,style:A(Y),onMouseEnter:W=>!Y&&(W.currentTarget.style.background="#3a3a42"),onMouseLeave:W=>W.currentTarget.style.background="transparent",children:"Horizontal Flip"}),i.jsx("button",{onClick:te,disabled:Y,style:A(Y),onMouseEnter:W=>!Y&&(W.currentTarget.style.background="#3a3a42"),onMouseLeave:W=>W.currentTarget.style.background="transparent",children:"Vertical Flip"})]}),i.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),i.jsx("div",{style:{marginBottom:"12px"},children:["nudge","scale","rotate","slant","keystone"].map(W=>i.jsxs("button",{onClick:()=>de(W),disabled:Y,style:A(Y,b===W),onMouseEnter:se=>!Y&&b!==W&&(se.currentTarget.style.background="#3a3a42"),onMouseLeave:se=>b!==W&&(se.currentTarget.style.background="transparent"),children:[b===W?" ":"","Mode: ",W.charAt(0).toUpperCase()+W.slice(1)]},W))}),i.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[i.jsx("label",{style:{color:"#f2f2f2",fontSize:"13px",fontWeight:500},children:"Brightness"}),i.jsxs("span",{style:{color:"#888",fontSize:"12px",minWidth:"45px",textAlign:"right"},children:[R,"%"]})]}),i.jsx("input",{type:"range",min:"0",max:"200",step:"1",value:R,onChange:W=>je(parseInt(W.target.value,10)),disabled:Y,style:{width:"100%",cursor:Y?"not-allowed":"pointer",accentColor:"#6b9fff"}})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[i.jsx("label",{style:{color:"#f2f2f2",fontSize:"13px",fontWeight:500},children:"Contrast"}),i.jsxs("span",{style:{color:"#888",fontSize:"12px",minWidth:"45px",textAlign:"right"},children:[Z,"%"]})]}),i.jsx("input",{type:"range",min:"0",max:"200",step:"1",value:Z,onChange:W=>Ie(parseInt(W.target.value,10)),disabled:Y,style:{width:"100%",cursor:Y?"not-allowed":"pointer",accentColor:"#6b9fff"}})]}),i.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),i.jsx("div",{style:{marginBottom:"12px"},children:i.jsxs("button",{onClick:xe,disabled:Y,style:A(Y,D),onMouseEnter:W=>!Y&&!D&&(W.currentTarget.style.background="#3a3a42"),onMouseLeave:W=>!D&&(W.currentTarget.style.background="transparent"),children:[D?" ":"","Grayscale Mode"]})}),i.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[i.jsx("button",{onClick:k,disabled:Y,style:{padding:"8px 16px",background:Y?"#444":"#555",color:Y?"#777":"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:Y?"not-allowed":"pointer",fontSize:"13px",fontWeight:500},children:"Reset Transform"}),i.jsx("button",{onClick:r,style:{padding:"8px 16px",background:"#4a9eff",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:500},onMouseEnter:W=>W.currentTarget.style.background="#3a8ee6",onMouseLeave:W=>W.currentTarget.style.background="#4a9eff",children:"Close"})]}),S&&i.jsx("div",{style:{marginTop:"12px",padding:"8px 12px",background:"#3d2b2b",border:"1px solid #5a3a3a",borderRadius:4,fontSize:"12px",color:"#e88"},children:" Images are locked. Unlock via Images  Lock Images to make changes."})]})]})},cw=({visible:n,onClose:r,topImage:o,bottomImage:s,setTopImage:l,setBottomImage:d,componentsTop:b,componentsBottom:p,setComponentsTop:v,setComponentsBottom:m,drawingStrokes:C,setDrawingStrokes:D,powerSymbols:M,groundSymbols:S,setPowerSymbols:U,setGroundSymbols:_,canvasRef:N,isBottomView:g,setIsBottomView:ae,originalTopFlipX:V,setOriginalTopFlipX:E,originalBottomFlipX:re,setOriginalBottomFlipX:J,originalTopFlipY:G,setOriginalTopFlipY:ee,originalBottomFlipY:F,setOriginalBottomFlipY:$,cameraWorldCenter:H,setCameraWorldCenter:R,viewScale:Z,viewRotation:Y,setViewRotation:we,viewFlipX:te,setViewFlipX:de,contentBorder:je,setTransparency:Ie})=>{const[xe,k]=L.useState(null),[A,q]=L.useState(!1),W=L.useRef({x:0,y:0}),se=L.useRef(null),Ce=L.useCallback((ot,jt,Ht,ge)=>{const lt=window.innerWidth,Yt=window.innerHeight,Gt=10,xt=Math.max(Gt,Math.min(ot,lt-Ht-Gt)),hn=Math.max(Gt,Math.min(jt,Yt-ge-Gt));return{x:xt,y:hn}},[]);L.useEffect(()=>{if(n&&xe===null){const ot=localStorage.getItem("transformAllDialogPosition"),jt=320,Ht=400,ge=20,lt=150;let Yt;if(ot)try{const Gt=JSON.parse(ot);Yt=Ce(Gt.x,Gt.y,jt,Ht)}catch{Yt=Ce(window.innerWidth-jt-ge,lt,jt,Ht)}else Yt=Ce(window.innerWidth-jt-ge,lt,jt,Ht);k(Yt)}},[n,xe,Ce]);const le=L.useCallback(ot=>{if(se.current){const jt=se.current.getBoundingClientRect();W.current={x:ot.clientX-jt.left,y:ot.clientY-jt.top},q(!0)}},[]);L.useEffect(()=>{if(!A)return;const ot=Ht=>{const ge=Ht.clientX-W.current.x,lt=Ht.clientY-W.current.y,Yt=se.current?.offsetWidth||320,Gt=se.current?.offsetHeight||400,xt=Ce(ge,lt,Yt,Gt);k(xt),localStorage.setItem("transformAllDialogPosition",JSON.stringify(xt))},jt=()=>{q(!1)};return document.addEventListener("mousemove",ot),document.addEventListener("mouseup",jt),()=>{document.removeEventListener("mousemove",ot),document.removeEventListener("mouseup",jt)}},[A,Ce]);const _e=L.useCallback(()=>{g||(de(!0),ae(!0),Ie(100))},[g,de,ae,Ie]),be=L.useCallback(()=>{g&&(de(!1),ae(!1),Ie(0))},[g,de,ae,Ie]),De=L.useCallback(ot=>{we(jt=>qg(jt,ot))},[we,qg]);if(!n)return null;const Ge=(ot=!1)=>({display:"block",width:"100%",textAlign:"left",padding:"8px 12px",color:ot?"#999":"#222",background:"transparent",border:"none",borderRadius:4,cursor:ot?"not-allowed":"pointer",fontSize:"13px",transition:"background 0.15s"});return i.jsxs("div",{ref:se,style:{position:"fixed",top:xe?.y??150,left:xe?.x??window.innerWidth-340,backgroundColor:"#fff",borderRadius:8,minWidth:"320px",maxWidth:"400px",maxHeight:"calc(100vh - 100px)",overflowY:"auto",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:10001,display:"flex",flexDirection:"column"},children:[i.jsxs("div",{onMouseDown:le,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:A?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Change Perspective"}),i.jsx("button",{onClick:r,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsxs("div",{style:{padding:"20px",overflow:"auto",flex:1},children:[i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"8px",fontWeight:500},children:"View:"}),i.jsx("button",{onClick:g?be:_e,style:Ge(!1),onMouseEnter:ot=>ot.currentTarget.style.background="#f0f0f0",onMouseLeave:ot=>ot.currentTarget.style.background="transparent",children:g?"Switch to Top View":"Switch to Bottom View"}),i.jsx("div",{style:{fontSize:"10px",color:"#999",marginTop:"6px",fontStyle:"italic"},children:"Shortcut: Shift-Left/Right Arrow Keys"})]}),i.jsx("div",{style:{height:1,background:"#e0e0e0",margin:"16px 0"}}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"8px",fontWeight:500},children:"Rotate (clockwise):"}),i.jsx("button",{onClick:()=>De(90),style:Ge(),onMouseEnter:ot=>ot.currentTarget.style.background="#f0f0f0",onMouseLeave:ot=>ot.currentTarget.style.background="transparent",children:"Rotate 90"}),i.jsx("button",{onClick:()=>De(180),style:Ge(),onMouseEnter:ot=>ot.currentTarget.style.background="#f0f0f0",onMouseLeave:ot=>ot.currentTarget.style.background="transparent",children:"Rotate 180"}),i.jsx("button",{onClick:()=>De(270),style:Ge(),onMouseEnter:ot=>ot.currentTarget.style.background="#f0f0f0",onMouseLeave:ot=>ot.currentTarget.style.background="transparent",children:"Rotate 270"}),i.jsx("div",{style:{fontSize:"10px",color:"#999",marginTop:"6px",fontStyle:"italic"},children:"Shortcut: Shift-Up/Down Arrow Keys"})]}),i.jsx("div",{style:{height:1,background:"#e0e0e0",margin:"16px 0"}}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:i.jsx("button",{onClick:r,style:{padding:"8px 16px",background:"#4a9eff",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:500},onMouseEnter:ot=>ot.currentTarget.style.background="#3a8ee6",onMouseLeave:ot=>ot.currentTarget.style.background="#4a9eff",children:"Close"})})]})]})},Zy=({visible:n,title:r,message:o,onClose:s,type:l="info",onShowResponse:d})=>{if(!n)return null;const b=l==="success"?"#4CAF50":"#2196F3",p=l==="success"?"#4CAF50":"#2196F3",v=l==="success"?"":"";return i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:m=>{m.target===m.currentTarget&&s()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"90vw",maxHeight:"90vh",width:"600px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:`2px solid ${p}`,display:"flex",flexDirection:"column"},onClick:m=>m.stopPropagation(),children:[i.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",gap:"12px",flexShrink:0},children:[i.jsx("div",{style:{fontSize:"24px",color:b},children:v}),i.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:r})]}),i.jsx("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"14px",lineHeight:"1.5",whiteSpace:"pre-wrap",wordWrap:"break-word",overflowY:"auto",maxHeight:"60vh",paddingRight:"8px",flex:1},children:o}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[d&&i.jsx("button",{onClick:()=>{d(),s()},style:{padding:"8px 16px",background:"#555",color:"#fff",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Show Response"}),i.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"OK"})]})]})})},uw=({component:n,componentEditor:r,componentDefinition:o,setComponentEditor:s,areComponentsLocked:l,componentsTop:d,componentsBottom:b,setComponentsTop:p,setComponentsBottom:v,uploadedDatasheetFile:m,setUploadedDatasheetFile:C})=>{if(!n||!n.id||!n.componentType||typeof n.pinCount!="number")return console.error("[ComponentTypeFields] Component missing required properties:",{comp:n,hasId:!!n?.id,hasComponentType:!!n?.componentType,componentType:n?.componentType,pinCount:n?.pinCount,pinCountType:typeof n?.pinCount}),null;const M=(o||r?.componentDefinition||$l(n))?.fields,S=n.componentType,U=S==="IntegratedCircuit"||S==="Semiconductor",_=S==="Semiconductor",N=S==="IntegratedCircuit";if(M&&M.length>0&&!N){const g=(V,E,re)=>re?V==="capacitance"||V==="resistance"||V==="voltage"||V==="current"?"80px":V==="power"||V==="inductance"||V==="impedance"||V==="esr"||V==="ripple"||V==="leakageCurrent"?"70px":"80px":V==="tolerance"||V==="pinCount"?"60px":V==="partNumber"||V==="manufacturer"?"150px":V==="description"||V==="operatingTemperature"?"180px":E==="string"&&!V.includes("Unit")?"150px":"120px",ae=V=>{const E=n.componentType,re=E==="IntegratedCircuit"||E==="Semiconductor";if(re&&V.name==="datasheet"||re&&(V.name==="manufacturer"||V.name==="partNumber")||V.name==="description")return null;const J=V.name,G=`${V.name}Unit`,ee=r[J]??n[J]??V.defaultValue??"",F=r[G]??n[G]??(V.units&&V.defaultUnit?V.defaultUnit:""),$=Y=>{s(te=>te&&{...te,[J]:Y})},H=Y=>{s(te=>te&&{...te,[G]:Y})},R=!!(V.units&&V.units.length>0),Z=g(V.name,V.type,R);return i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsxs("label",{style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:[V.label,":"]}),V.type==="enum"?i.jsx("select",{value:ee,onChange:Y=>$(Y.target.value),disabled:l,style:{width:Z,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:(V.enumValues||[]).map(Y=>i.jsx("option",{value:Y,children:Y},Y))}):i.jsx("input",{type:"text",value:ee,onChange:Y=>$(Y.target.value),disabled:l,style:{width:Z,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:R?"8px":"0"},placeholder:V.defaultValue!==void 0?String(V.defaultValue):""}),R&&V.units&&i.jsx("select",{value:F||V.defaultUnit||V.units[0],onChange:Y=>H(Y.target.value),disabled:l,style:{width:"70px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,flexShrink:0},children:V.units.map(Y=>i.jsx("option",{value:Y,children:Y},Y))})]},V.name)};if(!_)return i.jsx(i.Fragment,{children:M.map(ae).filter(Boolean)})}return U?i.jsxs(i.Fragment,{children:[n.componentType==="Resistor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-resistance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),i.jsx("input",{id:`component-resistance-${n.id}`,type:"text",value:r.resistance||"",onChange:g=>s({...r,resistance:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 10"}),i.jsx("select",{value:r.resistanceUnit||fn("resistance"),onChange:g=>s({...r,resistanceUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("resistance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-power-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),i.jsxs("select",{id:`component-power-${n.id}`,value:r.power||"1/4",onChange:g=>s({...r,power:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"12px"},children:[i.jsx("option",{value:"1/20",children:"1/20 W"}),i.jsx("option",{value:"1/16",children:"1/16 W"}),i.jsx("option",{value:"1/10",children:"1/10 W"}),i.jsx("option",{value:"1/8",children:"1/8 W"}),i.jsx("option",{value:"1/4",children:"1/4 W"}),i.jsx("option",{value:"1/2",children:"1/2 W"}),i.jsx("option",{value:"1",children:"1 W"}),i.jsx("option",{value:"2",children:"2 W"}),i.jsx("option",{value:"3",children:"3 W"}),i.jsx("option",{value:"5",children:"5 W"}),i.jsx("option",{value:"10",children:"10 W"}),i.jsx("option",{value:"25",children:"25 W"}),i.jsx("option",{value:"50",children:"50 W"}),i.jsx("option",{value:"100",children:"100 W"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-tolerance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),i.jsxs("select",{id:`component-tolerance-${n.id}`,value:r.tolerance||"5%",onChange:g=>s({...r,tolerance:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"0.05%",children:"0.05%"}),i.jsx("option",{value:"0.1%",children:"0.1%"}),i.jsx("option",{value:"0.25%",children:"0.25%"}),i.jsx("option",{value:"0.5%",children:"0.5%"}),i.jsx("option",{value:"1%",children:"1%"}),i.jsx("option",{value:"2%",children:"2%"}),i.jsx("option",{value:"5%",children:"5%"}),i.jsx("option",{value:"10%",children:"10%"}),i.jsx("option",{value:"20%",children:"20%"})]})]})]}),n.componentType==="Capacitor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-capacitance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),i.jsx("input",{id:`component-capacitance-${n.id}`,type:"text",value:r.capacitance||"",onChange:g=>s({...r,capacitance:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 100"}),i.jsx("select",{value:r.capacitanceUnit||fn("capacitance"),onChange:g=>s({...r,capacitanceUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("capacitance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:g=>s({...r,voltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 50"}),i.jsx("select",{value:r.voltageUnit||fn("voltage"),onChange:g=>s({...r,voltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-dielectric-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Dielectric:"}),i.jsxs("select",{id:`component-dielectric-${n.id}`,value:r.dielectric||"Ceramic",onChange:g=>s({...r,dielectric:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Ceramic",children:"Ceramic"}),i.jsx("option",{value:"Tantalum",children:"Tantalum"}),i.jsx("option",{value:"Film",children:"Film"}),i.jsx("option",{value:"Polyester",children:"Polyester"}),i.jsx("option",{value:"Polypropylene",children:"Polypropylene"}),i.jsx("option",{value:"Mica",children:"Mica"}),i.jsx("option",{value:"Paper",children:"Paper"}),i.jsx("option",{value:"Glass",children:"Glass"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-tolerance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),i.jsxs("select",{id:`component-tolerance-${n.id}`,value:r.tolerance||"10%",onChange:g=>s({...r,tolerance:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"0.5%",children:"0.5%"}),i.jsx("option",{value:"1%",children:"1%"}),i.jsx("option",{value:"2%",children:"2%"}),i.jsx("option",{value:"5%",children:"5%"}),i.jsx("option",{value:"10%",children:"10%"}),i.jsx("option",{value:"20%",children:"20%"})]})]})]}),n.componentType==="Film Capacitor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-capacitance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),i.jsx("input",{id:`component-capacitance-${n.id}`,type:"text",value:r.capacitance||"",onChange:g=>s({...r,capacitance:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 100"}),i.jsx("select",{value:r.capacitanceUnit||fn("capacitance"),onChange:g=>s({...r,capacitanceUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("capacitance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:g=>s({...r,voltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 50"}),i.jsx("select",{value:r.voltageUnit||fn("voltage"),onChange:g=>s({...r,voltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-filmtype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Film Type:"}),i.jsxs("select",{id:`component-filmtype-${n.id}`,value:r.filmType||"Polyester",onChange:g=>s({...r,filmType:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Polyester",children:"Polyester"}),i.jsx("option",{value:"Polypropylene",children:"Polypropylene"}),i.jsx("option",{value:"Polyethylene",children:"Polyethylene"}),i.jsx("option",{value:"Polystyrene",children:"Polystyrene"}),i.jsx("option",{value:"Polycarbonate",children:"Polycarbonate"}),i.jsx("option",{value:"PTFE",children:"PTFE (Teflon)"}),i.jsx("option",{value:"PPS",children:"PPS (Polyphenylene Sulfide)"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-tolerance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),i.jsxs("select",{id:`component-tolerance-${n.id}`,value:r.tolerance||"10%",onChange:g=>s({...r,tolerance:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"0.5%",children:"0.5%"}),i.jsx("option",{value:"1%",children:"1%"}),i.jsx("option",{value:"2%",children:"2%"}),i.jsx("option",{value:"5%",children:"5%"}),i.jsx("option",{value:"10%",children:"10%"}),i.jsx("option",{value:"20%",children:"20%"})]})]})]}),n.componentType==="Electrolytic Capacitor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-capacitance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),i.jsx("input",{id:`component-capacitance-${n.id}`,type:"text",value:r.capacitance||"",onChange:g=>s({...r,capacitance:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 100"}),i.jsxs("select",{value:r.capacitanceUnit||"F",onChange:g=>s({...r,capacitanceUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:[i.jsx("option",{value:"pF",children:"pF"}),i.jsx("option",{value:"nF",children:"nF"}),i.jsx("option",{value:"F",children:"F"}),i.jsx("option",{value:"mF",children:"mF"}),i.jsx("option",{value:"F",children:"F"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:g=>s({...r,voltage:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 25"}),i.jsx("select",{value:r.voltageUnit||fn("voltage"),onChange:g=>s({...r,voltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-tolerance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),i.jsxs("select",{id:`component-tolerance-${n.id}`,value:r.tolerance||"20%",onChange:g=>s({...r,tolerance:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},children:[i.jsx("option",{value:"0.5%",children:"0.5%"}),i.jsx("option",{value:"1%",children:"1%"}),i.jsx("option",{value:"2%",children:"2%"}),i.jsx("option",{value:"5%",children:"5%"}),i.jsx("option",{value:"10%",children:"10%"}),i.jsx("option",{value:"20%",children:"20%"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-polarized-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Polarized:"}),i.jsx("input",{id:`component-polarized-${n.id}`,type:"checkbox",checked:ip(n),disabled:!0,style:{opacity:.6,cursor:"not-allowed"},title:"Polarized is a fixed property determined by component type"})]})]}),n.componentType==="Inductor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-inductance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Inductance:"}),i.jsx("input",{id:`component-inductance-${n.id}`,type:"text",value:r.inductance||"",onChange:g=>s({...r,inductance:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 10"}),i.jsx("select",{value:r.inductanceUnit||fn("inductance"),onChange:g=>s({...r,inductanceUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("inductance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:g=>s({...r,current:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:r.currentUnit||fn("current"),onChange:g=>s({...r,currentUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("current").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-resistance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"DC Resistance:"}),i.jsx("input",{id:`component-resistance-${n.id}`,type:"text",value:r.resistance||"",onChange:g=>s({...r,resistance:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 50"}),i.jsx("select",{value:r.resistanceUnit||"",onChange:g=>s({...r,resistanceUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("resistance").map(g=>i.jsx("option",{value:g,children:g},g))})]})]}),n.componentType==="Diode"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-diodetype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Diode Type:"}),i.jsxs("select",{id:`component-diodetype-${n.id}`,value:r.diodeType||"Standard",onChange:g=>s({...r,diodeType:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Standard",children:"Standard"}),i.jsx("option",{value:"Zener",children:"Zener"}),i.jsx("option",{value:"LED",children:"LED"}),i.jsx("option",{value:"Schottky",children:"Schottky"}),i.jsx("option",{value:"Infrared",children:"Infrared"}),i.jsx("option",{value:"Photodiode",children:"Photodiode"}),i.jsx("option",{value:"Other",children:"Other"})]})]}),r.diodeType==="LED"&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-ledcolor-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"LED Color:"}),i.jsxs("select",{id:`component-ledcolor-${n.id}`,value:r.ledColor||"",onChange:g=>s({...r,ledColor:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"",children:"Select..."}),i.jsx("option",{value:"Red",children:"Red"}),i.jsx("option",{value:"Green",children:"Green"}),i.jsx("option",{value:"Blue",children:"Blue"}),i.jsx("option",{value:"Yellow",children:"Yellow"}),i.jsx("option",{value:"Orange",children:"Orange"}),i.jsx("option",{value:"White",children:"White"}),i.jsx("option",{value:"RGB",children:"RGB"}),i.jsx("option",{value:"IR",children:"IR (Infrared)"}),i.jsx("option",{value:"UV",children:"UV (Ultraviolet)"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:g=>s({...r,voltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 50"}),i.jsx("select",{value:r.voltageUnit||fn("voltage"),onChange:g=>s({...r,voltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:g=>s({...r,current:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:r.currentUnit||fn("current"),onChange:g=>s({...r,currentUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("current").map(g=>i.jsx("option",{value:g,children:g},g))})]})]}),n.componentType==="Battery"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:g=>s({...r,voltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 3.7"}),i.jsx("select",{value:r.voltageUnit||"V",onChange:g=>s({...r,voltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-capacity-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacity:"}),i.jsx("input",{id:`component-capacity-${n.id}`,type:"text",value:r.capacity||"",onChange:g=>s({...r,capacity:g.target.value}),disabled:l,style:{width:"120px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 2000mAh"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-chemistry-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Chemistry:"}),i.jsxs("select",{id:`component-chemistry-${n.id}`,value:r.chemistry||"Li-ion",onChange:g=>s({...r,chemistry:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Li-ion",children:"Li-ion"}),i.jsx("option",{value:"LiPo",children:"LiPo"}),i.jsx("option",{value:"NiMH",children:"NiMH"}),i.jsx("option",{value:"NiCd",children:"NiCd"}),i.jsx("option",{value:"Alkaline",children:"Alkaline"}),i.jsx("option",{value:"Lead-Acid",children:"Lead-Acid"}),i.jsx("option",{value:"Lithium",children:"Lithium"}),i.jsx("option",{value:"Zinc-Carbon",children:"Zinc-Carbon"})]})]})]}),n.componentType==="Fuse"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:g=>s({...r,current:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 5"}),i.jsx("select",{value:r.currentUnit||"A",onChange:g=>s({...r,currentUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("current").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:g=>s({...r,voltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 250"}),i.jsx("select",{value:r.voltageUnit||"V",onChange:g=>s({...r,voltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-fusetype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Fuse Type:"}),i.jsxs("select",{id:`component-fusetype-${n.id}`,value:r.fuseType||"Fast-blow",onChange:g=>s({...r,fuseType:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Fast-blow",children:"Fast-blow"}),i.jsx("option",{value:"Slow-blow",children:"Slow-blow"}),i.jsx("option",{value:"Time-delay",children:"Time-delay"}),i.jsx("option",{value:"Resettable",children:"Resettable"}),i.jsx("option",{value:"Cartridge",children:"Cartridge"}),i.jsx("option",{value:"Glass",children:"Glass"}),i.jsx("option",{value:"Ceramic",children:"Ceramic"})]})]})]}),n.componentType==="Relay"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-coilvoltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Coil Voltage:"}),i.jsx("input",{id:`component-coilvoltage-${n.id}`,type:"text",value:r.coilVoltage||"",onChange:g=>s({...r,coilVoltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 12"}),i.jsx("select",{value:r.coilVoltageUnit||fn("voltage"),onChange:g=>s({...r,coilVoltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-contacttype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Contact Type:"}),i.jsxs("select",{id:`component-contacttype-${n.id}`,value:r.contactType||"SPST",onChange:g=>s({...r,contactType:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"SPST",children:"SPST (Single Pole Single Throw)"}),i.jsx("option",{value:"SPDT",children:"SPDT (Single Pole Double Throw)"}),i.jsx("option",{value:"DPST",children:"DPST (Double Pole Single Throw)"}),i.jsx("option",{value:"DPDT",children:"DPDT (Double Pole Double Throw)"}),i.jsx("option",{value:"3PDT",children:"3PDT (3 Pole Double Throw)"}),i.jsx("option",{value:"4PDT",children:"4PDT (4 Pole Double Throw)"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:g=>s({...r,current:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 10"}),i.jsx("select",{value:r.currentUnit||fn("current"),onChange:g=>s({...r,currentUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("current").map(g=>i.jsx("option",{value:g,children:g},g))})]})]}),n.componentType==="Motor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-motortype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Motor Type:"}),i.jsxs("select",{id:`component-motortype-${n.id}`,value:r.motorType||"DC",onChange:g=>s({...r,motorType:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"DC",children:"DC Motor"}),i.jsx("option",{value:"Stepper",children:"Stepper Motor"}),i.jsx("option",{value:"Servo",children:"Servo Motor"}),i.jsx("option",{value:"Brushless",children:"Brushless DC"}),i.jsx("option",{value:"AC",children:"AC Motor"}),i.jsx("option",{value:"Synchronous",children:"Synchronous"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:g=>s({...r,voltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 12"}),i.jsx("select",{value:r.voltageUnit||fn("voltage"),onChange:g=>s({...r,voltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:g=>s({...r,current:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:r.currentUnit||fn("current"),onChange:g=>s({...r,currentUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("current").map(g=>i.jsx("option",{value:g,children:g},g))})]})]}),n.componentType==="Switch"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-switchtype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Switch Type:"}),i.jsxs("select",{id:`component-switchtype-${n.id}`,value:r.switchType||"Toggle",onChange:g=>s({...r,switchType:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Toggle",children:"Toggle"}),i.jsx("option",{value:"Push-button",children:"Push-button"}),i.jsx("option",{value:"Slide",children:"Slide"}),i.jsx("option",{value:"Rotary",children:"Rotary"}),i.jsx("option",{value:"DIP",children:"DIP Switch"}),i.jsx("option",{value:"Momentary",children:"Momentary"}),i.jsx("option",{value:"Latching",children:"Latching"}),i.jsx("option",{value:"Reed",children:"Reed Switch"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:g=>s({...r,current:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 5"}),i.jsx("select",{value:r.currentUnit||fn("current"),onChange:g=>s({...r,currentUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("current").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:g=>s({...r,voltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 250"}),i.jsx("select",{value:r.voltageUnit||fn("voltage"),onChange:g=>s({...r,voltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]})]}),n.componentType==="FerriteBead"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-impedance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Impedance:"}),i.jsx("input",{id:`component-impedance-${n.id}`,type:"text",value:r.impedance||"",onChange:g=>s({...r,impedance:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 100"}),i.jsx("select",{value:r.impedanceUnit||fn("impedance"),onChange:g=>s({...r,impedanceUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("impedance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:g=>s({...r,current:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:r.currentUnit||fn("current"),onChange:g=>s({...r,currentUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("current").map(g=>i.jsx("option",{value:g,children:g},g))})]})]}),n.componentType==="Connector"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-connectortype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Connector Type:"}),i.jsx("input",{id:`component-connectortype-${n.id}`,type:"text",value:r.connectorType||"",onChange:g=>s({...r,connectorType:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., USB-A, HDMI"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-gender-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Gender:"}),i.jsxs("select",{id:`component-gender-${n.id}`,value:r.gender||"N/A",onChange:g=>s({...r,gender:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Male",children:"Male"}),i.jsx("option",{value:"Female",children:"Female"}),i.jsx("option",{value:"N/A",children:"N/A"})]})]})]}),n.componentType==="Jumper"&&i.jsx(i.Fragment,{children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-positions-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Positions:"}),i.jsx("input",{id:`component-positions-${n.id}`,type:"number",min:"2",value:r.positions||3,onChange:g=>s({...r,positions:parseInt(g.target.value)||3}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"}})]})}),n.componentType==="Speaker"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-impedance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Impedance:"}),i.jsx("input",{id:`component-impedance-${n.id}`,type:"text",value:r.impedance||"",onChange:g=>s({...r,impedance:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 8"}),i.jsx("select",{value:r.impedanceUnit||fn("impedance"),onChange:g=>s({...r,impedanceUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("impedance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-power-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),i.jsxs("select",{id:`component-power-${n.id}`,value:r.power||"1/4",onChange:g=>s({...r,power:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"12px"},children:[i.jsx("option",{value:"1/20",children:"1/20 W"}),i.jsx("option",{value:"1/16",children:"1/16 W"}),i.jsx("option",{value:"1/10",children:"1/10 W"}),i.jsx("option",{value:"1/8",children:"1/8 W"}),i.jsx("option",{value:"1/4",children:"1/4 W"}),i.jsx("option",{value:"1/2",children:"1/2 W"}),i.jsx("option",{value:"1",children:"1 W"}),i.jsx("option",{value:"2",children:"2 W"}),i.jsx("option",{value:"3",children:"3 W"}),i.jsx("option",{value:"5",children:"5 W"}),i.jsx("option",{value:"10",children:"10 W"}),i.jsx("option",{value:"25",children:"25 W"}),i.jsx("option",{value:"50",children:"50 W"}),i.jsx("option",{value:"100",children:"100 W"})]})]})]}),n.componentType==="PowerSupply"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-inputvoltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Input Voltage:"}),i.jsx("input",{id:`component-inputvoltage-${n.id}`,type:"text",value:r.inputVoltage||"",onChange:g=>s({...r,inputVoltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 120"}),i.jsx("select",{value:r.inputVoltageUnit||fn("voltage"),onChange:g=>s({...r,inputVoltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-outputvoltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Output Voltage:"}),i.jsx("input",{id:`component-outputvoltage-${n.id}`,type:"text",value:r.outputVoltage||"",onChange:g=>s({...r,outputVoltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 12"}),i.jsx("select",{value:r.outputVoltageUnit||fn("voltage"),onChange:g=>s({...r,outputVoltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:g=>s({...r,current:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:r.currentUnit||fn("current"),onChange:g=>s({...r,currentUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("current").map(g=>i.jsx("option",{value:g,children:g},g))})]})]}),n.componentType==="Transistor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-transistortype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Transistor Type:"}),i.jsxs("select",{id:`component-transistortype-${n.id}`,value:r.transistorType||"BJT",onChange:g=>s({...r,transistorType:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"BJT",children:"BJT (Bipolar Junction Transistor)"}),i.jsx("option",{value:"FET",children:"FET (Field Effect Transistor)"}),i.jsx("option",{value:"MOSFET",children:"MOSFET"}),i.jsx("option",{value:"IGBT",children:"IGBT"}),i.jsx("option",{value:"JFET",children:"JFET"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-polarity-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Polarity:"}),i.jsxs("select",{id:`component-polarity-${n.id}`,value:r.polarity||"NPN",onChange:g=>s({...r,polarity:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"NPN",children:"NPN"}),i.jsx("option",{value:"PNP",children:"PNP"}),i.jsx("option",{value:"N-Channel",children:"N-Channel"}),i.jsx("option",{value:"P-Channel",children:"P-Channel"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:g=>s({...r,voltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 50"}),i.jsx("select",{value:r.voltageUnit||fn("voltage"),onChange:g=>s({...r,voltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:g=>s({...r,current:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:r.currentUnit||fn("current"),onChange:g=>s({...r,currentUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("current").map(g=>i.jsx("option",{value:g,children:g},g))})]})]}),n.componentType==="ResistorNetwork"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-resistance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),i.jsx("input",{id:`component-resistance-${n.id}`,type:"text",value:r.resistance||"",onChange:g=>s({...r,resistance:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 10"}),i.jsx("select",{value:r.resistanceUnit||fn("resistance"),onChange:g=>s({...r,resistanceUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("resistance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-configuration-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Configuration:"}),i.jsx("input",{id:`component-configuration-${n.id}`,type:"text",value:r.configuration||"",onChange:g=>s({...r,configuration:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., Isolated, Bussed"})]})]}),n.componentType==="Thermistor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-resistance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),i.jsx("input",{id:`component-resistance-${n.id}`,type:"text",value:r.resistance||"",onChange:g=>s({...r,resistance:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 10"}),i.jsx("select",{value:r.resistanceUnit||fn("resistance"),onChange:g=>s({...r,resistanceUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("resistance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-thermistortype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Thermistor Type:"}),i.jsxs("select",{id:`component-thermistortype-${n.id}`,value:r.thermistorType||"NTC",onChange:g=>s({...r,thermistorType:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"NTC",children:"NTC (Negative Temperature Coefficient)"}),i.jsx("option",{value:"PTC",children:"PTC (Positive Temperature Coefficient)"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-beta-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Beta ():"}),i.jsx("input",{id:`component-beta-${n.id}`,type:"text",value:r.beta||"",onChange:g=>s({...r,beta:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., 3950"})]})]}),n.componentType==="Transformer"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-primaryvoltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Primary Voltage:"}),i.jsx("input",{id:`component-primaryvoltage-${n.id}`,type:"text",value:r.primaryVoltage||"",onChange:g=>s({...r,primaryVoltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 120"}),i.jsx("select",{value:r.primaryVoltageUnit||fn("voltage"),onChange:g=>s({...r,primaryVoltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-secondaryvoltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Secondary Voltage:"}),i.jsx("input",{id:`component-secondaryvoltage-${n.id}`,type:"text",value:r.secondaryVoltage||"",onChange:g=>s({...r,secondaryVoltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 12"}),i.jsx("select",{value:r.secondaryVoltageUnit||fn("voltage"),onChange:g=>s({...r,secondaryVoltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-power-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),i.jsxs("select",{id:`component-power-${n.id}`,value:r.power||"1/4",onChange:g=>s({...r,power:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"12px"},children:[i.jsx("option",{value:"1/20",children:"1/20 W"}),i.jsx("option",{value:"1/16",children:"1/16 W"}),i.jsx("option",{value:"1/10",children:"1/10 W"}),i.jsx("option",{value:"1/8",children:"1/8 W"}),i.jsx("option",{value:"1/4",children:"1/4 W"}),i.jsx("option",{value:"1/2",children:"1/2 W"}),i.jsx("option",{value:"1",children:"1 W"}),i.jsx("option",{value:"2",children:"2 W"}),i.jsx("option",{value:"3",children:"3 W"}),i.jsx("option",{value:"5",children:"5 W"}),i.jsx("option",{value:"10",children:"10 W"}),i.jsx("option",{value:"25",children:"25 W"}),i.jsx("option",{value:"50",children:"50 W"}),i.jsx("option",{value:"100",children:"100 W"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-turns-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Turns Ratio:"}),i.jsx("input",{id:`component-turns-${n.id}`,type:"text",value:r.turns||"",onChange:g=>s({...r,turns:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., 10:1"})]})]}),n.componentType==="TestPoint"&&i.jsx(i.Fragment,{children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-signal-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Signal:"}),i.jsx("input",{id:`component-signal-${n.id}`,type:"text",value:r.signal||"",onChange:g=>s({...r,signal:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., VCC, GND, CLK"})]})}),(n.componentType==="IntegratedCircuit"||n.componentType==="Semiconductor")&&i.jsxs(i.Fragment,{children:[_&&M&&M.length>0&&(()=>{const g=(J,G,ee)=>ee?"80px":J==="partNumber"||J==="manufacturer"?"150px":J==="description"||J==="operatingTemperature"?"180px":G==="string"&&!J.includes("Unit")?"150px":"120px",ae=J=>{if(J.name==="datasheet"||J.name==="description"||J.name==="operatingTemperature"||_&&(J.name==="manufacturer"||J.name==="partNumber")||J.name==="icType"||_&&!J.name)return null;const G=J.name,ee=`${J.name}Unit`,F=r[G]??n[G]??J.defaultValue??"",$=r[ee]??n[ee]??(J.units&&J.defaultUnit?J.defaultUnit:""),H=we=>{s({...r,[G]:we})},R=we=>{s({...r,[ee]:we})},Z=!!(J.units&&J.units.length>0),Y=g(J.name,J.type,Z);return i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsxs("label",{style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:[J.label,":"]}),J.type==="enum"?i.jsx("select",{value:F,onChange:we=>H(we.target.value),disabled:l,style:{width:Y,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:(J.enumValues||[]).map(we=>i.jsx("option",{value:we,children:we},we))}):i.jsx("input",{type:"text",value:F,onChange:we=>H(we.target.value),disabled:l,style:{width:Y,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:Z?"8px":"0"},placeholder:J.defaultValue!==void 0?String(J.defaultValue):""}),Z&&J.units&&i.jsx("select",{value:$||J.defaultUnit||J.units[0],onChange:we=>R(we.target.value),disabled:l,style:{width:"70px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,flexShrink:0},children:J.units.map(we=>i.jsx("option",{value:we,children:we},we))})]},J.name)},V=M.map(ae).filter(Boolean),E=_?i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsx("label",{htmlFor:`component-ictype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"IC Type:"}),i.jsxs("select",{id:`component-ictype-${n.id}`,value:r.icType||"Other",onChange:J=>s({...r,icType:J.target.value}),disabled:l,style:{width:"150px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Op-Amp",children:"Op-Amp"}),i.jsx("option",{value:"Microcontroller",children:"Microcontroller"}),i.jsx("option",{value:"Microprocessor",children:"Microprocessor"}),i.jsx("option",{value:"Logic",children:"Logic"}),i.jsx("option",{value:"Memory",children:"Memory"}),i.jsx("option",{value:"Voltage Regulator",children:"Voltage Regulator"}),i.jsx("option",{value:"Timer",children:"Timer"}),i.jsx("option",{value:"ADC",children:"ADC (Analog-to-Digital)"}),i.jsx("option",{value:"DAC",children:"DAC (Digital-to-Analog)"}),i.jsx("option",{value:"Comparator",children:"Comparator"}),i.jsx("option",{value:"Transceiver",children:"Transceiver"}),i.jsx("option",{value:"Driver",children:"Driver"}),i.jsx("option",{value:"Amplifier",children:"Amplifier"}),i.jsx("option",{value:"Other",children:"Other"})]})]},"icType"):null,re=V.findIndex(J=>J?.key==="manufacturer");return re>=0&&E?V.splice(re+1,0,E):E&&V.push(E),V})(),N&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsx("label",{htmlFor:`component-ictype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"IC Type:"}),i.jsxs("select",{id:`component-ictype-${n.id}`,value:r.icType||"Other",onChange:g=>s({...r,icType:g.target.value}),disabled:l,style:{width:"150px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},children:[i.jsx("option",{value:"Op-Amp",children:"Op-Amp"}),i.jsx("option",{value:"Microcontroller",children:"Microcontroller"}),i.jsx("option",{value:"Microprocessor",children:"Microprocessor"}),i.jsx("option",{value:"Logic",children:"Logic"}),i.jsx("option",{value:"Memory",children:"Memory"}),i.jsx("option",{value:"Voltage Regulator",children:"Voltage Regulator"}),i.jsx("option",{value:"Timer",children:"Timer"}),i.jsx("option",{value:"ADC",children:"ADC (Analog-to-Digital)"}),i.jsx("option",{value:"DAC",children:"DAC (Digital-to-Analog)"}),i.jsx("option",{value:"Comparator",children:"Comparator"}),i.jsx("option",{value:"Transceiver",children:"Transceiver"}),i.jsx("option",{value:"Driver",children:"Driver"}),i.jsx("option",{value:"Amplifier",children:"Amplifier"}),i.jsx("option",{value:"Other",children:"Other"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsx("label",{htmlFor:`component-packagetype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Package Type:"}),i.jsxs("select",{id:`component-packagetype-${n.id}`,value:r.packageType||"",onChange:g=>s({...r,packageType:g.target.value}),disabled:l,style:{width:"150px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},children:[i.jsx("option",{value:"",children:"-- Select --"}),i.jsx("option",{value:"DIP",children:"DIP"}),i.jsx("option",{value:"PDIP",children:"PDIP"}),i.jsx("option",{value:"SOIC",children:"SOIC"}),i.jsx("option",{value:"QFP",children:"QFP"}),i.jsx("option",{value:"LQFP",children:"LQFP"}),i.jsx("option",{value:"TQFP",children:"TQFP"}),i.jsx("option",{value:"BGA",children:"BGA"}),i.jsx("option",{value:"SSOP",children:"SSOP"}),i.jsx("option",{value:"TSOP",children:"TSOP"}),i.jsx("option",{value:"Various",children:"Various"}),i.jsx("option",{value:"Other",children:"Other"})]})]})]})]}),n.componentType==="VacuumTube"&&i.jsx(i.Fragment,{children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-tubetype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tube Type:"}),i.jsx("input",{id:`component-tubetype-${n.id}`,type:"text",value:r.tubeType||"",onChange:g=>s({...r,tubeType:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., 12AX7, 6L6"})]})}),n.componentType==="VariableResistor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-vrtype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"VR Type:"}),i.jsxs("select",{id:`component-vrtype-${n.id}`,value:r.vrType||"Potentiometer",onChange:g=>s({...r,vrType:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Potentiometer",children:"Potentiometer"}),i.jsx("option",{value:"Rheostat",children:"Rheostat"}),i.jsx("option",{value:"Trimmer",children:"Trimmer"}),i.jsx("option",{value:"Varistor",children:"Varistor"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-resistance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),i.jsx("input",{id:`component-resistance-${n.id}`,type:"text",value:r.resistance||"",onChange:g=>s({...r,resistance:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 10"}),i.jsx("select",{value:r.resistanceUnit||fn("resistance"),onChange:g=>s({...r,resistanceUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("resistance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-power-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),i.jsxs("select",{id:`component-power-${n.id}`,value:r.power||"1/4",onChange:g=>s({...r,power:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"12px"},children:[i.jsx("option",{value:"1/20",children:"1/20 W"}),i.jsx("option",{value:"1/16",children:"1/16 W"}),i.jsx("option",{value:"1/10",children:"1/10 W"}),i.jsx("option",{value:"1/8",children:"1/8 W"}),i.jsx("option",{value:"1/4",children:"1/4 W"}),i.jsx("option",{value:"1/2",children:"1/2 W"}),i.jsx("option",{value:"1",children:"1 W"}),i.jsx("option",{value:"2",children:"2 W"}),i.jsx("option",{value:"3",children:"3 W"}),i.jsx("option",{value:"5",children:"5 W"}),i.jsx("option",{value:"10",children:"10 W"}),i.jsx("option",{value:"25",children:"25 W"}),i.jsx("option",{value:"50",children:"50 W"}),i.jsx("option",{value:"100",children:"100 W"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-taper-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Taper:"}),i.jsxs("select",{id:`component-taper-${n.id}`,value:r.taper||"Linear",onChange:g=>s({...r,taper:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Linear",children:"Linear"}),i.jsx("option",{value:"Logarithmic",children:"Logarithmic"}),i.jsx("option",{value:"Audio",children:"Audio"})]})]})]}),n.componentType==="Crystal"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-frequency-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Frequency:"}),i.jsx("input",{id:`component-frequency-${n.id}`,type:"text",value:r.frequency||"",onChange:g=>s({...r,frequency:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., 16.000 MHz"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-loadcapacitance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Load Capacitance:"}),i.jsx("input",{id:`component-loadcapacitance-${n.id}`,type:"text",value:r.loadCapacitance||"",onChange:g=>s({...r,loadCapacitance:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., 18pF"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-tolerance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),i.jsxs("select",{id:`component-tolerance-${n.id}`,value:r.tolerance||"10ppm",onChange:g=>s({...r,tolerance:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"10ppm",children:"10ppm"}),i.jsx("option",{value:"20ppm",children:"20ppm"}),i.jsx("option",{value:"30ppm",children:"30ppm"}),i.jsx("option",{value:"50ppm",children:"50ppm"}),i.jsx("option",{value:"100ppm",children:"100ppm"})]})]})]}),n.componentType==="GenericComponent"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-generictype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Type:"}),i.jsxs("select",{id:`component-generictype-${n.id}`,value:n.genericType||"Attenuator",onChange:g=>s({...r,genericType:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Attenuator",children:"Attenuator"}),i.jsx("option",{value:"CircuitBreaker",children:"Circuit Breaker"}),i.jsx("option",{value:"Thermocouple",children:"Thermocouple"}),i.jsx("option",{value:"Tuner",children:"Tuner"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:g=>s({...r,voltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 50"}),i.jsx("select",{value:r.voltageUnit||fn("voltage"),onChange:g=>s({...r,voltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:g=>s({...r,current:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:r.currentUnit||fn("current"),onChange:g=>s({...r,currentUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:or("current").map(g=>i.jsx("option",{value:g,children:g},g))})]}),n.genericType==="Tuner"&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-frequency-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Frequency:"}),i.jsx("input",{id:`component-frequency-${n.id}`,type:"text",value:r.frequency||"",onChange:g=>s({...r,frequency:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., 100MHz"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-power-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),i.jsx("input",{id:`component-power-${n.id}`,type:"text",value:r.power||"",onChange:g=>s({...r,power:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., 1W"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-model-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Model:"}),i.jsx("input",{id:`component-model-${n.id}`,type:"text",value:r.model||"",onChange:g=>s({...r,model:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"Part number or model"})]})]})]}):i.jsx("div",{style:{padding:"8px",background:"#fff3cd",border:"1px solid #ffeeba",borderRadius:4,color:"#856404",marginBottom:"8px",fontSize:"11px"},children:"Component definition missing for this instance. Using legacy fields. Please ensure the component has a definition in componentDefinitions.json and a valid componentDefinitionKey."})};typeof window<"u"&&sx();const dw=n=>{const r=s0[n];return!r||!r.prefix||r.prefix.length<1?"?":r.prefix[0].substring(0,1).toUpperCase()},fw=({componentEditor:n,componentDefinition:r,setComponentEditor:o,componentsTop:s,componentsBottom:l,setComponentsTop:d,setComponentsBottom:b,connectingPin:p,setConnectingPin:v,componentDialogPosition:m,setComponentDialogPosition:C,isDraggingDialog:D,setIsDraggingDialog:M,dialogDragOffset:S,setDialogDragOffset:U,areComponentsLocked:_,setSelectedComponentIds:N,setNotesDialogVisible:g,projectDirHandle:ae,showGeminiSettingsDialog:V=!1,onGeminiSettingsDialogClose:E,onFindComponent:re})=>{const[J,G]=L.useState(!1),[ee,F]=L.useState(null),[$,H]=L.useState(!1),[R,Z]=L.useState(!1),[Y,we]=L.useState(null),[te,de]=L.useState(!1),[je,Ie]=L.useState(!1),[xe,k]=L.useState(""),[A,q]=L.useState(()=>typeof window<"u"?af().provider:"gemini"),[W,se]=L.useState(()=>typeof window<"u"&&Yc().getApiKey()||""),[Ce,le]=L.useState(()=>typeof window<"u"?Yc().getModel():"gemini-2.0-flash"),[_e,be]=L.useState(()=>typeof window<"u"?W2():"sessionStorage"),[De,Ge]=L.useState(()=>typeof window<"u"?Yc().hasApiKey():!1);L.useEffect(()=>{if(V){if(typeof window<"u"){const ze=af();q(ze.provider),be(ze.apiKeyStorageType);const Nt=Yc(),Ke=Nt.getApiKey(),vt=Nt.getModel();se(Ke||""),le(vt),Ge(!!Ke)}const ye=setTimeout(()=>{Z(!0)},0);return()=>clearTimeout(ye)}},[V]),L.useEffect(()=>{if(typeof window<"u"){const ye=Yc();Ge(ye.hasApiKey()||!!W.trim())}},[W,A]),L.useEffect(()=>{if(n){const ze=(n.layer==="top"?s:l).find(Nt=>Nt.id===n.id);if(ze){const Nt=ze.customGeminiPrompt;k(Nt||"")}}},[n?.id,s,l]);const ot=()=>{if(typeof window<"u"){vh({provider:A,model:Ce,apiKeyStorageType:_e}),$2(_e),D1(A);const ye=Yc(),ze=Hs[A];if(W.trim()){ye.saveApiKey(W.trim(),_e),ye.saveModel(Ce),Ge(!0);const Nt=_e==="sessionStorage"?"Note: The API key will be cleared when you close the browser tab.":"Note: The API key will persist until you remove it.";xn({visible:!0,title:"Settings Saved",message:`${ze.name} API key and model (${Ce}) saved! You can now use the "Extract Datasheet Information" feature. ${Nt}`,type:"success"})}else ye.removeApiKey(),ye.saveModel(Ce),Ge(!1),xn({visible:!0,title:"API Key Removed",message:"API key removed. Model preference saved.",type:"info"})}},jt=()=>{typeof window<"u"&&Yc().removeApiKey(),se(""),Ge(!1),xn({visible:!0,title:"API Key Removed",message:"API key has been removed. You will need to enter it again to use AI features.",type:"info"})},Ht=ye=>{q(ye),D1(ye);const ze=Yc();se(ze.getApiKey()||""),le(ze.getModel()),Ge(ze.hasApiKey())},ge=()=>{const ye=n?.designator?.trim().toUpperCase();if(!ye)return;const Nt=[...s,...l].filter(vt=>vt.designator?.trim().toUpperCase()===ye);if(Nt.length===0)return;if(re&&Nt.length>0){const vt=Nt[0];re(vt.id,vt.x,vt.y)}const Ke=new Set(Nt.map(vt=>vt.id));N(Ke)},lt=ye=>`You are analyzing an electronic component datasheet PDF. Extract pin information, component properties, a datasheet summary, IC type, and pin count, then return the data as a JSON object.

Requirements:
1. Return a JSON object with three sections: "pins", "properties", and "summary"
2. First, determine the total number of pins (pinCount) for this component from the datasheet. This should be a positive integer representing the total number of pins/pads on the component.
3. For pins, extract information for ALL pins found in the datasheet (not just a subset). For each pin, provide:
   - pinNumber: The pin number (1, 2, 3, etc.)
   - pinName: The signal name (e.g., VCC, GND, IN+, OUT, etc.). Use the exact name from the datasheet.
   - pinDescription: A brief description of the pin's function (optional, can be empty string)
   - pinType: The pin type (optional): "input", "output", "bidirectional", "power", "ground", "no_connect", or "passive". Only include if clearly identifiable from the datasheet.
   - alternateFunctions: An array of alternate function names for this pin (optional, only if the pin has multiple functions). For example, a microcontroller GPIO pin might have ["SPI_MOSI", "I2C_SDA"] as alternate functions.
4. For component properties, extract the following information if available in the datasheet:
${ye.map(ze=>ze.hasUnits?`   - ${ze.name}: The ${ze.label.toLowerCase()} value (as a number) and ${ze.name}Unit: The unit (one of: ${ze.units.join(", ")})`:ze.type==="enum"?`   - ${ze.name}: The ${ze.label.toLowerCase()} (as a string)`:`   - ${ze.name}: The ${ze.label.toLowerCase()} (as a string or number, depending on the field type)`).join(`
`)}
5. For IC Type (icType), determine the type of integrated circuit from the datasheet. Choose from: "Op-Amp", "Microcontroller", "Microprocessor", "Logic", "Memory", "Voltage Regulator", "Timer", "ADC", "DAC", "Comparator", "Transceiver", "Driver", "Amplifier", or "Other". If it's clearly an op amp, use "Op-Amp". If it's clearly a microcontroller, use "Microcontroller", etc.
6. For Package Type (packageType), determine the package type from the datasheet. Choose from: "DIP", "PDIP", "SOIC", "QFP", "LQFP", "TQFP", "BGA", "SSOP", "TSOP", "Various", or "Other". If multiple package types are mentioned in the datasheet, use "Various". If it's a plastic DIP, use "PDIP". If it's a standard DIP, use "DIP".
7. For pin count (pinCount), determine the total number of pins/pads on the component from the datasheet. This should be a positive integer. Include this in the properties section.
8. For datasheet summary (datasheetSummary), provide a concise summary (2-4 sentences) of the introductory information from the datasheet, including what the component is, its main purpose, and key features mentioned in the introduction or overview section.
9. Only include properties that are actually found in the datasheet - do not make up values
10. For numeric fields with units, extract both the numeric value and the appropriate unit
11. Return ONLY valid JSON, no additional text, explanations, or markdown formatting

Example JSON format:
{
  "pins": [
    {"pinNumber": 1, "pinName": "VCC", "pinDescription": "Power supply positive", "pinType": "power"},
    {"pinNumber": 2, "pinName": "GND", "pinDescription": "Ground", "pinType": "ground"},
    {"pinNumber": 3, "pinName": "IN+", "pinDescription": "Non-inverting input", "pinType": "input"},
    {"pinNumber": 4, "pinName": "IN-", "pinDescription": "Inverting input", "pinType": "input"},
    {"pinNumber": 5, "pinName": "OUT", "pinDescription": "Output", "pinType": "output"},
    {"pinNumber": 6, "pinName": "GPIO1", "pinDescription": "General purpose I/O", "pinType": "bidirectional", "alternateFunctions": ["SPI_MOSI", "I2C_SDA"]}
  ],
  "properties": {
    "partNumber": "LM358",
    "manufacturer": "Texas Instruments",
    "voltage": 36,
    "voltageUnit": "V",
    "description": "Dual operational amplifier",
    "icType": "Op-Amp",
    "packageType": "PDIP",
    "pinCount": 5
  },
  "summary": {
    "datasheetSummary": "The LM358 is a dual operational amplifier featuring low power consumption and wide supply voltage range. It is designed for single supply operation from 3V to 32V or dual supplies from 1.5V to 16V. The device offers high gain bandwidth product and low input offset voltage."
  }
}

Analyze the attached PDF datasheet and extract the information according to the requirements above.`,[Yt,Gt]=L.useState(()=>{const ye=localStorage.getItem("componentDialogSize");if(ye)try{return JSON.parse(ye)}catch{return{width:350,height:window.innerHeight*.4}}return{width:350,height:window.innerHeight*.4}}),[xt,hn]=L.useState(!1),[Et,gn]=L.useState({x:0,y:0,width:0,height:0}),[Zt,xn]=L.useState({visible:!1,title:"",message:"",type:"info"}),tt=Pt.useMemo(()=>{if(!n||!n.visible)return null;let ye=s.find(ze=>ze.id===n.id);return ye||(ye=l.find(ze=>ze.id===n.id)),ye||null},[n,s,l]);Pt.useEffect(()=>{if(!tt){F(null);return}const ye=tt.id,ze=tt.componentType,Nt=tt.componentType;if(!ze){console.error("[ComponentEditor useEffect] Component missing componentType:",{comp:tt,componentId:ye}),F(null);return}if(ze==="IntegratedCircuit"||Nt==="Semiconductor"){const Ke=tt;F(null),n&&o({...n,datasheetFileName:Ke.datasheetFileName||void 0})}else F(null)},[tt?.id,tt?.componentType,tt?.datasheetFileName]),L.useEffect(()=>{if(!xt)return;const ye=Nt=>{const Ke=Nt.clientX-Et.x,vt=Nt.clientY-Et.y,Vt=Math.max(350,Math.min(window.innerWidth-20,Et.width+Ke)),ht=Math.max(200,Math.min(window.innerHeight-20,Et.height+vt)),Je={width:Vt,height:ht};Gt(Je),localStorage.setItem("componentDialogSize",JSON.stringify(Je))},ze=()=>{hn(!1)};return document.addEventListener("mousemove",ye),document.addEventListener("mouseup",ze),()=>{document.removeEventListener("mousemove",ye),document.removeEventListener("mouseup",ze)}},[xt,Et]);const Rn=ye=>{ye.preventDefault(),ye.stopPropagation(),hn(!0),gn({x:ye.clientX,y:ye.clientY,width:Yt.width,height:Yt.height})};if(!n||!n.visible)return i.jsxs(i.Fragment,{children:[R&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10005},onClick:ye=>{ye.target===ye.currentTarget&&(Z(!1),E?.())},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"520px",maxWidth:"620px",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:ye=>ye.stopPropagation(),children:[i.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:"AI Service Configuration"}),i.jsx("button",{onClick:()=>{Z(!1),E?.()},style:{background:"transparent",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:0,width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center"},title:"Close",children:""})]}),i.jsxs("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"14px",lineHeight:"1.6"},children:[i.jsx("p",{style:{margin:"0 0 16px 0"},children:"Extract datasheet information for components  avoiding manual data entry. Choose your preferred AI service below."}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#fff",fontSize:"13px",fontWeight:600},children:"AI Service Provider:"}),i.jsx("select",{value:A,onChange:ye=>Ht(ye.target.value),style:{width:"100%",padding:"8px 12px",fontSize:"13px",border:"1px solid #555",borderRadius:"4px",background:"#1f1f24",color:"#fff",boxSizing:"border-box",cursor:"pointer"},children:_1.map(ye=>i.jsx("option",{value:ye,children:Hs[ye].name},ye))}),i.jsx("p",{style:{margin:"6px 0 0 0",color:"#aaa",fontSize:"12px",lineHeight:"1.4"},children:Hs[A].description})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsxs("label",{style:{display:"block",marginBottom:"6px",color:"#fff",fontSize:"13px",fontWeight:600},children:[Hs[A].name," API Key:"]}),i.jsx("input",{type:"password",value:W,onChange:ye=>se(ye.target.value),placeholder:Hs[A].apiKeyPlaceholder,style:{width:"100%",padding:"8px 12px",fontSize:"13px",border:"1px solid #555",borderRadius:"4px",background:"#1f1f24",color:"#fff",boxSizing:"border-box"},autoFocus:!0}),i.jsxs("p",{style:{margin:"6px 0 0 0",color:"#aaa",fontSize:"12px"},children:["Get your API key from:"," ",i.jsx("a",{href:Hs[A].apiKeyHelpUrl,target:"_blank",rel:"noopener noreferrer",style:{color:"#4CAF50"},children:Hs[A].apiKeyHelpUrl})]})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#fff",fontSize:"13px",fontWeight:600},children:"Model:"}),i.jsx("select",{value:Ce,onChange:ye=>le(ye.target.value),style:{width:"100%",padding:"8px 12px",fontSize:"13px",border:"1px solid #555",borderRadius:"4px",background:"#1f1f24",color:"#fff",boxSizing:"border-box",cursor:"pointer"},children:Hs[A].models.map(ye=>i.jsxs("option",{value:ye.id,children:[ye.name," ",ye.description?`(${ye.description})`:""]},ye.id))})]}),i.jsxs("div",{style:{marginBottom:"16px",padding:"12px",background:"#1f1f24",borderRadius:"4px",border:"1px solid #444"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#fff",fontSize:"13px",fontWeight:600},children:"API Key Storage:"}),i.jsxs("div",{style:{display:"flex",gap:"16px"},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",cursor:"pointer",color:"#ddd",fontSize:"13px"},children:[i.jsx("input",{type:"radio",name:"storageType",value:"sessionStorage",checked:_e==="sessionStorage",onChange:()=>be("sessionStorage"),style:{cursor:"pointer"}}),"Session Storage"]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",cursor:"pointer",color:"#ddd",fontSize:"13px"},children:[i.jsx("input",{type:"radio",name:"storageType",value:"localStorage",checked:_e==="localStorage",onChange:()=>be("localStorage"),style:{cursor:"pointer"}}),"Local Storage"]})]}),i.jsx("p",{style:{margin:"8px 0 0 0",color:_e==="sessionStorage"?"#4CAF50":"#ffaa00",fontSize:"12px",lineHeight:"1.4"},children:_e==="sessionStorage"?" Session Storage: API key is cleared when you close the browser tab (more secure)":" Local Storage: API key persists until you remove it (more convenient)"})]}),i.jsx("div",{style:{padding:"10px",background:"#1a1a1f",borderRadius:"4px",border:"1px solid #333"},children:i.jsxs("p",{style:{margin:"0",color:"#aaa",fontSize:"11px",lineHeight:"1.4"},children:[i.jsx("strong",{style:{color:"#ffaa00"},children:" Security:"})," API keys are stored in plain text in browser storage and are accessible via DevTools. Do not use on shared computers. Consider using API key restrictions from your provider."]})})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"8px"},children:[i.jsx("button",{onClick:jt,disabled:!De,style:{padding:"8px 16px",background:De?"#d32f2f":"#444",color:"#fff",border:"1px solid #666",borderRadius:6,cursor:De?"pointer":"not-allowed",fontSize:"14px",fontWeight:600,opacity:De?1:.5},title:De?"Remove API key":"No API key stored",children:"Remove Key"}),i.jsxs("div",{style:{display:"flex",gap:"8px"},children:[i.jsx("button",{onClick:()=>{Z(!1),E?.()},style:{padding:"8px 16px",background:"#555",color:"#fff",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Cancel"}),i.jsx("button",{onClick:()=>{ot(),Z(!1),E?.()},style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Save Settings"})]})]})]})}),i.jsx(Zy,{visible:Zt.visible,title:Zt.title,message:Zt.message,type:Zt.type,onClose:()=>{xn({visible:!1,title:"",message:"",type:"info"})},onShowResponse:Zt.onShowResponse})]});if(!tt)return console.error("[ComponentEditor] Component not found:",{componentId:n.id,componentsTopCount:s.length,componentsBottomCount:l.length}),null;if(!tt.id||!tt.componentType||typeof tt.pinCount!="number")return console.error("[ComponentEditor] Component missing required properties:",{componentId:tt.id,hasComponentType:!!tt.componentType,componentType:tt.componentType,pinCount:tt.pinCount,pinCountType:typeof tt.pinCount,component:tt}),null;let Lt="top";s.find(ye=>ye.id===n.id)||(Lt="bottom"),n.layer!==Lt&&o({...n,layer:Lt});const Wt=ye=>{const ze={...ye};console.log("[ComponentEditor] updateComponent - Entry:",{componentId:ye.id,componentType:ye.componentType});const Nt=n.designator?.trim()||"";ze.designator=Nt,ze.x=n.x,ze.y=n.y,ze.layer=n.layer,ze.orientation=n.orientation??0;const Ke=Nt.length>0?Nt.charAt(0).toUpperCase():dw(ye.componentType);if(ze.abbreviation=Ke,n.manufacturer!==void 0&&(ze.manufacturer=n.manufacturer?.trim()||void 0),n.partNumber!==void 0&&(ze.partNumber=n.partNumber?.trim()||void 0),n.pinCount!==ye.pinCount){ze.pinCount=n.pinCount;const vt=ye.pinConnections||[];if(ze.pinConnections=new Array(n.pinCount).fill("").map((Vt,ht)=>ht<vt.length?vt[ht]:""),ye.pinPolarities){const Vt=ye.pinPolarities||[];ze.pinPolarities=new Array(n.pinCount).fill("").map((ht,Je)=>Je<Vt.length?Vt[Je]:"")}if(ye.pinData&&Array.isArray(ye.pinData)){const Vt=ye.pinData;ze.pinData=new Array(n.pinCount).fill(null).map((ht,Je)=>Je<Vt.length&&Vt[Je]?Vt[Je]:{name:""})}if(ye.pinNames){const Vt=ye.pinNames||[];ze.pinNames=new Array(n.pinCount).fill("").map((ht,Je)=>Je<Vt.length?Vt[Je]:"")}}else ze.pinConnections=ye.pinConnections||[],ye.pinPolarities&&(ze.pinPolarities=ye.pinPolarities),ye.pinData&&(ze.pinData=ye.pinData),ye.pinNames&&(ze.pinNames=ye.pinNames);return ye.componentType==="Resistor"?(ze.resistance=n.resistance!==void 0?n.resistance:void 0,ze.resistanceUnit=n.resistanceUnit!==void 0?n.resistanceUnit:void 0,ze.power=n.power?`${n.power}W`:void 0,ze.tolerance=n.tolerance!==void 0?n.tolerance:void 0):ye.componentType==="Capacitor"?(ze.capacitance=n.capacitance!==void 0?n.capacitance:void 0,ze.capacitanceUnit=n.capacitanceUnit!==void 0?n.capacitanceUnit:void 0,ze.voltage=n.voltage!==void 0?n.voltage:void 0,ze.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,ze.tolerance=n.tolerance!==void 0?n.tolerance:void 0,ze.dielectric=n.dielectric!==void 0?n.dielectric:void 0):ye.componentType==="Electrolytic Capacitor"?(ze.capacitance=n.capacitance!==void 0?n.capacitance:void 0,ze.capacitanceUnit=n.capacitanceUnit!==void 0?n.capacitanceUnit:void 0,ze.voltage=n.voltage!==void 0?n.voltage:void 0,ze.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,ze.tolerance=n.tolerance!==void 0?n.tolerance:void 0,ze.esr=n.esr!==void 0?n.esr:void 0,ze.esrUnit=n.esrUnit!==void 0?n.esrUnit:void 0,ze.temperature=n.temperature!==void 0?n.temperature:void 0):ye.componentType==="Film Capacitor"?(ze.capacitance=n.capacitance!==void 0?n.capacitance:void 0,ze.capacitanceUnit=n.capacitanceUnit!==void 0?n.capacitanceUnit:void 0,ze.voltage=n.voltage!==void 0?n.voltage:void 0,ze.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,ze.tolerance=n.tolerance!==void 0?n.tolerance:void 0,ze.filmType=n.filmType||void 0):ye.componentType==="Diode"?(ze.diodeType=n.diodeType||ye.diodeType||"Standard",ze.voltage=n.voltage!==void 0?n.voltage:void 0,ze.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,ze.current=n.current!==void 0?n.current:void 0,ze.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0,ze.ledColor=n.ledColor!==void 0?n.ledColor:void 0):ye.componentType==="Battery"?(ze.voltage=n.voltage!==void 0?n.voltage:void 0,ze.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,ze.capacity=n.capacity!==void 0?n.capacity:void 0,ze.capacityUnit=n.capacityUnit!==void 0?n.capacityUnit:void 0,ze.chemistry=n.chemistry!==void 0?n.chemistry:void 0):ye.componentType==="Fuse"?(ze.current=n.current!==void 0?n.current:void 0,ze.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0,ze.voltage=n.voltage!==void 0?n.voltage:void 0,ze.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,ze.fuseType=n.fuseType!==void 0?n.fuseType:void 0):ye.componentType==="FerriteBead"?(ze.impedance=n.impedance!==void 0?n.impedance:void 0,ze.impedanceUnit=n.impedanceUnit!==void 0?n.impedanceUnit:void 0,ze.current=n.current!==void 0?n.current:void 0,ze.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0):ye.componentType==="Connector"?(ze.connectorType=n.connectorType||void 0,ze.gender=n.gender||void 0):ye.componentType==="Jumper"?ze.positions=n.positions||void 0:ye.componentType==="Relay"?(ze.coilVoltage=n.coilVoltage!==void 0?n.coilVoltage:void 0,ze.coilVoltageUnit=n.coilVoltageUnit!==void 0?n.coilVoltageUnit:void 0,ze.contactType=n.contactType!==void 0?n.contactType:void 0,ze.current=n.current!==void 0?n.current:void 0,ze.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0):ye.componentType==="Inductor"?(ze.inductance=n.inductance!==void 0?n.inductance:void 0,ze.inductanceUnit=n.inductanceUnit!==void 0?n.inductanceUnit:void 0,ze.current=n.current!==void 0?n.current:void 0,ze.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0,ze.resistance=n.resistance!==void 0?n.resistance:void 0,ze.resistanceUnit=n.resistanceUnit!==void 0?n.resistanceUnit:void 0):ye.componentType==="Speaker"?(ze.impedance=n.impedance!==void 0?n.impedance:void 0,ze.impedanceUnit=n.impedanceUnit!==void 0?n.impedanceUnit:void 0,ze.power=n.power?`${n.power}W`:void 0):ye.componentType==="Motor"?(ze.motorType=n.motorType!==void 0?n.motorType:void 0,ze.voltage=n.voltage!==void 0?n.voltage:void 0,ze.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,ze.current=n.current!==void 0?n.current:void 0,ze.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0):ye.componentType==="PowerSupply"?(ze.inputVoltage=n.inputVoltage!==void 0?n.inputVoltage:void 0,ze.inputVoltageUnit=n.inputVoltageUnit!==void 0?n.inputVoltageUnit:void 0,ze.outputVoltage=n.outputVoltage!==void 0?n.outputVoltage:void 0,ze.outputVoltageUnit=n.outputVoltageUnit!==void 0?n.outputVoltageUnit:void 0,ze.current=n.current!==void 0?n.current:void 0,ze.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0):ye.componentType==="Transistor"?(ze.transistorType=n.transistorType!==void 0?n.transistorType:void 0,ze.polarity=n.polarity!==void 0?n.polarity:void 0,ze.voltage=n.voltage!==void 0?n.voltage:void 0,ze.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,ze.current=n.current!==void 0?n.current:void 0,ze.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0):ye.componentType==="ResistorNetwork"?(ze.resistance=n.resistance!==void 0?n.resistance:void 0,ze.resistanceUnit=n.resistanceUnit!==void 0?n.resistanceUnit:void 0,ze.configuration=n.configuration||void 0):ye.componentType==="Thermistor"?(ze.resistance=n.resistance!==void 0?n.resistance:void 0,ze.resistanceUnit=n.resistanceUnit!==void 0?n.resistanceUnit:void 0,ze.thermistorType=n.thermistorType||void 0,ze.beta=n.beta||void 0):ye.componentType==="Switch"?(ze.switchType=n.switchType!==void 0?n.switchType:void 0,ze.current=n.current!==void 0?n.current:void 0,ze.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0,ze.voltage=n.voltage!==void 0?n.voltage:void 0,ze.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0):ye.componentType==="Transformer"?(ze.primaryVoltage=n.primaryVoltage!==void 0?n.primaryVoltage:void 0,ze.primaryVoltageUnit=n.primaryVoltageUnit!==void 0?n.primaryVoltageUnit:void 0,ze.secondaryVoltage=n.secondaryVoltage!==void 0?n.secondaryVoltage:void 0,ze.secondaryVoltageUnit=n.secondaryVoltageUnit!==void 0?n.secondaryVoltageUnit:void 0,ze.power=n.power?`${n.power}W`:void 0,ze.turns=n.turns||void 0):ye.componentType==="TestPoint"?ze.signal=n.signal||void 0:ye.componentType==="Film Capacitor"?(ze.capacitance=n.capacitance!==void 0?n.capacitance:void 0,ze.capacitanceUnit=n.capacitanceUnit!==void 0?n.capacitanceUnit:void 0,ze.voltage=n.voltage!==void 0?n.voltage:void 0,ze.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,ze.tolerance=n.tolerance!==void 0?n.tolerance:void 0,ze.filmType=n.filmType||void 0):ye.componentType==="IntegratedCircuit"||ye.componentType==="Semiconductor"?(ze.description=n.description?.trim()||void 0,ye.componentType==="Semiconductor"&&(ze.componentType="IntegratedCircuit"),ze.icType=n.icType||void 0,ze.manufacturer=n.manufacturer?.trim()||void 0,ze.partNumber=n.partNumber?.trim()||void 0,ze.operatingTemperature=n.operatingTemperature?.trim()||void 0,ze.packageType=n.packageType||void 0,n.datasheetFileName?ze.datasheetFileName=n.datasheetFileName:ze.datasheetFileName=void 0):ze.description=n.description?.trim()||void 0,ye.componentType==="VacuumTube"?ze.tubeType=n.tubeType||void 0:ye.componentType==="VariableResistor"?(ze.vrType=n.vrType!==void 0?n.vrType:void 0,ze.resistance=n.resistance!==void 0?n.resistance:void 0,ze.resistanceUnit=n.resistanceUnit!==void 0?n.resistanceUnit:void 0,ze.power=n.power?`${n.power}W`:void 0,ze.taper=n.taper||void 0):ye.componentType==="Crystal"?(ze.frequency=n.frequency!==void 0?n.frequency:void 0,ze.loadCapacitance=n.loadCapacitance!==void 0?n.loadCapacitance:void 0,ze.tolerance=n.tolerance!==void 0?n.tolerance:void 0):ye.componentType==="GenericComponent"&&(ze.genericType=n.genericType||"Attenuator",ze.voltage=n.voltage!==void 0?n.voltage:void 0,ze.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,ze.current=n.current!==void 0?n.current:void 0,ze.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0,ze.power=n.power||void 0,ze.frequency=n.frequency||void 0,ze.model=n.model||void 0),ze},vn=()=>{if(_){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const ye=s.find(Ke=>Ke.id===n.id),ze=l.find(Ke=>Ke.id===n.id),Nt=ye||ze;if(Nt){Nt.componentType==="IntegratedCircuit"&&console.log("[ComponentEditor] handleSave - Before updateComponent call:",{componentDatasheet:Nt.datasheet,editorDatasheet:n.datasheet,editorDatasheetType:typeof n.datasheet,editorDatasheetLength:n.datasheet?.length,fullEditor:n}),console.log("[ComponentEditor] handleSave - componentEditor state before update:",{resistance:n.resistance,resistanceUnit:n.resistanceUnit,capacitance:n.capacitance,capacitanceUnit:n.capacitanceUnit,componentType:Nt.componentType});const Ke=Wt(Nt);console.log("[ComponentEditor] handleSave - updatedComp after save:",{resistance:Ke.resistance,resistanceUnit:Ke.resistanceUnit,capacitance:Ke.capacitance,capacitanceUnit:Ke.capacitanceUnit,componentType:Ke.componentType}),Nt.componentType==="IntegratedCircuit"&&console.log("[ComponentEditor] handleSave - After updateComponent call:",{updatedComponentDatasheet:Ke.datasheet,updatedComponentDatasheetType:typeof Ke.datasheet});const vt=Nt.layer,Vt=n.layer;vt!==Vt?vt==="top"?(d(ht=>ht.filter(Je=>Je.id!==n.id)),b(ht=>[...ht,Ke])):(b(ht=>ht.filter(Je=>Je.id!==n.id)),d(ht=>[...ht,Ke])):Vt==="top"?d(ht=>{const Je=ht.map(At=>At.id===n.id?(console.log("[ComponentEditor] Updating component in top array - datasheet:",Ke.datasheet),(Ke.componentType==="Resistor"||Ke.componentType==="Capacitor")&&console.log("[ComponentEditor] Updated component values:",{resistance:Ke.resistance,resistanceUnit:Ke.resistanceUnit,capacitance:Ke.capacitance,capacitanceUnit:Ke.capacitanceUnit}),Ke):At),Ft=Je.find(At=>At.id===n.id);return Ft&&(Ft.componentType==="IntegratedCircuit"&&console.log("[ComponentEditor] After state update - component datasheet in array:",Ft.datasheet),(Ft.componentType==="Resistor"||Ft.componentType==="Capacitor")&&console.log("[ComponentEditor] After state update - component values in array:",{resistance:Ft.resistance,resistanceUnit:Ft.resistanceUnit,capacitance:Ft.capacitance,capacitanceUnit:Ft.capacitanceUnit})),Je}):b(ht=>{const Je=ht.map(At=>At.id===n.id?(console.log("[ComponentEditor] Updating component in bottom array - datasheet:",Ke.datasheet),(Ke.componentType==="Resistor"||Ke.componentType==="Capacitor")&&console.log("[ComponentEditor] Updated component values:",{resistance:Ke.resistance,resistanceUnit:Ke.resistanceUnit,capacitance:Ke.capacitance,capacitanceUnit:Ke.capacitanceUnit}),Ke):At),Ft=Je.find(At=>At.id===n.id);return Ft&&(Ft.componentType==="IntegratedCircuit"&&console.log("[ComponentEditor] After state update - component datasheet in array:",Ft.datasheet),(Ft.componentType==="Resistor"||Ft.componentType==="Capacitor")&&console.log("[ComponentEditor] After state update - component values in array:",{resistance:Ft.resistance,resistanceUnit:Ft.resistanceUnit,capacitance:Ft.capacitance,capacitanceUnit:Ft.capacitanceUnit})),Je})}else if(console.warn(`Component ${n.id} not found in either layer array`),n.layer==="top"){const Ke=l.find(vt=>vt.id===n.id);if(Ke){const vt=Wt(Ke);b(Vt=>Vt.filter(ht=>ht.id!==n.id)),d(Vt=>[...Vt,vt])}}else{const Ke=s.find(vt=>vt.id===n.id);if(Ke){const vt=Wt(Ke);d(Vt=>Vt.filter(ht=>ht.id!==n.id)),b(Vt=>[...Vt,vt])}}o(null),v(null)},ct=async()=>{if(!Yc().hasApiKey()){Z(!0);return}const ze=tt?.datasheetFileName;if(!ee&&(!ae||!ze)){xn({visible:!0,title:"Datasheet Required",message:"Please choose a datasheet file before extracting information.",type:"info"});return}G(!0);try{let Nt,Ke;if(ee)Nt=await ee.arrayBuffer(),Ke=ee.size;else if(ae&&ze){const Ot=ze.split("/");let Dt=ae;for(let bn=0;bn<Ot.length-1;bn++){const ni=Ot[bn];try{Dt=await Dt.getDirectoryHandle(ni)}catch{const Di=ni==="datasheets"?"Datasheets":ni==="Datasheets"?"datasheets":ni;try{Dt=await Dt.getDirectoryHandle(Di)}catch{throw new Error(`Directory '${ni}' not found in project folder.`)}}}const rn=await(await Dt.getFileHandle(Ot[Ot.length-1])).getFile();Nt=await rn.arrayBuffer(),Ke=rn.size}else throw new Error("No datasheet file available");const vt=20*1024*1024;if(Ke>vt){const Ot=(Ke/1048576).toFixed(2);throw new Error(`PDF file is too large (${Ot} MB). Maximum file size is 20 MB. Please use a smaller file or split the datasheet.`)}const Vt=await new Promise((Ot,Dt)=>{const an=new Blob([Nt],{type:"application/pdf"}),rn=new FileReader;rn.onloadend=()=>{const ni=rn.result.split(",")[1];if(!ni){Dt(new Error("Failed to extract base64 data from FileReader result"));return}Ot(ni)},rn.onerror=()=>Dt(new Error("FileReader failed to read PDF file")),rn.readAsDataURL(an)}),Je=(n.layer==="top"?s:l).find(Ot=>Ot.id===n.id);if(!Je)throw new Error("Component not found");const Jt=((r||$l(Je))?.fields||[]).filter(Ot=>Ot.name!=="datasheet").map(Ot=>({name:Ot.name,label:Ot.label,type:Ot.type,hasUnits:!!(Ot.units&&Ot.units.length>0),units:Ot.units||[]}));let An;const dn=Je.customGeminiPrompt;dn&&dn.trim()?An=dn:An=lt(Jt);const ti=Yc(),Tr=Hs[af().provider],en=await ti.extractFromPDF({prompt:An,pdfBase64:Vt,mimeType:"application/pdf"});if(!en.success)throw we(null),new Error(en.error||`${Tr.name} API error`);let zi=en.text||"";if(!zi)throw we(null),new Error(`No response text from ${Tr.name} API. The API may have returned an empty response.`);we(zi),zi=zi.replace(/^```[\w]*\n?/gm,"").replace(/\n?```$/gm,"");let qt;try{qt=JSON.parse(zi)}catch(Ot){throw new Error(`Failed to parse JSON response from Gemini API: ${Ot instanceof Error?Ot.message:"Unknown error"}`)}if(!qt||typeof qt!="object")throw new Error("Invalid JSON response from Gemini API: expected an object");let Zi=n.pinCount;if(qt.properties&&typeof qt.properties=="object"&&qt.properties.pinCount){const Ot=parseInt(String(qt.properties.pinCount),10);!isNaN(Ot)&&Ot>0&&(Zi=Ot)}else if(qt.pins&&Array.isArray(qt.pins)){let Ot=0;for(const Dt of qt.pins)if(Dt&&typeof Dt=="object"&&Dt.pinNumber){const an=parseInt(String(Dt.pinNumber),10);!isNaN(an)&&an>Ot&&(Ot=an)}Ot>0&&(Zi=Ot)}const Ji=new Array(Zi).fill(null).map(()=>({name:""}));let Cr=0;if(qt.pins&&Array.isArray(qt.pins)){for(const Ot of qt.pins)if(Ot&&typeof Ot=="object"&&Ot.pinNumber&&Ot.pinName){const Dt=parseInt(String(Ot.pinNumber),10);if(!isNaN(Dt)&&Dt>=1&&Dt<=Zi){const an=Dt-1;Ji[an]={name:String(Ot.pinName).trim(),type:Ot.pinType&&String(Ot.pinType).trim()?String(Ot.pinType).trim():void 0,alternate_functions:Ot.alternateFunctions&&Array.isArray(Ot.alternateFunctions)&&Ot.alternateFunctions.length>0?Ot.alternateFunctions.map(rn=>String(rn).trim()).filter(rn=>rn!==""):void 0},Cr++}}}if(Cr===0)throw new Error("Could not parse any pin information from the JSON response.");const jr=Ji.map(Ot=>Ot.name),hi={...n};let wt=0;const Wn=[];if(Zi!==n.pinCount&&(hi.pinCount=Zi,Wn.push({label:"Pin Count",value:String(Zi)}),wt++),qt.properties&&typeof qt.properties=="object"){const Ot=qt.properties;for(const Dt of Jt)if(Ot.hasOwnProperty(Dt.name)){const an=Ot[Dt.name];if(an!=null&&an!==""){let rn="";if(Dt.hasUnits){hi[Dt.name]=String(an);const bn=`${Dt.name}Unit`;let ni="";if(Ot.hasOwnProperty(bn)){const hr=String(Ot[bn]).trim();Dt.units.includes(hr)?(hi[bn]=hr,ni=hr):Dt.units.length>0&&(hi[bn]=Dt.units[0],ni=Dt.units[0])}else Dt.units.length>0&&(hi[bn]=Dt.units[0],ni=Dt.units[0]);rn=`${an} ${ni}`.trim()}else hi[Dt.name]=String(an),rn=String(an);Wn.push({label:Dt.label,value:rn}),wt++}}if(Ot.hasOwnProperty("icType")&&Ot.icType){const Dt=String(Ot.icType).trim();["Op-Amp","Microcontroller","Microprocessor","Logic","Memory","Voltage Regulator","Timer","ADC","DAC","Comparator","Transceiver","Driver","Amplifier","Other"].includes(Dt)&&(hi.icType=Dt,Wn.push({label:"IC Type",value:Dt}),wt++)}if(Ot.hasOwnProperty("packageType")&&Ot.packageType){const Dt=String(Ot.packageType).trim(),an=["DIP","PDIP","SOIC","QFP","LQFP","TQFP","BGA","SSOP","TSOP","Various","Other"];let rn=Dt;if(Dt.toUpperCase()==="PDIP"||Dt.toUpperCase()==="DIP")Dt.includes(",")||Dt.includes(" or ")||Dt.includes(" and ")?rn="Various":Dt.toUpperCase().includes("PDIP")?rn="PDIP":rn="DIP";else if(an.includes(Dt))rn=Dt;else if(Dt.includes(",")||Dt.includes(" or ")||Dt.includes(" and "))rn="Various";else{const bn=Dt.toUpperCase();bn.includes("LQFP")?rn="LQFP":bn.includes("TQFP")?rn="TQFP":bn.includes("QFP")?rn="QFP":bn.includes("SOIC")?rn="SOIC":bn.includes("BGA")?rn="BGA":bn.includes("SSOP")?rn="SSOP":bn.includes("TSOP")?rn="TSOP":rn="Other"}(an.includes(rn)||rn==="Various")&&(hi.packageType=rn,Wn.push({label:"Package Type",value:rn}),wt++)}}let mn="";if(qt.summary&&typeof qt.summary=="object"&&qt.summary.datasheetSummary&&(mn=String(qt.summary.datasheetSummary).trim(),mn)){hi.notes=mn;const Ot=mn.length>100?mn.substring(0,100)+"...":mn;Wn.push({label:"Notes",value:Ot}),wt++}if(o(hi),Je){const Ot=Je.pinConnections||[],Dt=new Array(Zi).fill("").map((_i,ar)=>ar<Ot.length?Ot[ar]:""),an=Je.pinPolarities||[],rn=new Array(Zi).fill("").map((_i,ar)=>ar<an.length?an[ar]:""),bn=[...Ji];for(;bn.length<Zi;)bn.push({name:""});const ni=bn.map(_i=>_i.name),hr={...Je,pinData:bn,pinNames:ni,pinCount:Zi,pinConnections:Dt,pinPolarities:rn,...mn&&{notes:mn}};n.layer==="top"?d(_i=>_i.map(ar=>ar.id===n.id?hr:ar)):b(_i=>_i.map(ar=>ar.id===n.id?hr:ar));const Di=jr.filter(_i=>_i.length>0).length;let qi=`Extracted ${Di} pin name${Di!==1?"s":""}`;Zi!==n.pinCount&&(qi+=" and pin count"),wt>0&&(qi+=` and ${wt} propert${wt===1?"y":"ies"}`),qi+=" from datasheet.",Wn.length>0&&(qi+=`

Extracted Properties:`,Wn.forEach(_i=>{qi+=`
   ${_i.label}: ${_i.value}`}));const Br=[];jr.forEach((_i,ar)=>{_i&&_i.trim()&&Br.push(`Pin ${ar+1}: ${_i.trim()}`)}),Br.length>0&&(qi+=`

Pin Names:`,qi+=`
  `+Br.join(", ")),xn({visible:!0,title:"Extraction Complete",message:qi,type:"success"}),we(null)}}catch(Nt){console.error("Error fetching pin names:",Nt),xn({visible:!0,title:"Extraction Failed",message:`Failed to extract information: ${Nt instanceof Error?Nt.message:"Unknown error"}. Please enter pin names manually.`,type:"info",onShowResponse:Y?()=>de(!0):void 0})}finally{G(!1)}};return i.jsxs(i.Fragment,{children:[i.jsx("style",{children:`
        @keyframes heartbeat {
          0%, 100% {
            transform: scale(1);
            box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.8);
          }
          50% {
            transform: scale(1.15);
            box-shadow: 0 0 0 8px rgba(76, 175, 80, 0);
          }
        }
        .fetch-pin-names-pulse {
          animation: heartbeat 0.8s ease-in-out infinite;
        }
      `}),i.jsxs("div",{"data-component-editor-dialog":!0,onClick:ye=>{if(p&&p.componentId===tt.id){const ze=ye.target;(ze.tagName==="BUTTON"||ze.tagName==="INPUT"||ze.closest("button")||ze.closest("input"))&&ye.stopPropagation()}},style:{position:"fixed",top:m?`${m.y}px`:"90px",left:m?`${m.x}px`:`${window.innerWidth-280}px`,transform:"none",background:p&&p.componentId===tt.id?"rgba(255, 255, 255, 0.95)":"#fff",border:"1px solid #0b5fff",borderRadius:4,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"350px",width:`${Yt.width}px`,height:`${Yt.height}px`,maxHeight:`${window.innerHeight-20}px`,display:"flex",flexDirection:"column",pointerEvents:"auto",cursor:D?"grabbing":"default"},children:[i.jsxs("div",{onMouseDown:ye=>{const ze=ye.target;ze.tagName==="BUTTON"||ze.tagName==="INPUT"||ze.closest("button")||ze.closest("input")||m&&(U({x:ye.clientX-m.x,y:ye.clientY-m.y}),M(!0),ye.preventDefault())},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:D?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[i.jsx("h3",{style:{margin:0,fontSize:"13px",color:"#fff",fontWeight:600},children:"Component Properties"}),i.jsx("button",{onClick:()=>{o(null),v(null)},style:{background:"transparent",border:"none",fontSize:"15px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"6px 20px 6px 6px",overflowY:"auto",flex:1,minHeight:0},children:[(()=>{const ye=r||$l(tt);return i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Category:"}),i.jsx("div",{style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"11px",color:"#000"},children:ye?.category||"N/A"})]})})(),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Type:"}),i.jsx("div",{style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"11px",color:"#000"},children:(()=>{const ye=r||$l(tt);return ye?.displayName?tt.componentType==="Capacitor"&&!ye.displayName.toLowerCase().includes("capacitor")?`${ye.displayName} Capacitor`:ye.displayName:tt.componentType==="GenericComponent"&&tt.genericType?Yl(tt.genericType):tt.componentType==="Diode"&&tt.diodeType&&tt.diodeType!=="Standard"?Yl(tt.diodeType):tt.componentType==="VariableResistor"&&tt.vrType&&tt.vrType!=="Potentiometer"?Yl(tt.vrType):tt.componentType==="Capacitor"&&tt.dielectric==="Tantalum"?"Tantalum Capacitor":tt.componentType==="Capacitor"&&tt.capacitorType==="Electrolytic"?"Electrolytic Capacitor":tt.componentType==="Capacitor"&&tt.capacitorType==="Film"?"Film Capacitor":Yl(tt.componentType)})()})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-layer-${tt.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Layer:"}),i.jsxs("select",{id:`component-layer-${tt.id}`,name:`component-layer-${tt.id}`,value:n.layer,onChange:ye=>o({...n,layer:ye.target.value}),disabled:_,style:{width:"80px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:_?.6:1},children:[i.jsx("option",{value:"top",children:"Top"}),i.jsx("option",{value:"bottom",children:"Bottom"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-designator-${tt.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Designator:"}),i.jsx("input",{id:`component-designator-${tt.id}`,name:`component-designator-${tt.id}`,type:"text",value:n.designator||"",onChange:ye=>{const ze=ye.target.value,Nt=ze.length>0?ze.charAt(0).toUpperCase():n.abbreviation;o({...n,designator:ze,abbreviation:Nt})},disabled:_,style:{width:"80px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",fontFamily:"monospace",textTransform:"uppercase",opacity:_?.6:1},placeholder:"e.g., U2, R7, C1",onKeyDown:ye=>{ye.key==="Enter"&&!_&&(ye.preventDefault(),ge())}}),i.jsx("button",{onClick:ge,disabled:_||!n.designator?.trim(),style:{padding:"4px 12px",background:_||!n.designator?.trim()?"#ccc":"linear-gradient(90deg, #7B68EE 0%, #6A5ACD 100%)",color:"#fff",border:"none",borderRadius:"4px",fontSize:"11px",fontWeight:600,cursor:_||!n.designator?.trim()?"not-allowed":"pointer",opacity:_||!n.designator?.trim()?.6:1,textShadow:"0 1px 2px rgba(0, 0, 0, 0.3)",whiteSpace:"nowrap"},title:"Find all components with this designator",children:"Find"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-orientation-${tt.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Orientation:"}),i.jsxs("select",{id:`component-orientation-${tt.id}`,name:`component-orientation-${tt.id}`,value:n.orientation??0,onChange:ye=>{const ze=parseInt(ye.target.value)||0;if(o({...n,orientation:ze}),!_){const Ke=(n.layer==="top"?s:l).find(vt=>vt.id===n.id);if(Ke){const vt={...Ke,orientation:ze};n.layer==="top"?d(Vt=>Vt.map(ht=>ht.id===n.id?vt:ht)):b(Vt=>Vt.map(ht=>ht.id===n.id?vt:ht))}}},disabled:_,style:{width:"70px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:_?.6:1},children:[i.jsx("option",{value:"0",children:"0"}),i.jsx("option",{value:"90",children:"90"}),i.jsx("option",{value:"180",children:"180"}),i.jsx("option",{value:"270",children:"270"})]})]}),(tt.componentType==="IntegratedCircuit"||tt.componentType==="Semiconductor")&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsx("label",{htmlFor:`component-datasheet-${tt.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Datasheet:"}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px",flex:1},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",flexWrap:"wrap",flex:1},children:[i.jsx("input",{id:`component-datasheet-file-${tt.id}`,type:"file",accept:".pdf",onChange:async ye=>{const ze=ye.target.files?.[0]||null;if(ze){F(ze);let Nt=ze.name;if(ae)try{let Ke;try{Ke=await ae.getDirectoryHandle("datasheets",{create:!0})}catch(ht){console.error("Failed to get/create datasheets directory:",ht),Ke=ae}const Vt=await(await Ke.getFileHandle(ze.name,{create:!0})).createWritable();await Vt.write(await ze.arrayBuffer()),await Vt.close(),Nt=Ke===ae?ze.name:`datasheets/${ze.name}`}catch(Ke){console.error("Failed to copy datasheet to project directory:",Ke)}o({...n,datasheetFileName:Nt})}else F(null),o({...n,datasheetFileName:void 0})},disabled:_,style:{position:"absolute",width:"0.1px",height:"0.1px",opacity:0,overflow:"hidden",zIndex:-1}}),i.jsx("label",{htmlFor:`component-datasheet-file-${tt.id}`,style:{display:"inline-block",padding:"2px 6px",background:_?"#ccc":"#4CAF50",border:"none",borderRadius:2,fontSize:"11px",color:"#fff",cursor:_?"not-allowed":"pointer",opacity:_?.6:1,whiteSpace:"nowrap",flex:"0 0 auto"},children:"Choose File"}),(()=>{const ye=tt?.datasheetFileName,ze=ee?.name||(ye?ye.split("/").pop():null),Nt=!!ee;return ze?Nt?i.jsx("a",{href:"#",onClick:Ke=>{Ke.preventDefault(),Ke.stopPropagation();try{const vt=ee,Vt=URL.createObjectURL(vt),ht=window.open(Vt,"_blank","noopener,noreferrer");if(!ht||ht.closed){URL.revokeObjectURL(Vt);const Je=document.createElement("a"),Ft=URL.createObjectURL(vt);Je.href=Ft,Je.target="_blank",Je.rel="noopener noreferrer",document.body.appendChild(Je),Je.click(),document.body.removeChild(Je)}}catch(vt){console.error("Error opening datasheet:",vt),alert("Failed to open datasheet file.")}},style:{fontSize:"11px",color:"#0066cc",whiteSpace:"nowrap",textDecoration:"underline",cursor:"pointer",flex:"0 0 auto"},title:"Click to open PDF in new window",children:ze}):i.jsxs("span",{style:{fontSize:"11px",color:"#666",flex:"0 0 auto",fontStyle:"italic"},title:"Re-choose the datasheet file to open it",children:[ze," (re-choose file to open)"]}):i.jsx("span",{style:{fontSize:"11px",color:"#666",flex:"0 0 auto"},children:"No file chosen"})})()]}),i.jsx("div",{style:{display:"flex",alignItems:"center",gap:"4px",marginTop:"4px"},children:i.jsx("button",{onClick:()=>{if(n&&tt){const ze=(n.layer==="top"?s:l).find(Nt=>Nt.id===n.id);if(ze){const vt=((r||$l(ze))?.fields||[]).filter(ht=>ht.name!=="datasheet").map(ht=>({name:ht.name,label:ht.label,type:ht.type,hasUnits:!!(ht.units&&ht.units.length>0),units:ht.units||[]})),Vt=ze.customGeminiPrompt;if(Vt&&Vt.trim())k(Vt);else{const ht=lt(vt);k(ht)}}}Ie(!0)},disabled:_,style:{padding:"3px 8px",fontSize:"11px",background:_?"#ccc":"#0066cc",color:"#fff",border:"none",borderRadius:"3px",cursor:_?"not-allowed":"pointer",opacity:_?.6:1,fontWeight:600,whiteSpace:"nowrap",transition:"background 0.2s"},title:"View and edit the AI prompt that will be sent to Gemini",children:"View/Edit Prompt"})}),i.jsx("div",{style:{display:"flex",alignItems:"center",gap:"4px",marginTop:"4px"},children:i.jsx("button",{onClick:ct,disabled:J||_,className:J?"fetch-pin-names-pulse":"",style:{padding:"3px 8px",fontSize:"11px",background:_?"#ccc":"#4CAF50",color:"#fff",border:"none",borderRadius:"3px",cursor:J||_?"not-allowed":"pointer",opacity:_?.6:1,fontWeight:600,whiteSpace:"nowrap",transition:"background 0.2s"},children:J?"Extracting...":"Extract Datasheet Information"})})]})]}),(tt.componentType==="IntegratedCircuit"||tt.componentType==="Semiconductor")&&i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid #e0e0e0",fontSize:"11px",fontWeight:600,color:"#000",marginBottom:"4px"},children:"IC Properties:"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsx("label",{htmlFor:`component-manufacturer-ic-${tt.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Manufacturer:"}),i.jsx("input",{id:`component-manufacturer-ic-${tt.id}`,type:"text",value:n.manufacturer||"",onChange:ye=>o({...n,manufacturer:ye.target.value}),disabled:_,style:{width:"150px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:_?.6:1}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsx("label",{htmlFor:`component-partnumber-ic-${tt.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Part Number:"}),i.jsx("input",{id:`component-partnumber-ic-${tt.id}`,type:"text",value:n.partNumber||"",onChange:ye=>o({...n,partNumber:ye.target.value}),disabled:_,style:{width:"150px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:_?.6:1}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsx("label",{htmlFor:`component-pincount-ic-${tt.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Pin Count:"}),i.jsx("input",{id:`component-pincount-ic-${tt.id}`,name:`component-pincount-ic-${tt.id}`,type:"number",min:"1",value:n.pinCount,onChange:ye=>{const ze=Math.max(1,parseInt(ye.target.value)||1);o({...n,pinCount:ze})},onBlur:ye=>{if(_){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const ze=Math.max(1,parseInt(ye.target.value)||1),Ke=(n.layer==="top"?s:l).find(vt=>vt.id===n.id);if(Ke&&ze!==Ke.pinCount){const vt=Ke.pinConnections||[],Vt=new Array(ze).fill("").map((At,Jt)=>Jt<vt.length?vt[Jt]:""),ht=Ke.pinPolarities||[],Je=Ke.pinPolarities?new Array(ze).fill("").map((At,Jt)=>Jt<ht.length?ht[Jt]:""):void 0,Ft={...Ke,pinCount:ze,pinConnections:Vt,...Je!==void 0&&{pinPolarities:Je}};n.layer==="top"?d(At=>At.map(Jt=>Jt.id===n.id?Ft:Jt)):b(At=>At.map(Jt=>Jt.id===n.id?Ft:Jt)),o({...n,pinCount:ze})}},disabled:_,style:{width:"80px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:_?.6:1}})]})]})]}),i.jsx(uw,{component:tt,componentEditor:n,componentDefinition:r,setComponentEditor:o,areComponentsLocked:_,componentsTop:s,componentsBottom:l,uploadedDatasheetFile:ee,setUploadedDatasheetFile:F,setComponentsTop:d,setComponentsBottom:b}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-description-${tt.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Description:"}),i.jsx("input",{id:`component-description-${tt.id}`,name:`component-description-${tt.id}`,type:"text",value:n.description||"",onChange:ye=>{o({...n,description:ye.target.value})},disabled:_,style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:_?.6:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},placeholder:"",title:n.description||""})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-notes-${tt.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Notes:"}),i.jsx("input",{id:`component-notes-${tt.id}`,name:`component-notes-${tt.id}`,type:"text",readOnly:!0,value:tt.notes||"",onClick:()=>{_||(N(new Set([tt.id])),g(!0))},disabled:_,style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:_?.6:1,cursor:_?"not-allowed":"pointer",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},placeholder:"Click to edit notes...",title:tt.notes||"Click to edit notes..."})]}),(tt.componentType==="IntegratedCircuit"||tt.componentType==="Semiconductor")&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-operatingTemperature-${tt.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Operating Temperature:"}),i.jsx("input",{id:`component-operatingTemperature-${tt.id}`,name:`component-operatingTemperature-${tt.id}`,type:"text",value:n.operatingTemperature||"",onChange:ye=>{o({...n,operatingTemperature:ye.target.value})},disabled:_,style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:_?.6:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},placeholder:"",title:n.operatingTemperature||""})]}),tt.componentType!=="IntegratedCircuit"&&tt.componentType!=="Semiconductor"&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-pincount-${tt.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Pin Count:"}),i.jsx("input",{id:`component-pincount-${tt.id}`,name:`component-pincount-${tt.id}`,type:"number",min:"1",value:n.pinCount,onChange:ye=>{const ze=Math.max(1,parseInt(ye.target.value)||1);o({...n,pinCount:ze})},onBlur:ye=>{if(_){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const ze=Math.max(1,parseInt(ye.target.value)||1),Ke=(n.layer==="top"?s:l).find(vt=>vt.id===n.id);if(Ke&&ze!==Ke.pinCount){const vt=Ke.pinConnections||[],Vt=new Array(ze).fill("").map((At,Jt)=>Jt<vt.length?vt[Jt]:""),ht=Ke.pinPolarities||[],Je=Ke.pinPolarities?new Array(ze).fill("").map((At,Jt)=>Jt<ht.length?ht[Jt]:""):void 0,Ft={...Ke,pinCount:ze,pinConnections:Vt,...Je!==void 0&&{pinPolarities:Je}};n.layer==="top"?d(At=>At.map(Jt=>Jt.id===n.id?Ft:Jt)):b(At=>At.map(Jt=>Jt.id===n.id?Ft:Jt)),o({...n,pinCount:ze})}},disabled:_,style:{width:"60px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:_?.6:1}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-x-${tt.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"X:"}),i.jsx("input",{id:`component-x-${tt.id}`,name:`component-x-${tt.id}`,type:"number",value:n.x.toFixed(2),onChange:ye=>{const ze=parseFloat(ye.target.value)||0;o({...n,x:ze})},disabled:_,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:_?.6:1}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-y-${tt.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Y:"}),i.jsx("input",{id:`component-y-${tt.id}`,name:`component-y-${tt.id}`,type:"number",value:n.y.toFixed(2),onChange:ye=>{const ze=parseFloat(ye.target.value)||0;o({...n,y:ze})},disabled:_,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:_?.6:1}})]}),i.jsxs("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid #e0e0e0"},children:[i.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:600,color:"#333",marginBottom:"2px"},children:"Pin Connections:"}),p&&p.componentId===tt.id&&i.jsxs("div",{style:{padding:"2px 3px",background:"#fff3cd",border:"1px solid #ffc107",borderRadius:2,marginBottom:"2px",fontSize:"11px",color:"#856404"},children:["Pin ",p.pinIndex+1," selected. Click on a via or pad to connect."]}),(()=>{const ye=ip(tt),Nt=(n.layer==="top"?s:l).find(Tr=>Tr.id===n.id),Ke=Nt?.pinData,vt=Nt?.pinNames,ht=(r||$l(tt))?.properties?.pinNames,Je=ht&&ht.length>0,Ft=Je&&ht.includes("CHIP_DEPENDENT"),At=Je&&!Ft,Jt=Ft,An=Je,dn=Ke&&Ke.some(Tr=>Tr&&Tr.type&&Tr.type.trim()!==""),ti=Ke&&Ke.some(Tr=>Tr&&Tr.alternate_functions&&Tr.alternate_functions.length>0);return i.jsx("div",{children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px",marginTop:"2px"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{borderBottom:"1px solid #ddd",background:"#f5f5f5"},children:[i.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333",width:"20px"}}),i.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333",width:"40px"},children:"Pin"}),An&&i.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333",width:"70px"},children:"Pin Name"}),dn&&i.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333",width:"80px"},children:"Type"}),ti&&i.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333",width:"120px"},children:"Alt Functions"}),ye&&i.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333",width:"50px"},children:"Polarity"}),i.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333"},children:"Node ID"})]})}),i.jsx("tbody",{children:Array.from({length:n.pinCount},(Tr,en)=>{const zi=Nt?.pinConnections&&Nt.pinConnections.length>en?Nt.pinConnections[en]:"",Mr=Nt?.pinPolarities&&Nt.pinPolarities.length>en&&Nt.pinPolarities[en]||"",qt=Ke&&en<Ke.length&&Ke[en]?Ke[en]:null,Zi=qt?.name||(vt&&en<vt.length?vt[en]:""),Ji=ht&&en<ht.length?ht[en]:"",Cr=Ji==="CHIP_DEPENDENT",jr=Zi&&Zi.trim()!==""?Zi:Cr?"":Ji,hi=qt?.type,wt=qt?.alternate_functions,Wn=p&&p.componentId===tt.id&&p.pinIndex===en;return i.jsxs("tr",{style:{cursor:_?"not-allowed":"pointer",background:Wn?"#e6f0ff":zi?"#d4edda":"#fff",borderBottom:"1px solid #eee"},onClick:mn=>{if(mn.target.tagName!=="SELECT"){if(_){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}v(Wn?null:{componentId:tt.id,pinIndex:en})}},title:zi?`Connected to: ${zi}`:"Select this pin, then click on a via or pad to connect",children:[i.jsx("td",{style:{padding:"2px 4px",textAlign:"center"},children:i.jsx("input",{id:`pin-radio-${tt.id}-${en}`,name:`pin-radio-${tt.id}`,type:"radio",checked:!!Wn,onChange:()=>{if(_){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}v(Wn?null:{componentId:tt.id,pinIndex:en})},disabled:_,style:{margin:0,cursor:_?"not-allowed":"pointer",opacity:_?.6:1,width:"10px",height:"10px"}})}),i.jsx("td",{style:{padding:"2px 4px",color:"#333",fontWeight:Wn?600:400,fontFamily:"monospace"},children:en+1}),(At||Jt)&&i.jsx("td",{style:{padding:"2px 4px",textAlign:"left"},children:At?i.jsx("select",{value:jr||"",onChange:mn=>{if(_){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const Ot=mn.target.value,an=(n.layer==="top"?s:l).find(rn=>rn.id===n.id);if(an){const bn=[...an.pinNames||(ht?[...ht]:[])];for(;bn.length<n.pinCount;)bn.push("");bn[en]=Ot;const ni={...an,pinNames:bn};n.layer==="top"?d(hr=>hr.map(Di=>Di.id===n.id?ni:Di)):b(hr=>hr.map(Di=>Di.id===n.id?ni:Di))}},disabled:_,onClick:mn=>mn.stopPropagation(),onFocus:mn=>mn.stopPropagation(),style:{padding:"2px 4px",fontSize:"11px",border:"1px solid #ddd",borderRadius:2,background:"#fff",color:"#333",cursor:_?"not-allowed":"pointer",opacity:_?.6:1,width:"100%",fontStyle:"italic",minHeight:"18px"},children:ht&&ht.length>0?ht.filter(mn=>mn!=="CHIP_DEPENDENT").map((mn,Ot)=>i.jsx("option",{value:mn,children:mn},Ot)):i.jsx("option",{value:"",children:"-"})}):i.jsx("input",{type:"text",value:jr||"",onChange:mn=>{if(_){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const Ot=mn.target.value,an=(n.layer==="top"?s:l).find(rn=>rn.id===n.id);if(an){const rn=an.pinData,bn=an.pinNames||[];let ni;for(rn&&Array.isArray(rn)?ni=[...rn]:ni=bn.map(qi=>({name:qi}));ni.length<n.pinCount;)ni.push({name:""});ni[en]={...ni[en],name:Ot};const hr=ni.map(qi=>qi.name),Di={...an,pinData:ni,pinNames:hr};n.layer==="top"?d(qi=>qi.map(Br=>Br.id===n.id?Di:Br)):b(qi=>qi.map(Br=>Br.id===n.id?Di:Br))}},disabled:_,onClick:mn=>mn.stopPropagation(),onFocus:mn=>mn.stopPropagation(),placeholder:"Pin name",style:{padding:"1px 2px",fontSize:"11px",border:"1px solid #ddd",borderRadius:2,background:"#fff",color:"#333",width:"100%",opacity:_?.6:1,cursor:_?"not-allowed":"text"}})}),dn&&i.jsx("td",{style:{padding:"2px 4px",color:"#333",fontSize:"11px"},children:hi&&hi.trim()!==""?i.jsx("span",{style:{fontFamily:"monospace",color:"#666"},children:hi}):i.jsx("span",{style:{color:"#ccc"},children:"-"})}),ti&&i.jsx("td",{style:{padding:"2px 4px",color:"#333",fontSize:"11px"},children:wt&&wt.length>0?i.jsx("span",{style:{fontFamily:"monospace",color:"#666",fontSize:"10px"},children:wt.join(", ")}):i.jsx("span",{style:{color:"#ccc"},children:"-"})}),ye&&i.jsx("td",{style:{padding:"2px 4px",textAlign:"center"},children:zi?i.jsx("span",{style:{fontFamily:"monospace",fontWeight:600,color:Mr==="+"?"#d32f2f":Mr==="-"?"#1976d2":"#999"},children:Mr||"-"}):i.jsxs("select",{value:Mr??"",onChange:mn=>{if(_){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const Ot=mn.target.value,an=(n.layer==="top"?s:l).find(rn=>rn.id===n.id);if(an){const bn=[...an.pinPolarities||new Array(an.pinCount).fill("")];for(;bn.length<an.pinCount;)bn.push("");bn[en]=Ot;const ni={...an,pinPolarities:bn};n.layer==="top"?d(hr=>hr.map(Di=>Di.id===n.id?ni:Di)):b(hr=>hr.map(Di=>Di.id===n.id?ni:Di))}},disabled:_,onClick:mn=>mn.stopPropagation(),onFocus:mn=>mn.stopPropagation(),style:{padding:"1px 2px",fontSize:"11px",border:"1px solid #ddd",borderRadius:2,background:"#fff",cursor:_?"not-allowed":"pointer",opacity:_?.6:1,width:"100%",fontFamily:"monospace",fontWeight:600},children:[i.jsx("option",{value:"",children:"-"}),i.jsx("option",{value:"+",children:"+"}),i.jsx("option",{value:"-",children:"-"})]},`polarity-${tt.id}-${en}-${Mr}`)}),i.jsx("td",{style:{padding:"2px 4px",color:zi?"#28a745":"#999",fontWeight:zi?600:400,fontFamily:"monospace"},children:zi||"-"})]},en)})})]})})})()]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"6px",padding:"6px",paddingRight:"24px",borderTop:"1px solid #e0e0e0",flexShrink:0},children:[i.jsx("button",{onClick:()=>{o(null),v(null)},disabled:_,style:{padding:"2px 5px",background:_?"#f5f5f5":"#fff",color:_?"#999":"#333",border:"1px solid #ddd",borderRadius:2,cursor:_?"not-allowed":"pointer",fontSize:"11px",opacity:_?.6:1},children:"Cancel"}),i.jsx("button",{onClick:vn,disabled:_,style:{padding:"2px 5px",background:_?"#f5f5f5":"#0b5fff",color:_?"#999":"#fff",border:"1px solid #ddd",borderRadius:2,cursor:_?"not-allowed":"pointer",fontSize:"11px",opacity:_?.6:1},children:"Save"})]}),$&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10005},onClick:ye=>{ye.target===ye.currentTarget&&H(!1)},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"600px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:ye=>ye.stopPropagation(),children:[i.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:"How to Get a Google Gemini API Key"}),i.jsx("button",{onClick:()=>H(!1),style:{background:"transparent",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:0,width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center"},title:"Close",children:""})]}),i.jsx("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"14px",lineHeight:"1.6"},children:i.jsxs("p",{style:{margin:"0 0 12px 0"},children:["To get a Google Gemini API key, go to"," ",i.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",style:{color:"#4CAF50",textDecoration:"underline"},children:"Google AI Studio (aistudio.google.com/app/apikey)"}),', sign in with your Google account, and click "Get API key" or "Create API key" in the Dashboard to generate a key for a new or existing Google Cloud project, then copy it and store it securely.']})}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:i.jsx("button",{onClick:()=>H(!1),style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"OK"})})]})}),i.jsx("div",{onMouseDown:Rn,style:{position:"absolute",bottom:0,right:0,width:"20px",height:"20px",cursor:"nwse-resize",background:"linear-gradient(135deg, transparent 0%, transparent 40%, #ccc 40%, #ccc 45%, transparent 45%, transparent 55%, #ccc 55%, #ccc 60%, transparent 60%)",zIndex:1001},title:"Drag to resize"})]}),R&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10005},onClick:ye=>{ye.target===ye.currentTarget&&(Z(!1),E?.())},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"520px",maxWidth:"620px",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:ye=>ye.stopPropagation(),children:[i.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:"AI Service Configuration"}),i.jsx("button",{onClick:()=>{Z(!1),E?.()},style:{background:"transparent",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:0,width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center"},title:"Close",children:""})]}),i.jsxs("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"14px",lineHeight:"1.6"},children:[i.jsx("p",{style:{margin:"0 0 16px 0"},children:"Extract datasheet information for components  avoiding manual data entry. Choose your preferred AI service below."}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#fff",fontSize:"13px",fontWeight:600},children:"AI Service Provider:"}),i.jsx("select",{value:A,onChange:ye=>Ht(ye.target.value),style:{width:"100%",padding:"8px 12px",fontSize:"13px",border:"1px solid #555",borderRadius:"4px",background:"#1f1f24",color:"#fff",boxSizing:"border-box",cursor:"pointer"},children:_1.map(ye=>i.jsx("option",{value:ye,children:Hs[ye].name},ye))}),i.jsx("p",{style:{margin:"6px 0 0 0",color:"#aaa",fontSize:"12px",lineHeight:"1.4"},children:Hs[A].description})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsxs("label",{style:{display:"block",marginBottom:"6px",color:"#fff",fontSize:"13px",fontWeight:600},children:[Hs[A].name," API Key:"]}),i.jsx("input",{type:"password",value:W,onChange:ye=>se(ye.target.value),placeholder:Hs[A].apiKeyPlaceholder,style:{width:"100%",padding:"8px 12px",fontSize:"13px",border:"1px solid #555",borderRadius:"4px",background:"#1f1f24",color:"#fff",boxSizing:"border-box"},autoFocus:!0}),i.jsxs("p",{style:{margin:"6px 0 0 0",color:"#aaa",fontSize:"12px"},children:["Get your API key from:"," ",i.jsx("a",{href:Hs[A].apiKeyHelpUrl,target:"_blank",rel:"noopener noreferrer",style:{color:"#4CAF50"},children:Hs[A].apiKeyHelpUrl})]})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#fff",fontSize:"13px",fontWeight:600},children:"Model:"}),i.jsx("select",{value:Ce,onChange:ye=>le(ye.target.value),style:{width:"100%",padding:"8px 12px",fontSize:"13px",border:"1px solid #555",borderRadius:"4px",background:"#1f1f24",color:"#fff",boxSizing:"border-box",cursor:"pointer"},children:Hs[A].models.map(ye=>i.jsxs("option",{value:ye.id,children:[ye.name," ",ye.description?`(${ye.description})`:""]},ye.id))})]}),i.jsxs("div",{style:{marginBottom:"16px",padding:"12px",background:"#1f1f24",borderRadius:"4px",border:"1px solid #444"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#fff",fontSize:"13px",fontWeight:600},children:"API Key Storage:"}),i.jsxs("div",{style:{display:"flex",gap:"16px"},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",cursor:"pointer",color:"#ddd",fontSize:"13px"},children:[i.jsx("input",{type:"radio",name:"storageType2",value:"sessionStorage",checked:_e==="sessionStorage",onChange:()=>be("sessionStorage"),style:{cursor:"pointer"}}),"Session Storage"]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",cursor:"pointer",color:"#ddd",fontSize:"13px"},children:[i.jsx("input",{type:"radio",name:"storageType2",value:"localStorage",checked:_e==="localStorage",onChange:()=>be("localStorage"),style:{cursor:"pointer"}}),"Local Storage"]})]}),i.jsx("p",{style:{margin:"8px 0 0 0",color:_e==="sessionStorage"?"#4CAF50":"#ffaa00",fontSize:"12px",lineHeight:"1.4"},children:_e==="sessionStorage"?" Session Storage: API key is cleared when you close the browser tab (more secure)":" Local Storage: API key persists until you remove it (more convenient)"})]}),i.jsx("div",{style:{padding:"10px",background:"#1a1a1f",borderRadius:"4px",border:"1px solid #333"},children:i.jsxs("p",{style:{margin:"0",color:"#aaa",fontSize:"11px",lineHeight:"1.4"},children:[i.jsx("strong",{style:{color:"#ffaa00"},children:" Security:"})," API keys are stored in plain text in browser storage and are accessible via DevTools. Do not use on shared computers. Consider using API key restrictions from your provider."]})})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"8px"},children:[i.jsx("button",{onClick:jt,disabled:!De,style:{padding:"8px 16px",background:De?"#d32f2f":"#444",color:"#fff",border:"1px solid #666",borderRadius:6,cursor:De?"pointer":"not-allowed",fontSize:"14px",fontWeight:600,opacity:De?1:.5},title:De?"Remove API key":"No API key stored",children:"Remove Key"}),i.jsxs("div",{style:{display:"flex",gap:"8px"},children:[i.jsx("button",{onClick:()=>{Z(!1),E?.()},style:{padding:"8px 16px",background:"#555",color:"#fff",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Cancel"}),i.jsx("button",{onClick:()=>{ot(),Z(!1),E?.()},style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Save Settings"})]})]})]})}),te&&Y&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10006},onClick:ye=>{ye.target===ye.currentTarget&&de(!1)},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"600px",maxWidth:"90vw",maxHeight:"90vh",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"2px solid #2196F3",display:"flex",flexDirection:"column"},onClick:ye=>ye.stopPropagation(),children:[i.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:"AI Service Response"}),i.jsx("button",{onClick:()=>{de(!1),we(null)},style:{background:"transparent",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:0,width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center"},title:"Close",children:""})]}),i.jsx("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"13px",lineHeight:"1.6",overflow:"auto",flex:1,padding:"12px",background:"#1f1f24",borderRadius:"4px",fontFamily:"monospace",whiteSpace:"pre-wrap",wordBreak:"break-word",maxHeight:"60vh"},children:Y}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[i.jsx("button",{onClick:()=>{navigator.clipboard.writeText(Y||""),alert("Response copied to clipboard")},style:{padding:"8px 16px",background:"#555",color:"#fff",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Copy to Clipboard"}),i.jsx("button",{onClick:()=>{de(!1),we(null)},style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Close"})]})]})}),je&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},onClick:ye=>{ye.target===ye.currentTarget&&Ie(!1)},children:i.jsxs("div",{style:{background:"#fff",borderRadius:8,padding:"20px",maxWidth:"90%",maxHeight:"90%",width:"800px",display:"flex",flexDirection:"column",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)"},onClick:ye=>ye.stopPropagation(),children:[i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:"18px",fontWeight:600,color:"#333"},children:"AI Prompt Editor"}),i.jsx("p",{style:{margin:"0",fontSize:"13px",color:"#666",lineHeight:"1.5"},children:'This is the prompt that will be sent to Gemini when you click "Extract Datasheet Information". You can customize it for this component. The prompt will be saved with this component and reloaded when you open it again.'}),i.jsx("p",{style:{margin:"8px 0 0 0",fontSize:"12px",color:"#888",fontStyle:"italic"},children:'Note: The PDF datasheet will be automatically attached to your prompt when extracting information. You can reference it in your prompt as "the attached PDF" or "the datasheet".'})]}),i.jsx("textarea",{value:xe,onChange:ye=>k(ye.target.value),style:{flex:1,minHeight:"400px",padding:"12px",border:"1px solid #ddd",borderRadius:4,fontSize:"13px",fontFamily:"monospace",resize:"vertical",color:"#000",background:"#fff",lineHeight:"1.5"},placeholder:"Enter your custom prompt here..."}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[i.jsx("button",{onClick:()=>{Ie(!1)},style:{padding:"8px 16px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:()=>{if(n&&tt){const ze=(n.layer==="top"?s:l).find(Nt=>Nt.id===n.id);if(ze){const Nt={...ze,customGeminiPrompt:xe.trim()||void 0};n.layer==="top"?d(Ke=>Ke.map(vt=>vt.id===n.id?Nt:vt)):b(Ke=>Ke.map(vt=>vt.id===n.id?Nt:vt)),o({...n,customGeminiPrompt:xe.trim()||void 0})}}Ie(!1)},style:{padding:"8px 16px",background:"#4CAF50",border:"none",borderRadius:4,cursor:"pointer",color:"#fff",fontSize:"14px",fontWeight:600},children:"Save Prompt"})]})]})}),i.jsx(Zy,{visible:Zt.visible,title:Zt.title,message:Zt.message,type:Zt.type,onClose:()=>{xn({visible:!1,title:"",message:"",type:"info"}),te||we(null)},onShowResponse:Zt.onShowResponse})]})};function pw(n){if(n.baseType)return n.baseType;switch(n.category){case"Capacitors":return"Capacitor";case"Diodes":return"Diode";case"Resistors":return"Resistor";case"Semiconductors":return"Semiconductor";case"Passive Components":return"Passive";case"Power & Energy":return"PowerEnergy";case"Connectors & Switches":return n.type==="Switch"||n.subcategory==="Switch"?"Switch":"Connector";case"Other":return n.type==="Transformer"?"Transformer":"Other";default:return"Other"}}const hw=bh.components,gw=hw.map(n=>{const r=`${n.category}:${n.subcategory}:${n.type}`,o=pw(n);return{...n,key:r,baseType:o}}),im=new Map;gw.forEach(n=>{im.set(n.key,n)});function yw(n){if(n)return im.get(n)}const Vg=n=>{const{category:r,subcategory:o,type:s,designator:l}=n;let d,b;switch(r){case"Capacitors":o==="Electrolytic"?d="Electrolytic Capacitor":o==="Film"?d="Film Capacitor":(d="Capacitor",o==="Tantalum"&&(b="Tantalum"));break;case"Diodes":d="Diode",o==="LED"?b="LED":o==="Infrared"?b="Infrared":o==="Photodiode"?b="Photodiode":o==="Schottky"?b="Schottky":o==="Zener"?b="Zener":b="Standard";break;case"Resistors":o==="Network"?(d="ResistorNetwork",b="Network"):o==="Thermistor"?(d="Thermistor",b="Thermistor"):o==="Variable"?(d="VariableResistor",b="Potentiometer"):o==="Varistor"?(d="VariableResistor",b="Varistor"):d="Resistor";break;case"Semiconductors":o==="BJT"||o==="MOSFET"||o==="JFET"?d="Transistor":d="IntegratedCircuit";break;case"Passive Components":s==="Inductor"?d="Inductor":s==="FerriteBead"?d="FerriteBead":d="Crystal";break;case"Power & Energy":o==="Battery"?d="Battery":o==="Power Supply"?d="PowerSupply":d="Fuse";break;case"Connectors & Switches":o==="Connector"?d="Connector":o==="Jumper"?d="Jumper":o==="Switch"?d="Switch":d="Relay";break;case"Other":o==="Transformer"?d="Transformer":o==="Speaker"?d="Speaker":o==="Motor"?d="Motor":o==="Test Point"?d="TestPoint":o==="Vacuum Tube"?d="VacuumTube":(d="GenericComponent",o==="Attenuator"?b="Attenuator":o==="Circuit Breaker"?b="CircuitBreaker":o==="Thermocouple"?b="Thermocouple":o==="Tuner"&&(b="Tuner"));break;default:d="GenericComponent";break}const p=`${r}:${o}:${s}:${l}`,v=`${r}:${o}:${s}`,m=yw(v);return{componentType:d,designator:l,subtype:b,uniqueKey:p,componentDefinition:n,dataDrivenDefinition:m}},rm=$u.reduce((n,r)=>(n[r.category]||(n[r.category]=[]),n[r.category].push(r),n),{});Object.values(rm).forEach(n=>{n.sort((r,o)=>r.displayName.localeCompare(o.displayName))});const xw=({visible:n,selectedLayer:r,selectedComponentType:o,selectedComponentKey:s,onLayerChange:l,onComponentTypeChange:d,onClose:b})=>{const[p,v]=L.useState(""),[m,C]=L.useState(null),[D,M]=L.useState(!1),S=L.useRef({x:0,y:0}),U=L.useRef(null),_=L.useRef(null);L.useEffect(()=>{if(n&&m===null){const re=document.querySelector(".pcb-canvas");if(re){const J=re.getBoundingClientRect();C({x:J.left,y:J.top})}else C({x:244,y:6})}},[n,m]),L.useEffect(()=>{if(n&&_.current){const re=setTimeout(()=>{_.current?.focus(),_.current?.select()},100);return()=>clearTimeout(re)}},[n]);const N=L.useCallback(re=>{const J=re.target;if(!(J.tagName==="BUTTON"||J.tagName==="INPUT"||J.closest("button")||J.closest("input"))&&U.current){const G=U.current.getBoundingClientRect();S.current={x:re.clientX-G.left,y:re.clientY-G.top},M(!0),re.preventDefault()}},[]);L.useEffect(()=>{if(!D)return;const re=G=>{const ee=G.clientX-S.current.x,F=G.clientY-S.current.y,$=U.current?.offsetWidth||400,H=U.current?.offsetHeight||600,R=Math.max(0,Math.min(ee,window.innerWidth-$)),Z=Math.max(0,Math.min(F,window.innerHeight-H));C({x:R,y:Z})},J=()=>{M(!1)};return document.addEventListener("mousemove",re),document.addEventListener("mouseup",J),()=>{document.removeEventListener("mousemove",re),document.removeEventListener("mouseup",J)}},[D]);const g=L.useMemo(()=>{if(!p.trim())return()=>!0;const re=p.toLowerCase();return J=>!!(J.searchText&&J.searchText.toLowerCase().includes(re)||J.displayName&&J.displayName.toLowerCase().includes(re)||J.description&&J.description.toLowerCase().includes(re)||J.category&&J.category.toLowerCase().includes(re)||J.subcategory&&J.subcategory.toLowerCase().includes(re)||J.designator&&J.designator.toLowerCase().includes(re)||J.type&&J.type.toLowerCase().includes(re)||J.resolvedTypeName&&J.resolvedTypeName.toLowerCase().includes(re))},[p]),ae=L.useMemo(()=>p.trim()?$u.filter(re=>{const J=Vg(re);return g({category:re.category,type:J.componentType,subcategory:re.subcategory,designator:re.designator,displayName:re.displayName,description:re.description,resolvedTypeName:Yl(J.componentType),searchText:re.searchText})}):$u,[p,g]);if(!n)return null;const V={position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"flex-start",justifyContent:"flex-end",zIndex:10005,pointerEvents:"none"},E={padding:"20px",overflow:"auto",flex:1};return i.jsx("div",{style:V,onClick:re=>re.stopPropagation(),children:i.jsxs("div",{ref:U,onClick:re=>re.stopPropagation(),style:{position:"fixed",top:m?`${m.y}px`:void 0,left:m?`${m.x}px`:void 0,backgroundColor:"#fff",borderRadius:8,minWidth:"250px",maxWidth:"300px",width:"280px",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:10005,display:"flex",flexDirection:"column",pointerEvents:"auto",transform:"none"},children:[i.jsxs("div",{onMouseDown:N,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:D?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Select Component"}),i.jsx("button",{type:"button",onMouseDown:re=>{re.stopPropagation()},onClick:re=>{re.stopPropagation(),b()},style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsxs("div",{style:E,children:[i.jsx("div",{style:{marginBottom:"16px"},onClick:re=>re.stopPropagation(),children:i.jsx("input",{ref:_,type:"text",placeholder:"Search by Component Type...",value:p,onChange:re=>v(re.target.value),onClick:re=>re.stopPropagation(),onMouseDown:re=>re.stopPropagation(),style:{width:"100%",padding:"8px 12px",fontSize:"13px",border:"1px solid #ddd",borderRadius:4,color:"#333",backgroundColor:"#fff",boxSizing:"border-box"}})}),i.jsxs("div",{style:{marginBottom:"20px",paddingBottom:"16px",borderBottom:"2px solid #eee"},onClick:re=>re.stopPropagation(),children:[i.jsx("div",{style:{marginBottom:"8px",fontSize:"14px",fontWeight:600,color:"#333"},children:"Layer:"}),i.jsxs("div",{style:{display:"flex",gap:"16px"},children:[i.jsxs("label",{onClick:re=>re.stopPropagation(),onMouseDown:re=>re.stopPropagation(),style:{display:"flex",alignItems:"center",cursor:"pointer",fontSize:"14px",color:"#333"},children:[i.jsx("input",{type:"radio",name:"componentLayer",checked:r==="top",onChange:()=>l("top"),onClick:re=>re.stopPropagation(),onMouseDown:re=>re.stopPropagation(),style:{marginRight:"8px",width:"14px",height:"14px",cursor:"pointer",accentColor:"#0066cc",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",border:r==="top"?"1.5px solid #0066cc":"1.5px solid #999",borderRadius:"50%",backgroundColor:r==="top"?"#0066cc":"transparent",position:"relative"}}),"Top"]}),i.jsxs("label",{onClick:re=>re.stopPropagation(),onMouseDown:re=>re.stopPropagation(),style:{display:"flex",alignItems:"center",cursor:"pointer",fontSize:"14px",color:"#333"},children:[i.jsx("input",{type:"radio",name:"componentLayer",checked:r==="bottom",onChange:()=>l("bottom"),onClick:re=>re.stopPropagation(),onMouseDown:re=>re.stopPropagation(),style:{marginRight:"8px",width:"14px",height:"14px",cursor:"pointer",accentColor:"#0066cc",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",border:r==="bottom"?"1.5px solid #0066cc":"1.5px solid #999",borderRadius:"50%",backgroundColor:r==="bottom"?"#0066cc":"transparent",position:"relative"}}),"Bottom"]})]})]}),i.jsxs("div",{children:[i.jsx("div",{style:{marginBottom:"12px",fontSize:"14px",fontWeight:600,color:"#333"},children:"Component Type:"}),i.jsx("div",{style:{maxHeight:"calc(80vh - 280px)",overflowY:"auto"},children:p.trim()?ae.length>0?ae.map(re=>{const J=Vg(re),G=J.uniqueKey||`${re.category}:${re.subcategory}:${re.type}:${re.designator}`,ee=s===G,F=`${re.designator} - ${re.displayName}`;return i.jsxs("label",{onClick:$=>{$.stopPropagation(),d(J.componentType,G,J)},onMouseDown:$=>$.stopPropagation(),style:{display:"flex",alignItems:"center",width:"100%",maxWidth:"100%",textAlign:"left",padding:"8px 12px",marginBottom:"4px",background:ee?"#e6f0ff":"#fff",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",fontSize:"12px",color:"#333",boxSizing:"border-box",overflow:"hidden"},children:[i.jsx("input",{type:"radio",name:"componentType-search",checked:ee,onChange:()=>d(J.componentType,G,J),onClick:$=>$.stopPropagation(),onMouseDown:$=>$.stopPropagation(),style:{marginRight:"8px",width:"14px",height:"14px",cursor:"pointer",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",border:ee?"1.5px solid #0066cc":"1.5px solid #999",borderRadius:"50%",backgroundColor:ee?"#0066cc":"transparent",position:"relative",flexShrink:0}}),i.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1,minWidth:0},children:i.jsx("strong",{children:F})})]},G)}):i.jsxs("div",{style:{padding:"12px",color:"#666",fontSize:"12px",textAlign:"center"},children:['No matches found for "',p,'"']}):Object.entries(rm).map(([re,J])=>J.length===0?null:i.jsxs("div",{style:{marginBottom:"12px"},children:[i.jsx("div",{style:{fontSize:"13px",fontWeight:600,color:"#333",padding:"6px 8px",marginBottom:"4px",backgroundColor:"#f5f5f5",borderRadius:4},children:re}),i.jsx("div",{style:{marginLeft:"8px"},children:J.map(G=>{const ee=Vg(G),F=ee.uniqueKey||`${G.category}:${G.subcategory}:${G.type}:${G.designator}`,$=s===F,H=`${G.designator} - ${G.displayName}`;return i.jsxs("label",{onClick:R=>{R.stopPropagation(),d(ee.componentType,F,ee)},onMouseDown:R=>R.stopPropagation(),style:{display:"flex",alignItems:"center",width:"100%",maxWidth:"100%",textAlign:"left",padding:"6px 12px",marginBottom:"2px",background:$?"#e6f0ff":"#fff",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",fontSize:"12px",color:"#333",boxSizing:"border-box",overflow:"hidden"},children:[i.jsx("input",{type:"radio",name:`componentType-${re}`,checked:$,onChange:()=>d(ee.componentType,F,ee),onMouseDown:R=>R.stopPropagation(),style:{marginRight:"8px",width:"14px",height:"14px",cursor:"pointer",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",border:$?"1.5px solid #0066cc":"1.5px solid #999",borderRadius:"50%",backgroundColor:$?"#0066cc":"transparent",position:"relative",flexShrink:0}}),i.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1,minWidth:0},children:H})]},F)})})]},re))})]})]})]})})},mw=({visible:n,onClose:r,powerBuses:o,setPowerBuses:s,editingPowerBusId:l,setEditingPowerBusId:d,powers:b})=>{const[p,v]=L.useState(null),[m,C]=L.useState(!1),[D,M]=L.useState(null),S=L.useRef(null);L.useEffect(()=>{n&&!p&&v({x:window.innerWidth/2-140,y:window.innerHeight/2-200})},[n,p]),L.useEffect(()=>{if(!m)return;const E=J=>{p&&D&&v({x:J.clientX-D.x,y:J.clientY-D.y})},re=()=>{C(!1),M(null)};return window.addEventListener("mousemove",E),window.addEventListener("mouseup",re),()=>{window.removeEventListener("mousemove",E),window.removeEventListener("mouseup",re)}},[m,p,D]);const U=o.filter(E=>E.id!==l),_=o.find(E=>E.id===l);if(!n)return null;const N=[...U].sort((E,re)=>{const J=F=>{const $=F.match(/([+-]?)(\d+\.?\d*)/);if($){const H=$[1]||"+",R=parseFloat($[2]);return{absValue:Math.abs(R),isNegative:H==="-"}}return{absValue:1/0,isNegative:!1}},G=J(E.voltage),ee=J(re.voltage);return G.absValue!==ee.absValue?G.absValue-ee.absValue:G.isNegative!==ee.isNegative?G.isNegative?-1:1:0}),g=_?[...N,_]:N,ae=()=>{const E={id:`powerbus-${Date.now()}-${Math.random()}`,name:"New Power Bus",voltage:"+0.0",color:"#ff0000"};s(re=>[...re,E]),d(E.id)},V=E=>{const re=E.target;re.tagName==="BUTTON"||re.tagName==="INPUT"||re.closest("button")||re.closest("input")||p&&(M({x:E.clientX-p.x,y:E.clientY-p.y}),C(!0),E.preventDefault())};return i.jsxs("div",{ref:S,style:{position:"fixed",top:p?`${p.y}px`:"50%",left:p?`${p.x}px`:"50%",transform:p?"none":"translate(-50%, -50%)",background:"#fff",border:"1px solid #0b5fff",borderRadius:4,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"280px",maxWidth:"320px",maxHeight:"80vh",display:"flex",flexDirection:"column",cursor:m?"grabbing":"default"},children:[i.jsxs("div",{onMouseDown:V,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:m?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Manage Power Buses"}),i.jsx("button",{onClick:r,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"6px 20px 6px 6px",overflowY:"auto",flex:1,minHeight:0},children:g.map(E=>{const re=o.find(F=>F.id===E.id)||E,J=o.findIndex(F=>F.id===E.id),G=o.some(F=>F.name===re.name&&F.id!==E.id),ee=o.some(F=>F.voltage===re.voltage&&F.id!==E.id);return i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"4px",marginBottom:"4px",background:"#f9f9f9",borderRadius:4,border:"1px solid #e0e0e0"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsxs("div",{style:{flex:1,minWidth:0,display:"flex",flexDirection:"column",gap:"4px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"50px",flexShrink:0},children:"Name:"}),i.jsx("input",{type:"text",value:re.name,onChange:F=>{const $=F.target.value;if(!o.some(R=>R.name===$&&R.id!==E.id)){const R=[...o];J>=0&&(R[J]={...re,name:$},s(R))}},placeholder:"e.g., +5VDC",style:{flex:1,padding:"2px 3px",border:G?"1px solid #ff0000":"1px solid #ddd",borderRadius:2,fontSize:"10px",background:"#f5f5f5",color:"#000"}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"50px",flexShrink:0},children:"Value:"}),i.jsx("input",{type:"text",inputMode:"decimal",value:re.voltage,onChange:F=>{const $=F.target.value;if($===""||/^[+-]?\d*\.?\d*$/.test($)){const H=[...o];J>=0&&(H[J]={...re,voltage:$},s(H))}},onBlur:F=>{const $=F.target.value.trim();if($==="")return;const H=parseFloat($);if(!isNaN(H)){const R=H>=0?"+":"-",Z=Math.abs(H),Y=`${R}${Z.toFixed(1).replace(/\.?0+$/,"")}`,we=[...o];J>=0&&(we[J]={...re,voltage:Y},s(we))}},placeholder:"e.g., +5.0",style:{flex:1,padding:"2px 3px",border:ee?"1px solid #ff0000":"1px solid #ddd",borderRadius:2,fontSize:"10px",background:"#f5f5f5",color:"#000"}})]})]}),i.jsx("input",{type:"color",value:re.color,onChange:F=>{const $=[...o];J>=0&&($[J]={...re,color:F.target.value},s($))},style:{width:"24px",height:"24px",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",flexShrink:0},title:"Color"}),i.jsx("button",{onClick:()=>{const F=b.filter($=>$.powerBusId===E.id);if(F.length>0){alert(`Cannot delete: ${F.length} power node(s) are using this bus. Remove or reassign them first.`);return}s($=>$.filter(H=>H.id!==E.id))},style:{padding:"2px 6px",background:"#f5f5f5",color:"#333",border:"1px solid #ddd",borderRadius:2,cursor:"pointer",fontSize:"9px",flexShrink:0},children:"Delete"})]})},E.id)})}),i.jsxs("div",{style:{padding:"6px",borderTop:"1px solid #e0e0e0",display:"flex",gap:"4px",flexShrink:0},children:[i.jsx("button",{onClick:ae,style:{flex:1,padding:"4px 8px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",fontSize:"10px"},children:"+ Add Power Bus"}),i.jsx("button",{onClick:r,style:{flex:1,padding:"4px 8px",background:"#0b5fff",color:"#fff",border:"none",borderRadius:2,cursor:"pointer",fontSize:"10px",fontWeight:500},children:"Close"})]})]})},bw=({visible:n,onClose:r,groundBuses:o,setGroundBuses:s,editingGroundBusId:l,setEditingGroundBusId:d,grounds:b})=>{const[p,v]=L.useState(null),[m,C]=L.useState(!1),[D,M]=L.useState(null),S=L.useRef(null);L.useEffect(()=>{n&&!p&&v({x:window.innerWidth/2-140,y:window.innerHeight/2-200})},[n,p]),L.useEffect(()=>{if(!m)return;const E=J=>{p&&D&&v({x:J.clientX-D.x,y:J.clientY-D.y})},re=()=>{C(!1),M(null)};return window.addEventListener("mousemove",E),window.addEventListener("mouseup",re),()=>{window.removeEventListener("mousemove",E),window.removeEventListener("mouseup",re)}},[m,p,D]);const U=o.filter(E=>E.id!==l),_=o.find(E=>E.id===l);if(!n)return null;const N=[...U].sort((E,re)=>E.name.localeCompare(re.name)),g=_?[...N,_]:N,ae=()=>{const E={id:`groundbus-${Date.now()}-${Math.random()}`,name:"New Ground Bus",color:"#000000"};s(re=>[...re,E]),d(E.id)},V=E=>{const re=E.target;re.tagName==="BUTTON"||re.tagName==="INPUT"||re.closest("button")||re.closest("input")||p&&(M({x:E.clientX-p.x,y:E.clientY-p.y}),C(!0),E.preventDefault())};return i.jsxs("div",{ref:S,style:{position:"fixed",top:p?`${p.y}px`:"50%",left:p?`${p.x}px`:"50%",transform:p?"none":"translate(-50%, -50%)",background:"#fff",border:"1px solid #0b5fff",borderRadius:4,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"280px",maxWidth:"320px",maxHeight:"80vh",display:"flex",flexDirection:"column",cursor:m?"grabbing":"default"},children:[i.jsxs("div",{onMouseDown:V,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:m?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Manage Ground Buses"}),i.jsx("button",{onClick:r,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"6px 20px 6px 6px",overflowY:"auto",flex:1,minHeight:0},children:g.map(E=>{const re=o.find(ee=>ee.id===E.id)||E,J=o.findIndex(ee=>ee.id===E.id),G=o.some(ee=>ee.name===re.name&&ee.id!==E.id);return i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",padding:"4px",marginBottom:"4px",background:"#f9f9f9",borderRadius:4,border:"1px solid #e0e0e0"},children:[i.jsx("div",{style:{flex:1,minWidth:0},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"50px",flexShrink:0},children:"Name:"}),i.jsx("input",{type:"text",value:re.name,onChange:ee=>{const F=ee.target.value;if(!o.some(H=>H.name===F&&H.id!==E.id)){const H=[...o];J>=0&&(H[J]={...re,name:F},s(H))}},placeholder:"e.g., GND, Earth",style:{flex:1,padding:"2px 3px",border:G?"1px solid #ff0000":"1px solid #ddd",borderRadius:2,fontSize:"10px",background:"#f5f5f5",color:"#000"}})]})}),i.jsx("input",{type:"color",value:re.color,onChange:ee=>{const F=[...o];J>=0&&(F[J]={...re,color:ee.target.value},s(F))},style:{width:"24px",height:"24px",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",flexShrink:0},title:"Color"}),i.jsx("button",{onClick:()=>{const ee=b.filter(F=>F.groundBusId===E.id);if(ee.length>0){alert(`Cannot delete: ${ee.length} ground node(s) are using this bus. Remove or reassign them first.`);return}s(F=>F.filter($=>$.id!==E.id))},style:{padding:"2px 6px",background:"#f5f5f5",color:"#333",border:"1px solid #ddd",borderRadius:2,cursor:"pointer",fontSize:"9px",flexShrink:0},children:"Delete"})]},E.id)})}),i.jsxs("div",{style:{padding:"6px",borderTop:"1px solid #e0e0e0",display:"flex",gap:"4px",flexShrink:0},children:[i.jsx("button",{onClick:ae,style:{flex:1,padding:"4px 8px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",fontSize:"10px"},children:"+ Add Ground Bus"}),i.jsx("button",{onClick:r,style:{flex:1,padding:"4px 8px",background:"#0b5fff",color:"#fff",border:"none",borderRadius:2,cursor:"pointer",fontSize:"10px",fontWeight:500},children:"Close"})]})]})},vw=({visible:n,onClose:r,autoAssignDesignators:o,setAutoAssignDesignators:s,useGlobalDesignatorCounters:l,setUseGlobalDesignatorCounters:d})=>n?i.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#fff",border:"1px solid #ddd",borderRadius:6,padding:"16px",zIndex:1e3,minWidth:"300px",maxWidth:"400px",boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[i.jsx("h2",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#222"},children:"Manage Designators"}),i.jsx("button",{onClick:r,style:{background:"transparent",border:"none",fontSize:"18px",cursor:"pointer",color:"#666",padding:0,width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:"13px",color:"#333",marginBottom:"12px"},children:[i.jsx("input",{type:"checkbox",checked:o,onChange:b=>{s(b.target.checked)},style:{width:"16px",height:"16px",cursor:"pointer"}}),i.jsx("span",{children:"Automatically assign designators"})]}),i.jsx("div",{style:{marginTop:"8px",padding:"8px",background:"#f5f5f5",borderRadius:4,fontSize:"11px",color:"#666",lineHeight:"1.4",marginBottom:"12px"},children:o?i.jsx("div",{children:"When enabled, new components automatically receive sequential designators (e.g., C1, C2, C3 for Capacitors; R1, R2, R3 for Resistors)."}):i.jsx("div",{children:"When disabled, you must manually assign designators to each component. The designator field will be empty when components are created."})}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:"13px",color:"#333"},children:[i.jsx("input",{type:"checkbox",checked:l,onChange:b=>{d(b.target.checked)},style:{width:"16px",height:"16px",cursor:"pointer"}}),i.jsx("span",{children:"Use global designator counters"})]}),i.jsx("div",{style:{marginTop:"8px",padding:"8px",background:"#f5f5f5",borderRadius:4,fontSize:"11px",color:"#666",lineHeight:"1.4"},children:l?i.jsx("div",{children:"When ON, designators continue from global counters across all projects. New components start with the next value from the global counter (e.g., if global counter is C10, new capacitor will be C11)."}):i.jsx("div",{children:"When OFF (default), designators start at 1 for each project. Each project maintains its own independent designator sequence (e.g., C1, C2, C3...)."})})]}),i.jsx("button",{onClick:r,style:{width:"100%",padding:"6px 12px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:4,cursor:"pointer",fontSize:"12px"},children:"Close"})]}):null,ww=({visible:n,title:r,message:o,onYes:s,onNo:l,onCancel:d,yesButtonRef:b})=>n?i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001},onClick:p=>{p.target===p.currentTarget&&d()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:p=>p.stopPropagation(),children:[i.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:r}),i.jsx("p",{style:{margin:"0 0 24px 0",fontSize:"14px",color:"#e0e0e0",lineHeight:"1.5"},children:o}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[i.jsx("button",{onClick:d,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:l,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"No"}),i.jsx("button",{ref:b,onClick:s,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},autoFocus:!0,children:"Yes"})]})]})}):null,Sw=({visible:n,size:r,onSizeChange:o,onApply:s,onCancel:l})=>{const d=L.useRef(null);if(L.useEffect(()=>{n&&d.current&&(d.current.focus(),d.current.select())},[n]),!n)return null;const b=[2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32];return i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10003},onClick:p=>{p.target===p.currentTarget&&l()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:p=>p.stopPropagation(),children:[i.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Set Size"}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Size (pixels):"}),i.jsx("input",{ref:d,type:"number",min:"1",max:"99",value:r,onChange:p=>{const v=parseInt(p.target.value)||1,m=Math.max(1,Math.min(99,v));o(m)},onKeyDown:p=>{if(p.key==="Enter"?s():p.key==="Escape"&&l(),p.key.length===1&&/[0-9]/.test(p.key)){const v=r.toString();v.length>=2&&d.current?.selectionStart===d.current?.selectionEnd&&d.current?.selectionStart===v.length&&p.preventDefault()}},onInput:p=>{const v=p.target,m=v.value;if(m.length>2){v.value=m.slice(0,2);const C=parseInt(v.value)||1;o(Math.max(1,Math.min(99,C)))}},style:{width:"100%",padding:"8px 12px",marginBottom:"16px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Or select from list:"}),i.jsxs("select",{value:b.includes(r)?r:"",onChange:p=>{const v=parseInt(p.target.value);!isNaN(v)&&v>0&&o(v)},style:{width:"100%",padding:"8px 12px",marginBottom:"20px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},children:[i.jsx("option",{value:"",style:{background:"#1f1f24",color:"#f2f2f2"},children:"-- Select --"}),b.map(p=>i.jsxs("option",{value:p,style:{background:"#1f1f24",color:"#f2f2f2"},children:[p," pixels"]},p))]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[i.jsx("button",{onClick:l,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Apply"})]})]})})},Tw=({visible:n,interval:r,onIntervalChange:o,onApply:s,onCancel:l})=>n?i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10003},onClick:d=>{d.target===d.currentTarget&&l()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:d=>d.stopPropagation(),children:[i.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Auto Save"}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Select time interval:"}),i.jsxs("select",{value:r===null?"disable":(r||5).toString(),onChange:d=>{const b=d.target.value;if(b==="disable")o(null);else{const p=parseFloat(b);!isNaN(p)&&p>0&&o(p)}},style:{width:"100%",padding:"8px 12px",marginBottom:"20px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0,children:[i.jsx("option",{value:"1",style:{background:"#1f1f24",color:"#f2f2f2"},children:"1 minute"}),i.jsx("option",{value:"5",style:{background:"#1f1f24",color:"#f2f2f2"},children:"5 minutes"}),i.jsx("option",{value:"10",style:{background:"#1f1f24",color:"#f2f2f2"},children:"10 minutes"}),i.jsx("option",{value:"20",style:{background:"#1f1f24",color:"#f2f2f2"},children:"20 minutes"}),i.jsx("option",{value:"30",style:{background:"#1f1f24",color:"#f2f2f2"},children:"30 minutes"}),i.jsx("option",{value:"disable",style:{background:"#1f1f24",color:"#f2f2f2"},children:"Disable"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[i.jsx("button",{onClick:l,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Apply"})]})]})}):null,Cw=({visible:n,interval:r,onIntervalChange:o,onEnable:s,onSkip:l})=>n?i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:d=>{d.target===d.currentTarget&&l()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:d=>d.stopPropagation(),children:[i.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Enable Auto Save?"}),i.jsx("p",{style:{margin:"0 0 20px 0",fontSize:"14px",color:"#e0e0e0",lineHeight:"1.5"},children:"We recommend enabling Auto Save to automatically save your project at regular intervals. This helps protect your work from accidental loss."}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Select time interval:"}),i.jsxs("select",{value:r===null?"disable":(r||5).toString(),onChange:d=>{const b=d.target.value;if(b==="disable")o(null);else{const p=parseFloat(b);!isNaN(p)&&p>0&&o(p)}},style:{width:"100%",padding:"8px 12px",marginBottom:"24px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0,children:[i.jsx("option",{value:"1",style:{background:"#1f1f24",color:"#f2f2f2"},children:"1 minute"}),i.jsx("option",{value:"5",style:{background:"#1f1f24",color:"#f2f2f2"},children:"5 minutes"}),i.jsx("option",{value:"10",style:{background:"#1f1f24",color:"#f2f2f2"},children:"10 minutes"}),i.jsx("option",{value:"20",style:{background:"#1f1f24",color:"#f2f2f2"},children:"20 minutes"}),i.jsx("option",{value:"30",style:{background:"#1f1f24",color:"#f2f2f2"},children:"30 minutes"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[i.jsx("button",{onClick:l,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Skip"}),i.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Enable Auto Save"})]})]})}):null,jw=({visible:n,projectDirHandle:r,onClose:o,onRestore:s,position:l,isDragging:d=!1,onDragStart:b})=>{const[p,v]=L.useState([]),[m,C]=L.useState(!1),[D,M]=L.useState(null),[S,U]=L.useState(null),_=L.useRef(null);L.useEffect(()=>{if(!n||!r){v([]),M(null),U(null);return}(async()=>{C(!0),U(null);try{let re;try{re=await r.getDirectoryHandle("history")}catch{v([]),C(!1);return}const J=ee=>{const F=ee.match(/_(\d{4})_(\d{2})_(\d{2})-(\d{2})-(\d{2})-(\d{2})\.json$/);if(F){const[,H,R,Z,Y,we,te]=F;return new Date(parseInt(H),parseInt(R)-1,parseInt(Z),parseInt(Y),parseInt(we),parseInt(te))}const $=ee.match(/_(\d{4})_(\d{2})_(\d{2})_(\d{2})_(\d{2})_(\d{2})\.json$/);if($){const[,H,R,Z,Y,we,te]=$;return new Date(parseInt(H),parseInt(R)-1,parseInt(Z),parseInt(Y),parseInt(we),parseInt(te))}return null},G=[];for await(const ee of re.keys())if(ee.endsWith(".json"))try{const $=await(await re.getFileHandle(ee)).getFile(),H=J(ee);G.push({name:ee,lastModified:new Date($.lastModified),size:$.size,timestamp:H||new Date($.lastModified)})}catch(F){console.warn(`Failed to read file ${ee}:`,F)}G.sort((ee,F)=>F.timestamp.getTime()-ee.timestamp.getTime()),v(G)}catch(re){console.error("Failed to load history files:",re),U("Failed to load history files. Please try again.")}finally{C(!1)}})()},[n,r]);const N=async()=>{if(D)try{await s(D),o()}catch(E){console.error("Failed to restore file:",E),U("Failed to restore file. Please try again.")}},g=E=>E.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),ae=E=>E<1024?`${E} B`:E<1024*1024?`${(E/1024).toFixed(1)} KB`:`${(E/(1024*1024)).toFixed(1)} MB`;if(!n)return null;const V=l?{position:"fixed",left:`${l.x}px`,top:`${l.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"500px",maxWidth:"700px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:d?"grabbing":"default"}:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"#fff",borderRadius:8,minWidth:"500px",maxWidth:"700px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column"};return i.jsxs("div",{style:V,children:[i.jsxs("div",{onMouseDown:b,style:{backgroundColor:"#f5f5f5",padding:"12px 16px",borderBottom:"1px solid #ddd",borderRadius:"8px 8px 0 0",cursor:d?"grabbing":"move",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h2",{style:{margin:0,fontSize:"16px",fontWeight:600,color:"#000"},children:"PastTime"}),i.jsx("button",{onClick:o,style:{background:"transparent",border:"none",fontSize:"20px",cursor:"pointer",color:"#666",padding:"0 4px",lineHeight:1},title:"Close",children:""})]}),i.jsxs("div",{style:{padding:"16px",display:"flex",flexDirection:"column",flex:1,minHeight:0},children:[S&&i.jsx("div",{style:{padding:"12px",backgroundColor:"#fee",color:"#c00",borderRadius:4,marginBottom:"12px"},children:S}),m?i.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"Loading history files..."}):p.length===0?i.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"No history files found."}):i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{marginBottom:"12px",color:"#333",fontSize:"14px"},children:"Select a file to restore:"}),i.jsx("div",{ref:_,style:{border:"1px solid #ddd",borderRadius:4,overflowY:"auto",maxHeight:"400px",backgroundColor:"#fafafa"},children:p.map((E,re)=>i.jsxs("div",{onClick:()=>M(E.name),style:{padding:"12px 16px",borderBottom:re<p.length-1?"1px solid #eee":"none",backgroundColor:D===E.name?"#e6f0ff":"transparent",cursor:"pointer",transition:"background-color 0.1s"},onMouseEnter:J=>{D!==E.name&&(J.currentTarget.style.backgroundColor="#f5f5f5")},onMouseLeave:J=>{D!==E.name&&(J.currentTarget.style.backgroundColor="transparent")},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"4px"},children:[i.jsx("div",{style:{fontWeight:600,color:"#000",fontSize:"13px",wordBreak:"break-word",flex:1},children:E.name}),i.jsx("div",{style:{color:"#666",fontSize:"12px",marginLeft:"12px",whiteSpace:"nowrap"},children:ae(E.size)})]}),i.jsx("div",{style:{color:"#666",fontSize:"12px"},children:g(E.lastModified)})]},E.name))})]})]}),i.jsxs("div",{style:{padding:"12px 16px",borderTop:"1px solid #ddd",display:"flex",justifyContent:"flex-end",gap:"8px"},children:[i.jsx("button",{onClick:o,style:{padding:"6px 16px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"13px"},children:"Cancel"}),i.jsx("button",{onClick:N,disabled:!D||m,style:{padding:"6px 16px",background:D&&!m?"#0066cc":"#ccc",border:"none",borderRadius:4,cursor:D&&!m?"pointer":"not-allowed",color:"#fff",fontSize:"13px",fontWeight:500},children:"Restore"})]})]})},Nw=()=>i.jsxs("svg",{width:"45",height:"30",viewBox:"0 0 45 30",style:{marginLeft:"8px",flexShrink:0},children:[i.jsx("rect",{x:"8",y:"4",width:"29",height:"14",rx:"2",ry:"2",fill:"#000"}),i.jsx("rect",{x:"10",y:"18",width:"2.5",height:"6",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"14.5",y:"18",width:"2.5",height:"6",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"19",y:"18",width:"2.5",height:"6",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"23.5",y:"18",width:"2.5",height:"6",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"28",y:"18",width:"2.5",height:"6",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"32.5",y:"18",width:"2.5",height:"6",rx:"0.5",fill:"#000"})]}),kw=()=>i.jsxs("svg",{width:"40",height:"30",viewBox:"0 0 40 30",style:{marginLeft:"8px",flexShrink:0},children:[i.jsx("rect",{x:"2",y:"11",width:"5",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"2",y:"14.5",width:"5",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"2",y:"18",width:"5",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"7",y:"6",width:"26",height:"18",rx:"2",ry:"2",fill:"#000"}),i.jsx("rect",{x:"13",y:"10",width:"14",height:"10",rx:"1.5",ry:"1.5",fill:"#fff"}),i.jsx("circle",{cx:"14.5",cy:"11.5",r:"1",fill:"#000"}),i.jsx("rect",{x:"33",y:"11",width:"5",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"33",y:"14.5",width:"5",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"33",y:"18",width:"5",height:"2.5",rx:"0.5",fill:"#000"})]}),Aw=()=>i.jsxs("svg",{width:"35",height:"35",viewBox:"0 0 35 35",style:{marginLeft:"8px",flexShrink:0},children:[i.jsx("rect",{x:"12",y:"2",width:"2.5",height:"4",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"16.25",y:"2",width:"2.5",height:"4",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"20.5",y:"2",width:"2.5",height:"4",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"2",y:"12",width:"4",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"2",y:"16.25",width:"4",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"2",y:"20.5",width:"4",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"6",y:"6",width:"23",height:"23",fill:"#000"}),i.jsx("rect",{x:"29",y:"12",width:"4",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"29",y:"16.25",width:"4",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"29",y:"20.5",width:"4",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"12",y:"29",width:"2.5",height:"4",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"16.25",y:"29",width:"2.5",height:"4",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"20.5",y:"29",width:"2.5",height:"4",rx:"0.5",fill:"#000"})]}),om=({rotate:n=0})=>{const s=n!==0?`rotate(${n} 20 20)`:"";return i.jsx("svg",{width:"40",height:"40",viewBox:"0 0 40 40",style:{marginLeft:"8px",flexShrink:0},children:i.jsxs("g",{transform:s,children:[i.jsx("rect",{x:"8",y:"10",width:"24",height:"20",rx:"2",ry:"2",fill:"#555"}),i.jsx("rect",{x:"2",y:"12",width:"6",height:"3",rx:"1",ry:"1",fill:"#555"}),i.jsx("rect",{x:"2",y:"18",width:"6",height:"3",rx:"1",ry:"1",fill:"#555"}),i.jsx("rect",{x:"2",y:"24",width:"6",height:"3",rx:"1",ry:"1",fill:"#555"}),i.jsx("rect",{x:"32",y:"12",width:"6",height:"3",rx:"1",ry:"1",fill:"#555"}),i.jsx("rect",{x:"32",y:"18",width:"6",height:"3",rx:"1",ry:"1",fill:"#555"}),i.jsx("rect",{x:"32",y:"24",width:"6",height:"3",rx:"1",ry:"1",fill:"#555"}),i.jsx("rect",{x:"12",y:"14",width:"16",height:"12",rx:"1.5",ry:"1.5",fill:"#fff"}),i.jsx("circle",{cx:"14",cy:"16",r:"1.5",fill:"#555"})]})})},Pw=()=>i.jsx(om,{rotate:0}),zw=()=>i.jsx(om,{rotate:90}),_w=({visible:n,isPad:r,onConfirm:o,onClose:s})=>{const[l,d]=L.useState("linear"),[b,p]=L.useState("vertical-edges"),[v,m]=L.useState("8"),[C,D]=L.useState("");L.useEffect(()=>{n&&(d("linear"),p("vertical-edges"),m("8"),D(""))},[n]);const M=(_,N)=>{const g=_.trim();if(g==="")return{valid:!1,error:"Number of pins is required."};const ae=parseInt(g,10);return isNaN(ae)?{valid:!1,error:"Please enter a valid number."}:ae<1?{valid:!1,error:"Number of pins must be >= 1."}:N==="linear"?ae!==Math.floor(ae)||ae<=0?{valid:!1,error:"Linear arrangement requires a positive integer."}:{valid:!0,error:"",numPins:ae}:N==="twoSided"?ae!==Math.floor(ae)||ae<=0?{valid:!1,error:"2-sided arrangement requires a positive integer."}:ae%2!==0?{valid:!1,error:"2-sided components must have an even number of pins."}:{valid:!0,error:"",numPins:ae}:N==="fourSided"?ae!==Math.floor(ae)||ae<=0?{valid:!1,error:"4-sided arrangement requires a positive integer."}:ae%4!==0?{valid:!1,error:"4-sided components must have a number of pins divisible by 4."}:{valid:!0,error:"",numPins:ae}:{valid:!0,error:"",numPins:ae}},S=_=>{let N=_===""?"":_.replace(/[^\d]/g,"");m(N);const g=M(N,l);g.error?D(g.error):D("")},U=L.useCallback(()=>{const _=M(v,l);if(!_.valid||_.numPins===void 0){D(_.error||"Invalid number of pins.");return}D(""),o({numPins:_.numPins,type:l,...l==="twoSided"?{twoSidedOrientation:b}:{}})},[v,l,b,o]);return L.useEffect(()=>{if(!n)return;const _=N=>{N.key==="Enter"&&!N.shiftKey&&!N.ctrlKey&&!N.altKey&&!N.metaKey&&(N.preventDefault(),U())};return window.addEventListener("keydown",_),()=>{window.removeEventListener("keydown",_)}},[n,U]),n?i.jsxs(i.Fragment,{children:[i.jsx("style",{children:`
        .number-input-large-spinners::-webkit-inner-spin-button,
        .number-input-large-spinners::-webkit-outer-spin-button {
          opacity: 1;
          height: 20px;
          width: 20px;
          cursor: pointer;
        }
        .number-input-large-spinners::-webkit-inner-spin-button {
          margin-right: 4px;
        }
      `}),i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},onClick:_=>{_.target===_.currentTarget&&s()},children:i.jsxs("div",{style:{backgroundColor:"#fff",padding:"20px",borderRadius:"8px",minWidth:"320px",maxWidth:"380px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},onClick:_=>_.stopPropagation(),children:[i.jsxs("h2",{style:{marginTop:0,marginBottom:"20px",color:"#222",fontSize:"18px"},children:[r?"Pad Pattern":"Via Pattern"," Placement"]}),i.jsxs("div",{style:{marginBottom:"15px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#222",fontWeight:500},children:"Arrangement:"}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[i.jsx("input",{type:"radio",value:"linear",checked:l==="linear",onChange:_=>{const N=_.target.value;d(N);const g=M(v,N);g.error?D(g.error):D("")},style:{marginRight:"8px"}}),i.jsx("span",{style:{color:"#222"},children:"Linear (1 side)"}),i.jsx(Nw,{})]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[i.jsx("input",{type:"radio",value:"twoSided",checked:l==="twoSided",onChange:_=>{const N=_.target.value;d(N);const g=M(v,N);g.error?D(g.error):D("")},style:{marginRight:"8px"}}),i.jsx("span",{style:{color:"#222"},children:"2-Sided"}),i.jsx(kw,{})]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[i.jsx("input",{type:"radio",value:"fourSided",checked:l==="fourSided",onChange:_=>{const N=_.target.value;d(N);const g=M(v,N);g.error?D(g.error):D("")},style:{marginRight:"8px"}}),i.jsx("span",{style:{color:"#222"},children:"4-Sided"}),i.jsx(Aw,{})]})]})]}),l==="twoSided"&&i.jsxs("div",{style:{marginBottom:"15px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#222",fontWeight:500},children:"Orientation:"}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[i.jsx("input",{type:"radio",value:"vertical-edges",checked:b==="vertical-edges",onChange:_=>p(_.target.value),style:{marginRight:"8px"}}),i.jsxs("span",{style:{color:"#222"},children:["Vertical ",r?"Pads":"Vias"," (left & right)"]}),i.jsx(Pw,{})]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[i.jsx("input",{type:"radio",value:"horizontal-edges",checked:b==="horizontal-edges",onChange:_=>p(_.target.value),style:{marginRight:"8px"}}),i.jsxs("span",{style:{color:"#222"},children:["Horizontal ",r?"Pads":"Vias"," (top & bottom)"]}),i.jsx(zw,{})]})]})]}),i.jsxs("div",{style:{marginBottom:"15px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#222",fontWeight:500},children:"Number of Pins:"}),i.jsx("input",{type:"number",min:l==="linear"?1:l==="twoSided"?2:4,step:l==="linear"?1:l==="twoSided"?2:4,value:v,onChange:_=>S(_.target.value),onBlur:()=>{const _=M(v,l);_.valid?D(""):D(_.error)},style:{width:"80px",padding:"6px 24px 6px 6px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px",color:"#000",background:"#fff"},className:"number-input-large-spinners"}),C&&i.jsx("div",{style:{color:"#d32f2f",fontSize:"12px",marginTop:"4px"},children:C})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",marginTop:"20px"},children:[i.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:U,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"OK"})]})]})})]}):null};function Dw(n,r){const o={x:n.x,y:n.y},s={x:r.x,y:r.y},l={x:s.x,y:o.y},d={x:o.x,y:s.y};return{corner1:o,corner2:l,corner3:s,corner4:d}}function Rw(n){if(n.numPins<1)throw new Error("Number of pins must be >= 1.");if(n.type==="twoSided"){if(n.numPins%2!==0)throw new Error("2-sided components must have an even number of pins.");if(!n.twoSidedOrientation)throw new Error("Orientation required for 2-sided components.")}if(n.type==="fourSided"&&n.numPins%4!==0)throw new Error("4-sided components must have N divisible by 4.");if(Math.abs(n.point1.x-n.point2.x)<.001||Math.abs(n.point1.y-n.point2.y)<.001)throw new Error("Area must have non-zero width and height.")}function Iw(n,r){const o=[],{corner1:s,corner2:l,corner3:d,corner4:b}=r,p=Math.abs(l.x-s.x),v=Math.abs(d.y-l.y);if(p>v){const m=(s.y+b.y)/2,C=Math.min(s.x,l.x),D=Math.max(s.x,l.x),M=D-C,S=n.numPins>1?M/(n.numPins-1):0,U=Math.hypot(s.x-C,s.y-m),_=Math.hypot(s.x-D,s.y-m),N=U<_;if(n.numPins===1)o.push({pinNumber:1,x:(C+D)/2,y:m});else for(let g=1;g<=n.numPins;g++){const ae=N?C+(g-1)*S:D-(g-1)*S;o.push({pinNumber:g,x:ae,y:m})}}else{const m=(s.x+l.x)/2,C=Math.min(s.y,l.y),D=Math.max(d.y,b.y),M=D-C,S=n.numPins>1?M/(n.numPins-1):0,U=Math.hypot(s.x-m,s.y-C),_=Math.hypot(s.x-m,s.y-D),N=U<_;if(n.numPins===1)o.push({pinNumber:1,x:m,y:(C+D)/2});else for(let g=1;g<=n.numPins;g++){const ae=N?C+(g-1)*S:D-(g-1)*S;o.push({pinNumber:g,x:m,y:ae})}}return o}function Lw(n,r){const o=[],{corner1:s,corner2:l,corner3:d,corner4:b}=r,p=n.type==="fourSided"?n.numPins/4:n.numPins/2,v=Math.min(s.x,l.x,d.x,b.x),m=Math.min(s.y,l.y,d.y,b.y),C=Math.abs(s.y-m)<.001,D=Math.abs(s.x-v)<.001,M=C?D?"TopLeft":"TopRight":D?"BottomLeft":"BottomRight",S=Math.max(s.x,l.x,d.x,b.x),U=Math.max(s.y,l.y,d.y,b.y),_=(R,Z,Y=.001)=>{const we=[s,l,d,b];for(const te of we)if(Math.abs(te.x-R)<Y&&Math.abs(te.y-Z)<Y)return te;return null},N=_(v,m)||s,g=_(S,m)||l,ae=_(S,U)||d,V=_(v,U)||b,E={start:N,end:V,name:"Left",direction:"Down"},re={start:V,end:ae,name:"Bottom",direction:"Right"},J={start:ae,end:g,name:"Right",direction:"Up"},G={start:g,end:N,name:"Top",direction:"Left"};let ee;const F=[];if(M==="TopLeft"?(ee=E,F.push(E,re,J,G)):M==="BottomLeft"?(ee=re,F.push(re,J,G,E)):M==="BottomRight"?(ee=J,F.push(J,G,E,re)):(ee=G,F.push(G,E,re,J)),n.type==="twoSided"){if(n.twoSidedOrientation==="vertical-edges"){if(M!=="TopLeft"&&M!=="BottomRight")throw new Error(`Invalid Pin 1 location for Left/Right orientation. Pin 1 is at ${M}, but must be at Top-Left or Bottom-Right.`)}else if(M!=="TopRight"&&M!=="BottomLeft")throw new Error(`Invalid Pin 1 location for Top/Bottom orientation. Pin 1 is at ${M}, but must be at Top-Right or Bottom-Left.`)}const $=[];n.type==="fourSided"?$.push(...F):n.twoSidedOrientation==="vertical-edges"?ee===E?$.push(E,J):$.push(J,E):ee===G?$.push(G,re):$.push(re,G);let H=1;for(const R of $){const Z=Math.hypot(R.end.x-R.start.x,R.end.y-R.start.y),Y=n.type==="fourSided"?Z/(p+1):p>1?Z/(p-1):0,we=[];if(n.type==="fourSided")if(R.direction==="Down")for(let te=1;te<=p;te++)we.push({x:R.start.x,y:R.start.y+te*Y});else if(R.direction==="Right")for(let te=1;te<=p;te++)we.push({x:R.start.x+te*Y,y:R.start.y});else if(R.direction==="Up")for(let te=1;te<=p;te++)we.push({x:R.start.x,y:R.start.y-te*Y});else for(let te=1;te<=p;te++)we.push({x:R.start.x-te*Y,y:R.start.y});else if(p===1){const te=(R.start.x+R.end.x)/2,de=(R.start.y+R.end.y)/2;we.push({x:te,y:de})}else if(R.direction==="Down")for(let te=0;te<p;te++)we.push({x:R.start.x,y:R.start.y+te*Y});else if(R.direction==="Right")for(let te=0;te<p;te++)we.push({x:R.start.x+te*Y,y:R.start.y});else if(R.direction==="Up")for(let te=0;te<p;te++)we.push({x:R.start.x,y:R.start.y-te*Y});else for(let te=0;te<p;te++)we.push({x:R.start.x-te*Y,y:R.start.y});if(R===ee){let te=0,de=1/0;for(let Ie=0;Ie<we.length;Ie++){const xe=Math.hypot(we[Ie].x-s.x,we[Ie].y-s.y);xe<de&&(de=xe,te=Ie)}const je=Math.hypot(R.start.x-s.x,R.start.y-s.y);if(de<je&&te>0){const Ie=we.slice(0,te),xe=we.slice(te);we.length=0,we.push(...xe,...Ie)}}for(const te of we)o.push({pinNumber:H++,x:te.x,y:te.y})}return o}function Mw(n){Rw(n);const r=Dw(n.point1,n.point2);return n.type==="linear"?Iw(n,r):Lw(n,r)}function Bw(){const[n,r]=L.useState([]),[o,s]=L.useState(!1),[l,d]=L.useState([]),[b,p]=L.useState(null),[v,m]=L.useState("trace"),[C,D]=L.useState("top"),M=L.useRef([]),S=L.useRef(0),U=L.useRef(!1),_=L.useCallback(()=>{s(!0),d([]),M.current=[]},[]),N=L.useCallback(()=>{s(!1),d([]),M.current=[]},[]),g=L.useCallback(V=>{d(E=>[...E,V]),M.current=[...M.current,V]},[]),ae=L.useCallback(V=>{r(E=>[...E,V]),d([]),M.current=[]},[]);return{drawingStrokes:n,setDrawingStrokes:r,isDrawing:o,setIsDrawing:s,currentStroke:l,setCurrentStroke:d,tracePreviewMousePos:b,setTracePreviewMousePos:p,drawingMode:v,setDrawingMode:m,selectedDrawingLayer:C,setSelectedDrawingLayer:D,currentStrokeRef:M,lastTraceClickTimeRef:S,isDoubleClickingTraceRef:U,startDrawing:_,stopDrawing:N,addPointToStroke:g,finishStroke:ae}}function Ow(){const[n,r]=L.useState(new Set),[o,s]=L.useState(!1),[l,d]=L.useState(new Set),[b,p]=L.useState(new Set),[v,m]=L.useState(new Set),C=L.useCallback(()=>{r(new Set),d(new Set),p(new Set),m(new Set)},[]),D=L.useCallback((U,_="stroke")=>{_==="stroke"?r(N=>new Set([...N,U])):_==="component"?d(N=>new Set([...N,U])):_==="power"?p(N=>new Set([...N,U])):_==="ground"&&m(N=>new Set([...N,U]))},[]),M=L.useCallback((U,_="stroke")=>{_==="stroke"?r(N=>{const g=new Set(N);return g.delete(U),g}):_==="component"?d(N=>{const g=new Set(N);return g.delete(U),g}):_==="power"?p(N=>{const g=new Set(N);return g.delete(U),g}):_==="ground"&&m(N=>{const g=new Set(N);return g.delete(U),g})},[]),S=L.useCallback((U,_="stroke")=>{_==="stroke"?r(U):_==="component"?d(U):_==="power"?p(U):_==="ground"&&m(U)},[]);return{selectedIds:n,setSelectedIds:r,isSelecting:o,setIsSelecting:s,selectedComponentIds:l,setSelectedComponentIds:d,selectedPowerIds:b,setSelectedPowerIds:p,selectedGroundIds:v,setSelectedGroundIds:m,clearSelection:C,addToSelection:D,removeFromSelection:M,setSelection:S}}function Fw(){const[n,r]=L.useState(null),[o,s]=L.useState(!1),[l,d]=L.useState(null),[b,p]=L.useState("nudge"),v=L.useCallback((C,D)=>{r(C),s(!0),d(D)},[]),m=L.useCallback(()=>{s(!1),r(null),d(null)},[]);return{selectedImageForTransform:n,setSelectedImageForTransform:r,isTransforming:o,setIsTransforming:s,transformStartPos:l,setTransformStartPos:d,transformMode:b,setTransformMode:p,startTransform:v,stopTransform:m}}function Uw(){const[n,r]=L.useState(null),[o,s]=L.useState(null),[l,d]=L.useState("overlay"),[b,p]=L.useState(50),[v,m]=L.useState(!1),[C,D]=L.useState(2e3),[M,S]=L.useState(!1),U=L.useCallback(g=>{r(g)},[]),_=L.useCallback(g=>{s(g)},[]),N=L.useCallback(()=>{r(null),s(null)},[]);return{topImage:n,setTopImage:r,bottomImage:o,setBottomImage:s,currentView:l,setCurrentView:d,transparency:b,setTransparency:p,isTransparencyCycling:v,setIsTransparencyCycling:m,transparencyCycleSpeed:C,setTransparencyCycleSpeed:D,isGrayscale:M,setIsGrayscale:S,loadTopImage:U,loadBottomImage:_,clearImages:N}}function Ew(){const[n,r]=L.useState(1),[o,s]=L.useState({x:0,y:0}),[l,d]=L.useState(0),[b,p]=L.useState(!1),[v,m]=L.useState(!1),[C,D]=L.useState(!1),M=L.useCallback(()=>{r(1),s({x:0,y:0}),d(0),p(!1)},[]),S=L.useCallback((V=1.2)=>{r(E=>E*V)},[]),U=L.useCallback((V=1.2)=>{r(E=>E/V)},[]),_=L.useCallback(V=>{r(V)},[]),N=L.useCallback((V,E,re)=>{const J=V/re,G=E/re;s(ee=>({x:ee.x-J,y:ee.y-G}))},[]),g=L.useCallback((V,E)=>{s({x:V,y:E})},[]),ae=L.useCallback((V,E)=>({x:V-o.x*n,y:E-o.y*n}),[o,n]);return{viewScale:n,setViewScale:r,cameraWorldCenter:o,setCameraWorldCenter:s,viewRotation:l,setViewRotation:d,viewFlipX:b,setViewFlipX:p,isShiftConstrained:v,setIsShiftConstrained:m,showBothLayers:C,setShowBothLayers:D,resetView:M,zoomIn:S,zoomOut:U,setZoom:_,pan:N,setCameraCenter:g,getViewPan:ae}}function Vw(){const[n,r]=L.useState(()=>[{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),[o,s]=L.useState(()=>[{id:"groundbus-circuit",name:"GND",color:"#000000"}]),[l,d]=L.useState([]),[b,p]=L.useState([]),[v,m]=L.useState(null),[C,D]=L.useState(null),M=L.useCallback(J=>{r(G=>[...G,J])},[]),S=L.useCallback((J,G)=>{r(ee=>ee.map(F=>F.id===J?{...F,...G}:F))},[]),U=L.useCallback(J=>{r(G=>G.filter(ee=>ee.id!==J)),d(G=>G.filter(ee=>ee.powerBusId!==J))},[]),_=L.useCallback(J=>{d(G=>[...G,J])},[]),N=L.useCallback(J=>{d(G=>G.filter(ee=>ee.id!==J))},[]),g=L.useCallback(J=>{p(G=>[...G,J])},[]),ae=L.useCallback(J=>{p(G=>G.filter(ee=>ee.id!==J))},[]),V=L.useCallback(J=>{s(G=>[...G,J])},[]),E=L.useCallback((J,G)=>{s(ee=>ee.map(F=>F.id===J?{...F,...G}:F))},[]),re=L.useCallback(J=>{s(G=>G.filter(ee=>ee.id!==J)),p(G=>G.filter(ee=>ee.groundBusId===J))},[]);return{powerBuses:n,setPowerBuses:r,groundBuses:o,setGroundBuses:s,powerSymbols:l,setPowerSymbols:d,groundSymbols:b,setGroundSymbols:p,powerEditor:v,setPowerEditor:m,groundEditor:C,setGroundEditor:D,addPowerBus:M,updatePowerBus:S,removePowerBus:U,addPowerSymbol:_,removePowerSymbol:N,addGroundSymbol:g,removeGroundSymbol:ae,addGroundBus:V,updateGroundBus:E,removeGroundBus:re}}const Ci={brushColor:"#008080",brushSize:6,topTraceColor:"#AA4499",bottomTraceColor:"#F781BF",topTraceSize:6,bottomTraceSize:6,viaSize:18,viaColor:"#ff0000",topPadColor:"#0072B2",bottomPadColor:"#56B4E9",topPadSize:18,bottomPadSize:18,topTestPointColor:"#FFFF00",bottomTestPointColor:"#FFFF00",topTestPointSize:18,bottomTestPointSize:18,topComponentColor:"#8C564B",bottomComponentColor:"#9C755F",topComponentSize:18,bottomComponentSize:18,componentConnectionColor:"#E69F00",componentConnectionSize:3};function qw(){const[n,r]=L.useState(Ci.brushColor),[o,s]=L.useState(Ci.brushSize),[l,d]=L.useState(Ci.topTraceColor),[b,p]=L.useState(Ci.bottomTraceColor),[v,m]=L.useState(Ci.topTraceSize),[C,D]=L.useState(Ci.bottomTraceSize),[M,S]=L.useState(Ci.topPadColor),[U,_]=L.useState(Ci.bottomPadColor),[N,g]=L.useState(Ci.topPadSize),[ae,V]=L.useState(Ci.bottomPadSize),[E,re]=L.useState(Ci.topTestPointColor),[J,G]=L.useState(Ci.bottomTestPointColor),[ee,F]=L.useState(Ci.topTestPointSize),[$,H]=L.useState(Ci.bottomTestPointSize),[R,Z]=L.useState(Ci.topComponentColor),[Y,we]=L.useState(Ci.bottomComponentColor),[te,de]=L.useState(Ci.topComponentSize),[je,Ie]=L.useState(Ci.bottomComponentSize),[xe,k]=L.useState(Ci.componentConnectionColor),[A,q]=L.useState(Ci.componentConnectionSize),W=L.useCallback(()=>{r(Ci.brushColor),s(Ci.brushSize),d(Ci.topTraceColor),p(Ci.bottomTraceColor),m(Ci.topTraceSize),D(Ci.bottomTraceSize),S(Ci.topPadColor),_(Ci.bottomPadColor),g(Ci.topPadSize),V(Ci.bottomPadSize),re(Ci.topTestPointColor),G(Ci.bottomTestPointColor),F(Ci.topTestPointSize),H(Ci.bottomTestPointSize),Z(Ci.topComponentColor),we(Ci.bottomComponentColor),de(Ci.topComponentSize),Ie(Ci.bottomComponentSize),k(Ci.componentConnectionColor),q(Ci.componentConnectionSize)},[]),se=L.useCallback(be=>{be.brushColor!==void 0&&r(be.brushColor),be.brushSize!==void 0&&s(be.brushSize),be.topTraceColor!==void 0&&d(be.topTraceColor),be.bottomTraceColor!==void 0&&p(be.bottomTraceColor),be.topTraceSize!==void 0&&m(be.topTraceSize),be.bottomTraceSize!==void 0&&D(be.bottomTraceSize),be.topPadColor!==void 0&&S(be.topPadColor),be.bottomPadColor!==void 0&&_(be.bottomPadColor),be.topPadSize!==void 0&&g(be.topPadSize),be.bottomPadSize!==void 0&&V(be.bottomPadSize),be.topTestPointColor!==void 0&&re(be.topTestPointColor),be.bottomTestPointColor!==void 0&&G(be.bottomTestPointColor),be.topTestPointSize!==void 0&&F(be.topTestPointSize),be.bottomTestPointSize!==void 0&&H(be.bottomTestPointSize),be.topComponentColor!==void 0&&Z(be.topComponentColor),be.bottomComponentColor!==void 0&&we(be.bottomComponentColor),be.topComponentSize!==void 0&&de(be.topComponentSize),be.bottomComponentSize!==void 0&&Ie(be.bottomComponentSize),be.componentConnectionColor!==void 0&&k(be.componentConnectionColor),be.componentConnectionSize!==void 0&&q(be.componentConnectionSize)},[]),Ce=L.useCallback((be,De,Ge)=>{},[]),le=L.useCallback((be,De,Ge)=>{},[]),_e=L.useCallback(()=>({brushColor:n,brushSize:o,topTraceColor:l,bottomTraceColor:b,topTraceSize:v,bottomTraceSize:C,viaSize:Ci.viaSize,viaColor:Ci.viaColor,topPadColor:M,bottomPadColor:U,topPadSize:N,bottomPadSize:ae,topTestPointColor:E,bottomTestPointColor:J,topTestPointSize:ee,bottomTestPointSize:$,topComponentColor:R,bottomComponentColor:Y,topComponentSize:te,bottomComponentSize:je,componentConnectionColor:xe,componentConnectionSize:A}),[n,o,l,b,v,C,M,U,N,ae,E,J,ee,$,R,Y,te,je,xe,A]);return{brushColor:n,setBrushColor:r,brushSize:o,setBrushSize:s,topTraceColor:l,setTopTraceColor:d,bottomTraceColor:b,setBottomTraceColor:p,topTraceSize:v,setTopTraceSize:m,bottomTraceSize:C,setBottomTraceSize:D,topPadColor:M,setTopPadColor:S,bottomPadColor:U,setBottomPadColor:_,topPadSize:N,setTopPadSize:g,bottomPadSize:ae,setBottomPadSize:V,topTestPointColor:E,setTopTestPointColor:re,bottomTestPointColor:J,setBottomTestPointColor:G,topTestPointSize:ee,setTopTestPointSize:F,bottomTestPointSize:$,setBottomTestPointSize:H,topComponentColor:R,setTopComponentColor:Z,bottomComponentColor:Y,setBottomComponentColor:we,topComponentSize:te,setTopComponentSize:de,bottomComponentSize:je,setBottomComponentSize:Ie,componentConnectionColor:xe,setComponentConnectionColor:k,componentConnectionSize:A,setComponentConnectionSize:q,resetToDefaults:W,loadFromProject:se,getCurrentSettings:_e,saveDefaultSize:Ce,saveDefaultColor:le}}function Hw(n,r,o,s,l,d,b,p,v,m,C,D,M,S,U,_,N,g,ae,V,E,re,J,G,ee){const[F,$]=L.useState(()=>n()),H=L.useRef(null),R=L.useRef(s),Z=L.useRef(l),Y=L.useCallback(de=>r==="draw"&&o==="trace"?de.get("trace"):r==="draw"&&o==="via"?de.get("via"):r==="draw"&&o==="pad"?de.get("pad"):r==="component"?de.get("component"):r==="power"?de.get("power"):r==="ground"?de.get("ground"):null,[r,o]);L.useEffect(()=>{$(de=>{const je=Y(de),Ie=je?.id||null,xe=H.current,k=new Map(de);if(xe&&xe!==Ie){const A=de.get(xe);A&&k.set(xe,{...A,settings:{color:R.current,size:Z.current}})}if(je&&Ie!==xe)if(r==="draw"&&o==="trace"){const A=re||"top",q=A==="top"?d:b,W=A==="top"?p:v;R.current=q,Z.current=W,k.set("trace",{...je,settings:{color:q,size:W}})}else if(r==="draw"&&o==="pad"){const A=J||"top",q=A==="top"?m:C,W=A==="top"?D:M;R.current=q,Z.current=W,k.set("pad",{...je,settings:{color:q,size:W}})}else if(r==="component"){const A=ee||"top",q=A==="top"?g:ae,W=A==="top"?V:E;R.current=q,Z.current=W,k.set("component",{...je,settings:{color:q,size:W}})}else R.current=je.settings.color,Z.current=je.settings.size;return H.current=Ie,k})},[r,o,d,b,p,v,m,C,D,M,g,ae,V,E,re,J,ee,Y]);const we=L.useCallback((de,je)=>{$(Ie=>{const xe=new Map(Ie),k=xe.get(de);return k&&xe.set(de,{...k,settings:je}),xe})},[]),te=L.useCallback((de,je,Ie)=>{$(xe=>{const k=new Map(xe),A=k.get(de);if(A){const q=new Map(A.layerSettings);q.set(je,Ie),k.set(de,{...A,layerSettings:q})}return k})},[]);return{toolRegistry:F,setToolRegistry:$,updateToolSettings:we,updateToolLayerSettings:te,getCurrentToolDef:Y}}function Ww(n){const{currentTool:r,drawingMode:o,traceToolLayer:s,padToolLayer:l,testPointToolLayer:d,componentToolLayer:b}=n,[p,v]=L.useState(0),m=L.useCallback(()=>r==="draw"&&o==="via"?"via":r==="draw"&&o==="pad"?l==="bottom"?"padBottom":"padTop":r==="draw"&&o==="testPoint"?d==="bottom"?"testPointBottom":"testPointTop":r==="draw"&&o==="trace"?s==="bottom"?"traceBottom":"traceTop":r==="component"?b==="bottom"?"componentBottom":"componentTop":r==="power"?"power":r==="ground"?"ground":null,[r,o,l,d,s,b]),C=L.useCallback(()=>{const U=m();if(U){const _=On.get(U);return{currentTool:r,drawingMode:o,layer:r==="draw"&&o==="pad"?l||"top":r==="draw"&&o==="testPoint"?d||"top":r==="draw"&&o==="trace"?s||"top":r==="component"?b||"top":void 0,toolInstanceId:U,color:_.color,size:_.size}}return{currentTool:r,drawingMode:o,layer:void 0,toolInstanceId:null,color:"#000000",size:10}},[r,o,l,d,s,b,m]);L.useEffect(()=>{const U=m();return U?On.subscribe(U,()=>{v(N=>N+1)}):void 0},[m]);const D=C(),M=L.useCallback(U=>{const _=m();_&&On.setColor(_,U)},[m]),S=L.useCallback(U=>{const _=m();_&&On.setSize(_,U)},[m]);return{toolState:D,setColor:M,setSize:S,getCurrentToolInstanceId:m}}function $w(){const[n,r]=L.useState(!1),[o,s]=L.useState(!1),[l,d]=L.useState(!1),[b,p]=L.useState(!1),[v,m]=L.useState(!1),[C,D]=L.useState(!1),[M,S]=L.useState(!1),[U,_]=L.useState(!1),N=L.useCallback(()=>{r(!0),s(!0),d(!0),p(!0),m(!0),D(!0),S(!0),_(!0)},[]),g=L.useCallback(()=>{r(!1),s(!1),d(!1),p(!1),m(!1),D(!1),S(!1),_(!1)},[]);return{areImagesLocked:n,setAreImagesLocked:r,areViasLocked:o,setAreViasLocked:s,arePadsLocked:l,setArePadsLocked:d,areTestPointsLocked:b,setAreTestPointsLocked:p,areTracesLocked:v,setAreTracesLocked:m,areComponentsLocked:C,setAreComponentsLocked:D,areGroundNodesLocked:M,setAreGroundNodesLocked:S,arePowerNodesLocked:U,setArePowerNodesLocked:_,lockAll:N,unlockAll:g}}function Yw(){const[n,r]=L.useState(null),[o,s]=L.useState({visible:!1,size:6}),[l,d]=L.useState({visible:!1,interval:5}),[b,p]=L.useState({visible:!1,source:null,interval:5}),[v,m]=L.useState({visible:!1,text:""}),[C,D]=L.useState({visible:!1,title:"",message:""}),[M,S]=L.useState({visible:!1}),[U,_]=L.useState({visible:!1}),[N,g]=L.useState({visible:!1,projectName:"",locationPath:"",locationHandle:null}),[ae,V]=L.useState({visible:!1,filename:"",locationPath:"",locationHandle:null}),[E,re]=L.useState(!1),[J,G]=L.useState(!0),[ee,F]=L.useState(!1);return{openMenu:n,setOpenMenu:r,setSizeDialog:o,setSetSizeDialog:s,autoSaveDialog:l,setAutoSaveDialog:d,autoSavePromptDialog:b,setAutoSavePromptDialog:p,debugDialog:v,setDebugDialog:m,errorDialog:C,setErrorDialog:D,newProjectDialog:M,setNewProjectDialog:S,openProjectDialog:U,setOpenProjectDialog:_,newProjectSetupDialog:N,setNewProjectSetupDialog:g,saveAsDialog:ae,setSaveAsDialog:V,showColorPicker:E,setShowColorPicker:re,showWelcomeDialog:J,setShowWelcomeDialog:G,transformImagesDialogVisible:ee,setTransformImagesDialogVisible:F}}function Gw(){const[n,r]=L.useState(!1),[o,s]=L.useState(1),[l,d]=L.useState(null),[b,p]=L.useState(""),[v,m]=L.useState(""),[C,D]=L.useState(null),[M,S]=L.useState("pcb_project"),[U,_]=L.useState([]),[N,g]=L.useState(-1),ae=L.useRef(null),V=L.useRef(!1),E=L.useRef(!1);return{autoSaveEnabled:n,setAutoSaveEnabled:r,autoSaveInterval:o,setAutoSaveInterval:s,autoSaveDirHandle:l,setAutoSaveDirHandle:d,autoSaveBaseName:b,setAutoSaveBaseName:p,currentProjectFilePath:v,setCurrentProjectFilePath:m,projectDirHandle:C,setProjectDirHandle:D,projectName:M,setProjectName:S,autoSaveFileHistory:U,setAutoSaveFileHistory:_,currentFileIndex:N,setCurrentFileIndex:g,autoSaveIntervalRef:ae,hasChangesSinceLastAutoSaveRef:V,prevAutoSaveEnabledRef:E}}function Xw(){const[n,r]=L.useState(null),o=L.useRef(!1),s=L.useCallback((p,v,m,C,D)=>{if(o.current)return;const M={drawingStrokes:JSON.parse(JSON.stringify(p)),componentsTop:JSON.parse(JSON.stringify(v)),componentsBottom:JSON.parse(JSON.stringify(m)),powerSymbols:JSON.parse(JSON.stringify(C)),groundSymbols:JSON.parse(JSON.stringify(D))};r(M)},[]),l=L.useCallback(()=>{if(!n)return null;o.current=!0;const p=n;return r(null),setTimeout(()=>{o.current=!1},100),p},[n]),d=n!==null,b=L.useCallback(()=>{r(null)},[]);return{saveSnapshot:s,undo:l,canUndo:d,clearSnapshot:b}}sx();function Kw(){const r=Uw(),{topImage:o,setTopImage:s,bottomImage:l,setBottomImage:d,currentView:b,setCurrentView:p,transparency:v,setTransparency:m,isTransparencyCycling:C,setIsTransparencyCycling:D,transparencyCycleSpeed:M,setTransparencyCycleSpeed:S,isGrayscale:U,setIsGrayscale:_}=r,[N,g]=L.useState("none"),[ae,V]=L.useState(()=>{const c=localStorage.getItem("bomExportFormat");return c==="json"||c==="pdf"?c:"pdf"});Pt.useEffect(()=>{localStorage.setItem("bomExportFormat",ae)},[ae]);const[E,re]=L.useState(()=>{const c=localStorage.getItem("netlistExportFormat");return c==="kicad"||c==="protel"||c==="spice"||c==="pads"?c:"kicad"});Pt.useEffect(()=>{localStorage.setItem("netlistExportFormat",E)},[E]);const J=qw(),{brushColor:G,setBrushColor:ee,brushSize:F,setBrushSize:$,topTraceColor:H,setTopTraceColor:R,bottomTraceColor:Z,setBottomTraceColor:Y,topTraceSize:we,setTopTraceSize:te,bottomTraceSize:de,setBottomTraceSize:je,topPadColor:Ie,setTopPadColor:xe,bottomPadColor:k,setBottomPadColor:A,topPadSize:q,setTopPadSize:W,bottomPadSize:se,setBottomPadSize:Ce,topTestPointColor:le,setTopTestPointColor:_e,bottomTestPointColor:be,setBottomTestPointColor:De,topTestPointSize:Ge,setTopTestPointSize:ot,bottomTestPointSize:jt,setBottomTestPointSize:Ht,topComponentColor:ge,setTopComponentColor:lt,bottomComponentColor:Yt,setBottomComponentColor:Gt,topComponentSize:xt,setTopComponentSize:hn,bottomComponentSize:Et,setBottomComponentSize:gn,componentConnectionColor:Zt,setComponentConnectionColor:xn,componentConnectionSize:tt,setComponentConnectionSize:Rn,saveDefaultSize:Lt,saveDefaultColor:Wt}=J,vn=Bw(),{drawingStrokes:ct,setDrawingStrokes:ye,isDrawing:ze,setIsDrawing:Nt,currentStroke:Ke,setCurrentStroke:vt,tracePreviewMousePos:Vt,setTracePreviewMousePos:ht,drawingMode:Je,setDrawingMode:Ft,selectedDrawingLayer:At,setSelectedDrawingLayer:Jt,currentStrokeRef:An,lastTraceClickTimeRef:dn,isDoubleClickingTraceRef:ti}=vn,Tr=Fw(),{selectedImageForTransform:en,setSelectedImageForTransform:zi,isTransforming:Mr,setIsTransforming:qt,transformStartPos:Zi,setTransformStartPos:Ji,transformMode:Cr,setTransformMode:jr}=Tr,hi=Ew(),{viewScale:wt,setViewScale:Wn,viewRotation:mn,setViewRotation:Ot,viewFlipX:Dt,setViewFlipX:an,cameraWorldCenter:rn,setCameraWorldCenter:bn,resetView:ni,isShiftConstrained:hr,setIsShiftConstrained:Di,showBothLayers:qi,setShowBothLayers:Br,setCameraCenter:_i,getViewPan:ar}=hi,[ui,zo]=L.useState("top"),[Hn,ys]=L.useState("top"),[di,Wo]=L.useState("top"),[Ri,Ds]=L.useState("top"),ts=Pt.useRef("top"),ns=Pt.useRef("top"),xs=Pt.useRef("top"),Or=Pt.useRef("top");Pt.useEffect(()=>{ts.current=ui},[ui]),Pt.useEffect(()=>{ns.current=Hn},[Hn]),Pt.useEffect(()=>{xs.current=di},[di]),Pt.useEffect(()=>{Or.current=Ri},[Ri]);const Xs=Ww({currentTool:N,drawingMode:Je,traceToolLayer:ui,padToolLayer:Hn,testPointToolLayer:di,componentToolLayer:Ri}),{toolState:Nr}=Xs,Mi=Hw(J5,N,Je,G,F,H,Z,we,de,Ie,k,q,se,le,be,Ge,jt,ge,Yt,xt,Et,ui,Hn,di,Ri),{toolRegistry:fi,setToolRegistry:gr,getCurrentToolDef:is,updateToolSettings:Xl,updateToolLayerSettings:bo}=Mi,co=Pt.useRef(null),Hi=Pt.useRef(G),Qo=Pt.useRef(F);Pt.useEffect(()=>{gr(c=>{const x=is(c),P=x?.id||null,B=co.current,K=new Map(c);if(B&&B!==P){const ne=c.get(B);ne&&K.set(B,{...ne,settings:{color:Hi.current,size:Qo.current}})}if(x&&P!==B)if(N==="draw"&&Je==="trace"){const ne=ui||"top",z=ne==="top"?H:Z,Ne=ne==="top"?we:de;ee(z),$(Ne),Hi.current=z,Qo.current=Ne;const ve=new Map(x.layerSettings);ve.set("top",{color:H,size:we}),ve.set("bottom",{color:Z,size:de}),K.set("trace",{...x,settings:{color:z,size:Ne},layerSettings:ve})}else if(N==="draw"&&Je==="pad"){const ne=Hn||"top",z=ne==="top"?Ie:k,Ne=ne==="top"?q:se;ee(z),$(Ne),Hi.current=z,Qo.current=Ne;const ve=new Map(x.layerSettings);ve.set("top",{color:Ie,size:q}),ve.set("bottom",{color:k,size:se}),K.set("pad",{...x,settings:{color:z,size:Ne},layerSettings:ve})}else if(N==="draw"&&Je==="testPoint"){const ne=di||"top",z=ne==="top"?le:be,Ne=ne==="top"?Ge:jt;ee(z),$(Ne),Hi.current=z,Qo.current=Ne;const ve=new Map(x.layerSettings);ve.set("top",{color:le,size:Ge}),ve.set("bottom",{color:be,size:jt}),K.set("testPoint",{...x,settings:{color:z,size:Ne},layerSettings:ve})}else if(N==="component"){const ne=Ri||"top",z=ne==="top"?ge:Yt,Ne=ne==="top"?xt:Et;ee(z),$(Ne),Hi.current=z,Qo.current=Ne;const ve=new Map(x.layerSettings);ve.set("top",{color:ge,size:xt}),ve.set("bottom",{color:Yt,size:Et}),K.set("component",{...x,settings:{color:z,size:Ne},layerSettings:ve})}else{const ne=x.settings;ee(ne.color),$(ne.size),Hi.current=ne.color,Qo.current=ne.size}return co.current=P,K})},[N,Je,is,H,Z,we,de,Ie,k,q,se,le,be,Ge,jt,di,ge,Yt,xt,Et]),Pt.useEffect(()=>{const c=fi.get("trace");if(c){const K=c.layerSettings.get("top"),ne=c.layerSettings.get("bottom");K&&(R(K.color),te(K.size)),ne&&(Y(ne.color),je(ne.size))}const x=fi.get("pad");if(x){const K=x.layerSettings.get("top"),ne=x.layerSettings.get("bottom");K&&(xe(K.color),W(K.size)),ne&&(A(ne.color),Ce(ne.size))}const P=fi.get("testPoint");if(P){const K=P.layerSettings.get("top"),ne=P.layerSettings.get("bottom");K&&(_e(K.color),ot(K.size)),ne&&(De(ne.color),Ht(ne.size))}const B=fi.get("component");if(B){const K=B.layerSettings.get("top"),ne=B.layerSettings.get("bottom");K&&(lt(K.color),hn(K.size)),ne&&(Gt(ne.color),gn(ne.size))}},[]),Pt.useEffect(()=>{gr(c=>{const x=new Map(c),P=c.get("trace");if(P){const Ne=new Map(P.layerSettings);Ne.set("top",{color:H,size:we}),Ne.set("bottom",{color:Z,size:de}),x.set("trace",{...P,layerSettings:Ne})}const B=c.get("pad");if(B){const Ne=new Map(B.layerSettings);Ne.set("top",{color:Ie,size:q}),Ne.set("bottom",{color:k,size:se}),x.set("pad",{...B,layerSettings:Ne})}const K=c.get("testPoint");if(K){const Ne=new Map(K.layerSettings);Ne.set("top",{color:le,size:Ge}),Ne.set("bottom",{color:be,size:jt}),x.set("testPoint",{...K,layerSettings:Ne})}const ne=c.get("component");if(ne){const Ne=new Map(ne.layerSettings);Ne.set("top",{color:ge,size:xt}),Ne.set("bottom",{color:Yt,size:Et}),x.set("component",{...ne,layerSettings:Ne})}const z=c.get("componentConnection");return z&&x.set("componentConnection",{...z,settings:{color:Zt,size:tt}}),x})},[H,Z,we,de,Ie,k,q,se,le,be,Ge,jt,ge,Yt,xt,Et,Zt,tt,gr]),Pt.useEffect(()=>{gr(c=>{const x=is(c);if(x)if(N==="draw"&&Je==="trace"){const P=ui||"top",B=P==="top"?"traceTop":"traceBottom",K=On.get(B),ne=K.color,z=K.size;P==="top"?(R(ne),te(z),Wt("trace",ne,"top"),Lt("trace",z,"top")):(Y(ne),je(z),Wt("trace",ne,"bottom"),Lt("trace",z,"bottom"));const Ne=new Map(c),ve=new Map(x.layerSettings);return ve.set(P,{color:ne,size:z}),Ne.set(x.id,{...x,layerSettings:ve,settings:{color:ne,size:z}}),Hi.current=ne,Qo.current=z,Ne}else if(N==="draw"&&Je==="pad"){const P=Hn||"top",B=P==="top"?"padTop":"padBottom",K=On.get(B),ne=K.color,z=K.size;P==="top"?(xe(ne),W(z),Wt("pad",ne,"top"),Lt("pad",z,"top")):(A(ne),Ce(z),Wt("pad",ne,"bottom"),Lt("pad",z,"bottom"));const Ne=new Map(c),ve=new Map(x.layerSettings);return ve.set(P,{color:ne,size:z}),Ne.set(x.id,{...x,layerSettings:ve,settings:{color:ne,size:z}}),Hi.current=ne,Qo.current=z,Ne}else if(N==="draw"&&Je==="testPoint"){const P=di||"top",B=P==="top"?"testPointTop":"testPointBottom",K=On.get(B),ne=K.color,z=K.size;P==="top"?(_e(ne),ot(z),Wt("testPoint",ne,"top"),Lt("testPoint",z,"top")):(De(ne),Ht(z),Wt("testPoint",ne,"bottom"),Lt("testPoint",z,"bottom"));const Ne=new Map(c),ve=new Map(x.layerSettings);return ve.set(P,{color:ne,size:z}),Ne.set(x.id,{...x,layerSettings:ve,settings:{color:ne,size:z}}),Hi.current=ne,Qo.current=z,Ne}else if(N==="component"){const P=Ri||"top",B=P==="top"?"componentTop":"componentBottom",K=On.get(B),ne=K.color,z=K.size;P==="top"?(lt(ne),hn(z),Wt("component",ne,"top"),Lt("component",z,"top")):(Gt(ne),gn(z),Wt("component",ne,"bottom"),Lt("component",z,"bottom"));const Ne=new Map(c),ve=new Map(x.layerSettings);return ve.set(P,{color:ne,size:z}),Ne.set(x.id,{...x,layerSettings:ve,settings:{color:ne,size:z}}),Hi.current=ne,Qo.current=z,Ne}else{const P=new Map(c);return P.set(x.id,{...x,settings:{color:G,size:F}}),Hi.current=G,Qo.current=F,P}return c})},[G,F,N,Je,ui,Hn,di,Ri,is,Wt,Lt,tf,R,Y,te,je,xe,A,W,Ce,_e,De,ot,Ht,lt,Gt,hn,gn]),Pt.useEffect(()=>{if(N==="draw"&&Je==="trace"){const c=ui;Jt(c),ee(c==="top"?H:Z),$(c==="top"?we:de),c==="top"?(Yr(!0),fs(!0)):(jo(!0),Li(!0)),Ll(!0)}else Ll(!1)},[N,Je,ui,H,Z,we,de]),Pt.useEffect(()=>{if(N==="draw"&&Je==="pad"){const c=Hn;Jt(c);const x=On.get(c==="top"?"padTop":"padBottom");ee(x.color),$(x.size),c==="top"?(Yr(!0),ua(!0)):(jo(!0),ja(!0)),ju(!0)}else ju(!1)},[N,Je,Hn]),Pt.useEffect(()=>{if(N==="draw"&&Je==="testPoint"){const c=di;Jt(c),ee(c==="top"?le:be),$(c==="top"?Ge:jt),c==="top"?(Yr(!0),y(!0)):(jo(!0),I(!0)),Cc(!0)}else Cc(!1)},[N,Je,di,le,be,Ge,jt]);const[Kl,ha]=L.useState(!1),[yr,Zl]=L.useState(!1);Pt.useEffect(()=>{if(N==="component"){const c=Ri;Jt(c),ee(c==="top"?ge:Yt),$(c==="top"?xt:Et),c==="top"?(Yr(!0),ie(!0)):(jo(!0),ce(!0)),Kl||zd(!0)}else zd(!1),ha(!1)},[N,Ri,ge,Yt,xt,Et,Kl]),Pt.useEffect(()=>{if(N==="component"){const c=Ri;Jt(c),ee(c==="top"?ge:Yt),$(c==="top"?xt:Et)}},[Ri,N,ge,Yt,xt,Et]),Pt.useEffect(()=>{Nr.toolInstanceId&&(ee(Nr.color),$(Nr.size))},[Nr.toolInstanceId,Nr.color,Nr.size,ee,$,N,Je]);const[Hr,ji]=L.useState(void 0),[,al]=L.useState([]),[,Fa]=L.useState([]),[,$o]=L.useState([]),[,ms]=L.useState([]),[za,ea]=L.useState([]),[Jr,xr]=L.useState([]),[bs,Ua]=L.useState([]),[Ks,Pn]=L.useState([]),Tt=L.useRef(null),Zn=Pt.useMemo(()=>{const c=Tt.current;if(!c)return{x:0,y:0};const x=(c.width-10)/2,P=(c.height-10)/2;return ar(x,P)},[Tt.current?.width,Tt.current?.height,rn,wt,ar]),Ea=Pt.useCallback(c=>{const x=Tt.current;if(!x)return;const P=(x.width-10)/2,B=(x.height-10)/2,K=ar(P,B),ne=typeof c=="function"?c(K):c,z=(P-ne.x)/wt,Ne=(B-ne.y)/wt;bn({x:z,y:Ne})},[ar,wt,bn]),ga=Ow(),{selectedIds:wn,setSelectedIds:Cn,isSelecting:sl,setIsSelecting:Yo,selectedComponentIds:Fn,setSelectedComponentIds:yn,selectedPowerIds:Ni,setSelectedPowerIds:pn,selectedGroundIds:vi,setSelectedGroundIds:jn}=ga,ta=Y2(),{componentsTop:Qt,setComponentsTop:ri,componentsBottom:tn,setComponentsBottom:wi,componentEditor:Va,setComponentEditor:qa,connectingPin:uo,setConnectingPin:_a,componentDialogPosition:vs,setComponentDialogPosition:rs,isDraggingDialog:Zs,setIsDraggingDialog:eu,dialogDragOffset:ws,setDialogDragOffset:tu,openComponentEditor:T}=ta,Q=Vw(),{powerBuses:fe,setPowerBuses:Be,groundBuses:Ve,setGroundBuses:gt,powerSymbols:mt,setPowerSymbols:$t,groundSymbols:Kt,setGroundSymbols:sn,powerEditor:Un,setPowerEditor:li}=Q,Qr=Xw(),{saveSnapshot:Bi,undo:kr,clearSnapshot:Ar}=Qr;Pt.useEffect(()=>{N==="power"?(Pi(!1),fe.length>1?nn&&fe.some(x=>x.id===nn)?Tn(!1):(Tn(!0),nn!==null&&pi(null)):fe.length===1?(pi(fe[0].id),Tn(!1)):(Tn(!0),pi(null))):Tn(!1)},[N,fe]),Pt.useEffect(()=>{N==="ground"?(Tn(!1),Ve.length>1?pr&&Ve.some(x=>x.id===pr)?Pi(!1):(Pi(!0),pr!==null&&Yi(null)):Ve.length===1?(Yi(Ve[0].id),Pi(!1)):(Pi(!0),Yi(null))):Pi(!1)},[N,Ve]),Pt.useEffect(()=>{N!=="power"&&N!=="ground"&&(Tn(!1),Pi(!1))},[N]);const _o=$w(),{areImagesLocked:Qi,setAreImagesLocked:ya,areViasLocked:Dr,setAreViasLocked:xa,arePadsLocked:ma,setArePadsLocked:Ss,areTestPointsLocked:na,setAreTestPointsLocked:Da,areTracesLocked:fo,setAreTracesLocked:ba,areComponentsLocked:Wi,setAreComponentsLocked:Ra,areGroundNodesLocked:vo,setAreGroundNodesLocked:os,arePowerNodesLocked:$i,setArePowerNodesLocked:eo}=_o,Tl=Yw(),{openMenu:Ic,setOpenMenu:Rs,setSizeDialog:Ia,setSetSizeDialog:as,autoSaveDialog:Js,setAutoSaveDialog:Do,autoSavePromptDialog:ss,setAutoSavePromptDialog:po,debugDialog:Go,setDebugDialog:Wr,errorDialog:Is,setErrorDialog:ia,newProjectDialog:Qs,setNewProjectDialog:Ha,setOpenProjectDialog:Jl,newProjectSetupDialog:Jn,setNewProjectSetupDialog:Ts,saveAsDialog:Oi,setSaveAsDialog:ra,showColorPicker:Xo,setShowColorPicker:va,transformImagesDialogVisible:Lc,setTransformImagesDialogVisible:el}=Tl,Cl=Gw(),[jl,wo]=L.useState(!1),[Nl,Ko]=L.useState(!1),[Wa,sr]=L.useState(!1),[ls,Ii]=L.useState(null),[Fi,lr]=L.useState(null),[So,cs]=L.useState(null),[tl,bc]=L.useState(null),[nu,Gu]=L.useState(null),{autoSaveEnabled:$a,setAutoSaveEnabled:ho,autoSaveInterval:kl,setAutoSaveInterval:Ro,autoSaveDirHandle:Ls,setAutoSaveDirHandle:To,autoSaveBaseName:Io,setAutoSaveBaseName:to,currentProjectFilePath:wa,setCurrentProjectFilePath:er,projectDirHandle:oi,setProjectDirHandle:Rr,projectName:no,setProjectName:Lo,autoSaveFileHistory:ll,setAutoSaveFileHistory:Ya,currentFileIndex:oa,setCurrentFileIndex:$r,autoSaveIntervalRef:ki,hasChangesSinceLastAutoSaveRef:Ti,prevAutoSaveEnabledRef:Mc}=Cl,dr=L.useRef(Ls),io=L.useRef(Io),cl=L.useRef(wa),ro=L.useRef([]),us=L.useRef(-1),aa=L.useRef(null),ul=L.useRef(!1);Pt.useEffect(()=>{dr.current=Ls},[Ls]),Pt.useEffect(()=>{io.current=Io},[Io]),Pt.useEffect(()=>{cl.current=wa},[wa]),Pt.useEffect(()=>{ro.current=ll},[ll]),Pt.useEffect(()=>{us.current=oa},[oa]),Pt.useEffect(()=>{ul.current||(aa.current=oi)},[oi]);const iu=L.useRef(null),Cs=L.useRef(null),ds=L.useRef(null),dl=L.useRef(null),Bc=L.useRef(null),Al=L.useRef(null),js=L.useRef(null),[sa,Ga]=L.useState(!1),Co=L.useRef(null),Mo=L.useRef(null),[La,ru]=L.useState(!1),[Pl,Ns]=L.useState({}),[Xu,fr]=L.useState(!1),Ir=L.useCallback(()=>{const c=Tt.current;if(!c)return null;const x=c.width-10,P=c.height-10;let B=1/0,K=1/0,ne=-1/0,z=-1/0,Ne=!1;if(o){const Oe=o,Fe=(Oe.width||0)/2,Ze=(Oe.height||0)/2;B=Math.min(B,Oe.x-Fe),K=Math.min(K,Oe.y-Ze),ne=Math.max(ne,Oe.x+Fe),z=Math.max(z,Oe.y+Ze),Ne=!0}if(l){const Oe=l,Fe=(Oe.width||0)/2,Ze=(Oe.height||0)/2;B=Math.min(B,Oe.x-Fe),K=Math.min(K,Oe.y-Ze),ne=Math.max(ne,Oe.x+Fe),z=Math.max(z,Oe.y+Ze),Ne=!0}if(!Ne)return{pcbReferenceX:0,pcbReferenceY:0,x:0,y:0,zoom:1,viewRotation:0,viewFlipX:!1,isBottomView:!1,transparency:0,showTopImage:!0,showBottomImage:!0,showViasLayer:!0,showTopTracesLayer:!0,showBottomTracesLayer:!0,showTopPadsLayer:!0,showBottomPadsLayer:!0,showTopTestPointsLayer:!0,showBottomTestPointsLayer:!0,showTopComponents:!0,showBottomComponents:!0,showPowerLayer:!0,showGroundLayer:!0,showConnectionsLayer:!0};const ve=ne-B,Le=z-K,Me=.1,Ae=ve*(1+2*Me),he=Le*(1+2*Me),me=Ae>0?x/Ae:1,Se=he>0?P/he:1;return{pcbReferenceX:0,pcbReferenceY:0,x:0,y:0,zoom:Math.min(me,Se,1),viewRotation:0,viewFlipX:!1,isBottomView:!1,transparency:0,showTopImage:!0,showBottomImage:!0,showViasLayer:!0,showTopTracesLayer:!0,showBottomTracesLayer:!0,showTopPadsLayer:!0,showBottomPadsLayer:!0,showTopTestPointsLayer:!0,showBottomTestPointsLayer:!0,showTopComponents:!0,showBottomComponents:!0,showPowerLayer:!0,showGroundLayer:!0,showConnectionsLayer:!0}},[o,l]);Pt.useEffect(()=>{const c=Ir();c&&Ns(x=>x[0]?x:{...x,0:c})},[o,l,Ir]);const En=L.useRef(null),[la,oo]=L.useState(!1),[Sa,Ta]=L.useState(null),[Oc,Ca]=L.useState(null),[Fr,vc]=L.useState({width:960,height:600}),bu=L.useRef(null),Fc=L.useRef(null),vu=L.useRef(null),fl=L.useRef(null),nl=L.useRef(null),zl=L.useRef(null),ks=L.useRef(null),[As,Yr]=L.useState(!0),[Xa,jo]=L.useState(!0),[Ql,ca]=L.useState(!1),[No,Ka]=L.useState(!0),[Ma,fs]=L.useState(!0),[Ba,Li]=L.useState(!0),[Bo,ua]=L.useState(!0),[Zo,ja]=L.useState(!0),[f,y]=L.useState(!0),[j,I]=L.useState(!0),[X,ie]=L.useState(!0),[oe,ce]=L.useState(!0),[pe,Te]=L.useState(!0),Re=mt,Ee=Kt,[ke,He]=L.useState(!1),[Qe,yt]=L.useState(null),[et,pt]=L.useState(!1),[bt,Mt]=L.useState(void 0),[zt,Sn]=L.useState(!1),[un,Tn]=L.useState(!1),[nn,pi]=L.useState(null),[Lr,zn]=L.useState(new Set),Ut=L.useCallback(()=>{Cn(new Set),yn(new Set),pn(new Set),jn(new Set),zn(new Set)},[Cn,yn,pn,jn,zn]),[Xt,cr]=L.useState(!1),[Yn,gi]=L.useState(null),[tr,Pi]=L.useState(!1),[pr,Yi]=L.useState(null),[Ur,ao]=L.useState(!0),[Pr,ii]=L.useState(!1),[Gi,mr]=L.useState(!1),ai=L.useRef({}),[nr,Si]=L.useState(!0),[yi,Xi]=L.useState(!0),[Ui,Er]=L.useState(!0),[go,zr]=L.useState(!1),[si,Oo]=L.useState(null),[Gr,Mn]=L.useState(!1),[In,Ei]=L.useState(null),[Oa,yo]=L.useState(!1),[Fo,so]=L.useState(null),[pl,_l]=L.useState(!1),[wc,_r]=L.useState(null),[Sc,hl]=L.useState([]),[Uc,Za]=L.useState({productName:"",productVersion:"",manufacturer:"",date:new Date().toISOString().split("T")[0]}),[Ku,gl]=L.useState(!1),[ec,tc]=L.useState(null),[Uo,Xr]=L.useState(!1),[nc,yl]=L.useState(null),[ic,rc]=L.useState(!1),[Ja,oc]=L.useState(null),[ac,Ec]=L.useState(!1),[Tc,il]=L.useState(null),[Zu,xl]=L.useState(!1),[wu,sc]=L.useState(!1),[Dl,Ju]=L.useState(null),[ou,Qu]=L.useState(!1),[lc,Su]=L.useState(null),[cc,au]=L.useState(!1),uc=L.useRef(null),Ps=L.useRef(!1),ps=L.useRef(null),Ms=L.useRef(!1),dc=L.useRef(!1);Pt.useEffect(()=>{uc.current=Dl},[Dl]),Pt.useEffect(()=>{Ps.current=ou},[ou]),Pt.useEffect(()=>{ps.current=lc},[lc]),Pt.useEffect(()=>{Ms.current=cc},[cc]),Pt.useEffect(()=>{dc.current=wu},[wu]);const[Tu,Bs]=L.useState(null),[Nd,Os]=L.useState(!1);Pt.useEffect(()=>{fe.length===0&&Be([{id:"default-3v3",name:"+3.3V",voltage:"+3.3VDC",color:"#ff6600"},{id:"default-5v",name:"+5V",voltage:"+5VDC",color:"#ff0000"}])},[fe.length,Be]);const Qa=L.useCallback((c,x)=>{const P=Re.find(K=>K.pointId===c);if(P){const K=x.find(z=>z.id===P.powerBusId);return`Via (${K?K.voltage:P.type||"Power Node"})`}const B=Ee.find(K=>K.pointId===c);return B?`Via (${B.type||"Ground"})`:"Via"},[Re,Ee]),Rl=L.useCallback((c,x)=>{const P=Re.find(K=>K.pointId===c);if(P){const K=x.find(z=>z.id===P.powerBusId);return`Pad (${K?K.voltage:P.type||"Power Node"})`}const B=Ee.find(K=>K.pointId===c);return B?`Pad (${B.type||"Ground"})`:"Pad"},[Re,Ee]),ml=L.useCallback((c,x)=>{const P=Re.find(K=>K.pointId===c);if(P){const K=x.find(z=>z.id===P.powerBusId);return`Test Point (${K?K.voltage:P.type||"Power Node"})`}const B=Ee.find(K=>K.pointId===c);return B?`Test Point (${B.type||"Ground"})`:"Test Point"},[Re,Ee]),kh=L.useCallback(()=>{const c=ct.filter(x=>x.type==="via").map(x=>x.id);Cn(new Set(c)),yn(new Set),pn(new Set),jn(new Set),zn(new Set)},[ct,Cn,yn,pn,jn]),op=L.useCallback(()=>{const c=ct.filter(x=>x.type==="trace").map(x=>x.id);Cn(new Set(c)),yn(new Set),pn(new Set),jn(new Set),zn(new Set)},[ct,Cn,yn,pn,jn]),ap=L.useCallback(()=>{const c=ct.filter(x=>x.type==="pad").map(x=>x.id);Cn(new Set(c)),yn(new Set),pn(new Set),jn(new Set),zn(new Set)},[ct,Cn,yn,pn,jn]),sp=L.useCallback(()=>{const c=[...Qt,...tn].map(x=>x.id);yn(new Set(c)),Cn(new Set),pn(new Set),jn(new Set),zn(new Set)},[Qt,tn,yn,Cn,pn,jn]),lp=L.useCallback(()=>{const c=[...Qt,...tn].filter(x=>{const P=x.pinConnections||[];return!(P.length>0&&P.length===x.pinCount&&P.every(K=>K&&K.trim()!==""))}).map(x=>x.id);yn(new Set(c)),Cn(new Set),pn(new Set),jn(new Set),zn(new Set),Wr({visible:!0,text:""})},[Qt,tn,yn,Cn,pn,jn,Wr]),cp=L.useCallback(()=>{const c=new Set;let x=0;for(const P of[...Qt,...tn]){const B=P.pinConnections||[];for(const K of B)if(K&&K.trim()!==""){const ne=parseInt(K.trim(),10);if(!isNaN(ne)&&ne>0){const z=`${P.id}:${ne}`;c.add(z),x++}}}if(console.log(`Component connections: ${x} connection lines found`),c.size===0){console.log("No component connections found - components may not have pins connected"),alert("No component connections found. Please connect component pins to vias or pads first.");return}zn(c),Cn(new Set),yn(new Set),pn(new Set),jn(new Set),console.log(`Selected ${c.size} component connection lines`)},[Qt,tn,Cn,yn,pn,jn]),kd=L.useCallback(()=>{Wa?(an(!1),sr(!1),m(0)):(an(!0),sr(!0),m(100))},[Wa,an,sr,m]),ff=L.useCallback(c=>{Ot(x=>qg(x,c))},[Ot]),Il=L.useCallback((c,x)=>{const P=Tt.current;if(!P)return;const B=P.width-10,K=P.height-10,ne=B/2,z=K/2,Ne=ne-c*wt,ve=z-x*wt;Ea({x:Ne,y:ve})},[wt,Ea]),Ad=L.useCallback((c,x,P)=>{Il(x,P),yn(new Set([c])),Cn(new Set),pn(new Set),jn(new Set),zn(new Set)},[Il,yn,Cn,pn,jn]),up=L.useCallback((c,x,P)=>{Il(x,P),Cn(new Set([c])),yn(new Set),pn(new Set),jn(new Set),zn(new Set)},[Il,Cn,yn,pn,jn]),dp=L.useCallback((c,x,P)=>{Il(x,P),pn(new Set([c])),Cn(new Set),yn(new Set),jn(new Set),zn(new Set)},[Il,pn,Cn,yn,jn]),Ah=L.useCallback((c,x,P)=>{Il(x,P),jn(new Set([c])),Cn(new Set),yn(new Set),pn(new Set),zn(new Set)},[Il,jn,Cn,yn,pn]),pf=L.useCallback((c,x,P)=>{Il(x,P),Cn(new Set([c])),yn(new Set),pn(new Set),jn(new Set),zn(new Set)},[Il,Cn,yn,pn,jn]),fp=Pt.useMemo(()=>{const c=new Set(Re.map(P=>P.powerBusId).filter(P=>typeof P=="string"&&P.length>0)),x=fe.filter(P=>c.has(P.id)).map(P=>P.name);return Array.from(new Set(x)).sort()},[Re,fe]),pp=Pt.useMemo(()=>{const c=new Set(Ee.map(P=>P.groundBusId).filter(P=>typeof P=="string"&&P.length>0)),x=Ve.filter(P=>c.has(P.id)).map(P=>P.name);return Array.from(new Set(x)).sort()},[Ee,Ve]),hf=L.useCallback(()=>{const c=Re.map(x=>x.id);pn(new Set(c)),Cn(new Set),yn(new Set),jn(new Set),zn(new Set)},[Re,pn,Cn,yn,jn]),hp=L.useCallback(()=>{const c=Ee.map(x=>x.id);jn(new Set(c)),Cn(new Set),yn(new Set),pn(new Set),zn(new Set)},[Ee,jn,Cn,yn,pn]),gp=L.useCallback(c=>{const x=fe.filter(B=>B.name===c).map(B=>B.id);if(x.length===0)return;const P=Re.filter(B=>B.powerBusId&&x.includes(B.powerBusId)).map(B=>B.id);pn(new Set(P)),Cn(new Set),yn(new Set),jn(new Set)},[fe,Re,pn,Cn,yn,jn]),Ph=L.useCallback(c=>{const x=Ve.filter(B=>B.name===c).map(B=>B.id);if(x.length===0)return;const P=Ee.filter(B=>B.groundBusId&&x.includes(B.groundBusId)).map(B=>B.id);jn(new Set(P)),Cn(new Set),yn(new Set),pn(new Set)},[Ve,Ee,jn,Cn,yn,pn]);L.useCallback(c=>{switch(c.componentType){case"Resistor":case"ResistorNetwork":case"Thermistor":case"VariableResistor":if("resistance"in c&&c.resistance&&"resistanceUnit"in c&&c.resistanceUnit)return`${c.resistance} ${c.resistanceUnit}`;break;case"Capacitor":case"Electrolytic Capacitor":case"Film Capacitor":if("capacitance"in c&&c.capacitance&&"capacitanceUnit"in c&&c.capacitanceUnit)return`${c.capacitance} ${c.capacitanceUnit}`;break;case"Inductor":if("inductance"in c&&c.inductance&&"inductanceUnit"in c&&c.inductanceUnit)return`${c.inductance} ${c.inductanceUnit}`;break;case"Battery":if("voltage"in c&&c.voltage&&"voltageUnit"in c&&c.voltageUnit)return`${c.voltage} ${c.voltageUnit}`;break;case"Diode":if("voltage"in c&&c.voltage&&"voltageUnit"in c&&c.voltageUnit)return`${c.voltage} ${c.voltageUnit}`;break;case"Fuse":if("current"in c&&c.current&&"currentUnit"in c&&c.currentUnit)return`${c.current} ${c.currentUnit}`;break;case"FerriteBead":if("impedance"in c&&c.impedance&&"impedanceUnit"in c&&c.impedanceUnit)return`${c.impedance} ${c.impedanceUnit}`;break;case"Relay":if("coilVoltage"in c&&c.coilVoltage&&"coilVoltageUnit"in c&&c.coilVoltageUnit)return`${c.coilVoltage} ${c.coilVoltageUnit}`;break;case"Speaker":if("impedance"in c&&c.impedance&&"impedanceUnit"in c&&c.impedanceUnit)return`${c.impedance} ${c.impedanceUnit}`;break;case"Motor":if("voltage"in c&&c.voltage&&"voltageUnit"in c&&c.voltageUnit)return`${c.voltage} ${c.voltageUnit}`;break;case"PowerSupply":if("outputVoltage"in c&&c.outputVoltage&&"outputVoltageUnit"in c&&c.outputVoltageUnit)return`${c.outputVoltage} ${c.outputVoltageUnit}`;break;case"Transistor":if("partNumber"in c&&c.partNumber)return c.partNumber;break;case"IntegratedCircuit":if("partNumber"in c&&c.partNumber)return c.partNumber;break}return null},[]);const zh=L.useCallback(c=>{const x=[];switch(c.componentType){case"Capacitor":case"Electrolytic Capacitor":case"Film Capacitor":"capacitance"in c&&c.capacitance&&"capacitanceUnit"in c&&c.capacitanceUnit&&x.push(`Capacitance: ${c.capacitance} ${c.capacitanceUnit}`),"voltage"in c&&c.voltage&&"voltageUnit"in c&&c.voltageUnit&&x.push(`Voltage: ${c.voltage} ${c.voltageUnit}`),"dielectric"in c&&c.dielectric&&x.push(`Dielectric: ${c.dielectric}`);break;case"Resistor":case"ResistorNetwork":case"Thermistor":"resistance"in c&&c.resistance&&"resistanceUnit"in c&&c.resistanceUnit&&x.push(`Resistance: ${c.resistance} ${c.resistanceUnit}`),"power"in c&&c.power&&x.push(`Power: ${c.power}`),"tolerance"in c&&c.tolerance&&x.push(`Tolerance: ${c.tolerance}`);break;case"VariableResistor":"resistance"in c&&c.resistance&&"resistanceUnit"in c&&c.resistanceUnit&&x.push(`Resistance: ${c.resistance} ${c.resistanceUnit}`),"vrType"in c&&c.vrType&&x.push(`Type: ${c.vrType}`),"power"in c&&c.power&&x.push(`Power: ${c.power}`),"taper"in c&&c.taper&&x.push(`Taper: ${c.taper}`);break;case"Inductor":"inductance"in c&&c.inductance&&"inductanceUnit"in c&&c.inductanceUnit&&x.push(`Inductance: ${c.inductance} ${c.inductanceUnit}`),"current"in c&&c.current&&"currentUnit"in c&&c.currentUnit&&x.push(`Current: ${c.current} ${c.currentUnit}`),"tolerance"in c&&c.tolerance&&x.push(`Tolerance: ${c.tolerance}`);break;case"Battery":"voltage"in c&&c.voltage&&"voltageUnit"in c&&c.voltageUnit&&x.push(`Voltage: ${c.voltage} ${c.voltageUnit}`),"capacity"in c&&c.capacity&&"capacityUnit"in c&&c.capacityUnit&&x.push(`Capacity: ${c.capacity} ${c.capacityUnit}`);break;case"Diode":"voltage"in c&&c.voltage&&"voltageUnit"in c&&c.voltageUnit&&x.push(`Voltage: ${c.voltage} ${c.voltageUnit}`),"current"in c&&c.current&&"currentUnit"in c&&c.currentUnit&&x.push(`Current: ${c.current} ${c.currentUnit}`);break;case"Fuse":"current"in c&&c.current&&"currentUnit"in c&&c.currentUnit&&x.push(`Current: ${c.current} ${c.currentUnit}`),"voltage"in c&&c.voltage&&"voltageUnit"in c&&c.voltageUnit&&x.push(`Voltage: ${c.voltage} ${c.voltageUnit}`);break;case"FerriteBead":"impedance"in c&&c.impedance&&"impedanceUnit"in c&&c.impedanceUnit&&x.push(`Impedance: ${c.impedance} ${c.impedanceUnit}`),"current"in c&&c.current&&"currentUnit"in c&&c.currentUnit&&x.push(`Current: ${c.current} ${c.currentUnit}`);break;case"Relay":"coilVoltage"in c&&c.coilVoltage&&"coilVoltageUnit"in c&&c.coilVoltageUnit&&x.push(`Coil Voltage: ${c.coilVoltage} ${c.coilVoltageUnit}`),"contactRating"in c&&c.contactRating&&x.push(`Contact Rating: ${c.contactRating}`);break;case"Speaker":"impedance"in c&&c.impedance&&"impedanceUnit"in c&&c.impedanceUnit&&x.push(`Impedance: ${c.impedance} ${c.impedanceUnit}`),"power"in c&&c.power&&x.push(`Power: ${c.power}`);break;case"Motor":"voltage"in c&&c.voltage&&"voltageUnit"in c&&c.voltageUnit&&x.push(`Voltage: ${c.voltage} ${c.voltageUnit}`),"speed"in c&&c.speed&&"speedUnit"in c&&c.speedUnit&&x.push(`Speed: ${c.speed} ${c.speedUnit}`);break;case"PowerSupply":"outputVoltage"in c&&c.outputVoltage&&"outputVoltageUnit"in c&&c.outputVoltageUnit&&x.push(`Output Voltage: ${c.outputVoltage} ${c.outputVoltageUnit}`),"outputCurrent"in c&&c.outputCurrent&&"outputCurrentUnit"in c&&c.outputCurrentUnit&&x.push(`Output Current: ${c.outputCurrent} ${c.outputCurrentUnit}`);break;case"Transistor":"partNumber"in c&&c.partNumber&&x.push(`Part Number: ${c.partNumber}`),"transistorType"in c&&c.transistorType&&x.push(`Type: ${c.transistorType}`);break;case"Crystal":"frequency"in c&&c.frequency&&x.push(`Frequency: ${c.frequency}`),"loadCapacitance"in c&&c.loadCapacitance&&x.push(`Load Capacitance: ${c.loadCapacitance}`),"tolerance"in c&&c.tolerance&&x.push(`Tolerance: ${c.tolerance}`);break;case"VacuumTube":"tubeType"in c&&c.tubeType&&x.push(`Tube Type: ${c.tubeType}`),"partNumber"in c&&c.partNumber&&x.push(`Part Number: ${c.partNumber}`);break}return x},[]),[Cu,Ll]=L.useState(!1),Vc=L.useRef(null),[su,ju]=L.useState(!1),[Pd,Cc]=L.useState(!1),Nu=L.useRef(null),lu=L.useRef(null),ed=L.useRef(null),ku=L.useRef(null),[gf,zd]=L.useState(!1),[Ml,jc]=L.useState(null),[yp,xp]=L.useState(null),[Nc,_d]=L.useState(null),Dd=Pt.useRef(null),Rd=Pt.useRef(null),Id=Pt.useRef(null),td=L.useRef(null),Ld=L.useRef(null),Au=L.useRef(null),da=L.useRef(null),Na=L.useRef(null),Md=L.useRef(null),[mp,bp]=L.useState(null),[Fs,nd]=L.useState(null),[Bl,id]=L.useState(!1),[cu,vp]=L.useState(null),[Ol,rd]=L.useState(null);Pt.useEffect(()=>{Rd.current=Nc},[Nc]),Pt.useEffect(()=>{Id.current=Ml},[Ml]);const yf=L.useCallback(async(c,x)=>{if(!x)throw new Error("No project directory available. Please create or open a project before loading images. The project directory is needed to store image files.");try{let P;try{P=await x.getDirectoryHandle("images",{create:!0})}catch(ne){throw new Error(`Failed to create images directory in project folder. This may be due to insufficient permissions. Please ensure you have write access to the project directory. Error details: ${ne.message}`)}const B=c.name,K=`images/${B}`;try{const z=await(await P.getFileHandle(B,{create:!0})).createWritable();return await z.write(c),await z.close(),console.log(`Image copied to project directory: ${K}`),K}catch(ne){throw new Error(`Failed to copy image file "${B}" to project images directory. The file may be locked by another application, or there may be insufficient disk space. Please try again or check your disk space. Error details: ${ne.message}`)}}catch(P){throw P instanceof Error&&P.message.includes("No project directory")||P instanceof Error&&P.message.includes("Failed to")?P:new Error(`An unexpected error occurred while copying the image to the project directory. This may be due to file system permissions or disk space issues. Please try again. Technical details: ${P.message}`)}},[]),xf=L.useCallback(async(c,x)=>{try{const P=c.name.toLowerCase(),K=[".png",".jpg",".jpeg"].some(Se=>P.endsWith(Se)),z=["image/png","image/jpeg","image/jpg"].includes(c.type);if(!K&&!z){alert(`Error: Unsupported image format.

The software only accepts PNG and JPEG image files.

File selected: ${c.name}
File type: ${c.type||"unknown"}

Please select a .png, .jpg, or .jpeg image file.`);return}let Ne;if(oi)try{Ne=await yf(c,oi)}catch(Se){const Pe=Se instanceof Error?Se.message:"Unknown error occurred while copying image to project directory.";alert(`Error: ${Pe}

The image could not be loaded. Please ensure you have a project open and have write permissions to the project directory.`);return}else{if(!confirm(`Warning: No project directory is currently open. The image will be loaded, but you must create or open a project and save it before the image will be stored in the project directory.

Do you want to continue loading the ${x==="top"?"top":"bottom"} image?`))return;Ne=c.name}const ve=await createImageBitmap(c),Le=URL.createObjectURL(c),Me=Tt.current;let Ae=0,he=0;Me&&(Ae=rn.x,he=rn.y);const me={url:Le,name:c.name,width:ve.width,height:ve.height,filePath:Ne,x:Ae,y:he,scale:1,rotation:0,flipX:!1,flipY:!1,skewX:0,skewY:0,keystoneV:0,keystoneH:0,bitmap:ve};x==="top"?s(me):d(me)}catch(P){const B=P instanceof Error?P.message:"Unknown error occurred while loading the image.";alert(`Error: Failed to load image file "${c.name}".

${B}

Please ensure the file is a valid image format (PNG, JPEG, etc.) and is not corrupted.`),console.error("Failed to load image",P)}},[rn,wt,oi,yf]),wp=L.useCallback(c=>{c.stopPropagation(),c.preventDefault();const x=Tt.current;if(!x)return;document.activeElement!==x&&x.focus();const P=x.getBoundingClientRect(),B=x.width/P.width,K=x.height/P.height,ne=c.nativeEvent.offsetX,z=c.nativeEvent.offsetY,Ne=typeof ne=="number"?ne:c.clientX-P.left,ve=typeof z=="number"?z:c.clientY-P.top,Le=Ne*B,Me=ve*K,Ae=Le-5,he=Me-5,me=$f(Ae,he,Zn,wt,mn,Dt),Se=me.x,Pe=me.y;if(Ps.current&&N==="select"){au(!0),Su({start:{x:Se,y:Pe},end:{x:Se,y:Pe}});return}if(N==="center"){fr(!0),En.current&&clearTimeout(En.current),En.current=setTimeout(()=>{fr(!1),g("select"),ji(void 0)},2e3);return}if(N==="select"){if(uo){let qe=1/0,at=null,ft=null;const Bt=Math.max(6/wt,4),_n=[...Qt,...tn].find(Qn=>Qn.id===uo.componentId)?.layer||"top";for(const Qn of ct)if((Qn.type==="via"||Qn.type==="pad")&&Qn.points.length>0){if(Qn.type==="pad"&&(Qn.layer||"top")!==_n)continue;const Vn=Qn.points[0],Gn=Math.max(1,Qn.size/2),Xn=Math.hypot(Vn.x-Se,Vn.y-Pe),Bn=Math.max(Gn,Bt);Xn<=Bn&&Xn<qe&&(qe=Xn,at=Vn.id??null,ft=Qn)}if(ft?(console.log(`
[PIN CONNECTION] Found via!`),console.log(`  Stroke ID: ${ft.id}`),console.log(`  Point ID: ${at}`),console.log(`  Point coordinates: x=${ft.points[0].x.toFixed(2)}, y=${ft.points[0].y.toFixed(2)}`),console.log(`  Click coordinates: x=${Se.toFixed(2)}, y=${Pe.toFixed(2)}`),console.log(`  Distance: ${qe.toFixed(2)}`),console.log(`  Via size: ${ft.size}, radius: ${Math.max(1,ft.size/2)}`)):(console.log(`
[PIN CONNECTION] No via found!`),console.log(`  Click coordinates: x=${Se.toFixed(2)}, y=${Pe.toFixed(2)}`),console.log(`  Hit tolerance: ${Bt.toFixed(2)}`),console.log(`  Total vias in drawingStrokes: ${ct.filter(Qn=>Qn.type==="via").length}`)),at!=null){console.log(`
[PIN CONNECTION] Proceeding with connection...`),console.log(`  bestPointId is valid: ${at} (type: ${typeof at})`);const Qn=String(at),Vn=uo.pinIndex,Gn=uo.componentId;console.log(`
=== PIN CONNECTION START ===`),console.log(`Connecting pin ${Vn} (Pin ${Vn+1}) of component ${Gn} to point ID ${Qn}`);const Xn=Qt.find(Rt=>Rt.id===Gn),Bn=tn.find(Rt=>Rt.id===Gn);Xn?(console.log("Component found in TOP layer"),ri(Rt=>{const Ln=Rt.find(Kn=>Kn.id===Gn);if(!Ln)return console.error(`Component ${Gn} not found in TOP layer during update!`),Rt;console.log("BEFORE update: pinConnections =",Ln.pinConnections);const br=Ln.pinConnections||[],mo=br.length>0?[...br]:new Array(Ln.pinCount).fill("");let rr;if(mo.length!==Ln.pinCount){rr=new Array(Ln.pinCount).fill("");for(let Kn=0;Kn<Math.min(mo.length,Ln.pinCount);Kn++)rr[Kn]=mo[Kn]||""}else rr=[...mo];rr[Vn]=Qn,console.log(`Updating pin ${Vn} with value: ${Qn}`),console.log("New pinConnections array:",rr);const Ao=Rt.map(Kn=>Kn.id===Gn?{...Kn,pinConnections:rr}:Kn),Vo=Ao.find(Kn=>Kn.id===Gn);return console.log("AFTER update: pinConnections =",Vo?.pinConnections),console.log(`Pin ${Vn} value: ${Vo?.pinConnections[Vn]}`),console.log(`=== PIN CONNECTION COMPLETE (TOP) ===
`),Ao})):Bn?(console.log("Component found in BOTTOM layer"),wi(Rt=>{const Ln=Rt.find(Kn=>Kn.id===Gn);if(!Ln)return console.error(`Component ${Gn} not found in BOTTOM layer during update!`),Rt;console.log("BEFORE update: pinConnections =",Ln.pinConnections);const br=Ln.pinConnections||[],mo=br.length>0?[...br]:new Array(Ln.pinCount).fill("");let rr;if(mo.length!==Ln.pinCount){rr=new Array(Ln.pinCount).fill("");for(let Kn=0;Kn<Math.min(mo.length,Ln.pinCount);Kn++)rr[Kn]=mo[Kn]||""}else rr=[...mo];rr[Vn]=Qn,console.log(`Updating pin ${Vn} with value: ${Qn}`),console.log("New pinConnections array:",rr);const Ao=Rt.map(Kn=>Kn.id===Gn?{...Kn,pinConnections:rr}:Kn),Vo=Ao.find(Kn=>Kn.id===Gn);return console.log("AFTER update: pinConnections =",Vo?.pinConnections),console.log(`Pin ${Vn} value: ${Vo?.pinConnections[Vn]}`),console.log(`=== PIN CONNECTION COMPLETE (BOTTOM) ===
`),Ao})):(console.error(`Component ${Gn} not found in either TOP or BOTTOM layer!`),console.log("Available TOP components:",Qt.map(Rt=>Rt.id)),console.log("Available BOTTOM components:",tn.map(Rt=>Rt.id))),setTimeout(()=>{_a(null)},0);return}else _a(null)}const Oe=10,Fe=(()=>{for(const qe of Qt)if(Se>=qe.x-Oe&&Se<=qe.x+Oe&&Pe>=qe.y-Oe&&Pe<=qe.y+Oe)return{layer:"top",comp:qe};for(const qe of tn)if(Se>=qe.x-Oe&&Se<=qe.x+Oe&&Pe>=qe.y-Oe&&Pe<=qe.y+Oe)return{layer:"bottom",comp:qe};return null})();if(Fe){const{comp:qe}=Fe;c.shiftKey?yn(at=>{const ft=new Set(at);return ft.has(qe.id)?ft.delete(qe.id):ft.add(qe.id),ft}):(yn(new Set([qe.id])),Cn(new Set),pn(new Set),jn(new Set));return}const Ze=Math.max(6/wt,4);let dt=null;for(const qe of Re){const at=Math.max(6,qe.size/2),ft=at*.8,Bt=at+ft,ln=Math.hypot(qe.x-Se,qe.y-Pe),_n=Math.abs(Se-qe.x)<=Ze&&Math.abs(Pe-qe.y)<=Bt,Qn=Math.abs(Pe-qe.y)<=Ze&&Math.abs(Se-qe.x)<=Bt;if(ln<=Math.max(at,Ze)||_n||Qn){dt=qe;break}}if(dt){c.shiftKey?pn(qe=>{const at=new Set(qe);return at.has(dt.id)?at.delete(dt.id):at.add(dt.id),at}):(pn(new Set([dt.id])),Cn(new Set),yn(new Set),jn(new Set));return}let Ct=null;for(const qe of Ee){const at=Math.max(6,(qe.size||18)/2),ft=at*.8,Bt=at+ft,ln=Math.hypot(qe.x-Se,qe.y-Pe),_n=Math.abs(Se-qe.x)<=Ze&&Math.abs(Pe-qe.y)<=Bt,Qn=Math.abs(Pe-qe.y)<=Ze&&Math.abs(Se-qe.x)<=Bt;if(ln<=Math.max(at,Ze)||_n||Qn){Ct=qe;break}}if(Ct){c.shiftKey?jn(qe=>{const at=new Set(qe);return at.has(Ct.id)?at.delete(Ct.id):at.add(Ct.id),at}):(jn(new Set([Ct.id])),Cn(new Set),yn(new Set),pn(new Set));return}const st=Math.max(6/wt,4/wt),$e=Math.max(st,.5);let Ye=null;for(const qe of ct)if((qe.type==="via"||qe.type==="pad"||qe.type==="testPoint")&&qe.points.length>0){let at=!1;if(qe.type==="via"?at=No:qe.type==="pad"?at=(qe.layer||"top")==="top"?Bo:Zo:qe.type==="testPoint"&&(at=(qe.layer||"top")==="top"?f:j),!at)continue;const ft=qe.points[0],Bt=Math.max(1,qe.size/2);if(Math.hypot(ft.x-Se,ft.y-Pe)<=Math.max(Bt,$e)){Ye=qe;break}}if(Ye){c.shiftKey?Cn(qe=>{const at=new Set(qe);return at.has(Ye.id)?at.delete(Ye.id):at.add(Ye.id),at}):(Cn(new Set([Ye.id])),yn(new Set),pn(new Set),jn(new Set),zn(new Set));return}c.shiftKey||(Cn(new Set),yn(new Set),pn(new Set),jn(new Set),zn(new Set)),Yo(!0),vp({x:Se,y:Pe,shiftKey:c.shiftKey}),rd({x:Se,y:Pe,width:0,height:0});return}else if(N==="magnify"){const Oe=c.shiftKey?.5:2,Fe=Math.max(.25,Math.min(8,wt*Oe));_i(Se,Pe),Wn(Fe);return}else if(N==="pan"){const Oe={topImageX:o?.x??0,topImageY:o?.y??0,bottomImageX:l?.x??0,bottomImageY:l?.y??0,componentsTop:Object.fromEntries(Qt.map(Fe=>[Fe.id,{x:Fe.x,y:Fe.y}])),componentsBottom:Object.fromEntries(tn.map(Fe=>[Fe.id,{x:Fe.x,y:Fe.y}])),powerSymbols:Object.fromEntries(mt.map(Fe=>[Fe.id,{x:Fe.x,y:Fe.y}])),groundSymbols:Object.fromEntries(Kt.map(Fe=>[Fe.id,{x:Fe.x,y:Fe.y}])),drawingStrokes:ct.map(Fe=>({points:Fe.points.map(Ze=>({x:Ze.x,y:Ze.y}))})),vias:za.map(Fe=>({x:Fe.x,y:Fe.y})),pads:Jr.map(Fe=>({x:Fe.x,y:Fe.y}))};Co.current={startCX:Ae,startCY:he,panX:Zn.x,panY:Zn.y,objectStartPositions:Oe},Mo.current={startClientX:c.clientX,startClientY:c.clientY,panX:Zn.x,panY:Zn.y,objectStartPositions:Oe},Ga(!0);return}else if(N==="draw"){const Oe=(dt,Ct)=>{let It=1/0,st=null;const $e=10/wt,Ye=wt>20?Math.max($e,1e-4):wt>10?Math.max($e,.001):Math.max($e,.01);for(const ft of ct)if(ft.type==="via"){const Bt=ft.points[0],ln=Math.hypot(Bt.x-dt,Bt.y-Ct);ln<=Ye&&ln<It&&(It=ln,st=Bt)}else if(ft.type==="pad"){const Bt=ft.points[0],ln=Math.hypot(Bt.x-dt,Bt.y-Ct);ln<=Ye&&ln<It&&(It=ln,st=Bt)}for(const ft of Re)if(ft.pointId!==void 0){const Bt=Math.hypot(ft.x-dt,ft.y-Ct);Bt<=Ye&&Bt<It&&(It=Bt,st={x:ft.x,y:ft.y,id:ft.pointId})}for(const ft of Ee)if(ft.pointId!==void 0){const Bt=Math.hypot(ft.x-dt,ft.y-Ct);Bt<=Ye&&Bt<It&&(It=Bt,st={x:ft.x,y:ft.y,id:ft.pointId})}const at=ur(st??{x:dt,y:Ct});return{x:at.x,y:at.y,nodeId:st?.id}};if(Je==="via"){const dt=On.get("via"),Ct=dt.color,It=dt.size,cn=Bl?{x:ur({x:Se,y:Pe}).x,y:ur({x:Se,y:Pe}).y}:((ft,Bt)=>{let ln=1/0,_n=null;const Vn=10/wt,Gn=wt>10?Math.max(Vn,.001):Math.max(Vn,.01);for(const Rt of ct)if(Rt.type==="via"||Rt.type==="pad"){const Ln=Rt.points[0],br=Math.hypot(Ln.x-ft,Ln.y-Bt);br<=Gn&&br<ln&&(ln=br,_n=Ln)}for(const Rt of Re)if(Rt.pointId!==void 0){const Ln=Math.hypot(Rt.x-ft,Rt.y-Bt);Ln<=Gn&&Ln<ln&&(ln=Ln,_n={x:Rt.x,y:Rt.y,id:Rt.pointId})}for(const Rt of Ee)if(Rt.pointId!==void 0){const Ln=Math.hypot(Rt.x-ft,Rt.y-Bt);Ln<=Gn&&Ln<ln&&(ln=Ln,_n={x:Rt.x,y:Rt.y,id:Rt.pointId})}const Bn=ur(_n??{x:ft,y:Bt});return{x:Bn.x,y:Bn.y,nodeId:_n?.id}})(Se,Pe),$e=cn.nodeId??gc(),Ye=Qa($e,fe),qe={id:$e,x:cn.x,y:cn.y};Bi(ct,Qt,tn,mt,Kt);const at={id:`${Date.now()}-via`,points:[qe],color:Ct,size:It,layer:At,type:"via",viaType:Ye};ye(ft=>[...ft,at]),At==="top"?al(ft=>[...ft,at.id]):Fa(ft=>[...ft,at.id]);return}if(Je==="pad"){if(!Hn)return;const Ct=Bl?{x:ur({x:Se,y:Pe}).x,y:ur({x:Se,y:Pe}).y}:((at,ft)=>{let Bt=1/0,ln=null;const Qn=10/wt,Vn=wt>10?Math.max(Qn,.001):Math.max(Qn,.01);for(const Bn of ct)if(Bn.type==="via"||Bn.type==="pad"||Bn.type==="testPoint"){const Rt=Bn.points[0],Ln=Math.hypot(Rt.x-at,Rt.y-ft);Ln<=Vn&&Ln<Bt&&(Bt=Ln,ln=Rt)}for(const Bn of Re)if(Bn.pointId!==void 0){const Rt=Math.hypot(Bn.x-at,Bn.y-ft);Rt<=Vn&&Rt<Bt&&(Bt=Rt,ln={x:Bn.x,y:Bn.y,id:Bn.pointId})}for(const Bn of Ee)if(Bn.pointId!==void 0){const Rt=Math.hypot(Bn.x-at,Bn.y-ft);Rt<=Vn&&Rt<Bt&&(Bt=Rt,ln={x:Bn.x,y:Bn.y,id:Bn.pointId})}const Xn=ur(ln??{x:at,y:ft});return{x:Xn.x,y:Xn.y,nodeId:ln?.id}})(Se,Pe),It=Ct.nodeId??gc(),st=Rl(It,fe),cn=G||(Hn==="top"?Ie:k),$e=F||(Hn==="top"?q:se),Ye={id:It,x:Ct.x,y:Ct.y};Bi(ct,Qt,tn,mt,Kt);const qe={id:`${Date.now()}-pad`,points:[Ye],color:cn,size:$e,layer:Hn,type:"pad",padType:st};ye(at=>[...at,qe]);return}if(Je==="testPoint"){if(!di)return;const Ct=Bl?{x:ur({x:Se,y:Pe}).x,y:ur({x:Se,y:Pe}).y}:((ft,Bt)=>{let ln=1/0,_n=null;const Qn=15;for(const Xn of ct)if(Xn.type==="via"||Xn.type==="pad"||Xn.type==="testPoint"){const Bn=Xn.points[0],Rt=Math.hypot(Bn.x-ft,Bn.y-Bt);Rt<=Qn&&Rt<ln&&(ln=Rt,_n=Bn)}for(const Xn of Re)if(Xn.pointId!==void 0){const Bn=Math.hypot(Xn.x-ft,Xn.y-Bt);Bn<=Qn&&Bn<ln&&(ln=Bn,_n={x:Xn.x,y:Xn.y,id:Xn.pointId})}for(const Xn of Ee)if(Xn.pointId!==void 0){const Bn=Math.hypot(Xn.x-ft,Xn.y-Bt);Bn<=Qn&&Bn<ln&&(ln=Bn,_n={x:Xn.x,y:Xn.y,id:Xn.pointId})}const Gn=ur(_n??{x:ft,y:Bt});return{x:Gn.x,y:Gn.y,nodeId:_n?.id}})(Se,Pe),It=Ct.nodeId??gc(),st=ml(It,fe),cn=st.includes("Power")?"power":st.includes("Ground")?"ground":st.includes("Signal")?"signal":"unknown",$e=ur({x:Ct.x,y:Ct.y}),Ye=G||(di==="top"?le:be),qe=F||(di==="top"?Ge:jt);Bi(ct,Qt,tn,mt,Kt);const at={id:`${Date.now()}-testPoint`,points:[{id:It,x:$e.x,y:$e.y}],color:Ye,size:qe,layer:di,type:"testPoint",testPointType:cn};ye(ft=>[...ft,at]);return}if(ti.current)return;const Fe=Je==="trace"&&!Bl?Oe(Se,Pe):{x:ur({x:Se,y:Pe}).x,y:ur({x:Se,y:Pe}).y},Ze=Fe.nodeId!==void 0?{id:Fe.nodeId,x:Fe.x,y:Fe.y}:{x:Fe.x,y:Fe.y};vt(dt=>dt.length===0?[Ze]:[...dt,Ze]),dn.current=Date.now(),ht(null),Nt(!1),Di(!1)}else if(N==="erase"){if(ct.some(Fe=>Fe.layer===At&&(Fe.type==="via"&&Dr||Fe.type==="pad"&&ma||Fe.type==="testPoint"&&na||Fe.type==="trace"&&fo))){const Fe=[];Dr&&ct.some(Ze=>Ze.layer===At&&Ze.type==="via")&&Fe.push("vias"),ma&&ct.some(Ze=>Ze.layer===At&&Ze.type==="pad")&&Fe.push("pads"),na&&ct.some(Ze=>Ze.layer===At&&Ze.type==="testPoint")&&Fe.push("test points"),fo&&ct.some(Ze=>Ze.layer===At&&Ze.type==="trace")&&Fe.push("traces"),Fe.length>0&&alert(`Cannot erase: ${Fe.join(", ")} are locked on the ${At} layer. Unlock them to erase.`)}Nt(!0),vt([{id:gc(),x:Se,y:Pe}]),console.log("Starting erase at:",Se,Pe,"selectedDrawingLayer:",At,"total strokes:",ct.length)}else if(N==="transform"&&en){if(Qi){alert("Cannot transform: Images are locked. Unlock images to transform them.");return}qt(!0),Ji({x:Se,y:Pe})}else if(N==="component"){if(!Id.current)return;const Oe=ur({x:Se,y:Pe}),Ze=(Or.current||"top")==="top"?"componentTop":"componentBottom",dt=On.get(Ze),Ct=dt.color,It=dt.size,st=[...Qt,...tn];let cn;if(Pr?cn=Yf():cn={...ai.current},!Or.current)return;const $e=Rd.current?.dataDrivenDefinition;if(!$e){console.error("[Component Creation] Missing dataDrivenDefinition metadata for selected component.");return}let Ye;try{Ye=B2({definition:$e,layer:Or.current,x:Oe.x,y:Oe.y,color:Ct,size:It,existingComponents:st,counters:Ur?cn:{}})}catch(qe){console.error("[Component Creation] Error creating component with v2 runtime:",qe);return}if(Ye.abbreviation=Eg(Id.current),Ur&&Ye.designator){const qe=Ye.designator.match(/^([A-Za-z]+)(\d+)$/);if(qe){const at=qe[1],ft=parseInt(qe[2],10);if(Pr){const Bt=Yf();P1(at,ft,Bt)}else ai.current[at]=Math.max(ai.current[at]||0,ft)}}Bi(ct,Qt,tn,mt,Kt),Or.current==="top"?(ie(!0),ri(qe=>[...qe,Ye])):(ce(!0),wi(qe=>[...qe,Ye]));return}else if(N==="power"){if(!nn)return;const Fe=Bl?{x:ur({x:Se,y:Pe}).x,y:ur({x:Se,y:Pe}).y}:((dt,Ct)=>{let It=1/0,st=null;const $e=10/wt,Ye=wt>20?Math.max($e,1e-4):wt>10?Math.max($e,.001):Math.max($e,.01);for(const ft of ct)if(ft.type==="via"||ft.type==="pad"){const Bt=ft.points[0],ln=Math.hypot(Bt.x-dt,Bt.y-Ct);ln<=Ye&&ln<It&&(It=ln,st=Bt)}else if(ft.type==="trace")for(const Bt of ft.points){const ln=Math.hypot(Bt.x-dt,Bt.y-Ct);ln<=Ye&&ln<It&&(It=ln,st=Bt)}const at=ur(st??{x:dt,y:Ct});return{x:at.x,y:at.y,nodeId:st?.id}})(Se,Pe),Ze=fe.find(dt=>dt.id===nn);if(Ze){const dt=Fe.nodeId??gc(),Ct=`${Ze.voltage} Power Node`;if(Ee.find(cn=>cn.pointId===dt)){ia({visible:!0,title:"Node ID Conflict",message:`Cannot place power node: A ground node already exists at this Node ID (${dt}). Power and ground nodes cannot share the same Node ID.`});return}Bi(ct,Qt,tn,mt,Kt);const st={id:`power-${Date.now()}-${Math.random()}`,x:Fe.x,y:Fe.y,color:"#ff0000",size:F,powerBusId:Ze.id,layer:At,type:Ct,pointId:dt};if($t(cn=>[...cn,st]),Fe.nodeId!==void 0){const cn=Qa(Fe.nodeId,fe),$e=Rl(Fe.nodeId,fe),Ye=ml(Fe.nodeId,fe),qe=Ye.includes("Power")?"power":Ye.includes("Ground")?"ground":Ye.includes("Signal")?"signal":"unknown";ye(at=>at.map(ft=>ft.type==="via"&&ft.points.length>0&&ft.points[0].id===Fe.nodeId?{...ft,viaType:cn}:ft.type==="pad"&&ft.points.length>0&&ft.points[0].id===Fe.nodeId?{...ft,padType:$e}:ft.type==="testPoint"&&ft.points.length>0&&ft.points[0].id===Fe.nodeId?{...ft,testPointType:qe}:ft))}}return}else if(N==="ground"){if(pr===null){if(Ve.length===0){ia({visible:!0,title:"No Ground Bus",message:"No ground buses are defined. Please create a ground bus first using Tools  Manage Ground Buses."});return}Pi(!0);return}const Oe=Ve.find(Fe=>Fe.id===pr);if(Oe){const Ze=Bl?{x:ur({x:Se,y:Pe}).x,y:ur({x:Se,y:Pe}).y}:((cn,$e)=>{let Ye=1/0,qe=null;const ft=10/wt,Bt=wt>20?Math.max(ft,1e-4):wt>10?Math.max(ft,.001):Math.max(ft,.01);for(const Qn of ct)if(Qn.type==="via"||Qn.type==="pad"){const Vn=Qn.points[0],Gn=Math.hypot(Vn.x-cn,Vn.y-$e);Gn<=Bt&&Gn<Ye&&(Ye=Gn,qe=Vn)}else if(Qn.type==="trace")for(const Vn of Qn.points){const Gn=Math.hypot(Vn.x-cn,Vn.y-$e);Gn<=Bt&&Gn<Ye&&(Ye=Gn,qe=Vn)}const _n=ur(qe??{x:cn,y:$e});return{x:_n.x,y:_n.y,nodeId:qe?.id}})(Se,Pe),dt=Ze.nodeId??gc(),Ct=`${Oe.name} Ground Node`,It=Re.find(cn=>cn.pointId===dt);if(It){ia({visible:!0,title:"Node ID Conflict",message:`Cannot place ground node: A power node (${It.type||"Power Node"}) already exists at this Node ID (${dt}). Power and ground nodes cannot share the same Node ID.`});return}Bi(ct,Qt,tn,mt,Kt);const st={id:`gnd-${Date.now()}-${Math.random().toString(36).slice(2,6)}`,x:Ze.x,y:Ze.y,color:Oe.color,size:F||fi.get("ground")?.settings.size||18,groundBusId:Oe.id,layer:At,type:Ct,pointId:dt};if(sn(cn=>[...cn,st]),Ze.nodeId!==void 0){const cn=Qa(Ze.nodeId,fe),$e=Rl(Ze.nodeId,fe);ye(Ye=>Ye.map(qe=>qe.type==="via"&&qe.points.length>0&&qe.points[0].id===Ze.nodeId?{...qe,viaType:cn}:qe.type==="pad"&&qe.points.length>0&&qe.points[0].id===Ze.nodeId?{...qe,padType:$e}:qe))}}return}},[N,en,F,G,Je,At,ct,wt,Zn.x,Zn.y,mn,Dt,Bl,nn,pr,fe,Ve,Ml,fi,Hn,ui,di,Re,Ee,Qa,Rl,ml,No,Bo,Zo]),mf=L.useCallback(c=>{if(N!=="magnify")return;c.preventDefault();const x=Tt.current;if(!x)return;const P=x.getBoundingClientRect(),B=x.width/P.width,K=x.height/P.height,ne=c.nativeEvent.offsetX,z=c.nativeEvent.offsetY,Ne=typeof ne=="number"?ne:c.clientX-P.left,ve=typeof z=="number"?z:c.clientY-P.top,Le=Ne*B,Me=ve*K,Ae=Le-5,he=Me-5,me=$f(Ae,he,Zn,wt,mn,Dt),Se=me.x,Pe=me.y,Oe=1.2,Fe=1/Oe,Ze=c.deltaY<0?Oe:Fe,dt=Math.max(.25,Math.min(8,wt*Ze));_i(Se,Pe),Wn(dt)},[N,wt,Zn.x,Zn.y,mn,Dt]),bf=L.useCallback(c=>{if(N==="draw"&&Je==="trace"){ti.current=!0;let Ze=Ke;if(Ze.length>1){const dt=[Ze[0]];for(let Ct=1;Ct<Ze.length;Ct++){const It=dt[dt.length-1],st=Ze[Ct];(Math.abs(It.x-st.x)>.001||Math.abs(It.y-st.y)>.001)&&dt.push(st)}Ze=dt}if(Ze.length>=1){Bi(ct,Qt,tn,mt,Kt);const dt=ui||"top",Ct=dt==="top"?"traceTop":"traceBottom",It=On.get(Ct),st={id:`${Date.now()}-trace`,points:Ze,color:It.color,size:It.size,layer:dt,type:"trace"};ye(cn=>[...cn,st]),dt==="top"?$o(cn=>[...cn,st.id]):ms(cn=>[...cn,st.id]),vt([]),ht(null),setTimeout(()=>{ti.current=!1},300);return}}const x=Tt.current;if(!x)return;const P=x.getBoundingClientRect(),B=x.width/P.width,K=x.height/P.height,ne=c.nativeEvent.offsetX,z=c.nativeEvent.offsetY,Ne=typeof ne=="number"?ne:c.clientX-P.left,ve=typeof z=="number"?z:c.clientY-P.top,Le=Ne*B,Me=ve*K,Ae=Le-5,he=Me-5,me=$f(Ae,he,Zn,wt,mn,Dt),Se=me.x,Pe=me.y,Oe=Math.max(8/wt,4),Fe=(()=>{for(const Ze of ct)if(Ze.type==="testPoint"&&Ze.points.length>0){const dt=Ze.points[0],Ct=Math.hypot(dt.x-Se,dt.y-Pe),It=(Ze.size||18)/2;if(Ct<=It+Oe)return Ze}return null})();if(Fe){Cn(new Set([Fe.id])),yn(new Set),pn(new Set),jn(new Set),yo(!0);return}if(N==="select"||N==="component"){const dt=(()=>{for(const st of Qt)if(Se>=st.x-10&&Se<=st.x+10&&Pe>=st.y-10&&Pe<=st.y+10)return{layer:"top",comp:st};for(const st of tn)if(Se>=st.x-10&&Se<=st.x+10&&Pe>=st.y-10&&Pe<=st.y+10)return{layer:"bottom",comp:st};return null})(),Ct=Math.max(6/wt,4);let It=null;for(const st of Re){const cn=Math.max(6,st.size/2),$e=cn*.8,Ye=cn+$e,qe=Math.hypot(st.x-Se,st.y-Pe),at=Math.abs(Se-st.x)<=Ct&&Math.abs(Pe-st.y)<=Ye,ft=Math.abs(Pe-st.y)<=Ct&&Math.abs(Se-st.x)<=Ye;if(qe<=Math.max(cn,Ct)||at||ft){It=st;break}}if(It){pn(new Set([It.id])),li({visible:!0,id:It.id,layer:It.layer,x:It.x,y:It.y,size:It.size,color:It.color,powerBusId:It.powerBusId});return}if(dt){const{layer:st,comp:cn}=dt;T(cn,st)}}},[N,Je,G,F,At,Qt,tn,Re,wt,Zn.x,Zn.y,mn,Dt,Ml,Bl,ct,en,sa,mp,uo,fi,Ke,ui,H,Z,we,de,yo,Cn,yn,pn,jn,T]),Pu=L.useCallback(()=>{const c=An.current;if(N==="draw"&&Je==="trace"&&c.length>=2){let x=[c[0]];for(let z=1;z<c.length;z++){const Ne=x[x.length-1],ve=c[z];(Math.abs(Ne.x-ve.x)>.001||Math.abs(Ne.y-ve.y)>.001)&&x.push(ve)}const P=ui||"top",B=P==="top"?"traceTop":"traceBottom",K=On.get(B),ne={id:`${Date.now()}-trace`,points:x,color:K.color,size:K.size,layer:P,type:"trace"};Bi(ct,Qt,tn,mt,Kt),ye(z=>[...z,ne]),P==="top"?$o(z=>[...z,ne.id]):ms(z=>[...z,ne.id]),vt([]),ht(null)}else if(N==="draw"&&Je==="trace"&&c.length===1){const x=ui||"top",P=x==="top"?"traceTop":"traceBottom",B=On.get(P),K={id:`${Date.now()}-trace-dot`,points:c,color:B.color,size:B.size,layer:x,type:"trace"};ye(ne=>[...ne,K]),x==="top"?$o(ne=>[...ne,K.id]):ms(ne=>[...ne,K.id]),vt([])}},[N,Je,ui,H,Z,we,de,ye]),vf=L.useCallback((c,x,P)=>{const B=x-c.x,K=P-c.y;if(B===0&&K===0)return{x,y:P};const z=(A2(B,K)%180+180)%180,Ne=[0,45,90];let ve=0,Le=1e9;for(const Me of Ne){const Ae=Math.abs(z-Me);Ae<Le&&(Le=Ae,ve=Me)}if(ve===0)return{x,y:c.y};if(ve===90)return{x:c.x,y:P};{const Me=Math.min(Math.abs(B),Math.abs(K)),Ae=B>=0?1:-1,he=K>=0?1:-1;return{x:c.x+Ae*Me,y:c.y+he*Me}}},[]),wf=L.useCallback(c=>{const x=Tt.current?.getBoundingClientRect();if(!x)return;const P=c.clientX-x.left,B=c.clientY-x.top,K=Tt.current,ne=K.width/x.width,z=K.height/x.height,Ne=P*ne,ve=B*z,Le=Ne-5,Me=ve-5,Ae=$f(Le,Me,Zn,wt,mn,Dt),he=Ae.x,me=Ae.y;if(Ii({x:he,y:me}),Ms.current&&ps.current&&Su({start:ps.current.start,end:{x:he,y:me}}),N==="draw"&&Je==="trace"&&Ke.length>0){const Pe=Bl?{x:ur({x:he,y:me}).x,y:ur({x:he,y:me}).y}:((Oe,Fe)=>{let Ze=1/0,dt=null;const It=10/wt,st=wt>20?Math.max(It,1e-4):wt>10?Math.max(It,.001):Math.max(It,.01);for(const Ye of ct)if(Ye.type==="via"){const qe=Ye.points[0],at=Math.hypot(qe.x-Oe,qe.y-Fe);at<=st&&at<Ze&&(Ze=at,dt=qe)}else if(Ye.type==="pad"){const qe=Ye.points[0],at=Math.hypot(qe.x-Oe,qe.y-Fe);at<=st&&at<Ze&&(Ze=at,dt=qe)}for(const Ye of Re)if(Ye.pointId!==void 0){const qe=Math.hypot(Ye.x-Oe,Ye.y-Fe);qe<=st&&qe<Ze&&(Ze=qe,dt={x:Ye.x,y:Ye.y,id:Ye.pointId})}for(const Ye of Ee)if(Ye.pointId!==void 0){const qe=Math.hypot(Ye.x-Oe,Ye.y-Fe);qe<=st&&qe<Ze&&(Ze=qe,dt={x:Ye.x,y:Ye.y,id:Ye.pointId})}const $e=ur(dt??{x:Oe,y:Fe});return{x:$e.x,y:$e.y,nodeId:dt?.id}})(he,me);ht({x:Pe.x,y:Pe.y})}else ht(null);if(la){const Pe=(()=>{for(const Oe of Qt)if(he>=Oe.x-10&&he<=Oe.x+10&&me>=Oe.y-10&&me<=Oe.y+10)return{layer:"top",comp:Oe};for(const Oe of tn)if(he>=Oe.x-10&&he<=Oe.x+10&&me>=Oe.y-10&&me<=Oe.y+10)return{layer:"bottom",comp:Oe};return null})();if(Pe)Ta({component:Pe.comp,layer:Pe.layer,x:c.clientX,y:c.clientY}),Ca(null);else{Ta(null);const Oe=Math.max(8/wt,4),Fe=(()=>{for(const Ze of ct)if(Ze.type==="testPoint"&&Ze.points.length>0){const dt=Ze.points[0],Ct=Math.hypot(dt.x-he,dt.y-me),It=(Ze.size||18)/2;if(Ct<=It+Oe)return Ze}return null})();Ca(Fe?{stroke:Fe,x:c.clientX,y:c.clientY}:null)}}else Ta(null),Ca(null);if(N==="select"&&sl&&cu){const Se=cu.x,Pe=cu.y;rd({x:Math.min(Se,he),y:Math.min(Pe,me),width:Math.abs(he-Se),height:Math.abs(me-Pe)})}else if(N==="pan"&&sa&&Co.current){const{startCX:Se,startCY:Pe,objectStartPositions:Oe}=Co.current,Fe=Le-Se,Ze=Me-Pe,dt=k1(Fe,Ze,wt,mn,Dt),Ct=dt.x,It=dt.y;Oe&&(o&&s({...o,x:Oe.topImageX+Ct,y:Oe.topImageY+It}),l&&d({...l,x:Oe.bottomImageX+Ct,y:Oe.bottomImageY+It}),ri(Qt.map(st=>({...st,x:(Oe.componentsTop?.[st.id]?.x??st.x)+Ct,y:(Oe.componentsTop?.[st.id]?.y??st.y)+It}))),wi(tn.map(st=>({...st,x:(Oe.componentsBottom?.[st.id]?.x??st.x)+Ct,y:(Oe.componentsBottom?.[st.id]?.y??st.y)+It}))),$t(mt.map(st=>({...st,x:(Oe.powerSymbols?.[st.id]?.x??st.x)+Ct,y:(Oe.powerSymbols?.[st.id]?.y??st.y)+It}))),sn(Kt.map(st=>({...st,x:(Oe.groundSymbols?.[st.id]?.x??st.x)+Ct,y:(Oe.groundSymbols?.[st.id]?.y??st.y)+It}))),ye(ct.map((st,cn)=>({...st,points:st.points.map(($e,Ye)=>{const qe=Oe.drawingStrokes?.[cn]?.points?.[Ye];return{...$e,x:(qe?.x??$e.x)+Ct,y:(qe?.y??$e.y)+It}})}))),ea(za.map((st,cn)=>{const $e=Oe.vias?.[cn];return{...st,x:($e?.x??st.x)+Ct,y:($e?.y??st.y)+It}})),xr(Jr.map((st,cn)=>{const $e=Oe.pads?.[cn];return{...st,x:($e?.x??st.x)+Ct,y:($e?.y??st.y)+It}})))}else if(ze&&Ke.length>0){if(N==="draw")if(hr){const Se=Ke[0],Pe=vf(Se,he,me),Oe=ur(Pe),Fe={id:gc(),x:Oe.x,y:Oe.y};vt([Se,Fe])}else{const Se=ur({x:he,y:me});vt(Pe=>[...Pe,{id:gc(),x:Se.x,y:Se.y}])}else if(N==="erase"&&(vt(Se=>[...Se,{id:gc(),x:he,y:me}]),ye(Se=>{const Pe=Se.filter(Fe=>{if(Fe.type==="via"&&Dr||Fe.type==="pad"&&ma||Fe.type==="testPoint"&&na||Fe.type==="trace"&&fo||Fe.layer!==At)return!0;const Ze=F/2,dt=he-Ze,Ct=he+Ze,It=me-Ze,st=me+Ze,cn=(qe,at)=>qe>=dt&&qe<=Ct&&at>=It&&at<=st,$e=(qe,at,ft,Bt)=>{const Xn=(Ao,Vo)=>{let Kn=0;return Ao<dt?Kn|=1:Ao>Ct&&(Kn|=2),Vo<It?Kn|=4:Vo>st&&(Kn|=8),Kn};let Bn=qe,Rt=at,Ln=ft,br=Bt,mo=Xn(Bn,Rt),rr=Xn(Ln,br);for(;;){if((mo|rr)===0)return!0;if((mo&rr)!==0)return!1;const Ao=mo!==0?mo:rr;let Vo=0,Kn=0;Ao&8?(Vo=Bn+(Ln-Bn)*(st-Rt)/(br-Rt),Kn=st):Ao&4?(Vo=Bn+(Ln-Bn)*(It-Rt)/(br-Rt),Kn=It):Ao&2?(Kn=Rt+(br-Rt)*(Ct-Bn)/(Ln-Bn),Vo=Ct):(Kn=Rt+(br-Rt)*(dt-Bn)/(Ln-Bn),Vo=dt),Ao===mo?(Bn=Vo,Rt=Kn,mo=Xn(Bn,Rt)):(Ln=Vo,br=Kn,rr=Xn(Ln,br))}};let Ye=!1;if(Fe.points.length===1){const qe=Fe.points[0];Ye=cn(qe.x,qe.y)}else for(let qe=0;qe<Fe.points.length-1;qe++){const at=Fe.points[qe],ft=Fe.points[qe+1];if($e(at.x,at.y,ft.x,ft.y)){Ye=!0;break}}return Ye&&console.log("Erasing stroke at position:",he,me,"brushSize:",F,"selectedLayer:",At),!Ye});console.log("Strokes before:",Se.length,"after:",Pe.length);const Oe=new Set(Pe.map(Fe=>Fe.id));return al(Fe=>Fe.filter(Ze=>Oe.has(Ze))),Fa(Fe=>Fe.filter(Ze=>Oe.has(Ze))),$o(Fe=>Fe.filter(Ze=>Oe.has(Ze))),ms(Fe=>Fe.filter(Ze=>Oe.has(Ze))),Pe}),$i||$t(Se=>{const Pe=F/2,Oe=he-Pe,Fe=he+Pe,Ze=me-Pe,dt=me+Pe,Ct=It=>{const st=It.size/2,cn=It.x-st,$e=It.x+st,Ye=It.y-st,qe=It.y+st;return!(Fe<cn||Oe>$e||dt<Ye||Ze>qe)};return Se.filter(It=>!Ct(It))}),vo||sn(Se=>{const Pe=F/2,Oe=he-Pe,Fe=he+Pe,Ze=me-Pe,dt=me+Pe,Ct=st=>{const cn=Math.max(6,(st.size||18)/2),$e=cn*.8,Ye=cn+$e,qe=st.x-Ye,at=st.x+Ye,ft=st.y-Ye,Bt=st.y+Ye;return!(Fe<qe||Oe>at||dt<ft||Ze>Bt)};return Se.filter(st=>!Ct(st))}),!Wi)){const Se=F/2,Pe=he-Se,Oe=he+Se,Fe=me-Se,Ze=me+Se,dt=Ct=>{const st=(Ct.size||18)/2,cn=Ct.x-st,$e=Ct.x+st,Ye=Ct.y-st,qe=Ct.y+st;return!(Oe<cn||Pe>$e||Ze<Ye||Fe>qe)};Bi(ct,Qt,tn,mt,Kt),ri(Ct=>Ct.filter(It=>!dt(It))),wi(Ct=>Ct.filter(It=>!dt(It)))}}else if(Mr&&Zi&&en){if(Qi){qt(!1),Ji(null);return}const Se=he-Zi.x,Pe=me-Zi.y;if(en==="top"){o&&s(Oe=>Oe?{...Oe,x:Oe.x+Se,y:Oe.y+Pe}:null),Ji({x:he,y:me});return}if(en==="bottom"){l&&d(Oe=>Oe?{...Oe,x:Oe.x+Se,y:Oe.y+Pe}:null),Ji({x:he,y:me});return}if(en==="both"){o&&s(Oe=>Oe?{...Oe,x:Oe.x+Se,y:Oe.y+Pe}:null),l&&d(Oe=>Oe?{...Oe,x:Oe.x+Se,y:Oe.y+Pe}:null),Ji({x:he,y:me});return}}},[ze,Ke,N,F,Mr,Zi,en,o,l,hr,vf,At,ye,wt,Zn.x,Zn.y,mn,Dt,sl,cu,Qi,Dr,ma,fo,$i,vo,Qt,tn,ri,wi,la,Ta,Bl,ct,Re,Ee,Ke,Je,Vt,ht,sa,Co,Ea,5,Zn,gc,ur,g,fr,Bi,mt,Kt,Ii]),od=L.useCallback(()=>{if(Ii(null),Ps.current&&ps.current&&uc.current&&Ms.current){const c=ps.current,x=uc.current,P=Math.abs(c.end.x-c.start.x),B=Math.abs(c.end.y-c.start.y);if(P>=1&&B>=1)try{const ne=Mw({numPins:x.numPins,type:x.type,twoSidedOrientation:x.twoSidedOrientation,point1:c.start,point2:c.end}).map(z=>{const Ne=dc.current?(Hn||"top")==="top"?"padTop":"padBottom":"via",ve=On.get(Ne),Le=gc(),Me=dc.current&&Hn||"top";return{id:Le.toString(),type:dc.current?"pad":"via",points:[{x:z.x,y:z.y,id:Le}],size:ve.size,color:ve.color,layer:Me}});ye(z=>{const Ne=[...z,...ne];return Bi(Ne,Qt,tn,mt,Kt),Ne})}catch(K){console.error("IC Placement error:",K),alert(`Error placing ${dc.current?"pads":"vias"}: ${K instanceof Error?K.message:String(K)}`)}Qu(!1),Su(null),Ju(null),au(!1),Ps.current=!1,ps.current=null,uc.current=null,Ms.current=!1,ji(void 0),g("select");return}if(N==="select"&&sl){const c=Ol,x=cu;if(Yo(!1),vp(null),rd(null),c&&x){const K=Math.max(3,5/wt),ne=c.width<K&&c.height<K,z=($e,Ye)=>{const qe=c.x,at=c.y,ft=c.x+c.width,Bt=c.y+c.height;return $e>=qe&&$e<=ft&&Ye>=at&&Ye<=Bt},Ne=($e,Ye,qe,at,ft,Bt,ln,_n)=>{const Rt=(Kn,wl)=>{let rl=0;return Kn<ft?rl|=1:Kn>ln&&(rl|=2),wl<Bt?rl|=4:wl>_n&&(rl|=8),rl};let Ln=$e,br=Ye,mo=qe,rr=at,Ao=Rt(Ln,br),Vo=Rt(mo,rr);for(;;){if((Ao|Vo)===0)return!0;if((Ao&Vo)!==0)return!1;const Kn=Ao!==0?Ao:Vo;let wl=0,rl=0;Kn&8?(wl=Ln+(mo-Ln)*(_n-br)/(rr-br),rl=_n):Kn&4?(wl=Ln+(mo-Ln)*(Bt-br)/(rr-br),rl=Bt):Kn&2?(rl=br+(rr-br)*(ln-Ln)/(mo-Ln),wl=ln):(rl=br+(rr-br)*(ft-Ln)/(mo-Ln),wl=ft),Kn===Ao?(Ln=wl,br=rl,Ao=Rt(Ln,br)):(mo=wl,rr=rl,Vo=Rt(mo,rr))}},ve=c.x,Le=c.y,Me=c.x+c.width,Ae=c.y+c.height,me=Math.max(6/wt,4/wt,.5),Se=($e,Ye,qe,at,ft,Bt)=>{const ln=ft-qe,_n=Bt-at;if(ln===0&&_n===0)return Math.hypot($e-qe,Ye-at);const Qn=Math.max(0,Math.min(1,(($e-qe)*ln+(Ye-at)*_n)/(ln*ln+_n*_n))),Vn=qe+Qn*ln,Gn=at+Qn*_n;return Math.hypot($e-Vn,Ye-Gn)},Pe=x?.shiftKey===!0,Oe=new Set(Pe?Array.from(wn):[]),Fe=new Set(Pe?Array.from(Fn):[]),Ze=new Set(Pe?Array.from(Ni):[]),dt=new Set(Pe?Array.from(vi):[]),Ct=x?.hitStrokeId;if(Ct){const $e=ct.find(Ye=>Ye.id===Ct);if($e){let Ye=!1;if($e.type==="via"||$e.type==="pad"?Ye=No:Ye=$e.layer==="top"?Ma:Ba,Ye){Pe?Cn(qe=>{const at=new Set(qe);return at.has(Ct)?at.delete(Ct):at.add(Ct),at}):(Cn(new Set([Ct])),yn(new Set),pn(new Set),jn(new Set));return}}}if(ne){let $e=null;for(const Ye of ct){let qe=!1;if(Ye.type==="via"?qe=No:Ye.type==="pad"?qe=(Ye.layer||"top")==="top"?Bo:Zo:Ye.type==="testPoint"?qe=(Ye.layer||"top")==="top"?f:j:Ye.type==="trace"?qe=Ye.layer==="top"?Ma:Ba:qe=!1,!qe)continue;let at=1/0;if(Ye.type==="via"||Ye.type==="pad"||Ye.type==="testPoint"){const ft=Ye.points[0],Bt=Math.max(1,Ye.size/2);at=Math.hypot(ft.x-x.x,ft.y-x.y);const _n=Math.max(6/wt,4/wt,.5);at<=Math.max(Bt,_n)&&(!$e||at<$e.dist)&&($e={id:Ye.id,dist:at})}else for(let ft=0;ft<Ye.points.length-1;ft++){const Bt=Ye.points[ft],ln=Ye.points[ft+1],_n=Se(x.x,x.y,Bt.x,Bt.y,ln.x,ln.y);if(_n<=Math.max(me,Ye.size/2)){(!$e||_n<$e.dist)&&($e={id:Ye.id,dist:_n});break}}}$e&&(Pe&&Oe.has($e.id)?Oe.delete($e.id):Oe.add($e.id))}else for(const $e of ct){let Ye=!1;if($e.type==="via"?Ye=No:$e.type==="pad"?Ye=($e.layer||"top")==="top"?Bo:Zo:$e.type==="testPoint"?Ye=($e.layer||"top")==="top"?f:j:$e.type==="trace"?Ye=$e.layer==="top"?Ma:Ba:Ye=!1,!Ye)continue;let qe=!1;if($e.type==="via"||$e.type==="pad"||$e.type==="testPoint"){const at=$e.points[0];qe=z(at.x,at.y)}else for(let at=0;at<$e.points.length-1;at++){const ft=$e.points[at],Bt=$e.points[at+1];if(Ne(ft.x,ft.y,Bt.x,Bt.y,ve,Le,Me,Ae)||z(ft.x,ft.y)&&z(Bt.x,Bt.y)){qe=!0;break}}qe&&(Pe&&Oe.has($e.id)?Oe.delete($e.id):Oe.add($e.id))}const It=$e=>{const qe=Math.max(10,$e.size||18)/2;return $e.x-qe<=Me&&$e.x+qe>=ve&&$e.y-qe<=Ae&&$e.y+qe>=Le};if(ne){const $e=Ye=>{const at=Math.max(10,Ye.size||18)/2;return x.x>=Ye.x-at&&x.x<=Ye.x+at&&x.y>=Ye.y-at&&x.y<=Ye.y+at};X&&Qt.forEach(Ye=>{$e(Ye)&&(Pe&&Fe.has(Ye.id)?Fe.delete(Ye.id):Fe.add(Ye.id))}),oe&&tn.forEach(Ye=>{$e(Ye)&&(Pe&&Fe.has(Ye.id)?Fe.delete(Ye.id):Fe.add(Ye.id))})}else X&&Qt.forEach($e=>{It($e)&&(Pe&&Fe.has($e.id)?Fe.delete($e.id):Fe.add($e.id))}),oe&&tn.forEach($e=>{It($e)&&(Pe&&Fe.has($e.id)?Fe.delete($e.id):Fe.add($e.id))});const st=$e=>{const Ye=Math.max(6,$e.size/2),qe=Ye*.8,at=Ye+qe;return $e.x-at<=Me&&$e.x+at>=ve&&$e.y-at<=Ae&&$e.y+at>=Le};if(pe)if(ne){let $e=null;for(const Ye of Re){const qe=Math.max(6,Ye.size/2),at=qe*.8,ft=qe+at,Bt=Math.hypot(Ye.x-x.x,Ye.y-x.y),ln=Math.abs(x.x-Ye.x)<=me&&Math.abs(x.y-Ye.y)<=ft,_n=Math.abs(x.y-Ye.y)<=me&&Math.abs(x.x-Ye.x)<=ft;if(Bt<=Math.max(qe,me)||ln||_n){const Vn=Math.min(Bt,Math.abs(x.x-Ye.x)+Math.abs(x.y-Ye.y));(!$e||Vn<$e.dist)&&($e={id:Ye.id,dist:Vn})}}$e&&(Pe&&Ze.has($e.id)?Ze.delete($e.id):Ze.add($e.id))}else Re.forEach($e=>{st($e)&&(Pe&&Ze.has($e.id)?Ze.delete($e.id):Ze.add($e.id))});const cn=$e=>{const Ye=Math.max(6,($e.size||18)/2),qe=Ye*.8,at=Ye+qe;return $e.x-at<=Me&&$e.x+at>=ve&&$e.y-at<=Ae&&$e.y+at>=Le};if(nr)if(ne){let $e=null;for(const Ye of Ee){const qe=Math.max(6,(Ye.size||18)/2),at=qe*.8,ft=qe+at,Bt=Math.hypot(Ye.x-x.x,Ye.y-x.y),ln=Math.abs(x.x-Ye.x)<=me&&Math.abs(x.y-Ye.y)<=ft,_n=Math.abs(x.y-Ye.y)<=me&&Math.abs(x.x-Ye.x)<=ft;if(Bt<=Math.max(qe,me)||ln||_n){const Vn=Math.min(Bt,Math.abs(x.x-Ye.x)+Math.abs(x.y-Ye.y));(!$e||Vn<$e.dist)&&($e={id:Ye.id,dist:Vn})}}$e&&(Pe&&dt.has($e.id)?dt.delete($e.id):dt.add($e.id))}else Ee.forEach($e=>{cn($e)&&(Pe&&dt.has($e.id)?dt.delete($e.id):dt.add($e.id))});Cn(Oe),yn(Fe),pn(Ze),jn(dt)}}if(ze&&Ke.length>0){if(N==="draw"&&Je!=="trace"){const c={id:Date.now().toString(),points:Ke,color:G,size:F,layer:At,type:"trace"};ye(x=>[...x,c]),At==="top"?$o(x=>[...x,c.id]):ms(x=>[...x,c.id])}vt([])}sa&&(Ga(!1),Co.current=null,Mo.current=null),Nt(!1),qt(!1),Ji(null),Di(!1)},[ze,Ke,N,G,F,At,Ol,cu,sl,ct,wt,La,wn,Re,Ee,Qt,tn,Fn,Ni,vi,No,Ma,Ba,X,oe,pe,nr,Ii]);Pt.useEffect(()=>{if(!(N==="pan"&&sa&&Mo.current))return;const c=P=>{const B=Tt.current;if(!B)return;const K=B.getBoundingClientRect(),ne=B.width/K.width,z=B.height/K.height,{startClientX:Ne,startClientY:ve,objectStartPositions:Le}=Mo.current,Me=(P.clientX-Ne)*ne,Ae=(P.clientY-ve)*z,he=k1(Me,Ae,wt,mn,Dt),me=he.x,Se=he.y;Le&&(o&&s({...o,x:Le.topImageX+me,y:Le.topImageY+Se}),l&&d({...l,x:Le.bottomImageX+me,y:Le.bottomImageY+Se}),ri(Qt.map(Pe=>({...Pe,x:(Le.componentsTop?.[Pe.id]?.x??Pe.x)+me,y:(Le.componentsTop?.[Pe.id]?.y??Pe.y)+Se}))),wi(tn.map(Pe=>({...Pe,x:(Le.componentsBottom?.[Pe.id]?.x??Pe.x)+me,y:(Le.componentsBottom?.[Pe.id]?.y??Pe.y)+Se}))),$t(mt.map(Pe=>({...Pe,x:(Le.powerSymbols?.[Pe.id]?.x??Pe.x)+me,y:(Le.powerSymbols?.[Pe.id]?.y??Pe.y)+Se}))),sn(Kt.map(Pe=>({...Pe,x:(Le.groundSymbols?.[Pe.id]?.x??Pe.x)+me,y:(Le.groundSymbols?.[Pe.id]?.y??Pe.y)+Se}))),ye(ct.map((Pe,Oe)=>({...Pe,points:Pe.points.map((Fe,Ze)=>{const dt=Le.drawingStrokes?.[Oe]?.points?.[Ze];return{...Fe,x:(dt?.x??Fe.x)+me,y:(dt?.y??Fe.y)+Se}})}))),ea(za.map((Pe,Oe)=>{const Fe=Le.vias?.[Oe];return{...Pe,x:(Fe?.x??Pe.x)+me,y:(Fe?.y??Pe.y)+Se}})),xr(Jr.map((Pe,Oe)=>{const Fe=Le.pads?.[Oe];return{...Pe,x:(Fe?.x??Pe.x)+me,y:(Fe?.y??Pe.y)+Se}})))},x=()=>{Ga(!1),Co.current=null,Mo.current=null,window.removeEventListener("mousemove",c,!0),window.removeEventListener("mouseup",x,!0)};return window.addEventListener("mousemove",c,!0),window.addEventListener("mouseup",x,!0),()=>{window.removeEventListener("mousemove",c,!0),window.removeEventListener("mouseup",x,!0)}},[N,sa,wt,mn,Dt,o,l,Qt,tn,mt,Kt,ct,za,Jr,s,d,ri,wi,$t,sn,ye,ea,xr]);const uu=L.useCallback(()=>{const c=Tt.current;if(!c)return;const x=c.getContext("2d");if(!x)return;x.clearRect(0,0,c.width,c.height),x.fillStyle="#000000",x.fillRect(0,0,c.width,c.height),x.fillStyle="#ffffff",x.fillRect(5,5,c.width-10,c.height-10),x.save(),x.beginPath(),x.rect(5,5,c.width-10,c.height-10),x.clip(),x.translate(5,5);const P=(K,ne,z,Ne,ve,Le,Me,Ae)=>{const he=document.createElement("canvas");he.width=z,he.height=Ne;const me=he.getContext("2d",{willReadFrequently:!0});me.clearRect(0,0,z,Ne),me.drawImage(ne,0,0,z,Ne);let Se=he;if(Math.abs(ve)>1e-6){const Pe=hh(ve),Oe=Math.max(.2,1-Pe),Fe=Math.max(.2,1+Pe),Ze=Math.max(Oe,Fe),dt=Math.max(1,Math.ceil(z*Ze)),Ct=document.createElement("canvas");Ct.width=dt,Ct.height=Ne;const It=Ct.getContext("2d",{willReadFrequently:!0});It.clearRect(0,0,dt,Ne);for(let st=0;st<Ne;st++){const cn=Ne<=1?0:st/(Ne-1),$e=Oe*(1-cn)+Fe*cn,Ye=Math.max(1,z*$e),qe=(dt-Ye)/2;It.drawImage(Se,0,st,z,1,qe,st,Ye,1)}Se=Ct}if(Math.abs(Le)>1e-6){const Pe=hh(Le),Oe=Math.max(.2,1-Pe),Fe=Math.max(.2,1+Pe),Ze=Math.max(Oe,Fe),dt=Math.max(1,Math.ceil(Ne*Ze)),Ct=document.createElement("canvas");Ct.width=Se.width,Ct.height=dt;const It=Ct.getContext("2d",{willReadFrequently:!0});It.clearRect(0,0,Ct.width,dt);for(let st=0;st<Se.width;st++){const cn=Se.width<=1?0:st/(Se.width-1),$e=Oe*(1-cn)+Fe*cn,Ye=Math.max(1,Ne*$e),qe=(dt-Ye)/2;It.drawImage(Se,st,0,1,Se.height,st,qe,1,Ye)}Se=Ct}K.drawImage(Se,-Me/2,-Ae/2,Me,Ae)};x.translate(Zn.x,Zn.y),x.scale(wt,wt),P2(x,mn,Dt);{const K=As&&Xa;if(o&&o.bitmap&&As){const ne=o.bitmap;x.save(),x.globalAlpha=1;const z=[];o.brightness!==void 0&&o.brightness!==100&&z.push(`brightness(${o.brightness}%)`),o.contrast!==void 0&&o.contrast!==100&&z.push(`contrast(${o.contrast}%)`),U&&z.push("grayscale(100%)"),x.filter=z.length>0?z.join(" "):"none",Hg(x,{x:o.x,y:o.y,rotation:o.rotation||0,scale:o.scale||1,flipX:o.flipX||!1,flipY:o.flipY||!1,skewX:o.skewX||0,skewY:o.skewY||0});const Ne=ne.width*1,ve=ne.height*1,Le=ne;o.keystoneV&&Math.abs(o.keystoneV)>1e-6||o.keystoneH&&Math.abs(o.keystoneH)>1e-6?P(x,Le,ne.width,ne.height,o.keystoneV||0,o.keystoneH||0,Ne,ve):x.drawImage(Le,-Ne/2,-ve/2,Ne,ve),x.restore()}if(l&&l.bitmap&&Xa){const ne=l.bitmap;x.save(),x.globalAlpha=K?v/100:1;const z=[];l.brightness!==void 0&&l.brightness!==100&&z.push(`brightness(${l.brightness}%)`),l.contrast!==void 0&&l.contrast!==100&&z.push(`contrast(${l.contrast}%)`),U&&z.push("grayscale(100%)"),x.filter=z.length>0?z.join(" "):"none",Hg(x,{x:l.x,y:l.y,rotation:l.rotation||0,scale:l.scale||1,flipX:l.flipX||!1,flipY:l.flipY||!1,skewX:l.skewX||0,skewY:l.skewY||0});const Ne=ne.width*1,ve=ne.height*1,Le=ne;l.keystoneV&&Math.abs(l.keystoneV)>1e-6||l.keystoneH&&Math.abs(l.keystoneH)>1e-6?P(x,Le,ne.width,ne.height,l.keystoneV||0,l.keystoneH||0,Ne,ve):x.drawImage(Le,-Ne/2,-ve/2,Ne,ve),x.restore()}}if(Sp(x),pe&&Re.length>0){const K=ne=>{x.save(),N1(x,ne.x,ne.y,ne.rotation??0,ne.flipX??!1,!1);const z=fe.find(Ae=>Ae.id===ne.powerBusId),Ne=Ni.has(ne.id),ve=z?.color||"#ff0000";x.strokeStyle=ve,x.lineWidth=Math.max(1,(Ne?3:2)/Math.max(wt,.001)),x.lineCap="round";const Le=Math.max(6,ne.size/2),Me=Le*.8;if(Ne&&(x.strokeStyle="#0066ff",x.lineWidth=Math.max(1,4/Math.max(wt,.001)),x.beginPath(),x.arc(0,0,Le+Me+3,0,es),x.stroke()),x.strokeStyle=ve,x.lineWidth=Math.max(1,(Ne?3:2)/Math.max(wt,.001)),x.beginPath(),x.arc(0,0,Le,0,es),x.stroke(),x.beginPath(),x.moveTo(0,-Le-Me),x.lineTo(0,Le+Me),x.stroke(),x.beginPath(),x.moveTo(-Le-Me,0),x.lineTo(Le+Me,0),x.stroke(),z){x.fillStyle=ve;const Ae=Math.max(10,Le*.8);x.font=`${Ae}px sans-serif`,x.textAlign="center",x.textBaseline="top",x.fillText(z.name,0,Le+Me+8)}x.restore()};Re.forEach(K)}if(nr&&Ee.length>0){const K=ne=>{x.save(),N1(x,ne.x,ne.y,ne.rotation??0,ne.flipX??!1,!1);const z=vi.has(ne.id),Ne=Ve.find(Ae=>Ae.id===ne.groundBusId),ve=Ne?.color||ne.color||"#000000",Le=ne.groundBusId==="groundbus-earth";let Me;if(Le){const Ae=Math.max(6,ne.size||18),he=Ae*.9,me=Ae*.24,Se=Ae*1.6;x.strokeStyle=ve,x.lineWidth=Math.max(1,(z?3:2)/Math.max(wt,.001)),x.lineCap="round",z&&(x.strokeStyle="#0066ff",x.lineWidth=Math.max(1,4/Math.max(wt,.001)),x.setLineDash([5,5]),x.strokeRect(-Se/2-3,-3,Se+6,he+me*2+6),x.setLineDash([])),x.strokeStyle=ve,x.lineWidth=Math.max(1,(z?3:2)/Math.max(wt,.001)),x.beginPath(),x.moveTo(0,0),x.lineTo(0,he),x.stroke();for(let Pe=0;Pe<3;Pe++){const Oe=he+Pe*me,Fe=Se*(1-Pe*.25);x.beginPath(),x.moveTo(-Fe/2,Oe),x.lineTo(Fe/2,Oe),x.stroke()}Me=he+me*2}else{const Ae=Math.max(6,(ne.size||18)/2),he=Ae*.8;z&&(x.strokeStyle="#0066ff",x.lineWidth=Math.max(1,4/Math.max(wt,.001)),x.beginPath(),x.arc(0,0,Ae+he+3,0,es),x.stroke()),x.strokeStyle=ve,x.lineWidth=Math.max(1,(z?3:2)/Math.max(wt,.001)),x.beginPath(),x.arc(0,0,Ae,0,es),x.stroke(),x.beginPath(),x.moveTo(0,-Ae-he),x.lineTo(0,Ae+he),x.stroke(),x.beginPath(),x.moveTo(-Ae-he,0),x.lineTo(Ae+he,0),x.stroke(),Me=Ae+he}if(Ne){x.fillStyle=ve;const Ae=Math.max(10,(ne.size||18)*.5);x.font=`${Ae}px sans-serif`,x.textAlign="center",x.textBaseline="top",x.fillText(Ne.name,0,Me+8)}x.restore()};Ee.forEach(K)}const B=K=>{const ne=Math.max(10,K.size||18),z=ne/2;x.save(),x.translate(K.x,K.y),z2(x,mn,Dt),K.orientation!==void 0&&K.orientation!==0&&x.rotate(mu(K.orientation)),K.flipX&&x.scale(-1,1),K.flipY&&x.scale(1,-1),x.strokeStyle=K.color||"#111",x.lineWidth=Math.max(1,2/Math.max(wt,.001));const Ne=K.pinConnections||[],ve=Ne.length>0&&Ne.length===K.pinCount&&Ne.every(Ae=>Ae&&Ae.trim()!=="");x.fillStyle=ve?"rgba(178, 223, 138, 0.85)":"rgba(255,255,255,0.85)",x.beginPath(),x.rect(-z,-z,ne,ne),x.fill(),x.stroke();const Le=K.designator?.trim()||"";if(Le){x.fillStyle=K.color||"#111";const Ae=Math.max(6,ne*.35),he=ne*.9;let me=Ae;x.font=`bold ${me}px sans-serif`;const Se=x.measureText(Le);Se.width>he&&(me=he/Se.width*me,me=Math.max(6,me),x.font=`bold ${me}px sans-serif`),x.textAlign="center",x.textBaseline="middle",x.fillText(Le,0,0)}Fn.has(K.id)&&(x.setLineDash([4,3]),x.strokeStyle="#00bfff",x.lineWidth=1.5,x.strokeRect(-z-3,-z-3,ne+6,ne+6),x.setLineDash([])),x.restore()};if(yi){const K=z=>{const Ne=parseInt(z,10);if(isNaN(Ne))return null;for(const ve of ct)if((ve.type==="via"||ve.type==="pad"||ve.type==="testPoint")&&ve.points.length>0){const Le=ve.points[0];if(Le.id===Ne)return{x:Le.x,y:Le.y}}for(const ve of ct)if(ve.type==="trace"){for(const Le of ve.points)if(Le.id===Ne)return{x:Le.x,y:Le.y}}for(const ve of Re)if(ve.pointId===Ne)return{x:ve.x,y:ve.y};for(const ve of Ee)if(ve.pointId===Ne)return{x:ve.x,y:ve.y};return null},ne=z=>{const Ne=z.pinConnections||[],ve=ip(z)&&z.pinPolarities,Me=$l(z)?.category==="Semiconductors",Ae=new Map;for(let he=0;he<Ne.length;he++){const me=Ne[he];if(me&&me.trim()!==""){const Se=me.trim(),Pe=Me&&he===0,Oe=!!(ve&&z.pinPolarities&&he<z.pinPolarities.length&&z.pinPolarities[he]==="-"),Fe=Ae.get(Se);Fe!==void 0?Ae.set(Se,{isNegative:Fe.isNegative||Oe,hasPin1:Fe.hasPin1||Pe}):Ae.set(Se,{isNegative:Oe,hasPin1:Pe})}}for(const[he,me]of Ae){const{isNegative:Se,hasPin1:Pe}=me,Oe=K(he);if(Oe){const Fe={x:z.x,y:z.y},Ze=parseInt(he,10),dt=`${z.id}:${Ze}`,Ct=Lr.has(dt);x.save(),Ct?(x.strokeStyle="#00bfff",x.lineWidth=Math.max(2,tt*1.5/Math.max(wt,.001)),x.setLineDash([4,3])):(Se?x.strokeStyle="rgba(0, 0, 0, 0.8)":Pe?x.strokeStyle=_2(Zt,.4):x.strokeStyle=Zt,x.lineWidth=Math.max(1,tt/Math.max(wt,.001))),x.beginPath(),x.moveTo(Fe.x,Fe.y),x.lineTo(Oe.x,Oe.y),x.stroke(),x.setLineDash([]),x.restore()}}};X&&Qt.forEach(ne),oe&&tn.forEach(ne)}if(X&&Qt.forEach(B),oe&&tn.forEach(B),ou&&lc){x.save();const K=lc.start,ne=lc.end,z=Math.min(K.x,ne.x),Ne=Math.min(K.y,ne.y),ve=Math.max(K.x,ne.x),Le=Math.max(K.y,ne.y),Me=ve-z,Ae=Le-Ne,he=Math.max(2,6/Math.max(1e-4,wt));x.strokeStyle="#ff8800",x.fillStyle="rgba(255, 136, 0, 0.2)",x.lineWidth=Math.max(1,2/Math.max(1e-4,wt)),x.setLineDash([he,he]),x.beginPath(),x.rect(z,Ne,Me,Ae),x.fill(),x.stroke(),x.fillStyle="#ff8800",x.beginPath(),x.arc(K.x,K.y,Math.max(3,6/Math.max(1e-4,wt)),0,Math.PI*2),x.fill(),x.setLineDash([]),x.restore()}if(N==="select"&&Ol){x.save();const K=Math.max(2,6/Math.max(1e-4,wt));x.strokeStyle="#00bfff",x.fillStyle="rgba(0, 191, 255, 0.15)",x.lineWidth=Math.max(1,1.5/Math.max(1e-4,wt)),x.setLineDash([K,K]),x.beginPath(),x.rect(Ol.x,Ol.y,Ol.width,Ol.height),x.fill(),x.stroke(),x.setLineDash([]),x.restore()}if(go){x.save();const K=50,z=2/wt;x.strokeStyle="#FF0000",x.lineWidth=z,x.lineCap="round",x.lineJoin="round",x.beginPath(),x.moveTo(-K,0),x.lineTo(K,0),x.stroke(),x.fillStyle="#FF0000",x.font=`${12/wt}px sans-serif`,x.textAlign="left",x.textBaseline="top",x.fillText("+X",K+2/wt,2/wt),x.textAlign="right",x.fillText("-X",-K-2/wt,2/wt),x.strokeStyle="#0000FF",x.lineWidth=z,x.lineCap="round",x.lineJoin="round",x.beginPath(),x.moveTo(0,-K),x.lineTo(0,K),x.stroke(),x.fillStyle="#0000FF",x.font=`${12/wt}px sans-serif`,x.textAlign="left",x.textBaseline="top",x.fillText("+Y",2/wt,K+2/wt),x.textBaseline="bottom",x.fillText("-Y",2/wt,-K-2/wt),x.restore()}x.restore()},[o,l,v,ct,Ke,ze,N,G,F,U,en,At,wt,Zn.x,Zn.y,mn,Dt,As,Xa,No,Ma,Ba,Bo,Zo,f,j,X,oe,Qt,tn,pe,Re,nr,Ee,yi,Ol,wn,Fn,Ni,vi,Lr,ui,H,Z,we,de,Je,Vt,Qi,Zt,tt,Ui,go,rn,ou,lc]);Pt.useEffect(()=>{const c=()=>{const x=Bc.current;if(!x)return;const P=1.6,B=244,K=12,ne=6,z=12,Ne=x.clientWidth-B-K,ve=x.getBoundingClientRect(),Le=window.innerHeight,Me=ve.top,he=Le-Me-ne-10,me=Math.min(x.clientHeight-z,he),Se=Math.floor(me*P),Pe=Math.floor(Ne/P);let Oe,Fe;Se<=Ne?(Oe=Se,Fe=me):(Oe=Ne,Fe=Pe),Oe=Math.max(600,Oe),Fe=Math.max(375,Fe),Fe=Math.max(355,Fe-20),vc(Ze=>{const dt=Ze.width===0&&Ze.height===0,Ct=Ze.width!==Oe||Ze.height!==Fe;return dt&&Ct&&setTimeout(()=>{bn({x:0,y:0})},0),Ze.width===Oe&&Ze.height===Fe?Ze:{width:Oe,height:Fe}})};return c(),window.addEventListener("resize",c),()=>window.removeEventListener("resize",c)},[Ea,bn]),Pt.useEffect(()=>{Qi&&(Mr&&(qt(!1),Ji(null)),zi(null))},[Qi,Mr,qt,Ji,zi]);const Sp=L.useCallback(c=>{if(ct.forEach(x=>{if(x.type==="via"||x.type==="pad"||x.type==="testPoint"||x.testPointType!==void 0||x.type!=="trace")return;let P=!1;if(x.layer==="top"?P=Ma:x.layer==="bottom"&&(P=Ba),!!P){if(x.points.length===1){const B=x.points[0],K=Math.max(.5,x.size/2);wn.has(x.id)&&(c.strokeStyle="#00bfff",c.lineWidth=2,c.setLineDash([4,3]),c.beginPath(),c.arc(B.x,B.y,K+3,0,es),c.stroke(),c.setLineDash([])),c.fillStyle=x.color,c.beginPath(),c.arc(B.x,B.y,K,0,es),c.fill()}else if(wn.has(x.id)&&(c.strokeStyle="#00bfff",c.lineWidth=x.size+4,c.lineCap="round",c.lineJoin="round",c.globalAlpha=.6,c.beginPath(),x.points.forEach((B,K)=>{K===0?c.moveTo(B.x,B.y):c.lineTo(B.x,B.y)}),c.stroke(),c.globalAlpha=1),c.strokeStyle=x.color,c.lineWidth=x.size,c.lineCap="round",c.lineJoin="round",c.globalAlpha=1,c.beginPath(),x.points.forEach((B,K)=>{K===0?c.moveTo(B.x,B.y):c.lineTo(B.x,B.y)}),c.stroke(),Ui){c.fillStyle="#000000";for(const B of x.points)c.beginPath(),c.arc(B.x,B.y,x.size/2,0,es),c.fill()}}}),ct.forEach(x=>{if(x.type==="via"){if(!No)return}else if(x.type==="pad"){const B=x.layer||"top";if(B==="top"&&!Bo||B==="bottom"&&!Zo)return}else if(x.type==="testPoint"){const B=x.layer||"top";if(B==="top"&&!f||B==="bottom"&&!j)return}else return;const P=x.points[0];if(wn.has(x.id)){if(x.type==="via"){const B=Math.max(.5,x.size/2)+3;c.strokeStyle="#00bfff",c.lineWidth=2,c.setLineDash([4,3]),c.beginPath(),c.arc(P.x,P.y,B,0,es),c.stroke(),c.setLineDash([])}else if(x.type==="pad"){const B=Math.max(.5,x.size/2)+3;c.strokeStyle="#00bfff",c.lineWidth=2,c.setLineDash([4,3]),c.strokeRect(P.x-B,P.y-B,x.size+6,x.size+6),c.setLineDash([])}else if(x.type==="testPoint"){const B=Math.max(.5,x.size/2)+3;c.strokeStyle="#00bfff",c.lineWidth=2,c.setLineDash([4,3]),c.beginPath(),c.moveTo(P.x,P.y-B),c.lineTo(P.x+B,P.y),c.lineTo(P.x,P.y+B),c.lineTo(P.x-B,P.y),c.closePath(),c.stroke(),c.setLineDash([])}}if(x.type==="via"){const B=Math.max(.5,x.size/2),K=B*.5,ne=B*.7;c.fillStyle=x.color,c.beginPath(),c.arc(P.x,P.y,B,0,es),c.arc(P.x,P.y,K,0,es),c.fill("evenodd"),c.strokeStyle="#808080",c.lineWidth=1,c.beginPath(),c.moveTo(P.x-ne,P.y),c.lineTo(P.x+ne,P.y),c.stroke(),c.beginPath(),c.moveTo(P.x,P.y-ne),c.lineTo(P.x,P.y+ne),c.stroke()}else if(x.type==="pad"){const B=Math.max(.5,x.size/2),K=x.size,ne=K*.5,z=B*.7;c.fillStyle=x.color,c.beginPath(),c.rect(P.x-B,P.y-B,K,K),c.rect(P.x-ne/2,P.y-ne/2,ne,ne),c.fill("evenodd"),c.strokeStyle="#808080",c.lineWidth=1,c.beginPath(),c.moveTo(P.x-z,P.y),c.lineTo(P.x+z,P.y),c.stroke(),c.beginPath(),c.moveTo(P.x,P.y-z),c.lineTo(P.x,P.y+z),c.stroke()}else if(x.type==="testPoint"){const B=Math.max(.5,x.size/2),K=B*.7;c.fillStyle=x.color||"#FFFF00",c.strokeStyle="#000000",c.lineWidth=2,c.beginPath(),c.moveTo(P.x,P.y-B),c.lineTo(P.x+B,P.y),c.lineTo(P.x,P.y+B),c.lineTo(P.x-B,P.y),c.closePath(),c.fill(),c.stroke(),c.strokeStyle="#808080",c.lineWidth=1,c.beginPath(),c.moveTo(P.x-K,P.y),c.lineTo(P.x+K,P.y),c.stroke(),c.beginPath(),c.moveTo(P.x,P.y-K),c.lineTo(P.x,P.y+K),c.stroke()}}),Ke.length>0){const x=At;let P=!0;if(N==="draw"&&(Je==="via"?P=No:P=x==="top"?Ma:Ba),P)if(N==="draw")if(Je==="via"){const B=Ke[Ke.length-1],K=Math.max(.5,F/2),ne=K*.5,z=K*.7;c.fillStyle=G,c.beginPath(),c.arc(B.x,B.y,K,0,es),c.arc(B.x,B.y,ne,0,es),c.fill("evenodd"),c.strokeStyle="#808080",c.lineWidth=1,c.beginPath(),c.moveTo(B.x-z,B.y),c.lineTo(B.x+z,B.y),c.stroke(),c.beginPath(),c.moveTo(B.x,B.y-z),c.lineTo(B.x,B.y+z),c.stroke()}else if(Je==="pad"){const B=Ke[Ke.length-1],K=Math.max(.5,F/2),ne=F,z=ne*.5,Ne=K*.7;c.fillStyle=G,c.beginPath(),c.rect(B.x-K,B.y-K,ne,ne),c.rect(B.x-z/2,B.y-z/2,z,z),c.fill("evenodd"),c.strokeStyle="#808080",c.lineWidth=1,c.beginPath(),c.moveTo(B.x-Ne,B.y),c.lineTo(B.x+Ne,B.y),c.stroke(),c.beginPath(),c.moveTo(B.x,B.y-Ne),c.lineTo(B.x,B.y+Ne),c.stroke()}else if(Je==="testPoint"){const B=Ke[Ke.length-1],K=Math.max(.5,F/2),ne=K*.7;c.fillStyle=G,c.beginPath(),c.moveTo(B.x,B.y-K),c.lineTo(B.x+K,B.y),c.lineTo(B.x,B.y+K),c.lineTo(B.x-K,B.y),c.closePath(),c.fill(),c.strokeStyle="#808080",c.lineWidth=1,c.beginPath(),c.moveTo(B.x-ne,B.y),c.lineTo(B.x+ne,B.y),c.stroke(),c.beginPath(),c.moveTo(B.x,B.y-ne),c.lineTo(B.x,B.y+ne),c.stroke()}else{const B=ui||"top",K=B==="top"?H:Z,ne=B==="top"?we:de;if(Ke.length===1){const z=Ke[0],Ne=Math.max(.5,ne/2);c.fillStyle=K,c.beginPath(),c.arc(z.x,z.y,Ne,0,es),c.fill(),Vt&&(c.strokeStyle=K,c.lineWidth=ne,c.lineCap="round",c.lineJoin="round",c.globalAlpha=.6,c.beginPath(),c.moveTo(z.x,z.y),c.lineTo(Vt.x,Vt.y),c.stroke(),c.globalAlpha=1)}else if(c.strokeStyle=K,c.lineWidth=ne,c.lineCap="round",c.lineJoin="round",c.globalAlpha=1,c.beginPath(),Ke.forEach((z,Ne)=>{Ne===0?c.moveTo(z.x,z.y):c.lineTo(z.x,z.y)}),c.stroke(),Vt&&Ke.length>0){const z=Ke[Ke.length-1];c.globalAlpha=.6,c.beginPath(),c.moveTo(z.x,z.y),c.lineTo(Vt.x,Vt.y),c.stroke(),c.globalAlpha=1}}else N==="erase"&&(c.strokeStyle="rgba(255, 0, 0, 0.5)",c.lineWidth=F,c.lineCap="round",c.lineJoin="round",c.globalAlpha=.5,c.beginPath(),Ke.forEach((B,K)=>{K===0?c.moveTo(B.x,B.y):c.lineTo(B.x,B.y)}),c.stroke())}},[ct,wn,Ma,Ba,No,Bo,Zo,f,j,Ke,N,Je,G,F,At,ui,H,Z,we,de,Vt,Ui]),ad=L.useCallback((c,x)=>{if(Qi){alert("Cannot transform: Images are locked. Unlock images to transform them.");return}c==="top"&&o?s(P=>P?{...P,...x}:null):c==="bottom"&&l?d(P=>P?{...P,...x}:null):c==="both"&&(o&&s(P=>P?{...P,...x}:null),l&&d(P=>P?{...P,...x}:null))},[o,l,Qi]),Sf=L.useCallback(()=>{en&&(ad(en,{x:0,y:0,scale:1,rotation:0,flipX:!1,flipY:!1,skewX:0,skewY:0,keystoneV:0,keystoneH:0,brightness:100,contrast:100}),_(!1))},[ad,en]),Fl=L.useCallback((c=1)=>{if(wn.size>0||Fn.size>0||Ni.size>0||vi.size>0){if(wn.size>0){const x=ct.filter(ne=>wn.has(ne.id)),P=Dr&&x.some(ne=>ne.type==="via"),B=fo&&x.some(ne=>ne.type==="trace"),K=ma&&x.some(ne=>ne.type==="pad");if(P){alert("Cannot change size: Vias are locked. Unlock vias to change their size.");return}if(B){alert("Cannot change size: Traces are locked. Unlock traces to change their size.");return}if(K){alert("Cannot change size: Pads are locked. Unlock pads to change their size.");return}}if(Fn.size>0&&Wi){alert("Cannot change size: Components are locked. Unlock components to change their size.");return}if(Ni.size>0&&$i){alert("Cannot change size: Power nodes are locked. Unlock power nodes to change their size.");return}if(vi.size>0&&vo){alert("Cannot change size: Ground nodes are locked. Unlock ground nodes to change their size.");return}if(ye(x=>x.map(P=>{if(wn.has(P.id)){const B=P.size+c;return P.type==="via"?Lt("via",B):P.type==="pad"?Lt("pad",B):P.type==="trace"&&Lt("trace",B,P.layer),{...P,size:B}}return P})),Fn.size>0){const x=(Fn.size>0&&Qt.find(P=>Fn.has(P.id))?.size||18)+c;Lt("component",x),ri(P=>P.map(B=>Fn.has(B.id)?{...B,size:(B.size||18)+c}:B)),wi(P=>P.map(B=>Fn.has(B.id)?{...B,size:(B.size||18)+c}:B))}if(Ni.size>0){const x=(Re.find(P=>Ni.has(P.id))?.size||18)+c;Lt("power",x),$t(P=>P.map(B=>Ni.has(B.id)?{...B,size:B.size+c}:B))}if(vi.size>0){const x=(Ee.find(P=>vi.has(P.id))?.size||18)+c;Lt("ground",x),sn(P=>P.map(B=>vi.has(B.id)?{...B,size:(B.size||18)+c}:B))}}else{let x=null;if(N==="draw"&&Je==="via"?x="via":N==="draw"&&Je==="pad"?x=ns.current==="bottom"?"padBottom":"padTop":N==="draw"&&Je==="testPoint"?x=xs.current==="bottom"?"testPointBottom":"testPointTop":N==="draw"&&Je==="trace"?x=ts.current==="bottom"?"traceBottom":"traceTop":N==="component"?x=Or.current==="bottom"?"componentBottom":"componentTop":N==="power"?x="power":N==="ground"&&(x="ground"),x){const P=On.get(x),B=Math.min(40,P.size+c);On.setSize(x,B)}}},[wn,Fn,Ni,vi,ct,Dr,fo,ma,na,Wi,$i,vo,N,Je,Lt]),sd=L.useCallback((c=1)=>{if(wn.size>0||Fn.size>0||Ni.size>0||vi.size>0){if(wn.size>0){const x=ct.filter(z=>wn.has(z.id)),P=Dr&&x.some(z=>z.type==="via"),B=fo&&x.some(z=>z.type==="trace"),K=ma&&x.some(z=>z.type==="pad"),ne=na&&x.some(z=>z.type==="testPoint");if(P){alert("Cannot change size: Vias are locked. Unlock vias to change their size.");return}if(B){alert("Cannot change size: Traces are locked. Unlock traces to change their size.");return}if(K){alert("Cannot change size: Pads are locked. Unlock pads to change their size.");return}if(ne){alert("Cannot change size: Test Points are locked. Unlock test points to change their size.");return}}if(Fn.size>0&&Wi){alert("Cannot change size: Components are locked. Unlock components to change their size.");return}if(Ni.size>0&&$i){alert("Cannot change size: Power nodes are locked. Unlock power nodes to change their size.");return}if(vi.size>0&&vo){alert("Cannot change size: Ground nodes are locked. Unlock ground nodes to change their size.");return}if(ye(x=>x.map(P=>{if(wn.has(P.id)){const B=Math.max(1,P.size-c);return P.type==="via"?Lt("via",B):P.type==="pad"?Lt("pad",B,P.layer):P.type==="testPoint"?Lt("testPoint",B,P.layer):P.type==="trace"&&Lt("trace",B,P.layer),{...P,size:B}}return P})),Fn.size>0){const x=Math.max(12,(Fn.size>0&&Qt.find(P=>Fn.has(P.id))?.size||18)-c);Lt("component",x),ri(P=>P.map(B=>Fn.has(B.id)?{...B,size:Math.max(12,(B.size||18)-c)}:B)),wi(P=>P.map(B=>Fn.has(B.id)?{...B,size:Math.max(12,(B.size||18)-c)}:B))}if(Ni.size>0){const x=Math.max(12,(Re.find(P=>Ni.has(P.id))?.size||18)-c);Lt("power",x),$t(P=>P.map(B=>Ni.has(B.id)?{...B,size:Math.max(12,B.size-c)}:B))}if(vi.size>0){const x=Math.max(12,(Ee.find(P=>vi.has(P.id))?.size||18)-c);Lt("ground",x),sn(P=>P.map(B=>vi.has(B.id)?{...B,size:Math.max(12,(B.size||18)-c)}:B))}}else{let x=null;if(N==="draw"&&Je==="via"?x="via":N==="draw"&&Je==="pad"?x=(At||Hn||"top")==="bottom"?"padBottom":"padTop":N==="draw"&&Je==="testPoint"?x=(At||di||"top")==="bottom"?"testPointBottom":"testPointTop":N==="draw"&&Je==="trace"?x=(At||ui||"top")==="bottom"?"traceBottom":"traceTop":N==="component"?x=(At||Ri||"top")==="bottom"?"componentBottom":"componentTop":N==="power"?x="power":N==="ground"&&(x="ground"),x){const P=On.get(x),B=Math.max(1,P.size-c);On.setSize(x,B)}}},[wn,Fn,Ni,vi,ct,Dr,fo,ma,na,Wi,$i,vo,N,Je,At,Hn,di,ui,Ri,Lt]),_h=L.useCallback(()=>{const c=Ia.size;if(wn.size>0||Fn.size>0||Ni.size>0||vi.size>0){if(wn.size>0){const x=ct.filter(z=>wn.has(z.id)),P=Dr&&x.some(z=>z.type==="via"),B=ma&&x.some(z=>z.type==="pad"),K=fo&&x.some(z=>z.type==="trace"),ne=na&&x.some(z=>z.type==="testPoint");if(P||B||K||ne){alert("Cannot change size: selected items are locked.");return}}if(Fn.size>0&&Wi){alert("Cannot change size: selected components are locked.");return}if(Ni.size>0&&$i){alert("Cannot change size: selected power nodes are locked.");return}if(vi.size>0&&vo){alert("Cannot change size: selected ground nodes are locked.");return}ye(x=>x.map(P=>wn.has(P.id)?(P.type==="via"?(Lt("via",c),gr(B=>{const K=new Map(B),ne=K.get("via");return ne&&K.set("via",{...ne,settings:{...ne.settings,size:c}}),K})):P.type==="pad"?(Lt("pad",c,P.layer),gr(B=>{const K=new Map(B),ne=K.get("pad");if(ne){const z=new Map(ne.layerSettings);z.set(P.layer,{...z.get(P.layer)||{color:ne.settings.color,size:c},size:c}),K.set("pad",{...ne,layerSettings:z})}return K})):P.type==="testPoint"?(Lt("testPoint",c,P.layer),gr(B=>{const K=new Map(B),ne=K.get("testPoint");if(ne){const z=new Map(ne.layerSettings);z.set(P.layer,{...z.get(P.layer)||{color:ne.settings.color,size:c},size:c}),K.set("testPoint",{...ne,layerSettings:z})}return K})):P.type==="trace"&&Lt("trace",c,P.layer),{...P,size:c}):P)),Fn.size>0&&(Lt("component",c),ri(x=>x.map(P=>Fn.has(P.id)?{...P,size:c}:P)),wi(x=>x.map(P=>Fn.has(P.id)?{...P,size:c}:P))),Ni.size>0&&(Lt("power",c),$t(x=>x.map(P=>Ni.has(P.id)?{...P,size:c}:P))),vi.size>0&&(Lt("ground",c),sn(x=>x.map(P=>vi.has(P.id)?{...P,size:c}:P)))}else $(c),N==="draw"&&Je==="trace"?At==="top"?(te(c),Lt("trace",c,"top")):(je(c),Lt("trace",c,"bottom")):N==="draw"&&Je==="via"?Lt("via",c):N==="draw"&&Je==="pad"?Lt("pad",c,At):N==="draw"&&Je==="testPoint"?Lt("testPoint",c,At):Lt(N==="component"?"component":N==="power"?"power":N==="ground"?"ground":"brush",c);as({visible:!1,size:6})},[Ia.size,wn,Fn,Ni,vi,ct,Dr,fo,Wi,$i,vo,N,Je,At,Lt,fi,gr]),Tp=L.useCallback(()=>{po({visible:!1,source:null,interval:5})},[]),Ul=L.useCallback(async(c,x=!1)=>{await Zd(c,no,oi,ho,Ro,To,to,dr,io,ki,Ti,Do,po,Rr,ds,x)},[no,oi,ho,Ro,To,to,dr,io,ki,Ti,Do,po,Rr,ds]),du=L.useCallback(()=>{Ut(),g("select")},[Ut]),Bd=L.useCallback(c=>{if(c.key==="Escape"){const z=document.activeElement;if(z&&(z.tagName==="INPUT"&&z.type==="checkbox"||z.tagName==="INPUT"&&z.type==="radio")){z.blur(),c.preventDefault(),c.stopPropagation();return}}const x=document.activeElement;if(x&&(x.tagName==="INPUT"&&x.type!=="checkbox"&&x.type!=="radio"||x.tagName==="TEXTAREA"||x.isContentEditable))return;const P=us.current>0;if(P&&c.key!=="m"&&c.key!=="M")return;const B=parseInt(c.key);if(!isNaN(B)&&B>=0&&B<=9){if(c.preventDefault(),c.stopPropagation(),N==="center"&&Xu){if(En.current&&(clearTimeout(En.current),En.current=null),Tt.current){let ve=0,Le=0;o?(ve=o.x,Le=o.y):l&&(ve=l.x,Le=l.y),Ns(Me=>({...Me,[B]:{pcbReferenceX:ve,pcbReferenceY:Le,x:0,y:0,zoom:wt,viewRotation:mn,viewFlipX:Dt,isBottomView:Wa,transparency:v,showTopImage:As,showBottomImage:Xa,showViasLayer:No,showTopTracesLayer:Ma,showBottomTracesLayer:Ba,showTopPadsLayer:Bo,showBottomPadsLayer:Zo,showTopTestPointsLayer:f,showBottomTestPointsLayer:j,showTopComponents:X,showBottomComponents:oe,showPowerLayer:pe,showGroundLayer:nr,showConnectionsLayer:yi}}))}fr(!1),g("select"),ji(void 0);return}const z=Pl[B];if(z){Wn(z.zoom),Ot(z.viewRotation??0),an(z.viewFlipX??!1),sr(z.isBottomView??!1),m(z.transparency??50);const Ne=z.pcbReferenceX??z.x??0,ve=z.pcbReferenceY??z.y??0;let Le=0,Me=0;o?(Le=o.x,Me=o.y):l&&(Le=l.x,Me=l.y);const Ae=Ne-Le,he=ve-Me;(Math.abs(Ae)>.001||Math.abs(he)>.001)&&(o&&s({...o,x:o.x+Ae,y:o.y+he}),l&&d({...l,x:l.x+Ae,y:l.y+he}),ri(Qt.map(me=>({...me,x:me.x+Ae,y:me.y+he}))),wi(tn.map(me=>({...me,x:me.x+Ae,y:me.y+he}))),$t(mt.map(me=>({...me,x:me.x+Ae,y:me.y+he}))),sn(Kt.map(me=>({...me,x:me.x+Ae,y:me.y+he}))),ye(ct.map(me=>({...me,points:me.points.map(Se=>({...Se,x:Se.x+Ae,y:Se.y+he}))}))),ea(za.map(me=>({...me,x:me.x+Ae,y:me.y+he}))),xr(Jr.map(me=>({...me,x:me.x+Ae,y:me.y+he})))),bn({x:0,y:0}),Yr(z.showTopImage),jo(z.showBottomImage),Ka(z.showViasLayer),fs(z.showTopTracesLayer),Li(z.showBottomTracesLayer),ua(z.showTopPadsLayer),ja(z.showBottomPadsLayer),y(z.showTopTestPointsLayer),I(z.showBottomTestPointsLayer),ie(z.showTopComponents),ce(z.showBottomComponents),Te(z.showPowerLayer),Si(z.showGroundLayer),Xi(z.showConnectionsLayer)}return}if(c.key==="+"||c.key==="="){c.preventDefault(),c.stopPropagation(),Fl(c.shiftKey?5:1);return}if(c.key==="-"||c.key==="_"){c.preventDefault(),c.stopPropagation(),sd(c.shiftKey?5:1);return}const K=c.shiftKey||c.getModifierState("CapsLock"),ne=N==="transform"&&en;if(c.key==="ArrowUp"||c.key==="ArrowDown"||c.key==="ArrowLeft"||c.key==="ArrowRight"){if(Fn.size>0){c.preventDefault(),c.stopPropagation();const z=c.shiftKey?10:1;let Ne=0,ve=0;c.key==="ArrowUp"?ve=-z:c.key==="ArrowDown"?ve=z:c.key==="ArrowLeft"?Ne=-z:c.key==="ArrowRight"&&(Ne=z);for(const Le of Fn){const Me=Qt.find(Ae=>Ae.id===Le);if(Me){const Ae=Me.x+Ne,he=Me.y+ve,me=ur({x:Ae,y:he});ri(Se=>Se.map(Pe=>Pe.id===Le?{...Pe,x:me.x,y:me.y}:Pe))}else{const Ae=tn.find(he=>he.id===Le);if(Ae){const he=Ae.x+Ne,me=Ae.y+ve,Se=ur({x:he,y:me});wi(Pe=>Pe.map(Oe=>Oe.id===Le?{...Oe,x:Se.x,y:Se.y}:Oe))}}}return}if(K&&!ne&&Fn.size===0){if(c.key==="ArrowUp"||c.key==="ArrowDown"){c.preventDefault(),c.stopPropagation();const z=c.key==="ArrowUp"?-90:90;ff(z);return}else if(c.key==="ArrowLeft"||c.key==="ArrowRight"){c.preventDefault(),c.stopPropagation(),kd();return}}}if((c.key==="I"||c.key==="i")&&!c.ctrlKey&&!c.shiftKey&&!c.altKey){const z=document.activeElement;if(!!z&&(z.tagName==="INPUT"&&z.type!=="range"&&z.type!=="checkbox"&&z.type!=="radio"||z.tagName==="TEXTAREA"||z.isContentEditable))return;c.preventDefault(),c.stopPropagation();const ve=[];wn.size>0,wn.size===0&&Fn.size===0&&Ni.size===0&&vi.size===0&&ve.push(`
No objects selected.`);const Le=ve.join(`
`);console.log(Le),Wr({visible:!0,text:Le});return}if((c.key==="N"||c.key==="n")&&!c.ctrlKey&&!c.shiftKey&&!c.altKey){const z=document.activeElement;if(!!z&&(z.tagName==="INPUT"&&z.type!=="range"&&z.type!=="checkbox"&&z.type!=="radio"||z.tagName==="TEXTAREA"||z.isContentEditable))return;c.preventDefault(),c.stopPropagation(),yo(!0);return}if((c.key==="L"||c.key==="l")&&!c.ctrlKey&&!c.shiftKey&&!c.altKey){const z=document.activeElement;if(!!z&&(z.tagName==="INPUT"&&z.type!=="range"&&z.type!=="checkbox"&&z.type!=="radio"||z.tagName==="TEXTAREA"||z.isContentEditable))return;c.preventDefault(),c.stopPropagation(),gl(!0);return}if((c.key==="E"||c.key==="e")&&!c.ctrlKey&&!c.shiftKey&&!c.altKey){const z=document.activeElement;if(!!z&&(z.tagName==="INPUT"&&z.type!=="range"&&z.type!=="checkbox"&&z.type!=="radio"||z.tagName==="TEXTAREA"||z.isContentEditable))return;c.preventDefault(),c.stopPropagation(),us.current<=0&&Ko(!0);return}if(c.key==="O"||c.key==="o"){const z=document.activeElement;if(!!z&&(z.tagName==="INPUT"&&z.type!=="range"&&z.type!=="checkbox"&&z.type!=="radio"||z.tagName==="TEXTAREA"||z.isContentEditable))return;c.preventDefault(),c.stopPropagation();const ve=Pl[0];if(ve){Wn(ve.zoom),Ot(ve.viewRotation??0),an(ve.viewFlipX??!1),sr(ve.isBottomView??!1),m(ve.transparency??50);const Le=ve.pcbReferenceX??ve.x??0,Me=ve.pcbReferenceY??ve.y??0;let Ae=0,he=0;o?(Ae=o.x,he=o.y):l&&(Ae=l.x,he=l.y);const me=Le-Ae,Se=Me-he;(Math.abs(me)>.001||Math.abs(Se)>.001)&&(o&&s({...o,x:o.x+me,y:o.y+Se}),l&&d({...l,x:l.x+me,y:l.y+Se}),ri(Qt.map(Pe=>({...Pe,x:Pe.x+me,y:Pe.y+Se}))),wi(tn.map(Pe=>({...Pe,x:Pe.x+me,y:Pe.y+Se}))),$t(mt.map(Pe=>({...Pe,x:Pe.x+me,y:Pe.y+Se}))),sn(Kt.map(Pe=>({...Pe,x:Pe.x+me,y:Pe.y+Se}))),ye(ct.map(Pe=>({...Pe,points:Pe.points.map(Oe=>({...Oe,x:Oe.x+me,y:Oe.y+Se}))}))),ea(za.map(Pe=>({...Pe,x:Pe.x+me,y:Pe.y+Se}))),xr(Jr.map(Pe=>({...Pe,x:Pe.x+me,y:Pe.y+Se})))),Yr(ve.showTopImage),jo(ve.showBottomImage),Ka(ve.showViasLayer),fs(ve.showTopTracesLayer),Li(ve.showBottomTracesLayer),ua(ve.showTopPadsLayer),ja(ve.showBottomPadsLayer),y(ve.showTopTestPointsLayer),I(ve.showBottomTestPointsLayer),ie(ve.showTopComponents),ce(ve.showBottomComponents),Te(ve.showPowerLayer),Si(ve.showGroundLayer),Xi(ve.showConnectionsLayer)}else Wn(1),Ot(0),an(!1),sr(!1),m(0);bn({x:0,y:0}),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),p("overlay"),Cn(new Set),yn(new Set),pn(new Set),jn(new Set),g("select");return}if((c.key==="Alt"||c.altKey)&&(id(!0),oo(!0)),c.key==="Escape"){c.preventDefault(),c.stopPropagation(),du(),Ll(!1),ju(!1),Cc(!1),Tn(!1),va(!1),bp(null);return}if(c.key==="Enter"&&N==="draw"&&Je==="trace"){Pu();return}if((c.key==="Delete"||c.key==="Backspace")&&(wn.size>0||Fn.size>0||Ni.size>0||vi.size>0)){if(c.preventDefault(),c.stopPropagation(),Bi(ct,Qt,tn,mt,Kt),wn.size>0){const z=ct.filter(Ae=>wn.has(Ae.id)),Ne=Dr&&z.some(Ae=>Ae.type==="via"),ve=fo&&z.some(Ae=>Ae.type==="trace"),Le=ma&&z.some(Ae=>Ae.type==="pad"),Me=na&&z.some(Ae=>Ae.type==="testPoint");Ne?alert("Cannot delete: Vias are locked. Unlock vias to delete them."):ve?alert("Cannot delete: Traces are locked. Unlock traces to delete them."):Le?alert("Cannot delete: Pads are locked. Unlock pads to delete them."):Me?alert("Cannot delete: Test points are locked. Unlock test points to delete them."):(ye(Ae=>Ae.filter(he=>!wn.has(he.id))),Cn(new Set))}Fn.size>0&&(Wi?alert("Cannot delete: Components are locked. Unlock components to delete them."):(ri(z=>z.filter(Ne=>!Fn.has(Ne.id))),wi(z=>z.filter(Ne=>!Fn.has(Ne.id))),yn(new Set))),Ni.size>0&&($i?alert("Cannot delete: Power nodes are locked. Unlock power nodes to delete them."):($t(z=>z.filter(Ne=>!Ni.has(Ne.id))),pn(new Set))),vi.size>0&&(vo?alert("Cannot delete: Ground nodes are locked. Unlock ground nodes to delete them."):(sn(z=>z.filter(Ne=>!vi.has(Ne.id))),jn(new Set)));return}if((c.key==="z"||c.key==="Z")&&(c.ctrlKey||c.metaKey)&&!c.shiftKey&&!c.altKey){const z=document.activeElement;if(!!z&&(z.tagName==="INPUT"&&z.type!=="range"&&z.type!=="checkbox"&&z.type!=="radio"||z.tagName==="TEXTAREA"||z.isContentEditable))return;c.preventDefault(),c.stopPropagation();const ve=kr();if(ve){const Le=new Set(ve.drawingStrokes.map(me=>me.id));for(const me of ct)if(!Le.has(me.id))for(const Se of me.points)Se.id&&typeof Se.id=="number"&&Zp(Se.id);const Me=new Set([...ve.componentsTop.map(me=>me.id),...ve.componentsBottom.map(me=>me.id)]);for(const me of[...Qt,...tn])if(!Me.has(me.id)){for(const Se of me.pinConnections)if(Se&&Se.trim()!==""){const Pe=parseInt(Se,10);!isNaN(Pe)&&Pe>0&&Zp(Pe)}}const Ae=new Set(ve.powerSymbols.map(me=>me.id));for(const me of mt)!Ae.has(me.id)&&me.pointId&&typeof me.pointId=="number"&&Zp(me.pointId);const he=new Set(ve.groundSymbols.map(me=>me.id));for(const me of Kt)!he.has(me.id)&&me.pointId&&typeof me.pointId=="number"&&Zp(me.pointId);ye(ve.drawingStrokes),ri(ve.componentsTop),wi(ve.componentsBottom),$t(ve.powerSymbols),sn(ve.groundSymbols),vt([])}return}if((c.key==="c"||c.key==="C")&&(c.ctrlKey||c.metaKey)&&!c.shiftKey&&!c.altKey){const z=document.activeElement;if(!!z&&(z.tagName==="INPUT"&&z.type!=="range"&&z.type!=="checkbox"&&z.type!=="radio"||z.tagName==="TEXTAREA"||z.isContentEditable))return;if(Fn.size===1){c.preventDefault(),c.stopPropagation();const ve=Array.from(Fn)[0],Le=[...Qt,...tn].find(Me=>Me.id===ve);Le&&(nd(Le),console.log("Component copied:",Le.id,Le.designator))}return}if((c.key==="v"||c.key==="V")&&(c.ctrlKey||c.metaKey)&&!c.shiftKey&&!c.altKey){const z=document.activeElement;if(!!z&&(z.tagName==="INPUT"&&z.type!=="range"&&z.type!=="checkbox"&&z.type!=="radio"||z.tagName==="TEXTAREA"||z.isContentEditable))return;if(Fs&&!Wi){c.preventDefault(),c.stopPropagation();const ve=[...Qt,...tn];let Le;Pr?Le=Yf():Le={...ai.current};let Me;if(Fs.designator){const Se=Fs.designator.match(/^([A-Za-z]+)(\d+)$/);Se?Me=Se[1]:Me=mg(Fs.componentType)}else Me=mg(Fs.componentType);const Ae=R2(Me,ve,Le),he=`${Me}${Ae}`;if(Pr){const Se=Yf();P1(Me,Ae,Se)}else ai.current[Me]=Math.max(ai.current[Me]||0,Ae);const me={...Fs,id:ix("comp"),designator:he,pinConnections:new Array(Fs.pinCount).fill(""),pinPolarities:Fs.pinPolarities?new Array(Fs.pinCount).fill(""):void 0,x:Fs.x+5,y:Fs.y+5};Fs.pinNames&&(me.pinNames=[...Fs.pinNames]),me.layer==="top"?ri(Se=>[...Se,me]):wi(Se=>[...Se,me]),Ut(),yn(new Set([me.id])),console.log("Component pasted:",me.id,me.designator)}return}if(c.code==="KeyV"&&c.altKey&&!c.ctrlKey&&!c.shiftKey&&!P){const z=document.activeElement;if(!!z&&(z.tagName==="INPUT"&&z.type!=="range"&&z.type!=="checkbox"&&z.type!=="radio"||z.tagName==="TEXTAREA"||z.isContentEditable))return;c.preventDefault(),c.stopPropagation(),sc(!1),xl(!0);return}if(c.code==="KeyP"&&c.altKey&&!c.ctrlKey&&!c.shiftKey&&!P){const z=document.activeElement;if(!!z&&(z.tagName==="INPUT"&&z.type!=="range"&&z.type!=="checkbox"&&z.type!=="radio"||z.tagName==="TEXTAREA"||z.isContentEditable))return;c.preventDefault(),c.stopPropagation(),sc(!0),xl(!0);return}if((c.key==="a"||c.key==="A")&&!c.ctrlKey&&!c.altKey&&!c.shiftKey&&!P){const z=document.activeElement;if(!!z&&(z.tagName==="INPUT"&&z.type!=="range"&&z.type!=="checkbox"&&z.type!=="radio"||z.tagName==="TEXTAREA"||z.isContentEditable))return;if(Fn.size>0){c.preventDefault(),c.stopPropagation();const ve=Array.from(Fn),Le=ve[ve.length-1];let Me=null,Ae=null;Me=Qt.find(he=>he.id===Le)||null,Me?Ae="top":(Me=tn.find(he=>he.id===Le)||null,Me&&(Ae="bottom")),Me&&Ae&&T(Me,Ae)}return}if(!c.ctrlKey&&!c.altKey){const z=document.activeElement;if(!(!!z&&(z.tagName==="INPUT"&&z.type!=="range"&&z.type!=="checkbox"&&z.type!=="radio"||z.tagName==="TEXTAREA"||z.isContentEditable)))switch(c.key){case"s":case"S":c.preventDefault(),Ut(),du();return;case"b":case"B":c.preventDefault(),Ut(),fe.length===1?(pi(fe[0].id),g("power"),Tn(!1),Te(!0)):fe.length>1?Tn(!0):(Tn(!0),g("power"),Te(!0));return;case"g":case"G":c.preventDefault(),Ut(),Ve.length===1?(Yi(Ve[0].id),g("ground"),Pi(!1),Si(!0)):Ve.length>1?Pi(!0):(Pi(!0),g("ground"),Si(!0));return;case"v":case"V":c.preventDefault(),Ut(),Ft("via"),g("draw"),Ka(!0);return;case"p":case"P":c.preventDefault(),Ut(),Ft("pad"),g("draw");return;case"y":case"Y":c.preventDefault(),Ut(),Ft("testPoint"),g("draw");return;case"t":case"T":c.preventDefault(),Ut(),Ft("trace"),g("draw");return;case"c":case"C":c.preventDefault(),Ut(),g("component"),Dd.current?jc(Dd.current):jc(null);return;case"e":case"E":c.preventDefault(),Ut(),g("erase");return;case"h":case"H":c.preventDefault(),Ut(),g("pan");return;case"x":case"X":c.preventDefault(),Ut(),g("center"),fr(!0),En.current&&clearTimeout(En.current),En.current=setTimeout(()=>{fr(!1),g("select"),ji(void 0)},2e3);return;case"m":case"M":if(!c.ctrlKey){c.preventDefault(),Ut(),ru(!1),g("magnify");return}break}}if(N==="transform"&&en){if(!(c.key==="ArrowLeft"||c.key==="ArrowRight"||c.key==="ArrowUp"||c.key==="ArrowDown"))return;c.preventDefault(),c.stopPropagation();const Ne=document.activeElement;if(Ne&&Ne.tagName==="INPUT"){const ve=Ne;ve.type==="radio"&&ve.blur()}if(Qi)return;if(Cr==="nudge"){let ve=0,Le=0;switch(c.key){case"ArrowLeft":ve=-1;break;case"ArrowRight":ve=1;break;case"ArrowUp":Le=-1;break;case"ArrowDown":Le=1;break;default:return}en==="top"&&o?s(Me=>Me?{...Me,x:Me.x+ve,y:Me.y+Le}:null):en==="bottom"&&l?d(Me=>Me?{...Me,x:Me.x+ve,y:Me.y+Le}:null):en==="both"&&(o&&s(Me=>Me?{...Me,x:Me.x+ve,y:Me.y+Le}:null),l&&d(Me=>Me?{...Me,x:Me.x+ve,y:Me.y+Le}:null))}else if(Cr==="scale"){let ve=0;switch(c.key){case"ArrowUp":ve=.01;break;case"ArrowDown":ve=-.01;break;case"ArrowRight":ve=.001;break;case"ArrowLeft":ve=-.001;break;default:return}if(en==="top"){o&&s(Le=>Le?{...Le,scale:Math.max(.1,Math.min(3,Le.scale+ve))}:null);return}if(en==="bottom"){l&&d(Le=>Le?{...Le,scale:Math.max(.1,Math.min(3,Le.scale+ve))}:null);return}if(en==="both"){o&&s(Le=>Le?{...Le,scale:Math.max(.1,Math.min(3,Le.scale+ve))}:null),l&&d(Le=>Le?{...Le,scale:Math.max(.1,Math.min(3,Le.scale+ve))}:null);return}}else if(Cr==="rotate"){let ve=0;switch(c.key){case"ArrowUp":ve=1;break;case"ArrowDown":ve=-1;break;case"ArrowRight":ve=.1;break;case"ArrowLeft":ve=-.1;break;default:return}if(en==="top"){o&&s(Le=>Le?{...Le,rotation:Le.rotation+ve}:null);return}if(en==="bottom"){l&&d(Le=>Le?{...Le,rotation:Le.rotation+ve}:null);return}if(en==="both"){o&&s(Le=>Le?{...Le,rotation:Le.rotation+ve}:null),l&&d(Le=>Le?{...Le,rotation:Le.rotation+ve}:null);return}}else if(Cr==="slant"){let ve=0,Le=0;switch(c.key){case"ArrowUp":Le=-.5;break;case"ArrowDown":Le=.5;break;case"ArrowLeft":ve=-.5;break;case"ArrowRight":ve=.5;break}if(ve!==0||Le!==0){const Me=mu,Ae=he=>Math.max(-.7,Math.min(.7,he));if(en==="top"){o&&s(he=>he?{...he,skewX:Ae((he.skewX||0)+Me(ve)),skewY:Ae((he.skewY||0)+Me(Le))}:null);return}if(en==="bottom"){l&&d(he=>he?{...he,skewX:Ae((he.skewX||0)+Me(ve)),skewY:Ae((he.skewY||0)+Me(Le))}:null);return}if(en==="both"){o&&s(he=>he?{...he,skewX:Ae((he.skewX||0)+Me(ve)),skewY:Ae((he.skewY||0)+Me(Le))}:null),l&&d(he=>he?{...he,skewX:Ae((he.skewX||0)+Me(ve)),skewY:Ae((he.skewY||0)+Me(Le))}:null);return}}}else if(Cr==="keystone"){let ve=0,Le=0;switch(c.key){case"ArrowUp":Le=-.5;break;case"ArrowDown":Le=.5;break;case"ArrowLeft":ve=-.5;break;case"ArrowRight":ve=.5;break}if(ve!==0||Le!==0){const Me=mu,Ae=he=>Math.max(-.35,Math.min(.35,he));if(en==="top"){o&&s(he=>he?{...he,keystoneH:Ae((he.keystoneH||0)+Me(ve)),keystoneV:Ae((he.keystoneV||0)+Me(Le))}:null);return}if(en==="bottom"){l&&d(he=>he?{...he,keystoneH:Ae((he.keystoneH||0)+Me(ve)),keystoneV:Ae((he.keystoneV||0)+Me(Le))}:null);return}if(en==="both"){o&&s(he=>he?{...he,keystoneH:Ae((he.keystoneH||0)+Me(ve)),keystoneV:Ae((he.keystoneV||0)+Me(Le))}:null),l&&d(he=>he?{...he,keystoneH:Ae((he.keystoneH||0)+Me(ve)),keystoneV:Ae((he.keystoneV||0)+Me(Le))}:null);return}}}}else{const z=c.target;if(z.tagName==="INPUT"&&z.type==="range"){const Ne=z,ve=Number(Ne.value),Le=Number(Ne.min),Me=Number(Ne.max),Ae=Number(Ne.step)||1;switch(c.key){case"ArrowLeft":c.preventDefault();const he=Math.max(Le,ve-Ae);Ne.value=he.toString(),Ne.dispatchEvent(new Event("input",{bubbles:!0}));break;case"ArrowRight":c.preventDefault();const me=Math.min(Me,ve+Ae);Ne.value=me.toString(),Ne.dispatchEvent(new Event("input",{bubbles:!0}));break}}}},[N,en,Cr,o,l,wn,Fn,Ni,vi,ct,Qt,tn,Re,Ee,fe,Je,Pu,ui,H,Z,we,de,du,ri,wi,kr,ye,$t,sn,mt,Kt,kd,ff,Pl,wt,mn,Dt,Wa,v,Wn,Ot,an,sr,m,s,d,ea,xr,bn,p,Cn,yn,pn,jn,g,za,Jr,As,Xa,No,Ma,Ba,Bo,Zo,f,j,X,oe,pe,nr,yi,Yr,jo,Ka,fs,Li,ua,ja,y,I,ie,ce,Te,Si,Xi,sc,xl,T]);Pt.useEffect(()=>{N!=="transform"&&zi(null)},[N]),Pt.useEffect(()=>{window.addEventListener("keydown",Bd,!0);const c=x=>{x.key==="Alt"&&(id(!1),oo(!1),Ta(null))};return window.addEventListener("keyup",c,!0),()=>{window.removeEventListener("keydown",Bd,!0),window.removeEventListener("keyup",c,!0)}},[Bd,Ni,vi,$i,$i,Re,Ee,Fl,sd,du,Fn,Qt,tn,ri,wi,Pl,Xu,N]);const fc=L.useCallback(()=>{ai.current={},R("#AA4499"),Y("#F781BF"),te(6),je(6),Wt("trace","#AA4499","top"),Wt("trace","#F781BF","bottom"),Lt("trace",6,"top"),Lt("trace",6,"bottom"),xe("#0072B2"),A("#56B4E9"),W(18),Ce(18),Wt("pad","#0072B2","top"),Wt("pad","#56B4E9","bottom"),Lt("pad",18,"top"),Lt("pad",18,"bottom"),lt("#6A3D9A"),Gt("#9467BD"),hn(18),gn(18),Wt("component","#6A3D9A","top"),Wt("component","#9467BD","bottom"),Lt("component",18,"top"),Lt("component",18,"bottom"),zo("top"),ee("#AA4499"),$(6),Be([{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),gt([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),Lt("power",18),Lt("ground",18),ya(!1),xa(!1),ba(!1),Ra(!1),os(!1),eo(!1),Jt("top"),g("select"),m(50),D(!1),p("overlay"),Jf(),Ar()},[Wt,Lt,Ar]),ld=L.useCallback(()=>{Rr(null),To(null),er(""),Lo(""),ho(!1),Ro(null),to(""),Ya([]),$r(-1),wo(!1),sr(!1),lr(null),cs(null),ki.current&&(clearInterval(ki.current),ki.current=null),s(null),d(null),Ar(),ye([]),ea([]),xr([]),Ua([]),Pn([]),vt([]),An.current=[],ri([]),wi([]),qa(null),_a(null),$t([]),sn([]),li(null),Be([{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),gt([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),Cn(new Set),yn(new Set),pn(new Set),jn(new Set),Yo(!1),hl([]),Za({productName:"",productVersion:"",manufacturer:"",date:new Date().toISOString().split("T")[0]}),p("overlay"),Wn(1),_i(0,0),Br(!0),Jt("top"),Ns({}),fr(!1),En.current&&(clearTimeout(En.current),En.current=null),zi(null),qt(!1),Ji(null),jr("nudge"),_(!1),m(50),D(!1),S(2e3),ya(!1),xa(!1),Ss(!1),Da(!1),ba(!1),Ra(!1),os(!1),eo(!1),Yr(!0),jo(!0),Ka(!0),fs(!0),Li(!0),ua(!0),ja(!0),y(!0),I(!0),ie(!0),ce(!0),Te(!0),Si(!0),Xi(!0),Er(!0),g("select"),Ft("trace"),zo("top"),ys("top"),Wo("top"),Ds("top"),ts.current="top",ns.current="top",xs.current="top",Or.current="top",ai.current={},ao(!0),ii(!1),Jf(),On.initialize(),Rs(null),Wr({visible:!1,text:""}),ia({visible:!1,title:"",message:""}),Ha({visible:!1}),Jl({visible:!1}),Ts({visible:!1,projectName:"",locationPath:"",locationHandle:null}),ra({visible:!1,filename:"",locationPath:"",locationHandle:null}),Do({visible:!1,interval:null}),po({visible:!1,source:"new",interval:5}),va(!1),He(!1),cr(!1),mr(!1),Os(!1),yo(!1),gl(!1),el(!1),Ko(!1),Bs(null),Ta(null),Ca(null),Ga(!1),Co.current=null,Mo.current=null,Nt(!1),ht(null),dn.current=0,ti.current=!1,console.log("Project closed: All state cleared and browser permissions released")},[]);L.useCallback(()=>{Rr(null),To(null),aa&&(aa.current=null),dr&&(dr.current=null),er(""),Lo(""),ho(!1),Ro(null),to(""),Ya([]),$r(-1),io&&(io.current=""),Ti.current=!1,wo(!1),sr(!1),lr(null),cs(null),ki.current&&(clearInterval(ki.current),ki.current=null),s(null),d(null),Ar(),ye([]),ea([]),xr([]),Ua([]),Pn([]),vt([]),An.current=[],ri([]),wi([]),qa(null),_a(null),$t([]),sn([]),li(null),Be([{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),gt([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),Cn(new Set),yn(new Set),pn(new Set),jn(new Set),Yo(!1),hl([]),Za({productName:"",productVersion:"",manufacturer:"",date:new Date().toISOString().split("T")[0]}),p("overlay"),Wn(1),_i(0,0),Br(!0),Jt("top"),Ns({}),fr(!1),En.current&&(clearTimeout(En.current),En.current=null),zi(null),qt(!1),Ji(null),jr("nudge"),_(!1),m(50),D(!1),S(2e3),ya(!1),xa(!1),Ss(!1),Da(!1),ba(!1),Ra(!1),os(!1),eo(!1),Yr(!0),jo(!0),Ka(!0),fs(!0),Li(!0),ua(!0),ja(!0),y(!0),I(!0),ie(!0),ce(!0),Te(!0),Si(!0),Xi(!0),Er(!0),g("select"),Ft("trace"),zo("top"),ys("top"),Wo("top"),Ds("top"),ts.current="top",ns.current="top",xs.current="top",Or.current="top",ai.current={},ao(!0),ii(!1),Jf(),On.initialize(),Rs(null),Wr({visible:!1,text:""}),ia({visible:!1,title:"",message:""}),Ha({visible:!1}),Jl({visible:!1}),Ts({visible:!1,projectName:"",locationPath:"",locationHandle:null}),ra({visible:!1,filename:"",locationPath:"",locationHandle:null}),Do({visible:!1,interval:null}),po({visible:!1,source:"new",interval:5}),va(!1),He(!1),cr(!1),mr(!1),Os(!1),yo(!1),gl(!1),el(!1),Bs(null),Ta(null),Ca(null),Ga(!1),Co.current=null,Mo.current=null,Nt(!1),ht(null),dn.current=0,ti.current=!1,console.log("Project closed: All state cleared and browser permissions released")},[Rr,To,er,Lo,ho,Ro,to,Ya,$r,s,d,ye,vt,ea,xr,Ua,Pn,ri,wi,qa,_a,$t,sn,li,Be,gt,Cn,yn,pn,jn,Yo,hl,p,Wn,Ea,Br,Jt,Ns,fr,zi,qt,Ji,jr,_,m,D,S,ya,xa,Ss,Da,ba,Ra,os,eo,Yr,jo,Ka,fs,Li,ua,ja,y,I,ie,ce,Te,Si,Xi,g,Ft,zo,ys,Wo,Ds,ao,ii,Rs,Wr,ia,Ha,Ts,ra,Do,po,Ar,va,He,cr,mr,Os,yo,gl,Bs,Ta,Ca,Ga,Nt,ht]);const ir=L.useCallback(()=>{fc(),setTimeout(()=>{Wn(1),bn({x:0,y:0}),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),Cn(new Set),yn(new Set),pn(new Set),jn(new Set)},200)},[fc,Wn,bn]);Pt.useEffect(()=>{ir()},[]),Pt.useEffect(()=>{if(!Go.visible)return;const c=[];wn.size>0,wn.size===0&&Fn.size===0&&Ni.size===0&&vi.size===0&&c.push(`
No objects selected.`);const x=c.join(`
`);Wr(P=>({...P,text:x}))},[Go.visible,wn,Fn,Ni,vi,ct,Qt,tn,Re,Ee,fe]),Pt.useEffect(()=>{const c=x=>{const P=Tt.current;if(P&&!(x.target instanceof Node&&P.contains(x.target))){if(Pu(),Cu){const B=Vc.current;(!B||!(x.target instanceof Node)||!B.contains(x.target))&&Ll(!1)}if(Xo){const B=ks.current;!x.target?.closest('button[title="Color Picker"]')&&(!B||!(x.target instanceof Node)||!B.contains(x.target))&&va(!1)}}};return document.addEventListener("mousedown",c,!0),()=>document.removeEventListener("mousedown",c,!0)},[Pu,Cu,su,Xo]);const cd=c=>{if(!c.current)return{top:0,left:0};const x=c.current.getBoundingClientRect(),P=Bc.current?.getBoundingClientRect();return P?{top:x.top-P.top,left:x.left-P.left+x.width+4}:{top:0,left:0}},Tf=L.useCallback(()=>{Vc.current&&td.current&&requestAnimationFrame(()=>{if(Vc.current&&td.current){const c=cd(td);Vc.current.style.top=`${c.top}px`,Vc.current.style.left=`${c.left}px`}})},[]),Od=L.useCallback(()=>{Nu.current&&Ld.current&&requestAnimationFrame(()=>{if(Nu.current&&Ld.current){const c=cd(Ld);Nu.current.style.top=`${c.top}px`,Nu.current.style.left=`${c.left}px`}})},[]),fu=L.useCallback(()=>{lu.current&&Au.current&&requestAnimationFrame(()=>{if(lu.current&&Au.current){const c=cd(Au);lu.current.style.top=`${c.top}px`,lu.current.style.left=`${c.left}px`}})},[]);Pt.useEffect(()=>{Cu&&Tf()},[Cu,Tf]),Pt.useEffect(()=>{su&&Od()},[su,Od]),Pt.useEffect(()=>{Pd&&fu()},[Pd,fu]),Pt.useEffect(()=>{if(un&&ed.current&&Na.current){const c=cd(Na);ed.current.style.top=`${c.top}px`,ed.current.style.left=`${c.left}px`}},[un]),Pt.useEffect(()=>{if(tr&&ku.current&&Md.current){const c=cd(Md);ku.current.style.top=`${c.top}px`,ku.current.style.left=`${c.left}px`}},[tr]),Pt.useEffect(()=>{const c=x=>{if(!uo)return;const P=document.querySelector("[data-component-editor-dialog]");if(P&&x.target instanceof Node&&P.contains(x.target)){const $e=x.target;if($e.tagName==="BUTTON"||$e.tagName==="INPUT"||$e.closest("button")||$e.closest("input"))return}const B=Tt.current;if(!B)return;const K=B.getBoundingClientRect(),ne=x.clientX,z=x.clientY;if(ne<K.left||ne>K.right||z<K.top||z>K.bottom)return;const Ne=B.width/K.width,ve=B.height/K.height,Le=ne-K.left,Me=z-K.top,Ae=Le*Ne,he=Me*ve,me=Ae-5,Se=he-5,Pe=$f(me,Se,Zn,wt,mn,Dt),Oe=Pe.x,Fe=Pe.y;let Ze=1/0,dt=null,Ct=null;const It=Math.max(6/wt,4),cn=[...Qt,...tn].find($e=>$e.id===uo.componentId)?.layer||"top";for(const $e of ct)if(($e.type==="via"||$e.type==="pad")&&$e.points.length>0){if($e.type==="pad"&&($e.layer||"top")!==cn)continue;const Ye=$e.points[0],qe=Math.max(1,$e.size/2),at=Math.hypot(Ye.x-Oe,Ye.y-Fe),ft=Math.max(qe,It);at<=ft&&at<Ze&&(Ze=at,dt=Ye.id??null,Ct=$e)}if(dt!=null&&Ct){console.log(`
[PIN CONNECTION - DOCUMENT HANDLER] Found via!`),console.log(`  Point ID: ${dt}`),console.log(`  Connecting pin ${uo.pinIndex+1} of component ${uo.componentId}`);const $e=String(dt),Ye=uo.pinIndex,qe=uo.componentId,at=Qt.find(Bt=>Bt.id===qe),ft=tn.find(Bt=>Bt.id===qe);if(at){const Bt=ct;ri(ln=>{const _n=ln.find(Rt=>Rt.id===qe);if(!_n)return ln;const Qn=_n.pinConnections||[],Vn=Qn.length>0?[...Qn]:new Array(_n.pinCount).fill("");let Gn;if(Vn.length!==_n.pinCount){Gn=new Array(_n.pinCount).fill("");for(let Rt=0;Rt<Math.min(Vn.length,_n.pinCount);Rt++)Gn[Rt]=Vn[Rt]||""}else Gn=[...Vn];Gn[Ye]=$e,console.log(`Updated pin ${Ye} with value: ${$e}`),console.log("New pinConnections:",Gn);const Xn=ln.find(Rt=>Rt.id===qe),Bn=Xn?Wg(Xn,Gn,Bt):null;return ln.map(Rt=>{if(Rt.id===qe){const Ln={...Rt,pinConnections:Gn};return Bn&&(Ln.pinPolarities=Bn),Ln}return Rt})})}else if(ft){const Bt=ct;wi(ln=>{const _n=ln.find(Rt=>Rt.id===qe);if(!_n)return ln;const Qn=_n.pinConnections||[],Vn=Qn.length>0?[...Qn]:new Array(_n.pinCount).fill("");let Gn;if(Vn.length!==_n.pinCount){Gn=new Array(_n.pinCount).fill("");for(let Rt=0;Rt<Math.min(Vn.length,_n.pinCount);Rt++)Gn[Rt]=Vn[Rt]||""}else Gn=[...Vn];Gn[Ye]=$e,console.log(`Updated pin ${Ye} with value: ${$e}`),console.log("New pinConnections:",Gn);const Xn=ln.find(Rt=>Rt.id===qe),Bn=Xn?Wg(Xn,Gn,Bt):null;return ln.map(Rt=>{if(Rt.id===qe){const Ln={...Rt,pinConnections:Gn};return Bn&&(Ln.pinPolarities=Bn),Ln}return Rt})})}setTimeout(()=>{_a(null)},0)}else console.log("[PIN CONNECTION - DOCUMENT HANDLER] No via found at click location")};if(uo)return document.addEventListener("mousedown",c,!0),()=>document.removeEventListener("mousedown",c,!0)},[uo,Qt,tn,ct,wt,Zn.x,Zn.y,mn,Dt]);const Eo=L.useCallback((c,x,P,B)=>{const K=window.innerWidth,ne=window.innerHeight,z=10;let Ne=Math.max(z,Math.min(c,K-P-z)),ve=Math.max(z,Math.min(x,ne-B-z));return{x:Ne,y:ve}},[]);Pt.useEffect(()=>{if(!Zs)return;const c=P=>{if(!ws)return;const B={x:P.clientX-ws.x,y:P.clientY-ws.y},K=Eo(B.x,B.y,250,window.innerHeight*.4);rs(K),localStorage.setItem("componentDialogPosition",JSON.stringify(K))},x=()=>{eu(!1),tu(null)};return document.addEventListener("mousemove",c),document.addEventListener("mouseup",x),()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",x)}},[Zs,ws,Eo]),Pt.useEffect(()=>{if(!Gr)return;const c=P=>{if(!In)return;const B={x:P.clientX-In.x,y:P.clientY-In.y},K=Eo(B.x,B.y,250,window.innerHeight*.4);Oo(K),localStorage.setItem("detailedInfoDialogPosition",JSON.stringify(K))},x=()=>{Mn(!1),Ei(null)};return document.addEventListener("mousemove",c),document.addEventListener("mouseup",x),()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",x)}},[Gr,In,Eo]),Pt.useEffect(()=>{if(!pl)return;const c=P=>{if(!wc)return;const B={x:P.clientX-wc.x,y:P.clientY-wc.y};so(B),localStorage.setItem("notesDialogPosition",JSON.stringify(B))},x=()=>{_l(!1),_r(null)};return document.addEventListener("mousemove",c),document.addEventListener("mouseup",x),()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",x)}},[pl,wc]),Pt.useEffect(()=>{if(Oa&&Fo===null){const c=localStorage.getItem("notesDialogPosition");if(c)try{const x=JSON.parse(c);so(x)}catch{so({x:window.innerWidth-550,y:100})}else so({x:window.innerWidth-550,y:100})}},[Oa,Fo]),Pt.useEffect(()=>{if(!Uo)return;const c=P=>{if(!nc)return;const B={x:P.clientX-nc.x,y:P.clientY-nc.y};tc(B),localStorage.setItem("projectNotesDialogPosition",JSON.stringify(B))},x=()=>{Xr(!1),yl(null)};return document.addEventListener("mousemove",c),document.addEventListener("mouseup",x),()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",x)}},[Uo,nc]),Pt.useEffect(()=>{if(!ac)return;const c=P=>{if(!Tc)return;const B={x:P.clientX-Tc.x,y:P.clientY-Tc.y};oc(B),localStorage.setItem("testPointsDialogPosition",JSON.stringify(B))},x=()=>{Ec(!1),il(null)};return document.addEventListener("mousemove",c),document.addEventListener("mouseup",x),()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",x)}},[ac,Tc]),Pt.useEffect(()=>{if(ic&&Ja===null){const c=localStorage.getItem("testPointsDialogPosition");if(c)try{const x=JSON.parse(c);oc(x)}catch{oc({x:100,y:100})}else oc({x:100,y:100})}},[ic,Ja]),Pt.useEffect(()=>{if(Ku&&ec===null){const c=localStorage.getItem("projectNotesDialogPosition");if(c)try{const x=JSON.parse(c);tc(x)}catch{tc({x:100,y:100})}else tc({x:100,y:100})}},[Ku,ec]);const Cf=L.useCallback(()=>{gl(!0)},[]),jf=L.useCallback(()=>{rc(!0)},[]);Pt.useEffect(()=>{if(Va&&Va.visible&&vs===null){const c=localStorage.getItem("componentDialogPosition");let x;if(c)try{const P=JSON.parse(c);x=Eo(P.x,P.y,250,window.innerHeight*.4),rs(x)}catch{x=Eo(window.innerWidth-280,90,250,window.innerHeight*.4),rs(x)}else x=Eo(window.innerWidth-280,90,250,window.innerHeight*.4),rs(x)}else!Va||Va.visible},[Va,vs,Eo]),Pt.useEffect(()=>{if(Go.visible&&si===null){const c=localStorage.getItem("detailedInfoDialogPosition");let x;if(c)try{const P=JSON.parse(c);x=Eo(P.x,P.y,400,window.innerHeight*.8),Oo(x)}catch{x=Eo(window.innerWidth-450,90,400,window.innerHeight*.8),Oo(x)}else x=Eo(window.innerWidth-450,90,400,window.innerHeight*.8),Oo(x)}else Go.visible},[Go.visible,si,Eo]),Pt.useEffect(()=>{const c=()=>{if(vs){const x=Eo(vs.x,vs.y,250,window.innerHeight*.4);(x.x!==vs.x||x.y!==vs.y)&&(rs(x),localStorage.setItem("componentDialogPosition",JSON.stringify(x)))}if(si){const x=Eo(si.x,si.y,400,window.innerHeight*.8);(x.x!==si.x||x.y!==si.y)&&(Oo(x),localStorage.setItem("detailedInfoDialogPosition",JSON.stringify(x)))}};return window.addEventListener("resize",c),()=>window.removeEventListener("resize",c)},[vs,si,Eo]);const ud=L.useCallback(c=>{switch(c){case"transparency":m(50);break;case"brushSize":$(3);break}},[]),El=Pt.useRef(M);Pt.useEffect(()=>{El.current=M},[M]),Pt.useEffect(()=>{if(C){js.current=performance.now(),m(0);const c=x=>{const P=js.current||x,B=El.current,K=(x-P)%B/B,ne=1-Math.abs(1-2*K);m(Math.round(ne*100)),Al.current=requestAnimationFrame(c)};Al.current=requestAnimationFrame(c)}return()=>{Al.current&&(cancelAnimationFrame(Al.current),Al.current=null)}},[C]),Pt.useEffect(()=>{if(N==="center"){ji(O2());return}const c=N==="erase"?"erase":N==="magnify"?"magnify":N==="ground"?"ground":N==="power"?"power":N==="component"?"component":N==="draw"?Je==="via"?"via":Je==="pad"?"pad":Je==="testPoint"?"testPoint":"trace":"default";if(c==="default"){ji(void 0);return}const x=wt;let P;if(c==="magnify")P=18;else if(c==="component"){const he=(Ri||"top")==="top"?"componentTop":"componentBottom",Se=On.get(he).size||a0.DEFAULT_SIZE;P=Math.max(16,Math.round(Se*x))}else if(c==="trace"){const he=(ui||"top")==="top"?"traceTop":"traceBottom",Se=On.get(he).size||6;P=Math.max(6,Math.round(Se*x))}else if(c==="via"){const he=On.get("via").size||6;P=Math.max(6,Math.round(he*x))}else if(c==="pad"){const he=(Hn||"top")==="top"?"padTop":"padBottom",Se=On.get(he).size||6;P=Math.max(6,Math.round(Se*x))}else if(c==="testPoint"){const he=(di||"top")==="top"?"testPointTop":"testPointBottom",Se=On.get(he).size||18;P=Math.max(12,Math.round(Se*x))}else c==="power"||c==="ground"?P=Math.max(12,Math.round(F*x)):P=Math.max(6,Math.round(F*x));const K=P+4*2+(c==="magnify"?8:0),ne=document.createElement("canvas");ne.width=K,ne.height=K;const z=ne.getContext("2d");if(!z){ji(void 0);return}const Ne=K/2,ve=K/2,Le=P/2;if(z.clearRect(0,0,K,K),c==="via"){const Ae=Le,he=Le*.5,me=Le*.7,Pe=On.get("via").color;z.fillStyle=Pe,z.beginPath(),z.arc(Ne,ve,Ae,0,es),z.arc(Ne,ve,he,0,es),z.fill("evenodd"),z.strokeStyle="#808080",z.lineWidth=1,z.beginPath(),z.moveTo(Ne-me,ve),z.lineTo(Ne+me,ve),z.stroke(),z.beginPath(),z.moveTo(Ne,ve-me),z.lineTo(Ne,ve+me),z.stroke()}else if(c==="pad"){const Ae=Hn==="top"?"padTop":"padBottom",me=On.get(Ae).color,Pe=P/2,Oe=Pe*2,Fe=Oe*.5,Ze=Pe*.7;z.fillStyle=me,z.beginPath(),z.rect(Ne-Pe,ve-Pe,Oe,Oe),z.rect(Ne-Fe/2,ve-Fe/2,Fe,Fe),z.fill("evenodd"),z.strokeStyle="#808080",z.lineWidth=1,z.beginPath(),z.moveTo(Ne-Ze,ve),z.lineTo(Ne+Ze,ve),z.stroke(),z.beginPath(),z.moveTo(Ne,ve-Ze),z.lineTo(Ne,ve+Ze),z.stroke()}else if(c==="trace"){const Ae=ui==="top"?"traceTop":"traceBottom",me=On.get(Ae).color;z.fillStyle=me,z.beginPath(),z.arc(Ne,ve,Le,0,es),z.fill()}else if(c==="testPoint"){ji(F2(P));return}else if(c==="erase"){const Ae=F*x,he=Math.max(Ae*.75,8),me=Math.max(Ae*.5,6),Se=Math.max(Ae*.2,2);z.save(),z.translate(Ne,ve),z.rotate(mu(-35)),z.fillStyle="#f5a3b3",z.strokeStyle="#111",z.lineWidth=1.5;const Pe=1.5,Oe=-he/2,Fe=-me/2;z.beginPath(),z.moveTo(Oe+Pe,Fe),z.lineTo(Oe+he-Pe,Fe),z.quadraticCurveTo(Oe+he,Fe,Oe+he,Fe+Pe),z.lineTo(Oe+he,Fe+me-Pe),z.quadraticCurveTo(Oe+he,Fe+me,Oe+he-Pe,Fe+me),z.lineTo(Oe+Pe,Fe+me),z.quadraticCurveTo(Oe,Fe+me,Oe,Fe+me-Pe),z.lineTo(Oe,Fe+Pe),z.quadraticCurveTo(Oe,Fe,Oe+Pe,Fe),z.closePath(),z.fill(),z.stroke(),z.fillStyle="#f18ea4",z.beginPath(),z.rect(-he/2,me/2-Se,he,Se),z.fill(),z.restore()}else if(c==="magnify"){const Ae=Le;z.strokeStyle="#111",z.lineWidth=2,z.beginPath(),z.arc(Ne-2,ve-2,Ae,0,es),z.stroke();const he=Ne+Ae*.6,me=ve+Ae*.6,Se=he+6,Pe=me+6;z.beginPath(),z.moveTo(he,me),z.lineTo(Se,Pe),z.stroke(),z.beginPath(),z.moveTo(Ne-6,ve-2),z.lineTo(Ne+2,ve-2),z.stroke(),La||(z.beginPath(),z.moveTo(Ne-2,ve-6),z.lineTo(Ne-2,ve+2),z.stroke())}else if(c==="ground"){const he=(pr?Ve.find(Se=>Se.id===pr):null)?.color||"#000000";if(z.strokeStyle=he,z.lineWidth=2,z.lineCap="round",pr==="groundbus-earth"){const Se=Le*1.5,Pe=Se*.9,Oe=Se*.24,Fe=Se*1.6;z.beginPath(),z.moveTo(Ne,ve-Pe/2),z.lineTo(Ne,ve+Pe/2),z.stroke();for(let Ze=0;Ze<3;Ze++){const dt=ve+Pe/2+Ze*Oe,Ct=Fe*(1-Ze*.25);z.beginPath(),z.moveTo(Ne-Ct/2,dt),z.lineTo(Ne+Ct/2,dt),z.stroke()}}else{const Se=Le*.8;z.beginPath(),z.arc(Ne,ve,Le,0,es),z.stroke(),z.beginPath(),z.moveTo(Ne,ve-Le-Se),z.lineTo(Ne,ve+Le+Se),z.stroke(),z.beginPath(),z.moveTo(Ne-Le-Se,ve),z.lineTo(Ne+Le+Se,ve),z.stroke()}}else if(c==="power"){const he=(nn?fe.find(Se=>Se.id===nn):null)?.color||"#ff0000";z.strokeStyle=he,z.lineWidth=2,z.lineCap="round";const me=Le*.8;z.beginPath(),z.arc(Ne,ve,Le,0,es),z.stroke(),z.beginPath(),z.moveTo(Ne,ve-Le-me),z.lineTo(Ne,ve+Le+me),z.stroke(),z.beginPath(),z.moveTo(Ne-Le-me,ve),z.lineTo(Ne+Le+me,ve),z.stroke()}else if(c==="component"){const he=(Ri||"top")==="top"?"componentTop":"componentBottom",Se=On.get(he).color,Pe=P,Oe=Pe/2;z.strokeStyle=Se,z.lineWidth=2,z.fillStyle="rgba(255,255,255,0.9)",z.beginPath(),z.rect(Ne-Oe,ve-Oe,Pe,Pe),z.fill(),z.stroke();const Fe=(()=>{const Ze=Nc?.dataDrivenDefinition?.designator??Nc?.componentDefinition?.designator??Nc?.designator;return Ze?Ze.length<=3?Ze:Ze.substring(0,3):Ml?Eg(Ml):"?"})();z.fillStyle=Se,z.font=`bold ${Math.max(8,Pe*.35)}px sans-serif`,z.textAlign="center",z.textBaseline="middle",z.fillText(Fe,Ne,ve)}const Me=`url(${ne.toDataURL()}) ${Math.round(Ne)} ${Math.round(ve)}, crosshair`;ji(Me)},[N,Je,G,F,wt,La,Ml,Nc,nn,pr,fe,Ve,fi,ui,Hn,di,Ri,Nr.toolInstanceId]),Pt.useEffect(()=>{uu()},[uu]),Pt.useEffect(()=>{uu()},[Fr.width,Fr.height]),Pt.useEffect(()=>{wn.size===0&&N==="draw"&&Je==="trace"&&F>=1&&(At==="top"?te(F):je(F))},[F,N,Je,At,wn]),Pt.useEffect(()=>{ye(c=>c.map(x=>{if(x.type==="via"&&x.points.length>0&&x.points[0].id!==void 0){const P=x.points[0].id,B=Qa(P,fe);if(x.viaType!==B)return{...x,viaType:B}}else if(x.type==="pad"&&x.points.length>0&&x.points[0].id!==void 0){const P=x.points[0].id,B=Rl(P,fe);if(x.padType!==B)return{...x,padType:B}}else if(x.type==="testPoint"&&x.points.length>0&&x.points[0].id!==void 0){const P=x.points[0].id,B=ml(P,fe),K=B.includes("Power")?"power":B.includes("Ground")?"ground":B.includes("Signal")?"signal":"unknown";if(x.testPointType!==K)return{...x,testPointType:K}}return x}))},[Re,Ee,fe,Qa,Rl,ml]);const Cp=L.useCallback(()=>{const c=Tt.current;if(!c)return;const x=c.toDataURL("image/png"),P=window.open("","_blank");if(!P){alert("Please allow popups to print the canvas.");return}P.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>PCB Drawing</title>
          <style>
            @media print {
              @page {
                margin: 0;
                size: auto;
              }
              body {
                margin: 0;
                padding: 0;
              }
            }
            body {
              margin: 0;
              padding: 20px;
              display: flex;
              justify-content: center;
              align-items: center;
              background: white;
            }
            img {
              max-width: 100%;
              height: auto;
              display: block;
            }
          </style>
        </head>
        <body>
          <img src="${x}" alt="PCB Drawing" onload="window.setTimeout(function() { window.print(); }, 250);" />
        </body>
      </html>
    `),P.document.close()},[]);Pt.useEffect(()=>{const c=P=>{P.key==="Shift"&&ru(!0)},x=P=>{P.key==="Shift"&&ru(!1)};return window.addEventListener("keydown",c),window.addEventListener("keyup",x),()=>{window.removeEventListener("keydown",c),window.removeEventListener("keyup",x)}},[]);const Fd=L.useCallback(c=>{if(c.size===0)return;const x=Array.from(c).map(P=>String(P));ye(P=>P.map(B=>{if(B.type==="trace"){const K=B.points.filter(ne=>ne.id===void 0?!0:!c.has(ne.id));return K.length<2?null:{...B,points:K}}return B}).filter(B=>B!==null)),ri(P=>P.map(B=>{const K=B.pinConnections||[];if(K.some(z=>z&&x.includes(z))){const z=K.map(Ne=>Ne&&x.includes(Ne)?"":Ne);return{...B,pinConnections:z}}return B})),wi(P=>P.map(B=>{const K=B.pinConnections||[];if(K.some(z=>z&&x.includes(z))){const z=K.map(Ne=>Ne&&x.includes(Ne)?"":Ne);return{...B,pinConnections:z}}return B}))},[ye,ri,wi]),Nf=L.useRef(new Set);Pt.useEffect(()=>{const c=new Set;for(const P of ct)if((P.type==="via"||P.type==="pad")&&P.points.length>0){const B=P.points[0].id;B!==void 0&&c.add(B)}const x=new Set;for(const P of Nf.current)c.has(P)||x.add(P);x.size>0&&Fd(x),Nf.current=c},[ct,Fd]),Pt.useEffect(()=>{ye(c=>c.map(x=>{if(x.type==="via"&&x.points.length>0&&x.points[0].id!==void 0){const P=x.points[0].id,B=Qa(P,fe);if(x.viaType!==B)return{...x,viaType:B}}else if(x.type==="pad"&&x.points.length>0&&x.points[0].id!==void 0){const P=x.points[0].id,B=Rl(P,fe);if(x.padType!==B)return{...x,padType:B}}else if(x.type==="testPoint"&&x.points.length>0&&x.points[0].id!==void 0){const P=x.points[0].id,B=ml(P,fe),K=B.includes("Power")?"power":B.includes("Ground")?"ground":B.includes("Signal")?"signal":"unknown";if(x.testPointType!==K)return{...x,testPointType:K}}return x}))},[Re,Ee,fe,Qa,Rl,ml]),Pt.useEffect(()=>{const c=x=>{fl.current&&(fl.current.contains(x.target)||Rs(null))};return document.addEventListener("click",c),()=>document.removeEventListener("click",c)},[]),Pt.useEffect(()=>{const c=(x,P)=>{const B=x.current;if(!B)return;const K=B.getContext("2d");if(!K)return;const ne=B.width,z=B.height;if(K.clearRect(0,0,ne,z),K.fillStyle="#fff",K.fillRect(0,0,ne,z),P?.bitmap){const Ne=P.bitmap,ve=Math.min(ne/Ne.width,z/Ne.height),Le=Math.max(1,Math.floor(Ne.width*ve)),Me=Math.max(1,Math.floor(Ne.height*ve)),Ae=Math.floor((ne-Le)/2),he=Math.floor((z-Me)/2);K.drawImage(Ne,Ae,he,Le,Me)}K.strokeStyle="#ddd",K.lineWidth=1,K.strokeRect(.5,.5,ne-1,z-1)};c(nl,o),c(zl,l)},[o,l]),Pt.useEffect(()=>{const c=[],x=[],P=[],B=[];for(const K of ct)if(K.type==="via"&&K.points.length>=1){const ne=K.points[0],z={id:K.id,pointId:ne.id,x:ne.x,y:ne.y,size:K.size,color:K.color};c.push(z)}else if(K.type==="pad"&&K.points.length>=1){const ne=K.points[0],z={id:K.id,pointId:ne.id,x:ne.x,y:ne.y,size:K.size,color:K.color,layer:K.layer||"top"};x.push(z)}else if(K.type==="trace"&&K.points.length>=2)for(let ne=0;ne<K.points.length-1;ne++){const z=K.points[ne],Ne=K.points[ne+1],ve={id:K.id,startPointId:z.id,endPointId:Ne.id,x1:z.x,y1:z.y,x2:Ne.x,y2:Ne.y,size:K.size,color:K.color};K.layer==="top"?P.push(ve):B.push(ve)}ea(c),xr(x),Ua(P),Pn(B)},[ct]);const zu=L.useRef(ct);zu.current=ct;const Vl=L.useCallback(()=>{const x=new Date().toISOString(),P=z1();return{project:{version:1,fileType:"PCB_REVERSE_ENGINEERING_AUTOSAVE",savedAt:x,view:{currentView:b,viewScale:wt,cameraWorldCenter:rn,showBothLayers:qi,selectedDrawingLayer:At},images:{top:o?{name:o.name,width:o.width,height:o.height,filePath:o.filePath||o.name,x:o.x,y:o.y,scale:o.scale,rotation:o.rotation,flipX:o.flipX,flipY:o.flipY,skewX:o.skewX,skewY:o.skewY,keystoneV:o.keystoneV,keystoneH:o.keystoneH,brightness:o.brightness??100,contrast:o.contrast??100}:null,bottom:l?{name:l.name,width:l.width,height:l.height,filePath:l.filePath||l.name,x:l.x,y:l.y,scale:l.scale,rotation:l.rotation,flipX:l.flipX,flipY:l.flipY,skewX:l.skewX,skewY:l.skewY,keystoneV:l.keystoneV,keystoneH:l.keystoneH,brightness:l.brightness??100,contrast:l.contrast??100}:null},projectDirectoryName:aa.current?aa.current.name||null:oi&&oi.name||null,drawing:{drawingStrokes:zu.current.filter(K=>!(K.type==="trace"&&K.points.length<2)),vias:za,tracesTop:bs,tracesBottom:Ks,componentsTop:Qt,componentsBottom:tn,grounds:Ee,powers:Re},powerBuses:fe,groundBuses:Ve,pointIdCounter:yg(),designatorCounters:{...ai.current},autoAssignDesignators:Ur,useGlobalDesignatorCounters:Pr,traceColors:{top:fi.get("trace")?.layerSettings.get("top")?.color||H,bottom:fi.get("trace")?.layerSettings.get("bottom")?.color||Z},traceSizes:{top:fi.get("trace")?.layerSettings.get("top")?.size||we,bottom:fi.get("trace")?.layerSettings.get("bottom")?.size||de},padColors:{top:fi.get("pad")?.layerSettings.get("top")?.color||Ie,bottom:fi.get("pad")?.layerSettings.get("bottom")?.color||k},padSizes:{top:fi.get("pad")?.layerSettings.get("top")?.size||q,bottom:fi.get("pad")?.layerSettings.get("bottom")?.size||se},componentColors:{top:fi.get("component")?.layerSettings.get("top")?.color||ge,bottom:fi.get("component")?.layerSettings.get("bottom")?.color||Yt},componentSizes:{top:fi.get("component")?.layerSettings.get("top")?.size||xt,bottom:fi.get("component")?.layerSettings.get("bottom")?.size||Et},testPointColors:{top:fi.get("testPoint")?.layerSettings.get("top")?.color||le,bottom:fi.get("testPoint")?.layerSettings.get("bottom")?.color||be},testPointSizes:{top:fi.get("testPoint")?.layerSettings.get("top")?.size||Ge,bottom:fi.get("testPoint")?.layerSettings.get("bottom")?.size||jt},componentConnectionColor:Zt,componentConnectionSize:tt,toolLayerDefaults:{trace:ui,pad:Hn,testPoint:di,component:Ri},toolSettings:{trace:fi.get("trace")?.settings||{color:"#ff0000",size:6},via:fi.get("via")?.settings||{color:"#ff0000",size:18},pad:fi.get("pad")?.settings||{color:"#ff0000",size:18},component:fi.get("component")?.settings||{color:"#ff0000",size:18},ground:fi.get("ground")?.settings||{color:"#000000",size:18},power:fi.get("power")?.settings||{color:"#ff0000",size:18},erase:fi.get("erase")?.settings||{color:"#f5a3b3",size:18}},locks:{areImagesLocked:Qi,areViasLocked:Dr,arePadsLocked:ma,areTracesLocked:fo,areComponentsLocked:Wi,areGroundNodesLocked:vo,arePowerNodesLocked:$i},visibility:{showViasLayer:No,showTopPadsLayer:Bo,showBottomPadsLayer:Zo,showTopTracesLayer:Ma,showBottomTracesLayer:Ba,showTopComponents:X,showBottomComponents:oe,showPowerLayer:pe,showGroundLayer:nr,showConnectionsLayer:yi,showTraceCornerDots:Ui},autoSave:{enabled:$a,interval:kl,baseName:Io},projectInfo:{name:no},projectNotes:Sc,projectMetadata:Uc,homeViews:Pl,toolInstances:On.getAll()},timestamp:P}},[b,wt,rn,qi,At,o,l,ct,za,bs,Ks,Qt,tn,Ee,fi,Qi,Dr,ma,fo,Wi,vo,$i,fe,Ve,yg,H,Z,we,de,Ie,k,q,se,ge,Yt,xt,Et,ui,Hn,di,Ri,$a,kl,Io,no,No,Bo,Zo,Ma,Ba,X,oe,pe,nr,yi,Ur,Pr,Sc,Uc,Pl]),_u=L.useRef(Vl);_u.current=Vl;const jp=L.useRef(er);jp.current=er;const kc={setProjectDirHandle:Rr,setAutoSaveDirHandle:To,setCurrentProjectFilePath:er,setProjectName:Lo,setAutoSaveEnabled:ho,setAutoSaveInterval:Ro,setAutoSaveBaseName:to,setAutoSaveFileHistory:Ya,setCurrentFileIndex:$r,setHasUnsavedChangesState:wo,setTopImage:s,setBottomImage:d,setDrawingStrokes:ye,setCurrentStroke:vt,setVias:ea,setPads:xr,setTracesTop:Ua,setTracesBottom:Pn,setComponentsTop:ri,setComponentsBottom:wi,setComponentEditor:qa,setConnectingPin:_a,setPowerSymbols:$t,setGroundSymbols:sn,setPowerEditor:li,setPowerBuses:Be,setGroundBuses:gt,setSelectedIds:Cn,setSelectedComponentIds:yn,setSelectedPowerIds:pn,setSelectedGroundIds:jn,setIsSelecting:Yo,setProjectNotes:hl,setProjectMetadata:Za,setCurrentView:p,setViewScale:Wn,setCameraCenter:_i,setCameraWorldCenter:bn,setShowBothLayers:Br,setSelectedDrawingLayer:Jt,setHomeViews:Ns,setIsWaitingForHomeViewKey:fr,setSelectedImageForTransform:zi,setIsTransforming:qt,setTransformStartPos:Ji,setTransformMode:jr,setIsBottomView:sr,setOriginalTopFlipX:lr,setOriginalBottomFlipX:cs,setIsGrayscale:_,setTransparency:m,setIsTransparencyCycling:D,setTransparencyCycleSpeed:S,setAreImagesLocked:ya,setAreViasLocked:xa,setArePadsLocked:Ss,setAreTestPointsLocked:Da,setAreTracesLocked:ba,setAreComponentsLocked:Ra,setAreGroundNodesLocked:os,setArePowerNodesLocked:eo,setShowTopImage:Yr,setShowBottomImage:jo,setShowViasLayer:Ka,setShowTopTracesLayer:fs,setShowBottomTracesLayer:Li,setShowTopPadsLayer:ua,setShowBottomPadsLayer:ja,setShowTopTestPointsLayer:y,setShowBottomTestPointsLayer:I,setShowTopComponents:ie,setShowBottomComponents:ce,setShowPowerLayer:Te,setShowGroundLayer:Si,setShowConnectionsLayer:Xi,setShowTraceCornerDots:Er,setCurrentTool:g,setDrawingMode:Ft,setTraceToolLayer:zo,setPadToolLayer:ys,setTestPointToolLayer:Wo,setComponentToolLayer:Ds,setAutoAssignDesignators:ao,setUseGlobalDesignatorCounters:ii,setOpenMenu:Rs,setDebugDialog:Wr,setErrorDialog:ia,setNewProjectDialog:Ha,setOpenProjectDialog:Jl,setNewProjectSetupDialog:Ts,setSaveAsDialog:ra,setAutoSaveDialog:Do,setAutoSavePromptDialog:po,setShowColorPicker:va,setShowPowerBusManager:He,setShowGroundBusManager:cr,setShowDesignatorManager:mr,setShowBoardDimensionsDialog:Os,setNotesDialogVisible:yo,setProjectNotesDialogVisible:gl,setTransformImagesDialogVisible:el,setTransformAllDialogVisible:Ko,setBoardDimensions:Bs,setHoverComponent:Ta,setHoverTestPoint:Ca,setIsPanning:Ga,setIsDrawing:Nt,setTracePreviewMousePos:ht,clearSnapshot:Ar,projectDirHandleRef:aa,autoSaveDirHandleRef:dr,autoSaveBaseNameRef:io,autoSaveIntervalRef:ki,hasChangesSinceLastAutoSaveRef:Ti,currentProjectFilePathRef:cl,autoSaveFileHistoryRef:ro,currentFileIndexRef:us,currentStrokeRef:An,sessionDesignatorCountersRef:ai,traceToolLayerRef:ts,padToolLayerRef:ns,testPointToolLayerRef:xs,componentToolLayerRef:Or,homeViewTimeoutRef:En,panStartRef:Co,panClientStartRef:Mo,lastTraceClickTimeRef:dn,isDoubleClickingTraceRef:ti},fa=L.useMemo(()=>rb(kc),[Rr,To,er,Lo,ho,Ro,to,Ya,$r,s,d,ye,vt,ea,xr,Ua,Pn,ri,wi,qa,_a,$t,sn,li,Be,gt,Cn,yn,pn,jn,Yo,hl,Za,p,Wn,_i,bn,Br,Jt,Ns,fr,zi,qt,Ji,jr,sr,lr,cs,_,m,D,S,ya,xa,Ss,Da,ba,Ra,os,eo,Yr,jo,Ka,fs,Li,ua,ja,y,I,ie,ce,Te,Si,Xi,Er,g,Ft,zo,ys,Wo,Ds,ao,ii,Rs,Wr,ia,Ha,Ts,ra,Do,po,Ar,va,He,cr,mr,Os,yo,gl,el,Ko,Bs,Ta,Ca,Ga,Nt,ht,aa,dr,io,ki,Ti,cl,ro,us,An,ai,ts,ns,xs,Or,En,Co,Mo,dn,ti]),Ud=L.useRef(fa),dd=L.useCallback(()=>{Ud.current&&Ud.current()},[]),ko=L.useCallback(async()=>{await ob(dd)},[dd]),kf=L.useCallback(async()=>{const c=dr.current||aa.current,x=io.current;!c||!x||await sb(c,x,Ti,zu,ye,_u.current,er,cl,Ya,ro,$r,us,wo,ho,ki)},[dr,aa,io,Ti,zu,ye,_u,er,cl,Ya,ro,$r,us,wo,ho,ki]);ds.current=kf;const qc=L.useCallback(async()=>{const{project:c}=Vl(),x=JSON.stringify(c,null,2),P=new Blob([x],{type:"application/json"});if(oi&&no)try{let Le=null;try{Le=await oi.getDirectoryHandle("history",{create:!0})}catch(Oe){console.error("Failed to get/create history directory:",Oe),Le=null}const Me=no.replace(/\.json$/i,""),Ae=vd(Me),{timestamp:he}=Vl(),me=`${Ae}_${he}.json`;if(Le)try{const Oe=[];for await(const Fe of oi.keys())try{if(Fe==="history"||Fe===me)continue;const dt=await(await oi.getFileHandle(Fe)).getFile();if(!Fe.endsWith(".json"))continue;const Ct=await dt.text();try{JSON.parse(Ct).version&&(Oe.push(Fe),console.log(`Save: Found PCB project file in root: ${Fe}`))}catch{continue}}catch{continue}for(const Fe of Oe)try{const Ct=await(await(await oi.getFileHandle(Fe)).getFile()).text(),st=await(await Le.getFileHandle(Fe,{create:!0})).createWritable();await st.write(new Blob([Ct],{type:"application/json"})),await st.close(),await oi.removeEntry(Fe),console.log(`Save: Moved ${Fe} from root to history/`)}catch(Ze){console.warn(`Save: Failed to move ${Fe} to history:`,Ze)}}catch(Oe){console.warn("Save: Error checking for old files in root:",Oe)}const Pe=await(await oi.getFileHandle(me,{create:!0})).createWritable();await Pe.write(P),await Pe.close(),er(me),wo(!1),Ti.current=!1,console.log(`Project saved successfully: ${no}/${me}`),alert(`Project saved successfully!

File: ${me}
Location: ${no}`);return}catch(Le){const Me=Le instanceof Error?Le.message:String(Le);console.error("Failed to save to project directory:",Le),alert(`Failed to save project to directory.

Error: ${Me}

Please try saving again or use Save As...`),Rr(null)}if(no&&!oi){const Le=window;if(typeof Le.showDirectoryPicker=="function")try{const Me=await Le.showDirectoryPicker();Rr(Me);const Ae=`${no}.json`,me=await(await Me.getFileHandle(Ae,{create:!0})).createWritable();await me.write(P),await me.close(),er(Ae),wo(!1),Ti.current=!1,console.log(`Project saved successfully: ${Ae} in selected directory`),alert(`Project saved successfully!

File: ${Ae}`);return}catch(Me){if(Me?.name!=="AbortError"){const Ae=Me instanceof Error?Me.message:String(Me);console.error("Failed to get directory:",Me),alert(`Failed to select directory.

Error: ${Ae}

Falling back to file picker...`)}}}const B=Le=>String(Le).padStart(2,"0"),K=new Date,z=`pcb_project_${`${K.getFullYear()}_${B(K.getMonth()+1)}_${B(K.getDate())}_${B(K.getHours())}_${B(K.getMinutes())}_${B(K.getSeconds())}`}.json`,Ne=window;if(typeof Ne.showSaveFilePicker=="function")try{const Le=await Ne.showSaveFilePicker({suggestedName:z,types:[{description:"PCB Project",accept:{"application/json":[".json"]}}]}),Me=await Le.createWritable();await Me.write(P),await Me.close();const Ae=Le.name;try{const Se=await Le.getFile();er(Se.name)}catch{er(Ae)}const me=Ae.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_");me&&Lo(me);try{const Se=Le.name.replace(/\.json$/i,""),Oe=vd(Se).replace(/[^a-zA-Z0-9_-]/g,"_");to(Oe),Ls||console.log("Auto save: Directory handle not set. Will prompt on first auto save.")}catch(Se){console.warn("Could not set up auto save for new file:",Se)}console.log(`Project saved successfully: ${Ae}`),alert(`Project saved successfully!

File: ${Ae}`);return}catch(Le){if(Le?.name==="AbortError")return;const Me=Le instanceof Error?Le.message:String(Le);console.warn("showSaveFilePicker failed, falling back to download",Le),alert(`File picker unavailable.

Error: ${Me}

Falling back to browser download...`)}const ve=document.createElement("a");ve.href=URL.createObjectURL(P),ve.download=z,document.body.appendChild(ve),ve.click(),setTimeout(()=>{URL.revokeObjectURL(ve.href),document.body.removeChild(ve)},0),console.log(`Project downloaded: ${z}`),alert(`Project downloaded successfully!

File: ${z}

Note: For better project management, use File  New Project or File  Open Project.`)},[Vl,oi,no,er,Rr,wo,Lo,to,Ls,vd]),Af=L.useCallback(c=>{const x=new qn,P=x.internal.pageSize.getWidth(),B=x.internal.pageSize.getHeight(),K=20;let ne=K;const z=7,Ne=60;x.setFontSize(18),x.setFont("helvetica","bold"),x.text("Bill of Materials",P/2,ne,{align:"center"}),ne+=z*2,x.setFontSize(10),x.setFont("helvetica","normal"),c.projectName&&(x.text(`Project: ${c.projectName}`,K,ne),ne+=z),x.text(`Exported: ${new Date(c.exportedAt).toLocaleString()}`,K,ne),ne+=z,x.text(`Total Components: ${c.totalComponents} | Unique Components: ${c.uniqueComponents}`,K,ne),ne=Ne,x.setFontSize(9),x.setFont("helvetica","bold");const ve=[15,50,30,20,25,30,20],Le=["Qty","Component Type","Value","Package","Manufacturer","Part Number","Layer"];let Me=K;return Le.forEach((he,me)=>{x.text(he,Me,ne),Me+=ve[me]}),ne+=z,x.setLineWidth(.5),x.line(K,ne,P-K,ne),ne+=z*.5,x.setFont("helvetica","normal"),x.setFontSize(8),c.items.forEach(he=>{const me=Ze=>{ne>B-K-z*Ze&&(x.addPage(),ne=K+z)};me(3),Me=K,[he.quantity.toString(),he.componentType,he.value||"-",he.packageType||"-",he.manufacturer||"-",he.partNumber||"-",he.layer].forEach((Ze,dt)=>{const Ct=ve[dt]-2,It=x.splitTextToSize(Ze,Ct);x.text(It[0]||"-",Me,ne),Me+=ve[dt]}),ne+=z*1.2;const Pe=(he.notes||"").toString().trim(),Oe=he.datasheet?he.datasheet.toString().trim():"",Fe=[];if(Pe&&Fe.push(`Notes: ${Pe}`),Oe&&Fe.push(`Spec Sheet URL: ${Oe}`),Fe.length>0){const Ze=K+ve[0]+2,dt=P-K-Ze;Fe.forEach(Ct=>{x.splitTextToSize(Ct,dt).forEach(st=>{me(2),x.text(st,Ze,ne),ne+=z*.9})})}me(1),x.setLineWidth(.2),x.line(K,ne,P-K,ne),ne+=z*.5}),x.output("blob")},[]),xo=L.useCallback(async()=>{if(console.log("handleExportBOM called, format:",ae),!oi){alert("Please create or open a project before exporting BOM.");return}try{console.log("Generating BOM data...");const c=nb(Qt,tn,no);console.log("BOM data generated:",c),console.log("Creating/getting BOM directory...");let x;try{x=await oi.getDirectoryHandle("BOM",{create:!0}),console.log("BOM directory obtained")}catch(Ne){console.error("Failed to get/create BOM directory:",Ne),alert("Failed to create BOM directory. See console for details.");return}const P=z1();let B,K;if(ae==="pdf")console.log("Generating PDF..."),B=Af(c),K=`BOM_${P}.pdf`;else{console.log("Generating JSON...");const Ne=JSON.stringify(c,null,2);B=new Blob([Ne],{type:"application/json"}),K=`BOM_${P}.json`}console.log("Saving file:",K);const z=await(await x.getFileHandle(K,{create:!0})).createWritable();await z.write(B),await z.close(),console.log("BOM file saved successfully"),alert(`BOM exported successfully to ${K} in BOM directory!`)}catch(c){console.error("Failed to export BOM:",c),alert(`Failed to export BOM: ${c instanceof Error?c.message:String(c)}. See console for details.`)}},[oi,Qt,tn,no,ae,Af]),Us=L.useCallback(async c=>{if(!oi){alert("Please create or open a project before exporting netlist.");return}const x=c||E;try{const P=[...Qt,...tn];let B,K,ne;x==="kicad"?(B=Z2(P,ct,Re,Ee,fe),K="KiCad",ne=".net"):x==="protel"?(B=J2(P,ct,Re,Ee,fe),K="Protel",ne=".net"):x==="spice"?(B=Q2(P,ct,Re,Ee,fe),K="SPICE",ne=".cir"):(B=eb(P,ct,Re,Ee,fe,Ve,no),K="PADS",ne=".json");const z=`${no}_${K}${ne}`,Ne=x==="pads"?"application/json":"text/plain",ve=new Blob([B],{type:Ne});try{const Ae=await(await(await oi.getDirectoryHandle("netlists",{create:!0})).getFileHandle(z,{create:!0})).createWritable();await Ae.write(ve),await Ae.close(),alert(`Netlist exported successfully to netlists/${z}!`)}catch(Le){console.warn("File System Access API failed, using download fallback:",Le);const Me=URL.createObjectURL(ve),Ae=document.createElement("a");Ae.href=Me,Ae.download=z,document.body.appendChild(Ae),Ae.click(),document.body.removeChild(Ae),URL.revokeObjectURL(Me),alert(`Netlist downloaded as ${z}!`)}}catch(P){console.error("Failed to export netlist:",P),alert(`Failed to export netlist: ${P instanceof Error?P.message:String(P)}. See console for details.`)}},[oi,Qt,tn,ct,Re,Ee,fe,no,E]);Pt.useEffect(()=>{ki.current&&(clearInterval(ki.current),ki.current=null);const c=Mc.current;if(Mc.current=$a,$a&&kl){const x=kl*60*1e3;(Ls||oi)&&Io?(console.log(`Auto save: Setting up interval for ${kl} minute(s) (${x}ms)`),c||(Ti.current=!0,setTimeout(()=>{kf()},100)),ki.current&&(clearInterval(ki.current),ki.current=null),ki.current=window.setInterval(()=>{console.log("Auto save: Interval triggered, calling performAutoSave..."),console.log(`  - hasChangesSinceLastAutoSave: ${Ti.current}`),console.log(`  - dirHandle: ${dr.current?"set":"missing"}`),console.log(`  - baseName: ${io.current||"missing"}`),kf()},x),console.log(`Auto save: Interval set up for ${x}ms (${kl} minutes)`),console.log(`  - Auto save directory handle: ${Ls?"set":"missing"}`),console.log(`  - Project directory handle: ${oi?"set":"missing"}`),console.log(`  - Base name: ${Io||"missing"}`)):(console.warn(`Auto save: Cannot set up interval - missing directory handle (autoSaveDirHandle: ${!!Ls}, projectDirHandle: ${!!oi}) or base name (${!Io}). Disabling auto save.`),ho(!1),ki.current&&(clearInterval(ki.current),ki.current=null))}else $a||(Mc.current=!1);return()=>{ki.current&&(clearInterval(ki.current),ki.current=null)}},[$a,kl,Ls,Io,oi]);const bl=L.useRef(!1),fd=L.useRef(!1),[Np,kp]=Pt.useState(0);Pt.useEffect(()=>{const x=Object.keys(On.getAll()).map(P=>On.subscribe(P,()=>{kp(B=>B+1)}));return()=>x.forEach(P=>P())},[]),Pt.useEffect(()=>{if(fd.current){console.log("Change tracking: Skipping - project is being loaded");return}if($a&&bl.current){bl.current=!1,console.log("Auto save: Skipping change tracking on first run after enable (initial save handled separately)");return}Ti.current=!0,wo(!0),console.log("Change detected, marking as unsaved",{autoSaveEnabled:$a,topImage:!!o,bottomImage:!!l,drawingStrokesCount:ct.length,componentsTopCount:Qt.length,componentsBottomCount:tn.length,powersCount:Re.length,groundsCount:Ee.length,powerBusesCount:fe.length,projectNotesCount:Sc.length,areImagesLocked:Qi,areViasLocked:Dr,areTracesLocked:fo,areComponentsLocked:Wi,areGroundNodesLocked:vo,arePowerNodesLocked:$i})},[o,l,ct,Qt,tn,Re,Ee,fe,Sc,H,Z,we,de,Qi,Dr,fo,Wi,vo,$i,Ve,$a,Ie,k,q,se,ge,Yt,xt,Et,le,be,Ge,jt,Zt,tt,ui,Ur,Pr,Pl,fi,Np]),Pt.useEffect(()=>{$a?(bl.current=!0,console.log("Auto save: Enabled, marking first run")):bl.current=!1},[$a]),Pt.useEffect(()=>{$a||(Ti.current=!1)},[$a]);const pd=L.useCallback(()=>!!(o||l||ct.length>0||Qt.length>0||tn.length>0||Re.length>0||Ee.length>0),[o,l,ct,Qt,tn,Re,Ee]),Hc=L.useCallback(()=>{Ts({visible:!0,projectName:"",locationPath:"",locationHandle:null})},[]),Es=L.useCallback(async()=>{const c=window;if(typeof c.showDirectoryPicker=="function")try{const x=await c.showDirectoryPicker({mode:"readwrite"});Ts(P=>({...P,locationHandle:x,locationPath:x.name||"Selected folder"}))}catch(x){x?.name!=="AbortError"&&(console.error("Failed to get directory:",x),alert("Failed to select location directory."))}else alert("Directory picker is not supported in this browser. Please use a modern browser like Chrome or Edge.")},[]),vl=L.useCallback(async()=>{const c=Jn.projectName.trim();if(!c){alert("Please enter a project name.");return}if(!Jn.locationHandle){alert("Please select a location for the project.");return}const x=await ab(c,Jn.locationHandle,ko,Lo,Rr,er,aa,Vl,fc,ni,sr,m,async(P,B,K,ne)=>{await Zd(P,B,K,ho,Ro,To,to,dr,io,ki,Ti,Do,po,Rr,ds,ne)});if(!x.success){x.error&&alert(x.error);return}Ts({visible:!1,projectName:"",locationPath:"",locationHandle:null}),console.log(`New project created successfully: ${x.projectName}/${x.projectFileName}`)},[Jn,ko,Lo,Rr,er,aa,Vl,fc,ni,sr,m,no,oi,ho,Ro,To,to,dr,io,ki,Ti,Do,po,ds]),Ed=L.useCallback(()=>{Ts({visible:!1,projectName:"",locationPath:"",locationHandle:null})},[]),Vs=L.useCallback(async()=>{const c=window;if(typeof c.showDirectoryPicker=="function")try{const x=await c.showDirectoryPicker();ra(P=>({...P,locationHandle:x,locationPath:x.name||"Selected folder"}))}catch(x){x?.name!=="AbortError"&&(console.error("Failed to get directory:",x),alert("Failed to select location directory."))}else alert("Directory picker is not supported in this browser. Please use a modern browser that supports the File System Access API.")},[]),Pf=L.useCallback(async()=>{const c=Oi.filename.trim();if(!c){alert("Please enter a file name.");return}const P=(c.endsWith(".json")?c:`${c}.json`).replace(/[^a-zA-Z0-9_.-]/g,"_");if(!Oi.locationHandle){alert("Please select a location for the file.");return}const B=Oi.locationHandle;try{const{project:K}=Vl(),ne=JSON.stringify(K,null,2),z=new Blob([ne],{type:"application/json"}),ve=await(await B.getFileHandle(P,{create:!0})).createWritable();await ve.write(z),await ve.close(),er(P);const Le=P.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_");Le&&Lo(Le),Rr(B),wo(!1),Ti.current=!1,ra({visible:!1,filename:"",locationPath:"",locationHandle:null}),Rs(null),console.log(`Project saved as: ${P} in selected directory`)}catch(K){console.error("Failed to save project:",K),alert(`Failed to save project file "${P}". See console for details.`)}},[Oi,Vl]),ql=L.useCallback(()=>{ra({visible:!1,filename:"",locationPath:"",locationHandle:null})},[]),Ac=L.useCallback(async()=>{Ha({visible:!1}),await qc(),Hc(),ir()},[qc,Hc,ir]),Pc=L.useCallback(()=>{Ha({visible:!1}),Hc(),ir()},[Hc,ir]),zf=L.useCallback(()=>{Ha({visible:!1})},[]);Pt.useEffect(()=>{if(Qs.visible){setTimeout(()=>{bu.current?.focus()},0);const c=x=>{x.key==="Enter"?(x.preventDefault(),Ac()):x.key==="Escape"&&(x.preventDefault(),Ha({visible:!1}))};return window.addEventListener("keydown",c),()=>{window.removeEventListener("keydown",c)}}},[Qs.visible,Ac]);const Hl=L.useCallback(async(c,x)=>{fd.current=!0;try{if(console.log("loadProject: Clearing all existing project data before loading..."),s(null),d(null),ye([]),ea([]),xr([]),Ua([]),Pn([]),vt([]),An.current=[],ri([]),wi([]),qa(null),_a(null),$t([]),sn([]),li(null),Cn(new Set),yn(new Set),pn(new Set),jn(new Set),Ar(),c.toolInstances?On.initializeFromProject(c):On.initialize(),c.projectInfo&&c.projectInfo.name&&Lo(c.projectInfo.name),c.view){if(c.view.currentView&&p(c.view.currentView),c.view.viewScale!=null&&Wn(c.view.viewScale),c.view.cameraWorldCenter)bn(c.view.cameraWorldCenter);else if(c.view.viewPan){const Me=Tt.current;if(Me){const Ae=(Me.width-10)/2,he=(Me.height-10)/2,me=c.view.viewScale??1,Se=(Ae-c.view.viewPan.x)/me,Pe=(he-c.view.viewPan.y)/me;bn({x:Se,y:Pe})}else bn({x:0,y:0})}c.view.showBothLayers!=null&&Br(c.view.showBothLayers),c.view.selectedDrawingLayer&&Jt(c.view.selectedDrawingLayer)}if(c.homeViews){const Me={};for(const[Ae,he]of Object.entries(c.homeViews)){const me=parseInt(Ae,10),Se=he;let Pe=Se.pcbReferenceX,Oe=Se.pcbReferenceY;(Pe===void 0||Oe===void 0)&&(Pe=Se.x??0,Oe=Se.y??0),Se.showTopImage===void 0?Me[me]={pcbReferenceX:Pe,pcbReferenceY:Oe,x:0,y:0,zoom:Se.zoom,viewRotation:mn,viewFlipX:Dt,isBottomView:Wa,transparency:v,showTopImage:As,showBottomImage:Xa,showViasLayer:No,showTopTracesLayer:Ma,showBottomTracesLayer:Ba,showTopPadsLayer:Bo,showBottomPadsLayer:Zo,showTopTestPointsLayer:f,showBottomTestPointsLayer:j,showTopComponents:X,showBottomComponents:oe,showPowerLayer:pe,showGroundLayer:nr,showConnectionsLayer:yi}:Me[me]={...Se,pcbReferenceX:Pe,pcbReferenceY:Oe,x:0,y:0,viewRotation:Se.viewRotation??0,viewFlipX:Se.viewFlipX??!1,isBottomView:Se.isBottomView??!1,transparency:Se.transparency??50}}Ns(Me)}else Ns({});if(c.projectNotes&&Array.isArray(c.projectNotes)?hl(c.projectNotes):hl([]),c.projectMetadata?Za({productName:c.projectMetadata.productName||"",productVersion:c.projectMetadata.productVersion||"",manufacturer:c.projectMetadata.manufacturer||"",date:c.projectMetadata.date||new Date().toISOString().split("T")[0]}):Za({productName:"",productVersion:"",manufacturer:"",date:new Date().toISOString().split("T")[0]}),c.traceColors&&(c.traceColors.top&&(R(c.traceColors.top),Wt("trace",c.traceColors.top,"top")),c.traceColors.bottom&&(Y(c.traceColors.bottom),Wt("trace",c.traceColors.bottom,"bottom"))),c.traceSizes){const Me=c.traceSizes.top!=null&&c.traceSizes.top>0?c.traceSizes.top:6;let Ae=c.traceSizes.bottom!=null&&c.traceSizes.bottom>0?c.traceSizes.bottom:6;Ae<6&&(Ae=6),te(Me),je(Ae),Lt("trace",Me,"top"),Lt("trace",Ae,"bottom")}else te(6),je(6);if(c.padColors&&(c.padColors.top&&(xe(c.padColors.top),Wt("pad",c.padColors.top,"top")),c.padColors.bottom&&(A(c.padColors.bottom),Wt("pad",c.padColors.bottom,"bottom"))),c.padSizes){const Me=c.padSizes.top!=null&&c.padSizes.top>0?c.padSizes.top:18,Ae=c.padSizes.bottom!=null&&c.padSizes.bottom>0?c.padSizes.bottom:18;W(Me),Ce(Ae),Lt("pad",Me,"top"),Lt("pad",Ae,"bottom")}if(c.componentColors&&(c.componentColors.top&&(lt(c.componentColors.top),Wt("component",c.componentColors.top,"top")),c.componentColors.bottom&&(Gt(c.componentColors.bottom),Wt("component",c.componentColors.bottom,"bottom"))),c.componentSizes){const Me=c.componentSizes.top!=null&&c.componentSizes.top>0?c.componentSizes.top:18,Ae=c.componentSizes.bottom!=null&&c.componentSizes.bottom>0?c.componentSizes.bottom:18;hn(Me),gn(Ae),Lt("component",Me,"top"),Lt("component",Ae,"bottom")}c.toolLayerDefaults?(c.toolLayerDefaults.trace&&zo(c.toolLayerDefaults.trace),c.toolLayerDefaults.pad&&ys(c.toolLayerDefaults.pad),c.toolLayerDefaults.testPoint&&Wo(c.toolLayerDefaults.testPoint),c.toolLayerDefaults.component&&Ds(c.toolLayerDefaults.component)):c.traceToolLayer&&zo(c.traceToolLayer),c.toolSettings&&gr(Me=>{const Ae=new Map(Me);if(c.toolSettings.trace){const me=Ae.get("trace");if(me){const Se={...me,settings:c.toolSettings.trace},Pe=new Map(me.layerSettings);c.traceSizes&&c.traceColors&&(Pe.set("top",{color:c.traceColors.top||me.layerSettings.get("top")?.color||"#AA4499",size:c.traceSizes.top||me.layerSettings.get("top")?.size||6}),Pe.set("bottom",{color:c.traceColors.bottom||me.layerSettings.get("bottom")?.color||"#F781BF",size:c.traceSizes.bottom||me.layerSettings.get("bottom")?.size||6})),Ae.set("trace",{...Se,layerSettings:Pe})}}if(c.toolSettings.via){const me=Ae.get("via");me&&Ae.set("via",{...me,settings:c.toolSettings.via})}if(c.toolSettings.pad){const me=Ae.get("pad");if(me){const Se={...me,settings:c.toolSettings.pad},Pe=new Map(me.layerSettings);c.padSizes&&c.padColors&&(Pe.set("top",{color:c.padColors.top||me.layerSettings.get("top")?.color||"#0072B2",size:c.padSizes.top||me.layerSettings.get("top")?.size||18}),Pe.set("bottom",{color:c.padColors.bottom||me.layerSettings.get("bottom")?.color||"#56B4E9",size:c.padSizes.bottom||me.layerSettings.get("bottom")?.size||18})),Ae.set("pad",{...Se,layerSettings:Pe})}}if(c.toolSettings.component){const me=Ae.get("component");if(me){const Se={...me,settings:c.toolSettings.component},Pe=new Map(me.layerSettings);c.componentSizes&&c.componentColors&&(Pe.set("top",{color:c.componentColors.top||me.layerSettings.get("top")?.color||"#6A3D9A",size:c.componentSizes.top||me.layerSettings.get("top")?.size||18}),Pe.set("bottom",{color:c.componentColors.bottom||me.layerSettings.get("bottom")?.color||"#9467BD",size:c.componentSizes.bottom||me.layerSettings.get("bottom")?.size||18})),Ae.set("component",{...Se,layerSettings:Pe})}}if(c.testPointSizes&&c.testPointColors){_e(c.testPointColors.top||le),De(c.testPointColors.bottom||be),ot(c.testPointSizes.top||Ge),Ht(c.testPointSizes.bottom||jt);const me=Ae.get("testPoint");if(me){const Se=new Map(me.layerSettings);Se.set("top",{color:c.testPointColors.top||me.layerSettings.get("top")?.color||"#E69F00",size:c.testPointSizes.top||me.layerSettings.get("top")?.size||6}),Se.set("bottom",{color:c.testPointColors.bottom||me.layerSettings.get("bottom")?.color||"#F0E442",size:c.testPointSizes.bottom||me.layerSettings.get("bottom")?.size||6}),Ae.set("testPoint",{...me,layerSettings:Se})}}if(c.componentConnectionColor!==void 0&&xn(c.componentConnectionColor),c.componentConnectionSize!==void 0&&Rn(c.componentConnectionSize),c.toolSettings.ground){const me=Ae.get("ground");me&&Ae.set("ground",{...me,settings:c.toolSettings.ground})}if(c.toolSettings.power){const me=Ae.get("power");me&&Ae.set("power",{...me,settings:c.toolSettings.power})}if(c.toolSettings.erase){const me=Ae.get("erase");me&&Ae.set("erase",{...me,settings:c.toolSettings.erase})}const he=N==="draw"&&Je==="trace"?Ae.get("trace"):N==="draw"&&Je==="via"?Ae.get("via"):N==="draw"&&Je==="pad"?Ae.get("pad"):N==="draw"&&Je==="testPoint"?Ae.get("testPoint"):N==="component"?Ae.get("component"):N==="power"?Ae.get("power"):N==="ground"?Ae.get("ground"):null;if(he)if(N==="draw"&&Je==="trace"){const me=ui||"top",Se=he.layerSettings.get(me);Se?(ee(Se.color),$(Se.size),me==="top"?(R(Se.color),te(Se.size)):(Y(Se.color),je(Se.size))):(ee(he.settings.color),$(he.settings.size))}else if(N==="draw"&&Je==="pad"){const me=Hn||"top",Se=he.layerSettings.get(me);Se?(ee(Se.color),$(Se.size),me==="top"?(xe(Se.color),W(Se.size)):(A(Se.color),Ce(Se.size))):(ee(he.settings.color),$(he.settings.size))}else if(N==="component"){const me=Ri||"top",Se=he.layerSettings.get(me);Se?(ee(Se.color),$(Se.size),me==="top"?(lt(Se.color),hn(Se.size)):(Gt(Se.color),gn(Se.size))):(ee(he.settings.color),$(he.settings.size))}else if(N==="draw"&&Je==="testPoint"){const me=di||"top",Se=he.layerSettings.get(me);Se?(ee(Se.color),$(Se.size),me==="top"?(_e(Se.color),ot(Se.size)):(De(Se.color),Ht(Se.size))):(ee(he.settings.color),$(he.settings.size))}else ee(he.settings.color),$(he.settings.size);return Ae});const P=async(Me,Ae)=>{if(!Me)return null;let he=null,me="",Se=Me.filePath||Me.name;if(!Ae){const Pe=Me.name||"image";return alert(`Error: Cannot load image "${Pe}" because no project directory is available.

Please ensure you opened the project file from its project directory. The project directory is required to access the image files stored in the images/ subdirectory.`),null}if(Se)try{let Pe=Se;!Se.startsWith("images/")&&!Se.startsWith("Images/")?Pe=Se:Se.startsWith("Images/")?Pe=Se.replace("Images/",""):Se.startsWith("images/")&&(Pe=Se.replace("images/",""));let Oe;try{Oe=await Ae.getDirectoryHandle("images")}catch{try{Oe=await Ae.getDirectoryHandle("Images")}catch{throw new Error("Neither 'images' nor 'Images' directory found in project folder.")}}const Ze=await(await Oe.getFileHandle(Pe)).getFile();he=await createImageBitmap(Ze),me=URL.createObjectURL(Ze),console.log(`Loaded image from file path: images/${Pe}`),Se.startsWith("images/")||(Se=`images/${Se.replace("Images/","")}`)}catch(Pe){const Oe=Pe instanceof Error?Pe.message:"Unknown error",Fe=Me.name||"image",Ze=Se.startsWith("images/")||Se.startsWith("Images/")?Se.replace("Images/","images/"):`images/${Se}`;return alert(`Error: Failed to load image "${Fe}" from project directory.

Expected location: ${Ze}

This may occur if:
- The image file was moved or deleted
- The project directory structure was modified
- File permissions are insufficient

Please ensure the image file exists in the images/ subdirectory of your project folder.

Technical details: ${Oe}`),null}else{const Pe=Me.name||"image";return alert(`Error: Image "${Pe}" has no file path specified in the project file.

The project file is missing the image file path information. This may indicate the project file is corrupted or was created with an older version of the software.`),null}if(!he){const Pe=Me.name||"image";return alert(`Error: Could not create image bitmap for "${Pe}".

The image file may be corrupted or in an unsupported format. Please ensure the image is a valid PNG, JPEG, or other supported image format.`),null}return{url:me,name:Me.name??"image",width:Me.width??he.width,height:Me.height??he.height,filePath:Se,x:Me.x??0,y:Me.y??0,scale:Me.scale??1,rotation:Me.rotation??0,flipX:!!Me.flipX,flipY:!!Me.flipY,skewX:Me.skewX??0,skewY:Me.skewY??0,keystoneV:Me.keystoneV??0,keystoneH:Me.keystoneH??0,brightness:Me.brightness??100,contrast:Me.contrast??100,bitmap:he}},B=x!==void 0?x:oi,K=await P(c.images?.top,B),ne=await P(c.images?.bottom,B);if(s(K),d(ne),c.pointIdCounter&&typeof c.pointIdCounter=="number"?Kp(c.pointIdCounter):(console.warn("Project file missing pointIdCounter. Starting from 1."),Kp(1)),c.locks&&(typeof c.locks.areImagesLocked=="boolean"&&ya(c.locks.areImagesLocked),typeof c.locks.areViasLocked=="boolean"&&xa(c.locks.areViasLocked),typeof c.locks.arePadsLocked=="boolean"&&Ss(c.locks.arePadsLocked),typeof c.locks.areTracesLocked=="boolean"&&ba(c.locks.areTracesLocked),typeof c.locks.areComponentsLocked=="boolean"&&Ra(c.locks.areComponentsLocked),typeof c.locks.areGroundNodesLocked=="boolean"&&os(c.locks.areGroundNodesLocked),typeof c.locks.arePowerNodesLocked=="boolean"&&eo(c.locks.arePowerNodesLocked)),c.visibility&&(typeof c.visibility.showViasLayer=="boolean"&&Ka(c.visibility.showViasLayer),typeof c.visibility.showTopPadsLayer=="boolean"&&ua(c.visibility.showTopPadsLayer),typeof c.visibility.showBottomPadsLayer=="boolean"&&ja(c.visibility.showBottomPadsLayer),typeof c.visibility.showTopTracesLayer=="boolean"&&fs(c.visibility.showTopTracesLayer),typeof c.visibility.showBottomTracesLayer=="boolean"&&Li(c.visibility.showBottomTracesLayer),typeof c.visibility.showTopComponents=="boolean"&&ie(c.visibility.showTopComponents),typeof c.visibility.showBottomComponents=="boolean"&&ce(c.visibility.showBottomComponents),typeof c.visibility.showPowerLayer=="boolean"&&Te(c.visibility.showPowerLayer),typeof c.visibility.showGroundLayer=="boolean"&&Si(c.visibility.showGroundLayer),typeof c.visibility.showConnectionsLayer=="boolean"&&Xi(c.visibility.showConnectionsLayer),typeof c.visibility.showTraceCornerDots=="boolean"&&Er(c.visibility.showTraceCornerDots)),c.autoSave?(typeof c.autoSave.enabled=="boolean"&&ho(c.autoSave.enabled),typeof c.autoSave.interval=="number"&&Ro(c.autoSave.interval),typeof c.autoSave.baseName=="string"&&c.autoSave.baseName?(to(c.autoSave.baseName),io.current=c.autoSave.baseName,c.autoSave.enabled&&!Ls&&(console.log("Auto save: Directory handle not available after page reload (expected). Auto save disabled. Use File -> Auto Save -> Enable to re-enable."),ho(!1),Ro(null))):c.autoSave.enabled&&(console.warn("Auto save was enabled in project file but base name is missing. Disabling auto save."),ho(!1),Ro(null),to(""),io.current="")):(ho(!1),Ro(null),To(null),to(""),dr.current=null,io.current="",ki.current&&(clearInterval(ki.current),ki.current=null)),c.drawing?.drawingStrokes&&Array.isArray(c.drawing.drawingStrokes)){const Me=c.drawing.drawingStrokes.map(Ae=>({...Ae,points:Ae.points.map(he=>({...he,...ur(he)}))})).filter(Ae=>!(Ae.type==="trace"&&Ae.points.length<2));ye(Me);for(const Ae of Me)for(const he of Ae.points)he.id&&typeof he.id=="number"&&xg(he.id)}else console.warn("Project file missing drawingStrokes. Starting with empty strokes."),ye([]);if(c.drawing?.componentsTop){const Me=c.drawing.componentsTop.map(Ae=>{const he=ur({x:Ae.x,y:Ae.y});return{...Ae,x:he.x,y:he.y,layer:Ae.layer||"top",pinConnections:Ae.pinConnections||new Array(Ae.pinCount||0).fill("")}});ri(Me)}if(c.drawing?.componentsBottom){const Me=c.drawing.componentsBottom.map(Ae=>{const he=ur({x:Ae.x,y:Ae.y});return{...Ae,x:he.x,y:he.y,layer:Ae.layer||"bottom",pinConnections:Ae.pinConnections||new Array(Ae.pinCount||0).fill("")}});wi(Me)}if(c.designatorCounters&&typeof c.designatorCounters=="object"){const Me=c.designatorCounters;ai.current={...Me}}else ai.current={};if(typeof c.autoAssignDesignators=="boolean"&&ao(c.autoAssignDesignators),typeof c.useGlobalDesignatorCounters=="boolean"?ii(c.useGlobalDesignatorCounters):ii(!1),c.drawing?.grounds){const Ae=c.drawing.grounds.map(he=>{he.pointId||console.warn("Ground symbol missing pointId - this may cause issues");const me=ur({x:he.x,y:he.y});return{...he,x:me.x,y:me.y}}).filter(he=>{const me=typeof he.x=="number"&&typeof he.y=="number"&&!isNaN(he.x)&&!isNaN(he.y)&&isFinite(he.x)&&isFinite(he.y);return me||console.warn(`Filtered out invalid ground symbol at (${he.x}, ${he.y})`),me});sn(Ae);for(const he of Ae)he.pointId&&typeof he.pointId=="number"&&xg(he.pointId)}else sn([]);let z;if(c.powerBuses&&Array.isArray(c.powerBuses)&&c.powerBuses.length>0?(z=c.powerBuses,Be(z)):(z=[{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}],Be(z)),c.groundBuses&&Array.isArray(c.groundBuses)&&c.groundBuses.length>0?gt(c.groundBuses):gt([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),c.drawing?.powers){const Ae=c.drawing.powers.map(he=>{he.pointId||console.warn("Power symbol missing pointId - this may cause issues");const me=ur({x:he.x,y:he.y});return{...he,x:me.x,y:me.y}}).filter(he=>{const me=typeof he.x=="number"&&typeof he.y=="number"&&!isNaN(he.x)&&!isNaN(he.y)&&isFinite(he.x)&&isFinite(he.y);return me||console.warn(`Filtered out invalid power node at (${he.x}, ${he.y})`),me});$t(Ae);for(const he of Ae)he.pointId&&typeof he.pointId=="number"&&xg(he.pointId)}else $t([]);let Ne=0;if(c.drawing?.drawingStrokes&&Array.isArray(c.drawing.drawingStrokes))for(const Me of c.drawing.drawingStrokes)for(const Ae of Me.points)Ae.id&&typeof Ae.id=="number"&&Ae.id>Ne&&(Ne=Ae.id);if(c.drawing?.componentsTop&&Array.isArray(c.drawing.componentsTop)){for(const Me of c.drawing.componentsTop)if(Me.pinConnections&&Array.isArray(Me.pinConnections)){for(const Ae of Me.pinConnections)if(Ae&&typeof Ae=="string"){const he=parseInt(Ae,10);!isNaN(he)&&he>Ne&&(Ne=he)}}}if(c.drawing?.componentsBottom&&Array.isArray(c.drawing.componentsBottom)){for(const Me of c.drawing.componentsBottom)if(Me.pinConnections&&Array.isArray(Me.pinConnections)){for(const Ae of Me.pinConnections)if(Ae&&typeof Ae=="string"){const he=parseInt(Ae,10);!isNaN(he)&&he>Ne&&(Ne=he)}}}if(c.drawing?.grounds&&Array.isArray(c.drawing.grounds))for(const Me of c.drawing.grounds)Me.pointId&&typeof Me.pointId=="number"&&Me.pointId>Ne&&(Ne=Me.pointId);if(c.drawing?.powers&&Array.isArray(c.drawing.powers))for(const Me of c.drawing.powers)Me.pointId&&typeof Me.pointId=="number"&&Me.pointId>Ne&&(Ne=Me.pointId);const ve=Ne+1,Le=yg();Le<ve&&(console.warn(`pointIdCounter was ${Le} but max existing ID is ${Ne}. Correcting to ${ve}.`),Kp(ve)),Ti.current=!1,wo(!1),sr(!1),setTimeout(()=>{fd.current=!1},100)}catch(P){console.error("Failed to open project",P),alert("Failed to open project file. See console for details."),fd.current=!1}},[N,Je,oi,s,d,Kp,ya,xa,Ss,ba,Ra,os,eo,Ka,ua,ja,fs,Li,ie,ce,Te,Si,Xi,ho,Ro,To,to,ye,ri,wi,sn,Be,gt,$t,gc,ur,mg,D2,Yf,ao,ii,Ar]),hs=L.useCallback(async()=>{},[wa]),hd=L.useCallback(async c=>{const x=dr.current;if(!x){console.warn("Cannot load file: no directory handle");return}try{const B=await(await x.getFileHandle(c)).getFile();if(B.size===0){console.warn(`File ${c} is empty, skipping`);const Le=ro.current.filter(Me=>Me!==c);Ya(Le),ro.current=Le;return}const K=await B.text();if(!K||K.trim().length===0){console.warn(`File ${c} contains no data, skipping`);const Le=ro.current.filter(Me=>Me!==c);Ya(Le),ro.current=Le;return}let ne;try{ne=JSON.parse(K)}catch(ve){console.error(`Failed to parse JSON from file ${c}:`,ve);const Me=ro.current.filter(Ae=>Ae!==c);Ya(Me),ro.current=Me,await hs();return}fc(),Wn(1),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),Cn(new Set),yn(new Set),pn(new Set),jn(new Set),ir(),await Hl(ne),er(c);const Ne=ro.current.indexOf(c);Ne>=0?($r(Ne),us.current=Ne):await hs(),Ti.current=!1,wo(!1)}catch(P){console.error("Failed to load file from history:",P);const B=ro.current;if(B.includes(c)){const K=B.filter(ne=>ne!==c);Ya(K),ro.current=K,await hs()}}},[Hl,hs,ir]),Du=L.useCallback(async c=>{if(!oi){console.warn("Cannot restore file: no project directory handle"),alert("No project directory available. Please open or create a project first.");return}try{let x;try{x=await oi.getDirectoryHandle("history")}catch(z){console.error("History directory not found:",z),alert("History directory not found.");return}const B=await(await x.getFileHandle(c)).getFile();if(B.size===0){alert(`File ${c} is empty.`);return}const K=await B.text();if(!K||K.trim().length===0){alert(`File ${c} contains no data.`);return}let ne;try{ne=JSON.parse(K)}catch(z){console.error(`Failed to parse JSON from file ${c}:`,z),alert(`Failed to parse file ${c}. It may be corrupted.`);return}fc(),Wn(1),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),Cn(new Set),yn(new Set),pn(new Set),jn(new Set),ir(),await Hl(ne),er(c),Ti.current=!1,console.log(`Successfully restored file: ${c}`)}catch(x){console.error("Failed to restore file from history:",x),alert(`Failed to restore file ${c}. Please try again.`)}},[oi,Hl,Cn,yn,pn,jn,er,Wn,fc,ir]);Pt.useEffect(()=>{et&&!bt&&Mt({x:window.innerWidth/2-300,y:window.innerHeight/2-250})},[et,bt]);const gd=L.useCallback(c=>{if(!bt)return;Sn(!0);const x=c.clientX-bt.x,P=c.clientY-bt.y,B=ne=>{Mt({x:ne.clientX-x,y:ne.clientY-P})},K=()=>{Sn(!1),document.removeEventListener("mousemove",B),document.removeEventListener("mouseup",K)};document.addEventListener("mousemove",B),document.addEventListener("mouseup",K)},[bt]);L.useCallback(async()=>{const c=us.current,x=ro.current;if(c>=0&&c<x.length-1){const P=c+1,B=x[P];B&&await hd(B)}},[hd]),L.useCallback(async()=>{const c=us.current,x=ro.current;if(c<=0||c>=x.length||x.length===0){console.warn("Cannot navigate to newer file: index is",c,"history length is",x.length);return}if(c>0&&c<x.length&&x.length>0){const P=c-1;if(P>=0&&P<x.length){const B=x[P];B?await hd(B):(console.warn("No newer file found at index",P),await hs())}else console.warn("Cannot navigate to newer file: prevIndex",P,"is out of bounds")}},[hd,hs]),Pt.useEffect(()=>{An.current=Ke},[Ke]);const pu=Pt.useRef(Je),Wc=Pt.useRef(At);Pt.useEffect(()=>{const c=Je!==pu.current;if(N==="draw"&&pu.current==="trace"&&c){if(An.current.length>=2){Bi(ct,Qt,tn,mt,Kt);const x={id:`${Date.now()}-trace-autofinalize`,points:An.current,color:G,size:F,layer:Wc.current,type:"trace"};ye(P=>[...P,x]),Wc.current==="top"?$o(P=>[...P,x.id]):ms(P=>[...P,x.id])}vt([]),Nt(!1)}pu.current=Je,Wc.current=At},[Je,At,N,G,F]);const _f=Pt.useRef(N);Pt.useEffect(()=>{if(_f.current==="draw"&&N!=="draw"&&Je==="trace"&&An.current.length>=2){const c={id:`${Date.now()}-trace-autofinalize`,points:An.current,color:G,size:F,layer:At,type:"trace"};ye(x=>[...x,c]),At==="top"?$o(x=>[...x,c.id]):ms(x=>[...x,c.id]),vt([]),Nt(!1)}_f.current=N},[N,Je,G,F,At]);const Df=Pt.useMemo(()=>v2,[]);Pt.useEffect(()=>{uu()},[ct]),Pt.useEffect(()=>{uu()},[Qt,tn,Ee,nr]);const on=oa>0,Rf=L.useCallback(async c=>await I1(ko,Rr,er,Lo,aa,ul,Hl,async(B,K,ne,z)=>{await Zd(B,K,ne,ho,Ro,To,to,dr,io,ki,Ti,Do,po,Rr,ds,z)},c),[ko,Rr,er,Lo,aa,ul,Hl,ho,Ro,To,to,dr,io,ki,Ti,Do,po,Rr,ds,Zd]);L.useCallback(async()=>{const x=await I1(ko,Rr,er,Lo,aa,ul,Hl,async(P,B,K,ne)=>{await Zd(P,B,K,ho,Ro,To,to,dr,io,ki,Ti,Do,po,Rr,ds,ne)});if(!x.success){if(x.error&&x.error!=="User cancelled directory selection."&&alert(x.error),x.error==="User cancelled directory selection.")return;x.error?.includes("not supported")&&dl.current?.click()}},[ko,Rr,er,Lo,aa,ul,Hl,no,oi,ho,Ro,To,to,dr,io,ki,Ti,Do,po,Rr,ds,dl,Zd]);const Vd=L.useCallback(async()=>{const c=window;if(typeof c.showDirectoryPicker!="function"){alert("Directory picker is not supported in this browser.");return}let x=null;try{x=await c.showDirectoryPicker({mode:"readwrite"});try{if(x&&"queryPermission"in x&&typeof x.queryPermission=="function"&&await x.queryPermission({mode:"readwrite"})!=="granted"&&"requestPermission"in x&&typeof x.requestPermission=="function"&&await x.requestPermission({mode:"readwrite"})!=="granted"){alert("Full access to the project directory is required to open and manage project files.");return}}catch(B){console.warn("Permission check failed (may not be supported in this browser):",B)}}catch(B){if(B?.name==="AbortError")return;alert(`Failed to open directory picker: ${B instanceof Error?B.message:String(B)}`);return}if(pd()&&oi)try{await qc()}catch(B){console.warn("Failed to auto-save before opening project:",B)}const P=await Rf(x);!P.success&&P.error&&P.error!=="User cancelled directory selection."&&alert(P.error)},[pd,qc,oi,Rf]),Ap=L.useCallback(async()=>{if(pd()&&oi)try{await qc()}catch(c){console.warn("Failed to save before closing project:",c)}dd()},[pd,qc,oi,dd]);return i.jsxs("div",{className:"app",children:[i.jsxs("header",{className:"app-header",children:[i.jsx("h1",{style:{position:"absolute",left:"50%",transform:"translateX(-50%)"},children:" PCB Tracer"}),i.jsxs("button",{onClick:()=>{window.open("https://github.com/sponsors/pgiacalo","_blank","noopener,noreferrer")},style:{display:"flex",alignItems:"center",gap:6,padding:"6px 12px",background:"#ffffff",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:6,cursor:"pointer",fontSize:12,fontWeight:500,color:"#000000",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)",transition:"background 0.2s",marginLeft:"auto"},onMouseEnter:c=>{c.currentTarget.style.background="#f0f0f0"},onMouseLeave:c=>{c.currentTarget.style.background="#ffffff"},title:"Donate to support this project",children:[i.jsx("svg",{height:"16",width:"16",viewBox:"0 0 16 16",fill:"#ff0000","aria-hidden":"true",children:i.jsx("path",{d:"M4.25 2.5c-1.336 0-2.75 1.164-2.75 3 0 2.15 1.58 4.144 3.365 5.682A20.565 20.565 0 008 13.393a20.561 20.561 0 003.135-2.211C12.92 9.644 14.5 7.65 14.5 5.5c0-1.836-1.414-3-2.75-3-1.373 0-2.609.986-3.029 2.456a.749.749 0 01-1.442 0C6.859 3.486 5.623 2.5 4.25 2.5z"})}),"Donate"]})]}),i.jsx(tw,{openMenu:Ic,setOpenMenu:Rs,isReadOnlyMode:on,currentProjectFilePath:wa,isProjectActive:!!oi,autoSaveEnabled:$a,autoSaveInterval:kl,hasUnsavedChangesState:jl,onNewProject:Hc,onOpenProject:Vd,onSaveProject:qc,onCloseProject:Ap,onPrint:Cp,onExportBOM:xo,bomExportFormat:ae,setBomExportFormat:V,onExportNetlist:Us,netlistExportFormat:E,setNetlistExportFormat:re,hasUnsavedChanges:pd,setNewProjectDialog:Ha,setAutoSaveDialog:Do,onShowGeminiSettings:()=>ca(!0),topImage:o,bottomImage:l,setCurrentTool:g,resetImageTransform:Sf,areImagesLocked:Qi,setAreImagesLocked:ya,onEnterBoardDimensions:()=>Os(!0),fileInputTopRef:iu,fileInputBottomRef:Cs,openProjectRef:dl,increaseSize:Fl,decreaseSize:sd,brushSize:F,drawingStrokes:ct,selectedIds:wn,selectedComponentIds:Fn,selectedPowerIds:Ni,selectedGroundIds:vi,componentsTop:Qt,componentsBottom:tn,powers:Re,grounds:Ee,powerNodeNames:fp,groundNodeNames:pp,setSetSizeDialog:as,areViasLocked:Dr,setAreViasLocked:xa,arePadsLocked:ma,setArePadsLocked:Ss,areTestPointsLocked:na,setAreTestPointsLocked:Da,areTracesLocked:fo,setAreTracesLocked:ba,areComponentsLocked:Wi,setAreComponentsLocked:Ra,areGroundNodesLocked:vo,setAreGroundNodesLocked:os,arePowerNodesLocked:$i,setArePowerNodesLocked:eo,showTraceCornerDots:Ui,setShowTraceCornerDots:Er,showCrosshairs:go,setShowCrosshairs:zr,setSelectedIds:Cn,setSelectedComponentIds:yn,setSelectedPowerIds:pn,setSelectedGroundIds:jn,selectAllVias:kh,selectAllTraces:op,selectAllPads:ap,selectAllComponents:sp,selectDisconnectedComponents:lp,selectAllComponentConnections:cp,selectAllPowerNodes:hf,selectAllGroundNodes:hp,selectPowerNodesByName:gp,selectGroundNodesByName:Ph,setShowPowerBusManager:He,setShowGroundBusManager:cr,setShowPastMachine:pt,toolRegistry:fi,updateToolSettings:Xl,updateToolLayerSettings:bo,setBrushSize:$,setBrushColor:ee,saveToolSettings:Ky,saveToolLayerSettings:tf,colorPalette:Df,currentTool:N,drawingMode:Je,traceToolLayer:ui,padToolLayer:Hn,testPointToolLayer:di,componentToolLayer:Ri,setTopTraceSize:te,setBottomTraceSize:je,setTopPadSize:W,setBottomPadSize:Ce,setTopTestPointSize:ot,setBottomTestPointSize:Ht,setTopComponentSize:hn,setBottomComponentSize:gn,setComponentConnectionSize:Rn,topTraceColor:H,bottomTraceColor:Z,topPadColor:Ie,bottomPadColor:k,topTestPointColor:le,bottomTestPointColor:be,topComponentColor:ge,bottomComponentColor:Yt,setTopTraceColor:R,setBottomTraceColor:Y,setTopPadColor:xe,setBottomPadColor:A,setTopTestPointColor:_e,setBottomTestPointColor:De,setTopComponentColor:lt,setBottomComponentColor:Gt,setComponentConnectionColor:xn,saveDefaultSize:Lt,saveDefaultColor:Wt,menuBarRef:fl,onOpenProjectNotes:Cf,onOpenTestPoints:jf,onOpenTransformImages:()=>el(!0),onOpenTransformAll:()=>Ko(!0)}),i.jsx("div",{style:{display:"block",padding:0,margin:0,width:"100vw",height:"calc(100vh - 70px)",boxSizing:"border-box",position:"relative"},children:i.jsxs("div",{ref:Bc,style:{position:"relative",width:"100%",height:"100%",margin:0,padding:0,boxSizing:"border-box",background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",borderRadius:"16px",overflow:"hidden"},children:[i.jsxs("div",{style:{position:"absolute",top:6,left:6,bottom:6,width:46,display:"flex",flexDirection:"column",gap:8,padding:"6px 3px",background:"rgba(250,250,255,0.95)",borderRadius:8,border:"1px solid #ddd",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:20},children:[i.jsxs("button",{onClick:()=>{on||du()},onMouseDown:c=>c.currentTarget.blur(),disabled:on,title:"Select (S)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:N==="select"?"2px solid #000":"1px solid #ddd",background:N==="select"?"#e6f0ff":"#fff",color:on?"#999":"#222",outline:"none",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:[i.jsx(y2,{size:14}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"S"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),i.jsxs("button",{onMouseDown:c=>{if(c.altKey&&!on){c.preventDefault(),c.stopPropagation(),sc(!1),xl(!0);return}},onClick:c=>{!on&&!c.altKey&&(console.log("Via tool clicked"),Ut(),Ft("via"),g("draw"),Ka(!0))},disabled:on,title:"Draw Vias (V), Option+click for Pattern Placement",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:N==="draw"&&Je==="via"?"2px solid #000":"1px solid #ddd",background:N==="draw"&&Je==="via"?"#e6f0ff":"#fff",color:on?"#999":"#222",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:[i.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const c=On.get("via").color;return i.jsxs(i.Fragment,{children:[i.jsx("circle",{cx:"12",cy:"12",r:"8",fill:"none",stroke:c,strokeWidth:"3"}),i.jsx("circle",{cx:"12",cy:"12",r:"4",fill:c})]})})()}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"V"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:On.get("via").size})]})]}),i.jsxs("button",{ref:Ld,onMouseDown:c=>{if(c.altKey&&!on){c.preventDefault(),c.stopPropagation(),sc(!0),xl(!0);return}},onClick:c=>{!on&&!c.altKey&&(console.log("Pad tool clicked"),Ut(),Ft("pad"),g("draw"),setTimeout(()=>Od(),0))},disabled:on,title:"Draw Pads (P), Option+click for Pattern Placement",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:N==="draw"&&Je==="pad"?"2px solid #000":"1px solid #ddd",background:N==="draw"&&Je==="pad"?"#e6f0ff":"#fff",color:on?"#999":"#222",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:[i.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const x=Hn==="top"?"padTop":"padBottom",P=On.get(x).color,B=14,K=(24-B)/2,ne=(24-B)/2;return i.jsx("rect",{x:K,y:ne,width:B,height:B,fill:P})})()}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"P"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{if(N==="draw"&&Je==="pad"&&Nr.toolInstanceId&&(Nr.toolInstanceId==="padTop"||Nr.toolInstanceId==="padBottom"))return Nr.size;const c=Hn==="top"?"padTop":"padBottom";return On.get(c).size})()})]})]}),i.jsxs("button",{ref:Au,onClick:()=>{on||(console.log("Test Point tool clicked"),Ut(),Ft("testPoint"),g("draw"),setTimeout(()=>fu(),0))},disabled:on,title:"Draw Test Points (Y)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:N==="draw"&&Je==="testPoint"?"2px solid #000":"1px solid #ddd",background:N==="draw"&&Je==="testPoint"?"#e6f0ff":"#fff",color:on?"#999":"#222",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:[i.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const x=di==="top"?"testPointTop":"testPointBottom",P=On.get(x).color,B=14,K=12,ne=12;return i.jsx("path",{d:`M ${K} ${ne-B/2} L ${K+B/2} ${ne} L ${K} ${ne+B/2} L ${K-B/2} ${ne} Z`,fill:P,stroke:"#000",strokeWidth:"1.5"})})()}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"Y"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{if(N==="draw"&&Je==="testPoint"&&Nr.toolInstanceId&&(Nr.toolInstanceId==="testPointTop"||Nr.toolInstanceId==="testPointBottom"))return Nr.size;const c=di==="top"?"testPointTop":"testPointBottom";return On.get(c).size})()})]})]}),i.jsxs("button",{ref:td,onMouseDown:c=>{if(c.altKey&&!on){c.preventDefault(),c.stopPropagation(),sc(!1),xl(!0);return}},onClick:c=>{!on&&!c.altKey&&(console.log("Trace tool clicked"),Ut(),Ft("trace"),g("draw"),Ll(!0),setTimeout(()=>Tf(),0))},disabled:on,title:"Draw Traces (T)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:N==="draw"&&Je==="trace"?"2px solid #000":"1px solid #ddd",background:N==="draw"&&Je==="trace"?"#e6f0ff":"#fff",color:on?"#999":"#222",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:[i.jsx(m2,{size:14,color:(()=>{const x=ui==="top"?"traceTop":"traceBottom";return On.get(x).color})()}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"T"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{const c=ui==="top"?"traceTop":"traceBottom";return On.get(c).size})()})]})]}),i.jsxs("button",{ref:da,onClick:()=>{on||(console.log("Component tool clicked"),Ut(),g("component"))},disabled:on,title:"Draw Component (C)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:N==="component"?"2px solid #000":"1px solid #ddd",background:N==="component"?"#e6f0ff":"#fff",color:on?"#999":"#222",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:[(()=>{const x=(Ri||"top")==="top"?"componentTop":"componentBottom",P=On.get(x).color;return Ml?i.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[i.jsx("rect",{x:"4",y:"4",width:"16",height:"16",fill:"rgba(255,255,255,0.9)",stroke:P,strokeWidth:"1.5"}),i.jsx("text",{x:"12",y:"14",textAnchor:"middle",fontSize:"7",fill:P,fontWeight:"bold",fontFamily:"monospace",children:(()=>{const B=Nc?.componentDefinition?.designator??Nc?.designator;return B?B.length<=3?B:B.substring(0,3):Eg(Ml)})()})]}):i.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[i.jsx("rect",{x:"5",y:"3",width:"14",height:"7",fill:P,stroke:P,strokeWidth:"0.5"}),i.jsxs("g",{stroke:P,fill:"none",strokeWidth:"1.5",children:[i.jsx("rect",{x:"5",y:"10",width:"14",height:"4",rx:"1.2"}),i.jsx("path",{d:"M7 14 v4 M10 14 v4 M13 14 v4 M16 14 v4",stroke:P})]})]})})(),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"C"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{const c=Ri==="top"?"componentTop":"componentBottom";return On.get(c).size})()})]})]}),i.jsxs("button",{ref:Na,onClick:()=>{on||(console.log("Power tool clicked"),Ut(),Pi(!1),fe.length===1?(pi(fe[0].id),g("power"),Tn(!1),Te(!0)):fe.length>1?Tn(!0):(Tn(!0),g("power"),Te(!0)))},disabled:on,title:"Draw Power (B)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:N==="power"?"2px solid #000":"1px solid #ddd",background:N==="power"?"#e6f0ff":"#fff",color:on?"#999":"#222",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:[i.jsx("span",{style:{color:(nn?fe.find(c=>c.id===nn)?.color:null)||"#ff0000",fontSize:"18px",fontWeight:"bold",lineHeight:1,flexShrink:0},children:"V"}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"B"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:On.get("power").size})]})]}),i.jsxs("button",{ref:Md,onClick:()=>{on||(console.log("Ground tool clicked"),Tn(!1),Ve.length===1?(Yi(Ve[0].id),g("ground"),Pi(!1),Si(!0)):Ve.length>1?Pi(!0):(Pi(!0),g("ground"),Si(!0)))},disabled:on,title:"Draw Ground (G)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:N==="ground"?"2px solid #000":"1px solid #ddd",background:N==="ground"?"#e6f0ff":"#fff",color:on?"#999":"#222",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:[i.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 20","aria-hidden":"true",style:{overflow:"visible",flexShrink:0},children:i.jsxs("g",{stroke:(pr?Ve.find(c=>c.id===pr)?.color:null)||"#000000",strokeWidth:"2",strokeLinecap:"round",children:[i.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"10"}),i.jsx("line",{x1:"5",y1:"10",x2:"19",y2:"10"}),i.jsx("line",{x1:"7",y1:"13",x2:"17",y2:"13"}),i.jsx("line",{x1:"9.5",y1:"16",x2:"14.5",y2:"16"})]})}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"G"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:On.get("ground").size})]})]}),i.jsx("div",{style:{height:32}}),i.jsxs("button",{onClick:()=>{on||(Ut(),g(c=>c==="pan"?"draw":"pan"))},disabled:on,title:"Move (H)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:6,padding:"4px 6px",borderRadius:6,border:N==="pan"?"2px solid #000":"1px solid #ddd",background:N==="pan"?"#e6f0ff":"#fff",color:on?"#999":"#222",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:[i.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:i.jsxs("g",{stroke:"#111",fill:"none",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("path",{d:"M8 11v-4c0-.8.6-1.3 1.3-1.3S11 6.2 11 7v4"}),i.jsx("path",{d:"M11 11V6.5c0-.8.6-1.3 1.3-1.3S14 5.7 14 6.5V11"}),i.jsx("path",{d:"M14 11V7.2c0-.8.6-1.3 1.3-1.3.7 0 1.3.5 1.3 1.3V12c1 .6 1.6 1.5 1.6 2.7A4.3 4.3 0 0 1 14 19H9.2A4.2 4.2 0 0 1 5 14.8V11c0-.6.4-1 .9-1 .6 0 1 .4 1 1v2"})]})}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"H"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),i.jsxs("button",{onClick:()=>{Ut(),ru(!1),g(c=>c==="magnify"?"draw":"magnify")},title:"Magnify (M)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:N==="magnify"?"2px solid #000":"1px solid #ddd",background:N==="magnify"?"#e6f0ff":"#fff",color:"#222",cursor:"pointer"},children:[i.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[i.jsx("circle",{cx:"10",cy:"10",r:"7.5",fill:"none",stroke:"#111",strokeWidth:"2"}),i.jsx("line",{x1:"15.5",y1:"15.5",x2:"21",y2:"21",stroke:"#111",strokeWidth:"2",strokeLinecap:"round"}),La?i.jsx("line",{x1:"6.5",y1:"10",x2:"13.5",y2:"10",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"}):i.jsxs(i.Fragment,{children:[i.jsx("line",{x1:"6.5",y1:"10",x2:"13.5",y2:"10",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"}),i.jsx("line",{x1:"10",y1:"6.5",x2:"10",y2:"13.5",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"})]})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"M"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),i.jsxs("button",{onClick:()=>{on||Ko(!0)},disabled:on,title:"Change Perspective (E) - Open Change Perspective Dialog",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:Nl?"2px solid #000":"1px solid #ddd",background:Nl?"#e6f0ff":"#fff",color:on?"#999":"#222",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:[i.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[i.jsx("ellipse",{cx:"12",cy:"12",rx:"9",ry:"6",fill:"none",stroke:"#111",strokeWidth:"2"}),i.jsx("circle",{cx:"12",cy:"12",r:"4",fill:"none",stroke:"#111",strokeWidth:"2"}),i.jsx("circle",{cx:"11",cy:"11",r:"1.5",fill:"#111",stroke:"none"})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"E"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),i.jsxs("button",{onClick:()=>{on||(Ut(),g("center"),fr(!0),En.current&&clearTimeout(En.current),En.current=setTimeout(()=>{fr(!1),g("select"),ji(void 0)},2e3))},disabled:on,title:"Set View (X) - Press 0-9 to Set View",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:N==="center"?"2px solid #000":"1px solid #ddd",background:N==="center"?"#e6f0ff":"#fff",color:on?"#999":"#222",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:[i.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[i.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"10",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),i.jsx("line",{x1:"12",y1:"14",x2:"12",y2:"22",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),i.jsx("line",{x1:"2",y1:"12",x2:"10",y2:"12",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),i.jsx("line",{x1:"14",y1:"12",x2:"22",y2:"12",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"X"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onClick:()=>{on||va(c=>!c)},disabled:on,title:"Color Picker",style:{width:32,height:32,display:"grid",placeItems:"center",borderRadius:6,border:"1px solid #ddd",background:"#fff",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:i.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 16 16","aria-hidden":"true",children:[i.jsx("rect",{x:"0",y:"0",width:"3.5",height:"3.5",fill:"#9E9E9E",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"4",y:"0",width:"3.5",height:"3.5",fill:"#0072B2",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"8",y:"0",width:"3.5",height:"3.5",fill:"#56B4E9",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"12",y:"0",width:"3.5",height:"3.5",fill:"#00BFC4",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"0",y:"4",width:"3.5",height:"3.5",fill:"#6A3D9A",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"4",y:"4",width:"3.5",height:"3.5",fill:"#2CA02C",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"8",y:"4",width:"3.5",height:"3.5",fill:"#7FC97F",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"12",y:"4",width:"3.5",height:"3.5",fill:"#FF7F0E",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"0",y:"8",width:"3.5",height:"3.5",fill:"#FFD700",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"4",y:"8",width:"3.5",height:"3.5",fill:"#FF6B6B",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"8",y:"8",width:"3.5",height:"3.5",fill:"#E74C3C",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"12",y:"8",width:"3.5",height:"3.5",fill:"#FFB6C1",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"0",y:"12",width:"3.5",height:"3.5",fill:"#DDA0DD",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"4",y:"12",width:"3.5",height:"3.5",fill:"#8B4513",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"8",y:"12",width:"3.5",height:"3.5",fill:"#A0522D",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"12",y:"12",width:"3.5",height:"3.5",fill:"#FF4500",stroke:"#ccc",strokeWidth:"0.3"})]})}),Xo&&i.jsx("div",{ref:ks,style:{position:"absolute",left:42,top:0,padding:8,background:"#fff",border:"1px solid #ddd",borderRadius:6,boxShadow:"0 8px 18px rgba(0,0,0,0.18)",zIndex:50},children:i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(8, 22px)",gap:4},children:Df.map(c=>i.jsx("div",{onClick:()=>{ee(c),va(!1);try{let P=null;N==="draw"&&Je==="via"?P="via":N==="draw"&&Je==="pad"?P=(Hn||"top")==="bottom"?"padBottom":"padTop":N==="draw"&&Je==="testPoint"?P=(di||"top")==="bottom"?"testPointBottom":"testPointTop":N==="draw"&&Je==="trace"?P=(ui||"top")==="bottom"?"traceBottom":"traceTop":N==="component"?P=(Ri||"top")==="bottom"?"componentBottom":"componentTop":N==="power"?P="power":N==="ground"&&(P="ground"),P&&On.setColor(P,c)}catch(P){console.error("Error updating tool instance color:",P)}const x=is(fi);if(x)if(N==="draw"&&Je==="trace"){const P=ui||"top",K=x.layerSettings.get(P)?.size||x.settings.size,ne={color:c,size:K};bo(x.id,P,ne),tf(x.id),P==="top"?(R(c),Wt("trace",c,"top")):(Y(c),Wt("trace",c,"bottom"))}else if(N==="draw"&&Je==="pad"){const P=Hn||"top",K=x.layerSettings.get(P)?.size||x.settings.size,ne={color:c,size:K};bo(x.id,P,ne),tf(x.id),P==="top"?(xe(c),Wt("pad",c,"top")):(A(c),Wt("pad",c,"bottom"))}else if(N==="draw"&&Je==="testPoint"){const P=di||"top",K=x.layerSettings.get(P)?.size||x.settings.size,ne={color:c,size:K};bo(x.id,P,ne),tf(x.id),P==="top"?(_e(c),Wt("testPoint",c,"top")):(De(c),Wt("testPoint",c,"bottom"))}else if(N==="component"){const P=Ri||"top",K=x.layerSettings.get(P)?.size||x.settings.size,ne={color:c,size:K};bo(x.id,P,ne),tf(x.id),P==="top"?(lt(c),Wt("component",c,"top")):(Gt(c),Wt("component",c,"bottom"))}else{const P={...x.settings,color:c};Xl(x.id,P),Ky(x.id,c,x.settings.size),N==="draw"&&Je==="via"&&Wt("via",c)}Wt("brush",c),wn.size>0&&ye(P=>P.map(B=>wn.has(B.id)?(B.type==="via"?(Wt("via",c),gr(K=>{const ne=new Map(K),z=ne.get("via");return z&&ne.set("via",{...z,settings:{...z.settings,color:c}}),ne})):B.type==="pad"?(Wt("pad",c),gr(K=>{const ne=new Map(K),z=ne.get("pad");return z&&ne.set("pad",{...z,settings:{...z.settings,color:c}}),ne})):B.type==="trace"&&Wt("trace",c,B.layer),{...B,color:c}):B)),Fn.size>0&&(Wt("component",c),ri(P=>P.map(B=>Fn.has(B.id)?{...B,color:c}:B)),wi(P=>P.map(B=>Fn.has(B.id)?{...B,color:c}:B))),Ni.size>0&&$t(P=>P.map(B=>Ni.has(B.id)?{...B,color:c}:B)),vi.size>0&&sn(P=>P.map(B=>vi.has(B.id)?{...B,color:c}:B))},title:c,style:{width:22,height:22,backgroundColor:c,border:c===G?"2px solid #333":"1px solid #ccc",cursor:"pointer"}},c))})})]}),i.jsx("div",{style:{height:32}}),i.jsx("button",{onClick:()=>{on||Cf()},disabled:on,title:"Project Notes",style:{width:32,height:32,display:"grid",placeItems:"center",borderRadius:6,border:"1px solid #ddd",background:"#fff",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:i.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[i.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2",fill:"#fff",stroke:"#FFD700",strokeWidth:"1"}),i.jsx("circle",{cx:"6",cy:"7",r:"1.5",fill:"#000"}),i.jsx("rect",{x:"9",y:"6",width:"8",height:"2",rx:"1",fill:"#000"}),i.jsx("circle",{cx:"6",cy:"11",r:"1.5",fill:"#000"}),i.jsx("rect",{x:"9",y:"10",width:"8",height:"2",rx:"1",fill:"#000"}),i.jsx("circle",{cx:"6",cy:"15",r:"1.5",fill:"#000"}),i.jsx("rect",{x:"9",y:"14",width:"8",height:"2",rx:"1",fill:"#000"}),i.jsx("circle",{cx:"6",cy:"19",r:"1.5",fill:"#000"}),i.jsx("rect",{x:"9",y:"18",width:"8",height:"2",rx:"1",fill:"#000"})]})}),i.jsx("button",{onClick:()=>{on||jf()},disabled:on,title:"Test Points",style:{width:32,height:32,display:"grid",placeItems:"center",borderRadius:6,border:"1px solid #ddd",background:"#fff",cursor:on?"not-allowed":"pointer",opacity:on?.5:1},children:i.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[i.jsx("rect",{width:"24",height:"24",fill:"#FFD700"}),i.jsx("circle",{cx:"6",cy:"7",r:"1.5",fill:"#000"}),i.jsx("rect",{x:"9",y:"6",width:"8",height:"2",rx:"1",fill:"#000"}),i.jsx("circle",{cx:"6",cy:"11",r:"1.5",fill:"#000"}),i.jsx("rect",{x:"9",y:"10",width:"8",height:"2",rx:"1",fill:"#000"}),i.jsx("circle",{cx:"6",cy:"15",r:"1.5",fill:"#000"}),i.jsx("rect",{x:"9",y:"14",width:"8",height:"2",rx:"1",fill:"#000"}),i.jsx("circle",{cx:"6",cy:"19",r:"1.5",fill:"#000"}),i.jsx("rect",{x:"9",y:"18",width:"8",height:"2",rx:"1",fill:"#000"})]})})]}),N==="draw"&&Je==="trace"&&Cu&&i.jsxs("div",{ref:Vc,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[i.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[i.jsx("input",{type:"radio",name:"traceToolLayer",checked:ui==="top",onChange:()=>{console.log("Trace tool Top clicked"),ts.current="top",zo("top"),Jt("top"),ee(H),$(we),gr(c=>{const x=new Map(c),P=x.get("trace");return P&&x.set("trace",{...P,settings:{color:H,size:we}}),x}),Ll(!1),Yr(!0),fs(!0)}}),i.jsx("span",{children:"Top"})]}),i.jsxs("label",{className:"radio-label",children:[i.jsx("input",{type:"radio",name:"traceToolLayer",checked:ui==="bottom",onChange:()=>{console.log("Trace tool Bottom clicked"),ts.current="bottom",zo("bottom"),Jt("bottom"),ee(Z),$(de),gr(c=>{const x=new Map(c),P=x.get("trace");return P&&x.set("trace",{...P,settings:{color:Z,size:de}}),x}),Ll(!1),jo(!0),Li(!0)}}),i.jsx("span",{children:"Bottom"})]})]}),N==="draw"&&Je==="pad"&&su&&i.jsxs("div",{ref:Nu,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[i.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[i.jsx("input",{type:"radio",name:"padToolLayer",checked:Hn==="top",onChange:()=>{console.log("Pad tool Top clicked"),ns.current="top",ys("top"),Jt("top");const c=On.get("padTop");ee(c.color),$(c.size),gr(x=>{const P=new Map(x),B=P.get("pad");return B&&P.set("pad",{...B,settings:{color:c.color,size:c.size}}),P}),ju(!1),Yr(!0),ua(!0)}}),i.jsx("span",{children:"Top"})]}),i.jsxs("label",{className:"radio-label",children:[i.jsx("input",{type:"radio",name:"padToolLayer",checked:Hn==="bottom",onChange:()=>{console.log("Pad tool Bottom clicked"),ns.current="bottom",ys("bottom"),Jt("bottom");const c=On.get("padBottom");ee(c.color),$(c.size),gr(x=>{const P=new Map(x),B=P.get("pad");return B&&P.set("pad",{...B,settings:{color:c.color,size:c.size}}),P}),ju(!1),jo(!0),ja(!0)}}),i.jsx("span",{children:"Bottom"})]})]}),N==="draw"&&Je==="testPoint"&&Pd&&i.jsxs("div",{ref:lu,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[i.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[i.jsx("input",{type:"radio",name:"testPointToolLayer",checked:di==="top",onChange:()=>{console.log("Test Point tool Top clicked"),xs.current="top",Wo("top"),Jt("top"),ee(le),$(Ge),gr(c=>{const x=new Map(c),P=x.get("testPoint");return P&&x.set("testPoint",{...P,settings:{color:le,size:Ge}}),x}),Cc(!1),Yr(!0),y(!0)}}),i.jsx("span",{children:"Top"})]}),i.jsxs("label",{className:"radio-label",children:[i.jsx("input",{type:"radio",name:"testPointToolLayer",checked:di==="bottom",onChange:()=>{console.log("Test Point tool Bottom clicked"),xs.current="bottom",Wo("bottom"),Jt("bottom"),ee(be),$(jt),gr(c=>{const x=new Map(c),P=x.get("testPoint");return P&&x.set("testPoint",{...P,settings:{color:be,size:jt}}),x}),Cc(!1),jo(!0),I(!0)}}),i.jsx("span",{children:"Bottom"})]})]}),un&&i.jsxs("div",{ref:ed,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25,minWidth:"200px"},children:[i.jsx("div",{style:{marginBottom:"4px",fontWeight:600,fontSize:"12px",color:"#333"},children:"Select Power Bus:"}),fe.length===0?i.jsx("div",{style:{padding:"8px",color:"#666",fontSize:"12px"},children:"No power buses defined. Use Tools  Manage Power Buses to add one."}):[...fe].sort((c,x)=>{const P=ne=>{const z=ne.match(/([+-]?)(\d+\.?\d*)/);if(z){const Ne=z[1]||"+",ve=parseFloat(z[2]);return{absValue:Math.abs(ve),isNegative:Ne==="-",original:ne}}return{absValue:1/0,isNegative:!1,original:ne}},B=P(c.voltage),K=P(x.voltage);return B.absValue!==K.absValue?B.absValue-K.absValue:B.isNegative!==K.isNegative?B.isNegative?-1:1:0}).map(c=>i.jsx("button",{onClick:x=>{x.preventDefault(),x.stopPropagation(),pi(c.id),N!=="power"&&(Ut(),g("power"),Te(!0)),Tn(!1)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#222"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("div",{style:{width:16,height:16,borderRadius:"50%",background:c.color,border:"1px solid #ccc"}}),i.jsxs("div",{children:[i.jsx("div",{style:{fontWeight:600,fontSize:"13px"},children:c.name}),i.jsx("div",{style:{fontSize:"11px",color:"#666"},children:c.voltage})]})]})},c.id)),i.jsx("div",{style:{height:1,background:"#ddd",margin:"4px 0"}}),i.jsx("button",{onClick:c=>{c.preventDefault(),c.stopPropagation(),Tn(!1),He(!0)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"11px"},children:"Manage Power Buses"}),i.jsx("button",{onClick:c=>{c.preventDefault(),c.stopPropagation(),Tn(!1),pi(null),g("select")},style:{display:"block",width:"100%",textAlign:"center",padding:"4px 6px",marginTop:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#666",fontSize:"11px"},children:"Cancel"})]}),tr&&i.jsxs("div",{ref:ku,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25,minWidth:"200px"},children:[i.jsx("div",{style:{marginBottom:"4px",fontWeight:600,fontSize:"12px",color:"#333"},children:"Select Ground Bus:"}),Ve.length===0?i.jsx("div",{style:{padding:"8px",color:"#666",fontSize:"12px"},children:"No ground buses defined. Use Tools  Manage Ground Buses to add one."}):[...Ve].sort((c,x)=>c.name.localeCompare(x.name)).map(c=>{const x=c.id==="groundbus-earth",P=pr===c.id;return i.jsx("button",{onClick:B=>{B.preventDefault(),B.stopPropagation(),Yi(c.id),N!=="ground"&&(Ut(),g("ground"),Si(!0)),Pi(!1)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:P?"#e0e0e0":"#f5f5f5",border:P?"2px solid #000":"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#222"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("div",{style:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:x?i.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",style:{display:"block"},children:[i.jsx("line",{x1:"10",y1:"2",x2:"10",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),i.jsx("line",{x1:"4",y1:"10",x2:"16",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),i.jsx("line",{x1:"5",y1:"12.5",x2:"15",y2:"12.5",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),i.jsx("line",{x1:"6",y1:"15",x2:"14",y2:"15",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"})]}):i.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",style:{display:"block"},children:[i.jsx("circle",{cx:"10",cy:"10",r:"6",fill:"none",stroke:"#000",strokeWidth:"2"}),i.jsx("line",{x1:"10",y1:"2",x2:"10",y2:"18",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),i.jsx("line",{x1:"2",y1:"10",x2:"18",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"})]})}),i.jsx("div",{children:i.jsx("div",{style:{fontWeight:600,fontSize:"13px"},children:c.name})})]})},c.id)}),i.jsx("div",{style:{height:1,background:"#ddd",margin:"4px 0"}}),i.jsx("button",{onClick:c=>{c.preventDefault(),c.stopPropagation(),Pi(!1),cr(!0)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"11px"},children:"Manage Ground Buses"}),i.jsx("button",{onClick:c=>{c.preventDefault(),c.stopPropagation(),Pi(!1),Yi(null),g("select")},style:{display:"block",width:"100%",textAlign:"center",padding:"4px 6px",marginTop:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#666",fontSize:"11px"},children:"Cancel"})]}),i.jsxs("div",{style:{position:"absolute",top:6,left:60,bottom:6,width:168,padding:6,display:"flex",flexDirection:"column",gap:2,background:"rgba(250,250,255,0.95)",borderRadius:8,border:"1px solid #ddd",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:15},children:[i.jsx("div",{style:{fontSize:11,fontWeight:700,color:"#333",marginBottom:2},children:"Layers"}),i.jsxs("div",{onClick:()=>Jt("top"),title:"Top layer",style:{cursor:"pointer",padding:2,borderRadius:4,border:en==="top"?"2px solid #0b5fff":"1px solid #ddd",background:"#fff"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:2},children:[i.jsx("div",{style:{fontSize:10,color:"#444",fontWeight:600},children:"Top Image"}),i.jsx("label",{className:"radio-label",style:{margin:0},children:i.jsx("input",{type:"checkbox",checked:As,onChange:c=>Yr(c.target.checked)})})]}),i.jsx("canvas",{ref:nl,width:60,height:40,style:{width:"60px",height:"40px"}})]}),i.jsxs("div",{onClick:()=>Jt("bottom"),title:"Bottom layer",style:{cursor:"pointer",padding:2,borderRadius:4,border:en==="bottom"?"2px solid #0b5fff":"1px solid #ddd",background:"#fff"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:2},children:[i.jsx("div",{style:{fontSize:10,color:"#444",fontWeight:600},children:"Bottom Image"}),i.jsx("label",{className:"radio-label",style:{margin:0},children:i.jsx("input",{type:"checkbox",checked:Xa,onChange:c=>jo(c.target.checked)})})]}),i.jsx("canvas",{ref:zl,width:60,height:40,style:{width:"60px",height:"40px"}})]}),i.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:No,onChange:c=>Ka(c.target.checked)}),i.jsx("span",{children:"Vias"})]}),i.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:Ma,onChange:c=>fs(c.target.checked)}),i.jsx("span",{children:"Traces (Top)"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:X,onChange:c=>ie(c.target.checked)}),i.jsx("span",{children:"Components (Top)"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:Bo,onChange:c=>ua(c.target.checked)}),i.jsx("span",{children:"Pads (Top)"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:f,onChange:c=>y(c.target.checked)}),i.jsx("span",{children:"Test Points (Top)"})]}),i.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:Ba,onChange:c=>Li(c.target.checked)}),i.jsx("span",{children:"Traces (Bottom)"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:oe,onChange:c=>ce(c.target.checked)}),i.jsx("span",{children:"Components (Bottom)"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:Zo,onChange:c=>ja(c.target.checked)}),i.jsx("span",{children:"Pads (Bottom)"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:j,onChange:c=>I(c.target.checked)}),i.jsx("span",{children:"Test Points (Bottom)"})]}),i.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:pe,onChange:c=>Te(c.target.checked)}),i.jsx("span",{children:"Power"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:nr,onChange:c=>Si(c.target.checked)}),i.jsx("span",{children:"Ground"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:yi,onChange:c=>Xi(c.target.checked)}),i.jsx("span",{children:"Connections"})]}),i.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:No&&Bo&&Zo&&f&&j&&Ma&&Ba&&X&&oe&&pe&&nr&&yi,onChange:c=>{const x=c.target.checked;Ka(x),ua(x),ja(x),y(x),I(x),fs(x),Li(x),ie(x),ce(x),Te(x),Si(x),Xi(x)}}),i.jsx("span",{style:{fontWeight:600,fontSize:11},children:"Select All Layers"})]}),i.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),i.jsxs("div",{style:{marginTop:6},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i.jsxs("label",{style:{fontSize:10,color:"#333"},children:["Transparency: ",v,"%"]}),i.jsxs("label",{className:"radio-label",style:{margin:0},children:[i.jsx("input",{type:"checkbox",checked:C,onChange:c=>{const x=c.target.checked;x?(Yr(!0),jo(!0)):(m(50),g("select")),D(x)}}),i.jsx("span",{style:{marginLeft:6,fontSize:10},children:"Cycle"})]})]}),i.jsx("input",{type:"range",min:"0",max:"100",value:v,onChange:c=>m(Number(c.target.value)),onDoubleClick:()=>ud("transparency"),className:"slider",style:{width:"100%",marginTop:3}}),C&&i.jsxs("div",{style:{marginTop:6},children:[i.jsxs("label",{style:{fontSize:10,color:"#333"},children:["Cycle Speed: ",(M/1e3).toFixed(1),"s"]}),i.jsx("input",{type:"range",min:"500",max:"8000",step:"100",value:8500-M,onChange:c=>S(8500-Number(c.target.value)),onDoubleClick:()=>S(2e3),className:"slider",style:{width:"100%",marginTop:3}})]})]})]}),i.jsx(nw,{visible:!o&&!l&&!yr,canvasSize:Fr,canvasPosition:{left:244,top:6},onDismiss:()=>Zl(!0)}),i.jsx("canvas",{ref:Tt,width:Fr.width,height:Fr.height,tabIndex:0,onMouseDown:wp,onMouseMove:wf,onMouseUp:od,onMouseLeave:od,onWheel:mf,onDoubleClick:bf,className:`pcb-canvas ${N==="transform"?"transform-cursor":N==="draw"?"draw-cursor":N==="erase"?"erase-cursor":"default-cursor"}`,style:{position:"absolute",left:"244px",top:"6px",...Hr?{cursor:Hr}:N==="pan"?{cursor:sa?"grabbing":"grab"}:{},width:`${Fr.width}px`,height:`${Fr.height}px`,maxHeight:"none",aspectRatio:"auto",border:"none"}}),ls&&i.jsxs("div",{style:{position:"absolute",left:`${244+Fr.width-120}px`,top:`${6+Fr.height+4}px`,fontSize:"11px",fontFamily:"monospace",color:"#333",backgroundColor:"rgba(255, 255, 255, 0.9)",padding:"2px 6px",borderRadius:"3px",border:"1px solid #ccc",pointerEvents:"none",zIndex:1e3},children:["(",ls.x.toFixed(1),"mm, ",ls.y.toFixed(1),"mm)"]}),i.jsx(fw,{componentEditor:Va,setComponentEditor:qa,componentsTop:Qt,componentsBottom:tn,setComponentsTop:ri,setComponentsBottom:wi,connectingPin:uo,setConnectingPin:_a,componentDialogPosition:vs,setComponentDialogPosition:rs,isDraggingDialog:Zs,setIsDraggingDialog:eu,dialogDragOffset:ws,setDialogDragOffset:tu,areComponentsLocked:Wi,setSelectedComponentIds:yn,setNotesDialogVisible:yo,projectDirHandle:oi,showGeminiSettingsDialog:Ql,onGeminiSettingsDialogClose:()=>ca(!1),onFindComponent:Ad,componentDefinition:Va?(()=>{const c=Qt.find(x=>x.id===Va.id)||tn.find(x=>x.id===Va.id);return c?$l(c):void 0})():void 0}),Sa&&la&&(()=>{const c=Sa.component,x=Sa.layer;if(!c)return null;const P=c.componentType||"Component",B=c.componentType==="IntegratedCircuit"&&"icType"in c?c.icType:null,K=zh(c),ne=$l(c),z=ne?.category==="Semiconductors",Ne=c?.pinNames,ve=ne?.properties?.pinNames,Le=8,Me=8,Ae=200,he=150,me=10;let Se=Sa.x+Le,Pe=Sa.y+Me;return Se+Ae+me>window.innerWidth&&(Se=Sa.x-Ae-Le),Pe+he+me>window.innerHeight&&(Pe=Sa.y-he-Me),Se=Math.max(me,Math.min(Se,window.innerWidth-Ae-me)),Pe=Math.max(me,Math.min(Pe,window.innerHeight-he-me)),i.jsxs("div",{style:{position:"fixed",left:`${Se}px`,top:`${Pe}px`,background:"rgba(0, 0, 0, 0.85)",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:"12px",lineHeight:"1.4",zIndex:1e4,pointerEvents:"none",width:"max-content",maxWidth:"400px",minWidth:"150px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)",wordWrap:"break-word",overflowWrap:"break-word"},children:[i.jsx("div",{style:{fontWeight:600,marginBottom:"4px"},children:Yl(P)}),i.jsxs("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:["Layer: ",x==="top"?"Top":"Bottom"]}),B&&i.jsxs("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:["IC Type: ",B]}),K.length>0&&i.jsx("div",{style:{marginBottom:"4px"},children:K.map((Oe,Fe)=>i.jsx("div",{style:{color:"#e0e0e0",fontSize:"11px",marginBottom:"2px"},children:Oe},Fe))}),c.description&&i.jsx("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:c.description}),c.notes&&i.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid rgba(255,255,255,0.2)",fontSize:"11px",color:"#d0d0d0",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:c.notes}),z&&c.pinCount>0&&(()=>{const Oe=Array.from({length:c.pinCount},(Fe,Ze)=>{const dt=c.pinConnections&&c.pinConnections.length>Ze?c.pinConnections[Ze]:"",Ct=Ne&&Ze<Ne.length?Ne[Ze]:"",It=ve&&Ze<ve.length?ve[Ze]:"",st=It==="CHIP_DEPENDENT",cn=Ct&&Ct.trim()!==""?Ct:st?"":It;return{pin:Ze+1,name:cn||"-",nodeId:dt||"-"}});return i.jsxs("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid rgba(255,255,255,0.2)"},children:[i.jsx("div",{style:{fontSize:"11px",fontWeight:600,marginBottom:"4px",color:"#fff"},children:"Pin Connections:"}),i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.3)"},children:[i.jsx("th",{style:{textAlign:"left",padding:"2px 6px",fontWeight:600,color:"#fff"},children:"Pin"}),i.jsx("th",{style:{textAlign:"left",padding:"2px 6px",fontWeight:600,color:"#fff"},children:"Name"}),i.jsx("th",{style:{textAlign:"left",padding:"2px 6px",fontWeight:600,color:"#fff"},children:"Node ID"})]})}),i.jsx("tbody",{children:Oe.map((Fe,Ze)=>i.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[i.jsx("td",{style:{padding:"2px 6px",color:"#e0e0e0",fontFamily:"monospace"},children:Fe.pin}),i.jsx("td",{style:{padding:"2px 6px",color:"#e0e0e0",fontStyle:Fe.name!=="-"?"italic":"normal"},children:Fe.name}),i.jsx("td",{style:{padding:"2px 6px",color:"#e0e0e0",fontFamily:"monospace"},children:Fe.nodeId})]},Ze))})]})]})})()]})})(),Oc&&la&&(()=>{const c=Oc.stroke;return c.notes?i.jsxs("div",{style:{position:"fixed",left:`${Oc.x+10}px`,top:`${Oc.y+10}px`,background:"rgba(0, 0, 0, 0.85)",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:"12px",lineHeight:"1.4",zIndex:1e4,pointerEvents:"none",width:"max-content",maxWidth:"400px",minWidth:"150px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)",wordWrap:"break-word",overflowWrap:"break-word"},children:[i.jsx("div",{style:{fontWeight:600,marginBottom:"4px"},children:"Test Point"}),i.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid rgba(255,255,255,0.2)",fontSize:"11px",color:"#d0d0d0",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:c.notes})]}):null})(),Un&&Un.visible&&(()=>{if(!Re.find(P=>P.id===Un.id))return null;const x=fe.find(P=>P.id===Un.powerBusId);return i.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#fff",border:"1px solid #0b5fff",borderRadius:4,padding:"6px",boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"175px",maxWidth:"250px",maxHeight:"40vh",overflowY:"auto",pointerEvents:"auto"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"5px"},children:[i.jsx("h3",{style:{margin:0,fontSize:"12px",color:"#333",fontWeight:600},children:"Power Properties"}),i.jsx("button",{onClick:()=>li(null),style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#666",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Power Bus:"}),i.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:x?`${x.name} (${x.voltage})`:"Unknown"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:`power-layer-${Un.id}`,style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Layer:"}),i.jsxs("select",{id:`power-layer-${Un.id}`,name:`power-layer-${Un.id}`,value:Un.layer,onChange:P=>li({...Un,layer:P.target.value}),disabled:$i,style:{width:"100%",padding:"2px 3px",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",opacity:$i?.6:1},children:[i.jsx("option",{value:"top",children:"Top"}),i.jsx("option",{value:"bottom",children:"Bottom"})]})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"X:"}),i.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:Un.x.toFixed(2)})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Y:"}),i.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:Un.y.toFixed(2)})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"3px",marginTop:"6px"},children:[i.jsx("button",{onClick:()=>li(null),style:{padding:"2px 5px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,cursor:"pointer",fontSize:"10px",color:"#333"},children:"Cancel"}),i.jsx("button",{onClick:()=>{$i||($t(P=>P.map(B=>B.id===Un.id?{...B,layer:Un.layer}:B)),li(null))},disabled:$i,style:{padding:"2px 5px",background:$i?"#f5f5f5":"#0b5fff",color:$i?"#999":"#fff",border:"1px solid #ddd",borderRadius:2,cursor:$i?"not-allowed":"pointer",fontSize:"10px"},children:"Save"})]})]})})(),!o&&!l&&i.jsx("div",{className:"placeholder"})]})}),i.jsx(mw,{visible:ke,onClose:()=>He(!1),powerBuses:fe,setPowerBuses:Be,editingPowerBusId:Qe,setEditingPowerBusId:yt,powers:Re}),i.jsx(bw,{visible:Xt,onClose:()=>cr(!1),groundBuses:Ve,setGroundBuses:gt,editingGroundBusId:Yn,setEditingGroundBusId:gi,grounds:Ee}),i.jsx(jw,{visible:et,projectDirHandle:oi,onClose:()=>{pt(!1),Mt(void 0)},onRestore:Du,position:bt,isDragging:zt,onDragStart:gd}),i.jsx(vw,{visible:Gi,onClose:()=>mr(!1),autoAssignDesignators:Ur,setAutoAssignDesignators:ao,useGlobalDesignatorCounters:Pr,setUseGlobalDesignatorCounters:ii}),i.jsx("input",{ref:iu,type:"file",accept:".png,.jpg,.jpeg,image/png,image/jpeg",style:{display:"none"},onChange:c=>{const x=c.target.files?.[0];x&&xf(x,"top"),c.target.value=""}}),i.jsx("input",{ref:Cs,type:"file",accept:".png,.jpg,.jpeg,image/png,image/jpeg",style:{display:"none"},onChange:c=>{const x=c.target.files?.[0];x&&xf(x,"bottom"),c.target.value=""}}),i.jsx("input",{ref:dl,type:"file",accept:".json,application/json",style:{display:"none"},onChange:async c=>{const x=c.target.files?.[0];if(x)try{ld(),await new Promise(z=>setTimeout(z,0)),er(x.name);const P=await x.text(),B=JSON.parse(P);await Hl(B,null);let ne;if(B.projectInfo?.name)ne=B.projectInfo.name;else{if(ne=x.name.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_"),!ne){console.error("Failed to extract project name from filename"),alert("Warning: Could not determine project name from filename. Please ensure the project file has a valid name.");return}Lo(ne)}no||Lo(ne),setTimeout(async()=>{await Ul(5,!0)},100)}catch(P){console.error("Failed to open project",P),alert("Failed to open project file. See console for details.")}c.target.value=""}}),i.jsx(iw,{visible:Go.visible,selectedIds:wn,selectedComponentIds:Fn,selectedPowerIds:Ni,selectedGroundIds:vi,drawingStrokes:ct,componentsTop:Qt,componentsBottom:tn,powers:Re,grounds:Ee,powerBuses:fe,onClose:()=>{Wr({visible:!1,text:""})},setComponentsTop:ri,setComponentsBottom:wi,determineViaType:Qa,determinePadType:Rl,determineTestPointType:ml,onFindComponent:Ad,onFindStroke:up,onFindPower:dp,onFindGround:Ah,onOpenNotesDialog:()=>yo(!0),position:si,isDragging:Gr,onDragStart:c=>{si&&(Ei({x:c.clientX-si.x,y:c.clientY-si.y}),Mn(!0),c.preventDefault())}}),i.jsx(rw,{visible:Oa,selectedIds:wn,selectedComponentIds:Fn,selectedPowerIds:Ni,selectedGroundIds:vi,drawingStrokes:ct,componentsTop:Qt,componentsBottom:tn,powers:Re,grounds:Ee,powerBuses:fe,onClose:()=>{yo(!1)},setComponentsTop:ri,setComponentsBottom:wi,setDrawingStrokes:ye,setPowerSymbols:$t,setGroundSymbols:sn,determineViaType:Qa,determinePadType:Rl,determineTestPointType:ml,position:Fo,isDragging:pl,onDragStart:c=>{Fo&&(_r({x:c.clientX-Fo.x,y:c.clientY-Fo.y}),_l(!0),c.preventDefault())}}),i.jsx(ow,{visible:Ku,projectNotes:Sc,setProjectNotes:hl,projectMetadata:Uc,setProjectMetadata:Za,onClose:()=>{gl(!1)},position:ec,isDragging:Uo,onDragStart:c=>{ec?(yl({x:c.clientX-ec.x,y:c.clientY-ec.y}),Xr(!0),c.preventDefault()):(tc({x:c.clientX-300,y:c.clientY-200}),yl({x:300,y:200}),Xr(!0),c.preventDefault())}}),i.jsx(aw,{visible:ic,drawingStrokes:ct,onClose:()=>{rc(!1)},onFindTestPoint:pf,position:Ja,isDragging:ac,onDragStart:c=>{Ja?(il({x:c.clientX-Ja.x,y:c.clientY-Ja.y}),Ec(!0),c.preventDefault()):(oc({x:c.clientX-300,y:c.clientY-200}),il({x:300,y:200}),Ec(!0),c.preventDefault())},determineTestPointType:ml,powerBuses:fe}),i.jsx(ww,{visible:Qs.visible,title:"New Project",message:"You have unsaved changes. Do you want to save your project before creating a new one?",onYes:Ac,onNo:Pc,onCancel:zf,yesButtonRef:bu}),Jn.visible&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10002},onClick:c=>{c.target===c.currentTarget&&Ed()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:c=>c.stopPropagation(),children:[i.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"New Project"}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Project Name:"}),i.jsx("input",{ref:Fc,type:"text",value:Jn.projectName,onChange:c=>{Ts(x=>({...x,projectName:c.target.value}))},onKeyDown:c=>{c.key==="Enter"?(c.preventDefault(),vl()):c.key==="Escape"&&(c.preventDefault(),Ed())},style:{width:"100%",padding:"8px 12px",marginBottom:"8px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},placeholder:"e.g., my_pcb_project",autoFocus:!0}),Jn.projectName&&(()=>{const c=Jn.projectName.match(/[^a-zA-Z0-9_-]/g);if(c){const x=[...new Set(c)];return i.jsxs("div",{style:{marginBottom:"12px",padding:"6px 10px",background:"#3a1f1f",border:"1px solid #a44",borderRadius:4,fontSize:"12px",color:"#ffaaaa"},children:["Invalid characters: ",x.map(P=>`"${P}"`).join(", "),". Only letters, numbers, underscore (_), and hyphen (-) are allowed."]})}return null})(),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Location:"}),i.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"8px"},children:[i.jsx("input",{type:"text",value:Jn.locationPath||"Not selected",readOnly:!0,style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:Jn.locationPath?"#f2f2f2":"#888",fontSize:"14px",cursor:"not-allowed"},placeholder:"Select a location..."}),i.jsx("button",{onClick:Es,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500,whiteSpace:"nowrap"},children:"Browse..."})]}),i.jsx("div",{style:{marginBottom:"12px",padding:"6px 10px",background:"#2a2a2f",border:"1px solid #444",borderRadius:4,fontSize:"11px",color:"#aaa",fontStyle:"italic"},children:"Note: Select an existing parent directory. The project directory will be created automatically when you click Create."}),Jn.projectName&&Jn.locationPath&&i.jsxs("div",{style:{marginBottom:"20px",padding:"8px 12px",background:"#1a1a1f",border:"1px solid #333",borderRadius:6,fontSize:"12px",color:"#aaa",fontFamily:"monospace"},children:[i.jsx("div",{style:{marginBottom:"4px",color:"#888"},children:"Project will be created at:"}),i.jsx("div",{style:{color:"#4CAF50"},children:(()=>{if(!Jn.projectName||!Jn.locationPath)return"";const x=Jn.projectName.trim().replace(/[^a-zA-Z0-9_-]/g,"_");if(!x)return"";const P=`${x}.json`;return Jn.locationPath===x?`${Jn.locationPath}/${P}`:`${Jn.locationPath}/${x}/${P}`})()})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[i.jsx("button",{onClick:Ed,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:vl,disabled:!Jn.projectName.trim()||!Jn.locationHandle,style:{padding:"8px 16px",background:!Jn.projectName.trim()||!Jn.locationHandle?"#555":"#4CAF50",color:"#fff",border:"1px solid "+(!Jn.projectName.trim()||!Jn.locationHandle?"#666":"#45a049"),borderRadius:6,cursor:!Jn.projectName.trim()||!Jn.locationHandle?"not-allowed":"pointer",fontSize:"14px",fontWeight:600,opacity:!Jn.projectName.trim()||!Jn.locationHandle?.6:1},children:"Create"})]})]})}),Oi.visible&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10002},onClick:c=>{c.target===c.currentTarget&&ql()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:c=>c.stopPropagation(),children:[i.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Save As"}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"File Name:"}),i.jsx("input",{ref:vu,type:"text",value:Oi.filename,onChange:c=>{ra(x=>({...x,filename:c.target.value}))},onKeyDown:c=>{c.key==="Enter"?(c.preventDefault(),Pf()):c.key==="Escape"&&(c.preventDefault(),ql())},style:{width:"100%",padding:"8px 12px",marginBottom:"8px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},placeholder:"e.g., my_project.json",autoFocus:!0}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Location:"}),i.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[i.jsx("input",{type:"text",value:Oi.locationPath||"Not selected",readOnly:!0,style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:Oi.locationPath?"#f2f2f2":"#888",fontSize:"14px",cursor:"not-allowed"},placeholder:"Select a location..."}),i.jsx("button",{onClick:Vs,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500,whiteSpace:"nowrap"},children:"Browse..."})]}),Oi.filename&&Oi.locationPath&&i.jsxs("div",{style:{marginBottom:"20px",padding:"8px 12px",background:"#1a1a1f",border:"1px solid #333",borderRadius:6,fontSize:"12px",color:"#aaa",fontFamily:"monospace"},children:[i.jsx("div",{style:{marginBottom:"4px",color:"#888"},children:"File will be saved at:"}),i.jsxs("div",{style:{color:"#4CAF50"},children:[Oi.locationPath,"/",Oi.filename.endsWith(".json")?Oi.filename:`${Oi.filename}.json`]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[i.jsx("button",{onClick:ql,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:Pf,disabled:!Oi.filename.trim()||!Oi.locationHandle,style:{padding:"8px 16px",background:!Oi.filename.trim()||!Oi.locationHandle?"#555":"#4CAF50",color:"#fff",border:"1px solid "+(!Oi.filename.trim()||!Oi.locationHandle?"#666":"#45a049"),borderRadius:6,cursor:!Oi.filename.trim()||!Oi.locationHandle?"not-allowed":"pointer",fontSize:"14px",fontWeight:600,opacity:!Oi.filename.trim()||!Oi.locationHandle?.6:1},children:"Save"})]})]})}),i.jsx(nm,{visible:Is.visible,title:Is.title,message:Is.message,onClose:()=>ia({visible:!1,title:"",message:""})}),i.jsx(sw,{visible:Nd,dimensions:Tu,onSave:c=>{Bs(c)},onClose:()=>Os(!1)}),i.jsx(lw,{visible:Lc,onClose:()=>{let c=0,x=0;o?(c=o.x,x=o.y):l&&(c=l.x,x=l.y),Ns(P=>({...P,0:{pcbReferenceX:c,pcbReferenceY:x,x:0,y:0,zoom:wt,viewRotation:mn,viewFlipX:Dt,isBottomView:Wa,transparency:v,showTopImage:As,showBottomImage:Xa,showViasLayer:No,showTopTracesLayer:Ma,showBottomTracesLayer:Ba,showTopPadsLayer:Bo,showBottomPadsLayer:Zo,showTopTestPointsLayer:f,showBottomTestPointsLayer:j,showTopComponents:X,showBottomComponents:oe,showPowerLayer:pe,showGroundLayer:nr,showConnectionsLayer:yi}})),el(!1)},topImage:o,bottomImage:l,selectedImageForTransform:en,setSelectedImageForTransform:zi,transformMode:Cr,setTransformMode:jr,updateImageTransform:ad,resetImageTransform:Sf,setCurrentTool:g,isGrayscale:U,setIsGrayscale:_,areImagesLocked:Qi}),i.jsx(cw,{visible:Nl,onClose:()=>Ko(!1),topImage:o,bottomImage:l,setTopImage:s,setBottomImage:d,componentsTop:Qt,componentsBottom:tn,setComponentsTop:ri,setComponentsBottom:wi,drawingStrokes:ct,setDrawingStrokes:ye,powerSymbols:Re,groundSymbols:Ee,setPowerSymbols:$t,setGroundSymbols:sn,canvasRef:Tt,isBottomView:Wa,setIsBottomView:sr,originalTopFlipX:Fi,setOriginalTopFlipX:lr,originalBottomFlipX:So,setOriginalBottomFlipX:cs,originalTopFlipY:tl,setOriginalTopFlipY:bc,originalBottomFlipY:nu,setOriginalBottomFlipY:Gu,cameraWorldCenter:rn,setCameraWorldCenter:bn,viewScale:wt,viewRotation:mn,setViewRotation:Ot,viewFlipX:Dt,setViewFlipX:an,contentBorder:5,setTransparency:m}),i.jsx(xw,{visible:gf,selectedLayer:Ri,selectedComponentType:Ml,selectedComponentKey:yp,onLayerChange:c=>{Ds(c),Or.current=c,Jt(c),ee(c==="top"?ge:Yt),$(c==="top"?xt:Et),c==="top"?(Yr(!0),ie(!0)):(jo(!0),ce(!0))},onComponentTypeChange:(c,x,P)=>{jc(c),xp(x),_d(P||null),Dd.current=c},onClose:()=>{zd(!1),ha(!0),g("select")}}),i.jsx(Sw,{visible:Ia.visible,size:Ia.size,onSizeChange:c=>as(x=>({...x,size:c})),onApply:_h,onCancel:()=>as({visible:!1,size:6})}),i.jsx(Tw,{visible:Js.visible,interval:Js.interval,onIntervalChange:c=>Do({visible:!0,interval:c}),onApply:()=>Ul(Js.interval,!1),onCancel:()=>Do({visible:!1,interval:5})}),i.jsx(Cw,{visible:ss.visible,interval:ss.interval,onIntervalChange:c=>po({...ss,interval:c}),onEnable:()=>Ul(ss.interval,!0),onSkip:Tp}),i.jsx(_w,{visible:Zu,isPad:wu,onConfirm:c=>{Ju({numPins:c.numPins,type:c.type,twoSidedOrientation:c.twoSidedOrientation,point1:{x:0,y:0},point2:{x:0,y:0}}),Qu(!0),g("select"),xl(!1)},onClose:()=>{xl(!1)}})]})}c2.createRoot(document.getElementById("root")).render(i.jsx(L.StrictMode,{children:i.jsx(Kw,{})}));export{qr as _,Zw as c,Qm as g};
